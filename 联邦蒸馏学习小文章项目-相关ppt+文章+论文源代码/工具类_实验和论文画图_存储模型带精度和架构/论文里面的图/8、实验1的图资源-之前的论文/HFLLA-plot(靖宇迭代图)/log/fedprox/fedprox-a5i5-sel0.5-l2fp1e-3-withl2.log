#clients of iccad2012: 5
#clients of asml1: 5
select ratio: 0.5
Total num clients: 10
client model path: ['models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13125, 144, 32)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13116, 144, 32)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13135, 144, 32)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13124, 144, 32)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 32)
Resampled dataset to size (13051, 144, 32)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6754, 144, 32)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6728, 144, 32)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6702, 144, 32)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6792, 144, 32)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6715, 144, 32)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [1 3 5 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36406 | Reg=0.00358 | FP-Reg=0.000 | acc=0.5625 | L2-Norm=18.928 | L2-Norm(final)=2.059 | 2530.1 samples/s | 39.5 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.29344 | Reg=0.00357 | FP-Reg=0.002 | acc=0.7188 | L2-Norm=18.905 | L2-Norm(final)=2.060 | 3853.0 samples/s | 60.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24800 | Reg=0.00359 | FP-Reg=0.004 | acc=0.7812 | L2-Norm=18.941 | L2-Norm(final)=2.074 | 3838.9 samples/s | 60.0 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22094 | Reg=0.00360 | FP-Reg=0.005 | acc=0.8750 | L2-Norm=18.970 | L2-Norm(final)=2.084 | 3840.5 samples/s | 60.0 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20149 | Reg=0.00361 | FP-Reg=0.006 | acc=0.8438 | L2-Norm=18.996 | L2-Norm(final)=2.094 | 4739.4 samples/s | 74.1 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18368 | Reg=0.00362 | FP-Reg=0.007 | acc=0.9219 | L2-Norm=19.023 | L2-Norm(final)=2.104 | 1583.0 samples/s | 24.7 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17088 | Reg=0.00363 | FP-Reg=0.008 | acc=0.9219 | L2-Norm=19.049 | L2-Norm(final)=2.115 | 3760.0 samples/s | 58.7 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16319 | Reg=0.00364 | FP-Reg=0.009 | acc=0.9062 | L2-Norm=19.073 | L2-Norm(final)=2.125 | 3769.0 samples/s | 58.9 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15476 | Reg=0.00365 | FP-Reg=0.009 | acc=0.8281 | L2-Norm=19.098 | L2-Norm(final)=2.135 | 4505.8 samples/s | 70.4 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14570 | Reg=0.00366 | FP-Reg=0.010 | acc=0.9688 | L2-Norm=19.122 | L2-Norm(final)=2.144 | 1579.0 samples/s | 24.7 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13756 | Reg=0.00367 | FP-Reg=0.011 | acc=0.8906 | L2-Norm=19.144 | L2-Norm(final)=2.154 | 3797.7 samples/s | 59.3 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.13170 | Reg=0.00367 | FP-Reg=0.011 | acc=0.9844 | L2-Norm=19.165 | L2-Norm(final)=2.163 | 3794.3 samples/s | 59.3 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12599 | Reg=0.00368 | FP-Reg=0.012 | acc=0.9688 | L2-Norm=19.184 | L2-Norm(final)=2.172 | 4324.5 samples/s | 67.6 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11994 | Reg=0.00369 | FP-Reg=0.013 | acc=0.9531 | L2-Norm=19.202 | L2-Norm(final)=2.182 | 1600.5 samples/s | 25.0 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11455 | Reg=0.00369 | FP-Reg=0.013 | acc=0.9062 | L2-Norm=19.219 | L2-Norm(final)=2.191 | 3799.1 samples/s | 59.4 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.11060 | Reg=0.00370 | FP-Reg=0.013 | acc=0.9531 | L2-Norm=19.235 | L2-Norm(final)=2.200 | 3798.3 samples/s | 59.3 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10625 | Reg=0.00371 | FP-Reg=0.014 | acc=0.9688 | L2-Norm=19.250 | L2-Norm(final)=2.209 | 4159.4 samples/s | 65.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.38273 | Reg=0.00358 | FP-Reg=0.000 | acc=0.4375 | L2-Norm=18.928 | L2-Norm(final)=2.059 | 3378.5 samples/s | 52.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.28982 | Reg=0.00357 | FP-Reg=0.002 | acc=0.8125 | L2-Norm=18.897 | L2-Norm(final)=2.060 | 3603.4 samples/s | 56.3 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24951 | Reg=0.00358 | FP-Reg=0.003 | acc=0.8281 | L2-Norm=18.925 | L2-Norm(final)=2.072 | 3769.9 samples/s | 58.9 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22282 | Reg=0.00359 | FP-Reg=0.005 | acc=0.8594 | L2-Norm=18.953 | L2-Norm(final)=2.083 | 3785.6 samples/s | 59.2 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20322 | Reg=0.00360 | FP-Reg=0.006 | acc=0.9219 | L2-Norm=18.979 | L2-Norm(final)=2.093 | 4705.9 samples/s | 73.5 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18567 | Reg=0.00361 | FP-Reg=0.007 | acc=0.9531 | L2-Norm=19.007 | L2-Norm(final)=2.104 | 1539.6 samples/s | 24.1 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17212 | Reg=0.00362 | FP-Reg=0.008 | acc=0.9375 | L2-Norm=19.034 | L2-Norm(final)=2.117 | 3762.4 samples/s | 58.8 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16154 | Reg=0.00363 | FP-Reg=0.008 | acc=0.9062 | L2-Norm=19.061 | L2-Norm(final)=2.128 | 3794.6 samples/s | 59.3 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15167 | Reg=0.00364 | FP-Reg=0.009 | acc=0.9688 | L2-Norm=19.086 | L2-Norm(final)=2.140 | 4481.7 samples/s | 70.0 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14191 | Reg=0.00365 | FP-Reg=0.010 | acc=0.9219 | L2-Norm=19.110 | L2-Norm(final)=2.151 | 1590.1 samples/s | 24.8 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13368 | Reg=0.00366 | FP-Reg=0.011 | acc=0.9219 | L2-Norm=19.132 | L2-Norm(final)=2.162 | 3794.4 samples/s | 59.3 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12707 | Reg=0.00367 | FP-Reg=0.011 | acc=0.9688 | L2-Norm=19.152 | L2-Norm(final)=2.173 | 3786.5 samples/s | 59.2 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12168 | Reg=0.00368 | FP-Reg=0.012 | acc=0.9688 | L2-Norm=19.172 | L2-Norm(final)=2.183 | 4240.6 samples/s | 66.3 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11645 | Reg=0.00368 | FP-Reg=0.012 | acc=0.9844 | L2-Norm=19.190 | L2-Norm(final)=2.192 | 1619.6 samples/s | 25.3 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11071 | Reg=0.00369 | FP-Reg=0.013 | acc=0.9844 | L2-Norm=19.208 | L2-Norm(final)=2.202 | 3803.9 samples/s | 59.4 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10637 | Reg=0.00370 | FP-Reg=0.013 | acc=0.9375 | L2-Norm=19.224 | L2-Norm(final)=2.211 | 3774.7 samples/s | 59.0 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10314 | Reg=0.00370 | FP-Reg=0.014 | acc=0.9062 | L2-Norm=19.239 | L2-Norm(final)=2.220 | 4053.5 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.32720 | Reg=0.00358 | FP-Reg=0.000 | acc=0.5156 | L2-Norm=18.928 | L2-Norm(final)=2.059 | 3277.0 samples/s | 51.2 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.13966 | Reg=0.00359 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=18.951 | L2-Norm(final)=2.077 | 3495.1 samples/s | 54.6 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.09577 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.997 | L2-Norm(final)=2.096 | 4556.7 samples/s | 71.2 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.06645 | Reg=0.00362 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.021 | L2-Norm(final)=2.108 | 1517.3 samples/s | 23.7 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.05102 | Reg=0.00362 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.031 | L2-Norm(final)=2.119 | 4275.3 samples/s | 66.8 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.04149 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.034 | L2-Norm(final)=2.127 | 1551.9 samples/s | 24.2 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.03477 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.035 | L2-Norm(final)=2.135 | 4035.1 samples/s | 63.0 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02990 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.032 | L2-Norm(final)=2.141 | 1576.5 samples/s | 24.6 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02624 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.028 | L2-Norm(final)=2.147 | 3875.0 samples/s | 60.5 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02338 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.024 | L2-Norm(final)=2.152 | 1607.3 samples/s | 25.1 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.02110 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.019 | L2-Norm(final)=2.157 | 3663.0 samples/s | 57.2 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01923 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.014 | L2-Norm(final)=2.161 | 1637.8 samples/s | 25.6 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01767 | Reg=0.00361 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.010 | L2-Norm(final)=2.166 | 3635.1 samples/s | 56.8 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01637 | Reg=0.00361 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.005 | L2-Norm(final)=2.170 | 1656.3 samples/s | 25.9 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01524 | Reg=0.00361 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.001 | L2-Norm(final)=2.174 | 3545.8 samples/s | 55.4 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01428 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.998 | L2-Norm(final)=2.178 | 1667.1 samples/s | 26.0 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01342 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.994 | L2-Norm(final)=2.182 | 3564.8 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.32243 | Reg=0.00358 | FP-Reg=0.000 | acc=0.5312 | L2-Norm=18.928 | L2-Norm(final)=2.061 | 3336.1 samples/s | 52.1 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.13909 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.949 | L2-Norm(final)=2.081 | 3476.1 samples/s | 54.3 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.08256 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.988 | L2-Norm(final)=2.107 | 4512.1 samples/s | 70.5 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.05749 | Reg=0.00361 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.005 | L2-Norm(final)=2.123 | 1516.6 samples/s | 23.7 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04380 | Reg=0.00361 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.012 | L2-Norm(final)=2.136 | 4178.5 samples/s | 65.3 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03533 | Reg=0.00361 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.013 | L2-Norm(final)=2.146 | 1555.7 samples/s | 24.3 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.02960 | Reg=0.00361 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.010 | L2-Norm(final)=2.154 | 3930.3 samples/s | 61.4 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02547 | Reg=0.00361 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.007 | L2-Norm(final)=2.162 | 1599.3 samples/s | 25.0 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02237 | Reg=0.00361 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.002 | L2-Norm(final)=2.169 | 3714.9 samples/s | 58.0 steps/s
[Step= 450 Epoch= 4.2] | Loss=0.02005 | Reg=0.00361 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=18.998 | L2-Norm(final)=2.175 | 1625.3 samples/s | 25.4 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.01812 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.995 | L2-Norm(final)=2.181 | 3612.9 samples/s | 56.5 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01652 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.992 | L2-Norm(final)=2.187 | 1656.1 samples/s | 25.9 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01519 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.989 | L2-Norm(final)=2.192 | 3619.1 samples/s | 56.5 steps/s
[Step= 650 Epoch= 6.1] | Loss=0.01406 | Reg=0.00360 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.985 | L2-Norm(final)=2.198 | 1651.0 samples/s | 25.8 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01308 | Reg=0.00360 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.982 | L2-Norm(final)=2.202 | 3581.6 samples/s | 56.0 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01224 | Reg=0.00360 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.978 | L2-Norm(final)=2.207 | 1712.3 samples/s | 26.8 steps/s
[Step= 800 Epoch= 7.5] | Loss=0.01151 | Reg=0.00360 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.975 | L2-Norm(final)=2.211 | 3480.8 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35032 | Reg=0.00358 | FP-Reg=0.000 | acc=0.4688 | L2-Norm=18.928 | L2-Norm(final)=2.060 | 3280.5 samples/s | 51.3 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.14048 | Reg=0.00359 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=18.952 | L2-Norm(final)=2.080 | 3376.1 samples/s | 52.8 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.08058 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.001 | L2-Norm(final)=2.109 | 4541.5 samples/s | 71.0 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.05635 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.024 | L2-Norm(final)=2.127 | 1494.2 samples/s | 23.3 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04281 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.033 | L2-Norm(final)=2.141 | 4324.6 samples/s | 67.6 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03459 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.033 | L2-Norm(final)=2.152 | 1520.3 samples/s | 23.8 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.02893 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.031 | L2-Norm(final)=2.162 | 4122.3 samples/s | 64.4 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02488 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.026 | L2-Norm(final)=2.169 | 1537.2 samples/s | 24.0 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02183 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.020 | L2-Norm(final)=2.176 | 3939.1 samples/s | 61.5 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.01948 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.015 | L2-Norm(final)=2.183 | 1569.2 samples/s | 24.5 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01759 | Reg=0.00361 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.010 | L2-Norm(final)=2.189 | 3787.5 samples/s | 59.2 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01604 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.005 | L2-Norm(final)=2.194 | 1586.0 samples/s | 24.8 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01474 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.001 | L2-Norm(final)=2.200 | 3640.1 samples/s | 56.9 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01365 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.997 | L2-Norm(final)=2.205 | 1621.1 samples/s | 25.3 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01271 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.993 | L2-Norm(final)=2.210 | 3584.3 samples/s | 56.0 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01370 | Reg=0.00361 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=18.991 | L2-Norm(final)=2.214 | 1649.6 samples/s | 25.8 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01387 | Reg=0.00361 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.003 | L2-Norm(final)=2.217 | 3580.5 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33630 | acc=0.6441 | tpr=0.9079 | fpr=0.9289 | 3748.6 samples/s | 14.6 steps/s
Avg test loss: 0.33461, Avg test acc: 0.64797, Avg tpr: 0.91007, Avg fpr: 0.92847, total FA: 7243

Testing server on iccad2012
[Step=  50] | Loss=0.43424 | acc=0.3526 | tpr=1.0000 | fpr=0.6591 | 3721.1 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.43443 | acc=0.3551 | tpr=1.0000 | fpr=0.6569 | 7456.6 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.43521 | acc=0.3543 | tpr=1.0000 | fpr=0.6575 | 7597.4 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.43532 | acc=0.3533 | tpr=1.0000 | fpr=0.6585 | 7267.1 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.43621 | acc=0.3532 | tpr=0.9991 | fpr=0.6586 | 7440.5 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.43604 | acc=0.3536 | tpr=0.9978 | fpr=0.6582 | 7364.2 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.43627 | acc=0.3536 | tpr=0.9969 | fpr=0.6581 | 7406.8 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.43650 | acc=0.3530 | tpr=0.9967 | fpr=0.6587 | 7358.7 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.43652 | acc=0.3530 | tpr=0.9966 | fpr=0.6587 | 7417.1 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.43669 | acc=0.3529 | tpr=0.9960 | fpr=0.6587 | 7192.0 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.43654 | acc=0.3527 | tpr=0.9956 | fpr=0.6590 | 13814.4 samples/s | 54.0 steps/s
Avg test loss: 0.43647, Avg test acc: 0.35283, Avg tpr: 0.99564, Avg fpr: 0.65886, total FA: 91481

server round 1/50

clients selected: [0 1 4 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.40188 | Reg=0.00358 | FP-Reg=0.000 | acc=0.4688 | L2-Norm=18.930 | L2-Norm(final)=2.161 | 3305.9 samples/s | 51.7 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.24152 | Reg=0.00358 | FP-Reg=0.002 | acc=0.8125 | L2-Norm=18.928 | L2-Norm(final)=2.162 | 3707.2 samples/s | 57.9 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.20975 | Reg=0.00359 | FP-Reg=0.003 | acc=0.8125 | L2-Norm=18.949 | L2-Norm(final)=2.169 | 3805.7 samples/s | 59.5 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.18720 | Reg=0.00360 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=18.968 | L2-Norm(final)=2.177 | 3800.0 samples/s | 59.4 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.17301 | Reg=0.00361 | FP-Reg=0.004 | acc=0.8906 | L2-Norm=18.988 | L2-Norm(final)=2.183 | 4734.6 samples/s | 74.0 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.15610 | Reg=0.00361 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.010 | L2-Norm(final)=2.192 | 1547.2 samples/s | 24.2 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.14720 | Reg=0.00362 | FP-Reg=0.006 | acc=0.8906 | L2-Norm=19.033 | L2-Norm(final)=2.201 | 3755.5 samples/s | 58.7 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.14003 | Reg=0.00363 | FP-Reg=0.007 | acc=0.9375 | L2-Norm=19.057 | L2-Norm(final)=2.208 | 3802.4 samples/s | 59.4 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.13335 | Reg=0.00364 | FP-Reg=0.007 | acc=0.9219 | L2-Norm=19.078 | L2-Norm(final)=2.216 | 4468.8 samples/s | 69.8 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.12480 | Reg=0.00365 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.098 | L2-Norm(final)=2.225 | 1577.8 samples/s | 24.7 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.11798 | Reg=0.00365 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.117 | L2-Norm(final)=2.234 | 3784.0 samples/s | 59.1 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.11246 | Reg=0.00366 | FP-Reg=0.009 | acc=0.9844 | L2-Norm=19.134 | L2-Norm(final)=2.243 | 3775.3 samples/s | 59.0 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.10803 | Reg=0.00367 | FP-Reg=0.009 | acc=0.9688 | L2-Norm=19.151 | L2-Norm(final)=2.251 | 4239.9 samples/s | 66.2 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.10341 | Reg=0.00367 | FP-Reg=0.010 | acc=0.9844 | L2-Norm=19.168 | L2-Norm(final)=2.259 | 1600.2 samples/s | 25.0 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.09869 | Reg=0.00368 | FP-Reg=0.010 | acc=0.9219 | L2-Norm=19.184 | L2-Norm(final)=2.267 | 3778.4 samples/s | 59.0 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.09468 | Reg=0.00369 | FP-Reg=0.011 | acc=0.9688 | L2-Norm=19.198 | L2-Norm(final)=2.275 | 3797.5 samples/s | 59.3 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.09137 | Reg=0.00369 | FP-Reg=0.011 | acc=0.8906 | L2-Norm=19.213 | L2-Norm(final)=2.283 | 4039.0 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.40874 | Reg=0.00358 | FP-Reg=0.000 | acc=0.4688 | L2-Norm=18.930 | L2-Norm(final)=2.161 | 3314.3 samples/s | 51.8 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.25916 | Reg=0.00360 | FP-Reg=0.003 | acc=0.7656 | L2-Norm=18.964 | L2-Norm(final)=2.156 | 3678.4 samples/s | 57.5 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.21310 | Reg=0.00361 | FP-Reg=0.004 | acc=0.8750 | L2-Norm=18.990 | L2-Norm(final)=2.163 | 3779.1 samples/s | 59.0 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.19039 | Reg=0.00362 | FP-Reg=0.005 | acc=0.9062 | L2-Norm=19.016 | L2-Norm(final)=2.174 | 3795.0 samples/s | 59.3 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.17776 | Reg=0.00363 | FP-Reg=0.005 | acc=0.9219 | L2-Norm=19.040 | L2-Norm(final)=2.184 | 4720.4 samples/s | 73.8 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.16060 | Reg=0.00363 | FP-Reg=0.006 | acc=0.9219 | L2-Norm=19.064 | L2-Norm(final)=2.193 | 1550.7 samples/s | 24.2 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.14704 | Reg=0.00364 | FP-Reg=0.007 | acc=0.8906 | L2-Norm=19.087 | L2-Norm(final)=2.204 | 3792.5 samples/s | 59.3 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.14030 | Reg=0.00365 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.108 | L2-Norm(final)=2.214 | 3791.9 samples/s | 59.2 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.13186 | Reg=0.00366 | FP-Reg=0.008 | acc=0.9375 | L2-Norm=19.131 | L2-Norm(final)=2.224 | 4479.9 samples/s | 70.0 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.12394 | Reg=0.00367 | FP-Reg=0.009 | acc=0.9844 | L2-Norm=19.151 | L2-Norm(final)=2.233 | 1576.3 samples/s | 24.6 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.11669 | Reg=0.00368 | FP-Reg=0.009 | acc=0.9688 | L2-Norm=19.171 | L2-Norm(final)=2.244 | 3793.5 samples/s | 59.3 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.11128 | Reg=0.00368 | FP-Reg=0.010 | acc=0.9375 | L2-Norm=19.190 | L2-Norm(final)=2.254 | 3796.9 samples/s | 59.3 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.10642 | Reg=0.00369 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.207 | L2-Norm(final)=2.263 | 4311.9 samples/s | 67.4 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.10134 | Reg=0.00370 | FP-Reg=0.011 | acc=0.9531 | L2-Norm=19.224 | L2-Norm(final)=2.272 | 1593.4 samples/s | 24.9 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.09694 | Reg=0.00370 | FP-Reg=0.011 | acc=0.9531 | L2-Norm=19.240 | L2-Norm(final)=2.281 | 3789.4 samples/s | 59.2 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.09356 | Reg=0.00371 | FP-Reg=0.011 | acc=0.9844 | L2-Norm=19.255 | L2-Norm(final)=2.290 | 3788.9 samples/s | 59.2 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.09020 | Reg=0.00371 | FP-Reg=0.012 | acc=0.9688 | L2-Norm=19.269 | L2-Norm(final)=2.299 | 4156.4 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step1600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34761 | Reg=0.00358 | FP-Reg=0.000 | acc=0.6094 | L2-Norm=18.930 | L2-Norm(final)=2.160 | 3447.5 samples/s | 53.9 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.23153 | Reg=0.00359 | FP-Reg=0.002 | acc=0.8281 | L2-Norm=18.936 | L2-Norm(final)=2.166 | 3509.3 samples/s | 54.8 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.19792 | Reg=0.00359 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=18.957 | L2-Norm(final)=2.175 | 3789.1 samples/s | 59.2 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.17687 | Reg=0.00360 | FP-Reg=0.004 | acc=0.9219 | L2-Norm=18.979 | L2-Norm(final)=2.184 | 3797.4 samples/s | 59.3 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.16136 | Reg=0.00361 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.002 | L2-Norm(final)=2.194 | 4748.4 samples/s | 74.2 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.14729 | Reg=0.00362 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.025 | L2-Norm(final)=2.205 | 1546.6 samples/s | 24.2 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.13654 | Reg=0.00363 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.048 | L2-Norm(final)=2.216 | 3796.4 samples/s | 59.3 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.12763 | Reg=0.00364 | FP-Reg=0.007 | acc=0.9219 | L2-Norm=19.070 | L2-Norm(final)=2.227 | 3813.8 samples/s | 59.6 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.12087 | Reg=0.00364 | FP-Reg=0.007 | acc=0.9531 | L2-Norm=19.091 | L2-Norm(final)=2.238 | 4582.8 samples/s | 71.6 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.11280 | Reg=0.00365 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.110 | L2-Norm(final)=2.248 | 1569.1 samples/s | 24.5 steps/s
[Step= 500 Epoch= 2.5] | Loss=0.10676 | Reg=0.00366 | FP-Reg=0.008 | acc=0.9531 | L2-Norm=19.129 | L2-Norm(final)=2.258 | 3788.9 samples/s | 59.2 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.10228 | Reg=0.00367 | FP-Reg=0.009 | acc=0.9375 | L2-Norm=19.147 | L2-Norm(final)=2.267 | 3796.1 samples/s | 59.3 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.09815 | Reg=0.00367 | FP-Reg=0.009 | acc=0.9531 | L2-Norm=19.163 | L2-Norm(final)=2.276 | 4434.9 samples/s | 69.3 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.09309 | Reg=0.00368 | FP-Reg=0.010 | acc=0.9844 | L2-Norm=19.178 | L2-Norm(final)=2.284 | 1580.2 samples/s | 24.7 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.08926 | Reg=0.00368 | FP-Reg=0.010 | acc=0.9688 | L2-Norm=19.192 | L2-Norm(final)=2.293 | 3765.2 samples/s | 58.8 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.08540 | Reg=0.00369 | FP-Reg=0.011 | acc=0.9688 | L2-Norm=19.205 | L2-Norm(final)=2.301 | 3771.9 samples/s | 58.9 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.08341 | Reg=0.00369 | FP-Reg=0.011 | acc=0.9062 | L2-Norm=19.218 | L2-Norm(final)=2.310 | 4292.3 samples/s | 67.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.29228 | Reg=0.00358 | FP-Reg=0.000 | acc=0.6562 | L2-Norm=18.930 | L2-Norm(final)=2.162 | 3227.5 samples/s | 50.4 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.08339 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.957 | L2-Norm(final)=2.181 | 3433.8 samples/s | 53.7 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.04946 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.976 | L2-Norm(final)=2.195 | 4562.9 samples/s | 71.3 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.03409 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.982 | L2-Norm(final)=2.206 | 1508.9 samples/s | 23.6 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.02585 | Reg=0.00360 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.981 | L2-Norm(final)=2.216 | 4340.0 samples/s | 67.8 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.02079 | Reg=0.00360 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.977 | L2-Norm(final)=2.224 | 1527.3 samples/s | 23.9 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.01740 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.973 | L2-Norm(final)=2.230 | 4133.5 samples/s | 64.6 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.01497 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.968 | L2-Norm(final)=2.236 | 1547.0 samples/s | 24.2 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.01314 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.962 | L2-Norm(final)=2.241 | 3952.7 samples/s | 61.8 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.01173 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.957 | L2-Norm(final)=2.246 | 1571.2 samples/s | 24.5 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01059 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.953 | L2-Norm(final)=2.250 | 3807.2 samples/s | 59.5 steps/s
[Step= 550 Epoch= 5.3] | Loss=0.00965 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.948 | L2-Norm(final)=2.254 | 1600.6 samples/s | 25.0 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.00887 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.944 | L2-Norm(final)=2.258 | 3652.0 samples/s | 57.1 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.00821 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.941 | L2-Norm(final)=2.262 | 1625.2 samples/s | 25.4 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.00765 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.937 | L2-Norm(final)=2.266 | 3616.4 samples/s | 56.5 steps/s
[Step= 750 Epoch= 7.2] | Loss=0.00716 | Reg=0.00358 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.934 | L2-Norm(final)=2.269 | 1636.6 samples/s | 25.6 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00673 | Reg=0.00358 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.931 | L2-Norm(final)=2.273 | 3609.7 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.5] | Loss=0.22706 | Reg=0.00358 | FP-Reg=0.000 | acc=0.7344 | L2-Norm=18.930 | L2-Norm(final)=2.159 | 3455.6 samples/s | 54.0 steps/s
[Step= 850 Epoch= 8.0] | Loss=0.08208 | Reg=0.00363 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.056 | L2-Norm(final)=2.150 | 3230.0 samples/s | 50.5 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.04454 | Reg=0.00364 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.082 | L2-Norm(final)=2.161 | 4526.0 samples/s | 70.7 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.03089 | Reg=0.00364 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.080 | L2-Norm(final)=2.174 | 1514.6 samples/s | 23.7 steps/s
[Step=1000 Epoch= 9.4] | Loss=0.02367 | Reg=0.00364 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.074 | L2-Norm(final)=2.184 | 4189.3 samples/s | 65.5 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01909 | Reg=0.00364 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.066 | L2-Norm(final)=2.193 | 1542.7 samples/s | 24.1 steps/s
[Step=1100 Epoch=10.4] | Loss=0.01596 | Reg=0.00363 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.056 | L2-Norm(final)=2.200 | 3944.4 samples/s | 61.6 steps/s
[Step=1150 Epoch=10.8] | Loss=0.01372 | Reg=0.00363 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.046 | L2-Norm(final)=2.206 | 1571.3 samples/s | 24.6 steps/s
[Step=1200 Epoch=11.3] | Loss=0.01204 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.037 | L2-Norm(final)=2.212 | 3697.3 samples/s | 57.8 steps/s
[Step=1250 Epoch=11.8] | Loss=0.01074 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.028 | L2-Norm(final)=2.217 | 1636.6 samples/s | 25.6 steps/s
[Step=1300 Epoch=12.2] | Loss=0.00969 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.019 | L2-Norm(final)=2.222 | 3593.2 samples/s | 56.1 steps/s
[Step=1350 Epoch=12.7] | Loss=0.00884 | Reg=0.00361 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.012 | L2-Norm(final)=2.226 | 1629.7 samples/s | 25.5 steps/s
[Step=1400 Epoch=13.2] | Loss=0.00813 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.004 | L2-Norm(final)=2.231 | 3619.2 samples/s | 56.5 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00752 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.998 | L2-Norm(final)=2.235 | 1653.5 samples/s | 25.8 steps/s
[Step=1500 Epoch=14.1] | Loss=0.00701 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.992 | L2-Norm(final)=2.239 | 3571.5 samples/s | 55.8 steps/s
[Step=1550 Epoch=14.6] | Loss=0.00656 | Reg=0.00360 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.986 | L2-Norm(final)=2.242 | 1637.5 samples/s | 25.6 steps/s
[Step=1600 Epoch=15.1] | Loss=0.00617 | Reg=0.00360 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.981 | L2-Norm(final)=2.246 | 3628.0 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26129 | acc=0.7535 | tpr=0.8976 | fpr=0.5595 | 3713.4 samples/s | 14.5 steps/s
Avg test loss: 0.25980, Avg test acc: 0.75775, Avg tpr: 0.89742, Avg fpr: 0.54942, total FA: 4286

Testing server on iccad2012
[Step=  50] | Loss=0.43134 | acc=0.4540 | tpr=0.9779 | fpr=0.5554 | 3728.6 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.43327 | acc=0.4539 | tpr=0.9851 | fpr=0.5560 | 7491.0 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.43377 | acc=0.4529 | tpr=0.9827 | fpr=0.5569 | 7498.5 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.43429 | acc=0.4523 | tpr=0.9803 | fpr=0.5573 | 7295.9 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.43570 | acc=0.4516 | tpr=0.9790 | fpr=0.5580 | 7361.0 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.43522 | acc=0.4518 | tpr=0.9789 | fpr=0.5578 | 7328.0 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.43564 | acc=0.4511 | tpr=0.9781 | fpr=0.5585 | 7478.5 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.43599 | acc=0.4513 | tpr=0.9787 | fpr=0.5583 | 7659.1 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.43616 | acc=0.4509 | tpr=0.9771 | fpr=0.5586 | 7169.2 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.43637 | acc=0.4503 | tpr=0.9767 | fpr=0.5592 | 7243.4 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.43591 | acc=0.4504 | tpr=0.9761 | fpr=0.5592 | 13389.4 samples/s | 52.3 steps/s
Avg test loss: 0.43583, Avg test acc: 0.45047, Avg tpr: 0.97623, Avg fpr: 0.55909, total FA: 77628

server round 2/50

clients selected: [2 4 6 7 8]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33197 | Reg=0.00360 | FP-Reg=0.000 | acc=0.5938 | L2-Norm=18.968 | L2-Norm(final)=2.267 | 3443.3 samples/s | 53.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.17354 | Reg=0.00360 | FP-Reg=0.001 | acc=0.8906 | L2-Norm=18.974 | L2-Norm(final)=2.270 | 3492.2 samples/s | 54.6 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.15228 | Reg=0.00361 | FP-Reg=0.002 | acc=0.9062 | L2-Norm=18.994 | L2-Norm(final)=2.277 | 3792.1 samples/s | 59.3 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.13790 | Reg=0.00362 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.014 | L2-Norm(final)=2.285 | 3799.3 samples/s | 59.4 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.12810 | Reg=0.00362 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.032 | L2-Norm(final)=2.292 | 4699.9 samples/s | 73.4 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.11493 | Reg=0.00363 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.051 | L2-Norm(final)=2.301 | 1543.7 samples/s | 24.1 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.10631 | Reg=0.00364 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.070 | L2-Norm(final)=2.312 | 3769.5 samples/s | 58.9 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.10063 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.090 | L2-Norm(final)=2.321 | 3790.0 samples/s | 59.2 steps/s
[Step= 400 Epoch= 1.9] | Loss=0.09655 | Reg=0.00365 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.108 | L2-Norm(final)=2.330 | 4464.4 samples/s | 69.8 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.09101 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.126 | L2-Norm(final)=2.338 | 1590.0 samples/s | 24.8 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.08607 | Reg=0.00366 | FP-Reg=0.006 | acc=0.9062 | L2-Norm=19.143 | L2-Norm(final)=2.347 | 3791.2 samples/s | 59.2 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.08336 | Reg=0.00367 | FP-Reg=0.006 | acc=0.9219 | L2-Norm=19.160 | L2-Norm(final)=2.354 | 3788.7 samples/s | 59.2 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.08058 | Reg=0.00368 | FP-Reg=0.007 | acc=0.9219 | L2-Norm=19.176 | L2-Norm(final)=2.361 | 4256.1 samples/s | 66.5 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.07785 | Reg=0.00368 | FP-Reg=0.007 | acc=0.9375 | L2-Norm=19.193 | L2-Norm(final)=2.368 | 1610.6 samples/s | 25.2 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.07470 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.208 | L2-Norm(final)=2.374 | 3792.6 samples/s | 59.3 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.07183 | Reg=0.00369 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.222 | L2-Norm(final)=2.381 | 3794.7 samples/s | 59.3 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.06981 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=2.387 | 4048.5 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.28079 | Reg=0.00360 | FP-Reg=0.000 | acc=0.7188 | L2-Norm=18.968 | L2-Norm(final)=2.265 | 3245.8 samples/s | 50.7 steps/s
[Step= 850 Epoch= 4.2] | Loss=0.17129 | Reg=0.00362 | FP-Reg=0.003 | acc=0.8438 | L2-Norm=19.015 | L2-Norm(final)=2.262 | 3823.4 samples/s | 59.7 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.15030 | Reg=0.00362 | FP-Reg=0.003 | acc=0.7344 | L2-Norm=19.035 | L2-Norm(final)=2.270 | 3794.6 samples/s | 59.3 steps/s
[Step= 950 Epoch= 4.7] | Loss=0.13632 | Reg=0.00363 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.053 | L2-Norm(final)=2.276 | 3795.8 samples/s | 59.3 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.12849 | Reg=0.00364 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.071 | L2-Norm(final)=2.282 | 4767.7 samples/s | 74.5 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.11614 | Reg=0.00364 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.091 | L2-Norm(final)=2.290 | 1538.1 samples/s | 24.0 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.10640 | Reg=0.00365 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.109 | L2-Norm(final)=2.301 | 3798.7 samples/s | 59.4 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09930 | Reg=0.00366 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.126 | L2-Norm(final)=2.311 | 3788.6 samples/s | 59.2 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.09357 | Reg=0.00366 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.141 | L2-Norm(final)=2.319 | 4584.6 samples/s | 71.6 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08746 | Reg=0.00367 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.156 | L2-Norm(final)=2.328 | 1561.4 samples/s | 24.4 steps/s
[Step=1300 Epoch= 6.4] | Loss=0.08220 | Reg=0.00368 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.171 | L2-Norm(final)=2.338 | 3781.2 samples/s | 59.1 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.07877 | Reg=0.00368 | FP-Reg=0.007 | acc=0.9375 | L2-Norm=19.185 | L2-Norm(final)=2.347 | 3776.6 samples/s | 59.0 steps/s
[Step=1400 Epoch= 6.9] | Loss=0.07586 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.199 | L2-Norm(final)=2.355 | 4438.5 samples/s | 69.4 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07197 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.213 | L2-Norm(final)=2.364 | 1574.6 samples/s | 24.6 steps/s
[Step=1500 Epoch= 7.4] | Loss=0.06936 | Reg=0.00370 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.226 | L2-Norm(final)=2.372 | 3742.0 samples/s | 58.5 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06768 | Reg=0.00370 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.239 | L2-Norm(final)=2.379 | 3785.1 samples/s | 59.1 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06534 | Reg=0.00371 | FP-Reg=0.008 | acc=0.9531 | L2-Norm=19.252 | L2-Norm(final)=2.386 | 4263.6 samples/s | 66.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step1600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.24204 | Reg=0.00360 | FP-Reg=0.000 | acc=0.7188 | L2-Norm=18.968 | L2-Norm(final)=2.267 | 3145.3 samples/s | 49.1 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.05997 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.981 | L2-Norm(final)=2.281 | 3534.2 samples/s | 55.2 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.03670 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.983 | L2-Norm(final)=2.290 | 4558.7 samples/s | 71.2 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.02661 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.986 | L2-Norm(final)=2.299 | 1500.9 samples/s | 23.5 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.02029 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.987 | L2-Norm(final)=2.308 | 4308.9 samples/s | 67.3 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.01635 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.986 | L2-Norm(final)=2.316 | 1537.9 samples/s | 24.0 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.01372 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.982 | L2-Norm(final)=2.323 | 4056.9 samples/s | 63.4 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.01181 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.978 | L2-Norm(final)=2.328 | 1564.8 samples/s | 24.4 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.01038 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.974 | L2-Norm(final)=2.333 | 3835.7 samples/s | 59.9 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.00925 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.970 | L2-Norm(final)=2.338 | 1594.3 samples/s | 24.9 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.00836 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.966 | L2-Norm(final)=2.342 | 3666.7 samples/s | 57.3 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.00762 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.962 | L2-Norm(final)=2.346 | 1607.8 samples/s | 25.1 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.00700 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.959 | L2-Norm(final)=2.349 | 3608.4 samples/s | 56.4 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.00648 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.955 | L2-Norm(final)=2.352 | 1624.3 samples/s | 25.4 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.00604 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.952 | L2-Norm(final)=2.355 | 3605.4 samples/s | 56.3 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00565 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.949 | L2-Norm(final)=2.359 | 1643.9 samples/s | 25.7 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00531 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.947 | L2-Norm(final)=2.361 | 3563.4 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.28081 | Reg=0.00360 | FP-Reg=0.000 | acc=0.7188 | L2-Norm=18.968 | L2-Norm(final)=2.263 | 3205.4 samples/s | 50.1 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.06515 | Reg=0.00366 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.131 | L2-Norm(final)=2.243 | 3523.8 samples/s | 55.1 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.03672 | Reg=0.00367 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.147 | L2-Norm(final)=2.250 | 4540.1 samples/s | 70.9 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.02479 | Reg=0.00366 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.140 | L2-Norm(final)=2.260 | 1491.8 samples/s | 23.3 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01872 | Reg=0.00366 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.125 | L2-Norm(final)=2.269 | 4352.7 samples/s | 68.0 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01502 | Reg=0.00365 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.111 | L2-Norm(final)=2.276 | 1519.5 samples/s | 23.7 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01255 | Reg=0.00365 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.097 | L2-Norm(final)=2.282 | 4153.9 samples/s | 64.9 steps/s
[Step=1150 Epoch=11.0] | Loss=0.01078 | Reg=0.00364 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.084 | L2-Norm(final)=2.286 | 1551.4 samples/s | 24.2 steps/s
[Step=1200 Epoch=11.5] | Loss=0.00946 | Reg=0.00364 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.072 | L2-Norm(final)=2.291 | 3969.9 samples/s | 62.0 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00843 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.061 | L2-Norm(final)=2.295 | 1581.3 samples/s | 24.7 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00761 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.051 | L2-Norm(final)=2.299 | 3774.1 samples/s | 59.0 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00694 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.042 | L2-Norm(final)=2.303 | 1609.8 samples/s | 25.2 steps/s
[Step=1400 Epoch=13.4] | Loss=0.00637 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.034 | L2-Norm(final)=2.306 | 3649.4 samples/s | 57.0 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00590 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.026 | L2-Norm(final)=2.309 | 1628.8 samples/s | 25.4 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00549 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.019 | L2-Norm(final)=2.313 | 3585.2 samples/s | 56.0 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00514 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.013 | L2-Norm(final)=2.316 | 1649.7 samples/s | 25.8 steps/s
[Step=1600 Epoch=15.3] | Loss=0.00483 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.006 | L2-Norm(final)=2.319 | 3592.6 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step1600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.1] | Loss=0.22530 | Reg=0.00360 | FP-Reg=0.000 | acc=0.7344 | L2-Norm=18.968 | L2-Norm(final)=2.264 | 3538.8 samples/s | 55.3 steps/s
[Step=1650 Epoch=15.5] | Loss=0.03961 | Reg=0.00366 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.131 | L2-Norm(final)=2.264 | 3328.1 samples/s | 52.0 steps/s
[Step=1700 Epoch=16.0] | Loss=0.03075 | Reg=0.00366 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.264 | 4523.6 samples/s | 70.7 steps/s
[Step=1750 Epoch=16.5] | Loss=0.02204 | Reg=0.00366 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.268 | 1506.6 samples/s | 23.5 steps/s
[Step=1800 Epoch=17.0] | Loss=0.01677 | Reg=0.00366 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.132 | L2-Norm(final)=2.275 | 4173.5 samples/s | 65.2 steps/s
[Step=1850 Epoch=17.4] | Loss=0.01347 | Reg=0.00366 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.122 | L2-Norm(final)=2.281 | 1556.9 samples/s | 24.3 steps/s
[Step=1900 Epoch=17.9] | Loss=0.01125 | Reg=0.00365 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.110 | L2-Norm(final)=2.287 | 3909.3 samples/s | 61.1 steps/s
[Step=1950 Epoch=18.4] | Loss=0.00968 | Reg=0.00365 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.098 | L2-Norm(final)=2.292 | 1582.1 samples/s | 24.7 steps/s
[Step=2000 Epoch=18.8] | Loss=0.00849 | Reg=0.00364 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.087 | L2-Norm(final)=2.296 | 3748.8 samples/s | 58.6 steps/s
[Step=2050 Epoch=19.3] | Loss=0.00757 | Reg=0.00364 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.076 | L2-Norm(final)=2.300 | 1626.2 samples/s | 25.4 steps/s
[Step=2100 Epoch=19.8] | Loss=0.00684 | Reg=0.00364 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.067 | L2-Norm(final)=2.304 | 3616.7 samples/s | 56.5 steps/s
[Step=2150 Epoch=20.3] | Loss=0.00623 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.058 | L2-Norm(final)=2.308 | 1642.5 samples/s | 25.7 steps/s
[Step=2200 Epoch=20.7] | Loss=0.00573 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.050 | L2-Norm(final)=2.312 | 3628.6 samples/s | 56.7 steps/s
[Step=2250 Epoch=21.2] | Loss=0.00531 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.042 | L2-Norm(final)=2.315 | 1630.0 samples/s | 25.5 steps/s
[Step=2300 Epoch=21.7] | Loss=0.00494 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.035 | L2-Norm(final)=2.318 | 3583.5 samples/s | 56.0 steps/s
[Step=2350 Epoch=22.1] | Loss=0.00463 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.028 | L2-Norm(final)=2.321 | 1706.0 samples/s | 26.7 steps/s
[Step=2400 Epoch=22.6] | Loss=0.00435 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.022 | L2-Norm(final)=2.324 | 3366.8 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20561 | acc=0.8123 | tpr=0.8404 | fpr=0.2485 | 3754.3 samples/s | 14.7 steps/s
Avg test loss: 0.20579, Avg test acc: 0.81309, Avg tpr: 0.84082, Avg fpr: 0.24792, total FA: 1934

Testing server on iccad2012
[Step=  50] | Loss=0.43324 | acc=0.5500 | tpr=0.9646 | fpr=0.4575 | 3745.9 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.43673 | acc=0.5518 | tpr=0.9659 | fpr=0.4560 | 7294.9 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.43653 | acc=0.5520 | tpr=0.9611 | fpr=0.4556 | 7524.5 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.43781 | acc=0.5509 | tpr=0.9574 | fpr=0.4565 | 7359.9 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.44015 | acc=0.5495 | tpr=0.9511 | fpr=0.4578 | 7392.3 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.43932 | acc=0.5493 | tpr=0.9484 | fpr=0.4579 | 7500.1 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.44016 | acc=0.5483 | tpr=0.9461 | fpr=0.4589 | 7091.1 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.44055 | acc=0.5475 | tpr=0.9453 | fpr=0.4597 | 7332.4 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.44079 | acc=0.5475 | tpr=0.9455 | fpr=0.4598 | 7334.2 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.44088 | acc=0.5474 | tpr=0.9467 | fpr=0.4598 | 7390.9 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.44007 | acc=0.5476 | tpr=0.9467 | fpr=0.4596 | 13258.0 samples/s | 51.8 steps/s
Avg test loss: 0.44001, Avg test acc: 0.54770, Avg tpr: 0.94651, Avg fpr: 0.45955, total FA: 63808

server round 3/50

clients selected: [2 3 7 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.21091 | Reg=0.00362 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.026 | L2-Norm(final)=2.365 | 3366.1 samples/s | 52.6 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.13154 | Reg=0.00363 | FP-Reg=0.002 | acc=0.8750 | L2-Norm=19.043 | L2-Norm(final)=2.358 | 3670.9 samples/s | 57.4 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.11651 | Reg=0.00363 | FP-Reg=0.002 | acc=0.8594 | L2-Norm=19.062 | L2-Norm(final)=2.364 | 3789.5 samples/s | 59.2 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.11148 | Reg=0.00364 | FP-Reg=0.003 | acc=0.9062 | L2-Norm=19.083 | L2-Norm(final)=2.368 | 3779.5 samples/s | 59.1 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.10429 | Reg=0.00365 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.100 | L2-Norm(final)=2.372 | 4704.7 samples/s | 73.5 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.09297 | Reg=0.00365 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.118 | L2-Norm(final)=2.379 | 1549.7 samples/s | 24.2 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.08594 | Reg=0.00366 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.135 | L2-Norm(final)=2.387 | 3767.8 samples/s | 58.9 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.08021 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.151 | L2-Norm(final)=2.396 | 3760.6 samples/s | 58.8 steps/s
[Step=1200 Epoch= 5.8] | Loss=0.07699 | Reg=0.00367 | FP-Reg=0.005 | acc=0.9219 | L2-Norm=19.166 | L2-Norm(final)=2.404 | 4422.1 samples/s | 69.1 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.07219 | Reg=0.00368 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.180 | L2-Norm(final)=2.411 | 1580.1 samples/s | 24.7 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.06833 | Reg=0.00368 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.195 | L2-Norm(final)=2.420 | 3781.8 samples/s | 59.1 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.06596 | Reg=0.00369 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.208 | L2-Norm(final)=2.428 | 3781.6 samples/s | 59.1 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.06330 | Reg=0.00369 | FP-Reg=0.006 | acc=0.9375 | L2-Norm=19.221 | L2-Norm(final)=2.434 | 4237.7 samples/s | 66.2 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.06097 | Reg=0.00370 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.233 | L2-Norm(final)=2.441 | 1610.4 samples/s | 25.2 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.05841 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.244 | L2-Norm(final)=2.448 | 3781.7 samples/s | 59.1 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.05654 | Reg=0.00371 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.256 | L2-Norm(final)=2.454 | 3778.1 samples/s | 59.0 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.05560 | Reg=0.00371 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.267 | L2-Norm(final)=2.460 | 4022.0 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step1600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.17688 | Reg=0.00362 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.026 | L2-Norm(final)=2.364 | 3351.5 samples/s | 52.4 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.12122 | Reg=0.00363 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.064 | L2-Norm(final)=2.363 | 3609.8 samples/s | 56.4 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.10667 | Reg=0.00364 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.081 | L2-Norm(final)=2.366 | 3785.4 samples/s | 59.1 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.10420 | Reg=0.00365 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.099 | L2-Norm(final)=2.370 | 3773.6 samples/s | 59.0 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.09770 | Reg=0.00365 | FP-Reg=0.004 | acc=0.9062 | L2-Norm=19.116 | L2-Norm(final)=2.371 | 4678.5 samples/s | 73.1 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.08881 | Reg=0.00366 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.132 | L2-Norm(final)=2.376 | 1557.8 samples/s | 24.3 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.08233 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.148 | L2-Norm(final)=2.381 | 3786.6 samples/s | 59.2 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.07890 | Reg=0.00367 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.163 | L2-Norm(final)=2.386 | 3769.4 samples/s | 58.9 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.07483 | Reg=0.00368 | FP-Reg=0.005 | acc=0.9219 | L2-Norm=19.178 | L2-Norm(final)=2.390 | 4449.3 samples/s | 69.5 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.06981 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.193 | L2-Norm(final)=2.397 | 1587.0 samples/s | 24.8 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.06624 | Reg=0.00369 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.207 | L2-Norm(final)=2.403 | 3754.4 samples/s | 58.7 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.06322 | Reg=0.00369 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.220 | L2-Norm(final)=2.409 | 3783.5 samples/s | 59.1 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.06131 | Reg=0.00370 | FP-Reg=0.006 | acc=0.9219 | L2-Norm=19.233 | L2-Norm(final)=2.415 | 4160.9 samples/s | 65.0 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.05913 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.246 | L2-Norm(final)=2.421 | 1610.1 samples/s | 25.2 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.05686 | Reg=0.00371 | FP-Reg=0.007 | acc=0.9688 | L2-Norm=19.259 | L2-Norm(final)=2.426 | 3803.9 samples/s | 59.4 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.05522 | Reg=0.00371 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.271 | L2-Norm(final)=2.432 | 3772.9 samples/s | 59.0 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.05361 | Reg=0.00372 | FP-Reg=0.007 | acc=0.9531 | L2-Norm=19.282 | L2-Norm(final)=2.437 | 4027.7 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step1600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.3] | Loss=0.26049 | Reg=0.00362 | FP-Reg=0.000 | acc=0.7500 | L2-Norm=19.026 | L2-Norm(final)=2.362 | 3159.1 samples/s | 49.4 steps/s
[Step=1650 Epoch=15.8] | Loss=0.07425 | Reg=0.00370 | FP-Reg=0.011 | acc=0.9688 | L2-Norm=19.227 | L2-Norm(final)=2.315 | 3588.7 samples/s | 56.1 steps/s
[Step=1700 Epoch=16.2] | Loss=0.04034 | Reg=0.00372 | FP-Reg=0.013 | acc=0.9844 | L2-Norm=19.282 | L2-Norm(final)=2.320 | 4533.7 samples/s | 70.8 steps/s
[Step=1750 Epoch=16.7] | Loss=0.02741 | Reg=0.00371 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.273 | L2-Norm(final)=2.327 | 1499.9 samples/s | 23.4 steps/s
[Step=1800 Epoch=17.2] | Loss=0.02082 | Reg=0.00371 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.254 | L2-Norm(final)=2.334 | 4352.4 samples/s | 68.0 steps/s
[Step=1850 Epoch=17.7] | Loss=0.01671 | Reg=0.00370 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=2.339 | 1526.9 samples/s | 23.9 steps/s
[Step=1900 Epoch=18.1] | Loss=0.01396 | Reg=0.00369 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.217 | L2-Norm(final)=2.344 | 4140.5 samples/s | 64.7 steps/s
[Step=1950 Epoch=18.6] | Loss=0.01200 | Reg=0.00369 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.200 | L2-Norm(final)=2.348 | 1555.7 samples/s | 24.3 steps/s
[Step=2000 Epoch=19.1] | Loss=0.01052 | Reg=0.00368 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.185 | L2-Norm(final)=2.352 | 3927.0 samples/s | 61.4 steps/s
[Step=2050 Epoch=19.6] | Loss=0.00937 | Reg=0.00368 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.171 | L2-Norm(final)=2.355 | 1562.0 samples/s | 24.4 steps/s
[Step=2100 Epoch=20.1] | Loss=0.00845 | Reg=0.00367 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.158 | L2-Norm(final)=2.359 | 3790.6 samples/s | 59.2 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00770 | Reg=0.00367 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.146 | L2-Norm(final)=2.362 | 1599.5 samples/s | 25.0 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00707 | Reg=0.00366 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.135 | L2-Norm(final)=2.365 | 3625.9 samples/s | 56.7 steps/s
[Step=2250 Epoch=21.5] | Loss=0.00654 | Reg=0.00366 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.125 | L2-Norm(final)=2.368 | 1631.0 samples/s | 25.5 steps/s
[Step=2300 Epoch=22.0] | Loss=0.00608 | Reg=0.00365 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.116 | L2-Norm(final)=2.371 | 3578.4 samples/s | 55.9 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00568 | Reg=0.00365 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.108 | L2-Norm(final)=2.374 | 1647.0 samples/s | 25.7 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00534 | Reg=0.00365 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.100 | L2-Norm(final)=2.376 | 3622.5 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step2400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.6] | Loss=0.26270 | Reg=0.00362 | FP-Reg=0.000 | acc=0.7188 | L2-Norm=19.026 | L2-Norm(final)=2.362 | 3308.4 samples/s | 51.7 steps/s
[Step=2450 Epoch=23.1] | Loss=0.05488 | Reg=0.00369 | FP-Reg=0.009 | acc=0.9688 | L2-Norm=19.208 | L2-Norm(final)=2.325 | 3467.9 samples/s | 54.2 steps/s
[Step=2500 Epoch=23.6] | Loss=0.03376 | Reg=0.00370 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.228 | L2-Norm(final)=2.321 | 4482.9 samples/s | 70.0 steps/s
[Step=2550 Epoch=24.0] | Loss=0.02281 | Reg=0.00369 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.219 | L2-Norm(final)=2.328 | 1511.0 samples/s | 23.6 steps/s
[Step=2600 Epoch=24.5] | Loss=0.01748 | Reg=0.00369 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.204 | L2-Norm(final)=2.335 | 4204.9 samples/s | 65.7 steps/s
[Step=2650 Epoch=25.0] | Loss=0.01413 | Reg=0.00368 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.188 | L2-Norm(final)=2.342 | 1554.1 samples/s | 24.3 steps/s
[Step=2700 Epoch=25.4] | Loss=0.01182 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.174 | L2-Norm(final)=2.348 | 3945.9 samples/s | 61.7 steps/s
[Step=2750 Epoch=25.9] | Loss=0.01016 | Reg=0.00367 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.161 | L2-Norm(final)=2.353 | 1586.4 samples/s | 24.8 steps/s
[Step=2800 Epoch=26.4] | Loss=0.00891 | Reg=0.00367 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.358 | 3750.3 samples/s | 58.6 steps/s
[Step=2850 Epoch=26.9] | Loss=0.00794 | Reg=0.00366 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.363 | 1626.8 samples/s | 25.4 steps/s
[Step=2900 Epoch=27.3] | Loss=0.00717 | Reg=0.00366 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.126 | L2-Norm(final)=2.367 | 3587.3 samples/s | 56.1 steps/s
[Step=2950 Epoch=27.8] | Loss=0.00653 | Reg=0.00365 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.116 | L2-Norm(final)=2.371 | 1648.5 samples/s | 25.8 steps/s
[Step=3000 Epoch=28.3] | Loss=0.00600 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.107 | L2-Norm(final)=2.375 | 3648.8 samples/s | 57.0 steps/s
[Step=3050 Epoch=28.7] | Loss=0.00556 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.099 | L2-Norm(final)=2.378 | 1654.4 samples/s | 25.9 steps/s
[Step=3100 Epoch=29.2] | Loss=0.00517 | Reg=0.00364 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.091 | L2-Norm(final)=2.382 | 3534.0 samples/s | 55.2 steps/s
[Step=3150 Epoch=29.7] | Loss=0.00484 | Reg=0.00364 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.084 | L2-Norm(final)=2.386 | 1735.7 samples/s | 27.1 steps/s
[Step=3200 Epoch=30.2] | Loss=0.00455 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.077 | L2-Norm(final)=2.389 | 3187.3 samples/s | 49.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step3200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.22946 | Reg=0.00362 | FP-Reg=0.000 | acc=0.7656 | L2-Norm=19.026 | L2-Norm(final)=2.363 | 3209.4 samples/s | 50.1 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.03232 | Reg=0.00365 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.100 | L2-Norm(final)=2.356 | 2953.8 samples/s | 46.2 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.01763 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.094 | L2-Norm(final)=2.363 | 4406.6 samples/s | 68.9 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.01200 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.082 | L2-Norm(final)=2.369 | 1328.8 samples/s | 20.8 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.00916 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.071 | L2-Norm(final)=2.374 | 3657.9 samples/s | 57.2 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00740 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.062 | L2-Norm(final)=2.379 | 1327.3 samples/s | 20.7 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00620 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.383 | 3509.8 samples/s | 54.8 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00534 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.046 | L2-Norm(final)=2.386 | 1474.3 samples/s | 23.0 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00469 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.039 | L2-Norm(final)=2.389 | 3959.5 samples/s | 61.9 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00419 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.033 | L2-Norm(final)=2.392 | 1583.7 samples/s | 24.7 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00379 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.027 | L2-Norm(final)=2.395 | 3763.9 samples/s | 58.8 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00346 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.022 | L2-Norm(final)=2.398 | 1605.9 samples/s | 25.1 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00318 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.017 | L2-Norm(final)=2.400 | 3630.5 samples/s | 56.7 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00295 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.013 | L2-Norm(final)=2.402 | 1635.8 samples/s | 25.6 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00275 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.009 | L2-Norm(final)=2.405 | 3567.6 samples/s | 55.7 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00258 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.005 | L2-Norm(final)=2.407 | 1635.4 samples/s | 25.6 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00243 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.002 | L2-Norm(final)=2.409 | 3627.4 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23144 | acc=0.7898 | tpr=0.7230 | fpr=0.0649 | 3735.6 samples/s | 14.6 steps/s
Avg test loss: 0.23319, Avg test acc: 0.79013, Avg tpr: 0.72297, Avg fpr: 0.06217, total FA: 485

Testing server on iccad2012
[Step=  50] | Loss=0.38285 | acc=0.6365 | tpr=0.8805 | fpr=0.3679 | 3752.9 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.38639 | acc=0.6359 | tpr=0.8849 | fpr=0.3687 | 7251.0 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.38568 | acc=0.6359 | tpr=0.8818 | fpr=0.3687 | 7461.0 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.38704 | acc=0.6361 | tpr=0.8852 | fpr=0.3684 | 7367.8 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.38923 | acc=0.6354 | tpr=0.8742 | fpr=0.3690 | 7534.8 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.38858 | acc=0.6351 | tpr=0.8720 | fpr=0.3692 | 7169.6 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.38924 | acc=0.6341 | tpr=0.8741 | fpr=0.3703 | 7523.9 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.38947 | acc=0.6328 | tpr=0.8709 | fpr=0.3715 | 7328.0 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.38955 | acc=0.6327 | tpr=0.8715 | fpr=0.3716 | 7395.2 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.38949 | acc=0.6327 | tpr=0.8692 | fpr=0.3716 | 7248.3 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.38884 | acc=0.6331 | tpr=0.8711 | fpr=0.3712 | 14108.5 samples/s | 55.1 steps/s
Avg test loss: 0.38884, Avg test acc: 0.63312, Avg tpr: 0.87124, Avg fpr: 0.37120, total FA: 51541

server round 4/50

clients selected: [0 5 6 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.22863 | Reg=0.00363 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.048 | L2-Norm(final)=2.421 | 3301.9 samples/s | 51.6 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.12125 | Reg=0.00364 | FP-Reg=0.002 | acc=0.8594 | L2-Norm=19.068 | L2-Norm(final)=2.406 | 3656.1 samples/s | 57.1 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.10947 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9062 | L2-Norm=19.089 | L2-Norm(final)=2.405 | 3784.3 samples/s | 59.1 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.09889 | Reg=0.00365 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.107 | L2-Norm(final)=2.409 | 3786.7 samples/s | 59.2 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.09171 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.124 | L2-Norm(final)=2.412 | 4705.9 samples/s | 73.5 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.08227 | Reg=0.00366 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.141 | L2-Norm(final)=2.415 | 1553.7 samples/s | 24.3 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.07737 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.156 | L2-Norm(final)=2.421 | 3790.9 samples/s | 59.2 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.07198 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.172 | L2-Norm(final)=2.428 | 3768.6 samples/s | 58.9 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.06868 | Reg=0.00368 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.187 | L2-Norm(final)=2.435 | 4471.6 samples/s | 69.9 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.06525 | Reg=0.00369 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.200 | L2-Norm(final)=2.441 | 1578.7 samples/s | 24.7 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.06148 | Reg=0.00369 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.213 | L2-Norm(final)=2.447 | 3787.2 samples/s | 59.2 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.05971 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.226 | L2-Norm(final)=2.454 | 3782.8 samples/s | 59.1 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.05769 | Reg=0.00370 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.240 | L2-Norm(final)=2.460 | 4258.1 samples/s | 66.5 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.05565 | Reg=0.00371 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.253 | L2-Norm(final)=2.465 | 1600.8 samples/s | 25.0 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.05354 | Reg=0.00371 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.265 | L2-Norm(final)=2.470 | 3779.5 samples/s | 59.1 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.05179 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.275 | L2-Norm(final)=2.475 | 3779.6 samples/s | 59.1 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.05034 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.286 | L2-Norm(final)=2.479 | 4045.2 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step1600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.28883 | Reg=0.00363 | FP-Reg=0.000 | acc=0.7500 | L2-Norm=19.048 | L2-Norm(final)=2.420 | 3229.6 samples/s | 50.5 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.04542 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.163 | L2-Norm(final)=2.384 | 3467.8 samples/s | 54.2 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.02767 | Reg=0.00367 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.165 | L2-Norm(final)=2.383 | 4522.4 samples/s | 70.7 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01871 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.155 | L2-Norm(final)=2.386 | 1506.5 samples/s | 23.5 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01422 | Reg=0.00366 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.143 | L2-Norm(final)=2.390 | 4269.9 samples/s | 66.7 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01150 | Reg=0.00366 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.131 | L2-Norm(final)=2.394 | 1535.4 samples/s | 24.0 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00962 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.120 | L2-Norm(final)=2.397 | 4058.8 samples/s | 63.4 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00827 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.110 | L2-Norm(final)=2.401 | 1560.8 samples/s | 24.4 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00725 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.101 | L2-Norm(final)=2.404 | 3839.2 samples/s | 60.0 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00646 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.092 | L2-Norm(final)=2.407 | 1604.8 samples/s | 25.1 steps/s
[Step=1300 Epoch=12.3] | Loss=0.00583 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.084 | L2-Norm(final)=2.410 | 3659.9 samples/s | 57.2 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00531 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.077 | L2-Norm(final)=2.412 | 1634.7 samples/s | 25.5 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00488 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.070 | L2-Norm(final)=2.415 | 3596.0 samples/s | 56.2 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00451 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.063 | L2-Norm(final)=2.417 | 1634.0 samples/s | 25.5 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00420 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.057 | L2-Norm(final)=2.420 | 3596.1 samples/s | 56.2 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00393 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.052 | L2-Norm(final)=2.422 | 1661.0 samples/s | 26.0 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00369 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.047 | L2-Norm(final)=2.425 | 3556.5 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step1600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.27190 | Reg=0.00363 | FP-Reg=0.000 | acc=0.7500 | L2-Norm=19.048 | L2-Norm(final)=2.419 | 3130.1 samples/s | 48.9 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.04545 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.171 | L2-Norm(final)=2.378 | 3564.4 samples/s | 55.7 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.02720 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.176 | L2-Norm(final)=2.379 | 4533.4 samples/s | 70.8 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01830 | Reg=0.00367 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.168 | L2-Norm(final)=2.384 | 1503.9 samples/s | 23.5 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01391 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.154 | L2-Norm(final)=2.390 | 4278.8 samples/s | 66.9 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01121 | Reg=0.00366 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.142 | L2-Norm(final)=2.396 | 1531.9 samples/s | 23.9 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00936 | Reg=0.00366 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.130 | L2-Norm(final)=2.401 | 4041.2 samples/s | 63.1 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00804 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.119 | L2-Norm(final)=2.405 | 1556.6 samples/s | 24.3 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00704 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.108 | L2-Norm(final)=2.409 | 3858.1 samples/s | 60.3 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00627 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.098 | L2-Norm(final)=2.413 | 1591.0 samples/s | 24.9 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00566 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.089 | L2-Norm(final)=2.416 | 3667.0 samples/s | 57.3 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00515 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.081 | L2-Norm(final)=2.420 | 1639.1 samples/s | 25.6 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00473 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.074 | L2-Norm(final)=2.423 | 3577.6 samples/s | 55.9 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00438 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.067 | L2-Norm(final)=2.426 | 1653.1 samples/s | 25.8 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00407 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.061 | L2-Norm(final)=2.429 | 3609.7 samples/s | 56.4 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00381 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.055 | L2-Norm(final)=2.432 | 1652.7 samples/s | 25.8 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00358 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.049 | L2-Norm(final)=2.434 | 3561.4 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step1600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.9] | Loss=0.33214 | Reg=0.00363 | FP-Reg=0.000 | acc=0.7188 | L2-Norm=19.048 | L2-Norm(final)=2.418 | 3314.5 samples/s | 51.8 steps/s
[Step=2450 Epoch=23.4] | Loss=0.06703 | Reg=0.00370 | FP-Reg=0.010 | acc=0.9688 | L2-Norm=19.223 | L2-Norm(final)=2.375 | 3447.6 samples/s | 53.9 steps/s
[Step=2500 Epoch=23.9] | Loss=0.03867 | Reg=0.00372 | FP-Reg=0.013 | acc=1.0000 | L2-Norm=19.292 | L2-Norm(final)=2.356 | 4580.1 samples/s | 71.6 steps/s
[Step=2550 Epoch=24.4] | Loss=0.02601 | Reg=0.00372 | FP-Reg=0.013 | acc=1.0000 | L2-Norm=19.294 | L2-Norm(final)=2.356 | 1502.8 samples/s | 23.5 steps/s
[Step=2600 Epoch=24.8] | Loss=0.01961 | Reg=0.00372 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.279 | L2-Norm(final)=2.359 | 4318.3 samples/s | 67.5 steps/s
[Step=2650 Epoch=25.3] | Loss=0.01572 | Reg=0.00371 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.262 | L2-Norm(final)=2.363 | 1526.2 samples/s | 23.8 steps/s
[Step=2700 Epoch=25.8] | Loss=0.01314 | Reg=0.00370 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.245 | L2-Norm(final)=2.367 | 4138.5 samples/s | 64.7 steps/s
[Step=2750 Epoch=26.3] | Loss=0.01128 | Reg=0.00370 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.371 | 1545.3 samples/s | 24.1 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00989 | Reg=0.00369 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.214 | L2-Norm(final)=2.374 | 3931.2 samples/s | 61.4 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00881 | Reg=0.00369 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.201 | L2-Norm(final)=2.378 | 1552.9 samples/s | 24.3 steps/s
[Step=2900 Epoch=27.7] | Loss=0.00795 | Reg=0.00368 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.189 | L2-Norm(final)=2.381 | 3788.5 samples/s | 59.2 steps/s
[Step=2950 Epoch=28.2] | Loss=0.00724 | Reg=0.00368 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.177 | L2-Norm(final)=2.385 | 1578.1 samples/s | 24.7 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00665 | Reg=0.00367 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.167 | L2-Norm(final)=2.388 | 3617.4 samples/s | 56.5 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00615 | Reg=0.00367 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.391 | 1612.5 samples/s | 25.2 steps/s
[Step=3100 Epoch=29.6] | Loss=0.00573 | Reg=0.00367 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.395 | 3593.8 samples/s | 56.2 steps/s
[Step=3150 Epoch=30.1] | Loss=0.00535 | Reg=0.00366 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.140 | L2-Norm(final)=2.398 | 1628.5 samples/s | 25.4 steps/s
[Step=3200 Epoch=30.6] | Loss=0.00503 | Reg=0.00366 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.133 | L2-Norm(final)=2.401 | 3636.4 samples/s | 56.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step3200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.3] | Loss=0.25127 | Reg=0.00363 | FP-Reg=0.000 | acc=0.7656 | L2-Norm=19.048 | L2-Norm(final)=2.419 | 3202.2 samples/s | 50.0 steps/s
[Step=1650 Epoch=15.7] | Loss=0.04885 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.152 | L2-Norm(final)=2.374 | 3528.3 samples/s | 55.1 steps/s
[Step=1700 Epoch=16.2] | Loss=0.02722 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.173 | L2-Norm(final)=2.371 | 4550.2 samples/s | 71.1 steps/s
[Step=1750 Epoch=16.7] | Loss=0.01844 | Reg=0.00367 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.165 | L2-Norm(final)=2.376 | 1514.3 samples/s | 23.7 steps/s
[Step=1800 Epoch=17.2] | Loss=0.01396 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.153 | L2-Norm(final)=2.381 | 4311.2 samples/s | 67.4 steps/s
[Step=1850 Epoch=17.6] | Loss=0.01120 | Reg=0.00366 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.141 | L2-Norm(final)=2.385 | 1520.6 samples/s | 23.8 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00938 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.130 | L2-Norm(final)=2.390 | 4133.9 samples/s | 64.6 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00805 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.120 | L2-Norm(final)=2.394 | 1555.7 samples/s | 24.3 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00706 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.110 | L2-Norm(final)=2.398 | 3961.0 samples/s | 61.9 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00630 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.102 | L2-Norm(final)=2.402 | 1586.6 samples/s | 24.8 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00568 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.093 | L2-Norm(final)=2.405 | 3798.5 samples/s | 59.4 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00517 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.086 | L2-Norm(final)=2.408 | 1594.8 samples/s | 24.9 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00475 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.079 | L2-Norm(final)=2.411 | 3637.6 samples/s | 56.8 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00440 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.073 | L2-Norm(final)=2.414 | 1609.6 samples/s | 25.2 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00409 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.067 | L2-Norm(final)=2.417 | 3602.0 samples/s | 56.3 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00383 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.061 | L2-Norm(final)=2.420 | 1638.6 samples/s | 25.6 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00360 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.056 | L2-Norm(final)=2.423 | 3613.7 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26735 | acc=0.7702 | tpr=0.6843 | fpr=0.0431 | 3713.4 samples/s | 14.5 steps/s
Avg test loss: 0.27047, Avg test acc: 0.77114, Avg tpr: 0.68625, Avg fpr: 0.04217, total FA: 329

Testing server on iccad2012
[Step=  50] | Loss=0.38904 | acc=0.6774 | tpr=0.9159 | fpr=0.3269 | 3724.9 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.39112 | acc=0.6778 | tpr=0.9232 | fpr=0.3268 | 7400.9 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.39070 | acc=0.6768 | tpr=0.9193 | fpr=0.3276 | 7404.3 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.39243 | acc=0.6762 | tpr=0.9180 | fpr=0.3282 | 7283.5 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.39458 | acc=0.6760 | tpr=0.9127 | fpr=0.3284 | 7721.8 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.39408 | acc=0.6758 | tpr=0.9127 | fpr=0.3285 | 6922.9 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.39446 | acc=0.6752 | tpr=0.9123 | fpr=0.3291 | 7550.1 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.39461 | acc=0.6746 | tpr=0.9081 | fpr=0.3296 | 7198.9 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.39478 | acc=0.6742 | tpr=0.9056 | fpr=0.3300 | 7447.3 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.39473 | acc=0.6743 | tpr=0.9040 | fpr=0.3299 | 7281.1 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.39404 | acc=0.6748 | tpr=0.9057 | fpr=0.3294 | 13524.0 samples/s | 52.8 steps/s
Avg test loss: 0.39407, Avg test acc: 0.67479, Avg tpr: 0.90610, Avg fpr: 0.32941, total FA: 45738

server round 5/50

clients selected: [0 2 3 5 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.13553 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.095 | L2-Norm(final)=2.476 | 3328.7 samples/s | 52.0 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.08324 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9062 | L2-Norm=19.097 | L2-Norm(final)=2.467 | 3640.0 samples/s | 56.9 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08094 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.110 | L2-Norm(final)=2.460 | 3787.2 samples/s | 59.2 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.07850 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.125 | L2-Norm(final)=2.458 | 3778.3 samples/s | 59.0 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.07546 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.141 | L2-Norm(final)=2.459 | 4713.0 samples/s | 73.6 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07046 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.160 | L2-Norm(final)=2.461 | 1550.8 samples/s | 24.2 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.06618 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.179 | L2-Norm(final)=2.466 | 3775.1 samples/s | 59.0 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.06274 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.197 | L2-Norm(final)=2.471 | 3771.7 samples/s | 58.9 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06015 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.213 | L2-Norm(final)=2.476 | 4466.8 samples/s | 69.8 steps/s
[Step=2050 Epoch=10.0] | Loss=0.05667 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.228 | L2-Norm(final)=2.481 | 1579.8 samples/s | 24.7 steps/s
[Step=2100 Epoch=10.2] | Loss=0.05443 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.242 | L2-Norm(final)=2.487 | 3771.7 samples/s | 58.9 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05230 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.255 | L2-Norm(final)=2.492 | 3786.4 samples/s | 59.2 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05055 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.269 | L2-Norm(final)=2.497 | 4243.9 samples/s | 66.3 steps/s
[Step=2250 Epoch=11.0] | Loss=0.04964 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.281 | L2-Norm(final)=2.502 | 1606.3 samples/s | 25.1 steps/s
[Step=2300 Epoch=11.2] | Loss=0.04848 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.293 | L2-Norm(final)=2.506 | 3781.3 samples/s | 59.1 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04698 | Reg=0.00373 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.306 | L2-Norm(final)=2.510 | 3787.6 samples/s | 59.2 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04583 | Reg=0.00373 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.317 | L2-Norm(final)=2.514 | 4053.0 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step2400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.23902 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.095 | L2-Norm(final)=2.475 | 3374.2 samples/s | 52.7 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.09415 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.107 | L2-Norm(final)=2.460 | 3605.9 samples/s | 56.3 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08600 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.116 | L2-Norm(final)=2.457 | 3788.6 samples/s | 59.2 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.08180 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.131 | L2-Norm(final)=2.459 | 3791.0 samples/s | 59.2 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.07880 | Reg=0.00367 | FP-Reg=0.003 | acc=0.8906 | L2-Norm=19.145 | L2-Norm(final)=2.459 | 4704.4 samples/s | 73.5 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07131 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.159 | L2-Norm(final)=2.462 | 1552.7 samples/s | 24.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.06806 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.174 | L2-Norm(final)=2.466 | 3797.2 samples/s | 59.3 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.06425 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.191 | L2-Norm(final)=2.471 | 3793.4 samples/s | 59.3 steps/s
[Step=2000 Epoch= 9.7] | Loss=0.06156 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.206 | L2-Norm(final)=2.476 | 4448.9 samples/s | 69.5 steps/s
[Step=2050 Epoch=10.0] | Loss=0.05863 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.220 | L2-Norm(final)=2.481 | 1589.0 samples/s | 24.8 steps/s
[Step=2100 Epoch=10.2] | Loss=0.05570 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.233 | L2-Norm(final)=2.487 | 3800.5 samples/s | 59.4 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05343 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.245 | L2-Norm(final)=2.492 | 3756.1 samples/s | 58.7 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05171 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.257 | L2-Norm(final)=2.497 | 4234.6 samples/s | 66.2 steps/s
[Step=2250 Epoch=11.0] | Loss=0.04990 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.268 | L2-Norm(final)=2.502 | 1616.5 samples/s | 25.3 steps/s
[Step=2300 Epoch=11.2] | Loss=0.04817 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.278 | L2-Norm(final)=2.507 | 3767.4 samples/s | 58.9 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04645 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.288 | L2-Norm(final)=2.512 | 3781.1 samples/s | 59.1 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04507 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.298 | L2-Norm(final)=2.517 | 4044.9 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step2400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.24563 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.095 | L2-Norm(final)=2.475 | 3287.5 samples/s | 51.4 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.09624 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.116 | L2-Norm(final)=2.452 | 3694.4 samples/s | 57.7 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08615 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.129 | L2-Norm(final)=2.453 | 3762.4 samples/s | 58.8 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.08177 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.139 | L2-Norm(final)=2.453 | 3796.5 samples/s | 59.3 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.07549 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.152 | L2-Norm(final)=2.456 | 4720.7 samples/s | 73.8 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.06943 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.164 | L2-Norm(final)=2.460 | 1552.4 samples/s | 24.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.06344 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.178 | L2-Norm(final)=2.465 | 3791.4 samples/s | 59.2 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.06029 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.191 | L2-Norm(final)=2.470 | 3786.2 samples/s | 59.2 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.05833 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.204 | L2-Norm(final)=2.474 | 4450.9 samples/s | 69.5 steps/s
[Step=2050 Epoch=10.0] | Loss=0.05475 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.217 | L2-Norm(final)=2.479 | 1589.9 samples/s | 24.8 steps/s
[Step=2100 Epoch=10.2] | Loss=0.05189 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.230 | L2-Norm(final)=2.484 | 3766.9 samples/s | 58.9 steps/s
[Step=2150 Epoch=10.5] | Loss=0.04940 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.243 | L2-Norm(final)=2.491 | 3786.0 samples/s | 59.2 steps/s
[Step=2200 Epoch=10.7] | Loss=0.04751 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.255 | L2-Norm(final)=2.496 | 4231.2 samples/s | 66.1 steps/s
[Step=2250 Epoch=11.0] | Loss=0.04584 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.265 | L2-Norm(final)=2.502 | 1616.4 samples/s | 25.3 steps/s
[Step=2300 Epoch=11.2] | Loss=0.04423 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.275 | L2-Norm(final)=2.507 | 3786.6 samples/s | 59.2 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04269 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.284 | L2-Norm(final)=2.512 | 3779.5 samples/s | 59.1 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04127 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.292 | L2-Norm(final)=2.516 | 4032.5 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step2400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.33297 | Reg=0.00365 | FP-Reg=0.000 | acc=0.7500 | L2-Norm=19.095 | L2-Norm(final)=2.473 | 3258.5 samples/s | 50.9 steps/s
[Step=1650 Epoch=15.6] | Loss=0.03246 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.445 | 3451.2 samples/s | 53.9 steps/s
[Step=1700 Epoch=16.1] | Loss=0.02109 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.215 | L2-Norm(final)=2.444 | 4534.5 samples/s | 70.9 steps/s
[Step=1750 Epoch=16.6] | Loss=0.01450 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.210 | L2-Norm(final)=2.448 | 1498.3 samples/s | 23.4 steps/s
[Step=1800 Epoch=17.1] | Loss=0.01112 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.200 | L2-Norm(final)=2.452 | 4271.5 samples/s | 66.7 steps/s
[Step=1850 Epoch=17.5] | Loss=0.00892 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.189 | L2-Norm(final)=2.456 | 1537.3 samples/s | 24.0 steps/s
[Step=1900 Epoch=18.0] | Loss=0.00745 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.178 | L2-Norm(final)=2.460 | 3991.2 samples/s | 62.4 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00640 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.167 | L2-Norm(final)=2.463 | 1562.7 samples/s | 24.4 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00561 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.465 | 3827.6 samples/s | 59.8 steps/s
[Step=2050 Epoch=19.4] | Loss=0.00500 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.147 | L2-Norm(final)=2.468 | 1587.7 samples/s | 24.8 steps/s
[Step=2100 Epoch=19.9] | Loss=0.00451 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.138 | L2-Norm(final)=2.471 | 3649.4 samples/s | 57.0 steps/s
[Step=2150 Epoch=20.4] | Loss=0.00411 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.130 | L2-Norm(final)=2.473 | 1619.8 samples/s | 25.3 steps/s
[Step=2200 Epoch=20.8] | Loss=0.00377 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.123 | L2-Norm(final)=2.475 | 3610.3 samples/s | 56.4 steps/s
[Step=2250 Epoch=21.3] | Loss=0.00349 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.116 | L2-Norm(final)=2.477 | 1628.5 samples/s | 25.4 steps/s
[Step=2300 Epoch=21.8] | Loss=0.00325 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.110 | L2-Norm(final)=2.480 | 3623.9 samples/s | 56.6 steps/s
[Step=2350 Epoch=22.3] | Loss=0.00304 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.104 | L2-Norm(final)=2.482 | 1630.8 samples/s | 25.5 steps/s
[Step=2400 Epoch=22.7] | Loss=0.00286 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.098 | L2-Norm(final)=2.484 | 3559.5 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step2400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.2] | Loss=0.23284 | Reg=0.00365 | FP-Reg=0.000 | acc=0.7812 | L2-Norm=19.095 | L2-Norm(final)=2.472 | 3144.6 samples/s | 49.1 steps/s
[Step=3250 Epoch=30.6] | Loss=0.07595 | Reg=0.00373 | FP-Reg=0.012 | acc=0.9844 | L2-Norm=19.309 | L2-Norm(final)=2.364 | 3608.3 samples/s | 56.4 steps/s
[Step=3300 Epoch=31.1] | Loss=0.04468 | Reg=0.00374 | FP-Reg=0.013 | acc=0.9688 | L2-Norm=19.331 | L2-Norm(final)=2.345 | 4517.1 samples/s | 70.6 steps/s
[Step=3350 Epoch=31.6] | Loss=0.03167 | Reg=0.00373 | FP-Reg=0.013 | acc=1.0000 | L2-Norm=19.323 | L2-Norm(final)=2.342 | 1502.7 samples/s | 23.5 steps/s
[Step=3400 Epoch=32.0] | Loss=0.02429 | Reg=0.00373 | FP-Reg=0.012 | acc=0.9844 | L2-Norm=19.310 | L2-Norm(final)=2.344 | 4183.6 samples/s | 65.4 steps/s
[Step=3450 Epoch=32.5] | Loss=0.01951 | Reg=0.00372 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.295 | L2-Norm(final)=2.349 | 1541.7 samples/s | 24.1 steps/s
[Step=3500 Epoch=33.0] | Loss=0.01629 | Reg=0.00372 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.280 | L2-Norm(final)=2.353 | 3954.3 samples/s | 61.8 steps/s
[Step=3550 Epoch=33.5] | Loss=0.01399 | Reg=0.00371 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.266 | L2-Norm(final)=2.358 | 1578.5 samples/s | 24.7 steps/s
[Step=3600 Epoch=33.9] | Loss=0.01226 | Reg=0.00371 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.253 | L2-Norm(final)=2.363 | 3715.6 samples/s | 58.1 steps/s
[Step=3650 Epoch=34.4] | Loss=0.01091 | Reg=0.00370 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.240 | L2-Norm(final)=2.368 | 1617.8 samples/s | 25.3 steps/s
[Step=3700 Epoch=34.9] | Loss=0.00984 | Reg=0.00370 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.373 | 3588.6 samples/s | 56.1 steps/s
[Step=3750 Epoch=35.3] | Loss=0.00895 | Reg=0.00369 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.218 | L2-Norm(final)=2.378 | 1636.2 samples/s | 25.6 steps/s
[Step=3800 Epoch=35.8] | Loss=0.00822 | Reg=0.00369 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.208 | L2-Norm(final)=2.382 | 3607.6 samples/s | 56.4 steps/s
[Step=3850 Epoch=36.3] | Loss=0.00760 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.199 | L2-Norm(final)=2.386 | 1637.4 samples/s | 25.6 steps/s
[Step=3900 Epoch=36.7] | Loss=0.00707 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.191 | L2-Norm(final)=2.391 | 3571.5 samples/s | 55.8 steps/s
[Step=3950 Epoch=37.2] | Loss=0.00661 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.183 | L2-Norm(final)=2.395 | 1747.4 samples/s | 27.3 steps/s
[Step=4000 Epoch=37.7] | Loss=0.00620 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.175 | L2-Norm(final)=2.399 | 3242.0 samples/s | 50.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24304 | acc=0.7973 | tpr=0.7254 | fpr=0.0466 | 3780.0 samples/s | 14.8 steps/s
Avg test loss: 0.24754, Avg test acc: 0.79758, Avg tpr: 0.72623, Avg fpr: 0.04551, total FA: 355

Testing server on iccad2012
[Step=  50] | Loss=0.47965 | acc=0.6012 | tpr=0.9646 | fpr=0.4054 | 3737.2 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.48162 | acc=0.6044 | tpr=0.9701 | fpr=0.4025 | 7448.1 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.48179 | acc=0.6034 | tpr=0.9669 | fpr=0.4033 | 7174.7 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.48378 | acc=0.6032 | tpr=0.9607 | fpr=0.4033 | 7492.3 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.48609 | acc=0.6032 | tpr=0.9590 | fpr=0.4032 | 7361.2 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.48581 | acc=0.6024 | tpr=0.9578 | fpr=0.4040 | 7342.7 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.48621 | acc=0.6016 | tpr=0.9574 | fpr=0.4049 | 7404.2 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.48648 | acc=0.6010 | tpr=0.9562 | fpr=0.4054 | 7442.1 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.48656 | acc=0.6010 | tpr=0.9547 | fpr=0.4054 | 7142.7 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.48672 | acc=0.6012 | tpr=0.9542 | fpr=0.4052 | 7435.2 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.48602 | acc=0.6016 | tpr=0.9554 | fpr=0.4048 | 6536.2 samples/s | 25.5 steps/s
Avg test loss: 0.48600, Avg test acc: 0.60170, Avg tpr: 0.95563, Avg fpr: 0.40473, total FA: 56196

server round 6/50

clients selected: [0 3 4 6 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.18881 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.107 | L2-Norm(final)=2.499 | 3369.9 samples/s | 52.7 steps/s
[Step=2450 Epoch=11.9] | Loss=0.09914 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9062 | L2-Norm=19.121 | L2-Norm(final)=2.473 | 3646.7 samples/s | 57.0 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08691 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.139 | L2-Norm(final)=2.469 | 3781.6 samples/s | 59.1 steps/s
[Step=2550 Epoch=12.4] | Loss=0.08044 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.153 | L2-Norm(final)=2.472 | 3786.1 samples/s | 59.2 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07645 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.166 | L2-Norm(final)=2.475 | 4692.2 samples/s | 73.3 steps/s
[Step=2650 Epoch=12.9] | Loss=0.07454 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.188 | L2-Norm(final)=2.475 | 1552.4 samples/s | 24.3 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06911 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.212 | L2-Norm(final)=2.479 | 3778.1 samples/s | 59.0 steps/s
[Step=2750 Epoch=13.4] | Loss=0.06583 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.230 | L2-Norm(final)=2.484 | 3800.7 samples/s | 59.4 steps/s
[Step=2800 Epoch=13.7] | Loss=0.06317 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.246 | L2-Norm(final)=2.488 | 4478.1 samples/s | 70.0 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05956 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.261 | L2-Norm(final)=2.491 | 1571.0 samples/s | 24.5 steps/s
[Step=2900 Epoch=14.1] | Loss=0.05587 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.274 | L2-Norm(final)=2.496 | 3805.2 samples/s | 59.5 steps/s
[Step=2950 Epoch=14.4] | Loss=0.05316 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.285 | L2-Norm(final)=2.502 | 3785.2 samples/s | 59.1 steps/s
[Step=3000 Epoch=14.6] | Loss=0.05118 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.294 | L2-Norm(final)=2.506 | 4231.9 samples/s | 66.1 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04904 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.303 | L2-Norm(final)=2.510 | 1604.3 samples/s | 25.1 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04682 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.312 | L2-Norm(final)=2.515 | 3771.7 samples/s | 58.9 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04527 | Reg=0.00373 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.319 | L2-Norm(final)=2.520 | 3777.0 samples/s | 59.0 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04407 | Reg=0.00374 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.327 | L2-Norm(final)=2.524 | 4038.8 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step3200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.09407 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.107 | L2-Norm(final)=2.500 | 3318.9 samples/s | 51.9 steps/s
[Step=2450 Epoch=11.9] | Loss=0.08304 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.114 | L2-Norm(final)=2.483 | 3620.2 samples/s | 56.6 steps/s
[Step=2500 Epoch=12.2] | Loss=0.07656 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.121 | L2-Norm(final)=2.483 | 3787.6 samples/s | 59.2 steps/s
[Step=2550 Epoch=12.4] | Loss=0.07262 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.130 | L2-Norm(final)=2.484 | 3793.5 samples/s | 59.3 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07067 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.145 | L2-Norm(final)=2.484 | 4695.5 samples/s | 73.4 steps/s
[Step=2650 Epoch=12.9] | Loss=0.07061 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.174 | L2-Norm(final)=2.483 | 1556.1 samples/s | 24.3 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06647 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.202 | L2-Norm(final)=2.483 | 3786.4 samples/s | 59.2 steps/s
[Step=2750 Epoch=13.4] | Loss=0.06365 | Reg=0.00370 | FP-Reg=0.005 | acc=0.8906 | L2-Norm=19.224 | L2-Norm(final)=2.484 | 3798.0 samples/s | 59.3 steps/s
[Step=2800 Epoch=13.7] | Loss=0.06115 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.242 | L2-Norm(final)=2.486 | 4475.4 samples/s | 69.9 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05753 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.258 | L2-Norm(final)=2.488 | 1574.8 samples/s | 24.6 steps/s
[Step=2900 Epoch=14.1] | Loss=0.05427 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.271 | L2-Norm(final)=2.492 | 3770.8 samples/s | 58.9 steps/s
[Step=2950 Epoch=14.4] | Loss=0.05185 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.283 | L2-Norm(final)=2.495 | 3790.4 samples/s | 59.2 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04986 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.294 | L2-Norm(final)=2.499 | 4245.9 samples/s | 66.3 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04768 | Reg=0.00373 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.303 | L2-Norm(final)=2.503 | 1607.9 samples/s | 25.1 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04536 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.312 | L2-Norm(final)=2.507 | 3796.8 samples/s | 59.3 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04362 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.320 | L2-Norm(final)=2.511 | 3785.5 samples/s | 59.1 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04247 | Reg=0.00374 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.326 | L2-Norm(final)=2.515 | 4051.6 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step3200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.9] | Loss=0.22562 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.107 | L2-Norm(final)=2.500 | 3189.7 samples/s | 49.8 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.09487 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.122 | L2-Norm(final)=2.486 | 3683.2 samples/s | 57.5 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08495 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.129 | L2-Norm(final)=2.479 | 3793.3 samples/s | 59.3 steps/s
[Step=1750 Epoch= 8.6] | Loss=0.07638 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.138 | L2-Norm(final)=2.478 | 3787.0 samples/s | 59.2 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.07027 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.148 | L2-Norm(final)=2.479 | 4766.8 samples/s | 74.5 steps/s
[Step=1850 Epoch= 9.1] | Loss=0.06423 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.163 | L2-Norm(final)=2.483 | 1538.2 samples/s | 24.0 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.05946 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.179 | L2-Norm(final)=2.489 | 3761.1 samples/s | 58.8 steps/s
[Step=1950 Epoch= 9.6] | Loss=0.05639 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.195 | L2-Norm(final)=2.495 | 3783.8 samples/s | 59.1 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.05385 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.209 | L2-Norm(final)=2.500 | 4591.6 samples/s | 71.7 steps/s
[Step=2050 Epoch=10.1] | Loss=0.05059 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.222 | L2-Norm(final)=2.505 | 1561.7 samples/s | 24.4 steps/s
[Step=2100 Epoch=10.3] | Loss=0.04794 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9219 | L2-Norm=19.234 | L2-Norm(final)=2.510 | 3786.7 samples/s | 59.2 steps/s
[Step=2150 Epoch=10.5] | Loss=0.04572 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.244 | L2-Norm(final)=2.515 | 3773.0 samples/s | 59.0 steps/s
[Step=2200 Epoch=10.8] | Loss=0.04435 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.253 | L2-Norm(final)=2.520 | 4430.3 samples/s | 69.2 steps/s
[Step=2250 Epoch=11.0] | Loss=0.04296 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.262 | L2-Norm(final)=2.524 | 1572.6 samples/s | 24.6 steps/s
[Step=2300 Epoch=11.3] | Loss=0.04126 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.271 | L2-Norm(final)=2.528 | 3768.0 samples/s | 58.9 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04016 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.279 | L2-Norm(final)=2.531 | 3791.6 samples/s | 59.2 steps/s
[Step=2400 Epoch=11.8] | Loss=0.03907 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.287 | L2-Norm(final)=2.535 | 4297.0 samples/s | 67.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step2400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.23929 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.107 | L2-Norm(final)=2.497 | 3087.1 samples/s | 48.2 steps/s
[Step=1650 Epoch=15.7] | Loss=0.03818 | Reg=0.00370 | FP-Reg=0.009 | acc=0.9688 | L2-Norm=19.226 | L2-Norm(final)=2.438 | 3640.3 samples/s | 56.9 steps/s
[Step=1700 Epoch=16.2] | Loss=0.02286 | Reg=0.00370 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.233 | L2-Norm(final)=2.429 | 4563.3 samples/s | 71.3 steps/s
[Step=1750 Epoch=16.6] | Loss=0.01537 | Reg=0.00369 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.221 | L2-Norm(final)=2.435 | 1493.9 samples/s | 23.3 steps/s
[Step=1800 Epoch=17.1] | Loss=0.01160 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.206 | L2-Norm(final)=2.441 | 4288.2 samples/s | 67.0 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00931 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.447 | 1537.7 samples/s | 24.0 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00778 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.178 | L2-Norm(final)=2.453 | 4034.0 samples/s | 63.0 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00669 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.166 | L2-Norm(final)=2.458 | 1563.7 samples/s | 24.4 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00586 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.155 | L2-Norm(final)=2.462 | 3846.7 samples/s | 60.1 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00522 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.146 | L2-Norm(final)=2.467 | 1584.8 samples/s | 24.8 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00471 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.471 | 3681.6 samples/s | 57.5 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00429 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=2.475 | 1618.2 samples/s | 25.3 steps/s
[Step=2200 Epoch=20.9] | Loss=0.00395 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.121 | L2-Norm(final)=2.479 | 3568.3 samples/s | 55.8 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00365 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.114 | L2-Norm(final)=2.482 | 1633.9 samples/s | 25.5 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00340 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.108 | L2-Norm(final)=2.486 | 3624.9 samples/s | 56.6 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00318 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.102 | L2-Norm(final)=2.489 | 1634.4 samples/s | 25.5 steps/s
[Step=2400 Epoch=22.8] | Loss=0.00298 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.097 | L2-Norm(final)=2.492 | 3576.5 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step2400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=37.7] | Loss=0.24963 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.107 | L2-Norm(final)=2.497 | 3545.4 samples/s | 55.4 steps/s
[Step=4050 Epoch=38.2] | Loss=0.03328 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.222 | L2-Norm(final)=2.458 | 3252.4 samples/s | 50.8 steps/s
[Step=4100 Epoch=38.6] | Loss=0.02119 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.227 | L2-Norm(final)=2.456 | 4488.8 samples/s | 70.1 steps/s
[Step=4150 Epoch=39.1] | Loss=0.01507 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.223 | L2-Norm(final)=2.459 | 1497.5 samples/s | 23.4 steps/s
[Step=4200 Epoch=39.6] | Loss=0.01143 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.213 | L2-Norm(final)=2.465 | 4197.1 samples/s | 65.6 steps/s
[Step=4250 Epoch=40.0] | Loss=0.00916 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.202 | L2-Norm(final)=2.470 | 1540.0 samples/s | 24.1 steps/s
[Step=4300 Epoch=40.5] | Loss=0.00765 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.190 | L2-Norm(final)=2.474 | 3920.6 samples/s | 61.3 steps/s
[Step=4350 Epoch=41.0] | Loss=0.00657 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.179 | L2-Norm(final)=2.477 | 1577.9 samples/s | 24.7 steps/s
[Step=4400 Epoch=41.5] | Loss=0.00576 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.168 | L2-Norm(final)=2.480 | 3724.4 samples/s | 58.2 steps/s
[Step=4450 Epoch=41.9] | Loss=0.00513 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.159 | L2-Norm(final)=2.483 | 1618.2 samples/s | 25.3 steps/s
[Step=4500 Epoch=42.4] | Loss=0.00463 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.150 | L2-Norm(final)=2.486 | 3594.6 samples/s | 56.2 steps/s
[Step=4550 Epoch=42.9] | Loss=0.00422 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.141 | L2-Norm(final)=2.489 | 1633.5 samples/s | 25.5 steps/s
[Step=4600 Epoch=43.3] | Loss=0.00388 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.491 | 3612.2 samples/s | 56.4 steps/s
[Step=4650 Epoch=43.8] | Loss=0.00359 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.127 | L2-Norm(final)=2.494 | 1644.5 samples/s | 25.7 steps/s
[Step=4700 Epoch=44.3] | Loss=0.00334 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.121 | L2-Norm(final)=2.496 | 3620.6 samples/s | 56.6 steps/s
[Step=4750 Epoch=44.8] | Loss=0.00312 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.115 | L2-Norm(final)=2.499 | 1722.7 samples/s | 26.9 steps/s
[Step=4800 Epoch=45.2] | Loss=0.00293 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.109 | L2-Norm(final)=2.501 | 3219.2 samples/s | 50.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21046 | acc=0.8306 | tpr=0.7728 | fpr=0.0439 | 3098.2 samples/s | 12.1 steps/s
Avg test loss: 0.21532, Avg test acc: 0.82767, Avg tpr: 0.76902, Avg fpr: 0.04333, total FA: 338

Testing server on iccad2012
[Step=  50] | Loss=0.47721 | acc=0.6416 | tpr=0.9602 | fpr=0.3641 | 2932.6 samples/s | 11.5 steps/s
[Step= 100] | Loss=0.47925 | acc=0.6423 | tpr=0.9701 | fpr=0.3638 | 7305.0 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.48065 | acc=0.6393 | tpr=0.9683 | fpr=0.3667 | 7324.7 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.48346 | acc=0.6386 | tpr=0.9628 | fpr=0.3673 | 7225.4 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.48636 | acc=0.6381 | tpr=0.9616 | fpr=0.3678 | 7625.1 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.48645 | acc=0.6377 | tpr=0.9622 | fpr=0.3682 | 7412.9 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.48713 | acc=0.6369 | tpr=0.9643 | fpr=0.3690 | 7268.7 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.48754 | acc=0.6369 | tpr=0.9617 | fpr=0.3690 | 7662.3 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.48757 | acc=0.6368 | tpr=0.9611 | fpr=0.3691 | 7226.3 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.48809 | acc=0.6368 | tpr=0.9617 | fpr=0.3691 | 7100.6 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.48747 | acc=0.6369 | tpr=0.9634 | fpr=0.3690 | 13303.4 samples/s | 52.0 steps/s
Avg test loss: 0.48740, Avg test acc: 0.63694, Avg tpr: 0.96315, Avg fpr: 0.36899, total FA: 51234

server round 7/50

clients selected: [0 4 6 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.12058 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.104 | L2-Norm(final)=2.521 | 3277.5 samples/s | 51.2 steps/s
[Step=3250 Epoch=15.8] | Loss=0.07921 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=19.098 | L2-Norm(final)=2.504 | 3685.0 samples/s | 57.6 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07296 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.109 | L2-Norm(final)=2.502 | 3785.0 samples/s | 59.1 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06903 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.121 | L2-Norm(final)=2.500 | 3791.1 samples/s | 59.2 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06479 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.136 | L2-Norm(final)=2.501 | 4689.8 samples/s | 73.3 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05838 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.503 | 1554.4 samples/s | 24.3 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05439 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.164 | L2-Norm(final)=2.508 | 3779.4 samples/s | 59.1 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05262 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.179 | L2-Norm(final)=2.514 | 3792.3 samples/s | 59.3 steps/s
[Step=3600 Epoch=17.6] | Loss=0.05109 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.194 | L2-Norm(final)=2.517 | 4457.1 samples/s | 69.6 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04856 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.208 | L2-Norm(final)=2.520 | 1156.6 samples/s | 18.1 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04655 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.523 | 3595.7 samples/s | 56.2 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04516 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.231 | L2-Norm(final)=2.527 | 3709.8 samples/s | 58.0 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04379 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.242 | L2-Norm(final)=2.530 | 4211.2 samples/s | 65.8 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04267 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.254 | L2-Norm(final)=2.533 | 1601.9 samples/s | 25.0 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04126 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.265 | L2-Norm(final)=2.537 | 3781.8 samples/s | 59.1 steps/s
[Step=3950 Epoch=19.3] | Loss=0.04029 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.274 | L2-Norm(final)=2.541 | 3751.3 samples/s | 58.6 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03920 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.282 | L2-Norm(final)=2.544 | 4046.7 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step4000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.8] | Loss=0.13704 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.104 | L2-Norm(final)=2.521 | 3313.7 samples/s | 51.8 steps/s
[Step=2450 Epoch=12.0] | Loss=0.08047 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.109 | L2-Norm(final)=2.502 | 3734.3 samples/s | 58.3 steps/s
[Step=2500 Epoch=12.3] | Loss=0.07486 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.119 | L2-Norm(final)=2.499 | 3800.4 samples/s | 59.4 steps/s
[Step=2550 Epoch=12.5] | Loss=0.06747 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.132 | L2-Norm(final)=2.501 | 3793.1 samples/s | 59.3 steps/s
[Step=2600 Epoch=12.7] | Loss=0.06233 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.147 | L2-Norm(final)=2.505 | 4771.5 samples/s | 74.6 steps/s
[Step=2650 Epoch=13.0] | Loss=0.05630 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.161 | L2-Norm(final)=2.509 | 1540.2 samples/s | 24.1 steps/s
[Step=2700 Epoch=13.2] | Loss=0.05237 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.175 | L2-Norm(final)=2.515 | 3789.5 samples/s | 59.2 steps/s
[Step=2750 Epoch=13.5] | Loss=0.05022 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.188 | L2-Norm(final)=2.520 | 3793.9 samples/s | 59.3 steps/s
[Step=2800 Epoch=13.7] | Loss=0.04827 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.201 | L2-Norm(final)=2.525 | 4594.6 samples/s | 71.8 steps/s
[Step=2850 Epoch=14.0] | Loss=0.04630 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.214 | L2-Norm(final)=2.529 | 1567.0 samples/s | 24.5 steps/s
[Step=2900 Epoch=14.2] | Loss=0.04493 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.227 | L2-Norm(final)=2.534 | 3787.8 samples/s | 59.2 steps/s
[Step=2950 Epoch=14.5] | Loss=0.04373 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.240 | L2-Norm(final)=2.537 | 3789.5 samples/s | 59.2 steps/s
[Step=3000 Epoch=14.7] | Loss=0.04228 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.252 | L2-Norm(final)=2.541 | 4426.2 samples/s | 69.2 steps/s
[Step=3050 Epoch=15.0] | Loss=0.04078 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.262 | L2-Norm(final)=2.544 | 1588.0 samples/s | 24.8 steps/s
[Step=3100 Epoch=15.2] | Loss=0.03921 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.271 | L2-Norm(final)=2.547 | 3781.8 samples/s | 59.1 steps/s
[Step=3150 Epoch=15.4] | Loss=0.03830 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.279 | L2-Norm(final)=2.550 | 3765.9 samples/s | 58.8 steps/s
[Step=3200 Epoch=15.7] | Loss=0.03726 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.288 | L2-Norm(final)=2.553 | 4283.7 samples/s | 66.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step3200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.21992 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.104 | L2-Norm(final)=2.519 | 3110.0 samples/s | 48.6 steps/s
[Step=2450 Epoch=23.3] | Loss=0.03737 | Reg=0.00370 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.226 | L2-Norm(final)=2.453 | 3592.7 samples/s | 56.1 steps/s
[Step=2500 Epoch=23.8] | Loss=0.02159 | Reg=0.00370 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.236 | L2-Norm(final)=2.445 | 4566.6 samples/s | 71.4 steps/s
[Step=2550 Epoch=24.3] | Loss=0.01474 | Reg=0.00370 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.226 | L2-Norm(final)=2.451 | 1498.5 samples/s | 23.4 steps/s
[Step=2600 Epoch=24.7] | Loss=0.01113 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.210 | L2-Norm(final)=2.458 | 4283.6 samples/s | 66.9 steps/s
[Step=2650 Epoch=25.2] | Loss=0.00892 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.195 | L2-Norm(final)=2.464 | 1538.4 samples/s | 24.0 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00744 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.180 | L2-Norm(final)=2.469 | 4039.9 samples/s | 63.1 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00639 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.167 | L2-Norm(final)=2.474 | 1571.7 samples/s | 24.6 steps/s
[Step=2800 Epoch=26.6] | Loss=0.00561 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.155 | L2-Norm(final)=2.478 | 3802.0 samples/s | 59.4 steps/s
[Step=2850 Epoch=27.1] | Loss=0.00499 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.482 | 1586.5 samples/s | 24.8 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00450 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.486 | 3666.3 samples/s | 57.3 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00410 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.125 | L2-Norm(final)=2.490 | 1628.4 samples/s | 25.4 steps/s
[Step=3000 Epoch=28.5] | Loss=0.00377 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.117 | L2-Norm(final)=2.493 | 3587.5 samples/s | 56.1 steps/s
[Step=3050 Epoch=29.0] | Loss=0.00348 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.110 | L2-Norm(final)=2.497 | 1644.6 samples/s | 25.7 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00324 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.103 | L2-Norm(final)=2.500 | 3625.6 samples/s | 56.6 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00303 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.097 | L2-Norm(final)=2.503 | 1655.6 samples/s | 25.9 steps/s
[Step=3200 Epoch=30.4] | Loss=0.00285 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.091 | L2-Norm(final)=2.506 | 3581.9 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step3200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.2] | Loss=0.26548 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.104 | L2-Norm(final)=2.519 | 3218.2 samples/s | 50.3 steps/s
[Step=4850 Epoch=45.7] | Loss=0.03968 | Reg=0.00370 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.239 | L2-Norm(final)=2.466 | 3508.6 samples/s | 54.8 steps/s
[Step=4900 Epoch=46.2] | Loss=0.03109 | Reg=0.00371 | FP-Reg=0.009 | acc=0.9688 | L2-Norm=19.256 | L2-Norm(final)=2.457 | 4485.1 samples/s | 70.1 steps/s
[Step=4950 Epoch=46.6] | Loss=0.02118 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.258 | L2-Norm(final)=2.460 | 1519.0 samples/s | 23.7 steps/s
[Step=5000 Epoch=47.1] | Loss=0.01629 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.249 | L2-Norm(final)=2.466 | 4215.2 samples/s | 65.9 steps/s
[Step=5050 Epoch=47.6] | Loss=0.01308 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.237 | L2-Norm(final)=2.472 | 1536.5 samples/s | 24.0 steps/s
[Step=5100 Epoch=48.1] | Loss=0.01093 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.225 | L2-Norm(final)=2.477 | 3942.7 samples/s | 61.6 steps/s
[Step=5150 Epoch=48.5] | Loss=0.00938 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.214 | L2-Norm(final)=2.482 | 1574.1 samples/s | 24.6 steps/s
[Step=5200 Epoch=49.0] | Loss=0.00822 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.202 | L2-Norm(final)=2.486 | 3722.3 samples/s | 58.2 steps/s
[Step=5250 Epoch=49.5] | Loss=0.00735 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.490 | 1605.2 samples/s | 25.1 steps/s
[Step=5300 Epoch=49.9] | Loss=0.00662 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.182 | L2-Norm(final)=2.494 | 3602.9 samples/s | 56.3 steps/s
[Step=5350 Epoch=50.4] | Loss=0.00603 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.174 | L2-Norm(final)=2.497 | 1641.4 samples/s | 25.6 steps/s
[Step=5400 Epoch=50.9] | Loss=0.00553 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.165 | L2-Norm(final)=2.501 | 3612.8 samples/s | 56.5 steps/s
[Step=5450 Epoch=51.4] | Loss=0.00512 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.504 | 1645.2 samples/s | 25.7 steps/s
[Step=5500 Epoch=51.8] | Loss=0.00476 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.150 | L2-Norm(final)=2.507 | 3563.3 samples/s | 55.7 steps/s
[Step=5550 Epoch=52.3] | Loss=0.00445 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.143 | L2-Norm(final)=2.510 | 1678.1 samples/s | 26.2 steps/s
[Step=5600 Epoch=52.8] | Loss=0.00418 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.513 | 3471.3 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step5600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.9] | Loss=0.37498 | Reg=0.00365 | FP-Reg=0.000 | acc=0.7500 | L2-Norm=19.104 | L2-Norm(final)=2.519 | 3188.8 samples/s | 49.8 steps/s
[Step=2450 Epoch=23.4] | Loss=0.03930 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.255 | L2-Norm(final)=2.475 | 3462.1 samples/s | 54.1 steps/s
[Step=2500 Epoch=23.8] | Loss=0.02156 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.265 | L2-Norm(final)=2.475 | 4563.7 samples/s | 71.3 steps/s
[Step=2550 Epoch=24.3] | Loss=0.01459 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.251 | L2-Norm(final)=2.479 | 1498.6 samples/s | 23.4 steps/s
[Step=2600 Epoch=24.8] | Loss=0.01104 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.234 | L2-Norm(final)=2.483 | 4308.4 samples/s | 67.3 steps/s
[Step=2650 Epoch=25.3] | Loss=0.00885 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.218 | L2-Norm(final)=2.486 | 1508.6 samples/s | 23.6 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00739 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.204 | L2-Norm(final)=2.490 | 4133.3 samples/s | 64.6 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00634 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.190 | L2-Norm(final)=2.492 | 1542.3 samples/s | 24.1 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00556 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.178 | L2-Norm(final)=2.495 | 3944.5 samples/s | 61.6 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00495 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.167 | L2-Norm(final)=2.497 | 1562.6 samples/s | 24.4 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00447 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.500 | 3800.3 samples/s | 59.4 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00407 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.502 | 1600.7 samples/s | 25.0 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00374 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.139 | L2-Norm(final)=2.504 | 3605.5 samples/s | 56.3 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00346 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.132 | L2-Norm(final)=2.506 | 1628.8 samples/s | 25.5 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00322 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.125 | L2-Norm(final)=2.509 | 3605.2 samples/s | 56.3 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00301 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.118 | L2-Norm(final)=2.511 | 1628.9 samples/s | 25.5 steps/s
[Step=3200 Epoch=30.5] | Loss=0.00282 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.513 | 3609.1 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25101 | acc=0.7945 | tpr=0.7193 | fpr=0.0421 | 3706.2 samples/s | 14.5 steps/s
Avg test loss: 0.25596, Avg test acc: 0.79169, Avg tpr: 0.71615, Avg fpr: 0.04217, total FA: 329

Testing server on iccad2012
[Step=  50] | Loss=0.39226 | acc=0.7053 | tpr=0.9735 | fpr=0.2995 | 3762.5 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.39435 | acc=0.7070 | tpr=0.9787 | fpr=0.2980 | 7760.7 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.39592 | acc=0.7030 | tpr=0.9755 | fpr=0.3020 | 6939.6 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.39850 | acc=0.7023 | tpr=0.9705 | fpr=0.3026 | 7563.7 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.40030 | acc=0.7016 | tpr=0.9694 | fpr=0.3033 | 7193.2 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.40059 | acc=0.7009 | tpr=0.9702 | fpr=0.3040 | 7315.5 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.40147 | acc=0.7001 | tpr=0.9718 | fpr=0.3048 | 7404.3 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.40192 | acc=0.7002 | tpr=0.9705 | fpr=0.3047 | 7280.0 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.40203 | acc=0.7007 | tpr=0.9684 | fpr=0.3042 | 7336.3 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.40236 | acc=0.7005 | tpr=0.9683 | fpr=0.3043 | 7427.7 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.40185 | acc=0.7007 | tpr=0.9686 | fpr=0.3041 | 13005.3 samples/s | 50.8 steps/s
Avg test loss: 0.40175, Avg test acc: 0.70076, Avg tpr: 0.96830, Avg fpr: 0.30410, total FA: 42224

server round 8/50

clients selected: [2 4 6 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.19884 | Reg=0.00365 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=19.111 | L2-Norm(final)=2.533 | 3387.2 samples/s | 52.9 steps/s
[Step=2450 Epoch=11.9] | Loss=0.09235 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.130 | L2-Norm(final)=2.502 | 3596.4 samples/s | 56.2 steps/s
[Step=2500 Epoch=12.2] | Loss=0.07540 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.140 | L2-Norm(final)=2.502 | 3784.6 samples/s | 59.1 steps/s
[Step=2550 Epoch=12.4] | Loss=0.07293 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.149 | L2-Norm(final)=2.502 | 3790.5 samples/s | 59.2 steps/s
[Step=2600 Epoch=12.7] | Loss=0.06803 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.161 | L2-Norm(final)=2.505 | 4692.3 samples/s | 73.3 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06209 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.175 | L2-Norm(final)=2.508 | 1550.5 samples/s | 24.2 steps/s
[Step=2700 Epoch=13.2] | Loss=0.05900 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.188 | L2-Norm(final)=2.513 | 3757.3 samples/s | 58.7 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05502 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.201 | L2-Norm(final)=2.518 | 3757.8 samples/s | 58.7 steps/s
[Step=2800 Epoch=13.6] | Loss=0.05442 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.213 | L2-Norm(final)=2.522 | 4460.7 samples/s | 69.7 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05153 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.227 | L2-Norm(final)=2.524 | 1577.9 samples/s | 24.7 steps/s
[Step=2900 Epoch=14.1] | Loss=0.04843 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.240 | L2-Norm(final)=2.528 | 3775.4 samples/s | 59.0 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04714 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.251 | L2-Norm(final)=2.532 | 3765.5 samples/s | 58.8 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04625 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.261 | L2-Norm(final)=2.534 | 4241.6 samples/s | 66.3 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04446 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.271 | L2-Norm(final)=2.537 | 1613.7 samples/s | 25.2 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04257 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.281 | L2-Norm(final)=2.540 | 3775.0 samples/s | 59.0 steps/s
[Step=3150 Epoch=15.3] | Loss=0.04151 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.289 | L2-Norm(final)=2.543 | 3778.7 samples/s | 59.0 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04044 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.297 | L2-Norm(final)=2.546 | 4032.0 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step3200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.7] | Loss=0.22952 | Reg=0.00365 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=19.111 | L2-Norm(final)=2.533 | 3460.9 samples/s | 54.1 steps/s
[Step=3250 Epoch=15.9] | Loss=0.07238 | Reg=0.00366 | FP-Reg=0.002 | acc=0.8750 | L2-Norm=19.121 | L2-Norm(final)=2.514 | 3520.1 samples/s | 55.0 steps/s
[Step=3300 Epoch=16.2] | Loss=0.06719 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.131 | L2-Norm(final)=2.510 | 3796.7 samples/s | 59.3 steps/s
[Step=3350 Epoch=16.4] | Loss=0.06504 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.142 | L2-Norm(final)=2.509 | 3777.2 samples/s | 59.0 steps/s
[Step=3400 Epoch=16.7] | Loss=0.06150 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.156 | L2-Norm(final)=2.512 | 4756.9 samples/s | 74.3 steps/s
[Step=3450 Epoch=16.9] | Loss=0.05570 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.173 | L2-Norm(final)=2.517 | 1551.2 samples/s | 24.2 steps/s
[Step=3500 Epoch=17.2] | Loss=0.05154 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.187 | L2-Norm(final)=2.524 | 3779.3 samples/s | 59.1 steps/s
[Step=3550 Epoch=17.4] | Loss=0.05018 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.202 | L2-Norm(final)=2.529 | 3775.9 samples/s | 59.0 steps/s
[Step=3600 Epoch=17.7] | Loss=0.04899 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.214 | L2-Norm(final)=2.532 | 4581.2 samples/s | 71.6 steps/s
[Step=3650 Epoch=17.9] | Loss=0.04677 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.226 | L2-Norm(final)=2.534 | 1556.5 samples/s | 24.3 steps/s
[Step=3700 Epoch=18.1] | Loss=0.04457 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.238 | L2-Norm(final)=2.538 | 3746.8 samples/s | 58.5 steps/s
[Step=3750 Epoch=18.4] | Loss=0.04260 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.249 | L2-Norm(final)=2.542 | 3759.1 samples/s | 58.7 steps/s
[Step=3800 Epoch=18.6] | Loss=0.04141 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.259 | L2-Norm(final)=2.546 | 4437.1 samples/s | 69.3 steps/s
[Step=3850 Epoch=18.9] | Loss=0.03961 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.269 | L2-Norm(final)=2.550 | 1577.9 samples/s | 24.7 steps/s
[Step=3900 Epoch=19.1] | Loss=0.03812 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.277 | L2-Norm(final)=2.555 | 3768.2 samples/s | 58.9 steps/s
[Step=3950 Epoch=19.4] | Loss=0.03660 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.285 | L2-Norm(final)=2.559 | 3771.2 samples/s | 58.9 steps/s
[Step=4000 Epoch=19.6] | Loss=0.03560 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.292 | L2-Norm(final)=2.563 | 4278.6 samples/s | 66.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.4] | Loss=0.25495 | Reg=0.00365 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=19.111 | L2-Norm(final)=2.533 | 3228.6 samples/s | 50.4 steps/s
[Step=3250 Epoch=30.9] | Loss=0.03425 | Reg=0.00370 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.245 | L2-Norm(final)=2.480 | 3454.1 samples/s | 54.0 steps/s
[Step=3300 Epoch=31.4] | Loss=0.01956 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.252 | L2-Norm(final)=2.488 | 4546.2 samples/s | 71.0 steps/s
[Step=3350 Epoch=31.9] | Loss=0.01345 | Reg=0.00370 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.246 | L2-Norm(final)=2.495 | 1498.1 samples/s | 23.4 steps/s
[Step=3400 Epoch=32.3] | Loss=0.01014 | Reg=0.00370 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=2.501 | 4262.1 samples/s | 66.6 steps/s
[Step=3450 Epoch=32.8] | Loss=0.00814 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.221 | L2-Norm(final)=2.507 | 1525.8 samples/s | 23.8 steps/s
[Step=3500 Epoch=33.3] | Loss=0.00679 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.208 | L2-Norm(final)=2.511 | 4062.1 samples/s | 63.5 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00584 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.195 | L2-Norm(final)=2.515 | 1566.2 samples/s | 24.5 steps/s
[Step=3600 Epoch=34.2] | Loss=0.00512 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.183 | L2-Norm(final)=2.519 | 3810.7 samples/s | 59.5 steps/s
[Step=3650 Epoch=34.7] | Loss=0.00457 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.173 | L2-Norm(final)=2.522 | 1593.0 samples/s | 24.9 steps/s
[Step=3700 Epoch=35.2] | Loss=0.00412 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.163 | L2-Norm(final)=2.526 | 3670.6 samples/s | 57.4 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00375 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.154 | L2-Norm(final)=2.529 | 1629.3 samples/s | 25.5 steps/s
[Step=3800 Epoch=36.1] | Loss=0.00345 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.145 | L2-Norm(final)=2.531 | 3607.2 samples/s | 56.4 steps/s
[Step=3850 Epoch=36.6] | Loss=0.00319 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.138 | L2-Norm(final)=2.534 | 1634.9 samples/s | 25.5 steps/s
[Step=3900 Epoch=37.1] | Loss=0.00297 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.131 | L2-Norm(final)=2.537 | 3620.2 samples/s | 56.6 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00278 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.124 | L2-Norm(final)=2.539 | 1650.1 samples/s | 25.8 steps/s
[Step=4000 Epoch=38.0] | Loss=0.00261 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.118 | L2-Norm(final)=2.542 | 3553.9 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step4000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=52.8] | Loss=0.30691 | Reg=0.00365 | FP-Reg=0.000 | acc=0.7812 | L2-Norm=19.111 | L2-Norm(final)=2.532 | 3233.8 samples/s | 50.5 steps/s
[Step=5650 Epoch=53.2] | Loss=0.03776 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.263 | L2-Norm(final)=2.490 | 3437.0 samples/s | 53.7 steps/s
[Step=5700 Epoch=53.7] | Loss=0.02240 | Reg=0.00371 | FP-Reg=0.009 | acc=0.9844 | L2-Norm=19.272 | L2-Norm(final)=2.487 | 4508.3 samples/s | 70.4 steps/s
[Step=5750 Epoch=54.2] | Loss=0.01508 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.260 | L2-Norm(final)=2.491 | 1506.2 samples/s | 23.5 steps/s
[Step=5800 Epoch=54.7] | Loss=0.01139 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.244 | L2-Norm(final)=2.497 | 4212.6 samples/s | 65.8 steps/s
[Step=5850 Epoch=55.1] | Loss=0.00913 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.228 | L2-Norm(final)=2.502 | 1538.4 samples/s | 24.0 steps/s
[Step=5900 Epoch=55.6] | Loss=0.00763 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.213 | L2-Norm(final)=2.506 | 3942.2 samples/s | 61.6 steps/s
[Step=5950 Epoch=56.1] | Loss=0.00655 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.200 | L2-Norm(final)=2.510 | 1571.0 samples/s | 24.5 steps/s
[Step=6000 Epoch=56.5] | Loss=0.00574 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.187 | L2-Norm(final)=2.514 | 3716.9 samples/s | 58.1 steps/s
[Step=6050 Epoch=57.0] | Loss=0.00512 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.176 | L2-Norm(final)=2.517 | 1603.7 samples/s | 25.1 steps/s
[Step=6100 Epoch=57.5] | Loss=0.00461 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.166 | L2-Norm(final)=2.520 | 3595.6 samples/s | 56.2 steps/s
[Step=6150 Epoch=58.0] | Loss=0.00420 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.523 | 1636.8 samples/s | 25.6 steps/s
[Step=6200 Epoch=58.4] | Loss=0.00386 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.525 | 3622.6 samples/s | 56.6 steps/s
[Step=6250 Epoch=58.9] | Loss=0.00357 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.141 | L2-Norm(final)=2.528 | 1623.1 samples/s | 25.4 steps/s
[Step=6300 Epoch=59.4] | Loss=0.00332 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.531 | 3567.8 samples/s | 55.7 steps/s
[Step=6350 Epoch=59.8] | Loss=0.00311 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.127 | L2-Norm(final)=2.533 | 1683.1 samples/s | 26.3 steps/s
[Step=6400 Epoch=60.3] | Loss=0.00292 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.121 | L2-Norm(final)=2.536 | 3411.8 samples/s | 53.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step6400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.5] | Loss=0.08695 | Reg=0.00365 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.111 | L2-Norm(final)=2.535 | 3220.5 samples/s | 50.3 steps/s
[Step=3250 Epoch=31.0] | Loss=0.02297 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.164 | L2-Norm(final)=2.513 | 3381.6 samples/s | 52.8 steps/s
[Step=3300 Epoch=31.5] | Loss=0.02102 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.198 | L2-Norm(final)=2.505 | 4567.9 samples/s | 71.4 steps/s
[Step=3350 Epoch=31.9] | Loss=0.01467 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.218 | L2-Norm(final)=2.504 | 1500.8 samples/s | 23.5 steps/s
[Step=3400 Epoch=32.4] | Loss=0.01108 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.505 | 4333.9 samples/s | 67.7 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00888 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.215 | L2-Norm(final)=2.508 | 1531.6 samples/s | 23.9 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00742 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.207 | L2-Norm(final)=2.511 | 4130.4 samples/s | 64.5 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00637 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.198 | L2-Norm(final)=2.513 | 1550.3 samples/s | 24.2 steps/s
[Step=3600 Epoch=34.3] | Loss=0.00558 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.189 | L2-Norm(final)=2.515 | 3936.5 samples/s | 61.5 steps/s
[Step=3650 Epoch=34.8] | Loss=0.00497 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.181 | L2-Norm(final)=2.518 | 1587.9 samples/s | 24.8 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00448 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.173 | L2-Norm(final)=2.520 | 3770.9 samples/s | 58.9 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00408 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.165 | L2-Norm(final)=2.522 | 1602.7 samples/s | 25.0 steps/s
[Step=3800 Epoch=36.2] | Loss=0.00375 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.524 | 3653.7 samples/s | 57.1 steps/s
[Step=3850 Epoch=36.7] | Loss=0.00346 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.150 | L2-Norm(final)=2.526 | 1629.4 samples/s | 25.5 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00322 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.528 | 3617.4 samples/s | 56.5 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00301 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.530 | 1604.9 samples/s | 25.1 steps/s
[Step=4000 Epoch=38.1] | Loss=0.00283 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.132 | L2-Norm(final)=2.532 | 3617.8 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23106 | acc=0.8068 | tpr=0.7381 | fpr=0.0441 | 3748.4 samples/s | 14.6 steps/s
Avg test loss: 0.23648, Avg test acc: 0.80467, Avg tpr: 0.73527, Avg fpr: 0.04269, total FA: 333

Testing server on iccad2012
[Step=  50] | Loss=0.43367 | acc=0.6823 | tpr=0.9690 | fpr=0.3228 | 3722.2 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.43470 | acc=0.6810 | tpr=0.9787 | fpr=0.3246 | 7493.6 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.43676 | acc=0.6777 | tpr=0.9798 | fpr=0.3279 | 7382.5 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.43938 | acc=0.6767 | tpr=0.9749 | fpr=0.3287 | 7294.5 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.44140 | acc=0.6765 | tpr=0.9755 | fpr=0.3290 | 7432.1 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.44193 | acc=0.6756 | tpr=0.9760 | fpr=0.3299 | 7319.6 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.44280 | acc=0.6750 | tpr=0.9775 | fpr=0.3305 | 7512.1 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.44327 | acc=0.6750 | tpr=0.9781 | fpr=0.3305 | 7474.2 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.44340 | acc=0.6750 | tpr=0.9766 | fpr=0.3304 | 7045.4 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.44384 | acc=0.6748 | tpr=0.9767 | fpr=0.3307 | 7281.1 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.44339 | acc=0.6746 | tpr=0.9769 | fpr=0.3309 | 13259.6 samples/s | 51.8 steps/s
Avg test loss: 0.44327, Avg test acc: 0.67464, Avg tpr: 0.97662, Avg fpr: 0.33085, total FA: 45938

server round 9/50

clients selected: [1 2 7 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.20451 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.106 | L2-Norm(final)=2.541 | 3328.6 samples/s | 52.0 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.08138 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.125 | L2-Norm(final)=2.523 | 3684.6 samples/s | 57.6 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.07325 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.135 | L2-Norm(final)=2.524 | 3773.8 samples/s | 59.0 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.06837 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.144 | L2-Norm(final)=2.522 | 3782.0 samples/s | 59.1 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.06595 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.155 | L2-Norm(final)=2.521 | 4715.4 samples/s | 73.7 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.06056 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.165 | L2-Norm(final)=2.521 | 1549.8 samples/s | 24.2 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.05617 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.176 | L2-Norm(final)=2.523 | 3790.3 samples/s | 59.2 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.05300 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.187 | L2-Norm(final)=2.527 | 3779.5 samples/s | 59.1 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.05118 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.197 | L2-Norm(final)=2.529 | 4503.4 samples/s | 70.4 steps/s
[Step=2050 Epoch=10.0] | Loss=0.04869 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.208 | L2-Norm(final)=2.532 | 1578.5 samples/s | 24.7 steps/s
[Step=2100 Epoch=10.2] | Loss=0.04630 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.217 | L2-Norm(final)=2.534 | 3778.2 samples/s | 59.0 steps/s
[Step=2150 Epoch=10.5] | Loss=0.04556 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.227 | L2-Norm(final)=2.537 | 3771.3 samples/s | 58.9 steps/s
[Step=2200 Epoch=10.7] | Loss=0.04427 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.237 | L2-Norm(final)=2.539 | 4306.3 samples/s | 67.3 steps/s
[Step=2250 Epoch=11.0] | Loss=0.04238 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.247 | L2-Norm(final)=2.541 | 1596.4 samples/s | 24.9 steps/s
[Step=2300 Epoch=11.2] | Loss=0.04063 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.256 | L2-Norm(final)=2.544 | 3751.5 samples/s | 58.6 steps/s
[Step=2350 Epoch=11.5] | Loss=0.03928 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.264 | L2-Norm(final)=2.547 | 3791.5 samples/s | 59.2 steps/s
[Step=2400 Epoch=11.7] | Loss=0.03813 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.272 | L2-Norm(final)=2.550 | 4131.3 samples/s | 64.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step2400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.09401 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.106 | L2-Norm(final)=2.542 | 3182.6 samples/s | 49.7 steps/s
[Step=3250 Epoch=15.8] | Loss=0.07993 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.113 | L2-Norm(final)=2.515 | 3823.1 samples/s | 59.7 steps/s
[Step=3300 Epoch=16.1] | Loss=0.06860 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.129 | L2-Norm(final)=2.519 | 3757.5 samples/s | 58.7 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06484 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9062 | L2-Norm=19.142 | L2-Norm(final)=2.523 | 3786.7 samples/s | 59.2 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06433 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.156 | L2-Norm(final)=2.524 | 4704.9 samples/s | 73.5 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05780 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.171 | L2-Norm(final)=2.527 | 1546.1 samples/s | 24.2 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05497 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.186 | L2-Norm(final)=2.535 | 3782.0 samples/s | 59.1 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05264 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.201 | L2-Norm(final)=2.539 | 3777.2 samples/s | 59.0 steps/s
[Step=3600 Epoch=17.5] | Loss=0.04969 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.215 | L2-Norm(final)=2.545 | 4448.1 samples/s | 69.5 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04681 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.551 | 1572.0 samples/s | 24.6 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04492 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.242 | L2-Norm(final)=2.557 | 3730.1 samples/s | 58.3 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04346 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.254 | L2-Norm(final)=2.562 | 3791.8 samples/s | 59.2 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04211 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.264 | L2-Norm(final)=2.565 | 4248.1 samples/s | 66.4 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04057 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.273 | L2-Norm(final)=2.569 | 1608.1 samples/s | 25.1 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03914 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.282 | L2-Norm(final)=2.573 | 3791.0 samples/s | 59.2 steps/s
[Step=3950 Epoch=19.2] | Loss=0.03810 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.290 | L2-Norm(final)=2.577 | 3773.5 samples/s | 59.0 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03695 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.297 | L2-Norm(final)=2.581 | 4029.3 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step4000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.6] | Loss=0.14647 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.106 | L2-Norm(final)=2.540 | 3192.4 samples/s | 49.9 steps/s
[Step=3250 Epoch=31.0] | Loss=0.02897 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.197 | L2-Norm(final)=2.506 | 3527.8 samples/s | 55.1 steps/s
[Step=3300 Epoch=31.5] | Loss=0.01755 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.206 | L2-Norm(final)=2.500 | 4576.5 samples/s | 71.5 steps/s
[Step=3350 Epoch=32.0] | Loss=0.01201 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.196 | L2-Norm(final)=2.502 | 1498.2 samples/s | 23.4 steps/s
[Step=3400 Epoch=32.5] | Loss=0.00906 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.183 | L2-Norm(final)=2.505 | 4327.4 samples/s | 67.6 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00727 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.171 | L2-Norm(final)=2.508 | 1510.1 samples/s | 23.6 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00607 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.159 | L2-Norm(final)=2.511 | 4119.6 samples/s | 64.4 steps/s
[Step=3550 Epoch=33.9] | Loss=0.00521 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.514 | 1550.7 samples/s | 24.2 steps/s
[Step=3600 Epoch=34.4] | Loss=0.00457 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.138 | L2-Norm(final)=2.517 | 3941.7 samples/s | 61.6 steps/s
[Step=3650 Epoch=34.9] | Loss=0.00407 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=2.520 | 1567.5 samples/s | 24.5 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00367 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.121 | L2-Norm(final)=2.522 | 3781.7 samples/s | 59.1 steps/s
[Step=3750 Epoch=35.8] | Loss=0.00335 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.114 | L2-Norm(final)=2.525 | 1603.4 samples/s | 25.1 steps/s
[Step=3800 Epoch=36.3] | Loss=0.00307 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.107 | L2-Norm(final)=2.527 | 3642.9 samples/s | 56.9 steps/s
[Step=3850 Epoch=36.8] | Loss=0.00284 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.101 | L2-Norm(final)=2.530 | 1612.9 samples/s | 25.2 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00265 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.096 | L2-Norm(final)=2.532 | 3586.5 samples/s | 56.0 steps/s
[Step=3950 Epoch=37.7] | Loss=0.00248 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.090 | L2-Norm(final)=2.534 | 1632.5 samples/s | 25.5 steps/s
[Step=4000 Epoch=38.2] | Loss=0.00233 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.085 | L2-Norm(final)=2.536 | 3617.2 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step4000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=60.3] | Loss=0.14783 | Reg=0.00365 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.106 | L2-Norm(final)=2.541 | 3208.1 samples/s | 50.1 steps/s
[Step=6450 Epoch=60.8] | Loss=0.06600 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.275 | L2-Norm(final)=2.456 | 3471.2 samples/s | 54.2 steps/s
[Step=6500 Epoch=61.2] | Loss=0.03680 | Reg=0.00373 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.323 | L2-Norm(final)=2.435 | 4497.4 samples/s | 70.3 steps/s
[Step=6550 Epoch=61.7] | Loss=0.02484 | Reg=0.00373 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.315 | L2-Norm(final)=2.434 | 1500.9 samples/s | 23.5 steps/s
[Step=6600 Epoch=62.2] | Loss=0.01886 | Reg=0.00372 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.300 | L2-Norm(final)=2.438 | 4198.6 samples/s | 65.6 steps/s
[Step=6650 Epoch=62.7] | Loss=0.01521 | Reg=0.00372 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.284 | L2-Norm(final)=2.443 | 1532.7 samples/s | 23.9 steps/s
[Step=6700 Epoch=63.1] | Loss=0.01271 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.269 | L2-Norm(final)=2.448 | 3912.0 samples/s | 61.1 steps/s
[Step=6750 Epoch=63.6] | Loss=0.01091 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.254 | L2-Norm(final)=2.453 | 1575.0 samples/s | 24.6 steps/s
[Step=6800 Epoch=64.1] | Loss=0.00956 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.241 | L2-Norm(final)=2.457 | 3721.6 samples/s | 58.2 steps/s
[Step=6850 Epoch=64.5] | Loss=0.00851 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.228 | L2-Norm(final)=2.462 | 1609.9 samples/s | 25.2 steps/s
[Step=6900 Epoch=65.0] | Loss=0.00767 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.217 | L2-Norm(final)=2.466 | 3586.7 samples/s | 56.0 steps/s
[Step=6950 Epoch=65.5] | Loss=0.00698 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.207 | L2-Norm(final)=2.470 | 1629.6 samples/s | 25.5 steps/s
[Step=7000 Epoch=66.0] | Loss=0.00641 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.197 | L2-Norm(final)=2.474 | 3612.2 samples/s | 56.4 steps/s
[Step=7050 Epoch=66.4] | Loss=0.00592 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.188 | L2-Norm(final)=2.478 | 1647.6 samples/s | 25.7 steps/s
[Step=7100 Epoch=66.9] | Loss=0.00551 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.180 | L2-Norm(final)=2.482 | 3556.0 samples/s | 55.6 steps/s
[Step=7150 Epoch=67.4] | Loss=0.00515 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.172 | L2-Norm(final)=2.485 | 1712.6 samples/s | 26.8 steps/s
[Step=7200 Epoch=67.8] | Loss=0.00484 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.165 | L2-Norm(final)=2.489 | 3316.7 samples/s | 51.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step7200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.16613 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.106 | L2-Norm(final)=2.541 | 3298.0 samples/s | 51.5 steps/s
[Step=4050 Epoch=38.6] | Loss=0.04007 | Reg=0.00370 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.233 | L2-Norm(final)=2.489 | 3371.7 samples/s | 52.7 steps/s
[Step=4100 Epoch=39.1] | Loss=0.02174 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.252 | L2-Norm(final)=2.485 | 4537.4 samples/s | 70.9 steps/s
[Step=4150 Epoch=39.6] | Loss=0.01468 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.242 | L2-Norm(final)=2.488 | 1497.9 samples/s | 23.4 steps/s
[Step=4200 Epoch=40.0] | Loss=0.01110 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.228 | L2-Norm(final)=2.493 | 4317.6 samples/s | 67.5 steps/s
[Step=4250 Epoch=40.5] | Loss=0.00893 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.214 | L2-Norm(final)=2.498 | 1517.2 samples/s | 23.7 steps/s
[Step=4300 Epoch=41.0] | Loss=0.00746 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.200 | L2-Norm(final)=2.502 | 4129.2 samples/s | 64.5 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00640 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.188 | L2-Norm(final)=2.506 | 1559.3 samples/s | 24.4 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00561 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.176 | L2-Norm(final)=2.510 | 3967.6 samples/s | 62.0 steps/s
[Step=4450 Epoch=42.4] | Loss=0.00500 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.166 | L2-Norm(final)=2.513 | 1561.9 samples/s | 24.4 steps/s
[Step=4500 Epoch=42.9] | Loss=0.00451 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.156 | L2-Norm(final)=2.517 | 3789.2 samples/s | 59.2 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00411 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.147 | L2-Norm(final)=2.520 | 1593.3 samples/s | 24.9 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00377 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.139 | L2-Norm(final)=2.523 | 3627.8 samples/s | 56.7 steps/s
[Step=4650 Epoch=44.3] | Loss=0.00349 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.131 | L2-Norm(final)=2.526 | 1620.3 samples/s | 25.3 steps/s
[Step=4700 Epoch=44.8] | Loss=0.00325 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.124 | L2-Norm(final)=2.528 | 3624.0 samples/s | 56.6 steps/s
[Step=4750 Epoch=45.3] | Loss=0.00304 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.118 | L2-Norm(final)=2.531 | 1621.6 samples/s | 25.3 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00285 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.534 | 3615.9 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24590 | acc=0.8041 | tpr=0.7301 | fpr=0.0354 | 3748.9 samples/s | 14.6 steps/s
Avg test loss: 0.25240, Avg test acc: 0.80223, Avg tpr: 0.72868, Avg fpr: 0.03602, total FA: 281

Testing server on iccad2012
[Step=  50] | Loss=0.45134 | acc=0.6837 | tpr=0.9779 | fpr=0.3216 | 3705.3 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.45272 | acc=0.6839 | tpr=0.9829 | fpr=0.3217 | 7458.5 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.45539 | acc=0.6808 | tpr=0.9827 | fpr=0.3247 | 7366.0 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.45821 | acc=0.6809 | tpr=0.9814 | fpr=0.3246 | 7341.9 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.45999 | acc=0.6805 | tpr=0.9817 | fpr=0.3250 | 7349.5 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.46058 | acc=0.6796 | tpr=0.9811 | fpr=0.3259 | 7353.4 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.46122 | acc=0.6790 | tpr=0.9831 | fpr=0.3265 | 7432.1 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.46161 | acc=0.6792 | tpr=0.9830 | fpr=0.3264 | 7291.3 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.46171 | acc=0.6792 | tpr=0.9815 | fpr=0.3263 | 7352.0 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.46221 | acc=0.6789 | tpr=0.9806 | fpr=0.3266 | 7239.3 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.46167 | acc=0.6788 | tpr=0.9805 | fpr=0.3267 | 13269.8 samples/s | 51.8 steps/s
Avg test loss: 0.46151, Avg test acc: 0.67888, Avg tpr: 0.98059, Avg fpr: 0.32661, total FA: 45349

server round 10/50

clients selected: [2 3 4 5 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=19.5] | Loss=0.14339 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.115 | L2-Norm(final)=2.576 | 3432.4 samples/s | 53.6 steps/s
[Step=4050 Epoch=19.7] | Loss=0.06423 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.097 | L2-Norm(final)=2.565 | 3517.7 samples/s | 55.0 steps/s
[Step=4100 Epoch=20.0] | Loss=0.05407 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.092 | L2-Norm(final)=2.565 | 3775.8 samples/s | 59.0 steps/s
[Step=4150 Epoch=20.2] | Loss=0.05060 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.091 | L2-Norm(final)=2.568 | 3778.1 samples/s | 59.0 steps/s
[Step=4200 Epoch=20.5] | Loss=0.04777 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.094 | L2-Norm(final)=2.571 | 4696.9 samples/s | 73.4 steps/s
[Step=4250 Epoch=20.7] | Loss=0.04328 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.099 | L2-Norm(final)=2.577 | 1559.5 samples/s | 24.4 steps/s
[Step=4300 Epoch=21.0] | Loss=0.03936 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.105 | L2-Norm(final)=2.583 | 3772.8 samples/s | 58.9 steps/s
[Step=4350 Epoch=21.2] | Loss=0.03601 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.111 | L2-Norm(final)=2.591 | 3780.8 samples/s | 59.1 steps/s
[Step=4400 Epoch=21.4] | Loss=0.03349 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.117 | L2-Norm(final)=2.599 | 4456.8 samples/s | 69.6 steps/s
[Step=4450 Epoch=21.7] | Loss=0.03077 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.123 | L2-Norm(final)=2.606 | 1571.3 samples/s | 24.6 steps/s
[Step=4500 Epoch=21.9] | Loss=0.02918 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.127 | L2-Norm(final)=2.614 | 3791.2 samples/s | 59.2 steps/s
[Step=4550 Epoch=22.2] | Loss=0.02787 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.132 | L2-Norm(final)=2.620 | 3775.7 samples/s | 59.0 steps/s
[Step=4600 Epoch=22.4] | Loss=0.02710 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.626 | 4236.0 samples/s | 66.2 steps/s
[Step=4650 Epoch=22.7] | Loss=0.02590 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.141 | L2-Norm(final)=2.632 | 1608.1 samples/s | 25.1 steps/s
[Step=4700 Epoch=22.9] | Loss=0.02479 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.637 | 3768.0 samples/s | 58.9 steps/s
[Step=4750 Epoch=23.1] | Loss=0.02382 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.148 | L2-Norm(final)=2.642 | 3739.6 samples/s | 58.4 steps/s
[Step=4800 Epoch=23.4] | Loss=0.02304 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.151 | L2-Norm(final)=2.647 | 4039.5 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step4800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=15.6] | Loss=0.12200 | Reg=0.00365 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.115 | L2-Norm(final)=2.576 | 3455.5 samples/s | 54.0 steps/s
[Step=3250 Epoch=15.8] | Loss=0.05941 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=19.096 | L2-Norm(final)=2.568 | 3579.8 samples/s | 55.9 steps/s
[Step=3300 Epoch=16.1] | Loss=0.04985 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.091 | L2-Norm(final)=2.570 | 3768.9 samples/s | 58.9 steps/s
[Step=3350 Epoch=16.3] | Loss=0.04528 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.089 | L2-Norm(final)=2.572 | 3773.0 samples/s | 59.0 steps/s
[Step=3400 Epoch=16.6] | Loss=0.04367 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.089 | L2-Norm(final)=2.575 | 4704.5 samples/s | 73.5 steps/s
[Step=3450 Epoch=16.8] | Loss=0.03879 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.092 | L2-Norm(final)=2.579 | 1542.2 samples/s | 24.1 steps/s
[Step=3500 Epoch=17.1] | Loss=0.03533 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.095 | L2-Norm(final)=2.585 | 3790.4 samples/s | 59.2 steps/s
[Step=3550 Epoch=17.3] | Loss=0.03351 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.099 | L2-Norm(final)=2.590 | 3792.1 samples/s | 59.3 steps/s
[Step=3600 Epoch=17.6] | Loss=0.03140 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.104 | L2-Norm(final)=2.595 | 4475.0 samples/s | 69.9 steps/s
[Step=3650 Epoch=17.8] | Loss=0.02955 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.108 | L2-Norm(final)=2.601 | 1581.5 samples/s | 24.7 steps/s
[Step=3700 Epoch=18.0] | Loss=0.02778 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.606 | 3744.0 samples/s | 58.5 steps/s
[Step=3750 Epoch=18.3] | Loss=0.02665 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.116 | L2-Norm(final)=2.612 | 3774.3 samples/s | 59.0 steps/s
[Step=3800 Epoch=18.5] | Loss=0.02570 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.120 | L2-Norm(final)=2.616 | 4236.6 samples/s | 66.2 steps/s
[Step=3850 Epoch=18.8] | Loss=0.02450 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.123 | L2-Norm(final)=2.621 | 1605.5 samples/s | 25.1 steps/s
[Step=3900 Epoch=19.0] | Loss=0.02339 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.126 | L2-Norm(final)=2.625 | 3801.1 samples/s | 59.4 steps/s
[Step=3950 Epoch=19.3] | Loss=0.02263 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=2.630 | 3784.3 samples/s | 59.1 steps/s
[Step=4000 Epoch=19.5] | Loss=0.02203 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.132 | L2-Norm(final)=2.634 | 4042.2 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step4000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=19.6] | Loss=0.12298 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.115 | L2-Norm(final)=2.576 | 3257.1 samples/s | 50.9 steps/s
[Step=4050 Epoch=19.9] | Loss=0.06269 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.098 | L2-Norm(final)=2.567 | 3728.2 samples/s | 58.3 steps/s
[Step=4100 Epoch=20.1] | Loss=0.05332 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.094 | L2-Norm(final)=2.568 | 3782.5 samples/s | 59.1 steps/s
[Step=4150 Epoch=20.4] | Loss=0.04920 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.093 | L2-Norm(final)=2.570 | 3776.9 samples/s | 59.0 steps/s
[Step=4200 Epoch=20.6] | Loss=0.04454 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.094 | L2-Norm(final)=2.572 | 4736.4 samples/s | 74.0 steps/s
[Step=4250 Epoch=20.8] | Loss=0.03919 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.097 | L2-Norm(final)=2.577 | 1545.2 samples/s | 24.1 steps/s
[Step=4300 Epoch=21.1] | Loss=0.03537 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.101 | L2-Norm(final)=2.584 | 3775.3 samples/s | 59.0 steps/s
[Step=4350 Epoch=21.3] | Loss=0.03314 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.106 | L2-Norm(final)=2.591 | 3771.2 samples/s | 58.9 steps/s
[Step=4400 Epoch=21.6] | Loss=0.03150 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.598 | 4558.7 samples/s | 71.2 steps/s
[Step=4450 Epoch=21.8] | Loss=0.03000 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.116 | L2-Norm(final)=2.604 | 1562.7 samples/s | 24.4 steps/s
[Step=4500 Epoch=22.1] | Loss=0.02817 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.120 | L2-Norm(final)=2.610 | 3765.3 samples/s | 58.8 steps/s
[Step=4550 Epoch=22.3] | Loss=0.02684 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.124 | L2-Norm(final)=2.615 | 3797.4 samples/s | 59.3 steps/s
[Step=4600 Epoch=22.6] | Loss=0.02595 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.128 | L2-Norm(final)=2.620 | 4442.3 samples/s | 69.4 steps/s
[Step=4650 Epoch=22.8] | Loss=0.02480 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.132 | L2-Norm(final)=2.625 | 1584.9 samples/s | 24.8 steps/s
[Step=4700 Epoch=23.0] | Loss=0.02387 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.135 | L2-Norm(final)=2.630 | 3774.0 samples/s | 59.0 steps/s
[Step=4750 Epoch=23.3] | Loss=0.02295 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.138 | L2-Norm(final)=2.635 | 3791.1 samples/s | 59.2 steps/s
[Step=4800 Epoch=23.5] | Loss=0.02244 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.142 | L2-Norm(final)=2.640 | 4291.3 samples/s | 67.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step4800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=2401 Epoch=22.8] | Loss=0.21602 | Reg=0.00365 | FP-Reg=0.000 | acc=0.7500 | L2-Norm=19.115 | L2-Norm(final)=2.576 | 3326.3 samples/s | 52.0 steps/s
[Step=2450 Epoch=23.2] | Loss=0.02245 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.567 | 3340.4 samples/s | 52.2 steps/s
[Step=2500 Epoch=23.7] | Loss=0.01399 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.131 | L2-Norm(final)=2.565 | 4517.8 samples/s | 70.6 steps/s
[Step=2550 Epoch=24.2] | Loss=0.00950 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.123 | L2-Norm(final)=2.566 | 1499.4 samples/s | 23.4 steps/s
[Step=2600 Epoch=24.6] | Loss=0.00723 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.115 | L2-Norm(final)=2.568 | 4262.4 samples/s | 66.6 steps/s
[Step=2650 Epoch=25.1] | Loss=0.00581 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.108 | L2-Norm(final)=2.570 | 1527.1 samples/s | 23.9 steps/s
[Step=2700 Epoch=25.6] | Loss=0.00485 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.101 | L2-Norm(final)=2.572 | 4010.6 samples/s | 62.7 steps/s
[Step=2750 Epoch=26.1] | Loss=0.00417 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.095 | L2-Norm(final)=2.573 | 1555.5 samples/s | 24.3 steps/s
[Step=2800 Epoch=26.5] | Loss=0.00366 | Reg=0.00364 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.089 | L2-Norm(final)=2.575 | 3818.0 samples/s | 59.7 steps/s
[Step=2850 Epoch=27.0] | Loss=0.00326 | Reg=0.00364 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.084 | L2-Norm(final)=2.576 | 1597.0 samples/s | 25.0 steps/s
[Step=2900 Epoch=27.5] | Loss=0.00294 | Reg=0.00364 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.079 | L2-Norm(final)=2.577 | 3672.0 samples/s | 57.4 steps/s
[Step=2950 Epoch=28.0] | Loss=0.00268 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.075 | L2-Norm(final)=2.578 | 1620.5 samples/s | 25.3 steps/s
[Step=3000 Epoch=28.4] | Loss=0.00246 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.071 | L2-Norm(final)=2.579 | 3600.4 samples/s | 56.3 steps/s
[Step=3050 Epoch=28.9] | Loss=0.00228 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.067 | L2-Norm(final)=2.580 | 1635.3 samples/s | 25.6 steps/s
[Step=3100 Epoch=29.4] | Loss=0.00212 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.063 | L2-Norm(final)=2.581 | 3629.5 samples/s | 56.7 steps/s
[Step=3150 Epoch=29.8] | Loss=0.00199 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.060 | L2-Norm(final)=2.582 | 1639.8 samples/s | 25.6 steps/s
[Step=3200 Epoch=30.3] | Loss=0.00187 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.057 | L2-Norm(final)=2.583 | 3584.8 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step3200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=45.8] | Loss=0.15496 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.115 | L2-Norm(final)=2.576 | 3178.8 samples/s | 49.7 steps/s
[Step=4850 Epoch=46.2] | Loss=0.01956 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.116 | L2-Norm(final)=2.567 | 3566.4 samples/s | 55.7 steps/s
[Step=4900 Epoch=46.7] | Loss=0.01160 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.572 | 4546.8 samples/s | 71.0 steps/s
[Step=4950 Epoch=47.2] | Loss=0.00809 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.107 | L2-Norm(final)=2.577 | 1502.0 samples/s | 23.5 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00611 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.101 | L2-Norm(final)=2.580 | 4334.3 samples/s | 67.7 steps/s
[Step=5050 Epoch=48.1] | Loss=0.00492 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.095 | L2-Norm(final)=2.583 | 1523.0 samples/s | 23.8 steps/s
[Step=5100 Epoch=48.6] | Loss=0.00411 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.089 | L2-Norm(final)=2.585 | 4126.8 samples/s | 64.5 steps/s
[Step=5150 Epoch=49.1] | Loss=0.00354 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.083 | L2-Norm(final)=2.587 | 1556.9 samples/s | 24.3 steps/s
[Step=5200 Epoch=49.6] | Loss=0.00311 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.078 | L2-Norm(final)=2.589 | 3931.8 samples/s | 61.4 steps/s
[Step=5250 Epoch=50.0] | Loss=0.00277 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.074 | L2-Norm(final)=2.590 | 1572.7 samples/s | 24.6 steps/s
[Step=5300 Epoch=50.5] | Loss=0.00250 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.070 | L2-Norm(final)=2.592 | 3802.7 samples/s | 59.4 steps/s
[Step=5350 Epoch=51.0] | Loss=0.00228 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.066 | L2-Norm(final)=2.593 | 1616.8 samples/s | 25.3 steps/s
[Step=5400 Epoch=51.5] | Loss=0.00210 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.062 | L2-Norm(final)=2.595 | 3635.0 samples/s | 56.8 steps/s
[Step=5450 Epoch=51.9] | Loss=0.00195 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.059 | L2-Norm(final)=2.596 | 1621.9 samples/s | 25.3 steps/s
[Step=5500 Epoch=52.4] | Loss=0.00181 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.056 | L2-Norm(final)=2.597 | 3607.9 samples/s | 56.4 steps/s
[Step=5550 Epoch=52.9] | Loss=0.00170 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.598 | 1638.2 samples/s | 25.6 steps/s
[Step=5600 Epoch=53.4] | Loss=0.00160 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.050 | L2-Norm(final)=2.599 | 3602.1 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33587 | acc=0.7553 | tpr=0.6555 | fpr=0.0280 | 3745.5 samples/s | 14.6 steps/s
Avg test loss: 0.34325, Avg test acc: 0.75487, Avg tpr: 0.65618, Avg fpr: 0.02807, total FA: 219

Testing server on iccad2012
[Step=  50] | Loss=0.37486 | acc=0.7579 | tpr=0.9690 | fpr=0.2459 | 3715.7 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.37871 | acc=0.7584 | tpr=0.9787 | fpr=0.2457 | 7579.0 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.38177 | acc=0.7552 | tpr=0.9827 | fpr=0.2490 | 7303.0 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.38508 | acc=0.7544 | tpr=0.9825 | fpr=0.2497 | 7435.4 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.38639 | acc=0.7540 | tpr=0.9825 | fpr=0.2502 | 7356.2 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.38699 | acc=0.7538 | tpr=0.9825 | fpr=0.2504 | 7407.2 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.38785 | acc=0.7532 | tpr=0.9843 | fpr=0.2510 | 7443.2 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.38856 | acc=0.7532 | tpr=0.9836 | fpr=0.2510 | 7164.9 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.38862 | acc=0.7534 | tpr=0.9820 | fpr=0.2508 | 7061.4 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.38926 | acc=0.7531 | tpr=0.9811 | fpr=0.2511 | 7475.4 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.38873 | acc=0.7531 | tpr=0.9809 | fpr=0.2510 | 13147.4 samples/s | 51.4 steps/s
Avg test loss: 0.38855, Avg test acc: 0.75318, Avg tpr: 0.98098, Avg fpr: 0.25096, total FA: 34845

server round 11/50

clients selected: [1 2 3 7 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=2401 Epoch=11.7] | Loss=0.40919 | Reg=0.00364 | FP-Reg=0.000 | acc=0.7344 | L2-Norm=19.084 | L2-Norm(final)=2.619 | 3141.3 samples/s | 49.1 steps/s
[Step=2450 Epoch=12.0] | Loss=0.06898 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.077 | L2-Norm(final)=2.603 | 3909.4 samples/s | 61.1 steps/s
[Step=2500 Epoch=12.2] | Loss=0.06090 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.072 | L2-Norm(final)=2.602 | 3779.2 samples/s | 59.0 steps/s
[Step=2550 Epoch=12.4] | Loss=0.05425 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.070 | L2-Norm(final)=2.602 | 3793.6 samples/s | 59.3 steps/s
[Step=2600 Epoch=12.7] | Loss=0.04962 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.071 | L2-Norm(final)=2.604 | 4712.0 samples/s | 73.6 steps/s
[Step=2650 Epoch=12.9] | Loss=0.04386 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.073 | L2-Norm(final)=2.607 | 1551.7 samples/s | 24.2 steps/s
[Step=2700 Epoch=13.2] | Loss=0.03997 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.076 | L2-Norm(final)=2.611 | 3778.6 samples/s | 59.0 steps/s
[Step=2750 Epoch=13.4] | Loss=0.03711 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.079 | L2-Norm(final)=2.615 | 3753.3 samples/s | 58.6 steps/s
[Step=2800 Epoch=13.7] | Loss=0.03443 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.082 | L2-Norm(final)=2.620 | 4491.8 samples/s | 70.2 steps/s
[Step=2850 Epoch=13.9] | Loss=0.03221 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.086 | L2-Norm(final)=2.625 | 1564.2 samples/s | 24.4 steps/s
[Step=2900 Epoch=14.2] | Loss=0.03026 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.089 | L2-Norm(final)=2.629 | 3783.8 samples/s | 59.1 steps/s
[Step=2950 Epoch=14.4] | Loss=0.02877 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.092 | L2-Norm(final)=2.634 | 3762.2 samples/s | 58.8 steps/s
[Step=3000 Epoch=14.6] | Loss=0.02752 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.095 | L2-Norm(final)=2.638 | 4321.3 samples/s | 67.5 steps/s
[Step=3050 Epoch=14.9] | Loss=0.02647 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.098 | L2-Norm(final)=2.642 | 1596.1 samples/s | 24.9 steps/s
[Step=3100 Epoch=15.1] | Loss=0.02538 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.101 | L2-Norm(final)=2.646 | 3772.8 samples/s | 59.0 steps/s
[Step=3150 Epoch=15.4] | Loss=0.02461 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.104 | L2-Norm(final)=2.650 | 3763.4 samples/s | 58.8 steps/s
[Step=3200 Epoch=15.6] | Loss=0.02389 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.106 | L2-Norm(final)=2.653 | 4152.9 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step3200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.17560 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.084 | L2-Norm(final)=2.620 | 3357.9 samples/s | 52.5 steps/s
[Step=4850 Epoch=23.6] | Loss=0.06806 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.075 | L2-Norm(final)=2.601 | 3625.8 samples/s | 56.7 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05979 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.072 | L2-Norm(final)=2.596 | 3777.4 samples/s | 59.0 steps/s
[Step=4950 Epoch=24.1] | Loss=0.05291 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.072 | L2-Norm(final)=2.596 | 3780.8 samples/s | 59.1 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04753 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.074 | L2-Norm(final)=2.600 | 4698.9 samples/s | 73.4 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04274 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.078 | L2-Norm(final)=2.605 | 1546.6 samples/s | 24.2 steps/s
[Step=5100 Epoch=24.8] | Loss=0.03880 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.083 | L2-Norm(final)=2.611 | 3781.7 samples/s | 59.1 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03598 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.087 | L2-Norm(final)=2.617 | 3789.8 samples/s | 59.2 steps/s
[Step=5200 Epoch=25.3] | Loss=0.03367 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.092 | L2-Norm(final)=2.624 | 4460.6 samples/s | 69.7 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03140 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.096 | L2-Norm(final)=2.630 | 1574.5 samples/s | 24.6 steps/s
[Step=5300 Epoch=25.8] | Loss=0.02983 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.100 | L2-Norm(final)=2.637 | 3751.4 samples/s | 58.6 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02849 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.104 | L2-Norm(final)=2.642 | 3783.5 samples/s | 59.1 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02775 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.108 | L2-Norm(final)=2.647 | 4227.2 samples/s | 66.0 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02652 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.112 | L2-Norm(final)=2.652 | 1614.7 samples/s | 25.2 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02532 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.115 | L2-Norm(final)=2.657 | 3797.1 samples/s | 59.3 steps/s
[Step=5550 Epoch=27.0] | Loss=0.02433 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.118 | L2-Norm(final)=2.661 | 3793.4 samples/s | 59.3 steps/s
[Step=5600 Epoch=27.3] | Loss=0.02389 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.121 | L2-Norm(final)=2.666 | 4028.4 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step5600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=19.5] | Loss=0.26739 | Reg=0.00364 | FP-Reg=0.000 | acc=0.7812 | L2-Norm=19.084 | L2-Norm(final)=2.620 | 3349.0 samples/s | 52.3 steps/s
[Step=4050 Epoch=19.8] | Loss=0.06902 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9062 | L2-Norm=19.079 | L2-Norm(final)=2.598 | 3664.1 samples/s | 57.3 steps/s
[Step=4100 Epoch=20.0] | Loss=0.05745 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.079 | L2-Norm(final)=2.599 | 3783.3 samples/s | 59.1 steps/s
[Step=4150 Epoch=20.2] | Loss=0.05128 | Reg=0.00364 | FP-Reg=0.001 | acc=0.8906 | L2-Norm=19.079 | L2-Norm(final)=2.601 | 3756.8 samples/s | 58.7 steps/s
[Step=4200 Epoch=20.5] | Loss=0.04726 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.079 | L2-Norm(final)=2.604 | 4695.7 samples/s | 73.4 steps/s
[Step=4250 Epoch=20.7] | Loss=0.04104 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.081 | L2-Norm(final)=2.608 | 1551.2 samples/s | 24.2 steps/s
[Step=4300 Epoch=21.0] | Loss=0.03745 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.084 | L2-Norm(final)=2.613 | 3773.5 samples/s | 59.0 steps/s
[Step=4350 Epoch=21.2] | Loss=0.03429 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.087 | L2-Norm(final)=2.619 | 3778.8 samples/s | 59.0 steps/s
[Step=4400 Epoch=21.5] | Loss=0.03252 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.090 | L2-Norm(final)=2.625 | 4453.3 samples/s | 69.6 steps/s
[Step=4450 Epoch=21.7] | Loss=0.03048 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.094 | L2-Norm(final)=2.630 | 1578.1 samples/s | 24.7 steps/s
[Step=4500 Epoch=21.9] | Loss=0.02873 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.097 | L2-Norm(final)=2.635 | 3771.6 samples/s | 58.9 steps/s
[Step=4550 Epoch=22.2] | Loss=0.02743 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.100 | L2-Norm(final)=2.640 | 3779.8 samples/s | 59.1 steps/s
[Step=4600 Epoch=22.4] | Loss=0.02630 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.104 | L2-Norm(final)=2.645 | 4245.3 samples/s | 66.3 steps/s
[Step=4650 Epoch=22.7] | Loss=0.02522 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.107 | L2-Norm(final)=2.650 | 1610.4 samples/s | 25.2 steps/s
[Step=4700 Epoch=22.9] | Loss=0.02415 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.110 | L2-Norm(final)=2.654 | 3763.2 samples/s | 58.8 steps/s
[Step=4750 Epoch=23.2] | Loss=0.02333 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.113 | L2-Norm(final)=2.659 | 3781.5 samples/s | 59.1 steps/s
[Step=4800 Epoch=23.4] | Loss=0.02273 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.116 | L2-Norm(final)=2.663 | 4029.5 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step4800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=38.2] | Loss=0.15006 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.084 | L2-Norm(final)=2.619 | 3312.4 samples/s | 51.8 steps/s
[Step=4050 Epoch=38.7] | Loss=0.01614 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.075 | L2-Norm(final)=2.604 | 3404.2 samples/s | 53.2 steps/s
[Step=4100 Epoch=39.2] | Loss=0.00885 | Reg=0.00364 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.068 | L2-Norm(final)=2.607 | 4546.7 samples/s | 71.0 steps/s
[Step=4150 Epoch=39.6] | Loss=0.00598 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.061 | L2-Norm(final)=2.611 | 1503.0 samples/s | 23.5 steps/s
[Step=4200 Epoch=40.1] | Loss=0.00451 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.054 | L2-Norm(final)=2.613 | 4305.9 samples/s | 67.3 steps/s
[Step=4250 Epoch=40.6] | Loss=0.00362 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.048 | L2-Norm(final)=2.616 | 1530.4 samples/s | 23.9 steps/s
[Step=4300 Epoch=41.1] | Loss=0.00303 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.042 | L2-Norm(final)=2.617 | 4099.8 samples/s | 64.1 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00260 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.037 | L2-Norm(final)=2.619 | 1547.6 samples/s | 24.2 steps/s
[Step=4400 Epoch=42.0] | Loss=0.00229 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.032 | L2-Norm(final)=2.620 | 3938.8 samples/s | 61.5 steps/s
[Step=4450 Epoch=42.5] | Loss=0.00204 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.028 | L2-Norm(final)=2.622 | 1589.0 samples/s | 24.8 steps/s
[Step=4500 Epoch=43.0] | Loss=0.00184 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.024 | L2-Norm(final)=2.623 | 3795.0 samples/s | 59.3 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00168 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.020 | L2-Norm(final)=2.624 | 1582.3 samples/s | 24.7 steps/s
[Step=4600 Epoch=43.9] | Loss=0.00155 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.017 | L2-Norm(final)=2.625 | 3648.4 samples/s | 57.0 steps/s
[Step=4650 Epoch=44.4] | Loss=0.00143 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.014 | L2-Norm(final)=2.627 | 1629.3 samples/s | 25.5 steps/s
[Step=4700 Epoch=44.9] | Loss=0.00134 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.011 | L2-Norm(final)=2.628 | 3605.4 samples/s | 56.3 steps/s
[Step=4750 Epoch=45.4] | Loss=0.00125 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.629 | 1629.7 samples/s | 25.5 steps/s
[Step=4800 Epoch=45.8] | Loss=0.00118 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.006 | L2-Norm(final)=2.630 | 3635.7 samples/s | 56.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step4800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=53.4] | Loss=0.16295 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.084 | L2-Norm(final)=2.620 | 3242.9 samples/s | 50.7 steps/s
[Step=5650 Epoch=53.8] | Loss=0.02328 | Reg=0.00364 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.091 | L2-Norm(final)=2.599 | 3415.2 samples/s | 53.4 steps/s
[Step=5700 Epoch=54.3] | Loss=0.01264 | Reg=0.00364 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.087 | L2-Norm(final)=2.602 | 4512.3 samples/s | 70.5 steps/s
[Step=5750 Epoch=54.8] | Loss=0.00852 | Reg=0.00364 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.080 | L2-Norm(final)=2.606 | 1501.4 samples/s | 23.5 steps/s
[Step=5800 Epoch=55.3] | Loss=0.00644 | Reg=0.00364 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.073 | L2-Norm(final)=2.609 | 4304.7 samples/s | 67.3 steps/s
[Step=5850 Epoch=55.8] | Loss=0.00517 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.065 | L2-Norm(final)=2.611 | 1525.0 samples/s | 23.8 steps/s
[Step=5900 Epoch=56.2] | Loss=0.00432 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.059 | L2-Norm(final)=2.614 | 4113.3 samples/s | 64.3 steps/s
[Step=5950 Epoch=56.7] | Loss=0.00371 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.615 | 1551.0 samples/s | 24.2 steps/s
[Step=6000 Epoch=57.2] | Loss=0.00326 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.048 | L2-Norm(final)=2.617 | 3957.0 samples/s | 61.8 steps/s
[Step=6050 Epoch=57.7] | Loss=0.00290 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.043 | L2-Norm(final)=2.619 | 1567.4 samples/s | 24.5 steps/s
[Step=6100 Epoch=58.1] | Loss=0.00262 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.038 | L2-Norm(final)=2.620 | 3793.7 samples/s | 59.3 steps/s
[Step=6150 Epoch=58.6] | Loss=0.00239 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.034 | L2-Norm(final)=2.621 | 1605.0 samples/s | 25.1 steps/s
[Step=6200 Epoch=59.1] | Loss=0.00220 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.031 | L2-Norm(final)=2.623 | 3645.6 samples/s | 57.0 steps/s
[Step=6250 Epoch=59.6] | Loss=0.00203 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.027 | L2-Norm(final)=2.624 | 1612.2 samples/s | 25.2 steps/s
[Step=6300 Epoch=60.0] | Loss=0.00189 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.024 | L2-Norm(final)=2.625 | 3608.7 samples/s | 56.4 steps/s
[Step=6350 Epoch=60.5] | Loss=0.00177 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.021 | L2-Norm(final)=2.626 | 1620.5 samples/s | 25.3 steps/s
[Step=6400 Epoch=61.0] | Loss=0.00166 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.018 | L2-Norm(final)=2.627 | 3622.3 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34008 | acc=0.7568 | tpr=0.6559 | fpr=0.0240 | 3757.0 samples/s | 14.7 steps/s
Avg test loss: 0.34679, Avg test acc: 0.75663, Avg tpr: 0.65752, Avg fpr: 0.02538, total FA: 198

Testing server on iccad2012
[Step=  50] | Loss=0.35390 | acc=0.7781 | tpr=0.9690 | fpr=0.2253 | 3746.6 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.35808 | acc=0.7775 | tpr=0.9787 | fpr=0.2263 | 7330.9 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.36130 | acc=0.7750 | tpr=0.9827 | fpr=0.2288 | 7318.5 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.36494 | acc=0.7748 | tpr=0.9825 | fpr=0.2290 | 7393.9 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.36587 | acc=0.7745 | tpr=0.9843 | fpr=0.2293 | 7256.8 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.36619 | acc=0.7744 | tpr=0.9833 | fpr=0.2294 | 7472.9 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.36729 | acc=0.7741 | tpr=0.9825 | fpr=0.2297 | 7253.0 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.36835 | acc=0.7742 | tpr=0.9819 | fpr=0.2295 | 7591.9 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.36841 | acc=0.7747 | tpr=0.9800 | fpr=0.2291 | 7213.7 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.36902 | acc=0.7744 | tpr=0.9793 | fpr=0.2293 | 7346.1 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.36846 | acc=0.7746 | tpr=0.9793 | fpr=0.2291 | 13342.4 samples/s | 52.1 steps/s
Avg test loss: 0.36827, Avg test acc: 0.77465, Avg tpr: 0.97900, Avg fpr: 0.22906, total FA: 31805

server round 12/50

clients selected: [0 1 4 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=19.5] | Loss=0.23604 | Reg=0.00363 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.057 | L2-Norm(final)=2.645 | 3391.4 samples/s | 53.0 steps/s
[Step=4050 Epoch=19.7] | Loss=0.07225 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.039 | L2-Norm(final)=2.624 | 3544.2 samples/s | 55.4 steps/s
[Step=4100 Epoch=20.0] | Loss=0.05610 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.035 | L2-Norm(final)=2.621 | 3763.9 samples/s | 58.8 steps/s
[Step=4150 Epoch=20.2] | Loss=0.04781 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.036 | L2-Norm(final)=2.624 | 3789.4 samples/s | 59.2 steps/s
[Step=4200 Epoch=20.5] | Loss=0.04385 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.039 | L2-Norm(final)=2.629 | 4693.3 samples/s | 73.3 steps/s
[Step=4250 Epoch=20.7] | Loss=0.03817 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.042 | L2-Norm(final)=2.635 | 1549.4 samples/s | 24.2 steps/s
[Step=4300 Epoch=21.0] | Loss=0.03551 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.045 | L2-Norm(final)=2.641 | 3740.7 samples/s | 58.4 steps/s
[Step=4350 Epoch=21.2] | Loss=0.03281 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.049 | L2-Norm(final)=2.646 | 3776.2 samples/s | 59.0 steps/s
[Step=4400 Epoch=21.5] | Loss=0.03044 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.652 | 4452.3 samples/s | 69.6 steps/s
[Step=4450 Epoch=21.7] | Loss=0.02815 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.057 | L2-Norm(final)=2.658 | 1584.0 samples/s | 24.8 steps/s
[Step=4500 Epoch=21.9] | Loss=0.02628 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.060 | L2-Norm(final)=2.664 | 3766.1 samples/s | 58.8 steps/s
[Step=4550 Epoch=22.2] | Loss=0.02516 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.063 | L2-Norm(final)=2.669 | 3782.5 samples/s | 59.1 steps/s
[Step=4600 Epoch=22.4] | Loss=0.02428 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.066 | L2-Norm(final)=2.674 | 4250.9 samples/s | 66.4 steps/s
[Step=4650 Epoch=22.7] | Loss=0.02328 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.069 | L2-Norm(final)=2.679 | 1613.1 samples/s | 25.2 steps/s
[Step=4700 Epoch=22.9] | Loss=0.02230 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.071 | L2-Norm(final)=2.683 | 3791.3 samples/s | 59.2 steps/s
[Step=4750 Epoch=23.2] | Loss=0.02141 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.073 | L2-Norm(final)=2.687 | 3755.9 samples/s | 58.7 steps/s
[Step=4800 Epoch=23.4] | Loss=0.02066 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.075 | L2-Norm(final)=2.691 | 4038.8 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step4800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=15.6] | Loss=0.17446 | Reg=0.00363 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.057 | L2-Norm(final)=2.646 | 3282.1 samples/s | 51.3 steps/s
[Step=3250 Epoch=15.9] | Loss=0.07246 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.041 | L2-Norm(final)=2.626 | 3741.4 samples/s | 58.5 steps/s
[Step=3300 Epoch=16.1] | Loss=0.05734 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.037 | L2-Norm(final)=2.624 | 3781.1 samples/s | 59.1 steps/s
[Step=3350 Epoch=16.3] | Loss=0.05192 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.037 | L2-Norm(final)=2.625 | 3764.5 samples/s | 58.8 steps/s
[Step=3400 Epoch=16.6] | Loss=0.04888 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.037 | L2-Norm(final)=2.626 | 4712.9 samples/s | 73.6 steps/s
[Step=3450 Epoch=16.8] | Loss=0.04229 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.040 | L2-Norm(final)=2.629 | 1553.9 samples/s | 24.3 steps/s
[Step=3500 Epoch=17.1] | Loss=0.03878 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.044 | L2-Norm(final)=2.633 | 3803.0 samples/s | 59.4 steps/s
[Step=3550 Epoch=17.3] | Loss=0.03631 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.048 | L2-Norm(final)=2.638 | 3757.8 samples/s | 58.7 steps/s
[Step=3600 Epoch=17.6] | Loss=0.03479 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.643 | 4502.8 samples/s | 70.4 steps/s
[Step=3650 Epoch=17.8] | Loss=0.03248 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.059 | L2-Norm(final)=2.647 | 1580.2 samples/s | 24.7 steps/s
[Step=3700 Epoch=18.1] | Loss=0.03062 | Reg=0.00363 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.063 | L2-Norm(final)=2.651 | 3778.4 samples/s | 59.0 steps/s
[Step=3750 Epoch=18.3] | Loss=0.02917 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.068 | L2-Norm(final)=2.656 | 3793.2 samples/s | 59.3 steps/s
[Step=3800 Epoch=18.5] | Loss=0.02833 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.072 | L2-Norm(final)=2.660 | 4333.9 samples/s | 67.7 steps/s
[Step=3850 Epoch=18.8] | Loss=0.02698 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.076 | L2-Norm(final)=2.664 | 1588.4 samples/s | 24.8 steps/s
[Step=3900 Epoch=19.0] | Loss=0.02590 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.080 | L2-Norm(final)=2.668 | 3777.2 samples/s | 59.0 steps/s
[Step=3950 Epoch=19.3] | Loss=0.02494 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.083 | L2-Norm(final)=2.672 | 3788.2 samples/s | 59.2 steps/s
[Step=4000 Epoch=19.5] | Loss=0.02438 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.085 | L2-Norm(final)=2.676 | 4136.7 samples/s | 64.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step4000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.5] | Loss=0.24973 | Reg=0.00363 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.057 | L2-Norm(final)=2.645 | 3291.9 samples/s | 51.4 steps/s
[Step=4850 Epoch=23.8] | Loss=0.05621 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.043 | L2-Norm(final)=2.625 | 3764.3 samples/s | 58.8 steps/s
[Step=4900 Epoch=24.0] | Loss=0.04830 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9219 | L2-Norm=19.039 | L2-Norm(final)=2.626 | 3757.4 samples/s | 58.7 steps/s
[Step=4950 Epoch=24.3] | Loss=0.04524 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.040 | L2-Norm(final)=2.628 | 3778.7 samples/s | 59.0 steps/s
[Step=5000 Epoch=24.5] | Loss=0.04193 | Reg=0.00363 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.042 | L2-Norm(final)=2.630 | 4749.2 samples/s | 74.2 steps/s
[Step=5050 Epoch=24.8] | Loss=0.03822 | Reg=0.00363 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.044 | L2-Norm(final)=2.633 | 1531.3 samples/s | 23.9 steps/s
[Step=5100 Epoch=25.0] | Loss=0.03497 | Reg=0.00363 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.048 | L2-Norm(final)=2.637 | 3783.9 samples/s | 59.1 steps/s
[Step=5150 Epoch=25.3] | Loss=0.03303 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.642 | 3775.6 samples/s | 59.0 steps/s
[Step=5200 Epoch=25.5] | Loss=0.03139 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.058 | L2-Norm(final)=2.647 | 4586.7 samples/s | 71.7 steps/s
[Step=5250 Epoch=25.7] | Loss=0.02933 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.062 | L2-Norm(final)=2.652 | 1551.1 samples/s | 24.2 steps/s
[Step=5300 Epoch=26.0] | Loss=0.02759 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.067 | L2-Norm(final)=2.657 | 3790.5 samples/s | 59.2 steps/s
[Step=5350 Epoch=26.2] | Loss=0.02621 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.071 | L2-Norm(final)=2.663 | 3777.7 samples/s | 59.0 steps/s
[Step=5400 Epoch=26.5] | Loss=0.02514 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.075 | L2-Norm(final)=2.668 | 4441.6 samples/s | 69.4 steps/s
[Step=5450 Epoch=26.7] | Loss=0.02437 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.079 | L2-Norm(final)=2.672 | 1577.5 samples/s | 24.6 steps/s
[Step=5500 Epoch=27.0] | Loss=0.02346 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.082 | L2-Norm(final)=2.677 | 3778.1 samples/s | 59.0 steps/s
[Step=5550 Epoch=27.2] | Loss=0.02277 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.085 | L2-Norm(final)=2.681 | 3787.8 samples/s | 59.2 steps/s
[Step=5600 Epoch=27.5] | Loss=0.02243 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.088 | L2-Norm(final)=2.685 | 4276.9 samples/s | 66.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step5600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=45.8] | Loss=0.09600 | Reg=0.00363 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.057 | L2-Norm(final)=2.646 | 3426.7 samples/s | 53.5 steps/s
[Step=4850 Epoch=46.3] | Loss=0.01454 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.049 | L2-Norm(final)=2.636 | 3327.3 samples/s | 52.0 steps/s
[Step=4900 Epoch=46.8] | Loss=0.00853 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.043 | L2-Norm(final)=2.635 | 4594.7 samples/s | 71.8 steps/s
[Step=4950 Epoch=47.3] | Loss=0.00574 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.037 | L2-Norm(final)=2.638 | 1491.5 samples/s | 23.3 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00432 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.029 | L2-Norm(final)=2.641 | 4307.9 samples/s | 67.3 steps/s
[Step=5050 Epoch=48.2] | Loss=0.00347 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.023 | L2-Norm(final)=2.643 | 1531.8 samples/s | 23.9 steps/s
[Step=5100 Epoch=48.7] | Loss=0.00290 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.016 | L2-Norm(final)=2.644 | 4146.8 samples/s | 64.8 steps/s
[Step=5150 Epoch=49.2] | Loss=0.00249 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.011 | L2-Norm(final)=2.645 | 1554.0 samples/s | 24.3 steps/s
[Step=5200 Epoch=49.7] | Loss=0.00218 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.006 | L2-Norm(final)=2.647 | 3960.6 samples/s | 61.9 steps/s
[Step=5250 Epoch=50.1] | Loss=0.00195 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.001 | L2-Norm(final)=2.648 | 1558.0 samples/s | 24.3 steps/s
[Step=5300 Epoch=50.6] | Loss=0.00176 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.997 | L2-Norm(final)=2.649 | 3792.4 samples/s | 59.3 steps/s
[Step=5350 Epoch=51.1] | Loss=0.00160 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.993 | L2-Norm(final)=2.650 | 1593.5 samples/s | 24.9 steps/s
[Step=5400 Epoch=51.6] | Loss=0.00148 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.989 | L2-Norm(final)=2.651 | 3663.5 samples/s | 57.2 steps/s
[Step=5450 Epoch=52.0] | Loss=0.00137 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.986 | L2-Norm(final)=2.652 | 1638.5 samples/s | 25.6 steps/s
[Step=5500 Epoch=52.5] | Loss=0.00127 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.983 | L2-Norm(final)=2.653 | 3616.4 samples/s | 56.5 steps/s
[Step=5550 Epoch=53.0] | Loss=0.00119 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.980 | L2-Norm(final)=2.654 | 1637.9 samples/s | 25.6 steps/s
[Step=5600 Epoch=53.5] | Loss=0.00112 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.978 | L2-Norm(final)=2.655 | 3606.9 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step5600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=61.0] | Loss=0.22917 | Reg=0.00363 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.057 | L2-Norm(final)=2.644 | 3479.1 samples/s | 54.4 steps/s
[Step=6450 Epoch=61.5] | Loss=0.01705 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.056 | L2-Norm(final)=2.630 | 3215.8 samples/s | 50.2 steps/s
[Step=6500 Epoch=62.0] | Loss=0.00989 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.057 | L2-Norm(final)=2.632 | 4532.8 samples/s | 70.8 steps/s
[Step=6550 Epoch=62.4] | Loss=0.00676 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.054 | L2-Norm(final)=2.636 | 1487.8 samples/s | 23.2 steps/s
[Step=6600 Epoch=62.9] | Loss=0.00510 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.048 | L2-Norm(final)=2.639 | 4348.1 samples/s | 67.9 steps/s
[Step=6650 Epoch=63.4] | Loss=0.00409 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.042 | L2-Norm(final)=2.642 | 1518.4 samples/s | 23.7 steps/s
[Step=6700 Epoch=63.9] | Loss=0.00342 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.035 | L2-Norm(final)=2.643 | 4125.0 samples/s | 64.5 steps/s
[Step=6750 Epoch=64.3] | Loss=0.00293 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.030 | L2-Norm(final)=2.645 | 1532.7 samples/s | 23.9 steps/s
[Step=6800 Epoch=64.8] | Loss=0.00257 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.024 | L2-Norm(final)=2.646 | 3950.9 samples/s | 61.7 steps/s
[Step=6850 Epoch=65.3] | Loss=0.00229 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.019 | L2-Norm(final)=2.647 | 1572.0 samples/s | 24.6 steps/s
[Step=6900 Epoch=65.8] | Loss=0.00207 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.015 | L2-Norm(final)=2.648 | 3798.2 samples/s | 59.3 steps/s
[Step=6950 Epoch=66.2] | Loss=0.00188 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.011 | L2-Norm(final)=2.649 | 1595.8 samples/s | 24.9 steps/s
[Step=7000 Epoch=66.7] | Loss=0.00173 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.007 | L2-Norm(final)=2.650 | 3631.8 samples/s | 56.7 steps/s
[Step=7050 Epoch=67.2] | Loss=0.00160 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.003 | L2-Norm(final)=2.651 | 1606.1 samples/s | 25.1 steps/s
[Step=7100 Epoch=67.7] | Loss=0.00149 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.000 | L2-Norm(final)=2.652 | 3598.9 samples/s | 56.2 steps/s
[Step=7150 Epoch=68.1] | Loss=0.00139 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.996 | L2-Norm(final)=2.653 | 1630.6 samples/s | 25.5 steps/s
[Step=7200 Epoch=68.6] | Loss=0.00131 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.993 | L2-Norm(final)=2.654 | 3607.4 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34052 | acc=0.7604 | tpr=0.6611 | fpr=0.0240 | 3745.3 samples/s | 14.6 steps/s
Avg test loss: 0.34855, Avg test acc: 0.75924, Avg tpr: 0.66107, Avg fpr: 0.02487, total FA: 194

Testing server on iccad2012
[Step=  50] | Loss=0.35799 | acc=0.7886 | tpr=0.9823 | fpr=0.2149 | 3742.7 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.36237 | acc=0.7868 | tpr=0.9851 | fpr=0.2169 | 7264.0 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.36626 | acc=0.7842 | tpr=0.9885 | fpr=0.2196 | 7323.5 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.37034 | acc=0.7836 | tpr=0.9880 | fpr=0.2201 | 7462.2 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.37122 | acc=0.7830 | tpr=0.9886 | fpr=0.2208 | 7510.2 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.37142 | acc=0.7826 | tpr=0.9869 | fpr=0.2212 | 7224.3 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.37282 | acc=0.7823 | tpr=0.9862 | fpr=0.2214 | 7336.4 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.37412 | acc=0.7823 | tpr=0.9852 | fpr=0.2214 | 7492.4 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.37416 | acc=0.7827 | tpr=0.9839 | fpr=0.2210 | 7178.6 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.37485 | acc=0.7824 | tpr=0.9828 | fpr=0.2212 | 7271.9 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.37428 | acc=0.7825 | tpr=0.9829 | fpr=0.2211 | 13402.2 samples/s | 52.4 steps/s
Avg test loss: 0.37405, Avg test acc: 0.78257, Avg tpr: 0.98257, Avg fpr: 0.22106, total FA: 30694

server round 13/50

clients selected: [4 5 6 8 9]

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=27.5] | Loss=0.18040 | Reg=0.00362 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.020 | L2-Norm(final)=2.672 | 3264.8 samples/s | 51.0 steps/s
[Step=5650 Epoch=27.7] | Loss=0.05949 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.013 | L2-Norm(final)=2.651 | 3386.0 samples/s | 52.9 steps/s
[Step=5700 Epoch=28.0] | Loss=0.05173 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.012 | L2-Norm(final)=2.649 | 3147.0 samples/s | 49.2 steps/s
[Step=5750 Epoch=28.2] | Loss=0.04658 | Reg=0.00362 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.014 | L2-Norm(final)=2.650 | 3753.7 samples/s | 58.7 steps/s
[Step=5800 Epoch=28.4] | Loss=0.04297 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.016 | L2-Norm(final)=2.652 | 4383.6 samples/s | 68.5 steps/s
[Step=5850 Epoch=28.7] | Loss=0.03782 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.020 | L2-Norm(final)=2.656 | 1372.9 samples/s | 21.5 steps/s
[Step=5900 Epoch=28.9] | Loss=0.03481 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.024 | L2-Norm(final)=2.662 | 3295.4 samples/s | 51.5 steps/s
[Step=5950 Epoch=29.2] | Loss=0.03200 | Reg=0.00362 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.029 | L2-Norm(final)=2.667 | 3234.1 samples/s | 50.5 steps/s
[Step=6000 Epoch=29.4] | Loss=0.03065 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.033 | L2-Norm(final)=2.673 | 4375.0 samples/s | 68.4 steps/s
[Step=6050 Epoch=29.7] | Loss=0.02900 | Reg=0.00362 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.037 | L2-Norm(final)=2.677 | 1568.6 samples/s | 24.5 steps/s
[Step=6100 Epoch=29.9] | Loss=0.02736 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.681 | 3748.7 samples/s | 58.6 steps/s
[Step=6150 Epoch=30.2] | Loss=0.02605 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.043 | L2-Norm(final)=2.685 | 3784.1 samples/s | 59.1 steps/s
[Step=6200 Epoch=30.4] | Loss=0.02516 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.046 | L2-Norm(final)=2.689 | 4431.9 samples/s | 69.2 steps/s
[Step=6250 Epoch=30.6] | Loss=0.02422 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.049 | L2-Norm(final)=2.693 | 1581.7 samples/s | 24.7 steps/s
[Step=6300 Epoch=30.9] | Loss=0.02326 | Reg=0.00363 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.052 | L2-Norm(final)=2.696 | 3788.3 samples/s | 59.2 steps/s
[Step=6350 Epoch=31.1] | Loss=0.02215 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.054 | L2-Norm(final)=2.700 | 3775.6 samples/s | 59.0 steps/s
[Step=6400 Epoch=31.4] | Loss=0.02134 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.056 | L2-Norm(final)=2.704 | 4287.4 samples/s | 67.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step6400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=30.3] | Loss=0.08071 | Reg=0.00362 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=19.020 | L2-Norm(final)=2.673 | 3090.5 samples/s | 48.3 steps/s
[Step=3250 Epoch=30.8] | Loss=0.02281 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.012 | L2-Norm(final)=2.659 | 3668.9 samples/s | 57.3 steps/s
[Step=3300 Epoch=31.3] | Loss=0.01322 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.010 | L2-Norm(final)=2.653 | 4497.8 samples/s | 70.3 steps/s
[Step=3350 Epoch=31.7] | Loss=0.00903 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.006 | L2-Norm(final)=2.655 | 1489.1 samples/s | 23.3 steps/s
[Step=3400 Epoch=32.2] | Loss=0.00680 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.001 | L2-Norm(final)=2.658 | 4259.4 samples/s | 66.6 steps/s
[Step=3450 Epoch=32.7] | Loss=0.00545 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.996 | L2-Norm(final)=2.660 | 1517.0 samples/s | 23.7 steps/s
[Step=3500 Epoch=33.2] | Loss=0.00455 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.990 | L2-Norm(final)=2.662 | 4039.2 samples/s | 63.1 steps/s
[Step=3550 Epoch=33.6] | Loss=0.00391 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.985 | L2-Norm(final)=2.663 | 1549.0 samples/s | 24.2 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00343 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.980 | L2-Norm(final)=2.664 | 3824.2 samples/s | 59.8 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00305 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.976 | L2-Norm(final)=2.666 | 1587.4 samples/s | 24.8 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00276 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.972 | L2-Norm(final)=2.667 | 3633.7 samples/s | 56.8 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00251 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.968 | L2-Norm(final)=2.668 | 1638.6 samples/s | 25.6 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00231 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.965 | L2-Norm(final)=2.669 | 3612.8 samples/s | 56.5 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00213 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.961 | L2-Norm(final)=2.670 | 1625.1 samples/s | 25.4 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00198 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.958 | L2-Norm(final)=2.671 | 3625.0 samples/s | 56.6 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00185 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.955 | L2-Norm(final)=2.672 | 1650.6 samples/s | 25.8 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00174 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.953 | L2-Norm(final)=2.673 | 3564.3 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=38.1] | Loss=0.16265 | Reg=0.00362 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.020 | L2-Norm(final)=2.672 | 3266.7 samples/s | 51.0 steps/s
[Step=4050 Epoch=38.5] | Loss=0.01926 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.015 | L2-Norm(final)=2.649 | 3445.5 samples/s | 53.8 steps/s
[Step=4100 Epoch=39.0] | Loss=0.01101 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.009 | L2-Norm(final)=2.651 | 4537.3 samples/s | 70.9 steps/s
[Step=4150 Epoch=39.5] | Loss=0.00772 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.003 | L2-Norm(final)=2.655 | 1494.8 samples/s | 23.4 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00584 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.997 | L2-Norm(final)=2.658 | 4289.6 samples/s | 67.0 steps/s
[Step=4250 Epoch=40.4] | Loss=0.00470 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.991 | L2-Norm(final)=2.661 | 1532.9 samples/s | 24.0 steps/s
[Step=4300 Epoch=40.9] | Loss=0.00393 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.985 | L2-Norm(final)=2.663 | 4038.7 samples/s | 63.1 steps/s
[Step=4350 Epoch=41.4] | Loss=0.00338 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.980 | L2-Norm(final)=2.665 | 1556.5 samples/s | 24.3 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00297 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.975 | L2-Norm(final)=2.667 | 3825.1 samples/s | 59.8 steps/s
[Step=4450 Epoch=42.3] | Loss=0.00265 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.970 | L2-Norm(final)=2.669 | 1597.3 samples/s | 25.0 steps/s
[Step=4500 Epoch=42.8] | Loss=0.00239 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.966 | L2-Norm(final)=2.670 | 3680.2 samples/s | 57.5 steps/s
[Step=4550 Epoch=43.3] | Loss=0.00218 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.962 | L2-Norm(final)=2.672 | 1625.1 samples/s | 25.4 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00200 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.959 | L2-Norm(final)=2.673 | 3597.8 samples/s | 56.2 steps/s
[Step=4650 Epoch=44.2] | Loss=0.00185 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.956 | L2-Norm(final)=2.674 | 1640.5 samples/s | 25.6 steps/s
[Step=4700 Epoch=44.7] | Loss=0.00172 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.953 | L2-Norm(final)=2.676 | 3631.6 samples/s | 56.7 steps/s
[Step=4750 Epoch=45.2] | Loss=0.00161 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.950 | L2-Norm(final)=2.677 | 1629.1 samples/s | 25.5 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00152 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.947 | L2-Norm(final)=2.678 | 3572.8 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step4800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=67.9] | Loss=0.21323 | Reg=0.00362 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.020 | L2-Norm(final)=2.672 | 3264.4 samples/s | 51.0 steps/s
[Step=7250 Epoch=68.3] | Loss=0.02056 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.021 | L2-Norm(final)=2.656 | 3392.6 samples/s | 53.0 steps/s
[Step=7300 Epoch=68.8] | Loss=0.01156 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.017 | L2-Norm(final)=2.656 | 4487.9 samples/s | 70.1 steps/s
[Step=7350 Epoch=69.3] | Loss=0.00782 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.009 | L2-Norm(final)=2.658 | 1495.9 samples/s | 23.4 steps/s
[Step=7400 Epoch=69.7] | Loss=0.00590 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.002 | L2-Norm(final)=2.660 | 4191.4 samples/s | 65.5 steps/s
[Step=7450 Epoch=70.2] | Loss=0.00473 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.995 | L2-Norm(final)=2.662 | 1549.4 samples/s | 24.2 steps/s
[Step=7500 Epoch=70.7] | Loss=0.00396 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.989 | L2-Norm(final)=2.664 | 3935.7 samples/s | 61.5 steps/s
[Step=7550 Epoch=71.1] | Loss=0.00340 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.983 | L2-Norm(final)=2.665 | 1592.3 samples/s | 24.9 steps/s
[Step=7600 Epoch=71.6] | Loss=0.00298 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.978 | L2-Norm(final)=2.666 | 3696.4 samples/s | 57.8 steps/s
[Step=7650 Epoch=72.1] | Loss=0.00266 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.974 | L2-Norm(final)=2.668 | 1624.5 samples/s | 25.4 steps/s
[Step=7700 Epoch=72.6] | Loss=0.00240 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.969 | L2-Norm(final)=2.669 | 3580.6 samples/s | 55.9 steps/s
[Step=7750 Epoch=73.0] | Loss=0.00219 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.966 | L2-Norm(final)=2.670 | 1641.6 samples/s | 25.6 steps/s
[Step=7800 Epoch=73.5] | Loss=0.00201 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.962 | L2-Norm(final)=2.671 | 3607.1 samples/s | 56.4 steps/s
[Step=7850 Epoch=74.0] | Loss=0.00186 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.959 | L2-Norm(final)=2.672 | 1617.1 samples/s | 25.3 steps/s
[Step=7900 Epoch=74.4] | Loss=0.00173 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.956 | L2-Norm(final)=2.673 | 3646.0 samples/s | 57.0 steps/s
[Step=7950 Epoch=74.9] | Loss=0.00162 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.953 | L2-Norm(final)=2.674 | 1726.6 samples/s | 27.0 steps/s
[Step=8000 Epoch=75.4] | Loss=0.00152 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.950 | L2-Norm(final)=2.675 | 3253.9 samples/s | 50.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step8000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=68.6] | Loss=0.20309 | Reg=0.00362 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.020 | L2-Norm(final)=2.672 | 3220.0 samples/s | 50.3 steps/s
[Step=7250 Epoch=69.1] | Loss=0.02954 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.022 | L2-Norm(final)=2.642 | 3472.2 samples/s | 54.3 steps/s
[Step=7300 Epoch=69.6] | Loss=0.01552 | Reg=0.00362 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.035 | L2-Norm(final)=2.638 | 4543.9 samples/s | 71.0 steps/s
[Step=7350 Epoch=70.1] | Loss=0.01043 | Reg=0.00362 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.031 | L2-Norm(final)=2.641 | 1499.9 samples/s | 23.4 steps/s
[Step=7400 Epoch=70.5] | Loss=0.00785 | Reg=0.00362 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.024 | L2-Norm(final)=2.644 | 4343.0 samples/s | 67.9 steps/s
[Step=7450 Epoch=71.0] | Loss=0.00633 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.017 | L2-Norm(final)=2.646 | 1532.8 samples/s | 23.9 steps/s
[Step=7500 Epoch=71.5] | Loss=0.00528 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.011 | L2-Norm(final)=2.648 | 4096.0 samples/s | 64.0 steps/s
[Step=7550 Epoch=72.0] | Loss=0.00455 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.005 | L2-Norm(final)=2.650 | 1549.0 samples/s | 24.2 steps/s
[Step=7600 Epoch=72.4] | Loss=0.00399 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.999 | L2-Norm(final)=2.652 | 3969.0 samples/s | 62.0 steps/s
[Step=7650 Epoch=72.9] | Loss=0.00355 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.994 | L2-Norm(final)=2.654 | 1569.2 samples/s | 24.5 steps/s
[Step=7700 Epoch=73.4] | Loss=0.00320 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.990 | L2-Norm(final)=2.655 | 3796.8 samples/s | 59.3 steps/s
[Step=7750 Epoch=73.9] | Loss=0.00291 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.985 | L2-Norm(final)=2.657 | 1604.1 samples/s | 25.1 steps/s
[Step=7800 Epoch=74.3] | Loss=0.00268 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.981 | L2-Norm(final)=2.658 | 3622.8 samples/s | 56.6 steps/s
[Step=7850 Epoch=74.8] | Loss=0.00248 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.977 | L2-Norm(final)=2.660 | 1634.6 samples/s | 25.5 steps/s
[Step=7900 Epoch=75.3] | Loss=0.00230 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.974 | L2-Norm(final)=2.661 | 3598.2 samples/s | 56.2 steps/s
[Step=7950 Epoch=75.8] | Loss=0.00215 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.970 | L2-Norm(final)=2.662 | 1639.3 samples/s | 25.6 steps/s
[Step=8000 Epoch=76.2] | Loss=0.00202 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.967 | L2-Norm(final)=2.664 | 3568.1 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33141 | acc=0.7740 | tpr=0.6786 | fpr=0.0188 | 3713.7 samples/s | 14.5 steps/s
Avg test loss: 0.33946, Avg test acc: 0.77170, Avg tpr: 0.67704, Avg fpr: 0.02013, total FA: 157

Testing server on iccad2012
[Step=  50] | Loss=0.36179 | acc=0.7889 | tpr=0.9779 | fpr=0.2145 | 3746.7 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.36489 | acc=0.7881 | tpr=0.9829 | fpr=0.2156 | 7279.2 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.36902 | acc=0.7855 | tpr=0.9827 | fpr=0.2181 | 7357.0 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.37329 | acc=0.7848 | tpr=0.9814 | fpr=0.2188 | 7345.2 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.37442 | acc=0.7842 | tpr=0.9817 | fpr=0.2194 | 7298.9 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.37465 | acc=0.7836 | tpr=0.9818 | fpr=0.2200 | 7268.7 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.37589 | acc=0.7832 | tpr=0.9806 | fpr=0.2204 | 7570.3 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.37701 | acc=0.7835 | tpr=0.9792 | fpr=0.2201 | 7167.8 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.37694 | acc=0.7839 | tpr=0.9776 | fpr=0.2196 | 7257.3 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.37780 | acc=0.7837 | tpr=0.9771 | fpr=0.2198 | 7346.2 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.37730 | acc=0.7840 | tpr=0.9765 | fpr=0.2195 | 13228.3 samples/s | 51.7 steps/s
Avg test loss: 0.37706, Avg test acc: 0.78407, Avg tpr: 0.97623, Avg fpr: 0.21943, total FA: 30467

server round 14/50

clients selected: [1 2 6 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=19.5] | Loss=0.27260 | Reg=0.00361 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=18.988 | L2-Norm(final)=2.712 | 3391.6 samples/s | 53.0 steps/s
[Step=4050 Epoch=19.8] | Loss=0.05828 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=18.978 | L2-Norm(final)=2.696 | 3543.9 samples/s | 55.4 steps/s
[Step=4100 Epoch=20.0] | Loss=0.05245 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.973 | L2-Norm(final)=2.691 | 3778.0 samples/s | 59.0 steps/s
[Step=4150 Epoch=20.3] | Loss=0.04811 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.973 | L2-Norm(final)=2.690 | 3786.5 samples/s | 59.2 steps/s
[Step=4200 Epoch=20.5] | Loss=0.04443 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=18.975 | L2-Norm(final)=2.691 | 4708.7 samples/s | 73.6 steps/s
[Step=4250 Epoch=20.7] | Loss=0.03910 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.978 | L2-Norm(final)=2.693 | 1542.5 samples/s | 24.1 steps/s
[Step=4300 Epoch=21.0] | Loss=0.03515 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.982 | L2-Norm(final)=2.697 | 3756.3 samples/s | 58.7 steps/s
[Step=4350 Epoch=21.2] | Loss=0.03254 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.985 | L2-Norm(final)=2.702 | 3781.8 samples/s | 59.1 steps/s
[Step=4400 Epoch=21.5] | Loss=0.03070 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.989 | L2-Norm(final)=2.707 | 4498.1 samples/s | 70.3 steps/s
[Step=4450 Epoch=21.7] | Loss=0.02909 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.992 | L2-Norm(final)=2.710 | 1577.1 samples/s | 24.6 steps/s
[Step=4500 Epoch=22.0] | Loss=0.02748 | Reg=0.00361 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.994 | L2-Norm(final)=2.714 | 3767.8 samples/s | 58.9 steps/s
[Step=4550 Epoch=22.2] | Loss=0.02631 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.997 | L2-Norm(final)=2.718 | 3778.5 samples/s | 59.0 steps/s
[Step=4600 Epoch=22.4] | Loss=0.02524 | Reg=0.00361 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.999 | L2-Norm(final)=2.721 | 4318.9 samples/s | 67.5 steps/s
[Step=4650 Epoch=22.7] | Loss=0.02427 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.001 | L2-Norm(final)=2.724 | 1584.9 samples/s | 24.8 steps/s
[Step=4700 Epoch=22.9] | Loss=0.02310 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.003 | L2-Norm(final)=2.727 | 3795.2 samples/s | 59.3 steps/s
[Step=4750 Epoch=23.2] | Loss=0.02231 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.005 | L2-Norm(final)=2.730 | 3748.8 samples/s | 58.6 steps/s
[Step=4800 Epoch=23.4] | Loss=0.02159 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.733 | 4142.3 samples/s | 64.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step4800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.13880 | Reg=0.00361 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.988 | L2-Norm(final)=2.712 | 3346.0 samples/s | 52.3 steps/s
[Step=5650 Epoch=27.5] | Loss=0.05957 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.970 | L2-Norm(final)=2.690 | 3608.5 samples/s | 56.4 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04991 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=18.967 | L2-Norm(final)=2.684 | 3781.0 samples/s | 59.1 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04428 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.971 | L2-Norm(final)=2.685 | 3752.7 samples/s | 58.6 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04041 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.975 | L2-Norm(final)=2.688 | 4701.2 samples/s | 73.5 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03640 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.980 | L2-Norm(final)=2.692 | 1556.2 samples/s | 24.3 steps/s
[Step=5900 Epoch=28.7] | Loss=0.03276 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.985 | L2-Norm(final)=2.697 | 3761.8 samples/s | 58.8 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03028 | Reg=0.00361 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.989 | L2-Norm(final)=2.703 | 3790.0 samples/s | 59.2 steps/s
[Step=6000 Epoch=29.2] | Loss=0.02880 | Reg=0.00361 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.993 | L2-Norm(final)=2.709 | 4450.2 samples/s | 69.5 steps/s
[Step=6050 Epoch=29.5] | Loss=0.02700 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.997 | L2-Norm(final)=2.713 | 1564.9 samples/s | 24.5 steps/s
[Step=6100 Epoch=29.7] | Loss=0.02527 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.001 | L2-Norm(final)=2.718 | 3775.2 samples/s | 59.0 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02430 | Reg=0.00361 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.004 | L2-Norm(final)=2.723 | 3775.3 samples/s | 59.0 steps/s
[Step=6200 Epoch=30.2] | Loss=0.02367 | Reg=0.00361 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.007 | L2-Norm(final)=2.727 | 4232.4 samples/s | 66.1 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02284 | Reg=0.00361 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.010 | L2-Norm(final)=2.731 | 1606.6 samples/s | 25.1 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02213 | Reg=0.00361 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.013 | L2-Norm(final)=2.735 | 3774.7 samples/s | 59.0 steps/s
[Step=6350 Epoch=30.9] | Loss=0.02153 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.015 | L2-Norm(final)=2.738 | 3780.5 samples/s | 59.1 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02099 | Reg=0.00362 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.018 | L2-Norm(final)=2.742 | 4034.0 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step6400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=45.7] | Loss=0.26477 | Reg=0.00361 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.988 | L2-Norm(final)=2.711 | 3114.6 samples/s | 48.7 steps/s
[Step=4850 Epoch=46.1] | Loss=0.02246 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.999 | L2-Norm(final)=2.692 | 3584.8 samples/s | 56.0 steps/s
[Step=4900 Epoch=46.6] | Loss=0.01293 | Reg=0.00361 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.998 | L2-Norm(final)=2.695 | 4531.9 samples/s | 70.8 steps/s
[Step=4950 Epoch=47.1] | Loss=0.00924 | Reg=0.00361 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.997 | L2-Norm(final)=2.698 | 1504.3 samples/s | 23.5 steps/s
[Step=5000 Epoch=47.6] | Loss=0.00702 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.993 | L2-Norm(final)=2.701 | 4284.6 samples/s | 66.9 steps/s
[Step=5050 Epoch=48.0] | Loss=0.00563 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.988 | L2-Norm(final)=2.704 | 1542.0 samples/s | 24.1 steps/s
[Step=5100 Epoch=48.5] | Loss=0.00471 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.982 | L2-Norm(final)=2.707 | 4054.2 samples/s | 63.3 steps/s
[Step=5150 Epoch=49.0] | Loss=0.00405 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.977 | L2-Norm(final)=2.708 | 1560.0 samples/s | 24.4 steps/s
[Step=5200 Epoch=49.5] | Loss=0.00355 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.972 | L2-Norm(final)=2.710 | 3808.1 samples/s | 59.5 steps/s
[Step=5250 Epoch=49.9] | Loss=0.00316 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.967 | L2-Norm(final)=2.712 | 1599.5 samples/s | 25.0 steps/s
[Step=5300 Epoch=50.4] | Loss=0.00285 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.962 | L2-Norm(final)=2.713 | 3659.7 samples/s | 57.2 steps/s
[Step=5350 Epoch=50.9] | Loss=0.00260 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.958 | L2-Norm(final)=2.714 | 1632.4 samples/s | 25.5 steps/s
[Step=5400 Epoch=51.4] | Loss=0.00239 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.954 | L2-Norm(final)=2.716 | 3596.7 samples/s | 56.2 steps/s
[Step=5450 Epoch=51.8] | Loss=0.00221 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.950 | L2-Norm(final)=2.717 | 1649.0 samples/s | 25.8 steps/s
[Step=5500 Epoch=52.3] | Loss=0.00205 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.946 | L2-Norm(final)=2.718 | 3576.9 samples/s | 55.9 steps/s
[Step=5550 Epoch=52.8] | Loss=0.00192 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.943 | L2-Norm(final)=2.719 | 1653.0 samples/s | 25.8 steps/s
[Step=5600 Epoch=53.3] | Loss=0.00180 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.940 | L2-Norm(final)=2.720 | 3555.5 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step5600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=75.4] | Loss=0.17742 | Reg=0.00361 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.988 | L2-Norm(final)=2.711 | 3205.2 samples/s | 50.1 steps/s
[Step=8050 Epoch=75.9] | Loss=0.02650 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.976 | L2-Norm(final)=2.681 | 3497.5 samples/s | 54.6 steps/s
[Step=8100 Epoch=76.3] | Loss=0.01491 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.978 | L2-Norm(final)=2.676 | 4497.6 samples/s | 70.3 steps/s
[Step=8150 Epoch=76.8] | Loss=0.01033 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.974 | L2-Norm(final)=2.677 | 1512.7 samples/s | 23.6 steps/s
[Step=8200 Epoch=77.3] | Loss=0.00780 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.969 | L2-Norm(final)=2.679 | 4193.8 samples/s | 65.5 steps/s
[Step=8250 Epoch=77.7] | Loss=0.00627 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.964 | L2-Norm(final)=2.681 | 1532.6 samples/s | 23.9 steps/s
[Step=8300 Epoch=78.2] | Loss=0.00523 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.959 | L2-Norm(final)=2.683 | 3938.8 samples/s | 61.5 steps/s
[Step=8350 Epoch=78.7] | Loss=0.00450 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.954 | L2-Norm(final)=2.685 | 1576.0 samples/s | 24.6 steps/s
[Step=8400 Epoch=79.2] | Loss=0.00395 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.950 | L2-Norm(final)=2.686 | 3717.5 samples/s | 58.1 steps/s
[Step=8450 Epoch=79.6] | Loss=0.00351 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.946 | L2-Norm(final)=2.688 | 1615.7 samples/s | 25.2 steps/s
[Step=8500 Epoch=80.1] | Loss=0.00317 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.942 | L2-Norm(final)=2.690 | 3584.2 samples/s | 56.0 steps/s
[Step=8550 Epoch=80.6] | Loss=0.00289 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.938 | L2-Norm(final)=2.691 | 1631.6 samples/s | 25.5 steps/s
[Step=8600 Epoch=81.0] | Loss=0.00265 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.935 | L2-Norm(final)=2.693 | 3633.9 samples/s | 56.8 steps/s
[Step=8650 Epoch=81.5] | Loss=0.00245 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.932 | L2-Norm(final)=2.694 | 1636.9 samples/s | 25.6 steps/s
[Step=8700 Epoch=82.0] | Loss=0.00228 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.929 | L2-Norm(final)=2.696 | 3551.6 samples/s | 55.5 steps/s
[Step=8750 Epoch=82.4] | Loss=0.00213 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.926 | L2-Norm(final)=2.697 | 1735.9 samples/s | 27.1 steps/s
[Step=8800 Epoch=82.9] | Loss=0.00200 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.923 | L2-Norm(final)=2.698 | 3281.4 samples/s | 51.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step8800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=76.3] | Loss=0.16512 | Reg=0.00361 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.988 | L2-Norm(final)=2.712 | 3191.4 samples/s | 49.9 steps/s
[Step=8050 Epoch=76.7] | Loss=0.01565 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.990 | L2-Norm(final)=2.696 | 3444.7 samples/s | 53.8 steps/s
[Step=8100 Epoch=77.2] | Loss=0.00853 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.984 | L2-Norm(final)=2.700 | 4572.2 samples/s | 71.4 steps/s
[Step=8150 Epoch=77.7] | Loss=0.00576 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.976 | L2-Norm(final)=2.703 | 1488.5 samples/s | 23.3 steps/s
[Step=8200 Epoch=78.2] | Loss=0.00437 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.968 | L2-Norm(final)=2.706 | 4295.4 samples/s | 67.1 steps/s
[Step=8250 Epoch=78.6] | Loss=0.00351 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.961 | L2-Norm(final)=2.708 | 1519.6 samples/s | 23.7 steps/s
[Step=8300 Epoch=79.1] | Loss=0.00293 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.955 | L2-Norm(final)=2.710 | 4111.0 samples/s | 64.2 steps/s
[Step=8350 Epoch=79.6] | Loss=0.00252 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.949 | L2-Norm(final)=2.711 | 1542.9 samples/s | 24.1 steps/s
[Step=8400 Epoch=80.1] | Loss=0.00221 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.943 | L2-Norm(final)=2.713 | 3956.4 samples/s | 61.8 steps/s
[Step=8450 Epoch=80.5] | Loss=0.00197 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.938 | L2-Norm(final)=2.714 | 1566.1 samples/s | 24.5 steps/s
[Step=8500 Epoch=81.0] | Loss=0.00178 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.934 | L2-Norm(final)=2.715 | 3785.5 samples/s | 59.1 steps/s
[Step=8550 Epoch=81.5] | Loss=0.00162 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.929 | L2-Norm(final)=2.716 | 1597.0 samples/s | 25.0 steps/s
[Step=8600 Epoch=82.0] | Loss=0.00149 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.925 | L2-Norm(final)=2.717 | 3639.9 samples/s | 56.9 steps/s
[Step=8650 Epoch=82.4] | Loss=0.00138 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.922 | L2-Norm(final)=2.717 | 1598.0 samples/s | 25.0 steps/s
[Step=8700 Epoch=82.9] | Loss=0.00128 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.918 | L2-Norm(final)=2.718 | 3592.3 samples/s | 56.1 steps/s
[Step=8750 Epoch=83.4] | Loss=0.00120 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.915 | L2-Norm(final)=2.719 | 1628.6 samples/s | 25.4 steps/s
[Step=8800 Epoch=83.9] | Loss=0.00113 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.912 | L2-Norm(final)=2.720 | 3627.9 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31643 | acc=0.7825 | tpr=0.6917 | fpr=0.0203 | 3731.8 samples/s | 14.6 steps/s
Avg test loss: 0.32496, Avg test acc: 0.78091, Avg tpr: 0.69155, Avg fpr: 0.02256, total FA: 176

Testing server on iccad2012
[Step=  50] | Loss=0.37403 | acc=0.7891 | tpr=0.9867 | fpr=0.2144 | 3820.4 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.37780 | acc=0.7874 | tpr=0.9872 | fpr=0.2163 | 7000.9 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.38219 | acc=0.7858 | tpr=0.9870 | fpr=0.2179 | 7472.2 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.38687 | acc=0.7845 | tpr=0.9847 | fpr=0.2191 | 7421.6 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.38767 | acc=0.7842 | tpr=0.9843 | fpr=0.2194 | 7253.2 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.38800 | acc=0.7836 | tpr=0.9840 | fpr=0.2201 | 7734.1 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.38939 | acc=0.7829 | tpr=0.9837 | fpr=0.2207 | 7175.0 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.39058 | acc=0.7830 | tpr=0.9830 | fpr=0.2206 | 7548.0 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.39053 | acc=0.7833 | tpr=0.9820 | fpr=0.2203 | 7026.8 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.39134 | acc=0.7829 | tpr=0.9815 | fpr=0.2207 | 7075.0 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.39079 | acc=0.7830 | tpr=0.9813 | fpr=0.2206 | 13975.4 samples/s | 54.6 steps/s
Avg test loss: 0.39054, Avg test acc: 0.78301, Avg tpr: 0.98098, Avg fpr: 0.22059, total FA: 30629

server round 15/50

clients selected: [1 2 4 5 6]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.06450 | Reg=0.00359 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.959 | L2-Norm(final)=2.736 | 3388.2 samples/s | 52.9 steps/s
[Step=4850 Epoch=23.7] | Loss=0.06606 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.943 | L2-Norm(final)=2.711 | 3570.4 samples/s | 55.8 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05651 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.938 | L2-Norm(final)=2.699 | 3770.7 samples/s | 58.9 steps/s
[Step=4950 Epoch=24.2] | Loss=0.04882 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.938 | L2-Norm(final)=2.697 | 3772.6 samples/s | 58.9 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04513 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.939 | L2-Norm(final)=2.699 | 4721.9 samples/s | 73.8 steps/s
[Step=5050 Epoch=24.6] | Loss=0.03942 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.942 | L2-Norm(final)=2.702 | 1546.6 samples/s | 24.2 steps/s
[Step=5100 Epoch=24.9] | Loss=0.03557 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.946 | L2-Norm(final)=2.707 | 3746.8 samples/s | 58.5 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03258 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.950 | L2-Norm(final)=2.713 | 3763.4 samples/s | 58.8 steps/s
[Step=5200 Epoch=25.4] | Loss=0.03111 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.953 | L2-Norm(final)=2.718 | 4501.5 samples/s | 70.3 steps/s
[Step=5250 Epoch=25.6] | Loss=0.02913 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.957 | L2-Norm(final)=2.722 | 1571.2 samples/s | 24.5 steps/s
[Step=5300 Epoch=25.9] | Loss=0.02753 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.960 | L2-Norm(final)=2.726 | 3748.0 samples/s | 58.6 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02630 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.963 | L2-Norm(final)=2.730 | 3780.2 samples/s | 59.1 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02513 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.966 | L2-Norm(final)=2.734 | 4297.1 samples/s | 67.1 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02425 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.969 | L2-Norm(final)=2.738 | 1579.3 samples/s | 24.7 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02317 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.971 | L2-Norm(final)=2.742 | 3782.1 samples/s | 59.1 steps/s
[Step=5550 Epoch=27.1] | Loss=0.02227 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.973 | L2-Norm(final)=2.746 | 3788.2 samples/s | 59.2 steps/s
[Step=5600 Epoch=27.3] | Loss=0.02183 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=18.976 | L2-Norm(final)=2.749 | 4164.4 samples/s | 65.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step5600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=31.2] | Loss=0.18107 | Reg=0.00359 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.959 | L2-Norm(final)=2.735 | 3400.0 samples/s | 53.1 steps/s
[Step=6450 Epoch=31.4] | Loss=0.05350 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.934 | L2-Norm(final)=2.713 | 3539.3 samples/s | 55.3 steps/s
[Step=6500 Epoch=31.7] | Loss=0.04540 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.931 | L2-Norm(final)=2.710 | 3779.8 samples/s | 59.1 steps/s
[Step=6550 Epoch=31.9] | Loss=0.04343 | Reg=0.00358 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.930 | L2-Norm(final)=2.708 | 3758.5 samples/s | 58.7 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04023 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.933 | L2-Norm(final)=2.708 | 4706.4 samples/s | 73.5 steps/s
[Step=6650 Epoch=32.4] | Loss=0.03526 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.936 | L2-Norm(final)=2.710 | 1545.5 samples/s | 24.1 steps/s
[Step=6700 Epoch=32.6] | Loss=0.03188 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.941 | L2-Norm(final)=2.715 | 3748.6 samples/s | 58.6 steps/s
[Step=6750 Epoch=32.9] | Loss=0.02985 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.945 | L2-Norm(final)=2.720 | 3781.5 samples/s | 59.1 steps/s
[Step=6800 Epoch=33.1] | Loss=0.02835 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.950 | L2-Norm(final)=2.725 | 4459.1 samples/s | 69.7 steps/s
[Step=6850 Epoch=33.4] | Loss=0.02661 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.954 | L2-Norm(final)=2.730 | 1582.1 samples/s | 24.7 steps/s
[Step=6900 Epoch=33.6] | Loss=0.02527 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.958 | L2-Norm(final)=2.734 | 3784.4 samples/s | 59.1 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02415 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.961 | L2-Norm(final)=2.738 | 3774.0 samples/s | 59.0 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02321 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.964 | L2-Norm(final)=2.742 | 4241.0 samples/s | 66.3 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02244 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.967 | L2-Norm(final)=2.745 | 1591.8 samples/s | 24.9 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02148 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.970 | L2-Norm(final)=2.749 | 3796.0 samples/s | 59.3 steps/s
[Step=7150 Epoch=34.8] | Loss=0.02082 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.972 | L2-Norm(final)=2.752 | 3793.9 samples/s | 59.3 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02045 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.975 | L2-Norm(final)=2.756 | 4024.4 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step7200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=31.4] | Loss=0.22096 | Reg=0.00359 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.959 | L2-Norm(final)=2.735 | 3396.7 samples/s | 53.1 steps/s
[Step=6450 Epoch=31.6] | Loss=0.06141 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9219 | L2-Norm=18.936 | L2-Norm(final)=2.709 | 3615.7 samples/s | 56.5 steps/s
[Step=6500 Epoch=31.9] | Loss=0.05109 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.934 | L2-Norm(final)=2.702 | 3762.9 samples/s | 58.8 steps/s
[Step=6550 Epoch=32.1] | Loss=0.04436 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.936 | L2-Norm(final)=2.702 | 3789.5 samples/s | 59.2 steps/s
[Step=6600 Epoch=32.4] | Loss=0.04030 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=18.939 | L2-Norm(final)=2.704 | 4764.0 samples/s | 74.4 steps/s
[Step=6650 Epoch=32.6] | Loss=0.03569 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.944 | L2-Norm(final)=2.707 | 1535.9 samples/s | 24.0 steps/s
[Step=6700 Epoch=32.9] | Loss=0.03248 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.948 | L2-Norm(final)=2.711 | 3764.3 samples/s | 58.8 steps/s
[Step=6750 Epoch=33.1] | Loss=0.03018 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.952 | L2-Norm(final)=2.715 | 3787.1 samples/s | 59.2 steps/s
[Step=6800 Epoch=33.3] | Loss=0.02843 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.955 | L2-Norm(final)=2.719 | 4572.4 samples/s | 71.4 steps/s
[Step=6850 Epoch=33.6] | Loss=0.02670 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.959 | L2-Norm(final)=2.724 | 1552.5 samples/s | 24.3 steps/s
[Step=6900 Epoch=33.8] | Loss=0.02484 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.962 | L2-Norm(final)=2.729 | 3770.0 samples/s | 58.9 steps/s
[Step=6950 Epoch=34.1] | Loss=0.02384 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.965 | L2-Norm(final)=2.733 | 3795.5 samples/s | 59.3 steps/s
[Step=7000 Epoch=34.3] | Loss=0.02301 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.968 | L2-Norm(final)=2.737 | 4423.2 samples/s | 69.1 steps/s
[Step=7050 Epoch=34.6] | Loss=0.02205 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.970 | L2-Norm(final)=2.741 | 1575.9 samples/s | 24.6 steps/s
[Step=7100 Epoch=34.8] | Loss=0.02131 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.973 | L2-Norm(final)=2.745 | 3782.0 samples/s | 59.1 steps/s
[Step=7150 Epoch=35.1] | Loss=0.02063 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.975 | L2-Norm(final)=2.748 | 3791.7 samples/s | 59.2 steps/s
[Step=7200 Epoch=35.3] | Loss=0.01999 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.977 | L2-Norm(final)=2.751 | 4281.1 samples/s | 66.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step7200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=37.9] | Loss=0.12080 | Reg=0.00359 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.959 | L2-Norm(final)=2.735 | 3174.5 samples/s | 49.6 steps/s
[Step=4050 Epoch=38.4] | Loss=0.01271 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.967 | L2-Norm(final)=2.727 | 3597.4 samples/s | 56.2 steps/s
[Step=4100 Epoch=38.9] | Loss=0.00813 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.964 | L2-Norm(final)=2.727 | 4518.0 samples/s | 70.6 steps/s
[Step=4150 Epoch=39.3] | Loss=0.00573 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.959 | L2-Norm(final)=2.729 | 1504.9 samples/s | 23.5 steps/s
[Step=4200 Epoch=39.8] | Loss=0.00447 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.954 | L2-Norm(final)=2.732 | 4296.2 samples/s | 67.1 steps/s
[Step=4250 Epoch=40.3] | Loss=0.00359 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.948 | L2-Norm(final)=2.734 | 1526.7 samples/s | 23.9 steps/s
[Step=4300 Epoch=40.7] | Loss=0.00300 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.942 | L2-Norm(final)=2.735 | 4040.0 samples/s | 63.1 steps/s
[Step=4350 Epoch=41.2] | Loss=0.00257 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.937 | L2-Norm(final)=2.737 | 1570.7 samples/s | 24.5 steps/s
[Step=4400 Epoch=41.7] | Loss=0.00226 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.931 | L2-Norm(final)=2.738 | 3846.3 samples/s | 60.1 steps/s
[Step=4450 Epoch=42.2] | Loss=0.00201 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.926 | L2-Norm(final)=2.739 | 1607.4 samples/s | 25.1 steps/s
[Step=4500 Epoch=42.6] | Loss=0.00181 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.921 | L2-Norm(final)=2.740 | 3660.6 samples/s | 57.2 steps/s
[Step=4550 Epoch=43.1] | Loss=0.00165 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.917 | L2-Norm(final)=2.741 | 1625.2 samples/s | 25.4 steps/s
[Step=4600 Epoch=43.6] | Loss=0.00152 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.913 | L2-Norm(final)=2.741 | 3624.2 samples/s | 56.6 steps/s
[Step=4650 Epoch=44.1] | Loss=0.00140 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.909 | L2-Norm(final)=2.742 | 1626.4 samples/s | 25.4 steps/s
[Step=4700 Epoch=44.5] | Loss=0.00131 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.905 | L2-Norm(final)=2.743 | 3589.3 samples/s | 56.1 steps/s
[Step=4750 Epoch=45.0] | Loss=0.00122 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.902 | L2-Norm(final)=2.744 | 1641.1 samples/s | 25.6 steps/s
[Step=4800 Epoch=45.5] | Loss=0.00115 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.899 | L2-Norm(final)=2.744 | 3597.1 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step4800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=53.3] | Loss=0.11584 | Reg=0.00359 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.959 | L2-Norm(final)=2.735 | 3367.5 samples/s | 52.6 steps/s
[Step=5650 Epoch=53.7] | Loss=0.02104 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.947 | L2-Norm(final)=2.712 | 3376.2 samples/s | 52.8 steps/s
[Step=5700 Epoch=54.2] | Loss=0.01164 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.951 | L2-Norm(final)=2.711 | 4527.9 samples/s | 70.7 steps/s
[Step=5750 Epoch=54.7] | Loss=0.00787 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.949 | L2-Norm(final)=2.715 | 1495.1 samples/s | 23.4 steps/s
[Step=5800 Epoch=55.2] | Loss=0.00594 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.945 | L2-Norm(final)=2.718 | 4287.4 samples/s | 67.0 steps/s
[Step=5850 Epoch=55.6] | Loss=0.00476 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.940 | L2-Norm(final)=2.721 | 1536.6 samples/s | 24.0 steps/s
[Step=5900 Epoch=56.1] | Loss=0.00398 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.934 | L2-Norm(final)=2.723 | 4043.8 samples/s | 63.2 steps/s
[Step=5950 Epoch=56.6] | Loss=0.00342 | Reg=0.00358 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.929 | L2-Norm(final)=2.725 | 1570.1 samples/s | 24.5 steps/s
[Step=6000 Epoch=57.1] | Loss=0.00300 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.925 | L2-Norm(final)=2.727 | 3844.4 samples/s | 60.1 steps/s
[Step=6050 Epoch=57.6] | Loss=0.00267 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.920 | L2-Norm(final)=2.729 | 1590.8 samples/s | 24.9 steps/s
[Step=6100 Epoch=58.0] | Loss=0.00241 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.916 | L2-Norm(final)=2.730 | 3674.7 samples/s | 57.4 steps/s
[Step=6150 Epoch=58.5] | Loss=0.00220 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.912 | L2-Norm(final)=2.731 | 1611.0 samples/s | 25.2 steps/s
[Step=6200 Epoch=59.0] | Loss=0.00202 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.908 | L2-Norm(final)=2.733 | 3600.8 samples/s | 56.3 steps/s
[Step=6250 Epoch=59.5] | Loss=0.00187 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.905 | L2-Norm(final)=2.734 | 1631.6 samples/s | 25.5 steps/s
[Step=6300 Epoch=59.9] | Loss=0.00174 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.902 | L2-Norm(final)=2.735 | 3574.2 samples/s | 55.8 steps/s
[Step=6350 Epoch=60.4] | Loss=0.00162 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.899 | L2-Norm(final)=2.736 | 1655.8 samples/s | 25.9 steps/s
[Step=6400 Epoch=60.9] | Loss=0.00152 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.896 | L2-Norm(final)=2.737 | 3622.6 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30440 | acc=0.7934 | tpr=0.7072 | fpr=0.0196 | 3708.1 samples/s | 14.5 steps/s
Avg test loss: 0.31266, Avg test acc: 0.79097, Avg tpr: 0.70595, Avg fpr: 0.02205, total FA: 172

Testing server on iccad2012
[Step=  50] | Loss=0.38471 | acc=0.7866 | tpr=0.9823 | fpr=0.2170 | 3716.3 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.38891 | acc=0.7836 | tpr=0.9872 | fpr=0.2202 | 7433.2 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.39351 | acc=0.7816 | tpr=0.9885 | fpr=0.2222 | 7425.2 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.39792 | acc=0.7802 | tpr=0.9858 | fpr=0.2235 | 7521.6 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.39876 | acc=0.7801 | tpr=0.9860 | fpr=0.2237 | 7310.8 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.39908 | acc=0.7801 | tpr=0.9869 | fpr=0.2237 | 7306.4 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.40060 | acc=0.7795 | tpr=0.9856 | fpr=0.2243 | 7647.2 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.40182 | acc=0.7795 | tpr=0.9847 | fpr=0.2242 | 7280.2 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.40168 | acc=0.7797 | tpr=0.9834 | fpr=0.2240 | 7232.3 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.40259 | acc=0.7795 | tpr=0.9833 | fpr=0.2242 | 7460.0 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.40216 | acc=0.7797 | tpr=0.9825 | fpr=0.2240 | 12913.2 samples/s | 50.4 steps/s
Avg test loss: 0.40187, Avg test acc: 0.77974, Avg tpr: 0.98217, Avg fpr: 0.22394, total FA: 31094

server round 16/50

clients selected: [2 3 4 7 8]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=35.1] | Loss=0.30267 | Reg=0.00358 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=18.933 | L2-Norm(final)=2.750 | 3336.3 samples/s | 52.1 steps/s
[Step=7250 Epoch=35.3] | Loss=0.06729 | Reg=0.00358 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.914 | L2-Norm(final)=2.716 | 3592.5 samples/s | 56.1 steps/s
[Step=7300 Epoch=35.6] | Loss=0.05144 | Reg=0.00358 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.910 | L2-Norm(final)=2.711 | 3776.3 samples/s | 59.0 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04379 | Reg=0.00358 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.912 | L2-Norm(final)=2.713 | 3782.7 samples/s | 59.1 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04113 | Reg=0.00358 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.915 | L2-Norm(final)=2.716 | 4705.4 samples/s | 73.5 steps/s
[Step=7450 Epoch=36.3] | Loss=0.03791 | Reg=0.00358 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.919 | L2-Norm(final)=2.717 | 1553.9 samples/s | 24.3 steps/s
[Step=7500 Epoch=36.5] | Loss=0.03453 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.923 | L2-Norm(final)=2.720 | 3756.8 samples/s | 58.7 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03168 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.926 | L2-Norm(final)=2.724 | 3775.0 samples/s | 59.0 steps/s
[Step=7600 Epoch=37.0] | Loss=0.02975 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.930 | L2-Norm(final)=2.728 | 4450.9 samples/s | 69.5 steps/s
[Step=7650 Epoch=37.3] | Loss=0.02758 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.934 | L2-Norm(final)=2.733 | 1578.0 samples/s | 24.7 steps/s
[Step=7700 Epoch=37.5] | Loss=0.02637 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.937 | L2-Norm(final)=2.738 | 3750.3 samples/s | 58.6 steps/s
[Step=7750 Epoch=37.8] | Loss=0.02554 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.939 | L2-Norm(final)=2.742 | 3783.8 samples/s | 59.1 steps/s
[Step=7800 Epoch=38.0] | Loss=0.02428 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.942 | L2-Norm(final)=2.746 | 4238.8 samples/s | 66.2 steps/s
[Step=7850 Epoch=38.2] | Loss=0.02317 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.944 | L2-Norm(final)=2.749 | 1609.5 samples/s | 25.1 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02224 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.947 | L2-Norm(final)=2.753 | 3770.7 samples/s | 58.9 steps/s
[Step=7950 Epoch=38.7] | Loss=0.02182 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.949 | L2-Norm(final)=2.757 | 3779.7 samples/s | 59.1 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02095 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.951 | L2-Norm(final)=2.760 | 4017.2 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.22242 | Reg=0.00358 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.933 | L2-Norm(final)=2.750 | 3291.5 samples/s | 51.4 steps/s
[Step=4850 Epoch=23.7] | Loss=0.04906 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.918 | L2-Norm(final)=2.731 | 3715.9 samples/s | 58.1 steps/s
[Step=4900 Epoch=23.9] | Loss=0.04341 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.915 | L2-Norm(final)=2.727 | 3765.9 samples/s | 58.8 steps/s
[Step=4950 Epoch=24.1] | Loss=0.04109 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.915 | L2-Norm(final)=2.727 | 3771.1 samples/s | 58.9 steps/s
[Step=5000 Epoch=24.4] | Loss=0.03780 | Reg=0.00358 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.915 | L2-Norm(final)=2.726 | 4703.3 samples/s | 73.5 steps/s
[Step=5050 Epoch=24.6] | Loss=0.03421 | Reg=0.00358 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.918 | L2-Norm(final)=2.727 | 1554.0 samples/s | 24.3 steps/s
[Step=5100 Epoch=24.9] | Loss=0.03147 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.921 | L2-Norm(final)=2.730 | 3763.2 samples/s | 58.8 steps/s
[Step=5150 Epoch=25.1] | Loss=0.02857 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.923 | L2-Norm(final)=2.733 | 3789.3 samples/s | 59.2 steps/s
[Step=5200 Epoch=25.4] | Loss=0.02707 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.927 | L2-Norm(final)=2.737 | 4467.4 samples/s | 69.8 steps/s
[Step=5250 Epoch=25.6] | Loss=0.02604 | Reg=0.00358 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.931 | L2-Norm(final)=2.741 | 1591.3 samples/s | 24.9 steps/s
[Step=5300 Epoch=25.8] | Loss=0.02516 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.935 | L2-Norm(final)=2.745 | 3763.7 samples/s | 58.8 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02392 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.939 | L2-Norm(final)=2.749 | 3757.5 samples/s | 58.7 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02288 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.942 | L2-Norm(final)=2.752 | 4236.1 samples/s | 66.2 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02201 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.945 | L2-Norm(final)=2.756 | 1609.1 samples/s | 25.1 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02103 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.948 | L2-Norm(final)=2.759 | 3781.2 samples/s | 59.1 steps/s
[Step=5550 Epoch=27.1] | Loss=0.02041 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.950 | L2-Norm(final)=2.762 | 3789.9 samples/s | 59.2 steps/s
[Step=5600 Epoch=27.3] | Loss=0.01972 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.952 | L2-Norm(final)=2.765 | 4033.1 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step5600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=35.3] | Loss=0.28672 | Reg=0.00358 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.933 | L2-Norm(final)=2.750 | 3295.3 samples/s | 51.5 steps/s
[Step=7250 Epoch=35.6] | Loss=0.04971 | Reg=0.00358 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.925 | L2-Norm(final)=2.727 | 3634.0 samples/s | 56.8 steps/s
[Step=7300 Epoch=35.8] | Loss=0.04272 | Reg=0.00358 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.923 | L2-Norm(final)=2.726 | 3778.4 samples/s | 59.0 steps/s
[Step=7350 Epoch=36.0] | Loss=0.04121 | Reg=0.00358 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.922 | L2-Norm(final)=2.725 | 3771.4 samples/s | 58.9 steps/s
[Step=7400 Epoch=36.3] | Loss=0.03927 | Reg=0.00358 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.925 | L2-Norm(final)=2.726 | 4742.7 samples/s | 74.1 steps/s
[Step=7450 Epoch=36.5] | Loss=0.03452 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.928 | L2-Norm(final)=2.728 | 1532.3 samples/s | 23.9 steps/s
[Step=7500 Epoch=36.8] | Loss=0.03147 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.932 | L2-Norm(final)=2.732 | 3770.1 samples/s | 58.9 steps/s
[Step=7550 Epoch=37.0] | Loss=0.02961 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.935 | L2-Norm(final)=2.736 | 3778.1 samples/s | 59.0 steps/s
[Step=7600 Epoch=37.3] | Loss=0.02809 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.938 | L2-Norm(final)=2.740 | 4593.8 samples/s | 71.8 steps/s
[Step=7650 Epoch=37.5] | Loss=0.02616 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.941 | L2-Norm(final)=2.743 | 1560.7 samples/s | 24.4 steps/s
[Step=7700 Epoch=37.8] | Loss=0.02429 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.944 | L2-Norm(final)=2.747 | 3790.7 samples/s | 59.2 steps/s
[Step=7750 Epoch=38.0] | Loss=0.02321 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.946 | L2-Norm(final)=2.752 | 3792.9 samples/s | 59.3 steps/s
[Step=7800 Epoch=38.2] | Loss=0.02254 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.949 | L2-Norm(final)=2.755 | 4425.0 samples/s | 69.1 steps/s
[Step=7850 Epoch=38.5] | Loss=0.02176 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.951 | L2-Norm(final)=2.758 | 1576.7 samples/s | 24.6 steps/s
[Step=7900 Epoch=38.7] | Loss=0.02077 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.953 | L2-Norm(final)=2.762 | 3767.9 samples/s | 58.9 steps/s
[Step=7950 Epoch=39.0] | Loss=0.02027 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.955 | L2-Norm(final)=2.765 | 3769.0 samples/s | 58.9 steps/s
[Step=8000 Epoch=39.2] | Loss=0.01952 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.957 | L2-Norm(final)=2.769 | 4276.1 samples/s | 66.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step8000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=53.5] | Loss=0.07182 | Reg=0.00358 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.933 | L2-Norm(final)=2.751 | 3176.1 samples/s | 49.6 steps/s
[Step=5650 Epoch=54.0] | Loss=0.00940 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.929 | L2-Norm(final)=2.744 | 3598.7 samples/s | 56.2 steps/s
[Step=5700 Epoch=54.4] | Loss=0.00708 | Reg=0.00358 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.932 | L2-Norm(final)=2.745 | 4552.4 samples/s | 71.1 steps/s
[Step=5750 Epoch=54.9] | Loss=0.00486 | Reg=0.00358 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.932 | L2-Norm(final)=2.747 | 1464.7 samples/s | 22.9 steps/s
[Step=5800 Epoch=55.4] | Loss=0.00366 | Reg=0.00358 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.928 | L2-Norm(final)=2.750 | 4339.8 samples/s | 67.8 steps/s
[Step=5850 Epoch=55.9] | Loss=0.00293 | Reg=0.00358 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.922 | L2-Norm(final)=2.752 | 1534.6 samples/s | 24.0 steps/s
[Step=5900 Epoch=56.3] | Loss=0.00245 | Reg=0.00358 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.916 | L2-Norm(final)=2.753 | 4111.5 samples/s | 64.2 steps/s
[Step=5950 Epoch=56.8] | Loss=0.00210 | Reg=0.00358 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.911 | L2-Norm(final)=2.755 | 1536.2 samples/s | 24.0 steps/s
[Step=6000 Epoch=57.3] | Loss=0.00185 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.905 | L2-Norm(final)=2.756 | 3953.2 samples/s | 61.8 steps/s
[Step=6050 Epoch=57.8] | Loss=0.00164 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.900 | L2-Norm(final)=2.757 | 1576.7 samples/s | 24.6 steps/s
[Step=6100 Epoch=58.3] | Loss=0.00148 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.895 | L2-Norm(final)=2.758 | 3769.7 samples/s | 58.9 steps/s
[Step=6150 Epoch=58.7] | Loss=0.00135 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.891 | L2-Norm(final)=2.759 | 1590.5 samples/s | 24.9 steps/s
[Step=6200 Epoch=59.2] | Loss=0.00124 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.887 | L2-Norm(final)=2.760 | 3650.4 samples/s | 57.0 steps/s
[Step=6250 Epoch=59.7] | Loss=0.00115 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.883 | L2-Norm(final)=2.760 | 1614.8 samples/s | 25.2 steps/s
[Step=6300 Epoch=60.2] | Loss=0.00107 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.879 | L2-Norm(final)=2.761 | 3588.3 samples/s | 56.1 steps/s
[Step=6350 Epoch=60.6] | Loss=0.00100 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.876 | L2-Norm(final)=2.762 | 1616.4 samples/s | 25.3 steps/s
[Step=6400 Epoch=61.1] | Loss=0.00094 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.873 | L2-Norm(final)=2.763 | 3594.3 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step6400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=82.9] | Loss=0.20320 | Reg=0.00358 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=18.933 | L2-Norm(final)=2.751 | 3108.6 samples/s | 48.6 steps/s
[Step=8850 Epoch=83.4] | Loss=0.02747 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.964 | L2-Norm(final)=2.717 | 3380.9 samples/s | 52.8 steps/s
[Step=8900 Epoch=83.9] | Loss=0.01672 | Reg=0.00360 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=18.962 | L2-Norm(final)=2.714 | 4501.6 samples/s | 70.3 steps/s
[Step=8950 Epoch=84.3] | Loss=0.01127 | Reg=0.00359 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.955 | L2-Norm(final)=2.715 | 1490.0 samples/s | 23.3 steps/s
[Step=9000 Epoch=84.8] | Loss=0.00861 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.948 | L2-Norm(final)=2.718 | 4200.3 samples/s | 65.6 steps/s
[Step=9050 Epoch=85.3] | Loss=0.00717 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.942 | L2-Norm(final)=2.720 | 1535.0 samples/s | 24.0 steps/s
[Step=9100 Epoch=85.7] | Loss=0.00601 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.936 | L2-Norm(final)=2.722 | 3949.8 samples/s | 61.7 steps/s
[Step=9150 Epoch=86.2] | Loss=0.00516 | Reg=0.00358 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.930 | L2-Norm(final)=2.724 | 1568.9 samples/s | 24.5 steps/s
[Step=9200 Epoch=86.7] | Loss=0.00452 | Reg=0.00358 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.925 | L2-Norm(final)=2.726 | 3724.4 samples/s | 58.2 steps/s
[Step=9250 Epoch=87.2] | Loss=0.00403 | Reg=0.00358 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.920 | L2-Norm(final)=2.728 | 1601.0 samples/s | 25.0 steps/s
[Step=9300 Epoch=87.6] | Loss=0.00363 | Reg=0.00358 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.915 | L2-Norm(final)=2.729 | 3625.8 samples/s | 56.7 steps/s
[Step=9350 Epoch=88.1] | Loss=0.00330 | Reg=0.00358 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.911 | L2-Norm(final)=2.731 | 1629.9 samples/s | 25.5 steps/s
[Step=9400 Epoch=88.6] | Loss=0.00303 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.907 | L2-Norm(final)=2.732 | 3621.3 samples/s | 56.6 steps/s
[Step=9450 Epoch=89.0] | Loss=0.00280 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.903 | L2-Norm(final)=2.734 | 1633.1 samples/s | 25.5 steps/s
[Step=9500 Epoch=89.5] | Loss=0.00261 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.899 | L2-Norm(final)=2.735 | 3569.8 samples/s | 55.8 steps/s
[Step=9550 Epoch=90.0] | Loss=0.00244 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.896 | L2-Norm(final)=2.736 | 1714.1 samples/s | 26.8 steps/s
[Step=9600 Epoch=90.5] | Loss=0.00229 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.892 | L2-Norm(final)=2.737 | 3282.2 samples/s | 51.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31122 | acc=0.7874 | tpr=0.6989 | fpr=0.0203 | 3840.5 samples/s | 15.0 steps/s
Avg test loss: 0.32062, Avg test acc: 0.78576, Avg tpr: 0.69861, Avg fpr: 0.02256, total FA: 176

Testing server on iccad2012
[Step=  50] | Loss=0.38834 | acc=0.7876 | tpr=0.9779 | fpr=0.2158 | 3750.2 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.39255 | acc=0.7861 | tpr=0.9851 | fpr=0.2176 | 7450.5 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.39703 | acc=0.7848 | tpr=0.9870 | fpr=0.2189 | 7392.1 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.40156 | acc=0.7830 | tpr=0.9869 | fpr=0.2207 | 7417.1 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.40192 | acc=0.7821 | tpr=0.9860 | fpr=0.2216 | 5786.3 samples/s | 22.6 steps/s
[Step= 300] | Loss=0.40232 | acc=0.7815 | tpr=0.9869 | fpr=0.2222 | 7543.9 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.40392 | acc=0.7809 | tpr=0.9856 | fpr=0.2228 | 7617.5 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.40517 | acc=0.7808 | tpr=0.9847 | fpr=0.2229 | 7194.4 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.40512 | acc=0.7810 | tpr=0.9834 | fpr=0.2227 | 5646.7 samples/s | 22.1 steps/s
[Step= 500] | Loss=0.40580 | acc=0.7808 | tpr=0.9833 | fpr=0.2228 | 7507.4 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.40525 | acc=0.7812 | tpr=0.9825 | fpr=0.2224 | 12923.7 samples/s | 50.5 steps/s
Avg test loss: 0.40496, Avg test acc: 0.78125, Avg tpr: 0.98217, Avg fpr: 0.22240, total FA: 30880

server round 17/50

clients selected: [1 5 6 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.20844 | Reg=0.00357 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.894 | L2-Norm(final)=2.775 | 3281.3 samples/s | 51.3 steps/s
[Step=5650 Epoch=27.6] | Loss=0.05808 | Reg=0.00357 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.882 | L2-Norm(final)=2.749 | 3689.9 samples/s | 57.7 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04721 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.879 | L2-Norm(final)=2.742 | 3775.4 samples/s | 59.0 steps/s
[Step=5750 Epoch=28.1] | Loss=0.04404 | Reg=0.00356 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=18.878 | L2-Norm(final)=2.741 | 3775.5 samples/s | 59.0 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04063 | Reg=0.00356 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.879 | L2-Norm(final)=2.742 | 4718.8 samples/s | 73.7 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03568 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.883 | L2-Norm(final)=2.746 | 1534.4 samples/s | 24.0 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03276 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.886 | L2-Norm(final)=2.750 | 3769.6 samples/s | 58.9 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03040 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.889 | L2-Norm(final)=2.755 | 3771.1 samples/s | 58.9 steps/s
[Step=6000 Epoch=29.3] | Loss=0.02825 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.892 | L2-Norm(final)=2.759 | 4503.2 samples/s | 70.4 steps/s
[Step=6050 Epoch=29.5] | Loss=0.02677 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.895 | L2-Norm(final)=2.763 | 1573.5 samples/s | 24.6 steps/s
[Step=6100 Epoch=29.8] | Loss=0.02510 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.898 | L2-Norm(final)=2.768 | 3780.6 samples/s | 59.1 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02393 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.901 | L2-Norm(final)=2.772 | 3767.0 samples/s | 58.9 steps/s
[Step=6200 Epoch=30.3] | Loss=0.02313 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.904 | L2-Norm(final)=2.776 | 4309.2 samples/s | 67.3 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02224 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.906 | L2-Norm(final)=2.780 | 1587.7 samples/s | 24.8 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02127 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.908 | L2-Norm(final)=2.783 | 3740.4 samples/s | 58.4 steps/s
[Step=6350 Epoch=31.0] | Loss=0.02091 | Reg=0.00358 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.909 | L2-Norm(final)=2.786 | 3787.9 samples/s | 59.2 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02035 | Reg=0.00358 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.911 | L2-Norm(final)=2.789 | 4152.3 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step6400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=45.5] | Loss=0.05844 | Reg=0.00357 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.894 | L2-Norm(final)=2.776 | 3313.4 samples/s | 51.8 steps/s
[Step=4850 Epoch=46.0] | Loss=0.01760 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.907 | L2-Norm(final)=2.757 | 3437.1 samples/s | 53.7 steps/s
[Step=4900 Epoch=46.4] | Loss=0.01060 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.904 | L2-Norm(final)=2.756 | 4515.2 samples/s | 70.6 steps/s
[Step=4950 Epoch=46.9] | Loss=0.00719 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.899 | L2-Norm(final)=2.758 | 1487.9 samples/s | 23.2 steps/s
[Step=5000 Epoch=47.4] | Loss=0.00550 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.893 | L2-Norm(final)=2.760 | 4244.0 samples/s | 66.3 steps/s
[Step=5050 Epoch=47.9] | Loss=0.00442 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.887 | L2-Norm(final)=2.763 | 1516.3 samples/s | 23.7 steps/s
[Step=5100 Epoch=48.3] | Loss=0.00369 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.882 | L2-Norm(final)=2.765 | 4034.5 samples/s | 63.0 steps/s
[Step=5150 Epoch=48.8] | Loss=0.00317 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.876 | L2-Norm(final)=2.767 | 1561.4 samples/s | 24.4 steps/s
[Step=5200 Epoch=49.3] | Loss=0.00278 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.870 | L2-Norm(final)=2.768 | 3853.3 samples/s | 60.2 steps/s
[Step=5250 Epoch=49.7] | Loss=0.00247 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.865 | L2-Norm(final)=2.769 | 1586.9 samples/s | 24.8 steps/s
[Step=5300 Epoch=50.2] | Loss=0.00223 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.861 | L2-Norm(final)=2.771 | 3673.5 samples/s | 57.4 steps/s
[Step=5350 Epoch=50.7] | Loss=0.00203 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.856 | L2-Norm(final)=2.772 | 1605.2 samples/s | 25.1 steps/s
[Step=5400 Epoch=51.2] | Loss=0.00187 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.852 | L2-Norm(final)=2.773 | 3595.3 samples/s | 56.2 steps/s
[Step=5450 Epoch=51.6] | Loss=0.00172 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.849 | L2-Norm(final)=2.774 | 1634.8 samples/s | 25.5 steps/s
[Step=5500 Epoch=52.1] | Loss=0.00160 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.845 | L2-Norm(final)=2.775 | 3613.0 samples/s | 56.5 steps/s
[Step=5550 Epoch=52.6] | Loss=0.00150 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.842 | L2-Norm(final)=2.776 | 1647.2 samples/s | 25.7 steps/s
[Step=5600 Epoch=53.1] | Loss=0.00141 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.838 | L2-Norm(final)=2.776 | 3560.0 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step5600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=60.9] | Loss=0.06886 | Reg=0.00357 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.894 | L2-Norm(final)=2.776 | 3189.6 samples/s | 49.8 steps/s
[Step=6450 Epoch=61.4] | Loss=0.01480 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.896 | L2-Norm(final)=2.766 | 3485.9 samples/s | 54.5 steps/s
[Step=6500 Epoch=61.8] | Loss=0.00816 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.895 | L2-Norm(final)=2.767 | 4522.4 samples/s | 70.7 steps/s
[Step=6550 Epoch=62.3] | Loss=0.00548 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.888 | L2-Norm(final)=2.770 | 1493.2 samples/s | 23.3 steps/s
[Step=6600 Epoch=62.8] | Loss=0.00412 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.881 | L2-Norm(final)=2.773 | 4296.4 samples/s | 67.1 steps/s
[Step=6650 Epoch=63.3] | Loss=0.00331 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.874 | L2-Norm(final)=2.775 | 1524.1 samples/s | 23.8 steps/s
[Step=6700 Epoch=63.7] | Loss=0.00276 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.867 | L2-Norm(final)=2.777 | 4034.0 samples/s | 63.0 steps/s
[Step=6750 Epoch=64.2] | Loss=0.00238 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.861 | L2-Norm(final)=2.778 | 1548.3 samples/s | 24.2 steps/s
[Step=6800 Epoch=64.7] | Loss=0.00209 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.856 | L2-Norm(final)=2.779 | 3865.3 samples/s | 60.4 steps/s
[Step=6850 Epoch=65.2] | Loss=0.00186 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.851 | L2-Norm(final)=2.780 | 1590.7 samples/s | 24.9 steps/s
[Step=6900 Epoch=65.6] | Loss=0.00168 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.846 | L2-Norm(final)=2.781 | 3672.4 samples/s | 57.4 steps/s
[Step=6950 Epoch=66.1] | Loss=0.00153 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.842 | L2-Norm(final)=2.782 | 1622.3 samples/s | 25.3 steps/s
[Step=7000 Epoch=66.6] | Loss=0.00141 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.838 | L2-Norm(final)=2.783 | 3577.1 samples/s | 55.9 steps/s
[Step=7050 Epoch=67.1] | Loss=0.00130 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.835 | L2-Norm(final)=2.784 | 1650.3 samples/s | 25.8 steps/s
[Step=7100 Epoch=67.5] | Loss=0.00121 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.831 | L2-Norm(final)=2.785 | 3626.5 samples/s | 56.7 steps/s
[Step=7150 Epoch=68.0] | Loss=0.00114 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.828 | L2-Norm(final)=2.786 | 1643.5 samples/s | 25.7 steps/s
[Step=7200 Epoch=68.5] | Loss=0.00107 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.825 | L2-Norm(final)=2.787 | 3582.3 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step7200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=90.5] | Loss=0.26871 | Reg=0.00357 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.894 | L2-Norm(final)=2.775 | 3327.9 samples/s | 52.0 steps/s
[Step=9650 Epoch=90.9] | Loss=0.01976 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.884 | L2-Norm(final)=2.755 | 3376.9 samples/s | 52.8 steps/s
[Step=9700 Epoch=91.4] | Loss=0.01082 | Reg=0.00356 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=18.879 | L2-Norm(final)=2.755 | 4504.4 samples/s | 70.4 steps/s
[Step=9750 Epoch=91.9] | Loss=0.00735 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.872 | L2-Norm(final)=2.757 | 1516.2 samples/s | 23.7 steps/s
[Step=9800 Epoch=92.3] | Loss=0.00554 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.866 | L2-Norm(final)=2.759 | 4150.4 samples/s | 64.9 steps/s
[Step=9850 Epoch=92.8] | Loss=0.00445 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.860 | L2-Norm(final)=2.761 | 1555.4 samples/s | 24.3 steps/s
[Step=9900 Epoch=93.3] | Loss=0.00371 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.854 | L2-Norm(final)=2.762 | 3947.7 samples/s | 61.7 steps/s
[Step=9950 Epoch=93.8] | Loss=0.00319 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.849 | L2-Norm(final)=2.764 | 1575.5 samples/s | 24.6 steps/s
[Step=10000 Epoch=94.2] | Loss=0.00280 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.845 | L2-Norm(final)=2.765 | 3716.8 samples/s | 58.1 steps/s
[Step=10050 Epoch=94.7] | Loss=0.00249 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.841 | L2-Norm(final)=2.766 | 1614.4 samples/s | 25.2 steps/s
[Step=10100 Epoch=95.2] | Loss=0.00225 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.837 | L2-Norm(final)=2.767 | 3579.9 samples/s | 55.9 steps/s
[Step=10150 Epoch=95.6] | Loss=0.00205 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.833 | L2-Norm(final)=2.768 | 1636.6 samples/s | 25.6 steps/s
[Step=10200 Epoch=96.1] | Loss=0.00188 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.830 | L2-Norm(final)=2.769 | 3599.6 samples/s | 56.2 steps/s
[Step=10250 Epoch=96.6] | Loss=0.00174 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.827 | L2-Norm(final)=2.770 | 1220.0 samples/s | 19.1 steps/s
[Step=10300 Epoch=97.1] | Loss=0.00162 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.824 | L2-Norm(final)=2.771 | 3569.5 samples/s | 55.8 steps/s
[Step=10350 Epoch=97.5] | Loss=0.00151 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.821 | L2-Norm(final)=2.772 | 1636.8 samples/s | 25.6 steps/s
[Step=10400 Epoch=98.0] | Loss=0.00142 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.819 | L2-Norm(final)=2.773 | 3295.5 samples/s | 51.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step10400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=83.9] | Loss=0.21099 | Reg=0.00357 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.894 | L2-Norm(final)=2.776 | 3278.4 samples/s | 51.2 steps/s
[Step=8850 Epoch=84.3] | Loss=0.02358 | Reg=0.00358 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.923 | L2-Norm(final)=2.749 | 3401.0 samples/s | 53.1 steps/s
[Step=8900 Epoch=84.8] | Loss=0.01239 | Reg=0.00358 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=18.926 | L2-Norm(final)=2.747 | 4545.6 samples/s | 71.0 steps/s
[Step=8950 Epoch=85.3] | Loss=0.00837 | Reg=0.00358 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.920 | L2-Norm(final)=2.749 | 1495.3 samples/s | 23.4 steps/s
[Step=9000 Epoch=85.8] | Loss=0.00631 | Reg=0.00358 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.913 | L2-Norm(final)=2.752 | 4355.0 samples/s | 68.0 steps/s
[Step=9050 Epoch=86.3] | Loss=0.00506 | Reg=0.00357 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.905 | L2-Norm(final)=2.754 | 1520.2 samples/s | 23.8 steps/s
[Step=9100 Epoch=86.7] | Loss=0.00422 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.898 | L2-Norm(final)=2.756 | 4126.3 samples/s | 64.5 steps/s
[Step=9150 Epoch=87.2] | Loss=0.00363 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.892 | L2-Norm(final)=2.758 | 1544.7 samples/s | 24.1 steps/s
[Step=9200 Epoch=87.7] | Loss=0.00318 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.886 | L2-Norm(final)=2.759 | 3938.3 samples/s | 61.5 steps/s
[Step=9250 Epoch=88.2] | Loss=0.00284 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.880 | L2-Norm(final)=2.761 | 1578.7 samples/s | 24.7 steps/s
[Step=9300 Epoch=88.6] | Loss=0.00256 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.875 | L2-Norm(final)=2.762 | 3781.7 samples/s | 59.1 steps/s
[Step=9350 Epoch=89.1] | Loss=0.00233 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.870 | L2-Norm(final)=2.763 | 1606.0 samples/s | 25.1 steps/s
[Step=9400 Epoch=89.6] | Loss=0.00214 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.865 | L2-Norm(final)=2.765 | 3640.9 samples/s | 56.9 steps/s
[Step=9450 Epoch=90.1] | Loss=0.00198 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.861 | L2-Norm(final)=2.766 | 1613.4 samples/s | 25.2 steps/s
[Step=9500 Epoch=90.5] | Loss=0.00184 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.857 | L2-Norm(final)=2.767 | 3630.6 samples/s | 56.7 steps/s
[Step=9550 Epoch=91.0] | Loss=0.00172 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.853 | L2-Norm(final)=2.768 | 1634.9 samples/s | 25.5 steps/s
[Step=9600 Epoch=91.5] | Loss=0.00162 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.850 | L2-Norm(final)=2.769 | 3602.1 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30170 | acc=0.7952 | tpr=0.7092 | fpr=0.0178 | 3802.6 samples/s | 14.9 steps/s
Avg test loss: 0.31160, Avg test acc: 0.79289, Avg tpr: 0.70828, Avg fpr: 0.02102, total FA: 164

Testing server on iccad2012
[Step=  50] | Loss=0.38531 | acc=0.7906 | tpr=0.9779 | fpr=0.2127 | 3786.6 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.38911 | acc=0.7888 | tpr=0.9851 | fpr=0.2148 | 7177.4 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.39401 | acc=0.7868 | tpr=0.9870 | fpr=0.2169 | 7374.7 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.39823 | acc=0.7856 | tpr=0.9869 | fpr=0.2181 | 7290.9 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.39890 | acc=0.7851 | tpr=0.9843 | fpr=0.2185 | 7451.7 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.39929 | acc=0.7845 | tpr=0.9855 | fpr=0.2191 | 7440.5 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.40087 | acc=0.7842 | tpr=0.9843 | fpr=0.2195 | 7420.8 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.40213 | acc=0.7841 | tpr=0.9836 | fpr=0.2195 | 7334.4 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.40210 | acc=0.7846 | tpr=0.9825 | fpr=0.2190 | 7244.7 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.40268 | acc=0.7841 | tpr=0.9824 | fpr=0.2194 | 7338.7 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.40214 | acc=0.7845 | tpr=0.9809 | fpr=0.2191 | 13223.9 samples/s | 51.7 steps/s
Avg test loss: 0.40187, Avg test acc: 0.78453, Avg tpr: 0.98059, Avg fpr: 0.21903, total FA: 30412

server round 18/50

clients selected: [0 4 6 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.26205 | Reg=0.00356 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=18.862 | L2-Norm(final)=2.796 | 3437.1 samples/s | 53.7 steps/s
[Step=4850 Epoch=23.6] | Loss=0.05846 | Reg=0.00355 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.846 | L2-Norm(final)=2.769 | 3571.0 samples/s | 55.8 steps/s
[Step=4900 Epoch=23.9] | Loss=0.04579 | Reg=0.00355 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.843 | L2-Norm(final)=2.766 | 3766.9 samples/s | 58.9 steps/s
[Step=4950 Epoch=24.1] | Loss=0.04185 | Reg=0.00355 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.843 | L2-Norm(final)=2.765 | 3784.9 samples/s | 59.1 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04020 | Reg=0.00355 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=18.845 | L2-Norm(final)=2.764 | 4718.5 samples/s | 73.7 steps/s
[Step=5050 Epoch=24.6] | Loss=0.03611 | Reg=0.00355 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=18.850 | L2-Norm(final)=2.767 | 1545.8 samples/s | 24.2 steps/s
[Step=5100 Epoch=24.9] | Loss=0.03270 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.854 | L2-Norm(final)=2.770 | 3782.0 samples/s | 59.1 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03013 | Reg=0.00356 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.857 | L2-Norm(final)=2.773 | 3778.6 samples/s | 59.0 steps/s
[Step=5200 Epoch=25.4] | Loss=0.02828 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.859 | L2-Norm(final)=2.776 | 4470.1 samples/s | 69.8 steps/s
[Step=5250 Epoch=25.6] | Loss=0.02654 | Reg=0.00356 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.862 | L2-Norm(final)=2.780 | 1577.7 samples/s | 24.7 steps/s
[Step=5300 Epoch=25.8] | Loss=0.02517 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.865 | L2-Norm(final)=2.783 | 3770.4 samples/s | 58.9 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02378 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.867 | L2-Norm(final)=2.786 | 3786.5 samples/s | 59.2 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02269 | Reg=0.00356 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.870 | L2-Norm(final)=2.790 | 4240.4 samples/s | 66.3 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02158 | Reg=0.00356 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.872 | L2-Norm(final)=2.793 | 1614.6 samples/s | 25.2 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02061 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.874 | L2-Norm(final)=2.796 | 3775.1 samples/s | 59.0 steps/s
[Step=5550 Epoch=27.1] | Loss=0.01967 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.876 | L2-Norm(final)=2.799 | 3775.0 samples/s | 59.0 steps/s
[Step=5600 Epoch=27.3] | Loss=0.01909 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.877 | L2-Norm(final)=2.803 | 4030.6 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step5600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.2] | Loss=0.29058 | Reg=0.00356 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=18.862 | L2-Norm(final)=2.796 | 3286.0 samples/s | 51.3 steps/s
[Step=8050 Epoch=39.5] | Loss=0.05218 | Reg=0.00355 | FP-Reg=0.001 | acc=0.8906 | L2-Norm=18.849 | L2-Norm(final)=2.777 | 3699.6 samples/s | 57.8 steps/s
[Step=8100 Epoch=39.7] | Loss=0.04312 | Reg=0.00355 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.846 | L2-Norm(final)=2.771 | 3758.5 samples/s | 58.7 steps/s
[Step=8150 Epoch=40.0] | Loss=0.03894 | Reg=0.00355 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.848 | L2-Norm(final)=2.770 | 3788.6 samples/s | 59.2 steps/s
[Step=8200 Epoch=40.2] | Loss=0.03608 | Reg=0.00355 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.851 | L2-Norm(final)=2.771 | 4766.4 samples/s | 74.5 steps/s
[Step=8250 Epoch=40.5] | Loss=0.03233 | Reg=0.00356 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.855 | L2-Norm(final)=2.772 | 1545.1 samples/s | 24.1 steps/s
[Step=8300 Epoch=40.7] | Loss=0.02973 | Reg=0.00356 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=18.858 | L2-Norm(final)=2.774 | 3786.0 samples/s | 59.2 steps/s
[Step=8350 Epoch=40.9] | Loss=0.02725 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.862 | L2-Norm(final)=2.777 | 3788.2 samples/s | 59.2 steps/s
[Step=8400 Epoch=41.2] | Loss=0.02522 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.865 | L2-Norm(final)=2.782 | 4591.0 samples/s | 71.7 steps/s
[Step=8450 Epoch=41.4] | Loss=0.02363 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.868 | L2-Norm(final)=2.786 | 1571.2 samples/s | 24.6 steps/s
[Step=8500 Epoch=41.7] | Loss=0.02211 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.871 | L2-Norm(final)=2.791 | 3790.7 samples/s | 59.2 steps/s
[Step=8550 Epoch=41.9] | Loss=0.02127 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.873 | L2-Norm(final)=2.794 | 3788.4 samples/s | 59.2 steps/s
[Step=8600 Epoch=42.2] | Loss=0.02044 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.874 | L2-Norm(final)=2.798 | 4430.9 samples/s | 69.2 steps/s
[Step=8650 Epoch=42.4] | Loss=0.01958 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.876 | L2-Norm(final)=2.801 | 1580.7 samples/s | 24.7 steps/s
[Step=8700 Epoch=42.7] | Loss=0.01913 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.877 | L2-Norm(final)=2.803 | 3781.1 samples/s | 59.1 steps/s
[Step=8750 Epoch=42.9] | Loss=0.01843 | Reg=0.00356 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.878 | L2-Norm(final)=2.806 | 3782.6 samples/s | 59.1 steps/s
[Step=8800 Epoch=43.2] | Loss=0.01804 | Reg=0.00356 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.879 | L2-Norm(final)=2.808 | 4275.1 samples/s | 66.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step8800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=68.5] | Loss=0.15499 | Reg=0.00356 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.862 | L2-Norm(final)=2.796 | 3167.7 samples/s | 49.5 steps/s
[Step=7250 Epoch=69.0] | Loss=0.01920 | Reg=0.00356 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.881 | L2-Norm(final)=2.774 | 3553.9 samples/s | 55.5 steps/s
[Step=7300 Epoch=69.4] | Loss=0.01179 | Reg=0.00357 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.883 | L2-Norm(final)=2.773 | 4540.8 samples/s | 71.0 steps/s
[Step=7350 Epoch=69.9] | Loss=0.00794 | Reg=0.00356 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.880 | L2-Norm(final)=2.775 | 1492.5 samples/s | 23.3 steps/s
[Step=7400 Epoch=70.4] | Loss=0.00598 | Reg=0.00356 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.874 | L2-Norm(final)=2.777 | 4264.6 samples/s | 66.6 steps/s
[Step=7450 Epoch=70.9] | Loss=0.00480 | Reg=0.00356 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.867 | L2-Norm(final)=2.780 | 1523.3 samples/s | 23.8 steps/s
[Step=7500 Epoch=71.3] | Loss=0.00400 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.860 | L2-Norm(final)=2.781 | 4038.3 samples/s | 63.1 steps/s
[Step=7550 Epoch=71.8] | Loss=0.00344 | Reg=0.00355 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.854 | L2-Norm(final)=2.783 | 1561.8 samples/s | 24.4 steps/s
[Step=7600 Epoch=72.3] | Loss=0.00302 | Reg=0.00355 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.848 | L2-Norm(final)=2.785 | 3817.9 samples/s | 59.7 steps/s
[Step=7650 Epoch=72.8] | Loss=0.00269 | Reg=0.00355 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.842 | L2-Norm(final)=2.786 | 1588.2 samples/s | 24.8 steps/s
[Step=7700 Epoch=73.2] | Loss=0.00242 | Reg=0.00355 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.837 | L2-Norm(final)=2.787 | 3653.6 samples/s | 57.1 steps/s
[Step=7750 Epoch=73.7] | Loss=0.00221 | Reg=0.00355 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.833 | L2-Norm(final)=2.789 | 1624.7 samples/s | 25.4 steps/s
[Step=7800 Epoch=74.2] | Loss=0.00203 | Reg=0.00355 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.828 | L2-Norm(final)=2.790 | 3567.0 samples/s | 55.7 steps/s
[Step=7850 Epoch=74.7] | Loss=0.00188 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.824 | L2-Norm(final)=2.791 | 1644.9 samples/s | 25.7 steps/s
[Step=7900 Epoch=75.1] | Loss=0.00174 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.820 | L2-Norm(final)=2.792 | 3557.9 samples/s | 55.6 steps/s
[Step=7950 Epoch=75.6] | Loss=0.00163 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.817 | L2-Norm(final)=2.793 | 1652.9 samples/s | 25.8 steps/s
[Step=8000 Epoch=76.1] | Loss=0.00153 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.813 | L2-Norm(final)=2.794 | 3535.6 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step8000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=61.1] | Loss=0.09847 | Reg=0.00356 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.862 | L2-Norm(final)=2.796 | 3232.2 samples/s | 50.5 steps/s
[Step=6450 Epoch=61.6] | Loss=0.01701 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.864 | L2-Norm(final)=2.779 | 3476.2 samples/s | 54.3 steps/s
[Step=6500 Epoch=62.1] | Loss=0.00923 | Reg=0.00356 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.867 | L2-Norm(final)=2.776 | 4576.5 samples/s | 71.5 steps/s
[Step=6550 Epoch=62.5] | Loss=0.00620 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.861 | L2-Norm(final)=2.777 | 1480.5 samples/s | 23.1 steps/s
[Step=6600 Epoch=63.0] | Loss=0.00467 | Reg=0.00355 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.854 | L2-Norm(final)=2.779 | 4335.1 samples/s | 67.7 steps/s
[Step=6650 Epoch=63.5] | Loss=0.00374 | Reg=0.00355 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.847 | L2-Norm(final)=2.780 | 1514.0 samples/s | 23.7 steps/s
[Step=6700 Epoch=64.0] | Loss=0.00313 | Reg=0.00355 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.840 | L2-Norm(final)=2.782 | 4143.8 samples/s | 64.7 steps/s
[Step=6750 Epoch=64.5] | Loss=0.00268 | Reg=0.00355 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.834 | L2-Norm(final)=2.783 | 1534.9 samples/s | 24.0 steps/s
[Step=6800 Epoch=64.9] | Loss=0.00235 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.828 | L2-Norm(final)=2.784 | 3919.3 samples/s | 61.2 steps/s
[Step=6850 Epoch=65.4] | Loss=0.00210 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.823 | L2-Norm(final)=2.785 | 1564.1 samples/s | 24.4 steps/s
[Step=6900 Epoch=65.9] | Loss=0.00189 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.818 | L2-Norm(final)=2.786 | 3789.3 samples/s | 59.2 steps/s
[Step=6950 Epoch=66.4] | Loss=0.00172 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.814 | L2-Norm(final)=2.787 | 1589.8 samples/s | 24.8 steps/s
[Step=7000 Epoch=66.8] | Loss=0.00158 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.810 | L2-Norm(final)=2.789 | 3648.6 samples/s | 57.0 steps/s
[Step=7050 Epoch=67.3] | Loss=0.00146 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.806 | L2-Norm(final)=2.790 | 1611.4 samples/s | 25.2 steps/s
[Step=7100 Epoch=67.8] | Loss=0.00136 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.802 | L2-Norm(final)=2.791 | 3602.3 samples/s | 56.3 steps/s
[Step=7150 Epoch=68.3] | Loss=0.00127 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.799 | L2-Norm(final)=2.792 | 1634.2 samples/s | 25.5 steps/s
[Step=7200 Epoch=68.8] | Loss=0.00120 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.796 | L2-Norm(final)=2.793 | 3599.7 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step7200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=98.0] | Loss=0.08954 | Reg=0.00356 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.862 | L2-Norm(final)=2.797 | 3164.4 samples/s | 49.4 steps/s
[Step=10450 Epoch=98.5] | Loss=0.01323 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.853 | L2-Norm(final)=2.790 | 3497.6 samples/s | 54.7 steps/s
[Step=10500 Epoch=98.9] | Loss=0.01004 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.861 | L2-Norm(final)=2.787 | 4458.7 samples/s | 69.7 steps/s
[Step=10550 Epoch=99.4] | Loss=0.00676 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.861 | L2-Norm(final)=2.788 | 1502.9 samples/s | 23.5 steps/s
[Step=10600 Epoch=99.9] | Loss=0.00518 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.856 | L2-Norm(final)=2.789 | 4198.4 samples/s | 65.6 steps/s
[Step=10650 Epoch=100.4] | Loss=0.00417 | Reg=0.00355 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.851 | L2-Norm(final)=2.791 | 1535.1 samples/s | 24.0 steps/s
[Step=10700 Epoch=100.8] | Loss=0.00348 | Reg=0.00355 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.846 | L2-Norm(final)=2.792 | 3936.4 samples/s | 61.5 steps/s
[Step=10750 Epoch=101.3] | Loss=0.00300 | Reg=0.00355 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.841 | L2-Norm(final)=2.794 | 1583.7 samples/s | 24.7 steps/s
[Step=10800 Epoch=101.8] | Loss=0.00263 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.836 | L2-Norm(final)=2.795 | 3701.9 samples/s | 57.8 steps/s
[Step=10850 Epoch=102.2] | Loss=0.00234 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.832 | L2-Norm(final)=2.796 | 1597.0 samples/s | 25.0 steps/s
[Step=10900 Epoch=102.7] | Loss=0.00211 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.828 | L2-Norm(final)=2.797 | 3596.1 samples/s | 56.2 steps/s
[Step=10950 Epoch=103.2] | Loss=0.00192 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.824 | L2-Norm(final)=2.798 | 1628.7 samples/s | 25.4 steps/s
[Step=11000 Epoch=103.7] | Loss=0.00177 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.820 | L2-Norm(final)=2.799 | 3621.2 samples/s | 56.6 steps/s
[Step=11050 Epoch=104.1] | Loss=0.00164 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.816 | L2-Norm(final)=2.800 | 1645.7 samples/s | 25.7 steps/s
[Step=11100 Epoch=104.6] | Loss=0.00152 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.813 | L2-Norm(final)=2.801 | 3562.8 samples/s | 55.7 steps/s
[Step=11150 Epoch=105.1] | Loss=0.00142 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.810 | L2-Norm(final)=2.802 | 1661.6 samples/s | 26.0 steps/s
[Step=11200 Epoch=105.5] | Loss=0.00134 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.807 | L2-Norm(final)=2.803 | 3545.1 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33528 | acc=0.7720 | tpr=0.6754 | fpr=0.0181 | 3752.3 samples/s | 14.7 steps/s
Avg test loss: 0.34444, Avg test acc: 0.77146, Avg tpr: 0.67716, Avg fpr: 0.02115, total FA: 165

Testing server on iccad2012
[Step=  50] | Loss=0.33867 | acc=0.8184 | tpr=0.9779 | fpr=0.1844 | 3721.5 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.34274 | acc=0.8167 | tpr=0.9808 | fpr=0.1863 | 7423.2 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.34745 | acc=0.8148 | tpr=0.9841 | fpr=0.1883 | 7654.4 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.35146 | acc=0.8137 | tpr=0.9847 | fpr=0.1895 | 7042.0 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.35172 | acc=0.8134 | tpr=0.9825 | fpr=0.1897 | 7336.6 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.35215 | acc=0.8128 | tpr=0.9840 | fpr=0.1903 | 7604.6 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.35365 | acc=0.8125 | tpr=0.9825 | fpr=0.1906 | 7282.6 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.35499 | acc=0.8123 | tpr=0.9819 | fpr=0.1907 | 7228.4 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.35503 | acc=0.8127 | tpr=0.9810 | fpr=0.1904 | 7378.6 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.35560 | acc=0.8121 | tpr=0.9806 | fpr=0.1910 | 7481.0 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.35505 | acc=0.8123 | tpr=0.9793 | fpr=0.1908 | 12984.1 samples/s | 50.7 steps/s
Avg test loss: 0.35477, Avg test acc: 0.81229, Avg tpr: 0.97900, Avg fpr: 0.19074, total FA: 26484

server round 19/50

clients selected: [2 6 7 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.34747 | Reg=0.00354 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=18.820 | L2-Norm(final)=2.815 | 3430.8 samples/s | 53.6 steps/s
[Step=8050 Epoch=39.2] | Loss=0.06003 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.805 | L2-Norm(final)=2.791 | 3483.6 samples/s | 54.4 steps/s
[Step=8100 Epoch=39.5] | Loss=0.04553 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.805 | L2-Norm(final)=2.787 | 3785.7 samples/s | 59.2 steps/s
[Step=8150 Epoch=39.7] | Loss=0.04417 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.806 | L2-Norm(final)=2.785 | 3771.8 samples/s | 58.9 steps/s
[Step=8200 Epoch=40.0] | Loss=0.04029 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.809 | L2-Norm(final)=2.783 | 4695.9 samples/s | 73.4 steps/s
[Step=8250 Epoch=40.2] | Loss=0.03520 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.813 | L2-Norm(final)=2.785 | 1549.7 samples/s | 24.2 steps/s
[Step=8300 Epoch=40.4] | Loss=0.03220 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=18.817 | L2-Norm(final)=2.789 | 3775.5 samples/s | 59.0 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02993 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.820 | L2-Norm(final)=2.793 | 3790.3 samples/s | 59.2 steps/s
[Step=8400 Epoch=40.9] | Loss=0.02828 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.823 | L2-Norm(final)=2.796 | 4444.8 samples/s | 69.4 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02665 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=18.826 | L2-Norm(final)=2.800 | 1579.0 samples/s | 24.7 steps/s
[Step=8500 Epoch=41.4] | Loss=0.02539 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.828 | L2-Norm(final)=2.803 | 3788.2 samples/s | 59.2 steps/s
[Step=8550 Epoch=41.7] | Loss=0.02398 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.830 | L2-Norm(final)=2.806 | 3796.1 samples/s | 59.3 steps/s
[Step=8600 Epoch=41.9] | Loss=0.02297 | Reg=0.00355 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.832 | L2-Norm(final)=2.809 | 4213.6 samples/s | 65.8 steps/s
[Step=8650 Epoch=42.1] | Loss=0.02204 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.834 | L2-Norm(final)=2.812 | 1603.9 samples/s | 25.1 steps/s
[Step=8700 Epoch=42.4] | Loss=0.02117 | Reg=0.00355 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.835 | L2-Norm(final)=2.815 | 3766.6 samples/s | 58.9 steps/s
[Step=8750 Epoch=42.6] | Loss=0.02040 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.836 | L2-Norm(final)=2.818 | 3780.8 samples/s | 59.1 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01974 | Reg=0.00355 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.838 | L2-Norm(final)=2.820 | 4043.1 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step8800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=76.1] | Loss=0.07078 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.820 | L2-Norm(final)=2.816 | 3098.6 samples/s | 48.4 steps/s
[Step=8050 Epoch=76.6] | Loss=0.00718 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.806 | L2-Norm(final)=2.819 | 3580.4 samples/s | 55.9 steps/s
[Step=8100 Epoch=77.1] | Loss=0.00455 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.803 | L2-Norm(final)=2.824 | 4525.7 samples/s | 70.7 steps/s
[Step=8150 Epoch=77.5] | Loss=0.00309 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.800 | L2-Norm(final)=2.827 | 1483.7 samples/s | 23.2 steps/s
[Step=8200 Epoch=78.0] | Loss=0.00234 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.795 | L2-Norm(final)=2.830 | 4283.9 samples/s | 66.9 steps/s
[Step=8250 Epoch=78.5] | Loss=0.00188 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.790 | L2-Norm(final)=2.832 | 1527.0 samples/s | 23.9 steps/s
[Step=8300 Epoch=79.0] | Loss=0.00157 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.784 | L2-Norm(final)=2.833 | 4043.8 samples/s | 63.2 steps/s
[Step=8350 Epoch=79.4] | Loss=0.00135 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.779 | L2-Norm(final)=2.834 | 1558.2 samples/s | 24.3 steps/s
[Step=8400 Epoch=79.9] | Loss=0.00119 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.774 | L2-Norm(final)=2.835 | 3826.5 samples/s | 59.8 steps/s
[Step=8450 Epoch=80.4] | Loss=0.00106 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.769 | L2-Norm(final)=2.836 | 1591.3 samples/s | 24.9 steps/s
[Step=8500 Epoch=80.9] | Loss=0.00096 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.765 | L2-Norm(final)=2.837 | 3652.1 samples/s | 57.1 steps/s
[Step=8550 Epoch=81.3] | Loss=0.00088 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.761 | L2-Norm(final)=2.837 | 1624.3 samples/s | 25.4 steps/s
[Step=8600 Epoch=81.8] | Loss=0.00081 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.757 | L2-Norm(final)=2.838 | 3611.4 samples/s | 56.4 steps/s
[Step=8650 Epoch=82.3] | Loss=0.00075 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.754 | L2-Norm(final)=2.839 | 1619.6 samples/s | 25.3 steps/s
[Step=8700 Epoch=82.8] | Loss=0.00070 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.750 | L2-Norm(final)=2.839 | 3611.5 samples/s | 56.4 steps/s
[Step=8750 Epoch=83.2] | Loss=0.00065 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.747 | L2-Norm(final)=2.839 | 1638.7 samples/s | 25.6 steps/s
[Step=8800 Epoch=83.7] | Loss=0.00061 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.744 | L2-Norm(final)=2.840 | 3550.4 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step8800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=68.8] | Loss=0.03847 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.820 | L2-Norm(final)=2.816 | 3112.4 samples/s | 48.6 steps/s
[Step=7250 Epoch=69.2] | Loss=0.01303 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.815 | L2-Norm(final)=2.811 | 3593.3 samples/s | 56.1 steps/s
[Step=7300 Epoch=69.7] | Loss=0.00837 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.825 | L2-Norm(final)=2.810 | 4557.7 samples/s | 71.2 steps/s
[Step=7350 Epoch=70.2] | Loss=0.00580 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.825 | L2-Norm(final)=2.811 | 1494.3 samples/s | 23.3 steps/s
[Step=7400 Epoch=70.7] | Loss=0.00436 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.821 | L2-Norm(final)=2.812 | 4336.2 samples/s | 67.8 steps/s
[Step=7450 Epoch=71.1] | Loss=0.00353 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.816 | L2-Norm(final)=2.813 | 1517.8 samples/s | 23.7 steps/s
[Step=7500 Epoch=71.6] | Loss=0.00295 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.811 | L2-Norm(final)=2.815 | 4113.6 samples/s | 64.3 steps/s
[Step=7550 Epoch=72.1] | Loss=0.00253 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.805 | L2-Norm(final)=2.816 | 1553.8 samples/s | 24.3 steps/s
[Step=7600 Epoch=72.6] | Loss=0.00222 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.800 | L2-Norm(final)=2.817 | 3945.4 samples/s | 61.6 steps/s
[Step=7650 Epoch=73.1] | Loss=0.00197 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.795 | L2-Norm(final)=2.818 | 1583.9 samples/s | 24.7 steps/s
[Step=7700 Epoch=73.5] | Loss=0.00178 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.791 | L2-Norm(final)=2.819 | 3784.4 samples/s | 59.1 steps/s
[Step=7750 Epoch=74.0] | Loss=0.00162 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.786 | L2-Norm(final)=2.820 | 1578.4 samples/s | 24.7 steps/s
[Step=7800 Epoch=74.5] | Loss=0.00149 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.782 | L2-Norm(final)=2.821 | 3667.8 samples/s | 57.3 steps/s
[Step=7850 Epoch=75.0] | Loss=0.00138 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.778 | L2-Norm(final)=2.821 | 1634.8 samples/s | 25.5 steps/s
[Step=7900 Epoch=75.4] | Loss=0.00128 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.775 | L2-Norm(final)=2.822 | 3619.3 samples/s | 56.6 steps/s
[Step=7950 Epoch=75.9] | Loss=0.00120 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.771 | L2-Norm(final)=2.823 | 1640.9 samples/s | 25.6 steps/s
[Step=8000 Epoch=76.4] | Loss=0.00112 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.768 | L2-Norm(final)=2.824 | 3615.2 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step8000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=105.5] | Loss=0.08624 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.820 | L2-Norm(final)=2.816 | 3227.1 samples/s | 50.4 steps/s
[Step=11250 Epoch=106.0] | Loss=0.02319 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.821 | L2-Norm(final)=2.778 | 3528.1 samples/s | 55.1 steps/s
[Step=11300 Epoch=106.5] | Loss=0.01301 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.820 | L2-Norm(final)=2.774 | 4490.6 samples/s | 70.2 steps/s
[Step=11350 Epoch=106.9] | Loss=0.00876 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.816 | L2-Norm(final)=2.777 | 1517.9 samples/s | 23.7 steps/s
[Step=11400 Epoch=107.4] | Loss=0.00659 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.810 | L2-Norm(final)=2.780 | 4214.4 samples/s | 65.9 steps/s
[Step=11450 Epoch=107.9] | Loss=0.00528 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.804 | L2-Norm(final)=2.782 | 1552.3 samples/s | 24.3 steps/s
[Step=11500 Epoch=108.4] | Loss=0.00441 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.799 | L2-Norm(final)=2.784 | 3941.3 samples/s | 61.6 steps/s
[Step=11550 Epoch=108.8] | Loss=0.00379 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.794 | L2-Norm(final)=2.786 | 1573.9 samples/s | 24.6 steps/s
[Step=11600 Epoch=109.3] | Loss=0.00332 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.789 | L2-Norm(final)=2.788 | 3697.4 samples/s | 57.8 steps/s
[Step=11650 Epoch=109.8] | Loss=0.00296 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.785 | L2-Norm(final)=2.790 | 1608.4 samples/s | 25.1 steps/s
[Step=11700 Epoch=110.2] | Loss=0.00267 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.781 | L2-Norm(final)=2.791 | 3556.9 samples/s | 55.6 steps/s
[Step=11750 Epoch=110.7] | Loss=0.00243 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.777 | L2-Norm(final)=2.793 | 1620.0 samples/s | 25.3 steps/s
[Step=11800 Epoch=111.2] | Loss=0.00223 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.774 | L2-Norm(final)=2.794 | 3631.3 samples/s | 56.7 steps/s
[Step=11850 Epoch=111.7] | Loss=0.00206 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.770 | L2-Norm(final)=2.796 | 1642.0 samples/s | 25.7 steps/s
[Step=11900 Epoch=112.1] | Loss=0.00192 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.767 | L2-Norm(final)=2.797 | 3587.1 samples/s | 56.0 steps/s
[Step=11950 Epoch=112.6] | Loss=0.00179 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.764 | L2-Norm(final)=2.799 | 1636.4 samples/s | 25.6 steps/s
[Step=12000 Epoch=113.1] | Loss=0.00168 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.761 | L2-Norm(final)=2.800 | 3490.5 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step12000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.5] | Loss=0.07221 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.820 | L2-Norm(final)=2.816 | 3165.8 samples/s | 49.5 steps/s
[Step=9650 Epoch=92.0] | Loss=0.01357 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.797 | L2-Norm(final)=2.802 | 3533.1 samples/s | 55.2 steps/s
[Step=9700 Epoch=92.4] | Loss=0.00807 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.802 | L2-Norm(final)=2.803 | 4552.8 samples/s | 71.1 steps/s
[Step=9750 Epoch=92.9] | Loss=0.00555 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.800 | L2-Norm(final)=2.805 | 1489.0 samples/s | 23.3 steps/s
[Step=9800 Epoch=93.4] | Loss=0.00418 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.796 | L2-Norm(final)=2.807 | 4340.4 samples/s | 67.8 steps/s
[Step=9850 Epoch=93.9] | Loss=0.00335 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.791 | L2-Norm(final)=2.809 | 1520.1 samples/s | 23.8 steps/s
[Step=9900 Epoch=94.4] | Loss=0.00280 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.786 | L2-Norm(final)=2.810 | 4143.8 samples/s | 64.7 steps/s
[Step=9950 Epoch=94.8] | Loss=0.00241 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.781 | L2-Norm(final)=2.811 | 1541.5 samples/s | 24.1 steps/s
[Step=10000 Epoch=95.3] | Loss=0.00211 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.777 | L2-Norm(final)=2.812 | 3929.9 samples/s | 61.4 steps/s
[Step=10050 Epoch=95.8] | Loss=0.00188 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.773 | L2-Norm(final)=2.814 | 1570.8 samples/s | 24.5 steps/s
[Step=10100 Epoch=96.3] | Loss=0.00170 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.769 | L2-Norm(final)=2.815 | 3790.8 samples/s | 59.2 steps/s
[Step=10150 Epoch=96.7] | Loss=0.00155 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.765 | L2-Norm(final)=2.816 | 1603.6 samples/s | 25.1 steps/s
[Step=10200 Epoch=97.2] | Loss=0.00142 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.762 | L2-Norm(final)=2.816 | 3638.6 samples/s | 56.9 steps/s
[Step=10250 Epoch=97.7] | Loss=0.00132 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.759 | L2-Norm(final)=2.817 | 1617.6 samples/s | 25.3 steps/s
[Step=10300 Epoch=98.2] | Loss=0.00122 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.756 | L2-Norm(final)=2.818 | 3599.1 samples/s | 56.2 steps/s
[Step=10350 Epoch=98.6] | Loss=0.00115 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.753 | L2-Norm(final)=2.819 | 1625.5 samples/s | 25.4 steps/s
[Step=10400 Epoch=99.1] | Loss=0.00108 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.750 | L2-Norm(final)=2.820 | 3614.0 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31247 | acc=0.7905 | tpr=0.7008 | fpr=0.0146 | 3787.9 samples/s | 14.8 steps/s
Avg test loss: 0.32220, Avg test acc: 0.78832, Avg tpr: 0.70018, Avg fpr: 0.01782, total FA: 139

Testing server on iccad2012
[Step=  50] | Loss=0.36638 | acc=0.8018 | tpr=0.9735 | fpr=0.2013 | 3759.5 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.37046 | acc=0.8008 | tpr=0.9787 | fpr=0.2025 | 7348.8 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.37551 | acc=0.7987 | tpr=0.9827 | fpr=0.2046 | 7657.4 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.37948 | acc=0.7977 | tpr=0.9825 | fpr=0.2057 | 7349.0 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.37988 | acc=0.7970 | tpr=0.9808 | fpr=0.2064 | 7132.0 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.38039 | acc=0.7967 | tpr=0.9818 | fpr=0.2066 | 7697.5 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.38178 | acc=0.7968 | tpr=0.9806 | fpr=0.2066 | 7344.2 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.38300 | acc=0.7965 | tpr=0.9803 | fpr=0.2069 | 7260.3 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.38309 | acc=0.7967 | tpr=0.9800 | fpr=0.2067 | 7115.1 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.38364 | acc=0.7963 | tpr=0.9802 | fpr=0.2070 | 7300.9 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.38312 | acc=0.7966 | tpr=0.9785 | fpr=0.2067 | 13336.0 samples/s | 52.1 steps/s
Avg test loss: 0.38281, Avg test acc: 0.79665, Avg tpr: 0.97821, Avg fpr: 0.20665, total FA: 28693

server round 20/50

clients selected: [2 4 5 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=42.9] | Loss=0.27030 | Reg=0.00353 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=18.787 | L2-Norm(final)=2.831 | 3426.2 samples/s | 53.5 steps/s
[Step=8850 Epoch=43.1] | Loss=0.04896 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.765 | L2-Norm(final)=2.818 | 3612.4 samples/s | 56.4 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03752 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.759 | L2-Norm(final)=2.817 | 3786.8 samples/s | 59.2 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03233 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.755 | L2-Norm(final)=2.817 | 3775.8 samples/s | 59.0 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02853 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.754 | L2-Norm(final)=2.820 | 4705.6 samples/s | 73.5 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02478 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.754 | L2-Norm(final)=2.824 | 1556.7 samples/s | 24.3 steps/s
[Step=9100 Epoch=44.3] | Loss=0.02243 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.754 | L2-Norm(final)=2.828 | 3775.5 samples/s | 59.0 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02062 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.755 | L2-Norm(final)=2.832 | 3786.1 samples/s | 59.2 steps/s
[Step=9200 Epoch=44.8] | Loss=0.01939 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.756 | L2-Norm(final)=2.836 | 4466.3 samples/s | 69.8 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01802 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.757 | L2-Norm(final)=2.840 | 1585.8 samples/s | 24.8 steps/s
[Step=9300 Epoch=45.3] | Loss=0.01679 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.758 | L2-Norm(final)=2.844 | 3779.5 samples/s | 59.1 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01590 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.759 | L2-Norm(final)=2.848 | 3781.7 samples/s | 59.1 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01538 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.760 | L2-Norm(final)=2.852 | 4222.8 samples/s | 66.0 steps/s
[Step=9450 Epoch=46.0] | Loss=0.01470 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.761 | L2-Norm(final)=2.856 | 1614.0 samples/s | 25.2 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01418 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.762 | L2-Norm(final)=2.859 | 3769.7 samples/s | 58.9 steps/s
[Step=9550 Epoch=46.5] | Loss=0.01363 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.763 | L2-Norm(final)=2.863 | 3779.9 samples/s | 59.1 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01311 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.764 | L2-Norm(final)=2.866 | 4028.7 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step9600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=43.2] | Loss=0.14194 | Reg=0.00353 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.787 | L2-Norm(final)=2.831 | 3341.5 samples/s | 52.2 steps/s
[Step=8850 Epoch=43.4] | Loss=0.04327 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.767 | L2-Norm(final)=2.820 | 3635.2 samples/s | 56.8 steps/s
[Step=8900 Epoch=43.6] | Loss=0.03515 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.760 | L2-Norm(final)=2.819 | 3785.1 samples/s | 59.1 steps/s
[Step=8950 Epoch=43.9] | Loss=0.03021 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.757 | L2-Norm(final)=2.820 | 3792.0 samples/s | 59.2 steps/s
[Step=9000 Epoch=44.1] | Loss=0.02820 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.756 | L2-Norm(final)=2.821 | 4771.7 samples/s | 74.6 steps/s
[Step=9050 Epoch=44.4] | Loss=0.02459 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.756 | L2-Norm(final)=2.824 | 1541.3 samples/s | 24.1 steps/s
[Step=9100 Epoch=44.6] | Loss=0.02188 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.756 | L2-Norm(final)=2.828 | 3779.7 samples/s | 59.1 steps/s
[Step=9150 Epoch=44.9] | Loss=0.02014 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.757 | L2-Norm(final)=2.831 | 3776.0 samples/s | 59.0 steps/s
[Step=9200 Epoch=45.1] | Loss=0.01904 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.758 | L2-Norm(final)=2.835 | 4569.2 samples/s | 71.4 steps/s
[Step=9250 Epoch=45.4] | Loss=0.01766 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.759 | L2-Norm(final)=2.839 | 1559.5 samples/s | 24.4 steps/s
[Step=9300 Epoch=45.6] | Loss=0.01649 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.760 | L2-Norm(final)=2.843 | 3790.9 samples/s | 59.2 steps/s
[Step=9350 Epoch=45.9] | Loss=0.01547 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.761 | L2-Norm(final)=2.846 | 3795.6 samples/s | 59.3 steps/s
[Step=9400 Epoch=46.1] | Loss=0.01472 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.762 | L2-Norm(final)=2.850 | 4426.7 samples/s | 69.2 steps/s
[Step=9450 Epoch=46.3] | Loss=0.01420 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.762 | L2-Norm(final)=2.853 | 1581.2 samples/s | 24.7 steps/s
[Step=9500 Epoch=46.6] | Loss=0.01359 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.763 | L2-Norm(final)=2.856 | 3768.5 samples/s | 58.9 steps/s
[Step=9550 Epoch=46.8] | Loss=0.01309 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.764 | L2-Norm(final)=2.860 | 3773.2 samples/s | 59.0 steps/s
[Step=9600 Epoch=47.1] | Loss=0.01253 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.765 | L2-Norm(final)=2.863 | 4290.2 samples/s | 67.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step9600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=5601 Epoch=53.1] | Loss=0.09885 | Reg=0.00353 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.787 | L2-Norm(final)=2.831 | 3345.8 samples/s | 52.3 steps/s
[Step=5650 Epoch=53.5] | Loss=0.01024 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.760 | L2-Norm(final)=2.828 | 3375.3 samples/s | 52.7 steps/s
[Step=5700 Epoch=54.0] | Loss=0.00543 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.750 | L2-Norm(final)=2.830 | 4521.0 samples/s | 70.6 steps/s
[Step=5750 Epoch=54.5] | Loss=0.00386 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.743 | L2-Norm(final)=2.833 | 1499.2 samples/s | 23.4 steps/s
[Step=5800 Epoch=55.0] | Loss=0.00293 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.738 | L2-Norm(final)=2.835 | 4259.3 samples/s | 66.6 steps/s
[Step=5850 Epoch=55.4] | Loss=0.00237 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.734 | L2-Norm(final)=2.836 | 1530.0 samples/s | 23.9 steps/s
[Step=5900 Epoch=55.9] | Loss=0.00198 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.730 | L2-Norm(final)=2.837 | 4026.9 samples/s | 62.9 steps/s
[Step=5950 Epoch=56.4] | Loss=0.00171 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.726 | L2-Norm(final)=2.839 | 1564.0 samples/s | 24.4 steps/s
[Step=6000 Epoch=56.9] | Loss=0.00150 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.723 | L2-Norm(final)=2.840 | 3815.7 samples/s | 59.6 steps/s
[Step=6050 Epoch=57.3] | Loss=0.00134 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.720 | L2-Norm(final)=2.840 | 1572.9 samples/s | 24.6 steps/s
[Step=6100 Epoch=57.8] | Loss=0.00121 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.717 | L2-Norm(final)=2.841 | 3677.6 samples/s | 57.5 steps/s
[Step=6150 Epoch=58.3] | Loss=0.00111 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.715 | L2-Norm(final)=2.842 | 1615.8 samples/s | 25.2 steps/s
[Step=6200 Epoch=58.8] | Loss=0.00102 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.713 | L2-Norm(final)=2.843 | 3561.2 samples/s | 55.6 steps/s
[Step=6250 Epoch=59.2] | Loss=0.00095 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.710 | L2-Norm(final)=2.843 | 1632.8 samples/s | 25.5 steps/s
[Step=6300 Epoch=59.7] | Loss=0.00088 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.708 | L2-Norm(final)=2.844 | 3595.6 samples/s | 56.2 steps/s
[Step=6350 Epoch=60.2] | Loss=0.00083 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.706 | L2-Norm(final)=2.844 | 1651.7 samples/s | 25.8 steps/s
[Step=6400 Epoch=60.6] | Loss=0.00078 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.705 | L2-Norm(final)=2.845 | 3615.6 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step6400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=113.1] | Loss=0.11835 | Reg=0.00353 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.787 | L2-Norm(final)=2.831 | 3251.0 samples/s | 50.8 steps/s
[Step=12050 Epoch=113.5] | Loss=0.01131 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.756 | L2-Norm(final)=2.828 | 3490.6 samples/s | 54.5 steps/s
[Step=12100 Epoch=114.0] | Loss=0.00610 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.747 | L2-Norm(final)=2.830 | 4494.6 samples/s | 70.2 steps/s
[Step=12150 Epoch=114.5] | Loss=0.00413 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.740 | L2-Norm(final)=2.832 | 1495.8 samples/s | 23.4 steps/s
[Step=12200 Epoch=115.0] | Loss=0.00315 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.735 | L2-Norm(final)=2.834 | 4197.6 samples/s | 65.6 steps/s
[Step=12250 Epoch=115.4] | Loss=0.00253 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.731 | L2-Norm(final)=2.836 | 1550.4 samples/s | 24.2 steps/s
[Step=12300 Epoch=115.9] | Loss=0.00212 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.727 | L2-Norm(final)=2.837 | 3938.5 samples/s | 61.5 steps/s
[Step=12350 Epoch=116.4] | Loss=0.00183 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.724 | L2-Norm(final)=2.838 | 1574.8 samples/s | 24.6 steps/s
[Step=12400 Epoch=116.8] | Loss=0.00161 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.721 | L2-Norm(final)=2.839 | 3736.3 samples/s | 58.4 steps/s
[Step=12450 Epoch=117.3] | Loss=0.00143 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.718 | L2-Norm(final)=2.839 | 1609.8 samples/s | 25.2 steps/s
[Step=12500 Epoch=117.8] | Loss=0.00130 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.715 | L2-Norm(final)=2.840 | 3579.5 samples/s | 55.9 steps/s
[Step=12550 Epoch=118.3] | Loss=0.00118 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.713 | L2-Norm(final)=2.841 | 1642.9 samples/s | 25.7 steps/s
[Step=12600 Epoch=118.7] | Loss=0.00109 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.710 | L2-Norm(final)=2.842 | 3618.7 samples/s | 56.5 steps/s
[Step=12650 Epoch=119.2] | Loss=0.00101 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.708 | L2-Norm(final)=2.842 | 1646.2 samples/s | 25.7 steps/s
[Step=12700 Epoch=119.7] | Loss=0.00094 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.706 | L2-Norm(final)=2.843 | 3557.2 samples/s | 55.6 steps/s
[Step=12750 Epoch=120.1] | Loss=0.00088 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.704 | L2-Norm(final)=2.843 | 1708.1 samples/s | 26.7 steps/s
[Step=12800 Epoch=120.6] | Loss=0.00083 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.702 | L2-Norm(final)=2.844 | 3322.4 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step12800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=99.1] | Loss=0.17024 | Reg=0.00353 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.787 | L2-Norm(final)=2.831 | 3350.4 samples/s | 52.3 steps/s
[Step=10450 Epoch=99.6] | Loss=0.01092 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.756 | L2-Norm(final)=2.827 | 3296.4 samples/s | 51.5 steps/s
[Step=10500 Epoch=100.1] | Loss=0.00593 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.747 | L2-Norm(final)=2.829 | 4536.8 samples/s | 70.9 steps/s
[Step=10550 Epoch=100.6] | Loss=0.00401 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.740 | L2-Norm(final)=2.831 | 1499.5 samples/s | 23.4 steps/s
[Step=10600 Epoch=101.0] | Loss=0.00303 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.734 | L2-Norm(final)=2.833 | 4329.2 samples/s | 67.6 steps/s
[Step=10650 Epoch=101.5] | Loss=0.00244 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.730 | L2-Norm(final)=2.834 | 1514.4 samples/s | 23.7 steps/s
[Step=10700 Epoch=102.0] | Loss=0.00205 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.726 | L2-Norm(final)=2.835 | 4106.2 samples/s | 64.2 steps/s
[Step=10750 Epoch=102.5] | Loss=0.00176 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.722 | L2-Norm(final)=2.836 | 1548.5 samples/s | 24.2 steps/s
[Step=10800 Epoch=102.9] | Loss=0.00155 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.719 | L2-Norm(final)=2.837 | 3944.3 samples/s | 61.6 steps/s
[Step=10850 Epoch=103.4] | Loss=0.00138 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.716 | L2-Norm(final)=2.837 | 1552.7 samples/s | 24.3 steps/s
[Step=10900 Epoch=103.9] | Loss=0.00125 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.713 | L2-Norm(final)=2.838 | 3788.3 samples/s | 59.2 steps/s
[Step=10950 Epoch=104.4] | Loss=0.00114 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.711 | L2-Norm(final)=2.839 | 1593.3 samples/s | 24.9 steps/s
[Step=11000 Epoch=104.8] | Loss=0.00105 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.708 | L2-Norm(final)=2.839 | 3663.0 samples/s | 57.2 steps/s
[Step=11050 Epoch=105.3] | Loss=0.00097 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.706 | L2-Norm(final)=2.840 | 1624.9 samples/s | 25.4 steps/s
[Step=11100 Epoch=105.8] | Loss=0.00091 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.704 | L2-Norm(final)=2.840 | 3604.3 samples/s | 56.3 steps/s
[Step=11150 Epoch=106.3] | Loss=0.00085 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.702 | L2-Norm(final)=2.841 | 1617.1 samples/s | 25.3 steps/s
[Step=11200 Epoch=106.7] | Loss=0.00080 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.700 | L2-Norm(final)=2.841 | 3587.0 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27514 | acc=0.8195 | tpr=0.7435 | fpr=0.0156 | 3759.8 samples/s | 14.7 steps/s
Avg test loss: 0.28463, Avg test acc: 0.81753, Avg tpr: 0.74302, Avg fpr: 0.01859, total FA: 145

Testing server on iccad2012
[Step=  50] | Loss=0.43237 | acc=0.7759 | tpr=0.9690 | fpr=0.2275 | 3759.2 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.43821 | acc=0.7741 | tpr=0.9787 | fpr=0.2297 | 7309.2 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.44281 | acc=0.7728 | tpr=0.9827 | fpr=0.2311 | 7546.1 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.44738 | acc=0.7721 | tpr=0.9825 | fpr=0.2318 | 7155.5 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.44838 | acc=0.7714 | tpr=0.9817 | fpr=0.2324 | 7246.3 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.44876 | acc=0.7710 | tpr=0.9825 | fpr=0.2329 | 7458.4 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.45010 | acc=0.7708 | tpr=0.9818 | fpr=0.2330 | 7308.3 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.45132 | acc=0.7706 | tpr=0.9809 | fpr=0.2332 | 7527.2 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.45103 | acc=0.7712 | tpr=0.9810 | fpr=0.2327 | 7102.0 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.45167 | acc=0.7706 | tpr=0.9806 | fpr=0.2332 | 7330.8 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.45112 | acc=0.7710 | tpr=0.9793 | fpr=0.2328 | 13051.7 samples/s | 51.0 steps/s
Avg test loss: 0.45075, Avg test acc: 0.77108, Avg tpr: 0.97900, Avg fpr: 0.23270, total FA: 32310

server round 21/50

clients selected: [0 2 3 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=5601 Epoch=27.3] | Loss=0.13355 | Reg=0.00352 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.758 | L2-Norm(final)=2.855 | 3400.2 samples/s | 53.1 steps/s
[Step=5650 Epoch=27.6] | Loss=0.04153 | Reg=0.00351 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.736 | L2-Norm(final)=2.847 | 3590.9 samples/s | 56.1 steps/s
[Step=5700 Epoch=27.8] | Loss=0.03400 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.728 | L2-Norm(final)=2.844 | 3753.7 samples/s | 58.7 steps/s
[Step=5750 Epoch=28.0] | Loss=0.02918 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.725 | L2-Norm(final)=2.844 | 3771.2 samples/s | 58.9 steps/s
[Step=5800 Epoch=28.3] | Loss=0.02715 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.723 | L2-Norm(final)=2.845 | 4709.1 samples/s | 73.6 steps/s
[Step=5850 Epoch=28.5] | Loss=0.02338 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.721 | L2-Norm(final)=2.847 | 1556.1 samples/s | 24.3 steps/s
[Step=5900 Epoch=28.8] | Loss=0.02073 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.721 | L2-Norm(final)=2.850 | 3752.8 samples/s | 58.6 steps/s
[Step=5950 Epoch=29.0] | Loss=0.01944 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.722 | L2-Norm(final)=2.853 | 3764.5 samples/s | 58.8 steps/s
[Step=6000 Epoch=29.3] | Loss=0.01816 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.723 | L2-Norm(final)=2.857 | 4460.4 samples/s | 69.7 steps/s
[Step=6050 Epoch=29.5] | Loss=0.01668 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.724 | L2-Norm(final)=2.860 | 1579.4 samples/s | 24.7 steps/s
[Step=6100 Epoch=29.7] | Loss=0.01578 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.725 | L2-Norm(final)=2.864 | 3781.8 samples/s | 59.1 steps/s
[Step=6150 Epoch=30.0] | Loss=0.01489 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.726 | L2-Norm(final)=2.867 | 3782.2 samples/s | 59.1 steps/s
[Step=6200 Epoch=30.2] | Loss=0.01409 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.727 | L2-Norm(final)=2.870 | 4223.1 samples/s | 66.0 steps/s
[Step=6250 Epoch=30.5] | Loss=0.01342 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.727 | L2-Norm(final)=2.874 | 1606.4 samples/s | 25.1 steps/s
[Step=6300 Epoch=30.7] | Loss=0.01282 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.728 | L2-Norm(final)=2.877 | 3768.5 samples/s | 58.9 steps/s
[Step=6350 Epoch=31.0] | Loss=0.01257 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.729 | L2-Norm(final)=2.880 | 3772.1 samples/s | 58.9 steps/s
[Step=6400 Epoch=31.2] | Loss=0.01224 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.730 | L2-Norm(final)=2.882 | 4051.6 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step6400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=46.8] | Loss=0.10320 | Reg=0.00352 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.758 | L2-Norm(final)=2.855 | 3460.1 samples/s | 54.1 steps/s
[Step=9650 Epoch=47.0] | Loss=0.04548 | Reg=0.00351 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.733 | L2-Norm(final)=2.845 | 3506.4 samples/s | 54.8 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03735 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.725 | L2-Norm(final)=2.840 | 3721.2 samples/s | 58.1 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03184 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.721 | L2-Norm(final)=2.839 | 3770.1 samples/s | 58.9 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02869 | Reg=0.00350 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.719 | L2-Norm(final)=2.841 | 4700.6 samples/s | 73.4 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02522 | Reg=0.00350 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.720 | L2-Norm(final)=2.843 | 1559.5 samples/s | 24.4 steps/s
[Step=9900 Epoch=48.2] | Loss=0.02299 | Reg=0.00350 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.720 | L2-Norm(final)=2.846 | 3760.0 samples/s | 58.7 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02138 | Reg=0.00350 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.721 | L2-Norm(final)=2.849 | 3784.4 samples/s | 59.1 steps/s
[Step=10000 Epoch=48.7] | Loss=0.01985 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.722 | L2-Norm(final)=2.853 | 4442.3 samples/s | 69.4 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01832 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.722 | L2-Norm(final)=2.856 | 1579.1 samples/s | 24.7 steps/s
[Step=10100 Epoch=49.2] | Loss=0.01712 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.723 | L2-Norm(final)=2.860 | 3758.7 samples/s | 58.7 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01615 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.725 | L2-Norm(final)=2.863 | 3782.6 samples/s | 59.1 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01537 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.726 | L2-Norm(final)=2.867 | 4227.9 samples/s | 66.1 steps/s
[Step=10250 Epoch=49.9] | Loss=0.01492 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.727 | L2-Norm(final)=2.870 | 1598.2 samples/s | 25.0 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01418 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.728 | L2-Norm(final)=2.873 | 3770.6 samples/s | 58.9 steps/s
[Step=10350 Epoch=50.4] | Loss=0.01370 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.729 | L2-Norm(final)=2.877 | 3768.2 samples/s | 58.9 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01320 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.729 | L2-Norm(final)=2.880 | 4049.0 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step10400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=5601 Epoch=27.3] | Loss=0.35378 | Reg=0.00352 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.758 | L2-Norm(final)=2.855 | 3263.8 samples/s | 51.0 steps/s
[Step=5650 Epoch=27.6] | Loss=0.04265 | Reg=0.00351 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.739 | L2-Norm(final)=2.845 | 3692.4 samples/s | 57.7 steps/s
[Step=5700 Epoch=27.8] | Loss=0.03594 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.730 | L2-Norm(final)=2.842 | 3768.1 samples/s | 58.9 steps/s
[Step=5750 Epoch=28.0] | Loss=0.03101 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.726 | L2-Norm(final)=2.842 | 3753.4 samples/s | 58.6 steps/s
[Step=5800 Epoch=28.3] | Loss=0.02702 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.723 | L2-Norm(final)=2.842 | 4710.6 samples/s | 73.6 steps/s
[Step=5850 Epoch=28.5] | Loss=0.02332 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.722 | L2-Norm(final)=2.844 | 1547.0 samples/s | 24.2 steps/s
[Step=5900 Epoch=28.8] | Loss=0.02088 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.721 | L2-Norm(final)=2.847 | 3779.8 samples/s | 59.1 steps/s
[Step=5950 Epoch=29.0] | Loss=0.01913 | Reg=0.00350 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.721 | L2-Norm(final)=2.850 | 3777.3 samples/s | 59.0 steps/s
[Step=6000 Epoch=29.3] | Loss=0.01777 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.721 | L2-Norm(final)=2.853 | 4463.5 samples/s | 69.7 steps/s
[Step=6050 Epoch=29.5] | Loss=0.01680 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.721 | L2-Norm(final)=2.856 | 1591.4 samples/s | 24.9 steps/s
[Step=6100 Epoch=29.7] | Loss=0.01571 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.722 | L2-Norm(final)=2.859 | 3771.1 samples/s | 58.9 steps/s
[Step=6150 Epoch=30.0] | Loss=0.01498 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.722 | L2-Norm(final)=2.862 | 3782.3 samples/s | 59.1 steps/s
[Step=6200 Epoch=30.2] | Loss=0.01436 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.723 | L2-Norm(final)=2.865 | 4237.3 samples/s | 66.2 steps/s
[Step=6250 Epoch=30.5] | Loss=0.01363 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.723 | L2-Norm(final)=2.867 | 1615.8 samples/s | 25.2 steps/s
[Step=6300 Epoch=30.7] | Loss=0.01310 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.724 | L2-Norm(final)=2.870 | 3780.5 samples/s | 59.1 steps/s
[Step=6350 Epoch=31.0] | Loss=0.01268 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.725 | L2-Norm(final)=2.873 | 3784.1 samples/s | 59.1 steps/s
[Step=6400 Epoch=31.2] | Loss=0.01248 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.725 | L2-Norm(final)=2.875 | 4042.2 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step6400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=76.4] | Loss=0.09318 | Reg=0.00352 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.758 | L2-Norm(final)=2.855 | 3171.4 samples/s | 49.6 steps/s
[Step=8050 Epoch=76.9] | Loss=0.00809 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.733 | L2-Norm(final)=2.856 | 3493.9 samples/s | 54.6 steps/s
[Step=8100 Epoch=77.4] | Loss=0.00482 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.723 | L2-Norm(final)=2.857 | 4565.0 samples/s | 71.3 steps/s
[Step=8150 Epoch=77.8] | Loss=0.00333 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.715 | L2-Norm(final)=2.859 | 1490.7 samples/s | 23.3 steps/s
[Step=8200 Epoch=78.3] | Loss=0.00252 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.710 | L2-Norm(final)=2.860 | 4359.3 samples/s | 68.1 steps/s
[Step=8250 Epoch=78.8] | Loss=0.00203 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.705 | L2-Norm(final)=2.861 | 1509.7 samples/s | 23.6 steps/s
[Step=8300 Epoch=79.3] | Loss=0.00170 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.700 | L2-Norm(final)=2.862 | 4140.3 samples/s | 64.7 steps/s
[Step=8350 Epoch=79.7] | Loss=0.00146 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.697 | L2-Norm(final)=2.863 | 1537.0 samples/s | 24.0 steps/s
[Step=8400 Epoch=80.2] | Loss=0.00129 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.693 | L2-Norm(final)=2.864 | 3929.0 samples/s | 61.4 steps/s
[Step=8450 Epoch=80.7] | Loss=0.00115 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.690 | L2-Norm(final)=2.865 | 1563.5 samples/s | 24.4 steps/s
[Step=8500 Epoch=81.2] | Loss=0.00104 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.687 | L2-Norm(final)=2.865 | 3769.9 samples/s | 58.9 steps/s
[Step=8550 Epoch=81.6] | Loss=0.00095 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.685 | L2-Norm(final)=2.866 | 1590.3 samples/s | 24.8 steps/s
[Step=8600 Epoch=82.1] | Loss=0.00087 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.682 | L2-Norm(final)=2.866 | 3639.8 samples/s | 56.9 steps/s
[Step=8650 Epoch=82.6] | Loss=0.00081 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.680 | L2-Norm(final)=2.867 | 1618.8 samples/s | 25.3 steps/s
[Step=8700 Epoch=83.1] | Loss=0.00075 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.678 | L2-Norm(final)=2.867 | 3597.8 samples/s | 56.2 steps/s
[Step=8750 Epoch=83.6] | Loss=0.00071 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.676 | L2-Norm(final)=2.868 | 1609.6 samples/s | 25.1 steps/s
[Step=8800 Epoch=84.0] | Loss=0.00066 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.674 | L2-Norm(final)=2.868 | 3641.4 samples/s | 56.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step8800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=106.8] | Loss=0.08114 | Reg=0.00352 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.758 | L2-Norm(final)=2.855 | 3623.8 samples/s | 56.6 steps/s
[Step=11250 Epoch=107.2] | Loss=0.01239 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.729 | L2-Norm(final)=2.852 | 3065.1 samples/s | 47.9 steps/s
[Step=11300 Epoch=107.7] | Loss=0.00651 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.722 | L2-Norm(final)=2.854 | 4539.3 samples/s | 70.9 steps/s
[Step=11350 Epoch=108.2] | Loss=0.00439 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.716 | L2-Norm(final)=2.856 | 1491.8 samples/s | 23.3 steps/s
[Step=11400 Epoch=108.7] | Loss=0.00338 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.712 | L2-Norm(final)=2.858 | 4343.7 samples/s | 67.9 steps/s
[Step=11450 Epoch=109.1] | Loss=0.00273 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.708 | L2-Norm(final)=2.859 | 1515.0 samples/s | 23.7 steps/s
[Step=11500 Epoch=109.6] | Loss=0.00228 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.704 | L2-Norm(final)=2.860 | 4140.7 samples/s | 64.7 steps/s
[Step=11550 Epoch=110.1] | Loss=0.00197 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.701 | L2-Norm(final)=2.861 | 1543.9 samples/s | 24.1 steps/s
[Step=11600 Epoch=110.6] | Loss=0.00173 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.698 | L2-Norm(final)=2.862 | 3940.2 samples/s | 61.6 steps/s
[Step=11650 Epoch=111.0] | Loss=0.00154 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.695 | L2-Norm(final)=2.863 | 1559.0 samples/s | 24.4 steps/s
[Step=11700 Epoch=111.5] | Loss=0.00140 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.693 | L2-Norm(final)=2.864 | 3776.4 samples/s | 59.0 steps/s
[Step=11750 Epoch=112.0] | Loss=0.00127 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.690 | L2-Norm(final)=2.865 | 1582.3 samples/s | 24.7 steps/s
[Step=11800 Epoch=112.5] | Loss=0.00117 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.688 | L2-Norm(final)=2.865 | 3672.2 samples/s | 57.4 steps/s
[Step=11850 Epoch=112.9] | Loss=0.00109 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.686 | L2-Norm(final)=2.866 | 1608.9 samples/s | 25.1 steps/s
[Step=11900 Epoch=113.4] | Loss=0.00101 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.684 | L2-Norm(final)=2.866 | 3600.6 samples/s | 56.3 steps/s
[Step=11950 Epoch=113.9] | Loss=0.00095 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.682 | L2-Norm(final)=2.867 | 1619.9 samples/s | 25.3 steps/s
[Step=12000 Epoch=114.4] | Loss=0.00089 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.680 | L2-Norm(final)=2.867 | 3620.8 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29410 | acc=0.8121 | tpr=0.7323 | fpr=0.0146 | 3761.1 samples/s | 14.7 steps/s
Avg test loss: 0.30361, Avg test acc: 0.81024, Avg tpr: 0.73165, Avg fpr: 0.01692, total FA: 132

Testing server on iccad2012
[Step=  50] | Loss=0.40398 | acc=0.8001 | tpr=0.9646 | fpr=0.2029 | 3717.8 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.41105 | acc=0.7984 | tpr=0.9765 | fpr=0.2049 | 7419.5 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.41610 | acc=0.7971 | tpr=0.9813 | fpr=0.2063 | 7276.6 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.42090 | acc=0.7956 | tpr=0.9803 | fpr=0.2078 | 7444.2 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.42132 | acc=0.7951 | tpr=0.9808 | fpr=0.2083 | 7328.0 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.42176 | acc=0.7945 | tpr=0.9818 | fpr=0.2089 | 7384.2 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.42329 | acc=0.7939 | tpr=0.9812 | fpr=0.2095 | 7321.6 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.42474 | acc=0.7936 | tpr=0.9809 | fpr=0.2098 | 7544.8 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.42471 | acc=0.7939 | tpr=0.9796 | fpr=0.2095 | 7310.3 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.42530 | acc=0.7936 | tpr=0.9797 | fpr=0.2098 | 7158.0 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.42473 | acc=0.7937 | tpr=0.9789 | fpr=0.2096 | 13609.8 samples/s | 53.2 steps/s
Avg test loss: 0.42434, Avg test acc: 0.79384, Avg tpr: 0.97861, Avg fpr: 0.20952, total FA: 29091

server round 22/50

clients selected: [0 4 5 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=6401 Epoch=31.2] | Loss=0.11602 | Reg=0.00350 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.710 | L2-Norm(final)=2.880 | 3255.5 samples/s | 50.9 steps/s
[Step=6450 Epoch=31.5] | Loss=0.04194 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.694 | L2-Norm(final)=2.872 | 3756.6 samples/s | 58.7 steps/s
[Step=6500 Epoch=31.7] | Loss=0.03618 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.686 | L2-Norm(final)=2.868 | 3774.6 samples/s | 59.0 steps/s
[Step=6550 Epoch=31.9] | Loss=0.03016 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.682 | L2-Norm(final)=2.867 | 3799.7 samples/s | 59.4 steps/s
[Step=6600 Epoch=32.2] | Loss=0.02727 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.680 | L2-Norm(final)=2.868 | 4706.0 samples/s | 73.5 steps/s
[Step=6650 Epoch=32.4] | Loss=0.02410 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.680 | L2-Norm(final)=2.869 | 1554.5 samples/s | 24.3 steps/s
[Step=6700 Epoch=32.7] | Loss=0.02135 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.680 | L2-Norm(final)=2.872 | 3795.0 samples/s | 59.3 steps/s
[Step=6750 Epoch=32.9] | Loss=0.01986 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.680 | L2-Norm(final)=2.875 | 3772.0 samples/s | 58.9 steps/s
[Step=6800 Epoch=33.2] | Loss=0.01896 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.681 | L2-Norm(final)=2.878 | 4440.2 samples/s | 69.4 steps/s
[Step=6850 Epoch=33.4] | Loss=0.01763 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.682 | L2-Norm(final)=2.881 | 1577.6 samples/s | 24.6 steps/s
[Step=6900 Epoch=33.6] | Loss=0.01664 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.682 | L2-Norm(final)=2.884 | 3766.0 samples/s | 58.8 steps/s
[Step=6950 Epoch=33.9] | Loss=0.01575 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.683 | L2-Norm(final)=2.887 | 3793.4 samples/s | 59.3 steps/s
[Step=7000 Epoch=34.1] | Loss=0.01495 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.684 | L2-Norm(final)=2.890 | 4244.7 samples/s | 66.3 steps/s
[Step=7050 Epoch=34.4] | Loss=0.01457 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.685 | L2-Norm(final)=2.893 | 1593.6 samples/s | 24.9 steps/s
[Step=7100 Epoch=34.6] | Loss=0.01410 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.685 | L2-Norm(final)=2.896 | 3774.0 samples/s | 59.0 steps/s
[Step=7150 Epoch=34.9] | Loss=0.01356 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.686 | L2-Norm(final)=2.898 | 3772.8 samples/s | 58.9 steps/s
[Step=7200 Epoch=35.1] | Loss=0.01308 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.687 | L2-Norm(final)=2.901 | 4028.4 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step7200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=47.1] | Loss=0.21073 | Reg=0.00350 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.710 | L2-Norm(final)=2.880 | 3395.8 samples/s | 53.1 steps/s
[Step=9650 Epoch=47.3] | Loss=0.05246 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.698 | L2-Norm(final)=2.867 | 3507.4 samples/s | 54.8 steps/s
[Step=9700 Epoch=47.6] | Loss=0.03685 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.692 | L2-Norm(final)=2.863 | 3762.3 samples/s | 58.8 steps/s
[Step=9750 Epoch=47.8] | Loss=0.03124 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.688 | L2-Norm(final)=2.863 | 3797.9 samples/s | 59.3 steps/s
[Step=9800 Epoch=48.1] | Loss=0.02987 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.687 | L2-Norm(final)=2.864 | 4742.7 samples/s | 74.1 steps/s
[Step=9850 Epoch=48.3] | Loss=0.02584 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.687 | L2-Norm(final)=2.865 | 1536.3 samples/s | 24.0 steps/s
[Step=9900 Epoch=48.5] | Loss=0.02312 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.687 | L2-Norm(final)=2.868 | 3770.6 samples/s | 58.9 steps/s
[Step=9950 Epoch=48.8] | Loss=0.02115 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.688 | L2-Norm(final)=2.871 | 3788.0 samples/s | 59.2 steps/s
[Step=10000 Epoch=49.0] | Loss=0.01961 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.689 | L2-Norm(final)=2.874 | 4560.5 samples/s | 71.3 steps/s
[Step=10050 Epoch=49.3] | Loss=0.01816 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.689 | L2-Norm(final)=2.877 | 1381.6 samples/s | 21.6 steps/s
[Step=10100 Epoch=49.5] | Loss=0.01699 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.690 | L2-Norm(final)=2.881 | 3598.5 samples/s | 56.2 steps/s
[Step=10150 Epoch=49.8] | Loss=0.01616 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.691 | L2-Norm(final)=2.884 | 3163.9 samples/s | 49.4 steps/s
[Step=10200 Epoch=50.0] | Loss=0.01538 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.692 | L2-Norm(final)=2.887 | 4198.6 samples/s | 65.6 steps/s
[Step=10250 Epoch=50.3] | Loss=0.01466 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.693 | L2-Norm(final)=2.890 | 1552.4 samples/s | 24.3 steps/s
[Step=10300 Epoch=50.5] | Loss=0.01392 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.693 | L2-Norm(final)=2.893 | 3678.0 samples/s | 57.5 steps/s
[Step=10350 Epoch=50.8] | Loss=0.01341 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.694 | L2-Norm(final)=2.896 | 3704.0 samples/s | 57.9 steps/s
[Step=10400 Epoch=51.0] | Loss=0.01301 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.695 | L2-Norm(final)=2.899 | 4192.3 samples/s | 65.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step10400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=6401 Epoch=60.7] | Loss=0.16877 | Reg=0.00350 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.710 | L2-Norm(final)=2.880 | 3173.3 samples/s | 49.6 steps/s
[Step=6450 Epoch=61.1] | Loss=0.01504 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.684 | L2-Norm(final)=2.872 | 3486.4 samples/s | 54.5 steps/s
[Step=6500 Epoch=61.6] | Loss=0.00803 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.676 | L2-Norm(final)=2.873 | 4510.5 samples/s | 70.5 steps/s
[Step=6550 Epoch=62.1] | Loss=0.00540 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.670 | L2-Norm(final)=2.875 | 1507.4 samples/s | 23.6 steps/s
[Step=6600 Epoch=62.5] | Loss=0.00408 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.664 | L2-Norm(final)=2.876 | 4232.3 samples/s | 66.1 steps/s
[Step=6650 Epoch=63.0] | Loss=0.00328 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.660 | L2-Norm(final)=2.877 | 1524.7 samples/s | 23.8 steps/s
[Step=6700 Epoch=63.5] | Loss=0.00275 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.656 | L2-Norm(final)=2.879 | 4022.3 samples/s | 62.8 steps/s
[Step=6750 Epoch=64.0] | Loss=0.00236 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.652 | L2-Norm(final)=2.879 | 1564.7 samples/s | 24.4 steps/s
[Step=6800 Epoch=64.4] | Loss=0.00208 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.649 | L2-Norm(final)=2.880 | 3807.7 samples/s | 59.5 steps/s
[Step=6850 Epoch=64.9] | Loss=0.00185 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.646 | L2-Norm(final)=2.881 | 1590.8 samples/s | 24.9 steps/s
[Step=6900 Epoch=65.4] | Loss=0.00167 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.643 | L2-Norm(final)=2.882 | 3661.4 samples/s | 57.2 steps/s
[Step=6950 Epoch=65.9] | Loss=0.00153 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.641 | L2-Norm(final)=2.883 | 1626.8 samples/s | 25.4 steps/s
[Step=7000 Epoch=66.3] | Loss=0.00140 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.639 | L2-Norm(final)=2.883 | 3643.6 samples/s | 56.9 steps/s
[Step=7050 Epoch=66.8] | Loss=0.00130 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.636 | L2-Norm(final)=2.884 | 1625.1 samples/s | 25.4 steps/s
[Step=7100 Epoch=67.3] | Loss=0.00121 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.634 | L2-Norm(final)=2.885 | 3607.8 samples/s | 56.4 steps/s
[Step=7150 Epoch=67.8] | Loss=0.00113 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.632 | L2-Norm(final)=2.885 | 1623.8 samples/s | 25.4 steps/s
[Step=7200 Epoch=68.2] | Loss=0.00106 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.631 | L2-Norm(final)=2.886 | 3563.6 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step7200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=84.0] | Loss=0.12234 | Reg=0.00350 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.710 | L2-Norm(final)=2.880 | 3173.7 samples/s | 49.6 steps/s
[Step=8850 Epoch=84.5] | Loss=0.01178 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.678 | L2-Norm(final)=2.875 | 3478.9 samples/s | 54.4 steps/s
[Step=8900 Epoch=85.0] | Loss=0.00624 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.671 | L2-Norm(final)=2.876 | 4583.4 samples/s | 71.6 steps/s
[Step=8950 Epoch=85.5] | Loss=0.00429 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.665 | L2-Norm(final)=2.878 | 1502.4 samples/s | 23.5 steps/s
[Step=9000 Epoch=85.9] | Loss=0.00325 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.660 | L2-Norm(final)=2.879 | 4282.2 samples/s | 66.9 steps/s
[Step=9050 Epoch=86.4] | Loss=0.00261 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.656 | L2-Norm(final)=2.880 | 1516.4 samples/s | 23.7 steps/s
[Step=9100 Epoch=86.9] | Loss=0.00218 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.652 | L2-Norm(final)=2.881 | 4134.7 samples/s | 64.6 steps/s
[Step=9150 Epoch=87.4] | Loss=0.00188 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.648 | L2-Norm(final)=2.882 | 1541.1 samples/s | 24.1 steps/s
[Step=9200 Epoch=87.9] | Loss=0.00165 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.645 | L2-Norm(final)=2.882 | 3951.2 samples/s | 61.7 steps/s
[Step=9250 Epoch=88.3] | Loss=0.00147 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.643 | L2-Norm(final)=2.883 | 1570.4 samples/s | 24.5 steps/s
[Step=9300 Epoch=88.8] | Loss=0.00132 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.640 | L2-Norm(final)=2.883 | 3778.8 samples/s | 59.0 steps/s
[Step=9350 Epoch=89.3] | Loss=0.00121 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.637 | L2-Norm(final)=2.884 | 1597.6 samples/s | 25.0 steps/s
[Step=9400 Epoch=89.8] | Loss=0.00111 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.635 | L2-Norm(final)=2.884 | 3660.2 samples/s | 57.2 steps/s
[Step=9450 Epoch=90.2] | Loss=0.00103 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.633 | L2-Norm(final)=2.885 | 1615.9 samples/s | 25.2 steps/s
[Step=9500 Epoch=90.7] | Loss=0.00096 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.631 | L2-Norm(final)=2.885 | 3609.6 samples/s | 56.4 steps/s
[Step=9550 Epoch=91.2] | Loss=0.00090 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.629 | L2-Norm(final)=2.886 | 1632.4 samples/s | 25.5 steps/s
[Step=9600 Epoch=91.7] | Loss=0.00084 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.627 | L2-Norm(final)=2.886 | 3604.0 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step9600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=114.4] | Loss=0.06559 | Reg=0.00350 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.710 | L2-Norm(final)=2.880 | 3433.5 samples/s | 53.6 steps/s
[Step=12050 Epoch=114.8] | Loss=0.00766 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.678 | L2-Norm(final)=2.883 | 3368.4 samples/s | 52.6 steps/s
[Step=12100 Epoch=115.3] | Loss=0.00436 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.674 | L2-Norm(final)=2.885 | 4567.0 samples/s | 71.4 steps/s
[Step=12150 Epoch=115.8] | Loss=0.00302 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.669 | L2-Norm(final)=2.887 | 1494.4 samples/s | 23.4 steps/s
[Step=12200 Epoch=116.3] | Loss=0.00229 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.665 | L2-Norm(final)=2.889 | 4319.0 samples/s | 67.5 steps/s
[Step=12250 Epoch=116.8] | Loss=0.00184 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.661 | L2-Norm(final)=2.890 | 1515.5 samples/s | 23.7 steps/s
[Step=12300 Epoch=117.2] | Loss=0.00154 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.657 | L2-Norm(final)=2.891 | 4126.7 samples/s | 64.5 steps/s
[Step=12350 Epoch=117.7] | Loss=0.00133 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.653 | L2-Norm(final)=2.891 | 1540.9 samples/s | 24.1 steps/s
[Step=12400 Epoch=118.2] | Loss=0.00117 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.650 | L2-Norm(final)=2.892 | 3941.2 samples/s | 61.6 steps/s
[Step=12450 Epoch=118.7] | Loss=0.00104 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.647 | L2-Norm(final)=2.893 | 1553.7 samples/s | 24.3 steps/s
[Step=12500 Epoch=119.1] | Loss=0.00094 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.644 | L2-Norm(final)=2.893 | 3766.6 samples/s | 58.9 steps/s
[Step=12550 Epoch=119.6] | Loss=0.00086 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.641 | L2-Norm(final)=2.894 | 1588.4 samples/s | 24.8 steps/s
[Step=12600 Epoch=120.1] | Loss=0.00079 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.639 | L2-Norm(final)=2.894 | 3637.6 samples/s | 56.8 steps/s
[Step=12650 Epoch=120.6] | Loss=0.00073 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.636 | L2-Norm(final)=2.894 | 1635.1 samples/s | 25.5 steps/s
[Step=12700 Epoch=121.0] | Loss=0.00068 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.634 | L2-Norm(final)=2.895 | 3597.3 samples/s | 56.2 steps/s
[Step=12750 Epoch=121.5] | Loss=0.00064 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.632 | L2-Norm(final)=2.895 | 1618.4 samples/s | 25.3 steps/s
[Step=12800 Epoch=122.0] | Loss=0.00060 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.630 | L2-Norm(final)=2.895 | 3625.8 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31446 | acc=0.8020 | tpr=0.7171 | fpr=0.0136 | 3702.9 samples/s | 14.5 steps/s
Avg test loss: 0.32451, Avg test acc: 0.80111, Avg tpr: 0.71778, Avg fpr: 0.01564, total FA: 122

Testing server on iccad2012
[Step=  50] | Loss=0.38934 | acc=0.8070 | tpr=0.9779 | fpr=0.1960 | 3750.8 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.39633 | acc=0.8052 | tpr=0.9851 | fpr=0.1982 | 7320.8 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.40186 | acc=0.8035 | tpr=0.9870 | fpr=0.1998 | 7326.1 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.40680 | acc=0.8018 | tpr=0.9858 | fpr=0.2016 | 7319.1 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.40710 | acc=0.8008 | tpr=0.9852 | fpr=0.2025 | 7386.9 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.40743 | acc=0.8004 | tpr=0.9847 | fpr=0.2030 | 7384.6 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.40890 | acc=0.7998 | tpr=0.9831 | fpr=0.2036 | 7299.3 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.41041 | acc=0.7993 | tpr=0.9825 | fpr=0.2040 | 7291.6 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.41052 | acc=0.7995 | tpr=0.9805 | fpr=0.2038 | 7278.5 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.41105 | acc=0.7992 | tpr=0.9797 | fpr=0.2040 | 7298.0 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.41045 | acc=0.7995 | tpr=0.9785 | fpr=0.2038 | 13452.4 samples/s | 52.5 steps/s
Avg test loss: 0.41010, Avg test acc: 0.79951, Avg tpr: 0.97821, Avg fpr: 0.20373, total FA: 28288

server round 23/50

clients selected: [2 3 5 6 8]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=50.7] | Loss=0.25373 | Reg=0.00349 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.681 | L2-Norm(final)=2.893 | 3213.4 samples/s | 50.2 steps/s
[Step=10450 Epoch=50.9] | Loss=0.03776 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.660 | L2-Norm(final)=2.883 | 3803.1 samples/s | 59.4 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03150 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.653 | L2-Norm(final)=2.881 | 3792.2 samples/s | 59.3 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02807 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.649 | L2-Norm(final)=2.881 | 3773.8 samples/s | 59.0 steps/s
[Step=10600 Epoch=51.6] | Loss=0.02594 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.648 | L2-Norm(final)=2.882 | 4705.5 samples/s | 73.5 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02234 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.648 | L2-Norm(final)=2.885 | 1529.0 samples/s | 23.9 steps/s
[Step=10700 Epoch=52.1] | Loss=0.02016 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.648 | L2-Norm(final)=2.888 | 3774.0 samples/s | 59.0 steps/s
[Step=10750 Epoch=52.4] | Loss=0.01869 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.648 | L2-Norm(final)=2.891 | 3793.6 samples/s | 59.3 steps/s
[Step=10800 Epoch=52.6] | Loss=0.01775 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.649 | L2-Norm(final)=2.895 | 4453.3 samples/s | 69.6 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01657 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.650 | L2-Norm(final)=2.898 | 1586.6 samples/s | 24.8 steps/s
[Step=10900 Epoch=53.1] | Loss=0.01571 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.650 | L2-Norm(final)=2.901 | 3769.1 samples/s | 58.9 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01484 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.651 | L2-Norm(final)=2.904 | 3787.0 samples/s | 59.2 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01418 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.652 | L2-Norm(final)=2.907 | 4234.7 samples/s | 66.2 steps/s
[Step=11050 Epoch=53.8] | Loss=0.01347 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.652 | L2-Norm(final)=2.911 | 1609.5 samples/s | 25.1 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01280 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.653 | L2-Norm(final)=2.914 | 3766.5 samples/s | 58.9 steps/s
[Step=11150 Epoch=54.3] | Loss=0.01231 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.654 | L2-Norm(final)=2.917 | 3785.6 samples/s | 59.2 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01213 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=18.655 | L2-Norm(final)=2.920 | 4006.4 samples/s | 62.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step11200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=6401 Epoch=31.2] | Loss=0.13289 | Reg=0.00349 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.681 | L2-Norm(final)=2.893 | 3336.1 samples/s | 52.1 steps/s
[Step=6450 Epoch=31.5] | Loss=0.03540 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.663 | L2-Norm(final)=2.884 | 3674.0 samples/s | 57.4 steps/s
[Step=6500 Epoch=31.7] | Loss=0.03020 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.653 | L2-Norm(final)=2.882 | 3780.2 samples/s | 59.1 steps/s
[Step=6550 Epoch=31.9] | Loss=0.02713 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.649 | L2-Norm(final)=2.882 | 3758.6 samples/s | 58.7 steps/s
[Step=6600 Epoch=32.2] | Loss=0.02472 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.647 | L2-Norm(final)=2.883 | 4703.5 samples/s | 73.5 steps/s
[Step=6650 Epoch=32.4] | Loss=0.02194 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.646 | L2-Norm(final)=2.885 | 1557.6 samples/s | 24.3 steps/s
[Step=6700 Epoch=32.7] | Loss=0.01995 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.645 | L2-Norm(final)=2.887 | 3789.8 samples/s | 59.2 steps/s
[Step=6750 Epoch=32.9] | Loss=0.01820 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.645 | L2-Norm(final)=2.890 | 3786.1 samples/s | 59.2 steps/s
[Step=6800 Epoch=33.2] | Loss=0.01716 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.645 | L2-Norm(final)=2.893 | 4455.7 samples/s | 69.6 steps/s
[Step=6850 Epoch=33.4] | Loss=0.01586 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.646 | L2-Norm(final)=2.895 | 1581.2 samples/s | 24.7 steps/s
[Step=6900 Epoch=33.6] | Loss=0.01497 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.647 | L2-Norm(final)=2.898 | 3785.4 samples/s | 59.1 steps/s
[Step=6950 Epoch=33.9] | Loss=0.01422 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.647 | L2-Norm(final)=2.901 | 3778.4 samples/s | 59.0 steps/s
[Step=7000 Epoch=34.1] | Loss=0.01361 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.648 | L2-Norm(final)=2.904 | 4229.9 samples/s | 66.1 steps/s
[Step=7050 Epoch=34.4] | Loss=0.01318 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.648 | L2-Norm(final)=2.907 | 1617.3 samples/s | 25.3 steps/s
[Step=7100 Epoch=34.6] | Loss=0.01267 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.649 | L2-Norm(final)=2.909 | 3791.4 samples/s | 59.2 steps/s
[Step=7150 Epoch=34.9] | Loss=0.01236 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.649 | L2-Norm(final)=2.911 | 3797.9 samples/s | 59.3 steps/s
[Step=7200 Epoch=35.1] | Loss=0.01188 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.650 | L2-Norm(final)=2.914 | 4045.9 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step7200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=7201 Epoch=68.2] | Loss=0.07480 | Reg=0.00349 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.681 | L2-Norm(final)=2.893 | 3273.1 samples/s | 51.1 steps/s
[Step=7250 Epoch=68.7] | Loss=0.01395 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.653 | L2-Norm(final)=2.883 | 3395.0 samples/s | 53.0 steps/s
[Step=7300 Epoch=69.2] | Loss=0.00748 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.644 | L2-Norm(final)=2.883 | 4541.6 samples/s | 71.0 steps/s
[Step=7350 Epoch=69.6] | Loss=0.00508 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.638 | L2-Norm(final)=2.885 | 1487.4 samples/s | 23.2 steps/s
[Step=7400 Epoch=70.1] | Loss=0.00385 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.633 | L2-Norm(final)=2.886 | 4268.3 samples/s | 66.7 steps/s
[Step=7450 Epoch=70.6] | Loss=0.00309 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.629 | L2-Norm(final)=2.888 | 1527.7 samples/s | 23.9 steps/s
[Step=7500 Epoch=71.1] | Loss=0.00259 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.625 | L2-Norm(final)=2.889 | 4029.6 samples/s | 63.0 steps/s
[Step=7550 Epoch=71.5] | Loss=0.00223 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.622 | L2-Norm(final)=2.890 | 1559.6 samples/s | 24.4 steps/s
[Step=7600 Epoch=72.0] | Loss=0.00196 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.619 | L2-Norm(final)=2.891 | 3809.1 samples/s | 59.5 steps/s
[Step=7650 Epoch=72.5] | Loss=0.00175 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.617 | L2-Norm(final)=2.892 | 1580.5 samples/s | 24.7 steps/s
[Step=7700 Epoch=73.0] | Loss=0.00158 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.615 | L2-Norm(final)=2.893 | 3648.2 samples/s | 57.0 steps/s
[Step=7750 Epoch=73.4] | Loss=0.00144 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.612 | L2-Norm(final)=2.893 | 1612.3 samples/s | 25.2 steps/s
[Step=7800 Epoch=73.9] | Loss=0.00133 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.894 | 3600.4 samples/s | 56.3 steps/s
[Step=7850 Epoch=74.4] | Loss=0.00123 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.608 | L2-Norm(final)=2.895 | 1624.8 samples/s | 25.4 steps/s
[Step=7900 Epoch=74.9] | Loss=0.00114 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.607 | L2-Norm(final)=2.896 | 3600.0 samples/s | 56.3 steps/s
[Step=7950 Epoch=75.3] | Loss=0.00107 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.605 | L2-Norm(final)=2.896 | 1627.9 samples/s | 25.4 steps/s
[Step=8000 Epoch=75.8] | Loss=0.00101 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.603 | L2-Norm(final)=2.897 | 3588.7 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step8000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=83.7] | Loss=0.08647 | Reg=0.00349 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.681 | L2-Norm(final)=2.893 | 3245.2 samples/s | 50.7 steps/s
[Step=8850 Epoch=84.2] | Loss=0.01200 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.644 | L2-Norm(final)=2.885 | 3474.1 samples/s | 54.3 steps/s
[Step=8900 Epoch=84.7] | Loss=0.00648 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.637 | L2-Norm(final)=2.885 | 4541.7 samples/s | 71.0 steps/s
[Step=8950 Epoch=85.1] | Loss=0.00436 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.632 | L2-Norm(final)=2.887 | 1503.7 samples/s | 23.5 steps/s
[Step=9000 Epoch=85.6] | Loss=0.00329 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.627 | L2-Norm(final)=2.888 | 4255.1 samples/s | 66.5 steps/s
[Step=9050 Epoch=86.1] | Loss=0.00264 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.623 | L2-Norm(final)=2.889 | 1530.0 samples/s | 23.9 steps/s
[Step=9100 Epoch=86.6] | Loss=0.00221 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.619 | L2-Norm(final)=2.890 | 4048.8 samples/s | 63.3 steps/s
[Step=9150 Epoch=87.0] | Loss=0.00190 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.616 | L2-Norm(final)=2.891 | 1556.1 samples/s | 24.3 steps/s
[Step=9200 Epoch=87.5] | Loss=0.00167 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.613 | L2-Norm(final)=2.891 | 3841.8 samples/s | 60.0 steps/s
[Step=9250 Epoch=88.0] | Loss=0.00148 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.892 | 1588.0 samples/s | 24.8 steps/s
[Step=9300 Epoch=88.5] | Loss=0.00134 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.608 | L2-Norm(final)=2.893 | 3676.9 samples/s | 57.5 steps/s
[Step=9350 Epoch=88.9] | Loss=0.00122 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.605 | L2-Norm(final)=2.893 | 1626.9 samples/s | 25.4 steps/s
[Step=9400 Epoch=89.4] | Loss=0.00112 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.603 | L2-Norm(final)=2.894 | 3558.5 samples/s | 55.6 steps/s
[Step=9450 Epoch=89.9] | Loss=0.00104 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.601 | L2-Norm(final)=2.894 | 1640.5 samples/s | 25.6 steps/s
[Step=9500 Epoch=90.4] | Loss=0.00097 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.599 | L2-Norm(final)=2.895 | 3560.5 samples/s | 55.6 steps/s
[Step=9550 Epoch=90.8] | Loss=0.00090 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.597 | L2-Norm(final)=2.895 | 1641.4 samples/s | 25.6 steps/s
[Step=9600 Epoch=91.3] | Loss=0.00085 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.595 | L2-Norm(final)=2.896 | 3563.9 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step9600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12801 Epoch=120.6] | Loss=0.12529 | Reg=0.00349 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.681 | L2-Norm(final)=2.893 | 3298.1 samples/s | 51.5 steps/s
[Step=12850 Epoch=121.1] | Loss=0.01694 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.650 | L2-Norm(final)=2.882 | 3348.8 samples/s | 52.3 steps/s
[Step=12900 Epoch=121.6] | Loss=0.00968 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.643 | L2-Norm(final)=2.881 | 4492.4 samples/s | 70.2 steps/s
[Step=12950 Epoch=122.0] | Loss=0.00663 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.638 | L2-Norm(final)=2.882 | 1502.7 samples/s | 23.5 steps/s
[Step=13000 Epoch=122.5] | Loss=0.00500 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.634 | L2-Norm(final)=2.883 | 4171.6 samples/s | 65.2 steps/s
[Step=13050 Epoch=123.0] | Loss=0.00402 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.630 | L2-Norm(final)=2.884 | 1556.2 samples/s | 24.3 steps/s
[Step=13100 Epoch=123.4] | Loss=0.00336 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.626 | L2-Norm(final)=2.885 | 3936.8 samples/s | 61.5 steps/s
[Step=13150 Epoch=123.9] | Loss=0.00289 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.623 | L2-Norm(final)=2.886 | 1579.1 samples/s | 24.7 steps/s
[Step=13200 Epoch=124.4] | Loss=0.00253 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.620 | L2-Norm(final)=2.887 | 3710.8 samples/s | 58.0 steps/s
[Step=13250 Epoch=124.9] | Loss=0.00226 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.617 | L2-Norm(final)=2.888 | 1612.2 samples/s | 25.2 steps/s
[Step=13300 Epoch=125.3] | Loss=0.00204 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.614 | L2-Norm(final)=2.888 | 3599.5 samples/s | 56.2 steps/s
[Step=13350 Epoch=125.8] | Loss=0.00186 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.612 | L2-Norm(final)=2.889 | 1628.3 samples/s | 25.4 steps/s
[Step=13400 Epoch=126.3] | Loss=0.00170 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.890 | 3618.3 samples/s | 56.5 steps/s
[Step=13450 Epoch=126.7] | Loss=0.00158 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.608 | L2-Norm(final)=2.890 | 1635.8 samples/s | 25.6 steps/s
[Step=13500 Epoch=127.2] | Loss=0.00147 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.606 | L2-Norm(final)=2.891 | 3610.5 samples/s | 56.4 steps/s
[Step=13550 Epoch=127.7] | Loss=0.00137 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.604 | L2-Norm(final)=2.891 | 1689.6 samples/s | 26.4 steps/s
[Step=13600 Epoch=128.2] | Loss=0.00129 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.602 | L2-Norm(final)=2.892 | 3278.5 samples/s | 51.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32311 | acc=0.7977 | tpr=0.7114 | fpr=0.0149 | 3711.5 samples/s | 14.5 steps/s
Avg test loss: 0.33270, Avg test acc: 0.79726, Avg tpr: 0.71254, Avg fpr: 0.01641, total FA: 128

Testing server on iccad2012
[Step=  50] | Loss=0.35882 | acc=0.8270 | tpr=0.9779 | fpr=0.1757 | 3729.8 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.36543 | acc=0.8247 | tpr=0.9829 | fpr=0.1782 | 7566.0 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.37113 | acc=0.8224 | tpr=0.9856 | fpr=0.1806 | 7441.1 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.37575 | acc=0.8203 | tpr=0.9847 | fpr=0.1827 | 7317.7 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.37591 | acc=0.8193 | tpr=0.9834 | fpr=0.1837 | 7405.4 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.37569 | acc=0.8187 | tpr=0.9840 | fpr=0.1843 | 7317.6 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.37724 | acc=0.8182 | tpr=0.9831 | fpr=0.1848 | 7461.1 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.37885 | acc=0.8178 | tpr=0.9819 | fpr=0.1851 | 7449.9 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.37889 | acc=0.8182 | tpr=0.9800 | fpr=0.1847 | 7165.4 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.37936 | acc=0.8180 | tpr=0.9789 | fpr=0.1849 | 7484.4 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.37882 | acc=0.8183 | tpr=0.9777 | fpr=0.1846 | 13218.9 samples/s | 51.6 steps/s
Avg test loss: 0.37843, Avg test acc: 0.81841, Avg tpr: 0.97742, Avg fpr: 0.18448, total FA: 25615

server round 24/50

clients selected: [0 1 2 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=7201 Epoch=35.1] | Loss=0.18784 | Reg=0.00347 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.640 | L2-Norm(final)=2.912 | 3299.9 samples/s | 51.6 steps/s
[Step=7250 Epoch=35.4] | Loss=0.03743 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.626 | L2-Norm(final)=2.903 | 3709.6 samples/s | 58.0 steps/s
[Step=7300 Epoch=35.6] | Loss=0.03242 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.620 | L2-Norm(final)=2.900 | 3785.7 samples/s | 59.2 steps/s
[Step=7350 Epoch=35.8] | Loss=0.02811 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.616 | L2-Norm(final)=2.900 | 3787.7 samples/s | 59.2 steps/s
[Step=7400 Epoch=36.1] | Loss=0.02634 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.614 | L2-Norm(final)=2.902 | 4712.4 samples/s | 73.6 steps/s
[Step=7450 Epoch=36.3] | Loss=0.02328 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.612 | L2-Norm(final)=2.903 | 1559.5 samples/s | 24.4 steps/s
[Step=7500 Epoch=36.6] | Loss=0.02106 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.612 | L2-Norm(final)=2.905 | 3772.1 samples/s | 58.9 steps/s
[Step=7550 Epoch=36.8] | Loss=0.01909 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.611 | L2-Norm(final)=2.908 | 3782.0 samples/s | 59.1 steps/s
[Step=7600 Epoch=37.1] | Loss=0.01790 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.612 | L2-Norm(final)=2.911 | 4461.4 samples/s | 69.7 steps/s
[Step=7650 Epoch=37.3] | Loss=0.01671 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.612 | L2-Norm(final)=2.914 | 1555.6 samples/s | 24.3 steps/s
[Step=7700 Epoch=37.5] | Loss=0.01564 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.613 | L2-Norm(final)=2.917 | 3779.2 samples/s | 59.0 steps/s
[Step=7750 Epoch=37.8] | Loss=0.01474 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.614 | L2-Norm(final)=2.920 | 3781.9 samples/s | 59.1 steps/s
[Step=7800 Epoch=38.0] | Loss=0.01429 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.614 | L2-Norm(final)=2.923 | 4240.2 samples/s | 66.3 steps/s
[Step=7850 Epoch=38.3] | Loss=0.01361 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.615 | L2-Norm(final)=2.926 | 1610.2 samples/s | 25.2 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01303 | Reg=0.00347 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.615 | L2-Norm(final)=2.928 | 3793.2 samples/s | 59.3 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01272 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.616 | L2-Norm(final)=2.931 | 3786.8 samples/s | 59.2 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01228 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.616 | L2-Norm(final)=2.933 | 4035.5 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=6401 Epoch=31.2] | Loss=0.18816 | Reg=0.00347 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.640 | L2-Norm(final)=2.912 | 3287.1 samples/s | 51.4 steps/s
[Step=6450 Epoch=31.5] | Loss=0.03931 | Reg=0.00347 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.623 | L2-Norm(final)=2.903 | 3728.1 samples/s | 58.3 steps/s
[Step=6500 Epoch=31.7] | Loss=0.03018 | Reg=0.00347 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.615 | L2-Norm(final)=2.902 | 3782.8 samples/s | 59.1 steps/s
[Step=6550 Epoch=32.0] | Loss=0.02690 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.611 | L2-Norm(final)=2.902 | 3776.0 samples/s | 59.0 steps/s
[Step=6600 Epoch=32.2] | Loss=0.02489 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.904 | 4713.8 samples/s | 73.7 steps/s
[Step=6650 Epoch=32.4] | Loss=0.02157 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.609 | L2-Norm(final)=2.906 | 1547.1 samples/s | 24.2 steps/s
[Step=6700 Epoch=32.7] | Loss=0.01907 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.609 | L2-Norm(final)=2.909 | 3777.7 samples/s | 59.0 steps/s
[Step=6750 Epoch=32.9] | Loss=0.01750 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.610 | L2-Norm(final)=2.912 | 3786.8 samples/s | 59.2 steps/s
[Step=6800 Epoch=33.2] | Loss=0.01656 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.915 | 4504.3 samples/s | 70.4 steps/s
[Step=6850 Epoch=33.4] | Loss=0.01527 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.918 | 1562.7 samples/s | 24.4 steps/s
[Step=6900 Epoch=33.7] | Loss=0.01430 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.921 | 3768.2 samples/s | 58.9 steps/s
[Step=6950 Epoch=33.9] | Loss=0.01383 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.611 | L2-Norm(final)=2.923 | 3781.6 samples/s | 59.1 steps/s
[Step=7000 Epoch=34.2] | Loss=0.01337 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.611 | L2-Norm(final)=2.926 | 4328.5 samples/s | 67.6 steps/s
[Step=7050 Epoch=34.4] | Loss=0.01282 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.611 | L2-Norm(final)=2.928 | 1598.6 samples/s | 25.0 steps/s
[Step=7100 Epoch=34.6] | Loss=0.01235 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.612 | L2-Norm(final)=2.931 | 3740.2 samples/s | 58.4 steps/s
[Step=7150 Epoch=34.9] | Loss=0.01191 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.612 | L2-Norm(final)=2.933 | 3773.8 samples/s | 59.0 steps/s
[Step=7200 Epoch=35.1] | Loss=0.01143 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.612 | L2-Norm(final)=2.935 | 4154.3 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step7200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=54.6] | Loss=0.09582 | Reg=0.00347 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.640 | L2-Norm(final)=2.912 | 3257.9 samples/s | 50.9 steps/s
[Step=11250 Epoch=54.8] | Loss=0.04727 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.619 | L2-Norm(final)=2.894 | 3685.0 samples/s | 57.6 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03636 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.612 | L2-Norm(final)=2.891 | 3794.2 samples/s | 59.3 steps/s
[Step=11350 Epoch=55.3] | Loss=0.03195 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.610 | L2-Norm(final)=2.892 | 3790.8 samples/s | 59.2 steps/s
[Step=11400 Epoch=55.5] | Loss=0.02849 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.894 | 4667.4 samples/s | 72.9 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02471 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.897 | 1557.2 samples/s | 24.3 steps/s
[Step=11500 Epoch=56.0] | Loss=0.02193 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.611 | L2-Norm(final)=2.902 | 3775.5 samples/s | 59.0 steps/s
[Step=11550 Epoch=56.3] | Loss=0.02007 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.612 | L2-Norm(final)=2.906 | 3794.6 samples/s | 59.3 steps/s
[Step=11600 Epoch=56.5] | Loss=0.01873 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.613 | L2-Norm(final)=2.910 | 4463.9 samples/s | 69.7 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01732 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.614 | L2-Norm(final)=2.913 | 1570.2 samples/s | 24.5 steps/s
[Step=11700 Epoch=57.0] | Loss=0.01618 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.615 | L2-Norm(final)=2.917 | 3778.9 samples/s | 59.0 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01533 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.616 | L2-Norm(final)=2.921 | 3783.6 samples/s | 59.1 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01476 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.616 | L2-Norm(final)=2.924 | 4239.1 samples/s | 66.2 steps/s
[Step=11850 Epoch=57.7] | Loss=0.01415 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.617 | L2-Norm(final)=2.928 | 1613.0 samples/s | 25.2 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01362 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.618 | L2-Norm(final)=2.931 | 3792.5 samples/s | 59.3 steps/s
[Step=11950 Epoch=58.2] | Loss=0.01307 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.618 | L2-Norm(final)=2.934 | 3779.2 samples/s | 59.1 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01260 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.619 | L2-Norm(final)=2.937 | 4044.9 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step12000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=91.7] | Loss=0.07429 | Reg=0.00347 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.640 | L2-Norm(final)=2.913 | 3161.8 samples/s | 49.4 steps/s
[Step=9650 Epoch=92.2] | Loss=0.00783 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.605 | L2-Norm(final)=2.912 | 3467.6 samples/s | 54.2 steps/s
[Step=9700 Epoch=92.6] | Loss=0.00436 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.597 | L2-Norm(final)=2.915 | 4571.3 samples/s | 71.4 steps/s
[Step=9750 Epoch=93.1] | Loss=0.00307 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.592 | L2-Norm(final)=2.917 | 1492.0 samples/s | 23.3 steps/s
[Step=9800 Epoch=93.6] | Loss=0.00232 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.587 | L2-Norm(final)=2.918 | 4337.5 samples/s | 67.8 steps/s
[Step=9850 Epoch=94.1] | Loss=0.00186 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.583 | L2-Norm(final)=2.919 | 1514.6 samples/s | 23.7 steps/s
[Step=9900 Epoch=94.5] | Loss=0.00156 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.579 | L2-Norm(final)=2.920 | 4094.7 samples/s | 64.0 steps/s
[Step=9950 Epoch=95.0] | Loss=0.00134 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.576 | L2-Norm(final)=2.920 | 1545.6 samples/s | 24.2 steps/s
[Step=10000 Epoch=95.5] | Loss=0.00118 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.573 | L2-Norm(final)=2.921 | 3931.0 samples/s | 61.4 steps/s
[Step=10050 Epoch=96.0] | Loss=0.00105 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.570 | L2-Norm(final)=2.921 | 1560.8 samples/s | 24.4 steps/s
[Step=10100 Epoch=96.4] | Loss=0.00095 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.568 | L2-Norm(final)=2.922 | 3800.0 samples/s | 59.4 steps/s
[Step=10150 Epoch=96.9] | Loss=0.00087 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.565 | L2-Norm(final)=2.922 | 1591.6 samples/s | 24.9 steps/s
[Step=10200 Epoch=97.4] | Loss=0.00080 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.563 | L2-Norm(final)=2.923 | 3632.1 samples/s | 56.8 steps/s
[Step=10250 Epoch=97.9] | Loss=0.00074 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.561 | L2-Norm(final)=2.923 | 1612.4 samples/s | 25.2 steps/s
[Step=10300 Epoch=98.4] | Loss=0.00069 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.559 | L2-Norm(final)=2.923 | 3596.7 samples/s | 56.2 steps/s
[Step=10350 Epoch=98.8] | Loss=0.00064 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.557 | L2-Norm(final)=2.924 | 1624.3 samples/s | 25.4 steps/s
[Step=10400 Epoch=99.3] | Loss=0.00061 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.555 | L2-Norm(final)=2.924 | 3602.0 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step10400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=13601 Epoch=128.2] | Loss=0.15715 | Reg=0.00347 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.640 | L2-Norm(final)=2.912 | 3127.5 samples/s | 48.9 steps/s
[Step=13650 Epoch=128.6] | Loss=0.00878 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.601 | L2-Norm(final)=2.911 | 3595.7 samples/s | 56.2 steps/s
[Step=13700 Epoch=129.1] | Loss=0.00526 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.593 | L2-Norm(final)=2.912 | 4504.5 samples/s | 70.4 steps/s
[Step=13750 Epoch=129.6] | Loss=0.00369 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.587 | L2-Norm(final)=2.913 | 1501.9 samples/s | 23.5 steps/s
[Step=13800 Epoch=130.0] | Loss=0.00280 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.582 | L2-Norm(final)=2.914 | 4165.7 samples/s | 65.1 steps/s
[Step=13850 Epoch=130.5] | Loss=0.00225 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.579 | L2-Norm(final)=2.915 | 1522.8 samples/s | 23.8 steps/s
[Step=13900 Epoch=131.0] | Loss=0.00189 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.575 | L2-Norm(final)=2.916 | 3938.5 samples/s | 61.5 steps/s
[Step=13950 Epoch=131.4] | Loss=0.00163 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.572 | L2-Norm(final)=2.917 | 1571.3 samples/s | 24.6 steps/s
[Step=14000 Epoch=131.9] | Loss=0.00143 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.569 | L2-Norm(final)=2.917 | 3708.1 samples/s | 57.9 steps/s
[Step=14050 Epoch=132.4] | Loss=0.00128 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.567 | L2-Norm(final)=2.918 | 1607.0 samples/s | 25.1 steps/s
[Step=14100 Epoch=132.9] | Loss=0.00115 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.564 | L2-Norm(final)=2.919 | 3616.0 samples/s | 56.5 steps/s
[Step=14150 Epoch=133.3] | Loss=0.00105 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.562 | L2-Norm(final)=2.919 | 1625.5 samples/s | 25.4 steps/s
[Step=14200 Epoch=133.8] | Loss=0.00097 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.560 | L2-Norm(final)=2.920 | 3600.8 samples/s | 56.3 steps/s
[Step=14250 Epoch=134.3] | Loss=0.00090 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.558 | L2-Norm(final)=2.920 | 1633.3 samples/s | 25.5 steps/s
[Step=14300 Epoch=134.7] | Loss=0.00084 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.556 | L2-Norm(final)=2.921 | 3599.4 samples/s | 56.2 steps/s
[Step=14350 Epoch=135.2] | Loss=0.00078 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.554 | L2-Norm(final)=2.921 | 1693.5 samples/s | 26.5 steps/s
[Step=14400 Epoch=135.7] | Loss=0.00074 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.553 | L2-Norm(final)=2.922 | 3267.1 samples/s | 51.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33015 | acc=0.7981 | tpr=0.7118 | fpr=0.0144 | 3739.2 samples/s | 14.6 steps/s
Avg test loss: 0.34047, Avg test acc: 0.79686, Avg tpr: 0.71178, Avg fpr: 0.01602, total FA: 125

Testing server on iccad2012
[Step=  50] | Loss=0.36166 | acc=0.8320 | tpr=0.9779 | fpr=0.1707 | 3703.8 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.36861 | acc=0.8292 | tpr=0.9829 | fpr=0.1737 | 7380.7 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.37467 | acc=0.8274 | tpr=0.9856 | fpr=0.1755 | 7757.7 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.37976 | acc=0.8254 | tpr=0.9836 | fpr=0.1775 | 7009.8 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.37966 | acc=0.8246 | tpr=0.9825 | fpr=0.1783 | 7385.1 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.37927 | acc=0.8243 | tpr=0.9833 | fpr=0.1786 | 7369.5 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.38097 | acc=0.8239 | tpr=0.9825 | fpr=0.1790 | 7493.7 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.38271 | acc=0.8237 | tpr=0.9809 | fpr=0.1792 | 7381.4 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.38278 | acc=0.8239 | tpr=0.9796 | fpr=0.1789 | 7173.4 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.38338 | acc=0.8237 | tpr=0.9789 | fpr=0.1791 | 7169.1 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.38290 | acc=0.8238 | tpr=0.9777 | fpr=0.1790 | 13630.9 samples/s | 53.2 steps/s
Avg test loss: 0.38246, Avg test acc: 0.82385, Avg tpr: 0.97742, Avg fpr: 0.17894, total FA: 24846

server round 25/50

clients selected: [3 4 5 6 8]

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=7201 Epoch=35.1] | Loss=0.32442 | Reg=0.00346 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=18.588 | L2-Norm(final)=2.937 | 3312.6 samples/s | 51.8 steps/s
[Step=7250 Epoch=35.4] | Loss=0.04690 | Reg=0.00345 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.569 | L2-Norm(final)=2.922 | 3701.3 samples/s | 57.8 steps/s
[Step=7300 Epoch=35.6] | Loss=0.03515 | Reg=0.00345 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.562 | L2-Norm(final)=2.918 | 3788.1 samples/s | 59.2 steps/s
[Step=7350 Epoch=35.8] | Loss=0.03060 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.558 | L2-Norm(final)=2.917 | 3801.2 samples/s | 59.4 steps/s
[Step=7400 Epoch=36.1] | Loss=0.02618 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.556 | L2-Norm(final)=2.918 | 4694.5 samples/s | 73.4 steps/s
[Step=7450 Epoch=36.3] | Loss=0.02294 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.555 | L2-Norm(final)=2.920 | 1555.4 samples/s | 24.3 steps/s
[Step=7500 Epoch=36.6] | Loss=0.02022 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.555 | L2-Norm(final)=2.923 | 3791.9 samples/s | 59.2 steps/s
[Step=7550 Epoch=36.8] | Loss=0.01842 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.555 | L2-Norm(final)=2.926 | 3775.4 samples/s | 59.0 steps/s
[Step=7600 Epoch=37.1] | Loss=0.01732 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.555 | L2-Norm(final)=2.929 | 4458.5 samples/s | 69.7 steps/s
[Step=7650 Epoch=37.3] | Loss=0.01619 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.555 | L2-Norm(final)=2.931 | 1586.5 samples/s | 24.8 steps/s
[Step=7700 Epoch=37.5] | Loss=0.01519 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.555 | L2-Norm(final)=2.934 | 3756.1 samples/s | 58.7 steps/s
[Step=7750 Epoch=37.8] | Loss=0.01432 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.555 | L2-Norm(final)=2.937 | 3763.0 samples/s | 58.8 steps/s
[Step=7800 Epoch=38.0] | Loss=0.01372 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.555 | L2-Norm(final)=2.939 | 4233.3 samples/s | 66.1 steps/s
[Step=7850 Epoch=38.3] | Loss=0.01303 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.556 | L2-Norm(final)=2.942 | 1614.1 samples/s | 25.2 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01263 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.556 | L2-Norm(final)=2.944 | 3783.3 samples/s | 59.1 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01213 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.556 | L2-Norm(final)=2.947 | 3773.2 samples/s | 59.0 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01165 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.556 | L2-Norm(final)=2.949 | 4016.8 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step8000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=51.0] | Loss=0.10715 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.588 | L2-Norm(final)=2.937 | 3591.2 samples/s | 56.1 steps/s
[Step=10450 Epoch=51.2] | Loss=0.03390 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.569 | L2-Norm(final)=2.929 | 3703.4 samples/s | 57.9 steps/s
[Step=10500 Epoch=51.5] | Loss=0.03054 | Reg=0.00345 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.562 | L2-Norm(final)=2.926 | 3775.6 samples/s | 59.0 steps/s
[Step=10550 Epoch=51.7] | Loss=0.02661 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.560 | L2-Norm(final)=2.925 | 3787.4 samples/s | 59.2 steps/s
[Step=10600 Epoch=52.0] | Loss=0.02478 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.559 | L2-Norm(final)=2.926 | 4751.3 samples/s | 74.2 steps/s
[Step=10650 Epoch=52.2] | Loss=0.02206 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.558 | L2-Norm(final)=2.928 | 1536.7 samples/s | 24.0 steps/s
[Step=10700 Epoch=52.5] | Loss=0.01959 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.559 | L2-Norm(final)=2.930 | 3783.3 samples/s | 59.1 steps/s
[Step=10750 Epoch=52.7] | Loss=0.01811 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.559 | L2-Norm(final)=2.933 | 3778.0 samples/s | 59.0 steps/s
[Step=10800 Epoch=53.0] | Loss=0.01700 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.560 | L2-Norm(final)=2.936 | 4587.5 samples/s | 71.7 steps/s
[Step=10850 Epoch=53.2] | Loss=0.01580 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.560 | L2-Norm(final)=2.939 | 1561.8 samples/s | 24.4 steps/s
[Step=10900 Epoch=53.5] | Loss=0.01480 | Reg=0.00345 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.561 | L2-Norm(final)=2.942 | 3762.1 samples/s | 58.8 steps/s
[Step=10950 Epoch=53.7] | Loss=0.01388 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.562 | L2-Norm(final)=2.945 | 3771.1 samples/s | 58.9 steps/s
[Step=11000 Epoch=53.9] | Loss=0.01337 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.563 | L2-Norm(final)=2.947 | 4422.5 samples/s | 69.1 steps/s
[Step=11050 Epoch=54.2] | Loss=0.01272 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.563 | L2-Norm(final)=2.950 | 1579.9 samples/s | 24.7 steps/s
[Step=11100 Epoch=54.4] | Loss=0.01233 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.564 | L2-Norm(final)=2.953 | 3755.7 samples/s | 58.7 steps/s
[Step=11150 Epoch=54.7] | Loss=0.01198 | Reg=0.00345 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.564 | L2-Norm(final)=2.955 | 3781.5 samples/s | 59.1 steps/s
[Step=11200 Epoch=54.9] | Loss=0.01159 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.565 | L2-Norm(final)=2.957 | 4273.8 samples/s | 66.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step11200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=75.8] | Loss=0.10258 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.588 | L2-Norm(final)=2.937 | 3080.0 samples/s | 48.1 steps/s
[Step=8050 Epoch=76.3] | Loss=0.00876 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.549 | L2-Norm(final)=2.935 | 3608.6 samples/s | 56.4 steps/s
[Step=8100 Epoch=76.8] | Loss=0.00459 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.541 | L2-Norm(final)=2.937 | 4517.2 samples/s | 70.6 steps/s
[Step=8150 Epoch=77.2] | Loss=0.00315 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.534 | L2-Norm(final)=2.939 | 1496.6 samples/s | 23.4 steps/s
[Step=8200 Epoch=77.7] | Loss=0.00238 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.529 | L2-Norm(final)=2.940 | 4262.9 samples/s | 66.6 steps/s
[Step=8250 Epoch=78.2] | Loss=0.00192 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.525 | L2-Norm(final)=2.941 | 1525.8 samples/s | 23.8 steps/s
[Step=8300 Epoch=78.6] | Loss=0.00160 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.521 | L2-Norm(final)=2.942 | 4003.7 samples/s | 62.6 steps/s
[Step=8350 Epoch=79.1] | Loss=0.00138 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.518 | L2-Norm(final)=2.943 | 1568.6 samples/s | 24.5 steps/s
[Step=8400 Epoch=79.6] | Loss=0.00121 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.515 | L2-Norm(final)=2.944 | 3826.0 samples/s | 59.8 steps/s
[Step=8450 Epoch=80.1] | Loss=0.00108 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.512 | L2-Norm(final)=2.944 | 1574.2 samples/s | 24.6 steps/s
[Step=8500 Epoch=80.5] | Loss=0.00098 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.510 | L2-Norm(final)=2.945 | 3671.1 samples/s | 57.4 steps/s
[Step=8550 Epoch=81.0] | Loss=0.00089 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.508 | L2-Norm(final)=2.945 | 1613.2 samples/s | 25.2 steps/s
[Step=8600 Epoch=81.5] | Loss=0.00082 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.505 | L2-Norm(final)=2.946 | 3609.0 samples/s | 56.4 steps/s
[Step=8650 Epoch=82.0] | Loss=0.00076 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.503 | L2-Norm(final)=2.946 | 1624.7 samples/s | 25.4 steps/s
[Step=8700 Epoch=82.4] | Loss=0.00071 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.501 | L2-Norm(final)=2.947 | 3618.1 samples/s | 56.5 steps/s
[Step=8750 Epoch=82.9] | Loss=0.00066 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.500 | L2-Norm(final)=2.947 | 1644.6 samples/s | 25.7 steps/s
[Step=8800 Epoch=83.4] | Loss=0.00062 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.498 | L2-Norm(final)=2.947 | 3564.3 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step8800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=91.3] | Loss=0.09683 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.588 | L2-Norm(final)=2.937 | 3084.0 samples/s | 48.2 steps/s
[Step=9650 Epoch=91.8] | Loss=0.01677 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.558 | L2-Norm(final)=2.930 | 3603.6 samples/s | 56.3 steps/s
[Step=9700 Epoch=92.3] | Loss=0.00895 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.553 | L2-Norm(final)=2.927 | 4514.8 samples/s | 70.5 steps/s
[Step=9750 Epoch=92.7] | Loss=0.00604 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.549 | L2-Norm(final)=2.928 | 1501.9 samples/s | 23.5 steps/s
[Step=9800 Epoch=93.2] | Loss=0.00455 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.544 | L2-Norm(final)=2.929 | 4260.5 samples/s | 66.6 steps/s
[Step=9850 Epoch=93.7] | Loss=0.00365 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.540 | L2-Norm(final)=2.930 | 1525.4 samples/s | 23.8 steps/s
[Step=9900 Epoch=94.2] | Loss=0.00306 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.537 | L2-Norm(final)=2.931 | 4025.5 samples/s | 62.9 steps/s
[Step=9950 Epoch=94.6] | Loss=0.00263 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.534 | L2-Norm(final)=2.932 | 1558.2 samples/s | 24.3 steps/s
[Step=10000 Epoch=95.1] | Loss=0.00230 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.531 | L2-Norm(final)=2.933 | 3808.0 samples/s | 59.5 steps/s
[Step=10050 Epoch=95.6] | Loss=0.00205 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.528 | L2-Norm(final)=2.934 | 1590.2 samples/s | 24.8 steps/s
[Step=10100 Epoch=96.1] | Loss=0.00185 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.525 | L2-Norm(final)=2.934 | 3684.9 samples/s | 57.6 steps/s
[Step=10150 Epoch=96.6] | Loss=0.00169 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.523 | L2-Norm(final)=2.935 | 1628.0 samples/s | 25.4 steps/s
[Step=10200 Epoch=97.0] | Loss=0.00155 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.521 | L2-Norm(final)=2.936 | 3620.2 samples/s | 56.6 steps/s
[Step=10250 Epoch=97.5] | Loss=0.00143 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.518 | L2-Norm(final)=2.936 | 1607.9 samples/s | 25.1 steps/s
[Step=10300 Epoch=98.0] | Loss=0.00133 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.516 | L2-Norm(final)=2.937 | 3631.0 samples/s | 56.7 steps/s
[Step=10350 Epoch=98.5] | Loss=0.00125 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.514 | L2-Norm(final)=2.937 | 1636.2 samples/s | 25.6 steps/s
[Step=10400 Epoch=98.9] | Loss=0.00117 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.513 | L2-Norm(final)=2.938 | 3546.6 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step10400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=14401 Epoch=135.7] | Loss=0.01523 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.588 | L2-Norm(final)=2.938 | 3283.1 samples/s | 51.3 steps/s
[Step=14450 Epoch=136.2] | Loss=0.01151 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.560 | L2-Norm(final)=2.935 | 3402.4 samples/s | 53.2 steps/s
[Step=14500 Epoch=136.6] | Loss=0.00751 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.556 | L2-Norm(final)=2.936 | 4487.7 samples/s | 70.1 steps/s
[Step=14550 Epoch=137.1] | Loss=0.00504 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.551 | L2-Norm(final)=2.936 | 1491.1 samples/s | 23.3 steps/s
[Step=14600 Epoch=137.6] | Loss=0.00380 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.546 | L2-Norm(final)=2.937 | 4200.0 samples/s | 65.6 steps/s
[Step=14650 Epoch=138.0] | Loss=0.00305 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.542 | L2-Norm(final)=2.938 | 1538.8 samples/s | 24.0 steps/s
[Step=14700 Epoch=138.5] | Loss=0.00255 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.538 | L2-Norm(final)=2.939 | 3933.6 samples/s | 61.5 steps/s
[Step=14750 Epoch=139.0] | Loss=0.00219 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.535 | L2-Norm(final)=2.939 | 1560.3 samples/s | 24.4 steps/s
[Step=14800 Epoch=139.5] | Loss=0.00192 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.532 | L2-Norm(final)=2.940 | 3740.6 samples/s | 58.4 steps/s
[Step=14850 Epoch=139.9] | Loss=0.00171 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.529 | L2-Norm(final)=2.941 | 1612.0 samples/s | 25.2 steps/s
[Step=14900 Epoch=140.4] | Loss=0.00155 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.526 | L2-Norm(final)=2.941 | 3554.9 samples/s | 55.5 steps/s
[Step=14950 Epoch=140.9] | Loss=0.00141 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.523 | L2-Norm(final)=2.942 | 1629.7 samples/s | 25.5 steps/s
[Step=15000 Epoch=141.3] | Loss=0.00129 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.521 | L2-Norm(final)=2.942 | 3606.3 samples/s | 56.3 steps/s
[Step=15050 Epoch=141.8] | Loss=0.00120 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.519 | L2-Norm(final)=2.943 | 1641.5 samples/s | 25.6 steps/s
[Step=15100 Epoch=142.3] | Loss=0.00112 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.517 | L2-Norm(final)=2.943 | 3561.4 samples/s | 55.6 steps/s
[Step=15150 Epoch=142.8] | Loss=0.00104 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.514 | L2-Norm(final)=2.943 | 1657.3 samples/s | 25.9 steps/s
[Step=15200 Epoch=143.2] | Loss=0.00098 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.513 | L2-Norm(final)=2.944 | 3423.3 samples/s | 53.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32175 | acc=0.8055 | tpr=0.7217 | fpr=0.0124 | 3730.4 samples/s | 14.6 steps/s
Avg test loss: 0.33254, Avg test acc: 0.80343, Avg tpr: 0.72070, Avg fpr: 0.01461, total FA: 114

Testing server on iccad2012
[Step=  50] | Loss=0.37209 | acc=0.8267 | tpr=0.9735 | fpr=0.1759 | 3740.9 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.37945 | acc=0.8241 | tpr=0.9808 | fpr=0.1788 | 7368.3 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.38565 | acc=0.8227 | tpr=0.9841 | fpr=0.1803 | 7420.6 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.39065 | acc=0.8207 | tpr=0.9836 | fpr=0.1823 | 7223.9 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.39050 | acc=0.8198 | tpr=0.9817 | fpr=0.1832 | 7369.8 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.39012 | acc=0.8197 | tpr=0.9825 | fpr=0.1833 | 7674.6 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.39177 | acc=0.8191 | tpr=0.9825 | fpr=0.1838 | 7550.9 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.39353 | acc=0.8191 | tpr=0.9809 | fpr=0.1839 | 7174.0 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.39360 | acc=0.8193 | tpr=0.9791 | fpr=0.1836 | 7214.9 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.39414 | acc=0.8189 | tpr=0.9784 | fpr=0.1839 | 7191.5 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.39358 | acc=0.8191 | tpr=0.9773 | fpr=0.1837 | 13611.4 samples/s | 53.2 steps/s
Avg test loss: 0.39316, Avg test acc: 0.81922, Avg tpr: 0.97702, Avg fpr: 0.18365, total FA: 25499

server round 26/50

clients selected: [0 5 6 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=39.0] | Loss=0.09602 | Reg=0.00344 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.542 | L2-Norm(final)=2.957 | 3369.6 samples/s | 52.6 steps/s
[Step=8050 Epoch=39.3] | Loss=0.04727 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.524 | L2-Norm(final)=2.943 | 3575.4 samples/s | 55.9 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03539 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.517 | L2-Norm(final)=2.938 | 3775.5 samples/s | 59.0 steps/s
[Step=8150 Epoch=39.7] | Loss=0.03026 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.514 | L2-Norm(final)=2.937 | 3762.7 samples/s | 58.8 steps/s
[Step=8200 Epoch=40.0] | Loss=0.02770 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.513 | L2-Norm(final)=2.938 | 4691.8 samples/s | 73.3 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02423 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.512 | L2-Norm(final)=2.940 | 1548.4 samples/s | 24.2 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02144 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.511 | L2-Norm(final)=2.942 | 3762.3 samples/s | 58.8 steps/s
[Step=8350 Epoch=40.7] | Loss=0.01979 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.511 | L2-Norm(final)=2.945 | 3762.0 samples/s | 58.8 steps/s
[Step=8400 Epoch=41.0] | Loss=0.01837 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.511 | L2-Norm(final)=2.947 | 4456.2 samples/s | 69.6 steps/s
[Step=8450 Epoch=41.2] | Loss=0.01730 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.512 | L2-Norm(final)=2.950 | 1588.3 samples/s | 24.8 steps/s
[Step=8500 Epoch=41.4] | Loss=0.01627 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.512 | L2-Norm(final)=2.953 | 3765.2 samples/s | 58.8 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01523 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.513 | L2-Norm(final)=2.955 | 3781.0 samples/s | 59.1 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01444 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.513 | L2-Norm(final)=2.958 | 4208.3 samples/s | 65.8 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01377 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.514 | L2-Norm(final)=2.961 | 1605.9 samples/s | 25.1 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01322 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.514 | L2-Norm(final)=2.964 | 3788.3 samples/s | 59.2 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01261 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.515 | L2-Norm(final)=2.967 | 3788.0 samples/s | 59.2 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01229 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.515 | L2-Norm(final)=2.969 | 4052.6 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step8800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=83.4] | Loss=0.09648 | Reg=0.00344 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.542 | L2-Norm(final)=2.957 | 3332.0 samples/s | 52.1 steps/s
[Step=8850 Epoch=83.9] | Loss=0.01387 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.511 | L2-Norm(final)=2.950 | 3300.7 samples/s | 51.6 steps/s
[Step=8900 Epoch=84.3] | Loss=0.00760 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.505 | L2-Norm(final)=2.948 | 4533.6 samples/s | 70.8 steps/s
[Step=8950 Epoch=84.8] | Loss=0.00513 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.500 | L2-Norm(final)=2.948 | 1509.3 samples/s | 23.6 steps/s
[Step=9000 Epoch=85.3] | Loss=0.00390 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.495 | L2-Norm(final)=2.949 | 4266.5 samples/s | 66.7 steps/s
[Step=9050 Epoch=85.8] | Loss=0.00314 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.492 | L2-Norm(final)=2.950 | 1533.3 samples/s | 24.0 steps/s
[Step=9100 Epoch=86.2] | Loss=0.00263 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.488 | L2-Norm(final)=2.950 | 4039.5 samples/s | 63.1 steps/s
[Step=9150 Epoch=86.7] | Loss=0.00226 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.485 | L2-Norm(final)=2.951 | 1549.7 samples/s | 24.2 steps/s
[Step=9200 Epoch=87.2] | Loss=0.00198 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.482 | L2-Norm(final)=2.952 | 3821.5 samples/s | 59.7 steps/s
[Step=9250 Epoch=87.7] | Loss=0.00177 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.479 | L2-Norm(final)=2.952 | 1599.8 samples/s | 25.0 steps/s
[Step=9300 Epoch=88.1] | Loss=0.00159 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.477 | L2-Norm(final)=2.953 | 3663.0 samples/s | 57.2 steps/s
[Step=9350 Epoch=88.6] | Loss=0.00145 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.475 | L2-Norm(final)=2.953 | 1641.2 samples/s | 25.6 steps/s
[Step=9400 Epoch=89.1] | Loss=0.00133 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.472 | L2-Norm(final)=2.954 | 3564.6 samples/s | 55.7 steps/s
[Step=9450 Epoch=89.5] | Loss=0.00123 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.470 | L2-Norm(final)=2.954 | 1651.4 samples/s | 25.8 steps/s
[Step=9500 Epoch=90.0] | Loss=0.00115 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.468 | L2-Norm(final)=2.955 | 3585.0 samples/s | 56.0 steps/s
[Step=9550 Epoch=90.5] | Loss=0.00107 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.466 | L2-Norm(final)=2.955 | 1652.3 samples/s | 25.8 steps/s
[Step=9600 Epoch=91.0] | Loss=0.00101 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.465 | L2-Norm(final)=2.956 | 3581.0 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step9600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=98.9] | Loss=0.16142 | Reg=0.00344 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.542 | L2-Norm(final)=2.957 | 3401.8 samples/s | 53.2 steps/s
[Step=10450 Epoch=99.4] | Loss=0.01190 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.512 | L2-Norm(final)=2.950 | 3316.9 samples/s | 51.8 steps/s
[Step=10500 Epoch=99.9] | Loss=0.00647 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.504 | L2-Norm(final)=2.951 | 4542.5 samples/s | 71.0 steps/s
[Step=10550 Epoch=100.4] | Loss=0.00446 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.499 | L2-Norm(final)=2.952 | 1511.9 samples/s | 23.6 steps/s
[Step=10600 Epoch=100.8] | Loss=0.00336 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.494 | L2-Norm(final)=2.954 | 4257.7 samples/s | 66.5 steps/s
[Step=10650 Epoch=101.3] | Loss=0.00270 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.490 | L2-Norm(final)=2.955 | 1545.9 samples/s | 24.2 steps/s
[Step=10700 Epoch=101.8] | Loss=0.00226 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.486 | L2-Norm(final)=2.956 | 4048.1 samples/s | 63.3 steps/s
[Step=10750 Epoch=102.3] | Loss=0.00194 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.483 | L2-Norm(final)=2.956 | 1580.1 samples/s | 24.7 steps/s
[Step=10800 Epoch=102.7] | Loss=0.00170 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.479 | L2-Norm(final)=2.957 | 3829.6 samples/s | 59.8 steps/s
[Step=10850 Epoch=103.2] | Loss=0.00152 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.476 | L2-Norm(final)=2.958 | 1599.5 samples/s | 25.0 steps/s
[Step=10900 Epoch=103.7] | Loss=0.00137 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.473 | L2-Norm(final)=2.958 | 3687.3 samples/s | 57.6 steps/s
[Step=10950 Epoch=104.2] | Loss=0.00125 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.471 | L2-Norm(final)=2.959 | 1633.0 samples/s | 25.5 steps/s
[Step=11000 Epoch=104.6] | Loss=0.00115 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.468 | L2-Norm(final)=2.959 | 3623.8 samples/s | 56.6 steps/s
[Step=11050 Epoch=105.1] | Loss=0.00106 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.466 | L2-Norm(final)=2.960 | 1647.1 samples/s | 25.7 steps/s
[Step=11100 Epoch=105.6] | Loss=0.00099 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.464 | L2-Norm(final)=2.960 | 3573.7 samples/s | 55.8 steps/s
[Step=11150 Epoch=106.1] | Loss=0.00092 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.462 | L2-Norm(final)=2.961 | 1657.1 samples/s | 25.9 steps/s
[Step=11200 Epoch=106.5] | Loss=0.00087 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.460 | L2-Norm(final)=2.961 | 3598.0 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step11200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=99.3] | Loss=0.15510 | Reg=0.00344 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.542 | L2-Norm(final)=2.957 | 3162.1 samples/s | 49.4 steps/s
[Step=10450 Epoch=99.8] | Loss=0.00826 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.499 | L2-Norm(final)=2.954 | 3598.9 samples/s | 56.2 steps/s
[Step=10500 Epoch=100.3] | Loss=0.00450 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.492 | L2-Norm(final)=2.957 | 4583.2 samples/s | 71.6 steps/s
[Step=10550 Epoch=100.7] | Loss=0.00302 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.487 | L2-Norm(final)=2.959 | 1509.6 samples/s | 23.6 steps/s
[Step=10600 Epoch=101.2] | Loss=0.00231 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.483 | L2-Norm(final)=2.961 | 4338.8 samples/s | 67.8 steps/s
[Step=10650 Epoch=101.7] | Loss=0.00186 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.479 | L2-Norm(final)=2.962 | 1530.2 samples/s | 23.9 steps/s
[Step=10700 Epoch=102.2] | Loss=0.00156 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.476 | L2-Norm(final)=2.963 | 4093.8 samples/s | 64.0 steps/s
[Step=10750 Epoch=102.7] | Loss=0.00134 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.472 | L2-Norm(final)=2.964 | 1561.8 samples/s | 24.4 steps/s
[Step=10800 Epoch=103.1] | Loss=0.00117 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.470 | L2-Norm(final)=2.964 | 3950.2 samples/s | 61.7 steps/s
[Step=10850 Epoch=103.6] | Loss=0.00105 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.467 | L2-Norm(final)=2.965 | 1568.1 samples/s | 24.5 steps/s
[Step=10900 Epoch=104.1] | Loss=0.00095 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.465 | L2-Norm(final)=2.965 | 3780.2 samples/s | 59.1 steps/s
[Step=10950 Epoch=104.6] | Loss=0.00086 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.462 | L2-Norm(final)=2.966 | 1602.0 samples/s | 25.0 steps/s
[Step=11000 Epoch=105.0] | Loss=0.00079 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.460 | L2-Norm(final)=2.966 | 3644.8 samples/s | 56.9 steps/s
[Step=11050 Epoch=105.5] | Loss=0.00074 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.458 | L2-Norm(final)=2.967 | 1630.1 samples/s | 25.5 steps/s
[Step=11100 Epoch=106.0] | Loss=0.00069 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.456 | L2-Norm(final)=2.967 | 3608.3 samples/s | 56.4 steps/s
[Step=11150 Epoch=106.5] | Loss=0.00064 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.454 | L2-Norm(final)=2.968 | 1633.6 samples/s | 25.5 steps/s
[Step=11200 Epoch=107.0] | Loss=0.00060 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.453 | L2-Norm(final)=2.968 | 3613.2 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step11200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=15201 Epoch=143.2] | Loss=0.11973 | Reg=0.00344 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.542 | L2-Norm(final)=2.957 | 3350.9 samples/s | 52.4 steps/s
[Step=15250 Epoch=143.7] | Loss=0.01318 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.510 | L2-Norm(final)=2.949 | 3361.3 samples/s | 52.5 steps/s
[Step=15300 Epoch=144.2] | Loss=0.00732 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.504 | L2-Norm(final)=2.948 | 4499.3 samples/s | 70.3 steps/s
[Step=15350 Epoch=144.6] | Loss=0.00497 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.499 | L2-Norm(final)=2.949 | 1518.1 samples/s | 23.7 steps/s
[Step=15400 Epoch=145.1] | Loss=0.00379 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.495 | L2-Norm(final)=2.951 | 4201.5 samples/s | 65.6 steps/s
[Step=15450 Epoch=145.6] | Loss=0.00305 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.491 | L2-Norm(final)=2.952 | 1550.1 samples/s | 24.2 steps/s
[Step=15500 Epoch=146.1] | Loss=0.00254 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.488 | L2-Norm(final)=2.953 | 3917.1 samples/s | 61.2 steps/s
[Step=15550 Epoch=146.5] | Loss=0.00219 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.484 | L2-Norm(final)=2.954 | 1590.0 samples/s | 24.8 steps/s
[Step=15600 Epoch=147.0] | Loss=0.00192 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.481 | L2-Norm(final)=2.955 | 3665.2 samples/s | 57.3 steps/s
[Step=15650 Epoch=147.5] | Loss=0.00171 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.478 | L2-Norm(final)=2.955 | 1626.6 samples/s | 25.4 steps/s
[Step=15700 Epoch=147.9] | Loss=0.00154 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.476 | L2-Norm(final)=2.956 | 3611.1 samples/s | 56.4 steps/s
[Step=15750 Epoch=148.4] | Loss=0.00140 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.473 | L2-Norm(final)=2.957 | 1656.4 samples/s | 25.9 steps/s
[Step=15800 Epoch=148.9] | Loss=0.00129 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.471 | L2-Norm(final)=2.957 | 3603.9 samples/s | 56.3 steps/s
[Step=15850 Epoch=149.4] | Loss=0.00119 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.469 | L2-Norm(final)=2.958 | 1648.0 samples/s | 25.7 steps/s
[Step=15900 Epoch=149.8] | Loss=0.00111 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.467 | L2-Norm(final)=2.958 | 3616.8 samples/s | 56.5 steps/s
[Step=15950 Epoch=150.3] | Loss=0.00104 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.465 | L2-Norm(final)=2.959 | 1700.5 samples/s | 26.6 steps/s
[Step=16000 Epoch=150.8] | Loss=0.00097 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.463 | L2-Norm(final)=2.959 | 3422.7 samples/s | 53.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32817 | acc=0.8023 | tpr=0.7168 | fpr=0.0121 | 3740.6 samples/s | 14.6 steps/s
Avg test loss: 0.33859, Avg test acc: 0.80099, Avg tpr: 0.71708, Avg fpr: 0.01449, total FA: 113

Testing server on iccad2012
[Step=  50] | Loss=0.36986 | acc=0.8301 | tpr=0.9735 | fpr=0.1725 | 3719.2 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.37633 | acc=0.8286 | tpr=0.9808 | fpr=0.1742 | 7476.1 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.38254 | acc=0.8271 | tpr=0.9841 | fpr=0.1758 | 7503.5 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.38749 | acc=0.8248 | tpr=0.9836 | fpr=0.1781 | 7199.8 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.38741 | acc=0.8242 | tpr=0.9817 | fpr=0.1787 | 7404.7 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.38709 | acc=0.8238 | tpr=0.9825 | fpr=0.1791 | 6407.7 samples/s | 25.0 steps/s
[Step= 350] | Loss=0.38884 | acc=0.8234 | tpr=0.9818 | fpr=0.1794 | 7228.1 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.39054 | acc=0.8234 | tpr=0.9809 | fpr=0.1794 | 7401.9 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.39065 | acc=0.8236 | tpr=0.9791 | fpr=0.1792 | 7260.9 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.39105 | acc=0.8233 | tpr=0.9780 | fpr=0.1795 | 5288.0 samples/s | 20.7 steps/s
[Step= 550] | Loss=0.39050 | acc=0.8235 | tpr=0.9769 | fpr=0.1793 | 14110.5 samples/s | 55.1 steps/s
Avg test loss: 0.39009, Avg test acc: 0.82360, Avg tpr: 0.97662, Avg fpr: 0.17918, total FA: 24879

server round 27/50

clients selected: [4 6 7 8 9]

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=54.9] | Loss=0.18624 | Reg=0.00343 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.507 | L2-Norm(final)=2.970 | 3267.3 samples/s | 51.1 steps/s
[Step=11250 Epoch=55.2] | Loss=0.02968 | Reg=0.00342 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.487 | L2-Norm(final)=2.965 | 3704.4 samples/s | 57.9 steps/s
[Step=11300 Epoch=55.4] | Loss=0.02762 | Reg=0.00342 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.481 | L2-Norm(final)=2.961 | 3799.0 samples/s | 59.4 steps/s
[Step=11350 Epoch=55.7] | Loss=0.02536 | Reg=0.00341 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.478 | L2-Norm(final)=2.960 | 3789.9 samples/s | 59.2 steps/s
[Step=11400 Epoch=55.9] | Loss=0.02337 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.477 | L2-Norm(final)=2.960 | 4746.6 samples/s | 74.2 steps/s
[Step=11450 Epoch=56.1] | Loss=0.02056 | Reg=0.00341 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.476 | L2-Norm(final)=2.961 | 1539.8 samples/s | 24.1 steps/s
[Step=11500 Epoch=56.4] | Loss=0.01877 | Reg=0.00341 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.477 | L2-Norm(final)=2.963 | 3791.6 samples/s | 59.2 steps/s
[Step=11550 Epoch=56.6] | Loss=0.01727 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.477 | L2-Norm(final)=2.966 | 3778.6 samples/s | 59.0 steps/s
[Step=11600 Epoch=56.9] | Loss=0.01589 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.478 | L2-Norm(final)=2.968 | 4575.4 samples/s | 71.5 steps/s
[Step=11650 Epoch=57.1] | Loss=0.01497 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.478 | L2-Norm(final)=2.971 | 1559.5 samples/s | 24.4 steps/s
[Step=11700 Epoch=57.4] | Loss=0.01401 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.479 | L2-Norm(final)=2.974 | 3770.9 samples/s | 58.9 steps/s
[Step=11750 Epoch=57.6] | Loss=0.01315 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.479 | L2-Norm(final)=2.976 | 3779.6 samples/s | 59.1 steps/s
[Step=11800 Epoch=57.9] | Loss=0.01248 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.480 | L2-Norm(final)=2.979 | 4428.0 samples/s | 69.2 steps/s
[Step=11850 Epoch=58.1] | Loss=0.01191 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.480 | L2-Norm(final)=2.982 | 1569.8 samples/s | 24.5 steps/s
[Step=11900 Epoch=58.4] | Loss=0.01145 | Reg=0.00342 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.481 | L2-Norm(final)=2.984 | 3778.9 samples/s | 59.0 steps/s
[Step=11950 Epoch=58.6] | Loss=0.01124 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.481 | L2-Norm(final)=2.987 | 3792.7 samples/s | 59.3 steps/s
[Step=12000 Epoch=58.8] | Loss=0.01098 | Reg=0.00342 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.482 | L2-Norm(final)=2.989 | 4283.5 samples/s | 66.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step12000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=106.5] | Loss=0.08956 | Reg=0.00343 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.507 | L2-Norm(final)=2.970 | 3371.9 samples/s | 52.7 steps/s
[Step=11250 Epoch=107.0] | Loss=0.01635 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.479 | L2-Norm(final)=2.960 | 3346.2 samples/s | 52.3 steps/s
[Step=11300 Epoch=107.5] | Loss=0.00863 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.475 | L2-Norm(final)=2.959 | 4539.0 samples/s | 70.9 steps/s
[Step=11350 Epoch=108.0] | Loss=0.00579 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.470 | L2-Norm(final)=2.960 | 1501.9 samples/s | 23.5 steps/s
[Step=11400 Epoch=108.4] | Loss=0.00436 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.465 | L2-Norm(final)=2.961 | 4277.2 samples/s | 66.8 steps/s
[Step=11450 Epoch=108.9] | Loss=0.00350 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.461 | L2-Norm(final)=2.962 | 1538.3 samples/s | 24.0 steps/s
[Step=11500 Epoch=109.4] | Loss=0.00293 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.458 | L2-Norm(final)=2.963 | 4040.8 samples/s | 63.1 steps/s
[Step=11550 Epoch=109.9] | Loss=0.00252 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.454 | L2-Norm(final)=2.964 | 1550.7 samples/s | 24.2 steps/s
[Step=11600 Epoch=110.3] | Loss=0.00221 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.452 | L2-Norm(final)=2.964 | 3846.5 samples/s | 60.1 steps/s
[Step=11650 Epoch=110.8] | Loss=0.00197 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.449 | L2-Norm(final)=2.965 | 1592.9 samples/s | 24.9 steps/s
[Step=11700 Epoch=111.3] | Loss=0.00178 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.446 | L2-Norm(final)=2.966 | 3641.6 samples/s | 56.9 steps/s
[Step=11750 Epoch=111.8] | Loss=0.00162 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.444 | L2-Norm(final)=2.966 | 1635.4 samples/s | 25.6 steps/s
[Step=11800 Epoch=112.2] | Loss=0.00149 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.442 | L2-Norm(final)=2.967 | 3605.1 samples/s | 56.3 steps/s
[Step=11850 Epoch=112.7] | Loss=0.00138 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.440 | L2-Norm(final)=2.967 | 1650.2 samples/s | 25.8 steps/s
[Step=11900 Epoch=113.2] | Loss=0.00128 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.438 | L2-Norm(final)=2.968 | 3605.2 samples/s | 56.3 steps/s
[Step=11950 Epoch=113.7] | Loss=0.00120 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.436 | L2-Norm(final)=2.968 | 1653.4 samples/s | 25.8 steps/s
[Step=12000 Epoch=114.1] | Loss=0.00112 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.434 | L2-Norm(final)=2.969 | 3585.5 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step12000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=107.0] | Loss=0.04443 | Reg=0.00343 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.507 | L2-Norm(final)=2.971 | 3242.1 samples/s | 50.7 steps/s
[Step=11250 Epoch=107.4] | Loss=0.00906 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.467 | L2-Norm(final)=2.968 | 3507.4 samples/s | 54.8 steps/s
[Step=11300 Epoch=107.9] | Loss=0.00511 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.462 | L2-Norm(final)=2.968 | 4549.6 samples/s | 71.1 steps/s
[Step=11350 Epoch=108.4] | Loss=0.00343 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.458 | L2-Norm(final)=2.970 | 1495.3 samples/s | 23.4 steps/s
[Step=11400 Epoch=108.9] | Loss=0.00261 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.454 | L2-Norm(final)=2.971 | 4347.4 samples/s | 67.9 steps/s
[Step=11450 Epoch=109.3] | Loss=0.00210 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.451 | L2-Norm(final)=2.971 | 1515.2 samples/s | 23.7 steps/s
[Step=11500 Epoch=109.8] | Loss=0.00175 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.447 | L2-Norm(final)=2.972 | 4117.0 samples/s | 64.3 steps/s
[Step=11550 Epoch=110.3] | Loss=0.00151 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.444 | L2-Norm(final)=2.973 | 1554.5 samples/s | 24.3 steps/s
[Step=11600 Epoch=110.8] | Loss=0.00132 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.441 | L2-Norm(final)=2.973 | 3939.3 samples/s | 61.6 steps/s
[Step=11650 Epoch=111.3] | Loss=0.00118 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.439 | L2-Norm(final)=2.974 | 1577.0 samples/s | 24.6 steps/s
[Step=11700 Epoch=111.7] | Loss=0.00106 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.436 | L2-Norm(final)=2.974 | 3758.1 samples/s | 58.7 steps/s
[Step=11750 Epoch=112.2] | Loss=0.00097 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.434 | L2-Norm(final)=2.975 | 1605.1 samples/s | 25.1 steps/s
[Step=11800 Epoch=112.7] | Loss=0.00089 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.432 | L2-Norm(final)=2.975 | 3641.6 samples/s | 56.9 steps/s
[Step=11850 Epoch=113.2] | Loss=0.00082 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.429 | L2-Norm(final)=2.976 | 1641.5 samples/s | 25.6 steps/s
[Step=11900 Epoch=113.6] | Loss=0.00077 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.427 | L2-Norm(final)=2.976 | 3608.9 samples/s | 56.4 steps/s
[Step=11950 Epoch=114.1] | Loss=0.00072 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.426 | L2-Norm(final)=2.976 | 1636.8 samples/s | 25.6 steps/s
[Step=12000 Epoch=114.6] | Loss=0.00067 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.424 | L2-Norm(final)=2.977 | 3626.5 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step12000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=150.8] | Loss=0.10279 | Reg=0.00343 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.507 | L2-Norm(final)=2.970 | 3210.3 samples/s | 50.2 steps/s
[Step=16050 Epoch=151.2] | Loss=0.00893 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.473 | L2-Norm(final)=2.971 | 3506.4 samples/s | 54.8 steps/s
[Step=16100 Epoch=151.7] | Loss=0.00491 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.468 | L2-Norm(final)=2.972 | 4496.1 samples/s | 70.3 steps/s
[Step=16150 Epoch=152.2] | Loss=0.00331 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.462 | L2-Norm(final)=2.972 | 1503.7 samples/s | 23.5 steps/s
[Step=16200 Epoch=152.7] | Loss=0.00249 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.458 | L2-Norm(final)=2.973 | 4207.4 samples/s | 65.7 steps/s
[Step=16250 Epoch=153.1] | Loss=0.00200 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.453 | L2-Norm(final)=2.974 | 1552.8 samples/s | 24.3 steps/s
[Step=16300 Epoch=153.6] | Loss=0.00168 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.449 | L2-Norm(final)=2.974 | 3924.6 samples/s | 61.3 steps/s
[Step=16350 Epoch=154.1] | Loss=0.00144 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.446 | L2-Norm(final)=2.975 | 1587.9 samples/s | 24.8 steps/s
[Step=16400 Epoch=154.5] | Loss=0.00127 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.443 | L2-Norm(final)=2.975 | 3732.8 samples/s | 58.3 steps/s
[Step=16450 Epoch=155.0] | Loss=0.00113 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.440 | L2-Norm(final)=2.975 | 1596.6 samples/s | 24.9 steps/s
[Step=16500 Epoch=155.5] | Loss=0.00102 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.437 | L2-Norm(final)=2.976 | 3625.1 samples/s | 56.6 steps/s
[Step=16550 Epoch=155.9] | Loss=0.00093 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.435 | L2-Norm(final)=2.976 | 1624.6 samples/s | 25.4 steps/s
[Step=16600 Epoch=156.4] | Loss=0.00086 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.432 | L2-Norm(final)=2.977 | 3622.0 samples/s | 56.6 steps/s
[Step=16650 Epoch=156.9] | Loss=0.00079 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.430 | L2-Norm(final)=2.977 | 1648.1 samples/s | 25.8 steps/s
[Step=16700 Epoch=157.4] | Loss=0.00074 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.428 | L2-Norm(final)=2.977 | 3577.4 samples/s | 55.9 steps/s
[Step=16750 Epoch=157.8] | Loss=0.00069 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.426 | L2-Norm(final)=2.978 | 1651.7 samples/s | 25.8 steps/s
[Step=16800 Epoch=158.3] | Loss=0.00065 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.424 | L2-Norm(final)=2.978 | 3522.2 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step16800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12801 Epoch=122.0] | Loss=0.02625 | Reg=0.00343 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.507 | L2-Norm(final)=2.970 | 3220.6 samples/s | 50.3 steps/s
[Step=12850 Epoch=122.5] | Loss=0.00782 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.472 | L2-Norm(final)=2.970 | 3482.7 samples/s | 54.4 steps/s
[Step=12900 Epoch=122.9] | Loss=0.00438 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.467 | L2-Norm(final)=2.972 | 4557.2 samples/s | 71.2 steps/s
[Step=12950 Epoch=123.4] | Loss=0.00299 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.463 | L2-Norm(final)=2.974 | 1492.6 samples/s | 23.3 steps/s
[Step=13000 Epoch=123.9] | Loss=0.00225 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.458 | L2-Norm(final)=2.976 | 4323.6 samples/s | 67.6 steps/s
[Step=13050 Epoch=124.4] | Loss=0.00181 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.454 | L2-Norm(final)=2.977 | 1134.1 samples/s | 17.7 steps/s
[Step=13100 Epoch=124.9] | Loss=0.00152 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.450 | L2-Norm(final)=2.977 | 4090.8 samples/s | 63.9 steps/s
[Step=13150 Epoch=125.3] | Loss=0.00131 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.447 | L2-Norm(final)=2.978 | 1549.5 samples/s | 24.2 steps/s
[Step=13200 Epoch=125.8] | Loss=0.00115 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.443 | L2-Norm(final)=2.979 | 3922.1 samples/s | 61.3 steps/s
[Step=13250 Epoch=126.3] | Loss=0.00103 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.441 | L2-Norm(final)=2.979 | 1566.9 samples/s | 24.5 steps/s
[Step=13300 Epoch=126.8] | Loss=0.00093 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.438 | L2-Norm(final)=2.980 | 3756.3 samples/s | 58.7 steps/s
[Step=13350 Epoch=127.2] | Loss=0.00085 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.435 | L2-Norm(final)=2.980 | 1602.1 samples/s | 25.0 steps/s
[Step=13400 Epoch=127.7] | Loss=0.00078 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.433 | L2-Norm(final)=2.981 | 3643.4 samples/s | 56.9 steps/s
[Step=13450 Epoch=128.2] | Loss=0.00072 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.431 | L2-Norm(final)=2.981 | 1611.7 samples/s | 25.2 steps/s
[Step=13500 Epoch=128.7] | Loss=0.00067 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.429 | L2-Norm(final)=2.982 | 3603.2 samples/s | 56.3 steps/s
[Step=13550 Epoch=129.1] | Loss=0.00063 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.427 | L2-Norm(final)=2.982 | 1633.7 samples/s | 25.5 steps/s
[Step=13600 Epoch=129.6] | Loss=0.00059 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.425 | L2-Norm(final)=2.982 | 3607.9 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31655 | acc=0.8065 | tpr=0.7235 | fpr=0.0134 | 3790.8 samples/s | 14.8 steps/s
Avg test loss: 0.32716, Avg test acc: 0.80571, Avg tpr: 0.72419, Avg fpr: 0.01500, total FA: 117

Testing server on iccad2012
[Step=  50] | Loss=0.38000 | acc=0.8269 | tpr=0.9690 | fpr=0.1757 | 3737.0 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.38678 | acc=0.8251 | tpr=0.9787 | fpr=0.1777 | 7428.6 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.39292 | acc=0.8234 | tpr=0.9827 | fpr=0.1795 | 7589.7 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.39782 | acc=0.8212 | tpr=0.9814 | fpr=0.1817 | 7457.4 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.39771 | acc=0.8205 | tpr=0.9808 | fpr=0.1825 | 7076.5 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.39765 | acc=0.8200 | tpr=0.9818 | fpr=0.1829 | 7508.5 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.39948 | acc=0.8198 | tpr=0.9818 | fpr=0.1831 | 7360.8 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.40132 | acc=0.8197 | tpr=0.9809 | fpr=0.1832 | 7318.9 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.40145 | acc=0.8199 | tpr=0.9791 | fpr=0.1830 | 7181.3 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.40181 | acc=0.8197 | tpr=0.9780 | fpr=0.1831 | 7248.2 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.40112 | acc=0.8199 | tpr=0.9769 | fpr=0.1829 | 13576.1 samples/s | 53.0 steps/s
Avg test loss: 0.40072, Avg test acc: 0.81997, Avg tpr: 0.97662, Avg fpr: 0.18288, total FA: 25392

server round 28/50

clients selected: [0 2 3 4 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=42.9] | Loss=0.21561 | Reg=0.00341 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.470 | L2-Norm(final)=2.985 | 3248.3 samples/s | 50.8 steps/s
[Step=8850 Epoch=43.2] | Loss=0.04227 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.452 | L2-Norm(final)=2.974 | 3739.7 samples/s | 58.4 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03167 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.445 | L2-Norm(final)=2.970 | 3782.1 samples/s | 59.1 steps/s
[Step=8950 Epoch=43.6] | Loss=0.02671 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.442 | L2-Norm(final)=2.970 | 3787.7 samples/s | 59.2 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02390 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.440 | L2-Norm(final)=2.971 | 4697.8 samples/s | 73.4 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02137 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.440 | L2-Norm(final)=2.973 | 1554.6 samples/s | 24.3 steps/s
[Step=9100 Epoch=44.4] | Loss=0.01956 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.440 | L2-Norm(final)=2.976 | 3787.2 samples/s | 59.2 steps/s
[Step=9150 Epoch=44.6] | Loss=0.01773 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.441 | L2-Norm(final)=2.979 | 3788.3 samples/s | 59.2 steps/s
[Step=9200 Epoch=44.9] | Loss=0.01642 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.442 | L2-Norm(final)=2.982 | 4470.3 samples/s | 69.8 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01535 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.442 | L2-Norm(final)=2.985 | 1571.6 samples/s | 24.6 steps/s
[Step=9300 Epoch=45.3] | Loss=0.01460 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.443 | L2-Norm(final)=2.988 | 3775.0 samples/s | 59.0 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01390 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.444 | L2-Norm(final)=2.991 | 3790.6 samples/s | 59.2 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01327 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.445 | L2-Norm(final)=2.993 | 4243.9 samples/s | 66.3 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01274 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.445 | L2-Norm(final)=2.996 | 1613.6 samples/s | 25.2 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01219 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.445 | L2-Norm(final)=2.998 | 3766.3 samples/s | 58.8 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01172 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.446 | L2-Norm(final)=3.001 | 3788.8 samples/s | 59.2 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01140 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.446 | L2-Norm(final)=3.003 | 4048.3 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step9600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=58.5] | Loss=0.21724 | Reg=0.00341 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.470 | L2-Norm(final)=2.985 | 3334.1 samples/s | 52.1 steps/s
[Step=12050 Epoch=58.7] | Loss=0.03996 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.451 | L2-Norm(final)=2.973 | 3642.3 samples/s | 56.9 steps/s
[Step=12100 Epoch=59.0] | Loss=0.03448 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.447 | L2-Norm(final)=2.971 | 3796.1 samples/s | 59.3 steps/s
[Step=12150 Epoch=59.2] | Loss=0.03046 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.445 | L2-Norm(final)=2.969 | 3781.0 samples/s | 59.1 steps/s
[Step=12200 Epoch=59.4] | Loss=0.02710 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.445 | L2-Norm(final)=2.968 | 4686.2 samples/s | 73.2 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02357 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.445 | L2-Norm(final)=2.969 | 1539.6 samples/s | 24.1 steps/s
[Step=12300 Epoch=59.9] | Loss=0.02066 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.445 | L2-Norm(final)=2.972 | 3767.0 samples/s | 58.9 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01883 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.445 | L2-Norm(final)=2.975 | 3787.5 samples/s | 59.2 steps/s
[Step=12400 Epoch=60.4] | Loss=0.01809 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.445 | L2-Norm(final)=2.977 | 4460.4 samples/s | 69.7 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01691 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.446 | L2-Norm(final)=2.980 | 1582.8 samples/s | 24.7 steps/s
[Step=12500 Epoch=60.9] | Loss=0.01617 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.446 | L2-Norm(final)=2.982 | 3749.3 samples/s | 58.6 steps/s
[Step=12550 Epoch=61.1] | Loss=0.01526 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.446 | L2-Norm(final)=2.985 | 3782.1 samples/s | 59.1 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01451 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.447 | L2-Norm(final)=2.987 | 4237.6 samples/s | 66.2 steps/s
[Step=12650 Epoch=61.6] | Loss=0.01378 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.447 | L2-Norm(final)=2.990 | 1587.4 samples/s | 24.8 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01318 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.448 | L2-Norm(final)=2.992 | 3793.0 samples/s | 59.3 steps/s
[Step=12750 Epoch=62.1] | Loss=0.01261 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.448 | L2-Norm(final)=2.995 | 3797.4 samples/s | 59.3 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01229 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.448 | L2-Norm(final)=2.997 | 4041.1 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step12800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=39.0] | Loss=0.13993 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.470 | L2-Norm(final)=2.985 | 3278.6 samples/s | 51.2 steps/s
[Step=8050 Epoch=39.3] | Loss=0.03431 | Reg=0.00341 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.454 | L2-Norm(final)=2.977 | 3706.0 samples/s | 57.9 steps/s
[Step=8100 Epoch=39.5] | Loss=0.02901 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.448 | L2-Norm(final)=2.974 | 3768.5 samples/s | 58.9 steps/s
[Step=8150 Epoch=39.7] | Loss=0.02615 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.443 | L2-Norm(final)=2.973 | 3778.5 samples/s | 59.0 steps/s
[Step=8200 Epoch=40.0] | Loss=0.02310 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.441 | L2-Norm(final)=2.973 | 4693.2 samples/s | 73.3 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02019 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.439 | L2-Norm(final)=2.974 | 1552.0 samples/s | 24.2 steps/s
[Step=8300 Epoch=40.5] | Loss=0.01810 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.439 | L2-Norm(final)=2.976 | 3786.9 samples/s | 59.2 steps/s
[Step=8350 Epoch=40.7] | Loss=0.01657 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.439 | L2-Norm(final)=2.979 | 3769.8 samples/s | 58.9 steps/s
[Step=8400 Epoch=41.0] | Loss=0.01544 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.439 | L2-Norm(final)=2.981 | 4467.8 samples/s | 69.8 steps/s
[Step=8450 Epoch=41.2] | Loss=0.01448 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.439 | L2-Norm(final)=2.984 | 1586.1 samples/s | 24.8 steps/s
[Step=8500 Epoch=41.5] | Loss=0.01370 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.440 | L2-Norm(final)=2.986 | 3782.4 samples/s | 59.1 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01300 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.440 | L2-Norm(final)=2.989 | 3771.4 samples/s | 58.9 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01250 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.440 | L2-Norm(final)=2.991 | 4234.9 samples/s | 66.2 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01209 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.440 | L2-Norm(final)=2.993 | 1616.3 samples/s | 25.3 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01158 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.440 | L2-Norm(final)=2.995 | 3766.6 samples/s | 58.9 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01113 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.440 | L2-Norm(final)=2.998 | 3760.2 samples/s | 58.8 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01066 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.441 | L2-Norm(final)=3.000 | 4036.8 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step8800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=58.9] | Loss=0.25120 | Reg=0.00341 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.470 | L2-Norm(final)=2.985 | 3081.6 samples/s | 48.1 steps/s
[Step=12050 Epoch=59.1] | Loss=0.03714 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.450 | L2-Norm(final)=2.974 | 3606.1 samples/s | 56.3 steps/s
[Step=12100 Epoch=59.3] | Loss=0.02866 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.446 | L2-Norm(final)=2.973 | 3782.1 samples/s | 59.1 steps/s
[Step=12150 Epoch=59.6] | Loss=0.02535 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.443 | L2-Norm(final)=2.974 | 3786.9 samples/s | 59.2 steps/s
[Step=12200 Epoch=59.8] | Loss=0.02257 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.442 | L2-Norm(final)=2.975 | 4749.2 samples/s | 74.2 steps/s
[Step=12250 Epoch=60.1] | Loss=0.01989 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.442 | L2-Norm(final)=2.977 | 1544.2 samples/s | 24.1 steps/s
[Step=12300 Epoch=60.3] | Loss=0.01758 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.442 | L2-Norm(final)=2.980 | 3767.4 samples/s | 58.9 steps/s
[Step=12350 Epoch=60.6] | Loss=0.01652 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.443 | L2-Norm(final)=2.983 | 3779.5 samples/s | 59.1 steps/s
[Step=12400 Epoch=60.8] | Loss=0.01554 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.444 | L2-Norm(final)=2.986 | 4585.9 samples/s | 71.7 steps/s
[Step=12450 Epoch=61.1] | Loss=0.01451 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.444 | L2-Norm(final)=2.989 | 1555.6 samples/s | 24.3 steps/s
[Step=12500 Epoch=61.3] | Loss=0.01387 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.445 | L2-Norm(final)=2.991 | 3760.6 samples/s | 58.8 steps/s
[Step=12550 Epoch=61.5] | Loss=0.01313 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.445 | L2-Norm(final)=2.994 | 3775.9 samples/s | 59.0 steps/s
[Step=12600 Epoch=61.8] | Loss=0.01263 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.446 | L2-Norm(final)=2.996 | 4412.3 samples/s | 68.9 steps/s
[Step=12650 Epoch=62.0] | Loss=0.01209 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.446 | L2-Norm(final)=2.999 | 1575.2 samples/s | 24.6 steps/s
[Step=12700 Epoch=62.3] | Loss=0.01190 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.447 | L2-Norm(final)=3.001 | 3787.3 samples/s | 59.2 steps/s
[Step=12750 Epoch=62.5] | Loss=0.01147 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.447 | L2-Norm(final)=3.003 | 3785.3 samples/s | 59.1 steps/s
[Step=12800 Epoch=62.8] | Loss=0.01092 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.447 | L2-Norm(final)=3.005 | 4258.5 samples/s | 66.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step12800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=13601 Epoch=129.6] | Loss=0.02629 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.470 | L2-Norm(final)=2.986 | 3286.5 samples/s | 51.4 steps/s
[Step=13650 Epoch=130.1] | Loss=0.00489 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.435 | L2-Norm(final)=2.986 | 3460.6 samples/s | 54.1 steps/s
[Step=13700 Epoch=130.6] | Loss=0.00292 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.427 | L2-Norm(final)=2.988 | 4575.6 samples/s | 71.5 steps/s
[Step=13750 Epoch=131.0] | Loss=0.00204 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.422 | L2-Norm(final)=2.991 | 1496.9 samples/s | 23.4 steps/s
[Step=13800 Epoch=131.5] | Loss=0.00156 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.418 | L2-Norm(final)=2.993 | 4326.8 samples/s | 67.6 steps/s
[Step=13850 Epoch=132.0] | Loss=0.00126 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.415 | L2-Norm(final)=2.994 | 1529.4 samples/s | 23.9 steps/s
[Step=13900 Epoch=132.5] | Loss=0.00105 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.411 | L2-Norm(final)=2.995 | 4131.9 samples/s | 64.6 steps/s
[Step=13950 Epoch=133.0] | Loss=0.00090 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.408 | L2-Norm(final)=2.996 | 1552.5 samples/s | 24.3 steps/s
[Step=14000 Epoch=133.4] | Loss=0.00079 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.405 | L2-Norm(final)=2.996 | 3931.5 samples/s | 61.4 steps/s
[Step=14050 Epoch=133.9] | Loss=0.00071 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.402 | L2-Norm(final)=2.997 | 1583.8 samples/s | 24.7 steps/s
[Step=14100 Epoch=134.4] | Loss=0.00064 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.399 | L2-Norm(final)=2.997 | 3793.1 samples/s | 59.3 steps/s
[Step=14150 Epoch=134.9] | Loss=0.00059 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.397 | L2-Norm(final)=2.998 | 1606.2 samples/s | 25.1 steps/s
[Step=14200 Epoch=135.3] | Loss=0.00054 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.394 | L2-Norm(final)=2.998 | 3637.3 samples/s | 56.8 steps/s
[Step=14250 Epoch=135.8] | Loss=0.00050 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.392 | L2-Norm(final)=2.998 | 1614.2 samples/s | 25.2 steps/s
[Step=14300 Epoch=136.3] | Loss=0.00047 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.390 | L2-Norm(final)=2.999 | 3591.1 samples/s | 56.1 steps/s
[Step=14350 Epoch=136.8] | Loss=0.00044 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.388 | L2-Norm(final)=2.999 | 1626.0 samples/s | 25.4 steps/s
[Step=14400 Epoch=137.2] | Loss=0.00041 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.386 | L2-Norm(final)=2.999 | 3614.2 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29887 | acc=0.8181 | tpr=0.7411 | fpr=0.0146 | 3813.1 samples/s | 14.9 steps/s
Avg test loss: 0.31001, Avg test acc: 0.81677, Avg tpr: 0.74098, Avg fpr: 0.01654, total FA: 129

Testing server on iccad2012
[Step=  50] | Loss=0.39881 | acc=0.8243 | tpr=0.9690 | fpr=0.1783 | 3719.6 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.40588 | acc=0.8228 | tpr=0.9808 | fpr=0.1801 | 7499.7 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.41202 | acc=0.8208 | tpr=0.9841 | fpr=0.1822 | 7384.3 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.41709 | acc=0.8183 | tpr=0.9836 | fpr=0.1847 | 7280.3 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.41698 | acc=0.8174 | tpr=0.9825 | fpr=0.1856 | 7387.7 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.41685 | acc=0.8172 | tpr=0.9840 | fpr=0.1858 | 7369.1 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.41874 | acc=0.8168 | tpr=0.9837 | fpr=0.1862 | 7473.1 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.42074 | acc=0.8167 | tpr=0.9819 | fpr=0.1864 | 7494.6 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.42079 | acc=0.8169 | tpr=0.9805 | fpr=0.1861 | 7183.0 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.42118 | acc=0.8165 | tpr=0.9797 | fpr=0.1864 | 7248.6 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.42043 | acc=0.8167 | tpr=0.9785 | fpr=0.1862 | 13543.8 samples/s | 52.9 steps/s
Avg test loss: 0.42001, Avg test acc: 0.81676, Avg tpr: 0.97821, Avg fpr: 0.18617, total FA: 25850

server round 29/50

clients selected: [0 3 4 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=46.8] | Loss=0.39652 | Reg=0.00340 | FP-Reg=0.000 | acc=0.7812 | L2-Norm=18.426 | L2-Norm(final)=3.001 | 3378.1 samples/s | 52.8 steps/s
[Step=9650 Epoch=47.1] | Loss=0.03986 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.405 | L2-Norm(final)=2.989 | 3602.2 samples/s | 56.3 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03151 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.398 | L2-Norm(final)=2.987 | 3781.8 samples/s | 59.1 steps/s
[Step=9750 Epoch=47.5] | Loss=0.02631 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.395 | L2-Norm(final)=2.987 | 3779.0 samples/s | 59.0 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02488 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.393 | L2-Norm(final)=2.987 | 4712.3 samples/s | 73.6 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02223 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.393 | L2-Norm(final)=2.988 | 1555.4 samples/s | 24.3 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02038 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.394 | L2-Norm(final)=2.990 | 3772.8 samples/s | 59.0 steps/s
[Step=9950 Epoch=48.5] | Loss=0.01874 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.394 | L2-Norm(final)=2.992 | 3777.9 samples/s | 59.0 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01731 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.394 | L2-Norm(final)=2.994 | 4445.1 samples/s | 69.5 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01595 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.395 | L2-Norm(final)=2.997 | 1568.3 samples/s | 24.5 steps/s
[Step=10100 Epoch=49.2] | Loss=0.01499 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.396 | L2-Norm(final)=3.000 | 3778.0 samples/s | 59.0 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01427 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.397 | L2-Norm(final)=3.002 | 3794.4 samples/s | 59.3 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01360 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.397 | L2-Norm(final)=3.005 | 4226.5 samples/s | 66.0 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01292 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.398 | L2-Norm(final)=3.008 | 1619.0 samples/s | 25.3 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01241 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.398 | L2-Norm(final)=3.010 | 3773.0 samples/s | 59.0 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01192 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.399 | L2-Norm(final)=3.013 | 3773.7 samples/s | 59.0 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01170 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.400 | L2-Norm(final)=3.015 | 4025.9 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step10400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=42.9] | Loss=0.24616 | Reg=0.00340 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=18.426 | L2-Norm(final)=3.001 | 3387.6 samples/s | 52.9 steps/s
[Step=8850 Epoch=43.2] | Loss=0.04244 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.412 | L2-Norm(final)=2.987 | 3650.9 samples/s | 57.0 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03205 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=18.405 | L2-Norm(final)=2.984 | 3772.7 samples/s | 58.9 steps/s
[Step=8950 Epoch=43.6] | Loss=0.02663 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.402 | L2-Norm(final)=2.983 | 3777.0 samples/s | 59.0 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02500 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.400 | L2-Norm(final)=2.984 | 4691.6 samples/s | 73.3 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02728 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.400 | L2-Norm(final)=2.982 | 1553.0 samples/s | 24.3 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02641 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.400 | L2-Norm(final)=2.981 | 3792.6 samples/s | 59.3 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02420 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.400 | L2-Norm(final)=2.980 | 3763.6 samples/s | 58.8 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02253 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.400 | L2-Norm(final)=2.980 | 4454.5 samples/s | 69.6 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02068 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.401 | L2-Norm(final)=2.981 | 1572.0 samples/s | 24.6 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01956 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.401 | L2-Norm(final)=2.983 | 3783.5 samples/s | 59.1 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01867 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.402 | L2-Norm(final)=2.984 | 3791.0 samples/s | 59.2 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01772 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.402 | L2-Norm(final)=2.985 | 4247.1 samples/s | 66.4 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01672 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.402 | L2-Norm(final)=2.987 | 1596.5 samples/s | 24.9 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01593 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.402 | L2-Norm(final)=2.989 | 3769.1 samples/s | 58.9 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01524 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.402 | L2-Norm(final)=2.990 | 3785.5 samples/s | 59.1 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01465 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.403 | L2-Norm(final)=2.992 | 4025.1 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step9600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12801 Epoch=62.8] | Loss=0.23774 | Reg=0.00340 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.426 | L2-Norm(final)=3.001 | 3288.7 samples/s | 51.4 steps/s
[Step=12850 Epoch=63.0] | Loss=0.03267 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.411 | L2-Norm(final)=2.996 | 3691.3 samples/s | 57.7 steps/s
[Step=12900 Epoch=63.3] | Loss=0.02770 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.407 | L2-Norm(final)=2.993 | 3775.8 samples/s | 59.0 steps/s
[Step=12950 Epoch=63.5] | Loss=0.02613 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.405 | L2-Norm(final)=2.992 | 3791.7 samples/s | 59.2 steps/s
[Step=13000 Epoch=63.7] | Loss=0.02378 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.404 | L2-Norm(final)=2.992 | 4744.8 samples/s | 74.1 steps/s
[Step=13050 Epoch=64.0] | Loss=0.02109 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=2.993 | 1547.9 samples/s | 24.2 steps/s
[Step=13100 Epoch=64.2] | Loss=0.01922 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.404 | L2-Norm(final)=2.995 | 3786.1 samples/s | 59.2 steps/s
[Step=13150 Epoch=64.5] | Loss=0.01724 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=2.997 | 3792.2 samples/s | 59.3 steps/s
[Step=13200 Epoch=64.7] | Loss=0.01598 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.404 | L2-Norm(final)=3.000 | 4587.0 samples/s | 71.7 steps/s
[Step=13250 Epoch=65.0] | Loss=0.01519 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=3.002 | 1561.7 samples/s | 24.4 steps/s
[Step=13300 Epoch=65.2] | Loss=0.01416 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=3.004 | 3765.9 samples/s | 58.8 steps/s
[Step=13350 Epoch=65.5] | Loss=0.01347 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=3.006 | 3769.8 samples/s | 58.9 steps/s
[Step=13400 Epoch=65.7] | Loss=0.01279 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=3.009 | 4433.1 samples/s | 69.3 steps/s
[Step=13450 Epoch=66.0] | Loss=0.01226 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.405 | L2-Norm(final)=3.011 | 1577.5 samples/s | 24.6 steps/s
[Step=13500 Epoch=66.2] | Loss=0.01184 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.405 | L2-Norm(final)=3.013 | 3781.0 samples/s | 59.1 steps/s
[Step=13550 Epoch=66.4] | Loss=0.01157 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=3.015 | 3772.4 samples/s | 58.9 steps/s
[Step=13600 Epoch=66.7] | Loss=0.01114 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=3.017 | 4294.1 samples/s | 67.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step13600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=158.3] | Loss=0.03337 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.426 | L2-Norm(final)=3.002 | 3242.7 samples/s | 50.7 steps/s
[Step=16850 Epoch=158.8] | Loss=0.00947 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.395 | L2-Norm(final)=2.999 | 3439.5 samples/s | 53.7 steps/s
[Step=16900 Epoch=159.2] | Loss=0.00521 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.390 | L2-Norm(final)=2.999 | 4501.7 samples/s | 70.3 steps/s
[Step=16950 Epoch=159.7] | Loss=0.00351 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.385 | L2-Norm(final)=3.000 | 1505.3 samples/s | 23.5 steps/s
[Step=17000 Epoch=160.2] | Loss=0.00265 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.380 | L2-Norm(final)=3.000 | 4191.4 samples/s | 65.5 steps/s
[Step=17050 Epoch=160.7] | Loss=0.00212 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.376 | L2-Norm(final)=3.001 | 1553.1 samples/s | 24.3 steps/s
[Step=17100 Epoch=161.1] | Loss=0.00177 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.372 | L2-Norm(final)=3.001 | 3948.0 samples/s | 61.7 steps/s
[Step=17150 Epoch=161.6] | Loss=0.00153 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.369 | L2-Norm(final)=3.002 | 1588.1 samples/s | 24.8 steps/s
[Step=17200 Epoch=162.1] | Loss=0.00134 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.366 | L2-Norm(final)=3.002 | 3712.1 samples/s | 58.0 steps/s
[Step=17250 Epoch=162.5] | Loss=0.00119 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.363 | L2-Norm(final)=3.003 | 1607.8 samples/s | 25.1 steps/s
[Step=17300 Epoch=163.0] | Loss=0.00108 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.360 | L2-Norm(final)=3.003 | 3583.9 samples/s | 56.0 steps/s
[Step=17350 Epoch=163.5] | Loss=0.00098 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.358 | L2-Norm(final)=3.004 | 1636.8 samples/s | 25.6 steps/s
[Step=17400 Epoch=164.0] | Loss=0.00090 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.355 | L2-Norm(final)=3.004 | 3615.6 samples/s | 56.5 steps/s
[Step=17450 Epoch=164.4] | Loss=0.00083 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.353 | L2-Norm(final)=3.004 | 1645.6 samples/s | 25.7 steps/s
[Step=17500 Epoch=164.9] | Loss=0.00078 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.351 | L2-Norm(final)=3.005 | 3565.9 samples/s | 55.7 steps/s
[Step=17550 Epoch=165.4] | Loss=0.00073 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.349 | L2-Norm(final)=3.005 | 1711.2 samples/s | 26.7 steps/s
[Step=17600 Epoch=165.8] | Loss=0.00068 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.347 | L2-Norm(final)=3.005 | 3239.3 samples/s | 50.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step17600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=14401 Epoch=137.3] | Loss=0.07952 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.426 | L2-Norm(final)=3.002 | 3212.3 samples/s | 50.2 steps/s
[Step=14450 Epoch=137.7] | Loss=0.00689 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.383 | L2-Norm(final)=2.999 | 3460.6 samples/s | 54.1 steps/s
[Step=14500 Epoch=138.2] | Loss=0.00387 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.377 | L2-Norm(final)=2.999 | 4502.0 samples/s | 70.3 steps/s
[Step=14550 Epoch=138.7] | Loss=0.00262 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.373 | L2-Norm(final)=3.001 | 1506.8 samples/s | 23.5 steps/s
[Step=14600 Epoch=139.2] | Loss=0.00199 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.369 | L2-Norm(final)=3.002 | 4322.3 samples/s | 67.5 steps/s
[Step=14650 Epoch=139.6] | Loss=0.00160 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.365 | L2-Norm(final)=3.003 | 1533.0 samples/s | 24.0 steps/s
[Step=14700 Epoch=140.1] | Loss=0.00134 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.362 | L2-Norm(final)=3.004 | 4139.8 samples/s | 64.7 steps/s
[Step=14750 Epoch=140.6] | Loss=0.00115 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.359 | L2-Norm(final)=3.004 | 1554.7 samples/s | 24.3 steps/s
[Step=14800 Epoch=141.1] | Loss=0.00101 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.356 | L2-Norm(final)=3.005 | 3955.7 samples/s | 61.8 steps/s
[Step=14850 Epoch=141.5] | Loss=0.00090 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.353 | L2-Norm(final)=3.005 | 1577.5 samples/s | 24.6 steps/s
[Step=14900 Epoch=142.0] | Loss=0.00081 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.350 | L2-Norm(final)=3.006 | 3788.5 samples/s | 59.2 steps/s
[Step=14950 Epoch=142.5] | Loss=0.00074 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.348 | L2-Norm(final)=3.006 | 1601.1 samples/s | 25.0 steps/s
[Step=15000 Epoch=143.0] | Loss=0.00068 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.346 | L2-Norm(final)=3.007 | 3648.7 samples/s | 57.0 steps/s
[Step=15050 Epoch=143.4] | Loss=0.00063 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.344 | L2-Norm(final)=3.007 | 1611.9 samples/s | 25.2 steps/s
[Step=15100 Epoch=143.9] | Loss=0.00059 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.342 | L2-Norm(final)=3.007 | 3628.8 samples/s | 56.7 steps/s
[Step=15150 Epoch=144.4] | Loss=0.00055 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.340 | L2-Norm(final)=3.008 | 1643.4 samples/s | 25.7 steps/s
[Step=15200 Epoch=144.9] | Loss=0.00052 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.338 | L2-Norm(final)=3.008 | 3616.3 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29960 | acc=0.8165 | tpr=0.7388 | fpr=0.0149 | 3793.1 samples/s | 14.8 steps/s
Avg test loss: 0.31022, Avg test acc: 0.81465, Avg tpr: 0.73824, Avg fpr: 0.01731, total FA: 135

Testing server on iccad2012
[Step=  50] | Loss=0.38743 | acc=0.8259 | tpr=0.9690 | fpr=0.1766 | 3749.6 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.39465 | acc=0.8255 | tpr=0.9787 | fpr=0.1773 | 7438.7 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.40051 | acc=0.8233 | tpr=0.9827 | fpr=0.1796 | 7319.2 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.40555 | acc=0.8214 | tpr=0.9825 | fpr=0.1815 | 7462.7 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.40531 | acc=0.8207 | tpr=0.9817 | fpr=0.1822 | 7288.1 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.40529 | acc=0.8204 | tpr=0.9833 | fpr=0.1826 | 7342.2 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.40725 | acc=0.8200 | tpr=0.9831 | fpr=0.1830 | 7472.7 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.40910 | acc=0.8198 | tpr=0.9814 | fpr=0.1832 | 7308.9 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.40919 | acc=0.8199 | tpr=0.9800 | fpr=0.1830 | 7424.6 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.40954 | acc=0.8196 | tpr=0.9793 | fpr=0.1832 | 7171.8 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.40880 | acc=0.8198 | tpr=0.9781 | fpr=0.1830 | 13363.6 samples/s | 52.2 steps/s
Avg test loss: 0.40838, Avg test acc: 0.81991, Avg tpr: 0.97781, Avg fpr: 0.18296, total FA: 25403

server round 30/50

clients selected: [1 4 5 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=7201 Epoch=35.1] | Loss=0.16238 | Reg=0.00339 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.399 | L2-Norm(final)=3.006 | 3408.9 samples/s | 53.3 steps/s
[Step=7250 Epoch=35.4] | Loss=0.04340 | Reg=0.00338 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.385 | L2-Norm(final)=3.000 | 3620.6 samples/s | 56.6 steps/s
[Step=7300 Epoch=35.6] | Loss=0.03043 | Reg=0.00338 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.376 | L2-Norm(final)=2.998 | 3794.0 samples/s | 59.3 steps/s
[Step=7350 Epoch=35.9] | Loss=0.02569 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.371 | L2-Norm(final)=2.998 | 3774.7 samples/s | 59.0 steps/s
[Step=7400 Epoch=36.1] | Loss=0.02237 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.368 | L2-Norm(final)=2.999 | 4712.5 samples/s | 73.6 steps/s
[Step=7450 Epoch=36.4] | Loss=0.01976 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=3.001 | 1552.0 samples/s | 24.2 steps/s
[Step=7500 Epoch=36.6] | Loss=0.01756 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.365 | L2-Norm(final)=3.002 | 3756.5 samples/s | 58.7 steps/s
[Step=7550 Epoch=36.8] | Loss=0.01584 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.364 | L2-Norm(final)=3.004 | 3795.4 samples/s | 59.3 steps/s
[Step=7600 Epoch=37.1] | Loss=0.01457 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.364 | L2-Norm(final)=3.006 | 4493.0 samples/s | 70.2 steps/s
[Step=7650 Epoch=37.3] | Loss=0.01357 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.364 | L2-Norm(final)=3.008 | 1574.9 samples/s | 24.6 steps/s
[Step=7700 Epoch=37.6] | Loss=0.01273 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.364 | L2-Norm(final)=3.011 | 3791.6 samples/s | 59.2 steps/s
[Step=7750 Epoch=37.8] | Loss=0.01195 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.364 | L2-Norm(final)=3.013 | 3793.1 samples/s | 59.3 steps/s
[Step=7800 Epoch=38.1] | Loss=0.01139 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.364 | L2-Norm(final)=3.015 | 4301.6 samples/s | 67.2 steps/s
[Step=7850 Epoch=38.3] | Loss=0.01092 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.364 | L2-Norm(final)=3.017 | 1590.4 samples/s | 24.9 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01054 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.364 | L2-Norm(final)=3.019 | 3787.5 samples/s | 59.2 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01016 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.364 | L2-Norm(final)=3.021 | 3799.1 samples/s | 59.4 steps/s
[Step=8000 Epoch=39.0] | Loss=0.00979 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.364 | L2-Norm(final)=3.022 | 4160.3 samples/s | 65.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step8000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=66.7] | Loss=0.27514 | Reg=0.00339 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.399 | L2-Norm(final)=3.006 | 3269.5 samples/s | 51.1 steps/s
[Step=13650 Epoch=66.9] | Loss=0.03931 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.380 | L2-Norm(final)=3.000 | 3736.3 samples/s | 58.4 steps/s
[Step=13700 Epoch=67.2] | Loss=0.02916 | Reg=0.00338 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.373 | L2-Norm(final)=2.999 | 3780.4 samples/s | 59.1 steps/s
[Step=13750 Epoch=67.4] | Loss=0.02452 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.370 | L2-Norm(final)=3.000 | 3775.6 samples/s | 59.0 steps/s
[Step=13800 Epoch=67.7] | Loss=0.02107 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.368 | L2-Norm(final)=3.001 | 4759.7 samples/s | 74.4 steps/s
[Step=13850 Epoch=67.9] | Loss=0.01811 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=3.003 | 1551.5 samples/s | 24.2 steps/s
[Step=13900 Epoch=68.2] | Loss=0.01617 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=3.006 | 3776.3 samples/s | 59.0 steps/s
[Step=13950 Epoch=68.4] | Loss=0.01487 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=3.008 | 3793.6 samples/s | 59.3 steps/s
[Step=14000 Epoch=68.7] | Loss=0.01388 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.367 | L2-Norm(final)=3.010 | 4592.4 samples/s | 71.8 steps/s
[Step=14050 Epoch=68.9] | Loss=0.01300 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=3.013 | 1567.6 samples/s | 24.5 steps/s
[Step=14100 Epoch=69.1] | Loss=0.01215 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=3.015 | 3781.5 samples/s | 59.1 steps/s
[Step=14150 Epoch=69.4] | Loss=0.01145 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=3.017 | 3780.8 samples/s | 59.1 steps/s
[Step=14200 Epoch=69.6] | Loss=0.01090 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=3.019 | 4423.0 samples/s | 69.1 steps/s
[Step=14250 Epoch=69.9] | Loss=0.01052 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.368 | L2-Norm(final)=3.022 | 1578.4 samples/s | 24.7 steps/s
[Step=14300 Epoch=70.1] | Loss=0.01011 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.368 | L2-Norm(final)=3.024 | 3775.7 samples/s | 59.0 steps/s
[Step=14350 Epoch=70.4] | Loss=0.00968 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.368 | L2-Norm(final)=3.026 | 3773.3 samples/s | 59.0 steps/s
[Step=14400 Epoch=70.6] | Loss=0.00931 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.369 | L2-Norm(final)=3.028 | 4285.4 samples/s | 67.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step14400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=9601 Epoch=91.0] | Loss=0.05720 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.399 | L2-Norm(final)=3.006 | 3275.2 samples/s | 51.2 steps/s
[Step=9650 Epoch=91.4] | Loss=0.00749 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.365 | L2-Norm(final)=3.006 | 3452.5 samples/s | 53.9 steps/s
[Step=9700 Epoch=91.9] | Loss=0.00402 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.355 | L2-Norm(final)=3.008 | 4517.5 samples/s | 70.6 steps/s
[Step=9750 Epoch=92.4] | Loss=0.00274 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.349 | L2-Norm(final)=3.009 | 1512.5 samples/s | 23.6 steps/s
[Step=9800 Epoch=92.9] | Loss=0.00208 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.345 | L2-Norm(final)=3.010 | 4282.7 samples/s | 66.9 steps/s
[Step=9850 Epoch=93.3] | Loss=0.00168 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.341 | L2-Norm(final)=3.011 | 1530.1 samples/s | 23.9 steps/s
[Step=9900 Epoch=93.8] | Loss=0.00141 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.338 | L2-Norm(final)=3.011 | 4024.7 samples/s | 62.9 steps/s
[Step=9950 Epoch=94.3] | Loss=0.00122 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.336 | L2-Norm(final)=3.012 | 1566.4 samples/s | 24.5 steps/s
[Step=10000 Epoch=94.8] | Loss=0.00108 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.333 | L2-Norm(final)=3.013 | 3836.1 samples/s | 59.9 steps/s
[Step=10050 Epoch=95.2] | Loss=0.00097 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.331 | L2-Norm(final)=3.013 | 1591.9 samples/s | 24.9 steps/s
[Step=10100 Epoch=95.7] | Loss=0.00087 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.329 | L2-Norm(final)=3.013 | 3655.1 samples/s | 57.1 steps/s
[Step=10150 Epoch=96.2] | Loss=0.00080 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.327 | L2-Norm(final)=3.014 | 1610.8 samples/s | 25.2 steps/s
[Step=10200 Epoch=96.7] | Loss=0.00074 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.325 | L2-Norm(final)=3.014 | 3604.3 samples/s | 56.3 steps/s
[Step=10250 Epoch=97.1] | Loss=0.00069 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.015 | 1630.1 samples/s | 25.5 steps/s
[Step=10300 Epoch=97.6] | Loss=0.00064 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.322 | L2-Norm(final)=3.015 | 3615.1 samples/s | 56.5 steps/s
[Step=10350 Epoch=98.1] | Loss=0.00060 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.321 | L2-Norm(final)=3.015 | 1617.4 samples/s | 25.3 steps/s
[Step=10400 Epoch=98.5] | Loss=0.00057 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.319 | L2-Norm(final)=3.016 | 3594.0 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step10400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=17601 Epoch=165.9] | Loss=0.15871 | Reg=0.00339 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.399 | L2-Norm(final)=3.006 | 3225.7 samples/s | 50.4 steps/s
[Step=17650 Epoch=166.3] | Loss=0.00878 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.359 | L2-Norm(final)=3.006 | 3479.3 samples/s | 54.4 steps/s
[Step=17700 Epoch=166.8] | Loss=0.00459 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.351 | L2-Norm(final)=3.007 | 4468.3 samples/s | 69.8 steps/s
[Step=17750 Epoch=167.3] | Loss=0.00311 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.345 | L2-Norm(final)=3.008 | 1493.1 samples/s | 23.3 steps/s
[Step=17800 Epoch=167.7] | Loss=0.00236 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.341 | L2-Norm(final)=3.009 | 4194.9 samples/s | 65.5 steps/s
[Step=17850 Epoch=168.2] | Loss=0.00190 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.338 | L2-Norm(final)=3.010 | 1548.8 samples/s | 24.2 steps/s
[Step=17900 Epoch=168.7] | Loss=0.00160 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.335 | L2-Norm(final)=3.011 | 3900.9 samples/s | 61.0 steps/s
[Step=17950 Epoch=169.1] | Loss=0.00138 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.332 | L2-Norm(final)=3.011 | 1583.5 samples/s | 24.7 steps/s
[Step=18000 Epoch=169.6] | Loss=0.00122 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.330 | L2-Norm(final)=3.012 | 3727.3 samples/s | 58.2 steps/s
[Step=18050 Epoch=170.1] | Loss=0.00109 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.328 | L2-Norm(final)=3.012 | 1617.0 samples/s | 25.3 steps/s
[Step=18100 Epoch=170.6] | Loss=0.00099 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.326 | L2-Norm(final)=3.013 | 3581.8 samples/s | 56.0 steps/s
[Step=18150 Epoch=171.0] | Loss=0.00090 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.013 | 1616.8 samples/s | 25.3 steps/s
[Step=18200 Epoch=171.5] | Loss=0.00083 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.323 | L2-Norm(final)=3.013 | 3622.7 samples/s | 56.6 steps/s
[Step=18250 Epoch=172.0] | Loss=0.00077 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.321 | L2-Norm(final)=3.014 | 1646.7 samples/s | 25.7 steps/s
[Step=18300 Epoch=172.4] | Loss=0.00072 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.320 | L2-Norm(final)=3.014 | 3557.7 samples/s | 55.6 steps/s
[Step=18350 Epoch=172.9] | Loss=0.00068 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.319 | L2-Norm(final)=3.014 | 1738.1 samples/s | 27.2 steps/s
[Step=18400 Epoch=173.4] | Loss=0.00064 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.317 | L2-Norm(final)=3.015 | 3276.0 samples/s | 51.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step18400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=144.9] | Loss=0.08601 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.399 | L2-Norm(final)=3.006 | 3167.6 samples/s | 49.5 steps/s
[Step=15250 Epoch=145.3] | Loss=0.00595 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.361 | L2-Norm(final)=3.008 | 3486.1 samples/s | 54.5 steps/s
[Step=15300 Epoch=145.8] | Loss=0.00322 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.353 | L2-Norm(final)=3.009 | 4564.6 samples/s | 71.3 steps/s
[Step=15350 Epoch=146.3] | Loss=0.00219 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.347 | L2-Norm(final)=3.010 | 1487.4 samples/s | 23.2 steps/s
[Step=15400 Epoch=146.8] | Loss=0.00166 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.342 | L2-Norm(final)=3.011 | 4339.5 samples/s | 67.8 steps/s
[Step=15450 Epoch=147.3] | Loss=0.00134 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.339 | L2-Norm(final)=3.012 | 1521.4 samples/s | 23.8 steps/s
[Step=15500 Epoch=147.7] | Loss=0.00113 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.336 | L2-Norm(final)=3.012 | 4127.2 samples/s | 64.5 steps/s
[Step=15550 Epoch=148.2] | Loss=0.00098 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.333 | L2-Norm(final)=3.013 | 1541.6 samples/s | 24.1 steps/s
[Step=15600 Epoch=148.7] | Loss=0.00086 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.330 | L2-Norm(final)=3.013 | 3950.9 samples/s | 61.7 steps/s
[Step=15650 Epoch=149.2] | Loss=0.00077 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.328 | L2-Norm(final)=3.014 | 1562.9 samples/s | 24.4 steps/s
[Step=15700 Epoch=149.6] | Loss=0.00070 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.326 | L2-Norm(final)=3.014 | 3753.6 samples/s | 58.6 steps/s
[Step=15750 Epoch=150.1] | Loss=0.00064 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.014 | 1588.5 samples/s | 24.8 steps/s
[Step=15800 Epoch=150.6] | Loss=0.00059 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.322 | L2-Norm(final)=3.015 | 3621.7 samples/s | 56.6 steps/s
[Step=15850 Epoch=151.1] | Loss=0.00055 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.321 | L2-Norm(final)=3.015 | 1598.1 samples/s | 25.0 steps/s
[Step=15900 Epoch=151.5] | Loss=0.00051 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.319 | L2-Norm(final)=3.016 | 3595.9 samples/s | 56.2 steps/s
[Step=15950 Epoch=152.0] | Loss=0.00048 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.317 | L2-Norm(final)=3.016 | 1623.2 samples/s | 25.4 steps/s
[Step=16000 Epoch=152.5] | Loss=0.00046 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.316 | L2-Norm(final)=3.016 | 3600.0 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28630 | acc=0.8254 | tpr=0.7514 | fpr=0.0139 | 3707.1 samples/s | 14.5 steps/s
Avg test loss: 0.29687, Avg test acc: 0.82422, Avg tpr: 0.75141, Avg fpr: 0.01564, total FA: 122

Testing server on iccad2012
[Step=  50] | Loss=0.40229 | acc=0.8214 | tpr=0.9602 | fpr=0.1811 | 3770.6 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.40985 | acc=0.8204 | tpr=0.9765 | fpr=0.1825 | 7217.0 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.41560 | acc=0.8187 | tpr=0.9813 | fpr=0.1843 | 7455.6 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.42055 | acc=0.8167 | tpr=0.9814 | fpr=0.1863 | 7342.6 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.42057 | acc=0.8156 | tpr=0.9825 | fpr=0.1874 | 7341.1 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.42041 | acc=0.8155 | tpr=0.9840 | fpr=0.1876 | 7453.6 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.42236 | acc=0.8149 | tpr=0.9825 | fpr=0.1882 | 7304.5 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.42428 | acc=0.8146 | tpr=0.9809 | fpr=0.1884 | 7421.8 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.42429 | acc=0.8148 | tpr=0.9796 | fpr=0.1882 | 7432.1 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.42454 | acc=0.8144 | tpr=0.9784 | fpr=0.1886 | 7161.2 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.42378 | acc=0.8145 | tpr=0.9773 | fpr=0.1884 | 13548.7 samples/s | 52.9 steps/s
Avg test loss: 0.42338, Avg test acc: 0.81460, Avg tpr: 0.97702, Avg fpr: 0.18835, total FA: 26152

server round 31/50

clients selected: [0 3 6 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=10401 Epoch=50.7] | Loss=0.18315 | Reg=0.00337 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.358 | L2-Norm(final)=3.023 | 3454.8 samples/s | 54.0 steps/s
[Step=10450 Epoch=51.0] | Loss=0.03620 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.339 | L2-Norm(final)=3.019 | 3550.3 samples/s | 55.5 steps/s
[Step=10500 Epoch=51.2] | Loss=0.02639 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.332 | L2-Norm(final)=3.018 | 3770.8 samples/s | 58.9 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02231 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.329 | L2-Norm(final)=3.019 | 3731.0 samples/s | 58.3 steps/s
[Step=10600 Epoch=51.7] | Loss=0.02019 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.327 | L2-Norm(final)=3.020 | 4690.9 samples/s | 73.3 steps/s
[Step=10650 Epoch=51.9] | Loss=0.01752 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.326 | L2-Norm(final)=3.021 | 1539.2 samples/s | 24.0 steps/s
[Step=10700 Epoch=52.2] | Loss=0.01601 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.325 | L2-Norm(final)=3.023 | 3769.4 samples/s | 58.9 steps/s
[Step=10750 Epoch=52.4] | Loss=0.01483 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.025 | 3785.5 samples/s | 59.1 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01384 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.027 | 4466.3 samples/s | 69.8 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01291 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.029 | 1583.9 samples/s | 24.7 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01216 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.032 | 3768.9 samples/s | 58.9 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01158 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.324 | L2-Norm(final)=3.034 | 3778.8 samples/s | 59.0 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01092 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.036 | 4239.8 samples/s | 66.2 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01044 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.325 | L2-Norm(final)=3.038 | 1610.6 samples/s | 25.2 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01001 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.325 | L2-Norm(final)=3.040 | 3778.3 samples/s | 59.0 steps/s
[Step=11150 Epoch=54.4] | Loss=0.00965 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.325 | L2-Norm(final)=3.042 | 3785.0 samples/s | 59.1 steps/s
[Step=11200 Epoch=54.6] | Loss=0.00930 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.325 | L2-Norm(final)=3.044 | 4048.1 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step11200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=9601 Epoch=46.8] | Loss=0.20121 | Reg=0.00337 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.358 | L2-Norm(final)=3.023 | 3414.0 samples/s | 53.3 steps/s
[Step=9650 Epoch=47.1] | Loss=0.02907 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.341 | L2-Norm(final)=3.020 | 3642.7 samples/s | 56.9 steps/s
[Step=9700 Epoch=47.3] | Loss=0.02231 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.335 | L2-Norm(final)=3.020 | 3754.2 samples/s | 58.7 steps/s
[Step=9750 Epoch=47.5] | Loss=0.01890 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.331 | L2-Norm(final)=3.021 | 3785.2 samples/s | 59.1 steps/s
[Step=9800 Epoch=47.8] | Loss=0.01713 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.328 | L2-Norm(final)=3.022 | 4700.7 samples/s | 73.4 steps/s
[Step=9850 Epoch=48.0] | Loss=0.01487 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.327 | L2-Norm(final)=3.024 | 1553.1 samples/s | 24.3 steps/s
[Step=9900 Epoch=48.3] | Loss=0.01356 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.326 | L2-Norm(final)=3.025 | 3769.7 samples/s | 58.9 steps/s
[Step=9950 Epoch=48.5] | Loss=0.01250 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.325 | L2-Norm(final)=3.027 | 3778.0 samples/s | 59.0 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01167 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.325 | L2-Norm(final)=3.029 | 4441.4 samples/s | 69.4 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01106 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.031 | 1581.0 samples/s | 24.7 steps/s
[Step=10100 Epoch=49.3] | Loss=0.01049 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.033 | 3752.0 samples/s | 58.6 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01002 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.035 | 3774.1 samples/s | 59.0 steps/s
[Step=10200 Epoch=49.7] | Loss=0.00965 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.037 | 4235.9 samples/s | 66.2 steps/s
[Step=10250 Epoch=50.0] | Loss=0.00924 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.038 | 1614.5 samples/s | 25.2 steps/s
[Step=10300 Epoch=50.2] | Loss=0.00884 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.040 | 3770.5 samples/s | 58.9 steps/s
[Step=10350 Epoch=50.5] | Loss=0.00857 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.042 | 3787.2 samples/s | 59.2 steps/s
[Step=10400 Epoch=50.7] | Loss=0.00833 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.043 | 4048.5 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step10400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=114.2] | Loss=0.07394 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.358 | L2-Norm(final)=3.023 | 3143.6 samples/s | 49.1 steps/s
[Step=12050 Epoch=114.6] | Loss=0.00710 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.317 | L2-Norm(final)=3.024 | 3504.5 samples/s | 54.8 steps/s
[Step=12100 Epoch=115.1] | Loss=0.00372 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.307 | L2-Norm(final)=3.025 | 4545.5 samples/s | 71.0 steps/s
[Step=12150 Epoch=115.6] | Loss=0.00252 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.302 | L2-Norm(final)=3.026 | 1493.9 samples/s | 23.3 steps/s
[Step=12200 Epoch=116.1] | Loss=0.00191 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.298 | L2-Norm(final)=3.026 | 4281.7 samples/s | 66.9 steps/s
[Step=12250 Epoch=116.5] | Loss=0.00154 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.295 | L2-Norm(final)=3.027 | 1534.1 samples/s | 24.0 steps/s
[Step=12300 Epoch=117.0] | Loss=0.00130 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.292 | L2-Norm(final)=3.027 | 4032.0 samples/s | 63.0 steps/s
[Step=12350 Epoch=117.5] | Loss=0.00112 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.290 | L2-Norm(final)=3.028 | 1563.0 samples/s | 24.4 steps/s
[Step=12400 Epoch=118.0] | Loss=0.00099 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.287 | L2-Norm(final)=3.028 | 3845.6 samples/s | 60.1 steps/s
[Step=12450 Epoch=118.4] | Loss=0.00088 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.286 | L2-Norm(final)=3.029 | 1589.1 samples/s | 24.8 steps/s
[Step=12500 Epoch=118.9] | Loss=0.00080 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.284 | L2-Norm(final)=3.029 | 3679.9 samples/s | 57.5 steps/s
[Step=12550 Epoch=119.4] | Loss=0.00073 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.282 | L2-Norm(final)=3.029 | 1621.8 samples/s | 25.3 steps/s
[Step=12600 Epoch=119.9] | Loss=0.00068 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.281 | L2-Norm(final)=3.030 | 3598.0 samples/s | 56.2 steps/s
[Step=12650 Epoch=120.3] | Loss=0.00063 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.279 | L2-Norm(final)=3.030 | 1639.4 samples/s | 25.6 steps/s
[Step=12700 Epoch=120.8] | Loss=0.00058 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.278 | L2-Norm(final)=3.030 | 3600.8 samples/s | 56.3 steps/s
[Step=12750 Epoch=121.3] | Loss=0.00055 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.276 | L2-Norm(final)=3.031 | 1639.5 samples/s | 25.6 steps/s
[Step=12800 Epoch=121.8] | Loss=0.00052 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.275 | L2-Norm(final)=3.031 | 3567.1 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step12800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=18401 Epoch=173.4] | Loss=0.07811 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.358 | L2-Norm(final)=3.023 | 3473.4 samples/s | 54.3 steps/s
[Step=18450 Epoch=173.9] | Loss=0.01064 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.320 | L2-Norm(final)=3.021 | 3200.4 samples/s | 50.0 steps/s
[Step=18500 Epoch=174.3] | Loss=0.00563 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.312 | L2-Norm(final)=3.021 | 4478.2 samples/s | 70.0 steps/s
[Step=18550 Epoch=174.8] | Loss=0.00383 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.307 | L2-Norm(final)=3.022 | 1472.7 samples/s | 23.0 steps/s
[Step=18600 Epoch=175.3] | Loss=0.00289 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.303 | L2-Norm(final)=3.023 | 3706.9 samples/s | 57.9 steps/s
[Step=18650 Epoch=175.7] | Loss=0.00233 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.300 | L2-Norm(final)=3.024 | 1504.6 samples/s | 23.5 steps/s
[Step=18700 Epoch=176.2] | Loss=0.00195 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.297 | L2-Norm(final)=3.024 | 3392.0 samples/s | 53.0 steps/s
[Step=18750 Epoch=176.7] | Loss=0.00168 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.295 | L2-Norm(final)=3.025 | 1374.8 samples/s | 21.5 steps/s
[Step=18800 Epoch=177.1] | Loss=0.00148 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.292 | L2-Norm(final)=3.025 | 3262.1 samples/s | 51.0 steps/s
[Step=18850 Epoch=177.6] | Loss=0.00132 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.290 | L2-Norm(final)=3.025 | 1459.7 samples/s | 22.8 steps/s
[Step=18900 Epoch=178.1] | Loss=0.00119 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.288 | L2-Norm(final)=3.026 | 3178.0 samples/s | 49.7 steps/s
[Step=18950 Epoch=178.6] | Loss=0.00109 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.286 | L2-Norm(final)=3.026 | 1651.3 samples/s | 25.8 steps/s
[Step=19000 Epoch=179.0] | Loss=0.00100 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.285 | L2-Norm(final)=3.026 | 3623.2 samples/s | 56.6 steps/s
[Step=19050 Epoch=179.5] | Loss=0.00093 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.283 | L2-Norm(final)=3.027 | 1640.8 samples/s | 25.6 steps/s
[Step=19100 Epoch=180.0] | Loss=0.00086 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.281 | L2-Norm(final)=3.027 | 3580.3 samples/s | 55.9 steps/s
[Step=19150 Epoch=180.4] | Loss=0.00081 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.280 | L2-Norm(final)=3.027 | 1722.2 samples/s | 26.9 steps/s
[Step=19200 Epoch=180.9] | Loss=0.00076 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.279 | L2-Norm(final)=3.028 | 3288.4 samples/s | 51.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step19200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=152.5] | Loss=0.09329 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.358 | L2-Norm(final)=3.023 | 3206.0 samples/s | 50.1 steps/s
[Step=16050 Epoch=153.0] | Loss=0.00720 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.319 | L2-Norm(final)=3.024 | 3445.1 samples/s | 53.8 steps/s
[Step=16100 Epoch=153.4] | Loss=0.00379 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.312 | L2-Norm(final)=3.026 | 4550.9 samples/s | 71.1 steps/s
[Step=16150 Epoch=153.9] | Loss=0.00256 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.307 | L2-Norm(final)=3.027 | 1495.4 samples/s | 23.4 steps/s
[Step=16200 Epoch=154.4] | Loss=0.00194 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.303 | L2-Norm(final)=3.028 | 4304.1 samples/s | 67.3 steps/s
[Step=16250 Epoch=154.9] | Loss=0.00157 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.299 | L2-Norm(final)=3.029 | 1512.7 samples/s | 23.6 steps/s
[Step=16300 Epoch=155.4] | Loss=0.00132 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.296 | L2-Norm(final)=3.029 | 4122.2 samples/s | 64.4 steps/s
[Step=16350 Epoch=155.8] | Loss=0.00114 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.293 | L2-Norm(final)=3.030 | 1541.9 samples/s | 24.1 steps/s
[Step=16400 Epoch=156.3] | Loss=0.00100 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.291 | L2-Norm(final)=3.030 | 3914.3 samples/s | 61.2 steps/s
[Step=16450 Epoch=156.8] | Loss=0.00090 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.289 | L2-Norm(final)=3.031 | 1560.9 samples/s | 24.4 steps/s
[Step=16500 Epoch=157.3] | Loss=0.00081 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.287 | L2-Norm(final)=3.031 | 3802.6 samples/s | 59.4 steps/s
[Step=16550 Epoch=157.7] | Loss=0.00074 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.285 | L2-Norm(final)=3.031 | 1587.0 samples/s | 24.8 steps/s
[Step=16600 Epoch=158.2] | Loss=0.00068 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.283 | L2-Norm(final)=3.032 | 3618.1 samples/s | 56.5 steps/s
[Step=16650 Epoch=158.7] | Loss=0.00063 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.281 | L2-Norm(final)=3.032 | 1620.3 samples/s | 25.3 steps/s
[Step=16700 Epoch=159.2] | Loss=0.00059 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.279 | L2-Norm(final)=3.032 | 3592.8 samples/s | 56.1 steps/s
[Step=16750 Epoch=159.6] | Loss=0.00055 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.278 | L2-Norm(final)=3.033 | 1619.0 samples/s | 25.3 steps/s
[Step=16800 Epoch=160.1] | Loss=0.00052 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.276 | L2-Norm(final)=3.033 | 3616.6 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29855 | acc=0.8217 | tpr=0.7451 | fpr=0.0119 | 3778.2 samples/s | 14.8 steps/s
Avg test loss: 0.30912, Avg test acc: 0.82046, Avg tpr: 0.74500, Avg fpr: 0.01359, total FA: 106

Testing server on iccad2012
[Step=  50] | Loss=0.39914 | acc=0.8294 | tpr=0.9602 | fpr=0.1730 | 3778.3 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.40651 | acc=0.8292 | tpr=0.9765 | fpr=0.1736 | 7115.1 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.41235 | acc=0.8270 | tpr=0.9813 | fpr=0.1758 | 7601.6 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.41746 | acc=0.8250 | tpr=0.9814 | fpr=0.1778 | 7472.7 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.41734 | acc=0.8242 | tpr=0.9825 | fpr=0.1787 | 7216.0 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.41707 | acc=0.8241 | tpr=0.9840 | fpr=0.1788 | 7477.9 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.41899 | acc=0.8236 | tpr=0.9831 | fpr=0.1793 | 7490.2 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.42097 | acc=0.8235 | tpr=0.9814 | fpr=0.1793 | 7252.8 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.42100 | acc=0.8236 | tpr=0.9800 | fpr=0.1792 | 7421.2 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.42119 | acc=0.8232 | tpr=0.9789 | fpr=0.1796 | 7217.9 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.42036 | acc=0.8233 | tpr=0.9777 | fpr=0.1795 | 13273.0 samples/s | 51.8 steps/s
Avg test loss: 0.41993, Avg test acc: 0.82337, Avg tpr: 0.97742, Avg fpr: 0.17943, total FA: 24914

server round 32/50

clients selected: [3 5 6 7 9]

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=10401 Epoch=50.7] | Loss=0.11945 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.322 | L2-Norm(final)=3.039 | 3434.7 samples/s | 53.7 steps/s
[Step=10450 Epoch=51.0] | Loss=0.03495 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.308 | L2-Norm(final)=3.033 | 3511.3 samples/s | 54.9 steps/s
[Step=10500 Epoch=51.2] | Loss=0.02387 | Reg=0.00335 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.302 | L2-Norm(final)=3.033 | 3770.7 samples/s | 58.9 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02046 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.298 | L2-Norm(final)=3.034 | 3785.3 samples/s | 59.1 steps/s
[Step=10600 Epoch=51.7] | Loss=0.01838 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.296 | L2-Norm(final)=3.035 | 4685.8 samples/s | 73.2 steps/s
[Step=10650 Epoch=51.9] | Loss=0.01638 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.294 | L2-Norm(final)=3.036 | 1558.8 samples/s | 24.4 steps/s
[Step=10700 Epoch=52.2] | Loss=0.01458 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.293 | L2-Norm(final)=3.038 | 3750.0 samples/s | 58.6 steps/s
[Step=10750 Epoch=52.4] | Loss=0.01326 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.292 | L2-Norm(final)=3.039 | 3762.2 samples/s | 58.8 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01247 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.292 | L2-Norm(final)=3.041 | 4452.2 samples/s | 69.6 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01154 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.291 | L2-Norm(final)=3.043 | 1585.5 samples/s | 24.8 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01092 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.291 | L2-Norm(final)=3.045 | 3786.9 samples/s | 59.2 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01044 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.291 | L2-Norm(final)=3.047 | 3779.4 samples/s | 59.1 steps/s
[Step=11000 Epoch=53.6] | Loss=0.00995 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.290 | L2-Norm(final)=3.049 | 4231.7 samples/s | 66.1 steps/s
[Step=11050 Epoch=53.9] | Loss=0.00954 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.290 | L2-Norm(final)=3.051 | 1591.6 samples/s | 24.9 steps/s
[Step=11100 Epoch=54.1] | Loss=0.00913 | Reg=0.00335 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.290 | L2-Norm(final)=3.053 | 3761.2 samples/s | 58.8 steps/s
[Step=11150 Epoch=54.4] | Loss=0.00876 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.290 | L2-Norm(final)=3.054 | 3785.1 samples/s | 59.1 steps/s
[Step=11200 Epoch=54.6] | Loss=0.00843 | Reg=0.00335 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.291 | L2-Norm(final)=3.056 | 4058.6 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step11200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=10401 Epoch=98.6] | Loss=0.14397 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.322 | L2-Norm(final)=3.039 | 3087.1 samples/s | 48.2 steps/s
[Step=10450 Epoch=99.0] | Loss=0.00778 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.285 | L2-Norm(final)=3.038 | 3606.2 samples/s | 56.3 steps/s
[Step=10500 Epoch=99.5] | Loss=0.00425 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.277 | L2-Norm(final)=3.039 | 4531.4 samples/s | 70.8 steps/s
[Step=10550 Epoch=100.0] | Loss=0.00287 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.271 | L2-Norm(final)=3.040 | 1477.8 samples/s | 23.1 steps/s
[Step=10600 Epoch=100.4] | Loss=0.00218 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.267 | L2-Norm(final)=3.041 | 4240.2 samples/s | 66.3 steps/s
[Step=10650 Epoch=100.9] | Loss=0.00176 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.264 | L2-Norm(final)=3.042 | 1523.4 samples/s | 23.8 steps/s
[Step=10700 Epoch=101.4] | Loss=0.00148 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.261 | L2-Norm(final)=3.042 | 4034.2 samples/s | 63.0 steps/s
[Step=10750 Epoch=101.9] | Loss=0.00127 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.258 | L2-Norm(final)=3.043 | 1570.3 samples/s | 24.5 steps/s
[Step=10800 Epoch=102.3] | Loss=0.00112 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.256 | L2-Norm(final)=3.043 | 3847.8 samples/s | 60.1 steps/s
[Step=10850 Epoch=102.8] | Loss=0.00100 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.254 | L2-Norm(final)=3.043 | 1591.3 samples/s | 24.9 steps/s
[Step=10900 Epoch=103.3] | Loss=0.00091 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.252 | L2-Norm(final)=3.044 | 3662.4 samples/s | 57.2 steps/s
[Step=10950 Epoch=103.8] | Loss=0.00083 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.250 | L2-Norm(final)=3.044 | 1627.9 samples/s | 25.4 steps/s
[Step=11000 Epoch=104.2] | Loss=0.00076 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.249 | L2-Norm(final)=3.044 | 3568.2 samples/s | 55.8 steps/s
[Step=11050 Epoch=104.7] | Loss=0.00071 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.247 | L2-Norm(final)=3.045 | 1611.0 samples/s | 25.2 steps/s
[Step=11100 Epoch=105.2] | Loss=0.00066 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.245 | L2-Norm(final)=3.045 | 3590.6 samples/s | 56.1 steps/s
[Step=11150 Epoch=105.7] | Loss=0.00062 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.244 | L2-Norm(final)=3.045 | 1626.4 samples/s | 25.4 steps/s
[Step=11200 Epoch=106.1] | Loss=0.00059 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.243 | L2-Norm(final)=3.046 | 3560.6 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step11200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=121.8] | Loss=0.10634 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.322 | L2-Norm(final)=3.039 | 3368.7 samples/s | 52.6 steps/s
[Step=12850 Epoch=122.2] | Loss=0.01123 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.283 | L2-Norm(final)=3.035 | 3306.4 samples/s | 51.7 steps/s
[Step=12900 Epoch=122.7] | Loss=0.00603 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.275 | L2-Norm(final)=3.036 | 4545.3 samples/s | 71.0 steps/s
[Step=12950 Epoch=123.2] | Loss=0.00410 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.270 | L2-Norm(final)=3.037 | 1486.8 samples/s | 23.2 steps/s
[Step=13000 Epoch=123.7] | Loss=0.00310 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.267 | L2-Norm(final)=3.037 | 4278.8 samples/s | 66.9 steps/s
[Step=13050 Epoch=124.1] | Loss=0.00249 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.264 | L2-Norm(final)=3.038 | 1521.1 samples/s | 23.8 steps/s
[Step=13100 Epoch=124.6] | Loss=0.00209 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.261 | L2-Norm(final)=3.039 | 4002.5 samples/s | 62.5 steps/s
[Step=13150 Epoch=125.1] | Loss=0.00180 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.259 | L2-Norm(final)=3.039 | 1567.0 samples/s | 24.5 steps/s
[Step=13200 Epoch=125.6] | Loss=0.00158 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.257 | L2-Norm(final)=3.040 | 3829.7 samples/s | 59.8 steps/s
[Step=13250 Epoch=126.0] | Loss=0.00141 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.255 | L2-Norm(final)=3.040 | 1592.1 samples/s | 24.9 steps/s
[Step=13300 Epoch=126.5] | Loss=0.00128 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.253 | L2-Norm(final)=3.040 | 3663.4 samples/s | 57.2 steps/s
[Step=13350 Epoch=127.0] | Loss=0.00117 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.251 | L2-Norm(final)=3.041 | 1638.7 samples/s | 25.6 steps/s
[Step=13400 Epoch=127.5] | Loss=0.00107 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.250 | L2-Norm(final)=3.041 | 3580.1 samples/s | 55.9 steps/s
[Step=13450 Epoch=127.9] | Loss=0.00099 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.248 | L2-Norm(final)=3.042 | 1657.1 samples/s | 25.9 steps/s
[Step=13500 Epoch=128.4] | Loss=0.00093 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.247 | L2-Norm(final)=3.042 | 3584.3 samples/s | 56.0 steps/s
[Step=13550 Epoch=128.9] | Loss=0.00087 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.246 | L2-Norm(final)=3.042 | 1608.0 samples/s | 25.1 steps/s
[Step=13600 Epoch=129.4] | Loss=0.00082 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.244 | L2-Norm(final)=3.043 | 3600.2 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step13600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=114.6] | Loss=0.10550 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.322 | L2-Norm(final)=3.039 | 3344.8 samples/s | 52.3 steps/s
[Step=12050 Epoch=115.1] | Loss=0.00634 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.279 | L2-Norm(final)=3.039 | 3426.4 samples/s | 53.5 steps/s
[Step=12100 Epoch=115.5] | Loss=0.00335 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.270 | L2-Norm(final)=3.040 | 4560.6 samples/s | 71.3 steps/s
[Step=12150 Epoch=116.0] | Loss=0.00228 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.264 | L2-Norm(final)=3.041 | 1488.3 samples/s | 23.3 steps/s
[Step=12200 Epoch=116.5] | Loss=0.00173 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.260 | L2-Norm(final)=3.041 | 4317.7 samples/s | 67.5 steps/s
[Step=12250 Epoch=117.0] | Loss=0.00140 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.257 | L2-Norm(final)=3.042 | 1516.0 samples/s | 23.7 steps/s
[Step=12300 Epoch=117.5] | Loss=0.00117 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.254 | L2-Norm(final)=3.043 | 4134.5 samples/s | 64.6 steps/s
[Step=12350 Epoch=117.9] | Loss=0.00101 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.252 | L2-Norm(final)=3.043 | 1547.5 samples/s | 24.2 steps/s
[Step=12400 Epoch=118.4] | Loss=0.00089 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.250 | L2-Norm(final)=3.043 | 3941.0 samples/s | 61.6 steps/s
[Step=12450 Epoch=118.9] | Loss=0.00080 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.248 | L2-Norm(final)=3.044 | 1579.8 samples/s | 24.7 steps/s
[Step=12500 Epoch=119.4] | Loss=0.00072 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.246 | L2-Norm(final)=3.044 | 3811.2 samples/s | 59.5 steps/s
[Step=12550 Epoch=119.8] | Loss=0.00066 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.244 | L2-Norm(final)=3.044 | 1595.7 samples/s | 24.9 steps/s
[Step=12600 Epoch=120.3] | Loss=0.00061 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.242 | L2-Norm(final)=3.045 | 3653.1 samples/s | 57.1 steps/s
[Step=12650 Epoch=120.8] | Loss=0.00056 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.241 | L2-Norm(final)=3.045 | 1615.1 samples/s | 25.2 steps/s
[Step=12700 Epoch=121.3] | Loss=0.00052 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.239 | L2-Norm(final)=3.045 | 3603.9 samples/s | 56.3 steps/s
[Step=12750 Epoch=121.8] | Loss=0.00049 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.238 | L2-Norm(final)=3.045 | 1627.3 samples/s | 25.4 steps/s
[Step=12800 Epoch=122.2] | Loss=0.00046 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.237 | L2-Norm(final)=3.046 | 3621.9 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step12800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16801 Epoch=160.1] | Loss=0.02774 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.322 | L2-Norm(final)=3.039 | 3099.0 samples/s | 48.4 steps/s
[Step=16850 Epoch=160.6] | Loss=0.01043 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.285 | L2-Norm(final)=3.037 | 3589.3 samples/s | 56.1 steps/s
[Step=16900 Epoch=161.1] | Loss=0.00539 | Reg=0.00334 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.277 | L2-Norm(final)=3.037 | 4572.9 samples/s | 71.5 steps/s
[Step=16950 Epoch=161.5] | Loss=0.00363 | Reg=0.00334 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.272 | L2-Norm(final)=3.038 | 1485.2 samples/s | 23.2 steps/s
[Step=17000 Epoch=162.0] | Loss=0.00274 | Reg=0.00334 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.268 | L2-Norm(final)=3.039 | 4326.4 samples/s | 67.6 steps/s
[Step=17050 Epoch=162.5] | Loss=0.00220 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.264 | L2-Norm(final)=3.039 | 1517.3 samples/s | 23.7 steps/s
[Step=17100 Epoch=163.0] | Loss=0.00185 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.261 | L2-Norm(final)=3.040 | 4123.6 samples/s | 64.4 steps/s
[Step=17150 Epoch=163.5] | Loss=0.00159 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.259 | L2-Norm(final)=3.040 | 1528.1 samples/s | 23.9 steps/s
[Step=17200 Epoch=163.9] | Loss=0.00140 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.256 | L2-Norm(final)=3.041 | 3937.3 samples/s | 61.5 steps/s
[Step=17250 Epoch=164.4] | Loss=0.00125 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.254 | L2-Norm(final)=3.041 | 1565.8 samples/s | 24.5 steps/s
[Step=17300 Epoch=164.9] | Loss=0.00113 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.252 | L2-Norm(final)=3.041 | 3768.9 samples/s | 58.9 steps/s
[Step=17350 Epoch=165.4] | Loss=0.00103 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.250 | L2-Norm(final)=3.042 | 1588.1 samples/s | 24.8 steps/s
[Step=17400 Epoch=165.8] | Loss=0.00095 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.249 | L2-Norm(final)=3.042 | 3661.5 samples/s | 57.2 steps/s
[Step=17450 Epoch=166.3] | Loss=0.00088 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.247 | L2-Norm(final)=3.042 | 1610.5 samples/s | 25.2 steps/s
[Step=17500 Epoch=166.8] | Loss=0.00082 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.245 | L2-Norm(final)=3.043 | 3613.1 samples/s | 56.5 steps/s
[Step=17550 Epoch=167.3] | Loss=0.00077 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.244 | L2-Norm(final)=3.043 | 1624.0 samples/s | 25.4 steps/s
[Step=17600 Epoch=167.7] | Loss=0.00072 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.243 | L2-Norm(final)=3.043 | 3583.5 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28937 | acc=0.8282 | tpr=0.7548 | fpr=0.0124 | 3692.6 samples/s | 14.4 steps/s
Avg test loss: 0.29980, Avg test acc: 0.82679, Avg tpr: 0.75450, Avg fpr: 0.01423, total FA: 111

Testing server on iccad2012
[Step=  50] | Loss=0.41299 | acc=0.8222 | tpr=0.9602 | fpr=0.1803 | 3760.7 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.42103 | acc=0.8214 | tpr=0.9723 | fpr=0.1814 | 7200.4 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.42706 | acc=0.8192 | tpr=0.9784 | fpr=0.1837 | 7530.5 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.43223 | acc=0.8174 | tpr=0.9792 | fpr=0.1856 | 7748.9 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.43233 | acc=0.8165 | tpr=0.9799 | fpr=0.1865 | 6975.8 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.43216 | acc=0.8164 | tpr=0.9818 | fpr=0.1866 | 7408.5 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.43400 | acc=0.8161 | tpr=0.9812 | fpr=0.1869 | 7235.4 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.43592 | acc=0.8161 | tpr=0.9792 | fpr=0.1869 | 7377.1 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.43602 | acc=0.8161 | tpr=0.9776 | fpr=0.1868 | 7606.5 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.43617 | acc=0.8158 | tpr=0.9767 | fpr=0.1871 | 7062.2 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.43537 | acc=0.8159 | tpr=0.9757 | fpr=0.1870 | 13379.9 samples/s | 52.3 steps/s
Avg test loss: 0.43495, Avg test acc: 0.81599, Avg tpr: 0.97544, Avg fpr: 0.18691, total FA: 25952

server round 33/50

clients selected: [1 2 5 6 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=8001 Epoch=39.0] | Loss=0.23606 | Reg=0.00334 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.287 | L2-Norm(final)=3.052 | 3392.6 samples/s | 53.0 steps/s
[Step=8050 Epoch=39.3] | Loss=0.03043 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.272 | L2-Norm(final)=3.049 | 3600.5 samples/s | 56.3 steps/s
[Step=8100 Epoch=39.5] | Loss=0.02339 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.265 | L2-Norm(final)=3.049 | 3779.9 samples/s | 59.1 steps/s
[Step=8150 Epoch=39.8] | Loss=0.02101 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.260 | L2-Norm(final)=3.049 | 3784.6 samples/s | 59.1 steps/s
[Step=8200 Epoch=40.0] | Loss=0.01913 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.258 | L2-Norm(final)=3.050 | 4699.9 samples/s | 73.4 steps/s
[Step=8250 Epoch=40.3] | Loss=0.01636 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.256 | L2-Norm(final)=3.051 | 1542.3 samples/s | 24.1 steps/s
[Step=8300 Epoch=40.5] | Loss=0.01477 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.255 | L2-Norm(final)=3.053 | 3770.5 samples/s | 58.9 steps/s
[Step=8350 Epoch=40.7] | Loss=0.01353 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.254 | L2-Norm(final)=3.055 | 3786.3 samples/s | 59.2 steps/s
[Step=8400 Epoch=41.0] | Loss=0.01251 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.254 | L2-Norm(final)=3.056 | 4506.8 samples/s | 70.4 steps/s
[Step=8450 Epoch=41.2] | Loss=0.01161 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.254 | L2-Norm(final)=3.058 | 1554.9 samples/s | 24.3 steps/s
[Step=8500 Epoch=41.5] | Loss=0.01100 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.253 | L2-Norm(final)=3.060 | 3786.7 samples/s | 59.2 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01040 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.253 | L2-Norm(final)=3.062 | 3784.4 samples/s | 59.1 steps/s
[Step=8600 Epoch=42.0] | Loss=0.00995 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.253 | L2-Norm(final)=3.064 | 4324.6 samples/s | 67.6 steps/s
[Step=8650 Epoch=42.2] | Loss=0.00950 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.253 | L2-Norm(final)=3.065 | 1589.9 samples/s | 24.8 steps/s
[Step=8700 Epoch=42.5] | Loss=0.00909 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.253 | L2-Norm(final)=3.067 | 3748.7 samples/s | 58.6 steps/s
[Step=8750 Epoch=42.7] | Loss=0.00872 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.253 | L2-Norm(final)=3.069 | 3767.3 samples/s | 58.9 steps/s
[Step=8800 Epoch=42.9] | Loss=0.00839 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.253 | L2-Norm(final)=3.071 | 4160.6 samples/s | 65.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step8800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=62.4] | Loss=0.24197 | Reg=0.00334 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.287 | L2-Norm(final)=3.052 | 3332.2 samples/s | 52.1 steps/s
[Step=12850 Epoch=62.6] | Loss=0.03649 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.270 | L2-Norm(final)=3.047 | 3679.4 samples/s | 57.5 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02530 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.263 | L2-Norm(final)=3.045 | 3768.6 samples/s | 58.9 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02086 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.260 | L2-Norm(final)=3.046 | 3778.7 samples/s | 59.0 steps/s
[Step=13000 Epoch=63.3] | Loss=0.01926 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.258 | L2-Norm(final)=3.047 | 4668.0 samples/s | 72.9 steps/s
[Step=13050 Epoch=63.6] | Loss=0.01665 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.256 | L2-Norm(final)=3.048 | 1557.7 samples/s | 24.3 steps/s
[Step=13100 Epoch=63.8] | Loss=0.01481 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.255 | L2-Norm(final)=3.050 | 3770.4 samples/s | 58.9 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01351 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.255 | L2-Norm(final)=3.052 | 3796.0 samples/s | 59.3 steps/s
[Step=13200 Epoch=64.3] | Loss=0.01259 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.255 | L2-Norm(final)=3.054 | 4433.5 samples/s | 69.3 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01172 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.255 | L2-Norm(final)=3.056 | 1582.0 samples/s | 24.7 steps/s
[Step=13300 Epoch=64.8] | Loss=0.01097 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.255 | L2-Norm(final)=3.058 | 3751.5 samples/s | 58.6 steps/s
[Step=13350 Epoch=65.0] | Loss=0.01035 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.255 | L2-Norm(final)=3.060 | 3775.1 samples/s | 59.0 steps/s
[Step=13400 Epoch=65.3] | Loss=0.00985 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.255 | L2-Norm(final)=3.062 | 4228.6 samples/s | 66.1 steps/s
[Step=13450 Epoch=65.5] | Loss=0.00942 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.255 | L2-Norm(final)=3.064 | 1605.5 samples/s | 25.1 steps/s
[Step=13500 Epoch=65.8] | Loss=0.00905 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.255 | L2-Norm(final)=3.066 | 3785.1 samples/s | 59.1 steps/s
[Step=13550 Epoch=66.0] | Loss=0.00871 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.255 | L2-Norm(final)=3.068 | 3778.4 samples/s | 59.0 steps/s
[Step=13600 Epoch=66.3] | Loss=0.00839 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.255 | L2-Norm(final)=3.070 | 4038.7 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step13600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=11201 Epoch=106.1] | Loss=0.11670 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.287 | L2-Norm(final)=3.052 | 3204.2 samples/s | 50.1 steps/s
[Step=11250 Epoch=106.6] | Loss=0.00983 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.247 | L2-Norm(final)=3.050 | 3457.2 samples/s | 54.0 steps/s
[Step=11300 Epoch=107.1] | Loss=0.00523 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.240 | L2-Norm(final)=3.050 | 4527.9 samples/s | 70.7 steps/s
[Step=11350 Epoch=107.6] | Loss=0.00358 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.235 | L2-Norm(final)=3.051 | 1502.4 samples/s | 23.5 steps/s
[Step=11400 Epoch=108.0] | Loss=0.00271 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.231 | L2-Norm(final)=3.052 | 4239.4 samples/s | 66.2 steps/s
[Step=11450 Epoch=108.5] | Loss=0.00218 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.228 | L2-Norm(final)=3.053 | 1521.3 samples/s | 23.8 steps/s
[Step=11500 Epoch=109.0] | Loss=0.00183 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.225 | L2-Norm(final)=3.053 | 4023.8 samples/s | 62.9 steps/s
[Step=11550 Epoch=109.4] | Loss=0.00158 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.222 | L2-Norm(final)=3.054 | 1554.0 samples/s | 24.3 steps/s
[Step=11600 Epoch=109.9] | Loss=0.00139 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.220 | L2-Norm(final)=3.054 | 3810.6 samples/s | 59.5 steps/s
[Step=11650 Epoch=110.4] | Loss=0.00124 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.218 | L2-Norm(final)=3.055 | 1593.7 samples/s | 24.9 steps/s
[Step=11700 Epoch=110.9] | Loss=0.00112 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=3.055 | 3649.0 samples/s | 57.0 steps/s
[Step=11750 Epoch=111.3] | Loss=0.00102 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.214 | L2-Norm(final)=3.056 | 1621.2 samples/s | 25.3 steps/s
[Step=11800 Epoch=111.8] | Loss=0.00094 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=3.056 | 3606.6 samples/s | 56.4 steps/s
[Step=11850 Epoch=112.3] | Loss=0.00087 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.211 | L2-Norm(final)=3.056 | 1629.4 samples/s | 25.5 steps/s
[Step=11900 Epoch=112.8] | Loss=0.00081 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.209 | L2-Norm(final)=3.057 | 3603.8 samples/s | 56.3 steps/s
[Step=11950 Epoch=113.2] | Loss=0.00076 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.208 | L2-Norm(final)=3.057 | 1653.5 samples/s | 25.8 steps/s
[Step=12000 Epoch=113.7] | Loss=0.00072 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.207 | L2-Norm(final)=3.057 | 3541.0 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step12000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=129.4] | Loss=0.07032 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.287 | L2-Norm(final)=3.053 | 3297.5 samples/s | 51.5 steps/s
[Step=13650 Epoch=129.8] | Loss=0.00434 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.245 | L2-Norm(final)=3.056 | 3332.2 samples/s | 52.1 steps/s
[Step=13700 Epoch=130.3] | Loss=0.00244 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.237 | L2-Norm(final)=3.058 | 4537.4 samples/s | 70.9 steps/s
[Step=13750 Epoch=130.8] | Loss=0.00166 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.232 | L2-Norm(final)=3.059 | 1516.0 samples/s | 23.7 steps/s
[Step=13800 Epoch=131.3] | Loss=0.00126 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.228 | L2-Norm(final)=3.060 | 4288.7 samples/s | 67.0 steps/s
[Step=13850 Epoch=131.7] | Loss=0.00102 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.225 | L2-Norm(final)=3.060 | 1533.4 samples/s | 24.0 steps/s
[Step=13900 Epoch=132.2] | Loss=0.00086 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.222 | L2-Norm(final)=3.061 | 4034.4 samples/s | 63.0 steps/s
[Step=13950 Epoch=132.7] | Loss=0.00075 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.220 | L2-Norm(final)=3.061 | 1561.1 samples/s | 24.4 steps/s
[Step=14000 Epoch=133.2] | Loss=0.00066 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.217 | L2-Norm(final)=3.062 | 3831.7 samples/s | 59.9 steps/s
[Step=14050 Epoch=133.7] | Loss=0.00059 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.215 | L2-Norm(final)=3.062 | 1570.8 samples/s | 24.5 steps/s
[Step=14100 Epoch=134.1] | Loss=0.00054 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.214 | L2-Norm(final)=3.063 | 3663.0 samples/s | 57.2 steps/s
[Step=14150 Epoch=134.6] | Loss=0.00049 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=3.063 | 1617.2 samples/s | 25.3 steps/s
[Step=14200 Epoch=135.1] | Loss=0.00046 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.210 | L2-Norm(final)=3.063 | 3596.8 samples/s | 56.2 steps/s
[Step=14250 Epoch=135.6] | Loss=0.00042 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.209 | L2-Norm(final)=3.064 | 1632.9 samples/s | 25.5 steps/s
[Step=14300 Epoch=136.0] | Loss=0.00040 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.207 | L2-Norm(final)=3.064 | 3624.4 samples/s | 56.6 steps/s
[Step=14350 Epoch=136.5] | Loss=0.00037 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.206 | L2-Norm(final)=3.064 | 1630.7 samples/s | 25.5 steps/s
[Step=14400 Epoch=137.0] | Loss=0.00035 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.205 | L2-Norm(final)=3.064 | 3567.2 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step14400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=122.2] | Loss=0.10726 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.287 | L2-Norm(final)=3.052 | 3167.9 samples/s | 49.5 steps/s
[Step=12850 Epoch=122.7] | Loss=0.00744 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.247 | L2-Norm(final)=3.053 | 3493.7 samples/s | 54.6 steps/s
[Step=12900 Epoch=123.2] | Loss=0.00386 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.239 | L2-Norm(final)=3.054 | 4554.4 samples/s | 71.2 steps/s
[Step=12950 Epoch=123.7] | Loss=0.00260 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.234 | L2-Norm(final)=3.055 | 1493.7 samples/s | 23.3 steps/s
[Step=13000 Epoch=124.1] | Loss=0.00197 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.229 | L2-Norm(final)=3.056 | 4324.6 samples/s | 67.6 steps/s
[Step=13050 Epoch=124.6] | Loss=0.00158 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.226 | L2-Norm(final)=3.056 | 1521.0 samples/s | 23.8 steps/s
[Step=13100 Epoch=125.1] | Loss=0.00133 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.223 | L2-Norm(final)=3.057 | 4125.2 samples/s | 64.5 steps/s
[Step=13150 Epoch=125.6] | Loss=0.00114 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.220 | L2-Norm(final)=3.057 | 1561.1 samples/s | 24.4 steps/s
[Step=13200 Epoch=126.1] | Loss=0.00101 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.218 | L2-Norm(final)=3.057 | 3932.1 samples/s | 61.4 steps/s
[Step=13250 Epoch=126.5] | Loss=0.00090 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=3.058 | 1565.8 samples/s | 24.5 steps/s
[Step=13300 Epoch=127.0] | Loss=0.00081 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.214 | L2-Norm(final)=3.058 | 3807.3 samples/s | 59.5 steps/s
[Step=13350 Epoch=127.5] | Loss=0.00074 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=3.058 | 1594.1 samples/s | 24.9 steps/s
[Step=13400 Epoch=128.0] | Loss=0.00068 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.210 | L2-Norm(final)=3.059 | 3651.2 samples/s | 57.0 steps/s
[Step=13450 Epoch=128.4] | Loss=0.00063 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.209 | L2-Norm(final)=3.059 | 1620.2 samples/s | 25.3 steps/s
[Step=13500 Epoch=128.9] | Loss=0.00059 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.207 | L2-Norm(final)=3.059 | 3593.0 samples/s | 56.1 steps/s
[Step=13550 Epoch=129.4] | Loss=0.00055 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.206 | L2-Norm(final)=3.059 | 1623.0 samples/s | 25.4 steps/s
[Step=13600 Epoch=129.9] | Loss=0.00052 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.205 | L2-Norm(final)=3.060 | 3616.5 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29528 | acc=0.8275 | tpr=0.7538 | fpr=0.0124 | 3710.8 samples/s | 14.5 steps/s
Avg test loss: 0.30579, Avg test acc: 0.82663, Avg tpr: 0.75427, Avg fpr: 0.01423, total FA: 111

Testing server on iccad2012
[Step=  50] | Loss=0.41202 | acc=0.8261 | tpr=0.9602 | fpr=0.1763 | 3719.7 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.41990 | acc=0.8257 | tpr=0.9723 | fpr=0.1771 | 7441.8 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.42603 | acc=0.8237 | tpr=0.9784 | fpr=0.1791 | 7206.2 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.43121 | acc=0.8221 | tpr=0.9781 | fpr=0.1807 | 7482.1 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.43117 | acc=0.8210 | tpr=0.9790 | fpr=0.1818 | 7377.7 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.43090 | acc=0.8210 | tpr=0.9811 | fpr=0.1819 | 7537.6 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.43281 | acc=0.8203 | tpr=0.9806 | fpr=0.1826 | 7330.2 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.43483 | acc=0.8203 | tpr=0.9792 | fpr=0.1826 | 7288.0 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.43494 | acc=0.8203 | tpr=0.9776 | fpr=0.1826 | 7151.9 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.43508 | acc=0.8200 | tpr=0.9767 | fpr=0.1829 | 7346.3 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.43432 | acc=0.8202 | tpr=0.9753 | fpr=0.1827 | 13294.4 samples/s | 51.9 steps/s
Avg test loss: 0.43386, Avg test acc: 0.82023, Avg tpr: 0.97504, Avg fpr: 0.18259, total FA: 25352

server round 34/50

clients selected: [0 5 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=11201 Epoch=54.6] | Loss=0.23454 | Reg=0.00333 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.247 | L2-Norm(final)=3.068 | 3292.9 samples/s | 51.5 steps/s
[Step=11250 Epoch=54.9] | Loss=0.03645 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.227 | L2-Norm(final)=3.063 | 3690.7 samples/s | 57.7 steps/s
[Step=11300 Epoch=55.1] | Loss=0.02599 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.221 | L2-Norm(final)=3.061 | 3783.2 samples/s | 59.1 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02141 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.218 | L2-Norm(final)=3.062 | 3784.7 samples/s | 59.1 steps/s
[Step=11400 Epoch=55.6] | Loss=0.01918 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=3.063 | 4707.8 samples/s | 73.6 steps/s
[Step=11450 Epoch=55.8] | Loss=0.01679 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.215 | L2-Norm(final)=3.065 | 1549.3 samples/s | 24.2 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01474 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.214 | L2-Norm(final)=3.067 | 3761.1 samples/s | 58.8 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01357 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.214 | L2-Norm(final)=3.069 | 3789.4 samples/s | 59.2 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01281 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.214 | L2-Norm(final)=3.071 | 4458.7 samples/s | 69.7 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01185 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=3.073 | 1585.5 samples/s | 24.8 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01117 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=3.075 | 3762.7 samples/s | 58.8 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01062 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=3.076 | 3779.3 samples/s | 59.1 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01016 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=3.078 | 4246.6 samples/s | 66.4 steps/s
[Step=11850 Epoch=57.8] | Loss=0.00959 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.213 | L2-Norm(final)=3.080 | 1603.0 samples/s | 25.0 steps/s
[Step=11900 Epoch=58.0] | Loss=0.00916 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.213 | L2-Norm(final)=3.082 | 3779.3 samples/s | 59.1 steps/s
[Step=11950 Epoch=58.3] | Loss=0.00891 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=3.084 | 3782.8 samples/s | 59.1 steps/s
[Step=12000 Epoch=58.5] | Loss=0.00856 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.214 | L2-Norm(final)=3.086 | 4045.1 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=113.7] | Loss=0.15517 | Reg=0.00333 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.247 | L2-Norm(final)=3.069 | 3071.3 samples/s | 48.0 steps/s
[Step=12050 Epoch=114.2] | Loss=0.01026 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.211 | L2-Norm(final)=3.067 | 3626.4 samples/s | 56.7 steps/s
[Step=12100 Epoch=114.7] | Loss=0.00530 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.204 | L2-Norm(final)=3.068 | 4530.8 samples/s | 70.8 steps/s
[Step=12150 Epoch=115.1] | Loss=0.00358 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.199 | L2-Norm(final)=3.069 | 1499.2 samples/s | 23.4 steps/s
[Step=12200 Epoch=115.6] | Loss=0.00271 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.195 | L2-Norm(final)=3.069 | 4258.3 samples/s | 66.5 steps/s
[Step=12250 Epoch=116.1] | Loss=0.00219 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.191 | L2-Norm(final)=3.070 | 1522.8 samples/s | 23.8 steps/s
[Step=12300 Epoch=116.6] | Loss=0.00183 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.189 | L2-Norm(final)=3.070 | 4016.5 samples/s | 62.8 steps/s
[Step=12350 Epoch=117.0] | Loss=0.00158 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.186 | L2-Norm(final)=3.070 | 1564.5 samples/s | 24.4 steps/s
[Step=12400 Epoch=117.5] | Loss=0.00139 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.184 | L2-Norm(final)=3.071 | 3817.4 samples/s | 59.6 steps/s
[Step=12450 Epoch=118.0] | Loss=0.00124 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.182 | L2-Norm(final)=3.071 | 1594.8 samples/s | 24.9 steps/s
[Step=12500 Epoch=118.4] | Loss=0.00112 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.180 | L2-Norm(final)=3.072 | 3645.4 samples/s | 57.0 steps/s
[Step=12550 Epoch=118.9] | Loss=0.00102 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=3.072 | 1615.4 samples/s | 25.2 steps/s
[Step=12600 Epoch=119.4] | Loss=0.00094 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.072 | 3622.8 samples/s | 56.6 steps/s
[Step=12650 Epoch=119.9] | Loss=0.00087 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=3.072 | 1639.7 samples/s | 25.6 steps/s
[Step=12700 Epoch=120.3] | Loss=0.00082 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.174 | L2-Norm(final)=3.073 | 3613.4 samples/s | 56.5 steps/s
[Step=12750 Epoch=120.8] | Loss=0.00076 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.172 | L2-Norm(final)=3.073 | 1637.0 samples/s | 25.6 steps/s
[Step=12800 Epoch=121.3] | Loss=0.00072 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.171 | L2-Norm(final)=3.073 | 3589.8 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step12800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=129.9] | Loss=0.12951 | Reg=0.00333 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.247 | L2-Norm(final)=3.069 | 3166.9 samples/s | 49.5 steps/s
[Step=13650 Epoch=130.3] | Loss=0.00807 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.209 | L2-Norm(final)=3.069 | 3529.2 samples/s | 55.1 steps/s
[Step=13700 Epoch=130.8] | Loss=0.00426 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.201 | L2-Norm(final)=3.069 | 4563.1 samples/s | 71.3 steps/s
[Step=13750 Epoch=131.3] | Loss=0.00287 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.195 | L2-Norm(final)=3.070 | 1488.0 samples/s | 23.2 steps/s
[Step=13800 Epoch=131.8] | Loss=0.00217 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.191 | L2-Norm(final)=3.070 | 4310.3 samples/s | 67.3 steps/s
[Step=13850 Epoch=132.3] | Loss=0.00174 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.188 | L2-Norm(final)=3.071 | 1511.0 samples/s | 23.6 steps/s
[Step=13900 Epoch=132.7] | Loss=0.00146 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.185 | L2-Norm(final)=3.071 | 4130.3 samples/s | 64.5 steps/s
[Step=13950 Epoch=133.2] | Loss=0.00126 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.183 | L2-Norm(final)=3.072 | 1530.6 samples/s | 23.9 steps/s
[Step=14000 Epoch=133.7] | Loss=0.00111 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.180 | L2-Norm(final)=3.072 | 3962.9 samples/s | 61.9 steps/s
[Step=14050 Epoch=134.2] | Loss=0.00099 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=3.072 | 1564.6 samples/s | 24.4 steps/s
[Step=14100 Epoch=134.6] | Loss=0.00090 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.072 | 3810.7 samples/s | 59.5 steps/s
[Step=14150 Epoch=135.1] | Loss=0.00082 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=3.073 | 1586.8 samples/s | 24.8 steps/s
[Step=14200 Epoch=135.6] | Loss=0.00075 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.173 | L2-Norm(final)=3.073 | 3639.6 samples/s | 56.9 steps/s
[Step=14250 Epoch=136.1] | Loss=0.00070 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.172 | L2-Norm(final)=3.073 | 1618.8 samples/s | 25.3 steps/s
[Step=14300 Epoch=136.6] | Loss=0.00065 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.170 | L2-Norm(final)=3.073 | 3597.9 samples/s | 56.2 steps/s
[Step=14350 Epoch=137.0] | Loss=0.00061 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.169 | L2-Norm(final)=3.074 | 1626.2 samples/s | 25.4 steps/s
[Step=14400 Epoch=137.5] | Loss=0.00057 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.168 | L2-Norm(final)=3.074 | 3648.8 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step14400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=19201 Epoch=180.9] | Loss=0.05437 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.247 | L2-Norm(final)=3.069 | 3410.5 samples/s | 53.3 steps/s
[Step=19250 Epoch=181.4] | Loss=0.00576 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.205 | L2-Norm(final)=3.068 | 3301.5 samples/s | 51.6 steps/s
[Step=19300 Epoch=181.9] | Loss=0.00297 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.196 | L2-Norm(final)=3.069 | 4513.8 samples/s | 70.5 steps/s
[Step=19350 Epoch=182.3] | Loss=0.00201 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.190 | L2-Norm(final)=3.070 | 1498.6 samples/s | 23.4 steps/s
[Step=19400 Epoch=182.8] | Loss=0.00153 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.186 | L2-Norm(final)=3.071 | 4180.7 samples/s | 65.3 steps/s
[Step=19450 Epoch=183.3] | Loss=0.00124 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.183 | L2-Norm(final)=3.071 | 1541.6 samples/s | 24.1 steps/s
[Step=19500 Epoch=183.7] | Loss=0.00104 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.180 | L2-Norm(final)=3.072 | 3949.8 samples/s | 61.7 steps/s
[Step=19550 Epoch=184.2] | Loss=0.00090 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.072 | 1583.5 samples/s | 24.7 steps/s
[Step=19600 Epoch=184.7] | Loss=0.00080 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=3.073 | 3704.5 samples/s | 57.9 steps/s
[Step=19650 Epoch=185.2] | Loss=0.00071 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.173 | L2-Norm(final)=3.073 | 1611.1 samples/s | 25.2 steps/s
[Step=19700 Epoch=185.6] | Loss=0.00065 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.171 | L2-Norm(final)=3.074 | 3636.4 samples/s | 56.8 steps/s
[Step=19750 Epoch=186.1] | Loss=0.00059 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.169 | L2-Norm(final)=3.074 | 1635.4 samples/s | 25.6 steps/s
[Step=19800 Epoch=186.6] | Loss=0.00055 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.168 | L2-Norm(final)=3.074 | 3606.1 samples/s | 56.3 steps/s
[Step=19850 Epoch=187.0] | Loss=0.00051 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.166 | L2-Norm(final)=3.075 | 1628.8 samples/s | 25.4 steps/s
[Step=19900 Epoch=187.5] | Loss=0.00047 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.165 | L2-Norm(final)=3.075 | 3625.2 samples/s | 56.6 steps/s
[Step=19950 Epoch=188.0] | Loss=0.00044 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.163 | L2-Norm(final)=3.075 | 1706.5 samples/s | 26.7 steps/s
[Step=20000 Epoch=188.5] | Loss=0.00042 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.162 | L2-Norm(final)=3.075 | 3355.9 samples/s | 52.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step20000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=17601 Epoch=167.8] | Loss=0.05859 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.247 | L2-Norm(final)=3.069 | 3168.1 samples/s | 49.5 steps/s
[Step=17650 Epoch=168.2] | Loss=0.00645 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.211 | L2-Norm(final)=3.069 | 3528.3 samples/s | 55.1 steps/s
[Step=17700 Epoch=168.7] | Loss=0.00343 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.204 | L2-Norm(final)=3.070 | 4525.2 samples/s | 70.7 steps/s
[Step=17750 Epoch=169.2] | Loss=0.00233 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.199 | L2-Norm(final)=3.071 | 1489.5 samples/s | 23.3 steps/s
[Step=17800 Epoch=169.7] | Loss=0.00176 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.195 | L2-Norm(final)=3.072 | 4324.9 samples/s | 67.6 steps/s
[Step=17850 Epoch=170.1] | Loss=0.00142 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.191 | L2-Norm(final)=3.072 | 1516.4 samples/s | 23.7 steps/s
[Step=17900 Epoch=170.6] | Loss=0.00119 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.188 | L2-Norm(final)=3.072 | 4120.4 samples/s | 64.4 steps/s
[Step=17950 Epoch=171.1] | Loss=0.00103 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.186 | L2-Norm(final)=3.073 | 1532.6 samples/s | 23.9 steps/s
[Step=18000 Epoch=171.6] | Loss=0.00091 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.183 | L2-Norm(final)=3.073 | 3972.1 samples/s | 62.1 steps/s
[Step=18050 Epoch=172.0] | Loss=0.00081 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.181 | L2-Norm(final)=3.073 | 1569.8 samples/s | 24.5 steps/s
[Step=18100 Epoch=172.5] | Loss=0.00073 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.179 | L2-Norm(final)=3.074 | 3778.5 samples/s | 59.0 steps/s
[Step=18150 Epoch=173.0] | Loss=0.00067 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.074 | 1587.8 samples/s | 24.8 steps/s
[Step=18200 Epoch=173.5] | Loss=0.00062 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=3.074 | 3637.0 samples/s | 56.8 steps/s
[Step=18250 Epoch=173.9] | Loss=0.00057 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.173 | L2-Norm(final)=3.075 | 1624.6 samples/s | 25.4 steps/s
[Step=18300 Epoch=174.4] | Loss=0.00054 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.172 | L2-Norm(final)=3.075 | 3609.3 samples/s | 56.4 steps/s
[Step=18350 Epoch=174.9] | Loss=0.00050 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.170 | L2-Norm(final)=3.075 | 1648.3 samples/s | 25.8 steps/s
[Step=18400 Epoch=175.4] | Loss=0.00047 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.169 | L2-Norm(final)=3.075 | 3573.1 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30921 | acc=0.8239 | tpr=0.7484 | fpr=0.0121 | 3736.4 samples/s | 14.6 steps/s
Avg test loss: 0.31982, Avg test acc: 0.82222, Avg tpr: 0.74762, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.41188 | acc=0.8310 | tpr=0.9602 | fpr=0.1713 | 3732.4 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.41984 | acc=0.8302 | tpr=0.9744 | fpr=0.1725 | 7541.4 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.42615 | acc=0.8280 | tpr=0.9798 | fpr=0.1748 | 7136.9 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.43131 | acc=0.8263 | tpr=0.9803 | fpr=0.1766 | 7495.6 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.43090 | acc=0.8253 | tpr=0.9799 | fpr=0.1775 | 7327.2 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.43067 | acc=0.8254 | tpr=0.9811 | fpr=0.1774 | 7290.5 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.43264 | acc=0.8249 | tpr=0.9800 | fpr=0.1779 | 7263.0 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.43481 | acc=0.8248 | tpr=0.9781 | fpr=0.1780 | 7489.6 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.43502 | acc=0.8249 | tpr=0.9771 | fpr=0.1779 | 7439.7 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.43514 | acc=0.8245 | tpr=0.9762 | fpr=0.1783 | 7116.4 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.43437 | acc=0.8246 | tpr=0.9753 | fpr=0.1781 | 13245.7 samples/s | 51.7 steps/s
Avg test loss: 0.43390, Avg test acc: 0.82468, Avg tpr: 0.97504, Avg fpr: 0.17806, total FA: 24723

server round 35/50

clients selected: [0 2 3 5 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=58.5] | Loss=0.16581 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.209 | L2-Norm(final)=3.083 | 3311.3 samples/s | 51.7 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03391 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.192 | L2-Norm(final)=3.079 | 3621.1 samples/s | 56.6 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02507 | Reg=0.00331 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.186 | L2-Norm(final)=3.077 | 3784.6 samples/s | 59.1 steps/s
[Step=12150 Epoch=59.2] | Loss=0.02218 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.182 | L2-Norm(final)=3.077 | 3794.5 samples/s | 59.3 steps/s
[Step=12200 Epoch=59.5] | Loss=0.01908 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.180 | L2-Norm(final)=3.077 | 4712.8 samples/s | 73.6 steps/s
[Step=12250 Epoch=59.7] | Loss=0.01681 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.179 | L2-Norm(final)=3.079 | 1562.1 samples/s | 24.4 steps/s
[Step=12300 Epoch=60.0] | Loss=0.01520 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=3.080 | 3785.2 samples/s | 59.1 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01371 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.178 | L2-Norm(final)=3.082 | 3797.9 samples/s | 59.3 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01277 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.177 | L2-Norm(final)=3.083 | 4422.5 samples/s | 69.1 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01177 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.085 | 1571.1 samples/s | 24.5 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01098 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.087 | 3768.7 samples/s | 58.9 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01046 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.089 | 3773.1 samples/s | 59.0 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01000 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.090 | 4247.2 samples/s | 66.4 steps/s
[Step=12650 Epoch=61.7] | Loss=0.00960 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.177 | L2-Norm(final)=3.092 | 1606.7 samples/s | 25.1 steps/s
[Step=12700 Epoch=61.9] | Loss=0.00925 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.094 | 3796.6 samples/s | 59.3 steps/s
[Step=12750 Epoch=62.2] | Loss=0.00885 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.177 | L2-Norm(final)=3.096 | 3792.7 samples/s | 59.3 steps/s
[Step=12800 Epoch=62.4] | Loss=0.00871 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.097 | 4045.6 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step12800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=66.3] | Loss=0.33763 | Reg=0.00332 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.209 | L2-Norm(final)=3.083 | 3251.5 samples/s | 50.8 steps/s
[Step=13650 Epoch=66.5] | Loss=0.03610 | Reg=0.00331 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.191 | L2-Norm(final)=3.077 | 3721.8 samples/s | 58.2 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02540 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.184 | L2-Norm(final)=3.076 | 3774.8 samples/s | 59.0 steps/s
[Step=13750 Epoch=67.0] | Loss=0.02072 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.181 | L2-Norm(final)=3.077 | 3773.8 samples/s | 59.0 steps/s
[Step=13800 Epoch=67.2] | Loss=0.01834 | Reg=0.00331 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.180 | L2-Norm(final)=3.078 | 4691.5 samples/s | 73.3 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01620 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.179 | L2-Norm(final)=3.080 | 1557.1 samples/s | 24.3 steps/s
[Step=13900 Epoch=67.7] | Loss=0.01425 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.179 | L2-Norm(final)=3.082 | 3788.0 samples/s | 59.2 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01312 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.178 | L2-Norm(final)=3.084 | 3764.7 samples/s | 58.8 steps/s
[Step=14000 Epoch=68.2] | Loss=0.01208 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=3.086 | 4442.1 samples/s | 69.4 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01133 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=3.087 | 1584.3 samples/s | 24.8 steps/s
[Step=14100 Epoch=68.7] | Loss=0.01054 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=3.089 | 3771.4 samples/s | 58.9 steps/s
[Step=14150 Epoch=68.9] | Loss=0.01005 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.178 | L2-Norm(final)=3.091 | 3760.4 samples/s | 58.8 steps/s
[Step=14200 Epoch=69.2] | Loss=0.00952 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=3.093 | 4227.4 samples/s | 66.1 steps/s
[Step=14250 Epoch=69.4] | Loss=0.00914 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=3.095 | 1598.7 samples/s | 25.0 steps/s
[Step=14300 Epoch=69.7] | Loss=0.00874 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=3.097 | 3798.7 samples/s | 59.4 steps/s
[Step=14350 Epoch=69.9] | Loss=0.00848 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=3.099 | 3758.1 samples/s | 58.7 steps/s
[Step=14400 Epoch=70.2] | Loss=0.00821 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.178 | L2-Norm(final)=3.100 | 4034.2 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step14400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=11201 Epoch=54.6] | Loss=0.12743 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.209 | L2-Norm(final)=3.083 | 3380.9 samples/s | 52.8 steps/s
[Step=11250 Epoch=54.9] | Loss=0.03112 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.191 | L2-Norm(final)=3.080 | 3591.1 samples/s | 56.1 steps/s
[Step=11300 Epoch=55.1] | Loss=0.02257 | Reg=0.00331 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.185 | L2-Norm(final)=3.079 | 3783.1 samples/s | 59.1 steps/s
[Step=11350 Epoch=55.3] | Loss=0.01897 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.182 | L2-Norm(final)=3.080 | 3788.0 samples/s | 59.2 steps/s
[Step=11400 Epoch=55.6] | Loss=0.01657 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.181 | L2-Norm(final)=3.081 | 4717.1 samples/s | 73.7 steps/s
[Step=11450 Epoch=55.8] | Loss=0.01540 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.180 | L2-Norm(final)=3.082 | 1544.4 samples/s | 24.1 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01425 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.179 | L2-Norm(final)=3.084 | 3767.8 samples/s | 58.9 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01339 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.179 | L2-Norm(final)=3.086 | 3784.2 samples/s | 59.1 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01243 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.178 | L2-Norm(final)=3.087 | 4457.3 samples/s | 69.6 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01166 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=3.088 | 1585.1 samples/s | 24.8 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01083 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=3.090 | 3761.4 samples/s | 58.8 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01018 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.092 | 3774.6 samples/s | 59.0 steps/s
[Step=11800 Epoch=57.5] | Loss=0.00995 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.093 | 4232.3 samples/s | 66.1 steps/s
[Step=11850 Epoch=57.8] | Loss=0.00975 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.095 | 1601.6 samples/s | 25.0 steps/s
[Step=11900 Epoch=58.0] | Loss=0.00947 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.096 | 3789.6 samples/s | 59.2 steps/s
[Step=11950 Epoch=58.3] | Loss=0.00919 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.098 | 3766.5 samples/s | 58.9 steps/s
[Step=12000 Epoch=58.5] | Loss=0.00885 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.176 | L2-Norm(final)=3.099 | 4033.7 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=121.3] | Loss=0.02494 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.209 | L2-Norm(final)=3.083 | 3284.5 samples/s | 51.3 steps/s
[Step=12850 Epoch=121.8] | Loss=0.01153 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.173 | L2-Norm(final)=3.083 | 3375.3 samples/s | 52.7 steps/s
[Step=12900 Epoch=122.2] | Loss=0.00649 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.166 | L2-Norm(final)=3.083 | 4523.0 samples/s | 70.7 steps/s
[Step=12950 Epoch=122.7] | Loss=0.00438 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.163 | L2-Norm(final)=3.083 | 1489.6 samples/s | 23.3 steps/s
[Step=13000 Epoch=123.2] | Loss=0.00330 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.159 | L2-Norm(final)=3.084 | 4263.3 samples/s | 66.6 steps/s
[Step=13050 Epoch=123.7] | Loss=0.00266 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.157 | L2-Norm(final)=3.084 | 1520.8 samples/s | 23.8 steps/s
[Step=13100 Epoch=124.1] | Loss=0.00222 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.154 | L2-Norm(final)=3.084 | 4031.1 samples/s | 63.0 steps/s
[Step=13150 Epoch=124.6] | Loss=0.00191 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.152 | L2-Norm(final)=3.085 | 1550.9 samples/s | 24.2 steps/s
[Step=13200 Epoch=125.1] | Loss=0.00168 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.150 | L2-Norm(final)=3.085 | 3848.5 samples/s | 60.1 steps/s
[Step=13250 Epoch=125.6] | Loss=0.00150 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.148 | L2-Norm(final)=3.085 | 1575.2 samples/s | 24.6 steps/s
[Step=13300 Epoch=126.0] | Loss=0.00135 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.146 | L2-Norm(final)=3.085 | 3670.7 samples/s | 57.4 steps/s
[Step=13350 Epoch=126.5] | Loss=0.00123 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.144 | L2-Norm(final)=3.086 | 1621.0 samples/s | 25.3 steps/s
[Step=13400 Epoch=127.0] | Loss=0.00113 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.143 | L2-Norm(final)=3.086 | 3617.9 samples/s | 56.5 steps/s
[Step=13450 Epoch=127.5] | Loss=0.00105 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.141 | L2-Norm(final)=3.086 | 1630.6 samples/s | 25.5 steps/s
[Step=13500 Epoch=127.9] | Loss=0.00098 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.140 | L2-Norm(final)=3.086 | 3601.8 samples/s | 56.3 steps/s
[Step=13550 Epoch=128.4] | Loss=0.00091 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.138 | L2-Norm(final)=3.086 | 1636.9 samples/s | 25.6 steps/s
[Step=13600 Epoch=128.9] | Loss=0.00086 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.137 | L2-Norm(final)=3.087 | 3551.7 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step13600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=137.5] | Loss=0.02398 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.209 | L2-Norm(final)=3.083 | 3316.8 samples/s | 51.8 steps/s
[Step=14450 Epoch=138.0] | Loss=0.00736 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=3.085 | 3429.6 samples/s | 53.6 steps/s
[Step=14500 Epoch=138.5] | Loss=0.00380 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.167 | L2-Norm(final)=3.086 | 4555.5 samples/s | 71.2 steps/s
[Step=14550 Epoch=138.9] | Loss=0.00255 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.162 | L2-Norm(final)=3.087 | 1502.5 samples/s | 23.5 steps/s
[Step=14600 Epoch=139.4] | Loss=0.00193 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.158 | L2-Norm(final)=3.087 | 4348.8 samples/s | 68.0 steps/s
[Step=14650 Epoch=139.9] | Loss=0.00156 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.154 | L2-Norm(final)=3.088 | 1511.3 samples/s | 23.6 steps/s
[Step=14700 Epoch=140.4] | Loss=0.00130 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.152 | L2-Norm(final)=3.088 | 4110.7 samples/s | 64.2 steps/s
[Step=14750 Epoch=140.9] | Loss=0.00112 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.149 | L2-Norm(final)=3.088 | 1560.5 samples/s | 24.4 steps/s
[Step=14800 Epoch=141.3] | Loss=0.00099 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.147 | L2-Norm(final)=3.088 | 3969.8 samples/s | 62.0 steps/s
[Step=14850 Epoch=141.8] | Loss=0.00088 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.145 | L2-Norm(final)=3.089 | 1576.9 samples/s | 24.6 steps/s
[Step=14900 Epoch=142.3] | Loss=0.00080 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.143 | L2-Norm(final)=3.089 | 3789.6 samples/s | 59.2 steps/s
[Step=14950 Epoch=142.8] | Loss=0.00073 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.141 | L2-Norm(final)=3.089 | 1591.2 samples/s | 24.9 steps/s
[Step=15000 Epoch=143.2] | Loss=0.00067 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.139 | L2-Norm(final)=3.089 | 3678.9 samples/s | 57.5 steps/s
[Step=15050 Epoch=143.7] | Loss=0.00062 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.137 | L2-Norm(final)=3.089 | 1636.3 samples/s | 25.6 steps/s
[Step=15100 Epoch=144.2] | Loss=0.00058 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.136 | L2-Norm(final)=3.089 | 3598.6 samples/s | 56.2 steps/s
[Step=15150 Epoch=144.7] | Loss=0.00054 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=3.090 | 1623.3 samples/s | 25.4 steps/s
[Step=15200 Epoch=145.2] | Loss=0.00051 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.133 | L2-Norm(final)=3.090 | 3608.6 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32133 | acc=0.8186 | tpr=0.7400 | fpr=0.0107 | 3749.8 samples/s | 14.6 steps/s
Avg test loss: 0.33129, Avg test acc: 0.81713, Avg tpr: 0.73964, Avg fpr: 0.01243, total FA: 97

Testing server on iccad2012
[Step=  50] | Loss=0.40058 | acc=0.8370 | tpr=0.9602 | fpr=0.1652 | 3722.6 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.40877 | acc=0.8361 | tpr=0.9680 | fpr=0.1664 | 7328.5 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.41491 | acc=0.8345 | tpr=0.9755 | fpr=0.1681 | 7450.5 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.42010 | acc=0.8324 | tpr=0.9770 | fpr=0.1702 | 7355.4 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.41948 | acc=0.8315 | tpr=0.9773 | fpr=0.1711 | 7412.3 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.41912 | acc=0.8315 | tpr=0.9789 | fpr=0.1711 | 8142.8 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.42121 | acc=0.8309 | tpr=0.9781 | fpr=0.1718 | 6853.6 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.42339 | acc=0.8308 | tpr=0.9759 | fpr=0.1718 | 7368.8 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.42351 | acc=0.8311 | tpr=0.9752 | fpr=0.1715 | 7072.1 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.42363 | acc=0.8308 | tpr=0.9744 | fpr=0.1718 | 7432.5 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.42289 | acc=0.8309 | tpr=0.9733 | fpr=0.1717 | 13193.7 samples/s | 51.5 steps/s
Avg test loss: 0.42242, Avg test acc: 0.83101, Avg tpr: 0.97306, Avg fpr: 0.17158, total FA: 23823

server round 36/50

clients selected: [1 2 3 5 6]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=8801 Epoch=42.9] | Loss=0.26340 | Reg=0.00330 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.179 | L2-Norm(final)=3.093 | 3122.8 samples/s | 48.8 steps/s
[Step=8850 Epoch=43.2] | Loss=0.03699 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.164 | L2-Norm(final)=3.088 | 3932.5 samples/s | 61.4 steps/s
[Step=8900 Epoch=43.4] | Loss=0.02498 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.157 | L2-Norm(final)=3.087 | 3774.5 samples/s | 59.0 steps/s
[Step=8950 Epoch=43.7] | Loss=0.02019 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.153 | L2-Norm(final)=3.088 | 3780.1 samples/s | 59.1 steps/s
[Step=9000 Epoch=43.9] | Loss=0.01816 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.151 | L2-Norm(final)=3.089 | 4707.5 samples/s | 73.6 steps/s
[Step=9050 Epoch=44.2] | Loss=0.01550 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.150 | L2-Norm(final)=3.090 | 1542.3 samples/s | 24.1 steps/s
[Step=9100 Epoch=44.4] | Loss=0.01390 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.149 | L2-Norm(final)=3.092 | 3731.6 samples/s | 58.3 steps/s
[Step=9150 Epoch=44.6] | Loss=0.01280 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.148 | L2-Norm(final)=3.094 | 3778.2 samples/s | 59.0 steps/s
[Step=9200 Epoch=44.9] | Loss=0.01182 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.148 | L2-Norm(final)=3.096 | 4493.6 samples/s | 70.2 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01102 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.147 | L2-Norm(final)=3.098 | 1560.0 samples/s | 24.4 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01048 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.147 | L2-Norm(final)=3.099 | 3758.6 samples/s | 58.7 steps/s
[Step=9350 Epoch=45.6] | Loss=0.00992 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.147 | L2-Norm(final)=3.101 | 3786.3 samples/s | 59.2 steps/s
[Step=9400 Epoch=45.9] | Loss=0.00935 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.147 | L2-Norm(final)=3.103 | 4305.5 samples/s | 67.3 steps/s
[Step=9450 Epoch=46.1] | Loss=0.00894 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.147 | L2-Norm(final)=3.105 | 1591.8 samples/s | 24.9 steps/s
[Step=9500 Epoch=46.4] | Loss=0.00850 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.147 | L2-Norm(final)=3.106 | 3793.7 samples/s | 59.3 steps/s
[Step=9550 Epoch=46.6] | Loss=0.00823 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.147 | L2-Norm(final)=3.108 | 3794.2 samples/s | 59.3 steps/s
[Step=9600 Epoch=46.8] | Loss=0.00797 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.147 | L2-Norm(final)=3.109 | 4157.2 samples/s | 65.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step9600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=70.2] | Loss=0.24752 | Reg=0.00330 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.179 | L2-Norm(final)=3.093 | 3445.4 samples/s | 53.8 steps/s
[Step=14450 Epoch=70.4] | Loss=0.03431 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.166 | L2-Norm(final)=3.090 | 3531.7 samples/s | 55.2 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02619 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.161 | L2-Norm(final)=3.089 | 3761.3 samples/s | 58.8 steps/s
[Step=14550 Epoch=70.9] | Loss=0.02112 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.158 | L2-Norm(final)=3.089 | 3790.7 samples/s | 59.2 steps/s
[Step=14600 Epoch=71.1] | Loss=0.01853 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.156 | L2-Norm(final)=3.090 | 4702.9 samples/s | 73.5 steps/s
[Step=14650 Epoch=71.4] | Loss=0.01604 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.155 | L2-Norm(final)=3.091 | 1543.9 samples/s | 24.1 steps/s
[Step=14700 Epoch=71.6] | Loss=0.01442 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.153 | L2-Norm(final)=3.093 | 3764.5 samples/s | 58.8 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01303 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.153 | L2-Norm(final)=3.095 | 3772.3 samples/s | 58.9 steps/s
[Step=14800 Epoch=72.1] | Loss=0.01211 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.152 | L2-Norm(final)=3.096 | 4469.4 samples/s | 69.8 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01133 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.152 | L2-Norm(final)=3.098 | 1583.3 samples/s | 24.7 steps/s
[Step=14900 Epoch=72.6] | Loss=0.01076 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.152 | L2-Norm(final)=3.100 | 3781.4 samples/s | 59.1 steps/s
[Step=14950 Epoch=72.8] | Loss=0.01010 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.152 | L2-Norm(final)=3.102 | 3792.8 samples/s | 59.3 steps/s
[Step=15000 Epoch=73.1] | Loss=0.00953 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.152 | L2-Norm(final)=3.103 | 4242.2 samples/s | 66.3 steps/s
[Step=15050 Epoch=73.3] | Loss=0.00907 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.152 | L2-Norm(final)=3.105 | 1606.2 samples/s | 25.1 steps/s
[Step=15100 Epoch=73.6] | Loss=0.00868 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.152 | L2-Norm(final)=3.107 | 3780.4 samples/s | 59.1 steps/s
[Step=15150 Epoch=73.8] | Loss=0.00838 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.152 | L2-Norm(final)=3.108 | 3758.1 samples/s | 58.7 steps/s
[Step=15200 Epoch=74.1] | Loss=0.00812 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.152 | L2-Norm(final)=3.110 | 4039.7 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step15200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=58.5] | Loss=0.21822 | Reg=0.00330 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.179 | L2-Norm(final)=3.093 | 3239.2 samples/s | 50.6 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03229 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.164 | L2-Norm(final)=3.088 | 3728.9 samples/s | 58.3 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02318 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.158 | L2-Norm(final)=3.087 | 3766.4 samples/s | 58.8 steps/s
[Step=12150 Epoch=59.3] | Loss=0.01902 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.155 | L2-Norm(final)=3.088 | 3770.4 samples/s | 58.9 steps/s
[Step=12200 Epoch=59.5] | Loss=0.01775 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.152 | L2-Norm(final)=3.088 | 4693.5 samples/s | 73.3 steps/s
[Step=12250 Epoch=59.7] | Loss=0.01546 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.150 | L2-Norm(final)=3.090 | 1530.3 samples/s | 23.9 steps/s
[Step=12300 Epoch=60.0] | Loss=0.01367 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.149 | L2-Norm(final)=3.091 | 3784.9 samples/s | 59.1 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01257 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.148 | L2-Norm(final)=3.093 | 3783.3 samples/s | 59.1 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01171 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.148 | L2-Norm(final)=3.094 | 4460.5 samples/s | 69.7 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01095 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.147 | L2-Norm(final)=3.096 | 1586.7 samples/s | 24.8 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01040 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.147 | L2-Norm(final)=3.098 | 3765.7 samples/s | 58.8 steps/s
[Step=12550 Epoch=61.2] | Loss=0.00994 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.146 | L2-Norm(final)=3.099 | 3781.1 samples/s | 59.1 steps/s
[Step=12600 Epoch=61.4] | Loss=0.00941 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.146 | L2-Norm(final)=3.101 | 4231.9 samples/s | 66.1 steps/s
[Step=12650 Epoch=61.7] | Loss=0.00889 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.146 | L2-Norm(final)=3.103 | 1606.6 samples/s | 25.1 steps/s
[Step=12700 Epoch=61.9] | Loss=0.00852 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.146 | L2-Norm(final)=3.104 | 3781.7 samples/s | 59.1 steps/s
[Step=12750 Epoch=62.2] | Loss=0.00825 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.146 | L2-Norm(final)=3.106 | 3787.2 samples/s | 59.2 steps/s
[Step=12800 Epoch=62.4] | Loss=0.00791 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.146 | L2-Norm(final)=3.108 | 4026.2 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step12800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=128.9] | Loss=0.12715 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.179 | L2-Norm(final)=3.093 | 3253.0 samples/s | 50.8 steps/s
[Step=13650 Epoch=129.3] | Loss=0.00795 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.139 | L2-Norm(final)=3.092 | 3468.8 samples/s | 54.2 steps/s
[Step=13700 Epoch=129.8] | Loss=0.00432 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.132 | L2-Norm(final)=3.093 | 4533.5 samples/s | 70.8 steps/s
[Step=13750 Epoch=130.3] | Loss=0.00294 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.128 | L2-Norm(final)=3.094 | 1477.3 samples/s | 23.1 steps/s
[Step=13800 Epoch=130.8] | Loss=0.00224 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.124 | L2-Norm(final)=3.095 | 4261.2 samples/s | 66.6 steps/s
[Step=13850 Epoch=131.2] | Loss=0.00181 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.121 | L2-Norm(final)=3.096 | 1530.8 samples/s | 23.9 steps/s
[Step=13900 Epoch=131.7] | Loss=0.00152 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.119 | L2-Norm(final)=3.096 | 4001.8 samples/s | 62.5 steps/s
[Step=13950 Epoch=132.2] | Loss=0.00131 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.116 | L2-Norm(final)=3.097 | 1556.3 samples/s | 24.3 steps/s
[Step=14000 Epoch=132.7] | Loss=0.00115 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.114 | L2-Norm(final)=3.097 | 3822.5 samples/s | 59.7 steps/s
[Step=14050 Epoch=133.1] | Loss=0.00103 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.112 | L2-Norm(final)=3.098 | 1581.1 samples/s | 24.7 steps/s
[Step=14100 Epoch=133.6] | Loss=0.00093 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.110 | L2-Norm(final)=3.098 | 3642.4 samples/s | 56.9 steps/s
[Step=14150 Epoch=134.1] | Loss=0.00085 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.109 | L2-Norm(final)=3.098 | 1629.0 samples/s | 25.5 steps/s
[Step=14200 Epoch=134.6] | Loss=0.00078 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.107 | L2-Norm(final)=3.099 | 3629.0 samples/s | 56.7 steps/s
[Step=14250 Epoch=135.0] | Loss=0.00073 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.106 | L2-Norm(final)=3.099 | 1639.6 samples/s | 25.6 steps/s
[Step=14300 Epoch=135.5] | Loss=0.00068 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.104 | L2-Norm(final)=3.099 | 3610.9 samples/s | 56.4 steps/s
[Step=14350 Epoch=136.0] | Loss=0.00064 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.103 | L2-Norm(final)=3.100 | 1647.6 samples/s | 25.7 steps/s
[Step=14400 Epoch=136.5] | Loss=0.00060 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.102 | L2-Norm(final)=3.100 | 3579.5 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step14400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=137.0] | Loss=0.04170 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.179 | L2-Norm(final)=3.093 | 3339.9 samples/s | 52.2 steps/s
[Step=14450 Epoch=137.5] | Loss=0.00890 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.136 | L2-Norm(final)=3.093 | 3401.4 samples/s | 53.1 steps/s
[Step=14500 Epoch=137.9] | Loss=0.00480 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.129 | L2-Norm(final)=3.093 | 4550.3 samples/s | 71.1 steps/s
[Step=14550 Epoch=138.4] | Loss=0.00323 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=3.094 | 1491.4 samples/s | 23.3 steps/s
[Step=14600 Epoch=138.9] | Loss=0.00243 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.122 | L2-Norm(final)=3.094 | 4280.3 samples/s | 66.9 steps/s
[Step=14650 Epoch=139.4] | Loss=0.00196 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.119 | L2-Norm(final)=3.094 | 1519.6 samples/s | 23.7 steps/s
[Step=14700 Epoch=139.8] | Loss=0.00164 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.116 | L2-Norm(final)=3.095 | 4009.9 samples/s | 62.7 steps/s
[Step=14750 Epoch=140.3] | Loss=0.00141 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.114 | L2-Norm(final)=3.095 | 1536.0 samples/s | 24.0 steps/s
[Step=14800 Epoch=140.8] | Loss=0.00124 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.112 | L2-Norm(final)=3.095 | 3648.3 samples/s | 57.0 steps/s
[Step=14850 Epoch=141.3] | Loss=0.00111 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.110 | L2-Norm(final)=3.096 | 1504.7 samples/s | 23.5 steps/s
[Step=14900 Epoch=141.7] | Loss=0.00100 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.109 | L2-Norm(final)=3.096 | 3499.7 samples/s | 54.7 steps/s
[Step=14950 Epoch=142.2] | Loss=0.00091 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.107 | L2-Norm(final)=3.096 | 1541.2 samples/s | 24.1 steps/s
[Step=15000 Epoch=142.7] | Loss=0.00084 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.105 | L2-Norm(final)=3.097 | 3401.3 samples/s | 53.1 steps/s
[Step=15050 Epoch=143.2] | Loss=0.00078 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.104 | L2-Norm(final)=3.097 | 1553.5 samples/s | 24.3 steps/s
[Step=15100 Epoch=143.6] | Loss=0.00072 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.102 | L2-Norm(final)=3.097 | 3549.5 samples/s | 55.5 steps/s
[Step=15150 Epoch=144.1] | Loss=0.00068 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.101 | L2-Norm(final)=3.097 | 1591.2 samples/s | 24.9 steps/s
[Step=15200 Epoch=144.6] | Loss=0.00064 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.100 | L2-Norm(final)=3.097 | 3415.3 samples/s | 53.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30985 | acc=0.8252 | tpr=0.7500 | fpr=0.0114 | 3607.8 samples/s | 14.1 steps/s
Avg test loss: 0.31992, Avg test acc: 0.82414, Avg tpr: 0.75007, Avg fpr: 0.01295, total FA: 101

Testing server on iccad2012
[Step=  50] | Loss=0.40870 | acc=0.8362 | tpr=0.9602 | fpr=0.1661 | 3740.8 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.41713 | acc=0.8346 | tpr=0.9701 | fpr=0.1679 | 7350.2 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.42312 | acc=0.8331 | tpr=0.9769 | fpr=0.1696 | 7072.8 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.42815 | acc=0.8310 | tpr=0.9781 | fpr=0.1717 | 7499.4 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.42783 | acc=0.8301 | tpr=0.9790 | fpr=0.1726 | 7202.5 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.42741 | acc=0.8301 | tpr=0.9811 | fpr=0.1727 | 7317.7 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.42951 | acc=0.8295 | tpr=0.9800 | fpr=0.1732 | 7226.0 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.43163 | acc=0.8294 | tpr=0.9781 | fpr=0.1733 | 7344.4 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.43176 | acc=0.8295 | tpr=0.9771 | fpr=0.1732 | 7050.0 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.43185 | acc=0.8292 | tpr=0.9762 | fpr=0.1735 | 7301.8 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.43108 | acc=0.8293 | tpr=0.9749 | fpr=0.1733 | 13427.4 samples/s | 52.5 steps/s
Avg test loss: 0.43061, Avg test acc: 0.82938, Avg tpr: 0.97464, Avg fpr: 0.17326, total FA: 24057

server round 37/50

clients selected: [0 3 5 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=62.4] | Loss=0.11205 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.148 | L2-Norm(final)=3.103 | 3173.5 samples/s | 49.6 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03971 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.132 | L2-Norm(final)=3.097 | 3697.8 samples/s | 57.8 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02794 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.127 | L2-Norm(final)=3.096 | 3566.3 samples/s | 55.7 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02323 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.124 | L2-Norm(final)=3.096 | 3535.2 samples/s | 55.2 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02053 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.121 | L2-Norm(final)=3.097 | 4466.5 samples/s | 69.8 steps/s
[Step=13050 Epoch=63.6] | Loss=0.01767 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.120 | L2-Norm(final)=3.098 | 1499.1 samples/s | 23.4 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01569 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.119 | L2-Norm(final)=3.099 | 3709.3 samples/s | 58.0 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01410 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.118 | L2-Norm(final)=3.101 | 3760.1 samples/s | 58.8 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01331 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.117 | L2-Norm(final)=3.103 | 4456.8 samples/s | 69.6 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01231 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.117 | L2-Norm(final)=3.104 | 1565.0 samples/s | 24.5 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01148 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.117 | L2-Norm(final)=3.106 | 3724.7 samples/s | 58.2 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01088 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.116 | L2-Norm(final)=3.107 | 3673.3 samples/s | 57.4 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01031 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.116 | L2-Norm(final)=3.109 | 4099.1 samples/s | 64.0 steps/s
[Step=13450 Epoch=65.6] | Loss=0.00973 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.116 | L2-Norm(final)=3.110 | 1594.4 samples/s | 24.9 steps/s
[Step=13500 Epoch=65.8] | Loss=0.00940 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.116 | L2-Norm(final)=3.112 | 3784.3 samples/s | 59.1 steps/s
[Step=13550 Epoch=66.1] | Loss=0.00897 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.116 | L2-Norm(final)=3.114 | 3788.9 samples/s | 59.2 steps/s
[Step=13600 Epoch=66.3] | Loss=0.00869 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.116 | L2-Norm(final)=3.115 | 4037.6 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step13600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=62.4] | Loss=0.14260 | Reg=0.00329 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.148 | L2-Norm(final)=3.104 | 3452.4 samples/s | 53.9 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03050 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.131 | L2-Norm(final)=3.100 | 3399.5 samples/s | 53.1 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02303 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=3.098 | 3742.7 samples/s | 58.5 steps/s
[Step=12950 Epoch=63.2] | Loss=0.01972 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.122 | L2-Norm(final)=3.099 | 3784.8 samples/s | 59.1 steps/s
[Step=13000 Epoch=63.4] | Loss=0.01681 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.120 | L2-Norm(final)=3.100 | 4695.6 samples/s | 73.4 steps/s
[Step=13050 Epoch=63.6] | Loss=0.01468 | Reg=0.00328 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.119 | L2-Norm(final)=3.101 | 1547.2 samples/s | 24.2 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01318 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.118 | L2-Norm(final)=3.103 | 3733.5 samples/s | 58.3 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01208 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.117 | L2-Norm(final)=3.104 | 3703.3 samples/s | 57.9 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01121 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.117 | L2-Norm(final)=3.106 | 4369.3 samples/s | 68.3 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01056 | Reg=0.00328 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.116 | L2-Norm(final)=3.108 | 1565.4 samples/s | 24.5 steps/s
[Step=13300 Epoch=64.9] | Loss=0.00989 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.116 | L2-Norm(final)=3.109 | 3688.4 samples/s | 57.6 steps/s
[Step=13350 Epoch=65.1] | Loss=0.00939 | Reg=0.00328 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.116 | L2-Norm(final)=3.111 | 3700.2 samples/s | 57.8 steps/s
[Step=13400 Epoch=65.3] | Loss=0.00896 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.115 | L2-Norm(final)=3.113 | 4132.3 samples/s | 64.6 steps/s
[Step=13450 Epoch=65.6] | Loss=0.00850 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.115 | L2-Norm(final)=3.114 | 1576.8 samples/s | 24.6 steps/s
[Step=13500 Epoch=65.8] | Loss=0.00819 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.115 | L2-Norm(final)=3.116 | 3704.9 samples/s | 57.9 steps/s
[Step=13550 Epoch=66.1] | Loss=0.00792 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.115 | L2-Norm(final)=3.118 | 3683.2 samples/s | 57.6 steps/s
[Step=13600 Epoch=66.3] | Loss=0.00772 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.115 | L2-Norm(final)=3.119 | 3942.1 samples/s | 61.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step13600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=136.5] | Loss=0.25206 | Reg=0.00329 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.148 | L2-Norm(final)=3.103 | 3297.7 samples/s | 51.5 steps/s
[Step=14450 Epoch=136.9] | Loss=0.01008 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.111 | L2-Norm(final)=3.102 | 3394.9 samples/s | 53.0 steps/s
[Step=14500 Epoch=137.4] | Loss=0.00525 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.103 | L2-Norm(final)=3.103 | 4439.0 samples/s | 69.4 steps/s
[Step=14550 Epoch=137.9] | Loss=0.00353 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.099 | L2-Norm(final)=3.103 | 1474.5 samples/s | 23.0 steps/s
[Step=14600 Epoch=138.3] | Loss=0.00266 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.095 | L2-Norm(final)=3.103 | 4180.3 samples/s | 65.3 steps/s
[Step=14650 Epoch=138.8] | Loss=0.00215 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.092 | L2-Norm(final)=3.104 | 1513.0 samples/s | 23.6 steps/s
[Step=14700 Epoch=139.3] | Loss=0.00180 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.089 | L2-Norm(final)=3.104 | 3947.1 samples/s | 61.7 steps/s
[Step=14750 Epoch=139.8] | Loss=0.00155 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.087 | L2-Norm(final)=3.105 | 1546.7 samples/s | 24.2 steps/s
[Step=14800 Epoch=140.2] | Loss=0.00136 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.084 | L2-Norm(final)=3.105 | 3744.3 samples/s | 58.5 steps/s
[Step=14850 Epoch=140.7] | Loss=0.00122 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.083 | L2-Norm(final)=3.105 | 1560.7 samples/s | 24.4 steps/s
[Step=14900 Epoch=141.2] | Loss=0.00110 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.081 | L2-Norm(final)=3.105 | 3652.2 samples/s | 57.1 steps/s
[Step=14950 Epoch=141.7] | Loss=0.00100 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.079 | L2-Norm(final)=3.106 | 1603.3 samples/s | 25.1 steps/s
[Step=15000 Epoch=142.1] | Loss=0.00092 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.077 | L2-Norm(final)=3.106 | 3614.9 samples/s | 56.5 steps/s
[Step=15050 Epoch=142.6] | Loss=0.00085 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.076 | L2-Norm(final)=3.106 | 1609.1 samples/s | 25.1 steps/s
[Step=15100 Epoch=143.1] | Loss=0.00080 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.075 | L2-Norm(final)=3.106 | 3635.9 samples/s | 56.8 steps/s
[Step=15150 Epoch=143.6] | Loss=0.00075 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.073 | L2-Norm(final)=3.107 | 1619.3 samples/s | 25.3 steps/s
[Step=15200 Epoch=144.0] | Loss=0.00070 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.072 | L2-Norm(final)=3.107 | 3534.7 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step15200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=145.2] | Loss=0.08406 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.148 | L2-Norm(final)=3.103 | 3131.8 samples/s | 48.9 steps/s
[Step=15250 Epoch=145.6] | Loss=0.00620 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.109 | L2-Norm(final)=3.104 | 3538.2 samples/s | 55.3 steps/s
[Step=15300 Epoch=146.1] | Loss=0.00324 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.102 | L2-Norm(final)=3.106 | 4564.8 samples/s | 71.3 steps/s
[Step=15350 Epoch=146.6] | Loss=0.00219 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.097 | L2-Norm(final)=3.106 | 1486.1 samples/s | 23.2 steps/s
[Step=15400 Epoch=147.1] | Loss=0.00165 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.093 | L2-Norm(final)=3.107 | 4345.9 samples/s | 67.9 steps/s
[Step=15450 Epoch=147.5] | Loss=0.00133 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.090 | L2-Norm(final)=3.107 | 1505.0 samples/s | 23.5 steps/s
[Step=15500 Epoch=148.0] | Loss=0.00112 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.087 | L2-Norm(final)=3.108 | 4151.8 samples/s | 64.9 steps/s
[Step=15550 Epoch=148.5] | Loss=0.00096 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.084 | L2-Norm(final)=3.108 | 1548.6 samples/s | 24.2 steps/s
[Step=15600 Epoch=149.0] | Loss=0.00085 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.082 | L2-Norm(final)=3.108 | 3952.2 samples/s | 61.8 steps/s
[Step=15650 Epoch=149.4] | Loss=0.00076 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.080 | L2-Norm(final)=3.108 | 1563.3 samples/s | 24.4 steps/s
[Step=15700 Epoch=149.9] | Loss=0.00068 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.078 | L2-Norm(final)=3.109 | 3717.0 samples/s | 58.1 steps/s
[Step=15750 Epoch=150.4] | Loss=0.00062 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.076 | L2-Norm(final)=3.109 | 1573.9 samples/s | 24.6 steps/s
[Step=15800 Epoch=150.9] | Loss=0.00057 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.074 | L2-Norm(final)=3.109 | 3559.9 samples/s | 55.6 steps/s
[Step=15850 Epoch=151.4] | Loss=0.00053 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.072 | L2-Norm(final)=3.109 | 1603.1 samples/s | 25.0 steps/s
[Step=15900 Epoch=151.8] | Loss=0.00050 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.071 | L2-Norm(final)=3.110 | 3644.3 samples/s | 56.9 steps/s
[Step=15950 Epoch=152.3] | Loss=0.00047 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.069 | L2-Norm(final)=3.110 | 1604.3 samples/s | 25.1 steps/s
[Step=16000 Epoch=152.8] | Loss=0.00044 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.068 | L2-Norm(final)=3.110 | 3634.9 samples/s | 56.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step16000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=20001 Epoch=188.5] | Loss=0.05880 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.148 | L2-Norm(final)=3.104 | 3235.5 samples/s | 50.6 steps/s
[Step=20050 Epoch=188.9] | Loss=0.00628 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.112 | L2-Norm(final)=3.103 | 3460.5 samples/s | 54.1 steps/s
[Step=20100 Epoch=189.4] | Loss=0.00340 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.104 | L2-Norm(final)=3.104 | 4375.6 samples/s | 68.4 steps/s
[Step=20150 Epoch=189.9] | Loss=0.00229 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.099 | L2-Norm(final)=3.105 | 1486.9 samples/s | 23.2 steps/s
[Step=20200 Epoch=190.3] | Loss=0.00174 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.094 | L2-Norm(final)=3.106 | 4139.9 samples/s | 64.7 steps/s
[Step=20250 Epoch=190.8] | Loss=0.00141 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.091 | L2-Norm(final)=3.106 | 1524.7 samples/s | 23.8 steps/s
[Step=20300 Epoch=191.3] | Loss=0.00118 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.088 | L2-Norm(final)=3.107 | 3921.4 samples/s | 61.3 steps/s
[Step=20350 Epoch=191.8] | Loss=0.00102 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.085 | L2-Norm(final)=3.107 | 1566.6 samples/s | 24.5 steps/s
[Step=20400 Epoch=192.2] | Loss=0.00090 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.083 | L2-Norm(final)=3.108 | 3646.8 samples/s | 57.0 steps/s
[Step=20450 Epoch=192.7] | Loss=0.00080 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.081 | L2-Norm(final)=3.108 | 1581.6 samples/s | 24.7 steps/s
[Step=20500 Epoch=193.2] | Loss=0.00073 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.079 | L2-Norm(final)=3.108 | 3529.1 samples/s | 55.1 steps/s
[Step=20550 Epoch=193.6] | Loss=0.00066 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.077 | L2-Norm(final)=3.109 | 1606.3 samples/s | 25.1 steps/s
[Step=20600 Epoch=194.1] | Loss=0.00061 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.075 | L2-Norm(final)=3.109 | 3557.5 samples/s | 55.6 steps/s
[Step=20650 Epoch=194.6] | Loss=0.00057 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.073 | L2-Norm(final)=3.109 | 1599.0 samples/s | 25.0 steps/s
[Step=20700 Epoch=195.1] | Loss=0.00053 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.072 | L2-Norm(final)=3.109 | 3455.0 samples/s | 54.0 steps/s
[Step=20750 Epoch=195.5] | Loss=0.00050 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.070 | L2-Norm(final)=3.110 | 1660.5 samples/s | 25.9 steps/s
[Step=20800 Epoch=196.0] | Loss=0.00047 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.069 | L2-Norm(final)=3.110 | 3498.7 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32603 | acc=0.8188 | tpr=0.7403 | fpr=0.0107 | 3258.8 samples/s | 12.7 steps/s
Avg test loss: 0.33731, Avg test acc: 0.81657, Avg tpr: 0.73888, Avg fpr: 0.01256, total FA: 98

Testing server on iccad2012
[Step=  50] | Loss=0.39717 | acc=0.8406 | tpr=0.9602 | fpr=0.1615 | 2952.4 samples/s | 11.5 steps/s
[Step= 100] | Loss=0.40594 | acc=0.8394 | tpr=0.9680 | fpr=0.1630 | 7515.5 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.41193 | acc=0.8378 | tpr=0.9755 | fpr=0.1647 | 7436.9 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.41687 | acc=0.8360 | tpr=0.9770 | fpr=0.1666 | 7140.8 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.41644 | acc=0.8353 | tpr=0.9764 | fpr=0.1672 | 7467.6 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.41619 | acc=0.8354 | tpr=0.9789 | fpr=0.1672 | 7481.9 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.41837 | acc=0.8348 | tpr=0.9781 | fpr=0.1678 | 7279.7 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.42052 | acc=0.8349 | tpr=0.9765 | fpr=0.1677 | 7235.4 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.42082 | acc=0.8350 | tpr=0.9752 | fpr=0.1676 | 7263.3 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.42087 | acc=0.8347 | tpr=0.9744 | fpr=0.1679 | 7298.6 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.42005 | acc=0.8348 | tpr=0.9733 | fpr=0.1677 | 14091.4 samples/s | 55.0 steps/s
Avg test loss: 0.41960, Avg test acc: 0.83489, Avg tpr: 0.97306, Avg fpr: 0.16762, total FA: 23274

server round 38/50

clients selected: [2 6 7 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=74.1] | Loss=0.21874 | Reg=0.00328 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.120 | L2-Norm(final)=3.112 | 2827.1 samples/s | 44.2 steps/s
[Step=15250 Epoch=74.3] | Loss=0.03845 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.106 | L2-Norm(final)=3.106 | 2241.3 samples/s | 35.0 steps/s
[Step=15300 Epoch=74.5] | Loss=0.02881 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.101 | L2-Norm(final)=3.105 | 3456.9 samples/s | 54.0 steps/s
[Step=15350 Epoch=74.8] | Loss=0.02259 | Reg=0.00328 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.097 | L2-Norm(final)=3.105 | 3699.2 samples/s | 57.8 steps/s
[Step=15400 Epoch=75.0] | Loss=0.01936 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.095 | L2-Norm(final)=3.105 | 4592.5 samples/s | 71.8 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01702 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.094 | L2-Norm(final)=3.107 | 1521.0 samples/s | 23.8 steps/s
[Step=15500 Epoch=75.5] | Loss=0.01505 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.093 | L2-Norm(final)=3.108 | 3751.8 samples/s | 58.6 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01374 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.092 | L2-Norm(final)=3.110 | 3704.6 samples/s | 57.9 steps/s
[Step=15600 Epoch=76.0] | Loss=0.01264 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.092 | L2-Norm(final)=3.112 | 4336.0 samples/s | 67.7 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01167 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.091 | L2-Norm(final)=3.113 | 1552.3 samples/s | 24.3 steps/s
[Step=15700 Epoch=76.5] | Loss=0.01093 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.091 | L2-Norm(final)=3.115 | 3783.6 samples/s | 59.1 steps/s
[Step=15750 Epoch=76.7] | Loss=0.01040 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.091 | L2-Norm(final)=3.117 | 3772.6 samples/s | 58.9 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00986 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.091 | L2-Norm(final)=3.119 | 4225.8 samples/s | 66.0 steps/s
[Step=15850 Epoch=77.2] | Loss=0.00940 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.091 | L2-Norm(final)=3.120 | 1584.3 samples/s | 24.8 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00895 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.091 | L2-Norm(final)=3.122 | 3718.8 samples/s | 58.1 steps/s
[Step=15950 Epoch=77.7] | Loss=0.00860 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.091 | L2-Norm(final)=3.124 | 3704.2 samples/s | 57.9 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00833 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.091 | L2-Norm(final)=3.125 | 3893.0 samples/s | 60.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step16000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=144.6] | Loss=0.12155 | Reg=0.00328 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.120 | L2-Norm(final)=3.112 | 3152.4 samples/s | 49.3 steps/s
[Step=15250 Epoch=145.1] | Loss=0.00562 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.077 | L2-Norm(final)=3.113 | 3447.1 samples/s | 53.9 steps/s
[Step=15300 Epoch=145.5] | Loss=0.00292 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.068 | L2-Norm(final)=3.113 | 4450.4 samples/s | 69.5 steps/s
[Step=15350 Epoch=146.0] | Loss=0.00198 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.063 | L2-Norm(final)=3.114 | 1462.3 samples/s | 22.8 steps/s
[Step=15400 Epoch=146.5] | Loss=0.00150 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.059 | L2-Norm(final)=3.115 | 4188.7 samples/s | 65.4 steps/s
[Step=15450 Epoch=147.0] | Loss=0.00121 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.056 | L2-Norm(final)=3.115 | 1518.8 samples/s | 23.7 steps/s
[Step=15500 Epoch=147.4] | Loss=0.00102 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.053 | L2-Norm(final)=3.116 | 4032.7 samples/s | 63.0 steps/s
[Step=15550 Epoch=147.9] | Loss=0.00088 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.050 | L2-Norm(final)=3.116 | 1539.4 samples/s | 24.1 steps/s
[Step=15600 Epoch=148.4] | Loss=0.00077 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.048 | L2-Norm(final)=3.116 | 3848.8 samples/s | 60.1 steps/s
[Step=15650 Epoch=148.9] | Loss=0.00069 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=3.117 | 1578.8 samples/s | 24.7 steps/s
[Step=15700 Epoch=149.3] | Loss=0.00063 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=3.117 | 3611.1 samples/s | 56.4 steps/s
[Step=15750 Epoch=149.8] | Loss=0.00057 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=3.117 | 1595.1 samples/s | 24.9 steps/s
[Step=15800 Epoch=150.3] | Loss=0.00053 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.041 | L2-Norm(final)=3.118 | 3604.2 samples/s | 56.3 steps/s
[Step=15850 Epoch=150.8] | Loss=0.00049 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.040 | L2-Norm(final)=3.118 | 1616.9 samples/s | 25.3 steps/s
[Step=15900 Epoch=151.2] | Loss=0.00046 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.038 | L2-Norm(final)=3.118 | 3599.8 samples/s | 56.2 steps/s
[Step=15950 Epoch=151.7] | Loss=0.00043 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.037 | L2-Norm(final)=3.119 | 1643.5 samples/s | 25.7 steps/s
[Step=16000 Epoch=152.2] | Loss=0.00041 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.036 | L2-Norm(final)=3.119 | 3546.8 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step16000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=152.8] | Loss=0.03423 | Reg=0.00328 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.120 | L2-Norm(final)=3.112 | 3049.2 samples/s | 47.6 steps/s
[Step=16050 Epoch=153.3] | Loss=0.00693 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.080 | L2-Norm(final)=3.111 | 3568.9 samples/s | 55.8 steps/s
[Step=16100 Epoch=153.7] | Loss=0.00364 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.072 | L2-Norm(final)=3.112 | 4471.1 samples/s | 69.9 steps/s
[Step=16150 Epoch=154.2] | Loss=0.00245 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.067 | L2-Norm(final)=3.113 | 1484.4 samples/s | 23.2 steps/s
[Step=16200 Epoch=154.7] | Loss=0.00186 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.063 | L2-Norm(final)=3.114 | 4279.9 samples/s | 66.9 steps/s
[Step=16250 Epoch=155.2] | Loss=0.00149 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.060 | L2-Norm(final)=3.114 | 1510.3 samples/s | 23.6 steps/s
[Step=16300 Epoch=155.7] | Loss=0.00125 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.057 | L2-Norm(final)=3.115 | 4133.0 samples/s | 64.6 steps/s
[Step=16350 Epoch=156.1] | Loss=0.00108 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.055 | L2-Norm(final)=3.115 | 1529.1 samples/s | 23.9 steps/s
[Step=16400 Epoch=156.6] | Loss=0.00095 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.053 | L2-Norm(final)=3.115 | 3965.4 samples/s | 62.0 steps/s
[Step=16450 Epoch=157.1] | Loss=0.00085 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.051 | L2-Norm(final)=3.116 | 1559.5 samples/s | 24.4 steps/s
[Step=16500 Epoch=157.6] | Loss=0.00077 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.049 | L2-Norm(final)=3.116 | 3779.5 samples/s | 59.1 steps/s
[Step=16550 Epoch=158.0] | Loss=0.00070 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.047 | L2-Norm(final)=3.116 | 1583.7 samples/s | 24.7 steps/s
[Step=16600 Epoch=158.5] | Loss=0.00065 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=3.117 | 3598.0 samples/s | 56.2 steps/s
[Step=16650 Epoch=159.0] | Loss=0.00060 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=3.117 | 1592.0 samples/s | 24.9 steps/s
[Step=16700 Epoch=159.5] | Loss=0.00056 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=3.117 | 3581.0 samples/s | 56.0 steps/s
[Step=16750 Epoch=160.0] | Loss=0.00052 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.041 | L2-Norm(final)=3.117 | 1601.9 samples/s | 25.0 steps/s
[Step=16800 Epoch=160.4] | Loss=0.00049 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.040 | L2-Norm(final)=3.118 | 3598.8 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step16800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=20801 Epoch=196.0] | Loss=0.16391 | Reg=0.00328 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.120 | L2-Norm(final)=3.112 | 3543.9 samples/s | 55.4 steps/s
[Step=20850 Epoch=196.5] | Loss=0.00634 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.082 | L2-Norm(final)=3.113 | 3122.5 samples/s | 48.8 steps/s
[Step=20900 Epoch=196.9] | Loss=0.00339 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.074 | L2-Norm(final)=3.113 | 4385.5 samples/s | 68.5 steps/s
[Step=20950 Epoch=197.4] | Loss=0.00231 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.069 | L2-Norm(final)=3.114 | 1486.1 samples/s | 23.2 steps/s
[Step=21000 Epoch=197.9] | Loss=0.00175 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.065 | L2-Norm(final)=3.115 | 4205.3 samples/s | 65.7 steps/s
[Step=21050 Epoch=198.4] | Loss=0.00141 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.061 | L2-Norm(final)=3.115 | 1523.6 samples/s | 23.8 steps/s
[Step=21100 Epoch=198.8] | Loss=0.00119 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.058 | L2-Norm(final)=3.116 | 3871.6 samples/s | 60.5 steps/s
[Step=21150 Epoch=199.3] | Loss=0.00103 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.056 | L2-Norm(final)=3.116 | 1522.1 samples/s | 23.8 steps/s
[Step=21200 Epoch=199.8] | Loss=0.00090 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.054 | L2-Norm(final)=3.117 | 3656.6 samples/s | 57.1 steps/s
[Step=21250 Epoch=200.2] | Loss=0.00081 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.051 | L2-Norm(final)=3.117 | 1566.5 samples/s | 24.5 steps/s
[Step=21300 Epoch=200.7] | Loss=0.00073 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.049 | L2-Norm(final)=3.117 | 3533.6 samples/s | 55.2 steps/s
[Step=21350 Epoch=201.2] | Loss=0.00067 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.048 | L2-Norm(final)=3.117 | 1610.7 samples/s | 25.2 steps/s
[Step=21400 Epoch=201.6] | Loss=0.00061 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=3.118 | 3550.6 samples/s | 55.5 steps/s
[Step=21450 Epoch=202.1] | Loss=0.00057 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=3.118 | 1608.2 samples/s | 25.1 steps/s
[Step=21500 Epoch=202.6] | Loss=0.00053 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=3.118 | 3601.9 samples/s | 56.3 steps/s
[Step=21550 Epoch=203.1] | Loss=0.00050 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.041 | L2-Norm(final)=3.118 | 1681.2 samples/s | 26.3 steps/s
[Step=21600 Epoch=203.5] | Loss=0.00047 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.040 | L2-Norm(final)=3.119 | 3431.9 samples/s | 53.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step21600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=18401 Epoch=175.4] | Loss=0.10181 | Reg=0.00328 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.120 | L2-Norm(final)=3.112 | 3192.7 samples/s | 49.9 steps/s
[Step=18450 Epoch=175.8] | Loss=0.00637 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.082 | L2-Norm(final)=3.113 | 3471.3 samples/s | 54.2 steps/s
[Step=18500 Epoch=176.3] | Loss=0.00332 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.075 | L2-Norm(final)=3.114 | 4546.7 samples/s | 71.0 steps/s
[Step=18550 Epoch=176.8] | Loss=0.00225 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.070 | L2-Norm(final)=3.115 | 1471.1 samples/s | 23.0 steps/s
[Step=18600 Epoch=177.3] | Loss=0.00171 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.066 | L2-Norm(final)=3.115 | 4301.1 samples/s | 67.2 steps/s
[Step=18650 Epoch=177.8] | Loss=0.00138 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.062 | L2-Norm(final)=3.116 | 1505.7 samples/s | 23.5 steps/s
[Step=18700 Epoch=178.2] | Loss=0.00115 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.059 | L2-Norm(final)=3.116 | 4020.1 samples/s | 62.8 steps/s
[Step=18750 Epoch=178.7] | Loss=0.00100 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.056 | L2-Norm(final)=3.117 | 1539.9 samples/s | 24.1 steps/s
[Step=18800 Epoch=179.2] | Loss=0.00088 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.054 | L2-Norm(final)=3.117 | 3943.9 samples/s | 61.6 steps/s
[Step=18850 Epoch=179.7] | Loss=0.00079 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.052 | L2-Norm(final)=3.117 | 1554.9 samples/s | 24.3 steps/s
[Step=18900 Epoch=180.1] | Loss=0.00071 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.050 | L2-Norm(final)=3.118 | 3761.7 samples/s | 58.8 steps/s
[Step=18950 Epoch=180.6] | Loss=0.00065 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.048 | L2-Norm(final)=3.118 | 1569.3 samples/s | 24.5 steps/s
[Step=19000 Epoch=181.1] | Loss=0.00060 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=3.118 | 3578.6 samples/s | 55.9 steps/s
[Step=19050 Epoch=181.6] | Loss=0.00056 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=3.118 | 1591.2 samples/s | 24.9 steps/s
[Step=19100 Epoch=182.0] | Loss=0.00052 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=3.119 | 3552.1 samples/s | 55.5 steps/s
[Step=19150 Epoch=182.5] | Loss=0.00049 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.041 | L2-Norm(final)=3.119 | 1591.2 samples/s | 24.9 steps/s
[Step=19200 Epoch=183.0] | Loss=0.00046 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.040 | L2-Norm(final)=3.119 | 3627.0 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31107 | acc=0.8259 | tpr=0.7506 | fpr=0.0104 | 3722.0 samples/s | 14.5 steps/s
Avg test loss: 0.32174, Avg test acc: 0.82479, Avg tpr: 0.75066, Avg fpr: 0.01218, total FA: 95

Testing server on iccad2012
[Step=  50] | Loss=0.41617 | acc=0.8302 | tpr=0.9602 | fpr=0.1721 | 3748.8 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.42468 | acc=0.8293 | tpr=0.9680 | fpr=0.1733 | 7690.5 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.43066 | acc=0.8282 | tpr=0.9755 | fpr=0.1745 | 6975.2 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.43573 | acc=0.8264 | tpr=0.9770 | fpr=0.1763 | 7263.0 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.43542 | acc=0.8253 | tpr=0.9764 | fpr=0.1775 | 7550.5 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.43496 | acc=0.8252 | tpr=0.9789 | fpr=0.1776 | 7230.4 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.43704 | acc=0.8246 | tpr=0.9781 | fpr=0.1782 | 7576.3 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.43920 | acc=0.8245 | tpr=0.9759 | fpr=0.1783 | 7547.9 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.43943 | acc=0.8246 | tpr=0.9747 | fpr=0.1781 | 7239.1 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.43955 | acc=0.8244 | tpr=0.9736 | fpr=0.1783 | 7207.1 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.43881 | acc=0.8246 | tpr=0.9725 | fpr=0.1781 | 13211.0 samples/s | 51.6 steps/s
Avg test loss: 0.43835, Avg test acc: 0.82466, Avg tpr: 0.97227, Avg fpr: 0.17802, total FA: 24718

server round 39/50

clients selected: [4 5 7 8 9]

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=70.6] | Loss=0.19400 | Reg=0.00327 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.089 | L2-Norm(final)=3.122 | 3292.6 samples/s | 51.4 steps/s
[Step=14450 Epoch=70.9] | Loss=0.03498 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.071 | L2-Norm(final)=3.118 | 3623.5 samples/s | 56.6 steps/s
[Step=14500 Epoch=71.1] | Loss=0.02547 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.064 | L2-Norm(final)=3.117 | 3764.7 samples/s | 58.8 steps/s
[Step=14550 Epoch=71.4] | Loss=0.02056 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.061 | L2-Norm(final)=3.118 | 3764.8 samples/s | 58.8 steps/s
[Step=14600 Epoch=71.6] | Loss=0.01827 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.060 | L2-Norm(final)=3.119 | 4748.1 samples/s | 74.2 steps/s
[Step=14650 Epoch=71.8] | Loss=0.01578 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.059 | L2-Norm(final)=3.120 | 1511.5 samples/s | 23.6 steps/s
[Step=14700 Epoch=72.1] | Loss=0.01420 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.058 | L2-Norm(final)=3.121 | 3675.7 samples/s | 57.4 steps/s
[Step=14750 Epoch=72.3] | Loss=0.01278 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.058 | L2-Norm(final)=3.123 | 3653.9 samples/s | 57.1 steps/s
[Step=14800 Epoch=72.6] | Loss=0.01179 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.057 | L2-Norm(final)=3.125 | 4434.6 samples/s | 69.3 steps/s
[Step=14850 Epoch=72.8] | Loss=0.01084 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.057 | L2-Norm(final)=3.127 | 1541.4 samples/s | 24.1 steps/s
[Step=14900 Epoch=73.1] | Loss=0.01018 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.057 | L2-Norm(final)=3.128 | 3707.0 samples/s | 57.9 steps/s
[Step=14950 Epoch=73.3] | Loss=0.00971 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.057 | L2-Norm(final)=3.130 | 3702.0 samples/s | 57.8 steps/s
[Step=15000 Epoch=73.6] | Loss=0.00928 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.057 | L2-Norm(final)=3.132 | 4263.9 samples/s | 66.6 steps/s
[Step=15050 Epoch=73.8] | Loss=0.00881 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.057 | L2-Norm(final)=3.133 | 1569.6 samples/s | 24.5 steps/s
[Step=15100 Epoch=74.0] | Loss=0.00843 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.057 | L2-Norm(final)=3.135 | 3771.2 samples/s | 58.9 steps/s
[Step=15150 Epoch=74.3] | Loss=0.00816 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.057 | L2-Norm(final)=3.136 | 3771.8 samples/s | 58.9 steps/s
[Step=15200 Epoch=74.5] | Loss=0.00786 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.057 | L2-Norm(final)=3.138 | 4249.6 samples/s | 66.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step15200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=144.0] | Loss=0.17842 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.089 | L2-Norm(final)=3.122 | 3138.9 samples/s | 49.0 steps/s
[Step=15250 Epoch=144.5] | Loss=0.00887 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.057 | L2-Norm(final)=3.121 | 3524.1 samples/s | 55.1 steps/s
[Step=15300 Epoch=145.0] | Loss=0.00465 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.049 | L2-Norm(final)=3.122 | 4540.2 samples/s | 70.9 steps/s
[Step=15350 Epoch=145.5] | Loss=0.00315 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=3.123 | 1463.3 samples/s | 22.9 steps/s
[Step=15400 Epoch=145.9] | Loss=0.00238 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.040 | L2-Norm(final)=3.123 | 4263.6 samples/s | 66.6 steps/s
[Step=15450 Epoch=146.4] | Loss=0.00192 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.037 | L2-Norm(final)=3.124 | 1516.0 samples/s | 23.7 steps/s
[Step=15500 Epoch=146.9] | Loss=0.00161 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.034 | L2-Norm(final)=3.124 | 3946.7 samples/s | 61.7 steps/s
[Step=15550 Epoch=147.3] | Loss=0.00138 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.032 | L2-Norm(final)=3.124 | 1542.5 samples/s | 24.1 steps/s
[Step=15600 Epoch=147.8] | Loss=0.00122 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.029 | L2-Norm(final)=3.124 | 3745.3 samples/s | 58.5 steps/s
[Step=15650 Epoch=148.3] | Loss=0.00109 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.027 | L2-Norm(final)=3.125 | 1583.9 samples/s | 24.7 steps/s
[Step=15700 Epoch=148.8] | Loss=0.00098 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.025 | L2-Norm(final)=3.125 | 3656.9 samples/s | 57.1 steps/s
[Step=15750 Epoch=149.2] | Loss=0.00090 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.023 | L2-Norm(final)=3.125 | 1588.9 samples/s | 24.8 steps/s
[Step=15800 Epoch=149.7] | Loss=0.00083 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.022 | L2-Norm(final)=3.125 | 3510.9 samples/s | 54.9 steps/s
[Step=15850 Epoch=150.2] | Loss=0.00076 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.020 | L2-Norm(final)=3.126 | 1610.8 samples/s | 25.2 steps/s
[Step=15900 Epoch=150.7] | Loss=0.00071 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.019 | L2-Norm(final)=3.126 | 3495.8 samples/s | 54.6 steps/s
[Step=15950 Epoch=151.1] | Loss=0.00067 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.017 | L2-Norm(final)=3.126 | 1598.7 samples/s | 25.0 steps/s
[Step=16000 Epoch=151.6] | Loss=0.00063 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.016 | L2-Norm(final)=3.126 | 3602.4 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step16000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16801 Epoch=160.4] | Loss=0.06368 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.089 | L2-Norm(final)=3.122 | 3156.1 samples/s | 49.3 steps/s
[Step=16850 Epoch=160.9] | Loss=0.00506 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.048 | L2-Norm(final)=3.124 | 3499.1 samples/s | 54.7 steps/s
[Step=16900 Epoch=161.4] | Loss=0.00274 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.040 | L2-Norm(final)=3.124 | 4583.1 samples/s | 71.6 steps/s
[Step=16950 Epoch=161.9] | Loss=0.00184 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.035 | L2-Norm(final)=3.125 | 1467.7 samples/s | 22.9 steps/s
[Step=17000 Epoch=162.3] | Loss=0.00139 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.031 | L2-Norm(final)=3.126 | 4176.4 samples/s | 65.3 steps/s
[Step=17050 Epoch=162.8] | Loss=0.00112 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.027 | L2-Norm(final)=3.126 | 1498.9 samples/s | 23.4 steps/s
[Step=17100 Epoch=163.3] | Loss=0.00094 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.024 | L2-Norm(final)=3.126 | 4007.8 samples/s | 62.6 steps/s
[Step=17150 Epoch=163.8] | Loss=0.00081 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.022 | L2-Norm(final)=3.127 | 1536.6 samples/s | 24.0 steps/s
[Step=17200 Epoch=164.2] | Loss=0.00071 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.020 | L2-Norm(final)=3.127 | 3946.0 samples/s | 61.7 steps/s
[Step=17250 Epoch=164.7] | Loss=0.00064 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=3.127 | 1557.3 samples/s | 24.3 steps/s
[Step=17300 Epoch=165.2] | Loss=0.00058 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.016 | L2-Norm(final)=3.127 | 3720.5 samples/s | 58.1 steps/s
[Step=17350 Epoch=165.7] | Loss=0.00053 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.014 | L2-Norm(final)=3.128 | 1572.4 samples/s | 24.6 steps/s
[Step=17400 Epoch=166.2] | Loss=0.00049 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=3.128 | 3597.4 samples/s | 56.2 steps/s
[Step=17450 Epoch=166.6] | Loss=0.00045 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.011 | L2-Norm(final)=3.128 | 1597.4 samples/s | 25.0 steps/s
[Step=17500 Epoch=167.1] | Loss=0.00042 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.009 | L2-Norm(final)=3.128 | 3569.2 samples/s | 55.8 steps/s
[Step=17550 Epoch=167.6] | Loss=0.00039 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.008 | L2-Norm(final)=3.129 | 1609.3 samples/s | 25.1 steps/s
[Step=17600 Epoch=168.1] | Loss=0.00037 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.007 | L2-Norm(final)=3.129 | 3640.3 samples/s | 56.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step17600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=21601 Epoch=203.5] | Loss=0.25834 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.089 | L2-Norm(final)=3.122 | 3201.9 samples/s | 50.0 steps/s
[Step=21650 Epoch=204.0] | Loss=0.00894 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.050 | L2-Norm(final)=3.122 | 3438.5 samples/s | 53.7 steps/s
[Step=21700 Epoch=204.5] | Loss=0.00475 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=3.123 | 4517.9 samples/s | 70.6 steps/s
[Step=21750 Epoch=204.9] | Loss=0.00322 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.038 | L2-Norm(final)=3.123 | 1492.1 samples/s | 23.3 steps/s
[Step=21800 Epoch=205.4] | Loss=0.00243 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.034 | L2-Norm(final)=3.124 | 4226.7 samples/s | 66.0 steps/s
[Step=21850 Epoch=205.9] | Loss=0.00195 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.031 | L2-Norm(final)=3.125 | 1534.1 samples/s | 24.0 steps/s
[Step=21900 Epoch=206.4] | Loss=0.00164 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.028 | L2-Norm(final)=3.125 | 3933.6 samples/s | 61.5 steps/s
[Step=21950 Epoch=206.8] | Loss=0.00141 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.026 | L2-Norm(final)=3.125 | 1547.7 samples/s | 24.2 steps/s
[Step=22000 Epoch=207.3] | Loss=0.00124 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.023 | L2-Norm(final)=3.125 | 3628.1 samples/s | 56.7 steps/s
[Step=22050 Epoch=207.8] | Loss=0.00110 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.021 | L2-Norm(final)=3.126 | 1570.7 samples/s | 24.5 steps/s
[Step=22100 Epoch=208.2] | Loss=0.00100 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.019 | L2-Norm(final)=3.126 | 3606.2 samples/s | 56.3 steps/s
[Step=22150 Epoch=208.7] | Loss=0.00091 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=3.126 | 1634.5 samples/s | 25.5 steps/s
[Step=22200 Epoch=209.2] | Loss=0.00084 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.016 | L2-Norm(final)=3.126 | 3526.7 samples/s | 55.1 steps/s
[Step=22250 Epoch=209.7] | Loss=0.00077 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.014 | L2-Norm(final)=3.126 | 1619.3 samples/s | 25.3 steps/s
[Step=22300 Epoch=210.1] | Loss=0.00072 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.013 | L2-Norm(final)=3.127 | 3579.9 samples/s | 55.9 steps/s
[Step=22350 Epoch=210.6] | Loss=0.00068 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=3.127 | 1682.9 samples/s | 26.3 steps/s
[Step=22400 Epoch=211.1] | Loss=0.00063 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.010 | L2-Norm(final)=3.127 | 3226.8 samples/s | 50.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step22400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=19201 Epoch=183.0] | Loss=0.04511 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.089 | L2-Norm(final)=3.122 | 3106.5 samples/s | 48.5 steps/s
[Step=19250 Epoch=183.5] | Loss=0.00720 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.051 | L2-Norm(final)=3.124 | 3512.3 samples/s | 54.9 steps/s
[Step=19300 Epoch=183.9] | Loss=0.00370 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=3.124 | 4543.1 samples/s | 71.0 steps/s
[Step=19350 Epoch=184.4] | Loss=0.00249 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.039 | L2-Norm(final)=3.125 | 1478.5 samples/s | 23.1 steps/s
[Step=19400 Epoch=184.9] | Loss=0.00188 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.035 | L2-Norm(final)=3.125 | 4304.4 samples/s | 67.3 steps/s
[Step=19450 Epoch=185.4] | Loss=0.00151 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.031 | L2-Norm(final)=3.126 | 1471.8 samples/s | 23.0 steps/s
[Step=19500 Epoch=185.9] | Loss=0.00127 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.028 | L2-Norm(final)=3.126 | 4064.7 samples/s | 63.5 steps/s
[Step=19550 Epoch=186.3] | Loss=0.00109 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.026 | L2-Norm(final)=3.126 | 1509.9 samples/s | 23.6 steps/s
[Step=19600 Epoch=186.8] | Loss=0.00096 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.023 | L2-Norm(final)=3.126 | 3956.7 samples/s | 61.8 steps/s
[Step=19650 Epoch=187.3] | Loss=0.00086 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.021 | L2-Norm(final)=3.127 | 1566.4 samples/s | 24.5 steps/s
[Step=19700 Epoch=187.8] | Loss=0.00077 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.019 | L2-Norm(final)=3.127 | 3792.1 samples/s | 59.3 steps/s
[Step=19750 Epoch=188.2] | Loss=0.00071 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.017 | L2-Norm(final)=3.127 | 1560.1 samples/s | 24.4 steps/s
[Step=19800 Epoch=188.7] | Loss=0.00065 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.015 | L2-Norm(final)=3.127 | 3673.4 samples/s | 57.4 steps/s
[Step=19850 Epoch=189.2] | Loss=0.00060 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.014 | L2-Norm(final)=3.128 | 1617.5 samples/s | 25.3 steps/s
[Step=19900 Epoch=189.7] | Loss=0.00056 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=3.128 | 3610.7 samples/s | 56.4 steps/s
[Step=19950 Epoch=190.1] | Loss=0.00053 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.011 | L2-Norm(final)=3.128 | 1613.0 samples/s | 25.2 steps/s
[Step=20000 Epoch=190.6] | Loss=0.00049 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.009 | L2-Norm(final)=3.128 | 3602.4 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30948 | acc=0.8280 | tpr=0.7538 | fpr=0.0109 | 3724.8 samples/s | 14.6 steps/s
Avg test loss: 0.31962, Avg test acc: 0.82631, Avg tpr: 0.75316, Avg fpr: 0.01282, total FA: 100

Testing server on iccad2012
[Step=  50] | Loss=0.41430 | acc=0.8333 | tpr=0.9602 | fpr=0.1690 | 3738.6 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.42333 | acc=0.8323 | tpr=0.9701 | fpr=0.1703 | 7386.3 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.42949 | acc=0.8312 | tpr=0.9769 | fpr=0.1715 | 7319.4 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.43478 | acc=0.8295 | tpr=0.9781 | fpr=0.1732 | 7624.7 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.43424 | acc=0.8286 | tpr=0.9782 | fpr=0.1741 | 7198.4 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.43389 | acc=0.8287 | tpr=0.9804 | fpr=0.1741 | 7495.1 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.43615 | acc=0.8282 | tpr=0.9793 | fpr=0.1746 | 7327.4 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.43837 | acc=0.8281 | tpr=0.9770 | fpr=0.1746 | 7570.2 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.43864 | acc=0.8283 | tpr=0.9757 | fpr=0.1743 | 7238.3 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.43883 | acc=0.8280 | tpr=0.9744 | fpr=0.1747 | 7322.5 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.43811 | acc=0.8282 | tpr=0.9733 | fpr=0.1744 | 13056.5 samples/s | 51.0 steps/s
Avg test loss: 0.43763, Avg test acc: 0.82833, Avg tpr: 0.97306, Avg fpr: 0.17430, total FA: 24201

server round 40/50

clients selected: [0 4 5 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=13601 Epoch=66.3] | Loss=0.20825 | Reg=0.00326 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.043 | L2-Norm(final)=3.137 | 3250.4 samples/s | 50.8 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03866 | Reg=0.00325 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.031 | L2-Norm(final)=3.135 | 3623.3 samples/s | 56.6 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02651 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.025 | L2-Norm(final)=3.134 | 3736.1 samples/s | 58.4 steps/s
[Step=13750 Epoch=67.0] | Loss=0.02170 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.021 | L2-Norm(final)=3.134 | 3770.4 samples/s | 58.9 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01929 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.019 | L2-Norm(final)=3.134 | 4659.5 samples/s | 72.8 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01656 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.017 | L2-Norm(final)=3.135 | 1549.1 samples/s | 24.2 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01488 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.016 | L2-Norm(final)=3.136 | 3663.6 samples/s | 57.2 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01354 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.015 | L2-Norm(final)=3.136 | 3657.7 samples/s | 57.2 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01277 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.014 | L2-Norm(final)=3.137 | 4290.6 samples/s | 67.0 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01228 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.013 | L2-Norm(final)=3.138 | 1546.4 samples/s | 24.2 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01144 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.013 | L2-Norm(final)=3.139 | 3621.5 samples/s | 56.6 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01079 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=3.140 | 3660.2 samples/s | 57.2 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01037 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.012 | L2-Norm(final)=3.141 | 4103.4 samples/s | 64.1 steps/s
[Step=14250 Epoch=69.5] | Loss=0.00985 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=3.142 | 1563.0 samples/s | 24.4 steps/s
[Step=14300 Epoch=69.7] | Loss=0.00950 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.012 | L2-Norm(final)=3.143 | 3710.0 samples/s | 58.0 steps/s
[Step=14350 Epoch=70.0] | Loss=0.00912 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=3.144 | 3656.5 samples/s | 57.1 steps/s
[Step=14400 Epoch=70.2] | Loss=0.00885 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.011 | L2-Norm(final)=3.145 | 3899.7 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step14400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=74.5] | Loss=0.16688 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.043 | L2-Norm(final)=3.137 | 3329.8 samples/s | 52.0 steps/s
[Step=15250 Epoch=74.8] | Loss=0.03441 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.030 | L2-Norm(final)=3.135 | 3534.8 samples/s | 55.2 steps/s
[Step=15300 Epoch=75.0] | Loss=0.02404 | Reg=0.00325 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.024 | L2-Norm(final)=3.135 | 3699.1 samples/s | 57.8 steps/s
[Step=15350 Epoch=75.3] | Loss=0.01993 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.020 | L2-Norm(final)=3.135 | 3677.7 samples/s | 57.5 steps/s
[Step=15400 Epoch=75.5] | Loss=0.01807 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=3.136 | 4600.7 samples/s | 71.9 steps/s
[Step=15450 Epoch=75.8] | Loss=0.01573 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.016 | L2-Norm(final)=3.136 | 1526.7 samples/s | 23.9 steps/s
[Step=15500 Epoch=76.0] | Loss=0.01385 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.015 | L2-Norm(final)=3.137 | 3678.2 samples/s | 57.5 steps/s
[Step=15550 Epoch=76.3] | Loss=0.01270 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.014 | L2-Norm(final)=3.138 | 3690.8 samples/s | 57.7 steps/s
[Step=15600 Epoch=76.5] | Loss=0.01174 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.014 | L2-Norm(final)=3.139 | 4447.0 samples/s | 69.5 steps/s
[Step=15650 Epoch=76.7] | Loss=0.01093 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.013 | L2-Norm(final)=3.141 | 1564.6 samples/s | 24.4 steps/s
[Step=15700 Epoch=77.0] | Loss=0.01026 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.013 | L2-Norm(final)=3.142 | 3775.2 samples/s | 59.0 steps/s
[Step=15750 Epoch=77.2] | Loss=0.00975 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.013 | L2-Norm(final)=3.143 | 3769.9 samples/s | 58.9 steps/s
[Step=15800 Epoch=77.5] | Loss=0.00930 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=3.144 | 4430.2 samples/s | 69.2 steps/s
[Step=15850 Epoch=77.7] | Loss=0.00888 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=3.145 | 1553.7 samples/s | 24.3 steps/s
[Step=15900 Epoch=78.0] | Loss=0.00849 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=3.146 | 3675.4 samples/s | 57.4 steps/s
[Step=15950 Epoch=78.2] | Loss=0.00816 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=3.147 | 3687.9 samples/s | 57.6 steps/s
[Step=16000 Epoch=78.5] | Loss=0.00790 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=3.148 | 4170.9 samples/s | 65.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=151.6] | Loss=0.11759 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.043 | L2-Norm(final)=3.137 | 3125.4 samples/s | 48.8 steps/s
[Step=16050 Epoch=152.1] | Loss=0.01082 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.011 | L2-Norm(final)=3.137 | 3530.9 samples/s | 55.2 steps/s
[Step=16100 Epoch=152.6] | Loss=0.00565 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.003 | L2-Norm(final)=3.138 | 4521.6 samples/s | 70.6 steps/s
[Step=16150 Epoch=153.0] | Loss=0.00382 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.998 | L2-Norm(final)=3.138 | 1483.8 samples/s | 23.2 steps/s
[Step=16200 Epoch=153.5] | Loss=0.00291 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.995 | L2-Norm(final)=3.139 | 4161.2 samples/s | 65.0 steps/s
[Step=16250 Epoch=154.0] | Loss=0.00236 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.992 | L2-Norm(final)=3.139 | 1505.5 samples/s | 23.5 steps/s
[Step=16300 Epoch=154.5] | Loss=0.00198 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.990 | L2-Norm(final)=3.139 | 4013.6 samples/s | 62.7 steps/s
[Step=16350 Epoch=154.9] | Loss=0.00172 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.988 | L2-Norm(final)=3.140 | 1549.9 samples/s | 24.2 steps/s
[Step=16400 Epoch=155.4] | Loss=0.00151 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.986 | L2-Norm(final)=3.140 | 3840.5 samples/s | 60.0 steps/s
[Step=16450 Epoch=155.9] | Loss=0.00136 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.984 | L2-Norm(final)=3.140 | 1586.0 samples/s | 24.8 steps/s
[Step=16500 Epoch=156.4] | Loss=0.00123 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.983 | L2-Norm(final)=3.140 | 3662.9 samples/s | 57.2 steps/s
[Step=16550 Epoch=156.8] | Loss=0.00112 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.982 | L2-Norm(final)=3.141 | 1602.7 samples/s | 25.0 steps/s
[Step=16600 Epoch=157.3] | Loss=0.00104 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.980 | L2-Norm(final)=3.141 | 3573.4 samples/s | 55.8 steps/s
[Step=16650 Epoch=157.8] | Loss=0.00096 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.979 | L2-Norm(final)=3.141 | 1596.8 samples/s | 24.9 steps/s
[Step=16700 Epoch=158.2] | Loss=0.00090 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.978 | L2-Norm(final)=3.141 | 3598.6 samples/s | 56.2 steps/s
[Step=16750 Epoch=158.7] | Loss=0.00084 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.977 | L2-Norm(final)=3.141 | 1618.6 samples/s | 25.3 steps/s
[Step=16800 Epoch=159.2] | Loss=0.00079 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.976 | L2-Norm(final)=3.142 | 3647.8 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step16800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=168.1] | Loss=0.07379 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.043 | L2-Norm(final)=3.137 | 3022.1 samples/s | 47.2 steps/s
[Step=17650 Epoch=168.5] | Loss=0.00874 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.007 | L2-Norm(final)=3.137 | 3570.0 samples/s | 55.8 steps/s
[Step=17700 Epoch=169.0] | Loss=0.00451 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.999 | L2-Norm(final)=3.138 | 4416.3 samples/s | 69.0 steps/s
[Step=17750 Epoch=169.5] | Loss=0.00304 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.994 | L2-Norm(final)=3.138 | 1465.7 samples/s | 22.9 steps/s
[Step=17800 Epoch=170.0] | Loss=0.00231 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.990 | L2-Norm(final)=3.139 | 4246.4 samples/s | 66.3 steps/s
[Step=17850 Epoch=170.5] | Loss=0.00186 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.988 | L2-Norm(final)=3.139 | 1488.5 samples/s | 23.3 steps/s
[Step=17900 Epoch=170.9] | Loss=0.00156 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.985 | L2-Norm(final)=3.139 | 4134.9 samples/s | 64.6 steps/s
[Step=17950 Epoch=171.4] | Loss=0.00135 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.983 | L2-Norm(final)=3.139 | 1530.0 samples/s | 23.9 steps/s
[Step=18000 Epoch=171.9] | Loss=0.00119 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.981 | L2-Norm(final)=3.140 | 3964.5 samples/s | 61.9 steps/s
[Step=18050 Epoch=172.4] | Loss=0.00106 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.980 | L2-Norm(final)=3.140 | 1554.1 samples/s | 24.3 steps/s
[Step=18100 Epoch=172.8] | Loss=0.00096 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.978 | L2-Norm(final)=3.140 | 3738.7 samples/s | 58.4 steps/s
[Step=18150 Epoch=173.3] | Loss=0.00088 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.977 | L2-Norm(final)=3.140 | 1499.1 samples/s | 23.4 steps/s
[Step=18200 Epoch=173.8] | Loss=0.00081 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.975 | L2-Norm(final)=3.140 | 3099.1 samples/s | 48.4 steps/s
[Step=18250 Epoch=174.3] | Loss=0.00075 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.974 | L2-Norm(final)=3.141 | 1453.4 samples/s | 22.7 steps/s
[Step=18300 Epoch=174.8] | Loss=0.00070 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.973 | L2-Norm(final)=3.141 | 3035.3 samples/s | 47.4 steps/s
[Step=18350 Epoch=175.2] | Loss=0.00066 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.972 | L2-Norm(final)=3.141 | 1430.9 samples/s | 22.4 steps/s
[Step=18400 Epoch=175.7] | Loss=0.00062 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.971 | L2-Norm(final)=3.141 | 3120.1 samples/s | 48.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step18400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=22401 Epoch=211.1] | Loss=0.08921 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.043 | L2-Norm(final)=3.137 | 2901.9 samples/s | 45.3 steps/s
[Step=22450 Epoch=211.5] | Loss=0.00822 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.011 | L2-Norm(final)=3.139 | 3443.8 samples/s | 53.8 steps/s
[Step=22500 Epoch=212.0] | Loss=0.00429 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.004 | L2-Norm(final)=3.139 | 4410.3 samples/s | 68.9 steps/s
[Step=22550 Epoch=212.5] | Loss=0.00294 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.999 | L2-Norm(final)=3.139 | 1485.2 samples/s | 23.2 steps/s
[Step=22600 Epoch=213.0] | Loss=0.00223 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.996 | L2-Norm(final)=3.140 | 4110.6 samples/s | 64.2 steps/s
[Step=22650 Epoch=213.4] | Loss=0.00180 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.993 | L2-Norm(final)=3.140 | 1521.3 samples/s | 23.8 steps/s
[Step=22700 Epoch=213.9] | Loss=0.00151 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.991 | L2-Norm(final)=3.140 | 3864.8 samples/s | 60.4 steps/s
[Step=22750 Epoch=214.4] | Loss=0.00131 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.989 | L2-Norm(final)=3.140 | 1552.5 samples/s | 24.3 steps/s
[Step=22800 Epoch=214.8] | Loss=0.00115 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=3.140 | 3699.4 samples/s | 57.8 steps/s
[Step=22850 Epoch=215.3] | Loss=0.00103 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.985 | L2-Norm(final)=3.141 | 1572.4 samples/s | 24.6 steps/s
[Step=22900 Epoch=215.8] | Loss=0.00094 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.984 | L2-Norm(final)=3.141 | 3616.5 samples/s | 56.5 steps/s
[Step=22950 Epoch=216.3] | Loss=0.00086 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.982 | L2-Norm(final)=3.141 | 1625.9 samples/s | 25.4 steps/s
[Step=23000 Epoch=216.7] | Loss=0.00079 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.981 | L2-Norm(final)=3.141 | 3543.3 samples/s | 55.4 steps/s
[Step=23050 Epoch=217.2] | Loss=0.00073 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.979 | L2-Norm(final)=3.141 | 1616.9 samples/s | 25.3 steps/s
[Step=23100 Epoch=217.7] | Loss=0.00068 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.978 | L2-Norm(final)=3.141 | 3621.9 samples/s | 56.6 steps/s
[Step=23150 Epoch=218.1] | Loss=0.00064 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.977 | L2-Norm(final)=3.142 | 1656.0 samples/s | 25.9 steps/s
[Step=23200 Epoch=218.6] | Loss=0.00061 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.976 | L2-Norm(final)=3.142 | 3440.4 samples/s | 53.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30337 | acc=0.8309 | tpr=0.7581 | fpr=0.0111 | 3748.9 samples/s | 14.6 steps/s
Avg test loss: 0.31309, Avg test acc: 0.82907, Avg tpr: 0.75713, Avg fpr: 0.01269, total FA: 99

Testing server on iccad2012
[Step=  50] | Loss=0.41596 | acc=0.8318 | tpr=0.9602 | fpr=0.1705 | 3742.6 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.42479 | acc=0.8304 | tpr=0.9659 | fpr=0.1722 | 7295.5 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.43064 | acc=0.8294 | tpr=0.9741 | fpr=0.1733 | 7423.0 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.43580 | acc=0.8277 | tpr=0.9760 | fpr=0.1750 | 7443.0 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.43554 | acc=0.8271 | tpr=0.9755 | fpr=0.1756 | 7365.6 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.43496 | acc=0.8271 | tpr=0.9782 | fpr=0.1756 | 7486.5 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.43715 | acc=0.8265 | tpr=0.9775 | fpr=0.1763 | 7436.4 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.43928 | acc=0.8263 | tpr=0.9748 | fpr=0.1764 | 7308.2 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.43955 | acc=0.8265 | tpr=0.9737 | fpr=0.1762 | 7364.9 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.43973 | acc=0.8262 | tpr=0.9727 | fpr=0.1765 | 7216.4 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.43904 | acc=0.8264 | tpr=0.9717 | fpr=0.1762 | 13426.5 samples/s | 52.4 steps/s
Avg test loss: 0.43857, Avg test acc: 0.82648, Avg tpr: 0.97147, Avg fpr: 0.17616, total FA: 24459

server round 41/50

clients selected: [1 2 5 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=9601 Epoch=46.8] | Loss=0.10973 | Reg=0.00325 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.019 | L2-Norm(final)=3.144 | 3136.2 samples/s | 49.0 steps/s
[Step=9650 Epoch=47.1] | Loss=0.03534 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.007 | L2-Norm(final)=3.142 | 3708.6 samples/s | 57.9 steps/s
[Step=9700 Epoch=47.3] | Loss=0.02229 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.001 | L2-Norm(final)=3.142 | 3690.2 samples/s | 57.7 steps/s
[Step=9750 Epoch=47.6] | Loss=0.01838 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.997 | L2-Norm(final)=3.142 | 3706.4 samples/s | 57.9 steps/s
[Step=9800 Epoch=47.8] | Loss=0.01696 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.994 | L2-Norm(final)=3.143 | 4604.6 samples/s | 71.9 steps/s
[Step=9850 Epoch=48.1] | Loss=0.01463 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.992 | L2-Norm(final)=3.143 | 1509.4 samples/s | 23.6 steps/s
[Step=9900 Epoch=48.3] | Loss=0.01324 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.991 | L2-Norm(final)=3.144 | 3682.2 samples/s | 57.5 steps/s
[Step=9950 Epoch=48.6] | Loss=0.01225 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.990 | L2-Norm(final)=3.145 | 3688.1 samples/s | 57.6 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01130 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.989 | L2-Norm(final)=3.146 | 4398.9 samples/s | 68.7 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01055 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.988 | L2-Norm(final)=3.147 | 1552.0 samples/s | 24.2 steps/s
[Step=10100 Epoch=49.3] | Loss=0.00984 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.988 | L2-Norm(final)=3.148 | 3700.0 samples/s | 57.8 steps/s
[Step=10150 Epoch=49.5] | Loss=0.00930 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=3.149 | 3677.6 samples/s | 57.5 steps/s
[Step=10200 Epoch=49.8] | Loss=0.00893 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=3.150 | 4215.3 samples/s | 65.9 steps/s
[Step=10250 Epoch=50.0] | Loss=0.00853 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=3.151 | 1569.6 samples/s | 24.5 steps/s
[Step=10300 Epoch=50.3] | Loss=0.00809 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=3.152 | 3782.8 samples/s | 59.1 steps/s
[Step=10350 Epoch=50.5] | Loss=0.00782 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.986 | L2-Norm(final)=3.153 | 3771.7 samples/s | 58.9 steps/s
[Step=10400 Epoch=50.7] | Loss=0.00761 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.986 | L2-Norm(final)=3.154 | 4129.1 samples/s | 64.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step10400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=78.0] | Loss=0.18836 | Reg=0.00325 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.019 | L2-Norm(final)=3.144 | 3272.3 samples/s | 51.1 steps/s
[Step=16050 Epoch=78.2] | Loss=0.03501 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.007 | L2-Norm(final)=3.143 | 3634.4 samples/s | 56.8 steps/s
[Step=16100 Epoch=78.4] | Loss=0.02505 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.001 | L2-Norm(final)=3.142 | 3760.7 samples/s | 58.8 steps/s
[Step=16150 Epoch=78.7] | Loss=0.02020 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.997 | L2-Norm(final)=3.143 | 3760.0 samples/s | 58.8 steps/s
[Step=16200 Epoch=78.9] | Loss=0.01809 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.995 | L2-Norm(final)=3.143 | 4694.9 samples/s | 73.4 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01544 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.994 | L2-Norm(final)=3.144 | 1538.2 samples/s | 24.0 steps/s
[Step=16300 Epoch=79.4] | Loss=0.01397 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.993 | L2-Norm(final)=3.145 | 3631.4 samples/s | 56.7 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01282 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.992 | L2-Norm(final)=3.145 | 3645.7 samples/s | 57.0 steps/s
[Step=16400 Epoch=79.9] | Loss=0.01185 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.991 | L2-Norm(final)=3.146 | 4308.4 samples/s | 67.3 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01090 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.991 | L2-Norm(final)=3.147 | 1549.8 samples/s | 24.2 steps/s
[Step=16500 Epoch=80.4] | Loss=0.01024 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.990 | L2-Norm(final)=3.148 | 3658.6 samples/s | 57.2 steps/s
[Step=16550 Epoch=80.6] | Loss=0.00976 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.990 | L2-Norm(final)=3.150 | 3644.5 samples/s | 56.9 steps/s
[Step=16600 Epoch=80.9] | Loss=0.00930 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.990 | L2-Norm(final)=3.151 | 4087.7 samples/s | 63.9 steps/s
[Step=16650 Epoch=81.1] | Loss=0.00885 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.989 | L2-Norm(final)=3.152 | 1602.0 samples/s | 25.0 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00845 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.989 | L2-Norm(final)=3.153 | 3761.8 samples/s | 58.8 steps/s
[Step=16750 Epoch=81.6] | Loss=0.00812 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.989 | L2-Norm(final)=3.154 | 3779.4 samples/s | 59.1 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00794 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.989 | L2-Norm(final)=3.155 | 4030.3 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step16800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=159.2] | Loss=0.14780 | Reg=0.00325 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.019 | L2-Norm(final)=3.144 | 3300.8 samples/s | 51.6 steps/s
[Step=16850 Epoch=159.7] | Loss=0.00950 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.985 | L2-Norm(final)=3.144 | 3346.5 samples/s | 52.3 steps/s
[Step=16900 Epoch=160.1] | Loss=0.00500 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.978 | L2-Norm(final)=3.145 | 4533.6 samples/s | 70.8 steps/s
[Step=16950 Epoch=160.6] | Loss=0.00340 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.973 | L2-Norm(final)=3.145 | 1500.4 samples/s | 23.4 steps/s
[Step=17000 Epoch=161.1] | Loss=0.00259 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.970 | L2-Norm(final)=3.146 | 4282.8 samples/s | 66.9 steps/s
[Step=17050 Epoch=161.6] | Loss=0.00209 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.967 | L2-Norm(final)=3.146 | 1503.8 samples/s | 23.5 steps/s
[Step=17100 Epoch=162.0] | Loss=0.00176 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.965 | L2-Norm(final)=3.147 | 3902.9 samples/s | 61.0 steps/s
[Step=17150 Epoch=162.5] | Loss=0.00153 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.963 | L2-Norm(final)=3.147 | 1545.4 samples/s | 24.1 steps/s
[Step=17200 Epoch=163.0] | Loss=0.00135 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=3.147 | 3764.2 samples/s | 58.8 steps/s
[Step=17250 Epoch=163.5] | Loss=0.00121 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=3.147 | 1563.6 samples/s | 24.4 steps/s
[Step=17300 Epoch=163.9] | Loss=0.00109 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.958 | L2-Norm(final)=3.148 | 3558.5 samples/s | 55.6 steps/s
[Step=17350 Epoch=164.4] | Loss=0.00100 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.956 | L2-Norm(final)=3.148 | 1605.1 samples/s | 25.1 steps/s
[Step=17400 Epoch=164.9] | Loss=0.00092 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.955 | L2-Norm(final)=3.148 | 3571.3 samples/s | 55.8 steps/s
[Step=17450 Epoch=165.4] | Loss=0.00086 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.954 | L2-Norm(final)=3.148 | 1612.8 samples/s | 25.2 steps/s
[Step=17500 Epoch=165.8] | Loss=0.00080 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.953 | L2-Norm(final)=3.149 | 3611.1 samples/s | 56.4 steps/s
[Step=17550 Epoch=166.3] | Loss=0.00075 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=3.149 | 1625.5 samples/s | 25.4 steps/s
[Step=17600 Epoch=166.8] | Loss=0.00071 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.951 | L2-Norm(final)=3.149 | 3546.8 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step17600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=23201 Epoch=218.6] | Loss=0.09659 | Reg=0.00325 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.019 | L2-Norm(final)=3.144 | 3080.7 samples/s | 48.1 steps/s
[Step=23250 Epoch=219.1] | Loss=0.00838 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.985 | L2-Norm(final)=3.144 | 3547.2 samples/s | 55.4 steps/s
[Step=23300 Epoch=219.6] | Loss=0.00454 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.978 | L2-Norm(final)=3.145 | 4437.0 samples/s | 69.3 steps/s
[Step=23350 Epoch=220.0] | Loss=0.00306 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.974 | L2-Norm(final)=3.145 | 1489.3 samples/s | 23.3 steps/s
[Step=23400 Epoch=220.5] | Loss=0.00234 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.970 | L2-Norm(final)=3.146 | 4094.2 samples/s | 64.0 steps/s
[Step=23450 Epoch=221.0] | Loss=0.00189 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.968 | L2-Norm(final)=3.146 | 1548.2 samples/s | 24.2 steps/s
[Step=23500 Epoch=221.4] | Loss=0.00159 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.966 | L2-Norm(final)=3.146 | 3976.8 samples/s | 62.1 steps/s
[Step=23550 Epoch=221.9] | Loss=0.00138 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.964 | L2-Norm(final)=3.147 | 1564.8 samples/s | 24.5 steps/s
[Step=23600 Epoch=222.4] | Loss=0.00122 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.962 | L2-Norm(final)=3.147 | 3739.6 samples/s | 58.4 steps/s
[Step=23650 Epoch=222.9] | Loss=0.00109 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.960 | L2-Norm(final)=3.147 | 1593.6 samples/s | 24.9 steps/s
[Step=23700 Epoch=223.3] | Loss=0.00099 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=3.147 | 3584.1 samples/s | 56.0 steps/s
[Step=23750 Epoch=223.8] | Loss=0.00090 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.957 | L2-Norm(final)=3.147 | 1627.2 samples/s | 25.4 steps/s
[Step=23800 Epoch=224.3] | Loss=0.00083 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.956 | L2-Norm(final)=3.148 | 3533.7 samples/s | 55.2 steps/s
[Step=23850 Epoch=224.7] | Loss=0.00077 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.955 | L2-Norm(final)=3.148 | 1598.2 samples/s | 25.0 steps/s
[Step=23900 Epoch=225.2] | Loss=0.00072 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.954 | L2-Norm(final)=3.148 | 3469.4 samples/s | 54.2 steps/s
[Step=23950 Epoch=225.7] | Loss=0.00068 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.953 | L2-Norm(final)=3.148 | 1661.7 samples/s | 26.0 steps/s
[Step=24000 Epoch=226.1] | Loss=0.00064 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=3.148 | 3426.4 samples/s | 53.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step24000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=190.6] | Loss=0.02147 | Reg=0.00325 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.019 | L2-Norm(final)=3.144 | 3233.0 samples/s | 50.5 steps/s
[Step=20050 Epoch=191.1] | Loss=0.00714 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=3.145 | 3410.1 samples/s | 53.3 steps/s
[Step=20100 Epoch=191.6] | Loss=0.00372 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.979 | L2-Norm(final)=3.146 | 4566.7 samples/s | 71.4 steps/s
[Step=20150 Epoch=192.0] | Loss=0.00251 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.974 | L2-Norm(final)=3.146 | 1469.0 samples/s | 23.0 steps/s
[Step=20200 Epoch=192.5] | Loss=0.00190 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.970 | L2-Norm(final)=3.147 | 4341.8 samples/s | 67.8 steps/s
[Step=20250 Epoch=193.0] | Loss=0.00154 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.967 | L2-Norm(final)=3.147 | 1502.1 samples/s | 23.5 steps/s
[Step=20300 Epoch=193.5] | Loss=0.00129 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.965 | L2-Norm(final)=3.147 | 3988.3 samples/s | 62.3 steps/s
[Step=20350 Epoch=194.0] | Loss=0.00112 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.963 | L2-Norm(final)=3.147 | 1511.1 samples/s | 23.6 steps/s
[Step=20400 Epoch=194.4] | Loss=0.00098 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=3.147 | 3854.3 samples/s | 60.2 steps/s
[Step=20450 Epoch=194.9] | Loss=0.00088 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=3.148 | 1547.0 samples/s | 24.2 steps/s
[Step=20500 Epoch=195.4] | Loss=0.00080 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.957 | L2-Norm(final)=3.148 | 3719.2 samples/s | 58.1 steps/s
[Step=20550 Epoch=195.9] | Loss=0.00073 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.956 | L2-Norm(final)=3.148 | 1569.2 samples/s | 24.5 steps/s
[Step=20600 Epoch=196.3] | Loss=0.00067 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.954 | L2-Norm(final)=3.148 | 3664.9 samples/s | 57.3 steps/s
[Step=20650 Epoch=196.8] | Loss=0.00062 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.953 | L2-Norm(final)=3.148 | 1622.3 samples/s | 25.3 steps/s
[Step=20700 Epoch=197.3] | Loss=0.00058 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.951 | L2-Norm(final)=3.148 | 3630.4 samples/s | 56.7 steps/s
[Step=20750 Epoch=197.8] | Loss=0.00055 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.950 | L2-Norm(final)=3.149 | 1628.1 samples/s | 25.4 steps/s
[Step=20800 Epoch=198.2] | Loss=0.00052 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.949 | L2-Norm(final)=3.149 | 3552.4 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29964 | acc=0.8332 | tpr=0.7613 | fpr=0.0107 | 3693.1 samples/s | 14.4 steps/s
Avg test loss: 0.30970, Avg test acc: 0.83156, Avg tpr: 0.76056, Avg fpr: 0.01231, total FA: 96

Testing server on iccad2012
[Step=  50] | Loss=0.41488 | acc=0.8355 | tpr=0.9558 | fpr=0.1666 | 3720.0 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.42410 | acc=0.8336 | tpr=0.9638 | fpr=0.1688 | 7409.0 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.42984 | acc=0.8327 | tpr=0.9726 | fpr=0.1699 | 7525.2 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.43515 | acc=0.8308 | tpr=0.9749 | fpr=0.1718 | 7360.5 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.43477 | acc=0.8301 | tpr=0.9755 | fpr=0.1726 | 7307.7 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.43430 | acc=0.8298 | tpr=0.9789 | fpr=0.1729 | 7458.7 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.43652 | acc=0.8293 | tpr=0.9781 | fpr=0.1734 | 7594.5 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.43868 | acc=0.8292 | tpr=0.9754 | fpr=0.1735 | 7232.8 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.43900 | acc=0.8293 | tpr=0.9742 | fpr=0.1734 | 7494.2 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.43909 | acc=0.8289 | tpr=0.9731 | fpr=0.1737 | 7041.2 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.43839 | acc=0.8291 | tpr=0.9717 | fpr=0.1735 | 14313.1 samples/s | 55.9 steps/s
Avg test loss: 0.43792, Avg test acc: 0.82917, Avg tpr: 0.97147, Avg fpr: 0.17342, total FA: 24079

server round 42/50

clients selected: [1 3 5 6 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=10401 Epoch=50.8] | Loss=0.26817 | Reg=0.00323 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=17.983 | L2-Norm(final)=3.153 | 3169.8 samples/s | 49.5 steps/s
[Step=10450 Epoch=51.0] | Loss=0.03060 | Reg=0.00323 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.971 | L2-Norm(final)=3.152 | 3773.5 samples/s | 59.0 steps/s
[Step=10500 Epoch=51.2] | Loss=0.02248 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.965 | L2-Norm(final)=3.152 | 3788.1 samples/s | 59.2 steps/s
[Step=10550 Epoch=51.5] | Loss=0.01908 | Reg=0.00323 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.961 | L2-Norm(final)=3.152 | 3767.3 samples/s | 58.9 steps/s
[Step=10600 Epoch=51.7] | Loss=0.01611 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=3.153 | 4721.1 samples/s | 73.8 steps/s
[Step=10650 Epoch=52.0] | Loss=0.01390 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.957 | L2-Norm(final)=3.154 | 1536.3 samples/s | 24.0 steps/s
[Step=10700 Epoch=52.2] | Loss=0.01262 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.956 | L2-Norm(final)=3.154 | 3772.2 samples/s | 58.9 steps/s
[Step=10750 Epoch=52.5] | Loss=0.01152 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.955 | L2-Norm(final)=3.155 | 3780.8 samples/s | 59.1 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01069 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.954 | L2-Norm(final)=3.156 | 4504.6 samples/s | 70.4 steps/s
[Step=10850 Epoch=52.9] | Loss=0.00991 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.954 | L2-Norm(final)=3.157 | 1548.4 samples/s | 24.2 steps/s
[Step=10900 Epoch=53.2] | Loss=0.00940 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.953 | L2-Norm(final)=3.158 | 3675.3 samples/s | 57.4 steps/s
[Step=10950 Epoch=53.4] | Loss=0.00893 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.953 | L2-Norm(final)=3.159 | 3703.8 samples/s | 57.9 steps/s
[Step=11000 Epoch=53.7] | Loss=0.00851 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.953 | L2-Norm(final)=3.160 | 4201.3 samples/s | 65.6 steps/s
[Step=11050 Epoch=53.9] | Loss=0.00819 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=3.161 | 1582.3 samples/s | 24.7 steps/s
[Step=11100 Epoch=54.2] | Loss=0.00783 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=3.162 | 3790.4 samples/s | 59.2 steps/s
[Step=11150 Epoch=54.4] | Loss=0.00756 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.952 | L2-Norm(final)=3.163 | 3795.7 samples/s | 59.3 steps/s
[Step=11200 Epoch=54.7] | Loss=0.00732 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=3.164 | 4149.0 samples/s | 64.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step11200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=13601 Epoch=66.3] | Loss=0.24072 | Reg=0.00323 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=17.983 | L2-Norm(final)=3.153 | 3364.9 samples/s | 52.6 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03158 | Reg=0.00323 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.969 | L2-Norm(final)=3.151 | 3506.2 samples/s | 54.8 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02194 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.963 | L2-Norm(final)=3.151 | 3766.8 samples/s | 58.9 steps/s
[Step=13750 Epoch=67.1] | Loss=0.01735 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.960 | L2-Norm(final)=3.152 | 3780.6 samples/s | 59.1 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01523 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.958 | L2-Norm(final)=3.152 | 4695.8 samples/s | 73.4 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01330 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.957 | L2-Norm(final)=3.153 | 1529.1 samples/s | 23.9 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01194 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.956 | L2-Norm(final)=3.154 | 3705.0 samples/s | 57.9 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01117 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.955 | L2-Norm(final)=3.155 | 3687.9 samples/s | 57.6 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01029 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.954 | L2-Norm(final)=3.156 | 4366.7 samples/s | 68.2 steps/s
[Step=14050 Epoch=68.5] | Loss=0.00953 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.953 | L2-Norm(final)=3.158 | 1563.2 samples/s | 24.4 steps/s
[Step=14100 Epoch=68.8] | Loss=0.00890 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.953 | L2-Norm(final)=3.159 | 3770.0 samples/s | 58.9 steps/s
[Step=14150 Epoch=69.0] | Loss=0.00845 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.953 | L2-Norm(final)=3.160 | 3779.9 samples/s | 59.1 steps/s
[Step=14200 Epoch=69.2] | Loss=0.00815 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=3.161 | 4249.6 samples/s | 66.4 steps/s
[Step=14250 Epoch=69.5] | Loss=0.00784 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.952 | L2-Norm(final)=3.162 | 1571.6 samples/s | 24.6 steps/s
[Step=14300 Epoch=69.7] | Loss=0.00748 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=3.163 | 3746.9 samples/s | 58.5 steps/s
[Step=14350 Epoch=70.0] | Loss=0.00720 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=3.164 | 3779.4 samples/s | 59.1 steps/s
[Step=14400 Epoch=70.2] | Loss=0.00700 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=3.165 | 4042.1 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step14400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=166.8] | Loss=0.12437 | Reg=0.00323 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.983 | L2-Norm(final)=3.153 | 3110.7 samples/s | 48.6 steps/s
[Step=17650 Epoch=167.2] | Loss=0.00748 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.951 | L2-Norm(final)=3.154 | 3502.3 samples/s | 54.7 steps/s
[Step=17700 Epoch=167.7] | Loss=0.00391 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.943 | L2-Norm(final)=3.154 | 4415.4 samples/s | 69.0 steps/s
[Step=17750 Epoch=168.2] | Loss=0.00267 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.938 | L2-Norm(final)=3.155 | 1492.1 samples/s | 23.3 steps/s
[Step=17800 Epoch=168.7] | Loss=0.00203 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.935 | L2-Norm(final)=3.155 | 4269.7 samples/s | 66.7 steps/s
[Step=17850 Epoch=169.1] | Loss=0.00165 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.932 | L2-Norm(final)=3.156 | 1516.1 samples/s | 23.7 steps/s
[Step=17900 Epoch=169.6] | Loss=0.00139 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.930 | L2-Norm(final)=3.156 | 4049.9 samples/s | 63.3 steps/s
[Step=17950 Epoch=170.1] | Loss=0.00121 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.927 | L2-Norm(final)=3.156 | 1547.1 samples/s | 24.2 steps/s
[Step=18000 Epoch=170.6] | Loss=0.00107 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.926 | L2-Norm(final)=3.156 | 3741.7 samples/s | 58.5 steps/s
[Step=18050 Epoch=171.0] | Loss=0.00096 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.924 | L2-Norm(final)=3.157 | 1587.4 samples/s | 24.8 steps/s
[Step=18100 Epoch=171.5] | Loss=0.00087 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.922 | L2-Norm(final)=3.157 | 3651.4 samples/s | 57.1 steps/s
[Step=18150 Epoch=172.0] | Loss=0.00080 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.921 | L2-Norm(final)=3.157 | 1590.2 samples/s | 24.8 steps/s
[Step=18200 Epoch=172.5] | Loss=0.00074 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.920 | L2-Norm(final)=3.157 | 3619.7 samples/s | 56.6 steps/s
[Step=18250 Epoch=172.9] | Loss=0.00068 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.918 | L2-Norm(final)=3.158 | 1615.5 samples/s | 25.2 steps/s
[Step=18300 Epoch=173.4] | Loss=0.00064 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.917 | L2-Norm(final)=3.158 | 3610.3 samples/s | 56.4 steps/s
[Step=18350 Epoch=173.9] | Loss=0.00060 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.916 | L2-Norm(final)=3.158 | 1633.9 samples/s | 25.5 steps/s
[Step=18400 Epoch=174.4] | Loss=0.00057 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.915 | L2-Norm(final)=3.158 | 3581.5 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step18400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=152.2] | Loss=0.06142 | Reg=0.00323 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.983 | L2-Norm(final)=3.153 | 3198.4 samples/s | 50.0 steps/s
[Step=16050 Epoch=152.7] | Loss=0.00853 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.946 | L2-Norm(final)=3.153 | 3436.4 samples/s | 53.7 steps/s
[Step=16100 Epoch=153.2] | Loss=0.00435 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.937 | L2-Norm(final)=3.153 | 4410.8 samples/s | 68.9 steps/s
[Step=16150 Epoch=153.6] | Loss=0.00294 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.932 | L2-Norm(final)=3.154 | 1487.5 samples/s | 23.2 steps/s
[Step=16200 Epoch=154.1] | Loss=0.00223 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.929 | L2-Norm(final)=3.154 | 4295.8 samples/s | 67.1 steps/s
[Step=16250 Epoch=154.6] | Loss=0.00180 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.926 | L2-Norm(final)=3.154 | 1512.9 samples/s | 23.6 steps/s
[Step=16300 Epoch=155.1] | Loss=0.00151 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.924 | L2-Norm(final)=3.155 | 4054.4 samples/s | 63.3 steps/s
[Step=16350 Epoch=155.5] | Loss=0.00131 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.922 | L2-Norm(final)=3.155 | 1550.9 samples/s | 24.2 steps/s
[Step=16400 Epoch=156.0] | Loss=0.00115 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.920 | L2-Norm(final)=3.155 | 3833.1 samples/s | 59.9 steps/s
[Step=16450 Epoch=156.5] | Loss=0.00103 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.918 | L2-Norm(final)=3.156 | 1580.5 samples/s | 24.7 steps/s
[Step=16500 Epoch=157.0] | Loss=0.00094 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.917 | L2-Norm(final)=3.156 | 3664.4 samples/s | 57.3 steps/s
[Step=16550 Epoch=157.4] | Loss=0.00086 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.915 | L2-Norm(final)=3.156 | 1613.0 samples/s | 25.2 steps/s
[Step=16600 Epoch=157.9] | Loss=0.00079 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.914 | L2-Norm(final)=3.156 | 3598.4 samples/s | 56.2 steps/s
[Step=16650 Epoch=158.4] | Loss=0.00073 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=3.156 | 1609.5 samples/s | 25.1 steps/s
[Step=16700 Epoch=158.9] | Loss=0.00068 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=3.157 | 3589.5 samples/s | 56.1 steps/s
[Step=16750 Epoch=159.3] | Loss=0.00064 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.910 | L2-Norm(final)=3.157 | 1600.0 samples/s | 25.0 steps/s
[Step=16800 Epoch=159.8] | Loss=0.00060 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.909 | L2-Norm(final)=3.157 | 3553.0 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step16800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=175.7] | Loss=0.12788 | Reg=0.00323 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.983 | L2-Norm(final)=3.153 | 3180.8 samples/s | 49.7 steps/s
[Step=18450 Epoch=176.2] | Loss=0.00870 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.950 | L2-Norm(final)=3.154 | 3545.0 samples/s | 55.4 steps/s
[Step=18500 Epoch=176.7] | Loss=0.00441 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.942 | L2-Norm(final)=3.154 | 4502.7 samples/s | 70.4 steps/s
[Step=18550 Epoch=177.1] | Loss=0.00298 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.938 | L2-Norm(final)=3.155 | 1487.4 samples/s | 23.2 steps/s
[Step=18600 Epoch=177.6] | Loss=0.00226 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.934 | L2-Norm(final)=3.155 | 4315.7 samples/s | 67.4 steps/s
[Step=18650 Epoch=178.1] | Loss=0.00182 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.932 | L2-Norm(final)=3.155 | 1493.2 samples/s | 23.3 steps/s
[Step=18700 Epoch=178.6] | Loss=0.00153 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.929 | L2-Norm(final)=3.155 | 4147.7 samples/s | 64.8 steps/s
[Step=18750 Epoch=179.1] | Loss=0.00132 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.927 | L2-Norm(final)=3.156 | 1534.8 samples/s | 24.0 steps/s
[Step=18800 Epoch=179.5] | Loss=0.00116 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.925 | L2-Norm(final)=3.156 | 3952.0 samples/s | 61.7 steps/s
[Step=18850 Epoch=180.0] | Loss=0.00104 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.923 | L2-Norm(final)=3.156 | 1585.9 samples/s | 24.8 steps/s
[Step=18900 Epoch=180.5] | Loss=0.00094 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.922 | L2-Norm(final)=3.156 | 3711.9 samples/s | 58.0 steps/s
[Step=18950 Epoch=181.0] | Loss=0.00086 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.920 | L2-Norm(final)=3.156 | 1577.6 samples/s | 24.6 steps/s
[Step=19000 Epoch=181.4] | Loss=0.00079 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.919 | L2-Norm(final)=3.156 | 3647.3 samples/s | 57.0 steps/s
[Step=19050 Epoch=181.9] | Loss=0.00073 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.918 | L2-Norm(final)=3.156 | 1599.5 samples/s | 25.0 steps/s
[Step=19100 Epoch=182.4] | Loss=0.00068 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.916 | L2-Norm(final)=3.157 | 3550.0 samples/s | 55.5 steps/s
[Step=19150 Epoch=182.9] | Loss=0.00064 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.915 | L2-Norm(final)=3.157 | 1622.2 samples/s | 25.3 steps/s
[Step=19200 Epoch=183.3] | Loss=0.00060 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.914 | L2-Norm(final)=3.157 | 3551.2 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30226 | acc=0.8344 | tpr=0.7630 | fpr=0.0107 | 3734.3 samples/s | 14.6 steps/s
Avg test loss: 0.31216, Avg test acc: 0.83252, Avg tpr: 0.76190, Avg fpr: 0.01218, total FA: 95

Testing server on iccad2012
[Step=  50] | Loss=0.42072 | acc=0.8358 | tpr=0.9602 | fpr=0.1665 | 3728.2 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.42997 | acc=0.8344 | tpr=0.9659 | fpr=0.1681 | 7454.5 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.43580 | acc=0.8330 | tpr=0.9726 | fpr=0.1696 | 7558.1 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.44117 | acc=0.8309 | tpr=0.9749 | fpr=0.1717 | 7182.7 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.44064 | acc=0.8303 | tpr=0.9755 | fpr=0.1723 | 7526.6 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.44016 | acc=0.8301 | tpr=0.9789 | fpr=0.1726 | 7580.2 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.44243 | acc=0.8295 | tpr=0.9781 | fpr=0.1732 | 7218.2 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.44467 | acc=0.8295 | tpr=0.9754 | fpr=0.1732 | 7451.4 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.44497 | acc=0.8295 | tpr=0.9742 | fpr=0.1731 | 7208.3 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.44503 | acc=0.8292 | tpr=0.9731 | fpr=0.1734 | 7255.1 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.44429 | acc=0.8293 | tpr=0.9717 | fpr=0.1733 | 13723.8 samples/s | 53.6 steps/s
Avg test loss: 0.44380, Avg test acc: 0.82939, Avg tpr: 0.97147, Avg fpr: 0.17319, total FA: 24047

server round 43/50

clients selected: [1 3 4 5 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=11201 Epoch=54.7] | Loss=0.22325 | Reg=0.00322 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=17.942 | L2-Norm(final)=3.164 | 3309.2 samples/s | 51.7 steps/s
[Step=11250 Epoch=54.9] | Loss=0.03213 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.930 | L2-Norm(final)=3.163 | 3566.0 samples/s | 55.7 steps/s
[Step=11300 Epoch=55.1] | Loss=0.02181 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.924 | L2-Norm(final)=3.163 | 3688.8 samples/s | 57.6 steps/s
[Step=11350 Epoch=55.4] | Loss=0.01752 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.921 | L2-Norm(final)=3.163 | 3677.2 samples/s | 57.5 steps/s
[Step=11400 Epoch=55.6] | Loss=0.01549 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.918 | L2-Norm(final)=3.163 | 4609.8 samples/s | 72.0 steps/s
[Step=11450 Epoch=55.9] | Loss=0.01341 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.917 | L2-Norm(final)=3.164 | 1537.8 samples/s | 24.0 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01209 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.915 | L2-Norm(final)=3.165 | 3781.6 samples/s | 59.1 steps/s
[Step=11550 Epoch=56.4] | Loss=0.01113 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.914 | L2-Norm(final)=3.166 | 3777.5 samples/s | 59.0 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01042 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=3.167 | 4515.7 samples/s | 70.6 steps/s
[Step=11650 Epoch=56.8] | Loss=0.00973 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=3.168 | 1557.2 samples/s | 24.3 steps/s
[Step=11700 Epoch=57.1] | Loss=0.00916 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=3.169 | 3793.1 samples/s | 59.3 steps/s
[Step=11750 Epoch=57.3] | Loss=0.00868 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.912 | L2-Norm(final)=3.170 | 3773.2 samples/s | 59.0 steps/s
[Step=11800 Epoch=57.6] | Loss=0.00822 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=3.171 | 4311.6 samples/s | 67.4 steps/s
[Step=11850 Epoch=57.8] | Loss=0.00796 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=3.172 | 1575.6 samples/s | 24.6 steps/s
[Step=11900 Epoch=58.1] | Loss=0.00763 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=3.173 | 3790.1 samples/s | 59.2 steps/s
[Step=11950 Epoch=58.3] | Loss=0.00735 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=3.174 | 3771.6 samples/s | 58.9 steps/s
[Step=12000 Epoch=58.6] | Loss=0.00713 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=3.175 | 4140.9 samples/s | 64.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step12000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=14401 Epoch=70.2] | Loss=0.06227 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.942 | L2-Norm(final)=3.164 | 3269.6 samples/s | 51.1 steps/s
[Step=14450 Epoch=70.5] | Loss=0.02738 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.928 | L2-Norm(final)=3.163 | 3567.5 samples/s | 55.7 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02075 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.922 | L2-Norm(final)=3.162 | 3678.5 samples/s | 57.5 steps/s
[Step=14550 Epoch=71.0] | Loss=0.01742 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.919 | L2-Norm(final)=3.163 | 3696.0 samples/s | 57.8 steps/s
[Step=14600 Epoch=71.2] | Loss=0.01486 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.917 | L2-Norm(final)=3.163 | 4599.6 samples/s | 71.9 steps/s
[Step=14650 Epoch=71.4] | Loss=0.01290 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.916 | L2-Norm(final)=3.164 | 1535.6 samples/s | 24.0 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01163 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.915 | L2-Norm(final)=3.165 | 3710.5 samples/s | 58.0 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01057 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.914 | L2-Norm(final)=3.166 | 3709.0 samples/s | 58.0 steps/s
[Step=14800 Epoch=72.2] | Loss=0.00996 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.913 | L2-Norm(final)=3.167 | 4369.1 samples/s | 68.3 steps/s
[Step=14850 Epoch=72.4] | Loss=0.00928 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=3.168 | 1543.6 samples/s | 24.1 steps/s
[Step=14900 Epoch=72.7] | Loss=0.00869 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=3.169 | 3663.7 samples/s | 57.2 steps/s
[Step=14950 Epoch=72.9] | Loss=0.00841 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=3.171 | 3667.1 samples/s | 57.3 steps/s
[Step=15000 Epoch=73.1] | Loss=0.00799 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=3.172 | 4088.0 samples/s | 63.9 steps/s
[Step=15050 Epoch=73.4] | Loss=0.00768 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=3.173 | 1597.2 samples/s | 25.0 steps/s
[Step=15100 Epoch=73.6] | Loss=0.00735 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=3.174 | 3772.0 samples/s | 58.9 steps/s
[Step=15150 Epoch=73.9] | Loss=0.00711 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=3.175 | 3775.5 samples/s | 59.0 steps/s
[Step=15200 Epoch=74.1] | Loss=0.00687 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.910 | L2-Norm(final)=3.176 | 4038.8 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step15200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=78.5] | Loss=0.24919 | Reg=0.00322 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=17.942 | L2-Norm(final)=3.164 | 3208.9 samples/s | 50.1 steps/s
[Step=16050 Epoch=78.7] | Loss=0.03097 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.929 | L2-Norm(final)=3.162 | 3721.5 samples/s | 58.1 steps/s
[Step=16100 Epoch=79.0] | Loss=0.02139 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.923 | L2-Norm(final)=3.162 | 3779.9 samples/s | 59.1 steps/s
[Step=16150 Epoch=79.2] | Loss=0.01849 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.920 | L2-Norm(final)=3.163 | 3794.1 samples/s | 59.3 steps/s
[Step=16200 Epoch=79.4] | Loss=0.01615 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.918 | L2-Norm(final)=3.164 | 4751.5 samples/s | 74.2 steps/s
[Step=16250 Epoch=79.7] | Loss=0.01413 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.916 | L2-Norm(final)=3.164 | 1512.0 samples/s | 23.6 steps/s
[Step=16300 Epoch=79.9] | Loss=0.01289 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.915 | L2-Norm(final)=3.165 | 3659.0 samples/s | 57.2 steps/s
[Step=16350 Epoch=80.2] | Loss=0.01175 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.915 | L2-Norm(final)=3.166 | 3664.7 samples/s | 57.3 steps/s
[Step=16400 Epoch=80.4] | Loss=0.01086 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.914 | L2-Norm(final)=3.167 | 4430.3 samples/s | 69.2 steps/s
[Step=16450 Epoch=80.7] | Loss=0.01009 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.914 | L2-Norm(final)=3.169 | 1541.4 samples/s | 24.1 steps/s
[Step=16500 Epoch=80.9] | Loss=0.00952 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.913 | L2-Norm(final)=3.170 | 3789.1 samples/s | 59.2 steps/s
[Step=16550 Epoch=81.2] | Loss=0.00895 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=3.171 | 3783.4 samples/s | 59.1 steps/s
[Step=16600 Epoch=81.4] | Loss=0.00867 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.913 | L2-Norm(final)=3.172 | 4444.7 samples/s | 69.4 steps/s
[Step=16650 Epoch=81.6] | Loss=0.00828 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=3.173 | 1568.6 samples/s | 24.5 steps/s
[Step=16700 Epoch=81.9] | Loss=0.00788 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=3.174 | 3773.7 samples/s | 59.0 steps/s
[Step=16750 Epoch=82.1] | Loss=0.00763 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=3.175 | 3773.3 samples/s | 59.0 steps/s
[Step=16800 Epoch=82.4] | Loss=0.00742 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=3.176 | 4287.2 samples/s | 67.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_4/client_state-step16800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=174.4] | Loss=0.05857 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.942 | L2-Norm(final)=3.164 | 3318.5 samples/s | 51.9 steps/s
[Step=18450 Epoch=174.8] | Loss=0.00858 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.907 | L2-Norm(final)=3.164 | 3361.6 samples/s | 52.5 steps/s
[Step=18500 Epoch=175.3] | Loss=0.00452 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.899 | L2-Norm(final)=3.165 | 4523.1 samples/s | 70.7 steps/s
[Step=18550 Epoch=175.8] | Loss=0.00309 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.895 | L2-Norm(final)=3.165 | 1482.1 samples/s | 23.2 steps/s
[Step=18600 Epoch=176.3] | Loss=0.00234 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.892 | L2-Norm(final)=3.166 | 4121.0 samples/s | 64.4 steps/s
[Step=18650 Epoch=176.7] | Loss=0.00189 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.889 | L2-Norm(final)=3.166 | 1501.9 samples/s | 23.5 steps/s
[Step=18700 Epoch=177.2] | Loss=0.00159 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.887 | L2-Norm(final)=3.166 | 3951.3 samples/s | 61.7 steps/s
[Step=18750 Epoch=177.7] | Loss=0.00137 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.885 | L2-Norm(final)=3.167 | 1551.3 samples/s | 24.2 steps/s
[Step=18800 Epoch=178.1] | Loss=0.00121 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.883 | L2-Norm(final)=3.167 | 3759.3 samples/s | 58.7 steps/s
[Step=18850 Epoch=178.6] | Loss=0.00108 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=3.167 | 1538.7 samples/s | 24.0 steps/s
[Step=18900 Epoch=179.1] | Loss=0.00098 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.880 | L2-Norm(final)=3.167 | 3615.1 samples/s | 56.5 steps/s
[Step=18950 Epoch=179.6] | Loss=0.00090 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.878 | L2-Norm(final)=3.168 | 1590.0 samples/s | 24.8 steps/s
[Step=19000 Epoch=180.0] | Loss=0.00083 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.877 | L2-Norm(final)=3.168 | 3603.9 samples/s | 56.3 steps/s
[Step=19050 Epoch=180.5] | Loss=0.00077 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.876 | L2-Norm(final)=3.168 | 1600.5 samples/s | 25.0 steps/s
[Step=19100 Epoch=181.0] | Loss=0.00072 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.875 | L2-Norm(final)=3.168 | 3604.5 samples/s | 56.3 steps/s
[Step=19150 Epoch=181.5] | Loss=0.00067 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.168 | 1626.7 samples/s | 25.4 steps/s
[Step=19200 Epoch=181.9] | Loss=0.00064 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.872 | L2-Norm(final)=3.168 | 3515.5 samples/s | 54.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step19200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=183.4] | Loss=0.06508 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.942 | L2-Norm(final)=3.164 | 3220.9 samples/s | 50.3 steps/s
[Step=19250 Epoch=183.8] | Loss=0.01117 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.908 | L2-Norm(final)=3.164 | 3353.7 samples/s | 52.4 steps/s
[Step=19300 Epoch=184.3] | Loss=0.00584 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.900 | L2-Norm(final)=3.164 | 4454.8 samples/s | 69.6 steps/s
[Step=19350 Epoch=184.8] | Loss=0.00392 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.896 | L2-Norm(final)=3.164 | 1464.2 samples/s | 22.9 steps/s
[Step=19400 Epoch=185.3] | Loss=0.00297 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.892 | L2-Norm(final)=3.164 | 4282.2 samples/s | 66.9 steps/s
[Step=19450 Epoch=185.7] | Loss=0.00239 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.890 | L2-Norm(final)=3.164 | 1517.8 samples/s | 23.7 steps/s
[Step=19500 Epoch=186.2] | Loss=0.00200 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.887 | L2-Norm(final)=3.165 | 4130.9 samples/s | 64.5 steps/s
[Step=19550 Epoch=186.7] | Loss=0.00172 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.885 | L2-Norm(final)=3.165 | 1509.4 samples/s | 23.6 steps/s
[Step=19600 Epoch=187.2] | Loss=0.00151 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.883 | L2-Norm(final)=3.165 | 3855.5 samples/s | 60.2 steps/s
[Step=19650 Epoch=187.6] | Loss=0.00135 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.882 | L2-Norm(final)=3.165 | 1544.4 samples/s | 24.1 steps/s
[Step=19700 Epoch=188.1] | Loss=0.00122 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.880 | L2-Norm(final)=3.165 | 3798.5 samples/s | 59.4 steps/s
[Step=19750 Epoch=188.6] | Loss=0.00111 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.879 | L2-Norm(final)=3.165 | 1579.2 samples/s | 24.7 steps/s
[Step=19800 Epoch=189.1] | Loss=0.00103 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.878 | L2-Norm(final)=3.166 | 3583.7 samples/s | 56.0 steps/s
[Step=19850 Epoch=189.6] | Loss=0.00095 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.876 | L2-Norm(final)=3.166 | 1592.0 samples/s | 24.9 steps/s
[Step=19900 Epoch=190.0] | Loss=0.00088 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.875 | L2-Norm(final)=3.166 | 3583.5 samples/s | 56.0 steps/s
[Step=19950 Epoch=190.5] | Loss=0.00083 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.166 | 1613.7 samples/s | 25.2 steps/s
[Step=20000 Epoch=191.0] | Loss=0.00078 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.873 | L2-Norm(final)=3.166 | 3527.7 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29501 | acc=0.8391 | tpr=0.7701 | fpr=0.0109 | 3704.6 samples/s | 14.5 steps/s
Avg test loss: 0.30502, Avg test acc: 0.83653, Avg tpr: 0.76785, Avg fpr: 0.01243, total FA: 97

Testing server on iccad2012
[Step=  50] | Loss=0.42853 | acc=0.8344 | tpr=0.9602 | fpr=0.1679 | 3739.7 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.43786 | acc=0.8332 | tpr=0.9680 | fpr=0.1694 | 7325.3 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.44382 | acc=0.8317 | tpr=0.9755 | fpr=0.1710 | 7539.8 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.44915 | acc=0.8296 | tpr=0.9770 | fpr=0.1730 | 7190.6 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.44858 | acc=0.8292 | tpr=0.9773 | fpr=0.1735 | 7436.1 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.44805 | acc=0.8289 | tpr=0.9804 | fpr=0.1738 | 7468.6 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.45035 | acc=0.8283 | tpr=0.9793 | fpr=0.1745 | 7361.4 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.45263 | acc=0.8283 | tpr=0.9765 | fpr=0.1744 | 7363.6 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.45294 | acc=0.8282 | tpr=0.9752 | fpr=0.1744 | 7408.9 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.45300 | acc=0.8279 | tpr=0.9740 | fpr=0.1748 | 7225.7 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.45220 | acc=0.8280 | tpr=0.9725 | fpr=0.1746 | 13797.9 samples/s | 53.9 steps/s
Avg test loss: 0.45171, Avg test acc: 0.82812, Avg tpr: 0.97227, Avg fpr: 0.17450, total FA: 24229

server round 44/50

clients selected: [1 3 6 7 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=12001 Epoch=58.6] | Loss=0.17528 | Reg=0.00321 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=17.915 | L2-Norm(final)=3.171 | 3091.8 samples/s | 48.3 steps/s
[Step=12050 Epoch=58.8] | Loss=0.02982 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.902 | L2-Norm(final)=3.170 | 3776.5 samples/s | 59.0 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02108 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.897 | L2-Norm(final)=3.169 | 3779.9 samples/s | 59.1 steps/s
[Step=12150 Epoch=59.3] | Loss=0.01804 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.894 | L2-Norm(final)=3.170 | 3779.1 samples/s | 59.0 steps/s
[Step=12200 Epoch=59.5] | Loss=0.01567 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.891 | L2-Norm(final)=3.170 | 4653.3 samples/s | 72.7 steps/s
[Step=12250 Epoch=59.8] | Loss=0.01364 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.890 | L2-Norm(final)=3.171 | 1533.3 samples/s | 24.0 steps/s
[Step=12300 Epoch=60.0] | Loss=0.01217 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.889 | L2-Norm(final)=3.172 | 3677.9 samples/s | 57.5 steps/s
[Step=12350 Epoch=60.3] | Loss=0.01122 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.888 | L2-Norm(final)=3.173 | 3656.5 samples/s | 57.1 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01037 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.887 | L2-Norm(final)=3.174 | 4357.2 samples/s | 68.1 steps/s
[Step=12450 Epoch=60.8] | Loss=0.00970 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.887 | L2-Norm(final)=3.175 | 1531.2 samples/s | 23.9 steps/s
[Step=12500 Epoch=61.0] | Loss=0.00913 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.886 | L2-Norm(final)=3.176 | 3682.3 samples/s | 57.5 steps/s
[Step=12550 Epoch=61.2] | Loss=0.00871 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.886 | L2-Norm(final)=3.177 | 3665.6 samples/s | 57.3 steps/s
[Step=12600 Epoch=61.5] | Loss=0.00826 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.885 | L2-Norm(final)=3.178 | 4168.4 samples/s | 65.1 steps/s
[Step=12650 Epoch=61.7] | Loss=0.00790 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.885 | L2-Norm(final)=3.179 | 1572.4 samples/s | 24.6 steps/s
[Step=12700 Epoch=62.0] | Loss=0.00763 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.885 | L2-Norm(final)=3.180 | 3777.8 samples/s | 59.0 steps/s
[Step=12750 Epoch=62.2] | Loss=0.00742 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.885 | L2-Norm(final)=3.181 | 3753.9 samples/s | 58.7 steps/s
[Step=12800 Epoch=62.5] | Loss=0.00712 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.884 | L2-Norm(final)=3.182 | 4151.5 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step12800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=74.1] | Loss=0.23728 | Reg=0.00321 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=17.915 | L2-Norm(final)=3.170 | 3219.4 samples/s | 50.3 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02783 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.902 | L2-Norm(final)=3.169 | 3764.2 samples/s | 58.8 steps/s
[Step=15300 Epoch=74.6] | Loss=0.01891 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.897 | L2-Norm(final)=3.170 | 3687.1 samples/s | 57.6 steps/s
[Step=15350 Epoch=74.9] | Loss=0.01610 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.894 | L2-Norm(final)=3.171 | 3692.0 samples/s | 57.7 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01432 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.892 | L2-Norm(final)=3.171 | 4558.1 samples/s | 71.2 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01377 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.891 | L2-Norm(final)=3.172 | 1542.2 samples/s | 24.1 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01252 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.889 | L2-Norm(final)=3.173 | 3678.0 samples/s | 57.5 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01189 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.888 | L2-Norm(final)=3.174 | 3712.6 samples/s | 58.0 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01129 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.888 | L2-Norm(final)=3.174 | 4349.6 samples/s | 68.0 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01056 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.887 | L2-Norm(final)=3.175 | 1545.8 samples/s | 24.2 steps/s
[Step=15700 Epoch=76.6] | Loss=0.00986 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.886 | L2-Norm(final)=3.176 | 3684.9 samples/s | 57.6 steps/s
[Step=15750 Epoch=76.8] | Loss=0.00943 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.886 | L2-Norm(final)=3.177 | 3700.5 samples/s | 57.8 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00907 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.886 | L2-Norm(final)=3.178 | 4159.5 samples/s | 65.0 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00875 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.885 | L2-Norm(final)=3.178 | 1566.8 samples/s | 24.5 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00836 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.885 | L2-Norm(final)=3.179 | 3690.1 samples/s | 57.7 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00802 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.885 | L2-Norm(final)=3.180 | 3688.4 samples/s | 57.6 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00782 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.884 | L2-Norm(final)=3.181 | 3941.5 samples/s | 61.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step16000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=159.8] | Loss=0.04821 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.915 | L2-Norm(final)=3.171 | 3162.8 samples/s | 49.4 steps/s
[Step=16850 Epoch=160.3] | Loss=0.00571 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.880 | L2-Norm(final)=3.172 | 3565.3 samples/s | 55.7 steps/s
[Step=16900 Epoch=160.8] | Loss=0.00323 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.873 | L2-Norm(final)=3.173 | 4552.2 samples/s | 71.1 steps/s
[Step=16950 Epoch=161.2] | Loss=0.00219 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.868 | L2-Norm(final)=3.174 | 1463.3 samples/s | 22.9 steps/s
[Step=17000 Epoch=161.7] | Loss=0.00166 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.864 | L2-Norm(final)=3.174 | 4160.7 samples/s | 65.0 steps/s
[Step=17050 Epoch=162.2] | Loss=0.00135 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.862 | L2-Norm(final)=3.174 | 1513.6 samples/s | 23.6 steps/s
[Step=17100 Epoch=162.7] | Loss=0.00113 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.859 | L2-Norm(final)=3.175 | 3971.0 samples/s | 62.0 steps/s
[Step=17150 Epoch=163.1] | Loss=0.00098 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.857 | L2-Norm(final)=3.175 | 1531.0 samples/s | 23.9 steps/s
[Step=17200 Epoch=163.6] | Loss=0.00086 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.855 | L2-Norm(final)=3.175 | 3860.7 samples/s | 60.3 steps/s
[Step=17250 Epoch=164.1] | Loss=0.00077 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.853 | L2-Norm(final)=3.175 | 1589.4 samples/s | 24.8 steps/s
[Step=17300 Epoch=164.6] | Loss=0.00070 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.852 | L2-Norm(final)=3.175 | 3697.9 samples/s | 57.8 steps/s
[Step=17350 Epoch=165.0] | Loss=0.00064 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.850 | L2-Norm(final)=3.176 | 1627.8 samples/s | 25.4 steps/s
[Step=17400 Epoch=165.5] | Loss=0.00059 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.849 | L2-Norm(final)=3.176 | 3608.1 samples/s | 56.4 steps/s
[Step=17450 Epoch=166.0] | Loss=0.00055 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.848 | L2-Norm(final)=3.176 | 1626.3 samples/s | 25.4 steps/s
[Step=17500 Epoch=166.5] | Loss=0.00051 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.846 | L2-Norm(final)=3.176 | 3503.9 samples/s | 54.7 steps/s
[Step=17550 Epoch=166.9] | Loss=0.00048 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.845 | L2-Norm(final)=3.176 | 1625.1 samples/s | 25.4 steps/s
[Step=17600 Epoch=167.4] | Loss=0.00045 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.844 | L2-Norm(final)=3.176 | 3605.1 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step17600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=191.0] | Loss=0.09370 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.915 | L2-Norm(final)=3.171 | 3094.3 samples/s | 48.3 steps/s
[Step=20050 Epoch=191.5] | Loss=0.00717 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.884 | L2-Norm(final)=3.172 | 3589.2 samples/s | 56.1 steps/s
[Step=20100 Epoch=191.9] | Loss=0.00368 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.877 | L2-Norm(final)=3.172 | 4558.3 samples/s | 71.2 steps/s
[Step=20150 Epoch=192.4] | Loss=0.00249 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.873 | L2-Norm(final)=3.173 | 1488.8 samples/s | 23.3 steps/s
[Step=20200 Epoch=192.9] | Loss=0.00189 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.869 | L2-Norm(final)=3.173 | 4221.7 samples/s | 66.0 steps/s
[Step=20250 Epoch=193.4] | Loss=0.00153 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.866 | L2-Norm(final)=3.173 | 1501.8 samples/s | 23.5 steps/s
[Step=20300 Epoch=193.9] | Loss=0.00129 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.864 | L2-Norm(final)=3.173 | 4056.9 samples/s | 63.4 steps/s
[Step=20350 Epoch=194.3] | Loss=0.00111 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.862 | L2-Norm(final)=3.173 | 1533.5 samples/s | 24.0 steps/s
[Step=20400 Epoch=194.8] | Loss=0.00098 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.860 | L2-Norm(final)=3.174 | 3896.7 samples/s | 60.9 steps/s
[Step=20450 Epoch=195.3] | Loss=0.00088 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.858 | L2-Norm(final)=3.174 | 1554.2 samples/s | 24.3 steps/s
[Step=20500 Epoch=195.8] | Loss=0.00080 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.857 | L2-Norm(final)=3.174 | 3732.4 samples/s | 58.3 steps/s
[Step=20550 Epoch=196.2] | Loss=0.00073 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.855 | L2-Norm(final)=3.174 | 1567.0 samples/s | 24.5 steps/s
[Step=20600 Epoch=196.7] | Loss=0.00067 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.854 | L2-Norm(final)=3.174 | 3606.3 samples/s | 56.3 steps/s
[Step=20650 Epoch=197.2] | Loss=0.00063 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.853 | L2-Norm(final)=3.174 | 1603.8 samples/s | 25.1 steps/s
[Step=20700 Epoch=197.7] | Loss=0.00058 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.851 | L2-Norm(final)=3.175 | 3582.0 samples/s | 56.0 steps/s
[Step=20750 Epoch=198.1] | Loss=0.00055 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.850 | L2-Norm(final)=3.175 | 1633.0 samples/s | 25.5 steps/s
[Step=20800 Epoch=198.6] | Loss=0.00052 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.849 | L2-Norm(final)=3.175 | 3555.5 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step20800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20801 Epoch=198.3] | Loss=0.09140 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.915 | L2-Norm(final)=3.171 | 3155.6 samples/s | 49.3 steps/s
[Step=20850 Epoch=198.7] | Loss=0.00655 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.882 | L2-Norm(final)=3.172 | 3551.1 samples/s | 55.5 steps/s
[Step=20900 Epoch=199.2] | Loss=0.00337 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.875 | L2-Norm(final)=3.173 | 4529.8 samples/s | 70.8 steps/s
[Step=20950 Epoch=199.7] | Loss=0.00228 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.870 | L2-Norm(final)=3.173 | 1469.4 samples/s | 23.0 steps/s
[Step=21000 Epoch=200.1] | Loss=0.00173 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.867 | L2-Norm(final)=3.173 | 4262.4 samples/s | 66.6 steps/s
[Step=21050 Epoch=200.6] | Loss=0.00140 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.864 | L2-Norm(final)=3.174 | 1490.2 samples/s | 23.3 steps/s
[Step=21100 Epoch=201.1] | Loss=0.00117 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.861 | L2-Norm(final)=3.174 | 4030.4 samples/s | 63.0 steps/s
[Step=21150 Epoch=201.6] | Loss=0.00101 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.859 | L2-Norm(final)=3.174 | 1537.9 samples/s | 24.0 steps/s
[Step=21200 Epoch=202.1] | Loss=0.00089 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.857 | L2-Norm(final)=3.174 | 3907.9 samples/s | 61.1 steps/s
[Step=21250 Epoch=202.5] | Loss=0.00080 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.855 | L2-Norm(final)=3.174 | 1534.6 samples/s | 24.0 steps/s
[Step=21300 Epoch=203.0] | Loss=0.00072 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.854 | L2-Norm(final)=3.174 | 3768.8 samples/s | 58.9 steps/s
[Step=21350 Epoch=203.5] | Loss=0.00066 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.852 | L2-Norm(final)=3.175 | 1591.4 samples/s | 24.9 steps/s
[Step=21400 Epoch=204.0] | Loss=0.00061 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.851 | L2-Norm(final)=3.175 | 3621.9 samples/s | 56.6 steps/s
[Step=21450 Epoch=204.4] | Loss=0.00057 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.849 | L2-Norm(final)=3.175 | 1597.1 samples/s | 25.0 steps/s
[Step=21500 Epoch=204.9] | Loss=0.00053 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.848 | L2-Norm(final)=3.175 | 3520.5 samples/s | 55.0 steps/s
[Step=21550 Epoch=205.4] | Loss=0.00050 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.847 | L2-Norm(final)=3.175 | 1596.3 samples/s | 24.9 steps/s
[Step=21600 Epoch=205.9] | Loss=0.00047 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.846 | L2-Norm(final)=3.175 | 3614.0 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29324 | acc=0.8396 | tpr=0.7709 | fpr=0.0111 | 3698.9 samples/s | 14.4 steps/s
Avg test loss: 0.30274, Avg test acc: 0.83813, Avg tpr: 0.77024, Avg fpr: 0.01256, total FA: 98

Testing server on iccad2012
[Step=  50] | Loss=0.43625 | acc=0.8313 | tpr=0.9602 | fpr=0.1710 | 3702.0 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.44535 | acc=0.8308 | tpr=0.9723 | fpr=0.1718 | 7509.3 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.45154 | acc=0.8296 | tpr=0.9784 | fpr=0.1731 | 7330.7 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.45699 | acc=0.8277 | tpr=0.9792 | fpr=0.1751 | 7382.7 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.45646 | acc=0.8271 | tpr=0.9790 | fpr=0.1756 | 7558.7 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.45582 | acc=0.8269 | tpr=0.9818 | fpr=0.1759 | 7179.2 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.45809 | acc=0.8263 | tpr=0.9806 | fpr=0.1765 | 7735.5 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.46038 | acc=0.8263 | tpr=0.9776 | fpr=0.1765 | 7133.9 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.46073 | acc=0.8262 | tpr=0.9761 | fpr=0.1765 | 7289.0 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.46086 | acc=0.8258 | tpr=0.9749 | fpr=0.1769 | 7191.0 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.46006 | acc=0.8261 | tpr=0.9741 | fpr=0.1766 | 13749.7 samples/s | 53.7 steps/s
Avg test loss: 0.45955, Avg test acc: 0.82615, Avg tpr: 0.97385, Avg fpr: 0.17653, total FA: 24511

server round 45/50

clients selected: [1 2 5 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=12801 Epoch=62.5] | Loss=0.07752 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.890 | L2-Norm(final)=3.177 | 3443.9 samples/s | 53.8 steps/s
[Step=12850 Epoch=62.7] | Loss=0.02118 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.878 | L2-Norm(final)=3.177 | 3481.4 samples/s | 54.4 steps/s
[Step=12900 Epoch=62.9] | Loss=0.01659 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.872 | L2-Norm(final)=3.177 | 3685.3 samples/s | 57.6 steps/s
[Step=12950 Epoch=63.2] | Loss=0.01514 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.869 | L2-Norm(final)=3.178 | 3690.6 samples/s | 57.7 steps/s
[Step=13000 Epoch=63.4] | Loss=0.01373 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.867 | L2-Norm(final)=3.178 | 4607.5 samples/s | 72.0 steps/s
[Step=13050 Epoch=63.7] | Loss=0.01185 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.865 | L2-Norm(final)=3.179 | 1535.4 samples/s | 24.0 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01071 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.864 | L2-Norm(final)=3.180 | 3747.9 samples/s | 58.6 steps/s
[Step=13150 Epoch=64.2] | Loss=0.00994 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.864 | L2-Norm(final)=3.181 | 3776.3 samples/s | 59.0 steps/s
[Step=13200 Epoch=64.4] | Loss=0.00926 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.863 | L2-Norm(final)=3.182 | 4509.0 samples/s | 70.5 steps/s
[Step=13250 Epoch=64.7] | Loss=0.00867 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.862 | L2-Norm(final)=3.183 | 1541.1 samples/s | 24.1 steps/s
[Step=13300 Epoch=64.9] | Loss=0.00822 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.862 | L2-Norm(final)=3.184 | 3655.4 samples/s | 57.1 steps/s
[Step=13350 Epoch=65.1] | Loss=0.00795 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.862 | L2-Norm(final)=3.185 | 3654.1 samples/s | 57.1 steps/s
[Step=13400 Epoch=65.4] | Loss=0.00758 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.861 | L2-Norm(final)=3.186 | 4178.4 samples/s | 65.3 steps/s
[Step=13450 Epoch=65.6] | Loss=0.00730 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.861 | L2-Norm(final)=3.187 | 1553.8 samples/s | 24.3 steps/s
[Step=13500 Epoch=65.9] | Loss=0.00701 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.861 | L2-Norm(final)=3.188 | 3717.3 samples/s | 58.1 steps/s
[Step=13550 Epoch=66.1] | Loss=0.00686 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.861 | L2-Norm(final)=3.189 | 3785.6 samples/s | 59.1 steps/s
[Step=13600 Epoch=66.4] | Loss=0.00659 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.860 | L2-Norm(final)=3.189 | 4128.9 samples/s | 64.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step13600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=81.9] | Loss=0.26519 | Reg=0.00320 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=17.890 | L2-Norm(final)=3.177 | 3285.6 samples/s | 51.3 steps/s
[Step=16850 Epoch=82.1] | Loss=0.03245 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.879 | L2-Norm(final)=3.175 | 3601.5 samples/s | 56.3 steps/s
[Step=16900 Epoch=82.3] | Loss=0.02171 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.873 | L2-Norm(final)=3.175 | 3646.4 samples/s | 57.0 steps/s
[Step=16950 Epoch=82.6] | Loss=0.01713 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.870 | L2-Norm(final)=3.175 | 3664.0 samples/s | 57.2 steps/s
[Step=17000 Epoch=82.8] | Loss=0.01587 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.869 | L2-Norm(final)=3.176 | 4677.3 samples/s | 73.1 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01371 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.867 | L2-Norm(final)=3.177 | 1543.7 samples/s | 24.1 steps/s
[Step=17100 Epoch=83.3] | Loss=0.01228 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.866 | L2-Norm(final)=3.178 | 3789.5 samples/s | 59.2 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01139 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.865 | L2-Norm(final)=3.179 | 3772.8 samples/s | 58.9 steps/s
[Step=17200 Epoch=83.8] | Loss=0.01048 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.865 | L2-Norm(final)=3.180 | 4439.4 samples/s | 69.4 steps/s
[Step=17250 Epoch=84.1] | Loss=0.00986 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.864 | L2-Norm(final)=3.181 | 1573.0 samples/s | 24.6 steps/s
[Step=17300 Epoch=84.3] | Loss=0.00932 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.864 | L2-Norm(final)=3.182 | 3798.2 samples/s | 59.3 steps/s
[Step=17350 Epoch=84.5] | Loss=0.00884 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.864 | L2-Norm(final)=3.183 | 3774.7 samples/s | 59.0 steps/s
[Step=17400 Epoch=84.8] | Loss=0.00837 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.863 | L2-Norm(final)=3.184 | 4222.1 samples/s | 66.0 steps/s
[Step=17450 Epoch=85.0] | Loss=0.00803 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.863 | L2-Norm(final)=3.185 | 1598.7 samples/s | 25.0 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00770 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.863 | L2-Norm(final)=3.186 | 3767.1 samples/s | 58.9 steps/s
[Step=17550 Epoch=85.5] | Loss=0.00740 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.863 | L2-Norm(final)=3.187 | 3780.1 samples/s | 59.1 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00714 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.863 | L2-Norm(final)=3.188 | 4017.9 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step17600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=181.9] | Loss=0.14570 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.890 | L2-Norm(final)=3.177 | 3179.7 samples/s | 49.7 steps/s
[Step=19250 Epoch=182.4] | Loss=0.00818 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.859 | L2-Norm(final)=3.177 | 3396.2 samples/s | 53.1 steps/s
[Step=19300 Epoch=182.9] | Loss=0.00424 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.852 | L2-Norm(final)=3.178 | 4426.3 samples/s | 69.2 steps/s
[Step=19350 Epoch=183.4] | Loss=0.00287 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.848 | L2-Norm(final)=3.178 | 1486.4 samples/s | 23.2 steps/s
[Step=19400 Epoch=183.8] | Loss=0.00217 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.844 | L2-Norm(final)=3.179 | 4262.3 samples/s | 66.6 steps/s
[Step=19450 Epoch=184.3] | Loss=0.00175 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.842 | L2-Norm(final)=3.179 | 1520.5 samples/s | 23.8 steps/s
[Step=19500 Epoch=184.8] | Loss=0.00147 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.839 | L2-Norm(final)=3.179 | 3951.5 samples/s | 61.7 steps/s
[Step=19550 Epoch=185.3] | Loss=0.00127 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.837 | L2-Norm(final)=3.179 | 1542.3 samples/s | 24.1 steps/s
[Step=19600 Epoch=185.7] | Loss=0.00112 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.835 | L2-Norm(final)=3.179 | 3838.6 samples/s | 60.0 steps/s
[Step=19650 Epoch=186.2] | Loss=0.00100 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.834 | L2-Norm(final)=3.180 | 1582.2 samples/s | 24.7 steps/s
[Step=19700 Epoch=186.7] | Loss=0.00091 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.832 | L2-Norm(final)=3.180 | 3586.0 samples/s | 56.0 steps/s
[Step=19750 Epoch=187.1] | Loss=0.00083 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.830 | L2-Norm(final)=3.180 | 1609.9 samples/s | 25.2 steps/s
[Step=19800 Epoch=187.6] | Loss=0.00077 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.829 | L2-Norm(final)=3.180 | 3561.2 samples/s | 55.6 steps/s
[Step=19850 Epoch=188.1] | Loss=0.00071 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.180 | 1625.3 samples/s | 25.4 steps/s
[Step=19900 Epoch=188.6] | Loss=0.00066 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.826 | L2-Norm(final)=3.180 | 3534.7 samples/s | 55.2 steps/s
[Step=19950 Epoch=189.0] | Loss=0.00062 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.825 | L2-Norm(final)=3.181 | 1609.3 samples/s | 25.1 steps/s
[Step=20000 Epoch=189.5] | Loss=0.00059 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.824 | L2-Norm(final)=3.181 | 3584.5 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step20000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=24001 Epoch=226.2] | Loss=0.22947 | Reg=0.00320 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=17.890 | L2-Norm(final)=3.177 | 3120.6 samples/s | 48.8 steps/s
[Step=24050 Epoch=226.6] | Loss=0.01080 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.858 | L2-Norm(final)=3.177 | 3559.0 samples/s | 55.6 steps/s
[Step=24100 Epoch=227.1] | Loss=0.00571 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.851 | L2-Norm(final)=3.178 | 4481.2 samples/s | 70.0 steps/s
[Step=24150 Epoch=227.6] | Loss=0.00386 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.847 | L2-Norm(final)=3.178 | 1509.5 samples/s | 23.6 steps/s
[Step=24200 Epoch=228.0] | Loss=0.00291 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.844 | L2-Norm(final)=3.178 | 4183.4 samples/s | 65.4 steps/s
[Step=24250 Epoch=228.5] | Loss=0.00235 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.841 | L2-Norm(final)=3.179 | 1516.5 samples/s | 23.7 steps/s
[Step=24300 Epoch=229.0] | Loss=0.00197 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.839 | L2-Norm(final)=3.179 | 3870.8 samples/s | 60.5 steps/s
[Step=24350 Epoch=229.4] | Loss=0.00170 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.837 | L2-Norm(final)=3.179 | 1566.5 samples/s | 24.5 steps/s
[Step=24400 Epoch=229.9] | Loss=0.00149 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.835 | L2-Norm(final)=3.179 | 3708.0 samples/s | 57.9 steps/s
[Step=24450 Epoch=230.4] | Loss=0.00133 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.834 | L2-Norm(final)=3.179 | 1602.8 samples/s | 25.0 steps/s
[Step=24500 Epoch=230.9] | Loss=0.00121 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.832 | L2-Norm(final)=3.179 | 3555.3 samples/s | 55.6 steps/s
[Step=24550 Epoch=231.3] | Loss=0.00110 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.831 | L2-Norm(final)=3.179 | 1612.5 samples/s | 25.2 steps/s
[Step=24600 Epoch=231.8] | Loss=0.00101 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.830 | L2-Norm(final)=3.180 | 3567.7 samples/s | 55.7 steps/s
[Step=24650 Epoch=232.3] | Loss=0.00094 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.180 | 1621.4 samples/s | 25.3 steps/s
[Step=24700 Epoch=232.7] | Loss=0.00088 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.180 | 3565.2 samples/s | 55.7 steps/s
[Step=24750 Epoch=233.2] | Loss=0.00082 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.826 | L2-Norm(final)=3.180 | 1730.6 samples/s | 27.0 steps/s
[Step=24800 Epoch=233.7] | Loss=0.00077 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.825 | L2-Norm(final)=3.180 | 3322.6 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step24800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=21601 Epoch=205.9] | Loss=0.07277 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.890 | L2-Norm(final)=3.177 | 3204.5 samples/s | 50.1 steps/s
[Step=21650 Epoch=206.3] | Loss=0.00698 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.855 | L2-Norm(final)=3.177 | 3400.9 samples/s | 53.1 steps/s
[Step=21700 Epoch=206.8] | Loss=0.00370 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.847 | L2-Norm(final)=3.177 | 4458.1 samples/s | 69.7 steps/s
[Step=21750 Epoch=207.3] | Loss=0.00250 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.843 | L2-Norm(final)=3.178 | 1478.9 samples/s | 23.1 steps/s
[Step=21800 Epoch=207.8] | Loss=0.00189 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.839 | L2-Norm(final)=3.178 | 4348.7 samples/s | 67.9 steps/s
[Step=21850 Epoch=208.3] | Loss=0.00153 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.836 | L2-Norm(final)=3.178 | 1510.7 samples/s | 23.6 steps/s
[Step=21900 Epoch=208.7] | Loss=0.00128 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.834 | L2-Norm(final)=3.178 | 4037.2 samples/s | 63.1 steps/s
[Step=21950 Epoch=209.2] | Loss=0.00111 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.832 | L2-Norm(final)=3.179 | 1511.8 samples/s | 23.6 steps/s
[Step=22000 Epoch=209.7] | Loss=0.00098 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.830 | L2-Norm(final)=3.179 | 3938.9 samples/s | 61.5 steps/s
[Step=22050 Epoch=210.2] | Loss=0.00087 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.179 | 1555.9 samples/s | 24.3 steps/s
[Step=22100 Epoch=210.6] | Loss=0.00079 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.179 | 3711.4 samples/s | 58.0 steps/s
[Step=22150 Epoch=211.1] | Loss=0.00072 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.825 | L2-Norm(final)=3.179 | 1583.5 samples/s | 24.7 steps/s
[Step=22200 Epoch=211.6] | Loss=0.00067 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.824 | L2-Norm(final)=3.180 | 3678.9 samples/s | 57.5 steps/s
[Step=22250 Epoch=212.1] | Loss=0.00062 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.822 | L2-Norm(final)=3.180 | 1610.8 samples/s | 25.2 steps/s
[Step=22300 Epoch=212.5] | Loss=0.00058 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.821 | L2-Norm(final)=3.180 | 3608.4 samples/s | 56.4 steps/s
[Step=22350 Epoch=213.0] | Loss=0.00054 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.820 | L2-Norm(final)=3.180 | 1609.8 samples/s | 25.2 steps/s
[Step=22400 Epoch=213.5] | Loss=0.00051 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.819 | L2-Norm(final)=3.180 | 3525.5 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29872 | acc=0.8387 | tpr=0.7697 | fpr=0.0114 | 3714.3 samples/s | 14.5 steps/s
Avg test loss: 0.30782, Avg test acc: 0.83709, Avg tpr: 0.76884, Avg fpr: 0.01282, total FA: 100

Testing server on iccad2012
[Step=  50] | Loss=0.42814 | acc=0.8372 | tpr=0.9602 | fpr=0.1650 | 3756.7 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.43740 | acc=0.8363 | tpr=0.9723 | fpr=0.1663 | 7149.1 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.44349 | acc=0.8350 | tpr=0.9784 | fpr=0.1677 | 7455.2 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.44894 | acc=0.8329 | tpr=0.9792 | fpr=0.1697 | 7386.6 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.44832 | acc=0.8323 | tpr=0.9790 | fpr=0.1704 | 7471.9 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.44756 | acc=0.8319 | tpr=0.9818 | fpr=0.1708 | 7348.1 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.44984 | acc=0.8314 | tpr=0.9806 | fpr=0.1713 | 7326.4 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.45215 | acc=0.8313 | tpr=0.9776 | fpr=0.1713 | 7502.7 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.45243 | acc=0.8315 | tpr=0.9761 | fpr=0.1711 | 7308.7 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.45246 | acc=0.8312 | tpr=0.9749 | fpr=0.1714 | 7260.1 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.45164 | acc=0.8314 | tpr=0.9737 | fpr=0.1712 | 13760.5 samples/s | 53.8 steps/s
Avg test loss: 0.45113, Avg test acc: 0.83146, Avg tpr: 0.97345, Avg fpr: 0.17112, total FA: 23760

server round 46/50

clients selected: [0 1 2 5 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=14401 Epoch=70.2] | Loss=0.06912 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.855 | L2-Norm(final)=3.186 | 3226.2 samples/s | 50.4 steps/s
[Step=14450 Epoch=70.5] | Loss=0.02903 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.843 | L2-Norm(final)=3.185 | 3684.1 samples/s | 57.6 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02077 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.837 | L2-Norm(final)=3.185 | 3660.8 samples/s | 57.2 steps/s
[Step=14550 Epoch=70.9] | Loss=0.01763 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.834 | L2-Norm(final)=3.185 | 3686.3 samples/s | 57.6 steps/s
[Step=14600 Epoch=71.2] | Loss=0.01615 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.832 | L2-Norm(final)=3.186 | 4582.3 samples/s | 71.6 steps/s
[Step=14650 Epoch=71.4] | Loss=0.01391 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.831 | L2-Norm(final)=3.186 | 1537.2 samples/s | 24.0 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01269 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.830 | L2-Norm(final)=3.187 | 3687.8 samples/s | 57.6 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01165 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.829 | L2-Norm(final)=3.188 | 3692.7 samples/s | 57.7 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01091 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.189 | 4352.2 samples/s | 68.0 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01013 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.190 | 1560.4 samples/s | 24.4 steps/s
[Step=14900 Epoch=72.7] | Loss=0.00955 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.191 | 3725.0 samples/s | 58.2 steps/s
[Step=14950 Epoch=72.9] | Loss=0.00908 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.192 | 3780.9 samples/s | 59.1 steps/s
[Step=15000 Epoch=73.1] | Loss=0.00870 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.193 | 4240.1 samples/s | 66.3 steps/s
[Step=15050 Epoch=73.4] | Loss=0.00829 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.194 | 1593.9 samples/s | 24.9 steps/s
[Step=15100 Epoch=73.6] | Loss=0.00807 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.826 | L2-Norm(final)=3.195 | 3778.3 samples/s | 59.0 steps/s
[Step=15150 Epoch=73.9] | Loss=0.00778 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.826 | L2-Norm(final)=3.196 | 3788.6 samples/s | 59.2 steps/s
[Step=15200 Epoch=74.1] | Loss=0.00751 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.826 | L2-Norm(final)=3.197 | 4028.1 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step15200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=13601 Epoch=66.4] | Loss=0.15477 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.855 | L2-Norm(final)=3.186 | 3374.6 samples/s | 52.7 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03013 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.842 | L2-Norm(final)=3.184 | 3586.3 samples/s | 56.0 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02141 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.837 | L2-Norm(final)=3.184 | 3782.0 samples/s | 59.1 steps/s
[Step=13750 Epoch=67.1] | Loss=0.01755 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.833 | L2-Norm(final)=3.184 | 3766.4 samples/s | 58.9 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01506 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.831 | L2-Norm(final)=3.185 | 4708.8 samples/s | 73.6 steps/s
[Step=13850 Epoch=67.6] | Loss=0.01309 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.830 | L2-Norm(final)=3.186 | 1502.4 samples/s | 23.5 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01172 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.829 | L2-Norm(final)=3.187 | 3655.9 samples/s | 57.1 steps/s
[Step=13950 Epoch=68.1] | Loss=0.01063 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.188 | 3669.8 samples/s | 57.3 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01003 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.189 | 4376.5 samples/s | 68.4 steps/s
[Step=14050 Epoch=68.6] | Loss=0.00953 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.190 | 1527.9 samples/s | 23.9 steps/s
[Step=14100 Epoch=68.8] | Loss=0.00891 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.191 | 3656.3 samples/s | 57.1 steps/s
[Step=14150 Epoch=69.0] | Loss=0.00841 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.826 | L2-Norm(final)=3.192 | 3650.0 samples/s | 57.0 steps/s
[Step=14200 Epoch=69.3] | Loss=0.00804 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.826 | L2-Norm(final)=3.193 | 4174.2 samples/s | 65.2 steps/s
[Step=14250 Epoch=69.5] | Loss=0.00765 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.826 | L2-Norm(final)=3.194 | 1570.3 samples/s | 24.5 steps/s
[Step=14300 Epoch=69.8] | Loss=0.00734 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.825 | L2-Norm(final)=3.195 | 3767.9 samples/s | 58.9 steps/s
[Step=14350 Epoch=70.0] | Loss=0.00709 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.825 | L2-Norm(final)=3.196 | 3783.9 samples/s | 59.1 steps/s
[Step=14400 Epoch=70.3] | Loss=0.00692 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.825 | L2-Norm(final)=3.197 | 4140.8 samples/s | 64.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step14400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=85.8] | Loss=0.23382 | Reg=0.00319 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=17.855 | L2-Norm(final)=3.185 | 3225.9 samples/s | 50.4 steps/s
[Step=17650 Epoch=86.0] | Loss=0.03285 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.842 | L2-Norm(final)=3.184 | 3731.3 samples/s | 58.3 steps/s
[Step=17700 Epoch=86.2] | Loss=0.02296 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.837 | L2-Norm(final)=3.184 | 3788.2 samples/s | 59.2 steps/s
[Step=17750 Epoch=86.5] | Loss=0.01857 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.834 | L2-Norm(final)=3.184 | 3782.8 samples/s | 59.1 steps/s
[Step=17800 Epoch=86.7] | Loss=0.01577 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.832 | L2-Norm(final)=3.185 | 4704.9 samples/s | 73.5 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01349 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.831 | L2-Norm(final)=3.186 | 1530.3 samples/s | 23.9 steps/s
[Step=17900 Epoch=87.2] | Loss=0.01216 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.830 | L2-Norm(final)=3.187 | 3698.5 samples/s | 57.8 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01115 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.830 | L2-Norm(final)=3.187 | 3679.9 samples/s | 57.5 steps/s
[Step=18000 Epoch=87.7] | Loss=0.01041 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.829 | L2-Norm(final)=3.188 | 4302.7 samples/s | 67.2 steps/s
[Step=18050 Epoch=87.9] | Loss=0.00978 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.829 | L2-Norm(final)=3.189 | 1563.3 samples/s | 24.4 steps/s
[Step=18100 Epoch=88.2] | Loss=0.00914 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.190 | 3692.6 samples/s | 57.7 steps/s
[Step=18150 Epoch=88.4] | Loss=0.00871 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.192 | 3704.8 samples/s | 57.9 steps/s
[Step=18200 Epoch=88.7] | Loss=0.00832 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.193 | 4094.1 samples/s | 64.0 steps/s
[Step=18250 Epoch=88.9] | Loss=0.00795 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.194 | 1587.6 samples/s | 24.8 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00769 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.195 | 3694.3 samples/s | 57.7 steps/s
[Step=18350 Epoch=89.4] | Loss=0.00739 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.196 | 3695.8 samples/s | 57.7 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00712 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.197 | 3937.6 samples/s | 61.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step18400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=189.5] | Loss=0.03645 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.855 | L2-Norm(final)=3.186 | 3079.6 samples/s | 48.1 steps/s
[Step=20050 Epoch=190.0] | Loss=0.00713 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.822 | L2-Norm(final)=3.186 | 3586.6 samples/s | 56.0 steps/s
[Step=20100 Epoch=190.5] | Loss=0.00376 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.814 | L2-Norm(final)=3.187 | 4533.6 samples/s | 70.8 steps/s
[Step=20150 Epoch=190.9] | Loss=0.00254 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.810 | L2-Norm(final)=3.187 | 1471.5 samples/s | 23.0 steps/s
[Step=20200 Epoch=191.4] | Loss=0.00193 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.806 | L2-Norm(final)=3.188 | 4132.4 samples/s | 64.6 steps/s
[Step=20250 Epoch=191.9] | Loss=0.00157 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.804 | L2-Norm(final)=3.188 | 1495.9 samples/s | 23.4 steps/s
[Step=20300 Epoch=192.4] | Loss=0.00132 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.801 | L2-Norm(final)=3.188 | 3954.1 samples/s | 61.8 steps/s
[Step=20350 Epoch=192.8] | Loss=0.00114 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.799 | L2-Norm(final)=3.188 | 1547.1 samples/s | 24.2 steps/s
[Step=20400 Epoch=193.3] | Loss=0.00100 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.797 | L2-Norm(final)=3.189 | 3848.7 samples/s | 60.1 steps/s
[Step=20450 Epoch=193.8] | Loss=0.00090 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=3.189 | 1589.5 samples/s | 24.8 steps/s
[Step=20500 Epoch=194.3] | Loss=0.00081 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.794 | L2-Norm(final)=3.189 | 3657.8 samples/s | 57.2 steps/s
[Step=20550 Epoch=194.7] | Loss=0.00075 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=3.189 | 1594.0 samples/s | 24.9 steps/s
[Step=20600 Epoch=195.2] | Loss=0.00069 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.791 | L2-Norm(final)=3.189 | 3529.6 samples/s | 55.2 steps/s
[Step=20650 Epoch=195.7] | Loss=0.00064 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.790 | L2-Norm(final)=3.189 | 1620.0 samples/s | 25.3 steps/s
[Step=20700 Epoch=196.2] | Loss=0.00060 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.789 | L2-Norm(final)=3.190 | 3607.3 samples/s | 56.4 steps/s
[Step=20750 Epoch=196.6] | Loss=0.00056 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.190 | 1630.1 samples/s | 25.5 steps/s
[Step=20800 Epoch=197.1] | Loss=0.00053 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.786 | L2-Norm(final)=3.190 | 3618.8 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step20800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=22401 Epoch=213.5] | Loss=0.05758 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.855 | L2-Norm(final)=3.186 | 3209.5 samples/s | 50.1 steps/s
[Step=22450 Epoch=214.0] | Loss=0.00936 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.823 | L2-Norm(final)=3.185 | 3419.2 samples/s | 53.4 steps/s
[Step=22500 Epoch=214.4] | Loss=0.00485 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.816 | L2-Norm(final)=3.185 | 4456.5 samples/s | 69.6 steps/s
[Step=22550 Epoch=214.9] | Loss=0.00328 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.811 | L2-Norm(final)=3.186 | 1486.7 samples/s | 23.2 steps/s
[Step=22600 Epoch=215.4] | Loss=0.00248 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.808 | L2-Norm(final)=3.186 | 4346.5 samples/s | 67.9 steps/s
[Step=22650 Epoch=215.9] | Loss=0.00199 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.805 | L2-Norm(final)=3.186 | 1509.6 samples/s | 23.6 steps/s
[Step=22700 Epoch=216.4] | Loss=0.00167 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.802 | L2-Norm(final)=3.186 | 4125.7 samples/s | 64.5 steps/s
[Step=22750 Epoch=216.8] | Loss=0.00144 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.800 | L2-Norm(final)=3.187 | 1513.9 samples/s | 23.7 steps/s
[Step=22800 Epoch=217.3] | Loss=0.00126 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.798 | L2-Norm(final)=3.187 | 3880.8 samples/s | 60.6 steps/s
[Step=22850 Epoch=217.8] | Loss=0.00113 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=3.187 | 1530.2 samples/s | 23.9 steps/s
[Step=22900 Epoch=218.3] | Loss=0.00102 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.795 | L2-Norm(final)=3.187 | 3810.7 samples/s | 59.5 steps/s
[Step=22950 Epoch=218.7] | Loss=0.00093 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=3.187 | 1587.8 samples/s | 24.8 steps/s
[Step=23000 Epoch=219.2] | Loss=0.00086 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.792 | L2-Norm(final)=3.187 | 3554.6 samples/s | 55.5 steps/s
[Step=23050 Epoch=219.7] | Loss=0.00079 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.790 | L2-Norm(final)=3.187 | 1614.5 samples/s | 25.2 steps/s
[Step=23100 Epoch=220.2] | Loss=0.00074 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.789 | L2-Norm(final)=3.188 | 3633.2 samples/s | 56.8 steps/s
[Step=23150 Epoch=220.6] | Loss=0.00069 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.188 | 1590.0 samples/s | 24.8 steps/s
[Step=23200 Epoch=221.1] | Loss=0.00065 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.787 | L2-Norm(final)=3.188 | 3578.9 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29442 | acc=0.8409 | tpr=0.7727 | fpr=0.0111 | 3740.9 samples/s | 14.6 steps/s
Avg test loss: 0.30340, Avg test acc: 0.83913, Avg tpr: 0.77181, Avg fpr: 0.01282, total FA: 100

Testing server on iccad2012
[Step=  50] | Loss=0.42938 | acc=0.8378 | tpr=0.9558 | fpr=0.1643 | 3745.5 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.43895 | acc=0.8369 | tpr=0.9701 | fpr=0.1656 | 7349.8 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.44512 | acc=0.8359 | tpr=0.9769 | fpr=0.1667 | 7335.3 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.45060 | acc=0.8339 | tpr=0.9781 | fpr=0.1687 | 7566.3 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.44988 | acc=0.8334 | tpr=0.9790 | fpr=0.1692 | 7309.1 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.44914 | acc=0.8332 | tpr=0.9811 | fpr=0.1695 | 7236.2 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.45146 | acc=0.8324 | tpr=0.9800 | fpr=0.1703 | 7319.8 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.45386 | acc=0.8322 | tpr=0.9770 | fpr=0.1704 | 7811.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.45424 | acc=0.8323 | tpr=0.9761 | fpr=0.1703 | 7051.1 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.45422 | acc=0.8320 | tpr=0.9749 | fpr=0.1706 | 4659.0 samples/s | 18.2 steps/s
[Step= 550] | Loss=0.45338 | acc=0.8322 | tpr=0.9737 | fpr=0.1704 | 13005.5 samples/s | 50.8 steps/s
Avg test loss: 0.45285, Avg test acc: 0.83224, Avg tpr: 0.97345, Avg fpr: 0.17033, total FA: 23650

server round 47/50

clients selected: [1 2 3 5 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=14401 Epoch=70.3] | Loss=0.08106 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.823 | L2-Norm(final)=3.194 | 3210.2 samples/s | 50.2 steps/s
[Step=14450 Epoch=70.5] | Loss=0.02778 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.810 | L2-Norm(final)=3.193 | 3756.5 samples/s | 58.7 steps/s
[Step=14500 Epoch=70.8] | Loss=0.01929 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.804 | L2-Norm(final)=3.193 | 3788.9 samples/s | 59.2 steps/s
[Step=14550 Epoch=71.0] | Loss=0.01641 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.801 | L2-Norm(final)=3.193 | 3774.2 samples/s | 59.0 steps/s
[Step=14600 Epoch=71.2] | Loss=0.01461 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.799 | L2-Norm(final)=3.194 | 4708.3 samples/s | 73.6 steps/s
[Step=14650 Epoch=71.5] | Loss=0.01254 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.798 | L2-Norm(final)=3.195 | 1520.9 samples/s | 23.8 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01118 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.797 | L2-Norm(final)=3.196 | 3678.3 samples/s | 57.5 steps/s
[Step=14750 Epoch=72.0] | Loss=0.01034 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.796 | L2-Norm(final)=3.197 | 3675.2 samples/s | 57.4 steps/s
[Step=14800 Epoch=72.2] | Loss=0.00971 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.795 | L2-Norm(final)=3.198 | 4383.9 samples/s | 68.5 steps/s
[Step=14850 Epoch=72.5] | Loss=0.00906 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.795 | L2-Norm(final)=3.199 | 1536.0 samples/s | 24.0 steps/s
[Step=14900 Epoch=72.7] | Loss=0.00857 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.795 | L2-Norm(final)=3.200 | 3701.3 samples/s | 57.8 steps/s
[Step=14950 Epoch=72.9] | Loss=0.00812 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.794 | L2-Norm(final)=3.201 | 3679.6 samples/s | 57.5 steps/s
[Step=15000 Epoch=73.2] | Loss=0.00777 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.794 | L2-Norm(final)=3.202 | 4173.4 samples/s | 65.2 steps/s
[Step=15050 Epoch=73.4] | Loss=0.00734 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=3.203 | 1583.6 samples/s | 24.7 steps/s
[Step=15100 Epoch=73.7] | Loss=0.00705 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=3.204 | 3786.6 samples/s | 59.2 steps/s
[Step=15150 Epoch=73.9] | Loss=0.00682 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=3.205 | 3762.4 samples/s | 58.8 steps/s
[Step=15200 Epoch=74.2] | Loss=0.00661 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=3.206 | 4139.3 samples/s | 64.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step15200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=89.7] | Loss=0.15285 | Reg=0.00318 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=17.823 | L2-Norm(final)=3.194 | 3386.3 samples/s | 52.9 steps/s
[Step=18450 Epoch=89.9] | Loss=0.03896 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.812 | L2-Norm(final)=3.192 | 3535.6 samples/s | 55.2 steps/s
[Step=18500 Epoch=90.1] | Loss=0.02475 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.807 | L2-Norm(final)=3.192 | 3782.7 samples/s | 59.1 steps/s
[Step=18550 Epoch=90.4] | Loss=0.02017 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.804 | L2-Norm(final)=3.192 | 3778.5 samples/s | 59.0 steps/s
[Step=18600 Epoch=90.6] | Loss=0.01752 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.802 | L2-Norm(final)=3.193 | 4674.9 samples/s | 73.0 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01482 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.801 | L2-Norm(final)=3.193 | 1551.4 samples/s | 24.2 steps/s
[Step=18700 Epoch=91.1] | Loss=0.01327 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.800 | L2-Norm(final)=3.194 | 3769.1 samples/s | 58.9 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01206 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.799 | L2-Norm(final)=3.195 | 3763.3 samples/s | 58.8 steps/s
[Step=18800 Epoch=91.6] | Loss=0.01122 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.798 | L2-Norm(final)=3.196 | 4447.1 samples/s | 69.5 steps/s
[Step=18850 Epoch=91.8] | Loss=0.01049 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.798 | L2-Norm(final)=3.197 | 1561.0 samples/s | 24.4 steps/s
[Step=18900 Epoch=92.1] | Loss=0.00981 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.797 | L2-Norm(final)=3.198 | 3761.7 samples/s | 58.8 steps/s
[Step=18950 Epoch=92.3] | Loss=0.00926 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.797 | L2-Norm(final)=3.199 | 3785.3 samples/s | 59.1 steps/s
[Step=19000 Epoch=92.6] | Loss=0.00884 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.797 | L2-Norm(final)=3.199 | 4223.5 samples/s | 66.0 steps/s
[Step=19050 Epoch=92.8] | Loss=0.00843 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.797 | L2-Norm(final)=3.200 | 1604.8 samples/s | 25.1 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00806 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=3.201 | 3768.7 samples/s | 58.9 steps/s
[Step=19150 Epoch=93.3] | Loss=0.00779 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=3.202 | 3770.8 samples/s | 58.9 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00752 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=3.203 | 4021.8 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step19200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=78.0] | Loss=0.15194 | Reg=0.00318 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=17.823 | L2-Norm(final)=3.194 | 3238.6 samples/s | 50.6 steps/s
[Step=16050 Epoch=78.3] | Loss=0.02770 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.811 | L2-Norm(final)=3.193 | 3764.9 samples/s | 58.8 steps/s
[Step=16100 Epoch=78.5] | Loss=0.01905 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.806 | L2-Norm(final)=3.193 | 3781.1 samples/s | 59.1 steps/s
[Step=16150 Epoch=78.8] | Loss=0.01641 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.803 | L2-Norm(final)=3.194 | 3779.2 samples/s | 59.1 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01441 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.801 | L2-Norm(final)=3.194 | 4702.9 samples/s | 73.5 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01250 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.800 | L2-Norm(final)=3.195 | 1532.8 samples/s | 23.9 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01136 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.799 | L2-Norm(final)=3.196 | 3695.1 samples/s | 57.7 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01033 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.798 | L2-Norm(final)=3.197 | 3689.9 samples/s | 57.7 steps/s
[Step=16400 Epoch=80.0] | Loss=0.00959 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.797 | L2-Norm(final)=3.198 | 4353.9 samples/s | 68.0 steps/s
[Step=16450 Epoch=80.2] | Loss=0.00894 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.797 | L2-Norm(final)=3.199 | 1546.6 samples/s | 24.2 steps/s
[Step=16500 Epoch=80.5] | Loss=0.00852 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=3.200 | 3667.5 samples/s | 57.3 steps/s
[Step=16550 Epoch=80.7] | Loss=0.00814 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.796 | L2-Norm(final)=3.201 | 3647.9 samples/s | 57.0 steps/s
[Step=16600 Epoch=81.0] | Loss=0.00770 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=3.202 | 4092.9 samples/s | 64.0 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00733 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.795 | L2-Norm(final)=3.202 | 1568.3 samples/s | 24.5 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00711 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.795 | L2-Norm(final)=3.203 | 3651.5 samples/s | 57.1 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00693 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.795 | L2-Norm(final)=3.204 | 3630.3 samples/s | 56.7 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00668 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.795 | L2-Norm(final)=3.205 | 3914.2 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step16800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20801 Epoch=197.1] | Loss=0.07556 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.823 | L2-Norm(final)=3.194 | 3353.9 samples/s | 52.4 steps/s
[Step=20850 Epoch=197.6] | Loss=0.00815 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.791 | L2-Norm(final)=3.194 | 3177.8 samples/s | 49.7 steps/s
[Step=20900 Epoch=198.0] | Loss=0.00424 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.784 | L2-Norm(final)=3.195 | 4428.5 samples/s | 69.2 steps/s
[Step=20950 Epoch=198.5] | Loss=0.00287 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.779 | L2-Norm(final)=3.195 | 1477.2 samples/s | 23.1 steps/s
[Step=21000 Epoch=199.0] | Loss=0.00218 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.776 | L2-Norm(final)=3.196 | 4177.8 samples/s | 65.3 steps/s
[Step=21050 Epoch=199.5] | Loss=0.00176 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.773 | L2-Norm(final)=3.196 | 1523.3 samples/s | 23.8 steps/s
[Step=21100 Epoch=199.9] | Loss=0.00148 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.771 | L2-Norm(final)=3.196 | 4009.1 samples/s | 62.6 steps/s
[Step=21150 Epoch=200.4] | Loss=0.00128 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.769 | L2-Norm(final)=3.196 | 1536.1 samples/s | 24.0 steps/s
[Step=21200 Epoch=200.9] | Loss=0.00113 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.767 | L2-Norm(final)=3.197 | 3829.1 samples/s | 59.8 steps/s
[Step=21250 Epoch=201.4] | Loss=0.00101 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.765 | L2-Norm(final)=3.197 | 1592.1 samples/s | 24.9 steps/s
[Step=21300 Epoch=201.8] | Loss=0.00091 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.764 | L2-Norm(final)=3.197 | 3654.7 samples/s | 57.1 steps/s
[Step=21350 Epoch=202.3] | Loss=0.00084 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.762 | L2-Norm(final)=3.197 | 1590.6 samples/s | 24.9 steps/s
[Step=21400 Epoch=202.8] | Loss=0.00077 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.761 | L2-Norm(final)=3.197 | 3517.3 samples/s | 55.0 steps/s
[Step=21450 Epoch=203.3] | Loss=0.00071 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.760 | L2-Norm(final)=3.198 | 1608.5 samples/s | 25.1 steps/s
[Step=21500 Epoch=203.7] | Loss=0.00067 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.759 | L2-Norm(final)=3.198 | 3592.0 samples/s | 56.1 steps/s
[Step=21550 Epoch=204.2] | Loss=0.00063 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.757 | L2-Norm(final)=3.198 | 1616.9 samples/s | 25.3 steps/s
[Step=21600 Epoch=204.7] | Loss=0.00059 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.756 | L2-Norm(final)=3.198 | 3566.4 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step21600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=24801 Epoch=233.7] | Loss=0.07143 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.823 | L2-Norm(final)=3.194 | 3177.7 samples/s | 49.7 steps/s
[Step=24850 Epoch=234.2] | Loss=0.00876 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.794 | L2-Norm(final)=3.195 | 3471.5 samples/s | 54.2 steps/s
[Step=24900 Epoch=234.6] | Loss=0.00448 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.787 | L2-Norm(final)=3.195 | 4525.4 samples/s | 70.7 steps/s
[Step=24950 Epoch=235.1] | Loss=0.00302 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.783 | L2-Norm(final)=3.196 | 1504.7 samples/s | 23.5 steps/s
[Step=25000 Epoch=235.6] | Loss=0.00229 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.780 | L2-Norm(final)=3.196 | 4191.3 samples/s | 65.5 steps/s
[Step=25050 Epoch=236.0] | Loss=0.00185 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.777 | L2-Norm(final)=3.196 | 1520.5 samples/s | 23.8 steps/s
[Step=25100 Epoch=236.5] | Loss=0.00156 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.775 | L2-Norm(final)=3.196 | 3836.2 samples/s | 59.9 steps/s
[Step=25150 Epoch=237.0] | Loss=0.00135 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.773 | L2-Norm(final)=3.196 | 1567.1 samples/s | 24.5 steps/s
[Step=25200 Epoch=237.5] | Loss=0.00119 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.771 | L2-Norm(final)=3.197 | 3734.4 samples/s | 58.4 steps/s
[Step=25250 Epoch=237.9] | Loss=0.00106 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.769 | L2-Norm(final)=3.197 | 1604.8 samples/s | 25.1 steps/s
[Step=25300 Epoch=238.4] | Loss=0.00096 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.768 | L2-Norm(final)=3.197 | 3534.3 samples/s | 55.2 steps/s
[Step=25350 Epoch=238.9] | Loss=0.00088 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.767 | L2-Norm(final)=3.197 | 1623.0 samples/s | 25.4 steps/s
[Step=25400 Epoch=239.3] | Loss=0.00081 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.765 | L2-Norm(final)=3.197 | 3628.8 samples/s | 56.7 steps/s
[Step=25450 Epoch=239.8] | Loss=0.00075 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.764 | L2-Norm(final)=3.197 | 1641.7 samples/s | 25.7 steps/s
[Step=25500 Epoch=240.3] | Loss=0.00070 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.763 | L2-Norm(final)=3.197 | 3574.8 samples/s | 55.9 steps/s
[Step=25550 Epoch=240.8] | Loss=0.00066 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.762 | L2-Norm(final)=3.198 | 1685.4 samples/s | 26.3 steps/s
[Step=25600 Epoch=241.2] | Loss=0.00062 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.761 | L2-Norm(final)=3.198 | 3345.4 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30256 | acc=0.8392 | tpr=0.7700 | fpr=0.0104 | 2884.6 samples/s | 11.3 steps/s
Avg test loss: 0.31163, Avg test acc: 0.83697, Avg tpr: 0.76826, Avg fpr: 0.01192, total FA: 93

Testing server on iccad2012
[Step=  50] | Loss=0.43347 | acc=0.8373 | tpr=0.9602 | fpr=0.1649 | 2907.1 samples/s | 11.4 steps/s
[Step= 100] | Loss=0.44271 | acc=0.8365 | tpr=0.9701 | fpr=0.1660 | 7618.5 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.44875 | acc=0.8352 | tpr=0.9755 | fpr=0.1674 | 7267.0 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.45424 | acc=0.8332 | tpr=0.9770 | fpr=0.1695 | 7793.0 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.45366 | acc=0.8326 | tpr=0.9773 | fpr=0.1701 | 7095.9 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.45285 | acc=0.8324 | tpr=0.9796 | fpr=0.1703 | 7175.4 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.45512 | acc=0.8318 | tpr=0.9787 | fpr=0.1709 | 7732.2 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.45751 | acc=0.8317 | tpr=0.9759 | fpr=0.1709 | 7196.2 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.45787 | acc=0.8318 | tpr=0.9752 | fpr=0.1708 | 7281.7 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.45783 | acc=0.8315 | tpr=0.9740 | fpr=0.1710 | 7282.8 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.45698 | acc=0.8317 | tpr=0.9729 | fpr=0.1709 | 13619.3 samples/s | 53.2 steps/s
Avg test loss: 0.45646, Avg test acc: 0.83176, Avg tpr: 0.97266, Avg fpr: 0.17080, total FA: 23715

server round 48/50

clients selected: [0 1 2 5 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=74.1] | Loss=0.12284 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.798 | L2-Norm(final)=3.201 | 2942.5 samples/s | 46.0 steps/s
[Step=15250 Epoch=74.4] | Loss=0.03806 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.786 | L2-Norm(final)=3.198 | 2133.6 samples/s | 33.3 steps/s
[Step=15300 Epoch=74.6] | Loss=0.02574 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.781 | L2-Norm(final)=3.197 | 3533.5 samples/s | 55.2 steps/s
[Step=15350 Epoch=74.8] | Loss=0.01995 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.778 | L2-Norm(final)=3.197 | 3782.1 samples/s | 59.1 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01750 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.776 | L2-Norm(final)=3.198 | 4676.7 samples/s | 73.1 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01510 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.775 | L2-Norm(final)=3.198 | 1525.0 samples/s | 23.8 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01369 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.773 | L2-Norm(final)=3.199 | 3695.8 samples/s | 57.7 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01266 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.772 | L2-Norm(final)=3.200 | 3699.0 samples/s | 57.8 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01154 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.772 | L2-Norm(final)=3.201 | 4358.7 samples/s | 68.1 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01077 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.771 | L2-Norm(final)=3.202 | 1562.7 samples/s | 24.4 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01018 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.771 | L2-Norm(final)=3.202 | 3791.1 samples/s | 59.2 steps/s
[Step=15750 Epoch=76.8] | Loss=0.00959 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.770 | L2-Norm(final)=3.203 | 3783.4 samples/s | 59.1 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00911 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.770 | L2-Norm(final)=3.204 | 4157.7 samples/s | 65.0 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00871 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.770 | L2-Norm(final)=3.205 | 1573.2 samples/s | 24.6 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00834 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.770 | L2-Norm(final)=3.206 | 3747.9 samples/s | 58.6 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00799 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.769 | L2-Norm(final)=3.207 | 3686.6 samples/s | 57.6 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00780 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.769 | L2-Norm(final)=3.208 | 3955.1 samples/s | 61.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=74.2] | Loss=0.08627 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.798 | L2-Norm(final)=3.201 | 3289.3 samples/s | 51.4 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02730 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.784 | L2-Norm(final)=3.200 | 3675.7 samples/s | 57.4 steps/s
[Step=15300 Epoch=74.7] | Loss=0.01899 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.779 | L2-Norm(final)=3.200 | 3780.5 samples/s | 59.1 steps/s
[Step=15350 Epoch=74.9] | Loss=0.01628 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.776 | L2-Norm(final)=3.200 | 3787.6 samples/s | 59.2 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01404 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.774 | L2-Norm(final)=3.201 | 4721.1 samples/s | 73.8 steps/s
[Step=15450 Epoch=75.4] | Loss=0.01217 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.773 | L2-Norm(final)=3.201 | 1508.7 samples/s | 23.6 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01099 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.772 | L2-Norm(final)=3.202 | 3700.0 samples/s | 57.8 steps/s
[Step=15550 Epoch=75.9] | Loss=0.01006 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.771 | L2-Norm(final)=3.203 | 3681.2 samples/s | 57.5 steps/s
[Step=15600 Epoch=76.1] | Loss=0.00931 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.770 | L2-Norm(final)=3.204 | 4388.3 samples/s | 68.6 steps/s
[Step=15650 Epoch=76.4] | Loss=0.00874 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.770 | L2-Norm(final)=3.205 | 1545.3 samples/s | 24.1 steps/s
[Step=15700 Epoch=76.6] | Loss=0.00823 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.769 | L2-Norm(final)=3.206 | 3782.3 samples/s | 59.1 steps/s
[Step=15750 Epoch=76.9] | Loss=0.00782 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.769 | L2-Norm(final)=3.207 | 3783.9 samples/s | 59.1 steps/s
[Step=15800 Epoch=77.1] | Loss=0.00745 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.769 | L2-Norm(final)=3.209 | 4296.0 samples/s | 67.1 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00715 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.769 | L2-Norm(final)=3.210 | 1586.2 samples/s | 24.8 steps/s
[Step=15900 Epoch=77.6] | Loss=0.00687 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.768 | L2-Norm(final)=3.211 | 3762.9 samples/s | 58.8 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00669 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.768 | L2-Norm(final)=3.212 | 3789.3 samples/s | 59.2 steps/s
[Step=16000 Epoch=78.1] | Loss=0.00649 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.768 | L2-Norm(final)=3.213 | 4151.0 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step16000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=93.6] | Loss=0.18564 | Reg=0.00317 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=17.798 | L2-Norm(final)=3.201 | 3307.7 samples/s | 51.7 steps/s
[Step=19250 Epoch=93.8] | Loss=0.03463 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.787 | L2-Norm(final)=3.200 | 3530.2 samples/s | 55.2 steps/s
[Step=19300 Epoch=94.0] | Loss=0.02260 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.782 | L2-Norm(final)=3.199 | 3687.7 samples/s | 57.6 steps/s
[Step=19350 Epoch=94.3] | Loss=0.01806 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.780 | L2-Norm(final)=3.200 | 3728.1 samples/s | 58.3 steps/s
[Step=19400 Epoch=94.5] | Loss=0.01578 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.778 | L2-Norm(final)=3.200 | 4680.0 samples/s | 73.1 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01380 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.777 | L2-Norm(final)=3.201 | 1545.9 samples/s | 24.2 steps/s
[Step=19500 Epoch=95.0] | Loss=0.01247 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.776 | L2-Norm(final)=3.202 | 3704.4 samples/s | 57.9 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01130 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.775 | L2-Norm(final)=3.203 | 3682.1 samples/s | 57.5 steps/s
[Step=19600 Epoch=95.5] | Loss=0.01049 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.775 | L2-Norm(final)=3.204 | 4295.1 samples/s | 67.1 steps/s
[Step=19650 Epoch=95.7] | Loss=0.00976 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.774 | L2-Norm(final)=3.205 | 1570.2 samples/s | 24.5 steps/s
[Step=19700 Epoch=96.0] | Loss=0.00915 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.774 | L2-Norm(final)=3.206 | 3777.5 samples/s | 59.0 steps/s
[Step=19750 Epoch=96.2] | Loss=0.00865 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.774 | L2-Norm(final)=3.207 | 3784.1 samples/s | 59.1 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00831 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.773 | L2-Norm(final)=3.208 | 4233.2 samples/s | 66.1 steps/s
[Step=19850 Epoch=96.7] | Loss=0.00784 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.773 | L2-Norm(final)=3.209 | 1578.0 samples/s | 24.7 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00757 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.773 | L2-Norm(final)=3.210 | 3704.3 samples/s | 57.9 steps/s
[Step=19950 Epoch=97.2] | Loss=0.00730 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.773 | L2-Norm(final)=3.210 | 3714.6 samples/s | 58.0 steps/s
[Step=20000 Epoch=97.4] | Loss=0.00704 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.773 | L2-Norm(final)=3.211 | 3972.2 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_2/client_state-step20000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=21601 Epoch=204.7] | Loss=0.09111 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.798 | L2-Norm(final)=3.201 | 3189.8 samples/s | 49.8 steps/s
[Step=21650 Epoch=205.2] | Loss=0.00866 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.766 | L2-Norm(final)=3.201 | 3406.3 samples/s | 53.2 steps/s
[Step=21700 Epoch=205.6] | Loss=0.00454 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.759 | L2-Norm(final)=3.201 | 4407.3 samples/s | 68.9 steps/s
[Step=21750 Epoch=206.1] | Loss=0.00307 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.755 | L2-Norm(final)=3.202 | 1467.2 samples/s | 22.9 steps/s
[Step=21800 Epoch=206.6] | Loss=0.00233 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.751 | L2-Norm(final)=3.202 | 4135.2 samples/s | 64.6 steps/s
[Step=21850 Epoch=207.0] | Loss=0.00188 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.749 | L2-Norm(final)=3.202 | 1514.1 samples/s | 23.7 steps/s
[Step=21900 Epoch=207.5] | Loss=0.00158 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.746 | L2-Norm(final)=3.202 | 4032.0 samples/s | 63.0 steps/s
[Step=21950 Epoch=208.0] | Loss=0.00136 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.744 | L2-Norm(final)=3.203 | 1546.4 samples/s | 24.2 steps/s
[Step=22000 Epoch=208.5] | Loss=0.00120 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.743 | L2-Norm(final)=3.203 | 3828.3 samples/s | 59.8 steps/s
[Step=22050 Epoch=208.9] | Loss=0.00108 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.741 | L2-Norm(final)=3.203 | 1573.7 samples/s | 24.6 steps/s
[Step=22100 Epoch=209.4] | Loss=0.00097 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.739 | L2-Norm(final)=3.203 | 3584.2 samples/s | 56.0 steps/s
[Step=22150 Epoch=209.9] | Loss=0.00089 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.738 | L2-Norm(final)=3.204 | 1605.4 samples/s | 25.1 steps/s
[Step=22200 Epoch=210.4] | Loss=0.00082 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.737 | L2-Norm(final)=3.204 | 3619.4 samples/s | 56.6 steps/s
[Step=22250 Epoch=210.8] | Loss=0.00076 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.735 | L2-Norm(final)=3.204 | 1619.0 samples/s | 25.3 steps/s
[Step=22300 Epoch=211.3] | Loss=0.00071 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.734 | L2-Norm(final)=3.204 | 3599.0 samples/s | 56.2 steps/s
[Step=22350 Epoch=211.8] | Loss=0.00067 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.733 | L2-Norm(final)=3.204 | 1628.7 samples/s | 25.4 steps/s
[Step=22400 Epoch=212.3] | Loss=0.00063 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.732 | L2-Norm(final)=3.204 | 3543.4 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step22400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=25601 Epoch=241.2] | Loss=0.04098 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.798 | L2-Norm(final)=3.201 | 3273.1 samples/s | 51.1 steps/s
[Step=25650 Epoch=241.7] | Loss=0.00559 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.767 | L2-Norm(final)=3.202 | 3345.8 samples/s | 52.3 steps/s
[Step=25700 Epoch=242.2] | Loss=0.00299 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.760 | L2-Norm(final)=3.203 | 4515.5 samples/s | 70.6 steps/s
[Step=25750 Epoch=242.6] | Loss=0.00205 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.756 | L2-Norm(final)=3.203 | 1507.6 samples/s | 23.6 steps/s
[Step=25800 Epoch=243.1] | Loss=0.00156 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.752 | L2-Norm(final)=3.203 | 4139.3 samples/s | 64.7 steps/s
[Step=25850 Epoch=243.6] | Loss=0.00126 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.750 | L2-Norm(final)=3.204 | 1502.5 samples/s | 23.5 steps/s
[Step=25900 Epoch=244.1] | Loss=0.00106 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.748 | L2-Norm(final)=3.204 | 3850.2 samples/s | 60.2 steps/s
[Step=25950 Epoch=244.5] | Loss=0.00092 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.746 | L2-Norm(final)=3.204 | 1535.8 samples/s | 24.0 steps/s
[Step=26000 Epoch=245.0] | Loss=0.00081 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.744 | L2-Norm(final)=3.204 | 3692.8 samples/s | 57.7 steps/s
[Step=26050 Epoch=245.5] | Loss=0.00073 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.742 | L2-Norm(final)=3.204 | 1616.5 samples/s | 25.3 steps/s
[Step=26100 Epoch=245.9] | Loss=0.00066 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.740 | L2-Norm(final)=3.205 | 3590.0 samples/s | 56.1 steps/s
[Step=26150 Epoch=246.4] | Loss=0.00060 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.739 | L2-Norm(final)=3.205 | 1627.8 samples/s | 25.4 steps/s
[Step=26200 Epoch=246.9] | Loss=0.00056 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.738 | L2-Norm(final)=3.205 | 3558.3 samples/s | 55.6 steps/s
[Step=26250 Epoch=247.3] | Loss=0.00052 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.736 | L2-Norm(final)=3.205 | 1628.2 samples/s | 25.4 steps/s
[Step=26300 Epoch=247.8] | Loss=0.00048 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.735 | L2-Norm(final)=3.205 | 3590.8 samples/s | 56.1 steps/s
[Step=26350 Epoch=248.3] | Loss=0.00045 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.734 | L2-Norm(final)=3.205 | 1682.0 samples/s | 26.3 steps/s
[Step=26400 Epoch=248.8] | Loss=0.00043 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.733 | L2-Norm(final)=3.205 | 3338.4 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28712 | acc=0.8445 | tpr=0.7782 | fpr=0.0114 | 3710.3 samples/s | 14.5 steps/s
Avg test loss: 0.29623, Avg test acc: 0.84346, Avg tpr: 0.77811, Avg fpr: 0.01282, total FA: 100

Testing server on iccad2012
[Step=  50] | Loss=0.44249 | acc=0.8329 | tpr=0.9602 | fpr=0.1694 | 3766.4 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.45166 | acc=0.8326 | tpr=0.9723 | fpr=0.1700 | 7357.0 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.45771 | acc=0.8314 | tpr=0.9769 | fpr=0.1712 | 7450.5 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.46325 | acc=0.8295 | tpr=0.9781 | fpr=0.1732 | 7159.0 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.46275 | acc=0.8288 | tpr=0.9790 | fpr=0.1739 | 7604.5 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.46191 | acc=0.8287 | tpr=0.9818 | fpr=0.1741 | 7451.5 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.46419 | acc=0.8281 | tpr=0.9806 | fpr=0.1747 | 7434.0 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.46661 | acc=0.8280 | tpr=0.9776 | fpr=0.1747 | 7168.5 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.46701 | acc=0.8282 | tpr=0.9766 | fpr=0.1745 | 7401.8 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.46701 | acc=0.8278 | tpr=0.9753 | fpr=0.1748 | 7399.0 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.46616 | acc=0.8280 | tpr=0.9741 | fpr=0.1746 | 13015.7 samples/s | 50.8 steps/s
Avg test loss: 0.46563, Avg test acc: 0.82812, Avg tpr: 0.97385, Avg fpr: 0.17453, total FA: 24233

server round 49/50

clients selected: [0 3 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=78.0] | Loss=0.09225 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.782 | L2-Norm(final)=3.204 | 3256.1 samples/s | 50.9 steps/s
[Step=16050 Epoch=78.3] | Loss=0.03136 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.769 | L2-Norm(final)=3.202 | 3607.5 samples/s | 56.4 steps/s
[Step=16100 Epoch=78.5] | Loss=0.02185 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.764 | L2-Norm(final)=3.202 | 3679.4 samples/s | 57.5 steps/s
[Step=16150 Epoch=78.8] | Loss=0.01820 | Reg=0.00315 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.761 | L2-Norm(final)=3.203 | 3691.4 samples/s | 57.7 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01597 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.760 | L2-Norm(final)=3.203 | 4535.3 samples/s | 70.9 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01405 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.758 | L2-Norm(final)=3.204 | 1525.5 samples/s | 23.8 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01276 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.757 | L2-Norm(final)=3.204 | 3698.9 samples/s | 57.8 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01161 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.756 | L2-Norm(final)=3.205 | 3684.0 samples/s | 57.6 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01077 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.755 | L2-Norm(final)=3.206 | 4302.5 samples/s | 67.2 steps/s
[Step=16450 Epoch=80.2] | Loss=0.00989 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.755 | L2-Norm(final)=3.207 | 1554.9 samples/s | 24.3 steps/s
[Step=16500 Epoch=80.5] | Loss=0.00935 | Reg=0.00315 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.754 | L2-Norm(final)=3.208 | 3709.0 samples/s | 58.0 steps/s
[Step=16550 Epoch=80.7] | Loss=0.00898 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.754 | L2-Norm(final)=3.209 | 3694.1 samples/s | 57.7 steps/s
[Step=16600 Epoch=80.9] | Loss=0.00864 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.754 | L2-Norm(final)=3.210 | 4114.9 samples/s | 64.3 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00817 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.754 | L2-Norm(final)=3.211 | 1605.5 samples/s | 25.1 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00781 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.753 | L2-Norm(final)=3.212 | 3745.0 samples/s | 58.5 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00757 | Reg=0.00315 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.753 | L2-Norm(final)=3.213 | 3700.4 samples/s | 57.8 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00741 | Reg=0.00315 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.753 | L2-Norm(final)=3.214 | 3958.1 samples/s | 61.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step16800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=81.9] | Loss=0.15795 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.782 | L2-Norm(final)=3.204 | 3265.0 samples/s | 51.0 steps/s
[Step=16850 Epoch=82.2] | Loss=0.02723 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.770 | L2-Norm(final)=3.204 | 3675.6 samples/s | 57.4 steps/s
[Step=16900 Epoch=82.4] | Loss=0.01871 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.765 | L2-Norm(final)=3.204 | 3668.4 samples/s | 57.3 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01511 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.762 | L2-Norm(final)=3.204 | 3633.3 samples/s | 56.8 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01334 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.761 | L2-Norm(final)=3.205 | 4578.4 samples/s | 71.5 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01146 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.759 | L2-Norm(final)=3.206 | 1513.4 samples/s | 23.6 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01036 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.758 | L2-Norm(final)=3.207 | 3651.2 samples/s | 57.0 steps/s
[Step=17150 Epoch=83.6] | Loss=0.00968 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.758 | L2-Norm(final)=3.208 | 3647.0 samples/s | 57.0 steps/s
[Step=17200 Epoch=83.9] | Loss=0.00912 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.757 | L2-Norm(final)=3.209 | 4311.4 samples/s | 67.4 steps/s
[Step=17250 Epoch=84.1] | Loss=0.00847 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.756 | L2-Norm(final)=3.210 | 1561.0 samples/s | 24.4 steps/s
[Step=17300 Epoch=84.4] | Loss=0.00796 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.756 | L2-Norm(final)=3.211 | 3698.5 samples/s | 57.8 steps/s
[Step=17350 Epoch=84.6] | Loss=0.00754 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.756 | L2-Norm(final)=3.212 | 3710.5 samples/s | 58.0 steps/s
[Step=17400 Epoch=84.9] | Loss=0.00728 | Reg=0.00315 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.755 | L2-Norm(final)=3.213 | 4157.9 samples/s | 65.0 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00695 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.755 | L2-Norm(final)=3.214 | 1574.6 samples/s | 24.6 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00668 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.755 | L2-Norm(final)=3.215 | 3786.0 samples/s | 59.2 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00652 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.755 | L2-Norm(final)=3.216 | 3775.2 samples/s | 59.0 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00636 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.754 | L2-Norm(final)=3.217 | 4044.4 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_asml1_3/client_state-step17600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20801 Epoch=198.6] | Loss=0.02329 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.782 | L2-Norm(final)=3.205 | 3435.8 samples/s | 53.7 steps/s
[Step=20850 Epoch=199.1] | Loss=0.00680 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.751 | L2-Norm(final)=3.206 | 3211.5 samples/s | 50.2 steps/s
[Step=20900 Epoch=199.6] | Loss=0.00355 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.744 | L2-Norm(final)=3.206 | 4436.9 samples/s | 69.3 steps/s
[Step=20950 Epoch=200.1] | Loss=0.00239 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.740 | L2-Norm(final)=3.206 | 1483.2 samples/s | 23.2 steps/s
[Step=21000 Epoch=200.5] | Loss=0.00181 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.737 | L2-Norm(final)=3.206 | 4346.2 samples/s | 67.9 steps/s
[Step=21050 Epoch=201.0] | Loss=0.00146 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.734 | L2-Norm(final)=3.207 | 1506.2 samples/s | 23.5 steps/s
[Step=21100 Epoch=201.5] | Loss=0.00123 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.731 | L2-Norm(final)=3.207 | 4142.2 samples/s | 64.7 steps/s
[Step=21150 Epoch=202.0] | Loss=0.00106 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.729 | L2-Norm(final)=3.207 | 1539.7 samples/s | 24.1 steps/s
[Step=21200 Epoch=202.4] | Loss=0.00093 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.727 | L2-Norm(final)=3.207 | 3970.3 samples/s | 62.0 steps/s
[Step=21250 Epoch=202.9] | Loss=0.00083 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.726 | L2-Norm(final)=3.207 | 1541.8 samples/s | 24.1 steps/s
[Step=21300 Epoch=203.4] | Loss=0.00075 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.724 | L2-Norm(final)=3.207 | 3708.6 samples/s | 57.9 steps/s
[Step=21350 Epoch=203.9] | Loss=0.00069 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.723 | L2-Norm(final)=3.207 | 1574.4 samples/s | 24.6 steps/s
[Step=21400 Epoch=204.4] | Loss=0.00063 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.721 | L2-Norm(final)=3.207 | 3543.9 samples/s | 55.4 steps/s
[Step=21450 Epoch=204.8] | Loss=0.00059 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.720 | L2-Norm(final)=3.208 | 1612.7 samples/s | 25.2 steps/s
[Step=21500 Epoch=205.3] | Loss=0.00055 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.719 | L2-Norm(final)=3.208 | 3612.8 samples/s | 56.5 steps/s
[Step=21550 Epoch=205.8] | Loss=0.00051 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.718 | L2-Norm(final)=3.208 | 1635.9 samples/s | 25.6 steps/s
[Step=21600 Epoch=206.3] | Loss=0.00048 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.716 | L2-Norm(final)=3.208 | 3577.0 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_2/client_state-step21600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=26401 Epoch=248.8] | Loss=0.18268 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.782 | L2-Norm(final)=3.204 | 3197.0 samples/s | 50.0 steps/s
[Step=26450 Epoch=249.2] | Loss=0.00765 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.748 | L2-Norm(final)=3.205 | 3486.0 samples/s | 54.5 steps/s
[Step=26500 Epoch=249.7] | Loss=0.00400 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.741 | L2-Norm(final)=3.205 | 4501.8 samples/s | 70.3 steps/s
[Step=26550 Epoch=250.2] | Loss=0.00271 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.737 | L2-Norm(final)=3.205 | 1492.1 samples/s | 23.3 steps/s
[Step=26600 Epoch=250.6] | Loss=0.00206 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.734 | L2-Norm(final)=3.206 | 4066.0 samples/s | 63.5 steps/s
[Step=26650 Epoch=251.1] | Loss=0.00166 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.731 | L2-Norm(final)=3.206 | 1540.2 samples/s | 24.1 steps/s
[Step=26700 Epoch=251.6] | Loss=0.00140 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.729 | L2-Norm(final)=3.206 | 3945.2 samples/s | 61.6 steps/s
[Step=26750 Epoch=252.1] | Loss=0.00121 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.727 | L2-Norm(final)=3.206 | 1574.4 samples/s | 24.6 steps/s
[Step=26800 Epoch=252.5] | Loss=0.00107 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.726 | L2-Norm(final)=3.206 | 3645.1 samples/s | 57.0 steps/s
[Step=26850 Epoch=253.0] | Loss=0.00096 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.724 | L2-Norm(final)=3.207 | 1599.3 samples/s | 25.0 steps/s
[Step=26900 Epoch=253.5] | Loss=0.00087 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.723 | L2-Norm(final)=3.207 | 3626.8 samples/s | 56.7 steps/s
[Step=26950 Epoch=253.9] | Loss=0.00079 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.721 | L2-Norm(final)=3.207 | 1630.6 samples/s | 25.5 steps/s
[Step=27000 Epoch=254.4] | Loss=0.00073 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.720 | L2-Norm(final)=3.207 | 3616.6 samples/s | 56.5 steps/s
[Step=27050 Epoch=254.9] | Loss=0.00068 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.719 | L2-Norm(final)=3.207 | 1630.4 samples/s | 25.5 steps/s
[Step=27100 Epoch=255.4] | Loss=0.00063 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.718 | L2-Norm(final)=3.207 | 3559.9 samples/s | 55.6 steps/s
[Step=27150 Epoch=255.8] | Loss=0.00059 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.717 | L2-Norm(final)=3.207 | 1625.5 samples/s | 25.4 steps/s
[Step=27200 Epoch=256.3] | Loss=0.00056 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.716 | L2-Norm(final)=3.208 | 3493.7 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_3/client_state-step27200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=23201 Epoch=221.1] | Loss=0.04178 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.782 | L2-Norm(final)=3.205 | 3127.6 samples/s | 48.9 steps/s
[Step=23250 Epoch=221.6] | Loss=0.00953 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.750 | L2-Norm(final)=3.205 | 3453.3 samples/s | 54.0 steps/s
[Step=23300 Epoch=222.1] | Loss=0.00481 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.744 | L2-Norm(final)=3.205 | 4441.9 samples/s | 69.4 steps/s
[Step=23350 Epoch=222.5] | Loss=0.00324 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.739 | L2-Norm(final)=3.205 | 1480.4 samples/s | 23.1 steps/s
[Step=23400 Epoch=223.0] | Loss=0.00244 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.736 | L2-Norm(final)=3.205 | 4338.1 samples/s | 67.8 steps/s
[Step=23450 Epoch=223.5] | Loss=0.00197 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.733 | L2-Norm(final)=3.206 | 1484.0 samples/s | 23.2 steps/s
[Step=23500 Epoch=224.0] | Loss=0.00165 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.731 | L2-Norm(final)=3.206 | 4103.4 samples/s | 64.1 steps/s
[Step=23550 Epoch=224.5] | Loss=0.00142 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.729 | L2-Norm(final)=3.206 | 1530.2 samples/s | 23.9 steps/s
[Step=23600 Epoch=224.9] | Loss=0.00125 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.727 | L2-Norm(final)=3.206 | 3955.5 samples/s | 61.8 steps/s
[Step=23650 Epoch=225.4] | Loss=0.00112 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.725 | L2-Norm(final)=3.206 | 1553.2 samples/s | 24.3 steps/s
[Step=23700 Epoch=225.9] | Loss=0.00101 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.723 | L2-Norm(final)=3.206 | 3794.8 samples/s | 59.3 steps/s
[Step=23750 Epoch=226.4] | Loss=0.00092 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.722 | L2-Norm(final)=3.207 | 1583.4 samples/s | 24.7 steps/s
[Step=23800 Epoch=226.8] | Loss=0.00085 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.720 | L2-Norm(final)=3.207 | 3668.8 samples/s | 57.3 steps/s
[Step=23850 Epoch=227.3] | Loss=0.00079 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.719 | L2-Norm(final)=3.207 | 1597.3 samples/s | 25.0 steps/s
[Step=23900 Epoch=227.8] | Loss=0.00073 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.718 | L2-Norm(final)=3.207 | 3608.3 samples/s | 56.4 steps/s
[Step=23950 Epoch=228.3] | Loss=0.00069 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.717 | L2-Norm(final)=3.207 | 1600.9 samples/s | 25.0 steps/s
[Step=24000 Epoch=228.7] | Loss=0.00065 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.716 | L2-Norm(final)=3.207 | 3640.6 samples/s | 56.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3-withl2/client_iccad2012_4/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29579 | acc=0.8412 | tpr=0.7730 | fpr=0.0109 | 3736.6 samples/s | 14.6 steps/s
Avg test loss: 0.30444, Avg test acc: 0.84041, Avg tpr: 0.77345, Avg fpr: 0.01231, total FA: 96

Testing server on iccad2012
[Step=  50] | Loss=0.43215 | acc=0.8391 | tpr=0.9558 | fpr=0.1630 | 3319.8 samples/s | 13.0 steps/s
[Step= 100] | Loss=0.44140 | acc=0.8382 | tpr=0.9680 | fpr=0.1642 | 5798.1 samples/s | 22.6 steps/s
[Step= 150] | Loss=0.44716 | acc=0.8367 | tpr=0.9741 | fpr=0.1658 | 5822.4 samples/s | 22.7 steps/s
[Step= 200] | Loss=0.45262 | acc=0.8349 | tpr=0.9760 | fpr=0.1677 | 6231.5 samples/s | 24.3 steps/s
[Step= 250] | Loss=0.45206 | acc=0.8343 | tpr=0.9764 | fpr=0.1683 | 7243.5 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.45118 | acc=0.8341 | tpr=0.9789 | fpr=0.1686 | 7509.8 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.45338 | acc=0.8337 | tpr=0.9781 | fpr=0.1689 | 7215.4 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.45583 | acc=0.8335 | tpr=0.9754 | fpr=0.1691 | 7375.1 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.45621 | acc=0.8337 | tpr=0.9747 | fpr=0.1689 | 7273.7 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.45613 | acc=0.8333 | tpr=0.9736 | fpr=0.1693 | 7284.1 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.45527 | acc=0.8334 | tpr=0.9725 | fpr=0.1691 | 14132.1 samples/s | 55.2 steps/s
Avg test loss: 0.45475, Avg test acc: 0.83349, Avg tpr: 0.97227, Avg fpr: 0.16903, total FA: 23470
