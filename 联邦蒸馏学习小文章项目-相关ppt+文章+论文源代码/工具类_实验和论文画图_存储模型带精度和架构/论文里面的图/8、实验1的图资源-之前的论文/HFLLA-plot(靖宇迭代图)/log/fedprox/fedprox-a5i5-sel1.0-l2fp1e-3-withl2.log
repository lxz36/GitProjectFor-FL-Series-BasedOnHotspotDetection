#clients of iccad2012: 5
#clients of asml1: 5
select ratio: 1.0
Total num clients: 10
client model path: ['models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13125, 144, 32)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13116, 144, 32)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13135, 144, 32)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13124, 144, 32)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 32)
Resampled dataset to size (13051, 144, 32)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6754, 144, 32)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6728, 144, 32)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6702, 144, 32)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6792, 144, 32)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6715, 144, 32)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34859 | Reg=0.00359 | FP-Reg=0.000 | acc=0.5312 | L2-Norm=18.949 | L2-Norm(final)=2.033 | 2724.1 samples/s | 42.6 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.27704 | Reg=0.00358 | FP-Reg=0.002 | acc=0.8125 | L2-Norm=18.933 | L2-Norm(final)=2.030 | 3712.6 samples/s | 58.0 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.23429 | Reg=0.00360 | FP-Reg=0.003 | acc=0.9062 | L2-Norm=18.962 | L2-Norm(final)=2.035 | 3640.6 samples/s | 56.9 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.21269 | Reg=0.00361 | FP-Reg=0.004 | acc=0.9219 | L2-Norm=18.987 | L2-Norm(final)=2.039 | 3613.4 samples/s | 56.5 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.19556 | Reg=0.00361 | FP-Reg=0.005 | acc=0.8750 | L2-Norm=19.010 | L2-Norm(final)=2.047 | 4431.2 samples/s | 69.2 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.17786 | Reg=0.00362 | FP-Reg=0.006 | acc=0.8750 | L2-Norm=19.035 | L2-Norm(final)=2.055 | 1656.6 samples/s | 25.9 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.16521 | Reg=0.00363 | FP-Reg=0.007 | acc=0.8750 | L2-Norm=19.062 | L2-Norm(final)=2.064 | 3705.4 samples/s | 57.9 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.15521 | Reg=0.00364 | FP-Reg=0.008 | acc=0.9375 | L2-Norm=19.088 | L2-Norm(final)=2.072 | 3615.4 samples/s | 56.5 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.14806 | Reg=0.00365 | FP-Reg=0.009 | acc=0.9375 | L2-Norm=19.111 | L2-Norm(final)=2.080 | 4340.6 samples/s | 67.8 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14072 | Reg=0.00366 | FP-Reg=0.009 | acc=0.9531 | L2-Norm=19.136 | L2-Norm(final)=2.087 | 1665.1 samples/s | 26.0 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13310 | Reg=0.00367 | FP-Reg=0.010 | acc=0.9688 | L2-Norm=19.160 | L2-Norm(final)=2.094 | 3639.9 samples/s | 56.9 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12766 | Reg=0.00368 | FP-Reg=0.011 | acc=0.9375 | L2-Norm=19.181 | L2-Norm(final)=2.100 | 3571.2 samples/s | 55.8 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12195 | Reg=0.00369 | FP-Reg=0.011 | acc=0.9219 | L2-Norm=19.200 | L2-Norm(final)=2.107 | 3979.2 samples/s | 62.2 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11715 | Reg=0.00369 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.219 | L2-Norm(final)=2.113 | 1644.2 samples/s | 25.7 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11208 | Reg=0.00370 | FP-Reg=0.012 | acc=0.9375 | L2-Norm=19.238 | L2-Norm(final)=2.120 | 3552.8 samples/s | 55.5 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10781 | Reg=0.00371 | FP-Reg=0.013 | acc=0.9844 | L2-Norm=19.255 | L2-Norm(final)=2.126 | 3610.0 samples/s | 56.4 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10373 | Reg=0.00371 | FP-Reg=0.013 | acc=1.0000 | L2-Norm=19.272 | L2-Norm(final)=2.132 | 3938.6 samples/s | 61.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34474 | Reg=0.00359 | FP-Reg=0.000 | acc=0.5625 | L2-Norm=18.949 | L2-Norm(final)=2.034 | 3820.7 samples/s | 59.7 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.27243 | Reg=0.00359 | FP-Reg=0.002 | acc=0.8594 | L2-Norm=18.938 | L2-Norm(final)=2.033 | 3473.3 samples/s | 54.3 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.23532 | Reg=0.00360 | FP-Reg=0.004 | acc=0.8125 | L2-Norm=18.976 | L2-Norm(final)=2.041 | 3634.7 samples/s | 56.8 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.21223 | Reg=0.00361 | FP-Reg=0.005 | acc=0.9219 | L2-Norm=19.004 | L2-Norm(final)=2.047 | 3593.2 samples/s | 56.1 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.19636 | Reg=0.00362 | FP-Reg=0.006 | acc=0.8906 | L2-Norm=19.028 | L2-Norm(final)=2.053 | 4531.4 samples/s | 70.8 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.17924 | Reg=0.00363 | FP-Reg=0.007 | acc=0.9531 | L2-Norm=19.053 | L2-Norm(final)=2.060 | 1627.9 samples/s | 25.4 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.16642 | Reg=0.00364 | FP-Reg=0.007 | acc=0.9062 | L2-Norm=19.077 | L2-Norm(final)=2.069 | 3540.9 samples/s | 55.3 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.15699 | Reg=0.00365 | FP-Reg=0.008 | acc=0.9219 | L2-Norm=19.099 | L2-Norm(final)=2.076 | 3527.2 samples/s | 55.1 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.14898 | Reg=0.00366 | FP-Reg=0.009 | acc=0.8750 | L2-Norm=19.119 | L2-Norm(final)=2.083 | 4222.1 samples/s | 66.0 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.13934 | Reg=0.00366 | FP-Reg=0.010 | acc=0.9375 | L2-Norm=19.140 | L2-Norm(final)=2.091 | 1666.5 samples/s | 26.0 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13136 | Reg=0.00367 | FP-Reg=0.010 | acc=0.9375 | L2-Norm=19.160 | L2-Norm(final)=2.100 | 3687.4 samples/s | 57.6 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12501 | Reg=0.00368 | FP-Reg=0.011 | acc=0.9219 | L2-Norm=19.180 | L2-Norm(final)=2.108 | 3716.6 samples/s | 58.1 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12019 | Reg=0.00369 | FP-Reg=0.011 | acc=0.9844 | L2-Norm=19.198 | L2-Norm(final)=2.116 | 4254.0 samples/s | 66.5 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11480 | Reg=0.00369 | FP-Reg=0.012 | acc=0.9688 | L2-Norm=19.216 | L2-Norm(final)=2.123 | 1687.4 samples/s | 26.4 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.10946 | Reg=0.00370 | FP-Reg=0.012 | acc=0.9844 | L2-Norm=19.233 | L2-Norm(final)=2.131 | 3636.6 samples/s | 56.8 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10620 | Reg=0.00371 | FP-Reg=0.013 | acc=0.9219 | L2-Norm=19.250 | L2-Norm(final)=2.138 | 3749.1 samples/s | 58.6 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10258 | Reg=0.00371 | FP-Reg=0.013 | acc=0.9844 | L2-Norm=19.267 | L2-Norm(final)=2.145 | 4070.7 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33634 | Reg=0.00359 | FP-Reg=0.000 | acc=0.5781 | L2-Norm=18.949 | L2-Norm(final)=2.034 | 3659.9 samples/s | 57.2 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.28923 | Reg=0.00359 | FP-Reg=0.002 | acc=0.8594 | L2-Norm=18.935 | L2-Norm(final)=2.027 | 3710.7 samples/s | 58.0 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24487 | Reg=0.00360 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=18.974 | L2-Norm(final)=2.035 | 3672.2 samples/s | 57.4 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.21831 | Reg=0.00361 | FP-Reg=0.005 | acc=0.8750 | L2-Norm=19.006 | L2-Norm(final)=2.043 | 3766.3 samples/s | 58.8 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.19956 | Reg=0.00362 | FP-Reg=0.006 | acc=0.8750 | L2-Norm=19.036 | L2-Norm(final)=2.050 | 4612.9 samples/s | 72.1 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18166 | Reg=0.00363 | FP-Reg=0.007 | acc=0.9062 | L2-Norm=19.062 | L2-Norm(final)=2.059 | 1619.3 samples/s | 25.3 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.16946 | Reg=0.00364 | FP-Reg=0.008 | acc=0.8594 | L2-Norm=19.088 | L2-Norm(final)=2.068 | 3681.1 samples/s | 57.5 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16027 | Reg=0.00365 | FP-Reg=0.009 | acc=0.9375 | L2-Norm=19.114 | L2-Norm(final)=2.076 | 3683.9 samples/s | 57.6 steps/s
[Step= 400 Epoch= 1.9] | Loss=0.15076 | Reg=0.00366 | FP-Reg=0.010 | acc=0.9531 | L2-Norm=19.139 | L2-Norm(final)=2.084 | 4295.7 samples/s | 67.1 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14157 | Reg=0.00367 | FP-Reg=0.010 | acc=0.9531 | L2-Norm=19.162 | L2-Norm(final)=2.092 | 1642.7 samples/s | 25.7 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13315 | Reg=0.00368 | FP-Reg=0.011 | acc=0.9688 | L2-Norm=19.184 | L2-Norm(final)=2.101 | 3611.9 samples/s | 56.4 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12623 | Reg=0.00369 | FP-Reg=0.012 | acc=0.9844 | L2-Norm=19.204 | L2-Norm(final)=2.109 | 3589.2 samples/s | 56.1 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12128 | Reg=0.00369 | FP-Reg=0.012 | acc=0.9531 | L2-Norm=19.222 | L2-Norm(final)=2.117 | 4084.6 samples/s | 63.8 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11567 | Reg=0.00370 | FP-Reg=0.013 | acc=0.9688 | L2-Norm=19.239 | L2-Norm(final)=2.124 | 1683.5 samples/s | 26.3 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11017 | Reg=0.00371 | FP-Reg=0.013 | acc=0.9531 | L2-Norm=19.256 | L2-Norm(final)=2.131 | 3596.8 samples/s | 56.2 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10561 | Reg=0.00371 | FP-Reg=0.014 | acc=0.9688 | L2-Norm=19.271 | L2-Norm(final)=2.139 | 3638.0 samples/s | 56.8 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10235 | Reg=0.00372 | FP-Reg=0.014 | acc=1.0000 | L2-Norm=19.285 | L2-Norm(final)=2.146 | 3835.2 samples/s | 59.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34140 | Reg=0.00359 | FP-Reg=0.000 | acc=0.5469 | L2-Norm=18.949 | L2-Norm(final)=2.033 | 3669.8 samples/s | 57.3 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.29449 | Reg=0.00358 | FP-Reg=0.002 | acc=0.7812 | L2-Norm=18.928 | L2-Norm(final)=2.025 | 3587.0 samples/s | 56.0 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24281 | Reg=0.00360 | FP-Reg=0.004 | acc=0.7656 | L2-Norm=18.972 | L2-Norm(final)=2.040 | 3591.8 samples/s | 56.1 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.21783 | Reg=0.00361 | FP-Reg=0.005 | acc=0.9219 | L2-Norm=19.006 | L2-Norm(final)=2.049 | 3599.7 samples/s | 56.2 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.19709 | Reg=0.00362 | FP-Reg=0.006 | acc=0.8594 | L2-Norm=19.033 | L2-Norm(final)=2.058 | 4487.3 samples/s | 70.1 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.17992 | Reg=0.00363 | FP-Reg=0.007 | acc=0.9062 | L2-Norm=19.060 | L2-Norm(final)=2.067 | 1627.5 samples/s | 25.4 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.16653 | Reg=0.00364 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.087 | L2-Norm(final)=2.076 | 3654.8 samples/s | 57.1 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.15573 | Reg=0.00365 | FP-Reg=0.009 | acc=0.9062 | L2-Norm=19.112 | L2-Norm(final)=2.087 | 3610.2 samples/s | 56.4 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.14698 | Reg=0.00366 | FP-Reg=0.010 | acc=0.8750 | L2-Norm=19.135 | L2-Norm(final)=2.096 | 4261.0 samples/s | 66.6 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.13982 | Reg=0.00367 | FP-Reg=0.010 | acc=0.9062 | L2-Norm=19.158 | L2-Norm(final)=2.104 | 1617.9 samples/s | 25.3 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13323 | Reg=0.00368 | FP-Reg=0.011 | acc=0.9062 | L2-Norm=19.180 | L2-Norm(final)=2.112 | 3611.8 samples/s | 56.4 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12675 | Reg=0.00369 | FP-Reg=0.012 | acc=0.9375 | L2-Norm=19.201 | L2-Norm(final)=2.119 | 3609.3 samples/s | 56.4 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12077 | Reg=0.00369 | FP-Reg=0.012 | acc=0.9688 | L2-Norm=19.220 | L2-Norm(final)=2.127 | 4053.6 samples/s | 63.3 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11527 | Reg=0.00370 | FP-Reg=0.013 | acc=1.0000 | L2-Norm=19.238 | L2-Norm(final)=2.135 | 1703.5 samples/s | 26.6 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11020 | Reg=0.00371 | FP-Reg=0.013 | acc=0.9531 | L2-Norm=19.254 | L2-Norm(final)=2.143 | 3733.6 samples/s | 58.3 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10508 | Reg=0.00371 | FP-Reg=0.014 | acc=1.0000 | L2-Norm=19.270 | L2-Norm(final)=2.151 | 3633.4 samples/s | 56.8 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10112 | Reg=0.00372 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.284 | L2-Norm(final)=2.159 | 3917.7 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34305 | Reg=0.00359 | FP-Reg=0.000 | acc=0.5781 | L2-Norm=18.949 | L2-Norm(final)=2.035 | 3780.7 samples/s | 59.1 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.28882 | Reg=0.00358 | FP-Reg=0.002 | acc=0.7969 | L2-Norm=18.932 | L2-Norm(final)=2.024 | 3631.3 samples/s | 56.7 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24270 | Reg=0.00360 | FP-Reg=0.004 | acc=0.7344 | L2-Norm=18.972 | L2-Norm(final)=2.036 | 3766.3 samples/s | 58.8 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.21522 | Reg=0.00361 | FP-Reg=0.005 | acc=0.8438 | L2-Norm=19.005 | L2-Norm(final)=2.045 | 3690.9 samples/s | 57.7 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.19458 | Reg=0.00362 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.033 | L2-Norm(final)=2.054 | 4567.5 samples/s | 71.4 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.17647 | Reg=0.00363 | FP-Reg=0.007 | acc=0.9531 | L2-Norm=19.060 | L2-Norm(final)=2.064 | 1631.8 samples/s | 25.5 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.16363 | Reg=0.00364 | FP-Reg=0.008 | acc=0.8906 | L2-Norm=19.089 | L2-Norm(final)=2.075 | 3685.0 samples/s | 57.6 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.15421 | Reg=0.00365 | FP-Reg=0.009 | acc=0.9688 | L2-Norm=19.117 | L2-Norm(final)=2.086 | 3724.1 samples/s | 58.2 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.14510 | Reg=0.00367 | FP-Reg=0.010 | acc=0.9219 | L2-Norm=19.145 | L2-Norm(final)=2.096 | 4472.4 samples/s | 69.9 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.13570 | Reg=0.00367 | FP-Reg=0.010 | acc=0.9688 | L2-Norm=19.170 | L2-Norm(final)=2.105 | 1630.4 samples/s | 25.5 steps/s
[Step= 500 Epoch= 2.5] | Loss=0.12834 | Reg=0.00368 | FP-Reg=0.011 | acc=0.8906 | L2-Norm=19.193 | L2-Norm(final)=2.115 | 3676.8 samples/s | 57.4 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12180 | Reg=0.00369 | FP-Reg=0.012 | acc=0.9688 | L2-Norm=19.216 | L2-Norm(final)=2.125 | 3677.3 samples/s | 57.5 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.11630 | Reg=0.00370 | FP-Reg=0.012 | acc=0.9219 | L2-Norm=19.237 | L2-Norm(final)=2.134 | 4271.3 samples/s | 66.7 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11087 | Reg=0.00371 | FP-Reg=0.013 | acc=0.9531 | L2-Norm=19.256 | L2-Norm(final)=2.143 | 1677.8 samples/s | 26.2 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.10579 | Reg=0.00372 | FP-Reg=0.013 | acc=0.9688 | L2-Norm=19.275 | L2-Norm(final)=2.152 | 3640.0 samples/s | 56.9 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10172 | Reg=0.00372 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.292 | L2-Norm(final)=2.160 | 3606.2 samples/s | 56.3 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.09846 | Reg=0.00373 | FP-Reg=0.014 | acc=0.9531 | L2-Norm=19.308 | L2-Norm(final)=2.168 | 4026.4 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33095 | Reg=0.00359 | FP-Reg=0.000 | acc=0.6250 | L2-Norm=18.949 | L2-Norm(final)=2.035 | 3653.4 samples/s | 57.1 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.13834 | Reg=0.00360 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=18.976 | L2-Norm(final)=2.053 | 3380.0 samples/s | 52.8 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.08413 | Reg=0.00362 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.013 | L2-Norm(final)=2.069 | 4392.0 samples/s | 68.6 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.05946 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.032 | L2-Norm(final)=2.080 | 1583.8 samples/s | 24.7 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04557 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.042 | L2-Norm(final)=2.090 | 4208.4 samples/s | 65.8 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03691 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.048 | L2-Norm(final)=2.099 | 1626.7 samples/s | 25.4 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.03089 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.048 | L2-Norm(final)=2.107 | 3949.8 samples/s | 61.7 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02654 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.045 | L2-Norm(final)=2.113 | 1660.7 samples/s | 25.9 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02329 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.041 | L2-Norm(final)=2.119 | 3710.4 samples/s | 58.0 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02076 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.036 | L2-Norm(final)=2.125 | 1691.1 samples/s | 26.4 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.01873 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.031 | L2-Norm(final)=2.130 | 3635.8 samples/s | 56.8 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01707 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.026 | L2-Norm(final)=2.135 | 1721.1 samples/s | 26.9 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01568 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.022 | L2-Norm(final)=2.140 | 3498.9 samples/s | 54.7 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01452 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.017 | L2-Norm(final)=2.145 | 1729.9 samples/s | 27.0 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01351 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.012 | L2-Norm(final)=2.149 | 3572.0 samples/s | 55.8 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01268 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.154 | 1743.4 samples/s | 27.2 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01383 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.014 | L2-Norm(final)=2.155 | 3519.4 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33667 | Reg=0.00359 | FP-Reg=0.000 | acc=0.5469 | L2-Norm=18.949 | L2-Norm(final)=2.035 | 3566.2 samples/s | 55.7 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.13818 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.971 | L2-Norm(final)=2.059 | 3528.2 samples/s | 55.1 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.08590 | Reg=0.00361 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.006 | L2-Norm(final)=2.074 | 4504.0 samples/s | 70.4 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.06022 | Reg=0.00362 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.025 | L2-Norm(final)=2.089 | 1569.2 samples/s | 24.5 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04605 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.035 | L2-Norm(final)=2.101 | 4227.4 samples/s | 66.1 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03728 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.039 | L2-Norm(final)=2.112 | 1626.0 samples/s | 25.4 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.03128 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.121 | 3932.4 samples/s | 61.4 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02711 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.130 | 1652.3 samples/s | 25.8 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02391 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.041 | L2-Norm(final)=2.138 | 3817.1 samples/s | 59.6 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02134 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.145 | 1661.6 samples/s | 26.0 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01924 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.037 | L2-Norm(final)=2.151 | 3522.8 samples/s | 55.0 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01753 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.033 | L2-Norm(final)=2.157 | 1725.8 samples/s | 27.0 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01610 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.029 | L2-Norm(final)=2.162 | 3495.7 samples/s | 54.6 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01489 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.024 | L2-Norm(final)=2.166 | 1748.7 samples/s | 27.3 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01386 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.020 | L2-Norm(final)=2.171 | 3531.8 samples/s | 55.2 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01296 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.016 | L2-Norm(final)=2.175 | 1723.1 samples/s | 26.9 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01218 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.012 | L2-Norm(final)=2.179 | 3469.8 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34292 | Reg=0.00359 | FP-Reg=0.000 | acc=0.6094 | L2-Norm=18.949 | L2-Norm(final)=2.034 | 3451.5 samples/s | 53.9 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.12478 | Reg=0.00360 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=18.977 | L2-Norm(final)=2.063 | 3352.4 samples/s | 52.4 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.07572 | Reg=0.00362 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.016 | L2-Norm(final)=2.081 | 4264.9 samples/s | 66.6 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.05248 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.034 | L2-Norm(final)=2.095 | 1524.9 samples/s | 23.8 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04000 | Reg=0.00363 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.042 | L2-Norm(final)=2.106 | 4092.0 samples/s | 63.9 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03243 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.044 | L2-Norm(final)=2.115 | 1568.2 samples/s | 24.5 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.02716 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.043 | L2-Norm(final)=2.123 | 3941.4 samples/s | 61.6 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02467 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.043 | L2-Norm(final)=2.130 | 1621.7 samples/s | 25.3 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02184 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.050 | L2-Norm(final)=2.136 | 3921.4 samples/s | 61.3 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.01945 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.052 | L2-Norm(final)=2.141 | 1682.0 samples/s | 26.3 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01755 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.050 | L2-Norm(final)=2.146 | 3730.7 samples/s | 58.3 steps/s
[Step= 550 Epoch= 5.3] | Loss=0.01599 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.048 | L2-Norm(final)=2.150 | 1701.0 samples/s | 26.6 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01469 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.044 | L2-Norm(final)=2.154 | 3554.7 samples/s | 55.5 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01358 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.157 | 1736.6 samples/s | 27.1 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01264 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.035 | L2-Norm(final)=2.160 | 3511.0 samples/s | 54.9 steps/s
[Step= 750 Epoch= 7.2] | Loss=0.01182 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.031 | L2-Norm(final)=2.164 | 1742.0 samples/s | 27.2 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01110 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.026 | L2-Norm(final)=2.167 | 3467.2 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33889 | Reg=0.00359 | FP-Reg=0.000 | acc=0.6250 | L2-Norm=18.949 | L2-Norm(final)=2.035 | 3623.4 samples/s | 56.6 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.14059 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.972 | L2-Norm(final)=2.057 | 3416.3 samples/s | 53.4 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.08036 | Reg=0.00361 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.005 | L2-Norm(final)=2.075 | 4321.5 samples/s | 67.5 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.05584 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.025 | L2-Norm(final)=2.090 | 1529.9 samples/s | 23.9 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04381 | Reg=0.00362 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.035 | L2-Norm(final)=2.102 | 3973.5 samples/s | 62.1 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03899 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.046 | L2-Norm(final)=2.108 | 1585.4 samples/s | 24.8 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.03271 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.054 | L2-Norm(final)=2.113 | 3705.3 samples/s | 57.9 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02813 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.057 | L2-Norm(final)=2.118 | 1629.9 samples/s | 25.5 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02467 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.056 | L2-Norm(final)=2.123 | 3474.2 samples/s | 54.3 steps/s
[Step= 450 Epoch= 4.2] | Loss=0.02198 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.127 | 1689.8 samples/s | 26.4 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.01983 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.049 | L2-Norm(final)=2.131 | 3569.9 samples/s | 55.8 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01807 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.044 | L2-Norm(final)=2.135 | 1745.0 samples/s | 27.3 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01660 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.138 | 3573.0 samples/s | 55.8 steps/s
[Step= 650 Epoch= 6.1] | Loss=0.01535 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.035 | L2-Norm(final)=2.142 | 1744.8 samples/s | 27.3 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01429 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.031 | L2-Norm(final)=2.145 | 3536.6 samples/s | 55.3 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01337 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.026 | L2-Norm(final)=2.149 | 1758.7 samples/s | 27.5 steps/s
[Step= 800 Epoch= 7.5] | Loss=0.01255 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.022 | L2-Norm(final)=2.152 | 3480.2 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33601 | Reg=0.00359 | FP-Reg=0.000 | acc=0.6250 | L2-Norm=18.949 | L2-Norm(final)=2.034 | 3930.0 samples/s | 61.4 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.15134 | Reg=0.00360 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=18.971 | L2-Norm(final)=2.052 | 3260.1 samples/s | 50.9 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.08675 | Reg=0.00362 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.016 | L2-Norm(final)=2.077 | 4487.5 samples/s | 70.1 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.05969 | Reg=0.00362 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.035 | L2-Norm(final)=2.094 | 1590.1 samples/s | 24.8 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04651 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.045 | L2-Norm(final)=2.107 | 4205.2 samples/s | 65.7 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03835 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.117 | 1612.2 samples/s | 25.2 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.03224 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.059 | L2-Norm(final)=2.127 | 4092.7 samples/s | 63.9 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02773 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.059 | L2-Norm(final)=2.134 | 1632.4 samples/s | 25.5 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02432 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.057 | L2-Norm(final)=2.141 | 3904.4 samples/s | 61.0 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02167 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.147 | 1675.6 samples/s | 26.2 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01954 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.048 | L2-Norm(final)=2.153 | 3722.2 samples/s | 58.2 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01781 | Reg=0.00363 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.043 | L2-Norm(final)=2.158 | 1692.1 samples/s | 26.4 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01636 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.038 | L2-Norm(final)=2.163 | 3519.9 samples/s | 55.0 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01513 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.033 | L2-Norm(final)=2.168 | 1741.0 samples/s | 27.2 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01409 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.028 | L2-Norm(final)=2.172 | 3562.2 samples/s | 55.7 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01318 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.024 | L2-Norm(final)=2.177 | 1736.8 samples/s | 27.1 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01238 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.020 | L2-Norm(final)=2.181 | 3492.8 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25273 | acc=0.7461 | tpr=0.7280 | fpr=0.2146 | 3812.1 samples/s | 14.9 steps/s
Avg test loss: 0.25370, Avg test acc: 0.74673, Avg tpr: 0.72857, Avg fpr: 0.21331, total FA: 1664

Testing server on iccad2012
[Step=  50] | Loss=0.39940 | acc=0.5881 | tpr=0.9469 | fpr=0.4183 | 3793.7 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.39837 | acc=0.5878 | tpr=0.9467 | fpr=0.4189 | 7213.4 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.39880 | acc=0.5867 | tpr=0.9553 | fpr=0.4201 | 7439.8 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.39881 | acc=0.5874 | tpr=0.9574 | fpr=0.4193 | 7338.1 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.39891 | acc=0.5863 | tpr=0.9546 | fpr=0.4204 | 7271.9 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.39876 | acc=0.5862 | tpr=0.9549 | fpr=0.4205 | 7374.6 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.39881 | acc=0.5859 | tpr=0.9555 | fpr=0.4208 | 7186.2 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.39907 | acc=0.5856 | tpr=0.9546 | fpr=0.4211 | 7354.3 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.39972 | acc=0.5859 | tpr=0.9528 | fpr=0.4207 | 6855.4 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.40022 | acc=0.5856 | tpr=0.9537 | fpr=0.4211 | 7207.2 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.40027 | acc=0.5853 | tpr=0.9526 | fpr=0.4213 | 13512.0 samples/s | 52.8 steps/s
Avg test loss: 0.40027, Avg test acc: 0.58538, Avg tpr: 0.95285, Avg fpr: 0.42130, total FA: 58497

server round 1/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.30321 | Reg=0.00362 | FP-Reg=0.000 | acc=0.7656 | L2-Norm=19.016 | L2-Norm(final)=2.216 | 3747.4 samples/s | 58.6 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.16275 | Reg=0.00363 | FP-Reg=0.002 | acc=0.8594 | L2-Norm=19.056 | L2-Norm(final)=2.208 | 3636.9 samples/s | 56.8 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.14299 | Reg=0.00364 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.075 | L2-Norm(final)=2.211 | 3732.9 samples/s | 58.3 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.13181 | Reg=0.00365 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.096 | L2-Norm(final)=2.217 | 3708.7 samples/s | 57.9 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.12064 | Reg=0.00365 | FP-Reg=0.004 | acc=0.8906 | L2-Norm=19.114 | L2-Norm(final)=2.222 | 4597.9 samples/s | 71.8 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.10898 | Reg=0.00366 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.132 | L2-Norm(final)=2.227 | 1625.2 samples/s | 25.4 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.10100 | Reg=0.00367 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.151 | L2-Norm(final)=2.234 | 3662.3 samples/s | 57.2 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09555 | Reg=0.00367 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.169 | L2-Norm(final)=2.240 | 3643.7 samples/s | 56.9 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.09077 | Reg=0.00368 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.186 | L2-Norm(final)=2.248 | 4308.0 samples/s | 67.3 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08677 | Reg=0.00369 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.204 | L2-Norm(final)=2.255 | 1676.3 samples/s | 26.2 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.08295 | Reg=0.00369 | FP-Reg=0.007 | acc=0.9062 | L2-Norm=19.222 | L2-Norm(final)=2.261 | 3666.4 samples/s | 57.3 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.07967 | Reg=0.00370 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.239 | L2-Norm(final)=2.267 | 3565.4 samples/s | 55.7 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.07629 | Reg=0.00371 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.255 | L2-Norm(final)=2.273 | 4053.7 samples/s | 63.3 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07242 | Reg=0.00371 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.269 | L2-Norm(final)=2.279 | 1700.3 samples/s | 26.6 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.06938 | Reg=0.00372 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.283 | L2-Norm(final)=2.286 | 3717.2 samples/s | 58.1 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06708 | Reg=0.00372 | FP-Reg=0.008 | acc=0.9219 | L2-Norm=19.295 | L2-Norm(final)=2.292 | 3753.4 samples/s | 58.6 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06546 | Reg=0.00373 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.307 | L2-Norm(final)=2.297 | 4011.6 samples/s | 62.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step1600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.27725 | Reg=0.00362 | FP-Reg=0.000 | acc=0.6719 | L2-Norm=19.016 | L2-Norm(final)=2.216 | 3821.8 samples/s | 59.7 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.17273 | Reg=0.00363 | FP-Reg=0.003 | acc=0.8594 | L2-Norm=19.059 | L2-Norm(final)=2.205 | 3580.8 samples/s | 55.9 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.15273 | Reg=0.00364 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.079 | L2-Norm(final)=2.202 | 3623.0 samples/s | 56.6 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.13524 | Reg=0.00365 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.098 | L2-Norm(final)=2.209 | 3578.8 samples/s | 55.9 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.12663 | Reg=0.00365 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.116 | L2-Norm(final)=2.213 | 4544.3 samples/s | 71.0 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.11468 | Reg=0.00366 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.135 | L2-Norm(final)=2.219 | 1617.4 samples/s | 25.3 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.10467 | Reg=0.00367 | FP-Reg=0.005 | acc=0.9219 | L2-Norm=19.153 | L2-Norm(final)=2.227 | 3735.7 samples/s | 58.4 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09938 | Reg=0.00368 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.172 | L2-Norm(final)=2.234 | 3738.1 samples/s | 58.4 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.09461 | Reg=0.00368 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.190 | L2-Norm(final)=2.240 | 4441.2 samples/s | 69.4 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08852 | Reg=0.00369 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.206 | L2-Norm(final)=2.247 | 1659.6 samples/s | 25.9 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.08321 | Reg=0.00369 | FP-Reg=0.007 | acc=0.9688 | L2-Norm=19.221 | L2-Norm(final)=2.254 | 3658.5 samples/s | 57.2 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.07968 | Reg=0.00370 | FP-Reg=0.007 | acc=0.9688 | L2-Norm=19.237 | L2-Norm(final)=2.260 | 3609.4 samples/s | 56.4 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.07653 | Reg=0.00371 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.251 | L2-Norm(final)=2.266 | 4106.8 samples/s | 64.2 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07347 | Reg=0.00371 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.265 | L2-Norm(final)=2.272 | 1676.4 samples/s | 26.2 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.07047 | Reg=0.00372 | FP-Reg=0.008 | acc=0.9531 | L2-Norm=19.277 | L2-Norm(final)=2.278 | 3694.3 samples/s | 57.7 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06816 | Reg=0.00372 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.290 | L2-Norm(final)=2.283 | 3691.1 samples/s | 57.7 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06656 | Reg=0.00373 | FP-Reg=0.009 | acc=0.9844 | L2-Norm=19.302 | L2-Norm(final)=2.289 | 4093.1 samples/s | 64.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step1600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.22923 | Reg=0.00362 | FP-Reg=0.000 | acc=0.7656 | L2-Norm=19.016 | L2-Norm(final)=2.216 | 3753.5 samples/s | 58.6 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.16150 | Reg=0.00363 | FP-Reg=0.002 | acc=0.9062 | L2-Norm=19.061 | L2-Norm(final)=2.212 | 3626.6 samples/s | 56.7 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.14277 | Reg=0.00364 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.081 | L2-Norm(final)=2.213 | 3636.3 samples/s | 56.8 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.13378 | Reg=0.00365 | FP-Reg=0.004 | acc=0.9219 | L2-Norm=19.102 | L2-Norm(final)=2.215 | 3638.8 samples/s | 56.9 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.12380 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.126 | L2-Norm(final)=2.219 | 4506.3 samples/s | 70.4 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.11160 | Reg=0.00367 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.147 | L2-Norm(final)=2.225 | 1624.8 samples/s | 25.4 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.10277 | Reg=0.00367 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.168 | L2-Norm(final)=2.232 | 3609.0 samples/s | 56.4 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09839 | Reg=0.00368 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.189 | L2-Norm(final)=2.238 | 3619.1 samples/s | 56.5 steps/s
[Step=1200 Epoch= 5.8] | Loss=0.09354 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.207 | L2-Norm(final)=2.243 | 4339.9 samples/s | 67.8 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08826 | Reg=0.00370 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.222 | L2-Norm(final)=2.248 | 1650.3 samples/s | 25.8 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.08357 | Reg=0.00370 | FP-Reg=0.007 | acc=0.9219 | L2-Norm=19.238 | L2-Norm(final)=2.255 | 3680.4 samples/s | 57.5 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08064 | Reg=0.00371 | FP-Reg=0.008 | acc=0.9531 | L2-Norm=19.254 | L2-Norm(final)=2.261 | 3720.5 samples/s | 58.1 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.07771 | Reg=0.00371 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.269 | L2-Norm(final)=2.266 | 4142.2 samples/s | 64.7 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07476 | Reg=0.00372 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.283 | L2-Norm(final)=2.272 | 1680.1 samples/s | 26.3 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.07157 | Reg=0.00372 | FP-Reg=0.009 | acc=0.9531 | L2-Norm=19.297 | L2-Norm(final)=2.278 | 3597.6 samples/s | 56.2 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06906 | Reg=0.00373 | FP-Reg=0.009 | acc=0.9844 | L2-Norm=19.309 | L2-Norm(final)=2.284 | 3607.6 samples/s | 56.4 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06707 | Reg=0.00373 | FP-Reg=0.009 | acc=0.9688 | L2-Norm=19.321 | L2-Norm(final)=2.290 | 3843.9 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step1600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.22196 | Reg=0.00362 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=19.016 | L2-Norm(final)=2.216 | 3619.9 samples/s | 56.6 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.16321 | Reg=0.00363 | FP-Reg=0.003 | acc=0.8594 | L2-Norm=19.065 | L2-Norm(final)=2.209 | 3498.2 samples/s | 54.7 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.14562 | Reg=0.00364 | FP-Reg=0.004 | acc=0.8438 | L2-Norm=19.084 | L2-Norm(final)=2.210 | 3645.4 samples/s | 57.0 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.13777 | Reg=0.00365 | FP-Reg=0.004 | acc=0.9219 | L2-Norm=19.108 | L2-Norm(final)=2.214 | 3653.6 samples/s | 57.1 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.12884 | Reg=0.00366 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.131 | L2-Norm(final)=2.218 | 4555.0 samples/s | 71.2 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.11604 | Reg=0.00367 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.152 | L2-Norm(final)=2.226 | 1631.4 samples/s | 25.5 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.10623 | Reg=0.00368 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.172 | L2-Norm(final)=2.236 | 3738.7 samples/s | 58.4 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.10112 | Reg=0.00368 | FP-Reg=0.006 | acc=0.9375 | L2-Norm=19.191 | L2-Norm(final)=2.245 | 3606.4 samples/s | 56.4 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.09597 | Reg=0.00369 | FP-Reg=0.007 | acc=0.9688 | L2-Norm=19.208 | L2-Norm(final)=2.253 | 4236.3 samples/s | 66.2 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.09447 | Reg=0.00370 | FP-Reg=0.007 | acc=0.9062 | L2-Norm=19.227 | L2-Norm(final)=2.259 | 1659.9 samples/s | 25.9 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.09061 | Reg=0.00370 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.246 | L2-Norm(final)=2.265 | 3736.5 samples/s | 58.4 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08688 | Reg=0.00371 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.264 | L2-Norm(final)=2.271 | 3718.9 samples/s | 58.1 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.08310 | Reg=0.00372 | FP-Reg=0.009 | acc=0.9688 | L2-Norm=19.279 | L2-Norm(final)=2.277 | 4171.8 samples/s | 65.2 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07906 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.293 | L2-Norm(final)=2.283 | 1705.0 samples/s | 26.6 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.07517 | Reg=0.00373 | FP-Reg=0.009 | acc=0.9844 | L2-Norm=19.306 | L2-Norm(final)=2.289 | 3693.9 samples/s | 57.7 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07231 | Reg=0.00373 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.317 | L2-Norm(final)=2.296 | 3690.3 samples/s | 57.7 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06985 | Reg=0.00374 | FP-Reg=0.010 | acc=0.9844 | L2-Norm=19.327 | L2-Norm(final)=2.302 | 3935.4 samples/s | 61.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step1600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.23027 | Reg=0.00362 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.016 | L2-Norm(final)=2.217 | 3846.0 samples/s | 60.1 steps/s
[Step= 850 Epoch= 4.2] | Loss=0.15599 | Reg=0.00363 | FP-Reg=0.002 | acc=0.8594 | L2-Norm=19.052 | L2-Norm(final)=2.216 | 3478.6 samples/s | 54.4 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.13752 | Reg=0.00364 | FP-Reg=0.003 | acc=0.8750 | L2-Norm=19.074 | L2-Norm(final)=2.220 | 3704.3 samples/s | 57.9 steps/s
[Step= 950 Epoch= 4.7] | Loss=0.12617 | Reg=0.00364 | FP-Reg=0.004 | acc=0.8750 | L2-Norm=19.091 | L2-Norm(final)=2.225 | 3615.6 samples/s | 56.5 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.11661 | Reg=0.00365 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.107 | L2-Norm(final)=2.230 | 4457.2 samples/s | 69.6 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.10765 | Reg=0.00366 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.125 | L2-Norm(final)=2.236 | 1557.8 samples/s | 24.3 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.10153 | Reg=0.00367 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.149 | L2-Norm(final)=2.243 | 3559.9 samples/s | 55.6 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09552 | Reg=0.00368 | FP-Reg=0.006 | acc=0.9062 | L2-Norm=19.171 | L2-Norm(final)=2.250 | 3632.7 samples/s | 56.8 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.09140 | Reg=0.00368 | FP-Reg=0.006 | acc=0.9219 | L2-Norm=19.191 | L2-Norm(final)=2.256 | 4397.2 samples/s | 68.7 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08552 | Reg=0.00369 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.209 | L2-Norm(final)=2.262 | 1629.5 samples/s | 25.5 steps/s
[Step=1300 Epoch= 6.4] | Loss=0.08099 | Reg=0.00370 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.226 | L2-Norm(final)=2.270 | 3693.7 samples/s | 57.7 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.07791 | Reg=0.00370 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.242 | L2-Norm(final)=2.277 | 3687.1 samples/s | 57.6 steps/s
[Step=1400 Epoch= 6.9] | Loss=0.07543 | Reg=0.00371 | FP-Reg=0.008 | acc=0.9375 | L2-Norm=19.257 | L2-Norm(final)=2.283 | 4249.4 samples/s | 66.4 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07250 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.272 | L2-Norm(final)=2.290 | 1645.5 samples/s | 25.7 steps/s
[Step=1500 Epoch= 7.4] | Loss=0.06974 | Reg=0.00372 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.287 | L2-Norm(final)=2.296 | 3708.8 samples/s | 57.9 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06774 | Reg=0.00373 | FP-Reg=0.009 | acc=0.9844 | L2-Norm=19.300 | L2-Norm(final)=2.302 | 3698.8 samples/s | 57.8 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06554 | Reg=0.00373 | FP-Reg=0.009 | acc=0.9844 | L2-Norm=19.313 | L2-Norm(final)=2.308 | 4133.8 samples/s | 64.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step1600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.26055 | Reg=0.00362 | FP-Reg=0.000 | acc=0.7344 | L2-Norm=19.016 | L2-Norm(final)=2.216 | 3714.4 samples/s | 58.0 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.04647 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.086 | L2-Norm(final)=2.214 | 3371.7 samples/s | 52.7 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.02650 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.094 | L2-Norm(final)=2.222 | 4401.2 samples/s | 68.8 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01799 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.089 | L2-Norm(final)=2.229 | 1592.5 samples/s | 24.9 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01359 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.080 | L2-Norm(final)=2.235 | 4176.7 samples/s | 65.3 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01092 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.071 | L2-Norm(final)=2.240 | 1607.2 samples/s | 25.1 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00914 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.063 | L2-Norm(final)=2.244 | 3826.0 samples/s | 59.8 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00786 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.054 | L2-Norm(final)=2.248 | 1626.7 samples/s | 25.4 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00690 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.047 | L2-Norm(final)=2.251 | 3660.4 samples/s | 57.2 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00616 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.254 | 1688.4 samples/s | 26.4 steps/s
[Step=1300 Epoch=12.3] | Loss=0.00556 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.033 | L2-Norm(final)=2.257 | 3570.8 samples/s | 55.8 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00507 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.028 | L2-Norm(final)=2.259 | 1700.4 samples/s | 26.6 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00467 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.022 | L2-Norm(final)=2.262 | 3501.0 samples/s | 54.7 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00432 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.017 | L2-Norm(final)=2.264 | 1738.6 samples/s | 27.2 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00403 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.013 | L2-Norm(final)=2.267 | 3446.1 samples/s | 53.8 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00378 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.009 | L2-Norm(final)=2.269 | 1750.5 samples/s | 27.4 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00355 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.005 | L2-Norm(final)=2.272 | 3492.6 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step1600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.20686 | Reg=0.00362 | FP-Reg=0.000 | acc=0.7812 | L2-Norm=19.016 | L2-Norm(final)=2.216 | 3460.4 samples/s | 54.1 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.04956 | Reg=0.00367 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.145 | L2-Norm(final)=2.203 | 3518.6 samples/s | 55.0 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.03131 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.164 | L2-Norm(final)=2.200 | 4331.4 samples/s | 67.7 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.02170 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.159 | L2-Norm(final)=2.205 | 1566.5 samples/s | 24.5 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01640 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.211 | 4107.5 samples/s | 64.2 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01317 | Reg=0.00366 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.217 | 1598.6 samples/s | 25.0 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01102 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.125 | L2-Norm(final)=2.222 | 3945.6 samples/s | 61.6 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00947 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.113 | L2-Norm(final)=2.227 | 1645.7 samples/s | 25.7 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00831 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.103 | L2-Norm(final)=2.232 | 3754.6 samples/s | 58.7 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00742 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.093 | L2-Norm(final)=2.236 | 1670.5 samples/s | 26.1 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00669 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.084 | L2-Norm(final)=2.240 | 3578.5 samples/s | 55.9 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00610 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.076 | L2-Norm(final)=2.245 | 1714.5 samples/s | 26.8 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00561 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.068 | L2-Norm(final)=2.248 | 3516.2 samples/s | 54.9 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00519 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.061 | L2-Norm(final)=2.252 | 1733.5 samples/s | 27.1 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00484 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.055 | L2-Norm(final)=2.256 | 3549.9 samples/s | 55.5 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00453 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.049 | L2-Norm(final)=2.259 | 1745.7 samples/s | 27.3 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00426 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.043 | L2-Norm(final)=2.263 | 3460.8 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step1600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.17418 | Reg=0.00362 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.016 | L2-Norm(final)=2.216 | 3668.0 samples/s | 57.3 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.05557 | Reg=0.00366 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.124 | L2-Norm(final)=2.203 | 3364.6 samples/s | 52.6 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.03357 | Reg=0.00367 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.147 | L2-Norm(final)=2.204 | 4412.3 samples/s | 68.9 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.02290 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.145 | L2-Norm(final)=2.211 | 1571.7 samples/s | 24.6 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01725 | Reg=0.00366 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.216 | 4171.2 samples/s | 65.2 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01383 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.122 | L2-Norm(final)=2.221 | 1605.4 samples/s | 25.1 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01155 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.109 | L2-Norm(final)=2.225 | 4094.2 samples/s | 64.0 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00993 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.098 | L2-Norm(final)=2.229 | 1630.6 samples/s | 25.5 steps/s
[Step=1200 Epoch=11.5] | Loss=0.00871 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.087 | L2-Norm(final)=2.233 | 3777.9 samples/s | 59.0 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00776 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.077 | L2-Norm(final)=2.236 | 1640.3 samples/s | 25.6 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00700 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.068 | L2-Norm(final)=2.239 | 3622.1 samples/s | 56.6 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00638 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.060 | L2-Norm(final)=2.243 | 1681.8 samples/s | 26.3 steps/s
[Step=1400 Epoch=13.4] | Loss=0.00587 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.246 | 3516.7 samples/s | 54.9 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00543 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.046 | L2-Norm(final)=2.249 | 1678.8 samples/s | 26.2 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00505 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.252 | 3402.2 samples/s | 53.2 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00473 | Reg=0.00362 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.034 | L2-Norm(final)=2.255 | 1691.0 samples/s | 26.4 steps/s
[Step=1600 Epoch=15.3] | Loss=0.00445 | Reg=0.00362 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.029 | L2-Norm(final)=2.258 | 3588.8 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step1600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.5] | Loss=0.25405 | Reg=0.00362 | FP-Reg=0.000 | acc=0.7656 | L2-Norm=19.016 | L2-Norm(final)=2.215 | 3816.9 samples/s | 59.6 steps/s
[Step= 850 Epoch= 8.0] | Loss=0.06925 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.191 | 3345.5 samples/s | 52.3 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.03789 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.170 | L2-Norm(final)=2.194 | 4433.6 samples/s | 69.3 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.02586 | Reg=0.00367 | FP-Reg=0.007 | acc=0.9688 | L2-Norm=19.163 | L2-Norm(final)=2.202 | 1593.7 samples/s | 24.9 steps/s
[Step=1000 Epoch= 9.4] | Loss=0.01974 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.153 | L2-Norm(final)=2.210 | 4155.2 samples/s | 64.9 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01585 | Reg=0.00366 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.142 | L2-Norm(final)=2.216 | 1632.0 samples/s | 25.5 steps/s
[Step=1100 Epoch=10.4] | Loss=0.01329 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.130 | L2-Norm(final)=2.222 | 3814.6 samples/s | 59.6 steps/s
[Step=1150 Epoch=10.8] | Loss=0.01143 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.120 | L2-Norm(final)=2.226 | 1663.8 samples/s | 26.0 steps/s
[Step=1200 Epoch=11.3] | Loss=0.01002 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.109 | L2-Norm(final)=2.231 | 3589.3 samples/s | 56.1 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00893 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.099 | L2-Norm(final)=2.235 | 1698.8 samples/s | 26.5 steps/s
[Step=1300 Epoch=12.2] | Loss=0.00806 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.090 | L2-Norm(final)=2.238 | 3471.9 samples/s | 54.2 steps/s
[Step=1350 Epoch=12.7] | Loss=0.00735 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.082 | L2-Norm(final)=2.242 | 1725.4 samples/s | 27.0 steps/s
[Step=1400 Epoch=13.2] | Loss=0.00675 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.074 | L2-Norm(final)=2.245 | 3500.2 samples/s | 54.7 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00625 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.067 | L2-Norm(final)=2.249 | 1728.2 samples/s | 27.0 steps/s
[Step=1500 Epoch=14.1] | Loss=0.00582 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.060 | L2-Norm(final)=2.252 | 3521.5 samples/s | 55.0 steps/s
[Step=1550 Epoch=14.6] | Loss=0.00545 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.054 | L2-Norm(final)=2.255 | 1837.7 samples/s | 28.7 steps/s
[Step=1600 Epoch=15.1] | Loss=0.00512 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.049 | L2-Norm(final)=2.258 | 3253.8 samples/s | 50.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step1600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.13370 | Reg=0.00362 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.016 | L2-Norm(final)=2.216 | 3684.1 samples/s | 57.6 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.04647 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.119 | L2-Norm(final)=2.213 | 3319.4 samples/s | 51.9 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.02788 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.132 | L2-Norm(final)=2.223 | 4429.8 samples/s | 69.2 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.01996 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.130 | L2-Norm(final)=2.228 | 1570.7 samples/s | 24.5 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01512 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.122 | L2-Norm(final)=2.233 | 4126.3 samples/s | 64.5 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01217 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.239 | 1619.2 samples/s | 25.3 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01019 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.102 | L2-Norm(final)=2.244 | 4098.6 samples/s | 64.0 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00877 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.092 | L2-Norm(final)=2.248 | 1648.5 samples/s | 25.8 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00769 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.083 | L2-Norm(final)=2.252 | 3915.5 samples/s | 61.2 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00686 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.074 | L2-Norm(final)=2.256 | 1647.4 samples/s | 25.7 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00619 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.066 | L2-Norm(final)=2.259 | 3718.8 samples/s | 58.1 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00565 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.058 | L2-Norm(final)=2.262 | 1693.7 samples/s | 26.5 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00519 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.051 | L2-Norm(final)=2.265 | 3587.0 samples/s | 56.0 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00481 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.045 | L2-Norm(final)=2.268 | 1725.7 samples/s | 27.0 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00448 | Reg=0.00362 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.039 | L2-Norm(final)=2.271 | 3564.2 samples/s | 55.7 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00419 | Reg=0.00362 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.033 | L2-Norm(final)=2.274 | 1731.8 samples/s | 27.1 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00394 | Reg=0.00362 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.028 | L2-Norm(final)=2.277 | 3467.5 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23616 | acc=0.7901 | tpr=0.7241 | fpr=0.0667 | 3817.4 samples/s | 14.9 steps/s
Avg test loss: 0.23879, Avg test acc: 0.78760, Avg tpr: 0.72035, Avg fpr: 0.06448, total FA: 503

Testing server on iccad2012
[Step=  50] | Loss=0.45090 | acc=0.6403 | tpr=0.9558 | fpr=0.3654 | 3822.0 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.44864 | acc=0.6393 | tpr=0.9360 | fpr=0.3662 | 7070.2 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.45084 | acc=0.6389 | tpr=0.9409 | fpr=0.3667 | 7195.6 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.45000 | acc=0.6395 | tpr=0.9399 | fpr=0.3660 | 7510.6 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.44999 | acc=0.6394 | tpr=0.9345 | fpr=0.3660 | 7095.7 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.44914 | acc=0.6396 | tpr=0.9353 | fpr=0.3658 | 7175.5 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.44906 | acc=0.6399 | tpr=0.9336 | fpr=0.3655 | 7379.7 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.44966 | acc=0.6398 | tpr=0.9311 | fpr=0.3655 | 7500.5 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.45176 | acc=0.6393 | tpr=0.9294 | fpr=0.3660 | 6906.8 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.45304 | acc=0.6384 | tpr=0.9322 | fpr=0.3669 | 7125.2 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.45306 | acc=0.6379 | tpr=0.9296 | fpr=0.3674 | 13170.6 samples/s | 51.4 steps/s
Avg test loss: 0.45309, Avg test acc: 0.63797, Avg tpr: 0.92987, Avg fpr: 0.36734, total FA: 51004

server round 2/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.16811 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.081 | L2-Norm(final)=2.337 | 3555.1 samples/s | 55.5 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.10994 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.097 | L2-Norm(final)=2.319 | 3714.7 samples/s | 58.0 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.10060 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.110 | L2-Norm(final)=2.319 | 3673.7 samples/s | 57.4 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.09436 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9062 | L2-Norm=19.126 | L2-Norm(final)=2.323 | 3650.4 samples/s | 57.0 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08782 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.144 | L2-Norm(final)=2.328 | 4489.8 samples/s | 70.2 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07987 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.162 | L2-Norm(final)=2.333 | 1625.7 samples/s | 25.4 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07493 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.181 | L2-Norm(final)=2.339 | 3674.9 samples/s | 57.4 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07252 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.199 | L2-Norm(final)=2.344 | 3586.9 samples/s | 56.0 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06886 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.215 | L2-Norm(final)=2.350 | 4248.0 samples/s | 66.4 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06487 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.231 | L2-Norm(final)=2.355 | 1671.2 samples/s | 26.1 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06139 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.246 | L2-Norm(final)=2.362 | 3722.5 samples/s | 58.2 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05938 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.259 | L2-Norm(final)=2.367 | 3652.4 samples/s | 57.1 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05711 | Reg=0.00371 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.272 | L2-Norm(final)=2.373 | 3977.1 samples/s | 62.1 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05471 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.283 | L2-Norm(final)=2.378 | 1651.4 samples/s | 25.8 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05240 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.294 | L2-Norm(final)=2.383 | 3639.4 samples/s | 56.9 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05094 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.305 | L2-Norm(final)=2.389 | 3613.5 samples/s | 56.5 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04926 | Reg=0.00373 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.315 | L2-Norm(final)=2.394 | 3891.1 samples/s | 60.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step2400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.19764 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.081 | L2-Norm(final)=2.337 | 3834.1 samples/s | 59.9 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.10090 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9062 | L2-Norm=19.099 | L2-Norm(final)=2.325 | 3478.3 samples/s | 54.3 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.09476 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.110 | L2-Norm(final)=2.326 | 3612.7 samples/s | 56.4 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.08881 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.125 | L2-Norm(final)=2.330 | 3612.4 samples/s | 56.4 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08562 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9062 | L2-Norm=19.141 | L2-Norm(final)=2.333 | 4497.2 samples/s | 70.3 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07664 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.156 | L2-Norm(final)=2.338 | 1641.2 samples/s | 25.6 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07153 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.174 | L2-Norm(final)=2.345 | 3688.1 samples/s | 57.6 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.06880 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.192 | L2-Norm(final)=2.352 | 3662.1 samples/s | 57.2 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06640 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.209 | L2-Norm(final)=2.356 | 4292.2 samples/s | 67.1 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06204 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.226 | L2-Norm(final)=2.362 | 1603.5 samples/s | 25.1 steps/s
[Step=2100 Epoch=10.2] | Loss=0.05860 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.241 | L2-Norm(final)=2.368 | 3548.2 samples/s | 55.4 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05628 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.254 | L2-Norm(final)=2.373 | 3537.5 samples/s | 55.3 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05502 | Reg=0.00371 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.267 | L2-Norm(final)=2.377 | 4036.2 samples/s | 63.1 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05296 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.280 | L2-Norm(final)=2.381 | 1632.5 samples/s | 25.5 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05123 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9375 | L2-Norm=19.292 | L2-Norm(final)=2.386 | 3556.3 samples/s | 55.6 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04994 | Reg=0.00373 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.303 | L2-Norm(final)=2.390 | 3540.4 samples/s | 55.3 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04893 | Reg=0.00373 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.314 | L2-Norm(final)=2.393 | 3985.9 samples/s | 62.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step2400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.25407 | Reg=0.00364 | FP-Reg=0.000 | acc=0.7812 | L2-Norm=19.081 | L2-Norm(final)=2.337 | 3780.7 samples/s | 59.1 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.11432 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.098 | L2-Norm(final)=2.317 | 3564.5 samples/s | 55.7 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.10327 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.113 | L2-Norm(final)=2.316 | 3617.1 samples/s | 56.5 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.09513 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.133 | L2-Norm(final)=2.321 | 3617.2 samples/s | 56.5 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09160 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.152 | L2-Norm(final)=2.326 | 4451.7 samples/s | 69.6 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08293 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.173 | L2-Norm(final)=2.331 | 1611.6 samples/s | 25.2 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07766 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.193 | L2-Norm(final)=2.338 | 3618.9 samples/s | 56.5 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07278 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9219 | L2-Norm=19.211 | L2-Norm(final)=2.344 | 3625.1 samples/s | 56.6 steps/s
[Step=2000 Epoch= 9.7] | Loss=0.06945 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.227 | L2-Norm(final)=2.350 | 4314.2 samples/s | 67.4 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06792 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.243 | L2-Norm(final)=2.354 | 1659.0 samples/s | 25.9 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06410 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.260 | L2-Norm(final)=2.359 | 3661.6 samples/s | 57.2 steps/s
[Step=2150 Epoch=10.5] | Loss=0.06194 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.275 | L2-Norm(final)=2.364 | 3667.7 samples/s | 57.3 steps/s
[Step=2200 Epoch=10.7] | Loss=0.06069 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.290 | L2-Norm(final)=2.368 | 4043.4 samples/s | 63.2 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05839 | Reg=0.00373 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.305 | L2-Norm(final)=2.372 | 1667.5 samples/s | 26.1 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05582 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.318 | L2-Norm(final)=2.377 | 3594.5 samples/s | 56.2 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05380 | Reg=0.00374 | FP-Reg=0.007 | acc=0.9688 | L2-Norm=19.330 | L2-Norm(final)=2.381 | 3586.7 samples/s | 56.0 steps/s
[Step=2400 Epoch=11.7] | Loss=0.05217 | Reg=0.00374 | FP-Reg=0.007 | acc=0.9688 | L2-Norm=19.341 | L2-Norm(final)=2.386 | 3943.0 samples/s | 61.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step2400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.08253 | Reg=0.00364 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.081 | L2-Norm(final)=2.338 | 3741.1 samples/s | 58.5 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.10200 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.099 | L2-Norm(final)=2.327 | 3625.2 samples/s | 56.6 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.09646 | Reg=0.00365 | FP-Reg=0.002 | acc=0.8906 | L2-Norm=19.113 | L2-Norm(final)=2.331 | 3662.0 samples/s | 57.2 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.09104 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.127 | L2-Norm(final)=2.333 | 3650.5 samples/s | 57.0 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08459 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.143 | L2-Norm(final)=2.338 | 4517.2 samples/s | 70.6 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07729 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.159 | L2-Norm(final)=2.342 | 1618.8 samples/s | 25.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07063 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.176 | L2-Norm(final)=2.350 | 3523.9 samples/s | 55.1 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.06734 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.193 | L2-Norm(final)=2.357 | 3600.4 samples/s | 56.3 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06543 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.209 | L2-Norm(final)=2.363 | 4260.1 samples/s | 66.6 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06191 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.225 | L2-Norm(final)=2.369 | 1652.1 samples/s | 25.8 steps/s
[Step=2100 Epoch=10.2] | Loss=0.05937 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.240 | L2-Norm(final)=2.375 | 3670.9 samples/s | 57.4 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05684 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.254 | L2-Norm(final)=2.381 | 3651.6 samples/s | 57.1 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05464 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.267 | L2-Norm(final)=2.386 | 4092.3 samples/s | 63.9 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05271 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.279 | L2-Norm(final)=2.391 | 1691.3 samples/s | 26.4 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05052 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.290 | L2-Norm(final)=2.397 | 3695.2 samples/s | 57.7 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04917 | Reg=0.00373 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.301 | L2-Norm(final)=2.401 | 3680.8 samples/s | 57.5 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04776 | Reg=0.00373 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.310 | L2-Norm(final)=2.406 | 3925.8 samples/s | 61.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step2400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.9] | Loss=0.12799 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.081 | L2-Norm(final)=2.338 | 4150.6 samples/s | 64.9 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.08671 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.096 | L2-Norm(final)=2.334 | 3264.9 samples/s | 51.0 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.09370 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.110 | L2-Norm(final)=2.332 | 3726.6 samples/s | 58.2 steps/s
[Step=1750 Epoch= 8.6] | Loss=0.08800 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.128 | L2-Norm(final)=2.333 | 3755.8 samples/s | 58.7 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08442 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.144 | L2-Norm(final)=2.337 | 4636.1 samples/s | 72.4 steps/s
[Step=1850 Epoch= 9.1] | Loss=0.07632 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.162 | L2-Norm(final)=2.341 | 1592.6 samples/s | 24.9 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07198 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.180 | L2-Norm(final)=2.348 | 3553.1 samples/s | 55.5 steps/s
[Step=1950 Epoch= 9.6] | Loss=0.06881 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.197 | L2-Norm(final)=2.354 | 3568.0 samples/s | 55.8 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06543 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.213 | L2-Norm(final)=2.360 | 4386.1 samples/s | 68.5 steps/s
[Step=2050 Epoch=10.1] | Loss=0.06230 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.229 | L2-Norm(final)=2.366 | 1641.3 samples/s | 25.6 steps/s
[Step=2100 Epoch=10.3] | Loss=0.05879 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.244 | L2-Norm(final)=2.372 | 3661.3 samples/s | 57.2 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05562 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.258 | L2-Norm(final)=2.378 | 3676.9 samples/s | 57.5 steps/s
[Step=2200 Epoch=10.8] | Loss=0.05373 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.271 | L2-Norm(final)=2.384 | 4282.2 samples/s | 66.9 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05212 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.282 | L2-Norm(final)=2.389 | 1648.1 samples/s | 25.8 steps/s
[Step=2300 Epoch=11.3] | Loss=0.05020 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.294 | L2-Norm(final)=2.394 | 3629.3 samples/s | 56.7 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04871 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.305 | L2-Norm(final)=2.398 | 3730.4 samples/s | 58.3 steps/s
[Step=2400 Epoch=11.8] | Loss=0.04794 | Reg=0.00373 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.315 | L2-Norm(final)=2.403 | 4245.2 samples/s | 66.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step2400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.19018 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.081 | L2-Norm(final)=2.337 | 3614.2 samples/s | 56.5 steps/s
[Step=1650 Epoch=15.6] | Loss=0.05302 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.218 | L2-Norm(final)=2.287 | 3374.2 samples/s | 52.7 steps/s
[Step=1700 Epoch=16.1] | Loss=0.02810 | Reg=0.00370 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.244 | L2-Norm(final)=2.288 | 4319.7 samples/s | 67.5 steps/s
[Step=1750 Epoch=16.6] | Loss=0.01947 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=2.293 | 1553.4 samples/s | 24.3 steps/s
[Step=1800 Epoch=17.1] | Loss=0.01531 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.224 | L2-Norm(final)=2.297 | 4058.1 samples/s | 63.4 steps/s
[Step=1850 Epoch=17.5] | Loss=0.01252 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.216 | L2-Norm(final)=2.301 | 1591.1 samples/s | 24.9 steps/s
[Step=1900 Epoch=18.0] | Loss=0.01046 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.207 | L2-Norm(final)=2.306 | 3882.0 samples/s | 60.7 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00897 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.196 | L2-Norm(final)=2.310 | 1646.6 samples/s | 25.7 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00788 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.186 | L2-Norm(final)=2.313 | 3747.5 samples/s | 58.6 steps/s
[Step=2050 Epoch=19.4] | Loss=0.00701 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.176 | L2-Norm(final)=2.317 | 1670.8 samples/s | 26.1 steps/s
[Step=2100 Epoch=19.9] | Loss=0.00632 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.167 | L2-Norm(final)=2.320 | 3478.5 samples/s | 54.4 steps/s
[Step=2150 Epoch=20.4] | Loss=0.00575 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.158 | L2-Norm(final)=2.322 | 1695.5 samples/s | 26.5 steps/s
[Step=2200 Epoch=20.8] | Loss=0.00528 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.325 | 3544.0 samples/s | 55.4 steps/s
[Step=2250 Epoch=21.3] | Loss=0.00488 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.141 | L2-Norm(final)=2.328 | 1750.4 samples/s | 27.3 steps/s
[Step=2300 Epoch=21.8] | Loss=0.00454 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.133 | L2-Norm(final)=2.330 | 3560.2 samples/s | 55.6 steps/s
[Step=2350 Epoch=22.3] | Loss=0.00424 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.126 | L2-Norm(final)=2.332 | 1748.5 samples/s | 27.3 steps/s
[Step=2400 Epoch=22.7] | Loss=0.00398 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.119 | L2-Norm(final)=2.335 | 3397.4 samples/s | 53.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step2400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.21501 | Reg=0.00364 | FP-Reg=0.000 | acc=0.7812 | L2-Norm=19.081 | L2-Norm(final)=2.336 | 3657.6 samples/s | 57.2 steps/s
[Step=1650 Epoch=15.7] | Loss=0.06075 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.264 | L2-Norm(final)=2.275 | 3399.7 samples/s | 53.1 steps/s
[Step=1700 Epoch=16.2] | Loss=0.03377 | Reg=0.00372 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.278 | L2-Norm(final)=2.277 | 4377.9 samples/s | 68.4 steps/s
[Step=1750 Epoch=16.6] | Loss=0.02309 | Reg=0.00371 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.267 | L2-Norm(final)=2.286 | 1578.8 samples/s | 24.7 steps/s
[Step=1800 Epoch=17.1] | Loss=0.01739 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.251 | L2-Norm(final)=2.294 | 4117.7 samples/s | 64.3 steps/s
[Step=1850 Epoch=17.6] | Loss=0.01401 | Reg=0.00370 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=2.300 | 1595.8 samples/s | 24.9 steps/s
[Step=1900 Epoch=18.1] | Loss=0.01171 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.307 | 3938.9 samples/s | 61.5 steps/s
[Step=1950 Epoch=18.5] | Loss=0.01006 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.206 | L2-Norm(final)=2.312 | 1656.0 samples/s | 25.9 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00882 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.317 | 3757.8 samples/s | 58.7 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00786 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.180 | L2-Norm(final)=2.321 | 1694.4 samples/s | 26.5 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00709 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.169 | L2-Norm(final)=2.325 | 3605.4 samples/s | 56.3 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00646 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.159 | L2-Norm(final)=2.329 | 1709.7 samples/s | 26.7 steps/s
[Step=2200 Epoch=20.9] | Loss=0.00593 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.332 | 3422.8 samples/s | 53.5 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00549 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.141 | L2-Norm(final)=2.336 | 1731.1 samples/s | 27.0 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00511 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.133 | L2-Norm(final)=2.339 | 3494.0 samples/s | 54.6 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00478 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.125 | L2-Norm(final)=2.343 | 1743.9 samples/s | 27.2 steps/s
[Step=2400 Epoch=22.8] | Loss=0.00449 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.118 | L2-Norm(final)=2.346 | 3431.6 samples/s | 53.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step2400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.3] | Loss=0.17832 | Reg=0.00364 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=19.081 | L2-Norm(final)=2.336 | 3680.6 samples/s | 57.5 steps/s
[Step=1650 Epoch=15.8] | Loss=0.03355 | Reg=0.00368 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.177 | L2-Norm(final)=2.302 | 3265.7 samples/s | 51.0 steps/s
[Step=1700 Epoch=16.2] | Loss=0.02246 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.298 | 4496.7 samples/s | 70.3 steps/s
[Step=1750 Epoch=16.7] | Loss=0.01515 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.198 | L2-Norm(final)=2.299 | 1572.0 samples/s | 24.6 steps/s
[Step=1800 Epoch=17.2] | Loss=0.01153 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.302 | 4268.1 samples/s | 66.7 steps/s
[Step=1850 Epoch=17.7] | Loss=0.00935 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.184 | L2-Norm(final)=2.305 | 1611.5 samples/s | 25.2 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00780 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.174 | L2-Norm(final)=2.308 | 4075.5 samples/s | 63.7 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00670 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.164 | L2-Norm(final)=2.311 | 1638.7 samples/s | 25.6 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00588 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.154 | L2-Norm(final)=2.314 | 3867.0 samples/s | 60.4 steps/s
[Step=2050 Epoch=19.6] | Loss=0.00523 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.145 | L2-Norm(final)=2.317 | 1646.3 samples/s | 25.7 steps/s
[Step=2100 Epoch=20.1] | Loss=0.00472 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.136 | L2-Norm(final)=2.319 | 3741.0 samples/s | 58.5 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00430 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.127 | L2-Norm(final)=2.322 | 1684.1 samples/s | 26.3 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00395 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.120 | L2-Norm(final)=2.325 | 3571.9 samples/s | 55.8 steps/s
[Step=2250 Epoch=21.5] | Loss=0.00365 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.327 | 1727.5 samples/s | 27.0 steps/s
[Step=2300 Epoch=22.0] | Loss=0.00339 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.105 | L2-Norm(final)=2.330 | 3567.7 samples/s | 55.7 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00317 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.099 | L2-Norm(final)=2.332 | 1716.2 samples/s | 26.8 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00298 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.093 | L2-Norm(final)=2.334 | 3531.0 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step2400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.1] | Loss=0.35604 | Reg=0.00364 | FP-Reg=0.000 | acc=0.6875 | L2-Norm=19.081 | L2-Norm(final)=2.334 | 3591.3 samples/s | 56.1 steps/s
[Step=1650 Epoch=15.5] | Loss=0.03879 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.190 | L2-Norm(final)=2.284 | 3383.3 samples/s | 52.9 steps/s
[Step=1700 Epoch=16.0] | Loss=0.02601 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.196 | L2-Norm(final)=2.280 | 4298.9 samples/s | 67.2 steps/s
[Step=1750 Epoch=16.5] | Loss=0.01805 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.190 | L2-Norm(final)=2.283 | 1591.0 samples/s | 24.9 steps/s
[Step=1800 Epoch=17.0] | Loss=0.01363 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.179 | L2-Norm(final)=2.289 | 4035.1 samples/s | 63.0 steps/s
[Step=1850 Epoch=17.4] | Loss=0.01094 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.168 | L2-Norm(final)=2.294 | 1618.9 samples/s | 25.3 steps/s
[Step=1900 Epoch=17.9] | Loss=0.00914 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.156 | L2-Norm(final)=2.299 | 3832.1 samples/s | 59.9 steps/s
[Step=1950 Epoch=18.4] | Loss=0.00786 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.145 | L2-Norm(final)=2.303 | 1671.0 samples/s | 26.1 steps/s
[Step=2000 Epoch=18.8] | Loss=0.00689 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.135 | L2-Norm(final)=2.307 | 3595.5 samples/s | 56.2 steps/s
[Step=2050 Epoch=19.3] | Loss=0.00614 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.126 | L2-Norm(final)=2.311 | 1715.2 samples/s | 26.8 steps/s
[Step=2100 Epoch=19.8] | Loss=0.00554 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.117 | L2-Norm(final)=2.315 | 3454.1 samples/s | 54.0 steps/s
[Step=2150 Epoch=20.3] | Loss=0.00504 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.109 | L2-Norm(final)=2.318 | 1731.8 samples/s | 27.1 steps/s
[Step=2200 Epoch=20.7] | Loss=0.00463 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.102 | L2-Norm(final)=2.321 | 3497.0 samples/s | 54.6 steps/s
[Step=2250 Epoch=21.2] | Loss=0.00429 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.095 | L2-Norm(final)=2.324 | 1755.6 samples/s | 27.4 steps/s
[Step=2300 Epoch=21.7] | Loss=0.00399 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.088 | L2-Norm(final)=2.328 | 3527.4 samples/s | 55.1 steps/s
[Step=2350 Epoch=22.1] | Loss=0.00373 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.083 | L2-Norm(final)=2.331 | 1836.0 samples/s | 28.7 steps/s
[Step=2400 Epoch=22.6] | Loss=0.00350 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.077 | L2-Norm(final)=2.333 | 3246.7 samples/s | 50.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step2400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.3] | Loss=0.16093 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.081 | L2-Norm(final)=2.338 | 3613.0 samples/s | 56.5 steps/s
[Step=1650 Epoch=15.7] | Loss=0.03660 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.215 | L2-Norm(final)=2.309 | 3399.9 samples/s | 53.1 steps/s
[Step=1700 Epoch=16.2] | Loss=0.02031 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=2.315 | 4494.4 samples/s | 70.2 steps/s
[Step=1750 Epoch=16.7] | Loss=0.01426 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.226 | L2-Norm(final)=2.321 | 1580.5 samples/s | 24.7 steps/s
[Step=1800 Epoch=17.2] | Loss=0.01085 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.214 | L2-Norm(final)=2.328 | 4284.0 samples/s | 66.9 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00872 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.201 | L2-Norm(final)=2.334 | 1606.4 samples/s | 25.1 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00728 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.188 | L2-Norm(final)=2.339 | 4097.7 samples/s | 64.0 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00627 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.175 | L2-Norm(final)=2.343 | 1616.4 samples/s | 25.3 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00550 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.163 | L2-Norm(final)=2.347 | 3761.7 samples/s | 58.8 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00491 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.153 | L2-Norm(final)=2.350 | 1666.8 samples/s | 26.0 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00443 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.143 | L2-Norm(final)=2.354 | 3739.8 samples/s | 58.4 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00403 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.357 | 1688.7 samples/s | 26.4 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00371 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.125 | L2-Norm(final)=2.360 | 3543.4 samples/s | 55.4 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00343 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.117 | L2-Norm(final)=2.362 | 1703.9 samples/s | 26.6 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00319 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.110 | L2-Norm(final)=2.365 | 3485.5 samples/s | 54.5 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00299 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.103 | L2-Norm(final)=2.368 | 1740.1 samples/s | 27.2 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00281 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.097 | L2-Norm(final)=2.370 | 3571.3 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19811 | acc=0.8334 | tpr=0.7845 | fpr=0.0602 | 3831.9 samples/s | 15.0 steps/s
Avg test loss: 0.19977, Avg test acc: 0.83300, Avg tpr: 0.78277, Avg fpr: 0.05653, total FA: 441

Testing server on iccad2012
[Step=  50] | Loss=0.56726 | acc=0.6074 | tpr=0.9558 | fpr=0.3988 | 3795.3 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.56361 | acc=0.6096 | tpr=0.9595 | fpr=0.3969 | 7694.7 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.56683 | acc=0.6112 | tpr=0.9683 | fpr=0.3953 | 6716.4 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.56538 | acc=0.6134 | tpr=0.9716 | fpr=0.3931 | 6952.0 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.56491 | acc=0.6140 | tpr=0.9668 | fpr=0.3924 | 6802.8 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.56312 | acc=0.6142 | tpr=0.9658 | fpr=0.3923 | 7264.2 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.56303 | acc=0.6147 | tpr=0.9662 | fpr=0.3917 | 7336.4 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.56350 | acc=0.6141 | tpr=0.9633 | fpr=0.3923 | 7198.8 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.56625 | acc=0.6137 | tpr=0.9640 | fpr=0.3927 | 6797.4 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.56816 | acc=0.6132 | tpr=0.9648 | fpr=0.3932 | 7245.1 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.56811 | acc=0.6134 | tpr=0.9646 | fpr=0.3930 | 13371.8 samples/s | 52.2 steps/s
Avg test loss: 0.56811, Avg test acc: 0.61335, Avg tpr: 0.96474, Avg fpr: 0.39303, total FA: 54572

server round 3/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.19378 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.124 | L2-Norm(final)=2.419 | 3663.6 samples/s | 57.2 steps/s
[Step=2450 Epoch=11.9] | Loss=0.08731 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=19.129 | L2-Norm(final)=2.401 | 3702.8 samples/s | 57.9 steps/s
[Step=2500 Epoch=12.2] | Loss=0.07935 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.144 | L2-Norm(final)=2.401 | 3680.3 samples/s | 57.5 steps/s
[Step=2550 Epoch=12.4] | Loss=0.07478 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9062 | L2-Norm=19.158 | L2-Norm(final)=2.402 | 3634.1 samples/s | 56.8 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07229 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.174 | L2-Norm(final)=2.405 | 4465.4 samples/s | 69.8 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06547 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.191 | L2-Norm(final)=2.408 | 1614.0 samples/s | 25.2 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06071 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.207 | L2-Norm(final)=2.414 | 3624.9 samples/s | 56.6 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05757 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.222 | L2-Norm(final)=2.418 | 3612.2 samples/s | 56.4 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05472 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.235 | L2-Norm(final)=2.423 | 4231.9 samples/s | 66.1 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05163 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.248 | L2-Norm(final)=2.429 | 1645.0 samples/s | 25.7 steps/s
[Step=2900 Epoch=14.1] | Loss=0.04964 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.262 | L2-Norm(final)=2.434 | 3606.8 samples/s | 56.4 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04807 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.275 | L2-Norm(final)=2.438 | 3656.2 samples/s | 57.1 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04671 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.288 | L2-Norm(final)=2.443 | 4063.7 samples/s | 63.5 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04714 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.302 | L2-Norm(final)=2.446 | 1680.3 samples/s | 26.3 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04668 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.320 | L2-Norm(final)=2.448 | 3609.2 samples/s | 56.4 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04613 | Reg=0.00374 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.336 | L2-Norm(final)=2.450 | 3615.5 samples/s | 56.5 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04534 | Reg=0.00374 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.350 | L2-Norm(final)=2.451 | 3840.6 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step3200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.10058 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.124 | L2-Norm(final)=2.419 | 3828.2 samples/s | 59.8 steps/s
[Step=2450 Epoch=12.0] | Loss=0.08529 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.126 | L2-Norm(final)=2.402 | 3533.4 samples/s | 55.2 steps/s
[Step=2500 Epoch=12.2] | Loss=0.07199 | Reg=0.00366 | FP-Reg=0.002 | acc=0.8281 | L2-Norm=19.134 | L2-Norm(final)=2.404 | 3595.3 samples/s | 56.2 steps/s
[Step=2550 Epoch=12.4] | Loss=0.06953 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.146 | L2-Norm(final)=2.405 | 3563.5 samples/s | 55.7 steps/s
[Step=2600 Epoch=12.7] | Loss=0.06702 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.158 | L2-Norm(final)=2.406 | 4442.6 samples/s | 69.4 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06093 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.173 | L2-Norm(final)=2.407 | 1626.8 samples/s | 25.4 steps/s
[Step=2700 Epoch=13.2] | Loss=0.05615 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.189 | L2-Norm(final)=2.412 | 3681.4 samples/s | 57.5 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05367 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.204 | L2-Norm(final)=2.415 | 3667.1 samples/s | 57.3 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05158 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.219 | L2-Norm(final)=2.420 | 4342.1 samples/s | 67.8 steps/s
[Step=2850 Epoch=13.9] | Loss=0.04872 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.233 | L2-Norm(final)=2.424 | 1653.7 samples/s | 25.8 steps/s
[Step=2900 Epoch=14.2] | Loss=0.04670 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.246 | L2-Norm(final)=2.428 | 3586.0 samples/s | 56.0 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04569 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9219 | L2-Norm=19.258 | L2-Norm(final)=2.431 | 3594.4 samples/s | 56.2 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04460 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.270 | L2-Norm(final)=2.434 | 4111.8 samples/s | 64.2 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04295 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.281 | L2-Norm(final)=2.437 | 1653.9 samples/s | 25.8 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04196 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.292 | L2-Norm(final)=2.440 | 3627.2 samples/s | 56.7 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04088 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.301 | L2-Norm(final)=2.442 | 3617.3 samples/s | 56.5 steps/s
[Step=3200 Epoch=15.6] | Loss=0.03989 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.310 | L2-Norm(final)=2.445 | 3935.7 samples/s | 61.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step3200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.18749 | Reg=0.00366 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=19.124 | L2-Norm(final)=2.419 | 3726.1 samples/s | 58.2 steps/s
[Step=2450 Epoch=11.9] | Loss=0.07842 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.123 | L2-Norm(final)=2.404 | 3533.3 samples/s | 55.2 steps/s
[Step=2500 Epoch=12.2] | Loss=0.07937 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.133 | L2-Norm(final)=2.401 | 3616.2 samples/s | 56.5 steps/s
[Step=2550 Epoch=12.4] | Loss=0.07462 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.150 | L2-Norm(final)=2.401 | 3594.5 samples/s | 56.2 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07141 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.167 | L2-Norm(final)=2.403 | 4465.1 samples/s | 69.8 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06566 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.183 | L2-Norm(final)=2.406 | 1615.9 samples/s | 25.2 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06052 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.200 | L2-Norm(final)=2.411 | 3725.2 samples/s | 58.2 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05752 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.215 | L2-Norm(final)=2.417 | 3727.3 samples/s | 58.2 steps/s
[Step=2800 Epoch=13.6] | Loss=0.05485 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.230 | L2-Norm(final)=2.423 | 4385.7 samples/s | 68.5 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05236 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.244 | L2-Norm(final)=2.428 | 1621.5 samples/s | 25.3 steps/s
[Step=2900 Epoch=14.1] | Loss=0.05010 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.258 | L2-Norm(final)=2.433 | 3503.3 samples/s | 54.7 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04792 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.271 | L2-Norm(final)=2.438 | 3537.0 samples/s | 55.3 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04670 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.283 | L2-Norm(final)=2.442 | 3997.6 samples/s | 62.5 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04558 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.295 | L2-Norm(final)=2.445 | 1698.4 samples/s | 26.5 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04416 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.307 | L2-Norm(final)=2.448 | 3641.1 samples/s | 56.9 steps/s
[Step=3150 Epoch=15.3] | Loss=0.04302 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.318 | L2-Norm(final)=2.451 | 3657.9 samples/s | 57.2 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04206 | Reg=0.00374 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.329 | L2-Norm(final)=2.454 | 3959.1 samples/s | 61.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step3200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.09834 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.124 | L2-Norm(final)=2.419 | 3762.0 samples/s | 58.8 steps/s
[Step=2450 Epoch=11.9] | Loss=0.08168 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.133 | L2-Norm(final)=2.403 | 3490.3 samples/s | 54.5 steps/s
[Step=2500 Epoch=12.2] | Loss=0.07545 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.145 | L2-Norm(final)=2.405 | 3724.9 samples/s | 58.2 steps/s
[Step=2550 Epoch=12.4] | Loss=0.07392 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.160 | L2-Norm(final)=2.406 | 3724.5 samples/s | 58.2 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07166 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.175 | L2-Norm(final)=2.407 | 4648.1 samples/s | 72.6 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06415 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.190 | L2-Norm(final)=2.410 | 1541.7 samples/s | 24.1 steps/s
[Step=2700 Epoch=13.2] | Loss=0.05894 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.205 | L2-Norm(final)=2.417 | 3479.9 samples/s | 54.4 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05590 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.218 | L2-Norm(final)=2.422 | 3392.5 samples/s | 53.0 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05304 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.231 | L2-Norm(final)=2.428 | 3962.4 samples/s | 61.9 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05034 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.245 | L2-Norm(final)=2.435 | 1576.3 samples/s | 24.6 steps/s
[Step=2900 Epoch=14.1] | Loss=0.04808 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.258 | L2-Norm(final)=2.440 | 3495.2 samples/s | 54.6 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04744 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.270 | L2-Norm(final)=2.445 | 3491.9 samples/s | 54.6 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04595 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.284 | L2-Norm(final)=2.449 | 3863.4 samples/s | 60.4 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04433 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.295 | L2-Norm(final)=2.453 | 1606.7 samples/s | 25.1 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04330 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.306 | L2-Norm(final)=2.456 | 3503.3 samples/s | 54.7 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04202 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.316 | L2-Norm(final)=2.459 | 3505.6 samples/s | 54.8 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04062 | Reg=0.00374 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.326 | L2-Norm(final)=2.462 | 3753.4 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step3200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.8] | Loss=0.15688 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.124 | L2-Norm(final)=2.419 | 3729.9 samples/s | 58.3 steps/s
[Step=2450 Epoch=12.0] | Loss=0.08442 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.124 | L2-Norm(final)=2.394 | 3352.2 samples/s | 52.4 steps/s
[Step=2500 Epoch=12.3] | Loss=0.07527 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.133 | L2-Norm(final)=2.396 | 3518.1 samples/s | 55.0 steps/s
[Step=2550 Epoch=12.5] | Loss=0.07350 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.147 | L2-Norm(final)=2.397 | 3515.9 samples/s | 54.9 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07078 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.162 | L2-Norm(final)=2.397 | 4402.9 samples/s | 68.8 steps/s
[Step=2650 Epoch=13.0] | Loss=0.06502 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.180 | L2-Norm(final)=2.399 | 1544.8 samples/s | 24.1 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06016 | Reg=0.00369 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.197 | L2-Norm(final)=2.405 | 3523.8 samples/s | 55.1 steps/s
[Step=2750 Epoch=13.5] | Loss=0.05741 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.213 | L2-Norm(final)=2.411 | 3514.4 samples/s | 54.9 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05457 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.227 | L2-Norm(final)=2.415 | 4251.1 samples/s | 66.4 steps/s
[Step=2850 Epoch=14.0] | Loss=0.05230 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.241 | L2-Norm(final)=2.420 | 1520.8 samples/s | 23.8 steps/s
[Step=2900 Epoch=14.2] | Loss=0.04963 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.254 | L2-Norm(final)=2.424 | 3201.0 samples/s | 50.0 steps/s
[Step=2950 Epoch=14.5] | Loss=0.04727 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.266 | L2-Norm(final)=2.429 | 3369.2 samples/s | 52.6 steps/s
[Step=3000 Epoch=14.7] | Loss=0.04622 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.277 | L2-Norm(final)=2.433 | 3958.1 samples/s | 61.8 steps/s
[Step=3050 Epoch=15.0] | Loss=0.04406 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.288 | L2-Norm(final)=2.437 | 1453.3 samples/s | 22.7 steps/s
[Step=3100 Epoch=15.2] | Loss=0.04199 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.298 | L2-Norm(final)=2.442 | 3482.0 samples/s | 54.4 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04097 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.306 | L2-Norm(final)=2.446 | 3476.7 samples/s | 54.3 steps/s
[Step=3200 Epoch=15.7] | Loss=0.03962 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.315 | L2-Norm(final)=2.450 | 3874.7 samples/s | 60.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step3200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.31743 | Reg=0.00366 | FP-Reg=0.000 | acc=0.7812 | L2-Norm=19.124 | L2-Norm(final)=2.418 | 3551.8 samples/s | 55.5 steps/s
[Step=2450 Epoch=23.2] | Loss=0.03351 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.218 | L2-Norm(final)=2.372 | 3236.4 samples/s | 50.6 steps/s
[Step=2500 Epoch=23.7] | Loss=0.01918 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.222 | L2-Norm(final)=2.372 | 4230.9 samples/s | 66.1 steps/s
[Step=2550 Epoch=24.2] | Loss=0.01308 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.211 | L2-Norm(final)=2.375 | 1499.5 samples/s | 23.4 steps/s
[Step=2600 Epoch=24.6] | Loss=0.00990 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.198 | L2-Norm(final)=2.379 | 3940.3 samples/s | 61.6 steps/s
[Step=2650 Epoch=25.1] | Loss=0.00812 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.186 | L2-Norm(final)=2.382 | 1546.5 samples/s | 24.2 steps/s
[Step=2700 Epoch=25.6] | Loss=0.00679 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.176 | L2-Norm(final)=2.386 | 3718.6 samples/s | 58.1 steps/s
[Step=2750 Epoch=26.1] | Loss=0.00582 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.166 | L2-Norm(final)=2.389 | 1583.6 samples/s | 24.7 steps/s
[Step=2800 Epoch=26.5] | Loss=0.00510 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.392 | 3586.7 samples/s | 56.0 steps/s
[Step=2850 Epoch=27.0] | Loss=0.00455 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.395 | 1623.1 samples/s | 25.4 steps/s
[Step=2900 Epoch=27.5] | Loss=0.00410 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.140 | L2-Norm(final)=2.397 | 3374.7 samples/s | 52.7 steps/s
[Step=2950 Epoch=28.0] | Loss=0.00373 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.133 | L2-Norm(final)=2.400 | 1652.4 samples/s | 25.8 steps/s
[Step=3000 Epoch=28.4] | Loss=0.00343 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.126 | L2-Norm(final)=2.402 | 3364.2 samples/s | 52.6 steps/s
[Step=3050 Epoch=28.9] | Loss=0.00317 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.119 | L2-Norm(final)=2.404 | 1667.4 samples/s | 26.1 steps/s
[Step=3100 Epoch=29.4] | Loss=0.00295 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.114 | L2-Norm(final)=2.406 | 3352.8 samples/s | 52.4 steps/s
[Step=3150 Epoch=29.8] | Loss=0.00276 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.108 | L2-Norm(final)=2.408 | 1665.8 samples/s | 26.0 steps/s
[Step=3200 Epoch=30.3] | Loss=0.00259 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.103 | L2-Norm(final)=2.410 | 3339.9 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step3200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.11604 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.124 | L2-Norm(final)=2.420 | 3475.6 samples/s | 54.3 steps/s
[Step=2450 Epoch=23.3] | Loss=0.04221 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.278 | L2-Norm(final)=2.355 | 3249.8 samples/s | 50.8 steps/s
[Step=2500 Epoch=23.8] | Loss=0.02513 | Reg=0.00372 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.289 | L2-Norm(final)=2.351 | 4263.1 samples/s | 66.6 steps/s
[Step=2550 Epoch=24.3] | Loss=0.01692 | Reg=0.00372 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.279 | L2-Norm(final)=2.356 | 1524.2 samples/s | 23.8 steps/s
[Step=2600 Epoch=24.7] | Loss=0.01301 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.264 | L2-Norm(final)=2.362 | 3989.1 samples/s | 62.3 steps/s
[Step=2650 Epoch=25.2] | Loss=0.01047 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.250 | L2-Norm(final)=2.367 | 1547.7 samples/s | 24.2 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00875 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.236 | L2-Norm(final)=2.372 | 3747.5 samples/s | 58.6 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00751 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.223 | L2-Norm(final)=2.377 | 1598.7 samples/s | 25.0 steps/s
[Step=2800 Epoch=26.6] | Loss=0.00658 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.210 | L2-Norm(final)=2.381 | 3584.9 samples/s | 56.0 steps/s
[Step=2850 Epoch=27.1] | Loss=0.00585 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.199 | L2-Norm(final)=2.384 | 1623.5 samples/s | 25.4 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00528 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.189 | L2-Norm(final)=2.387 | 3417.3 samples/s | 53.4 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00480 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.179 | L2-Norm(final)=2.391 | 1655.4 samples/s | 25.9 steps/s
[Step=3000 Epoch=28.5] | Loss=0.00441 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.170 | L2-Norm(final)=2.393 | 3389.5 samples/s | 53.0 steps/s
[Step=3050 Epoch=29.0] | Loss=0.00408 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.162 | L2-Norm(final)=2.396 | 1665.9 samples/s | 26.0 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00379 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.154 | L2-Norm(final)=2.399 | 3328.9 samples/s | 52.0 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00355 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.147 | L2-Norm(final)=2.401 | 1677.7 samples/s | 26.2 steps/s
[Step=3200 Epoch=30.4] | Loss=0.00333 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.141 | L2-Norm(final)=2.404 | 3335.5 samples/s | 52.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step3200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.9] | Loss=0.12748 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.124 | L2-Norm(final)=2.419 | 3432.8 samples/s | 53.6 steps/s
[Step=2450 Epoch=23.4] | Loss=0.08249 | Reg=0.00376 | FP-Reg=0.013 | acc=0.9531 | L2-Norm=19.397 | L2-Norm(final)=2.325 | 3353.0 samples/s | 52.4 steps/s
[Step=2500 Epoch=23.9] | Loss=0.04712 | Reg=0.00378 | FP-Reg=0.015 | acc=1.0000 | L2-Norm=19.449 | L2-Norm(final)=2.303 | 4262.9 samples/s | 66.6 steps/s
[Step=2550 Epoch=24.4] | Loss=0.03167 | Reg=0.00378 | FP-Reg=0.015 | acc=1.0000 | L2-Norm=19.434 | L2-Norm(final)=2.303 | 1505.9 samples/s | 23.5 steps/s
[Step=2600 Epoch=24.8] | Loss=0.02404 | Reg=0.00377 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.409 | L2-Norm(final)=2.307 | 4040.5 samples/s | 63.1 steps/s
[Step=2650 Epoch=25.3] | Loss=0.01928 | Reg=0.00376 | FP-Reg=0.013 | acc=1.0000 | L2-Norm=19.385 | L2-Norm(final)=2.311 | 1538.3 samples/s | 24.0 steps/s
[Step=2700 Epoch=25.8] | Loss=0.01610 | Reg=0.00375 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.363 | L2-Norm(final)=2.316 | 3876.2 samples/s | 60.6 steps/s
[Step=2750 Epoch=26.3] | Loss=0.01382 | Reg=0.00374 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.343 | L2-Norm(final)=2.320 | 1568.0 samples/s | 24.5 steps/s
[Step=2800 Epoch=26.7] | Loss=0.01212 | Reg=0.00373 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.324 | L2-Norm(final)=2.325 | 3705.0 samples/s | 57.9 steps/s
[Step=2850 Epoch=27.2] | Loss=0.01079 | Reg=0.00373 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.308 | L2-Norm(final)=2.329 | 1591.4 samples/s | 24.9 steps/s
[Step=2900 Epoch=27.7] | Loss=0.00972 | Reg=0.00372 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.293 | L2-Norm(final)=2.334 | 3542.5 samples/s | 55.4 steps/s
[Step=2950 Epoch=28.2] | Loss=0.00885 | Reg=0.00372 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.280 | L2-Norm(final)=2.338 | 1631.6 samples/s | 25.5 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00812 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.267 | L2-Norm(final)=2.342 | 3419.8 samples/s | 53.4 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00751 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.256 | L2-Norm(final)=2.346 | 1666.6 samples/s | 26.0 steps/s
[Step=3100 Epoch=29.6] | Loss=0.00698 | Reg=0.00370 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.246 | L2-Norm(final)=2.350 | 3378.7 samples/s | 52.8 steps/s
[Step=3150 Epoch=30.1] | Loss=0.00653 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.236 | L2-Norm(final)=2.354 | 1651.9 samples/s | 25.8 steps/s
[Step=3200 Epoch=30.6] | Loss=0.00613 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.227 | L2-Norm(final)=2.358 | 3370.0 samples/s | 52.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step3200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.6] | Loss=0.29769 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.124 | L2-Norm(final)=2.418 | 3583.0 samples/s | 56.0 steps/s
[Step=2450 Epoch=23.1] | Loss=0.03384 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.232 | L2-Norm(final)=2.375 | 3211.7 samples/s | 50.2 steps/s
[Step=2500 Epoch=23.6] | Loss=0.02249 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.236 | L2-Norm(final)=2.374 | 4206.1 samples/s | 65.7 steps/s
[Step=2550 Epoch=24.0] | Loss=0.01571 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.238 | L2-Norm(final)=2.375 | 1518.4 samples/s | 23.7 steps/s
[Step=2600 Epoch=24.5] | Loss=0.01187 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.231 | L2-Norm(final)=2.379 | 3923.9 samples/s | 61.3 steps/s
[Step=2650 Epoch=25.0] | Loss=0.00951 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.221 | L2-Norm(final)=2.383 | 1084.9 samples/s | 17.0 steps/s
[Step=2700 Epoch=25.4] | Loss=0.00795 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.209 | L2-Norm(final)=2.386 | 3703.3 samples/s | 57.9 steps/s
[Step=2750 Epoch=25.9] | Loss=0.00682 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.199 | L2-Norm(final)=2.389 | 1587.2 samples/s | 24.8 steps/s
[Step=2800 Epoch=26.4] | Loss=0.00598 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.188 | L2-Norm(final)=2.392 | 3489.7 samples/s | 54.5 steps/s
[Step=2850 Epoch=26.9] | Loss=0.00532 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.179 | L2-Norm(final)=2.395 | 1665.9 samples/s | 26.0 steps/s
[Step=2900 Epoch=27.3] | Loss=0.00480 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.170 | L2-Norm(final)=2.398 | 3384.2 samples/s | 52.9 steps/s
[Step=2950 Epoch=27.8] | Loss=0.00437 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.162 | L2-Norm(final)=2.400 | 1670.0 samples/s | 26.1 steps/s
[Step=3000 Epoch=28.3] | Loss=0.00401 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.154 | L2-Norm(final)=2.403 | 3363.3 samples/s | 52.6 steps/s
[Step=3050 Epoch=28.7] | Loss=0.00371 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.147 | L2-Norm(final)=2.405 | 1678.2 samples/s | 26.2 steps/s
[Step=3100 Epoch=29.2] | Loss=0.00345 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.140 | L2-Norm(final)=2.407 | 3336.4 samples/s | 52.1 steps/s
[Step=3150 Epoch=29.7] | Loss=0.00323 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.410 | 1752.9 samples/s | 27.4 steps/s
[Step=3200 Epoch=30.2] | Loss=0.00303 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.128 | L2-Norm(final)=2.412 | 3170.8 samples/s | 49.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step3200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.9] | Loss=0.19934 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.124 | L2-Norm(final)=2.418 | 3520.7 samples/s | 55.0 steps/s
[Step=2450 Epoch=23.4] | Loss=0.04120 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.285 | L2-Norm(final)=2.364 | 3342.2 samples/s | 52.2 steps/s
[Step=2500 Epoch=23.8] | Loss=0.02238 | Reg=0.00373 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.305 | L2-Norm(final)=2.366 | 4242.3 samples/s | 66.3 steps/s
[Step=2550 Epoch=24.3] | Loss=0.01532 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.296 | L2-Norm(final)=2.372 | 1513.0 samples/s | 23.6 steps/s
[Step=2600 Epoch=24.8] | Loss=0.01156 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.280 | L2-Norm(final)=2.379 | 4040.4 samples/s | 63.1 steps/s
[Step=2650 Epoch=25.3] | Loss=0.00927 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.264 | L2-Norm(final)=2.385 | 1532.5 samples/s | 23.9 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00774 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.248 | L2-Norm(final)=2.390 | 3851.3 samples/s | 60.2 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00665 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.233 | L2-Norm(final)=2.394 | 1577.6 samples/s | 24.7 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00583 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.397 | 3684.6 samples/s | 57.6 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00519 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.207 | L2-Norm(final)=2.401 | 1585.4 samples/s | 24.8 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00468 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.196 | L2-Norm(final)=2.404 | 3544.3 samples/s | 55.4 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00426 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.185 | L2-Norm(final)=2.407 | 1610.1 samples/s | 25.2 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00391 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.175 | L2-Norm(final)=2.409 | 3404.0 samples/s | 53.2 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00362 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.167 | L2-Norm(final)=2.412 | 1623.6 samples/s | 25.4 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00337 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.158 | L2-Norm(final)=2.415 | 3373.7 samples/s | 52.7 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00315 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.151 | L2-Norm(final)=2.417 | 1659.2 samples/s | 25.9 steps/s
[Step=3200 Epoch=30.5] | Loss=0.00296 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.420 | 3355.3 samples/s | 52.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23368 | acc=0.8050 | tpr=0.7346 | fpr=0.0421 | 3654.2 samples/s | 14.3 steps/s
Avg test loss: 0.23612, Avg test acc: 0.80439, Avg tpr: 0.73364, Avg fpr: 0.03999, total FA: 312

Testing server on iccad2012
[Step=  50] | Loss=0.46189 | acc=0.6756 | tpr=0.9602 | fpr=0.3295 | 3670.8 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.45886 | acc=0.6763 | tpr=0.9595 | fpr=0.3290 | 6807.6 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.46141 | acc=0.6776 | tpr=0.9640 | fpr=0.3277 | 6984.9 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.46102 | acc=0.6778 | tpr=0.9683 | fpr=0.3275 | 6839.4 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.46049 | acc=0.6782 | tpr=0.9651 | fpr=0.3271 | 6887.0 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.45878 | acc=0.6793 | tpr=0.9644 | fpr=0.3259 | 6765.2 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.45865 | acc=0.6799 | tpr=0.9643 | fpr=0.3253 | 6853.9 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.45912 | acc=0.6795 | tpr=0.9612 | fpr=0.3257 | 6903.5 samples/s | 27.0 steps/s
[Step= 450] | Loss=0.46187 | acc=0.6789 | tpr=0.9620 | fpr=0.3263 | 6750.0 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.46316 | acc=0.6783 | tpr=0.9630 | fpr=0.3269 | 6719.1 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.46314 | acc=0.6782 | tpr=0.9630 | fpr=0.3270 | 12546.5 samples/s | 49.0 steps/s
Avg test loss: 0.46307, Avg test acc: 0.67815, Avg tpr: 0.96315, Avg fpr: 0.32703, total FA: 45407

server round 4/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.16182 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.150 | L2-Norm(final)=2.465 | 3711.6 samples/s | 58.0 steps/s
[Step=3250 Epoch=15.8] | Loss=0.09162 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.148 | L2-Norm(final)=2.440 | 3504.0 samples/s | 54.7 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07476 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.160 | L2-Norm(final)=2.436 | 3519.5 samples/s | 55.0 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07096 | Reg=0.00367 | FP-Reg=0.002 | acc=0.8906 | L2-Norm=19.167 | L2-Norm(final)=2.435 | 3522.9 samples/s | 55.0 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06549 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.176 | L2-Norm(final)=2.436 | 4384.7 samples/s | 68.5 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05835 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.186 | L2-Norm(final)=2.439 | 1564.3 samples/s | 24.4 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05348 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.198 | L2-Norm(final)=2.445 | 3516.4 samples/s | 54.9 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05108 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.209 | L2-Norm(final)=2.451 | 3539.9 samples/s | 55.3 steps/s
[Step=3600 Epoch=17.6] | Loss=0.04984 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.222 | L2-Norm(final)=2.454 | 4136.4 samples/s | 64.6 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04770 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.235 | L2-Norm(final)=2.458 | 1595.4 samples/s | 24.9 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04564 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.248 | L2-Norm(final)=2.463 | 3523.4 samples/s | 55.1 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04322 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.260 | L2-Norm(final)=2.468 | 3531.0 samples/s | 55.2 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04215 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.271 | L2-Norm(final)=2.473 | 3952.4 samples/s | 61.8 steps/s
[Step=3850 Epoch=18.8] | Loss=0.03995 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.281 | L2-Norm(final)=2.477 | 1637.4 samples/s | 25.6 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03848 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.290 | L2-Norm(final)=2.482 | 3511.1 samples/s | 54.9 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03769 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.298 | L2-Norm(final)=2.486 | 3493.6 samples/s | 54.6 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03682 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.306 | L2-Norm(final)=2.490 | 3743.3 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.14954 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.150 | L2-Norm(final)=2.465 | 3570.9 samples/s | 55.8 steps/s
[Step=3250 Epoch=15.9] | Loss=0.07813 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.145 | L2-Norm(final)=2.448 | 3534.6 samples/s | 55.2 steps/s
[Step=3300 Epoch=16.1] | Loss=0.06789 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.156 | L2-Norm(final)=2.450 | 3510.3 samples/s | 54.8 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06360 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.167 | L2-Norm(final)=2.451 | 3512.3 samples/s | 54.9 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06026 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.178 | L2-Norm(final)=2.450 | 4375.3 samples/s | 68.4 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05520 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.190 | L2-Norm(final)=2.451 | 1569.2 samples/s | 24.5 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05085 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.203 | L2-Norm(final)=2.454 | 3522.4 samples/s | 55.0 steps/s
[Step=3550 Epoch=17.3] | Loss=0.04852 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.215 | L2-Norm(final)=2.457 | 3510.0 samples/s | 54.8 steps/s
[Step=3600 Epoch=17.6] | Loss=0.04644 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.460 | 4170.0 samples/s | 65.2 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04387 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.242 | L2-Norm(final)=2.463 | 1597.0 samples/s | 25.0 steps/s
[Step=3700 Epoch=18.1] | Loss=0.04230 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.253 | L2-Norm(final)=2.466 | 3507.2 samples/s | 54.8 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04087 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.263 | L2-Norm(final)=2.469 | 3483.8 samples/s | 54.4 steps/s
[Step=3800 Epoch=18.5] | Loss=0.03973 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.272 | L2-Norm(final)=2.471 | 3999.1 samples/s | 62.5 steps/s
[Step=3850 Epoch=18.8] | Loss=0.03806 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.281 | L2-Norm(final)=2.473 | 1623.0 samples/s | 25.4 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03660 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.289 | L2-Norm(final)=2.476 | 3519.0 samples/s | 55.0 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03542 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.297 | L2-Norm(final)=2.479 | 3507.5 samples/s | 54.8 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03472 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.304 | L2-Norm(final)=2.481 | 3858.6 samples/s | 60.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step4000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.14376 | Reg=0.00367 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.150 | L2-Norm(final)=2.465 | 3659.4 samples/s | 57.2 steps/s
[Step=3250 Epoch=15.8] | Loss=0.07524 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=19.135 | L2-Norm(final)=2.445 | 3421.8 samples/s | 53.5 steps/s
[Step=3300 Epoch=16.1] | Loss=0.06705 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.142 | L2-Norm(final)=2.443 | 3503.0 samples/s | 54.7 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06394 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.154 | L2-Norm(final)=2.446 | 3525.8 samples/s | 55.1 steps/s
[Step=3400 Epoch=16.6] | Loss=0.05971 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.168 | L2-Norm(final)=2.448 | 4374.5 samples/s | 68.4 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05549 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.185 | L2-Norm(final)=2.452 | 1571.3 samples/s | 24.6 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05163 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.200 | L2-Norm(final)=2.456 | 3519.4 samples/s | 55.0 steps/s
[Step=3550 Epoch=17.3] | Loss=0.04879 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.215 | L2-Norm(final)=2.461 | 3507.0 samples/s | 54.8 steps/s
[Step=3600 Epoch=17.5] | Loss=0.04750 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.227 | L2-Norm(final)=2.465 | 4140.6 samples/s | 64.7 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04436 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.238 | L2-Norm(final)=2.468 | 1599.4 samples/s | 25.0 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04226 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.248 | L2-Norm(final)=2.472 | 3492.3 samples/s | 54.6 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04059 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.258 | L2-Norm(final)=2.476 | 3513.1 samples/s | 54.9 steps/s
[Step=3800 Epoch=18.5] | Loss=0.03995 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.268 | L2-Norm(final)=2.480 | 3955.9 samples/s | 61.8 steps/s
[Step=3850 Epoch=18.8] | Loss=0.03900 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.279 | L2-Norm(final)=2.482 | 1618.7 samples/s | 25.3 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03833 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9219 | L2-Norm=19.289 | L2-Norm(final)=2.485 | 3531.0 samples/s | 55.2 steps/s
[Step=3950 Epoch=19.2] | Loss=0.03756 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.299 | L2-Norm(final)=2.488 | 3517.6 samples/s | 55.0 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03646 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.309 | L2-Norm(final)=2.490 | 3743.6 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step4000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.10838 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.150 | L2-Norm(final)=2.465 | 3471.0 samples/s | 54.2 steps/s
[Step=3250 Epoch=15.8] | Loss=0.06922 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9219 | L2-Norm=19.149 | L2-Norm(final)=2.456 | 3538.5 samples/s | 55.3 steps/s
[Step=3300 Epoch=16.1] | Loss=0.06596 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.156 | L2-Norm(final)=2.452 | 3496.5 samples/s | 54.6 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06248 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.168 | L2-Norm(final)=2.452 | 3482.2 samples/s | 54.4 steps/s
[Step=3400 Epoch=16.6] | Loss=0.05986 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.182 | L2-Norm(final)=2.452 | 4326.4 samples/s | 67.6 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05430 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.198 | L2-Norm(final)=2.456 | 1578.5 samples/s | 24.7 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05081 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.213 | L2-Norm(final)=2.461 | 3487.7 samples/s | 54.5 steps/s
[Step=3550 Epoch=17.3] | Loss=0.04946 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.226 | L2-Norm(final)=2.465 | 3541.7 samples/s | 55.3 steps/s
[Step=3600 Epoch=17.6] | Loss=0.04722 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.238 | L2-Norm(final)=2.467 | 4168.3 samples/s | 65.1 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04413 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.250 | L2-Norm(final)=2.471 | 1598.9 samples/s | 25.0 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04169 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.476 | 3480.4 samples/s | 54.4 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04010 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.271 | L2-Norm(final)=2.481 | 3510.4 samples/s | 54.9 steps/s
[Step=3800 Epoch=18.5] | Loss=0.03925 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.281 | L2-Norm(final)=2.484 | 3960.3 samples/s | 61.9 steps/s
[Step=3850 Epoch=18.8] | Loss=0.03793 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.289 | L2-Norm(final)=2.487 | 1614.5 samples/s | 25.2 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03675 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.298 | L2-Norm(final)=2.490 | 3526.1 samples/s | 55.1 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03587 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.306 | L2-Norm(final)=2.493 | 3528.8 samples/s | 55.1 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03557 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.315 | L2-Norm(final)=2.496 | 3768.4 samples/s | 58.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step4000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.7] | Loss=0.21493 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.150 | L2-Norm(final)=2.464 | 3582.4 samples/s | 56.0 steps/s
[Step=3250 Epoch=15.9] | Loss=0.07519 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.151 | L2-Norm(final)=2.444 | 3429.9 samples/s | 53.6 steps/s
[Step=3300 Epoch=16.2] | Loss=0.07288 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.162 | L2-Norm(final)=2.438 | 3526.2 samples/s | 55.1 steps/s
[Step=3350 Epoch=16.4] | Loss=0.06552 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.176 | L2-Norm(final)=2.438 | 3532.3 samples/s | 55.2 steps/s
[Step=3400 Epoch=16.7] | Loss=0.06335 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.189 | L2-Norm(final)=2.438 | 4391.9 samples/s | 68.6 steps/s
[Step=3450 Epoch=16.9] | Loss=0.05586 | Reg=0.00369 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.202 | L2-Norm(final)=2.441 | 1558.6 samples/s | 24.4 steps/s
[Step=3500 Epoch=17.2] | Loss=0.05168 | Reg=0.00369 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.215 | L2-Norm(final)=2.446 | 3534.5 samples/s | 55.2 steps/s
[Step=3550 Epoch=17.4] | Loss=0.04852 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.228 | L2-Norm(final)=2.451 | 3538.8 samples/s | 55.3 steps/s
[Step=3600 Epoch=17.7] | Loss=0.04854 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.239 | L2-Norm(final)=2.453 | 4275.7 samples/s | 66.8 steps/s
[Step=3650 Epoch=17.9] | Loss=0.04655 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.250 | L2-Norm(final)=2.454 | 1568.3 samples/s | 24.5 steps/s
[Step=3700 Epoch=18.1] | Loss=0.04485 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.261 | L2-Norm(final)=2.456 | 3447.1 samples/s | 53.9 steps/s
[Step=3750 Epoch=18.4] | Loss=0.04255 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.271 | L2-Norm(final)=2.458 | 3536.0 samples/s | 55.2 steps/s
[Step=3800 Epoch=18.6] | Loss=0.04164 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.281 | L2-Norm(final)=2.461 | 4095.3 samples/s | 64.0 steps/s
[Step=3850 Epoch=18.9] | Loss=0.03984 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.292 | L2-Norm(final)=2.465 | 1597.4 samples/s | 25.0 steps/s
[Step=3900 Epoch=19.1] | Loss=0.03857 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.302 | L2-Norm(final)=2.468 | 3495.7 samples/s | 54.6 steps/s
[Step=3950 Epoch=19.4] | Loss=0.03730 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.311 | L2-Norm(final)=2.471 | 3500.7 samples/s | 54.7 steps/s
[Step=4000 Epoch=19.6] | Loss=0.03635 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.319 | L2-Norm(final)=2.474 | 3987.8 samples/s | 62.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step4000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.3] | Loss=0.24774 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.150 | L2-Norm(final)=2.465 | 3559.0 samples/s | 55.6 steps/s
[Step=3250 Epoch=30.8] | Loss=0.03698 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.223 | L2-Norm(final)=2.427 | 3193.4 samples/s | 49.9 steps/s
[Step=3300 Epoch=31.3] | Loss=0.02161 | Reg=0.00371 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.258 | L2-Norm(final)=2.417 | 4216.3 samples/s | 65.9 steps/s
[Step=3350 Epoch=31.7] | Loss=0.01463 | Reg=0.00371 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.257 | L2-Norm(final)=2.417 | 1510.8 samples/s | 23.6 steps/s
[Step=3400 Epoch=32.2] | Loss=0.01109 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.247 | L2-Norm(final)=2.419 | 3964.6 samples/s | 61.9 steps/s
[Step=3450 Epoch=32.7] | Loss=0.00893 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.236 | L2-Norm(final)=2.422 | 1549.2 samples/s | 24.2 steps/s
[Step=3500 Epoch=33.2] | Loss=0.00746 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.226 | L2-Norm(final)=2.425 | 3771.3 samples/s | 58.9 steps/s
[Step=3550 Epoch=33.6] | Loss=0.00641 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.215 | L2-Norm(final)=2.428 | 1575.8 samples/s | 24.6 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00561 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.206 | L2-Norm(final)=2.431 | 3552.6 samples/s | 55.5 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00500 | Reg=0.00369 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.196 | L2-Norm(final)=2.434 | 1610.7 samples/s | 25.2 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00451 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.188 | L2-Norm(final)=2.436 | 3401.1 samples/s | 53.1 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00410 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.180 | L2-Norm(final)=2.439 | 1646.2 samples/s | 25.7 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00377 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.172 | L2-Norm(final)=2.441 | 3333.3 samples/s | 52.1 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00348 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.165 | L2-Norm(final)=2.443 | 1664.9 samples/s | 26.0 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00324 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.158 | L2-Norm(final)=2.445 | 3365.9 samples/s | 52.6 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00303 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.152 | L2-Norm(final)=2.448 | 1676.7 samples/s | 26.2 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00284 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.146 | L2-Norm(final)=2.450 | 3321.7 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.4] | Loss=0.20046 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.150 | L2-Norm(final)=2.464 | 3583.6 samples/s | 56.0 steps/s
[Step=3250 Epoch=30.9] | Loss=0.03317 | Reg=0.00371 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.255 | L2-Norm(final)=2.430 | 3214.1 samples/s | 50.2 steps/s
[Step=3300 Epoch=31.4] | Loss=0.01910 | Reg=0.00371 | FP-Reg=0.008 | acc=0.9531 | L2-Norm=19.263 | L2-Norm(final)=2.429 | 4257.1 samples/s | 66.5 steps/s
[Step=3350 Epoch=31.9] | Loss=0.01360 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.257 | L2-Norm(final)=2.433 | 1515.4 samples/s | 23.7 steps/s
[Step=3400 Epoch=32.3] | Loss=0.01026 | Reg=0.00371 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.249 | L2-Norm(final)=2.439 | 3950.1 samples/s | 61.7 steps/s
[Step=3450 Epoch=32.8] | Loss=0.00823 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.238 | L2-Norm(final)=2.444 | 1546.9 samples/s | 24.2 steps/s
[Step=3500 Epoch=33.3] | Loss=0.00686 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.226 | L2-Norm(final)=2.449 | 3777.7 samples/s | 59.0 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00589 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.215 | L2-Norm(final)=2.452 | 1602.5 samples/s | 25.0 steps/s
[Step=3600 Epoch=34.2] | Loss=0.00517 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.205 | L2-Norm(final)=2.455 | 3507.3 samples/s | 54.8 steps/s
[Step=3650 Epoch=34.7] | Loss=0.00460 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.195 | L2-Norm(final)=2.458 | 1614.6 samples/s | 25.2 steps/s
[Step=3700 Epoch=35.2] | Loss=0.00414 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.186 | L2-Norm(final)=2.461 | 3409.8 samples/s | 53.3 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00377 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.178 | L2-Norm(final)=2.463 | 1642.4 samples/s | 25.7 steps/s
[Step=3800 Epoch=36.1] | Loss=0.00347 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.170 | L2-Norm(final)=2.465 | 3375.9 samples/s | 52.7 steps/s
[Step=3850 Epoch=36.6] | Loss=0.00320 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.163 | L2-Norm(final)=2.467 | 1646.4 samples/s | 25.7 steps/s
[Step=3900 Epoch=37.1] | Loss=0.00298 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.156 | L2-Norm(final)=2.469 | 3358.4 samples/s | 52.5 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00279 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.150 | L2-Norm(final)=2.471 | 1658.2 samples/s | 25.9 steps/s
[Step=4000 Epoch=38.0] | Loss=0.00262 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.145 | L2-Norm(final)=2.473 | 3318.4 samples/s | 51.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step4000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.6] | Loss=0.26397 | Reg=0.00367 | FP-Reg=0.000 | acc=0.7656 | L2-Norm=19.150 | L2-Norm(final)=2.464 | 3768.4 samples/s | 58.9 steps/s
[Step=3250 Epoch=31.0] | Loss=0.02610 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.231 | L2-Norm(final)=2.424 | 3024.1 samples/s | 47.3 steps/s
[Step=3300 Epoch=31.5] | Loss=0.01541 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.231 | L2-Norm(final)=2.420 | 4205.7 samples/s | 65.7 steps/s
[Step=3350 Epoch=32.0] | Loss=0.01037 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.218 | L2-Norm(final)=2.423 | 1504.0 samples/s | 23.5 steps/s
[Step=3400 Epoch=32.5] | Loss=0.00780 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.427 | 4026.3 samples/s | 62.9 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00627 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.190 | L2-Norm(final)=2.430 | 1513.0 samples/s | 23.6 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00523 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.179 | L2-Norm(final)=2.433 | 3814.9 samples/s | 59.6 steps/s
[Step=3550 Epoch=33.9] | Loss=0.00449 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.169 | L2-Norm(final)=2.436 | 1567.5 samples/s | 24.5 steps/s
[Step=3600 Epoch=34.4] | Loss=0.00394 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.159 | L2-Norm(final)=2.439 | 3689.5 samples/s | 57.6 steps/s
[Step=3650 Epoch=34.9] | Loss=0.00351 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.151 | L2-Norm(final)=2.442 | 1594.4 samples/s | 24.9 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00317 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.143 | L2-Norm(final)=2.444 | 3540.2 samples/s | 55.3 steps/s
[Step=3750 Epoch=35.8] | Loss=0.00289 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.447 | 1611.4 samples/s | 25.2 steps/s
[Step=3800 Epoch=36.3] | Loss=0.00265 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.130 | L2-Norm(final)=2.449 | 3367.4 samples/s | 52.6 steps/s
[Step=3850 Epoch=36.8] | Loss=0.00245 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.125 | L2-Norm(final)=2.451 | 1655.2 samples/s | 25.9 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00228 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.119 | L2-Norm(final)=2.453 | 3376.6 samples/s | 52.8 steps/s
[Step=3950 Epoch=37.7] | Loss=0.00214 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.114 | L2-Norm(final)=2.456 | 1648.4 samples/s | 25.8 steps/s
[Step=4000 Epoch=38.2] | Loss=0.00201 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.110 | L2-Norm(final)=2.458 | 3414.2 samples/s | 53.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step4000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.2] | Loss=0.11211 | Reg=0.00367 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.150 | L2-Norm(final)=2.465 | 3648.9 samples/s | 57.0 steps/s
[Step=3250 Epoch=30.6] | Loss=0.02737 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.224 | L2-Norm(final)=2.433 | 3144.3 samples/s | 49.1 steps/s
[Step=3300 Epoch=31.1] | Loss=0.01967 | Reg=0.00370 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.236 | L2-Norm(final)=2.430 | 4119.9 samples/s | 64.4 steps/s
[Step=3350 Epoch=31.6] | Loss=0.01430 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.248 | L2-Norm(final)=2.429 | 1521.8 samples/s | 23.8 steps/s
[Step=3400 Epoch=32.0] | Loss=0.01088 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.247 | L2-Norm(final)=2.430 | 3933.0 samples/s | 61.5 steps/s
[Step=3450 Epoch=32.5] | Loss=0.00873 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.241 | L2-Norm(final)=2.433 | 1567.2 samples/s | 24.5 steps/s
[Step=3500 Epoch=33.0] | Loss=0.00729 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.232 | L2-Norm(final)=2.436 | 3678.6 samples/s | 57.5 steps/s
[Step=3550 Epoch=33.5] | Loss=0.00626 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.223 | L2-Norm(final)=2.440 | 1594.0 samples/s | 24.9 steps/s
[Step=3600 Epoch=33.9] | Loss=0.00549 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.214 | L2-Norm(final)=2.443 | 3440.6 samples/s | 53.8 steps/s
[Step=3650 Epoch=34.4] | Loss=0.00489 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.206 | L2-Norm(final)=2.446 | 1643.0 samples/s | 25.7 steps/s
[Step=3700 Epoch=34.9] | Loss=0.00441 | Reg=0.00369 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.197 | L2-Norm(final)=2.449 | 3376.6 samples/s | 52.8 steps/s
[Step=3750 Epoch=35.3] | Loss=0.00401 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.190 | L2-Norm(final)=2.451 | 1671.8 samples/s | 26.1 steps/s
[Step=3800 Epoch=35.8] | Loss=0.00369 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.182 | L2-Norm(final)=2.454 | 3373.9 samples/s | 52.7 steps/s
[Step=3850 Epoch=36.3] | Loss=0.00341 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.176 | L2-Norm(final)=2.457 | 1665.2 samples/s | 26.0 steps/s
[Step=3900 Epoch=36.7] | Loss=0.00317 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.169 | L2-Norm(final)=2.459 | 3321.4 samples/s | 51.9 steps/s
[Step=3950 Epoch=37.2] | Loss=0.00297 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.163 | L2-Norm(final)=2.462 | 1754.0 samples/s | 27.4 steps/s
[Step=4000 Epoch=37.7] | Loss=0.00279 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.158 | L2-Norm(final)=2.464 | 3082.7 samples/s | 48.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step4000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.5] | Loss=0.20211 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.150 | L2-Norm(final)=2.463 | 3479.8 samples/s | 54.4 steps/s
[Step=3250 Epoch=31.0] | Loss=0.02893 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.230 | L2-Norm(final)=2.437 | 3259.5 samples/s | 50.9 steps/s
[Step=3300 Epoch=31.5] | Loss=0.01685 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.263 | L2-Norm(final)=2.431 | 4229.0 samples/s | 66.1 steps/s
[Step=3350 Epoch=31.9] | Loss=0.01133 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.258 | L2-Norm(final)=2.434 | 1498.1 samples/s | 23.4 steps/s
[Step=3400 Epoch=32.4] | Loss=0.00854 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.246 | L2-Norm(final)=2.439 | 4033.0 samples/s | 63.0 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00684 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.233 | L2-Norm(final)=2.443 | 1537.5 samples/s | 24.0 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00572 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.447 | 3844.9 samples/s | 60.1 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00491 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.208 | L2-Norm(final)=2.450 | 1564.8 samples/s | 24.5 steps/s
[Step=3600 Epoch=34.3] | Loss=0.00431 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.197 | L2-Norm(final)=2.453 | 3671.3 samples/s | 57.4 steps/s
[Step=3650 Epoch=34.8] | Loss=0.00383 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.187 | L2-Norm(final)=2.456 | 1590.7 samples/s | 24.9 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00346 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.178 | L2-Norm(final)=2.459 | 3509.4 samples/s | 54.8 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00315 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.169 | L2-Norm(final)=2.461 | 1614.1 samples/s | 25.2 steps/s
[Step=3800 Epoch=36.2] | Loss=0.00290 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.161 | L2-Norm(final)=2.464 | 3389.4 samples/s | 53.0 steps/s
[Step=3850 Epoch=36.7] | Loss=0.00268 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.154 | L2-Norm(final)=2.466 | 1663.0 samples/s | 26.0 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00249 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.468 | 3360.0 samples/s | 52.5 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00233 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.141 | L2-Norm(final)=2.471 | 1665.3 samples/s | 26.0 steps/s
[Step=4000 Epoch=38.1] | Loss=0.00219 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.136 | L2-Norm(final)=2.473 | 3383.6 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22413 | acc=0.8242 | tpr=0.7568 | fpr=0.0295 | 3599.8 samples/s | 14.1 steps/s
Avg test loss: 0.22810, Avg test acc: 0.82246, Avg tpr: 0.75584, Avg fpr: 0.03102, total FA: 242

Testing server on iccad2012
[Step=  50] | Loss=0.44240 | acc=0.7151 | tpr=0.9690 | fpr=0.2895 | 3642.4 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.44115 | acc=0.7146 | tpr=0.9659 | fpr=0.2901 | 6814.5 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.44393 | acc=0.7157 | tpr=0.9697 | fpr=0.2890 | 6990.2 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.44368 | acc=0.7168 | tpr=0.9705 | fpr=0.2878 | 6820.1 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.44344 | acc=0.7165 | tpr=0.9642 | fpr=0.2880 | 6856.3 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.44173 | acc=0.7178 | tpr=0.9651 | fpr=0.2867 | 6746.2 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.44138 | acc=0.7181 | tpr=0.9643 | fpr=0.2863 | 6783.4 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.44198 | acc=0.7176 | tpr=0.9612 | fpr=0.2868 | 6878.9 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.44487 | acc=0.7170 | tpr=0.9625 | fpr=0.2874 | 6851.8 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.44621 | acc=0.7160 | tpr=0.9643 | fpr=0.2885 | 6769.8 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.44586 | acc=0.7160 | tpr=0.9646 | fpr=0.2885 | 12332.7 samples/s | 48.2 steps/s
Avg test loss: 0.44574, Avg test acc: 0.71599, Avg tpr: 0.96474, Avg fpr: 0.28853, total FA: 40062

server round 5/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.08594 | Reg=0.00367 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.155 | L2-Norm(final)=2.511 | 3572.9 samples/s | 55.8 steps/s
[Step=4050 Epoch=19.7] | Loss=0.06273 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9062 | L2-Norm=19.148 | L2-Norm(final)=2.494 | 3333.7 samples/s | 52.1 steps/s
[Step=4100 Epoch=20.0] | Loss=0.05845 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9062 | L2-Norm=19.154 | L2-Norm(final)=2.489 | 3490.2 samples/s | 54.5 steps/s
[Step=4150 Epoch=20.2] | Loss=0.05625 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.162 | L2-Norm(final)=2.484 | 3490.6 samples/s | 54.5 steps/s
[Step=4200 Epoch=20.5] | Loss=0.05413 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.172 | L2-Norm(final)=2.484 | 4333.2 samples/s | 67.7 steps/s
[Step=4250 Epoch=20.7] | Loss=0.04776 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.184 | L2-Norm(final)=2.486 | 1574.8 samples/s | 24.6 steps/s
[Step=4300 Epoch=21.0] | Loss=0.04490 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.196 | L2-Norm(final)=2.491 | 3533.7 samples/s | 55.2 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04296 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.209 | L2-Norm(final)=2.496 | 3536.6 samples/s | 55.3 steps/s
[Step=4400 Epoch=21.5] | Loss=0.04139 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.222 | L2-Norm(final)=2.499 | 4111.5 samples/s | 64.2 steps/s
[Step=4450 Epoch=21.7] | Loss=0.03945 | Reg=0.00370 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.234 | L2-Norm(final)=2.503 | 1594.9 samples/s | 24.9 steps/s
[Step=4500 Epoch=21.9] | Loss=0.03819 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.245 | L2-Norm(final)=2.505 | 3511.9 samples/s | 54.9 steps/s
[Step=4550 Epoch=22.2] | Loss=0.03665 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.256 | L2-Norm(final)=2.508 | 3515.7 samples/s | 54.9 steps/s
[Step=4600 Epoch=22.4] | Loss=0.03660 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.266 | L2-Norm(final)=2.510 | 3945.0 samples/s | 61.6 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03549 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.275 | L2-Norm(final)=2.512 | 1627.6 samples/s | 25.4 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03436 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.283 | L2-Norm(final)=2.514 | 3496.0 samples/s | 54.6 steps/s
[Step=4750 Epoch=23.2] | Loss=0.03343 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.290 | L2-Norm(final)=2.516 | 3497.7 samples/s | 54.7 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03247 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.297 | L2-Norm(final)=2.519 | 3712.5 samples/s | 58.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step4800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.18813 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.155 | L2-Norm(final)=2.510 | 3502.8 samples/s | 54.7 steps/s
[Step=4050 Epoch=19.8] | Loss=0.06667 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.166 | L2-Norm(final)=2.490 | 3446.5 samples/s | 53.9 steps/s
[Step=4100 Epoch=20.0] | Loss=0.06085 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.172 | L2-Norm(final)=2.489 | 3160.5 samples/s | 49.4 steps/s
[Step=4150 Epoch=20.3] | Loss=0.05654 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.182 | L2-Norm(final)=2.490 | 3178.9 samples/s | 49.7 steps/s
[Step=4200 Epoch=20.5] | Loss=0.05419 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.193 | L2-Norm(final)=2.490 | 3907.3 samples/s | 61.1 steps/s
[Step=4250 Epoch=20.7] | Loss=0.04902 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.205 | L2-Norm(final)=2.491 | 1469.6 samples/s | 23.0 steps/s
[Step=4300 Epoch=21.0] | Loss=0.04558 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.217 | L2-Norm(final)=2.495 | 3388.8 samples/s | 52.9 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04435 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.229 | L2-Norm(final)=2.496 | 3388.8 samples/s | 52.9 steps/s
[Step=4400 Epoch=21.5] | Loss=0.04251 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.239 | L2-Norm(final)=2.497 | 4111.1 samples/s | 64.2 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04033 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.250 | L2-Norm(final)=2.499 | 1574.6 samples/s | 24.6 steps/s
[Step=4500 Epoch=22.0] | Loss=0.03855 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.260 | L2-Norm(final)=2.502 | 3434.9 samples/s | 53.7 steps/s
[Step=4550 Epoch=22.2] | Loss=0.03723 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.269 | L2-Norm(final)=2.504 | 3503.9 samples/s | 54.7 steps/s
[Step=4600 Epoch=22.4] | Loss=0.03603 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.277 | L2-Norm(final)=2.506 | 3967.0 samples/s | 62.0 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03482 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.285 | L2-Norm(final)=2.509 | 1577.6 samples/s | 24.6 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03379 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.294 | L2-Norm(final)=2.511 | 3398.3 samples/s | 53.1 steps/s
[Step=4750 Epoch=23.2] | Loss=0.03282 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.302 | L2-Norm(final)=2.514 | 3436.5 samples/s | 53.7 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03239 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.309 | L2-Norm(final)=2.515 | 3792.6 samples/s | 59.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step4800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.12875 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.155 | L2-Norm(final)=2.511 | 3712.2 samples/s | 58.0 steps/s
[Step=4050 Epoch=19.7] | Loss=0.07405 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.158 | L2-Norm(final)=2.482 | 3388.6 samples/s | 52.9 steps/s
[Step=4100 Epoch=20.0] | Loss=0.06487 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.167 | L2-Norm(final)=2.478 | 3497.2 samples/s | 54.6 steps/s
[Step=4150 Epoch=20.2] | Loss=0.05849 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.176 | L2-Norm(final)=2.478 | 3502.1 samples/s | 54.7 steps/s
[Step=4200 Epoch=20.5] | Loss=0.05850 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.187 | L2-Norm(final)=2.478 | 4353.5 samples/s | 68.0 steps/s
[Step=4250 Epoch=20.7] | Loss=0.05262 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.202 | L2-Norm(final)=2.480 | 1537.0 samples/s | 24.0 steps/s
[Step=4300 Epoch=21.0] | Loss=0.04835 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.218 | L2-Norm(final)=2.487 | 3437.6 samples/s | 53.7 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04684 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.232 | L2-Norm(final)=2.491 | 3503.1 samples/s | 54.7 steps/s
[Step=4400 Epoch=21.4] | Loss=0.04563 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.245 | L2-Norm(final)=2.494 | 4037.3 samples/s | 63.1 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04314 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.257 | L2-Norm(final)=2.496 | 1485.3 samples/s | 23.2 steps/s
[Step=4500 Epoch=21.9] | Loss=0.04130 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.268 | L2-Norm(final)=2.499 | 3396.5 samples/s | 53.1 steps/s
[Step=4550 Epoch=22.2] | Loss=0.04020 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.277 | L2-Norm(final)=2.501 | 3410.1 samples/s | 53.3 steps/s
[Step=4600 Epoch=22.4] | Loss=0.03865 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.286 | L2-Norm(final)=2.503 | 3794.7 samples/s | 59.3 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03746 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.296 | L2-Norm(final)=2.506 | 1623.5 samples/s | 25.4 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03625 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.306 | L2-Norm(final)=2.509 | 3548.2 samples/s | 55.4 steps/s
[Step=4750 Epoch=23.1] | Loss=0.03479 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.314 | L2-Norm(final)=2.512 | 3501.3 samples/s | 54.7 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03426 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.323 | L2-Norm(final)=2.515 | 3717.8 samples/s | 58.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step4800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.10374 | Reg=0.00367 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.155 | L2-Norm(final)=2.510 | 3746.2 samples/s | 58.5 steps/s
[Step=4050 Epoch=19.8] | Loss=0.06048 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=19.148 | L2-Norm(final)=2.495 | 3388.2 samples/s | 52.9 steps/s
[Step=4100 Epoch=20.0] | Loss=0.05677 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.155 | L2-Norm(final)=2.493 | 3502.8 samples/s | 54.7 steps/s
[Step=4150 Epoch=20.2] | Loss=0.05452 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.164 | L2-Norm(final)=2.490 | 3491.7 samples/s | 54.6 steps/s
[Step=4200 Epoch=20.5] | Loss=0.05139 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.178 | L2-Norm(final)=2.491 | 4356.9 samples/s | 68.1 steps/s
[Step=4250 Epoch=20.7] | Loss=0.04702 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.192 | L2-Norm(final)=2.492 | 1567.2 samples/s | 24.5 steps/s
[Step=4300 Epoch=21.0] | Loss=0.04488 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.206 | L2-Norm(final)=2.495 | 3548.1 samples/s | 55.4 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04300 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.219 | L2-Norm(final)=2.496 | 3518.2 samples/s | 55.0 steps/s
[Step=4400 Epoch=21.5] | Loss=0.04143 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.230 | L2-Norm(final)=2.498 | 4128.0 samples/s | 64.5 steps/s
[Step=4450 Epoch=21.7] | Loss=0.03924 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.241 | L2-Norm(final)=2.500 | 1602.9 samples/s | 25.0 steps/s
[Step=4500 Epoch=21.9] | Loss=0.03723 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.252 | L2-Norm(final)=2.504 | 3524.5 samples/s | 55.1 steps/s
[Step=4550 Epoch=22.2] | Loss=0.03658 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.507 | 3510.6 samples/s | 54.9 steps/s
[Step=4600 Epoch=22.4] | Loss=0.03479 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.270 | L2-Norm(final)=2.510 | 3913.1 samples/s | 61.1 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03344 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.277 | L2-Norm(final)=2.513 | 1636.7 samples/s | 25.6 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03204 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.284 | L2-Norm(final)=2.516 | 3505.2 samples/s | 54.8 steps/s
[Step=4750 Epoch=23.2] | Loss=0.03165 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.291 | L2-Norm(final)=2.520 | 3532.4 samples/s | 55.2 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03092 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.299 | L2-Norm(final)=2.522 | 3774.3 samples/s | 59.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step4800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.6] | Loss=0.12651 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.155 | L2-Norm(final)=2.510 | 3607.1 samples/s | 56.4 steps/s
[Step=4050 Epoch=19.9] | Loss=0.07360 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.159 | L2-Norm(final)=2.483 | 3451.3 samples/s | 53.9 steps/s
[Step=4100 Epoch=20.1] | Loss=0.06350 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.170 | L2-Norm(final)=2.480 | 3485.7 samples/s | 54.5 steps/s
[Step=4150 Epoch=20.4] | Loss=0.05847 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.179 | L2-Norm(final)=2.478 | 3499.9 samples/s | 54.7 steps/s
[Step=4200 Epoch=20.6] | Loss=0.05284 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.189 | L2-Norm(final)=2.477 | 4390.3 samples/s | 68.6 steps/s
[Step=4250 Epoch=20.8] | Loss=0.04735 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.200 | L2-Norm(final)=2.481 | 1552.8 samples/s | 24.3 steps/s
[Step=4300 Epoch=21.1] | Loss=0.04444 | Reg=0.00369 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.210 | L2-Norm(final)=2.484 | 3535.0 samples/s | 55.2 steps/s
[Step=4350 Epoch=21.3] | Loss=0.04349 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9062 | L2-Norm=19.220 | L2-Norm(final)=2.486 | 3534.8 samples/s | 55.2 steps/s
[Step=4400 Epoch=21.6] | Loss=0.04247 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.230 | L2-Norm(final)=2.486 | 4270.5 samples/s | 66.7 steps/s
[Step=4450 Epoch=21.8] | Loss=0.04037 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.240 | L2-Norm(final)=2.488 | 1571.5 samples/s | 24.6 steps/s
[Step=4500 Epoch=22.1] | Loss=0.03862 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.249 | L2-Norm(final)=2.491 | 3505.7 samples/s | 54.8 steps/s
[Step=4550 Epoch=22.3] | Loss=0.03722 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.259 | L2-Norm(final)=2.494 | 3487.2 samples/s | 54.5 steps/s
[Step=4600 Epoch=22.6] | Loss=0.03603 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.268 | L2-Norm(final)=2.497 | 4111.3 samples/s | 64.2 steps/s
[Step=4650 Epoch=22.8] | Loss=0.03480 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.278 | L2-Norm(final)=2.500 | 1591.8 samples/s | 24.9 steps/s
[Step=4700 Epoch=23.0] | Loss=0.03340 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.288 | L2-Norm(final)=2.503 | 3528.1 samples/s | 55.1 steps/s
[Step=4750 Epoch=23.3] | Loss=0.03261 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.297 | L2-Norm(final)=2.506 | 3533.6 samples/s | 55.2 steps/s
[Step=4800 Epoch=23.5] | Loss=0.03212 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.305 | L2-Norm(final)=2.509 | 3991.9 samples/s | 62.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step4800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=37.9] | Loss=0.18116 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.155 | L2-Norm(final)=2.511 | 3634.9 samples/s | 56.8 steps/s
[Step=4050 Epoch=38.4] | Loss=0.02906 | Reg=0.00371 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.253 | L2-Norm(final)=2.478 | 3161.1 samples/s | 49.4 steps/s
[Step=4100 Epoch=38.9] | Loss=0.01603 | Reg=0.00371 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.265 | L2-Norm(final)=2.479 | 4205.7 samples/s | 65.7 steps/s
[Step=4150 Epoch=39.3] | Loss=0.01073 | Reg=0.00371 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.255 | L2-Norm(final)=2.483 | 1508.7 samples/s | 23.6 steps/s
[Step=4200 Epoch=39.8] | Loss=0.00808 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.242 | L2-Norm(final)=2.487 | 3965.8 samples/s | 62.0 steps/s
[Step=4250 Epoch=40.3] | Loss=0.00648 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.491 | 1538.2 samples/s | 24.0 steps/s
[Step=4300 Epoch=40.7] | Loss=0.00541 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.217 | L2-Norm(final)=2.494 | 3779.5 samples/s | 59.1 steps/s
[Step=4350 Epoch=41.2] | Loss=0.00464 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.205 | L2-Norm(final)=2.496 | 1569.4 samples/s | 24.5 steps/s
[Step=4400 Epoch=41.7] | Loss=0.00407 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.195 | L2-Norm(final)=2.499 | 3569.3 samples/s | 55.8 steps/s
[Step=4450 Epoch=42.2] | Loss=0.00362 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.186 | L2-Norm(final)=2.501 | 1612.6 samples/s | 25.2 steps/s
[Step=4500 Epoch=42.6] | Loss=0.00327 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.177 | L2-Norm(final)=2.503 | 3392.8 samples/s | 53.0 steps/s
[Step=4550 Epoch=43.1] | Loss=0.00298 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.169 | L2-Norm(final)=2.505 | 1634.9 samples/s | 25.5 steps/s
[Step=4600 Epoch=43.6] | Loss=0.00273 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.162 | L2-Norm(final)=2.507 | 3352.5 samples/s | 52.4 steps/s
[Step=4650 Epoch=44.1] | Loss=0.00253 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.155 | L2-Norm(final)=2.509 | 1618.8 samples/s | 25.3 steps/s
[Step=4700 Epoch=44.5] | Loss=0.00235 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.511 | 3296.3 samples/s | 51.5 steps/s
[Step=4750 Epoch=45.0] | Loss=0.00220 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.143 | L2-Norm(final)=2.513 | 1621.5 samples/s | 25.3 steps/s
[Step=4800 Epoch=45.5] | Loss=0.00207 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.514 | 3230.3 samples/s | 50.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step4800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.15643 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.155 | L2-Norm(final)=2.511 | 3554.7 samples/s | 55.5 steps/s
[Step=4050 Epoch=38.5] | Loss=0.02883 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.245 | L2-Norm(final)=2.464 | 3230.1 samples/s | 50.5 steps/s
[Step=4100 Epoch=39.0] | Loss=0.01756 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.254 | L2-Norm(final)=2.458 | 4238.2 samples/s | 66.2 steps/s
[Step=4150 Epoch=39.5] | Loss=0.01226 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.252 | L2-Norm(final)=2.462 | 1506.2 samples/s | 23.5 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00925 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.245 | L2-Norm(final)=2.468 | 3990.7 samples/s | 62.4 steps/s
[Step=4250 Epoch=40.4] | Loss=0.00741 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=2.472 | 1529.2 samples/s | 23.9 steps/s
[Step=4300 Epoch=40.9] | Loss=0.00618 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.224 | L2-Norm(final)=2.476 | 3771.2 samples/s | 58.9 steps/s
[Step=4350 Epoch=41.4] | Loss=0.00530 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.213 | L2-Norm(final)=2.480 | 1589.8 samples/s | 24.8 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00465 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.483 | 3621.0 samples/s | 56.6 steps/s
[Step=4450 Epoch=42.3] | Loss=0.00414 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.194 | L2-Norm(final)=2.486 | 1614.6 samples/s | 25.2 steps/s
[Step=4500 Epoch=42.8] | Loss=0.00373 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.185 | L2-Norm(final)=2.489 | 3414.5 samples/s | 53.4 steps/s
[Step=4550 Epoch=43.3] | Loss=0.00339 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.177 | L2-Norm(final)=2.491 | 1660.0 samples/s | 25.9 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00312 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.170 | L2-Norm(final)=2.494 | 3338.6 samples/s | 52.2 steps/s
[Step=4650 Epoch=44.2] | Loss=0.00288 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.163 | L2-Norm(final)=2.496 | 1676.7 samples/s | 26.2 steps/s
[Step=4700 Epoch=44.7] | Loss=0.00268 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.156 | L2-Norm(final)=2.499 | 3340.1 samples/s | 52.2 steps/s
[Step=4750 Epoch=45.2] | Loss=0.00250 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.150 | L2-Norm(final)=2.501 | 1689.3 samples/s | 26.4 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00235 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.145 | L2-Norm(final)=2.503 | 3318.2 samples/s | 51.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step4800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=38.2] | Loss=0.29011 | Reg=0.00367 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=19.155 | L2-Norm(final)=2.509 | 3540.8 samples/s | 55.3 steps/s
[Step=4050 Epoch=38.7] | Loss=0.02455 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.471 | 3235.1 samples/s | 50.5 steps/s
[Step=4100 Epoch=39.2] | Loss=0.01295 | Reg=0.00370 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.225 | L2-Norm(final)=2.473 | 4315.6 samples/s | 67.4 steps/s
[Step=4150 Epoch=39.6] | Loss=0.01237 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.227 | L2-Norm(final)=2.473 | 1512.6 samples/s | 23.6 steps/s
[Step=4200 Epoch=40.1] | Loss=0.01008 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.240 | L2-Norm(final)=2.469 | 4052.0 samples/s | 63.3 steps/s
[Step=4250 Epoch=40.6] | Loss=0.00809 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.242 | L2-Norm(final)=2.469 | 1538.4 samples/s | 24.0 steps/s
[Step=4300 Epoch=41.1] | Loss=0.00679 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.239 | L2-Norm(final)=2.470 | 3835.2 samples/s | 59.9 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00584 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.233 | L2-Norm(final)=2.472 | 1553.9 samples/s | 24.3 steps/s
[Step=4400 Epoch=42.0] | Loss=0.00512 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.227 | L2-Norm(final)=2.474 | 3648.9 samples/s | 57.0 steps/s
[Step=4450 Epoch=42.5] | Loss=0.00455 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.477 | 1590.2 samples/s | 24.8 steps/s
[Step=4500 Epoch=43.0] | Loss=0.00410 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.213 | L2-Norm(final)=2.479 | 3531.1 samples/s | 55.2 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00373 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.205 | L2-Norm(final)=2.481 | 1619.5 samples/s | 25.3 steps/s
[Step=4600 Epoch=43.9] | Loss=0.00342 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.199 | L2-Norm(final)=2.483 | 3419.4 samples/s | 53.4 steps/s
[Step=4650 Epoch=44.4] | Loss=0.00316 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.485 | 1648.7 samples/s | 25.8 steps/s
[Step=4700 Epoch=44.9] | Loss=0.00294 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.186 | L2-Norm(final)=2.487 | 3372.8 samples/s | 52.7 steps/s
[Step=4750 Epoch=45.4] | Loss=0.00275 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.179 | L2-Norm(final)=2.489 | 1641.8 samples/s | 25.7 steps/s
[Step=4800 Epoch=45.8] | Loss=0.00258 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.174 | L2-Norm(final)=2.491 | 3345.5 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step4800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=37.7] | Loss=0.17823 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.155 | L2-Norm(final)=2.510 | 3639.2 samples/s | 56.9 steps/s
[Step=4050 Epoch=38.2] | Loss=0.02901 | Reg=0.00371 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.257 | L2-Norm(final)=2.471 | 3231.2 samples/s | 50.5 steps/s
[Step=4100 Epoch=38.6] | Loss=0.01857 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.263 | L2-Norm(final)=2.466 | 4175.8 samples/s | 65.2 steps/s
[Step=4150 Epoch=39.1] | Loss=0.01282 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.257 | L2-Norm(final)=2.464 | 1516.2 samples/s | 23.7 steps/s
[Step=4200 Epoch=39.6] | Loss=0.00968 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.247 | L2-Norm(final)=2.467 | 3935.0 samples/s | 61.5 steps/s
[Step=4250 Epoch=40.0] | Loss=0.00777 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.236 | L2-Norm(final)=2.471 | 1563.8 samples/s | 24.4 steps/s
[Step=4300 Epoch=40.5] | Loss=0.00648 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.225 | L2-Norm(final)=2.475 | 3653.4 samples/s | 57.1 steps/s
[Step=4350 Epoch=41.0] | Loss=0.00557 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.214 | L2-Norm(final)=2.478 | 1596.0 samples/s | 24.9 steps/s
[Step=4400 Epoch=41.5] | Loss=0.00488 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.482 | 3465.2 samples/s | 54.1 steps/s
[Step=4450 Epoch=41.9] | Loss=0.00434 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.194 | L2-Norm(final)=2.485 | 1636.7 samples/s | 25.6 steps/s
[Step=4500 Epoch=42.4] | Loss=0.00392 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.185 | L2-Norm(final)=2.488 | 3348.7 samples/s | 52.3 steps/s
[Step=4550 Epoch=42.9] | Loss=0.00357 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.177 | L2-Norm(final)=2.491 | 1652.3 samples/s | 25.8 steps/s
[Step=4600 Epoch=43.3] | Loss=0.00327 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.169 | L2-Norm(final)=2.493 | 3384.9 samples/s | 52.9 steps/s
[Step=4650 Epoch=43.8] | Loss=0.00303 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.162 | L2-Norm(final)=2.496 | 1679.5 samples/s | 26.2 steps/s
[Step=4700 Epoch=44.3] | Loss=0.00282 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.156 | L2-Norm(final)=2.498 | 3336.5 samples/s | 52.1 steps/s
[Step=4750 Epoch=44.8] | Loss=0.00263 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.150 | L2-Norm(final)=2.501 | 1726.6 samples/s | 27.0 steps/s
[Step=4800 Epoch=45.2] | Loss=0.00247 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.503 | 3160.3 samples/s | 49.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step4800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.12109 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.155 | L2-Norm(final)=2.512 | 3656.5 samples/s | 57.1 steps/s
[Step=4050 Epoch=38.6] | Loss=0.02624 | Reg=0.00371 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.270 | L2-Norm(final)=2.466 | 3144.1 samples/s | 49.1 steps/s
[Step=4100 Epoch=39.1] | Loss=0.01612 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.293 | L2-Norm(final)=2.461 | 4267.6 samples/s | 66.7 steps/s
[Step=4150 Epoch=39.6] | Loss=0.01087 | Reg=0.00372 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.290 | L2-Norm(final)=2.467 | 1496.4 samples/s | 23.4 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00870 | Reg=0.00372 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.280 | L2-Norm(final)=2.474 | 4031.9 samples/s | 63.0 steps/s
[Step=4250 Epoch=40.5] | Loss=0.00748 | Reg=0.00372 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.274 | L2-Norm(final)=2.478 | 1529.1 samples/s | 23.9 steps/s
[Step=4300 Epoch=41.0] | Loss=0.00678 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.268 | L2-Norm(final)=2.482 | 3809.4 samples/s | 59.5 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00590 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.266 | L2-Norm(final)=2.486 | 1569.5 samples/s | 24.5 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00518 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.490 | 3648.9 samples/s | 57.0 steps/s
[Step=4450 Epoch=42.4] | Loss=0.00461 | Reg=0.00371 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.254 | L2-Norm(final)=2.494 | 1581.0 samples/s | 24.7 steps/s
[Step=4500 Epoch=42.9] | Loss=0.00415 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.247 | L2-Norm(final)=2.497 | 3538.9 samples/s | 55.3 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00378 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.239 | L2-Norm(final)=2.500 | 1618.4 samples/s | 25.3 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00347 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.231 | L2-Norm(final)=2.503 | 3393.4 samples/s | 53.0 steps/s
[Step=4650 Epoch=44.3] | Loss=0.00321 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.223 | L2-Norm(final)=2.506 | 1641.9 samples/s | 25.7 steps/s
[Step=4700 Epoch=44.8] | Loss=0.00298 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.215 | L2-Norm(final)=2.508 | 3363.1 samples/s | 52.5 steps/s
[Step=4750 Epoch=45.3] | Loss=0.00279 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.208 | L2-Norm(final)=2.510 | 1664.3 samples/s | 26.0 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00262 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.201 | L2-Norm(final)=2.513 | 3368.2 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26767 | acc=0.7905 | tpr=0.7038 | fpr=0.0213 | 3622.4 samples/s | 14.1 steps/s
Avg test loss: 0.27004, Avg test acc: 0.79057, Avg tpr: 0.70548, Avg fpr: 0.02230, total FA: 174

Testing server on iccad2012
[Step=  50] | Loss=0.39878 | acc=0.7564 | tpr=0.9690 | fpr=0.2474 | 3632.1 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.39781 | acc=0.7573 | tpr=0.9723 | fpr=0.2467 | 6725.5 samples/s | 26.3 steps/s
[Step= 150] | Loss=0.40003 | acc=0.7581 | tpr=0.9755 | fpr=0.2459 | 6947.4 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.39942 | acc=0.7587 | tpr=0.9760 | fpr=0.2452 | 6755.3 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.39919 | acc=0.7595 | tpr=0.9729 | fpr=0.2444 | 6931.6 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.39793 | acc=0.7602 | tpr=0.9716 | fpr=0.2437 | 7095.1 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.39776 | acc=0.7608 | tpr=0.9724 | fpr=0.2431 | 6594.3 samples/s | 25.8 steps/s
[Step= 400] | Loss=0.39807 | acc=0.7602 | tpr=0.9699 | fpr=0.2437 | 6799.0 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.40070 | acc=0.7596 | tpr=0.9698 | fpr=0.2443 | 6705.4 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.40202 | acc=0.7587 | tpr=0.9696 | fpr=0.2451 | 6660.6 samples/s | 26.0 steps/s
[Step= 550] | Loss=0.40169 | acc=0.7587 | tpr=0.9694 | fpr=0.2451 | 12656.6 samples/s | 49.4 steps/s
Avg test loss: 0.40155, Avg test acc: 0.75867, Avg tpr: 0.96949, Avg fpr: 0.24516, total FA: 34040

server round 6/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.27583 | Reg=0.00367 | FP-Reg=0.000 | acc=0.7656 | L2-Norm=19.151 | L2-Norm(final)=2.539 | 3570.5 samples/s | 55.8 steps/s
[Step=4850 Epoch=23.6] | Loss=0.07225 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.158 | L2-Norm(final)=2.505 | 3424.3 samples/s | 53.5 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05590 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.165 | L2-Norm(final)=2.503 | 3501.9 samples/s | 54.7 steps/s
[Step=4950 Epoch=24.1] | Loss=0.05445 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.177 | L2-Norm(final)=2.505 | 3494.1 samples/s | 54.6 steps/s
[Step=5000 Epoch=24.4] | Loss=0.05388 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.189 | L2-Norm(final)=2.504 | 4343.8 samples/s | 67.9 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04916 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.202 | L2-Norm(final)=2.504 | 1566.6 samples/s | 24.5 steps/s
[Step=5100 Epoch=24.9] | Loss=0.04710 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.215 | L2-Norm(final)=2.507 | 3502.7 samples/s | 54.7 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04450 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.227 | L2-Norm(final)=2.509 | 3512.5 samples/s | 54.9 steps/s
[Step=5200 Epoch=25.4] | Loss=0.04244 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.238 | L2-Norm(final)=2.511 | 4128.5 samples/s | 64.5 steps/s
[Step=5250 Epoch=25.6] | Loss=0.04007 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.249 | L2-Norm(final)=2.514 | 1582.4 samples/s | 24.7 steps/s
[Step=5300 Epoch=25.8] | Loss=0.03848 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.259 | L2-Norm(final)=2.517 | 3511.1 samples/s | 54.9 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03731 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.269 | L2-Norm(final)=2.519 | 3515.0 samples/s | 54.9 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03653 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.277 | L2-Norm(final)=2.520 | 3928.3 samples/s | 61.4 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03492 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.286 | L2-Norm(final)=2.521 | 1610.4 samples/s | 25.2 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03381 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.293 | L2-Norm(final)=2.523 | 3521.2 samples/s | 55.0 steps/s
[Step=5550 Epoch=27.1] | Loss=0.03317 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.299 | L2-Norm(final)=2.524 | 3508.2 samples/s | 54.8 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03246 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.306 | L2-Norm(final)=2.526 | 3754.6 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step5600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.14482 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.151 | L2-Norm(final)=2.541 | 3596.6 samples/s | 56.2 steps/s
[Step=4850 Epoch=23.7] | Loss=0.06249 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.149 | L2-Norm(final)=2.507 | 3449.0 samples/s | 53.9 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05361 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.154 | L2-Norm(final)=2.504 | 3536.9 samples/s | 55.3 steps/s
[Step=4950 Epoch=24.2] | Loss=0.05234 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.161 | L2-Norm(final)=2.502 | 3537.3 samples/s | 55.3 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04949 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.169 | L2-Norm(final)=2.501 | 4387.9 samples/s | 68.6 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04543 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.180 | L2-Norm(final)=2.503 | 1551.1 samples/s | 24.2 steps/s
[Step=5100 Epoch=24.9] | Loss=0.04249 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.191 | L2-Norm(final)=2.505 | 3497.4 samples/s | 54.6 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04116 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.202 | L2-Norm(final)=2.505 | 3499.5 samples/s | 54.7 steps/s
[Step=5200 Epoch=25.4] | Loss=0.04012 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.213 | L2-Norm(final)=2.506 | 4161.3 samples/s | 65.0 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03749 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.223 | L2-Norm(final)=2.507 | 1584.9 samples/s | 24.8 steps/s
[Step=5300 Epoch=25.9] | Loss=0.03578 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.232 | L2-Norm(final)=2.509 | 3512.0 samples/s | 54.9 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03422 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.240 | L2-Norm(final)=2.512 | 3501.9 samples/s | 54.7 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03342 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.247 | L2-Norm(final)=2.513 | 4002.0 samples/s | 62.5 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03212 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.254 | L2-Norm(final)=2.516 | 1594.8 samples/s | 24.9 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03104 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.261 | L2-Norm(final)=2.518 | 3526.6 samples/s | 55.1 steps/s
[Step=5550 Epoch=27.1] | Loss=0.03032 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.268 | L2-Norm(final)=2.521 | 3521.4 samples/s | 55.0 steps/s
[Step=5600 Epoch=27.3] | Loss=0.02982 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.275 | L2-Norm(final)=2.523 | 3818.4 samples/s | 59.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step5600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.18622 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.151 | L2-Norm(final)=2.540 | 3550.9 samples/s | 55.5 steps/s
[Step=4850 Epoch=23.6] | Loss=0.05450 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.143 | L2-Norm(final)=2.521 | 3508.6 samples/s | 54.8 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05475 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.152 | L2-Norm(final)=2.512 | 3532.8 samples/s | 55.2 steps/s
[Step=4950 Epoch=24.1] | Loss=0.05385 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.164 | L2-Norm(final)=2.506 | 3536.3 samples/s | 55.3 steps/s
[Step=5000 Epoch=24.4] | Loss=0.05129 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.177 | L2-Norm(final)=2.504 | 4363.6 samples/s | 68.2 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04706 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.189 | L2-Norm(final)=2.503 | 1561.3 samples/s | 24.4 steps/s
[Step=5100 Epoch=24.8] | Loss=0.04335 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.201 | L2-Norm(final)=2.505 | 3509.8 samples/s | 54.8 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04102 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.212 | L2-Norm(final)=2.508 | 3502.0 samples/s | 54.7 steps/s
[Step=5200 Epoch=25.3] | Loss=0.03970 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.223 | L2-Norm(final)=2.512 | 4145.6 samples/s | 64.8 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03874 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.234 | L2-Norm(final)=2.515 | 1609.8 samples/s | 25.2 steps/s
[Step=5300 Epoch=25.8] | Loss=0.03700 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.246 | L2-Norm(final)=2.517 | 3523.3 samples/s | 55.1 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03588 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.257 | L2-Norm(final)=2.520 | 3522.0 samples/s | 55.0 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03543 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.267 | L2-Norm(final)=2.521 | 3933.6 samples/s | 61.5 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03430 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.277 | L2-Norm(final)=2.523 | 1617.0 samples/s | 25.3 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03288 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.286 | L2-Norm(final)=2.525 | 3512.5 samples/s | 54.9 steps/s
[Step=5550 Epoch=27.0] | Loss=0.03181 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.293 | L2-Norm(final)=2.526 | 3506.6 samples/s | 54.8 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03136 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.300 | L2-Norm(final)=2.527 | 3732.8 samples/s | 58.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step5600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.16084 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.151 | L2-Norm(final)=2.541 | 3674.3 samples/s | 57.4 steps/s
[Step=4850 Epoch=23.7] | Loss=0.06551 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.181 | L2-Norm(final)=2.513 | 3360.5 samples/s | 52.5 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05579 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.183 | L2-Norm(final)=2.511 | 3516.6 samples/s | 54.9 steps/s
[Step=4950 Epoch=24.1] | Loss=0.05583 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.183 | L2-Norm(final)=2.502 | 3492.9 samples/s | 54.6 steps/s
[Step=5000 Epoch=24.4] | Loss=0.05332 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.185 | L2-Norm(final)=2.494 | 4373.5 samples/s | 68.3 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04770 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.192 | L2-Norm(final)=2.492 | 1556.5 samples/s | 24.3 steps/s
[Step=5100 Epoch=24.9] | Loss=0.04380 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.200 | L2-Norm(final)=2.495 | 3452.0 samples/s | 53.9 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04138 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.208 | L2-Norm(final)=2.497 | 3518.2 samples/s | 55.0 steps/s
[Step=5200 Epoch=25.4] | Loss=0.03956 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.216 | L2-Norm(final)=2.499 | 4137.9 samples/s | 64.7 steps/s
[Step=5250 Epoch=25.6] | Loss=0.04207 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.228 | L2-Norm(final)=2.498 | 1576.8 samples/s | 24.6 steps/s
[Step=5300 Epoch=25.8] | Loss=0.04170 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.242 | L2-Norm(final)=2.495 | 3471.9 samples/s | 54.2 steps/s
[Step=5350 Epoch=26.1] | Loss=0.04009 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.256 | L2-Norm(final)=2.495 | 3523.7 samples/s | 55.1 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03928 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.268 | L2-Norm(final)=2.494 | 3935.6 samples/s | 61.5 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03781 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.278 | L2-Norm(final)=2.494 | 1639.1 samples/s | 25.6 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03680 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.287 | L2-Norm(final)=2.494 | 3502.2 samples/s | 54.7 steps/s
[Step=5550 Epoch=27.1] | Loss=0.03555 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.295 | L2-Norm(final)=2.494 | 3487.4 samples/s | 54.5 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03452 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.303 | L2-Norm(final)=2.495 | 3728.4 samples/s | 58.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step5600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.5] | Loss=0.22644 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.151 | L2-Norm(final)=2.540 | 3775.4 samples/s | 59.0 steps/s
[Step=4850 Epoch=23.8] | Loss=0.06900 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.176 | L2-Norm(final)=2.509 | 3276.6 samples/s | 51.2 steps/s
[Step=4900 Epoch=24.0] | Loss=0.05687 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.187 | L2-Norm(final)=2.510 | 3491.2 samples/s | 54.5 steps/s
[Step=4950 Epoch=24.3] | Loss=0.05493 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.196 | L2-Norm(final)=2.509 | 3494.5 samples/s | 54.6 steps/s
[Step=5000 Epoch=24.5] | Loss=0.05302 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.206 | L2-Norm(final)=2.503 | 4409.0 samples/s | 68.9 steps/s
[Step=5050 Epoch=24.8] | Loss=0.04761 | Reg=0.00369 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.218 | L2-Norm(final)=2.503 | 1525.1 samples/s | 23.8 steps/s
[Step=5100 Epoch=25.0] | Loss=0.04377 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.230 | L2-Norm(final)=2.506 | 3501.3 samples/s | 54.7 steps/s
[Step=5150 Epoch=25.3] | Loss=0.04150 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.240 | L2-Norm(final)=2.509 | 3502.2 samples/s | 54.7 steps/s
[Step=5200 Epoch=25.5] | Loss=0.04018 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.251 | L2-Norm(final)=2.511 | 4231.1 samples/s | 66.1 steps/s
[Step=5250 Epoch=25.7] | Loss=0.03805 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.261 | L2-Norm(final)=2.514 | 1581.5 samples/s | 24.7 steps/s
[Step=5300 Epoch=26.0] | Loss=0.03627 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.270 | L2-Norm(final)=2.517 | 3511.0 samples/s | 54.9 steps/s
[Step=5350 Epoch=26.2] | Loss=0.03449 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.278 | L2-Norm(final)=2.521 | 3522.7 samples/s | 55.0 steps/s
[Step=5400 Epoch=26.5] | Loss=0.03367 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.286 | L2-Norm(final)=2.524 | 4125.9 samples/s | 64.5 steps/s
[Step=5450 Epoch=26.7] | Loss=0.03260 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.294 | L2-Norm(final)=2.527 | 1589.7 samples/s | 24.8 steps/s
[Step=5500 Epoch=27.0] | Loss=0.03147 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.302 | L2-Norm(final)=2.531 | 3492.0 samples/s | 54.6 steps/s
[Step=5550 Epoch=27.2] | Loss=0.03065 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.309 | L2-Norm(final)=2.534 | 3483.8 samples/s | 54.4 steps/s
[Step=5600 Epoch=27.5] | Loss=0.03009 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.315 | L2-Norm(final)=2.537 | 3960.3 samples/s | 61.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step5600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.5] | Loss=0.16766 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.151 | L2-Norm(final)=2.542 | 3397.1 samples/s | 53.1 steps/s
[Step=4850 Epoch=46.0] | Loss=0.03040 | Reg=0.00371 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.251 | L2-Norm(final)=2.506 | 3360.7 samples/s | 52.5 steps/s
[Step=4900 Epoch=46.4] | Loss=0.02200 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.294 | L2-Norm(final)=2.480 | 4194.6 samples/s | 65.5 steps/s
[Step=4950 Epoch=46.9] | Loss=0.01505 | Reg=0.00373 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.301 | L2-Norm(final)=2.474 | 1502.2 samples/s | 23.5 steps/s
[Step=5000 Epoch=47.4] | Loss=0.01132 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.294 | L2-Norm(final)=2.475 | 3971.2 samples/s | 62.1 steps/s
[Step=5050 Epoch=47.9] | Loss=0.00908 | Reg=0.00372 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.284 | L2-Norm(final)=2.478 | 1539.2 samples/s | 24.0 steps/s
[Step=5100 Epoch=48.3] | Loss=0.00758 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.272 | L2-Norm(final)=2.481 | 3787.9 samples/s | 59.2 steps/s
[Step=5150 Epoch=48.8] | Loss=0.00650 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.484 | 1592.1 samples/s | 24.9 steps/s
[Step=5200 Epoch=49.3] | Loss=0.00570 | Reg=0.00371 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.250 | L2-Norm(final)=2.487 | 3542.2 samples/s | 55.3 steps/s
[Step=5250 Epoch=49.7] | Loss=0.00507 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.239 | L2-Norm(final)=2.490 | 1625.6 samples/s | 25.4 steps/s
[Step=5300 Epoch=50.2] | Loss=0.00457 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.493 | 3407.4 samples/s | 53.2 steps/s
[Step=5350 Epoch=50.7] | Loss=0.00416 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.496 | 1658.5 samples/s | 25.9 steps/s
[Step=5400 Epoch=51.2] | Loss=0.00382 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.211 | L2-Norm(final)=2.499 | 3349.2 samples/s | 52.3 steps/s
[Step=5450 Epoch=51.6] | Loss=0.00353 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.502 | 1677.0 samples/s | 26.2 steps/s
[Step=5500 Epoch=52.1] | Loss=0.00328 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.196 | L2-Norm(final)=2.504 | 3333.3 samples/s | 52.1 steps/s
[Step=5550 Epoch=52.6] | Loss=0.00306 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.189 | L2-Norm(final)=2.507 | 1687.0 samples/s | 26.4 steps/s
[Step=5600 Epoch=53.1] | Loss=0.00288 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.182 | L2-Norm(final)=2.509 | 3301.0 samples/s | 51.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step5600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.7] | Loss=0.09368 | Reg=0.00367 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.151 | L2-Norm(final)=2.542 | 3631.0 samples/s | 56.7 steps/s
[Step=4850 Epoch=46.1] | Loss=0.03551 | Reg=0.00369 | FP-Reg=0.006 | acc=0.9375 | L2-Norm=19.221 | L2-Norm(final)=2.521 | 3169.0 samples/s | 49.5 steps/s
[Step=4900 Epoch=46.6] | Loss=0.02889 | Reg=0.00373 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.311 | L2-Norm(final)=2.472 | 4255.9 samples/s | 66.5 steps/s
[Step=4950 Epoch=47.1] | Loss=0.01974 | Reg=0.00374 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.338 | L2-Norm(final)=2.460 | 1511.2 samples/s | 23.6 steps/s
[Step=5000 Epoch=47.6] | Loss=0.01490 | Reg=0.00374 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.339 | L2-Norm(final)=2.459 | 3978.1 samples/s | 62.2 steps/s
[Step=5050 Epoch=48.0] | Loss=0.01196 | Reg=0.00374 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.332 | L2-Norm(final)=2.461 | 1546.2 samples/s | 24.2 steps/s
[Step=5100 Epoch=48.5] | Loss=0.00999 | Reg=0.00373 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.323 | L2-Norm(final)=2.464 | 3759.4 samples/s | 58.7 steps/s
[Step=5150 Epoch=49.0] | Loss=0.00857 | Reg=0.00373 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.312 | L2-Norm(final)=2.468 | 1573.5 samples/s | 24.6 steps/s
[Step=5200 Epoch=49.5] | Loss=0.00751 | Reg=0.00373 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.301 | L2-Norm(final)=2.471 | 3571.0 samples/s | 55.8 steps/s
[Step=5250 Epoch=49.9] | Loss=0.00668 | Reg=0.00372 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.290 | L2-Norm(final)=2.475 | 1631.5 samples/s | 25.5 steps/s
[Step=5300 Epoch=50.4] | Loss=0.00602 | Reg=0.00372 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.280 | L2-Norm(final)=2.479 | 3408.1 samples/s | 53.3 steps/s
[Step=5350 Epoch=50.9] | Loss=0.00548 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.270 | L2-Norm(final)=2.482 | 1653.5 samples/s | 25.8 steps/s
[Step=5400 Epoch=51.4] | Loss=0.00503 | Reg=0.00371 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.486 | 3392.6 samples/s | 53.0 steps/s
[Step=5450 Epoch=51.8] | Loss=0.00465 | Reg=0.00371 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.252 | L2-Norm(final)=2.489 | 1663.8 samples/s | 26.0 steps/s
[Step=5500 Epoch=52.3] | Loss=0.00432 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.243 | L2-Norm(final)=2.492 | 3331.0 samples/s | 52.0 steps/s
[Step=5550 Epoch=52.8] | Loss=0.00404 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=2.495 | 1666.7 samples/s | 26.0 steps/s
[Step=5600 Epoch=53.3] | Loss=0.00379 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.228 | L2-Norm(final)=2.499 | 3342.0 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step5600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.8] | Loss=0.09104 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.151 | L2-Norm(final)=2.542 | 3468.7 samples/s | 54.2 steps/s
[Step=4850 Epoch=46.3] | Loss=0.01879 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.187 | L2-Norm(final)=2.511 | 3266.8 samples/s | 51.0 steps/s
[Step=4900 Epoch=46.8] | Loss=0.01053 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.194 | L2-Norm(final)=2.509 | 4238.6 samples/s | 66.2 steps/s
[Step=4950 Epoch=47.3] | Loss=0.00744 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.191 | L2-Norm(final)=2.512 | 1496.8 samples/s | 23.4 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00578 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.185 | L2-Norm(final)=2.516 | 4027.6 samples/s | 62.9 steps/s
[Step=5050 Epoch=48.2] | Loss=0.00464 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.177 | L2-Norm(final)=2.519 | 1543.4 samples/s | 24.1 steps/s
[Step=5100 Epoch=48.7] | Loss=0.00387 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.169 | L2-Norm(final)=2.523 | 3829.6 samples/s | 59.8 steps/s
[Step=5150 Epoch=49.2] | Loss=0.00333 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.161 | L2-Norm(final)=2.526 | 1526.9 samples/s | 23.9 steps/s
[Step=5200 Epoch=49.7] | Loss=0.00292 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.154 | L2-Norm(final)=2.528 | 3657.2 samples/s | 57.1 steps/s
[Step=5250 Epoch=50.1] | Loss=0.00260 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.147 | L2-Norm(final)=2.531 | 1590.5 samples/s | 24.9 steps/s
[Step=5300 Epoch=50.6] | Loss=0.00234 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.140 | L2-Norm(final)=2.533 | 3543.7 samples/s | 55.4 steps/s
[Step=5350 Epoch=51.1] | Loss=0.00213 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.535 | 1614.6 samples/s | 25.2 steps/s
[Step=5400 Epoch=51.6] | Loss=0.00196 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.128 | L2-Norm(final)=2.537 | 3416.5 samples/s | 53.4 steps/s
[Step=5450 Epoch=52.0] | Loss=0.00181 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.122 | L2-Norm(final)=2.539 | 1640.7 samples/s | 25.6 steps/s
[Step=5500 Epoch=52.5] | Loss=0.00169 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.117 | L2-Norm(final)=2.541 | 3384.8 samples/s | 52.9 steps/s
[Step=5550 Epoch=53.0] | Loss=0.00158 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.543 | 1663.3 samples/s | 26.0 steps/s
[Step=5600 Epoch=53.5] | Loss=0.00148 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.108 | L2-Norm(final)=2.544 | 3365.0 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step5600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.2] | Loss=0.14719 | Reg=0.00367 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.151 | L2-Norm(final)=2.542 | 3589.5 samples/s | 56.1 steps/s
[Step=4850 Epoch=45.7] | Loss=0.02739 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.211 | L2-Norm(final)=2.499 | 3187.9 samples/s | 49.8 steps/s
[Step=4900 Epoch=46.2] | Loss=0.01812 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.227 | L2-Norm(final)=2.487 | 4176.6 samples/s | 65.3 steps/s
[Step=4950 Epoch=46.6] | Loss=0.01347 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=2.483 | 1522.4 samples/s | 23.8 steps/s
[Step=5000 Epoch=47.1] | Loss=0.01054 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.238 | L2-Norm(final)=2.485 | 3911.6 samples/s | 61.1 steps/s
[Step=5050 Epoch=47.6] | Loss=0.00846 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.236 | L2-Norm(final)=2.489 | 1543.8 samples/s | 24.1 steps/s
[Step=5100 Epoch=48.1] | Loss=0.00707 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.231 | L2-Norm(final)=2.493 | 3668.9 samples/s | 57.3 steps/s
[Step=5150 Epoch=48.5] | Loss=0.00607 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.224 | L2-Norm(final)=2.497 | 1610.2 samples/s | 25.2 steps/s
[Step=5200 Epoch=49.0] | Loss=0.00531 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.216 | L2-Norm(final)=2.500 | 3435.7 samples/s | 53.7 steps/s
[Step=5250 Epoch=49.5] | Loss=0.00473 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.208 | L2-Norm(final)=2.503 | 1639.7 samples/s | 25.6 steps/s
[Step=5300 Epoch=49.9] | Loss=0.00426 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.200 | L2-Norm(final)=2.506 | 3387.0 samples/s | 52.9 steps/s
[Step=5350 Epoch=50.4] | Loss=0.00388 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.509 | 1668.0 samples/s | 26.1 steps/s
[Step=5400 Epoch=50.9] | Loss=0.00356 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.185 | L2-Norm(final)=2.512 | 3369.8 samples/s | 52.7 steps/s
[Step=5450 Epoch=51.4] | Loss=0.00329 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.178 | L2-Norm(final)=2.515 | 1662.6 samples/s | 26.0 steps/s
[Step=5500 Epoch=51.8] | Loss=0.00306 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.171 | L2-Norm(final)=2.517 | 3368.9 samples/s | 52.6 steps/s
[Step=5550 Epoch=52.3] | Loss=0.00286 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.165 | L2-Norm(final)=2.520 | 1740.2 samples/s | 27.2 steps/s
[Step=5600 Epoch=52.8] | Loss=0.00268 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.159 | L2-Norm(final)=2.522 | 3095.4 samples/s | 48.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step5600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.8] | Loss=0.07296 | Reg=0.00367 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.151 | L2-Norm(final)=2.543 | 3420.4 samples/s | 53.4 steps/s
[Step=4850 Epoch=46.2] | Loss=0.02333 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.214 | L2-Norm(final)=2.503 | 3353.7 samples/s | 52.4 steps/s
[Step=4900 Epoch=46.7] | Loss=0.01287 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.226 | L2-Norm(final)=2.502 | 4251.6 samples/s | 66.4 steps/s
[Step=4950 Epoch=47.2] | Loss=0.00878 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.221 | L2-Norm(final)=2.510 | 1498.1 samples/s | 23.4 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00661 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.209 | L2-Norm(final)=2.517 | 4050.3 samples/s | 63.3 steps/s
[Step=5050 Epoch=48.1] | Loss=0.00530 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.198 | L2-Norm(final)=2.523 | 1534.4 samples/s | 24.0 steps/s
[Step=5100 Epoch=48.6] | Loss=0.00442 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.186 | L2-Norm(final)=2.527 | 3867.2 samples/s | 60.4 steps/s
[Step=5150 Epoch=49.1] | Loss=0.00380 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.175 | L2-Norm(final)=2.531 | 1573.0 samples/s | 24.6 steps/s
[Step=5200 Epoch=49.6] | Loss=0.00333 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.166 | L2-Norm(final)=2.534 | 3685.0 samples/s | 57.6 steps/s
[Step=5250 Epoch=50.0] | Loss=0.00297 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.537 | 1583.1 samples/s | 24.7 steps/s
[Step=5300 Epoch=50.5] | Loss=0.00267 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.540 | 3546.0 samples/s | 55.4 steps/s
[Step=5350 Epoch=51.0] | Loss=0.00244 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.142 | L2-Norm(final)=2.542 | 1621.1 samples/s | 25.3 steps/s
[Step=5400 Epoch=51.5] | Loss=0.00224 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.135 | L2-Norm(final)=2.545 | 3401.5 samples/s | 53.1 steps/s
[Step=5450 Epoch=51.9] | Loss=0.00207 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=2.547 | 1660.9 samples/s | 26.0 steps/s
[Step=5500 Epoch=52.4] | Loss=0.00193 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.123 | L2-Norm(final)=2.549 | 3385.1 samples/s | 52.9 steps/s
[Step=5550 Epoch=52.9] | Loss=0.00180 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.117 | L2-Norm(final)=2.551 | 1651.8 samples/s | 25.8 steps/s
[Step=5600 Epoch=53.4] | Loss=0.00169 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.553 | 3385.6 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24269 | acc=0.8087 | tpr=0.7300 | fpr=0.0206 | 3630.2 samples/s | 14.2 steps/s
Avg test loss: 0.24504, Avg test acc: 0.80956, Avg tpr: 0.73235, Avg fpr: 0.02064, total FA: 161

Testing server on iccad2012
[Step=  50] | Loss=0.43909 | acc=0.7392 | tpr=0.9646 | fpr=0.2648 | 3224.6 samples/s | 12.6 steps/s
[Step= 100] | Loss=0.43994 | acc=0.7400 | tpr=0.9638 | fpr=0.2641 | 5969.0 samples/s | 23.3 steps/s
[Step= 150] | Loss=0.44385 | acc=0.7391 | tpr=0.9669 | fpr=0.2651 | 6830.1 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.44279 | acc=0.7399 | tpr=0.9650 | fpr=0.2642 | 7046.7 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.44326 | acc=0.7399 | tpr=0.9633 | fpr=0.2641 | 6586.4 samples/s | 25.7 steps/s
[Step= 300] | Loss=0.44215 | acc=0.7405 | tpr=0.9644 | fpr=0.2636 | 6805.1 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.44204 | acc=0.7413 | tpr=0.9649 | fpr=0.2628 | 6898.3 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.44242 | acc=0.7407 | tpr=0.9606 | fpr=0.2633 | 6781.6 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.44498 | acc=0.7399 | tpr=0.9606 | fpr=0.2641 | 6855.8 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.44641 | acc=0.7394 | tpr=0.9617 | fpr=0.2647 | 6765.8 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.44589 | acc=0.7399 | tpr=0.9610 | fpr=0.2641 | 12135.6 samples/s | 47.4 steps/s
Avg test loss: 0.44584, Avg test acc: 0.73989, Avg tpr: 0.96117, Avg fpr: 0.26413, total FA: 36674

server round 7/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.07232 | Reg=0.00366 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.140 | L2-Norm(final)=2.549 | 3459.1 samples/s | 54.0 steps/s
[Step=5650 Epoch=27.6] | Loss=0.05724 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.130 | L2-Norm(final)=2.521 | 3548.7 samples/s | 55.4 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05558 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.506 | 3516.2 samples/s | 54.9 steps/s
[Step=5750 Epoch=28.0] | Loss=0.05074 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.148 | L2-Norm(final)=2.501 | 3502.7 samples/s | 54.7 steps/s
[Step=5800 Epoch=28.3] | Loss=0.05070 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.160 | L2-Norm(final)=2.496 | 4352.1 samples/s | 68.0 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04611 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.175 | L2-Norm(final)=2.495 | 1449.3 samples/s | 22.6 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04323 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.189 | L2-Norm(final)=2.498 | 3359.6 samples/s | 52.5 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04133 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.200 | L2-Norm(final)=2.498 | 3357.9 samples/s | 52.5 steps/s
[Step=6000 Epoch=29.3] | Loss=0.03960 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.210 | L2-Norm(final)=2.499 | 3958.6 samples/s | 61.9 steps/s
[Step=6050 Epoch=29.5] | Loss=0.03723 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.220 | L2-Norm(final)=2.501 | 1560.3 samples/s | 24.4 steps/s
[Step=6100 Epoch=29.7] | Loss=0.03606 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.227 | L2-Norm(final)=2.502 | 3502.1 samples/s | 54.7 steps/s
[Step=6150 Epoch=30.0] | Loss=0.03432 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.234 | L2-Norm(final)=2.503 | 3502.3 samples/s | 54.7 steps/s
[Step=6200 Epoch=30.2] | Loss=0.03310 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.241 | L2-Norm(final)=2.505 | 3925.2 samples/s | 61.3 steps/s
[Step=6250 Epoch=30.5] | Loss=0.03189 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.249 | L2-Norm(final)=2.508 | 1621.8 samples/s | 25.3 steps/s
[Step=6300 Epoch=30.7] | Loss=0.03091 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.257 | L2-Norm(final)=2.511 | 3484.7 samples/s | 54.4 steps/s
[Step=6350 Epoch=31.0] | Loss=0.03009 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.264 | L2-Norm(final)=2.513 | 3465.1 samples/s | 54.1 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02958 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.270 | L2-Norm(final)=2.515 | 3760.1 samples/s | 58.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step6400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.10196 | Reg=0.00366 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.140 | L2-Norm(final)=2.549 | 3607.7 samples/s | 56.4 steps/s
[Step=5650 Epoch=27.6] | Loss=0.05686 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.138 | L2-Norm(final)=2.516 | 3426.5 samples/s | 53.5 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05331 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.138 | L2-Norm(final)=2.506 | 3526.4 samples/s | 55.1 steps/s
[Step=5750 Epoch=28.1] | Loss=0.05171 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.145 | L2-Norm(final)=2.496 | 3511.9 samples/s | 54.9 steps/s
[Step=5800 Epoch=28.3] | Loss=0.05043 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.156 | L2-Norm(final)=2.491 | 4354.4 samples/s | 68.0 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04577 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.168 | L2-Norm(final)=2.488 | 1552.2 samples/s | 24.3 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04277 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.180 | L2-Norm(final)=2.489 | 3455.7 samples/s | 54.0 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03959 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.190 | L2-Norm(final)=2.491 | 3520.9 samples/s | 55.0 steps/s
[Step=6000 Epoch=29.3] | Loss=0.03839 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.200 | L2-Norm(final)=2.493 | 4183.2 samples/s | 65.4 steps/s
[Step=6050 Epoch=29.5] | Loss=0.03653 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.210 | L2-Norm(final)=2.495 | 1574.8 samples/s | 24.6 steps/s
[Step=6100 Epoch=29.8] | Loss=0.03459 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.220 | L2-Norm(final)=2.497 | 3514.6 samples/s | 54.9 steps/s
[Step=6150 Epoch=30.0] | Loss=0.03363 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.228 | L2-Norm(final)=2.499 | 3508.1 samples/s | 54.8 steps/s
[Step=6200 Epoch=30.3] | Loss=0.03280 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.237 | L2-Norm(final)=2.502 | 4001.1 samples/s | 62.5 steps/s
[Step=6250 Epoch=30.5] | Loss=0.03172 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.246 | L2-Norm(final)=2.504 | 1596.9 samples/s | 25.0 steps/s
[Step=6300 Epoch=30.7] | Loss=0.03084 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.254 | L2-Norm(final)=2.507 | 3518.2 samples/s | 55.0 steps/s
[Step=6350 Epoch=31.0] | Loss=0.03004 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.261 | L2-Norm(final)=2.509 | 3520.0 samples/s | 55.0 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02950 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.269 | L2-Norm(final)=2.511 | 3837.5 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step6400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.16111 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.140 | L2-Norm(final)=2.548 | 3692.3 samples/s | 57.7 steps/s
[Step=5650 Epoch=27.5] | Loss=0.05430 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.120 | L2-Norm(final)=2.528 | 3492.3 samples/s | 54.6 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05009 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.124 | L2-Norm(final)=2.522 | 3524.8 samples/s | 55.1 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04706 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.133 | L2-Norm(final)=2.516 | 3514.7 samples/s | 54.9 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04521 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.143 | L2-Norm(final)=2.513 | 4360.4 samples/s | 68.1 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04527 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.162 | L2-Norm(final)=2.510 | 1576.2 samples/s | 24.6 steps/s
[Step=5900 Epoch=28.7] | Loss=0.04192 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.181 | L2-Norm(final)=2.510 | 3519.8 samples/s | 55.0 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04038 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.196 | L2-Norm(final)=2.511 | 3523.2 samples/s | 55.0 steps/s
[Step=6000 Epoch=29.2] | Loss=0.03839 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.208 | L2-Norm(final)=2.512 | 4155.0 samples/s | 64.9 steps/s
[Step=6050 Epoch=29.5] | Loss=0.03616 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.219 | L2-Norm(final)=2.514 | 1602.9 samples/s | 25.0 steps/s
[Step=6100 Epoch=29.7] | Loss=0.03418 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.516 | 3503.1 samples/s | 54.7 steps/s
[Step=6150 Epoch=30.0] | Loss=0.03311 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.237 | L2-Norm(final)=2.519 | 3527.7 samples/s | 55.1 steps/s
[Step=6200 Epoch=30.2] | Loss=0.03296 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.247 | L2-Norm(final)=2.520 | 3931.7 samples/s | 61.4 steps/s
[Step=6250 Epoch=30.5] | Loss=0.03231 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.256 | L2-Norm(final)=2.521 | 1634.1 samples/s | 25.5 steps/s
[Step=6300 Epoch=30.7] | Loss=0.03143 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.265 | L2-Norm(final)=2.522 | 3537.1 samples/s | 55.3 steps/s
[Step=6350 Epoch=30.9] | Loss=0.03040 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.273 | L2-Norm(final)=2.524 | 3531.6 samples/s | 55.2 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02999 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.281 | L2-Norm(final)=2.526 | 3741.1 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step6400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.21833 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.140 | L2-Norm(final)=2.547 | 3835.8 samples/s | 59.9 steps/s
[Step=5650 Epoch=27.6] | Loss=0.05341 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.132 | L2-Norm(final)=2.527 | 3244.3 samples/s | 50.7 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04606 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.131 | L2-Norm(final)=2.521 | 3528.9 samples/s | 55.1 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04698 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.139 | L2-Norm(final)=2.519 | 3509.7 samples/s | 54.8 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04587 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.151 | L2-Norm(final)=2.515 | 4369.9 samples/s | 68.3 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04419 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.166 | L2-Norm(final)=2.513 | 1560.0 samples/s | 24.4 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04105 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.183 | L2-Norm(final)=2.514 | 3518.4 samples/s | 55.0 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03963 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.197 | L2-Norm(final)=2.515 | 3510.0 samples/s | 54.8 steps/s
[Step=6000 Epoch=29.3] | Loss=0.03837 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.211 | L2-Norm(final)=2.516 | 4141.7 samples/s | 64.7 steps/s
[Step=6050 Epoch=29.5] | Loss=0.03648 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.222 | L2-Norm(final)=2.517 | 1580.2 samples/s | 24.7 steps/s
[Step=6100 Epoch=29.7] | Loss=0.03503 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.232 | L2-Norm(final)=2.518 | 3500.5 samples/s | 54.7 steps/s
[Step=6150 Epoch=30.0] | Loss=0.03376 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.240 | L2-Norm(final)=2.519 | 3511.9 samples/s | 54.9 steps/s
[Step=6200 Epoch=30.2] | Loss=0.03270 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.248 | L2-Norm(final)=2.520 | 3924.9 samples/s | 61.3 steps/s
[Step=6250 Epoch=30.5] | Loss=0.03209 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.256 | L2-Norm(final)=2.521 | 1635.2 samples/s | 25.5 steps/s
[Step=6300 Epoch=30.7] | Loss=0.03136 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.266 | L2-Norm(final)=2.523 | 3516.6 samples/s | 54.9 steps/s
[Step=6350 Epoch=31.0] | Loss=0.03082 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.275 | L2-Norm(final)=2.524 | 3513.7 samples/s | 54.9 steps/s
[Step=6400 Epoch=31.2] | Loss=0.03046 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.283 | L2-Norm(final)=2.525 | 3747.0 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step6400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.5] | Loss=0.17417 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.140 | L2-Norm(final)=2.548 | 3872.2 samples/s | 60.5 steps/s
[Step=5650 Epoch=27.7] | Loss=0.06033 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.129 | L2-Norm(final)=2.522 | 3248.3 samples/s | 50.8 steps/s
[Step=5700 Epoch=28.0] | Loss=0.05507 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.136 | L2-Norm(final)=2.510 | 3510.5 samples/s | 54.9 steps/s
[Step=5750 Epoch=28.2] | Loss=0.05057 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.147 | L2-Norm(final)=2.507 | 3471.8 samples/s | 54.2 steps/s
[Step=5800 Epoch=28.4] | Loss=0.04856 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.160 | L2-Norm(final)=2.504 | 4397.6 samples/s | 68.7 steps/s
[Step=5850 Epoch=28.7] | Loss=0.04451 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.173 | L2-Norm(final)=2.502 | 1550.2 samples/s | 24.2 steps/s
[Step=5900 Epoch=28.9] | Loss=0.04072 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.186 | L2-Norm(final)=2.504 | 3532.6 samples/s | 55.2 steps/s
[Step=5950 Epoch=29.2] | Loss=0.03838 | Reg=0.00369 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.196 | L2-Norm(final)=2.507 | 3521.7 samples/s | 55.0 steps/s
[Step=6000 Epoch=29.4] | Loss=0.03774 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.207 | L2-Norm(final)=2.509 | 4269.5 samples/s | 66.7 steps/s
[Step=6050 Epoch=29.7] | Loss=0.03637 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.217 | L2-Norm(final)=2.509 | 1555.2 samples/s | 24.3 steps/s
[Step=6100 Epoch=29.9] | Loss=0.03474 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.227 | L2-Norm(final)=2.511 | 3508.3 samples/s | 54.8 steps/s
[Step=6150 Epoch=30.2] | Loss=0.03337 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.236 | L2-Norm(final)=2.513 | 3500.2 samples/s | 54.7 steps/s
[Step=6200 Epoch=30.4] | Loss=0.03220 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.246 | L2-Norm(final)=2.516 | 4105.3 samples/s | 64.1 steps/s
[Step=6250 Epoch=30.6] | Loss=0.03049 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.254 | L2-Norm(final)=2.520 | 1598.2 samples/s | 25.0 steps/s
[Step=6300 Epoch=30.9] | Loss=0.02951 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.262 | L2-Norm(final)=2.523 | 3518.0 samples/s | 55.0 steps/s
[Step=6350 Epoch=31.1] | Loss=0.02882 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.268 | L2-Norm(final)=2.525 | 3517.6 samples/s | 55.0 steps/s
[Step=6400 Epoch=31.4] | Loss=0.02812 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.274 | L2-Norm(final)=2.527 | 3971.9 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step6400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.1] | Loss=0.08623 | Reg=0.00366 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.140 | L2-Norm(final)=2.550 | 3646.9 samples/s | 57.0 steps/s
[Step=5650 Epoch=53.5] | Loss=0.01838 | Reg=0.00369 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.204 | L2-Norm(final)=2.526 | 3150.6 samples/s | 49.2 steps/s
[Step=5700 Epoch=54.0] | Loss=0.01429 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.227 | L2-Norm(final)=2.521 | 4228.9 samples/s | 66.1 steps/s
[Step=5750 Epoch=54.5] | Loss=0.01037 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.239 | L2-Norm(final)=2.520 | 1512.7 samples/s | 23.6 steps/s
[Step=5800 Epoch=55.0] | Loss=0.00786 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.237 | L2-Norm(final)=2.523 | 4001.1 samples/s | 62.5 steps/s
[Step=5850 Epoch=55.4] | Loss=0.00630 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.230 | L2-Norm(final)=2.526 | 1533.8 samples/s | 24.0 steps/s
[Step=5900 Epoch=55.9] | Loss=0.00525 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.221 | L2-Norm(final)=2.529 | 3787.1 samples/s | 59.2 steps/s
[Step=5950 Epoch=56.4] | Loss=0.00451 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.211 | L2-Norm(final)=2.532 | 1585.7 samples/s | 24.8 steps/s
[Step=6000 Epoch=56.9] | Loss=0.00395 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.202 | L2-Norm(final)=2.535 | 3551.4 samples/s | 55.5 steps/s
[Step=6050 Epoch=57.3] | Loss=0.00352 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.193 | L2-Norm(final)=2.537 | 1600.9 samples/s | 25.0 steps/s
[Step=6100 Epoch=57.8] | Loss=0.00317 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.184 | L2-Norm(final)=2.539 | 3424.0 samples/s | 53.5 steps/s
[Step=6150 Epoch=58.3] | Loss=0.00288 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.176 | L2-Norm(final)=2.541 | 1658.3 samples/s | 25.9 steps/s
[Step=6200 Epoch=58.8] | Loss=0.00265 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.169 | L2-Norm(final)=2.543 | 3363.4 samples/s | 52.6 steps/s
[Step=6250 Epoch=59.2] | Loss=0.00245 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.162 | L2-Norm(final)=2.544 | 1655.8 samples/s | 25.9 steps/s
[Step=6300 Epoch=59.7] | Loss=0.00228 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.155 | L2-Norm(final)=2.546 | 3350.7 samples/s | 52.4 steps/s
[Step=6350 Epoch=60.2] | Loss=0.00213 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.548 | 1672.7 samples/s | 26.1 steps/s
[Step=6400 Epoch=60.6] | Loss=0.00200 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.142 | L2-Norm(final)=2.549 | 3384.3 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step6400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.3] | Loss=0.16343 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.140 | L2-Norm(final)=2.548 | 3499.2 samples/s | 54.7 steps/s
[Step=5650 Epoch=53.7] | Loss=0.01706 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.188 | L2-Norm(final)=2.527 | 3234.8 samples/s | 50.5 steps/s
[Step=5700 Epoch=54.2] | Loss=0.00982 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.190 | L2-Norm(final)=2.534 | 4204.8 samples/s | 65.7 steps/s
[Step=5750 Epoch=54.7] | Loss=0.00699 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.186 | L2-Norm(final)=2.538 | 1502.4 samples/s | 23.5 steps/s
[Step=5800 Epoch=55.2] | Loss=0.00526 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.179 | L2-Norm(final)=2.543 | 3950.2 samples/s | 61.7 steps/s
[Step=5850 Epoch=55.6] | Loss=0.00422 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.169 | L2-Norm(final)=2.546 | 1553.4 samples/s | 24.3 steps/s
[Step=5900 Epoch=56.1] | Loss=0.00352 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.159 | L2-Norm(final)=2.549 | 3775.4 samples/s | 59.0 steps/s
[Step=5950 Epoch=56.6] | Loss=0.00302 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.150 | L2-Norm(final)=2.551 | 1590.4 samples/s | 24.8 steps/s
[Step=6000 Epoch=57.1] | Loss=0.00265 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.142 | L2-Norm(final)=2.553 | 3607.8 samples/s | 56.4 steps/s
[Step=6050 Epoch=57.6] | Loss=0.00236 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.554 | 1622.5 samples/s | 25.4 steps/s
[Step=6100 Epoch=58.0] | Loss=0.00213 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.127 | L2-Norm(final)=2.556 | 3439.1 samples/s | 53.7 steps/s
[Step=6150 Epoch=58.5] | Loss=0.00194 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.120 | L2-Norm(final)=2.557 | 1665.7 samples/s | 26.0 steps/s
[Step=6200 Epoch=59.0] | Loss=0.00178 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.114 | L2-Norm(final)=2.559 | 3392.7 samples/s | 53.0 steps/s
[Step=6250 Epoch=59.5] | Loss=0.00165 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.109 | L2-Norm(final)=2.560 | 1676.3 samples/s | 26.2 steps/s
[Step=6300 Epoch=59.9] | Loss=0.00153 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.103 | L2-Norm(final)=2.562 | 3379.8 samples/s | 52.8 steps/s
[Step=6350 Epoch=60.4] | Loss=0.00144 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.099 | L2-Norm(final)=2.563 | 1665.8 samples/s | 26.0 steps/s
[Step=6400 Epoch=60.9] | Loss=0.00135 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.094 | L2-Norm(final)=2.564 | 3335.4 samples/s | 52.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step6400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.5] | Loss=0.09671 | Reg=0.00366 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.140 | L2-Norm(final)=2.549 | 3489.2 samples/s | 54.5 steps/s
[Step=5650 Epoch=54.0] | Loss=0.02199 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.198 | L2-Norm(final)=2.513 | 3309.1 samples/s | 51.7 steps/s
[Step=5700 Epoch=54.4] | Loss=0.01258 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.218 | L2-Norm(final)=2.508 | 4271.4 samples/s | 66.7 steps/s
[Step=5750 Epoch=54.9] | Loss=0.00861 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.217 | L2-Norm(final)=2.515 | 1510.9 samples/s | 23.6 steps/s
[Step=5800 Epoch=55.4] | Loss=0.00687 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.211 | L2-Norm(final)=2.520 | 4016.4 samples/s | 62.8 steps/s
[Step=5850 Epoch=55.9] | Loss=0.00587 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.211 | L2-Norm(final)=2.523 | 1532.2 samples/s | 23.9 steps/s
[Step=5900 Epoch=56.3] | Loss=0.00491 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.209 | L2-Norm(final)=2.526 | 3845.9 samples/s | 60.1 steps/s
[Step=5950 Epoch=56.8] | Loss=0.00421 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.204 | L2-Norm(final)=2.529 | 1558.9 samples/s | 24.4 steps/s
[Step=6000 Epoch=57.3] | Loss=0.00369 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.198 | L2-Norm(final)=2.532 | 3704.5 samples/s | 57.9 steps/s
[Step=6050 Epoch=57.8] | Loss=0.00328 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.190 | L2-Norm(final)=2.534 | 1606.3 samples/s | 25.1 steps/s
[Step=6100 Epoch=58.3] | Loss=0.00296 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.183 | L2-Norm(final)=2.537 | 3566.4 samples/s | 55.7 steps/s
[Step=6150 Epoch=58.7] | Loss=0.00269 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.175 | L2-Norm(final)=2.539 | 1617.2 samples/s | 25.3 steps/s
[Step=6200 Epoch=59.2] | Loss=0.00247 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.168 | L2-Norm(final)=2.541 | 3404.8 samples/s | 53.2 steps/s
[Step=6250 Epoch=59.7] | Loss=0.00228 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.162 | L2-Norm(final)=2.542 | 1659.9 samples/s | 25.9 steps/s
[Step=6300 Epoch=60.2] | Loss=0.00212 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.155 | L2-Norm(final)=2.544 | 3348.5 samples/s | 52.3 steps/s
[Step=6350 Epoch=60.6] | Loss=0.00198 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.546 | 1663.5 samples/s | 26.0 steps/s
[Step=6400 Epoch=61.1] | Loss=0.00186 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.143 | L2-Norm(final)=2.547 | 3412.8 samples/s | 53.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step6400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=52.8] | Loss=0.15860 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.140 | L2-Norm(final)=2.548 | 3653.3 samples/s | 57.1 steps/s
[Step=5650 Epoch=53.2] | Loss=0.02424 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.200 | L2-Norm(final)=2.516 | 3136.8 samples/s | 49.0 steps/s
[Step=5700 Epoch=53.7] | Loss=0.01635 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.250 | L2-Norm(final)=2.493 | 4152.1 samples/s | 64.9 steps/s
[Step=5750 Epoch=54.2] | Loss=0.01135 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.260 | L2-Norm(final)=2.487 | 1519.6 samples/s | 23.7 steps/s
[Step=5800 Epoch=54.7] | Loss=0.00878 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.256 | L2-Norm(final)=2.488 | 3936.2 samples/s | 61.5 steps/s
[Step=5850 Epoch=55.1] | Loss=0.00705 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.248 | L2-Norm(final)=2.491 | 1573.2 samples/s | 24.6 steps/s
[Step=5900 Epoch=55.6] | Loss=0.00589 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.239 | L2-Norm(final)=2.495 | 3687.4 samples/s | 57.6 steps/s
[Step=5950 Epoch=56.1] | Loss=0.00506 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.499 | 1605.0 samples/s | 25.1 steps/s
[Step=6000 Epoch=56.5] | Loss=0.00444 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.219 | L2-Norm(final)=2.503 | 3474.6 samples/s | 54.3 steps/s
[Step=6050 Epoch=57.0] | Loss=0.00395 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.210 | L2-Norm(final)=2.507 | 1623.7 samples/s | 25.4 steps/s
[Step=6100 Epoch=57.5] | Loss=0.00356 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.200 | L2-Norm(final)=2.510 | 3386.4 samples/s | 52.9 steps/s
[Step=6150 Epoch=58.0] | Loss=0.00324 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.513 | 1681.1 samples/s | 26.3 steps/s
[Step=6200 Epoch=58.4] | Loss=0.00297 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.183 | L2-Norm(final)=2.516 | 3384.5 samples/s | 52.9 steps/s
[Step=6250 Epoch=58.9] | Loss=0.00275 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.176 | L2-Norm(final)=2.518 | 1660.4 samples/s | 25.9 steps/s
[Step=6300 Epoch=59.4] | Loss=0.00255 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.168 | L2-Norm(final)=2.521 | 3323.9 samples/s | 51.9 steps/s
[Step=6350 Epoch=59.8] | Loss=0.00239 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.161 | L2-Norm(final)=2.523 | 1725.6 samples/s | 27.0 steps/s
[Step=6400 Epoch=60.3] | Loss=0.00224 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.155 | L2-Norm(final)=2.526 | 3165.0 samples/s | 49.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step6400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.4] | Loss=0.09739 | Reg=0.00366 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.140 | L2-Norm(final)=2.551 | 3686.9 samples/s | 57.6 steps/s
[Step=5650 Epoch=53.8] | Loss=0.02498 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.219 | L2-Norm(final)=2.504 | 3140.5 samples/s | 49.1 steps/s
[Step=5700 Epoch=54.3] | Loss=0.01599 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.258 | L2-Norm(final)=2.490 | 4241.1 samples/s | 66.3 steps/s
[Step=5750 Epoch=54.8] | Loss=0.01102 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.259 | L2-Norm(final)=2.488 | 1512.5 samples/s | 23.6 steps/s
[Step=5800 Epoch=55.3] | Loss=0.00829 | Reg=0.00371 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.250 | L2-Norm(final)=2.491 | 4053.8 samples/s | 63.3 steps/s
[Step=5850 Epoch=55.8] | Loss=0.00664 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.237 | L2-Norm(final)=2.495 | 1518.2 samples/s | 23.7 steps/s
[Step=5900 Epoch=56.2] | Loss=0.00555 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.224 | L2-Norm(final)=2.499 | 3848.8 samples/s | 60.1 steps/s
[Step=5950 Epoch=56.7] | Loss=0.00476 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.212 | L2-Norm(final)=2.503 | 1576.4 samples/s | 24.6 steps/s
[Step=6000 Epoch=57.2] | Loss=0.00417 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.201 | L2-Norm(final)=2.507 | 3680.4 samples/s | 57.5 steps/s
[Step=6050 Epoch=57.7] | Loss=0.00372 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.191 | L2-Norm(final)=2.511 | 1599.2 samples/s | 25.0 steps/s
[Step=6100 Epoch=58.1] | Loss=0.00335 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.181 | L2-Norm(final)=2.514 | 3553.5 samples/s | 55.5 steps/s
[Step=6150 Epoch=58.6] | Loss=0.00305 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.172 | L2-Norm(final)=2.518 | 1627.6 samples/s | 25.4 steps/s
[Step=6200 Epoch=59.1] | Loss=0.00280 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.164 | L2-Norm(final)=2.521 | 3430.6 samples/s | 53.6 steps/s
[Step=6250 Epoch=59.6] | Loss=0.00259 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.156 | L2-Norm(final)=2.524 | 1646.7 samples/s | 25.7 steps/s
[Step=6300 Epoch=60.0] | Loss=0.00241 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.527 | 3371.9 samples/s | 52.7 steps/s
[Step=6350 Epoch=60.5] | Loss=0.00225 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.142 | L2-Norm(final)=2.530 | 1668.5 samples/s | 26.1 steps/s
[Step=6400 Epoch=61.0] | Loss=0.00211 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.136 | L2-Norm(final)=2.532 | 3386.9 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23777 | acc=0.8198 | tpr=0.7450 | fpr=0.0176 | 3621.3 samples/s | 14.1 steps/s
Avg test loss: 0.23915, Avg test acc: 0.81974, Avg tpr: 0.74628, Avg fpr: 0.01872, total FA: 146

Testing server on iccad2012
[Step=  50] | Loss=0.44666 | acc=0.7444 | tpr=0.9690 | fpr=0.2597 | 3634.0 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.44880 | acc=0.7450 | tpr=0.9744 | fpr=0.2593 | 6854.3 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.45230 | acc=0.7446 | tpr=0.9784 | fpr=0.2597 | 6792.0 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.45195 | acc=0.7447 | tpr=0.9749 | fpr=0.2595 | 6847.1 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.45177 | acc=0.7450 | tpr=0.9729 | fpr=0.2591 | 6901.0 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.45040 | acc=0.7458 | tpr=0.9702 | fpr=0.2582 | 6996.1 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.45023 | acc=0.7463 | tpr=0.9693 | fpr=0.2577 | 6531.7 samples/s | 25.5 steps/s
[Step= 400] | Loss=0.45067 | acc=0.7456 | tpr=0.9661 | fpr=0.2584 | 6881.3 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.45346 | acc=0.7449 | tpr=0.9664 | fpr=0.2591 | 6716.6 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.45494 | acc=0.7441 | tpr=0.9674 | fpr=0.2599 | 6632.6 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.45441 | acc=0.7446 | tpr=0.9670 | fpr=0.2595 | 13172.6 samples/s | 51.5 steps/s
Avg test loss: 0.45433, Avg test acc: 0.74457, Avg tpr: 0.96712, Avg fpr: 0.25948, total FA: 36028

server round 8/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.16773 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.123 | L2-Norm(final)=2.554 | 3766.8 samples/s | 58.9 steps/s
[Step=6450 Epoch=31.5] | Loss=0.05888 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.123 | L2-Norm(final)=2.512 | 3288.4 samples/s | 51.4 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05078 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.125 | L2-Norm(final)=2.507 | 3521.3 samples/s | 55.0 steps/s
[Step=6550 Epoch=31.9] | Loss=0.04748 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.133 | L2-Norm(final)=2.505 | 3526.5 samples/s | 55.1 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04705 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.502 | 4338.8 samples/s | 67.8 steps/s
[Step=6650 Epoch=32.4] | Loss=0.04206 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.158 | L2-Norm(final)=2.503 | 1556.9 samples/s | 24.3 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03952 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.170 | L2-Norm(final)=2.505 | 3507.3 samples/s | 54.8 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03779 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.181 | L2-Norm(final)=2.507 | 3528.3 samples/s | 55.1 steps/s
[Step=6800 Epoch=33.2] | Loss=0.03651 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.191 | L2-Norm(final)=2.509 | 4118.0 samples/s | 64.3 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03495 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.200 | L2-Norm(final)=2.511 | 1601.4 samples/s | 25.0 steps/s
[Step=6900 Epoch=33.6] | Loss=0.03312 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.209 | L2-Norm(final)=2.514 | 3505.9 samples/s | 54.8 steps/s
[Step=6950 Epoch=33.9] | Loss=0.03171 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.217 | L2-Norm(final)=2.518 | 3494.4 samples/s | 54.6 steps/s
[Step=7000 Epoch=34.1] | Loss=0.03041 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.225 | L2-Norm(final)=2.522 | 3939.2 samples/s | 61.6 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02978 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.232 | L2-Norm(final)=2.525 | 1624.0 samples/s | 25.4 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02935 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.239 | L2-Norm(final)=2.527 | 3514.9 samples/s | 54.9 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02859 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.245 | L2-Norm(final)=2.529 | 3523.7 samples/s | 55.1 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02813 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.252 | L2-Norm(final)=2.531 | 3761.1 samples/s | 58.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step7200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.16679 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.123 | L2-Norm(final)=2.554 | 3581.3 samples/s | 56.0 steps/s
[Step=6450 Epoch=31.5] | Loss=0.05422 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.114 | L2-Norm(final)=2.527 | 3479.8 samples/s | 54.4 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05100 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.119 | L2-Norm(final)=2.513 | 3510.0 samples/s | 54.8 steps/s
[Step=6550 Epoch=32.0] | Loss=0.04825 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.133 | L2-Norm(final)=2.508 | 3527.2 samples/s | 55.1 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04366 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.148 | L2-Norm(final)=2.508 | 4390.8 samples/s | 68.6 steps/s
[Step=6650 Epoch=32.4] | Loss=0.03968 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.160 | L2-Norm(final)=2.509 | 1550.3 samples/s | 24.2 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03648 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.173 | L2-Norm(final)=2.513 | 3507.6 samples/s | 54.8 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03570 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.184 | L2-Norm(final)=2.516 | 3506.7 samples/s | 54.8 steps/s
[Step=6800 Epoch=33.2] | Loss=0.03466 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.195 | L2-Norm(final)=2.518 | 4190.5 samples/s | 65.5 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03320 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.204 | L2-Norm(final)=2.519 | 1563.8 samples/s | 24.4 steps/s
[Step=6900 Epoch=33.7] | Loss=0.03202 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.212 | L2-Norm(final)=2.519 | 3504.0 samples/s | 54.8 steps/s
[Step=6950 Epoch=33.9] | Loss=0.03089 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.221 | L2-Norm(final)=2.521 | 3502.0 samples/s | 54.7 steps/s
[Step=7000 Epoch=34.2] | Loss=0.02969 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.523 | 3977.4 samples/s | 62.1 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02868 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.237 | L2-Norm(final)=2.525 | 1611.6 samples/s | 25.2 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02754 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.244 | L2-Norm(final)=2.527 | 3508.1 samples/s | 54.8 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02716 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.250 | L2-Norm(final)=2.529 | 3497.4 samples/s | 54.6 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02696 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.255 | L2-Norm(final)=2.529 | 3813.2 samples/s | 59.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step7200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.29628 | Reg=0.00366 | FP-Reg=0.000 | acc=0.7656 | L2-Norm=19.123 | L2-Norm(final)=2.553 | 3569.8 samples/s | 55.8 steps/s
[Step=6450 Epoch=31.4] | Loss=0.06300 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.128 | L2-Norm(final)=2.507 | 3488.9 samples/s | 54.5 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05246 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.132 | L2-Norm(final)=2.505 | 3505.9 samples/s | 54.8 steps/s
[Step=6550 Epoch=31.9] | Loss=0.05022 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.141 | L2-Norm(final)=2.506 | 3497.2 samples/s | 54.6 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04856 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.153 | L2-Norm(final)=2.503 | 4351.2 samples/s | 68.0 steps/s
[Step=6650 Epoch=32.4] | Loss=0.04597 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.168 | L2-Norm(final)=2.503 | 1568.1 samples/s | 24.5 steps/s
[Step=6700 Epoch=32.6] | Loss=0.04226 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.182 | L2-Norm(final)=2.504 | 3492.2 samples/s | 54.6 steps/s
[Step=6750 Epoch=32.9] | Loss=0.04086 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.192 | L2-Norm(final)=2.505 | 3521.5 samples/s | 55.0 steps/s
[Step=6800 Epoch=33.1] | Loss=0.03918 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.200 | L2-Norm(final)=2.503 | 4117.8 samples/s | 64.3 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03684 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.208 | L2-Norm(final)=2.503 | 1607.9 samples/s | 25.1 steps/s
[Step=6900 Epoch=33.6] | Loss=0.03522 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.215 | L2-Norm(final)=2.505 | 3510.6 samples/s | 54.9 steps/s
[Step=6950 Epoch=33.9] | Loss=0.03413 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.222 | L2-Norm(final)=2.506 | 3521.5 samples/s | 55.0 steps/s
[Step=7000 Epoch=34.1] | Loss=0.03311 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.229 | L2-Norm(final)=2.507 | 3930.5 samples/s | 61.4 steps/s
[Step=7050 Epoch=34.4] | Loss=0.03148 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.236 | L2-Norm(final)=2.510 | 1619.7 samples/s | 25.3 steps/s
[Step=7100 Epoch=34.6] | Loss=0.03009 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.243 | L2-Norm(final)=2.513 | 3489.7 samples/s | 54.5 steps/s
[Step=7150 Epoch=34.8] | Loss=0.02921 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.249 | L2-Norm(final)=2.517 | 3509.0 samples/s | 54.8 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02850 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.254 | L2-Norm(final)=2.519 | 3747.2 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step7200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.11317 | Reg=0.00366 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.123 | L2-Norm(final)=2.555 | 3579.9 samples/s | 55.9 steps/s
[Step=6450 Epoch=31.5] | Loss=0.06081 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.137 | L2-Norm(final)=2.524 | 3448.2 samples/s | 53.9 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05367 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.142 | L2-Norm(final)=2.519 | 3528.9 samples/s | 55.1 steps/s
[Step=6550 Epoch=31.9] | Loss=0.05063 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.148 | L2-Norm(final)=2.514 | 3526.7 samples/s | 55.1 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04616 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.154 | L2-Norm(final)=2.511 | 4361.4 samples/s | 68.1 steps/s
[Step=6650 Epoch=32.4] | Loss=0.04021 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.161 | L2-Norm(final)=2.512 | 1573.0 samples/s | 24.6 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03811 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.168 | L2-Norm(final)=2.515 | 3504.8 samples/s | 54.8 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03735 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.177 | L2-Norm(final)=2.517 | 3500.6 samples/s | 54.7 steps/s
[Step=6800 Epoch=33.2] | Loss=0.03570 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.186 | L2-Norm(final)=2.518 | 4125.9 samples/s | 64.5 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03388 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.197 | L2-Norm(final)=2.521 | 1597.4 samples/s | 25.0 steps/s
[Step=6900 Epoch=33.6] | Loss=0.03218 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.206 | L2-Norm(final)=2.525 | 3512.4 samples/s | 54.9 steps/s
[Step=6950 Epoch=33.9] | Loss=0.03088 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.215 | L2-Norm(final)=2.528 | 3501.1 samples/s | 54.7 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02982 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.223 | L2-Norm(final)=2.532 | 3942.8 samples/s | 61.6 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02884 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.230 | L2-Norm(final)=2.535 | 1619.4 samples/s | 25.3 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02782 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.236 | L2-Norm(final)=2.537 | 3486.4 samples/s | 54.5 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02690 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.242 | L2-Norm(final)=2.539 | 3500.6 samples/s | 54.7 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02646 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.247 | L2-Norm(final)=2.541 | 3742.2 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step7200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.4] | Loss=0.14129 | Reg=0.00366 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.123 | L2-Norm(final)=2.555 | 3527.7 samples/s | 55.1 steps/s
[Step=6450 Epoch=31.6] | Loss=0.04799 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.122 | L2-Norm(final)=2.534 | 3521.9 samples/s | 55.0 steps/s
[Step=6500 Epoch=31.9] | Loss=0.04729 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.131 | L2-Norm(final)=2.530 | 3499.7 samples/s | 54.7 steps/s
[Step=6550 Epoch=32.1] | Loss=0.04517 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.144 | L2-Norm(final)=2.526 | 3522.3 samples/s | 55.0 steps/s
[Step=6600 Epoch=32.4] | Loss=0.04319 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.157 | L2-Norm(final)=2.525 | 4393.2 samples/s | 68.6 steps/s
[Step=6650 Epoch=32.6] | Loss=0.03966 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.170 | L2-Norm(final)=2.524 | 1560.1 samples/s | 24.4 steps/s
[Step=6700 Epoch=32.9] | Loss=0.03722 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.181 | L2-Norm(final)=2.523 | 3495.9 samples/s | 54.6 steps/s
[Step=6750 Epoch=33.1] | Loss=0.03585 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.191 | L2-Norm(final)=2.523 | 3515.3 samples/s | 54.9 steps/s
[Step=6800 Epoch=33.3] | Loss=0.03455 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.202 | L2-Norm(final)=2.525 | 4275.5 samples/s | 66.8 steps/s
[Step=6850 Epoch=33.6] | Loss=0.03337 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.213 | L2-Norm(final)=2.526 | 1580.0 samples/s | 24.7 steps/s
[Step=6900 Epoch=33.8] | Loss=0.03220 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.222 | L2-Norm(final)=2.526 | 3512.1 samples/s | 54.9 steps/s
[Step=6950 Epoch=34.1] | Loss=0.03066 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.230 | L2-Norm(final)=2.527 | 3517.3 samples/s | 55.0 steps/s
[Step=7000 Epoch=34.3] | Loss=0.02986 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.237 | L2-Norm(final)=2.528 | 4096.1 samples/s | 64.0 steps/s
[Step=7050 Epoch=34.6] | Loss=0.02841 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.245 | L2-Norm(final)=2.530 | 1599.9 samples/s | 25.0 steps/s
[Step=7100 Epoch=34.8] | Loss=0.02747 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.252 | L2-Norm(final)=2.533 | 3536.2 samples/s | 55.3 steps/s
[Step=7150 Epoch=35.1] | Loss=0.02712 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.258 | L2-Norm(final)=2.535 | 3535.7 samples/s | 55.2 steps/s
[Step=7200 Epoch=35.3] | Loss=0.02641 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.264 | L2-Norm(final)=2.537 | 3996.6 samples/s | 62.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step7200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=60.7] | Loss=0.19292 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.123 | L2-Norm(final)=2.555 | 3793.9 samples/s | 59.3 steps/s
[Step=6450 Epoch=61.1] | Loss=0.02143 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.187 | L2-Norm(final)=2.524 | 3064.2 samples/s | 47.9 steps/s
[Step=6500 Epoch=61.6] | Loss=0.01230 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.205 | L2-Norm(final)=2.525 | 4229.8 samples/s | 66.1 steps/s
[Step=6550 Epoch=62.1] | Loss=0.00841 | Reg=0.00369 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.199 | L2-Norm(final)=2.529 | 1490.3 samples/s | 23.3 steps/s
[Step=6600 Epoch=62.5] | Loss=0.00635 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.190 | L2-Norm(final)=2.533 | 3984.1 samples/s | 62.3 steps/s
[Step=6650 Epoch=63.0] | Loss=0.00516 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.180 | L2-Norm(final)=2.537 | 1538.2 samples/s | 24.0 steps/s
[Step=6700 Epoch=63.5] | Loss=0.00431 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.171 | L2-Norm(final)=2.541 | 3742.7 samples/s | 58.5 steps/s
[Step=6750 Epoch=64.0] | Loss=0.00370 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.161 | L2-Norm(final)=2.544 | 1516.1 samples/s | 23.7 steps/s
[Step=6800 Epoch=64.4] | Loss=0.00324 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.152 | L2-Norm(final)=2.546 | 3383.3 samples/s | 52.9 steps/s
[Step=6850 Epoch=64.9] | Loss=0.00289 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.549 | 1598.1 samples/s | 25.0 steps/s
[Step=6900 Epoch=65.4] | Loss=0.00260 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.136 | L2-Norm(final)=2.551 | 3366.3 samples/s | 52.6 steps/s
[Step=6950 Epoch=65.9] | Loss=0.00237 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.128 | L2-Norm(final)=2.552 | 1661.3 samples/s | 26.0 steps/s
[Step=7000 Epoch=66.3] | Loss=0.00217 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.121 | L2-Norm(final)=2.554 | 3391.4 samples/s | 53.0 steps/s
[Step=7050 Epoch=66.8] | Loss=0.00201 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.115 | L2-Norm(final)=2.556 | 1660.7 samples/s | 25.9 steps/s
[Step=7100 Epoch=67.3] | Loss=0.00187 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.109 | L2-Norm(final)=2.557 | 3419.5 samples/s | 53.4 steps/s
[Step=7150 Epoch=67.8] | Loss=0.00175 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.103 | L2-Norm(final)=2.559 | 1681.1 samples/s | 26.3 steps/s
[Step=7200 Epoch=68.2] | Loss=0.00164 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.098 | L2-Norm(final)=2.560 | 3335.6 samples/s | 52.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step7200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=60.9] | Loss=0.22641 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.123 | L2-Norm(final)=2.554 | 3601.6 samples/s | 56.3 steps/s
[Step=6450 Epoch=61.4] | Loss=0.02301 | Reg=0.00369 | FP-Reg=0.007 | acc=0.9688 | L2-Norm=19.212 | L2-Norm(final)=2.523 | 3177.9 samples/s | 49.7 steps/s
[Step=6500 Epoch=61.8] | Loss=0.01437 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.519 | 4220.6 samples/s | 65.9 steps/s
[Step=6550 Epoch=62.3] | Loss=0.01036 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.240 | L2-Norm(final)=2.520 | 1527.8 samples/s | 23.9 steps/s
[Step=6600 Epoch=62.8] | Loss=0.00782 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.241 | L2-Norm(final)=2.525 | 4005.4 samples/s | 62.6 steps/s
[Step=6650 Epoch=63.3] | Loss=0.00627 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=2.530 | 1549.8 samples/s | 24.2 steps/s
[Step=6700 Epoch=63.7] | Loss=0.00523 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.226 | L2-Norm(final)=2.535 | 3739.5 samples/s | 58.4 steps/s
[Step=6750 Epoch=64.2] | Loss=0.00449 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.216 | L2-Norm(final)=2.538 | 1580.4 samples/s | 24.7 steps/s
[Step=6800 Epoch=64.7] | Loss=0.00394 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.206 | L2-Norm(final)=2.541 | 3566.0 samples/s | 55.7 steps/s
[Step=6850 Epoch=65.2] | Loss=0.00350 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.197 | L2-Norm(final)=2.544 | 1606.6 samples/s | 25.1 steps/s
[Step=6900 Epoch=65.6] | Loss=0.00316 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.187 | L2-Norm(final)=2.547 | 3418.9 samples/s | 53.4 steps/s
[Step=6950 Epoch=66.1] | Loss=0.00287 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.179 | L2-Norm(final)=2.549 | 1652.3 samples/s | 25.8 steps/s
[Step=7000 Epoch=66.6] | Loss=0.00264 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.171 | L2-Norm(final)=2.551 | 3385.6 samples/s | 52.9 steps/s
[Step=7050 Epoch=67.1] | Loss=0.00244 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.163 | L2-Norm(final)=2.553 | 1674.4 samples/s | 26.2 steps/s
[Step=7100 Epoch=67.5] | Loss=0.00227 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.155 | L2-Norm(final)=2.555 | 3398.1 samples/s | 53.1 steps/s
[Step=7150 Epoch=68.0] | Loss=0.00212 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.557 | 1688.9 samples/s | 26.4 steps/s
[Step=7200 Epoch=68.5] | Loss=0.00199 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.142 | L2-Norm(final)=2.559 | 3322.0 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step7200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=61.1] | Loss=0.14248 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.123 | L2-Norm(final)=2.555 | 3853.8 samples/s | 60.2 steps/s
[Step=6450 Epoch=61.6] | Loss=0.02329 | Reg=0.00368 | FP-Reg=0.006 | acc=0.9062 | L2-Norm=19.176 | L2-Norm(final)=2.534 | 2997.1 samples/s | 46.8 steps/s
[Step=6500 Epoch=62.1] | Loss=0.01957 | Reg=0.00371 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.272 | L2-Norm(final)=2.490 | 4272.0 samples/s | 66.7 steps/s
[Step=6550 Epoch=62.5] | Loss=0.01339 | Reg=0.00372 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.295 | L2-Norm(final)=2.476 | 1510.7 samples/s | 23.6 steps/s
[Step=6600 Epoch=63.0] | Loss=0.01008 | Reg=0.00372 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.291 | L2-Norm(final)=2.473 | 4063.9 samples/s | 63.5 steps/s
[Step=6650 Epoch=63.5] | Loss=0.00808 | Reg=0.00372 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.280 | L2-Norm(final)=2.474 | 1549.1 samples/s | 24.2 steps/s
[Step=6700 Epoch=64.0] | Loss=0.00675 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.267 | L2-Norm(final)=2.477 | 3862.7 samples/s | 60.4 steps/s
[Step=6750 Epoch=64.5] | Loss=0.00579 | Reg=0.00371 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.254 | L2-Norm(final)=2.480 | 1567.8 samples/s | 24.5 steps/s
[Step=6800 Epoch=64.9] | Loss=0.00507 | Reg=0.00370 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.242 | L2-Norm(final)=2.484 | 3710.7 samples/s | 58.0 steps/s
[Step=6850 Epoch=65.4] | Loss=0.00452 | Reg=0.00370 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.230 | L2-Norm(final)=2.488 | 1594.6 samples/s | 24.9 steps/s
[Step=6900 Epoch=65.9] | Loss=0.00407 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.219 | L2-Norm(final)=2.491 | 3549.2 samples/s | 55.5 steps/s
[Step=6950 Epoch=66.4] | Loss=0.00370 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.209 | L2-Norm(final)=2.495 | 1629.8 samples/s | 25.5 steps/s
[Step=7000 Epoch=66.8] | Loss=0.00340 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.200 | L2-Norm(final)=2.499 | 3407.1 samples/s | 53.2 steps/s
[Step=7050 Epoch=67.3] | Loss=0.00314 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.191 | L2-Norm(final)=2.502 | 1658.5 samples/s | 25.9 steps/s
[Step=7100 Epoch=67.8] | Loss=0.00292 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.182 | L2-Norm(final)=2.506 | 3358.2 samples/s | 52.5 steps/s
[Step=7150 Epoch=68.3] | Loss=0.00273 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.174 | L2-Norm(final)=2.509 | 1658.7 samples/s | 25.9 steps/s
[Step=7200 Epoch=68.8] | Loss=0.00256 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.167 | L2-Norm(final)=2.512 | 3373.9 samples/s | 52.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step7200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=60.3] | Loss=0.16934 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.123 | L2-Norm(final)=2.556 | 3777.7 samples/s | 59.0 steps/s
[Step=6450 Epoch=60.8] | Loss=0.01920 | Reg=0.00369 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.202 | L2-Norm(final)=2.520 | 3078.7 samples/s | 48.1 steps/s
[Step=6500 Epoch=61.2] | Loss=0.01395 | Reg=0.00369 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.216 | L2-Norm(final)=2.515 | 4188.4 samples/s | 65.4 steps/s
[Step=6550 Epoch=61.7] | Loss=0.00956 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.218 | L2-Norm(final)=2.520 | 1525.4 samples/s | 23.8 steps/s
[Step=6600 Epoch=62.2] | Loss=0.00722 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.211 | L2-Norm(final)=2.526 | 3935.6 samples/s | 61.5 steps/s
[Step=6650 Epoch=62.7] | Loss=0.00578 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.201 | L2-Norm(final)=2.531 | 1560.2 samples/s | 24.4 steps/s
[Step=6700 Epoch=63.1] | Loss=0.00483 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.190 | L2-Norm(final)=2.535 | 3670.8 samples/s | 57.4 steps/s
[Step=6750 Epoch=63.6] | Loss=0.00415 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.180 | L2-Norm(final)=2.539 | 1515.9 samples/s | 23.7 steps/s
[Step=6800 Epoch=64.1] | Loss=0.00364 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.170 | L2-Norm(final)=2.542 | 3137.6 samples/s | 49.0 steps/s
[Step=6850 Epoch=64.5] | Loss=0.00324 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.160 | L2-Norm(final)=2.545 | 1479.3 samples/s | 23.1 steps/s
[Step=6900 Epoch=65.0] | Loss=0.00292 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.152 | L2-Norm(final)=2.547 | 3262.7 samples/s | 51.0 steps/s
[Step=6950 Epoch=65.5] | Loss=0.00266 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.549 | 1628.6 samples/s | 25.4 steps/s
[Step=7000 Epoch=66.0] | Loss=0.00244 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.136 | L2-Norm(final)=2.551 | 3347.5 samples/s | 52.3 steps/s
[Step=7050 Epoch=66.4] | Loss=0.00225 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=2.553 | 1636.4 samples/s | 25.6 steps/s
[Step=7100 Epoch=66.9] | Loss=0.00210 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.123 | L2-Norm(final)=2.555 | 3374.9 samples/s | 52.7 steps/s
[Step=7150 Epoch=67.4] | Loss=0.00196 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.117 | L2-Norm(final)=2.557 | 1737.1 samples/s | 27.1 steps/s
[Step=7200 Epoch=67.8] | Loss=0.00184 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.111 | L2-Norm(final)=2.558 | 3051.2 samples/s | 47.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step7200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=61.0] | Loss=0.22483 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.123 | L2-Norm(final)=2.556 | 3607.9 samples/s | 56.4 steps/s
[Step=6450 Epoch=61.5] | Loss=0.03663 | Reg=0.00371 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.271 | L2-Norm(final)=2.472 | 3203.8 samples/s | 50.1 steps/s
[Step=6500 Epoch=62.0] | Loss=0.02029 | Reg=0.00372 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.291 | L2-Norm(final)=2.469 | 4236.2 samples/s | 66.2 steps/s
[Step=6550 Epoch=62.4] | Loss=0.01366 | Reg=0.00372 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.280 | L2-Norm(final)=2.475 | 1528.6 samples/s | 23.9 steps/s
[Step=6600 Epoch=62.9] | Loss=0.01026 | Reg=0.00371 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.264 | L2-Norm(final)=2.481 | 4051.4 samples/s | 63.3 steps/s
[Step=6650 Epoch=63.4] | Loss=0.00822 | Reg=0.00370 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.248 | L2-Norm(final)=2.487 | 1532.4 samples/s | 23.9 steps/s
[Step=6700 Epoch=63.9] | Loss=0.00686 | Reg=0.00370 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.232 | L2-Norm(final)=2.492 | 3852.0 samples/s | 60.2 steps/s
[Step=6750 Epoch=64.3] | Loss=0.00589 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.218 | L2-Norm(final)=2.496 | 1570.2 samples/s | 24.5 steps/s
[Step=6800 Epoch=64.8] | Loss=0.00516 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.205 | L2-Norm(final)=2.500 | 3700.9 samples/s | 57.8 steps/s
[Step=6850 Epoch=65.3] | Loss=0.00459 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.193 | L2-Norm(final)=2.504 | 1503.4 samples/s | 23.5 steps/s
[Step=6900 Epoch=65.8] | Loss=0.00413 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.182 | L2-Norm(final)=2.508 | 3397.7 samples/s | 53.1 steps/s
[Step=6950 Epoch=66.2] | Loss=0.00376 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.172 | L2-Norm(final)=2.512 | 1594.8 samples/s | 24.9 steps/s
[Step=7000 Epoch=66.7] | Loss=0.00345 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.162 | L2-Norm(final)=2.515 | 3361.1 samples/s | 52.5 steps/s
[Step=7050 Epoch=67.2] | Loss=0.00319 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.154 | L2-Norm(final)=2.518 | 1651.5 samples/s | 25.8 steps/s
[Step=7100 Epoch=67.7] | Loss=0.00297 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.145 | L2-Norm(final)=2.522 | 3365.2 samples/s | 52.6 steps/s
[Step=7150 Epoch=68.1] | Loss=0.00277 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.138 | L2-Norm(final)=2.525 | 1638.7 samples/s | 25.6 steps/s
[Step=7200 Epoch=68.6] | Loss=0.00260 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.131 | L2-Norm(final)=2.527 | 3364.9 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22299 | acc=0.8280 | tpr=0.7566 | fpr=0.0171 | 3654.6 samples/s | 14.3 steps/s
Avg test loss: 0.22440, Avg test acc: 0.82847, Avg tpr: 0.75922, Avg fpr: 0.01923, total FA: 150

Testing server on iccad2012
[Step=  50] | Loss=0.39435 | acc=0.7805 | tpr=0.9779 | fpr=0.2231 | 3659.5 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.39735 | acc=0.7798 | tpr=0.9808 | fpr=0.2239 | 6867.7 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.40154 | acc=0.7787 | tpr=0.9813 | fpr=0.2251 | 6853.1 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.40080 | acc=0.7794 | tpr=0.9792 | fpr=0.2243 | 4996.2 samples/s | 19.5 steps/s
[Step= 250] | Loss=0.40123 | acc=0.7799 | tpr=0.9790 | fpr=0.2237 | 6828.4 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.39994 | acc=0.7800 | tpr=0.9767 | fpr=0.2236 | 6861.6 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.40028 | acc=0.7802 | tpr=0.9756 | fpr=0.2233 | 6096.7 samples/s | 23.8 steps/s
[Step= 400] | Loss=0.40049 | acc=0.7801 | tpr=0.9732 | fpr=0.2234 | 6176.6 samples/s | 24.1 steps/s
[Step= 450] | Loss=0.40327 | acc=0.7794 | tpr=0.9732 | fpr=0.2241 | 6556.6 samples/s | 25.6 steps/s
[Step= 500] | Loss=0.40456 | acc=0.7789 | tpr=0.9731 | fpr=0.2246 | 6692.4 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.40412 | acc=0.7794 | tpr=0.9729 | fpr=0.2241 | 12717.2 samples/s | 49.7 steps/s
Avg test loss: 0.40405, Avg test acc: 0.77940, Avg tpr: 0.97306, Avg fpr: 0.22412, total FA: 31119

server round 9/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.08792 | Reg=0.00365 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.099 | L2-Norm(final)=2.563 | 3841.6 samples/s | 60.0 steps/s
[Step=7250 Epoch=35.4] | Loss=0.05352 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.097 | L2-Norm(final)=2.536 | 3208.3 samples/s | 50.1 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04867 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.103 | L2-Norm(final)=2.530 | 3503.3 samples/s | 54.7 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04576 | Reg=0.00365 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.115 | L2-Norm(final)=2.531 | 3525.3 samples/s | 55.1 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04507 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.129 | L2-Norm(final)=2.525 | 4348.5 samples/s | 67.9 steps/s
[Step=7450 Epoch=36.3] | Loss=0.04071 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.141 | L2-Norm(final)=2.523 | 1555.8 samples/s | 24.3 steps/s
[Step=7500 Epoch=36.6] | Loss=0.03735 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.152 | L2-Norm(final)=2.524 | 3513.4 samples/s | 54.9 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03593 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.161 | L2-Norm(final)=2.525 | 3510.3 samples/s | 54.8 steps/s
[Step=7600 Epoch=37.1] | Loss=0.03484 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.169 | L2-Norm(final)=2.526 | 4149.8 samples/s | 64.8 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03298 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.178 | L2-Norm(final)=2.528 | 1599.9 samples/s | 25.0 steps/s
[Step=7700 Epoch=37.5] | Loss=0.03144 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.188 | L2-Norm(final)=2.531 | 3525.1 samples/s | 55.1 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03036 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.196 | L2-Norm(final)=2.534 | 3515.5 samples/s | 54.9 steps/s
[Step=7800 Epoch=38.0] | Loss=0.03024 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.206 | L2-Norm(final)=2.535 | 3940.7 samples/s | 61.6 steps/s
[Step=7850 Epoch=38.3] | Loss=0.02957 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.215 | L2-Norm(final)=2.537 | 1618.2 samples/s | 25.3 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02852 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.225 | L2-Norm(final)=2.540 | 3527.3 samples/s | 55.1 steps/s
[Step=7950 Epoch=38.8] | Loss=0.02771 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.234 | L2-Norm(final)=2.543 | 3516.2 samples/s | 54.9 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02719 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.242 | L2-Norm(final)=2.545 | 3768.4 samples/s | 58.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.16494 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.099 | L2-Norm(final)=2.562 | 3592.8 samples/s | 56.1 steps/s
[Step=7250 Epoch=35.4] | Loss=0.04364 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.094 | L2-Norm(final)=2.553 | 3428.9 samples/s | 53.6 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04131 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.095 | L2-Norm(final)=2.547 | 3507.8 samples/s | 54.8 steps/s
[Step=7350 Epoch=35.9] | Loss=0.03991 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.104 | L2-Norm(final)=2.539 | 3508.2 samples/s | 54.8 steps/s
[Step=7400 Epoch=36.1] | Loss=0.03995 | Reg=0.00365 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.116 | L2-Norm(final)=2.535 | 4362.7 samples/s | 68.2 steps/s
[Step=7450 Epoch=36.4] | Loss=0.03677 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.128 | L2-Norm(final)=2.531 | 1551.6 samples/s | 24.2 steps/s
[Step=7500 Epoch=36.6] | Loss=0.03434 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.140 | L2-Norm(final)=2.531 | 3516.6 samples/s | 54.9 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03312 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.151 | L2-Norm(final)=2.531 | 3477.1 samples/s | 54.3 steps/s
[Step=7600 Epoch=37.1] | Loss=0.03290 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.162 | L2-Norm(final)=2.531 | 4174.6 samples/s | 65.2 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03117 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.172 | L2-Norm(final)=2.530 | 1584.1 samples/s | 24.8 steps/s
[Step=7700 Epoch=37.6] | Loss=0.03017 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.180 | L2-Norm(final)=2.530 | 3494.8 samples/s | 54.6 steps/s
[Step=7750 Epoch=37.8] | Loss=0.02910 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.187 | L2-Norm(final)=2.530 | 3500.6 samples/s | 54.7 steps/s
[Step=7800 Epoch=38.1] | Loss=0.02833 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.195 | L2-Norm(final)=2.530 | 3996.0 samples/s | 62.4 steps/s
[Step=7850 Epoch=38.3] | Loss=0.02743 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.530 | 1618.4 samples/s | 25.3 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02644 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.211 | L2-Norm(final)=2.531 | 3518.6 samples/s | 55.0 steps/s
[Step=7950 Epoch=38.8] | Loss=0.02590 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.218 | L2-Norm(final)=2.532 | 3495.7 samples/s | 54.6 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02553 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.225 | L2-Norm(final)=2.533 | 3838.3 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step8000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.13083 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.099 | L2-Norm(final)=2.563 | 3729.6 samples/s | 58.3 steps/s
[Step=7250 Epoch=35.3] | Loss=0.04056 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.099 | L2-Norm(final)=2.554 | 3331.1 samples/s | 52.0 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04533 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.102 | L2-Norm(final)=2.536 | 3529.1 samples/s | 55.1 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04592 | Reg=0.00365 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.111 | L2-Norm(final)=2.526 | 3519.7 samples/s | 55.0 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04439 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.121 | L2-Norm(final)=2.520 | 4374.2 samples/s | 68.3 steps/s
[Step=7450 Epoch=36.3] | Loss=0.04017 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.131 | L2-Norm(final)=2.518 | 1550.8 samples/s | 24.2 steps/s
[Step=7500 Epoch=36.5] | Loss=0.03843 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.141 | L2-Norm(final)=2.517 | 3470.9 samples/s | 54.2 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03614 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.150 | L2-Norm(final)=2.517 | 3512.0 samples/s | 54.9 steps/s
[Step=7600 Epoch=37.0] | Loss=0.03534 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.158 | L2-Norm(final)=2.516 | 4117.7 samples/s | 64.3 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03320 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.167 | L2-Norm(final)=2.517 | 1594.5 samples/s | 24.9 steps/s
[Step=7700 Epoch=37.5] | Loss=0.03208 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.176 | L2-Norm(final)=2.518 | 3507.0 samples/s | 54.8 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03146 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.185 | L2-Norm(final)=2.519 | 3505.0 samples/s | 54.8 steps/s
[Step=7800 Epoch=38.0] | Loss=0.03058 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.194 | L2-Norm(final)=2.519 | 3910.8 samples/s | 61.1 steps/s
[Step=7850 Epoch=38.2] | Loss=0.02957 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.203 | L2-Norm(final)=2.521 | 1632.1 samples/s | 25.5 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02847 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.211 | L2-Norm(final)=2.524 | 3466.5 samples/s | 54.2 steps/s
[Step=7950 Epoch=38.7] | Loss=0.02793 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.219 | L2-Norm(final)=2.525 | 3487.8 samples/s | 54.5 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02731 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.227 | L2-Norm(final)=2.527 | 3740.1 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.12890 | Reg=0.00365 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.099 | L2-Norm(final)=2.563 | 3887.1 samples/s | 60.7 steps/s
[Step=7250 Epoch=35.4] | Loss=0.04487 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.094 | L2-Norm(final)=2.543 | 3214.5 samples/s | 50.2 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04452 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.094 | L2-Norm(final)=2.530 | 3499.8 samples/s | 54.7 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04414 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.104 | L2-Norm(final)=2.523 | 3509.9 samples/s | 54.8 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04211 | Reg=0.00365 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.114 | L2-Norm(final)=2.519 | 4348.2 samples/s | 67.9 steps/s
[Step=7450 Epoch=36.3] | Loss=0.03874 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.126 | L2-Norm(final)=2.519 | 1570.8 samples/s | 24.5 steps/s
[Step=7500 Epoch=36.6] | Loss=0.03673 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.136 | L2-Norm(final)=2.519 | 3519.3 samples/s | 55.0 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03496 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.145 | L2-Norm(final)=2.518 | 3506.8 samples/s | 54.8 steps/s
[Step=7600 Epoch=37.1] | Loss=0.03405 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.154 | L2-Norm(final)=2.518 | 4149.0 samples/s | 64.8 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03227 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.162 | L2-Norm(final)=2.517 | 1584.7 samples/s | 24.8 steps/s
[Step=7700 Epoch=37.5] | Loss=0.03096 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.170 | L2-Norm(final)=2.518 | 3498.0 samples/s | 54.7 steps/s
[Step=7750 Epoch=37.8] | Loss=0.02986 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.177 | L2-Norm(final)=2.519 | 3499.1 samples/s | 54.7 steps/s
[Step=7800 Epoch=38.0] | Loss=0.02918 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.184 | L2-Norm(final)=2.521 | 3932.1 samples/s | 61.4 steps/s
[Step=7850 Epoch=38.3] | Loss=0.02812 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.190 | L2-Norm(final)=2.521 | 1610.7 samples/s | 25.2 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02699 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.197 | L2-Norm(final)=2.523 | 3504.6 samples/s | 54.8 steps/s
[Step=7950 Epoch=38.8] | Loss=0.02620 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.526 | 3512.1 samples/s | 54.9 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02576 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.208 | L2-Norm(final)=2.528 | 3759.5 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step8000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.3] | Loss=0.06756 | Reg=0.00365 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.099 | L2-Norm(final)=2.563 | 3703.0 samples/s | 57.9 steps/s
[Step=7250 Epoch=35.6] | Loss=0.04706 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.100 | L2-Norm(final)=2.550 | 3361.0 samples/s | 52.5 steps/s
[Step=7300 Epoch=35.8] | Loss=0.04407 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.103 | L2-Norm(final)=2.532 | 3513.0 samples/s | 54.9 steps/s
[Step=7350 Epoch=36.0] | Loss=0.04505 | Reg=0.00365 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.112 | L2-Norm(final)=2.522 | 3513.1 samples/s | 54.9 steps/s
[Step=7400 Epoch=36.3] | Loss=0.04418 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.123 | L2-Norm(final)=2.513 | 4383.3 samples/s | 68.5 steps/s
[Step=7450 Epoch=36.5] | Loss=0.04032 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.509 | 1554.0 samples/s | 24.3 steps/s
[Step=7500 Epoch=36.8] | Loss=0.03718 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.145 | L2-Norm(final)=2.508 | 3518.6 samples/s | 55.0 steps/s
[Step=7550 Epoch=37.0] | Loss=0.03533 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.156 | L2-Norm(final)=2.510 | 3503.6 samples/s | 54.7 steps/s
[Step=7600 Epoch=37.3] | Loss=0.03412 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.166 | L2-Norm(final)=2.511 | 4249.3 samples/s | 66.4 steps/s
[Step=7650 Epoch=37.5] | Loss=0.03299 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.175 | L2-Norm(final)=2.511 | 1583.2 samples/s | 24.7 steps/s
[Step=7700 Epoch=37.8] | Loss=0.03153 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.184 | L2-Norm(final)=2.512 | 3513.0 samples/s | 54.9 steps/s
[Step=7750 Epoch=38.0] | Loss=0.03000 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.192 | L2-Norm(final)=2.514 | 3525.1 samples/s | 55.1 steps/s
[Step=7800 Epoch=38.2] | Loss=0.02899 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.198 | L2-Norm(final)=2.517 | 4123.8 samples/s | 64.4 steps/s
[Step=7850 Epoch=38.5] | Loss=0.02808 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.204 | L2-Norm(final)=2.519 | 1587.9 samples/s | 24.8 steps/s
[Step=7900 Epoch=38.7] | Loss=0.02735 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.209 | L2-Norm(final)=2.520 | 3525.2 samples/s | 55.1 steps/s
[Step=7950 Epoch=39.0] | Loss=0.02636 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.215 | L2-Norm(final)=2.522 | 3529.5 samples/s | 55.1 steps/s
[Step=8000 Epoch=39.2] | Loss=0.02547 | Reg=0.00369 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.525 | 3981.4 samples/s | 62.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step8000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.2] | Loss=0.11003 | Reg=0.00365 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.099 | L2-Norm(final)=2.564 | 3494.5 samples/s | 54.6 steps/s
[Step=7250 Epoch=68.7] | Loss=0.02719 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.205 | L2-Norm(final)=2.514 | 3275.7 samples/s | 51.2 steps/s
[Step=7300 Epoch=69.2] | Loss=0.01610 | Reg=0.00370 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.226 | L2-Norm(final)=2.492 | 4197.3 samples/s | 65.6 steps/s
[Step=7350 Epoch=69.6] | Loss=0.01077 | Reg=0.00369 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.221 | L2-Norm(final)=2.492 | 1515.7 samples/s | 23.7 steps/s
[Step=7400 Epoch=70.1] | Loss=0.00820 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.209 | L2-Norm(final)=2.495 | 3945.8 samples/s | 61.7 steps/s
[Step=7450 Epoch=70.6] | Loss=0.00657 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.197 | L2-Norm(final)=2.500 | 1097.9 samples/s | 17.2 steps/s
[Step=7500 Epoch=71.1] | Loss=0.00552 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.184 | L2-Norm(final)=2.504 | 3733.8 samples/s | 58.3 steps/s
[Step=7550 Epoch=71.5] | Loss=0.00476 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.173 | L2-Norm(final)=2.509 | 1576.3 samples/s | 24.6 steps/s
[Step=7600 Epoch=72.0] | Loss=0.00417 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.163 | L2-Norm(final)=2.513 | 3565.1 samples/s | 55.7 steps/s
[Step=7650 Epoch=72.5] | Loss=0.00371 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.153 | L2-Norm(final)=2.517 | 1615.2 samples/s | 25.2 steps/s
[Step=7700 Epoch=73.0] | Loss=0.00334 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.520 | 3423.7 samples/s | 53.5 steps/s
[Step=7750 Epoch=73.4] | Loss=0.00304 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.135 | L2-Norm(final)=2.523 | 1661.6 samples/s | 26.0 steps/s
[Step=7800 Epoch=73.9] | Loss=0.00279 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.127 | L2-Norm(final)=2.526 | 3400.2 samples/s | 53.1 steps/s
[Step=7850 Epoch=74.4] | Loss=0.00258 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.120 | L2-Norm(final)=2.529 | 1658.1 samples/s | 25.9 steps/s
[Step=7900 Epoch=74.9] | Loss=0.00239 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.531 | 3375.0 samples/s | 52.7 steps/s
[Step=7950 Epoch=75.3] | Loss=0.00224 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.106 | L2-Norm(final)=2.534 | 1682.6 samples/s | 26.3 steps/s
[Step=8000 Epoch=75.8] | Loss=0.00210 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.100 | L2-Norm(final)=2.536 | 3378.0 samples/s | 52.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step8000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.5] | Loss=0.26528 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.099 | L2-Norm(final)=2.561 | 3497.3 samples/s | 54.6 steps/s
[Step=7250 Epoch=69.0] | Loss=0.02983 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.197 | L2-Norm(final)=2.491 | 3298.0 samples/s | 51.5 steps/s
[Step=7300 Epoch=69.4] | Loss=0.01632 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.211 | L2-Norm(final)=2.486 | 4243.9 samples/s | 66.3 steps/s
[Step=7350 Epoch=69.9] | Loss=0.01104 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.200 | L2-Norm(final)=2.492 | 1522.8 samples/s | 23.8 steps/s
[Step=7400 Epoch=70.4] | Loss=0.00832 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.187 | L2-Norm(final)=2.498 | 3972.2 samples/s | 62.1 steps/s
[Step=7450 Epoch=70.9] | Loss=0.00666 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.174 | L2-Norm(final)=2.504 | 1566.2 samples/s | 24.5 steps/s
[Step=7500 Epoch=71.3] | Loss=0.00556 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.161 | L2-Norm(final)=2.509 | 3797.7 samples/s | 59.3 steps/s
[Step=7550 Epoch=71.8] | Loss=0.00478 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.150 | L2-Norm(final)=2.514 | 1594.9 samples/s | 24.9 steps/s
[Step=7600 Epoch=72.3] | Loss=0.00418 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.139 | L2-Norm(final)=2.518 | 3599.8 samples/s | 56.2 steps/s
[Step=7650 Epoch=72.8] | Loss=0.00372 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=2.522 | 1598.7 samples/s | 25.0 steps/s
[Step=7700 Epoch=73.2] | Loss=0.00336 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.120 | L2-Norm(final)=2.525 | 3402.9 samples/s | 53.2 steps/s
[Step=7750 Epoch=73.7] | Loss=0.00305 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.529 | 1631.4 samples/s | 25.5 steps/s
[Step=7800 Epoch=74.2] | Loss=0.00280 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.104 | L2-Norm(final)=2.532 | 3374.6 samples/s | 52.7 steps/s
[Step=7850 Epoch=74.7] | Loss=0.00259 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.097 | L2-Norm(final)=2.535 | 1661.4 samples/s | 26.0 steps/s
[Step=7900 Epoch=75.1] | Loss=0.00241 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.091 | L2-Norm(final)=2.537 | 3396.3 samples/s | 53.1 steps/s
[Step=7950 Epoch=75.6] | Loss=0.00225 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.085 | L2-Norm(final)=2.540 | 1682.1 samples/s | 26.3 steps/s
[Step=8000 Epoch=76.1] | Loss=0.00211 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.079 | L2-Norm(final)=2.542 | 3328.8 samples/s | 52.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step8000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.8] | Loss=0.04625 | Reg=0.00365 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.099 | L2-Norm(final)=2.564 | 3514.8 samples/s | 54.9 steps/s
[Step=7250 Epoch=69.2] | Loss=0.01664 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.125 | L2-Norm(final)=2.556 | 3237.3 samples/s | 50.6 steps/s
[Step=7300 Epoch=69.7] | Loss=0.01039 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.154 | L2-Norm(final)=2.537 | 4248.5 samples/s | 66.4 steps/s
[Step=7350 Epoch=70.2] | Loss=0.00712 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.535 | 1508.8 samples/s | 23.6 steps/s
[Step=7400 Epoch=70.7] | Loss=0.00538 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.153 | L2-Norm(final)=2.536 | 4057.0 samples/s | 63.4 steps/s
[Step=7450 Epoch=71.1] | Loss=0.00431 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.145 | L2-Norm(final)=2.539 | 1528.7 samples/s | 23.9 steps/s
[Step=7500 Epoch=71.6] | Loss=0.00360 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.541 | 3869.1 samples/s | 60.5 steps/s
[Step=7550 Epoch=72.1] | Loss=0.00309 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.128 | L2-Norm(final)=2.544 | 1558.7 samples/s | 24.4 steps/s
[Step=7600 Epoch=72.6] | Loss=0.00271 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.120 | L2-Norm(final)=2.546 | 3674.4 samples/s | 57.4 steps/s
[Step=7650 Epoch=73.1] | Loss=0.00241 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.548 | 1585.6 samples/s | 24.8 steps/s
[Step=7700 Epoch=73.5] | Loss=0.00217 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.105 | L2-Norm(final)=2.550 | 3547.2 samples/s | 55.4 steps/s
[Step=7750 Epoch=74.0] | Loss=0.00198 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.098 | L2-Norm(final)=2.552 | 1616.0 samples/s | 25.3 steps/s
[Step=7800 Epoch=74.5] | Loss=0.00182 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.092 | L2-Norm(final)=2.554 | 3405.9 samples/s | 53.2 steps/s
[Step=7850 Epoch=75.0] | Loss=0.00168 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.086 | L2-Norm(final)=2.556 | 1639.4 samples/s | 25.6 steps/s
[Step=7900 Epoch=75.4] | Loss=0.00156 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.080 | L2-Norm(final)=2.557 | 3378.0 samples/s | 52.8 steps/s
[Step=7950 Epoch=75.9] | Loss=0.00146 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.075 | L2-Norm(final)=2.559 | 1653.3 samples/s | 25.8 steps/s
[Step=8000 Epoch=76.4] | Loss=0.00137 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.070 | L2-Norm(final)=2.561 | 3386.6 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step8000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=67.9] | Loss=0.19434 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.099 | L2-Norm(final)=2.563 | 3779.4 samples/s | 59.1 steps/s
[Step=7250 Epoch=68.3] | Loss=0.02389 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.177 | L2-Norm(final)=2.514 | 3115.1 samples/s | 48.7 steps/s
[Step=7300 Epoch=68.8] | Loss=0.01584 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.209 | L2-Norm(final)=2.504 | 4182.0 samples/s | 65.3 steps/s
[Step=7350 Epoch=69.3] | Loss=0.01080 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.213 | L2-Norm(final)=2.509 | 1510.1 samples/s | 23.6 steps/s
[Step=7400 Epoch=69.7] | Loss=0.00855 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.210 | L2-Norm(final)=2.514 | 3901.0 samples/s | 61.0 steps/s
[Step=7450 Epoch=70.2] | Loss=0.00688 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.204 | L2-Norm(final)=2.520 | 1566.5 samples/s | 24.5 steps/s
[Step=7500 Epoch=70.7] | Loss=0.00574 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.196 | L2-Norm(final)=2.525 | 3677.1 samples/s | 57.5 steps/s
[Step=7550 Epoch=71.1] | Loss=0.00492 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.186 | L2-Norm(final)=2.529 | 1588.2 samples/s | 24.8 steps/s
[Step=7600 Epoch=71.6] | Loss=0.00431 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.177 | L2-Norm(final)=2.532 | 3502.7 samples/s | 54.7 steps/s
[Step=7650 Epoch=72.1] | Loss=0.00384 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.167 | L2-Norm(final)=2.535 | 1649.0 samples/s | 25.8 steps/s
[Step=7700 Epoch=72.6] | Loss=0.00345 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.158 | L2-Norm(final)=2.538 | 3426.5 samples/s | 53.5 steps/s
[Step=7750 Epoch=73.0] | Loss=0.00314 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.540 | 1651.4 samples/s | 25.8 steps/s
[Step=7800 Epoch=73.5] | Loss=0.00288 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.141 | L2-Norm(final)=2.543 | 3383.8 samples/s | 52.9 steps/s
[Step=7850 Epoch=74.0] | Loss=0.00267 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.133 | L2-Norm(final)=2.545 | 1673.6 samples/s | 26.1 steps/s
[Step=7900 Epoch=74.4] | Loss=0.00248 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.126 | L2-Norm(final)=2.547 | 3339.2 samples/s | 52.2 steps/s
[Step=7950 Epoch=74.9] | Loss=0.00231 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.119 | L2-Norm(final)=2.549 | 1711.0 samples/s | 26.7 steps/s
[Step=8000 Epoch=75.4] | Loss=0.00217 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.551 | 3250.9 samples/s | 50.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step8000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.6] | Loss=0.15304 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.099 | L2-Norm(final)=2.561 | 3538.6 samples/s | 55.3 steps/s
[Step=7250 Epoch=69.1] | Loss=0.01684 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.140 | L2-Norm(final)=2.523 | 3253.1 samples/s | 50.8 steps/s
[Step=7300 Epoch=69.6] | Loss=0.01062 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.162 | L2-Norm(final)=2.522 | 4242.0 samples/s | 66.3 steps/s
[Step=7350 Epoch=70.1] | Loss=0.00724 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.164 | L2-Norm(final)=2.525 | 1506.7 samples/s | 23.5 steps/s
[Step=7400 Epoch=70.5] | Loss=0.00559 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.530 | 4029.2 samples/s | 63.0 steps/s
[Step=7450 Epoch=71.0] | Loss=0.00449 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.535 | 1540.6 samples/s | 24.1 steps/s
[Step=7500 Epoch=71.5] | Loss=0.00375 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.140 | L2-Norm(final)=2.539 | 3857.3 samples/s | 60.3 steps/s
[Step=7550 Epoch=72.0] | Loss=0.00322 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.131 | L2-Norm(final)=2.542 | 1560.9 samples/s | 24.4 steps/s
[Step=7600 Epoch=72.4] | Loss=0.00282 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.121 | L2-Norm(final)=2.545 | 3686.2 samples/s | 57.6 steps/s
[Step=7650 Epoch=72.9] | Loss=0.00251 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.113 | L2-Norm(final)=2.547 | 1598.7 samples/s | 25.0 steps/s
[Step=7700 Epoch=73.4] | Loss=0.00226 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.105 | L2-Norm(final)=2.550 | 3519.4 samples/s | 55.0 steps/s
[Step=7750 Epoch=73.9] | Loss=0.00206 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.097 | L2-Norm(final)=2.552 | 1617.4 samples/s | 25.3 steps/s
[Step=7800 Epoch=74.3] | Loss=0.00189 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.090 | L2-Norm(final)=2.554 | 3410.2 samples/s | 53.3 steps/s
[Step=7850 Epoch=74.8] | Loss=0.00175 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.084 | L2-Norm(final)=2.556 | 1657.4 samples/s | 25.9 steps/s
[Step=7900 Epoch=75.3] | Loss=0.00162 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.078 | L2-Norm(final)=2.558 | 3378.1 samples/s | 52.8 steps/s
[Step=7950 Epoch=75.8] | Loss=0.00152 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.072 | L2-Norm(final)=2.560 | 1664.5 samples/s | 26.0 steps/s
[Step=8000 Epoch=76.2] | Loss=0.00143 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.067 | L2-Norm(final)=2.561 | 3385.6 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23224 | acc=0.8292 | tpr=0.7579 | fpr=0.0159 | 3645.6 samples/s | 14.2 steps/s
Avg test loss: 0.23383, Avg test acc: 0.82863, Avg tpr: 0.75829, Avg fpr: 0.01666, total FA: 130

Testing server on iccad2012
[Step=  50] | Loss=0.45531 | acc=0.7570 | tpr=0.9735 | fpr=0.2469 | 3629.8 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.45844 | acc=0.7561 | tpr=0.9744 | fpr=0.2480 | 7003.6 samples/s | 27.4 steps/s
[Step= 150] | Loss=0.46298 | acc=0.7543 | tpr=0.9755 | fpr=0.2497 | 6790.0 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.46242 | acc=0.7546 | tpr=0.9760 | fpr=0.2494 | 7114.2 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.46304 | acc=0.7545 | tpr=0.9755 | fpr=0.2495 | 6634.7 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.46133 | acc=0.7554 | tpr=0.9724 | fpr=0.2486 | 6891.5 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.46149 | acc=0.7557 | tpr=0.9718 | fpr=0.2483 | 6828.0 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.46193 | acc=0.7554 | tpr=0.9721 | fpr=0.2486 | 6751.3 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.46485 | acc=0.7546 | tpr=0.9713 | fpr=0.2494 | 6888.8 samples/s | 26.9 steps/s
[Step= 500] | Loss=0.46640 | acc=0.7538 | tpr=0.9718 | fpr=0.2501 | 6712.5 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.46583 | acc=0.7543 | tpr=0.9717 | fpr=0.2496 | 12275.1 samples/s | 47.9 steps/s
Avg test loss: 0.46573, Avg test acc: 0.75430, Avg tpr: 0.97187, Avg fpr: 0.24965, total FA: 34664

server round 10/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.13232 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.075 | L2-Norm(final)=2.569 | 3807.9 samples/s | 59.5 steps/s
[Step=8050 Epoch=39.3] | Loss=0.04672 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.059 | L2-Norm(final)=2.553 | 3236.5 samples/s | 50.6 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03825 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.050 | L2-Norm(final)=2.549 | 3519.7 samples/s | 55.0 steps/s
[Step=8150 Epoch=39.7] | Loss=0.03476 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.047 | L2-Norm(final)=2.550 | 3508.6 samples/s | 54.8 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03106 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.046 | L2-Norm(final)=2.552 | 4367.4 samples/s | 68.2 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02709 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.047 | L2-Norm(final)=2.556 | 1556.2 samples/s | 24.3 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02426 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.049 | L2-Norm(final)=2.561 | 3506.8 samples/s | 54.8 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02287 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.050 | L2-Norm(final)=2.567 | 3487.0 samples/s | 54.5 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02175 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.052 | L2-Norm(final)=2.571 | 4121.6 samples/s | 64.4 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02020 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.576 | 1583.4 samples/s | 24.7 steps/s
[Step=8500 Epoch=41.4] | Loss=0.01897 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.054 | L2-Norm(final)=2.580 | 3531.3 samples/s | 55.2 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01840 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.056 | L2-Norm(final)=2.584 | 3518.7 samples/s | 55.0 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01760 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.057 | L2-Norm(final)=2.588 | 3939.0 samples/s | 61.5 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01678 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.058 | L2-Norm(final)=2.592 | 1614.7 samples/s | 25.2 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01638 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.059 | L2-Norm(final)=2.595 | 3535.5 samples/s | 55.2 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01577 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.061 | L2-Norm(final)=2.599 | 3505.7 samples/s | 54.8 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01534 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.062 | L2-Norm(final)=2.602 | 3754.4 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step8800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.16567 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.075 | L2-Norm(final)=2.568 | 3456.5 samples/s | 54.0 steps/s
[Step=8050 Epoch=39.3] | Loss=0.04427 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.062 | L2-Norm(final)=2.547 | 3580.9 samples/s | 56.0 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03304 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.055 | L2-Norm(final)=2.550 | 3522.8 samples/s | 55.0 steps/s
[Step=8150 Epoch=39.8] | Loss=0.03126 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.052 | L2-Norm(final)=2.553 | 3514.4 samples/s | 54.9 steps/s
[Step=8200 Epoch=40.0] | Loss=0.02774 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.050 | L2-Norm(final)=2.555 | 4370.3 samples/s | 68.3 steps/s
[Step=8250 Epoch=40.3] | Loss=0.02439 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.050 | L2-Norm(final)=2.560 | 1560.2 samples/s | 24.4 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02219 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.051 | L2-Norm(final)=2.565 | 3511.1 samples/s | 54.9 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02039 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.570 | 3489.7 samples/s | 54.5 steps/s
[Step=8400 Epoch=41.0] | Loss=0.01930 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.054 | L2-Norm(final)=2.575 | 4121.3 samples/s | 64.4 steps/s
[Step=8450 Epoch=41.2] | Loss=0.01842 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.055 | L2-Norm(final)=2.578 | 1580.4 samples/s | 24.7 steps/s
[Step=8500 Epoch=41.5] | Loss=0.01755 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.056 | L2-Norm(final)=2.582 | 3489.5 samples/s | 54.5 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01668 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.057 | L2-Norm(final)=2.586 | 3511.2 samples/s | 54.9 steps/s
[Step=8600 Epoch=42.0] | Loss=0.01607 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.057 | L2-Norm(final)=2.589 | 4020.3 samples/s | 62.8 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01517 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.058 | L2-Norm(final)=2.593 | 1613.1 samples/s | 25.2 steps/s
[Step=8700 Epoch=42.5] | Loss=0.01473 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.059 | L2-Norm(final)=2.596 | 3507.3 samples/s | 54.8 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01423 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.059 | L2-Norm(final)=2.599 | 3505.0 samples/s | 54.8 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01386 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.060 | L2-Norm(final)=2.603 | 3833.1 samples/s | 59.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step8800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.10556 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.075 | L2-Norm(final)=2.569 | 3659.4 samples/s | 57.2 steps/s
[Step=8050 Epoch=39.2] | Loss=0.03934 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.052 | L2-Norm(final)=2.558 | 3374.5 samples/s | 52.7 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03409 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.044 | L2-Norm(final)=2.559 | 3493.8 samples/s | 54.6 steps/s
[Step=8150 Epoch=39.7] | Loss=0.03237 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.041 | L2-Norm(final)=2.559 | 3502.5 samples/s | 54.7 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03044 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.559 | 4344.2 samples/s | 67.9 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02679 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.041 | L2-Norm(final)=2.561 | 1570.3 samples/s | 24.5 steps/s
[Step=8300 Epoch=40.4] | Loss=0.02439 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.041 | L2-Norm(final)=2.564 | 3512.1 samples/s | 54.9 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02314 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.043 | L2-Norm(final)=2.568 | 3456.0 samples/s | 54.0 steps/s
[Step=8400 Epoch=40.9] | Loss=0.02216 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.044 | L2-Norm(final)=2.571 | 4120.4 samples/s | 64.4 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02124 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.045 | L2-Norm(final)=2.574 | 1603.6 samples/s | 25.1 steps/s
[Step=8500 Epoch=41.4] | Loss=0.02008 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.047 | L2-Norm(final)=2.577 | 3521.3 samples/s | 55.0 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01908 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.048 | L2-Norm(final)=2.580 | 3530.9 samples/s | 55.2 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01836 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.049 | L2-Norm(final)=2.583 | 3929.3 samples/s | 61.4 steps/s
[Step=8650 Epoch=42.1] | Loss=0.01746 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.051 | L2-Norm(final)=2.586 | 1630.3 samples/s | 25.5 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01678 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.590 | 3486.5 samples/s | 54.5 steps/s
[Step=8750 Epoch=42.6] | Loss=0.01646 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.054 | L2-Norm(final)=2.593 | 3493.6 samples/s | 54.6 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01595 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.055 | L2-Norm(final)=2.595 | 3741.6 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step8800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.15061 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.075 | L2-Norm(final)=2.568 | 3521.0 samples/s | 55.0 steps/s
[Step=8050 Epoch=39.3] | Loss=0.03677 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.052 | L2-Norm(final)=2.556 | 3485.5 samples/s | 54.5 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03227 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.042 | L2-Norm(final)=2.556 | 3515.2 samples/s | 54.9 steps/s
[Step=8150 Epoch=39.7] | Loss=0.02974 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.039 | L2-Norm(final)=2.558 | 3524.4 samples/s | 55.1 steps/s
[Step=8200 Epoch=40.0] | Loss=0.02950 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.037 | L2-Norm(final)=2.558 | 4378.6 samples/s | 68.4 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02582 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.037 | L2-Norm(final)=2.560 | 1544.5 samples/s | 24.1 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02315 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.039 | L2-Norm(final)=2.564 | 3537.3 samples/s | 55.3 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02154 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.041 | L2-Norm(final)=2.569 | 3527.3 samples/s | 55.1 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02019 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.043 | L2-Norm(final)=2.575 | 4138.1 samples/s | 64.7 steps/s
[Step=8450 Epoch=41.2] | Loss=0.01883 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.045 | L2-Norm(final)=2.579 | 1582.6 samples/s | 24.7 steps/s
[Step=8500 Epoch=41.5] | Loss=0.01772 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.046 | L2-Norm(final)=2.583 | 3533.9 samples/s | 55.2 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01688 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.048 | L2-Norm(final)=2.588 | 3519.5 samples/s | 55.0 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01649 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.049 | L2-Norm(final)=2.591 | 3938.5 samples/s | 61.5 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01574 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.050 | L2-Norm(final)=2.594 | 1618.0 samples/s | 25.3 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01511 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.051 | L2-Norm(final)=2.598 | 3518.9 samples/s | 55.0 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01468 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.601 | 3489.4 samples/s | 54.5 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01427 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.054 | L2-Norm(final)=2.605 | 3756.6 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step8800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.2] | Loss=0.15509 | Reg=0.00364 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.075 | L2-Norm(final)=2.568 | 3714.2 samples/s | 58.0 steps/s
[Step=8050 Epoch=39.5] | Loss=0.03365 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.057 | L2-Norm(final)=2.558 | 3333.7 samples/s | 52.1 steps/s
[Step=8100 Epoch=39.7] | Loss=0.03221 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.051 | L2-Norm(final)=2.562 | 3518.4 samples/s | 55.0 steps/s
[Step=8150 Epoch=40.0] | Loss=0.03185 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.047 | L2-Norm(final)=2.560 | 3526.2 samples/s | 55.1 steps/s
[Step=8200 Epoch=40.2] | Loss=0.02952 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.047 | L2-Norm(final)=2.560 | 4418.8 samples/s | 69.0 steps/s
[Step=8250 Epoch=40.5] | Loss=0.02660 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.048 | L2-Norm(final)=2.562 | 1542.4 samples/s | 24.1 steps/s
[Step=8300 Epoch=40.7] | Loss=0.02428 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.050 | L2-Norm(final)=2.566 | 3524.1 samples/s | 55.1 steps/s
[Step=8350 Epoch=40.9] | Loss=0.02256 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.051 | L2-Norm(final)=2.570 | 3511.3 samples/s | 54.9 steps/s
[Step=8400 Epoch=41.2] | Loss=0.02106 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.053 | L2-Norm(final)=2.575 | 4256.7 samples/s | 66.5 steps/s
[Step=8450 Epoch=41.4] | Loss=0.01967 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.055 | L2-Norm(final)=2.580 | 1578.6 samples/s | 24.7 steps/s
[Step=8500 Epoch=41.7] | Loss=0.01891 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.056 | L2-Norm(final)=2.584 | 3523.4 samples/s | 55.1 steps/s
[Step=8550 Epoch=41.9] | Loss=0.01786 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.058 | L2-Norm(final)=2.588 | 3484.8 samples/s | 54.4 steps/s
[Step=8600 Epoch=42.2] | Loss=0.01739 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.060 | L2-Norm(final)=2.591 | 4105.9 samples/s | 64.2 steps/s
[Step=8650 Epoch=42.4] | Loss=0.01663 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.061 | L2-Norm(final)=2.595 | 1584.3 samples/s | 24.8 steps/s
[Step=8700 Epoch=42.7] | Loss=0.01608 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.063 | L2-Norm(final)=2.598 | 3517.5 samples/s | 55.0 steps/s
[Step=8750 Epoch=42.9] | Loss=0.01549 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.064 | L2-Norm(final)=2.601 | 3521.8 samples/s | 55.0 steps/s
[Step=8800 Epoch=43.2] | Loss=0.01496 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.065 | L2-Norm(final)=2.605 | 3978.6 samples/s | 62.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step8800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=75.8] | Loss=0.08157 | Reg=0.00364 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.075 | L2-Norm(final)=2.569 | 3470.9 samples/s | 54.2 steps/s
[Step=8050 Epoch=76.3] | Loss=0.01817 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.061 | L2-Norm(final)=2.552 | 3286.4 samples/s | 51.3 steps/s
[Step=8100 Epoch=76.8] | Loss=0.01042 | Reg=0.00363 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.055 | L2-Norm(final)=2.556 | 4210.2 samples/s | 65.8 steps/s
[Step=8150 Epoch=77.2] | Loss=0.00702 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.049 | L2-Norm(final)=2.559 | 1487.9 samples/s | 23.2 steps/s
[Step=8200 Epoch=77.7] | Loss=0.00529 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.042 | L2-Norm(final)=2.562 | 3953.6 samples/s | 61.8 steps/s
[Step=8250 Epoch=78.2] | Loss=0.00425 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.037 | L2-Norm(final)=2.565 | 1548.5 samples/s | 24.2 steps/s
[Step=8300 Epoch=78.6] | Loss=0.00355 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.031 | L2-Norm(final)=2.567 | 3742.8 samples/s | 58.5 steps/s
[Step=8350 Epoch=79.1] | Loss=0.00305 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.027 | L2-Norm(final)=2.569 | 1558.2 samples/s | 24.3 steps/s
[Step=8400 Epoch=79.6] | Loss=0.00267 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.022 | L2-Norm(final)=2.570 | 3577.4 samples/s | 55.9 steps/s
[Step=8450 Epoch=80.1] | Loss=0.00238 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.018 | L2-Norm(final)=2.572 | 1601.6 samples/s | 25.0 steps/s
[Step=8500 Epoch=80.5] | Loss=0.00215 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.015 | L2-Norm(final)=2.573 | 3407.0 samples/s | 53.2 steps/s
[Step=8550 Epoch=81.0] | Loss=0.00196 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.011 | L2-Norm(final)=2.574 | 1629.7 samples/s | 25.5 steps/s
[Step=8600 Epoch=81.5] | Loss=0.00180 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.575 | 3366.8 samples/s | 52.6 steps/s
[Step=8650 Epoch=82.0] | Loss=0.00166 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.005 | L2-Norm(final)=2.576 | 1664.2 samples/s | 26.0 steps/s
[Step=8700 Epoch=82.4] | Loss=0.00155 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.002 | L2-Norm(final)=2.577 | 3356.8 samples/s | 52.4 steps/s
[Step=8750 Epoch=82.9] | Loss=0.00145 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.000 | L2-Norm(final)=2.578 | 1650.7 samples/s | 25.8 steps/s
[Step=8800 Epoch=83.4] | Loss=0.00136 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.997 | L2-Norm(final)=2.579 | 3402.0 samples/s | 53.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step8800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=76.1] | Loss=0.11973 | Reg=0.00364 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.075 | L2-Norm(final)=2.569 | 3644.4 samples/s | 56.9 steps/s
[Step=8050 Epoch=76.6] | Loss=0.01544 | Reg=0.00364 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.073 | L2-Norm(final)=2.566 | 3197.0 samples/s | 50.0 steps/s
[Step=8100 Epoch=77.1] | Loss=0.00876 | Reg=0.00364 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.067 | L2-Norm(final)=2.570 | 4251.0 samples/s | 66.4 steps/s
[Step=8150 Epoch=77.5] | Loss=0.00591 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.060 | L2-Norm(final)=2.574 | 1506.7 samples/s | 23.5 steps/s
[Step=8200 Epoch=78.0] | Loss=0.00447 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.052 | L2-Norm(final)=2.576 | 3998.2 samples/s | 62.5 steps/s
[Step=8250 Epoch=78.5] | Loss=0.00359 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.046 | L2-Norm(final)=2.579 | 1530.6 samples/s | 23.9 steps/s
[Step=8300 Epoch=79.0] | Loss=0.00300 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.580 | 3790.4 samples/s | 59.2 steps/s
[Step=8350 Epoch=79.4] | Loss=0.00258 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.034 | L2-Norm(final)=2.582 | 1578.7 samples/s | 24.7 steps/s
[Step=8400 Epoch=79.9] | Loss=0.00226 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.029 | L2-Norm(final)=2.583 | 3323.5 samples/s | 51.9 steps/s
[Step=8450 Epoch=80.4] | Loss=0.00202 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.025 | L2-Norm(final)=2.584 | 1473.7 samples/s | 23.0 steps/s
[Step=8500 Epoch=80.9] | Loss=0.00182 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.021 | L2-Norm(final)=2.585 | 3107.5 samples/s | 48.6 steps/s
[Step=8550 Epoch=81.3] | Loss=0.00166 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.017 | L2-Norm(final)=2.586 | 1602.7 samples/s | 25.0 steps/s
[Step=8600 Epoch=81.8] | Loss=0.00152 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.014 | L2-Norm(final)=2.587 | 3309.9 samples/s | 51.7 steps/s
[Step=8650 Epoch=82.3] | Loss=0.00141 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.011 | L2-Norm(final)=2.588 | 1657.9 samples/s | 25.9 steps/s
[Step=8700 Epoch=82.8] | Loss=0.00131 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.589 | 3357.4 samples/s | 52.5 steps/s
[Step=8750 Epoch=83.2] | Loss=0.00123 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.005 | L2-Norm(final)=2.589 | 1665.1 samples/s | 26.0 steps/s
[Step=8800 Epoch=83.7] | Loss=0.00115 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.002 | L2-Norm(final)=2.590 | 3311.9 samples/s | 51.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step8800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=76.4] | Loss=0.10475 | Reg=0.00364 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.075 | L2-Norm(final)=2.569 | 3808.4 samples/s | 59.5 steps/s
[Step=8050 Epoch=76.9] | Loss=0.01380 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.046 | L2-Norm(final)=2.558 | 3021.1 samples/s | 47.2 steps/s
[Step=8100 Epoch=77.4] | Loss=0.00757 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.038 | L2-Norm(final)=2.561 | 4254.2 samples/s | 66.5 steps/s
[Step=8150 Epoch=77.8] | Loss=0.00509 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.031 | L2-Norm(final)=2.566 | 1513.7 samples/s | 23.7 steps/s
[Step=8200 Epoch=78.3] | Loss=0.00384 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.026 | L2-Norm(final)=2.569 | 4038.1 samples/s | 63.1 steps/s
[Step=8250 Epoch=78.8] | Loss=0.00308 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.021 | L2-Norm(final)=2.572 | 1533.7 samples/s | 24.0 steps/s
[Step=8300 Epoch=79.3] | Loss=0.00258 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.016 | L2-Norm(final)=2.574 | 3856.3 samples/s | 60.3 steps/s
[Step=8350 Epoch=79.7] | Loss=0.00221 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.012 | L2-Norm(final)=2.575 | 1565.4 samples/s | 24.5 steps/s
[Step=8400 Epoch=80.2] | Loss=0.00194 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.577 | 3685.2 samples/s | 57.6 steps/s
[Step=8450 Epoch=80.7] | Loss=0.00173 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.004 | L2-Norm(final)=2.578 | 1583.1 samples/s | 24.7 steps/s
[Step=8500 Epoch=81.2] | Loss=0.00156 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.001 | L2-Norm(final)=2.579 | 3198.6 samples/s | 50.0 steps/s
[Step=8550 Epoch=81.6] | Loss=0.00142 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.998 | L2-Norm(final)=2.580 | 1575.2 samples/s | 24.6 steps/s
[Step=8600 Epoch=82.1] | Loss=0.00131 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.995 | L2-Norm(final)=2.581 | 3327.9 samples/s | 52.0 steps/s
[Step=8650 Epoch=82.6] | Loss=0.00121 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.992 | L2-Norm(final)=2.582 | 1584.3 samples/s | 24.8 steps/s
[Step=8700 Epoch=83.1] | Loss=0.00113 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.990 | L2-Norm(final)=2.583 | 3384.0 samples/s | 52.9 steps/s
[Step=8750 Epoch=83.6] | Loss=0.00105 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.987 | L2-Norm(final)=2.584 | 1660.6 samples/s | 25.9 steps/s
[Step=8800 Epoch=84.0] | Loss=0.00099 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.985 | L2-Norm(final)=2.584 | 3349.1 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step8800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=75.4] | Loss=0.11945 | Reg=0.00364 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.075 | L2-Norm(final)=2.568 | 3630.6 samples/s | 56.7 steps/s
[Step=8050 Epoch=75.9] | Loss=0.01146 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.023 | L2-Norm(final)=2.552 | 3145.2 samples/s | 49.1 steps/s
[Step=8100 Epoch=76.3] | Loss=0.00889 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.018 | L2-Norm(final)=2.553 | 4195.9 samples/s | 65.6 steps/s
[Step=8150 Epoch=76.8] | Loss=0.00751 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.028 | L2-Norm(final)=2.552 | 1510.5 samples/s | 23.6 steps/s
[Step=8200 Epoch=77.3] | Loss=0.00571 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.033 | L2-Norm(final)=2.554 | 3905.0 samples/s | 61.0 steps/s
[Step=8250 Epoch=77.7] | Loss=0.00459 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.035 | L2-Norm(final)=2.556 | 1554.5 samples/s | 24.3 steps/s
[Step=8300 Epoch=78.2] | Loss=0.00383 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.034 | L2-Norm(final)=2.559 | 3707.5 samples/s | 57.9 steps/s
[Step=8350 Epoch=78.7] | Loss=0.00329 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.032 | L2-Norm(final)=2.560 | 1585.4 samples/s | 24.8 steps/s
[Step=8400 Epoch=79.2] | Loss=0.00289 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.030 | L2-Norm(final)=2.562 | 3491.3 samples/s | 54.6 steps/s
[Step=8450 Epoch=79.6] | Loss=0.00257 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.028 | L2-Norm(final)=2.564 | 1627.5 samples/s | 25.4 steps/s
[Step=8500 Epoch=80.1] | Loss=0.00232 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.026 | L2-Norm(final)=2.565 | 3375.7 samples/s | 52.7 steps/s
[Step=8550 Epoch=80.6] | Loss=0.00211 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.023 | L2-Norm(final)=2.567 | 1674.7 samples/s | 26.2 steps/s
[Step=8600 Epoch=81.0] | Loss=0.00194 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.021 | L2-Norm(final)=2.568 | 3386.1 samples/s | 52.9 steps/s
[Step=8650 Epoch=81.5] | Loss=0.00179 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.019 | L2-Norm(final)=2.569 | 1670.3 samples/s | 26.1 steps/s
[Step=8700 Epoch=82.0] | Loss=0.00167 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.016 | L2-Norm(final)=2.570 | 3338.3 samples/s | 52.2 steps/s
[Step=8750 Epoch=82.4] | Loss=0.00156 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.014 | L2-Norm(final)=2.571 | 1788.7 samples/s | 27.9 steps/s
[Step=8800 Epoch=82.9] | Loss=0.00147 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.012 | L2-Norm(final)=2.572 | 2958.2 samples/s | 46.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step8800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=76.3] | Loss=0.18007 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.075 | L2-Norm(final)=2.568 | 3511.2 samples/s | 54.9 steps/s
[Step=8050 Epoch=76.7] | Loss=0.01703 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.051 | L2-Norm(final)=2.552 | 3252.0 samples/s | 50.8 steps/s
[Step=8100 Epoch=77.2] | Loss=0.00934 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.046 | L2-Norm(final)=2.556 | 4249.3 samples/s | 66.4 steps/s
[Step=8150 Epoch=77.7] | Loss=0.00630 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.561 | 1510.7 samples/s | 23.6 steps/s
[Step=8200 Epoch=78.2] | Loss=0.00475 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.034 | L2-Norm(final)=2.565 | 4008.4 samples/s | 62.6 steps/s
[Step=8250 Epoch=78.6] | Loss=0.00382 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.029 | L2-Norm(final)=2.568 | 1537.8 samples/s | 24.0 steps/s
[Step=8300 Epoch=79.1] | Loss=0.00319 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.024 | L2-Norm(final)=2.571 | 3861.0 samples/s | 60.3 steps/s
[Step=8350 Epoch=79.6] | Loss=0.00274 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.019 | L2-Norm(final)=2.573 | 1550.0 samples/s | 24.2 steps/s
[Step=8400 Epoch=80.1] | Loss=0.00240 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.015 | L2-Norm(final)=2.574 | 3640.2 samples/s | 56.9 steps/s
[Step=8450 Epoch=80.5] | Loss=0.00214 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.011 | L2-Norm(final)=2.576 | 1599.5 samples/s | 25.0 steps/s
[Step=8500 Epoch=81.0] | Loss=0.00193 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.577 | 3516.8 samples/s | 55.0 steps/s
[Step=8550 Epoch=81.5] | Loss=0.00176 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.004 | L2-Norm(final)=2.578 | 1600.9 samples/s | 25.0 steps/s
[Step=8600 Epoch=82.0] | Loss=0.00162 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.001 | L2-Norm(final)=2.580 | 3399.8 samples/s | 53.1 steps/s
[Step=8650 Epoch=82.4] | Loss=0.00150 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.998 | L2-Norm(final)=2.581 | 1646.0 samples/s | 25.7 steps/s
[Step=8700 Epoch=82.9] | Loss=0.00139 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.996 | L2-Norm(final)=2.582 | 3357.6 samples/s | 52.5 steps/s
[Step=8750 Epoch=83.4] | Loss=0.00130 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.993 | L2-Norm(final)=2.583 | 1671.1 samples/s | 26.1 steps/s
[Step=8800 Epoch=83.9] | Loss=0.00122 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.991 | L2-Norm(final)=2.583 | 3369.1 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29715 | acc=0.7915 | tpr=0.7021 | fpr=0.0144 | 3679.8 samples/s | 14.4 steps/s
Avg test loss: 0.29818, Avg test acc: 0.79185, Avg tpr: 0.70420, Avg fpr: 0.01538, total FA: 120

Testing server on iccad2012
[Step=  50] | Loss=0.36836 | acc=0.8208 | tpr=0.9735 | fpr=0.1820 | 3606.8 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.37270 | acc=0.8203 | tpr=0.9744 | fpr=0.1826 | 6917.3 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.37796 | acc=0.8194 | tpr=0.9769 | fpr=0.1835 | 7082.3 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.37789 | acc=0.8196 | tpr=0.9781 | fpr=0.1832 | 6739.5 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.37855 | acc=0.8199 | tpr=0.9790 | fpr=0.1830 | 6965.3 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.37748 | acc=0.8204 | tpr=0.9753 | fpr=0.1824 | 6689.5 samples/s | 26.1 steps/s
[Step= 350] | Loss=0.37840 | acc=0.8206 | tpr=0.9756 | fpr=0.1822 | 6913.0 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.37881 | acc=0.8203 | tpr=0.9754 | fpr=0.1825 | 6688.5 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.38191 | acc=0.8197 | tpr=0.9752 | fpr=0.1831 | 6706.0 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.38336 | acc=0.8190 | tpr=0.9753 | fpr=0.1838 | 6848.4 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.38282 | acc=0.8193 | tpr=0.9749 | fpr=0.1835 | 12589.0 samples/s | 49.2 steps/s
Avg test loss: 0.38269, Avg test acc: 0.81937, Avg tpr: 0.97504, Avg fpr: 0.18346, total FA: 25473

server round 11/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.09092 | Reg=0.00361 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.989 | L2-Norm(final)=2.622 | 3579.0 samples/s | 55.9 steps/s
[Step=8850 Epoch=43.2] | Loss=0.04082 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.980 | L2-Norm(final)=2.604 | 3452.1 samples/s | 53.9 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03571 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.971 | L2-Norm(final)=2.599 | 3510.1 samples/s | 54.8 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03130 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.966 | L2-Norm(final)=2.596 | 3521.7 samples/s | 55.0 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02949 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.964 | L2-Norm(final)=2.596 | 4372.3 samples/s | 68.3 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02629 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.965 | L2-Norm(final)=2.598 | 1574.3 samples/s | 24.6 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02350 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.967 | L2-Norm(final)=2.602 | 3528.2 samples/s | 55.1 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02252 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.968 | L2-Norm(final)=2.605 | 3529.5 samples/s | 55.1 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02110 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.969 | L2-Norm(final)=2.608 | 4101.0 samples/s | 64.1 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02006 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.971 | L2-Norm(final)=2.612 | 1605.0 samples/s | 25.1 steps/s
[Step=9300 Epoch=45.3] | Loss=0.01891 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.973 | L2-Norm(final)=2.615 | 3516.7 samples/s | 54.9 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01849 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.974 | L2-Norm(final)=2.618 | 3506.4 samples/s | 54.8 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01779 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.976 | L2-Norm(final)=2.621 | 3925.6 samples/s | 61.3 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01684 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.977 | L2-Norm(final)=2.625 | 1624.0 samples/s | 25.4 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01620 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.978 | L2-Norm(final)=2.628 | 3507.8 samples/s | 54.8 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01567 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.979 | L2-Norm(final)=2.631 | 3486.1 samples/s | 54.5 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01533 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.980 | L2-Norm(final)=2.634 | 3743.8 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step9600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.18301 | Reg=0.00361 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.989 | L2-Norm(final)=2.621 | 3763.2 samples/s | 58.8 steps/s
[Step=8850 Epoch=43.2] | Loss=0.03957 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.976 | L2-Norm(final)=2.597 | 3282.5 samples/s | 51.3 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03401 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.968 | L2-Norm(final)=2.591 | 3529.1 samples/s | 55.1 steps/s
[Step=8950 Epoch=43.7] | Loss=0.03171 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.965 | L2-Norm(final)=2.589 | 3528.8 samples/s | 55.1 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02943 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.963 | L2-Norm(final)=2.589 | 4360.0 samples/s | 68.1 steps/s
[Step=9050 Epoch=44.2] | Loss=0.02597 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.964 | L2-Norm(final)=2.591 | 1552.5 samples/s | 24.3 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02334 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.966 | L2-Norm(final)=2.596 | 3493.8 samples/s | 54.6 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02170 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.968 | L2-Norm(final)=2.601 | 3474.3 samples/s | 54.3 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02060 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.969 | L2-Norm(final)=2.605 | 4163.0 samples/s | 65.0 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01906 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.971 | L2-Norm(final)=2.610 | 1572.3 samples/s | 24.6 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01800 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.972 | L2-Norm(final)=2.614 | 3482.9 samples/s | 54.4 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01733 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.974 | L2-Norm(final)=2.618 | 3506.1 samples/s | 54.8 steps/s
[Step=9400 Epoch=45.9] | Loss=0.01682 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.975 | L2-Norm(final)=2.621 | 4002.1 samples/s | 62.5 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01639 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.976 | L2-Norm(final)=2.623 | 1607.7 samples/s | 25.1 steps/s
[Step=9500 Epoch=46.4] | Loss=0.01586 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.977 | L2-Norm(final)=2.626 | 3518.4 samples/s | 55.0 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01553 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.977 | L2-Norm(final)=2.628 | 3513.7 samples/s | 54.9 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01509 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.978 | L2-Norm(final)=2.630 | 3854.5 samples/s | 60.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step9600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.20174 | Reg=0.00361 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.989 | L2-Norm(final)=2.621 | 3550.3 samples/s | 55.5 steps/s
[Step=8850 Epoch=43.1] | Loss=0.04474 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.978 | L2-Norm(final)=2.601 | 3501.4 samples/s | 54.7 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03785 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.972 | L2-Norm(final)=2.597 | 3524.8 samples/s | 55.1 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03333 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.970 | L2-Norm(final)=2.597 | 3517.0 samples/s | 55.0 steps/s
[Step=9000 Epoch=43.9] | Loss=0.03131 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.969 | L2-Norm(final)=2.598 | 4362.3 samples/s | 68.2 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02771 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.969 | L2-Norm(final)=2.600 | 1550.0 samples/s | 24.2 steps/s
[Step=9100 Epoch=44.3] | Loss=0.02460 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.970 | L2-Norm(final)=2.603 | 3476.5 samples/s | 54.3 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02274 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.972 | L2-Norm(final)=2.608 | 3503.4 samples/s | 54.7 steps/s
[Step=9200 Epoch=44.8] | Loss=0.02185 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.973 | L2-Norm(final)=2.612 | 4132.1 samples/s | 64.6 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02056 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.974 | L2-Norm(final)=2.615 | 1589.7 samples/s | 24.8 steps/s
[Step=9300 Epoch=45.3] | Loss=0.01954 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.976 | L2-Norm(final)=2.619 | 3496.7 samples/s | 54.6 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01873 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.977 | L2-Norm(final)=2.622 | 3523.6 samples/s | 55.1 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01797 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.979 | L2-Norm(final)=2.626 | 3938.4 samples/s | 61.5 steps/s
[Step=9450 Epoch=46.0] | Loss=0.01725 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.981 | L2-Norm(final)=2.629 | 1610.5 samples/s | 25.2 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01639 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.982 | L2-Norm(final)=2.633 | 3517.0 samples/s | 55.0 steps/s
[Step=9550 Epoch=46.5] | Loss=0.01593 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.983 | L2-Norm(final)=2.636 | 3497.1 samples/s | 54.6 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01540 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.985 | L2-Norm(final)=2.639 | 3749.8 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step9600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.18548 | Reg=0.00361 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.989 | L2-Norm(final)=2.621 | 3696.2 samples/s | 57.8 steps/s
[Step=8850 Epoch=43.2] | Loss=0.04323 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.976 | L2-Norm(final)=2.596 | 3296.8 samples/s | 51.5 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03636 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.966 | L2-Norm(final)=2.594 | 3482.1 samples/s | 54.4 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03140 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.961 | L2-Norm(final)=2.593 | 3489.7 samples/s | 54.5 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02885 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.960 | L2-Norm(final)=2.593 | 4327.9 samples/s | 67.6 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02668 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.961 | L2-Norm(final)=2.595 | 1576.6 samples/s | 24.6 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02420 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.962 | L2-Norm(final)=2.599 | 3499.9 samples/s | 54.7 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02298 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.964 | L2-Norm(final)=2.602 | 3517.0 samples/s | 55.0 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02142 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.966 | L2-Norm(final)=2.606 | 4138.6 samples/s | 64.7 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02020 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.969 | L2-Norm(final)=2.611 | 1594.3 samples/s | 24.9 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01900 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.971 | L2-Norm(final)=2.615 | 3498.4 samples/s | 54.7 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01792 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.972 | L2-Norm(final)=2.619 | 3492.3 samples/s | 54.6 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01722 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.974 | L2-Norm(final)=2.622 | 3928.3 samples/s | 61.4 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01668 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.975 | L2-Norm(final)=2.625 | 1623.4 samples/s | 25.4 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01601 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.976 | L2-Norm(final)=2.628 | 3516.6 samples/s | 54.9 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01540 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.977 | L2-Norm(final)=2.632 | 3503.4 samples/s | 54.7 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01487 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.978 | L2-Norm(final)=2.635 | 3739.3 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step9600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=43.2] | Loss=0.11891 | Reg=0.00361 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.989 | L2-Norm(final)=2.622 | 3636.5 samples/s | 56.8 steps/s
[Step=8850 Epoch=43.4] | Loss=0.04625 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.985 | L2-Norm(final)=2.598 | 3404.5 samples/s | 53.2 steps/s
[Step=8900 Epoch=43.6] | Loss=0.03600 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.981 | L2-Norm(final)=2.597 | 3499.6 samples/s | 54.7 steps/s
[Step=8950 Epoch=43.9] | Loss=0.03395 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.981 | L2-Norm(final)=2.598 | 3489.8 samples/s | 54.5 steps/s
[Step=9000 Epoch=44.1] | Loss=0.03164 | Reg=0.00360 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.983 | L2-Norm(final)=2.598 | 4341.1 samples/s | 67.8 steps/s
[Step=9050 Epoch=44.4] | Loss=0.02761 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.984 | L2-Norm(final)=2.601 | 1562.1 samples/s | 24.4 steps/s
[Step=9100 Epoch=44.6] | Loss=0.02489 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.986 | L2-Norm(final)=2.605 | 3527.1 samples/s | 55.1 steps/s
[Step=9150 Epoch=44.9] | Loss=0.02297 | Reg=0.00361 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.988 | L2-Norm(final)=2.609 | 3524.9 samples/s | 55.1 steps/s
[Step=9200 Epoch=45.1] | Loss=0.02184 | Reg=0.00361 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.989 | L2-Norm(final)=2.614 | 4246.9 samples/s | 66.4 steps/s
[Step=9250 Epoch=45.4] | Loss=0.02060 | Reg=0.00361 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.990 | L2-Norm(final)=2.617 | 1572.1 samples/s | 24.6 steps/s
[Step=9300 Epoch=45.6] | Loss=0.01931 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.991 | L2-Norm(final)=2.621 | 3500.4 samples/s | 54.7 steps/s
[Step=9350 Epoch=45.9] | Loss=0.01843 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.992 | L2-Norm(final)=2.625 | 3505.0 samples/s | 54.8 steps/s
[Step=9400 Epoch=46.1] | Loss=0.01776 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.993 | L2-Norm(final)=2.628 | 4061.6 samples/s | 63.5 steps/s
[Step=9450 Epoch=46.3] | Loss=0.01690 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.993 | L2-Norm(final)=2.632 | 1599.4 samples/s | 25.0 steps/s
[Step=9500 Epoch=46.6] | Loss=0.01622 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.994 | L2-Norm(final)=2.635 | 3519.7 samples/s | 55.0 steps/s
[Step=9550 Epoch=46.8] | Loss=0.01566 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.994 | L2-Norm(final)=2.638 | 3518.0 samples/s | 55.0 steps/s
[Step=9600 Epoch=47.1] | Loss=0.01530 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.995 | L2-Norm(final)=2.641 | 3956.9 samples/s | 61.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step9600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=83.4] | Loss=0.13313 | Reg=0.00361 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.989 | L2-Norm(final)=2.622 | 3431.4 samples/s | 53.6 steps/s
[Step=8850 Epoch=83.9] | Loss=0.01064 | Reg=0.00359 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.951 | L2-Norm(final)=2.618 | 3295.2 samples/s | 51.5 steps/s
[Step=8900 Epoch=84.3] | Loss=0.00595 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.947 | L2-Norm(final)=2.621 | 4200.8 samples/s | 65.6 steps/s
[Step=8950 Epoch=84.8] | Loss=0.00401 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.942 | L2-Norm(final)=2.625 | 1514.8 samples/s | 23.7 steps/s
[Step=9000 Epoch=85.3] | Loss=0.00302 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.936 | L2-Norm(final)=2.627 | 3978.2 samples/s | 62.2 steps/s
[Step=9050 Epoch=85.8] | Loss=0.00242 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.931 | L2-Norm(final)=2.629 | 1556.7 samples/s | 24.3 steps/s
[Step=9100 Epoch=86.2] | Loss=0.00202 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.926 | L2-Norm(final)=2.631 | 3750.9 samples/s | 58.6 steps/s
[Step=9150 Epoch=86.7] | Loss=0.00174 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.921 | L2-Norm(final)=2.632 | 1597.7 samples/s | 25.0 steps/s
[Step=9200 Epoch=87.2] | Loss=0.00153 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.917 | L2-Norm(final)=2.633 | 3568.9 samples/s | 55.8 steps/s
[Step=9250 Epoch=87.7] | Loss=0.00136 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.914 | L2-Norm(final)=2.634 | 1591.0 samples/s | 24.9 steps/s
[Step=9300 Epoch=88.1] | Loss=0.00123 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.910 | L2-Norm(final)=2.635 | 3402.4 samples/s | 53.2 steps/s
[Step=9350 Epoch=88.6] | Loss=0.00112 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.907 | L2-Norm(final)=2.635 | 1654.9 samples/s | 25.9 steps/s
[Step=9400 Epoch=89.1] | Loss=0.00103 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.904 | L2-Norm(final)=2.636 | 3366.2 samples/s | 52.6 steps/s
[Step=9450 Epoch=89.5] | Loss=0.00095 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.902 | L2-Norm(final)=2.637 | 1661.0 samples/s | 26.0 steps/s
[Step=9500 Epoch=90.0] | Loss=0.00089 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.899 | L2-Norm(final)=2.638 | 3352.7 samples/s | 52.4 steps/s
[Step=9550 Epoch=90.5] | Loss=0.00083 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.897 | L2-Norm(final)=2.638 | 1658.8 samples/s | 25.9 steps/s
[Step=9600 Epoch=91.0] | Loss=0.00078 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.895 | L2-Norm(final)=2.639 | 3378.4 samples/s | 52.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step9600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=83.7] | Loss=0.05380 | Reg=0.00361 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.989 | L2-Norm(final)=2.623 | 3444.3 samples/s | 53.8 steps/s
[Step=8850 Epoch=84.2] | Loss=0.00942 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.956 | L2-Norm(final)=2.618 | 3307.8 samples/s | 51.7 steps/s
[Step=8900 Epoch=84.7] | Loss=0.00520 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.953 | L2-Norm(final)=2.623 | 4230.6 samples/s | 66.1 steps/s
[Step=8950 Epoch=85.1] | Loss=0.00352 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.948 | L2-Norm(final)=2.627 | 1516.9 samples/s | 23.7 steps/s
[Step=9000 Epoch=85.6] | Loss=0.00265 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.942 | L2-Norm(final)=2.630 | 3967.6 samples/s | 62.0 steps/s
[Step=9050 Epoch=86.1] | Loss=0.00213 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.936 | L2-Norm(final)=2.632 | 1548.8 samples/s | 24.2 steps/s
[Step=9100 Epoch=86.6] | Loss=0.00178 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.931 | L2-Norm(final)=2.633 | 3715.4 samples/s | 58.1 steps/s
[Step=9150 Epoch=87.0] | Loss=0.00154 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.926 | L2-Norm(final)=2.635 | 1584.4 samples/s | 24.8 steps/s
[Step=9200 Epoch=87.5] | Loss=0.00135 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.922 | L2-Norm(final)=2.636 | 3598.5 samples/s | 56.2 steps/s
[Step=9250 Epoch=88.0] | Loss=0.00120 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.918 | L2-Norm(final)=2.636 | 1621.4 samples/s | 25.3 steps/s
[Step=9300 Epoch=88.5] | Loss=0.00108 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.915 | L2-Norm(final)=2.637 | 3411.5 samples/s | 53.3 steps/s
[Step=9350 Epoch=88.9] | Loss=0.00099 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.911 | L2-Norm(final)=2.638 | 1630.1 samples/s | 25.5 steps/s
[Step=9400 Epoch=89.4] | Loss=0.00091 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.908 | L2-Norm(final)=2.639 | 3368.4 samples/s | 52.6 steps/s
[Step=9450 Epoch=89.9] | Loss=0.00084 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.906 | L2-Norm(final)=2.639 | 1669.3 samples/s | 26.1 steps/s
[Step=9500 Epoch=90.4] | Loss=0.00078 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.903 | L2-Norm(final)=2.640 | 3323.7 samples/s | 51.9 steps/s
[Step=9550 Epoch=90.8] | Loss=0.00073 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.901 | L2-Norm(final)=2.640 | 1660.8 samples/s | 26.0 steps/s
[Step=9600 Epoch=91.3] | Loss=0.00069 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.898 | L2-Norm(final)=2.641 | 3377.4 samples/s | 52.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step9600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=84.0] | Loss=0.24705 | Reg=0.00361 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.989 | L2-Norm(final)=2.621 | 3412.3 samples/s | 53.3 steps/s
[Step=8850 Epoch=84.5] | Loss=0.01952 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.974 | L2-Norm(final)=2.600 | 3264.2 samples/s | 51.0 steps/s
[Step=8900 Epoch=85.0] | Loss=0.01020 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.975 | L2-Norm(final)=2.610 | 4253.3 samples/s | 66.5 steps/s
[Step=8950 Epoch=85.5] | Loss=0.00687 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.970 | L2-Norm(final)=2.617 | 1510.7 samples/s | 23.6 steps/s
[Step=9000 Epoch=85.9] | Loss=0.00518 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.964 | L2-Norm(final)=2.621 | 4045.2 samples/s | 63.2 steps/s
[Step=9050 Epoch=86.4] | Loss=0.00415 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.959 | L2-Norm(final)=2.624 | 1533.3 samples/s | 24.0 steps/s
[Step=9100 Epoch=86.9] | Loss=0.00347 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.953 | L2-Norm(final)=2.626 | 3850.5 samples/s | 60.2 steps/s
[Step=9150 Epoch=87.4] | Loss=0.00297 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.948 | L2-Norm(final)=2.628 | 1569.6 samples/s | 24.5 steps/s
[Step=9200 Epoch=87.9] | Loss=0.00261 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.944 | L2-Norm(final)=2.630 | 3686.3 samples/s | 57.6 steps/s
[Step=9250 Epoch=88.3] | Loss=0.00232 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.940 | L2-Norm(final)=2.631 | 1580.2 samples/s | 24.7 steps/s
[Step=9300 Epoch=88.8] | Loss=0.00210 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.936 | L2-Norm(final)=2.632 | 3521.1 samples/s | 55.0 steps/s
[Step=9350 Epoch=89.3] | Loss=0.00191 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.932 | L2-Norm(final)=2.633 | 1615.7 samples/s | 25.2 steps/s
[Step=9400 Epoch=89.8] | Loss=0.00175 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.929 | L2-Norm(final)=2.634 | 3371.8 samples/s | 52.7 steps/s
[Step=9450 Epoch=90.2] | Loss=0.00162 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.925 | L2-Norm(final)=2.635 | 1655.3 samples/s | 25.9 steps/s
[Step=9500 Epoch=90.7] | Loss=0.00151 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.922 | L2-Norm(final)=2.636 | 3352.6 samples/s | 52.4 steps/s
[Step=9550 Epoch=91.2] | Loss=0.00141 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.919 | L2-Norm(final)=2.636 | 1665.7 samples/s | 26.0 steps/s
[Step=9600 Epoch=91.7] | Loss=0.00132 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.917 | L2-Norm(final)=2.637 | 3340.9 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step9600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=82.9] | Loss=0.10258 | Reg=0.00361 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.989 | L2-Norm(final)=2.623 | 3603.5 samples/s | 56.3 steps/s
[Step=8850 Epoch=83.4] | Loss=0.01032 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.943 | L2-Norm(final)=2.611 | 3165.0 samples/s | 49.5 steps/s
[Step=8900 Epoch=83.9] | Loss=0.00533 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.935 | L2-Norm(final)=2.614 | 4190.8 samples/s | 65.5 steps/s
[Step=8950 Epoch=84.3] | Loss=0.00424 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.933 | L2-Norm(final)=2.620 | 1503.1 samples/s | 23.5 steps/s
[Step=9000 Epoch=84.8] | Loss=0.00326 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.933 | L2-Norm(final)=2.626 | 3898.5 samples/s | 60.9 steps/s
[Step=9050 Epoch=85.3] | Loss=0.00263 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.931 | L2-Norm(final)=2.631 | 1560.4 samples/s | 24.4 steps/s
[Step=9100 Epoch=85.7] | Loss=0.00220 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.929 | L2-Norm(final)=2.634 | 3677.5 samples/s | 57.5 steps/s
[Step=9150 Epoch=86.2] | Loss=0.00189 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.927 | L2-Norm(final)=2.636 | 1591.9 samples/s | 24.9 steps/s
[Step=9200 Epoch=86.7] | Loss=0.00166 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.924 | L2-Norm(final)=2.638 | 3465.4 samples/s | 54.1 steps/s
[Step=9250 Epoch=87.2] | Loss=0.00148 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.922 | L2-Norm(final)=2.640 | 1615.0 samples/s | 25.2 steps/s
[Step=9300 Epoch=87.6] | Loss=0.00134 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.919 | L2-Norm(final)=2.641 | 3337.9 samples/s | 52.2 steps/s
[Step=9350 Epoch=88.1] | Loss=0.00122 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.916 | L2-Norm(final)=2.642 | 1655.1 samples/s | 25.9 steps/s
[Step=9400 Epoch=88.6] | Loss=0.00112 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.914 | L2-Norm(final)=2.643 | 3356.2 samples/s | 52.4 steps/s
[Step=9450 Epoch=89.0] | Loss=0.00104 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.912 | L2-Norm(final)=2.644 | 1664.4 samples/s | 26.0 steps/s
[Step=9500 Epoch=89.5] | Loss=0.00096 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.910 | L2-Norm(final)=2.644 | 3334.5 samples/s | 52.1 steps/s
[Step=9550 Epoch=90.0] | Loss=0.00090 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.907 | L2-Norm(final)=2.645 | 1722.5 samples/s | 26.9 steps/s
[Step=9600 Epoch=90.5] | Loss=0.00085 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.905 | L2-Norm(final)=2.646 | 3128.6 samples/s | 48.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step9600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=83.9] | Loss=0.07043 | Reg=0.00361 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.989 | L2-Norm(final)=2.623 | 3597.2 samples/s | 56.2 steps/s
[Step=8850 Epoch=84.3] | Loss=0.01279 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.958 | L2-Norm(final)=2.605 | 3191.3 samples/s | 49.9 steps/s
[Step=8900 Epoch=84.8] | Loss=0.00729 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.954 | L2-Norm(final)=2.606 | 4211.4 samples/s | 65.8 steps/s
[Step=8950 Epoch=85.3] | Loss=0.00601 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.955 | L2-Norm(final)=2.609 | 1520.6 samples/s | 23.8 steps/s
[Step=9000 Epoch=85.8] | Loss=0.00459 | Reg=0.00359 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.954 | L2-Norm(final)=2.613 | 4036.1 samples/s | 63.1 steps/s
[Step=9050 Epoch=86.3] | Loss=0.00369 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.951 | L2-Norm(final)=2.617 | 1538.0 samples/s | 24.0 steps/s
[Step=9100 Epoch=86.7] | Loss=0.00308 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.947 | L2-Norm(final)=2.619 | 3875.5 samples/s | 60.6 steps/s
[Step=9150 Epoch=87.2] | Loss=0.00264 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.943 | L2-Norm(final)=2.622 | 1561.7 samples/s | 24.4 steps/s
[Step=9200 Epoch=87.7] | Loss=0.00232 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.939 | L2-Norm(final)=2.624 | 3670.5 samples/s | 57.4 steps/s
[Step=9250 Epoch=88.2] | Loss=0.00206 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.936 | L2-Norm(final)=2.625 | 1575.3 samples/s | 24.6 steps/s
[Step=9300 Epoch=88.6] | Loss=0.00186 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.932 | L2-Norm(final)=2.627 | 3555.3 samples/s | 55.6 steps/s
[Step=9350 Epoch=89.1] | Loss=0.00169 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.928 | L2-Norm(final)=2.628 | 1611.8 samples/s | 25.2 steps/s
[Step=9400 Epoch=89.6] | Loss=0.00156 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.925 | L2-Norm(final)=2.629 | 3400.9 samples/s | 53.1 steps/s
[Step=9450 Epoch=90.1] | Loss=0.00144 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.922 | L2-Norm(final)=2.630 | 1642.4 samples/s | 25.7 steps/s
[Step=9500 Epoch=90.5] | Loss=0.00134 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.919 | L2-Norm(final)=2.631 | 3378.1 samples/s | 52.8 steps/s
[Step=9550 Epoch=91.0] | Loss=0.00125 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.916 | L2-Norm(final)=2.632 | 1649.3 samples/s | 25.8 steps/s
[Step=9600 Epoch=91.5] | Loss=0.00118 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.914 | L2-Norm(final)=2.633 | 3358.6 samples/s | 52.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24750 | acc=0.8325 | tpr=0.7623 | fpr=0.0151 | 3637.9 samples/s | 14.2 steps/s
Avg test loss: 0.24857, Avg test acc: 0.83252, Avg tpr: 0.76354, Avg fpr: 0.01577, total FA: 123

Testing server on iccad2012
[Step=  50] | Loss=0.44539 | acc=0.7871 | tpr=0.9779 | fpr=0.2163 | 3602.0 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.44878 | acc=0.7865 | tpr=0.9765 | fpr=0.2171 | 6844.4 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.45415 | acc=0.7854 | tpr=0.9769 | fpr=0.2181 | 6843.5 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.45402 | acc=0.7860 | tpr=0.9781 | fpr=0.2175 | 6925.1 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.45413 | acc=0.7864 | tpr=0.9782 | fpr=0.2171 | 6751.0 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.45251 | acc=0.7871 | tpr=0.9731 | fpr=0.2163 | 6862.4 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.45306 | acc=0.7876 | tpr=0.9718 | fpr=0.2158 | 6937.4 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.45337 | acc=0.7874 | tpr=0.9710 | fpr=0.2159 | 6803.4 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.45674 | acc=0.7865 | tpr=0.9708 | fpr=0.2169 | 6733.8 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.45848 | acc=0.7856 | tpr=0.9714 | fpr=0.2178 | 6762.8 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.45772 | acc=0.7862 | tpr=0.9710 | fpr=0.2172 | 12804.7 samples/s | 50.0 steps/s
Avg test loss: 0.45771, Avg test acc: 0.78619, Avg tpr: 0.97108, Avg fpr: 0.21717, total FA: 30154

server round 12/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.24914 | Reg=0.00357 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.903 | L2-Norm(final)=2.662 | 3587.7 samples/s | 56.1 steps/s
[Step=9650 Epoch=47.1] | Loss=0.03866 | Reg=0.00357 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.884 | L2-Norm(final)=2.637 | 3423.6 samples/s | 53.5 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03276 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.879 | L2-Norm(final)=2.633 | 3501.1 samples/s | 54.7 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03020 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.879 | L2-Norm(final)=2.632 | 3492.2 samples/s | 54.6 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02802 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.880 | L2-Norm(final)=2.635 | 4331.1 samples/s | 67.7 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02503 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.882 | L2-Norm(final)=2.637 | 1572.3 samples/s | 24.6 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02353 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.885 | L2-Norm(final)=2.640 | 3496.1 samples/s | 54.6 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02255 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.886 | L2-Norm(final)=2.641 | 3516.3 samples/s | 54.9 steps/s
[Step=10000 Epoch=48.8] | Loss=0.02113 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.887 | L2-Norm(final)=2.643 | 4132.0 samples/s | 64.6 steps/s
[Step=10050 Epoch=49.0] | Loss=0.02027 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.889 | L2-Norm(final)=2.645 | 1595.2 samples/s | 24.9 steps/s
[Step=10100 Epoch=49.2] | Loss=0.01891 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.890 | L2-Norm(final)=2.647 | 3513.5 samples/s | 54.9 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01802 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.891 | L2-Norm(final)=2.650 | 3515.6 samples/s | 54.9 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01731 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.893 | L2-Norm(final)=2.653 | 3942.7 samples/s | 61.6 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01668 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.894 | L2-Norm(final)=2.656 | 1637.1 samples/s | 25.6 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01618 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.895 | L2-Norm(final)=2.659 | 3516.2 samples/s | 54.9 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01561 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.896 | L2-Norm(final)=2.661 | 3496.6 samples/s | 54.6 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01508 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.898 | L2-Norm(final)=2.664 | 3716.4 samples/s | 58.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step10400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.10992 | Reg=0.00357 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.903 | L2-Norm(final)=2.662 | 3873.0 samples/s | 60.5 steps/s
[Step=9650 Epoch=47.1] | Loss=0.04374 | Reg=0.00357 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.885 | L2-Norm(final)=2.639 | 3232.2 samples/s | 50.5 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03649 | Reg=0.00357 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.882 | L2-Norm(final)=2.633 | 3530.4 samples/s | 55.2 steps/s
[Step=9750 Epoch=47.6] | Loss=0.03171 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.885 | L2-Norm(final)=2.636 | 3529.5 samples/s | 55.1 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02916 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.889 | L2-Norm(final)=2.640 | 4384.2 samples/s | 68.5 steps/s
[Step=9850 Epoch=48.1] | Loss=0.02605 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.895 | L2-Norm(final)=2.644 | 1556.5 samples/s | 24.3 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02395 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.899 | L2-Norm(final)=2.648 | 3501.5 samples/s | 54.7 steps/s
[Step=9950 Epoch=48.6] | Loss=0.02178 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.902 | L2-Norm(final)=2.652 | 3492.5 samples/s | 54.6 steps/s
[Step=10000 Epoch=48.8] | Loss=0.02133 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.905 | L2-Norm(final)=2.655 | 4196.8 samples/s | 65.6 steps/s
[Step=10050 Epoch=49.0] | Loss=0.02019 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.907 | L2-Norm(final)=2.658 | 1573.3 samples/s | 24.6 steps/s
[Step=10100 Epoch=49.3] | Loss=0.01932 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.909 | L2-Norm(final)=2.661 | 3496.0 samples/s | 54.6 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01848 | Reg=0.00358 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.911 | L2-Norm(final)=2.663 | 3507.0 samples/s | 54.8 steps/s
[Step=10200 Epoch=49.8] | Loss=0.01769 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.912 | L2-Norm(final)=2.665 | 4007.0 samples/s | 62.6 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01689 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.913 | L2-Norm(final)=2.667 | 1612.9 samples/s | 25.2 steps/s
[Step=10300 Epoch=50.3] | Loss=0.01605 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.914 | L2-Norm(final)=2.670 | 3511.4 samples/s | 54.9 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01558 | Reg=0.00358 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.915 | L2-Norm(final)=2.673 | 3510.0 samples/s | 54.8 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01542 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.916 | L2-Norm(final)=2.675 | 3820.4 samples/s | 59.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step10400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.21490 | Reg=0.00357 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=18.903 | L2-Norm(final)=2.662 | 3711.4 samples/s | 58.0 steps/s
[Step=9650 Epoch=47.0] | Loss=0.04876 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.891 | L2-Norm(final)=2.635 | 3333.9 samples/s | 52.1 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03714 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.889 | L2-Norm(final)=2.631 | 3510.9 samples/s | 54.9 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03365 | Reg=0.00357 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.890 | L2-Norm(final)=2.633 | 3496.0 samples/s | 54.6 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03134 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.892 | L2-Norm(final)=2.633 | 4349.6 samples/s | 68.0 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02775 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.894 | L2-Norm(final)=2.635 | 1567.2 samples/s | 24.5 steps/s
[Step=9900 Epoch=48.2] | Loss=0.02571 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.896 | L2-Norm(final)=2.638 | 3509.2 samples/s | 54.8 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02456 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.898 | L2-Norm(final)=2.641 | 3503.1 samples/s | 54.7 steps/s
[Step=10000 Epoch=48.7] | Loss=0.02297 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.899 | L2-Norm(final)=2.643 | 4116.7 samples/s | 64.3 steps/s
[Step=10050 Epoch=49.0] | Loss=0.02129 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.900 | L2-Norm(final)=2.646 | 1581.8 samples/s | 24.7 steps/s
[Step=10100 Epoch=49.2] | Loss=0.02022 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.901 | L2-Norm(final)=2.649 | 3516.7 samples/s | 54.9 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01912 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.902 | L2-Norm(final)=2.652 | 3519.5 samples/s | 55.0 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01840 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.904 | L2-Norm(final)=2.655 | 3922.6 samples/s | 61.3 steps/s
[Step=10250 Epoch=49.9] | Loss=0.01791 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.905 | L2-Norm(final)=2.658 | 1634.1 samples/s | 25.5 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01705 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.906 | L2-Norm(final)=2.661 | 3513.2 samples/s | 54.9 steps/s
[Step=10350 Epoch=50.4] | Loss=0.01637 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.908 | L2-Norm(final)=2.665 | 3493.4 samples/s | 54.6 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01602 | Reg=0.00358 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.909 | L2-Norm(final)=2.668 | 3730.0 samples/s | 58.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step10400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.20425 | Reg=0.00357 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.903 | L2-Norm(final)=2.662 | 3726.9 samples/s | 58.2 steps/s
[Step=9650 Epoch=47.1] | Loss=0.04027 | Reg=0.00357 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.888 | L2-Norm(final)=2.636 | 3315.1 samples/s | 51.8 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03285 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.883 | L2-Norm(final)=2.634 | 3488.1 samples/s | 54.5 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03131 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.882 | L2-Norm(final)=2.631 | 3501.1 samples/s | 54.7 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02963 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=18.883 | L2-Norm(final)=2.630 | 4365.1 samples/s | 68.2 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02742 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.884 | L2-Norm(final)=2.631 | 1556.3 samples/s | 24.3 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02482 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.886 | L2-Norm(final)=2.633 | 3477.9 samples/s | 54.3 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02337 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.888 | L2-Norm(final)=2.636 | 3484.8 samples/s | 54.4 steps/s
[Step=10000 Epoch=48.8] | Loss=0.02171 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.889 | L2-Norm(final)=2.639 | 4128.5 samples/s | 64.5 steps/s
[Step=10050 Epoch=49.0] | Loss=0.02038 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.892 | L2-Norm(final)=2.643 | 1601.7 samples/s | 25.0 steps/s
[Step=10100 Epoch=49.3] | Loss=0.01947 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.893 | L2-Norm(final)=2.646 | 3489.6 samples/s | 54.5 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01859 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.895 | L2-Norm(final)=2.649 | 3496.1 samples/s | 54.6 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01788 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.896 | L2-Norm(final)=2.652 | 3923.9 samples/s | 61.3 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01706 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.898 | L2-Norm(final)=2.655 | 1606.3 samples/s | 25.1 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01631 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.898 | L2-Norm(final)=2.658 | 3546.7 samples/s | 55.4 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01559 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.899 | L2-Norm(final)=2.660 | 3508.9 samples/s | 54.8 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01506 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.900 | L2-Norm(final)=2.663 | 3742.9 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step10400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=47.1] | Loss=0.23515 | Reg=0.00357 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.903 | L2-Norm(final)=2.662 | 3674.4 samples/s | 57.4 steps/s
[Step=9650 Epoch=47.3] | Loss=0.03811 | Reg=0.00357 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.885 | L2-Norm(final)=2.641 | 3369.6 samples/s | 52.7 steps/s
[Step=9700 Epoch=47.6] | Loss=0.03362 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.880 | L2-Norm(final)=2.635 | 3512.8 samples/s | 54.9 steps/s
[Step=9750 Epoch=47.8] | Loss=0.03254 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.880 | L2-Norm(final)=2.633 | 3504.1 samples/s | 54.8 steps/s
[Step=9800 Epoch=48.1] | Loss=0.02959 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.883 | L2-Norm(final)=2.634 | 4387.1 samples/s | 68.5 steps/s
[Step=9850 Epoch=48.3] | Loss=0.02559 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.885 | L2-Norm(final)=2.637 | 1498.2 samples/s | 23.4 steps/s
[Step=9900 Epoch=48.5] | Loss=0.02311 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.888 | L2-Norm(final)=2.641 | 3190.4 samples/s | 49.9 steps/s
[Step=9950 Epoch=48.8] | Loss=0.02140 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.890 | L2-Norm(final)=2.646 | 3173.9 samples/s | 49.6 steps/s
[Step=10000 Epoch=49.0] | Loss=0.02083 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.892 | L2-Norm(final)=2.649 | 3844.2 samples/s | 60.1 steps/s
[Step=10050 Epoch=49.3] | Loss=0.01939 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.893 | L2-Norm(final)=2.651 | 1524.7 samples/s | 23.8 steps/s
[Step=10100 Epoch=49.5] | Loss=0.01844 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.895 | L2-Norm(final)=2.654 | 3395.0 samples/s | 53.0 steps/s
[Step=10150 Epoch=49.8] | Loss=0.01773 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.896 | L2-Norm(final)=2.656 | 3424.3 samples/s | 53.5 steps/s
[Step=10200 Epoch=50.0] | Loss=0.01728 | Reg=0.00357 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.897 | L2-Norm(final)=2.659 | 4051.1 samples/s | 63.3 steps/s
[Step=10250 Epoch=50.3] | Loss=0.01657 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.899 | L2-Norm(final)=2.661 | 1564.4 samples/s | 24.4 steps/s
[Step=10300 Epoch=50.5] | Loss=0.01593 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.900 | L2-Norm(final)=2.663 | 3480.5 samples/s | 54.4 steps/s
[Step=10350 Epoch=50.8] | Loss=0.01545 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.901 | L2-Norm(final)=2.666 | 3482.8 samples/s | 54.4 steps/s
[Step=10400 Epoch=51.0] | Loss=0.01482 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.902 | L2-Norm(final)=2.668 | 3933.8 samples/s | 61.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step10400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.0] | Loss=0.07704 | Reg=0.00357 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.903 | L2-Norm(final)=2.664 | 3535.7 samples/s | 55.2 steps/s
[Step=9650 Epoch=91.4] | Loss=0.01252 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.886 | L2-Norm(final)=2.655 | 3260.2 samples/s | 50.9 steps/s
[Step=9700 Epoch=91.9] | Loss=0.00755 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.884 | L2-Norm(final)=2.657 | 4205.1 samples/s | 65.7 steps/s
[Step=9750 Epoch=92.4] | Loss=0.00511 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.879 | L2-Norm(final)=2.660 | 1508.0 samples/s | 23.6 steps/s
[Step=9800 Epoch=92.9] | Loss=0.00384 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.873 | L2-Norm(final)=2.663 | 3966.0 samples/s | 62.0 steps/s
[Step=9850 Epoch=93.3] | Loss=0.00308 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.867 | L2-Norm(final)=2.665 | 1549.0 samples/s | 24.2 steps/s
[Step=9900 Epoch=93.8] | Loss=0.00258 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.862 | L2-Norm(final)=2.667 | 3740.1 samples/s | 58.4 steps/s
[Step=9950 Epoch=94.3] | Loss=0.00221 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.857 | L2-Norm(final)=2.668 | 1582.2 samples/s | 24.7 steps/s
[Step=10000 Epoch=94.8] | Loss=0.00194 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.853 | L2-Norm(final)=2.670 | 3571.3 samples/s | 55.8 steps/s
[Step=10050 Epoch=95.2] | Loss=0.00173 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.849 | L2-Norm(final)=2.671 | 1560.2 samples/s | 24.4 steps/s
[Step=10100 Epoch=95.7] | Loss=0.00156 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.845 | L2-Norm(final)=2.672 | 3092.5 samples/s | 48.3 steps/s
[Step=10150 Epoch=96.2] | Loss=0.00142 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.841 | L2-Norm(final)=2.672 | 1613.0 samples/s | 25.2 steps/s
[Step=10200 Epoch=96.7] | Loss=0.00130 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.838 | L2-Norm(final)=2.673 | 3303.2 samples/s | 51.6 steps/s
[Step=10250 Epoch=97.1] | Loss=0.00121 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.834 | L2-Norm(final)=2.674 | 1653.0 samples/s | 25.8 steps/s
[Step=10300 Epoch=97.6] | Loss=0.00112 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.831 | L2-Norm(final)=2.675 | 3423.6 samples/s | 53.5 steps/s
[Step=10350 Epoch=98.1] | Loss=0.00105 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.829 | L2-Norm(final)=2.675 | 1686.8 samples/s | 26.4 steps/s
[Step=10400 Epoch=98.5] | Loss=0.00099 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.826 | L2-Norm(final)=2.676 | 3344.9 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step10400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.3] | Loss=0.20263 | Reg=0.00357 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.903 | L2-Norm(final)=2.663 | 3596.2 samples/s | 56.2 steps/s
[Step=9650 Epoch=91.8] | Loss=0.01765 | Reg=0.00357 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=18.898 | L2-Norm(final)=2.643 | 3307.2 samples/s | 51.7 steps/s
[Step=9700 Epoch=92.3] | Loss=0.01004 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.903 | L2-Norm(final)=2.644 | 4220.6 samples/s | 65.9 steps/s
[Step=9750 Epoch=92.7] | Loss=0.00680 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.899 | L2-Norm(final)=2.649 | 1522.4 samples/s | 23.8 steps/s
[Step=9800 Epoch=93.2] | Loss=0.00512 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.893 | L2-Norm(final)=2.652 | 3992.6 samples/s | 62.4 steps/s
[Step=9850 Epoch=93.7] | Loss=0.00410 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.886 | L2-Norm(final)=2.655 | 1527.0 samples/s | 23.9 steps/s
[Step=9900 Epoch=94.2] | Loss=0.00342 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.880 | L2-Norm(final)=2.656 | 3698.5 samples/s | 57.8 steps/s
[Step=9950 Epoch=94.6] | Loss=0.00294 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.874 | L2-Norm(final)=2.658 | 1571.5 samples/s | 24.6 steps/s
[Step=10000 Epoch=95.1] | Loss=0.00258 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.869 | L2-Norm(final)=2.659 | 3598.5 samples/s | 56.2 steps/s
[Step=10050 Epoch=95.6] | Loss=0.00229 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.864 | L2-Norm(final)=2.661 | 1611.5 samples/s | 25.2 steps/s
[Step=10100 Epoch=96.1] | Loss=0.00207 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.859 | L2-Norm(final)=2.662 | 3421.6 samples/s | 53.5 steps/s
[Step=10150 Epoch=96.6] | Loss=0.00188 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.855 | L2-Norm(final)=2.663 | 1651.1 samples/s | 25.8 steps/s
[Step=10200 Epoch=97.0] | Loss=0.00173 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.851 | L2-Norm(final)=2.664 | 3360.0 samples/s | 52.5 steps/s
[Step=10250 Epoch=97.5] | Loss=0.00160 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.847 | L2-Norm(final)=2.665 | 1675.8 samples/s | 26.2 steps/s
[Step=10300 Epoch=98.0] | Loss=0.00149 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.844 | L2-Norm(final)=2.665 | 3377.0 samples/s | 52.8 steps/s
[Step=10350 Epoch=98.5] | Loss=0.00139 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.840 | L2-Norm(final)=2.666 | 1677.2 samples/s | 26.2 steps/s
[Step=10400 Epoch=98.9] | Loss=0.00130 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.837 | L2-Norm(final)=2.667 | 3330.3 samples/s | 52.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step10400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.7] | Loss=0.06288 | Reg=0.00357 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.903 | L2-Norm(final)=2.664 | 3613.7 samples/s | 56.5 steps/s
[Step=9650 Epoch=92.2] | Loss=0.01420 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.887 | L2-Norm(final)=2.651 | 3168.5 samples/s | 49.5 steps/s
[Step=9700 Epoch=92.6] | Loss=0.00745 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.886 | L2-Norm(final)=2.656 | 4251.2 samples/s | 66.4 steps/s
[Step=9750 Epoch=93.1] | Loss=0.00499 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.880 | L2-Norm(final)=2.660 | 1506.7 samples/s | 23.5 steps/s
[Step=9800 Epoch=93.6] | Loss=0.00376 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.873 | L2-Norm(final)=2.662 | 4061.9 samples/s | 63.5 steps/s
[Step=9850 Epoch=94.1] | Loss=0.00302 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.867 | L2-Norm(final)=2.664 | 1549.2 samples/s | 24.2 steps/s
[Step=9900 Epoch=94.5] | Loss=0.00252 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.862 | L2-Norm(final)=2.666 | 3881.2 samples/s | 60.6 steps/s
[Step=9950 Epoch=95.0] | Loss=0.00216 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.857 | L2-Norm(final)=2.667 | 1559.2 samples/s | 24.4 steps/s
[Step=10000 Epoch=95.5] | Loss=0.00190 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.852 | L2-Norm(final)=2.668 | 3683.2 samples/s | 57.5 steps/s
[Step=10050 Epoch=96.0] | Loss=0.00169 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.848 | L2-Norm(final)=2.669 | 1593.0 samples/s | 24.9 steps/s
[Step=10100 Epoch=96.4] | Loss=0.00152 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.844 | L2-Norm(final)=2.670 | 3559.6 samples/s | 55.6 steps/s
[Step=10150 Epoch=96.9] | Loss=0.00139 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.841 | L2-Norm(final)=2.671 | 1610.8 samples/s | 25.2 steps/s
[Step=10200 Epoch=97.4] | Loss=0.00127 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.837 | L2-Norm(final)=2.671 | 3417.4 samples/s | 53.4 steps/s
[Step=10250 Epoch=97.9] | Loss=0.00118 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.834 | L2-Norm(final)=2.672 | 1645.5 samples/s | 25.7 steps/s
[Step=10300 Epoch=98.4] | Loss=0.00110 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.831 | L2-Norm(final)=2.673 | 3374.3 samples/s | 52.7 steps/s
[Step=10350 Epoch=98.8] | Loss=0.00102 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.828 | L2-Norm(final)=2.673 | 1650.5 samples/s | 25.8 steps/s
[Step=10400 Epoch=99.3] | Loss=0.00096 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.826 | L2-Norm(final)=2.674 | 3356.3 samples/s | 52.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step10400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=90.5] | Loss=0.09947 | Reg=0.00357 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.903 | L2-Norm(final)=2.663 | 3448.4 samples/s | 53.9 steps/s
[Step=9650 Epoch=90.9] | Loss=0.00981 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.861 | L2-Norm(final)=2.647 | 3304.5 samples/s | 51.6 steps/s
[Step=9700 Epoch=91.4] | Loss=0.00572 | Reg=0.00356 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=18.855 | L2-Norm(final)=2.653 | 4177.0 samples/s | 65.3 steps/s
[Step=9750 Epoch=91.9] | Loss=0.00426 | Reg=0.00355 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.853 | L2-Norm(final)=2.660 | 1518.3 samples/s | 23.7 steps/s
[Step=9800 Epoch=92.3] | Loss=0.00329 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.850 | L2-Norm(final)=2.665 | 3937.2 samples/s | 61.5 steps/s
[Step=9850 Epoch=92.8] | Loss=0.00264 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.847 | L2-Norm(final)=2.669 | 1564.1 samples/s | 24.4 steps/s
[Step=9900 Epoch=93.3] | Loss=0.00221 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.843 | L2-Norm(final)=2.672 | 3699.9 samples/s | 57.8 steps/s
[Step=9950 Epoch=93.8] | Loss=0.00190 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.840 | L2-Norm(final)=2.674 | 1601.7 samples/s | 25.0 steps/s
[Step=10000 Epoch=94.2] | Loss=0.00167 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.837 | L2-Norm(final)=2.676 | 3461.2 samples/s | 54.1 steps/s
[Step=10050 Epoch=94.7] | Loss=0.00149 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.833 | L2-Norm(final)=2.677 | 1643.5 samples/s | 25.7 steps/s
[Step=10100 Epoch=95.2] | Loss=0.00134 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.830 | L2-Norm(final)=2.678 | 3331.9 samples/s | 52.1 steps/s
[Step=10150 Epoch=95.6] | Loss=0.00122 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.828 | L2-Norm(final)=2.679 | 1658.1 samples/s | 25.9 steps/s
[Step=10200 Epoch=96.1] | Loss=0.00112 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.825 | L2-Norm(final)=2.680 | 3349.8 samples/s | 52.3 steps/s
[Step=10250 Epoch=96.6] | Loss=0.00104 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.822 | L2-Norm(final)=2.681 | 1652.4 samples/s | 25.8 steps/s
[Step=10300 Epoch=97.1] | Loss=0.00097 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.820 | L2-Norm(final)=2.681 | 3399.0 samples/s | 53.1 steps/s
[Step=10350 Epoch=97.5] | Loss=0.00090 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.817 | L2-Norm(final)=2.682 | 1700.3 samples/s | 26.6 steps/s
[Step=10400 Epoch=98.0] | Loss=0.00085 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.815 | L2-Norm(final)=2.682 | 3188.5 samples/s | 49.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step10400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.5] | Loss=0.15526 | Reg=0.00357 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.903 | L2-Norm(final)=2.662 | 3503.9 samples/s | 54.7 steps/s
[Step=9650 Epoch=92.0] | Loss=0.01467 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.877 | L2-Norm(final)=2.647 | 3237.1 samples/s | 50.6 steps/s
[Step=9700 Epoch=92.4] | Loss=0.00828 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.883 | L2-Norm(final)=2.652 | 4237.0 samples/s | 66.2 steps/s
[Step=9750 Epoch=92.9] | Loss=0.00561 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.880 | L2-Norm(final)=2.655 | 1503.1 samples/s | 23.5 steps/s
[Step=9800 Epoch=93.4] | Loss=0.00422 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.876 | L2-Norm(final)=2.658 | 4010.7 samples/s | 62.7 steps/s
[Step=9850 Epoch=93.9] | Loss=0.00339 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.870 | L2-Norm(final)=2.660 | 1523.3 samples/s | 23.8 steps/s
[Step=9900 Epoch=94.4] | Loss=0.00283 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.865 | L2-Norm(final)=2.662 | 3827.7 samples/s | 59.8 steps/s
[Step=9950 Epoch=94.8] | Loss=0.00243 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.861 | L2-Norm(final)=2.663 | 1543.2 samples/s | 24.1 steps/s
[Step=10000 Epoch=95.3] | Loss=0.00213 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.856 | L2-Norm(final)=2.665 | 3693.8 samples/s | 57.7 steps/s
[Step=10050 Epoch=95.8] | Loss=0.00190 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.852 | L2-Norm(final)=2.666 | 1511.8 samples/s | 23.6 steps/s
[Step=10100 Epoch=96.3] | Loss=0.00171 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.848 | L2-Norm(final)=2.667 | 3515.9 samples/s | 54.9 steps/s
[Step=10150 Epoch=96.7] | Loss=0.00156 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.845 | L2-Norm(final)=2.668 | 1620.9 samples/s | 25.3 steps/s
[Step=10200 Epoch=97.2] | Loss=0.00143 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.841 | L2-Norm(final)=2.669 | 3372.4 samples/s | 52.7 steps/s
[Step=10250 Epoch=97.7] | Loss=0.00132 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.838 | L2-Norm(final)=2.670 | 1641.3 samples/s | 25.6 steps/s
[Step=10300 Epoch=98.2] | Loss=0.00123 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.835 | L2-Norm(final)=2.671 | 3387.0 samples/s | 52.9 steps/s
[Step=10350 Epoch=98.6] | Loss=0.00115 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.832 | L2-Norm(final)=2.671 | 1647.8 samples/s | 25.7 steps/s
[Step=10400 Epoch=99.1] | Loss=0.00108 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.829 | L2-Norm(final)=2.672 | 3379.3 samples/s | 52.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24294 | acc=0.8346 | tpr=0.7655 | fpr=0.0154 | 3701.6 samples/s | 14.5 steps/s
Avg test loss: 0.24346, Avg test acc: 0.83536, Avg tpr: 0.76837, Avg fpr: 0.01731, total FA: 135

Testing server on iccad2012
[Step=  50] | Loss=0.44309 | acc=0.7923 | tpr=0.9779 | fpr=0.2111 | 3619.2 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.44699 | acc=0.7932 | tpr=0.9744 | fpr=0.2102 | 6930.4 samples/s | 27.1 steps/s
[Step= 150] | Loss=0.45325 | acc=0.7919 | tpr=0.9769 | fpr=0.2115 | 6912.3 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.45289 | acc=0.7927 | tpr=0.9781 | fpr=0.2107 | 6949.5 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.45299 | acc=0.7934 | tpr=0.9790 | fpr=0.2100 | 6797.8 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.45133 | acc=0.7942 | tpr=0.9738 | fpr=0.2091 | 6906.2 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.45222 | acc=0.7944 | tpr=0.9724 | fpr=0.2089 | 6751.4 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.45242 | acc=0.7942 | tpr=0.9710 | fpr=0.2090 | 6902.7 samples/s | 27.0 steps/s
[Step= 450] | Loss=0.45580 | acc=0.7932 | tpr=0.9703 | fpr=0.2100 | 6590.4 samples/s | 25.7 steps/s
[Step= 500] | Loss=0.45745 | acc=0.7923 | tpr=0.9709 | fpr=0.2110 | 6952.1 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.45685 | acc=0.7928 | tpr=0.9706 | fpr=0.2104 | 12047.3 samples/s | 47.1 steps/s
Avg test loss: 0.45679, Avg test acc: 0.79276, Avg tpr: 0.97068, Avg fpr: 0.21047, total FA: 29224

server round 13/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.7] | Loss=0.12679 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.820 | L2-Norm(final)=2.696 | 3627.2 samples/s | 56.7 steps/s
[Step=10450 Epoch=51.0] | Loss=0.03828 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.806 | L2-Norm(final)=2.679 | 3402.6 samples/s | 53.2 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03098 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.803 | L2-Norm(final)=2.677 | 3508.6 samples/s | 54.8 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02946 | Reg=0.00353 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.801 | L2-Norm(final)=2.673 | 3473.4 samples/s | 54.3 steps/s
[Step=10600 Epoch=51.7] | Loss=0.02839 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.802 | L2-Norm(final)=2.671 | 4348.3 samples/s | 67.9 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02537 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.803 | L2-Norm(final)=2.672 | 1563.5 samples/s | 24.4 steps/s
[Step=10700 Epoch=52.2] | Loss=0.02314 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.805 | L2-Norm(final)=2.675 | 3492.5 samples/s | 54.6 steps/s
[Step=10750 Epoch=52.4] | Loss=0.02123 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.807 | L2-Norm(final)=2.679 | 3490.7 samples/s | 54.5 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01978 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.809 | L2-Norm(final)=2.683 | 4143.9 samples/s | 64.7 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01877 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.812 | L2-Norm(final)=2.688 | 1576.7 samples/s | 24.6 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01760 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.814 | L2-Norm(final)=2.692 | 3501.1 samples/s | 54.7 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01702 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.816 | L2-Norm(final)=2.696 | 3490.7 samples/s | 54.5 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01654 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.817 | L2-Norm(final)=2.699 | 3922.3 samples/s | 61.3 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01599 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.819 | L2-Norm(final)=2.702 | 1618.8 samples/s | 25.3 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01547 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.821 | L2-Norm(final)=2.705 | 3522.9 samples/s | 55.0 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01485 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.822 | L2-Norm(final)=2.709 | 3520.6 samples/s | 55.0 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01443 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.824 | L2-Norm(final)=2.712 | 3746.0 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step11200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.8] | Loss=0.18018 | Reg=0.00354 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.820 | L2-Norm(final)=2.695 | 3784.4 samples/s | 59.1 steps/s
[Step=10450 Epoch=51.0] | Loss=0.03845 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.806 | L2-Norm(final)=2.680 | 3268.7 samples/s | 51.1 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03139 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.803 | L2-Norm(final)=2.676 | 3486.4 samples/s | 54.5 steps/s
[Step=10550 Epoch=51.5] | Loss=0.02946 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.803 | L2-Norm(final)=2.674 | 3496.2 samples/s | 54.6 steps/s
[Step=10600 Epoch=51.7] | Loss=0.02745 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=18.803 | L2-Norm(final)=2.672 | 4352.4 samples/s | 68.0 steps/s
[Step=10650 Epoch=52.0] | Loss=0.02444 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=18.804 | L2-Norm(final)=2.672 | 1559.6 samples/s | 24.4 steps/s
[Step=10700 Epoch=52.2] | Loss=0.02188 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.806 | L2-Norm(final)=2.675 | 3489.9 samples/s | 54.5 steps/s
[Step=10750 Epoch=52.5] | Loss=0.02047 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.808 | L2-Norm(final)=2.678 | 3491.8 samples/s | 54.6 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01949 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.809 | L2-Norm(final)=2.681 | 4176.8 samples/s | 65.3 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01850 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.810 | L2-Norm(final)=2.683 | 1580.1 samples/s | 24.7 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01751 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.811 | L2-Norm(final)=2.685 | 3495.1 samples/s | 54.6 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01678 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.812 | L2-Norm(final)=2.687 | 3487.1 samples/s | 54.5 steps/s
[Step=11000 Epoch=53.7] | Loss=0.01608 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.812 | L2-Norm(final)=2.689 | 3987.0 samples/s | 62.3 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01549 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.813 | L2-Norm(final)=2.691 | 1617.0 samples/s | 25.3 steps/s
[Step=11100 Epoch=54.2] | Loss=0.01500 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.814 | L2-Norm(final)=2.693 | 3508.2 samples/s | 54.8 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01456 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.815 | L2-Norm(final)=2.695 | 3524.7 samples/s | 55.1 steps/s
[Step=11200 Epoch=54.7] | Loss=0.01427 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.816 | L2-Norm(final)=2.697 | 3842.4 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step11200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.7] | Loss=0.14706 | Reg=0.00354 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.820 | L2-Norm(final)=2.695 | 3921.7 samples/s | 61.3 steps/s
[Step=10450 Epoch=50.9] | Loss=0.03838 | Reg=0.00353 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.799 | L2-Norm(final)=2.678 | 3181.6 samples/s | 49.7 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03398 | Reg=0.00353 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.796 | L2-Norm(final)=2.672 | 3511.9 samples/s | 54.9 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02927 | Reg=0.00353 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.795 | L2-Norm(final)=2.673 | 3512.0 samples/s | 54.9 steps/s
[Step=10600 Epoch=51.6] | Loss=0.02679 | Reg=0.00353 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.797 | L2-Norm(final)=2.676 | 4351.3 samples/s | 68.0 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02382 | Reg=0.00353 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.800 | L2-Norm(final)=2.679 | 1566.6 samples/s | 24.5 steps/s
[Step=10700 Epoch=52.1] | Loss=0.02257 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.802 | L2-Norm(final)=2.681 | 3496.7 samples/s | 54.6 steps/s
[Step=10750 Epoch=52.4] | Loss=0.02033 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.805 | L2-Norm(final)=2.685 | 3496.3 samples/s | 54.6 steps/s
[Step=10800 Epoch=52.6] | Loss=0.01952 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.808 | L2-Norm(final)=2.690 | 4048.5 samples/s | 63.3 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01821 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.810 | L2-Norm(final)=2.693 | 1595.4 samples/s | 24.9 steps/s
[Step=10900 Epoch=53.1] | Loss=0.01724 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.812 | L2-Norm(final)=2.697 | 3507.1 samples/s | 54.8 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01667 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.814 | L2-Norm(final)=2.701 | 3500.1 samples/s | 54.7 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01627 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.815 | L2-Norm(final)=2.703 | 3917.7 samples/s | 61.2 steps/s
[Step=11050 Epoch=53.8] | Loss=0.01560 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.817 | L2-Norm(final)=2.706 | 1615.0 samples/s | 25.2 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01509 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.819 | L2-Norm(final)=2.708 | 3527.7 samples/s | 55.1 steps/s
[Step=11150 Epoch=54.3] | Loss=0.01519 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.820 | L2-Norm(final)=2.710 | 3543.1 samples/s | 55.4 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01505 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.821 | L2-Norm(final)=2.711 | 3768.5 samples/s | 58.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step11200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.7] | Loss=0.13801 | Reg=0.00354 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.820 | L2-Norm(final)=2.695 | 3564.8 samples/s | 55.7 steps/s
[Step=10450 Epoch=51.0] | Loss=0.04506 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.813 | L2-Norm(final)=2.671 | 3444.9 samples/s | 53.8 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03779 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.811 | L2-Norm(final)=2.666 | 3518.1 samples/s | 55.0 steps/s
[Step=10550 Epoch=51.4] | Loss=0.03246 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.810 | L2-Norm(final)=2.664 | 3515.9 samples/s | 54.9 steps/s
[Step=10600 Epoch=51.7] | Loss=0.02901 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.810 | L2-Norm(final)=2.666 | 4354.0 samples/s | 68.0 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02593 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.810 | L2-Norm(final)=2.667 | 1568.8 samples/s | 24.5 steps/s
[Step=10700 Epoch=52.2] | Loss=0.02365 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.811 | L2-Norm(final)=2.669 | 3482.8 samples/s | 54.4 steps/s
[Step=10750 Epoch=52.4] | Loss=0.02183 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.812 | L2-Norm(final)=2.672 | 3503.5 samples/s | 54.7 steps/s
[Step=10800 Epoch=52.7] | Loss=0.02068 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.814 | L2-Norm(final)=2.674 | 4125.6 samples/s | 64.5 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01920 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.814 | L2-Norm(final)=2.677 | 1580.3 samples/s | 24.7 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01813 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.816 | L2-Norm(final)=2.681 | 3516.2 samples/s | 54.9 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01743 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=18.817 | L2-Norm(final)=2.684 | 3522.8 samples/s | 55.0 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01663 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.818 | L2-Norm(final)=2.688 | 3945.6 samples/s | 61.7 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01590 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.820 | L2-Norm(final)=2.691 | 1633.5 samples/s | 25.5 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01514 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.821 | L2-Norm(final)=2.694 | 3493.5 samples/s | 54.6 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01487 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.822 | L2-Norm(final)=2.697 | 3513.4 samples/s | 54.9 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01476 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.822 | L2-Norm(final)=2.699 | 3752.8 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step11200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=51.0] | Loss=0.16496 | Reg=0.00354 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.820 | L2-Norm(final)=2.695 | 3623.7 samples/s | 56.6 steps/s
[Step=10450 Epoch=51.2] | Loss=0.04121 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.813 | L2-Norm(final)=2.673 | 3405.0 samples/s | 53.2 steps/s
[Step=10500 Epoch=51.5] | Loss=0.03211 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.811 | L2-Norm(final)=2.671 | 3513.8 samples/s | 54.9 steps/s
[Step=10550 Epoch=51.7] | Loss=0.02909 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.811 | L2-Norm(final)=2.673 | 3502.5 samples/s | 54.7 steps/s
[Step=10600 Epoch=52.0] | Loss=0.02843 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.813 | L2-Norm(final)=2.672 | 4397.4 samples/s | 68.7 steps/s
[Step=10650 Epoch=52.2] | Loss=0.02529 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.815 | L2-Norm(final)=2.672 | 1548.7 samples/s | 24.2 steps/s
[Step=10700 Epoch=52.5] | Loss=0.02284 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.817 | L2-Norm(final)=2.675 | 3511.2 samples/s | 54.9 steps/s
[Step=10750 Epoch=52.7] | Loss=0.02132 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.819 | L2-Norm(final)=2.678 | 3517.4 samples/s | 55.0 steps/s
[Step=10800 Epoch=53.0] | Loss=0.02068 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.821 | L2-Norm(final)=2.681 | 4246.9 samples/s | 66.4 steps/s
[Step=10850 Epoch=53.2] | Loss=0.01939 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.822 | L2-Norm(final)=2.683 | 1579.2 samples/s | 24.7 steps/s
[Step=10900 Epoch=53.5] | Loss=0.01860 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.824 | L2-Norm(final)=2.686 | 3513.5 samples/s | 54.9 steps/s
[Step=10950 Epoch=53.7] | Loss=0.01776 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.825 | L2-Norm(final)=2.688 | 3517.4 samples/s | 55.0 steps/s
[Step=11000 Epoch=53.9] | Loss=0.01735 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.826 | L2-Norm(final)=2.690 | 4111.6 samples/s | 64.2 steps/s
[Step=11050 Epoch=54.2] | Loss=0.01645 | Reg=0.00354 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.827 | L2-Norm(final)=2.692 | 1576.5 samples/s | 24.6 steps/s
[Step=11100 Epoch=54.4] | Loss=0.01573 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.828 | L2-Norm(final)=2.695 | 3517.5 samples/s | 55.0 steps/s
[Step=11150 Epoch=54.7] | Loss=0.01533 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.829 | L2-Norm(final)=2.697 | 3501.0 samples/s | 54.7 steps/s
[Step=11200 Epoch=54.9] | Loss=0.01502 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.829 | L2-Norm(final)=2.699 | 3984.1 samples/s | 62.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step11200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=98.6] | Loss=0.09820 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.820 | L2-Norm(final)=2.696 | 3726.9 samples/s | 58.2 steps/s
[Step=10450 Epoch=99.0] | Loss=0.01248 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.817 | L2-Norm(final)=2.683 | 3116.1 samples/s | 48.7 steps/s
[Step=10500 Epoch=99.5] | Loss=0.00717 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.816 | L2-Norm(final)=2.681 | 4212.9 samples/s | 65.8 steps/s
[Step=10550 Epoch=100.0] | Loss=0.00481 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.810 | L2-Norm(final)=2.684 | 1513.2 samples/s | 23.6 steps/s
[Step=10600 Epoch=100.4] | Loss=0.00362 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.803 | L2-Norm(final)=2.687 | 3988.4 samples/s | 62.3 steps/s
[Step=10650 Epoch=100.9] | Loss=0.00290 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.797 | L2-Norm(final)=2.689 | 1541.4 samples/s | 24.1 steps/s
[Step=10700 Epoch=101.4] | Loss=0.00242 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.791 | L2-Norm(final)=2.691 | 3784.4 samples/s | 59.1 steps/s
[Step=10750 Epoch=101.9] | Loss=0.00208 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.786 | L2-Norm(final)=2.693 | 1592.8 samples/s | 24.9 steps/s
[Step=10800 Epoch=102.3] | Loss=0.00182 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.781 | L2-Norm(final)=2.694 | 3587.0 samples/s | 56.0 steps/s
[Step=10850 Epoch=102.8] | Loss=0.00163 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.776 | L2-Norm(final)=2.695 | 1606.0 samples/s | 25.1 steps/s
[Step=10900 Epoch=103.3] | Loss=0.00147 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.772 | L2-Norm(final)=2.696 | 3360.3 samples/s | 52.5 steps/s
[Step=10950 Epoch=103.8] | Loss=0.00134 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.768 | L2-Norm(final)=2.697 | 1547.6 samples/s | 24.2 steps/s
[Step=11000 Epoch=104.2] | Loss=0.00123 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.764 | L2-Norm(final)=2.698 | 3056.3 samples/s | 47.8 steps/s
[Step=11050 Epoch=104.7] | Loss=0.00113 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.760 | L2-Norm(final)=2.699 | 1591.3 samples/s | 24.9 steps/s
[Step=11100 Epoch=105.2] | Loss=0.00105 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.757 | L2-Norm(final)=2.700 | 3219.4 samples/s | 50.3 steps/s
[Step=11150 Epoch=105.7] | Loss=0.00099 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.754 | L2-Norm(final)=2.701 | 1603.4 samples/s | 25.1 steps/s
[Step=11200 Epoch=106.1] | Loss=0.00093 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.751 | L2-Norm(final)=2.702 | 3363.1 samples/s | 52.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step11200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=98.9] | Loss=0.20211 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.820 | L2-Norm(final)=2.697 | 3464.9 samples/s | 54.1 steps/s
[Step=10450 Epoch=99.4] | Loss=0.01489 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.813 | L2-Norm(final)=2.687 | 3295.0 samples/s | 51.5 steps/s
[Step=10500 Epoch=99.9] | Loss=0.00920 | Reg=0.00354 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=18.811 | L2-Norm(final)=2.684 | 4228.5 samples/s | 66.1 steps/s
[Step=10550 Epoch=100.4] | Loss=0.00626 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.807 | L2-Norm(final)=2.686 | 1510.8 samples/s | 23.6 steps/s
[Step=10600 Epoch=100.8] | Loss=0.00471 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.801 | L2-Norm(final)=2.687 | 3964.2 samples/s | 61.9 steps/s
[Step=10650 Epoch=101.3] | Loss=0.00378 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.795 | L2-Norm(final)=2.689 | 1542.0 samples/s | 24.1 steps/s
[Step=10700 Epoch=101.8] | Loss=0.00316 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.789 | L2-Norm(final)=2.690 | 3784.2 samples/s | 59.1 steps/s
[Step=10750 Epoch=102.3] | Loss=0.00271 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.784 | L2-Norm(final)=2.692 | 1589.5 samples/s | 24.8 steps/s
[Step=10800 Epoch=102.7] | Loss=0.00237 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.780 | L2-Norm(final)=2.693 | 3598.6 samples/s | 56.2 steps/s
[Step=10850 Epoch=103.2] | Loss=0.00211 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.775 | L2-Norm(final)=2.694 | 1627.9 samples/s | 25.4 steps/s
[Step=10900 Epoch=103.7] | Loss=0.00190 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.771 | L2-Norm(final)=2.695 | 3402.1 samples/s | 53.2 steps/s
[Step=10950 Epoch=104.2] | Loss=0.00173 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.767 | L2-Norm(final)=2.696 | 1642.1 samples/s | 25.7 steps/s
[Step=11000 Epoch=104.6] | Loss=0.00159 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.764 | L2-Norm(final)=2.697 | 3359.5 samples/s | 52.5 steps/s
[Step=11050 Epoch=105.1] | Loss=0.00147 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.761 | L2-Norm(final)=2.697 | 1673.4 samples/s | 26.1 steps/s
[Step=11100 Epoch=105.6] | Loss=0.00137 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.757 | L2-Norm(final)=2.698 | 3399.0 samples/s | 53.1 steps/s
[Step=11150 Epoch=106.1] | Loss=0.00128 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.755 | L2-Norm(final)=2.699 | 1677.6 samples/s | 26.2 steps/s
[Step=11200 Epoch=106.5] | Loss=0.00120 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.752 | L2-Norm(final)=2.700 | 3328.8 samples/s | 52.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step11200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=99.3] | Loss=0.08251 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.820 | L2-Norm(final)=2.696 | 3834.6 samples/s | 59.9 steps/s
[Step=10450 Epoch=99.8] | Loss=0.01057 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.790 | L2-Norm(final)=2.687 | 3053.9 samples/s | 47.7 steps/s
[Step=10500 Epoch=100.3] | Loss=0.00590 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.791 | L2-Norm(final)=2.695 | 4258.3 samples/s | 66.5 steps/s
[Step=10550 Epoch=100.7] | Loss=0.00396 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.789 | L2-Norm(final)=2.702 | 1517.6 samples/s | 23.7 steps/s
[Step=10600 Epoch=101.2] | Loss=0.00298 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.784 | L2-Norm(final)=2.705 | 4024.3 samples/s | 62.9 steps/s
[Step=10650 Epoch=101.7] | Loss=0.00239 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.779 | L2-Norm(final)=2.707 | 1522.1 samples/s | 23.8 steps/s
[Step=10700 Epoch=102.2] | Loss=0.00199 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.774 | L2-Norm(final)=2.709 | 3859.3 samples/s | 60.3 steps/s
[Step=10750 Epoch=102.7] | Loss=0.00171 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.770 | L2-Norm(final)=2.710 | 1554.4 samples/s | 24.3 steps/s
[Step=10800 Epoch=103.1] | Loss=0.00150 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.765 | L2-Norm(final)=2.710 | 3672.5 samples/s | 57.4 steps/s
[Step=10850 Epoch=103.6] | Loss=0.00134 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.761 | L2-Norm(final)=2.711 | 1579.9 samples/s | 24.7 steps/s
[Step=10900 Epoch=104.1] | Loss=0.00120 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.758 | L2-Norm(final)=2.711 | 3554.2 samples/s | 55.5 steps/s
[Step=10950 Epoch=104.6] | Loss=0.00110 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.754 | L2-Norm(final)=2.712 | 1622.9 samples/s | 25.4 steps/s
[Step=11000 Epoch=105.0] | Loss=0.00101 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.751 | L2-Norm(final)=2.712 | 3411.0 samples/s | 53.3 steps/s
[Step=11050 Epoch=105.5] | Loss=0.00093 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.748 | L2-Norm(final)=2.713 | 1635.6 samples/s | 25.6 steps/s
[Step=11100 Epoch=106.0] | Loss=0.00087 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.745 | L2-Norm(final)=2.713 | 3397.8 samples/s | 53.1 steps/s
[Step=11150 Epoch=106.5] | Loss=0.00081 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.742 | L2-Norm(final)=2.713 | 1661.6 samples/s | 26.0 steps/s
[Step=11200 Epoch=107.0] | Loss=0.00076 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.739 | L2-Norm(final)=2.713 | 3409.9 samples/s | 53.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step11200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=98.0] | Loss=0.19902 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.820 | L2-Norm(final)=2.696 | 3449.1 samples/s | 53.9 steps/s
[Step=10450 Epoch=98.5] | Loss=0.01073 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.797 | L2-Norm(final)=2.692 | 3312.1 samples/s | 51.8 steps/s
[Step=10500 Epoch=98.9] | Loss=0.00569 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.790 | L2-Norm(final)=2.698 | 4203.1 samples/s | 65.7 steps/s
[Step=10550 Epoch=99.4] | Loss=0.00386 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.784 | L2-Norm(final)=2.703 | 1513.3 samples/s | 23.6 steps/s
[Step=10600 Epoch=99.9] | Loss=0.00291 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.778 | L2-Norm(final)=2.706 | 3920.8 samples/s | 61.3 steps/s
[Step=10650 Epoch=100.4] | Loss=0.00234 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.773 | L2-Norm(final)=2.708 | 1561.8 samples/s | 24.4 steps/s
[Step=10700 Epoch=100.8] | Loss=0.00195 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.768 | L2-Norm(final)=2.709 | 3666.2 samples/s | 57.3 steps/s
[Step=10750 Epoch=101.3] | Loss=0.00168 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.764 | L2-Norm(final)=2.711 | 1581.8 samples/s | 24.7 steps/s
[Step=10800 Epoch=101.8] | Loss=0.00147 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.760 | L2-Norm(final)=2.711 | 3498.3 samples/s | 54.7 steps/s
[Step=10850 Epoch=102.2] | Loss=0.00131 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.756 | L2-Norm(final)=2.712 | 1643.4 samples/s | 25.7 steps/s
[Step=10900 Epoch=102.7] | Loss=0.00119 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.753 | L2-Norm(final)=2.713 | 3381.6 samples/s | 52.8 steps/s
[Step=10950 Epoch=103.2] | Loss=0.00108 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.749 | L2-Norm(final)=2.713 | 1669.9 samples/s | 26.1 steps/s
[Step=11000 Epoch=103.7] | Loss=0.00099 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.746 | L2-Norm(final)=2.714 | 3357.2 samples/s | 52.5 steps/s
[Step=11050 Epoch=104.1] | Loss=0.00092 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.743 | L2-Norm(final)=2.714 | 1678.5 samples/s | 26.2 steps/s
[Step=11100 Epoch=104.6] | Loss=0.00086 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.741 | L2-Norm(final)=2.715 | 3324.8 samples/s | 52.0 steps/s
[Step=11150 Epoch=105.1] | Loss=0.00080 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.738 | L2-Norm(final)=2.715 | 1713.3 samples/s | 26.8 steps/s
[Step=11200 Epoch=105.5] | Loss=0.00075 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.736 | L2-Norm(final)=2.716 | 3200.0 samples/s | 50.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step11200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=99.1] | Loss=0.10212 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.820 | L2-Norm(final)=2.697 | 3434.7 samples/s | 53.7 steps/s
[Step=10450 Epoch=99.6] | Loss=0.00899 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.810 | L2-Norm(final)=2.700 | 3340.8 samples/s | 52.2 steps/s
[Step=10500 Epoch=100.1] | Loss=0.00540 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.808 | L2-Norm(final)=2.705 | 4235.1 samples/s | 66.2 steps/s
[Step=10550 Epoch=100.6] | Loss=0.00402 | Reg=0.00354 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.804 | L2-Norm(final)=2.706 | 1509.8 samples/s | 23.6 steps/s
[Step=10600 Epoch=101.0] | Loss=0.00306 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.800 | L2-Norm(final)=2.707 | 4027.6 samples/s | 62.9 steps/s
[Step=10650 Epoch=101.5] | Loss=0.00245 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.795 | L2-Norm(final)=2.709 | 1534.7 samples/s | 24.0 steps/s
[Step=10700 Epoch=102.0] | Loss=0.00205 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.791 | L2-Norm(final)=2.710 | 3863.2 samples/s | 60.4 steps/s
[Step=10750 Epoch=102.5] | Loss=0.00176 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.786 | L2-Norm(final)=2.711 | 1569.4 samples/s | 24.5 steps/s
[Step=10800 Epoch=102.9] | Loss=0.00154 | Reg=0.00353 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.782 | L2-Norm(final)=2.711 | 3703.4 samples/s | 57.9 steps/s
[Step=10850 Epoch=103.4] | Loss=0.00137 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.778 | L2-Norm(final)=2.712 | 1595.9 samples/s | 24.9 steps/s
[Step=10900 Epoch=103.9] | Loss=0.00124 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.774 | L2-Norm(final)=2.712 | 3557.1 samples/s | 55.6 steps/s
[Step=10950 Epoch=104.4] | Loss=0.00113 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.770 | L2-Norm(final)=2.712 | 1629.3 samples/s | 25.5 steps/s
[Step=11000 Epoch=104.8] | Loss=0.00103 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.766 | L2-Norm(final)=2.713 | 3408.2 samples/s | 53.3 steps/s
[Step=11050 Epoch=105.3] | Loss=0.00096 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.763 | L2-Norm(final)=2.713 | 1636.6 samples/s | 25.6 steps/s
[Step=11100 Epoch=105.8] | Loss=0.00089 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.760 | L2-Norm(final)=2.713 | 3365.9 samples/s | 52.6 steps/s
[Step=11150 Epoch=106.3] | Loss=0.00083 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.757 | L2-Norm(final)=2.713 | 1649.3 samples/s | 25.8 steps/s
[Step=11200 Epoch=106.7] | Loss=0.00078 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.754 | L2-Norm(final)=2.714 | 3397.1 samples/s | 53.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29409 | acc=0.7991 | tpr=0.7134 | fpr=0.0149 | 3568.5 samples/s | 13.9 steps/s
Avg test loss: 0.29518, Avg test acc: 0.80014, Avg tpr: 0.71598, Avg fpr: 0.01474, total FA: 115

Testing server on iccad2012
[Step=  50] | Loss=0.36428 | acc=0.8305 | tpr=0.9779 | fpr=0.1721 | 3628.0 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.36751 | acc=0.8319 | tpr=0.9765 | fpr=0.1708 | 6948.2 samples/s | 27.1 steps/s
[Step= 150] | Loss=0.37328 | acc=0.8301 | tpr=0.9784 | fpr=0.1726 | 6956.2 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.37338 | acc=0.8300 | tpr=0.9781 | fpr=0.1727 | 6836.1 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.37374 | acc=0.8302 | tpr=0.9790 | fpr=0.1725 | 6858.8 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.37271 | acc=0.8308 | tpr=0.9731 | fpr=0.1718 | 6772.9 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.37371 | acc=0.8308 | tpr=0.9724 | fpr=0.1718 | 6855.9 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.37415 | acc=0.8306 | tpr=0.9710 | fpr=0.1720 | 6713.8 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.37712 | acc=0.8297 | tpr=0.9703 | fpr=0.1728 | 6806.1 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.37835 | acc=0.8291 | tpr=0.9714 | fpr=0.1735 | 6800.7 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.37789 | acc=0.8295 | tpr=0.9713 | fpr=0.1731 | 12298.0 samples/s | 48.0 steps/s
Avg test loss: 0.37780, Avg test acc: 0.82942, Avg tpr: 0.97147, Avg fpr: 0.17316, total FA: 24043

server round 14/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.6] | Loss=0.12187 | Reg=0.00351 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.737 | L2-Norm(final)=2.723 | 3785.9 samples/s | 59.2 steps/s
[Step=11250 Epoch=54.9] | Loss=0.03988 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.731 | L2-Norm(final)=2.699 | 3243.8 samples/s | 50.7 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03268 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.727 | L2-Norm(final)=2.694 | 3513.4 samples/s | 54.9 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02948 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.726 | L2-Norm(final)=2.696 | 3512.2 samples/s | 54.9 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02817 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.726 | L2-Norm(final)=2.696 | 4360.9 samples/s | 68.1 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02513 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.727 | L2-Norm(final)=2.698 | 1560.4 samples/s | 24.4 steps/s
[Step=11500 Epoch=56.1] | Loss=0.02256 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.729 | L2-Norm(final)=2.701 | 3525.0 samples/s | 55.1 steps/s
[Step=11550 Epoch=56.3] | Loss=0.02131 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.730 | L2-Norm(final)=2.704 | 3512.1 samples/s | 54.9 steps/s
[Step=11600 Epoch=56.6] | Loss=0.02002 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.731 | L2-Norm(final)=2.708 | 4144.6 samples/s | 64.8 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01848 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.732 | L2-Norm(final)=2.711 | 1589.9 samples/s | 24.8 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01765 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.733 | L2-Norm(final)=2.715 | 3516.7 samples/s | 54.9 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01691 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.734 | L2-Norm(final)=2.718 | 3525.1 samples/s | 55.1 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01664 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.736 | L2-Norm(final)=2.721 | 3947.7 samples/s | 61.7 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01590 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.737 | L2-Norm(final)=2.724 | 1627.6 samples/s | 25.4 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01555 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.739 | L2-Norm(final)=2.727 | 3517.8 samples/s | 55.0 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01513 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.740 | L2-Norm(final)=2.729 | 3521.7 samples/s | 55.0 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01488 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.742 | L2-Norm(final)=2.731 | 3722.2 samples/s | 58.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.7] | Loss=0.26528 | Reg=0.00351 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.737 | L2-Norm(final)=2.722 | 3740.2 samples/s | 58.4 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04085 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.724 | L2-Norm(final)=2.697 | 3322.9 samples/s | 51.9 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03229 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.723 | L2-Norm(final)=2.694 | 3502.0 samples/s | 54.7 steps/s
[Step=11350 Epoch=55.4] | Loss=0.02903 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.724 | L2-Norm(final)=2.696 | 3512.1 samples/s | 54.9 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02732 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.725 | L2-Norm(final)=2.696 | 4374.4 samples/s | 68.3 steps/s
[Step=11450 Epoch=55.9] | Loss=0.02382 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.727 | L2-Norm(final)=2.697 | 1571.6 samples/s | 24.6 steps/s
[Step=11500 Epoch=56.1] | Loss=0.02135 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.729 | L2-Norm(final)=2.701 | 3525.0 samples/s | 55.1 steps/s
[Step=11550 Epoch=56.4] | Loss=0.02026 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.731 | L2-Norm(final)=2.704 | 3521.4 samples/s | 55.0 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01939 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.732 | L2-Norm(final)=2.706 | 4164.9 samples/s | 65.1 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01816 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.734 | L2-Norm(final)=2.709 | 1594.6 samples/s | 24.9 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01716 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.735 | L2-Norm(final)=2.711 | 3530.2 samples/s | 55.2 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01639 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.737 | L2-Norm(final)=2.714 | 3531.3 samples/s | 55.2 steps/s
[Step=11800 Epoch=57.6] | Loss=0.01577 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.738 | L2-Norm(final)=2.717 | 4016.1 samples/s | 62.8 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01503 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.739 | L2-Norm(final)=2.720 | 1619.1 samples/s | 25.3 steps/s
[Step=11900 Epoch=58.1] | Loss=0.01442 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.740 | L2-Norm(final)=2.723 | 3511.7 samples/s | 54.9 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01431 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.741 | L2-Norm(final)=2.726 | 3485.6 samples/s | 54.5 steps/s
[Step=12000 Epoch=58.6] | Loss=0.01401 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.741 | L2-Norm(final)=2.727 | 3659.4 samples/s | 57.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step12000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.6] | Loss=0.16849 | Reg=0.00351 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.737 | L2-Norm(final)=2.723 | 3554.6 samples/s | 55.5 steps/s
[Step=11250 Epoch=54.8] | Loss=0.04257 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.731 | L2-Norm(final)=2.699 | 2878.8 samples/s | 45.0 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03367 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.726 | L2-Norm(final)=2.691 | 3170.7 samples/s | 49.5 steps/s
[Step=11350 Epoch=55.3] | Loss=0.03119 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.725 | L2-Norm(final)=2.689 | 3271.6 samples/s | 51.1 steps/s
[Step=11400 Epoch=55.5] | Loss=0.02829 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=18.726 | L2-Norm(final)=2.690 | 4182.5 samples/s | 65.4 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02517 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.727 | L2-Norm(final)=2.692 | 1534.6 samples/s | 24.0 steps/s
[Step=11500 Epoch=56.0] | Loss=0.02283 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.729 | L2-Norm(final)=2.695 | 3447.1 samples/s | 53.9 steps/s
[Step=11550 Epoch=56.3] | Loss=0.02126 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.730 | L2-Norm(final)=2.698 | 3509.1 samples/s | 54.8 steps/s
[Step=11600 Epoch=56.5] | Loss=0.02025 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.731 | L2-Norm(final)=2.701 | 4117.2 samples/s | 64.3 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01900 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.733 | L2-Norm(final)=2.705 | 1578.2 samples/s | 24.7 steps/s
[Step=11700 Epoch=57.0] | Loss=0.01801 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.734 | L2-Norm(final)=2.708 | 3473.9 samples/s | 54.3 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01715 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.734 | L2-Norm(final)=2.711 | 3504.1 samples/s | 54.8 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01683 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.735 | L2-Norm(final)=2.714 | 3928.6 samples/s | 61.4 steps/s
[Step=11850 Epoch=57.7] | Loss=0.01621 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.736 | L2-Norm(final)=2.716 | 1597.3 samples/s | 25.0 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01559 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.737 | L2-Norm(final)=2.719 | 3474.5 samples/s | 54.3 steps/s
[Step=11950 Epoch=58.2] | Loss=0.01493 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.738 | L2-Norm(final)=2.722 | 3516.1 samples/s | 54.9 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01459 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.739 | L2-Norm(final)=2.725 | 3755.5 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step12000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.6] | Loss=0.18450 | Reg=0.00351 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.737 | L2-Norm(final)=2.722 | 3618.8 samples/s | 56.5 steps/s
[Step=11250 Epoch=54.9] | Loss=0.03810 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.718 | L2-Norm(final)=2.697 | 3432.2 samples/s | 53.6 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03257 | Reg=0.00350 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.712 | L2-Norm(final)=2.693 | 3492.1 samples/s | 54.6 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02772 | Reg=0.00350 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.712 | L2-Norm(final)=2.694 | 3491.5 samples/s | 54.6 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02586 | Reg=0.00350 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.714 | L2-Norm(final)=2.696 | 4355.7 samples/s | 68.1 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02322 | Reg=0.00350 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.717 | L2-Norm(final)=2.698 | 1561.1 samples/s | 24.4 steps/s
[Step=11500 Epoch=56.1] | Loss=0.02102 | Reg=0.00350 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.719 | L2-Norm(final)=2.701 | 3191.6 samples/s | 49.9 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01956 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.722 | L2-Norm(final)=2.705 | 3267.3 samples/s | 51.1 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01905 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.725 | L2-Norm(final)=2.709 | 3955.7 samples/s | 61.8 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01835 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.728 | L2-Norm(final)=2.712 | 1566.0 samples/s | 24.5 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01737 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.730 | L2-Norm(final)=2.714 | 3487.2 samples/s | 54.5 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01700 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.731 | L2-Norm(final)=2.716 | 3507.2 samples/s | 54.8 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01629 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.733 | L2-Norm(final)=2.718 | 3942.2 samples/s | 61.6 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01552 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.735 | L2-Norm(final)=2.721 | 1606.9 samples/s | 25.1 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01492 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.737 | L2-Norm(final)=2.724 | 3481.2 samples/s | 54.4 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01468 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.739 | L2-Norm(final)=2.727 | 3509.9 samples/s | 54.8 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01437 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.741 | L2-Norm(final)=2.730 | 3776.1 samples/s | 59.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step12000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.9] | Loss=0.22681 | Reg=0.00351 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.737 | L2-Norm(final)=2.722 | 3580.7 samples/s | 55.9 steps/s
[Step=11250 Epoch=55.2] | Loss=0.03834 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.737 | L2-Norm(final)=2.700 | 3469.3 samples/s | 54.2 steps/s
[Step=11300 Epoch=55.4] | Loss=0.03016 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.732 | L2-Norm(final)=2.700 | 3530.2 samples/s | 55.2 steps/s
[Step=11350 Epoch=55.7] | Loss=0.02889 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.733 | L2-Norm(final)=2.700 | 3514.8 samples/s | 54.9 steps/s
[Step=11400 Epoch=55.9] | Loss=0.02820 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.735 | L2-Norm(final)=2.698 | 4412.3 samples/s | 68.9 steps/s
[Step=11450 Epoch=56.1] | Loss=0.02540 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.737 | L2-Norm(final)=2.697 | 1543.3 samples/s | 24.1 steps/s
[Step=11500 Epoch=56.4] | Loss=0.02284 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=18.738 | L2-Norm(final)=2.699 | 3515.4 samples/s | 54.9 steps/s
[Step=11550 Epoch=56.6] | Loss=0.02113 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.740 | L2-Norm(final)=2.702 | 3507.5 samples/s | 54.8 steps/s
[Step=11600 Epoch=56.9] | Loss=0.02022 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.741 | L2-Norm(final)=2.705 | 4249.8 samples/s | 66.4 steps/s
[Step=11650 Epoch=57.1] | Loss=0.01915 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.743 | L2-Norm(final)=2.707 | 1578.0 samples/s | 24.7 steps/s
[Step=11700 Epoch=57.4] | Loss=0.01834 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.745 | L2-Norm(final)=2.710 | 3526.8 samples/s | 55.1 steps/s
[Step=11750 Epoch=57.6] | Loss=0.01740 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.747 | L2-Norm(final)=2.713 | 3513.4 samples/s | 54.9 steps/s
[Step=11800 Epoch=57.9] | Loss=0.01690 | Reg=0.00351 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.748 | L2-Norm(final)=2.715 | 4061.0 samples/s | 63.5 steps/s
[Step=11850 Epoch=58.1] | Loss=0.01605 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.749 | L2-Norm(final)=2.718 | 1600.0 samples/s | 25.0 steps/s
[Step=11900 Epoch=58.4] | Loss=0.01537 | Reg=0.00352 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.751 | L2-Norm(final)=2.721 | 3519.4 samples/s | 55.0 steps/s
[Step=11950 Epoch=58.6] | Loss=0.01506 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.752 | L2-Norm(final)=2.724 | 3539.1 samples/s | 55.3 steps/s
[Step=12000 Epoch=58.8] | Loss=0.01475 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.752 | L2-Norm(final)=2.725 | 3988.5 samples/s | 62.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=106.1] | Loss=0.11105 | Reg=0.00351 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.737 | L2-Norm(final)=2.723 | 3662.2 samples/s | 57.2 steps/s
[Step=11250 Epoch=106.6] | Loss=0.01170 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.714 | L2-Norm(final)=2.714 | 3147.4 samples/s | 49.2 steps/s
[Step=11300 Epoch=107.1] | Loss=0.00628 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.710 | L2-Norm(final)=2.718 | 4209.8 samples/s | 65.8 steps/s
[Step=11350 Epoch=107.6] | Loss=0.00421 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.704 | L2-Norm(final)=2.721 | 1521.9 samples/s | 23.8 steps/s
[Step=11400 Epoch=108.0] | Loss=0.00317 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.697 | L2-Norm(final)=2.724 | 3981.9 samples/s | 62.2 steps/s
[Step=11450 Epoch=108.5] | Loss=0.00254 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.692 | L2-Norm(final)=2.726 | 1545.0 samples/s | 24.1 steps/s
[Step=11500 Epoch=109.0] | Loss=0.00213 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.687 | L2-Norm(final)=2.727 | 3760.4 samples/s | 58.8 steps/s
[Step=11550 Epoch=109.4] | Loss=0.00182 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.682 | L2-Norm(final)=2.729 | 1582.3 samples/s | 24.7 steps/s
[Step=11600 Epoch=109.9] | Loss=0.00160 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.677 | L2-Norm(final)=2.729 | 3567.0 samples/s | 55.7 steps/s
[Step=11650 Epoch=110.4] | Loss=0.00143 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.673 | L2-Norm(final)=2.730 | 1616.2 samples/s | 25.3 steps/s
[Step=11700 Epoch=110.9] | Loss=0.00129 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.670 | L2-Norm(final)=2.731 | 3443.4 samples/s | 53.8 steps/s
[Step=11750 Epoch=111.3] | Loss=0.00117 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.666 | L2-Norm(final)=2.732 | 1639.6 samples/s | 25.6 steps/s
[Step=11800 Epoch=111.8] | Loss=0.00108 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.663 | L2-Norm(final)=2.732 | 3383.3 samples/s | 52.9 steps/s
[Step=11850 Epoch=112.3] | Loss=0.00100 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.660 | L2-Norm(final)=2.733 | 1694.2 samples/s | 26.5 steps/s
[Step=11900 Epoch=112.8] | Loss=0.00093 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.657 | L2-Norm(final)=2.733 | 3351.1 samples/s | 52.4 steps/s
[Step=11950 Epoch=113.2] | Loss=0.00087 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.654 | L2-Norm(final)=2.734 | 1666.1 samples/s | 26.0 steps/s
[Step=12000 Epoch=113.7] | Loss=0.00081 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.652 | L2-Norm(final)=2.734 | 3344.7 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step12000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=106.5] | Loss=0.06862 | Reg=0.00351 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.737 | L2-Norm(final)=2.724 | 3672.8 samples/s | 57.4 steps/s
[Step=11250 Epoch=107.0] | Loss=0.01451 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.728 | L2-Norm(final)=2.713 | 3173.5 samples/s | 49.6 steps/s
[Step=11300 Epoch=107.5] | Loss=0.00827 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.729 | L2-Norm(final)=2.713 | 4214.5 samples/s | 65.9 steps/s
[Step=11350 Epoch=108.0] | Loss=0.00567 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.724 | L2-Norm(final)=2.716 | 1521.8 samples/s | 23.8 steps/s
[Step=11400 Epoch=108.4] | Loss=0.00427 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.718 | L2-Norm(final)=2.719 | 3971.5 samples/s | 62.1 steps/s
[Step=11450 Epoch=108.9] | Loss=0.00343 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.712 | L2-Norm(final)=2.721 | 1552.9 samples/s | 24.3 steps/s
[Step=11500 Epoch=109.4] | Loss=0.00286 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.707 | L2-Norm(final)=2.722 | 3768.2 samples/s | 58.9 steps/s
[Step=11550 Epoch=109.9] | Loss=0.00246 | Reg=0.00350 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.702 | L2-Norm(final)=2.724 | 1591.0 samples/s | 24.9 steps/s
[Step=11600 Epoch=110.3] | Loss=0.00216 | Reg=0.00350 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.697 | L2-Norm(final)=2.725 | 3588.6 samples/s | 56.1 steps/s
[Step=11650 Epoch=110.8] | Loss=0.00192 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.693 | L2-Norm(final)=2.726 | 1620.0 samples/s | 25.3 steps/s
[Step=11700 Epoch=111.3] | Loss=0.00173 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.689 | L2-Norm(final)=2.727 | 3424.2 samples/s | 53.5 steps/s
[Step=11750 Epoch=111.8] | Loss=0.00157 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.685 | L2-Norm(final)=2.727 | 1647.7 samples/s | 25.7 steps/s
[Step=11800 Epoch=112.2] | Loss=0.00145 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.681 | L2-Norm(final)=2.728 | 3382.1 samples/s | 52.8 steps/s
[Step=11850 Epoch=112.7] | Loss=0.00134 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.678 | L2-Norm(final)=2.729 | 1664.3 samples/s | 26.0 steps/s
[Step=11900 Epoch=113.2] | Loss=0.00124 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.675 | L2-Norm(final)=2.729 | 3375.0 samples/s | 52.7 steps/s
[Step=11950 Epoch=113.7] | Loss=0.00116 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.672 | L2-Norm(final)=2.730 | 1687.3 samples/s | 26.4 steps/s
[Step=12000 Epoch=114.1] | Loss=0.00109 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.669 | L2-Norm(final)=2.731 | 3319.3 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step12000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=107.0] | Loss=0.09123 | Reg=0.00351 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.737 | L2-Norm(final)=2.723 | 3892.4 samples/s | 60.8 steps/s
[Step=11250 Epoch=107.4] | Loss=0.01153 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.715 | L2-Norm(final)=2.713 | 3081.1 samples/s | 48.1 steps/s
[Step=11300 Epoch=107.9] | Loss=0.00713 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.724 | L2-Norm(final)=2.706 | 4245.4 samples/s | 66.3 steps/s
[Step=11350 Epoch=108.4] | Loss=0.00521 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.724 | L2-Norm(final)=2.707 | 1512.2 samples/s | 23.6 steps/s
[Step=11400 Epoch=108.9] | Loss=0.00403 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.722 | L2-Norm(final)=2.709 | 4074.9 samples/s | 63.7 steps/s
[Step=11450 Epoch=109.3] | Loss=0.00326 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.720 | L2-Norm(final)=2.712 | 1546.2 samples/s | 24.2 steps/s
[Step=11500 Epoch=109.8] | Loss=0.00272 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.716 | L2-Norm(final)=2.714 | 3853.9 samples/s | 60.2 steps/s
[Step=11550 Epoch=110.3] | Loss=0.00233 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.712 | L2-Norm(final)=2.715 | 1574.9 samples/s | 24.6 steps/s
[Step=11600 Epoch=110.8] | Loss=0.00204 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.709 | L2-Norm(final)=2.717 | 3691.8 samples/s | 57.7 steps/s
[Step=11650 Epoch=111.3] | Loss=0.00182 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.705 | L2-Norm(final)=2.718 | 1601.8 samples/s | 25.0 steps/s
[Step=11700 Epoch=111.7] | Loss=0.00164 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.701 | L2-Norm(final)=2.719 | 3566.3 samples/s | 55.7 steps/s
[Step=11750 Epoch=112.2] | Loss=0.00149 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.697 | L2-Norm(final)=2.720 | 1635.5 samples/s | 25.6 steps/s
[Step=11800 Epoch=112.7] | Loss=0.00137 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.694 | L2-Norm(final)=2.721 | 3410.9 samples/s | 53.3 steps/s
[Step=11850 Epoch=113.2] | Loss=0.00126 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.690 | L2-Norm(final)=2.722 | 1653.4 samples/s | 25.8 steps/s
[Step=11900 Epoch=113.6] | Loss=0.00118 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.687 | L2-Norm(final)=2.723 | 3376.3 samples/s | 52.8 steps/s
[Step=11950 Epoch=114.1] | Loss=0.00110 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.684 | L2-Norm(final)=2.724 | 1666.7 samples/s | 26.0 steps/s
[Step=12000 Epoch=114.6] | Loss=0.00103 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.681 | L2-Norm(final)=2.725 | 3407.2 samples/s | 53.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step12000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=105.5] | Loss=0.14906 | Reg=0.00351 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.737 | L2-Norm(final)=2.724 | 3490.9 samples/s | 54.5 steps/s
[Step=11250 Epoch=106.0] | Loss=0.01663 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.724 | L2-Norm(final)=2.696 | 3285.8 samples/s | 51.3 steps/s
[Step=11300 Epoch=106.5] | Loss=0.00885 | Reg=0.00351 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.728 | L2-Norm(final)=2.700 | 4193.6 samples/s | 65.5 steps/s
[Step=11350 Epoch=106.9] | Loss=0.00593 | Reg=0.00351 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.725 | L2-Norm(final)=2.704 | 1487.1 samples/s | 23.2 steps/s
[Step=11400 Epoch=107.4] | Loss=0.00446 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.721 | L2-Norm(final)=2.708 | 3863.8 samples/s | 60.4 steps/s
[Step=11450 Epoch=107.9] | Loss=0.00358 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.716 | L2-Norm(final)=2.710 | 1562.8 samples/s | 24.4 steps/s
[Step=11500 Epoch=108.4] | Loss=0.00299 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.711 | L2-Norm(final)=2.713 | 3675.1 samples/s | 57.4 steps/s
[Step=11550 Epoch=108.8] | Loss=0.00256 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.707 | L2-Norm(final)=2.715 | 1607.0 samples/s | 25.1 steps/s
[Step=11600 Epoch=109.3] | Loss=0.00225 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.702 | L2-Norm(final)=2.716 | 3479.2 samples/s | 54.4 steps/s
[Step=11650 Epoch=109.8] | Loss=0.00200 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.698 | L2-Norm(final)=2.718 | 1645.0 samples/s | 25.7 steps/s
[Step=11700 Epoch=110.2] | Loss=0.00180 | Reg=0.00349 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.695 | L2-Norm(final)=2.719 | 3316.3 samples/s | 51.8 steps/s
[Step=11750 Epoch=110.7] | Loss=0.00164 | Reg=0.00349 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.691 | L2-Norm(final)=2.720 | 1681.9 samples/s | 26.3 steps/s
[Step=11800 Epoch=111.2] | Loss=0.00151 | Reg=0.00349 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.688 | L2-Norm(final)=2.722 | 3363.8 samples/s | 52.6 steps/s
[Step=11850 Epoch=111.7] | Loss=0.00140 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.684 | L2-Norm(final)=2.723 | 1662.7 samples/s | 26.0 steps/s
[Step=11900 Epoch=112.1] | Loss=0.00130 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.681 | L2-Norm(final)=2.724 | 3356.9 samples/s | 52.5 steps/s
[Step=11950 Epoch=112.6] | Loss=0.00121 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.678 | L2-Norm(final)=2.725 | 1724.0 samples/s | 26.9 steps/s
[Step=12000 Epoch=113.1] | Loss=0.00114 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.676 | L2-Norm(final)=2.726 | 3109.4 samples/s | 48.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step12000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=106.8] | Loss=0.09932 | Reg=0.00351 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.737 | L2-Norm(final)=2.723 | 3449.3 samples/s | 53.9 steps/s
[Step=11250 Epoch=107.2] | Loss=0.01297 | Reg=0.00351 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=18.724 | L2-Norm(final)=2.718 | 3307.8 samples/s | 51.7 steps/s
[Step=11300 Epoch=107.7] | Loss=0.00782 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.727 | L2-Norm(final)=2.713 | 4242.4 samples/s | 66.3 steps/s
[Step=11350 Epoch=108.2] | Loss=0.00582 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.726 | L2-Norm(final)=2.713 | 1516.8 samples/s | 23.7 steps/s
[Step=11400 Epoch=108.7] | Loss=0.00439 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.724 | L2-Norm(final)=2.714 | 4065.7 samples/s | 63.5 steps/s
[Step=11450 Epoch=109.1] | Loss=0.00352 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.719 | L2-Norm(final)=2.715 | 1544.2 samples/s | 24.1 steps/s
[Step=11500 Epoch=109.6] | Loss=0.00294 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.715 | L2-Norm(final)=2.716 | 3871.7 samples/s | 60.5 steps/s
[Step=11550 Epoch=110.1] | Loss=0.00253 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.710 | L2-Norm(final)=2.718 | 1575.1 samples/s | 24.6 steps/s
[Step=11600 Epoch=110.6] | Loss=0.00222 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.706 | L2-Norm(final)=2.719 | 3657.9 samples/s | 57.2 steps/s
[Step=11650 Epoch=111.0] | Loss=0.00197 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.702 | L2-Norm(final)=2.720 | 1594.4 samples/s | 24.9 steps/s
[Step=11700 Epoch=111.5] | Loss=0.00178 | Reg=0.00350 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.698 | L2-Norm(final)=2.721 | 3549.2 samples/s | 55.5 steps/s
[Step=11750 Epoch=112.0] | Loss=0.00162 | Reg=0.00349 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.694 | L2-Norm(final)=2.722 | 1611.8 samples/s | 25.2 steps/s
[Step=11800 Epoch=112.5] | Loss=0.00149 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.691 | L2-Norm(final)=2.723 | 3409.6 samples/s | 53.3 steps/s
[Step=11850 Epoch=112.9] | Loss=0.00138 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.687 | L2-Norm(final)=2.724 | 1638.2 samples/s | 25.6 steps/s
[Step=11900 Epoch=113.4] | Loss=0.00128 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.684 | L2-Norm(final)=2.725 | 3399.1 samples/s | 53.1 steps/s
[Step=11950 Epoch=113.9] | Loss=0.00120 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.681 | L2-Norm(final)=2.726 | 1660.9 samples/s | 26.0 steps/s
[Step=12000 Epoch=114.4] | Loss=0.00112 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.678 | L2-Norm(final)=2.727 | 3379.1 samples/s | 52.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24188 | acc=0.8331 | tpr=0.7649 | fpr=0.0188 | 2726.5 samples/s | 10.7 steps/s
Avg test loss: 0.24199, Avg test acc: 0.83328, Avg tpr: 0.76628, Avg fpr: 0.01936, total FA: 151

Testing server on iccad2012
[Step=  50] | Loss=0.39203 | acc=0.8155 | tpr=0.9779 | fpr=0.1875 | 3657.2 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.39665 | acc=0.8171 | tpr=0.9765 | fpr=0.1859 | 6782.2 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.40208 | acc=0.8152 | tpr=0.9798 | fpr=0.1878 | 7090.5 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.40226 | acc=0.8153 | tpr=0.9792 | fpr=0.1877 | 6893.7 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.40289 | acc=0.8161 | tpr=0.9808 | fpr=0.1869 | 6844.3 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.40162 | acc=0.8168 | tpr=0.9753 | fpr=0.1861 | 6906.6 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.40278 | acc=0.8168 | tpr=0.9750 | fpr=0.1861 | 6951.4 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.40311 | acc=0.8166 | tpr=0.9743 | fpr=0.1863 | 6787.9 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.40590 | acc=0.8160 | tpr=0.9737 | fpr=0.1869 | 6831.8 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.40723 | acc=0.8153 | tpr=0.9744 | fpr=0.1876 | 6868.9 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.40658 | acc=0.8157 | tpr=0.9749 | fpr=0.1872 | 12189.6 samples/s | 47.6 steps/s
Avg test loss: 0.40644, Avg test acc: 0.81564, Avg tpr: 0.97504, Avg fpr: 0.18726, total FA: 26000

server round 15/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.18813 | Reg=0.00348 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=18.657 | L2-Norm(final)=2.747 | 3672.0 samples/s | 57.4 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03900 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.643 | L2-Norm(final)=2.730 | 3429.9 samples/s | 53.6 steps/s
[Step=12100 Epoch=59.0] | Loss=0.03476 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.641 | L2-Norm(final)=2.722 | 3534.8 samples/s | 55.2 steps/s
[Step=12150 Epoch=59.2] | Loss=0.03222 | Reg=0.00347 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.641 | L2-Norm(final)=2.717 | 3526.6 samples/s | 55.1 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02951 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.643 | L2-Norm(final)=2.715 | 4372.8 samples/s | 68.3 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02552 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.647 | L2-Norm(final)=2.718 | 1559.3 samples/s | 24.4 steps/s
[Step=12300 Epoch=60.0] | Loss=0.02310 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.651 | L2-Norm(final)=2.723 | 3504.2 samples/s | 54.8 steps/s
[Step=12350 Epoch=60.2] | Loss=0.02163 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.654 | L2-Norm(final)=2.727 | 3488.6 samples/s | 54.5 steps/s
[Step=12400 Epoch=60.5] | Loss=0.02045 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.656 | L2-Norm(final)=2.730 | 4115.7 samples/s | 64.3 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01897 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.658 | L2-Norm(final)=2.734 | 1607.6 samples/s | 25.1 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01827 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.659 | L2-Norm(final)=2.737 | 3534.0 samples/s | 55.2 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01756 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.660 | L2-Norm(final)=2.739 | 3515.5 samples/s | 54.9 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01672 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.661 | L2-Norm(final)=2.742 | 3916.3 samples/s | 61.2 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01585 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.662 | L2-Norm(final)=2.745 | 1632.7 samples/s | 25.5 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01536 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.663 | L2-Norm(final)=2.748 | 3522.0 samples/s | 55.0 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01504 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.663 | L2-Norm(final)=2.750 | 3494.2 samples/s | 54.6 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01471 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.664 | L2-Norm(final)=2.752 | 3748.1 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step12800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.6] | Loss=0.18771 | Reg=0.00348 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.657 | L2-Norm(final)=2.747 | 3628.3 samples/s | 56.7 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03418 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.647 | L2-Norm(final)=2.734 | 3418.1 samples/s | 53.4 steps/s
[Step=12100 Epoch=59.0] | Loss=0.03015 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.646 | L2-Norm(final)=2.728 | 3508.2 samples/s | 54.8 steps/s
[Step=12150 Epoch=59.3] | Loss=0.02683 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.647 | L2-Norm(final)=2.726 | 3507.9 samples/s | 54.8 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02652 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.650 | L2-Norm(final)=2.725 | 4372.6 samples/s | 68.3 steps/s
[Step=12250 Epoch=59.8] | Loss=0.02359 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.653 | L2-Norm(final)=2.727 | 1561.1 samples/s | 24.4 steps/s
[Step=12300 Epoch=60.0] | Loss=0.02216 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.657 | L2-Norm(final)=2.730 | 3480.3 samples/s | 54.4 steps/s
[Step=12350 Epoch=60.3] | Loss=0.02074 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.660 | L2-Norm(final)=2.733 | 3510.6 samples/s | 54.9 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01937 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.662 | L2-Norm(final)=2.736 | 4168.6 samples/s | 65.1 steps/s
[Step=12450 Epoch=60.8] | Loss=0.01810 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.664 | L2-Norm(final)=2.739 | 1596.2 samples/s | 24.9 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01706 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.665 | L2-Norm(final)=2.742 | 3510.5 samples/s | 54.9 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01646 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.666 | L2-Norm(final)=2.745 | 3519.9 samples/s | 55.0 steps/s
[Step=12600 Epoch=61.5] | Loss=0.01570 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.667 | L2-Norm(final)=2.747 | 4021.7 samples/s | 62.8 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01501 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.667 | L2-Norm(final)=2.749 | 1602.7 samples/s | 25.0 steps/s
[Step=12700 Epoch=62.0] | Loss=0.01423 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.668 | L2-Norm(final)=2.752 | 3477.7 samples/s | 54.3 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01395 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.669 | L2-Norm(final)=2.754 | 3520.4 samples/s | 55.0 steps/s
[Step=12800 Epoch=62.5] | Loss=0.01361 | Reg=0.00349 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.669 | L2-Norm(final)=2.756 | 3848.4 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step12800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.15489 | Reg=0.00348 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.657 | L2-Norm(final)=2.747 | 3623.9 samples/s | 56.6 steps/s
[Step=12050 Epoch=58.7] | Loss=0.03935 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.645 | L2-Norm(final)=2.726 | 3418.6 samples/s | 53.4 steps/s
[Step=12100 Epoch=59.0] | Loss=0.03243 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.644 | L2-Norm(final)=2.719 | 3535.0 samples/s | 55.2 steps/s
[Step=12150 Epoch=59.2] | Loss=0.02985 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.645 | L2-Norm(final)=2.719 | 3516.8 samples/s | 54.9 steps/s
[Step=12200 Epoch=59.4] | Loss=0.02737 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.647 | L2-Norm(final)=2.718 | 4375.2 samples/s | 68.4 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02428 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.649 | L2-Norm(final)=2.720 | 1544.2 samples/s | 24.1 steps/s
[Step=12300 Epoch=59.9] | Loss=0.02290 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.651 | L2-Norm(final)=2.722 | 3517.9 samples/s | 55.0 steps/s
[Step=12350 Epoch=60.2] | Loss=0.02122 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.652 | L2-Norm(final)=2.724 | 3508.1 samples/s | 54.8 steps/s
[Step=12400 Epoch=60.4] | Loss=0.01971 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.654 | L2-Norm(final)=2.727 | 4145.3 samples/s | 64.8 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01848 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.655 | L2-Norm(final)=2.731 | 1584.4 samples/s | 24.8 steps/s
[Step=12500 Epoch=60.9] | Loss=0.01793 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.657 | L2-Norm(final)=2.734 | 3508.1 samples/s | 54.8 steps/s
[Step=12550 Epoch=61.1] | Loss=0.01725 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.658 | L2-Norm(final)=2.737 | 3522.2 samples/s | 55.0 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01659 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.660 | L2-Norm(final)=2.740 | 3928.8 samples/s | 61.4 steps/s
[Step=12650 Epoch=61.6] | Loss=0.01604 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.662 | L2-Norm(final)=2.743 | 1622.2 samples/s | 25.3 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01540 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.663 | L2-Norm(final)=2.746 | 3528.2 samples/s | 55.1 steps/s
[Step=12750 Epoch=62.1] | Loss=0.01506 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.665 | L2-Norm(final)=2.749 | 3539.0 samples/s | 55.3 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01476 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.666 | L2-Norm(final)=2.751 | 3754.1 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step12800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.18545 | Reg=0.00348 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.657 | L2-Norm(final)=2.747 | 3622.2 samples/s | 56.6 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03430 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.638 | L2-Norm(final)=2.729 | 3426.1 samples/s | 53.5 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02874 | Reg=0.00347 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.635 | L2-Norm(final)=2.727 | 3515.2 samples/s | 54.9 steps/s
[Step=12150 Epoch=59.3] | Loss=0.02906 | Reg=0.00347 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.636 | L2-Norm(final)=2.726 | 3510.5 samples/s | 54.9 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02773 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.639 | L2-Norm(final)=2.723 | 4369.7 samples/s | 68.3 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02460 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.642 | L2-Norm(final)=2.724 | 1558.2 samples/s | 24.3 steps/s
[Step=12300 Epoch=60.0] | Loss=0.02197 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.644 | L2-Norm(final)=2.727 | 3516.4 samples/s | 54.9 steps/s
[Step=12350 Epoch=60.2] | Loss=0.02070 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.647 | L2-Norm(final)=2.731 | 3532.0 samples/s | 55.2 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01999 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.649 | L2-Norm(final)=2.733 | 4153.3 samples/s | 64.9 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01889 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.651 | L2-Norm(final)=2.736 | 1597.4 samples/s | 25.0 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01751 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.652 | L2-Norm(final)=2.738 | 3515.4 samples/s | 54.9 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01691 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.653 | L2-Norm(final)=2.741 | 3507.5 samples/s | 54.8 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01638 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.654 | L2-Norm(final)=2.743 | 3844.6 samples/s | 60.1 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01569 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.655 | L2-Norm(final)=2.745 | 1624.0 samples/s | 25.4 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01515 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.656 | L2-Norm(final)=2.747 | 3525.4 samples/s | 55.1 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01455 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.657 | L2-Norm(final)=2.749 | 3494.9 samples/s | 54.6 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01421 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.657 | L2-Norm(final)=2.751 | 3755.4 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step12800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.9] | Loss=0.11587 | Reg=0.00348 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.657 | L2-Norm(final)=2.747 | 3874.3 samples/s | 60.5 steps/s
[Step=12050 Epoch=59.1] | Loss=0.03903 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.646 | L2-Norm(final)=2.727 | 3210.9 samples/s | 50.2 steps/s
[Step=12100 Epoch=59.3] | Loss=0.03177 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.640 | L2-Norm(final)=2.722 | 3530.0 samples/s | 55.2 steps/s
[Step=12150 Epoch=59.6] | Loss=0.02750 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.638 | L2-Norm(final)=2.723 | 3569.7 samples/s | 55.8 steps/s
[Step=12200 Epoch=59.8] | Loss=0.02470 | Reg=0.00347 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.639 | L2-Norm(final)=2.725 | 4396.2 samples/s | 68.7 steps/s
[Step=12250 Epoch=60.1] | Loss=0.02188 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.641 | L2-Norm(final)=2.728 | 1549.8 samples/s | 24.2 steps/s
[Step=12300 Epoch=60.3] | Loss=0.02023 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.643 | L2-Norm(final)=2.733 | 3525.4 samples/s | 55.1 steps/s
[Step=12350 Epoch=60.6] | Loss=0.01882 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.645 | L2-Norm(final)=2.737 | 3531.2 samples/s | 55.2 steps/s
[Step=12400 Epoch=60.8] | Loss=0.01783 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.647 | L2-Norm(final)=2.741 | 4236.5 samples/s | 66.2 steps/s
[Step=12450 Epoch=61.1] | Loss=0.01704 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.648 | L2-Norm(final)=2.745 | 1586.9 samples/s | 24.8 steps/s
[Step=12500 Epoch=61.3] | Loss=0.01637 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.650 | L2-Norm(final)=2.748 | 3510.9 samples/s | 54.9 steps/s
[Step=12550 Epoch=61.5] | Loss=0.01563 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.651 | L2-Norm(final)=2.750 | 3499.1 samples/s | 54.7 steps/s
[Step=12600 Epoch=61.8] | Loss=0.01503 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.652 | L2-Norm(final)=2.753 | 4075.1 samples/s | 63.7 steps/s
[Step=12650 Epoch=62.0] | Loss=0.01431 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.653 | L2-Norm(final)=2.755 | 1591.5 samples/s | 24.9 steps/s
[Step=12700 Epoch=62.3] | Loss=0.01367 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.654 | L2-Norm(final)=2.758 | 3509.7 samples/s | 54.8 steps/s
[Step=12750 Epoch=62.5] | Loss=0.01325 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.654 | L2-Norm(final)=2.761 | 3513.7 samples/s | 54.9 steps/s
[Step=12800 Epoch=62.8] | Loss=0.01294 | Reg=0.00348 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.655 | L2-Norm(final)=2.763 | 3971.5 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step12800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=113.7] | Loss=0.02753 | Reg=0.00348 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.657 | L2-Norm(final)=2.749 | 3580.5 samples/s | 55.9 steps/s
[Step=12050 Epoch=114.2] | Loss=0.00955 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.637 | L2-Norm(final)=2.762 | 3284.4 samples/s | 51.3 steps/s
[Step=12100 Epoch=114.7] | Loss=0.00548 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.644 | L2-Norm(final)=2.766 | 4218.1 samples/s | 65.9 steps/s
[Step=12150 Epoch=115.1] | Loss=0.00373 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.642 | L2-Norm(final)=2.770 | 1507.7 samples/s | 23.6 steps/s
[Step=12200 Epoch=115.6] | Loss=0.00283 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.638 | L2-Norm(final)=2.773 | 3977.2 samples/s | 62.1 steps/s
[Step=12250 Epoch=116.1] | Loss=0.00226 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.632 | L2-Norm(final)=2.774 | 1547.2 samples/s | 24.2 steps/s
[Step=12300 Epoch=116.6] | Loss=0.00189 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.627 | L2-Norm(final)=2.775 | 3774.4 samples/s | 59.0 steps/s
[Step=12350 Epoch=117.0] | Loss=0.00162 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.622 | L2-Norm(final)=2.776 | 1565.8 samples/s | 24.5 steps/s
[Step=12400 Epoch=117.5] | Loss=0.00143 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.617 | L2-Norm(final)=2.776 | 3598.0 samples/s | 56.2 steps/s
[Step=12450 Epoch=118.0] | Loss=0.00127 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.613 | L2-Norm(final)=2.776 | 1621.4 samples/s | 25.3 steps/s
[Step=12500 Epoch=118.4] | Loss=0.00114 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.609 | L2-Norm(final)=2.776 | 3432.9 samples/s | 53.6 steps/s
[Step=12550 Epoch=118.9] | Loss=0.00104 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.605 | L2-Norm(final)=2.776 | 1654.1 samples/s | 25.8 steps/s
[Step=12600 Epoch=119.4] | Loss=0.00096 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.601 | L2-Norm(final)=2.776 | 3385.3 samples/s | 52.9 steps/s
[Step=12650 Epoch=119.9] | Loss=0.00089 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.598 | L2-Norm(final)=2.776 | 1658.2 samples/s | 25.9 steps/s
[Step=12700 Epoch=120.3] | Loss=0.00082 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.594 | L2-Norm(final)=2.776 | 3371.1 samples/s | 52.7 steps/s
[Step=12750 Epoch=120.8] | Loss=0.00077 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.591 | L2-Norm(final)=2.776 | 1659.4 samples/s | 25.9 steps/s
[Step=12800 Epoch=121.3] | Loss=0.00072 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.589 | L2-Norm(final)=2.776 | 3385.3 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step12800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=114.2] | Loss=0.04264 | Reg=0.00348 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.657 | L2-Norm(final)=2.748 | 3446.3 samples/s | 53.8 steps/s
[Step=12050 Epoch=114.6] | Loss=0.00887 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.624 | L2-Norm(final)=2.746 | 3305.6 samples/s | 51.7 steps/s
[Step=12100 Epoch=115.1] | Loss=0.00643 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.629 | L2-Norm(final)=2.748 | 4248.8 samples/s | 66.4 steps/s
[Step=12150 Epoch=115.6] | Loss=0.00660 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.646 | L2-Norm(final)=2.744 | 1503.2 samples/s | 23.5 steps/s
[Step=12200 Epoch=116.1] | Loss=0.00510 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.658 | L2-Norm(final)=2.742 | 4015.1 samples/s | 62.7 steps/s
[Step=12250 Epoch=116.5] | Loss=0.00409 | Reg=0.00348 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.662 | L2-Norm(final)=2.742 | 1540.5 samples/s | 24.1 steps/s
[Step=12300 Epoch=117.0] | Loss=0.00342 | Reg=0.00348 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.662 | L2-Norm(final)=2.742 | 3761.1 samples/s | 58.8 steps/s
[Step=12350 Epoch=117.5] | Loss=0.00293 | Reg=0.00348 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.661 | L2-Norm(final)=2.742 | 1599.6 samples/s | 25.0 steps/s
[Step=12400 Epoch=118.0] | Loss=0.00257 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.658 | L2-Norm(final)=2.743 | 3583.8 samples/s | 56.0 steps/s
[Step=12450 Epoch=118.4] | Loss=0.00228 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.655 | L2-Norm(final)=2.743 | 1604.5 samples/s | 25.1 steps/s
[Step=12500 Epoch=118.9] | Loss=0.00206 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.652 | L2-Norm(final)=2.744 | 3445.9 samples/s | 53.8 steps/s
[Step=12550 Epoch=119.4] | Loss=0.00187 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.649 | L2-Norm(final)=2.744 | 1655.5 samples/s | 25.9 steps/s
[Step=12600 Epoch=119.9] | Loss=0.00172 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.646 | L2-Norm(final)=2.744 | 3371.9 samples/s | 52.7 steps/s
[Step=12650 Epoch=120.3] | Loss=0.00159 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.643 | L2-Norm(final)=2.745 | 1658.0 samples/s | 25.9 steps/s
[Step=12700 Epoch=120.8] | Loss=0.00147 | Reg=0.00347 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.639 | L2-Norm(final)=2.745 | 3343.9 samples/s | 52.2 steps/s
[Step=12750 Epoch=121.3] | Loss=0.00138 | Reg=0.00347 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.636 | L2-Norm(final)=2.746 | 1661.6 samples/s | 26.0 steps/s
[Step=12800 Epoch=121.8] | Loss=0.00129 | Reg=0.00347 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.633 | L2-Norm(final)=2.746 | 3369.7 samples/s | 52.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step12800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=114.6] | Loss=0.07530 | Reg=0.00348 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.657 | L2-Norm(final)=2.749 | 3586.8 samples/s | 56.0 steps/s
[Step=12050 Epoch=115.1] | Loss=0.00775 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.626 | L2-Norm(final)=2.748 | 3189.6 samples/s | 49.8 steps/s
[Step=12100 Epoch=115.5] | Loss=0.00432 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.627 | L2-Norm(final)=2.754 | 4250.1 samples/s | 66.4 steps/s
[Step=12150 Epoch=116.0] | Loss=0.00290 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.623 | L2-Norm(final)=2.758 | 1501.9 samples/s | 23.5 steps/s
[Step=12200 Epoch=116.5] | Loss=0.00221 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.619 | L2-Norm(final)=2.761 | 4070.8 samples/s | 63.6 steps/s
[Step=12250 Epoch=117.0] | Loss=0.00177 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.614 | L2-Norm(final)=2.763 | 1525.7 samples/s | 23.8 steps/s
[Step=12300 Epoch=117.5] | Loss=0.00148 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.764 | 3874.4 samples/s | 60.5 steps/s
[Step=12350 Epoch=117.9] | Loss=0.00127 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.606 | L2-Norm(final)=2.766 | 1563.9 samples/s | 24.4 steps/s
[Step=12400 Epoch=118.4] | Loss=0.00112 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.602 | L2-Norm(final)=2.766 | 3677.6 samples/s | 57.5 steps/s
[Step=12450 Epoch=118.9] | Loss=0.00099 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.598 | L2-Norm(final)=2.767 | 1605.1 samples/s | 25.1 steps/s
[Step=12500 Epoch=119.4] | Loss=0.00090 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.595 | L2-Norm(final)=2.767 | 3565.7 samples/s | 55.7 steps/s
[Step=12550 Epoch=119.8] | Loss=0.00082 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.592 | L2-Norm(final)=2.768 | 1630.2 samples/s | 25.5 steps/s
[Step=12600 Epoch=120.3] | Loss=0.00075 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.588 | L2-Norm(final)=2.768 | 3397.4 samples/s | 53.1 steps/s
[Step=12650 Epoch=120.8] | Loss=0.00070 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.585 | L2-Norm(final)=2.768 | 1651.4 samples/s | 25.8 steps/s
[Step=12700 Epoch=121.3] | Loss=0.00065 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.583 | L2-Norm(final)=2.769 | 3392.9 samples/s | 53.0 steps/s
[Step=12750 Epoch=121.8] | Loss=0.00061 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.580 | L2-Norm(final)=2.769 | 1668.6 samples/s | 26.1 steps/s
[Step=12800 Epoch=122.2] | Loss=0.00057 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.577 | L2-Norm(final)=2.769 | 3377.7 samples/s | 52.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step12800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=113.1] | Loss=0.11676 | Reg=0.00348 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.657 | L2-Norm(final)=2.747 | 3748.9 samples/s | 58.6 steps/s
[Step=12050 Epoch=113.5] | Loss=0.01382 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.651 | L2-Norm(final)=2.737 | 3057.8 samples/s | 47.8 steps/s
[Step=12100 Epoch=114.0] | Loss=0.00734 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.655 | L2-Norm(final)=2.739 | 4189.7 samples/s | 65.5 steps/s
[Step=12150 Epoch=114.5] | Loss=0.00491 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.649 | L2-Norm(final)=2.743 | 1513.8 samples/s | 23.7 steps/s
[Step=12200 Epoch=115.0] | Loss=0.00370 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.643 | L2-Norm(final)=2.745 | 3930.9 samples/s | 61.4 steps/s
[Step=12250 Epoch=115.4] | Loss=0.00297 | Reg=0.00347 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.636 | L2-Norm(final)=2.748 | 1565.6 samples/s | 24.5 steps/s
[Step=12300 Epoch=115.9] | Loss=0.00248 | Reg=0.00347 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.631 | L2-Norm(final)=2.749 | 3667.8 samples/s | 57.3 steps/s
[Step=12350 Epoch=116.4] | Loss=0.00213 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.625 | L2-Norm(final)=2.751 | 1598.6 samples/s | 25.0 steps/s
[Step=12400 Epoch=116.8] | Loss=0.00187 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.621 | L2-Norm(final)=2.752 | 3468.5 samples/s | 54.2 steps/s
[Step=12450 Epoch=117.3] | Loss=0.00166 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.616 | L2-Norm(final)=2.753 | 1646.9 samples/s | 25.7 steps/s
[Step=12500 Epoch=117.8] | Loss=0.00150 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.612 | L2-Norm(final)=2.754 | 3389.8 samples/s | 53.0 steps/s
[Step=12550 Epoch=118.3] | Loss=0.00137 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.609 | L2-Norm(final)=2.754 | 1683.7 samples/s | 26.3 steps/s
[Step=12600 Epoch=118.7] | Loss=0.00125 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.605 | L2-Norm(final)=2.755 | 3371.6 samples/s | 52.7 steps/s
[Step=12650 Epoch=119.2] | Loss=0.00116 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.602 | L2-Norm(final)=2.756 | 1665.8 samples/s | 26.0 steps/s
[Step=12700 Epoch=119.7] | Loss=0.00108 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.599 | L2-Norm(final)=2.756 | 3429.6 samples/s | 53.6 steps/s
[Step=12750 Epoch=120.1] | Loss=0.00101 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.596 | L2-Norm(final)=2.757 | 1719.8 samples/s | 26.9 steps/s
[Step=12800 Epoch=120.6] | Loss=0.00095 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.593 | L2-Norm(final)=2.758 | 3142.1 samples/s | 49.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step12800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=114.4] | Loss=0.11213 | Reg=0.00348 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.657 | L2-Norm(final)=2.747 | 3806.6 samples/s | 59.5 steps/s
[Step=12050 Epoch=114.8] | Loss=0.01274 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.630 | L2-Norm(final)=2.736 | 3060.5 samples/s | 47.8 steps/s
[Step=12100 Epoch=115.3] | Loss=0.00759 | Reg=0.00347 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.634 | L2-Norm(final)=2.741 | 4234.8 samples/s | 66.2 steps/s
[Step=12150 Epoch=115.8] | Loss=0.00527 | Reg=0.00347 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.634 | L2-Norm(final)=2.747 | 1505.3 samples/s | 23.5 steps/s
[Step=12200 Epoch=116.3] | Loss=0.00398 | Reg=0.00347 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.631 | L2-Norm(final)=2.751 | 4062.6 samples/s | 63.5 steps/s
[Step=12250 Epoch=116.8] | Loss=0.00319 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.627 | L2-Norm(final)=2.754 | 1540.6 samples/s | 24.1 steps/s
[Step=12300 Epoch=117.2] | Loss=0.00266 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.622 | L2-Norm(final)=2.756 | 3831.9 samples/s | 59.9 steps/s
[Step=12350 Epoch=117.7] | Loss=0.00228 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.618 | L2-Norm(final)=2.757 | 1567.6 samples/s | 24.5 steps/s
[Step=12400 Epoch=118.2] | Loss=0.00200 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.614 | L2-Norm(final)=2.758 | 3695.0 samples/s | 57.7 steps/s
[Step=12450 Epoch=118.7] | Loss=0.00178 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.759 | 1604.0 samples/s | 25.1 steps/s
[Step=12500 Epoch=119.1] | Loss=0.00160 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.606 | L2-Norm(final)=2.759 | 3539.4 samples/s | 55.3 steps/s
[Step=12550 Epoch=119.6] | Loss=0.00146 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.602 | L2-Norm(final)=2.760 | 1629.3 samples/s | 25.5 steps/s
[Step=12600 Epoch=120.1] | Loss=0.00134 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.599 | L2-Norm(final)=2.760 | 3416.9 samples/s | 53.4 steps/s
[Step=12650 Epoch=120.6] | Loss=0.00124 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.596 | L2-Norm(final)=2.761 | 1659.3 samples/s | 25.9 steps/s
[Step=12700 Epoch=121.0] | Loss=0.00115 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.593 | L2-Norm(final)=2.761 | 3367.0 samples/s | 52.6 steps/s
[Step=12750 Epoch=121.5] | Loss=0.00108 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.590 | L2-Norm(final)=2.762 | 1645.0 samples/s | 25.7 steps/s
[Step=12800 Epoch=122.0] | Loss=0.00101 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.588 | L2-Norm(final)=2.762 | 3412.5 samples/s | 53.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22956 | acc=0.8465 | tpr=0.7835 | fpr=0.0168 | 3634.3 samples/s | 14.2 steps/s
Avg test loss: 0.23106, Avg test acc: 0.84630, Avg tpr: 0.78405, Avg fpr: 0.01679, total FA: 131

Testing server on iccad2012
[Step=  50] | Loss=0.42711 | acc=0.8051 | tpr=0.9735 | fpr=0.1979 | 3690.6 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.43199 | acc=0.8052 | tpr=0.9744 | fpr=0.1979 | 6669.4 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.43780 | acc=0.8037 | tpr=0.9784 | fpr=0.1995 | 6930.2 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.43758 | acc=0.8044 | tpr=0.9781 | fpr=0.1987 | 6853.9 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.43782 | acc=0.8046 | tpr=0.9799 | fpr=0.1986 | 6828.0 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.43638 | acc=0.8050 | tpr=0.9760 | fpr=0.1982 | 7067.7 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.43738 | acc=0.8053 | tpr=0.9750 | fpr=0.1978 | 6888.3 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.43759 | acc=0.8054 | tpr=0.9732 | fpr=0.1977 | 6819.4 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.44068 | acc=0.8046 | tpr=0.9722 | fpr=0.1984 | 6772.7 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.44228 | acc=0.8037 | tpr=0.9731 | fpr=0.1993 | 6822.7 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.44159 | acc=0.8044 | tpr=0.9737 | fpr=0.1987 | 12298.2 samples/s | 48.0 steps/s
Avg test loss: 0.44152, Avg test acc: 0.80440, Avg tpr: 0.97385, Avg fpr: 0.19868, total FA: 27586

server round 16/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.4] | Loss=0.13265 | Reg=0.00345 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.577 | L2-Norm(final)=2.776 | 3248.0 samples/s | 50.7 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03812 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.558 | L2-Norm(final)=2.751 | 3165.2 samples/s | 49.5 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03289 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.556 | L2-Norm(final)=2.746 | 3167.8 samples/s | 49.5 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02859 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.557 | L2-Norm(final)=2.747 | 3262.1 samples/s | 51.0 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02562 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.560 | L2-Norm(final)=2.751 | 4186.5 samples/s | 65.4 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02294 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.564 | L2-Norm(final)=2.755 | 1516.2 samples/s | 23.7 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02091 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.567 | L2-Norm(final)=2.760 | 3475.0 samples/s | 54.3 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01971 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.570 | L2-Norm(final)=2.764 | 3475.6 samples/s | 54.3 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01908 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.572 | L2-Norm(final)=2.767 | 4112.3 samples/s | 64.3 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01798 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.574 | L2-Norm(final)=2.769 | 1590.1 samples/s | 24.8 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01726 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.576 | L2-Norm(final)=2.772 | 3488.4 samples/s | 54.5 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01702 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.577 | L2-Norm(final)=2.774 | 3500.1 samples/s | 54.7 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01660 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.578 | L2-Norm(final)=2.775 | 3928.8 samples/s | 61.4 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01586 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.580 | L2-Norm(final)=2.777 | 1618.2 samples/s | 25.3 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01518 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.580 | L2-Norm(final)=2.778 | 3527.2 samples/s | 55.1 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01467 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.581 | L2-Norm(final)=2.780 | 3464.3 samples/s | 54.1 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01426 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.582 | L2-Norm(final)=2.782 | 3779.4 samples/s | 59.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step13600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.5] | Loss=0.17717 | Reg=0.00345 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.577 | L2-Norm(final)=2.775 | 3512.9 samples/s | 54.9 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03546 | Reg=0.00345 | FP-Reg=0.001 | acc=0.9219 | L2-Norm=18.563 | L2-Norm(final)=2.753 | 3546.3 samples/s | 55.4 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02974 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.558 | L2-Norm(final)=2.747 | 3504.6 samples/s | 54.8 steps/s
[Step=12950 Epoch=63.2] | Loss=0.02713 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.560 | L2-Norm(final)=2.747 | 3495.0 samples/s | 54.6 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02479 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.562 | L2-Norm(final)=2.747 | 4348.5 samples/s | 67.9 steps/s
[Step=13050 Epoch=63.7] | Loss=0.02139 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.564 | L2-Norm(final)=2.750 | 1561.1 samples/s | 24.4 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02003 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.565 | L2-Norm(final)=2.752 | 3339.4 samples/s | 52.2 steps/s
[Step=13150 Epoch=64.2] | Loss=0.01887 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.567 | L2-Norm(final)=2.755 | 3156.7 samples/s | 49.3 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01783 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.568 | L2-Norm(final)=2.758 | 3977.3 samples/s | 62.1 steps/s
[Step=13250 Epoch=64.7] | Loss=0.01662 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.569 | L2-Norm(final)=2.761 | 1554.5 samples/s | 24.3 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01581 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.570 | L2-Norm(final)=2.764 | 3475.5 samples/s | 54.3 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01525 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.571 | L2-Norm(final)=2.767 | 3499.0 samples/s | 54.7 steps/s
[Step=13400 Epoch=65.4] | Loss=0.01448 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.572 | L2-Norm(final)=2.770 | 4023.5 samples/s | 62.9 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01403 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.572 | L2-Norm(final)=2.772 | 1601.7 samples/s | 25.0 steps/s
[Step=13500 Epoch=65.9] | Loss=0.01342 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.572 | L2-Norm(final)=2.775 | 3507.4 samples/s | 54.8 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01277 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.573 | L2-Norm(final)=2.777 | 3514.7 samples/s | 54.9 steps/s
[Step=13600 Epoch=66.4] | Loss=0.01254 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.573 | L2-Norm(final)=2.779 | 3860.6 samples/s | 60.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step13600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.4] | Loss=0.09187 | Reg=0.00345 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.577 | L2-Norm(final)=2.776 | 3795.9 samples/s | 59.3 steps/s
[Step=12850 Epoch=62.6] | Loss=0.03312 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.555 | L2-Norm(final)=2.760 | 3305.9 samples/s | 51.7 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02653 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.551 | L2-Norm(final)=2.753 | 3531.2 samples/s | 55.2 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02644 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.553 | L2-Norm(final)=2.753 | 3525.4 samples/s | 55.1 steps/s
[Step=13000 Epoch=63.3] | Loss=0.02543 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.557 | L2-Norm(final)=2.754 | 4376.3 samples/s | 68.4 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02382 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.560 | L2-Norm(final)=2.753 | 1552.5 samples/s | 24.3 steps/s
[Step=13100 Epoch=63.8] | Loss=0.02165 | Reg=0.00345 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.562 | L2-Norm(final)=2.755 | 3507.8 samples/s | 54.8 steps/s
[Step=13150 Epoch=64.1] | Loss=0.02047 | Reg=0.00345 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.564 | L2-Norm(final)=2.757 | 3522.8 samples/s | 55.0 steps/s
[Step=13200 Epoch=64.3] | Loss=0.01934 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.565 | L2-Norm(final)=2.759 | 4138.6 samples/s | 64.7 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01780 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.566 | L2-Norm(final)=2.761 | 1600.0 samples/s | 25.0 steps/s
[Step=13300 Epoch=64.8] | Loss=0.01706 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.568 | L2-Norm(final)=2.764 | 3515.4 samples/s | 54.9 steps/s
[Step=13350 Epoch=65.0] | Loss=0.01645 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.569 | L2-Norm(final)=2.766 | 3516.0 samples/s | 54.9 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01591 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.570 | L2-Norm(final)=2.769 | 3929.4 samples/s | 61.4 steps/s
[Step=13450 Epoch=65.5] | Loss=0.01540 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.571 | L2-Norm(final)=2.771 | 1619.8 samples/s | 25.3 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01499 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.572 | L2-Norm(final)=2.772 | 3531.3 samples/s | 55.2 steps/s
[Step=13550 Epoch=66.0] | Loss=0.01443 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.573 | L2-Norm(final)=2.775 | 3527.1 samples/s | 55.1 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01404 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.573 | L2-Norm(final)=2.777 | 3737.6 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step13600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.4] | Loss=0.11979 | Reg=0.00345 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.577 | L2-Norm(final)=2.775 | 3595.2 samples/s | 56.2 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03213 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.560 | L2-Norm(final)=2.759 | 3450.1 samples/s | 53.9 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02764 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.558 | L2-Norm(final)=2.756 | 3516.8 samples/s | 54.9 steps/s
[Step=12950 Epoch=63.2] | Loss=0.02703 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.557 | L2-Norm(final)=2.750 | 3509.3 samples/s | 54.8 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02533 | Reg=0.00344 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.558 | L2-Norm(final)=2.747 | 4359.8 samples/s | 68.1 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02254 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.561 | L2-Norm(final)=2.748 | 1556.3 samples/s | 24.3 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02046 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.563 | L2-Norm(final)=2.751 | 3510.3 samples/s | 54.8 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01865 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.566 | L2-Norm(final)=2.753 | 3508.0 samples/s | 54.8 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01798 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.567 | L2-Norm(final)=2.756 | 4139.1 samples/s | 64.7 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01685 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.568 | L2-Norm(final)=2.758 | 1591.0 samples/s | 24.9 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01613 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.569 | L2-Norm(final)=2.761 | 3532.1 samples/s | 55.2 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01560 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.571 | L2-Norm(final)=2.763 | 3532.5 samples/s | 55.2 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01474 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.572 | L2-Norm(final)=2.766 | 3890.3 samples/s | 60.8 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01393 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.573 | L2-Norm(final)=2.769 | 1633.2 samples/s | 25.5 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01337 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.574 | L2-Norm(final)=2.773 | 3515.0 samples/s | 54.9 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01320 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.575 | L2-Norm(final)=2.775 | 3521.0 samples/s | 55.0 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01286 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.576 | L2-Norm(final)=2.777 | 3761.2 samples/s | 58.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step13600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.8] | Loss=0.15434 | Reg=0.00345 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.577 | L2-Norm(final)=2.775 | 3920.1 samples/s | 61.3 steps/s
[Step=12850 Epoch=63.0] | Loss=0.03249 | Reg=0.00345 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.569 | L2-Norm(final)=2.755 | 3198.5 samples/s | 50.0 steps/s
[Step=12900 Epoch=63.3] | Loss=0.03067 | Reg=0.00345 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.565 | L2-Norm(final)=2.750 | 3491.0 samples/s | 54.5 steps/s
[Step=12950 Epoch=63.5] | Loss=0.02850 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.565 | L2-Norm(final)=2.748 | 3514.3 samples/s | 54.9 steps/s
[Step=13000 Epoch=63.7] | Loss=0.02613 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.567 | L2-Norm(final)=2.748 | 4398.8 samples/s | 68.7 steps/s
[Step=13050 Epoch=64.0] | Loss=0.02344 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.570 | L2-Norm(final)=2.751 | 1557.2 samples/s | 24.3 steps/s
[Step=13100 Epoch=64.2] | Loss=0.02107 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.572 | L2-Norm(final)=2.754 | 3518.8 samples/s | 55.0 steps/s
[Step=13150 Epoch=64.5] | Loss=0.01994 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.575 | L2-Norm(final)=2.758 | 3534.3 samples/s | 55.2 steps/s
[Step=13200 Epoch=64.7] | Loss=0.01903 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.577 | L2-Norm(final)=2.762 | 4248.4 samples/s | 66.4 steps/s
[Step=13250 Epoch=65.0] | Loss=0.01784 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.580 | L2-Norm(final)=2.765 | 1566.8 samples/s | 24.5 steps/s
[Step=13300 Epoch=65.2] | Loss=0.01733 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.582 | L2-Norm(final)=2.768 | 3512.3 samples/s | 54.9 steps/s
[Step=13350 Epoch=65.5] | Loss=0.01669 | Reg=0.00345 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.584 | L2-Norm(final)=2.771 | 3499.3 samples/s | 54.7 steps/s
[Step=13400 Epoch=65.7] | Loss=0.01598 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.585 | L2-Norm(final)=2.773 | 4085.6 samples/s | 63.8 steps/s
[Step=13450 Epoch=66.0] | Loss=0.01537 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.587 | L2-Norm(final)=2.776 | 1601.4 samples/s | 25.0 steps/s
[Step=13500 Epoch=66.2] | Loss=0.01473 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.588 | L2-Norm(final)=2.778 | 3520.2 samples/s | 55.0 steps/s
[Step=13550 Epoch=66.4] | Loss=0.01431 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.589 | L2-Norm(final)=2.780 | 3516.0 samples/s | 54.9 steps/s
[Step=13600 Epoch=66.7] | Loss=0.01387 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.589 | L2-Norm(final)=2.782 | 3975.2 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step13600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=121.3] | Loss=0.09671 | Reg=0.00345 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.577 | L2-Norm(final)=2.777 | 3506.3 samples/s | 54.8 steps/s
[Step=12850 Epoch=121.8] | Loss=0.01245 | Reg=0.00345 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.566 | L2-Norm(final)=2.767 | 3248.0 samples/s | 50.8 steps/s
[Step=12900 Epoch=122.2] | Loss=0.00807 | Reg=0.00345 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.570 | L2-Norm(final)=2.764 | 4155.0 samples/s | 64.9 steps/s
[Step=12950 Epoch=122.7] | Loss=0.00552 | Reg=0.00345 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.570 | L2-Norm(final)=2.764 | 1531.5 samples/s | 23.9 steps/s
[Step=13000 Epoch=123.2] | Loss=0.00417 | Reg=0.00345 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.567 | L2-Norm(final)=2.766 | 3966.5 samples/s | 62.0 steps/s
[Step=13050 Epoch=123.7] | Loss=0.00334 | Reg=0.00345 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.563 | L2-Norm(final)=2.768 | 1543.0 samples/s | 24.1 steps/s
[Step=13100 Epoch=124.1] | Loss=0.00278 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.559 | L2-Norm(final)=2.769 | 3773.1 samples/s | 59.0 steps/s
[Step=13150 Epoch=124.6] | Loss=0.00239 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.554 | L2-Norm(final)=2.770 | 1585.2 samples/s | 24.8 steps/s
[Step=13200 Epoch=125.1] | Loss=0.00209 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.550 | L2-Norm(final)=2.771 | 3557.0 samples/s | 55.6 steps/s
[Step=13250 Epoch=125.6] | Loss=0.00186 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.546 | L2-Norm(final)=2.772 | 1618.0 samples/s | 25.3 steps/s
[Step=13300 Epoch=126.0] | Loss=0.00168 | Reg=0.00344 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.542 | L2-Norm(final)=2.773 | 3418.2 samples/s | 53.4 steps/s
[Step=13350 Epoch=126.5] | Loss=0.00153 | Reg=0.00344 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.538 | L2-Norm(final)=2.774 | 1638.6 samples/s | 25.6 steps/s
[Step=13400 Epoch=127.0] | Loss=0.00140 | Reg=0.00344 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.534 | L2-Norm(final)=2.774 | 3397.4 samples/s | 53.1 steps/s
[Step=13450 Epoch=127.5] | Loss=0.00130 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.531 | L2-Norm(final)=2.775 | 1666.4 samples/s | 26.0 steps/s
[Step=13500 Epoch=127.9] | Loss=0.00121 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.527 | L2-Norm(final)=2.776 | 3349.6 samples/s | 52.3 steps/s
[Step=13550 Epoch=128.4] | Loss=0.00113 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.524 | L2-Norm(final)=2.776 | 1662.8 samples/s | 26.0 steps/s
[Step=13600 Epoch=128.9] | Loss=0.00106 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.521 | L2-Norm(final)=2.777 | 3329.6 samples/s | 52.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step13600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=121.8] | Loss=0.10927 | Reg=0.00345 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.577 | L2-Norm(final)=2.777 | 3508.1 samples/s | 54.8 steps/s
[Step=12850 Epoch=122.2] | Loss=0.01270 | Reg=0.00344 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.556 | L2-Norm(final)=2.763 | 3252.3 samples/s | 50.8 steps/s
[Step=12900 Epoch=122.7] | Loss=0.00681 | Reg=0.00344 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.555 | L2-Norm(final)=2.765 | 4230.0 samples/s | 66.1 steps/s
[Step=12950 Epoch=123.2] | Loss=0.00458 | Reg=0.00344 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.549 | L2-Norm(final)=2.768 | 1504.0 samples/s | 23.5 steps/s
[Step=13000 Epoch=123.7] | Loss=0.00345 | Reg=0.00344 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.543 | L2-Norm(final)=2.771 | 3963.5 samples/s | 61.9 steps/s
[Step=13050 Epoch=124.1] | Loss=0.00277 | Reg=0.00344 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.537 | L2-Norm(final)=2.773 | 1542.2 samples/s | 24.1 steps/s
[Step=13100 Epoch=124.6] | Loss=0.00231 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.532 | L2-Norm(final)=2.775 | 3748.9 samples/s | 58.6 steps/s
[Step=13150 Epoch=125.1] | Loss=0.00199 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.528 | L2-Norm(final)=2.777 | 1587.6 samples/s | 24.8 steps/s
[Step=13200 Epoch=125.6] | Loss=0.00174 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.524 | L2-Norm(final)=2.778 | 3602.9 samples/s | 56.3 steps/s
[Step=13250 Epoch=126.0] | Loss=0.00155 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.520 | L2-Norm(final)=2.779 | 1631.9 samples/s | 25.5 steps/s
[Step=13300 Epoch=126.5] | Loss=0.00140 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.516 | L2-Norm(final)=2.781 | 3404.3 samples/s | 53.2 steps/s
[Step=13350 Epoch=127.0] | Loss=0.00127 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.513 | L2-Norm(final)=2.782 | 1660.0 samples/s | 25.9 steps/s
[Step=13400 Epoch=127.5] | Loss=0.00117 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.510 | L2-Norm(final)=2.783 | 3357.2 samples/s | 52.5 steps/s
[Step=13450 Epoch=127.9] | Loss=0.00108 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.507 | L2-Norm(final)=2.783 | 1662.0 samples/s | 26.0 steps/s
[Step=13500 Epoch=128.4] | Loss=0.00101 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.504 | L2-Norm(final)=2.784 | 3380.3 samples/s | 52.8 steps/s
[Step=13550 Epoch=128.9] | Loss=0.00094 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.502 | L2-Norm(final)=2.785 | 1666.0 samples/s | 26.0 steps/s
[Step=13600 Epoch=129.4] | Loss=0.00088 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.500 | L2-Norm(final)=2.786 | 3306.3 samples/s | 51.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step13600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=122.2] | Loss=0.11286 | Reg=0.00345 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.577 | L2-Norm(final)=2.777 | 3601.0 samples/s | 56.3 steps/s
[Step=12850 Epoch=122.7] | Loss=0.01383 | Reg=0.00344 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.557 | L2-Norm(final)=2.769 | 3195.4 samples/s | 49.9 steps/s
[Step=12900 Epoch=123.2] | Loss=0.00898 | Reg=0.00345 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.569 | L2-Norm(final)=2.754 | 4246.1 samples/s | 66.3 steps/s
[Step=12950 Epoch=123.7] | Loss=0.00624 | Reg=0.00345 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.571 | L2-Norm(final)=2.750 | 1514.5 samples/s | 23.7 steps/s
[Step=13000 Epoch=124.1] | Loss=0.00486 | Reg=0.00345 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.569 | L2-Norm(final)=2.750 | 4058.1 samples/s | 63.4 steps/s
[Step=13050 Epoch=124.6] | Loss=0.00389 | Reg=0.00345 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.566 | L2-Norm(final)=2.751 | 1540.8 samples/s | 24.1 steps/s
[Step=13100 Epoch=125.1] | Loss=0.00325 | Reg=0.00345 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.562 | L2-Norm(final)=2.752 | 3811.2 samples/s | 59.6 steps/s
[Step=13150 Epoch=125.6] | Loss=0.00279 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.558 | L2-Norm(final)=2.753 | 1573.6 samples/s | 24.6 steps/s
[Step=13200 Epoch=126.1] | Loss=0.00245 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.554 | L2-Norm(final)=2.754 | 3702.5 samples/s | 57.9 steps/s
[Step=13250 Epoch=126.5] | Loss=0.00218 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.550 | L2-Norm(final)=2.756 | 1602.9 samples/s | 25.0 steps/s
[Step=13300 Epoch=127.0] | Loss=0.00196 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.546 | L2-Norm(final)=2.757 | 3542.6 samples/s | 55.4 steps/s
[Step=13350 Epoch=127.5] | Loss=0.00178 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.543 | L2-Norm(final)=2.758 | 1611.6 samples/s | 25.2 steps/s
[Step=13400 Epoch=128.0] | Loss=0.00164 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.539 | L2-Norm(final)=2.759 | 3398.7 samples/s | 53.1 steps/s
[Step=13450 Epoch=128.4] | Loss=0.00151 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.536 | L2-Norm(final)=2.760 | 1645.7 samples/s | 25.7 steps/s
[Step=13500 Epoch=128.9] | Loss=0.00141 | Reg=0.00343 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.533 | L2-Norm(final)=2.761 | 3354.9 samples/s | 52.4 steps/s
[Step=13550 Epoch=129.4] | Loss=0.00131 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.530 | L2-Norm(final)=2.762 | 1660.0 samples/s | 25.9 steps/s
[Step=13600 Epoch=129.9] | Loss=0.00123 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.527 | L2-Norm(final)=2.764 | 3388.1 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step13600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=120.6] | Loss=0.14073 | Reg=0.00345 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.577 | L2-Norm(final)=2.776 | 3459.9 samples/s | 54.1 steps/s
[Step=12850 Epoch=121.1] | Loss=0.01781 | Reg=0.00345 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.562 | L2-Norm(final)=2.749 | 3285.1 samples/s | 51.3 steps/s
[Step=12900 Epoch=121.6] | Loss=0.01020 | Reg=0.00345 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.566 | L2-Norm(final)=2.749 | 4132.5 samples/s | 64.6 steps/s
[Step=12950 Epoch=122.0] | Loss=0.00686 | Reg=0.00345 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.564 | L2-Norm(final)=2.751 | 1519.9 samples/s | 23.7 steps/s
[Step=13000 Epoch=122.5] | Loss=0.00517 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.559 | L2-Norm(final)=2.753 | 3921.1 samples/s | 61.3 steps/s
[Step=13050 Epoch=123.0] | Loss=0.00415 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.554 | L2-Norm(final)=2.755 | 1568.6 samples/s | 24.5 steps/s
[Step=13100 Epoch=123.4] | Loss=0.00346 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.549 | L2-Norm(final)=2.757 | 3678.6 samples/s | 57.5 steps/s
[Step=13150 Epoch=123.9] | Loss=0.00297 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.544 | L2-Norm(final)=2.758 | 1602.6 samples/s | 25.0 steps/s
[Step=13200 Epoch=124.4] | Loss=0.00260 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.540 | L2-Norm(final)=2.760 | 3471.0 samples/s | 54.2 steps/s
[Step=13250 Epoch=124.9] | Loss=0.00232 | Reg=0.00344 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.536 | L2-Norm(final)=2.761 | 1658.1 samples/s | 25.9 steps/s
[Step=13300 Epoch=125.3] | Loss=0.00209 | Reg=0.00343 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.532 | L2-Norm(final)=2.762 | 3380.0 samples/s | 52.8 steps/s
[Step=13350 Epoch=125.8] | Loss=0.00190 | Reg=0.00343 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.529 | L2-Norm(final)=2.763 | 1662.9 samples/s | 26.0 steps/s
[Step=13400 Epoch=126.3] | Loss=0.00174 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.525 | L2-Norm(final)=2.764 | 3390.8 samples/s | 53.0 steps/s
[Step=13450 Epoch=126.7] | Loss=0.00161 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.522 | L2-Norm(final)=2.765 | 1676.7 samples/s | 26.2 steps/s
[Step=13500 Epoch=127.2] | Loss=0.00150 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.519 | L2-Norm(final)=2.766 | 3329.3 samples/s | 52.0 steps/s
[Step=13550 Epoch=127.7] | Loss=0.00140 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.516 | L2-Norm(final)=2.767 | 1723.3 samples/s | 26.9 steps/s
[Step=13600 Epoch=128.2] | Loss=0.00131 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.514 | L2-Norm(final)=2.768 | 3191.6 samples/s | 49.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step13600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=122.0] | Loss=0.05105 | Reg=0.00345 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.577 | L2-Norm(final)=2.777 | 3849.8 samples/s | 60.2 steps/s
[Step=12850 Epoch=122.5] | Loss=0.00647 | Reg=0.00344 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.542 | L2-Norm(final)=2.779 | 3073.8 samples/s | 48.0 steps/s
[Step=12900 Epoch=122.9] | Loss=0.00371 | Reg=0.00344 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.541 | L2-Norm(final)=2.781 | 4239.8 samples/s | 66.2 steps/s
[Step=12950 Epoch=123.4] | Loss=0.00249 | Reg=0.00344 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.536 | L2-Norm(final)=2.785 | 1505.5 samples/s | 23.5 steps/s
[Step=13000 Epoch=123.9] | Loss=0.00189 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.531 | L2-Norm(final)=2.787 | 3967.2 samples/s | 62.0 steps/s
[Step=13050 Epoch=124.4] | Loss=0.00151 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.526 | L2-Norm(final)=2.789 | 1546.9 samples/s | 24.2 steps/s
[Step=13100 Epoch=124.9] | Loss=0.00127 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.521 | L2-Norm(final)=2.790 | 3867.8 samples/s | 60.4 steps/s
[Step=13150 Epoch=125.3] | Loss=0.00109 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.516 | L2-Norm(final)=2.791 | 1564.8 samples/s | 24.4 steps/s
[Step=13200 Epoch=125.8] | Loss=0.00096 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.512 | L2-Norm(final)=2.792 | 3670.8 samples/s | 57.4 steps/s
[Step=13250 Epoch=126.3] | Loss=0.00085 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.509 | L2-Norm(final)=2.793 | 1590.6 samples/s | 24.9 steps/s
[Step=13300 Epoch=126.8] | Loss=0.00077 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.505 | L2-Norm(final)=2.793 | 3532.3 samples/s | 55.2 steps/s
[Step=13350 Epoch=127.2] | Loss=0.00070 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.502 | L2-Norm(final)=2.794 | 1615.1 samples/s | 25.2 steps/s
[Step=13400 Epoch=127.7] | Loss=0.00065 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.499 | L2-Norm(final)=2.794 | 3426.0 samples/s | 53.5 steps/s
[Step=13450 Epoch=128.2] | Loss=0.00060 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.496 | L2-Norm(final)=2.795 | 1655.5 samples/s | 25.9 steps/s
[Step=13500 Epoch=128.7] | Loss=0.00056 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.494 | L2-Norm(final)=2.795 | 3364.2 samples/s | 52.6 steps/s
[Step=13550 Epoch=129.1] | Loss=0.00052 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.491 | L2-Norm(final)=2.795 | 1656.2 samples/s | 25.9 steps/s
[Step=13600 Epoch=129.6] | Loss=0.00049 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.489 | L2-Norm(final)=2.796 | 3386.3 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23340 | acc=0.8420 | tpr=0.7777 | fpr=0.0183 | 3703.5 samples/s | 14.5 steps/s
Avg test loss: 0.23416, Avg test acc: 0.84225, Avg tpr: 0.77898, Avg fpr: 0.01859, total FA: 145

Testing server on iccad2012
[Step=  50] | Loss=0.39578 | acc=0.8264 | tpr=0.9735 | fpr=0.1762 | 3651.9 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.40081 | acc=0.8260 | tpr=0.9744 | fpr=0.1768 | 6755.5 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.40563 | acc=0.8246 | tpr=0.9784 | fpr=0.1782 | 6878.2 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.40550 | acc=0.8245 | tpr=0.9781 | fpr=0.1783 | 7073.8 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.40543 | acc=0.8251 | tpr=0.9799 | fpr=0.1777 | 6896.1 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.40424 | acc=0.8255 | tpr=0.9767 | fpr=0.1773 | 6769.8 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.40535 | acc=0.8253 | tpr=0.9750 | fpr=0.1774 | 6827.4 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.40586 | acc=0.8254 | tpr=0.9743 | fpr=0.1774 | 6800.6 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.40887 | acc=0.8246 | tpr=0.9737 | fpr=0.1781 | 7054.0 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.41028 | acc=0.8239 | tpr=0.9744 | fpr=0.1788 | 6619.8 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.40954 | acc=0.8242 | tpr=0.9749 | fpr=0.1785 | 12597.9 samples/s | 49.2 steps/s
Avg test loss: 0.40943, Avg test acc: 0.82421, Avg tpr: 0.97504, Avg fpr: 0.17853, total FA: 24789

server round 17/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.3] | Loss=0.11061 | Reg=0.00342 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.495 | L2-Norm(final)=2.798 | 3710.9 samples/s | 58.0 steps/s
[Step=13650 Epoch=66.6] | Loss=0.02894 | Reg=0.00341 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.469 | L2-Norm(final)=2.782 | 3374.7 samples/s | 52.7 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02683 | Reg=0.00341 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.466 | L2-Norm(final)=2.778 | 3508.5 samples/s | 54.8 steps/s
[Step=13750 Epoch=67.0] | Loss=0.02549 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.467 | L2-Norm(final)=2.775 | 3523.0 samples/s | 55.0 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02512 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.470 | L2-Norm(final)=2.775 | 4350.3 samples/s | 68.0 steps/s
[Step=13850 Epoch=67.5] | Loss=0.02265 | Reg=0.00341 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.472 | L2-Norm(final)=2.774 | 1547.2 samples/s | 24.2 steps/s
[Step=13900 Epoch=67.8] | Loss=0.02058 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.474 | L2-Norm(final)=2.776 | 3530.6 samples/s | 55.2 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01944 | Reg=0.00341 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.477 | L2-Norm(final)=2.778 | 3487.0 samples/s | 54.5 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01852 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.480 | L2-Norm(final)=2.781 | 4126.7 samples/s | 64.5 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01739 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.483 | L2-Norm(final)=2.784 | 1597.6 samples/s | 25.0 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01672 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.484 | L2-Norm(final)=2.787 | 3529.4 samples/s | 55.1 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01620 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.486 | L2-Norm(final)=2.788 | 3517.6 samples/s | 55.0 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01555 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.488 | L2-Norm(final)=2.790 | 3912.8 samples/s | 61.1 steps/s
[Step=14250 Epoch=69.5] | Loss=0.01480 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.490 | L2-Norm(final)=2.793 | 1618.7 samples/s | 25.3 steps/s
[Step=14300 Epoch=69.7] | Loss=0.01429 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.491 | L2-Norm(final)=2.796 | 3515.1 samples/s | 54.9 steps/s
[Step=14350 Epoch=70.0] | Loss=0.01378 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.492 | L2-Norm(final)=2.798 | 3503.1 samples/s | 54.7 steps/s
[Step=14400 Epoch=70.2] | Loss=0.01354 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.493 | L2-Norm(final)=2.800 | 3767.3 samples/s | 58.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step14400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.4] | Loss=0.12675 | Reg=0.00342 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.495 | L2-Norm(final)=2.798 | 3638.9 samples/s | 56.9 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03189 | Reg=0.00341 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=18.477 | L2-Norm(final)=2.782 | 3358.1 samples/s | 52.5 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02803 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.478 | L2-Norm(final)=2.777 | 3514.2 samples/s | 54.9 steps/s
[Step=13750 Epoch=67.1] | Loss=0.02759 | Reg=0.00342 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.483 | L2-Norm(final)=2.773 | 3526.7 samples/s | 55.1 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02636 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.487 | L2-Norm(final)=2.770 | 4379.6 samples/s | 68.4 steps/s
[Step=13850 Epoch=67.6] | Loss=0.02362 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.491 | L2-Norm(final)=2.771 | 1544.8 samples/s | 24.1 steps/s
[Step=13900 Epoch=67.8] | Loss=0.02135 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.494 | L2-Norm(final)=2.774 | 3501.2 samples/s | 54.7 steps/s
[Step=13950 Epoch=68.1] | Loss=0.02001 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.497 | L2-Norm(final)=2.777 | 3515.3 samples/s | 54.9 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01885 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.499 | L2-Norm(final)=2.780 | 4159.4 samples/s | 65.0 steps/s
[Step=14050 Epoch=68.6] | Loss=0.01786 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.502 | L2-Norm(final)=2.782 | 1588.3 samples/s | 24.8 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01696 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.504 | L2-Norm(final)=2.786 | 3516.2 samples/s | 54.9 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01610 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.506 | L2-Norm(final)=2.789 | 3521.2 samples/s | 55.0 steps/s
[Step=14200 Epoch=69.3] | Loss=0.01556 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.507 | L2-Norm(final)=2.792 | 4025.3 samples/s | 62.9 steps/s
[Step=14250 Epoch=69.5] | Loss=0.01490 | Reg=0.00343 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.509 | L2-Norm(final)=2.794 | 1607.2 samples/s | 25.1 steps/s
[Step=14300 Epoch=69.8] | Loss=0.01429 | Reg=0.00343 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.510 | L2-Norm(final)=2.797 | 3493.6 samples/s | 54.6 steps/s
[Step=14350 Epoch=70.0] | Loss=0.01413 | Reg=0.00343 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.511 | L2-Norm(final)=2.799 | 3509.1 samples/s | 54.8 steps/s
[Step=14400 Epoch=70.3] | Loss=0.01351 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.512 | L2-Norm(final)=2.801 | 3844.1 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step14400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.3] | Loss=0.15038 | Reg=0.00342 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.495 | L2-Norm(final)=2.798 | 3618.6 samples/s | 56.5 steps/s
[Step=13650 Epoch=66.5] | Loss=0.03788 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.469 | L2-Norm(final)=2.771 | 3409.4 samples/s | 53.3 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02924 | Reg=0.00341 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.470 | L2-Norm(final)=2.770 | 3506.2 samples/s | 54.8 steps/s
[Step=13750 Epoch=67.0] | Loss=0.02761 | Reg=0.00341 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.474 | L2-Norm(final)=2.770 | 3506.8 samples/s | 54.8 steps/s
[Step=13800 Epoch=67.2] | Loss=0.02637 | Reg=0.00341 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.478 | L2-Norm(final)=2.770 | 4336.3 samples/s | 67.8 steps/s
[Step=13850 Epoch=67.5] | Loss=0.02440 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.483 | L2-Norm(final)=2.771 | 1559.5 samples/s | 24.4 steps/s
[Step=13900 Epoch=67.7] | Loss=0.02237 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.488 | L2-Norm(final)=2.774 | 3513.2 samples/s | 54.9 steps/s
[Step=13950 Epoch=68.0] | Loss=0.02170 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.491 | L2-Norm(final)=2.777 | 3500.7 samples/s | 54.7 steps/s
[Step=14000 Epoch=68.2] | Loss=0.02053 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.494 | L2-Norm(final)=2.779 | 4121.2 samples/s | 64.4 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01916 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.496 | L2-Norm(final)=2.781 | 1599.3 samples/s | 25.0 steps/s
[Step=14100 Epoch=68.7] | Loss=0.01831 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.498 | L2-Norm(final)=2.783 | 3497.9 samples/s | 54.7 steps/s
[Step=14150 Epoch=68.9] | Loss=0.01769 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.500 | L2-Norm(final)=2.785 | 3505.3 samples/s | 54.8 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01700 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=18.501 | L2-Norm(final)=2.787 | 3920.3 samples/s | 61.3 steps/s
[Step=14250 Epoch=69.4] | Loss=0.01664 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.502 | L2-Norm(final)=2.788 | 1627.4 samples/s | 25.4 steps/s
[Step=14300 Epoch=69.7] | Loss=0.01601 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.502 | L2-Norm(final)=2.789 | 3598.0 samples/s | 56.2 steps/s
[Step=14350 Epoch=69.9] | Loss=0.01541 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.503 | L2-Norm(final)=2.791 | 3502.5 samples/s | 54.7 steps/s
[Step=14400 Epoch=70.2] | Loss=0.01493 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.504 | L2-Norm(final)=2.793 | 3733.7 samples/s | 58.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step14400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.3] | Loss=0.09632 | Reg=0.00342 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.495 | L2-Norm(final)=2.798 | 3582.9 samples/s | 56.0 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03208 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.479 | L2-Norm(final)=2.785 | 3474.0 samples/s | 54.3 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02666 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.478 | L2-Norm(final)=2.780 | 3506.5 samples/s | 54.8 steps/s
[Step=13750 Epoch=67.1] | Loss=0.02626 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.479 | L2-Norm(final)=2.775 | 3507.8 samples/s | 54.8 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02442 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.480 | L2-Norm(final)=2.771 | 4375.7 samples/s | 68.4 steps/s
[Step=13850 Epoch=67.5] | Loss=0.02100 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.482 | L2-Norm(final)=2.773 | 1562.6 samples/s | 24.4 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01916 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.483 | L2-Norm(final)=2.776 | 3528.0 samples/s | 55.1 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01799 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.485 | L2-Norm(final)=2.780 | 3533.7 samples/s | 55.2 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01707 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.485 | L2-Norm(final)=2.782 | 4158.0 samples/s | 65.0 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01604 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.487 | L2-Norm(final)=2.785 | 1585.1 samples/s | 24.8 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01534 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.488 | L2-Norm(final)=2.788 | 3492.1 samples/s | 54.6 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01485 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.490 | L2-Norm(final)=2.791 | 3501.5 samples/s | 54.7 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01460 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.491 | L2-Norm(final)=2.793 | 3920.5 samples/s | 61.3 steps/s
[Step=14250 Epoch=69.5] | Loss=0.01392 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.492 | L2-Norm(final)=2.794 | 1604.6 samples/s | 25.1 steps/s
[Step=14300 Epoch=69.7] | Loss=0.01349 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.493 | L2-Norm(final)=2.797 | 3525.9 samples/s | 55.1 steps/s
[Step=14350 Epoch=70.0] | Loss=0.01327 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.494 | L2-Norm(final)=2.799 | 3505.7 samples/s | 54.8 steps/s
[Step=14400 Epoch=70.2] | Loss=0.01301 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.495 | L2-Norm(final)=2.801 | 3764.8 samples/s | 58.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step14400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.7] | Loss=0.21592 | Reg=0.00342 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.495 | L2-Norm(final)=2.798 | 3634.6 samples/s | 56.8 steps/s
[Step=13650 Epoch=66.9] | Loss=0.03184 | Reg=0.00341 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.477 | L2-Norm(final)=2.784 | 3390.1 samples/s | 53.0 steps/s
[Step=13700 Epoch=67.2] | Loss=0.02806 | Reg=0.00342 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.481 | L2-Norm(final)=2.784 | 3532.0 samples/s | 55.2 steps/s
[Step=13750 Epoch=67.4] | Loss=0.02533 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.485 | L2-Norm(final)=2.784 | 3535.1 samples/s | 55.2 steps/s
[Step=13800 Epoch=67.7] | Loss=0.02479 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=18.491 | L2-Norm(final)=2.787 | 4404.5 samples/s | 68.8 steps/s
[Step=13850 Epoch=67.9] | Loss=0.02282 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.494 | L2-Norm(final)=2.785 | 1549.7 samples/s | 24.2 steps/s
[Step=13900 Epoch=68.2] | Loss=0.02060 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.497 | L2-Norm(final)=2.787 | 3504.5 samples/s | 54.8 steps/s
[Step=13950 Epoch=68.4] | Loss=0.01939 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.500 | L2-Norm(final)=2.790 | 3520.3 samples/s | 55.0 steps/s
[Step=14000 Epoch=68.7] | Loss=0.01826 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.502 | L2-Norm(final)=2.793 | 4256.9 samples/s | 66.5 steps/s
[Step=14050 Epoch=68.9] | Loss=0.01714 | Reg=0.00342 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.504 | L2-Norm(final)=2.795 | 1577.1 samples/s | 24.6 steps/s
[Step=14100 Epoch=69.1] | Loss=0.01639 | Reg=0.00342 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.506 | L2-Norm(final)=2.799 | 3530.0 samples/s | 55.2 steps/s
[Step=14150 Epoch=69.4] | Loss=0.01554 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.508 | L2-Norm(final)=2.802 | 3498.4 samples/s | 54.7 steps/s
[Step=14200 Epoch=69.6] | Loss=0.01513 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.509 | L2-Norm(final)=2.805 | 4106.7 samples/s | 64.2 steps/s
[Step=14250 Epoch=69.9] | Loss=0.01450 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.510 | L2-Norm(final)=2.807 | 1609.4 samples/s | 25.1 steps/s
[Step=14300 Epoch=70.1] | Loss=0.01400 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.511 | L2-Norm(final)=2.809 | 3512.0 samples/s | 54.9 steps/s
[Step=14350 Epoch=70.4] | Loss=0.01351 | Reg=0.00343 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.511 | L2-Norm(final)=2.811 | 3517.4 samples/s | 55.0 steps/s
[Step=14400 Epoch=70.6] | Loss=0.01316 | Reg=0.00343 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.512 | L2-Norm(final)=2.813 | 3959.2 samples/s | 61.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step14400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=128.9] | Loss=0.08318 | Reg=0.00342 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.495 | L2-Norm(final)=2.799 | 3722.2 samples/s | 58.2 steps/s
[Step=13650 Epoch=129.3] | Loss=0.00914 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.460 | L2-Norm(final)=2.797 | 3084.2 samples/s | 48.2 steps/s
[Step=13700 Epoch=129.8] | Loss=0.00632 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.460 | L2-Norm(final)=2.791 | 4220.6 samples/s | 65.9 steps/s
[Step=13750 Epoch=130.3] | Loss=0.00464 | Reg=0.00341 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.462 | L2-Norm(final)=2.789 | 1511.1 samples/s | 23.6 steps/s
[Step=13800 Epoch=130.8] | Loss=0.00351 | Reg=0.00341 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.461 | L2-Norm(final)=2.790 | 3964.0 samples/s | 61.9 steps/s
[Step=13850 Epoch=131.2] | Loss=0.00282 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.459 | L2-Norm(final)=2.791 | 1547.8 samples/s | 24.2 steps/s
[Step=13900 Epoch=131.7] | Loss=0.00235 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.455 | L2-Norm(final)=2.792 | 3785.7 samples/s | 59.2 steps/s
[Step=13950 Epoch=132.2] | Loss=0.00202 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.452 | L2-Norm(final)=2.793 | 1581.9 samples/s | 24.7 steps/s
[Step=14000 Epoch=132.7] | Loss=0.00177 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.449 | L2-Norm(final)=2.794 | 3580.9 samples/s | 56.0 steps/s
[Step=14050 Epoch=133.1] | Loss=0.00158 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.446 | L2-Norm(final)=2.795 | 1606.3 samples/s | 25.1 steps/s
[Step=14100 Epoch=133.6] | Loss=0.00142 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.442 | L2-Norm(final)=2.796 | 3425.4 samples/s | 53.5 steps/s
[Step=14150 Epoch=134.1] | Loss=0.00129 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.439 | L2-Norm(final)=2.797 | 1649.1 samples/s | 25.8 steps/s
[Step=14200 Epoch=134.6] | Loss=0.00119 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.437 | L2-Norm(final)=2.798 | 3375.4 samples/s | 52.7 steps/s
[Step=14250 Epoch=135.0] | Loss=0.00110 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.434 | L2-Norm(final)=2.798 | 1665.5 samples/s | 26.0 steps/s
[Step=14300 Epoch=135.5] | Loss=0.00102 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.431 | L2-Norm(final)=2.799 | 3334.7 samples/s | 52.1 steps/s
[Step=14350 Epoch=136.0] | Loss=0.00095 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.429 | L2-Norm(final)=2.800 | 1675.3 samples/s | 26.2 steps/s
[Step=14400 Epoch=136.5] | Loss=0.00089 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.426 | L2-Norm(final)=2.800 | 3536.2 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step14400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=129.4] | Loss=0.06764 | Reg=0.00342 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.495 | L2-Norm(final)=2.799 | 3454.2 samples/s | 54.0 steps/s
[Step=13650 Epoch=129.8] | Loss=0.00720 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.472 | L2-Norm(final)=2.808 | 3375.8 samples/s | 52.7 steps/s
[Step=13700 Epoch=130.3] | Loss=0.00433 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.470 | L2-Norm(final)=2.815 | 4243.6 samples/s | 66.3 steps/s
[Step=13750 Epoch=130.8] | Loss=0.00299 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.465 | L2-Norm(final)=2.818 | 1525.9 samples/s | 23.8 steps/s
[Step=13800 Epoch=131.3] | Loss=0.00226 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.460 | L2-Norm(final)=2.821 | 3996.0 samples/s | 62.4 steps/s
[Step=13850 Epoch=131.7] | Loss=0.00181 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.456 | L2-Norm(final)=2.822 | 1543.6 samples/s | 24.1 steps/s
[Step=13900 Epoch=132.2] | Loss=0.00152 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.451 | L2-Norm(final)=2.823 | 3787.1 samples/s | 59.2 steps/s
[Step=13950 Epoch=132.7] | Loss=0.00131 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.447 | L2-Norm(final)=2.824 | 1586.1 samples/s | 24.8 steps/s
[Step=14000 Epoch=133.2] | Loss=0.00115 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.443 | L2-Norm(final)=2.824 | 3588.6 samples/s | 56.1 steps/s
[Step=14050 Epoch=133.7] | Loss=0.00102 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.439 | L2-Norm(final)=2.825 | 1623.7 samples/s | 25.4 steps/s
[Step=14100 Epoch=134.1] | Loss=0.00092 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.436 | L2-Norm(final)=2.825 | 3412.7 samples/s | 53.3 steps/s
[Step=14150 Epoch=134.6] | Loss=0.00084 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.432 | L2-Norm(final)=2.825 | 1653.9 samples/s | 25.8 steps/s
[Step=14200 Epoch=135.1] | Loss=0.00077 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.429 | L2-Norm(final)=2.825 | 3378.3 samples/s | 52.8 steps/s
[Step=14250 Epoch=135.6] | Loss=0.00072 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.427 | L2-Norm(final)=2.826 | 1655.0 samples/s | 25.9 steps/s
[Step=14300 Epoch=136.0] | Loss=0.00067 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.424 | L2-Norm(final)=2.826 | 3303.8 samples/s | 51.6 steps/s
[Step=14350 Epoch=136.5] | Loss=0.00062 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.421 | L2-Norm(final)=2.826 | 1647.8 samples/s | 25.7 steps/s
[Step=14400 Epoch=137.0] | Loss=0.00059 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.419 | L2-Norm(final)=2.826 | 3327.5 samples/s | 52.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step14400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=129.9] | Loss=0.12061 | Reg=0.00342 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.495 | L2-Norm(final)=2.798 | 3446.3 samples/s | 53.8 steps/s
[Step=13650 Epoch=130.3] | Loss=0.00972 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.462 | L2-Norm(final)=2.780 | 3207.5 samples/s | 50.1 steps/s
[Step=13700 Epoch=130.8] | Loss=0.00519 | Reg=0.00341 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.457 | L2-Norm(final)=2.782 | 4229.2 samples/s | 66.1 steps/s
[Step=13750 Epoch=131.3] | Loss=0.00350 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.452 | L2-Norm(final)=2.786 | 1503.4 samples/s | 23.5 steps/s
[Step=13800 Epoch=131.8] | Loss=0.00264 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.448 | L2-Norm(final)=2.788 | 4036.1 samples/s | 63.1 steps/s
[Step=13850 Epoch=132.3] | Loss=0.00211 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.443 | L2-Norm(final)=2.791 | 1540.4 samples/s | 24.1 steps/s
[Step=13900 Epoch=132.7] | Loss=0.00177 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.439 | L2-Norm(final)=2.792 | 3842.7 samples/s | 60.0 steps/s
[Step=13950 Epoch=133.2] | Loss=0.00152 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.435 | L2-Norm(final)=2.794 | 1564.1 samples/s | 24.4 steps/s
[Step=14000 Epoch=133.7] | Loss=0.00133 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.431 | L2-Norm(final)=2.795 | 3717.8 samples/s | 58.1 steps/s
[Step=14050 Epoch=134.2] | Loss=0.00118 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.427 | L2-Norm(final)=2.796 | 1603.7 samples/s | 25.1 steps/s
[Step=14100 Epoch=134.6] | Loss=0.00107 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.424 | L2-Norm(final)=2.797 | 3541.8 samples/s | 55.3 steps/s
[Step=14150 Epoch=135.1] | Loss=0.00097 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.421 | L2-Norm(final)=2.798 | 1625.7 samples/s | 25.4 steps/s
[Step=14200 Epoch=135.6] | Loss=0.00089 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.418 | L2-Norm(final)=2.799 | 3424.3 samples/s | 53.5 steps/s
[Step=14250 Epoch=136.1] | Loss=0.00083 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.416 | L2-Norm(final)=2.799 | 1636.3 samples/s | 25.6 steps/s
[Step=14300 Epoch=136.6] | Loss=0.00077 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.413 | L2-Norm(final)=2.800 | 3371.4 samples/s | 52.7 steps/s
[Step=14350 Epoch=137.0] | Loss=0.00072 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.411 | L2-Norm(final)=2.801 | 1656.6 samples/s | 25.9 steps/s
[Step=14400 Epoch=137.5] | Loss=0.00068 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.408 | L2-Norm(final)=2.802 | 3378.4 samples/s | 52.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step14400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=128.2] | Loss=0.12392 | Reg=0.00342 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.495 | L2-Norm(final)=2.798 | 3423.6 samples/s | 53.5 steps/s
[Step=13650 Epoch=128.6] | Loss=0.00982 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.466 | L2-Norm(final)=2.790 | 3332.3 samples/s | 52.1 steps/s
[Step=13700 Epoch=129.1] | Loss=0.00553 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.464 | L2-Norm(final)=2.793 | 4186.8 samples/s | 65.4 steps/s
[Step=13750 Epoch=129.6] | Loss=0.00373 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.460 | L2-Norm(final)=2.797 | 1529.8 samples/s | 23.9 steps/s
[Step=13800 Epoch=130.0] | Loss=0.00281 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.455 | L2-Norm(final)=2.799 | 3918.8 samples/s | 61.2 steps/s
[Step=13850 Epoch=130.5] | Loss=0.00225 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.450 | L2-Norm(final)=2.801 | 1548.2 samples/s | 24.2 steps/s
[Step=13900 Epoch=131.0] | Loss=0.00188 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.445 | L2-Norm(final)=2.802 | 3604.3 samples/s | 56.3 steps/s
[Step=13950 Epoch=131.4] | Loss=0.00162 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.441 | L2-Norm(final)=2.803 | 1587.7 samples/s | 24.8 steps/s
[Step=14000 Epoch=131.9] | Loss=0.00142 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.437 | L2-Norm(final)=2.803 | 3468.8 samples/s | 54.2 steps/s
[Step=14050 Epoch=132.4] | Loss=0.00126 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.433 | L2-Norm(final)=2.804 | 1651.8 samples/s | 25.8 steps/s
[Step=14100 Epoch=132.9] | Loss=0.00114 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.430 | L2-Norm(final)=2.804 | 3386.6 samples/s | 52.9 steps/s
[Step=14150 Epoch=133.3] | Loss=0.00104 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.427 | L2-Norm(final)=2.805 | 1636.6 samples/s | 25.6 steps/s
[Step=14200 Epoch=133.8] | Loss=0.00095 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.424 | L2-Norm(final)=2.805 | 3383.0 samples/s | 52.9 steps/s
[Step=14250 Epoch=134.3] | Loss=0.00088 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.421 | L2-Norm(final)=2.806 | 1687.5 samples/s | 26.4 steps/s
[Step=14300 Epoch=134.7] | Loss=0.00082 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.419 | L2-Norm(final)=2.806 | 3335.9 samples/s | 52.1 steps/s
[Step=14350 Epoch=135.2] | Loss=0.00077 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.416 | L2-Norm(final)=2.807 | 1718.9 samples/s | 26.9 steps/s
[Step=14400 Epoch=135.7] | Loss=0.00072 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.414 | L2-Norm(final)=2.807 | 3215.6 samples/s | 50.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step14400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=129.6] | Loss=0.15415 | Reg=0.00342 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.495 | L2-Norm(final)=2.799 | 3475.7 samples/s | 54.3 steps/s
[Step=13650 Epoch=130.1] | Loss=0.01085 | Reg=0.00341 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.473 | L2-Norm(final)=2.784 | 3297.5 samples/s | 51.5 steps/s
[Step=13700 Epoch=130.6] | Loss=0.00571 | Reg=0.00341 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.470 | L2-Norm(final)=2.785 | 4288.4 samples/s | 67.0 steps/s
[Step=13750 Epoch=131.0] | Loss=0.00384 | Reg=0.00341 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.464 | L2-Norm(final)=2.789 | 1513.8 samples/s | 23.7 steps/s
[Step=13800 Epoch=131.5] | Loss=0.00290 | Reg=0.00341 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.458 | L2-Norm(final)=2.792 | 4046.9 samples/s | 63.2 steps/s
[Step=13850 Epoch=132.0] | Loss=0.00233 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.452 | L2-Norm(final)=2.795 | 1546.1 samples/s | 24.2 steps/s
[Step=13900 Epoch=132.5] | Loss=0.00195 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.447 | L2-Norm(final)=2.797 | 3873.4 samples/s | 60.5 steps/s
[Step=13950 Epoch=133.0] | Loss=0.00167 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.442 | L2-Norm(final)=2.799 | 1557.7 samples/s | 24.3 steps/s
[Step=14000 Epoch=133.4] | Loss=0.00147 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.437 | L2-Norm(final)=2.800 | 3672.6 samples/s | 57.4 steps/s
[Step=14050 Epoch=133.9] | Loss=0.00131 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.433 | L2-Norm(final)=2.801 | 1566.4 samples/s | 24.5 steps/s
[Step=14100 Epoch=134.4] | Loss=0.00118 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.429 | L2-Norm(final)=2.802 | 3504.2 samples/s | 54.8 steps/s
[Step=14150 Epoch=134.9] | Loss=0.00107 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.426 | L2-Norm(final)=2.803 | 1496.4 samples/s | 23.4 steps/s
[Step=14200 Epoch=135.3] | Loss=0.00099 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.423 | L2-Norm(final)=2.804 | 3091.9 samples/s | 48.3 steps/s
[Step=14250 Epoch=135.8] | Loss=0.00091 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.420 | L2-Norm(final)=2.805 | 1573.9 samples/s | 24.6 steps/s
[Step=14300 Epoch=136.3] | Loss=0.00085 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.417 | L2-Norm(final)=2.806 | 3284.4 samples/s | 51.3 steps/s
[Step=14350 Epoch=136.8] | Loss=0.00079 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.414 | L2-Norm(final)=2.807 | 1605.0 samples/s | 25.1 steps/s
[Step=14400 Epoch=137.2] | Loss=0.00075 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.411 | L2-Norm(final)=2.808 | 3338.6 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23540 | acc=0.8409 | tpr=0.7756 | fpr=0.0171 | 3574.6 samples/s | 14.0 steps/s
Avg test loss: 0.23674, Avg test acc: 0.84081, Avg tpr: 0.77671, Avg fpr: 0.01820, total FA: 142

Testing server on iccad2012
[Step=  50] | Loss=0.40114 | acc=0.8254 | tpr=0.9779 | fpr=0.1774 | 3364.1 samples/s | 13.1 steps/s
[Step= 100] | Loss=0.40549 | acc=0.8246 | tpr=0.9765 | fpr=0.1782 | 7034.7 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.41020 | acc=0.8230 | tpr=0.9813 | fpr=0.1799 | 6629.2 samples/s | 25.9 steps/s
[Step= 200] | Loss=0.40961 | acc=0.8234 | tpr=0.9803 | fpr=0.1795 | 6732.9 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.40926 | acc=0.8238 | tpr=0.9817 | fpr=0.1791 | 7124.6 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.40802 | acc=0.8241 | tpr=0.9782 | fpr=0.1787 | 6351.4 samples/s | 24.8 steps/s
[Step= 350] | Loss=0.40937 | acc=0.8240 | tpr=0.9768 | fpr=0.1788 | 6154.1 samples/s | 24.0 steps/s
[Step= 400] | Loss=0.40993 | acc=0.8239 | tpr=0.9748 | fpr=0.1789 | 6699.0 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.41293 | acc=0.8232 | tpr=0.9737 | fpr=0.1795 | 6750.2 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.41418 | acc=0.8226 | tpr=0.9744 | fpr=0.1801 | 6768.6 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.41333 | acc=0.8230 | tpr=0.9749 | fpr=0.1798 | 13159.5 samples/s | 51.4 steps/s
Avg test loss: 0.41323, Avg test acc: 0.82295, Avg tpr: 0.97504, Avg fpr: 0.17982, total FA: 24967

server round 18/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.2] | Loss=0.17512 | Reg=0.00339 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.415 | L2-Norm(final)=2.822 | 3584.8 samples/s | 56.0 steps/s
[Step=14450 Epoch=70.5] | Loss=0.03169 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.391 | L2-Norm(final)=2.799 | 3367.2 samples/s | 52.6 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02575 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.390 | L2-Norm(final)=2.802 | 3498.3 samples/s | 54.7 steps/s
[Step=14550 Epoch=70.9] | Loss=0.02618 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.393 | L2-Norm(final)=2.802 | 3522.3 samples/s | 55.0 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02518 | Reg=0.00338 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.397 | L2-Norm(final)=2.801 | 4375.1 samples/s | 68.4 steps/s
[Step=14650 Epoch=71.4] | Loss=0.02262 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.402 | L2-Norm(final)=2.803 | 1566.0 samples/s | 24.5 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01997 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.406 | L2-Norm(final)=2.807 | 3548.9 samples/s | 55.5 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01902 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.409 | L2-Norm(final)=2.811 | 3542.3 samples/s | 55.3 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01774 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.412 | L2-Norm(final)=2.815 | 4161.4 samples/s | 65.0 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01700 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.414 | L2-Norm(final)=2.819 | 1601.6 samples/s | 25.0 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01637 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.416 | L2-Norm(final)=2.822 | 3506.8 samples/s | 54.8 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01575 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.418 | L2-Norm(final)=2.824 | 3513.4 samples/s | 54.9 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01545 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.420 | L2-Norm(final)=2.826 | 3940.4 samples/s | 61.6 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01488 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.421 | L2-Norm(final)=2.828 | 1630.0 samples/s | 25.5 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01426 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.423 | L2-Norm(final)=2.830 | 3525.8 samples/s | 55.1 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01368 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.424 | L2-Norm(final)=2.832 | 3514.2 samples/s | 54.9 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01355 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.424 | L2-Norm(final)=2.834 | 3748.0 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step15200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.3] | Loss=0.09991 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.415 | L2-Norm(final)=2.824 | 3822.4 samples/s | 59.7 steps/s
[Step=14450 Epoch=70.5] | Loss=0.03130 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.387 | L2-Norm(final)=2.808 | 3276.6 samples/s | 51.2 steps/s
[Step=14500 Epoch=70.8] | Loss=0.02590 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=18.386 | L2-Norm(final)=2.803 | 3525.8 samples/s | 55.1 steps/s
[Step=14550 Epoch=71.0] | Loss=0.02322 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.389 | L2-Norm(final)=2.801 | 3533.6 samples/s | 55.2 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02128 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.393 | L2-Norm(final)=2.804 | 4382.0 samples/s | 68.5 steps/s
[Step=14650 Epoch=71.5] | Loss=0.01919 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.397 | L2-Norm(final)=2.807 | 1568.7 samples/s | 24.5 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01856 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.400 | L2-Norm(final)=2.810 | 3577.7 samples/s | 55.9 steps/s
[Step=14750 Epoch=72.0] | Loss=0.01727 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.403 | L2-Norm(final)=2.813 | 3530.9 samples/s | 55.2 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01665 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.406 | L2-Norm(final)=2.815 | 4177.1 samples/s | 65.3 steps/s
[Step=14850 Epoch=72.5] | Loss=0.01589 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.408 | L2-Norm(final)=2.817 | 1583.3 samples/s | 24.7 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01516 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.409 | L2-Norm(final)=2.819 | 3523.7 samples/s | 55.1 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01489 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.410 | L2-Norm(final)=2.820 | 3512.8 samples/s | 54.9 steps/s
[Step=15000 Epoch=73.2] | Loss=0.01428 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.411 | L2-Norm(final)=2.821 | 4008.4 samples/s | 62.6 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01349 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.413 | L2-Norm(final)=2.823 | 1608.0 samples/s | 25.1 steps/s
[Step=15100 Epoch=73.7] | Loss=0.01278 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.414 | L2-Norm(final)=2.825 | 3512.9 samples/s | 54.9 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01255 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.415 | L2-Norm(final)=2.828 | 3517.6 samples/s | 55.0 steps/s
[Step=15200 Epoch=74.2] | Loss=0.01244 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.415 | L2-Norm(final)=2.829 | 3858.2 samples/s | 60.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step15200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.2] | Loss=0.05890 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.415 | L2-Norm(final)=2.824 | 3825.2 samples/s | 59.8 steps/s
[Step=14450 Epoch=70.4] | Loss=0.02771 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.393 | L2-Norm(final)=2.821 | 3260.9 samples/s | 51.0 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02323 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.390 | L2-Norm(final)=2.820 | 3542.6 samples/s | 55.4 steps/s
[Step=14550 Epoch=70.9] | Loss=0.02322 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.393 | L2-Norm(final)=2.820 | 3534.2 samples/s | 55.2 steps/s
[Step=14600 Epoch=71.1] | Loss=0.02227 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.396 | L2-Norm(final)=2.819 | 4360.0 samples/s | 68.1 steps/s
[Step=14650 Epoch=71.4] | Loss=0.01966 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.398 | L2-Norm(final)=2.820 | 1583.6 samples/s | 24.7 steps/s
[Step=14700 Epoch=71.6] | Loss=0.01872 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.401 | L2-Norm(final)=2.823 | 3515.1 samples/s | 54.9 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01759 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=2.825 | 3508.2 samples/s | 54.8 steps/s
[Step=14800 Epoch=72.1] | Loss=0.01703 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.407 | L2-Norm(final)=2.827 | 4122.1 samples/s | 64.4 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01622 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.409 | L2-Norm(final)=2.829 | 1602.2 samples/s | 25.0 steps/s
[Step=14900 Epoch=72.6] | Loss=0.01536 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.411 | L2-Norm(final)=2.831 | 3508.2 samples/s | 54.8 steps/s
[Step=14950 Epoch=72.8] | Loss=0.01446 | Reg=0.00339 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.412 | L2-Norm(final)=2.834 | 3514.4 samples/s | 54.9 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01439 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.413 | L2-Norm(final)=2.836 | 3943.4 samples/s | 61.6 steps/s
[Step=15050 Epoch=73.3] | Loss=0.01412 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.414 | L2-Norm(final)=2.837 | 1653.6 samples/s | 25.8 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01364 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.415 | L2-Norm(final)=2.839 | 3605.4 samples/s | 56.3 steps/s
[Step=15150 Epoch=73.8] | Loss=0.01326 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.416 | L2-Norm(final)=2.841 | 3511.2 samples/s | 54.9 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01294 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.417 | L2-Norm(final)=2.843 | 3735.8 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step15200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.2] | Loss=0.23982 | Reg=0.00339 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.415 | L2-Norm(final)=2.822 | 3732.6 samples/s | 58.3 steps/s
[Step=14450 Epoch=70.5] | Loss=0.03639 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.395 | L2-Norm(final)=2.797 | 3427.5 samples/s | 53.6 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02848 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.395 | L2-Norm(final)=2.796 | 3527.3 samples/s | 55.1 steps/s
[Step=14550 Epoch=71.0] | Loss=0.02600 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.396 | L2-Norm(final)=2.796 | 3534.7 samples/s | 55.2 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02456 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.399 | L2-Norm(final)=2.797 | 4387.6 samples/s | 68.6 steps/s
[Step=14650 Epoch=71.4] | Loss=0.02218 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.403 | L2-Norm(final)=2.798 | 1569.5 samples/s | 24.5 steps/s
[Step=14700 Epoch=71.7] | Loss=0.02022 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.406 | L2-Norm(final)=2.801 | 3510.0 samples/s | 54.8 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01880 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.410 | L2-Norm(final)=2.804 | 3524.1 samples/s | 55.1 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01808 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.412 | L2-Norm(final)=2.807 | 4143.4 samples/s | 64.7 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01690 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.414 | L2-Norm(final)=2.810 | 1586.8 samples/s | 24.8 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01617 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.416 | L2-Norm(final)=2.813 | 3517.1 samples/s | 55.0 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01547 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.417 | L2-Norm(final)=2.815 | 3532.3 samples/s | 55.2 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01498 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.418 | L2-Norm(final)=2.817 | 3952.8 samples/s | 61.8 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01440 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.419 | L2-Norm(final)=2.819 | 1634.5 samples/s | 25.5 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01393 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.420 | L2-Norm(final)=2.822 | 3518.3 samples/s | 55.0 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01359 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.420 | L2-Norm(final)=2.823 | 3534.0 samples/s | 55.2 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01320 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.421 | L2-Norm(final)=2.825 | 3773.4 samples/s | 59.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step15200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.6] | Loss=0.14781 | Reg=0.00339 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.415 | L2-Norm(final)=2.823 | 3616.1 samples/s | 56.5 steps/s
[Step=14450 Epoch=70.9] | Loss=0.03776 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.417 | L2-Norm(final)=2.798 | 3441.1 samples/s | 53.8 steps/s
[Step=14500 Epoch=71.1] | Loss=0.03039 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.410 | L2-Norm(final)=2.788 | 3528.9 samples/s | 55.1 steps/s
[Step=14550 Epoch=71.4] | Loss=0.02772 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.407 | L2-Norm(final)=2.786 | 3521.4 samples/s | 55.0 steps/s
[Step=14600 Epoch=71.6] | Loss=0.02476 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.406 | L2-Norm(final)=2.786 | 4409.6 samples/s | 68.9 steps/s
[Step=14650 Epoch=71.8] | Loss=0.02221 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.408 | L2-Norm(final)=2.788 | 1551.9 samples/s | 24.2 steps/s
[Step=14700 Epoch=72.1] | Loss=0.02001 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.411 | L2-Norm(final)=2.792 | 3724.6 samples/s | 58.2 steps/s
[Step=14750 Epoch=72.3] | Loss=0.01855 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.414 | L2-Norm(final)=2.797 | 3517.1 samples/s | 55.0 steps/s
[Step=14800 Epoch=72.6] | Loss=0.01799 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.416 | L2-Norm(final)=2.800 | 4252.9 samples/s | 66.5 steps/s
[Step=14850 Epoch=72.8] | Loss=0.01665 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.417 | L2-Norm(final)=2.803 | 1561.1 samples/s | 24.4 steps/s
[Step=14900 Epoch=73.1] | Loss=0.01558 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.419 | L2-Norm(final)=2.807 | 3524.4 samples/s | 55.1 steps/s
[Step=14950 Epoch=73.3] | Loss=0.01500 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.419 | L2-Norm(final)=2.811 | 3532.5 samples/s | 55.2 steps/s
[Step=15000 Epoch=73.6] | Loss=0.01447 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.420 | L2-Norm(final)=2.814 | 4122.9 samples/s | 64.4 steps/s
[Step=15050 Epoch=73.8] | Loss=0.01376 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.421 | L2-Norm(final)=2.817 | 1583.2 samples/s | 24.7 steps/s
[Step=15100 Epoch=74.0] | Loss=0.01325 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.422 | L2-Norm(final)=2.820 | 3632.3 samples/s | 56.8 steps/s
[Step=15150 Epoch=74.3] | Loss=0.01277 | Reg=0.00339 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.422 | L2-Norm(final)=2.823 | 3525.2 samples/s | 55.1 steps/s
[Step=15200 Epoch=74.5] | Loss=0.01253 | Reg=0.00339 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.423 | L2-Norm(final)=2.825 | 3974.8 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step15200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=136.5] | Loss=0.08960 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.415 | L2-Norm(final)=2.824 | 3507.6 samples/s | 54.8 steps/s
[Step=14450 Epoch=136.9] | Loss=0.00664 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.391 | L2-Norm(final)=2.817 | 3311.8 samples/s | 51.7 steps/s
[Step=14500 Epoch=137.4] | Loss=0.00420 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.389 | L2-Norm(final)=2.818 | 4225.4 samples/s | 66.0 steps/s
[Step=14550 Epoch=137.9] | Loss=0.00286 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.384 | L2-Norm(final)=2.819 | 1514.1 samples/s | 23.7 steps/s
[Step=14600 Epoch=138.3] | Loss=0.00216 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.379 | L2-Norm(final)=2.821 | 3979.2 samples/s | 62.2 steps/s
[Step=14650 Epoch=138.8] | Loss=0.00173 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.374 | L2-Norm(final)=2.823 | 1559.2 samples/s | 24.4 steps/s
[Step=14700 Epoch=139.3] | Loss=0.00145 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.368 | L2-Norm(final)=2.824 | 3774.6 samples/s | 59.0 steps/s
[Step=14750 Epoch=139.8] | Loss=0.00124 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.364 | L2-Norm(final)=2.825 | 1589.0 samples/s | 24.8 steps/s
[Step=14800 Epoch=140.2] | Loss=0.00109 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.360 | L2-Norm(final)=2.826 | 3601.1 samples/s | 56.3 steps/s
[Step=14850 Epoch=140.7] | Loss=0.00097 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.356 | L2-Norm(final)=2.826 | 1614.0 samples/s | 25.2 steps/s
[Step=14900 Epoch=141.2] | Loss=0.00087 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.352 | L2-Norm(final)=2.827 | 3423.8 samples/s | 53.5 steps/s
[Step=14950 Epoch=141.7] | Loss=0.00080 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.349 | L2-Norm(final)=2.828 | 1642.0 samples/s | 25.7 steps/s
[Step=15000 Epoch=142.1] | Loss=0.00073 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.345 | L2-Norm(final)=2.828 | 3370.4 samples/s | 52.7 steps/s
[Step=15050 Epoch=142.6] | Loss=0.00068 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.343 | L2-Norm(final)=2.829 | 1678.1 samples/s | 26.2 steps/s
[Step=15100 Epoch=143.1] | Loss=0.00063 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.340 | L2-Norm(final)=2.829 | 3418.6 samples/s | 53.4 steps/s
[Step=15150 Epoch=143.6] | Loss=0.00059 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.337 | L2-Norm(final)=2.830 | 1659.4 samples/s | 25.9 steps/s
[Step=15200 Epoch=144.0] | Loss=0.00055 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.335 | L2-Norm(final)=2.830 | 3360.3 samples/s | 52.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step15200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=137.0] | Loss=0.12309 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.415 | L2-Norm(final)=2.823 | 3603.8 samples/s | 56.3 steps/s
[Step=14450 Epoch=137.5] | Loss=0.01272 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.376 | L2-Norm(final)=2.804 | 3202.3 samples/s | 50.0 steps/s
[Step=14500 Epoch=137.9] | Loss=0.00660 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.380 | L2-Norm(final)=2.811 | 4254.6 samples/s | 66.5 steps/s
[Step=14550 Epoch=138.4] | Loss=0.00442 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.379 | L2-Norm(final)=2.817 | 1522.4 samples/s | 23.8 steps/s
[Step=14600 Epoch=138.9] | Loss=0.00336 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.375 | L2-Norm(final)=2.821 | 3984.3 samples/s | 62.3 steps/s
[Step=14650 Epoch=139.4] | Loss=0.00270 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.371 | L2-Norm(final)=2.824 | 1544.1 samples/s | 24.1 steps/s
[Step=14700 Epoch=139.8] | Loss=0.00226 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=2.826 | 3744.5 samples/s | 58.5 steps/s
[Step=14750 Epoch=140.3] | Loss=0.00194 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.363 | L2-Norm(final)=2.827 | 1516.9 samples/s | 23.7 steps/s
[Step=14800 Epoch=140.8] | Loss=0.00170 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.360 | L2-Norm(final)=2.828 | 3244.0 samples/s | 50.7 steps/s
[Step=14850 Epoch=141.3] | Loss=0.00151 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.356 | L2-Norm(final)=2.829 | 1483.6 samples/s | 23.2 steps/s
[Step=14900 Epoch=141.7] | Loss=0.00136 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.353 | L2-Norm(final)=2.830 | 3111.6 samples/s | 48.6 steps/s
[Step=14950 Epoch=142.2] | Loss=0.00124 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.350 | L2-Norm(final)=2.831 | 1507.7 samples/s | 23.6 steps/s
[Step=15000 Epoch=142.7] | Loss=0.00114 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.347 | L2-Norm(final)=2.832 | 3388.1 samples/s | 52.9 steps/s
[Step=15050 Epoch=143.2] | Loss=0.00106 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.344 | L2-Norm(final)=2.832 | 1675.8 samples/s | 26.2 steps/s
[Step=15100 Epoch=143.6] | Loss=0.00098 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.341 | L2-Norm(final)=2.833 | 3336.9 samples/s | 52.1 steps/s
[Step=15150 Epoch=144.1] | Loss=0.00092 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.339 | L2-Norm(final)=2.834 | 1690.3 samples/s | 26.4 steps/s
[Step=15200 Epoch=144.6] | Loss=0.00086 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.337 | L2-Norm(final)=2.834 | 3340.4 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step15200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=137.5] | Loss=0.05830 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.415 | L2-Norm(final)=2.824 | 3538.9 samples/s | 55.3 steps/s
[Step=14450 Epoch=138.0] | Loss=0.00617 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.379 | L2-Norm(final)=2.833 | 3186.1 samples/s | 49.8 steps/s
[Step=14500 Epoch=138.5] | Loss=0.00332 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.381 | L2-Norm(final)=2.838 | 4228.7 samples/s | 66.1 steps/s
[Step=14550 Epoch=138.9] | Loss=0.00224 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.378 | L2-Norm(final)=2.842 | 1518.0 samples/s | 23.7 steps/s
[Step=14600 Epoch=139.4] | Loss=0.00171 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.374 | L2-Norm(final)=2.845 | 4033.7 samples/s | 63.0 steps/s
[Step=14650 Epoch=139.9] | Loss=0.00137 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.370 | L2-Norm(final)=2.846 | 1532.5 samples/s | 23.9 steps/s
[Step=14700 Epoch=140.4] | Loss=0.00114 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.366 | L2-Norm(final)=2.847 | 3842.2 samples/s | 60.0 steps/s
[Step=14750 Epoch=140.9] | Loss=0.00098 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.362 | L2-Norm(final)=2.847 | 1565.6 samples/s | 24.5 steps/s
[Step=14800 Epoch=141.3] | Loss=0.00086 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.358 | L2-Norm(final)=2.847 | 3679.3 samples/s | 57.5 steps/s
[Step=14850 Epoch=141.8] | Loss=0.00077 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.355 | L2-Norm(final)=2.847 | 1601.4 samples/s | 25.0 steps/s
[Step=14900 Epoch=142.3] | Loss=0.00069 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.352 | L2-Norm(final)=2.847 | 3555.1 samples/s | 55.5 steps/s
[Step=14950 Epoch=142.8] | Loss=0.00063 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.348 | L2-Norm(final)=2.847 | 1627.6 samples/s | 25.4 steps/s
[Step=15000 Epoch=143.2] | Loss=0.00058 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.345 | L2-Norm(final)=2.847 | 3446.7 samples/s | 53.9 steps/s
[Step=15050 Epoch=143.7] | Loss=0.00054 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.342 | L2-Norm(final)=2.847 | 1639.4 samples/s | 25.6 steps/s
[Step=15100 Epoch=144.2] | Loss=0.00050 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.340 | L2-Norm(final)=2.847 | 3385.6 samples/s | 52.9 steps/s
[Step=15150 Epoch=144.7] | Loss=0.00047 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.337 | L2-Norm(final)=2.847 | 1654.6 samples/s | 25.9 steps/s
[Step=15200 Epoch=145.2] | Loss=0.00044 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.335 | L2-Norm(final)=2.847 | 3373.6 samples/s | 52.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step15200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=135.7] | Loss=0.09537 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.415 | L2-Norm(final)=2.824 | 3585.7 samples/s | 56.0 steps/s
[Step=14450 Epoch=136.2] | Loss=0.01089 | Reg=0.00338 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.390 | L2-Norm(final)=2.802 | 3220.4 samples/s | 50.3 steps/s
[Step=14500 Epoch=136.6] | Loss=0.00641 | Reg=0.00338 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.389 | L2-Norm(final)=2.803 | 4214.8 samples/s | 65.9 steps/s
[Step=14550 Epoch=137.1] | Loss=0.00441 | Reg=0.00338 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.386 | L2-Norm(final)=2.804 | 1525.7 samples/s | 23.8 steps/s
[Step=14600 Epoch=137.6] | Loss=0.00333 | Reg=0.00338 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.381 | L2-Norm(final)=2.806 | 3902.3 samples/s | 61.0 steps/s
[Step=14650 Epoch=138.0] | Loss=0.00267 | Reg=0.00338 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.377 | L2-Norm(final)=2.808 | 1572.9 samples/s | 24.6 steps/s
[Step=14700 Epoch=138.5] | Loss=0.00223 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.372 | L2-Norm(final)=2.810 | 3664.6 samples/s | 57.3 steps/s
[Step=14750 Epoch=139.0] | Loss=0.00191 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.368 | L2-Norm(final)=2.812 | 1596.5 samples/s | 24.9 steps/s
[Step=14800 Epoch=139.5] | Loss=0.00168 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.364 | L2-Norm(final)=2.813 | 3487.6 samples/s | 54.5 steps/s
[Step=14850 Epoch=139.9] | Loss=0.00149 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.361 | L2-Norm(final)=2.814 | 1620.8 samples/s | 25.3 steps/s
[Step=14900 Epoch=140.4] | Loss=0.00135 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.357 | L2-Norm(final)=2.815 | 3370.4 samples/s | 52.7 steps/s
[Step=14950 Epoch=140.9] | Loss=0.00122 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.354 | L2-Norm(final)=2.816 | 1667.5 samples/s | 26.1 steps/s
[Step=15000 Epoch=141.3] | Loss=0.00112 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.351 | L2-Norm(final)=2.817 | 3375.3 samples/s | 52.7 steps/s
[Step=15050 Epoch=141.8] | Loss=0.00104 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.348 | L2-Norm(final)=2.818 | 1688.4 samples/s | 26.4 steps/s
[Step=15100 Epoch=142.3] | Loss=0.00097 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.345 | L2-Norm(final)=2.819 | 3351.8 samples/s | 52.4 steps/s
[Step=15150 Epoch=142.8] | Loss=0.00090 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.343 | L2-Norm(final)=2.819 | 1785.2 samples/s | 27.9 steps/s
[Step=15200 Epoch=143.2] | Loss=0.00085 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.340 | L2-Norm(final)=2.820 | 3016.8 samples/s | 47.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step15200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=137.3] | Loss=0.11989 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.415 | L2-Norm(final)=2.824 | 3480.7 samples/s | 54.4 steps/s
[Step=14450 Epoch=137.7] | Loss=0.01440 | Reg=0.00339 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.416 | L2-Norm(final)=2.804 | 3288.7 samples/s | 51.4 steps/s
[Step=14500 Epoch=138.2] | Loss=0.00830 | Reg=0.00339 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=18.419 | L2-Norm(final)=2.801 | 4253.2 samples/s | 66.5 steps/s
[Step=14550 Epoch=138.7] | Loss=0.00561 | Reg=0.00339 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.415 | L2-Norm(final)=2.806 | 1512.9 samples/s | 23.6 steps/s
[Step=14600 Epoch=139.2] | Loss=0.00422 | Reg=0.00339 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.410 | L2-Norm(final)=2.810 | 4047.3 samples/s | 63.2 steps/s
[Step=14650 Epoch=139.6] | Loss=0.00338 | Reg=0.00339 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=2.812 | 1551.2 samples/s | 24.2 steps/s
[Step=14700 Epoch=140.1] | Loss=0.00282 | Reg=0.00338 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.398 | L2-Norm(final)=2.815 | 3844.6 samples/s | 60.1 steps/s
[Step=14750 Epoch=140.6] | Loss=0.00242 | Reg=0.00338 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.393 | L2-Norm(final)=2.816 | 1574.9 samples/s | 24.6 steps/s
[Step=14800 Epoch=141.1] | Loss=0.00212 | Reg=0.00338 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.388 | L2-Norm(final)=2.818 | 3634.3 samples/s | 56.8 steps/s
[Step=14850 Epoch=141.5] | Loss=0.00189 | Reg=0.00338 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.383 | L2-Norm(final)=2.819 | 1598.2 samples/s | 25.0 steps/s
[Step=14900 Epoch=142.0] | Loss=0.00170 | Reg=0.00338 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.378 | L2-Norm(final)=2.820 | 3534.9 samples/s | 55.2 steps/s
[Step=14950 Epoch=142.5] | Loss=0.00155 | Reg=0.00338 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.374 | L2-Norm(final)=2.821 | 1626.4 samples/s | 25.4 steps/s
[Step=15000 Epoch=143.0] | Loss=0.00142 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.370 | L2-Norm(final)=2.822 | 3416.6 samples/s | 53.4 steps/s
[Step=15050 Epoch=143.4] | Loss=0.00131 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=2.823 | 1646.9 samples/s | 25.7 steps/s
[Step=15100 Epoch=143.9] | Loss=0.00122 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.363 | L2-Norm(final)=2.824 | 3388.1 samples/s | 52.9 steps/s
[Step=15150 Epoch=144.4] | Loss=0.00114 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.360 | L2-Norm(final)=2.824 | 1661.6 samples/s | 26.0 steps/s
[Step=15200 Epoch=144.9] | Loss=0.00107 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.357 | L2-Norm(final)=2.825 | 3363.3 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23339 | acc=0.8440 | tpr=0.7798 | fpr=0.0166 | 3616.0 samples/s | 14.1 steps/s
Avg test loss: 0.23531, Avg test acc: 0.84326, Avg tpr: 0.77951, Avg fpr: 0.01654, total FA: 129

Testing server on iccad2012
[Step=  50] | Loss=0.42412 | acc=0.8163 | tpr=0.9690 | fpr=0.1865 | 3682.4 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.42872 | acc=0.8169 | tpr=0.9701 | fpr=0.1859 | 6679.6 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.43380 | acc=0.8158 | tpr=0.9755 | fpr=0.1872 | 6908.9 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.43338 | acc=0.8160 | tpr=0.9749 | fpr=0.1869 | 6900.1 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.43306 | acc=0.8166 | tpr=0.9764 | fpr=0.1863 | 7279.1 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.43175 | acc=0.8172 | tpr=0.9731 | fpr=0.1857 | 6588.7 samples/s | 25.7 steps/s
[Step= 350] | Loss=0.43303 | acc=0.8170 | tpr=0.9718 | fpr=0.1858 | 6865.3 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.43359 | acc=0.8171 | tpr=0.9694 | fpr=0.1857 | 6915.5 samples/s | 27.0 steps/s
[Step= 450] | Loss=0.43674 | acc=0.8163 | tpr=0.9688 | fpr=0.1865 | 6723.1 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.43802 | acc=0.8158 | tpr=0.9700 | fpr=0.1870 | 6669.7 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.43710 | acc=0.8162 | tpr=0.9706 | fpr=0.1866 | 12823.1 samples/s | 50.1 steps/s
Avg test loss: 0.43701, Avg test acc: 0.81624, Avg tpr: 0.97068, Avg fpr: 0.18657, total FA: 25905

server round 19/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.1] | Loss=0.10920 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.334 | L2-Norm(final)=2.847 | 3536.6 samples/s | 55.3 steps/s
[Step=15250 Epoch=74.4] | Loss=0.03164 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.312 | L2-Norm(final)=2.833 | 3508.0 samples/s | 54.8 steps/s
[Step=15300 Epoch=74.6] | Loss=0.02544 | Reg=0.00335 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.312 | L2-Norm(final)=2.831 | 3515.7 samples/s | 54.9 steps/s
[Step=15350 Epoch=74.8] | Loss=0.02401 | Reg=0.00335 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.314 | L2-Norm(final)=2.833 | 3515.5 samples/s | 54.9 steps/s
[Step=15400 Epoch=75.1] | Loss=0.02422 | Reg=0.00335 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.316 | L2-Norm(final)=2.834 | 4352.7 samples/s | 68.0 steps/s
[Step=15450 Epoch=75.3] | Loss=0.02320 | Reg=0.00336 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.318 | L2-Norm(final)=2.833 | 1546.4 samples/s | 24.2 steps/s
[Step=15500 Epoch=75.6] | Loss=0.02107 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.321 | L2-Norm(final)=2.834 | 3525.7 samples/s | 55.1 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01971 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=2.836 | 3527.5 samples/s | 55.1 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01843 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.327 | L2-Norm(final)=2.839 | 4146.2 samples/s | 64.8 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01734 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.330 | L2-Norm(final)=2.842 | 1585.3 samples/s | 24.8 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01669 | Reg=0.00336 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.332 | L2-Norm(final)=2.845 | 3512.4 samples/s | 54.9 steps/s
[Step=15750 Epoch=76.8] | Loss=0.01606 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.333 | L2-Norm(final)=2.847 | 3509.4 samples/s | 54.8 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01552 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.335 | L2-Norm(final)=2.849 | 3932.5 samples/s | 61.4 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01491 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.336 | L2-Norm(final)=2.851 | 1620.8 samples/s | 25.3 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01419 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.338 | L2-Norm(final)=2.853 | 3528.8 samples/s | 55.1 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01376 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.339 | L2-Norm(final)=2.856 | 3515.5 samples/s | 54.9 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01344 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.340 | L2-Norm(final)=2.858 | 3770.9 samples/s | 58.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.2] | Loss=0.14380 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.334 | L2-Norm(final)=2.847 | 3640.3 samples/s | 56.9 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02663 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.313 | L2-Norm(final)=2.829 | 3413.9 samples/s | 53.3 steps/s
[Step=15300 Epoch=74.7] | Loss=0.02174 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.312 | L2-Norm(final)=2.830 | 3518.0 samples/s | 55.0 steps/s
[Step=15350 Epoch=74.9] | Loss=0.02058 | Reg=0.00335 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.313 | L2-Norm(final)=2.832 | 3511.9 samples/s | 54.9 steps/s
[Step=15400 Epoch=75.1] | Loss=0.02033 | Reg=0.00335 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.315 | L2-Norm(final)=2.830 | 4316.4 samples/s | 67.4 steps/s
[Step=15450 Epoch=75.4] | Loss=0.01885 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.319 | L2-Norm(final)=2.831 | 1570.8 samples/s | 24.5 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01756 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.322 | L2-Norm(final)=2.833 | 3527.6 samples/s | 55.1 steps/s
[Step=15550 Epoch=75.9] | Loss=0.01681 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=2.836 | 3528.6 samples/s | 55.1 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01604 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.327 | L2-Norm(final)=2.838 | 4184.7 samples/s | 65.4 steps/s
[Step=15650 Epoch=76.4] | Loss=0.01492 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.329 | L2-Norm(final)=2.841 | 1592.0 samples/s | 24.9 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01413 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.331 | L2-Norm(final)=2.844 | 3529.6 samples/s | 55.1 steps/s
[Step=15750 Epoch=76.9] | Loss=0.01378 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.332 | L2-Norm(final)=2.846 | 3495.1 samples/s | 54.6 steps/s
[Step=15800 Epoch=77.1] | Loss=0.01343 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.333 | L2-Norm(final)=2.848 | 4027.0 samples/s | 62.9 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01311 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.335 | L2-Norm(final)=2.850 | 1621.4 samples/s | 25.3 steps/s
[Step=15900 Epoch=77.6] | Loss=0.01279 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.336 | L2-Norm(final)=2.851 | 3525.2 samples/s | 55.1 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01236 | Reg=0.00336 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.337 | L2-Norm(final)=2.852 | 3538.1 samples/s | 55.3 steps/s
[Step=16000 Epoch=78.1] | Loss=0.01199 | Reg=0.00336 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.338 | L2-Norm(final)=2.854 | 3851.5 samples/s | 60.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step16000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.1] | Loss=0.10649 | Reg=0.00336 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.334 | L2-Norm(final)=2.847 | 3647.9 samples/s | 57.0 steps/s
[Step=15250 Epoch=74.3] | Loss=0.03053 | Reg=0.00335 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.313 | L2-Norm(final)=2.832 | 3371.7 samples/s | 52.7 steps/s
[Step=15300 Epoch=74.5] | Loss=0.02526 | Reg=0.00335 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.312 | L2-Norm(final)=2.829 | 3508.4 samples/s | 54.8 steps/s
[Step=15350 Epoch=74.8] | Loss=0.02410 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.314 | L2-Norm(final)=2.828 | 3500.8 samples/s | 54.7 steps/s
[Step=15400 Epoch=75.0] | Loss=0.02319 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.317 | L2-Norm(final)=2.826 | 4363.0 samples/s | 68.2 steps/s
[Step=15450 Epoch=75.3] | Loss=0.02054 | Reg=0.00336 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.320 | L2-Norm(final)=2.828 | 1574.4 samples/s | 24.6 steps/s
[Step=15500 Epoch=75.5] | Loss=0.01881 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=2.831 | 3514.7 samples/s | 54.9 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01801 | Reg=0.00336 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.326 | L2-Norm(final)=2.835 | 3503.4 samples/s | 54.7 steps/s
[Step=15600 Epoch=76.0] | Loss=0.01741 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.328 | L2-Norm(final)=2.838 | 4117.8 samples/s | 64.3 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01668 | Reg=0.00336 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.330 | L2-Norm(final)=2.840 | 1582.7 samples/s | 24.7 steps/s
[Step=15700 Epoch=76.5] | Loss=0.01599 | Reg=0.00336 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.331 | L2-Norm(final)=2.842 | 3500.6 samples/s | 54.7 steps/s
[Step=15750 Epoch=76.7] | Loss=0.01545 | Reg=0.00336 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.332 | L2-Norm(final)=2.845 | 3487.0 samples/s | 54.5 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01485 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.334 | L2-Norm(final)=2.847 | 3923.2 samples/s | 61.3 steps/s
[Step=15850 Epoch=77.2] | Loss=0.01416 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.335 | L2-Norm(final)=2.849 | 1621.8 samples/s | 25.3 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01366 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.336 | L2-Norm(final)=2.851 | 3504.1 samples/s | 54.8 steps/s
[Step=15950 Epoch=77.7] | Loss=0.01308 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.337 | L2-Norm(final)=2.854 | 3501.2 samples/s | 54.7 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01287 | Reg=0.00336 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.337 | L2-Norm(final)=2.856 | 3757.0 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step16000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.1] | Loss=0.17524 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.334 | L2-Norm(final)=2.846 | 3812.6 samples/s | 59.6 steps/s
[Step=15250 Epoch=74.4] | Loss=0.03072 | Reg=0.00335 | FP-Reg=0.001 | acc=0.9219 | L2-Norm=18.311 | L2-Norm(final)=2.834 | 3261.1 samples/s | 51.0 steps/s
[Step=15300 Epoch=74.6] | Loss=0.02799 | Reg=0.00335 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.314 | L2-Norm(final)=2.826 | 3503.2 samples/s | 54.7 steps/s
[Step=15350 Epoch=74.9] | Loss=0.02530 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.316 | L2-Norm(final)=2.825 | 3529.5 samples/s | 55.1 steps/s
[Step=15400 Epoch=75.1] | Loss=0.02411 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.319 | L2-Norm(final)=2.824 | 4353.2 samples/s | 68.0 steps/s
[Step=15450 Epoch=75.3] | Loss=0.02057 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.323 | L2-Norm(final)=2.826 | 1558.8 samples/s | 24.4 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01901 | Reg=0.00336 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.326 | L2-Norm(final)=2.830 | 3512.3 samples/s | 54.9 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01754 | Reg=0.00336 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.328 | L2-Norm(final)=2.834 | 3534.0 samples/s | 55.2 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01658 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.330 | L2-Norm(final)=2.837 | 4154.6 samples/s | 64.9 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01554 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.332 | L2-Norm(final)=2.840 | 1584.1 samples/s | 24.8 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01480 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.333 | L2-Norm(final)=2.843 | 3516.6 samples/s | 54.9 steps/s
[Step=15750 Epoch=76.8] | Loss=0.01400 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.334 | L2-Norm(final)=2.846 | 3524.4 samples/s | 55.1 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01370 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.334 | L2-Norm(final)=2.849 | 3932.2 samples/s | 61.4 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01326 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.335 | L2-Norm(final)=2.851 | 1637.7 samples/s | 25.6 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01266 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.335 | L2-Norm(final)=2.853 | 3501.7 samples/s | 54.7 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01227 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.336 | L2-Norm(final)=2.855 | 3506.3 samples/s | 54.8 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01185 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.336 | L2-Norm(final)=2.858 | 3748.7 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step16000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.5] | Loss=0.14806 | Reg=0.00336 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.334 | L2-Norm(final)=2.846 | 3599.2 samples/s | 56.2 steps/s
[Step=15250 Epoch=74.8] | Loss=0.02953 | Reg=0.00336 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.328 | L2-Norm(final)=2.824 | 3416.5 samples/s | 53.4 steps/s
[Step=15300 Epoch=75.0] | Loss=0.02545 | Reg=0.00336 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.329 | L2-Norm(final)=2.826 | 3516.7 samples/s | 54.9 steps/s
[Step=15350 Epoch=75.3] | Loss=0.02358 | Reg=0.00336 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=18.332 | L2-Norm(final)=2.826 | 3508.8 samples/s | 54.8 steps/s
[Step=15400 Epoch=75.5] | Loss=0.02376 | Reg=0.00336 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.335 | L2-Norm(final)=2.825 | 4408.0 samples/s | 68.9 steps/s
[Step=15450 Epoch=75.8] | Loss=0.02095 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.338 | L2-Norm(final)=2.827 | 1554.1 samples/s | 24.3 steps/s
[Step=15500 Epoch=76.0] | Loss=0.01876 | Reg=0.00336 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.341 | L2-Norm(final)=2.832 | 3527.0 samples/s | 55.1 steps/s
[Step=15550 Epoch=76.3] | Loss=0.01758 | Reg=0.00336 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.342 | L2-Norm(final)=2.836 | 3542.0 samples/s | 55.3 steps/s
[Step=15600 Epoch=76.5] | Loss=0.01648 | Reg=0.00336 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.343 | L2-Norm(final)=2.839 | 4252.2 samples/s | 66.4 steps/s
[Step=15650 Epoch=76.7] | Loss=0.01572 | Reg=0.00337 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.344 | L2-Norm(final)=2.842 | 1585.4 samples/s | 24.8 steps/s
[Step=15700 Epoch=77.0] | Loss=0.01477 | Reg=0.00337 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.344 | L2-Norm(final)=2.845 | 3559.5 samples/s | 55.6 steps/s
[Step=15750 Epoch=77.2] | Loss=0.01407 | Reg=0.00337 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.345 | L2-Norm(final)=2.848 | 3537.1 samples/s | 55.3 steps/s
[Step=15800 Epoch=77.5] | Loss=0.01367 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.345 | L2-Norm(final)=2.850 | 4107.7 samples/s | 64.2 steps/s
[Step=15850 Epoch=77.7] | Loss=0.01295 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.345 | L2-Norm(final)=2.853 | 1590.1 samples/s | 24.8 steps/s
[Step=15900 Epoch=78.0] | Loss=0.01256 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.345 | L2-Norm(final)=2.855 | 3509.1 samples/s | 54.8 steps/s
[Step=15950 Epoch=78.2] | Loss=0.01214 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.344 | L2-Norm(final)=2.858 | 3511.0 samples/s | 54.9 steps/s
[Step=16000 Epoch=78.5] | Loss=0.01186 | Reg=0.00337 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.344 | L2-Norm(final)=2.860 | 3971.9 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=144.0] | Loss=0.22707 | Reg=0.00336 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.334 | L2-Norm(final)=2.847 | 3587.4 samples/s | 56.1 steps/s
[Step=15250 Epoch=144.5] | Loss=0.01383 | Reg=0.00336 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.320 | L2-Norm(final)=2.832 | 3204.9 samples/s | 50.1 steps/s
[Step=15300 Epoch=145.0] | Loss=0.00715 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.316 | L2-Norm(final)=2.838 | 4270.6 samples/s | 66.7 steps/s
[Step=15350 Epoch=145.5] | Loss=0.00481 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.309 | L2-Norm(final)=2.844 | 1523.0 samples/s | 23.8 steps/s
[Step=15400 Epoch=145.9] | Loss=0.00362 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.302 | L2-Norm(final)=2.847 | 3980.7 samples/s | 62.2 steps/s
[Step=15450 Epoch=146.4] | Loss=0.00290 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.296 | L2-Norm(final)=2.849 | 1532.6 samples/s | 23.9 steps/s
[Step=15500 Epoch=146.9] | Loss=0.00242 | Reg=0.00335 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.290 | L2-Norm(final)=2.850 | 3768.4 samples/s | 58.9 steps/s
[Step=15550 Epoch=147.3] | Loss=0.00208 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.286 | L2-Norm(final)=2.851 | 1589.8 samples/s | 24.8 steps/s
[Step=15600 Epoch=147.8] | Loss=0.00182 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.281 | L2-Norm(final)=2.851 | 3559.1 samples/s | 55.6 steps/s
[Step=15650 Epoch=148.3] | Loss=0.00162 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.277 | L2-Norm(final)=2.852 | 1612.9 samples/s | 25.2 steps/s
[Step=15700 Epoch=148.8] | Loss=0.00146 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.273 | L2-Norm(final)=2.852 | 3401.6 samples/s | 53.1 steps/s
[Step=15750 Epoch=149.2] | Loss=0.00133 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.270 | L2-Norm(final)=2.853 | 1641.4 samples/s | 25.6 steps/s
[Step=15800 Epoch=149.7] | Loss=0.00122 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.267 | L2-Norm(final)=2.853 | 3363.6 samples/s | 52.6 steps/s
[Step=15850 Epoch=150.2] | Loss=0.00113 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.263 | L2-Norm(final)=2.854 | 1668.4 samples/s | 26.1 steps/s
[Step=15900 Epoch=150.7] | Loss=0.00105 | Reg=0.00333 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.261 | L2-Norm(final)=2.854 | 3336.5 samples/s | 52.1 steps/s
[Step=15950 Epoch=151.1] | Loss=0.00098 | Reg=0.00333 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.258 | L2-Norm(final)=2.854 | 1677.2 samples/s | 26.2 steps/s
[Step=16000 Epoch=151.6] | Loss=0.00092 | Reg=0.00333 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.255 | L2-Norm(final)=2.855 | 3349.8 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step16000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=144.6] | Loss=0.09545 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.334 | L2-Norm(final)=2.847 | 3621.5 samples/s | 56.6 steps/s
[Step=15250 Epoch=145.1] | Loss=0.01200 | Reg=0.00336 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.317 | L2-Norm(final)=2.835 | 3165.6 samples/s | 49.5 steps/s
[Step=15300 Epoch=145.5] | Loss=0.00625 | Reg=0.00336 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=2.843 | 4233.6 samples/s | 66.2 steps/s
[Step=15350 Epoch=146.0] | Loss=0.00422 | Reg=0.00336 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.321 | L2-Norm(final)=2.849 | 1501.5 samples/s | 23.5 steps/s
[Step=15400 Epoch=146.5] | Loss=0.00317 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.316 | L2-Norm(final)=2.852 | 3943.2 samples/s | 61.6 steps/s
[Step=15450 Epoch=147.0] | Loss=0.00254 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.310 | L2-Norm(final)=2.855 | 1535.8 samples/s | 24.0 steps/s
[Step=15500 Epoch=147.4] | Loss=0.00213 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.305 | L2-Norm(final)=2.856 | 3785.6 samples/s | 59.1 steps/s
[Step=15550 Epoch=147.9] | Loss=0.00183 | Reg=0.00335 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.300 | L2-Norm(final)=2.858 | 1591.7 samples/s | 24.9 steps/s
[Step=15600 Epoch=148.4] | Loss=0.00161 | Reg=0.00335 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.296 | L2-Norm(final)=2.859 | 3609.3 samples/s | 56.4 steps/s
[Step=15650 Epoch=148.9] | Loss=0.00143 | Reg=0.00335 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.291 | L2-Norm(final)=2.860 | 1595.9 samples/s | 24.9 steps/s
[Step=15700 Epoch=149.3] | Loss=0.00129 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.287 | L2-Norm(final)=2.861 | 3396.3 samples/s | 53.1 steps/s
[Step=15750 Epoch=149.8] | Loss=0.00118 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.284 | L2-Norm(final)=2.862 | 1639.5 samples/s | 25.6 steps/s
[Step=15800 Epoch=150.3] | Loss=0.00108 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.280 | L2-Norm(final)=2.863 | 3392.4 samples/s | 53.0 steps/s
[Step=15850 Epoch=150.8] | Loss=0.00100 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.277 | L2-Norm(final)=2.863 | 1675.2 samples/s | 26.2 steps/s
[Step=15900 Epoch=151.2] | Loss=0.00093 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.274 | L2-Norm(final)=2.864 | 3420.4 samples/s | 53.4 steps/s
[Step=15950 Epoch=151.7] | Loss=0.00087 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.271 | L2-Norm(final)=2.864 | 1690.1 samples/s | 26.4 steps/s
[Step=16000 Epoch=152.2] | Loss=0.00082 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.268 | L2-Norm(final)=2.865 | 3314.4 samples/s | 51.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step16000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=145.2] | Loss=0.24672 | Reg=0.00336 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.334 | L2-Norm(final)=2.847 | 3442.9 samples/s | 53.8 steps/s
[Step=15250 Epoch=145.6] | Loss=0.01094 | Reg=0.00336 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=2.837 | 3346.4 samples/s | 52.3 steps/s
[Step=15300 Epoch=146.1] | Loss=0.00638 | Reg=0.00336 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.329 | L2-Norm(final)=2.841 | 4269.2 samples/s | 66.7 steps/s
[Step=15350 Epoch=146.6] | Loss=0.00485 | Reg=0.00336 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.329 | L2-Norm(final)=2.843 | 1517.1 samples/s | 23.7 steps/s
[Step=15400 Epoch=147.1] | Loss=0.00368 | Reg=0.00336 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.327 | L2-Norm(final)=2.844 | 4053.4 samples/s | 63.3 steps/s
[Step=15450 Epoch=147.5] | Loss=0.00295 | Reg=0.00336 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.323 | L2-Norm(final)=2.846 | 1534.6 samples/s | 24.0 steps/s
[Step=15500 Epoch=148.0] | Loss=0.00246 | Reg=0.00336 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.318 | L2-Norm(final)=2.847 | 3882.2 samples/s | 60.7 steps/s
[Step=15550 Epoch=148.5] | Loss=0.00211 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.313 | L2-Norm(final)=2.847 | 1549.0 samples/s | 24.2 steps/s
[Step=15600 Epoch=149.0] | Loss=0.00185 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.309 | L2-Norm(final)=2.848 | 3713.5 samples/s | 58.0 steps/s
[Step=15650 Epoch=149.4] | Loss=0.00164 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.305 | L2-Norm(final)=2.848 | 1580.7 samples/s | 24.7 steps/s
[Step=15700 Epoch=149.9] | Loss=0.00148 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.301 | L2-Norm(final)=2.849 | 3565.1 samples/s | 55.7 steps/s
[Step=15750 Epoch=150.4] | Loss=0.00135 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.297 | L2-Norm(final)=2.849 | 1630.2 samples/s | 25.5 steps/s
[Step=15800 Epoch=150.9] | Loss=0.00124 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.293 | L2-Norm(final)=2.850 | 3399.7 samples/s | 53.1 steps/s
[Step=15850 Epoch=151.4] | Loss=0.00114 | Reg=0.00335 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.290 | L2-Norm(final)=2.850 | 1640.6 samples/s | 25.6 steps/s
[Step=15900 Epoch=151.8] | Loss=0.00106 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.286 | L2-Norm(final)=2.850 | 3369.6 samples/s | 52.7 steps/s
[Step=15950 Epoch=152.3] | Loss=0.00099 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.283 | L2-Norm(final)=2.851 | 1663.6 samples/s | 26.0 steps/s
[Step=16000 Epoch=152.8] | Loss=0.00093 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.280 | L2-Norm(final)=2.851 | 3387.1 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step16000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=143.2] | Loss=0.04355 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.334 | L2-Norm(final)=2.849 | 3434.1 samples/s | 53.7 steps/s
[Step=15250 Epoch=143.7] | Loss=0.00857 | Reg=0.00335 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.312 | L2-Norm(final)=2.849 | 3077.9 samples/s | 48.1 steps/s
[Step=15300 Epoch=144.2] | Loss=0.00560 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.311 | L2-Norm(final)=2.846 | 3796.1 samples/s | 59.3 steps/s
[Step=15350 Epoch=144.6] | Loss=0.00393 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.309 | L2-Norm(final)=2.846 | 1382.1 samples/s | 21.6 steps/s
[Step=15400 Epoch=145.1] | Loss=0.00296 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.306 | L2-Norm(final)=2.849 | 3772.6 samples/s | 58.9 steps/s
[Step=15450 Epoch=145.6] | Loss=0.00237 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.303 | L2-Norm(final)=2.851 | 1528.1 samples/s | 23.9 steps/s
[Step=15500 Epoch=146.1] | Loss=0.00198 | Reg=0.00335 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.299 | L2-Norm(final)=2.852 | 3661.2 samples/s | 57.2 steps/s
[Step=15550 Epoch=146.5] | Loss=0.00170 | Reg=0.00335 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.295 | L2-Norm(final)=2.853 | 1598.6 samples/s | 25.0 steps/s
[Step=15600 Epoch=147.0] | Loss=0.00149 | Reg=0.00335 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.291 | L2-Norm(final)=2.854 | 3443.0 samples/s | 53.8 steps/s
[Step=15650 Epoch=147.5] | Loss=0.00133 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.287 | L2-Norm(final)=2.855 | 1611.4 samples/s | 25.2 steps/s
[Step=15700 Epoch=147.9] | Loss=0.00120 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.284 | L2-Norm(final)=2.855 | 3365.0 samples/s | 52.6 steps/s
[Step=15750 Epoch=148.4] | Loss=0.00109 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.280 | L2-Norm(final)=2.856 | 1669.0 samples/s | 26.1 steps/s
[Step=15800 Epoch=148.9] | Loss=0.00100 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.277 | L2-Norm(final)=2.856 | 3378.6 samples/s | 52.8 steps/s
[Step=15850 Epoch=149.4] | Loss=0.00092 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.274 | L2-Norm(final)=2.857 | 1682.0 samples/s | 26.3 steps/s
[Step=15900 Epoch=149.8] | Loss=0.00086 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.271 | L2-Norm(final)=2.857 | 3339.9 samples/s | 52.2 steps/s
[Step=15950 Epoch=150.3] | Loss=0.00080 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.268 | L2-Norm(final)=2.857 | 1729.8 samples/s | 27.0 steps/s
[Step=16000 Epoch=150.8] | Loss=0.00075 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.266 | L2-Norm(final)=2.858 | 3144.7 samples/s | 49.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step16000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=144.9] | Loss=0.11824 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.334 | L2-Norm(final)=2.848 | 3647.5 samples/s | 57.0 steps/s
[Step=15250 Epoch=145.3] | Loss=0.01078 | Reg=0.00336 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=18.318 | L2-Norm(final)=2.839 | 3138.6 samples/s | 49.0 steps/s
[Step=15300 Epoch=145.8] | Loss=0.00710 | Reg=0.00336 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=2.838 | 4261.6 samples/s | 66.6 steps/s
[Step=15350 Epoch=146.3] | Loss=0.00484 | Reg=0.00336 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=2.840 | 1403.0 samples/s | 21.9 steps/s
[Step=15400 Epoch=146.8] | Loss=0.00365 | Reg=0.00336 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.321 | L2-Norm(final)=2.843 | 3856.5 samples/s | 60.3 steps/s
[Step=15450 Epoch=147.3] | Loss=0.00292 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.316 | L2-Norm(final)=2.844 | 1482.1 samples/s | 23.2 steps/s
[Step=15500 Epoch=147.7] | Loss=0.00244 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.311 | L2-Norm(final)=2.846 | 3773.7 samples/s | 59.0 steps/s
[Step=15550 Epoch=148.2] | Loss=0.00209 | Reg=0.00335 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.307 | L2-Norm(final)=2.847 | 1550.1 samples/s | 24.2 steps/s
[Step=15600 Epoch=148.7] | Loss=0.00184 | Reg=0.00335 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.302 | L2-Norm(final)=2.848 | 3661.7 samples/s | 57.2 steps/s
[Step=15650 Epoch=149.2] | Loss=0.00163 | Reg=0.00335 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.298 | L2-Norm(final)=2.849 | 1559.4 samples/s | 24.4 steps/s
[Step=15700 Epoch=149.6] | Loss=0.00147 | Reg=0.00335 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.294 | L2-Norm(final)=2.849 | 3525.3 samples/s | 55.1 steps/s
[Step=15750 Epoch=150.1] | Loss=0.00134 | Reg=0.00335 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.290 | L2-Norm(final)=2.850 | 1622.7 samples/s | 25.4 steps/s
[Step=15800 Epoch=150.6] | Loss=0.00123 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.287 | L2-Norm(final)=2.851 | 3417.9 samples/s | 53.4 steps/s
[Step=15850 Epoch=151.1] | Loss=0.00114 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.283 | L2-Norm(final)=2.851 | 1657.6 samples/s | 25.9 steps/s
[Step=15900 Epoch=151.5] | Loss=0.00106 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.280 | L2-Norm(final)=2.852 | 3373.6 samples/s | 52.7 steps/s
[Step=15950 Epoch=152.0] | Loss=0.00099 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.277 | L2-Norm(final)=2.852 | 1657.4 samples/s | 25.9 steps/s
[Step=16000 Epoch=152.5] | Loss=0.00093 | Reg=0.00334 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.274 | L2-Norm(final)=2.853 | 3380.1 samples/s | 52.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21984 | acc=0.8513 | tpr=0.7907 | fpr=0.0171 | 3604.3 samples/s | 14.1 steps/s
Avg test loss: 0.22044, Avg test acc: 0.85195, Avg tpr: 0.79280, Avg fpr: 0.01795, total FA: 140

Testing server on iccad2012
[Step=  50] | Loss=0.41389 | acc=0.8234 | tpr=0.9779 | fpr=0.1794 | 3636.4 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.42022 | acc=0.8223 | tpr=0.9765 | fpr=0.1806 | 6817.1 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.42535 | acc=0.8205 | tpr=0.9813 | fpr=0.1824 | 6908.3 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.42481 | acc=0.8210 | tpr=0.9792 | fpr=0.1819 | 6986.9 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.42488 | acc=0.8214 | tpr=0.9799 | fpr=0.1815 | 6698.7 samples/s | 26.2 steps/s
[Step= 300] | Loss=0.42343 | acc=0.8217 | tpr=0.9767 | fpr=0.1811 | 6881.1 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.42461 | acc=0.8220 | tpr=0.9756 | fpr=0.1808 | 6870.4 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.42557 | acc=0.8221 | tpr=0.9737 | fpr=0.1807 | 6806.2 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.42866 | acc=0.8215 | tpr=0.9732 | fpr=0.1812 | 6738.8 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.42996 | acc=0.8206 | tpr=0.9740 | fpr=0.1822 | 6932.9 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.42896 | acc=0.8209 | tpr=0.9745 | fpr=0.1819 | 12848.5 samples/s | 50.2 steps/s
Avg test loss: 0.42880, Avg test acc: 0.82094, Avg tpr: 0.97464, Avg fpr: 0.18185, total FA: 25250

server round 20/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.19794 | Reg=0.00333 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.254 | L2-Norm(final)=2.874 | 3592.0 samples/s | 56.1 steps/s
[Step=16050 Epoch=78.3] | Loss=0.02610 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.229 | L2-Norm(final)=2.864 | 3428.3 samples/s | 53.6 steps/s
[Step=16100 Epoch=78.5] | Loss=0.02278 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.219 | L2-Norm(final)=2.862 | 3521.7 samples/s | 55.0 steps/s
[Step=16150 Epoch=78.8] | Loss=0.01967 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.215 | L2-Norm(final)=2.862 | 3525.8 samples/s | 55.1 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01801 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=2.865 | 4377.9 samples/s | 68.4 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01541 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.869 | 1567.2 samples/s | 24.5 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01404 | Reg=0.00332 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.212 | L2-Norm(final)=2.873 | 3507.6 samples/s | 54.8 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01313 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.877 | 3499.9 samples/s | 54.7 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01242 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.880 | 4124.0 samples/s | 64.4 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01159 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.883 | 1589.5 samples/s | 24.8 steps/s
[Step=16500 Epoch=80.5] | Loss=0.01088 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.886 | 3510.3 samples/s | 54.8 steps/s
[Step=16550 Epoch=80.7] | Loss=0.01027 | Reg=0.00332 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.212 | L2-Norm(final)=2.889 | 3513.9 samples/s | 54.9 steps/s
[Step=16600 Epoch=80.9] | Loss=0.00995 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.892 | 3928.0 samples/s | 61.4 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00971 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.894 | 1638.8 samples/s | 25.6 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00938 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.896 | 3507.5 samples/s | 54.8 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00905 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.899 | 3504.5 samples/s | 54.8 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00868 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.901 | 3750.8 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step16800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.1] | Loss=0.07080 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.254 | L2-Norm(final)=2.874 | 3950.4 samples/s | 61.7 steps/s
[Step=16050 Epoch=78.3] | Loss=0.02671 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.229 | L2-Norm(final)=2.864 | 3239.3 samples/s | 50.6 steps/s
[Step=16100 Epoch=78.6] | Loss=0.02069 | Reg=0.00332 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.222 | L2-Norm(final)=2.864 | 3530.9 samples/s | 55.2 steps/s
[Step=16150 Epoch=78.8] | Loss=0.01755 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.218 | L2-Norm(final)=2.865 | 3538.7 samples/s | 55.3 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01568 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.868 | 4386.2 samples/s | 68.5 steps/s
[Step=16250 Epoch=79.3] | Loss=0.01388 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.215 | L2-Norm(final)=2.871 | 1554.3 samples/s | 24.3 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01241 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.214 | L2-Norm(final)=2.875 | 3528.1 samples/s | 55.1 steps/s
[Step=16350 Epoch=79.8] | Loss=0.01150 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.214 | L2-Norm(final)=2.878 | 3532.4 samples/s | 55.2 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01073 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=2.882 | 4192.5 samples/s | 65.5 steps/s
[Step=16450 Epoch=80.3] | Loss=0.01006 | Reg=0.00332 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.213 | L2-Norm(final)=2.885 | 1588.9 samples/s | 24.8 steps/s
[Step=16500 Epoch=80.5] | Loss=0.00952 | Reg=0.00332 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.213 | L2-Norm(final)=2.888 | 3532.2 samples/s | 55.2 steps/s
[Step=16550 Epoch=80.8] | Loss=0.00918 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=2.891 | 3533.0 samples/s | 55.2 steps/s
[Step=16600 Epoch=81.0] | Loss=0.00870 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=2.893 | 4009.7 samples/s | 62.7 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00843 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=2.896 | 1612.1 samples/s | 25.2 steps/s
[Step=16700 Epoch=81.5] | Loss=0.00808 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.898 | 3527.3 samples/s | 55.1 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00783 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.900 | 3534.5 samples/s | 55.2 steps/s
[Step=16800 Epoch=82.0] | Loss=0.00758 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.902 | 3850.7 samples/s | 60.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step16800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.14308 | Reg=0.00333 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.254 | L2-Norm(final)=2.874 | 3619.4 samples/s | 56.6 steps/s
[Step=16050 Epoch=78.2] | Loss=0.03130 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.227 | L2-Norm(final)=2.861 | 3428.4 samples/s | 53.6 steps/s
[Step=16100 Epoch=78.4] | Loss=0.02311 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.220 | L2-Norm(final)=2.862 | 3523.0 samples/s | 55.0 steps/s
[Step=16150 Epoch=78.7] | Loss=0.01929 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.217 | L2-Norm(final)=2.865 | 3535.2 samples/s | 55.2 steps/s
[Step=16200 Epoch=78.9] | Loss=0.01755 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.869 | 4363.2 samples/s | 68.2 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01538 | Reg=0.00332 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.216 | L2-Norm(final)=2.872 | 1565.4 samples/s | 24.5 steps/s
[Step=16300 Epoch=79.4] | Loss=0.01377 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.876 | 3517.8 samples/s | 55.0 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01275 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.880 | 3499.1 samples/s | 54.7 steps/s
[Step=16400 Epoch=79.9] | Loss=0.01210 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.884 | 4088.5 samples/s | 63.9 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01141 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.887 | 1585.3 samples/s | 24.8 steps/s
[Step=16500 Epoch=80.4] | Loss=0.01077 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.890 | 3492.5 samples/s | 54.6 steps/s
[Step=16550 Epoch=80.6] | Loss=0.01030 | Reg=0.00332 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.216 | L2-Norm(final)=2.893 | 3506.3 samples/s | 54.8 steps/s
[Step=16600 Epoch=80.9] | Loss=0.00988 | Reg=0.00332 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.216 | L2-Norm(final)=2.896 | 3920.4 samples/s | 61.3 steps/s
[Step=16650 Epoch=81.1] | Loss=0.00944 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.217 | L2-Norm(final)=2.898 | 1598.5 samples/s | 25.0 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00898 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.217 | L2-Norm(final)=2.901 | 3396.9 samples/s | 53.1 steps/s
[Step=16750 Epoch=81.6] | Loss=0.00874 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.217 | L2-Norm(final)=2.904 | 3387.6 samples/s | 52.9 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00848 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.217 | L2-Norm(final)=2.906 | 3726.8 samples/s | 58.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step16800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.14762 | Reg=0.00333 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.254 | L2-Norm(final)=2.874 | 3454.6 samples/s | 54.0 steps/s
[Step=16050 Epoch=78.3] | Loss=0.02564 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.233 | L2-Norm(final)=2.871 | 3464.1 samples/s | 54.1 steps/s
[Step=16100 Epoch=78.5] | Loss=0.02031 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.224 | L2-Norm(final)=2.870 | 3460.3 samples/s | 54.1 steps/s
[Step=16150 Epoch=78.8] | Loss=0.01795 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.219 | L2-Norm(final)=2.871 | 3472.6 samples/s | 54.3 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01621 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.218 | L2-Norm(final)=2.873 | 4341.1 samples/s | 67.8 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01432 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.217 | L2-Norm(final)=2.876 | 1559.9 samples/s | 24.4 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01276 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.879 | 3511.2 samples/s | 54.9 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01173 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.883 | 3527.3 samples/s | 55.1 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01093 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.887 | 4141.6 samples/s | 64.7 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01028 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.890 | 1587.1 samples/s | 24.8 steps/s
[Step=16500 Epoch=80.5] | Loss=0.00968 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.893 | 3521.0 samples/s | 55.0 steps/s
[Step=16550 Epoch=80.7] | Loss=0.00926 | Reg=0.00332 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.216 | L2-Norm(final)=2.897 | 3519.5 samples/s | 55.0 steps/s
[Step=16600 Epoch=81.0] | Loss=0.00884 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.899 | 3945.0 samples/s | 61.6 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00851 | Reg=0.00332 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.216 | L2-Norm(final)=2.902 | 1624.0 samples/s | 25.4 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00812 | Reg=0.00332 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.216 | L2-Norm(final)=2.904 | 3550.8 samples/s | 55.5 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00783 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.215 | L2-Norm(final)=2.907 | 3526.1 samples/s | 55.1 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00768 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.215 | L2-Norm(final)=2.909 | 3748.4 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step16800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.5] | Loss=0.18422 | Reg=0.00333 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.254 | L2-Norm(final)=2.874 | 3733.4 samples/s | 58.3 steps/s
[Step=16050 Epoch=78.7] | Loss=0.02406 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.229 | L2-Norm(final)=2.869 | 3346.2 samples/s | 52.3 steps/s
[Step=16100 Epoch=79.0] | Loss=0.02121 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.223 | L2-Norm(final)=2.870 | 3511.7 samples/s | 54.9 steps/s
[Step=16150 Epoch=79.2] | Loss=0.01913 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.220 | L2-Norm(final)=2.869 | 3533.5 samples/s | 55.2 steps/s
[Step=16200 Epoch=79.4] | Loss=0.01742 | Reg=0.00332 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=18.218 | L2-Norm(final)=2.871 | 4392.4 samples/s | 68.6 steps/s
[Step=16250 Epoch=79.7] | Loss=0.01492 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.217 | L2-Norm(final)=2.874 | 1553.7 samples/s | 24.3 steps/s
[Step=16300 Epoch=79.9] | Loss=0.01346 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.217 | L2-Norm(final)=2.877 | 3563.3 samples/s | 55.7 steps/s
[Step=16350 Epoch=80.2] | Loss=0.01221 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.880 | 3519.9 samples/s | 55.0 steps/s
[Step=16400 Epoch=80.4] | Loss=0.01150 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.884 | 4258.0 samples/s | 66.5 steps/s
[Step=16450 Epoch=80.7] | Loss=0.01069 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.887 | 1580.1 samples/s | 24.7 steps/s
[Step=16500 Epoch=80.9] | Loss=0.01015 | Reg=0.00332 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.216 | L2-Norm(final)=2.890 | 3515.3 samples/s | 54.9 steps/s
[Step=16550 Epoch=81.2] | Loss=0.00954 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.893 | 3500.9 samples/s | 54.7 steps/s
[Step=16600 Epoch=81.4] | Loss=0.00929 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.896 | 4109.4 samples/s | 64.2 steps/s
[Step=16650 Epoch=81.6] | Loss=0.00896 | Reg=0.00332 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.216 | L2-Norm(final)=2.899 | 1572.9 samples/s | 24.6 steps/s
[Step=16700 Epoch=81.9] | Loss=0.00860 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.901 | 3500.8 samples/s | 54.7 steps/s
[Step=16750 Epoch=82.1] | Loss=0.00831 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.903 | 3511.6 samples/s | 54.9 steps/s
[Step=16800 Epoch=82.4] | Loss=0.00802 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.906 | 3988.1 samples/s | 62.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step16800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=151.6] | Loss=0.03869 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.254 | L2-Norm(final)=2.875 | 3474.4 samples/s | 54.3 steps/s
[Step=16050 Epoch=152.1] | Loss=0.00732 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.206 | L2-Norm(final)=2.880 | 3305.1 samples/s | 51.6 steps/s
[Step=16100 Epoch=152.6] | Loss=0.00399 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.199 | L2-Norm(final)=2.885 | 4218.3 samples/s | 65.9 steps/s
[Step=16150 Epoch=153.0] | Loss=0.00269 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.193 | L2-Norm(final)=2.887 | 1518.2 samples/s | 23.7 steps/s
[Step=16200 Epoch=153.5] | Loss=0.00205 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.188 | L2-Norm(final)=2.889 | 3979.0 samples/s | 62.2 steps/s
[Step=16250 Epoch=154.0] | Loss=0.00164 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.184 | L2-Norm(final)=2.890 | 1541.5 samples/s | 24.1 steps/s
[Step=16300 Epoch=154.5] | Loss=0.00138 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.181 | L2-Norm(final)=2.891 | 3778.1 samples/s | 59.0 steps/s
[Step=16350 Epoch=154.9] | Loss=0.00118 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=2.891 | 1595.0 samples/s | 24.9 steps/s
[Step=16400 Epoch=155.4] | Loss=0.00104 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=2.892 | 3571.2 samples/s | 55.8 steps/s
[Step=16450 Epoch=155.9] | Loss=0.00093 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.173 | L2-Norm(final)=2.892 | 1612.8 samples/s | 25.2 steps/s
[Step=16500 Epoch=156.4] | Loss=0.00084 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.171 | L2-Norm(final)=2.892 | 3404.9 samples/s | 53.2 steps/s
[Step=16550 Epoch=156.8] | Loss=0.00076 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.169 | L2-Norm(final)=2.892 | 1616.9 samples/s | 25.3 steps/s
[Step=16600 Epoch=157.3] | Loss=0.00070 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.167 | L2-Norm(final)=2.893 | 3366.7 samples/s | 52.6 steps/s
[Step=16650 Epoch=157.8] | Loss=0.00065 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.165 | L2-Norm(final)=2.893 | 1685.1 samples/s | 26.3 steps/s
[Step=16700 Epoch=158.2] | Loss=0.00061 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.164 | L2-Norm(final)=2.893 | 3386.9 samples/s | 52.9 steps/s
[Step=16750 Epoch=158.7] | Loss=0.00057 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.162 | L2-Norm(final)=2.893 | 1664.4 samples/s | 26.0 steps/s
[Step=16800 Epoch=159.2] | Loss=0.00053 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.161 | L2-Norm(final)=2.893 | 3318.9 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step16800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=152.2] | Loss=0.11937 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.254 | L2-Norm(final)=2.875 | 3528.7 samples/s | 55.1 steps/s
[Step=16050 Epoch=152.7] | Loss=0.00772 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.211 | L2-Norm(final)=2.878 | 3213.4 samples/s | 50.2 steps/s
[Step=16100 Epoch=153.2] | Loss=0.00403 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.204 | L2-Norm(final)=2.884 | 4239.2 samples/s | 66.2 steps/s
[Step=16150 Epoch=153.6] | Loss=0.00271 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.198 | L2-Norm(final)=2.887 | 1515.0 samples/s | 23.7 steps/s
[Step=16200 Epoch=154.1] | Loss=0.00205 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.193 | L2-Norm(final)=2.889 | 3987.6 samples/s | 62.3 steps/s
[Step=16250 Epoch=154.6] | Loss=0.00165 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.189 | L2-Norm(final)=2.890 | 1543.9 samples/s | 24.1 steps/s
[Step=16300 Epoch=155.1] | Loss=0.00138 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.186 | L2-Norm(final)=2.891 | 3796.7 samples/s | 59.3 steps/s
[Step=16350 Epoch=155.5] | Loss=0.00119 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.183 | L2-Norm(final)=2.892 | 1558.3 samples/s | 24.3 steps/s
[Step=16400 Epoch=156.0] | Loss=0.00105 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.180 | L2-Norm(final)=2.893 | 3603.5 samples/s | 56.3 steps/s
[Step=16450 Epoch=156.5] | Loss=0.00093 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=2.893 | 1620.7 samples/s | 25.3 steps/s
[Step=16500 Epoch=157.0] | Loss=0.00084 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=2.894 | 3441.7 samples/s | 53.8 steps/s
[Step=16550 Epoch=157.4] | Loss=0.00077 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.173 | L2-Norm(final)=2.894 | 1636.4 samples/s | 25.6 steps/s
[Step=16600 Epoch=157.9] | Loss=0.00071 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.171 | L2-Norm(final)=2.894 | 3378.7 samples/s | 52.8 steps/s
[Step=16650 Epoch=158.4] | Loss=0.00066 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.170 | L2-Norm(final)=2.895 | 1667.5 samples/s | 26.1 steps/s
[Step=16700 Epoch=158.9] | Loss=0.00061 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.168 | L2-Norm(final)=2.895 | 3379.1 samples/s | 52.8 steps/s
[Step=16750 Epoch=159.3] | Loss=0.00057 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.166 | L2-Norm(final)=2.895 | 1676.6 samples/s | 26.2 steps/s
[Step=16800 Epoch=159.8] | Loss=0.00054 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.165 | L2-Norm(final)=2.895 | 3356.9 samples/s | 52.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step16800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=152.8] | Loss=0.16560 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.254 | L2-Norm(final)=2.874 | 3264.8 samples/s | 51.0 steps/s
[Step=16050 Epoch=153.3] | Loss=0.00864 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.879 | 1774.9 samples/s | 27.7 steps/s
[Step=16100 Epoch=153.7] | Loss=0.00455 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.208 | L2-Norm(final)=2.883 | 3948.3 samples/s | 61.7 steps/s
[Step=16150 Epoch=154.2] | Loss=0.00307 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.202 | L2-Norm(final)=2.885 | 1491.3 samples/s | 23.3 steps/s
[Step=16200 Epoch=154.7] | Loss=0.00231 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.196 | L2-Norm(final)=2.887 | 4064.2 samples/s | 63.5 steps/s
[Step=16250 Epoch=155.2] | Loss=0.00186 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.192 | L2-Norm(final)=2.888 | 1538.1 samples/s | 24.0 steps/s
[Step=16300 Epoch=155.7] | Loss=0.00156 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.189 | L2-Norm(final)=2.888 | 3865.6 samples/s | 60.4 steps/s
[Step=16350 Epoch=156.1] | Loss=0.00134 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.185 | L2-Norm(final)=2.889 | 1553.0 samples/s | 24.3 steps/s
[Step=16400 Epoch=156.6] | Loss=0.00117 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.182 | L2-Norm(final)=2.889 | 3728.4 samples/s | 58.3 steps/s
[Step=16450 Epoch=157.1] | Loss=0.00105 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.180 | L2-Norm(final)=2.889 | 1601.1 samples/s | 25.0 steps/s
[Step=16500 Epoch=157.6] | Loss=0.00095 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=2.890 | 3532.3 samples/s | 55.2 steps/s
[Step=16550 Epoch=158.0] | Loss=0.00086 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=2.890 | 1630.4 samples/s | 25.5 steps/s
[Step=16600 Epoch=158.5] | Loss=0.00079 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.173 | L2-Norm(final)=2.890 | 3424.4 samples/s | 53.5 steps/s
[Step=16650 Epoch=159.0] | Loss=0.00073 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.171 | L2-Norm(final)=2.890 | 1651.1 samples/s | 25.8 steps/s
[Step=16700 Epoch=159.5] | Loss=0.00068 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.170 | L2-Norm(final)=2.890 | 3348.7 samples/s | 52.3 steps/s
[Step=16750 Epoch=160.0] | Loss=0.00064 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.168 | L2-Norm(final)=2.890 | 1662.7 samples/s | 26.0 steps/s
[Step=16800 Epoch=160.4] | Loss=0.00060 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.166 | L2-Norm(final)=2.891 | 3392.5 samples/s | 53.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step16800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=150.8] | Loss=0.01659 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.254 | L2-Norm(final)=2.875 | 3680.4 samples/s | 57.5 steps/s
[Step=16050 Epoch=151.2] | Loss=0.00696 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.206 | L2-Norm(final)=2.879 | 3176.1 samples/s | 49.6 steps/s
[Step=16100 Epoch=151.7] | Loss=0.00371 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.200 | L2-Norm(final)=2.886 | 4178.0 samples/s | 65.3 steps/s
[Step=16150 Epoch=152.2] | Loss=0.00251 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.195 | L2-Norm(final)=2.889 | 1521.7 samples/s | 23.8 steps/s
[Step=16200 Epoch=152.7] | Loss=0.00190 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.190 | L2-Norm(final)=2.892 | 3889.0 samples/s | 60.8 steps/s
[Step=16250 Epoch=153.1] | Loss=0.00153 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.186 | L2-Norm(final)=2.893 | 1546.8 samples/s | 24.2 steps/s
[Step=16300 Epoch=153.6] | Loss=0.00129 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.183 | L2-Norm(final)=2.894 | 3687.9 samples/s | 57.6 steps/s
[Step=16350 Epoch=154.1] | Loss=0.00111 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.180 | L2-Norm(final)=2.895 | 1600.6 samples/s | 25.0 steps/s
[Step=16400 Epoch=154.5] | Loss=0.00097 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=2.896 | 3490.7 samples/s | 54.5 steps/s
[Step=16450 Epoch=155.0] | Loss=0.00087 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.176 | L2-Norm(final)=2.896 | 1646.7 samples/s | 25.7 steps/s
[Step=16500 Epoch=155.5] | Loss=0.00079 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.173 | L2-Norm(final)=2.897 | 3373.3 samples/s | 52.7 steps/s
[Step=16550 Epoch=155.9] | Loss=0.00072 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.172 | L2-Norm(final)=2.897 | 1643.9 samples/s | 25.7 steps/s
[Step=16600 Epoch=156.4] | Loss=0.00066 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.170 | L2-Norm(final)=2.898 | 3385.7 samples/s | 52.9 steps/s
[Step=16650 Epoch=156.9] | Loss=0.00061 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.168 | L2-Norm(final)=2.898 | 1676.2 samples/s | 26.2 steps/s
[Step=16700 Epoch=157.4] | Loss=0.00057 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.166 | L2-Norm(final)=2.898 | 3362.5 samples/s | 52.5 steps/s
[Step=16750 Epoch=157.8] | Loss=0.00053 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.165 | L2-Norm(final)=2.898 | 1800.1 samples/s | 28.1 steps/s
[Step=16800 Epoch=158.3] | Loss=0.00050 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.163 | L2-Norm(final)=2.899 | 2931.3 samples/s | 45.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step16800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=152.5] | Loss=0.08299 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.254 | L2-Norm(final)=2.875 | 3792.8 samples/s | 59.3 steps/s
[Step=16050 Epoch=153.0] | Loss=0.00954 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.208 | L2-Norm(final)=2.873 | 3071.3 samples/s | 48.0 steps/s
[Step=16100 Epoch=153.4] | Loss=0.00499 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.201 | L2-Norm(final)=2.878 | 4244.9 samples/s | 66.3 steps/s
[Step=16150 Epoch=153.9] | Loss=0.00336 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.196 | L2-Norm(final)=2.882 | 1515.2 samples/s | 23.7 steps/s
[Step=16200 Epoch=154.4] | Loss=0.00255 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.192 | L2-Norm(final)=2.885 | 4034.0 samples/s | 63.0 steps/s
[Step=16250 Epoch=154.9] | Loss=0.00206 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.188 | L2-Norm(final)=2.887 | 1542.1 samples/s | 24.1 steps/s
[Step=16300 Epoch=155.4] | Loss=0.00173 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.185 | L2-Norm(final)=2.888 | 3826.2 samples/s | 59.8 steps/s
[Step=16350 Epoch=155.8] | Loss=0.00149 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.182 | L2-Norm(final)=2.889 | 1549.3 samples/s | 24.2 steps/s
[Step=16400 Epoch=156.3] | Loss=0.00131 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.180 | L2-Norm(final)=2.890 | 3586.6 samples/s | 56.0 steps/s
[Step=16450 Epoch=156.8] | Loss=0.00117 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=2.891 | 1474.1 samples/s | 23.0 steps/s
[Step=16500 Epoch=157.3] | Loss=0.00105 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.176 | L2-Norm(final)=2.892 | 3323.0 samples/s | 51.9 steps/s
[Step=16550 Epoch=157.7] | Loss=0.00096 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.174 | L2-Norm(final)=2.893 | 1501.1 samples/s | 23.5 steps/s
[Step=16600 Epoch=158.2] | Loss=0.00089 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.172 | L2-Norm(final)=2.893 | 3150.0 samples/s | 49.2 steps/s
[Step=16650 Epoch=158.7] | Loss=0.00082 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.170 | L2-Norm(final)=2.894 | 1650.3 samples/s | 25.8 steps/s
[Step=16700 Epoch=159.2] | Loss=0.00076 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.169 | L2-Norm(final)=2.894 | 3344.8 samples/s | 52.3 steps/s
[Step=16750 Epoch=159.6] | Loss=0.00072 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.167 | L2-Norm(final)=2.895 | 1632.2 samples/s | 25.5 steps/s
[Step=16800 Epoch=160.1] | Loss=0.00067 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.166 | L2-Norm(final)=2.895 | 3383.1 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23824 | acc=0.8503 | tpr=0.7890 | fpr=0.0166 | 3786.8 samples/s | 14.8 steps/s
Avg test loss: 0.23886, Avg test acc: 0.85083, Avg tpr: 0.79081, Avg fpr: 0.01718, total FA: 134

Testing server on iccad2012
[Step=  50] | Loss=0.41959 | acc=0.8387 | tpr=0.9735 | fpr=0.1637 | 3682.9 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.42647 | acc=0.8373 | tpr=0.9723 | fpr=0.1652 | 6768.4 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.43221 | acc=0.8351 | tpr=0.9769 | fpr=0.1675 | 6417.6 samples/s | 25.1 steps/s
[Step= 200] | Loss=0.43210 | acc=0.8355 | tpr=0.9760 | fpr=0.1671 | 6068.2 samples/s | 23.7 steps/s
[Step= 250] | Loss=0.43221 | acc=0.8359 | tpr=0.9764 | fpr=0.1667 | 5918.8 samples/s | 23.1 steps/s
[Step= 300] | Loss=0.43098 | acc=0.8362 | tpr=0.9724 | fpr=0.1663 | 6373.5 samples/s | 24.9 steps/s
[Step= 350] | Loss=0.43226 | acc=0.8361 | tpr=0.9712 | fpr=0.1663 | 7448.4 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.43310 | acc=0.8361 | tpr=0.9694 | fpr=0.1664 | 7024.2 samples/s | 27.4 steps/s
[Step= 450] | Loss=0.43650 | acc=0.8353 | tpr=0.9693 | fpr=0.1672 | 7343.4 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.43755 | acc=0.8346 | tpr=0.9705 | fpr=0.1679 | 7242.5 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.43661 | acc=0.8349 | tpr=0.9713 | fpr=0.1676 | 13043.0 samples/s | 50.9 steps/s
Avg test loss: 0.43647, Avg test acc: 0.83495, Avg tpr: 0.97147, Avg fpr: 0.16754, total FA: 23262

server round 21/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=81.9] | Loss=0.12945 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.166 | L2-Norm(final)=2.919 | 3592.4 samples/s | 56.1 steps/s
[Step=16850 Epoch=82.2] | Loss=0.02973 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.143 | L2-Norm(final)=2.904 | 3786.5 samples/s | 59.2 steps/s
[Step=16900 Epoch=82.4] | Loss=0.02296 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.133 | L2-Norm(final)=2.901 | 3733.4 samples/s | 58.3 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01879 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.131 | L2-Norm(final)=2.904 | 3736.7 samples/s | 58.4 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01658 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.129 | L2-Norm(final)=2.907 | 4632.1 samples/s | 72.4 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01482 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.129 | L2-Norm(final)=2.911 | 1611.1 samples/s | 25.2 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01367 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.129 | L2-Norm(final)=2.915 | 3632.1 samples/s | 56.8 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01244 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.129 | L2-Norm(final)=2.919 | 3661.3 samples/s | 57.2 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01157 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.129 | L2-Norm(final)=2.922 | 4308.8 samples/s | 67.3 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01079 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.129 | L2-Norm(final)=2.926 | 1659.1 samples/s | 25.9 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01029 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.129 | L2-Norm(final)=2.929 | 3720.4 samples/s | 58.1 steps/s
[Step=17350 Epoch=84.6] | Loss=0.00998 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.129 | L2-Norm(final)=2.932 | 3723.1 samples/s | 58.2 steps/s
[Step=17400 Epoch=84.8] | Loss=0.00980 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.129 | L2-Norm(final)=2.935 | 4137.3 samples/s | 64.6 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00947 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.128 | L2-Norm(final)=2.937 | 1698.2 samples/s | 26.5 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00912 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.128 | L2-Norm(final)=2.939 | 3575.4 samples/s | 55.9 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00882 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.128 | L2-Norm(final)=2.941 | 3594.5 samples/s | 56.2 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00858 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.129 | L2-Norm(final)=2.943 | 3843.7 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step17600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=82.0] | Loss=0.09781 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.166 | L2-Norm(final)=2.918 | 3690.6 samples/s | 57.7 steps/s
[Step=16850 Epoch=82.2] | Loss=0.02148 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.140 | L2-Norm(final)=2.912 | 3517.8 samples/s | 55.0 steps/s
[Step=16900 Epoch=82.5] | Loss=0.01909 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.132 | L2-Norm(final)=2.910 | 3589.3 samples/s | 56.1 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01641 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.128 | L2-Norm(final)=2.908 | 3624.8 samples/s | 56.6 steps/s
[Step=17000 Epoch=83.0] | Loss=0.01471 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.126 | L2-Norm(final)=2.910 | 4642.8 samples/s | 72.5 steps/s
[Step=17050 Epoch=83.2] | Loss=0.01268 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.126 | L2-Norm(final)=2.913 | 1629.5 samples/s | 25.5 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01199 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.126 | L2-Norm(final)=2.916 | 3655.3 samples/s | 57.1 steps/s
[Step=17150 Epoch=83.7] | Loss=0.01122 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=2.918 | 3647.5 samples/s | 57.0 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01028 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=2.920 | 4306.9 samples/s | 67.3 steps/s
[Step=17250 Epoch=84.2] | Loss=0.00950 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=2.923 | 1647.3 samples/s | 25.7 steps/s
[Step=17300 Epoch=84.4] | Loss=0.00901 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=2.926 | 3727.1 samples/s | 58.2 steps/s
[Step=17350 Epoch=84.7] | Loss=0.00854 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=2.929 | 3729.4 samples/s | 58.3 steps/s
[Step=17400 Epoch=84.9] | Loss=0.00816 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=2.932 | 4229.6 samples/s | 66.1 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00791 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.126 | L2-Norm(final)=2.934 | 1683.3 samples/s | 26.3 steps/s
[Step=17500 Epoch=85.4] | Loss=0.00779 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=2.936 | 3711.6 samples/s | 58.0 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00758 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=2.938 | 3718.4 samples/s | 58.1 steps/s
[Step=17600 Epoch=85.9] | Loss=0.00747 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.125 | L2-Norm(final)=2.940 | 4070.5 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step17600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=81.9] | Loss=0.17878 | Reg=0.00330 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.166 | L2-Norm(final)=2.918 | 3889.9 samples/s | 60.8 steps/s
[Step=16850 Epoch=82.1] | Loss=0.02484 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.145 | L2-Norm(final)=2.910 | 3566.2 samples/s | 55.7 steps/s
[Step=16900 Epoch=82.3] | Loss=0.02045 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.139 | L2-Norm(final)=2.911 | 3734.8 samples/s | 58.4 steps/s
[Step=16950 Epoch=82.6] | Loss=0.01778 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.136 | L2-Norm(final)=2.911 | 3728.0 samples/s | 58.2 steps/s
[Step=17000 Epoch=82.8] | Loss=0.01689 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.135 | L2-Norm(final)=2.913 | 4639.4 samples/s | 72.5 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01495 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.135 | L2-Norm(final)=2.915 | 1616.9 samples/s | 25.3 steps/s
[Step=17100 Epoch=83.3] | Loss=0.01381 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=2.917 | 3627.1 samples/s | 56.7 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01286 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=2.920 | 3603.7 samples/s | 56.3 steps/s
[Step=17200 Epoch=83.8] | Loss=0.01198 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=2.923 | 4361.6 samples/s | 68.2 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01130 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.134 | L2-Norm(final)=2.925 | 1663.1 samples/s | 26.0 steps/s
[Step=17300 Epoch=84.3] | Loss=0.01065 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=2.928 | 3643.9 samples/s | 56.9 steps/s
[Step=17350 Epoch=84.5] | Loss=0.01010 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=2.930 | 3668.6 samples/s | 57.3 steps/s
[Step=17400 Epoch=84.8] | Loss=0.00977 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=2.933 | 4078.5 samples/s | 63.7 steps/s
[Step=17450 Epoch=85.0] | Loss=0.00943 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=2.935 | 1695.2 samples/s | 26.5 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00905 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=2.938 | 3583.4 samples/s | 56.0 steps/s
[Step=17550 Epoch=85.5] | Loss=0.00882 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.135 | L2-Norm(final)=2.940 | 3598.6 samples/s | 56.2 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00854 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=2.942 | 3837.6 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step17600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=81.9] | Loss=0.10218 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.166 | L2-Norm(final)=2.919 | 4104.1 samples/s | 64.1 steps/s
[Step=16850 Epoch=82.2] | Loss=0.02943 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.146 | L2-Norm(final)=2.907 | 3357.9 samples/s | 52.5 steps/s
[Step=16900 Epoch=82.4] | Loss=0.02252 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.140 | L2-Norm(final)=2.903 | 3735.1 samples/s | 58.4 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01841 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.137 | L2-Norm(final)=2.905 | 3728.7 samples/s | 58.3 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01643 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.135 | L2-Norm(final)=2.908 | 4637.5 samples/s | 72.5 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01457 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=2.911 | 1638.6 samples/s | 25.6 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01290 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.134 | L2-Norm(final)=2.915 | 3728.8 samples/s | 58.3 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01201 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.134 | L2-Norm(final)=2.919 | 3740.8 samples/s | 58.4 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01152 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=2.922 | 4408.1 samples/s | 68.9 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01081 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=2.925 | 1665.1 samples/s | 26.0 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01029 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.134 | L2-Norm(final)=2.928 | 3648.6 samples/s | 57.0 steps/s
[Step=17350 Epoch=84.6] | Loss=0.00968 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.133 | L2-Norm(final)=2.930 | 3650.9 samples/s | 57.0 steps/s
[Step=17400 Epoch=84.9] | Loss=0.00924 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.133 | L2-Norm(final)=2.933 | 4015.7 samples/s | 62.7 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00878 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.133 | L2-Norm(final)=2.935 | 1678.8 samples/s | 26.2 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00855 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.133 | L2-Norm(final)=2.938 | 3655.8 samples/s | 57.1 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00819 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.133 | L2-Norm(final)=2.940 | 3651.0 samples/s | 57.0 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00796 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.132 | L2-Norm(final)=2.942 | 3882.7 samples/s | 60.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step17600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=82.4] | Loss=0.14998 | Reg=0.00330 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.166 | L2-Norm(final)=2.918 | 3840.8 samples/s | 60.0 steps/s
[Step=16850 Epoch=82.6] | Loss=0.02841 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.150 | L2-Norm(final)=2.907 | 3525.9 samples/s | 55.1 steps/s
[Step=16900 Epoch=82.9] | Loss=0.02129 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.144 | L2-Norm(final)=2.906 | 3709.2 samples/s | 58.0 steps/s
[Step=16950 Epoch=83.1] | Loss=0.01840 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.141 | L2-Norm(final)=2.907 | 3650.8 samples/s | 57.0 steps/s
[Step=17000 Epoch=83.4] | Loss=0.01647 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.139 | L2-Norm(final)=2.910 | 4564.7 samples/s | 71.3 steps/s
[Step=17050 Epoch=83.6] | Loss=0.01491 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.138 | L2-Norm(final)=2.913 | 1620.1 samples/s | 25.3 steps/s
[Step=17100 Epoch=83.9] | Loss=0.01337 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.138 | L2-Norm(final)=2.917 | 3640.7 samples/s | 56.9 steps/s
[Step=17150 Epoch=84.1] | Loss=0.01224 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.137 | L2-Norm(final)=2.920 | 3646.0 samples/s | 57.0 steps/s
[Step=17200 Epoch=84.3] | Loss=0.01140 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.137 | L2-Norm(final)=2.923 | 4425.2 samples/s | 69.1 steps/s
[Step=17250 Epoch=84.6] | Loss=0.01063 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.137 | L2-Norm(final)=2.926 | 1657.1 samples/s | 25.9 steps/s
[Step=17300 Epoch=84.8] | Loss=0.00987 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.137 | L2-Norm(final)=2.929 | 3714.7 samples/s | 58.0 steps/s
[Step=17350 Epoch=85.1] | Loss=0.00942 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.137 | L2-Norm(final)=2.933 | 3625.5 samples/s | 56.6 steps/s
[Step=17400 Epoch=85.3] | Loss=0.00890 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.137 | L2-Norm(final)=2.936 | 4277.4 samples/s | 66.8 steps/s
[Step=17450 Epoch=85.6] | Loss=0.00878 | Reg=0.00329 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.137 | L2-Norm(final)=2.938 | 1657.0 samples/s | 25.9 steps/s
[Step=17500 Epoch=85.8] | Loss=0.00848 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.136 | L2-Norm(final)=2.940 | 3645.7 samples/s | 57.0 steps/s
[Step=17550 Epoch=86.1] | Loss=0.00821 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.136 | L2-Norm(final)=2.942 | 3657.5 samples/s | 57.1 steps/s
[Step=17600 Epoch=86.3] | Loss=0.00793 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.136 | L2-Norm(final)=2.944 | 4131.2 samples/s | 64.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step17600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=159.2] | Loss=0.01919 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.166 | L2-Norm(final)=2.919 | 3656.4 samples/s | 57.1 steps/s
[Step=16850 Epoch=159.7] | Loss=0.00395 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.117 | L2-Norm(final)=2.933 | 3444.6 samples/s | 53.8 steps/s
[Step=16900 Epoch=160.1] | Loss=0.00206 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.109 | L2-Norm(final)=2.937 | 4301.9 samples/s | 67.2 steps/s
[Step=16950 Epoch=160.6] | Loss=0.00139 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.103 | L2-Norm(final)=2.939 | 1575.6 samples/s | 24.6 steps/s
[Step=17000 Epoch=161.1] | Loss=0.00105 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.099 | L2-Norm(final)=2.940 | 4095.8 samples/s | 64.0 steps/s
[Step=17050 Epoch=161.6] | Loss=0.00085 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.095 | L2-Norm(final)=2.940 | 1623.2 samples/s | 25.4 steps/s
[Step=17100 Epoch=162.0] | Loss=0.00071 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.092 | L2-Norm(final)=2.941 | 3978.3 samples/s | 62.2 steps/s
[Step=17150 Epoch=162.5] | Loss=0.00062 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.089 | L2-Norm(final)=2.941 | 1651.6 samples/s | 25.8 steps/s
[Step=17200 Epoch=163.0] | Loss=0.00054 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.086 | L2-Norm(final)=2.941 | 3718.2 samples/s | 58.1 steps/s
[Step=17250 Epoch=163.5] | Loss=0.00048 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.084 | L2-Norm(final)=2.941 | 1682.5 samples/s | 26.3 steps/s
[Step=17300 Epoch=163.9] | Loss=0.00044 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.082 | L2-Norm(final)=2.941 | 3501.1 samples/s | 54.7 steps/s
[Step=17350 Epoch=164.4] | Loss=0.00040 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.080 | L2-Norm(final)=2.941 | 1728.4 samples/s | 27.0 steps/s
[Step=17400 Epoch=164.9] | Loss=0.00037 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.078 | L2-Norm(final)=2.941 | 3581.3 samples/s | 56.0 steps/s
[Step=17450 Epoch=165.4] | Loss=0.00034 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.076 | L2-Norm(final)=2.941 | 1753.3 samples/s | 27.4 steps/s
[Step=17500 Epoch=165.8] | Loss=0.00032 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.075 | L2-Norm(final)=2.941 | 3560.9 samples/s | 55.6 steps/s
[Step=17550 Epoch=166.3] | Loss=0.00030 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.073 | L2-Norm(final)=2.941 | 1753.4 samples/s | 27.4 steps/s
[Step=17600 Epoch=166.8] | Loss=0.00028 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.072 | L2-Norm(final)=2.941 | 3427.2 samples/s | 53.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step17600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=159.8] | Loss=0.14195 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.166 | L2-Norm(final)=2.919 | 3592.6 samples/s | 56.1 steps/s
[Step=16850 Epoch=160.3] | Loss=0.01089 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.126 | L2-Norm(final)=2.913 | 3394.0 samples/s | 53.0 steps/s
[Step=16900 Epoch=160.8] | Loss=0.00568 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.121 | L2-Norm(final)=2.919 | 4369.1 samples/s | 68.3 steps/s
[Step=16950 Epoch=161.2] | Loss=0.00383 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.117 | L2-Norm(final)=2.923 | 1450.3 samples/s | 22.7 steps/s
[Step=17000 Epoch=161.7] | Loss=0.00290 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.113 | L2-Norm(final)=2.926 | 3628.9 samples/s | 56.7 steps/s
[Step=17050 Epoch=162.2] | Loss=0.00233 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.110 | L2-Norm(final)=2.928 | 1427.1 samples/s | 22.3 steps/s
[Step=17100 Epoch=162.7] | Loss=0.00196 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.107 | L2-Norm(final)=2.929 | 3711.2 samples/s | 58.0 steps/s
[Step=17150 Epoch=163.1] | Loss=0.00168 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.105 | L2-Norm(final)=2.930 | 1595.7 samples/s | 24.9 steps/s
[Step=17200 Epoch=163.6] | Loss=0.00148 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.102 | L2-Norm(final)=2.931 | 3757.8 samples/s | 58.7 steps/s
[Step=17250 Epoch=164.1] | Loss=0.00132 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.100 | L2-Norm(final)=2.932 | 1655.2 samples/s | 25.9 steps/s
[Step=17300 Epoch=164.6] | Loss=0.00120 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.098 | L2-Norm(final)=2.933 | 3505.6 samples/s | 54.8 steps/s
[Step=17350 Epoch=165.0] | Loss=0.00109 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.096 | L2-Norm(final)=2.934 | 1696.3 samples/s | 26.5 steps/s
[Step=17400 Epoch=165.5] | Loss=0.00100 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.095 | L2-Norm(final)=2.934 | 3499.3 samples/s | 54.7 steps/s
[Step=17450 Epoch=166.0] | Loss=0.00093 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.093 | L2-Norm(final)=2.935 | 1711.3 samples/s | 26.7 steps/s
[Step=17500 Epoch=166.5] | Loss=0.00086 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.091 | L2-Norm(final)=2.935 | 3491.2 samples/s | 54.6 steps/s
[Step=17550 Epoch=166.9] | Loss=0.00081 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.090 | L2-Norm(final)=2.936 | 1703.1 samples/s | 26.6 steps/s
[Step=17600 Epoch=167.4] | Loss=0.00076 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.089 | L2-Norm(final)=2.936 | 3353.8 samples/s | 52.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step17600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=160.4] | Loss=0.03467 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.166 | L2-Norm(final)=2.919 | 3499.1 samples/s | 54.7 steps/s
[Step=16850 Epoch=160.9] | Loss=0.00402 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.114 | L2-Norm(final)=2.931 | 3408.8 samples/s | 53.3 steps/s
[Step=16900 Epoch=161.4] | Loss=0.00221 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.107 | L2-Norm(final)=2.935 | 4378.1 samples/s | 68.4 steps/s
[Step=16950 Epoch=161.9] | Loss=0.00149 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.102 | L2-Norm(final)=2.937 | 1581.5 samples/s | 24.7 steps/s
[Step=17000 Epoch=162.3] | Loss=0.00113 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.098 | L2-Norm(final)=2.939 | 4288.6 samples/s | 67.0 steps/s
[Step=17050 Epoch=162.8] | Loss=0.00091 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.094 | L2-Norm(final)=2.939 | 1444.3 samples/s | 22.6 steps/s
[Step=17100 Epoch=163.3] | Loss=0.00076 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.091 | L2-Norm(final)=2.940 | 3813.5 samples/s | 59.6 steps/s
[Step=17150 Epoch=163.8] | Loss=0.00066 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.088 | L2-Norm(final)=2.940 | 1595.0 samples/s | 24.9 steps/s
[Step=17200 Epoch=164.2] | Loss=0.00058 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.086 | L2-Norm(final)=2.940 | 3761.0 samples/s | 58.8 steps/s
[Step=17250 Epoch=164.7] | Loss=0.00052 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.083 | L2-Norm(final)=2.941 | 1665.9 samples/s | 26.0 steps/s
[Step=17300 Epoch=165.2] | Loss=0.00047 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.081 | L2-Norm(final)=2.941 | 3697.0 samples/s | 57.8 steps/s
[Step=17350 Epoch=165.7] | Loss=0.00043 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.079 | L2-Norm(final)=2.941 | 1679.3 samples/s | 26.2 steps/s
[Step=17400 Epoch=166.2] | Loss=0.00039 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.078 | L2-Norm(final)=2.941 | 3432.0 samples/s | 53.6 steps/s
[Step=17450 Epoch=166.6] | Loss=0.00036 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.076 | L2-Norm(final)=2.941 | 1670.4 samples/s | 26.1 steps/s
[Step=17500 Epoch=167.1] | Loss=0.00034 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.074 | L2-Norm(final)=2.941 | 3395.4 samples/s | 53.1 steps/s
[Step=17550 Epoch=167.6] | Loss=0.00032 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.073 | L2-Norm(final)=2.941 | 1695.5 samples/s | 26.5 steps/s
[Step=17600 Epoch=168.1] | Loss=0.00030 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.071 | L2-Norm(final)=2.941 | 3488.8 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step17600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=158.3] | Loss=0.10091 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.166 | L2-Norm(final)=2.919 | 3920.8 samples/s | 61.3 steps/s
[Step=16850 Epoch=158.8] | Loss=0.00585 | Reg=0.00328 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.118 | L2-Norm(final)=2.922 | 3121.6 samples/s | 48.8 steps/s
[Step=16900 Epoch=159.2] | Loss=0.00328 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.111 | L2-Norm(final)=2.925 | 4452.0 samples/s | 69.6 steps/s
[Step=16950 Epoch=159.7] | Loss=0.00250 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.107 | L2-Norm(final)=2.927 | 1554.6 samples/s | 24.3 steps/s
[Step=17000 Epoch=160.2] | Loss=0.00190 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.103 | L2-Norm(final)=2.928 | 3984.9 samples/s | 62.3 steps/s
[Step=17050 Epoch=160.7] | Loss=0.00153 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.100 | L2-Norm(final)=2.930 | 1640.2 samples/s | 25.6 steps/s
[Step=17100 Epoch=161.1] | Loss=0.00128 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.098 | L2-Norm(final)=2.930 | 3835.1 samples/s | 59.9 steps/s
[Step=17150 Epoch=161.6] | Loss=0.00110 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.095 | L2-Norm(final)=2.931 | 1673.0 samples/s | 26.1 steps/s
[Step=17200 Epoch=162.1] | Loss=0.00096 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.093 | L2-Norm(final)=2.931 | 3644.7 samples/s | 56.9 steps/s
[Step=17250 Epoch=162.5] | Loss=0.00086 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.090 | L2-Norm(final)=2.932 | 1693.0 samples/s | 26.5 steps/s
[Step=17300 Epoch=163.0] | Loss=0.00077 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.088 | L2-Norm(final)=2.932 | 3580.4 samples/s | 55.9 steps/s
[Step=17350 Epoch=163.5] | Loss=0.00071 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.086 | L2-Norm(final)=2.932 | 1761.3 samples/s | 27.5 steps/s
[Step=17400 Epoch=164.0] | Loss=0.00065 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.084 | L2-Norm(final)=2.933 | 3593.4 samples/s | 56.1 steps/s
[Step=17450 Epoch=164.4] | Loss=0.00060 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.083 | L2-Norm(final)=2.933 | 1782.9 samples/s | 27.9 steps/s
[Step=17500 Epoch=164.9] | Loss=0.00056 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.081 | L2-Norm(final)=2.933 | 3545.0 samples/s | 55.4 steps/s
[Step=17550 Epoch=165.4] | Loss=0.00052 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.079 | L2-Norm(final)=2.933 | 1800.7 samples/s | 28.1 steps/s
[Step=17600 Epoch=165.8] | Loss=0.00049 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.078 | L2-Norm(final)=2.933 | 3397.9 samples/s | 53.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step17600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=160.1] | Loss=0.15863 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.166 | L2-Norm(final)=2.919 | 3818.0 samples/s | 59.7 steps/s
[Step=16850 Epoch=160.6] | Loss=0.00699 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.115 | L2-Norm(final)=2.923 | 3264.1 samples/s | 51.0 steps/s
[Step=16900 Epoch=161.1] | Loss=0.00360 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.107 | L2-Norm(final)=2.926 | 4511.3 samples/s | 70.5 steps/s
[Step=16950 Epoch=161.5] | Loss=0.00243 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.101 | L2-Norm(final)=2.928 | 1562.2 samples/s | 24.4 steps/s
[Step=17000 Epoch=162.0] | Loss=0.00184 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.097 | L2-Norm(final)=2.929 | 4280.2 samples/s | 66.9 steps/s
[Step=17050 Epoch=162.5] | Loss=0.00148 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.093 | L2-Norm(final)=2.930 | 1598.7 samples/s | 25.0 steps/s
[Step=17100 Epoch=163.0] | Loss=0.00124 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.090 | L2-Norm(final)=2.931 | 4015.9 samples/s | 62.7 steps/s
[Step=17150 Epoch=163.5] | Loss=0.00107 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.087 | L2-Norm(final)=2.932 | 1639.6 samples/s | 25.6 steps/s
[Step=17200 Epoch=163.9] | Loss=0.00094 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.085 | L2-Norm(final)=2.932 | 3802.2 samples/s | 59.4 steps/s
[Step=17250 Epoch=164.4] | Loss=0.00084 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.083 | L2-Norm(final)=2.933 | 1663.6 samples/s | 26.0 steps/s
[Step=17300 Epoch=164.9] | Loss=0.00076 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.081 | L2-Norm(final)=2.933 | 3677.0 samples/s | 57.5 steps/s
[Step=17350 Epoch=165.4] | Loss=0.00069 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.079 | L2-Norm(final)=2.933 | 1709.7 samples/s | 26.7 steps/s
[Step=17400 Epoch=165.8] | Loss=0.00063 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.077 | L2-Norm(final)=2.933 | 3616.7 samples/s | 56.5 steps/s
[Step=17450 Epoch=166.3] | Loss=0.00059 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.076 | L2-Norm(final)=2.934 | 1732.3 samples/s | 27.1 steps/s
[Step=17500 Epoch=166.8] | Loss=0.00055 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.074 | L2-Norm(final)=2.934 | 3591.4 samples/s | 56.1 steps/s
[Step=17550 Epoch=167.3] | Loss=0.00051 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.073 | L2-Norm(final)=2.934 | 1752.7 samples/s | 27.4 steps/s
[Step=17600 Epoch=167.7] | Loss=0.00048 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.071 | L2-Norm(final)=2.934 | 3584.7 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24633 | acc=0.8474 | tpr=0.7846 | fpr=0.0161 | 3829.7 samples/s | 15.0 steps/s
Avg test loss: 0.24685, Avg test acc: 0.84726, Avg tpr: 0.78510, Avg fpr: 0.01602, total FA: 125

Testing server on iccad2012
[Step=  50] | Loss=0.42371 | acc=0.8436 | tpr=0.9690 | fpr=0.1587 | 3879.2 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.43152 | acc=0.8418 | tpr=0.9701 | fpr=0.1606 | 7197.8 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.43782 | acc=0.8398 | tpr=0.9755 | fpr=0.1627 | 7634.8 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.43779 | acc=0.8403 | tpr=0.9738 | fpr=0.1621 | 7342.1 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.43771 | acc=0.8406 | tpr=0.9755 | fpr=0.1619 | 7549.0 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.43652 | acc=0.8410 | tpr=0.9716 | fpr=0.1614 | 7378.4 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.43776 | acc=0.8411 | tpr=0.9706 | fpr=0.1612 | 7217.0 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.43885 | acc=0.8410 | tpr=0.9688 | fpr=0.1613 | 7247.5 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.44249 | acc=0.8401 | tpr=0.9688 | fpr=0.1623 | 7352.2 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.44359 | acc=0.8394 | tpr=0.9696 | fpr=0.1629 | 7207.9 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.44260 | acc=0.8398 | tpr=0.9706 | fpr=0.1626 | 13631.6 samples/s | 53.2 steps/s
Avg test loss: 0.44248, Avg test acc: 0.83980, Avg tpr: 0.97068, Avg fpr: 0.16258, total FA: 22574

server round 22/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.8] | Loss=0.20227 | Reg=0.00327 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.079 | L2-Norm(final)=2.954 | 3921.8 samples/s | 61.3 steps/s
[Step=17650 Epoch=86.1] | Loss=0.02877 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.057 | L2-Norm(final)=2.939 | 3448.3 samples/s | 53.9 steps/s
[Step=17700 Epoch=86.3] | Loss=0.02040 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.051 | L2-Norm(final)=2.938 | 3619.0 samples/s | 56.5 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01984 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.047 | L2-Norm(final)=2.938 | 3603.0 samples/s | 56.3 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01771 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.045 | L2-Norm(final)=2.939 | 4444.7 samples/s | 69.4 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01542 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.045 | L2-Norm(final)=2.942 | 1599.9 samples/s | 25.0 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01358 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.045 | L2-Norm(final)=2.946 | 3585.9 samples/s | 56.0 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01250 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.045 | L2-Norm(final)=2.950 | 3613.2 samples/s | 56.5 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01168 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.045 | L2-Norm(final)=2.953 | 4242.7 samples/s | 66.3 steps/s
[Step=18050 Epoch=88.0] | Loss=0.01099 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.045 | L2-Norm(final)=2.956 | 1526.5 samples/s | 23.9 steps/s
[Step=18100 Epoch=88.3] | Loss=0.01039 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.044 | L2-Norm(final)=2.959 | 3402.0 samples/s | 53.2 steps/s
[Step=18150 Epoch=88.5] | Loss=0.00990 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.962 | 3468.5 samples/s | 54.2 steps/s
[Step=18200 Epoch=88.7] | Loss=0.00940 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.964 | 3973.2 samples/s | 62.1 steps/s
[Step=18250 Epoch=89.0] | Loss=0.00912 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.966 | 1630.9 samples/s | 25.5 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00876 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.044 | L2-Norm(final)=2.969 | 3560.6 samples/s | 55.6 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00845 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.971 | 3595.3 samples/s | 56.2 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00823 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.973 | 3815.2 samples/s | 59.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step18400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.9] | Loss=0.10921 | Reg=0.00327 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.079 | L2-Norm(final)=2.955 | 3881.3 samples/s | 60.6 steps/s
[Step=17650 Epoch=86.1] | Loss=0.02688 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.056 | L2-Norm(final)=2.942 | 3499.0 samples/s | 54.7 steps/s
[Step=17700 Epoch=86.4] | Loss=0.02049 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.050 | L2-Norm(final)=2.940 | 3725.4 samples/s | 58.2 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01846 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=2.939 | 3660.8 samples/s | 57.2 steps/s
[Step=17800 Epoch=86.9] | Loss=0.01602 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.939 | 4561.6 samples/s | 71.3 steps/s
[Step=17850 Epoch=87.1] | Loss=0.01432 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.941 | 1623.1 samples/s | 25.4 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01327 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=2.942 | 3733.0 samples/s | 58.3 steps/s
[Step=17950 Epoch=87.6] | Loss=0.01208 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.944 | 3728.9 samples/s | 58.3 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01114 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.946 | 4441.5 samples/s | 69.4 steps/s
[Step=18050 Epoch=88.1] | Loss=0.01020 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.949 | 1654.1 samples/s | 25.8 steps/s
[Step=18100 Epoch=88.3] | Loss=0.00954 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.952 | 3637.0 samples/s | 56.8 steps/s
[Step=18150 Epoch=88.6] | Loss=0.00910 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.954 | 3670.8 samples/s | 57.4 steps/s
[Step=18200 Epoch=88.8] | Loss=0.00877 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.956 | 4183.8 samples/s | 65.4 steps/s
[Step=18250 Epoch=89.1] | Loss=0.00847 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.959 | 1678.0 samples/s | 26.2 steps/s
[Step=18300 Epoch=89.3] | Loss=0.00820 | Reg=0.00325 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.041 | L2-Norm(final)=2.960 | 3621.3 samples/s | 56.6 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00777 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.041 | L2-Norm(final)=2.962 | 3604.0 samples/s | 56.3 steps/s
[Step=18400 Epoch=89.8] | Loss=0.00766 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.041 | L2-Norm(final)=2.964 | 3949.6 samples/s | 61.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step18400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.8] | Loss=0.03788 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.079 | L2-Norm(final)=2.955 | 3719.1 samples/s | 58.1 steps/s
[Step=17650 Epoch=86.0] | Loss=0.02278 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.053 | L2-Norm(final)=2.950 | 3555.5 samples/s | 55.6 steps/s
[Step=17700 Epoch=86.2] | Loss=0.02172 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=2.946 | 3669.7 samples/s | 57.3 steps/s
[Step=17750 Epoch=86.5] | Loss=0.01848 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.945 | 3649.9 samples/s | 57.0 steps/s
[Step=17800 Epoch=86.7] | Loss=0.01610 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=2.947 | 4464.9 samples/s | 69.8 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01425 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=2.950 | 1638.9 samples/s | 25.6 steps/s
[Step=17900 Epoch=87.2] | Loss=0.01309 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.953 | 3647.8 samples/s | 57.0 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01232 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.956 | 3673.6 samples/s | 57.4 steps/s
[Step=18000 Epoch=87.7] | Loss=0.01145 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.959 | 4276.8 samples/s | 66.8 steps/s
[Step=18050 Epoch=87.9] | Loss=0.01095 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=2.962 | 1646.0 samples/s | 25.7 steps/s
[Step=18100 Epoch=88.2] | Loss=0.01018 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.965 | 3702.4 samples/s | 57.9 steps/s
[Step=18150 Epoch=88.4] | Loss=0.01001 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.968 | 3666.4 samples/s | 57.3 steps/s
[Step=18200 Epoch=88.7] | Loss=0.00981 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.969 | 4120.6 samples/s | 64.4 steps/s
[Step=18250 Epoch=88.9] | Loss=0.00946 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.971 | 1697.3 samples/s | 26.5 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00913 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.973 | 3737.2 samples/s | 58.4 steps/s
[Step=18350 Epoch=89.4] | Loss=0.00884 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.975 | 3735.5 samples/s | 58.4 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00874 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.044 | L2-Norm(final)=2.976 | 3976.9 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step18400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.8] | Loss=0.15140 | Reg=0.00327 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.079 | L2-Norm(final)=2.954 | 3729.2 samples/s | 58.3 steps/s
[Step=17650 Epoch=86.1] | Loss=0.02264 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.059 | L2-Norm(final)=2.948 | 3569.4 samples/s | 55.8 steps/s
[Step=17700 Epoch=86.3] | Loss=0.01720 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.053 | L2-Norm(final)=2.948 | 3594.5 samples/s | 56.2 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01523 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.050 | L2-Norm(final)=2.949 | 3588.8 samples/s | 56.1 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01444 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.048 | L2-Norm(final)=2.949 | 4472.3 samples/s | 69.9 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01317 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.046 | L2-Norm(final)=2.950 | 1643.6 samples/s | 25.7 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01201 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.045 | L2-Norm(final)=2.951 | 3709.0 samples/s | 58.0 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01102 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.044 | L2-Norm(final)=2.953 | 3738.7 samples/s | 58.4 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01035 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.044 | L2-Norm(final)=2.955 | 4406.4 samples/s | 68.8 steps/s
[Step=18050 Epoch=88.0] | Loss=0.00971 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=2.958 | 1670.0 samples/s | 26.1 steps/s
[Step=18100 Epoch=88.3] | Loss=0.00913 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=2.960 | 3591.4 samples/s | 56.1 steps/s
[Step=18150 Epoch=88.5] | Loss=0.00872 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=2.962 | 3603.2 samples/s | 56.3 steps/s
[Step=18200 Epoch=88.8] | Loss=0.00830 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.965 | 4040.8 samples/s | 63.1 steps/s
[Step=18250 Epoch=89.0] | Loss=0.00818 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.042 | L2-Norm(final)=2.967 | 1695.0 samples/s | 26.5 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00786 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.969 | 3710.1 samples/s | 58.0 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00758 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.971 | 3738.1 samples/s | 58.4 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00736 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.973 | 3986.5 samples/s | 62.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step18400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=86.3] | Loss=0.20520 | Reg=0.00327 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.079 | L2-Norm(final)=2.954 | 3583.1 samples/s | 56.0 steps/s
[Step=17650 Epoch=86.6] | Loss=0.03254 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=18.058 | L2-Norm(final)=2.938 | 3696.9 samples/s | 57.8 steps/s
[Step=17700 Epoch=86.8] | Loss=0.02529 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.053 | L2-Norm(final)=2.934 | 3642.6 samples/s | 56.9 steps/s
[Step=17750 Epoch=87.0] | Loss=0.02077 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.050 | L2-Norm(final)=2.934 | 3600.9 samples/s | 56.3 steps/s
[Step=17800 Epoch=87.3] | Loss=0.01914 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.048 | L2-Norm(final)=2.935 | 4541.3 samples/s | 71.0 steps/s
[Step=17850 Epoch=87.5] | Loss=0.01668 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.048 | L2-Norm(final)=2.936 | 1621.4 samples/s | 25.3 steps/s
[Step=17900 Epoch=87.8] | Loss=0.01481 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.047 | L2-Norm(final)=2.938 | 3747.5 samples/s | 58.6 steps/s
[Step=17950 Epoch=88.0] | Loss=0.01370 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.047 | L2-Norm(final)=2.941 | 3743.6 samples/s | 58.5 steps/s
[Step=18000 Epoch=88.3] | Loss=0.01261 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.047 | L2-Norm(final)=2.944 | 4513.6 samples/s | 70.5 steps/s
[Step=18050 Epoch=88.5] | Loss=0.01181 | Reg=0.00326 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.046 | L2-Norm(final)=2.947 | 1650.4 samples/s | 25.8 steps/s
[Step=18100 Epoch=88.8] | Loss=0.01106 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=2.950 | 3727.7 samples/s | 58.2 steps/s
[Step=18150 Epoch=89.0] | Loss=0.01040 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=2.953 | 3743.9 samples/s | 58.5 steps/s
[Step=18200 Epoch=89.2] | Loss=0.01020 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=2.955 | 4363.4 samples/s | 68.2 steps/s
[Step=18250 Epoch=89.5] | Loss=0.00966 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=2.957 | 1660.4 samples/s | 25.9 steps/s
[Step=18300 Epoch=89.7] | Loss=0.00915 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=2.959 | 3689.3 samples/s | 57.6 steps/s
[Step=18350 Epoch=90.0] | Loss=0.00892 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=2.962 | 3739.2 samples/s | 58.4 steps/s
[Step=18400 Epoch=90.2] | Loss=0.00870 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=2.964 | 4222.8 samples/s | 66.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step18400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=166.8] | Loss=0.05964 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.079 | L2-Norm(final)=2.955 | 3583.8 samples/s | 56.0 steps/s
[Step=17650 Epoch=167.2] | Loss=0.00846 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.028 | L2-Norm(final)=2.952 | 3491.1 samples/s | 54.5 steps/s
[Step=17700 Epoch=167.7] | Loss=0.00469 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.026 | L2-Norm(final)=2.955 | 4496.9 samples/s | 70.3 steps/s
[Step=17750 Epoch=168.2] | Loss=0.00322 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.024 | L2-Norm(final)=2.958 | 1567.9 samples/s | 24.5 steps/s
[Step=17800 Epoch=168.7] | Loss=0.00242 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.021 | L2-Norm(final)=2.960 | 4218.7 samples/s | 65.9 steps/s
[Step=17850 Epoch=169.1] | Loss=0.00194 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=2.961 | 1636.4 samples/s | 25.6 steps/s
[Step=17900 Epoch=169.6] | Loss=0.00162 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.015 | L2-Norm(final)=2.961 | 4016.7 samples/s | 62.8 steps/s
[Step=17950 Epoch=170.1] | Loss=0.00139 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.013 | L2-Norm(final)=2.962 | 1647.1 samples/s | 25.7 steps/s
[Step=18000 Epoch=170.6] | Loss=0.00122 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.010 | L2-Norm(final)=2.962 | 3817.5 samples/s | 59.6 steps/s
[Step=18050 Epoch=171.0] | Loss=0.00109 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.008 | L2-Norm(final)=2.963 | 1691.4 samples/s | 26.4 steps/s
[Step=18100 Epoch=171.5] | Loss=0.00098 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.006 | L2-Norm(final)=2.963 | 3614.2 samples/s | 56.5 steps/s
[Step=18150 Epoch=172.0] | Loss=0.00089 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.004 | L2-Norm(final)=2.963 | 1717.4 samples/s | 26.8 steps/s
[Step=18200 Epoch=172.5] | Loss=0.00082 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.002 | L2-Norm(final)=2.964 | 3595.3 samples/s | 56.2 steps/s
[Step=18250 Epoch=172.9] | Loss=0.00076 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.000 | L2-Norm(final)=2.964 | 1688.0 samples/s | 26.4 steps/s
[Step=18300 Epoch=173.4] | Loss=0.00071 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.998 | L2-Norm(final)=2.964 | 3484.9 samples/s | 54.5 steps/s
[Step=18350 Epoch=173.9] | Loss=0.00066 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.996 | L2-Norm(final)=2.964 | 1744.9 samples/s | 27.3 steps/s
[Step=18400 Epoch=174.4] | Loss=0.00062 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.995 | L2-Norm(final)=2.964 | 3543.0 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step18400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=167.4] | Loss=0.03730 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.079 | L2-Norm(final)=2.955 | 3558.9 samples/s | 55.6 steps/s
[Step=17650 Epoch=167.9] | Loss=0.00671 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.034 | L2-Norm(final)=2.954 | 3497.8 samples/s | 54.7 steps/s
[Step=17700 Epoch=168.4] | Loss=0.00344 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.025 | L2-Norm(final)=2.957 | 4486.7 samples/s | 70.1 steps/s
[Step=17750 Epoch=168.8] | Loss=0.00232 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.019 | L2-Norm(final)=2.959 | 1575.6 samples/s | 24.6 steps/s
[Step=17800 Epoch=169.3] | Loss=0.00175 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.014 | L2-Norm(final)=2.961 | 4143.6 samples/s | 64.7 steps/s
[Step=17850 Epoch=169.8] | Loss=0.00141 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.010 | L2-Norm(final)=2.962 | 1620.4 samples/s | 25.3 steps/s
[Step=17900 Epoch=170.3] | Loss=0.00118 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.007 | L2-Norm(final)=2.963 | 3968.4 samples/s | 62.0 steps/s
[Step=17950 Epoch=170.7] | Loss=0.00102 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.004 | L2-Norm(final)=2.963 | 1663.2 samples/s | 26.0 steps/s
[Step=18000 Epoch=171.2] | Loss=0.00090 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.001 | L2-Norm(final)=2.964 | 3790.7 samples/s | 59.2 steps/s
[Step=18050 Epoch=171.7] | Loss=0.00080 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.999 | L2-Norm(final)=2.964 | 1692.5 samples/s | 26.4 steps/s
[Step=18100 Epoch=172.2] | Loss=0.00072 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.997 | L2-Norm(final)=2.965 | 3651.5 samples/s | 57.1 steps/s
[Step=18150 Epoch=172.7] | Loss=0.00066 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.995 | L2-Norm(final)=2.965 | 1723.4 samples/s | 26.9 steps/s
[Step=18200 Epoch=173.1] | Loss=0.00061 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.993 | L2-Norm(final)=2.965 | 3525.8 samples/s | 55.1 steps/s
[Step=18250 Epoch=173.6] | Loss=0.00056 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.991 | L2-Norm(final)=2.966 | 1731.6 samples/s | 27.1 steps/s
[Step=18300 Epoch=174.1] | Loss=0.00052 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.990 | L2-Norm(final)=2.966 | 3532.2 samples/s | 55.2 steps/s
[Step=18350 Epoch=174.6] | Loss=0.00049 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.988 | L2-Norm(final)=2.966 | 1745.4 samples/s | 27.3 steps/s
[Step=18400 Epoch=175.0] | Loss=0.00046 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=2.967 | 3506.7 samples/s | 54.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step18400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=168.1] | Loss=0.07247 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.079 | L2-Norm(final)=2.955 | 3606.3 samples/s | 56.3 steps/s
[Step=17650 Epoch=168.5] | Loss=0.00771 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.035 | L2-Norm(final)=2.954 | 3468.0 samples/s | 54.2 steps/s
[Step=17700 Epoch=169.0] | Loss=0.00407 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.027 | L2-Norm(final)=2.955 | 4493.0 samples/s | 70.2 steps/s
[Step=17750 Epoch=169.5] | Loss=0.00275 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.021 | L2-Norm(final)=2.957 | 1567.5 samples/s | 24.5 steps/s
[Step=17800 Epoch=170.0] | Loss=0.00207 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.017 | L2-Norm(final)=2.958 | 4275.7 samples/s | 66.8 steps/s
[Step=17850 Epoch=170.5] | Loss=0.00167 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.013 | L2-Norm(final)=2.959 | 1609.1 samples/s | 25.1 steps/s
[Step=17900 Epoch=170.9] | Loss=0.00139 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.009 | L2-Norm(final)=2.960 | 4092.7 samples/s | 63.9 steps/s
[Step=17950 Epoch=171.4] | Loss=0.00120 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.006 | L2-Norm(final)=2.960 | 1650.3 samples/s | 25.8 steps/s
[Step=18000 Epoch=171.9] | Loss=0.00105 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.004 | L2-Norm(final)=2.961 | 3908.4 samples/s | 61.1 steps/s
[Step=18050 Epoch=172.4] | Loss=0.00094 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.001 | L2-Norm(final)=2.961 | 1676.8 samples/s | 26.2 steps/s
[Step=18100 Epoch=172.8] | Loss=0.00085 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.999 | L2-Norm(final)=2.961 | 3744.9 samples/s | 58.5 steps/s
[Step=18150 Epoch=173.3] | Loss=0.00077 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.997 | L2-Norm(final)=2.962 | 1686.8 samples/s | 26.4 steps/s
[Step=18200 Epoch=173.8] | Loss=0.00071 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.995 | L2-Norm(final)=2.962 | 3620.2 samples/s | 56.6 steps/s
[Step=18250 Epoch=174.3] | Loss=0.00066 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.994 | L2-Norm(final)=2.962 | 1730.3 samples/s | 27.0 steps/s
[Step=18300 Epoch=174.8] | Loss=0.00061 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.992 | L2-Norm(final)=2.962 | 3553.1 samples/s | 55.5 steps/s
[Step=18350 Epoch=175.2] | Loss=0.00057 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.990 | L2-Norm(final)=2.963 | 1737.6 samples/s | 27.1 steps/s
[Step=18400 Epoch=175.7] | Loss=0.00054 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.989 | L2-Norm(final)=2.963 | 3604.4 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step18400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=165.9] | Loss=0.00616 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.079 | L2-Norm(final)=2.955 | 3550.9 samples/s | 55.5 steps/s
[Step=17650 Epoch=166.3] | Loss=0.00437 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.034 | L2-Norm(final)=2.962 | 3489.3 samples/s | 54.5 steps/s
[Step=17700 Epoch=166.8] | Loss=0.00243 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.026 | L2-Norm(final)=2.966 | 4472.9 samples/s | 69.9 steps/s
[Step=17750 Epoch=167.3] | Loss=0.00165 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.021 | L2-Norm(final)=2.969 | 1581.1 samples/s | 24.7 steps/s
[Step=17800 Epoch=167.7] | Loss=0.00125 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.017 | L2-Norm(final)=2.971 | 4046.7 samples/s | 63.2 steps/s
[Step=17850 Epoch=168.2] | Loss=0.00101 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.013 | L2-Norm(final)=2.972 | 1623.1 samples/s | 25.4 steps/s
[Step=17900 Epoch=168.7] | Loss=0.00085 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.010 | L2-Norm(final)=2.972 | 3813.9 samples/s | 59.6 steps/s
[Step=17950 Epoch=169.1] | Loss=0.00073 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.007 | L2-Norm(final)=2.973 | 1662.3 samples/s | 26.0 steps/s
[Step=18000 Epoch=169.6] | Loss=0.00064 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.004 | L2-Norm(final)=2.973 | 3679.5 samples/s | 57.5 steps/s
[Step=18050 Epoch=170.1] | Loss=0.00057 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.002 | L2-Norm(final)=2.973 | 1722.1 samples/s | 26.9 steps/s
[Step=18100 Epoch=170.6] | Loss=0.00052 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.000 | L2-Norm(final)=2.973 | 3571.7 samples/s | 55.8 steps/s
[Step=18150 Epoch=171.0] | Loss=0.00047 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.998 | L2-Norm(final)=2.974 | 1745.8 samples/s | 27.3 steps/s
[Step=18200 Epoch=171.5] | Loss=0.00043 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.996 | L2-Norm(final)=2.974 | 3492.7 samples/s | 54.6 steps/s
[Step=18250 Epoch=172.0] | Loss=0.00040 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.994 | L2-Norm(final)=2.974 | 1730.2 samples/s | 27.0 steps/s
[Step=18300 Epoch=172.4] | Loss=0.00038 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.992 | L2-Norm(final)=2.974 | 3447.6 samples/s | 53.9 steps/s
[Step=18350 Epoch=172.9] | Loss=0.00035 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.991 | L2-Norm(final)=2.974 | 1735.7 samples/s | 27.1 steps/s
[Step=18400 Epoch=173.4] | Loss=0.00033 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.989 | L2-Norm(final)=2.974 | 3434.1 samples/s | 53.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step18400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=167.8] | Loss=0.17047 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.079 | L2-Norm(final)=2.955 | 3756.6 samples/s | 58.7 steps/s
[Step=17650 Epoch=168.2] | Loss=0.01269 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.038 | L2-Norm(final)=2.949 | 3356.5 samples/s | 52.4 steps/s
[Step=17700 Epoch=168.7] | Loss=0.00656 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.033 | L2-Norm(final)=2.952 | 4489.7 samples/s | 70.2 steps/s
[Step=17750 Epoch=169.2] | Loss=0.00440 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.028 | L2-Norm(final)=2.954 | 1583.6 samples/s | 24.7 steps/s
[Step=17800 Epoch=169.7] | Loss=0.00331 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.023 | L2-Norm(final)=2.956 | 4272.2 samples/s | 66.8 steps/s
[Step=17850 Epoch=170.1] | Loss=0.00266 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.019 | L2-Norm(final)=2.957 | 1596.2 samples/s | 24.9 steps/s
[Step=17900 Epoch=170.6] | Loss=0.00222 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.016 | L2-Norm(final)=2.957 | 3995.3 samples/s | 62.4 steps/s
[Step=17950 Epoch=171.1] | Loss=0.00191 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.013 | L2-Norm(final)=2.958 | 1641.1 samples/s | 25.6 steps/s
[Step=18000 Epoch=171.6] | Loss=0.00167 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.010 | L2-Norm(final)=2.959 | 3883.9 samples/s | 60.7 steps/s
[Step=18050 Epoch=172.0] | Loss=0.00149 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.008 | L2-Norm(final)=2.959 | 1667.6 samples/s | 26.1 steps/s
[Step=18100 Epoch=172.5] | Loss=0.00134 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.006 | L2-Norm(final)=2.959 | 3676.1 samples/s | 57.4 steps/s
[Step=18150 Epoch=173.0] | Loss=0.00122 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.004 | L2-Norm(final)=2.960 | 1675.2 samples/s | 26.2 steps/s
[Step=18200 Epoch=173.5] | Loss=0.00112 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.002 | L2-Norm(final)=2.960 | 3593.2 samples/s | 56.1 steps/s
[Step=18250 Epoch=173.9] | Loss=0.00104 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.000 | L2-Norm(final)=2.961 | 1717.6 samples/s | 26.8 steps/s
[Step=18300 Epoch=174.4] | Loss=0.00097 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.998 | L2-Norm(final)=2.961 | 3564.3 samples/s | 55.7 steps/s
[Step=18350 Epoch=174.9] | Loss=0.00090 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.996 | L2-Norm(final)=2.961 | 1717.7 samples/s | 26.8 steps/s
[Step=18400 Epoch=175.4] | Loss=0.00085 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.995 | L2-Norm(final)=2.961 | 3562.8 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25547 | acc=0.8448 | tpr=0.7802 | fpr=0.0151 | 3810.6 samples/s | 14.9 steps/s
Avg test loss: 0.25660, Avg test acc: 0.84402, Avg tpr: 0.78009, Avg fpr: 0.01538, total FA: 120

Testing server on iccad2012
[Step=  50] | Loss=0.40827 | acc=0.8490 | tpr=0.9735 | fpr=0.1533 | 3791.5 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.41615 | acc=0.8474 | tpr=0.9723 | fpr=0.1549 | 7172.7 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.42215 | acc=0.8457 | tpr=0.9784 | fpr=0.1568 | 7181.1 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.42186 | acc=0.8465 | tpr=0.9760 | fpr=0.1559 | 7264.4 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.42171 | acc=0.8468 | tpr=0.9773 | fpr=0.1555 | 7393.0 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.42086 | acc=0.8469 | tpr=0.9724 | fpr=0.1554 | 7167.1 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.42208 | acc=0.8469 | tpr=0.9706 | fpr=0.1554 | 7084.5 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.42313 | acc=0.8468 | tpr=0.9683 | fpr=0.1554 | 7349.4 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.42676 | acc=0.8458 | tpr=0.9679 | fpr=0.1564 | 7057.3 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.42774 | acc=0.8453 | tpr=0.9687 | fpr=0.1569 | 7129.7 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.42682 | acc=0.8458 | tpr=0.9698 | fpr=0.1565 | 12643.4 samples/s | 49.4 steps/s
Avg test loss: 0.42671, Avg test acc: 0.84581, Avg tpr: 0.96989, Avg fpr: 0.15644, total FA: 21722

server round 23/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.7] | Loss=0.19630 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.991 | L2-Norm(final)=2.983 | 3670.5 samples/s | 57.4 steps/s
[Step=18450 Epoch=90.0] | Loss=0.02751 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.972 | L2-Norm(final)=2.967 | 3607.2 samples/s | 56.4 steps/s
[Step=18500 Epoch=90.2] | Loss=0.02148 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.967 | L2-Norm(final)=2.965 | 3630.3 samples/s | 56.7 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01876 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.965 | L2-Norm(final)=2.967 | 3651.3 samples/s | 57.1 steps/s
[Step=18600 Epoch=90.7] | Loss=0.01712 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.964 | L2-Norm(final)=2.970 | 4467.7 samples/s | 69.8 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01494 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.964 | L2-Norm(final)=2.973 | 1616.8 samples/s | 25.3 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01327 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.964 | L2-Norm(final)=2.977 | 3631.3 samples/s | 56.7 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01216 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.964 | L2-Norm(final)=2.981 | 3650.6 samples/s | 57.0 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01168 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.964 | L2-Norm(final)=2.984 | 4290.4 samples/s | 67.0 steps/s
[Step=18850 Epoch=91.9] | Loss=0.01099 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.964 | L2-Norm(final)=2.987 | 1658.0 samples/s | 25.9 steps/s
[Step=18900 Epoch=92.2] | Loss=0.01043 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.964 | L2-Norm(final)=2.990 | 3630.6 samples/s | 56.7 steps/s
[Step=18950 Epoch=92.4] | Loss=0.00980 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.964 | L2-Norm(final)=2.993 | 3659.3 samples/s | 57.2 steps/s
[Step=19000 Epoch=92.6] | Loss=0.00948 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.963 | L2-Norm(final)=2.995 | 4071.3 samples/s | 63.6 steps/s
[Step=19050 Epoch=92.9] | Loss=0.00914 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.963 | L2-Norm(final)=2.997 | 1707.5 samples/s | 26.7 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00876 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.963 | L2-Norm(final)=3.000 | 3655.3 samples/s | 57.1 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00864 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.963 | L2-Norm(final)=3.002 | 3602.8 samples/s | 56.3 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00831 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.962 | L2-Norm(final)=3.003 | 3835.1 samples/s | 59.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step19200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.8] | Loss=0.16974 | Reg=0.00324 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=17.991 | L2-Norm(final)=2.983 | 3798.7 samples/s | 59.4 steps/s
[Step=18450 Epoch=90.0] | Loss=0.02754 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.974 | L2-Norm(final)=2.969 | 3532.8 samples/s | 55.2 steps/s
[Step=18500 Epoch=90.3] | Loss=0.01951 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.967 | L2-Norm(final)=2.967 | 3715.2 samples/s | 58.0 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01709 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.965 | L2-Norm(final)=2.968 | 3742.7 samples/s | 58.5 steps/s
[Step=18600 Epoch=90.8] | Loss=0.01538 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.963 | L2-Norm(final)=2.969 | 4646.9 samples/s | 72.6 steps/s
[Step=18650 Epoch=91.0] | Loss=0.01322 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.962 | L2-Norm(final)=2.972 | 1620.7 samples/s | 25.3 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01197 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=2.974 | 3726.7 samples/s | 58.2 steps/s
[Step=18750 Epoch=91.5] | Loss=0.01113 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=2.977 | 3734.5 samples/s | 58.4 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01071 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.960 | L2-Norm(final)=2.979 | 4430.5 samples/s | 69.2 steps/s
[Step=18850 Epoch=92.0] | Loss=0.01002 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.980 | 1646.6 samples/s | 25.7 steps/s
[Step=18900 Epoch=92.2] | Loss=0.00939 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.983 | 3597.2 samples/s | 56.2 steps/s
[Step=18950 Epoch=92.5] | Loss=0.00894 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.958 | L2-Norm(final)=2.985 | 3586.9 samples/s | 56.0 steps/s
[Step=19000 Epoch=92.7] | Loss=0.00864 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.958 | L2-Norm(final)=2.987 | 4095.3 samples/s | 64.0 steps/s
[Step=19050 Epoch=93.0] | Loss=0.00838 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.957 | L2-Norm(final)=2.988 | 1689.0 samples/s | 26.4 steps/s
[Step=19100 Epoch=93.2] | Loss=0.00802 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.957 | L2-Norm(final)=2.990 | 3713.5 samples/s | 58.0 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00779 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.956 | L2-Norm(final)=2.992 | 3712.3 samples/s | 58.0 steps/s
[Step=19200 Epoch=93.7] | Loss=0.00759 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.956 | L2-Norm(final)=2.993 | 4025.1 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step19200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.7] | Loss=0.24182 | Reg=0.00324 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=17.991 | L2-Norm(final)=2.983 | 3585.2 samples/s | 56.0 steps/s
[Step=18450 Epoch=89.9] | Loss=0.02874 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.971 | L2-Norm(final)=2.965 | 3755.7 samples/s | 58.7 steps/s
[Step=18500 Epoch=90.1] | Loss=0.02174 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.965 | L2-Norm(final)=2.965 | 3723.2 samples/s | 58.2 steps/s
[Step=18550 Epoch=90.4] | Loss=0.01959 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.961 | L2-Norm(final)=2.965 | 3724.2 samples/s | 58.2 steps/s
[Step=18600 Epoch=90.6] | Loss=0.01760 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=2.967 | 4595.6 samples/s | 71.8 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01593 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.960 | L2-Norm(final)=2.969 | 1640.9 samples/s | 25.6 steps/s
[Step=18700 Epoch=91.1] | Loss=0.01400 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.960 | L2-Norm(final)=2.972 | 3726.9 samples/s | 58.2 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01270 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.960 | L2-Norm(final)=2.975 | 3723.1 samples/s | 58.2 steps/s
[Step=18800 Epoch=91.6] | Loss=0.01221 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.978 | 4391.6 samples/s | 68.6 steps/s
[Step=18850 Epoch=91.8] | Loss=0.01165 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.981 | 1656.2 samples/s | 25.9 steps/s
[Step=18900 Epoch=92.1] | Loss=0.01108 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.983 | 3724.4 samples/s | 58.2 steps/s
[Step=18950 Epoch=92.3] | Loss=0.01055 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.985 | 3744.9 samples/s | 58.5 steps/s
[Step=19000 Epoch=92.6] | Loss=0.01005 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.988 | 4183.0 samples/s | 65.4 steps/s
[Step=19050 Epoch=92.8] | Loss=0.00954 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.990 | 1690.2 samples/s | 26.4 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00923 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.992 | 3651.1 samples/s | 57.0 steps/s
[Step=19150 Epoch=93.3] | Loss=0.00887 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.959 | L2-Norm(final)=2.994 | 3734.4 samples/s | 58.4 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00863 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.959 | L2-Norm(final)=2.997 | 3976.7 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step19200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.7] | Loss=0.08293 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.991 | L2-Norm(final)=2.984 | 4112.7 samples/s | 64.3 steps/s
[Step=18450 Epoch=90.0] | Loss=0.02285 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.968 | L2-Norm(final)=2.972 | 3312.1 samples/s | 51.8 steps/s
[Step=18500 Epoch=90.2] | Loss=0.01726 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.963 | L2-Norm(final)=2.974 | 3716.1 samples/s | 58.1 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01603 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=2.975 | 3727.5 samples/s | 58.2 steps/s
[Step=18600 Epoch=90.7] | Loss=0.01480 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.960 | L2-Norm(final)=2.977 | 4533.5 samples/s | 70.8 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01338 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.960 | L2-Norm(final)=2.979 | 1614.3 samples/s | 25.2 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01193 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.981 | 3637.0 samples/s | 56.8 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01103 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.984 | 3592.2 samples/s | 56.1 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01023 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.959 | L2-Norm(final)=2.987 | 4373.2 samples/s | 68.3 steps/s
[Step=18850 Epoch=91.9] | Loss=0.00970 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.989 | 1667.7 samples/s | 26.1 steps/s
[Step=18900 Epoch=92.2] | Loss=0.00910 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.992 | 3634.0 samples/s | 56.8 steps/s
[Step=18950 Epoch=92.4] | Loss=0.00875 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.960 | L2-Norm(final)=2.995 | 3610.2 samples/s | 56.4 steps/s
[Step=19000 Epoch=92.7] | Loss=0.00851 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.960 | L2-Norm(final)=2.997 | 3727.5 samples/s | 58.2 steps/s
[Step=19050 Epoch=92.9] | Loss=0.00819 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.999 | 1640.5 samples/s | 25.6 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00800 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=3.001 | 3528.2 samples/s | 55.1 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00764 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=3.003 | 3655.2 samples/s | 57.1 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00742 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=3.005 | 3898.9 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step19200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=90.2] | Loss=0.07791 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.991 | L2-Norm(final)=2.984 | 3553.4 samples/s | 55.5 steps/s
[Step=18450 Epoch=90.5] | Loss=0.02932 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.976 | L2-Norm(final)=2.969 | 3487.1 samples/s | 54.5 steps/s
[Step=18500 Epoch=90.7] | Loss=0.02043 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.969 | L2-Norm(final)=2.968 | 3488.9 samples/s | 54.5 steps/s
[Step=18550 Epoch=91.0] | Loss=0.01908 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.966 | L2-Norm(final)=2.970 | 3559.5 samples/s | 55.6 steps/s
[Step=18600 Epoch=91.2] | Loss=0.01717 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.965 | L2-Norm(final)=2.972 | 4483.2 samples/s | 70.0 steps/s
[Step=18650 Epoch=91.5] | Loss=0.01514 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.963 | L2-Norm(final)=2.974 | 1576.3 samples/s | 24.6 steps/s
[Step=18700 Epoch=91.7] | Loss=0.01367 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.963 | L2-Norm(final)=2.977 | 3579.4 samples/s | 55.9 steps/s
[Step=18750 Epoch=91.9] | Loss=0.01258 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.962 | L2-Norm(final)=2.980 | 3577.4 samples/s | 55.9 steps/s
[Step=18800 Epoch=92.2] | Loss=0.01172 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.962 | L2-Norm(final)=2.983 | 4370.0 samples/s | 68.3 steps/s
[Step=18850 Epoch=92.4] | Loss=0.01089 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=2.985 | 1597.1 samples/s | 25.0 steps/s
[Step=18900 Epoch=92.7] | Loss=0.01021 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=2.988 | 3528.9 samples/s | 55.1 steps/s
[Step=18950 Epoch=92.9] | Loss=0.00975 | Reg=0.00323 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.961 | L2-Norm(final)=2.991 | 3607.5 samples/s | 56.4 steps/s
[Step=19000 Epoch=93.2] | Loss=0.00947 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=2.993 | 4366.0 samples/s | 68.2 steps/s
[Step=19050 Epoch=93.4] | Loss=0.00907 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=2.995 | 1634.4 samples/s | 25.5 steps/s
[Step=19100 Epoch=93.7] | Loss=0.00870 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=2.997 | 3607.8 samples/s | 56.4 steps/s
[Step=19150 Epoch=93.9] | Loss=0.00839 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=2.999 | 3545.0 samples/s | 55.4 steps/s
[Step=19200 Epoch=94.2] | Loss=0.00818 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=3.001 | 4080.1 samples/s | 63.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step19200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=174.4] | Loss=0.07636 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.991 | L2-Norm(final)=2.984 | 3482.5 samples/s | 54.4 steps/s
[Step=18450 Epoch=174.8] | Loss=0.00660 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.944 | L2-Norm(final)=2.989 | 3512.3 samples/s | 54.9 steps/s
[Step=18500 Epoch=175.3] | Loss=0.00375 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.937 | L2-Norm(final)=2.989 | 4406.1 samples/s | 68.8 steps/s
[Step=18550 Epoch=175.8] | Loss=0.00256 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.932 | L2-Norm(final)=2.991 | 1425.1 samples/s | 22.3 steps/s
[Step=18600 Epoch=176.3] | Loss=0.00193 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.928 | L2-Norm(final)=2.992 | 3917.6 samples/s | 61.2 steps/s
[Step=18650 Epoch=176.7] | Loss=0.00155 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.925 | L2-Norm(final)=2.993 | 1587.6 samples/s | 24.8 steps/s
[Step=18700 Epoch=177.2] | Loss=0.00130 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.922 | L2-Norm(final)=2.994 | 3863.5 samples/s | 60.4 steps/s
[Step=18750 Epoch=177.7] | Loss=0.00112 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.919 | L2-Norm(final)=2.995 | 1659.2 samples/s | 25.9 steps/s
[Step=18800 Epoch=178.1] | Loss=0.00098 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.917 | L2-Norm(final)=2.995 | 3816.7 samples/s | 59.6 steps/s
[Step=18850 Epoch=178.6] | Loss=0.00088 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.915 | L2-Norm(final)=2.996 | 1684.6 samples/s | 26.3 steps/s
[Step=18900 Epoch=179.1] | Loss=0.00079 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=2.996 | 3547.9 samples/s | 55.4 steps/s
[Step=18950 Epoch=179.6] | Loss=0.00072 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=2.996 | 1690.5 samples/s | 26.4 steps/s
[Step=19000 Epoch=180.0] | Loss=0.00066 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.909 | L2-Norm(final)=2.996 | 3498.5 samples/s | 54.7 steps/s
[Step=19050 Epoch=180.5] | Loss=0.00061 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.907 | L2-Norm(final)=2.997 | 1738.6 samples/s | 27.2 steps/s
[Step=19100 Epoch=181.0] | Loss=0.00057 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.906 | L2-Norm(final)=2.997 | 3352.9 samples/s | 52.4 steps/s
[Step=19150 Epoch=181.5] | Loss=0.00053 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.904 | L2-Norm(final)=2.997 | 1735.4 samples/s | 27.1 steps/s
[Step=19200 Epoch=181.9] | Loss=0.00050 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.903 | L2-Norm(final)=2.997 | 3477.8 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step19200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=175.0] | Loss=0.05352 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.991 | L2-Norm(final)=2.984 | 3985.5 samples/s | 62.3 steps/s
[Step=18450 Epoch=175.5] | Loss=0.00504 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.939 | L2-Norm(final)=2.985 | 3190.0 samples/s | 49.8 steps/s
[Step=18500 Epoch=176.0] | Loss=0.00289 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.932 | L2-Norm(final)=2.987 | 4495.4 samples/s | 70.2 steps/s
[Step=18550 Epoch=176.5] | Loss=0.00197 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.928 | L2-Norm(final)=2.990 | 1565.6 samples/s | 24.5 steps/s
[Step=18600 Epoch=176.9] | Loss=0.00149 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.924 | L2-Norm(final)=2.991 | 4119.3 samples/s | 64.4 steps/s
[Step=18650 Epoch=177.4] | Loss=0.00120 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.921 | L2-Norm(final)=2.992 | 1616.5 samples/s | 25.3 steps/s
[Step=18700 Epoch=177.9] | Loss=0.00100 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.918 | L2-Norm(final)=2.993 | 4019.3 samples/s | 62.8 steps/s
[Step=18750 Epoch=178.4] | Loss=0.00086 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.916 | L2-Norm(final)=2.994 | 1645.4 samples/s | 25.7 steps/s
[Step=18800 Epoch=178.8] | Loss=0.00076 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=2.994 | 3712.9 samples/s | 58.0 steps/s
[Step=18850 Epoch=179.3] | Loss=0.00068 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=2.994 | 1694.7 samples/s | 26.5 steps/s
[Step=18900 Epoch=179.8] | Loss=0.00061 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.909 | L2-Norm(final)=2.995 | 3606.7 samples/s | 56.4 steps/s
[Step=18950 Epoch=180.3] | Loss=0.00056 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.907 | L2-Norm(final)=2.995 | 1737.8 samples/s | 27.2 steps/s
[Step=19000 Epoch=180.7] | Loss=0.00051 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.906 | L2-Norm(final)=2.995 | 3603.9 samples/s | 56.3 steps/s
[Step=19050 Epoch=181.2] | Loss=0.00048 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.904 | L2-Norm(final)=2.996 | 1754.4 samples/s | 27.4 steps/s
[Step=19100 Epoch=181.7] | Loss=0.00044 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.903 | L2-Norm(final)=2.996 | 3522.6 samples/s | 55.0 steps/s
[Step=19150 Epoch=182.2] | Loss=0.00042 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.901 | L2-Norm(final)=2.996 | 1716.3 samples/s | 26.8 steps/s
[Step=19200 Epoch=182.6] | Loss=0.00039 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.900 | L2-Norm(final)=2.996 | 3524.6 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step19200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=175.7] | Loss=0.14004 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.991 | L2-Norm(final)=2.984 | 3947.8 samples/s | 61.7 steps/s
[Step=18450 Epoch=176.2] | Loss=0.00600 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.941 | L2-Norm(final)=2.987 | 3245.1 samples/s | 50.7 steps/s
[Step=18500 Epoch=176.7] | Loss=0.00332 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.937 | L2-Norm(final)=2.990 | 4508.4 samples/s | 70.4 steps/s
[Step=18550 Epoch=177.1] | Loss=0.00224 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.933 | L2-Norm(final)=2.993 | 1554.6 samples/s | 24.3 steps/s
[Step=18600 Epoch=177.6] | Loss=0.00169 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.930 | L2-Norm(final)=2.994 | 4137.4 samples/s | 64.6 steps/s
[Step=18650 Epoch=178.1] | Loss=0.00135 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.927 | L2-Norm(final)=2.995 | 1612.3 samples/s | 25.2 steps/s
[Step=18700 Epoch=178.6] | Loss=0.00113 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.924 | L2-Norm(final)=2.996 | 4093.2 samples/s | 64.0 steps/s
[Step=18750 Epoch=179.1] | Loss=0.00098 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.922 | L2-Norm(final)=2.996 | 1652.0 samples/s | 25.8 steps/s
[Step=18800 Epoch=179.5] | Loss=0.00086 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.920 | L2-Norm(final)=2.997 | 3917.3 samples/s | 61.2 steps/s
[Step=18850 Epoch=180.0] | Loss=0.00076 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.918 | L2-Norm(final)=2.997 | 1659.4 samples/s | 25.9 steps/s
[Step=18900 Epoch=180.5] | Loss=0.00069 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.916 | L2-Norm(final)=2.997 | 3760.9 samples/s | 58.8 steps/s
[Step=18950 Epoch=181.0] | Loss=0.00063 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.914 | L2-Norm(final)=2.998 | 1699.5 samples/s | 26.6 steps/s
[Step=19000 Epoch=181.4] | Loss=0.00058 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=2.998 | 3630.8 samples/s | 56.7 steps/s
[Step=19050 Epoch=181.9] | Loss=0.00054 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=2.998 | 1738.8 samples/s | 27.2 steps/s
[Step=19100 Epoch=182.4] | Loss=0.00050 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.909 | L2-Norm(final)=2.998 | 3522.7 samples/s | 55.0 steps/s
[Step=19150 Epoch=182.9] | Loss=0.00047 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.908 | L2-Norm(final)=2.998 | 1713.0 samples/s | 26.8 steps/s
[Step=19200 Epoch=183.3] | Loss=0.00044 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.906 | L2-Norm(final)=2.998 | 3526.8 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step19200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=173.4] | Loss=0.04330 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.991 | L2-Norm(final)=2.984 | 3534.9 samples/s | 55.2 steps/s
[Step=18450 Epoch=173.9] | Loss=0.00619 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.945 | L2-Norm(final)=2.985 | 3462.6 samples/s | 54.1 steps/s
[Step=18500 Epoch=174.3] | Loss=0.00338 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.939 | L2-Norm(final)=2.987 | 4307.2 samples/s | 67.3 steps/s
[Step=18550 Epoch=174.8] | Loss=0.00227 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.935 | L2-Norm(final)=2.988 | 1586.1 samples/s | 24.8 steps/s
[Step=18600 Epoch=175.3] | Loss=0.00171 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.931 | L2-Norm(final)=2.989 | 4151.2 samples/s | 64.9 steps/s
[Step=18650 Epoch=175.7] | Loss=0.00138 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.927 | L2-Norm(final)=2.990 | 1629.0 samples/s | 25.5 steps/s
[Step=18700 Epoch=176.2] | Loss=0.00115 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.924 | L2-Norm(final)=2.990 | 3903.1 samples/s | 61.0 steps/s
[Step=18750 Epoch=176.7] | Loss=0.00099 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.921 | L2-Norm(final)=2.991 | 1677.3 samples/s | 26.2 steps/s
[Step=18800 Epoch=177.1] | Loss=0.00087 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.918 | L2-Norm(final)=2.991 | 3552.9 samples/s | 55.5 steps/s
[Step=18850 Epoch=177.6] | Loss=0.00078 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.916 | L2-Norm(final)=2.992 | 1585.8 samples/s | 24.8 steps/s
[Step=18900 Epoch=178.1] | Loss=0.00070 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.914 | L2-Norm(final)=2.992 | 3446.4 samples/s | 53.9 steps/s
[Step=18950 Epoch=178.6] | Loss=0.00064 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=2.992 | 1518.8 samples/s | 23.7 steps/s
[Step=19000 Epoch=179.0] | Loss=0.00059 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.910 | L2-Norm(final)=2.993 | 3092.8 samples/s | 48.3 steps/s
[Step=19050 Epoch=179.5] | Loss=0.00055 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.908 | L2-Norm(final)=2.993 | 1544.4 samples/s | 24.1 steps/s
[Step=19100 Epoch=180.0] | Loss=0.00051 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.906 | L2-Norm(final)=2.993 | 3026.3 samples/s | 47.3 steps/s
[Step=19150 Epoch=180.4] | Loss=0.00048 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.905 | L2-Norm(final)=2.993 | 1693.1 samples/s | 26.5 steps/s
[Step=19200 Epoch=180.9] | Loss=0.00045 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.903 | L2-Norm(final)=2.994 | 3249.1 samples/s | 50.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step19200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=175.4] | Loss=0.11342 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.991 | L2-Norm(final)=2.985 | 3670.9 samples/s | 57.4 steps/s
[Step=18450 Epoch=175.8] | Loss=0.00961 | Reg=0.00322 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.949 | L2-Norm(final)=2.987 | 3381.6 samples/s | 52.8 steps/s
[Step=18500 Epoch=176.3] | Loss=0.00523 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.946 | L2-Norm(final)=2.992 | 4397.0 samples/s | 68.7 steps/s
[Step=18550 Epoch=176.8] | Loss=0.00352 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.941 | L2-Norm(final)=2.995 | 1574.1 samples/s | 24.6 steps/s
[Step=18600 Epoch=177.3] | Loss=0.00265 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.937 | L2-Norm(final)=2.996 | 4287.5 samples/s | 67.0 steps/s
[Step=18650 Epoch=177.8] | Loss=0.00213 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.934 | L2-Norm(final)=2.997 | 1601.1 samples/s | 25.0 steps/s
[Step=18700 Epoch=178.2] | Loss=0.00179 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.931 | L2-Norm(final)=2.998 | 4025.9 samples/s | 62.9 steps/s
[Step=18750 Epoch=178.7] | Loss=0.00154 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.928 | L2-Norm(final)=2.998 | 1631.7 samples/s | 25.5 steps/s
[Step=18800 Epoch=179.2] | Loss=0.00135 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.926 | L2-Norm(final)=2.999 | 3779.1 samples/s | 59.0 steps/s
[Step=18850 Epoch=179.7] | Loss=0.00120 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.924 | L2-Norm(final)=2.999 | 1649.6 samples/s | 25.8 steps/s
[Step=18900 Epoch=180.1] | Loss=0.00109 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.922 | L2-Norm(final)=2.999 | 3760.3 samples/s | 58.8 steps/s
[Step=18950 Epoch=180.6] | Loss=0.00099 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.920 | L2-Norm(final)=3.000 | 1707.8 samples/s | 26.7 steps/s
[Step=19000 Epoch=181.1] | Loss=0.00091 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.918 | L2-Norm(final)=3.000 | 3577.8 samples/s | 55.9 steps/s
[Step=19050 Epoch=181.6] | Loss=0.00084 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.916 | L2-Norm(final)=3.000 | 1719.2 samples/s | 26.9 steps/s
[Step=19100 Epoch=182.0] | Loss=0.00078 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.915 | L2-Norm(final)=3.000 | 3513.7 samples/s | 54.9 steps/s
[Step=19150 Epoch=182.5] | Loss=0.00073 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=3.000 | 1737.2 samples/s | 27.1 steps/s
[Step=19200 Epoch=183.0] | Loss=0.00069 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=3.001 | 3520.4 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24272 | acc=0.8512 | tpr=0.7897 | fpr=0.0154 | 3586.2 samples/s | 14.0 steps/s
Avg test loss: 0.24336, Avg test acc: 0.85027, Avg tpr: 0.78924, Avg fpr: 0.01551, total FA: 121

Testing server on iccad2012
[Step=  50] | Loss=0.41374 | acc=0.8489 | tpr=0.9779 | fpr=0.1534 | 3296.5 samples/s | 12.9 steps/s
[Step= 100] | Loss=0.42171 | acc=0.8473 | tpr=0.9765 | fpr=0.1551 | 7511.9 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.42825 | acc=0.8453 | tpr=0.9813 | fpr=0.1572 | 7109.7 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.42814 | acc=0.8461 | tpr=0.9781 | fpr=0.1563 | 7168.4 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.42778 | acc=0.8462 | tpr=0.9790 | fpr=0.1562 | 7195.8 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.42687 | acc=0.8468 | tpr=0.9753 | fpr=0.1556 | 7414.3 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.42833 | acc=0.8464 | tpr=0.9737 | fpr=0.1559 | 7040.5 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.42940 | acc=0.8463 | tpr=0.9721 | fpr=0.1560 | 7450.8 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.43269 | acc=0.8454 | tpr=0.9713 | fpr=0.1569 | 7357.3 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.43367 | acc=0.8447 | tpr=0.9718 | fpr=0.1576 | 6968.4 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.43281 | acc=0.8448 | tpr=0.9725 | fpr=0.1575 | 12776.0 samples/s | 49.9 steps/s
Avg test loss: 0.43265, Avg test acc: 0.84486, Avg tpr: 0.97266, Avg fpr: 0.15746, total FA: 21863

server round 24/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.6] | Loss=0.18689 | Reg=0.00321 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=17.906 | L2-Norm(final)=3.013 | 3787.4 samples/s | 59.2 steps/s
[Step=19250 Epoch=93.9] | Loss=0.03109 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.887 | L2-Norm(final)=2.999 | 3560.4 samples/s | 55.6 steps/s
[Step=19300 Epoch=94.1] | Loss=0.02276 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.881 | L2-Norm(final)=2.996 | 3677.6 samples/s | 57.5 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01919 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.878 | L2-Norm(final)=2.996 | 3671.4 samples/s | 57.4 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01689 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.877 | L2-Norm(final)=2.998 | 4542.0 samples/s | 71.0 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01469 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.876 | L2-Norm(final)=3.000 | 1631.7 samples/s | 25.5 steps/s
[Step=19500 Epoch=95.1] | Loss=0.01338 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.876 | L2-Norm(final)=3.003 | 3659.7 samples/s | 57.2 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01236 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.875 | L2-Norm(final)=3.005 | 3669.4 samples/s | 57.3 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01136 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.875 | L2-Norm(final)=3.008 | 4300.4 samples/s | 67.2 steps/s
[Step=19650 Epoch=95.8] | Loss=0.01084 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.875 | L2-Norm(final)=3.011 | 1644.8 samples/s | 25.7 steps/s
[Step=19700 Epoch=96.1] | Loss=0.01029 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.875 | L2-Norm(final)=3.014 | 3738.9 samples/s | 58.4 steps/s
[Step=19750 Epoch=96.3] | Loss=0.00973 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.875 | L2-Norm(final)=3.016 | 3731.5 samples/s | 58.3 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00928 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.018 | 4203.2 samples/s | 65.7 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00902 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.021 | 1708.8 samples/s | 26.7 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00870 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.023 | 3725.3 samples/s | 58.2 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00838 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.025 | 3735.9 samples/s | 58.4 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00818 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.027 | 3913.7 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.7] | Loss=0.27638 | Reg=0.00321 | FP-Reg=0.000 | acc=0.7500 | L2-Norm=17.906 | L2-Norm(final)=3.013 | 4008.8 samples/s | 62.6 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02604 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.900 | L2-Norm(final)=3.000 | 3545.1 samples/s | 55.4 steps/s
[Step=19300 Epoch=94.2] | Loss=0.01900 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.895 | L2-Norm(final)=3.001 | 3605.4 samples/s | 56.3 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01663 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.892 | L2-Norm(final)=3.003 | 3588.6 samples/s | 56.1 steps/s
[Step=19400 Epoch=94.7] | Loss=0.01535 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.889 | L2-Norm(final)=3.004 | 4505.1 samples/s | 70.4 steps/s
[Step=19450 Epoch=94.9] | Loss=0.01296 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.887 | L2-Norm(final)=3.005 | 1606.1 samples/s | 25.1 steps/s
[Step=19500 Epoch=95.2] | Loss=0.01154 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.885 | L2-Norm(final)=3.008 | 3661.6 samples/s | 57.2 steps/s
[Step=19550 Epoch=95.4] | Loss=0.01073 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.884 | L2-Norm(final)=3.010 | 3673.0 samples/s | 57.4 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01060 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.883 | L2-Norm(final)=3.012 | 4350.7 samples/s | 68.0 steps/s
[Step=19650 Epoch=95.9] | Loss=0.00997 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.882 | L2-Norm(final)=3.013 | 1668.0 samples/s | 26.1 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00933 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.882 | L2-Norm(final)=3.015 | 3652.5 samples/s | 57.1 steps/s
[Step=19750 Epoch=96.4] | Loss=0.00904 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.881 | L2-Norm(final)=3.016 | 3646.6 samples/s | 57.0 steps/s
[Step=19800 Epoch=96.6] | Loss=0.00873 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.880 | L2-Norm(final)=3.018 | 4154.7 samples/s | 64.9 steps/s
[Step=19850 Epoch=96.9] | Loss=0.00837 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.879 | L2-Norm(final)=3.019 | 1681.7 samples/s | 26.3 steps/s
[Step=19900 Epoch=97.1] | Loss=0.00806 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.879 | L2-Norm(final)=3.021 | 3727.4 samples/s | 58.2 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00778 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.878 | L2-Norm(final)=3.022 | 3722.4 samples/s | 58.2 steps/s
[Step=20000 Epoch=97.6] | Loss=0.00748 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.878 | L2-Norm(final)=3.023 | 4093.2 samples/s | 64.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step20000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.6] | Loss=0.23009 | Reg=0.00321 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=17.906 | L2-Norm(final)=3.013 | 3688.4 samples/s | 57.6 steps/s
[Step=19250 Epoch=93.8] | Loss=0.02903 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.890 | L2-Norm(final)=3.004 | 3666.8 samples/s | 57.3 steps/s
[Step=19300 Epoch=94.0] | Loss=0.02184 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.886 | L2-Norm(final)=3.000 | 3738.3 samples/s | 58.4 steps/s
[Step=19350 Epoch=94.3] | Loss=0.01893 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.885 | L2-Norm(final)=3.002 | 3676.8 samples/s | 57.5 steps/s
[Step=19400 Epoch=94.5] | Loss=0.01705 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.884 | L2-Norm(final)=3.003 | 4535.5 samples/s | 70.9 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01486 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.883 | L2-Norm(final)=3.005 | 1635.2 samples/s | 25.5 steps/s
[Step=19500 Epoch=95.0] | Loss=0.01349 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.882 | L2-Norm(final)=3.008 | 3706.8 samples/s | 57.9 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01230 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.882 | L2-Norm(final)=3.010 | 3704.4 samples/s | 57.9 steps/s
[Step=19600 Epoch=95.5] | Loss=0.01173 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.881 | L2-Norm(final)=3.013 | 4305.1 samples/s | 67.3 steps/s
[Step=19650 Epoch=95.7] | Loss=0.01099 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=3.015 | 1651.1 samples/s | 25.8 steps/s
[Step=19700 Epoch=96.0] | Loss=0.01034 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=3.017 | 3740.7 samples/s | 58.4 steps/s
[Step=19750 Epoch=96.2] | Loss=0.00989 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=3.019 | 3720.2 samples/s | 58.1 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00947 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=3.022 | 4113.6 samples/s | 64.3 steps/s
[Step=19850 Epoch=96.7] | Loss=0.00910 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=3.024 | 1681.5 samples/s | 26.3 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00870 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=3.026 | 3639.5 samples/s | 56.9 steps/s
[Step=19950 Epoch=97.2] | Loss=0.00847 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.881 | L2-Norm(final)=3.028 | 3605.0 samples/s | 56.3 steps/s
[Step=20000 Epoch=97.4] | Loss=0.00828 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.880 | L2-Norm(final)=3.030 | 3875.0 samples/s | 60.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step20000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.6] | Loss=0.12179 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.906 | L2-Norm(final)=3.014 | 3842.0 samples/s | 60.0 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02687 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.889 | L2-Norm(final)=3.002 | 3586.7 samples/s | 56.0 steps/s
[Step=19300 Epoch=94.1] | Loss=0.02136 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.885 | L2-Norm(final)=2.998 | 3726.8 samples/s | 58.2 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01894 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.883 | L2-Norm(final)=2.997 | 3670.7 samples/s | 57.4 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01679 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.883 | L2-Norm(final)=2.999 | 4627.1 samples/s | 72.3 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01478 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.882 | L2-Norm(final)=3.001 | 1619.7 samples/s | 25.3 steps/s
[Step=19500 Epoch=95.1] | Loss=0.01322 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.882 | L2-Norm(final)=3.004 | 3651.7 samples/s | 57.1 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01220 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.882 | L2-Norm(final)=3.006 | 3623.6 samples/s | 56.6 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01127 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.882 | L2-Norm(final)=3.009 | 4224.0 samples/s | 66.0 steps/s
[Step=19650 Epoch=95.8] | Loss=0.01064 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.881 | L2-Norm(final)=3.012 | 1678.9 samples/s | 26.2 steps/s
[Step=19700 Epoch=96.1] | Loss=0.01003 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=3.014 | 3737.0 samples/s | 58.4 steps/s
[Step=19750 Epoch=96.3] | Loss=0.00945 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=3.017 | 3733.9 samples/s | 58.3 steps/s
[Step=19800 Epoch=96.6] | Loss=0.00901 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.880 | L2-Norm(final)=3.019 | 4175.7 samples/s | 65.2 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00857 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.880 | L2-Norm(final)=3.021 | 1705.0 samples/s | 26.6 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00818 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.880 | L2-Norm(final)=3.023 | 3648.7 samples/s | 57.0 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00794 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.880 | L2-Norm(final)=3.026 | 3670.4 samples/s | 57.4 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00775 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.879 | L2-Norm(final)=3.028 | 3923.8 samples/s | 61.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step20000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=94.2] | Loss=0.05805 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.906 | L2-Norm(final)=3.014 | 3611.8 samples/s | 56.4 steps/s
[Step=19250 Epoch=94.4] | Loss=0.02056 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.887 | L2-Norm(final)=3.009 | 3637.5 samples/s | 56.8 steps/s
[Step=19300 Epoch=94.6] | Loss=0.01874 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=3.010 | 3650.5 samples/s | 57.0 steps/s
[Step=19350 Epoch=94.9] | Loss=0.01821 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.878 | L2-Norm(final)=3.008 | 3642.9 samples/s | 56.9 steps/s
[Step=19400 Epoch=95.1] | Loss=0.01614 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.876 | L2-Norm(final)=3.007 | 4713.3 samples/s | 73.6 steps/s
[Step=19450 Epoch=95.4] | Loss=0.01401 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.875 | L2-Norm(final)=3.008 | 1624.5 samples/s | 25.4 steps/s
[Step=19500 Epoch=95.6] | Loss=0.01278 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.875 | L2-Norm(final)=3.010 | 3744.6 samples/s | 58.5 steps/s
[Step=19550 Epoch=95.9] | Loss=0.01170 | Reg=0.00320 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.875 | L2-Norm(final)=3.012 | 3719.4 samples/s | 58.1 steps/s
[Step=19600 Epoch=96.1] | Loss=0.01105 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.015 | 4525.6 samples/s | 70.7 steps/s
[Step=19650 Epoch=96.4] | Loss=0.01020 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.017 | 1596.2 samples/s | 24.9 steps/s
[Step=19700 Epoch=96.6] | Loss=0.00962 | Reg=0.00319 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.874 | L2-Norm(final)=3.020 | 3685.1 samples/s | 57.6 steps/s
[Step=19750 Epoch=96.9] | Loss=0.00929 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.022 | 3734.1 samples/s | 58.3 steps/s
[Step=19800 Epoch=97.1] | Loss=0.00886 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.024 | 4384.5 samples/s | 68.5 steps/s
[Step=19850 Epoch=97.3] | Loss=0.00840 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.026 | 1680.4 samples/s | 26.3 steps/s
[Step=19900 Epoch=97.6] | Loss=0.00812 | Reg=0.00319 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.874 | L2-Norm(final)=3.028 | 3635.2 samples/s | 56.8 steps/s
[Step=19950 Epoch=97.8] | Loss=0.00792 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.030 | 3654.2 samples/s | 57.1 steps/s
[Step=20000 Epoch=98.1] | Loss=0.00773 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.873 | L2-Norm(final)=3.032 | 4147.7 samples/s | 64.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step20000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=181.9] | Loss=0.01620 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.906 | L2-Norm(final)=3.015 | 3979.9 samples/s | 62.2 steps/s
[Step=19250 Epoch=182.4] | Loss=0.00280 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.854 | L2-Norm(final)=3.024 | 3233.3 samples/s | 50.5 steps/s
[Step=19300 Epoch=182.9] | Loss=0.00153 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.847 | L2-Norm(final)=3.028 | 4469.4 samples/s | 69.8 steps/s
[Step=19350 Epoch=183.4] | Loss=0.00104 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.841 | L2-Norm(final)=3.030 | 1575.3 samples/s | 24.6 steps/s
[Step=19400 Epoch=183.8] | Loss=0.00078 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.837 | L2-Norm(final)=3.031 | 4086.0 samples/s | 63.8 steps/s
[Step=19450 Epoch=184.3] | Loss=0.00063 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.834 | L2-Norm(final)=3.032 | 1620.1 samples/s | 25.3 steps/s
[Step=19500 Epoch=184.8] | Loss=0.00053 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.831 | L2-Norm(final)=3.032 | 3991.3 samples/s | 62.4 steps/s
[Step=19550 Epoch=185.3] | Loss=0.00046 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.032 | 1655.7 samples/s | 25.9 steps/s
[Step=19600 Epoch=185.7] | Loss=0.00040 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.826 | L2-Norm(final)=3.032 | 3799.8 samples/s | 59.4 steps/s
[Step=19650 Epoch=186.2] | Loss=0.00036 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.824 | L2-Norm(final)=3.033 | 1663.3 samples/s | 26.0 steps/s
[Step=19700 Epoch=186.7] | Loss=0.00033 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.822 | L2-Norm(final)=3.033 | 3578.5 samples/s | 55.9 steps/s
[Step=19750 Epoch=187.1] | Loss=0.00030 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.820 | L2-Norm(final)=3.033 | 1693.3 samples/s | 26.5 steps/s
[Step=19800 Epoch=187.6] | Loss=0.00028 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.818 | L2-Norm(final)=3.033 | 3490.0 samples/s | 54.5 steps/s
[Step=19850 Epoch=188.1] | Loss=0.00026 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.816 | L2-Norm(final)=3.033 | 1721.7 samples/s | 26.9 steps/s
[Step=19900 Epoch=188.6] | Loss=0.00024 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.815 | L2-Norm(final)=3.033 | 3585.7 samples/s | 56.0 steps/s
[Step=19950 Epoch=189.0] | Loss=0.00023 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.813 | L2-Norm(final)=3.033 | 1764.0 samples/s | 27.6 steps/s
[Step=20000 Epoch=189.5] | Loss=0.00021 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.812 | L2-Norm(final)=3.033 | 3530.4 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step20000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=182.6] | Loss=0.16986 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.906 | L2-Norm(final)=3.014 | 3608.2 samples/s | 56.4 steps/s
[Step=19250 Epoch=183.1] | Loss=0.00803 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.863 | L2-Norm(final)=3.011 | 3415.0 samples/s | 53.4 steps/s
[Step=19300 Epoch=183.6] | Loss=0.00427 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.857 | L2-Norm(final)=3.012 | 4397.1 samples/s | 68.7 steps/s
[Step=19350 Epoch=184.1] | Loss=0.00287 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.852 | L2-Norm(final)=3.014 | 1580.6 samples/s | 24.7 steps/s
[Step=19400 Epoch=184.5] | Loss=0.00216 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.848 | L2-Norm(final)=3.015 | 4184.8 samples/s | 65.4 steps/s
[Step=19450 Epoch=185.0] | Loss=0.00174 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.844 | L2-Norm(final)=3.016 | 1612.5 samples/s | 25.2 steps/s
[Step=19500 Epoch=185.5] | Loss=0.00145 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.840 | L2-Norm(final)=3.016 | 4000.7 samples/s | 62.5 steps/s
[Step=19550 Epoch=186.0] | Loss=0.00125 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.837 | L2-Norm(final)=3.017 | 1658.8 samples/s | 25.9 steps/s
[Step=19600 Epoch=186.4] | Loss=0.00110 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.834 | L2-Norm(final)=3.018 | 3734.9 samples/s | 58.4 steps/s
[Step=19650 Epoch=186.9] | Loss=0.00098 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.832 | L2-Norm(final)=3.018 | 1698.7 samples/s | 26.5 steps/s
[Step=19700 Epoch=187.4] | Loss=0.00088 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.829 | L2-Norm(final)=3.018 | 3562.1 samples/s | 55.7 steps/s
[Step=19750 Epoch=187.9] | Loss=0.00080 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.019 | 1726.4 samples/s | 27.0 steps/s
[Step=19800 Epoch=188.3] | Loss=0.00074 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.825 | L2-Norm(final)=3.019 | 3596.8 samples/s | 56.2 steps/s
[Step=19850 Epoch=188.8] | Loss=0.00068 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.824 | L2-Norm(final)=3.020 | 1760.5 samples/s | 27.5 steps/s
[Step=19900 Epoch=189.3] | Loss=0.00064 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.822 | L2-Norm(final)=3.020 | 3480.9 samples/s | 54.4 steps/s
[Step=19950 Epoch=189.8] | Loss=0.00059 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.820 | L2-Norm(final)=3.020 | 1737.3 samples/s | 27.1 steps/s
[Step=20000 Epoch=190.2] | Loss=0.00056 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.819 | L2-Norm(final)=3.021 | 3526.3 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step20000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=183.4] | Loss=0.10984 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.906 | L2-Norm(final)=3.014 | 3963.8 samples/s | 61.9 steps/s
[Step=19250 Epoch=183.8] | Loss=0.00617 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.861 | L2-Norm(final)=3.018 | 3257.8 samples/s | 50.9 steps/s
[Step=19300 Epoch=184.3] | Loss=0.00332 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.855 | L2-Norm(final)=3.019 | 4508.7 samples/s | 70.4 steps/s
[Step=19350 Epoch=184.8] | Loss=0.00224 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.851 | L2-Norm(final)=3.020 | 1590.6 samples/s | 24.9 steps/s
[Step=19400 Epoch=185.3] | Loss=0.00169 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.847 | L2-Norm(final)=3.021 | 4292.9 samples/s | 67.1 steps/s
[Step=19450 Epoch=185.7] | Loss=0.00136 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.844 | L2-Norm(final)=3.022 | 1613.3 samples/s | 25.2 steps/s
[Step=19500 Epoch=186.2] | Loss=0.00114 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.841 | L2-Norm(final)=3.022 | 3946.5 samples/s | 61.7 steps/s
[Step=19550 Epoch=186.7] | Loss=0.00098 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.838 | L2-Norm(final)=3.023 | 1623.3 samples/s | 25.4 steps/s
[Step=19600 Epoch=187.2] | Loss=0.00086 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.836 | L2-Norm(final)=3.023 | 3925.7 samples/s | 61.3 steps/s
[Step=19650 Epoch=187.6] | Loss=0.00076 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.834 | L2-Norm(final)=3.023 | 1652.8 samples/s | 25.8 steps/s
[Step=19700 Epoch=188.1] | Loss=0.00069 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.832 | L2-Norm(final)=3.024 | 3739.2 samples/s | 58.4 steps/s
[Step=19750 Epoch=188.6] | Loss=0.00063 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.830 | L2-Norm(final)=3.024 | 1675.1 samples/s | 26.2 steps/s
[Step=19800 Epoch=189.1] | Loss=0.00058 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.024 | 3632.3 samples/s | 56.8 steps/s
[Step=19850 Epoch=189.6] | Loss=0.00054 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.024 | 1718.5 samples/s | 26.9 steps/s
[Step=19900 Epoch=190.0] | Loss=0.00050 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.825 | L2-Norm(final)=3.024 | 3496.8 samples/s | 54.6 steps/s
[Step=19950 Epoch=190.5] | Loss=0.00047 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.824 | L2-Norm(final)=3.025 | 1727.4 samples/s | 27.0 steps/s
[Step=20000 Epoch=191.0] | Loss=0.00044 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.822 | L2-Norm(final)=3.025 | 3596.7 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step20000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=180.9] | Loss=0.14735 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.906 | L2-Norm(final)=3.014 | 3596.5 samples/s | 56.2 steps/s
[Step=19250 Epoch=181.4] | Loss=0.00736 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.862 | L2-Norm(final)=3.017 | 3370.2 samples/s | 52.7 steps/s
[Step=19300 Epoch=181.9] | Loss=0.00422 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.856 | L2-Norm(final)=3.016 | 4342.6 samples/s | 67.9 steps/s
[Step=19350 Epoch=182.3] | Loss=0.00283 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.851 | L2-Norm(final)=3.017 | 1593.4 samples/s | 24.9 steps/s
[Step=19400 Epoch=182.8] | Loss=0.00214 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.847 | L2-Norm(final)=3.018 | 4078.5 samples/s | 63.7 steps/s
[Step=19450 Epoch=183.3] | Loss=0.00172 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.843 | L2-Norm(final)=3.018 | 1635.1 samples/s | 25.5 steps/s
[Step=19500 Epoch=183.7] | Loss=0.00143 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.840 | L2-Norm(final)=3.018 | 3912.7 samples/s | 61.1 steps/s
[Step=19550 Epoch=184.2] | Loss=0.00123 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.837 | L2-Norm(final)=3.019 | 1690.5 samples/s | 26.4 steps/s
[Step=19600 Epoch=184.7] | Loss=0.00108 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.835 | L2-Norm(final)=3.019 | 3640.9 samples/s | 56.9 steps/s
[Step=19650 Epoch=185.2] | Loss=0.00096 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.833 | L2-Norm(final)=3.019 | 1709.5 samples/s | 26.7 steps/s
[Step=19700 Epoch=185.6] | Loss=0.00087 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.831 | L2-Norm(final)=3.019 | 3524.5 samples/s | 55.1 steps/s
[Step=19750 Epoch=186.1] | Loss=0.00079 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.829 | L2-Norm(final)=3.020 | 1700.3 samples/s | 26.6 steps/s
[Step=19800 Epoch=186.6] | Loss=0.00073 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.020 | 3425.4 samples/s | 53.5 steps/s
[Step=19850 Epoch=187.0] | Loss=0.00067 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.825 | L2-Norm(final)=3.020 | 1721.1 samples/s | 26.9 steps/s
[Step=19900 Epoch=187.5] | Loss=0.00063 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.824 | L2-Norm(final)=3.020 | 3471.3 samples/s | 54.2 steps/s
[Step=19950 Epoch=188.0] | Loss=0.00059 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.822 | L2-Norm(final)=3.020 | 1760.9 samples/s | 27.5 steps/s
[Step=20000 Epoch=188.5] | Loss=0.00055 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.821 | L2-Norm(final)=3.021 | 3431.2 samples/s | 53.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step20000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=183.0] | Loss=0.08525 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.906 | L2-Norm(final)=3.014 | 3606.7 samples/s | 56.4 steps/s
[Step=19250 Epoch=183.5] | Loss=0.00787 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.858 | L2-Norm(final)=3.017 | 3406.9 samples/s | 53.2 steps/s
[Step=19300 Epoch=183.9] | Loss=0.00407 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.849 | L2-Norm(final)=3.020 | 4490.1 samples/s | 70.2 steps/s
[Step=19350 Epoch=184.4] | Loss=0.00274 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.843 | L2-Norm(final)=3.022 | 1574.2 samples/s | 24.6 steps/s
[Step=19400 Epoch=184.9] | Loss=0.00206 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.838 | L2-Norm(final)=3.024 | 4202.3 samples/s | 65.7 steps/s
[Step=19450 Epoch=185.4] | Loss=0.00167 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.834 | L2-Norm(final)=3.024 | 1592.3 samples/s | 24.9 steps/s
[Step=19500 Epoch=185.9] | Loss=0.00139 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.832 | L2-Norm(final)=3.025 | 4096.9 samples/s | 64.0 steps/s
[Step=19550 Epoch=186.3] | Loss=0.00120 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.829 | L2-Norm(final)=3.025 | 1628.3 samples/s | 25.4 steps/s
[Step=19600 Epoch=186.8] | Loss=0.00105 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.025 | 3852.6 samples/s | 60.2 steps/s
[Step=19650 Epoch=187.3] | Loss=0.00094 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.825 | L2-Norm(final)=3.026 | 1677.7 samples/s | 26.2 steps/s
[Step=19700 Epoch=187.8] | Loss=0.00085 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.823 | L2-Norm(final)=3.026 | 3658.3 samples/s | 57.2 steps/s
[Step=19750 Epoch=188.2] | Loss=0.00077 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.821 | L2-Norm(final)=3.026 | 1705.0 samples/s | 26.6 steps/s
[Step=19800 Epoch=188.7] | Loss=0.00071 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.819 | L2-Norm(final)=3.026 | 3596.2 samples/s | 56.2 steps/s
[Step=19850 Epoch=189.2] | Loss=0.00066 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.818 | L2-Norm(final)=3.026 | 1722.1 samples/s | 26.9 steps/s
[Step=19900 Epoch=189.7] | Loss=0.00061 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.816 | L2-Norm(final)=3.026 | 3498.7 samples/s | 54.7 steps/s
[Step=19950 Epoch=190.1] | Loss=0.00057 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.815 | L2-Norm(final)=3.026 | 1726.2 samples/s | 27.0 steps/s
[Step=20000 Epoch=190.6] | Loss=0.00054 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.813 | L2-Norm(final)=3.026 | 3584.7 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20848 | acc=0.8721 | tpr=0.8214 | fpr=0.0178 | 3740.5 samples/s | 14.6 steps/s
Avg test loss: 0.20997, Avg test acc: 0.87098, Avg tpr: 0.82060, Avg fpr: 0.01820, total FA: 142

Testing server on iccad2012
[Step=  50] | Loss=0.45426 | acc=0.8330 | tpr=0.9735 | fpr=0.1696 | 3791.2 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.46202 | acc=0.8330 | tpr=0.9744 | fpr=0.1696 | 7343.5 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.46824 | acc=0.8313 | tpr=0.9798 | fpr=0.1714 | 7202.4 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.46782 | acc=0.8319 | tpr=0.9760 | fpr=0.1707 | 7216.9 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.46723 | acc=0.8324 | tpr=0.9773 | fpr=0.1702 | 7372.7 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.46559 | acc=0.8329 | tpr=0.9731 | fpr=0.1697 | 7499.3 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.46705 | acc=0.8330 | tpr=0.9718 | fpr=0.1695 | 7044.3 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.46788 | acc=0.8330 | tpr=0.9705 | fpr=0.1695 | 7227.4 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.47160 | acc=0.8323 | tpr=0.9698 | fpr=0.1702 | 7069.8 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.47282 | acc=0.8316 | tpr=0.9705 | fpr=0.1709 | 7359.0 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.47180 | acc=0.8317 | tpr=0.9713 | fpr=0.1708 | 12916.3 samples/s | 50.5 steps/s
Avg test loss: 0.47168, Avg test acc: 0.83175, Avg tpr: 0.97147, Avg fpr: 0.17079, total FA: 23714

server round 25/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.12464 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.821 | L2-Norm(final)=3.041 | 3952.1 samples/s | 61.8 steps/s
[Step=20050 Epoch=97.8] | Loss=0.02225 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.794 | L2-Norm(final)=3.035 | 3476.9 samples/s | 54.3 steps/s
[Step=20100 Epoch=98.0] | Loss=0.01791 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.790 | L2-Norm(final)=3.036 | 3668.5 samples/s | 57.3 steps/s
[Step=20150 Epoch=98.3] | Loss=0.01585 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.037 | 3671.0 samples/s | 57.4 steps/s
[Step=20200 Epoch=98.5] | Loss=0.01471 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.038 | 4551.5 samples/s | 71.1 steps/s
[Step=20250 Epoch=98.7] | Loss=0.01300 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.040 | 1611.6 samples/s | 25.2 steps/s
[Step=20300 Epoch=99.0] | Loss=0.01192 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.042 | 3580.0 samples/s | 55.9 steps/s
[Step=20350 Epoch=99.2] | Loss=0.01105 | Reg=0.00316 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.788 | L2-Norm(final)=3.045 | 3602.1 samples/s | 56.3 steps/s
[Step=20400 Epoch=99.5] | Loss=0.01054 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.047 | 4251.3 samples/s | 66.4 steps/s
[Step=20450 Epoch=99.7] | Loss=0.00988 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.049 | 1671.0 samples/s | 26.1 steps/s
[Step=20500 Epoch=100.0] | Loss=0.00963 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.051 | 3737.7 samples/s | 58.4 steps/s
[Step=20550 Epoch=100.2] | Loss=0.00931 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.787 | L2-Norm(final)=3.052 | 3563.4 samples/s | 55.7 steps/s
[Step=20600 Epoch=100.4] | Loss=0.00912 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.787 | L2-Norm(final)=3.053 | 4135.3 samples/s | 64.6 steps/s
[Step=20650 Epoch=100.7] | Loss=0.00866 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.787 | L2-Norm(final)=3.055 | 1701.5 samples/s | 26.6 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00828 | Reg=0.00316 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.787 | L2-Norm(final)=3.056 | 3746.2 samples/s | 58.5 steps/s
[Step=20750 Epoch=101.2] | Loss=0.00802 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.787 | L2-Norm(final)=3.058 | 3741.4 samples/s | 58.5 steps/s
[Step=20800 Epoch=101.4] | Loss=0.00782 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.787 | L2-Norm(final)=3.059 | 3989.8 samples/s | 62.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step20800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.6] | Loss=0.07450 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.821 | L2-Norm(final)=3.041 | 3847.6 samples/s | 60.1 steps/s
[Step=20050 Epoch=97.8] | Loss=0.01982 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.803 | L2-Norm(final)=3.040 | 3550.4 samples/s | 55.5 steps/s
[Step=20100 Epoch=98.1] | Loss=0.01559 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.797 | L2-Norm(final)=3.038 | 3727.9 samples/s | 58.2 steps/s
[Step=20150 Epoch=98.3] | Loss=0.01512 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=3.038 | 3690.3 samples/s | 57.7 steps/s
[Step=20200 Epoch=98.6] | Loss=0.01354 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.795 | L2-Norm(final)=3.038 | 4544.3 samples/s | 71.0 steps/s
[Step=20250 Epoch=98.8] | Loss=0.01207 | Reg=0.00317 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.794 | L2-Norm(final)=3.039 | 1532.4 samples/s | 23.9 steps/s
[Step=20300 Epoch=99.1] | Loss=0.01140 | Reg=0.00317 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.794 | L2-Norm(final)=3.041 | 3322.9 samples/s | 51.9 steps/s
[Step=20350 Epoch=99.3] | Loss=0.01064 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.794 | L2-Norm(final)=3.043 | 3551.0 samples/s | 55.5 steps/s
[Step=20400 Epoch=99.5] | Loss=0.00990 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=3.044 | 4179.2 samples/s | 65.3 steps/s
[Step=20450 Epoch=99.8] | Loss=0.00922 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=3.046 | 1672.2 samples/s | 26.1 steps/s
[Step=20500 Epoch=100.0] | Loss=0.00862 | Reg=0.00317 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.793 | L2-Norm(final)=3.048 | 3716.1 samples/s | 58.1 steps/s
[Step=20550 Epoch=100.3] | Loss=0.00820 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.792 | L2-Norm(final)=3.050 | 3497.0 samples/s | 54.6 steps/s
[Step=20600 Epoch=100.5] | Loss=0.00796 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.792 | L2-Norm(final)=3.052 | 3941.1 samples/s | 61.6 steps/s
[Step=20650 Epoch=100.8] | Loss=0.00783 | Reg=0.00317 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.792 | L2-Norm(final)=3.053 | 1626.4 samples/s | 25.4 steps/s
[Step=20700 Epoch=101.0] | Loss=0.00766 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.791 | L2-Norm(final)=3.054 | 3657.2 samples/s | 57.1 steps/s
[Step=20750 Epoch=101.3] | Loss=0.00750 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.791 | L2-Norm(final)=3.055 | 3731.8 samples/s | 58.3 steps/s
[Step=20800 Epoch=101.5] | Loss=0.00726 | Reg=0.00316 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.790 | L2-Norm(final)=3.056 | 4007.0 samples/s | 62.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step20800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.07091 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.821 | L2-Norm(final)=3.041 | 3781.3 samples/s | 59.1 steps/s
[Step=20050 Epoch=97.7] | Loss=0.02445 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.804 | L2-Norm(final)=3.033 | 3456.3 samples/s | 54.0 steps/s
[Step=20100 Epoch=97.9] | Loss=0.01982 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.800 | L2-Norm(final)=3.031 | 3642.7 samples/s | 56.9 steps/s
[Step=20150 Epoch=98.2] | Loss=0.01806 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.799 | L2-Norm(final)=3.032 | 3673.7 samples/s | 57.4 steps/s
[Step=20200 Epoch=98.4] | Loss=0.01622 | Reg=0.00317 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.797 | L2-Norm(final)=3.034 | 4493.5 samples/s | 70.2 steps/s
[Step=20250 Epoch=98.7] | Loss=0.01419 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=3.035 | 1611.4 samples/s | 25.2 steps/s
[Step=20300 Epoch=98.9] | Loss=0.01289 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=3.038 | 3547.9 samples/s | 55.4 steps/s
[Step=20350 Epoch=99.2] | Loss=0.01197 | Reg=0.00317 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.795 | L2-Norm(final)=3.040 | 3621.1 samples/s | 56.6 steps/s
[Step=20400 Epoch=99.4] | Loss=0.01134 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.795 | L2-Norm(final)=3.042 | 4187.5 samples/s | 65.4 steps/s
[Step=20450 Epoch=99.6] | Loss=0.01047 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.795 | L2-Norm(final)=3.044 | 1645.5 samples/s | 25.7 steps/s
[Step=20500 Epoch=99.9] | Loss=0.01009 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.794 | L2-Norm(final)=3.046 | 3631.7 samples/s | 56.7 steps/s
[Step=20550 Epoch=100.1] | Loss=0.00978 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.794 | L2-Norm(final)=3.048 | 3593.2 samples/s | 56.1 steps/s
[Step=20600 Epoch=100.4] | Loss=0.00927 | Reg=0.00317 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.794 | L2-Norm(final)=3.050 | 4039.1 samples/s | 63.1 steps/s
[Step=20650 Epoch=100.6] | Loss=0.00891 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.794 | L2-Norm(final)=3.052 | 1652.9 samples/s | 25.8 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00854 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=3.054 | 3172.4 samples/s | 49.6 steps/s
[Step=20750 Epoch=101.1] | Loss=0.00825 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=3.056 | 3409.5 samples/s | 53.3 steps/s
[Step=20800 Epoch=101.3] | Loss=0.00801 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=3.057 | 3684.4 samples/s | 57.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step20800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.11646 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.821 | L2-Norm(final)=3.041 | 3794.4 samples/s | 59.3 steps/s
[Step=20050 Epoch=97.8] | Loss=0.02086 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.797 | L2-Norm(final)=3.028 | 3609.3 samples/s | 56.4 steps/s
[Step=20100 Epoch=98.0] | Loss=0.01846 | Reg=0.00317 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.791 | L2-Norm(final)=3.028 | 3613.8 samples/s | 56.5 steps/s
[Step=20150 Epoch=98.3] | Loss=0.01684 | Reg=0.00316 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.789 | L2-Norm(final)=3.026 | 3673.1 samples/s | 57.4 steps/s
[Step=20200 Epoch=98.5] | Loss=0.01515 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.027 | 4527.7 samples/s | 70.7 steps/s
[Step=20250 Epoch=98.8] | Loss=0.01301 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.028 | 1626.8 samples/s | 25.4 steps/s
[Step=20300 Epoch=99.0] | Loss=0.01184 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.031 | 3651.9 samples/s | 57.1 steps/s
[Step=20350 Epoch=99.2] | Loss=0.01109 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.033 | 3707.8 samples/s | 57.9 steps/s
[Step=20400 Epoch=99.5] | Loss=0.01031 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.036 | 4246.1 samples/s | 66.3 steps/s
[Step=20450 Epoch=99.7] | Loss=0.00961 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.038 | 1638.4 samples/s | 25.6 steps/s
[Step=20500 Epoch=100.0] | Loss=0.00947 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.787 | L2-Norm(final)=3.040 | 3592.4 samples/s | 56.1 steps/s
[Step=20550 Epoch=100.2] | Loss=0.00890 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.787 | L2-Norm(final)=3.042 | 3696.2 samples/s | 57.8 steps/s
[Step=20600 Epoch=100.5] | Loss=0.00848 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.787 | L2-Norm(final)=3.044 | 3967.8 samples/s | 62.0 steps/s
[Step=20650 Epoch=100.7] | Loss=0.00811 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.787 | L2-Norm(final)=3.046 | 1642.0 samples/s | 25.7 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00773 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.786 | L2-Norm(final)=3.048 | 3655.6 samples/s | 57.1 steps/s
[Step=20750 Epoch=101.2] | Loss=0.00752 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.786 | L2-Norm(final)=3.050 | 3559.6 samples/s | 55.6 steps/s
[Step=20800 Epoch=101.4] | Loss=0.00741 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.786 | L2-Norm(final)=3.051 | 3774.2 samples/s | 59.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step20800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=98.1] | Loss=0.07275 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.821 | L2-Norm(final)=3.041 | 3666.2 samples/s | 57.3 steps/s
[Step=20050 Epoch=98.3] | Loss=0.02431 | Reg=0.00317 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.803 | L2-Norm(final)=3.033 | 3582.8 samples/s | 56.0 steps/s
[Step=20100 Epoch=98.6] | Loss=0.01874 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=3.031 | 3640.1 samples/s | 56.9 steps/s
[Step=20150 Epoch=98.8] | Loss=0.01712 | Reg=0.00317 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.793 | L2-Norm(final)=3.032 | 3615.4 samples/s | 56.5 steps/s
[Step=20200 Epoch=99.1] | Loss=0.01539 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=3.034 | 4539.6 samples/s | 70.9 steps/s
[Step=20250 Epoch=99.3] | Loss=0.01326 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=3.037 | 1617.4 samples/s | 25.3 steps/s
[Step=20300 Epoch=99.5] | Loss=0.01189 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.792 | L2-Norm(final)=3.039 | 3638.6 samples/s | 56.9 steps/s
[Step=20350 Epoch=99.8] | Loss=0.01097 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.792 | L2-Norm(final)=3.042 | 3719.5 samples/s | 58.1 steps/s
[Step=20400 Epoch=100.0] | Loss=0.01045 | Reg=0.00317 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.792 | L2-Norm(final)=3.045 | 4513.6 samples/s | 70.5 steps/s
[Step=20450 Epoch=100.3] | Loss=0.00980 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.792 | L2-Norm(final)=3.047 | 1626.1 samples/s | 25.4 steps/s
[Step=20500 Epoch=100.5] | Loss=0.00919 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.792 | L2-Norm(final)=3.049 | 3664.3 samples/s | 57.3 steps/s
[Step=20550 Epoch=100.8] | Loss=0.00874 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.791 | L2-Norm(final)=3.052 | 3646.0 samples/s | 57.0 steps/s
[Step=20600 Epoch=101.0] | Loss=0.00849 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.791 | L2-Norm(final)=3.054 | 4211.6 samples/s | 65.8 steps/s
[Step=20650 Epoch=101.3] | Loss=0.00811 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.791 | L2-Norm(final)=3.056 | 1654.3 samples/s | 25.8 steps/s
[Step=20700 Epoch=101.5] | Loss=0.00777 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.791 | L2-Norm(final)=3.058 | 3642.5 samples/s | 56.9 steps/s
[Step=20750 Epoch=101.8] | Loss=0.00770 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.791 | L2-Norm(final)=3.060 | 3644.2 samples/s | 56.9 steps/s
[Step=20800 Epoch=102.0] | Loss=0.00753 | Reg=0.00317 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.791 | L2-Norm(final)=3.061 | 4129.2 samples/s | 64.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step20800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=189.5] | Loss=0.04296 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.821 | L2-Norm(final)=3.042 | 3637.9 samples/s | 56.8 steps/s
[Step=20050 Epoch=190.0] | Loss=0.00660 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.784 | L2-Norm(final)=3.042 | 3461.2 samples/s | 54.1 steps/s
[Step=20100 Epoch=190.5] | Loss=0.00338 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.778 | L2-Norm(final)=3.042 | 4463.5 samples/s | 69.7 steps/s
[Step=20150 Epoch=190.9] | Loss=0.00227 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.772 | L2-Norm(final)=3.043 | 1584.0 samples/s | 24.8 steps/s
[Step=20200 Epoch=191.4] | Loss=0.00172 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.768 | L2-Norm(final)=3.044 | 4135.6 samples/s | 64.6 steps/s
[Step=20250 Epoch=191.9] | Loss=0.00138 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.764 | L2-Norm(final)=3.045 | 1603.8 samples/s | 25.1 steps/s
[Step=20300 Epoch=192.4] | Loss=0.00115 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.760 | L2-Norm(final)=3.045 | 3918.2 samples/s | 61.2 steps/s
[Step=20350 Epoch=192.8] | Loss=0.00099 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.757 | L2-Norm(final)=3.046 | 1657.2 samples/s | 25.9 steps/s
[Step=20400 Epoch=193.3] | Loss=0.00087 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.755 | L2-Norm(final)=3.046 | 3805.2 samples/s | 59.5 steps/s
[Step=20450 Epoch=193.8] | Loss=0.00078 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.752 | L2-Norm(final)=3.046 | 1697.0 samples/s | 26.5 steps/s
[Step=20500 Epoch=194.3] | Loss=0.00070 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.750 | L2-Norm(final)=3.047 | 3595.8 samples/s | 56.2 steps/s
[Step=20550 Epoch=194.7] | Loss=0.00064 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.748 | L2-Norm(final)=3.047 | 1721.7 samples/s | 26.9 steps/s
[Step=20600 Epoch=195.2] | Loss=0.00059 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.746 | L2-Norm(final)=3.047 | 3578.1 samples/s | 55.9 steps/s
[Step=20650 Epoch=195.7] | Loss=0.00054 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.744 | L2-Norm(final)=3.048 | 1739.4 samples/s | 27.2 steps/s
[Step=20700 Epoch=196.2] | Loss=0.00051 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.743 | L2-Norm(final)=3.048 | 3586.1 samples/s | 56.0 steps/s
[Step=20750 Epoch=196.6] | Loss=0.00047 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.741 | L2-Norm(final)=3.048 | 1737.2 samples/s | 27.1 steps/s
[Step=20800 Epoch=197.1] | Loss=0.00045 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.739 | L2-Norm(final)=3.048 | 3360.0 samples/s | 52.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step20800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=190.3] | Loss=0.11120 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.821 | L2-Norm(final)=3.042 | 3508.3 samples/s | 54.8 steps/s
[Step=20050 Epoch=190.7] | Loss=0.00670 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.774 | L2-Norm(final)=3.040 | 3265.7 samples/s | 51.0 steps/s
[Step=20100 Epoch=191.2] | Loss=0.00353 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.768 | L2-Norm(final)=3.042 | 4256.0 samples/s | 66.5 steps/s
[Step=20150 Epoch=191.7] | Loss=0.00237 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.764 | L2-Norm(final)=3.044 | 1529.9 samples/s | 23.9 steps/s
[Step=20200 Epoch=192.2] | Loss=0.00179 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.760 | L2-Norm(final)=3.045 | 4035.2 samples/s | 63.1 steps/s
[Step=20250 Epoch=192.6] | Loss=0.00144 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.757 | L2-Norm(final)=3.046 | 1589.0 samples/s | 24.8 steps/s
[Step=20300 Epoch=193.1] | Loss=0.00121 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.754 | L2-Norm(final)=3.047 | 3922.6 samples/s | 61.3 steps/s
[Step=20350 Epoch=193.6] | Loss=0.00104 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.752 | L2-Norm(final)=3.047 | 1657.1 samples/s | 25.9 steps/s
[Step=20400 Epoch=194.1] | Loss=0.00091 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.749 | L2-Norm(final)=3.048 | 3787.8 samples/s | 59.2 steps/s
[Step=20450 Epoch=194.5] | Loss=0.00081 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.747 | L2-Norm(final)=3.048 | 1678.7 samples/s | 26.2 steps/s
[Step=20500 Epoch=195.0] | Loss=0.00073 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.745 | L2-Norm(final)=3.048 | 3514.4 samples/s | 54.9 steps/s
[Step=20550 Epoch=195.5] | Loss=0.00067 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.744 | L2-Norm(final)=3.049 | 1718.4 samples/s | 26.8 steps/s
[Step=20600 Epoch=196.0] | Loss=0.00062 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.742 | L2-Norm(final)=3.049 | 3511.8 samples/s | 54.9 steps/s
[Step=20650 Epoch=196.4] | Loss=0.00057 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.740 | L2-Norm(final)=3.049 | 1733.4 samples/s | 27.1 steps/s
[Step=20700 Epoch=196.9] | Loss=0.00053 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.739 | L2-Norm(final)=3.050 | 3488.2 samples/s | 54.5 steps/s
[Step=20750 Epoch=197.4] | Loss=0.00050 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.737 | L2-Norm(final)=3.050 | 1749.0 samples/s | 27.3 steps/s
[Step=20800 Epoch=197.9] | Loss=0.00047 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.736 | L2-Norm(final)=3.050 | 3482.6 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step20800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=191.0] | Loss=0.01742 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.821 | L2-Norm(final)=3.042 | 3637.6 samples/s | 56.8 steps/s
[Step=20050 Epoch=191.5] | Loss=0.00803 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.780 | L2-Norm(final)=3.050 | 3432.9 samples/s | 53.6 steps/s
[Step=20100 Epoch=191.9] | Loss=0.00411 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.774 | L2-Norm(final)=3.052 | 4533.9 samples/s | 70.8 steps/s
[Step=20150 Epoch=192.4] | Loss=0.00278 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.768 | L2-Norm(final)=3.053 | 1590.0 samples/s | 24.8 steps/s
[Step=20200 Epoch=192.9] | Loss=0.00210 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.763 | L2-Norm(final)=3.054 | 4296.4 samples/s | 67.1 steps/s
[Step=20250 Epoch=193.4] | Loss=0.00169 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.760 | L2-Norm(final)=3.055 | 1616.3 samples/s | 25.3 steps/s
[Step=20300 Epoch=193.9] | Loss=0.00141 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.756 | L2-Norm(final)=3.055 | 3996.1 samples/s | 62.4 steps/s
[Step=20350 Epoch=194.3] | Loss=0.00121 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.754 | L2-Norm(final)=3.055 | 1639.0 samples/s | 25.6 steps/s
[Step=20400 Epoch=194.8] | Loss=0.00106 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.751 | L2-Norm(final)=3.055 | 3817.4 samples/s | 59.6 steps/s
[Step=20450 Epoch=195.3] | Loss=0.00095 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.749 | L2-Norm(final)=3.055 | 1649.1 samples/s | 25.8 steps/s
[Step=20500 Epoch=195.8] | Loss=0.00086 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.747 | L2-Norm(final)=3.056 | 3739.9 samples/s | 58.4 steps/s
[Step=20550 Epoch=196.2] | Loss=0.00078 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.745 | L2-Norm(final)=3.056 | 1702.6 samples/s | 26.6 steps/s
[Step=20600 Epoch=196.7] | Loss=0.00072 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.743 | L2-Norm(final)=3.056 | 3619.4 samples/s | 56.6 steps/s
[Step=20650 Epoch=197.2] | Loss=0.00066 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.741 | L2-Norm(final)=3.056 | 1708.1 samples/s | 26.7 steps/s
[Step=20700 Epoch=197.7] | Loss=0.00062 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.740 | L2-Norm(final)=3.056 | 3588.8 samples/s | 56.1 steps/s
[Step=20750 Epoch=198.1] | Loss=0.00058 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.738 | L2-Norm(final)=3.056 | 1743.1 samples/s | 27.2 steps/s
[Step=20800 Epoch=198.6] | Loss=0.00054 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.737 | L2-Norm(final)=3.056 | 3564.1 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step20800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=188.5] | Loss=0.17189 | Reg=0.00318 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=17.821 | L2-Norm(final)=3.042 | 3967.0 samples/s | 62.0 steps/s
[Step=20050 Epoch=188.9] | Loss=0.00646 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.785 | L2-Norm(final)=3.047 | 3206.4 samples/s | 50.1 steps/s
[Step=20100 Epoch=189.4] | Loss=0.00343 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.778 | L2-Norm(final)=3.050 | 4402.3 samples/s | 68.8 steps/s
[Step=20150 Epoch=189.9] | Loss=0.00231 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.773 | L2-Norm(final)=3.051 | 1549.4 samples/s | 24.2 steps/s
[Step=20200 Epoch=190.3] | Loss=0.00175 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.768 | L2-Norm(final)=3.052 | 4150.2 samples/s | 64.8 steps/s
[Step=20250 Epoch=190.8] | Loss=0.00141 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.764 | L2-Norm(final)=3.053 | 1632.4 samples/s | 25.5 steps/s
[Step=20300 Epoch=191.3] | Loss=0.00118 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.761 | L2-Norm(final)=3.053 | 3779.2 samples/s | 59.1 steps/s
[Step=20350 Epoch=191.8] | Loss=0.00101 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.758 | L2-Norm(final)=3.053 | 1661.1 samples/s | 26.0 steps/s
[Step=20400 Epoch=192.2] | Loss=0.00089 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.755 | L2-Norm(final)=3.054 | 3694.7 samples/s | 57.7 steps/s
[Step=20450 Epoch=192.7] | Loss=0.00079 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.753 | L2-Norm(final)=3.054 | 1719.1 samples/s | 26.9 steps/s
[Step=20500 Epoch=193.2] | Loss=0.00072 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.751 | L2-Norm(final)=3.054 | 3503.5 samples/s | 54.7 steps/s
[Step=20550 Epoch=193.6] | Loss=0.00065 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.749 | L2-Norm(final)=3.054 | 1639.8 samples/s | 25.6 steps/s
[Step=20600 Epoch=194.1] | Loss=0.00060 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.747 | L2-Norm(final)=3.054 | 3335.1 samples/s | 52.1 steps/s
[Step=20650 Epoch=194.6] | Loss=0.00056 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.745 | L2-Norm(final)=3.054 | 1681.4 samples/s | 26.3 steps/s
[Step=20700 Epoch=195.1] | Loss=0.00052 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.743 | L2-Norm(final)=3.054 | 3355.2 samples/s | 52.4 steps/s
[Step=20750 Epoch=195.5] | Loss=0.00049 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.742 | L2-Norm(final)=3.054 | 1764.1 samples/s | 27.6 steps/s
[Step=20800 Epoch=196.0] | Loss=0.00046 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.740 | L2-Norm(final)=3.054 | 3099.6 samples/s | 48.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step20800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=190.6] | Loss=0.06652 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.821 | L2-Norm(final)=3.042 | 3586.9 samples/s | 56.0 steps/s
[Step=20050 Epoch=191.1] | Loss=0.00801 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.783 | L2-Norm(final)=3.039 | 3484.0 samples/s | 54.4 steps/s
[Step=20100 Epoch=191.6] | Loss=0.00418 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.780 | L2-Norm(final)=3.043 | 4488.7 samples/s | 70.1 steps/s
[Step=20150 Epoch=192.0] | Loss=0.00280 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.775 | L2-Norm(final)=3.046 | 1570.1 samples/s | 24.5 steps/s
[Step=20200 Epoch=192.5] | Loss=0.00212 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.771 | L2-Norm(final)=3.048 | 4169.8 samples/s | 65.2 steps/s
[Step=20250 Epoch=193.0] | Loss=0.00170 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.767 | L2-Norm(final)=3.049 | 1590.5 samples/s | 24.9 steps/s
[Step=20300 Epoch=193.5] | Loss=0.00142 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.764 | L2-Norm(final)=3.049 | 4054.0 samples/s | 63.3 steps/s
[Step=20350 Epoch=194.0] | Loss=0.00122 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.761 | L2-Norm(final)=3.050 | 1640.2 samples/s | 25.6 steps/s
[Step=20400 Epoch=194.4] | Loss=0.00107 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.758 | L2-Norm(final)=3.051 | 3868.2 samples/s | 60.4 steps/s
[Step=20450 Epoch=194.9] | Loss=0.00096 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.755 | L2-Norm(final)=3.051 | 1658.9 samples/s | 25.9 steps/s
[Step=20500 Epoch=195.4] | Loss=0.00087 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.753 | L2-Norm(final)=3.052 | 3678.4 samples/s | 57.5 steps/s
[Step=20550 Epoch=195.9] | Loss=0.00079 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.751 | L2-Norm(final)=3.052 | 1687.0 samples/s | 26.4 steps/s
[Step=20600 Epoch=196.3] | Loss=0.00073 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.749 | L2-Norm(final)=3.052 | 3596.7 samples/s | 56.2 steps/s
[Step=20650 Epoch=196.8] | Loss=0.00067 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.747 | L2-Norm(final)=3.053 | 1720.0 samples/s | 26.9 steps/s
[Step=20700 Epoch=197.3] | Loss=0.00062 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.745 | L2-Norm(final)=3.053 | 3495.2 samples/s | 54.6 steps/s
[Step=20750 Epoch=197.8] | Loss=0.00058 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.744 | L2-Norm(final)=3.053 | 1715.5 samples/s | 26.8 steps/s
[Step=20800 Epoch=198.2] | Loss=0.00055 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.742 | L2-Norm(final)=3.054 | 3519.3 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24615 | acc=0.8496 | tpr=0.7878 | fpr=0.0161 | 3441.8 samples/s | 13.4 steps/s
Avg test loss: 0.24786, Avg test acc: 0.84959, Avg tpr: 0.78837, Avg fpr: 0.01577, total FA: 123

Testing server on iccad2012
[Step=  50] | Loss=0.40071 | acc=0.8562 | tpr=0.9779 | fpr=0.1459 | 3853.3 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.40802 | acc=0.8558 | tpr=0.9744 | fpr=0.1464 | 7079.6 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.41429 | acc=0.8542 | tpr=0.9784 | fpr=0.1480 | 7259.3 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.41418 | acc=0.8550 | tpr=0.9760 | fpr=0.1472 | 4771.7 samples/s | 18.6 steps/s
[Step= 250] | Loss=0.41347 | acc=0.8554 | tpr=0.9773 | fpr=0.1468 | 6584.6 samples/s | 25.7 steps/s
[Step= 300] | Loss=0.41262 | acc=0.8561 | tpr=0.9724 | fpr=0.1460 | 7315.0 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.41443 | acc=0.8557 | tpr=0.9706 | fpr=0.1464 | 7398.1 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.41544 | acc=0.8555 | tpr=0.9683 | fpr=0.1466 | 7139.5 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.41910 | acc=0.8545 | tpr=0.9679 | fpr=0.1475 | 7159.9 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.41994 | acc=0.8539 | tpr=0.9687 | fpr=0.1482 | 6948.6 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.41885 | acc=0.8542 | tpr=0.9698 | fpr=0.1479 | 13743.1 samples/s | 53.7 steps/s
Avg test loss: 0.41873, Avg test acc: 0.85423, Avg tpr: 0.96989, Avg fpr: 0.14787, total FA: 20532

server round 26/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.4] | Loss=0.21533 | Reg=0.00315 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=17.737 | L2-Norm(final)=3.066 | 3713.8 samples/s | 58.0 steps/s
[Step=20850 Epoch=101.7] | Loss=0.02703 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.715 | L2-Norm(final)=3.053 | 3514.9 samples/s | 54.9 steps/s
[Step=20900 Epoch=101.9] | Loss=0.02101 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.710 | L2-Norm(final)=3.052 | 3594.9 samples/s | 56.2 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01807 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.708 | L2-Norm(final)=3.052 | 3602.0 samples/s | 56.3 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01609 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.708 | L2-Norm(final)=3.053 | 4489.6 samples/s | 70.2 steps/s
[Step=21050 Epoch=102.6] | Loss=0.01396 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.708 | L2-Norm(final)=3.056 | 1620.1 samples/s | 25.3 steps/s
[Step=21100 Epoch=102.9] | Loss=0.01252 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.708 | L2-Norm(final)=3.059 | 3615.1 samples/s | 56.5 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01161 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.708 | L2-Norm(final)=3.062 | 3591.8 samples/s | 56.1 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01074 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.708 | L2-Norm(final)=3.065 | 4265.7 samples/s | 66.7 steps/s
[Step=21250 Epoch=103.6] | Loss=0.01000 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.708 | L2-Norm(final)=3.067 | 1673.8 samples/s | 26.2 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00967 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.708 | L2-Norm(final)=3.070 | 3657.5 samples/s | 57.1 steps/s
[Step=21350 Epoch=104.1] | Loss=0.00915 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.708 | L2-Norm(final)=3.072 | 3722.4 samples/s | 58.2 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00902 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.707 | L2-Norm(final)=3.073 | 4193.0 samples/s | 65.5 steps/s
[Step=21450 Epoch=104.6] | Loss=0.00865 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.707 | L2-Norm(final)=3.075 | 1706.8 samples/s | 26.7 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00833 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.707 | L2-Norm(final)=3.077 | 3643.2 samples/s | 56.9 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00803 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.707 | L2-Norm(final)=3.078 | 3627.1 samples/s | 56.7 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00782 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.707 | L2-Norm(final)=3.080 | 3827.0 samples/s | 59.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step21600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.5] | Loss=0.22876 | Reg=0.00315 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=17.737 | L2-Norm(final)=3.066 | 3687.5 samples/s | 57.6 steps/s
[Step=20850 Epoch=101.7] | Loss=0.02700 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.721 | L2-Norm(final)=3.053 | 3636.1 samples/s | 56.8 steps/s
[Step=20900 Epoch=102.0] | Loss=0.01839 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.715 | L2-Norm(final)=3.052 | 3621.7 samples/s | 56.6 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01621 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.712 | L2-Norm(final)=3.054 | 3637.7 samples/s | 56.8 steps/s
[Step=21000 Epoch=102.5] | Loss=0.01536 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.711 | L2-Norm(final)=3.055 | 4548.2 samples/s | 71.1 steps/s
[Step=21050 Epoch=102.7] | Loss=0.01319 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.710 | L2-Norm(final)=3.055 | 1619.4 samples/s | 25.3 steps/s
[Step=21100 Epoch=103.0] | Loss=0.01199 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.709 | L2-Norm(final)=3.057 | 3737.6 samples/s | 58.4 steps/s
[Step=21150 Epoch=103.2] | Loss=0.01100 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.708 | L2-Norm(final)=3.059 | 3706.9 samples/s | 57.9 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01015 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.708 | L2-Norm(final)=3.061 | 4343.0 samples/s | 67.9 steps/s
[Step=21250 Epoch=103.7] | Loss=0.00936 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.708 | L2-Norm(final)=3.063 | 1646.8 samples/s | 25.7 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00889 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.707 | L2-Norm(final)=3.066 | 3705.8 samples/s | 57.9 steps/s
[Step=21350 Epoch=104.2] | Loss=0.00864 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.707 | L2-Norm(final)=3.068 | 3733.3 samples/s | 58.3 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00824 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.706 | L2-Norm(final)=3.069 | 4255.5 samples/s | 66.5 steps/s
[Step=21450 Epoch=104.7] | Loss=0.00792 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.706 | L2-Norm(final)=3.071 | 1693.0 samples/s | 26.5 steps/s
[Step=21500 Epoch=104.9] | Loss=0.00765 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.705 | L2-Norm(final)=3.072 | 3665.7 samples/s | 57.3 steps/s
[Step=21550 Epoch=105.2] | Loss=0.00735 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.705 | L2-Norm(final)=3.073 | 3638.8 samples/s | 56.9 steps/s
[Step=21600 Epoch=105.4] | Loss=0.00716 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.704 | L2-Norm(final)=3.075 | 3960.3 samples/s | 61.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step21600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.4] | Loss=0.25539 | Reg=0.00315 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=17.737 | L2-Norm(final)=3.066 | 3962.8 samples/s | 61.9 steps/s
[Step=20850 Epoch=101.6] | Loss=0.03006 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.720 | L2-Norm(final)=3.056 | 3361.1 samples/s | 52.5 steps/s
[Step=20900 Epoch=101.8] | Loss=0.02320 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.715 | L2-Norm(final)=3.053 | 3731.7 samples/s | 58.3 steps/s
[Step=20950 Epoch=102.1] | Loss=0.01879 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.712 | L2-Norm(final)=3.053 | 3717.8 samples/s | 58.1 steps/s
[Step=21000 Epoch=102.3] | Loss=0.01713 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.711 | L2-Norm(final)=3.054 | 4619.0 samples/s | 72.2 steps/s
[Step=21050 Epoch=102.6] | Loss=0.01525 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.711 | L2-Norm(final)=3.055 | 1612.6 samples/s | 25.2 steps/s
[Step=21100 Epoch=102.8] | Loss=0.01389 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.710 | L2-Norm(final)=3.057 | 3637.8 samples/s | 56.8 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01284 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.710 | L2-Norm(final)=3.059 | 3646.2 samples/s | 57.0 steps/s
[Step=21200 Epoch=103.3] | Loss=0.01197 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.710 | L2-Norm(final)=3.061 | 4294.4 samples/s | 67.1 steps/s
[Step=21250 Epoch=103.5] | Loss=0.01101 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.709 | L2-Norm(final)=3.064 | 1649.3 samples/s | 25.8 steps/s
[Step=21300 Epoch=103.8] | Loss=0.01042 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.709 | L2-Norm(final)=3.066 | 3585.1 samples/s | 56.0 steps/s
[Step=21350 Epoch=104.0] | Loss=0.00998 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.709 | L2-Norm(final)=3.068 | 3594.0 samples/s | 56.2 steps/s
[Step=21400 Epoch=104.3] | Loss=0.00945 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.709 | L2-Norm(final)=3.070 | 4084.7 samples/s | 63.8 steps/s
[Step=21450 Epoch=104.5] | Loss=0.00903 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.709 | L2-Norm(final)=3.072 | 1699.8 samples/s | 26.6 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00868 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.709 | L2-Norm(final)=3.074 | 3633.3 samples/s | 56.8 steps/s
[Step=21550 Epoch=105.0] | Loss=0.00839 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.709 | L2-Norm(final)=3.076 | 3611.7 samples/s | 56.4 steps/s
[Step=21600 Epoch=105.2] | Loss=0.00818 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.709 | L2-Norm(final)=3.078 | 3901.0 samples/s | 61.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step21600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.4] | Loss=0.24735 | Reg=0.00315 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=17.737 | L2-Norm(final)=3.066 | 3569.5 samples/s | 55.8 steps/s
[Step=20850 Epoch=101.7] | Loss=0.02629 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.718 | L2-Norm(final)=3.053 | 1874.6 samples/s | 29.3 steps/s
[Step=20900 Epoch=101.9] | Loss=0.01880 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.714 | L2-Norm(final)=3.053 | 3349.9 samples/s | 52.3 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01634 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.713 | L2-Norm(final)=3.055 | 3571.6 samples/s | 55.8 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01440 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.712 | L2-Norm(final)=3.057 | 4388.6 samples/s | 68.6 steps/s
[Step=21050 Epoch=102.7] | Loss=0.01255 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.711 | L2-Norm(final)=3.060 | 1602.4 samples/s | 25.0 steps/s
[Step=21100 Epoch=102.9] | Loss=0.01164 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.711 | L2-Norm(final)=3.063 | 3639.4 samples/s | 56.9 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01083 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.711 | L2-Norm(final)=3.065 | 3550.6 samples/s | 55.5 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01020 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.710 | L2-Norm(final)=3.067 | 4208.0 samples/s | 65.8 steps/s
[Step=21250 Epoch=103.6] | Loss=0.00983 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.710 | L2-Norm(final)=3.069 | 1673.1 samples/s | 26.1 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00923 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.710 | L2-Norm(final)=3.071 | 3727.0 samples/s | 58.2 steps/s
[Step=21350 Epoch=104.1] | Loss=0.00867 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.709 | L2-Norm(final)=3.073 | 3711.1 samples/s | 58.0 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00836 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.709 | L2-Norm(final)=3.075 | 4166.7 samples/s | 65.1 steps/s
[Step=21450 Epoch=104.6] | Loss=0.00794 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.709 | L2-Norm(final)=3.076 | 1698.8 samples/s | 26.5 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00765 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.709 | L2-Norm(final)=3.078 | 3660.9 samples/s | 57.2 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00744 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.709 | L2-Norm(final)=3.080 | 3655.2 samples/s | 57.1 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00719 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.708 | L2-Norm(final)=3.082 | 3860.8 samples/s | 60.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step21600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=102.0] | Loss=0.11812 | Reg=0.00315 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.737 | L2-Norm(final)=3.066 | 3714.3 samples/s | 58.0 steps/s
[Step=20850 Epoch=102.2] | Loss=0.02725 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.720 | L2-Norm(final)=3.054 | 3593.7 samples/s | 56.2 steps/s
[Step=20900 Epoch=102.5] | Loss=0.01995 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.718 | L2-Norm(final)=3.054 | 3595.8 samples/s | 56.2 steps/s
[Step=20950 Epoch=102.7] | Loss=0.01725 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.717 | L2-Norm(final)=3.056 | 3586.7 samples/s | 56.0 steps/s
[Step=21000 Epoch=103.0] | Loss=0.01518 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.716 | L2-Norm(final)=3.057 | 4491.7 samples/s | 70.2 steps/s
[Step=21050 Epoch=103.2] | Loss=0.01384 | Reg=0.00314 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.716 | L2-Norm(final)=3.059 | 1619.4 samples/s | 25.3 steps/s
[Step=21100 Epoch=103.5] | Loss=0.01264 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.715 | L2-Norm(final)=3.061 | 3730.3 samples/s | 58.3 steps/s
[Step=21150 Epoch=103.7] | Loss=0.01139 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.714 | L2-Norm(final)=3.063 | 3725.7 samples/s | 58.2 steps/s
[Step=21200 Epoch=104.0] | Loss=0.01052 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.713 | L2-Norm(final)=3.065 | 4526.6 samples/s | 70.7 steps/s
[Step=21250 Epoch=104.2] | Loss=0.01003 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.713 | L2-Norm(final)=3.067 | 1643.5 samples/s | 25.7 steps/s
[Step=21300 Epoch=104.5] | Loss=0.00957 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.712 | L2-Norm(final)=3.069 | 3627.8 samples/s | 56.7 steps/s
[Step=21350 Epoch=104.7] | Loss=0.00901 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.712 | L2-Norm(final)=3.071 | 3619.2 samples/s | 56.5 steps/s
[Step=21400 Epoch=104.9] | Loss=0.00870 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.711 | L2-Norm(final)=3.074 | 4280.0 samples/s | 66.9 steps/s
[Step=21450 Epoch=105.2] | Loss=0.00828 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.711 | L2-Norm(final)=3.075 | 1657.5 samples/s | 25.9 steps/s
[Step=21500 Epoch=105.4] | Loss=0.00787 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.710 | L2-Norm(final)=3.077 | 3625.0 samples/s | 56.6 steps/s
[Step=21550 Epoch=105.7] | Loss=0.00765 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.710 | L2-Norm(final)=3.079 | 3641.3 samples/s | 56.9 steps/s
[Step=21600 Epoch=105.9] | Loss=0.00747 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.710 | L2-Norm(final)=3.081 | 4124.0 samples/s | 64.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step21600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=197.1] | Loss=0.01019 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.737 | L2-Norm(final)=3.067 | 3703.8 samples/s | 57.9 steps/s
[Step=20850 Epoch=197.6] | Loss=0.00495 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.694 | L2-Norm(final)=3.069 | 3377.3 samples/s | 52.8 steps/s
[Step=20900 Epoch=198.0] | Loss=0.00286 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.690 | L2-Norm(final)=3.070 | 4466.4 samples/s | 69.8 steps/s
[Step=20950 Epoch=198.5] | Loss=0.00192 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.686 | L2-Norm(final)=3.071 | 1581.9 samples/s | 24.7 steps/s
[Step=21000 Epoch=199.0] | Loss=0.00145 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.682 | L2-Norm(final)=3.072 | 4195.5 samples/s | 65.6 steps/s
[Step=21050 Epoch=199.5] | Loss=0.00117 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.679 | L2-Norm(final)=3.073 | 1614.7 samples/s | 25.2 steps/s
[Step=21100 Epoch=199.9] | Loss=0.00097 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.676 | L2-Norm(final)=3.073 | 3973.1 samples/s | 62.1 steps/s
[Step=21150 Epoch=200.4] | Loss=0.00084 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.674 | L2-Norm(final)=3.074 | 1652.9 samples/s | 25.8 steps/s
[Step=21200 Epoch=200.9] | Loss=0.00073 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.671 | L2-Norm(final)=3.074 | 3777.3 samples/s | 59.0 steps/s
[Step=21250 Epoch=201.4] | Loss=0.00065 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.669 | L2-Norm(final)=3.074 | 1673.7 samples/s | 26.2 steps/s
[Step=21300 Epoch=201.8] | Loss=0.00059 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.667 | L2-Norm(final)=3.074 | 3602.6 samples/s | 56.3 steps/s
[Step=21350 Epoch=202.3] | Loss=0.00054 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.665 | L2-Norm(final)=3.075 | 1724.0 samples/s | 26.9 steps/s
[Step=21400 Epoch=202.8] | Loss=0.00049 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.663 | L2-Norm(final)=3.075 | 3558.6 samples/s | 55.6 steps/s
[Step=21450 Epoch=203.3] | Loss=0.00046 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.661 | L2-Norm(final)=3.075 | 1740.6 samples/s | 27.2 steps/s
[Step=21500 Epoch=203.7] | Loss=0.00043 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.659 | L2-Norm(final)=3.075 | 3576.6 samples/s | 55.9 steps/s
[Step=21550 Epoch=204.2] | Loss=0.00040 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.658 | L2-Norm(final)=3.075 | 1759.8 samples/s | 27.5 steps/s
[Step=21600 Epoch=204.7] | Loss=0.00037 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.656 | L2-Norm(final)=3.075 | 3524.1 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step21600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=197.9] | Loss=0.10713 | Reg=0.00315 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.737 | L2-Norm(final)=3.067 | 3534.8 samples/s | 55.2 steps/s
[Step=20850 Epoch=198.3] | Loss=0.00364 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.695 | L2-Norm(final)=3.074 | 3486.5 samples/s | 54.5 steps/s
[Step=20900 Epoch=198.8] | Loss=0.00191 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.687 | L2-Norm(final)=3.077 | 4383.8 samples/s | 68.5 steps/s
[Step=20950 Epoch=199.3] | Loss=0.00130 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.680 | L2-Norm(final)=3.079 | 1580.0 samples/s | 24.7 steps/s
[Step=21000 Epoch=199.8] | Loss=0.00098 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.675 | L2-Norm(final)=3.080 | 4235.3 samples/s | 66.2 steps/s
[Step=21050 Epoch=200.2] | Loss=0.00079 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.671 | L2-Norm(final)=3.080 | 1602.9 samples/s | 25.0 steps/s
[Step=21100 Epoch=200.7] | Loss=0.00066 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.668 | L2-Norm(final)=3.080 | 3990.7 samples/s | 62.4 steps/s
[Step=21150 Epoch=201.2] | Loss=0.00057 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.665 | L2-Norm(final)=3.080 | 1648.0 samples/s | 25.8 steps/s
[Step=21200 Epoch=201.7] | Loss=0.00050 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.662 | L2-Norm(final)=3.080 | 3719.5 samples/s | 58.1 steps/s
[Step=21250 Epoch=202.1] | Loss=0.00045 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.660 | L2-Norm(final)=3.081 | 1673.8 samples/s | 26.2 steps/s
[Step=21300 Epoch=202.6] | Loss=0.00041 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.657 | L2-Norm(final)=3.081 | 3553.3 samples/s | 55.5 steps/s
[Step=21350 Epoch=203.1] | Loss=0.00037 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.655 | L2-Norm(final)=3.081 | 1699.0 samples/s | 26.5 steps/s
[Step=21400 Epoch=203.6] | Loss=0.00034 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.654 | L2-Norm(final)=3.081 | 3474.4 samples/s | 54.3 steps/s
[Step=21450 Epoch=204.0] | Loss=0.00032 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.652 | L2-Norm(final)=3.081 | 1755.3 samples/s | 27.4 steps/s
[Step=21500 Epoch=204.5] | Loss=0.00030 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.650 | L2-Norm(final)=3.081 | 3527.9 samples/s | 55.1 steps/s
[Step=21550 Epoch=205.0] | Loss=0.00028 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.648 | L2-Norm(final)=3.081 | 1760.2 samples/s | 27.5 steps/s
[Step=21600 Epoch=205.5] | Loss=0.00026 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.647 | L2-Norm(final)=3.081 | 3513.3 samples/s | 54.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step21600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=198.6] | Loss=0.09655 | Reg=0.00315 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.737 | L2-Norm(final)=3.067 | 3748.1 samples/s | 58.6 steps/s
[Step=20850 Epoch=199.1] | Loss=0.00713 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.695 | L2-Norm(final)=3.066 | 3323.2 samples/s | 51.9 steps/s
[Step=20900 Epoch=199.6] | Loss=0.00369 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.688 | L2-Norm(final)=3.070 | 4477.4 samples/s | 70.0 steps/s
[Step=20950 Epoch=200.1] | Loss=0.00247 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.682 | L2-Norm(final)=3.072 | 1585.3 samples/s | 24.8 steps/s
[Step=21000 Epoch=200.5] | Loss=0.00187 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.678 | L2-Norm(final)=3.073 | 4268.5 samples/s | 66.7 steps/s
[Step=21050 Epoch=201.0] | Loss=0.00150 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.674 | L2-Norm(final)=3.074 | 1614.3 samples/s | 25.2 steps/s
[Step=21100 Epoch=201.5] | Loss=0.00125 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.671 | L2-Norm(final)=3.075 | 4092.3 samples/s | 63.9 steps/s
[Step=21150 Epoch=202.0] | Loss=0.00108 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.668 | L2-Norm(final)=3.075 | 1640.3 samples/s | 25.6 steps/s
[Step=21200 Epoch=202.4] | Loss=0.00095 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.666 | L2-Norm(final)=3.076 | 3917.1 samples/s | 61.2 steps/s
[Step=21250 Epoch=202.9] | Loss=0.00084 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.664 | L2-Norm(final)=3.076 | 1640.4 samples/s | 25.6 steps/s
[Step=21300 Epoch=203.4] | Loss=0.00076 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.662 | L2-Norm(final)=3.076 | 3698.7 samples/s | 57.8 steps/s
[Step=21350 Epoch=203.9] | Loss=0.00069 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.660 | L2-Norm(final)=3.076 | 1689.2 samples/s | 26.4 steps/s
[Step=21400 Epoch=204.4] | Loss=0.00064 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.658 | L2-Norm(final)=3.077 | 3606.2 samples/s | 56.3 steps/s
[Step=21450 Epoch=204.8] | Loss=0.00059 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.657 | L2-Norm(final)=3.077 | 1722.5 samples/s | 26.9 steps/s
[Step=21500 Epoch=205.3] | Loss=0.00055 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.655 | L2-Norm(final)=3.077 | 3541.4 samples/s | 55.3 steps/s
[Step=21550 Epoch=205.8] | Loss=0.00051 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.654 | L2-Norm(final)=3.077 | 1723.1 samples/s | 26.9 steps/s
[Step=21600 Epoch=206.3] | Loss=0.00048 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.652 | L2-Norm(final)=3.077 | 3559.7 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step21600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=196.0] | Loss=0.18534 | Reg=0.00315 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.737 | L2-Norm(final)=3.067 | 3654.6 samples/s | 57.1 steps/s
[Step=20850 Epoch=196.5] | Loss=0.01087 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.696 | L2-Norm(final)=3.059 | 3421.3 samples/s | 53.5 steps/s
[Step=20900 Epoch=196.9] | Loss=0.00586 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.690 | L2-Norm(final)=3.061 | 4419.0 samples/s | 69.0 steps/s
[Step=20950 Epoch=197.4] | Loss=0.00398 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.685 | L2-Norm(final)=3.063 | 1586.2 samples/s | 24.8 steps/s
[Step=21000 Epoch=197.9] | Loss=0.00300 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.682 | L2-Norm(final)=3.065 | 4133.4 samples/s | 64.6 steps/s
[Step=21050 Epoch=198.4] | Loss=0.00241 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.678 | L2-Norm(final)=3.066 | 1621.9 samples/s | 25.3 steps/s
[Step=21100 Epoch=198.8] | Loss=0.00201 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.676 | L2-Norm(final)=3.066 | 3815.9 samples/s | 59.6 steps/s
[Step=21150 Epoch=199.3] | Loss=0.00173 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.673 | L2-Norm(final)=3.067 | 1651.3 samples/s | 25.8 steps/s
[Step=21200 Epoch=199.8] | Loss=0.00152 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.671 | L2-Norm(final)=3.068 | 3666.5 samples/s | 57.3 steps/s
[Step=21250 Epoch=200.2] | Loss=0.00135 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.669 | L2-Norm(final)=3.068 | 1716.9 samples/s | 26.8 steps/s
[Step=21300 Epoch=200.7] | Loss=0.00122 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.667 | L2-Norm(final)=3.068 | 3572.4 samples/s | 55.8 steps/s
[Step=21350 Epoch=201.2] | Loss=0.00111 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.665 | L2-Norm(final)=3.069 | 1750.7 samples/s | 27.4 steps/s
[Step=21400 Epoch=201.6] | Loss=0.00102 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.663 | L2-Norm(final)=3.069 | 3593.5 samples/s | 56.1 steps/s
[Step=21450 Epoch=202.1] | Loss=0.00094 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.662 | L2-Norm(final)=3.070 | 1738.1 samples/s | 27.2 steps/s
[Step=21500 Epoch=202.6] | Loss=0.00088 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.660 | L2-Norm(final)=3.070 | 3490.7 samples/s | 54.5 steps/s
[Step=21550 Epoch=203.1] | Loss=0.00082 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.659 | L2-Norm(final)=3.070 | 1849.4 samples/s | 28.9 steps/s
[Step=21600 Epoch=203.5] | Loss=0.00077 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.658 | L2-Norm(final)=3.070 | 3185.9 samples/s | 49.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step21600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=198.3] | Loss=0.12677 | Reg=0.00315 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.737 | L2-Norm(final)=3.066 | 3774.9 samples/s | 59.0 steps/s
[Step=20850 Epoch=198.7] | Loss=0.00726 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.690 | L2-Norm(final)=3.065 | 3289.2 samples/s | 51.4 steps/s
[Step=20900 Epoch=199.2] | Loss=0.00370 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.684 | L2-Norm(final)=3.068 | 4383.6 samples/s | 68.5 steps/s
[Step=20950 Epoch=199.7] | Loss=0.00249 | Reg=0.00313 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.679 | L2-Norm(final)=3.070 | 1578.8 samples/s | 24.7 steps/s
[Step=21000 Epoch=200.1] | Loss=0.00190 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.675 | L2-Norm(final)=3.071 | 4266.7 samples/s | 66.7 steps/s
[Step=21050 Epoch=200.6] | Loss=0.00153 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.672 | L2-Norm(final)=3.073 | 1594.9 samples/s | 24.9 steps/s
[Step=21100 Epoch=201.1] | Loss=0.00128 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.669 | L2-Norm(final)=3.073 | 3933.2 samples/s | 61.5 steps/s
[Step=21150 Epoch=201.6] | Loss=0.00110 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.667 | L2-Norm(final)=3.074 | 1624.8 samples/s | 25.4 steps/s
[Step=21200 Epoch=202.1] | Loss=0.00097 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.665 | L2-Norm(final)=3.075 | 3897.6 samples/s | 60.9 steps/s
[Step=21250 Epoch=202.5] | Loss=0.00086 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.662 | L2-Norm(final)=3.075 | 1658.7 samples/s | 25.9 steps/s
[Step=21300 Epoch=203.0] | Loss=0.00078 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.660 | L2-Norm(final)=3.076 | 3741.3 samples/s | 58.5 steps/s
[Step=21350 Epoch=203.5] | Loss=0.00071 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.659 | L2-Norm(final)=3.076 | 1697.1 samples/s | 26.5 steps/s
[Step=21400 Epoch=204.0] | Loss=0.00065 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.657 | L2-Norm(final)=3.076 | 3519.5 samples/s | 55.0 steps/s
[Step=21450 Epoch=204.4] | Loss=0.00061 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.655 | L2-Norm(final)=3.077 | 1726.2 samples/s | 27.0 steps/s
[Step=21500 Epoch=204.9] | Loss=0.00056 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.654 | L2-Norm(final)=3.077 | 3556.8 samples/s | 55.6 steps/s
[Step=21550 Epoch=205.4] | Loss=0.00053 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.652 | L2-Norm(final)=3.077 | 1738.0 samples/s | 27.2 steps/s
[Step=21600 Epoch=205.9] | Loss=0.00050 | Reg=0.00312 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.651 | L2-Norm(final)=3.077 | 3582.2 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24012 | acc=0.8541 | tpr=0.7946 | fpr=0.0166 | 3599.5 samples/s | 14.1 steps/s
Avg test loss: 0.24189, Avg test acc: 0.85415, Avg tpr: 0.79542, Avg fpr: 0.01666, total FA: 130

Testing server on iccad2012
[Step=  50] | Loss=0.39623 | acc=0.8565 | tpr=0.9690 | fpr=0.1455 | 3644.3 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.40369 | acc=0.8571 | tpr=0.9680 | fpr=0.1450 | 7342.0 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.40993 | acc=0.8559 | tpr=0.9741 | fpr=0.1463 | 7006.1 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.40979 | acc=0.8566 | tpr=0.9716 | fpr=0.1455 | 7145.5 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.40890 | acc=0.8571 | tpr=0.9729 | fpr=0.1450 | 6955.2 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.40802 | acc=0.8578 | tpr=0.9680 | fpr=0.1442 | 7299.5 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.40978 | acc=0.8574 | tpr=0.9662 | fpr=0.1445 | 7175.9 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.41076 | acc=0.8574 | tpr=0.9644 | fpr=0.1445 | 7013.6 samples/s | 27.4 steps/s
[Step= 450] | Loss=0.41421 | acc=0.8563 | tpr=0.9645 | fpr=0.1457 | 6768.4 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.41498 | acc=0.8559 | tpr=0.9656 | fpr=0.1461 | 7407.8 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.41408 | acc=0.8561 | tpr=0.9670 | fpr=0.1459 | 12780.1 samples/s | 49.9 steps/s
Avg test loss: 0.41395, Avg test acc: 0.85614, Avg tpr: 0.96712, Avg fpr: 0.14588, total FA: 20255

server round 27/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.3] | Loss=0.12904 | Reg=0.00312 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=17.653 | L2-Norm(final)=3.091 | 3673.2 samples/s | 57.4 steps/s
[Step=21650 Epoch=105.6] | Loss=0.02908 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.633 | L2-Norm(final)=3.075 | 3024.7 samples/s | 47.3 steps/s
[Step=21700 Epoch=105.8] | Loss=0.01963 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.630 | L2-Norm(final)=3.076 | 3332.5 samples/s | 52.1 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01637 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.629 | L2-Norm(final)=3.079 | 3456.2 samples/s | 54.0 steps/s
[Step=21800 Epoch=106.3] | Loss=0.01504 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=3.082 | 4283.2 samples/s | 66.9 steps/s
[Step=21850 Epoch=106.5] | Loss=0.01353 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=3.084 | 1583.3 samples/s | 24.7 steps/s
[Step=21900 Epoch=106.8] | Loss=0.01211 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.627 | L2-Norm(final)=3.086 | 3737.0 samples/s | 58.4 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01107 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.627 | L2-Norm(final)=3.088 | 3720.5 samples/s | 58.1 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01061 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.626 | L2-Norm(final)=3.090 | 4372.8 samples/s | 68.3 steps/s
[Step=22050 Epoch=107.5] | Loss=0.01005 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.626 | L2-Norm(final)=3.092 | 1663.5 samples/s | 26.0 steps/s
[Step=22100 Epoch=107.8] | Loss=0.00935 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.626 | L2-Norm(final)=3.094 | 3663.4 samples/s | 57.2 steps/s
[Step=22150 Epoch=108.0] | Loss=0.00893 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.625 | L2-Norm(final)=3.097 | 3635.4 samples/s | 56.8 steps/s
[Step=22200 Epoch=108.3] | Loss=0.00852 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.625 | L2-Norm(final)=3.099 | 3969.9 samples/s | 62.0 steps/s
[Step=22250 Epoch=108.5] | Loss=0.00879 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.625 | L2-Norm(final)=3.100 | 1657.4 samples/s | 25.9 steps/s
[Step=22300 Epoch=108.7] | Loss=0.00858 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.626 | L2-Norm(final)=3.102 | 3737.5 samples/s | 58.4 steps/s
[Step=22350 Epoch=109.0] | Loss=0.00846 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.627 | L2-Norm(final)=3.104 | 3578.0 samples/s | 55.9 steps/s
[Step=22400 Epoch=109.2] | Loss=0.00836 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.627 | L2-Norm(final)=3.105 | 3928.4 samples/s | 61.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step22400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.4] | Loss=0.14198 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.653 | L2-Norm(final)=3.091 | 3771.1 samples/s | 58.9 steps/s
[Step=21650 Epoch=105.6] | Loss=0.02499 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.641 | L2-Norm(final)=3.079 | 3316.9 samples/s | 51.8 steps/s
[Step=21700 Epoch=105.9] | Loss=0.01791 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.637 | L2-Norm(final)=3.077 | 3569.3 samples/s | 55.8 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01639 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.634 | L2-Norm(final)=3.078 | 3609.7 samples/s | 56.4 steps/s
[Step=21800 Epoch=106.4] | Loss=0.01439 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.631 | L2-Norm(final)=3.078 | 4626.2 samples/s | 72.3 steps/s
[Step=21850 Epoch=106.6] | Loss=0.01254 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.630 | L2-Norm(final)=3.080 | 1605.4 samples/s | 25.1 steps/s
[Step=21900 Epoch=106.9] | Loss=0.01124 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.630 | L2-Norm(final)=3.083 | 3600.6 samples/s | 56.3 steps/s
[Step=21950 Epoch=107.1] | Loss=0.01046 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.629 | L2-Norm(final)=3.085 | 3642.7 samples/s | 56.9 steps/s
[Step=22000 Epoch=107.3] | Loss=0.00993 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.629 | L2-Norm(final)=3.087 | 4359.8 samples/s | 68.1 steps/s
[Step=22050 Epoch=107.6] | Loss=0.00926 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=3.089 | 1663.4 samples/s | 26.0 steps/s
[Step=22100 Epoch=107.8] | Loss=0.00886 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.628 | L2-Norm(final)=3.091 | 3724.6 samples/s | 58.2 steps/s
[Step=22150 Epoch=108.1] | Loss=0.00846 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.627 | L2-Norm(final)=3.092 | 3743.1 samples/s | 58.5 steps/s
[Step=22200 Epoch=108.3] | Loss=0.00810 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.627 | L2-Norm(final)=3.094 | 4267.4 samples/s | 66.7 steps/s
[Step=22250 Epoch=108.6] | Loss=0.00774 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.626 | L2-Norm(final)=3.096 | 1671.3 samples/s | 26.1 steps/s
[Step=22300 Epoch=108.8] | Loss=0.00742 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.625 | L2-Norm(final)=3.097 | 3705.8 samples/s | 57.9 steps/s
[Step=22350 Epoch=109.1] | Loss=0.00714 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.625 | L2-Norm(final)=3.099 | 3730.0 samples/s | 58.3 steps/s
[Step=22400 Epoch=109.3] | Loss=0.00717 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.624 | L2-Norm(final)=3.100 | 4084.8 samples/s | 63.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step22400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.3] | Loss=0.10221 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.653 | L2-Norm(final)=3.092 | 3889.5 samples/s | 60.8 steps/s
[Step=21650 Epoch=105.5] | Loss=0.01962 | Reg=0.00311 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.631 | L2-Norm(final)=3.087 | 3526.4 samples/s | 55.1 steps/s
[Step=21700 Epoch=105.7] | Loss=0.01634 | Reg=0.00311 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.627 | L2-Norm(final)=3.089 | 3729.7 samples/s | 58.3 steps/s
[Step=21750 Epoch=106.0] | Loss=0.01464 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.625 | L2-Norm(final)=3.089 | 3731.3 samples/s | 58.3 steps/s
[Step=21800 Epoch=106.2] | Loss=0.01435 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.624 | L2-Norm(final)=3.090 | 4629.9 samples/s | 72.3 steps/s
[Step=21850 Epoch=106.5] | Loss=0.01271 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.624 | L2-Norm(final)=3.090 | 1622.0 samples/s | 25.3 steps/s
[Step=21900 Epoch=106.7] | Loss=0.01176 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.623 | L2-Norm(final)=3.092 | 3600.6 samples/s | 56.3 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01081 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.623 | L2-Norm(final)=3.093 | 3610.4 samples/s | 56.4 steps/s
[Step=22000 Epoch=107.2] | Loss=0.01001 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.624 | L2-Norm(final)=3.095 | 4252.0 samples/s | 66.4 steps/s
[Step=22050 Epoch=107.4] | Loss=0.00928 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.624 | L2-Norm(final)=3.098 | 1651.7 samples/s | 25.8 steps/s
[Step=22100 Epoch=107.7] | Loss=0.00892 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.624 | L2-Norm(final)=3.101 | 3654.1 samples/s | 57.1 steps/s
[Step=22150 Epoch=107.9] | Loss=0.00854 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.624 | L2-Norm(final)=3.103 | 3641.5 samples/s | 56.9 steps/s
[Step=22200 Epoch=108.2] | Loss=0.00832 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.624 | L2-Norm(final)=3.104 | 4098.0 samples/s | 64.0 steps/s
[Step=22250 Epoch=108.4] | Loss=0.00795 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.624 | L2-Norm(final)=3.106 | 1692.4 samples/s | 26.4 steps/s
[Step=22300 Epoch=108.7] | Loss=0.00764 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.624 | L2-Norm(final)=3.108 | 3654.4 samples/s | 57.1 steps/s
[Step=22350 Epoch=108.9] | Loss=0.00737 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.624 | L2-Norm(final)=3.110 | 3662.6 samples/s | 57.2 steps/s
[Step=22400 Epoch=109.1] | Loss=0.00729 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.624 | L2-Norm(final)=3.112 | 3910.6 samples/s | 61.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step22400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.3] | Loss=0.14645 | Reg=0.00312 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=17.653 | L2-Norm(final)=3.091 | 3655.7 samples/s | 57.1 steps/s
[Step=21650 Epoch=105.6] | Loss=0.02261 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.635 | L2-Norm(final)=3.087 | 3705.0 samples/s | 57.9 steps/s
[Step=21700 Epoch=105.8] | Loss=0.01825 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.633 | L2-Norm(final)=3.085 | 3618.5 samples/s | 56.5 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01634 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.632 | L2-Norm(final)=3.083 | 3588.2 samples/s | 56.1 steps/s
[Step=21800 Epoch=106.3] | Loss=0.01495 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.632 | L2-Norm(final)=3.084 | 4475.0 samples/s | 69.9 steps/s
[Step=21850 Epoch=106.6] | Loss=0.01286 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.631 | L2-Norm(final)=3.085 | 1608.3 samples/s | 25.1 steps/s
[Step=21900 Epoch=106.8] | Loss=0.01190 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.631 | L2-Norm(final)=3.087 | 3580.8 samples/s | 56.0 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01114 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.630 | L2-Norm(final)=3.089 | 3595.0 samples/s | 56.2 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01039 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.630 | L2-Norm(final)=3.091 | 4238.4 samples/s | 66.2 steps/s
[Step=22050 Epoch=107.5] | Loss=0.00960 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.630 | L2-Norm(final)=3.093 | 1664.6 samples/s | 26.0 steps/s
[Step=22100 Epoch=107.8] | Loss=0.00908 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.629 | L2-Norm(final)=3.095 | 3615.2 samples/s | 56.5 steps/s
[Step=22150 Epoch=108.0] | Loss=0.00851 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.629 | L2-Norm(final)=3.097 | 3581.2 samples/s | 56.0 steps/s
[Step=22200 Epoch=108.3] | Loss=0.00820 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.629 | L2-Norm(final)=3.099 | 4063.5 samples/s | 63.5 steps/s
[Step=22250 Epoch=108.5] | Loss=0.00779 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=3.101 | 1705.0 samples/s | 26.6 steps/s
[Step=22300 Epoch=108.7] | Loss=0.00751 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=3.103 | 3732.0 samples/s | 58.3 steps/s
[Step=22350 Epoch=109.0] | Loss=0.00731 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=3.105 | 3754.3 samples/s | 58.7 steps/s
[Step=22400 Epoch=109.2] | Loss=0.00710 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.627 | L2-Norm(final)=3.106 | 3972.0 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step22400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.9] | Loss=0.13915 | Reg=0.00312 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=17.653 | L2-Norm(final)=3.091 | 3710.1 samples/s | 58.0 steps/s
[Step=21650 Epoch=106.2] | Loss=0.02733 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.636 | L2-Norm(final)=3.078 | 3695.5 samples/s | 57.7 steps/s
[Step=21700 Epoch=106.4] | Loss=0.02008 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.630 | L2-Norm(final)=3.076 | 3656.2 samples/s | 57.1 steps/s
[Step=21750 Epoch=106.7] | Loss=0.01776 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.629 | L2-Norm(final)=3.077 | 3612.4 samples/s | 56.4 steps/s
[Step=21800 Epoch=106.9] | Loss=0.01535 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=3.079 | 4545.3 samples/s | 71.0 steps/s
[Step=21850 Epoch=107.1] | Loss=0.01341 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.628 | L2-Norm(final)=3.082 | 1599.3 samples/s | 25.0 steps/s
[Step=21900 Epoch=107.4] | Loss=0.01192 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=3.085 | 3653.9 samples/s | 57.1 steps/s
[Step=21950 Epoch=107.6] | Loss=0.01106 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.627 | L2-Norm(final)=3.088 | 3633.6 samples/s | 56.8 steps/s
[Step=22000 Epoch=107.9] | Loss=0.01032 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=3.091 | 4352.8 samples/s | 68.0 steps/s
[Step=22050 Epoch=108.1] | Loss=0.01000 | Reg=0.00311 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.628 | L2-Norm(final)=3.094 | 1648.1 samples/s | 25.8 steps/s
[Step=22100 Epoch=108.4] | Loss=0.00937 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=3.096 | 3649.2 samples/s | 57.0 steps/s
[Step=22150 Epoch=108.6] | Loss=0.00892 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=3.098 | 3655.8 samples/s | 57.1 steps/s
[Step=22200 Epoch=108.9] | Loss=0.00852 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=3.100 | 4224.4 samples/s | 66.0 steps/s
[Step=22250 Epoch=109.1] | Loss=0.00808 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=3.102 | 1674.9 samples/s | 26.2 steps/s
[Step=22300 Epoch=109.4] | Loss=0.00775 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=3.104 | 3718.4 samples/s | 58.1 steps/s
[Step=22350 Epoch=109.6] | Loss=0.00751 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.627 | L2-Norm(final)=3.106 | 3726.3 samples/s | 58.2 steps/s
[Step=22400 Epoch=109.8] | Loss=0.00734 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.627 | L2-Norm(final)=3.108 | 4157.7 samples/s | 65.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step22400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=204.7] | Loss=0.02677 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.653 | L2-Norm(final)=3.092 | 3790.6 samples/s | 59.2 steps/s
[Step=21650 Epoch=205.2] | Loss=0.00762 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.609 | L2-Norm(final)=3.089 | 3315.2 samples/s | 51.8 steps/s
[Step=21700 Epoch=205.6] | Loss=0.00396 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.601 | L2-Norm(final)=3.089 | 4492.3 samples/s | 70.2 steps/s
[Step=21750 Epoch=206.1] | Loss=0.00265 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.596 | L2-Norm(final)=3.090 | 1583.5 samples/s | 24.7 steps/s
[Step=21800 Epoch=206.6] | Loss=0.00200 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.592 | L2-Norm(final)=3.091 | 4151.6 samples/s | 64.9 steps/s
[Step=21850 Epoch=207.0] | Loss=0.00160 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.589 | L2-Norm(final)=3.092 | 1629.1 samples/s | 25.5 steps/s
[Step=21900 Epoch=207.5] | Loss=0.00134 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.586 | L2-Norm(final)=3.092 | 4001.2 samples/s | 62.5 steps/s
[Step=21950 Epoch=208.0] | Loss=0.00115 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.583 | L2-Norm(final)=3.093 | 1664.8 samples/s | 26.0 steps/s
[Step=22000 Epoch=208.5] | Loss=0.00101 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.581 | L2-Norm(final)=3.093 | 3775.1 samples/s | 59.0 steps/s
[Step=22050 Epoch=208.9] | Loss=0.00090 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.579 | L2-Norm(final)=3.094 | 1702.1 samples/s | 26.6 steps/s
[Step=22100 Epoch=209.4] | Loss=0.00081 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.577 | L2-Norm(final)=3.094 | 3638.7 samples/s | 56.9 steps/s
[Step=22150 Epoch=209.9] | Loss=0.00074 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.575 | L2-Norm(final)=3.094 | 1710.2 samples/s | 26.7 steps/s
[Step=22200 Epoch=210.4] | Loss=0.00068 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.574 | L2-Norm(final)=3.095 | 3579.1 samples/s | 55.9 steps/s
[Step=22250 Epoch=210.8] | Loss=0.00063 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.572 | L2-Norm(final)=3.095 | 1757.1 samples/s | 27.5 steps/s
[Step=22300 Epoch=211.3] | Loss=0.00059 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.571 | L2-Norm(final)=3.095 | 3558.5 samples/s | 55.6 steps/s
[Step=22350 Epoch=211.8] | Loss=0.00055 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.569 | L2-Norm(final)=3.095 | 1754.3 samples/s | 27.4 steps/s
[Step=22400 Epoch=212.3] | Loss=0.00051 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.568 | L2-Norm(final)=3.096 | 3469.2 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step22400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=205.5] | Loss=0.16310 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.653 | L2-Norm(final)=3.091 | 3540.8 samples/s | 55.3 steps/s
[Step=21650 Epoch=205.9] | Loss=0.00725 | Reg=0.00310 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.606 | L2-Norm(final)=3.090 | 3540.4 samples/s | 55.3 steps/s
[Step=21700 Epoch=206.4] | Loss=0.00384 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.605 | L2-Norm(final)=3.091 | 4404.4 samples/s | 68.8 steps/s
[Step=21750 Epoch=206.9] | Loss=0.00258 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.601 | L2-Norm(final)=3.093 | 1579.2 samples/s | 24.7 steps/s
[Step=21800 Epoch=207.4] | Loss=0.00194 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.598 | L2-Norm(final)=3.094 | 4246.8 samples/s | 66.4 steps/s
[Step=21850 Epoch=207.8] | Loss=0.00156 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.595 | L2-Norm(final)=3.095 | 1616.6 samples/s | 25.3 steps/s
[Step=21900 Epoch=208.3] | Loss=0.00131 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.592 | L2-Norm(final)=3.096 | 3886.7 samples/s | 60.7 steps/s
[Step=21950 Epoch=208.8] | Loss=0.00112 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.589 | L2-Norm(final)=3.096 | 1653.9 samples/s | 25.8 steps/s
[Step=22000 Epoch=209.3] | Loss=0.00099 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.587 | L2-Norm(final)=3.097 | 3807.5 samples/s | 59.5 steps/s
[Step=22050 Epoch=209.8] | Loss=0.00088 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.584 | L2-Norm(final)=3.097 | 1686.5 samples/s | 26.4 steps/s
[Step=22100 Epoch=210.2] | Loss=0.00079 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.582 | L2-Norm(final)=3.098 | 3619.8 samples/s | 56.6 steps/s
[Step=22150 Epoch=210.7] | Loss=0.00072 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.580 | L2-Norm(final)=3.098 | 1730.8 samples/s | 27.0 steps/s
[Step=22200 Epoch=211.2] | Loss=0.00066 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.578 | L2-Norm(final)=3.098 | 3546.5 samples/s | 55.4 steps/s
[Step=22250 Epoch=211.7] | Loss=0.00061 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.576 | L2-Norm(final)=3.099 | 1728.3 samples/s | 27.0 steps/s
[Step=22300 Epoch=212.1] | Loss=0.00057 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.575 | L2-Norm(final)=3.099 | 3579.3 samples/s | 55.9 steps/s
[Step=22350 Epoch=212.6] | Loss=0.00053 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.573 | L2-Norm(final)=3.099 | 1763.9 samples/s | 27.6 steps/s
[Step=22400 Epoch=213.1] | Loss=0.00050 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.572 | L2-Norm(final)=3.099 | 3539.3 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step22400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=206.3] | Loss=0.06685 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.653 | L2-Norm(final)=3.092 | 3603.2 samples/s | 56.3 steps/s
[Step=21650 Epoch=206.7] | Loss=0.00435 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.605 | L2-Norm(final)=3.099 | 3472.3 samples/s | 54.3 steps/s
[Step=21700 Epoch=207.2] | Loss=0.00240 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.599 | L2-Norm(final)=3.102 | 4505.9 samples/s | 70.4 steps/s
[Step=21750 Epoch=207.7] | Loss=0.00162 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.595 | L2-Norm(final)=3.104 | 1566.5 samples/s | 24.5 steps/s
[Step=21800 Epoch=208.2] | Loss=0.00122 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.591 | L2-Norm(final)=3.105 | 4197.0 samples/s | 65.6 steps/s
[Step=21850 Epoch=208.7] | Loss=0.00098 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.588 | L2-Norm(final)=3.106 | 1598.7 samples/s | 25.0 steps/s
[Step=21900 Epoch=209.1] | Loss=0.00082 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.585 | L2-Norm(final)=3.106 | 4081.7 samples/s | 63.8 steps/s
[Step=21950 Epoch=209.6] | Loss=0.00071 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.583 | L2-Norm(final)=3.106 | 1649.1 samples/s | 25.8 steps/s
[Step=22000 Epoch=210.1] | Loss=0.00062 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.580 | L2-Norm(final)=3.106 | 3804.7 samples/s | 59.4 steps/s
[Step=22050 Epoch=210.6] | Loss=0.00056 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.578 | L2-Norm(final)=3.107 | 1653.7 samples/s | 25.8 steps/s
[Step=22100 Epoch=211.0] | Loss=0.00050 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.576 | L2-Norm(final)=3.107 | 3686.5 samples/s | 57.6 steps/s
[Step=22150 Epoch=211.5] | Loss=0.00046 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.575 | L2-Norm(final)=3.107 | 1698.5 samples/s | 26.5 steps/s
[Step=22200 Epoch=212.0] | Loss=0.00042 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.573 | L2-Norm(final)=3.107 | 3622.6 samples/s | 56.6 steps/s
[Step=22250 Epoch=212.5] | Loss=0.00039 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.571 | L2-Norm(final)=3.107 | 1738.9 samples/s | 27.2 steps/s
[Step=22300 Epoch=213.0] | Loss=0.00036 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.570 | L2-Norm(final)=3.107 | 3590.6 samples/s | 56.1 steps/s
[Step=22350 Epoch=213.4] | Loss=0.00034 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.568 | L2-Norm(final)=3.107 | 1760.0 samples/s | 27.5 steps/s
[Step=22400 Epoch=213.9] | Loss=0.00032 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.567 | L2-Norm(final)=3.107 | 3583.0 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step22400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=203.5] | Loss=0.01108 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.653 | L2-Norm(final)=3.092 | 3728.2 samples/s | 58.3 steps/s
[Step=21650 Epoch=204.0] | Loss=0.00397 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.606 | L2-Norm(final)=3.104 | 3340.4 samples/s | 52.2 steps/s
[Step=21700 Epoch=204.5] | Loss=0.00217 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.599 | L2-Norm(final)=3.106 | 4333.4 samples/s | 67.7 steps/s
[Step=21750 Epoch=204.9] | Loss=0.00149 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.595 | L2-Norm(final)=3.107 | 1585.2 samples/s | 24.8 steps/s
[Step=21800 Epoch=205.4] | Loss=0.00112 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.591 | L2-Norm(final)=3.108 | 4052.4 samples/s | 63.3 steps/s
[Step=21850 Epoch=205.9] | Loss=0.00090 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.588 | L2-Norm(final)=3.108 | 1642.9 samples/s | 25.7 steps/s
[Step=21900 Epoch=206.4] | Loss=0.00075 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.585 | L2-Norm(final)=3.108 | 3838.7 samples/s | 60.0 steps/s
[Step=21950 Epoch=206.8] | Loss=0.00065 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.583 | L2-Norm(final)=3.108 | 1687.5 samples/s | 26.4 steps/s
[Step=22000 Epoch=207.3] | Loss=0.00057 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.580 | L2-Norm(final)=3.108 | 3691.4 samples/s | 57.7 steps/s
[Step=22050 Epoch=207.8] | Loss=0.00051 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.578 | L2-Norm(final)=3.108 | 1698.0 samples/s | 26.5 steps/s
[Step=22100 Epoch=208.2] | Loss=0.00046 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.576 | L2-Norm(final)=3.108 | 3580.5 samples/s | 55.9 steps/s
[Step=22150 Epoch=208.7] | Loss=0.00042 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.575 | L2-Norm(final)=3.108 | 1727.5 samples/s | 27.0 steps/s
[Step=22200 Epoch=209.2] | Loss=0.00038 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.573 | L2-Norm(final)=3.108 | 3548.8 samples/s | 55.5 steps/s
[Step=22250 Epoch=209.7] | Loss=0.00035 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.571 | L2-Norm(final)=3.107 | 1741.8 samples/s | 27.2 steps/s
[Step=22300 Epoch=210.1] | Loss=0.00033 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.570 | L2-Norm(final)=3.107 | 3548.0 samples/s | 55.4 steps/s
[Step=22350 Epoch=210.6] | Loss=0.00031 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.568 | L2-Norm(final)=3.107 | 1812.9 samples/s | 28.3 steps/s
[Step=22400 Epoch=211.1] | Loss=0.00029 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.567 | L2-Norm(final)=3.107 | 3346.0 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step22400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=205.9] | Loss=0.04611 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.653 | L2-Norm(final)=3.092 | 3618.3 samples/s | 56.5 steps/s
[Step=21650 Epoch=206.3] | Loss=0.00439 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.606 | L2-Norm(final)=3.098 | 3511.0 samples/s | 54.9 steps/s
[Step=21700 Epoch=206.8] | Loss=0.00231 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.598 | L2-Norm(final)=3.100 | 4487.4 samples/s | 70.1 steps/s
[Step=21750 Epoch=207.3] | Loss=0.00156 | Reg=0.00310 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.593 | L2-Norm(final)=3.101 | 1579.6 samples/s | 24.7 steps/s
[Step=21800 Epoch=207.8] | Loss=0.00118 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.588 | L2-Norm(final)=3.102 | 4214.3 samples/s | 65.8 steps/s
[Step=21850 Epoch=208.3] | Loss=0.00095 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.585 | L2-Norm(final)=3.103 | 1584.4 samples/s | 24.8 steps/s
[Step=21900 Epoch=208.7] | Loss=0.00080 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.582 | L2-Norm(final)=3.104 | 4110.7 samples/s | 64.2 steps/s
[Step=21950 Epoch=209.2] | Loss=0.00069 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.579 | L2-Norm(final)=3.104 | 1645.0 samples/s | 25.7 steps/s
[Step=22000 Epoch=209.7] | Loss=0.00060 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.577 | L2-Norm(final)=3.105 | 3916.9 samples/s | 61.2 steps/s
[Step=22050 Epoch=210.2] | Loss=0.00054 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.575 | L2-Norm(final)=3.105 | 1645.7 samples/s | 25.7 steps/s
[Step=22100 Epoch=210.6] | Loss=0.00049 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.573 | L2-Norm(final)=3.105 | 3684.6 samples/s | 57.6 steps/s
[Step=22150 Epoch=211.1] | Loss=0.00045 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.571 | L2-Norm(final)=3.105 | 1685.0 samples/s | 26.3 steps/s
[Step=22200 Epoch=211.6] | Loss=0.00041 | Reg=0.00309 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.570 | L2-Norm(final)=3.106 | 3624.8 samples/s | 56.6 steps/s
[Step=22250 Epoch=212.1] | Loss=0.00038 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.568 | L2-Norm(final)=3.106 | 1711.1 samples/s | 26.7 steps/s
[Step=22300 Epoch=212.5] | Loss=0.00035 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.567 | L2-Norm(final)=3.106 | 3563.0 samples/s | 55.7 steps/s
[Step=22350 Epoch=213.0] | Loss=0.00033 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.565 | L2-Norm(final)=3.106 | 1755.8 samples/s | 27.4 steps/s
[Step=22400 Epoch=213.5] | Loss=0.00031 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.564 | L2-Norm(final)=3.106 | 3470.8 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20333 | acc=0.8755 | tpr=0.8264 | fpr=0.0181 | 3889.2 samples/s | 15.2 steps/s
Avg test loss: 0.20524, Avg test acc: 0.87467, Avg tpr: 0.82619, Avg fpr: 0.01872, total FA: 146

Testing server on iccad2012
[Step=  50] | Loss=0.44954 | acc=0.8374 | tpr=0.9646 | fpr=0.1649 | 3873.6 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.45737 | acc=0.8374 | tpr=0.9701 | fpr=0.1651 | 7026.7 samples/s | 27.4 steps/s
[Step= 150] | Loss=0.46406 | acc=0.8359 | tpr=0.9755 | fpr=0.1667 | 7199.2 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.46351 | acc=0.8364 | tpr=0.9727 | fpr=0.1661 | 7950.2 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.46235 | acc=0.8368 | tpr=0.9747 | fpr=0.1657 | 6800.0 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.46112 | acc=0.8373 | tpr=0.9709 | fpr=0.1651 | 7140.0 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.46273 | acc=0.8373 | tpr=0.9693 | fpr=0.1651 | 7594.3 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.46310 | acc=0.8376 | tpr=0.9672 | fpr=0.1647 | 7041.3 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.46676 | acc=0.8368 | tpr=0.9674 | fpr=0.1656 | 7242.3 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.46765 | acc=0.8365 | tpr=0.9683 | fpr=0.1659 | 7161.9 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.46657 | acc=0.8367 | tpr=0.9694 | fpr=0.1657 | 12627.2 samples/s | 49.3 steps/s
Avg test loss: 0.46653, Avg test acc: 0.83677, Avg tpr: 0.96949, Avg fpr: 0.16564, total FA: 22999

server round 28/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.2] | Loss=0.08881 | Reg=0.00309 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.571 | L2-Norm(final)=3.116 | 3978.2 samples/s | 62.2 steps/s
[Step=22450 Epoch=109.5] | Loss=0.01977 | Reg=0.00308 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.554 | L2-Norm(final)=3.110 | 3508.8 samples/s | 54.8 steps/s
[Step=22500 Epoch=109.7] | Loss=0.01599 | Reg=0.00308 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.548 | L2-Norm(final)=3.108 | 3659.3 samples/s | 57.2 steps/s
[Step=22550 Epoch=110.0] | Loss=0.01524 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.544 | L2-Norm(final)=3.107 | 3650.4 samples/s | 57.0 steps/s
[Step=22600 Epoch=110.2] | Loss=0.01378 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.542 | L2-Norm(final)=3.106 | 4502.6 samples/s | 70.4 steps/s
[Step=22650 Epoch=110.4] | Loss=0.01220 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.541 | L2-Norm(final)=3.108 | 1636.8 samples/s | 25.6 steps/s
[Step=22700 Epoch=110.7] | Loss=0.01120 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.540 | L2-Norm(final)=3.110 | 3740.9 samples/s | 58.5 steps/s
[Step=22750 Epoch=110.9] | Loss=0.01026 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.539 | L2-Norm(final)=3.112 | 3743.3 samples/s | 58.5 steps/s
[Step=22800 Epoch=111.2] | Loss=0.00978 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.539 | L2-Norm(final)=3.114 | 4406.1 samples/s | 68.8 steps/s
[Step=22850 Epoch=111.4] | Loss=0.00915 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.538 | L2-Norm(final)=3.116 | 1632.4 samples/s | 25.5 steps/s
[Step=22900 Epoch=111.7] | Loss=0.00860 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.538 | L2-Norm(final)=3.118 | 3646.5 samples/s | 57.0 steps/s
[Step=22950 Epoch=111.9] | Loss=0.00824 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.538 | L2-Norm(final)=3.120 | 3653.9 samples/s | 57.1 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00793 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.537 | L2-Norm(final)=3.122 | 4105.3 samples/s | 64.1 steps/s
[Step=23050 Epoch=112.4] | Loss=0.00773 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.537 | L2-Norm(final)=3.124 | 1683.7 samples/s | 26.3 steps/s
[Step=23100 Epoch=112.6] | Loss=0.00746 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.537 | L2-Norm(final)=3.126 | 3636.5 samples/s | 56.8 steps/s
[Step=23150 Epoch=112.9] | Loss=0.00732 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.537 | L2-Norm(final)=3.127 | 3656.8 samples/s | 57.1 steps/s
[Step=23200 Epoch=113.1] | Loss=0.00722 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.536 | L2-Norm(final)=3.128 | 3903.1 samples/s | 61.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step23200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.3] | Loss=0.14198 | Reg=0.00309 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.571 | L2-Norm(final)=3.115 | 3762.0 samples/s | 58.8 steps/s
[Step=22450 Epoch=109.5] | Loss=0.02365 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.556 | L2-Norm(final)=3.099 | 3588.3 samples/s | 56.1 steps/s
[Step=22500 Epoch=109.8] | Loss=0.01798 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.551 | L2-Norm(final)=3.100 | 3635.9 samples/s | 56.8 steps/s
[Step=22550 Epoch=110.0] | Loss=0.01640 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.549 | L2-Norm(final)=3.100 | 3658.1 samples/s | 57.2 steps/s
[Step=22600 Epoch=110.3] | Loss=0.01450 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.548 | L2-Norm(final)=3.101 | 4546.6 samples/s | 71.0 steps/s
[Step=22650 Epoch=110.5] | Loss=0.01287 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.547 | L2-Norm(final)=3.104 | 1625.6 samples/s | 25.4 steps/s
[Step=22700 Epoch=110.8] | Loss=0.01178 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.547 | L2-Norm(final)=3.106 | 3734.7 samples/s | 58.4 steps/s
[Step=22750 Epoch=111.0] | Loss=0.01063 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.546 | L2-Norm(final)=3.109 | 3729.7 samples/s | 58.3 steps/s
[Step=22800 Epoch=111.3] | Loss=0.00983 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.546 | L2-Norm(final)=3.111 | 4439.5 samples/s | 69.4 steps/s
[Step=22850 Epoch=111.5] | Loss=0.00933 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.545 | L2-Norm(final)=3.113 | 1662.2 samples/s | 26.0 steps/s
[Step=22900 Epoch=111.7] | Loss=0.00890 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.545 | L2-Norm(final)=3.115 | 3600.3 samples/s | 56.3 steps/s
[Step=22950 Epoch=112.0] | Loss=0.00848 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.544 | L2-Norm(final)=3.117 | 3642.5 samples/s | 56.9 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00821 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.544 | L2-Norm(final)=3.119 | 4219.6 samples/s | 65.9 steps/s
[Step=23050 Epoch=112.5] | Loss=0.00798 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.544 | L2-Norm(final)=3.121 | 1679.0 samples/s | 26.2 steps/s
[Step=23100 Epoch=112.7] | Loss=0.00777 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.122 | 3707.9 samples/s | 57.9 steps/s
[Step=23150 Epoch=113.0] | Loss=0.00754 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.542 | L2-Norm(final)=3.123 | 3671.5 samples/s | 57.4 steps/s
[Step=23200 Epoch=113.2] | Loss=0.00725 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.542 | L2-Norm(final)=3.124 | 4102.6 samples/s | 64.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step23200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.1] | Loss=0.02928 | Reg=0.00309 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.571 | L2-Norm(final)=3.117 | 3700.3 samples/s | 57.8 steps/s
[Step=22450 Epoch=109.4] | Loss=0.02156 | Reg=0.00308 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.548 | L2-Norm(final)=3.108 | 3582.7 samples/s | 56.0 steps/s
[Step=22500 Epoch=109.6] | Loss=0.01584 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.545 | L2-Norm(final)=3.108 | 3585.3 samples/s | 56.0 steps/s
[Step=22550 Epoch=109.9] | Loss=0.01469 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.543 | L2-Norm(final)=3.110 | 3586.0 samples/s | 56.0 steps/s
[Step=22600 Epoch=110.1] | Loss=0.01429 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.111 | 4603.8 samples/s | 71.9 steps/s
[Step=22650 Epoch=110.4] | Loss=0.01277 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.542 | L2-Norm(final)=3.112 | 1639.7 samples/s | 25.6 steps/s
[Step=22700 Epoch=110.6] | Loss=0.01133 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.542 | L2-Norm(final)=3.114 | 3701.8 samples/s | 57.8 steps/s
[Step=22750 Epoch=110.8] | Loss=0.01033 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.543 | L2-Norm(final)=3.117 | 3725.9 samples/s | 58.2 steps/s
[Step=22800 Epoch=111.1] | Loss=0.00986 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.120 | 4371.3 samples/s | 68.3 steps/s
[Step=22850 Epoch=111.3] | Loss=0.00942 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.122 | 1659.6 samples/s | 25.9 steps/s
[Step=22900 Epoch=111.6] | Loss=0.00900 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.124 | 3636.9 samples/s | 56.8 steps/s
[Step=22950 Epoch=111.8] | Loss=0.00848 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.127 | 3635.7 samples/s | 56.8 steps/s
[Step=23000 Epoch=112.1] | Loss=0.00824 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.129 | 4078.2 samples/s | 63.7 steps/s
[Step=23050 Epoch=112.3] | Loss=0.00809 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.130 | 1693.9 samples/s | 26.5 steps/s
[Step=23100 Epoch=112.6] | Loss=0.00788 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.132 | 3726.4 samples/s | 58.2 steps/s
[Step=23150 Epoch=112.8] | Loss=0.00768 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.133 | 3733.9 samples/s | 58.3 steps/s
[Step=23200 Epoch=113.0] | Loss=0.00751 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.135 | 3981.8 samples/s | 62.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step23200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.2] | Loss=0.08273 | Reg=0.00309 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.571 | L2-Norm(final)=3.116 | 3750.2 samples/s | 58.6 steps/s
[Step=22450 Epoch=109.5] | Loss=0.01982 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.550 | L2-Norm(final)=3.109 | 3646.6 samples/s | 57.0 steps/s
[Step=22500 Epoch=109.7] | Loss=0.01565 | Reg=0.00308 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.546 | L2-Norm(final)=3.109 | 3736.9 samples/s | 58.4 steps/s
[Step=22550 Epoch=110.0] | Loss=0.01368 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.544 | L2-Norm(final)=3.110 | 3726.8 samples/s | 58.2 steps/s
[Step=22600 Epoch=110.2] | Loss=0.01286 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.112 | 4645.4 samples/s | 72.6 steps/s
[Step=22650 Epoch=110.5] | Loss=0.01100 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.543 | L2-Norm(final)=3.114 | 1635.1 samples/s | 25.5 steps/s
[Step=22700 Epoch=110.7] | Loss=0.01022 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.117 | 3721.5 samples/s | 58.1 steps/s
[Step=22750 Epoch=110.9] | Loss=0.00948 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.119 | 3723.3 samples/s | 58.2 steps/s
[Step=22800 Epoch=111.2] | Loss=0.00926 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.543 | L2-Norm(final)=3.121 | 4393.1 samples/s | 68.6 steps/s
[Step=22850 Epoch=111.4] | Loss=0.00855 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.542 | L2-Norm(final)=3.123 | 1655.5 samples/s | 25.9 steps/s
[Step=22900 Epoch=111.7] | Loss=0.00805 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.542 | L2-Norm(final)=3.125 | 3689.0 samples/s | 57.6 steps/s
[Step=22950 Epoch=111.9] | Loss=0.00770 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.541 | L2-Norm(final)=3.126 | 3728.1 samples/s | 58.3 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00737 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.541 | L2-Norm(final)=3.128 | 4156.4 samples/s | 64.9 steps/s
[Step=23050 Epoch=112.4] | Loss=0.00710 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.540 | L2-Norm(final)=3.130 | 1682.0 samples/s | 26.3 steps/s
[Step=23100 Epoch=112.6] | Loss=0.00689 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.540 | L2-Norm(final)=3.131 | 3710.0 samples/s | 58.0 steps/s
[Step=23150 Epoch=112.9] | Loss=0.00668 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.540 | L2-Norm(final)=3.133 | 3646.2 samples/s | 57.0 steps/s
[Step=23200 Epoch=113.1] | Loss=0.00656 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.539 | L2-Norm(final)=3.134 | 3899.3 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step23200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.9] | Loss=0.03833 | Reg=0.00309 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.571 | L2-Norm(final)=3.117 | 3707.3 samples/s | 57.9 steps/s
[Step=22450 Epoch=110.1] | Loss=0.01780 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.554 | L2-Norm(final)=3.111 | 3606.9 samples/s | 56.4 steps/s
[Step=22500 Epoch=110.3] | Loss=0.01666 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.550 | L2-Norm(final)=3.111 | 3710.7 samples/s | 58.0 steps/s
[Step=22550 Epoch=110.6] | Loss=0.01456 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.548 | L2-Norm(final)=3.111 | 3696.5 samples/s | 57.8 steps/s
[Step=22600 Epoch=110.8] | Loss=0.01368 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.548 | L2-Norm(final)=3.113 | 4687.6 samples/s | 73.2 steps/s
[Step=22650 Epoch=111.1] | Loss=0.01174 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.548 | L2-Norm(final)=3.115 | 1624.2 samples/s | 25.4 steps/s
[Step=22700 Epoch=111.3] | Loss=0.01062 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.549 | L2-Norm(final)=3.118 | 3654.4 samples/s | 57.1 steps/s
[Step=22750 Epoch=111.6] | Loss=0.01014 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.549 | L2-Norm(final)=3.121 | 3646.4 samples/s | 57.0 steps/s
[Step=22800 Epoch=111.8] | Loss=0.00982 | Reg=0.00308 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.549 | L2-Norm(final)=3.124 | 4358.6 samples/s | 68.1 steps/s
[Step=22850 Epoch=112.1] | Loss=0.00917 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.549 | L2-Norm(final)=3.126 | 1633.4 samples/s | 25.5 steps/s
[Step=22900 Epoch=112.3] | Loss=0.00854 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.549 | L2-Norm(final)=3.129 | 3717.6 samples/s | 58.1 steps/s
[Step=22950 Epoch=112.5] | Loss=0.00836 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.549 | L2-Norm(final)=3.131 | 3729.0 samples/s | 58.3 steps/s
[Step=23000 Epoch=112.8] | Loss=0.00807 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.549 | L2-Norm(final)=3.133 | 4347.9 samples/s | 67.9 steps/s
[Step=23050 Epoch=113.0] | Loss=0.00775 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.549 | L2-Norm(final)=3.135 | 1660.1 samples/s | 25.9 steps/s
[Step=23100 Epoch=113.3] | Loss=0.00743 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.549 | L2-Norm(final)=3.137 | 3716.0 samples/s | 58.1 steps/s
[Step=23150 Epoch=113.5] | Loss=0.00719 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.549 | L2-Norm(final)=3.138 | 3720.0 samples/s | 58.1 steps/s
[Step=23200 Epoch=113.8] | Loss=0.00698 | Reg=0.00308 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.549 | L2-Norm(final)=3.140 | 4239.8 samples/s | 66.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step23200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=212.3] | Loss=0.06385 | Reg=0.00309 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.571 | L2-Norm(final)=3.117 | 3737.3 samples/s | 58.4 steps/s
[Step=22450 Epoch=212.7] | Loss=0.00826 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.532 | L2-Norm(final)=3.116 | 3322.2 samples/s | 51.9 steps/s
[Step=22500 Epoch=213.2] | Loss=0.00424 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.525 | L2-Norm(final)=3.116 | 4364.4 samples/s | 68.2 steps/s
[Step=22550 Epoch=213.7] | Loss=0.00284 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.520 | L2-Norm(final)=3.117 | 1567.1 samples/s | 24.5 steps/s
[Step=22600 Epoch=214.2] | Loss=0.00214 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.516 | L2-Norm(final)=3.118 | 4089.5 samples/s | 63.9 steps/s
[Step=22650 Epoch=214.6] | Loss=0.00172 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.512 | L2-Norm(final)=3.118 | 1583.7 samples/s | 24.7 steps/s
[Step=22700 Epoch=215.1] | Loss=0.00143 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.509 | L2-Norm(final)=3.118 | 3854.2 samples/s | 60.2 steps/s
[Step=22750 Epoch=215.6] | Loss=0.00123 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.507 | L2-Norm(final)=3.118 | 1659.2 samples/s | 25.9 steps/s
[Step=22800 Epoch=216.0] | Loss=0.00108 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.505 | L2-Norm(final)=3.119 | 3803.2 samples/s | 59.4 steps/s
[Step=22850 Epoch=216.5] | Loss=0.00096 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.502 | L2-Norm(final)=3.119 | 1690.3 samples/s | 26.4 steps/s
[Step=22900 Epoch=217.0] | Loss=0.00087 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.501 | L2-Norm(final)=3.119 | 3548.7 samples/s | 55.4 steps/s
[Step=22950 Epoch=217.5] | Loss=0.00079 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.499 | L2-Norm(final)=3.119 | 1707.4 samples/s | 26.7 steps/s
[Step=23000 Epoch=217.9] | Loss=0.00073 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.497 | L2-Norm(final)=3.119 | 3528.1 samples/s | 55.1 steps/s
[Step=23050 Epoch=218.4] | Loss=0.00067 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.496 | L2-Norm(final)=3.119 | 1747.5 samples/s | 27.3 steps/s
[Step=23100 Epoch=218.9] | Loss=0.00063 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.494 | L2-Norm(final)=3.120 | 3596.4 samples/s | 56.2 steps/s
[Step=23150 Epoch=219.4] | Loss=0.00058 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.493 | L2-Norm(final)=3.120 | 1763.6 samples/s | 27.6 steps/s
[Step=23200 Epoch=219.8] | Loss=0.00055 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.491 | L2-Norm(final)=3.120 | 3447.9 samples/s | 53.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step23200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=213.1] | Loss=0.11058 | Reg=0.00309 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.571 | L2-Norm(final)=3.117 | 3701.8 samples/s | 57.8 steps/s
[Step=22450 Epoch=213.6] | Loss=0.00669 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.536 | L2-Norm(final)=3.119 | 3322.2 samples/s | 51.9 steps/s
[Step=22500 Epoch=214.0] | Loss=0.00343 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.533 | L2-Norm(final)=3.119 | 4373.0 samples/s | 68.3 steps/s
[Step=22550 Epoch=214.5] | Loss=0.00231 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.528 | L2-Norm(final)=3.119 | 1578.6 samples/s | 24.7 steps/s
[Step=22600 Epoch=215.0] | Loss=0.00174 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.523 | L2-Norm(final)=3.120 | 4232.7 samples/s | 66.1 steps/s
[Step=22650 Epoch=215.5] | Loss=0.00140 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.519 | L2-Norm(final)=3.120 | 1616.4 samples/s | 25.3 steps/s
[Step=22700 Epoch=215.9] | Loss=0.00117 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.516 | L2-Norm(final)=3.120 | 3981.4 samples/s | 62.2 steps/s
[Step=22750 Epoch=216.4] | Loss=0.00100 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.513 | L2-Norm(final)=3.121 | 1650.8 samples/s | 25.8 steps/s
[Step=22800 Epoch=216.9] | Loss=0.00088 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.510 | L2-Norm(final)=3.121 | 3712.9 samples/s | 58.0 steps/s
[Step=22850 Epoch=217.4] | Loss=0.00079 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.508 | L2-Norm(final)=3.121 | 1678.4 samples/s | 26.2 steps/s
[Step=22900 Epoch=217.8] | Loss=0.00071 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.506 | L2-Norm(final)=3.121 | 3498.0 samples/s | 54.7 steps/s
[Step=22950 Epoch=218.3] | Loss=0.00065 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.504 | L2-Norm(final)=3.122 | 1695.0 samples/s | 26.5 steps/s
[Step=23000 Epoch=218.8] | Loss=0.00059 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.502 | L2-Norm(final)=3.122 | 3464.2 samples/s | 54.1 steps/s
[Step=23050 Epoch=219.3] | Loss=0.00055 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.500 | L2-Norm(final)=3.122 | 1736.1 samples/s | 27.1 steps/s
[Step=23100 Epoch=219.7] | Loss=0.00051 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.498 | L2-Norm(final)=3.122 | 3591.2 samples/s | 56.1 steps/s
[Step=23150 Epoch=220.2] | Loss=0.00048 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.496 | L2-Norm(final)=3.123 | 1738.6 samples/s | 27.2 steps/s
[Step=23200 Epoch=220.7] | Loss=0.00045 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.495 | L2-Norm(final)=3.123 | 3531.2 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step23200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=213.9] | Loss=0.19495 | Reg=0.00309 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.571 | L2-Norm(final)=3.116 | 3721.2 samples/s | 58.1 steps/s
[Step=22450 Epoch=214.4] | Loss=0.00778 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.532 | L2-Norm(final)=3.112 | 3276.2 samples/s | 51.2 steps/s
[Step=22500 Epoch=214.9] | Loss=0.00423 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.525 | L2-Norm(final)=3.113 | 4517.2 samples/s | 70.6 steps/s
[Step=22550 Epoch=215.3] | Loss=0.00284 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.520 | L2-Norm(final)=3.115 | 1577.4 samples/s | 24.6 steps/s
[Step=22600 Epoch=215.8] | Loss=0.00214 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.516 | L2-Norm(final)=3.117 | 4235.8 samples/s | 66.2 steps/s
[Step=22650 Epoch=216.3] | Loss=0.00172 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.512 | L2-Norm(final)=3.118 | 1589.7 samples/s | 24.8 steps/s
[Step=22700 Epoch=216.8] | Loss=0.00144 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.509 | L2-Norm(final)=3.119 | 4023.3 samples/s | 62.9 steps/s
[Step=22750 Epoch=217.2] | Loss=0.00124 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.506 | L2-Norm(final)=3.119 | 1632.0 samples/s | 25.5 steps/s
[Step=22800 Epoch=217.7] | Loss=0.00109 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.504 | L2-Norm(final)=3.120 | 3876.5 samples/s | 60.6 steps/s
[Step=22850 Epoch=218.2] | Loss=0.00097 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.502 | L2-Norm(final)=3.121 | 1658.5 samples/s | 25.9 steps/s
[Step=22900 Epoch=218.7] | Loss=0.00087 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.500 | L2-Norm(final)=3.121 | 3724.6 samples/s | 58.2 steps/s
[Step=22950 Epoch=219.2] | Loss=0.00080 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.498 | L2-Norm(final)=3.122 | 1674.9 samples/s | 26.2 steps/s
[Step=23000 Epoch=219.6] | Loss=0.00073 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.496 | L2-Norm(final)=3.122 | 3545.9 samples/s | 55.4 steps/s
[Step=23050 Epoch=220.1] | Loss=0.00068 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.494 | L2-Norm(final)=3.122 | 1698.0 samples/s | 26.5 steps/s
[Step=23100 Epoch=220.6] | Loss=0.00063 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.493 | L2-Norm(final)=3.123 | 3487.5 samples/s | 54.5 steps/s
[Step=23150 Epoch=221.1] | Loss=0.00059 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.491 | L2-Norm(final)=3.123 | 1678.5 samples/s | 26.2 steps/s
[Step=23200 Epoch=221.5] | Loss=0.00055 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.490 | L2-Norm(final)=3.123 | 3033.0 samples/s | 47.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step23200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=211.1] | Loss=0.03515 | Reg=0.00309 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.571 | L2-Norm(final)=3.117 | 3285.8 samples/s | 51.3 steps/s
[Step=22450 Epoch=211.5] | Loss=0.00352 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.532 | L2-Norm(final)=3.126 | 2934.4 samples/s | 45.8 steps/s
[Step=22500 Epoch=212.0] | Loss=0.00218 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.529 | L2-Norm(final)=3.128 | 3967.0 samples/s | 62.0 steps/s
[Step=22550 Epoch=212.5] | Loss=0.00149 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.526 | L2-Norm(final)=3.130 | 1527.0 samples/s | 23.9 steps/s
[Step=22600 Epoch=213.0] | Loss=0.00113 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.522 | L2-Norm(final)=3.131 | 4024.9 samples/s | 62.9 steps/s
[Step=22650 Epoch=213.4] | Loss=0.00091 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.519 | L2-Norm(final)=3.132 | 1610.8 samples/s | 25.2 steps/s
[Step=22700 Epoch=213.9] | Loss=0.00076 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.516 | L2-Norm(final)=3.132 | 3756.6 samples/s | 58.7 steps/s
[Step=22750 Epoch=214.4] | Loss=0.00065 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.513 | L2-Norm(final)=3.132 | 1633.5 samples/s | 25.5 steps/s
[Step=22800 Epoch=214.8] | Loss=0.00057 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.510 | L2-Norm(final)=3.133 | 3576.8 samples/s | 55.9 steps/s
[Step=22850 Epoch=215.3] | Loss=0.00051 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.508 | L2-Norm(final)=3.133 | 1675.9 samples/s | 26.2 steps/s
[Step=22900 Epoch=215.8] | Loss=0.00046 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.505 | L2-Norm(final)=3.133 | 3388.2 samples/s | 52.9 steps/s
[Step=22950 Epoch=216.3] | Loss=0.00042 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.503 | L2-Norm(final)=3.133 | 1718.4 samples/s | 26.9 steps/s
[Step=23000 Epoch=216.7] | Loss=0.00039 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.501 | L2-Norm(final)=3.133 | 3595.6 samples/s | 56.2 steps/s
[Step=23050 Epoch=217.2] | Loss=0.00036 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.499 | L2-Norm(final)=3.133 | 1747.1 samples/s | 27.3 steps/s
[Step=23100 Epoch=217.7] | Loss=0.00034 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.498 | L2-Norm(final)=3.133 | 3359.0 samples/s | 52.5 steps/s
[Step=23150 Epoch=218.1] | Loss=0.00031 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.496 | L2-Norm(final)=3.133 | 1849.3 samples/s | 28.9 steps/s
[Step=23200 Epoch=218.6] | Loss=0.00030 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.494 | L2-Norm(final)=3.133 | 3163.9 samples/s | 49.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step23200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=213.5] | Loss=0.09430 | Reg=0.00309 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.571 | L2-Norm(final)=3.117 | 3588.0 samples/s | 56.1 steps/s
[Step=22450 Epoch=214.0] | Loss=0.00596 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.531 | L2-Norm(final)=3.123 | 2828.2 samples/s | 44.2 steps/s
[Step=22500 Epoch=214.4] | Loss=0.00330 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.528 | L2-Norm(final)=3.124 | 4048.9 samples/s | 63.3 steps/s
[Step=22550 Epoch=214.9] | Loss=0.00223 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.524 | L2-Norm(final)=3.125 | 1534.1 samples/s | 24.0 steps/s
[Step=22600 Epoch=215.4] | Loss=0.00168 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.520 | L2-Norm(final)=3.127 | 4115.1 samples/s | 64.3 steps/s
[Step=22650 Epoch=215.9] | Loss=0.00136 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.517 | L2-Norm(final)=3.127 | 1569.4 samples/s | 24.5 steps/s
[Step=22700 Epoch=216.4] | Loss=0.00113 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.513 | L2-Norm(final)=3.128 | 4063.0 samples/s | 63.5 steps/s
[Step=22750 Epoch=216.8] | Loss=0.00097 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.510 | L2-Norm(final)=3.128 | 1636.4 samples/s | 25.6 steps/s
[Step=22800 Epoch=217.3] | Loss=0.00085 | Reg=0.00307 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.508 | L2-Norm(final)=3.128 | 3925.7 samples/s | 61.3 steps/s
[Step=22850 Epoch=217.8] | Loss=0.00076 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.505 | L2-Norm(final)=3.129 | 1686.5 samples/s | 26.4 steps/s
[Step=22900 Epoch=218.3] | Loss=0.00069 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.503 | L2-Norm(final)=3.129 | 3762.0 samples/s | 58.8 steps/s
[Step=22950 Epoch=218.7] | Loss=0.00063 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.501 | L2-Norm(final)=3.129 | 1705.5 samples/s | 26.6 steps/s
[Step=23000 Epoch=219.2] | Loss=0.00058 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.499 | L2-Norm(final)=3.129 | 3538.7 samples/s | 55.3 steps/s
[Step=23050 Epoch=219.7] | Loss=0.00053 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.497 | L2-Norm(final)=3.129 | 1713.5 samples/s | 26.8 steps/s
[Step=23100 Epoch=220.2] | Loss=0.00050 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.495 | L2-Norm(final)=3.129 | 3570.5 samples/s | 55.8 steps/s
[Step=23150 Epoch=220.6] | Loss=0.00046 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.493 | L2-Norm(final)=3.129 | 1718.1 samples/s | 26.8 steps/s
[Step=23200 Epoch=221.1] | Loss=0.00044 | Reg=0.00306 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.492 | L2-Norm(final)=3.129 | 3552.6 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21115 | acc=0.8723 | tpr=0.8213 | fpr=0.0171 | 3832.1 samples/s | 15.0 steps/s
Avg test loss: 0.21171, Avg test acc: 0.87207, Avg tpr: 0.82182, Avg fpr: 0.01743, total FA: 136

Testing server on iccad2012
[Step=  50] | Loss=0.45326 | acc=0.8420 | tpr=0.9735 | fpr=0.1603 | 3868.5 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.46213 | acc=0.8410 | tpr=0.9701 | fpr=0.1614 | 7007.7 samples/s | 27.4 steps/s
[Step= 150] | Loss=0.46957 | acc=0.8391 | tpr=0.9755 | fpr=0.1634 | 7258.7 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.46888 | acc=0.8399 | tpr=0.9727 | fpr=0.1625 | 7368.7 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.46840 | acc=0.8405 | tpr=0.9747 | fpr=0.1620 | 7091.3 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.46710 | acc=0.8410 | tpr=0.9709 | fpr=0.1614 | 7306.6 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.46854 | acc=0.8410 | tpr=0.9687 | fpr=0.1614 | 7273.9 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.46896 | acc=0.8410 | tpr=0.9661 | fpr=0.1613 | 7188.0 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.47248 | acc=0.8400 | tpr=0.9659 | fpr=0.1623 | 7162.2 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.47357 | acc=0.8395 | tpr=0.9670 | fpr=0.1628 | 7306.9 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.47239 | acc=0.8397 | tpr=0.9682 | fpr=0.1626 | 13153.8 samples/s | 51.4 steps/s
Avg test loss: 0.47232, Avg test acc: 0.83973, Avg tpr: 0.96830, Avg fpr: 0.16260, total FA: 22577

server round 29/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.1] | Loss=0.17542 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.490 | L2-Norm(final)=3.140 | 3822.5 samples/s | 59.7 steps/s
[Step=23250 Epoch=113.4] | Loss=0.02420 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.472 | L2-Norm(final)=3.125 | 3607.8 samples/s | 56.4 steps/s
[Step=23300 Epoch=113.6] | Loss=0.01928 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.465 | L2-Norm(final)=3.122 | 3641.0 samples/s | 56.9 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01659 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.461 | L2-Norm(final)=3.122 | 3571.8 samples/s | 55.8 steps/s
[Step=23400 Epoch=114.1] | Loss=0.01496 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.460 | L2-Norm(final)=3.124 | 4437.1 samples/s | 69.3 steps/s
[Step=23450 Epoch=114.3] | Loss=0.01292 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.460 | L2-Norm(final)=3.127 | 1609.3 samples/s | 25.1 steps/s
[Step=23500 Epoch=114.6] | Loss=0.01153 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.460 | L2-Norm(final)=3.130 | 3407.6 samples/s | 53.2 steps/s
[Step=23550 Epoch=114.8] | Loss=0.01047 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.459 | L2-Norm(final)=3.134 | 3353.4 samples/s | 52.4 steps/s
[Step=23600 Epoch=115.1] | Loss=0.00987 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.460 | L2-Norm(final)=3.137 | 4291.8 samples/s | 67.1 steps/s
[Step=23650 Epoch=115.3] | Loss=0.01103 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.461 | L2-Norm(final)=3.138 | 1531.6 samples/s | 23.9 steps/s
[Step=23700 Epoch=115.6] | Loss=0.01157 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.463 | L2-Norm(final)=3.138 | 3442.3 samples/s | 53.8 steps/s
[Step=23750 Epoch=115.8] | Loss=0.01113 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.464 | L2-Norm(final)=3.138 | 3731.6 samples/s | 58.3 steps/s
[Step=23800 Epoch=116.1] | Loss=0.01093 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.466 | L2-Norm(final)=3.138 | 4201.5 samples/s | 65.6 steps/s
[Step=23850 Epoch=116.3] | Loss=0.01036 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=3.139 | 1702.5 samples/s | 26.6 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00984 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.468 | L2-Norm(final)=3.140 | 3646.8 samples/s | 57.0 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00985 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.469 | L2-Norm(final)=3.141 | 3643.2 samples/s | 56.9 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00960 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.469 | L2-Norm(final)=3.142 | 3841.2 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.2] | Loss=0.09736 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.490 | L2-Norm(final)=3.141 | 3703.7 samples/s | 57.9 steps/s
[Step=23250 Epoch=113.4] | Loss=0.01851 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.476 | L2-Norm(final)=3.137 | 3671.5 samples/s | 57.4 steps/s
[Step=23300 Epoch=113.7] | Loss=0.01636 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.471 | L2-Norm(final)=3.135 | 3714.9 samples/s | 58.0 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01502 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.469 | L2-Norm(final)=3.134 | 3738.4 samples/s | 58.4 steps/s
[Step=23400 Epoch=114.2] | Loss=0.01363 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.468 | L2-Norm(final)=3.134 | 4612.6 samples/s | 72.1 steps/s
[Step=23450 Epoch=114.4] | Loss=0.01235 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.468 | L2-Norm(final)=3.135 | 1609.0 samples/s | 25.1 steps/s
[Step=23500 Epoch=114.7] | Loss=0.01156 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.468 | L2-Norm(final)=3.137 | 3651.7 samples/s | 57.1 steps/s
[Step=23550 Epoch=114.9] | Loss=0.01071 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=3.138 | 3659.9 samples/s | 57.2 steps/s
[Step=23600 Epoch=115.2] | Loss=0.00999 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=3.139 | 4338.8 samples/s | 67.8 steps/s
[Step=23650 Epoch=115.4] | Loss=0.00926 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.466 | L2-Norm(final)=3.140 | 1649.9 samples/s | 25.8 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00870 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.466 | L2-Norm(final)=3.142 | 3585.9 samples/s | 56.0 steps/s
[Step=23750 Epoch=115.9] | Loss=0.00814 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.466 | L2-Norm(final)=3.144 | 3585.1 samples/s | 56.0 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00797 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.465 | L2-Norm(final)=3.146 | 4058.7 samples/s | 63.4 steps/s
[Step=23850 Epoch=116.4] | Loss=0.00760 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.464 | L2-Norm(final)=3.147 | 1661.3 samples/s | 26.0 steps/s
[Step=23900 Epoch=116.6] | Loss=0.00742 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.464 | L2-Norm(final)=3.148 | 3663.9 samples/s | 57.2 steps/s
[Step=23950 Epoch=116.9] | Loss=0.00722 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.463 | L2-Norm(final)=3.149 | 3667.5 samples/s | 57.3 steps/s
[Step=24000 Epoch=117.1] | Loss=0.00700 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.462 | L2-Norm(final)=3.150 | 4012.3 samples/s | 62.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step24000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.0] | Loss=0.07863 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.490 | L2-Norm(final)=3.141 | 3667.3 samples/s | 57.3 steps/s
[Step=23250 Epoch=113.3] | Loss=0.01906 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=3.137 | 3651.8 samples/s | 57.1 steps/s
[Step=23300 Epoch=113.5] | Loss=0.01691 | Reg=0.00305 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.464 | L2-Norm(final)=3.134 | 3714.5 samples/s | 58.0 steps/s
[Step=23350 Epoch=113.8] | Loss=0.01451 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.462 | L2-Norm(final)=3.134 | 3675.2 samples/s | 57.4 steps/s
[Step=23400 Epoch=114.0] | Loss=0.01340 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.461 | L2-Norm(final)=3.136 | 4528.0 samples/s | 70.8 steps/s
[Step=23450 Epoch=114.3] | Loss=0.01211 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=17.461 | L2-Norm(final)=3.138 | 1631.2 samples/s | 25.5 steps/s
[Step=23500 Epoch=114.5] | Loss=0.01129 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.461 | L2-Norm(final)=3.140 | 3607.5 samples/s | 56.4 steps/s
[Step=23550 Epoch=114.7] | Loss=0.01055 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.461 | L2-Norm(final)=3.142 | 3596.8 samples/s | 56.2 steps/s
[Step=23600 Epoch=115.0] | Loss=0.00972 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.461 | L2-Norm(final)=3.144 | 4245.1 samples/s | 66.3 steps/s
[Step=23650 Epoch=115.2] | Loss=0.00918 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.461 | L2-Norm(final)=3.146 | 1643.0 samples/s | 25.7 steps/s
[Step=23700 Epoch=115.5] | Loss=0.00865 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.461 | L2-Norm(final)=3.149 | 3634.3 samples/s | 56.8 steps/s
[Step=23750 Epoch=115.7] | Loss=0.00832 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.461 | L2-Norm(final)=3.151 | 3680.5 samples/s | 57.5 steps/s
[Step=23800 Epoch=116.0] | Loss=0.00812 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.461 | L2-Norm(final)=3.152 | 4006.8 samples/s | 62.6 steps/s
[Step=23850 Epoch=116.2] | Loss=0.00781 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.461 | L2-Norm(final)=3.154 | 1687.5 samples/s | 26.4 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00756 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.460 | L2-Norm(final)=3.156 | 3730.4 samples/s | 58.3 steps/s
[Step=23950 Epoch=116.7] | Loss=0.00735 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.460 | L2-Norm(final)=3.157 | 3717.9 samples/s | 58.1 steps/s
[Step=24000 Epoch=116.9] | Loss=0.00711 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.460 | L2-Norm(final)=3.158 | 3981.9 samples/s | 62.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step24000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.1] | Loss=0.03931 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.490 | L2-Norm(final)=3.141 | 3668.0 samples/s | 57.3 steps/s
[Step=23250 Epoch=113.4] | Loss=0.02111 | Reg=0.00305 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.472 | L2-Norm(final)=3.134 | 3578.9 samples/s | 55.9 steps/s
[Step=23300 Epoch=113.6] | Loss=0.01583 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.469 | L2-Norm(final)=3.134 | 3655.5 samples/s | 57.1 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01406 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=17.468 | L2-Norm(final)=3.136 | 3648.3 samples/s | 57.0 steps/s
[Step=23400 Epoch=114.1] | Loss=0.01236 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.467 | L2-Norm(final)=3.138 | 4456.5 samples/s | 69.6 steps/s
[Step=23450 Epoch=114.4] | Loss=0.01109 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=3.140 | 1617.3 samples/s | 25.3 steps/s
[Step=23500 Epoch=114.6] | Loss=0.01039 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=3.143 | 3665.6 samples/s | 57.3 steps/s
[Step=23550 Epoch=114.8] | Loss=0.00936 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=3.145 | 3657.8 samples/s | 57.2 steps/s
[Step=23600 Epoch=115.1] | Loss=0.00916 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=3.147 | 4269.6 samples/s | 66.7 steps/s
[Step=23650 Epoch=115.3] | Loss=0.00876 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.466 | L2-Norm(final)=3.148 | 1661.8 samples/s | 26.0 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00843 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.466 | L2-Norm(final)=3.150 | 3642.0 samples/s | 56.9 steps/s
[Step=23750 Epoch=115.8] | Loss=0.00798 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.466 | L2-Norm(final)=3.151 | 3653.2 samples/s | 57.1 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00786 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.465 | L2-Norm(final)=3.153 | 4095.9 samples/s | 64.0 steps/s
[Step=23850 Epoch=116.3] | Loss=0.00749 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.465 | L2-Norm(final)=3.154 | 1675.0 samples/s | 26.2 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00723 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.464 | L2-Norm(final)=3.155 | 3658.2 samples/s | 57.2 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00694 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.464 | L2-Norm(final)=3.156 | 3655.7 samples/s | 57.1 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00680 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.463 | L2-Norm(final)=3.158 | 3894.1 samples/s | 60.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step24000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.8] | Loss=0.21301 | Reg=0.00306 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=17.490 | L2-Norm(final)=3.140 | 3634.5 samples/s | 56.8 steps/s
[Step=23250 Epoch=114.0] | Loss=0.02121 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.473 | L2-Norm(final)=3.129 | 3695.1 samples/s | 57.7 steps/s
[Step=23300 Epoch=114.3] | Loss=0.01911 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.468 | L2-Norm(final)=3.125 | 3652.1 samples/s | 57.1 steps/s
[Step=23350 Epoch=114.5] | Loss=0.01635 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.467 | L2-Norm(final)=3.125 | 3644.6 samples/s | 56.9 steps/s
[Step=23400 Epoch=114.7] | Loss=0.01505 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.467 | L2-Norm(final)=3.126 | 4574.6 samples/s | 71.5 steps/s
[Step=23450 Epoch=115.0] | Loss=0.01347 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.466 | L2-Norm(final)=3.127 | 1612.6 samples/s | 25.2 steps/s
[Step=23500 Epoch=115.2] | Loss=0.01205 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.466 | L2-Norm(final)=3.129 | 3715.8 samples/s | 58.1 steps/s
[Step=23550 Epoch=115.5] | Loss=0.01112 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.466 | L2-Norm(final)=3.131 | 3719.3 samples/s | 58.1 steps/s
[Step=23600 Epoch=115.7] | Loss=0.01050 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.465 | L2-Norm(final)=3.133 | 4534.5 samples/s | 70.9 steps/s
[Step=23650 Epoch=116.0] | Loss=0.00972 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.465 | L2-Norm(final)=3.135 | 1654.7 samples/s | 25.9 steps/s
[Step=23700 Epoch=116.2] | Loss=0.00923 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.465 | L2-Norm(final)=3.138 | 3714.0 samples/s | 58.0 steps/s
[Step=23750 Epoch=116.5] | Loss=0.00868 | Reg=0.00305 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.465 | L2-Norm(final)=3.140 | 3620.8 samples/s | 56.6 steps/s
[Step=23800 Epoch=116.7] | Loss=0.00842 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.464 | L2-Norm(final)=3.141 | 4265.3 samples/s | 66.6 steps/s
[Step=23850 Epoch=117.0] | Loss=0.00801 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.464 | L2-Norm(final)=3.143 | 1656.5 samples/s | 25.9 steps/s
[Step=23900 Epoch=117.2] | Loss=0.00764 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.464 | L2-Norm(final)=3.145 | 3704.3 samples/s | 57.9 steps/s
[Step=23950 Epoch=117.4] | Loss=0.00731 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.463 | L2-Norm(final)=3.146 | 3718.5 samples/s | 58.1 steps/s
[Step=24000 Epoch=117.7] | Loss=0.00722 | Reg=0.00305 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.463 | L2-Norm(final)=3.148 | 4077.7 samples/s | 63.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step24000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=219.8] | Loss=0.10570 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.490 | L2-Norm(final)=3.141 | 3582.4 samples/s | 56.0 steps/s
[Step=23250 Epoch=220.3] | Loss=0.00454 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.448 | L2-Norm(final)=3.147 | 3485.2 samples/s | 54.5 steps/s
[Step=23300 Epoch=220.8] | Loss=0.00236 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.442 | L2-Norm(final)=3.151 | 4466.3 samples/s | 69.8 steps/s
[Step=23350 Epoch=221.3] | Loss=0.00159 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.436 | L2-Norm(final)=3.153 | 1580.7 samples/s | 24.7 steps/s
[Step=23400 Epoch=221.7] | Loss=0.00120 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.431 | L2-Norm(final)=3.154 | 4208.4 samples/s | 65.8 steps/s
[Step=23450 Epoch=222.2] | Loss=0.00097 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.428 | L2-Norm(final)=3.154 | 1618.3 samples/s | 25.3 steps/s
[Step=23500 Epoch=222.7] | Loss=0.00081 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.424 | L2-Norm(final)=3.155 | 3977.7 samples/s | 62.2 steps/s
[Step=23550 Epoch=223.2] | Loss=0.00070 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.422 | L2-Norm(final)=3.155 | 1643.3 samples/s | 25.7 steps/s
[Step=23600 Epoch=223.6] | Loss=0.00062 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.419 | L2-Norm(final)=3.155 | 3715.6 samples/s | 58.1 steps/s
[Step=23650 Epoch=224.1] | Loss=0.00055 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.417 | L2-Norm(final)=3.155 | 1700.0 samples/s | 26.6 steps/s
[Step=23700 Epoch=224.6] | Loss=0.00050 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.415 | L2-Norm(final)=3.155 | 3616.8 samples/s | 56.5 steps/s
[Step=23750 Epoch=225.1] | Loss=0.00045 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.413 | L2-Norm(final)=3.155 | 1713.8 samples/s | 26.8 steps/s
[Step=23800 Epoch=225.5] | Loss=0.00042 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.411 | L2-Norm(final)=3.155 | 3548.9 samples/s | 55.5 steps/s
[Step=23850 Epoch=226.0] | Loss=0.00039 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.409 | L2-Norm(final)=3.155 | 1732.8 samples/s | 27.1 steps/s
[Step=23900 Epoch=226.5] | Loss=0.00036 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.408 | L2-Norm(final)=3.155 | 3561.1 samples/s | 55.6 steps/s
[Step=23950 Epoch=226.9] | Loss=0.00034 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.406 | L2-Norm(final)=3.155 | 1753.3 samples/s | 27.4 steps/s
[Step=24000 Epoch=227.4] | Loss=0.00032 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.405 | L2-Norm(final)=3.155 | 3480.0 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step24000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=220.7] | Loss=0.05188 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.490 | L2-Norm(final)=3.141 | 3614.1 samples/s | 56.5 steps/s
[Step=23250 Epoch=221.2] | Loss=0.00442 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.443 | L2-Norm(final)=3.146 | 3538.5 samples/s | 55.3 steps/s
[Step=23300 Epoch=221.6] | Loss=0.00242 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.440 | L2-Norm(final)=3.150 | 4448.8 samples/s | 69.5 steps/s
[Step=23350 Epoch=222.1] | Loss=0.00163 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.436 | L2-Norm(final)=3.152 | 1552.6 samples/s | 24.3 steps/s
[Step=23400 Epoch=222.6] | Loss=0.00123 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.432 | L2-Norm(final)=3.154 | 4088.9 samples/s | 63.9 steps/s
[Step=23450 Epoch=223.1] | Loss=0.00100 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.429 | L2-Norm(final)=3.154 | 1593.8 samples/s | 24.9 steps/s
[Step=23500 Epoch=223.5] | Loss=0.00084 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.426 | L2-Norm(final)=3.155 | 3911.4 samples/s | 61.1 steps/s
[Step=23550 Epoch=224.0] | Loss=0.00072 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.424 | L2-Norm(final)=3.155 | 1651.1 samples/s | 25.8 steps/s
[Step=23600 Epoch=224.5] | Loss=0.00063 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.421 | L2-Norm(final)=3.156 | 3655.0 samples/s | 57.1 steps/s
[Step=23650 Epoch=225.0] | Loss=0.00057 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.419 | L2-Norm(final)=3.156 | 1673.5 samples/s | 26.1 steps/s
[Step=23700 Epoch=225.4] | Loss=0.00051 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.417 | L2-Norm(final)=3.156 | 3651.7 samples/s | 57.1 steps/s
[Step=23750 Epoch=225.9] | Loss=0.00047 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.415 | L2-Norm(final)=3.156 | 1734.9 samples/s | 27.1 steps/s
[Step=23800 Epoch=226.4] | Loss=0.00043 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.413 | L2-Norm(final)=3.156 | 3589.5 samples/s | 56.1 steps/s
[Step=23850 Epoch=226.9] | Loss=0.00040 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.412 | L2-Norm(final)=3.156 | 1726.1 samples/s | 27.0 steps/s
[Step=23900 Epoch=227.3] | Loss=0.00037 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.410 | L2-Norm(final)=3.156 | 3546.2 samples/s | 55.4 steps/s
[Step=23950 Epoch=227.8] | Loss=0.00035 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.408 | L2-Norm(final)=3.156 | 1744.5 samples/s | 27.3 steps/s
[Step=24000 Epoch=228.3] | Loss=0.00033 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.407 | L2-Norm(final)=3.156 | 3475.6 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step24000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=221.6] | Loss=0.01609 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.490 | L2-Norm(final)=3.141 | 3891.8 samples/s | 60.8 steps/s
[Step=23250 Epoch=222.0] | Loss=0.00223 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.444 | L2-Norm(final)=3.154 | 3205.7 samples/s | 50.1 steps/s
[Step=23300 Epoch=222.5] | Loss=0.00121 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.436 | L2-Norm(final)=3.157 | 4513.5 samples/s | 70.5 steps/s
[Step=23350 Epoch=223.0] | Loss=0.00082 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.430 | L2-Norm(final)=3.158 | 1567.6 samples/s | 24.5 steps/s
[Step=23400 Epoch=223.5] | Loss=0.00062 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.426 | L2-Norm(final)=3.159 | 4134.7 samples/s | 64.6 steps/s
[Step=23450 Epoch=223.9] | Loss=0.00050 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.422 | L2-Norm(final)=3.159 | 1603.3 samples/s | 25.1 steps/s
[Step=23500 Epoch=224.4] | Loss=0.00042 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.419 | L2-Norm(final)=3.159 | 4088.1 samples/s | 63.9 steps/s
[Step=23550 Epoch=224.9] | Loss=0.00036 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.416 | L2-Norm(final)=3.159 | 1634.4 samples/s | 25.5 steps/s
[Step=23600 Epoch=225.4] | Loss=0.00032 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.414 | L2-Norm(final)=3.159 | 3810.5 samples/s | 59.5 steps/s
[Step=23650 Epoch=225.8] | Loss=0.00029 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.412 | L2-Norm(final)=3.159 | 1645.5 samples/s | 25.7 steps/s
[Step=23700 Epoch=226.3] | Loss=0.00026 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.410 | L2-Norm(final)=3.159 | 3737.6 samples/s | 58.4 steps/s
[Step=23750 Epoch=226.8] | Loss=0.00024 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.408 | L2-Norm(final)=3.159 | 1683.2 samples/s | 26.3 steps/s
[Step=23800 Epoch=227.3] | Loss=0.00022 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.406 | L2-Norm(final)=3.158 | 3545.4 samples/s | 55.4 steps/s
[Step=23850 Epoch=227.8] | Loss=0.00020 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.405 | L2-Norm(final)=3.158 | 1723.0 samples/s | 26.9 steps/s
[Step=23900 Epoch=228.2] | Loss=0.00019 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.403 | L2-Norm(final)=3.158 | 3480.2 samples/s | 54.4 steps/s
[Step=23950 Epoch=228.7] | Loss=0.00018 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.402 | L2-Norm(final)=3.158 | 1727.3 samples/s | 27.0 steps/s
[Step=24000 Epoch=229.2] | Loss=0.00017 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.400 | L2-Norm(final)=3.158 | 3515.9 samples/s | 54.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step24000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=218.6] | Loss=0.08690 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.490 | L2-Norm(final)=3.141 | 3684.6 samples/s | 57.6 steps/s
[Step=23250 Epoch=219.1] | Loss=0.00630 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.441 | L2-Norm(final)=3.135 | 3359.9 samples/s | 52.5 steps/s
[Step=23300 Epoch=219.6] | Loss=0.00347 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.436 | L2-Norm(final)=3.137 | 4318.0 samples/s | 67.5 steps/s
[Step=23350 Epoch=220.0] | Loss=0.00233 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.432 | L2-Norm(final)=3.138 | 1591.1 samples/s | 24.9 steps/s
[Step=23400 Epoch=220.5] | Loss=0.00176 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.429 | L2-Norm(final)=3.140 | 4156.8 samples/s | 65.0 steps/s
[Step=23450 Epoch=221.0] | Loss=0.00141 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.426 | L2-Norm(final)=3.141 | 1613.8 samples/s | 25.2 steps/s
[Step=23500 Epoch=221.4] | Loss=0.00118 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.424 | L2-Norm(final)=3.141 | 3806.8 samples/s | 59.5 steps/s
[Step=23550 Epoch=221.9] | Loss=0.00101 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.422 | L2-Norm(final)=3.142 | 1660.1 samples/s | 25.9 steps/s
[Step=23600 Epoch=222.4] | Loss=0.00089 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.420 | L2-Norm(final)=3.143 | 3585.7 samples/s | 56.0 steps/s
[Step=23650 Epoch=222.9] | Loss=0.00079 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.418 | L2-Norm(final)=3.143 | 1718.1 samples/s | 26.8 steps/s
[Step=23700 Epoch=223.3] | Loss=0.00072 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.416 | L2-Norm(final)=3.143 | 3575.4 samples/s | 55.9 steps/s
[Step=23750 Epoch=223.8] | Loss=0.00065 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.414 | L2-Norm(final)=3.144 | 1730.0 samples/s | 27.0 steps/s
[Step=23800 Epoch=224.3] | Loss=0.00060 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.413 | L2-Norm(final)=3.144 | 3547.5 samples/s | 55.4 steps/s
[Step=23850 Epoch=224.7] | Loss=0.00055 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.411 | L2-Norm(final)=3.144 | 1730.1 samples/s | 27.0 steps/s
[Step=23900 Epoch=225.2] | Loss=0.00052 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.410 | L2-Norm(final)=3.145 | 3471.7 samples/s | 54.2 steps/s
[Step=23950 Epoch=225.7] | Loss=0.00048 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.408 | L2-Norm(final)=3.145 | 1805.6 samples/s | 28.2 steps/s
[Step=24000 Epoch=226.1] | Loss=0.00045 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.407 | L2-Norm(final)=3.145 | 3289.8 samples/s | 51.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step24000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=221.1] | Loss=0.15018 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.490 | L2-Norm(final)=3.141 | 3706.5 samples/s | 57.9 steps/s
[Step=23250 Epoch=221.6] | Loss=0.00810 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.443 | L2-Norm(final)=3.138 | 3354.9 samples/s | 52.4 steps/s
[Step=23300 Epoch=222.1] | Loss=0.00421 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.435 | L2-Norm(final)=3.135 | 4398.5 samples/s | 68.7 steps/s
[Step=23350 Epoch=222.5] | Loss=0.00283 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.430 | L2-Norm(final)=3.136 | 1589.5 samples/s | 24.8 steps/s
[Step=23400 Epoch=223.0] | Loss=0.00213 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.426 | L2-Norm(final)=3.136 | 4254.1 samples/s | 66.5 steps/s
[Step=23450 Epoch=223.5] | Loss=0.00171 | Reg=0.00304 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.423 | L2-Norm(final)=3.136 | 1625.6 samples/s | 25.4 steps/s
[Step=23500 Epoch=224.0] | Loss=0.00143 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.420 | L2-Norm(final)=3.137 | 4052.2 samples/s | 63.3 steps/s
[Step=23550 Epoch=224.5] | Loss=0.00123 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.418 | L2-Norm(final)=3.137 | 1623.6 samples/s | 25.4 steps/s
[Step=23600 Epoch=224.9] | Loss=0.00108 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.415 | L2-Norm(final)=3.138 | 3815.2 samples/s | 59.6 steps/s
[Step=23650 Epoch=225.4] | Loss=0.00096 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.413 | L2-Norm(final)=3.138 | 1629.9 samples/s | 25.5 steps/s
[Step=23700 Epoch=225.9] | Loss=0.00086 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.411 | L2-Norm(final)=3.138 | 3664.2 samples/s | 57.3 steps/s
[Step=23750 Epoch=226.4] | Loss=0.00079 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.410 | L2-Norm(final)=3.139 | 1695.5 samples/s | 26.5 steps/s
[Step=23800 Epoch=226.8] | Loss=0.00072 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.408 | L2-Norm(final)=3.139 | 3615.4 samples/s | 56.5 steps/s
[Step=23850 Epoch=227.3] | Loss=0.00067 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.406 | L2-Norm(final)=3.140 | 1717.6 samples/s | 26.8 steps/s
[Step=23900 Epoch=227.8] | Loss=0.00062 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.405 | L2-Norm(final)=3.140 | 3593.1 samples/s | 56.1 steps/s
[Step=23950 Epoch=228.3] | Loss=0.00058 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.403 | L2-Norm(final)=3.140 | 1723.7 samples/s | 26.9 steps/s
[Step=24000 Epoch=228.7] | Loss=0.00055 | Reg=0.00303 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.402 | L2-Norm(final)=3.140 | 3502.9 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21672 | acc=0.8674 | tpr=0.8144 | fpr=0.0173 | 3762.4 samples/s | 14.7 steps/s
Avg test loss: 0.21872, Avg test acc: 0.86766, Avg tpr: 0.81541, Avg fpr: 0.01743, total FA: 136

Testing server on iccad2012
[Step=  50] | Loss=0.44762 | acc=0.8443 | tpr=0.9646 | fpr=0.1579 | 3937.0 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.45656 | acc=0.8443 | tpr=0.9638 | fpr=0.1579 | 6778.9 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.46364 | acc=0.8424 | tpr=0.9712 | fpr=0.1600 | 7320.9 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.46354 | acc=0.8431 | tpr=0.9705 | fpr=0.1592 | 7235.7 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.46241 | acc=0.8440 | tpr=0.9721 | fpr=0.1583 | 7173.2 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.46121 | acc=0.8446 | tpr=0.9687 | fpr=0.1577 | 7438.4 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.46263 | acc=0.8444 | tpr=0.9668 | fpr=0.1578 | 7043.9 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.46314 | acc=0.8445 | tpr=0.9655 | fpr=0.1577 | 7381.1 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.46672 | acc=0.8437 | tpr=0.9654 | fpr=0.1585 | 6950.6 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.46757 | acc=0.8432 | tpr=0.9665 | fpr=0.1590 | 7144.4 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.46640 | acc=0.8436 | tpr=0.9678 | fpr=0.1587 | 13734.0 samples/s | 53.6 steps/s
Avg test loss: 0.46634, Avg test acc: 0.84358, Avg tpr: 0.96791, Avg fpr: 0.15868, total FA: 22033

server round 30/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.0] | Loss=0.05263 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.407 | L2-Norm(final)=3.161 | 3889.2 samples/s | 60.8 steps/s
[Step=24050 Epoch=117.3] | Loss=0.02289 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.387 | L2-Norm(final)=3.156 | 3395.1 samples/s | 53.0 steps/s
[Step=24100 Epoch=117.5] | Loss=0.01644 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.380 | L2-Norm(final)=3.155 | 3579.0 samples/s | 55.9 steps/s
[Step=24150 Epoch=117.8] | Loss=0.01413 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.376 | L2-Norm(final)=3.156 | 3591.4 samples/s | 56.1 steps/s
[Step=24200 Epoch=118.0] | Loss=0.01252 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.373 | L2-Norm(final)=3.156 | 4554.0 samples/s | 71.2 steps/s
[Step=24250 Epoch=118.2] | Loss=0.01092 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.371 | L2-Norm(final)=3.158 | 1619.7 samples/s | 25.3 steps/s
[Step=24300 Epoch=118.5] | Loss=0.00969 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=3.159 | 3592.2 samples/s | 56.1 steps/s
[Step=24350 Epoch=118.7] | Loss=0.00908 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.369 | L2-Norm(final)=3.161 | 3583.0 samples/s | 56.0 steps/s
[Step=24400 Epoch=119.0] | Loss=0.00850 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.368 | L2-Norm(final)=3.163 | 4225.7 samples/s | 66.0 steps/s
[Step=24450 Epoch=119.2] | Loss=0.00808 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.367 | L2-Norm(final)=3.164 | 1661.9 samples/s | 26.0 steps/s
[Step=24500 Epoch=119.5] | Loss=0.00758 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.367 | L2-Norm(final)=3.166 | 3714.3 samples/s | 58.0 steps/s
[Step=24550 Epoch=119.7] | Loss=0.00724 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.366 | L2-Norm(final)=3.167 | 3703.9 samples/s | 57.9 steps/s
[Step=24600 Epoch=120.0] | Loss=0.00691 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.366 | L2-Norm(final)=3.169 | 4191.8 samples/s | 65.5 steps/s
[Step=24650 Epoch=120.2] | Loss=0.00668 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.366 | L2-Norm(final)=3.170 | 1690.4 samples/s | 26.4 steps/s
[Step=24700 Epoch=120.4] | Loss=0.00647 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.366 | L2-Norm(final)=3.172 | 3729.1 samples/s | 58.3 steps/s
[Step=24750 Epoch=120.7] | Loss=0.00618 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.365 | L2-Norm(final)=3.173 | 3725.1 samples/s | 58.2 steps/s
[Step=24800 Epoch=120.9] | Loss=0.00599 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.365 | L2-Norm(final)=3.175 | 3966.9 samples/s | 62.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step24800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.1] | Loss=0.04322 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.407 | L2-Norm(final)=3.161 | 3668.1 samples/s | 57.3 steps/s
[Step=24050 Epoch=117.4] | Loss=0.02254 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.390 | L2-Norm(final)=3.154 | 3596.7 samples/s | 56.2 steps/s
[Step=24100 Epoch=117.6] | Loss=0.01592 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.383 | L2-Norm(final)=3.155 | 3661.6 samples/s | 57.2 steps/s
[Step=24150 Epoch=117.8] | Loss=0.01297 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.379 | L2-Norm(final)=3.156 | 3627.4 samples/s | 56.7 steps/s
[Step=24200 Epoch=118.1] | Loss=0.01120 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.377 | L2-Norm(final)=3.158 | 4467.8 samples/s | 69.8 steps/s
[Step=24250 Epoch=118.3] | Loss=0.00959 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.375 | L2-Norm(final)=3.160 | 1613.1 samples/s | 25.2 steps/s
[Step=24300 Epoch=118.6] | Loss=0.00866 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.374 | L2-Norm(final)=3.162 | 3727.9 samples/s | 58.2 steps/s
[Step=24350 Epoch=118.8] | Loss=0.00803 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.374 | L2-Norm(final)=3.164 | 3646.7 samples/s | 57.0 steps/s
[Step=24400 Epoch=119.1] | Loss=0.00747 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.373 | L2-Norm(final)=3.166 | 4318.4 samples/s | 67.5 steps/s
[Step=24450 Epoch=119.3] | Loss=0.00695 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.372 | L2-Norm(final)=3.167 | 1625.3 samples/s | 25.4 steps/s
[Step=24500 Epoch=119.5] | Loss=0.00659 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.372 | L2-Norm(final)=3.169 | 3719.3 samples/s | 58.1 steps/s
[Step=24550 Epoch=119.8] | Loss=0.00625 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.371 | L2-Norm(final)=3.171 | 3724.4 samples/s | 58.2 steps/s
[Step=24600 Epoch=120.0] | Loss=0.00595 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.371 | L2-Norm(final)=3.172 | 4252.1 samples/s | 66.4 steps/s
[Step=24650 Epoch=120.3] | Loss=0.00573 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=3.174 | 1678.3 samples/s | 26.2 steps/s
[Step=24700 Epoch=120.5] | Loss=0.00552 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.370 | L2-Norm(final)=3.175 | 3636.8 samples/s | 56.8 steps/s
[Step=24750 Epoch=120.8] | Loss=0.00540 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=3.177 | 3652.5 samples/s | 57.1 steps/s
[Step=24800 Epoch=121.0] | Loss=0.00526 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.369 | L2-Norm(final)=3.178 | 3991.5 samples/s | 62.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step24800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=116.9] | Loss=0.06304 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.407 | L2-Norm(final)=3.161 | 3824.0 samples/s | 59.7 steps/s
[Step=24050 Epoch=117.2] | Loss=0.02616 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.385 | L2-Norm(final)=3.153 | 3481.1 samples/s | 54.4 steps/s
[Step=24100 Epoch=117.4] | Loss=0.01789 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.378 | L2-Norm(final)=3.153 | 3644.0 samples/s | 56.9 steps/s
[Step=24150 Epoch=117.7] | Loss=0.01419 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.375 | L2-Norm(final)=3.155 | 3658.3 samples/s | 57.2 steps/s
[Step=24200 Epoch=117.9] | Loss=0.01202 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.373 | L2-Norm(final)=3.157 | 4499.5 samples/s | 70.3 steps/s
[Step=24250 Epoch=118.2] | Loss=0.01072 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.372 | L2-Norm(final)=3.160 | 1617.0 samples/s | 25.3 steps/s
[Step=24300 Epoch=118.4] | Loss=0.00958 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.372 | L2-Norm(final)=3.162 | 3707.7 samples/s | 57.9 steps/s
[Step=24350 Epoch=118.6] | Loss=0.00875 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.371 | L2-Norm(final)=3.164 | 3727.8 samples/s | 58.2 steps/s
[Step=24400 Epoch=118.9] | Loss=0.00819 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.371 | L2-Norm(final)=3.167 | 4402.6 samples/s | 68.8 steps/s
[Step=24450 Epoch=119.1] | Loss=0.00767 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=3.169 | 1644.6 samples/s | 25.7 steps/s
[Step=24500 Epoch=119.4] | Loss=0.00724 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=3.171 | 3663.0 samples/s | 57.2 steps/s
[Step=24550 Epoch=119.6] | Loss=0.00688 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=3.173 | 3662.6 samples/s | 57.2 steps/s
[Step=24600 Epoch=119.9] | Loss=0.00662 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.370 | L2-Norm(final)=3.175 | 4067.9 samples/s | 63.6 steps/s
[Step=24650 Epoch=120.1] | Loss=0.00633 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=3.177 | 1687.4 samples/s | 26.4 steps/s
[Step=24700 Epoch=120.4] | Loss=0.00606 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.369 | L2-Norm(final)=3.179 | 3612.2 samples/s | 56.4 steps/s
[Step=24750 Epoch=120.6] | Loss=0.00583 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.369 | L2-Norm(final)=3.180 | 3588.6 samples/s | 56.1 steps/s
[Step=24800 Epoch=120.8] | Loss=0.00562 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.369 | L2-Norm(final)=3.182 | 3811.8 samples/s | 59.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step24800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.0] | Loss=0.07333 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.407 | L2-Norm(final)=3.161 | 3808.1 samples/s | 59.5 steps/s
[Step=24050 Epoch=117.3] | Loss=0.02005 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.388 | L2-Norm(final)=3.156 | 3537.5 samples/s | 55.3 steps/s
[Step=24100 Epoch=117.5] | Loss=0.01577 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.382 | L2-Norm(final)=3.156 | 3630.7 samples/s | 56.7 steps/s
[Step=24150 Epoch=117.8] | Loss=0.01255 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.379 | L2-Norm(final)=3.158 | 3575.7 samples/s | 55.9 steps/s
[Step=24200 Epoch=118.0] | Loss=0.01125 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.377 | L2-Norm(final)=3.160 | 4461.1 samples/s | 69.7 steps/s
[Step=24250 Epoch=118.3] | Loss=0.00990 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.375 | L2-Norm(final)=3.161 | 1601.9 samples/s | 25.0 steps/s
[Step=24300 Epoch=118.5] | Loss=0.00876 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.375 | L2-Norm(final)=3.163 | 3636.2 samples/s | 56.8 steps/s
[Step=24350 Epoch=118.7] | Loss=0.00801 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.374 | L2-Norm(final)=3.166 | 3595.5 samples/s | 56.2 steps/s
[Step=24400 Epoch=119.0] | Loss=0.00750 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.374 | L2-Norm(final)=3.168 | 4223.3 samples/s | 66.0 steps/s
[Step=24450 Epoch=119.2] | Loss=0.00737 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.373 | L2-Norm(final)=3.170 | 1627.2 samples/s | 25.4 steps/s
[Step=24500 Epoch=119.5] | Loss=0.00689 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.373 | L2-Norm(final)=3.171 | 3646.5 samples/s | 57.0 steps/s
[Step=24550 Epoch=119.7] | Loss=0.00647 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.372 | L2-Norm(final)=3.173 | 3635.4 samples/s | 56.8 steps/s
[Step=24600 Epoch=120.0] | Loss=0.00627 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.372 | L2-Norm(final)=3.175 | 4030.9 samples/s | 63.0 steps/s
[Step=24650 Epoch=120.2] | Loss=0.00601 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.372 | L2-Norm(final)=3.176 | 1698.0 samples/s | 26.5 steps/s
[Step=24700 Epoch=120.5] | Loss=0.00578 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.371 | L2-Norm(final)=3.178 | 3726.6 samples/s | 58.2 steps/s
[Step=24750 Epoch=120.7] | Loss=0.00554 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.371 | L2-Norm(final)=3.180 | 3722.2 samples/s | 58.2 steps/s
[Step=24800 Epoch=120.9] | Loss=0.00533 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.371 | L2-Norm(final)=3.181 | 3983.0 samples/s | 62.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step24800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.7] | Loss=0.08157 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.407 | L2-Norm(final)=3.161 | 3667.8 samples/s | 57.3 steps/s
[Step=24050 Epoch=117.9] | Loss=0.02005 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.387 | L2-Norm(final)=3.158 | 3660.8 samples/s | 57.2 steps/s
[Step=24100 Epoch=118.2] | Loss=0.01631 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.381 | L2-Norm(final)=3.158 | 3738.3 samples/s | 58.4 steps/s
[Step=24150 Epoch=118.4] | Loss=0.01389 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.377 | L2-Norm(final)=3.159 | 3653.8 samples/s | 57.1 steps/s
[Step=24200 Epoch=118.7] | Loss=0.01187 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.375 | L2-Norm(final)=3.161 | 4556.2 samples/s | 71.2 steps/s
[Step=24250 Epoch=118.9] | Loss=0.01022 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.374 | L2-Norm(final)=3.163 | 1627.0 samples/s | 25.4 steps/s
[Step=24300 Epoch=119.2] | Loss=0.00915 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.373 | L2-Norm(final)=3.165 | 3705.6 samples/s | 57.9 steps/s
[Step=24350 Epoch=119.4] | Loss=0.00845 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.372 | L2-Norm(final)=3.167 | 3659.8 samples/s | 57.2 steps/s
[Step=24400 Epoch=119.7] | Loss=0.00779 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.371 | L2-Norm(final)=3.169 | 4430.9 samples/s | 69.2 steps/s
[Step=24450 Epoch=119.9] | Loss=0.00722 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.371 | L2-Norm(final)=3.171 | 1622.2 samples/s | 25.3 steps/s
[Step=24500 Epoch=120.1] | Loss=0.00686 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.371 | L2-Norm(final)=3.173 | 3591.3 samples/s | 56.1 steps/s
[Step=24550 Epoch=120.4] | Loss=0.00650 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=3.175 | 3574.8 samples/s | 55.9 steps/s
[Step=24600 Epoch=120.6] | Loss=0.00621 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.370 | L2-Norm(final)=3.177 | 4203.2 samples/s | 65.7 steps/s
[Step=24650 Epoch=120.9] | Loss=0.00585 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=3.179 | 1671.0 samples/s | 26.1 steps/s
[Step=24700 Epoch=121.1] | Loss=0.00555 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=3.181 | 3725.7 samples/s | 58.2 steps/s
[Step=24750 Epoch=121.4] | Loss=0.00543 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=3.183 | 3717.1 samples/s | 58.1 steps/s
[Step=24800 Epoch=121.6] | Loss=0.00529 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=3.185 | 4211.8 samples/s | 65.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step24800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=227.4] | Loss=0.06691 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.407 | L2-Norm(final)=3.161 | 3552.0 samples/s | 55.5 steps/s
[Step=24050 Epoch=227.9] | Loss=0.00485 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.362 | L2-Norm(final)=3.166 | 3489.2 samples/s | 54.5 steps/s
[Step=24100 Epoch=228.4] | Loss=0.00249 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.354 | L2-Norm(final)=3.167 | 4370.6 samples/s | 68.3 steps/s
[Step=24150 Epoch=228.8] | Loss=0.00168 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.348 | L2-Norm(final)=3.168 | 1564.4 samples/s | 24.4 steps/s
[Step=24200 Epoch=229.3] | Loss=0.00127 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.345 | L2-Norm(final)=3.168 | 4136.8 samples/s | 64.6 steps/s
[Step=24250 Epoch=229.8] | Loss=0.00103 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.341 | L2-Norm(final)=3.169 | 1597.2 samples/s | 25.0 steps/s
[Step=24300 Epoch=230.3] | Loss=0.00086 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.339 | L2-Norm(final)=3.169 | 3881.3 samples/s | 60.6 steps/s
[Step=24350 Epoch=230.7] | Loss=0.00074 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.337 | L2-Norm(final)=3.169 | 1650.9 samples/s | 25.8 steps/s
[Step=24400 Epoch=231.2] | Loss=0.00065 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.335 | L2-Norm(final)=3.170 | 3767.8 samples/s | 58.9 steps/s
[Step=24450 Epoch=231.7] | Loss=0.00059 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.333 | L2-Norm(final)=3.170 | 1677.0 samples/s | 26.2 steps/s
[Step=24500 Epoch=232.2] | Loss=0.00053 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.331 | L2-Norm(final)=3.170 | 3536.9 samples/s | 55.3 steps/s
[Step=24550 Epoch=232.6] | Loss=0.00049 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.330 | L2-Norm(final)=3.170 | 1717.5 samples/s | 26.8 steps/s
[Step=24600 Epoch=233.1] | Loss=0.00045 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.328 | L2-Norm(final)=3.171 | 3545.9 samples/s | 55.4 steps/s
[Step=24650 Epoch=233.6] | Loss=0.00041 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.327 | L2-Norm(final)=3.171 | 1546.9 samples/s | 24.2 steps/s
[Step=24700 Epoch=234.1] | Loss=0.00039 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.326 | L2-Norm(final)=3.171 | 3069.8 samples/s | 48.0 steps/s
[Step=24750 Epoch=234.5] | Loss=0.00036 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.325 | L2-Norm(final)=3.171 | 1673.5 samples/s | 26.1 steps/s
[Step=24800 Epoch=235.0] | Loss=0.00034 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.324 | L2-Norm(final)=3.171 | 3267.2 samples/s | 51.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step24800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=228.3] | Loss=0.01749 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.407 | L2-Norm(final)=3.161 | 3553.4 samples/s | 55.5 steps/s
[Step=24050 Epoch=228.8] | Loss=0.00408 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.367 | L2-Norm(final)=3.169 | 3376.8 samples/s | 52.8 steps/s
[Step=24100 Epoch=229.3] | Loss=0.00212 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.360 | L2-Norm(final)=3.170 | 4338.0 samples/s | 67.8 steps/s
[Step=24150 Epoch=229.7] | Loss=0.00143 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.355 | L2-Norm(final)=3.171 | 1544.1 samples/s | 24.1 steps/s
[Step=24200 Epoch=230.2] | Loss=0.00109 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.351 | L2-Norm(final)=3.172 | 4047.2 samples/s | 63.2 steps/s
[Step=24250 Epoch=230.7] | Loss=0.00088 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.348 | L2-Norm(final)=3.172 | 1574.0 samples/s | 24.6 steps/s
[Step=24300 Epoch=231.2] | Loss=0.00074 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.345 | L2-Norm(final)=3.172 | 3979.8 samples/s | 62.2 steps/s
[Step=24350 Epoch=231.6] | Loss=0.00064 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.342 | L2-Norm(final)=3.172 | 1611.8 samples/s | 25.2 steps/s
[Step=24400 Epoch=232.1] | Loss=0.00056 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.340 | L2-Norm(final)=3.173 | 3597.0 samples/s | 56.2 steps/s
[Step=24450 Epoch=232.6] | Loss=0.00050 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.338 | L2-Norm(final)=3.173 | 1642.9 samples/s | 25.7 steps/s
[Step=24500 Epoch=233.1] | Loss=0.00046 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.336 | L2-Norm(final)=3.173 | 3499.1 samples/s | 54.7 steps/s
[Step=24550 Epoch=233.5] | Loss=0.00042 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.335 | L2-Norm(final)=3.173 | 1717.0 samples/s | 26.8 steps/s
[Step=24600 Epoch=234.0] | Loss=0.00038 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.333 | L2-Norm(final)=3.173 | 3522.0 samples/s | 55.0 steps/s
[Step=24650 Epoch=234.5] | Loss=0.00036 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.332 | L2-Norm(final)=3.173 | 1714.4 samples/s | 26.8 steps/s
[Step=24700 Epoch=235.0] | Loss=0.00033 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.330 | L2-Norm(final)=3.173 | 3409.1 samples/s | 53.3 steps/s
[Step=24750 Epoch=235.4] | Loss=0.00031 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.329 | L2-Norm(final)=3.173 | 1634.1 samples/s | 25.5 steps/s
[Step=24800 Epoch=235.9] | Loss=0.00030 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.328 | L2-Norm(final)=3.173 | 3037.4 samples/s | 47.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step24800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=229.2] | Loss=0.00611 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.407 | L2-Norm(final)=3.161 | 3563.0 samples/s | 55.7 steps/s
[Step=24050 Epoch=229.7] | Loss=0.00688 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.363 | L2-Norm(final)=3.165 | 3313.8 samples/s | 51.8 steps/s
[Step=24100 Epoch=230.1] | Loss=0.00356 | Reg=0.00301 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.356 | L2-Norm(final)=3.166 | 4421.1 samples/s | 69.1 steps/s
[Step=24150 Epoch=230.6] | Loss=0.00240 | Reg=0.00301 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.351 | L2-Norm(final)=3.167 | 1565.8 samples/s | 24.5 steps/s
[Step=24200 Epoch=231.1] | Loss=0.00181 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.347 | L2-Norm(final)=3.167 | 4293.8 samples/s | 67.1 steps/s
[Step=24250 Epoch=231.6] | Loss=0.00145 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.344 | L2-Norm(final)=3.168 | 1615.6 samples/s | 25.2 steps/s
[Step=24300 Epoch=232.1] | Loss=0.00122 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.342 | L2-Norm(final)=3.168 | 4086.8 samples/s | 63.9 steps/s
[Step=24350 Epoch=232.5] | Loss=0.00105 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.340 | L2-Norm(final)=3.168 | 1641.0 samples/s | 25.6 steps/s
[Step=24400 Epoch=233.0] | Loss=0.00092 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.338 | L2-Norm(final)=3.168 | 3905.2 samples/s | 61.0 steps/s
[Step=24450 Epoch=233.5] | Loss=0.00082 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.336 | L2-Norm(final)=3.169 | 1639.6 samples/s | 25.6 steps/s
[Step=24500 Epoch=234.0] | Loss=0.00074 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.335 | L2-Norm(final)=3.169 | 3564.4 samples/s | 55.7 steps/s
[Step=24550 Epoch=234.4] | Loss=0.00068 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.333 | L2-Norm(final)=3.169 | 1709.6 samples/s | 26.7 steps/s
[Step=24600 Epoch=234.9] | Loss=0.00062 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.332 | L2-Norm(final)=3.169 | 3530.3 samples/s | 55.2 steps/s
[Step=24650 Epoch=235.4] | Loss=0.00058 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.331 | L2-Norm(final)=3.169 | 1694.6 samples/s | 26.5 steps/s
[Step=24700 Epoch=235.9] | Loss=0.00054 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.329 | L2-Norm(final)=3.169 | 3444.3 samples/s | 53.8 steps/s
[Step=24750 Epoch=236.3] | Loss=0.00050 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.328 | L2-Norm(final)=3.169 | 1707.1 samples/s | 26.7 steps/s
[Step=24800 Epoch=236.8] | Loss=0.00047 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.327 | L2-Norm(final)=3.169 | 3509.7 samples/s | 54.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step24800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=226.2] | Loss=0.13277 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.407 | L2-Norm(final)=3.161 | 3697.2 samples/s | 57.8 steps/s
[Step=24050 Epoch=226.6] | Loss=0.00676 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.363 | L2-Norm(final)=3.164 | 3418.8 samples/s | 53.4 steps/s
[Step=24100 Epoch=227.1] | Loss=0.00348 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.355 | L2-Norm(final)=3.165 | 4430.3 samples/s | 69.2 steps/s
[Step=24150 Epoch=227.6] | Loss=0.00234 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.350 | L2-Norm(final)=3.166 | 1590.1 samples/s | 24.8 steps/s
[Step=24200 Epoch=228.0] | Loss=0.00177 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.346 | L2-Norm(final)=3.166 | 4150.0 samples/s | 64.8 steps/s
[Step=24250 Epoch=228.5] | Loss=0.00143 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.343 | L2-Norm(final)=3.167 | 1628.2 samples/s | 25.4 steps/s
[Step=24300 Epoch=229.0] | Loss=0.00120 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.341 | L2-Norm(final)=3.167 | 3819.0 samples/s | 59.7 steps/s
[Step=24350 Epoch=229.4] | Loss=0.00103 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.339 | L2-Norm(final)=3.167 | 1679.8 samples/s | 26.2 steps/s
[Step=24400 Epoch=229.9] | Loss=0.00091 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.337 | L2-Norm(final)=3.168 | 3675.0 samples/s | 57.4 steps/s
[Step=24450 Epoch=230.4] | Loss=0.00081 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.335 | L2-Norm(final)=3.168 | 1704.3 samples/s | 26.6 steps/s
[Step=24500 Epoch=230.9] | Loss=0.00073 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.334 | L2-Norm(final)=3.168 | 3587.1 samples/s | 56.0 steps/s
[Step=24550 Epoch=231.3] | Loss=0.00067 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.332 | L2-Norm(final)=3.168 | 1740.7 samples/s | 27.2 steps/s
[Step=24600 Epoch=231.8] | Loss=0.00062 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.331 | L2-Norm(final)=3.169 | 3450.6 samples/s | 53.9 steps/s
[Step=24650 Epoch=232.3] | Loss=0.00057 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.330 | L2-Norm(final)=3.169 | 1710.0 samples/s | 26.7 steps/s
[Step=24700 Epoch=232.7] | Loss=0.00053 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.329 | L2-Norm(final)=3.169 | 3602.3 samples/s | 56.3 steps/s
[Step=24750 Epoch=233.2] | Loss=0.00050 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.328 | L2-Norm(final)=3.169 | 1806.3 samples/s | 28.2 steps/s
[Step=24800 Epoch=233.7] | Loss=0.00047 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.327 | L2-Norm(final)=3.169 | 3231.5 samples/s | 50.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step24800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=228.8] | Loss=0.12749 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.407 | L2-Norm(final)=3.161 | 3805.3 samples/s | 59.5 steps/s
[Step=24050 Epoch=229.2] | Loss=0.00870 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.366 | L2-Norm(final)=3.164 | 3209.1 samples/s | 50.1 steps/s
[Step=24100 Epoch=229.7] | Loss=0.00445 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.359 | L2-Norm(final)=3.165 | 4337.6 samples/s | 67.8 steps/s
[Step=24150 Epoch=230.2] | Loss=0.00299 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.353 | L2-Norm(final)=3.166 | 1570.3 samples/s | 24.5 steps/s
[Step=24200 Epoch=230.6] | Loss=0.00227 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.349 | L2-Norm(final)=3.166 | 4269.6 samples/s | 66.7 steps/s
[Step=24250 Epoch=231.1] | Loss=0.00182 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.346 | L2-Norm(final)=3.167 | 1623.4 samples/s | 25.4 steps/s
[Step=24300 Epoch=231.6] | Loss=0.00153 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.343 | L2-Norm(final)=3.167 | 4083.7 samples/s | 63.8 steps/s
[Step=24350 Epoch=232.1] | Loss=0.00132 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.341 | L2-Norm(final)=3.168 | 1628.0 samples/s | 25.4 steps/s
[Step=24400 Epoch=232.6] | Loss=0.00116 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.339 | L2-Norm(final)=3.168 | 3902.1 samples/s | 61.0 steps/s
[Step=24450 Epoch=233.0] | Loss=0.00103 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.337 | L2-Norm(final)=3.168 | 1684.0 samples/s | 26.3 steps/s
[Step=24500 Epoch=233.5] | Loss=0.00093 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.335 | L2-Norm(final)=3.168 | 3731.3 samples/s | 58.3 steps/s
[Step=24550 Epoch=234.0] | Loss=0.00085 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.334 | L2-Norm(final)=3.169 | 1705.3 samples/s | 26.6 steps/s
[Step=24600 Epoch=234.5] | Loss=0.00078 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.332 | L2-Norm(final)=3.169 | 3553.6 samples/s | 55.5 steps/s
[Step=24650 Epoch=234.9] | Loss=0.00072 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.331 | L2-Norm(final)=3.169 | 1705.8 samples/s | 26.7 steps/s
[Step=24700 Epoch=235.4] | Loss=0.00067 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.330 | L2-Norm(final)=3.169 | 3487.3 samples/s | 54.5 steps/s
[Step=24750 Epoch=235.9] | Loss=0.00063 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.329 | L2-Norm(final)=3.169 | 1727.3 samples/s | 27.0 steps/s
[Step=24800 Epoch=236.4] | Loss=0.00059 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.328 | L2-Norm(final)=3.170 | 3466.8 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24012 | acc=0.8612 | tpr=0.8049 | fpr=0.0166 | 3815.4 samples/s | 14.9 steps/s
Avg test loss: 0.24153, Avg test acc: 0.86105, Avg tpr: 0.80515, Avg fpr: 0.01602, total FA: 125

Testing server on iccad2012
[Step=  50] | Loss=0.41645 | acc=0.8604 | tpr=0.9602 | fpr=0.1414 | 3846.6 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.42610 | acc=0.8596 | tpr=0.9616 | fpr=0.1423 | 7221.1 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.43270 | acc=0.8580 | tpr=0.9697 | fpr=0.1440 | 7271.8 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.43285 | acc=0.8591 | tpr=0.9683 | fpr=0.1429 | 7277.6 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.43178 | acc=0.8596 | tpr=0.9703 | fpr=0.1424 | 7128.8 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.43071 | acc=0.8603 | tpr=0.9665 | fpr=0.1417 | 7265.8 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.43226 | acc=0.8602 | tpr=0.9649 | fpr=0.1417 | 7222.5 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.43292 | acc=0.8602 | tpr=0.9628 | fpr=0.1417 | 7170.6 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.43665 | acc=0.8594 | tpr=0.9630 | fpr=0.1424 | 7425.5 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.43739 | acc=0.8591 | tpr=0.9643 | fpr=0.1428 | 7121.6 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.43630 | acc=0.8595 | tpr=0.9658 | fpr=0.1425 | 12444.5 samples/s | 48.6 steps/s
Avg test loss: 0.43618, Avg test acc: 0.85946, Avg tpr: 0.96593, Avg fpr: 0.14248, total FA: 19783

server round 31/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=120.9] | Loss=0.16195 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.332 | L2-Norm(final)=3.188 | 3776.7 samples/s | 59.0 steps/s
[Step=24850 Epoch=121.2] | Loss=0.02589 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.313 | L2-Norm(final)=3.182 | 3547.4 samples/s | 55.4 steps/s
[Step=24900 Epoch=121.4] | Loss=0.01781 | Reg=0.00299 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.304 | L2-Norm(final)=3.181 | 3639.6 samples/s | 56.9 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01416 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.300 | L2-Norm(final)=3.181 | 3646.1 samples/s | 57.0 steps/s
[Step=25000 Epoch=121.9] | Loss=0.01213 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.297 | L2-Norm(final)=3.182 | 4504.6 samples/s | 70.4 steps/s
[Step=25050 Epoch=122.1] | Loss=0.01055 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.296 | L2-Norm(final)=3.184 | 1638.9 samples/s | 25.6 steps/s
[Step=25100 Epoch=122.4] | Loss=0.00976 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.295 | L2-Norm(final)=3.186 | 3720.5 samples/s | 58.1 steps/s
[Step=25150 Epoch=122.6] | Loss=0.00888 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.294 | L2-Norm(final)=3.187 | 3659.2 samples/s | 57.2 steps/s
[Step=25200 Epoch=122.9] | Loss=0.00839 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.293 | L2-Norm(final)=3.189 | 4307.5 samples/s | 67.3 steps/s
[Step=25250 Epoch=123.1] | Loss=0.00776 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.293 | L2-Norm(final)=3.191 | 1650.2 samples/s | 25.8 steps/s
[Step=25300 Epoch=123.4] | Loss=0.00725 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.292 | L2-Norm(final)=3.193 | 3648.8 samples/s | 57.0 steps/s
[Step=25350 Epoch=123.6] | Loss=0.00696 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.292 | L2-Norm(final)=3.194 | 3654.1 samples/s | 57.1 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00674 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.292 | L2-Norm(final)=3.196 | 4183.7 samples/s | 65.4 steps/s
[Step=25450 Epoch=124.1] | Loss=0.00646 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.292 | L2-Norm(final)=3.198 | 1685.1 samples/s | 26.3 steps/s
[Step=25500 Epoch=124.3] | Loss=0.00622 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.291 | L2-Norm(final)=3.199 | 3639.5 samples/s | 56.9 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00603 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.291 | L2-Norm(final)=3.201 | 3654.8 samples/s | 57.1 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00586 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.291 | L2-Norm(final)=3.202 | 3882.2 samples/s | 60.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step25600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=121.0] | Loss=0.25881 | Reg=0.00300 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=17.332 | L2-Norm(final)=3.188 | 3921.6 samples/s | 61.3 steps/s
[Step=24850 Epoch=121.3] | Loss=0.02347 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.314 | L2-Norm(final)=3.182 | 3506.5 samples/s | 54.8 steps/s
[Step=24900 Epoch=121.5] | Loss=0.01623 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.308 | L2-Norm(final)=3.182 | 3628.1 samples/s | 56.7 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01279 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.304 | L2-Norm(final)=3.183 | 3663.0 samples/s | 57.2 steps/s
[Step=25000 Epoch=122.0] | Loss=0.01124 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.302 | L2-Norm(final)=3.184 | 4547.4 samples/s | 71.1 steps/s
[Step=25050 Epoch=122.2] | Loss=0.00993 | Reg=0.00299 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.301 | L2-Norm(final)=3.185 | 1584.7 samples/s | 24.8 steps/s
[Step=25100 Epoch=122.5] | Loss=0.00886 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.299 | L2-Norm(final)=3.187 | 3566.5 samples/s | 55.7 steps/s
[Step=25150 Epoch=122.7] | Loss=0.00802 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.298 | L2-Norm(final)=3.189 | 3527.6 samples/s | 55.1 steps/s
[Step=25200 Epoch=123.0] | Loss=0.00745 | Reg=0.00299 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.298 | L2-Norm(final)=3.191 | 4295.2 samples/s | 67.1 steps/s
[Step=25250 Epoch=123.2] | Loss=0.00695 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.297 | L2-Norm(final)=3.192 | 1656.0 samples/s | 25.9 steps/s
[Step=25300 Epoch=123.5] | Loss=0.00656 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.297 | L2-Norm(final)=3.194 | 3721.8 samples/s | 58.2 steps/s
[Step=25350 Epoch=123.7] | Loss=0.00621 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.296 | L2-Norm(final)=3.195 | 3708.3 samples/s | 57.9 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00597 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.295 | L2-Norm(final)=3.196 | 4266.8 samples/s | 66.7 steps/s
[Step=25450 Epoch=124.2] | Loss=0.00572 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.295 | L2-Norm(final)=3.198 | 1688.9 samples/s | 26.4 steps/s
[Step=25500 Epoch=124.4] | Loss=0.00565 | Reg=0.00299 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.295 | L2-Norm(final)=3.199 | 3635.1 samples/s | 56.8 steps/s
[Step=25550 Epoch=124.7] | Loss=0.00551 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.294 | L2-Norm(final)=3.200 | 3632.9 samples/s | 56.8 steps/s
[Step=25600 Epoch=124.9] | Loss=0.00531 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.294 | L2-Norm(final)=3.201 | 3939.3 samples/s | 61.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step25600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=120.8] | Loss=0.24051 | Reg=0.00300 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=17.332 | L2-Norm(final)=3.188 | 3869.7 samples/s | 60.5 steps/s
[Step=24850 Epoch=121.1] | Loss=0.01956 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.312 | L2-Norm(final)=3.187 | 3374.2 samples/s | 52.7 steps/s
[Step=24900 Epoch=121.3] | Loss=0.01432 | Reg=0.00299 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.306 | L2-Norm(final)=3.187 | 3639.2 samples/s | 56.9 steps/s
[Step=24950 Epoch=121.6] | Loss=0.01239 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.303 | L2-Norm(final)=3.188 | 3637.5 samples/s | 56.8 steps/s
[Step=25000 Epoch=121.8] | Loss=0.01094 | Reg=0.00299 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.302 | L2-Norm(final)=3.189 | 4522.2 samples/s | 70.7 steps/s
[Step=25050 Epoch=122.1] | Loss=0.00983 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.301 | L2-Norm(final)=3.191 | 1637.9 samples/s | 25.6 steps/s
[Step=25100 Epoch=122.3] | Loss=0.00892 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.300 | L2-Norm(final)=3.193 | 3738.0 samples/s | 58.4 steps/s
[Step=25150 Epoch=122.5] | Loss=0.00831 | Reg=0.00299 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.299 | L2-Norm(final)=3.195 | 3726.4 samples/s | 58.2 steps/s
[Step=25200 Epoch=122.8] | Loss=0.00770 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.299 | L2-Norm(final)=3.197 | 4372.9 samples/s | 68.3 steps/s
[Step=25250 Epoch=123.0] | Loss=0.00716 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.298 | L2-Norm(final)=3.199 | 1670.8 samples/s | 26.1 steps/s
[Step=25300 Epoch=123.3] | Loss=0.00676 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.298 | L2-Norm(final)=3.201 | 3633.3 samples/s | 56.8 steps/s
[Step=25350 Epoch=123.5] | Loss=0.00645 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.298 | L2-Norm(final)=3.202 | 3662.1 samples/s | 57.2 steps/s
[Step=25400 Epoch=123.8] | Loss=0.00625 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.297 | L2-Norm(final)=3.204 | 4074.2 samples/s | 63.7 steps/s
[Step=25450 Epoch=124.0] | Loss=0.00605 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.297 | L2-Norm(final)=3.206 | 1681.5 samples/s | 26.3 steps/s
[Step=25500 Epoch=124.2] | Loss=0.00579 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.297 | L2-Norm(final)=3.207 | 3730.6 samples/s | 58.3 steps/s
[Step=25550 Epoch=124.5] | Loss=0.00565 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.297 | L2-Norm(final)=3.209 | 3745.6 samples/s | 58.5 steps/s
[Step=25600 Epoch=124.7] | Loss=0.00542 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.297 | L2-Norm(final)=3.210 | 3960.4 samples/s | 61.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step25600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=120.9] | Loss=0.14462 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.332 | L2-Norm(final)=3.188 | 3785.5 samples/s | 59.1 steps/s
[Step=24850 Epoch=121.2] | Loss=0.01846 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.313 | L2-Norm(final)=3.184 | 3384.4 samples/s | 52.9 steps/s
[Step=24900 Epoch=121.4] | Loss=0.01303 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.307 | L2-Norm(final)=3.185 | 3673.8 samples/s | 57.4 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01068 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.304 | L2-Norm(final)=3.187 | 3741.0 samples/s | 58.5 steps/s
[Step=25000 Epoch=121.9] | Loss=0.00965 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.303 | L2-Norm(final)=3.190 | 4510.5 samples/s | 70.5 steps/s
[Step=25050 Epoch=122.2] | Loss=0.00850 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.302 | L2-Norm(final)=3.192 | 1607.8 samples/s | 25.1 steps/s
[Step=25100 Epoch=122.4] | Loss=0.00774 | Reg=0.00299 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.301 | L2-Norm(final)=3.194 | 3647.6 samples/s | 57.0 steps/s
[Step=25150 Epoch=122.6] | Loss=0.00717 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.301 | L2-Norm(final)=3.196 | 3632.2 samples/s | 56.8 steps/s
[Step=25200 Epoch=122.9] | Loss=0.00673 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.300 | L2-Norm(final)=3.198 | 4304.0 samples/s | 67.2 steps/s
[Step=25250 Epoch=123.1] | Loss=0.00639 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.300 | L2-Norm(final)=3.200 | 1631.2 samples/s | 25.5 steps/s
[Step=25300 Epoch=123.4] | Loss=0.00609 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.299 | L2-Norm(final)=3.202 | 3584.9 samples/s | 56.0 steps/s
[Step=25350 Epoch=123.6] | Loss=0.00585 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.299 | L2-Norm(final)=3.204 | 3572.4 samples/s | 55.8 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00563 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.299 | L2-Norm(final)=3.206 | 4055.3 samples/s | 63.4 steps/s
[Step=25450 Epoch=124.1] | Loss=0.00548 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.298 | L2-Norm(final)=3.207 | 1707.5 samples/s | 26.7 steps/s
[Step=25500 Epoch=124.4] | Loss=0.00522 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.298 | L2-Norm(final)=3.209 | 3622.8 samples/s | 56.6 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00514 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.298 | L2-Norm(final)=3.210 | 3644.3 samples/s | 56.9 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00503 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.297 | L2-Norm(final)=3.211 | 3882.4 samples/s | 60.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step25600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=121.6] | Loss=0.10372 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.332 | L2-Norm(final)=3.188 | 3624.2 samples/s | 56.6 steps/s
[Step=24850 Epoch=121.9] | Loss=0.02532 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.312 | L2-Norm(final)=3.180 | 3685.0 samples/s | 57.6 steps/s
[Step=24900 Epoch=122.1] | Loss=0.01694 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.305 | L2-Norm(final)=3.179 | 3729.2 samples/s | 58.3 steps/s
[Step=24950 Epoch=122.4] | Loss=0.01377 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.302 | L2-Norm(final)=3.180 | 3703.7 samples/s | 57.9 steps/s
[Step=25000 Epoch=122.6] | Loss=0.01215 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.300 | L2-Norm(final)=3.182 | 4580.3 samples/s | 71.6 steps/s
[Step=25050 Epoch=122.8] | Loss=0.01057 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.299 | L2-Norm(final)=3.184 | 1608.2 samples/s | 25.1 steps/s
[Step=25100 Epoch=123.1] | Loss=0.00931 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.298 | L2-Norm(final)=3.186 | 3634.1 samples/s | 56.8 steps/s
[Step=25150 Epoch=123.3] | Loss=0.00852 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.297 | L2-Norm(final)=3.188 | 3608.6 samples/s | 56.4 steps/s
[Step=25200 Epoch=123.6] | Loss=0.00793 | Reg=0.00299 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.296 | L2-Norm(final)=3.190 | 4373.2 samples/s | 68.3 steps/s
[Step=25250 Epoch=123.8] | Loss=0.00742 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.296 | L2-Norm(final)=3.192 | 1647.2 samples/s | 25.7 steps/s
[Step=25300 Epoch=124.1] | Loss=0.00696 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.296 | L2-Norm(final)=3.194 | 3723.7 samples/s | 58.2 steps/s
[Step=25350 Epoch=124.3] | Loss=0.00661 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.295 | L2-Norm(final)=3.196 | 3717.9 samples/s | 58.1 steps/s
[Step=25400 Epoch=124.6] | Loss=0.00619 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.295 | L2-Norm(final)=3.198 | 4203.4 samples/s | 65.7 steps/s
[Step=25450 Epoch=124.8] | Loss=0.00598 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.295 | L2-Norm(final)=3.200 | 1669.6 samples/s | 26.1 steps/s
[Step=25500 Epoch=125.0] | Loss=0.00572 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.295 | L2-Norm(final)=3.201 | 3715.0 samples/s | 58.0 steps/s
[Step=25550 Epoch=125.3] | Loss=0.00554 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.295 | L2-Norm(final)=3.203 | 3683.9 samples/s | 57.6 steps/s
[Step=25600 Epoch=125.5] | Loss=0.00539 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.294 | L2-Norm(final)=3.205 | 4213.9 samples/s | 65.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step25600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=235.0] | Loss=0.09260 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.332 | L2-Norm(final)=3.189 | 3842.1 samples/s | 60.0 steps/s
[Step=24850 Epoch=235.5] | Loss=0.00472 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.286 | L2-Norm(final)=3.193 | 3276.2 samples/s | 51.2 steps/s
[Step=24900 Epoch=235.9] | Loss=0.00241 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.279 | L2-Norm(final)=3.194 | 4483.3 samples/s | 70.1 steps/s
[Step=24950 Epoch=236.4] | Loss=0.00162 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.274 | L2-Norm(final)=3.194 | 1590.6 samples/s | 24.9 steps/s
[Step=25000 Epoch=236.9] | Loss=0.00122 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.270 | L2-Norm(final)=3.195 | 4148.2 samples/s | 64.8 steps/s
[Step=25050 Epoch=237.4] | Loss=0.00099 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.267 | L2-Norm(final)=3.195 | 1589.9 samples/s | 24.8 steps/s
[Step=25100 Epoch=237.8] | Loss=0.00083 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.265 | L2-Norm(final)=3.195 | 3901.8 samples/s | 61.0 steps/s
[Step=25150 Epoch=238.3] | Loss=0.00071 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.262 | L2-Norm(final)=3.195 | 1630.9 samples/s | 25.5 steps/s
[Step=25200 Epoch=238.8] | Loss=0.00063 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.261 | L2-Norm(final)=3.195 | 3705.0 samples/s | 57.9 steps/s
[Step=25250 Epoch=239.3] | Loss=0.00056 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.259 | L2-Norm(final)=3.196 | 1681.2 samples/s | 26.3 steps/s
[Step=25300 Epoch=239.7] | Loss=0.00051 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.257 | L2-Norm(final)=3.196 | 3560.8 samples/s | 55.6 steps/s
[Step=25350 Epoch=240.2] | Loss=0.00046 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.256 | L2-Norm(final)=3.196 | 1696.1 samples/s | 26.5 steps/s
[Step=25400 Epoch=240.7] | Loss=0.00043 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.255 | L2-Norm(final)=3.196 | 3555.8 samples/s | 55.6 steps/s
[Step=25450 Epoch=241.2] | Loss=0.00039 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.253 | L2-Norm(final)=3.196 | 1729.4 samples/s | 27.0 steps/s
[Step=25500 Epoch=241.6] | Loss=0.00037 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.252 | L2-Norm(final)=3.196 | 3594.0 samples/s | 56.2 steps/s
[Step=25550 Epoch=242.1] | Loss=0.00034 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.251 | L2-Norm(final)=3.196 | 1726.2 samples/s | 27.0 steps/s
[Step=25600 Epoch=242.6] | Loss=0.00032 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.250 | L2-Norm(final)=3.196 | 3463.8 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step25600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=235.9] | Loss=0.11384 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.332 | L2-Norm(final)=3.188 | 3699.4 samples/s | 57.8 steps/s
[Step=24850 Epoch=236.4] | Loss=0.00584 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.283 | L2-Norm(final)=3.190 | 3423.0 samples/s | 53.5 steps/s
[Step=24900 Epoch=236.9] | Loss=0.00302 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.276 | L2-Norm(final)=3.191 | 4477.1 samples/s | 70.0 steps/s
[Step=24950 Epoch=237.3] | Loss=0.00204 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.271 | L2-Norm(final)=3.192 | 1592.7 samples/s | 24.9 steps/s
[Step=25000 Epoch=237.8] | Loss=0.00154 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.268 | L2-Norm(final)=3.193 | 4240.9 samples/s | 66.3 steps/s
[Step=25050 Epoch=238.3] | Loss=0.00124 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.265 | L2-Norm(final)=3.194 | 1637.3 samples/s | 25.6 steps/s
[Step=25100 Epoch=238.8] | Loss=0.00104 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.262 | L2-Norm(final)=3.194 | 3987.2 samples/s | 62.3 steps/s
[Step=25150 Epoch=239.2] | Loss=0.00090 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.260 | L2-Norm(final)=3.195 | 1633.9 samples/s | 25.5 steps/s
[Step=25200 Epoch=239.7] | Loss=0.00079 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.259 | L2-Norm(final)=3.195 | 3724.7 samples/s | 58.2 steps/s
[Step=25250 Epoch=240.2] | Loss=0.00071 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.257 | L2-Norm(final)=3.195 | 1686.9 samples/s | 26.4 steps/s
[Step=25300 Epoch=240.7] | Loss=0.00064 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.256 | L2-Norm(final)=3.195 | 3499.6 samples/s | 54.7 steps/s
[Step=25350 Epoch=241.1] | Loss=0.00058 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.254 | L2-Norm(final)=3.196 | 1722.7 samples/s | 26.9 steps/s
[Step=25400 Epoch=241.6] | Loss=0.00054 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.253 | L2-Norm(final)=3.196 | 3539.9 samples/s | 55.3 steps/s
[Step=25450 Epoch=242.1] | Loss=0.00050 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.252 | L2-Norm(final)=3.196 | 1756.7 samples/s | 27.4 steps/s
[Step=25500 Epoch=242.6] | Loss=0.00046 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.251 | L2-Norm(final)=3.196 | 3568.3 samples/s | 55.8 steps/s
[Step=25550 Epoch=243.0] | Loss=0.00043 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.249 | L2-Norm(final)=3.196 | 1759.7 samples/s | 27.5 steps/s
[Step=25600 Epoch=243.5] | Loss=0.00041 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.248 | L2-Norm(final)=3.197 | 3525.1 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step25600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=236.8] | Loss=0.05940 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.332 | L2-Norm(final)=3.189 | 3536.0 samples/s | 55.3 steps/s
[Step=24850 Epoch=237.3] | Loss=0.00351 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.284 | L2-Norm(final)=3.194 | 3505.4 samples/s | 54.8 steps/s
[Step=24900 Epoch=237.8] | Loss=0.00193 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.276 | L2-Norm(final)=3.196 | 4509.1 samples/s | 70.5 steps/s
[Step=24950 Epoch=238.3] | Loss=0.00131 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.272 | L2-Norm(final)=3.198 | 1568.8 samples/s | 24.5 steps/s
[Step=25000 Epoch=238.7] | Loss=0.00100 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.268 | L2-Norm(final)=3.198 | 4288.3 samples/s | 67.0 steps/s
[Step=25050 Epoch=239.2] | Loss=0.00081 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.266 | L2-Norm(final)=3.199 | 1162.9 samples/s | 18.2 steps/s
[Step=25100 Epoch=239.7] | Loss=0.00068 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.264 | L2-Norm(final)=3.199 | 4071.4 samples/s | 63.6 steps/s
[Step=25150 Epoch=240.2] | Loss=0.00058 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.262 | L2-Norm(final)=3.200 | 1631.1 samples/s | 25.5 steps/s
[Step=25200 Epoch=240.6] | Loss=0.00052 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.260 | L2-Norm(final)=3.200 | 3908.8 samples/s | 61.1 steps/s
[Step=25250 Epoch=241.1] | Loss=0.00046 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.258 | L2-Norm(final)=3.200 | 1659.7 samples/s | 25.9 steps/s
[Step=25300 Epoch=241.6] | Loss=0.00042 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.257 | L2-Norm(final)=3.200 | 3759.8 samples/s | 58.7 steps/s
[Step=25350 Epoch=242.1] | Loss=0.00038 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.256 | L2-Norm(final)=3.200 | 1683.4 samples/s | 26.3 steps/s
[Step=25400 Epoch=242.6] | Loss=0.00035 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.254 | L2-Norm(final)=3.200 | 3598.4 samples/s | 56.2 steps/s
[Step=25450 Epoch=243.0] | Loss=0.00033 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.253 | L2-Norm(final)=3.200 | 1748.5 samples/s | 27.3 steps/s
[Step=25500 Epoch=243.5] | Loss=0.00031 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.252 | L2-Norm(final)=3.201 | 3560.7 samples/s | 55.6 steps/s
[Step=25550 Epoch=244.0] | Loss=0.00029 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.251 | L2-Norm(final)=3.201 | 1730.3 samples/s | 27.0 steps/s
[Step=25600 Epoch=244.5] | Loss=0.00027 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.250 | L2-Norm(final)=3.201 | 3494.1 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step25600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=233.7] | Loss=0.10301 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.332 | L2-Norm(final)=3.189 | 3786.7 samples/s | 59.2 steps/s
[Step=24850 Epoch=234.2] | Loss=0.00665 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.287 | L2-Norm(final)=3.194 | 3293.8 samples/s | 51.5 steps/s
[Step=24900 Epoch=234.6] | Loss=0.00345 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.280 | L2-Norm(final)=3.195 | 4294.3 samples/s | 67.1 steps/s
[Step=24950 Epoch=235.1] | Loss=0.00233 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.275 | L2-Norm(final)=3.196 | 1592.8 samples/s | 24.9 steps/s
[Step=25000 Epoch=235.6] | Loss=0.00176 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.271 | L2-Norm(final)=3.197 | 4140.4 samples/s | 64.7 steps/s
[Step=25050 Epoch=236.0] | Loss=0.00141 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.268 | L2-Norm(final)=3.197 | 1653.3 samples/s | 25.8 steps/s
[Step=25100 Epoch=236.5] | Loss=0.00119 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.266 | L2-Norm(final)=3.197 | 3881.2 samples/s | 60.6 steps/s
[Step=25150 Epoch=237.0] | Loss=0.00102 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.263 | L2-Norm(final)=3.197 | 1668.9 samples/s | 26.1 steps/s
[Step=25200 Epoch=237.5] | Loss=0.00090 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.262 | L2-Norm(final)=3.197 | 3629.9 samples/s | 56.7 steps/s
[Step=25250 Epoch=237.9] | Loss=0.00080 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.260 | L2-Norm(final)=3.197 | 1721.5 samples/s | 26.9 steps/s
[Step=25300 Epoch=238.4] | Loss=0.00072 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.258 | L2-Norm(final)=3.198 | 3551.5 samples/s | 55.5 steps/s
[Step=25350 Epoch=238.9] | Loss=0.00066 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.257 | L2-Norm(final)=3.198 | 1748.0 samples/s | 27.3 steps/s
[Step=25400 Epoch=239.3] | Loss=0.00061 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.256 | L2-Norm(final)=3.198 | 3538.8 samples/s | 55.3 steps/s
[Step=25450 Epoch=239.8] | Loss=0.00056 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.254 | L2-Norm(final)=3.198 | 1749.2 samples/s | 27.3 steps/s
[Step=25500 Epoch=240.3] | Loss=0.00052 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.253 | L2-Norm(final)=3.198 | 3453.2 samples/s | 54.0 steps/s
[Step=25550 Epoch=240.8] | Loss=0.00049 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.252 | L2-Norm(final)=3.198 | 1812.4 samples/s | 28.3 steps/s
[Step=25600 Epoch=241.2] | Loss=0.00046 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.251 | L2-Norm(final)=3.198 | 3257.4 samples/s | 50.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step25600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=236.4] | Loss=0.09952 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.332 | L2-Norm(final)=3.189 | 3776.5 samples/s | 59.0 steps/s
[Step=24850 Epoch=236.8] | Loss=0.00375 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.287 | L2-Norm(final)=3.197 | 3334.3 samples/s | 52.1 steps/s
[Step=24900 Epoch=237.3] | Loss=0.00193 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.279 | L2-Norm(final)=3.198 | 4359.1 samples/s | 68.1 steps/s
[Step=24950 Epoch=237.8] | Loss=0.00132 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.274 | L2-Norm(final)=3.199 | 1576.7 samples/s | 24.6 steps/s
[Step=25000 Epoch=238.3] | Loss=0.00100 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.270 | L2-Norm(final)=3.200 | 4280.4 samples/s | 66.9 steps/s
[Step=25050 Epoch=238.7] | Loss=0.00081 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.267 | L2-Norm(final)=3.200 | 1593.7 samples/s | 24.9 steps/s
[Step=25100 Epoch=239.2] | Loss=0.00068 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.264 | L2-Norm(final)=3.201 | 4069.8 samples/s | 63.6 steps/s
[Step=25150 Epoch=239.7] | Loss=0.00059 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.262 | L2-Norm(final)=3.201 | 1631.6 samples/s | 25.5 steps/s
[Step=25200 Epoch=240.2] | Loss=0.00052 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.260 | L2-Norm(final)=3.201 | 3738.7 samples/s | 58.4 steps/s
[Step=25250 Epoch=240.7] | Loss=0.00047 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.258 | L2-Norm(final)=3.201 | 1660.0 samples/s | 25.9 steps/s
[Step=25300 Epoch=241.1] | Loss=0.00042 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.256 | L2-Norm(final)=3.201 | 3760.1 samples/s | 58.8 steps/s
[Step=25350 Epoch=241.6] | Loss=0.00039 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.255 | L2-Norm(final)=3.201 | 1704.5 samples/s | 26.6 steps/s
[Step=25400 Epoch=242.1] | Loss=0.00036 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.254 | L2-Norm(final)=3.202 | 3510.9 samples/s | 54.9 steps/s
[Step=25450 Epoch=242.6] | Loss=0.00033 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.252 | L2-Norm(final)=3.202 | 1717.5 samples/s | 26.8 steps/s
[Step=25500 Epoch=243.0] | Loss=0.00031 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.251 | L2-Norm(final)=3.202 | 3575.4 samples/s | 55.9 steps/s
[Step=25550 Epoch=243.5] | Loss=0.00029 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.250 | L2-Norm(final)=3.202 | 1730.3 samples/s | 27.0 steps/s
[Step=25600 Epoch=244.0] | Loss=0.00027 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.249 | L2-Norm(final)=3.202 | 3505.7 samples/s | 54.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23030 | acc=0.8699 | tpr=0.8174 | fpr=0.0161 | 3777.4 samples/s | 14.8 steps/s
Avg test loss: 0.23221, Avg test acc: 0.86958, Avg tpr: 0.81757, Avg fpr: 0.01602, total FA: 125

Testing server on iccad2012
[Step=  50] | Loss=0.45003 | acc=0.8542 | tpr=0.9602 | fpr=0.1477 | 3826.2 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.46009 | acc=0.8533 | tpr=0.9616 | fpr=0.1487 | 7068.1 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.46670 | acc=0.8518 | tpr=0.9697 | fpr=0.1504 | 7412.2 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.46643 | acc=0.8528 | tpr=0.9683 | fpr=0.1493 | 7174.3 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.46537 | acc=0.8534 | tpr=0.9703 | fpr=0.1487 | 7226.4 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.46416 | acc=0.8541 | tpr=0.9665 | fpr=0.1480 | 7121.4 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.46586 | acc=0.8540 | tpr=0.9649 | fpr=0.1480 | 7240.1 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.46637 | acc=0.8539 | tpr=0.9628 | fpr=0.1481 | 7216.8 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.47024 | acc=0.8530 | tpr=0.9625 | fpr=0.1490 | 7084.1 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.47097 | acc=0.8525 | tpr=0.9639 | fpr=0.1495 | 6988.0 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.46985 | acc=0.8527 | tpr=0.9654 | fpr=0.1493 | 12396.7 samples/s | 48.4 steps/s
Avg test loss: 0.46975, Avg test acc: 0.85271, Avg tpr: 0.96553, Avg fpr: 0.14934, total FA: 20735

server round 32/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.8] | Loss=0.07722 | Reg=0.00298 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.256 | L2-Norm(final)=3.214 | 3772.9 samples/s | 59.0 steps/s
[Step=25650 Epoch=125.1] | Loss=0.02587 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.238 | L2-Norm(final)=3.207 | 3641.2 samples/s | 56.9 steps/s
[Step=25700 Epoch=125.3] | Loss=0.01763 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.231 | L2-Norm(final)=3.206 | 3719.4 samples/s | 58.1 steps/s
[Step=25750 Epoch=125.6] | Loss=0.01425 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.227 | L2-Norm(final)=3.206 | 3688.4 samples/s | 57.6 steps/s
[Step=25800 Epoch=125.8] | Loss=0.01252 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.224 | L2-Norm(final)=3.207 | 4641.9 samples/s | 72.5 steps/s
[Step=25850 Epoch=126.0] | Loss=0.01076 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.223 | L2-Norm(final)=3.208 | 1619.5 samples/s | 25.3 steps/s
[Step=25900 Epoch=126.3] | Loss=0.00972 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.222 | L2-Norm(final)=3.210 | 3585.3 samples/s | 56.0 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00891 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.221 | L2-Norm(final)=3.211 | 3585.5 samples/s | 56.0 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00861 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.220 | L2-Norm(final)=3.213 | 4232.5 samples/s | 66.1 steps/s
[Step=26050 Epoch=127.0] | Loss=0.00805 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.219 | L2-Norm(final)=3.214 | 1650.1 samples/s | 25.8 steps/s
[Step=26100 Epoch=127.3] | Loss=0.00756 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.219 | L2-Norm(final)=3.216 | 3701.5 samples/s | 57.8 steps/s
[Step=26150 Epoch=127.5] | Loss=0.00717 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.219 | L2-Norm(final)=3.217 | 3715.6 samples/s | 58.1 steps/s
[Step=26200 Epoch=127.8] | Loss=0.00691 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.218 | L2-Norm(final)=3.219 | 4155.0 samples/s | 64.9 steps/s
[Step=26250 Epoch=128.0] | Loss=0.00654 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.218 | L2-Norm(final)=3.220 | 1698.1 samples/s | 26.5 steps/s
[Step=26300 Epoch=128.2] | Loss=0.00628 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.218 | L2-Norm(final)=3.222 | 3648.2 samples/s | 57.0 steps/s
[Step=26350 Epoch=128.5] | Loss=0.00602 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.217 | L2-Norm(final)=3.223 | 3633.7 samples/s | 56.8 steps/s
[Step=26400 Epoch=128.7] | Loss=0.00588 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.217 | L2-Norm(final)=3.224 | 3840.1 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step26400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.9] | Loss=0.17037 | Reg=0.00298 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=17.256 | L2-Norm(final)=3.214 | 3683.3 samples/s | 57.6 steps/s
[Step=25650 Epoch=125.2] | Loss=0.02411 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.238 | L2-Norm(final)=3.208 | 3568.5 samples/s | 55.8 steps/s
[Step=25700 Epoch=125.4] | Loss=0.01591 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.233 | L2-Norm(final)=3.207 | 3655.2 samples/s | 57.1 steps/s
[Step=25750 Epoch=125.6] | Loss=0.01305 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.229 | L2-Norm(final)=3.207 | 3654.9 samples/s | 57.1 steps/s
[Step=25800 Epoch=125.9] | Loss=0.01086 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.227 | L2-Norm(final)=3.208 | 4550.8 samples/s | 71.1 steps/s
[Step=25850 Epoch=126.1] | Loss=0.00932 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.225 | L2-Norm(final)=3.209 | 1628.1 samples/s | 25.4 steps/s
[Step=25900 Epoch=126.4] | Loss=0.00831 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.224 | L2-Norm(final)=3.211 | 3731.3 samples/s | 58.3 steps/s
[Step=25950 Epoch=126.6] | Loss=0.00776 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.224 | L2-Norm(final)=3.213 | 3757.2 samples/s | 58.7 steps/s
[Step=26000 Epoch=126.9] | Loss=0.00722 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.223 | L2-Norm(final)=3.214 | 4346.2 samples/s | 67.9 steps/s
[Step=26050 Epoch=127.1] | Loss=0.00675 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.222 | L2-Norm(final)=3.215 | 1613.1 samples/s | 25.2 steps/s
[Step=26100 Epoch=127.4] | Loss=0.00636 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.221 | L2-Norm(final)=3.217 | 3716.8 samples/s | 58.1 steps/s
[Step=26150 Epoch=127.6] | Loss=0.00603 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.221 | L2-Norm(final)=3.218 | 3726.1 samples/s | 58.2 steps/s
[Step=26200 Epoch=127.8] | Loss=0.00586 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.220 | L2-Norm(final)=3.220 | 4240.8 samples/s | 66.3 steps/s
[Step=26250 Epoch=128.1] | Loss=0.00556 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.220 | L2-Norm(final)=3.221 | 1682.3 samples/s | 26.3 steps/s
[Step=26300 Epoch=128.3] | Loss=0.00532 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.220 | L2-Norm(final)=3.222 | 3728.3 samples/s | 58.3 steps/s
[Step=26350 Epoch=128.6] | Loss=0.00514 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.219 | L2-Norm(final)=3.223 | 3708.7 samples/s | 57.9 steps/s
[Step=26400 Epoch=128.8] | Loss=0.00505 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.219 | L2-Norm(final)=3.224 | 3999.3 samples/s | 62.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step26400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.7] | Loss=0.06789 | Reg=0.00298 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.256 | L2-Norm(final)=3.214 | 3718.5 samples/s | 58.1 steps/s
[Step=25650 Epoch=125.0] | Loss=0.02129 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.238 | L2-Norm(final)=3.210 | 3650.4 samples/s | 57.0 steps/s
[Step=25700 Epoch=125.2] | Loss=0.01445 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.232 | L2-Norm(final)=3.209 | 3632.9 samples/s | 56.8 steps/s
[Step=25750 Epoch=125.5] | Loss=0.01255 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.229 | L2-Norm(final)=3.210 | 3597.2 samples/s | 56.2 steps/s
[Step=25800 Epoch=125.7] | Loss=0.01143 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.227 | L2-Norm(final)=3.211 | 4488.8 samples/s | 70.1 steps/s
[Step=25850 Epoch=126.0] | Loss=0.01009 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.226 | L2-Norm(final)=3.212 | 1632.3 samples/s | 25.5 steps/s
[Step=25900 Epoch=126.2] | Loss=0.00912 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.225 | L2-Norm(final)=3.214 | 3742.0 samples/s | 58.5 steps/s
[Step=25950 Epoch=126.4] | Loss=0.00841 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.224 | L2-Norm(final)=3.216 | 3754.8 samples/s | 58.7 steps/s
[Step=26000 Epoch=126.7] | Loss=0.00778 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.224 | L2-Norm(final)=3.218 | 4393.8 samples/s | 68.7 steps/s
[Step=26050 Epoch=126.9] | Loss=0.00725 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.224 | L2-Norm(final)=3.219 | 1664.4 samples/s | 26.0 steps/s
[Step=26100 Epoch=127.2] | Loss=0.00684 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.223 | L2-Norm(final)=3.221 | 3502.1 samples/s | 54.7 steps/s
[Step=26150 Epoch=127.4] | Loss=0.00646 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.223 | L2-Norm(final)=3.223 | 3494.6 samples/s | 54.6 steps/s
[Step=26200 Epoch=127.7] | Loss=0.00618 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.223 | L2-Norm(final)=3.225 | 4184.5 samples/s | 65.4 steps/s
[Step=26250 Epoch=127.9] | Loss=0.00598 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.223 | L2-Norm(final)=3.227 | 1696.6 samples/s | 26.5 steps/s
[Step=26300 Epoch=128.1] | Loss=0.00578 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.223 | L2-Norm(final)=3.228 | 3652.4 samples/s | 57.1 steps/s
[Step=26350 Epoch=128.4] | Loss=0.00564 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.223 | L2-Norm(final)=3.230 | 3632.6 samples/s | 56.8 steps/s
[Step=26400 Epoch=128.6] | Loss=0.00550 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.222 | L2-Norm(final)=3.231 | 3833.3 samples/s | 59.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step26400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.8] | Loss=0.14817 | Reg=0.00298 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=17.256 | L2-Norm(final)=3.214 | 3645.1 samples/s | 57.0 steps/s
[Step=25650 Epoch=125.1] | Loss=0.01687 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.239 | L2-Norm(final)=3.209 | 3183.1 samples/s | 49.7 steps/s
[Step=25700 Epoch=125.3] | Loss=0.01234 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.235 | L2-Norm(final)=3.211 | 3396.8 samples/s | 53.1 steps/s
[Step=25750 Epoch=125.6] | Loss=0.01003 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.232 | L2-Norm(final)=3.213 | 3376.0 samples/s | 52.7 steps/s
[Step=25800 Epoch=125.8] | Loss=0.00953 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.230 | L2-Norm(final)=3.214 | 4195.4 samples/s | 65.6 steps/s
[Step=25850 Epoch=126.1] | Loss=0.00841 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.229 | L2-Norm(final)=3.216 | 1429.2 samples/s | 22.3 steps/s
[Step=25900 Epoch=126.3] | Loss=0.00757 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.228 | L2-Norm(final)=3.218 | 3328.1 samples/s | 52.0 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00701 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.227 | L2-Norm(final)=3.220 | 3421.5 samples/s | 53.5 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00658 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.226 | L2-Norm(final)=3.221 | 4039.8 samples/s | 63.1 steps/s
[Step=26050 Epoch=127.0] | Loss=0.00610 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.226 | L2-Norm(final)=3.223 | 1682.6 samples/s | 26.3 steps/s
[Step=26100 Epoch=127.3] | Loss=0.00584 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.225 | L2-Norm(final)=3.225 | 3763.6 samples/s | 58.8 steps/s
[Step=26150 Epoch=127.5] | Loss=0.00561 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.225 | L2-Norm(final)=3.226 | 3773.8 samples/s | 59.0 steps/s
[Step=26200 Epoch=127.8] | Loss=0.00535 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.224 | L2-Norm(final)=3.228 | 4202.7 samples/s | 65.7 steps/s
[Step=26250 Epoch=128.0] | Loss=0.00508 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.224 | L2-Norm(final)=3.229 | 1729.0 samples/s | 27.0 steps/s
[Step=26300 Epoch=128.3] | Loss=0.00492 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.223 | L2-Norm(final)=3.231 | 3769.2 samples/s | 58.9 steps/s
[Step=26350 Epoch=128.5] | Loss=0.00479 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.223 | L2-Norm(final)=3.232 | 3764.3 samples/s | 58.8 steps/s
[Step=26400 Epoch=128.7] | Loss=0.00469 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.222 | L2-Norm(final)=3.233 | 4031.3 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step26400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=125.5] | Loss=0.07725 | Reg=0.00298 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.256 | L2-Norm(final)=3.214 | 3641.1 samples/s | 56.9 steps/s
[Step=25650 Epoch=125.8] | Loss=0.02074 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.236 | L2-Norm(final)=3.209 | 3762.5 samples/s | 58.8 steps/s
[Step=25700 Epoch=126.0] | Loss=0.01543 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.231 | L2-Norm(final)=3.209 | 3764.9 samples/s | 58.8 steps/s
[Step=25750 Epoch=126.3] | Loss=0.01225 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.229 | L2-Norm(final)=3.210 | 3783.7 samples/s | 59.1 steps/s
[Step=25800 Epoch=126.5] | Loss=0.01098 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.228 | L2-Norm(final)=3.211 | 4715.6 samples/s | 73.7 steps/s
[Step=25850 Epoch=126.8] | Loss=0.00947 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.227 | L2-Norm(final)=3.213 | 1644.0 samples/s | 25.7 steps/s
[Step=25900 Epoch=127.0] | Loss=0.00856 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.226 | L2-Norm(final)=3.215 | 3765.8 samples/s | 58.8 steps/s
[Step=25950 Epoch=127.3] | Loss=0.00772 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.225 | L2-Norm(final)=3.217 | 3770.2 samples/s | 58.9 steps/s
[Step=26000 Epoch=127.5] | Loss=0.00720 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.225 | L2-Norm(final)=3.219 | 4562.3 samples/s | 71.3 steps/s
[Step=26050 Epoch=127.7] | Loss=0.00665 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.224 | L2-Norm(final)=3.221 | 1653.4 samples/s | 25.8 steps/s
[Step=26100 Epoch=128.0] | Loss=0.00644 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.224 | L2-Norm(final)=3.223 | 3763.4 samples/s | 58.8 steps/s
[Step=26150 Epoch=128.2] | Loss=0.00618 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.224 | L2-Norm(final)=3.224 | 3756.3 samples/s | 58.7 steps/s
[Step=26200 Epoch=128.5] | Loss=0.00587 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.223 | L2-Norm(final)=3.226 | 4400.6 samples/s | 68.8 steps/s
[Step=26250 Epoch=128.7] | Loss=0.00562 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.223 | L2-Norm(final)=3.228 | 1701.8 samples/s | 26.6 steps/s
[Step=26300 Epoch=129.0] | Loss=0.00541 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.222 | L2-Norm(final)=3.229 | 3781.5 samples/s | 59.1 steps/s
[Step=26350 Epoch=129.2] | Loss=0.00519 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.222 | L2-Norm(final)=3.231 | 3768.5 samples/s | 58.9 steps/s
[Step=26400 Epoch=129.5] | Loss=0.00506 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.222 | L2-Norm(final)=3.232 | 4250.1 samples/s | 66.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step26400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=242.6] | Loss=0.06741 | Reg=0.00298 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.256 | L2-Norm(final)=3.214 | 3726.5 samples/s | 58.2 steps/s
[Step=25650 Epoch=243.1] | Loss=0.00426 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.211 | L2-Norm(final)=3.219 | 3408.2 samples/s | 53.3 steps/s
[Step=25700 Epoch=243.5] | Loss=0.00220 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.203 | L2-Norm(final)=3.220 | 4497.1 samples/s | 70.3 steps/s
[Step=25750 Epoch=244.0] | Loss=0.00148 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.198 | L2-Norm(final)=3.221 | 1606.3 samples/s | 25.1 steps/s
[Step=25800 Epoch=244.5] | Loss=0.00112 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.194 | L2-Norm(final)=3.222 | 4270.6 samples/s | 66.7 steps/s
[Step=25850 Epoch=245.0] | Loss=0.00091 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.191 | L2-Norm(final)=3.222 | 1606.4 samples/s | 25.1 steps/s
[Step=25900 Epoch=245.4] | Loss=0.00076 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.189 | L2-Norm(final)=3.222 | 3949.9 samples/s | 61.7 steps/s
[Step=25950 Epoch=245.9] | Loss=0.00066 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.186 | L2-Norm(final)=3.223 | 1647.5 samples/s | 25.7 steps/s
[Step=26000 Epoch=246.4] | Loss=0.00058 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.184 | L2-Norm(final)=3.223 | 3699.3 samples/s | 57.8 steps/s
[Step=26050 Epoch=246.8] | Loss=0.00052 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.183 | L2-Norm(final)=3.223 | 1633.2 samples/s | 25.5 steps/s
[Step=26100 Epoch=247.3] | Loss=0.00047 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.181 | L2-Norm(final)=3.223 | 3498.1 samples/s | 54.7 steps/s
[Step=26150 Epoch=247.8] | Loss=0.00043 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.179 | L2-Norm(final)=3.223 | 1637.2 samples/s | 25.6 steps/s
[Step=26200 Epoch=248.3] | Loss=0.00040 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.178 | L2-Norm(final)=3.223 | 3308.3 samples/s | 51.7 steps/s
[Step=26250 Epoch=248.7] | Loss=0.00037 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.177 | L2-Norm(final)=3.223 | 1647.9 samples/s | 25.7 steps/s
[Step=26300 Epoch=249.2] | Loss=0.00034 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.176 | L2-Norm(final)=3.224 | 3482.5 samples/s | 54.4 steps/s
[Step=26350 Epoch=249.7] | Loss=0.00032 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.175 | L2-Norm(final)=3.224 | 1655.6 samples/s | 25.9 steps/s
[Step=26400 Epoch=250.2] | Loss=0.00030 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.174 | L2-Norm(final)=3.224 | 3275.1 samples/s | 51.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step26400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=243.5] | Loss=0.04070 | Reg=0.00298 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.256 | L2-Norm(final)=3.214 | 3673.0 samples/s | 57.4 steps/s
[Step=25650 Epoch=244.0] | Loss=0.00489 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.212 | L2-Norm(final)=3.217 | 3208.5 samples/s | 50.1 steps/s
[Step=25700 Epoch=244.5] | Loss=0.00255 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.206 | L2-Norm(final)=3.218 | 4189.5 samples/s | 65.5 steps/s
[Step=25750 Epoch=244.9] | Loss=0.00174 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.201 | L2-Norm(final)=3.219 | 1499.2 samples/s | 23.4 steps/s
[Step=25800 Epoch=245.4] | Loss=0.00132 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.198 | L2-Norm(final)=3.220 | 3858.8 samples/s | 60.3 steps/s
[Step=25850 Epoch=245.9] | Loss=0.00107 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.195 | L2-Norm(final)=3.220 | 1532.9 samples/s | 24.0 steps/s
[Step=25900 Epoch=246.4] | Loss=0.00089 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.192 | L2-Norm(final)=3.221 | 3681.6 samples/s | 57.5 steps/s
[Step=25950 Epoch=246.8] | Loss=0.00077 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.190 | L2-Norm(final)=3.221 | 1583.8 samples/s | 24.7 steps/s
[Step=26000 Epoch=247.3] | Loss=0.00068 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.188 | L2-Norm(final)=3.221 | 3545.7 samples/s | 55.4 steps/s
[Step=26050 Epoch=247.8] | Loss=0.00061 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.186 | L2-Norm(final)=3.222 | 1583.8 samples/s | 24.7 steps/s
[Step=26100 Epoch=248.3] | Loss=0.00055 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.185 | L2-Norm(final)=3.222 | 3394.8 samples/s | 53.0 steps/s
[Step=26150 Epoch=248.8] | Loss=0.00050 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.183 | L2-Norm(final)=3.222 | 1679.8 samples/s | 26.2 steps/s
[Step=26200 Epoch=249.2] | Loss=0.00046 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.182 | L2-Norm(final)=3.222 | 3338.9 samples/s | 52.2 steps/s
[Step=26250 Epoch=249.7] | Loss=0.00043 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.181 | L2-Norm(final)=3.222 | 1709.8 samples/s | 26.7 steps/s
[Step=26300 Epoch=250.2] | Loss=0.00040 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.179 | L2-Norm(final)=3.222 | 3379.9 samples/s | 52.8 steps/s
[Step=26350 Epoch=250.7] | Loss=0.00037 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.178 | L2-Norm(final)=3.223 | 1643.3 samples/s | 25.7 steps/s
[Step=26400 Epoch=251.1] | Loss=0.00035 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.177 | L2-Norm(final)=3.223 | 3347.8 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step26400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=244.5] | Loss=0.00470 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.256 | L2-Norm(final)=3.214 | 3627.4 samples/s | 56.7 steps/s
[Step=25650 Epoch=244.9] | Loss=0.00726 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.213 | L2-Norm(final)=3.216 | 3177.4 samples/s | 49.6 steps/s
[Step=25700 Epoch=245.4] | Loss=0.00369 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.206 | L2-Norm(final)=3.217 | 4223.9 samples/s | 66.0 steps/s
[Step=25750 Epoch=245.9] | Loss=0.00248 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.201 | L2-Norm(final)=3.217 | 1527.3 samples/s | 23.9 steps/s
[Step=25800 Epoch=246.4] | Loss=0.00187 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.198 | L2-Norm(final)=3.218 | 4048.6 samples/s | 63.3 steps/s
[Step=25850 Epoch=246.9] | Loss=0.00150 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.195 | L2-Norm(final)=3.218 | 1541.9 samples/s | 24.1 steps/s
[Step=25900 Epoch=247.3] | Loss=0.00126 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.192 | L2-Norm(final)=3.218 | 3854.0 samples/s | 60.2 steps/s
[Step=25950 Epoch=247.8] | Loss=0.00108 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.190 | L2-Norm(final)=3.218 | 1575.9 samples/s | 24.6 steps/s
[Step=26000 Epoch=248.3] | Loss=0.00095 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.188 | L2-Norm(final)=3.219 | 3569.6 samples/s | 55.8 steps/s
[Step=26050 Epoch=248.8] | Loss=0.00085 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.187 | L2-Norm(final)=3.219 | 1589.0 samples/s | 24.8 steps/s
[Step=26100 Epoch=249.2] | Loss=0.00077 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.185 | L2-Norm(final)=3.219 | 3502.2 samples/s | 54.7 steps/s
[Step=26150 Epoch=249.7] | Loss=0.00070 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.184 | L2-Norm(final)=3.219 | 1604.4 samples/s | 25.1 steps/s
[Step=26200 Epoch=250.2] | Loss=0.00064 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.182 | L2-Norm(final)=3.219 | 3363.1 samples/s | 52.5 steps/s
[Step=26250 Epoch=250.7] | Loss=0.00059 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.181 | L2-Norm(final)=3.219 | 1651.0 samples/s | 25.8 steps/s
[Step=26300 Epoch=251.1] | Loss=0.00055 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.180 | L2-Norm(final)=3.219 | 3374.6 samples/s | 52.7 steps/s
[Step=26350 Epoch=251.6] | Loss=0.00052 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.179 | L2-Norm(final)=3.219 | 1664.0 samples/s | 26.0 steps/s
[Step=26400 Epoch=252.1] | Loss=0.00049 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.178 | L2-Norm(final)=3.219 | 3405.2 samples/s | 53.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step26400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=241.2] | Loss=0.08616 | Reg=0.00298 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.256 | L2-Norm(final)=3.214 | 3356.9 samples/s | 52.5 steps/s
[Step=25650 Epoch=241.7] | Loss=0.00623 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.210 | L2-Norm(final)=3.219 | 3363.7 samples/s | 52.6 steps/s
[Step=25700 Epoch=242.2] | Loss=0.00317 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.202 | L2-Norm(final)=3.220 | 4088.2 samples/s | 63.9 steps/s
[Step=25750 Epoch=242.6] | Loss=0.00213 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.197 | L2-Norm(final)=3.220 | 1512.0 samples/s | 23.6 steps/s
[Step=25800 Epoch=243.1] | Loss=0.00161 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.193 | L2-Norm(final)=3.221 | 3832.3 samples/s | 59.9 steps/s
[Step=25850 Epoch=243.6] | Loss=0.00130 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.190 | L2-Norm(final)=3.221 | 1545.8 samples/s | 24.2 steps/s
[Step=25900 Epoch=244.1] | Loss=0.00109 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.188 | L2-Norm(final)=3.221 | 3649.3 samples/s | 57.0 steps/s
[Step=25950 Epoch=244.5] | Loss=0.00094 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.186 | L2-Norm(final)=3.221 | 1587.3 samples/s | 24.8 steps/s
[Step=26000 Epoch=245.0] | Loss=0.00082 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.184 | L2-Norm(final)=3.221 | 3570.5 samples/s | 55.8 steps/s
[Step=26050 Epoch=245.5] | Loss=0.00073 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.182 | L2-Norm(final)=3.221 | 1641.9 samples/s | 25.7 steps/s
[Step=26100 Epoch=245.9] | Loss=0.00066 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.181 | L2-Norm(final)=3.221 | 3379.7 samples/s | 52.8 steps/s
[Step=26150 Epoch=246.4] | Loss=0.00060 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.179 | L2-Norm(final)=3.221 | 1640.5 samples/s | 25.6 steps/s
[Step=26200 Epoch=246.9] | Loss=0.00056 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.178 | L2-Norm(final)=3.221 | 3296.7 samples/s | 51.5 steps/s
[Step=26250 Epoch=247.3] | Loss=0.00051 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.177 | L2-Norm(final)=3.221 | 1672.6 samples/s | 26.1 steps/s
[Step=26300 Epoch=247.8] | Loss=0.00048 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.176 | L2-Norm(final)=3.222 | 3302.6 samples/s | 51.6 steps/s
[Step=26350 Epoch=248.3] | Loss=0.00045 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.175 | L2-Norm(final)=3.222 | 1687.0 samples/s | 26.4 steps/s
[Step=26400 Epoch=248.8] | Loss=0.00042 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.174 | L2-Norm(final)=3.222 | 3208.9 samples/s | 50.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step26400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=244.0] | Loss=0.19195 | Reg=0.00298 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=17.256 | L2-Norm(final)=3.214 | 3501.3 samples/s | 54.7 steps/s
[Step=25650 Epoch=244.5] | Loss=0.00589 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.210 | L2-Norm(final)=3.220 | 3333.5 samples/s | 52.1 steps/s
[Step=25700 Epoch=244.9] | Loss=0.00300 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.201 | L2-Norm(final)=3.221 | 4218.2 samples/s | 65.9 steps/s
[Step=25750 Epoch=245.4] | Loss=0.00202 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.196 | L2-Norm(final)=3.222 | 1522.1 samples/s | 23.8 steps/s
[Step=25800 Epoch=245.9] | Loss=0.00153 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.192 | L2-Norm(final)=3.222 | 3967.7 samples/s | 62.0 steps/s
[Step=25850 Epoch=246.4] | Loss=0.00123 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.189 | L2-Norm(final)=3.222 | 1528.6 samples/s | 23.9 steps/s
[Step=25900 Epoch=246.9] | Loss=0.00103 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.187 | L2-Norm(final)=3.223 | 3773.5 samples/s | 59.0 steps/s
[Step=25950 Epoch=247.3] | Loss=0.00089 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.185 | L2-Norm(final)=3.223 | 1555.5 samples/s | 24.3 steps/s
[Step=26000 Epoch=247.8] | Loss=0.00078 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.183 | L2-Norm(final)=3.223 | 3704.4 samples/s | 57.9 steps/s
[Step=26050 Epoch=248.3] | Loss=0.00070 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.181 | L2-Norm(final)=3.223 | 1603.6 samples/s | 25.1 steps/s
[Step=26100 Epoch=248.8] | Loss=0.00063 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.180 | L2-Norm(final)=3.223 | 3557.1 samples/s | 55.6 steps/s
[Step=26150 Epoch=249.2] | Loss=0.00058 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.178 | L2-Norm(final)=3.223 | 1586.4 samples/s | 24.8 steps/s
[Step=26200 Epoch=249.7] | Loss=0.00053 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.177 | L2-Norm(final)=3.223 | 3404.1 samples/s | 53.2 steps/s
[Step=26250 Epoch=250.2] | Loss=0.00049 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.176 | L2-Norm(final)=3.223 | 1638.4 samples/s | 25.6 steps/s
[Step=26300 Epoch=250.7] | Loss=0.00046 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.175 | L2-Norm(final)=3.223 | 3328.0 samples/s | 52.0 steps/s
[Step=26350 Epoch=251.1] | Loss=0.00043 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.174 | L2-Norm(final)=3.223 | 1657.0 samples/s | 25.9 steps/s
[Step=26400 Epoch=251.6] | Loss=0.00040 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.173 | L2-Norm(final)=3.223 | 3331.3 samples/s | 52.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23149 | acc=0.8721 | tpr=0.8206 | fpr=0.0161 | 3662.2 samples/s | 14.3 steps/s
Avg test loss: 0.23283, Avg test acc: 0.87106, Avg tpr: 0.81967, Avg fpr: 0.01590, total FA: 124

Testing server on iccad2012
[Step=  50] | Loss=0.44115 | acc=0.8601 | tpr=0.9646 | fpr=0.1418 | 3658.7 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.45128 | acc=0.8584 | tpr=0.9638 | fpr=0.1435 | 6768.2 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.45820 | acc=0.8570 | tpr=0.9712 | fpr=0.1451 | 7163.4 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.45834 | acc=0.8577 | tpr=0.9694 | fpr=0.1444 | 6730.8 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.45745 | acc=0.8581 | tpr=0.9712 | fpr=0.1439 | 6755.4 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.45653 | acc=0.8590 | tpr=0.9673 | fpr=0.1429 | 7040.3 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.45829 | acc=0.8592 | tpr=0.9656 | fpr=0.1427 | 6737.7 samples/s | 26.3 steps/s
[Step= 400] | Loss=0.45879 | acc=0.8593 | tpr=0.9644 | fpr=0.1426 | 6705.1 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.46266 | acc=0.8585 | tpr=0.9640 | fpr=0.1435 | 6620.5 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.46333 | acc=0.8581 | tpr=0.9652 | fpr=0.1438 | 6530.0 samples/s | 25.5 steps/s
[Step= 550] | Loss=0.46234 | acc=0.8584 | tpr=0.9666 | fpr=0.1436 | 12665.7 samples/s | 49.5 steps/s
Avg test loss: 0.46219, Avg test acc: 0.85839, Avg tpr: 0.96672, Avg fpr: 0.14357, total FA: 19935

server round 33/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.7] | Loss=0.26690 | Reg=0.00295 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=17.182 | L2-Norm(final)=3.236 | 3614.0 samples/s | 56.5 steps/s
[Step=26450 Epoch=129.0] | Loss=0.02244 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.162 | L2-Norm(final)=3.231 | 3316.5 samples/s | 51.8 steps/s
[Step=26500 Epoch=129.2] | Loss=0.01596 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.156 | L2-Norm(final)=3.231 | 3451.4 samples/s | 53.9 steps/s
[Step=26550 Epoch=129.5] | Loss=0.01309 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.153 | L2-Norm(final)=3.232 | 3401.9 samples/s | 53.2 steps/s
[Step=26600 Epoch=129.7] | Loss=0.01222 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.151 | L2-Norm(final)=3.232 | 4340.2 samples/s | 67.8 steps/s
[Step=26650 Epoch=130.0] | Loss=0.01046 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.149 | L2-Norm(final)=3.233 | 1562.1 samples/s | 24.4 steps/s
[Step=26700 Epoch=130.2] | Loss=0.00933 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.148 | L2-Norm(final)=3.234 | 3481.4 samples/s | 54.4 steps/s
[Step=26750 Epoch=130.4] | Loss=0.00874 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.147 | L2-Norm(final)=3.235 | 3424.5 samples/s | 53.5 steps/s
[Step=26800 Epoch=130.7] | Loss=0.00810 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.146 | L2-Norm(final)=3.236 | 4075.4 samples/s | 63.7 steps/s
[Step=26850 Epoch=130.9] | Loss=0.00761 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.146 | L2-Norm(final)=3.238 | 1587.1 samples/s | 24.8 steps/s
[Step=26900 Epoch=131.2] | Loss=0.00721 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.145 | L2-Norm(final)=3.239 | 3469.5 samples/s | 54.2 steps/s
[Step=26950 Epoch=131.4] | Loss=0.00696 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.145 | L2-Norm(final)=3.240 | 3462.3 samples/s | 54.1 steps/s
[Step=27000 Epoch=131.7] | Loss=0.00668 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.144 | L2-Norm(final)=3.241 | 3891.7 samples/s | 60.8 steps/s
[Step=27050 Epoch=131.9] | Loss=0.00636 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.144 | L2-Norm(final)=3.243 | 1622.7 samples/s | 25.4 steps/s
[Step=27100 Epoch=132.1] | Loss=0.00605 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.143 | L2-Norm(final)=3.244 | 3467.8 samples/s | 54.2 steps/s
[Step=27150 Epoch=132.4] | Loss=0.00585 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.143 | L2-Norm(final)=3.245 | 3445.7 samples/s | 53.8 steps/s
[Step=27200 Epoch=132.6] | Loss=0.00572 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.143 | L2-Norm(final)=3.246 | 3733.9 samples/s | 58.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step27200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.8] | Loss=0.07277 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.182 | L2-Norm(final)=3.237 | 3717.0 samples/s | 58.1 steps/s
[Step=26450 Epoch=129.1] | Loss=0.01561 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.164 | L2-Norm(final)=3.236 | 3267.4 samples/s | 51.1 steps/s
[Step=26500 Epoch=129.3] | Loss=0.01184 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.158 | L2-Norm(final)=3.237 | 3541.0 samples/s | 55.3 steps/s
[Step=26550 Epoch=129.6] | Loss=0.01002 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.155 | L2-Norm(final)=3.238 | 3566.0 samples/s | 55.7 steps/s
[Step=26600 Epoch=129.8] | Loss=0.00925 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.153 | L2-Norm(final)=3.239 | 4350.1 samples/s | 68.0 steps/s
[Step=26650 Epoch=130.0] | Loss=0.00818 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.151 | L2-Norm(final)=3.240 | 1539.1 samples/s | 24.0 steps/s
[Step=26700 Epoch=130.3] | Loss=0.00763 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.150 | L2-Norm(final)=3.242 | 3516.1 samples/s | 54.9 steps/s
[Step=26750 Epoch=130.5] | Loss=0.00699 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.149 | L2-Norm(final)=3.243 | 3487.7 samples/s | 54.5 steps/s
[Step=26800 Epoch=130.8] | Loss=0.00665 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.148 | L2-Norm(final)=3.244 | 4090.4 samples/s | 63.9 steps/s
[Step=26850 Epoch=131.0] | Loss=0.00624 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.147 | L2-Norm(final)=3.245 | 1567.9 samples/s | 24.5 steps/s
[Step=26900 Epoch=131.3] | Loss=0.00589 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.147 | L2-Norm(final)=3.246 | 3487.8 samples/s | 54.5 steps/s
[Step=26950 Epoch=131.5] | Loss=0.00560 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.146 | L2-Norm(final)=3.247 | 3462.3 samples/s | 54.1 steps/s
[Step=27000 Epoch=131.7] | Loss=0.00549 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.145 | L2-Norm(final)=3.248 | 3940.7 samples/s | 61.6 steps/s
[Step=27050 Epoch=132.0] | Loss=0.00527 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.145 | L2-Norm(final)=3.249 | 1643.4 samples/s | 25.7 steps/s
[Step=27100 Epoch=132.2] | Loss=0.00510 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.144 | L2-Norm(final)=3.250 | 3604.5 samples/s | 56.3 steps/s
[Step=27150 Epoch=132.5] | Loss=0.00497 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.144 | L2-Norm(final)=3.251 | 3549.1 samples/s | 55.5 steps/s
[Step=27200 Epoch=132.7] | Loss=0.00483 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.144 | L2-Norm(final)=3.252 | 3871.8 samples/s | 60.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step27200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.6] | Loss=0.07601 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.182 | L2-Norm(final)=3.237 | 3583.9 samples/s | 56.0 steps/s
[Step=26450 Epoch=128.9] | Loss=0.02366 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.164 | L2-Norm(final)=3.232 | 3482.2 samples/s | 54.4 steps/s
[Step=26500 Epoch=129.1] | Loss=0.01640 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.158 | L2-Norm(final)=3.230 | 3496.0 samples/s | 54.6 steps/s
[Step=26550 Epoch=129.4] | Loss=0.01313 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.155 | L2-Norm(final)=3.231 | 3507.9 samples/s | 54.8 steps/s
[Step=26600 Epoch=129.6] | Loss=0.01164 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.154 | L2-Norm(final)=3.232 | 4298.4 samples/s | 67.2 steps/s
[Step=26650 Epoch=129.9] | Loss=0.01006 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.153 | L2-Norm(final)=3.234 | 1558.3 samples/s | 24.3 steps/s
[Step=26700 Epoch=130.1] | Loss=0.00920 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.152 | L2-Norm(final)=3.235 | 3517.2 samples/s | 55.0 steps/s
[Step=26750 Epoch=130.3] | Loss=0.00834 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.151 | L2-Norm(final)=3.237 | 3511.2 samples/s | 54.9 steps/s
[Step=26800 Epoch=130.6] | Loss=0.00777 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.151 | L2-Norm(final)=3.239 | 4080.4 samples/s | 63.8 steps/s
[Step=26850 Epoch=130.8] | Loss=0.00722 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.151 | L2-Norm(final)=3.240 | 1605.4 samples/s | 25.1 steps/s
[Step=26900 Epoch=131.1] | Loss=0.00697 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.150 | L2-Norm(final)=3.242 | 3512.2 samples/s | 54.9 steps/s
[Step=26950 Epoch=131.3] | Loss=0.00652 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.150 | L2-Norm(final)=3.243 | 3469.0 samples/s | 54.2 steps/s
[Step=27000 Epoch=131.6] | Loss=0.00630 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.150 | L2-Norm(final)=3.245 | 3947.6 samples/s | 61.7 steps/s
[Step=27050 Epoch=131.8] | Loss=0.00601 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.149 | L2-Norm(final)=3.246 | 1633.0 samples/s | 25.5 steps/s
[Step=27100 Epoch=132.0] | Loss=0.00574 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.149 | L2-Norm(final)=3.247 | 3544.4 samples/s | 55.4 steps/s
[Step=27150 Epoch=132.3] | Loss=0.00555 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.149 | L2-Norm(final)=3.249 | 3568.3 samples/s | 55.8 steps/s
[Step=27200 Epoch=132.5] | Loss=0.00540 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.149 | L2-Norm(final)=3.250 | 3767.0 samples/s | 58.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step27200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.7] | Loss=0.12361 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.182 | L2-Norm(final)=3.236 | 3541.0 samples/s | 55.3 steps/s
[Step=26450 Epoch=129.0] | Loss=0.01836 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.165 | L2-Norm(final)=3.232 | 3526.3 samples/s | 55.1 steps/s
[Step=26500 Epoch=129.2] | Loss=0.01307 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.160 | L2-Norm(final)=3.233 | 3512.0 samples/s | 54.9 steps/s
[Step=26550 Epoch=129.5] | Loss=0.01100 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.157 | L2-Norm(final)=3.234 | 3521.2 samples/s | 55.0 steps/s
[Step=26600 Epoch=129.7] | Loss=0.00976 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.155 | L2-Norm(final)=3.235 | 4346.2 samples/s | 67.9 steps/s
[Step=26650 Epoch=130.0] | Loss=0.01005 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.155 | L2-Norm(final)=3.236 | 1546.5 samples/s | 24.2 steps/s
[Step=26700 Epoch=130.2] | Loss=0.00936 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.154 | L2-Norm(final)=3.237 | 3466.8 samples/s | 54.2 steps/s
[Step=26750 Epoch=130.4] | Loss=0.00847 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.153 | L2-Norm(final)=3.238 | 3474.5 samples/s | 54.3 steps/s
[Step=26800 Epoch=130.7] | Loss=0.00772 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.152 | L2-Norm(final)=3.239 | 4072.0 samples/s | 63.6 steps/s
[Step=26850 Epoch=130.9] | Loss=0.00710 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.152 | L2-Norm(final)=3.240 | 1591.4 samples/s | 24.9 steps/s
[Step=26900 Epoch=131.2] | Loss=0.00670 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.151 | L2-Norm(final)=3.241 | 3450.8 samples/s | 53.9 steps/s
[Step=26950 Epoch=131.4] | Loss=0.00652 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.151 | L2-Norm(final)=3.243 | 3478.3 samples/s | 54.3 steps/s
[Step=27000 Epoch=131.7] | Loss=0.00622 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.150 | L2-Norm(final)=3.244 | 3945.8 samples/s | 61.7 steps/s
[Step=27050 Epoch=131.9] | Loss=0.00594 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.150 | L2-Norm(final)=3.245 | 1616.9 samples/s | 25.3 steps/s
[Step=27100 Epoch=132.2] | Loss=0.00574 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.150 | L2-Norm(final)=3.246 | 3503.5 samples/s | 54.7 steps/s
[Step=27150 Epoch=132.4] | Loss=0.00552 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.149 | L2-Norm(final)=3.247 | 3459.7 samples/s | 54.1 steps/s
[Step=27200 Epoch=132.6] | Loss=0.00542 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.149 | L2-Norm(final)=3.248 | 3647.3 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step27200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=129.5] | Loss=0.15894 | Reg=0.00295 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=17.182 | L2-Norm(final)=3.237 | 3711.8 samples/s | 58.0 steps/s
[Step=26450 Epoch=129.7] | Loss=0.02488 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.170 | L2-Norm(final)=3.230 | 3417.2 samples/s | 53.4 steps/s
[Step=26500 Epoch=130.0] | Loss=0.01754 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.166 | L2-Norm(final)=3.230 | 3513.4 samples/s | 54.9 steps/s
[Step=26550 Epoch=130.2] | Loss=0.01447 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.163 | L2-Norm(final)=3.230 | 3528.6 samples/s | 55.1 steps/s
[Step=26600 Epoch=130.4] | Loss=0.01269 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.160 | L2-Norm(final)=3.231 | 4442.3 samples/s | 69.4 steps/s
[Step=26650 Epoch=130.7] | Loss=0.01114 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.159 | L2-Norm(final)=3.232 | 1553.2 samples/s | 24.3 steps/s
[Step=26700 Epoch=130.9] | Loss=0.00993 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.157 | L2-Norm(final)=3.233 | 3476.5 samples/s | 54.3 steps/s
[Step=26750 Epoch=131.2] | Loss=0.00899 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.156 | L2-Norm(final)=3.234 | 3490.2 samples/s | 54.5 steps/s
[Step=26800 Epoch=131.4] | Loss=0.00819 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.155 | L2-Norm(final)=3.236 | 4198.1 samples/s | 65.6 steps/s
[Step=26850 Epoch=131.7] | Loss=0.00749 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.155 | L2-Norm(final)=3.238 | 1575.0 samples/s | 24.6 steps/s
[Step=26900 Epoch=131.9] | Loss=0.00708 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.154 | L2-Norm(final)=3.239 | 3480.4 samples/s | 54.4 steps/s
[Step=26950 Epoch=132.2] | Loss=0.00664 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.153 | L2-Norm(final)=3.241 | 3463.7 samples/s | 54.1 steps/s
[Step=27000 Epoch=132.4] | Loss=0.00631 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.153 | L2-Norm(final)=3.242 | 4023.8 samples/s | 62.9 steps/s
[Step=27050 Epoch=132.6] | Loss=0.00605 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.152 | L2-Norm(final)=3.244 | 1574.4 samples/s | 24.6 steps/s
[Step=27100 Epoch=132.9] | Loss=0.00576 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.152 | L2-Norm(final)=3.245 | 3482.4 samples/s | 54.4 steps/s
[Step=27150 Epoch=133.1] | Loss=0.00552 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.152 | L2-Norm(final)=3.247 | 3691.9 samples/s | 57.7 steps/s
[Step=27200 Epoch=133.4] | Loss=0.00530 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.151 | L2-Norm(final)=3.248 | 4011.8 samples/s | 62.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step27200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=250.2] | Loss=0.02082 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.182 | L2-Norm(final)=3.237 | 3522.2 samples/s | 55.0 steps/s
[Step=26450 Epoch=250.6] | Loss=0.00535 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.138 | L2-Norm(final)=3.240 | 3255.9 samples/s | 50.9 steps/s
[Step=26500 Epoch=251.1] | Loss=0.00279 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.131 | L2-Norm(final)=3.240 | 4165.4 samples/s | 65.1 steps/s
[Step=26550 Epoch=251.6] | Loss=0.00193 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.126 | L2-Norm(final)=3.241 | 1541.4 samples/s | 24.1 steps/s
[Step=26600 Epoch=252.1] | Loss=0.00146 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.123 | L2-Norm(final)=3.242 | 3941.1 samples/s | 61.6 steps/s
[Step=26650 Epoch=252.5] | Loss=0.00118 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.120 | L2-Norm(final)=3.242 | 1554.2 samples/s | 24.3 steps/s
[Step=26700 Epoch=253.0] | Loss=0.00098 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.118 | L2-Norm(final)=3.243 | 3788.9 samples/s | 59.2 steps/s
[Step=26750 Epoch=253.5] | Loss=0.00085 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.116 | L2-Norm(final)=3.243 | 1587.6 samples/s | 24.8 steps/s
[Step=26800 Epoch=254.0] | Loss=0.00074 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.114 | L2-Norm(final)=3.243 | 3537.2 samples/s | 55.3 steps/s
[Step=26850 Epoch=254.4] | Loss=0.00066 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.112 | L2-Norm(final)=3.243 | 1600.1 samples/s | 25.0 steps/s
[Step=26900 Epoch=254.9] | Loss=0.00060 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.110 | L2-Norm(final)=3.243 | 3423.3 samples/s | 53.5 steps/s
[Step=26950 Epoch=255.4] | Loss=0.00055 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.109 | L2-Norm(final)=3.243 | 1640.0 samples/s | 25.6 steps/s
[Step=27000 Epoch=255.8] | Loss=0.00050 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.107 | L2-Norm(final)=3.243 | 3424.3 samples/s | 53.5 steps/s
[Step=27050 Epoch=256.3] | Loss=0.00046 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.106 | L2-Norm(final)=3.243 | 1670.9 samples/s | 26.1 steps/s
[Step=27100 Epoch=256.8] | Loss=0.00043 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.105 | L2-Norm(final)=3.243 | 3385.9 samples/s | 52.9 steps/s
[Step=27150 Epoch=257.3] | Loss=0.00040 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.104 | L2-Norm(final)=3.244 | 1706.5 samples/s | 26.7 steps/s
[Step=27200 Epoch=257.7] | Loss=0.00038 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.102 | L2-Norm(final)=3.244 | 3337.8 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step27200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=251.1] | Loss=0.03518 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.182 | L2-Norm(final)=3.237 | 3567.6 samples/s | 55.7 steps/s
[Step=26450 Epoch=251.6] | Loss=0.00803 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.138 | L2-Norm(final)=3.238 | 3224.4 samples/s | 50.4 steps/s
[Step=26500 Epoch=252.1] | Loss=0.00415 | Reg=0.00294 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.132 | L2-Norm(final)=3.239 | 4363.7 samples/s | 68.2 steps/s
[Step=26550 Epoch=252.6] | Loss=0.00279 | Reg=0.00293 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.127 | L2-Norm(final)=3.239 | 1517.4 samples/s | 23.7 steps/s
[Step=26600 Epoch=253.0] | Loss=0.00210 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.124 | L2-Norm(final)=3.239 | 3933.4 samples/s | 61.5 steps/s
[Step=26650 Epoch=253.5] | Loss=0.00169 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.121 | L2-Norm(final)=3.240 | 1557.0 samples/s | 24.3 steps/s
[Step=26700 Epoch=254.0] | Loss=0.00141 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.119 | L2-Norm(final)=3.240 | 3786.5 samples/s | 59.2 steps/s
[Step=26750 Epoch=254.5] | Loss=0.00121 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.117 | L2-Norm(final)=3.240 | 1601.1 samples/s | 25.0 steps/s
[Step=26800 Epoch=254.9] | Loss=0.00106 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.115 | L2-Norm(final)=3.240 | 3525.7 samples/s | 55.1 steps/s
[Step=26850 Epoch=255.4] | Loss=0.00095 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.113 | L2-Norm(final)=3.240 | 1597.6 samples/s | 25.0 steps/s
[Step=26900 Epoch=255.9] | Loss=0.00086 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.111 | L2-Norm(final)=3.241 | 3411.7 samples/s | 53.3 steps/s
[Step=26950 Epoch=256.4] | Loss=0.00078 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.110 | L2-Norm(final)=3.241 | 1648.6 samples/s | 25.8 steps/s
[Step=27000 Epoch=256.8] | Loss=0.00072 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.109 | L2-Norm(final)=3.241 | 3328.6 samples/s | 52.0 steps/s
[Step=27050 Epoch=257.3] | Loss=0.00066 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.107 | L2-Norm(final)=3.241 | 1670.3 samples/s | 26.1 steps/s
[Step=27100 Epoch=257.8] | Loss=0.00062 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.106 | L2-Norm(final)=3.241 | 3319.3 samples/s | 51.9 steps/s
[Step=27150 Epoch=258.3] | Loss=0.00058 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.105 | L2-Norm(final)=3.241 | 1684.5 samples/s | 26.3 steps/s
[Step=27200 Epoch=258.7] | Loss=0.00054 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.104 | L2-Norm(final)=3.241 | 3415.5 samples/s | 53.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step27200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=252.1] | Loss=0.09938 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.182 | L2-Norm(final)=3.237 | 3677.7 samples/s | 57.5 steps/s
[Step=26450 Epoch=252.6] | Loss=0.00788 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.139 | L2-Norm(final)=3.237 | 3255.0 samples/s | 50.9 steps/s
[Step=26500 Epoch=253.1] | Loss=0.00408 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.132 | L2-Norm(final)=3.237 | 4262.8 samples/s | 66.6 steps/s
[Step=26550 Epoch=253.5] | Loss=0.00275 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.127 | L2-Norm(final)=3.238 | 1510.2 samples/s | 23.6 steps/s
[Step=26600 Epoch=254.0] | Loss=0.00208 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.124 | L2-Norm(final)=3.239 | 4049.5 samples/s | 63.3 steps/s
[Step=26650 Epoch=254.5] | Loss=0.00167 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.121 | L2-Norm(final)=3.239 | 1550.4 samples/s | 24.2 steps/s
[Step=26700 Epoch=255.0] | Loss=0.00140 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.119 | L2-Norm(final)=3.240 | 3889.2 samples/s | 60.8 steps/s
[Step=26750 Epoch=255.4] | Loss=0.00121 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.117 | L2-Norm(final)=3.240 | 1571.8 samples/s | 24.6 steps/s
[Step=26800 Epoch=255.9] | Loss=0.00106 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.115 | L2-Norm(final)=3.240 | 3803.5 samples/s | 59.4 steps/s
[Step=26850 Epoch=256.4] | Loss=0.00094 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.113 | L2-Norm(final)=3.240 | 1611.1 samples/s | 25.2 steps/s
[Step=26900 Epoch=256.9] | Loss=0.00085 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.112 | L2-Norm(final)=3.241 | 3538.5 samples/s | 55.3 steps/s
[Step=26950 Epoch=257.4] | Loss=0.00078 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.110 | L2-Norm(final)=3.241 | 1645.9 samples/s | 25.7 steps/s
[Step=27000 Epoch=257.8] | Loss=0.00071 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.109 | L2-Norm(final)=3.241 | 3414.2 samples/s | 53.3 steps/s
[Step=27050 Epoch=258.3] | Loss=0.00066 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.108 | L2-Norm(final)=3.241 | 1689.6 samples/s | 26.4 steps/s
[Step=27100 Epoch=258.8] | Loss=0.00062 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.107 | L2-Norm(final)=3.241 | 3357.5 samples/s | 52.5 steps/s
[Step=27150 Epoch=259.3] | Loss=0.00058 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.106 | L2-Norm(final)=3.241 | 1640.4 samples/s | 25.6 steps/s
[Step=27200 Epoch=259.7] | Loss=0.00054 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.105 | L2-Norm(final)=3.242 | 3352.9 samples/s | 52.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step27200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=248.8] | Loss=0.06942 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.182 | L2-Norm(final)=3.237 | 3870.5 samples/s | 60.5 steps/s
[Step=26450 Epoch=249.2] | Loss=0.00552 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.138 | L2-Norm(final)=3.241 | 3188.5 samples/s | 49.8 steps/s
[Step=26500 Epoch=249.7] | Loss=0.00284 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.131 | L2-Norm(final)=3.243 | 4183.6 samples/s | 65.4 steps/s
[Step=26550 Epoch=250.2] | Loss=0.00193 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.126 | L2-Norm(final)=3.243 | 1546.6 samples/s | 24.2 steps/s
[Step=26600 Epoch=250.6] | Loss=0.00146 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.123 | L2-Norm(final)=3.244 | 3861.2 samples/s | 60.3 steps/s
[Step=26650 Epoch=251.1] | Loss=0.00117 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.120 | L2-Norm(final)=3.244 | 1576.4 samples/s | 24.6 steps/s
[Step=26700 Epoch=251.6] | Loss=0.00098 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.117 | L2-Norm(final)=3.244 | 3681.5 samples/s | 57.5 steps/s
[Step=26750 Epoch=252.1] | Loss=0.00084 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.115 | L2-Norm(final)=3.244 | 1614.2 samples/s | 25.2 steps/s
[Step=26800 Epoch=252.5] | Loss=0.00074 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.113 | L2-Norm(final)=3.244 | 3493.1 samples/s | 54.6 steps/s
[Step=26850 Epoch=253.0] | Loss=0.00066 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.112 | L2-Norm(final)=3.245 | 1629.6 samples/s | 25.5 steps/s
[Step=26900 Epoch=253.5] | Loss=0.00060 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.110 | L2-Norm(final)=3.245 | 3282.5 samples/s | 51.3 steps/s
[Step=26950 Epoch=253.9] | Loss=0.00055 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.109 | L2-Norm(final)=3.245 | 1642.2 samples/s | 25.7 steps/s
[Step=27000 Epoch=254.4] | Loss=0.00050 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.108 | L2-Norm(final)=3.245 | 3377.6 samples/s | 52.8 steps/s
[Step=27050 Epoch=254.9] | Loss=0.00047 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.106 | L2-Norm(final)=3.245 | 1657.3 samples/s | 25.9 steps/s
[Step=27100 Epoch=255.4] | Loss=0.00043 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.105 | L2-Norm(final)=3.245 | 3418.2 samples/s | 53.4 steps/s
[Step=27150 Epoch=255.8] | Loss=0.00041 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.104 | L2-Norm(final)=3.245 | 1758.5 samples/s | 27.5 steps/s
[Step=27200 Epoch=256.3] | Loss=0.00038 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.103 | L2-Norm(final)=3.245 | 3162.5 samples/s | 49.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step27200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=251.6] | Loss=0.02254 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.182 | L2-Norm(final)=3.237 | 3592.6 samples/s | 56.1 steps/s
[Step=26450 Epoch=252.1] | Loss=0.00562 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.142 | L2-Norm(final)=3.240 | 3165.5 samples/s | 49.5 steps/s
[Step=26500 Epoch=252.6] | Loss=0.00286 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.135 | L2-Norm(final)=3.240 | 4409.1 samples/s | 68.9 steps/s
[Step=26550 Epoch=253.0] | Loss=0.00192 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.130 | L2-Norm(final)=3.240 | 1524.2 samples/s | 23.8 steps/s
[Step=26600 Epoch=253.5] | Loss=0.00145 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.126 | L2-Norm(final)=3.241 | 4067.0 samples/s | 63.5 steps/s
[Step=26650 Epoch=254.0] | Loss=0.00117 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.123 | L2-Norm(final)=3.241 | 1540.4 samples/s | 24.1 steps/s
[Step=26700 Epoch=254.5] | Loss=0.00098 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.121 | L2-Norm(final)=3.241 | 3846.5 samples/s | 60.1 steps/s
[Step=26750 Epoch=255.0] | Loss=0.00084 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.118 | L2-Norm(final)=3.242 | 1574.2 samples/s | 24.6 steps/s
[Step=26800 Epoch=255.4] | Loss=0.00074 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.117 | L2-Norm(final)=3.242 | 3671.8 samples/s | 57.4 steps/s
[Step=26850 Epoch=255.9] | Loss=0.00066 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.115 | L2-Norm(final)=3.242 | 1630.6 samples/s | 25.5 steps/s
[Step=26900 Epoch=256.4] | Loss=0.00060 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.113 | L2-Norm(final)=3.242 | 3653.1 samples/s | 57.1 steps/s
[Step=26950 Epoch=256.9] | Loss=0.00055 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.112 | L2-Norm(final)=3.242 | 1682.7 samples/s | 26.3 steps/s
[Step=27000 Epoch=257.3] | Loss=0.00050 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.111 | L2-Norm(final)=3.243 | 3637.3 samples/s | 56.8 steps/s
[Step=27050 Epoch=257.8] | Loss=0.00047 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.109 | L2-Norm(final)=3.243 | 1701.9 samples/s | 26.6 steps/s
[Step=27100 Epoch=258.3] | Loss=0.00043 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.108 | L2-Norm(final)=3.243 | 3407.5 samples/s | 53.2 steps/s
[Step=27150 Epoch=258.8] | Loss=0.00041 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.107 | L2-Norm(final)=3.243 | 1669.8 samples/s | 26.1 steps/s
[Step=27200 Epoch=259.2] | Loss=0.00038 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.106 | L2-Norm(final)=3.243 | 3363.6 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24151 | acc=0.8649 | tpr=0.8101 | fpr=0.0161 | 3656.0 samples/s | 14.3 steps/s
Avg test loss: 0.24286, Avg test acc: 0.86469, Avg tpr: 0.81028, Avg fpr: 0.01564, total FA: 122

Testing server on iccad2012
[Step=  50] | Loss=0.41949 | acc=0.8692 | tpr=0.9602 | fpr=0.1324 | 3578.9 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.42877 | acc=0.8677 | tpr=0.9616 | fpr=0.1340 | 6858.5 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.43526 | acc=0.8662 | tpr=0.9697 | fpr=0.1357 | 6854.4 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.43568 | acc=0.8671 | tpr=0.9683 | fpr=0.1348 | 6812.9 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.43482 | acc=0.8673 | tpr=0.9703 | fpr=0.1345 | 7433.9 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.43406 | acc=0.8681 | tpr=0.9665 | fpr=0.1337 | 6404.4 samples/s | 25.0 steps/s
[Step= 350] | Loss=0.43598 | acc=0.8681 | tpr=0.9649 | fpr=0.1337 | 7002.4 samples/s | 27.4 steps/s
[Step= 400] | Loss=0.43670 | acc=0.8680 | tpr=0.9639 | fpr=0.1338 | 6599.7 samples/s | 25.8 steps/s
[Step= 450] | Loss=0.44047 | acc=0.8673 | tpr=0.9635 | fpr=0.1345 | 6800.8 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.44105 | acc=0.8670 | tpr=0.9648 | fpr=0.1348 | 6943.8 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.44007 | acc=0.8671 | tpr=0.9658 | fpr=0.1347 | 12115.2 samples/s | 47.3 steps/s
Avg test loss: 0.43987, Avg test acc: 0.86712, Avg tpr: 0.96593, Avg fpr: 0.13467, total FA: 18699

server round 34/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.6] | Loss=0.07315 | Reg=0.00293 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.109 | L2-Norm(final)=3.256 | 3657.8 samples/s | 57.2 steps/s
[Step=27250 Epoch=132.9] | Loss=0.02105 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.092 | L2-Norm(final)=3.253 | 3551.1 samples/s | 55.5 steps/s
[Step=27300 Epoch=133.1] | Loss=0.01488 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.085 | L2-Norm(final)=3.252 | 3495.0 samples/s | 54.6 steps/s
[Step=27350 Epoch=133.4] | Loss=0.01159 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.081 | L2-Norm(final)=3.254 | 3505.9 samples/s | 54.8 steps/s
[Step=27400 Epoch=133.6] | Loss=0.01121 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.080 | L2-Norm(final)=3.255 | 4401.4 samples/s | 68.8 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00973 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.079 | L2-Norm(final)=3.257 | 1595.5 samples/s | 24.9 steps/s
[Step=27500 Epoch=134.1] | Loss=0.00882 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.078 | L2-Norm(final)=3.258 | 3551.2 samples/s | 55.5 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00820 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.077 | L2-Norm(final)=3.259 | 3512.4 samples/s | 54.9 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00763 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.076 | L2-Norm(final)=3.261 | 4113.7 samples/s | 64.3 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00721 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.076 | L2-Norm(final)=3.262 | 1623.1 samples/s | 25.4 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00681 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.075 | L2-Norm(final)=3.263 | 3517.5 samples/s | 55.0 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00650 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.075 | L2-Norm(final)=3.265 | 3504.8 samples/s | 54.8 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00631 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.074 | L2-Norm(final)=3.266 | 3926.8 samples/s | 61.4 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00604 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.074 | L2-Norm(final)=3.267 | 1689.7 samples/s | 26.4 steps/s
[Step=27900 Epoch=136.0] | Loss=0.00582 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.073 | L2-Norm(final)=3.268 | 3543.7 samples/s | 55.4 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00563 | Reg=0.00291 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.073 | L2-Norm(final)=3.270 | 3447.1 samples/s | 53.9 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00552 | Reg=0.00291 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.073 | L2-Norm(final)=3.271 | 3752.5 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step28000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.7] | Loss=0.12612 | Reg=0.00293 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.109 | L2-Norm(final)=3.255 | 3527.6 samples/s | 55.1 steps/s
[Step=27250 Epoch=133.0] | Loss=0.01940 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.092 | L2-Norm(final)=3.250 | 3461.7 samples/s | 54.1 steps/s
[Step=27300 Epoch=133.2] | Loss=0.01371 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.085 | L2-Norm(final)=3.249 | 3483.4 samples/s | 54.4 steps/s
[Step=27350 Epoch=133.5] | Loss=0.01192 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.082 | L2-Norm(final)=3.250 | 3551.8 samples/s | 55.5 steps/s
[Step=27400 Epoch=133.7] | Loss=0.01021 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.080 | L2-Norm(final)=3.251 | 4346.1 samples/s | 67.9 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00911 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.079 | L2-Norm(final)=3.252 | 1560.9 samples/s | 24.4 steps/s
[Step=27500 Epoch=134.2] | Loss=0.00822 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.078 | L2-Norm(final)=3.254 | 3563.5 samples/s | 55.7 steps/s
[Step=27550 Epoch=134.4] | Loss=0.00745 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.077 | L2-Norm(final)=3.255 | 3462.3 samples/s | 54.1 steps/s
[Step=27600 Epoch=134.7] | Loss=0.00689 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.076 | L2-Norm(final)=3.257 | 4171.3 samples/s | 65.2 steps/s
[Step=27650 Epoch=134.9] | Loss=0.00640 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.075 | L2-Norm(final)=3.258 | 1594.3 samples/s | 24.9 steps/s
[Step=27700 Epoch=135.2] | Loss=0.00603 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.075 | L2-Norm(final)=3.259 | 3609.7 samples/s | 56.4 steps/s
[Step=27750 Epoch=135.4] | Loss=0.00577 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.074 | L2-Norm(final)=3.261 | 3662.7 samples/s | 57.2 steps/s
[Step=27800 Epoch=135.7] | Loss=0.00559 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.074 | L2-Norm(final)=3.262 | 4030.2 samples/s | 63.0 steps/s
[Step=27850 Epoch=135.9] | Loss=0.00540 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.073 | L2-Norm(final)=3.263 | 1622.1 samples/s | 25.3 steps/s
[Step=27900 Epoch=136.1] | Loss=0.00520 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.073 | L2-Norm(final)=3.264 | 3552.8 samples/s | 55.5 steps/s
[Step=27950 Epoch=136.4] | Loss=0.00501 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.073 | L2-Norm(final)=3.266 | 3488.4 samples/s | 54.5 steps/s
[Step=28000 Epoch=136.6] | Loss=0.00485 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.072 | L2-Norm(final)=3.267 | 3831.5 samples/s | 59.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step28000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.5] | Loss=0.09398 | Reg=0.00293 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.109 | L2-Norm(final)=3.256 | 3940.4 samples/s | 61.6 steps/s
[Step=27250 Epoch=132.8] | Loss=0.01952 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.088 | L2-Norm(final)=3.253 | 3140.8 samples/s | 49.1 steps/s
[Step=27300 Epoch=133.0] | Loss=0.01458 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.084 | L2-Norm(final)=3.252 | 3488.0 samples/s | 54.5 steps/s
[Step=27350 Epoch=133.3] | Loss=0.01214 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.081 | L2-Norm(final)=3.253 | 3464.3 samples/s | 54.1 steps/s
[Step=27400 Epoch=133.5] | Loss=0.01106 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.079 | L2-Norm(final)=3.253 | 4376.6 samples/s | 68.4 steps/s
[Step=27450 Epoch=133.7] | Loss=0.01007 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.078 | L2-Norm(final)=3.254 | 1588.6 samples/s | 24.8 steps/s
[Step=27500 Epoch=134.0] | Loss=0.00931 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.077 | L2-Norm(final)=3.255 | 3592.2 samples/s | 56.1 steps/s
[Step=27550 Epoch=134.2] | Loss=0.00828 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.077 | L2-Norm(final)=3.256 | 3524.2 samples/s | 55.1 steps/s
[Step=27600 Epoch=134.5] | Loss=0.00785 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.076 | L2-Norm(final)=3.258 | 4095.2 samples/s | 64.0 steps/s
[Step=27650 Epoch=134.7] | Loss=0.00740 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.076 | L2-Norm(final)=3.259 | 1621.1 samples/s | 25.3 steps/s
[Step=27700 Epoch=135.0] | Loss=0.00696 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.075 | L2-Norm(final)=3.261 | 3686.5 samples/s | 57.6 steps/s
[Step=27750 Epoch=135.2] | Loss=0.00659 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.075 | L2-Norm(final)=3.262 | 3748.2 samples/s | 58.6 steps/s
[Step=27800 Epoch=135.5] | Loss=0.00632 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.075 | L2-Norm(final)=3.264 | 4032.8 samples/s | 63.0 steps/s
[Step=27850 Epoch=135.7] | Loss=0.00618 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.074 | L2-Norm(final)=3.265 | 1576.3 samples/s | 24.6 steps/s
[Step=27900 Epoch=135.9] | Loss=0.00588 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.074 | L2-Norm(final)=3.267 | 3430.3 samples/s | 53.6 steps/s
[Step=27950 Epoch=136.2] | Loss=0.00564 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.074 | L2-Norm(final)=3.268 | 3569.0 samples/s | 55.8 steps/s
[Step=28000 Epoch=136.4] | Loss=0.00553 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.074 | L2-Norm(final)=3.269 | 3588.8 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step28000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.6] | Loss=0.14585 | Reg=0.00293 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.109 | L2-Norm(final)=3.255 | 3494.2 samples/s | 54.6 steps/s
[Step=27250 Epoch=132.9] | Loss=0.02010 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.096 | L2-Norm(final)=3.252 | 3208.8 samples/s | 50.1 steps/s
[Step=27300 Epoch=133.1] | Loss=0.01286 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.093 | L2-Norm(final)=3.253 | 3369.5 samples/s | 52.6 steps/s
[Step=27350 Epoch=133.4] | Loss=0.01122 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.090 | L2-Norm(final)=3.255 | 3484.7 samples/s | 54.4 steps/s
[Step=27400 Epoch=133.6] | Loss=0.01017 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.089 | L2-Norm(final)=3.256 | 4351.8 samples/s | 68.0 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00941 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.087 | L2-Norm(final)=3.258 | 1583.7 samples/s | 24.7 steps/s
[Step=27500 Epoch=134.1] | Loss=0.00860 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.086 | L2-Norm(final)=3.259 | 3492.1 samples/s | 54.6 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00787 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.085 | L2-Norm(final)=3.260 | 3522.2 samples/s | 55.0 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00714 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.085 | L2-Norm(final)=3.262 | 4144.6 samples/s | 64.8 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00665 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.084 | L2-Norm(final)=3.263 | 1602.7 samples/s | 25.0 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00624 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.083 | L2-Norm(final)=3.264 | 3509.9 samples/s | 54.8 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00591 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.083 | L2-Norm(final)=3.266 | 3387.3 samples/s | 52.9 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00565 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.082 | L2-Norm(final)=3.267 | 3817.9 samples/s | 59.7 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00541 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.081 | L2-Norm(final)=3.268 | 1646.8 samples/s | 25.7 steps/s
[Step=27900 Epoch=136.1] | Loss=0.00515 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.081 | L2-Norm(final)=3.270 | 3515.2 samples/s | 54.9 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00508 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.080 | L2-Norm(final)=3.271 | 3496.8 samples/s | 54.6 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00494 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.080 | L2-Norm(final)=3.272 | 3763.9 samples/s | 58.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step28000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=133.4] | Loss=0.04522 | Reg=0.00293 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.109 | L2-Norm(final)=3.256 | 3592.2 samples/s | 56.1 steps/s
[Step=27250 Epoch=133.6] | Loss=0.01969 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.091 | L2-Norm(final)=3.251 | 3480.2 samples/s | 54.4 steps/s
[Step=27300 Epoch=133.9] | Loss=0.01403 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.086 | L2-Norm(final)=3.251 | 3513.0 samples/s | 54.9 steps/s
[Step=27350 Epoch=134.1] | Loss=0.01218 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.083 | L2-Norm(final)=3.252 | 3522.3 samples/s | 55.0 steps/s
[Step=27400 Epoch=134.4] | Loss=0.01096 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.081 | L2-Norm(final)=3.252 | 4473.2 samples/s | 69.9 steps/s
[Step=27450 Epoch=134.6] | Loss=0.00948 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.080 | L2-Norm(final)=3.254 | 1572.2 samples/s | 24.6 steps/s
[Step=27500 Epoch=134.9] | Loss=0.00861 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.080 | L2-Norm(final)=3.256 | 3478.6 samples/s | 54.4 steps/s
[Step=27550 Epoch=135.1] | Loss=0.00771 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.079 | L2-Norm(final)=3.257 | 3571.7 samples/s | 55.8 steps/s
[Step=27600 Epoch=135.3] | Loss=0.00725 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.078 | L2-Norm(final)=3.259 | 4445.8 samples/s | 69.5 steps/s
[Step=27650 Epoch=135.6] | Loss=0.00681 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.078 | L2-Norm(final)=3.261 | 1585.0 samples/s | 24.8 steps/s
[Step=27700 Epoch=135.8] | Loss=0.00637 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.077 | L2-Norm(final)=3.262 | 3544.6 samples/s | 55.4 steps/s
[Step=27750 Epoch=136.1] | Loss=0.00607 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.077 | L2-Norm(final)=3.264 | 3561.3 samples/s | 55.6 steps/s
[Step=27800 Epoch=136.3] | Loss=0.00580 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.076 | L2-Norm(final)=3.265 | 4179.7 samples/s | 65.3 steps/s
[Step=27850 Epoch=136.6] | Loss=0.00562 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.076 | L2-Norm(final)=3.267 | 1594.8 samples/s | 24.9 steps/s
[Step=27900 Epoch=136.8] | Loss=0.00541 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.076 | L2-Norm(final)=3.268 | 3474.4 samples/s | 54.3 steps/s
[Step=27950 Epoch=137.1] | Loss=0.00520 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.075 | L2-Norm(final)=3.269 | 3517.5 samples/s | 55.0 steps/s
[Step=28000 Epoch=137.3] | Loss=0.00502 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.075 | L2-Norm(final)=3.271 | 3930.8 samples/s | 61.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step28000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=257.8] | Loss=0.01069 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.109 | L2-Norm(final)=3.256 | 3599.0 samples/s | 56.2 steps/s
[Step=27250 Epoch=258.2] | Loss=0.00413 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.065 | L2-Norm(final)=3.261 | 3256.1 samples/s | 50.9 steps/s
[Step=27300 Epoch=258.7] | Loss=0.00210 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.058 | L2-Norm(final)=3.262 | 4190.9 samples/s | 65.5 steps/s
[Step=27350 Epoch=259.2] | Loss=0.00141 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.053 | L2-Norm(final)=3.263 | 1511.0 samples/s | 23.6 steps/s
[Step=27400 Epoch=259.6] | Loss=0.00107 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.049 | L2-Norm(final)=3.263 | 3896.4 samples/s | 60.9 steps/s
[Step=27450 Epoch=260.1] | Loss=0.00086 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.046 | L2-Norm(final)=3.263 | 1579.7 samples/s | 24.7 steps/s
[Step=27500 Epoch=260.6] | Loss=0.00072 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.043 | L2-Norm(final)=3.263 | 3816.0 samples/s | 59.6 steps/s
[Step=27550 Epoch=261.1] | Loss=0.00062 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.041 | L2-Norm(final)=3.263 | 1623.7 samples/s | 25.4 steps/s
[Step=27600 Epoch=261.5] | Loss=0.00055 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.039 | L2-Norm(final)=3.263 | 3645.0 samples/s | 57.0 steps/s
[Step=27650 Epoch=262.0] | Loss=0.00049 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.037 | L2-Norm(final)=3.263 | 1614.7 samples/s | 25.2 steps/s
[Step=27700 Epoch=262.5] | Loss=0.00044 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.036 | L2-Norm(final)=3.263 | 3480.3 samples/s | 54.4 steps/s
[Step=27750 Epoch=263.0] | Loss=0.00040 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.034 | L2-Norm(final)=3.263 | 1693.8 samples/s | 26.5 steps/s
[Step=27800 Epoch=263.4] | Loss=0.00037 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.033 | L2-Norm(final)=3.263 | 3491.1 samples/s | 54.5 steps/s
[Step=27850 Epoch=263.9] | Loss=0.00034 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.032 | L2-Norm(final)=3.263 | 1669.5 samples/s | 26.1 steps/s
[Step=27900 Epoch=264.4] | Loss=0.00032 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.031 | L2-Norm(final)=3.263 | 3437.4 samples/s | 53.7 steps/s
[Step=27950 Epoch=264.9] | Loss=0.00030 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.029 | L2-Norm(final)=3.263 | 1699.8 samples/s | 26.6 steps/s
[Step=28000 Epoch=265.3] | Loss=0.00028 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.028 | L2-Norm(final)=3.263 | 3361.2 samples/s | 52.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step28000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=258.7] | Loss=0.04815 | Reg=0.00293 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.109 | L2-Norm(final)=3.256 | 3627.8 samples/s | 56.7 steps/s
[Step=27250 Epoch=259.2] | Loss=0.00466 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.064 | L2-Norm(final)=3.261 | 3249.7 samples/s | 50.8 steps/s
[Step=27300 Epoch=259.7] | Loss=0.00240 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.057 | L2-Norm(final)=3.262 | 4261.1 samples/s | 66.6 steps/s
[Step=27350 Epoch=260.2] | Loss=0.00162 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.052 | L2-Norm(final)=3.263 | 1557.8 samples/s | 24.3 steps/s
[Step=27400 Epoch=260.6] | Loss=0.00123 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.049 | L2-Norm(final)=3.263 | 4113.4 samples/s | 64.3 steps/s
[Step=27450 Epoch=261.1] | Loss=0.00099 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.046 | L2-Norm(final)=3.263 | 1575.8 samples/s | 24.6 steps/s
[Step=27500 Epoch=261.6] | Loss=0.00083 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.043 | L2-Norm(final)=3.263 | 3770.1 samples/s | 58.9 steps/s
[Step=27550 Epoch=262.1] | Loss=0.00072 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.041 | L2-Norm(final)=3.264 | 1593.3 samples/s | 24.9 steps/s
[Step=27600 Epoch=262.5] | Loss=0.00063 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.039 | L2-Norm(final)=3.264 | 3608.1 samples/s | 56.4 steps/s
[Step=27650 Epoch=263.0] | Loss=0.00056 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.038 | L2-Norm(final)=3.264 | 1631.3 samples/s | 25.5 steps/s
[Step=27700 Epoch=263.5] | Loss=0.00051 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.036 | L2-Norm(final)=3.264 | 3378.4 samples/s | 52.8 steps/s
[Step=27750 Epoch=264.0] | Loss=0.00046 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.035 | L2-Norm(final)=3.264 | 1670.0 samples/s | 26.1 steps/s
[Step=27800 Epoch=264.4] | Loss=0.00043 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.033 | L2-Norm(final)=3.264 | 3362.3 samples/s | 52.5 steps/s
[Step=27850 Epoch=264.9] | Loss=0.00040 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.032 | L2-Norm(final)=3.264 | 1677.8 samples/s | 26.2 steps/s
[Step=27900 Epoch=265.4] | Loss=0.00037 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.031 | L2-Norm(final)=3.264 | 3316.7 samples/s | 51.8 steps/s
[Step=27950 Epoch=265.9] | Loss=0.00035 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.030 | L2-Norm(final)=3.264 | 1692.5 samples/s | 26.4 steps/s
[Step=28000 Epoch=266.3] | Loss=0.00033 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.029 | L2-Norm(final)=3.264 | 3389.4 samples/s | 53.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step28000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=259.8] | Loss=0.13544 | Reg=0.00293 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=17.109 | L2-Norm(final)=3.256 | 3491.2 samples/s | 54.6 steps/s
[Step=27250 Epoch=260.2] | Loss=0.00493 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.064 | L2-Norm(final)=3.260 | 3281.1 samples/s | 51.3 steps/s
[Step=27300 Epoch=260.7] | Loss=0.00249 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.056 | L2-Norm(final)=3.260 | 4297.0 samples/s | 67.1 steps/s
[Step=27350 Epoch=261.2] | Loss=0.00168 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.051 | L2-Norm(final)=3.261 | 1533.1 samples/s | 24.0 steps/s
[Step=27400 Epoch=261.7] | Loss=0.00127 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.047 | L2-Norm(final)=3.261 | 3964.8 samples/s | 61.9 steps/s
[Step=27450 Epoch=262.1] | Loss=0.00102 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.044 | L2-Norm(final)=3.261 | 1543.0 samples/s | 24.1 steps/s
[Step=27500 Epoch=262.6] | Loss=0.00085 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.042 | L2-Norm(final)=3.261 | 3922.3 samples/s | 61.3 steps/s
[Step=27550 Epoch=263.1] | Loss=0.00073 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.040 | L2-Norm(final)=3.261 | 1576.4 samples/s | 24.6 steps/s
[Step=27600 Epoch=263.6] | Loss=0.00065 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.038 | L2-Norm(final)=3.261 | 3658.6 samples/s | 57.2 steps/s
[Step=27650 Epoch=264.0] | Loss=0.00058 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.036 | L2-Norm(final)=3.261 | 1605.2 samples/s | 25.1 steps/s
[Step=27700 Epoch=264.5] | Loss=0.00052 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.034 | L2-Norm(final)=3.261 | 3516.2 samples/s | 54.9 steps/s
[Step=27750 Epoch=265.0] | Loss=0.00047 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.033 | L2-Norm(final)=3.261 | 1620.2 samples/s | 25.3 steps/s
[Step=27800 Epoch=265.5] | Loss=0.00044 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.032 | L2-Norm(final)=3.261 | 3393.3 samples/s | 53.0 steps/s
[Step=27850 Epoch=266.0] | Loss=0.00040 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.030 | L2-Norm(final)=3.261 | 1658.2 samples/s | 25.9 steps/s
[Step=27900 Epoch=266.4] | Loss=0.00038 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.029 | L2-Norm(final)=3.261 | 3424.4 samples/s | 53.5 steps/s
[Step=27950 Epoch=266.9] | Loss=0.00035 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.028 | L2-Norm(final)=3.261 | 1664.3 samples/s | 26.0 steps/s
[Step=28000 Epoch=267.4] | Loss=0.00033 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.027 | L2-Norm(final)=3.261 | 3372.6 samples/s | 52.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step28000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=256.3] | Loss=0.06830 | Reg=0.00293 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.109 | L2-Norm(final)=3.256 | 3522.5 samples/s | 55.0 steps/s
[Step=27250 Epoch=256.8] | Loss=0.00298 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.064 | L2-Norm(final)=3.263 | 3373.2 samples/s | 52.7 steps/s
[Step=27300 Epoch=257.2] | Loss=0.00154 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.056 | L2-Norm(final)=3.265 | 4193.2 samples/s | 65.5 steps/s
[Step=27350 Epoch=257.7] | Loss=0.00105 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.051 | L2-Norm(final)=3.266 | 1538.3 samples/s | 24.0 steps/s
[Step=27400 Epoch=258.2] | Loss=0.00079 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.048 | L2-Norm(final)=3.267 | 3931.7 samples/s | 61.4 steps/s
[Step=27450 Epoch=258.7] | Loss=0.00064 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.045 | L2-Norm(final)=3.267 | 1558.4 samples/s | 24.3 steps/s
[Step=27500 Epoch=259.1] | Loss=0.00054 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.043 | L2-Norm(final)=3.267 | 3694.3 samples/s | 57.7 steps/s
[Step=27550 Epoch=259.6] | Loss=0.00046 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.040 | L2-Norm(final)=3.267 | 1594.1 samples/s | 24.9 steps/s
[Step=27600 Epoch=260.1] | Loss=0.00041 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.039 | L2-Norm(final)=3.267 | 3461.4 samples/s | 54.1 steps/s
[Step=27650 Epoch=260.5] | Loss=0.00037 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.037 | L2-Norm(final)=3.267 | 1630.7 samples/s | 25.5 steps/s
[Step=27700 Epoch=261.0] | Loss=0.00033 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.035 | L2-Norm(final)=3.267 | 3431.5 samples/s | 53.6 steps/s
[Step=27750 Epoch=261.5] | Loss=0.00030 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.034 | L2-Norm(final)=3.268 | 1723.0 samples/s | 26.9 steps/s
[Step=27800 Epoch=262.0] | Loss=0.00028 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.032 | L2-Norm(final)=3.268 | 3390.9 samples/s | 53.0 steps/s
[Step=27850 Epoch=262.4] | Loss=0.00026 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.031 | L2-Norm(final)=3.268 | 1679.4 samples/s | 26.2 steps/s
[Step=27900 Epoch=262.9] | Loss=0.00024 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.030 | L2-Norm(final)=3.268 | 3315.3 samples/s | 51.8 steps/s
[Step=27950 Epoch=263.4] | Loss=0.00023 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.029 | L2-Norm(final)=3.268 | 1703.7 samples/s | 26.6 steps/s
[Step=28000 Epoch=263.8] | Loss=0.00021 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.028 | L2-Norm(final)=3.268 | 3259.4 samples/s | 50.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step28000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=259.3] | Loss=0.08489 | Reg=0.00293 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.109 | L2-Norm(final)=3.256 | 3510.6 samples/s | 54.9 steps/s
[Step=27250 Epoch=259.7] | Loss=0.00785 | Reg=0.00291 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.070 | L2-Norm(final)=3.259 | 3431.0 samples/s | 53.6 steps/s
[Step=27300 Epoch=260.2] | Loss=0.00410 | Reg=0.00291 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.063 | L2-Norm(final)=3.260 | 4229.3 samples/s | 66.1 steps/s
[Step=27350 Epoch=260.7] | Loss=0.00275 | Reg=0.00291 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.058 | L2-Norm(final)=3.260 | 1476.2 samples/s | 23.1 steps/s
[Step=27400 Epoch=261.1] | Loss=0.00208 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.054 | L2-Norm(final)=3.260 | 3987.3 samples/s | 62.3 steps/s
[Step=27450 Epoch=261.6] | Loss=0.00167 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.051 | L2-Norm(final)=3.261 | 1552.1 samples/s | 24.3 steps/s
[Step=27500 Epoch=262.1] | Loss=0.00140 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.049 | L2-Norm(final)=3.261 | 3845.7 samples/s | 60.1 steps/s
[Step=27550 Epoch=262.6] | Loss=0.00120 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.046 | L2-Norm(final)=3.261 | 1593.0 samples/s | 24.9 steps/s
[Step=27600 Epoch=263.1] | Loss=0.00106 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.044 | L2-Norm(final)=3.261 | 3605.3 samples/s | 56.3 steps/s
[Step=27650 Epoch=263.5] | Loss=0.00094 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.043 | L2-Norm(final)=3.261 | 1579.4 samples/s | 24.7 steps/s
[Step=27700 Epoch=264.0] | Loss=0.00085 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.041 | L2-Norm(final)=3.262 | 3518.1 samples/s | 55.0 steps/s
[Step=27750 Epoch=264.5] | Loss=0.00078 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.039 | L2-Norm(final)=3.262 | 1641.4 samples/s | 25.6 steps/s
[Step=27800 Epoch=265.0] | Loss=0.00072 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.038 | L2-Norm(final)=3.262 | 3400.0 samples/s | 53.1 steps/s
[Step=27850 Epoch=265.4] | Loss=0.00066 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.037 | L2-Norm(final)=3.262 | 1643.5 samples/s | 25.7 steps/s
[Step=27900 Epoch=265.9] | Loss=0.00062 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.036 | L2-Norm(final)=3.262 | 3408.5 samples/s | 53.3 steps/s
[Step=27950 Epoch=266.4] | Loss=0.00058 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.034 | L2-Norm(final)=3.262 | 1729.4 samples/s | 27.0 steps/s
[Step=28000 Epoch=266.9] | Loss=0.00054 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.033 | L2-Norm(final)=3.262 | 3449.8 samples/s | 53.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22976 | acc=0.8755 | tpr=0.8258 | fpr=0.0164 | 3659.1 samples/s | 14.3 steps/s
Avg test loss: 0.23191, Avg test acc: 0.87475, Avg tpr: 0.82503, Avg fpr: 0.01590, total FA: 124

Testing server on iccad2012
[Step=  50] | Loss=0.43268 | acc=0.8656 | tpr=0.9602 | fpr=0.1361 | 3707.8 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.44175 | acc=0.8635 | tpr=0.9616 | fpr=0.1383 | 6783.9 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.44847 | acc=0.8618 | tpr=0.9669 | fpr=0.1401 | 6949.8 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.44891 | acc=0.8624 | tpr=0.9661 | fpr=0.1395 | 7100.7 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.44767 | acc=0.8627 | tpr=0.9686 | fpr=0.1392 | 6832.6 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.44670 | acc=0.8633 | tpr=0.9644 | fpr=0.1385 | 6984.4 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.44858 | acc=0.8632 | tpr=0.9631 | fpr=0.1386 | 6940.7 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.44925 | acc=0.8634 | tpr=0.9617 | fpr=0.1384 | 6883.0 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.45319 | acc=0.8628 | tpr=0.9620 | fpr=0.1390 | 6768.1 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.45374 | acc=0.8626 | tpr=0.9634 | fpr=0.1393 | 6742.9 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.45273 | acc=0.8627 | tpr=0.9646 | fpr=0.1392 | 11844.0 samples/s | 46.3 steps/s
Avg test loss: 0.45254, Avg test acc: 0.86267, Avg tpr: 0.96474, Avg fpr: 0.13919, total FA: 19326

server round 35/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.5] | Loss=0.11415 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.036 | L2-Norm(final)=3.276 | 3705.3 samples/s | 57.9 steps/s
[Step=28050 Epoch=136.8] | Loss=0.02076 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.020 | L2-Norm(final)=3.271 | 3347.0 samples/s | 52.3 steps/s
[Step=28100 Epoch=137.0] | Loss=0.01514 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.015 | L2-Norm(final)=3.271 | 3477.6 samples/s | 54.3 steps/s
[Step=28150 Epoch=137.3] | Loss=0.01267 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.012 | L2-Norm(final)=3.272 | 3450.9 samples/s | 53.9 steps/s
[Step=28200 Epoch=137.5] | Loss=0.01130 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.010 | L2-Norm(final)=3.273 | 4316.3 samples/s | 67.4 steps/s
[Step=28250 Epoch=137.8] | Loss=0.00980 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.009 | L2-Norm(final)=3.275 | 1574.9 samples/s | 24.6 steps/s
[Step=28300 Epoch=138.0] | Loss=0.00874 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.008 | L2-Norm(final)=3.276 | 3565.8 samples/s | 55.7 steps/s
[Step=28350 Epoch=138.2] | Loss=0.00794 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.007 | L2-Norm(final)=3.278 | 3710.2 samples/s | 58.0 steps/s
[Step=28400 Epoch=138.5] | Loss=0.00749 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.006 | L2-Norm(final)=3.279 | 4204.7 samples/s | 65.7 steps/s
[Step=28450 Epoch=138.7] | Loss=0.00694 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.006 | L2-Norm(final)=3.281 | 1592.3 samples/s | 24.9 steps/s
[Step=28500 Epoch=139.0] | Loss=0.00658 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.005 | L2-Norm(final)=3.283 | 3714.9 samples/s | 58.0 steps/s
[Step=28550 Epoch=139.2] | Loss=0.00619 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.005 | L2-Norm(final)=3.284 | 3585.6 samples/s | 56.0 steps/s
[Step=28600 Epoch=139.5] | Loss=0.00603 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.004 | L2-Norm(final)=3.286 | 3969.1 samples/s | 62.0 steps/s
[Step=28650 Epoch=139.7] | Loss=0.00585 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.004 | L2-Norm(final)=3.287 | 1633.4 samples/s | 25.5 steps/s
[Step=28700 Epoch=139.9] | Loss=0.00561 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.004 | L2-Norm(final)=3.289 | 3531.8 samples/s | 55.2 steps/s
[Step=28750 Epoch=140.2] | Loss=0.00544 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.004 | L2-Norm(final)=3.290 | 3524.6 samples/s | 55.1 steps/s
[Step=28800 Epoch=140.4] | Loss=0.00537 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.003 | L2-Norm(final)=3.291 | 3708.2 samples/s | 57.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step28800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.6] | Loss=0.14876 | Reg=0.00290 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=17.036 | L2-Norm(final)=3.276 | 3633.1 samples/s | 56.8 steps/s
[Step=28050 Epoch=136.9] | Loss=0.02165 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.019 | L2-Norm(final)=3.269 | 3493.4 samples/s | 54.6 steps/s
[Step=28100 Epoch=137.1] | Loss=0.01435 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.013 | L2-Norm(final)=3.269 | 3469.7 samples/s | 54.2 steps/s
[Step=28150 Epoch=137.4] | Loss=0.01144 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.010 | L2-Norm(final)=3.269 | 3518.4 samples/s | 55.0 steps/s
[Step=28200 Epoch=137.6] | Loss=0.00996 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.008 | L2-Norm(final)=3.270 | 4470.8 samples/s | 69.9 steps/s
[Step=28250 Epoch=137.8] | Loss=0.00843 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.007 | L2-Norm(final)=3.272 | 1566.5 samples/s | 24.5 steps/s
[Step=28300 Epoch=138.1] | Loss=0.00777 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.005 | L2-Norm(final)=3.273 | 3508.3 samples/s | 54.8 steps/s
[Step=28350 Epoch=138.3] | Loss=0.00713 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.004 | L2-Norm(final)=3.275 | 3510.2 samples/s | 54.8 steps/s
[Step=28400 Epoch=138.6] | Loss=0.00658 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.003 | L2-Norm(final)=3.276 | 4193.1 samples/s | 65.5 steps/s
[Step=28450 Epoch=138.8] | Loss=0.00626 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.003 | L2-Norm(final)=3.278 | 1616.9 samples/s | 25.3 steps/s
[Step=28500 Epoch=139.1] | Loss=0.00609 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.002 | L2-Norm(final)=3.279 | 3533.0 samples/s | 55.2 steps/s
[Step=28550 Epoch=139.3] | Loss=0.00577 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.001 | L2-Norm(final)=3.280 | 3524.1 samples/s | 55.1 steps/s
[Step=28600 Epoch=139.6] | Loss=0.00556 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.001 | L2-Norm(final)=3.281 | 4051.8 samples/s | 63.3 steps/s
[Step=28650 Epoch=139.8] | Loss=0.00540 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.000 | L2-Norm(final)=3.282 | 1621.6 samples/s | 25.3 steps/s
[Step=28700 Epoch=140.0] | Loss=0.00517 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.999 | L2-Norm(final)=3.283 | 3501.4 samples/s | 54.7 steps/s
[Step=28750 Epoch=140.3] | Loss=0.00508 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.999 | L2-Norm(final)=3.284 | 3597.0 samples/s | 56.2 steps/s
[Step=28800 Epoch=140.5] | Loss=0.00493 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.999 | L2-Norm(final)=3.285 | 3987.3 samples/s | 62.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step28800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.4] | Loss=0.06885 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.036 | L2-Norm(final)=3.276 | 3750.7 samples/s | 58.6 steps/s
[Step=28050 Epoch=136.7] | Loss=0.01866 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.017 | L2-Norm(final)=3.273 | 3420.3 samples/s | 53.4 steps/s
[Step=28100 Epoch=136.9] | Loss=0.01368 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.012 | L2-Norm(final)=3.272 | 3590.5 samples/s | 56.1 steps/s
[Step=28150 Epoch=137.2] | Loss=0.01128 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.009 | L2-Norm(final)=3.273 | 3630.3 samples/s | 56.7 steps/s
[Step=28200 Epoch=137.4] | Loss=0.00985 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.008 | L2-Norm(final)=3.275 | 4295.6 samples/s | 67.1 steps/s
[Step=28250 Epoch=137.6] | Loss=0.00861 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.007 | L2-Norm(final)=3.277 | 1556.1 samples/s | 24.3 steps/s
[Step=28300 Epoch=137.9] | Loss=0.00774 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.006 | L2-Norm(final)=3.279 | 3498.7 samples/s | 54.7 steps/s
[Step=28350 Epoch=138.1] | Loss=0.00727 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.005 | L2-Norm(final)=3.281 | 3502.1 samples/s | 54.7 steps/s
[Step=28400 Epoch=138.4] | Loss=0.00690 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.005 | L2-Norm(final)=3.283 | 4047.7 samples/s | 63.2 steps/s
[Step=28450 Epoch=138.6] | Loss=0.00650 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.005 | L2-Norm(final)=3.284 | 1595.3 samples/s | 24.9 steps/s
[Step=28500 Epoch=138.9] | Loss=0.00616 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.005 | L2-Norm(final)=3.286 | 3532.5 samples/s | 55.2 steps/s
[Step=28550 Epoch=139.1] | Loss=0.00583 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.004 | L2-Norm(final)=3.288 | 3571.3 samples/s | 55.8 steps/s
[Step=28600 Epoch=139.4] | Loss=0.00566 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.004 | L2-Norm(final)=3.290 | 3970.1 samples/s | 62.0 steps/s
[Step=28650 Epoch=139.6] | Loss=0.00542 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.004 | L2-Norm(final)=3.291 | 1642.0 samples/s | 25.7 steps/s
[Step=28700 Epoch=139.8] | Loss=0.00521 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.004 | L2-Norm(final)=3.293 | 3699.3 samples/s | 57.8 steps/s
[Step=28750 Epoch=140.1] | Loss=0.00514 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.003 | L2-Norm(final)=3.294 | 3486.1 samples/s | 54.5 steps/s
[Step=28800 Epoch=140.3] | Loss=0.00508 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.003 | L2-Norm(final)=3.295 | 3789.0 samples/s | 59.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step28800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.5] | Loss=0.07758 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.036 | L2-Norm(final)=3.276 | 3857.2 samples/s | 60.3 steps/s
[Step=28050 Epoch=136.8] | Loss=0.02227 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.021 | L2-Norm(final)=3.270 | 3232.6 samples/s | 50.5 steps/s
[Step=28100 Epoch=137.0] | Loss=0.01477 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.016 | L2-Norm(final)=3.269 | 3508.6 samples/s | 54.8 steps/s
[Step=28150 Epoch=137.3] | Loss=0.01256 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.013 | L2-Norm(final)=3.270 | 3503.3 samples/s | 54.7 steps/s
[Step=28200 Epoch=137.5] | Loss=0.01094 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.012 | L2-Norm(final)=3.271 | 4335.1 samples/s | 67.7 steps/s
[Step=28250 Epoch=137.8] | Loss=0.00928 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.010 | L2-Norm(final)=3.272 | 1548.8 samples/s | 24.2 steps/s
[Step=28300 Epoch=138.0] | Loss=0.00830 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.009 | L2-Norm(final)=3.274 | 3525.0 samples/s | 55.1 steps/s
[Step=28350 Epoch=138.3] | Loss=0.00750 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.009 | L2-Norm(final)=3.275 | 3568.3 samples/s | 55.8 steps/s
[Step=28400 Epoch=138.5] | Loss=0.00712 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.008 | L2-Norm(final)=3.277 | 4077.6 samples/s | 63.7 steps/s
[Step=28450 Epoch=138.7] | Loss=0.00660 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.007 | L2-Norm(final)=3.278 | 1605.5 samples/s | 25.1 steps/s
[Step=28500 Epoch=139.0] | Loss=0.00618 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.007 | L2-Norm(final)=3.280 | 3598.5 samples/s | 56.2 steps/s
[Step=28550 Epoch=139.2] | Loss=0.00585 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.006 | L2-Norm(final)=3.281 | 3521.6 samples/s | 55.0 steps/s
[Step=28600 Epoch=139.5] | Loss=0.00570 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.006 | L2-Norm(final)=3.283 | 4018.8 samples/s | 62.8 steps/s
[Step=28650 Epoch=139.7] | Loss=0.00542 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.005 | L2-Norm(final)=3.284 | 1623.7 samples/s | 25.4 steps/s
[Step=28700 Epoch=140.0] | Loss=0.00519 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.005 | L2-Norm(final)=3.285 | 3489.5 samples/s | 54.5 steps/s
[Step=28750 Epoch=140.2] | Loss=0.00506 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.005 | L2-Norm(final)=3.287 | 3558.9 samples/s | 55.6 steps/s
[Step=28800 Epoch=140.4] | Loss=0.00486 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.004 | L2-Norm(final)=3.288 | 3775.6 samples/s | 59.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step28800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=137.3] | Loss=0.15787 | Reg=0.00290 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=17.036 | L2-Norm(final)=3.276 | 3700.5 samples/s | 57.8 steps/s
[Step=28050 Epoch=137.6] | Loss=0.01816 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.020 | L2-Norm(final)=3.271 | 3360.1 samples/s | 52.5 steps/s
[Step=28100 Epoch=137.8] | Loss=0.01379 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.016 | L2-Norm(final)=3.272 | 3535.5 samples/s | 55.2 steps/s
[Step=28150 Epoch=138.0] | Loss=0.01170 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.013 | L2-Norm(final)=3.273 | 3471.2 samples/s | 54.2 steps/s
[Step=28200 Epoch=138.3] | Loss=0.01036 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.011 | L2-Norm(final)=3.274 | 4404.4 samples/s | 68.8 steps/s
[Step=28250 Epoch=138.5] | Loss=0.00913 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.010 | L2-Norm(final)=3.276 | 1533.2 samples/s | 24.0 steps/s
[Step=28300 Epoch=138.8] | Loss=0.00846 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.009 | L2-Norm(final)=3.277 | 3491.4 samples/s | 54.6 steps/s
[Step=28350 Epoch=139.0] | Loss=0.00779 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.009 | L2-Norm(final)=3.279 | 3583.1 samples/s | 56.0 steps/s
[Step=28400 Epoch=139.3] | Loss=0.00718 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.008 | L2-Norm(final)=3.280 | 4308.1 samples/s | 67.3 steps/s
[Step=28450 Epoch=139.5] | Loss=0.00663 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.008 | L2-Norm(final)=3.282 | 1581.2 samples/s | 24.7 steps/s
[Step=28500 Epoch=139.8] | Loss=0.00612 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.007 | L2-Norm(final)=3.283 | 3537.6 samples/s | 55.3 steps/s
[Step=28550 Epoch=140.0] | Loss=0.00582 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.007 | L2-Norm(final)=3.285 | 3482.3 samples/s | 54.4 steps/s
[Step=28600 Epoch=140.2] | Loss=0.00565 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.006 | L2-Norm(final)=3.286 | 4125.0 samples/s | 64.5 steps/s
[Step=28650 Epoch=140.5] | Loss=0.00529 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.006 | L2-Norm(final)=3.288 | 1584.5 samples/s | 24.8 steps/s
[Step=28700 Epoch=140.7] | Loss=0.00507 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.006 | L2-Norm(final)=3.289 | 3531.3 samples/s | 55.2 steps/s
[Step=28750 Epoch=141.0] | Loss=0.00489 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.005 | L2-Norm(final)=3.291 | 3535.1 samples/s | 55.2 steps/s
[Step=28800 Epoch=141.2] | Loss=0.00479 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.005 | L2-Norm(final)=3.292 | 3906.2 samples/s | 61.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step28800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=265.3] | Loss=0.08916 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.036 | L2-Norm(final)=3.276 | 3466.0 samples/s | 54.2 steps/s
[Step=28050 Epoch=265.8] | Loss=0.00566 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.989 | L2-Norm(final)=3.279 | 3285.5 samples/s | 51.3 steps/s
[Step=28100 Epoch=266.3] | Loss=0.00292 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.981 | L2-Norm(final)=3.280 | 4237.6 samples/s | 66.2 steps/s
[Step=28150 Epoch=266.7] | Loss=0.00197 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.977 | L2-Norm(final)=3.281 | 1514.4 samples/s | 23.7 steps/s
[Step=28200 Epoch=267.2] | Loss=0.00148 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.973 | L2-Norm(final)=3.281 | 3934.9 samples/s | 61.5 steps/s
[Step=28250 Epoch=267.7] | Loss=0.00119 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.970 | L2-Norm(final)=3.281 | 1543.5 samples/s | 24.1 steps/s
[Step=28300 Epoch=268.2] | Loss=0.00100 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.968 | L2-Norm(final)=3.281 | 3814.1 samples/s | 59.6 steps/s
[Step=28350 Epoch=268.6] | Loss=0.00086 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.966 | L2-Norm(final)=3.282 | 1585.3 samples/s | 24.8 steps/s
[Step=28400 Epoch=269.1] | Loss=0.00075 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.964 | L2-Norm(final)=3.282 | 3506.5 samples/s | 54.8 steps/s
[Step=28450 Epoch=269.6] | Loss=0.00067 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.962 | L2-Norm(final)=3.282 | 1610.2 samples/s | 25.2 steps/s
[Step=28500 Epoch=270.1] | Loss=0.00061 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.961 | L2-Norm(final)=3.282 | 3433.2 samples/s | 53.6 steps/s
[Step=28550 Epoch=270.5] | Loss=0.00055 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.959 | L2-Norm(final)=3.282 | 1654.5 samples/s | 25.9 steps/s
[Step=28600 Epoch=271.0] | Loss=0.00051 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.958 | L2-Norm(final)=3.282 | 3342.6 samples/s | 52.2 steps/s
[Step=28650 Epoch=271.5] | Loss=0.00047 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.957 | L2-Norm(final)=3.282 | 1703.4 samples/s | 26.6 steps/s
[Step=28700 Epoch=272.0] | Loss=0.00044 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.956 | L2-Norm(final)=3.282 | 3383.9 samples/s | 52.9 steps/s
[Step=28750 Epoch=272.4] | Loss=0.00041 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.954 | L2-Norm(final)=3.282 | 1683.3 samples/s | 26.3 steps/s
[Step=28800 Epoch=272.9] | Loss=0.00039 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.953 | L2-Norm(final)=3.282 | 3320.0 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step28800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=266.4] | Loss=0.08530 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.036 | L2-Norm(final)=3.276 | 3516.9 samples/s | 55.0 steps/s
[Step=28050 Epoch=266.8] | Loss=0.00804 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.992 | L2-Norm(final)=3.275 | 3301.7 samples/s | 51.6 steps/s
[Step=28100 Epoch=267.3] | Loss=0.00408 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.984 | L2-Norm(final)=3.275 | 4187.4 samples/s | 65.4 steps/s
[Step=28150 Epoch=267.8] | Loss=0.00273 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.979 | L2-Norm(final)=3.275 | 1530.5 samples/s | 23.9 steps/s
[Step=28200 Epoch=268.3] | Loss=0.00206 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.976 | L2-Norm(final)=3.276 | 3920.8 samples/s | 61.3 steps/s
[Step=28250 Epoch=268.7] | Loss=0.00165 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.973 | L2-Norm(final)=3.276 | 1553.9 samples/s | 24.3 steps/s
[Step=28300 Epoch=269.2] | Loss=0.00138 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.970 | L2-Norm(final)=3.276 | 3813.3 samples/s | 59.6 steps/s
[Step=28350 Epoch=269.7] | Loss=0.00119 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.968 | L2-Norm(final)=3.276 | 1624.5 samples/s | 25.4 steps/s
[Step=28400 Epoch=270.2] | Loss=0.00104 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.966 | L2-Norm(final)=3.276 | 3562.8 samples/s | 55.7 steps/s
[Step=28450 Epoch=270.6] | Loss=0.00093 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.964 | L2-Norm(final)=3.276 | 1648.2 samples/s | 25.8 steps/s
[Step=28500 Epoch=271.1] | Loss=0.00084 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.963 | L2-Norm(final)=3.277 | 3501.7 samples/s | 54.7 steps/s
[Step=28550 Epoch=271.6] | Loss=0.00076 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.961 | L2-Norm(final)=3.277 | 1650.7 samples/s | 25.8 steps/s
[Step=28600 Epoch=272.1] | Loss=0.00070 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.960 | L2-Norm(final)=3.277 | 3387.3 samples/s | 52.9 steps/s
[Step=28650 Epoch=272.5] | Loss=0.00065 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.958 | L2-Norm(final)=3.277 | 1691.9 samples/s | 26.4 steps/s
[Step=28700 Epoch=273.0] | Loss=0.00060 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.957 | L2-Norm(final)=3.277 | 3312.0 samples/s | 51.7 steps/s
[Step=28750 Epoch=273.5] | Loss=0.00057 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.956 | L2-Norm(final)=3.277 | 1682.6 samples/s | 26.3 steps/s
[Step=28800 Epoch=274.0] | Loss=0.00053 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.955 | L2-Norm(final)=3.277 | 3337.0 samples/s | 52.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step28800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=267.4] | Loss=0.04537 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.036 | L2-Norm(final)=3.276 | 3522.9 samples/s | 55.0 steps/s
[Step=28050 Epoch=267.9] | Loss=0.00560 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.995 | L2-Norm(final)=3.278 | 3410.5 samples/s | 53.3 steps/s
[Step=28100 Epoch=268.3] | Loss=0.00285 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.987 | L2-Norm(final)=3.279 | 4328.6 samples/s | 67.6 steps/s
[Step=28150 Epoch=268.8] | Loss=0.00191 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.982 | L2-Norm(final)=3.279 | 1525.4 samples/s | 23.8 steps/s
[Step=28200 Epoch=269.3] | Loss=0.00145 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.979 | L2-Norm(final)=3.279 | 4067.6 samples/s | 63.6 steps/s
[Step=28250 Epoch=269.8] | Loss=0.00117 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.976 | L2-Norm(final)=3.280 | 1531.5 samples/s | 23.9 steps/s
[Step=28300 Epoch=270.2] | Loss=0.00098 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.974 | L2-Norm(final)=3.280 | 3868.7 samples/s | 60.4 steps/s
[Step=28350 Epoch=270.7] | Loss=0.00084 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.971 | L2-Norm(final)=3.280 | 1563.7 samples/s | 24.4 steps/s
[Step=28400 Epoch=271.2] | Loss=0.00074 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.970 | L2-Norm(final)=3.280 | 3649.7 samples/s | 57.0 steps/s
[Step=28450 Epoch=271.7] | Loss=0.00066 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.968 | L2-Norm(final)=3.280 | 1594.4 samples/s | 24.9 steps/s
[Step=28500 Epoch=272.2] | Loss=0.00060 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.967 | L2-Norm(final)=3.281 | 3726.7 samples/s | 58.2 steps/s
[Step=28550 Epoch=272.6] | Loss=0.00054 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.965 | L2-Norm(final)=3.281 | 1637.4 samples/s | 25.6 steps/s
[Step=28600 Epoch=273.1] | Loss=0.00050 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.964 | L2-Norm(final)=3.281 | 3403.2 samples/s | 53.2 steps/s
[Step=28650 Epoch=273.6] | Loss=0.00046 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.963 | L2-Norm(final)=3.281 | 1652.5 samples/s | 25.8 steps/s
[Step=28700 Epoch=274.1] | Loss=0.00043 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.962 | L2-Norm(final)=3.281 | 3540.7 samples/s | 55.3 steps/s
[Step=28750 Epoch=274.5] | Loss=0.00040 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.961 | L2-Norm(final)=3.281 | 1662.2 samples/s | 26.0 steps/s
[Step=28800 Epoch=275.0] | Loss=0.00038 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.960 | L2-Norm(final)=3.281 | 3433.0 samples/s | 53.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step28800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=263.8] | Loss=0.11378 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.036 | L2-Norm(final)=3.276 | 3737.5 samples/s | 58.4 steps/s
[Step=28050 Epoch=264.3] | Loss=0.00504 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.991 | L2-Norm(final)=3.280 | 3171.8 samples/s | 49.6 steps/s
[Step=28100 Epoch=264.8] | Loss=0.00257 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.984 | L2-Norm(final)=3.281 | 4224.7 samples/s | 66.0 steps/s
[Step=28150 Epoch=265.3] | Loss=0.00173 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.979 | L2-Norm(final)=3.281 | 1550.0 samples/s | 24.2 steps/s
[Step=28200 Epoch=265.7] | Loss=0.00131 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.976 | L2-Norm(final)=3.281 | 4023.9 samples/s | 62.9 steps/s
[Step=28250 Epoch=266.2] | Loss=0.00105 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.973 | L2-Norm(final)=3.282 | 1564.1 samples/s | 24.4 steps/s
[Step=28300 Epoch=266.7] | Loss=0.00088 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.971 | L2-Norm(final)=3.282 | 3619.6 samples/s | 56.6 steps/s
[Step=28350 Epoch=267.1] | Loss=0.00076 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.969 | L2-Norm(final)=3.282 | 1585.2 samples/s | 24.8 steps/s
[Step=28400 Epoch=267.6] | Loss=0.00067 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.967 | L2-Norm(final)=3.282 | 3456.0 samples/s | 54.0 steps/s
[Step=28450 Epoch=268.1] | Loss=0.00060 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.965 | L2-Norm(final)=3.282 | 1649.5 samples/s | 25.8 steps/s
[Step=28500 Epoch=268.6] | Loss=0.00054 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.964 | L2-Norm(final)=3.282 | 3387.6 samples/s | 52.9 steps/s
[Step=28550 Epoch=269.0] | Loss=0.00049 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.963 | L2-Norm(final)=3.282 | 1703.3 samples/s | 26.6 steps/s
[Step=28600 Epoch=269.5] | Loss=0.00045 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.961 | L2-Norm(final)=3.282 | 3395.7 samples/s | 53.1 steps/s
[Step=28650 Epoch=270.0] | Loss=0.00042 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.960 | L2-Norm(final)=3.282 | 1635.0 samples/s | 25.5 steps/s
[Step=28700 Epoch=270.4] | Loss=0.00039 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.959 | L2-Norm(final)=3.283 | 3392.2 samples/s | 53.0 steps/s
[Step=28750 Epoch=270.9] | Loss=0.00037 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.958 | L2-Norm(final)=3.283 | 1792.9 samples/s | 28.0 steps/s
[Step=28800 Epoch=271.4] | Loss=0.00034 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.957 | L2-Norm(final)=3.283 | 3036.8 samples/s | 47.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step28800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=266.9] | Loss=0.03353 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.036 | L2-Norm(final)=3.276 | 3725.8 samples/s | 58.2 steps/s
[Step=28050 Epoch=267.3] | Loss=0.00513 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.993 | L2-Norm(final)=3.281 | 3162.5 samples/s | 49.4 steps/s
[Step=28100 Epoch=267.8] | Loss=0.00264 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.986 | L2-Norm(final)=3.282 | 4198.3 samples/s | 65.6 steps/s
[Step=28150 Epoch=268.3] | Loss=0.00178 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.981 | L2-Norm(final)=3.283 | 1513.6 samples/s | 23.6 steps/s
[Step=28200 Epoch=268.8] | Loss=0.00134 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.977 | L2-Norm(final)=3.283 | 4068.0 samples/s | 63.6 steps/s
[Step=28250 Epoch=269.2] | Loss=0.00108 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.975 | L2-Norm(final)=3.284 | 1555.7 samples/s | 24.3 steps/s
[Step=28300 Epoch=269.7] | Loss=0.00091 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.972 | L2-Norm(final)=3.284 | 3851.9 samples/s | 60.2 steps/s
[Step=28350 Epoch=270.2] | Loss=0.00078 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.970 | L2-Norm(final)=3.284 | 1633.2 samples/s | 25.5 steps/s
[Step=28400 Epoch=270.7] | Loss=0.00069 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.968 | L2-Norm(final)=3.284 | 3689.6 samples/s | 57.7 steps/s
[Step=28450 Epoch=271.2] | Loss=0.00061 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.967 | L2-Norm(final)=3.284 | 1591.2 samples/s | 24.9 steps/s
[Step=28500 Epoch=271.6] | Loss=0.00055 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.965 | L2-Norm(final)=3.284 | 3547.1 samples/s | 55.4 steps/s
[Step=28550 Epoch=272.1] | Loss=0.00051 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.964 | L2-Norm(final)=3.284 | 1632.5 samples/s | 25.5 steps/s
[Step=28600 Epoch=272.6] | Loss=0.00047 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.963 | L2-Norm(final)=3.284 | 3414.6 samples/s | 53.4 steps/s
[Step=28650 Epoch=273.1] | Loss=0.00043 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.961 | L2-Norm(final)=3.285 | 1668.3 samples/s | 26.1 steps/s
[Step=28700 Epoch=273.5] | Loss=0.00040 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.960 | L2-Norm(final)=3.285 | 3380.7 samples/s | 52.8 steps/s
[Step=28750 Epoch=274.0] | Loss=0.00038 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.959 | L2-Norm(final)=3.285 | 1658.9 samples/s | 25.9 steps/s
[Step=28800 Epoch=274.5] | Loss=0.00035 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.958 | L2-Norm(final)=3.285 | 3381.2 samples/s | 52.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24964 | acc=0.8655 | tpr=0.8105 | fpr=0.0151 | 3687.7 samples/s | 14.4 steps/s
Avg test loss: 0.25142, Avg test acc: 0.86525, Avg tpr: 0.81086, Avg fpr: 0.01513, total FA: 118

Testing server on iccad2012
[Step=  50] | Loss=0.40827 | acc=0.8730 | tpr=0.9602 | fpr=0.1286 | 3623.5 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.41751 | acc=0.8725 | tpr=0.9616 | fpr=0.1292 | 6965.2 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.42381 | acc=0.8714 | tpr=0.9669 | fpr=0.1304 | 7108.6 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.42469 | acc=0.8723 | tpr=0.9661 | fpr=0.1294 | 6692.6 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.42373 | acc=0.8724 | tpr=0.9677 | fpr=0.1293 | 6978.6 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.42287 | acc=0.8732 | tpr=0.9644 | fpr=0.1285 | 6893.8 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.42490 | acc=0.8731 | tpr=0.9631 | fpr=0.1285 | 6940.1 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.42570 | acc=0.8731 | tpr=0.9612 | fpr=0.1285 | 6543.8 samples/s | 25.6 steps/s
[Step= 450] | Loss=0.42961 | acc=0.8724 | tpr=0.9611 | fpr=0.1292 | 6907.7 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.43012 | acc=0.8721 | tpr=0.9626 | fpr=0.1295 | 6811.8 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.42912 | acc=0.8723 | tpr=0.9638 | fpr=0.1294 | 12716.1 samples/s | 49.7 steps/s
Avg test loss: 0.42896, Avg test acc: 0.87227, Avg tpr: 0.96395, Avg fpr: 0.12939, total FA: 17966

server round 36/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.4] | Loss=0.15357 | Reg=0.00288 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=16.963 | L2-Norm(final)=3.295 | 3489.4 samples/s | 54.5 steps/s
[Step=28850 Epoch=140.7] | Loss=0.02191 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.951 | L2-Norm(final)=3.289 | 3429.4 samples/s | 53.6 steps/s
[Step=28900 Epoch=140.9] | Loss=0.01409 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.945 | L2-Norm(final)=3.289 | 3372.7 samples/s | 52.7 steps/s
[Step=28950 Epoch=141.2] | Loss=0.01246 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.942 | L2-Norm(final)=3.289 | 3481.6 samples/s | 54.4 steps/s
[Step=29000 Epoch=141.4] | Loss=0.01132 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.940 | L2-Norm(final)=3.289 | 4388.1 samples/s | 68.6 steps/s
[Step=29050 Epoch=141.7] | Loss=0.00989 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.938 | L2-Norm(final)=3.290 | 1558.6 samples/s | 24.4 steps/s
[Step=29100 Epoch=141.9] | Loss=0.00896 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.937 | L2-Norm(final)=3.291 | 3470.1 samples/s | 54.2 steps/s
[Step=29150 Epoch=142.1] | Loss=0.00816 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.937 | L2-Norm(final)=3.293 | 3638.1 samples/s | 56.8 steps/s
[Step=29200 Epoch=142.4] | Loss=0.00766 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.936 | L2-Norm(final)=3.294 | 4112.6 samples/s | 64.3 steps/s
[Step=29250 Epoch=142.6] | Loss=0.00711 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.935 | L2-Norm(final)=3.296 | 1591.8 samples/s | 24.9 steps/s
[Step=29300 Epoch=142.9] | Loss=0.00666 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.935 | L2-Norm(final)=3.297 | 3480.5 samples/s | 54.4 steps/s
[Step=29350 Epoch=143.1] | Loss=0.00641 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.934 | L2-Norm(final)=3.298 | 3500.7 samples/s | 54.7 steps/s
[Step=29400 Epoch=143.4] | Loss=0.00619 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.934 | L2-Norm(final)=3.300 | 3980.6 samples/s | 62.2 steps/s
[Step=29450 Epoch=143.6] | Loss=0.00593 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.933 | L2-Norm(final)=3.301 | 1641.1 samples/s | 25.6 steps/s
[Step=29500 Epoch=143.8] | Loss=0.00569 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.933 | L2-Norm(final)=3.302 | 3525.9 samples/s | 55.1 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00557 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.933 | L2-Norm(final)=3.303 | 3528.5 samples/s | 55.1 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00545 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.932 | L2-Norm(final)=3.304 | 3770.6 samples/s | 58.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step29600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.5] | Loss=0.12732 | Reg=0.00288 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.963 | L2-Norm(final)=3.296 | 3653.4 samples/s | 57.1 steps/s
[Step=28850 Epoch=140.8] | Loss=0.02321 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.949 | L2-Norm(final)=3.289 | 3441.1 samples/s | 53.8 steps/s
[Step=28900 Epoch=141.0] | Loss=0.01560 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.944 | L2-Norm(final)=3.288 | 3540.5 samples/s | 55.3 steps/s
[Step=28950 Epoch=141.3] | Loss=0.01294 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.941 | L2-Norm(final)=3.288 | 3532.5 samples/s | 55.2 steps/s
[Step=29000 Epoch=141.5] | Loss=0.01074 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.938 | L2-Norm(final)=3.289 | 4423.8 samples/s | 69.1 steps/s
[Step=29050 Epoch=141.8] | Loss=0.00908 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.937 | L2-Norm(final)=3.290 | 1541.5 samples/s | 24.1 steps/s
[Step=29100 Epoch=142.0] | Loss=0.00826 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.936 | L2-Norm(final)=3.292 | 3522.6 samples/s | 55.0 steps/s
[Step=29150 Epoch=142.2] | Loss=0.00764 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.935 | L2-Norm(final)=3.293 | 3459.1 samples/s | 54.0 steps/s
[Step=29200 Epoch=142.5] | Loss=0.00721 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.935 | L2-Norm(final)=3.294 | 4085.5 samples/s | 63.8 steps/s
[Step=29250 Epoch=142.7] | Loss=0.00675 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.934 | L2-Norm(final)=3.295 | 1598.0 samples/s | 25.0 steps/s
[Step=29300 Epoch=143.0] | Loss=0.00655 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.933 | L2-Norm(final)=3.296 | 3520.8 samples/s | 55.0 steps/s
[Step=29350 Epoch=143.2] | Loss=0.00626 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.933 | L2-Norm(final)=3.297 | 3608.2 samples/s | 56.4 steps/s
[Step=29400 Epoch=143.5] | Loss=0.00595 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.932 | L2-Norm(final)=3.298 | 4230.7 samples/s | 66.1 steps/s
[Step=29450 Epoch=143.7] | Loss=0.00572 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.931 | L2-Norm(final)=3.299 | 1630.3 samples/s | 25.5 steps/s
[Step=29500 Epoch=143.9] | Loss=0.00551 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.931 | L2-Norm(final)=3.300 | 3557.0 samples/s | 55.6 steps/s
[Step=29550 Epoch=144.2] | Loss=0.00532 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.930 | L2-Norm(final)=3.301 | 3588.7 samples/s | 56.1 steps/s
[Step=29600 Epoch=144.4] | Loss=0.00515 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.930 | L2-Norm(final)=3.302 | 3893.4 samples/s | 60.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step29600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.3] | Loss=0.07197 | Reg=0.00288 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.963 | L2-Norm(final)=3.296 | 3763.7 samples/s | 58.8 steps/s
[Step=28850 Epoch=140.6] | Loss=0.02218 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.947 | L2-Norm(final)=3.290 | 3344.7 samples/s | 52.3 steps/s
[Step=28900 Epoch=140.8] | Loss=0.01629 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.942 | L2-Norm(final)=3.289 | 3651.6 samples/s | 57.1 steps/s
[Step=28950 Epoch=141.1] | Loss=0.01355 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.939 | L2-Norm(final)=3.290 | 3747.0 samples/s | 58.5 steps/s
[Step=29000 Epoch=141.3] | Loss=0.01157 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.938 | L2-Norm(final)=3.291 | 4461.7 samples/s | 69.7 steps/s
[Step=29050 Epoch=141.5] | Loss=0.00977 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.937 | L2-Norm(final)=3.293 | 1623.9 samples/s | 25.4 steps/s
[Step=29100 Epoch=141.8] | Loss=0.00889 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.936 | L2-Norm(final)=3.295 | 3554.7 samples/s | 55.5 steps/s
[Step=29150 Epoch=142.0] | Loss=0.00816 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.935 | L2-Norm(final)=3.296 | 3525.9 samples/s | 55.1 steps/s
[Step=29200 Epoch=142.3] | Loss=0.00770 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.935 | L2-Norm(final)=3.298 | 4088.7 samples/s | 63.9 steps/s
[Step=29250 Epoch=142.5] | Loss=0.00717 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.935 | L2-Norm(final)=3.300 | 1619.9 samples/s | 25.3 steps/s
[Step=29300 Epoch=142.8] | Loss=0.00676 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.934 | L2-Norm(final)=3.301 | 3561.2 samples/s | 55.6 steps/s
[Step=29350 Epoch=143.0] | Loss=0.00638 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.934 | L2-Norm(final)=3.303 | 3515.5 samples/s | 54.9 steps/s
[Step=29400 Epoch=143.3] | Loss=0.00605 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.934 | L2-Norm(final)=3.304 | 3950.4 samples/s | 61.7 steps/s
[Step=29450 Epoch=143.5] | Loss=0.00578 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.933 | L2-Norm(final)=3.306 | 1639.9 samples/s | 25.6 steps/s
[Step=29500 Epoch=143.7] | Loss=0.00551 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.933 | L2-Norm(final)=3.308 | 3522.6 samples/s | 55.0 steps/s
[Step=29550 Epoch=144.0] | Loss=0.00535 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.933 | L2-Norm(final)=3.309 | 3539.5 samples/s | 55.3 steps/s
[Step=29600 Epoch=144.2] | Loss=0.00526 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.933 | L2-Norm(final)=3.311 | 3747.0 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step29600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.4] | Loss=0.03444 | Reg=0.00288 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.963 | L2-Norm(final)=3.296 | 3612.2 samples/s | 56.4 steps/s
[Step=28850 Epoch=140.7] | Loss=0.01765 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.950 | L2-Norm(final)=3.293 | 3396.1 samples/s | 53.1 steps/s
[Step=28900 Epoch=140.9] | Loss=0.01217 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.946 | L2-Norm(final)=3.294 | 3466.6 samples/s | 54.2 steps/s
[Step=28950 Epoch=141.2] | Loss=0.01033 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.944 | L2-Norm(final)=3.295 | 3571.1 samples/s | 55.8 steps/s
[Step=29000 Epoch=141.4] | Loss=0.00946 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.942 | L2-Norm(final)=3.296 | 4497.0 samples/s | 70.3 steps/s
[Step=29050 Epoch=141.7] | Loss=0.00823 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.942 | L2-Norm(final)=3.298 | 1601.0 samples/s | 25.0 steps/s
[Step=29100 Epoch=141.9] | Loss=0.00735 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.941 | L2-Norm(final)=3.300 | 3496.4 samples/s | 54.6 steps/s
[Step=29150 Epoch=142.2] | Loss=0.00700 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.940 | L2-Norm(final)=3.301 | 3592.9 samples/s | 56.1 steps/s
[Step=29200 Epoch=142.4] | Loss=0.00647 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.940 | L2-Norm(final)=3.303 | 4146.9 samples/s | 64.8 steps/s
[Step=29250 Epoch=142.6] | Loss=0.00611 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.939 | L2-Norm(final)=3.304 | 1588.6 samples/s | 24.8 steps/s
[Step=29300 Epoch=142.9] | Loss=0.00574 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.938 | L2-Norm(final)=3.305 | 3478.3 samples/s | 54.3 steps/s
[Step=29350 Epoch=143.1] | Loss=0.00546 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.938 | L2-Norm(final)=3.306 | 3549.1 samples/s | 55.5 steps/s
[Step=29400 Epoch=143.4] | Loss=0.00523 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.937 | L2-Norm(final)=3.308 | 3887.9 samples/s | 60.7 steps/s
[Step=29450 Epoch=143.6] | Loss=0.00504 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.937 | L2-Norm(final)=3.309 | 1627.8 samples/s | 25.4 steps/s
[Step=29500 Epoch=143.9] | Loss=0.00488 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.936 | L2-Norm(final)=3.310 | 3539.2 samples/s | 55.3 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00476 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.936 | L2-Norm(final)=3.311 | 3472.5 samples/s | 54.3 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00475 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.936 | L2-Norm(final)=3.312 | 3717.3 samples/s | 58.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step29600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=141.2] | Loss=0.05611 | Reg=0.00288 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.963 | L2-Norm(final)=3.296 | 3826.8 samples/s | 59.8 steps/s
[Step=28850 Epoch=141.5] | Loss=0.01769 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.948 | L2-Norm(final)=3.292 | 3225.7 samples/s | 50.4 steps/s
[Step=28900 Epoch=141.7] | Loss=0.01263 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.943 | L2-Norm(final)=3.292 | 3526.9 samples/s | 55.1 steps/s
[Step=28950 Epoch=142.0] | Loss=0.01116 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.941 | L2-Norm(final)=3.293 | 3517.7 samples/s | 55.0 steps/s
[Step=29000 Epoch=142.2] | Loss=0.00989 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.939 | L2-Norm(final)=3.294 | 4422.2 samples/s | 69.1 steps/s
[Step=29050 Epoch=142.5] | Loss=0.00878 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.938 | L2-Norm(final)=3.295 | 1542.1 samples/s | 24.1 steps/s
[Step=29100 Epoch=142.7] | Loss=0.00809 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.937 | L2-Norm(final)=3.296 | 3540.5 samples/s | 55.3 steps/s
[Step=29150 Epoch=142.9] | Loss=0.00737 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.937 | L2-Norm(final)=3.298 | 3503.0 samples/s | 54.7 steps/s
[Step=29200 Epoch=143.2] | Loss=0.00694 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.936 | L2-Norm(final)=3.299 | 4156.2 samples/s | 64.9 steps/s
[Step=29250 Epoch=143.4] | Loss=0.00645 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.935 | L2-Norm(final)=3.301 | 1619.8 samples/s | 25.3 steps/s
[Step=29300 Epoch=143.7] | Loss=0.00598 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.935 | L2-Norm(final)=3.302 | 3548.9 samples/s | 55.5 steps/s
[Step=29350 Epoch=143.9] | Loss=0.00565 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.934 | L2-Norm(final)=3.304 | 3491.7 samples/s | 54.6 steps/s
[Step=29400 Epoch=144.2] | Loss=0.00543 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.934 | L2-Norm(final)=3.305 | 4204.5 samples/s | 65.7 steps/s
[Step=29450 Epoch=144.4] | Loss=0.00525 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.934 | L2-Norm(final)=3.306 | 1601.3 samples/s | 25.0 steps/s
[Step=29500 Epoch=144.7] | Loss=0.00505 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.934 | L2-Norm(final)=3.308 | 3475.4 samples/s | 54.3 steps/s
[Step=29550 Epoch=144.9] | Loss=0.00489 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.933 | L2-Norm(final)=3.309 | 3500.7 samples/s | 54.7 steps/s
[Step=29600 Epoch=145.2] | Loss=0.00472 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.933 | L2-Norm(final)=3.310 | 4155.0 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step29600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=272.9] | Loss=0.05271 | Reg=0.00288 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.963 | L2-Norm(final)=3.296 | 3578.8 samples/s | 55.9 steps/s
[Step=28850 Epoch=273.4] | Loss=0.00567 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.918 | L2-Norm(final)=3.297 | 3202.3 samples/s | 50.0 steps/s
[Step=28900 Epoch=273.9] | Loss=0.00287 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.910 | L2-Norm(final)=3.298 | 4159.1 samples/s | 65.0 steps/s
[Step=28950 Epoch=274.3] | Loss=0.00192 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.905 | L2-Norm(final)=3.298 | 1507.0 samples/s | 23.5 steps/s
[Step=29000 Epoch=274.8] | Loss=0.00145 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.902 | L2-Norm(final)=3.299 | 3985.6 samples/s | 62.3 steps/s
[Step=29050 Epoch=275.3] | Loss=0.00117 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.899 | L2-Norm(final)=3.299 | 1543.4 samples/s | 24.1 steps/s
[Step=29100 Epoch=275.7] | Loss=0.00098 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.896 | L2-Norm(final)=3.299 | 3720.3 samples/s | 58.1 steps/s
[Step=29150 Epoch=276.2] | Loss=0.00084 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.894 | L2-Norm(final)=3.299 | 1576.1 samples/s | 24.6 steps/s
[Step=29200 Epoch=276.7] | Loss=0.00074 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.892 | L2-Norm(final)=3.299 | 3654.0 samples/s | 57.1 steps/s
[Step=29250 Epoch=277.2] | Loss=0.00066 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.890 | L2-Norm(final)=3.299 | 1645.9 samples/s | 25.7 steps/s
[Step=29300 Epoch=277.6] | Loss=0.00060 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.889 | L2-Norm(final)=3.300 | 3498.5 samples/s | 54.7 steps/s
[Step=29350 Epoch=278.1] | Loss=0.00054 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.887 | L2-Norm(final)=3.300 | 1620.0 samples/s | 25.3 steps/s
[Step=29400 Epoch=278.6] | Loss=0.00050 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.886 | L2-Norm(final)=3.300 | 3480.9 samples/s | 54.4 steps/s
[Step=29450 Epoch=279.1] | Loss=0.00046 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.885 | L2-Norm(final)=3.300 | 1686.6 samples/s | 26.4 steps/s
[Step=29500 Epoch=279.5] | Loss=0.00043 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.884 | L2-Norm(final)=3.300 | 3458.7 samples/s | 54.0 steps/s
[Step=29550 Epoch=280.0] | Loss=0.00040 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.883 | L2-Norm(final)=3.300 | 1698.3 samples/s | 26.5 steps/s
[Step=29600 Epoch=280.5] | Loss=0.00038 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.882 | L2-Norm(final)=3.300 | 3343.1 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step29600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=274.0] | Loss=0.04321 | Reg=0.00288 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.963 | L2-Norm(final)=3.296 | 3590.1 samples/s | 56.1 steps/s
[Step=28850 Epoch=274.4] | Loss=0.00571 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.919 | L2-Norm(final)=3.298 | 3178.8 samples/s | 49.7 steps/s
[Step=28900 Epoch=274.9] | Loss=0.00296 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.914 | L2-Norm(final)=3.298 | 4162.6 samples/s | 65.0 steps/s
[Step=28950 Epoch=275.4] | Loss=0.00202 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.910 | L2-Norm(final)=3.299 | 1525.6 samples/s | 23.8 steps/s
[Step=29000 Epoch=275.9] | Loss=0.00153 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.906 | L2-Norm(final)=3.300 | 4000.4 samples/s | 62.5 steps/s
[Step=29050 Epoch=276.3] | Loss=0.00123 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.903 | L2-Norm(final)=3.300 | 1551.6 samples/s | 24.2 steps/s
[Step=29100 Epoch=276.8] | Loss=0.00103 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.901 | L2-Norm(final)=3.300 | 3785.2 samples/s | 59.1 steps/s
[Step=29150 Epoch=277.3] | Loss=0.00088 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.899 | L2-Norm(final)=3.300 | 1575.7 samples/s | 24.6 steps/s
[Step=29200 Epoch=277.8] | Loss=0.00078 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.897 | L2-Norm(final)=3.301 | 3619.6 samples/s | 56.6 steps/s
[Step=29250 Epoch=278.2] | Loss=0.00069 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.895 | L2-Norm(final)=3.301 | 1602.6 samples/s | 25.0 steps/s
[Step=29300 Epoch=278.7] | Loss=0.00062 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.894 | L2-Norm(final)=3.301 | 3481.2 samples/s | 54.4 steps/s
[Step=29350 Epoch=279.2] | Loss=0.00057 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.892 | L2-Norm(final)=3.301 | 1638.0 samples/s | 25.6 steps/s
[Step=29400 Epoch=279.7] | Loss=0.00052 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.891 | L2-Norm(final)=3.301 | 3409.2 samples/s | 53.3 steps/s
[Step=29450 Epoch=280.1] | Loss=0.00048 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.889 | L2-Norm(final)=3.301 | 1740.0 samples/s | 27.2 steps/s
[Step=29500 Epoch=280.6] | Loss=0.00045 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.888 | L2-Norm(final)=3.301 | 3374.1 samples/s | 52.7 steps/s
[Step=29550 Epoch=281.1] | Loss=0.00042 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.887 | L2-Norm(final)=3.301 | 1658.9 samples/s | 25.9 steps/s
[Step=29600 Epoch=281.6] | Loss=0.00040 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.886 | L2-Norm(final)=3.302 | 3362.3 samples/s | 52.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step29600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=275.0] | Loss=0.01097 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.963 | L2-Norm(final)=3.296 | 3475.2 samples/s | 54.3 steps/s
[Step=28850 Epoch=275.5] | Loss=0.00414 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.921 | L2-Norm(final)=3.300 | 3186.7 samples/s | 49.8 steps/s
[Step=28900 Epoch=276.0] | Loss=0.00212 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.914 | L2-Norm(final)=3.301 | 4165.2 samples/s | 65.1 steps/s
[Step=28950 Epoch=276.5] | Loss=0.00143 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.910 | L2-Norm(final)=3.301 | 1493.2 samples/s | 23.3 steps/s
[Step=29000 Epoch=276.9] | Loss=0.00108 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.906 | L2-Norm(final)=3.302 | 3937.0 samples/s | 61.5 steps/s
[Step=29050 Epoch=277.4] | Loss=0.00087 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.903 | L2-Norm(final)=3.302 | 1517.6 samples/s | 23.7 steps/s
[Step=29100 Epoch=277.9] | Loss=0.00073 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.901 | L2-Norm(final)=3.302 | 3814.9 samples/s | 59.6 steps/s
[Step=29150 Epoch=278.4] | Loss=0.00063 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.899 | L2-Norm(final)=3.302 | 1564.8 samples/s | 24.5 steps/s
[Step=29200 Epoch=278.8] | Loss=0.00055 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.897 | L2-Norm(final)=3.303 | 3700.2 samples/s | 57.8 steps/s
[Step=29250 Epoch=279.3] | Loss=0.00049 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.895 | L2-Norm(final)=3.303 | 1584.0 samples/s | 24.7 steps/s
[Step=29300 Epoch=279.8] | Loss=0.00044 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.894 | L2-Norm(final)=3.303 | 3477.0 samples/s | 54.3 steps/s
[Step=29350 Epoch=280.3] | Loss=0.00041 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.892 | L2-Norm(final)=3.303 | 1647.3 samples/s | 25.7 steps/s
[Step=29400 Epoch=280.8] | Loss=0.00037 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.891 | L2-Norm(final)=3.303 | 3413.3 samples/s | 53.3 steps/s
[Step=29450 Epoch=281.2] | Loss=0.00035 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.890 | L2-Norm(final)=3.303 | 1659.2 samples/s | 25.9 steps/s
[Step=29500 Epoch=281.7] | Loss=0.00032 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.888 | L2-Norm(final)=3.303 | 3465.1 samples/s | 54.1 steps/s
[Step=29550 Epoch=282.2] | Loss=0.00030 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.887 | L2-Norm(final)=3.303 | 1681.6 samples/s | 26.3 steps/s
[Step=29600 Epoch=282.7] | Loss=0.00028 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.886 | L2-Norm(final)=3.303 | 3459.9 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step29600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=271.4] | Loss=0.00292 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.963 | L2-Norm(final)=3.296 | 3706.9 samples/s | 57.9 steps/s
[Step=28850 Epoch=271.8] | Loss=0.00395 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.917 | L2-Norm(final)=3.302 | 3087.7 samples/s | 48.2 steps/s
[Step=28900 Epoch=272.3] | Loss=0.00202 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.909 | L2-Norm(final)=3.303 | 4211.6 samples/s | 65.8 steps/s
[Step=28950 Epoch=272.8] | Loss=0.00136 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.905 | L2-Norm(final)=3.304 | 1534.0 samples/s | 24.0 steps/s
[Step=29000 Epoch=273.3] | Loss=0.00103 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.901 | L2-Norm(final)=3.304 | 3864.5 samples/s | 60.4 steps/s
[Step=29050 Epoch=273.7] | Loss=0.00082 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.899 | L2-Norm(final)=3.304 | 1581.4 samples/s | 24.7 steps/s
[Step=29100 Epoch=274.2] | Loss=0.00069 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.896 | L2-Norm(final)=3.304 | 3751.7 samples/s | 58.6 steps/s
[Step=29150 Epoch=274.7] | Loss=0.00060 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.894 | L2-Norm(final)=3.304 | 1599.6 samples/s | 25.0 steps/s
[Step=29200 Epoch=275.1] | Loss=0.00052 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.893 | L2-Norm(final)=3.304 | 3422.6 samples/s | 53.5 steps/s
[Step=29250 Epoch=275.6] | Loss=0.00047 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.891 | L2-Norm(final)=3.304 | 1659.4 samples/s | 25.9 steps/s
[Step=29300 Epoch=276.1] | Loss=0.00042 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.890 | L2-Norm(final)=3.304 | 3364.0 samples/s | 52.6 steps/s
[Step=29350 Epoch=276.6] | Loss=0.00039 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.888 | L2-Norm(final)=3.304 | 1702.4 samples/s | 26.6 steps/s
[Step=29400 Epoch=277.0] | Loss=0.00035 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.887 | L2-Norm(final)=3.304 | 3441.1 samples/s | 53.8 steps/s
[Step=29450 Epoch=277.5] | Loss=0.00033 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.886 | L2-Norm(final)=3.304 | 1687.9 samples/s | 26.4 steps/s
[Step=29500 Epoch=278.0] | Loss=0.00031 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.885 | L2-Norm(final)=3.304 | 3474.4 samples/s | 54.3 steps/s
[Step=29550 Epoch=278.4] | Loss=0.00029 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.883 | L2-Norm(final)=3.304 | 1720.9 samples/s | 26.9 steps/s
[Step=29600 Epoch=278.9] | Loss=0.00027 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.882 | L2-Norm(final)=3.304 | 3246.1 samples/s | 50.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step29600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=274.5] | Loss=0.02566 | Reg=0.00288 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.963 | L2-Norm(final)=3.296 | 3688.6 samples/s | 57.6 steps/s
[Step=28850 Epoch=275.0] | Loss=0.00188 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.920 | L2-Norm(final)=3.306 | 3178.2 samples/s | 49.7 steps/s
[Step=28900 Epoch=275.4] | Loss=0.00097 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.913 | L2-Norm(final)=3.307 | 4247.3 samples/s | 66.4 steps/s
[Step=28950 Epoch=275.9] | Loss=0.00066 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.908 | L2-Norm(final)=3.308 | 1491.5 samples/s | 23.3 steps/s
[Step=29000 Epoch=276.4] | Loss=0.00050 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.904 | L2-Norm(final)=3.308 | 4021.2 samples/s | 62.8 steps/s
[Step=29050 Epoch=276.9] | Loss=0.00041 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.902 | L2-Norm(final)=3.309 | 1530.2 samples/s | 23.9 steps/s
[Step=29100 Epoch=277.3] | Loss=0.00034 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.899 | L2-Norm(final)=3.309 | 3816.3 samples/s | 59.6 steps/s
[Step=29150 Epoch=277.8] | Loss=0.00030 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.897 | L2-Norm(final)=3.309 | 1573.2 samples/s | 24.6 steps/s
[Step=29200 Epoch=278.3] | Loss=0.00026 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.895 | L2-Norm(final)=3.309 | 3665.6 samples/s | 57.3 steps/s
[Step=29250 Epoch=278.8] | Loss=0.00024 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.893 | L2-Norm(final)=3.309 | 1588.2 samples/s | 24.8 steps/s
[Step=29300 Epoch=279.3] | Loss=0.00021 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.892 | L2-Norm(final)=3.309 | 3546.1 samples/s | 55.4 steps/s
[Step=29350 Epoch=279.7] | Loss=0.00020 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.890 | L2-Norm(final)=3.309 | 1604.7 samples/s | 25.1 steps/s
[Step=29400 Epoch=280.2] | Loss=0.00018 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.889 | L2-Norm(final)=3.309 | 3507.2 samples/s | 54.8 steps/s
[Step=29450 Epoch=280.7] | Loss=0.00017 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.888 | L2-Norm(final)=3.309 | 1700.1 samples/s | 26.6 steps/s
[Step=29500 Epoch=281.2] | Loss=0.00016 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.887 | L2-Norm(final)=3.309 | 3361.1 samples/s | 52.5 steps/s
[Step=29550 Epoch=281.6] | Loss=0.00015 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.885 | L2-Norm(final)=3.309 | 1679.6 samples/s | 26.2 steps/s
[Step=29600 Epoch=282.1] | Loss=0.00014 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.884 | L2-Norm(final)=3.309 | 3547.0 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21543 | acc=0.8862 | tpr=0.8414 | fpr=0.0166 | 3014.8 samples/s | 11.8 steps/s
Avg test loss: 0.21753, Avg test acc: 0.88477, Avg tpr: 0.83983, Avg fpr: 0.01641, total FA: 128

Testing server on iccad2012
[Step=  50] | Loss=0.45402 | acc=0.8586 | tpr=0.9602 | fpr=0.1432 | 2792.2 samples/s | 10.9 steps/s
[Step= 100] | Loss=0.46383 | acc=0.8580 | tpr=0.9595 | fpr=0.1438 | 6853.3 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.47038 | acc=0.8568 | tpr=0.9654 | fpr=0.1452 | 6835.3 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.47082 | acc=0.8574 | tpr=0.9650 | fpr=0.1446 | 6968.3 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.46988 | acc=0.8580 | tpr=0.9677 | fpr=0.1440 | 6729.9 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.46860 | acc=0.8584 | tpr=0.9636 | fpr=0.1436 | 6586.8 samples/s | 25.7 steps/s
[Step= 350] | Loss=0.47067 | acc=0.8584 | tpr=0.9618 | fpr=0.1434 | 6896.9 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.47109 | acc=0.8587 | tpr=0.9595 | fpr=0.1431 | 6624.7 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.47526 | acc=0.8579 | tpr=0.9601 | fpr=0.1440 | 6742.5 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.47596 | acc=0.8576 | tpr=0.9617 | fpr=0.1443 | 6941.1 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.47493 | acc=0.8578 | tpr=0.9634 | fpr=0.1441 | 12507.2 samples/s | 48.9 steps/s
Avg test loss: 0.47479, Avg test acc: 0.85781, Avg tpr: 0.96355, Avg fpr: 0.14411, total FA: 20009

server round 37/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.3] | Loss=0.08472 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.892 | L2-Norm(final)=3.315 | 3534.0 samples/s | 55.2 steps/s
[Step=29650 Epoch=144.6] | Loss=0.01500 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.873 | L2-Norm(final)=3.313 | 3446.2 samples/s | 53.8 steps/s
[Step=29700 Epoch=144.8] | Loss=0.01176 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.868 | L2-Norm(final)=3.312 | 3498.2 samples/s | 54.7 steps/s
[Step=29750 Epoch=145.1] | Loss=0.00962 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.865 | L2-Norm(final)=3.313 | 3517.2 samples/s | 55.0 steps/s
[Step=29800 Epoch=145.3] | Loss=0.00940 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.863 | L2-Norm(final)=3.314 | 4330.5 samples/s | 67.7 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00836 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.862 | L2-Norm(final)=3.315 | 1568.1 samples/s | 24.5 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00780 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.861 | L2-Norm(final)=3.316 | 3522.0 samples/s | 55.0 steps/s
[Step=29950 Epoch=146.0] | Loss=0.00710 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.860 | L2-Norm(final)=3.318 | 3503.4 samples/s | 54.7 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00673 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.859 | L2-Norm(final)=3.319 | 4149.5 samples/s | 64.8 steps/s
[Step=30050 Epoch=146.5] | Loss=0.00635 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.859 | L2-Norm(final)=3.320 | 1093.7 samples/s | 17.1 steps/s
[Step=30100 Epoch=146.8] | Loss=0.00592 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.859 | L2-Norm(final)=3.322 | 3496.0 samples/s | 54.6 steps/s
[Step=30150 Epoch=147.0] | Loss=0.00562 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.858 | L2-Norm(final)=3.323 | 3280.6 samples/s | 51.3 steps/s
[Step=30200 Epoch=147.3] | Loss=0.00560 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.858 | L2-Norm(final)=3.325 | 3954.8 samples/s | 61.8 steps/s
[Step=30250 Epoch=147.5] | Loss=0.00535 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.858 | L2-Norm(final)=3.326 | 1637.1 samples/s | 25.6 steps/s
[Step=30300 Epoch=147.7] | Loss=0.00514 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.858 | L2-Norm(final)=3.328 | 3540.4 samples/s | 55.3 steps/s
[Step=30350 Epoch=148.0] | Loss=0.00508 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.858 | L2-Norm(final)=3.329 | 3499.5 samples/s | 54.7 steps/s
[Step=30400 Epoch=148.2] | Loss=0.00496 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.858 | L2-Norm(final)=3.330 | 3801.5 samples/s | 59.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step30400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.4] | Loss=0.09620 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=16.892 | L2-Norm(final)=3.315 | 3610.1 samples/s | 56.4 steps/s
[Step=29650 Epoch=144.7] | Loss=0.02302 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.877 | L2-Norm(final)=3.306 | 3483.2 samples/s | 54.4 steps/s
[Step=29700 Epoch=144.9] | Loss=0.01530 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.871 | L2-Norm(final)=3.306 | 3558.7 samples/s | 55.6 steps/s
[Step=29750 Epoch=145.2] | Loss=0.01216 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.868 | L2-Norm(final)=3.307 | 3548.6 samples/s | 55.4 steps/s
[Step=29800 Epoch=145.4] | Loss=0.01077 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.867 | L2-Norm(final)=3.308 | 4404.8 samples/s | 68.8 steps/s
[Step=29850 Epoch=145.7] | Loss=0.00922 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.865 | L2-Norm(final)=3.309 | 1593.7 samples/s | 24.9 steps/s
[Step=29900 Epoch=145.9] | Loss=0.00823 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.864 | L2-Norm(final)=3.310 | 3493.4 samples/s | 54.6 steps/s
[Step=29950 Epoch=146.1] | Loss=0.00766 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.863 | L2-Norm(final)=3.312 | 3494.6 samples/s | 54.6 steps/s
[Step=30000 Epoch=146.4] | Loss=0.00714 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.862 | L2-Norm(final)=3.313 | 4262.3 samples/s | 66.6 steps/s
[Step=30050 Epoch=146.6] | Loss=0.00674 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.862 | L2-Norm(final)=3.314 | 1601.6 samples/s | 25.0 steps/s
[Step=30100 Epoch=146.9] | Loss=0.00633 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.861 | L2-Norm(final)=3.315 | 3542.6 samples/s | 55.4 steps/s
[Step=30150 Epoch=147.1] | Loss=0.00606 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.860 | L2-Norm(final)=3.316 | 3531.0 samples/s | 55.2 steps/s
[Step=30200 Epoch=147.4] | Loss=0.00582 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.859 | L2-Norm(final)=3.317 | 4033.6 samples/s | 63.0 steps/s
[Step=30250 Epoch=147.6] | Loss=0.00557 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.859 | L2-Norm(final)=3.318 | 1604.0 samples/s | 25.1 steps/s
[Step=30300 Epoch=147.8] | Loss=0.00544 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.858 | L2-Norm(final)=3.319 | 3434.4 samples/s | 53.7 steps/s
[Step=30350 Epoch=148.1] | Loss=0.00529 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.858 | L2-Norm(final)=3.320 | 3530.0 samples/s | 55.2 steps/s
[Step=30400 Epoch=148.3] | Loss=0.00510 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.857 | L2-Norm(final)=3.321 | 3914.1 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step30400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.2] | Loss=0.16699 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=16.892 | L2-Norm(final)=3.314 | 3610.3 samples/s | 56.4 steps/s
[Step=29650 Epoch=144.5] | Loss=0.01776 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.876 | L2-Norm(final)=3.311 | 3453.9 samples/s | 54.0 steps/s
[Step=29700 Epoch=144.7] | Loss=0.01412 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.871 | L2-Norm(final)=3.311 | 3489.2 samples/s | 54.5 steps/s
[Step=29750 Epoch=145.0] | Loss=0.01162 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.868 | L2-Norm(final)=3.312 | 3495.3 samples/s | 54.6 steps/s
[Step=29800 Epoch=145.2] | Loss=0.00982 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.866 | L2-Norm(final)=3.313 | 4433.1 samples/s | 69.3 steps/s
[Step=29850 Epoch=145.4] | Loss=0.00872 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.865 | L2-Norm(final)=3.315 | 1567.0 samples/s | 24.5 steps/s
[Step=29900 Epoch=145.7] | Loss=0.00791 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.864 | L2-Norm(final)=3.317 | 3577.0 samples/s | 55.9 steps/s
[Step=29950 Epoch=145.9] | Loss=0.00745 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.864 | L2-Norm(final)=3.318 | 3564.4 samples/s | 55.7 steps/s
[Step=30000 Epoch=146.2] | Loss=0.00694 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.863 | L2-Norm(final)=3.320 | 4141.9 samples/s | 64.7 steps/s
[Step=30050 Epoch=146.4] | Loss=0.00648 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.863 | L2-Norm(final)=3.321 | 1625.6 samples/s | 25.4 steps/s
[Step=30100 Epoch=146.7] | Loss=0.00616 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.862 | L2-Norm(final)=3.323 | 3468.6 samples/s | 54.2 steps/s
[Step=30150 Epoch=146.9] | Loss=0.00589 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.862 | L2-Norm(final)=3.324 | 3519.4 samples/s | 55.0 steps/s
[Step=30200 Epoch=147.1] | Loss=0.00568 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.861 | L2-Norm(final)=3.326 | 3967.7 samples/s | 62.0 steps/s
[Step=30250 Epoch=147.4] | Loss=0.00548 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.861 | L2-Norm(final)=3.327 | 1625.1 samples/s | 25.4 steps/s
[Step=30300 Epoch=147.6] | Loss=0.00526 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.861 | L2-Norm(final)=3.328 | 3451.0 samples/s | 53.9 steps/s
[Step=30350 Epoch=147.9] | Loss=0.00507 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.861 | L2-Norm(final)=3.330 | 3440.2 samples/s | 53.8 steps/s
[Step=30400 Epoch=148.1] | Loss=0.00489 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.861 | L2-Norm(final)=3.331 | 3988.5 samples/s | 62.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step30400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.4] | Loss=0.11679 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=16.892 | L2-Norm(final)=3.314 | 3637.1 samples/s | 56.8 steps/s
[Step=29650 Epoch=144.6] | Loss=0.01720 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.876 | L2-Norm(final)=3.309 | 3691.4 samples/s | 57.7 steps/s
[Step=29700 Epoch=144.8] | Loss=0.01170 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.873 | L2-Norm(final)=3.311 | 3521.4 samples/s | 55.0 steps/s
[Step=29750 Epoch=145.1] | Loss=0.00962 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.870 | L2-Norm(final)=3.312 | 3520.9 samples/s | 55.0 steps/s
[Step=29800 Epoch=145.3] | Loss=0.00868 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.869 | L2-Norm(final)=3.314 | 4365.2 samples/s | 68.2 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00746 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.868 | L2-Norm(final)=3.316 | 1570.5 samples/s | 24.5 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00663 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.867 | L2-Norm(final)=3.318 | 3411.3 samples/s | 53.3 steps/s
[Step=29950 Epoch=146.1] | Loss=0.00614 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.866 | L2-Norm(final)=3.320 | 3477.4 samples/s | 54.3 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00577 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.865 | L2-Norm(final)=3.321 | 4079.8 samples/s | 63.7 steps/s
[Step=30050 Epoch=146.5] | Loss=0.00549 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.865 | L2-Norm(final)=3.323 | 1582.4 samples/s | 24.7 steps/s
[Step=30100 Epoch=146.8] | Loss=0.00509 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.864 | L2-Norm(final)=3.324 | 3484.6 samples/s | 54.4 steps/s
[Step=30150 Epoch=147.0] | Loss=0.00489 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.863 | L2-Norm(final)=3.326 | 3449.6 samples/s | 53.9 steps/s
[Step=30200 Epoch=147.3] | Loss=0.00472 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.863 | L2-Norm(final)=3.327 | 3874.8 samples/s | 60.5 steps/s
[Step=30250 Epoch=147.5] | Loss=0.00461 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.862 | L2-Norm(final)=3.328 | 1678.7 samples/s | 26.2 steps/s
[Step=30300 Epoch=147.8] | Loss=0.00453 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.862 | L2-Norm(final)=3.329 | 3546.8 samples/s | 55.4 steps/s
[Step=30350 Epoch=148.0] | Loss=0.00450 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.862 | L2-Norm(final)=3.330 | 3446.4 samples/s | 53.9 steps/s
[Step=30400 Epoch=148.2] | Loss=0.00443 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.861 | L2-Norm(final)=3.331 | 3739.6 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step30400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=145.2] | Loss=0.10974 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.892 | L2-Norm(final)=3.315 | 3853.8 samples/s | 60.2 steps/s
[Step=29650 Epoch=145.4] | Loss=0.01955 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.874 | L2-Norm(final)=3.310 | 3189.7 samples/s | 49.8 steps/s
[Step=29700 Epoch=145.6] | Loss=0.01421 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.871 | L2-Norm(final)=3.309 | 3492.5 samples/s | 54.6 steps/s
[Step=29750 Epoch=145.9] | Loss=0.01201 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.870 | L2-Norm(final)=3.309 | 3564.0 samples/s | 55.7 steps/s
[Step=29800 Epoch=146.1] | Loss=0.01035 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.868 | L2-Norm(final)=3.310 | 4353.4 samples/s | 68.0 steps/s
[Step=29850 Epoch=146.4] | Loss=0.00901 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.867 | L2-Norm(final)=3.312 | 1525.2 samples/s | 23.8 steps/s
[Step=29900 Epoch=146.6] | Loss=0.00816 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.866 | L2-Norm(final)=3.313 | 3488.9 samples/s | 54.5 steps/s
[Step=29950 Epoch=146.9] | Loss=0.00755 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.866 | L2-Norm(final)=3.315 | 3502.6 samples/s | 54.7 steps/s
[Step=30000 Epoch=147.1] | Loss=0.00693 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.865 | L2-Norm(final)=3.317 | 4279.8 samples/s | 66.9 steps/s
[Step=30050 Epoch=147.4] | Loss=0.00661 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.865 | L2-Norm(final)=3.318 | 1597.5 samples/s | 25.0 steps/s
[Step=30100 Epoch=147.6] | Loss=0.00611 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.864 | L2-Norm(final)=3.320 | 3536.6 samples/s | 55.3 steps/s
[Step=30150 Epoch=147.9] | Loss=0.00584 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.864 | L2-Norm(final)=3.322 | 3461.5 samples/s | 54.1 steps/s
[Step=30200 Epoch=148.1] | Loss=0.00556 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.864 | L2-Norm(final)=3.323 | 4121.8 samples/s | 64.4 steps/s
[Step=30250 Epoch=148.3] | Loss=0.00534 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.863 | L2-Norm(final)=3.325 | 1601.3 samples/s | 25.0 steps/s
[Step=30300 Epoch=148.6] | Loss=0.00505 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.863 | L2-Norm(final)=3.326 | 3515.4 samples/s | 54.9 steps/s
[Step=30350 Epoch=148.8] | Loss=0.00484 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.862 | L2-Norm(final)=3.328 | 3509.2 samples/s | 54.8 steps/s
[Step=30400 Epoch=149.1] | Loss=0.00475 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.862 | L2-Norm(final)=3.329 | 3940.4 samples/s | 61.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step30400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=280.5] | Loss=0.12086 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.892 | L2-Norm(final)=3.315 | 3497.0 samples/s | 54.6 steps/s
[Step=29650 Epoch=281.0] | Loss=0.00400 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.849 | L2-Norm(final)=3.321 | 3191.2 samples/s | 49.9 steps/s
[Step=29700 Epoch=281.4] | Loss=0.00203 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.842 | L2-Norm(final)=3.321 | 4163.9 samples/s | 65.1 steps/s
[Step=29750 Epoch=281.9] | Loss=0.00137 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.837 | L2-Norm(final)=3.322 | 1551.6 samples/s | 24.2 steps/s
[Step=29800 Epoch=282.4] | Loss=0.00103 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.834 | L2-Norm(final)=3.322 | 4030.7 samples/s | 63.0 steps/s
[Step=29850 Epoch=282.9] | Loss=0.00083 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.831 | L2-Norm(final)=3.322 | 1544.5 samples/s | 24.1 steps/s
[Step=29900 Epoch=283.3] | Loss=0.00069 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.828 | L2-Norm(final)=3.322 | 3875.5 samples/s | 60.6 steps/s
[Step=29950 Epoch=283.8] | Loss=0.00060 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.826 | L2-Norm(final)=3.322 | 1640.5 samples/s | 25.6 steps/s
[Step=30000 Epoch=284.3] | Loss=0.00053 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.824 | L2-Norm(final)=3.322 | 3640.2 samples/s | 56.9 steps/s
[Step=30050 Epoch=284.7] | Loss=0.00047 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.822 | L2-Norm(final)=3.322 | 1627.6 samples/s | 25.4 steps/s
[Step=30100 Epoch=285.2] | Loss=0.00042 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.821 | L2-Norm(final)=3.323 | 3378.9 samples/s | 52.8 steps/s
[Step=30150 Epoch=285.7] | Loss=0.00039 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.819 | L2-Norm(final)=3.323 | 1652.0 samples/s | 25.8 steps/s
[Step=30200 Epoch=286.2] | Loss=0.00036 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.818 | L2-Norm(final)=3.323 | 3443.4 samples/s | 53.8 steps/s
[Step=30250 Epoch=286.6] | Loss=0.00033 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.816 | L2-Norm(final)=3.323 | 1690.6 samples/s | 26.4 steps/s
[Step=30300 Epoch=287.1] | Loss=0.00031 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.815 | L2-Norm(final)=3.323 | 3352.2 samples/s | 52.4 steps/s
[Step=30350 Epoch=287.6] | Loss=0.00029 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.814 | L2-Norm(final)=3.323 | 1660.2 samples/s | 25.9 steps/s
[Step=30400 Epoch=288.1] | Loss=0.00027 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.813 | L2-Norm(final)=3.323 | 3356.4 samples/s | 52.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step30400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=281.6] | Loss=0.03961 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.892 | L2-Norm(final)=3.315 | 3732.7 samples/s | 58.3 steps/s
[Step=29650 Epoch=282.0] | Loss=0.00249 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.849 | L2-Norm(final)=3.323 | 3053.4 samples/s | 47.7 steps/s
[Step=29700 Epoch=282.5] | Loss=0.00126 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.842 | L2-Norm(final)=3.325 | 4215.0 samples/s | 65.9 steps/s
[Step=29750 Epoch=283.0] | Loss=0.00085 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.837 | L2-Norm(final)=3.325 | 1550.4 samples/s | 24.2 steps/s
[Step=29800 Epoch=283.5] | Loss=0.00064 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.833 | L2-Norm(final)=3.325 | 3924.0 samples/s | 61.3 steps/s
[Step=29850 Epoch=283.9] | Loss=0.00052 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.830 | L2-Norm(final)=3.325 | 1551.1 samples/s | 24.2 steps/s
[Step=29900 Epoch=284.4] | Loss=0.00043 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.827 | L2-Norm(final)=3.325 | 3823.0 samples/s | 59.7 steps/s
[Step=29950 Epoch=284.9] | Loss=0.00037 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.825 | L2-Norm(final)=3.325 | 1570.1 samples/s | 24.5 steps/s
[Step=30000 Epoch=285.4] | Loss=0.00033 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.823 | L2-Norm(final)=3.325 | 3632.3 samples/s | 56.8 steps/s
[Step=30050 Epoch=285.9] | Loss=0.00030 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.821 | L2-Norm(final)=3.325 | 1670.1 samples/s | 26.1 steps/s
[Step=30100 Epoch=286.3] | Loss=0.00027 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.820 | L2-Norm(final)=3.325 | 3483.4 samples/s | 54.4 steps/s
[Step=30150 Epoch=286.8] | Loss=0.00024 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.818 | L2-Norm(final)=3.324 | 1683.1 samples/s | 26.3 steps/s
[Step=30200 Epoch=287.3] | Loss=0.00023 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.817 | L2-Norm(final)=3.324 | 3380.0 samples/s | 52.8 steps/s
[Step=30250 Epoch=287.8] | Loss=0.00021 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.815 | L2-Norm(final)=3.324 | 1658.2 samples/s | 25.9 steps/s
[Step=30300 Epoch=288.2] | Loss=0.00020 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.814 | L2-Norm(final)=3.324 | 3342.8 samples/s | 52.2 steps/s
[Step=30350 Epoch=288.7] | Loss=0.00018 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.813 | L2-Norm(final)=3.324 | 1684.6 samples/s | 26.3 steps/s
[Step=30400 Epoch=289.2] | Loss=0.00017 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.812 | L2-Norm(final)=3.324 | 3379.5 samples/s | 52.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step30400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=282.7] | Loss=0.09513 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.892 | L2-Norm(final)=3.315 | 3773.7 samples/s | 59.0 steps/s
[Step=29650 Epoch=283.1] | Loss=0.00345 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.851 | L2-Norm(final)=3.321 | 3115.9 samples/s | 48.7 steps/s
[Step=29700 Epoch=283.6] | Loss=0.00174 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.844 | L2-Norm(final)=3.322 | 4226.0 samples/s | 66.0 steps/s
[Step=29750 Epoch=284.1] | Loss=0.00117 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.839 | L2-Norm(final)=3.322 | 1502.4 samples/s | 23.5 steps/s
[Step=29800 Epoch=284.6] | Loss=0.00088 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.835 | L2-Norm(final)=3.322 | 4008.8 samples/s | 62.6 steps/s
[Step=29850 Epoch=285.0] | Loss=0.00071 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.832 | L2-Norm(final)=3.322 | 1586.1 samples/s | 24.8 steps/s
[Step=29900 Epoch=285.5] | Loss=0.00060 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.829 | L2-Norm(final)=3.323 | 3870.8 samples/s | 60.5 steps/s
[Step=29950 Epoch=286.0] | Loss=0.00051 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.827 | L2-Norm(final)=3.323 | 1584.3 samples/s | 24.8 steps/s
[Step=30000 Epoch=286.5] | Loss=0.00045 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.825 | L2-Norm(final)=3.323 | 3691.5 samples/s | 57.7 steps/s
[Step=30050 Epoch=287.0] | Loss=0.00040 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.823 | L2-Norm(final)=3.323 | 1593.7 samples/s | 24.9 steps/s
[Step=30100 Epoch=287.4] | Loss=0.00036 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.822 | L2-Norm(final)=3.323 | 3497.6 samples/s | 54.6 steps/s
[Step=30150 Epoch=287.9] | Loss=0.00033 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.820 | L2-Norm(final)=3.323 | 1630.6 samples/s | 25.5 steps/s
[Step=30200 Epoch=288.4] | Loss=0.00031 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.819 | L2-Norm(final)=3.323 | 3465.9 samples/s | 54.2 steps/s
[Step=30250 Epoch=288.9] | Loss=0.00028 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.818 | L2-Norm(final)=3.323 | 1661.7 samples/s | 26.0 steps/s
[Step=30300 Epoch=289.3] | Loss=0.00027 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.817 | L2-Norm(final)=3.323 | 3431.9 samples/s | 53.6 steps/s
[Step=30350 Epoch=289.8] | Loss=0.00025 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.816 | L2-Norm(final)=3.323 | 1716.6 samples/s | 26.8 steps/s
[Step=30400 Epoch=290.3] | Loss=0.00023 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.815 | L2-Norm(final)=3.323 | 3509.9 samples/s | 54.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step30400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=278.9] | Loss=0.09959 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.892 | L2-Norm(final)=3.315 | 3511.5 samples/s | 54.9 steps/s
[Step=29650 Epoch=279.4] | Loss=0.00636 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.852 | L2-Norm(final)=3.318 | 3411.2 samples/s | 53.3 steps/s
[Step=29700 Epoch=279.9] | Loss=0.00332 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.845 | L2-Norm(final)=3.318 | 4283.6 samples/s | 66.9 steps/s
[Step=29750 Epoch=280.3] | Loss=0.00223 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.841 | L2-Norm(final)=3.319 | 1541.2 samples/s | 24.1 steps/s
[Step=29800 Epoch=280.8] | Loss=0.00168 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.838 | L2-Norm(final)=3.320 | 4066.2 samples/s | 63.5 steps/s
[Step=29850 Epoch=281.3] | Loss=0.00135 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.835 | L2-Norm(final)=3.320 | 1627.0 samples/s | 25.4 steps/s
[Step=29900 Epoch=281.7] | Loss=0.00113 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.832 | L2-Norm(final)=3.320 | 3725.8 samples/s | 58.2 steps/s
[Step=29950 Epoch=282.2] | Loss=0.00097 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.830 | L2-Norm(final)=3.320 | 1639.2 samples/s | 25.6 steps/s
[Step=30000 Epoch=282.7] | Loss=0.00085 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.828 | L2-Norm(final)=3.320 | 3483.5 samples/s | 54.4 steps/s
[Step=30050 Epoch=283.2] | Loss=0.00076 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.826 | L2-Norm(final)=3.320 | 1624.7 samples/s | 25.4 steps/s
[Step=30100 Epoch=283.6] | Loss=0.00068 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.825 | L2-Norm(final)=3.320 | 3395.8 samples/s | 53.1 steps/s
[Step=30150 Epoch=284.1] | Loss=0.00062 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.823 | L2-Norm(final)=3.320 | 1665.5 samples/s | 26.0 steps/s
[Step=30200 Epoch=284.6] | Loss=0.00057 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.822 | L2-Norm(final)=3.320 | 3419.3 samples/s | 53.4 steps/s
[Step=30250 Epoch=285.0] | Loss=0.00053 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.821 | L2-Norm(final)=3.320 | 1688.0 samples/s | 26.4 steps/s
[Step=30300 Epoch=285.5] | Loss=0.00049 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.819 | L2-Norm(final)=3.321 | 3445.8 samples/s | 53.8 steps/s
[Step=30350 Epoch=286.0] | Loss=0.00046 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.818 | L2-Norm(final)=3.321 | 1739.9 samples/s | 27.2 steps/s
[Step=30400 Epoch=286.5] | Loss=0.00043 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.817 | L2-Norm(final)=3.321 | 3102.6 samples/s | 48.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step30400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=282.1] | Loss=0.07761 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.892 | L2-Norm(final)=3.315 | 3499.5 samples/s | 54.7 steps/s
[Step=29650 Epoch=282.6] | Loss=0.00985 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.849 | L2-Norm(final)=3.314 | 3380.2 samples/s | 52.8 steps/s
[Step=29700 Epoch=283.1] | Loss=0.00497 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.842 | L2-Norm(final)=3.314 | 4204.2 samples/s | 65.7 steps/s
[Step=29750 Epoch=283.5] | Loss=0.00333 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.837 | L2-Norm(final)=3.314 | 1526.8 samples/s | 23.9 steps/s
[Step=29800 Epoch=284.0] | Loss=0.00250 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.834 | L2-Norm(final)=3.314 | 3985.6 samples/s | 62.3 steps/s
[Step=29850 Epoch=284.5] | Loss=0.00201 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.831 | L2-Norm(final)=3.315 | 1586.3 samples/s | 24.8 steps/s
[Step=29900 Epoch=285.0] | Loss=0.00168 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.829 | L2-Norm(final)=3.315 | 3802.7 samples/s | 59.4 steps/s
[Step=29950 Epoch=285.5] | Loss=0.00144 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.827 | L2-Norm(final)=3.315 | 1567.3 samples/s | 24.5 steps/s
[Step=30000 Epoch=285.9] | Loss=0.00127 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.825 | L2-Norm(final)=3.315 | 3663.2 samples/s | 57.2 steps/s
[Step=30050 Epoch=286.4] | Loss=0.00113 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.823 | L2-Norm(final)=3.315 | 1611.3 samples/s | 25.2 steps/s
[Step=30100 Epoch=286.9] | Loss=0.00102 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.822 | L2-Norm(final)=3.315 | 3592.8 samples/s | 56.1 steps/s
[Step=30150 Epoch=287.4] | Loss=0.00093 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.821 | L2-Norm(final)=3.315 | 1642.5 samples/s | 25.7 steps/s
[Step=30200 Epoch=287.8] | Loss=0.00085 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.819 | L2-Norm(final)=3.315 | 3519.1 samples/s | 55.0 steps/s
[Step=30250 Epoch=288.3] | Loss=0.00079 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.818 | L2-Norm(final)=3.316 | 1701.9 samples/s | 26.6 steps/s
[Step=30300 Epoch=288.8] | Loss=0.00073 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.817 | L2-Norm(final)=3.316 | 3348.2 samples/s | 52.3 steps/s
[Step=30350 Epoch=289.3] | Loss=0.00068 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.816 | L2-Norm(final)=3.316 | 1698.7 samples/s | 26.5 steps/s
[Step=30400 Epoch=289.7] | Loss=0.00064 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.815 | L2-Norm(final)=3.316 | 3392.7 samples/s | 53.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23303 | acc=0.8754 | tpr=0.8258 | fpr=0.0168 | 3673.8 samples/s | 14.4 steps/s
Avg test loss: 0.23484, Avg test acc: 0.87503, Avg tpr: 0.82549, Avg fpr: 0.01602, total FA: 125

Testing server on iccad2012
[Step=  50] | Loss=0.41860 | acc=0.8727 | tpr=0.9602 | fpr=0.1288 | 3704.6 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.42765 | acc=0.8720 | tpr=0.9595 | fpr=0.1296 | 7053.9 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.43399 | acc=0.8711 | tpr=0.9640 | fpr=0.1306 | 6858.8 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.43466 | acc=0.8720 | tpr=0.9639 | fpr=0.1297 | 6947.8 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.43378 | acc=0.8721 | tpr=0.9659 | fpr=0.1296 | 7074.2 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.43278 | acc=0.8727 | tpr=0.9622 | fpr=0.1289 | 7480.7 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.43503 | acc=0.8725 | tpr=0.9612 | fpr=0.1291 | 6899.8 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.43577 | acc=0.8725 | tpr=0.9595 | fpr=0.1290 | 6869.0 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.43984 | acc=0.8719 | tpr=0.9596 | fpr=0.1297 | 6962.2 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.44028 | acc=0.8717 | tpr=0.9612 | fpr=0.1299 | 6838.4 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.43933 | acc=0.8721 | tpr=0.9630 | fpr=0.1296 | 12957.6 samples/s | 50.6 steps/s
Avg test loss: 0.43913, Avg test acc: 0.87205, Avg tpr: 0.96315, Avg fpr: 0.12961, total FA: 17996

server round 38/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.2] | Loss=0.10204 | Reg=0.00283 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=16.821 | L2-Norm(final)=3.333 | 3893.2 samples/s | 60.8 steps/s
[Step=30450 Epoch=148.5] | Loss=0.01928 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.807 | L2-Norm(final)=3.327 | 3232.6 samples/s | 50.5 steps/s
[Step=30500 Epoch=148.7] | Loss=0.01426 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.801 | L2-Norm(final)=3.326 | 3526.1 samples/s | 55.1 steps/s
[Step=30550 Epoch=149.0] | Loss=0.01222 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.797 | L2-Norm(final)=3.327 | 3512.0 samples/s | 54.9 steps/s
[Step=30600 Epoch=149.2] | Loss=0.01096 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.796 | L2-Norm(final)=3.327 | 4343.9 samples/s | 67.9 steps/s
[Step=30650 Epoch=149.5] | Loss=0.00977 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.794 | L2-Norm(final)=3.328 | 1571.6 samples/s | 24.6 steps/s
[Step=30700 Epoch=149.7] | Loss=0.00861 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.793 | L2-Norm(final)=3.329 | 3525.6 samples/s | 55.1 steps/s
[Step=30750 Epoch=149.9] | Loss=0.00798 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.793 | L2-Norm(final)=3.330 | 3504.2 samples/s | 54.8 steps/s
[Step=30800 Epoch=150.2] | Loss=0.00745 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.792 | L2-Norm(final)=3.331 | 4214.4 samples/s | 65.9 steps/s
[Step=30850 Epoch=150.4] | Loss=0.00707 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.791 | L2-Norm(final)=3.333 | 1581.9 samples/s | 24.7 steps/s
[Step=30900 Epoch=150.7] | Loss=0.00676 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.791 | L2-Norm(final)=3.334 | 3413.0 samples/s | 53.3 steps/s
[Step=30950 Epoch=150.9] | Loss=0.00633 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.790 | L2-Norm(final)=3.336 | 3490.9 samples/s | 54.5 steps/s
[Step=31000 Epoch=151.2] | Loss=0.00614 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.790 | L2-Norm(final)=3.337 | 3915.6 samples/s | 61.2 steps/s
[Step=31050 Epoch=151.4] | Loss=0.00587 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.790 | L2-Norm(final)=3.338 | 1646.4 samples/s | 25.7 steps/s
[Step=31100 Epoch=151.6] | Loss=0.00560 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.790 | L2-Norm(final)=3.339 | 3471.2 samples/s | 54.2 steps/s
[Step=31150 Epoch=151.9] | Loss=0.00547 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.789 | L2-Norm(final)=3.341 | 3473.4 samples/s | 54.3 steps/s
[Step=31200 Epoch=152.1] | Loss=0.00534 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.789 | L2-Norm(final)=3.342 | 3872.9 samples/s | 60.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step31200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.3] | Loss=0.18768 | Reg=0.00283 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.821 | L2-Norm(final)=3.333 | 3901.7 samples/s | 61.0 steps/s
[Step=30450 Epoch=148.6] | Loss=0.01860 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.801 | L2-Norm(final)=3.328 | 3480.3 samples/s | 54.4 steps/s
[Step=30500 Epoch=148.8] | Loss=0.01296 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.796 | L2-Norm(final)=3.328 | 3517.2 samples/s | 55.0 steps/s
[Step=30550 Epoch=149.1] | Loss=0.01032 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.794 | L2-Norm(final)=3.329 | 3478.0 samples/s | 54.3 steps/s
[Step=30600 Epoch=149.3] | Loss=0.00951 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.792 | L2-Norm(final)=3.330 | 4370.7 samples/s | 68.3 steps/s
[Step=30650 Epoch=149.6] | Loss=0.00822 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.792 | L2-Norm(final)=3.332 | 1559.5 samples/s | 24.4 steps/s
[Step=30700 Epoch=149.8] | Loss=0.00749 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.791 | L2-Norm(final)=3.333 | 3458.2 samples/s | 54.0 steps/s
[Step=30750 Epoch=150.0] | Loss=0.00713 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.790 | L2-Norm(final)=3.334 | 3478.8 samples/s | 54.4 steps/s
[Step=30800 Epoch=150.3] | Loss=0.00670 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.790 | L2-Norm(final)=3.335 | 4154.6 samples/s | 64.9 steps/s
[Step=30850 Epoch=150.5] | Loss=0.00616 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.789 | L2-Norm(final)=3.336 | 1592.8 samples/s | 24.9 steps/s
[Step=30900 Epoch=150.8] | Loss=0.00586 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.788 | L2-Norm(final)=3.337 | 3542.3 samples/s | 55.3 steps/s
[Step=30950 Epoch=151.0] | Loss=0.00565 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.788 | L2-Norm(final)=3.338 | 3568.9 samples/s | 55.8 steps/s
[Step=31000 Epoch=151.3] | Loss=0.00542 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.787 | L2-Norm(final)=3.339 | 4054.0 samples/s | 63.3 steps/s
[Step=31050 Epoch=151.5] | Loss=0.00530 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.787 | L2-Norm(final)=3.340 | 1609.2 samples/s | 25.1 steps/s
[Step=31100 Epoch=151.8] | Loss=0.00509 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.787 | L2-Norm(final)=3.341 | 3660.2 samples/s | 57.2 steps/s
[Step=31150 Epoch=152.0] | Loss=0.00492 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.786 | L2-Norm(final)=3.342 | 3530.4 samples/s | 55.2 steps/s
[Step=31200 Epoch=152.2] | Loss=0.00476 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.786 | L2-Norm(final)=3.343 | 3881.6 samples/s | 60.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step31200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.1] | Loss=0.04689 | Reg=0.00283 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.821 | L2-Norm(final)=3.333 | 3780.7 samples/s | 59.1 steps/s
[Step=30450 Epoch=148.4] | Loss=0.02130 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.806 | L2-Norm(final)=3.328 | 3382.0 samples/s | 52.8 steps/s
[Step=30500 Epoch=148.6] | Loss=0.01528 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.801 | L2-Norm(final)=3.327 | 3530.5 samples/s | 55.2 steps/s
[Step=30550 Epoch=148.9] | Loss=0.01221 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.798 | L2-Norm(final)=3.328 | 3580.7 samples/s | 55.9 steps/s
[Step=30600 Epoch=149.1] | Loss=0.01040 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.796 | L2-Norm(final)=3.329 | 4339.0 samples/s | 67.8 steps/s
[Step=30650 Epoch=149.3] | Loss=0.00914 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.795 | L2-Norm(final)=3.331 | 1581.2 samples/s | 24.7 steps/s
[Step=30700 Epoch=149.6] | Loss=0.00835 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.794 | L2-Norm(final)=3.332 | 3532.6 samples/s | 55.2 steps/s
[Step=30750 Epoch=149.8] | Loss=0.00766 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.793 | L2-Norm(final)=3.333 | 3543.3 samples/s | 55.4 steps/s
[Step=30800 Epoch=150.1] | Loss=0.00704 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.792 | L2-Norm(final)=3.335 | 4169.1 samples/s | 65.1 steps/s
[Step=30850 Epoch=150.3] | Loss=0.00663 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.791 | L2-Norm(final)=3.336 | 1611.6 samples/s | 25.2 steps/s
[Step=30900 Epoch=150.6] | Loss=0.00616 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.791 | L2-Norm(final)=3.338 | 3526.4 samples/s | 55.1 steps/s
[Step=30950 Epoch=150.8] | Loss=0.00585 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.791 | L2-Norm(final)=3.340 | 3504.6 samples/s | 54.8 steps/s
[Step=31000 Epoch=151.0] | Loss=0.00569 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.790 | L2-Norm(final)=3.341 | 3912.9 samples/s | 61.1 steps/s
[Step=31050 Epoch=151.3] | Loss=0.00544 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.790 | L2-Norm(final)=3.342 | 1631.8 samples/s | 25.5 steps/s
[Step=31100 Epoch=151.5] | Loss=0.00527 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.789 | L2-Norm(final)=3.344 | 3561.6 samples/s | 55.6 steps/s
[Step=31150 Epoch=151.8] | Loss=0.00511 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.789 | L2-Norm(final)=3.345 | 3494.4 samples/s | 54.6 steps/s
[Step=31200 Epoch=152.0] | Loss=0.00496 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.789 | L2-Norm(final)=3.346 | 3944.9 samples/s | 61.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step31200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.3] | Loss=0.01814 | Reg=0.00283 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.821 | L2-Norm(final)=3.334 | 3708.8 samples/s | 57.9 steps/s
[Step=30450 Epoch=148.5] | Loss=0.01957 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.809 | L2-Norm(final)=3.328 | 3333.8 samples/s | 52.1 steps/s
[Step=30500 Epoch=148.7] | Loss=0.01307 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.804 | L2-Norm(final)=3.328 | 3516.5 samples/s | 54.9 steps/s
[Step=30550 Epoch=149.0] | Loss=0.01029 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.802 | L2-Norm(final)=3.330 | 3609.9 samples/s | 56.4 steps/s
[Step=30600 Epoch=149.2] | Loss=0.00893 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.800 | L2-Norm(final)=3.332 | 4287.5 samples/s | 67.0 steps/s
[Step=30650 Epoch=149.5] | Loss=0.00775 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.799 | L2-Norm(final)=3.333 | 1548.2 samples/s | 24.2 steps/s
[Step=30700 Epoch=149.7] | Loss=0.00708 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.798 | L2-Norm(final)=3.335 | 3486.6 samples/s | 54.5 steps/s
[Step=30750 Epoch=150.0] | Loss=0.00655 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.797 | L2-Norm(final)=3.337 | 3503.2 samples/s | 54.7 steps/s
[Step=30800 Epoch=150.2] | Loss=0.00602 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.796 | L2-Norm(final)=3.338 | 4119.8 samples/s | 64.4 steps/s
[Step=30850 Epoch=150.4] | Loss=0.00561 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.795 | L2-Norm(final)=3.340 | 1599.1 samples/s | 25.0 steps/s
[Step=30900 Epoch=150.7] | Loss=0.00533 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.795 | L2-Norm(final)=3.341 | 3611.8 samples/s | 56.4 steps/s
[Step=30950 Epoch=150.9] | Loss=0.00510 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.794 | L2-Norm(final)=3.343 | 3503.7 samples/s | 54.7 steps/s
[Step=31000 Epoch=151.2] | Loss=0.00494 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.793 | L2-Norm(final)=3.344 | 3943.6 samples/s | 61.6 steps/s
[Step=31050 Epoch=151.4] | Loss=0.00470 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.793 | L2-Norm(final)=3.345 | 1651.6 samples/s | 25.8 steps/s
[Step=31100 Epoch=151.7] | Loss=0.00459 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.792 | L2-Norm(final)=3.346 | 3488.8 samples/s | 54.5 steps/s
[Step=31150 Epoch=151.9] | Loss=0.00450 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.792 | L2-Norm(final)=3.347 | 3503.9 samples/s | 54.7 steps/s
[Step=31200 Epoch=152.1] | Loss=0.00435 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.791 | L2-Norm(final)=3.348 | 3714.5 samples/s | 58.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step31200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=149.1] | Loss=0.08476 | Reg=0.00283 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.821 | L2-Norm(final)=3.333 | 3554.4 samples/s | 55.5 steps/s
[Step=30450 Epoch=149.3] | Loss=0.02074 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.809 | L2-Norm(final)=3.327 | 3401.7 samples/s | 53.2 steps/s
[Step=30500 Epoch=149.6] | Loss=0.01648 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.804 | L2-Norm(final)=3.325 | 3566.8 samples/s | 55.7 steps/s
[Step=30550 Epoch=149.8] | Loss=0.01364 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.801 | L2-Norm(final)=3.324 | 3487.4 samples/s | 54.5 steps/s
[Step=30600 Epoch=150.1] | Loss=0.01207 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.799 | L2-Norm(final)=3.325 | 4407.4 samples/s | 68.9 steps/s
[Step=30650 Epoch=150.3] | Loss=0.01030 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.798 | L2-Norm(final)=3.326 | 1580.5 samples/s | 24.7 steps/s
[Step=30700 Epoch=150.5] | Loss=0.00921 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.797 | L2-Norm(final)=3.327 | 3518.4 samples/s | 55.0 steps/s
[Step=30750 Epoch=150.8] | Loss=0.00833 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.796 | L2-Norm(final)=3.329 | 3456.4 samples/s | 54.0 steps/s
[Step=30800 Epoch=151.0] | Loss=0.00766 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.795 | L2-Norm(final)=3.330 | 4382.3 samples/s | 68.5 steps/s
[Step=30850 Epoch=151.3] | Loss=0.00709 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.795 | L2-Norm(final)=3.332 | 1575.3 samples/s | 24.6 steps/s
[Step=30900 Epoch=151.5] | Loss=0.00654 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.795 | L2-Norm(final)=3.334 | 3504.8 samples/s | 54.8 steps/s
[Step=30950 Epoch=151.8] | Loss=0.00621 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.794 | L2-Norm(final)=3.335 | 3481.9 samples/s | 54.4 steps/s
[Step=31000 Epoch=152.0] | Loss=0.00587 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.794 | L2-Norm(final)=3.337 | 4144.5 samples/s | 64.8 steps/s
[Step=31050 Epoch=152.3] | Loss=0.00557 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.794 | L2-Norm(final)=3.339 | 1597.4 samples/s | 25.0 steps/s
[Step=31100 Epoch=152.5] | Loss=0.00532 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.793 | L2-Norm(final)=3.340 | 3472.9 samples/s | 54.3 steps/s
[Step=31150 Epoch=152.8] | Loss=0.00512 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.793 | L2-Norm(final)=3.341 | 3536.0 samples/s | 55.2 steps/s
[Step=31200 Epoch=153.0] | Loss=0.00498 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.793 | L2-Norm(final)=3.343 | 4038.6 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step31200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=288.1] | Loss=0.01012 | Reg=0.00283 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.821 | L2-Norm(final)=3.334 | 3879.8 samples/s | 60.6 steps/s
[Step=30450 Epoch=288.5] | Loss=0.00229 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.780 | L2-Norm(final)=3.342 | 3127.9 samples/s | 48.9 steps/s
[Step=30500 Epoch=289.0] | Loss=0.00119 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.773 | L2-Norm(final)=3.344 | 4300.2 samples/s | 67.2 steps/s
[Step=30550 Epoch=289.5] | Loss=0.00080 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.768 | L2-Norm(final)=3.345 | 1509.3 samples/s | 23.6 steps/s
[Step=30600 Epoch=290.0] | Loss=0.00061 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.764 | L2-Norm(final)=3.345 | 3959.9 samples/s | 61.9 steps/s
[Step=30650 Epoch=290.4] | Loss=0.00049 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.761 | L2-Norm(final)=3.345 | 1559.3 samples/s | 24.4 steps/s
[Step=30700 Epoch=290.9] | Loss=0.00041 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.758 | L2-Norm(final)=3.345 | 3758.3 samples/s | 58.7 steps/s
[Step=30750 Epoch=291.4] | Loss=0.00035 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.756 | L2-Norm(final)=3.345 | 1580.9 samples/s | 24.7 steps/s
[Step=30800 Epoch=291.9] | Loss=0.00031 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.754 | L2-Norm(final)=3.345 | 3553.6 samples/s | 55.5 steps/s
[Step=30850 Epoch=292.3] | Loss=0.00028 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.752 | L2-Norm(final)=3.345 | 1598.6 samples/s | 25.0 steps/s
[Step=30900 Epoch=292.8] | Loss=0.00025 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.750 | L2-Norm(final)=3.344 | 3382.9 samples/s | 52.9 steps/s
[Step=30950 Epoch=293.3] | Loss=0.00023 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.749 | L2-Norm(final)=3.344 | 1693.8 samples/s | 26.5 steps/s
[Step=31000 Epoch=293.8] | Loss=0.00021 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.747 | L2-Norm(final)=3.344 | 3547.1 samples/s | 55.4 steps/s
[Step=31050 Epoch=294.2] | Loss=0.00019 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.746 | L2-Norm(final)=3.344 | 1684.0 samples/s | 26.3 steps/s
[Step=31100 Epoch=294.7] | Loss=0.00018 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.745 | L2-Norm(final)=3.344 | 3378.3 samples/s | 52.8 steps/s
[Step=31150 Epoch=295.2] | Loss=0.00017 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.743 | L2-Norm(final)=3.344 | 1649.0 samples/s | 25.8 steps/s
[Step=31200 Epoch=295.6] | Loss=0.00016 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.742 | L2-Norm(final)=3.344 | 3317.4 samples/s | 51.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step31200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=289.2] | Loss=0.00421 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.821 | L2-Norm(final)=3.334 | 3380.3 samples/s | 52.8 steps/s
[Step=30450 Epoch=289.7] | Loss=0.00477 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.777 | L2-Norm(final)=3.338 | 3351.6 samples/s | 52.4 steps/s
[Step=30500 Epoch=290.1] | Loss=0.00242 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.771 | L2-Norm(final)=3.339 | 4198.4 samples/s | 65.6 steps/s
[Step=30550 Epoch=290.6] | Loss=0.00163 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.766 | L2-Norm(final)=3.339 | 1528.5 samples/s | 23.9 steps/s
[Step=30600 Epoch=291.1] | Loss=0.00123 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.763 | L2-Norm(final)=3.339 | 4057.4 samples/s | 63.4 steps/s
[Step=30650 Epoch=291.6] | Loss=0.00098 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.760 | L2-Norm(final)=3.339 | 1569.8 samples/s | 24.5 steps/s
[Step=30700 Epoch=292.0] | Loss=0.00082 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.757 | L2-Norm(final)=3.339 | 3867.5 samples/s | 60.4 steps/s
[Step=30750 Epoch=292.5] | Loss=0.00071 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.755 | L2-Norm(final)=3.339 | 1578.4 samples/s | 24.7 steps/s
[Step=30800 Epoch=293.0] | Loss=0.00062 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.753 | L2-Norm(final)=3.340 | 3576.8 samples/s | 55.9 steps/s
[Step=30850 Epoch=293.5] | Loss=0.00056 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.752 | L2-Norm(final)=3.340 | 1601.9 samples/s | 25.0 steps/s
[Step=30900 Epoch=293.9] | Loss=0.00050 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.750 | L2-Norm(final)=3.340 | 3452.1 samples/s | 53.9 steps/s
[Step=30950 Epoch=294.4] | Loss=0.00046 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.748 | L2-Norm(final)=3.340 | 1661.8 samples/s | 26.0 steps/s
[Step=31000 Epoch=294.9] | Loss=0.00042 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.747 | L2-Norm(final)=3.340 | 3361.2 samples/s | 52.5 steps/s
[Step=31050 Epoch=295.4] | Loss=0.00039 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.746 | L2-Norm(final)=3.340 | 1650.8 samples/s | 25.8 steps/s
[Step=31100 Epoch=295.8] | Loss=0.00036 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.745 | L2-Norm(final)=3.340 | 3302.3 samples/s | 51.6 steps/s
[Step=31150 Epoch=296.3] | Loss=0.00034 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.744 | L2-Norm(final)=3.340 | 1680.5 samples/s | 26.3 steps/s
[Step=31200 Epoch=296.8] | Loss=0.00032 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.742 | L2-Norm(final)=3.340 | 3391.6 samples/s | 53.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step31200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=290.3] | Loss=0.09127 | Reg=0.00283 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.821 | L2-Norm(final)=3.334 | 3721.6 samples/s | 58.1 steps/s
[Step=30450 Epoch=290.8] | Loss=0.00362 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.777 | L2-Norm(final)=3.337 | 3131.9 samples/s | 48.9 steps/s
[Step=30500 Epoch=291.3] | Loss=0.00187 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.769 | L2-Norm(final)=3.337 | 4272.9 samples/s | 66.8 steps/s
[Step=30550 Epoch=291.7] | Loss=0.00125 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.764 | L2-Norm(final)=3.338 | 1533.0 samples/s | 24.0 steps/s
[Step=30600 Epoch=292.2] | Loss=0.00094 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.761 | L2-Norm(final)=3.338 | 4001.5 samples/s | 62.5 steps/s
[Step=30650 Epoch=292.7] | Loss=0.00076 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.758 | L2-Norm(final)=3.338 | 1545.9 samples/s | 24.2 steps/s
[Step=30700 Epoch=293.2] | Loss=0.00064 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.755 | L2-Norm(final)=3.338 | 3791.6 samples/s | 59.2 steps/s
[Step=30750 Epoch=293.6] | Loss=0.00055 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.753 | L2-Norm(final)=3.338 | 1597.0 samples/s | 25.0 steps/s
[Step=30800 Epoch=294.1] | Loss=0.00048 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.751 | L2-Norm(final)=3.338 | 3660.1 samples/s | 57.2 steps/s
[Step=30850 Epoch=294.6] | Loss=0.00043 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.749 | L2-Norm(final)=3.338 | 1614.4 samples/s | 25.2 steps/s
[Step=30900 Epoch=295.1] | Loss=0.00039 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.748 | L2-Norm(final)=3.338 | 3763.4 samples/s | 58.8 steps/s
[Step=30950 Epoch=295.6] | Loss=0.00035 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.746 | L2-Norm(final)=3.338 | 1626.2 samples/s | 25.4 steps/s
[Step=31000 Epoch=296.0] | Loss=0.00033 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.745 | L2-Norm(final)=3.338 | 3482.5 samples/s | 54.4 steps/s
[Step=31050 Epoch=296.5] | Loss=0.00030 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.744 | L2-Norm(final)=3.338 | 1716.3 samples/s | 26.8 steps/s
[Step=31100 Epoch=297.0] | Loss=0.00028 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.743 | L2-Norm(final)=3.339 | 3356.5 samples/s | 52.4 steps/s
[Step=31150 Epoch=297.5] | Loss=0.00026 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.742 | L2-Norm(final)=3.339 | 1655.9 samples/s | 25.9 steps/s
[Step=31200 Epoch=297.9] | Loss=0.00025 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.741 | L2-Norm(final)=3.339 | 3377.4 samples/s | 52.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step31200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=286.5] | Loss=0.01904 | Reg=0.00283 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.821 | L2-Norm(final)=3.334 | 3820.5 samples/s | 59.7 steps/s
[Step=30450 Epoch=286.9] | Loss=0.00334 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.780 | L2-Norm(final)=3.341 | 3110.2 samples/s | 48.6 steps/s
[Step=30500 Epoch=287.4] | Loss=0.00173 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.773 | L2-Norm(final)=3.342 | 4068.3 samples/s | 63.6 steps/s
[Step=30550 Epoch=287.9] | Loss=0.00117 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.768 | L2-Norm(final)=3.343 | 1512.6 samples/s | 23.6 steps/s
[Step=30600 Epoch=288.3] | Loss=0.00088 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.764 | L2-Norm(final)=3.343 | 3984.8 samples/s | 62.3 steps/s
[Step=30650 Epoch=288.8] | Loss=0.00071 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.761 | L2-Norm(final)=3.343 | 1535.4 samples/s | 24.0 steps/s
[Step=30700 Epoch=289.3] | Loss=0.00060 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.759 | L2-Norm(final)=3.343 | 3673.7 samples/s | 57.4 steps/s
[Step=30750 Epoch=289.8] | Loss=0.00051 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.757 | L2-Norm(final)=3.343 | 1604.1 samples/s | 25.1 steps/s
[Step=30800 Epoch=290.2] | Loss=0.00045 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.755 | L2-Norm(final)=3.343 | 3450.3 samples/s | 53.9 steps/s
[Step=30850 Epoch=290.7] | Loss=0.00041 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.753 | L2-Norm(final)=3.343 | 1668.3 samples/s | 26.1 steps/s
[Step=30900 Epoch=291.2] | Loss=0.00037 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.751 | L2-Norm(final)=3.343 | 3341.7 samples/s | 52.2 steps/s
[Step=30950 Epoch=291.6] | Loss=0.00033 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.750 | L2-Norm(final)=3.343 | 1674.7 samples/s | 26.2 steps/s
[Step=31000 Epoch=292.1] | Loss=0.00031 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.748 | L2-Norm(final)=3.344 | 3418.7 samples/s | 53.4 steps/s
[Step=31050 Epoch=292.6] | Loss=0.00029 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.747 | L2-Norm(final)=3.343 | 1779.1 samples/s | 27.8 steps/s
[Step=31100 Epoch=293.1] | Loss=0.00027 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.746 | L2-Norm(final)=3.343 | 3394.2 samples/s | 53.0 steps/s
[Step=31150 Epoch=293.5] | Loss=0.00025 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.745 | L2-Norm(final)=3.343 | 1731.3 samples/s | 27.1 steps/s
[Step=31200 Epoch=294.0] | Loss=0.00024 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.744 | L2-Norm(final)=3.343 | 3284.1 samples/s | 51.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step31200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=289.7] | Loss=0.09211 | Reg=0.00283 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.821 | L2-Norm(final)=3.334 | 3590.6 samples/s | 56.1 steps/s
[Step=30450 Epoch=290.2] | Loss=0.00453 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.779 | L2-Norm(final)=3.339 | 3259.9 samples/s | 50.9 steps/s
[Step=30500 Epoch=290.7] | Loss=0.00234 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.773 | L2-Norm(final)=3.340 | 4233.4 samples/s | 66.1 steps/s
[Step=30550 Epoch=291.2] | Loss=0.00158 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.768 | L2-Norm(final)=3.341 | 1512.1 samples/s | 23.6 steps/s
[Step=30600 Epoch=291.6] | Loss=0.00119 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.765 | L2-Norm(final)=3.341 | 3988.1 samples/s | 62.3 steps/s
[Step=30650 Epoch=292.1] | Loss=0.00096 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.762 | L2-Norm(final)=3.341 | 1547.9 samples/s | 24.2 steps/s
[Step=30700 Epoch=292.6] | Loss=0.00080 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.760 | L2-Norm(final)=3.341 | 3802.6 samples/s | 59.4 steps/s
[Step=30750 Epoch=293.1] | Loss=0.00069 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.758 | L2-Norm(final)=3.341 | 1569.2 samples/s | 24.5 steps/s
[Step=30800 Epoch=293.6] | Loss=0.00061 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.756 | L2-Norm(final)=3.342 | 3668.7 samples/s | 57.3 steps/s
[Step=30850 Epoch=294.0] | Loss=0.00054 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.754 | L2-Norm(final)=3.342 | 1609.3 samples/s | 25.1 steps/s
[Step=30900 Epoch=294.5] | Loss=0.00049 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.753 | L2-Norm(final)=3.342 | 3565.7 samples/s | 55.7 steps/s
[Step=30950 Epoch=295.0] | Loss=0.00045 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.751 | L2-Norm(final)=3.342 | 1625.1 samples/s | 25.4 steps/s
[Step=31000 Epoch=295.5] | Loss=0.00041 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.750 | L2-Norm(final)=3.342 | 3535.3 samples/s | 55.2 steps/s
[Step=31050 Epoch=295.9] | Loss=0.00038 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.749 | L2-Norm(final)=3.342 | 1659.6 samples/s | 25.9 steps/s
[Step=31100 Epoch=296.4] | Loss=0.00036 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.748 | L2-Norm(final)=3.342 | 3446.6 samples/s | 53.9 steps/s
[Step=31150 Epoch=296.9] | Loss=0.00033 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.747 | L2-Norm(final)=3.342 | 1684.9 samples/s | 26.3 steps/s
[Step=31200 Epoch=297.4] | Loss=0.00031 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.746 | L2-Norm(final)=3.342 | 3363.8 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21076 | acc=0.8884 | tpr=0.8454 | fpr=0.0183 | 3655.5 samples/s | 14.3 steps/s
Avg test loss: 0.21218, Avg test acc: 0.88769, Avg tpr: 0.84455, Avg fpr: 0.01743, total FA: 136

Testing server on iccad2012
[Step=  50] | Loss=0.45527 | acc=0.8616 | tpr=0.9602 | fpr=0.1401 | 3594.0 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.46419 | acc=0.8607 | tpr=0.9616 | fpr=0.1411 | 6913.6 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.47117 | acc=0.8598 | tpr=0.9669 | fpr=0.1421 | 6820.9 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.47130 | acc=0.8609 | tpr=0.9661 | fpr=0.1410 | 6847.0 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.47036 | acc=0.8611 | tpr=0.9677 | fpr=0.1409 | 6543.0 samples/s | 25.6 steps/s
[Step= 300] | Loss=0.46903 | acc=0.8618 | tpr=0.9636 | fpr=0.1401 | 7031.6 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.47129 | acc=0.8616 | tpr=0.9624 | fpr=0.1402 | 6935.6 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.47194 | acc=0.8618 | tpr=0.9612 | fpr=0.1400 | 6917.2 samples/s | 27.0 steps/s
[Step= 450] | Loss=0.47625 | acc=0.8610 | tpr=0.9611 | fpr=0.1409 | 6972.2 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.47686 | acc=0.8607 | tpr=0.9626 | fpr=0.1411 | 6614.7 samples/s | 25.8 steps/s
[Step= 550] | Loss=0.47584 | acc=0.8610 | tpr=0.9642 | fpr=0.1408 | 12591.2 samples/s | 49.2 steps/s
Avg test loss: 0.47565, Avg test acc: 0.86102, Avg tpr: 0.96434, Avg fpr: 0.14086, total FA: 19558

server round 39/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.1] | Loss=0.05254 | Reg=0.00281 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.750 | L2-Norm(final)=3.352 | 3703.1 samples/s | 57.9 steps/s
[Step=31250 Epoch=152.4] | Loss=0.01870 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.739 | L2-Norm(final)=3.347 | 3269.8 samples/s | 51.1 steps/s
[Step=31300 Epoch=152.6] | Loss=0.01328 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.734 | L2-Norm(final)=3.346 | 3506.0 samples/s | 54.8 steps/s
[Step=31350 Epoch=152.9] | Loss=0.01119 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.730 | L2-Norm(final)=3.347 | 3555.4 samples/s | 55.6 steps/s
[Step=31400 Epoch=153.1] | Loss=0.01064 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.728 | L2-Norm(final)=3.348 | 4386.4 samples/s | 68.5 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00901 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.727 | L2-Norm(final)=3.349 | 1553.0 samples/s | 24.3 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00834 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.725 | L2-Norm(final)=3.350 | 3421.7 samples/s | 53.5 steps/s
[Step=31550 Epoch=153.8] | Loss=0.00779 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.724 | L2-Norm(final)=3.351 | 3481.5 samples/s | 54.4 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00726 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.724 | L2-Norm(final)=3.352 | 4100.7 samples/s | 64.1 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00663 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.723 | L2-Norm(final)=3.354 | 1581.5 samples/s | 24.7 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00634 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.723 | L2-Norm(final)=3.355 | 3515.5 samples/s | 54.9 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00597 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.722 | L2-Norm(final)=3.356 | 3482.9 samples/s | 54.4 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00582 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.722 | L2-Norm(final)=3.357 | 3883.1 samples/s | 60.7 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00561 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.721 | L2-Norm(final)=3.359 | 1653.1 samples/s | 25.8 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00543 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.721 | L2-Norm(final)=3.360 | 3540.9 samples/s | 55.3 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00535 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.721 | L2-Norm(final)=3.361 | 3592.9 samples/s | 56.1 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00518 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.720 | L2-Norm(final)=3.362 | 3748.3 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.2] | Loss=0.10753 | Reg=0.00281 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.750 | L2-Norm(final)=3.352 | 3608.3 samples/s | 56.4 steps/s
[Step=31250 Epoch=152.5] | Loss=0.01335 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.733 | L2-Norm(final)=3.349 | 3610.3 samples/s | 56.4 steps/s
[Step=31300 Epoch=152.7] | Loss=0.01146 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.728 | L2-Norm(final)=3.349 | 3552.0 samples/s | 55.5 steps/s
[Step=31350 Epoch=153.0] | Loss=0.01033 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.725 | L2-Norm(final)=3.349 | 3617.1 samples/s | 56.5 steps/s
[Step=31400 Epoch=153.2] | Loss=0.00932 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.723 | L2-Norm(final)=3.350 | 4339.6 samples/s | 67.8 steps/s
[Step=31450 Epoch=153.5] | Loss=0.00809 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.722 | L2-Norm(final)=3.350 | 1597.1 samples/s | 25.0 steps/s
[Step=31500 Epoch=153.7] | Loss=0.00775 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.721 | L2-Norm(final)=3.351 | 3547.7 samples/s | 55.4 steps/s
[Step=31550 Epoch=153.9] | Loss=0.00697 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.720 | L2-Norm(final)=3.352 | 3513.9 samples/s | 54.9 steps/s
[Step=31600 Epoch=154.2] | Loss=0.00652 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.719 | L2-Norm(final)=3.353 | 4318.8 samples/s | 67.5 steps/s
[Step=31650 Epoch=154.4] | Loss=0.00614 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.718 | L2-Norm(final)=3.354 | 1613.7 samples/s | 25.2 steps/s
[Step=31700 Epoch=154.7] | Loss=0.00580 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.718 | L2-Norm(final)=3.355 | 3549.6 samples/s | 55.5 steps/s
[Step=31750 Epoch=154.9] | Loss=0.00555 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.717 | L2-Norm(final)=3.356 | 3570.9 samples/s | 55.8 steps/s
[Step=31800 Epoch=155.2] | Loss=0.00527 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.716 | L2-Norm(final)=3.356 | 4080.2 samples/s | 63.8 steps/s
[Step=31850 Epoch=155.4] | Loss=0.00508 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.716 | L2-Norm(final)=3.357 | 1632.4 samples/s | 25.5 steps/s
[Step=31900 Epoch=155.7] | Loss=0.00486 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.715 | L2-Norm(final)=3.358 | 3562.4 samples/s | 55.7 steps/s
[Step=31950 Epoch=155.9] | Loss=0.00469 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.715 | L2-Norm(final)=3.359 | 3513.1 samples/s | 54.9 steps/s
[Step=32000 Epoch=156.1] | Loss=0.00464 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.714 | L2-Norm(final)=3.360 | 3820.4 samples/s | 59.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step32000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.0] | Loss=0.16042 | Reg=0.00281 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=16.750 | L2-Norm(final)=3.351 | 3865.2 samples/s | 60.4 steps/s
[Step=31250 Epoch=152.3] | Loss=0.01985 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.732 | L2-Norm(final)=3.346 | 3370.5 samples/s | 52.7 steps/s
[Step=31300 Epoch=152.5] | Loss=0.01431 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.727 | L2-Norm(final)=3.347 | 3545.3 samples/s | 55.4 steps/s
[Step=31350 Epoch=152.8] | Loss=0.01170 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.725 | L2-Norm(final)=3.348 | 3554.3 samples/s | 55.5 steps/s
[Step=31400 Epoch=153.0] | Loss=0.01040 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.724 | L2-Norm(final)=3.350 | 4251.4 samples/s | 66.4 steps/s
[Step=31450 Epoch=153.2] | Loss=0.00911 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.722 | L2-Norm(final)=3.351 | 1560.1 samples/s | 24.4 steps/s
[Step=31500 Epoch=153.5] | Loss=0.00826 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.722 | L2-Norm(final)=3.352 | 3454.3 samples/s | 54.0 steps/s
[Step=31550 Epoch=153.7] | Loss=0.00757 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.721 | L2-Norm(final)=3.354 | 3462.5 samples/s | 54.1 steps/s
[Step=31600 Epoch=154.0] | Loss=0.00716 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.721 | L2-Norm(final)=3.355 | 4107.1 samples/s | 64.2 steps/s
[Step=31650 Epoch=154.2] | Loss=0.00663 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.720 | L2-Norm(final)=3.357 | 1644.6 samples/s | 25.7 steps/s
[Step=31700 Epoch=154.5] | Loss=0.00620 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.720 | L2-Norm(final)=3.358 | 3585.2 samples/s | 56.0 steps/s
[Step=31750 Epoch=154.7] | Loss=0.00599 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.720 | L2-Norm(final)=3.360 | 3613.1 samples/s | 56.5 steps/s
[Step=31800 Epoch=154.9] | Loss=0.00575 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.720 | L2-Norm(final)=3.361 | 3943.6 samples/s | 61.6 steps/s
[Step=31850 Epoch=155.2] | Loss=0.00548 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.719 | L2-Norm(final)=3.363 | 1640.3 samples/s | 25.6 steps/s
[Step=31900 Epoch=155.4] | Loss=0.00526 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.719 | L2-Norm(final)=3.364 | 3535.8 samples/s | 55.2 steps/s
[Step=31950 Epoch=155.7] | Loss=0.00510 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.719 | L2-Norm(final)=3.365 | 3547.9 samples/s | 55.4 steps/s
[Step=32000 Epoch=155.9] | Loss=0.00500 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.719 | L2-Norm(final)=3.367 | 3769.8 samples/s | 58.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step32000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.2] | Loss=0.05696 | Reg=0.00281 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.750 | L2-Norm(final)=3.352 | 3707.5 samples/s | 57.9 steps/s
[Step=31250 Epoch=152.4] | Loss=0.01518 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.735 | L2-Norm(final)=3.350 | 3360.9 samples/s | 52.5 steps/s
[Step=31300 Epoch=152.6] | Loss=0.01014 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.732 | L2-Norm(final)=3.351 | 3523.0 samples/s | 55.0 steps/s
[Step=31350 Epoch=152.9] | Loss=0.00878 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.730 | L2-Norm(final)=3.354 | 3527.4 samples/s | 55.1 steps/s
[Step=31400 Epoch=153.1] | Loss=0.00797 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.730 | L2-Norm(final)=3.356 | 4444.6 samples/s | 69.4 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00695 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.729 | L2-Norm(final)=3.357 | 1568.8 samples/s | 24.5 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00634 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.728 | L2-Norm(final)=3.359 | 3486.7 samples/s | 54.5 steps/s
[Step=31550 Epoch=153.9] | Loss=0.00602 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.728 | L2-Norm(final)=3.361 | 3468.4 samples/s | 54.2 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00569 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.727 | L2-Norm(final)=3.362 | 4063.1 samples/s | 63.5 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00525 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.726 | L2-Norm(final)=3.363 | 1589.6 samples/s | 24.8 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00511 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.726 | L2-Norm(final)=3.365 | 3624.4 samples/s | 56.6 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00499 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.725 | L2-Norm(final)=3.366 | 3559.9 samples/s | 55.6 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00483 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.725 | L2-Norm(final)=3.367 | 3944.8 samples/s | 61.6 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00466 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.724 | L2-Norm(final)=3.368 | 1659.8 samples/s | 25.9 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00453 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.723 | L2-Norm(final)=3.369 | 3506.3 samples/s | 54.8 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00440 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.723 | L2-Norm(final)=3.370 | 3565.7 samples/s | 55.7 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00423 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.722 | L2-Norm(final)=3.371 | 3920.7 samples/s | 61.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step32000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=153.0] | Loss=0.11056 | Reg=0.00281 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=16.750 | L2-Norm(final)=3.352 | 3555.8 samples/s | 55.6 steps/s
[Step=31250 Epoch=153.2] | Loss=0.01844 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.736 | L2-Norm(final)=3.347 | 3536.5 samples/s | 55.3 steps/s
[Step=31300 Epoch=153.5] | Loss=0.01292 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.731 | L2-Norm(final)=3.347 | 3317.5 samples/s | 51.8 steps/s
[Step=31350 Epoch=153.7] | Loss=0.01104 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.728 | L2-Norm(final)=3.347 | 3419.3 samples/s | 53.4 steps/s
[Step=31400 Epoch=154.0] | Loss=0.00925 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.726 | L2-Norm(final)=3.348 | 4058.3 samples/s | 63.4 steps/s
[Step=31450 Epoch=154.2] | Loss=0.00799 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.725 | L2-Norm(final)=3.350 | 1462.2 samples/s | 22.8 steps/s
[Step=31500 Epoch=154.5] | Loss=0.00708 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.725 | L2-Norm(final)=3.351 | 3362.7 samples/s | 52.5 steps/s
[Step=31550 Epoch=154.7] | Loss=0.00646 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.724 | L2-Norm(final)=3.353 | 3275.0 samples/s | 51.2 steps/s
[Step=31600 Epoch=155.0] | Loss=0.00624 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.724 | L2-Norm(final)=3.355 | 4041.7 samples/s | 63.2 steps/s
[Step=31650 Epoch=155.2] | Loss=0.00586 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.723 | L2-Norm(final)=3.356 | 1585.8 samples/s | 24.8 steps/s
[Step=31700 Epoch=155.5] | Loss=0.00557 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.723 | L2-Norm(final)=3.358 | 3511.0 samples/s | 54.9 steps/s
[Step=31750 Epoch=155.7] | Loss=0.00531 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.723 | L2-Norm(final)=3.359 | 3492.2 samples/s | 54.6 steps/s
[Step=31800 Epoch=155.9] | Loss=0.00526 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.722 | L2-Norm(final)=3.361 | 4079.4 samples/s | 63.7 steps/s
[Step=31850 Epoch=156.2] | Loss=0.00507 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.722 | L2-Norm(final)=3.362 | 1616.1 samples/s | 25.3 steps/s
[Step=31900 Epoch=156.4] | Loss=0.00495 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.722 | L2-Norm(final)=3.363 | 3507.1 samples/s | 54.8 steps/s
[Step=31950 Epoch=156.7] | Loss=0.00477 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.721 | L2-Norm(final)=3.364 | 3510.2 samples/s | 54.8 steps/s
[Step=32000 Epoch=156.9] | Loss=0.00462 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.721 | L2-Norm(final)=3.365 | 4112.9 samples/s | 64.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step32000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=295.7] | Loss=0.12803 | Reg=0.00281 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.750 | L2-Norm(final)=3.352 | 3661.5 samples/s | 57.2 steps/s
[Step=31250 Epoch=296.1] | Loss=0.00498 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.706 | L2-Norm(final)=3.354 | 3242.0 samples/s | 50.7 steps/s
[Step=31300 Epoch=296.6] | Loss=0.00261 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.698 | L2-Norm(final)=3.355 | 4248.1 samples/s | 66.4 steps/s
[Step=31350 Epoch=297.1] | Loss=0.00175 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.694 | L2-Norm(final)=3.355 | 1552.8 samples/s | 24.3 steps/s
[Step=31400 Epoch=297.5] | Loss=0.00132 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.690 | L2-Norm(final)=3.356 | 4023.4 samples/s | 62.9 steps/s
[Step=31450 Epoch=298.0] | Loss=0.00106 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.687 | L2-Norm(final)=3.356 | 1552.3 samples/s | 24.3 steps/s
[Step=31500 Epoch=298.5] | Loss=0.00089 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.685 | L2-Norm(final)=3.356 | 3794.4 samples/s | 59.3 steps/s
[Step=31550 Epoch=299.0] | Loss=0.00076 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.683 | L2-Norm(final)=3.356 | 1605.5 samples/s | 25.1 steps/s
[Step=31600 Epoch=299.4] | Loss=0.00067 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.681 | L2-Norm(final)=3.356 | 3538.3 samples/s | 55.3 steps/s
[Step=31650 Epoch=299.9] | Loss=0.00060 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.679 | L2-Norm(final)=3.356 | 1629.6 samples/s | 25.5 steps/s
[Step=31700 Epoch=300.4] | Loss=0.00054 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.678 | L2-Norm(final)=3.356 | 3346.4 samples/s | 52.3 steps/s
[Step=31750 Epoch=300.9] | Loss=0.00049 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.677 | L2-Norm(final)=3.356 | 1700.3 samples/s | 26.6 steps/s
[Step=31800 Epoch=301.3] | Loss=0.00045 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.675 | L2-Norm(final)=3.356 | 3454.7 samples/s | 54.0 steps/s
[Step=31850 Epoch=301.8] | Loss=0.00042 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.674 | L2-Norm(final)=3.356 | 1665.9 samples/s | 26.0 steps/s
[Step=31900 Epoch=302.3] | Loss=0.00039 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.673 | L2-Norm(final)=3.356 | 3365.2 samples/s | 52.6 steps/s
[Step=31950 Epoch=302.8] | Loss=0.00036 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.672 | L2-Norm(final)=3.356 | 1701.4 samples/s | 26.6 steps/s
[Step=32000 Epoch=303.2] | Loss=0.00034 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.671 | L2-Norm(final)=3.356 | 3427.2 samples/s | 53.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step32000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=296.8] | Loss=0.09314 | Reg=0.00281 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.750 | L2-Norm(final)=3.352 | 3596.8 samples/s | 56.2 steps/s
[Step=31250 Epoch=297.3] | Loss=0.00481 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.712 | L2-Norm(final)=3.357 | 3188.1 samples/s | 49.8 steps/s
[Step=31300 Epoch=297.7] | Loss=0.00244 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.705 | L2-Norm(final)=3.357 | 4378.3 samples/s | 68.4 steps/s
[Step=31350 Epoch=298.2] | Loss=0.00164 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.700 | L2-Norm(final)=3.358 | 1528.5 samples/s | 23.9 steps/s
[Step=31400 Epoch=298.7] | Loss=0.00123 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.697 | L2-Norm(final)=3.358 | 3986.3 samples/s | 62.3 steps/s
[Step=31450 Epoch=299.2] | Loss=0.00099 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.694 | L2-Norm(final)=3.358 | 1539.1 samples/s | 24.0 steps/s
[Step=31500 Epoch=299.6] | Loss=0.00083 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.691 | L2-Norm(final)=3.358 | 3791.7 samples/s | 59.2 steps/s
[Step=31550 Epoch=300.1] | Loss=0.00072 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.689 | L2-Norm(final)=3.358 | 1591.5 samples/s | 24.9 steps/s
[Step=31600 Epoch=300.6] | Loss=0.00063 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.687 | L2-Norm(final)=3.358 | 3564.5 samples/s | 55.7 steps/s
[Step=31650 Epoch=301.1] | Loss=0.00056 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.685 | L2-Norm(final)=3.358 | 1614.0 samples/s | 25.2 steps/s
[Step=31700 Epoch=301.5] | Loss=0.00051 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.683 | L2-Norm(final)=3.358 | 3581.4 samples/s | 56.0 steps/s
[Step=31750 Epoch=302.0] | Loss=0.00046 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.682 | L2-Norm(final)=3.358 | 1688.5 samples/s | 26.4 steps/s
[Step=31800 Epoch=302.5] | Loss=0.00042 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.680 | L2-Norm(final)=3.358 | 3567.0 samples/s | 55.7 steps/s
[Step=31850 Epoch=303.0] | Loss=0.00039 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.679 | L2-Norm(final)=3.358 | 1677.0 samples/s | 26.2 steps/s
[Step=31900 Epoch=303.4] | Loss=0.00037 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.678 | L2-Norm(final)=3.358 | 3283.8 samples/s | 51.3 steps/s
[Step=31950 Epoch=303.9] | Loss=0.00034 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.677 | L2-Norm(final)=3.358 | 1691.4 samples/s | 26.4 steps/s
[Step=32000 Epoch=304.4] | Loss=0.00032 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.675 | L2-Norm(final)=3.358 | 3452.9 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step32000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=298.0] | Loss=0.00841 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.750 | L2-Norm(final)=3.352 | 3542.8 samples/s | 55.4 steps/s
[Step=31250 Epoch=298.4] | Loss=0.00552 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.714 | L2-Norm(final)=3.356 | 3299.6 samples/s | 51.6 steps/s
[Step=31300 Epoch=298.9] | Loss=0.00279 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.707 | L2-Norm(final)=3.356 | 4206.4 samples/s | 65.7 steps/s
[Step=31350 Epoch=299.4] | Loss=0.00187 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.703 | L2-Norm(final)=3.356 | 1547.2 samples/s | 24.2 steps/s
[Step=31400 Epoch=299.9] | Loss=0.00141 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.699 | L2-Norm(final)=3.356 | 4073.6 samples/s | 63.6 steps/s
[Step=31450 Epoch=300.3] | Loss=0.00113 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.696 | L2-Norm(final)=3.356 | 1550.0 samples/s | 24.2 steps/s
[Step=31500 Epoch=300.8] | Loss=0.00095 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.693 | L2-Norm(final)=3.356 | 3895.5 samples/s | 60.9 steps/s
[Step=31550 Epoch=301.3] | Loss=0.00081 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.691 | L2-Norm(final)=3.357 | 1603.2 samples/s | 25.1 steps/s
[Step=31600 Epoch=301.8] | Loss=0.00072 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.689 | L2-Norm(final)=3.357 | 3901.3 samples/s | 61.0 steps/s
[Step=31650 Epoch=302.2] | Loss=0.00064 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.687 | L2-Norm(final)=3.357 | 1588.6 samples/s | 24.8 steps/s
[Step=31700 Epoch=302.7] | Loss=0.00058 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.686 | L2-Norm(final)=3.357 | 3567.8 samples/s | 55.7 steps/s
[Step=31750 Epoch=303.2] | Loss=0.00052 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.684 | L2-Norm(final)=3.357 | 1623.7 samples/s | 25.4 steps/s
[Step=31800 Epoch=303.7] | Loss=0.00048 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.683 | L2-Norm(final)=3.357 | 3346.7 samples/s | 52.3 steps/s
[Step=31850 Epoch=304.1] | Loss=0.00045 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.681 | L2-Norm(final)=3.357 | 1644.5 samples/s | 25.7 steps/s
[Step=31900 Epoch=304.6] | Loss=0.00042 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.680 | L2-Norm(final)=3.357 | 3365.1 samples/s | 52.6 steps/s
[Step=31950 Epoch=305.1] | Loss=0.00039 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.679 | L2-Norm(final)=3.357 | 1690.9 samples/s | 26.4 steps/s
[Step=32000 Epoch=305.6] | Loss=0.00037 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.678 | L2-Norm(final)=3.357 | 3440.7 samples/s | 53.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step32000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=294.0] | Loss=0.03937 | Reg=0.00281 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.750 | L2-Norm(final)=3.352 | 3559.9 samples/s | 55.6 steps/s
[Step=31250 Epoch=294.5] | Loss=0.00606 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.711 | L2-Norm(final)=3.356 | 3347.7 samples/s | 52.3 steps/s
[Step=31300 Epoch=294.9] | Loss=0.00309 | Reg=0.00279 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=16.705 | L2-Norm(final)=3.357 | 4321.4 samples/s | 67.5 steps/s
[Step=31350 Epoch=295.4] | Loss=0.00207 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.700 | L2-Norm(final)=3.357 | 1533.5 samples/s | 24.0 steps/s
[Step=31400 Epoch=295.9] | Loss=0.00156 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.696 | L2-Norm(final)=3.357 | 3875.9 samples/s | 60.6 steps/s
[Step=31450 Epoch=296.3] | Loss=0.00125 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.694 | L2-Norm(final)=3.357 | 1614.8 samples/s | 25.2 steps/s
[Step=31500 Epoch=296.8] | Loss=0.00105 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.691 | L2-Norm(final)=3.357 | 3942.6 samples/s | 61.6 steps/s
[Step=31550 Epoch=297.3] | Loss=0.00090 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.689 | L2-Norm(final)=3.357 | 1640.3 samples/s | 25.6 steps/s
[Step=31600 Epoch=297.8] | Loss=0.00079 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.687 | L2-Norm(final)=3.357 | 3580.7 samples/s | 55.9 steps/s
[Step=31650 Epoch=298.2] | Loss=0.00070 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.686 | L2-Norm(final)=3.357 | 1674.2 samples/s | 26.2 steps/s
[Step=31700 Epoch=298.7] | Loss=0.00064 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.684 | L2-Norm(final)=3.357 | 3447.3 samples/s | 53.9 steps/s
[Step=31750 Epoch=299.2] | Loss=0.00058 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.683 | L2-Norm(final)=3.357 | 1677.4 samples/s | 26.2 steps/s
[Step=31800 Epoch=299.6] | Loss=0.00053 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.681 | L2-Norm(final)=3.357 | 3455.4 samples/s | 54.0 steps/s
[Step=31850 Epoch=300.1] | Loss=0.00049 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.680 | L2-Norm(final)=3.357 | 1699.2 samples/s | 26.5 steps/s
[Step=31900 Epoch=300.6] | Loss=0.00046 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.679 | L2-Norm(final)=3.357 | 3329.1 samples/s | 52.0 steps/s
[Step=31950 Epoch=301.1] | Loss=0.00043 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.678 | L2-Norm(final)=3.357 | 1728.7 samples/s | 27.0 steps/s
[Step=32000 Epoch=301.5] | Loss=0.00040 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.677 | L2-Norm(final)=3.357 | 3233.4 samples/s | 50.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step32000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=297.4] | Loss=0.15056 | Reg=0.00281 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=16.750 | L2-Norm(final)=3.352 | 3454.8 samples/s | 54.0 steps/s
[Step=31250 Epoch=297.8] | Loss=0.00593 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.713 | L2-Norm(final)=3.357 | 3253.7 samples/s | 50.8 steps/s
[Step=31300 Epoch=298.3] | Loss=0.00303 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.706 | L2-Norm(final)=3.358 | 4325.6 samples/s | 67.6 steps/s
[Step=31350 Epoch=298.8] | Loss=0.00203 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.701 | L2-Norm(final)=3.358 | 1544.5 samples/s | 24.1 steps/s
[Step=31400 Epoch=299.3] | Loss=0.00153 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.698 | L2-Norm(final)=3.358 | 4010.2 samples/s | 62.7 steps/s
[Step=31450 Epoch=299.7] | Loss=0.00123 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.695 | L2-Norm(final)=3.358 | 1556.0 samples/s | 24.3 steps/s
[Step=31500 Epoch=300.2] | Loss=0.00103 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.692 | L2-Norm(final)=3.358 | 3874.3 samples/s | 60.5 steps/s
[Step=31550 Epoch=300.7] | Loss=0.00088 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.690 | L2-Norm(final)=3.358 | 1614.3 samples/s | 25.2 steps/s
[Step=31600 Epoch=301.2] | Loss=0.00078 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.688 | L2-Norm(final)=3.358 | 3648.8 samples/s | 57.0 steps/s
[Step=31650 Epoch=301.7] | Loss=0.00069 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.686 | L2-Norm(final)=3.358 | 1621.4 samples/s | 25.3 steps/s
[Step=31700 Epoch=302.1] | Loss=0.00062 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.685 | L2-Norm(final)=3.358 | 3508.3 samples/s | 54.8 steps/s
[Step=31750 Epoch=302.6] | Loss=0.00057 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.683 | L2-Norm(final)=3.358 | 1650.9 samples/s | 25.8 steps/s
[Step=31800 Epoch=303.1] | Loss=0.00052 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.682 | L2-Norm(final)=3.358 | 3459.8 samples/s | 54.1 steps/s
[Step=31850 Epoch=303.6] | Loss=0.00048 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.681 | L2-Norm(final)=3.358 | 1676.0 samples/s | 26.2 steps/s
[Step=31900 Epoch=304.0] | Loss=0.00045 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.680 | L2-Norm(final)=3.358 | 3412.8 samples/s | 53.3 steps/s
[Step=31950 Epoch=304.5] | Loss=0.00042 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.678 | L2-Norm(final)=3.358 | 1684.3 samples/s | 26.3 steps/s
[Step=32000 Epoch=305.0] | Loss=0.00040 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.677 | L2-Norm(final)=3.358 | 3454.4 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23330 | acc=0.8762 | tpr=0.8267 | fpr=0.0164 | 3654.6 samples/s | 14.3 steps/s
Avg test loss: 0.23446, Avg test acc: 0.87591, Avg tpr: 0.82683, Avg fpr: 0.01615, total FA: 126

Testing server on iccad2012
[Step=  50] | Loss=0.40748 | acc=0.8765 | tpr=0.9602 | fpr=0.1250 | 3670.5 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.41571 | acc=0.8759 | tpr=0.9616 | fpr=0.1257 | 7054.1 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.42173 | acc=0.8751 | tpr=0.9669 | fpr=0.1266 | 6769.9 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.42276 | acc=0.8762 | tpr=0.9661 | fpr=0.1254 | 6811.0 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.42151 | acc=0.8764 | tpr=0.9686 | fpr=0.1253 | 6980.3 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.42057 | acc=0.8768 | tpr=0.9651 | fpr=0.1248 | 7000.5 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.42297 | acc=0.8769 | tpr=0.9637 | fpr=0.1247 | 6980.0 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.42394 | acc=0.8769 | tpr=0.9617 | fpr=0.1246 | 6908.9 samples/s | 27.0 steps/s
[Step= 450] | Loss=0.42790 | acc=0.8762 | tpr=0.9615 | fpr=0.1253 | 6922.5 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.42847 | acc=0.8761 | tpr=0.9630 | fpr=0.1255 | 6830.4 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.42755 | acc=0.8764 | tpr=0.9646 | fpr=0.1252 | 12861.9 samples/s | 50.2 steps/s
Avg test loss: 0.42731, Avg test acc: 0.87638, Avg tpr: 0.96474, Avg fpr: 0.12523, total FA: 17388

server round 40/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.0] | Loss=0.29805 | Reg=0.00278 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=16.681 | L2-Norm(final)=3.369 | 3809.7 samples/s | 59.5 steps/s
[Step=32050 Epoch=156.3] | Loss=0.02439 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.669 | L2-Norm(final)=3.366 | 3343.4 samples/s | 52.2 steps/s
[Step=32100 Epoch=156.5] | Loss=0.01682 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.663 | L2-Norm(final)=3.366 | 3615.7 samples/s | 56.5 steps/s
[Step=32150 Epoch=156.8] | Loss=0.01322 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.660 | L2-Norm(final)=3.366 | 3496.2 samples/s | 54.6 steps/s
[Step=32200 Epoch=157.0] | Loss=0.01130 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.658 | L2-Norm(final)=3.367 | 4351.3 samples/s | 68.0 steps/s
[Step=32250 Epoch=157.3] | Loss=0.00978 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.656 | L2-Norm(final)=3.367 | 1563.1 samples/s | 24.4 steps/s
[Step=32300 Epoch=157.5] | Loss=0.00883 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.655 | L2-Norm(final)=3.368 | 3536.6 samples/s | 55.3 steps/s
[Step=32350 Epoch=157.7] | Loss=0.00800 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.654 | L2-Norm(final)=3.369 | 3495.4 samples/s | 54.6 steps/s
[Step=32400 Epoch=158.0] | Loss=0.00747 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.654 | L2-Norm(final)=3.370 | 4147.8 samples/s | 64.8 steps/s
[Step=32450 Epoch=158.2] | Loss=0.00694 | Reg=0.00277 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.653 | L2-Norm(final)=3.371 | 1609.8 samples/s | 25.2 steps/s
[Step=32500 Epoch=158.5] | Loss=0.00656 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.652 | L2-Norm(final)=3.372 | 3544.4 samples/s | 55.4 steps/s
[Step=32550 Epoch=158.7] | Loss=0.00614 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.652 | L2-Norm(final)=3.373 | 3520.7 samples/s | 55.0 steps/s
[Step=32600 Epoch=159.0] | Loss=0.00588 | Reg=0.00277 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.651 | L2-Norm(final)=3.374 | 3867.1 samples/s | 60.4 steps/s
[Step=32650 Epoch=159.2] | Loss=0.00568 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.651 | L2-Norm(final)=3.375 | 1642.4 samples/s | 25.7 steps/s
[Step=32700 Epoch=159.5] | Loss=0.00548 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.651 | L2-Norm(final)=3.376 | 3531.8 samples/s | 55.2 steps/s
[Step=32750 Epoch=159.7] | Loss=0.00532 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.651 | L2-Norm(final)=3.376 | 3483.5 samples/s | 54.4 steps/s
[Step=32800 Epoch=159.9] | Loss=0.00513 | Reg=0.00277 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.650 | L2-Norm(final)=3.377 | 3950.4 samples/s | 61.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step32800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.2] | Loss=0.16988 | Reg=0.00278 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=16.681 | L2-Norm(final)=3.369 | 3743.7 samples/s | 58.5 steps/s
[Step=32050 Epoch=156.4] | Loss=0.02638 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.668 | L2-Norm(final)=3.365 | 3537.5 samples/s | 55.3 steps/s
[Step=32100 Epoch=156.6] | Loss=0.01686 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.662 | L2-Norm(final)=3.365 | 3563.7 samples/s | 55.7 steps/s
[Step=32150 Epoch=156.9] | Loss=0.01307 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.659 | L2-Norm(final)=3.365 | 3598.1 samples/s | 56.2 steps/s
[Step=32200 Epoch=157.1] | Loss=0.01058 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.657 | L2-Norm(final)=3.366 | 4491.8 samples/s | 70.2 steps/s
[Step=32250 Epoch=157.4] | Loss=0.00909 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.655 | L2-Norm(final)=3.367 | 1595.7 samples/s | 24.9 steps/s
[Step=32300 Epoch=157.6] | Loss=0.00808 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.654 | L2-Norm(final)=3.368 | 3528.7 samples/s | 55.1 steps/s
[Step=32350 Epoch=157.9] | Loss=0.00736 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.653 | L2-Norm(final)=3.368 | 3582.3 samples/s | 56.0 steps/s
[Step=32400 Epoch=158.1] | Loss=0.00679 | Reg=0.00277 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.652 | L2-Norm(final)=3.369 | 4233.9 samples/s | 66.2 steps/s
[Step=32450 Epoch=158.3] | Loss=0.00634 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.652 | L2-Norm(final)=3.370 | 1642.2 samples/s | 25.7 steps/s
[Step=32500 Epoch=158.6] | Loss=0.00603 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.651 | L2-Norm(final)=3.371 | 3556.2 samples/s | 55.6 steps/s
[Step=32550 Epoch=158.8] | Loss=0.00570 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.650 | L2-Norm(final)=3.372 | 3503.1 samples/s | 54.7 steps/s
[Step=32600 Epoch=159.1] | Loss=0.00536 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.650 | L2-Norm(final)=3.373 | 3977.2 samples/s | 62.1 steps/s
[Step=32650 Epoch=159.3] | Loss=0.00510 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.650 | L2-Norm(final)=3.374 | 1619.3 samples/s | 25.3 steps/s
[Step=32700 Epoch=159.6] | Loss=0.00495 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.649 | L2-Norm(final)=3.375 | 3499.0 samples/s | 54.7 steps/s
[Step=32750 Epoch=159.8] | Loss=0.00477 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.649 | L2-Norm(final)=3.376 | 3503.7 samples/s | 54.7 steps/s
[Step=32800 Epoch=160.0] | Loss=0.00461 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.649 | L2-Norm(final)=3.376 | 4065.2 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step32800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=155.9] | Loss=0.27841 | Reg=0.00278 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=16.681 | L2-Norm(final)=3.369 | 3609.2 samples/s | 56.4 steps/s
[Step=32050 Epoch=156.2] | Loss=0.02320 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.667 | L2-Norm(final)=3.367 | 3700.4 samples/s | 57.8 steps/s
[Step=32100 Epoch=156.4] | Loss=0.01573 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.661 | L2-Norm(final)=3.366 | 3610.4 samples/s | 56.4 steps/s
[Step=32150 Epoch=156.7] | Loss=0.01271 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.658 | L2-Norm(final)=3.367 | 3591.5 samples/s | 56.1 steps/s
[Step=32200 Epoch=156.9] | Loss=0.01072 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.657 | L2-Norm(final)=3.368 | 4331.5 samples/s | 67.7 steps/s
[Step=32250 Epoch=157.1] | Loss=0.00915 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.655 | L2-Norm(final)=3.369 | 1586.6 samples/s | 24.8 steps/s
[Step=32300 Epoch=157.4] | Loss=0.00822 | Reg=0.00277 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.654 | L2-Norm(final)=3.370 | 3598.1 samples/s | 56.2 steps/s
[Step=32350 Epoch=157.6] | Loss=0.00759 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.653 | L2-Norm(final)=3.371 | 3503.4 samples/s | 54.7 steps/s
[Step=32400 Epoch=157.9] | Loss=0.00703 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.653 | L2-Norm(final)=3.372 | 4195.7 samples/s | 65.6 steps/s
[Step=32450 Epoch=158.1] | Loss=0.00654 | Reg=0.00277 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.652 | L2-Norm(final)=3.373 | 1659.6 samples/s | 25.9 steps/s
[Step=32500 Epoch=158.4] | Loss=0.00612 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.652 | L2-Norm(final)=3.374 | 3563.1 samples/s | 55.7 steps/s
[Step=32550 Epoch=158.6] | Loss=0.00581 | Reg=0.00277 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.651 | L2-Norm(final)=3.375 | 3480.2 samples/s | 54.4 steps/s
[Step=32600 Epoch=158.8] | Loss=0.00554 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.651 | L2-Norm(final)=3.376 | 3908.1 samples/s | 61.1 steps/s
[Step=32650 Epoch=159.1] | Loss=0.00532 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.651 | L2-Norm(final)=3.377 | 1637.5 samples/s | 25.6 steps/s
[Step=32700 Epoch=159.3] | Loss=0.00512 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.650 | L2-Norm(final)=3.378 | 3433.3 samples/s | 53.6 steps/s
[Step=32750 Epoch=159.6] | Loss=0.00495 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.650 | L2-Norm(final)=3.379 | 3493.4 samples/s | 54.6 steps/s
[Step=32800 Epoch=159.8] | Loss=0.00479 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.650 | L2-Norm(final)=3.380 | 3742.8 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step32800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.1] | Loss=0.13748 | Reg=0.00278 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=16.681 | L2-Norm(final)=3.369 | 3644.2 samples/s | 56.9 steps/s
[Step=32050 Epoch=156.3] | Loss=0.01731 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.670 | L2-Norm(final)=3.367 | 3638.5 samples/s | 56.9 steps/s
[Step=32100 Epoch=156.5] | Loss=0.01167 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.666 | L2-Norm(final)=3.368 | 3654.5 samples/s | 57.1 steps/s
[Step=32150 Epoch=156.8] | Loss=0.00991 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.663 | L2-Norm(final)=3.369 | 3545.0 samples/s | 55.4 steps/s
[Step=32200 Epoch=157.0] | Loss=0.00856 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.661 | L2-Norm(final)=3.369 | 4381.6 samples/s | 68.5 steps/s
[Step=32250 Epoch=157.3] | Loss=0.00761 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.660 | L2-Norm(final)=3.370 | 1589.4 samples/s | 24.8 steps/s
[Step=32300 Epoch=157.5] | Loss=0.00677 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.659 | L2-Norm(final)=3.372 | 3487.5 samples/s | 54.5 steps/s
[Step=32350 Epoch=157.8] | Loss=0.00632 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.658 | L2-Norm(final)=3.373 | 3501.1 samples/s | 54.7 steps/s
[Step=32400 Epoch=158.0] | Loss=0.00588 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.657 | L2-Norm(final)=3.374 | 4121.7 samples/s | 64.4 steps/s
[Step=32450 Epoch=158.2] | Loss=0.00553 | Reg=0.00277 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.657 | L2-Norm(final)=3.375 | 1596.8 samples/s | 25.0 steps/s
[Step=32500 Epoch=158.5] | Loss=0.00525 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.656 | L2-Norm(final)=3.376 | 3571.3 samples/s | 55.8 steps/s
[Step=32550 Epoch=158.7] | Loss=0.00500 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.656 | L2-Norm(final)=3.377 | 3538.8 samples/s | 55.3 steps/s
[Step=32600 Epoch=159.0] | Loss=0.00475 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.655 | L2-Norm(final)=3.378 | 3930.4 samples/s | 61.4 steps/s
[Step=32650 Epoch=159.2] | Loss=0.00454 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.655 | L2-Norm(final)=3.379 | 1602.0 samples/s | 25.0 steps/s
[Step=32700 Epoch=159.5] | Loss=0.00436 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.655 | L2-Norm(final)=3.380 | 3597.9 samples/s | 56.2 steps/s
[Step=32750 Epoch=159.7] | Loss=0.00425 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.654 | L2-Norm(final)=3.381 | 3489.4 samples/s | 54.5 steps/s
[Step=32800 Epoch=160.0] | Loss=0.00413 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.654 | L2-Norm(final)=3.382 | 3875.4 samples/s | 60.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step32800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.9] | Loss=0.10240 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.681 | L2-Norm(final)=3.369 | 3608.3 samples/s | 56.4 steps/s
[Step=32050 Epoch=157.2] | Loss=0.02033 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.669 | L2-Norm(final)=3.367 | 3432.2 samples/s | 53.6 steps/s
[Step=32100 Epoch=157.4] | Loss=0.01400 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.664 | L2-Norm(final)=3.367 | 3560.4 samples/s | 55.6 steps/s
[Step=32150 Epoch=157.7] | Loss=0.01168 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.661 | L2-Norm(final)=3.368 | 3482.6 samples/s | 54.4 steps/s
[Step=32200 Epoch=157.9] | Loss=0.00991 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.659 | L2-Norm(final)=3.369 | 4581.5 samples/s | 71.6 steps/s
[Step=32250 Epoch=158.1] | Loss=0.00851 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.657 | L2-Norm(final)=3.369 | 1586.9 samples/s | 24.8 steps/s
[Step=32300 Epoch=158.4] | Loss=0.00758 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.656 | L2-Norm(final)=3.370 | 3550.9 samples/s | 55.5 steps/s
[Step=32350 Epoch=158.6] | Loss=0.00699 | Reg=0.00277 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.655 | L2-Norm(final)=3.371 | 3462.7 samples/s | 54.1 steps/s
[Step=32400 Epoch=158.9] | Loss=0.00647 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.655 | L2-Norm(final)=3.372 | 4240.7 samples/s | 66.3 steps/s
[Step=32450 Epoch=159.1] | Loss=0.00610 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.654 | L2-Norm(final)=3.374 | 1602.0 samples/s | 25.0 steps/s
[Step=32500 Epoch=159.4] | Loss=0.00571 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.654 | L2-Norm(final)=3.375 | 3628.5 samples/s | 56.7 steps/s
[Step=32550 Epoch=159.6] | Loss=0.00542 | Reg=0.00277 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.653 | L2-Norm(final)=3.376 | 3554.3 samples/s | 55.5 steps/s
[Step=32600 Epoch=159.9] | Loss=0.00517 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.653 | L2-Norm(final)=3.377 | 4096.1 samples/s | 64.0 steps/s
[Step=32650 Epoch=160.1] | Loss=0.00490 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.652 | L2-Norm(final)=3.378 | 1577.3 samples/s | 24.6 steps/s
[Step=32700 Epoch=160.4] | Loss=0.00472 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.652 | L2-Norm(final)=3.379 | 3601.1 samples/s | 56.3 steps/s
[Step=32750 Epoch=160.6] | Loss=0.00454 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.652 | L2-Norm(final)=3.379 | 3623.9 samples/s | 56.6 steps/s
[Step=32800 Epoch=160.8] | Loss=0.00441 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.652 | L2-Norm(final)=3.380 | 3955.6 samples/s | 61.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step32800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=303.2] | Loss=0.07373 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.681 | L2-Norm(final)=3.369 | 3619.1 samples/s | 56.5 steps/s
[Step=32050 Epoch=303.7] | Loss=0.00396 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.641 | L2-Norm(final)=3.373 | 3242.5 samples/s | 50.7 steps/s
[Step=32100 Epoch=304.2] | Loss=0.00202 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.634 | L2-Norm(final)=3.374 | 4198.7 samples/s | 65.6 steps/s
[Step=32150 Epoch=304.6] | Loss=0.00136 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.629 | L2-Norm(final)=3.374 | 1535.5 samples/s | 24.0 steps/s
[Step=32200 Epoch=305.1] | Loss=0.00103 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.626 | L2-Norm(final)=3.375 | 3946.6 samples/s | 61.7 steps/s
[Step=32250 Epoch=305.6] | Loss=0.00083 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.624 | L2-Norm(final)=3.375 | 1526.3 samples/s | 23.8 steps/s
[Step=32300 Epoch=306.1] | Loss=0.00070 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.622 | L2-Norm(final)=3.375 | 3736.2 samples/s | 58.4 steps/s
[Step=32350 Epoch=306.5] | Loss=0.00060 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.620 | L2-Norm(final)=3.375 | 1599.4 samples/s | 25.0 steps/s
[Step=32400 Epoch=307.0] | Loss=0.00053 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.618 | L2-Norm(final)=3.375 | 3622.7 samples/s | 56.6 steps/s
[Step=32450 Epoch=307.5] | Loss=0.00047 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.617 | L2-Norm(final)=3.375 | 1654.6 samples/s | 25.9 steps/s
[Step=32500 Epoch=308.0] | Loss=0.00043 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.616 | L2-Norm(final)=3.375 | 3424.1 samples/s | 53.5 steps/s
[Step=32550 Epoch=308.4] | Loss=0.00039 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.614 | L2-Norm(final)=3.375 | 1624.9 samples/s | 25.4 steps/s
[Step=32600 Epoch=308.9] | Loss=0.00036 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.613 | L2-Norm(final)=3.375 | 3305.6 samples/s | 51.7 steps/s
[Step=32650 Epoch=309.4] | Loss=0.00034 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.612 | L2-Norm(final)=3.375 | 1642.3 samples/s | 25.7 steps/s
[Step=32700 Epoch=309.9] | Loss=0.00031 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.611 | L2-Norm(final)=3.375 | 3359.3 samples/s | 52.5 steps/s
[Step=32750 Epoch=310.3] | Loss=0.00029 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.610 | L2-Norm(final)=3.375 | 1729.7 samples/s | 27.0 steps/s
[Step=32800 Epoch=310.8] | Loss=0.00028 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.609 | L2-Norm(final)=3.376 | 3313.4 samples/s | 51.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step32800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=304.4] | Loss=0.00561 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.681 | L2-Norm(final)=3.369 | 3783.8 samples/s | 59.1 steps/s
[Step=32050 Epoch=304.9] | Loss=0.00349 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.646 | L2-Norm(final)=3.374 | 3081.4 samples/s | 48.1 steps/s
[Step=32100 Epoch=305.4] | Loss=0.00181 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.639 | L2-Norm(final)=3.375 | 4242.8 samples/s | 66.3 steps/s
[Step=32150 Epoch=305.8] | Loss=0.00122 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.635 | L2-Norm(final)=3.376 | 1543.9 samples/s | 24.1 steps/s
[Step=32200 Epoch=306.3] | Loss=0.00093 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.632 | L2-Norm(final)=3.376 | 3994.4 samples/s | 62.4 steps/s
[Step=32250 Epoch=306.8] | Loss=0.00075 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.629 | L2-Norm(final)=3.376 | 1588.4 samples/s | 24.8 steps/s
[Step=32300 Epoch=307.3] | Loss=0.00063 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.627 | L2-Norm(final)=3.376 | 3985.3 samples/s | 62.3 steps/s
[Step=32350 Epoch=307.7] | Loss=0.00055 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.625 | L2-Norm(final)=3.377 | 1588.5 samples/s | 24.8 steps/s
[Step=32400 Epoch=308.2] | Loss=0.00048 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.623 | L2-Norm(final)=3.377 | 3656.1 samples/s | 57.1 steps/s
[Step=32450 Epoch=308.7] | Loss=0.00043 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.622 | L2-Norm(final)=3.377 | 1607.8 samples/s | 25.1 steps/s
[Step=32500 Epoch=309.2] | Loss=0.00039 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.620 | L2-Norm(final)=3.377 | 3483.2 samples/s | 54.4 steps/s
[Step=32550 Epoch=309.6] | Loss=0.00036 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.619 | L2-Norm(final)=3.377 | 1674.3 samples/s | 26.2 steps/s
[Step=32600 Epoch=310.1] | Loss=0.00033 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.618 | L2-Norm(final)=3.377 | 3366.5 samples/s | 52.6 steps/s
[Step=32650 Epoch=310.6] | Loss=0.00031 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.617 | L2-Norm(final)=3.377 | 1665.2 samples/s | 26.0 steps/s
[Step=32700 Epoch=311.1] | Loss=0.00029 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.616 | L2-Norm(final)=3.377 | 3354.5 samples/s | 52.4 steps/s
[Step=32750 Epoch=311.5] | Loss=0.00027 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.615 | L2-Norm(final)=3.377 | 1670.7 samples/s | 26.1 steps/s
[Step=32800 Epoch=312.0] | Loss=0.00025 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.614 | L2-Norm(final)=3.377 | 3343.3 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step32800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=305.6] | Loss=0.00335 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.681 | L2-Norm(final)=3.369 | 4017.4 samples/s | 62.8 steps/s
[Step=32050 Epoch=306.1] | Loss=0.00583 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.643 | L2-Norm(final)=3.373 | 2989.2 samples/s | 46.7 steps/s
[Step=32100 Epoch=306.5] | Loss=0.00295 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.636 | L2-Norm(final)=3.374 | 4212.2 samples/s | 65.8 steps/s
[Step=32150 Epoch=307.0] | Loss=0.00198 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.631 | L2-Norm(final)=3.374 | 1530.3 samples/s | 23.9 steps/s
[Step=32200 Epoch=307.5] | Loss=0.00150 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.628 | L2-Norm(final)=3.374 | 4035.9 samples/s | 63.1 steps/s
[Step=32250 Epoch=308.0] | Loss=0.00121 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.626 | L2-Norm(final)=3.374 | 1532.5 samples/s | 23.9 steps/s
[Step=32300 Epoch=308.4] | Loss=0.00101 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.624 | L2-Norm(final)=3.375 | 3820.1 samples/s | 59.7 steps/s
[Step=32350 Epoch=308.9] | Loss=0.00087 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.622 | L2-Norm(final)=3.375 | 1558.6 samples/s | 24.4 steps/s
[Step=32400 Epoch=309.4] | Loss=0.00077 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.620 | L2-Norm(final)=3.375 | 3740.9 samples/s | 58.5 steps/s
[Step=32450 Epoch=309.9] | Loss=0.00068 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.619 | L2-Norm(final)=3.375 | 1621.6 samples/s | 25.3 steps/s
[Step=32500 Epoch=310.4] | Loss=0.00062 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.617 | L2-Norm(final)=3.375 | 3614.6 samples/s | 56.5 steps/s
[Step=32550 Epoch=310.8] | Loss=0.00056 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.616 | L2-Norm(final)=3.375 | 1632.8 samples/s | 25.5 steps/s
[Step=32600 Epoch=311.3] | Loss=0.00052 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.615 | L2-Norm(final)=3.375 | 3497.7 samples/s | 54.7 steps/s
[Step=32650 Epoch=311.8] | Loss=0.00048 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.614 | L2-Norm(final)=3.375 | 1643.1 samples/s | 25.7 steps/s
[Step=32700 Epoch=312.3] | Loss=0.00045 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.613 | L2-Norm(final)=3.375 | 3429.2 samples/s | 53.6 steps/s
[Step=32750 Epoch=312.7] | Loss=0.00042 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.612 | L2-Norm(final)=3.375 | 1680.4 samples/s | 26.3 steps/s
[Step=32800 Epoch=313.2] | Loss=0.00039 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.611 | L2-Norm(final)=3.375 | 3348.5 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step32800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=301.5] | Loss=0.12611 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.681 | L2-Norm(final)=3.369 | 3514.1 samples/s | 54.9 steps/s
[Step=32050 Epoch=302.0] | Loss=0.00822 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.640 | L2-Norm(final)=3.371 | 3326.4 samples/s | 52.0 steps/s
[Step=32100 Epoch=302.5] | Loss=0.00416 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.633 | L2-Norm(final)=3.372 | 4208.0 samples/s | 65.7 steps/s
[Step=32150 Epoch=302.9] | Loss=0.00279 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.628 | L2-Norm(final)=3.372 | 1525.4 samples/s | 23.8 steps/s
[Step=32200 Epoch=303.4] | Loss=0.00211 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.625 | L2-Norm(final)=3.373 | 3938.8 samples/s | 61.5 steps/s
[Step=32250 Epoch=303.9] | Loss=0.00169 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.623 | L2-Norm(final)=3.373 | 1592.4 samples/s | 24.9 steps/s
[Step=32300 Epoch=304.4] | Loss=0.00142 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.621 | L2-Norm(final)=3.373 | 3681.7 samples/s | 57.5 steps/s
[Step=32350 Epoch=304.8] | Loss=0.00122 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.619 | L2-Norm(final)=3.373 | 1613.1 samples/s | 25.2 steps/s
[Step=32400 Epoch=305.3] | Loss=0.00107 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.617 | L2-Norm(final)=3.373 | 3471.2 samples/s | 54.2 steps/s
[Step=32450 Epoch=305.8] | Loss=0.00095 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.616 | L2-Norm(final)=3.373 | 1644.2 samples/s | 25.7 steps/s
[Step=32500 Epoch=306.2] | Loss=0.00086 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.615 | L2-Norm(final)=3.373 | 3309.1 samples/s | 51.7 steps/s
[Step=32550 Epoch=306.7] | Loss=0.00079 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.614 | L2-Norm(final)=3.373 | 1712.9 samples/s | 26.8 steps/s
[Step=32600 Epoch=307.2] | Loss=0.00072 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.613 | L2-Norm(final)=3.373 | 3363.5 samples/s | 52.6 steps/s
[Step=32650 Epoch=307.7] | Loss=0.00067 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.612 | L2-Norm(final)=3.373 | 1676.0 samples/s | 26.2 steps/s
[Step=32700 Epoch=308.1] | Loss=0.00062 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.611 | L2-Norm(final)=3.374 | 3368.6 samples/s | 52.6 steps/s
[Step=32750 Epoch=308.6] | Loss=0.00058 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.610 | L2-Norm(final)=3.374 | 1828.1 samples/s | 28.6 steps/s
[Step=32800 Epoch=309.1] | Loss=0.00055 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.609 | L2-Norm(final)=3.374 | 3149.0 samples/s | 49.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step32800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=305.0] | Loss=0.08388 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.681 | L2-Norm(final)=3.369 | 3573.3 samples/s | 55.8 steps/s
[Step=32050 Epoch=305.5] | Loss=0.00807 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.644 | L2-Norm(final)=3.371 | 3348.5 samples/s | 52.3 steps/s
[Step=32100 Epoch=305.9] | Loss=0.00416 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.636 | L2-Norm(final)=3.372 | 4204.3 samples/s | 65.7 steps/s
[Step=32150 Epoch=306.4] | Loss=0.00279 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.632 | L2-Norm(final)=3.373 | 1494.4 samples/s | 23.4 steps/s
[Step=32200 Epoch=306.9] | Loss=0.00211 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.629 | L2-Norm(final)=3.373 | 4015.0 samples/s | 62.7 steps/s
[Step=32250 Epoch=307.4] | Loss=0.00170 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.626 | L2-Norm(final)=3.373 | 1566.3 samples/s | 24.5 steps/s
[Step=32300 Epoch=307.8] | Loss=0.00143 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.624 | L2-Norm(final)=3.373 | 3827.1 samples/s | 59.8 steps/s
[Step=32350 Epoch=308.3] | Loss=0.00123 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.622 | L2-Norm(final)=3.374 | 1586.7 samples/s | 24.8 steps/s
[Step=32400 Epoch=308.8] | Loss=0.00108 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.621 | L2-Norm(final)=3.374 | 3839.7 samples/s | 60.0 steps/s
[Step=32450 Epoch=309.3] | Loss=0.00096 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.619 | L2-Norm(final)=3.374 | 1605.7 samples/s | 25.1 steps/s
[Step=32500 Epoch=309.8] | Loss=0.00087 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.618 | L2-Norm(final)=3.374 | 3479.3 samples/s | 54.4 steps/s
[Step=32550 Epoch=310.2] | Loss=0.00080 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.617 | L2-Norm(final)=3.374 | 1618.8 samples/s | 25.3 steps/s
[Step=32600 Epoch=310.7] | Loss=0.00073 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.616 | L2-Norm(final)=3.374 | 3324.8 samples/s | 52.0 steps/s
[Step=32650 Epoch=311.2] | Loss=0.00068 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.615 | L2-Norm(final)=3.374 | 1663.4 samples/s | 26.0 steps/s
[Step=32700 Epoch=311.7] | Loss=0.00063 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.614 | L2-Norm(final)=3.374 | 3383.7 samples/s | 52.9 steps/s
[Step=32750 Epoch=312.1] | Loss=0.00059 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.613 | L2-Norm(final)=3.374 | 1685.6 samples/s | 26.3 steps/s
[Step=32800 Epoch=312.6] | Loss=0.00056 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.612 | L2-Norm(final)=3.374 | 3424.4 samples/s | 53.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22181 | acc=0.8846 | tpr=0.8392 | fpr=0.0168 | 3720.0 samples/s | 14.5 steps/s
Avg test loss: 0.22358, Avg test acc: 0.88425, Avg tpr: 0.83902, Avg fpr: 0.01628, total FA: 127

Testing server on iccad2012
[Step=  50] | Loss=0.42716 | acc=0.8731 | tpr=0.9558 | fpr=0.1284 | 3802.0 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.43549 | acc=0.8725 | tpr=0.9595 | fpr=0.1292 | 6645.7 samples/s | 26.0 steps/s
[Step= 150] | Loss=0.44137 | acc=0.8714 | tpr=0.9640 | fpr=0.1303 | 7125.9 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.44219 | acc=0.8724 | tpr=0.9639 | fpr=0.1293 | 6917.0 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.44081 | acc=0.8727 | tpr=0.9659 | fpr=0.1290 | 6788.6 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.43953 | acc=0.8733 | tpr=0.9622 | fpr=0.1283 | 7084.0 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.44193 | acc=0.8734 | tpr=0.9599 | fpr=0.1281 | 7286.9 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.44280 | acc=0.8735 | tpr=0.9584 | fpr=0.1280 | 6642.2 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.44703 | acc=0.8729 | tpr=0.9586 | fpr=0.1287 | 6706.5 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.44762 | acc=0.8728 | tpr=0.9604 | fpr=0.1288 | 7129.8 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.44671 | acc=0.8731 | tpr=0.9622 | fpr=0.1285 | 12320.8 samples/s | 48.1 steps/s
Avg test loss: 0.44650, Avg test acc: 0.87307, Avg tpr: 0.96236, Avg fpr: 0.12855, total FA: 17849

server round 41/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=159.9] | Loss=0.08169 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.619 | L2-Norm(final)=3.385 | 3585.2 samples/s | 56.0 steps/s
[Step=32850 Epoch=160.2] | Loss=0.02321 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.608 | L2-Norm(final)=3.381 | 3479.0 samples/s | 54.4 steps/s
[Step=32900 Epoch=160.4] | Loss=0.01664 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.603 | L2-Norm(final)=3.381 | 3517.4 samples/s | 55.0 steps/s
[Step=32950 Epoch=160.7] | Loss=0.01285 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.599 | L2-Norm(final)=3.381 | 3518.7 samples/s | 55.0 steps/s
[Step=33000 Epoch=160.9] | Loss=0.01062 | Reg=0.00275 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.597 | L2-Norm(final)=3.382 | 4296.3 samples/s | 67.1 steps/s
[Step=33050 Epoch=161.2] | Loss=0.00926 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.596 | L2-Norm(final)=3.383 | 1596.9 samples/s | 25.0 steps/s
[Step=33100 Epoch=161.4] | Loss=0.00839 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.594 | L2-Norm(final)=3.383 | 3503.1 samples/s | 54.7 steps/s
[Step=33150 Epoch=161.6] | Loss=0.00767 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.593 | L2-Norm(final)=3.384 | 3535.2 samples/s | 55.2 steps/s
[Step=33200 Epoch=161.9] | Loss=0.00709 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.593 | L2-Norm(final)=3.385 | 4136.1 samples/s | 64.6 steps/s
[Step=33250 Epoch=162.1] | Loss=0.00667 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.592 | L2-Norm(final)=3.386 | 1595.5 samples/s | 24.9 steps/s
[Step=33300 Epoch=162.4] | Loss=0.00637 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.591 | L2-Norm(final)=3.387 | 3558.4 samples/s | 55.6 steps/s
[Step=33350 Epoch=162.6] | Loss=0.00611 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.591 | L2-Norm(final)=3.388 | 3711.3 samples/s | 58.0 steps/s
[Step=33400 Epoch=162.9] | Loss=0.00578 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.590 | L2-Norm(final)=3.388 | 3945.3 samples/s | 61.6 steps/s
[Step=33450 Epoch=163.1] | Loss=0.00553 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.590 | L2-Norm(final)=3.389 | 1628.8 samples/s | 25.5 steps/s
[Step=33500 Epoch=163.4] | Loss=0.00530 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.590 | L2-Norm(final)=3.390 | 3481.8 samples/s | 54.4 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00518 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.589 | L2-Norm(final)=3.391 | 3455.2 samples/s | 54.0 steps/s
[Step=33600 Epoch=163.8] | Loss=0.00501 | Reg=0.00275 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.589 | L2-Norm(final)=3.392 | 3665.7 samples/s | 57.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step33600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=160.1] | Loss=0.13795 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=16.619 | L2-Norm(final)=3.385 | 3556.2 samples/s | 55.6 steps/s
[Step=32850 Epoch=160.3] | Loss=0.01868 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.607 | L2-Norm(final)=3.383 | 3416.1 samples/s | 53.4 steps/s
[Step=32900 Epoch=160.5] | Loss=0.01307 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.602 | L2-Norm(final)=3.382 | 3446.1 samples/s | 53.8 steps/s
[Step=32950 Epoch=160.8] | Loss=0.01023 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.599 | L2-Norm(final)=3.383 | 3499.0 samples/s | 54.7 steps/s
[Step=33000 Epoch=161.0] | Loss=0.00896 | Reg=0.00275 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.597 | L2-Norm(final)=3.384 | 4265.7 samples/s | 66.7 steps/s
[Step=33050 Epoch=161.3] | Loss=0.00777 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.595 | L2-Norm(final)=3.385 | 1537.0 samples/s | 24.0 steps/s
[Step=33100 Epoch=161.5] | Loss=0.00688 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.594 | L2-Norm(final)=3.386 | 3614.2 samples/s | 56.5 steps/s
[Step=33150 Epoch=161.8] | Loss=0.00637 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.593 | L2-Norm(final)=3.386 | 3559.4 samples/s | 55.6 steps/s
[Step=33200 Epoch=162.0] | Loss=0.00598 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.592 | L2-Norm(final)=3.387 | 4163.7 samples/s | 65.1 steps/s
[Step=33250 Epoch=162.2] | Loss=0.00554 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.592 | L2-Norm(final)=3.388 | 1643.3 samples/s | 25.7 steps/s
[Step=33300 Epoch=162.5] | Loss=0.00511 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.591 | L2-Norm(final)=3.389 | 3571.4 samples/s | 55.8 steps/s
[Step=33350 Epoch=162.7] | Loss=0.00484 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.590 | L2-Norm(final)=3.390 | 3531.6 samples/s | 55.2 steps/s
[Step=33400 Epoch=163.0] | Loss=0.00474 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.590 | L2-Norm(final)=3.391 | 4041.5 samples/s | 63.1 steps/s
[Step=33450 Epoch=163.2] | Loss=0.00463 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.590 | L2-Norm(final)=3.392 | 1594.3 samples/s | 24.9 steps/s
[Step=33500 Epoch=163.5] | Loss=0.00450 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.589 | L2-Norm(final)=3.392 | 3532.1 samples/s | 55.2 steps/s
[Step=33550 Epoch=163.7] | Loss=0.00435 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.589 | L2-Norm(final)=3.393 | 3597.2 samples/s | 56.2 steps/s
[Step=33600 Epoch=164.0] | Loss=0.00419 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.588 | L2-Norm(final)=3.394 | 3973.9 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step33600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=159.8] | Loss=0.11185 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=16.619 | L2-Norm(final)=3.385 | 3673.4 samples/s | 57.4 steps/s
[Step=32850 Epoch=160.1] | Loss=0.01689 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.604 | L2-Norm(final)=3.384 | 3401.1 samples/s | 53.1 steps/s
[Step=32900 Epoch=160.3] | Loss=0.01187 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.599 | L2-Norm(final)=3.384 | 3538.5 samples/s | 55.3 steps/s
[Step=32950 Epoch=160.5] | Loss=0.00949 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.596 | L2-Norm(final)=3.385 | 3485.2 samples/s | 54.5 steps/s
[Step=33000 Epoch=160.8] | Loss=0.00864 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.594 | L2-Norm(final)=3.386 | 4332.2 samples/s | 67.7 steps/s
[Step=33050 Epoch=161.0] | Loss=0.00753 | Reg=0.00275 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.593 | L2-Norm(final)=3.387 | 1579.4 samples/s | 24.7 steps/s
[Step=33100 Epoch=161.3] | Loss=0.00682 | Reg=0.00275 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.592 | L2-Norm(final)=3.388 | 3614.4 samples/s | 56.5 steps/s
[Step=33150 Epoch=161.5] | Loss=0.00638 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.592 | L2-Norm(final)=3.389 | 3637.3 samples/s | 56.8 steps/s
[Step=33200 Epoch=161.8] | Loss=0.00591 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.591 | L2-Norm(final)=3.390 | 4110.2 samples/s | 64.2 steps/s
[Step=33250 Epoch=162.0] | Loss=0.00551 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.591 | L2-Norm(final)=3.391 | 1568.0 samples/s | 24.5 steps/s
[Step=33300 Epoch=162.3] | Loss=0.00520 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.590 | L2-Norm(final)=3.392 | 3560.9 samples/s | 55.6 steps/s
[Step=33350 Epoch=162.5] | Loss=0.00503 | Reg=0.00275 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.590 | L2-Norm(final)=3.394 | 3567.2 samples/s | 55.7 steps/s
[Step=33400 Epoch=162.7] | Loss=0.00479 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.590 | L2-Norm(final)=3.395 | 3911.2 samples/s | 61.1 steps/s
[Step=33450 Epoch=163.0] | Loss=0.00458 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.590 | L2-Norm(final)=3.396 | 1643.3 samples/s | 25.7 steps/s
[Step=33500 Epoch=163.2] | Loss=0.00439 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.589 | L2-Norm(final)=3.397 | 3501.0 samples/s | 54.7 steps/s
[Step=33550 Epoch=163.5] | Loss=0.00424 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.589 | L2-Norm(final)=3.398 | 3502.1 samples/s | 54.7 steps/s
[Step=33600 Epoch=163.7] | Loss=0.00415 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.589 | L2-Norm(final)=3.399 | 3695.6 samples/s | 57.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step33600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=160.0] | Loss=0.10396 | Reg=0.00276 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=16.619 | L2-Norm(final)=3.385 | 3510.6 samples/s | 54.9 steps/s
[Step=32850 Epoch=160.2] | Loss=0.01626 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.606 | L2-Norm(final)=3.383 | 3466.2 samples/s | 54.2 steps/s
[Step=32900 Epoch=160.4] | Loss=0.01079 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.602 | L2-Norm(final)=3.384 | 3586.9 samples/s | 56.0 steps/s
[Step=32950 Epoch=160.7] | Loss=0.00906 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.600 | L2-Norm(final)=3.385 | 3591.6 samples/s | 56.1 steps/s
[Step=33000 Epoch=160.9] | Loss=0.00813 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.598 | L2-Norm(final)=3.385 | 4384.5 samples/s | 68.5 steps/s
[Step=33050 Epoch=161.2] | Loss=0.00721 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.597 | L2-Norm(final)=3.386 | 1569.3 samples/s | 24.5 steps/s
[Step=33100 Epoch=161.4] | Loss=0.00637 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.596 | L2-Norm(final)=3.387 | 3510.5 samples/s | 54.9 steps/s
[Step=33150 Epoch=161.7] | Loss=0.00594 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.595 | L2-Norm(final)=3.388 | 3513.9 samples/s | 54.9 steps/s
[Step=33200 Epoch=161.9] | Loss=0.00552 | Reg=0.00275 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.594 | L2-Norm(final)=3.389 | 4073.3 samples/s | 63.6 steps/s
[Step=33250 Epoch=162.1] | Loss=0.00516 | Reg=0.00275 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.594 | L2-Norm(final)=3.390 | 1605.7 samples/s | 25.1 steps/s
[Step=33300 Epoch=162.4] | Loss=0.00492 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.593 | L2-Norm(final)=3.391 | 3655.6 samples/s | 57.1 steps/s
[Step=33350 Epoch=162.6] | Loss=0.00465 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.593 | L2-Norm(final)=3.392 | 3484.0 samples/s | 54.4 steps/s
[Step=33400 Epoch=162.9] | Loss=0.00455 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.592 | L2-Norm(final)=3.393 | 3851.3 samples/s | 60.2 steps/s
[Step=33450 Epoch=163.1] | Loss=0.00436 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.592 | L2-Norm(final)=3.394 | 1633.9 samples/s | 25.5 steps/s
[Step=33500 Epoch=163.4] | Loss=0.00425 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.591 | L2-Norm(final)=3.395 | 3489.3 samples/s | 54.5 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00411 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.591 | L2-Norm(final)=3.396 | 3525.8 samples/s | 55.1 steps/s
[Step=33600 Epoch=163.9] | Loss=0.00399 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.591 | L2-Norm(final)=3.397 | 3805.3 samples/s | 59.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step33600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=160.9] | Loss=0.04690 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.619 | L2-Norm(final)=3.385 | 3661.8 samples/s | 57.2 steps/s
[Step=32850 Epoch=161.1] | Loss=0.02124 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.608 | L2-Norm(final)=3.382 | 3540.7 samples/s | 55.3 steps/s
[Step=32900 Epoch=161.3] | Loss=0.01474 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.603 | L2-Norm(final)=3.382 | 3490.3 samples/s | 54.5 steps/s
[Step=32950 Epoch=161.6] | Loss=0.01153 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.600 | L2-Norm(final)=3.382 | 3530.1 samples/s | 55.2 steps/s
[Step=33000 Epoch=161.8] | Loss=0.00974 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.598 | L2-Norm(final)=3.383 | 4429.4 samples/s | 69.2 steps/s
[Step=33050 Epoch=162.1] | Loss=0.00843 | Reg=0.00275 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.597 | L2-Norm(final)=3.384 | 1568.4 samples/s | 24.5 steps/s
[Step=33100 Epoch=162.3] | Loss=0.00741 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.596 | L2-Norm(final)=3.385 | 3620.4 samples/s | 56.6 steps/s
[Step=33150 Epoch=162.6] | Loss=0.00680 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.595 | L2-Norm(final)=3.386 | 3499.3 samples/s | 54.7 steps/s
[Step=33200 Epoch=162.8] | Loss=0.00633 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.594 | L2-Norm(final)=3.387 | 4212.2 samples/s | 65.8 steps/s
[Step=33250 Epoch=163.1] | Loss=0.00586 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.593 | L2-Norm(final)=3.388 | 1593.4 samples/s | 24.9 steps/s
[Step=33300 Epoch=163.3] | Loss=0.00555 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.593 | L2-Norm(final)=3.388 | 3473.4 samples/s | 54.3 steps/s
[Step=33350 Epoch=163.5] | Loss=0.00530 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.592 | L2-Norm(final)=3.389 | 3462.5 samples/s | 54.1 steps/s
[Step=33400 Epoch=163.8] | Loss=0.00506 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.592 | L2-Norm(final)=3.390 | 4088.2 samples/s | 63.9 steps/s
[Step=33450 Epoch=164.0] | Loss=0.00488 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.592 | L2-Norm(final)=3.391 | 1607.2 samples/s | 25.1 steps/s
[Step=33500 Epoch=164.3] | Loss=0.00471 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.591 | L2-Norm(final)=3.392 | 3478.6 samples/s | 54.4 steps/s
[Step=33550 Epoch=164.5] | Loss=0.00457 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.591 | L2-Norm(final)=3.393 | 3469.5 samples/s | 54.2 steps/s
[Step=33600 Epoch=164.8] | Loss=0.00438 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.591 | L2-Norm(final)=3.394 | 3927.6 samples/s | 61.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step33600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=310.8] | Loss=0.05891 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.619 | L2-Norm(final)=3.385 | 3856.8 samples/s | 60.3 steps/s
[Step=32850 Epoch=311.3] | Loss=0.00456 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.582 | L2-Norm(final)=3.389 | 3067.8 samples/s | 47.9 steps/s
[Step=32900 Epoch=311.8] | Loss=0.00231 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.575 | L2-Norm(final)=3.390 | 4155.9 samples/s | 64.9 steps/s
[Step=32950 Epoch=312.2] | Loss=0.00156 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.571 | L2-Norm(final)=3.390 | 1518.8 samples/s | 23.7 steps/s
[Step=33000 Epoch=312.7] | Loss=0.00118 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.568 | L2-Norm(final)=3.390 | 3966.4 samples/s | 62.0 steps/s
[Step=33050 Epoch=313.2] | Loss=0.00095 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.565 | L2-Norm(final)=3.390 | 1516.2 samples/s | 23.7 steps/s
[Step=33100 Epoch=313.7] | Loss=0.00079 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.563 | L2-Norm(final)=3.390 | 3886.6 samples/s | 60.7 steps/s
[Step=33150 Epoch=314.1] | Loss=0.00069 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.562 | L2-Norm(final)=3.390 | 1596.9 samples/s | 25.0 steps/s
[Step=33200 Epoch=314.6] | Loss=0.00060 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.560 | L2-Norm(final)=3.391 | 3646.0 samples/s | 57.0 steps/s
[Step=33250 Epoch=315.1] | Loss=0.00054 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.559 | L2-Norm(final)=3.391 | 1629.5 samples/s | 25.5 steps/s
[Step=33300 Epoch=315.5] | Loss=0.00049 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.557 | L2-Norm(final)=3.391 | 3495.1 samples/s | 54.6 steps/s
[Step=33350 Epoch=316.0] | Loss=0.00045 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.556 | L2-Norm(final)=3.391 | 1655.8 samples/s | 25.9 steps/s
[Step=33400 Epoch=316.5] | Loss=0.00041 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.555 | L2-Norm(final)=3.391 | 3336.1 samples/s | 52.1 steps/s
[Step=33450 Epoch=317.0] | Loss=0.00038 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.554 | L2-Norm(final)=3.391 | 1690.8 samples/s | 26.4 steps/s
[Step=33500 Epoch=317.4] | Loss=0.00035 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.553 | L2-Norm(final)=3.391 | 3462.1 samples/s | 54.1 steps/s
[Step=33550 Epoch=317.9] | Loss=0.00033 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.552 | L2-Norm(final)=3.391 | 1718.2 samples/s | 26.8 steps/s
[Step=33600 Epoch=318.4] | Loss=0.00031 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.551 | L2-Norm(final)=3.391 | 3320.2 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step33600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=312.0] | Loss=0.04696 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.619 | L2-Norm(final)=3.385 | 3437.5 samples/s | 53.7 steps/s
[Step=32850 Epoch=312.5] | Loss=0.00653 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.581 | L2-Norm(final)=3.387 | 3385.1 samples/s | 52.9 steps/s
[Step=32900 Epoch=313.0] | Loss=0.00329 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.574 | L2-Norm(final)=3.387 | 4218.1 samples/s | 65.9 steps/s
[Step=32950 Epoch=313.4] | Loss=0.00221 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.570 | L2-Norm(final)=3.387 | 1519.0 samples/s | 23.7 steps/s
[Step=33000 Epoch=313.9] | Loss=0.00166 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.567 | L2-Norm(final)=3.387 | 4159.3 samples/s | 65.0 steps/s
[Step=33050 Epoch=314.4] | Loss=0.00134 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.564 | L2-Norm(final)=3.388 | 1563.7 samples/s | 24.4 steps/s
[Step=33100 Epoch=314.9] | Loss=0.00112 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.562 | L2-Norm(final)=3.388 | 3751.2 samples/s | 58.6 steps/s
[Step=33150 Epoch=315.3] | Loss=0.00096 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.561 | L2-Norm(final)=3.388 | 1609.6 samples/s | 25.2 steps/s
[Step=33200 Epoch=315.8] | Loss=0.00085 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.559 | L2-Norm(final)=3.388 | 3705.7 samples/s | 57.9 steps/s
[Step=33250 Epoch=316.3] | Loss=0.00075 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.558 | L2-Norm(final)=3.388 | 1597.3 samples/s | 25.0 steps/s
[Step=33300 Epoch=316.8] | Loss=0.00068 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.556 | L2-Norm(final)=3.388 | 3383.2 samples/s | 52.9 steps/s
[Step=33350 Epoch=317.2] | Loss=0.00062 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.555 | L2-Norm(final)=3.388 | 1654.5 samples/s | 25.9 steps/s
[Step=33400 Epoch=317.7] | Loss=0.00057 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.554 | L2-Norm(final)=3.388 | 3364.7 samples/s | 52.6 steps/s
[Step=33450 Epoch=318.2] | Loss=0.00053 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.553 | L2-Norm(final)=3.388 | 1655.5 samples/s | 25.9 steps/s
[Step=33500 Epoch=318.7] | Loss=0.00049 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.552 | L2-Norm(final)=3.388 | 3372.5 samples/s | 52.7 steps/s
[Step=33550 Epoch=319.1] | Loss=0.00046 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.551 | L2-Norm(final)=3.388 | 1683.2 samples/s | 26.3 steps/s
[Step=33600 Epoch=319.6] | Loss=0.00043 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.550 | L2-Norm(final)=3.388 | 3236.5 samples/s | 50.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step33600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=313.2] | Loss=0.01244 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.619 | L2-Norm(final)=3.385 | 3566.9 samples/s | 55.7 steps/s
[Step=32850 Epoch=313.7] | Loss=0.00508 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.584 | L2-Norm(final)=3.390 | 3284.7 samples/s | 51.3 steps/s
[Step=32900 Epoch=314.2] | Loss=0.00256 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.577 | L2-Norm(final)=3.390 | 4444.0 samples/s | 69.4 steps/s
[Step=32950 Epoch=314.7] | Loss=0.00172 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.573 | L2-Norm(final)=3.391 | 1519.2 samples/s | 23.7 steps/s
[Step=33000 Epoch=315.1] | Loss=0.00129 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.570 | L2-Norm(final)=3.391 | 4009.9 samples/s | 62.7 steps/s
[Step=33050 Epoch=315.6] | Loss=0.00104 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.567 | L2-Norm(final)=3.391 | 1549.3 samples/s | 24.2 steps/s
[Step=33100 Epoch=316.1] | Loss=0.00087 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.565 | L2-Norm(final)=3.391 | 3830.9 samples/s | 59.9 steps/s
[Step=33150 Epoch=316.6] | Loss=0.00075 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.563 | L2-Norm(final)=3.391 | 1570.2 samples/s | 24.5 steps/s
[Step=33200 Epoch=317.0] | Loss=0.00066 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.562 | L2-Norm(final)=3.391 | 3642.0 samples/s | 56.9 steps/s
[Step=33250 Epoch=317.5] | Loss=0.00058 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.560 | L2-Norm(final)=3.391 | 1613.1 samples/s | 25.2 steps/s
[Step=33300 Epoch=318.0] | Loss=0.00053 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.559 | L2-Norm(final)=3.391 | 3452.6 samples/s | 53.9 steps/s
[Step=33350 Epoch=318.5] | Loss=0.00048 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.558 | L2-Norm(final)=3.391 | 1638.4 samples/s | 25.6 steps/s
[Step=33400 Epoch=318.9] | Loss=0.00044 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.557 | L2-Norm(final)=3.391 | 3405.7 samples/s | 53.2 steps/s
[Step=33450 Epoch=319.4] | Loss=0.00041 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.556 | L2-Norm(final)=3.391 | 1661.1 samples/s | 26.0 steps/s
[Step=33500 Epoch=319.9] | Loss=0.00038 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.555 | L2-Norm(final)=3.391 | 3384.0 samples/s | 52.9 steps/s
[Step=33550 Epoch=320.4] | Loss=0.00036 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.554 | L2-Norm(final)=3.391 | 1697.5 samples/s | 26.5 steps/s
[Step=33600 Epoch=320.9] | Loss=0.00034 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.553 | L2-Norm(final)=3.391 | 3365.8 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step33600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=309.1] | Loss=0.08482 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=16.619 | L2-Norm(final)=3.385 | 3614.9 samples/s | 56.5 steps/s
[Step=32850 Epoch=309.5] | Loss=0.00593 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.585 | L2-Norm(final)=3.389 | 3282.0 samples/s | 51.3 steps/s
[Step=32900 Epoch=310.0] | Loss=0.00302 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.577 | L2-Norm(final)=3.390 | 4153.5 samples/s | 64.9 steps/s
[Step=32950 Epoch=310.5] | Loss=0.00203 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.573 | L2-Norm(final)=3.391 | 1544.7 samples/s | 24.1 steps/s
[Step=33000 Epoch=311.0] | Loss=0.00154 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.570 | L2-Norm(final)=3.391 | 3943.6 samples/s | 61.6 steps/s
[Step=33050 Epoch=311.4] | Loss=0.00124 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.567 | L2-Norm(final)=3.391 | 1602.5 samples/s | 25.0 steps/s
[Step=33100 Epoch=311.9] | Loss=0.00104 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.565 | L2-Norm(final)=3.391 | 3803.5 samples/s | 59.4 steps/s
[Step=33150 Epoch=312.4] | Loss=0.00089 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.564 | L2-Norm(final)=3.391 | 1647.0 samples/s | 25.7 steps/s
[Step=33200 Epoch=312.8] | Loss=0.00079 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.562 | L2-Norm(final)=3.391 | 3609.3 samples/s | 56.4 steps/s
[Step=33250 Epoch=313.3] | Loss=0.00070 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.561 | L2-Norm(final)=3.391 | 1653.7 samples/s | 25.8 steps/s
[Step=33300 Epoch=313.8] | Loss=0.00064 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.559 | L2-Norm(final)=3.391 | 3388.2 samples/s | 52.9 steps/s
[Step=33350 Epoch=314.3] | Loss=0.00058 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.558 | L2-Norm(final)=3.391 | 1686.9 samples/s | 26.4 steps/s
[Step=33400 Epoch=314.7] | Loss=0.00053 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.557 | L2-Norm(final)=3.391 | 3416.7 samples/s | 53.4 steps/s
[Step=33450 Epoch=315.2] | Loss=0.00049 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.556 | L2-Norm(final)=3.392 | 1672.1 samples/s | 26.1 steps/s
[Step=33500 Epoch=315.7] | Loss=0.00046 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.555 | L2-Norm(final)=3.392 | 3382.0 samples/s | 52.8 steps/s
[Step=33550 Epoch=316.1] | Loss=0.00043 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.554 | L2-Norm(final)=3.392 | 1713.5 samples/s | 26.8 steps/s
[Step=33600 Epoch=316.6] | Loss=0.00041 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.553 | L2-Norm(final)=3.392 | 3198.3 samples/s | 50.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step33600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=312.6] | Loss=0.06801 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.619 | L2-Norm(final)=3.385 | 3626.8 samples/s | 56.7 steps/s
[Step=32850 Epoch=313.1] | Loss=0.00707 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.582 | L2-Norm(final)=3.388 | 3161.2 samples/s | 49.4 steps/s
[Step=32900 Epoch=313.6] | Loss=0.00358 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.575 | L2-Norm(final)=3.389 | 4298.0 samples/s | 67.2 steps/s
[Step=32950 Epoch=314.0] | Loss=0.00240 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.571 | L2-Norm(final)=3.389 | 1493.9 samples/s | 23.3 steps/s
[Step=33000 Epoch=314.5] | Loss=0.00182 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.568 | L2-Norm(final)=3.389 | 3979.8 samples/s | 62.2 steps/s
[Step=33050 Epoch=315.0] | Loss=0.00146 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.566 | L2-Norm(final)=3.389 | 1509.6 samples/s | 23.6 steps/s
[Step=33100 Epoch=315.5] | Loss=0.00122 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.564 | L2-Norm(final)=3.390 | 3825.1 samples/s | 59.8 steps/s
[Step=33150 Epoch=315.9] | Loss=0.00105 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.562 | L2-Norm(final)=3.390 | 1578.9 samples/s | 24.7 steps/s
[Step=33200 Epoch=316.4] | Loss=0.00093 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.560 | L2-Norm(final)=3.390 | 3736.5 samples/s | 58.4 steps/s
[Step=33250 Epoch=316.9] | Loss=0.00083 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.559 | L2-Norm(final)=3.390 | 1648.1 samples/s | 25.8 steps/s
[Step=33300 Epoch=317.4] | Loss=0.00075 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.558 | L2-Norm(final)=3.390 | 3561.1 samples/s | 55.6 steps/s
[Step=33350 Epoch=317.9] | Loss=0.00068 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.557 | L2-Norm(final)=3.390 | 1647.9 samples/s | 25.7 steps/s
[Step=33400 Epoch=318.3] | Loss=0.00063 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.556 | L2-Norm(final)=3.390 | 3318.9 samples/s | 51.9 steps/s
[Step=33450 Epoch=318.8] | Loss=0.00058 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.555 | L2-Norm(final)=3.390 | 1646.5 samples/s | 25.7 steps/s
[Step=33500 Epoch=319.3] | Loss=0.00054 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.554 | L2-Norm(final)=3.390 | 3547.1 samples/s | 55.4 steps/s
[Step=33550 Epoch=319.8] | Loss=0.00051 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.553 | L2-Norm(final)=3.390 | 1691.1 samples/s | 26.4 steps/s
[Step=33600 Epoch=320.2] | Loss=0.00048 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.552 | L2-Norm(final)=3.390 | 3361.0 samples/s | 52.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23269 | acc=0.8830 | tpr=0.8367 | fpr=0.0166 | 3565.0 samples/s | 13.9 steps/s
Avg test loss: 0.23501, Avg test acc: 0.88212, Avg tpr: 0.83564, Avg fpr: 0.01564, total FA: 122

Testing server on iccad2012
[Step=  50] | Loss=0.42714 | acc=0.8767 | tpr=0.9602 | fpr=0.1248 | 3686.2 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.43542 | acc=0.8749 | tpr=0.9616 | fpr=0.1267 | 7099.8 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.44100 | acc=0.8742 | tpr=0.9640 | fpr=0.1274 | 6878.5 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.44175 | acc=0.8754 | tpr=0.9639 | fpr=0.1262 | 7038.1 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.44052 | acc=0.8755 | tpr=0.9659 | fpr=0.1262 | 7125.0 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.43938 | acc=0.8762 | tpr=0.9622 | fpr=0.1254 | 6993.9 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.44178 | acc=0.8764 | tpr=0.9606 | fpr=0.1251 | 7131.7 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.44266 | acc=0.8765 | tpr=0.9573 | fpr=0.1250 | 6506.8 samples/s | 25.4 steps/s
[Step= 450] | Loss=0.44690 | acc=0.8758 | tpr=0.9576 | fpr=0.1257 | 5343.6 samples/s | 20.9 steps/s
[Step= 500] | Loss=0.44753 | acc=0.8758 | tpr=0.9595 | fpr=0.1258 | 5110.3 samples/s | 20.0 steps/s
[Step= 550] | Loss=0.44670 | acc=0.8760 | tpr=0.9614 | fpr=0.1256 | 12108.8 samples/s | 47.3 steps/s
Avg test loss: 0.44650, Avg test acc: 0.87599, Avg tpr: 0.96157, Avg fpr: 0.12556, total FA: 17434

server round 42/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=163.8] | Loss=0.13279 | Reg=0.00274 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=16.559 | L2-Norm(final)=3.399 | 3757.1 samples/s | 58.7 steps/s
[Step=33650 Epoch=164.1] | Loss=0.02082 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.548 | L2-Norm(final)=3.398 | 3295.4 samples/s | 51.5 steps/s
[Step=33700 Epoch=164.3] | Loss=0.01371 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.543 | L2-Norm(final)=3.398 | 3547.3 samples/s | 55.4 steps/s
[Step=33750 Epoch=164.6] | Loss=0.01072 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.540 | L2-Norm(final)=3.398 | 3472.2 samples/s | 54.3 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00936 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.538 | L2-Norm(final)=3.399 | 4349.8 samples/s | 68.0 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00806 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.537 | L2-Norm(final)=3.399 | 1561.4 samples/s | 24.4 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00726 | Reg=0.00273 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.535 | L2-Norm(final)=3.400 | 3482.8 samples/s | 54.4 steps/s
[Step=33950 Epoch=165.5] | Loss=0.00684 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.534 | L2-Norm(final)=3.401 | 3520.3 samples/s | 55.0 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00644 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.534 | L2-Norm(final)=3.401 | 4146.7 samples/s | 64.8 steps/s
[Step=34050 Epoch=166.0] | Loss=0.00607 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.533 | L2-Norm(final)=3.402 | 1609.8 samples/s | 25.2 steps/s
[Step=34100 Epoch=166.3] | Loss=0.00576 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.532 | L2-Norm(final)=3.403 | 3539.9 samples/s | 55.3 steps/s
[Step=34150 Epoch=166.5] | Loss=0.00556 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.532 | L2-Norm(final)=3.404 | 3581.3 samples/s | 56.0 steps/s
[Step=34200 Epoch=166.8] | Loss=0.00533 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.531 | L2-Norm(final)=3.405 | 3972.3 samples/s | 62.1 steps/s
[Step=34250 Epoch=167.0] | Loss=0.00504 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.531 | L2-Norm(final)=3.405 | 1641.4 samples/s | 25.6 steps/s
[Step=34300 Epoch=167.3] | Loss=0.00487 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.530 | L2-Norm(final)=3.406 | 3558.8 samples/s | 55.6 steps/s
[Step=34350 Epoch=167.5] | Loss=0.00473 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.530 | L2-Norm(final)=3.407 | 3470.6 samples/s | 54.2 steps/s
[Step=34400 Epoch=167.7] | Loss=0.00465 | Reg=0.00273 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.530 | L2-Norm(final)=3.408 | 3739.6 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step34400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=164.0] | Loss=0.22931 | Reg=0.00274 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=16.559 | L2-Norm(final)=3.399 | 3616.9 samples/s | 56.5 steps/s
[Step=33650 Epoch=164.2] | Loss=0.01790 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.546 | L2-Norm(final)=3.398 | 3457.2 samples/s | 54.0 steps/s
[Step=33700 Epoch=164.4] | Loss=0.01244 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.541 | L2-Norm(final)=3.398 | 3465.2 samples/s | 54.1 steps/s
[Step=33750 Epoch=164.7] | Loss=0.00987 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.539 | L2-Norm(final)=3.399 | 3526.1 samples/s | 55.1 steps/s
[Step=33800 Epoch=164.9] | Loss=0.00863 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.537 | L2-Norm(final)=3.399 | 4496.5 samples/s | 70.3 steps/s
[Step=33850 Epoch=165.2] | Loss=0.00729 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.535 | L2-Norm(final)=3.400 | 1599.9 samples/s | 25.0 steps/s
[Step=33900 Epoch=165.4] | Loss=0.00665 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.534 | L2-Norm(final)=3.401 | 3635.2 samples/s | 56.8 steps/s
[Step=33950 Epoch=165.7] | Loss=0.00616 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.533 | L2-Norm(final)=3.402 | 3588.6 samples/s | 56.1 steps/s
[Step=34000 Epoch=165.9] | Loss=0.00575 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.532 | L2-Norm(final)=3.402 | 4393.9 samples/s | 68.7 steps/s
[Step=34050 Epoch=166.1] | Loss=0.00531 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.532 | L2-Norm(final)=3.403 | 1601.5 samples/s | 25.0 steps/s
[Step=34100 Epoch=166.4] | Loss=0.00500 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.531 | L2-Norm(final)=3.404 | 3466.6 samples/s | 54.2 steps/s
[Step=34150 Epoch=166.6] | Loss=0.00481 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.530 | L2-Norm(final)=3.405 | 3566.0 samples/s | 55.7 steps/s
[Step=34200 Epoch=166.9] | Loss=0.00464 | Reg=0.00273 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.530 | L2-Norm(final)=3.405 | 4164.1 samples/s | 65.1 steps/s
[Step=34250 Epoch=167.1] | Loss=0.00441 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.529 | L2-Norm(final)=3.406 | 1619.1 samples/s | 25.3 steps/s
[Step=34300 Epoch=167.4] | Loss=0.00432 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.529 | L2-Norm(final)=3.407 | 3593.5 samples/s | 56.1 steps/s
[Step=34350 Epoch=167.6] | Loss=0.00423 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.529 | L2-Norm(final)=3.407 | 3532.7 samples/s | 55.2 steps/s
[Step=34400 Epoch=167.9] | Loss=0.00406 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.528 | L2-Norm(final)=3.408 | 3919.9 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step34400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=163.7] | Loss=0.03450 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.559 | L2-Norm(final)=3.400 | 3749.2 samples/s | 58.6 steps/s
[Step=33650 Epoch=164.0] | Loss=0.01932 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.546 | L2-Norm(final)=3.398 | 3491.5 samples/s | 54.6 steps/s
[Step=33700 Epoch=164.2] | Loss=0.01338 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.541 | L2-Norm(final)=3.398 | 3510.0 samples/s | 54.8 steps/s
[Step=33750 Epoch=164.4] | Loss=0.01038 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.538 | L2-Norm(final)=3.399 | 3521.5 samples/s | 55.0 steps/s
[Step=33800 Epoch=164.7] | Loss=0.00904 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.536 | L2-Norm(final)=3.400 | 4362.5 samples/s | 68.2 steps/s
[Step=33850 Epoch=164.9] | Loss=0.00784 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.535 | L2-Norm(final)=3.401 | 1569.0 samples/s | 24.5 steps/s
[Step=33900 Epoch=165.2] | Loss=0.00703 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.534 | L2-Norm(final)=3.402 | 3503.2 samples/s | 54.7 steps/s
[Step=33950 Epoch=165.4] | Loss=0.00652 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.533 | L2-Norm(final)=3.403 | 3593.5 samples/s | 56.1 steps/s
[Step=34000 Epoch=165.7] | Loss=0.00609 | Reg=0.00273 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.532 | L2-Norm(final)=3.404 | 4207.8 samples/s | 65.7 steps/s
[Step=34050 Epoch=165.9] | Loss=0.00566 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.532 | L2-Norm(final)=3.405 | 1598.5 samples/s | 25.0 steps/s
[Step=34100 Epoch=166.2] | Loss=0.00533 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.531 | L2-Norm(final)=3.406 | 3490.0 samples/s | 54.5 steps/s
[Step=34150 Epoch=166.4] | Loss=0.00511 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.531 | L2-Norm(final)=3.408 | 3654.9 samples/s | 57.1 steps/s
[Step=34200 Epoch=166.6] | Loss=0.00491 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.531 | L2-Norm(final)=3.409 | 3999.4 samples/s | 62.5 steps/s
[Step=34250 Epoch=166.9] | Loss=0.00470 | Reg=0.00273 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.530 | L2-Norm(final)=3.410 | 1653.9 samples/s | 25.8 steps/s
[Step=34300 Epoch=167.1] | Loss=0.00451 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.530 | L2-Norm(final)=3.411 | 3567.2 samples/s | 55.7 steps/s
[Step=34350 Epoch=167.4] | Loss=0.00440 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.530 | L2-Norm(final)=3.412 | 3645.3 samples/s | 57.0 steps/s
[Step=34400 Epoch=167.6] | Loss=0.00427 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.530 | L2-Norm(final)=3.413 | 3969.1 samples/s | 62.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step34400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=163.9] | Loss=0.14369 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=16.559 | L2-Norm(final)=3.399 | 3747.0 samples/s | 58.5 steps/s
[Step=33650 Epoch=164.1] | Loss=0.01714 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.548 | L2-Norm(final)=3.397 | 3473.6 samples/s | 54.3 steps/s
[Step=33700 Epoch=164.3] | Loss=0.01172 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.543 | L2-Norm(final)=3.397 | 3492.0 samples/s | 54.6 steps/s
[Step=33750 Epoch=164.6] | Loss=0.00977 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.541 | L2-Norm(final)=3.398 | 3483.7 samples/s | 54.4 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00800 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.539 | L2-Norm(final)=3.399 | 4409.2 samples/s | 68.9 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00717 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.538 | L2-Norm(final)=3.400 | 1575.4 samples/s | 24.6 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00636 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.537 | L2-Norm(final)=3.401 | 3504.4 samples/s | 54.8 steps/s
[Step=33950 Epoch=165.6] | Loss=0.00575 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.536 | L2-Norm(final)=3.401 | 3599.1 samples/s | 56.2 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00537 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.535 | L2-Norm(final)=3.402 | 4181.7 samples/s | 65.3 steps/s
[Step=34050 Epoch=166.0] | Loss=0.00515 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.535 | L2-Norm(final)=3.403 | 1632.8 samples/s | 25.5 steps/s
[Step=34100 Epoch=166.3] | Loss=0.00485 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.534 | L2-Norm(final)=3.404 | 3594.8 samples/s | 56.2 steps/s
[Step=34150 Epoch=166.5] | Loss=0.00464 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.534 | L2-Norm(final)=3.405 | 3527.5 samples/s | 55.1 steps/s
[Step=34200 Epoch=166.8] | Loss=0.00441 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.533 | L2-Norm(final)=3.406 | 3948.9 samples/s | 61.7 steps/s
[Step=34250 Epoch=167.0] | Loss=0.00426 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.533 | L2-Norm(final)=3.407 | 1637.2 samples/s | 25.6 steps/s
[Step=34300 Epoch=167.3] | Loss=0.00406 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.532 | L2-Norm(final)=3.408 | 3525.7 samples/s | 55.1 steps/s
[Step=34350 Epoch=167.5] | Loss=0.00389 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.532 | L2-Norm(final)=3.409 | 3496.7 samples/s | 54.6 steps/s
[Step=34400 Epoch=167.8] | Loss=0.00381 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.532 | L2-Norm(final)=3.409 | 3779.1 samples/s | 59.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step34400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=164.8] | Loss=0.13023 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.559 | L2-Norm(final)=3.399 | 4077.7 samples/s | 63.7 steps/s
[Step=33650 Epoch=165.0] | Loss=0.02201 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.547 | L2-Norm(final)=3.397 | 3185.3 samples/s | 49.8 steps/s
[Step=33700 Epoch=165.3] | Loss=0.01495 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.542 | L2-Norm(final)=3.396 | 3602.8 samples/s | 56.3 steps/s
[Step=33750 Epoch=165.5] | Loss=0.01195 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.539 | L2-Norm(final)=3.397 | 3609.6 samples/s | 56.4 steps/s
[Step=33800 Epoch=165.7] | Loss=0.01024 | Reg=0.00273 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.538 | L2-Norm(final)=3.397 | 4486.8 samples/s | 70.1 steps/s
[Step=33850 Epoch=166.0] | Loss=0.00878 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.536 | L2-Norm(final)=3.398 | 1566.1 samples/s | 24.5 steps/s
[Step=33900 Epoch=166.2] | Loss=0.00775 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.535 | L2-Norm(final)=3.399 | 3508.0 samples/s | 54.8 steps/s
[Step=33950 Epoch=166.5] | Loss=0.00704 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.534 | L2-Norm(final)=3.400 | 3557.1 samples/s | 55.6 steps/s
[Step=34000 Epoch=166.7] | Loss=0.00652 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.533 | L2-Norm(final)=3.400 | 4299.6 samples/s | 67.2 steps/s
[Step=34050 Epoch=167.0] | Loss=0.00606 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.533 | L2-Norm(final)=3.401 | 1601.4 samples/s | 25.0 steps/s
[Step=34100 Epoch=167.2] | Loss=0.00570 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.532 | L2-Norm(final)=3.402 | 3554.3 samples/s | 55.5 steps/s
[Step=34150 Epoch=167.5] | Loss=0.00535 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.532 | L2-Norm(final)=3.403 | 3467.4 samples/s | 54.2 steps/s
[Step=34200 Epoch=167.7] | Loss=0.00516 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.531 | L2-Norm(final)=3.404 | 4074.3 samples/s | 63.7 steps/s
[Step=34250 Epoch=168.0] | Loss=0.00488 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.531 | L2-Norm(final)=3.405 | 1658.5 samples/s | 25.9 steps/s
[Step=34300 Epoch=168.2] | Loss=0.00477 | Reg=0.00273 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.531 | L2-Norm(final)=3.406 | 3572.6 samples/s | 55.8 steps/s
[Step=34350 Epoch=168.4] | Loss=0.00459 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.530 | L2-Norm(final)=3.407 | 3557.2 samples/s | 55.6 steps/s
[Step=34400 Epoch=168.7] | Loss=0.00443 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.530 | L2-Norm(final)=3.408 | 3957.0 samples/s | 61.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step34400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=318.4] | Loss=0.02759 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.559 | L2-Norm(final)=3.400 | 3477.4 samples/s | 54.3 steps/s
[Step=33650 Epoch=318.9] | Loss=0.00461 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.521 | L2-Norm(final)=3.403 | 3460.4 samples/s | 54.1 steps/s
[Step=33700 Epoch=319.3] | Loss=0.00234 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.513 | L2-Norm(final)=3.404 | 4410.8 samples/s | 68.9 steps/s
[Step=33750 Epoch=319.8] | Loss=0.00157 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.509 | L2-Norm(final)=3.404 | 1559.2 samples/s | 24.4 steps/s
[Step=33800 Epoch=320.3] | Loss=0.00119 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.506 | L2-Norm(final)=3.404 | 4016.5 samples/s | 62.8 steps/s
[Step=33850 Epoch=320.8] | Loss=0.00096 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.504 | L2-Norm(final)=3.404 | 1548.6 samples/s | 24.2 steps/s
[Step=33900 Epoch=321.2] | Loss=0.00080 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.502 | L2-Norm(final)=3.404 | 3813.1 samples/s | 59.6 steps/s
[Step=33950 Epoch=321.7] | Loss=0.00069 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.500 | L2-Norm(final)=3.405 | 1607.8 samples/s | 25.1 steps/s
[Step=34000 Epoch=322.2] | Loss=0.00061 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.498 | L2-Norm(final)=3.405 | 3560.4 samples/s | 55.6 steps/s
[Step=34050 Epoch=322.7] | Loss=0.00054 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.497 | L2-Norm(final)=3.405 | 1642.3 samples/s | 25.7 steps/s
[Step=34100 Epoch=323.1] | Loss=0.00049 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.496 | L2-Norm(final)=3.405 | 3463.0 samples/s | 54.1 steps/s
[Step=34150 Epoch=323.6] | Loss=0.00045 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.495 | L2-Norm(final)=3.405 | 1646.1 samples/s | 25.7 steps/s
[Step=34200 Epoch=324.1] | Loss=0.00041 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.493 | L2-Norm(final)=3.405 | 3363.5 samples/s | 52.6 steps/s
[Step=34250 Epoch=324.5] | Loss=0.00038 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.492 | L2-Norm(final)=3.405 | 1700.0 samples/s | 26.6 steps/s
[Step=34300 Epoch=325.0] | Loss=0.00036 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.492 | L2-Norm(final)=3.405 | 3381.8 samples/s | 52.8 steps/s
[Step=34350 Epoch=325.5] | Loss=0.00033 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.491 | L2-Norm(final)=3.405 | 1685.9 samples/s | 26.3 steps/s
[Step=34400 Epoch=326.0] | Loss=0.00031 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.490 | L2-Norm(final)=3.405 | 3398.0 samples/s | 53.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step34400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=319.6] | Loss=0.04471 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.559 | L2-Norm(final)=3.400 | 3205.7 samples/s | 50.1 steps/s
[Step=33650 Epoch=320.1] | Loss=0.00408 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.522 | L2-Norm(final)=3.404 | 1816.8 samples/s | 28.4 steps/s
[Step=33700 Epoch=320.6] | Loss=0.00208 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.514 | L2-Norm(final)=3.405 | 3913.3 samples/s | 61.1 steps/s
[Step=33750 Epoch=321.0] | Loss=0.00140 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.510 | L2-Norm(final)=3.405 | 1516.7 samples/s | 23.7 steps/s
[Step=33800 Epoch=321.5] | Loss=0.00106 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.507 | L2-Norm(final)=3.405 | 3904.1 samples/s | 61.0 steps/s
[Step=33850 Epoch=322.0] | Loss=0.00085 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.505 | L2-Norm(final)=3.405 | 1565.2 samples/s | 24.5 steps/s
[Step=33900 Epoch=322.5] | Loss=0.00072 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.503 | L2-Norm(final)=3.405 | 3745.2 samples/s | 58.5 steps/s
[Step=33950 Epoch=322.9] | Loss=0.00062 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.501 | L2-Norm(final)=3.406 | 1577.2 samples/s | 24.6 steps/s
[Step=34000 Epoch=323.4] | Loss=0.00054 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.499 | L2-Norm(final)=3.406 | 3532.2 samples/s | 55.2 steps/s
[Step=34050 Epoch=323.9] | Loss=0.00049 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.498 | L2-Norm(final)=3.406 | 1614.2 samples/s | 25.2 steps/s
[Step=34100 Epoch=324.4] | Loss=0.00044 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.497 | L2-Norm(final)=3.406 | 3442.9 samples/s | 53.8 steps/s
[Step=34150 Epoch=324.9] | Loss=0.00040 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.495 | L2-Norm(final)=3.406 | 1710.7 samples/s | 26.7 steps/s
[Step=34200 Epoch=325.3] | Loss=0.00037 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.494 | L2-Norm(final)=3.406 | 3372.9 samples/s | 52.7 steps/s
[Step=34250 Epoch=325.8] | Loss=0.00034 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.493 | L2-Norm(final)=3.406 | 1696.9 samples/s | 26.5 steps/s
[Step=34300 Epoch=326.3] | Loss=0.00032 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.492 | L2-Norm(final)=3.406 | 3472.7 samples/s | 54.3 steps/s
[Step=34350 Epoch=326.8] | Loss=0.00030 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.491 | L2-Norm(final)=3.406 | 1664.7 samples/s | 26.0 steps/s
[Step=34400 Epoch=327.2] | Loss=0.00028 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.491 | L2-Norm(final)=3.406 | 3307.0 samples/s | 51.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step34400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=320.9] | Loss=0.06412 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.559 | L2-Norm(final)=3.400 | 3634.2 samples/s | 56.8 steps/s
[Step=33650 Epoch=321.3] | Loss=0.00485 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.522 | L2-Norm(final)=3.403 | 3137.5 samples/s | 49.0 steps/s
[Step=33700 Epoch=321.8] | Loss=0.00245 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.515 | L2-Norm(final)=3.403 | 4176.0 samples/s | 65.3 steps/s
[Step=33750 Epoch=322.3] | Loss=0.00164 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.511 | L2-Norm(final)=3.404 | 1510.4 samples/s | 23.6 steps/s
[Step=33800 Epoch=322.8] | Loss=0.00124 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.508 | L2-Norm(final)=3.404 | 4006.6 samples/s | 62.6 steps/s
[Step=33850 Epoch=323.2] | Loss=0.00100 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.505 | L2-Norm(final)=3.404 | 1549.0 samples/s | 24.2 steps/s
[Step=33900 Epoch=323.7] | Loss=0.00084 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.503 | L2-Norm(final)=3.404 | 3864.0 samples/s | 60.4 steps/s
[Step=33950 Epoch=324.2] | Loss=0.00072 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.502 | L2-Norm(final)=3.404 | 1589.7 samples/s | 24.8 steps/s
[Step=34000 Epoch=324.7] | Loss=0.00063 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.500 | L2-Norm(final)=3.404 | 3716.3 samples/s | 58.1 steps/s
[Step=34050 Epoch=325.2] | Loss=0.00056 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.499 | L2-Norm(final)=3.404 | 1627.5 samples/s | 25.4 steps/s
[Step=34100 Epoch=325.6] | Loss=0.00051 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.497 | L2-Norm(final)=3.404 | 3674.0 samples/s | 57.4 steps/s
[Step=34150 Epoch=326.1] | Loss=0.00047 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.496 | L2-Norm(final)=3.404 | 1640.7 samples/s | 25.6 steps/s
[Step=34200 Epoch=326.6] | Loss=0.00043 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.495 | L2-Norm(final)=3.404 | 3450.8 samples/s | 53.9 steps/s
[Step=34250 Epoch=327.1] | Loss=0.00040 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.494 | L2-Norm(final)=3.404 | 1653.9 samples/s | 25.8 steps/s
[Step=34300 Epoch=327.5] | Loss=0.00037 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.493 | L2-Norm(final)=3.404 | 3341.1 samples/s | 52.2 steps/s
[Step=34350 Epoch=328.0] | Loss=0.00035 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.492 | L2-Norm(final)=3.404 | 1684.5 samples/s | 26.3 steps/s
[Step=34400 Epoch=328.5] | Loss=0.00033 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.491 | L2-Norm(final)=3.404 | 3375.0 samples/s | 52.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step34400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=316.6] | Loss=0.01230 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.559 | L2-Norm(final)=3.400 | 3579.3 samples/s | 55.9 steps/s
[Step=33650 Epoch=317.1] | Loss=0.00458 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.522 | L2-Norm(final)=3.404 | 3268.0 samples/s | 51.1 steps/s
[Step=33700 Epoch=317.6] | Loss=0.00233 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.514 | L2-Norm(final)=3.405 | 4250.7 samples/s | 66.4 steps/s
[Step=33750 Epoch=318.0] | Loss=0.00156 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.510 | L2-Norm(final)=3.405 | 1528.2 samples/s | 23.9 steps/s
[Step=33800 Epoch=318.5] | Loss=0.00118 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.507 | L2-Norm(final)=3.405 | 3889.0 samples/s | 60.8 steps/s
[Step=33850 Epoch=319.0] | Loss=0.00095 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.505 | L2-Norm(final)=3.405 | 1585.9 samples/s | 24.8 steps/s
[Step=33900 Epoch=319.4] | Loss=0.00080 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.503 | L2-Norm(final)=3.405 | 3772.0 samples/s | 58.9 steps/s
[Step=33950 Epoch=319.9] | Loss=0.00069 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.501 | L2-Norm(final)=3.405 | 1636.5 samples/s | 25.6 steps/s
[Step=34000 Epoch=320.4] | Loss=0.00061 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.500 | L2-Norm(final)=3.405 | 3442.9 samples/s | 53.8 steps/s
[Step=34050 Epoch=320.8] | Loss=0.00054 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.498 | L2-Norm(final)=3.405 | 1659.2 samples/s | 25.9 steps/s
[Step=34100 Epoch=321.3] | Loss=0.00049 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.497 | L2-Norm(final)=3.406 | 3355.5 samples/s | 52.4 steps/s
[Step=34150 Epoch=321.8] | Loss=0.00045 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.496 | L2-Norm(final)=3.406 | 1709.9 samples/s | 26.7 steps/s
[Step=34200 Epoch=322.3] | Loss=0.00041 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.495 | L2-Norm(final)=3.406 | 3409.2 samples/s | 53.3 steps/s
[Step=34250 Epoch=322.7] | Loss=0.00038 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.494 | L2-Norm(final)=3.406 | 1685.9 samples/s | 26.3 steps/s
[Step=34300 Epoch=323.2] | Loss=0.00036 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.493 | L2-Norm(final)=3.406 | 3320.9 samples/s | 51.9 steps/s
[Step=34350 Epoch=323.7] | Loss=0.00033 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.492 | L2-Norm(final)=3.406 | 1848.3 samples/s | 28.9 steps/s
[Step=34400 Epoch=324.1] | Loss=0.00031 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.491 | L2-Norm(final)=3.406 | 3105.1 samples/s | 48.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step34400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=320.2] | Loss=0.03614 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.559 | L2-Norm(final)=3.400 | 3597.6 samples/s | 56.2 steps/s
[Step=33650 Epoch=320.7] | Loss=0.00708 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.524 | L2-Norm(final)=3.402 | 3176.0 samples/s | 49.6 steps/s
[Step=33700 Epoch=321.2] | Loss=0.00379 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.517 | L2-Norm(final)=3.403 | 4208.0 samples/s | 65.8 steps/s
[Step=33750 Epoch=321.7] | Loss=0.00256 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.513 | L2-Norm(final)=3.403 | 1537.8 samples/s | 24.0 steps/s
[Step=33800 Epoch=322.1] | Loss=0.00194 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.510 | L2-Norm(final)=3.404 | 4020.0 samples/s | 62.8 steps/s
[Step=33850 Epoch=322.6] | Loss=0.00156 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.507 | L2-Norm(final)=3.404 | 1538.2 samples/s | 24.0 steps/s
[Step=33900 Epoch=323.1] | Loss=0.00130 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.505 | L2-Norm(final)=3.404 | 3874.4 samples/s | 60.5 steps/s
[Step=33950 Epoch=323.6] | Loss=0.00112 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.504 | L2-Norm(final)=3.404 | 1563.7 samples/s | 24.4 steps/s
[Step=34000 Epoch=324.1] | Loss=0.00099 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.502 | L2-Norm(final)=3.405 | 3635.0 samples/s | 56.8 steps/s
[Step=34050 Epoch=324.5] | Loss=0.00088 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.501 | L2-Norm(final)=3.405 | 1654.2 samples/s | 25.8 steps/s
[Step=34100 Epoch=325.0] | Loss=0.00079 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.500 | L2-Norm(final)=3.405 | 3473.7 samples/s | 54.3 steps/s
[Step=34150 Epoch=325.5] | Loss=0.00072 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.499 | L2-Norm(final)=3.405 | 1625.7 samples/s | 25.4 steps/s
[Step=34200 Epoch=326.0] | Loss=0.00067 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.498 | L2-Norm(final)=3.405 | 3367.0 samples/s | 52.6 steps/s
[Step=34250 Epoch=326.4] | Loss=0.00062 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.497 | L2-Norm(final)=3.405 | 1666.9 samples/s | 26.0 steps/s
[Step=34300 Epoch=326.9] | Loss=0.00057 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.496 | L2-Norm(final)=3.405 | 3458.5 samples/s | 54.0 steps/s
[Step=34350 Epoch=327.4] | Loss=0.00054 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.495 | L2-Norm(final)=3.405 | 1670.9 samples/s | 26.1 steps/s
[Step=34400 Epoch=327.9] | Loss=0.00051 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.494 | L2-Norm(final)=3.405 | 3343.8 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23371 | acc=0.8841 | tpr=0.8377 | fpr=0.0154 | 3706.1 samples/s | 14.5 steps/s
Avg test loss: 0.23595, Avg test acc: 0.88304, Avg tpr: 0.83674, Avg fpr: 0.01513, total FA: 118

Testing server on iccad2012
[Step=  50] | Loss=0.42952 | acc=0.8790 | tpr=0.9602 | fpr=0.1225 | 3679.9 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.43821 | acc=0.8766 | tpr=0.9616 | fpr=0.1249 | 6924.7 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.44382 | acc=0.8759 | tpr=0.9640 | fpr=0.1257 | 6799.4 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.44480 | acc=0.8769 | tpr=0.9639 | fpr=0.1247 | 6814.7 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.44357 | acc=0.8769 | tpr=0.9659 | fpr=0.1247 | 6866.4 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.44252 | acc=0.8776 | tpr=0.9622 | fpr=0.1240 | 7348.6 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.44506 | acc=0.8778 | tpr=0.9606 | fpr=0.1237 | 6432.2 samples/s | 25.1 steps/s
[Step= 400] | Loss=0.44598 | acc=0.8779 | tpr=0.9579 | fpr=0.1236 | 6855.5 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.45015 | acc=0.8771 | tpr=0.9581 | fpr=0.1243 | 6638.7 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.45079 | acc=0.8771 | tpr=0.9599 | fpr=0.1244 | 6896.2 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.44997 | acc=0.8772 | tpr=0.9618 | fpr=0.1243 | 12913.2 samples/s | 50.4 steps/s
Avg test loss: 0.44975, Avg test acc: 0.87722, Avg tpr: 0.96197, Avg fpr: 0.12432, total FA: 17261

server round 43/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.7] | Loss=0.09332 | Reg=0.00272 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.499 | L2-Norm(final)=3.413 | 3519.2 samples/s | 55.0 steps/s
[Step=34450 Epoch=168.0] | Loss=0.01880 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.485 | L2-Norm(final)=3.412 | 3503.4 samples/s | 54.7 steps/s
[Step=34500 Epoch=168.2] | Loss=0.01339 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.481 | L2-Norm(final)=3.411 | 3664.9 samples/s | 57.3 steps/s
[Step=34550 Epoch=168.5] | Loss=0.01087 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.478 | L2-Norm(final)=3.411 | 3748.6 samples/s | 58.6 steps/s
[Step=34600 Epoch=168.7] | Loss=0.00928 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.476 | L2-Norm(final)=3.412 | 4450.9 samples/s | 69.5 steps/s
[Step=34650 Epoch=169.0] | Loss=0.00810 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.475 | L2-Norm(final)=3.413 | 1580.6 samples/s | 24.7 steps/s
[Step=34700 Epoch=169.2] | Loss=0.00735 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.474 | L2-Norm(final)=3.414 | 3517.2 samples/s | 55.0 steps/s
[Step=34750 Epoch=169.4] | Loss=0.00677 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.473 | L2-Norm(final)=3.415 | 3475.3 samples/s | 54.3 steps/s
[Step=34800 Epoch=169.7] | Loss=0.00632 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.472 | L2-Norm(final)=3.415 | 4059.5 samples/s | 63.4 steps/s
[Step=34850 Epoch=169.9] | Loss=0.00587 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.472 | L2-Norm(final)=3.416 | 1608.0 samples/s | 25.1 steps/s
[Step=34900 Epoch=170.2] | Loss=0.00560 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.471 | L2-Norm(final)=3.417 | 3526.9 samples/s | 55.1 steps/s
[Step=34950 Epoch=170.4] | Loss=0.00540 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.471 | L2-Norm(final)=3.418 | 3514.9 samples/s | 54.9 steps/s
[Step=35000 Epoch=170.7] | Loss=0.00516 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.470 | L2-Norm(final)=3.419 | 4073.1 samples/s | 63.6 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00495 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.470 | L2-Norm(final)=3.420 | 1624.4 samples/s | 25.4 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00484 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.470 | L2-Norm(final)=3.420 | 3565.5 samples/s | 55.7 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00471 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.469 | L2-Norm(final)=3.421 | 3524.3 samples/s | 55.1 steps/s
[Step=35200 Epoch=171.6] | Loss=0.00459 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.469 | L2-Norm(final)=3.422 | 3707.2 samples/s | 57.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step35200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.9] | Loss=0.06843 | Reg=0.00272 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.499 | L2-Norm(final)=3.414 | 3758.6 samples/s | 58.7 steps/s
[Step=34450 Epoch=168.1] | Loss=0.01829 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.488 | L2-Norm(final)=3.411 | 3418.0 samples/s | 53.4 steps/s
[Step=34500 Epoch=168.3] | Loss=0.01223 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.483 | L2-Norm(final)=3.411 | 3673.8 samples/s | 57.4 steps/s
[Step=34550 Epoch=168.6] | Loss=0.00984 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.480 | L2-Norm(final)=3.412 | 3533.5 samples/s | 55.2 steps/s
[Step=34600 Epoch=168.8] | Loss=0.00868 | Reg=0.00272 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.478 | L2-Norm(final)=3.412 | 4514.1 samples/s | 70.5 steps/s
[Step=34650 Epoch=169.1] | Loss=0.00734 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.476 | L2-Norm(final)=3.413 | 1565.0 samples/s | 24.5 steps/s
[Step=34700 Epoch=169.3] | Loss=0.00660 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.475 | L2-Norm(final)=3.414 | 3560.3 samples/s | 55.6 steps/s
[Step=34750 Epoch=169.6] | Loss=0.00615 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.475 | L2-Norm(final)=3.415 | 3511.9 samples/s | 54.9 steps/s
[Step=34800 Epoch=169.8] | Loss=0.00574 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.474 | L2-Norm(final)=3.415 | 4106.8 samples/s | 64.2 steps/s
[Step=34850 Epoch=170.1] | Loss=0.00525 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.473 | L2-Norm(final)=3.416 | 1584.0 samples/s | 24.8 steps/s
[Step=34900 Epoch=170.3] | Loss=0.00501 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.472 | L2-Norm(final)=3.417 | 3608.0 samples/s | 56.4 steps/s
[Step=34950 Epoch=170.5] | Loss=0.00482 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.472 | L2-Norm(final)=3.418 | 3520.0 samples/s | 55.0 steps/s
[Step=35000 Epoch=170.8] | Loss=0.00462 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.471 | L2-Norm(final)=3.418 | 4027.5 samples/s | 62.9 steps/s
[Step=35050 Epoch=171.0] | Loss=0.00448 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.471 | L2-Norm(final)=3.419 | 1630.5 samples/s | 25.5 steps/s
[Step=35100 Epoch=171.3] | Loss=0.00432 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.470 | L2-Norm(final)=3.420 | 3557.0 samples/s | 55.6 steps/s
[Step=35150 Epoch=171.5] | Loss=0.00418 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.470 | L2-Norm(final)=3.420 | 3507.4 samples/s | 54.8 steps/s
[Step=35200 Epoch=171.8] | Loss=0.00407 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.470 | L2-Norm(final)=3.421 | 3787.5 samples/s | 59.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step35200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.6] | Loss=0.09742 | Reg=0.00272 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.499 | L2-Norm(final)=3.413 | 3497.2 samples/s | 54.6 steps/s
[Step=34450 Epoch=167.9] | Loss=0.01830 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.485 | L2-Norm(final)=3.411 | 3659.4 samples/s | 57.2 steps/s
[Step=34500 Epoch=168.1] | Loss=0.01276 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.480 | L2-Norm(final)=3.411 | 3752.6 samples/s | 58.6 steps/s
[Step=34550 Epoch=168.3] | Loss=0.01082 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.477 | L2-Norm(final)=3.411 | 3677.9 samples/s | 57.5 steps/s
[Step=34600 Epoch=168.6] | Loss=0.00966 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.475 | L2-Norm(final)=3.412 | 4367.6 samples/s | 68.2 steps/s
[Step=34650 Epoch=168.8] | Loss=0.00825 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.474 | L2-Norm(final)=3.413 | 1601.4 samples/s | 25.0 steps/s
[Step=34700 Epoch=169.1] | Loss=0.00742 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.473 | L2-Norm(final)=3.413 | 3589.2 samples/s | 56.1 steps/s
[Step=34750 Epoch=169.3] | Loss=0.00685 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.472 | L2-Norm(final)=3.414 | 3483.7 samples/s | 54.4 steps/s
[Step=34800 Epoch=169.6] | Loss=0.00641 | Reg=0.00271 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.472 | L2-Norm(final)=3.415 | 4096.3 samples/s | 64.0 steps/s
[Step=34850 Epoch=169.8] | Loss=0.00589 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.471 | L2-Norm(final)=3.416 | 1627.8 samples/s | 25.4 steps/s
[Step=34900 Epoch=170.0] | Loss=0.00549 | Reg=0.00271 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.471 | L2-Norm(final)=3.417 | 3501.0 samples/s | 54.7 steps/s
[Step=34950 Epoch=170.3] | Loss=0.00520 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.470 | L2-Norm(final)=3.418 | 3555.5 samples/s | 55.6 steps/s
[Step=35000 Epoch=170.5] | Loss=0.00506 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.470 | L2-Norm(final)=3.419 | 3969.3 samples/s | 62.0 steps/s
[Step=35050 Epoch=170.8] | Loss=0.00483 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.470 | L2-Norm(final)=3.420 | 1630.2 samples/s | 25.5 steps/s
[Step=35100 Epoch=171.0] | Loss=0.00462 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.470 | L2-Norm(final)=3.421 | 3533.0 samples/s | 55.2 steps/s
[Step=35150 Epoch=171.3] | Loss=0.00444 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.469 | L2-Norm(final)=3.422 | 3454.5 samples/s | 54.0 steps/s
[Step=35200 Epoch=171.5] | Loss=0.00431 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.469 | L2-Norm(final)=3.423 | 3711.4 samples/s | 58.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step35200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.8] | Loss=0.10414 | Reg=0.00272 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=16.499 | L2-Norm(final)=3.413 | 3881.2 samples/s | 60.6 steps/s
[Step=34450 Epoch=168.0] | Loss=0.01957 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.488 | L2-Norm(final)=3.411 | 3458.5 samples/s | 54.0 steps/s
[Step=34500 Epoch=168.2] | Loss=0.01219 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.484 | L2-Norm(final)=3.411 | 3619.8 samples/s | 56.6 steps/s
[Step=34550 Epoch=168.5] | Loss=0.00964 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.482 | L2-Norm(final)=3.412 | 3505.4 samples/s | 54.8 steps/s
[Step=34600 Epoch=168.7] | Loss=0.00826 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.480 | L2-Norm(final)=3.412 | 4308.9 samples/s | 67.3 steps/s
[Step=34650 Epoch=169.0] | Loss=0.00725 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.479 | L2-Norm(final)=3.413 | 1574.2 samples/s | 24.6 steps/s
[Step=34700 Epoch=169.2] | Loss=0.00638 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.477 | L2-Norm(final)=3.414 | 3502.7 samples/s | 54.7 steps/s
[Step=34750 Epoch=169.5] | Loss=0.00588 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.476 | L2-Norm(final)=3.415 | 3487.4 samples/s | 54.5 steps/s
[Step=34800 Epoch=169.7] | Loss=0.00555 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.476 | L2-Norm(final)=3.416 | 4049.3 samples/s | 63.3 steps/s
[Step=34850 Epoch=169.9] | Loss=0.00520 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.475 | L2-Norm(final)=3.417 | 1569.6 samples/s | 24.5 steps/s
[Step=34900 Epoch=170.2] | Loss=0.00492 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.474 | L2-Norm(final)=3.418 | 3553.2 samples/s | 55.5 steps/s
[Step=34950 Epoch=170.4] | Loss=0.00469 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.474 | L2-Norm(final)=3.418 | 3545.6 samples/s | 55.4 steps/s
[Step=35000 Epoch=170.7] | Loss=0.00449 | Reg=0.00271 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.474 | L2-Norm(final)=3.419 | 4043.6 samples/s | 63.2 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00423 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.473 | L2-Norm(final)=3.420 | 1611.0 samples/s | 25.2 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00411 | Reg=0.00271 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.473 | L2-Norm(final)=3.421 | 3473.1 samples/s | 54.3 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00398 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.472 | L2-Norm(final)=3.422 | 3508.4 samples/s | 54.8 steps/s
[Step=35200 Epoch=171.7] | Loss=0.00389 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.472 | L2-Norm(final)=3.423 | 3787.0 samples/s | 59.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step35200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=168.7] | Loss=0.15027 | Reg=0.00272 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=16.499 | L2-Norm(final)=3.413 | 3671.6 samples/s | 57.4 steps/s
[Step=34450 Epoch=168.9] | Loss=0.02295 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.486 | L2-Norm(final)=3.411 | 3351.8 samples/s | 52.4 steps/s
[Step=34500 Epoch=169.2] | Loss=0.01517 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.481 | L2-Norm(final)=3.411 | 3510.1 samples/s | 54.8 steps/s
[Step=34550 Epoch=169.4] | Loss=0.01218 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.479 | L2-Norm(final)=3.411 | 3500.6 samples/s | 54.7 steps/s
[Step=34600 Epoch=169.7] | Loss=0.01007 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.477 | L2-Norm(final)=3.412 | 4460.5 samples/s | 69.7 steps/s
[Step=34650 Epoch=169.9] | Loss=0.00871 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.476 | L2-Norm(final)=3.412 | 1563.0 samples/s | 24.4 steps/s
[Step=34700 Epoch=170.2] | Loss=0.00781 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.475 | L2-Norm(final)=3.413 | 3523.9 samples/s | 55.1 steps/s
[Step=34750 Epoch=170.4] | Loss=0.00698 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.474 | L2-Norm(final)=3.414 | 3529.6 samples/s | 55.1 steps/s
[Step=34800 Epoch=170.7] | Loss=0.00650 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.473 | L2-Norm(final)=3.415 | 4266.7 samples/s | 66.7 steps/s
[Step=34850 Epoch=170.9] | Loss=0.00596 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.473 | L2-Norm(final)=3.416 | 1586.7 samples/s | 24.8 steps/s
[Step=34900 Epoch=171.1] | Loss=0.00560 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.472 | L2-Norm(final)=3.417 | 3489.9 samples/s | 54.5 steps/s
[Step=34950 Epoch=171.4] | Loss=0.00537 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.472 | L2-Norm(final)=3.418 | 3470.6 samples/s | 54.2 steps/s
[Step=35000 Epoch=171.6] | Loss=0.00513 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.471 | L2-Norm(final)=3.418 | 4068.2 samples/s | 63.6 steps/s
[Step=35050 Epoch=171.9] | Loss=0.00486 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.471 | L2-Norm(final)=3.419 | 1641.5 samples/s | 25.6 steps/s
[Step=35100 Epoch=172.1] | Loss=0.00468 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.471 | L2-Norm(final)=3.420 | 3578.6 samples/s | 55.9 steps/s
[Step=35150 Epoch=172.4] | Loss=0.00451 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.470 | L2-Norm(final)=3.421 | 3614.5 samples/s | 56.5 steps/s
[Step=35200 Epoch=172.6] | Loss=0.00437 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.470 | L2-Norm(final)=3.422 | 4121.0 samples/s | 64.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step35200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=326.0] | Loss=0.08333 | Reg=0.00272 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.499 | L2-Norm(final)=3.414 | 3829.1 samples/s | 59.8 steps/s
[Step=34450 Epoch=326.4] | Loss=0.00702 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.461 | L2-Norm(final)=3.415 | 3109.2 samples/s | 48.6 steps/s
[Step=34500 Epoch=326.9] | Loss=0.00353 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.454 | L2-Norm(final)=3.415 | 4314.5 samples/s | 67.4 steps/s
[Step=34550 Epoch=327.4] | Loss=0.00236 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.450 | L2-Norm(final)=3.415 | 1577.6 samples/s | 24.7 steps/s
[Step=34600 Epoch=327.9] | Loss=0.00178 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.447 | L2-Norm(final)=3.415 | 4004.4 samples/s | 62.6 steps/s
[Step=34650 Epoch=328.3] | Loss=0.00143 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.444 | L2-Norm(final)=3.415 | 1540.1 samples/s | 24.1 steps/s
[Step=34700 Epoch=328.8] | Loss=0.00120 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.442 | L2-Norm(final)=3.415 | 3774.0 samples/s | 59.0 steps/s
[Step=34750 Epoch=329.3] | Loss=0.00103 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.440 | L2-Norm(final)=3.416 | 1593.5 samples/s | 24.9 steps/s
[Step=34800 Epoch=329.8] | Loss=0.00090 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.439 | L2-Norm(final)=3.416 | 3592.8 samples/s | 56.1 steps/s
[Step=34850 Epoch=330.2] | Loss=0.00080 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.438 | L2-Norm(final)=3.416 | 1640.7 samples/s | 25.6 steps/s
[Step=34900 Epoch=330.7] | Loss=0.00073 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.436 | L2-Norm(final)=3.416 | 3459.5 samples/s | 54.1 steps/s
[Step=34950 Epoch=331.2] | Loss=0.00066 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.435 | L2-Norm(final)=3.416 | 1660.7 samples/s | 25.9 steps/s
[Step=35000 Epoch=331.7] | Loss=0.00061 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.434 | L2-Norm(final)=3.416 | 3339.2 samples/s | 52.2 steps/s
[Step=35050 Epoch=332.1] | Loss=0.00056 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.433 | L2-Norm(final)=3.416 | 1689.7 samples/s | 26.4 steps/s
[Step=35100 Epoch=332.6] | Loss=0.00052 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.432 | L2-Norm(final)=3.416 | 3455.4 samples/s | 54.0 steps/s
[Step=35150 Epoch=333.1] | Loss=0.00049 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.431 | L2-Norm(final)=3.416 | 1676.6 samples/s | 26.2 steps/s
[Step=35200 Epoch=333.6] | Loss=0.00046 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.431 | L2-Norm(final)=3.416 | 3371.5 samples/s | 52.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step35200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=327.2] | Loss=0.09870 | Reg=0.00272 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.499 | L2-Norm(final)=3.414 | 3373.1 samples/s | 52.7 steps/s
[Step=34450 Epoch=327.7] | Loss=0.00481 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.461 | L2-Norm(final)=3.416 | 3224.3 samples/s | 50.4 steps/s
[Step=34500 Epoch=328.2] | Loss=0.00244 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.454 | L2-Norm(final)=3.417 | 4116.5 samples/s | 64.3 steps/s
[Step=34550 Epoch=328.7] | Loss=0.00164 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.450 | L2-Norm(final)=3.418 | 1526.2 samples/s | 23.8 steps/s
[Step=34600 Epoch=329.1] | Loss=0.00124 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.447 | L2-Norm(final)=3.418 | 4002.7 samples/s | 62.5 steps/s
[Step=34650 Epoch=329.6] | Loss=0.00100 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.444 | L2-Norm(final)=3.418 | 1556.7 samples/s | 24.3 steps/s
[Step=34700 Epoch=330.1] | Loss=0.00084 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.442 | L2-Norm(final)=3.418 | 3785.4 samples/s | 59.1 steps/s
[Step=34750 Epoch=330.6] | Loss=0.00072 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.441 | L2-Norm(final)=3.418 | 1596.2 samples/s | 24.9 steps/s
[Step=34800 Epoch=331.0] | Loss=0.00063 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.439 | L2-Norm(final)=3.418 | 3688.1 samples/s | 57.6 steps/s
[Step=34850 Epoch=331.5] | Loss=0.00057 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.438 | L2-Norm(final)=3.418 | 1625.0 samples/s | 25.4 steps/s
[Step=34900 Epoch=332.0] | Loss=0.00051 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.437 | L2-Norm(final)=3.418 | 3406.3 samples/s | 53.2 steps/s
[Step=34950 Epoch=332.5] | Loss=0.00047 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.435 | L2-Norm(final)=3.418 | 1712.9 samples/s | 26.8 steps/s
[Step=35000 Epoch=332.9] | Loss=0.00043 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.434 | L2-Norm(final)=3.419 | 3362.9 samples/s | 52.5 steps/s
[Step=35050 Epoch=333.4] | Loss=0.00040 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.433 | L2-Norm(final)=3.419 | 1713.1 samples/s | 26.8 steps/s
[Step=35100 Epoch=333.9] | Loss=0.00037 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.432 | L2-Norm(final)=3.419 | 3399.9 samples/s | 53.1 steps/s
[Step=35150 Epoch=334.4] | Loss=0.00035 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.432 | L2-Norm(final)=3.419 | 1696.5 samples/s | 26.5 steps/s
[Step=35200 Epoch=334.8] | Loss=0.00033 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.431 | L2-Norm(final)=3.419 | 3384.5 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step35200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=328.5] | Loss=0.02867 | Reg=0.00272 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.499 | L2-Norm(final)=3.414 | 3593.0 samples/s | 56.1 steps/s
[Step=34450 Epoch=329.0] | Loss=0.00376 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.462 | L2-Norm(final)=3.417 | 3197.4 samples/s | 50.0 steps/s
[Step=34500 Epoch=329.5] | Loss=0.00192 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.455 | L2-Norm(final)=3.418 | 4320.4 samples/s | 67.5 steps/s
[Step=34550 Epoch=329.9] | Loss=0.00129 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.451 | L2-Norm(final)=3.418 | 1527.7 samples/s | 23.9 steps/s
[Step=34600 Epoch=330.4] | Loss=0.00098 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.448 | L2-Norm(final)=3.418 | 4043.9 samples/s | 63.2 steps/s
[Step=34650 Epoch=330.9] | Loss=0.00079 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.446 | L2-Norm(final)=3.419 | 1531.1 samples/s | 23.9 steps/s
[Step=34700 Epoch=331.4] | Loss=0.00066 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.444 | L2-Norm(final)=3.419 | 3851.1 samples/s | 60.2 steps/s
[Step=34750 Epoch=331.8] | Loss=0.00057 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.442 | L2-Norm(final)=3.419 | 1553.8 samples/s | 24.3 steps/s
[Step=34800 Epoch=332.3] | Loss=0.00050 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.441 | L2-Norm(final)=3.419 | 3686.9 samples/s | 57.6 steps/s
[Step=34850 Epoch=332.8] | Loss=0.00045 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.440 | L2-Norm(final)=3.419 | 1627.9 samples/s | 25.4 steps/s
[Step=34900 Epoch=333.3] | Loss=0.00041 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.438 | L2-Norm(final)=3.419 | 3552.6 samples/s | 55.5 steps/s
[Step=34950 Epoch=333.8] | Loss=0.00037 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.437 | L2-Norm(final)=3.419 | 1622.7 samples/s | 25.4 steps/s
[Step=35000 Epoch=334.2] | Loss=0.00034 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.436 | L2-Norm(final)=3.419 | 3425.2 samples/s | 53.5 steps/s
[Step=35050 Epoch=334.7] | Loss=0.00032 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.435 | L2-Norm(final)=3.419 | 1663.5 samples/s | 26.0 steps/s
[Step=35100 Epoch=335.2] | Loss=0.00029 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.434 | L2-Norm(final)=3.419 | 3406.5 samples/s | 53.2 steps/s
[Step=35150 Epoch=335.7] | Loss=0.00028 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.433 | L2-Norm(final)=3.419 | 1646.7 samples/s | 25.7 steps/s
[Step=35200 Epoch=336.1] | Loss=0.00026 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.433 | L2-Norm(final)=3.419 | 3345.4 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step35200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=324.2] | Loss=0.00793 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.499 | L2-Norm(final)=3.414 | 3537.8 samples/s | 55.3 steps/s
[Step=34450 Epoch=324.6] | Loss=0.00393 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.464 | L2-Norm(final)=3.418 | 3214.3 samples/s | 50.2 steps/s
[Step=34500 Epoch=325.1] | Loss=0.00201 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.457 | L2-Norm(final)=3.419 | 4217.1 samples/s | 65.9 steps/s
[Step=34550 Epoch=325.6] | Loss=0.00136 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.453 | L2-Norm(final)=3.419 | 1513.6 samples/s | 23.6 steps/s
[Step=34600 Epoch=326.0] | Loss=0.00103 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.450 | L2-Norm(final)=3.419 | 3910.0 samples/s | 61.1 steps/s
[Step=34650 Epoch=326.5] | Loss=0.00083 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.448 | L2-Norm(final)=3.420 | 1575.0 samples/s | 24.6 steps/s
[Step=34700 Epoch=327.0] | Loss=0.00070 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.445 | L2-Norm(final)=3.420 | 3675.7 samples/s | 57.4 steps/s
[Step=34750 Epoch=327.4] | Loss=0.00060 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.444 | L2-Norm(final)=3.420 | 1598.7 samples/s | 25.0 steps/s
[Step=34800 Epoch=327.9] | Loss=0.00053 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.442 | L2-Norm(final)=3.420 | 3577.5 samples/s | 55.9 steps/s
[Step=34850 Epoch=328.4] | Loss=0.00047 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.441 | L2-Norm(final)=3.420 | 1636.2 samples/s | 25.6 steps/s
[Step=34900 Epoch=328.9] | Loss=0.00043 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.439 | L2-Norm(final)=3.420 | 3488.9 samples/s | 54.5 steps/s
[Step=34950 Epoch=329.3] | Loss=0.00039 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.438 | L2-Norm(final)=3.420 | 1702.1 samples/s | 26.6 steps/s
[Step=35000 Epoch=329.8] | Loss=0.00036 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.437 | L2-Norm(final)=3.420 | 3512.8 samples/s | 54.9 steps/s
[Step=35050 Epoch=330.3] | Loss=0.00033 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.436 | L2-Norm(final)=3.420 | 1662.0 samples/s | 26.0 steps/s
[Step=35100 Epoch=330.7] | Loss=0.00031 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.435 | L2-Norm(final)=3.420 | 3323.6 samples/s | 51.9 steps/s
[Step=35150 Epoch=331.2] | Loss=0.00029 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.434 | L2-Norm(final)=3.420 | 1752.3 samples/s | 27.4 steps/s
[Step=35200 Epoch=331.7] | Loss=0.00027 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.433 | L2-Norm(final)=3.420 | 3207.8 samples/s | 50.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step35200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=327.9] | Loss=0.02423 | Reg=0.00272 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.499 | L2-Norm(final)=3.414 | 3673.7 samples/s | 57.4 steps/s
[Step=34450 Epoch=328.3] | Loss=0.00734 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.465 | L2-Norm(final)=3.419 | 3122.2 samples/s | 48.8 steps/s
[Step=34500 Epoch=328.8] | Loss=0.00371 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.458 | L2-Norm(final)=3.420 | 4194.1 samples/s | 65.5 steps/s
[Step=34550 Epoch=329.3] | Loss=0.00249 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.454 | L2-Norm(final)=3.420 | 1516.1 samples/s | 23.7 steps/s
[Step=34600 Epoch=329.8] | Loss=0.00188 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.451 | L2-Norm(final)=3.420 | 3964.7 samples/s | 61.9 steps/s
[Step=34650 Epoch=330.2] | Loss=0.00151 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.448 | L2-Norm(final)=3.420 | 1581.8 samples/s | 24.7 steps/s
[Step=34700 Epoch=330.7] | Loss=0.00127 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.446 | L2-Norm(final)=3.420 | 3900.1 samples/s | 60.9 steps/s
[Step=34750 Epoch=331.2] | Loss=0.00109 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.445 | L2-Norm(final)=3.421 | 1582.6 samples/s | 24.7 steps/s
[Step=34800 Epoch=331.7] | Loss=0.00096 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.443 | L2-Norm(final)=3.421 | 3708.8 samples/s | 57.9 steps/s
[Step=34850 Epoch=332.2] | Loss=0.00085 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.442 | L2-Norm(final)=3.421 | 1627.5 samples/s | 25.4 steps/s
[Step=34900 Epoch=332.6] | Loss=0.00077 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.441 | L2-Norm(final)=3.421 | 3560.0 samples/s | 55.6 steps/s
[Step=34950 Epoch=333.1] | Loss=0.00070 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.439 | L2-Norm(final)=3.421 | 1623.4 samples/s | 25.4 steps/s
[Step=35000 Epoch=333.6] | Loss=0.00065 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.438 | L2-Norm(final)=3.421 | 3443.5 samples/s | 53.8 steps/s
[Step=35050 Epoch=334.1] | Loss=0.00060 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.437 | L2-Norm(final)=3.421 | 1652.9 samples/s | 25.8 steps/s
[Step=35100 Epoch=334.5] | Loss=0.00056 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.436 | L2-Norm(final)=3.421 | 3369.5 samples/s | 52.6 steps/s
[Step=35150 Epoch=335.0] | Loss=0.00052 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.436 | L2-Norm(final)=3.421 | 1670.8 samples/s | 26.1 steps/s
[Step=35200 Epoch=335.5] | Loss=0.00049 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.435 | L2-Norm(final)=3.421 | 3368.3 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21889 | acc=0.8923 | tpr=0.8504 | fpr=0.0166 | 3672.3 samples/s | 14.3 steps/s
Avg test loss: 0.22128, Avg test acc: 0.89134, Avg tpr: 0.84933, Avg fpr: 0.01628, total FA: 127

Testing server on iccad2012
[Step=  50] | Loss=0.44437 | acc=0.8742 | tpr=0.9558 | fpr=0.1272 | 3666.2 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.45363 | acc=0.8724 | tpr=0.9595 | fpr=0.1292 | 6898.4 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.45925 | acc=0.8719 | tpr=0.9625 | fpr=0.1297 | 6683.4 samples/s | 26.1 steps/s
[Step= 200] | Loss=0.46005 | acc=0.8730 | tpr=0.9628 | fpr=0.1286 | 7009.6 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.45872 | acc=0.8730 | tpr=0.9651 | fpr=0.1287 | 7081.4 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.45736 | acc=0.8737 | tpr=0.9607 | fpr=0.1279 | 6786.7 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.45991 | acc=0.8738 | tpr=0.9587 | fpr=0.1277 | 6645.5 samples/s | 26.0 steps/s
[Step= 400] | Loss=0.46066 | acc=0.8740 | tpr=0.9557 | fpr=0.1275 | 7036.4 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.46499 | acc=0.8732 | tpr=0.9562 | fpr=0.1284 | 6842.9 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.46558 | acc=0.8732 | tpr=0.9581 | fpr=0.1284 | 6806.3 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.46475 | acc=0.8734 | tpr=0.9602 | fpr=0.1282 | 12874.8 samples/s | 50.3 steps/s
Avg test loss: 0.46455, Avg test acc: 0.87338, Avg tpr: 0.96038, Avg fpr: 0.12820, total FA: 17800

server round 44/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.6] | Loss=0.08353 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=16.439 | L2-Norm(final)=3.427 | 3669.4 samples/s | 57.3 steps/s
[Step=35250 Epoch=171.9] | Loss=0.01639 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.429 | L2-Norm(final)=3.425 | 3465.1 samples/s | 54.1 steps/s
[Step=35300 Epoch=172.1] | Loss=0.01221 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.424 | L2-Norm(final)=3.425 | 3544.5 samples/s | 55.4 steps/s
[Step=35350 Epoch=172.4] | Loss=0.00975 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.421 | L2-Norm(final)=3.425 | 3521.3 samples/s | 55.0 steps/s
[Step=35400 Epoch=172.6] | Loss=0.00877 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.419 | L2-Norm(final)=3.426 | 4426.5 samples/s | 69.2 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00775 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.418 | L2-Norm(final)=3.426 | 1574.2 samples/s | 24.6 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00687 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.417 | L2-Norm(final)=3.427 | 3522.1 samples/s | 55.0 steps/s
[Step=35550 Epoch=173.3] | Loss=0.00647 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.416 | L2-Norm(final)=3.428 | 3540.9 samples/s | 55.3 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00604 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.415 | L2-Norm(final)=3.429 | 4024.1 samples/s | 62.9 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00558 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.415 | L2-Norm(final)=3.429 | 1580.2 samples/s | 24.7 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00529 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.414 | L2-Norm(final)=3.430 | 3504.9 samples/s | 54.8 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00511 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.431 | 3577.6 samples/s | 55.9 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00501 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.432 | 3902.7 samples/s | 61.0 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00478 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.432 | 1657.5 samples/s | 25.9 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00458 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.412 | L2-Norm(final)=3.433 | 3578.5 samples/s | 55.9 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00439 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.412 | L2-Norm(final)=3.434 | 3660.2 samples/s | 57.2 steps/s
[Step=36000 Epoch=175.5] | Loss=0.00434 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.411 | L2-Norm(final)=3.435 | 3864.1 samples/s | 60.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.8] | Loss=0.14627 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=16.439 | L2-Norm(final)=3.427 | 3788.0 samples/s | 59.2 steps/s
[Step=35250 Epoch=172.0] | Loss=0.01637 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.429 | L2-Norm(final)=3.425 | 3359.0 samples/s | 52.5 steps/s
[Step=35300 Epoch=172.2] | Loss=0.01125 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.424 | L2-Norm(final)=3.425 | 3485.3 samples/s | 54.5 steps/s
[Step=35350 Epoch=172.5] | Loss=0.00933 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.421 | L2-Norm(final)=3.426 | 3553.0 samples/s | 55.5 steps/s
[Step=35400 Epoch=172.7] | Loss=0.00800 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.419 | L2-Norm(final)=3.426 | 4561.9 samples/s | 71.3 steps/s
[Step=35450 Epoch=173.0] | Loss=0.00688 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.418 | L2-Norm(final)=3.427 | 1598.1 samples/s | 25.0 steps/s
[Step=35500 Epoch=173.2] | Loss=0.00610 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.417 | L2-Norm(final)=3.428 | 3611.0 samples/s | 56.4 steps/s
[Step=35550 Epoch=173.5] | Loss=0.00569 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.416 | L2-Norm(final)=3.429 | 3553.6 samples/s | 55.5 steps/s
[Step=35600 Epoch=173.7] | Loss=0.00542 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.415 | L2-Norm(final)=3.429 | 4157.7 samples/s | 65.0 steps/s
[Step=35650 Epoch=174.0] | Loss=0.00504 | Reg=0.00269 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.414 | L2-Norm(final)=3.430 | 1584.8 samples/s | 24.8 steps/s
[Step=35700 Epoch=174.2] | Loss=0.00477 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.414 | L2-Norm(final)=3.431 | 3451.0 samples/s | 53.9 steps/s
[Step=35750 Epoch=174.4] | Loss=0.00450 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.432 | 3472.4 samples/s | 54.3 steps/s
[Step=35800 Epoch=174.7] | Loss=0.00436 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.432 | 4267.3 samples/s | 66.7 steps/s
[Step=35850 Epoch=174.9] | Loss=0.00427 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.412 | L2-Norm(final)=3.433 | 1670.1 samples/s | 26.1 steps/s
[Step=35900 Epoch=175.2] | Loss=0.00412 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.412 | L2-Norm(final)=3.434 | 3516.6 samples/s | 54.9 steps/s
[Step=35950 Epoch=175.4] | Loss=0.00402 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.411 | L2-Norm(final)=3.434 | 3517.6 samples/s | 55.0 steps/s
[Step=36000 Epoch=175.7] | Loss=0.00386 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.411 | L2-Norm(final)=3.435 | 3877.0 samples/s | 60.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step36000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.5] | Loss=0.13976 | Reg=0.00270 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=16.439 | L2-Norm(final)=3.427 | 3764.1 samples/s | 58.8 steps/s
[Step=35250 Epoch=171.8] | Loss=0.01922 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.428 | L2-Norm(final)=3.425 | 3298.2 samples/s | 51.5 steps/s
[Step=35300 Epoch=172.0] | Loss=0.01248 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.423 | L2-Norm(final)=3.425 | 3520.9 samples/s | 55.0 steps/s
[Step=35350 Epoch=172.2] | Loss=0.01001 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.420 | L2-Norm(final)=3.425 | 3487.2 samples/s | 54.5 steps/s
[Step=35400 Epoch=172.5] | Loss=0.00873 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.419 | L2-Norm(final)=3.426 | 4289.8 samples/s | 67.0 steps/s
[Step=35450 Epoch=172.7] | Loss=0.00773 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.417 | L2-Norm(final)=3.427 | 1598.4 samples/s | 25.0 steps/s
[Step=35500 Epoch=173.0] | Loss=0.00698 | Reg=0.00269 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.416 | L2-Norm(final)=3.428 | 3532.9 samples/s | 55.2 steps/s
[Step=35550 Epoch=173.2] | Loss=0.00633 | Reg=0.00269 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.416 | L2-Norm(final)=3.429 | 3560.3 samples/s | 55.6 steps/s
[Step=35600 Epoch=173.5] | Loss=0.00584 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.415 | L2-Norm(final)=3.430 | 4127.5 samples/s | 64.5 steps/s
[Step=35650 Epoch=173.7] | Loss=0.00544 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.414 | L2-Norm(final)=3.431 | 1627.6 samples/s | 25.4 steps/s
[Step=35700 Epoch=173.9] | Loss=0.00511 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.414 | L2-Norm(final)=3.432 | 3509.1 samples/s | 54.8 steps/s
[Step=35750 Epoch=174.2] | Loss=0.00494 | Reg=0.00269 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.414 | L2-Norm(final)=3.433 | 3556.7 samples/s | 55.6 steps/s
[Step=35800 Epoch=174.4] | Loss=0.00475 | Reg=0.00269 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.413 | L2-Norm(final)=3.434 | 3924.4 samples/s | 61.3 steps/s
[Step=35850 Epoch=174.7] | Loss=0.00457 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.435 | 1644.4 samples/s | 25.7 steps/s
[Step=35900 Epoch=174.9] | Loss=0.00436 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.436 | 3653.7 samples/s | 57.1 steps/s
[Step=35950 Epoch=175.2] | Loss=0.00421 | Reg=0.00269 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.413 | L2-Norm(final)=3.437 | 3683.8 samples/s | 57.6 steps/s
[Step=36000 Epoch=175.4] | Loss=0.00413 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.412 | L2-Norm(final)=3.438 | 3806.3 samples/s | 59.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step36000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.7] | Loss=0.15463 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=16.439 | L2-Norm(final)=3.427 | 3712.7 samples/s | 58.0 steps/s
[Step=35250 Epoch=171.9] | Loss=0.01742 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.428 | L2-Norm(final)=3.424 | 3320.3 samples/s | 51.9 steps/s
[Step=35300 Epoch=172.1] | Loss=0.01105 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.423 | L2-Norm(final)=3.425 | 3600.9 samples/s | 56.3 steps/s
[Step=35350 Epoch=172.4] | Loss=0.00935 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.421 | L2-Norm(final)=3.425 | 3575.8 samples/s | 55.9 steps/s
[Step=35400 Epoch=172.6] | Loss=0.00807 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.419 | L2-Norm(final)=3.426 | 4414.6 samples/s | 69.0 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00682 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.418 | L2-Norm(final)=3.427 | 1570.5 samples/s | 24.5 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00622 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.417 | L2-Norm(final)=3.428 | 3466.2 samples/s | 54.2 steps/s
[Step=35550 Epoch=173.4] | Loss=0.00562 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.417 | L2-Norm(final)=3.429 | 3486.6 samples/s | 54.5 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00545 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.416 | L2-Norm(final)=3.430 | 4225.4 samples/s | 66.0 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00502 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.415 | L2-Norm(final)=3.430 | 1608.4 samples/s | 25.1 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00472 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.415 | L2-Norm(final)=3.431 | 3474.9 samples/s | 54.3 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00451 | Reg=0.00269 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.415 | L2-Norm(final)=3.432 | 3467.1 samples/s | 54.2 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00436 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.414 | L2-Norm(final)=3.433 | 3936.9 samples/s | 61.5 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00425 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.414 | L2-Norm(final)=3.434 | 1615.1 samples/s | 25.2 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00420 | Reg=0.00269 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.413 | L2-Norm(final)=3.434 | 3615.5 samples/s | 56.5 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00404 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.435 | 3525.0 samples/s | 55.1 steps/s
[Step=36000 Epoch=175.6] | Loss=0.00392 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.436 | 3793.5 samples/s | 59.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step36000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=172.6] | Loss=0.08947 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.439 | L2-Norm(final)=3.427 | 3640.3 samples/s | 56.9 steps/s
[Step=35250 Epoch=172.9] | Loss=0.02275 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.428 | L2-Norm(final)=3.424 | 3449.0 samples/s | 53.9 steps/s
[Step=35300 Epoch=173.1] | Loss=0.01422 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.424 | L2-Norm(final)=3.424 | 3555.7 samples/s | 55.6 steps/s
[Step=35350 Epoch=173.4] | Loss=0.01108 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.421 | L2-Norm(final)=3.424 | 3518.9 samples/s | 55.0 steps/s
[Step=35400 Epoch=173.6] | Loss=0.00974 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.420 | L2-Norm(final)=3.425 | 4364.7 samples/s | 68.2 steps/s
[Step=35450 Epoch=173.8] | Loss=0.00838 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.418 | L2-Norm(final)=3.426 | 1564.1 samples/s | 24.4 steps/s
[Step=35500 Epoch=174.1] | Loss=0.00757 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.417 | L2-Norm(final)=3.426 | 3601.1 samples/s | 56.3 steps/s
[Step=35550 Epoch=174.3] | Loss=0.00689 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.416 | L2-Norm(final)=3.427 | 3559.7 samples/s | 55.6 steps/s
[Step=35600 Epoch=174.6] | Loss=0.00629 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.416 | L2-Norm(final)=3.428 | 4243.2 samples/s | 66.3 steps/s
[Step=35650 Epoch=174.8] | Loss=0.00590 | Reg=0.00269 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.415 | L2-Norm(final)=3.429 | 1553.4 samples/s | 24.3 steps/s
[Step=35700 Epoch=175.1] | Loss=0.00548 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.415 | L2-Norm(final)=3.429 | 3485.9 samples/s | 54.5 steps/s
[Step=35750 Epoch=175.3] | Loss=0.00524 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.414 | L2-Norm(final)=3.430 | 3507.1 samples/s | 54.8 steps/s
[Step=35800 Epoch=175.6] | Loss=0.00501 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.414 | L2-Norm(final)=3.431 | 4108.1 samples/s | 64.2 steps/s
[Step=35850 Epoch=175.8] | Loss=0.00479 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.432 | 1574.1 samples/s | 24.6 steps/s
[Step=35900 Epoch=176.0] | Loss=0.00457 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.432 | 3311.5 samples/s | 51.7 steps/s
[Step=35950 Epoch=176.3] | Loss=0.00439 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.433 | 3411.7 samples/s | 53.3 steps/s
[Step=36000 Epoch=176.5] | Loss=0.00426 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.434 | 3830.2 samples/s | 59.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step36000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=333.6] | Loss=0.03935 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.439 | L2-Norm(final)=3.427 | 3356.6 samples/s | 52.4 steps/s
[Step=35250 Epoch=334.0] | Loss=0.00478 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.404 | L2-Norm(final)=3.431 | 2938.2 samples/s | 45.9 steps/s
[Step=35300 Epoch=334.5] | Loss=0.00241 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.397 | L2-Norm(final)=3.431 | 4014.8 samples/s | 62.7 steps/s
[Step=35350 Epoch=335.0] | Loss=0.00161 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.393 | L2-Norm(final)=3.431 | 1446.9 samples/s | 22.6 steps/s
[Step=35400 Epoch=335.4] | Loss=0.00122 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.390 | L2-Norm(final)=3.431 | 3799.4 samples/s | 59.4 steps/s
[Step=35450 Epoch=335.9] | Loss=0.00098 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.388 | L2-Norm(final)=3.431 | 1524.2 samples/s | 23.8 steps/s
[Step=35500 Epoch=336.4] | Loss=0.00082 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.386 | L2-Norm(final)=3.431 | 3927.8 samples/s | 61.4 steps/s
[Step=35550 Epoch=336.9] | Loss=0.00070 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.384 | L2-Norm(final)=3.431 | 1587.4 samples/s | 24.8 steps/s
[Step=35600 Epoch=337.3] | Loss=0.00062 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.383 | L2-Norm(final)=3.431 | 3574.8 samples/s | 55.9 steps/s
[Step=35650 Epoch=337.8] | Loss=0.00055 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.381 | L2-Norm(final)=3.432 | 1619.8 samples/s | 25.3 steps/s
[Step=35700 Epoch=338.3] | Loss=0.00050 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.380 | L2-Norm(final)=3.432 | 3366.2 samples/s | 52.6 steps/s
[Step=35750 Epoch=338.8] | Loss=0.00045 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.379 | L2-Norm(final)=3.432 | 1653.3 samples/s | 25.8 steps/s
[Step=35800 Epoch=339.2] | Loss=0.00042 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.378 | L2-Norm(final)=3.432 | 3437.2 samples/s | 53.7 steps/s
[Step=35850 Epoch=339.7] | Loss=0.00039 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.377 | L2-Norm(final)=3.432 | 1693.2 samples/s | 26.5 steps/s
[Step=35900 Epoch=340.2] | Loss=0.00036 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.376 | L2-Norm(final)=3.432 | 3379.5 samples/s | 52.8 steps/s
[Step=35950 Epoch=340.7] | Loss=0.00034 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.375 | L2-Norm(final)=3.432 | 1694.4 samples/s | 26.5 steps/s
[Step=36000 Epoch=341.1] | Loss=0.00032 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.374 | L2-Norm(final)=3.432 | 3319.4 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step36000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=334.8] | Loss=0.10650 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.439 | L2-Norm(final)=3.427 | 3500.6 samples/s | 54.7 steps/s
[Step=35250 Epoch=335.3] | Loss=0.00531 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.405 | L2-Norm(final)=3.431 | 3285.8 samples/s | 51.3 steps/s
[Step=35300 Epoch=335.8] | Loss=0.00269 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.398 | L2-Norm(final)=3.432 | 4193.4 samples/s | 65.5 steps/s
[Step=35350 Epoch=336.3] | Loss=0.00181 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.394 | L2-Norm(final)=3.432 | 1555.2 samples/s | 24.3 steps/s
[Step=35400 Epoch=336.7] | Loss=0.00137 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.391 | L2-Norm(final)=3.433 | 3989.6 samples/s | 62.3 steps/s
[Step=35450 Epoch=337.2] | Loss=0.00110 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.389 | L2-Norm(final)=3.433 | 1561.0 samples/s | 24.4 steps/s
[Step=35500 Epoch=337.7] | Loss=0.00092 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.386 | L2-Norm(final)=3.433 | 3765.3 samples/s | 58.8 steps/s
[Step=35550 Epoch=338.2] | Loss=0.00080 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.385 | L2-Norm(final)=3.433 | 1567.6 samples/s | 24.5 steps/s
[Step=35600 Epoch=338.6] | Loss=0.00070 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.383 | L2-Norm(final)=3.433 | 3693.0 samples/s | 57.7 steps/s
[Step=35650 Epoch=339.1] | Loss=0.00062 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.382 | L2-Norm(final)=3.433 | 1622.5 samples/s | 25.4 steps/s
[Step=35700 Epoch=339.6] | Loss=0.00056 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.380 | L2-Norm(final)=3.433 | 3446.7 samples/s | 53.9 steps/s
[Step=35750 Epoch=340.1] | Loss=0.00051 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.379 | L2-Norm(final)=3.433 | 1668.8 samples/s | 26.1 steps/s
[Step=35800 Epoch=340.5] | Loss=0.00047 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.378 | L2-Norm(final)=3.433 | 3353.6 samples/s | 52.4 steps/s
[Step=35850 Epoch=341.0] | Loss=0.00044 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.377 | L2-Norm(final)=3.433 | 1679.4 samples/s | 26.2 steps/s
[Step=35900 Epoch=341.5] | Loss=0.00041 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.376 | L2-Norm(final)=3.433 | 3397.1 samples/s | 53.1 steps/s
[Step=35950 Epoch=342.0] | Loss=0.00038 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.375 | L2-Norm(final)=3.433 | 1714.7 samples/s | 26.8 steps/s
[Step=36000 Epoch=342.4] | Loss=0.00036 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.374 | L2-Norm(final)=3.433 | 3355.1 samples/s | 52.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step36000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=336.1] | Loss=0.12161 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=16.439 | L2-Norm(final)=3.427 | 3721.2 samples/s | 58.1 steps/s
[Step=35250 Epoch=336.6] | Loss=0.00427 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.404 | L2-Norm(final)=3.430 | 3232.6 samples/s | 50.5 steps/s
[Step=35300 Epoch=337.1] | Loss=0.00215 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.397 | L2-Norm(final)=3.431 | 4424.5 samples/s | 69.1 steps/s
[Step=35350 Epoch=337.6] | Loss=0.00144 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.393 | L2-Norm(final)=3.431 | 1524.1 samples/s | 23.8 steps/s
[Step=35400 Epoch=338.0] | Loss=0.00109 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.390 | L2-Norm(final)=3.431 | 4106.0 samples/s | 64.2 steps/s
[Step=35450 Epoch=338.5] | Loss=0.00087 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.387 | L2-Norm(final)=3.431 | 1555.7 samples/s | 24.3 steps/s
[Step=35500 Epoch=339.0] | Loss=0.00073 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.385 | L2-Norm(final)=3.431 | 3861.2 samples/s | 60.3 steps/s
[Step=35550 Epoch=339.5] | Loss=0.00063 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.384 | L2-Norm(final)=3.431 | 1584.5 samples/s | 24.8 steps/s
[Step=35600 Epoch=340.0] | Loss=0.00055 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.382 | L2-Norm(final)=3.431 | 3704.0 samples/s | 57.9 steps/s
[Step=35650 Epoch=340.4] | Loss=0.00049 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.381 | L2-Norm(final)=3.431 | 1609.4 samples/s | 25.1 steps/s
[Step=35700 Epoch=340.9] | Loss=0.00045 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.379 | L2-Norm(final)=3.431 | 3582.2 samples/s | 56.0 steps/s
[Step=35750 Epoch=341.4] | Loss=0.00041 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.378 | L2-Norm(final)=3.431 | 1656.8 samples/s | 25.9 steps/s
[Step=35800 Epoch=341.9] | Loss=0.00038 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.377 | L2-Norm(final)=3.431 | 3522.5 samples/s | 55.0 steps/s
[Step=35850 Epoch=342.3] | Loss=0.00035 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.376 | L2-Norm(final)=3.431 | 1642.7 samples/s | 25.7 steps/s
[Step=35900 Epoch=342.8] | Loss=0.00032 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.375 | L2-Norm(final)=3.431 | 3400.0 samples/s | 53.1 steps/s
[Step=35950 Epoch=343.3] | Loss=0.00030 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.374 | L2-Norm(final)=3.431 | 1693.5 samples/s | 26.5 steps/s
[Step=36000 Epoch=343.8] | Loss=0.00028 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.373 | L2-Norm(final)=3.431 | 3504.4 samples/s | 54.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step36000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=331.7] | Loss=0.04992 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.439 | L2-Norm(final)=3.427 | 3611.7 samples/s | 56.4 steps/s
[Step=35250 Epoch=332.2] | Loss=0.00609 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.402 | L2-Norm(final)=3.429 | 3238.6 samples/s | 50.6 steps/s
[Step=35300 Epoch=332.6] | Loss=0.00308 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.395 | L2-Norm(final)=3.430 | 4250.1 samples/s | 66.4 steps/s
[Step=35350 Epoch=333.1] | Loss=0.00207 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.391 | L2-Norm(final)=3.430 | 1528.1 samples/s | 23.9 steps/s
[Step=35400 Epoch=333.6] | Loss=0.00156 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.389 | L2-Norm(final)=3.430 | 3909.6 samples/s | 61.1 steps/s
[Step=35450 Epoch=334.0] | Loss=0.00126 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.386 | L2-Norm(final)=3.430 | 1586.1 samples/s | 24.8 steps/s
[Step=35500 Epoch=334.5] | Loss=0.00105 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.385 | L2-Norm(final)=3.430 | 3719.1 samples/s | 58.1 steps/s
[Step=35550 Epoch=335.0] | Loss=0.00091 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.383 | L2-Norm(final)=3.430 | 1602.0 samples/s | 25.0 steps/s
[Step=35600 Epoch=335.5] | Loss=0.00080 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.382 | L2-Norm(final)=3.430 | 3524.6 samples/s | 55.1 steps/s
[Step=35650 Epoch=335.9] | Loss=0.00071 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.380 | L2-Norm(final)=3.430 | 1647.5 samples/s | 25.7 steps/s
[Step=35700 Epoch=336.4] | Loss=0.00064 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.379 | L2-Norm(final)=3.431 | 3352.9 samples/s | 52.4 steps/s
[Step=35750 Epoch=336.9] | Loss=0.00058 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.378 | L2-Norm(final)=3.431 | 1674.8 samples/s | 26.2 steps/s
[Step=35800 Epoch=337.3] | Loss=0.00054 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.377 | L2-Norm(final)=3.431 | 3380.0 samples/s | 52.8 steps/s
[Step=35850 Epoch=337.8] | Loss=0.00050 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.376 | L2-Norm(final)=3.431 | 1697.9 samples/s | 26.5 steps/s
[Step=35900 Epoch=338.3] | Loss=0.00046 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.375 | L2-Norm(final)=3.431 | 3398.1 samples/s | 53.1 steps/s
[Step=35950 Epoch=338.8] | Loss=0.00043 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.375 | L2-Norm(final)=3.431 | 1755.5 samples/s | 27.4 steps/s
[Step=36000 Epoch=339.2] | Loss=0.00041 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.374 | L2-Norm(final)=3.431 | 3123.4 samples/s | 48.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step36000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=335.5] | Loss=0.10494 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=16.439 | L2-Norm(final)=3.427 | 3749.2 samples/s | 58.6 steps/s
[Step=35250 Epoch=336.0] | Loss=0.00604 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.408 | L2-Norm(final)=3.432 | 3103.1 samples/s | 48.5 steps/s
[Step=35300 Epoch=336.4] | Loss=0.00307 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.401 | L2-Norm(final)=3.432 | 4235.5 samples/s | 66.2 steps/s
[Step=35350 Epoch=336.9] | Loss=0.00207 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.397 | L2-Norm(final)=3.433 | 1513.6 samples/s | 23.7 steps/s
[Step=35400 Epoch=337.4] | Loss=0.00156 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.394 | L2-Norm(final)=3.433 | 4090.3 samples/s | 63.9 steps/s
[Step=35450 Epoch=337.9] | Loss=0.00126 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.392 | L2-Norm(final)=3.433 | 1572.1 samples/s | 24.6 steps/s
[Step=35500 Epoch=338.3] | Loss=0.00105 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.390 | L2-Norm(final)=3.433 | 3903.6 samples/s | 61.0 steps/s
[Step=35550 Epoch=338.8] | Loss=0.00091 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.389 | L2-Norm(final)=3.433 | 1596.2 samples/s | 24.9 steps/s
[Step=35600 Epoch=339.3] | Loss=0.00080 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.387 | L2-Norm(final)=3.433 | 3647.8 samples/s | 57.0 steps/s
[Step=35650 Epoch=339.8] | Loss=0.00071 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.386 | L2-Norm(final)=3.433 | 1612.9 samples/s | 25.2 steps/s
[Step=35700 Epoch=340.3] | Loss=0.00064 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.384 | L2-Norm(final)=3.433 | 3565.8 samples/s | 55.7 steps/s
[Step=35750 Epoch=340.7] | Loss=0.00059 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.383 | L2-Norm(final)=3.433 | 1639.5 samples/s | 25.6 steps/s
[Step=35800 Epoch=341.2] | Loss=0.00054 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.382 | L2-Norm(final)=3.433 | 3434.5 samples/s | 53.7 steps/s
[Step=35850 Epoch=341.7] | Loss=0.00050 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.381 | L2-Norm(final)=3.433 | 1669.6 samples/s | 26.1 steps/s
[Step=35900 Epoch=342.2] | Loss=0.00047 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.380 | L2-Norm(final)=3.433 | 3383.2 samples/s | 52.9 steps/s
[Step=35950 Epoch=342.6] | Loss=0.00044 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.379 | L2-Norm(final)=3.433 | 1683.7 samples/s | 26.3 steps/s
[Step=36000 Epoch=343.1] | Loss=0.00041 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.378 | L2-Norm(final)=3.433 | 3455.3 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22444 | acc=0.8902 | tpr=0.8471 | fpr=0.0164 | 3707.7 samples/s | 14.5 steps/s
Avg test loss: 0.22643, Avg test acc: 0.88998, Avg tpr: 0.84723, Avg fpr: 0.01602, total FA: 125

Testing server on iccad2012
[Step=  50] | Loss=0.43535 | acc=0.8793 | tpr=0.9558 | fpr=0.1221 | 3642.2 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.44387 | acc=0.8776 | tpr=0.9595 | fpr=0.1239 | 6945.9 samples/s | 27.1 steps/s
[Step= 150] | Loss=0.44971 | acc=0.8768 | tpr=0.9625 | fpr=0.1248 | 6952.3 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.45053 | acc=0.8776 | tpr=0.9628 | fpr=0.1240 | 6750.6 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.44918 | acc=0.8775 | tpr=0.9651 | fpr=0.1241 | 6869.2 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.44792 | acc=0.8782 | tpr=0.9600 | fpr=0.1233 | 7061.1 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.45052 | acc=0.8783 | tpr=0.9574 | fpr=0.1231 | 6805.6 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.45132 | acc=0.8785 | tpr=0.9546 | fpr=0.1229 | 7058.9 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.45562 | acc=0.8777 | tpr=0.9552 | fpr=0.1237 | 6766.8 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.45622 | acc=0.8776 | tpr=0.9573 | fpr=0.1238 | 6620.1 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.45544 | acc=0.8778 | tpr=0.9594 | fpr=0.1237 | 12931.4 samples/s | 50.5 steps/s
Avg test loss: 0.45524, Avg test acc: 0.87779, Avg tpr: 0.95959, Avg fpr: 0.12370, total FA: 17175

server round 45/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.5] | Loss=0.13269 | Reg=0.00268 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=16.381 | L2-Norm(final)=3.439 | 3786.1 samples/s | 59.2 steps/s
[Step=36050 Epoch=175.8] | Loss=0.01667 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.371 | L2-Norm(final)=3.438 | 3314.3 samples/s | 51.8 steps/s
[Step=36100 Epoch=176.0] | Loss=0.01248 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.366 | L2-Norm(final)=3.438 | 3584.2 samples/s | 56.0 steps/s
[Step=36150 Epoch=176.3] | Loss=0.00978 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.364 | L2-Norm(final)=3.439 | 3614.3 samples/s | 56.5 steps/s
[Step=36200 Epoch=176.5] | Loss=0.00880 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.362 | L2-Norm(final)=3.439 | 4415.6 samples/s | 69.0 steps/s
[Step=36250 Epoch=176.8] | Loss=0.00772 | Reg=0.00268 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.360 | L2-Norm(final)=3.440 | 1611.3 samples/s | 25.2 steps/s
[Step=36300 Epoch=177.0] | Loss=0.00692 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.359 | L2-Norm(final)=3.441 | 3484.7 samples/s | 54.4 steps/s
[Step=36350 Epoch=177.2] | Loss=0.00633 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.358 | L2-Norm(final)=3.441 | 3616.9 samples/s | 56.5 steps/s
[Step=36400 Epoch=177.5] | Loss=0.00595 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.358 | L2-Norm(final)=3.442 | 4168.7 samples/s | 65.1 steps/s
[Step=36450 Epoch=177.7] | Loss=0.00555 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.357 | L2-Norm(final)=3.443 | 1627.6 samples/s | 25.4 steps/s
[Step=36500 Epoch=178.0] | Loss=0.00524 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.356 | L2-Norm(final)=3.444 | 3440.0 samples/s | 53.8 steps/s
[Step=36550 Epoch=178.2] | Loss=0.00502 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.356 | L2-Norm(final)=3.444 | 3693.5 samples/s | 57.7 steps/s
[Step=36600 Epoch=178.5] | Loss=0.00487 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.356 | L2-Norm(final)=3.445 | 4035.5 samples/s | 63.1 steps/s
[Step=36650 Epoch=178.7] | Loss=0.00473 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.355 | L2-Norm(final)=3.446 | 1654.4 samples/s | 25.8 steps/s
[Step=36700 Epoch=179.0] | Loss=0.00458 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.355 | L2-Norm(final)=3.446 | 3512.6 samples/s | 54.9 steps/s
[Step=36750 Epoch=179.2] | Loss=0.00447 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.354 | L2-Norm(final)=3.447 | 3652.7 samples/s | 57.1 steps/s
[Step=36800 Epoch=179.4] | Loss=0.00436 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.354 | L2-Norm(final)=3.448 | 3753.1 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step36800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.7] | Loss=0.05279 | Reg=0.00268 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.381 | L2-Norm(final)=3.440 | 3575.2 samples/s | 55.9 steps/s
[Step=36050 Epoch=175.9] | Loss=0.01721 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.369 | L2-Norm(final)=3.437 | 3539.0 samples/s | 55.3 steps/s
[Step=36100 Epoch=176.2] | Loss=0.01167 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.365 | L2-Norm(final)=3.437 | 3495.5 samples/s | 54.6 steps/s
[Step=36150 Epoch=176.4] | Loss=0.00922 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.362 | L2-Norm(final)=3.438 | 3614.0 samples/s | 56.5 steps/s
[Step=36200 Epoch=176.6] | Loss=0.00861 | Reg=0.00268 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.360 | L2-Norm(final)=3.438 | 4483.7 samples/s | 70.1 steps/s
[Step=36250 Epoch=176.9] | Loss=0.00738 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.359 | L2-Norm(final)=3.439 | 1553.8 samples/s | 24.3 steps/s
[Step=36300 Epoch=177.1] | Loss=0.00649 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.358 | L2-Norm(final)=3.440 | 3466.6 samples/s | 54.2 steps/s
[Step=36350 Epoch=177.4] | Loss=0.00601 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.357 | L2-Norm(final)=3.440 | 3494.8 samples/s | 54.6 steps/s
[Step=36400 Epoch=177.6] | Loss=0.00565 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.356 | L2-Norm(final)=3.441 | 4155.2 samples/s | 64.9 steps/s
[Step=36450 Epoch=177.9] | Loss=0.00529 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.355 | L2-Norm(final)=3.442 | 1577.5 samples/s | 24.6 steps/s
[Step=36500 Epoch=178.1] | Loss=0.00500 | Reg=0.00267 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.355 | L2-Norm(final)=3.443 | 3501.2 samples/s | 54.7 steps/s
[Step=36550 Epoch=178.3] | Loss=0.00482 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.354 | L2-Norm(final)=3.443 | 3464.4 samples/s | 54.1 steps/s
[Step=36600 Epoch=178.6] | Loss=0.00461 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.354 | L2-Norm(final)=3.444 | 4029.3 samples/s | 63.0 steps/s
[Step=36650 Epoch=178.8] | Loss=0.00441 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.353 | L2-Norm(final)=3.445 | 1625.5 samples/s | 25.4 steps/s
[Step=36700 Epoch=179.1] | Loss=0.00435 | Reg=0.00267 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.353 | L2-Norm(final)=3.445 | 3557.3 samples/s | 55.6 steps/s
[Step=36750 Epoch=179.3] | Loss=0.00418 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.352 | L2-Norm(final)=3.446 | 3517.0 samples/s | 55.0 steps/s
[Step=36800 Epoch=179.6] | Loss=0.00404 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.352 | L2-Norm(final)=3.447 | 3859.0 samples/s | 60.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step36800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.4] | Loss=0.00801 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.381 | L2-Norm(final)=3.440 | 3830.8 samples/s | 59.9 steps/s
[Step=36050 Epoch=175.7] | Loss=0.01740 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.370 | L2-Norm(final)=3.438 | 3329.1 samples/s | 52.0 steps/s
[Step=36100 Epoch=175.9] | Loss=0.01208 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.366 | L2-Norm(final)=3.438 | 3522.0 samples/s | 55.0 steps/s
[Step=36150 Epoch=176.1] | Loss=0.01018 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.364 | L2-Norm(final)=3.439 | 3565.6 samples/s | 55.7 steps/s
[Step=36200 Epoch=176.4] | Loss=0.00882 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.362 | L2-Norm(final)=3.440 | 4427.9 samples/s | 69.2 steps/s
[Step=36250 Epoch=176.6] | Loss=0.00776 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.361 | L2-Norm(final)=3.440 | 1585.9 samples/s | 24.8 steps/s
[Step=36300 Epoch=176.9] | Loss=0.00691 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.360 | L2-Norm(final)=3.441 | 3515.2 samples/s | 54.9 steps/s
[Step=36350 Epoch=177.1] | Loss=0.00638 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.359 | L2-Norm(final)=3.442 | 3493.5 samples/s | 54.6 steps/s
[Step=36400 Epoch=177.4] | Loss=0.00591 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.359 | L2-Norm(final)=3.443 | 4088.0 samples/s | 63.9 steps/s
[Step=36450 Epoch=177.6] | Loss=0.00551 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.358 | L2-Norm(final)=3.444 | 1627.5 samples/s | 25.4 steps/s
[Step=36500 Epoch=177.8] | Loss=0.00516 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.358 | L2-Norm(final)=3.445 | 3555.2 samples/s | 55.6 steps/s
[Step=36550 Epoch=178.1] | Loss=0.00491 | Reg=0.00268 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.357 | L2-Norm(final)=3.446 | 3623.7 samples/s | 56.6 steps/s
[Step=36600 Epoch=178.3] | Loss=0.00471 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.357 | L2-Norm(final)=3.447 | 3984.8 samples/s | 62.3 steps/s
[Step=36650 Epoch=178.6] | Loss=0.00454 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.357 | L2-Norm(final)=3.447 | 1637.2 samples/s | 25.6 steps/s
[Step=36700 Epoch=178.8] | Loss=0.00440 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.356 | L2-Norm(final)=3.448 | 3570.6 samples/s | 55.8 steps/s
[Step=36750 Epoch=179.1] | Loss=0.00427 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.356 | L2-Norm(final)=3.449 | 3544.3 samples/s | 55.4 steps/s
[Step=36800 Epoch=179.3] | Loss=0.00410 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.356 | L2-Norm(final)=3.450 | 3717.1 samples/s | 58.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step36800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.6] | Loss=0.06930 | Reg=0.00268 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.381 | L2-Norm(final)=3.440 | 3579.6 samples/s | 55.9 steps/s
[Step=36050 Epoch=175.8] | Loss=0.01519 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.372 | L2-Norm(final)=3.438 | 3409.7 samples/s | 53.3 steps/s
[Step=36100 Epoch=176.0] | Loss=0.01044 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.369 | L2-Norm(final)=3.439 | 3533.2 samples/s | 55.2 steps/s
[Step=36150 Epoch=176.3] | Loss=0.00881 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.367 | L2-Norm(final)=3.439 | 3483.2 samples/s | 54.4 steps/s
[Step=36200 Epoch=176.5] | Loss=0.00768 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.365 | L2-Norm(final)=3.440 | 4469.8 samples/s | 69.8 steps/s
[Step=36250 Epoch=176.8] | Loss=0.00654 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.364 | L2-Norm(final)=3.441 | 1599.2 samples/s | 25.0 steps/s
[Step=36300 Epoch=177.0] | Loss=0.00586 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.363 | L2-Norm(final)=3.442 | 3641.9 samples/s | 56.9 steps/s
[Step=36350 Epoch=177.3] | Loss=0.00553 | Reg=0.00268 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.362 | L2-Norm(final)=3.443 | 3558.9 samples/s | 55.6 steps/s
[Step=36400 Epoch=177.5] | Loss=0.00517 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.362 | L2-Norm(final)=3.443 | 4054.9 samples/s | 63.4 steps/s
[Step=36450 Epoch=177.8] | Loss=0.00481 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.361 | L2-Norm(final)=3.444 | 1593.3 samples/s | 24.9 steps/s
[Step=36500 Epoch=178.0] | Loss=0.00456 | Reg=0.00268 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.360 | L2-Norm(final)=3.445 | 3551.8 samples/s | 55.5 steps/s
[Step=36550 Epoch=178.2] | Loss=0.00437 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.360 | L2-Norm(final)=3.446 | 3518.1 samples/s | 55.0 steps/s
[Step=36600 Epoch=178.5] | Loss=0.00415 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.359 | L2-Norm(final)=3.447 | 3885.1 samples/s | 60.7 steps/s
[Step=36650 Epoch=178.7] | Loss=0.00398 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.359 | L2-Norm(final)=3.447 | 1640.3 samples/s | 25.6 steps/s
[Step=36700 Epoch=179.0] | Loss=0.00386 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.359 | L2-Norm(final)=3.448 | 3726.1 samples/s | 58.2 steps/s
[Step=36750 Epoch=179.2] | Loss=0.00377 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.358 | L2-Norm(final)=3.449 | 3543.8 samples/s | 55.4 steps/s
[Step=36800 Epoch=179.5] | Loss=0.00365 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.358 | L2-Norm(final)=3.450 | 3839.0 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step36800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=176.5] | Loss=0.16703 | Reg=0.00268 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=16.381 | L2-Norm(final)=3.439 | 3859.8 samples/s | 60.3 steps/s
[Step=36050 Epoch=176.8] | Loss=0.01915 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.372 | L2-Norm(final)=3.437 | 3384.1 samples/s | 52.9 steps/s
[Step=36100 Epoch=177.0] | Loss=0.01436 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.367 | L2-Norm(final)=3.436 | 3535.9 samples/s | 55.2 steps/s
[Step=36150 Epoch=177.3] | Loss=0.01160 | Reg=0.00268 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.365 | L2-Norm(final)=3.436 | 3553.4 samples/s | 55.5 steps/s
[Step=36200 Epoch=177.5] | Loss=0.00965 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.363 | L2-Norm(final)=3.437 | 4391.3 samples/s | 68.6 steps/s
[Step=36250 Epoch=177.8] | Loss=0.00810 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.361 | L2-Norm(final)=3.438 | 1578.1 samples/s | 24.7 steps/s
[Step=36300 Epoch=178.0] | Loss=0.00718 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.360 | L2-Norm(final)=3.438 | 3622.7 samples/s | 56.6 steps/s
[Step=36350 Epoch=178.3] | Loss=0.00663 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.359 | L2-Norm(final)=3.439 | 3579.9 samples/s | 55.9 steps/s
[Step=36400 Epoch=178.5] | Loss=0.00616 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.359 | L2-Norm(final)=3.440 | 4232.7 samples/s | 66.1 steps/s
[Step=36450 Epoch=178.7] | Loss=0.00569 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.358 | L2-Norm(final)=3.441 | 1598.0 samples/s | 25.0 steps/s
[Step=36500 Epoch=179.0] | Loss=0.00537 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.358 | L2-Norm(final)=3.442 | 3594.6 samples/s | 56.2 steps/s
[Step=36550 Epoch=179.2] | Loss=0.00512 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.357 | L2-Norm(final)=3.442 | 3521.2 samples/s | 55.0 steps/s
[Step=36600 Epoch=179.5] | Loss=0.00487 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.357 | L2-Norm(final)=3.443 | 4186.7 samples/s | 65.4 steps/s
[Step=36650 Epoch=179.7] | Loss=0.00463 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.356 | L2-Norm(final)=3.444 | 1620.4 samples/s | 25.3 steps/s
[Step=36700 Epoch=180.0] | Loss=0.00443 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.356 | L2-Norm(final)=3.445 | 3567.4 samples/s | 55.7 steps/s
[Step=36750 Epoch=180.2] | Loss=0.00427 | Reg=0.00268 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.356 | L2-Norm(final)=3.445 | 3614.4 samples/s | 56.5 steps/s
[Step=36800 Epoch=180.5] | Loss=0.00417 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.355 | L2-Norm(final)=3.446 | 3955.1 samples/s | 61.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step36800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=341.1] | Loss=0.20038 | Reg=0.00268 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.381 | L2-Norm(final)=3.439 | 3727.9 samples/s | 58.2 steps/s
[Step=36050 Epoch=341.6] | Loss=0.00929 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.343 | L2-Norm(final)=3.442 | 3232.2 samples/s | 50.5 steps/s
[Step=36100 Epoch=342.1] | Loss=0.00467 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.336 | L2-Norm(final)=3.442 | 4260.9 samples/s | 66.6 steps/s
[Step=36150 Epoch=342.6] | Loss=0.00313 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.331 | L2-Norm(final)=3.442 | 1556.0 samples/s | 24.3 steps/s
[Step=36200 Epoch=343.0] | Loss=0.00235 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.329 | L2-Norm(final)=3.442 | 3965.8 samples/s | 62.0 steps/s
[Step=36250 Epoch=343.5] | Loss=0.00189 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.326 | L2-Norm(final)=3.442 | 1554.9 samples/s | 24.3 steps/s
[Step=36300 Epoch=344.0] | Loss=0.00158 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.324 | L2-Norm(final)=3.442 | 3739.0 samples/s | 58.4 steps/s
[Step=36350 Epoch=344.4] | Loss=0.00136 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.323 | L2-Norm(final)=3.442 | 1578.2 samples/s | 24.7 steps/s
[Step=36400 Epoch=344.9] | Loss=0.00119 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.321 | L2-Norm(final)=3.442 | 3613.0 samples/s | 56.5 steps/s
[Step=36450 Epoch=345.4] | Loss=0.00106 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.320 | L2-Norm(final)=3.443 | 1625.8 samples/s | 25.4 steps/s
[Step=36500 Epoch=345.9] | Loss=0.00095 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.319 | L2-Norm(final)=3.443 | 3451.7 samples/s | 53.9 steps/s
[Step=36550 Epoch=346.3] | Loss=0.00087 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.318 | L2-Norm(final)=3.443 | 1704.3 samples/s | 26.6 steps/s
[Step=36600 Epoch=346.8] | Loss=0.00080 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.317 | L2-Norm(final)=3.443 | 3454.5 samples/s | 54.0 steps/s
[Step=36650 Epoch=347.3] | Loss=0.00074 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.316 | L2-Norm(final)=3.443 | 1712.5 samples/s | 26.8 steps/s
[Step=36700 Epoch=347.8] | Loss=0.00069 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.315 | L2-Norm(final)=3.443 | 3388.5 samples/s | 52.9 steps/s
[Step=36750 Epoch=348.2] | Loss=0.00064 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.314 | L2-Norm(final)=3.443 | 1690.0 samples/s | 26.4 steps/s
[Step=36800 Epoch=348.7] | Loss=0.00060 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.313 | L2-Norm(final)=3.443 | 3349.5 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step36800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=342.5] | Loss=0.06165 | Reg=0.00268 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.381 | L2-Norm(final)=3.440 | 3551.1 samples/s | 55.5 steps/s
[Step=36050 Epoch=342.9] | Loss=0.00438 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.350 | L2-Norm(final)=3.444 | 3336.2 samples/s | 52.1 steps/s
[Step=36100 Epoch=343.4] | Loss=0.00221 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.344 | L2-Norm(final)=3.444 | 4203.8 samples/s | 65.7 steps/s
[Step=36150 Epoch=343.9] | Loss=0.00148 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.340 | L2-Norm(final)=3.444 | 1539.4 samples/s | 24.1 steps/s
[Step=36200 Epoch=344.4] | Loss=0.00112 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.337 | L2-Norm(final)=3.444 | 3987.5 samples/s | 62.3 steps/s
[Step=36250 Epoch=344.8] | Loss=0.00090 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.334 | L2-Norm(final)=3.444 | 1540.4 samples/s | 24.1 steps/s
[Step=36300 Epoch=345.3] | Loss=0.00076 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.332 | L2-Norm(final)=3.444 | 3838.7 samples/s | 60.0 steps/s
[Step=36350 Epoch=345.8] | Loss=0.00065 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.331 | L2-Norm(final)=3.445 | 1595.9 samples/s | 24.9 steps/s
[Step=36400 Epoch=346.3] | Loss=0.00057 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.329 | L2-Norm(final)=3.445 | 3622.4 samples/s | 56.6 steps/s
[Step=36450 Epoch=346.7] | Loss=0.00051 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.327 | L2-Norm(final)=3.445 | 1625.5 samples/s | 25.4 steps/s
[Step=36500 Epoch=347.2] | Loss=0.00046 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.326 | L2-Norm(final)=3.445 | 3501.3 samples/s | 54.7 steps/s
[Step=36550 Epoch=347.7] | Loss=0.00042 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.325 | L2-Norm(final)=3.445 | 1678.2 samples/s | 26.2 steps/s
[Step=36600 Epoch=348.2] | Loss=0.00039 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.324 | L2-Norm(final)=3.445 | 3354.1 samples/s | 52.4 steps/s
[Step=36650 Epoch=348.6] | Loss=0.00036 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.323 | L2-Norm(final)=3.445 | 1711.1 samples/s | 26.7 steps/s
[Step=36700 Epoch=349.1] | Loss=0.00034 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.322 | L2-Norm(final)=3.445 | 3486.3 samples/s | 54.5 steps/s
[Step=36750 Epoch=349.6] | Loss=0.00031 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.321 | L2-Norm(final)=3.445 | 1674.4 samples/s | 26.2 steps/s
[Step=36800 Epoch=350.1] | Loss=0.00030 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.320 | L2-Norm(final)=3.445 | 3350.4 samples/s | 52.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step36800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=343.8] | Loss=0.04125 | Reg=0.00268 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.381 | L2-Norm(final)=3.440 | 3490.7 samples/s | 54.5 steps/s
[Step=36050 Epoch=344.3] | Loss=0.00494 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.346 | L2-Norm(final)=3.443 | 3299.1 samples/s | 51.5 steps/s
[Step=36100 Epoch=344.7] | Loss=0.00249 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.339 | L2-Norm(final)=3.444 | 4212.6 samples/s | 65.8 steps/s
[Step=36150 Epoch=345.2] | Loss=0.00167 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.335 | L2-Norm(final)=3.444 | 1521.9 samples/s | 23.8 steps/s
[Step=36200 Epoch=345.7] | Loss=0.00126 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.332 | L2-Norm(final)=3.444 | 4094.5 samples/s | 64.0 steps/s
[Step=36250 Epoch=346.2] | Loss=0.00101 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.330 | L2-Norm(final)=3.444 | 1564.3 samples/s | 24.4 steps/s
[Step=36300 Epoch=346.6] | Loss=0.00084 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.328 | L2-Norm(final)=3.444 | 3956.9 samples/s | 61.8 steps/s
[Step=36350 Epoch=347.1] | Loss=0.00073 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.326 | L2-Norm(final)=3.444 | 1585.9 samples/s | 24.8 steps/s
[Step=36400 Epoch=347.6] | Loss=0.00064 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.325 | L2-Norm(final)=3.444 | 3679.0 samples/s | 57.5 steps/s
[Step=36450 Epoch=348.1] | Loss=0.00057 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.323 | L2-Norm(final)=3.444 | 1628.5 samples/s | 25.4 steps/s
[Step=36500 Epoch=348.6] | Loss=0.00051 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.322 | L2-Norm(final)=3.444 | 3486.1 samples/s | 54.5 steps/s
[Step=36550 Epoch=349.0] | Loss=0.00047 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.321 | L2-Norm(final)=3.444 | 1626.4 samples/s | 25.4 steps/s
[Step=36600 Epoch=349.5] | Loss=0.00043 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.320 | L2-Norm(final)=3.444 | 3423.3 samples/s | 53.5 steps/s
[Step=36650 Epoch=350.0] | Loss=0.00040 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.319 | L2-Norm(final)=3.444 | 1663.4 samples/s | 26.0 steps/s
[Step=36700 Epoch=350.5] | Loss=0.00037 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.318 | L2-Norm(final)=3.444 | 3378.2 samples/s | 52.8 steps/s
[Step=36750 Epoch=350.9] | Loss=0.00035 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.317 | L2-Norm(final)=3.444 | 1715.8 samples/s | 26.8 steps/s
[Step=36800 Epoch=351.4] | Loss=0.00033 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.316 | L2-Norm(final)=3.444 | 3343.4 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step36800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=339.2] | Loss=0.09925 | Reg=0.00268 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.381 | L2-Norm(final)=3.440 | 3551.5 samples/s | 55.5 steps/s
[Step=36050 Epoch=339.7] | Loss=0.00563 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.346 | L2-Norm(final)=3.443 | 3265.0 samples/s | 51.0 steps/s
[Step=36100 Epoch=340.2] | Loss=0.00285 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.339 | L2-Norm(final)=3.443 | 4224.8 samples/s | 66.0 steps/s
[Step=36150 Epoch=340.6] | Loss=0.00191 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.335 | L2-Norm(final)=3.444 | 1517.8 samples/s | 23.7 steps/s
[Step=36200 Epoch=341.1] | Loss=0.00144 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.332 | L2-Norm(final)=3.444 | 3892.5 samples/s | 60.8 steps/s
[Step=36250 Epoch=341.6] | Loss=0.00116 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.330 | L2-Norm(final)=3.444 | 1584.0 samples/s | 24.8 steps/s
[Step=36300 Epoch=342.0] | Loss=0.00097 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.328 | L2-Norm(final)=3.444 | 3765.9 samples/s | 58.8 steps/s
[Step=36350 Epoch=342.5] | Loss=0.00084 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.326 | L2-Norm(final)=3.444 | 1622.6 samples/s | 25.4 steps/s
[Step=36400 Epoch=343.0] | Loss=0.00073 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.325 | L2-Norm(final)=3.444 | 3451.6 samples/s | 53.9 steps/s
[Step=36450 Epoch=343.5] | Loss=0.00066 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.324 | L2-Norm(final)=3.444 | 1659.1 samples/s | 25.9 steps/s
[Step=36500 Epoch=343.9] | Loss=0.00059 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.323 | L2-Norm(final)=3.444 | 3373.3 samples/s | 52.7 steps/s
[Step=36550 Epoch=344.4] | Loss=0.00054 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.321 | L2-Norm(final)=3.444 | 1672.7 samples/s | 26.1 steps/s
[Step=36600 Epoch=344.9] | Loss=0.00050 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.320 | L2-Norm(final)=3.444 | 3403.0 samples/s | 53.2 steps/s
[Step=36650 Epoch=345.3] | Loss=0.00046 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.319 | L2-Norm(final)=3.444 | 1678.4 samples/s | 26.2 steps/s
[Step=36700 Epoch=345.8] | Loss=0.00043 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.319 | L2-Norm(final)=3.444 | 3291.0 samples/s | 51.4 steps/s
[Step=36750 Epoch=346.3] | Loss=0.00040 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.318 | L2-Norm(final)=3.444 | 1719.3 samples/s | 26.9 steps/s
[Step=36800 Epoch=346.8] | Loss=0.00038 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.317 | L2-Norm(final)=3.444 | 3308.7 samples/s | 51.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step36800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=343.1] | Loss=0.12506 | Reg=0.00268 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.381 | L2-Norm(final)=3.440 | 3700.3 samples/s | 57.8 steps/s
[Step=36050 Epoch=343.6] | Loss=0.00551 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.349 | L2-Norm(final)=3.443 | 3257.0 samples/s | 50.9 steps/s
[Step=36100 Epoch=344.1] | Loss=0.00280 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.342 | L2-Norm(final)=3.445 | 4266.3 samples/s | 66.7 steps/s
[Step=36150 Epoch=344.5] | Loss=0.00188 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.338 | L2-Norm(final)=3.445 | 1522.0 samples/s | 23.8 steps/s
[Step=36200 Epoch=345.0] | Loss=0.00142 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.335 | L2-Norm(final)=3.445 | 4071.4 samples/s | 63.6 steps/s
[Step=36250 Epoch=345.5] | Loss=0.00115 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.332 | L2-Norm(final)=3.445 | 1533.9 samples/s | 24.0 steps/s
[Step=36300 Epoch=346.0] | Loss=0.00096 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.331 | L2-Norm(final)=3.445 | 3884.3 samples/s | 60.7 steps/s
[Step=36350 Epoch=346.4] | Loss=0.00083 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.329 | L2-Norm(final)=3.446 | 1585.6 samples/s | 24.8 steps/s
[Step=36400 Epoch=346.9] | Loss=0.00073 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.327 | L2-Norm(final)=3.446 | 3677.0 samples/s | 57.5 steps/s
[Step=36450 Epoch=347.4] | Loss=0.00065 | Reg=0.00267 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.326 | L2-Norm(final)=3.446 | 1618.1 samples/s | 25.3 steps/s
[Step=36500 Epoch=347.9] | Loss=0.00059 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.325 | L2-Norm(final)=3.446 | 3591.2 samples/s | 56.1 steps/s
[Step=36550 Epoch=348.4] | Loss=0.00054 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.324 | L2-Norm(final)=3.446 | 1615.1 samples/s | 25.2 steps/s
[Step=36600 Epoch=348.8] | Loss=0.00049 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.323 | L2-Norm(final)=3.446 | 3490.9 samples/s | 54.5 steps/s
[Step=36650 Epoch=349.3] | Loss=0.00046 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.322 | L2-Norm(final)=3.446 | 1672.7 samples/s | 26.1 steps/s
[Step=36700 Epoch=349.8] | Loss=0.00043 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.321 | L2-Norm(final)=3.446 | 3369.6 samples/s | 52.6 steps/s
[Step=36750 Epoch=350.3] | Loss=0.00040 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.320 | L2-Norm(final)=3.446 | 1642.4 samples/s | 25.7 steps/s
[Step=36800 Epoch=350.7] | Loss=0.00038 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.319 | L2-Norm(final)=3.446 | 3347.7 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22254 | acc=0.8920 | tpr=0.8501 | fpr=0.0168 | 3654.1 samples/s | 14.3 steps/s
Avg test loss: 0.22471, Avg test acc: 0.89154, Avg tpr: 0.84962, Avg fpr: 0.01628, total FA: 127

Testing server on iccad2012
[Step=  50] | Loss=0.43598 | acc=0.8799 | tpr=0.9602 | fpr=0.1215 | 3654.9 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.44481 | acc=0.8782 | tpr=0.9616 | fpr=0.1234 | 6987.8 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.45060 | acc=0.8773 | tpr=0.9640 | fpr=0.1243 | 6776.7 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.45149 | acc=0.8780 | tpr=0.9639 | fpr=0.1235 | 7104.1 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.44980 | acc=0.8782 | tpr=0.9659 | fpr=0.1234 | 6819.7 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.44855 | acc=0.8788 | tpr=0.9615 | fpr=0.1227 | 6960.6 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.45119 | acc=0.8789 | tpr=0.9587 | fpr=0.1225 | 7139.7 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.45210 | acc=0.8790 | tpr=0.9557 | fpr=0.1224 | 6711.3 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.45640 | acc=0.8784 | tpr=0.9562 | fpr=0.1231 | 6703.6 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.45696 | acc=0.8783 | tpr=0.9581 | fpr=0.1231 | 6887.6 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.45616 | acc=0.8786 | tpr=0.9602 | fpr=0.1229 | 12219.2 samples/s | 47.7 steps/s
Avg test loss: 0.45595, Avg test acc: 0.87860, Avg tpr: 0.96038, Avg fpr: 0.12288, total FA: 17062

server round 46/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.4] | Loss=0.02533 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.324 | L2-Norm(final)=3.452 | 3510.2 samples/s | 54.8 steps/s
[Step=36850 Epoch=179.7] | Loss=0.01788 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.314 | L2-Norm(final)=3.450 | 3496.7 samples/s | 54.6 steps/s
[Step=36900 Epoch=179.9] | Loss=0.01276 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.310 | L2-Norm(final)=3.450 | 3497.1 samples/s | 54.6 steps/s
[Step=36950 Epoch=180.2] | Loss=0.01000 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.307 | L2-Norm(final)=3.451 | 3437.3 samples/s | 53.7 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00878 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.305 | L2-Norm(final)=3.451 | 4343.7 samples/s | 67.9 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00774 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.304 | L2-Norm(final)=3.452 | 1569.5 samples/s | 24.5 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00696 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.302 | L2-Norm(final)=3.452 | 3575.4 samples/s | 55.9 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00649 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.302 | L2-Norm(final)=3.453 | 3485.7 samples/s | 54.5 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00599 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.301 | L2-Norm(final)=3.454 | 4107.8 samples/s | 64.2 steps/s
[Step=37250 Epoch=181.6] | Loss=0.00570 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.300 | L2-Norm(final)=3.455 | 1551.8 samples/s | 24.2 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00534 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.300 | L2-Norm(final)=3.455 | 3465.9 samples/s | 54.2 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00505 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=3.456 | 3538.0 samples/s | 55.3 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00485 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=3.457 | 3910.2 samples/s | 61.1 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00474 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.298 | L2-Norm(final)=3.457 | 1636.6 samples/s | 25.6 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00465 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.298 | L2-Norm(final)=3.458 | 3592.0 samples/s | 56.1 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00445 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.298 | L2-Norm(final)=3.459 | 3570.9 samples/s | 55.8 steps/s
[Step=37600 Epoch=183.3] | Loss=0.00436 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.297 | L2-Norm(final)=3.460 | 3788.3 samples/s | 59.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step37600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.6] | Loss=0.02151 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.324 | L2-Norm(final)=3.452 | 3578.3 samples/s | 55.9 steps/s
[Step=36850 Epoch=179.8] | Loss=0.01582 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.313 | L2-Norm(final)=3.450 | 3487.9 samples/s | 54.5 steps/s
[Step=36900 Epoch=180.1] | Loss=0.01014 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.310 | L2-Norm(final)=3.451 | 3502.0 samples/s | 54.7 steps/s
[Step=36950 Epoch=180.3] | Loss=0.00821 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.307 | L2-Norm(final)=3.452 | 3526.5 samples/s | 55.1 steps/s
[Step=37000 Epoch=180.5] | Loss=0.00756 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.306 | L2-Norm(final)=3.452 | 4323.5 samples/s | 67.6 steps/s
[Step=37050 Epoch=180.8] | Loss=0.00712 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.304 | L2-Norm(final)=3.453 | 1568.9 samples/s | 24.5 steps/s
[Step=37100 Epoch=181.0] | Loss=0.00625 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.303 | L2-Norm(final)=3.453 | 3491.3 samples/s | 54.6 steps/s
[Step=37150 Epoch=181.3] | Loss=0.00565 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.302 | L2-Norm(final)=3.454 | 3552.6 samples/s | 55.5 steps/s
[Step=37200 Epoch=181.5] | Loss=0.00528 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.301 | L2-Norm(final)=3.455 | 4202.2 samples/s | 65.7 steps/s
[Step=37250 Epoch=181.8] | Loss=0.00492 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.301 | L2-Norm(final)=3.455 | 1571.6 samples/s | 24.6 steps/s
[Step=37300 Epoch=182.0] | Loss=0.00456 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.300 | L2-Norm(final)=3.456 | 3505.6 samples/s | 54.8 steps/s
[Step=37350 Epoch=182.3] | Loss=0.00441 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=3.457 | 3543.7 samples/s | 55.4 steps/s
[Step=37400 Epoch=182.5] | Loss=0.00423 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=3.458 | 3990.4 samples/s | 62.4 steps/s
[Step=37450 Epoch=182.7] | Loss=0.00412 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=3.458 | 1610.4 samples/s | 25.2 steps/s
[Step=37500 Epoch=183.0] | Loss=0.00404 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.298 | L2-Norm(final)=3.459 | 3523.5 samples/s | 55.1 steps/s
[Step=37550 Epoch=183.2] | Loss=0.00384 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.298 | L2-Norm(final)=3.460 | 3487.4 samples/s | 54.5 steps/s
[Step=37600 Epoch=183.5] | Loss=0.00374 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.297 | L2-Norm(final)=3.460 | 3941.1 samples/s | 61.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step37600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.3] | Loss=0.04332 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.324 | L2-Norm(final)=3.452 | 3988.4 samples/s | 62.3 steps/s
[Step=36850 Epoch=179.6] | Loss=0.01583 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.314 | L2-Norm(final)=3.450 | 3396.5 samples/s | 53.1 steps/s
[Step=36900 Epoch=179.8] | Loss=0.01110 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.309 | L2-Norm(final)=3.450 | 3769.8 samples/s | 58.9 steps/s
[Step=36950 Epoch=180.0] | Loss=0.00930 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.307 | L2-Norm(final)=3.451 | 3610.4 samples/s | 56.4 steps/s
[Step=37000 Epoch=180.3] | Loss=0.00837 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.305 | L2-Norm(final)=3.452 | 4355.0 samples/s | 68.0 steps/s
[Step=37050 Epoch=180.5] | Loss=0.00716 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.304 | L2-Norm(final)=3.452 | 1576.6 samples/s | 24.6 steps/s
[Step=37100 Epoch=180.8] | Loss=0.00656 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.303 | L2-Norm(final)=3.453 | 3592.6 samples/s | 56.1 steps/s
[Step=37150 Epoch=181.0] | Loss=0.00598 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.302 | L2-Norm(final)=3.454 | 3503.9 samples/s | 54.7 steps/s
[Step=37200 Epoch=181.3] | Loss=0.00567 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.302 | L2-Norm(final)=3.455 | 4083.4 samples/s | 63.8 steps/s
[Step=37250 Epoch=181.5] | Loss=0.00527 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.301 | L2-Norm(final)=3.456 | 1595.8 samples/s | 24.9 steps/s
[Step=37300 Epoch=181.7] | Loss=0.00502 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.300 | L2-Norm(final)=3.457 | 3490.0 samples/s | 54.5 steps/s
[Step=37350 Epoch=182.0] | Loss=0.00481 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.300 | L2-Norm(final)=3.458 | 3556.6 samples/s | 55.6 steps/s
[Step=37400 Epoch=182.2] | Loss=0.00460 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.300 | L2-Norm(final)=3.459 | 4007.9 samples/s | 62.6 steps/s
[Step=37450 Epoch=182.5] | Loss=0.00442 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=3.460 | 1658.8 samples/s | 25.9 steps/s
[Step=37500 Epoch=182.7] | Loss=0.00419 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=3.461 | 3653.4 samples/s | 57.1 steps/s
[Step=37550 Epoch=183.0] | Loss=0.00404 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=3.461 | 3503.6 samples/s | 54.7 steps/s
[Step=37600 Epoch=183.2] | Loss=0.00398 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=3.462 | 3795.8 samples/s | 59.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step37600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.5] | Loss=0.12982 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.324 | L2-Norm(final)=3.452 | 3669.9 samples/s | 57.3 steps/s
[Step=36850 Epoch=179.7] | Loss=0.01575 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.314 | L2-Norm(final)=3.450 | 3487.4 samples/s | 54.5 steps/s
[Step=36900 Epoch=179.9] | Loss=0.01010 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.310 | L2-Norm(final)=3.450 | 3561.9 samples/s | 55.7 steps/s
[Step=36950 Epoch=180.2] | Loss=0.00830 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.308 | L2-Norm(final)=3.451 | 3523.5 samples/s | 55.1 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00737 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.307 | L2-Norm(final)=3.452 | 4416.6 samples/s | 69.0 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00642 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.306 | L2-Norm(final)=3.453 | 1585.5 samples/s | 24.8 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00588 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.305 | L2-Norm(final)=3.453 | 3501.3 samples/s | 54.7 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00532 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.304 | L2-Norm(final)=3.454 | 3513.8 samples/s | 54.9 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00504 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.303 | L2-Norm(final)=3.455 | 4145.0 samples/s | 64.8 steps/s
[Step=37250 Epoch=181.7] | Loss=0.00482 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.303 | L2-Norm(final)=3.456 | 1635.2 samples/s | 25.5 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00450 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.302 | L2-Norm(final)=3.457 | 3551.1 samples/s | 55.5 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00431 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.302 | L2-Norm(final)=3.458 | 3571.0 samples/s | 55.8 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00413 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.301 | L2-Norm(final)=3.458 | 3946.7 samples/s | 61.7 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00398 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.301 | L2-Norm(final)=3.459 | 1659.0 samples/s | 25.9 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00380 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.300 | L2-Norm(final)=3.460 | 3584.8 samples/s | 56.0 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00369 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.300 | L2-Norm(final)=3.461 | 3497.4 samples/s | 54.6 steps/s
[Step=37600 Epoch=183.4] | Loss=0.00357 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.300 | L2-Norm(final)=3.462 | 3862.8 samples/s | 60.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step37600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=180.5] | Loss=0.11592 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=16.324 | L2-Norm(final)=3.452 | 3537.2 samples/s | 55.3 steps/s
[Step=36850 Epoch=180.7] | Loss=0.01764 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.314 | L2-Norm(final)=3.450 | 3483.0 samples/s | 54.4 steps/s
[Step=36900 Epoch=181.0] | Loss=0.01194 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.310 | L2-Norm(final)=3.450 | 3507.5 samples/s | 54.8 steps/s
[Step=36950 Epoch=181.2] | Loss=0.01002 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.308 | L2-Norm(final)=3.451 | 3472.3 samples/s | 54.3 steps/s
[Step=37000 Epoch=181.4] | Loss=0.00859 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.306 | L2-Norm(final)=3.451 | 4322.1 samples/s | 67.5 steps/s
[Step=37050 Epoch=181.7] | Loss=0.00757 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.305 | L2-Norm(final)=3.452 | 1567.1 samples/s | 24.5 steps/s
[Step=37100 Epoch=181.9] | Loss=0.00664 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.304 | L2-Norm(final)=3.452 | 3516.4 samples/s | 54.9 steps/s
[Step=37150 Epoch=182.2] | Loss=0.00619 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.303 | L2-Norm(final)=3.453 | 3607.1 samples/s | 56.4 steps/s
[Step=37200 Epoch=182.4] | Loss=0.00579 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.302 | L2-Norm(final)=3.454 | 4393.2 samples/s | 68.6 steps/s
[Step=37250 Epoch=182.7] | Loss=0.00535 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.302 | L2-Norm(final)=3.454 | 1585.2 samples/s | 24.8 steps/s
[Step=37300 Epoch=182.9] | Loss=0.00500 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.301 | L2-Norm(final)=3.455 | 3630.0 samples/s | 56.7 steps/s
[Step=37350 Epoch=183.2] | Loss=0.00476 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.300 | L2-Norm(final)=3.456 | 3525.3 samples/s | 55.1 steps/s
[Step=37400 Epoch=183.4] | Loss=0.00463 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.300 | L2-Norm(final)=3.457 | 4045.1 samples/s | 63.2 steps/s
[Step=37450 Epoch=183.6] | Loss=0.00446 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.300 | L2-Norm(final)=3.458 | 1640.0 samples/s | 25.6 steps/s
[Step=37500 Epoch=183.9] | Loss=0.00426 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=3.458 | 3618.2 samples/s | 56.5 steps/s
[Step=37550 Epoch=184.1] | Loss=0.00413 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=3.459 | 3472.6 samples/s | 54.3 steps/s
[Step=37600 Epoch=184.4] | Loss=0.00400 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=3.460 | 4054.2 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step37600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=348.7] | Loss=0.00341 | Reg=0.00266 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.324 | L2-Norm(final)=3.452 | 3777.7 samples/s | 59.0 steps/s
[Step=36850 Epoch=349.2] | Loss=0.00488 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.290 | L2-Norm(final)=3.456 | 3301.1 samples/s | 51.6 steps/s
[Step=36900 Epoch=349.7] | Loss=0.00246 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.282 | L2-Norm(final)=3.456 | 4330.6 samples/s | 67.7 steps/s
[Step=36950 Epoch=350.1] | Loss=0.00165 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.278 | L2-Norm(final)=3.456 | 1527.6 samples/s | 23.9 steps/s
[Step=37000 Epoch=350.6] | Loss=0.00125 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.275 | L2-Norm(final)=3.457 | 4049.8 samples/s | 63.3 steps/s
[Step=37050 Epoch=351.1] | Loss=0.00100 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.273 | L2-Norm(final)=3.457 | 1537.0 samples/s | 24.0 steps/s
[Step=37100 Epoch=351.6] | Loss=0.00084 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.271 | L2-Norm(final)=3.457 | 3710.8 samples/s | 58.0 steps/s
[Step=37150 Epoch=352.0] | Loss=0.00072 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.269 | L2-Norm(final)=3.457 | 1609.8 samples/s | 25.2 steps/s
[Step=37200 Epoch=352.5] | Loss=0.00063 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.268 | L2-Norm(final)=3.457 | 3597.7 samples/s | 56.2 steps/s
[Step=37250 Epoch=353.0] | Loss=0.00057 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.266 | L2-Norm(final)=3.457 | 1640.7 samples/s | 25.6 steps/s
[Step=37300 Epoch=353.4] | Loss=0.00051 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.265 | L2-Norm(final)=3.457 | 3349.9 samples/s | 52.3 steps/s
[Step=37350 Epoch=353.9] | Loss=0.00047 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.264 | L2-Norm(final)=3.457 | 1665.6 samples/s | 26.0 steps/s
[Step=37400 Epoch=354.4] | Loss=0.00043 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.263 | L2-Norm(final)=3.457 | 3360.0 samples/s | 52.5 steps/s
[Step=37450 Epoch=354.9] | Loss=0.00040 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.262 | L2-Norm(final)=3.457 | 1653.3 samples/s | 25.8 steps/s
[Step=37500 Epoch=355.3] | Loss=0.00037 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.261 | L2-Norm(final)=3.457 | 3327.1 samples/s | 52.0 steps/s
[Step=37550 Epoch=355.8] | Loss=0.00035 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.260 | L2-Norm(final)=3.457 | 1692.6 samples/s | 26.4 steps/s
[Step=37600 Epoch=356.3] | Loss=0.00033 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.259 | L2-Norm(final)=3.457 | 3347.4 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step37600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=350.1] | Loss=0.10642 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.324 | L2-Norm(final)=3.452 | 3676.1 samples/s | 57.4 steps/s
[Step=36850 Epoch=350.5] | Loss=0.00578 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.293 | L2-Norm(final)=3.455 | 3256.6 samples/s | 50.9 steps/s
[Step=36900 Epoch=351.0] | Loss=0.00292 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.286 | L2-Norm(final)=3.456 | 4274.3 samples/s | 66.8 steps/s
[Step=36950 Epoch=351.5] | Loss=0.00195 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.282 | L2-Norm(final)=3.456 | 1567.0 samples/s | 24.5 steps/s
[Step=37000 Epoch=352.0] | Loss=0.00147 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.279 | L2-Norm(final)=3.456 | 3995.5 samples/s | 62.4 steps/s
[Step=37050 Epoch=352.4] | Loss=0.00119 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.277 | L2-Norm(final)=3.456 | 1552.9 samples/s | 24.3 steps/s
[Step=37100 Epoch=352.9] | Loss=0.00099 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.275 | L2-Norm(final)=3.456 | 3828.9 samples/s | 59.8 steps/s
[Step=37150 Epoch=353.4] | Loss=0.00085 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.273 | L2-Norm(final)=3.456 | 1593.4 samples/s | 24.9 steps/s
[Step=37200 Epoch=353.9] | Loss=0.00075 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.272 | L2-Norm(final)=3.456 | 3600.8 samples/s | 56.3 steps/s
[Step=37250 Epoch=354.3] | Loss=0.00067 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.270 | L2-Norm(final)=3.456 | 1648.4 samples/s | 25.8 steps/s
[Step=37300 Epoch=354.8] | Loss=0.00060 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.269 | L2-Norm(final)=3.456 | 3418.9 samples/s | 53.4 steps/s
[Step=37350 Epoch=355.3] | Loss=0.00055 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.268 | L2-Norm(final)=3.457 | 1658.0 samples/s | 25.9 steps/s
[Step=37400 Epoch=355.8] | Loss=0.00051 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.267 | L2-Norm(final)=3.457 | 3363.7 samples/s | 52.6 steps/s
[Step=37450 Epoch=356.2] | Loss=0.00047 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.266 | L2-Norm(final)=3.457 | 1673.4 samples/s | 26.1 steps/s
[Step=37500 Epoch=356.7] | Loss=0.00044 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.265 | L2-Norm(final)=3.457 | 3413.0 samples/s | 53.3 steps/s
[Step=37550 Epoch=357.2] | Loss=0.00041 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.264 | L2-Norm(final)=3.457 | 1659.7 samples/s | 25.9 steps/s
[Step=37600 Epoch=357.7] | Loss=0.00038 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.263 | L2-Norm(final)=3.457 | 3284.5 samples/s | 51.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step37600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=351.4] | Loss=0.15391 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=16.324 | L2-Norm(final)=3.452 | 3463.4 samples/s | 54.1 steps/s
[Step=36850 Epoch=351.9] | Loss=0.00552 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.293 | L2-Norm(final)=3.456 | 3479.3 samples/s | 54.4 steps/s
[Step=36900 Epoch=352.4] | Loss=0.00279 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.286 | L2-Norm(final)=3.456 | 4467.5 samples/s | 69.8 steps/s
[Step=36950 Epoch=352.8] | Loss=0.00187 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.282 | L2-Norm(final)=3.457 | 1523.9 samples/s | 23.8 steps/s
[Step=37000 Epoch=353.3] | Loss=0.00141 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.280 | L2-Norm(final)=3.457 | 4063.4 samples/s | 63.5 steps/s
[Step=37050 Epoch=353.8] | Loss=0.00113 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.277 | L2-Norm(final)=3.457 | 1551.0 samples/s | 24.2 steps/s
[Step=37100 Epoch=354.3] | Loss=0.00095 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.275 | L2-Norm(final)=3.457 | 3867.8 samples/s | 60.4 steps/s
[Step=37150 Epoch=354.8] | Loss=0.00081 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.273 | L2-Norm(final)=3.457 | 1609.8 samples/s | 25.2 steps/s
[Step=37200 Epoch=355.2] | Loss=0.00071 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.272 | L2-Norm(final)=3.457 | 3647.2 samples/s | 57.0 steps/s
[Step=37250 Epoch=355.7] | Loss=0.00064 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.270 | L2-Norm(final)=3.457 | 1635.4 samples/s | 25.6 steps/s
[Step=37300 Epoch=356.2] | Loss=0.00057 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.269 | L2-Norm(final)=3.457 | 3486.3 samples/s | 54.5 steps/s
[Step=37350 Epoch=356.7] | Loss=0.00052 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.268 | L2-Norm(final)=3.457 | 1604.1 samples/s | 25.1 steps/s
[Step=37400 Epoch=357.1] | Loss=0.00048 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.267 | L2-Norm(final)=3.457 | 3387.9 samples/s | 52.9 steps/s
[Step=37450 Epoch=357.6] | Loss=0.00045 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.266 | L2-Norm(final)=3.457 | 1643.4 samples/s | 25.7 steps/s
[Step=37500 Epoch=358.1] | Loss=0.00041 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.265 | L2-Norm(final)=3.457 | 3434.7 samples/s | 53.7 steps/s
[Step=37550 Epoch=358.6] | Loss=0.00039 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.264 | L2-Norm(final)=3.457 | 1666.8 samples/s | 26.0 steps/s
[Step=37600 Epoch=359.1] | Loss=0.00036 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.263 | L2-Norm(final)=3.457 | 3299.7 samples/s | 51.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step37600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=346.8] | Loss=0.09032 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.324 | L2-Norm(final)=3.452 | 3535.4 samples/s | 55.2 steps/s
[Step=36850 Epoch=347.2] | Loss=0.00433 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.291 | L2-Norm(final)=3.456 | 3188.8 samples/s | 49.8 steps/s
[Step=36900 Epoch=347.7] | Loss=0.00221 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.284 | L2-Norm(final)=3.457 | 4195.9 samples/s | 65.6 steps/s
[Step=36950 Epoch=348.2] | Loss=0.00149 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.280 | L2-Norm(final)=3.457 | 1501.4 samples/s | 23.5 steps/s
[Step=37000 Epoch=348.6] | Loss=0.00113 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.277 | L2-Norm(final)=3.457 | 3904.5 samples/s | 61.0 steps/s
[Step=37050 Epoch=349.1] | Loss=0.00091 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.275 | L2-Norm(final)=3.457 | 1582.2 samples/s | 24.7 steps/s
[Step=37100 Epoch=349.6] | Loss=0.00076 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.273 | L2-Norm(final)=3.458 | 3657.4 samples/s | 57.1 steps/s
[Step=37150 Epoch=350.1] | Loss=0.00066 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.272 | L2-Norm(final)=3.458 | 1600.9 samples/s | 25.0 steps/s
[Step=37200 Epoch=350.5] | Loss=0.00058 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.270 | L2-Norm(final)=3.458 | 3467.9 samples/s | 54.2 steps/s
[Step=37250 Epoch=351.0] | Loss=0.00052 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.269 | L2-Norm(final)=3.458 | 1622.6 samples/s | 25.4 steps/s
[Step=37300 Epoch=351.5] | Loss=0.00047 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.268 | L2-Norm(final)=3.458 | 3322.8 samples/s | 51.9 steps/s
[Step=37350 Epoch=351.9] | Loss=0.00043 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.267 | L2-Norm(final)=3.458 | 1660.3 samples/s | 25.9 steps/s
[Step=37400 Epoch=352.4] | Loss=0.00039 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.265 | L2-Norm(final)=3.458 | 3346.5 samples/s | 52.3 steps/s
[Step=37450 Epoch=352.9] | Loss=0.00037 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.264 | L2-Norm(final)=3.458 | 1667.5 samples/s | 26.1 steps/s
[Step=37500 Epoch=353.4] | Loss=0.00034 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.264 | L2-Norm(final)=3.458 | 3394.0 samples/s | 53.0 steps/s
[Step=37550 Epoch=353.8] | Loss=0.00032 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.263 | L2-Norm(final)=3.458 | 1763.2 samples/s | 27.6 steps/s
[Step=37600 Epoch=354.3] | Loss=0.00030 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.262 | L2-Norm(final)=3.458 | 3129.0 samples/s | 48.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step37600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=350.7] | Loss=0.10142 | Reg=0.00266 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.324 | L2-Norm(final)=3.452 | 3423.2 samples/s | 53.5 steps/s
[Step=36850 Epoch=351.2] | Loss=0.00618 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.290 | L2-Norm(final)=3.455 | 3283.6 samples/s | 51.3 steps/s
[Step=36900 Epoch=351.7] | Loss=0.00313 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.284 | L2-Norm(final)=3.456 | 4257.4 samples/s | 66.5 steps/s
[Step=36950 Epoch=352.2] | Loss=0.00210 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.280 | L2-Norm(final)=3.456 | 1515.2 samples/s | 23.7 steps/s
[Step=37000 Epoch=352.6] | Loss=0.00159 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.277 | L2-Norm(final)=3.456 | 4051.0 samples/s | 63.3 steps/s
[Step=37050 Epoch=353.1] | Loss=0.00128 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.275 | L2-Norm(final)=3.456 | 1534.5 samples/s | 24.0 steps/s
[Step=37100 Epoch=353.6] | Loss=0.00107 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.273 | L2-Norm(final)=3.456 | 3832.0 samples/s | 59.9 steps/s
[Step=37150 Epoch=354.1] | Loss=0.00092 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.271 | L2-Norm(final)=3.456 | 1549.4 samples/s | 24.2 steps/s
[Step=37200 Epoch=354.5] | Loss=0.00081 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.270 | L2-Norm(final)=3.456 | 3699.4 samples/s | 57.8 steps/s
[Step=37250 Epoch=355.0] | Loss=0.00072 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.269 | L2-Norm(final)=3.456 | 1625.0 samples/s | 25.4 steps/s
[Step=37300 Epoch=355.5] | Loss=0.00065 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.268 | L2-Norm(final)=3.456 | 3600.0 samples/s | 56.3 steps/s
[Step=37350 Epoch=356.0] | Loss=0.00059 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.266 | L2-Norm(final)=3.456 | 1671.7 samples/s | 26.1 steps/s
[Step=37400 Epoch=356.5] | Loss=0.00055 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.265 | L2-Norm(final)=3.456 | 3472.2 samples/s | 54.3 steps/s
[Step=37450 Epoch=356.9] | Loss=0.00051 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.265 | L2-Norm(final)=3.456 | 1654.2 samples/s | 25.8 steps/s
[Step=37500 Epoch=357.4] | Loss=0.00047 | Reg=0.00265 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.264 | L2-Norm(final)=3.457 | 3408.9 samples/s | 53.3 steps/s
[Step=37550 Epoch=357.9] | Loss=0.00044 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.263 | L2-Norm(final)=3.457 | 1692.4 samples/s | 26.4 steps/s
[Step=37600 Epoch=358.4] | Loss=0.00041 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.262 | L2-Norm(final)=3.457 | 3488.0 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21966 | acc=0.8936 | tpr=0.8524 | fpr=0.0168 | 3727.4 samples/s | 14.6 steps/s
Avg test loss: 0.22180, Avg test acc: 0.89314, Avg tpr: 0.85196, Avg fpr: 0.01628, total FA: 127

Testing server on iccad2012
[Step=  50] | Loss=0.43746 | acc=0.8801 | tpr=0.9602 | fpr=0.1214 | 3701.3 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.44646 | acc=0.8778 | tpr=0.9616 | fpr=0.1238 | 6553.2 samples/s | 25.6 steps/s
[Step= 150] | Loss=0.45237 | acc=0.8765 | tpr=0.9640 | fpr=0.1251 | 7090.2 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.45311 | acc=0.8774 | tpr=0.9639 | fpr=0.1242 | 6837.3 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.45163 | acc=0.8775 | tpr=0.9659 | fpr=0.1241 | 6722.0 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.45032 | acc=0.8780 | tpr=0.9615 | fpr=0.1235 | 6971.9 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.45296 | acc=0.8782 | tpr=0.9587 | fpr=0.1233 | 7068.7 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.45380 | acc=0.8783 | tpr=0.9562 | fpr=0.1231 | 7037.8 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.45809 | acc=0.8777 | tpr=0.9567 | fpr=0.1237 | 6737.6 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.45869 | acc=0.8777 | tpr=0.9586 | fpr=0.1238 | 6808.5 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.45792 | acc=0.8779 | tpr=0.9606 | fpr=0.1236 | 12939.8 samples/s | 50.5 steps/s
Avg test loss: 0.45770, Avg test acc: 0.87793, Avg tpr: 0.96078, Avg fpr: 0.12357, total FA: 17158

server round 47/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.3] | Loss=0.08823 | Reg=0.00265 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.268 | L2-Norm(final)=3.465 | 3681.3 samples/s | 57.5 steps/s
[Step=37650 Epoch=183.6] | Loss=0.01635 | Reg=0.00264 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.259 | L2-Norm(final)=3.463 | 3397.4 samples/s | 53.1 steps/s
[Step=37700 Epoch=183.8] | Loss=0.01215 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.254 | L2-Norm(final)=3.463 | 3483.1 samples/s | 54.4 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00986 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.252 | L2-Norm(final)=3.464 | 3519.9 samples/s | 55.0 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00843 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.250 | L2-Norm(final)=3.464 | 4384.8 samples/s | 68.5 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00742 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.248 | L2-Norm(final)=3.465 | 1558.2 samples/s | 24.3 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00655 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.247 | L2-Norm(final)=3.466 | 3506.8 samples/s | 54.8 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00615 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.246 | L2-Norm(final)=3.466 | 3542.1 samples/s | 55.3 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00579 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.246 | L2-Norm(final)=3.467 | 4116.2 samples/s | 64.3 steps/s
[Step=38050 Epoch=185.5] | Loss=0.00555 | Reg=0.00264 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.245 | L2-Norm(final)=3.468 | 1598.0 samples/s | 25.0 steps/s
[Step=38100 Epoch=185.8] | Loss=0.00536 | Reg=0.00264 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.244 | L2-Norm(final)=3.469 | 3494.6 samples/s | 54.6 steps/s
[Step=38150 Epoch=186.0] | Loss=0.00510 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.244 | L2-Norm(final)=3.469 | 3522.8 samples/s | 55.0 steps/s
[Step=38200 Epoch=186.3] | Loss=0.00487 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.243 | L2-Norm(final)=3.470 | 3999.0 samples/s | 62.5 steps/s
[Step=38250 Epoch=186.5] | Loss=0.00464 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.243 | L2-Norm(final)=3.471 | 1642.4 samples/s | 25.7 steps/s
[Step=38300 Epoch=186.8] | Loss=0.00447 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.243 | L2-Norm(final)=3.472 | 3604.2 samples/s | 56.3 steps/s
[Step=38350 Epoch=187.0] | Loss=0.00435 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.242 | L2-Norm(final)=3.472 | 3722.9 samples/s | 58.2 steps/s
[Step=38400 Epoch=187.2] | Loss=0.00426 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.242 | L2-Norm(final)=3.473 | 3765.3 samples/s | 58.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step38400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.5] | Loss=0.11949 | Reg=0.00265 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=16.268 | L2-Norm(final)=3.465 | 3716.0 samples/s | 58.1 steps/s
[Step=37650 Epoch=183.7] | Loss=0.01585 | Reg=0.00264 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.259 | L2-Norm(final)=3.462 | 3257.8 samples/s | 50.9 steps/s
[Step=37700 Epoch=184.0] | Loss=0.01082 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.255 | L2-Norm(final)=3.462 | 3515.2 samples/s | 54.9 steps/s
[Step=37750 Epoch=184.2] | Loss=0.00931 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.252 | L2-Norm(final)=3.462 | 3552.4 samples/s | 55.5 steps/s
[Step=37800 Epoch=184.4] | Loss=0.00818 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.250 | L2-Norm(final)=3.463 | 4414.4 samples/s | 69.0 steps/s
[Step=37850 Epoch=184.7] | Loss=0.00721 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.249 | L2-Norm(final)=3.463 | 1588.1 samples/s | 24.8 steps/s
[Step=37900 Epoch=184.9] | Loss=0.00639 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.247 | L2-Norm(final)=3.464 | 3637.7 samples/s | 56.8 steps/s
[Step=37950 Epoch=185.2] | Loss=0.00590 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.246 | L2-Norm(final)=3.465 | 3558.6 samples/s | 55.6 steps/s
[Step=38000 Epoch=185.4] | Loss=0.00550 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.246 | L2-Norm(final)=3.466 | 4159.2 samples/s | 65.0 steps/s
[Step=38050 Epoch=185.7] | Loss=0.00516 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.245 | L2-Norm(final)=3.466 | 1595.2 samples/s | 24.9 steps/s
[Step=38100 Epoch=185.9] | Loss=0.00479 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.244 | L2-Norm(final)=3.467 | 3516.5 samples/s | 54.9 steps/s
[Step=38150 Epoch=186.2] | Loss=0.00466 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.244 | L2-Norm(final)=3.468 | 3585.8 samples/s | 56.0 steps/s
[Step=38200 Epoch=186.4] | Loss=0.00447 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.243 | L2-Norm(final)=3.469 | 3967.0 samples/s | 62.0 steps/s
[Step=38250 Epoch=186.6] | Loss=0.00425 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.243 | L2-Norm(final)=3.469 | 1601.4 samples/s | 25.0 steps/s
[Step=38300 Epoch=186.9] | Loss=0.00411 | Reg=0.00264 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.242 | L2-Norm(final)=3.470 | 3488.6 samples/s | 54.5 steps/s
[Step=38350 Epoch=187.1] | Loss=0.00402 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.242 | L2-Norm(final)=3.471 | 3438.2 samples/s | 53.7 steps/s
[Step=38400 Epoch=187.4] | Loss=0.00393 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.241 | L2-Norm(final)=3.471 | 3846.4 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step38400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.2] | Loss=0.06364 | Reg=0.00265 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.268 | L2-Norm(final)=3.465 | 3671.5 samples/s | 57.4 steps/s
[Step=37650 Epoch=183.4] | Loss=0.01924 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.258 | L2-Norm(final)=3.462 | 3318.7 samples/s | 51.9 steps/s
[Step=37700 Epoch=183.7] | Loss=0.01265 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.253 | L2-Norm(final)=3.461 | 3491.5 samples/s | 54.6 steps/s
[Step=37750 Epoch=183.9] | Loss=0.01019 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.251 | L2-Norm(final)=3.462 | 3490.9 samples/s | 54.5 steps/s
[Step=37800 Epoch=184.2] | Loss=0.00891 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.250 | L2-Norm(final)=3.463 | 4418.9 samples/s | 69.0 steps/s
[Step=37850 Epoch=184.4] | Loss=0.00778 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.249 | L2-Norm(final)=3.463 | 1564.0 samples/s | 24.4 steps/s
[Step=37900 Epoch=184.7] | Loss=0.00690 | Reg=0.00264 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.248 | L2-Norm(final)=3.464 | 3467.6 samples/s | 54.2 steps/s
[Step=37950 Epoch=184.9] | Loss=0.00620 | Reg=0.00264 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.247 | L2-Norm(final)=3.465 | 3593.4 samples/s | 56.1 steps/s
[Step=38000 Epoch=185.2] | Loss=0.00597 | Reg=0.00264 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.246 | L2-Norm(final)=3.466 | 4140.1 samples/s | 64.7 steps/s
[Step=38050 Epoch=185.4] | Loss=0.00557 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.246 | L2-Norm(final)=3.467 | 1538.8 samples/s | 24.0 steps/s
[Step=38100 Epoch=185.6] | Loss=0.00531 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.245 | L2-Norm(final)=3.468 | 3437.5 samples/s | 53.7 steps/s
[Step=38150 Epoch=185.9] | Loss=0.00506 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.245 | L2-Norm(final)=3.469 | 3442.8 samples/s | 53.8 steps/s
[Step=38200 Epoch=186.1] | Loss=0.00483 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.245 | L2-Norm(final)=3.469 | 3842.1 samples/s | 60.0 steps/s
[Step=38250 Epoch=186.4] | Loss=0.00463 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.244 | L2-Norm(final)=3.470 | 1562.5 samples/s | 24.4 steps/s
[Step=38300 Epoch=186.6] | Loss=0.00445 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.244 | L2-Norm(final)=3.471 | 3601.4 samples/s | 56.3 steps/s
[Step=38350 Epoch=186.9] | Loss=0.00424 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.244 | L2-Norm(final)=3.472 | 3798.9 samples/s | 59.4 steps/s
[Step=38400 Epoch=187.1] | Loss=0.00414 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.244 | L2-Norm(final)=3.473 | 4015.4 samples/s | 62.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step38400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.4] | Loss=0.07009 | Reg=0.00265 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.268 | L2-Norm(final)=3.465 | 3880.9 samples/s | 60.6 steps/s
[Step=37650 Epoch=183.6] | Loss=0.01095 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.259 | L2-Norm(final)=3.463 | 3555.1 samples/s | 55.5 steps/s
[Step=37700 Epoch=183.8] | Loss=0.00913 | Reg=0.00264 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.255 | L2-Norm(final)=3.464 | 3777.4 samples/s | 59.0 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00794 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.252 | L2-Norm(final)=3.465 | 3768.7 samples/s | 58.9 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00726 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.251 | L2-Norm(final)=3.465 | 4706.3 samples/s | 73.5 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00625 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.250 | L2-Norm(final)=3.466 | 1660.7 samples/s | 25.9 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00564 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.249 | L2-Norm(final)=3.467 | 3792.5 samples/s | 59.3 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00523 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.248 | L2-Norm(final)=3.468 | 3768.4 samples/s | 58.9 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00497 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.247 | L2-Norm(final)=3.469 | 4457.6 samples/s | 69.7 steps/s
[Step=38050 Epoch=185.6] | Loss=0.00460 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.247 | L2-Norm(final)=3.469 | 1701.6 samples/s | 26.6 steps/s
[Step=38100 Epoch=185.8] | Loss=0.00441 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.246 | L2-Norm(final)=3.470 | 3794.1 samples/s | 59.3 steps/s
[Step=38150 Epoch=186.0] | Loss=0.00423 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.246 | L2-Norm(final)=3.471 | 3800.2 samples/s | 59.4 steps/s
[Step=38200 Epoch=186.3] | Loss=0.00408 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.245 | L2-Norm(final)=3.472 | 4248.0 samples/s | 66.4 steps/s
[Step=38250 Epoch=186.5] | Loss=0.00402 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.245 | L2-Norm(final)=3.473 | 1732.5 samples/s | 27.1 steps/s
[Step=38300 Epoch=186.8] | Loss=0.00384 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.245 | L2-Norm(final)=3.473 | 3779.2 samples/s | 59.1 steps/s
[Step=38350 Epoch=187.0] | Loss=0.00375 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.244 | L2-Norm(final)=3.474 | 3785.5 samples/s | 59.1 steps/s
[Step=38400 Epoch=187.3] | Loss=0.00370 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.244 | L2-Norm(final)=3.475 | 4044.2 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step38400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=184.4] | Loss=0.07307 | Reg=0.00265 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=16.268 | L2-Norm(final)=3.465 | 3787.6 samples/s | 59.2 steps/s
[Step=37650 Epoch=184.6] | Loss=0.01950 | Reg=0.00264 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.259 | L2-Norm(final)=3.462 | 3694.3 samples/s | 57.7 steps/s
[Step=37700 Epoch=184.9] | Loss=0.01314 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.254 | L2-Norm(final)=3.462 | 3798.2 samples/s | 59.3 steps/s
[Step=37750 Epoch=185.1] | Loss=0.01070 | Reg=0.00264 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.252 | L2-Norm(final)=3.462 | 3778.5 samples/s | 59.0 steps/s
[Step=37800 Epoch=185.4] | Loss=0.00927 | Reg=0.00264 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.250 | L2-Norm(final)=3.463 | 4752.1 samples/s | 74.3 steps/s
[Step=37850 Epoch=185.6] | Loss=0.00818 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.249 | L2-Norm(final)=3.464 | 1654.1 samples/s | 25.8 steps/s
[Step=37900 Epoch=185.9] | Loss=0.00714 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.248 | L2-Norm(final)=3.464 | 3776.4 samples/s | 59.0 steps/s
[Step=37950 Epoch=186.1] | Loss=0.00658 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.247 | L2-Norm(final)=3.465 | 3734.7 samples/s | 58.4 steps/s
[Step=38000 Epoch=186.3] | Loss=0.00605 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.247 | L2-Norm(final)=3.466 | 4558.7 samples/s | 71.2 steps/s
[Step=38050 Epoch=186.6] | Loss=0.00565 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.246 | L2-Norm(final)=3.467 | 1684.3 samples/s | 26.3 steps/s
[Step=38100 Epoch=186.8] | Loss=0.00538 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.246 | L2-Norm(final)=3.467 | 3771.0 samples/s | 58.9 steps/s
[Step=38150 Epoch=187.1] | Loss=0.00503 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.245 | L2-Norm(final)=3.468 | 3785.7 samples/s | 59.2 steps/s
[Step=38200 Epoch=187.3] | Loss=0.00478 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.245 | L2-Norm(final)=3.469 | 4427.6 samples/s | 69.2 steps/s
[Step=38250 Epoch=187.6] | Loss=0.00454 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.244 | L2-Norm(final)=3.470 | 1700.5 samples/s | 26.6 steps/s
[Step=38300 Epoch=187.8] | Loss=0.00442 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.244 | L2-Norm(final)=3.470 | 3773.3 samples/s | 59.0 steps/s
[Step=38350 Epoch=188.1] | Loss=0.00425 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.244 | L2-Norm(final)=3.471 | 3773.8 samples/s | 59.0 steps/s
[Step=38400 Epoch=188.3] | Loss=0.00414 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.244 | L2-Norm(final)=3.472 | 4256.3 samples/s | 66.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step38400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=356.3] | Loss=0.05213 | Reg=0.00265 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.268 | L2-Norm(final)=3.465 | 3846.9 samples/s | 60.1 steps/s
[Step=37650 Epoch=356.8] | Loss=0.00560 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.235 | L2-Norm(final)=3.468 | 3441.2 samples/s | 53.8 steps/s
[Step=37700 Epoch=357.2] | Loss=0.00282 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.228 | L2-Norm(final)=3.469 | 4504.2 samples/s | 70.4 steps/s
[Step=37750 Epoch=357.7] | Loss=0.00189 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.224 | L2-Norm(final)=3.469 | 1616.8 samples/s | 25.3 steps/s
[Step=37800 Epoch=358.2] | Loss=0.00143 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.221 | L2-Norm(final)=3.469 | 4259.5 samples/s | 66.6 steps/s
[Step=37850 Epoch=358.7] | Loss=0.00115 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.219 | L2-Norm(final)=3.469 | 1652.7 samples/s | 25.8 steps/s
[Step=37900 Epoch=359.1] | Loss=0.00096 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.217 | L2-Norm(final)=3.469 | 4042.1 samples/s | 63.2 steps/s
[Step=37950 Epoch=359.6] | Loss=0.00082 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.215 | L2-Norm(final)=3.469 | 1687.9 samples/s | 26.4 steps/s
[Step=38000 Epoch=360.1] | Loss=0.00072 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.214 | L2-Norm(final)=3.469 | 3843.1 samples/s | 60.0 steps/s
[Step=38050 Epoch=360.6] | Loss=0.00064 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.212 | L2-Norm(final)=3.469 | 1715.8 samples/s | 26.8 steps/s
[Step=38100 Epoch=361.0] | Loss=0.00058 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.211 | L2-Norm(final)=3.469 | 3644.8 samples/s | 56.9 steps/s
[Step=38150 Epoch=361.5] | Loss=0.00053 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.210 | L2-Norm(final)=3.469 | 1763.0 samples/s | 27.5 steps/s
[Step=38200 Epoch=362.0] | Loss=0.00049 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.209 | L2-Norm(final)=3.469 | 3607.1 samples/s | 56.4 steps/s
[Step=38250 Epoch=362.5] | Loss=0.00045 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.208 | L2-Norm(final)=3.469 | 1772.3 samples/s | 27.7 steps/s
[Step=38300 Epoch=362.9] | Loss=0.00042 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.207 | L2-Norm(final)=3.469 | 3612.4 samples/s | 56.4 steps/s
[Step=38350 Epoch=363.4] | Loss=0.00039 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.206 | L2-Norm(final)=3.469 | 1792.3 samples/s | 28.0 steps/s
[Step=38400 Epoch=363.9] | Loss=0.00037 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.205 | L2-Norm(final)=3.469 | 3543.8 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step38400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=357.7] | Loss=0.09993 | Reg=0.00265 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.268 | L2-Norm(final)=3.465 | 3805.2 samples/s | 59.5 steps/s
[Step=37650 Epoch=358.1] | Loss=0.00623 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.237 | L2-Norm(final)=3.467 | 3405.9 samples/s | 53.2 steps/s
[Step=37700 Epoch=358.6] | Loss=0.00314 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.230 | L2-Norm(final)=3.467 | 4546.1 samples/s | 71.0 steps/s
[Step=37750 Epoch=359.1] | Loss=0.00211 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.226 | L2-Norm(final)=3.467 | 1619.7 samples/s | 25.3 steps/s
[Step=37800 Epoch=359.6] | Loss=0.00159 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.224 | L2-Norm(final)=3.468 | 4254.7 samples/s | 66.5 steps/s
[Step=37850 Epoch=360.0] | Loss=0.00128 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.221 | L2-Norm(final)=3.468 | 1651.5 samples/s | 25.8 steps/s
[Step=37900 Epoch=360.5] | Loss=0.00107 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.219 | L2-Norm(final)=3.468 | 4024.5 samples/s | 62.9 steps/s
[Step=37950 Epoch=361.0] | Loss=0.00092 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.217 | L2-Norm(final)=3.468 | 1694.5 samples/s | 26.5 steps/s
[Step=38000 Epoch=361.5] | Loss=0.00081 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.216 | L2-Norm(final)=3.468 | 3835.9 samples/s | 59.9 steps/s
[Step=38050 Epoch=362.0] | Loss=0.00072 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.215 | L2-Norm(final)=3.468 | 1723.2 samples/s | 26.9 steps/s
[Step=38100 Epoch=362.4] | Loss=0.00065 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.213 | L2-Norm(final)=3.468 | 3648.7 samples/s | 57.0 steps/s
[Step=38150 Epoch=362.9] | Loss=0.00059 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.212 | L2-Norm(final)=3.468 | 1771.2 samples/s | 27.7 steps/s
[Step=38200 Epoch=363.4] | Loss=0.00055 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.211 | L2-Norm(final)=3.468 | 3608.1 samples/s | 56.4 steps/s
[Step=38250 Epoch=363.9] | Loss=0.00051 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.210 | L2-Norm(final)=3.468 | 1770.8 samples/s | 27.7 steps/s
[Step=38300 Epoch=364.3] | Loss=0.00047 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.209 | L2-Norm(final)=3.468 | 3576.4 samples/s | 55.9 steps/s
[Step=38350 Epoch=364.8] | Loss=0.00044 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.208 | L2-Norm(final)=3.468 | 1788.9 samples/s | 28.0 steps/s
[Step=38400 Epoch=365.3] | Loss=0.00041 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.207 | L2-Norm(final)=3.468 | 3567.7 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step38400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=359.1] | Loss=0.06254 | Reg=0.00265 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.268 | L2-Norm(final)=3.465 | 3652.8 samples/s | 57.1 steps/s
[Step=37650 Epoch=359.5] | Loss=0.00341 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.234 | L2-Norm(final)=3.468 | 3496.6 samples/s | 54.6 steps/s
[Step=37700 Epoch=360.0] | Loss=0.00173 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.227 | L2-Norm(final)=3.468 | 4533.3 samples/s | 70.8 steps/s
[Step=37750 Epoch=360.5] | Loss=0.00117 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.223 | L2-Norm(final)=3.468 | 1603.9 samples/s | 25.1 steps/s
[Step=37800 Epoch=361.0] | Loss=0.00088 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.220 | L2-Norm(final)=3.469 | 4130.8 samples/s | 64.5 steps/s
[Step=37850 Epoch=361.4] | Loss=0.00071 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.218 | L2-Norm(final)=3.469 | 1626.2 samples/s | 25.4 steps/s
[Step=37900 Epoch=361.9] | Loss=0.00060 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.216 | L2-Norm(final)=3.469 | 4115.5 samples/s | 64.3 steps/s
[Step=37950 Epoch=362.4] | Loss=0.00051 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.214 | L2-Norm(final)=3.469 | 1678.2 samples/s | 26.2 steps/s
[Step=38000 Epoch=362.9] | Loss=0.00045 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.213 | L2-Norm(final)=3.469 | 3912.2 samples/s | 61.1 steps/s
[Step=38050 Epoch=363.4] | Loss=0.00040 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.211 | L2-Norm(final)=3.469 | 1702.1 samples/s | 26.6 steps/s
[Step=38100 Epoch=363.8] | Loss=0.00037 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.210 | L2-Norm(final)=3.469 | 3781.0 samples/s | 59.1 steps/s
[Step=38150 Epoch=364.3] | Loss=0.00033 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.209 | L2-Norm(final)=3.469 | 1707.7 samples/s | 26.7 steps/s
[Step=38200 Epoch=364.8] | Loss=0.00031 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.208 | L2-Norm(final)=3.469 | 3661.0 samples/s | 57.2 steps/s
[Step=38250 Epoch=365.3] | Loss=0.00029 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.207 | L2-Norm(final)=3.469 | 1757.6 samples/s | 27.5 steps/s
[Step=38300 Epoch=365.7] | Loss=0.00027 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.206 | L2-Norm(final)=3.469 | 3591.8 samples/s | 56.1 steps/s
[Step=38350 Epoch=366.2] | Loss=0.00025 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.205 | L2-Norm(final)=3.469 | 1765.5 samples/s | 27.6 steps/s
[Step=38400 Epoch=366.7] | Loss=0.00023 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.204 | L2-Norm(final)=3.469 | 3605.0 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step38400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=354.3] | Loss=0.01831 | Reg=0.00265 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.268 | L2-Norm(final)=3.465 | 3870.4 samples/s | 60.5 steps/s
[Step=37650 Epoch=354.8] | Loss=0.00443 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.234 | L2-Norm(final)=3.468 | 3313.6 samples/s | 51.8 steps/s
[Step=37700 Epoch=355.2] | Loss=0.00224 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.227 | L2-Norm(final)=3.469 | 4465.1 samples/s | 69.8 steps/s
[Step=37750 Epoch=355.7] | Loss=0.00151 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.223 | L2-Norm(final)=3.469 | 1624.8 samples/s | 25.4 steps/s
[Step=37800 Epoch=356.2] | Loss=0.00114 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.220 | L2-Norm(final)=3.469 | 4201.5 samples/s | 65.6 steps/s
[Step=37850 Epoch=356.7] | Loss=0.00091 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.218 | L2-Norm(final)=3.469 | 1657.9 samples/s | 25.9 steps/s
[Step=37900 Epoch=357.1] | Loss=0.00076 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.216 | L2-Norm(final)=3.469 | 3924.8 samples/s | 61.3 steps/s
[Step=37950 Epoch=357.6] | Loss=0.00066 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.214 | L2-Norm(final)=3.469 | 1698.1 samples/s | 26.5 steps/s
[Step=38000 Epoch=358.1] | Loss=0.00058 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.213 | L2-Norm(final)=3.469 | 3691.2 samples/s | 57.7 steps/s
[Step=38050 Epoch=358.5] | Loss=0.00052 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.211 | L2-Norm(final)=3.469 | 1748.7 samples/s | 27.3 steps/s
[Step=38100 Epoch=359.0] | Loss=0.00047 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.210 | L2-Norm(final)=3.470 | 3605.9 samples/s | 56.3 steps/s
[Step=38150 Epoch=359.5] | Loss=0.00043 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.209 | L2-Norm(final)=3.470 | 1758.8 samples/s | 27.5 steps/s
[Step=38200 Epoch=360.0] | Loss=0.00039 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.208 | L2-Norm(final)=3.470 | 3587.9 samples/s | 56.1 steps/s
[Step=38250 Epoch=360.4] | Loss=0.00036 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.207 | L2-Norm(final)=3.470 | 1793.7 samples/s | 28.0 steps/s
[Step=38300 Epoch=360.9] | Loss=0.00034 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.206 | L2-Norm(final)=3.470 | 3544.4 samples/s | 55.4 steps/s
[Step=38350 Epoch=361.4] | Loss=0.00032 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.205 | L2-Norm(final)=3.470 | 1919.6 samples/s | 30.0 steps/s
[Step=38400 Epoch=361.8] | Loss=0.00030 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.204 | L2-Norm(final)=3.470 | 3148.8 samples/s | 49.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step38400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=358.4] | Loss=0.19392 | Reg=0.00265 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.268 | L2-Norm(final)=3.465 | 3784.2 samples/s | 59.1 steps/s
[Step=37650 Epoch=358.8] | Loss=0.00771 | Reg=0.00264 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.235 | L2-Norm(final)=3.467 | 3435.8 samples/s | 53.7 steps/s
[Step=37700 Epoch=359.3] | Loss=0.00389 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.228 | L2-Norm(final)=3.468 | 4536.0 samples/s | 70.9 steps/s
[Step=37750 Epoch=359.8] | Loss=0.00261 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.224 | L2-Norm(final)=3.468 | 1612.4 samples/s | 25.2 steps/s
[Step=37800 Epoch=360.3] | Loss=0.00197 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.222 | L2-Norm(final)=3.468 | 4305.8 samples/s | 67.3 steps/s
[Step=37850 Epoch=360.7] | Loss=0.00158 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.219 | L2-Norm(final)=3.468 | 1639.1 samples/s | 25.6 steps/s
[Step=37900 Epoch=361.2] | Loss=0.00133 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.217 | L2-Norm(final)=3.468 | 4130.4 samples/s | 64.5 steps/s
[Step=37950 Epoch=361.7] | Loss=0.00114 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.216 | L2-Norm(final)=3.468 | 1663.5 samples/s | 26.0 steps/s
[Step=38000 Epoch=362.2] | Loss=0.00100 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.214 | L2-Norm(final)=3.468 | 3941.8 samples/s | 61.6 steps/s
[Step=38050 Epoch=362.7] | Loss=0.00089 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.213 | L2-Norm(final)=3.469 | 1687.8 samples/s | 26.4 steps/s
[Step=38100 Epoch=363.1] | Loss=0.00081 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.212 | L2-Norm(final)=3.469 | 3789.8 samples/s | 59.2 steps/s
[Step=38150 Epoch=363.6] | Loss=0.00074 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.211 | L2-Norm(final)=3.469 | 1734.2 samples/s | 27.1 steps/s
[Step=38200 Epoch=364.1] | Loss=0.00068 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.210 | L2-Norm(final)=3.469 | 3641.1 samples/s | 56.9 steps/s
[Step=38250 Epoch=364.6] | Loss=0.00063 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.209 | L2-Norm(final)=3.469 | 1761.8 samples/s | 27.5 steps/s
[Step=38300 Epoch=365.0] | Loss=0.00058 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.208 | L2-Norm(final)=3.469 | 3593.1 samples/s | 56.1 steps/s
[Step=38350 Epoch=365.5] | Loss=0.00055 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.207 | L2-Norm(final)=3.469 | 1773.0 samples/s | 27.7 steps/s
[Step=38400 Epoch=366.0] | Loss=0.00051 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.206 | L2-Norm(final)=3.469 | 3598.5 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21578 | acc=0.8951 | tpr=0.8549 | fpr=0.0176 | 3920.0 samples/s | 15.3 steps/s
Avg test loss: 0.21816, Avg test acc: 0.89470, Avg tpr: 0.85458, Avg fpr: 0.01705, total FA: 133

Testing server on iccad2012
[Step=  50] | Loss=0.44335 | acc=0.8795 | tpr=0.9602 | fpr=0.1219 | 3927.1 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.45247 | acc=0.8776 | tpr=0.9616 | fpr=0.1240 | 4503.9 samples/s | 17.6 steps/s
[Step= 150] | Loss=0.45814 | acc=0.8765 | tpr=0.9625 | fpr=0.1251 | 7438.3 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.45886 | acc=0.8773 | tpr=0.9628 | fpr=0.1243 | 7370.3 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.45728 | acc=0.8773 | tpr=0.9651 | fpr=0.1243 | 7300.5 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.45593 | acc=0.8780 | tpr=0.9607 | fpr=0.1235 | 7566.5 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.45855 | acc=0.8781 | tpr=0.9580 | fpr=0.1233 | 7316.0 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.45947 | acc=0.8781 | tpr=0.9551 | fpr=0.1233 | 7158.7 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.46384 | acc=0.8774 | tpr=0.9557 | fpr=0.1240 | 7344.5 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.46445 | acc=0.8774 | tpr=0.9577 | fpr=0.1240 | 7163.5 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.46370 | acc=0.8776 | tpr=0.9598 | fpr=0.1239 | 13789.4 samples/s | 53.9 steps/s
Avg test loss: 0.46348, Avg test acc: 0.87754, Avg tpr: 0.95998, Avg fpr: 0.12396, total FA: 17212

server round 48/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.3] | Loss=0.03587 | Reg=0.00263 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.212 | L2-Norm(final)=3.476 | 3834.5 samples/s | 59.9 steps/s
[Step=38450 Epoch=187.5] | Loss=0.01525 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.203 | L2-Norm(final)=3.475 | 3607.2 samples/s | 56.4 steps/s
[Step=38500 Epoch=187.7] | Loss=0.01102 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.199 | L2-Norm(final)=3.475 | 3765.1 samples/s | 58.8 steps/s
[Step=38550 Epoch=188.0] | Loss=0.00927 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.196 | L2-Norm(final)=3.476 | 3779.5 samples/s | 59.1 steps/s
[Step=38600 Epoch=188.2] | Loss=0.00788 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.194 | L2-Norm(final)=3.476 | 4690.1 samples/s | 73.3 steps/s
[Step=38650 Epoch=188.5] | Loss=0.00697 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.193 | L2-Norm(final)=3.477 | 1665.5 samples/s | 26.0 steps/s
[Step=38700 Epoch=188.7] | Loss=0.00624 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.192 | L2-Norm(final)=3.478 | 3778.3 samples/s | 59.0 steps/s
[Step=38750 Epoch=189.0] | Loss=0.00575 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.191 | L2-Norm(final)=3.479 | 3764.6 samples/s | 58.8 steps/s
[Step=38800 Epoch=189.2] | Loss=0.00554 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.191 | L2-Norm(final)=3.480 | 4434.6 samples/s | 69.3 steps/s
[Step=38850 Epoch=189.4] | Loss=0.00529 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.190 | L2-Norm(final)=3.480 | 1695.9 samples/s | 26.5 steps/s
[Step=38900 Epoch=189.7] | Loss=0.00510 | Reg=0.00262 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.189 | L2-Norm(final)=3.481 | 3780.3 samples/s | 59.1 steps/s
[Step=38950 Epoch=189.9] | Loss=0.00486 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.189 | L2-Norm(final)=3.482 | 3771.5 samples/s | 58.9 steps/s
[Step=39000 Epoch=190.2] | Loss=0.00468 | Reg=0.00262 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.188 | L2-Norm(final)=3.483 | 4247.9 samples/s | 66.4 steps/s
[Step=39050 Epoch=190.4] | Loss=0.00444 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.188 | L2-Norm(final)=3.483 | 1726.7 samples/s | 27.0 steps/s
[Step=39100 Epoch=190.7] | Loss=0.00426 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.188 | L2-Norm(final)=3.484 | 3724.8 samples/s | 58.2 steps/s
[Step=39150 Epoch=190.9] | Loss=0.00415 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.187 | L2-Norm(final)=3.485 | 3781.0 samples/s | 59.1 steps/s
[Step=39200 Epoch=191.1] | Loss=0.00413 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.187 | L2-Norm(final)=3.485 | 4036.9 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step39200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.4] | Loss=0.03619 | Reg=0.00263 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.212 | L2-Norm(final)=3.476 | 3471.6 samples/s | 54.2 steps/s
[Step=38450 Epoch=187.6] | Loss=0.01556 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.202 | L2-Norm(final)=3.474 | 1971.8 samples/s | 30.8 steps/s
[Step=38500 Epoch=187.9] | Loss=0.00987 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.197 | L2-Norm(final)=3.475 | 3520.4 samples/s | 55.0 steps/s
[Step=38550 Epoch=188.1] | Loss=0.00838 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.194 | L2-Norm(final)=3.475 | 3789.1 samples/s | 59.2 steps/s
[Step=38600 Epoch=188.4] | Loss=0.00763 | Reg=0.00262 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.192 | L2-Norm(final)=3.476 | 4712.8 samples/s | 73.6 steps/s
[Step=38650 Epoch=188.6] | Loss=0.00658 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.191 | L2-Norm(final)=3.476 | 1653.8 samples/s | 25.8 steps/s
[Step=38700 Epoch=188.8] | Loss=0.00600 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.190 | L2-Norm(final)=3.477 | 3796.3 samples/s | 59.3 steps/s
[Step=38750 Epoch=189.1] | Loss=0.00558 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.189 | L2-Norm(final)=3.478 | 3778.4 samples/s | 59.0 steps/s
[Step=38800 Epoch=189.3] | Loss=0.00517 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.189 | L2-Norm(final)=3.478 | 4504.2 samples/s | 70.4 steps/s
[Step=38850 Epoch=189.6] | Loss=0.00488 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.188 | L2-Norm(final)=3.479 | 1693.4 samples/s | 26.5 steps/s
[Step=38900 Epoch=189.8] | Loss=0.00461 | Reg=0.00262 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.187 | L2-Norm(final)=3.480 | 3781.8 samples/s | 59.1 steps/s
[Step=38950 Epoch=190.1] | Loss=0.00431 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.187 | L2-Norm(final)=3.481 | 3794.1 samples/s | 59.3 steps/s
[Step=39000 Epoch=190.3] | Loss=0.00425 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.187 | L2-Norm(final)=3.481 | 4321.7 samples/s | 67.5 steps/s
[Step=39050 Epoch=190.5] | Loss=0.00403 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.186 | L2-Norm(final)=3.482 | 1728.9 samples/s | 27.0 steps/s
[Step=39100 Epoch=190.8] | Loss=0.00400 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.186 | L2-Norm(final)=3.483 | 3762.2 samples/s | 58.8 steps/s
[Step=39150 Epoch=191.0] | Loss=0.00390 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.185 | L2-Norm(final)=3.483 | 3792.6 samples/s | 59.3 steps/s
[Step=39200 Epoch=191.3] | Loss=0.00379 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.185 | L2-Norm(final)=3.484 | 4128.1 samples/s | 64.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step39200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.1] | Loss=0.04563 | Reg=0.00263 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.212 | L2-Norm(final)=3.476 | 3995.7 samples/s | 62.4 steps/s
[Step=38450 Epoch=187.3] | Loss=0.01256 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.201 | L2-Norm(final)=3.475 | 3509.0 samples/s | 54.8 steps/s
[Step=38500 Epoch=187.6] | Loss=0.00934 | Reg=0.00262 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.196 | L2-Norm(final)=3.476 | 3785.2 samples/s | 59.1 steps/s
[Step=38550 Epoch=187.8] | Loss=0.00750 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.193 | L2-Norm(final)=3.477 | 3795.6 samples/s | 59.3 steps/s
[Step=38600 Epoch=188.1] | Loss=0.00721 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.192 | L2-Norm(final)=3.478 | 4698.1 samples/s | 73.4 steps/s
[Step=38650 Epoch=188.3] | Loss=0.00650 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.191 | L2-Norm(final)=3.479 | 1672.4 samples/s | 26.1 steps/s
[Step=38700 Epoch=188.6] | Loss=0.00595 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.190 | L2-Norm(final)=3.480 | 3787.6 samples/s | 59.2 steps/s
[Step=38750 Epoch=188.8] | Loss=0.00551 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.190 | L2-Norm(final)=3.481 | 3785.8 samples/s | 59.2 steps/s
[Step=38800 Epoch=189.1] | Loss=0.00522 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.189 | L2-Norm(final)=3.482 | 4446.8 samples/s | 69.5 steps/s
[Step=38850 Epoch=189.3] | Loss=0.00484 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.189 | L2-Norm(final)=3.483 | 1695.6 samples/s | 26.5 steps/s
[Step=38900 Epoch=189.5] | Loss=0.00467 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.188 | L2-Norm(final)=3.484 | 3785.6 samples/s | 59.1 steps/s
[Step=38950 Epoch=189.8] | Loss=0.00441 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.188 | L2-Norm(final)=3.485 | 3792.4 samples/s | 59.3 steps/s
[Step=39000 Epoch=190.0] | Loss=0.00422 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.187 | L2-Norm(final)=3.486 | 4223.3 samples/s | 66.0 steps/s
[Step=39050 Epoch=190.3] | Loss=0.00405 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.187 | L2-Norm(final)=3.486 | 1726.0 samples/s | 27.0 steps/s
[Step=39100 Epoch=190.5] | Loss=0.00391 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.187 | L2-Norm(final)=3.487 | 3778.6 samples/s | 59.0 steps/s
[Step=39150 Epoch=190.8] | Loss=0.00380 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.187 | L2-Norm(final)=3.488 | 3792.5 samples/s | 59.3 steps/s
[Step=39200 Epoch=191.0] | Loss=0.00373 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.187 | L2-Norm(final)=3.489 | 4044.1 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step39200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.3] | Loss=0.01784 | Reg=0.00263 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.212 | L2-Norm(final)=3.477 | 3767.6 samples/s | 58.9 steps/s
[Step=38450 Epoch=187.5] | Loss=0.01683 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.203 | L2-Norm(final)=3.473 | 3682.5 samples/s | 57.5 steps/s
[Step=38500 Epoch=187.7] | Loss=0.01176 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.198 | L2-Norm(final)=3.473 | 3774.4 samples/s | 59.0 steps/s
[Step=38550 Epoch=188.0] | Loss=0.00926 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.196 | L2-Norm(final)=3.474 | 3777.5 samples/s | 59.0 steps/s
[Step=38600 Epoch=188.2] | Loss=0.00784 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.195 | L2-Norm(final)=3.475 | 4693.8 samples/s | 73.3 steps/s
[Step=38650 Epoch=188.5] | Loss=0.00678 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.194 | L2-Norm(final)=3.476 | 1643.5 samples/s | 25.7 steps/s
[Step=38700 Epoch=188.7] | Loss=0.00621 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.193 | L2-Norm(final)=3.477 | 3778.4 samples/s | 59.0 steps/s
[Step=38750 Epoch=189.0] | Loss=0.00562 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.193 | L2-Norm(final)=3.478 | 3786.6 samples/s | 59.2 steps/s
[Step=38800 Epoch=189.2] | Loss=0.00534 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.192 | L2-Norm(final)=3.479 | 4464.8 samples/s | 69.8 steps/s
[Step=38850 Epoch=189.5] | Loss=0.00499 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.192 | L2-Norm(final)=3.480 | 1701.5 samples/s | 26.6 steps/s
[Step=38900 Epoch=189.7] | Loss=0.00475 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.191 | L2-Norm(final)=3.480 | 3782.6 samples/s | 59.1 steps/s
[Step=38950 Epoch=189.9] | Loss=0.00450 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.191 | L2-Norm(final)=3.481 | 3788.4 samples/s | 59.2 steps/s
[Step=39000 Epoch=190.2] | Loss=0.00433 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.190 | L2-Norm(final)=3.482 | 4229.8 samples/s | 66.1 steps/s
[Step=39050 Epoch=190.4] | Loss=0.00411 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.190 | L2-Norm(final)=3.483 | 1734.0 samples/s | 27.1 steps/s
[Step=39100 Epoch=190.7] | Loss=0.00391 | Reg=0.00262 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.190 | L2-Norm(final)=3.484 | 3774.6 samples/s | 59.0 steps/s
[Step=39150 Epoch=190.9] | Loss=0.00385 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.189 | L2-Norm(final)=3.484 | 3780.9 samples/s | 59.1 steps/s
[Step=39200 Epoch=191.2] | Loss=0.00378 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.189 | L2-Norm(final)=3.485 | 4053.0 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step39200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=188.3] | Loss=0.13231 | Reg=0.00263 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=16.212 | L2-Norm(final)=3.476 | 3758.6 samples/s | 58.7 steps/s
[Step=38450 Epoch=188.6] | Loss=0.01952 | Reg=0.00263 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.203 | L2-Norm(final)=3.474 | 3669.6 samples/s | 57.3 steps/s
[Step=38500 Epoch=188.8] | Loss=0.01310 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.198 | L2-Norm(final)=3.474 | 3790.1 samples/s | 59.2 steps/s
[Step=38550 Epoch=189.0] | Loss=0.01026 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.195 | L2-Norm(final)=3.474 | 3785.6 samples/s | 59.2 steps/s
[Step=38600 Epoch=189.3] | Loss=0.00873 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.194 | L2-Norm(final)=3.475 | 4752.0 samples/s | 74.3 steps/s
[Step=38650 Epoch=189.5] | Loss=0.00764 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.192 | L2-Norm(final)=3.476 | 1659.7 samples/s | 25.9 steps/s
[Step=38700 Epoch=189.8] | Loss=0.00677 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.192 | L2-Norm(final)=3.476 | 3775.5 samples/s | 59.0 steps/s
[Step=38750 Epoch=190.0] | Loss=0.00622 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.191 | L2-Norm(final)=3.477 | 3798.0 samples/s | 59.3 steps/s
[Step=38800 Epoch=190.3] | Loss=0.00573 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.190 | L2-Norm(final)=3.478 | 4595.3 samples/s | 71.8 steps/s
[Step=38850 Epoch=190.5] | Loss=0.00538 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.190 | L2-Norm(final)=3.479 | 1676.9 samples/s | 26.2 steps/s
[Step=38900 Epoch=190.8] | Loss=0.00503 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.189 | L2-Norm(final)=3.480 | 3780.3 samples/s | 59.1 steps/s
[Step=38950 Epoch=191.0] | Loss=0.00483 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.189 | L2-Norm(final)=3.481 | 3781.2 samples/s | 59.1 steps/s
[Step=39000 Epoch=191.2] | Loss=0.00459 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.188 | L2-Norm(final)=3.482 | 4428.3 samples/s | 69.2 steps/s
[Step=39050 Epoch=191.5] | Loss=0.00440 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.188 | L2-Norm(final)=3.482 | 1687.4 samples/s | 26.4 steps/s
[Step=39100 Epoch=191.7] | Loss=0.00425 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.188 | L2-Norm(final)=3.483 | 3790.3 samples/s | 59.2 steps/s
[Step=39150 Epoch=192.0] | Loss=0.00409 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.188 | L2-Norm(final)=3.484 | 3757.0 samples/s | 58.7 steps/s
[Step=39200 Epoch=192.2] | Loss=0.00393 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.187 | L2-Norm(final)=3.485 | 4270.0 samples/s | 66.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step39200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=363.9] | Loss=0.02809 | Reg=0.00263 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.212 | L2-Norm(final)=3.477 | 3712.9 samples/s | 58.0 steps/s
[Step=38450 Epoch=364.3] | Loss=0.00305 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.181 | L2-Norm(final)=3.481 | 3459.0 samples/s | 54.0 steps/s
[Step=38500 Epoch=364.8] | Loss=0.00155 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.175 | L2-Norm(final)=3.482 | 4520.2 samples/s | 70.6 steps/s
[Step=38550 Epoch=365.3] | Loss=0.00104 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.171 | L2-Norm(final)=3.482 | 1616.6 samples/s | 25.3 steps/s
[Step=38600 Epoch=365.8] | Loss=0.00079 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.168 | L2-Norm(final)=3.482 | 4263.7 samples/s | 66.6 steps/s
[Step=38650 Epoch=366.2] | Loss=0.00064 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.165 | L2-Norm(final)=3.482 | 1643.0 samples/s | 25.7 steps/s
[Step=38700 Epoch=366.7] | Loss=0.00053 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.163 | L2-Norm(final)=3.483 | 4018.7 samples/s | 62.8 steps/s
[Step=38750 Epoch=367.2] | Loss=0.00046 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.161 | L2-Norm(final)=3.483 | 1696.9 samples/s | 26.5 steps/s
[Step=38800 Epoch=367.7] | Loss=0.00041 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.160 | L2-Norm(final)=3.483 | 3829.8 samples/s | 59.8 steps/s
[Step=38850 Epoch=368.1] | Loss=0.00036 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.158 | L2-Norm(final)=3.483 | 1725.5 samples/s | 27.0 steps/s
[Step=38900 Epoch=368.6] | Loss=0.00033 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.157 | L2-Norm(final)=3.483 | 3655.2 samples/s | 57.1 steps/s
[Step=38950 Epoch=369.1] | Loss=0.00030 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.156 | L2-Norm(final)=3.483 | 1763.1 samples/s | 27.5 steps/s
[Step=39000 Epoch=369.6] | Loss=0.00028 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.155 | L2-Norm(final)=3.483 | 3650.0 samples/s | 57.0 steps/s
[Step=39050 Epoch=370.0] | Loss=0.00026 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.154 | L2-Norm(final)=3.483 | 1768.3 samples/s | 27.6 steps/s
[Step=39100 Epoch=370.5] | Loss=0.00024 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.153 | L2-Norm(final)=3.483 | 3636.0 samples/s | 56.8 steps/s
[Step=39150 Epoch=371.0] | Loss=0.00022 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.152 | L2-Norm(final)=3.483 | 1788.7 samples/s | 27.9 steps/s
[Step=39200 Epoch=371.5] | Loss=0.00021 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.151 | L2-Norm(final)=3.483 | 3568.1 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step39200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=365.3] | Loss=0.02551 | Reg=0.00263 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.212 | L2-Norm(final)=3.477 | 3665.0 samples/s | 57.3 steps/s
[Step=38450 Epoch=365.8] | Loss=0.00513 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.182 | L2-Norm(final)=3.480 | 3501.9 samples/s | 54.7 steps/s
[Step=38500 Epoch=366.2] | Loss=0.00260 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.176 | L2-Norm(final)=3.481 | 4530.9 samples/s | 70.8 steps/s
[Step=38550 Epoch=366.7] | Loss=0.00175 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.172 | L2-Norm(final)=3.481 | 1610.0 samples/s | 25.2 steps/s
[Step=38600 Epoch=367.2] | Loss=0.00132 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.169 | L2-Norm(final)=3.481 | 4262.6 samples/s | 66.6 steps/s
[Step=38650 Epoch=367.7] | Loss=0.00106 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.167 | L2-Norm(final)=3.481 | 1653.0 samples/s | 25.8 steps/s
[Step=38700 Epoch=368.1] | Loss=0.00089 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.165 | L2-Norm(final)=3.481 | 4041.0 samples/s | 63.1 steps/s
[Step=38750 Epoch=368.6] | Loss=0.00077 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.163 | L2-Norm(final)=3.481 | 1680.4 samples/s | 26.3 steps/s
[Step=38800 Epoch=369.1] | Loss=0.00067 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.162 | L2-Norm(final)=3.481 | 3839.6 samples/s | 60.0 steps/s
[Step=38850 Epoch=369.6] | Loss=0.00060 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.160 | L2-Norm(final)=3.481 | 1724.3 samples/s | 26.9 steps/s
[Step=38900 Epoch=370.0] | Loss=0.00054 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.159 | L2-Norm(final)=3.481 | 3651.7 samples/s | 57.1 steps/s
[Step=38950 Epoch=370.5] | Loss=0.00050 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.158 | L2-Norm(final)=3.481 | 1756.8 samples/s | 27.5 steps/s
[Step=39000 Epoch=371.0] | Loss=0.00046 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.157 | L2-Norm(final)=3.481 | 3579.0 samples/s | 55.9 steps/s
[Step=39050 Epoch=371.5] | Loss=0.00042 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.156 | L2-Norm(final)=3.481 | 1783.5 samples/s | 27.9 steps/s
[Step=39100 Epoch=371.9] | Loss=0.00039 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.155 | L2-Norm(final)=3.481 | 3598.2 samples/s | 56.2 steps/s
[Step=39150 Epoch=372.4] | Loss=0.00037 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.154 | L2-Norm(final)=3.481 | 1788.4 samples/s | 27.9 steps/s
[Step=39200 Epoch=372.9] | Loss=0.00035 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.153 | L2-Norm(final)=3.481 | 3586.4 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step39200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=366.7] | Loss=0.02273 | Reg=0.00263 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.212 | L2-Norm(final)=3.477 | 3620.7 samples/s | 56.6 steps/s
[Step=38450 Epoch=367.2] | Loss=0.00408 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.179 | L2-Norm(final)=3.481 | 3565.5 samples/s | 55.7 steps/s
[Step=38500 Epoch=367.7] | Loss=0.00205 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.173 | L2-Norm(final)=3.481 | 4553.5 samples/s | 71.1 steps/s
[Step=38550 Epoch=368.1] | Loss=0.00138 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.169 | L2-Norm(final)=3.482 | 1616.3 samples/s | 25.3 steps/s
[Step=38600 Epoch=368.6] | Loss=0.00104 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.167 | L2-Norm(final)=3.482 | 4314.0 samples/s | 67.4 steps/s
[Step=38650 Epoch=369.1] | Loss=0.00083 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.164 | L2-Norm(final)=3.482 | 1639.9 samples/s | 25.6 steps/s
[Step=38700 Epoch=369.6] | Loss=0.00070 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.162 | L2-Norm(final)=3.482 | 4128.2 samples/s | 64.5 steps/s
[Step=38750 Epoch=370.0] | Loss=0.00060 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.161 | L2-Norm(final)=3.482 | 1675.6 samples/s | 26.2 steps/s
[Step=38800 Epoch=370.5] | Loss=0.00053 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.159 | L2-Norm(final)=3.482 | 3955.2 samples/s | 61.8 steps/s
[Step=38850 Epoch=371.0] | Loss=0.00047 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.158 | L2-Norm(final)=3.482 | 1710.2 samples/s | 26.7 steps/s
[Step=38900 Epoch=371.5] | Loss=0.00042 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.157 | L2-Norm(final)=3.481 | 3798.3 samples/s | 59.3 steps/s
[Step=38950 Epoch=371.9] | Loss=0.00039 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.155 | L2-Norm(final)=3.481 | 1733.5 samples/s | 27.1 steps/s
[Step=39000 Epoch=372.4] | Loss=0.00035 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.154 | L2-Norm(final)=3.481 | 3660.9 samples/s | 57.2 steps/s
[Step=39050 Epoch=372.9] | Loss=0.00033 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.153 | L2-Norm(final)=3.481 | 1761.0 samples/s | 27.5 steps/s
[Step=39100 Epoch=373.4] | Loss=0.00031 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.152 | L2-Norm(final)=3.481 | 3620.5 samples/s | 56.6 steps/s
[Step=39150 Epoch=373.9] | Loss=0.00029 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.151 | L2-Norm(final)=3.481 | 1760.5 samples/s | 27.5 steps/s
[Step=39200 Epoch=374.3] | Loss=0.00027 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.151 | L2-Norm(final)=3.481 | 3625.3 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step39200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=361.8] | Loss=0.00790 | Reg=0.00263 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.212 | L2-Norm(final)=3.477 | 3742.4 samples/s | 58.5 steps/s
[Step=38450 Epoch=362.3] | Loss=0.00334 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.179 | L2-Norm(final)=3.481 | 3409.4 samples/s | 53.3 steps/s
[Step=38500 Epoch=362.8] | Loss=0.00170 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.172 | L2-Norm(final)=3.481 | 4457.4 samples/s | 69.6 steps/s
[Step=38550 Epoch=363.3] | Loss=0.00114 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.168 | L2-Norm(final)=3.482 | 1608.9 samples/s | 25.1 steps/s
[Step=38600 Epoch=363.7] | Loss=0.00086 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.165 | L2-Norm(final)=3.482 | 4159.1 samples/s | 65.0 steps/s
[Step=38650 Epoch=364.2] | Loss=0.00070 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.163 | L2-Norm(final)=3.482 | 1657.7 samples/s | 25.9 steps/s
[Step=38700 Epoch=364.7] | Loss=0.00058 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.161 | L2-Norm(final)=3.482 | 3929.7 samples/s | 61.4 steps/s
[Step=38750 Epoch=365.1] | Loss=0.00050 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.159 | L2-Norm(final)=3.482 | 1699.5 samples/s | 26.6 steps/s
[Step=38800 Epoch=365.6] | Loss=0.00044 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.158 | L2-Norm(final)=3.482 | 3715.4 samples/s | 58.1 steps/s
[Step=38850 Epoch=366.1] | Loss=0.00040 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.157 | L2-Norm(final)=3.482 | 1742.8 samples/s | 27.2 steps/s
[Step=38900 Epoch=366.5] | Loss=0.00036 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.155 | L2-Norm(final)=3.482 | 3620.8 samples/s | 56.6 steps/s
[Step=38950 Epoch=367.0] | Loss=0.00033 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.154 | L2-Norm(final)=3.482 | 1787.8 samples/s | 27.9 steps/s
[Step=39000 Epoch=367.5] | Loss=0.00030 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.153 | L2-Norm(final)=3.482 | 3571.1 samples/s | 55.8 steps/s
[Step=39050 Epoch=368.0] | Loss=0.00028 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.152 | L2-Norm(final)=3.482 | 1777.7 samples/s | 27.8 steps/s
[Step=39100 Epoch=368.4] | Loss=0.00026 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.151 | L2-Norm(final)=3.482 | 3542.0 samples/s | 55.3 steps/s
[Step=39150 Epoch=368.9] | Loss=0.00025 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.151 | L2-Norm(final)=3.482 | 1845.9 samples/s | 28.8 steps/s
[Step=39200 Epoch=369.4] | Loss=0.00023 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.150 | L2-Norm(final)=3.482 | 3376.2 samples/s | 52.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step39200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=366.0] | Loss=0.04629 | Reg=0.00263 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.212 | L2-Norm(final)=3.477 | 3829.2 samples/s | 59.8 steps/s
[Step=38450 Epoch=366.5] | Loss=0.00675 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.181 | L2-Norm(final)=3.481 | 3341.9 samples/s | 52.2 steps/s
[Step=38500 Epoch=366.9] | Loss=0.00340 | Reg=0.00262 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.174 | L2-Norm(final)=3.481 | 4499.4 samples/s | 70.3 steps/s
[Step=38550 Epoch=367.4] | Loss=0.00228 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.170 | L2-Norm(final)=3.482 | 1602.2 samples/s | 25.0 steps/s
[Step=38600 Epoch=367.9] | Loss=0.00172 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.167 | L2-Norm(final)=3.482 | 4339.8 samples/s | 67.8 steps/s
[Step=38650 Epoch=368.4] | Loss=0.00138 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.165 | L2-Norm(final)=3.482 | 1625.0 samples/s | 25.4 steps/s
[Step=38700 Epoch=368.8] | Loss=0.00115 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.163 | L2-Norm(final)=3.482 | 4137.2 samples/s | 64.6 steps/s
[Step=38750 Epoch=369.3] | Loss=0.00099 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.162 | L2-Norm(final)=3.482 | 1670.3 samples/s | 26.1 steps/s
[Step=38800 Epoch=369.8] | Loss=0.00087 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.160 | L2-Norm(final)=3.482 | 3936.0 samples/s | 61.5 steps/s
[Step=38850 Epoch=370.3] | Loss=0.00078 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.159 | L2-Norm(final)=3.482 | 1677.1 samples/s | 26.2 steps/s
[Step=38900 Epoch=370.8] | Loss=0.00070 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.157 | L2-Norm(final)=3.482 | 3812.7 samples/s | 59.6 steps/s
[Step=38950 Epoch=371.2] | Loss=0.00064 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.156 | L2-Norm(final)=3.482 | 1737.5 samples/s | 27.1 steps/s
[Step=39000 Epoch=371.7] | Loss=0.00059 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.155 | L2-Norm(final)=3.482 | 3611.0 samples/s | 56.4 steps/s
[Step=39050 Epoch=372.2] | Loss=0.00054 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.154 | L2-Norm(final)=3.482 | 1762.7 samples/s | 27.5 steps/s
[Step=39100 Epoch=372.7] | Loss=0.00050 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.153 | L2-Norm(final)=3.482 | 3609.0 samples/s | 56.4 steps/s
[Step=39150 Epoch=373.1] | Loss=0.00047 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.152 | L2-Norm(final)=3.481 | 1766.3 samples/s | 27.6 steps/s
[Step=39200 Epoch=373.6] | Loss=0.00044 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.151 | L2-Norm(final)=3.481 | 3627.7 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22298 | acc=0.8929 | tpr=0.8517 | fpr=0.0176 | 3861.5 samples/s | 15.1 steps/s
Avg test loss: 0.22550, Avg test acc: 0.89218, Avg tpr: 0.85091, Avg fpr: 0.01705, total FA: 133

Testing server on iccad2012
[Step=  50] | Loss=0.43049 | acc=0.8848 | tpr=0.9558 | fpr=0.1164 | 3855.4 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.43954 | acc=0.8825 | tpr=0.9595 | fpr=0.1189 | 7534.5 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.44561 | acc=0.8815 | tpr=0.9625 | fpr=0.1200 | 7372.6 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.44617 | acc=0.8823 | tpr=0.9628 | fpr=0.1192 | 7251.5 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.44448 | acc=0.8823 | tpr=0.9642 | fpr=0.1192 | 7536.4 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.44317 | acc=0.8829 | tpr=0.9600 | fpr=0.1185 | 7422.2 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.44585 | acc=0.8830 | tpr=0.9574 | fpr=0.1183 | 7360.0 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.44680 | acc=0.8831 | tpr=0.9551 | fpr=0.1183 | 7227.0 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.45122 | acc=0.8824 | tpr=0.9557 | fpr=0.1189 | 7382.7 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.45174 | acc=0.8823 | tpr=0.9577 | fpr=0.1191 | 7259.2 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.45101 | acc=0.8823 | tpr=0.9598 | fpr=0.1191 | 13232.4 samples/s | 51.7 steps/s
Avg test loss: 0.45079, Avg test acc: 0.88232, Avg tpr: 0.95998, Avg fpr: 0.11909, total FA: 16535

server round 49/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.2] | Loss=0.04254 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.157 | L2-Norm(final)=3.489 | 3651.5 samples/s | 57.1 steps/s
[Step=39250 Epoch=191.4] | Loss=0.01962 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.150 | L2-Norm(final)=3.486 | 3808.2 samples/s | 59.5 steps/s
[Step=39300 Epoch=191.6] | Loss=0.01293 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.145 | L2-Norm(final)=3.485 | 3772.1 samples/s | 58.9 steps/s
[Step=39350 Epoch=191.9] | Loss=0.01004 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.142 | L2-Norm(final)=3.486 | 3782.6 samples/s | 59.1 steps/s
[Step=39400 Epoch=192.1] | Loss=0.00900 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.141 | L2-Norm(final)=3.487 | 4710.2 samples/s | 73.6 steps/s
[Step=39450 Epoch=192.4] | Loss=0.00772 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.139 | L2-Norm(final)=3.487 | 1659.4 samples/s | 25.9 steps/s
[Step=39500 Epoch=192.6] | Loss=0.00695 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.138 | L2-Norm(final)=3.488 | 3762.7 samples/s | 58.8 steps/s
[Step=39550 Epoch=192.9] | Loss=0.00647 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.137 | L2-Norm(final)=3.489 | 3799.0 samples/s | 59.4 steps/s
[Step=39600 Epoch=193.1] | Loss=0.00613 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.137 | L2-Norm(final)=3.490 | 4433.5 samples/s | 69.3 steps/s
[Step=39650 Epoch=193.3] | Loss=0.00574 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.136 | L2-Norm(final)=3.490 | 1701.3 samples/s | 26.6 steps/s
[Step=39700 Epoch=193.6] | Loss=0.00547 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.135 | L2-Norm(final)=3.491 | 3755.8 samples/s | 58.7 steps/s
[Step=39750 Epoch=193.8] | Loss=0.00528 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.135 | L2-Norm(final)=3.492 | 3772.9 samples/s | 59.0 steps/s
[Step=39800 Epoch=194.1] | Loss=0.00510 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.134 | L2-Norm(final)=3.492 | 4215.1 samples/s | 65.9 steps/s
[Step=39850 Epoch=194.3] | Loss=0.00491 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.134 | L2-Norm(final)=3.493 | 1741.0 samples/s | 27.2 steps/s
[Step=39900 Epoch=194.6] | Loss=0.00465 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.133 | L2-Norm(final)=3.494 | 3784.0 samples/s | 59.1 steps/s
[Step=39950 Epoch=194.8] | Loss=0.00454 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.133 | L2-Norm(final)=3.494 | 3793.6 samples/s | 59.3 steps/s
[Step=40000 Epoch=195.0] | Loss=0.00446 | Reg=0.00260 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.133 | L2-Norm(final)=3.495 | 4043.5 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.3] | Loss=0.07353 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.157 | L2-Norm(final)=3.489 | 3922.6 samples/s | 61.3 steps/s
[Step=39250 Epoch=191.5] | Loss=0.01429 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.148 | L2-Norm(final)=3.487 | 3591.2 samples/s | 56.1 steps/s
[Step=39300 Epoch=191.8] | Loss=0.00996 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.144 | L2-Norm(final)=3.487 | 3779.1 samples/s | 59.0 steps/s
[Step=39350 Epoch=192.0] | Loss=0.00864 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.141 | L2-Norm(final)=3.487 | 3783.8 samples/s | 59.1 steps/s
[Step=39400 Epoch=192.3] | Loss=0.00775 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.139 | L2-Norm(final)=3.488 | 4708.6 samples/s | 73.6 steps/s
[Step=39450 Epoch=192.5] | Loss=0.00669 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.138 | L2-Norm(final)=3.489 | 1660.1 samples/s | 25.9 steps/s
[Step=39500 Epoch=192.7] | Loss=0.00600 | Reg=0.00260 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.137 | L2-Norm(final)=3.489 | 3762.6 samples/s | 58.8 steps/s
[Step=39550 Epoch=193.0] | Loss=0.00565 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.136 | L2-Norm(final)=3.490 | 3784.1 samples/s | 59.1 steps/s
[Step=39600 Epoch=193.2] | Loss=0.00513 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.135 | L2-Norm(final)=3.491 | 4507.1 samples/s | 70.4 steps/s
[Step=39650 Epoch=193.5] | Loss=0.00489 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.134 | L2-Norm(final)=3.491 | 1678.4 samples/s | 26.2 steps/s
[Step=39700 Epoch=193.7] | Loss=0.00469 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.134 | L2-Norm(final)=3.492 | 3792.5 samples/s | 59.3 steps/s
[Step=39750 Epoch=194.0] | Loss=0.00441 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.133 | L2-Norm(final)=3.493 | 3771.1 samples/s | 58.9 steps/s
[Step=39800 Epoch=194.2] | Loss=0.00423 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.133 | L2-Norm(final)=3.493 | 4314.4 samples/s | 67.4 steps/s
[Step=39850 Epoch=194.4] | Loss=0.00411 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.132 | L2-Norm(final)=3.494 | 1710.4 samples/s | 26.7 steps/s
[Step=39900 Epoch=194.7] | Loss=0.00399 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.132 | L2-Norm(final)=3.495 | 3780.1 samples/s | 59.1 steps/s
[Step=39950 Epoch=194.9] | Loss=0.00391 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.132 | L2-Norm(final)=3.495 | 3776.6 samples/s | 59.0 steps/s
[Step=40000 Epoch=195.2] | Loss=0.00376 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.131 | L2-Norm(final)=3.496 | 4146.1 samples/s | 64.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step40000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.0] | Loss=0.09763 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.157 | L2-Norm(final)=3.489 | 3862.8 samples/s | 60.4 steps/s
[Step=39250 Epoch=191.2] | Loss=0.01613 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.149 | L2-Norm(final)=3.487 | 3627.6 samples/s | 56.7 steps/s
[Step=39300 Epoch=191.5] | Loss=0.01144 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.144 | L2-Norm(final)=3.487 | 3777.3 samples/s | 59.0 steps/s
[Step=39350 Epoch=191.7] | Loss=0.00894 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.142 | L2-Norm(final)=3.488 | 3796.2 samples/s | 59.3 steps/s
[Step=39400 Epoch=192.0] | Loss=0.00786 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.141 | L2-Norm(final)=3.489 | 4703.3 samples/s | 73.5 steps/s
[Step=39450 Epoch=192.2] | Loss=0.00700 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.140 | L2-Norm(final)=3.490 | 1661.8 samples/s | 26.0 steps/s
[Step=39500 Epoch=192.5] | Loss=0.00641 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.139 | L2-Norm(final)=3.491 | 3786.8 samples/s | 59.2 steps/s
[Step=39550 Epoch=192.7] | Loss=0.00589 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.138 | L2-Norm(final)=3.492 | 3748.2 samples/s | 58.6 steps/s
[Step=39600 Epoch=193.0] | Loss=0.00555 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.137 | L2-Norm(final)=3.493 | 4450.7 samples/s | 69.5 steps/s
[Step=39650 Epoch=193.2] | Loss=0.00517 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.136 | L2-Norm(final)=3.494 | 1711.1 samples/s | 26.7 steps/s
[Step=39700 Epoch=193.4] | Loss=0.00483 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.136 | L2-Norm(final)=3.495 | 3781.8 samples/s | 59.1 steps/s
[Step=39750 Epoch=193.7] | Loss=0.00462 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.135 | L2-Norm(final)=3.496 | 3796.3 samples/s | 59.3 steps/s
[Step=39800 Epoch=193.9] | Loss=0.00448 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.135 | L2-Norm(final)=3.496 | 4243.0 samples/s | 66.3 steps/s
[Step=39850 Epoch=194.2] | Loss=0.00425 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.135 | L2-Norm(final)=3.497 | 1739.3 samples/s | 27.2 steps/s
[Step=39900 Epoch=194.4] | Loss=0.00406 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.135 | L2-Norm(final)=3.498 | 3766.0 samples/s | 58.8 steps/s
[Step=39950 Epoch=194.7] | Loss=0.00398 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.134 | L2-Norm(final)=3.499 | 3789.6 samples/s | 59.2 steps/s
[Step=40000 Epoch=194.9] | Loss=0.00386 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.134 | L2-Norm(final)=3.500 | 4039.0 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_2/client_state-step40000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.2] | Loss=0.04060 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.157 | L2-Norm(final)=3.489 | 3568.5 samples/s | 55.8 steps/s
[Step=39250 Epoch=191.4] | Loss=0.01742 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.150 | L2-Norm(final)=3.487 | 3846.0 samples/s | 60.1 steps/s
[Step=39300 Epoch=191.6] | Loss=0.01129 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.147 | L2-Norm(final)=3.487 | 3777.8 samples/s | 59.0 steps/s
[Step=39350 Epoch=191.9] | Loss=0.00917 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.145 | L2-Norm(final)=3.487 | 3797.7 samples/s | 59.3 steps/s
[Step=39400 Epoch=192.1] | Loss=0.00809 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.144 | L2-Norm(final)=3.488 | 4698.5 samples/s | 73.4 steps/s
[Step=39450 Epoch=192.4] | Loss=0.00694 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.143 | L2-Norm(final)=3.489 | 1667.0 samples/s | 26.0 steps/s
[Step=39500 Epoch=192.6] | Loss=0.00618 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.142 | L2-Norm(final)=3.490 | 3790.3 samples/s | 59.2 steps/s
[Step=39550 Epoch=192.9] | Loss=0.00564 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.141 | L2-Norm(final)=3.491 | 3773.0 samples/s | 59.0 steps/s
[Step=39600 Epoch=193.1] | Loss=0.00528 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.140 | L2-Norm(final)=3.491 | 4441.6 samples/s | 69.4 steps/s
[Step=39650 Epoch=193.4] | Loss=0.00499 | Reg=0.00260 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.140 | L2-Norm(final)=3.492 | 1703.9 samples/s | 26.6 steps/s
[Step=39700 Epoch=193.6] | Loss=0.00477 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.139 | L2-Norm(final)=3.493 | 3772.2 samples/s | 58.9 steps/s
[Step=39750 Epoch=193.8] | Loss=0.00447 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.138 | L2-Norm(final)=3.494 | 3783.0 samples/s | 59.1 steps/s
[Step=39800 Epoch=194.1] | Loss=0.00434 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.138 | L2-Norm(final)=3.495 | 4255.4 samples/s | 66.5 steps/s
[Step=39850 Epoch=194.3] | Loss=0.00414 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.137 | L2-Norm(final)=3.495 | 1735.8 samples/s | 27.1 steps/s
[Step=39900 Epoch=194.6] | Loss=0.00401 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.137 | L2-Norm(final)=3.496 | 3806.0 samples/s | 59.5 steps/s
[Step=39950 Epoch=194.8] | Loss=0.00385 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.137 | L2-Norm(final)=3.497 | 3785.1 samples/s | 59.1 steps/s
[Step=40000 Epoch=195.1] | Loss=0.00378 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.136 | L2-Norm(final)=3.498 | 4055.1 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_3/client_state-step40000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=192.2] | Loss=0.02291 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.157 | L2-Norm(final)=3.489 | 3768.9 samples/s | 58.9 steps/s
[Step=39250 Epoch=192.5] | Loss=0.01958 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.149 | L2-Norm(final)=3.486 | 3653.1 samples/s | 57.1 steps/s
[Step=39300 Epoch=192.7] | Loss=0.01307 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.144 | L2-Norm(final)=3.486 | 3771.5 samples/s | 58.9 steps/s
[Step=39350 Epoch=193.0] | Loss=0.01023 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.142 | L2-Norm(final)=3.486 | 3788.6 samples/s | 59.2 steps/s
[Step=39400 Epoch=193.2] | Loss=0.00865 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.140 | L2-Norm(final)=3.487 | 4752.7 samples/s | 74.3 steps/s
[Step=39450 Epoch=193.5] | Loss=0.00745 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.139 | L2-Norm(final)=3.488 | 1644.0 samples/s | 25.7 steps/s
[Step=39500 Epoch=193.7] | Loss=0.00672 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.138 | L2-Norm(final)=3.488 | 3743.6 samples/s | 58.5 steps/s
[Step=39550 Epoch=193.9] | Loss=0.00617 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.137 | L2-Norm(final)=3.489 | 3759.1 samples/s | 58.7 steps/s
[Step=39600 Epoch=194.2] | Loss=0.00565 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.137 | L2-Norm(final)=3.490 | 4533.3 samples/s | 70.8 steps/s
[Step=39650 Epoch=194.4] | Loss=0.00527 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.136 | L2-Norm(final)=3.491 | 1651.7 samples/s | 25.8 steps/s
[Step=39700 Epoch=194.7] | Loss=0.00496 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.136 | L2-Norm(final)=3.492 | 3783.3 samples/s | 59.1 steps/s
[Step=39750 Epoch=194.9] | Loss=0.00468 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.135 | L2-Norm(final)=3.492 | 3620.4 samples/s | 56.6 steps/s
[Step=39800 Epoch=195.2] | Loss=0.00452 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.135 | L2-Norm(final)=3.493 | 4248.9 samples/s | 66.4 steps/s
[Step=39850 Epoch=195.4] | Loss=0.00433 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.134 | L2-Norm(final)=3.494 | 1067.7 samples/s | 16.7 steps/s
[Step=39900 Epoch=195.7] | Loss=0.00412 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.134 | L2-Norm(final)=3.495 | 3493.5 samples/s | 54.6 steps/s
[Step=39950 Epoch=195.9] | Loss=0.00400 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.134 | L2-Norm(final)=3.496 | 3600.0 samples/s | 56.2 steps/s
[Step=40000 Epoch=196.2] | Loss=0.00392 | Reg=0.00260 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.134 | L2-Norm(final)=3.496 | 4020.8 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_asml1_4/client_state-step40000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=371.5] | Loss=0.04481 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.157 | L2-Norm(final)=3.490 | 3765.1 samples/s | 58.8 steps/s
[Step=39250 Epoch=371.9] | Loss=0.00584 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.124 | L2-Norm(final)=3.493 | 3396.2 samples/s | 53.1 steps/s
[Step=39300 Epoch=372.4] | Loss=0.00294 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.118 | L2-Norm(final)=3.493 | 4535.5 samples/s | 70.9 steps/s
[Step=39350 Epoch=372.9] | Loss=0.00196 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.114 | L2-Norm(final)=3.493 | 1598.0 samples/s | 25.0 steps/s
[Step=39400 Epoch=373.3] | Loss=0.00148 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.111 | L2-Norm(final)=3.493 | 4246.5 samples/s | 66.4 steps/s
[Step=39450 Epoch=373.8] | Loss=0.00119 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.109 | L2-Norm(final)=3.493 | 1649.7 samples/s | 25.8 steps/s
[Step=39500 Epoch=374.3] | Loss=0.00099 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.107 | L2-Norm(final)=3.493 | 4040.0 samples/s | 63.1 steps/s
[Step=39550 Epoch=374.8] | Loss=0.00085 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.105 | L2-Norm(final)=3.493 | 1686.8 samples/s | 26.4 steps/s
[Step=39600 Epoch=375.2] | Loss=0.00075 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.104 | L2-Norm(final)=3.493 | 3810.5 samples/s | 59.5 steps/s
[Step=39650 Epoch=375.7] | Loss=0.00067 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.103 | L2-Norm(final)=3.493 | 1725.2 samples/s | 27.0 steps/s
[Step=39700 Epoch=376.2] | Loss=0.00060 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.101 | L2-Norm(final)=3.493 | 3669.4 samples/s | 57.3 steps/s
[Step=39750 Epoch=376.7] | Loss=0.00055 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.100 | L2-Norm(final)=3.493 | 1750.2 samples/s | 27.3 steps/s
[Step=39800 Epoch=377.1] | Loss=0.00050 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.099 | L2-Norm(final)=3.493 | 3624.1 samples/s | 56.6 steps/s
[Step=39850 Epoch=377.6] | Loss=0.00046 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.098 | L2-Norm(final)=3.493 | 1763.8 samples/s | 27.6 steps/s
[Step=39900 Epoch=378.1] | Loss=0.00043 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.097 | L2-Norm(final)=3.493 | 3611.8 samples/s | 56.4 steps/s
[Step=39950 Epoch=378.6] | Loss=0.00040 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.096 | L2-Norm(final)=3.493 | 1788.5 samples/s | 27.9 steps/s
[Step=40000 Epoch=379.0] | Loss=0.00038 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.095 | L2-Norm(final)=3.493 | 3533.7 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step40000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=372.9] | Loss=0.11654 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.157 | L2-Norm(final)=3.489 | 3685.5 samples/s | 57.6 steps/s
[Step=39250 Epoch=373.4] | Loss=0.00448 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.124 | L2-Norm(final)=3.492 | 3486.1 samples/s | 54.5 steps/s
[Step=39300 Epoch=373.8] | Loss=0.00226 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.118 | L2-Norm(final)=3.493 | 4529.3 samples/s | 70.8 steps/s
[Step=39350 Epoch=374.3] | Loss=0.00152 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.114 | L2-Norm(final)=3.493 | 1608.5 samples/s | 25.1 steps/s
[Step=39400 Epoch=374.8] | Loss=0.00114 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.111 | L2-Norm(final)=3.493 | 4263.8 samples/s | 66.6 steps/s
[Step=39450 Epoch=375.3] | Loss=0.00092 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.109 | L2-Norm(final)=3.493 | 1653.3 samples/s | 25.8 steps/s
[Step=39500 Epoch=375.7] | Loss=0.00077 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.107 | L2-Norm(final)=3.493 | 4041.2 samples/s | 63.1 steps/s
[Step=39550 Epoch=376.2] | Loss=0.00066 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.105 | L2-Norm(final)=3.493 | 1690.7 samples/s | 26.4 steps/s
[Step=39600 Epoch=376.7] | Loss=0.00058 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.104 | L2-Norm(final)=3.493 | 3831.3 samples/s | 59.9 steps/s
[Step=39650 Epoch=377.2] | Loss=0.00052 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.103 | L2-Norm(final)=3.493 | 1722.8 samples/s | 26.9 steps/s
[Step=39700 Epoch=377.6] | Loss=0.00047 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.101 | L2-Norm(final)=3.493 | 3662.7 samples/s | 57.2 steps/s
[Step=39750 Epoch=378.1] | Loss=0.00043 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.100 | L2-Norm(final)=3.493 | 1754.0 samples/s | 27.4 steps/s
[Step=39800 Epoch=378.6] | Loss=0.00040 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.099 | L2-Norm(final)=3.493 | 3606.6 samples/s | 56.4 steps/s
[Step=39850 Epoch=379.1] | Loss=0.00037 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.098 | L2-Norm(final)=3.493 | 1782.3 samples/s | 27.8 steps/s
[Step=39900 Epoch=379.5] | Loss=0.00034 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.097 | L2-Norm(final)=3.493 | 3626.0 samples/s | 56.7 steps/s
[Step=39950 Epoch=380.0] | Loss=0.00032 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.096 | L2-Norm(final)=3.493 | 1796.3 samples/s | 28.1 steps/s
[Step=40000 Epoch=380.5] | Loss=0.00030 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.096 | L2-Norm(final)=3.493 | 3561.7 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step40000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=374.3] | Loss=0.01172 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.157 | L2-Norm(final)=3.489 | 3561.5 samples/s | 55.6 steps/s
[Step=39250 Epoch=374.8] | Loss=0.00447 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.126 | L2-Norm(final)=3.493 | 3598.4 samples/s | 56.2 steps/s
[Step=39300 Epoch=375.3] | Loss=0.00225 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.120 | L2-Norm(final)=3.494 | 4550.2 samples/s | 71.1 steps/s
[Step=39350 Epoch=375.8] | Loss=0.00150 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.116 | L2-Norm(final)=3.494 | 1596.7 samples/s | 24.9 steps/s
[Step=39400 Epoch=376.2] | Loss=0.00113 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.113 | L2-Norm(final)=3.494 | 4330.7 samples/s | 67.7 steps/s
[Step=39450 Epoch=376.7] | Loss=0.00091 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.111 | L2-Norm(final)=3.494 | 1635.5 samples/s | 25.6 steps/s
[Step=39500 Epoch=377.2] | Loss=0.00076 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.109 | L2-Norm(final)=3.494 | 4027.6 samples/s | 62.9 steps/s
[Step=39550 Epoch=377.7] | Loss=0.00065 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.107 | L2-Norm(final)=3.494 | 1587.5 samples/s | 24.8 steps/s
[Step=39600 Epoch=378.2] | Loss=0.00057 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.106 | L2-Norm(final)=3.494 | 3550.7 samples/s | 55.5 steps/s
[Step=39650 Epoch=378.6] | Loss=0.00051 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.105 | L2-Norm(final)=3.494 | 1558.6 samples/s | 24.4 steps/s
[Step=39700 Epoch=379.1] | Loss=0.00046 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.103 | L2-Norm(final)=3.494 | 3364.6 samples/s | 52.6 steps/s
[Step=39750 Epoch=379.6] | Loss=0.00042 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.102 | L2-Norm(final)=3.494 | 1548.8 samples/s | 24.2 steps/s
[Step=39800 Epoch=380.1] | Loss=0.00039 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.101 | L2-Norm(final)=3.494 | 3304.7 samples/s | 51.6 steps/s
[Step=39850 Epoch=380.5] | Loss=0.00036 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.100 | L2-Norm(final)=3.494 | 1662.8 samples/s | 26.0 steps/s
[Step=39900 Epoch=381.0] | Loss=0.00033 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.099 | L2-Norm(final)=3.494 | 3604.8 samples/s | 56.3 steps/s
[Step=39950 Epoch=381.5] | Loss=0.00031 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.098 | L2-Norm(final)=3.494 | 1777.4 samples/s | 27.8 steps/s
[Step=40000 Epoch=382.0] | Loss=0.00029 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.098 | L2-Norm(final)=3.494 | 3605.8 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_2/client_state-step40000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=369.4] | Loss=0.00408 | Reg=0.00261 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.157 | L2-Norm(final)=3.489 | 3886.5 samples/s | 60.7 steps/s
[Step=39250 Epoch=369.8] | Loss=0.00437 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.124 | L2-Norm(final)=3.492 | 3316.1 samples/s | 51.8 steps/s
[Step=39300 Epoch=370.3] | Loss=0.00220 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.117 | L2-Norm(final)=3.493 | 4494.4 samples/s | 70.2 steps/s
[Step=39350 Epoch=370.8] | Loss=0.00148 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.113 | L2-Norm(final)=3.493 | 1616.8 samples/s | 25.3 steps/s
[Step=39400 Epoch=371.3] | Loss=0.00111 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.111 | L2-Norm(final)=3.493 | 4188.2 samples/s | 65.4 steps/s
[Step=39450 Epoch=371.7] | Loss=0.00090 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.108 | L2-Norm(final)=3.493 | 1653.6 samples/s | 25.8 steps/s
[Step=39500 Epoch=372.2] | Loss=0.00075 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.107 | L2-Norm(final)=3.493 | 3956.7 samples/s | 61.8 steps/s
[Step=39550 Epoch=372.7] | Loss=0.00065 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.105 | L2-Norm(final)=3.493 | 1713.6 samples/s | 26.8 steps/s
[Step=39600 Epoch=373.1] | Loss=0.00057 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.103 | L2-Norm(final)=3.493 | 3734.5 samples/s | 58.4 steps/s
[Step=39650 Epoch=373.6] | Loss=0.00051 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.102 | L2-Norm(final)=3.493 | 1752.9 samples/s | 27.4 steps/s
[Step=39700 Epoch=374.1] | Loss=0.00046 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.101 | L2-Norm(final)=3.493 | 3585.5 samples/s | 56.0 steps/s
[Step=39750 Epoch=374.6] | Loss=0.00042 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.100 | L2-Norm(final)=3.493 | 1770.4 samples/s | 27.7 steps/s
[Step=39800 Epoch=375.0] | Loss=0.00038 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.099 | L2-Norm(final)=3.493 | 3607.7 samples/s | 56.4 steps/s
[Step=39850 Epoch=375.5] | Loss=0.00036 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.098 | L2-Norm(final)=3.493 | 1771.6 samples/s | 27.7 steps/s
[Step=39900 Epoch=376.0] | Loss=0.00033 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.097 | L2-Norm(final)=3.493 | 3569.0 samples/s | 55.8 steps/s
[Step=39950 Epoch=376.4] | Loss=0.00031 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.096 | L2-Norm(final)=3.493 | 1838.4 samples/s | 28.7 steps/s
[Step=40000 Epoch=376.9] | Loss=0.00029 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.095 | L2-Norm(final)=3.493 | 3393.8 samples/s | 53.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_3/client_state-step40000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=373.6] | Loss=0.07051 | Reg=0.00261 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.157 | L2-Norm(final)=3.489 | 3707.8 samples/s | 57.9 steps/s
[Step=39250 Epoch=374.1] | Loss=0.00656 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.127 | L2-Norm(final)=3.493 | 3534.0 samples/s | 55.2 steps/s
[Step=39300 Epoch=374.6] | Loss=0.00330 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.121 | L2-Norm(final)=3.493 | 4558.9 samples/s | 71.2 steps/s
[Step=39350 Epoch=375.0] | Loss=0.00221 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.117 | L2-Norm(final)=3.493 | 1600.5 samples/s | 25.0 steps/s
[Step=39400 Epoch=375.5] | Loss=0.00167 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.114 | L2-Norm(final)=3.493 | 4297.6 samples/s | 67.1 steps/s
[Step=39450 Epoch=376.0] | Loss=0.00134 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.112 | L2-Norm(final)=3.493 | 1642.8 samples/s | 25.7 steps/s
[Step=39500 Epoch=376.5] | Loss=0.00112 | Reg=0.00260 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.110 | L2-Norm(final)=3.493 | 4124.2 samples/s | 64.4 steps/s
[Step=39550 Epoch=376.9] | Loss=0.00096 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.109 | L2-Norm(final)=3.493 | 1675.1 samples/s | 26.2 steps/s
[Step=39600 Epoch=377.4] | Loss=0.00085 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.107 | L2-Norm(final)=3.493 | 3944.1 samples/s | 61.6 steps/s
[Step=39650 Epoch=377.9] | Loss=0.00075 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.106 | L2-Norm(final)=3.493 | 1691.2 samples/s | 26.4 steps/s
[Step=39700 Epoch=378.4] | Loss=0.00068 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.105 | L2-Norm(final)=3.493 | 3779.3 samples/s | 59.1 steps/s
[Step=39750 Epoch=378.9] | Loss=0.00062 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.104 | L2-Norm(final)=3.493 | 1725.2 samples/s | 27.0 steps/s
[Step=39800 Epoch=379.3] | Loss=0.00057 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.103 | L2-Norm(final)=3.493 | 3658.3 samples/s | 57.2 steps/s
[Step=39850 Epoch=379.8] | Loss=0.00053 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.102 | L2-Norm(final)=3.493 | 1766.7 samples/s | 27.6 steps/s
[Step=39900 Epoch=380.3] | Loss=0.00049 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.101 | L2-Norm(final)=3.493 | 3614.0 samples/s | 56.5 steps/s
[Step=39950 Epoch=380.8] | Loss=0.00046 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.100 | L2-Norm(final)=3.493 | 1760.8 samples/s | 27.5 steps/s
[Step=40000 Epoch=381.2] | Loss=0.00043 | Reg=0.00259 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.099 | L2-Norm(final)=3.493 | 3633.5 samples/s | 56.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3-withl2/client_iccad2012_4/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23310 | acc=0.8877 | tpr=0.8435 | fpr=0.0164 | 3890.5 samples/s | 15.2 steps/s
Avg test loss: 0.23490, Avg test acc: 0.88697, Avg tpr: 0.84298, Avg fpr: 0.01628, total FA: 127

Testing server on iccad2012
[Step=  50] | Loss=0.41577 | acc=0.8905 | tpr=0.9602 | fpr=0.1107 | 3916.4 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.42490 | acc=0.8884 | tpr=0.9616 | fpr=0.1129 | 7400.7 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.43107 | acc=0.8871 | tpr=0.9640 | fpr=0.1143 | 7310.5 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.43196 | acc=0.8878 | tpr=0.9617 | fpr=0.1136 | 7419.2 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.43028 | acc=0.8877 | tpr=0.9633 | fpr=0.1137 | 7413.3 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.42940 | acc=0.8883 | tpr=0.9585 | fpr=0.1130 | 7540.6 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.43216 | acc=0.8885 | tpr=0.9562 | fpr=0.1127 | 7373.8 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.43319 | acc=0.8886 | tpr=0.9535 | fpr=0.1126 | 7599.4 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.43752 | acc=0.8880 | tpr=0.9537 | fpr=0.1132 | 7279.1 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.43801 | acc=0.8879 | tpr=0.9559 | fpr=0.1134 | 7463.7 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.43721 | acc=0.8880 | tpr=0.9582 | fpr=0.1132 | 13306.8 samples/s | 52.0 steps/s
Avg test loss: 0.43695, Avg test acc: 0.88803, Avg tpr: 0.95840, Avg fpr: 0.11325, total FA: 15725
