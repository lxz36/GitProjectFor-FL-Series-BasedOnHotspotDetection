#clients of iccad2012: 1
#clients of asml1: 1
select ratio: 1.0
Total num clients: 2
client model path: ['models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0', 'models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (49916, 144, 32)
Resampled dataset to size (65551, 144, 32)
Using transform option: train
#pos = 34281, #neg = 31270
loading data into the main memory...
Allocated dataset with size (18300, 144, 32)
Resampled dataset to size (33952, 144, 32)
Using transform option: train
#pos = 16856, #neg = 17096
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35883 | Reg=0.00000 | acc=0.5156 | FP-Norm=0.000 | FP-Norm(final)=2.017 | 3016.6 samples/s | 47.1 steps/s
[Step=  50 Epoch= 0.0] | Loss=0.29689 | Reg=0.00200 | acc=0.7188 | FP-Norm=1.339 | FP-Norm(final)=2.017 | 3940.3 samples/s | 61.6 steps/s
[Step= 100 Epoch= 0.1] | Loss=0.25532 | Reg=0.00344 | acc=0.8750 | FP-Norm=1.773 | FP-Norm(final)=2.026 | 3991.6 samples/s | 62.4 steps/s
[Step= 150 Epoch= 0.1] | Loss=0.22948 | Reg=0.00461 | acc=0.8438 | FP-Norm=2.059 | FP-Norm(final)=2.035 | 4031.1 samples/s | 63.0 steps/s
[Step= 200 Epoch= 0.2] | Loss=0.21051 | Reg=0.00564 | acc=0.9375 | FP-Norm=2.282 | FP-Norm(final)=2.043 | 3949.0 samples/s | 61.7 steps/s
[Step= 250 Epoch= 0.2] | Loss=0.19714 | Reg=0.00657 | acc=0.8750 | FP-Norm=2.468 | FP-Norm(final)=2.051 | 3886.1 samples/s | 60.7 steps/s
[Step= 300 Epoch= 0.3] | Loss=0.18658 | Reg=0.00741 | acc=0.9531 | FP-Norm=2.624 | FP-Norm(final)=2.058 | 3925.2 samples/s | 61.3 steps/s
[Step= 350 Epoch= 0.3] | Loss=0.17719 | Reg=0.00819 | acc=0.9062 | FP-Norm=2.762 | FP-Norm(final)=2.065 | 3881.2 samples/s | 60.6 steps/s
[Step= 400 Epoch= 0.4] | Loss=0.16938 | Reg=0.00895 | acc=0.9219 | FP-Norm=2.889 | FP-Norm(final)=2.072 | 3893.8 samples/s | 60.8 steps/s
[Step= 450 Epoch= 0.4] | Loss=0.16320 | Reg=0.00964 | acc=0.9531 | FP-Norm=3.001 | FP-Norm(final)=2.078 | 3906.9 samples/s | 61.0 steps/s
[Step= 500 Epoch= 0.5] | Loss=0.15746 | Reg=0.01027 | acc=0.9375 | FP-Norm=3.099 | FP-Norm(final)=2.084 | 3863.6 samples/s | 60.4 steps/s
[Step= 550 Epoch= 0.5] | Loss=0.15320 | Reg=0.01084 | acc=0.9219 | FP-Norm=3.187 | FP-Norm(final)=2.089 | 3892.4 samples/s | 60.8 steps/s
[Step= 600 Epoch= 0.6] | Loss=0.14822 | Reg=0.01137 | acc=0.9062 | FP-Norm=3.267 | FP-Norm(final)=2.094 | 3864.4 samples/s | 60.4 steps/s
[Step= 650 Epoch= 0.6] | Loss=0.14365 | Reg=0.01188 | acc=0.9531 | FP-Norm=3.342 | FP-Norm(final)=2.100 | 3911.4 samples/s | 61.1 steps/s
[Step= 700 Epoch= 0.7] | Loss=0.13975 | Reg=0.01236 | acc=0.9062 | FP-Norm=3.411 | FP-Norm(final)=2.104 | 3877.1 samples/s | 60.6 steps/s
[Step= 750 Epoch= 0.7] | Loss=0.13683 | Reg=0.01280 | acc=0.9531 | FP-Norm=3.475 | FP-Norm(final)=2.108 | 3924.5 samples/s | 61.3 steps/s
[Step= 800 Epoch= 0.8] | Loss=0.13357 | Reg=0.01323 | acc=0.9375 | FP-Norm=3.535 | FP-Norm(final)=2.112 | 3937.3 samples/s | 61.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34941 | Reg=0.00000 | acc=0.4531 | FP-Norm=0.000 | FP-Norm(final)=2.016 | 4139.2 samples/s | 64.7 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.15868 | Reg=0.00310 | acc=0.9375 | FP-Norm=1.657 | FP-Norm(final)=2.041 | 3457.7 samples/s | 54.0 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.10582 | Reg=0.00454 | acc=0.9844 | FP-Norm=2.050 | FP-Norm(final)=2.054 | 3702.7 samples/s | 57.9 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.08087 | Reg=0.00532 | acc=1.0000 | FP-Norm=2.241 | FP-Norm(final)=2.065 | 3635.9 samples/s | 56.8 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.06644 | Reg=0.00587 | acc=1.0000 | FP-Norm=2.366 | FP-Norm(final)=2.073 | 3690.1 samples/s | 57.7 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.05586 | Reg=0.00622 | acc=1.0000 | FP-Norm=2.445 | FP-Norm(final)=2.079 | 3671.0 samples/s | 57.4 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.04831 | Reg=0.00645 | acc=0.9844 | FP-Norm=2.498 | FP-Norm(final)=2.085 | 3705.9 samples/s | 57.9 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.04517 | Reg=0.00666 | acc=0.9375 | FP-Norm=2.543 | FP-Norm(final)=2.090 | 3677.9 samples/s | 57.5 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.04192 | Reg=0.00710 | acc=0.9844 | FP-Norm=2.624 | FP-Norm(final)=2.092 | 3723.8 samples/s | 58.2 steps/s
[Step= 450 Epoch= 0.8] | Loss=0.03831 | Reg=0.00744 | acc=1.0000 | FP-Norm=2.686 | FP-Norm(final)=2.096 | 3640.8 samples/s | 56.9 steps/s
[Step= 500 Epoch= 0.9] | Loss=0.03505 | Reg=0.00766 | acc=1.0000 | FP-Norm=2.728 | FP-Norm(final)=2.099 | 3717.0 samples/s | 58.1 steps/s
[Step= 550 Epoch= 1.0] | Loss=0.03266 | Reg=0.00780 | acc=1.0000 | FP-Norm=2.756 | FP-Norm(final)=2.103 | 1932.8 samples/s | 30.2 steps/s
[Step= 600 Epoch= 1.1] | Loss=0.03018 | Reg=0.00791 | acc=1.0000 | FP-Norm=2.777 | FP-Norm(final)=2.106 | 3756.9 samples/s | 58.7 steps/s
[Step= 650 Epoch= 1.2] | Loss=0.02819 | Reg=0.00796 | acc=1.0000 | FP-Norm=2.789 | FP-Norm(final)=2.109 | 3622.5 samples/s | 56.6 steps/s
[Step= 700 Epoch= 1.3] | Loss=0.02645 | Reg=0.00800 | acc=1.0000 | FP-Norm=2.798 | FP-Norm(final)=2.113 | 3769.2 samples/s | 58.9 steps/s
[Step= 750 Epoch= 1.4] | Loss=0.02490 | Reg=0.00802 | acc=1.0000 | FP-Norm=2.804 | FP-Norm(final)=2.117 | 3684.6 samples/s | 57.6 steps/s
[Step= 800 Epoch= 1.5] | Loss=0.02368 | Reg=0.00802 | acc=0.9844 | FP-Norm=2.806 | FP-Norm(final)=2.120 | 3717.9 samples/s | 58.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35174 | acc=0.5537 | tpr=0.3754 | fpr=0.0592 | 4061.6 samples/s | 15.9 steps/s
Avg test loss: 0.35230, Avg test acc: 0.55317, Avg tpr: 0.37664, Avg fpr: 0.05858, total FA: 457

Testing server on iccad2012
[Step=  50] | Loss=0.20803 | acc=0.8674 | tpr=0.8451 | fpr=0.1322 | 3978.6 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.20645 | acc=0.8691 | tpr=0.8380 | fpr=0.1303 | 7448.6 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.20762 | acc=0.8673 | tpr=0.8501 | fpr=0.1323 | 7413.8 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.20743 | acc=0.8677 | tpr=0.8568 | fpr=0.1321 | 7358.8 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.20706 | acc=0.8687 | tpr=0.8498 | fpr=0.1310 | 7286.4 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.20693 | acc=0.8694 | tpr=0.8495 | fpr=0.1302 | 7243.7 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.20696 | acc=0.8694 | tpr=0.8491 | fpr=0.1303 | 7417.6 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.20735 | acc=0.8688 | tpr=0.8501 | fpr=0.1309 | 7292.6 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.20749 | acc=0.8686 | tpr=0.8525 | fpr=0.1311 | 6989.6 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.20751 | acc=0.8687 | tpr=0.8559 | fpr=0.1311 | 7079.6 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.20740 | acc=0.8686 | tpr=0.8548 | fpr=0.1311 | 13718.9 samples/s | 53.6 steps/s
Avg test loss: 0.20741, Avg test acc: 0.86861, Avg tpr: 0.85460, Avg fpr: 0.13114, total FA: 18208

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 0.8] | Loss=0.32828 | Reg=0.00000 | acc=0.5781 | FP-Norm=0.000 | FP-Norm(final)=2.155 | 4623.9 samples/s | 72.2 steps/s
[Step= 850 Epoch= 0.8] | Loss=0.14817 | Reg=0.00222 | acc=0.8906 | FP-Norm=1.405 | FP-Norm(final)=2.164 | 3610.2 samples/s | 56.4 steps/s
[Step= 900 Epoch= 0.9] | Loss=0.13426 | Reg=0.00282 | acc=0.8906 | FP-Norm=1.627 | FP-Norm(final)=2.174 | 3813.1 samples/s | 59.6 steps/s
[Step= 950 Epoch= 0.9] | Loss=0.12175 | Reg=0.00323 | acc=0.9688 | FP-Norm=1.756 | FP-Norm(final)=2.181 | 3854.1 samples/s | 60.2 steps/s
[Step=1000 Epoch= 1.0] | Loss=0.11447 | Reg=0.00367 | acc=0.9219 | FP-Norm=1.875 | FP-Norm(final)=2.188 | 3828.3 samples/s | 59.8 steps/s
[Step=1050 Epoch= 1.0] | Loss=0.11008 | Reg=0.00404 | acc=0.9375 | FP-Norm=1.970 | FP-Norm(final)=2.194 | 3837.0 samples/s | 60.0 steps/s
[Step=1100 Epoch= 1.1] | Loss=0.10627 | Reg=0.00443 | acc=0.9531 | FP-Norm=2.062 | FP-Norm(final)=2.198 | 3853.1 samples/s | 60.2 steps/s
[Step=1150 Epoch= 1.1] | Loss=0.10455 | Reg=0.00482 | acc=0.9219 | FP-Norm=2.150 | FP-Norm(final)=2.202 | 3837.5 samples/s | 60.0 steps/s
[Step=1200 Epoch= 1.2] | Loss=0.10240 | Reg=0.00523 | acc=0.9219 | FP-Norm=2.237 | FP-Norm(final)=2.204 | 3860.2 samples/s | 60.3 steps/s
[Step=1250 Epoch= 1.2] | Loss=0.10108 | Reg=0.00561 | acc=0.9531 | FP-Norm=2.315 | FP-Norm(final)=2.206 | 3868.3 samples/s | 60.4 steps/s
[Step=1300 Epoch= 1.3] | Loss=0.09875 | Reg=0.00595 | acc=0.9375 | FP-Norm=2.384 | FP-Norm(final)=2.208 | 3821.2 samples/s | 59.7 steps/s
[Step=1350 Epoch= 1.3] | Loss=0.09702 | Reg=0.00628 | acc=0.9531 | FP-Norm=2.449 | FP-Norm(final)=2.209 | 3852.1 samples/s | 60.2 steps/s
[Step=1400 Epoch= 1.4] | Loss=0.09511 | Reg=0.00660 | acc=0.9375 | FP-Norm=2.509 | FP-Norm(final)=2.211 | 3834.5 samples/s | 59.9 steps/s
[Step=1450 Epoch= 1.4] | Loss=0.09290 | Reg=0.00689 | acc=0.9531 | FP-Norm=2.564 | FP-Norm(final)=2.213 | 3841.0 samples/s | 60.0 steps/s
[Step=1500 Epoch= 1.5] | Loss=0.09106 | Reg=0.00715 | acc=0.9219 | FP-Norm=2.613 | FP-Norm(final)=2.215 | 3851.2 samples/s | 60.2 steps/s
[Step=1550 Epoch= 1.5] | Loss=0.08978 | Reg=0.00741 | acc=0.9531 | FP-Norm=2.660 | FP-Norm(final)=2.218 | 3833.7 samples/s | 59.9 steps/s
[Step=1600 Epoch= 1.6] | Loss=0.08817 | Reg=0.00765 | acc=0.9688 | FP-Norm=2.704 | FP-Norm(final)=2.220 | 3868.2 samples/s | 60.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step1600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 1.5] | Loss=0.20730 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.155 | 4852.9 samples/s | 75.8 steps/s
[Step= 850 Epoch= 1.6] | Loss=0.08837 | Reg=0.00594 | acc=1.0000 | FP-Norm=2.266 | FP-Norm(final)=2.144 | 3134.7 samples/s | 49.0 steps/s
[Step= 900 Epoch= 1.7] | Loss=0.05226 | Reg=0.00767 | acc=1.0000 | FP-Norm=2.665 | FP-Norm(final)=2.141 | 3741.3 samples/s | 58.5 steps/s
[Step= 950 Epoch= 1.8] | Loss=0.03809 | Reg=0.00767 | acc=1.0000 | FP-Norm=2.700 | FP-Norm(final)=2.145 | 3703.9 samples/s | 57.9 steps/s
[Step=1000 Epoch= 1.9] | Loss=0.03061 | Reg=0.00746 | acc=0.9844 | FP-Norm=2.677 | FP-Norm(final)=2.151 | 3656.7 samples/s | 57.1 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.02619 | Reg=0.00721 | acc=0.9844 | FP-Norm=2.640 | FP-Norm(final)=2.154 | 3693.1 samples/s | 57.7 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.02254 | Reg=0.00699 | acc=1.0000 | FP-Norm=2.606 | FP-Norm(final)=2.159 | 3644.0 samples/s | 56.9 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.01984 | Reg=0.00679 | acc=0.9844 | FP-Norm=2.571 | FP-Norm(final)=2.164 | 3704.0 samples/s | 57.9 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.01808 | Reg=0.00662 | acc=1.0000 | FP-Norm=2.541 | FP-Norm(final)=2.168 | 3672.2 samples/s | 57.4 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.01655 | Reg=0.00647 | acc=1.0000 | FP-Norm=2.513 | FP-Norm(final)=2.172 | 3640.2 samples/s | 56.9 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.01542 | Reg=0.00634 | acc=1.0000 | FP-Norm=2.490 | FP-Norm(final)=2.176 | 3670.5 samples/s | 57.4 steps/s
[Step=1350 Epoch= 2.5] | Loss=0.01417 | Reg=0.00623 | acc=1.0000 | FP-Norm=2.469 | FP-Norm(final)=2.180 | 1888.8 samples/s | 29.5 steps/s
[Step=1400 Epoch= 2.6] | Loss=0.01312 | Reg=0.00611 | acc=1.0000 | FP-Norm=2.446 | FP-Norm(final)=2.184 | 3765.9 samples/s | 58.8 steps/s
[Step=1450 Epoch= 2.7] | Loss=0.01220 | Reg=0.00600 | acc=1.0000 | FP-Norm=2.423 | FP-Norm(final)=2.187 | 3611.7 samples/s | 56.4 steps/s
[Step=1500 Epoch= 2.8] | Loss=0.01143 | Reg=0.00588 | acc=1.0000 | FP-Norm=2.400 | FP-Norm(final)=2.191 | 3677.3 samples/s | 57.5 steps/s
[Step=1550 Epoch= 2.9] | Loss=0.01074 | Reg=0.00578 | acc=1.0000 | FP-Norm=2.378 | FP-Norm(final)=2.195 | 3712.1 samples/s | 58.0 steps/s
[Step=1600 Epoch= 3.0] | Loss=0.01015 | Reg=0.00568 | acc=1.0000 | FP-Norm=2.357 | FP-Norm(final)=2.198 | 3752.4 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36560 | acc=0.6267 | tpr=0.4756 | fpr=0.0451 | 3922.3 samples/s | 15.3 steps/s
Avg test loss: 0.36902, Avg test acc: 0.62561, Avg tpr: 0.47392, Avg fpr: 0.04076, total FA: 318

Testing server on iccad2012
[Step=  50] | Loss=0.23459 | acc=0.8032 | tpr=0.9381 | fpr=0.1992 | 4052.0 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.23282 | acc=0.8048 | tpr=0.9510 | fpr=0.1979 | 7034.9 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.23522 | acc=0.8030 | tpr=0.9582 | fpr=0.1999 | 7221.7 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.23556 | acc=0.8026 | tpr=0.9650 | fpr=0.2004 | 7244.1 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.23457 | acc=0.8039 | tpr=0.9651 | fpr=0.1991 | 7144.8 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.23444 | acc=0.8044 | tpr=0.9636 | fpr=0.1985 | 7250.3 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.23470 | acc=0.8042 | tpr=0.9649 | fpr=0.1987 | 7165.0 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.23552 | acc=0.8029 | tpr=0.9666 | fpr=0.2001 | 7361.9 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.23634 | acc=0.8024 | tpr=0.9664 | fpr=0.2006 | 7091.1 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.23650 | acc=0.8022 | tpr=0.9656 | fpr=0.2008 | 7069.1 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.23612 | acc=0.8024 | tpr=0.9666 | fpr=0.2005 | 12953.7 samples/s | 50.6 steps/s
Avg test loss: 0.23612, Avg test acc: 0.80246, Avg tpr: 0.96672, Avg fpr: 0.20052, total FA: 27842

server round 2/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 1.6] | Loss=0.27441 | Reg=0.00000 | acc=0.7344 | FP-Norm=0.000 | FP-Norm(final)=2.244 | 4002.7 samples/s | 62.5 steps/s
[Step=1650 Epoch= 1.6] | Loss=0.10723 | Reg=0.00199 | acc=0.9219 | FP-Norm=1.337 | FP-Norm(final)=2.244 | 3772.2 samples/s | 58.9 steps/s
[Step=1700 Epoch= 1.7] | Loss=0.09321 | Reg=0.00246 | acc=0.9375 | FP-Norm=1.524 | FP-Norm(final)=2.253 | 3818.6 samples/s | 59.7 steps/s
[Step=1750 Epoch= 1.7] | Loss=0.08764 | Reg=0.00271 | acc=0.9844 | FP-Norm=1.612 | FP-Norm(final)=2.259 | 3828.5 samples/s | 59.8 steps/s
[Step=1800 Epoch= 1.8] | Loss=0.08394 | Reg=0.00298 | acc=0.9531 | FP-Norm=1.696 | FP-Norm(final)=2.262 | 3840.1 samples/s | 60.0 steps/s
[Step=1850 Epoch= 1.8] | Loss=0.08265 | Reg=0.00326 | acc=0.8750 | FP-Norm=1.774 | FP-Norm(final)=2.264 | 3833.6 samples/s | 59.9 steps/s
[Step=1900 Epoch= 1.9] | Loss=0.08138 | Reg=0.00352 | acc=0.9062 | FP-Norm=1.845 | FP-Norm(final)=2.265 | 3803.6 samples/s | 59.4 steps/s
[Step=1950 Epoch= 1.9] | Loss=0.07900 | Reg=0.00377 | acc=0.9688 | FP-Norm=1.910 | FP-Norm(final)=2.267 | 3837.9 samples/s | 60.0 steps/s
[Step=2000 Epoch= 2.0] | Loss=0.07782 | Reg=0.00403 | acc=0.9531 | FP-Norm=1.974 | FP-Norm(final)=2.269 | 3826.8 samples/s | 59.8 steps/s
[Step=2050 Epoch= 2.0] | Loss=0.07636 | Reg=0.00427 | acc=0.9375 | FP-Norm=2.030 | FP-Norm(final)=2.272 | 3878.1 samples/s | 60.6 steps/s
[Step=2100 Epoch= 2.1] | Loss=0.07513 | Reg=0.00448 | acc=0.9375 | FP-Norm=2.080 | FP-Norm(final)=2.274 | 3825.2 samples/s | 59.8 steps/s
[Step=2150 Epoch= 2.1] | Loss=0.07320 | Reg=0.00467 | acc=0.9688 | FP-Norm=2.124 | FP-Norm(final)=2.276 | 3791.9 samples/s | 59.2 steps/s
[Step=2200 Epoch= 2.1] | Loss=0.07286 | Reg=0.00488 | acc=0.9531 | FP-Norm=2.170 | FP-Norm(final)=2.278 | 3764.5 samples/s | 58.8 steps/s
[Step=2250 Epoch= 2.2] | Loss=0.07237 | Reg=0.00510 | acc=0.9219 | FP-Norm=2.217 | FP-Norm(final)=2.279 | 3577.6 samples/s | 55.9 steps/s
[Step=2300 Epoch= 2.2] | Loss=0.07174 | Reg=0.00530 | acc=0.9688 | FP-Norm=2.259 | FP-Norm(final)=2.280 | 3832.7 samples/s | 59.9 steps/s
[Step=2350 Epoch= 2.3] | Loss=0.07124 | Reg=0.00549 | acc=0.9688 | FP-Norm=2.299 | FP-Norm(final)=2.281 | 3855.7 samples/s | 60.2 steps/s
[Step=2400 Epoch= 2.3] | Loss=0.07115 | Reg=0.00567 | acc=0.9531 | FP-Norm=2.336 | FP-Norm(final)=2.282 | 3837.2 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step2400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 3.0] | Loss=0.10378 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.244 | 4019.5 samples/s | 62.8 steps/s
[Step=1650 Epoch= 3.1] | Loss=0.02538 | Reg=0.00259 | acc=1.0000 | FP-Norm=1.523 | FP-Norm(final)=2.240 | 3414.3 samples/s | 53.3 steps/s
[Step=1700 Epoch= 3.2] | Loss=0.01920 | Reg=0.00307 | acc=0.9844 | FP-Norm=1.705 | FP-Norm(final)=2.243 | 3667.6 samples/s | 57.3 steps/s
[Step=1750 Epoch= 3.3] | Loss=0.01537 | Reg=0.00329 | acc=1.0000 | FP-Norm=1.779 | FP-Norm(final)=2.245 | 3603.6 samples/s | 56.3 steps/s
[Step=1800 Epoch= 3.4] | Loss=0.01407 | Reg=0.00337 | acc=1.0000 | FP-Norm=1.809 | FP-Norm(final)=2.249 | 3646.6 samples/s | 57.0 steps/s
[Step=1850 Epoch= 3.5] | Loss=0.01296 | Reg=0.00358 | acc=0.9844 | FP-Norm=1.869 | FP-Norm(final)=2.250 | 3651.1 samples/s | 57.0 steps/s
[Step=1900 Epoch= 3.6] | Loss=0.01130 | Reg=0.00372 | acc=1.0000 | FP-Norm=1.907 | FP-Norm(final)=2.252 | 3617.2 samples/s | 56.5 steps/s
[Step=1950 Epoch= 3.7] | Loss=0.01065 | Reg=0.00380 | acc=0.9531 | FP-Norm=1.929 | FP-Norm(final)=2.254 | 3667.9 samples/s | 57.3 steps/s
[Step=2000 Epoch= 3.8] | Loss=0.01005 | Reg=0.00390 | acc=0.9844 | FP-Norm=1.956 | FP-Norm(final)=2.256 | 3604.9 samples/s | 56.3 steps/s
[Step=2050 Epoch= 3.9] | Loss=0.00918 | Reg=0.00401 | acc=1.0000 | FP-Norm=1.986 | FP-Norm(final)=2.258 | 3682.5 samples/s | 57.5 steps/s
[Step=2100 Epoch= 4.0] | Loss=0.00851 | Reg=0.00407 | acc=1.0000 | FP-Norm=2.002 | FP-Norm(final)=2.261 | 3732.2 samples/s | 58.3 steps/s
[Step=2150 Epoch= 4.1] | Loss=0.00779 | Reg=0.00410 | acc=1.0000 | FP-Norm=2.011 | FP-Norm(final)=2.264 | 1965.2 samples/s | 30.7 steps/s
[Step=2200 Epoch= 4.1] | Loss=0.00716 | Reg=0.00410 | acc=1.0000 | FP-Norm=2.010 | FP-Norm(final)=2.266 | 3629.6 samples/s | 56.7 steps/s
[Step=2250 Epoch= 4.2] | Loss=0.00666 | Reg=0.00407 | acc=1.0000 | FP-Norm=2.004 | FP-Norm(final)=2.269 | 3620.0 samples/s | 56.6 steps/s
[Step=2300 Epoch= 4.3] | Loss=0.00621 | Reg=0.00402 | acc=1.0000 | FP-Norm=1.994 | FP-Norm(final)=2.272 | 3657.0 samples/s | 57.1 steps/s
[Step=2350 Epoch= 4.4] | Loss=0.00584 | Reg=0.00397 | acc=1.0000 | FP-Norm=1.981 | FP-Norm(final)=2.275 | 3657.8 samples/s | 57.2 steps/s
[Step=2400 Epoch= 4.5] | Loss=0.00551 | Reg=0.00392 | acc=1.0000 | FP-Norm=1.967 | FP-Norm(final)=2.277 | 3656.4 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26547 | acc=0.7502 | tpr=0.6654 | fpr=0.0657 | 3962.3 samples/s | 15.5 steps/s
Avg test loss: 0.26902, Avg test acc: 0.74858, Avg tpr: 0.66270, Avg fpr: 0.06256, total FA: 488

Testing server on iccad2012
[Step=  50] | Loss=0.36141 | acc=0.7229 | tpr=0.9690 | fpr=0.2815 | 3824.0 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.35922 | acc=0.7247 | tpr=0.9808 | fpr=0.2801 | 7111.3 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.36215 | acc=0.7224 | tpr=0.9841 | fpr=0.2824 | 7226.2 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.36086 | acc=0.7232 | tpr=0.9880 | fpr=0.2817 | 7076.5 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.36043 | acc=0.7229 | tpr=0.9869 | fpr=0.2819 | 7507.1 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.36030 | acc=0.7231 | tpr=0.9855 | fpr=0.2817 | 7080.3 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.36089 | acc=0.7224 | tpr=0.9843 | fpr=0.2823 | 7352.9 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.36223 | acc=0.7213 | tpr=0.9852 | fpr=0.2834 | 7026.9 samples/s | 27.4 steps/s
[Step= 450] | Loss=0.36295 | acc=0.7216 | tpr=0.9859 | fpr=0.2831 | 7229.8 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.36326 | acc=0.7212 | tpr=0.9855 | fpr=0.2835 | 7101.4 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.36253 | acc=0.7215 | tpr=0.9865 | fpr=0.2833 | 13134.5 samples/s | 51.3 steps/s
Avg test loss: 0.36252, Avg test acc: 0.72144, Avg tpr: 0.98653, Avg fpr: 0.28338, total FA: 39347

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 2.3] | Loss=0.19250 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.300 | 4956.5 samples/s | 77.4 steps/s
[Step=2450 Epoch= 2.4] | Loss=0.08661 | Reg=0.00212 | acc=0.9219 | FP-Norm=1.386 | FP-Norm(final)=2.296 | 3491.3 samples/s | 54.6 steps/s
[Step=2500 Epoch= 2.4] | Loss=0.07665 | Reg=0.00245 | acc=0.9688 | FP-Norm=1.525 | FP-Norm(final)=2.298 | 3885.5 samples/s | 60.7 steps/s
[Step=2550 Epoch= 2.5] | Loss=0.07164 | Reg=0.00262 | acc=0.9219 | FP-Norm=1.591 | FP-Norm(final)=2.302 | 3915.6 samples/s | 61.2 steps/s
[Step=2600 Epoch= 2.5] | Loss=0.07023 | Reg=0.00280 | acc=0.9375 | FP-Norm=1.650 | FP-Norm(final)=2.305 | 3934.5 samples/s | 61.5 steps/s
[Step=2650 Epoch= 2.6] | Loss=0.06807 | Reg=0.00297 | acc=0.9844 | FP-Norm=1.702 | FP-Norm(final)=2.307 | 3898.8 samples/s | 60.9 steps/s
[Step=2700 Epoch= 2.6] | Loss=0.06796 | Reg=0.00315 | acc=0.9531 | FP-Norm=1.755 | FP-Norm(final)=2.309 | 3882.2 samples/s | 60.7 steps/s
[Step=2750 Epoch= 2.7] | Loss=0.06770 | Reg=0.00335 | acc=1.0000 | FP-Norm=1.807 | FP-Norm(final)=2.310 | 3660.3 samples/s | 57.2 steps/s
[Step=2800 Epoch= 2.7] | Loss=0.06663 | Reg=0.00353 | acc=0.9531 | FP-Norm=1.855 | FP-Norm(final)=2.311 | 3836.1 samples/s | 59.9 steps/s
[Step=2850 Epoch= 2.8] | Loss=0.06533 | Reg=0.00369 | acc=1.0000 | FP-Norm=1.898 | FP-Norm(final)=2.311 | 3683.2 samples/s | 57.5 steps/s
[Step=2900 Epoch= 2.8] | Loss=0.06454 | Reg=0.00387 | acc=0.9688 | FP-Norm=1.941 | FP-Norm(final)=2.313 | 3615.8 samples/s | 56.5 steps/s
[Step=2950 Epoch= 2.9] | Loss=0.06351 | Reg=0.00404 | acc=0.9844 | FP-Norm=1.983 | FP-Norm(final)=2.314 | 3811.5 samples/s | 59.6 steps/s
[Step=3000 Epoch= 2.9] | Loss=0.06260 | Reg=0.00419 | acc=0.9844 | FP-Norm=2.020 | FP-Norm(final)=2.315 | 3571.3 samples/s | 55.8 steps/s
[Step=3050 Epoch= 3.0] | Loss=0.06200 | Reg=0.00435 | acc=0.9375 | FP-Norm=2.056 | FP-Norm(final)=2.316 | 3716.6 samples/s | 58.1 steps/s
[Step=3100 Epoch= 3.0] | Loss=0.06162 | Reg=0.00451 | acc=1.0000 | FP-Norm=2.092 | FP-Norm(final)=2.318 | 3703.4 samples/s | 57.9 steps/s
[Step=3150 Epoch= 3.1] | Loss=0.06165 | Reg=0.00467 | acc=0.9375 | FP-Norm=2.129 | FP-Norm(final)=2.317 | 3615.0 samples/s | 56.5 steps/s
[Step=3200 Epoch= 3.1] | Loss=0.06118 | Reg=0.00482 | acc=0.9688 | FP-Norm=2.162 | FP-Norm(final)=2.317 | 3839.3 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step3200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 4.5] | Loss=0.08438 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.301 | 3943.1 samples/s | 61.6 steps/s
[Step=2450 Epoch= 4.6] | Loss=0.02042 | Reg=0.00307 | acc=1.0000 | FP-Norm=1.655 | FP-Norm(final)=2.287 | 3552.6 samples/s | 55.5 steps/s
[Step=2500 Epoch= 4.7] | Loss=0.01432 | Reg=0.00343 | acc=1.0000 | FP-Norm=1.800 | FP-Norm(final)=2.284 | 3623.4 samples/s | 56.6 steps/s
[Step=2550 Epoch= 4.8] | Loss=0.01213 | Reg=0.00341 | acc=0.9688 | FP-Norm=1.812 | FP-Norm(final)=2.286 | 3646.5 samples/s | 57.0 steps/s
[Step=2600 Epoch= 4.9] | Loss=0.01132 | Reg=0.00352 | acc=1.0000 | FP-Norm=1.851 | FP-Norm(final)=2.287 | 3614.1 samples/s | 56.5 steps/s
[Step=2650 Epoch= 5.0] | Loss=0.00982 | Reg=0.00366 | acc=0.9844 | FP-Norm=1.891 | FP-Norm(final)=2.288 | 3655.8 samples/s | 57.1 steps/s
[Step=2700 Epoch= 5.1] | Loss=0.00848 | Reg=0.00370 | acc=1.0000 | FP-Norm=1.905 | FP-Norm(final)=2.291 | 3619.0 samples/s | 56.5 steps/s
[Step=2750 Epoch= 5.2] | Loss=0.00800 | Reg=0.00374 | acc=1.0000 | FP-Norm=1.918 | FP-Norm(final)=2.294 | 3705.3 samples/s | 57.9 steps/s
[Step=2800 Epoch= 5.3] | Loss=0.00813 | Reg=0.00391 | acc=1.0000 | FP-Norm=1.960 | FP-Norm(final)=2.296 | 3605.8 samples/s | 56.3 steps/s
[Step=2850 Epoch= 5.4] | Loss=0.00737 | Reg=0.00406 | acc=1.0000 | FP-Norm=1.996 | FP-Norm(final)=2.297 | 3673.6 samples/s | 57.4 steps/s
[Step=2900 Epoch= 5.5] | Loss=0.00681 | Reg=0.00412 | acc=1.0000 | FP-Norm=2.014 | FP-Norm(final)=2.299 | 3680.2 samples/s | 57.5 steps/s
[Step=2950 Epoch= 5.6] | Loss=0.00646 | Reg=0.00419 | acc=1.0000 | FP-Norm=2.031 | FP-Norm(final)=2.301 | 1879.3 samples/s | 29.4 steps/s
[Step=3000 Epoch= 5.7] | Loss=0.00605 | Reg=0.00423 | acc=1.0000 | FP-Norm=2.042 | FP-Norm(final)=2.302 | 3684.3 samples/s | 57.6 steps/s
[Step=3050 Epoch= 5.7] | Loss=0.00564 | Reg=0.00423 | acc=1.0000 | FP-Norm=2.044 | FP-Norm(final)=2.304 | 3620.8 samples/s | 56.6 steps/s
[Step=3100 Epoch= 5.8] | Loss=0.00529 | Reg=0.00421 | acc=1.0000 | FP-Norm=2.040 | FP-Norm(final)=2.306 | 3657.8 samples/s | 57.2 steps/s
[Step=3150 Epoch= 5.9] | Loss=0.00496 | Reg=0.00418 | acc=1.0000 | FP-Norm=2.032 | FP-Norm(final)=2.308 | 3648.1 samples/s | 57.0 steps/s
[Step=3200 Epoch= 6.0] | Loss=0.00467 | Reg=0.00413 | acc=1.0000 | FP-Norm=2.021 | FP-Norm(final)=2.311 | 3652.2 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23015 | acc=0.7930 | tpr=0.7313 | fpr=0.0728 | 3915.9 samples/s | 15.3 steps/s
Avg test loss: 0.23427, Avg test acc: 0.79045, Avg tpr: 0.72839, Avg fpr: 0.07307, total FA: 570

Testing server on iccad2012
[Step=  50] | Loss=0.37092 | acc=0.7358 | tpr=0.9735 | fpr=0.2685 | 3958.9 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.36924 | acc=0.7396 | tpr=0.9744 | fpr=0.2647 | 7074.1 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.37338 | acc=0.7365 | tpr=0.9813 | fpr=0.2680 | 7362.9 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.37236 | acc=0.7362 | tpr=0.9858 | fpr=0.2684 | 6998.7 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.37125 | acc=0.7362 | tpr=0.9825 | fpr=0.2683 | 7186.3 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.37074 | acc=0.7370 | tpr=0.9818 | fpr=0.2675 | 7144.2 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.37137 | acc=0.7368 | tpr=0.9806 | fpr=0.2677 | 7278.5 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.37254 | acc=0.7359 | tpr=0.9814 | fpr=0.2685 | 7193.8 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.37359 | acc=0.7364 | tpr=0.9815 | fpr=0.2680 | 7121.3 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.37335 | acc=0.7363 | tpr=0.9824 | fpr=0.2681 | 7138.3 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.37254 | acc=0.7367 | tpr=0.9825 | fpr=0.2678 | 13107.3 samples/s | 51.2 steps/s
Avg test loss: 0.37255, Avg test acc: 0.73666, Avg tpr: 0.98257, Avg fpr: 0.26781, total FA: 37185

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch= 3.1] | Loss=0.19122 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.328 | 4530.7 samples/s | 70.8 steps/s
[Step=3250 Epoch= 3.2] | Loss=0.07041 | Reg=0.00157 | acc=0.9844 | FP-Norm=1.186 | FP-Norm(final)=2.332 | 3407.0 samples/s | 53.2 steps/s
[Step=3300 Epoch= 3.2] | Loss=0.06367 | Reg=0.00200 | acc=0.9375 | FP-Norm=1.374 | FP-Norm(final)=2.333 | 3702.9 samples/s | 57.9 steps/s
[Step=3350 Epoch= 3.3] | Loss=0.05989 | Reg=0.00225 | acc=0.9844 | FP-Norm=1.468 | FP-Norm(final)=2.336 | 3699.6 samples/s | 57.8 steps/s
[Step=3400 Epoch= 3.3] | Loss=0.05946 | Reg=0.00247 | acc=0.9688 | FP-Norm=1.544 | FP-Norm(final)=2.338 | 3697.8 samples/s | 57.8 steps/s
[Step=3450 Epoch= 3.4] | Loss=0.05943 | Reg=0.00270 | acc=0.9219 | FP-Norm=1.616 | FP-Norm(final)=2.337 | 3720.9 samples/s | 58.1 steps/s
[Step=3500 Epoch= 3.4] | Loss=0.05934 | Reg=0.00292 | acc=0.9844 | FP-Norm=1.681 | FP-Norm(final)=2.335 | 3577.7 samples/s | 55.9 steps/s
[Step=3550 Epoch= 3.5] | Loss=0.05894 | Reg=0.00311 | acc=0.9844 | FP-Norm=1.734 | FP-Norm(final)=2.334 | 3549.9 samples/s | 55.5 steps/s
[Step=3600 Epoch= 3.5] | Loss=0.05880 | Reg=0.00330 | acc=0.9531 | FP-Norm=1.786 | FP-Norm(final)=2.331 | 3579.1 samples/s | 55.9 steps/s
[Step=3650 Epoch= 3.6] | Loss=0.05749 | Reg=0.00347 | acc=0.9688 | FP-Norm=1.832 | FP-Norm(final)=2.330 | 3562.1 samples/s | 55.7 steps/s
[Step=3700 Epoch= 3.6] | Loss=0.05662 | Reg=0.00363 | acc=1.0000 | FP-Norm=1.874 | FP-Norm(final)=2.330 | 3566.3 samples/s | 55.7 steps/s
[Step=3750 Epoch= 3.7] | Loss=0.05623 | Reg=0.00379 | acc=0.9531 | FP-Norm=1.915 | FP-Norm(final)=2.329 | 3655.4 samples/s | 57.1 steps/s
[Step=3800 Epoch= 3.7] | Loss=0.05588 | Reg=0.00395 | acc=0.9219 | FP-Norm=1.954 | FP-Norm(final)=2.327 | 3628.4 samples/s | 56.7 steps/s
[Step=3850 Epoch= 3.8] | Loss=0.05545 | Reg=0.00411 | acc=0.9688 | FP-Norm=1.992 | FP-Norm(final)=2.325 | 3586.9 samples/s | 56.0 steps/s
[Step=3900 Epoch= 3.8] | Loss=0.05535 | Reg=0.00425 | acc=0.9219 | FP-Norm=2.027 | FP-Norm(final)=2.325 | 3555.3 samples/s | 55.6 steps/s
[Step=3950 Epoch= 3.9] | Loss=0.05548 | Reg=0.00440 | acc=0.9375 | FP-Norm=2.061 | FP-Norm(final)=2.323 | 3567.4 samples/s | 55.7 steps/s
[Step=4000 Epoch= 3.9] | Loss=0.05547 | Reg=0.00456 | acc=0.9531 | FP-Norm=2.097 | FP-Norm(final)=2.321 | 3587.0 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step4000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch= 6.0] | Loss=0.09967 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.327 | 4504.1 samples/s | 70.4 steps/s
[Step=3250 Epoch= 6.1] | Loss=0.02335 | Reg=0.00307 | acc=1.0000 | FP-Norm=1.656 | FP-Norm(final)=2.307 | 3324.4 samples/s | 51.9 steps/s
[Step=3300 Epoch= 6.2] | Loss=0.01308 | Reg=0.00361 | acc=1.0000 | FP-Norm=1.844 | FP-Norm(final)=2.304 | 3696.0 samples/s | 57.7 steps/s
[Step=3350 Epoch= 6.3] | Loss=0.01223 | Reg=0.00367 | acc=0.9844 | FP-Norm=1.878 | FP-Norm(final)=2.303 | 3639.2 samples/s | 56.9 steps/s
[Step=3400 Epoch= 6.4] | Loss=0.01037 | Reg=0.00374 | acc=1.0000 | FP-Norm=1.906 | FP-Norm(final)=2.304 | 3641.5 samples/s | 56.9 steps/s
[Step=3450 Epoch= 6.5] | Loss=0.00869 | Reg=0.00375 | acc=1.0000 | FP-Norm=1.914 | FP-Norm(final)=2.307 | 3665.8 samples/s | 57.3 steps/s
[Step=3500 Epoch= 6.6] | Loss=0.00760 | Reg=0.00375 | acc=1.0000 | FP-Norm=1.919 | FP-Norm(final)=2.311 | 3644.3 samples/s | 56.9 steps/s
[Step=3550 Epoch= 6.7] | Loss=0.00675 | Reg=0.00375 | acc=1.0000 | FP-Norm=1.920 | FP-Norm(final)=2.314 | 3664.8 samples/s | 57.3 steps/s
[Step=3600 Epoch= 6.8] | Loss=0.00612 | Reg=0.00372 | acc=1.0000 | FP-Norm=1.915 | FP-Norm(final)=2.319 | 3658.2 samples/s | 57.2 steps/s
[Step=3650 Epoch= 6.9] | Loss=0.00560 | Reg=0.00371 | acc=1.0000 | FP-Norm=1.912 | FP-Norm(final)=2.322 | 3641.4 samples/s | 56.9 steps/s
[Step=3700 Epoch= 7.0] | Loss=0.00548 | Reg=0.00372 | acc=1.0000 | FP-Norm=1.918 | FP-Norm(final)=2.325 | 3680.2 samples/s | 57.5 steps/s
[Step=3750 Epoch= 7.1] | Loss=0.00505 | Reg=0.00375 | acc=1.0000 | FP-Norm=1.925 | FP-Norm(final)=2.327 | 1919.1 samples/s | 30.0 steps/s
[Step=3800 Epoch= 7.2] | Loss=0.00470 | Reg=0.00374 | acc=1.0000 | FP-Norm=1.925 | FP-Norm(final)=2.330 | 3702.7 samples/s | 57.9 steps/s
[Step=3850 Epoch= 7.3] | Loss=0.00434 | Reg=0.00371 | acc=1.0000 | FP-Norm=1.916 | FP-Norm(final)=2.332 | 3626.1 samples/s | 56.7 steps/s
[Step=3900 Epoch= 7.4] | Loss=0.00408 | Reg=0.00366 | acc=1.0000 | FP-Norm=1.903 | FP-Norm(final)=2.335 | 3609.1 samples/s | 56.4 steps/s
[Step=3950 Epoch= 7.4] | Loss=0.00394 | Reg=0.00362 | acc=1.0000 | FP-Norm=1.892 | FP-Norm(final)=2.338 | 3641.2 samples/s | 56.9 steps/s
[Step=4000 Epoch= 7.5] | Loss=0.00374 | Reg=0.00360 | acc=1.0000 | FP-Norm=1.889 | FP-Norm(final)=2.340 | 3650.6 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26915 | acc=0.7659 | tpr=0.6951 | fpr=0.0803 | 3918.7 samples/s | 15.3 steps/s
Avg test loss: 0.27428, Avg test acc: 0.76384, Avg tpr: 0.69144, Avg fpr: 0.07691, total FA: 600

Testing server on iccad2012
[Step=  50] | Loss=0.34139 | acc=0.7659 | tpr=0.9779 | fpr=0.2380 | 3922.2 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.33951 | acc=0.7690 | tpr=0.9851 | fpr=0.2350 | 7276.9 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.34311 | acc=0.7668 | tpr=0.9870 | fpr=0.2373 | 7151.6 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.34120 | acc=0.7681 | tpr=0.9902 | fpr=0.2360 | 7405.0 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.34047 | acc=0.7677 | tpr=0.9886 | fpr=0.2363 | 7118.7 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.34021 | acc=0.7682 | tpr=0.9869 | fpr=0.2358 | 7369.0 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.34003 | acc=0.7683 | tpr=0.9856 | fpr=0.2356 | 7013.0 samples/s | 27.4 steps/s
[Step= 400] | Loss=0.34108 | acc=0.7677 | tpr=0.9863 | fpr=0.2362 | 7754.2 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.34193 | acc=0.7684 | tpr=0.9864 | fpr=0.2356 | 6750.0 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.34181 | acc=0.7682 | tpr=0.9863 | fpr=0.2357 | 7122.6 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.34087 | acc=0.7687 | tpr=0.9869 | fpr=0.2353 | 12939.6 samples/s | 50.5 steps/s
Avg test loss: 0.34085, Avg test acc: 0.76872, Avg tpr: 0.98693, Avg fpr: 0.23524, total FA: 32663

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch= 3.9] | Loss=0.27065 | Reg=0.00000 | acc=0.7656 | FP-Norm=0.000 | FP-Norm(final)=2.332 | 4361.7 samples/s | 68.2 steps/s
[Step=4050 Epoch= 4.0] | Loss=0.06847 | Reg=0.00220 | acc=0.9375 | FP-Norm=1.417 | FP-Norm(final)=2.320 | 3757.1 samples/s | 58.7 steps/s
[Step=4100 Epoch= 4.0] | Loss=0.06097 | Reg=0.00252 | acc=0.9844 | FP-Norm=1.550 | FP-Norm(final)=2.322 | 3819.7 samples/s | 59.7 steps/s
[Step=4150 Epoch= 4.1] | Loss=0.05710 | Reg=0.00266 | acc=0.9688 | FP-Norm=1.605 | FP-Norm(final)=2.324 | 3816.5 samples/s | 59.6 steps/s
[Step=4200 Epoch= 4.1] | Loss=0.05644 | Reg=0.00280 | acc=0.9531 | FP-Norm=1.654 | FP-Norm(final)=2.324 | 3829.1 samples/s | 59.8 steps/s
[Step=4250 Epoch= 4.1] | Loss=0.05380 | Reg=0.00295 | acc=0.9688 | FP-Norm=1.700 | FP-Norm(final)=2.324 | 3827.7 samples/s | 59.8 steps/s
[Step=4300 Epoch= 4.2] | Loss=0.05339 | Reg=0.00308 | acc=0.9688 | FP-Norm=1.739 | FP-Norm(final)=2.323 | 3838.5 samples/s | 60.0 steps/s
[Step=4350 Epoch= 4.2] | Loss=0.05335 | Reg=0.00324 | acc=0.9688 | FP-Norm=1.781 | FP-Norm(final)=2.322 | 3861.1 samples/s | 60.3 steps/s
[Step=4400 Epoch= 4.3] | Loss=0.05441 | Reg=0.00339 | acc=1.0000 | FP-Norm=1.822 | FP-Norm(final)=2.321 | 3877.3 samples/s | 60.6 steps/s
[Step=4450 Epoch= 4.3] | Loss=0.05473 | Reg=0.00354 | acc=0.9531 | FP-Norm=1.861 | FP-Norm(final)=2.319 | 3817.2 samples/s | 59.6 steps/s
[Step=4500 Epoch= 4.4] | Loss=0.05381 | Reg=0.00367 | acc=0.9375 | FP-Norm=1.897 | FP-Norm(final)=2.318 | 3904.1 samples/s | 61.0 steps/s
[Step=4550 Epoch= 4.4] | Loss=0.05285 | Reg=0.00381 | acc=0.9688 | FP-Norm=1.931 | FP-Norm(final)=2.317 | 3954.8 samples/s | 61.8 steps/s
[Step=4600 Epoch= 4.5] | Loss=0.05185 | Reg=0.00394 | acc=0.9844 | FP-Norm=1.964 | FP-Norm(final)=2.315 | 3938.8 samples/s | 61.5 steps/s
[Step=4650 Epoch= 4.5] | Loss=0.05130 | Reg=0.00407 | acc=0.9844 | FP-Norm=1.995 | FP-Norm(final)=2.314 | 3886.4 samples/s | 60.7 steps/s
[Step=4700 Epoch= 4.6] | Loss=0.05134 | Reg=0.00418 | acc=0.9844 | FP-Norm=2.022 | FP-Norm(final)=2.312 | 3834.6 samples/s | 59.9 steps/s
[Step=4750 Epoch= 4.6] | Loss=0.05107 | Reg=0.00430 | acc=0.9375 | FP-Norm=2.049 | FP-Norm(final)=2.310 | 3862.0 samples/s | 60.3 steps/s
[Step=4800 Epoch= 4.7] | Loss=0.05083 | Reg=0.00441 | acc=1.0000 | FP-Norm=2.077 | FP-Norm(final)=2.308 | 3900.7 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step4800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch= 7.5] | Loss=0.10543 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.332 | 3779.4 samples/s | 59.1 steps/s
[Step=4050 Epoch= 7.6] | Loss=0.01475 | Reg=0.00321 | acc=1.0000 | FP-Norm=1.701 | FP-Norm(final)=2.321 | 3633.2 samples/s | 56.8 steps/s
[Step=4100 Epoch= 7.7] | Loss=0.01210 | Reg=0.00379 | acc=0.9844 | FP-Norm=1.896 | FP-Norm(final)=2.315 | 3661.6 samples/s | 57.2 steps/s
[Step=4150 Epoch= 7.8] | Loss=0.00884 | Reg=0.00390 | acc=1.0000 | FP-Norm=1.939 | FP-Norm(final)=2.317 | 3645.5 samples/s | 57.0 steps/s
[Step=4200 Epoch= 7.9] | Loss=0.00762 | Reg=0.00392 | acc=1.0000 | FP-Norm=1.954 | FP-Norm(final)=2.320 | 3647.1 samples/s | 57.0 steps/s
[Step=4250 Epoch= 8.0] | Loss=0.00701 | Reg=0.00397 | acc=1.0000 | FP-Norm=1.972 | FP-Norm(final)=2.321 | 3630.1 samples/s | 56.7 steps/s
[Step=4300 Epoch= 8.1] | Loss=0.00637 | Reg=0.00402 | acc=0.9844 | FP-Norm=1.988 | FP-Norm(final)=2.323 | 3644.4 samples/s | 56.9 steps/s
[Step=4350 Epoch= 8.2] | Loss=0.00565 | Reg=0.00404 | acc=1.0000 | FP-Norm=1.996 | FP-Norm(final)=2.325 | 3673.7 samples/s | 57.4 steps/s
[Step=4400 Epoch= 8.3] | Loss=0.00548 | Reg=0.00405 | acc=1.0000 | FP-Norm=2.000 | FP-Norm(final)=2.327 | 3665.6 samples/s | 57.3 steps/s
[Step=4450 Epoch= 8.4] | Loss=0.00509 | Reg=0.00411 | acc=1.0000 | FP-Norm=2.015 | FP-Norm(final)=2.328 | 3662.4 samples/s | 57.2 steps/s
[Step=4500 Epoch= 8.5] | Loss=0.00500 | Reg=0.00415 | acc=1.0000 | FP-Norm=2.026 | FP-Norm(final)=2.329 | 3648.8 samples/s | 57.0 steps/s
[Step=4550 Epoch= 8.6] | Loss=0.00469 | Reg=0.00420 | acc=1.0000 | FP-Norm=2.038 | FP-Norm(final)=2.330 | 1869.5 samples/s | 29.2 steps/s
[Step=4600 Epoch= 8.7] | Loss=0.00436 | Reg=0.00421 | acc=1.0000 | FP-Norm=2.042 | FP-Norm(final)=2.331 | 3668.8 samples/s | 57.3 steps/s
[Step=4650 Epoch= 8.8] | Loss=0.00404 | Reg=0.00418 | acc=1.0000 | FP-Norm=2.036 | FP-Norm(final)=2.333 | 3625.3 samples/s | 56.6 steps/s
[Step=4700 Epoch= 8.9] | Loss=0.00377 | Reg=0.00414 | acc=1.0000 | FP-Norm=2.025 | FP-Norm(final)=2.335 | 3649.9 samples/s | 57.0 steps/s
[Step=4750 Epoch= 9.0] | Loss=0.00352 | Reg=0.00407 | acc=1.0000 | FP-Norm=2.009 | FP-Norm(final)=2.337 | 3612.9 samples/s | 56.5 steps/s
[Step=4800 Epoch= 9.0] | Loss=0.00331 | Reg=0.00400 | acc=1.0000 | FP-Norm=1.991 | FP-Norm(final)=2.339 | 3667.4 samples/s | 57.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20075 | acc=0.8290 | tpr=0.7743 | fpr=0.0523 | 3969.8 samples/s | 15.5 steps/s
Avg test loss: 0.20677, Avg test acc: 0.82595, Avg tpr: 0.77076, Avg fpr: 0.05269, total FA: 411

Testing server on iccad2012
[Step=  50] | Loss=0.46654 | acc=0.6931 | tpr=0.9690 | fpr=0.3118 | 3971.1 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.46160 | acc=0.6982 | tpr=0.9680 | fpr=0.3068 | 7330.4 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.46585 | acc=0.6955 | tpr=0.9755 | fpr=0.3097 | 7085.4 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.46423 | acc=0.6964 | tpr=0.9792 | fpr=0.3088 | 7290.0 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.46286 | acc=0.6969 | tpr=0.9773 | fpr=0.3082 | 7133.7 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.46177 | acc=0.6972 | tpr=0.9753 | fpr=0.3078 | 7349.1 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.46152 | acc=0.6979 | tpr=0.9756 | fpr=0.3071 | 7095.3 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.46242 | acc=0.6975 | tpr=0.9765 | fpr=0.3076 | 7292.9 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.46349 | acc=0.6980 | tpr=0.9771 | fpr=0.3071 | 7036.8 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.46296 | acc=0.6980 | tpr=0.9784 | fpr=0.3071 | 7190.9 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.46185 | acc=0.6983 | tpr=0.9789 | fpr=0.3068 | 12967.2 samples/s | 50.7 steps/s
Avg test loss: 0.46191, Avg test acc: 0.69829, Avg tpr: 0.97900, Avg fpr: 0.30682, total FA: 42601

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch= 4.7] | Loss=0.10073 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.322 | 4684.4 samples/s | 73.2 steps/s
[Step=4850 Epoch= 4.7] | Loss=0.05854 | Reg=0.00132 | acc=0.9375 | FP-Norm=1.085 | FP-Norm(final)=2.326 | 3550.6 samples/s | 55.5 steps/s
[Step=4900 Epoch= 4.8] | Loss=0.05315 | Reg=0.00177 | acc=0.9531 | FP-Norm=1.286 | FP-Norm(final)=2.328 | 3895.7 samples/s | 60.9 steps/s
[Step=4950 Epoch= 4.8] | Loss=0.05213 | Reg=0.00209 | acc=0.9375 | FP-Norm=1.410 | FP-Norm(final)=2.325 | 3910.9 samples/s | 61.1 steps/s
[Step=5000 Epoch= 4.9] | Loss=0.05315 | Reg=0.00234 | acc=0.9688 | FP-Norm=1.495 | FP-Norm(final)=2.322 | 3921.3 samples/s | 61.3 steps/s
[Step=5050 Epoch= 4.9] | Loss=0.05219 | Reg=0.00259 | acc=0.9688 | FP-Norm=1.574 | FP-Norm(final)=2.321 | 3948.0 samples/s | 61.7 steps/s
[Step=5100 Epoch= 5.0] | Loss=0.05183 | Reg=0.00280 | acc=0.9844 | FP-Norm=1.639 | FP-Norm(final)=2.319 | 3969.6 samples/s | 62.0 steps/s
[Step=5150 Epoch= 5.0] | Loss=0.05113 | Reg=0.00297 | acc=0.9688 | FP-Norm=1.692 | FP-Norm(final)=2.318 | 3945.3 samples/s | 61.6 steps/s
[Step=5200 Epoch= 5.1] | Loss=0.05061 | Reg=0.00313 | acc=0.9531 | FP-Norm=1.737 | FP-Norm(final)=2.317 | 3938.9 samples/s | 61.5 steps/s
[Step=5250 Epoch= 5.1] | Loss=0.05050 | Reg=0.00329 | acc=0.9844 | FP-Norm=1.782 | FP-Norm(final)=2.316 | 3916.4 samples/s | 61.2 steps/s
[Step=5300 Epoch= 5.2] | Loss=0.04984 | Reg=0.00345 | acc=0.9531 | FP-Norm=1.824 | FP-Norm(final)=2.314 | 3837.9 samples/s | 60.0 steps/s
[Step=5350 Epoch= 5.2] | Loss=0.04910 | Reg=0.00359 | acc=0.9688 | FP-Norm=1.862 | FP-Norm(final)=2.313 | 3853.3 samples/s | 60.2 steps/s
[Step=5400 Epoch= 5.3] | Loss=0.04890 | Reg=0.00372 | acc=0.9219 | FP-Norm=1.896 | FP-Norm(final)=2.311 | 3878.5 samples/s | 60.6 steps/s
[Step=5450 Epoch= 5.3] | Loss=0.04841 | Reg=0.00384 | acc=0.9688 | FP-Norm=1.927 | FP-Norm(final)=2.309 | 3851.8 samples/s | 60.2 steps/s
[Step=5500 Epoch= 5.4] | Loss=0.04802 | Reg=0.00395 | acc=0.9062 | FP-Norm=1.954 | FP-Norm(final)=2.308 | 3844.5 samples/s | 60.1 steps/s
[Step=5550 Epoch= 5.4] | Loss=0.04845 | Reg=0.00406 | acc=0.9844 | FP-Norm=1.983 | FP-Norm(final)=2.305 | 3850.5 samples/s | 60.2 steps/s
[Step=5600 Epoch= 5.5] | Loss=0.04774 | Reg=0.00417 | acc=1.0000 | FP-Norm=2.009 | FP-Norm(final)=2.303 | 3851.5 samples/s | 60.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step5600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch= 9.0] | Loss=0.10206 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.321 | 4014.4 samples/s | 62.7 steps/s
[Step=4850 Epoch= 9.1] | Loss=0.01326 | Reg=0.00299 | acc=0.9688 | FP-Norm=1.651 | FP-Norm(final)=2.320 | 3412.5 samples/s | 53.3 steps/s
[Step=4900 Epoch= 9.2] | Loss=0.00763 | Reg=0.00339 | acc=1.0000 | FP-Norm=1.797 | FP-Norm(final)=2.319 | 3620.8 samples/s | 56.6 steps/s
[Step=4950 Epoch= 9.3] | Loss=0.00573 | Reg=0.00331 | acc=1.0000 | FP-Norm=1.791 | FP-Norm(final)=2.324 | 3628.9 samples/s | 56.7 steps/s
[Step=5000 Epoch= 9.4] | Loss=0.00450 | Reg=0.00322 | acc=1.0000 | FP-Norm=1.772 | FP-Norm(final)=2.329 | 3661.4 samples/s | 57.2 steps/s
[Step=5050 Epoch= 9.5] | Loss=0.00423 | Reg=0.00311 | acc=0.9844 | FP-Norm=1.743 | FP-Norm(final)=2.333 | 3637.3 samples/s | 56.8 steps/s
[Step=5100 Epoch= 9.6] | Loss=0.00483 | Reg=0.00320 | acc=1.0000 | FP-Norm=1.772 | FP-Norm(final)=2.335 | 3650.8 samples/s | 57.0 steps/s
[Step=5150 Epoch= 9.7] | Loss=0.00537 | Reg=0.00354 | acc=0.9844 | FP-Norm=1.856 | FP-Norm(final)=2.332 | 3634.7 samples/s | 56.8 steps/s
[Step=5200 Epoch= 9.8] | Loss=0.00549 | Reg=0.00386 | acc=1.0000 | FP-Norm=1.932 | FP-Norm(final)=2.328 | 3665.6 samples/s | 57.3 steps/s
[Step=5250 Epoch= 9.9] | Loss=0.00497 | Reg=0.00406 | acc=1.0000 | FP-Norm=1.982 | FP-Norm(final)=2.326 | 3642.4 samples/s | 56.9 steps/s
[Step=5300 Epoch=10.0] | Loss=0.00459 | Reg=0.00415 | acc=1.0000 | FP-Norm=2.007 | FP-Norm(final)=2.326 | 3671.5 samples/s | 57.4 steps/s
[Step=5350 Epoch=10.1] | Loss=0.00419 | Reg=0.00418 | acc=1.0000 | FP-Norm=2.017 | FP-Norm(final)=2.326 | 1914.3 samples/s | 29.9 steps/s
[Step=5400 Epoch=10.2] | Loss=0.00387 | Reg=0.00417 | acc=1.0000 | FP-Norm=2.017 | FP-Norm(final)=2.328 | 3656.9 samples/s | 57.1 steps/s
[Step=5450 Epoch=10.3] | Loss=0.00359 | Reg=0.00414 | acc=1.0000 | FP-Norm=2.010 | FP-Norm(final)=2.329 | 3586.4 samples/s | 56.0 steps/s
[Step=5500 Epoch=10.4] | Loss=0.00334 | Reg=0.00408 | acc=1.0000 | FP-Norm=1.998 | FP-Norm(final)=2.331 | 3636.9 samples/s | 56.8 steps/s
[Step=5550 Epoch=10.5] | Loss=0.00314 | Reg=0.00402 | acc=1.0000 | FP-Norm=1.982 | FP-Norm(final)=2.332 | 3612.5 samples/s | 56.4 steps/s
[Step=5600 Epoch=10.6] | Loss=0.00295 | Reg=0.00395 | acc=1.0000 | FP-Norm=1.965 | FP-Norm(final)=2.334 | 3665.5 samples/s | 57.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23684 | acc=0.8177 | tpr=0.7475 | fpr=0.0297 | 3966.8 samples/s | 15.5 steps/s
Avg test loss: 0.24387, Avg test acc: 0.81236, Avg tpr: 0.74185, Avg fpr: 0.03256, total FA: 254

Testing server on iccad2012
[Step=  50] | Loss=0.45662 | acc=0.7221 | tpr=0.9779 | fpr=0.2825 | 3945.1 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.45216 | acc=0.7262 | tpr=0.9829 | fpr=0.2786 | 7228.9 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.45631 | acc=0.7236 | tpr=0.9856 | fpr=0.2812 | 7228.2 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.45354 | acc=0.7245 | tpr=0.9858 | fpr=0.2802 | 7417.1 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.45302 | acc=0.7251 | tpr=0.9852 | fpr=0.2797 | 7157.3 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.45249 | acc=0.7253 | tpr=0.9840 | fpr=0.2794 | 7130.2 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.45289 | acc=0.7255 | tpr=0.9825 | fpr=0.2791 | 7341.3 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.45435 | acc=0.7249 | tpr=0.9830 | fpr=0.2798 | 7161.4 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.45559 | acc=0.7251 | tpr=0.9834 | fpr=0.2796 | 7186.1 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.45519 | acc=0.7251 | tpr=0.9841 | fpr=0.2796 | 7147.9 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.45456 | acc=0.7251 | tpr=0.9841 | fpr=0.2796 | 13142.5 samples/s | 51.3 steps/s
Avg test loss: 0.45453, Avg test acc: 0.72507, Avg tpr: 0.98415, Avg fpr: 0.27964, total FA: 38828

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch= 5.5] | Loss=0.09550 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.316 | 4092.1 samples/s | 63.9 steps/s
[Step=5650 Epoch= 5.5] | Loss=0.05675 | Reg=0.00182 | acc=0.9844 | FP-Norm=1.279 | FP-Norm(final)=2.308 | 3804.3 samples/s | 59.4 steps/s
[Step=5700 Epoch= 5.6] | Loss=0.05285 | Reg=0.00215 | acc=0.9219 | FP-Norm=1.427 | FP-Norm(final)=2.309 | 3819.7 samples/s | 59.7 steps/s
[Step=5750 Epoch= 5.6] | Loss=0.05256 | Reg=0.00238 | acc=0.9688 | FP-Norm=1.513 | FP-Norm(final)=2.305 | 3828.0 samples/s | 59.8 steps/s
[Step=5800 Epoch= 5.7] | Loss=0.04935 | Reg=0.00255 | acc=0.9688 | FP-Norm=1.572 | FP-Norm(final)=2.304 | 3825.6 samples/s | 59.8 steps/s
[Step=5850 Epoch= 5.7] | Loss=0.04766 | Reg=0.00268 | acc=0.9844 | FP-Norm=1.616 | FP-Norm(final)=2.304 | 3819.7 samples/s | 59.7 steps/s
[Step=5900 Epoch= 5.8] | Loss=0.04688 | Reg=0.00283 | acc=0.9688 | FP-Norm=1.663 | FP-Norm(final)=2.304 | 3842.4 samples/s | 60.0 steps/s
[Step=5950 Epoch= 5.8] | Loss=0.04609 | Reg=0.00297 | acc=0.9688 | FP-Norm=1.702 | FP-Norm(final)=2.304 | 3862.4 samples/s | 60.4 steps/s
[Step=6000 Epoch= 5.9] | Loss=0.04571 | Reg=0.00309 | acc=0.9531 | FP-Norm=1.737 | FP-Norm(final)=2.305 | 3845.7 samples/s | 60.1 steps/s
[Step=6050 Epoch= 5.9] | Loss=0.04508 | Reg=0.00322 | acc=0.9531 | FP-Norm=1.774 | FP-Norm(final)=2.305 | 3849.5 samples/s | 60.1 steps/s
[Step=6100 Epoch= 6.0] | Loss=0.04516 | Reg=0.00338 | acc=0.9844 | FP-Norm=1.816 | FP-Norm(final)=2.304 | 3859.1 samples/s | 60.3 steps/s
[Step=6150 Epoch= 6.0] | Loss=0.04496 | Reg=0.00354 | acc=0.9844 | FP-Norm=1.857 | FP-Norm(final)=2.303 | 3853.0 samples/s | 60.2 steps/s
[Step=6200 Epoch= 6.1] | Loss=0.04487 | Reg=0.00367 | acc=1.0000 | FP-Norm=1.891 | FP-Norm(final)=2.301 | 3836.9 samples/s | 60.0 steps/s
[Step=6250 Epoch= 6.1] | Loss=0.04455 | Reg=0.00380 | acc=0.9531 | FP-Norm=1.923 | FP-Norm(final)=2.300 | 3842.1 samples/s | 60.0 steps/s
[Step=6300 Epoch= 6.2] | Loss=0.04458 | Reg=0.00392 | acc=0.9531 | FP-Norm=1.953 | FP-Norm(final)=2.298 | 3823.4 samples/s | 59.7 steps/s
[Step=6350 Epoch= 6.2] | Loss=0.04412 | Reg=0.00403 | acc=0.9531 | FP-Norm=1.980 | FP-Norm(final)=2.296 | 3952.0 samples/s | 61.8 steps/s
[Step=6400 Epoch= 6.2] | Loss=0.04434 | Reg=0.00415 | acc=0.9844 | FP-Norm=2.009 | FP-Norm(final)=2.294 | 3917.5 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step6400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=10.6] | Loss=0.06943 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.316 | 4291.8 samples/s | 67.1 steps/s
[Step=5650 Epoch=10.7] | Loss=0.01592 | Reg=0.00355 | acc=1.0000 | FP-Norm=1.777 | FP-Norm(final)=2.300 | 3443.4 samples/s | 53.8 steps/s
[Step=5700 Epoch=10.7] | Loss=0.01071 | Reg=0.00429 | acc=0.9844 | FP-Norm=2.009 | FP-Norm(final)=2.290 | 3630.2 samples/s | 56.7 steps/s
[Step=5750 Epoch=10.8] | Loss=0.00834 | Reg=0.00432 | acc=0.9844 | FP-Norm=2.038 | FP-Norm(final)=2.286 | 3612.9 samples/s | 56.5 steps/s
[Step=5800 Epoch=10.9] | Loss=0.00744 | Reg=0.00442 | acc=1.0000 | FP-Norm=2.071 | FP-Norm(final)=2.285 | 3644.4 samples/s | 56.9 steps/s
[Step=5850 Epoch=11.0] | Loss=0.00637 | Reg=0.00448 | acc=1.0000 | FP-Norm=2.091 | FP-Norm(final)=2.287 | 3639.7 samples/s | 56.9 steps/s
[Step=5900 Epoch=11.1] | Loss=0.00616 | Reg=0.00453 | acc=1.0000 | FP-Norm=2.105 | FP-Norm(final)=2.289 | 3664.8 samples/s | 57.3 steps/s
[Step=5950 Epoch=11.2] | Loss=0.00623 | Reg=0.00474 | acc=1.0000 | FP-Norm=2.156 | FP-Norm(final)=2.288 | 3654.4 samples/s | 57.1 steps/s
[Step=6000 Epoch=11.3] | Loss=0.00578 | Reg=0.00493 | acc=1.0000 | FP-Norm=2.198 | FP-Norm(final)=2.288 | 3638.3 samples/s | 56.8 steps/s
[Step=6050 Epoch=11.4] | Loss=0.00533 | Reg=0.00503 | acc=1.0000 | FP-Norm=2.222 | FP-Norm(final)=2.288 | 3655.7 samples/s | 57.1 steps/s
[Step=6100 Epoch=11.5] | Loss=0.00498 | Reg=0.00509 | acc=1.0000 | FP-Norm=2.236 | FP-Norm(final)=2.289 | 3711.8 samples/s | 58.0 steps/s
[Step=6150 Epoch=11.6] | Loss=0.00457 | Reg=0.00509 | acc=1.0000 | FP-Norm=2.239 | FP-Norm(final)=2.290 | 1907.1 samples/s | 29.8 steps/s
[Step=6200 Epoch=11.7] | Loss=0.00421 | Reg=0.00505 | acc=1.0000 | FP-Norm=2.232 | FP-Norm(final)=2.291 | 3732.6 samples/s | 58.3 steps/s
[Step=6250 Epoch=11.8] | Loss=0.00390 | Reg=0.00499 | acc=1.0000 | FP-Norm=2.218 | FP-Norm(final)=2.293 | 3711.5 samples/s | 58.0 steps/s
[Step=6300 Epoch=11.9] | Loss=0.00364 | Reg=0.00491 | acc=1.0000 | FP-Norm=2.200 | FP-Norm(final)=2.295 | 3629.4 samples/s | 56.7 steps/s
[Step=6350 Epoch=12.0] | Loss=0.00340 | Reg=0.00482 | acc=1.0000 | FP-Norm=2.179 | FP-Norm(final)=2.297 | 3640.3 samples/s | 56.9 steps/s
[Step=6400 Epoch=12.1] | Loss=0.00320 | Reg=0.00472 | acc=1.0000 | FP-Norm=2.156 | FP-Norm(final)=2.299 | 3641.2 samples/s | 56.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28749 | acc=0.7766 | tpr=0.6854 | fpr=0.0253 | 3935.5 samples/s | 15.4 steps/s
Avg test loss: 0.29449, Avg test acc: 0.77358, Avg tpr: 0.68258, Avg fpr: 0.02628, total FA: 205

Testing server on iccad2012
[Step=  50] | Loss=0.34725 | acc=0.7916 | tpr=0.9602 | fpr=0.2115 | 3912.0 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.34476 | acc=0.7948 | tpr=0.9701 | fpr=0.2085 | 7187.6 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.34789 | acc=0.7933 | tpr=0.9755 | fpr=0.2101 | 7455.3 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.34533 | acc=0.7952 | tpr=0.9760 | fpr=0.2081 | 7214.6 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.34479 | acc=0.7953 | tpr=0.9747 | fpr=0.2080 | 7056.1 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.34444 | acc=0.7953 | tpr=0.9702 | fpr=0.2079 | 7200.6 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.34462 | acc=0.7959 | tpr=0.9712 | fpr=0.2073 | 7162.7 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.34580 | acc=0.7952 | tpr=0.9705 | fpr=0.2080 | 7318.1 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.34759 | acc=0.7954 | tpr=0.9713 | fpr=0.2078 | 6946.6 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.34734 | acc=0.7951 | tpr=0.9727 | fpr=0.2081 | 7107.8 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.34664 | acc=0.7954 | tpr=0.9729 | fpr=0.2078 | 13302.4 samples/s | 52.0 steps/s
Avg test loss: 0.34651, Avg test acc: 0.79541, Avg tpr: 0.97306, Avg fpr: 0.20782, total FA: 28856

server round 8/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch= 6.2] | Loss=0.20116 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.289 | 4526.9 samples/s | 70.7 steps/s
[Step=6450 Epoch= 6.3] | Loss=0.05110 | Reg=0.00172 | acc=0.9531 | FP-Norm=1.252 | FP-Norm(final)=2.288 | 3453.1 samples/s | 54.0 steps/s
[Step=6500 Epoch= 6.3] | Loss=0.04876 | Reg=0.00210 | acc=0.9531 | FP-Norm=1.415 | FP-Norm(final)=2.291 | 3816.6 samples/s | 59.6 steps/s
[Step=6550 Epoch= 6.4] | Loss=0.04666 | Reg=0.00243 | acc=0.9375 | FP-Norm=1.529 | FP-Norm(final)=2.289 | 3926.7 samples/s | 61.4 steps/s
[Step=6600 Epoch= 6.4] | Loss=0.04457 | Reg=0.00267 | acc=0.9844 | FP-Norm=1.606 | FP-Norm(final)=2.289 | 3832.3 samples/s | 59.9 steps/s
[Step=6650 Epoch= 6.5] | Loss=0.04396 | Reg=0.00286 | acc=0.9219 | FP-Norm=1.664 | FP-Norm(final)=2.288 | 3818.2 samples/s | 59.7 steps/s
[Step=6700 Epoch= 6.5] | Loss=0.04395 | Reg=0.00308 | acc=0.9219 | FP-Norm=1.729 | FP-Norm(final)=2.286 | 3849.8 samples/s | 60.2 steps/s
[Step=6750 Epoch= 6.6] | Loss=0.04389 | Reg=0.00324 | acc=0.9844 | FP-Norm=1.775 | FP-Norm(final)=2.283 | 3867.9 samples/s | 60.4 steps/s
[Step=6800 Epoch= 6.6] | Loss=0.04352 | Reg=0.00339 | acc=0.9844 | FP-Norm=1.815 | FP-Norm(final)=2.281 | 3830.5 samples/s | 59.9 steps/s
[Step=6850 Epoch= 6.7] | Loss=0.04286 | Reg=0.00353 | acc=0.9375 | FP-Norm=1.853 | FP-Norm(final)=2.278 | 3870.3 samples/s | 60.5 steps/s
[Step=6900 Epoch= 6.7] | Loss=0.04351 | Reg=0.00366 | acc=0.9844 | FP-Norm=1.888 | FP-Norm(final)=2.275 | 3825.8 samples/s | 59.8 steps/s
[Step=6950 Epoch= 6.8] | Loss=0.04318 | Reg=0.00379 | acc=0.9844 | FP-Norm=1.922 | FP-Norm(final)=2.273 | 3883.2 samples/s | 60.7 steps/s
[Step=7000 Epoch= 6.8] | Loss=0.04277 | Reg=0.00390 | acc=0.9688 | FP-Norm=1.951 | FP-Norm(final)=2.271 | 3824.3 samples/s | 59.8 steps/s
[Step=7050 Epoch= 6.9] | Loss=0.04188 | Reg=0.00401 | acc=0.9531 | FP-Norm=1.978 | FP-Norm(final)=2.269 | 3847.1 samples/s | 60.1 steps/s
[Step=7100 Epoch= 6.9] | Loss=0.04206 | Reg=0.00412 | acc=0.9844 | FP-Norm=2.005 | FP-Norm(final)=2.268 | 3863.0 samples/s | 60.4 steps/s
[Step=7150 Epoch= 7.0] | Loss=0.04176 | Reg=0.00424 | acc=0.9844 | FP-Norm=2.032 | FP-Norm(final)=2.267 | 3879.1 samples/s | 60.6 steps/s
[Step=7200 Epoch= 7.0] | Loss=0.04212 | Reg=0.00434 | acc=0.9688 | FP-Norm=2.057 | FP-Norm(final)=2.266 | 3952.4 samples/s | 61.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step7200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=12.1] | Loss=0.13658 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.288 | 3986.0 samples/s | 62.3 steps/s
[Step=6450 Epoch=12.2] | Loss=0.01213 | Reg=0.00348 | acc=1.0000 | FP-Norm=1.784 | FP-Norm(final)=2.272 | 3423.8 samples/s | 53.5 steps/s
[Step=6500 Epoch=12.3] | Loss=0.00655 | Reg=0.00373 | acc=1.0000 | FP-Norm=1.890 | FP-Norm(final)=2.270 | 3664.0 samples/s | 57.2 steps/s
[Step=6550 Epoch=12.3] | Loss=0.00483 | Reg=0.00362 | acc=1.0000 | FP-Norm=1.874 | FP-Norm(final)=2.273 | 3578.1 samples/s | 55.9 steps/s
[Step=6600 Epoch=12.4] | Loss=0.00434 | Reg=0.00356 | acc=1.0000 | FP-Norm=1.866 | FP-Norm(final)=2.277 | 3647.1 samples/s | 57.0 steps/s
[Step=6650 Epoch=12.5] | Loss=0.00489 | Reg=0.00367 | acc=0.9844 | FP-Norm=1.898 | FP-Norm(final)=2.278 | 3631.0 samples/s | 56.7 steps/s
[Step=6700 Epoch=12.6] | Loss=0.00451 | Reg=0.00387 | acc=1.0000 | FP-Norm=1.948 | FP-Norm(final)=2.277 | 3667.0 samples/s | 57.3 steps/s
[Step=6750 Epoch=12.7] | Loss=0.00422 | Reg=0.00397 | acc=1.0000 | FP-Norm=1.976 | FP-Norm(final)=2.277 | 3635.2 samples/s | 56.8 steps/s
[Step=6800 Epoch=12.8] | Loss=0.00438 | Reg=0.00406 | acc=1.0000 | FP-Norm=1.999 | FP-Norm(final)=2.278 | 3670.0 samples/s | 57.3 steps/s
[Step=6850 Epoch=12.9] | Loss=0.00425 | Reg=0.00422 | acc=1.0000 | FP-Norm=2.038 | FP-Norm(final)=2.277 | 3642.3 samples/s | 56.9 steps/s
[Step=6900 Epoch=13.0] | Loss=0.00403 | Reg=0.00433 | acc=1.0000 | FP-Norm=2.064 | FP-Norm(final)=2.275 | 3682.5 samples/s | 57.5 steps/s
[Step=6950 Epoch=13.1] | Loss=0.00402 | Reg=0.00440 | acc=1.0000 | FP-Norm=2.083 | FP-Norm(final)=2.274 | 1910.2 samples/s | 29.8 steps/s
[Step=7000 Epoch=13.2] | Loss=0.00373 | Reg=0.00446 | acc=1.0000 | FP-Norm=2.096 | FP-Norm(final)=2.273 | 3720.7 samples/s | 58.1 steps/s
[Step=7050 Epoch=13.3] | Loss=0.00345 | Reg=0.00445 | acc=1.0000 | FP-Norm=2.096 | FP-Norm(final)=2.273 | 3715.2 samples/s | 58.0 steps/s
[Step=7100 Epoch=13.4] | Loss=0.00321 | Reg=0.00441 | acc=1.0000 | FP-Norm=2.087 | FP-Norm(final)=2.274 | 3703.7 samples/s | 57.9 steps/s
[Step=7150 Epoch=13.5] | Loss=0.00300 | Reg=0.00435 | acc=1.0000 | FP-Norm=2.073 | FP-Norm(final)=2.275 | 3706.2 samples/s | 57.9 steps/s
[Step=7200 Epoch=13.6] | Loss=0.00283 | Reg=0.00428 | acc=1.0000 | FP-Norm=2.055 | FP-Norm(final)=2.276 | 3695.9 samples/s | 57.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33169 | acc=0.7544 | tpr=0.6510 | fpr=0.0211 | 3931.8 samples/s | 15.4 steps/s
Avg test loss: 0.34134, Avg test acc: 0.75022, Avg tpr: 0.64615, Avg fpr: 0.02089, total FA: 163

Testing server on iccad2012
[Step=  50] | Loss=0.28065 | acc=0.8370 | tpr=0.9735 | fpr=0.1654 | 4013.6 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.27933 | acc=0.8396 | tpr=0.9765 | fpr=0.1629 | 6844.2 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.28261 | acc=0.8387 | tpr=0.9813 | fpr=0.1640 | 7413.9 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.28003 | acc=0.8397 | tpr=0.9803 | fpr=0.1628 | 7129.5 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.27868 | acc=0.8402 | tpr=0.9782 | fpr=0.1623 | 7106.3 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.27772 | acc=0.8407 | tpr=0.9760 | fpr=0.1618 | 7215.4 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.27785 | acc=0.8413 | tpr=0.9756 | fpr=0.1611 | 7355.8 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.27899 | acc=0.8408 | tpr=0.9754 | fpr=0.1617 | 7015.5 samples/s | 27.4 steps/s
[Step= 450] | Loss=0.28078 | acc=0.8407 | tpr=0.9747 | fpr=0.1617 | 7256.0 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.28025 | acc=0.8407 | tpr=0.9753 | fpr=0.1617 | 7160.2 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.27977 | acc=0.8411 | tpr=0.9745 | fpr=0.1614 | 13188.5 samples/s | 51.5 steps/s
Avg test loss: 0.27970, Avg test acc: 0.84110, Avg tpr: 0.97464, Avg fpr: 0.16133, total FA: 22400

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch= 7.0] | Loss=0.25502 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.266 | 4210.7 samples/s | 65.8 steps/s
[Step=7250 Epoch= 7.1] | Loss=0.05235 | Reg=0.00217 | acc=0.9844 | FP-Norm=1.417 | FP-Norm(final)=2.260 | 3760.4 samples/s | 58.8 steps/s
[Step=7300 Epoch= 7.1] | Loss=0.04815 | Reg=0.00246 | acc=0.9844 | FP-Norm=1.537 | FP-Norm(final)=2.262 | 3804.9 samples/s | 59.5 steps/s
[Step=7350 Epoch= 7.2] | Loss=0.04425 | Reg=0.00266 | acc=0.9688 | FP-Norm=1.606 | FP-Norm(final)=2.260 | 3825.8 samples/s | 59.8 steps/s
[Step=7400 Epoch= 7.2] | Loss=0.04339 | Reg=0.00285 | acc=1.0000 | FP-Norm=1.667 | FP-Norm(final)=2.260 | 3853.2 samples/s | 60.2 steps/s
[Step=7450 Epoch= 7.3] | Loss=0.04144 | Reg=0.00302 | acc=0.9688 | FP-Norm=1.720 | FP-Norm(final)=2.259 | 3833.6 samples/s | 59.9 steps/s
[Step=7500 Epoch= 7.3] | Loss=0.04145 | Reg=0.00318 | acc=1.0000 | FP-Norm=1.765 | FP-Norm(final)=2.258 | 3846.9 samples/s | 60.1 steps/s
[Step=7550 Epoch= 7.4] | Loss=0.04137 | Reg=0.00334 | acc=0.9531 | FP-Norm=1.808 | FP-Norm(final)=2.256 | 3861.6 samples/s | 60.3 steps/s
[Step=7600 Epoch= 7.4] | Loss=0.04083 | Reg=0.00349 | acc=0.9844 | FP-Norm=1.850 | FP-Norm(final)=2.253 | 3821.4 samples/s | 59.7 steps/s
[Step=7650 Epoch= 7.5] | Loss=0.04115 | Reg=0.00363 | acc=0.9375 | FP-Norm=1.887 | FP-Norm(final)=2.252 | 3861.9 samples/s | 60.3 steps/s
[Step=7700 Epoch= 7.5] | Loss=0.04028 | Reg=0.00376 | acc=0.9375 | FP-Norm=1.918 | FP-Norm(final)=2.251 | 3865.2 samples/s | 60.4 steps/s
[Step=7750 Epoch= 7.6] | Loss=0.03995 | Reg=0.00387 | acc=0.9688 | FP-Norm=1.947 | FP-Norm(final)=2.251 | 3848.4 samples/s | 60.1 steps/s
[Step=7800 Epoch= 7.6] | Loss=0.04010 | Reg=0.00398 | acc=0.9844 | FP-Norm=1.976 | FP-Norm(final)=2.250 | 3842.8 samples/s | 60.0 steps/s
[Step=7850 Epoch= 7.7] | Loss=0.03953 | Reg=0.00410 | acc=0.9844 | FP-Norm=2.005 | FP-Norm(final)=2.248 | 3839.7 samples/s | 60.0 steps/s
[Step=7900 Epoch= 7.7] | Loss=0.03966 | Reg=0.00423 | acc=0.9062 | FP-Norm=2.036 | FP-Norm(final)=2.247 | 3848.6 samples/s | 60.1 steps/s
[Step=7950 Epoch= 7.8] | Loss=0.03985 | Reg=0.00436 | acc=0.9688 | FP-Norm=2.065 | FP-Norm(final)=2.245 | 3868.9 samples/s | 60.5 steps/s
[Step=8000 Epoch= 7.8] | Loss=0.04014 | Reg=0.00448 | acc=0.9688 | FP-Norm=2.093 | FP-Norm(final)=2.243 | 3847.2 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step8000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=13.6] | Loss=0.06773 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.268 | 4285.4 samples/s | 67.0 steps/s
[Step=7250 Epoch=13.7] | Loss=0.00505 | Reg=0.00206 | acc=1.0000 | FP-Norm=1.366 | FP-Norm(final)=2.276 | 3449.8 samples/s | 53.9 steps/s
[Step=7300 Epoch=13.8] | Loss=0.00516 | Reg=0.00265 | acc=1.0000 | FP-Norm=1.583 | FP-Norm(final)=2.274 | 3612.7 samples/s | 56.4 steps/s
[Step=7350 Epoch=13.9] | Loss=0.00370 | Reg=0.00285 | acc=1.0000 | FP-Norm=1.656 | FP-Norm(final)=2.275 | 3614.2 samples/s | 56.5 steps/s
[Step=7400 Epoch=13.9] | Loss=0.00398 | Reg=0.00296 | acc=1.0000 | FP-Norm=1.694 | FP-Norm(final)=2.276 | 3729.6 samples/s | 58.3 steps/s
[Step=7450 Epoch=14.0] | Loss=0.00369 | Reg=0.00310 | acc=0.9844 | FP-Norm=1.737 | FP-Norm(final)=2.276 | 3692.3 samples/s | 57.7 steps/s
[Step=7500 Epoch=14.1] | Loss=0.00353 | Reg=0.00319 | acc=1.0000 | FP-Norm=1.765 | FP-Norm(final)=2.277 | 3670.7 samples/s | 57.4 steps/s
[Step=7550 Epoch=14.2] | Loss=0.00322 | Reg=0.00323 | acc=1.0000 | FP-Norm=1.780 | FP-Norm(final)=2.278 | 3690.0 samples/s | 57.7 steps/s
[Step=7600 Epoch=14.3] | Loss=0.00291 | Reg=0.00324 | acc=1.0000 | FP-Norm=1.785 | FP-Norm(final)=2.279 | 3624.7 samples/s | 56.6 steps/s
[Step=7650 Epoch=14.4] | Loss=0.00267 | Reg=0.00322 | acc=1.0000 | FP-Norm=1.782 | FP-Norm(final)=2.281 | 3649.0 samples/s | 57.0 steps/s
[Step=7700 Epoch=14.5] | Loss=0.00242 | Reg=0.00318 | acc=1.0000 | FP-Norm=1.771 | FP-Norm(final)=2.284 | 3679.1 samples/s | 57.5 steps/s
[Step=7750 Epoch=14.6] | Loss=0.00220 | Reg=0.00312 | acc=1.0000 | FP-Norm=1.753 | FP-Norm(final)=2.286 | 1950.3 samples/s | 30.5 steps/s
[Step=7800 Epoch=14.7] | Loss=0.00203 | Reg=0.00304 | acc=1.0000 | FP-Norm=1.731 | FP-Norm(final)=2.288 | 3738.3 samples/s | 58.4 steps/s
[Step=7850 Epoch=14.8] | Loss=0.00187 | Reg=0.00296 | acc=1.0000 | FP-Norm=1.706 | FP-Norm(final)=2.289 | 3710.1 samples/s | 58.0 steps/s
[Step=7900 Epoch=14.9] | Loss=0.00174 | Reg=0.00288 | acc=1.0000 | FP-Norm=1.679 | FP-Norm(final)=2.291 | 3770.3 samples/s | 58.9 steps/s
[Step=7950 Epoch=15.0] | Loss=0.00163 | Reg=0.00279 | acc=1.0000 | FP-Norm=1.652 | FP-Norm(final)=2.292 | 3641.2 samples/s | 56.9 steps/s
[Step=8000 Epoch=15.1] | Loss=0.00155 | Reg=0.00271 | acc=1.0000 | FP-Norm=1.626 | FP-Norm(final)=2.293 | 3629.0 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25681 | acc=0.8120 | tpr=0.7329 | fpr=0.0164 | 3940.7 samples/s | 15.4 steps/s
Avg test loss: 0.26664, Avg test acc: 0.80804, Avg tpr: 0.72897, Avg fpr: 0.01807, total FA: 141

Testing server on iccad2012
[Step=  50] | Loss=0.37508 | acc=0.7816 | tpr=0.9690 | fpr=0.2218 | 4033.1 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.37261 | acc=0.7858 | tpr=0.9659 | fpr=0.2175 | 6937.9 samples/s | 27.1 steps/s
[Step= 150] | Loss=0.37790 | acc=0.7827 | tpr=0.9726 | fpr=0.2208 | 7324.8 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.37378 | acc=0.7838 | tpr=0.9727 | fpr=0.2196 | 7338.8 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.37232 | acc=0.7845 | tpr=0.9738 | fpr=0.2190 | 6960.1 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.37144 | acc=0.7847 | tpr=0.9709 | fpr=0.2187 | 7284.8 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.37134 | acc=0.7851 | tpr=0.9712 | fpr=0.2183 | 7308.6 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.37202 | acc=0.7843 | tpr=0.9705 | fpr=0.2191 | 7026.5 samples/s | 27.4 steps/s
[Step= 450] | Loss=0.37335 | acc=0.7846 | tpr=0.9693 | fpr=0.2188 | 7180.3 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.37343 | acc=0.7843 | tpr=0.9709 | fpr=0.2191 | 7127.4 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.37278 | acc=0.7845 | tpr=0.9710 | fpr=0.2189 | 13347.6 samples/s | 52.1 steps/s
Avg test loss: 0.37288, Avg test acc: 0.78451, Avg tpr: 0.97108, Avg fpr: 0.21888, total FA: 30391

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch= 7.8] | Loss=0.16997 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.252 | 4252.9 samples/s | 66.5 steps/s
[Step=8050 Epoch= 7.9] | Loss=0.04205 | Reg=0.00073 | acc=0.9844 | FP-Norm=0.818 | FP-Norm(final)=2.255 | 3644.1 samples/s | 56.9 steps/s
[Step=8100 Epoch= 7.9] | Loss=0.03467 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.885 | FP-Norm(final)=2.261 | 3840.4 samples/s | 60.0 steps/s
[Step=8150 Epoch= 8.0] | Loss=0.03136 | Reg=0.00087 | acc=0.9688 | FP-Norm=0.916 | FP-Norm(final)=2.266 | 3848.7 samples/s | 60.1 steps/s
[Step=8200 Epoch= 8.0] | Loss=0.03023 | Reg=0.00091 | acc=0.9688 | FP-Norm=0.941 | FP-Norm(final)=2.271 | 3804.3 samples/s | 59.4 steps/s
[Step=8250 Epoch= 8.1] | Loss=0.02955 | Reg=0.00095 | acc=0.9531 | FP-Norm=0.966 | FP-Norm(final)=2.275 | 3911.3 samples/s | 61.1 steps/s
[Step=8300 Epoch= 8.1] | Loss=0.02883 | Reg=0.00100 | acc=0.9844 | FP-Norm=0.988 | FP-Norm(final)=2.277 | 3978.7 samples/s | 62.2 steps/s
[Step=8350 Epoch= 8.2] | Loss=0.02802 | Reg=0.00103 | acc=1.0000 | FP-Norm=1.008 | FP-Norm(final)=2.279 | 3844.5 samples/s | 60.1 steps/s
[Step=8400 Epoch= 8.2] | Loss=0.02732 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.027 | FP-Norm(final)=2.282 | 3854.4 samples/s | 60.2 steps/s
[Step=8450 Epoch= 8.3] | Loss=0.02670 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.045 | FP-Norm(final)=2.284 | 3806.7 samples/s | 59.5 steps/s
[Step=8500 Epoch= 8.3] | Loss=0.02697 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.062 | FP-Norm(final)=2.285 | 3842.1 samples/s | 60.0 steps/s
[Step=8550 Epoch= 8.3] | Loss=0.02720 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.079 | FP-Norm(final)=2.286 | 3871.1 samples/s | 60.5 steps/s
[Step=8600 Epoch= 8.4] | Loss=0.02762 | Reg=0.00122 | acc=0.9844 | FP-Norm=1.094 | FP-Norm(final)=2.286 | 3854.5 samples/s | 60.2 steps/s
[Step=8650 Epoch= 8.4] | Loss=0.02754 | Reg=0.00125 | acc=0.9688 | FP-Norm=1.110 | FP-Norm(final)=2.287 | 3840.0 samples/s | 60.0 steps/s
[Step=8700 Epoch= 8.5] | Loss=0.02718 | Reg=0.00129 | acc=0.9531 | FP-Norm=1.124 | FP-Norm(final)=2.288 | 3851.1 samples/s | 60.2 steps/s
[Step=8750 Epoch= 8.5] | Loss=0.02696 | Reg=0.00132 | acc=0.9688 | FP-Norm=1.137 | FP-Norm(final)=2.289 | 3827.8 samples/s | 59.8 steps/s
[Step=8800 Epoch= 8.6] | Loss=0.02710 | Reg=0.00135 | acc=0.9688 | FP-Norm=1.152 | FP-Norm(final)=2.290 | 3869.7 samples/s | 60.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step8800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=15.1] | Loss=0.20151 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.250 | 3968.0 samples/s | 62.0 steps/s
[Step=8050 Epoch=15.2] | Loss=0.00965 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.235 | FP-Norm(final)=2.238 | 3564.7 samples/s | 55.7 steps/s
[Step=8100 Epoch=15.3] | Loss=0.00549 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.296 | FP-Norm(final)=2.240 | 3689.4 samples/s | 57.6 steps/s
[Step=8150 Epoch=15.4] | Loss=0.00404 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.297 | FP-Norm(final)=2.242 | 3703.0 samples/s | 57.9 steps/s
[Step=8200 Epoch=15.5] | Loss=0.00310 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.282 | FP-Norm(final)=2.245 | 3695.7 samples/s | 57.7 steps/s
[Step=8250 Epoch=15.6] | Loss=0.00260 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.259 | FP-Norm(final)=2.248 | 3635.2 samples/s | 56.8 steps/s
[Step=8300 Epoch=15.6] | Loss=0.00233 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.247 | FP-Norm(final)=2.250 | 3616.2 samples/s | 56.5 steps/s
[Step=8350 Epoch=15.7] | Loss=0.00206 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.235 | FP-Norm(final)=2.252 | 3652.5 samples/s | 57.1 steps/s
[Step=8400 Epoch=15.8] | Loss=0.00182 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.222 | FP-Norm(final)=2.254 | 3679.3 samples/s | 57.5 steps/s
[Step=8450 Epoch=15.9] | Loss=0.00162 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.206 | FP-Norm(final)=2.256 | 3591.3 samples/s | 56.1 steps/s
[Step=8500 Epoch=16.0] | Loss=0.00147 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.188 | FP-Norm(final)=2.258 | 3693.2 samples/s | 57.7 steps/s
[Step=8550 Epoch=16.1] | Loss=0.00134 | Reg=0.00140 | acc=1.0000 | FP-Norm=1.171 | FP-Norm(final)=2.259 | 1906.3 samples/s | 29.8 steps/s
[Step=8600 Epoch=16.2] | Loss=0.00123 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.153 | FP-Norm(final)=2.261 | 3757.2 samples/s | 58.7 steps/s
[Step=8650 Epoch=16.3] | Loss=0.00114 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.136 | FP-Norm(final)=2.262 | 3732.4 samples/s | 58.3 steps/s
[Step=8700 Epoch=16.4] | Loss=0.00106 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.119 | FP-Norm(final)=2.263 | 3712.4 samples/s | 58.0 steps/s
[Step=8750 Epoch=16.5] | Loss=0.00100 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.103 | FP-Norm(final)=2.264 | 3741.5 samples/s | 58.5 steps/s
[Step=8800 Epoch=16.6] | Loss=0.00094 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.087 | FP-Norm(final)=2.265 | 3737.2 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20494 | acc=0.8481 | tpr=0.7908 | fpr=0.0275 | 3968.8 samples/s | 15.5 steps/s
Avg test loss: 0.21235, Avg test acc: 0.84678, Avg tpr: 0.78942, Avg fpr: 0.02705, total FA: 211

Testing server on iccad2012
[Step=  50] | Loss=0.51864 | acc=0.7420 | tpr=0.9690 | fpr=0.2621 | 4122.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.51075 | acc=0.7472 | tpr=0.9829 | fpr=0.2572 | 6595.2 samples/s | 25.8 steps/s
[Step= 150] | Loss=0.51690 | acc=0.7446 | tpr=0.9870 | fpr=0.2598 | 7182.2 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.51248 | acc=0.7463 | tpr=0.9869 | fpr=0.2581 | 7232.6 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.51110 | acc=0.7458 | tpr=0.9869 | fpr=0.2586 | 7270.1 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.51086 | acc=0.7458 | tpr=0.9825 | fpr=0.2585 | 7159.6 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.51092 | acc=0.7463 | tpr=0.9812 | fpr=0.2580 | 7358.8 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.51217 | acc=0.7457 | tpr=0.9819 | fpr=0.2586 | 7265.3 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.51384 | acc=0.7456 | tpr=0.9820 | fpr=0.2587 | 6750.0 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.51376 | acc=0.7454 | tpr=0.9828 | fpr=0.2589 | 7276.4 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.51272 | acc=0.7454 | tpr=0.9829 | fpr=0.2589 | 13189.1 samples/s | 51.5 steps/s
Avg test loss: 0.51283, Avg test acc: 0.74544, Avg tpr: 0.98296, Avg fpr: 0.25888, total FA: 35945

server round 11/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch= 8.6] | Loss=0.16374 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.290 | 4172.3 samples/s | 65.2 steps/s
[Step=8850 Epoch= 8.6] | Loss=0.03598 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.727 | FP-Norm(final)=2.296 | 3781.8 samples/s | 59.1 steps/s
[Step=8900 Epoch= 8.7] | Loss=0.02803 | Reg=0.00069 | acc=0.9844 | FP-Norm=0.810 | FP-Norm(final)=2.302 | 3830.5 samples/s | 59.9 steps/s
[Step=8950 Epoch= 8.7] | Loss=0.02865 | Reg=0.00076 | acc=0.9844 | FP-Norm=0.854 | FP-Norm(final)=2.307 | 3838.2 samples/s | 60.0 steps/s
[Step=9000 Epoch= 8.8] | Loss=0.02804 | Reg=0.00083 | acc=0.9688 | FP-Norm=0.895 | FP-Norm(final)=2.309 | 3826.1 samples/s | 59.8 steps/s
[Step=9050 Epoch= 8.8] | Loss=0.02704 | Reg=0.00087 | acc=0.9688 | FP-Norm=0.921 | FP-Norm(final)=2.310 | 3835.7 samples/s | 59.9 steps/s
[Step=9100 Epoch= 8.9] | Loss=0.02690 | Reg=0.00091 | acc=0.9844 | FP-Norm=0.943 | FP-Norm(final)=2.309 | 3875.8 samples/s | 60.6 steps/s
[Step=9150 Epoch= 8.9] | Loss=0.02594 | Reg=0.00095 | acc=0.9531 | FP-Norm=0.963 | FP-Norm(final)=2.310 | 3802.3 samples/s | 59.4 steps/s
[Step=9200 Epoch= 9.0] | Loss=0.02588 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.982 | FP-Norm(final)=2.311 | 3867.0 samples/s | 60.4 steps/s
[Step=9250 Epoch= 9.0] | Loss=0.02556 | Reg=0.00102 | acc=0.9844 | FP-Norm=0.999 | FP-Norm(final)=2.312 | 3840.1 samples/s | 60.0 steps/s
[Step=9300 Epoch= 9.1] | Loss=0.02556 | Reg=0.00105 | acc=0.9688 | FP-Norm=1.015 | FP-Norm(final)=2.313 | 3840.7 samples/s | 60.0 steps/s
[Step=9350 Epoch= 9.1] | Loss=0.02561 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.029 | FP-Norm(final)=2.313 | 3834.8 samples/s | 59.9 steps/s
[Step=9400 Epoch= 9.2] | Loss=0.02524 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.041 | FP-Norm(final)=2.314 | 3874.3 samples/s | 60.5 steps/s
[Step=9450 Epoch= 9.2] | Loss=0.02487 | Reg=0.00113 | acc=0.9688 | FP-Norm=1.053 | FP-Norm(final)=2.315 | 3863.3 samples/s | 60.4 steps/s
[Step=9500 Epoch= 9.3] | Loss=0.02464 | Reg=0.00116 | acc=0.9844 | FP-Norm=1.065 | FP-Norm(final)=2.316 | 3817.1 samples/s | 59.6 steps/s
[Step=9550 Epoch= 9.3] | Loss=0.02502 | Reg=0.00118 | acc=0.9688 | FP-Norm=1.077 | FP-Norm(final)=2.317 | 3850.8 samples/s | 60.2 steps/s
[Step=9600 Epoch= 9.4] | Loss=0.02527 | Reg=0.00121 | acc=0.9844 | FP-Norm=1.089 | FP-Norm(final)=2.316 | 3833.5 samples/s | 59.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step9600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=16.6] | Loss=0.13602 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.289 | 4914.0 samples/s | 76.8 steps/s
[Step=8850 Epoch=16.7] | Loss=0.00741 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.223 | FP-Norm(final)=2.284 | 3131.9 samples/s | 48.9 steps/s
[Step=8900 Epoch=16.8] | Loss=0.00415 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.325 | FP-Norm(final)=2.286 | 3611.5 samples/s | 56.4 steps/s
[Step=8950 Epoch=16.9] | Loss=0.00286 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.320 | FP-Norm(final)=2.288 | 3626.2 samples/s | 56.7 steps/s
[Step=9000 Epoch=17.0] | Loss=0.00237 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.303 | FP-Norm(final)=2.290 | 3640.4 samples/s | 56.9 steps/s
[Step=9050 Epoch=17.1] | Loss=0.00193 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.283 | FP-Norm(final)=2.292 | 3696.3 samples/s | 57.8 steps/s
[Step=9100 Epoch=17.2] | Loss=0.00161 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.258 | FP-Norm(final)=2.294 | 3693.6 samples/s | 57.7 steps/s
[Step=9150 Epoch=17.2] | Loss=0.00145 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.234 | FP-Norm(final)=2.296 | 3656.2 samples/s | 57.1 steps/s
[Step=9200 Epoch=17.3] | Loss=0.00129 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.213 | FP-Norm(final)=2.298 | 3642.5 samples/s | 56.9 steps/s
[Step=9250 Epoch=17.4] | Loss=0.00120 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.194 | FP-Norm(final)=2.299 | 3663.0 samples/s | 57.2 steps/s
[Step=9300 Epoch=17.5] | Loss=0.00109 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.179 | FP-Norm(final)=2.301 | 3703.3 samples/s | 57.9 steps/s
[Step=9350 Epoch=17.6] | Loss=0.00100 | Reg=0.00138 | acc=1.0000 | FP-Norm=1.162 | FP-Norm(final)=2.302 | 1885.5 samples/s | 29.5 steps/s
[Step=9400 Epoch=17.7] | Loss=0.00092 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.144 | FP-Norm(final)=2.304 | 3753.4 samples/s | 58.6 steps/s
[Step=9450 Epoch=17.8] | Loss=0.00085 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.126 | FP-Norm(final)=2.305 | 3717.3 samples/s | 58.1 steps/s
[Step=9500 Epoch=17.9] | Loss=0.00079 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.109 | FP-Norm(final)=2.306 | 3751.9 samples/s | 58.6 steps/s
[Step=9550 Epoch=18.0] | Loss=0.00074 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.091 | FP-Norm(final)=2.307 | 3654.4 samples/s | 57.1 steps/s
[Step=9600 Epoch=18.1] | Loss=0.00070 | Reg=0.00119 | acc=1.0000 | FP-Norm=1.075 | FP-Norm(final)=2.308 | 3624.6 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22894 | acc=0.8391 | tpr=0.7752 | fpr=0.0223 | 3976.7 samples/s | 15.5 steps/s
Avg test loss: 0.23650, Avg test acc: 0.83604, Avg tpr: 0.77175, Avg fpr: 0.02256, total FA: 176

Testing server on iccad2012
[Step=  50] | Loss=0.52976 | acc=0.7430 | tpr=0.9646 | fpr=0.2609 | 3956.6 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.52034 | acc=0.7494 | tpr=0.9787 | fpr=0.2549 | 7392.8 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.52622 | acc=0.7460 | tpr=0.9841 | fpr=0.2584 | 7145.5 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.52127 | acc=0.7475 | tpr=0.9858 | fpr=0.2569 | 7084.4 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.52038 | acc=0.7475 | tpr=0.9860 | fpr=0.2568 | 7291.1 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.52004 | acc=0.7473 | tpr=0.9847 | fpr=0.2571 | 7067.8 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.52021 | acc=0.7475 | tpr=0.9831 | fpr=0.2567 | 7099.3 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.52131 | acc=0.7470 | tpr=0.9830 | fpr=0.2573 | 7287.6 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.52309 | acc=0.7471 | tpr=0.9834 | fpr=0.2572 | 7345.4 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.52266 | acc=0.7471 | tpr=0.9837 | fpr=0.2572 | 6841.2 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.52145 | acc=0.7474 | tpr=0.9837 | fpr=0.2569 | 13310.9 samples/s | 52.0 steps/s
Avg test loss: 0.52154, Avg test acc: 0.74745, Avg tpr: 0.98376, Avg fpr: 0.25685, total FA: 35663

server round 12/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch= 9.4] | Loss=0.10955 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.314 | 4064.6 samples/s | 63.5 steps/s
[Step=9650 Epoch= 9.4] | Loss=0.03661 | Reg=0.00085 | acc=0.9688 | FP-Norm=0.875 | FP-Norm(final)=2.317 | 3728.8 samples/s | 58.3 steps/s
[Step=9700 Epoch= 9.5] | Loss=0.03032 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.945 | FP-Norm(final)=2.320 | 3900.0 samples/s | 60.9 steps/s
[Step=9750 Epoch= 9.5] | Loss=0.02776 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.961 | FP-Norm(final)=2.324 | 3923.0 samples/s | 61.3 steps/s
[Step=9800 Epoch= 9.6] | Loss=0.02679 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.975 | FP-Norm(final)=2.326 | 3817.3 samples/s | 59.6 steps/s
[Step=9850 Epoch= 9.6] | Loss=0.02595 | Reg=0.00100 | acc=0.9844 | FP-Norm=0.992 | FP-Norm(final)=2.329 | 3826.2 samples/s | 59.8 steps/s
[Step=9900 Epoch= 9.7] | Loss=0.02507 | Reg=0.00103 | acc=0.9688 | FP-Norm=1.008 | FP-Norm(final)=2.331 | 3856.7 samples/s | 60.3 steps/s
[Step=9950 Epoch= 9.7] | Loss=0.02439 | Reg=0.00106 | acc=0.9844 | FP-Norm=1.021 | FP-Norm(final)=2.333 | 3863.1 samples/s | 60.4 steps/s
[Step=10000 Epoch= 9.8] | Loss=0.02406 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.034 | FP-Norm(final)=2.335 | 3841.8 samples/s | 60.0 steps/s
[Step=10050 Epoch= 9.8] | Loss=0.02409 | Reg=0.00111 | acc=0.9531 | FP-Norm=1.047 | FP-Norm(final)=2.335 | 3856.8 samples/s | 60.3 steps/s
[Step=10100 Epoch= 9.9] | Loss=0.02454 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.061 | FP-Norm(final)=2.336 | 3835.7 samples/s | 59.9 steps/s
[Step=10150 Epoch= 9.9] | Loss=0.02459 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.077 | FP-Norm(final)=2.335 | 3857.1 samples/s | 60.3 steps/s
[Step=10200 Epoch=10.0] | Loss=0.02469 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.090 | FP-Norm(final)=2.336 | 3844.5 samples/s | 60.1 steps/s
[Step=10250 Epoch=10.0] | Loss=0.02454 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.102 | FP-Norm(final)=2.336 | 3872.7 samples/s | 60.5 steps/s
[Step=10300 Epoch=10.1] | Loss=0.02480 | Reg=0.00126 | acc=0.9688 | FP-Norm=1.113 | FP-Norm(final)=2.336 | 3854.2 samples/s | 60.2 steps/s
[Step=10350 Epoch=10.1] | Loss=0.02454 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.125 | FP-Norm(final)=2.337 | 3860.8 samples/s | 60.3 steps/s
[Step=10400 Epoch=10.2] | Loss=0.02469 | Reg=0.00131 | acc=0.9531 | FP-Norm=1.136 | FP-Norm(final)=2.337 | 3877.2 samples/s | 60.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step10400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=18.1] | Loss=0.16908 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.312 | 4085.5 samples/s | 63.8 steps/s
[Step=9650 Epoch=18.2] | Loss=0.01092 | Reg=0.00282 | acc=1.0000 | FP-Norm=1.603 | FP-Norm(final)=2.296 | 3476.1 samples/s | 54.3 steps/s
[Step=9700 Epoch=18.3] | Loss=0.00608 | Reg=0.00299 | acc=1.0000 | FP-Norm=1.688 | FP-Norm(final)=2.294 | 3646.4 samples/s | 57.0 steps/s
[Step=9750 Epoch=18.4] | Loss=0.00450 | Reg=0.00286 | acc=1.0000 | FP-Norm=1.665 | FP-Norm(final)=2.295 | 3671.0 samples/s | 57.4 steps/s
[Step=9800 Epoch=18.5] | Loss=0.00355 | Reg=0.00273 | acc=1.0000 | FP-Norm=1.630 | FP-Norm(final)=2.296 | 3621.5 samples/s | 56.6 steps/s
[Step=9850 Epoch=18.6] | Loss=0.00291 | Reg=0.00265 | acc=1.0000 | FP-Norm=1.610 | FP-Norm(final)=2.298 | 3624.4 samples/s | 56.6 steps/s
[Step=9900 Epoch=18.7] | Loss=0.00244 | Reg=0.00256 | acc=1.0000 | FP-Norm=1.583 | FP-Norm(final)=2.300 | 3668.7 samples/s | 57.3 steps/s
[Step=9950 Epoch=18.8] | Loss=0.00210 | Reg=0.00246 | acc=1.0000 | FP-Norm=1.552 | FP-Norm(final)=2.301 | 3632.1 samples/s | 56.8 steps/s
[Step=10000 Epoch=18.9] | Loss=0.00185 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.522 | FP-Norm(final)=2.303 | 3659.5 samples/s | 57.2 steps/s
[Step=10050 Epoch=18.9] | Loss=0.00165 | Reg=0.00228 | acc=1.0000 | FP-Norm=1.492 | FP-Norm(final)=2.304 | 3649.6 samples/s | 57.0 steps/s
[Step=10100 Epoch=19.0] | Loss=0.00149 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.463 | FP-Norm(final)=2.306 | 3683.3 samples/s | 57.6 steps/s
[Step=10150 Epoch=19.1] | Loss=0.00136 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.435 | FP-Norm(final)=2.307 | 1860.3 samples/s | 29.1 steps/s
[Step=10200 Epoch=19.2] | Loss=0.00125 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.407 | FP-Norm(final)=2.308 | 3710.2 samples/s | 58.0 steps/s
[Step=10250 Epoch=19.3] | Loss=0.00116 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.381 | FP-Norm(final)=2.309 | 3612.0 samples/s | 56.4 steps/s
[Step=10300 Epoch=19.4] | Loss=0.00108 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.356 | FP-Norm(final)=2.310 | 3628.1 samples/s | 56.7 steps/s
[Step=10350 Epoch=19.5] | Loss=0.00100 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.331 | FP-Norm(final)=2.311 | 3627.4 samples/s | 56.7 steps/s
[Step=10400 Epoch=19.6] | Loss=0.00094 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.307 | FP-Norm(final)=2.312 | 3636.7 samples/s | 56.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27812 | acc=0.8041 | tpr=0.7251 | fpr=0.0243 | 3926.3 samples/s | 15.3 steps/s
Avg test loss: 0.28603, Avg test acc: 0.80050, Avg tpr: 0.72122, Avg fpr: 0.02512, total FA: 196

Testing server on iccad2012
[Step=  50] | Loss=0.40239 | acc=0.8052 | tpr=0.9690 | fpr=0.1977 | 3887.2 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.39567 | acc=0.8098 | tpr=0.9787 | fpr=0.1933 | 7415.2 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.40086 | acc=0.8069 | tpr=0.9841 | fpr=0.1964 | 6997.2 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.39606 | acc=0.8085 | tpr=0.9847 | fpr=0.1947 | 7246.2 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.39521 | acc=0.8085 | tpr=0.9843 | fpr=0.1947 | 7337.3 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.39541 | acc=0.8085 | tpr=0.9825 | fpr=0.1947 | 7016.3 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.39543 | acc=0.8086 | tpr=0.9806 | fpr=0.1945 | 7169.7 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.39628 | acc=0.8080 | tpr=0.9809 | fpr=0.1951 | 7177.7 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.39760 | acc=0.8082 | tpr=0.9815 | fpr=0.1950 | 7096.5 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.39765 | acc=0.8080 | tpr=0.9824 | fpr=0.1951 | 7106.0 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.39671 | acc=0.8083 | tpr=0.9829 | fpr=0.1949 | 13607.2 samples/s | 53.2 steps/s
Avg test loss: 0.39681, Avg test acc: 0.80832, Avg tpr: 0.98296, Avg fpr: 0.19485, total FA: 27055

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=10.2] | Loss=0.14091 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.330 | 4027.1 samples/s | 62.9 steps/s
[Step=10450 Epoch=10.2] | Loss=0.03498 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.013 | FP-Norm(final)=2.333 | 3806.2 samples/s | 59.5 steps/s
[Step=10500 Epoch=10.3] | Loss=0.02689 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.062 | FP-Norm(final)=2.341 | 3892.6 samples/s | 60.8 steps/s
[Step=10550 Epoch=10.3] | Loss=0.02538 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.071 | FP-Norm(final)=2.345 | 3932.4 samples/s | 61.4 steps/s
[Step=10600 Epoch=10.3] | Loss=0.02530 | Reg=0.00119 | acc=0.9844 | FP-Norm=1.078 | FP-Norm(final)=2.346 | 3935.2 samples/s | 61.5 steps/s
[Step=10650 Epoch=10.4] | Loss=0.02601 | Reg=0.00121 | acc=0.9844 | FP-Norm=1.089 | FP-Norm(final)=2.347 | 3869.5 samples/s | 60.5 steps/s
[Step=10700 Epoch=10.4] | Loss=0.02633 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.101 | FP-Norm(final)=2.347 | 3944.8 samples/s | 61.6 steps/s
[Step=10750 Epoch=10.5] | Loss=0.02625 | Reg=0.00125 | acc=0.9688 | FP-Norm=1.113 | FP-Norm(final)=2.347 | 3946.1 samples/s | 61.7 steps/s
[Step=10800 Epoch=10.5] | Loss=0.02622 | Reg=0.00128 | acc=0.9531 | FP-Norm=1.123 | FP-Norm(final)=2.347 | 3916.9 samples/s | 61.2 steps/s
[Step=10850 Epoch=10.6] | Loss=0.02559 | Reg=0.00130 | acc=0.9688 | FP-Norm=1.133 | FP-Norm(final)=2.348 | 3933.5 samples/s | 61.5 steps/s
[Step=10900 Epoch=10.6] | Loss=0.02514 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.142 | FP-Norm(final)=2.349 | 3785.0 samples/s | 59.1 steps/s
[Step=10950 Epoch=10.7] | Loss=0.02512 | Reg=0.00134 | acc=0.9688 | FP-Norm=1.152 | FP-Norm(final)=2.350 | 3819.1 samples/s | 59.7 steps/s
[Step=11000 Epoch=10.7] | Loss=0.02497 | Reg=0.00137 | acc=0.9844 | FP-Norm=1.163 | FP-Norm(final)=2.351 | 3864.3 samples/s | 60.4 steps/s
[Step=11050 Epoch=10.8] | Loss=0.02484 | Reg=0.00139 | acc=1.0000 | FP-Norm=1.174 | FP-Norm(final)=2.351 | 3838.2 samples/s | 60.0 steps/s
[Step=11100 Epoch=10.8] | Loss=0.02469 | Reg=0.00142 | acc=0.9531 | FP-Norm=1.184 | FP-Norm(final)=2.352 | 3841.7 samples/s | 60.0 steps/s
[Step=11150 Epoch=10.9] | Loss=0.02454 | Reg=0.00144 | acc=0.9688 | FP-Norm=1.194 | FP-Norm(final)=2.353 | 3829.7 samples/s | 59.8 steps/s
[Step=11200 Epoch=10.9] | Loss=0.02438 | Reg=0.00146 | acc=0.9688 | FP-Norm=1.203 | FP-Norm(final)=2.354 | 3832.7 samples/s | 59.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step11200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=19.6] | Loss=0.03794 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.330 | 4566.9 samples/s | 71.4 steps/s
[Step=10450 Epoch=19.7] | Loss=0.00859 | Reg=0.00201 | acc=1.0000 | FP-Norm=1.337 | FP-Norm(final)=2.324 | 3258.3 samples/s | 50.9 steps/s
[Step=10500 Epoch=19.8] | Loss=0.00520 | Reg=0.00238 | acc=1.0000 | FP-Norm=1.496 | FP-Norm(final)=2.323 | 3736.5 samples/s | 58.4 steps/s
[Step=10550 Epoch=19.9] | Loss=0.00363 | Reg=0.00238 | acc=1.0000 | FP-Norm=1.513 | FP-Norm(final)=2.324 | 3636.3 samples/s | 56.8 steps/s
[Step=10600 Epoch=20.0] | Loss=0.00329 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.508 | FP-Norm(final)=2.326 | 3666.6 samples/s | 57.3 steps/s
[Step=10650 Epoch=20.1] | Loss=0.00306 | Reg=0.00235 | acc=0.9844 | FP-Norm=1.515 | FP-Norm(final)=2.326 | 3617.4 samples/s | 56.5 steps/s
[Step=10700 Epoch=20.2] | Loss=0.00259 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.515 | FP-Norm(final)=2.327 | 3649.0 samples/s | 57.0 steps/s
[Step=10750 Epoch=20.3] | Loss=0.00223 | Reg=0.00230 | acc=1.0000 | FP-Norm=1.503 | FP-Norm(final)=2.328 | 3661.2 samples/s | 57.2 steps/s
[Step=10800 Epoch=20.4] | Loss=0.00207 | Reg=0.00226 | acc=1.0000 | FP-Norm=1.491 | FP-Norm(final)=2.330 | 3641.1 samples/s | 56.9 steps/s
[Step=10850 Epoch=20.5] | Loss=0.00185 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.479 | FP-Norm(final)=2.331 | 3655.6 samples/s | 57.1 steps/s
[Step=10900 Epoch=20.5] | Loss=0.00167 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.464 | FP-Norm(final)=2.333 | 3718.1 samples/s | 58.1 steps/s
[Step=10950 Epoch=20.6] | Loss=0.00152 | Reg=0.00213 | acc=1.0000 | FP-Norm=1.448 | FP-Norm(final)=2.334 | 1884.0 samples/s | 29.4 steps/s
[Step=11000 Epoch=20.7] | Loss=0.00140 | Reg=0.00208 | acc=1.0000 | FP-Norm=1.430 | FP-Norm(final)=2.335 | 3683.4 samples/s | 57.6 steps/s
[Step=11050 Epoch=20.8] | Loss=0.00129 | Reg=0.00203 | acc=1.0000 | FP-Norm=1.412 | FP-Norm(final)=2.336 | 3616.3 samples/s | 56.5 steps/s
[Step=11100 Epoch=20.9] | Loss=0.00120 | Reg=0.00198 | acc=1.0000 | FP-Norm=1.393 | FP-Norm(final)=2.337 | 3627.0 samples/s | 56.7 steps/s
[Step=11150 Epoch=21.0] | Loss=0.00112 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.375 | FP-Norm(final)=2.338 | 3489.2 samples/s | 54.5 steps/s
[Step=11200 Epoch=21.1] | Loss=0.00105 | Reg=0.00188 | acc=1.0000 | FP-Norm=1.356 | FP-Norm(final)=2.338 | 3626.9 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23331 | acc=0.8377 | tpr=0.7750 | fpr=0.0260 | 3894.8 samples/s | 15.2 steps/s
Avg test loss: 0.23994, Avg test acc: 0.83388, Avg tpr: 0.77059, Avg fpr: 0.02692, total FA: 210

Testing server on iccad2012
[Step=  50] | Loss=0.46237 | acc=0.7833 | tpr=0.9690 | fpr=0.2201 | 3916.1 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.45591 | acc=0.7888 | tpr=0.9808 | fpr=0.2148 | 7205.3 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.46014 | acc=0.7867 | tpr=0.9856 | fpr=0.2170 | 7154.3 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.45422 | acc=0.7887 | tpr=0.9869 | fpr=0.2149 | 7264.8 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.45315 | acc=0.7886 | tpr=0.9869 | fpr=0.2150 | 7210.7 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.45377 | acc=0.7882 | tpr=0.9840 | fpr=0.2154 | 7103.2 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.45403 | acc=0.7882 | tpr=0.9831 | fpr=0.2153 | 7145.4 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.45535 | acc=0.7880 | tpr=0.9819 | fpr=0.2155 | 6956.2 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.45667 | acc=0.7882 | tpr=0.9820 | fpr=0.2153 | 7086.9 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.45622 | acc=0.7881 | tpr=0.9828 | fpr=0.2154 | 7238.0 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.45514 | acc=0.7882 | tpr=0.9833 | fpr=0.2153 | 13123.0 samples/s | 51.3 steps/s
Avg test loss: 0.45522, Avg test acc: 0.78827, Avg tpr: 0.98336, Avg fpr: 0.21528, total FA: 29891

server round 14/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=10.9] | Loss=0.14351 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.353 | 4048.1 samples/s | 63.3 steps/s
[Step=11250 Epoch=11.0] | Loss=0.04391 | Reg=0.00106 | acc=0.9844 | FP-Norm=0.987 | FP-Norm(final)=2.346 | 3821.3 samples/s | 59.7 steps/s
[Step=11300 Epoch=11.0] | Loss=0.03407 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.045 | FP-Norm(final)=2.352 | 3796.1 samples/s | 59.3 steps/s
[Step=11350 Epoch=11.1] | Loss=0.02984 | Reg=0.00114 | acc=0.9375 | FP-Norm=1.052 | FP-Norm(final)=2.358 | 3840.3 samples/s | 60.0 steps/s
[Step=11400 Epoch=11.1] | Loss=0.02662 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.057 | FP-Norm(final)=2.362 | 3818.0 samples/s | 59.7 steps/s
[Step=11450 Epoch=11.2] | Loss=0.02532 | Reg=0.00114 | acc=0.9844 | FP-Norm=1.060 | FP-Norm(final)=2.366 | 3813.7 samples/s | 59.6 steps/s
[Step=11500 Epoch=11.2] | Loss=0.02474 | Reg=0.00116 | acc=0.9844 | FP-Norm=1.068 | FP-Norm(final)=2.368 | 3865.9 samples/s | 60.4 steps/s
[Step=11550 Epoch=11.3] | Loss=0.02488 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.081 | FP-Norm(final)=2.370 | 3811.2 samples/s | 59.5 steps/s
[Step=11600 Epoch=11.3] | Loss=0.02453 | Reg=0.00121 | acc=0.9844 | FP-Norm=1.095 | FP-Norm(final)=2.371 | 3839.4 samples/s | 60.0 steps/s
[Step=11650 Epoch=11.4] | Loss=0.02366 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.105 | FP-Norm(final)=2.373 | 3852.1 samples/s | 60.2 steps/s
[Step=11700 Epoch=11.4] | Loss=0.02381 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.116 | FP-Norm(final)=2.374 | 3841.5 samples/s | 60.0 steps/s
[Step=11750 Epoch=11.5] | Loss=0.02373 | Reg=0.00129 | acc=0.9844 | FP-Norm=1.130 | FP-Norm(final)=2.375 | 3852.6 samples/s | 60.2 steps/s
[Step=11800 Epoch=11.5] | Loss=0.02361 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.142 | FP-Norm(final)=2.375 | 3842.3 samples/s | 60.0 steps/s
[Step=11850 Epoch=11.6] | Loss=0.02358 | Reg=0.00135 | acc=0.9844 | FP-Norm=1.154 | FP-Norm(final)=2.376 | 3815.4 samples/s | 59.6 steps/s
[Step=11900 Epoch=11.6] | Loss=0.02351 | Reg=0.00138 | acc=0.9844 | FP-Norm=1.166 | FP-Norm(final)=2.376 | 3842.9 samples/s | 60.0 steps/s
[Step=11950 Epoch=11.7] | Loss=0.02345 | Reg=0.00141 | acc=0.9688 | FP-Norm=1.179 | FP-Norm(final)=2.376 | 3851.1 samples/s | 60.2 steps/s
[Step=12000 Epoch=11.7] | Loss=0.02333 | Reg=0.00144 | acc=0.9688 | FP-Norm=1.191 | FP-Norm(final)=2.376 | 3851.8 samples/s | 60.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step12000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=21.1] | Loss=0.11872 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.352 | 4140.8 samples/s | 64.7 steps/s
[Step=11250 Epoch=21.2] | Loss=0.00907 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.502 | FP-Norm(final)=2.338 | 3469.1 samples/s | 54.2 steps/s
[Step=11300 Epoch=21.3] | Loss=0.00587 | Reg=0.00258 | acc=0.9844 | FP-Norm=1.572 | FP-Norm(final)=2.337 | 3701.2 samples/s | 57.8 steps/s
[Step=11350 Epoch=21.4] | Loss=0.00435 | Reg=0.00252 | acc=1.0000 | FP-Norm=1.564 | FP-Norm(final)=2.337 | 3721.6 samples/s | 58.2 steps/s
[Step=11400 Epoch=21.5] | Loss=0.00336 | Reg=0.00242 | acc=1.0000 | FP-Norm=1.538 | FP-Norm(final)=2.339 | 3633.5 samples/s | 56.8 steps/s
[Step=11450 Epoch=21.6] | Loss=0.00273 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.507 | FP-Norm(final)=2.341 | 3640.0 samples/s | 56.9 steps/s
[Step=11500 Epoch=21.7] | Loss=0.00233 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.474 | FP-Norm(final)=2.342 | 3629.0 samples/s | 56.7 steps/s
[Step=11550 Epoch=21.8] | Loss=0.00203 | Reg=0.00213 | acc=1.0000 | FP-Norm=1.444 | FP-Norm(final)=2.345 | 3649.7 samples/s | 57.0 steps/s
[Step=11600 Epoch=21.9] | Loss=0.00178 | Reg=0.00206 | acc=1.0000 | FP-Norm=1.418 | FP-Norm(final)=2.347 | 3681.9 samples/s | 57.5 steps/s
[Step=11650 Epoch=22.0] | Loss=0.00159 | Reg=0.00198 | acc=1.0000 | FP-Norm=1.390 | FP-Norm(final)=2.348 | 3637.2 samples/s | 56.8 steps/s
[Step=11700 Epoch=22.1] | Loss=0.00144 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.363 | FP-Norm(final)=2.350 | 3678.7 samples/s | 57.5 steps/s
[Step=11750 Epoch=22.1] | Loss=0.00131 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.338 | FP-Norm(final)=2.351 | 1919.1 samples/s | 30.0 steps/s
[Step=11800 Epoch=22.2] | Loss=0.00120 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.312 | FP-Norm(final)=2.352 | 3749.8 samples/s | 58.6 steps/s
[Step=11850 Epoch=22.3] | Loss=0.00111 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.288 | FP-Norm(final)=2.354 | 3665.6 samples/s | 57.3 steps/s
[Step=11900 Epoch=22.4] | Loss=0.00104 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.265 | FP-Norm(final)=2.355 | 3716.2 samples/s | 58.1 steps/s
[Step=11950 Epoch=22.5] | Loss=0.00097 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.243 | FP-Norm(final)=2.356 | 3619.5 samples/s | 56.6 steps/s
[Step=12000 Epoch=22.6] | Loss=0.00091 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.221 | FP-Norm(final)=2.356 | 3616.1 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17074 | acc=0.8775 | tpr=0.8326 | fpr=0.0250 | 3919.6 samples/s | 15.3 steps/s
Avg test loss: 0.17625, Avg test acc: 0.87535, Avg tpr: 0.83062, Avg fpr: 0.02628, total FA: 205

Testing server on iccad2012
[Step=  50] | Loss=0.57969 | acc=0.7408 | tpr=0.9690 | fpr=0.2633 | 3935.9 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.56863 | acc=0.7468 | tpr=0.9808 | fpr=0.2576 | 7310.2 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.57391 | acc=0.7445 | tpr=0.9856 | fpr=0.2600 | 6918.1 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.56671 | acc=0.7463 | tpr=0.9869 | fpr=0.2580 | 7147.9 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.56546 | acc=0.7458 | tpr=0.9869 | fpr=0.2586 | 7190.8 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.56596 | acc=0.7454 | tpr=0.9840 | fpr=0.2589 | 7301.3 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.56586 | acc=0.7456 | tpr=0.9831 | fpr=0.2587 | 7249.8 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.56729 | acc=0.7449 | tpr=0.9830 | fpr=0.2594 | 6996.7 samples/s | 27.3 steps/s
[Step= 450] | Loss=0.56860 | acc=0.7454 | tpr=0.9834 | fpr=0.2589 | 7300.0 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.56843 | acc=0.7451 | tpr=0.9841 | fpr=0.2592 | 7098.5 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.56685 | acc=0.7450 | tpr=0.9849 | fpr=0.2593 | 13017.5 samples/s | 50.8 steps/s
Avg test loss: 0.56702, Avg test acc: 0.74502, Avg tpr: 0.98494, Avg fpr: 0.25934, total FA: 36009

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=11.7] | Loss=0.11162 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.373 | 4445.1 samples/s | 69.5 steps/s
[Step=12050 Epoch=11.8] | Loss=0.02185 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.744 | FP-Norm(final)=2.384 | 3613.5 samples/s | 56.5 steps/s
[Step=12100 Epoch=11.8] | Loss=0.02034 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.822 | FP-Norm(final)=2.391 | 3807.8 samples/s | 59.5 steps/s
[Step=12150 Epoch=11.9] | Loss=0.02159 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.867 | FP-Norm(final)=2.393 | 3822.0 samples/s | 59.7 steps/s
[Step=12200 Epoch=11.9] | Loss=0.02319 | Reg=0.00084 | acc=0.9531 | FP-Norm=0.905 | FP-Norm(final)=2.394 | 3830.8 samples/s | 59.9 steps/s
[Step=12250 Epoch=12.0] | Loss=0.02246 | Reg=0.00089 | acc=0.9844 | FP-Norm=0.933 | FP-Norm(final)=2.394 | 3804.8 samples/s | 59.4 steps/s
[Step=12300 Epoch=12.0] | Loss=0.02289 | Reg=0.00094 | acc=0.9531 | FP-Norm=0.956 | FP-Norm(final)=2.395 | 3855.3 samples/s | 60.2 steps/s
[Step=12350 Epoch=12.1] | Loss=0.02264 | Reg=0.00098 | acc=0.9844 | FP-Norm=0.978 | FP-Norm(final)=2.395 | 3935.2 samples/s | 61.5 steps/s
[Step=12400 Epoch=12.1] | Loss=0.02221 | Reg=0.00101 | acc=0.9688 | FP-Norm=0.994 | FP-Norm(final)=2.397 | 3925.8 samples/s | 61.3 steps/s
[Step=12450 Epoch=12.2] | Loss=0.02170 | Reg=0.00104 | acc=0.9844 | FP-Norm=1.010 | FP-Norm(final)=2.398 | 3937.5 samples/s | 61.5 steps/s
[Step=12500 Epoch=12.2] | Loss=0.02229 | Reg=0.00107 | acc=0.9844 | FP-Norm=1.026 | FP-Norm(final)=2.400 | 3901.4 samples/s | 61.0 steps/s
[Step=12550 Epoch=12.3] | Loss=0.02268 | Reg=0.00112 | acc=0.9688 | FP-Norm=1.048 | FP-Norm(final)=2.400 | 3928.4 samples/s | 61.4 steps/s
[Step=12600 Epoch=12.3] | Loss=0.02235 | Reg=0.00116 | acc=0.9688 | FP-Norm=1.066 | FP-Norm(final)=2.400 | 3943.1 samples/s | 61.6 steps/s
[Step=12650 Epoch=12.4] | Loss=0.02245 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.082 | FP-Norm(final)=2.400 | 3950.1 samples/s | 61.7 steps/s
[Step=12700 Epoch=12.4] | Loss=0.02218 | Reg=0.00123 | acc=0.9844 | FP-Norm=1.098 | FP-Norm(final)=2.401 | 3921.6 samples/s | 61.3 steps/s
[Step=12750 Epoch=12.4] | Loss=0.02228 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.112 | FP-Norm(final)=2.401 | 3949.2 samples/s | 61.7 steps/s
[Step=12800 Epoch=12.5] | Loss=0.02263 | Reg=0.00130 | acc=0.9531 | FP-Norm=1.125 | FP-Norm(final)=2.401 | 3929.6 samples/s | 61.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step12800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=22.6] | Loss=0.10550 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.372 | 4045.3 samples/s | 63.2 steps/s
[Step=12050 Epoch=22.7] | Loss=0.01014 | Reg=0.00273 | acc=1.0000 | FP-Norm=1.583 | FP-Norm(final)=2.358 | 3506.5 samples/s | 54.8 steps/s
[Step=12100 Epoch=22.8] | Loss=0.00600 | Reg=0.00291 | acc=1.0000 | FP-Norm=1.670 | FP-Norm(final)=2.357 | 3701.6 samples/s | 57.8 steps/s
[Step=12150 Epoch=22.9] | Loss=0.00429 | Reg=0.00285 | acc=1.0000 | FP-Norm=1.663 | FP-Norm(final)=2.359 | 3672.8 samples/s | 57.4 steps/s
[Step=12200 Epoch=23.0] | Loss=0.00343 | Reg=0.00273 | acc=1.0000 | FP-Norm=1.635 | FP-Norm(final)=2.361 | 3653.6 samples/s | 57.1 steps/s
[Step=12250 Epoch=23.1] | Loss=0.00277 | Reg=0.00261 | acc=1.0000 | FP-Norm=1.599 | FP-Norm(final)=2.363 | 3682.3 samples/s | 57.5 steps/s
[Step=12300 Epoch=23.2] | Loss=0.00231 | Reg=0.00249 | acc=1.0000 | FP-Norm=1.562 | FP-Norm(final)=2.365 | 3683.3 samples/s | 57.6 steps/s
[Step=12350 Epoch=23.3] | Loss=0.00201 | Reg=0.00238 | acc=1.0000 | FP-Norm=1.526 | FP-Norm(final)=2.366 | 3682.9 samples/s | 57.5 steps/s
[Step=12400 Epoch=23.4] | Loss=0.00178 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.496 | FP-Norm(final)=2.367 | 3617.6 samples/s | 56.5 steps/s
[Step=12450 Epoch=23.5] | Loss=0.00158 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.466 | FP-Norm(final)=2.368 | 3622.9 samples/s | 56.6 steps/s
[Step=12500 Epoch=23.6] | Loss=0.00143 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.437 | FP-Norm(final)=2.369 | 3678.1 samples/s | 57.5 steps/s
[Step=12550 Epoch=23.7] | Loss=0.00130 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.409 | FP-Norm(final)=2.370 | 1886.3 samples/s | 29.5 steps/s
[Step=12600 Epoch=23.8] | Loss=0.00119 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.383 | FP-Norm(final)=2.371 | 3665.3 samples/s | 57.3 steps/s
[Step=12650 Epoch=23.8] | Loss=0.00110 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.356 | FP-Norm(final)=2.372 | 3656.3 samples/s | 57.1 steps/s
[Step=12700 Epoch=23.9] | Loss=0.00103 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.331 | FP-Norm(final)=2.373 | 3613.8 samples/s | 56.5 steps/s
[Step=12750 Epoch=24.0] | Loss=0.00096 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.307 | FP-Norm(final)=2.373 | 3602.4 samples/s | 56.3 steps/s
[Step=12800 Epoch=24.1] | Loss=0.00090 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.284 | FP-Norm(final)=2.374 | 3647.1 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23925 | acc=0.8322 | tpr=0.7626 | fpr=0.0166 | 3984.5 samples/s | 15.6 steps/s
Avg test loss: 0.24768, Avg test acc: 0.82799, Avg tpr: 0.75812, Avg fpr: 0.01833, total FA: 143

Testing server on iccad2012
[Step=  50] | Loss=0.43373 | acc=0.8020 | tpr=0.9646 | fpr=0.2010 | 3928.5 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.42809 | acc=0.8079 | tpr=0.9765 | fpr=0.1953 | 7274.1 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.43308 | acc=0.8065 | tpr=0.9827 | fpr=0.1967 | 7112.2 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.42726 | acc=0.8088 | tpr=0.9858 | fpr=0.1945 | 7344.4 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.42614 | acc=0.8089 | tpr=0.9860 | fpr=0.1943 | 7309.9 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.42726 | acc=0.8089 | tpr=0.9847 | fpr=0.1943 | 6737.5 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.42674 | acc=0.8089 | tpr=0.9831 | fpr=0.1943 | 6162.2 samples/s | 24.1 steps/s
[Step= 400] | Loss=0.42777 | acc=0.8081 | tpr=0.9836 | fpr=0.1951 | 6209.8 samples/s | 24.3 steps/s
[Step= 450] | Loss=0.42915 | acc=0.8083 | tpr=0.9834 | fpr=0.1949 | 5768.6 samples/s | 22.5 steps/s
[Step= 500] | Loss=0.42854 | acc=0.8081 | tpr=0.9846 | fpr=0.1951 | 6063.2 samples/s | 23.7 steps/s
[Step= 550] | Loss=0.42739 | acc=0.8085 | tpr=0.9845 | fpr=0.1947 | 11413.1 samples/s | 44.6 steps/s
Avg test loss: 0.42752, Avg test acc: 0.80848, Avg tpr: 0.98455, Avg fpr: 0.19472, total FA: 27036

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=12.5] | Loss=0.20686 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.386 | 4071.8 samples/s | 63.6 steps/s
[Step=12850 Epoch=12.5] | Loss=0.02683 | Reg=0.00074 | acc=0.9688 | FP-Norm=0.825 | FP-Norm(final)=2.387 | 3708.6 samples/s | 57.9 steps/s
[Step=12900 Epoch=12.6] | Loss=0.02030 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.890 | FP-Norm(final)=2.395 | 3834.8 samples/s | 59.9 steps/s
[Step=12950 Epoch=12.6] | Loss=0.02025 | Reg=0.00086 | acc=0.9688 | FP-Norm=0.915 | FP-Norm(final)=2.400 | 3800.5 samples/s | 59.4 steps/s
[Step=13000 Epoch=12.7] | Loss=0.02027 | Reg=0.00091 | acc=0.9531 | FP-Norm=0.941 | FP-Norm(final)=2.402 | 3805.8 samples/s | 59.5 steps/s
[Step=13050 Epoch=12.7] | Loss=0.02064 | Reg=0.00094 | acc=0.9844 | FP-Norm=0.960 | FP-Norm(final)=2.403 | 3818.0 samples/s | 59.7 steps/s
[Step=13100 Epoch=12.8] | Loss=0.02047 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.974 | FP-Norm(final)=2.403 | 3859.0 samples/s | 60.3 steps/s
[Step=13150 Epoch=12.8] | Loss=0.02057 | Reg=0.00099 | acc=0.9844 | FP-Norm=0.989 | FP-Norm(final)=2.403 | 3839.7 samples/s | 60.0 steps/s
[Step=13200 Epoch=12.9] | Loss=0.02072 | Reg=0.00102 | acc=0.9844 | FP-Norm=1.005 | FP-Norm(final)=2.404 | 3854.8 samples/s | 60.2 steps/s
[Step=13250 Epoch=12.9] | Loss=0.02081 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.022 | FP-Norm(final)=2.404 | 3844.1 samples/s | 60.1 steps/s
[Step=13300 Epoch=13.0] | Loss=0.02097 | Reg=0.00110 | acc=0.9688 | FP-Norm=1.039 | FP-Norm(final)=2.404 | 3860.5 samples/s | 60.3 steps/s
[Step=13350 Epoch=13.0] | Loss=0.02075 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.053 | FP-Norm(final)=2.404 | 3845.7 samples/s | 60.1 steps/s
[Step=13400 Epoch=13.1] | Loss=0.02051 | Reg=0.00115 | acc=0.9844 | FP-Norm=1.066 | FP-Norm(final)=2.405 | 3861.1 samples/s | 60.3 steps/s
[Step=13450 Epoch=13.1] | Loss=0.02039 | Reg=0.00118 | acc=0.9844 | FP-Norm=1.078 | FP-Norm(final)=2.406 | 3825.8 samples/s | 59.8 steps/s
[Step=13500 Epoch=13.2] | Loss=0.02052 | Reg=0.00121 | acc=0.9688 | FP-Norm=1.090 | FP-Norm(final)=2.407 | 3861.5 samples/s | 60.3 steps/s
[Step=13550 Epoch=13.2] | Loss=0.02046 | Reg=0.00123 | acc=0.9844 | FP-Norm=1.100 | FP-Norm(final)=2.407 | 3864.1 samples/s | 60.4 steps/s
[Step=13600 Epoch=13.3] | Loss=0.02052 | Reg=0.00126 | acc=0.9844 | FP-Norm=1.112 | FP-Norm(final)=2.408 | 3855.7 samples/s | 60.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step13600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=24.1] | Loss=0.14264 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.385 | 4006.2 samples/s | 62.6 steps/s
[Step=12850 Epoch=24.2] | Loss=0.00784 | Reg=0.00184 | acc=0.9844 | FP-Norm=1.292 | FP-Norm(final)=2.381 | 3564.0 samples/s | 55.7 steps/s
[Step=12900 Epoch=24.3] | Loss=0.00442 | Reg=0.00200 | acc=1.0000 | FP-Norm=1.382 | FP-Norm(final)=2.380 | 3633.2 samples/s | 56.8 steps/s
[Step=12950 Epoch=24.4] | Loss=0.00324 | Reg=0.00201 | acc=1.0000 | FP-Norm=1.396 | FP-Norm(final)=2.382 | 3660.3 samples/s | 57.2 steps/s
[Step=13000 Epoch=24.5] | Loss=0.00261 | Reg=0.00200 | acc=1.0000 | FP-Norm=1.397 | FP-Norm(final)=2.383 | 3622.7 samples/s | 56.6 steps/s
[Step=13050 Epoch=24.6] | Loss=0.00211 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.391 | FP-Norm(final)=2.385 | 3621.2 samples/s | 56.6 steps/s
[Step=13100 Epoch=24.7] | Loss=0.00180 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.377 | FP-Norm(final)=2.387 | 3683.9 samples/s | 57.6 steps/s
[Step=13150 Epoch=24.8] | Loss=0.00155 | Reg=0.00188 | acc=1.0000 | FP-Norm=1.361 | FP-Norm(final)=2.388 | 3587.0 samples/s | 56.0 steps/s
[Step=13200 Epoch=24.9] | Loss=0.00136 | Reg=0.00183 | acc=1.0000 | FP-Norm=1.341 | FP-Norm(final)=2.389 | 3655.6 samples/s | 57.1 steps/s
[Step=13250 Epoch=25.0] | Loss=0.00122 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.320 | FP-Norm(final)=2.391 | 3632.2 samples/s | 56.8 steps/s
[Step=13300 Epoch=25.1] | Loss=0.00110 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.299 | FP-Norm(final)=2.392 | 3673.5 samples/s | 57.4 steps/s
[Step=13350 Epoch=25.2] | Loss=0.00101 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.278 | FP-Norm(final)=2.392 | 1885.7 samples/s | 29.5 steps/s
[Step=13400 Epoch=25.3] | Loss=0.00092 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.257 | FP-Norm(final)=2.393 | 3674.6 samples/s | 57.4 steps/s
[Step=13450 Epoch=25.4] | Loss=0.00085 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.236 | FP-Norm(final)=2.394 | 3649.2 samples/s | 57.0 steps/s
[Step=13500 Epoch=25.4] | Loss=0.00079 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.215 | FP-Norm(final)=2.394 | 3647.2 samples/s | 57.0 steps/s
[Step=13550 Epoch=25.5] | Loss=0.00074 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.195 | FP-Norm(final)=2.395 | 3645.6 samples/s | 57.0 steps/s
[Step=13600 Epoch=25.6] | Loss=0.00070 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.175 | FP-Norm(final)=2.395 | 3640.7 samples/s | 56.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24838 | acc=0.8314 | tpr=0.7622 | fpr=0.0183 | 3939.7 samples/s | 15.4 steps/s
Avg test loss: 0.25435, Avg test acc: 0.82747, Avg tpr: 0.75806, Avg fpr: 0.01987, total FA: 155

Testing server on iccad2012
[Step=  50] | Loss=0.44768 | acc=0.8063 | tpr=0.9646 | fpr=0.1966 | 3932.4 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.44351 | acc=0.8116 | tpr=0.9787 | fpr=0.1916 | 7254.3 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.44853 | acc=0.8102 | tpr=0.9841 | fpr=0.1930 | 7312.2 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.44353 | acc=0.8113 | tpr=0.9858 | fpr=0.1918 | 7256.0 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.44224 | acc=0.8115 | tpr=0.9860 | fpr=0.1917 | 7096.1 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.44305 | acc=0.8118 | tpr=0.9855 | fpr=0.1913 | 7111.6 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.44267 | acc=0.8119 | tpr=0.9843 | fpr=0.1912 | 7279.6 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.44365 | acc=0.8113 | tpr=0.9836 | fpr=0.1918 | 7205.4 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.44536 | acc=0.8116 | tpr=0.9839 | fpr=0.1916 | 7049.1 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.44459 | acc=0.8115 | tpr=0.9850 | fpr=0.1916 | 7043.6 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.44338 | acc=0.8120 | tpr=0.9853 | fpr=0.1912 | 13069.1 samples/s | 51.1 steps/s
Avg test loss: 0.44353, Avg test acc: 0.81202, Avg tpr: 0.98534, Avg fpr: 0.19113, total FA: 26538

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=13.3] | Loss=0.11565 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.407 | 4313.8 samples/s | 67.4 steps/s
[Step=13650 Epoch=13.3] | Loss=0.02633 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.411 | 3742.1 samples/s | 58.5 steps/s
[Step=13700 Epoch=13.4] | Loss=0.02192 | Reg=0.00079 | acc=0.9531 | FP-Norm=0.872 | FP-Norm(final)=2.417 | 3780.1 samples/s | 59.1 steps/s
[Step=13750 Epoch=13.4] | Loss=0.02107 | Reg=0.00087 | acc=0.9531 | FP-Norm=0.919 | FP-Norm(final)=2.423 | 3826.5 samples/s | 59.8 steps/s
[Step=13800 Epoch=13.5] | Loss=0.02144 | Reg=0.00094 | acc=0.9688 | FP-Norm=0.955 | FP-Norm(final)=2.424 | 3826.0 samples/s | 59.8 steps/s
[Step=13850 Epoch=13.5] | Loss=0.02153 | Reg=0.00098 | acc=0.9688 | FP-Norm=0.979 | FP-Norm(final)=2.425 | 3811.5 samples/s | 59.6 steps/s
[Step=13900 Epoch=13.6] | Loss=0.02099 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.997 | FP-Norm(final)=2.426 | 3846.9 samples/s | 60.1 steps/s
[Step=13950 Epoch=13.6] | Loss=0.02087 | Reg=0.00105 | acc=0.9531 | FP-Norm=1.016 | FP-Norm(final)=2.429 | 3848.0 samples/s | 60.1 steps/s
[Step=14000 Epoch=13.7] | Loss=0.02055 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.035 | FP-Norm(final)=2.431 | 3850.5 samples/s | 60.2 steps/s
[Step=14050 Epoch=13.7] | Loss=0.02087 | Reg=0.00113 | acc=0.9531 | FP-Norm=1.053 | FP-Norm(final)=2.432 | 3853.2 samples/s | 60.2 steps/s
[Step=14100 Epoch=13.8] | Loss=0.02090 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.072 | FP-Norm(final)=2.433 | 3926.9 samples/s | 61.4 steps/s
[Step=14150 Epoch=13.8] | Loss=0.02099 | Reg=0.00121 | acc=0.9531 | FP-Norm=1.088 | FP-Norm(final)=2.433 | 3934.0 samples/s | 61.5 steps/s
[Step=14200 Epoch=13.9] | Loss=0.02098 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.102 | FP-Norm(final)=2.433 | 3870.0 samples/s | 60.5 steps/s
[Step=14250 Epoch=13.9] | Loss=0.02096 | Reg=0.00127 | acc=0.9844 | FP-Norm=1.115 | FP-Norm(final)=2.432 | 3831.7 samples/s | 59.9 steps/s
[Step=14300 Epoch=14.0] | Loss=0.02099 | Reg=0.00129 | acc=0.9688 | FP-Norm=1.127 | FP-Norm(final)=2.432 | 3847.0 samples/s | 60.1 steps/s
[Step=14350 Epoch=14.0] | Loss=0.02094 | Reg=0.00132 | acc=0.9688 | FP-Norm=1.139 | FP-Norm(final)=2.432 | 3864.9 samples/s | 60.4 steps/s
[Step=14400 Epoch=14.1] | Loss=0.02101 | Reg=0.00134 | acc=0.9844 | FP-Norm=1.150 | FP-Norm(final)=2.432 | 3848.2 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step14400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=25.6] | Loss=0.10313 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.406 | 4100.2 samples/s | 64.1 steps/s
[Step=13650 Epoch=25.7] | Loss=0.01001 | Reg=0.00217 | acc=1.0000 | FP-Norm=1.401 | FP-Norm(final)=2.387 | 3473.9 samples/s | 54.3 steps/s
[Step=13700 Epoch=25.8] | Loss=0.00663 | Reg=0.00286 | acc=1.0000 | FP-Norm=1.643 | FP-Norm(final)=2.377 | 3614.8 samples/s | 56.5 steps/s
[Step=13750 Epoch=25.9] | Loss=0.00519 | Reg=0.00301 | acc=0.9844 | FP-Norm=1.702 | FP-Norm(final)=2.373 | 3621.2 samples/s | 56.6 steps/s
[Step=13800 Epoch=26.0] | Loss=0.00431 | Reg=0.00305 | acc=1.0000 | FP-Norm=1.721 | FP-Norm(final)=2.373 | 3625.2 samples/s | 56.6 steps/s
[Step=13850 Epoch=26.1] | Loss=0.00378 | Reg=0.00310 | acc=1.0000 | FP-Norm=1.741 | FP-Norm(final)=2.373 | 3674.3 samples/s | 57.4 steps/s
[Step=13900 Epoch=26.2] | Loss=0.00335 | Reg=0.00311 | acc=1.0000 | FP-Norm=1.745 | FP-Norm(final)=2.374 | 3624.2 samples/s | 56.6 steps/s
[Step=13950 Epoch=26.3] | Loss=0.00306 | Reg=0.00309 | acc=1.0000 | FP-Norm=1.744 | FP-Norm(final)=2.375 | 3642.4 samples/s | 56.9 steps/s
[Step=14000 Epoch=26.4] | Loss=0.00270 | Reg=0.00308 | acc=1.0000 | FP-Norm=1.741 | FP-Norm(final)=2.377 | 3659.9 samples/s | 57.2 steps/s
[Step=14050 Epoch=26.5] | Loss=0.00243 | Reg=0.00303 | acc=1.0000 | FP-Norm=1.730 | FP-Norm(final)=2.379 | 3638.0 samples/s | 56.8 steps/s
[Step=14100 Epoch=26.6] | Loss=0.00220 | Reg=0.00299 | acc=1.0000 | FP-Norm=1.717 | FP-Norm(final)=2.381 | 3666.6 samples/s | 57.3 steps/s
[Step=14150 Epoch=26.7] | Loss=0.00202 | Reg=0.00294 | acc=1.0000 | FP-Norm=1.702 | FP-Norm(final)=2.382 | 1883.1 samples/s | 29.4 steps/s
[Step=14200 Epoch=26.8] | Loss=0.00185 | Reg=0.00288 | acc=1.0000 | FP-Norm=1.685 | FP-Norm(final)=2.384 | 3682.0 samples/s | 57.5 steps/s
[Step=14250 Epoch=26.9] | Loss=0.00171 | Reg=0.00282 | acc=1.0000 | FP-Norm=1.667 | FP-Norm(final)=2.385 | 3622.5 samples/s | 56.6 steps/s
[Step=14300 Epoch=27.0] | Loss=0.00159 | Reg=0.00275 | acc=1.0000 | FP-Norm=1.647 | FP-Norm(final)=2.387 | 3641.5 samples/s | 56.9 steps/s
[Step=14350 Epoch=27.0] | Loss=0.00149 | Reg=0.00269 | acc=1.0000 | FP-Norm=1.628 | FP-Norm(final)=2.388 | 3632.1 samples/s | 56.8 steps/s
[Step=14400 Epoch=27.1] | Loss=0.00140 | Reg=0.00263 | acc=1.0000 | FP-Norm=1.608 | FP-Norm(final)=2.389 | 3630.0 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29036 | acc=0.8113 | tpr=0.7325 | fpr=0.0178 | 3914.6 samples/s | 15.3 steps/s
Avg test loss: 0.29649, Avg test acc: 0.80992, Avg tpr: 0.73171, Avg fpr: 0.01807, total FA: 141

Testing server on iccad2012
[Step=  50] | Loss=0.35901 | acc=0.8438 | tpr=0.9602 | fpr=0.1583 | 4043.5 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.35577 | acc=0.8482 | tpr=0.9744 | fpr=0.1542 | 6888.8 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.36064 | acc=0.8472 | tpr=0.9798 | fpr=0.1552 | 7115.7 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.35570 | acc=0.8492 | tpr=0.9836 | fpr=0.1533 | 7071.0 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.35474 | acc=0.8496 | tpr=0.9825 | fpr=0.1528 | 7444.3 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.35606 | acc=0.8495 | tpr=0.9818 | fpr=0.1529 | 6912.6 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.35589 | acc=0.8497 | tpr=0.9806 | fpr=0.1527 | 7209.8 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.35662 | acc=0.8493 | tpr=0.9792 | fpr=0.1531 | 7515.6 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.35833 | acc=0.8490 | tpr=0.9786 | fpr=0.1534 | 6735.9 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.35767 | acc=0.8491 | tpr=0.9793 | fpr=0.1533 | 7171.8 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.35644 | acc=0.8495 | tpr=0.9789 | fpr=0.1528 | 13286.4 samples/s | 51.9 steps/s
Avg test loss: 0.35658, Avg test acc: 0.84955, Avg tpr: 0.97900, Avg fpr: 0.15281, total FA: 21217

server round 18/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=14.1] | Loss=0.13911 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.417 | 4219.9 samples/s | 65.9 steps/s
[Step=14450 Epoch=14.1] | Loss=0.02973 | Reg=0.00101 | acc=0.9844 | FP-Norm=0.961 | FP-Norm(final)=2.418 | 3678.1 samples/s | 57.5 steps/s
[Step=14500 Epoch=14.2] | Loss=0.02449 | Reg=0.00109 | acc=0.9688 | FP-Norm=1.020 | FP-Norm(final)=2.423 | 3827.3 samples/s | 59.8 steps/s
[Step=14550 Epoch=14.2] | Loss=0.02290 | Reg=0.00113 | acc=0.9688 | FP-Norm=1.047 | FP-Norm(final)=2.426 | 3822.7 samples/s | 59.7 steps/s
[Step=14600 Epoch=14.3] | Loss=0.02202 | Reg=0.00118 | acc=0.9844 | FP-Norm=1.073 | FP-Norm(final)=2.429 | 3815.8 samples/s | 59.6 steps/s
[Step=14650 Epoch=14.3] | Loss=0.02195 | Reg=0.00121 | acc=0.9219 | FP-Norm=1.091 | FP-Norm(final)=2.431 | 3789.0 samples/s | 59.2 steps/s
[Step=14700 Epoch=14.4] | Loss=0.02089 | Reg=0.00125 | acc=0.9844 | FP-Norm=1.110 | FP-Norm(final)=2.433 | 3838.1 samples/s | 60.0 steps/s
[Step=14750 Epoch=14.4] | Loss=0.02056 | Reg=0.00128 | acc=0.9844 | FP-Norm=1.123 | FP-Norm(final)=2.435 | 3833.7 samples/s | 59.9 steps/s
[Step=14800 Epoch=14.4] | Loss=0.02032 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.133 | FP-Norm(final)=2.436 | 3956.7 samples/s | 61.8 steps/s
[Step=14850 Epoch=14.5] | Loss=0.02069 | Reg=0.00133 | acc=0.9844 | FP-Norm=1.145 | FP-Norm(final)=2.437 | 3937.6 samples/s | 61.5 steps/s
[Step=14900 Epoch=14.5] | Loss=0.02112 | Reg=0.00136 | acc=0.9688 | FP-Norm=1.158 | FP-Norm(final)=2.437 | 3953.8 samples/s | 61.8 steps/s
[Step=14950 Epoch=14.6] | Loss=0.02123 | Reg=0.00139 | acc=1.0000 | FP-Norm=1.172 | FP-Norm(final)=2.436 | 3938.5 samples/s | 61.5 steps/s
[Step=15000 Epoch=14.6] | Loss=0.02081 | Reg=0.00141 | acc=0.9844 | FP-Norm=1.183 | FP-Norm(final)=2.436 | 3935.0 samples/s | 61.5 steps/s
[Step=15050 Epoch=14.7] | Loss=0.02082 | Reg=0.00144 | acc=0.9844 | FP-Norm=1.192 | FP-Norm(final)=2.437 | 3867.2 samples/s | 60.4 steps/s
[Step=15100 Epoch=14.7] | Loss=0.02052 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.200 | FP-Norm(final)=2.437 | 3844.2 samples/s | 60.1 steps/s
[Step=15150 Epoch=14.8] | Loss=0.02054 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.207 | FP-Norm(final)=2.437 | 3831.8 samples/s | 59.9 steps/s
[Step=15200 Epoch=14.8] | Loss=0.02070 | Reg=0.00149 | acc=0.9531 | FP-Norm=1.216 | FP-Norm(final)=2.437 | 3838.6 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step15200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=27.1] | Loss=0.05792 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.416 | 4297.6 samples/s | 67.1 steps/s
[Step=14450 Epoch=27.2] | Loss=0.00226 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.420 | 3399.1 samples/s | 53.1 steps/s
[Step=14500 Epoch=27.3] | Loss=0.00121 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.837 | FP-Norm(final)=2.423 | 3615.9 samples/s | 56.5 steps/s
[Step=14550 Epoch=27.4] | Loss=0.00083 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.814 | FP-Norm(final)=2.425 | 3625.6 samples/s | 56.6 steps/s
[Step=14600 Epoch=27.5] | Loss=0.00078 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.803 | FP-Norm(final)=2.427 | 3618.7 samples/s | 56.5 steps/s
[Step=14650 Epoch=27.6] | Loss=0.00064 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.805 | FP-Norm(final)=2.430 | 3667.4 samples/s | 57.3 steps/s
[Step=14700 Epoch=27.7] | Loss=0.00057 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.799 | FP-Norm(final)=2.431 | 3652.5 samples/s | 57.1 steps/s
[Step=14750 Epoch=27.8] | Loss=0.00070 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.432 | 3660.0 samples/s | 57.2 steps/s
[Step=14800 Epoch=27.9] | Loss=0.00063 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.870 | FP-Norm(final)=2.433 | 3659.7 samples/s | 57.2 steps/s
[Step=14850 Epoch=28.0] | Loss=0.00056 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.896 | FP-Norm(final)=2.433 | 3638.0 samples/s | 56.8 steps/s
[Step=14900 Epoch=28.1] | Loss=0.00051 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.910 | FP-Norm(final)=2.434 | 3710.5 samples/s | 58.0 steps/s
[Step=14950 Epoch=28.2] | Loss=0.00047 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.917 | FP-Norm(final)=2.434 | 1889.0 samples/s | 29.5 steps/s
[Step=15000 Epoch=28.3] | Loss=0.00043 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.918 | FP-Norm(final)=2.434 | 3687.8 samples/s | 57.6 steps/s
[Step=15050 Epoch=28.4] | Loss=0.00040 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.917 | FP-Norm(final)=2.435 | 3649.5 samples/s | 57.0 steps/s
[Step=15100 Epoch=28.5] | Loss=0.00039 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.915 | FP-Norm(final)=2.435 | 3619.2 samples/s | 56.6 steps/s
[Step=15150 Epoch=28.6] | Loss=0.00037 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.914 | FP-Norm(final)=2.436 | 3637.2 samples/s | 56.8 steps/s
[Step=15200 Epoch=28.7] | Loss=0.00035 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.912 | FP-Norm(final)=2.436 | 3650.5 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17718 | acc=0.8812 | tpr=0.8363 | fpr=0.0213 | 3990.7 samples/s | 15.6 steps/s
Avg test loss: 0.18175, Avg test acc: 0.87988, Avg tpr: 0.83441, Avg fpr: 0.02013, total FA: 157

Testing server on iccad2012
[Step=  50] | Loss=0.52854 | acc=0.7803 | tpr=0.9646 | fpr=0.2230 | 3939.9 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.52167 | acc=0.7875 | tpr=0.9744 | fpr=0.2159 | 7322.8 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.52686 | acc=0.7859 | tpr=0.9813 | fpr=0.2177 | 7150.2 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.52007 | acc=0.7878 | tpr=0.9836 | fpr=0.2158 | 7029.0 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.51925 | acc=0.7870 | tpr=0.9834 | fpr=0.2166 | 7294.3 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.51945 | acc=0.7870 | tpr=0.9825 | fpr=0.2166 | 7435.2 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.51938 | acc=0.7872 | tpr=0.9818 | fpr=0.2164 | 7070.1 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.52027 | acc=0.7870 | tpr=0.9803 | fpr=0.2165 | 7244.5 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.52169 | acc=0.7871 | tpr=0.9791 | fpr=0.2164 | 6871.5 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.52066 | acc=0.7869 | tpr=0.9806 | fpr=0.2166 | 7318.2 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.51949 | acc=0.7871 | tpr=0.9801 | fpr=0.2165 | 12621.8 samples/s | 49.3 steps/s
Avg test loss: 0.51977, Avg test acc: 0.78703, Avg tpr: 0.98019, Avg fpr: 0.21648, total FA: 30058

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=14.8] | Loss=0.08047 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.439 | 4316.2 samples/s | 67.4 steps/s
[Step=15250 Epoch=14.9] | Loss=0.02456 | Reg=0.00044 | acc=0.9844 | FP-Norm=0.629 | FP-Norm(final)=2.443 | 3741.2 samples/s | 58.5 steps/s
[Step=15300 Epoch=14.9] | Loss=0.02184 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.727 | FP-Norm(final)=2.448 | 3890.0 samples/s | 60.8 steps/s
[Step=15350 Epoch=15.0] | Loss=0.01930 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.792 | FP-Norm(final)=2.451 | 3861.2 samples/s | 60.3 steps/s
[Step=15400 Epoch=15.0] | Loss=0.01892 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.836 | FP-Norm(final)=2.455 | 3799.9 samples/s | 59.4 steps/s
[Step=15450 Epoch=15.1] | Loss=0.01837 | Reg=0.00079 | acc=0.9688 | FP-Norm=0.872 | FP-Norm(final)=2.457 | 3827.9 samples/s | 59.8 steps/s
[Step=15500 Epoch=15.1] | Loss=0.01872 | Reg=0.00085 | acc=0.9688 | FP-Norm=0.904 | FP-Norm(final)=2.458 | 3831.2 samples/s | 59.9 steps/s
[Step=15550 Epoch=15.2] | Loss=0.01871 | Reg=0.00090 | acc=0.9844 | FP-Norm=0.933 | FP-Norm(final)=2.458 | 3853.4 samples/s | 60.2 steps/s
[Step=15600 Epoch=15.2] | Loss=0.01887 | Reg=0.00095 | acc=0.9688 | FP-Norm=0.958 | FP-Norm(final)=2.459 | 3900.1 samples/s | 60.9 steps/s
[Step=15650 Epoch=15.3] | Loss=0.01893 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.982 | FP-Norm(final)=2.460 | 3977.4 samples/s | 62.1 steps/s
[Step=15700 Epoch=15.3] | Loss=0.01909 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.006 | FP-Norm(final)=2.460 | 3913.5 samples/s | 61.1 steps/s
[Step=15750 Epoch=15.4] | Loss=0.01936 | Reg=0.00110 | acc=0.9844 | FP-Norm=1.030 | FP-Norm(final)=2.460 | 3865.6 samples/s | 60.4 steps/s
[Step=15800 Epoch=15.4] | Loss=0.01914 | Reg=0.00114 | acc=0.9844 | FP-Norm=1.049 | FP-Norm(final)=2.460 | 3860.8 samples/s | 60.3 steps/s
[Step=15850 Epoch=15.5] | Loss=0.01924 | Reg=0.00118 | acc=0.9844 | FP-Norm=1.068 | FP-Norm(final)=2.460 | 3834.2 samples/s | 59.9 steps/s
[Step=15900 Epoch=15.5] | Loss=0.01936 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.086 | FP-Norm(final)=2.460 | 3850.2 samples/s | 60.2 steps/s
[Step=15950 Epoch=15.6] | Loss=0.01948 | Reg=0.00125 | acc=0.9844 | FP-Norm=1.101 | FP-Norm(final)=2.460 | 3838.8 samples/s | 60.0 steps/s
[Step=16000 Epoch=15.6] | Loss=0.01949 | Reg=0.00129 | acc=1.0000 | FP-Norm=1.115 | FP-Norm(final)=2.460 | 3847.6 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step16000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=28.7] | Loss=0.15902 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.438 | 3964.8 samples/s | 61.9 steps/s
[Step=15250 Epoch=28.7] | Loss=0.01082 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.457 | FP-Norm(final)=2.408 | 3574.4 samples/s | 55.8 steps/s
[Step=15300 Epoch=28.8] | Loss=0.00637 | Reg=0.00258 | acc=1.0000 | FP-Norm=1.573 | FP-Norm(final)=2.403 | 3682.7 samples/s | 57.5 steps/s
[Step=15350 Epoch=28.9] | Loss=0.00468 | Reg=0.00257 | acc=1.0000 | FP-Norm=1.580 | FP-Norm(final)=2.404 | 3642.6 samples/s | 56.9 steps/s
[Step=15400 Epoch=29.0] | Loss=0.00384 | Reg=0.00253 | acc=1.0000 | FP-Norm=1.574 | FP-Norm(final)=2.405 | 3610.1 samples/s | 56.4 steps/s
[Step=15450 Epoch=29.1] | Loss=0.00313 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.558 | FP-Norm(final)=2.407 | 3654.3 samples/s | 57.1 steps/s
[Step=15500 Epoch=29.2] | Loss=0.00266 | Reg=0.00240 | acc=1.0000 | FP-Norm=1.536 | FP-Norm(final)=2.409 | 3641.2 samples/s | 56.9 steps/s
[Step=15550 Epoch=29.3] | Loss=0.00229 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.512 | FP-Norm(final)=2.411 | 3638.7 samples/s | 56.9 steps/s
[Step=15600 Epoch=29.4] | Loss=0.00201 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.487 | FP-Norm(final)=2.412 | 3671.9 samples/s | 57.4 steps/s
[Step=15650 Epoch=29.5] | Loss=0.00179 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.462 | FP-Norm(final)=2.414 | 3652.5 samples/s | 57.1 steps/s
[Step=15700 Epoch=29.6] | Loss=0.00161 | Reg=0.00210 | acc=1.0000 | FP-Norm=1.437 | FP-Norm(final)=2.415 | 3663.1 samples/s | 57.2 steps/s
[Step=15750 Epoch=29.7] | Loss=0.00147 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.412 | FP-Norm(final)=2.417 | 1881.0 samples/s | 29.4 steps/s
[Step=15800 Epoch=29.8] | Loss=0.00135 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.387 | FP-Norm(final)=2.418 | 3696.7 samples/s | 57.8 steps/s
[Step=15850 Epoch=29.9] | Loss=0.00124 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.364 | FP-Norm(final)=2.419 | 3631.4 samples/s | 56.7 steps/s
[Step=15900 Epoch=30.0] | Loss=0.00116 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.341 | FP-Norm(final)=2.420 | 3651.1 samples/s | 57.0 steps/s
[Step=15950 Epoch=30.1] | Loss=0.00108 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.318 | FP-Norm(final)=2.421 | 3622.5 samples/s | 56.6 steps/s
[Step=16000 Epoch=30.2] | Loss=0.00101 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.297 | FP-Norm(final)=2.422 | 3627.0 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17887 | acc=0.8772 | tpr=0.8306 | fpr=0.0216 | 3974.1 samples/s | 15.5 steps/s
Avg test loss: 0.18430, Avg test acc: 0.87427, Avg tpr: 0.82718, Avg fpr: 0.02218, total FA: 173

Testing server on iccad2012
[Step=  50] | Loss=0.50338 | acc=0.7864 | tpr=0.9646 | fpr=0.2168 | 4106.5 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.49520 | acc=0.7915 | tpr=0.9765 | fpr=0.2119 | 6713.0 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.50035 | acc=0.7905 | tpr=0.9827 | fpr=0.2131 | 7125.3 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.49424 | acc=0.7922 | tpr=0.9847 | fpr=0.2113 | 7304.2 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.49326 | acc=0.7918 | tpr=0.9852 | fpr=0.2117 | 7123.5 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.49447 | acc=0.7920 | tpr=0.9840 | fpr=0.2115 | 7236.2 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.49347 | acc=0.7925 | tpr=0.9831 | fpr=0.2110 | 7205.7 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.49498 | acc=0.7918 | tpr=0.9819 | fpr=0.2116 | 7122.7 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.49631 | acc=0.7923 | tpr=0.9805 | fpr=0.2111 | 7190.5 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.49530 | acc=0.7924 | tpr=0.9819 | fpr=0.2110 | 6903.7 samples/s | 27.0 steps/s
[Step= 550] | Loss=0.49384 | acc=0.7929 | tpr=0.9813 | fpr=0.2105 | 13890.1 samples/s | 54.3 steps/s
Avg test loss: 0.49415, Avg test acc: 0.79292, Avg tpr: 0.98138, Avg fpr: 0.21050, total FA: 29228

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=15.6] | Loss=0.05708 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.447 | 4381.7 samples/s | 68.5 steps/s
[Step=16050 Epoch=15.7] | Loss=0.02531 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.530 | FP-Norm(final)=2.451 | 3623.9 samples/s | 56.6 steps/s
[Step=16100 Epoch=15.7] | Loss=0.01917 | Reg=0.00037 | acc=0.9688 | FP-Norm=0.588 | FP-Norm(final)=2.456 | 3891.7 samples/s | 60.8 steps/s
[Step=16150 Epoch=15.8] | Loss=0.01696 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.608 | FP-Norm(final)=2.460 | 3911.9 samples/s | 61.1 steps/s
[Step=16200 Epoch=15.8] | Loss=0.01611 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.463 | 3907.5 samples/s | 61.1 steps/s
[Step=16250 Epoch=15.9] | Loss=0.01528 | Reg=0.00041 | acc=0.9844 | FP-Norm=0.633 | FP-Norm(final)=2.466 | 3923.9 samples/s | 61.3 steps/s
[Step=16300 Epoch=15.9] | Loss=0.01465 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.643 | FP-Norm(final)=2.469 | 3944.3 samples/s | 61.6 steps/s
[Step=16350 Epoch=16.0] | Loss=0.01525 | Reg=0.00043 | acc=0.9688 | FP-Norm=0.653 | FP-Norm(final)=2.471 | 3861.0 samples/s | 60.3 steps/s
[Step=16400 Epoch=16.0] | Loss=0.01491 | Reg=0.00045 | acc=0.9688 | FP-Norm=0.663 | FP-Norm(final)=2.473 | 3865.1 samples/s | 60.4 steps/s
[Step=16450 Epoch=16.1] | Loss=0.01516 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.672 | FP-Norm(final)=2.474 | 3846.5 samples/s | 60.1 steps/s
[Step=16500 Epoch=16.1] | Loss=0.01483 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.679 | FP-Norm(final)=2.475 | 3859.2 samples/s | 60.3 steps/s
[Step=16550 Epoch=16.2] | Loss=0.01482 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.477 | 3831.1 samples/s | 59.9 steps/s
[Step=16600 Epoch=16.2] | Loss=0.01453 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.692 | FP-Norm(final)=2.478 | 3851.7 samples/s | 60.2 steps/s
[Step=16650 Epoch=16.3] | Loss=0.01437 | Reg=0.00049 | acc=0.9688 | FP-Norm=0.697 | FP-Norm(final)=2.479 | 3856.1 samples/s | 60.3 steps/s
[Step=16700 Epoch=16.3] | Loss=0.01427 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.701 | FP-Norm(final)=2.480 | 3838.2 samples/s | 60.0 steps/s
[Step=16750 Epoch=16.4] | Loss=0.01421 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.706 | FP-Norm(final)=2.482 | 3844.2 samples/s | 60.1 steps/s
[Step=16800 Epoch=16.4] | Loss=0.01422 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.711 | FP-Norm(final)=2.482 | 3864.6 samples/s | 60.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step16800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=30.2] | Loss=0.12511 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.447 | 4203.4 samples/s | 65.7 steps/s
[Step=16050 Epoch=30.3] | Loss=0.01100 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.060 | FP-Norm(final)=2.436 | 3340.2 samples/s | 52.2 steps/s
[Step=16100 Epoch=30.3] | Loss=0.00563 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.119 | FP-Norm(final)=2.434 | 3683.8 samples/s | 57.6 steps/s
[Step=16150 Epoch=30.4] | Loss=0.00377 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.108 | FP-Norm(final)=2.434 | 3612.6 samples/s | 56.4 steps/s
[Step=16200 Epoch=30.5] | Loss=0.00285 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.088 | FP-Norm(final)=2.434 | 3643.2 samples/s | 56.9 steps/s
[Step=16250 Epoch=30.6] | Loss=0.00228 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.067 | FP-Norm(final)=2.435 | 3650.3 samples/s | 57.0 steps/s
[Step=16300 Epoch=30.7] | Loss=0.00191 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.047 | FP-Norm(final)=2.435 | 3635.7 samples/s | 56.8 steps/s
[Step=16350 Epoch=30.8] | Loss=0.00165 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.029 | FP-Norm(final)=2.436 | 3647.1 samples/s | 57.0 steps/s
[Step=16400 Epoch=30.9] | Loss=0.00145 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.011 | FP-Norm(final)=2.436 | 3522.6 samples/s | 55.0 steps/s
[Step=16450 Epoch=31.0] | Loss=0.00129 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.995 | FP-Norm(final)=2.436 | 3662.8 samples/s | 57.2 steps/s
[Step=16500 Epoch=31.1] | Loss=0.00117 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.980 | FP-Norm(final)=2.437 | 3659.7 samples/s | 57.2 steps/s
[Step=16550 Epoch=31.2] | Loss=0.00107 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.966 | FP-Norm(final)=2.437 | 1900.5 samples/s | 29.7 steps/s
[Step=16600 Epoch=31.3] | Loss=0.00098 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.953 | FP-Norm(final)=2.438 | 3639.7 samples/s | 56.9 steps/s
[Step=16650 Epoch=31.4] | Loss=0.00091 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.940 | FP-Norm(final)=2.438 | 3611.5 samples/s | 56.4 steps/s
[Step=16700 Epoch=31.5] | Loss=0.00084 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.927 | FP-Norm(final)=2.438 | 3641.3 samples/s | 56.9 steps/s
[Step=16750 Epoch=31.6] | Loss=0.00079 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.915 | FP-Norm(final)=2.439 | 3632.9 samples/s | 56.8 steps/s
[Step=16800 Epoch=31.7] | Loss=0.00074 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.904 | FP-Norm(final)=2.439 | 3650.8 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22071 | acc=0.8524 | tpr=0.7966 | fpr=0.0263 | 3923.0 samples/s | 15.3 steps/s
Avg test loss: 0.22581, Avg test acc: 0.84939, Avg tpr: 0.79326, Avg fpr: 0.02718, total FA: 212

Testing server on iccad2012
[Step=  50] | Loss=0.47670 | acc=0.8157 | tpr=0.9602 | fpr=0.1869 | 3998.0 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.47245 | acc=0.8216 | tpr=0.9744 | fpr=0.1813 | 7114.0 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.47850 | acc=0.8211 | tpr=0.9827 | fpr=0.1819 | 7318.3 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.47387 | acc=0.8229 | tpr=0.9858 | fpr=0.1801 | 7213.1 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.47316 | acc=0.8224 | tpr=0.9860 | fpr=0.1806 | 7187.4 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.47522 | acc=0.8224 | tpr=0.9862 | fpr=0.1806 | 7166.1 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.47448 | acc=0.8227 | tpr=0.9850 | fpr=0.1802 | 7518.7 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.47583 | acc=0.8222 | tpr=0.9836 | fpr=0.1807 | 7043.7 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.47751 | acc=0.8225 | tpr=0.9830 | fpr=0.1805 | 7070.8 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.47681 | acc=0.8226 | tpr=0.9837 | fpr=0.1803 | 7216.7 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.47535 | acc=0.8232 | tpr=0.9829 | fpr=0.1797 | 13353.3 samples/s | 52.2 steps/s
Avg test loss: 0.47560, Avg test acc: 0.82318, Avg tpr: 0.98296, Avg fpr: 0.17973, total FA: 24955

server round 21/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=16.4] | Loss=0.14936 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.468 | 4637.5 samples/s | 72.5 steps/s
[Step=16850 Epoch=16.5] | Loss=0.02729 | Reg=0.00043 | acc=0.9688 | FP-Norm=0.623 | FP-Norm(final)=2.468 | 3396.6 samples/s | 53.1 steps/s
[Step=16900 Epoch=16.5] | Loss=0.01966 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.667 | FP-Norm(final)=2.473 | 3798.2 samples/s | 59.3 steps/s
[Step=16950 Epoch=16.5] | Loss=0.01699 | Reg=0.00048 | acc=0.9844 | FP-Norm=0.680 | FP-Norm(final)=2.478 | 3815.5 samples/s | 59.6 steps/s
[Step=17000 Epoch=16.6] | Loss=0.01543 | Reg=0.00048 | acc=0.9844 | FP-Norm=0.688 | FP-Norm(final)=2.481 | 3837.2 samples/s | 60.0 steps/s
[Step=17050 Epoch=16.6] | Loss=0.01499 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.690 | FP-Norm(final)=2.484 | 3821.9 samples/s | 59.7 steps/s
[Step=17100 Epoch=16.7] | Loss=0.01468 | Reg=0.00049 | acc=0.9844 | FP-Norm=0.694 | FP-Norm(final)=2.486 | 3857.1 samples/s | 60.3 steps/s
[Step=17150 Epoch=16.7] | Loss=0.01435 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.699 | FP-Norm(final)=2.488 | 3850.0 samples/s | 60.2 steps/s
[Step=17200 Epoch=16.8] | Loss=0.01396 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.703 | FP-Norm(final)=2.490 | 3855.1 samples/s | 60.2 steps/s
[Step=17250 Epoch=16.8] | Loss=0.01416 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.707 | FP-Norm(final)=2.491 | 3863.5 samples/s | 60.4 steps/s
[Step=17300 Epoch=16.9] | Loss=0.01431 | Reg=0.00051 | acc=0.9844 | FP-Norm=0.711 | FP-Norm(final)=2.492 | 3846.1 samples/s | 60.1 steps/s
[Step=17350 Epoch=16.9] | Loss=0.01410 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.716 | FP-Norm(final)=2.494 | 3861.7 samples/s | 60.3 steps/s
[Step=17400 Epoch=17.0] | Loss=0.01390 | Reg=0.00053 | acc=0.9844 | FP-Norm=0.722 | FP-Norm(final)=2.495 | 3836.1 samples/s | 59.9 steps/s
[Step=17450 Epoch=17.0] | Loss=0.01418 | Reg=0.00053 | acc=0.9844 | FP-Norm=0.726 | FP-Norm(final)=2.496 | 3847.1 samples/s | 60.1 steps/s
[Step=17500 Epoch=17.1] | Loss=0.01397 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.730 | FP-Norm(final)=2.497 | 3835.3 samples/s | 59.9 steps/s
[Step=17550 Epoch=17.1] | Loss=0.01420 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.733 | FP-Norm(final)=2.498 | 3919.4 samples/s | 61.2 steps/s
[Step=17600 Epoch=17.2] | Loss=0.01425 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.737 | FP-Norm(final)=2.498 | 3939.1 samples/s | 61.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step17600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=31.7] | Loss=0.04932 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.468 | 4272.0 samples/s | 66.8 steps/s
[Step=16850 Epoch=31.8] | Loss=0.00353 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.750 | FP-Norm(final)=2.472 | 3263.2 samples/s | 51.0 steps/s
[Step=16900 Epoch=31.9] | Loss=0.00180 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.473 | 3623.0 samples/s | 56.6 steps/s
[Step=16950 Epoch=32.0] | Loss=0.00121 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.782 | FP-Norm(final)=2.473 | 3626.0 samples/s | 56.7 steps/s
[Step=17000 Epoch=32.0] | Loss=0.00091 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.474 | 3650.8 samples/s | 57.0 steps/s
[Step=17050 Epoch=32.1] | Loss=0.00074 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.748 | FP-Norm(final)=2.474 | 3635.8 samples/s | 56.8 steps/s
[Step=17100 Epoch=32.2] | Loss=0.00062 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.732 | FP-Norm(final)=2.474 | 3636.5 samples/s | 56.8 steps/s
[Step=17150 Epoch=32.3] | Loss=0.00054 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.717 | FP-Norm(final)=2.474 | 3640.1 samples/s | 56.9 steps/s
[Step=17200 Epoch=32.4] | Loss=0.00047 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.703 | FP-Norm(final)=2.474 | 3670.5 samples/s | 57.4 steps/s
[Step=17250 Epoch=32.5] | Loss=0.00042 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.691 | FP-Norm(final)=2.474 | 3645.4 samples/s | 57.0 steps/s
[Step=17300 Epoch=32.6] | Loss=0.00038 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.679 | FP-Norm(final)=2.475 | 3706.3 samples/s | 57.9 steps/s
[Step=17350 Epoch=32.7] | Loss=0.00035 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.667 | FP-Norm(final)=2.475 | 1899.2 samples/s | 29.7 steps/s
[Step=17400 Epoch=32.8] | Loss=0.00032 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.656 | FP-Norm(final)=2.475 | 3702.5 samples/s | 57.9 steps/s
[Step=17450 Epoch=32.9] | Loss=0.00030 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.646 | FP-Norm(final)=2.475 | 3609.5 samples/s | 56.4 steps/s
[Step=17500 Epoch=33.0] | Loss=0.00028 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.637 | FP-Norm(final)=2.475 | 3653.8 samples/s | 57.1 steps/s
[Step=17550 Epoch=33.1] | Loss=0.00026 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.628 | FP-Norm(final)=2.475 | 3660.0 samples/s | 57.2 steps/s
[Step=17600 Epoch=33.2] | Loss=0.00025 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.620 | FP-Norm(final)=2.475 | 3623.2 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18087 | acc=0.8826 | tpr=0.8358 | fpr=0.0159 | 3958.1 samples/s | 15.5 steps/s
Avg test loss: 0.18454, Avg test acc: 0.88040, Avg tpr: 0.83325, Avg fpr: 0.01590, total FA: 124

Testing server on iccad2012
[Step=  50] | Loss=0.55255 | acc=0.7845 | tpr=0.9690 | fpr=0.2189 | 3994.5 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.54400 | acc=0.7921 | tpr=0.9787 | fpr=0.2114 | 7085.5 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.55189 | acc=0.7895 | tpr=0.9841 | fpr=0.2141 | 7020.7 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.54569 | acc=0.7908 | tpr=0.9858 | fpr=0.2127 | 7296.0 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.54429 | acc=0.7909 | tpr=0.9860 | fpr=0.2126 | 7318.1 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.54561 | acc=0.7908 | tpr=0.9869 | fpr=0.2128 | 7250.0 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.54507 | acc=0.7909 | tpr=0.9856 | fpr=0.2126 | 7244.4 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.54645 | acc=0.7905 | tpr=0.9847 | fpr=0.2130 | 7061.2 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.54829 | acc=0.7906 | tpr=0.9839 | fpr=0.2129 | 7431.9 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.54722 | acc=0.7905 | tpr=0.9850 | fpr=0.2130 | 6909.2 samples/s | 27.0 steps/s
[Step= 550] | Loss=0.54571 | acc=0.7908 | tpr=0.9845 | fpr=0.2127 | 13217.3 samples/s | 51.6 steps/s
Avg test loss: 0.54612, Avg test acc: 0.79077, Avg tpr: 0.98455, Avg fpr: 0.21275, total FA: 29540

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=17.2] | Loss=0.08837 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.489 | 4204.5 samples/s | 65.7 steps/s
[Step=17650 Epoch=17.2] | Loss=0.01996 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.481 | FP-Norm(final)=2.494 | 3684.4 samples/s | 57.6 steps/s
[Step=17700 Epoch=17.3] | Loss=0.01515 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.499 | 3918.9 samples/s | 61.2 steps/s
[Step=17750 Epoch=17.3] | Loss=0.01466 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.502 | 3902.7 samples/s | 61.0 steps/s
[Step=17800 Epoch=17.4] | Loss=0.01396 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.504 | 3920.9 samples/s | 61.3 steps/s
[Step=17850 Epoch=17.4] | Loss=0.01368 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.506 | 3900.0 samples/s | 60.9 steps/s
[Step=17900 Epoch=17.5] | Loss=0.01350 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=2.508 | 3905.5 samples/s | 61.0 steps/s
[Step=17950 Epoch=17.5] | Loss=0.01300 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.593 | FP-Norm(final)=2.509 | 3854.3 samples/s | 60.2 steps/s
[Step=18000 Epoch=17.6] | Loss=0.01285 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.599 | FP-Norm(final)=2.511 | 3859.1 samples/s | 60.3 steps/s
[Step=18050 Epoch=17.6] | Loss=0.01255 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=2.513 | 3846.9 samples/s | 60.1 steps/s
[Step=18100 Epoch=17.7] | Loss=0.01264 | Reg=0.00038 | acc=0.9688 | FP-Norm=0.612 | FP-Norm(final)=2.515 | 3861.1 samples/s | 60.3 steps/s
[Step=18150 Epoch=17.7] | Loss=0.01292 | Reg=0.00039 | acc=0.9844 | FP-Norm=0.619 | FP-Norm(final)=2.516 | 3840.6 samples/s | 60.0 steps/s
[Step=18200 Epoch=17.8] | Loss=0.01271 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.627 | FP-Norm(final)=2.517 | 3842.2 samples/s | 60.0 steps/s
[Step=18250 Epoch=17.8] | Loss=0.01264 | Reg=0.00041 | acc=0.9844 | FP-Norm=0.634 | FP-Norm(final)=2.518 | 3843.0 samples/s | 60.0 steps/s
[Step=18300 Epoch=17.9] | Loss=0.01281 | Reg=0.00042 | acc=0.9844 | FP-Norm=0.641 | FP-Norm(final)=2.519 | 3843.9 samples/s | 60.1 steps/s
[Step=18350 Epoch=17.9] | Loss=0.01304 | Reg=0.00043 | acc=0.9688 | FP-Norm=0.649 | FP-Norm(final)=2.520 | 3869.0 samples/s | 60.5 steps/s
[Step=18400 Epoch=18.0] | Loss=0.01323 | Reg=0.00044 | acc=0.9531 | FP-Norm=0.655 | FP-Norm(final)=2.521 | 3826.4 samples/s | 59.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step18400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=33.2] | Loss=0.16125 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.488 | 4384.7 samples/s | 68.5 steps/s
[Step=17650 Epoch=33.3] | Loss=0.00813 | Reg=0.00104 | acc=1.0000 | FP-Norm=0.975 | FP-Norm(final)=2.481 | 3289.0 samples/s | 51.4 steps/s
[Step=17700 Epoch=33.4] | Loss=0.00418 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.038 | FP-Norm(final)=2.481 | 3705.3 samples/s | 57.9 steps/s
[Step=17750 Epoch=33.5] | Loss=0.00282 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.031 | FP-Norm(final)=2.482 | 3722.7 samples/s | 58.2 steps/s
[Step=17800 Epoch=33.6] | Loss=0.00212 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.013 | FP-Norm(final)=2.482 | 3723.5 samples/s | 58.2 steps/s
[Step=17850 Epoch=33.6] | Loss=0.00170 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.993 | FP-Norm(final)=2.483 | 3659.1 samples/s | 57.2 steps/s
[Step=17900 Epoch=33.7] | Loss=0.00142 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.973 | FP-Norm(final)=2.483 | 3636.3 samples/s | 56.8 steps/s
[Step=17950 Epoch=33.8] | Loss=0.00122 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.954 | FP-Norm(final)=2.483 | 3683.9 samples/s | 57.6 steps/s
[Step=18000 Epoch=33.9] | Loss=0.00107 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.936 | FP-Norm(final)=2.483 | 3632.5 samples/s | 56.8 steps/s
[Step=18050 Epoch=34.0] | Loss=0.00096 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.920 | FP-Norm(final)=2.484 | 3646.5 samples/s | 57.0 steps/s
[Step=18100 Epoch=34.1] | Loss=0.00087 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.905 | FP-Norm(final)=2.484 | 3697.9 samples/s | 57.8 steps/s
[Step=18150 Epoch=34.2] | Loss=0.00079 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.891 | FP-Norm(final)=2.484 | 1903.0 samples/s | 29.7 steps/s
[Step=18200 Epoch=34.3] | Loss=0.00072 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.485 | 3726.0 samples/s | 58.2 steps/s
[Step=18250 Epoch=34.4] | Loss=0.00067 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.863 | FP-Norm(final)=2.485 | 3651.7 samples/s | 57.1 steps/s
[Step=18300 Epoch=34.5] | Loss=0.00062 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.851 | FP-Norm(final)=2.485 | 3638.1 samples/s | 56.8 steps/s
[Step=18350 Epoch=34.6] | Loss=0.00058 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.838 | FP-Norm(final)=2.485 | 3639.9 samples/s | 56.9 steps/s
[Step=18400 Epoch=34.7] | Loss=0.00055 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.827 | FP-Norm(final)=2.485 | 3638.3 samples/s | 56.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21678 | acc=0.8592 | tpr=0.8023 | fpr=0.0171 | 4019.7 samples/s | 15.7 steps/s
Avg test loss: 0.21943, Avg test acc: 0.85956, Avg tpr: 0.80340, Avg fpr: 0.01692, total FA: 132

Testing server on iccad2012
[Step=  50] | Loss=0.47634 | acc=0.8274 | tpr=0.9646 | fpr=0.1750 | 3963.7 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.47375 | acc=0.8321 | tpr=0.9765 | fpr=0.1706 | 7112.1 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.47923 | acc=0.8314 | tpr=0.9827 | fpr=0.1714 | 7116.0 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.47474 | acc=0.8327 | tpr=0.9858 | fpr=0.1701 | 7191.3 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.47382 | acc=0.8323 | tpr=0.9860 | fpr=0.1705 | 7211.8 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.47569 | acc=0.8321 | tpr=0.9862 | fpr=0.1707 | 7378.3 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.47532 | acc=0.8323 | tpr=0.9850 | fpr=0.1705 | 7134.6 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.47664 | acc=0.8319 | tpr=0.9847 | fpr=0.1709 | 7071.8 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.47852 | acc=0.8319 | tpr=0.9834 | fpr=0.1708 | 7331.9 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.47755 | acc=0.8318 | tpr=0.9846 | fpr=0.1709 | 6977.3 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.47599 | acc=0.8322 | tpr=0.9841 | fpr=0.1705 | 13124.2 samples/s | 51.3 steps/s
Avg test loss: 0.47618, Avg test acc: 0.83225, Avg tpr: 0.98415, Avg fpr: 0.17051, total FA: 23675

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=18.0] | Loss=0.09674 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.508 | 4046.7 samples/s | 63.2 steps/s
[Step=18450 Epoch=18.0] | Loss=0.02290 | Reg=0.00038 | acc=0.9844 | FP-Norm=0.586 | FP-Norm(final)=2.508 | 3833.7 samples/s | 59.9 steps/s
[Step=18500 Epoch=18.1] | Loss=0.01801 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.637 | FP-Norm(final)=2.512 | 3916.0 samples/s | 61.2 steps/s
[Step=18550 Epoch=18.1] | Loss=0.01604 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.652 | FP-Norm(final)=2.516 | 3912.3 samples/s | 61.1 steps/s
[Step=18600 Epoch=18.2] | Loss=0.01489 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.658 | FP-Norm(final)=2.518 | 3914.2 samples/s | 61.2 steps/s
[Step=18650 Epoch=18.2] | Loss=0.01399 | Reg=0.00045 | acc=0.9688 | FP-Norm=0.666 | FP-Norm(final)=2.521 | 3911.8 samples/s | 61.1 steps/s
[Step=18700 Epoch=18.3] | Loss=0.01387 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.672 | FP-Norm(final)=2.523 | 3940.0 samples/s | 61.6 steps/s
[Step=18750 Epoch=18.3] | Loss=0.01369 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.679 | FP-Norm(final)=2.526 | 3898.1 samples/s | 60.9 steps/s
[Step=18800 Epoch=18.4] | Loss=0.01363 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.684 | FP-Norm(final)=2.528 | 3959.4 samples/s | 61.9 steps/s
[Step=18850 Epoch=18.4] | Loss=0.01317 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.688 | FP-Norm(final)=2.529 | 3884.9 samples/s | 60.7 steps/s
[Step=18900 Epoch=18.5] | Loss=0.01345 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.691 | FP-Norm(final)=2.531 | 3860.2 samples/s | 60.3 steps/s
[Step=18950 Epoch=18.5] | Loss=0.01361 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.696 | FP-Norm(final)=2.532 | 3804.1 samples/s | 59.4 steps/s
[Step=19000 Epoch=18.6] | Loss=0.01357 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.700 | FP-Norm(final)=2.533 | 3848.4 samples/s | 60.1 steps/s
[Step=19050 Epoch=18.6] | Loss=0.01337 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.704 | FP-Norm(final)=2.534 | 3849.4 samples/s | 60.1 steps/s
[Step=19100 Epoch=18.6] | Loss=0.01336 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.708 | FP-Norm(final)=2.534 | 3830.2 samples/s | 59.8 steps/s
[Step=19150 Epoch=18.7] | Loss=0.01319 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.711 | FP-Norm(final)=2.535 | 3839.6 samples/s | 60.0 steps/s
[Step=19200 Epoch=18.7] | Loss=0.01335 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.715 | FP-Norm(final)=2.536 | 3835.5 samples/s | 59.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step19200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=34.7] | Loss=0.05251 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.508 | 4204.5 samples/s | 65.7 steps/s
[Step=18450 Epoch=34.8] | Loss=0.00919 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.930 | FP-Norm(final)=2.499 | 3332.2 samples/s | 52.1 steps/s
[Step=18500 Epoch=34.9] | Loss=0.00485 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.012 | FP-Norm(final)=2.497 | 3632.6 samples/s | 56.8 steps/s
[Step=18550 Epoch=35.0] | Loss=0.00331 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.014 | FP-Norm(final)=2.498 | 3636.0 samples/s | 56.8 steps/s
[Step=18600 Epoch=35.1] | Loss=0.00249 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.007 | FP-Norm(final)=2.498 | 3630.0 samples/s | 56.7 steps/s
[Step=18650 Epoch=35.2] | Loss=0.00199 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.994 | FP-Norm(final)=2.498 | 3698.1 samples/s | 57.8 steps/s
[Step=18700 Epoch=35.2] | Loss=0.00167 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.980 | FP-Norm(final)=2.499 | 3657.4 samples/s | 57.1 steps/s
[Step=18750 Epoch=35.3] | Loss=0.00143 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.965 | FP-Norm(final)=2.499 | 3634.5 samples/s | 56.8 steps/s
[Step=18800 Epoch=35.4] | Loss=0.00126 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.951 | FP-Norm(final)=2.500 | 3638.9 samples/s | 56.9 steps/s
[Step=18850 Epoch=35.5] | Loss=0.00112 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.938 | FP-Norm(final)=2.500 | 3653.7 samples/s | 57.1 steps/s
[Step=18900 Epoch=35.6] | Loss=0.00101 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.925 | FP-Norm(final)=2.500 | 3691.5 samples/s | 57.7 steps/s
[Step=18950 Epoch=35.7] | Loss=0.00092 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.912 | FP-Norm(final)=2.501 | 1936.5 samples/s | 30.3 steps/s
[Step=19000 Epoch=35.8] | Loss=0.00084 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.900 | FP-Norm(final)=2.501 | 3641.4 samples/s | 56.9 steps/s
[Step=19050 Epoch=35.9] | Loss=0.00078 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.888 | FP-Norm(final)=2.501 | 3617.8 samples/s | 56.5 steps/s
[Step=19100 Epoch=36.0] | Loss=0.00073 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.501 | 3622.7 samples/s | 56.6 steps/s
[Step=19150 Epoch=36.1] | Loss=0.00068 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.866 | FP-Norm(final)=2.502 | 3633.3 samples/s | 56.8 steps/s
[Step=19200 Epoch=36.2] | Loss=0.00064 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.856 | FP-Norm(final)=2.502 | 3582.1 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19101 | acc=0.8755 | tpr=0.8264 | fpr=0.0178 | 3966.0 samples/s | 15.5 steps/s
Avg test loss: 0.19589, Avg test acc: 0.87391, Avg tpr: 0.82427, Avg fpr: 0.01692, total FA: 132

Testing server on iccad2012
[Step=  50] | Loss=0.50609 | acc=0.8048 | tpr=0.9602 | fpr=0.1980 | 4001.6 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.50096 | acc=0.8114 | tpr=0.9744 | fpr=0.1916 | 7290.1 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.50598 | acc=0.8107 | tpr=0.9798 | fpr=0.1925 | 7047.9 samples/s | 27.5 steps/s
[Step= 200] | Loss=0.50038 | acc=0.8115 | tpr=0.9825 | fpr=0.1916 | 7241.4 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.49908 | acc=0.8114 | tpr=0.9834 | fpr=0.1917 | 7276.9 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.50067 | acc=0.8115 | tpr=0.9840 | fpr=0.1916 | 7242.1 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.50035 | acc=0.8116 | tpr=0.9831 | fpr=0.1915 | 7481.4 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.50198 | acc=0.8112 | tpr=0.9825 | fpr=0.1920 | 6961.9 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.50348 | acc=0.8112 | tpr=0.9810 | fpr=0.1919 | 7281.3 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.50258 | acc=0.8110 | tpr=0.9824 | fpr=0.1921 | 7134.8 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.50119 | acc=0.8115 | tpr=0.9821 | fpr=0.1916 | 12490.1 samples/s | 48.8 steps/s
Avg test loss: 0.50151, Avg test acc: 0.81143, Avg tpr: 0.98217, Avg fpr: 0.19168, total FA: 26614

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=18.7] | Loss=0.24402 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.525 | 4263.8 samples/s | 66.6 steps/s
[Step=19250 Epoch=18.8] | Loss=0.02616 | Reg=0.00034 | acc=0.9844 | FP-Norm=0.553 | FP-Norm(final)=2.525 | 3597.2 samples/s | 56.2 steps/s
[Step=19300 Epoch=18.8] | Loss=0.01900 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.597 | FP-Norm(final)=2.528 | 3804.7 samples/s | 59.4 steps/s
[Step=19350 Epoch=18.9] | Loss=0.01643 | Reg=0.00039 | acc=0.9844 | FP-Norm=0.611 | FP-Norm(final)=2.532 | 3913.3 samples/s | 61.1 steps/s
[Step=19400 Epoch=18.9] | Loss=0.01491 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.619 | FP-Norm(final)=2.536 | 3911.6 samples/s | 61.1 steps/s
[Step=19450 Epoch=19.0] | Loss=0.01421 | Reg=0.00040 | acc=0.9688 | FP-Norm=0.626 | FP-Norm(final)=2.539 | 3963.2 samples/s | 61.9 steps/s
[Step=19500 Epoch=19.0] | Loss=0.01378 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.635 | FP-Norm(final)=2.542 | 3909.0 samples/s | 61.1 steps/s
[Step=19550 Epoch=19.1] | Loss=0.01384 | Reg=0.00042 | acc=0.9844 | FP-Norm=0.643 | FP-Norm(final)=2.544 | 3934.1 samples/s | 61.5 steps/s
[Step=19600 Epoch=19.1] | Loss=0.01396 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.650 | FP-Norm(final)=2.546 | 3938.7 samples/s | 61.5 steps/s
[Step=19650 Epoch=19.2] | Loss=0.01383 | Reg=0.00044 | acc=0.9844 | FP-Norm=0.656 | FP-Norm(final)=2.547 | 3881.4 samples/s | 60.6 steps/s
[Step=19700 Epoch=19.2] | Loss=0.01365 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.662 | FP-Norm(final)=2.548 | 3854.4 samples/s | 60.2 steps/s
[Step=19750 Epoch=19.3] | Loss=0.01356 | Reg=0.00045 | acc=0.9844 | FP-Norm=0.667 | FP-Norm(final)=2.549 | 3839.0 samples/s | 60.0 steps/s
[Step=19800 Epoch=19.3] | Loss=0.01337 | Reg=0.00046 | acc=0.9844 | FP-Norm=0.672 | FP-Norm(final)=2.550 | 3860.4 samples/s | 60.3 steps/s
[Step=19850 Epoch=19.4] | Loss=0.01315 | Reg=0.00046 | acc=0.9688 | FP-Norm=0.676 | FP-Norm(final)=2.551 | 3872.6 samples/s | 60.5 steps/s
[Step=19900 Epoch=19.4] | Loss=0.01305 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.680 | FP-Norm(final)=2.552 | 3873.9 samples/s | 60.5 steps/s
[Step=19950 Epoch=19.5] | Loss=0.01313 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.684 | FP-Norm(final)=2.553 | 3809.2 samples/s | 59.5 steps/s
[Step=20000 Epoch=19.5] | Loss=0.01318 | Reg=0.00048 | acc=0.9844 | FP-Norm=0.689 | FP-Norm(final)=2.554 | 3838.5 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step20000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=36.2] | Loss=0.10927 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.525 | 3907.6 samples/s | 61.1 steps/s
[Step=19250 Epoch=36.3] | Loss=0.00759 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.915 | FP-Norm(final)=2.522 | 3682.5 samples/s | 57.5 steps/s
[Step=19300 Epoch=36.4] | Loss=0.00401 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.987 | FP-Norm(final)=2.522 | 3735.5 samples/s | 58.4 steps/s
[Step=19350 Epoch=36.5] | Loss=0.00271 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.984 | FP-Norm(final)=2.522 | 3668.2 samples/s | 57.3 steps/s
[Step=19400 Epoch=36.6] | Loss=0.00204 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.968 | FP-Norm(final)=2.523 | 3632.2 samples/s | 56.8 steps/s
[Step=19450 Epoch=36.7] | Loss=0.00164 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.951 | FP-Norm(final)=2.523 | 3630.5 samples/s | 56.7 steps/s
[Step=19500 Epoch=36.8] | Loss=0.00137 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.933 | FP-Norm(final)=2.524 | 3648.1 samples/s | 57.0 steps/s
[Step=19550 Epoch=36.9] | Loss=0.00118 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.917 | FP-Norm(final)=2.524 | 3667.2 samples/s | 57.3 steps/s
[Step=19600 Epoch=36.9] | Loss=0.00103 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.901 | FP-Norm(final)=2.524 | 3509.7 samples/s | 54.8 steps/s
[Step=19650 Epoch=37.0] | Loss=0.00092 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.886 | FP-Norm(final)=2.525 | 3635.0 samples/s | 56.8 steps/s
[Step=19700 Epoch=37.1] | Loss=0.00083 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.872 | FP-Norm(final)=2.525 | 3678.4 samples/s | 57.5 steps/s
[Step=19750 Epoch=37.2] | Loss=0.00076 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.859 | FP-Norm(final)=2.525 | 1937.6 samples/s | 30.3 steps/s
[Step=19800 Epoch=37.3] | Loss=0.00070 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.847 | FP-Norm(final)=2.525 | 3694.3 samples/s | 57.7 steps/s
[Step=19850 Epoch=37.4] | Loss=0.00064 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.835 | FP-Norm(final)=2.526 | 3598.5 samples/s | 56.2 steps/s
[Step=19900 Epoch=37.5] | Loss=0.00060 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.823 | FP-Norm(final)=2.526 | 3669.2 samples/s | 57.3 steps/s
[Step=19950 Epoch=37.6] | Loss=0.00056 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.526 | 3641.4 samples/s | 56.9 steps/s
[Step=20000 Epoch=37.7] | Loss=0.00053 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.802 | FP-Norm(final)=2.526 | 3614.1 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19193 | acc=0.8723 | tpr=0.8223 | fpr=0.0191 | 3954.2 samples/s | 15.4 steps/s
Avg test loss: 0.19803, Avg test acc: 0.87122, Avg tpr: 0.82101, Avg fpr: 0.01833, total FA: 143

Testing server on iccad2012
[Step=  50] | Loss=0.48601 | acc=0.8150 | tpr=0.9690 | fpr=0.1878 | 3954.7 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.48228 | acc=0.8211 | tpr=0.9808 | fpr=0.1819 | 7233.7 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.48731 | acc=0.8203 | tpr=0.9856 | fpr=0.1828 | 7414.2 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.48125 | acc=0.8215 | tpr=0.9869 | fpr=0.1815 | 6951.9 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.47997 | acc=0.8217 | tpr=0.9869 | fpr=0.1813 | 7363.7 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.48187 | acc=0.8214 | tpr=0.9869 | fpr=0.1816 | 7103.9 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.48148 | acc=0.8214 | tpr=0.9856 | fpr=0.1816 | 7132.0 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.48283 | acc=0.8211 | tpr=0.9847 | fpr=0.1819 | 7292.4 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.48445 | acc=0.8212 | tpr=0.9834 | fpr=0.1817 | 7450.6 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.48385 | acc=0.8210 | tpr=0.9846 | fpr=0.1819 | 6816.8 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.48231 | acc=0.8216 | tpr=0.9841 | fpr=0.1814 | 12945.0 samples/s | 50.6 steps/s
Avg test loss: 0.48262, Avg test acc: 0.82160, Avg tpr: 0.98415, Avg fpr: 0.18136, total FA: 25181

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=19.5] | Loss=0.17434 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.547 | 4081.2 samples/s | 63.8 steps/s
[Step=20050 Epoch=19.6] | Loss=0.02193 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.549 | 3710.3 samples/s | 58.0 steps/s
[Step=20100 Epoch=19.6] | Loss=0.01706 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.602 | FP-Norm(final)=2.553 | 3827.8 samples/s | 59.8 steps/s
[Step=20150 Epoch=19.7] | Loss=0.01539 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.618 | FP-Norm(final)=2.556 | 3832.5 samples/s | 59.9 steps/s
[Step=20200 Epoch=19.7] | Loss=0.01397 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.625 | FP-Norm(final)=2.558 | 3842.0 samples/s | 60.0 steps/s
[Step=20250 Epoch=19.8] | Loss=0.01336 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.632 | FP-Norm(final)=2.561 | 3837.9 samples/s | 60.0 steps/s
[Step=20300 Epoch=19.8] | Loss=0.01290 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.639 | FP-Norm(final)=2.563 | 3845.6 samples/s | 60.1 steps/s
[Step=20350 Epoch=19.9] | Loss=0.01293 | Reg=0.00042 | acc=0.9688 | FP-Norm=0.643 | FP-Norm(final)=2.564 | 3850.6 samples/s | 60.2 steps/s
[Step=20400 Epoch=19.9] | Loss=0.01328 | Reg=0.00043 | acc=0.9844 | FP-Norm=0.649 | FP-Norm(final)=2.565 | 3843.0 samples/s | 60.0 steps/s
[Step=20450 Epoch=20.0] | Loss=0.01297 | Reg=0.00043 | acc=0.9688 | FP-Norm=0.655 | FP-Norm(final)=2.566 | 3860.2 samples/s | 60.3 steps/s
[Step=20500 Epoch=20.0] | Loss=0.01311 | Reg=0.00044 | acc=0.9844 | FP-Norm=0.659 | FP-Norm(final)=2.566 | 3847.6 samples/s | 60.1 steps/s
[Step=20550 Epoch=20.1] | Loss=0.01322 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.663 | FP-Norm(final)=2.566 | 3862.5 samples/s | 60.4 steps/s
[Step=20600 Epoch=20.1] | Loss=0.01318 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.667 | FP-Norm(final)=2.567 | 3828.1 samples/s | 59.8 steps/s
[Step=20650 Epoch=20.2] | Loss=0.01316 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.672 | FP-Norm(final)=2.567 | 3825.8 samples/s | 59.8 steps/s
[Step=20700 Epoch=20.2] | Loss=0.01302 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.676 | FP-Norm(final)=2.568 | 3848.8 samples/s | 60.1 steps/s
[Step=20750 Epoch=20.3] | Loss=0.01298 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.681 | FP-Norm(final)=2.568 | 3847.6 samples/s | 60.1 steps/s
[Step=20800 Epoch=20.3] | Loss=0.01315 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.569 | 3864.9 samples/s | 60.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step20800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=37.7] | Loss=0.07767 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.546 | 4771.6 samples/s | 74.6 steps/s
[Step=20050 Epoch=37.8] | Loss=0.00857 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.872 | FP-Norm(final)=2.544 | 3207.9 samples/s | 50.1 steps/s
[Step=20100 Epoch=37.9] | Loss=0.00446 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.958 | FP-Norm(final)=2.539 | 3604.2 samples/s | 56.3 steps/s
[Step=20150 Epoch=38.0] | Loss=0.00301 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.957 | FP-Norm(final)=2.539 | 3615.0 samples/s | 56.5 steps/s
[Step=20200 Epoch=38.1] | Loss=0.00228 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.942 | FP-Norm(final)=2.539 | 3656.6 samples/s | 57.1 steps/s
[Step=20250 Epoch=38.2] | Loss=0.00183 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.925 | FP-Norm(final)=2.539 | 3645.4 samples/s | 57.0 steps/s
[Step=20300 Epoch=38.3] | Loss=0.00154 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.908 | FP-Norm(final)=2.540 | 3672.9 samples/s | 57.4 steps/s
[Step=20350 Epoch=38.4] | Loss=0.00133 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.892 | FP-Norm(final)=2.540 | 3729.1 samples/s | 58.3 steps/s
[Step=20400 Epoch=38.5] | Loss=0.00116 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.541 | 3673.0 samples/s | 57.4 steps/s
[Step=20450 Epoch=38.5] | Loss=0.00104 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.862 | FP-Norm(final)=2.541 | 3635.9 samples/s | 56.8 steps/s
[Step=20500 Epoch=38.6] | Loss=0.00093 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.848 | FP-Norm(final)=2.542 | 3698.2 samples/s | 57.8 steps/s
[Step=20550 Epoch=38.7] | Loss=0.00085 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.835 | FP-Norm(final)=2.542 | 1944.3 samples/s | 30.4 steps/s
[Step=20600 Epoch=38.8] | Loss=0.00078 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.823 | FP-Norm(final)=2.542 | 3708.3 samples/s | 57.9 steps/s
[Step=20650 Epoch=38.9] | Loss=0.00073 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.811 | FP-Norm(final)=2.543 | 3648.8 samples/s | 57.0 steps/s
[Step=20700 Epoch=39.0] | Loss=0.00067 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.800 | FP-Norm(final)=2.543 | 3612.0 samples/s | 56.4 steps/s
[Step=20750 Epoch=39.1] | Loss=0.00063 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.790 | FP-Norm(final)=2.544 | 3667.5 samples/s | 57.3 steps/s
[Step=20800 Epoch=39.2] | Loss=0.00059 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.779 | FP-Norm(final)=2.544 | 3618.5 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17858 | acc=0.8818 | tpr=0.8353 | fpr=0.0173 | 3997.8 samples/s | 15.6 steps/s
Avg test loss: 0.18319, Avg test acc: 0.87956, Avg tpr: 0.83237, Avg fpr: 0.01666, total FA: 130

Testing server on iccad2012
[Step=  50] | Loss=0.48734 | acc=0.8153 | tpr=0.9690 | fpr=0.1875 | 3980.4 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.48651 | acc=0.8202 | tpr=0.9829 | fpr=0.1828 | 7336.6 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.49121 | acc=0.8201 | tpr=0.9870 | fpr=0.1830 | 7169.7 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.48543 | acc=0.8210 | tpr=0.9880 | fpr=0.1821 | 7741.7 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.48402 | acc=0.8214 | tpr=0.9878 | fpr=0.1816 | 6755.3 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.48606 | acc=0.8212 | tpr=0.9884 | fpr=0.1818 | 7140.9 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.48560 | acc=0.8213 | tpr=0.9869 | fpr=0.1817 | 7267.2 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.48748 | acc=0.8210 | tpr=0.9869 | fpr=0.1820 | 7342.4 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.48919 | acc=0.8211 | tpr=0.9859 | fpr=0.1819 | 6856.7 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.48862 | acc=0.8207 | tpr=0.9868 | fpr=0.1823 | 7268.7 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.48724 | acc=0.8213 | tpr=0.9861 | fpr=0.1817 | 13075.6 samples/s | 51.1 steps/s
Avg test loss: 0.48755, Avg test acc: 0.82134, Avg tpr: 0.98613, Avg fpr: 0.18165, total FA: 25222

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=20.3] | Loss=0.09473 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.562 | 4484.1 samples/s | 70.1 steps/s
[Step=20850 Epoch=20.4] | Loss=0.02252 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.566 | 3662.3 samples/s | 57.2 steps/s
[Step=20900 Epoch=20.4] | Loss=0.01733 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.618 | FP-Norm(final)=2.570 | 3822.3 samples/s | 59.7 steps/s
[Step=20950 Epoch=20.5] | Loss=0.01498 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.631 | FP-Norm(final)=2.573 | 3816.0 samples/s | 59.6 steps/s
[Step=21000 Epoch=20.5] | Loss=0.01448 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.643 | FP-Norm(final)=2.575 | 3810.2 samples/s | 59.5 steps/s
[Step=21050 Epoch=20.6] | Loss=0.01357 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.652 | FP-Norm(final)=2.577 | 3848.9 samples/s | 60.1 steps/s
[Step=21100 Epoch=20.6] | Loss=0.01388 | Reg=0.00044 | acc=0.9844 | FP-Norm=0.659 | FP-Norm(final)=2.579 | 3817.8 samples/s | 59.7 steps/s
[Step=21150 Epoch=20.6] | Loss=0.01364 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.667 | FP-Norm(final)=2.581 | 3843.1 samples/s | 60.0 steps/s
[Step=21200 Epoch=20.7] | Loss=0.01349 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.672 | FP-Norm(final)=2.581 | 3829.3 samples/s | 59.8 steps/s
[Step=21250 Epoch=20.7] | Loss=0.01327 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.676 | FP-Norm(final)=2.582 | 3854.0 samples/s | 60.2 steps/s
[Step=21300 Epoch=20.8] | Loss=0.01329 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.680 | FP-Norm(final)=2.583 | 3848.0 samples/s | 60.1 steps/s
[Step=21350 Epoch=20.8] | Loss=0.01301 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.683 | FP-Norm(final)=2.583 | 3842.4 samples/s | 60.0 steps/s
[Step=21400 Epoch=20.9] | Loss=0.01298 | Reg=0.00048 | acc=0.9844 | FP-Norm=0.688 | FP-Norm(final)=2.584 | 3833.2 samples/s | 59.9 steps/s
[Step=21450 Epoch=20.9] | Loss=0.01301 | Reg=0.00048 | acc=0.9844 | FP-Norm=0.692 | FP-Norm(final)=2.584 | 3865.9 samples/s | 60.4 steps/s
[Step=21500 Epoch=21.0] | Loss=0.01290 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.697 | FP-Norm(final)=2.584 | 3854.7 samples/s | 60.2 steps/s
[Step=21550 Epoch=21.0] | Loss=0.01286 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.700 | FP-Norm(final)=2.584 | 3851.4 samples/s | 60.2 steps/s
[Step=21600 Epoch=21.1] | Loss=0.01272 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.703 | FP-Norm(final)=2.585 | 3829.2 samples/s | 59.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step21600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=39.2] | Loss=0.10843 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.561 | 4074.0 samples/s | 63.7 steps/s
[Step=20850 Epoch=39.3] | Loss=0.00514 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.836 | FP-Norm(final)=2.559 | 3469.7 samples/s | 54.2 steps/s
[Step=20900 Epoch=39.4] | Loss=0.00265 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.901 | FP-Norm(final)=2.559 | 3688.5 samples/s | 57.6 steps/s
[Step=20950 Epoch=39.5] | Loss=0.00178 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.898 | FP-Norm(final)=2.560 | 3628.4 samples/s | 56.7 steps/s
[Step=21000 Epoch=39.6] | Loss=0.00136 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.885 | FP-Norm(final)=2.561 | 3662.6 samples/s | 57.2 steps/s
[Step=21050 Epoch=39.7] | Loss=0.00110 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.870 | FP-Norm(final)=2.561 | 3629.1 samples/s | 56.7 steps/s
[Step=21100 Epoch=39.8] | Loss=0.00092 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.856 | FP-Norm(final)=2.562 | 3652.8 samples/s | 57.1 steps/s
[Step=21150 Epoch=39.9] | Loss=0.00079 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.842 | FP-Norm(final)=2.562 | 3650.3 samples/s | 57.0 steps/s
[Step=21200 Epoch=40.0] | Loss=0.00069 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.828 | FP-Norm(final)=2.562 | 3661.2 samples/s | 57.2 steps/s
[Step=21250 Epoch=40.1] | Loss=0.00062 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.563 | 3620.9 samples/s | 56.6 steps/s
[Step=21300 Epoch=40.2] | Loss=0.00056 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.804 | FP-Norm(final)=2.563 | 3666.0 samples/s | 57.3 steps/s
[Step=21350 Epoch=40.2] | Loss=0.00051 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.792 | FP-Norm(final)=2.563 | 1885.8 samples/s | 29.5 steps/s
[Step=21400 Epoch=40.3] | Loss=0.00047 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.781 | FP-Norm(final)=2.564 | 3771.6 samples/s | 58.9 steps/s
[Step=21450 Epoch=40.4] | Loss=0.00044 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.770 | FP-Norm(final)=2.564 | 3697.6 samples/s | 57.8 steps/s
[Step=21500 Epoch=40.5] | Loss=0.00041 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.760 | FP-Norm(final)=2.564 | 3714.8 samples/s | 58.0 steps/s
[Step=21550 Epoch=40.6] | Loss=0.00038 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.750 | FP-Norm(final)=2.564 | 3716.5 samples/s | 58.1 steps/s
[Step=21600 Epoch=40.7] | Loss=0.00036 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.740 | FP-Norm(final)=2.564 | 3729.1 samples/s | 58.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.14322 | acc=0.9127 | tpr=0.8838 | fpr=0.0245 | 3898.3 samples/s | 15.2 steps/s
Avg test loss: 0.14676, Avg test acc: 0.90833, Avg tpr: 0.87824, Avg fpr: 0.02551, total FA: 199

Testing server on iccad2012
[Step=  50] | Loss=0.56417 | acc=0.8007 | tpr=0.9735 | fpr=0.2024 | 3933.8 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.56198 | acc=0.8073 | tpr=0.9872 | fpr=0.1961 | 7378.4 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.56751 | acc=0.8063 | tpr=0.9885 | fpr=0.1971 | 7203.4 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.56111 | acc=0.8079 | tpr=0.9902 | fpr=0.1954 | 7169.5 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.55934 | acc=0.8080 | tpr=0.9895 | fpr=0.1953 | 7140.3 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.56177 | acc=0.8074 | tpr=0.9891 | fpr=0.1960 | 7392.1 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.56164 | acc=0.8075 | tpr=0.9875 | fpr=0.1958 | 6979.5 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.56360 | acc=0.8068 | tpr=0.9874 | fpr=0.1965 | 7167.9 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.56568 | acc=0.8070 | tpr=0.9869 | fpr=0.1963 | 7063.2 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.56486 | acc=0.8066 | tpr=0.9877 | fpr=0.1967 | 7123.6 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.56310 | acc=0.8071 | tpr=0.9873 | fpr=0.1961 | 13561.7 samples/s | 53.0 steps/s
Avg test loss: 0.56330, Avg test acc: 0.80713, Avg tpr: 0.98732, Avg fpr: 0.19615, total FA: 27235

server round 27/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=21.1] | Loss=0.07092 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.579 | 4490.0 samples/s | 70.2 steps/s
[Step=21650 Epoch=21.1] | Loss=0.01865 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.580 | 3531.7 samples/s | 55.2 steps/s
[Step=21700 Epoch=21.2] | Loss=0.01455 | Reg=0.00036 | acc=0.9844 | FP-Norm=0.582 | FP-Norm(final)=2.582 | 3925.0 samples/s | 61.3 steps/s
[Step=21750 Epoch=21.2] | Loss=0.01315 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=2.586 | 3888.3 samples/s | 60.8 steps/s
[Step=21800 Epoch=21.3] | Loss=0.01257 | Reg=0.00037 | acc=0.9844 | FP-Norm=0.603 | FP-Norm(final)=2.587 | 3897.3 samples/s | 60.9 steps/s
[Step=21850 Epoch=21.3] | Loss=0.01234 | Reg=0.00038 | acc=0.9688 | FP-Norm=0.607 | FP-Norm(final)=2.589 | 3962.5 samples/s | 61.9 steps/s
[Step=21900 Epoch=21.4] | Loss=0.01158 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.612 | FP-Norm(final)=2.591 | 3951.9 samples/s | 61.7 steps/s
[Step=21950 Epoch=21.4] | Loss=0.01157 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.618 | FP-Norm(final)=2.592 | 3932.8 samples/s | 61.4 steps/s
[Step=22000 Epoch=21.5] | Loss=0.01147 | Reg=0.00039 | acc=0.9844 | FP-Norm=0.622 | FP-Norm(final)=2.594 | 3926.4 samples/s | 61.3 steps/s
[Step=22050 Epoch=21.5] | Loss=0.01172 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.628 | FP-Norm(final)=2.595 | 3895.8 samples/s | 60.9 steps/s
[Step=22100 Epoch=21.6] | Loss=0.01170 | Reg=0.00041 | acc=0.9688 | FP-Norm=0.635 | FP-Norm(final)=2.596 | 3861.9 samples/s | 60.3 steps/s
[Step=22150 Epoch=21.6] | Loss=0.01199 | Reg=0.00042 | acc=0.9688 | FP-Norm=0.642 | FP-Norm(final)=2.596 | 3838.0 samples/s | 60.0 steps/s
[Step=22200 Epoch=21.7] | Loss=0.01179 | Reg=0.00042 | acc=0.9844 | FP-Norm=0.648 | FP-Norm(final)=2.597 | 3849.6 samples/s | 60.2 steps/s
[Step=22250 Epoch=21.7] | Loss=0.01164 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.653 | FP-Norm(final)=2.597 | 3823.3 samples/s | 59.7 steps/s
[Step=22300 Epoch=21.8] | Loss=0.01166 | Reg=0.00044 | acc=0.9844 | FP-Norm=0.659 | FP-Norm(final)=2.598 | 3869.5 samples/s | 60.5 steps/s
[Step=22350 Epoch=21.8] | Loss=0.01188 | Reg=0.00045 | acc=0.9844 | FP-Norm=0.664 | FP-Norm(final)=2.599 | 3885.7 samples/s | 60.7 steps/s
[Step=22400 Epoch=21.9] | Loss=0.01186 | Reg=0.00045 | acc=0.9844 | FP-Norm=0.669 | FP-Norm(final)=2.600 | 3814.3 samples/s | 59.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step22400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=40.7] | Loss=0.07704 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.578 | 4748.4 samples/s | 74.2 steps/s
[Step=21650 Epoch=40.8] | Loss=0.00293 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.581 | 3229.1 samples/s | 50.5 steps/s
[Step=21700 Epoch=40.9] | Loss=0.00149 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.582 | 3641.7 samples/s | 56.9 steps/s
[Step=21750 Epoch=41.0] | Loss=0.00103 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.582 | 3691.4 samples/s | 57.7 steps/s
[Step=21800 Epoch=41.1] | Loss=0.00078 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.787 | FP-Norm(final)=2.583 | 3686.1 samples/s | 57.6 steps/s
[Step=21850 Epoch=41.2] | Loss=0.00063 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.770 | FP-Norm(final)=2.583 | 3748.3 samples/s | 58.6 steps/s
[Step=21900 Epoch=41.3] | Loss=0.00053 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.754 | FP-Norm(final)=2.583 | 3730.7 samples/s | 58.3 steps/s
[Step=21950 Epoch=41.4] | Loss=0.00045 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.739 | FP-Norm(final)=2.583 | 3753.8 samples/s | 58.7 steps/s
[Step=22000 Epoch=41.5] | Loss=0.00040 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.725 | FP-Norm(final)=2.583 | 3741.2 samples/s | 58.5 steps/s
[Step=22050 Epoch=41.6] | Loss=0.00036 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.711 | FP-Norm(final)=2.583 | 3712.1 samples/s | 58.0 steps/s
[Step=22100 Epoch=41.7] | Loss=0.00033 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.700 | FP-Norm(final)=2.584 | 3715.5 samples/s | 58.1 steps/s
[Step=22150 Epoch=41.8] | Loss=0.00030 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.692 | FP-Norm(final)=2.584 | 1878.5 samples/s | 29.4 steps/s
[Step=22200 Epoch=41.8] | Loss=0.00028 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.683 | FP-Norm(final)=2.584 | 3619.0 samples/s | 56.5 steps/s
[Step=22250 Epoch=41.9] | Loss=0.00026 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.673 | FP-Norm(final)=2.584 | 3641.1 samples/s | 56.9 steps/s
[Step=22300 Epoch=42.0] | Loss=0.00024 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.664 | FP-Norm(final)=2.584 | 3642.4 samples/s | 56.9 steps/s
[Step=22350 Epoch=42.1] | Loss=0.00022 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.655 | FP-Norm(final)=2.584 | 3624.3 samples/s | 56.6 steps/s
[Step=22400 Epoch=42.2] | Loss=0.00021 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.647 | FP-Norm(final)=2.584 | 3633.5 samples/s | 56.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18133 | acc=0.8879 | tpr=0.8447 | fpr=0.0183 | 3998.9 samples/s | 15.6 steps/s
Avg test loss: 0.18702, Avg test acc: 0.88601, Avg tpr: 0.84228, Avg fpr: 0.01782, total FA: 139

Testing server on iccad2012
[Step=  50] | Loss=0.50557 | acc=0.8181 | tpr=0.9690 | fpr=0.1846 | 3963.5 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.50276 | acc=0.8220 | tpr=0.9808 | fpr=0.1809 | 7270.4 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.50842 | acc=0.8206 | tpr=0.9841 | fpr=0.1824 | 7215.7 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.50201 | acc=0.8226 | tpr=0.9858 | fpr=0.1804 | 7392.9 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.49996 | acc=0.8229 | tpr=0.9860 | fpr=0.1801 | 7051.7 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.50190 | acc=0.8228 | tpr=0.9862 | fpr=0.1802 | 7369.0 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.50107 | acc=0.8229 | tpr=0.9850 | fpr=0.1801 | 7336.4 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.50232 | acc=0.8227 | tpr=0.9841 | fpr=0.1802 | 7120.7 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.50457 | acc=0.8228 | tpr=0.9830 | fpr=0.1801 | 7280.4 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.50379 | acc=0.8224 | tpr=0.9841 | fpr=0.1805 | 6983.0 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.50248 | acc=0.8230 | tpr=0.9837 | fpr=0.1799 | 13310.4 samples/s | 52.0 steps/s
Avg test loss: 0.50282, Avg test acc: 0.82303, Avg tpr: 0.98376, Avg fpr: 0.17989, total FA: 24978

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=21.9] | Loss=0.04804 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.597 | 4434.8 samples/s | 69.3 steps/s
[Step=22450 Epoch=21.9] | Loss=0.01902 | Reg=0.00032 | acc=0.9844 | FP-Norm=0.533 | FP-Norm(final)=2.601 | 3516.3 samples/s | 54.9 steps/s
[Step=22500 Epoch=22.0] | Loss=0.01436 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.605 | 3799.3 samples/s | 59.4 steps/s
[Step=22550 Epoch=22.0] | Loss=0.01307 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=2.608 | 3879.2 samples/s | 60.6 steps/s
[Step=22600 Epoch=22.1] | Loss=0.01236 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.606 | FP-Norm(final)=2.610 | 3903.4 samples/s | 61.0 steps/s
[Step=22650 Epoch=22.1] | Loss=0.01185 | Reg=0.00039 | acc=0.9844 | FP-Norm=0.615 | FP-Norm(final)=2.613 | 3925.1 samples/s | 61.3 steps/s
[Step=22700 Epoch=22.2] | Loss=0.01144 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.623 | FP-Norm(final)=2.615 | 3930.1 samples/s | 61.4 steps/s
[Step=22750 Epoch=22.2] | Loss=0.01139 | Reg=0.00040 | acc=0.9531 | FP-Norm=0.629 | FP-Norm(final)=2.617 | 3955.9 samples/s | 61.8 steps/s
[Step=22800 Epoch=22.3] | Loss=0.01131 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.637 | FP-Norm(final)=2.619 | 3932.1 samples/s | 61.4 steps/s
[Step=22850 Epoch=22.3] | Loss=0.01173 | Reg=0.00042 | acc=0.9844 | FP-Norm=0.647 | FP-Norm(final)=2.620 | 3929.6 samples/s | 61.4 steps/s
[Step=22900 Epoch=22.4] | Loss=0.01198 | Reg=0.00044 | acc=0.9688 | FP-Norm=0.656 | FP-Norm(final)=2.620 | 3870.1 samples/s | 60.5 steps/s
[Step=22950 Epoch=22.4] | Loss=0.01191 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.662 | FP-Norm(final)=2.620 | 3850.6 samples/s | 60.2 steps/s
[Step=23000 Epoch=22.5] | Loss=0.01184 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.667 | FP-Norm(final)=2.621 | 3852.7 samples/s | 60.2 steps/s
[Step=23050 Epoch=22.5] | Loss=0.01192 | Reg=0.00046 | acc=0.9844 | FP-Norm=0.671 | FP-Norm(final)=2.621 | 3839.0 samples/s | 60.0 steps/s
[Step=23100 Epoch=22.6] | Loss=0.01186 | Reg=0.00046 | acc=0.9844 | FP-Norm=0.675 | FP-Norm(final)=2.622 | 3826.5 samples/s | 59.8 steps/s
[Step=23150 Epoch=22.6] | Loss=0.01191 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.679 | FP-Norm(final)=2.622 | 3842.5 samples/s | 60.0 steps/s
[Step=23200 Epoch=22.7] | Loss=0.01180 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.683 | FP-Norm(final)=2.622 | 3843.2 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step23200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=42.2] | Loss=0.10771 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.596 | 4284.4 samples/s | 66.9 steps/s
[Step=22450 Epoch=42.3] | Loss=0.00848 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.014 | FP-Norm(final)=2.585 | 3306.0 samples/s | 51.7 steps/s
[Step=22500 Epoch=42.4] | Loss=0.00457 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.113 | FP-Norm(final)=2.581 | 3646.4 samples/s | 57.0 steps/s
[Step=22550 Epoch=42.5] | Loss=0.00334 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.132 | FP-Norm(final)=2.580 | 3618.7 samples/s | 56.5 steps/s
[Step=22600 Epoch=42.6] | Loss=0.00252 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.133 | FP-Norm(final)=2.580 | 3652.4 samples/s | 57.1 steps/s
[Step=22650 Epoch=42.7] | Loss=0.00202 | Reg=0.00129 | acc=1.0000 | FP-Norm=1.122 | FP-Norm(final)=2.580 | 3630.3 samples/s | 56.7 steps/s
[Step=22700 Epoch=42.8] | Loss=0.00169 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.108 | FP-Norm(final)=2.581 | 3655.7 samples/s | 57.1 steps/s
[Step=22750 Epoch=42.9] | Loss=0.00146 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.093 | FP-Norm(final)=2.581 | 3645.2 samples/s | 57.0 steps/s
[Step=22800 Epoch=43.0] | Loss=0.00128 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.077 | FP-Norm(final)=2.581 | 3635.5 samples/s | 56.8 steps/s
[Step=22850 Epoch=43.1] | Loss=0.00114 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.062 | FP-Norm(final)=2.582 | 3651.8 samples/s | 57.1 steps/s
[Step=22900 Epoch=43.2] | Loss=0.00103 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.048 | FP-Norm(final)=2.582 | 3685.2 samples/s | 57.6 steps/s
[Step=22950 Epoch=43.3] | Loss=0.00094 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.034 | FP-Norm(final)=2.583 | 1907.4 samples/s | 29.8 steps/s
[Step=23000 Epoch=43.4] | Loss=0.00086 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.020 | FP-Norm(final)=2.583 | 3785.1 samples/s | 59.1 steps/s
[Step=23050 Epoch=43.4] | Loss=0.00079 | Reg=0.00103 | acc=1.0000 | FP-Norm=1.007 | FP-Norm(final)=2.583 | 3719.6 samples/s | 58.1 steps/s
[Step=23100 Epoch=43.5] | Loss=0.00074 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.994 | FP-Norm(final)=2.584 | 3659.8 samples/s | 57.2 steps/s
[Step=23150 Epoch=43.6] | Loss=0.00069 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.981 | FP-Norm(final)=2.584 | 3693.8 samples/s | 57.7 steps/s
[Step=23200 Epoch=43.7] | Loss=0.00065 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.969 | FP-Norm(final)=2.584 | 3687.0 samples/s | 57.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21296 | acc=0.8651 | tpr=0.8117 | fpr=0.0191 | 3918.1 samples/s | 15.3 steps/s
Avg test loss: 0.21893, Avg test acc: 0.86465, Avg tpr: 0.81092, Avg fpr: 0.01718, total FA: 134

Testing server on iccad2012
[Step=  50] | Loss=0.49746 | acc=0.8252 | tpr=0.9690 | fpr=0.1774 | 3933.0 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.49580 | acc=0.8297 | tpr=0.9851 | fpr=0.1732 | 7276.8 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.50232 | acc=0.8291 | tpr=0.9885 | fpr=0.1739 | 7286.2 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.49718 | acc=0.8308 | tpr=0.9891 | fpr=0.1721 | 7287.5 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.49579 | acc=0.8310 | tpr=0.9886 | fpr=0.1719 | 6994.0 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.49822 | acc=0.8309 | tpr=0.9884 | fpr=0.1720 | 7197.3 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.49771 | acc=0.8312 | tpr=0.9869 | fpr=0.1716 | 7057.3 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.49928 | acc=0.8310 | tpr=0.9858 | fpr=0.1718 | 7325.1 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.50158 | acc=0.8313 | tpr=0.9844 | fpr=0.1714 | 6999.1 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.50087 | acc=0.8310 | tpr=0.9855 | fpr=0.1718 | 7014.6 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.49933 | acc=0.8315 | tpr=0.9853 | fpr=0.1713 | 13208.0 samples/s | 51.6 steps/s
Avg test loss: 0.49951, Avg test acc: 0.83150, Avg tpr: 0.98534, Avg fpr: 0.17130, total FA: 23784

server round 29/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=22.7] | Loss=0.08164 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.608 | 4046.9 samples/s | 63.2 steps/s
[Step=23250 Epoch=22.7] | Loss=0.01888 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.531 | FP-Norm(final)=2.610 | 3763.2 samples/s | 58.8 steps/s
[Step=23300 Epoch=22.7] | Loss=0.01432 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.614 | 3935.2 samples/s | 61.5 steps/s
[Step=23350 Epoch=22.8] | Loss=0.01199 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.588 | FP-Norm(final)=2.618 | 3889.2 samples/s | 60.8 steps/s
[Step=23400 Epoch=22.8] | Loss=0.01136 | Reg=0.00036 | acc=0.9844 | FP-Norm=0.592 | FP-Norm(final)=2.621 | 3823.7 samples/s | 59.7 steps/s
[Step=23450 Epoch=22.9] | Loss=0.01145 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.603 | FP-Norm(final)=2.624 | 3852.8 samples/s | 60.2 steps/s
[Step=23500 Epoch=22.9] | Loss=0.01127 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.613 | FP-Norm(final)=2.625 | 3838.1 samples/s | 60.0 steps/s
[Step=23550 Epoch=23.0] | Loss=0.01123 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.627 | 3858.6 samples/s | 60.3 steps/s
[Step=23600 Epoch=23.0] | Loss=0.01184 | Reg=0.00040 | acc=0.9844 | FP-Norm=0.627 | FP-Norm(final)=2.627 | 3834.4 samples/s | 59.9 steps/s
[Step=23650 Epoch=23.1] | Loss=0.01178 | Reg=0.00041 | acc=0.9844 | FP-Norm=0.633 | FP-Norm(final)=2.628 | 3842.8 samples/s | 60.0 steps/s
[Step=23700 Epoch=23.1] | Loss=0.01174 | Reg=0.00041 | acc=0.9844 | FP-Norm=0.640 | FP-Norm(final)=2.628 | 3845.7 samples/s | 60.1 steps/s
[Step=23750 Epoch=23.2] | Loss=0.01202 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.645 | FP-Norm(final)=2.628 | 3846.1 samples/s | 60.1 steps/s
[Step=23800 Epoch=23.2] | Loss=0.01198 | Reg=0.00043 | acc=0.9688 | FP-Norm=0.652 | FP-Norm(final)=2.629 | 3854.6 samples/s | 60.2 steps/s
[Step=23850 Epoch=23.3] | Loss=0.01189 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.658 | FP-Norm(final)=2.629 | 3840.2 samples/s | 60.0 steps/s
[Step=23900 Epoch=23.3] | Loss=0.01215 | Reg=0.00045 | acc=0.9844 | FP-Norm=0.663 | FP-Norm(final)=2.629 | 3857.7 samples/s | 60.3 steps/s
[Step=23950 Epoch=23.4] | Loss=0.01199 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.668 | FP-Norm(final)=2.630 | 3861.0 samples/s | 60.3 steps/s
[Step=24000 Epoch=23.4] | Loss=0.01186 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.671 | FP-Norm(final)=2.630 | 3821.0 samples/s | 59.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step24000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=43.7] | Loss=0.09922 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.608 | 5181.2 samples/s | 81.0 steps/s
[Step=23250 Epoch=43.8] | Loss=0.00327 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.679 | FP-Norm(final)=2.610 | 3093.9 samples/s | 48.3 steps/s
[Step=23300 Epoch=43.9] | Loss=0.00165 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.718 | FP-Norm(final)=2.611 | 3613.3 samples/s | 56.5 steps/s
[Step=23350 Epoch=44.0] | Loss=0.00113 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.711 | FP-Norm(final)=2.611 | 3633.7 samples/s | 56.8 steps/s
[Step=23400 Epoch=44.1] | Loss=0.00085 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.699 | FP-Norm(final)=2.612 | 3650.2 samples/s | 57.0 steps/s
[Step=23450 Epoch=44.2] | Loss=0.00069 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.685 | FP-Norm(final)=2.612 | 3693.9 samples/s | 57.7 steps/s
[Step=23500 Epoch=44.3] | Loss=0.00058 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.672 | FP-Norm(final)=2.612 | 3632.8 samples/s | 56.8 steps/s
[Step=23550 Epoch=44.4] | Loss=0.00050 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.659 | FP-Norm(final)=2.612 | 3622.7 samples/s | 56.6 steps/s
[Step=23600 Epoch=44.5] | Loss=0.00044 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.647 | FP-Norm(final)=2.613 | 3677.2 samples/s | 57.5 steps/s
[Step=23650 Epoch=44.6] | Loss=0.00039 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.636 | FP-Norm(final)=2.613 | 3624.0 samples/s | 56.6 steps/s
[Step=23700 Epoch=44.7] | Loss=0.00035 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.625 | FP-Norm(final)=2.613 | 3704.3 samples/s | 57.9 steps/s
[Step=23750 Epoch=44.8] | Loss=0.00032 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.615 | FP-Norm(final)=2.613 | 1896.9 samples/s | 29.6 steps/s
[Step=23800 Epoch=44.9] | Loss=0.00030 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=2.613 | 3735.9 samples/s | 58.4 steps/s
[Step=23850 Epoch=45.0] | Loss=0.00027 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.613 | 3744.1 samples/s | 58.5 steps/s
[Step=23900 Epoch=45.1] | Loss=0.00026 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=2.613 | 3705.9 samples/s | 57.9 steps/s
[Step=23950 Epoch=45.1] | Loss=0.00024 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.613 | 3703.7 samples/s | 57.9 steps/s
[Step=24000 Epoch=45.2] | Loss=0.00023 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.613 | 3702.7 samples/s | 57.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.15748 | acc=0.9046 | tpr=0.8698 | fpr=0.0198 | 3974.7 samples/s | 15.5 steps/s
Avg test loss: 0.16193, Avg test acc: 0.90356, Avg tpr: 0.86857, Avg fpr: 0.01948, total FA: 152

Testing server on iccad2012
[Step=  50] | Loss=0.61691 | acc=0.7917 | tpr=0.9602 | fpr=0.2113 | 3968.7 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.60997 | acc=0.7964 | tpr=0.9765 | fpr=0.2070 | 7156.5 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.61750 | acc=0.7960 | tpr=0.9827 | fpr=0.2074 | 7259.5 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.61065 | acc=0.7976 | tpr=0.9847 | fpr=0.2058 | 7216.0 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.60961 | acc=0.7971 | tpr=0.9843 | fpr=0.2063 | 7084.2 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.61227 | acc=0.7968 | tpr=0.9840 | fpr=0.2066 | 7437.3 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.61227 | acc=0.7969 | tpr=0.9831 | fpr=0.2065 | 6991.9 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.61412 | acc=0.7967 | tpr=0.9825 | fpr=0.2066 | 7284.8 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.61654 | acc=0.7971 | tpr=0.9815 | fpr=0.2063 | 7144.0 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.61572 | acc=0.7968 | tpr=0.9828 | fpr=0.2065 | 7179.0 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.61408 | acc=0.7973 | tpr=0.9821 | fpr=0.2061 | 13490.8 samples/s | 52.7 steps/s
Avg test loss: 0.61434, Avg test acc: 0.79724, Avg tpr: 0.98217, Avg fpr: 0.20612, total FA: 28619

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=23.4] | Loss=0.10985 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.626 | 4733.9 samples/s | 74.0 steps/s
[Step=24050 Epoch=23.5] | Loss=0.01651 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.334 | FP-Norm(final)=2.628 | 3536.0 samples/s | 55.3 steps/s
[Step=24100 Epoch=23.5] | Loss=0.01217 | Reg=0.00014 | acc=0.9688 | FP-Norm=0.361 | FP-Norm(final)=2.630 | 3862.1 samples/s | 60.3 steps/s
[Step=24150 Epoch=23.6] | Loss=0.01070 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.632 | 3833.5 samples/s | 59.9 steps/s
[Step=24200 Epoch=23.6] | Loss=0.00986 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=2.633 | 3808.3 samples/s | 59.5 steps/s
[Step=24250 Epoch=23.7] | Loss=0.00972 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.635 | 3836.5 samples/s | 59.9 steps/s
[Step=24300 Epoch=23.7] | Loss=0.00970 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.393 | FP-Norm(final)=2.636 | 3838.1 samples/s | 60.0 steps/s
[Step=24350 Epoch=23.8] | Loss=0.00935 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.399 | FP-Norm(final)=2.638 | 3851.5 samples/s | 60.2 steps/s
[Step=24400 Epoch=23.8] | Loss=0.00918 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.403 | FP-Norm(final)=2.639 | 3825.4 samples/s | 59.8 steps/s
[Step=24450 Epoch=23.9] | Loss=0.00896 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.640 | 3863.1 samples/s | 60.4 steps/s
[Step=24500 Epoch=23.9] | Loss=0.00885 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.642 | 3834.0 samples/s | 59.9 steps/s
[Step=24550 Epoch=24.0] | Loss=0.00883 | Reg=0.00017 | acc=0.9688 | FP-Norm=0.414 | FP-Norm(final)=2.643 | 3829.8 samples/s | 59.8 steps/s
[Step=24600 Epoch=24.0] | Loss=0.00880 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.644 | 3834.1 samples/s | 59.9 steps/s
[Step=24650 Epoch=24.1] | Loss=0.00893 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=2.645 | 3829.0 samples/s | 59.8 steps/s
[Step=24700 Epoch=24.1] | Loss=0.00882 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=2.646 | 3851.6 samples/s | 60.2 steps/s
[Step=24750 Epoch=24.2] | Loss=0.00903 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.647 | 3840.7 samples/s | 60.0 steps/s
[Step=24800 Epoch=24.2] | Loss=0.00897 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=2.647 | 3862.8 samples/s | 60.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step24800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=45.2] | Loss=0.00729 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.626 | 3935.9 samples/s | 61.5 steps/s
[Step=24050 Epoch=45.3] | Loss=0.00670 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=2.625 | 3631.4 samples/s | 56.7 steps/s
[Step=24100 Epoch=45.4] | Loss=0.00341 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.634 | FP-Norm(final)=2.625 | 3738.7 samples/s | 58.4 steps/s
[Step=24150 Epoch=45.5] | Loss=0.00228 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.633 | FP-Norm(final)=2.625 | 3725.5 samples/s | 58.2 steps/s
[Step=24200 Epoch=45.6] | Loss=0.00172 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.626 | 3732.4 samples/s | 58.3 steps/s
[Step=24250 Epoch=45.7] | Loss=0.00138 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.614 | FP-Norm(final)=2.626 | 3739.0 samples/s | 58.4 steps/s
[Step=24300 Epoch=45.8] | Loss=0.00120 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=2.626 | 3769.3 samples/s | 58.9 steps/s
[Step=24350 Epoch=45.9] | Loss=0.00103 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.602 | FP-Norm(final)=2.626 | 3660.7 samples/s | 57.2 steps/s
[Step=24400 Epoch=46.0] | Loss=0.00090 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=2.626 | 3661.7 samples/s | 57.2 steps/s
[Step=24450 Epoch=46.1] | Loss=0.00081 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=2.626 | 3639.2 samples/s | 56.9 steps/s
[Step=24500 Epoch=46.2] | Loss=0.00073 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.580 | FP-Norm(final)=2.627 | 3689.0 samples/s | 57.6 steps/s
[Step=24550 Epoch=46.3] | Loss=0.00066 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=2.627 | 1860.6 samples/s | 29.1 steps/s
[Step=24600 Epoch=46.4] | Loss=0.00061 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.627 | 3684.3 samples/s | 57.6 steps/s
[Step=24650 Epoch=46.5] | Loss=0.00056 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.627 | 3639.2 samples/s | 56.9 steps/s
[Step=24700 Epoch=46.6] | Loss=0.00052 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.553 | FP-Norm(final)=2.627 | 3625.8 samples/s | 56.7 steps/s
[Step=24750 Epoch=46.7] | Loss=0.00049 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.627 | 3610.1 samples/s | 56.4 steps/s
[Step=24800 Epoch=46.7] | Loss=0.00046 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.627 | 3630.9 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19919 | acc=0.8854 | tpr=0.8407 | fpr=0.0176 | 3977.1 samples/s | 15.5 steps/s
Avg test loss: 0.20392, Avg test acc: 0.88324, Avg tpr: 0.83738, Avg fpr: 0.01590, total FA: 124

Testing server on iccad2012
[Step=  50] | Loss=0.50061 | acc=0.8359 | tpr=0.9602 | fpr=0.1664 | 3972.4 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.49900 | acc=0.8409 | tpr=0.9765 | fpr=0.1617 | 7259.9 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.50622 | acc=0.8397 | tpr=0.9827 | fpr=0.1629 | 7105.2 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.50029 | acc=0.8415 | tpr=0.9847 | fpr=0.1611 | 7218.2 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.49879 | acc=0.8411 | tpr=0.9825 | fpr=0.1615 | 7262.2 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.50119 | acc=0.8412 | tpr=0.9818 | fpr=0.1613 | 7180.5 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.50130 | acc=0.8413 | tpr=0.9812 | fpr=0.1612 | 7112.0 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.50308 | acc=0.8414 | tpr=0.9809 | fpr=0.1611 | 7709.7 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.50582 | acc=0.8414 | tpr=0.9796 | fpr=0.1611 | 6819.0 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.50474 | acc=0.8411 | tpr=0.9806 | fpr=0.1614 | 7071.3 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.50326 | acc=0.8414 | tpr=0.9797 | fpr=0.1611 | 13379.2 samples/s | 52.3 steps/s
Avg test loss: 0.50344, Avg test acc: 0.84143, Avg tpr: 0.97979, Avg fpr: 0.16108, total FA: 22366

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=24.2] | Loss=0.08623 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.643 | 4093.5 samples/s | 64.0 steps/s
[Step=24850 Epoch=24.3] | Loss=0.02516 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.423 | FP-Norm(final)=2.643 | 3706.0 samples/s | 57.9 steps/s
[Step=24900 Epoch=24.3] | Loss=0.01718 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.453 | FP-Norm(final)=2.644 | 3808.8 samples/s | 59.5 steps/s
[Step=24950 Epoch=24.4] | Loss=0.01440 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=2.646 | 3818.9 samples/s | 59.7 steps/s
[Step=25000 Epoch=24.4] | Loss=0.01281 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.467 | FP-Norm(final)=2.648 | 3839.7 samples/s | 60.0 steps/s
[Step=25050 Epoch=24.5] | Loss=0.01189 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.469 | FP-Norm(final)=2.649 | 3827.7 samples/s | 59.8 steps/s
[Step=25100 Epoch=24.5] | Loss=0.01133 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.470 | FP-Norm(final)=2.651 | 3842.0 samples/s | 60.0 steps/s
[Step=25150 Epoch=24.6] | Loss=0.01094 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.471 | FP-Norm(final)=2.652 | 3831.9 samples/s | 59.9 steps/s
[Step=25200 Epoch=24.6] | Loss=0.01051 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=2.653 | 3847.9 samples/s | 60.1 steps/s
[Step=25250 Epoch=24.7] | Loss=0.01029 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.472 | FP-Norm(final)=2.655 | 3842.1 samples/s | 60.0 steps/s
[Step=25300 Epoch=24.7] | Loss=0.01001 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.473 | FP-Norm(final)=2.656 | 3844.4 samples/s | 60.1 steps/s
[Step=25350 Epoch=24.8] | Loss=0.00985 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.474 | FP-Norm(final)=2.657 | 3838.9 samples/s | 60.0 steps/s
[Step=25400 Epoch=24.8] | Loss=0.00972 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.474 | FP-Norm(final)=2.658 | 3857.4 samples/s | 60.3 steps/s
[Step=25450 Epoch=24.8] | Loss=0.00954 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.475 | FP-Norm(final)=2.659 | 3823.2 samples/s | 59.7 steps/s
[Step=25500 Epoch=24.9] | Loss=0.00931 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.475 | FP-Norm(final)=2.660 | 3843.8 samples/s | 60.1 steps/s
[Step=25550 Epoch=24.9] | Loss=0.00915 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.475 | FP-Norm(final)=2.661 | 3827.9 samples/s | 59.8 steps/s
[Step=25600 Epoch=25.0] | Loss=0.00908 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.475 | FP-Norm(final)=2.662 | 3852.2 samples/s | 60.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step25600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=46.8] | Loss=0.19718 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.643 | 4275.8 samples/s | 66.8 steps/s
[Step=24850 Epoch=46.8] | Loss=0.01138 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.687 | FP-Norm(final)=2.639 | 3355.8 samples/s | 52.4 steps/s
[Step=24900 Epoch=46.9] | Loss=0.00577 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.723 | FP-Norm(final)=2.638 | 3649.8 samples/s | 57.0 steps/s
[Step=24950 Epoch=47.0] | Loss=0.00387 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.720 | FP-Norm(final)=2.638 | 3601.9 samples/s | 56.3 steps/s
[Step=25000 Epoch=47.1] | Loss=0.00291 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.711 | FP-Norm(final)=2.638 | 3705.1 samples/s | 57.9 steps/s
[Step=25050 Epoch=47.2] | Loss=0.00234 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.702 | FP-Norm(final)=2.638 | 3696.5 samples/s | 57.8 steps/s
[Step=25100 Epoch=47.3] | Loss=0.00195 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.692 | FP-Norm(final)=2.638 | 3759.5 samples/s | 58.7 steps/s
[Step=25150 Epoch=47.4] | Loss=0.00168 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.682 | FP-Norm(final)=2.638 | 3708.6 samples/s | 57.9 steps/s
[Step=25200 Epoch=47.5] | Loss=0.00147 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.673 | FP-Norm(final)=2.638 | 3692.5 samples/s | 57.7 steps/s
[Step=25250 Epoch=47.6] | Loss=0.00131 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.664 | FP-Norm(final)=2.638 | 3774.4 samples/s | 59.0 steps/s
[Step=25300 Epoch=47.7] | Loss=0.00118 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.657 | FP-Norm(final)=2.639 | 3752.6 samples/s | 58.6 steps/s
[Step=25350 Epoch=47.8] | Loss=0.00108 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.649 | FP-Norm(final)=2.639 | 1878.2 samples/s | 29.3 steps/s
[Step=25400 Epoch=47.9] | Loss=0.00099 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.642 | FP-Norm(final)=2.639 | 3668.2 samples/s | 57.3 steps/s
[Step=25450 Epoch=48.0] | Loss=0.00092 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.636 | FP-Norm(final)=2.639 | 3622.0 samples/s | 56.6 steps/s
[Step=25500 Epoch=48.1] | Loss=0.00085 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.629 | FP-Norm(final)=2.639 | 3622.7 samples/s | 56.6 steps/s
[Step=25550 Epoch=48.2] | Loss=0.00079 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.623 | FP-Norm(final)=2.639 | 3645.3 samples/s | 57.0 steps/s
[Step=25600 Epoch=48.3] | Loss=0.00075 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.616 | FP-Norm(final)=2.639 | 3663.3 samples/s | 57.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23609 | acc=0.8656 | tpr=0.8102 | fpr=0.0141 | 3907.4 samples/s | 15.3 steps/s
Avg test loss: 0.24074, Avg test acc: 0.86405, Avg tpr: 0.80778, Avg fpr: 0.01218, total FA: 95

Testing server on iccad2012
[Step=  50] | Loss=0.46096 | acc=0.8525 | tpr=0.9602 | fpr=0.1494 | 3949.9 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.46026 | acc=0.8571 | tpr=0.9765 | fpr=0.1452 | 7361.4 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.46757 | acc=0.8566 | tpr=0.9827 | fpr=0.1457 | 7127.0 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.46201 | acc=0.8582 | tpr=0.9836 | fpr=0.1441 | 7493.3 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.46033 | acc=0.8586 | tpr=0.9808 | fpr=0.1436 | 6980.7 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.46277 | acc=0.8587 | tpr=0.9804 | fpr=0.1436 | 7363.0 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.46286 | acc=0.8587 | tpr=0.9793 | fpr=0.1435 | 7032.2 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.46471 | acc=0.8588 | tpr=0.9792 | fpr=0.1434 | 7464.8 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.46747 | acc=0.8589 | tpr=0.9781 | fpr=0.1433 | 7044.6 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.46655 | acc=0.8585 | tpr=0.9793 | fpr=0.1437 | 7048.2 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.46499 | acc=0.8588 | tpr=0.9789 | fpr=0.1433 | 13334.6 samples/s | 52.1 steps/s
Avg test loss: 0.46512, Avg test acc: 0.85888, Avg tpr: 0.97900, Avg fpr: 0.14331, total FA: 19898

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=25.0] | Loss=0.12270 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.659 | 4716.4 samples/s | 73.7 steps/s
[Step=25650 Epoch=25.0] | Loss=0.01962 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.661 | 3258.8 samples/s | 50.9 steps/s
[Step=25700 Epoch=25.1] | Loss=0.01471 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.448 | FP-Norm(final)=2.663 | 3810.0 samples/s | 59.5 steps/s
[Step=25750 Epoch=25.1] | Loss=0.01286 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.458 | FP-Norm(final)=2.664 | 3827.6 samples/s | 59.8 steps/s
[Step=25800 Epoch=25.2] | Loss=0.01215 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.459 | FP-Norm(final)=2.665 | 3820.5 samples/s | 59.7 steps/s
[Step=25850 Epoch=25.2] | Loss=0.01117 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=2.666 | 3854.7 samples/s | 60.2 steps/s
[Step=25900 Epoch=25.3] | Loss=0.01071 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=2.667 | 3832.2 samples/s | 59.9 steps/s
[Step=25950 Epoch=25.3] | Loss=0.01040 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=2.668 | 3850.6 samples/s | 60.2 steps/s
[Step=26000 Epoch=25.4] | Loss=0.00999 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.461 | FP-Norm(final)=2.670 | 3797.9 samples/s | 59.3 steps/s
[Step=26050 Epoch=25.4] | Loss=0.00975 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=2.671 | 3836.2 samples/s | 59.9 steps/s
[Step=26100 Epoch=25.5] | Loss=0.00960 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.462 | FP-Norm(final)=2.672 | 3857.1 samples/s | 60.3 steps/s
[Step=26150 Epoch=25.5] | Loss=0.00926 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.463 | FP-Norm(final)=2.673 | 3841.5 samples/s | 60.0 steps/s
[Step=26200 Epoch=25.6] | Loss=0.00907 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.463 | FP-Norm(final)=2.674 | 3841.0 samples/s | 60.0 steps/s
[Step=26250 Epoch=25.6] | Loss=0.00891 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.463 | FP-Norm(final)=2.675 | 3860.3 samples/s | 60.3 steps/s
[Step=26300 Epoch=25.7] | Loss=0.00896 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=2.677 | 3842.3 samples/s | 60.0 steps/s
[Step=26350 Epoch=25.7] | Loss=0.00890 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.466 | FP-Norm(final)=2.677 | 3848.2 samples/s | 60.1 steps/s
[Step=26400 Epoch=25.8] | Loss=0.00888 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.468 | FP-Norm(final)=2.678 | 3846.7 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step26400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=48.3] | Loss=0.04948 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.659 | 3935.0 samples/s | 61.5 steps/s
[Step=25650 Epoch=48.4] | Loss=0.00402 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=2.660 | 3645.8 samples/s | 57.0 steps/s
[Step=25700 Epoch=48.4] | Loss=0.00203 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.661 | 3733.6 samples/s | 58.3 steps/s
[Step=25750 Epoch=48.5] | Loss=0.00137 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.661 | 3703.6 samples/s | 57.9 steps/s
[Step=25800 Epoch=48.6] | Loss=0.00105 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.661 | 3742.4 samples/s | 58.5 steps/s
[Step=25850 Epoch=48.7] | Loss=0.00085 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.661 | 3738.6 samples/s | 58.4 steps/s
[Step=25900 Epoch=48.8] | Loss=0.00071 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.532 | FP-Norm(final)=2.661 | 3704.8 samples/s | 57.9 steps/s
[Step=25950 Epoch=48.9] | Loss=0.00061 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=2.661 | 3677.6 samples/s | 57.5 steps/s
[Step=26000 Epoch=49.0] | Loss=0.00054 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=2.662 | 3619.8 samples/s | 56.6 steps/s
[Step=26050 Epoch=49.1] | Loss=0.00048 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=2.662 | 3640.7 samples/s | 56.9 steps/s
[Step=26100 Epoch=49.2] | Loss=0.00043 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=2.662 | 3727.8 samples/s | 58.2 steps/s
[Step=26150 Epoch=49.3] | Loss=0.00040 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.662 | 1909.0 samples/s | 29.8 steps/s
[Step=26200 Epoch=49.4] | Loss=0.00037 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=2.662 | 3667.7 samples/s | 57.3 steps/s
[Step=26250 Epoch=49.5] | Loss=0.00034 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.662 | 3703.2 samples/s | 57.9 steps/s
[Step=26300 Epoch=49.6] | Loss=0.00032 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=2.662 | 3713.6 samples/s | 58.0 steps/s
[Step=26350 Epoch=49.7] | Loss=0.00030 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.482 | FP-Norm(final)=2.662 | 3801.3 samples/s | 59.4 steps/s
[Step=26400 Epoch=49.8] | Loss=0.00028 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.477 | FP-Norm(final)=2.662 | 3590.9 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19098 | acc=0.8911 | tpr=0.8480 | fpr=0.0154 | 3882.9 samples/s | 15.2 steps/s
Avg test loss: 0.19391, Avg test acc: 0.89042, Avg tpr: 0.84688, Avg fpr: 0.01384, total FA: 108

Testing server on iccad2012
[Step=  50] | Loss=0.51857 | acc=0.8299 | tpr=0.9602 | fpr=0.1724 | 4005.7 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.51482 | acc=0.8348 | tpr=0.9765 | fpr=0.1679 | 7132.6 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.52212 | acc=0.8328 | tpr=0.9827 | fpr=0.1699 | 7323.9 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.51592 | acc=0.8345 | tpr=0.9847 | fpr=0.1683 | 7043.7 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.51404 | acc=0.8349 | tpr=0.9817 | fpr=0.1678 | 7299.3 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.51626 | acc=0.8350 | tpr=0.9811 | fpr=0.1676 | 7313.5 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.51607 | acc=0.8354 | tpr=0.9806 | fpr=0.1673 | 7109.1 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.51788 | acc=0.8355 | tpr=0.9803 | fpr=0.1672 | 7304.7 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.52031 | acc=0.8355 | tpr=0.9796 | fpr=0.1671 | 7271.2 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.51939 | acc=0.8351 | tpr=0.9806 | fpr=0.1675 | 6545.3 samples/s | 25.6 steps/s
[Step= 550] | Loss=0.51790 | acc=0.8353 | tpr=0.9801 | fpr=0.1673 | 13051.0 samples/s | 51.0 steps/s
Avg test loss: 0.51811, Avg test acc: 0.83536, Avg tpr: 0.98019, Avg fpr: 0.16727, total FA: 23225

server round 33/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=25.8] | Loss=0.04098 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.677 | 3999.6 samples/s | 62.5 steps/s
[Step=26450 Epoch=25.8] | Loss=0.01830 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.376 | FP-Norm(final)=2.678 | 3870.5 samples/s | 60.5 steps/s
[Step=26500 Epoch=25.9] | Loss=0.01426 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.679 | 3881.4 samples/s | 60.6 steps/s
[Step=26550 Epoch=25.9] | Loss=0.01148 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.681 | 3850.4 samples/s | 60.2 steps/s
[Step=26600 Epoch=26.0] | Loss=0.01077 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.682 | 3822.4 samples/s | 59.7 steps/s
[Step=26650 Epoch=26.0] | Loss=0.01008 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.408 | FP-Norm(final)=2.684 | 3834.3 samples/s | 59.9 steps/s
[Step=26700 Epoch=26.1] | Loss=0.00954 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.685 | 3856.2 samples/s | 60.3 steps/s
[Step=26750 Epoch=26.1] | Loss=0.00955 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.686 | 3846.2 samples/s | 60.1 steps/s
[Step=26800 Epoch=26.2] | Loss=0.00955 | Reg=0.00018 | acc=0.9844 | FP-Norm=0.416 | FP-Norm(final)=2.687 | 3840.6 samples/s | 60.0 steps/s
[Step=26850 Epoch=26.2] | Loss=0.00925 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=2.688 | 3833.3 samples/s | 59.9 steps/s
[Step=26900 Epoch=26.3] | Loss=0.00918 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=2.689 | 3849.0 samples/s | 60.1 steps/s
[Step=26950 Epoch=26.3] | Loss=0.00905 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=2.690 | 3817.3 samples/s | 59.6 steps/s
[Step=27000 Epoch=26.4] | Loss=0.00882 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.691 | 3883.3 samples/s | 60.7 steps/s
[Step=27050 Epoch=26.4] | Loss=0.00874 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.692 | 3845.4 samples/s | 60.1 steps/s
[Step=27100 Epoch=26.5] | Loss=0.00884 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.693 | 3824.0 samples/s | 59.8 steps/s
[Step=27150 Epoch=26.5] | Loss=0.00893 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=2.694 | 3858.7 samples/s | 60.3 steps/s
[Step=27200 Epoch=26.6] | Loss=0.00887 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.434 | FP-Norm(final)=2.695 | 3841.4 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step27200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=49.8] | Loss=0.07968 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.677 | 4366.9 samples/s | 68.2 steps/s
[Step=26450 Epoch=49.9] | Loss=0.00630 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.675 | 3378.7 samples/s | 52.8 steps/s
[Step=26500 Epoch=50.0] | Loss=0.00320 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.613 | FP-Norm(final)=2.675 | 3745.0 samples/s | 58.5 steps/s
[Step=26550 Epoch=50.0] | Loss=0.00217 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=2.675 | 3665.1 samples/s | 57.3 steps/s
[Step=26600 Epoch=50.1] | Loss=0.00163 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.602 | FP-Norm(final)=2.675 | 3640.5 samples/s | 56.9 steps/s
[Step=26650 Epoch=50.2] | Loss=0.00131 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=2.676 | 3669.7 samples/s | 57.3 steps/s
[Step=26700 Epoch=50.3] | Loss=0.00111 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.584 | FP-Norm(final)=2.676 | 3611.7 samples/s | 56.4 steps/s
[Step=26750 Epoch=50.4] | Loss=0.00095 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=2.676 | 3691.4 samples/s | 57.7 steps/s
[Step=26800 Epoch=50.5] | Loss=0.00084 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.676 | 3648.6 samples/s | 57.0 steps/s
[Step=26850 Epoch=50.6] | Loss=0.00075 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.676 | 3622.1 samples/s | 56.6 steps/s
[Step=26900 Epoch=50.7] | Loss=0.00067 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.676 | 3689.8 samples/s | 57.7 steps/s
[Step=26950 Epoch=50.8] | Loss=0.00061 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.677 | 1938.4 samples/s | 30.3 steps/s
[Step=27000 Epoch=50.9] | Loss=0.00056 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.677 | 3714.6 samples/s | 58.0 steps/s
[Step=27050 Epoch=51.0] | Loss=0.00052 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.677 | 3716.6 samples/s | 58.1 steps/s
[Step=27100 Epoch=51.1] | Loss=0.00049 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.532 | FP-Norm(final)=2.677 | 3715.5 samples/s | 58.1 steps/s
[Step=27150 Epoch=51.2] | Loss=0.00045 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=2.677 | 3725.5 samples/s | 58.2 steps/s
[Step=27200 Epoch=51.3] | Loss=0.00043 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.521 | FP-Norm(final)=2.677 | 3694.5 samples/s | 57.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20614 | acc=0.8823 | tpr=0.8349 | fpr=0.0146 | 3984.6 samples/s | 15.6 steps/s
Avg test loss: 0.21062, Avg test acc: 0.88160, Avg tpr: 0.83365, Avg fpr: 0.01295, total FA: 101

Testing server on iccad2012
[Step=  50] | Loss=0.48847 | acc=0.8396 | tpr=0.9602 | fpr=0.1626 | 3969.6 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.48448 | acc=0.8461 | tpr=0.9765 | fpr=0.1563 | 7196.1 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.49135 | acc=0.8451 | tpr=0.9827 | fpr=0.1574 | 7172.0 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.48529 | acc=0.8474 | tpr=0.9847 | fpr=0.1551 | 7507.4 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.48351 | acc=0.8478 | tpr=0.9834 | fpr=0.1547 | 7083.1 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.48657 | acc=0.8478 | tpr=0.9825 | fpr=0.1547 | 7129.4 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.48624 | acc=0.8480 | tpr=0.9818 | fpr=0.1544 | 7226.5 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.48831 | acc=0.8481 | tpr=0.9819 | fpr=0.1544 | 7240.1 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.49085 | acc=0.8481 | tpr=0.9800 | fpr=0.1543 | 7194.0 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.49001 | acc=0.8478 | tpr=0.9815 | fpr=0.1547 | 6941.2 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.48854 | acc=0.8482 | tpr=0.9809 | fpr=0.1542 | 13698.2 samples/s | 53.5 steps/s
Avg test loss: 0.48880, Avg test acc: 0.84824, Avg tpr: 0.98098, Avg fpr: 0.15417, total FA: 21406

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=26.6] | Loss=0.10364 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.692 | 4343.3 samples/s | 67.9 steps/s
[Step=27250 Epoch=26.6] | Loss=0.01813 | Reg=0.00018 | acc=0.9844 | FP-Norm=0.404 | FP-Norm(final)=2.694 | 3615.7 samples/s | 56.5 steps/s
[Step=27300 Epoch=26.7] | Loss=0.01368 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.695 | 3814.6 samples/s | 59.6 steps/s
[Step=27350 Epoch=26.7] | Loss=0.01118 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.437 | FP-Norm(final)=2.697 | 3828.3 samples/s | 59.8 steps/s
[Step=27400 Epoch=26.8] | Loss=0.01039 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=2.698 | 3824.8 samples/s | 59.8 steps/s
[Step=27450 Epoch=26.8] | Loss=0.00974 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=2.699 | 3832.5 samples/s | 59.9 steps/s
[Step=27500 Epoch=26.8] | Loss=0.01004 | Reg=0.00020 | acc=0.9688 | FP-Norm=0.440 | FP-Norm(final)=2.700 | 3853.6 samples/s | 60.2 steps/s
[Step=27550 Epoch=26.9] | Loss=0.00969 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.442 | FP-Norm(final)=2.701 | 3829.1 samples/s | 59.8 steps/s
[Step=27600 Epoch=26.9] | Loss=0.00944 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.444 | FP-Norm(final)=2.703 | 3862.2 samples/s | 60.3 steps/s
[Step=27650 Epoch=27.0] | Loss=0.00938 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=2.703 | 3835.4 samples/s | 59.9 steps/s
[Step=27700 Epoch=27.0] | Loss=0.00939 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.448 | FP-Norm(final)=2.704 | 3843.5 samples/s | 60.1 steps/s
[Step=27750 Epoch=27.1] | Loss=0.00931 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.450 | FP-Norm(final)=2.705 | 3833.7 samples/s | 59.9 steps/s
[Step=27800 Epoch=27.1] | Loss=0.00906 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.706 | 3842.3 samples/s | 60.0 steps/s
[Step=27850 Epoch=27.2] | Loss=0.00890 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.453 | FP-Norm(final)=2.707 | 3845.5 samples/s | 60.1 steps/s
[Step=27900 Epoch=27.2] | Loss=0.00867 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=2.707 | 3839.2 samples/s | 60.0 steps/s
[Step=27950 Epoch=27.3] | Loss=0.00874 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.455 | FP-Norm(final)=2.708 | 3860.2 samples/s | 60.3 steps/s
[Step=28000 Epoch=27.3] | Loss=0.00858 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.455 | FP-Norm(final)=2.709 | 3852.0 samples/s | 60.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step28000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=51.3] | Loss=0.05282 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.692 | 4289.5 samples/s | 67.0 steps/s
[Step=27250 Epoch=51.4] | Loss=0.00455 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=2.691 | 3208.4 samples/s | 50.1 steps/s
[Step=27300 Epoch=51.5] | Loss=0.00230 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=2.691 | 3617.6 samples/s | 56.5 steps/s
[Step=27350 Epoch=51.6] | Loss=0.00154 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.691 | 3620.1 samples/s | 56.6 steps/s
[Step=27400 Epoch=51.6] | Loss=0.00116 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=2.691 | 3644.4 samples/s | 56.9 steps/s
[Step=27450 Epoch=51.7] | Loss=0.00094 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=2.691 | 3625.8 samples/s | 56.7 steps/s
[Step=27500 Epoch=51.8] | Loss=0.00079 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.488 | FP-Norm(final)=2.691 | 3675.4 samples/s | 57.4 steps/s
[Step=27550 Epoch=51.9] | Loss=0.00068 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.482 | FP-Norm(final)=2.691 | 3675.7 samples/s | 57.4 steps/s
[Step=27600 Epoch=52.0] | Loss=0.00060 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.477 | FP-Norm(final)=2.691 | 3599.5 samples/s | 56.2 steps/s
[Step=27650 Epoch=52.1] | Loss=0.00053 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.472 | FP-Norm(final)=2.692 | 3703.4 samples/s | 57.9 steps/s
[Step=27700 Epoch=52.2] | Loss=0.00048 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.467 | FP-Norm(final)=2.692 | 3588.7 samples/s | 56.1 steps/s
[Step=27750 Epoch=52.3] | Loss=0.00044 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=2.692 | 1959.1 samples/s | 30.6 steps/s
[Step=27800 Epoch=52.4] | Loss=0.00040 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=2.692 | 3736.4 samples/s | 58.4 steps/s
[Step=27850 Epoch=52.5] | Loss=0.00037 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.451 | FP-Norm(final)=2.692 | 3618.8 samples/s | 56.5 steps/s
[Step=27900 Epoch=52.6] | Loss=0.00035 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.447 | FP-Norm(final)=2.692 | 3635.1 samples/s | 56.8 steps/s
[Step=27950 Epoch=52.7] | Loss=0.00033 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=2.692 | 3649.4 samples/s | 57.0 steps/s
[Step=28000 Epoch=52.8] | Loss=0.00031 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=2.692 | 3679.9 samples/s | 57.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18751 | acc=0.8920 | tpr=0.8492 | fpr=0.0149 | 3919.1 samples/s | 15.3 steps/s
Avg test loss: 0.19275, Avg test acc: 0.89142, Avg tpr: 0.84840, Avg fpr: 0.01397, total FA: 109

Testing server on iccad2012
[Step=  50] | Loss=0.51015 | acc=0.8362 | tpr=0.9602 | fpr=0.1661 | 3953.6 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.50620 | acc=0.8414 | tpr=0.9765 | fpr=0.1611 | 7243.7 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.51335 | acc=0.8402 | tpr=0.9827 | fpr=0.1625 | 7255.6 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.50747 | acc=0.8419 | tpr=0.9836 | fpr=0.1607 | 6987.7 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.50569 | acc=0.8424 | tpr=0.9817 | fpr=0.1601 | 7353.4 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.50858 | acc=0.8425 | tpr=0.9796 | fpr=0.1600 | 7063.4 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.50816 | acc=0.8427 | tpr=0.9793 | fpr=0.1597 | 7482.7 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.51051 | acc=0.8427 | tpr=0.9792 | fpr=0.1598 | 7163.2 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.51327 | acc=0.8428 | tpr=0.9781 | fpr=0.1597 | 6789.0 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.51233 | acc=0.8425 | tpr=0.9797 | fpr=0.1600 | 7054.4 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.51093 | acc=0.8427 | tpr=0.9785 | fpr=0.1598 | 13143.8 samples/s | 51.3 steps/s
Avg test loss: 0.51125, Avg test acc: 0.84276, Avg tpr: 0.97861, Avg fpr: 0.15971, total FA: 22175

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=27.3] | Loss=0.04238 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.707 | 3798.3 samples/s | 59.3 steps/s
[Step=28050 Epoch=27.4] | Loss=0.01358 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.363 | FP-Norm(final)=2.710 | 3949.7 samples/s | 61.7 steps/s
[Step=28100 Epoch=27.4] | Loss=0.01186 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.712 | 3910.7 samples/s | 61.1 steps/s
[Step=28150 Epoch=27.5] | Loss=0.01070 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.713 | 3902.0 samples/s | 61.0 steps/s
[Step=28200 Epoch=27.5] | Loss=0.01026 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.410 | FP-Norm(final)=2.714 | 3903.2 samples/s | 61.0 steps/s
[Step=28250 Epoch=27.6] | Loss=0.00971 | Reg=0.00018 | acc=0.9844 | FP-Norm=0.414 | FP-Norm(final)=2.715 | 3958.9 samples/s | 61.9 steps/s
[Step=28300 Epoch=27.6] | Loss=0.00889 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.716 | 3945.6 samples/s | 61.6 steps/s
[Step=28350 Epoch=27.7] | Loss=0.00903 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.717 | 3907.3 samples/s | 61.1 steps/s
[Step=28400 Epoch=27.7] | Loss=0.00874 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=2.718 | 3963.4 samples/s | 61.9 steps/s
[Step=28450 Epoch=27.8] | Loss=0.00896 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=2.718 | 3877.8 samples/s | 60.6 steps/s
[Step=28500 Epoch=27.8] | Loss=0.00886 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.719 | 3813.5 samples/s | 59.6 steps/s
[Step=28550 Epoch=27.9] | Loss=0.00877 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.428 | FP-Norm(final)=2.720 | 3843.6 samples/s | 60.1 steps/s
[Step=28600 Epoch=27.9] | Loss=0.00874 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.431 | FP-Norm(final)=2.720 | 3851.4 samples/s | 60.2 steps/s
[Step=28650 Epoch=28.0] | Loss=0.00861 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.432 | FP-Norm(final)=2.721 | 3876.3 samples/s | 60.6 steps/s
[Step=28700 Epoch=28.0] | Loss=0.00861 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=2.722 | 3874.5 samples/s | 60.5 steps/s
[Step=28750 Epoch=28.1] | Loss=0.00855 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.722 | 3918.5 samples/s | 61.2 steps/s
[Step=28800 Epoch=28.1] | Loss=0.00861 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=2.723 | 3911.0 samples/s | 61.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step28800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=52.8] | Loss=0.04507 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.707 | 4031.7 samples/s | 63.0 steps/s
[Step=28050 Epoch=52.9] | Loss=0.00684 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=2.706 | 3450.2 samples/s | 53.9 steps/s
[Step=28100 Epoch=53.0] | Loss=0.00354 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.604 | FP-Norm(final)=2.706 | 3695.3 samples/s | 57.7 steps/s
[Step=28150 Epoch=53.1] | Loss=0.00237 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.607 | FP-Norm(final)=2.706 | 3683.4 samples/s | 57.6 steps/s
[Step=28200 Epoch=53.2] | Loss=0.00178 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.601 | FP-Norm(final)=2.706 | 3725.3 samples/s | 58.2 steps/s
[Step=28250 Epoch=53.3] | Loss=0.00143 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=2.706 | 3547.3 samples/s | 55.4 steps/s
[Step=28300 Epoch=53.3] | Loss=0.00119 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.585 | FP-Norm(final)=2.706 | 3700.6 samples/s | 57.8 steps/s
[Step=28350 Epoch=53.4] | Loss=0.00103 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=2.706 | 3683.7 samples/s | 57.6 steps/s
[Step=28400 Epoch=53.5] | Loss=0.00090 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.706 | 3673.8 samples/s | 57.4 steps/s
[Step=28450 Epoch=53.6] | Loss=0.00080 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.706 | 3657.6 samples/s | 57.1 steps/s
[Step=28500 Epoch=53.7] | Loss=0.00072 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.707 | 3673.8 samples/s | 57.4 steps/s
[Step=28550 Epoch=53.8] | Loss=0.00066 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.707 | 1911.4 samples/s | 29.9 steps/s
[Step=28600 Epoch=53.9] | Loss=0.00060 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.707 | 3713.5 samples/s | 58.0 steps/s
[Step=28650 Epoch=54.0] | Loss=0.00056 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.707 | 3722.5 samples/s | 58.2 steps/s
[Step=28700 Epoch=54.1] | Loss=0.00052 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.707 | 3726.3 samples/s | 58.2 steps/s
[Step=28750 Epoch=54.2] | Loss=0.00049 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=2.707 | 3722.6 samples/s | 58.2 steps/s
[Step=28800 Epoch=54.3] | Loss=0.00046 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=2.707 | 3682.5 samples/s | 57.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20204 | acc=0.8848 | tpr=0.8384 | fpr=0.0144 | 3959.1 samples/s | 15.5 steps/s
Avg test loss: 0.20741, Avg test acc: 0.88409, Avg tpr: 0.83727, Avg fpr: 0.01295, total FA: 101

Testing server on iccad2012
[Step=  50] | Loss=0.47603 | acc=0.8476 | tpr=0.9602 | fpr=0.1544 | 3999.0 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.47507 | acc=0.8535 | tpr=0.9765 | fpr=0.1488 | 7207.3 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.48185 | acc=0.8526 | tpr=0.9827 | fpr=0.1498 | 7026.0 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.47702 | acc=0.8545 | tpr=0.9847 | fpr=0.1479 | 7362.5 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.47553 | acc=0.8551 | tpr=0.9825 | fpr=0.1472 | 7070.1 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.47827 | acc=0.8550 | tpr=0.9811 | fpr=0.1473 | 7481.8 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.47808 | acc=0.8552 | tpr=0.9800 | fpr=0.1471 | 7073.9 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.48032 | acc=0.8551 | tpr=0.9792 | fpr=0.1471 | 7412.4 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.48327 | acc=0.8552 | tpr=0.9776 | fpr=0.1470 | 7098.1 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.48211 | acc=0.8548 | tpr=0.9793 | fpr=0.1475 | 7253.9 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.48072 | acc=0.8551 | tpr=0.9785 | fpr=0.1471 | 12660.1 samples/s | 49.5 steps/s
Avg test loss: 0.48099, Avg test acc: 0.85511, Avg tpr: 0.97861, Avg fpr: 0.14713, total FA: 20429

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=28.1] | Loss=0.07931 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.719 | 3879.3 samples/s | 60.6 steps/s
[Step=28850 Epoch=28.2] | Loss=0.01818 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.720 | 3967.2 samples/s | 62.0 steps/s
[Step=28900 Epoch=28.2] | Loss=0.01242 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=2.721 | 3906.7 samples/s | 61.0 steps/s
[Step=28950 Epoch=28.3] | Loss=0.01109 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.723 | 3984.8 samples/s | 62.3 steps/s
[Step=29000 Epoch=28.3] | Loss=0.00987 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.724 | 3893.1 samples/s | 60.8 steps/s
[Step=29050 Epoch=28.4] | Loss=0.00974 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=2.726 | 3948.1 samples/s | 61.7 steps/s
[Step=29100 Epoch=28.4] | Loss=0.00934 | Reg=0.00019 | acc=0.9688 | FP-Norm=0.428 | FP-Norm(final)=2.727 | 3940.6 samples/s | 61.6 steps/s
[Step=29150 Epoch=28.5] | Loss=0.00873 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.728 | 3848.4 samples/s | 60.1 steps/s
[Step=29200 Epoch=28.5] | Loss=0.00848 | Reg=0.00019 | acc=0.9688 | FP-Norm=0.431 | FP-Norm(final)=2.729 | 3842.9 samples/s | 60.0 steps/s
[Step=29250 Epoch=28.6] | Loss=0.00843 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=2.730 | 3864.1 samples/s | 60.4 steps/s
[Step=29300 Epoch=28.6] | Loss=0.00840 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=2.731 | 3856.5 samples/s | 60.3 steps/s
[Step=29350 Epoch=28.7] | Loss=0.00831 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.435 | FP-Norm(final)=2.732 | 3839.1 samples/s | 60.0 steps/s
[Step=29400 Epoch=28.7] | Loss=0.00828 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.436 | FP-Norm(final)=2.733 | 3854.6 samples/s | 60.2 steps/s
[Step=29450 Epoch=28.8] | Loss=0.00808 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.437 | FP-Norm(final)=2.733 | 3822.9 samples/s | 59.7 steps/s
[Step=29500 Epoch=28.8] | Loss=0.00806 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=2.734 | 3856.3 samples/s | 60.3 steps/s
[Step=29550 Epoch=28.9] | Loss=0.00808 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=2.735 | 3851.0 samples/s | 60.2 steps/s
[Step=29600 Epoch=28.9] | Loss=0.00796 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=2.736 | 3858.0 samples/s | 60.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step29600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=54.3] | Loss=0.08341 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.719 | 4168.6 samples/s | 65.1 steps/s
[Step=28850 Epoch=54.4] | Loss=0.00393 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=2.720 | 3552.4 samples/s | 55.5 steps/s
[Step=28900 Epoch=54.5] | Loss=0.00198 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.720 | 3730.3 samples/s | 58.3 steps/s
[Step=28950 Epoch=54.6] | Loss=0.00134 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.720 | 3636.4 samples/s | 56.8 steps/s
[Step=29000 Epoch=54.7] | Loss=0.00101 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.720 | 3679.7 samples/s | 57.5 steps/s
[Step=29050 Epoch=54.8] | Loss=0.00083 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=2.720 | 3641.9 samples/s | 56.9 steps/s
[Step=29100 Epoch=54.9] | Loss=0.00069 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.520 | FP-Norm(final)=2.720 | 3624.6 samples/s | 56.6 steps/s
[Step=29150 Epoch=54.9] | Loss=0.00060 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=2.721 | 3644.1 samples/s | 56.9 steps/s
[Step=29200 Epoch=55.0] | Loss=0.00052 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=2.721 | 3643.0 samples/s | 56.9 steps/s
[Step=29250 Epoch=55.1] | Loss=0.00047 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=2.721 | 3750.6 samples/s | 58.6 steps/s
[Step=29300 Epoch=55.2] | Loss=0.00042 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.492 | FP-Norm(final)=2.721 | 3755.9 samples/s | 58.7 steps/s
[Step=29350 Epoch=55.3] | Loss=0.00038 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=2.721 | 1880.8 samples/s | 29.4 steps/s
[Step=29400 Epoch=55.4] | Loss=0.00035 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=2.721 | 3668.3 samples/s | 57.3 steps/s
[Step=29450 Epoch=55.5] | Loss=0.00033 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=2.721 | 3651.3 samples/s | 57.1 steps/s
[Step=29500 Epoch=55.6] | Loss=0.00030 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=2.721 | 3616.0 samples/s | 56.5 steps/s
[Step=29550 Epoch=55.7] | Loss=0.00028 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.466 | FP-Norm(final)=2.721 | 3655.1 samples/s | 57.1 steps/s
[Step=29600 Epoch=55.8] | Loss=0.00027 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=2.721 | 3658.2 samples/s | 57.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19813 | acc=0.8912 | tpr=0.8480 | fpr=0.0149 | 4012.5 samples/s | 15.7 steps/s
Avg test loss: 0.20385, Avg test acc: 0.88998, Avg tpr: 0.84642, Avg fpr: 0.01423, total FA: 111

Testing server on iccad2012
[Step=  50] | Loss=0.49767 | acc=0.8502 | tpr=0.9602 | fpr=0.1518 | 3942.0 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.49654 | acc=0.8563 | tpr=0.9765 | fpr=0.1459 | 7218.2 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.50388 | acc=0.8553 | tpr=0.9827 | fpr=0.1471 | 7438.0 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.49792 | acc=0.8571 | tpr=0.9836 | fpr=0.1452 | 7015.0 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.49627 | acc=0.8577 | tpr=0.9817 | fpr=0.1446 | 7195.5 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.49898 | acc=0.8581 | tpr=0.9818 | fpr=0.1441 | 7283.0 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.49876 | acc=0.8583 | tpr=0.9812 | fpr=0.1439 | 7255.4 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.50148 | acc=0.8582 | tpr=0.9803 | fpr=0.1441 | 7232.6 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.50472 | acc=0.8581 | tpr=0.9791 | fpr=0.1441 | 6914.1 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.50329 | acc=0.8578 | tpr=0.9806 | fpr=0.1444 | 7178.7 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.50191 | acc=0.8579 | tpr=0.9797 | fpr=0.1443 | 13606.0 samples/s | 53.1 steps/s
Avg test loss: 0.50223, Avg test acc: 0.85794, Avg tpr: 0.97979, Avg fpr: 0.14428, total FA: 20033

server round 37/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=28.9] | Loss=0.04497 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.735 | 4577.3 samples/s | 71.5 steps/s
[Step=29650 Epoch=28.9] | Loss=0.01916 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=2.737 | 3593.9 samples/s | 56.2 steps/s
[Step=29700 Epoch=29.0] | Loss=0.01289 | Reg=0.00018 | acc=0.9844 | FP-Norm=0.414 | FP-Norm(final)=2.738 | 3917.9 samples/s | 61.2 steps/s
[Step=29750 Epoch=29.0] | Loss=0.01059 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=2.739 | 3872.8 samples/s | 60.5 steps/s
[Step=29800 Epoch=29.1] | Loss=0.00902 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=2.741 | 3862.9 samples/s | 60.4 steps/s
[Step=29850 Epoch=29.1] | Loss=0.00888 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=2.743 | 3837.1 samples/s | 60.0 steps/s
[Step=29900 Epoch=29.2] | Loss=0.00911 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.744 | 3861.5 samples/s | 60.3 steps/s
[Step=29950 Epoch=29.2] | Loss=0.00903 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.744 | 3840.5 samples/s | 60.0 steps/s
[Step=30000 Epoch=29.3] | Loss=0.00891 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=2.745 | 3863.0 samples/s | 60.4 steps/s
[Step=30050 Epoch=29.3] | Loss=0.00876 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.429 | FP-Norm(final)=2.746 | 3859.6 samples/s | 60.3 steps/s
[Step=30100 Epoch=29.4] | Loss=0.00846 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.431 | FP-Norm(final)=2.746 | 3844.4 samples/s | 60.1 steps/s
[Step=30150 Epoch=29.4] | Loss=0.00852 | Reg=0.00019 | acc=0.9688 | FP-Norm=0.431 | FP-Norm(final)=2.747 | 3860.6 samples/s | 60.3 steps/s
[Step=30200 Epoch=29.5] | Loss=0.00835 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.432 | FP-Norm(final)=2.748 | 3845.4 samples/s | 60.1 steps/s
[Step=30250 Epoch=29.5] | Loss=0.00839 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.434 | FP-Norm(final)=2.748 | 3873.0 samples/s | 60.5 steps/s
[Step=30300 Epoch=29.6] | Loss=0.00838 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=2.749 | 3828.4 samples/s | 59.8 steps/s
[Step=30350 Epoch=29.6] | Loss=0.00849 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.436 | FP-Norm(final)=2.750 | 3870.7 samples/s | 60.5 steps/s
[Step=30400 Epoch=29.7] | Loss=0.00834 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.437 | FP-Norm(final)=2.750 | 3838.8 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step30400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=55.8] | Loss=0.05287 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.735 | 4123.2 samples/s | 64.4 steps/s
[Step=29650 Epoch=55.9] | Loss=0.00250 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=2.736 | 3531.1 samples/s | 55.2 steps/s
[Step=29700 Epoch=56.0] | Loss=0.00125 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=2.736 | 3624.1 samples/s | 56.6 steps/s
[Step=29750 Epoch=56.1] | Loss=0.00084 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.487 | FP-Norm(final)=2.736 | 3640.3 samples/s | 56.9 steps/s
[Step=29800 Epoch=56.2] | Loss=0.00064 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.484 | FP-Norm(final)=2.736 | 3633.3 samples/s | 56.8 steps/s
[Step=29850 Epoch=56.3] | Loss=0.00052 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=2.736 | 3627.8 samples/s | 56.7 steps/s
[Step=29900 Epoch=56.4] | Loss=0.00043 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=2.736 | 3647.9 samples/s | 57.0 steps/s
[Step=29950 Epoch=56.5] | Loss=0.00038 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.472 | FP-Norm(final)=2.736 | 3677.5 samples/s | 57.5 steps/s
[Step=30000 Epoch=56.6] | Loss=0.00033 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.468 | FP-Norm(final)=2.736 | 3660.6 samples/s | 57.2 steps/s
[Step=30050 Epoch=56.6] | Loss=0.00030 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.736 | 3648.7 samples/s | 57.0 steps/s
[Step=30100 Epoch=56.7] | Loss=0.00027 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=2.736 | 3670.8 samples/s | 57.4 steps/s
[Step=30150 Epoch=56.8] | Loss=0.00025 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=2.736 | 1925.5 samples/s | 30.1 steps/s
[Step=30200 Epoch=56.9] | Loss=0.00023 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.736 | 3671.8 samples/s | 57.4 steps/s
[Step=30250 Epoch=57.0] | Loss=0.00021 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.449 | FP-Norm(final)=2.736 | 3659.3 samples/s | 57.2 steps/s
[Step=30300 Epoch=57.1] | Loss=0.00019 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.736 | 3636.6 samples/s | 56.8 steps/s
[Step=30350 Epoch=57.2] | Loss=0.00018 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.737 | 3717.0 samples/s | 58.1 steps/s
[Step=30400 Epoch=57.3] | Loss=0.00017 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.737 | 3639.6 samples/s | 56.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17277 | acc=0.9064 | tpr=0.8712 | fpr=0.0171 | 3944.8 samples/s | 15.4 steps/s
Avg test loss: 0.17855, Avg test acc: 0.90348, Avg tpr: 0.86740, Avg fpr: 0.01718, total FA: 134

Testing server on iccad2012
[Step=  50] | Loss=0.54987 | acc=0.8362 | tpr=0.9602 | fpr=0.1661 | 3603.6 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.54685 | acc=0.8426 | tpr=0.9765 | fpr=0.1599 | 6406.3 samples/s | 25.0 steps/s
[Step= 150] | Loss=0.55579 | acc=0.8411 | tpr=0.9813 | fpr=0.1615 | 6561.4 samples/s | 25.6 steps/s
[Step= 200] | Loss=0.54972 | acc=0.8428 | tpr=0.9836 | fpr=0.1597 | 6723.9 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.54785 | acc=0.8434 | tpr=0.9817 | fpr=0.1591 | 7205.9 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.55114 | acc=0.8434 | tpr=0.9818 | fpr=0.1592 | 7197.0 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.55105 | acc=0.8436 | tpr=0.9806 | fpr=0.1589 | 7312.3 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.55352 | acc=0.8436 | tpr=0.9798 | fpr=0.1589 | 7056.7 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.55694 | acc=0.8437 | tpr=0.9786 | fpr=0.1588 | 7057.4 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.55556 | acc=0.8433 | tpr=0.9802 | fpr=0.1592 | 7136.8 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.55409 | acc=0.8434 | tpr=0.9797 | fpr=0.1591 | 13006.3 samples/s | 50.8 steps/s
Avg test loss: 0.55445, Avg test acc: 0.84342, Avg tpr: 0.97979, Avg fpr: 0.15906, total FA: 22085

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=29.7] | Loss=0.07657 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.747 | 4093.5 samples/s | 64.0 steps/s
[Step=30450 Epoch=29.7] | Loss=0.01161 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.324 | FP-Norm(final)=2.749 | 3681.3 samples/s | 57.5 steps/s
[Step=30500 Epoch=29.8] | Loss=0.00906 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.354 | FP-Norm(final)=2.751 | 3908.6 samples/s | 61.1 steps/s
[Step=30550 Epoch=29.8] | Loss=0.00868 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=2.753 | 3925.5 samples/s | 61.3 steps/s
[Step=30600 Epoch=29.9] | Loss=0.00852 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.754 | 3937.7 samples/s | 61.5 steps/s
[Step=30650 Epoch=29.9] | Loss=0.00818 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=2.755 | 3961.8 samples/s | 61.9 steps/s
[Step=30700 Epoch=30.0] | Loss=0.00786 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.756 | 3915.8 samples/s | 61.2 steps/s
[Step=30750 Epoch=30.0] | Loss=0.00790 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=2.757 | 3925.4 samples/s | 61.3 steps/s
[Step=30800 Epoch=30.1] | Loss=0.00790 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.758 | 3937.3 samples/s | 61.5 steps/s
[Step=30850 Epoch=30.1] | Loss=0.00769 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.400 | FP-Norm(final)=2.759 | 3865.8 samples/s | 60.4 steps/s
[Step=30900 Epoch=30.2] | Loss=0.00776 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.759 | 3873.6 samples/s | 60.5 steps/s
[Step=30950 Epoch=30.2] | Loss=0.00790 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.760 | 3926.8 samples/s | 61.4 steps/s
[Step=31000 Epoch=30.3] | Loss=0.00775 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.761 | 3869.0 samples/s | 60.5 steps/s
[Step=31050 Epoch=30.3] | Loss=0.00786 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.761 | 3843.8 samples/s | 60.1 steps/s
[Step=31100 Epoch=30.4] | Loss=0.00782 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.762 | 3885.5 samples/s | 60.7 steps/s
[Step=31150 Epoch=30.4] | Loss=0.00772 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=2.763 | 3917.3 samples/s | 61.2 steps/s
[Step=31200 Epoch=30.5] | Loss=0.00776 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.413 | FP-Norm(final)=2.763 | 3848.7 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step31200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=57.3] | Loss=0.07772 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.746 | 4343.7 samples/s | 67.9 steps/s
[Step=30450 Epoch=57.4] | Loss=0.00525 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.611 | FP-Norm(final)=2.745 | 3460.6 samples/s | 54.1 steps/s
[Step=30500 Epoch=57.5] | Loss=0.00263 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.634 | FP-Norm(final)=2.745 | 3711.1 samples/s | 58.0 steps/s
[Step=30550 Epoch=57.6] | Loss=0.00175 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.627 | FP-Norm(final)=2.745 | 3665.0 samples/s | 57.3 steps/s
[Step=30600 Epoch=57.7] | Loss=0.00132 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.617 | FP-Norm(final)=2.745 | 3639.3 samples/s | 56.9 steps/s
[Step=30650 Epoch=57.8] | Loss=0.00105 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.606 | FP-Norm(final)=2.745 | 3671.8 samples/s | 57.4 steps/s
[Step=30700 Epoch=57.9] | Loss=0.00088 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.745 | 3639.9 samples/s | 56.9 steps/s
[Step=30750 Epoch=58.0] | Loss=0.00076 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.586 | FP-Norm(final)=2.745 | 3641.8 samples/s | 56.9 steps/s
[Step=30800 Epoch=58.1] | Loss=0.00066 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=2.745 | 3668.4 samples/s | 57.3 steps/s
[Step=30850 Epoch=58.2] | Loss=0.00059 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.745 | 3609.0 samples/s | 56.4 steps/s
[Step=30900 Epoch=58.2] | Loss=0.00053 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.745 | 3669.1 samples/s | 57.3 steps/s
[Step=30950 Epoch=58.3] | Loss=0.00048 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.745 | 1874.8 samples/s | 29.3 steps/s
[Step=31000 Epoch=58.4] | Loss=0.00044 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.745 | 3690.3 samples/s | 57.7 steps/s
[Step=31050 Epoch=58.5] | Loss=0.00041 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.745 | 3692.9 samples/s | 57.7 steps/s
[Step=31100 Epoch=58.6] | Loss=0.00038 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.745 | 3704.5 samples/s | 57.9 steps/s
[Step=31150 Epoch=58.7] | Loss=0.00036 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.745 | 3752.0 samples/s | 58.6 steps/s
[Step=31200 Epoch=58.8] | Loss=0.00034 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=2.745 | 3694.3 samples/s | 57.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18829 | acc=0.8985 | tpr=0.8599 | fpr=0.0176 | 3968.4 samples/s | 15.5 steps/s
Avg test loss: 0.19476, Avg test acc: 0.89603, Avg tpr: 0.85621, Avg fpr: 0.01641, total FA: 128

Testing server on iccad2012
[Step=  50] | Loss=0.51791 | acc=0.8506 | tpr=0.9602 | fpr=0.1513 | 3969.8 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.51784 | acc=0.8552 | tpr=0.9765 | fpr=0.1471 | 7315.3 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.52595 | acc=0.8547 | tpr=0.9827 | fpr=0.1476 | 7123.8 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.51962 | acc=0.8563 | tpr=0.9847 | fpr=0.1460 | 7049.2 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.51858 | acc=0.8570 | tpr=0.9825 | fpr=0.1453 | 7192.8 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.52161 | acc=0.8572 | tpr=0.9825 | fpr=0.1451 | 7329.2 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.52184 | acc=0.8575 | tpr=0.9812 | fpr=0.1447 | 7249.8 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.52411 | acc=0.8574 | tpr=0.9803 | fpr=0.1448 | 7082.6 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.52759 | acc=0.8573 | tpr=0.9791 | fpr=0.1449 | 7267.3 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.52615 | acc=0.8570 | tpr=0.9806 | fpr=0.1452 | 6999.4 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.52459 | acc=0.8572 | tpr=0.9797 | fpr=0.1451 | 13438.6 samples/s | 52.5 steps/s
Avg test loss: 0.52490, Avg test acc: 0.85720, Avg tpr: 0.97979, Avg fpr: 0.14503, total FA: 20137

server round 39/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=30.5] | Loss=0.04241 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.759 | 4074.5 samples/s | 63.7 steps/s
[Step=31250 Epoch=30.5] | Loss=0.01826 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.760 | 3729.7 samples/s | 58.3 steps/s
[Step=31300 Epoch=30.6] | Loss=0.01287 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.761 | 3931.4 samples/s | 61.4 steps/s
[Step=31350 Epoch=30.6] | Loss=0.01105 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.444 | FP-Norm(final)=2.761 | 3891.4 samples/s | 60.8 steps/s
[Step=31400 Epoch=30.7] | Loss=0.00993 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.762 | 3901.5 samples/s | 61.0 steps/s
[Step=31450 Epoch=30.7] | Loss=0.00943 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.446 | FP-Norm(final)=2.763 | 3917.1 samples/s | 61.2 steps/s
[Step=31500 Epoch=30.8] | Loss=0.00886 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=2.764 | 3916.0 samples/s | 61.2 steps/s
[Step=31550 Epoch=30.8] | Loss=0.00888 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.446 | FP-Norm(final)=2.765 | 3932.2 samples/s | 61.4 steps/s
[Step=31600 Epoch=30.9] | Loss=0.00844 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=2.766 | 3934.0 samples/s | 61.5 steps/s
[Step=31650 Epoch=30.9] | Loss=0.00834 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.446 | FP-Norm(final)=2.767 | 3949.3 samples/s | 61.7 steps/s
[Step=31700 Epoch=30.9] | Loss=0.00838 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.446 | FP-Norm(final)=2.767 | 3931.6 samples/s | 61.4 steps/s
[Step=31750 Epoch=31.0] | Loss=0.00858 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=2.768 | 3968.8 samples/s | 62.0 steps/s
[Step=31800 Epoch=31.0] | Loss=0.00840 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.446 | FP-Norm(final)=2.769 | 3928.4 samples/s | 61.4 steps/s
[Step=31850 Epoch=31.1] | Loss=0.00827 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=2.769 | 3939.1 samples/s | 61.5 steps/s
[Step=31900 Epoch=31.1] | Loss=0.00819 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.446 | FP-Norm(final)=2.770 | 3927.3 samples/s | 61.4 steps/s
[Step=31950 Epoch=31.2] | Loss=0.00800 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.446 | FP-Norm(final)=2.771 | 3842.0 samples/s | 60.0 steps/s
[Step=32000 Epoch=31.2] | Loss=0.00799 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.446 | FP-Norm(final)=2.771 | 3844.0 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step32000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=58.8] | Loss=0.06583 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.759 | 4070.1 samples/s | 63.6 steps/s
[Step=31250 Epoch=58.9] | Loss=0.00631 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=2.755 | 3533.6 samples/s | 55.2 steps/s
[Step=31300 Epoch=59.0] | Loss=0.00322 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.622 | FP-Norm(final)=2.755 | 3721.7 samples/s | 58.2 steps/s
[Step=31350 Epoch=59.1] | Loss=0.00215 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.619 | FP-Norm(final)=2.755 | 3649.5 samples/s | 57.0 steps/s
[Step=31400 Epoch=59.2] | Loss=0.00162 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.610 | FP-Norm(final)=2.755 | 3638.3 samples/s | 56.8 steps/s
[Step=31450 Epoch=59.3] | Loss=0.00130 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.602 | FP-Norm(final)=2.755 | 3658.4 samples/s | 57.2 steps/s
[Step=31500 Epoch=59.4] | Loss=0.00109 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=2.755 | 3627.9 samples/s | 56.7 steps/s
[Step=31550 Epoch=59.5] | Loss=0.00094 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=2.755 | 3667.3 samples/s | 57.3 steps/s
[Step=31600 Epoch=59.6] | Loss=0.00083 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.580 | FP-Norm(final)=2.755 | 3665.8 samples/s | 57.3 steps/s
[Step=31650 Epoch=59.7] | Loss=0.00074 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=2.755 | 3647.3 samples/s | 57.0 steps/s
[Step=31700 Epoch=59.8] | Loss=0.00066 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.756 | 3677.8 samples/s | 57.5 steps/s
[Step=31750 Epoch=59.8] | Loss=0.00060 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.756 | 1884.1 samples/s | 29.4 steps/s
[Step=31800 Epoch=59.9] | Loss=0.00055 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.553 | FP-Norm(final)=2.756 | 3773.6 samples/s | 59.0 steps/s
[Step=31850 Epoch=60.0] | Loss=0.00051 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.756 | 3722.9 samples/s | 58.2 steps/s
[Step=31900 Epoch=60.1] | Loss=0.00048 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.756 | 3744.9 samples/s | 58.5 steps/s
[Step=31950 Epoch=60.2] | Loss=0.00045 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.756 | 3697.6 samples/s | 57.8 steps/s
[Step=32000 Epoch=60.3] | Loss=0.00042 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.756 | 3713.2 samples/s | 58.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19439 | acc=0.8924 | tpr=0.8500 | fpr=0.0154 | 3924.8 samples/s | 15.3 steps/s
Avg test loss: 0.19998, Avg test acc: 0.89126, Avg tpr: 0.84834, Avg fpr: 0.01436, total FA: 112

Testing server on iccad2012
[Step=  50] | Loss=0.49165 | acc=0.8515 | tpr=0.9602 | fpr=0.1505 | 3932.8 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.49000 | acc=0.8557 | tpr=0.9765 | fpr=0.1466 | 7066.4 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.49763 | acc=0.8549 | tpr=0.9827 | fpr=0.1474 | 7199.5 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.49175 | acc=0.8565 | tpr=0.9847 | fpr=0.1458 | 7035.6 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.49033 | acc=0.8570 | tpr=0.9817 | fpr=0.1453 | 7150.2 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.49376 | acc=0.8569 | tpr=0.9811 | fpr=0.1454 | 7235.9 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.49394 | acc=0.8572 | tpr=0.9793 | fpr=0.1450 | 7147.1 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.49613 | acc=0.8573 | tpr=0.9787 | fpr=0.1449 | 7087.7 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.49933 | acc=0.8573 | tpr=0.9781 | fpr=0.1449 | 7023.4 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.49816 | acc=0.8569 | tpr=0.9797 | fpr=0.1454 | 6936.6 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.49680 | acc=0.8571 | tpr=0.9789 | fpr=0.1451 | 13623.9 samples/s | 53.2 steps/s
Avg test loss: 0.49718, Avg test acc: 0.85712, Avg tpr: 0.97900, Avg fpr: 0.14509, total FA: 20146

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=31.2] | Loss=0.03559 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.770 | 4532.0 samples/s | 70.8 steps/s
[Step=32050 Epoch=31.3] | Loss=0.02047 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.286 | FP-Norm(final)=2.771 | 3768.7 samples/s | 58.9 steps/s
[Step=32100 Epoch=31.3] | Loss=0.01418 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.304 | FP-Norm(final)=2.771 | 3910.1 samples/s | 61.1 steps/s
[Step=32150 Epoch=31.4] | Loss=0.01148 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.314 | FP-Norm(final)=2.772 | 3905.0 samples/s | 61.0 steps/s
[Step=32200 Epoch=31.4] | Loss=0.00999 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.319 | FP-Norm(final)=2.773 | 3907.5 samples/s | 61.1 steps/s
[Step=32250 Epoch=31.5] | Loss=0.00920 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.323 | FP-Norm(final)=2.774 | 3903.0 samples/s | 61.0 steps/s
[Step=32300 Epoch=31.5] | Loss=0.00875 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=2.775 | 3912.4 samples/s | 61.1 steps/s
[Step=32350 Epoch=31.6] | Loss=0.00839 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.330 | FP-Norm(final)=2.776 | 3950.3 samples/s | 61.7 steps/s
[Step=32400 Epoch=31.6] | Loss=0.00808 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.333 | FP-Norm(final)=2.777 | 3918.8 samples/s | 61.2 steps/s
[Step=32450 Epoch=31.7] | Loss=0.00786 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.335 | FP-Norm(final)=2.777 | 3952.7 samples/s | 61.8 steps/s
[Step=32500 Epoch=31.7] | Loss=0.00784 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.336 | FP-Norm(final)=2.778 | 3935.1 samples/s | 61.5 steps/s
[Step=32550 Epoch=31.8] | Loss=0.00777 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.337 | FP-Norm(final)=2.779 | 3875.1 samples/s | 60.5 steps/s
[Step=32600 Epoch=31.8] | Loss=0.00756 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.339 | FP-Norm(final)=2.779 | 3838.1 samples/s | 60.0 steps/s
[Step=32650 Epoch=31.9] | Loss=0.00748 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=2.780 | 3846.7 samples/s | 60.1 steps/s
[Step=32700 Epoch=31.9] | Loss=0.00744 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.341 | FP-Norm(final)=2.780 | 3813.8 samples/s | 59.6 steps/s
[Step=32750 Epoch=32.0] | Loss=0.00733 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.342 | FP-Norm(final)=2.781 | 3862.1 samples/s | 60.3 steps/s
[Step=32800 Epoch=32.0] | Loss=0.00724 | Reg=0.00012 | acc=0.9688 | FP-Norm=0.342 | FP-Norm(final)=2.782 | 3918.5 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step32800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=60.3] | Loss=0.04161 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.770 | 4186.2 samples/s | 65.4 steps/s
[Step=32050 Epoch=60.4] | Loss=0.00627 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=2.771 | 3404.9 samples/s | 53.2 steps/s
[Step=32100 Epoch=60.5] | Loss=0.00319 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.771 | 3675.2 samples/s | 57.4 steps/s
[Step=32150 Epoch=60.6] | Loss=0.00214 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=2.771 | 3751.1 samples/s | 58.6 steps/s
[Step=32200 Epoch=60.7] | Loss=0.00161 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=2.771 | 3703.4 samples/s | 57.9 steps/s
[Step=32250 Epoch=60.8] | Loss=0.00130 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.771 | 3743.5 samples/s | 58.5 steps/s
[Step=32300 Epoch=60.9] | Loss=0.00109 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.771 | 3735.6 samples/s | 58.4 steps/s
[Step=32350 Epoch=61.0] | Loss=0.00093 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.771 | 3624.5 samples/s | 56.6 steps/s
[Step=32400 Epoch=61.1] | Loss=0.00082 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.771 | 3639.5 samples/s | 56.9 steps/s
[Step=32450 Epoch=61.2] | Loss=0.00073 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.771 | 3661.4 samples/s | 57.2 steps/s
[Step=32500 Epoch=61.3] | Loss=0.00066 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=2.771 | 3684.6 samples/s | 57.6 steps/s
[Step=32550 Epoch=61.4] | Loss=0.00060 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=2.771 | 1910.8 samples/s | 29.9 steps/s
[Step=32600 Epoch=61.5] | Loss=0.00055 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=2.771 | 3692.5 samples/s | 57.7 steps/s
[Step=32650 Epoch=61.5] | Loss=0.00051 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=2.771 | 3601.0 samples/s | 56.3 steps/s
[Step=32700 Epoch=61.6] | Loss=0.00048 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=2.771 | 3619.4 samples/s | 56.6 steps/s
[Step=32750 Epoch=61.7] | Loss=0.00045 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.771 | 3639.3 samples/s | 56.9 steps/s
[Step=32800 Epoch=61.8] | Loss=0.00042 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=2.771 | 3635.2 samples/s | 56.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19748 | acc=0.8928 | tpr=0.8502 | fpr=0.0146 | 3967.2 samples/s | 15.5 steps/s
Avg test loss: 0.20306, Avg test acc: 0.89234, Avg tpr: 0.84974, Avg fpr: 0.01397, total FA: 109

Testing server on iccad2012
[Step=  50] | Loss=0.47864 | acc=0.8570 | tpr=0.9602 | fpr=0.1448 | 3967.0 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.47687 | acc=0.8626 | tpr=0.9723 | fpr=0.1395 | 7054.3 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.48411 | acc=0.8622 | tpr=0.9798 | fpr=0.1400 | 7214.6 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.47834 | acc=0.8638 | tpr=0.9825 | fpr=0.1384 | 7101.4 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.47711 | acc=0.8643 | tpr=0.9799 | fpr=0.1378 | 7036.6 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.48036 | acc=0.8642 | tpr=0.9789 | fpr=0.1378 | 7525.4 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.48050 | acc=0.8643 | tpr=0.9775 | fpr=0.1377 | 6883.4 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.48282 | acc=0.8641 | tpr=0.9770 | fpr=0.1380 | 7090.7 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.48593 | acc=0.8641 | tpr=0.9747 | fpr=0.1379 | 7323.0 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.48450 | acc=0.8637 | tpr=0.9762 | fpr=0.1384 | 6926.1 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.48326 | acc=0.8639 | tpr=0.9753 | fpr=0.1381 | 13227.3 samples/s | 51.7 steps/s
Avg test loss: 0.48365, Avg test acc: 0.86393, Avg tpr: 0.97544, Avg fpr: 0.13809, total FA: 19174

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=32.0] | Loss=0.07394 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.781 | 4874.7 samples/s | 76.2 steps/s
[Step=32850 Epoch=32.1] | Loss=0.01810 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.294 | FP-Norm(final)=2.782 | 3534.3 samples/s | 55.2 steps/s
[Step=32900 Epoch=32.1] | Loss=0.01169 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.313 | FP-Norm(final)=2.784 | 3889.1 samples/s | 60.8 steps/s
[Step=32950 Epoch=32.2] | Loss=0.00985 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.315 | FP-Norm(final)=2.784 | 3918.7 samples/s | 61.2 steps/s
[Step=33000 Epoch=32.2] | Loss=0.00884 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.317 | FP-Norm(final)=2.785 | 3828.3 samples/s | 59.8 steps/s
[Step=33050 Epoch=32.3] | Loss=0.00795 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.319 | FP-Norm(final)=2.786 | 3819.9 samples/s | 59.7 steps/s
[Step=33100 Epoch=32.3] | Loss=0.00749 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.320 | FP-Norm(final)=2.787 | 3858.2 samples/s | 60.3 steps/s
[Step=33150 Epoch=32.4] | Loss=0.00734 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.324 | FP-Norm(final)=2.788 | 3817.2 samples/s | 59.6 steps/s
[Step=33200 Epoch=32.4] | Loss=0.00731 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.327 | FP-Norm(final)=2.788 | 3879.0 samples/s | 60.6 steps/s
[Step=33250 Epoch=32.5] | Loss=0.00701 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.329 | FP-Norm(final)=2.789 | 3890.0 samples/s | 60.8 steps/s
[Step=33300 Epoch=32.5] | Loss=0.00679 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.330 | FP-Norm(final)=2.790 | 3944.4 samples/s | 61.6 steps/s
[Step=33350 Epoch=32.6] | Loss=0.00672 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.331 | FP-Norm(final)=2.790 | 3918.5 samples/s | 61.2 steps/s
[Step=33400 Epoch=32.6] | Loss=0.00662 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=2.791 | 3950.7 samples/s | 61.7 steps/s
[Step=33450 Epoch=32.7] | Loss=0.00675 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=2.792 | 3939.4 samples/s | 61.6 steps/s
[Step=33500 Epoch=32.7] | Loss=0.00678 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.335 | FP-Norm(final)=2.792 | 3905.9 samples/s | 61.0 steps/s
[Step=33550 Epoch=32.8] | Loss=0.00674 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.336 | FP-Norm(final)=2.793 | 3894.5 samples/s | 60.9 steps/s
[Step=33600 Epoch=32.8] | Loss=0.00671 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.337 | FP-Norm(final)=2.793 | 3837.4 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step33600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=61.8] | Loss=0.07813 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.781 | 4334.9 samples/s | 67.7 steps/s
[Step=32850 Epoch=61.9] | Loss=0.00668 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.781 | 3325.4 samples/s | 52.0 steps/s
[Step=32900 Epoch=62.0] | Loss=0.00336 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=2.781 | 3656.0 samples/s | 57.1 steps/s
[Step=32950 Epoch=62.1] | Loss=0.00225 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=2.781 | 3698.1 samples/s | 57.8 steps/s
[Step=33000 Epoch=62.2] | Loss=0.00170 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.431 | FP-Norm(final)=2.781 | 3632.2 samples/s | 56.8 steps/s
[Step=33050 Epoch=62.3] | Loss=0.00136 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.781 | 3640.9 samples/s | 56.9 steps/s
[Step=33100 Epoch=62.4] | Loss=0.00114 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=2.781 | 3661.5 samples/s | 57.2 steps/s
[Step=33150 Epoch=62.5] | Loss=0.00098 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.781 | 3664.8 samples/s | 57.3 steps/s
[Step=33200 Epoch=62.6] | Loss=0.00086 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=2.781 | 3646.2 samples/s | 57.0 steps/s
[Step=33250 Epoch=62.7] | Loss=0.00078 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.781 | 3682.2 samples/s | 57.5 steps/s
[Step=33300 Epoch=62.8] | Loss=0.00070 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.781 | 3679.3 samples/s | 57.5 steps/s
[Step=33350 Epoch=62.9] | Loss=0.00064 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.781 | 1875.6 samples/s | 29.3 steps/s
[Step=33400 Epoch=63.0] | Loss=0.00059 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.781 | 3703.0 samples/s | 57.9 steps/s
[Step=33450 Epoch=63.1] | Loss=0.00054 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.781 | 3638.9 samples/s | 56.9 steps/s
[Step=33500 Epoch=63.1] | Loss=0.00051 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.781 | 3620.0 samples/s | 56.6 steps/s
[Step=33550 Epoch=63.2] | Loss=0.00047 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=2.781 | 3627.8 samples/s | 56.7 steps/s
[Step=33600 Epoch=63.3] | Loss=0.00044 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=2.781 | 3624.2 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19512 | acc=0.8959 | tpr=0.8546 | fpr=0.0144 | 3921.8 samples/s | 15.3 steps/s
Avg test loss: 0.20092, Avg test acc: 0.89603, Avg tpr: 0.85499, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.48781 | acc=0.8550 | tpr=0.9602 | fpr=0.1469 | 3911.5 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.48504 | acc=0.8604 | tpr=0.9744 | fpr=0.1418 | 7305.9 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.49249 | acc=0.8599 | tpr=0.9813 | fpr=0.1423 | 7024.0 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.48601 | acc=0.8618 | tpr=0.9836 | fpr=0.1404 | 7047.9 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.48477 | acc=0.8623 | tpr=0.9808 | fpr=0.1398 | 7325.9 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.48801 | acc=0.8623 | tpr=0.9789 | fpr=0.1398 | 7095.4 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.48833 | acc=0.8623 | tpr=0.9775 | fpr=0.1398 | 7135.1 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.49071 | acc=0.8620 | tpr=0.9770 | fpr=0.1401 | 7170.7 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.49397 | acc=0.8618 | tpr=0.9747 | fpr=0.1403 | 6967.8 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.49248 | acc=0.8614 | tpr=0.9762 | fpr=0.1407 | 7108.5 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.49138 | acc=0.8615 | tpr=0.9753 | fpr=0.1406 | 12967.2 samples/s | 50.7 steps/s
Avg test loss: 0.49183, Avg test acc: 0.86154, Avg tpr: 0.97544, Avg fpr: 0.14053, total FA: 19513

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=32.8] | Loss=0.13510 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.791 | 4783.6 samples/s | 74.7 steps/s
[Step=33650 Epoch=32.9] | Loss=0.01931 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.282 | FP-Norm(final)=2.792 | 3303.2 samples/s | 51.6 steps/s
[Step=33700 Epoch=32.9] | Loss=0.01313 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.302 | FP-Norm(final)=2.793 | 3824.8 samples/s | 59.8 steps/s
[Step=33750 Epoch=33.0] | Loss=0.01102 | Reg=0.00010 | acc=0.9688 | FP-Norm=0.310 | FP-Norm(final)=2.794 | 3808.5 samples/s | 59.5 steps/s
[Step=33800 Epoch=33.0] | Loss=0.01017 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.316 | FP-Norm(final)=2.794 | 3836.6 samples/s | 59.9 steps/s
[Step=33850 Epoch=33.0] | Loss=0.00927 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.319 | FP-Norm(final)=2.795 | 3902.7 samples/s | 61.0 steps/s
[Step=33900 Epoch=33.1] | Loss=0.00847 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.319 | FP-Norm(final)=2.795 | 3908.8 samples/s | 61.1 steps/s
[Step=33950 Epoch=33.1] | Loss=0.00792 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.320 | FP-Norm(final)=2.796 | 3851.0 samples/s | 60.2 steps/s
[Step=34000 Epoch=33.2] | Loss=0.00770 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.322 | FP-Norm(final)=2.797 | 3826.0 samples/s | 59.8 steps/s
[Step=34050 Epoch=33.2] | Loss=0.00739 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.324 | FP-Norm(final)=2.797 | 3842.4 samples/s | 60.0 steps/s
[Step=34100 Epoch=33.3] | Loss=0.00724 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.324 | FP-Norm(final)=2.798 | 3851.7 samples/s | 60.2 steps/s
[Step=34150 Epoch=33.3] | Loss=0.00707 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.324 | FP-Norm(final)=2.799 | 3816.8 samples/s | 59.6 steps/s
[Step=34200 Epoch=33.4] | Loss=0.00703 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.325 | FP-Norm(final)=2.799 | 3829.5 samples/s | 59.8 steps/s
[Step=34250 Epoch=33.4] | Loss=0.00696 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.325 | FP-Norm(final)=2.800 | 3834.0 samples/s | 59.9 steps/s
[Step=34300 Epoch=33.5] | Loss=0.00689 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.326 | FP-Norm(final)=2.800 | 3844.0 samples/s | 60.1 steps/s
[Step=34350 Epoch=33.5] | Loss=0.00672 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.326 | FP-Norm(final)=2.801 | 3837.4 samples/s | 60.0 steps/s
[Step=34400 Epoch=33.6] | Loss=0.00679 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=2.802 | 3847.0 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step34400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=63.3] | Loss=0.08349 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.791 | 4104.0 samples/s | 64.1 steps/s
[Step=33650 Epoch=63.4] | Loss=0.00813 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.790 | 3553.0 samples/s | 55.5 steps/s
[Step=33700 Epoch=63.5] | Loss=0.00409 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.790 | 3708.2 samples/s | 57.9 steps/s
[Step=33750 Epoch=63.6] | Loss=0.00273 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.790 | 3636.8 samples/s | 56.8 steps/s
[Step=33800 Epoch=63.7] | Loss=0.00206 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.790 | 3635.6 samples/s | 56.8 steps/s
[Step=33850 Epoch=63.8] | Loss=0.00168 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.790 | 3659.2 samples/s | 57.2 steps/s
[Step=33900 Epoch=63.9] | Loss=0.00140 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.790 | 3652.0 samples/s | 57.1 steps/s
[Step=33950 Epoch=64.0] | Loss=0.00121 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=2.790 | 3662.4 samples/s | 57.2 steps/s
[Step=34000 Epoch=64.1] | Loss=0.00106 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=2.790 | 3605.5 samples/s | 56.3 steps/s
[Step=34050 Epoch=64.2] | Loss=0.00095 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=2.790 | 3705.1 samples/s | 57.9 steps/s
[Step=34100 Epoch=64.3] | Loss=0.00085 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=2.790 | 3664.8 samples/s | 57.3 steps/s
[Step=34150 Epoch=64.4] | Loss=0.00078 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.791 | 1926.3 samples/s | 30.1 steps/s
[Step=34200 Epoch=64.5] | Loss=0.00071 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.791 | 3778.3 samples/s | 59.0 steps/s
[Step=34250 Epoch=64.6] | Loss=0.00066 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=2.791 | 3672.9 samples/s | 57.4 steps/s
[Step=34300 Epoch=64.7] | Loss=0.00061 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=2.791 | 3642.4 samples/s | 56.9 steps/s
[Step=34350 Epoch=64.8] | Loss=0.00057 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=2.791 | 3615.8 samples/s | 56.5 steps/s
[Step=34400 Epoch=64.8] | Loss=0.00054 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=2.791 | 3611.9 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18639 | acc=0.9015 | tpr=0.8628 | fpr=0.0146 | 3969.6 samples/s | 15.5 steps/s
Avg test loss: 0.19132, Avg test acc: 0.90099, Avg tpr: 0.86239, Avg fpr: 0.01410, total FA: 110

Testing server on iccad2012
[Step=  50] | Loss=0.48295 | acc=0.8599 | tpr=0.9602 | fpr=0.1419 | 3944.5 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.48206 | acc=0.8644 | tpr=0.9744 | fpr=0.1377 | 7340.0 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.49002 | acc=0.8634 | tpr=0.9813 | fpr=0.1388 | 7009.3 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.48405 | acc=0.8649 | tpr=0.9836 | fpr=0.1373 | 7359.3 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.48293 | acc=0.8654 | tpr=0.9808 | fpr=0.1367 | 6992.6 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.48610 | acc=0.8656 | tpr=0.9804 | fpr=0.1365 | 7109.1 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.48661 | acc=0.8657 | tpr=0.9787 | fpr=0.1364 | 7326.2 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.48913 | acc=0.8654 | tpr=0.9781 | fpr=0.1366 | 7027.0 samples/s | 27.4 steps/s
[Step= 450] | Loss=0.49242 | acc=0.8651 | tpr=0.9752 | fpr=0.1369 | 7218.0 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.49074 | acc=0.8648 | tpr=0.9758 | fpr=0.1372 | 7114.0 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.48977 | acc=0.8649 | tpr=0.9749 | fpr=0.1371 | 12725.8 samples/s | 49.7 steps/s
Avg test loss: 0.49019, Avg test acc: 0.86489, Avg tpr: 0.97504, Avg fpr: 0.13711, total FA: 19038

server round 43/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=33.6] | Loss=0.12734 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.801 | 4155.0 samples/s | 64.9 steps/s
[Step=34450 Epoch=33.6] | Loss=0.02199 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.307 | FP-Norm(final)=2.801 | 3734.0 samples/s | 58.3 steps/s
[Step=34500 Epoch=33.7] | Loss=0.01336 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.321 | FP-Norm(final)=2.802 | 3930.0 samples/s | 61.4 steps/s
[Step=34550 Epoch=33.7] | Loss=0.01105 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.325 | FP-Norm(final)=2.802 | 3891.1 samples/s | 60.8 steps/s
[Step=34600 Epoch=33.8] | Loss=0.00992 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.327 | FP-Norm(final)=2.803 | 3944.8 samples/s | 61.6 steps/s
[Step=34650 Epoch=33.8] | Loss=0.00896 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.328 | FP-Norm(final)=2.804 | 3877.6 samples/s | 60.6 steps/s
[Step=34700 Epoch=33.9] | Loss=0.00831 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.328 | FP-Norm(final)=2.804 | 3811.6 samples/s | 59.6 steps/s
[Step=34750 Epoch=33.9] | Loss=0.00778 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=2.805 | 3837.6 samples/s | 60.0 steps/s
[Step=34800 Epoch=34.0] | Loss=0.00763 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=2.805 | 3865.1 samples/s | 60.4 steps/s
[Step=34850 Epoch=34.0] | Loss=0.00761 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.326 | FP-Norm(final)=2.806 | 3920.5 samples/s | 61.3 steps/s
[Step=34900 Epoch=34.1] | Loss=0.00743 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.325 | FP-Norm(final)=2.806 | 3905.3 samples/s | 61.0 steps/s
[Step=34950 Epoch=34.1] | Loss=0.00728 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.324 | FP-Norm(final)=2.807 | 3916.8 samples/s | 61.2 steps/s
[Step=35000 Epoch=34.2] | Loss=0.00723 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.324 | FP-Norm(final)=2.807 | 3936.3 samples/s | 61.5 steps/s
[Step=35050 Epoch=34.2] | Loss=0.00720 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.325 | FP-Norm(final)=2.808 | 3950.1 samples/s | 61.7 steps/s
[Step=35100 Epoch=34.3] | Loss=0.00707 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.326 | FP-Norm(final)=2.809 | 3954.5 samples/s | 61.8 steps/s
[Step=35150 Epoch=34.3] | Loss=0.00697 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=2.809 | 3915.6 samples/s | 61.2 steps/s
[Step=35200 Epoch=34.4] | Loss=0.00699 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=2.810 | 3831.3 samples/s | 59.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step35200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=64.8] | Loss=0.10579 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.801 | 3859.3 samples/s | 60.3 steps/s
[Step=34450 Epoch=64.9] | Loss=0.00657 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=2.800 | 3507.4 samples/s | 54.8 steps/s
[Step=34500 Epoch=65.0] | Loss=0.00331 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.800 | 3627.7 samples/s | 56.7 steps/s
[Step=34550 Epoch=65.1] | Loss=0.00223 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=2.800 | 3620.5 samples/s | 56.6 steps/s
[Step=34600 Epoch=65.2] | Loss=0.00169 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.800 | 3630.9 samples/s | 56.7 steps/s
[Step=34650 Epoch=65.3] | Loss=0.00135 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.801 | 3582.5 samples/s | 56.0 steps/s
[Step=34700 Epoch=65.4] | Loss=0.00114 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=2.801 | 3654.3 samples/s | 57.1 steps/s
[Step=34750 Epoch=65.5] | Loss=0.00099 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=2.801 | 3638.9 samples/s | 56.9 steps/s
[Step=34800 Epoch=65.6] | Loss=0.00086 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=2.801 | 3611.7 samples/s | 56.4 steps/s
[Step=34850 Epoch=65.7] | Loss=0.00077 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=2.801 | 3667.5 samples/s | 57.3 steps/s
[Step=34900 Epoch=65.8] | Loss=0.00070 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.801 | 3714.6 samples/s | 58.0 steps/s
[Step=34950 Epoch=65.9] | Loss=0.00064 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.801 | 1912.8 samples/s | 29.9 steps/s
[Step=35000 Epoch=66.0] | Loss=0.00059 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.801 | 3747.7 samples/s | 58.6 steps/s
[Step=35050 Epoch=66.1] | Loss=0.00055 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=2.801 | 3706.6 samples/s | 57.9 steps/s
[Step=35100 Epoch=66.2] | Loss=0.00051 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=2.801 | 3727.1 samples/s | 58.2 steps/s
[Step=35150 Epoch=66.3] | Loss=0.00047 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=2.801 | 3651.5 samples/s | 57.1 steps/s
[Step=35200 Epoch=66.4] | Loss=0.00045 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=2.802 | 3612.2 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20615 | acc=0.8929 | tpr=0.8502 | fpr=0.0144 | 3906.2 samples/s | 15.3 steps/s
Avg test loss: 0.21087, Avg test acc: 0.89354, Avg tpr: 0.85126, Avg fpr: 0.01346, total FA: 105

Testing server on iccad2012
[Step=  50] | Loss=0.47714 | acc=0.8620 | tpr=0.9602 | fpr=0.1398 | 3942.3 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.47623 | acc=0.8671 | tpr=0.9723 | fpr=0.1348 | 7145.1 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.48443 | acc=0.8665 | tpr=0.9798 | fpr=0.1356 | 7151.9 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.47880 | acc=0.8681 | tpr=0.9825 | fpr=0.1340 | 7142.4 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.47760 | acc=0.8690 | tpr=0.9799 | fpr=0.1330 | 7068.0 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.48078 | acc=0.8691 | tpr=0.9782 | fpr=0.1329 | 7292.8 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.48147 | acc=0.8690 | tpr=0.9775 | fpr=0.1330 | 7020.2 samples/s | 27.4 steps/s
[Step= 400] | Loss=0.48381 | acc=0.8689 | tpr=0.9765 | fpr=0.1331 | 7167.6 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.48715 | acc=0.8685 | tpr=0.9737 | fpr=0.1334 | 7144.4 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.48560 | acc=0.8684 | tpr=0.9744 | fpr=0.1336 | 7053.6 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.48455 | acc=0.8685 | tpr=0.9737 | fpr=0.1334 | 13603.2 samples/s | 53.1 steps/s
Avg test loss: 0.48494, Avg test acc: 0.86851, Avg tpr: 0.97385, Avg fpr: 0.13340, total FA: 18523

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=34.4] | Loss=0.09248 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.810 | 4198.9 samples/s | 65.6 steps/s
[Step=35250 Epoch=34.4] | Loss=0.02089 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.314 | FP-Norm(final)=2.811 | 3813.9 samples/s | 59.6 steps/s
[Step=35300 Epoch=34.5] | Loss=0.01359 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=2.811 | 3840.1 samples/s | 60.0 steps/s
[Step=35350 Epoch=34.5] | Loss=0.01125 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.344 | FP-Norm(final)=2.812 | 3801.8 samples/s | 59.4 steps/s
[Step=35400 Epoch=34.6] | Loss=0.01022 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.345 | FP-Norm(final)=2.812 | 3909.2 samples/s | 61.1 steps/s
[Step=35450 Epoch=34.6] | Loss=0.00922 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=2.813 | 3890.7 samples/s | 60.8 steps/s
[Step=35500 Epoch=34.7] | Loss=0.00871 | Reg=0.00012 | acc=0.9688 | FP-Norm=0.340 | FP-Norm(final)=2.813 | 3836.5 samples/s | 59.9 steps/s
[Step=35550 Epoch=34.7] | Loss=0.00826 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=2.814 | 3839.1 samples/s | 60.0 steps/s
[Step=35600 Epoch=34.8] | Loss=0.00799 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.340 | FP-Norm(final)=2.814 | 3845.4 samples/s | 60.1 steps/s
[Step=35650 Epoch=34.8] | Loss=0.00765 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=2.815 | 3855.6 samples/s | 60.2 steps/s
[Step=35700 Epoch=34.9] | Loss=0.00731 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=2.815 | 3822.6 samples/s | 59.7 steps/s
[Step=35750 Epoch=34.9] | Loss=0.00729 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.339 | FP-Norm(final)=2.816 | 3857.2 samples/s | 60.3 steps/s
[Step=35800 Epoch=35.0] | Loss=0.00718 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=2.816 | 3845.6 samples/s | 60.1 steps/s
[Step=35850 Epoch=35.0] | Loss=0.00733 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=2.817 | 3806.9 samples/s | 59.5 steps/s
[Step=35900 Epoch=35.1] | Loss=0.00710 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=2.817 | 3840.6 samples/s | 60.0 steps/s
[Step=35950 Epoch=35.1] | Loss=0.00702 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=2.818 | 3855.7 samples/s | 60.2 steps/s
[Step=36000 Epoch=35.1] | Loss=0.00698 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=2.818 | 3840.2 samples/s | 60.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step36000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=66.4] | Loss=0.06935 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.810 | 3834.5 samples/s | 59.9 steps/s
[Step=35250 Epoch=66.4] | Loss=0.00752 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.809 | 3651.0 samples/s | 57.0 steps/s
[Step=35300 Epoch=66.5] | Loss=0.00378 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=2.809 | 3612.6 samples/s | 56.4 steps/s
[Step=35350 Epoch=66.6] | Loss=0.00253 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=2.809 | 3633.9 samples/s | 56.8 steps/s
[Step=35400 Epoch=66.7] | Loss=0.00191 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=2.809 | 3656.5 samples/s | 57.1 steps/s
[Step=35450 Epoch=66.8] | Loss=0.00153 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.809 | 3732.4 samples/s | 58.3 steps/s
[Step=35500 Epoch=66.9] | Loss=0.00128 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.809 | 3710.4 samples/s | 58.0 steps/s
[Step=35550 Epoch=67.0] | Loss=0.00110 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.809 | 3661.9 samples/s | 57.2 steps/s
[Step=35600 Epoch=67.1] | Loss=0.00096 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=2.809 | 3636.1 samples/s | 56.8 steps/s
[Step=35650 Epoch=67.2] | Loss=0.00086 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=2.809 | 3645.6 samples/s | 57.0 steps/s
[Step=35700 Epoch=67.3] | Loss=0.00078 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=2.809 | 3702.2 samples/s | 57.8 steps/s
[Step=35750 Epoch=67.4] | Loss=0.00071 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.809 | 1889.6 samples/s | 29.5 steps/s
[Step=35800 Epoch=67.5] | Loss=0.00065 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=2.809 | 3619.6 samples/s | 56.6 steps/s
[Step=35850 Epoch=67.6] | Loss=0.00060 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=2.809 | 3623.3 samples/s | 56.6 steps/s
[Step=35900 Epoch=67.7] | Loss=0.00056 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.809 | 3655.5 samples/s | 57.1 steps/s
[Step=35950 Epoch=67.8] | Loss=0.00052 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.809 | 3597.0 samples/s | 56.2 steps/s
[Step=36000 Epoch=67.9] | Loss=0.00049 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.809 | 3656.8 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19873 | acc=0.8970 | tpr=0.8565 | fpr=0.0151 | 3963.0 samples/s | 15.5 steps/s
Avg test loss: 0.20330, Avg test acc: 0.89747, Avg tpr: 0.85732, Avg fpr: 0.01423, total FA: 111

Testing server on iccad2012
[Step=  50] | Loss=0.46932 | acc=0.8669 | tpr=0.9602 | fpr=0.1348 | 3949.7 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.47046 | acc=0.8711 | tpr=0.9723 | fpr=0.1308 | 7386.6 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.47936 | acc=0.8703 | tpr=0.9798 | fpr=0.1317 | 6954.0 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.47369 | acc=0.8718 | tpr=0.9825 | fpr=0.1302 | 7066.9 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.47268 | acc=0.8726 | tpr=0.9799 | fpr=0.1294 | 7108.4 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.47589 | acc=0.8728 | tpr=0.9775 | fpr=0.1291 | 7100.9 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.47652 | acc=0.8727 | tpr=0.9768 | fpr=0.1292 | 7220.2 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.47917 | acc=0.8726 | tpr=0.9765 | fpr=0.1292 | 7185.8 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.48256 | acc=0.8725 | tpr=0.9732 | fpr=0.1293 | 6899.3 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.48098 | acc=0.8723 | tpr=0.9740 | fpr=0.1295 | 7179.0 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.47990 | acc=0.8723 | tpr=0.9733 | fpr=0.1296 | 13004.6 samples/s | 50.8 steps/s
Avg test loss: 0.48023, Avg test acc: 0.87231, Avg tpr: 0.97345, Avg fpr: 0.12953, total FA: 17985

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=35.1] | Loss=0.07085 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.817 | 4243.9 samples/s | 66.3 steps/s
[Step=36050 Epoch=35.2] | Loss=0.01474 | Reg=0.00009 | acc=0.9844 | FP-Norm=0.285 | FP-Norm(final)=2.819 | 3690.0 samples/s | 57.7 steps/s
[Step=36100 Epoch=35.2] | Loss=0.01070 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.302 | FP-Norm(final)=2.820 | 3905.6 samples/s | 61.0 steps/s
[Step=36150 Epoch=35.3] | Loss=0.00916 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.304 | FP-Norm(final)=2.821 | 3808.0 samples/s | 59.5 steps/s
[Step=36200 Epoch=35.3] | Loss=0.00837 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.304 | FP-Norm(final)=2.822 | 3807.9 samples/s | 59.5 steps/s
[Step=36250 Epoch=35.4] | Loss=0.00758 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.304 | FP-Norm(final)=2.822 | 3851.4 samples/s | 60.2 steps/s
[Step=36300 Epoch=35.4] | Loss=0.00746 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.306 | FP-Norm(final)=2.823 | 3812.2 samples/s | 59.6 steps/s
[Step=36350 Epoch=35.5] | Loss=0.00722 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.307 | FP-Norm(final)=2.824 | 3811.0 samples/s | 59.5 steps/s
[Step=36400 Epoch=35.5] | Loss=0.00713 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.308 | FP-Norm(final)=2.824 | 3838.6 samples/s | 60.0 steps/s
[Step=36450 Epoch=35.6] | Loss=0.00705 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.310 | FP-Norm(final)=2.825 | 3855.7 samples/s | 60.2 steps/s
[Step=36500 Epoch=35.6] | Loss=0.00692 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.310 | FP-Norm(final)=2.825 | 3849.3 samples/s | 60.1 steps/s
[Step=36550 Epoch=35.7] | Loss=0.00693 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.310 | FP-Norm(final)=2.826 | 3854.4 samples/s | 60.2 steps/s
[Step=36600 Epoch=35.7] | Loss=0.00687 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.311 | FP-Norm(final)=2.826 | 3842.8 samples/s | 60.0 steps/s
[Step=36650 Epoch=35.8] | Loss=0.00683 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.312 | FP-Norm(final)=2.826 | 3847.8 samples/s | 60.1 steps/s
[Step=36700 Epoch=35.8] | Loss=0.00679 | Reg=0.00010 | acc=0.9688 | FP-Norm=0.313 | FP-Norm(final)=2.827 | 3875.8 samples/s | 60.6 steps/s
[Step=36750 Epoch=35.9] | Loss=0.00663 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.314 | FP-Norm(final)=2.827 | 3836.9 samples/s | 60.0 steps/s
[Step=36800 Epoch=35.9] | Loss=0.00654 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.315 | FP-Norm(final)=2.828 | 3853.8 samples/s | 60.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step36800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=67.9] | Loss=0.08668 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.817 | 4405.4 samples/s | 68.8 steps/s
[Step=36050 Epoch=68.0] | Loss=0.00692 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=2.817 | 3445.1 samples/s | 53.8 steps/s
[Step=36100 Epoch=68.0] | Loss=0.00349 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=2.817 | 3733.5 samples/s | 58.3 steps/s
[Step=36150 Epoch=68.1] | Loss=0.00235 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=2.817 | 3638.3 samples/s | 56.8 steps/s
[Step=36200 Epoch=68.2] | Loss=0.00177 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.817 | 3745.8 samples/s | 58.5 steps/s
[Step=36250 Epoch=68.3] | Loss=0.00143 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=2.817 | 3699.5 samples/s | 57.8 steps/s
[Step=36300 Epoch=68.4] | Loss=0.00120 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=2.817 | 3645.3 samples/s | 57.0 steps/s
[Step=36350 Epoch=68.5] | Loss=0.00103 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.817 | 3649.4 samples/s | 57.0 steps/s
[Step=36400 Epoch=68.6] | Loss=0.00091 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=2.817 | 3668.0 samples/s | 57.3 steps/s
[Step=36450 Epoch=68.7] | Loss=0.00081 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=2.817 | 3649.5 samples/s | 57.0 steps/s
[Step=36500 Epoch=68.8] | Loss=0.00073 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=2.817 | 3692.2 samples/s | 57.7 steps/s
[Step=36550 Epoch=68.9] | Loss=0.00066 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=2.817 | 1873.5 samples/s | 29.3 steps/s
[Step=36600 Epoch=69.0] | Loss=0.00061 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.817 | 3700.1 samples/s | 57.8 steps/s
[Step=36650 Epoch=69.1] | Loss=0.00057 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=2.817 | 3602.1 samples/s | 56.3 steps/s
[Step=36700 Epoch=69.2] | Loss=0.00053 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=2.817 | 3607.0 samples/s | 56.4 steps/s
[Step=36750 Epoch=69.3] | Loss=0.00049 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=2.817 | 3642.6 samples/s | 56.9 steps/s
[Step=36800 Epoch=69.4] | Loss=0.00046 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=2.817 | 3652.0 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19936 | acc=0.8982 | tpr=0.8579 | fpr=0.0144 | 4008.1 samples/s | 15.7 steps/s
Avg test loss: 0.20455, Avg test acc: 0.89867, Avg tpr: 0.85872, Avg fpr: 0.01346, total FA: 105

Testing server on iccad2012
[Step=  50] | Loss=0.47924 | acc=0.8641 | tpr=0.9602 | fpr=0.1376 | 4013.7 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.47912 | acc=0.8688 | tpr=0.9723 | fpr=0.1331 | 6907.8 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.48763 | acc=0.8678 | tpr=0.9798 | fpr=0.1343 | 7305.3 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.48189 | acc=0.8691 | tpr=0.9825 | fpr=0.1329 | 7072.2 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.48077 | acc=0.8698 | tpr=0.9790 | fpr=0.1322 | 6899.9 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.48449 | acc=0.8695 | tpr=0.9760 | fpr=0.1325 | 7080.1 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.48474 | acc=0.8694 | tpr=0.9750 | fpr=0.1325 | 5837.0 samples/s | 22.8 steps/s
[Step= 400] | Loss=0.48732 | acc=0.8694 | tpr=0.9748 | fpr=0.1325 | 7148.4 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.49082 | acc=0.8692 | tpr=0.9722 | fpr=0.1327 | 7081.2 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.48928 | acc=0.8690 | tpr=0.9731 | fpr=0.1329 | 5312.3 samples/s | 20.8 steps/s
[Step= 550] | Loss=0.48817 | acc=0.8690 | tpr=0.9725 | fpr=0.1329 | 12259.8 samples/s | 47.9 steps/s
Avg test loss: 0.48852, Avg test acc: 0.86895, Avg tpr: 0.97266, Avg fpr: 0.13294, total FA: 18458

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=35.9] | Loss=0.05393 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.826 | 3987.9 samples/s | 62.3 steps/s
[Step=36850 Epoch=36.0] | Loss=0.01655 | Reg=0.00009 | acc=0.9844 | FP-Norm=0.275 | FP-Norm(final)=2.828 | 3679.8 samples/s | 57.5 steps/s
[Step=36900 Epoch=36.0] | Loss=0.01034 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.292 | FP-Norm(final)=2.829 | 3825.2 samples/s | 59.8 steps/s
[Step=36950 Epoch=36.1] | Loss=0.00956 | Reg=0.00009 | acc=0.9844 | FP-Norm=0.297 | FP-Norm(final)=2.830 | 3799.2 samples/s | 59.4 steps/s
[Step=37000 Epoch=36.1] | Loss=0.00890 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.302 | FP-Norm(final)=2.830 | 3830.5 samples/s | 59.9 steps/s
[Step=37050 Epoch=36.2] | Loss=0.00806 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.302 | FP-Norm(final)=2.831 | 3817.1 samples/s | 59.6 steps/s
[Step=37100 Epoch=36.2] | Loss=0.00747 | Reg=0.00009 | acc=0.9844 | FP-Norm=0.303 | FP-Norm(final)=2.831 | 3871.6 samples/s | 60.5 steps/s
[Step=37150 Epoch=36.3] | Loss=0.00711 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.305 | FP-Norm(final)=2.832 | 3829.3 samples/s | 59.8 steps/s
[Step=37200 Epoch=36.3] | Loss=0.00694 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.306 | FP-Norm(final)=2.832 | 3857.3 samples/s | 60.3 steps/s
[Step=37250 Epoch=36.4] | Loss=0.00685 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.307 | FP-Norm(final)=2.833 | 3893.4 samples/s | 60.8 steps/s
[Step=37300 Epoch=36.4] | Loss=0.00692 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.308 | FP-Norm(final)=2.833 | 3841.0 samples/s | 60.0 steps/s
[Step=37350 Epoch=36.5] | Loss=0.00670 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.308 | FP-Norm(final)=2.834 | 3902.8 samples/s | 61.0 steps/s
[Step=37400 Epoch=36.5] | Loss=0.00655 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.309 | FP-Norm(final)=2.834 | 3923.8 samples/s | 61.3 steps/s
[Step=37450 Epoch=36.6] | Loss=0.00652 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.309 | FP-Norm(final)=2.835 | 3895.1 samples/s | 60.9 steps/s
[Step=37500 Epoch=36.6] | Loss=0.00659 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.309 | FP-Norm(final)=2.835 | 3830.9 samples/s | 59.9 steps/s
[Step=37550 Epoch=36.7] | Loss=0.00660 | Reg=0.00010 | acc=0.9688 | FP-Norm=0.310 | FP-Norm(final)=2.836 | 3832.8 samples/s | 59.9 steps/s
[Step=37600 Epoch=36.7] | Loss=0.00660 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.311 | FP-Norm(final)=2.836 | 3858.3 samples/s | 60.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step37600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=69.4] | Loss=0.07773 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.826 | 4129.5 samples/s | 64.5 steps/s
[Step=36850 Epoch=69.5] | Loss=0.00863 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.825 | 3502.4 samples/s | 54.7 steps/s
[Step=36900 Epoch=69.6] | Loss=0.00434 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=2.825 | 3683.2 samples/s | 57.6 steps/s
[Step=36950 Epoch=69.7] | Loss=0.00290 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=2.825 | 3723.1 samples/s | 58.2 steps/s
[Step=37000 Epoch=69.7] | Loss=0.00218 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.825 | 3642.1 samples/s | 56.9 steps/s
[Step=37050 Epoch=69.8] | Loss=0.00175 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.825 | 3648.5 samples/s | 57.0 steps/s
[Step=37100 Epoch=69.9] | Loss=0.00146 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=2.825 | 3662.4 samples/s | 57.2 steps/s
[Step=37150 Epoch=70.0] | Loss=0.00126 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=2.825 | 3646.4 samples/s | 57.0 steps/s
[Step=37200 Epoch=70.1] | Loss=0.00110 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=2.825 | 3645.1 samples/s | 57.0 steps/s
[Step=37250 Epoch=70.2] | Loss=0.00098 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=2.825 | 3654.0 samples/s | 57.1 steps/s
[Step=37300 Epoch=70.3] | Loss=0.00089 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=2.825 | 3690.5 samples/s | 57.7 steps/s
[Step=37350 Epoch=70.4] | Loss=0.00081 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=2.825 | 1868.9 samples/s | 29.2 steps/s
[Step=37400 Epoch=70.5] | Loss=0.00074 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=2.825 | 3698.9 samples/s | 57.8 steps/s
[Step=37450 Epoch=70.6] | Loss=0.00069 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=2.825 | 3620.0 samples/s | 56.6 steps/s
[Step=37500 Epoch=70.7] | Loss=0.00064 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.826 | 3662.6 samples/s | 57.2 steps/s
[Step=37550 Epoch=70.8] | Loss=0.00060 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=2.826 | 3627.3 samples/s | 56.7 steps/s
[Step=37600 Epoch=70.9] | Loss=0.00056 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=2.826 | 3640.7 samples/s | 56.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18871 | acc=0.9027 | tpr=0.8655 | fpr=0.0164 | 3931.6 samples/s | 15.4 steps/s
Avg test loss: 0.19415, Avg test acc: 0.90216, Avg tpr: 0.86460, Avg fpr: 0.01525, total FA: 119

Testing server on iccad2012
[Step=  50] | Loss=0.48681 | acc=0.8630 | tpr=0.9602 | fpr=0.1387 | 3957.6 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.48748 | acc=0.8670 | tpr=0.9744 | fpr=0.1351 | 7013.6 samples/s | 27.4 steps/s
[Step= 150] | Loss=0.49595 | acc=0.8659 | tpr=0.9798 | fpr=0.1362 | 7259.9 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.49050 | acc=0.8679 | tpr=0.9825 | fpr=0.1342 | 7158.4 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.48940 | acc=0.8685 | tpr=0.9799 | fpr=0.1335 | 5980.4 samples/s | 23.4 steps/s
[Step= 300] | Loss=0.49316 | acc=0.8682 | tpr=0.9775 | fpr=0.1338 | 7807.8 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.49372 | acc=0.8683 | tpr=0.9762 | fpr=0.1336 | 6877.3 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.49616 | acc=0.8682 | tpr=0.9759 | fpr=0.1337 | 7144.5 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.49970 | acc=0.8681 | tpr=0.9727 | fpr=0.1338 | 4980.9 samples/s | 19.5 steps/s
[Step= 500] | Loss=0.49809 | acc=0.8679 | tpr=0.9736 | fpr=0.1340 | 7101.4 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.49697 | acc=0.8680 | tpr=0.9729 | fpr=0.1340 | 13130.9 samples/s | 51.3 steps/s
Avg test loss: 0.49734, Avg test acc: 0.86795, Avg tpr: 0.97306, Avg fpr: 0.13396, total FA: 18600

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=36.7] | Loss=0.03844 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.834 | 4282.1 samples/s | 66.9 steps/s
[Step=37650 Epoch=36.8] | Loss=0.01186 | Reg=0.00006 | acc=1.0000 | FP-Norm=0.234 | FP-Norm(final)=2.836 | 3719.6 samples/s | 58.1 steps/s
[Step=37700 Epoch=36.8] | Loss=0.00838 | Reg=0.00007 | acc=1.0000 | FP-Norm=0.262 | FP-Norm(final)=2.837 | 3814.6 samples/s | 59.6 steps/s
[Step=37750 Epoch=36.9] | Loss=0.00772 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.273 | FP-Norm(final)=2.838 | 3818.2 samples/s | 59.7 steps/s
[Step=37800 Epoch=36.9] | Loss=0.00686 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.279 | FP-Norm(final)=2.838 | 3857.7 samples/s | 60.3 steps/s
[Step=37850 Epoch=37.0] | Loss=0.00670 | Reg=0.00008 | acc=0.9844 | FP-Norm=0.282 | FP-Norm(final)=2.839 | 3818.7 samples/s | 59.7 steps/s
[Step=37900 Epoch=37.0] | Loss=0.00654 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.285 | FP-Norm(final)=2.840 | 3831.3 samples/s | 59.9 steps/s
[Step=37950 Epoch=37.1] | Loss=0.00651 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.287 | FP-Norm(final)=2.840 | 3809.8 samples/s | 59.5 steps/s
[Step=38000 Epoch=37.1] | Loss=0.00645 | Reg=0.00008 | acc=0.9844 | FP-Norm=0.288 | FP-Norm(final)=2.841 | 3891.4 samples/s | 60.8 steps/s
[Step=38050 Epoch=37.1] | Loss=0.00638 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.289 | FP-Norm(final)=2.841 | 3921.6 samples/s | 61.3 steps/s
[Step=38100 Epoch=37.2] | Loss=0.00635 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.291 | FP-Norm(final)=2.842 | 3934.8 samples/s | 61.5 steps/s
[Step=38150 Epoch=37.2] | Loss=0.00643 | Reg=0.00009 | acc=0.9688 | FP-Norm=0.291 | FP-Norm(final)=2.842 | 3938.2 samples/s | 61.5 steps/s
[Step=38200 Epoch=37.3] | Loss=0.00640 | Reg=0.00009 | acc=0.9844 | FP-Norm=0.291 | FP-Norm(final)=2.843 | 3934.8 samples/s | 61.5 steps/s
[Step=38250 Epoch=37.3] | Loss=0.00638 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.293 | FP-Norm(final)=2.843 | 3906.8 samples/s | 61.0 steps/s
[Step=38300 Epoch=37.4] | Loss=0.00625 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.294 | FP-Norm(final)=2.844 | 3873.0 samples/s | 60.5 steps/s
[Step=38350 Epoch=37.4] | Loss=0.00615 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.295 | FP-Norm(final)=2.844 | 3865.1 samples/s | 60.4 steps/s
[Step=38400 Epoch=37.5] | Loss=0.00615 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.296 | FP-Norm(final)=2.845 | 3850.8 samples/s | 60.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step38400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=70.9] | Loss=0.12438 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.834 | 4576.0 samples/s | 71.5 steps/s
[Step=37650 Epoch=71.0] | Loss=0.00876 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.833 | 3279.9 samples/s | 51.2 steps/s
[Step=37700 Epoch=71.1] | Loss=0.00439 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.833 | 3655.8 samples/s | 57.1 steps/s
[Step=37750 Epoch=71.2] | Loss=0.00293 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.833 | 3608.8 samples/s | 56.4 steps/s
[Step=37800 Epoch=71.3] | Loss=0.00220 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.833 | 3633.6 samples/s | 56.8 steps/s
[Step=37850 Epoch=71.3] | Loss=0.00177 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.833 | 3653.1 samples/s | 57.1 steps/s
[Step=37900 Epoch=71.4] | Loss=0.00147 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=2.833 | 3656.6 samples/s | 57.1 steps/s
[Step=37950 Epoch=71.5] | Loss=0.00126 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.833 | 3631.3 samples/s | 56.7 steps/s
[Step=38000 Epoch=71.6] | Loss=0.00111 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.833 | 3666.6 samples/s | 57.3 steps/s
[Step=38050 Epoch=71.7] | Loss=0.00099 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.833 | 3671.9 samples/s | 57.4 steps/s
[Step=38100 Epoch=71.8] | Loss=0.00089 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.833 | 3663.9 samples/s | 57.2 steps/s
[Step=38150 Epoch=71.9] | Loss=0.00081 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=2.833 | 1888.8 samples/s | 29.5 steps/s
[Step=38200 Epoch=72.0] | Loss=0.00074 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=2.833 | 3731.2 samples/s | 58.3 steps/s
[Step=38250 Epoch=72.1] | Loss=0.00069 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=2.833 | 3598.7 samples/s | 56.2 steps/s
[Step=38300 Epoch=72.2] | Loss=0.00064 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.833 | 3628.4 samples/s | 56.7 steps/s
[Step=38350 Epoch=72.3] | Loss=0.00060 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.833 | 3628.3 samples/s | 56.7 steps/s
[Step=38400 Epoch=72.4] | Loss=0.00056 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.833 | 3649.2 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20402 | acc=0.8972 | tpr=0.8568 | fpr=0.0151 | 3954.5 samples/s | 15.4 steps/s
Avg test loss: 0.20990, Avg test acc: 0.89719, Avg tpr: 0.85679, Avg fpr: 0.01397, total FA: 109

Testing server on iccad2012
[Step=  50] | Loss=0.45882 | acc=0.8755 | tpr=0.9602 | fpr=0.1260 | 3919.5 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.46109 | acc=0.8790 | tpr=0.9744 | fpr=0.1228 | 7199.2 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.46999 | acc=0.8776 | tpr=0.9798 | fpr=0.1243 | 6039.8 samples/s | 23.6 steps/s
[Step= 200] | Loss=0.46487 | acc=0.8788 | tpr=0.9825 | fpr=0.1231 | 6203.4 samples/s | 24.2 steps/s
[Step= 250] | Loss=0.46395 | acc=0.8795 | tpr=0.9799 | fpr=0.1224 | 7061.0 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.46744 | acc=0.8794 | tpr=0.9782 | fpr=0.1224 | 7260.0 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.46787 | acc=0.8794 | tpr=0.9768 | fpr=0.1224 | 5635.5 samples/s | 22.0 steps/s
[Step= 400] | Loss=0.47047 | acc=0.8792 | tpr=0.9765 | fpr=0.1225 | 7209.7 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.47385 | acc=0.8792 | tpr=0.9737 | fpr=0.1225 | 7143.5 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.47225 | acc=0.8790 | tpr=0.9744 | fpr=0.1227 | 6908.1 samples/s | 27.0 steps/s
[Step= 550] | Loss=0.47113 | acc=0.8791 | tpr=0.9737 | fpr=0.1227 | 13702.3 samples/s | 53.5 steps/s
Avg test loss: 0.47149, Avg test acc: 0.87908, Avg tpr: 0.97385, Avg fpr: 0.12264, total FA: 17029

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=37.5] | Loss=0.13226 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.842 | 4223.4 samples/s | 66.0 steps/s
[Step=38450 Epoch=37.5] | Loss=0.01856 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.293 | FP-Norm(final)=2.843 | 3554.9 samples/s | 55.5 steps/s
[Step=38500 Epoch=37.6] | Loss=0.01194 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.306 | FP-Norm(final)=2.843 | 3842.4 samples/s | 60.0 steps/s
[Step=38550 Epoch=37.6] | Loss=0.00989 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.311 | FP-Norm(final)=2.844 | 3894.0 samples/s | 60.8 steps/s
[Step=38600 Epoch=37.7] | Loss=0.00873 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.313 | FP-Norm(final)=2.845 | 3896.9 samples/s | 60.9 steps/s
[Step=38650 Epoch=37.7] | Loss=0.00798 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.312 | FP-Norm(final)=2.845 | 3949.0 samples/s | 61.7 steps/s
[Step=38700 Epoch=37.8] | Loss=0.00741 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.311 | FP-Norm(final)=2.846 | 3901.0 samples/s | 61.0 steps/s
[Step=38750 Epoch=37.8] | Loss=0.00698 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.312 | FP-Norm(final)=2.846 | 3959.1 samples/s | 61.9 steps/s
[Step=38800 Epoch=37.9] | Loss=0.00707 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.313 | FP-Norm(final)=2.847 | 3885.8 samples/s | 60.7 steps/s
[Step=38850 Epoch=37.9] | Loss=0.00680 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.314 | FP-Norm(final)=2.848 | 3850.5 samples/s | 60.2 steps/s
[Step=38900 Epoch=38.0] | Loss=0.00681 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.315 | FP-Norm(final)=2.848 | 3826.7 samples/s | 59.8 steps/s
[Step=38950 Epoch=38.0] | Loss=0.00679 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.316 | FP-Norm(final)=2.849 | 3849.1 samples/s | 60.1 steps/s
[Step=39000 Epoch=38.1] | Loss=0.00671 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.316 | FP-Norm(final)=2.849 | 3851.3 samples/s | 60.2 steps/s
[Step=39050 Epoch=38.1] | Loss=0.00673 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.316 | FP-Norm(final)=2.850 | 3818.9 samples/s | 59.7 steps/s
[Step=39100 Epoch=38.2] | Loss=0.00672 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.316 | FP-Norm(final)=2.850 | 3829.8 samples/s | 59.8 steps/s
[Step=39150 Epoch=38.2] | Loss=0.00658 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.316 | FP-Norm(final)=2.850 | 3836.8 samples/s | 59.9 steps/s
[Step=39200 Epoch=38.3] | Loss=0.00651 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.317 | FP-Norm(final)=2.851 | 3829.6 samples/s | 59.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step39200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=72.4] | Loss=0.03440 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.842 | 4146.4 samples/s | 64.8 steps/s
[Step=38450 Epoch=72.5] | Loss=0.00479 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=2.843 | 3476.9 samples/s | 54.3 steps/s
[Step=38500 Epoch=72.6] | Loss=0.00242 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=2.843 | 3621.5 samples/s | 56.6 steps/s
[Step=38550 Epoch=72.7] | Loss=0.00162 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=2.843 | 3639.8 samples/s | 56.9 steps/s
[Step=38600 Epoch=72.8] | Loss=0.00122 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=2.843 | 3600.6 samples/s | 56.3 steps/s
[Step=38650 Epoch=72.9] | Loss=0.00098 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=2.843 | 3633.1 samples/s | 56.8 steps/s
[Step=38700 Epoch=73.0] | Loss=0.00082 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.843 | 3642.2 samples/s | 56.9 steps/s
[Step=38750 Epoch=73.0] | Loss=0.00071 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=2.843 | 3663.1 samples/s | 57.2 steps/s
[Step=38800 Epoch=73.1] | Loss=0.00062 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=2.843 | 3637.6 samples/s | 56.8 steps/s
[Step=38850 Epoch=73.2] | Loss=0.00056 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=2.843 | 3640.7 samples/s | 56.9 steps/s
[Step=38900 Epoch=73.3] | Loss=0.00050 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.843 | 3680.6 samples/s | 57.5 steps/s
[Step=38950 Epoch=73.4] | Loss=0.00046 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=2.843 | 1898.1 samples/s | 29.7 steps/s
[Step=39000 Epoch=73.5] | Loss=0.00042 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=2.843 | 3690.3 samples/s | 57.7 steps/s
[Step=39050 Epoch=73.6] | Loss=0.00039 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=2.843 | 3724.1 samples/s | 58.2 steps/s
[Step=39100 Epoch=73.7] | Loss=0.00036 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=2.843 | 3679.7 samples/s | 57.5 steps/s
[Step=39150 Epoch=73.8] | Loss=0.00034 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=2.843 | 3728.6 samples/s | 58.3 steps/s
[Step=39200 Epoch=73.9] | Loss=0.00032 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.843 | 3727.7 samples/s | 58.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18357 | acc=0.9056 | tpr=0.8699 | fpr=0.0168 | 3926.2 samples/s | 15.3 steps/s
Avg test loss: 0.18842, Avg test acc: 0.90508, Avg tpr: 0.86897, Avg fpr: 0.01551, total FA: 121

Testing server on iccad2012
[Step=  50] | Loss=0.49133 | acc=0.8638 | tpr=0.9602 | fpr=0.1380 | 3933.8 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.49221 | acc=0.8679 | tpr=0.9765 | fpr=0.1341 | 4942.5 samples/s | 19.3 steps/s
[Step= 150] | Loss=0.50157 | acc=0.8671 | tpr=0.9813 | fpr=0.1350 | 7143.1 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.49567 | acc=0.8688 | tpr=0.9836 | fpr=0.1333 | 7164.9 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.49500 | acc=0.8692 | tpr=0.9808 | fpr=0.1328 | 6949.0 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.49833 | acc=0.8692 | tpr=0.9782 | fpr=0.1328 | 6451.8 samples/s | 25.2 steps/s
[Step= 350] | Loss=0.49892 | acc=0.8692 | tpr=0.9768 | fpr=0.1328 | 7161.4 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.50145 | acc=0.8689 | tpr=0.9765 | fpr=0.1331 | 7270.2 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.50487 | acc=0.8687 | tpr=0.9732 | fpr=0.1332 | 6992.0 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.50336 | acc=0.8685 | tpr=0.9749 | fpr=0.1334 | 7152.5 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.50224 | acc=0.8686 | tpr=0.9741 | fpr=0.1334 | 13502.7 samples/s | 52.7 steps/s
Avg test loss: 0.50262, Avg test acc: 0.86857, Avg tpr: 0.97425, Avg fpr: 0.13335, total FA: 18515

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=38.3] | Loss=0.11553 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.851 | 4267.8 samples/s | 66.7 steps/s
[Step=39250 Epoch=38.3] | Loss=0.01453 | Reg=0.00007 | acc=1.0000 | FP-Norm=0.252 | FP-Norm(final)=2.852 | 3722.0 samples/s | 58.2 steps/s
[Step=39300 Epoch=38.4] | Loss=0.01149 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.272 | FP-Norm(final)=2.853 | 3901.3 samples/s | 61.0 steps/s
[Step=39350 Epoch=38.4] | Loss=0.01027 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.279 | FP-Norm(final)=2.853 | 3896.5 samples/s | 60.9 steps/s
[Step=39400 Epoch=38.5] | Loss=0.00919 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.281 | FP-Norm(final)=2.854 | 3856.7 samples/s | 60.3 steps/s
[Step=39450 Epoch=38.5] | Loss=0.00835 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.282 | FP-Norm(final)=2.854 | 3818.6 samples/s | 59.7 steps/s
[Step=39500 Epoch=38.6] | Loss=0.00791 | Reg=0.00008 | acc=0.9844 | FP-Norm=0.283 | FP-Norm(final)=2.855 | 3827.9 samples/s | 59.8 steps/s
[Step=39550 Epoch=38.6] | Loss=0.00749 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.285 | FP-Norm(final)=2.855 | 3830.3 samples/s | 59.8 steps/s
[Step=39600 Epoch=38.7] | Loss=0.00718 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.286 | FP-Norm(final)=2.856 | 3855.1 samples/s | 60.2 steps/s
[Step=39650 Epoch=38.7] | Loss=0.00707 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.287 | FP-Norm(final)=2.857 | 3847.7 samples/s | 60.1 steps/s
[Step=39700 Epoch=38.8] | Loss=0.00696 | Reg=0.00008 | acc=0.9844 | FP-Norm=0.288 | FP-Norm(final)=2.857 | 3827.3 samples/s | 59.8 steps/s
[Step=39750 Epoch=38.8] | Loss=0.00666 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.289 | FP-Norm(final)=2.858 | 3830.9 samples/s | 59.9 steps/s
[Step=39800 Epoch=38.9] | Loss=0.00662 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.289 | FP-Norm(final)=2.858 | 3823.4 samples/s | 59.7 steps/s
[Step=39850 Epoch=38.9] | Loss=0.00649 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.290 | FP-Norm(final)=2.859 | 3850.6 samples/s | 60.2 steps/s
[Step=39900 Epoch=39.0] | Loss=0.00651 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.290 | FP-Norm(final)=2.859 | 3875.9 samples/s | 60.6 steps/s
[Step=39950 Epoch=39.0] | Loss=0.00648 | Reg=0.00009 | acc=0.9844 | FP-Norm=0.291 | FP-Norm(final)=2.860 | 3824.7 samples/s | 59.8 steps/s
[Step=40000 Epoch=39.1] | Loss=0.00639 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.292 | FP-Norm(final)=2.860 | 3844.1 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_asml1_0/client_state-step40000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=73.9] | Loss=0.10219 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.850 | 4142.7 samples/s | 64.7 steps/s
[Step=39250 Epoch=74.0] | Loss=0.00585 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=2.850 | 3448.7 samples/s | 53.9 steps/s
[Step=39300 Epoch=74.1] | Loss=0.00295 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.850 | 3599.0 samples/s | 56.2 steps/s
[Step=39350 Epoch=74.2] | Loss=0.00198 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.850 | 3659.0 samples/s | 57.2 steps/s
[Step=39400 Epoch=74.3] | Loss=0.00149 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.851 | 3629.8 samples/s | 56.7 steps/s
[Step=39450 Epoch=74.4] | Loss=0.00120 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.851 | 3622.7 samples/s | 56.6 steps/s
[Step=39500 Epoch=74.5] | Loss=0.00102 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=2.851 | 3697.4 samples/s | 57.8 steps/s
[Step=39550 Epoch=74.6] | Loss=0.00087 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.851 | 3729.9 samples/s | 58.3 steps/s
[Step=39600 Epoch=74.6] | Loss=0.00077 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=2.851 | 3748.7 samples/s | 58.6 steps/s
[Step=39650 Epoch=74.7] | Loss=0.00068 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=2.851 | 3714.6 samples/s | 58.0 steps/s
[Step=39700 Epoch=74.8] | Loss=0.00062 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.851 | 3657.2 samples/s | 57.1 steps/s
[Step=39750 Epoch=74.9] | Loss=0.00056 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.851 | 1924.1 samples/s | 30.1 steps/s
[Step=39800 Epoch=75.0] | Loss=0.00052 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=2.851 | 3781.3 samples/s | 59.1 steps/s
[Step=39850 Epoch=75.1] | Loss=0.00048 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=2.851 | 3710.9 samples/s | 58.0 steps/s
[Step=39900 Epoch=75.2] | Loss=0.00044 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=2.851 | 3727.6 samples/s | 58.2 steps/s
[Step=39950 Epoch=75.3] | Loss=0.00041 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.851 | 3730.6 samples/s | 58.3 steps/s
[Step=40000 Epoch=75.4] | Loss=0.00039 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=2.851 | 3739.1 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19543 | acc=0.9023 | tpr=0.8644 | fpr=0.0156 | 4003.6 samples/s | 15.6 steps/s
Avg test loss: 0.20026, Avg test acc: 0.90151, Avg tpr: 0.86338, Avg fpr: 0.01461, total FA: 114

Testing server on iccad2012
[Step=  50] | Loss=0.45297 | acc=0.8781 | tpr=0.9602 | fpr=0.1233 | 3915.7 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.45582 | acc=0.8816 | tpr=0.9765 | fpr=0.1202 | 7129.0 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.46472 | acc=0.8802 | tpr=0.9813 | fpr=0.1217 | 7206.7 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.45943 | acc=0.8814 | tpr=0.9836 | fpr=0.1205 | 4406.3 samples/s | 17.2 steps/s
[Step= 250] | Loss=0.45878 | acc=0.8821 | tpr=0.9808 | fpr=0.1197 | 7182.6 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.46221 | acc=0.8818 | tpr=0.9775 | fpr=0.1199 | 7243.7 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.46249 | acc=0.8818 | tpr=0.9768 | fpr=0.1200 | 7276.7 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.46512 | acc=0.8816 | tpr=0.9765 | fpr=0.1201 | 7100.2 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.46866 | acc=0.8812 | tpr=0.9732 | fpr=0.1204 | 7023.4 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.46696 | acc=0.8811 | tpr=0.9744 | fpr=0.1206 | 7192.8 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.46583 | acc=0.8811 | tpr=0.9741 | fpr=0.1206 | 13011.5 samples/s | 50.8 steps/s
Avg test loss: 0.46615, Avg test acc: 0.88112, Avg tpr: 0.97425, Avg fpr: 0.12057, total FA: 16741
