#clients of iccad2012: 2
#clients of asml1: 2
select ratio: 1.0
Total num clients: 4
client model path: ['models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0', 'models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1', 'models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0', 'models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32814, 144, 32)
Using transform option: train
#pos = 17102, #neg = 15712
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32737, 144, 32)
Using transform option: train
#pos = 17179, #neg = 15558
loading data into the main memory...
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16703, 144, 32)
Using transform option: train
#pos = 8134, #neg = 8569
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16626, 144, 32)
Using transform option: train
#pos = 8099, #neg = 8527
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34572 | Reg=0.00000 | acc=0.5312 | FP-Norm=0.000 | FP-Norm(final)=2.060 | 2632.8 samples/s | 41.1 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.29700 | Reg=0.00187 | acc=0.7812 | FP-Norm=1.286 | FP-Norm(final)=2.054 | 3988.5 samples/s | 62.3 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.25168 | Reg=0.00351 | acc=0.6875 | FP-Norm=1.772 | FP-Norm(final)=2.067 | 3846.5 samples/s | 60.1 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.22424 | Reg=0.00488 | acc=0.8594 | FP-Norm=2.102 | FP-Norm(final)=2.076 | 3905.6 samples/s | 61.0 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.20127 | Reg=0.00604 | acc=0.9219 | FP-Norm=2.348 | FP-Norm(final)=2.085 | 3917.8 samples/s | 61.2 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.18749 | Reg=0.00703 | acc=0.9375 | FP-Norm=2.541 | FP-Norm(final)=2.092 | 3880.6 samples/s | 60.6 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.17549 | Reg=0.00789 | acc=0.8594 | FP-Norm=2.700 | FP-Norm(final)=2.099 | 3981.2 samples/s | 62.2 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.16822 | Reg=0.00867 | acc=0.9375 | FP-Norm=2.836 | FP-Norm(final)=2.104 | 3997.2 samples/s | 62.5 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.16108 | Reg=0.00938 | acc=0.8750 | FP-Norm=2.955 | FP-Norm(final)=2.109 | 4014.4 samples/s | 62.7 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.15474 | Reg=0.01002 | acc=0.9375 | FP-Norm=3.058 | FP-Norm(final)=2.113 | 3986.9 samples/s | 62.3 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.14912 | Reg=0.01059 | acc=0.9375 | FP-Norm=3.149 | FP-Norm(final)=2.116 | 4623.8 samples/s | 72.2 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.14274 | Reg=0.01113 | acc=0.9375 | FP-Norm=3.232 | FP-Norm(final)=2.121 | 1696.6 samples/s | 26.5 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.13852 | Reg=0.01163 | acc=0.9688 | FP-Norm=3.308 | FP-Norm(final)=2.125 | 3927.0 samples/s | 61.4 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.13396 | Reg=0.01216 | acc=0.9062 | FP-Norm=3.384 | FP-Norm(final)=2.130 | 3899.4 samples/s | 60.9 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.12968 | Reg=0.01265 | acc=0.9375 | FP-Norm=3.455 | FP-Norm(final)=2.134 | 3892.6 samples/s | 60.8 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.12589 | Reg=0.01310 | acc=0.9375 | FP-Norm=3.518 | FP-Norm(final)=2.138 | 3911.3 samples/s | 61.1 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.12226 | Reg=0.01354 | acc=0.9688 | FP-Norm=3.578 | FP-Norm(final)=2.143 | 3893.0 samples/s | 60.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34346 | Reg=0.00000 | acc=0.5312 | FP-Norm=0.000 | FP-Norm(final)=2.060 | 3601.5 samples/s | 56.3 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.30898 | Reg=0.00182 | acc=0.8125 | FP-Norm=1.261 | FP-Norm(final)=2.047 | 3978.9 samples/s | 62.2 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.26009 | Reg=0.00344 | acc=0.8906 | FP-Norm=1.752 | FP-Norm(final)=2.056 | 4014.3 samples/s | 62.7 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.23505 | Reg=0.00480 | acc=0.8750 | FP-Norm=2.080 | FP-Norm(final)=2.066 | 4016.5 samples/s | 62.8 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.21670 | Reg=0.00603 | acc=0.8906 | FP-Norm=2.339 | FP-Norm(final)=2.074 | 4013.3 samples/s | 62.7 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.20108 | Reg=0.00717 | acc=0.9531 | FP-Norm=2.556 | FP-Norm(final)=2.083 | 4051.0 samples/s | 63.3 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.18884 | Reg=0.00817 | acc=0.9219 | FP-Norm=2.735 | FP-Norm(final)=2.091 | 3932.3 samples/s | 61.4 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.17804 | Reg=0.00904 | acc=0.8750 | FP-Norm=2.883 | FP-Norm(final)=2.098 | 3920.8 samples/s | 61.3 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.16953 | Reg=0.00983 | acc=0.9375 | FP-Norm=3.013 | FP-Norm(final)=2.106 | 3908.8 samples/s | 61.1 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.16281 | Reg=0.01058 | acc=0.9375 | FP-Norm=3.130 | FP-Norm(final)=2.112 | 3917.6 samples/s | 61.2 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.15735 | Reg=0.01125 | acc=0.9375 | FP-Norm=3.233 | FP-Norm(final)=2.117 | 4694.0 samples/s | 73.3 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.15063 | Reg=0.01188 | acc=0.9531 | FP-Norm=3.327 | FP-Norm(final)=2.122 | 1715.6 samples/s | 26.8 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.14543 | Reg=0.01248 | acc=0.9375 | FP-Norm=3.413 | FP-Norm(final)=2.128 | 3873.7 samples/s | 60.5 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.13992 | Reg=0.01305 | acc=0.9375 | FP-Norm=3.494 | FP-Norm(final)=2.134 | 3900.6 samples/s | 60.9 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.13567 | Reg=0.01355 | acc=0.9531 | FP-Norm=3.565 | FP-Norm(final)=2.139 | 3854.4 samples/s | 60.2 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.13178 | Reg=0.01404 | acc=0.9531 | FP-Norm=3.631 | FP-Norm(final)=2.144 | 3923.4 samples/s | 61.3 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.12755 | Reg=0.01449 | acc=0.9844 | FP-Norm=3.693 | FP-Norm(final)=2.150 | 3873.5 samples/s | 60.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36253 | Reg=0.00000 | acc=0.5469 | FP-Norm=0.000 | FP-Norm(final)=2.059 | 3507.2 samples/s | 54.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.20718 | Reg=0.00281 | acc=0.9844 | FP-Norm=1.536 | FP-Norm(final)=2.072 | 3764.3 samples/s | 58.8 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.12760 | Reg=0.00509 | acc=0.9688 | FP-Norm=2.124 | FP-Norm(final)=2.097 | 3816.1 samples/s | 59.6 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.09165 | Reg=0.00612 | acc=0.9844 | FP-Norm=2.370 | FP-Norm(final)=2.113 | 3759.1 samples/s | 58.7 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.07111 | Reg=0.00666 | acc=1.0000 | FP-Norm=2.498 | FP-Norm(final)=2.125 | 3708.9 samples/s | 58.0 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.05828 | Reg=0.00698 | acc=1.0000 | FP-Norm=2.572 | FP-Norm(final)=2.137 | 4518.7 samples/s | 70.6 steps/s
[Step= 300 Epoch= 1.1] | Loss=0.04933 | Reg=0.00717 | acc=1.0000 | FP-Norm=2.618 | FP-Norm(final)=2.147 | 1641.0 samples/s | 25.6 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.04252 | Reg=0.00726 | acc=1.0000 | FP-Norm=2.643 | FP-Norm(final)=2.156 | 3659.3 samples/s | 57.2 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.03742 | Reg=0.00728 | acc=1.0000 | FP-Norm=2.653 | FP-Norm(final)=2.165 | 3689.9 samples/s | 57.7 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.03379 | Reg=0.00729 | acc=1.0000 | FP-Norm=2.661 | FP-Norm(final)=2.173 | 3696.3 samples/s | 57.8 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.03166 | Reg=0.00744 | acc=1.0000 | FP-Norm=2.691 | FP-Norm(final)=2.179 | 4047.0 samples/s | 63.2 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.02905 | Reg=0.00765 | acc=1.0000 | FP-Norm=2.729 | FP-Norm(final)=2.185 | 1750.8 samples/s | 27.4 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.02671 | Reg=0.00775 | acc=1.0000 | FP-Norm=2.751 | FP-Norm(final)=2.191 | 3770.4 samples/s | 58.9 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.02472 | Reg=0.00779 | acc=1.0000 | FP-Norm=2.761 | FP-Norm(final)=2.197 | 3823.4 samples/s | 59.7 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.02300 | Reg=0.00779 | acc=1.0000 | FP-Norm=2.761 | FP-Norm(final)=2.202 | 3811.0 samples/s | 59.5 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.02150 | Reg=0.00774 | acc=1.0000 | FP-Norm=2.755 | FP-Norm(final)=2.207 | 3747.5 samples/s | 58.6 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.02024 | Reg=0.00769 | acc=1.0000 | FP-Norm=2.747 | FP-Norm(final)=2.211 | 1791.0 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.38799 | Reg=0.00000 | acc=0.4062 | FP-Norm=0.000 | FP-Norm(final)=2.060 | 3700.2 samples/s | 57.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.21322 | Reg=0.00249 | acc=0.9844 | FP-Norm=1.457 | FP-Norm(final)=2.067 | 3468.5 samples/s | 54.2 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.13011 | Reg=0.00449 | acc=0.9688 | FP-Norm=2.001 | FP-Norm(final)=2.098 | 3699.9 samples/s | 57.8 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.09533 | Reg=0.00563 | acc=1.0000 | FP-Norm=2.271 | FP-Norm(final)=2.118 | 3729.2 samples/s | 58.3 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.07408 | Reg=0.00627 | acc=0.9844 | FP-Norm=2.420 | FP-Norm(final)=2.134 | 3667.0 samples/s | 57.3 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.06192 | Reg=0.00669 | acc=0.9844 | FP-Norm=2.514 | FP-Norm(final)=2.146 | 4603.0 samples/s | 71.9 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.05243 | Reg=0.00704 | acc=1.0000 | FP-Norm=2.588 | FP-Norm(final)=2.156 | 1639.7 samples/s | 25.6 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.04533 | Reg=0.00723 | acc=1.0000 | FP-Norm=2.633 | FP-Norm(final)=2.166 | 3667.0 samples/s | 57.3 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.04003 | Reg=0.00732 | acc=1.0000 | FP-Norm=2.656 | FP-Norm(final)=2.174 | 3728.4 samples/s | 58.3 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.03583 | Reg=0.00738 | acc=1.0000 | FP-Norm=2.673 | FP-Norm(final)=2.182 | 3773.3 samples/s | 59.0 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.03236 | Reg=0.00741 | acc=1.0000 | FP-Norm=2.681 | FP-Norm(final)=2.189 | 4230.5 samples/s | 66.1 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.02949 | Reg=0.00739 | acc=1.0000 | FP-Norm=2.681 | FP-Norm(final)=2.196 | 1727.7 samples/s | 27.0 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.02710 | Reg=0.00733 | acc=1.0000 | FP-Norm=2.674 | FP-Norm(final)=2.202 | 3695.8 samples/s | 57.7 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.02512 | Reg=0.00727 | acc=1.0000 | FP-Norm=2.664 | FP-Norm(final)=2.207 | 3687.2 samples/s | 57.6 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.02355 | Reg=0.00724 | acc=1.0000 | FP-Norm=2.661 | FP-Norm(final)=2.212 | 3703.7 samples/s | 57.9 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.02215 | Reg=0.00726 | acc=1.0000 | FP-Norm=2.667 | FP-Norm(final)=2.217 | 3774.1 samples/s | 59.0 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.02083 | Reg=0.00727 | acc=1.0000 | FP-Norm=2.670 | FP-Norm(final)=2.222 | 1776.8 samples/s | 27.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29542 | acc=0.6843 | tpr=0.5858 | fpr=0.1018 | 3822.3 samples/s | 14.9 steps/s
Avg test loss: 0.29834, Avg test acc: 0.67658, Avg tpr: 0.57924, Avg fpr: 0.10934, total FA: 853

Testing server on iccad2012
[Step=  50] | Loss=0.24380 | acc=0.8187 | tpr=0.8274 | fpr=0.1814 | 3873.4 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.24349 | acc=0.8193 | tpr=0.8401 | fpr=0.1811 | 7303.8 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.24372 | acc=0.8176 | tpr=0.8487 | fpr=0.1829 | 7294.5 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.24401 | acc=0.8178 | tpr=0.8590 | fpr=0.1830 | 7446.8 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.24380 | acc=0.8169 | tpr=0.8620 | fpr=0.1839 | 7057.5 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.24494 | acc=0.8151 | tpr=0.8589 | fpr=0.1857 | 7243.3 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.24546 | acc=0.8141 | tpr=0.8597 | fpr=0.1867 | 7431.8 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.24601 | acc=0.8130 | tpr=0.8561 | fpr=0.1878 | 7333.7 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.24604 | acc=0.8130 | tpr=0.8544 | fpr=0.1877 | 7258.9 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.24585 | acc=0.8132 | tpr=0.8595 | fpr=0.1877 | 7428.6 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.24581 | acc=0.8132 | tpr=0.8623 | fpr=0.1877 | 13303.7 samples/s | 52.0 steps/s
Avg test loss: 0.24575, Avg test acc: 0.81329, Avg tpr: 0.86252, Avg fpr: 0.18760, total FA: 26048

server round 1/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 1.6] | Loss=0.25151 | Reg=0.00000 | acc=0.7656 | FP-Norm=0.000 | FP-Norm(final)=2.237 | 3734.7 samples/s | 58.4 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.15263 | Reg=0.00217 | acc=0.8750 | FP-Norm=1.369 | FP-Norm(final)=2.249 | 3594.8 samples/s | 56.2 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.13576 | Reg=0.00325 | acc=0.9688 | FP-Norm=1.724 | FP-Norm(final)=2.254 | 3974.4 samples/s | 62.1 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.12600 | Reg=0.00387 | acc=0.9219 | FP-Norm=1.903 | FP-Norm(final)=2.258 | 3872.7 samples/s | 60.5 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.11895 | Reg=0.00434 | acc=0.8906 | FP-Norm=2.028 | FP-Norm(final)=2.262 | 3887.5 samples/s | 60.7 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.11299 | Reg=0.00483 | acc=0.9219 | FP-Norm=2.143 | FP-Norm(final)=2.267 | 3903.3 samples/s | 61.0 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.10951 | Reg=0.00526 | acc=0.9844 | FP-Norm=2.240 | FP-Norm(final)=2.271 | 3921.8 samples/s | 61.3 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.10603 | Reg=0.00568 | acc=0.9844 | FP-Norm=2.328 | FP-Norm(final)=2.275 | 3929.4 samples/s | 61.4 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.10313 | Reg=0.00606 | acc=0.9531 | FP-Norm=2.406 | FP-Norm(final)=2.278 | 3896.4 samples/s | 60.9 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.10001 | Reg=0.00642 | acc=0.9531 | FP-Norm=2.477 | FP-Norm(final)=2.281 | 3920.2 samples/s | 61.3 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.09859 | Reg=0.00676 | acc=0.9688 | FP-Norm=2.543 | FP-Norm(final)=2.283 | 4610.8 samples/s | 72.0 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.09477 | Reg=0.00708 | acc=0.9531 | FP-Norm=2.604 | FP-Norm(final)=2.285 | 1648.3 samples/s | 25.8 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.09143 | Reg=0.00738 | acc=0.9531 | FP-Norm=2.660 | FP-Norm(final)=2.288 | 3948.1 samples/s | 61.7 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.08891 | Reg=0.00767 | acc=0.9531 | FP-Norm=2.711 | FP-Norm(final)=2.291 | 4002.5 samples/s | 62.5 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.08666 | Reg=0.00795 | acc=0.9688 | FP-Norm=2.761 | FP-Norm(final)=2.294 | 3992.8 samples/s | 62.4 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.08477 | Reg=0.00823 | acc=1.0000 | FP-Norm=2.809 | FP-Norm(final)=2.296 | 3875.3 samples/s | 60.6 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.08297 | Reg=0.00850 | acc=0.9531 | FP-Norm=2.855 | FP-Norm(final)=2.298 | 3881.3 samples/s | 60.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step1600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 1.6] | Loss=0.28961 | Reg=0.00000 | acc=0.7188 | FP-Norm=0.000 | FP-Norm(final)=2.236 | 3794.4 samples/s | 59.3 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.16759 | Reg=0.00200 | acc=0.8438 | FP-Norm=1.322 | FP-Norm(final)=2.235 | 3712.8 samples/s | 58.0 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.14805 | Reg=0.00305 | acc=0.9375 | FP-Norm=1.672 | FP-Norm(final)=2.238 | 3898.3 samples/s | 60.9 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.13492 | Reg=0.00375 | acc=0.9375 | FP-Norm=1.870 | FP-Norm(final)=2.244 | 3889.8 samples/s | 60.8 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.12895 | Reg=0.00431 | acc=0.8750 | FP-Norm=2.016 | FP-Norm(final)=2.247 | 3882.2 samples/s | 60.7 steps/s
[Step=1050 Epoch= 2.1] | Loss=0.12090 | Reg=0.00479 | acc=0.9062 | FP-Norm=2.129 | FP-Norm(final)=2.252 | 3929.7 samples/s | 61.4 steps/s
[Step=1100 Epoch= 2.2] | Loss=0.11513 | Reg=0.00522 | acc=0.9375 | FP-Norm=2.227 | FP-Norm(final)=2.256 | 3950.1 samples/s | 61.7 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.11144 | Reg=0.00566 | acc=0.9531 | FP-Norm=2.321 | FP-Norm(final)=2.260 | 3903.9 samples/s | 61.0 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.10732 | Reg=0.00609 | acc=0.9531 | FP-Norm=2.408 | FP-Norm(final)=2.264 | 3881.0 samples/s | 60.6 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.10409 | Reg=0.00650 | acc=0.9219 | FP-Norm=2.488 | FP-Norm(final)=2.267 | 3910.2 samples/s | 61.1 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.10169 | Reg=0.00689 | acc=0.9375 | FP-Norm=2.562 | FP-Norm(final)=2.270 | 4679.0 samples/s | 73.1 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.09883 | Reg=0.00726 | acc=0.9531 | FP-Norm=2.629 | FP-Norm(final)=2.272 | 1727.0 samples/s | 27.0 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.09570 | Reg=0.00760 | acc=1.0000 | FP-Norm=2.691 | FP-Norm(final)=2.274 | 4013.0 samples/s | 62.7 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.09287 | Reg=0.00792 | acc=0.9375 | FP-Norm=2.748 | FP-Norm(final)=2.277 | 3975.2 samples/s | 62.1 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.09016 | Reg=0.00823 | acc=0.9219 | FP-Norm=2.801 | FP-Norm(final)=2.280 | 3981.4 samples/s | 62.2 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.08795 | Reg=0.00852 | acc=0.9844 | FP-Norm=2.851 | FP-Norm(final)=2.283 | 4030.1 samples/s | 63.0 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.08663 | Reg=0.00879 | acc=0.9688 | FP-Norm=2.897 | FP-Norm(final)=2.285 | 3983.2 samples/s | 62.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step1600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.1] | Loss=0.21418 | Reg=0.00000 | acc=0.7812 | FP-Norm=0.000 | FP-Norm(final)=2.236 | 3618.1 samples/s | 56.5 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.05164 | Reg=0.00509 | acc=0.9844 | FP-Norm=2.139 | FP-Norm(final)=2.239 | 3688.0 samples/s | 57.6 steps/s
[Step= 900 Epoch= 3.4] | Loss=0.03309 | Reg=0.00577 | acc=0.9844 | FP-Norm=2.339 | FP-Norm(final)=2.242 | 3711.2 samples/s | 58.0 steps/s
[Step= 950 Epoch= 3.6] | Loss=0.02466 | Reg=0.00590 | acc=1.0000 | FP-Norm=2.386 | FP-Norm(final)=2.246 | 3674.8 samples/s | 57.4 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02004 | Reg=0.00589 | acc=0.9844 | FP-Norm=2.396 | FP-Norm(final)=2.251 | 3695.6 samples/s | 57.7 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.01691 | Reg=0.00586 | acc=1.0000 | FP-Norm=2.395 | FP-Norm(final)=2.257 | 4539.6 samples/s | 70.9 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01432 | Reg=0.00581 | acc=1.0000 | FP-Norm=2.388 | FP-Norm(final)=2.261 | 1649.2 samples/s | 25.8 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01231 | Reg=0.00570 | acc=1.0000 | FP-Norm=2.369 | FP-Norm(final)=2.266 | 3719.0 samples/s | 58.1 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01082 | Reg=0.00556 | acc=1.0000 | FP-Norm=2.340 | FP-Norm(final)=2.270 | 3718.8 samples/s | 58.1 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.00977 | Reg=0.00543 | acc=1.0000 | FP-Norm=2.312 | FP-Norm(final)=2.274 | 3694.9 samples/s | 57.7 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00886 | Reg=0.00531 | acc=1.0000 | FP-Norm=2.286 | FP-Norm(final)=2.278 | 4026.4 samples/s | 62.9 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00808 | Reg=0.00519 | acc=1.0000 | FP-Norm=2.260 | FP-Norm(final)=2.281 | 1740.8 samples/s | 27.2 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00742 | Reg=0.00506 | acc=1.0000 | FP-Norm=2.231 | FP-Norm(final)=2.285 | 3804.8 samples/s | 59.4 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00688 | Reg=0.00493 | acc=1.0000 | FP-Norm=2.202 | FP-Norm(final)=2.288 | 3834.0 samples/s | 59.9 steps/s
[Step=1500 Epoch= 5.7] | Loss=0.00641 | Reg=0.00481 | acc=1.0000 | FP-Norm=2.173 | FP-Norm(final)=2.291 | 3829.2 samples/s | 59.8 steps/s
[Step=1550 Epoch= 5.9] | Loss=0.00599 | Reg=0.00469 | acc=1.0000 | FP-Norm=2.144 | FP-Norm(final)=2.294 | 3690.6 samples/s | 57.7 steps/s
[Step=1600 Epoch= 6.1] | Loss=0.00564 | Reg=0.00458 | acc=1.0000 | FP-Norm=2.116 | FP-Norm(final)=2.297 | 1795.1 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step1600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.1] | Loss=0.18249 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.236 | 3802.4 samples/s | 59.4 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.04846 | Reg=0.00509 | acc=1.0000 | FP-Norm=2.145 | FP-Norm(final)=2.246 | 3516.3 samples/s | 54.9 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.03160 | Reg=0.00571 | acc=0.9844 | FP-Norm=2.331 | FP-Norm(final)=2.249 | 3694.2 samples/s | 57.7 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.02474 | Reg=0.00584 | acc=1.0000 | FP-Norm=2.377 | FP-Norm(final)=2.252 | 3736.8 samples/s | 58.4 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02089 | Reg=0.00596 | acc=1.0000 | FP-Norm=2.412 | FP-Norm(final)=2.256 | 3665.4 samples/s | 57.3 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.01732 | Reg=0.00603 | acc=1.0000 | FP-Norm=2.432 | FP-Norm(final)=2.261 | 4593.8 samples/s | 71.8 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01506 | Reg=0.00607 | acc=1.0000 | FP-Norm=2.443 | FP-Norm(final)=2.267 | 1670.1 samples/s | 26.1 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01301 | Reg=0.00604 | acc=1.0000 | FP-Norm=2.440 | FP-Norm(final)=2.272 | 3805.5 samples/s | 59.5 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01144 | Reg=0.00596 | acc=1.0000 | FP-Norm=2.425 | FP-Norm(final)=2.277 | 3803.2 samples/s | 59.4 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01023 | Reg=0.00585 | acc=1.0000 | FP-Norm=2.403 | FP-Norm(final)=2.281 | 3764.2 samples/s | 58.8 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00932 | Reg=0.00574 | acc=1.0000 | FP-Norm=2.381 | FP-Norm(final)=2.285 | 4124.7 samples/s | 64.4 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00858 | Reg=0.00565 | acc=1.0000 | FP-Norm=2.363 | FP-Norm(final)=2.289 | 1730.0 samples/s | 27.0 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00788 | Reg=0.00556 | acc=1.0000 | FP-Norm=2.343 | FP-Norm(final)=2.293 | 3809.8 samples/s | 59.5 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00730 | Reg=0.00545 | acc=1.0000 | FP-Norm=2.320 | FP-Norm(final)=2.296 | 3790.7 samples/s | 59.2 steps/s
[Step=1500 Epoch= 5.8] | Loss=0.00679 | Reg=0.00533 | acc=1.0000 | FP-Norm=2.294 | FP-Norm(final)=2.300 | 3785.0 samples/s | 59.1 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.00640 | Reg=0.00523 | acc=1.0000 | FP-Norm=2.271 | FP-Norm(final)=2.303 | 3872.1 samples/s | 60.5 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.00603 | Reg=0.00514 | acc=1.0000 | FP-Norm=2.251 | FP-Norm(final)=2.306 | 1810.5 samples/s | 28.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33046 | acc=0.7100 | tpr=0.5935 | fpr=0.0369 | 3892.2 samples/s | 15.2 steps/s
Avg test loss: 0.33364, Avg test acc: 0.70639, Avg tpr: 0.58967, Avg fpr: 0.03692, total FA: 288

Testing server on iccad2012
[Step=  50] | Loss=0.23312 | acc=0.8132 | tpr=0.9159 | fpr=0.1886 | 3881.5 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.23203 | acc=0.8159 | tpr=0.9190 | fpr=0.1860 | 7463.4 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.23271 | acc=0.8156 | tpr=0.9236 | fpr=0.1864 | 7139.7 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.23368 | acc=0.8161 | tpr=0.9246 | fpr=0.1859 | 7567.1 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.23229 | acc=0.8161 | tpr=0.9301 | fpr=0.1860 | 7139.6 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.23368 | acc=0.8154 | tpr=0.9338 | fpr=0.1868 | 7412.6 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.23396 | acc=0.8153 | tpr=0.9355 | fpr=0.1869 | 7210.8 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.23448 | acc=0.8152 | tpr=0.9311 | fpr=0.1869 | 7220.2 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.23463 | acc=0.8153 | tpr=0.9299 | fpr=0.1868 | 7064.1 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.23475 | acc=0.8147 | tpr=0.9300 | fpr=0.1874 | 7347.5 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.23489 | acc=0.8144 | tpr=0.9296 | fpr=0.1877 | 13420.1 samples/s | 52.4 steps/s
Avg test loss: 0.23487, Avg test acc: 0.81443, Avg tpr: 0.92987, Avg fpr: 0.18767, total FA: 26057

server round 2/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 3.1] | Loss=0.25317 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.330 | 3332.0 samples/s | 52.1 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.11000 | Reg=0.00147 | acc=0.9375 | FP-Norm=1.148 | FP-Norm(final)=2.324 | 3933.8 samples/s | 61.5 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.09395 | Reg=0.00196 | acc=0.9688 | FP-Norm=1.357 | FP-Norm(final)=2.330 | 3922.9 samples/s | 61.3 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.08763 | Reg=0.00231 | acc=0.9531 | FP-Norm=1.483 | FP-Norm(final)=2.336 | 3890.4 samples/s | 60.8 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.08674 | Reg=0.00267 | acc=0.9375 | FP-Norm=1.596 | FP-Norm(final)=2.339 | 3904.7 samples/s | 61.0 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.08477 | Reg=0.00302 | acc=0.9844 | FP-Norm=1.697 | FP-Norm(final)=2.341 | 3896.8 samples/s | 60.9 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.08269 | Reg=0.00334 | acc=0.9844 | FP-Norm=1.785 | FP-Norm(final)=2.343 | 3902.3 samples/s | 61.0 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.08125 | Reg=0.00364 | acc=0.9688 | FP-Norm=1.862 | FP-Norm(final)=2.345 | 3893.7 samples/s | 60.8 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.07886 | Reg=0.00391 | acc=0.9844 | FP-Norm=1.932 | FP-Norm(final)=2.346 | 3900.7 samples/s | 60.9 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.07735 | Reg=0.00417 | acc=0.9688 | FP-Norm=1.993 | FP-Norm(final)=2.348 | 3925.4 samples/s | 61.3 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.07479 | Reg=0.00441 | acc=0.9688 | FP-Norm=2.050 | FP-Norm(final)=2.350 | 4605.5 samples/s | 72.0 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.07228 | Reg=0.00463 | acc=0.9219 | FP-Norm=2.103 | FP-Norm(final)=2.353 | 1668.9 samples/s | 26.1 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.07003 | Reg=0.00486 | acc=0.9219 | FP-Norm=2.153 | FP-Norm(final)=2.355 | 3886.7 samples/s | 60.7 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.06799 | Reg=0.00507 | acc=0.9531 | FP-Norm=2.200 | FP-Norm(final)=2.357 | 3925.9 samples/s | 61.3 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.06644 | Reg=0.00528 | acc=0.9531 | FP-Norm=2.244 | FP-Norm(final)=2.360 | 3865.8 samples/s | 60.4 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.06572 | Reg=0.00548 | acc=0.9531 | FP-Norm=2.286 | FP-Norm(final)=2.362 | 3891.9 samples/s | 60.8 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.06437 | Reg=0.00567 | acc=0.9062 | FP-Norm=2.327 | FP-Norm(final)=2.364 | 3917.0 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step2400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 3.1] | Loss=0.26141 | Reg=0.00000 | acc=0.7656 | FP-Norm=0.000 | FP-Norm(final)=2.330 | 3813.2 samples/s | 59.6 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.11304 | Reg=0.00178 | acc=0.9375 | FP-Norm=1.269 | FP-Norm(final)=2.317 | 3677.8 samples/s | 57.5 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.09794 | Reg=0.00226 | acc=0.9062 | FP-Norm=1.461 | FP-Norm(final)=2.324 | 3884.1 samples/s | 60.7 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.09400 | Reg=0.00265 | acc=0.9375 | FP-Norm=1.591 | FP-Norm(final)=2.327 | 3906.5 samples/s | 61.0 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.08891 | Reg=0.00300 | acc=0.8906 | FP-Norm=1.696 | FP-Norm(final)=2.330 | 3907.6 samples/s | 61.1 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.08643 | Reg=0.00333 | acc=0.9531 | FP-Norm=1.789 | FP-Norm(final)=2.333 | 3888.3 samples/s | 60.8 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.08407 | Reg=0.00364 | acc=0.9219 | FP-Norm=1.870 | FP-Norm(final)=2.335 | 3921.5 samples/s | 61.3 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.07982 | Reg=0.00394 | acc=0.9531 | FP-Norm=1.946 | FP-Norm(final)=2.338 | 3886.0 samples/s | 60.7 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.07872 | Reg=0.00424 | acc=0.9375 | FP-Norm=2.017 | FP-Norm(final)=2.340 | 3898.4 samples/s | 60.9 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.07657 | Reg=0.00452 | acc=0.9531 | FP-Norm=2.081 | FP-Norm(final)=2.341 | 3909.6 samples/s | 61.1 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.07475 | Reg=0.00477 | acc=0.9375 | FP-Norm=2.138 | FP-Norm(final)=2.342 | 4679.5 samples/s | 73.1 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.07313 | Reg=0.00501 | acc=0.9531 | FP-Norm=2.191 | FP-Norm(final)=2.344 | 1726.5 samples/s | 27.0 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.07131 | Reg=0.00525 | acc=0.9688 | FP-Norm=2.243 | FP-Norm(final)=2.347 | 4005.7 samples/s | 62.6 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.06948 | Reg=0.00547 | acc=0.9531 | FP-Norm=2.290 | FP-Norm(final)=2.349 | 3984.4 samples/s | 62.3 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.06834 | Reg=0.00570 | acc=0.9531 | FP-Norm=2.336 | FP-Norm(final)=2.352 | 3981.0 samples/s | 62.2 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.06716 | Reg=0.00592 | acc=0.9531 | FP-Norm=2.380 | FP-Norm(final)=2.354 | 3966.6 samples/s | 62.0 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.06615 | Reg=0.00612 | acc=0.9844 | FP-Norm=2.421 | FP-Norm(final)=2.356 | 4003.3 samples/s | 62.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step2400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 6.1] | Loss=0.12388 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.331 | 3684.6 samples/s | 57.6 steps/s
[Step=1650 Epoch= 6.3] | Loss=0.03483 | Reg=0.00504 | acc=0.9688 | FP-Norm=2.118 | FP-Norm(final)=2.312 | 3639.9 samples/s | 56.9 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.02042 | Reg=0.00580 | acc=1.0000 | FP-Norm=2.339 | FP-Norm(final)=2.311 | 3754.8 samples/s | 58.7 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.01665 | Reg=0.00588 | acc=1.0000 | FP-Norm=2.379 | FP-Norm(final)=2.315 | 3766.5 samples/s | 58.9 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.01711 | Reg=0.00624 | acc=1.0000 | FP-Norm=2.461 | FP-Norm(final)=2.312 | 3716.2 samples/s | 58.1 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.01476 | Reg=0.00659 | acc=1.0000 | FP-Norm=2.533 | FP-Norm(final)=2.310 | 4542.9 samples/s | 71.0 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.01244 | Reg=0.00669 | acc=1.0000 | FP-Norm=2.558 | FP-Norm(final)=2.311 | 1673.9 samples/s | 26.2 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.01075 | Reg=0.00665 | acc=1.0000 | FP-Norm=2.554 | FP-Norm(final)=2.313 | 3822.0 samples/s | 59.7 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00949 | Reg=0.00655 | acc=1.0000 | FP-Norm=2.537 | FP-Norm(final)=2.316 | 3790.8 samples/s | 59.2 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.00846 | Reg=0.00642 | acc=1.0000 | FP-Norm=2.513 | FP-Norm(final)=2.319 | 3729.9 samples/s | 58.3 steps/s
[Step=2100 Epoch= 8.0] | Loss=0.00763 | Reg=0.00627 | acc=1.0000 | FP-Norm=2.483 | FP-Norm(final)=2.322 | 4010.4 samples/s | 62.7 steps/s
[Step=2150 Epoch= 8.2] | Loss=0.00696 | Reg=0.00611 | acc=1.0000 | FP-Norm=2.451 | FP-Norm(final)=2.325 | 1748.9 samples/s | 27.3 steps/s
[Step=2200 Epoch= 8.4] | Loss=0.00639 | Reg=0.00595 | acc=1.0000 | FP-Norm=2.418 | FP-Norm(final)=2.328 | 3725.3 samples/s | 58.2 steps/s
[Step=2250 Epoch= 8.6] | Loss=0.00591 | Reg=0.00579 | acc=1.0000 | FP-Norm=2.383 | FP-Norm(final)=2.331 | 3696.4 samples/s | 57.8 steps/s
[Step=2300 Epoch= 8.8] | Loss=0.00550 | Reg=0.00564 | acc=1.0000 | FP-Norm=2.349 | FP-Norm(final)=2.333 | 3656.4 samples/s | 57.1 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.00514 | Reg=0.00548 | acc=1.0000 | FP-Norm=2.314 | FP-Norm(final)=2.336 | 3732.5 samples/s | 58.3 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.00483 | Reg=0.00534 | acc=1.0000 | FP-Norm=2.280 | FP-Norm(final)=2.338 | 1801.6 samples/s | 28.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step2400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 6.2] | Loss=0.10415 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.330 | 3637.9 samples/s | 56.8 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.04271 | Reg=0.00507 | acc=1.0000 | FP-Norm=2.135 | FP-Norm(final)=2.305 | 3672.2 samples/s | 57.4 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.02465 | Reg=0.00576 | acc=1.0000 | FP-Norm=2.336 | FP-Norm(final)=2.309 | 3717.1 samples/s | 58.1 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.01880 | Reg=0.00576 | acc=1.0000 | FP-Norm=2.357 | FP-Norm(final)=2.315 | 3705.3 samples/s | 57.9 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.01486 | Reg=0.00570 | acc=1.0000 | FP-Norm=2.356 | FP-Norm(final)=2.320 | 3672.1 samples/s | 57.4 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.01242 | Reg=0.00557 | acc=1.0000 | FP-Norm=2.334 | FP-Norm(final)=2.326 | 4569.7 samples/s | 71.4 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.01084 | Reg=0.00547 | acc=1.0000 | FP-Norm=2.316 | FP-Norm(final)=2.332 | 1662.2 samples/s | 26.0 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00947 | Reg=0.00539 | acc=1.0000 | FP-Norm=2.303 | FP-Norm(final)=2.337 | 3748.0 samples/s | 58.6 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00839 | Reg=0.00530 | acc=1.0000 | FP-Norm=2.283 | FP-Norm(final)=2.342 | 3698.3 samples/s | 57.8 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.00748 | Reg=0.00518 | acc=1.0000 | FP-Norm=2.260 | FP-Norm(final)=2.346 | 3705.4 samples/s | 57.9 steps/s
[Step=2100 Epoch= 8.1] | Loss=0.00675 | Reg=0.00505 | acc=1.0000 | FP-Norm=2.230 | FP-Norm(final)=2.351 | 4134.5 samples/s | 64.6 steps/s
[Step=2150 Epoch= 8.3] | Loss=0.00615 | Reg=0.00492 | acc=1.0000 | FP-Norm=2.199 | FP-Norm(final)=2.354 | 1699.9 samples/s | 26.6 steps/s
[Step=2200 Epoch= 8.5] | Loss=0.00564 | Reg=0.00478 | acc=1.0000 | FP-Norm=2.166 | FP-Norm(final)=2.358 | 3689.6 samples/s | 57.7 steps/s
[Step=2250 Epoch= 8.7] | Loss=0.00522 | Reg=0.00464 | acc=1.0000 | FP-Norm=2.133 | FP-Norm(final)=2.361 | 3704.7 samples/s | 57.9 steps/s
[Step=2300 Epoch= 8.9] | Loss=0.00485 | Reg=0.00451 | acc=1.0000 | FP-Norm=2.099 | FP-Norm(final)=2.363 | 3800.6 samples/s | 59.4 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.00455 | Reg=0.00438 | acc=1.0000 | FP-Norm=2.067 | FP-Norm(final)=2.366 | 3858.5 samples/s | 60.3 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.00427 | Reg=0.00426 | acc=1.0000 | FP-Norm=2.037 | FP-Norm(final)=2.369 | 1805.5 samples/s | 28.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33228 | acc=0.7334 | tpr=0.6216 | fpr=0.0240 | 3883.5 samples/s | 15.2 steps/s
Avg test loss: 0.33618, Avg test acc: 0.73183, Avg tpr: 0.62056, Avg fpr: 0.02346, total FA: 183

Testing server on iccad2012
[Step=  50] | Loss=0.24229 | acc=0.8121 | tpr=0.9248 | fpr=0.1899 | 3873.2 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.23960 | acc=0.8169 | tpr=0.9339 | fpr=0.1853 | 7175.3 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.24082 | acc=0.8159 | tpr=0.9409 | fpr=0.1864 | 7451.1 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.24272 | acc=0.8154 | tpr=0.9421 | fpr=0.1869 | 7332.0 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.24131 | acc=0.8158 | tpr=0.9459 | fpr=0.1866 | 7199.7 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.24281 | acc=0.8155 | tpr=0.9476 | fpr=0.1869 | 7434.5 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.24333 | acc=0.8152 | tpr=0.9468 | fpr=0.1872 | 7400.1 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.24380 | acc=0.8149 | tpr=0.9426 | fpr=0.1875 | 7277.6 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.24424 | acc=0.8149 | tpr=0.9401 | fpr=0.1874 | 7230.7 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.24454 | acc=0.8144 | tpr=0.9401 | fpr=0.1879 | 7161.1 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.24451 | acc=0.8144 | tpr=0.9399 | fpr=0.1879 | 13125.6 samples/s | 51.3 steps/s
Avg test loss: 0.24442, Avg test acc: 0.81444, Avg tpr: 0.94017, Avg fpr: 0.18785, total FA: 26082

server round 3/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 4.7] | Loss=0.22535 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.385 | 3683.0 samples/s | 57.5 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.08373 | Reg=0.00168 | acc=0.9219 | FP-Norm=1.239 | FP-Norm(final)=2.375 | 3603.5 samples/s | 56.3 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.07170 | Reg=0.00193 | acc=0.9688 | FP-Norm=1.359 | FP-Norm(final)=2.379 | 3890.4 samples/s | 60.8 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.06802 | Reg=0.00215 | acc=1.0000 | FP-Norm=1.443 | FP-Norm(final)=2.382 | 3898.9 samples/s | 60.9 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.06758 | Reg=0.00239 | acc=0.9688 | FP-Norm=1.521 | FP-Norm(final)=2.384 | 3895.0 samples/s | 60.9 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.06632 | Reg=0.00263 | acc=0.9375 | FP-Norm=1.598 | FP-Norm(final)=2.387 | 3910.2 samples/s | 61.1 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.06675 | Reg=0.00291 | acc=0.9688 | FP-Norm=1.676 | FP-Norm(final)=2.388 | 3891.9 samples/s | 60.8 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.06486 | Reg=0.00316 | acc=0.9844 | FP-Norm=1.744 | FP-Norm(final)=2.389 | 3921.0 samples/s | 61.3 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.06396 | Reg=0.00335 | acc=1.0000 | FP-Norm=1.799 | FP-Norm(final)=2.390 | 3878.0 samples/s | 60.6 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.06318 | Reg=0.00356 | acc=0.9531 | FP-Norm=1.852 | FP-Norm(final)=2.390 | 3911.3 samples/s | 61.1 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.06201 | Reg=0.00376 | acc=0.9844 | FP-Norm=1.904 | FP-Norm(final)=2.391 | 4614.2 samples/s | 72.1 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.05992 | Reg=0.00395 | acc=0.9688 | FP-Norm=1.949 | FP-Norm(final)=2.393 | 1672.2 samples/s | 26.1 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.05837 | Reg=0.00413 | acc=0.9688 | FP-Norm=1.993 | FP-Norm(final)=2.395 | 3858.4 samples/s | 60.3 steps/s
[Step=3050 Epoch= 5.9] | Loss=0.05701 | Reg=0.00431 | acc=0.9844 | FP-Norm=2.035 | FP-Norm(final)=2.396 | 3900.3 samples/s | 60.9 steps/s
[Step=3100 Epoch= 6.0] | Loss=0.05613 | Reg=0.00448 | acc=0.9688 | FP-Norm=2.074 | FP-Norm(final)=2.398 | 3880.3 samples/s | 60.6 steps/s
[Step=3150 Epoch= 6.1] | Loss=0.05539 | Reg=0.00465 | acc=0.9375 | FP-Norm=2.113 | FP-Norm(final)=2.400 | 3905.8 samples/s | 61.0 steps/s
[Step=3200 Epoch= 6.2] | Loss=0.05452 | Reg=0.00483 | acc=0.9688 | FP-Norm=2.152 | FP-Norm(final)=2.401 | 3909.9 samples/s | 61.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step3200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 4.7] | Loss=0.25931 | Reg=0.00000 | acc=0.7812 | FP-Norm=0.000 | FP-Norm(final)=2.385 | 3678.2 samples/s | 57.5 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.08915 | Reg=0.00200 | acc=0.9531 | FP-Norm=1.350 | FP-Norm(final)=2.370 | 3810.2 samples/s | 59.5 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.08074 | Reg=0.00233 | acc=0.9531 | FP-Norm=1.490 | FP-Norm(final)=2.374 | 3988.6 samples/s | 62.3 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.07799 | Reg=0.00259 | acc=0.9844 | FP-Norm=1.581 | FP-Norm(final)=2.374 | 3886.1 samples/s | 60.7 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.07388 | Reg=0.00280 | acc=0.9844 | FP-Norm=1.649 | FP-Norm(final)=2.375 | 3886.1 samples/s | 60.7 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.07079 | Reg=0.00301 | acc=0.9531 | FP-Norm=1.710 | FP-Norm(final)=2.377 | 3897.4 samples/s | 60.9 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.06990 | Reg=0.00320 | acc=0.9062 | FP-Norm=1.765 | FP-Norm(final)=2.377 | 3920.4 samples/s | 61.3 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.06801 | Reg=0.00339 | acc=0.9844 | FP-Norm=1.817 | FP-Norm(final)=2.377 | 3903.9 samples/s | 61.0 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.06687 | Reg=0.00358 | acc=0.9688 | FP-Norm=1.866 | FP-Norm(final)=2.378 | 3910.3 samples/s | 61.1 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.06543 | Reg=0.00377 | acc=1.0000 | FP-Norm=1.915 | FP-Norm(final)=2.378 | 3911.9 samples/s | 61.1 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.06416 | Reg=0.00395 | acc=0.9688 | FP-Norm=1.959 | FP-Norm(final)=2.379 | 4653.6 samples/s | 72.7 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.06234 | Reg=0.00413 | acc=0.9375 | FP-Norm=2.002 | FP-Norm(final)=2.380 | 1702.8 samples/s | 26.6 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.06081 | Reg=0.00431 | acc=0.9375 | FP-Norm=2.045 | FP-Norm(final)=2.382 | 3889.3 samples/s | 60.8 steps/s
[Step=3050 Epoch= 6.0] | Loss=0.05954 | Reg=0.00449 | acc=0.9688 | FP-Norm=2.087 | FP-Norm(final)=2.384 | 3907.6 samples/s | 61.1 steps/s
[Step=3100 Epoch= 6.1] | Loss=0.05828 | Reg=0.00467 | acc=0.9531 | FP-Norm=2.126 | FP-Norm(final)=2.386 | 3863.5 samples/s | 60.4 steps/s
[Step=3150 Epoch= 6.2] | Loss=0.05722 | Reg=0.00484 | acc=0.9844 | FP-Norm=2.163 | FP-Norm(final)=2.387 | 3891.7 samples/s | 60.8 steps/s
[Step=3200 Epoch= 6.3] | Loss=0.05666 | Reg=0.00500 | acc=0.9531 | FP-Norm=2.199 | FP-Norm(final)=2.389 | 3893.7 samples/s | 60.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step3200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 9.2] | Loss=0.10790 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.385 | 3502.6 samples/s | 54.7 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.03050 | Reg=0.00481 | acc=0.9844 | FP-Norm=2.076 | FP-Norm(final)=2.365 | 3736.6 samples/s | 58.4 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.01790 | Reg=0.00564 | acc=1.0000 | FP-Norm=2.308 | FP-Norm(final)=2.361 | 3708.5 samples/s | 57.9 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.01362 | Reg=0.00572 | acc=1.0000 | FP-Norm=2.347 | FP-Norm(final)=2.363 | 3656.4 samples/s | 57.1 steps/s
[Step=2600 Epoch=10.0] | Loss=0.01073 | Reg=0.00565 | acc=1.0000 | FP-Norm=2.343 | FP-Norm(final)=2.367 | 3659.5 samples/s | 57.2 steps/s
[Step=2650 Epoch=10.2] | Loss=0.00879 | Reg=0.00551 | acc=1.0000 | FP-Norm=2.319 | FP-Norm(final)=2.371 | 4533.3 samples/s | 70.8 steps/s
[Step=2700 Epoch=10.3] | Loss=0.00751 | Reg=0.00533 | acc=1.0000 | FP-Norm=2.284 | FP-Norm(final)=2.375 | 1664.2 samples/s | 26.0 steps/s
[Step=2750 Epoch=10.5] | Loss=0.00649 | Reg=0.00517 | acc=1.0000 | FP-Norm=2.251 | FP-Norm(final)=2.379 | 3698.9 samples/s | 57.8 steps/s
[Step=2800 Epoch=10.7] | Loss=0.00571 | Reg=0.00501 | acc=1.0000 | FP-Norm=2.216 | FP-Norm(final)=2.383 | 3697.9 samples/s | 57.8 steps/s
[Step=2850 Epoch=10.9] | Loss=0.00510 | Reg=0.00485 | acc=1.0000 | FP-Norm=2.180 | FP-Norm(final)=2.387 | 3716.5 samples/s | 58.1 steps/s
[Step=2900 Epoch=11.1] | Loss=0.00464 | Reg=0.00470 | acc=1.0000 | FP-Norm=2.145 | FP-Norm(final)=2.390 | 4038.3 samples/s | 63.1 steps/s
[Step=2950 Epoch=11.3] | Loss=0.00423 | Reg=0.00456 | acc=1.0000 | FP-Norm=2.110 | FP-Norm(final)=2.393 | 1737.1 samples/s | 27.1 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00388 | Reg=0.00441 | acc=1.0000 | FP-Norm=2.074 | FP-Norm(final)=2.396 | 3639.3 samples/s | 56.9 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00359 | Reg=0.00427 | acc=1.0000 | FP-Norm=2.038 | FP-Norm(final)=2.399 | 3699.5 samples/s | 57.8 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00334 | Reg=0.00414 | acc=1.0000 | FP-Norm=2.003 | FP-Norm(final)=2.401 | 3725.1 samples/s | 58.2 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00312 | Reg=0.00400 | acc=1.0000 | FP-Norm=1.968 | FP-Norm(final)=2.403 | 3674.4 samples/s | 57.4 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00293 | Reg=0.00388 | acc=1.0000 | FP-Norm=1.934 | FP-Norm(final)=2.405 | 1809.8 samples/s | 28.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step3200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 9.2] | Loss=0.09153 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.386 | 3601.4 samples/s | 56.3 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.02599 | Reg=0.00431 | acc=1.0000 | FP-Norm=1.975 | FP-Norm(final)=2.367 | 3641.7 samples/s | 56.9 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.02165 | Reg=0.00582 | acc=1.0000 | FP-Norm=2.340 | FP-Norm(final)=2.363 | 3786.8 samples/s | 59.2 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.01856 | Reg=0.00651 | acc=1.0000 | FP-Norm=2.496 | FP-Norm(final)=2.359 | 3775.3 samples/s | 59.0 steps/s
[Step=2600 Epoch=10.0] | Loss=0.01515 | Reg=0.00673 | acc=1.0000 | FP-Norm=2.552 | FP-Norm(final)=2.357 | 3701.0 samples/s | 57.8 steps/s
[Step=2650 Epoch=10.2] | Loss=0.01295 | Reg=0.00677 | acc=1.0000 | FP-Norm=2.568 | FP-Norm(final)=2.359 | 4555.3 samples/s | 71.2 steps/s
[Step=2700 Epoch=10.4] | Loss=0.01089 | Reg=0.00669 | acc=1.0000 | FP-Norm=2.558 | FP-Norm(final)=2.360 | 1671.7 samples/s | 26.1 steps/s
[Step=2750 Epoch=10.6] | Loss=0.00938 | Reg=0.00654 | acc=1.0000 | FP-Norm=2.531 | FP-Norm(final)=2.363 | 3776.7 samples/s | 59.0 steps/s
[Step=2800 Epoch=10.8] | Loss=0.00822 | Reg=0.00636 | acc=1.0000 | FP-Norm=2.497 | FP-Norm(final)=2.366 | 3785.0 samples/s | 59.1 steps/s
[Step=2850 Epoch=11.0] | Loss=0.00736 | Reg=0.00617 | acc=1.0000 | FP-Norm=2.460 | FP-Norm(final)=2.369 | 3818.9 samples/s | 59.7 steps/s
[Step=2900 Epoch=11.2] | Loss=0.00670 | Reg=0.00602 | acc=1.0000 | FP-Norm=2.429 | FP-Norm(final)=2.373 | 4239.1 samples/s | 66.2 steps/s
[Step=2950 Epoch=11.4] | Loss=0.00610 | Reg=0.00586 | acc=1.0000 | FP-Norm=2.396 | FP-Norm(final)=2.376 | 1718.8 samples/s | 26.9 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00560 | Reg=0.00569 | acc=1.0000 | FP-Norm=2.361 | FP-Norm(final)=2.379 | 3733.8 samples/s | 58.3 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00518 | Reg=0.00553 | acc=1.0000 | FP-Norm=2.324 | FP-Norm(final)=2.382 | 3633.4 samples/s | 56.8 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00482 | Reg=0.00537 | acc=1.0000 | FP-Norm=2.287 | FP-Norm(final)=2.385 | 3709.8 samples/s | 58.0 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00450 | Reg=0.00521 | acc=1.0000 | FP-Norm=2.251 | FP-Norm(final)=2.388 | 3767.6 samples/s | 58.9 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00423 | Reg=0.00506 | acc=1.0000 | FP-Norm=2.215 | FP-Norm(final)=2.391 | 1786.7 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29617 | acc=0.7781 | tpr=0.6838 | fpr=0.0171 | 3869.8 samples/s | 15.1 steps/s
Avg test loss: 0.30165, Avg test acc: 0.77486, Avg tpr: 0.67978, Avg fpr: 0.01602, total FA: 125

Testing server on iccad2012
[Step=  50] | Loss=0.29737 | acc=0.7730 | tpr=0.9204 | fpr=0.2297 | 3852.4 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.29235 | acc=0.7780 | tpr=0.9424 | fpr=0.2251 | 7647.9 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.29344 | acc=0.7765 | tpr=0.9524 | fpr=0.2267 | 7126.6 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.29490 | acc=0.7778 | tpr=0.9519 | fpr=0.2254 | 7202.9 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.29380 | acc=0.7783 | tpr=0.9520 | fpr=0.2249 | 7553.7 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.29515 | acc=0.7784 | tpr=0.9520 | fpr=0.2248 | 7133.7 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.29538 | acc=0.7786 | tpr=0.9543 | fpr=0.2246 | 7018.3 samples/s | 27.4 steps/s
[Step= 400] | Loss=0.29554 | acc=0.7786 | tpr=0.9497 | fpr=0.2245 | 7353.2 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.29608 | acc=0.7785 | tpr=0.9469 | fpr=0.2246 | 7219.8 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.29660 | acc=0.7781 | tpr=0.9463 | fpr=0.2249 | 7337.2 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.29667 | acc=0.7782 | tpr=0.9459 | fpr=0.2249 | 12992.9 samples/s | 50.8 steps/s
Avg test loss: 0.29666, Avg test acc: 0.77821, Avg tpr: 0.94532, Avg fpr: 0.22483, total FA: 31217

server round 4/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch= 6.2] | Loss=0.17883 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.421 | 3582.6 samples/s | 56.0 steps/s
[Step=3250 Epoch= 6.3] | Loss=0.07233 | Reg=0.00156 | acc=0.9219 | FP-Norm=1.191 | FP-Norm(final)=2.411 | 3876.5 samples/s | 60.6 steps/s
[Step=3300 Epoch= 6.4] | Loss=0.06660 | Reg=0.00187 | acc=0.9688 | FP-Norm=1.332 | FP-Norm(final)=2.410 | 3978.4 samples/s | 62.2 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.06292 | Reg=0.00210 | acc=0.9531 | FP-Norm=1.423 | FP-Norm(final)=2.409 | 3923.2 samples/s | 61.3 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.05991 | Reg=0.00234 | acc=0.9844 | FP-Norm=1.504 | FP-Norm(final)=2.410 | 4004.4 samples/s | 62.6 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.05834 | Reg=0.00256 | acc=0.9375 | FP-Norm=1.575 | FP-Norm(final)=2.410 | 4039.7 samples/s | 63.1 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.05825 | Reg=0.00278 | acc=0.9531 | FP-Norm=1.639 | FP-Norm(final)=2.410 | 4016.5 samples/s | 62.8 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.05759 | Reg=0.00298 | acc=0.9688 | FP-Norm=1.697 | FP-Norm(final)=2.409 | 3909.6 samples/s | 61.1 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.05692 | Reg=0.00317 | acc=0.9688 | FP-Norm=1.751 | FP-Norm(final)=2.408 | 3916.0 samples/s | 61.2 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.05624 | Reg=0.00335 | acc=0.9531 | FP-Norm=1.800 | FP-Norm(final)=2.407 | 3921.6 samples/s | 61.3 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.05578 | Reg=0.00353 | acc=0.9375 | FP-Norm=1.846 | FP-Norm(final)=2.407 | 4627.1 samples/s | 72.3 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.05420 | Reg=0.00369 | acc=1.0000 | FP-Norm=1.888 | FP-Norm(final)=2.406 | 1650.3 samples/s | 25.8 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.05223 | Reg=0.00383 | acc=0.9531 | FP-Norm=1.923 | FP-Norm(final)=2.406 | 3886.5 samples/s | 60.7 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.05129 | Reg=0.00397 | acc=1.0000 | FP-Norm=1.959 | FP-Norm(final)=2.407 | 3860.5 samples/s | 60.3 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.05071 | Reg=0.00412 | acc=0.9688 | FP-Norm=1.995 | FP-Norm(final)=2.408 | 3851.0 samples/s | 60.2 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.05036 | Reg=0.00428 | acc=0.9531 | FP-Norm=2.031 | FP-Norm(final)=2.408 | 3913.1 samples/s | 61.1 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.05025 | Reg=0.00443 | acc=0.9844 | FP-Norm=2.066 | FP-Norm(final)=2.409 | 3931.3 samples/s | 61.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch= 6.3] | Loss=0.16530 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.421 | 3618.9 samples/s | 56.5 steps/s
[Step=3250 Epoch= 6.4] | Loss=0.06904 | Reg=0.00121 | acc=0.9219 | FP-Norm=1.049 | FP-Norm(final)=2.410 | 3890.3 samples/s | 60.8 steps/s
[Step=3300 Epoch= 6.5] | Loss=0.06345 | Reg=0.00162 | acc=0.9375 | FP-Norm=1.238 | FP-Norm(final)=2.411 | 3903.6 samples/s | 61.0 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.06084 | Reg=0.00191 | acc=0.9844 | FP-Norm=1.351 | FP-Norm(final)=2.411 | 3893.9 samples/s | 60.8 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.05859 | Reg=0.00214 | acc=0.9531 | FP-Norm=1.432 | FP-Norm(final)=2.413 | 3879.3 samples/s | 60.6 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.05808 | Reg=0.00241 | acc=1.0000 | FP-Norm=1.519 | FP-Norm(final)=2.414 | 3883.5 samples/s | 60.7 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.05875 | Reg=0.00267 | acc=0.9375 | FP-Norm=1.598 | FP-Norm(final)=2.415 | 3936.4 samples/s | 61.5 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.05776 | Reg=0.00292 | acc=0.9531 | FP-Norm=1.670 | FP-Norm(final)=2.416 | 3905.3 samples/s | 61.0 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.05629 | Reg=0.00314 | acc=0.9531 | FP-Norm=1.732 | FP-Norm(final)=2.417 | 3900.7 samples/s | 60.9 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.05586 | Reg=0.00335 | acc=0.9844 | FP-Norm=1.788 | FP-Norm(final)=2.418 | 3911.9 samples/s | 61.1 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.05521 | Reg=0.00356 | acc=0.9844 | FP-Norm=1.843 | FP-Norm(final)=2.418 | 4676.9 samples/s | 73.1 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.05358 | Reg=0.00375 | acc=1.0000 | FP-Norm=1.893 | FP-Norm(final)=2.419 | 1723.0 samples/s | 26.9 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.05235 | Reg=0.00392 | acc=0.9531 | FP-Norm=1.934 | FP-Norm(final)=2.420 | 3880.5 samples/s | 60.6 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.05083 | Reg=0.00408 | acc=0.9688 | FP-Norm=1.974 | FP-Norm(final)=2.421 | 3925.3 samples/s | 61.3 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.05026 | Reg=0.00425 | acc=1.0000 | FP-Norm=2.014 | FP-Norm(final)=2.421 | 3870.4 samples/s | 60.5 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.05024 | Reg=0.00441 | acc=0.9688 | FP-Norm=2.052 | FP-Norm(final)=2.421 | 3933.5 samples/s | 61.5 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.04980 | Reg=0.00457 | acc=0.9531 | FP-Norm=2.088 | FP-Norm(final)=2.421 | 3877.8 samples/s | 60.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step4000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=12.3] | Loss=0.11174 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.421 | 3723.5 samples/s | 58.2 steps/s
[Step=3250 Epoch=12.5] | Loss=0.01765 | Reg=0.00456 | acc=0.9844 | FP-Norm=2.030 | FP-Norm(final)=2.423 | 3543.4 samples/s | 55.4 steps/s
[Step=3300 Epoch=12.6] | Loss=0.01474 | Reg=0.00557 | acc=1.0000 | FP-Norm=2.297 | FP-Norm(final)=2.416 | 3703.7 samples/s | 57.9 steps/s
[Step=3350 Epoch=12.8] | Loss=0.01132 | Reg=0.00603 | acc=1.0000 | FP-Norm=2.410 | FP-Norm(final)=2.407 | 3690.3 samples/s | 57.7 steps/s
[Step=3400 Epoch=13.0] | Loss=0.00938 | Reg=0.00615 | acc=0.9844 | FP-Norm=2.446 | FP-Norm(final)=2.405 | 3715.1 samples/s | 58.0 steps/s
[Step=3450 Epoch=13.2] | Loss=0.00913 | Reg=0.00626 | acc=1.0000 | FP-Norm=2.475 | FP-Norm(final)=2.405 | 4500.2 samples/s | 70.3 steps/s
[Step=3500 Epoch=13.4] | Loss=0.00775 | Reg=0.00636 | acc=1.0000 | FP-Norm=2.499 | FP-Norm(final)=2.406 | 1654.9 samples/s | 25.9 steps/s
[Step=3550 Epoch=13.6] | Loss=0.00667 | Reg=0.00631 | acc=1.0000 | FP-Norm=2.491 | FP-Norm(final)=2.408 | 3702.3 samples/s | 57.8 steps/s
[Step=3600 Epoch=13.8] | Loss=0.00601 | Reg=0.00620 | acc=1.0000 | FP-Norm=2.472 | FP-Norm(final)=2.410 | 3844.5 samples/s | 60.1 steps/s
[Step=3650 Epoch=14.0] | Loss=0.00545 | Reg=0.00611 | acc=1.0000 | FP-Norm=2.455 | FP-Norm(final)=2.413 | 3661.2 samples/s | 57.2 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00491 | Reg=0.00600 | acc=1.0000 | FP-Norm=2.433 | FP-Norm(final)=2.415 | 4048.9 samples/s | 63.3 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00448 | Reg=0.00586 | acc=1.0000 | FP-Norm=2.404 | FP-Norm(final)=2.418 | 1748.4 samples/s | 27.3 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00411 | Reg=0.00571 | acc=1.0000 | FP-Norm=2.372 | FP-Norm(final)=2.420 | 3770.2 samples/s | 58.9 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00380 | Reg=0.00556 | acc=1.0000 | FP-Norm=2.338 | FP-Norm(final)=2.422 | 3708.6 samples/s | 57.9 steps/s
[Step=3900 Epoch=14.9] | Loss=0.00354 | Reg=0.00541 | acc=1.0000 | FP-Norm=2.303 | FP-Norm(final)=2.425 | 3670.0 samples/s | 57.3 steps/s
[Step=3950 Epoch=15.1] | Loss=0.00330 | Reg=0.00526 | acc=1.0000 | FP-Norm=2.268 | FP-Norm(final)=2.427 | 3721.2 samples/s | 58.1 steps/s
[Step=4000 Epoch=15.3] | Loss=0.00313 | Reg=0.00512 | acc=1.0000 | FP-Norm=2.235 | FP-Norm(final)=2.428 | 1799.0 samples/s | 28.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step4000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=12.3] | Loss=0.04819 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.422 | 3590.1 samples/s | 56.1 steps/s
[Step=3250 Epoch=12.5] | Loss=0.02688 | Reg=0.00502 | acc=0.9844 | FP-Norm=2.109 | FP-Norm(final)=2.408 | 3692.1 samples/s | 57.7 steps/s
[Step=3300 Epoch=12.7] | Loss=0.01971 | Reg=0.00648 | acc=0.9844 | FP-Norm=2.462 | FP-Norm(final)=2.386 | 3773.1 samples/s | 59.0 steps/s
[Step=3350 Epoch=12.9] | Loss=0.01468 | Reg=0.00667 | acc=1.0000 | FP-Norm=2.526 | FP-Norm(final)=2.382 | 3659.5 samples/s | 57.2 steps/s
[Step=3400 Epoch=13.1] | Loss=0.01144 | Reg=0.00663 | acc=1.0000 | FP-Norm=2.532 | FP-Norm(final)=2.384 | 3690.2 samples/s | 57.7 steps/s
[Step=3450 Epoch=13.3] | Loss=0.00953 | Reg=0.00647 | acc=1.0000 | FP-Norm=2.509 | FP-Norm(final)=2.387 | 4600.5 samples/s | 71.9 steps/s
[Step=3500 Epoch=13.5] | Loss=0.00802 | Reg=0.00630 | acc=1.0000 | FP-Norm=2.481 | FP-Norm(final)=2.391 | 1641.5 samples/s | 25.6 steps/s
[Step=3550 Epoch=13.7] | Loss=0.00691 | Reg=0.00611 | acc=1.0000 | FP-Norm=2.444 | FP-Norm(final)=2.396 | 3688.9 samples/s | 57.6 steps/s
[Step=3600 Epoch=13.9] | Loss=0.00607 | Reg=0.00591 | acc=1.0000 | FP-Norm=2.403 | FP-Norm(final)=2.399 | 3687.0 samples/s | 57.6 steps/s
[Step=3650 Epoch=14.1] | Loss=0.00541 | Reg=0.00570 | acc=1.0000 | FP-Norm=2.361 | FP-Norm(final)=2.403 | 3754.2 samples/s | 58.7 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00488 | Reg=0.00551 | acc=1.0000 | FP-Norm=2.319 | FP-Norm(final)=2.406 | 4201.2 samples/s | 65.6 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00445 | Reg=0.00532 | acc=1.0000 | FP-Norm=2.277 | FP-Norm(final)=2.409 | 1736.5 samples/s | 27.1 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00408 | Reg=0.00514 | acc=1.0000 | FP-Norm=2.236 | FP-Norm(final)=2.412 | 3813.0 samples/s | 59.6 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00377 | Reg=0.00497 | acc=1.0000 | FP-Norm=2.195 | FP-Norm(final)=2.415 | 3818.9 samples/s | 59.7 steps/s
[Step=3900 Epoch=15.0] | Loss=0.00351 | Reg=0.00481 | acc=1.0000 | FP-Norm=2.156 | FP-Norm(final)=2.417 | 3746.5 samples/s | 58.5 steps/s
[Step=3950 Epoch=15.2] | Loss=0.00328 | Reg=0.00466 | acc=1.0000 | FP-Norm=2.118 | FP-Norm(final)=2.420 | 3757.1 samples/s | 58.7 steps/s
[Step=4000 Epoch=15.4] | Loss=0.00308 | Reg=0.00451 | acc=1.0000 | FP-Norm=2.081 | FP-Norm(final)=2.422 | 1799.5 samples/s | 28.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22909 | acc=0.8303 | tpr=0.7646 | fpr=0.0270 | 3801.7 samples/s | 14.9 steps/s
Avg test loss: 0.23318, Avg test acc: 0.82575, Avg tpr: 0.75806, Avg fpr: 0.02538, total FA: 198

Testing server on iccad2012
[Step=  50] | Loss=0.37807 | acc=0.7395 | tpr=0.9381 | fpr=0.2641 | 3816.4 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.37141 | acc=0.7442 | tpr=0.9616 | fpr=0.2599 | 7242.7 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.37357 | acc=0.7419 | tpr=0.9654 | fpr=0.2622 | 7342.8 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.37552 | acc=0.7420 | tpr=0.9661 | fpr=0.2621 | 7364.6 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.37395 | acc=0.7425 | tpr=0.9677 | fpr=0.2616 | 7492.2 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.37459 | acc=0.7432 | tpr=0.9673 | fpr=0.2609 | 7105.4 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.37529 | acc=0.7430 | tpr=0.9674 | fpr=0.2611 | 7168.6 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.37569 | acc=0.7425 | tpr=0.9639 | fpr=0.2615 | 7697.8 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.37646 | acc=0.7420 | tpr=0.9635 | fpr=0.2620 | 6920.6 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.37696 | acc=0.7415 | tpr=0.9648 | fpr=0.2625 | 7347.8 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.37666 | acc=0.7417 | tpr=0.9646 | fpr=0.2624 | 13124.6 samples/s | 51.3 steps/s
Avg test loss: 0.37669, Avg test acc: 0.74170, Avg tpr: 0.96474, Avg fpr: 0.26236, total FA: 36428

server round 5/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.23926 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.430 | 3399.1 samples/s | 53.1 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.06222 | Reg=0.00124 | acc=0.9375 | FP-Norm=1.065 | FP-Norm(final)=2.412 | 3901.8 samples/s | 61.0 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.05932 | Reg=0.00160 | acc=0.9375 | FP-Norm=1.231 | FP-Norm(final)=2.417 | 3925.9 samples/s | 61.3 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.05622 | Reg=0.00192 | acc=0.9688 | FP-Norm=1.354 | FP-Norm(final)=2.417 | 3903.6 samples/s | 61.0 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.05433 | Reg=0.00218 | acc=0.9688 | FP-Norm=1.447 | FP-Norm(final)=2.419 | 3886.1 samples/s | 60.7 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.05337 | Reg=0.00242 | acc=0.9688 | FP-Norm=1.524 | FP-Norm(final)=2.419 | 3876.9 samples/s | 60.6 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.05335 | Reg=0.00265 | acc=0.9844 | FP-Norm=1.594 | FP-Norm(final)=2.418 | 3926.0 samples/s | 61.3 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.05165 | Reg=0.00287 | acc=0.9844 | FP-Norm=1.660 | FP-Norm(final)=2.418 | 3899.8 samples/s | 60.9 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.05031 | Reg=0.00305 | acc=1.0000 | FP-Norm=1.711 | FP-Norm(final)=2.419 | 3984.1 samples/s | 62.3 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.05005 | Reg=0.00323 | acc=0.9688 | FP-Norm=1.762 | FP-Norm(final)=2.419 | 3937.7 samples/s | 61.5 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.04948 | Reg=0.00341 | acc=0.9688 | FP-Norm=1.809 | FP-Norm(final)=2.419 | 4737.1 samples/s | 74.0 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.04838 | Reg=0.00357 | acc=0.9688 | FP-Norm=1.852 | FP-Norm(final)=2.419 | 1682.2 samples/s | 26.3 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.04725 | Reg=0.00372 | acc=0.9531 | FP-Norm=1.890 | FP-Norm(final)=2.419 | 3839.8 samples/s | 60.0 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.04700 | Reg=0.00386 | acc=0.9062 | FP-Norm=1.926 | FP-Norm(final)=2.419 | 3908.9 samples/s | 61.1 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.04662 | Reg=0.00402 | acc=0.9688 | FP-Norm=1.964 | FP-Norm(final)=2.418 | 3887.2 samples/s | 60.7 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.04595 | Reg=0.00416 | acc=0.9219 | FP-Norm=1.999 | FP-Norm(final)=2.418 | 3894.3 samples/s | 60.8 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.04528 | Reg=0.00429 | acc=0.9844 | FP-Norm=2.029 | FP-Norm(final)=2.419 | 3923.1 samples/s | 61.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step4800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.09614 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.431 | 3653.3 samples/s | 57.1 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.07047 | Reg=0.00142 | acc=0.9375 | FP-Norm=1.134 | FP-Norm(final)=2.409 | 3935.0 samples/s | 61.5 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.06064 | Reg=0.00173 | acc=0.9531 | FP-Norm=1.279 | FP-Norm(final)=2.412 | 3978.6 samples/s | 62.2 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.05745 | Reg=0.00197 | acc=0.9688 | FP-Norm=1.375 | FP-Norm(final)=2.414 | 4016.7 samples/s | 62.8 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.05491 | Reg=0.00222 | acc=0.9844 | FP-Norm=1.462 | FP-Norm(final)=2.414 | 3926.4 samples/s | 61.4 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.05450 | Reg=0.00246 | acc=0.9688 | FP-Norm=1.539 | FP-Norm(final)=2.414 | 3897.2 samples/s | 60.9 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.05330 | Reg=0.00270 | acc=0.9531 | FP-Norm=1.611 | FP-Norm(final)=2.411 | 3934.4 samples/s | 61.5 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.05206 | Reg=0.00290 | acc=0.9375 | FP-Norm=1.671 | FP-Norm(final)=2.411 | 3870.6 samples/s | 60.5 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.05124 | Reg=0.00310 | acc=0.9844 | FP-Norm=1.728 | FP-Norm(final)=2.411 | 3918.4 samples/s | 61.2 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.05009 | Reg=0.00330 | acc=0.9688 | FP-Norm=1.781 | FP-Norm(final)=2.411 | 3912.2 samples/s | 61.1 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.04987 | Reg=0.00349 | acc=1.0000 | FP-Norm=1.831 | FP-Norm(final)=2.411 | 4644.0 samples/s | 72.6 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.04896 | Reg=0.00368 | acc=0.9688 | FP-Norm=1.880 | FP-Norm(final)=2.410 | 1735.5 samples/s | 27.1 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.04795 | Reg=0.00386 | acc=0.9844 | FP-Norm=1.924 | FP-Norm(final)=2.410 | 3961.5 samples/s | 61.9 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.04715 | Reg=0.00403 | acc=0.9688 | FP-Norm=1.965 | FP-Norm(final)=2.410 | 3913.3 samples/s | 61.1 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.04631 | Reg=0.00418 | acc=0.9844 | FP-Norm=2.002 | FP-Norm(final)=2.409 | 3893.6 samples/s | 60.8 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.04595 | Reg=0.00432 | acc=0.9688 | FP-Norm=2.036 | FP-Norm(final)=2.409 | 3911.9 samples/s | 61.1 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.04574 | Reg=0.00446 | acc=0.9062 | FP-Norm=2.069 | FP-Norm(final)=2.408 | 3921.0 samples/s | 61.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step4800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=15.3] | Loss=0.14371 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.431 | 3623.6 samples/s | 56.6 steps/s
[Step=4050 Epoch=15.5] | Loss=0.02822 | Reg=0.00624 | acc=0.9844 | FP-Norm=2.374 | FP-Norm(final)=2.401 | 3648.4 samples/s | 57.0 steps/s
[Step=4100 Epoch=15.7] | Loss=0.01653 | Reg=0.00672 | acc=0.9844 | FP-Norm=2.529 | FP-Norm(final)=2.398 | 3662.6 samples/s | 57.2 steps/s
[Step=4150 Epoch=15.9] | Loss=0.01170 | Reg=0.00650 | acc=1.0000 | FP-Norm=2.506 | FP-Norm(final)=2.402 | 3585.4 samples/s | 56.0 steps/s
[Step=4200 Epoch=16.1] | Loss=0.00933 | Reg=0.00620 | acc=0.9844 | FP-Norm=2.454 | FP-Norm(final)=2.407 | 3613.7 samples/s | 56.5 steps/s
[Step=4250 Epoch=16.3] | Loss=0.00868 | Reg=0.00602 | acc=0.9844 | FP-Norm=2.424 | FP-Norm(final)=2.409 | 4039.2 samples/s | 63.1 steps/s
[Step=4300 Epoch=16.5] | Loss=0.00743 | Reg=0.00593 | acc=1.0000 | FP-Norm=2.411 | FP-Norm(final)=2.411 | 1567.6 samples/s | 24.5 steps/s
[Step=4350 Epoch=16.7] | Loss=0.00646 | Reg=0.00580 | acc=1.0000 | FP-Norm=2.386 | FP-Norm(final)=2.413 | 3276.0 samples/s | 51.2 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00568 | Reg=0.00564 | acc=1.0000 | FP-Norm=2.353 | FP-Norm(final)=2.415 | 3295.7 samples/s | 51.5 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00505 | Reg=0.00546 | acc=1.0000 | FP-Norm=2.316 | FP-Norm(final)=2.418 | 3270.6 samples/s | 51.1 steps/s
[Step=4500 Epoch=17.2] | Loss=0.00455 | Reg=0.00528 | acc=1.0000 | FP-Norm=2.275 | FP-Norm(final)=2.420 | 3733.4 samples/s | 58.3 steps/s
[Step=4550 Epoch=17.4] | Loss=0.00415 | Reg=0.00511 | acc=1.0000 | FP-Norm=2.234 | FP-Norm(final)=2.423 | 1746.9 samples/s | 27.3 steps/s
[Step=4600 Epoch=17.6] | Loss=0.00381 | Reg=0.00493 | acc=1.0000 | FP-Norm=2.194 | FP-Norm(final)=2.425 | 3837.1 samples/s | 60.0 steps/s
[Step=4650 Epoch=17.8] | Loss=0.00352 | Reg=0.00477 | acc=1.0000 | FP-Norm=2.153 | FP-Norm(final)=2.427 | 3795.2 samples/s | 59.3 steps/s
[Step=4700 Epoch=18.0] | Loss=0.00327 | Reg=0.00461 | acc=1.0000 | FP-Norm=2.114 | FP-Norm(final)=2.429 | 3796.8 samples/s | 59.3 steps/s
[Step=4750 Epoch=18.2] | Loss=0.00306 | Reg=0.00446 | acc=1.0000 | FP-Norm=2.075 | FP-Norm(final)=2.430 | 3719.2 samples/s | 58.1 steps/s
[Step=4800 Epoch=18.4] | Loss=0.00287 | Reg=0.00432 | acc=1.0000 | FP-Norm=2.038 | FP-Norm(final)=2.432 | 1781.6 samples/s | 27.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step4800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=15.4] | Loss=0.10937 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.431 | 3556.0 samples/s | 55.6 steps/s
[Step=4050 Epoch=15.6] | Loss=0.02288 | Reg=0.00496 | acc=1.0000 | FP-Norm=2.131 | FP-Norm(final)=2.412 | 3726.3 samples/s | 58.2 steps/s
[Step=4100 Epoch=15.8] | Loss=0.01580 | Reg=0.00557 | acc=1.0000 | FP-Norm=2.309 | FP-Norm(final)=2.400 | 3817.3 samples/s | 59.6 steps/s
[Step=4150 Epoch=16.0] | Loss=0.01196 | Reg=0.00553 | acc=1.0000 | FP-Norm=2.316 | FP-Norm(final)=2.402 | 3797.9 samples/s | 59.3 steps/s
[Step=4200 Epoch=16.2] | Loss=0.01004 | Reg=0.00558 | acc=1.0000 | FP-Norm=2.335 | FP-Norm(final)=2.405 | 3821.4 samples/s | 59.7 steps/s
[Step=4250 Epoch=16.4] | Loss=0.00942 | Reg=0.00577 | acc=1.0000 | FP-Norm=2.380 | FP-Norm(final)=2.405 | 4708.4 samples/s | 73.6 steps/s
[Step=4300 Epoch=16.6] | Loss=0.00935 | Reg=0.00608 | acc=1.0000 | FP-Norm=2.444 | FP-Norm(final)=2.402 | 1651.3 samples/s | 25.8 steps/s
[Step=4350 Epoch=16.7] | Loss=0.00851 | Reg=0.00631 | acc=1.0000 | FP-Norm=2.490 | FP-Norm(final)=2.400 | 3695.3 samples/s | 57.7 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00766 | Reg=0.00642 | acc=1.0000 | FP-Norm=2.514 | FP-Norm(final)=2.399 | 3700.3 samples/s | 57.8 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00692 | Reg=0.00645 | acc=1.0000 | FP-Norm=2.522 | FP-Norm(final)=2.400 | 3730.9 samples/s | 58.3 steps/s
[Step=4500 Epoch=17.3] | Loss=0.00625 | Reg=0.00642 | acc=1.0000 | FP-Norm=2.518 | FP-Norm(final)=2.402 | 4133.3 samples/s | 64.6 steps/s
[Step=4550 Epoch=17.5] | Loss=0.00569 | Reg=0.00633 | acc=1.0000 | FP-Norm=2.502 | FP-Norm(final)=2.404 | 1721.3 samples/s | 26.9 steps/s
[Step=4600 Epoch=17.7] | Loss=0.00522 | Reg=0.00622 | acc=1.0000 | FP-Norm=2.479 | FP-Norm(final)=2.406 | 3789.7 samples/s | 59.2 steps/s
[Step=4650 Epoch=17.9] | Loss=0.00482 | Reg=0.00609 | acc=1.0000 | FP-Norm=2.452 | FP-Norm(final)=2.408 | 3711.9 samples/s | 58.0 steps/s
[Step=4700 Epoch=18.1] | Loss=0.00448 | Reg=0.00595 | acc=1.0000 | FP-Norm=2.422 | FP-Norm(final)=2.410 | 3680.7 samples/s | 57.5 steps/s
[Step=4750 Epoch=18.3] | Loss=0.00419 | Reg=0.00580 | acc=1.0000 | FP-Norm=2.390 | FP-Norm(final)=2.412 | 3764.6 samples/s | 58.8 steps/s
[Step=4800 Epoch=18.5] | Loss=0.00393 | Reg=0.00566 | acc=1.0000 | FP-Norm=2.358 | FP-Norm(final)=2.414 | 1794.0 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29634 | acc=0.7834 | tpr=0.6929 | fpr=0.0201 | 3914.9 samples/s | 15.3 steps/s
Avg test loss: 0.30156, Avg test acc: 0.78035, Avg tpr: 0.68928, Avg fpr: 0.01936, total FA: 151

Testing server on iccad2012
[Step=  50] | Loss=0.25676 | acc=0.8277 | tpr=0.9602 | fpr=0.1746 | 3846.5 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.25296 | acc=0.8332 | tpr=0.9701 | fpr=0.1694 | 7405.8 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.25471 | acc=0.8328 | tpr=0.9726 | fpr=0.1697 | 7250.5 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.25704 | acc=0.8322 | tpr=0.9727 | fpr=0.1703 | 7312.2 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.25554 | acc=0.8333 | tpr=0.9721 | fpr=0.1693 | 7420.8 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.25656 | acc=0.8329 | tpr=0.9716 | fpr=0.1696 | 7379.0 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.25739 | acc=0.8323 | tpr=0.9712 | fpr=0.1702 | 7323.7 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.25814 | acc=0.8318 | tpr=0.9677 | fpr=0.1707 | 7111.0 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.25903 | acc=0.8315 | tpr=0.9679 | fpr=0.1710 | 7191.3 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.25950 | acc=0.8309 | tpr=0.9674 | fpr=0.1716 | 7314.6 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.25916 | acc=0.8311 | tpr=0.9666 | fpr=0.1713 | 13446.4 samples/s | 52.5 steps/s
Avg test loss: 0.25913, Avg test acc: 0.83118, Avg tpr: 0.96672, Avg fpr: 0.17128, total FA: 23782

server round 6/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch= 9.4] | Loss=0.19039 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.426 | 3471.8 samples/s | 54.2 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.05424 | Reg=0.00153 | acc=0.9531 | FP-Norm=1.179 | FP-Norm(final)=2.415 | 3845.3 samples/s | 60.1 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.05025 | Reg=0.00184 | acc=0.9688 | FP-Norm=1.322 | FP-Norm(final)=2.417 | 3888.3 samples/s | 60.8 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.04754 | Reg=0.00204 | acc=0.9844 | FP-Norm=1.404 | FP-Norm(final)=2.416 | 3890.8 samples/s | 60.8 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.04914 | Reg=0.00225 | acc=0.9688 | FP-Norm=1.477 | FP-Norm(final)=2.413 | 3856.4 samples/s | 60.3 steps/s
[Step=5050 Epoch= 9.8] | Loss=0.04960 | Reg=0.00247 | acc=0.9531 | FP-Norm=1.547 | FP-Norm(final)=2.410 | 3921.9 samples/s | 61.3 steps/s
[Step=5100 Epoch= 9.9] | Loss=0.04936 | Reg=0.00267 | acc=0.9531 | FP-Norm=1.610 | FP-Norm(final)=2.408 | 3908.5 samples/s | 61.1 steps/s
[Step=5150 Epoch=10.0] | Loss=0.04827 | Reg=0.00285 | acc=0.9688 | FP-Norm=1.661 | FP-Norm(final)=2.406 | 3906.4 samples/s | 61.0 steps/s
[Step=5200 Epoch=10.1] | Loss=0.04737 | Reg=0.00301 | acc=0.9688 | FP-Norm=1.708 | FP-Norm(final)=2.407 | 3911.6 samples/s | 61.1 steps/s
[Step=5250 Epoch=10.2] | Loss=0.04680 | Reg=0.00317 | acc=0.9844 | FP-Norm=1.753 | FP-Norm(final)=2.406 | 3908.0 samples/s | 61.1 steps/s
[Step=5300 Epoch=10.3] | Loss=0.04623 | Reg=0.00332 | acc=0.9219 | FP-Norm=1.794 | FP-Norm(final)=2.405 | 4609.6 samples/s | 72.0 steps/s
[Step=5350 Epoch=10.4] | Loss=0.04463 | Reg=0.00347 | acc=0.9844 | FP-Norm=1.833 | FP-Norm(final)=2.405 | 1650.6 samples/s | 25.8 steps/s
[Step=5400 Epoch=10.5] | Loss=0.04364 | Reg=0.00360 | acc=0.9375 | FP-Norm=1.868 | FP-Norm(final)=2.406 | 3987.3 samples/s | 62.3 steps/s
[Step=5450 Epoch=10.6] | Loss=0.04306 | Reg=0.00374 | acc=0.9844 | FP-Norm=1.902 | FP-Norm(final)=2.407 | 3923.9 samples/s | 61.3 steps/s
[Step=5500 Epoch=10.7] | Loss=0.04232 | Reg=0.00386 | acc=0.9688 | FP-Norm=1.933 | FP-Norm(final)=2.408 | 3864.6 samples/s | 60.4 steps/s
[Step=5550 Epoch=10.8] | Loss=0.04209 | Reg=0.00399 | acc=0.9688 | FP-Norm=1.964 | FP-Norm(final)=2.409 | 3902.1 samples/s | 61.0 steps/s
[Step=5600 Epoch=10.9] | Loss=0.04177 | Reg=0.00412 | acc=0.9844 | FP-Norm=1.996 | FP-Norm(final)=2.408 | 3962.1 samples/s | 61.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step5600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch= 9.4] | Loss=0.14835 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.426 | 3599.2 samples/s | 56.2 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.06668 | Reg=0.00169 | acc=0.9844 | FP-Norm=1.245 | FP-Norm(final)=2.405 | 3913.4 samples/s | 61.1 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.06089 | Reg=0.00198 | acc=0.9844 | FP-Norm=1.375 | FP-Norm(final)=2.403 | 3910.1 samples/s | 61.1 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.05467 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.459 | FP-Norm(final)=2.404 | 3854.0 samples/s | 60.2 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.05147 | Reg=0.00240 | acc=1.0000 | FP-Norm=1.525 | FP-Norm(final)=2.407 | 3913.6 samples/s | 61.2 steps/s
[Step=5050 Epoch= 9.9] | Loss=0.05064 | Reg=0.00260 | acc=0.9531 | FP-Norm=1.590 | FP-Norm(final)=2.409 | 3927.2 samples/s | 61.4 steps/s
[Step=5100 Epoch=10.0] | Loss=0.04970 | Reg=0.00278 | acc=0.9844 | FP-Norm=1.646 | FP-Norm(final)=2.409 | 3917.9 samples/s | 61.2 steps/s
[Step=5150 Epoch=10.1] | Loss=0.04824 | Reg=0.00296 | acc=1.0000 | FP-Norm=1.697 | FP-Norm(final)=2.410 | 3906.6 samples/s | 61.0 steps/s
[Step=5200 Epoch=10.2] | Loss=0.04733 | Reg=0.00313 | acc=0.9375 | FP-Norm=1.744 | FP-Norm(final)=2.410 | 3906.9 samples/s | 61.0 steps/s
[Step=5250 Epoch=10.3] | Loss=0.04699 | Reg=0.00328 | acc=0.9375 | FP-Norm=1.786 | FP-Norm(final)=2.410 | 3915.9 samples/s | 61.2 steps/s
[Step=5300 Epoch=10.4] | Loss=0.04659 | Reg=0.00344 | acc=0.9375 | FP-Norm=1.828 | FP-Norm(final)=2.410 | 4677.4 samples/s | 73.1 steps/s
[Step=5350 Epoch=10.5] | Loss=0.04559 | Reg=0.00359 | acc=0.9531 | FP-Norm=1.867 | FP-Norm(final)=2.409 | 1710.7 samples/s | 26.7 steps/s
[Step=5400 Epoch=10.6] | Loss=0.04421 | Reg=0.00373 | acc=0.9844 | FP-Norm=1.902 | FP-Norm(final)=2.410 | 3899.9 samples/s | 60.9 steps/s
[Step=5450 Epoch=10.7] | Loss=0.04322 | Reg=0.00387 | acc=0.9688 | FP-Norm=1.937 | FP-Norm(final)=2.411 | 3881.6 samples/s | 60.6 steps/s
[Step=5500 Epoch=10.8] | Loss=0.04292 | Reg=0.00401 | acc=0.9688 | FP-Norm=1.972 | FP-Norm(final)=2.411 | 3923.8 samples/s | 61.3 steps/s
[Step=5550 Epoch=10.9] | Loss=0.04301 | Reg=0.00418 | acc=0.9844 | FP-Norm=2.011 | FP-Norm(final)=2.411 | 3907.8 samples/s | 61.1 steps/s
[Step=5600 Epoch=10.9] | Loss=0.04243 | Reg=0.00433 | acc=0.9844 | FP-Norm=2.046 | FP-Norm(final)=2.410 | 3919.0 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step5600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=18.4] | Loss=0.07030 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.427 | 3600.6 samples/s | 56.3 steps/s
[Step=4850 Epoch=18.6] | Loss=0.02595 | Reg=0.00441 | acc=0.9844 | FP-Norm=1.955 | FP-Norm(final)=2.407 | 3559.9 samples/s | 55.6 steps/s
[Step=4900 Epoch=18.8] | Loss=0.01787 | Reg=0.00578 | acc=1.0000 | FP-Norm=2.314 | FP-Norm(final)=2.392 | 3699.3 samples/s | 57.8 steps/s
[Step=4950 Epoch=19.0] | Loss=0.01230 | Reg=0.00586 | acc=1.0000 | FP-Norm=2.360 | FP-Norm(final)=2.392 | 3688.0 samples/s | 57.6 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00979 | Reg=0.00569 | acc=1.0000 | FP-Norm=2.339 | FP-Norm(final)=2.395 | 3718.3 samples/s | 58.1 steps/s
[Step=5050 Epoch=19.3] | Loss=0.00792 | Reg=0.00548 | acc=1.0000 | FP-Norm=2.301 | FP-Norm(final)=2.399 | 4521.5 samples/s | 70.6 steps/s
[Step=5100 Epoch=19.5] | Loss=0.00663 | Reg=0.00525 | acc=1.0000 | FP-Norm=2.255 | FP-Norm(final)=2.403 | 1668.3 samples/s | 26.1 steps/s
[Step=5150 Epoch=19.7] | Loss=0.00571 | Reg=0.00502 | acc=1.0000 | FP-Norm=2.206 | FP-Norm(final)=2.407 | 3776.6 samples/s | 59.0 steps/s
[Step=5200 Epoch=19.9] | Loss=0.00500 | Reg=0.00481 | acc=1.0000 | FP-Norm=2.158 | FP-Norm(final)=2.411 | 3822.9 samples/s | 59.7 steps/s
[Step=5250 Epoch=20.1] | Loss=0.00446 | Reg=0.00460 | acc=1.0000 | FP-Norm=2.109 | FP-Norm(final)=2.414 | 3812.2 samples/s | 59.6 steps/s
[Step=5300 Epoch=20.3] | Loss=0.00402 | Reg=0.00441 | acc=1.0000 | FP-Norm=2.062 | FP-Norm(final)=2.417 | 4149.4 samples/s | 64.8 steps/s
[Step=5350 Epoch=20.5] | Loss=0.00366 | Reg=0.00423 | acc=1.0000 | FP-Norm=2.016 | FP-Norm(final)=2.420 | 1732.5 samples/s | 27.1 steps/s
[Step=5400 Epoch=20.7] | Loss=0.00336 | Reg=0.00406 | acc=1.0000 | FP-Norm=1.973 | FP-Norm(final)=2.422 | 3699.8 samples/s | 57.8 steps/s
[Step=5450 Epoch=20.9] | Loss=0.00310 | Reg=0.00391 | acc=1.0000 | FP-Norm=1.930 | FP-Norm(final)=2.424 | 3728.6 samples/s | 58.3 steps/s
[Step=5500 Epoch=21.1] | Loss=0.00289 | Reg=0.00376 | acc=1.0000 | FP-Norm=1.890 | FP-Norm(final)=2.427 | 3696.8 samples/s | 57.8 steps/s
[Step=5550 Epoch=21.3] | Loss=0.00270 | Reg=0.00362 | acc=1.0000 | FP-Norm=1.851 | FP-Norm(final)=2.429 | 3683.3 samples/s | 57.6 steps/s
[Step=5600 Epoch=21.5] | Loss=0.00253 | Reg=0.00350 | acc=1.0000 | FP-Norm=1.814 | FP-Norm(final)=2.430 | 1766.9 samples/s | 27.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step5600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=18.5] | Loss=0.03053 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.428 | 3607.2 samples/s | 56.4 steps/s
[Step=4850 Epoch=18.7] | Loss=0.01284 | Reg=0.00327 | acc=1.0000 | FP-Norm=1.704 | FP-Norm(final)=2.426 | 3705.1 samples/s | 57.9 steps/s
[Step=4900 Epoch=18.9] | Loss=0.00987 | Reg=0.00446 | acc=1.0000 | FP-Norm=2.040 | FP-Norm(final)=2.418 | 3798.7 samples/s | 59.4 steps/s
[Step=4950 Epoch=19.1] | Loss=0.00847 | Reg=0.00503 | acc=1.0000 | FP-Norm=2.188 | FP-Norm(final)=2.416 | 3682.9 samples/s | 57.5 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00831 | Reg=0.00537 | acc=0.9844 | FP-Norm=2.273 | FP-Norm(final)=2.411 | 3704.0 samples/s | 57.9 steps/s
[Step=5050 Epoch=19.4] | Loss=0.00762 | Reg=0.00566 | acc=1.0000 | FP-Norm=2.341 | FP-Norm(final)=2.409 | 4536.9 samples/s | 70.9 steps/s
[Step=5100 Epoch=19.6] | Loss=0.00640 | Reg=0.00578 | acc=1.0000 | FP-Norm=2.371 | FP-Norm(final)=2.408 | 1664.2 samples/s | 26.0 steps/s
[Step=5150 Epoch=19.8] | Loss=0.00550 | Reg=0.00573 | acc=1.0000 | FP-Norm=2.366 | FP-Norm(final)=2.409 | 3650.8 samples/s | 57.0 steps/s
[Step=5200 Epoch=20.0] | Loss=0.00483 | Reg=0.00562 | acc=1.0000 | FP-Norm=2.345 | FP-Norm(final)=2.411 | 3751.6 samples/s | 58.6 steps/s
[Step=5250 Epoch=20.2] | Loss=0.00430 | Reg=0.00548 | acc=1.0000 | FP-Norm=2.317 | FP-Norm(final)=2.412 | 3675.7 samples/s | 57.4 steps/s
[Step=5300 Epoch=20.4] | Loss=0.00388 | Reg=0.00533 | acc=1.0000 | FP-Norm=2.284 | FP-Norm(final)=2.414 | 4116.7 samples/s | 64.3 steps/s
[Step=5350 Epoch=20.6] | Loss=0.00353 | Reg=0.00517 | acc=1.0000 | FP-Norm=2.248 | FP-Norm(final)=2.416 | 1719.7 samples/s | 26.9 steps/s
[Step=5400 Epoch=20.8] | Loss=0.00324 | Reg=0.00501 | acc=1.0000 | FP-Norm=2.212 | FP-Norm(final)=2.418 | 3683.5 samples/s | 57.6 steps/s
[Step=5450 Epoch=21.0] | Loss=0.00300 | Reg=0.00486 | acc=1.0000 | FP-Norm=2.175 | FP-Norm(final)=2.420 | 3702.5 samples/s | 57.9 steps/s
[Step=5500 Epoch=21.2] | Loss=0.00279 | Reg=0.00471 | acc=1.0000 | FP-Norm=2.138 | FP-Norm(final)=2.422 | 3718.0 samples/s | 58.1 steps/s
[Step=5550 Epoch=21.4] | Loss=0.00260 | Reg=0.00456 | acc=1.0000 | FP-Norm=2.102 | FP-Norm(final)=2.423 | 3761.4 samples/s | 58.8 steps/s
[Step=5600 Epoch=21.6] | Loss=0.00245 | Reg=0.00443 | acc=1.0000 | FP-Norm=2.066 | FP-Norm(final)=2.425 | 1802.4 samples/s | 28.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25718 | acc=0.8161 | tpr=0.7373 | fpr=0.0129 | 3885.5 samples/s | 15.2 steps/s
Avg test loss: 0.26070, Avg test acc: 0.81285, Avg tpr: 0.73399, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.34186 | acc=0.7740 | tpr=0.9425 | fpr=0.2290 | 3884.6 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.33541 | acc=0.7829 | tpr=0.9638 | fpr=0.2205 | 7101.2 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.33817 | acc=0.7813 | tpr=0.9669 | fpr=0.2221 | 7512.7 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.34097 | acc=0.7812 | tpr=0.9639 | fpr=0.2222 | 7669.7 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.33939 | acc=0.7815 | tpr=0.9668 | fpr=0.2218 | 6858.4 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.34020 | acc=0.7817 | tpr=0.9665 | fpr=0.2216 | 7408.2 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.34113 | acc=0.7817 | tpr=0.9662 | fpr=0.2216 | 7306.8 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.34149 | acc=0.7816 | tpr=0.9644 | fpr=0.2218 | 7242.5 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.34256 | acc=0.7813 | tpr=0.9654 | fpr=0.2220 | 7323.3 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.34310 | acc=0.7807 | tpr=0.9648 | fpr=0.2226 | 7400.9 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.34288 | acc=0.7804 | tpr=0.9638 | fpr=0.2229 | 13108.6 samples/s | 51.2 steps/s
Avg test loss: 0.34283, Avg test acc: 0.78044, Avg tpr: 0.96395, Avg fpr: 0.22289, total FA: 30948

server round 7/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=10.9] | Loss=0.12441 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.425 | 3507.8 samples/s | 54.8 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05352 | Reg=0.00172 | acc=0.9688 | FP-Norm=1.252 | FP-Norm(final)=2.408 | 3827.8 samples/s | 59.8 steps/s
[Step=5700 Epoch=11.1] | Loss=0.05036 | Reg=0.00205 | acc=0.9531 | FP-Norm=1.397 | FP-Norm(final)=2.403 | 3879.9 samples/s | 60.6 steps/s
[Step=5750 Epoch=11.2] | Loss=0.04706 | Reg=0.00225 | acc=0.9531 | FP-Norm=1.475 | FP-Norm(final)=2.401 | 3906.1 samples/s | 61.0 steps/s
[Step=5800 Epoch=11.3] | Loss=0.04403 | Reg=0.00244 | acc=1.0000 | FP-Norm=1.539 | FP-Norm(final)=2.398 | 3903.6 samples/s | 61.0 steps/s
[Step=5850 Epoch=11.4] | Loss=0.04369 | Reg=0.00260 | acc=0.9688 | FP-Norm=1.592 | FP-Norm(final)=2.397 | 3922.5 samples/s | 61.3 steps/s
[Step=5900 Epoch=11.5] | Loss=0.04297 | Reg=0.00278 | acc=0.9844 | FP-Norm=1.645 | FP-Norm(final)=2.396 | 3913.4 samples/s | 61.1 steps/s
[Step=5950 Epoch=11.6] | Loss=0.04224 | Reg=0.00292 | acc=0.9844 | FP-Norm=1.687 | FP-Norm(final)=2.396 | 3922.7 samples/s | 61.3 steps/s
[Step=6000 Epoch=11.7] | Loss=0.04293 | Reg=0.00306 | acc=0.9688 | FP-Norm=1.728 | FP-Norm(final)=2.394 | 3876.9 samples/s | 60.6 steps/s
[Step=6050 Epoch=11.8] | Loss=0.04231 | Reg=0.00321 | acc=0.9531 | FP-Norm=1.770 | FP-Norm(final)=2.392 | 3937.1 samples/s | 61.5 steps/s
[Step=6100 Epoch=11.9] | Loss=0.04249 | Reg=0.00336 | acc=1.0000 | FP-Norm=1.810 | FP-Norm(final)=2.390 | 4628.3 samples/s | 72.3 steps/s
[Step=6150 Epoch=12.0] | Loss=0.04166 | Reg=0.00350 | acc=1.0000 | FP-Norm=1.846 | FP-Norm(final)=2.389 | 1667.6 samples/s | 26.1 steps/s
[Step=6200 Epoch=12.1] | Loss=0.04061 | Reg=0.00361 | acc=0.9844 | FP-Norm=1.876 | FP-Norm(final)=2.389 | 3902.7 samples/s | 61.0 steps/s
[Step=6250 Epoch=12.2] | Loss=0.03986 | Reg=0.00372 | acc=0.9844 | FP-Norm=1.904 | FP-Norm(final)=2.390 | 3884.4 samples/s | 60.7 steps/s
[Step=6300 Epoch=12.3] | Loss=0.03924 | Reg=0.00384 | acc=1.0000 | FP-Norm=1.933 | FP-Norm(final)=2.390 | 3891.0 samples/s | 60.8 steps/s
[Step=6350 Epoch=12.4] | Loss=0.03940 | Reg=0.00396 | acc=0.9531 | FP-Norm=1.963 | FP-Norm(final)=2.390 | 3887.2 samples/s | 60.7 steps/s
[Step=6400 Epoch=12.5] | Loss=0.03892 | Reg=0.00407 | acc=0.9844 | FP-Norm=1.991 | FP-Norm(final)=2.390 | 3889.2 samples/s | 60.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step6400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=10.9] | Loss=0.22824 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.424 | 3767.3 samples/s | 58.9 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05947 | Reg=0.00197 | acc=0.9531 | FP-Norm=1.349 | FP-Norm(final)=2.403 | 3812.4 samples/s | 59.6 steps/s
[Step=5700 Epoch=11.1] | Loss=0.04851 | Reg=0.00214 | acc=1.0000 | FP-Norm=1.433 | FP-Norm(final)=2.408 | 4009.5 samples/s | 62.6 steps/s
[Step=5750 Epoch=11.2] | Loss=0.04763 | Reg=0.00228 | acc=0.9531 | FP-Norm=1.489 | FP-Norm(final)=2.406 | 4005.3 samples/s | 62.6 steps/s
[Step=5800 Epoch=11.3] | Loss=0.04561 | Reg=0.00241 | acc=0.9844 | FP-Norm=1.534 | FP-Norm(final)=2.406 | 3999.4 samples/s | 62.5 steps/s
[Step=5850 Epoch=11.4] | Loss=0.04546 | Reg=0.00254 | acc=0.9688 | FP-Norm=1.578 | FP-Norm(final)=2.406 | 3990.1 samples/s | 62.3 steps/s
[Step=5900 Epoch=11.5] | Loss=0.04418 | Reg=0.00269 | acc=0.9688 | FP-Norm=1.625 | FP-Norm(final)=2.406 | 3911.9 samples/s | 61.1 steps/s
[Step=5950 Epoch=11.6] | Loss=0.04413 | Reg=0.00283 | acc=0.9844 | FP-Norm=1.666 | FP-Norm(final)=2.408 | 3907.5 samples/s | 61.1 steps/s
[Step=6000 Epoch=11.7] | Loss=0.04326 | Reg=0.00298 | acc=1.0000 | FP-Norm=1.707 | FP-Norm(final)=2.408 | 3999.3 samples/s | 62.5 steps/s
[Step=6050 Epoch=11.8] | Loss=0.04256 | Reg=0.00311 | acc=0.9844 | FP-Norm=1.746 | FP-Norm(final)=2.408 | 4003.9 samples/s | 62.6 steps/s
[Step=6100 Epoch=11.9] | Loss=0.04229 | Reg=0.00324 | acc=0.9844 | FP-Norm=1.781 | FP-Norm(final)=2.408 | 4805.9 samples/s | 75.1 steps/s
[Step=6150 Epoch=12.0] | Loss=0.04114 | Reg=0.00338 | acc=0.9844 | FP-Norm=1.816 | FP-Norm(final)=2.407 | 1692.1 samples/s | 26.4 steps/s
[Step=6200 Epoch=12.1] | Loss=0.04043 | Reg=0.00350 | acc=0.9844 | FP-Norm=1.849 | FP-Norm(final)=2.407 | 3870.5 samples/s | 60.5 steps/s
[Step=6250 Epoch=12.2] | Loss=0.03993 | Reg=0.00362 | acc=0.9844 | FP-Norm=1.880 | FP-Norm(final)=2.408 | 3885.1 samples/s | 60.7 steps/s
[Step=6300 Epoch=12.3] | Loss=0.03915 | Reg=0.00374 | acc=0.9844 | FP-Norm=1.909 | FP-Norm(final)=2.409 | 3890.5 samples/s | 60.8 steps/s
[Step=6350 Epoch=12.4] | Loss=0.03935 | Reg=0.00387 | acc=0.9531 | FP-Norm=1.941 | FP-Norm(final)=2.409 | 3911.2 samples/s | 61.1 steps/s
[Step=6400 Epoch=12.5] | Loss=0.03899 | Reg=0.00401 | acc=0.9531 | FP-Norm=1.974 | FP-Norm(final)=2.408 | 3921.0 samples/s | 61.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step6400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=21.5] | Loss=0.21740 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.424 | 3659.9 samples/s | 57.2 steps/s
[Step=5650 Epoch=21.6] | Loss=0.01572 | Reg=0.00698 | acc=1.0000 | FP-Norm=2.537 | FP-Norm(final)=2.410 | 3593.1 samples/s | 56.1 steps/s
[Step=5700 Epoch=21.8] | Loss=0.00939 | Reg=0.00704 | acc=0.9844 | FP-Norm=2.599 | FP-Norm(final)=2.412 | 3783.2 samples/s | 59.1 steps/s
[Step=5750 Epoch=22.0] | Loss=0.00822 | Reg=0.00679 | acc=1.0000 | FP-Norm=2.569 | FP-Norm(final)=2.411 | 3794.2 samples/s | 59.3 steps/s
[Step=5800 Epoch=22.2] | Loss=0.00836 | Reg=0.00672 | acc=0.9844 | FP-Norm=2.565 | FP-Norm(final)=2.406 | 3735.2 samples/s | 58.4 steps/s
[Step=5850 Epoch=22.4] | Loss=0.00746 | Reg=0.00685 | acc=1.0000 | FP-Norm=2.594 | FP-Norm(final)=2.401 | 4484.5 samples/s | 70.1 steps/s
[Step=5900 Epoch=22.6] | Loss=0.00626 | Reg=0.00680 | acc=1.0000 | FP-Norm=2.590 | FP-Norm(final)=2.400 | 1667.6 samples/s | 26.1 steps/s
[Step=5950 Epoch=22.8] | Loss=0.00538 | Reg=0.00665 | acc=1.0000 | FP-Norm=2.562 | FP-Norm(final)=2.401 | 3674.5 samples/s | 57.4 steps/s
[Step=6000 Epoch=23.0] | Loss=0.00474 | Reg=0.00646 | acc=1.0000 | FP-Norm=2.525 | FP-Norm(final)=2.403 | 3715.9 samples/s | 58.1 steps/s
[Step=6050 Epoch=23.2] | Loss=0.00424 | Reg=0.00626 | acc=1.0000 | FP-Norm=2.483 | FP-Norm(final)=2.405 | 3670.0 samples/s | 57.3 steps/s
[Step=6100 Epoch=23.4] | Loss=0.00383 | Reg=0.00605 | acc=1.0000 | FP-Norm=2.440 | FP-Norm(final)=2.408 | 4030.1 samples/s | 63.0 steps/s
[Step=6150 Epoch=23.6] | Loss=0.00348 | Reg=0.00585 | acc=1.0000 | FP-Norm=2.396 | FP-Norm(final)=2.410 | 1704.1 samples/s | 26.6 steps/s
[Step=6200 Epoch=23.8] | Loss=0.00320 | Reg=0.00565 | acc=1.0000 | FP-Norm=2.350 | FP-Norm(final)=2.412 | 3686.7 samples/s | 57.6 steps/s
[Step=6250 Epoch=23.9] | Loss=0.00295 | Reg=0.00545 | acc=1.0000 | FP-Norm=2.305 | FP-Norm(final)=2.414 | 3693.6 samples/s | 57.7 steps/s
[Step=6300 Epoch=24.1] | Loss=0.00275 | Reg=0.00527 | acc=1.0000 | FP-Norm=2.261 | FP-Norm(final)=2.416 | 3715.3 samples/s | 58.1 steps/s
[Step=6350 Epoch=24.3] | Loss=0.00257 | Reg=0.00509 | acc=1.0000 | FP-Norm=2.218 | FP-Norm(final)=2.418 | 3727.0 samples/s | 58.2 steps/s
[Step=6400 Epoch=24.5] | Loss=0.00241 | Reg=0.00492 | acc=1.0000 | FP-Norm=2.176 | FP-Norm(final)=2.420 | 1790.3 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step6400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=21.6] | Loss=0.04419 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.426 | 3753.1 samples/s | 58.6 steps/s
[Step=5650 Epoch=21.7] | Loss=0.01390 | Reg=0.00417 | acc=0.9844 | FP-Norm=1.942 | FP-Norm(final)=2.429 | 3539.0 samples/s | 55.3 steps/s
[Step=5700 Epoch=21.9] | Loss=0.01236 | Reg=0.00530 | acc=1.0000 | FP-Norm=2.239 | FP-Norm(final)=2.408 | 3826.4 samples/s | 59.8 steps/s
[Step=5750 Epoch=22.1] | Loss=0.01066 | Reg=0.00577 | acc=1.0000 | FP-Norm=2.357 | FP-Norm(final)=2.396 | 3742.2 samples/s | 58.5 steps/s
[Step=5800 Epoch=22.3] | Loss=0.01026 | Reg=0.00606 | acc=1.0000 | FP-Norm=2.425 | FP-Norm(final)=2.389 | 3803.7 samples/s | 59.4 steps/s
[Step=5850 Epoch=22.5] | Loss=0.00934 | Reg=0.00637 | acc=1.0000 | FP-Norm=2.491 | FP-Norm(final)=2.384 | 4560.3 samples/s | 71.3 steps/s
[Step=5900 Epoch=22.7] | Loss=0.00800 | Reg=0.00649 | acc=1.0000 | FP-Norm=2.520 | FP-Norm(final)=2.383 | 1671.1 samples/s | 26.1 steps/s
[Step=5950 Epoch=22.9] | Loss=0.00689 | Reg=0.00645 | acc=1.0000 | FP-Norm=2.516 | FP-Norm(final)=2.384 | 3681.6 samples/s | 57.5 steps/s
[Step=6000 Epoch=23.1] | Loss=0.00609 | Reg=0.00633 | acc=1.0000 | FP-Norm=2.495 | FP-Norm(final)=2.386 | 3699.6 samples/s | 57.8 steps/s
[Step=6050 Epoch=23.3] | Loss=0.00545 | Reg=0.00620 | acc=1.0000 | FP-Norm=2.469 | FP-Norm(final)=2.389 | 3696.1 samples/s | 57.8 steps/s
[Step=6100 Epoch=23.5] | Loss=0.00492 | Reg=0.00604 | acc=1.0000 | FP-Norm=2.436 | FP-Norm(final)=2.392 | 4145.3 samples/s | 64.8 steps/s
[Step=6150 Epoch=23.7] | Loss=0.00447 | Reg=0.00586 | acc=1.0000 | FP-Norm=2.399 | FP-Norm(final)=2.395 | 1717.9 samples/s | 26.8 steps/s
[Step=6200 Epoch=23.9] | Loss=0.00410 | Reg=0.00569 | acc=1.0000 | FP-Norm=2.361 | FP-Norm(final)=2.398 | 3691.7 samples/s | 57.7 steps/s
[Step=6250 Epoch=24.1] | Loss=0.00379 | Reg=0.00551 | acc=1.0000 | FP-Norm=2.322 | FP-Norm(final)=2.401 | 3705.1 samples/s | 57.9 steps/s
[Step=6300 Epoch=24.3] | Loss=0.00353 | Reg=0.00534 | acc=1.0000 | FP-Norm=2.282 | FP-Norm(final)=2.403 | 3708.9 samples/s | 58.0 steps/s
[Step=6350 Epoch=24.4] | Loss=0.00329 | Reg=0.00518 | acc=1.0000 | FP-Norm=2.244 | FP-Norm(final)=2.406 | 3751.6 samples/s | 58.6 steps/s
[Step=6400 Epoch=24.6] | Loss=0.00309 | Reg=0.00502 | acc=1.0000 | FP-Norm=2.206 | FP-Norm(final)=2.408 | 1780.8 samples/s | 27.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35920 | acc=0.7489 | tpr=0.6373 | fpr=0.0087 | 3836.2 samples/s | 15.0 steps/s
Avg test loss: 0.36326, Avg test acc: 0.74681, Avg tpr: 0.63630, Avg fpr: 0.01013, total FA: 79

Testing server on iccad2012
[Step=  50] | Loss=0.22149 | acc=0.8638 | tpr=0.9336 | fpr=0.1374 | 3894.2 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.21726 | acc=0.8679 | tpr=0.9510 | fpr=0.1337 | 7160.5 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.22081 | acc=0.8658 | tpr=0.9510 | fpr=0.1358 | 7219.4 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.22369 | acc=0.8656 | tpr=0.9497 | fpr=0.1359 | 7354.6 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.22215 | acc=0.8658 | tpr=0.9493 | fpr=0.1357 | 7259.9 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.22328 | acc=0.8655 | tpr=0.9505 | fpr=0.1360 | 7469.1 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.22414 | acc=0.8652 | tpr=0.9530 | fpr=0.1364 | 7460.6 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.22463 | acc=0.8648 | tpr=0.9502 | fpr=0.1367 | 7156.9 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.22564 | acc=0.8647 | tpr=0.9518 | fpr=0.1369 | 7314.6 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.22585 | acc=0.8642 | tpr=0.9524 | fpr=0.1373 | 7240.7 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.22559 | acc=0.8640 | tpr=0.9511 | fpr=0.1375 | 13046.3 samples/s | 51.0 steps/s
Avg test loss: 0.22553, Avg test acc: 0.86402, Avg tpr: 0.95048, Avg fpr: 0.13755, total FA: 19099

server round 8/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=12.5] | Loss=0.19589 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.415 | 3394.7 samples/s | 53.0 steps/s
[Step=6450 Epoch=12.6] | Loss=0.04863 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.236 | FP-Norm(final)=2.399 | 3814.9 samples/s | 59.6 steps/s
[Step=6500 Epoch=12.7] | Loss=0.04587 | Reg=0.00195 | acc=0.9844 | FP-Norm=1.369 | FP-Norm(final)=2.397 | 3890.4 samples/s | 60.8 steps/s
[Step=6550 Epoch=12.8] | Loss=0.04216 | Reg=0.00215 | acc=1.0000 | FP-Norm=1.443 | FP-Norm(final)=2.398 | 3883.0 samples/s | 60.7 steps/s
[Step=6600 Epoch=12.9] | Loss=0.04224 | Reg=0.00237 | acc=0.9688 | FP-Norm=1.517 | FP-Norm(final)=2.400 | 3886.4 samples/s | 60.7 steps/s
[Step=6650 Epoch=13.0] | Loss=0.04209 | Reg=0.00257 | acc=0.9375 | FP-Norm=1.582 | FP-Norm(final)=2.398 | 3908.0 samples/s | 61.1 steps/s
[Step=6700 Epoch=13.1] | Loss=0.04059 | Reg=0.00273 | acc=0.9844 | FP-Norm=1.631 | FP-Norm(final)=2.398 | 3935.0 samples/s | 61.5 steps/s
[Step=6750 Epoch=13.2] | Loss=0.04064 | Reg=0.00288 | acc=0.9688 | FP-Norm=1.676 | FP-Norm(final)=2.395 | 3905.5 samples/s | 61.0 steps/s
[Step=6800 Epoch=13.3] | Loss=0.03980 | Reg=0.00300 | acc=0.9844 | FP-Norm=1.712 | FP-Norm(final)=2.394 | 3924.6 samples/s | 61.3 steps/s
[Step=6850 Epoch=13.4] | Loss=0.03990 | Reg=0.00313 | acc=0.9844 | FP-Norm=1.749 | FP-Norm(final)=2.393 | 3889.9 samples/s | 60.8 steps/s
[Step=6900 Epoch=13.5] | Loss=0.04010 | Reg=0.00328 | acc=1.0000 | FP-Norm=1.790 | FP-Norm(final)=2.391 | 4622.2 samples/s | 72.2 steps/s
[Step=6950 Epoch=13.6] | Loss=0.03911 | Reg=0.00342 | acc=0.9688 | FP-Norm=1.825 | FP-Norm(final)=2.390 | 1655.8 samples/s | 25.9 steps/s
[Step=7000 Epoch=13.7] | Loss=0.03821 | Reg=0.00353 | acc=1.0000 | FP-Norm=1.855 | FP-Norm(final)=2.390 | 3999.9 samples/s | 62.5 steps/s
[Step=7050 Epoch=13.8] | Loss=0.03725 | Reg=0.00364 | acc=1.0000 | FP-Norm=1.883 | FP-Norm(final)=2.390 | 3982.9 samples/s | 62.2 steps/s
[Step=7100 Epoch=13.8] | Loss=0.03698 | Reg=0.00375 | acc=0.9688 | FP-Norm=1.911 | FP-Norm(final)=2.391 | 4003.9 samples/s | 62.6 steps/s
[Step=7150 Epoch=13.9] | Loss=0.03653 | Reg=0.00386 | acc=0.9688 | FP-Norm=1.940 | FP-Norm(final)=2.391 | 4021.0 samples/s | 62.8 steps/s
[Step=7200 Epoch=14.0] | Loss=0.03631 | Reg=0.00398 | acc=0.9531 | FP-Norm=1.967 | FP-Norm(final)=2.391 | 3986.1 samples/s | 62.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step7200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=12.5] | Loss=0.33935 | Reg=0.00000 | acc=0.7500 | FP-Norm=0.000 | FP-Norm(final)=2.414 | 3737.5 samples/s | 58.4 steps/s
[Step=6450 Epoch=12.6] | Loss=0.05240 | Reg=0.00215 | acc=0.9844 | FP-Norm=1.414 | FP-Norm(final)=2.398 | 3754.4 samples/s | 58.7 steps/s
[Step=6500 Epoch=12.7] | Loss=0.04584 | Reg=0.00236 | acc=0.9844 | FP-Norm=1.510 | FP-Norm(final)=2.400 | 3844.4 samples/s | 60.1 steps/s
[Step=6550 Epoch=12.8] | Loss=0.04359 | Reg=0.00251 | acc=0.9688 | FP-Norm=1.565 | FP-Norm(final)=2.399 | 3920.2 samples/s | 61.3 steps/s
[Step=6600 Epoch=12.9] | Loss=0.04521 | Reg=0.00266 | acc=0.9844 | FP-Norm=1.613 | FP-Norm(final)=2.395 | 3885.3 samples/s | 60.7 steps/s
[Step=6650 Epoch=13.0] | Loss=0.04430 | Reg=0.00279 | acc=0.9688 | FP-Norm=1.656 | FP-Norm(final)=2.393 | 3916.4 samples/s | 61.2 steps/s
[Step=6700 Epoch=13.1] | Loss=0.04215 | Reg=0.00292 | acc=0.9688 | FP-Norm=1.693 | FP-Norm(final)=2.392 | 3904.0 samples/s | 61.0 steps/s
[Step=6750 Epoch=13.2] | Loss=0.04180 | Reg=0.00305 | acc=0.9688 | FP-Norm=1.732 | FP-Norm(final)=2.391 | 3895.0 samples/s | 60.9 steps/s
[Step=6800 Epoch=13.3] | Loss=0.04066 | Reg=0.00319 | acc=0.9844 | FP-Norm=1.770 | FP-Norm(final)=2.389 | 3909.0 samples/s | 61.1 steps/s
[Step=6850 Epoch=13.4] | Loss=0.04025 | Reg=0.00334 | acc=1.0000 | FP-Norm=1.810 | FP-Norm(final)=2.389 | 3898.3 samples/s | 60.9 steps/s
[Step=6900 Epoch=13.5] | Loss=0.04033 | Reg=0.00348 | acc=1.0000 | FP-Norm=1.847 | FP-Norm(final)=2.388 | 4690.9 samples/s | 73.3 steps/s
[Step=6950 Epoch=13.6] | Loss=0.03996 | Reg=0.00361 | acc=0.9531 | FP-Norm=1.881 | FP-Norm(final)=2.388 | 1714.5 samples/s | 26.8 steps/s
[Step=7000 Epoch=13.7] | Loss=0.03927 | Reg=0.00373 | acc=0.9688 | FP-Norm=1.910 | FP-Norm(final)=2.387 | 3882.2 samples/s | 60.7 steps/s
[Step=7050 Epoch=13.8] | Loss=0.03836 | Reg=0.00383 | acc=0.9531 | FP-Norm=1.937 | FP-Norm(final)=2.387 | 3878.0 samples/s | 60.6 steps/s
[Step=7100 Epoch=13.9] | Loss=0.03751 | Reg=0.00394 | acc=0.9844 | FP-Norm=1.964 | FP-Norm(final)=2.387 | 3912.0 samples/s | 61.1 steps/s
[Step=7150 Epoch=14.0] | Loss=0.03708 | Reg=0.00405 | acc=0.9531 | FP-Norm=1.990 | FP-Norm(final)=2.387 | 3914.3 samples/s | 61.2 steps/s
[Step=7200 Epoch=14.1] | Loss=0.03698 | Reg=0.00415 | acc=0.9375 | FP-Norm=2.016 | FP-Norm(final)=2.387 | 3868.9 samples/s | 60.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step7200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=24.5] | Loss=0.06563 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.416 | 3661.6 samples/s | 57.2 steps/s
[Step=6450 Epoch=24.7] | Loss=0.01605 | Reg=0.00435 | acc=1.0000 | FP-Norm=1.978 | FP-Norm(final)=2.408 | 3629.5 samples/s | 56.7 steps/s
[Step=6500 Epoch=24.9] | Loss=0.00948 | Reg=0.00524 | acc=1.0000 | FP-Norm=2.228 | FP-Norm(final)=2.398 | 3674.8 samples/s | 57.4 steps/s
[Step=6550 Epoch=25.1] | Loss=0.00738 | Reg=0.00521 | acc=0.9844 | FP-Norm=2.240 | FP-Norm(final)=2.399 | 3704.7 samples/s | 57.9 steps/s
[Step=6600 Epoch=25.3] | Loss=0.00705 | Reg=0.00541 | acc=1.0000 | FP-Norm=2.294 | FP-Norm(final)=2.398 | 3712.2 samples/s | 58.0 steps/s
[Step=6650 Epoch=25.5] | Loss=0.00608 | Reg=0.00558 | acc=1.0000 | FP-Norm=2.336 | FP-Norm(final)=2.396 | 4536.0 samples/s | 70.9 steps/s
[Step=6700 Epoch=25.7] | Loss=0.00510 | Reg=0.00557 | acc=1.0000 | FP-Norm=2.337 | FP-Norm(final)=2.397 | 1674.8 samples/s | 26.2 steps/s
[Step=6750 Epoch=25.9] | Loss=0.00438 | Reg=0.00546 | acc=1.0000 | FP-Norm=2.315 | FP-Norm(final)=2.399 | 3776.4 samples/s | 59.0 steps/s
[Step=6800 Epoch=26.1] | Loss=0.00385 | Reg=0.00530 | acc=1.0000 | FP-Norm=2.283 | FP-Norm(final)=2.401 | 3775.3 samples/s | 59.0 steps/s
[Step=6850 Epoch=26.2] | Loss=0.00343 | Reg=0.00513 | acc=1.0000 | FP-Norm=2.245 | FP-Norm(final)=2.404 | 3824.5 samples/s | 59.8 steps/s
[Step=6900 Epoch=26.4] | Loss=0.00309 | Reg=0.00496 | acc=1.0000 | FP-Norm=2.205 | FP-Norm(final)=2.406 | 4079.8 samples/s | 63.7 steps/s
[Step=6950 Epoch=26.6] | Loss=0.00284 | Reg=0.00480 | acc=1.0000 | FP-Norm=2.167 | FP-Norm(final)=2.408 | 1736.6 samples/s | 27.1 steps/s
[Step=7000 Epoch=26.8] | Loss=0.00261 | Reg=0.00464 | acc=1.0000 | FP-Norm=2.129 | FP-Norm(final)=2.410 | 3687.2 samples/s | 57.6 steps/s
[Step=7050 Epoch=27.0] | Loss=0.00241 | Reg=0.00449 | acc=1.0000 | FP-Norm=2.090 | FP-Norm(final)=2.412 | 3705.8 samples/s | 57.9 steps/s
[Step=7100 Epoch=27.2] | Loss=0.00224 | Reg=0.00434 | acc=1.0000 | FP-Norm=2.052 | FP-Norm(final)=2.414 | 3709.4 samples/s | 58.0 steps/s
[Step=7150 Epoch=27.4] | Loss=0.00210 | Reg=0.00420 | acc=1.0000 | FP-Norm=2.013 | FP-Norm(final)=2.416 | 3670.5 samples/s | 57.4 steps/s
[Step=7200 Epoch=27.6] | Loss=0.00197 | Reg=0.00406 | acc=1.0000 | FP-Norm=1.976 | FP-Norm(final)=2.418 | 1806.5 samples/s | 28.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step7200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=24.6] | Loss=0.05531 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.416 | 3756.3 samples/s | 58.7 steps/s
[Step=6450 Epoch=24.8] | Loss=0.01460 | Reg=0.00437 | acc=1.0000 | FP-Norm=1.989 | FP-Norm(final)=2.411 | 3471.9 samples/s | 54.2 steps/s
[Step=6500 Epoch=25.0] | Loss=0.00991 | Reg=0.00478 | acc=1.0000 | FP-Norm=2.134 | FP-Norm(final)=2.405 | 3676.3 samples/s | 57.4 steps/s
[Step=6550 Epoch=25.2] | Loss=0.00682 | Reg=0.00461 | acc=1.0000 | FP-Norm=2.111 | FP-Norm(final)=2.408 | 3761.0 samples/s | 58.8 steps/s
[Step=6600 Epoch=25.4] | Loss=0.00532 | Reg=0.00435 | acc=1.0000 | FP-Norm=2.054 | FP-Norm(final)=2.414 | 3672.0 samples/s | 57.4 steps/s
[Step=6650 Epoch=25.6] | Loss=0.00447 | Reg=0.00413 | acc=1.0000 | FP-Norm=2.005 | FP-Norm(final)=2.419 | 4571.2 samples/s | 71.4 steps/s
[Step=6700 Epoch=25.8] | Loss=0.00383 | Reg=0.00395 | acc=1.0000 | FP-Norm=1.963 | FP-Norm(final)=2.424 | 1637.4 samples/s | 25.6 steps/s
[Step=6750 Epoch=26.0] | Loss=0.00335 | Reg=0.00378 | acc=1.0000 | FP-Norm=1.919 | FP-Norm(final)=2.429 | 3698.1 samples/s | 57.8 steps/s
[Step=6800 Epoch=26.2] | Loss=0.00331 | Reg=0.00367 | acc=1.0000 | FP-Norm=1.893 | FP-Norm(final)=2.432 | 3706.0 samples/s | 57.9 steps/s
[Step=6850 Epoch=26.4] | Loss=0.00338 | Reg=0.00369 | acc=1.0000 | FP-Norm=1.898 | FP-Norm(final)=2.434 | 3729.9 samples/s | 58.3 steps/s
[Step=6900 Epoch=26.6] | Loss=0.00319 | Reg=0.00381 | acc=1.0000 | FP-Norm=1.931 | FP-Norm(final)=2.435 | 4097.6 samples/s | 64.0 steps/s
[Step=6950 Epoch=26.8] | Loss=0.00300 | Reg=0.00388 | acc=1.0000 | FP-Norm=1.949 | FP-Norm(final)=2.436 | 1720.3 samples/s | 26.9 steps/s
[Step=7000 Epoch=26.9] | Loss=0.00305 | Reg=0.00404 | acc=1.0000 | FP-Norm=1.987 | FP-Norm(final)=2.438 | 3819.7 samples/s | 59.7 steps/s
[Step=7050 Epoch=27.1] | Loss=0.00323 | Reg=0.00426 | acc=0.9688 | FP-Norm=2.036 | FP-Norm(final)=2.439 | 3764.2 samples/s | 58.8 steps/s
[Step=7100 Epoch=27.3] | Loss=0.00374 | Reg=0.00466 | acc=1.0000 | FP-Norm=2.115 | FP-Norm(final)=2.435 | 3762.6 samples/s | 58.8 steps/s
[Step=7150 Epoch=27.5] | Loss=0.00368 | Reg=0.00497 | acc=1.0000 | FP-Norm=2.178 | FP-Norm(final)=2.432 | 3749.4 samples/s | 58.6 steps/s
[Step=7200 Epoch=27.7] | Loss=0.00350 | Reg=0.00517 | acc=1.0000 | FP-Norm=2.220 | FP-Norm(final)=2.430 | 1790.3 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36079 | acc=0.7395 | tpr=0.6265 | fpr=0.0154 | 3830.1 samples/s | 15.0 steps/s
Avg test loss: 0.36592, Avg test acc: 0.73736, Avg tpr: 0.62505, Avg fpr: 0.01564, total FA: 122

Testing server on iccad2012
[Step=  50] | Loss=0.20469 | acc=0.8759 | tpr=0.9336 | fpr=0.1251 | 3817.9 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.20283 | acc=0.8800 | tpr=0.9488 | fpr=0.1213 | 7331.1 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.20778 | acc=0.8774 | tpr=0.9539 | fpr=0.1240 | 7402.2 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.20989 | acc=0.8763 | tpr=0.9563 | fpr=0.1252 | 7606.3 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.20865 | acc=0.8762 | tpr=0.9572 | fpr=0.1252 | 7186.3 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.20996 | acc=0.8762 | tpr=0.9564 | fpr=0.1253 | 7287.7 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.21087 | acc=0.8762 | tpr=0.9593 | fpr=0.1253 | 7379.8 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.21161 | acc=0.8757 | tpr=0.9579 | fpr=0.1258 | 7179.0 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.21309 | acc=0.8752 | tpr=0.9581 | fpr=0.1263 | 7383.2 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.21308 | acc=0.8750 | tpr=0.9586 | fpr=0.1265 | 7157.7 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.21296 | acc=0.8749 | tpr=0.9582 | fpr=0.1266 | 13081.6 samples/s | 51.1 steps/s
Avg test loss: 0.21280, Avg test acc: 0.87492, Avg tpr: 0.95800, Avg fpr: 0.12659, total FA: 17577

server round 9/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=14.0] | Loss=0.33646 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.393 | 3462.0 samples/s | 54.1 steps/s
[Step=7250 Epoch=14.1] | Loss=0.05722 | Reg=0.00217 | acc=0.9844 | FP-Norm=1.412 | FP-Norm(final)=2.374 | 3769.2 samples/s | 58.9 steps/s
[Step=7300 Epoch=14.2] | Loss=0.04940 | Reg=0.00255 | acc=0.9375 | FP-Norm=1.563 | FP-Norm(final)=2.374 | 3873.3 samples/s | 60.5 steps/s
[Step=7350 Epoch=14.3] | Loss=0.04521 | Reg=0.00276 | acc=0.9688 | FP-Norm=1.637 | FP-Norm(final)=2.371 | 3906.0 samples/s | 61.0 steps/s
[Step=7400 Epoch=14.4] | Loss=0.04291 | Reg=0.00289 | acc=0.9844 | FP-Norm=1.680 | FP-Norm(final)=2.372 | 3880.5 samples/s | 60.6 steps/s
[Step=7450 Epoch=14.5] | Loss=0.04270 | Reg=0.00303 | acc=0.9688 | FP-Norm=1.724 | FP-Norm(final)=2.371 | 3927.8 samples/s | 61.4 steps/s
[Step=7500 Epoch=14.6] | Loss=0.04204 | Reg=0.00317 | acc=0.9844 | FP-Norm=1.765 | FP-Norm(final)=2.369 | 3901.1 samples/s | 61.0 steps/s
[Step=7550 Epoch=14.7] | Loss=0.04169 | Reg=0.00334 | acc=1.0000 | FP-Norm=1.810 | FP-Norm(final)=2.368 | 3868.4 samples/s | 60.4 steps/s
[Step=7600 Epoch=14.8] | Loss=0.04115 | Reg=0.00350 | acc=0.9844 | FP-Norm=1.852 | FP-Norm(final)=2.366 | 3900.1 samples/s | 60.9 steps/s
[Step=7650 Epoch=14.9] | Loss=0.04069 | Reg=0.00363 | acc=0.9844 | FP-Norm=1.886 | FP-Norm(final)=2.365 | 3926.5 samples/s | 61.4 steps/s
[Step=7700 Epoch=15.0] | Loss=0.04053 | Reg=0.00375 | acc=1.0000 | FP-Norm=1.918 | FP-Norm(final)=2.362 | 4602.8 samples/s | 71.9 steps/s
[Step=7750 Epoch=15.1] | Loss=0.03975 | Reg=0.00388 | acc=0.9688 | FP-Norm=1.949 | FP-Norm(final)=2.360 | 1661.7 samples/s | 26.0 steps/s
[Step=7800 Epoch=15.2] | Loss=0.03873 | Reg=0.00400 | acc=0.9844 | FP-Norm=1.979 | FP-Norm(final)=2.360 | 3974.6 samples/s | 62.1 steps/s
[Step=7850 Epoch=15.3] | Loss=0.03788 | Reg=0.00410 | acc=1.0000 | FP-Norm=2.005 | FP-Norm(final)=2.359 | 3996.9 samples/s | 62.5 steps/s
[Step=7900 Epoch=15.4] | Loss=0.03677 | Reg=0.00420 | acc=0.9688 | FP-Norm=2.028 | FP-Norm(final)=2.359 | 4031.6 samples/s | 63.0 steps/s
[Step=7950 Epoch=15.5] | Loss=0.03642 | Reg=0.00428 | acc=1.0000 | FP-Norm=2.049 | FP-Norm(final)=2.358 | 3978.7 samples/s | 62.2 steps/s
[Step=8000 Epoch=15.6] | Loss=0.03614 | Reg=0.00438 | acc=1.0000 | FP-Norm=2.072 | FP-Norm(final)=2.358 | 4016.9 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=14.1] | Loss=0.27057 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.393 | 3814.2 samples/s | 59.6 steps/s
[Step=7250 Epoch=14.2] | Loss=0.05966 | Reg=0.00203 | acc=0.9531 | FP-Norm=1.361 | FP-Norm(final)=2.378 | 3720.8 samples/s | 58.1 steps/s
[Step=7300 Epoch=14.3] | Loss=0.05082 | Reg=0.00237 | acc=0.9844 | FP-Norm=1.504 | FP-Norm(final)=2.379 | 3995.5 samples/s | 62.4 steps/s
[Step=7350 Epoch=14.4] | Loss=0.04496 | Reg=0.00254 | acc=0.9688 | FP-Norm=1.567 | FP-Norm(final)=2.382 | 3976.3 samples/s | 62.1 steps/s
[Step=7400 Epoch=14.5] | Loss=0.04216 | Reg=0.00268 | acc=0.9688 | FP-Norm=1.615 | FP-Norm(final)=2.385 | 3978.2 samples/s | 62.2 steps/s
[Step=7450 Epoch=14.6] | Loss=0.04081 | Reg=0.00289 | acc=0.9531 | FP-Norm=1.679 | FP-Norm(final)=2.386 | 3905.6 samples/s | 61.0 steps/s
[Step=7500 Epoch=14.7] | Loss=0.04116 | Reg=0.00309 | acc=0.9688 | FP-Norm=1.735 | FP-Norm(final)=2.384 | 3906.0 samples/s | 61.0 steps/s
[Step=7550 Epoch=14.8] | Loss=0.04099 | Reg=0.00325 | acc=0.9688 | FP-Norm=1.782 | FP-Norm(final)=2.381 | 3899.4 samples/s | 60.9 steps/s
[Step=7600 Epoch=14.9] | Loss=0.04108 | Reg=0.00342 | acc=0.9375 | FP-Norm=1.828 | FP-Norm(final)=2.379 | 3941.6 samples/s | 61.6 steps/s
[Step=7650 Epoch=15.0] | Loss=0.04025 | Reg=0.00357 | acc=0.9844 | FP-Norm=1.868 | FP-Norm(final)=2.376 | 3910.5 samples/s | 61.1 steps/s
[Step=7700 Epoch=15.1] | Loss=0.03995 | Reg=0.00370 | acc=1.0000 | FP-Norm=1.902 | FP-Norm(final)=2.375 | 4673.3 samples/s | 73.0 steps/s
[Step=7750 Epoch=15.2] | Loss=0.03902 | Reg=0.00382 | acc=0.9844 | FP-Norm=1.932 | FP-Norm(final)=2.374 | 1708.3 samples/s | 26.7 steps/s
[Step=7800 Epoch=15.2] | Loss=0.03784 | Reg=0.00393 | acc=1.0000 | FP-Norm=1.960 | FP-Norm(final)=2.373 | 3894.3 samples/s | 60.8 steps/s
[Step=7850 Epoch=15.3] | Loss=0.03723 | Reg=0.00403 | acc=0.9688 | FP-Norm=1.986 | FP-Norm(final)=2.373 | 3874.0 samples/s | 60.5 steps/s
[Step=7900 Epoch=15.4] | Loss=0.03658 | Reg=0.00414 | acc=0.9688 | FP-Norm=2.011 | FP-Norm(final)=2.373 | 3891.6 samples/s | 60.8 steps/s
[Step=7950 Epoch=15.5] | Loss=0.03642 | Reg=0.00423 | acc=0.9844 | FP-Norm=2.034 | FP-Norm(final)=2.372 | 3902.0 samples/s | 61.0 steps/s
[Step=8000 Epoch=15.6] | Loss=0.03621 | Reg=0.00432 | acc=0.9531 | FP-Norm=2.056 | FP-Norm(final)=2.372 | 3903.2 samples/s | 61.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step8000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=27.6] | Loss=0.01812 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.395 | 3685.1 samples/s | 57.6 steps/s
[Step=7250 Epoch=27.8] | Loss=0.00605 | Reg=0.00292 | acc=1.0000 | FP-Norm=1.613 | FP-Norm(final)=2.423 | 3568.9 samples/s | 55.8 steps/s
[Step=7300 Epoch=28.0] | Loss=0.00718 | Reg=0.00353 | acc=1.0000 | FP-Norm=1.824 | FP-Norm(final)=2.427 | 3716.2 samples/s | 58.1 steps/s
[Step=7350 Epoch=28.2] | Loss=0.00834 | Reg=0.00464 | acc=1.0000 | FP-Norm=2.087 | FP-Norm(final)=2.411 | 3700.4 samples/s | 57.8 steps/s
[Step=7400 Epoch=28.4] | Loss=0.00705 | Reg=0.00523 | acc=1.0000 | FP-Norm=2.227 | FP-Norm(final)=2.399 | 3723.3 samples/s | 58.2 steps/s
[Step=7450 Epoch=28.5] | Loss=0.00705 | Reg=0.00559 | acc=1.0000 | FP-Norm=2.312 | FP-Norm(final)=2.389 | 4492.4 samples/s | 70.2 steps/s
[Step=7500 Epoch=28.7] | Loss=0.00622 | Reg=0.00592 | acc=1.0000 | FP-Norm=2.384 | FP-Norm(final)=2.381 | 1680.1 samples/s | 26.3 steps/s
[Step=7550 Epoch=28.9] | Loss=0.00540 | Reg=0.00601 | acc=1.0000 | FP-Norm=2.410 | FP-Norm(final)=2.376 | 3795.8 samples/s | 59.3 steps/s
[Step=7600 Epoch=29.1] | Loss=0.00478 | Reg=0.00599 | acc=1.0000 | FP-Norm=2.410 | FP-Norm(final)=2.375 | 3769.7 samples/s | 58.9 steps/s
[Step=7650 Epoch=29.3] | Loss=0.00427 | Reg=0.00590 | acc=1.0000 | FP-Norm=2.397 | FP-Norm(final)=2.374 | 3807.6 samples/s | 59.5 steps/s
[Step=7700 Epoch=29.5] | Loss=0.00386 | Reg=0.00579 | acc=1.0000 | FP-Norm=2.374 | FP-Norm(final)=2.375 | 4131.6 samples/s | 64.6 steps/s
[Step=7750 Epoch=29.7] | Loss=0.00351 | Reg=0.00565 | acc=1.0000 | FP-Norm=2.346 | FP-Norm(final)=2.376 | 1741.4 samples/s | 27.2 steps/s
[Step=7800 Epoch=29.9] | Loss=0.00322 | Reg=0.00550 | acc=1.0000 | FP-Norm=2.314 | FP-Norm(final)=2.377 | 3789.4 samples/s | 59.2 steps/s
[Step=7850 Epoch=30.1] | Loss=0.00298 | Reg=0.00534 | acc=1.0000 | FP-Norm=2.280 | FP-Norm(final)=2.378 | 3714.8 samples/s | 58.0 steps/s
[Step=7900 Epoch=30.3] | Loss=0.00277 | Reg=0.00519 | acc=1.0000 | FP-Norm=2.245 | FP-Norm(final)=2.380 | 3655.6 samples/s | 57.1 steps/s
[Step=7950 Epoch=30.5] | Loss=0.00259 | Reg=0.00504 | acc=1.0000 | FP-Norm=2.209 | FP-Norm(final)=2.381 | 3694.6 samples/s | 57.7 steps/s
[Step=8000 Epoch=30.7] | Loss=0.00243 | Reg=0.00489 | acc=1.0000 | FP-Norm=2.173 | FP-Norm(final)=2.382 | 1788.2 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step8000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=27.7] | Loss=0.05233 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.395 | 3658.6 samples/s | 57.2 steps/s
[Step=7250 Epoch=27.9] | Loss=0.00506 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.197 | FP-Norm(final)=2.419 | 3552.9 samples/s | 55.5 steps/s
[Step=7300 Epoch=28.1] | Loss=0.00370 | Reg=0.00194 | acc=1.0000 | FP-Norm=1.360 | FP-Norm(final)=2.424 | 3695.5 samples/s | 57.7 steps/s
[Step=7350 Epoch=28.3] | Loss=0.00265 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.406 | FP-Norm(final)=2.429 | 3702.0 samples/s | 57.8 steps/s
[Step=7400 Epoch=28.5] | Loss=0.00205 | Reg=0.00201 | acc=1.0000 | FP-Norm=1.398 | FP-Norm(final)=2.434 | 3690.1 samples/s | 57.7 steps/s
[Step=7450 Epoch=28.7] | Loss=0.00171 | Reg=0.00195 | acc=1.0000 | FP-Norm=1.382 | FP-Norm(final)=2.437 | 4585.2 samples/s | 71.6 steps/s
[Step=7500 Epoch=28.9] | Loss=0.00144 | Reg=0.00188 | acc=1.0000 | FP-Norm=1.359 | FP-Norm(final)=2.440 | 1659.2 samples/s | 25.9 steps/s
[Step=7550 Epoch=29.1] | Loss=0.00124 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.332 | FP-Norm(final)=2.443 | 3694.1 samples/s | 57.7 steps/s
[Step=7600 Epoch=29.3] | Loss=0.00110 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.305 | FP-Norm(final)=2.445 | 3699.8 samples/s | 57.8 steps/s
[Step=7650 Epoch=29.4] | Loss=0.00098 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.277 | FP-Norm(final)=2.446 | 3715.8 samples/s | 58.1 steps/s
[Step=7700 Epoch=29.6] | Loss=0.00089 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.250 | FP-Norm(final)=2.447 | 4134.8 samples/s | 64.6 steps/s
[Step=7750 Epoch=29.8] | Loss=0.00081 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.224 | FP-Norm(final)=2.448 | 1696.2 samples/s | 26.5 steps/s
[Step=7800 Epoch=30.0] | Loss=0.00074 | Reg=0.00149 | acc=1.0000 | FP-Norm=1.200 | FP-Norm(final)=2.448 | 3724.4 samples/s | 58.2 steps/s
[Step=7850 Epoch=30.2] | Loss=0.00069 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.176 | FP-Norm(final)=2.449 | 3695.8 samples/s | 57.7 steps/s
[Step=7900 Epoch=30.4] | Loss=0.00065 | Reg=0.00138 | acc=1.0000 | FP-Norm=1.154 | FP-Norm(final)=2.449 | 3686.1 samples/s | 57.6 steps/s
[Step=7950 Epoch=30.6] | Loss=0.00061 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.132 | FP-Norm(final)=2.450 | 3746.4 samples/s | 58.5 steps/s
[Step=8000 Epoch=30.8] | Loss=0.00057 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.112 | FP-Norm(final)=2.450 | 1793.2 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26606 | acc=0.8157 | tpr=0.7384 | fpr=0.0164 | 3881.3 samples/s | 15.2 steps/s
Avg test loss: 0.27133, Avg test acc: 0.81232, Avg tpr: 0.73451, Avg fpr: 0.01654, total FA: 129

Testing server on iccad2012
[Step=  50] | Loss=0.31178 | acc=0.8068 | tpr=0.9425 | fpr=0.1956 | 3893.2 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.30566 | acc=0.8099 | tpr=0.9595 | fpr=0.1929 | 7181.0 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.31060 | acc=0.8086 | tpr=0.9654 | fpr=0.1943 | 7356.2 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.31265 | acc=0.8087 | tpr=0.9672 | fpr=0.1941 | 7289.0 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.31162 | acc=0.8093 | tpr=0.9668 | fpr=0.1936 | 7499.0 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.31208 | acc=0.8096 | tpr=0.9644 | fpr=0.1932 | 7369.8 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.31289 | acc=0.8097 | tpr=0.9649 | fpr=0.1931 | 7355.9 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.31323 | acc=0.8093 | tpr=0.9628 | fpr=0.1934 | 7385.2 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.31470 | acc=0.8090 | tpr=0.9625 | fpr=0.1938 | 7238.2 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.31490 | acc=0.8086 | tpr=0.9626 | fpr=0.1941 | 7031.9 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.31503 | acc=0.8082 | tpr=0.9622 | fpr=0.1946 | 13378.3 samples/s | 52.3 steps/s
Avg test loss: 0.31496, Avg test acc: 0.80822, Avg tpr: 0.96197, Avg fpr: 0.19457, total FA: 27016

server round 10/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=15.6] | Loss=0.12718 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.391 | 3398.4 samples/s | 53.1 steps/s
[Step=8050 Epoch=15.7] | Loss=0.03980 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.684 | FP-Norm(final)=2.387 | 3985.7 samples/s | 62.3 steps/s
[Step=8100 Epoch=15.8] | Loss=0.03076 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.757 | FP-Norm(final)=2.389 | 3957.2 samples/s | 61.8 steps/s
[Step=8150 Epoch=15.9] | Loss=0.02795 | Reg=0.00067 | acc=0.9688 | FP-Norm=0.805 | FP-Norm(final)=2.391 | 3961.0 samples/s | 61.9 steps/s
[Step=8200 Epoch=16.0] | Loss=0.02673 | Reg=0.00074 | acc=0.9844 | FP-Norm=0.847 | FP-Norm(final)=2.394 | 3923.0 samples/s | 61.3 steps/s
[Step=8250 Epoch=16.1] | Loss=0.02570 | Reg=0.00080 | acc=0.9844 | FP-Norm=0.881 | FP-Norm(final)=2.396 | 3873.9 samples/s | 60.5 steps/s
[Step=8300 Epoch=16.2] | Loss=0.02544 | Reg=0.00085 | acc=0.9688 | FP-Norm=0.910 | FP-Norm(final)=2.398 | 3913.8 samples/s | 61.2 steps/s
[Step=8350 Epoch=16.3] | Loss=0.02587 | Reg=0.00091 | acc=0.9844 | FP-Norm=0.940 | FP-Norm(final)=2.400 | 3877.5 samples/s | 60.6 steps/s
[Step=8400 Epoch=16.4] | Loss=0.02579 | Reg=0.00097 | acc=0.9844 | FP-Norm=0.971 | FP-Norm(final)=2.401 | 3982.4 samples/s | 62.2 steps/s
[Step=8450 Epoch=16.5] | Loss=0.02548 | Reg=0.00103 | acc=0.9688 | FP-Norm=0.998 | FP-Norm(final)=2.401 | 4050.2 samples/s | 63.3 steps/s
[Step=8500 Epoch=16.6] | Loss=0.02615 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.021 | FP-Norm(final)=2.401 | 4664.4 samples/s | 72.9 steps/s
[Step=8550 Epoch=16.7] | Loss=0.02566 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.044 | FP-Norm(final)=2.401 | 1643.6 samples/s | 25.7 steps/s
[Step=8600 Epoch=16.8] | Loss=0.02497 | Reg=0.00117 | acc=0.9688 | FP-Norm=1.065 | FP-Norm(final)=2.402 | 3869.7 samples/s | 60.5 steps/s
[Step=8650 Epoch=16.9] | Loss=0.02427 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.084 | FP-Norm(final)=2.403 | 3894.8 samples/s | 60.9 steps/s
[Step=8700 Epoch=17.0] | Loss=0.02374 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.100 | FP-Norm(final)=2.404 | 3861.9 samples/s | 60.3 steps/s
[Step=8750 Epoch=17.1] | Loss=0.02356 | Reg=0.00128 | acc=0.9531 | FP-Norm=1.114 | FP-Norm(final)=2.405 | 3915.4 samples/s | 61.2 steps/s
[Step=8800 Epoch=17.2] | Loss=0.02341 | Reg=0.00132 | acc=0.9844 | FP-Norm=1.129 | FP-Norm(final)=2.406 | 3919.5 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step8800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=15.6] | Loss=0.25873 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.390 | 3549.0 samples/s | 55.5 steps/s
[Step=8050 Epoch=15.7] | Loss=0.04543 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.759 | FP-Norm(final)=2.382 | 4075.6 samples/s | 63.7 steps/s
[Step=8100 Epoch=15.8] | Loss=0.03570 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.831 | FP-Norm(final)=2.383 | 3988.9 samples/s | 62.3 steps/s
[Step=8150 Epoch=15.9] | Loss=0.03323 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.870 | FP-Norm(final)=2.385 | 3966.7 samples/s | 62.0 steps/s
[Step=8200 Epoch=16.0] | Loss=0.03094 | Reg=0.00082 | acc=0.9688 | FP-Norm=0.897 | FP-Norm(final)=2.387 | 3915.5 samples/s | 61.2 steps/s
[Step=8250 Epoch=16.1] | Loss=0.02951 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.923 | FP-Norm(final)=2.390 | 3920.8 samples/s | 61.3 steps/s
[Step=8300 Epoch=16.2] | Loss=0.02870 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.948 | FP-Norm(final)=2.392 | 3930.8 samples/s | 61.4 steps/s
[Step=8350 Epoch=16.3] | Loss=0.02739 | Reg=0.00096 | acc=0.9844 | FP-Norm=0.969 | FP-Norm(final)=2.394 | 3912.8 samples/s | 61.1 steps/s
[Step=8400 Epoch=16.4] | Loss=0.02672 | Reg=0.00099 | acc=0.9531 | FP-Norm=0.987 | FP-Norm(final)=2.396 | 3912.9 samples/s | 61.1 steps/s
[Step=8450 Epoch=16.5] | Loss=0.02662 | Reg=0.00103 | acc=0.9844 | FP-Norm=1.005 | FP-Norm(final)=2.398 | 3915.5 samples/s | 61.2 steps/s
[Step=8500 Epoch=16.6] | Loss=0.02602 | Reg=0.00106 | acc=0.9688 | FP-Norm=1.022 | FP-Norm(final)=2.400 | 4724.1 samples/s | 73.8 steps/s
[Step=8550 Epoch=16.7] | Loss=0.02595 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.040 | FP-Norm(final)=2.402 | 1705.7 samples/s | 26.7 steps/s
[Step=8600 Epoch=16.8] | Loss=0.02499 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.057 | FP-Norm(final)=2.403 | 3885.0 samples/s | 60.7 steps/s
[Step=8650 Epoch=16.9] | Loss=0.02444 | Reg=0.00117 | acc=0.9531 | FP-Norm=1.071 | FP-Norm(final)=2.405 | 3920.3 samples/s | 61.3 steps/s
[Step=8700 Epoch=17.0] | Loss=0.02382 | Reg=0.00120 | acc=0.9531 | FP-Norm=1.086 | FP-Norm(final)=2.407 | 3868.3 samples/s | 60.4 steps/s
[Step=8750 Epoch=17.1] | Loss=0.02333 | Reg=0.00124 | acc=0.9844 | FP-Norm=1.100 | FP-Norm(final)=2.410 | 3878.4 samples/s | 60.6 steps/s
[Step=8800 Epoch=17.2] | Loss=0.02271 | Reg=0.00127 | acc=0.9688 | FP-Norm=1.114 | FP-Norm(final)=2.412 | 3925.4 samples/s | 61.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step8800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=30.7] | Loss=0.05521 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.391 | 3616.3 samples/s | 56.5 steps/s
[Step=8050 Epoch=30.8] | Loss=0.00757 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.230 | FP-Norm(final)=2.406 | 3681.2 samples/s | 57.5 steps/s
[Step=8100 Epoch=31.0] | Loss=0.00444 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.348 | FP-Norm(final)=2.410 | 3828.5 samples/s | 59.8 steps/s
[Step=8150 Epoch=31.2] | Loss=0.00307 | Reg=0.00188 | acc=1.0000 | FP-Norm=1.348 | FP-Norm(final)=2.414 | 3778.0 samples/s | 59.0 steps/s
[Step=8200 Epoch=31.4] | Loss=0.00236 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.325 | FP-Norm(final)=2.417 | 3791.5 samples/s | 59.2 steps/s
[Step=8250 Epoch=31.6] | Loss=0.00192 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.295 | FP-Norm(final)=2.420 | 4623.0 samples/s | 72.2 steps/s
[Step=8300 Epoch=31.8] | Loss=0.00161 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.264 | FP-Norm(final)=2.422 | 1678.2 samples/s | 26.2 steps/s
[Step=8350 Epoch=32.0] | Loss=0.00139 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.234 | FP-Norm(final)=2.423 | 3707.5 samples/s | 57.9 steps/s
[Step=8400 Epoch=32.2] | Loss=0.00122 | Reg=0.00149 | acc=1.0000 | FP-Norm=1.204 | FP-Norm(final)=2.424 | 3680.9 samples/s | 57.5 steps/s
[Step=8450 Epoch=32.4] | Loss=0.00109 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.177 | FP-Norm(final)=2.425 | 3699.3 samples/s | 57.8 steps/s
[Step=8500 Epoch=32.6] | Loss=0.00099 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.151 | FP-Norm(final)=2.426 | 4056.2 samples/s | 63.4 steps/s
[Step=8550 Epoch=32.8] | Loss=0.00090 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.127 | FP-Norm(final)=2.426 | 1731.3 samples/s | 27.1 steps/s
[Step=8600 Epoch=33.0] | Loss=0.00083 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.104 | FP-Norm(final)=2.427 | 3834.3 samples/s | 59.9 steps/s
[Step=8650 Epoch=33.1] | Loss=0.00077 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.083 | FP-Norm(final)=2.428 | 3801.7 samples/s | 59.4 steps/s
[Step=8700 Epoch=33.3] | Loss=0.00072 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.063 | FP-Norm(final)=2.428 | 3771.9 samples/s | 58.9 steps/s
[Step=8750 Epoch=33.5] | Loss=0.00068 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.044 | FP-Norm(final)=2.429 | 3733.9 samples/s | 58.3 steps/s
[Step=8800 Epoch=33.7] | Loss=0.00064 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.026 | FP-Norm(final)=2.429 | 1770.4 samples/s | 27.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step8800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=30.8] | Loss=0.07538 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.390 | 3637.1 samples/s | 56.8 steps/s
[Step=8050 Epoch=31.0] | Loss=0.00894 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.297 | FP-Norm(final)=2.395 | 3631.7 samples/s | 56.7 steps/s
[Step=8100 Epoch=31.2] | Loss=0.00527 | Reg=0.00195 | acc=1.0000 | FP-Norm=1.365 | FP-Norm(final)=2.400 | 3727.6 samples/s | 58.2 steps/s
[Step=8150 Epoch=31.4] | Loss=0.00357 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.345 | FP-Norm(final)=2.404 | 3697.7 samples/s | 57.8 steps/s
[Step=8200 Epoch=31.6] | Loss=0.00281 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.316 | FP-Norm(final)=2.407 | 3706.6 samples/s | 57.9 steps/s
[Step=8250 Epoch=31.8] | Loss=0.00235 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.289 | FP-Norm(final)=2.410 | 4565.2 samples/s | 71.3 steps/s
[Step=8300 Epoch=31.9] | Loss=0.00197 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.264 | FP-Norm(final)=2.412 | 1649.3 samples/s | 25.8 steps/s
[Step=8350 Epoch=32.1] | Loss=0.00171 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.238 | FP-Norm(final)=2.414 | 3702.1 samples/s | 57.8 steps/s
[Step=8400 Epoch=32.3] | Loss=0.00150 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.212 | FP-Norm(final)=2.416 | 3706.0 samples/s | 57.9 steps/s
[Step=8450 Epoch=32.5] | Loss=0.00134 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.187 | FP-Norm(final)=2.418 | 3714.8 samples/s | 58.0 steps/s
[Step=8500 Epoch=32.7] | Loss=0.00121 | Reg=0.00139 | acc=1.0000 | FP-Norm=1.164 | FP-Norm(final)=2.419 | 4109.2 samples/s | 64.2 steps/s
[Step=8550 Epoch=32.9] | Loss=0.00111 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.141 | FP-Norm(final)=2.420 | 1723.3 samples/s | 26.9 steps/s
[Step=8600 Epoch=33.1] | Loss=0.00102 | Reg=0.00129 | acc=1.0000 | FP-Norm=1.119 | FP-Norm(final)=2.421 | 3710.8 samples/s | 58.0 steps/s
[Step=8650 Epoch=33.3] | Loss=0.00095 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.099 | FP-Norm(final)=2.422 | 3706.2 samples/s | 57.9 steps/s
[Step=8700 Epoch=33.5] | Loss=0.00088 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.079 | FP-Norm(final)=2.423 | 3718.3 samples/s | 58.1 steps/s
[Step=8750 Epoch=33.7] | Loss=0.00083 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.061 | FP-Norm(final)=2.423 | 3757.4 samples/s | 58.7 steps/s
[Step=8800 Epoch=33.9] | Loss=0.00078 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.043 | FP-Norm(final)=2.424 | 1779.2 samples/s | 27.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28287 | acc=0.8167 | tpr=0.7384 | fpr=0.0131 | 3832.7 samples/s | 15.0 steps/s
Avg test loss: 0.28851, Avg test acc: 0.81489, Avg tpr: 0.73713, Avg fpr: 0.01410, total FA: 110

Testing server on iccad2012
[Step=  50] | Loss=0.32115 | acc=0.8266 | tpr=0.9469 | fpr=0.1755 | 3853.6 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.31645 | acc=0.8296 | tpr=0.9595 | fpr=0.1728 | 7234.0 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.32197 | acc=0.8295 | tpr=0.9669 | fpr=0.1730 | 7446.6 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.32484 | acc=0.8292 | tpr=0.9683 | fpr=0.1733 | 7235.6 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.32334 | acc=0.8287 | tpr=0.9686 | fpr=0.1738 | 7349.9 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.32419 | acc=0.8290 | tpr=0.9680 | fpr=0.1736 | 7289.6 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.32524 | acc=0.8290 | tpr=0.9687 | fpr=0.1736 | 7394.1 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.32579 | acc=0.8289 | tpr=0.9672 | fpr=0.1736 | 7170.7 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.32724 | acc=0.8289 | tpr=0.9679 | fpr=0.1737 | 7203.8 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.32746 | acc=0.8284 | tpr=0.9687 | fpr=0.1741 | 7314.3 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.32730 | acc=0.8282 | tpr=0.9682 | fpr=0.1743 | 13561.6 samples/s | 53.0 steps/s
Avg test loss: 0.32712, Avg test acc: 0.82825, Avg tpr: 0.96791, Avg fpr: 0.17428, total FA: 24199

server round 11/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=17.2] | Loss=0.24638 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.433 | 3472.9 samples/s | 54.3 steps/s
[Step=8850 Epoch=17.3] | Loss=0.03670 | Reg=0.00078 | acc=0.9688 | FP-Norm=0.846 | FP-Norm(final)=2.424 | 3897.0 samples/s | 60.9 steps/s
[Step=8900 Epoch=17.4] | Loss=0.02812 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.907 | FP-Norm(final)=2.426 | 3973.5 samples/s | 62.1 steps/s
[Step=8950 Epoch=17.5] | Loss=0.02687 | Reg=0.00089 | acc=0.9844 | FP-Norm=0.932 | FP-Norm(final)=2.428 | 3913.8 samples/s | 61.2 steps/s
[Step=9000 Epoch=17.6] | Loss=0.02688 | Reg=0.00093 | acc=0.9531 | FP-Norm=0.955 | FP-Norm(final)=2.428 | 3874.1 samples/s | 60.5 steps/s
[Step=9050 Epoch=17.7] | Loss=0.02542 | Reg=0.00097 | acc=0.9844 | FP-Norm=0.975 | FP-Norm(final)=2.428 | 3912.3 samples/s | 61.1 steps/s
[Step=9100 Epoch=17.7] | Loss=0.02447 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.994 | FP-Norm(final)=2.429 | 3921.6 samples/s | 61.3 steps/s
[Step=9150 Epoch=17.8] | Loss=0.02492 | Reg=0.00104 | acc=0.9688 | FP-Norm=1.011 | FP-Norm(final)=2.431 | 3898.5 samples/s | 60.9 steps/s
[Step=9200 Epoch=17.9] | Loss=0.02471 | Reg=0.00108 | acc=0.9688 | FP-Norm=1.032 | FP-Norm(final)=2.431 | 3903.0 samples/s | 61.0 steps/s
[Step=9250 Epoch=18.0] | Loss=0.02445 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.051 | FP-Norm(final)=2.432 | 3916.3 samples/s | 61.2 steps/s
[Step=9300 Epoch=18.1] | Loss=0.02398 | Reg=0.00116 | acc=0.9844 | FP-Norm=1.067 | FP-Norm(final)=2.432 | 4610.1 samples/s | 72.0 steps/s
[Step=9350 Epoch=18.2] | Loss=0.02360 | Reg=0.00119 | acc=0.9531 | FP-Norm=1.084 | FP-Norm(final)=2.433 | 1685.5 samples/s | 26.3 steps/s
[Step=9400 Epoch=18.3] | Loss=0.02340 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.098 | FP-Norm(final)=2.434 | 3858.9 samples/s | 60.3 steps/s
[Step=9450 Epoch=18.4] | Loss=0.02309 | Reg=0.00126 | acc=0.9844 | FP-Norm=1.112 | FP-Norm(final)=2.435 | 3896.4 samples/s | 60.9 steps/s
[Step=9500 Epoch=18.5] | Loss=0.02253 | Reg=0.00129 | acc=1.0000 | FP-Norm=1.125 | FP-Norm(final)=2.436 | 3919.4 samples/s | 61.2 steps/s
[Step=9550 Epoch=18.6] | Loss=0.02196 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.137 | FP-Norm(final)=2.438 | 3965.4 samples/s | 62.0 steps/s
[Step=9600 Epoch=18.7] | Loss=0.02165 | Reg=0.00134 | acc=0.9844 | FP-Norm=1.149 | FP-Norm(final)=2.439 | 4037.7 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step9600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=17.2] | Loss=0.19307 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.434 | 3706.5 samples/s | 57.9 steps/s
[Step=8850 Epoch=17.3] | Loss=0.04494 | Reg=0.00092 | acc=0.9844 | FP-Norm=0.919 | FP-Norm(final)=2.421 | 3768.4 samples/s | 58.9 steps/s
[Step=8900 Epoch=17.4] | Loss=0.03550 | Reg=0.00099 | acc=0.9844 | FP-Norm=0.977 | FP-Norm(final)=2.422 | 3917.3 samples/s | 61.2 steps/s
[Step=8950 Epoch=17.5] | Loss=0.03153 | Reg=0.00101 | acc=0.9688 | FP-Norm=0.991 | FP-Norm(final)=2.424 | 3887.9 samples/s | 60.7 steps/s
[Step=9000 Epoch=17.6] | Loss=0.02933 | Reg=0.00103 | acc=0.9688 | FP-Norm=1.006 | FP-Norm(final)=2.427 | 3916.7 samples/s | 61.2 steps/s
[Step=9050 Epoch=17.7] | Loss=0.02826 | Reg=0.00106 | acc=0.9844 | FP-Norm=1.021 | FP-Norm(final)=2.429 | 3906.3 samples/s | 61.0 steps/s
[Step=9100 Epoch=17.8] | Loss=0.02645 | Reg=0.00109 | acc=0.9844 | FP-Norm=1.034 | FP-Norm(final)=2.430 | 3905.7 samples/s | 61.0 steps/s
[Step=9150 Epoch=17.9] | Loss=0.02562 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.045 | FP-Norm(final)=2.432 | 3910.2 samples/s | 61.1 steps/s
[Step=9200 Epoch=18.0] | Loss=0.02464 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.057 | FP-Norm(final)=2.435 | 3919.0 samples/s | 61.2 steps/s
[Step=9250 Epoch=18.1] | Loss=0.02398 | Reg=0.00115 | acc=0.9844 | FP-Norm=1.068 | FP-Norm(final)=2.437 | 3874.4 samples/s | 60.5 steps/s
[Step=9300 Epoch=18.2] | Loss=0.02374 | Reg=0.00119 | acc=0.9531 | FP-Norm=1.083 | FP-Norm(final)=2.439 | 4678.9 samples/s | 73.1 steps/s
[Step=9350 Epoch=18.3] | Loss=0.02292 | Reg=0.00121 | acc=0.9844 | FP-Norm=1.094 | FP-Norm(final)=2.441 | 1700.8 samples/s | 26.6 steps/s
[Step=9400 Epoch=18.4] | Loss=0.02244 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.105 | FP-Norm(final)=2.442 | 3884.6 samples/s | 60.7 steps/s
[Step=9450 Epoch=18.5] | Loss=0.02201 | Reg=0.00126 | acc=0.9688 | FP-Norm=1.115 | FP-Norm(final)=2.444 | 3921.0 samples/s | 61.3 steps/s
[Step=9500 Epoch=18.6] | Loss=0.02150 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.125 | FP-Norm(final)=2.445 | 3921.9 samples/s | 61.3 steps/s
[Step=9550 Epoch=18.7] | Loss=0.02113 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.135 | FP-Norm(final)=2.447 | 3890.4 samples/s | 60.8 steps/s
[Step=9600 Epoch=18.8] | Loss=0.02108 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.143 | FP-Norm(final)=2.448 | 3911.3 samples/s | 61.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step9600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=33.7] | Loss=0.08326 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.434 | 3668.8 samples/s | 57.3 steps/s
[Step=8850 Epoch=33.9] | Loss=0.00644 | Reg=0.00195 | acc=1.0000 | FP-Norm=1.325 | FP-Norm(final)=2.437 | 3546.2 samples/s | 55.4 steps/s
[Step=8900 Epoch=34.1] | Loss=0.00357 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.419 | FP-Norm(final)=2.442 | 3693.2 samples/s | 57.7 steps/s
[Step=8950 Epoch=34.3] | Loss=0.00248 | Reg=0.00207 | acc=1.0000 | FP-Norm=1.414 | FP-Norm(final)=2.447 | 3691.3 samples/s | 57.7 steps/s
[Step=9000 Epoch=34.5] | Loss=0.00189 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.384 | FP-Norm(final)=2.450 | 3704.4 samples/s | 57.9 steps/s
[Step=9050 Epoch=34.7] | Loss=0.00164 | Reg=0.00189 | acc=1.0000 | FP-Norm=1.358 | FP-Norm(final)=2.453 | 4540.2 samples/s | 70.9 steps/s
[Step=9100 Epoch=34.9] | Loss=0.00139 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.341 | FP-Norm(final)=2.455 | 1657.8 samples/s | 25.9 steps/s
[Step=9150 Epoch=35.1] | Loss=0.00119 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.319 | FP-Norm(final)=2.456 | 3770.7 samples/s | 58.9 steps/s
[Step=9200 Epoch=35.3] | Loss=0.00106 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.295 | FP-Norm(final)=2.458 | 3809.1 samples/s | 59.5 steps/s
[Step=9250 Epoch=35.4] | Loss=0.00094 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.271 | FP-Norm(final)=2.459 | 3816.3 samples/s | 59.6 steps/s
[Step=9300 Epoch=35.6] | Loss=0.00085 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.247 | FP-Norm(final)=2.459 | 4133.5 samples/s | 64.6 steps/s
[Step=9350 Epoch=35.8] | Loss=0.00078 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.223 | FP-Norm(final)=2.460 | 1738.3 samples/s | 27.2 steps/s
[Step=9400 Epoch=36.0] | Loss=0.00072 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.199 | FP-Norm(final)=2.461 | 3720.6 samples/s | 58.1 steps/s
[Step=9450 Epoch=36.2] | Loss=0.00066 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.177 | FP-Norm(final)=2.461 | 3732.0 samples/s | 58.3 steps/s
[Step=9500 Epoch=36.4] | Loss=0.00062 | Reg=0.00138 | acc=1.0000 | FP-Norm=1.155 | FP-Norm(final)=2.462 | 3665.6 samples/s | 57.3 steps/s
[Step=9550 Epoch=36.6] | Loss=0.00058 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.134 | FP-Norm(final)=2.462 | 3681.9 samples/s | 57.5 steps/s
[Step=9600 Epoch=36.8] | Loss=0.00055 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.115 | FP-Norm(final)=2.462 | 1809.7 samples/s | 28.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step9600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=33.9] | Loss=0.02369 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.434 | 3682.5 samples/s | 57.5 steps/s
[Step=8850 Epoch=34.1] | Loss=0.00585 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.005 | FP-Norm(final)=2.445 | 3555.2 samples/s | 55.5 steps/s
[Step=8900 Epoch=34.3] | Loss=0.00419 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.215 | FP-Norm(final)=2.447 | 3726.1 samples/s | 58.2 steps/s
[Step=8950 Epoch=34.5] | Loss=0.00313 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.293 | FP-Norm(final)=2.450 | 3693.8 samples/s | 57.7 steps/s
[Step=9000 Epoch=34.6] | Loss=0.00245 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.313 | FP-Norm(final)=2.453 | 3672.3 samples/s | 57.4 steps/s
[Step=9050 Epoch=34.8] | Loss=0.00197 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.310 | FP-Norm(final)=2.456 | 4611.8 samples/s | 72.1 steps/s
[Step=9100 Epoch=35.0] | Loss=0.00165 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.296 | FP-Norm(final)=2.458 | 1654.3 samples/s | 25.8 steps/s
[Step=9150 Epoch=35.2] | Loss=0.00142 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.277 | FP-Norm(final)=2.459 | 3783.8 samples/s | 59.1 steps/s
[Step=9200 Epoch=35.4] | Loss=0.00125 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.257 | FP-Norm(final)=2.460 | 3803.5 samples/s | 59.4 steps/s
[Step=9250 Epoch=35.6] | Loss=0.00112 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.237 | FP-Norm(final)=2.461 | 3789.9 samples/s | 59.2 steps/s
[Step=9300 Epoch=35.8] | Loss=0.00101 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.217 | FP-Norm(final)=2.462 | 4195.9 samples/s | 65.6 steps/s
[Step=9350 Epoch=36.0] | Loss=0.00092 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.197 | FP-Norm(final)=2.463 | 1725.4 samples/s | 27.0 steps/s
[Step=9400 Epoch=36.2] | Loss=0.00085 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.177 | FP-Norm(final)=2.464 | 3680.4 samples/s | 57.5 steps/s
[Step=9450 Epoch=36.4] | Loss=0.00079 | Reg=0.00138 | acc=1.0000 | FP-Norm=1.158 | FP-Norm(final)=2.464 | 3725.3 samples/s | 58.2 steps/s
[Step=9500 Epoch=36.6] | Loss=0.00073 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.139 | FP-Norm(final)=2.465 | 3713.4 samples/s | 58.0 steps/s
[Step=9550 Epoch=36.8] | Loss=0.00069 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.121 | FP-Norm(final)=2.465 | 3719.8 samples/s | 58.1 steps/s
[Step=9600 Epoch=37.0] | Loss=0.00065 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.104 | FP-Norm(final)=2.466 | 1787.9 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27328 | acc=0.8279 | tpr=0.7548 | fpr=0.0134 | 3840.0 samples/s | 15.0 steps/s
Avg test loss: 0.27840, Avg test acc: 0.82551, Avg tpr: 0.75252, Avg fpr: 0.01397, total FA: 109

Testing server on iccad2012
[Step=  50] | Loss=0.32746 | acc=0.8310 | tpr=0.9469 | fpr=0.1711 | 3847.9 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.32251 | acc=0.8330 | tpr=0.9616 | fpr=0.1694 | 7451.8 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.32830 | acc=0.8323 | tpr=0.9669 | fpr=0.1702 | 7329.2 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.33128 | acc=0.8317 | tpr=0.9694 | fpr=0.1708 | 7256.3 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.33007 | acc=0.8317 | tpr=0.9686 | fpr=0.1708 | 7101.5 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.33079 | acc=0.8315 | tpr=0.9687 | fpr=0.1710 | 7372.0 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.33200 | acc=0.8312 | tpr=0.9693 | fpr=0.1713 | 7167.8 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.33261 | acc=0.8308 | tpr=0.9677 | fpr=0.1717 | 7369.8 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.33413 | acc=0.8309 | tpr=0.9679 | fpr=0.1716 | 7169.7 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.33431 | acc=0.8307 | tpr=0.9687 | fpr=0.1718 | 7331.1 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.33403 | acc=0.8306 | tpr=0.9678 | fpr=0.1719 | 13041.9 samples/s | 50.9 steps/s
Avg test loss: 0.33387, Avg test acc: 0.83057, Avg tpr: 0.96751, Avg fpr: 0.17192, total FA: 23871

server round 12/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=18.7] | Loss=0.17612 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.466 | 3600.8 samples/s | 56.3 steps/s
[Step=9650 Epoch=18.8] | Loss=0.03878 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.867 | FP-Norm(final)=2.455 | 3852.6 samples/s | 60.2 steps/s
[Step=9700 Epoch=18.9] | Loss=0.03039 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.948 | FP-Norm(final)=2.456 | 3997.2 samples/s | 62.5 steps/s
[Step=9750 Epoch=19.0] | Loss=0.02854 | Reg=0.00096 | acc=0.9844 | FP-Norm=0.968 | FP-Norm(final)=2.459 | 3992.2 samples/s | 62.4 steps/s
[Step=9800 Epoch=19.1] | Loss=0.02577 | Reg=0.00099 | acc=0.9844 | FP-Norm=0.985 | FP-Norm(final)=2.461 | 4012.9 samples/s | 62.7 steps/s
[Step=9850 Epoch=19.2] | Loss=0.02525 | Reg=0.00103 | acc=1.0000 | FP-Norm=1.005 | FP-Norm(final)=2.462 | 3926.8 samples/s | 61.4 steps/s
[Step=9900 Epoch=19.3] | Loss=0.02411 | Reg=0.00105 | acc=0.9844 | FP-Norm=1.019 | FP-Norm(final)=2.465 | 3883.1 samples/s | 60.7 steps/s
[Step=9950 Epoch=19.4] | Loss=0.02407 | Reg=0.00109 | acc=0.9531 | FP-Norm=1.035 | FP-Norm(final)=2.466 | 3901.7 samples/s | 61.0 steps/s
[Step=10000 Epoch=19.5] | Loss=0.02373 | Reg=0.00112 | acc=0.9844 | FP-Norm=1.053 | FP-Norm(final)=2.467 | 3915.6 samples/s | 61.2 steps/s
[Step=10050 Epoch=19.6] | Loss=0.02380 | Reg=0.00117 | acc=0.9844 | FP-Norm=1.073 | FP-Norm(final)=2.467 | 3892.8 samples/s | 60.8 steps/s
[Step=10100 Epoch=19.7] | Loss=0.02347 | Reg=0.00121 | acc=0.9688 | FP-Norm=1.093 | FP-Norm(final)=2.468 | 4615.4 samples/s | 72.1 steps/s
[Step=10150 Epoch=19.8] | Loss=0.02281 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.109 | FP-Norm(final)=2.468 | 1647.0 samples/s | 25.7 steps/s
[Step=10200 Epoch=19.9] | Loss=0.02235 | Reg=0.00128 | acc=0.9688 | FP-Norm=1.124 | FP-Norm(final)=2.470 | 3982.4 samples/s | 62.2 steps/s
[Step=10250 Epoch=20.0] | Loss=0.02175 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.136 | FP-Norm(final)=2.470 | 3965.4 samples/s | 62.0 steps/s
[Step=10300 Epoch=20.1] | Loss=0.02159 | Reg=0.00134 | acc=0.9844 | FP-Norm=1.148 | FP-Norm(final)=2.471 | 3917.2 samples/s | 61.2 steps/s
[Step=10350 Epoch=20.2] | Loss=0.02119 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.160 | FP-Norm(final)=2.473 | 3881.4 samples/s | 60.6 steps/s
[Step=10400 Epoch=20.3] | Loss=0.02113 | Reg=0.00140 | acc=1.0000 | FP-Norm=1.172 | FP-Norm(final)=2.473 | 3928.2 samples/s | 61.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step10400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=18.8] | Loss=0.16719 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.465 | 3693.7 samples/s | 57.7 steps/s
[Step=9650 Epoch=18.9] | Loss=0.03571 | Reg=0.00075 | acc=0.9844 | FP-Norm=0.830 | FP-Norm(final)=2.456 | 3852.5 samples/s | 60.2 steps/s
[Step=9700 Epoch=19.0] | Loss=0.03069 | Reg=0.00085 | acc=0.9844 | FP-Norm=0.902 | FP-Norm(final)=2.455 | 4023.5 samples/s | 62.9 steps/s
[Step=9750 Epoch=19.1] | Loss=0.02837 | Reg=0.00091 | acc=0.9844 | FP-Norm=0.937 | FP-Norm(final)=2.455 | 4011.6 samples/s | 62.7 steps/s
[Step=9800 Epoch=19.2] | Loss=0.02654 | Reg=0.00094 | acc=0.9844 | FP-Norm=0.959 | FP-Norm(final)=2.455 | 3986.8 samples/s | 62.3 steps/s
[Step=9850 Epoch=19.3] | Loss=0.02497 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.985 | FP-Norm(final)=2.457 | 3927.1 samples/s | 61.4 steps/s
[Step=9900 Epoch=19.4] | Loss=0.02454 | Reg=0.00104 | acc=0.9844 | FP-Norm=1.011 | FP-Norm(final)=2.458 | 3901.7 samples/s | 61.0 steps/s
[Step=9950 Epoch=19.5] | Loss=0.02360 | Reg=0.00108 | acc=0.9531 | FP-Norm=1.031 | FP-Norm(final)=2.460 | 3890.8 samples/s | 60.8 steps/s
[Step=10000 Epoch=19.5] | Loss=0.02344 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.048 | FP-Norm(final)=2.461 | 3900.4 samples/s | 60.9 steps/s
[Step=10050 Epoch=19.6] | Loss=0.02291 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.064 | FP-Norm(final)=2.462 | 3911.7 samples/s | 61.1 steps/s
[Step=10100 Epoch=19.7] | Loss=0.02304 | Reg=0.00119 | acc=0.9219 | FP-Norm=1.080 | FP-Norm(final)=2.463 | 4702.8 samples/s | 73.5 steps/s
[Step=10150 Epoch=19.8] | Loss=0.02251 | Reg=0.00121 | acc=0.9531 | FP-Norm=1.093 | FP-Norm(final)=2.464 | 1703.8 samples/s | 26.6 steps/s
[Step=10200 Epoch=19.9] | Loss=0.02196 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.103 | FP-Norm(final)=2.465 | 3868.1 samples/s | 60.4 steps/s
[Step=10250 Epoch=20.0] | Loss=0.02149 | Reg=0.00126 | acc=0.9844 | FP-Norm=1.113 | FP-Norm(final)=2.467 | 3889.5 samples/s | 60.8 steps/s
[Step=10300 Epoch=20.1] | Loss=0.02104 | Reg=0.00128 | acc=0.9688 | FP-Norm=1.122 | FP-Norm(final)=2.468 | 3865.5 samples/s | 60.4 steps/s
[Step=10350 Epoch=20.2] | Loss=0.02080 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.133 | FP-Norm(final)=2.470 | 3890.5 samples/s | 60.8 steps/s
[Step=10400 Epoch=20.3] | Loss=0.02059 | Reg=0.00133 | acc=0.9844 | FP-Norm=1.143 | FP-Norm(final)=2.471 | 3922.3 samples/s | 61.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step10400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=36.8] | Loss=0.09622 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.466 | 3650.6 samples/s | 57.0 steps/s
[Step=9650 Epoch=37.0] | Loss=0.00672 | Reg=0.00178 | acc=0.9844 | FP-Norm=1.276 | FP-Norm(final)=2.472 | 3640.7 samples/s | 56.9 steps/s
[Step=9700 Epoch=37.2] | Loss=0.00508 | Reg=0.00235 | acc=1.0000 | FP-Norm=1.493 | FP-Norm(final)=2.470 | 3696.3 samples/s | 57.8 steps/s
[Step=9750 Epoch=37.4] | Loss=0.00377 | Reg=0.00253 | acc=1.0000 | FP-Norm=1.561 | FP-Norm(final)=2.472 | 3700.9 samples/s | 57.8 steps/s
[Step=9800 Epoch=37.6] | Loss=0.00288 | Reg=0.00255 | acc=1.0000 | FP-Norm=1.574 | FP-Norm(final)=2.473 | 3682.8 samples/s | 57.5 steps/s
[Step=9850 Epoch=37.7] | Loss=0.00234 | Reg=0.00250 | acc=1.0000 | FP-Norm=1.562 | FP-Norm(final)=2.475 | 4531.8 samples/s | 70.8 steps/s
[Step=9900 Epoch=37.9] | Loss=0.00196 | Reg=0.00242 | acc=1.0000 | FP-Norm=1.540 | FP-Norm(final)=2.476 | 1656.8 samples/s | 25.9 steps/s
[Step=9950 Epoch=38.1] | Loss=0.00169 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.515 | FP-Norm(final)=2.478 | 3727.5 samples/s | 58.2 steps/s
[Step=10000 Epoch=38.3] | Loss=0.00148 | Reg=0.00226 | acc=1.0000 | FP-Norm=1.488 | FP-Norm(final)=2.479 | 3674.9 samples/s | 57.4 steps/s
[Step=10050 Epoch=38.5] | Loss=0.00133 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.462 | FP-Norm(final)=2.480 | 3711.3 samples/s | 58.0 steps/s
[Step=10100 Epoch=38.7] | Loss=0.00119 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.436 | FP-Norm(final)=2.481 | 4022.0 samples/s | 62.8 steps/s
[Step=10150 Epoch=38.9] | Loss=0.00109 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.410 | FP-Norm(final)=2.482 | 1735.9 samples/s | 27.1 steps/s
[Step=10200 Epoch=39.1] | Loss=0.00100 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.386 | FP-Norm(final)=2.483 | 3697.5 samples/s | 57.8 steps/s
[Step=10250 Epoch=39.3] | Loss=0.00093 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.362 | FP-Norm(final)=2.483 | 3711.5 samples/s | 58.0 steps/s
[Step=10300 Epoch=39.5] | Loss=0.00086 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.339 | FP-Norm(final)=2.484 | 3676.8 samples/s | 57.4 steps/s
[Step=10350 Epoch=39.7] | Loss=0.00081 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.316 | FP-Norm(final)=2.485 | 3719.5 samples/s | 58.1 steps/s
[Step=10400 Epoch=39.8] | Loss=0.00076 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.295 | FP-Norm(final)=2.485 | 1800.5 samples/s | 28.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step10400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=37.0] | Loss=0.08778 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.466 | 3668.3 samples/s | 57.3 steps/s
[Step=9650 Epoch=37.1] | Loss=0.00687 | Reg=0.00227 | acc=0.9844 | FP-Norm=1.439 | FP-Norm(final)=2.472 | 3625.0 samples/s | 56.6 steps/s
[Step=9700 Epoch=37.3] | Loss=0.00590 | Reg=0.00257 | acc=1.0000 | FP-Norm=1.565 | FP-Norm(final)=2.473 | 3696.9 samples/s | 57.8 steps/s
[Step=9750 Epoch=37.5] | Loss=0.00406 | Reg=0.00261 | acc=1.0000 | FP-Norm=1.590 | FP-Norm(final)=2.474 | 3724.8 samples/s | 58.2 steps/s
[Step=9800 Epoch=37.7] | Loss=0.00319 | Reg=0.00256 | acc=1.0000 | FP-Norm=1.580 | FP-Norm(final)=2.477 | 3703.2 samples/s | 57.9 steps/s
[Step=9850 Epoch=37.9] | Loss=0.00260 | Reg=0.00249 | acc=1.0000 | FP-Norm=1.563 | FP-Norm(final)=2.480 | 4547.4 samples/s | 71.1 steps/s
[Step=9900 Epoch=38.1] | Loss=0.00228 | Reg=0.00243 | acc=1.0000 | FP-Norm=1.544 | FP-Norm(final)=2.482 | 1650.3 samples/s | 25.8 steps/s
[Step=9950 Epoch=38.3] | Loss=0.00198 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.526 | FP-Norm(final)=2.484 | 3860.5 samples/s | 60.3 steps/s
[Step=10000 Epoch=38.5] | Loss=0.00174 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.507 | FP-Norm(final)=2.486 | 3792.8 samples/s | 59.3 steps/s
[Step=10050 Epoch=38.7] | Loss=0.00155 | Reg=0.00224 | acc=1.0000 | FP-Norm=1.484 | FP-Norm(final)=2.488 | 3761.1 samples/s | 58.8 steps/s
[Step=10100 Epoch=38.9] | Loss=0.00140 | Reg=0.00217 | acc=1.0000 | FP-Norm=1.460 | FP-Norm(final)=2.489 | 4254.3 samples/s | 66.5 steps/s
[Step=10150 Epoch=39.1] | Loss=0.00127 | Reg=0.00210 | acc=1.0000 | FP-Norm=1.436 | FP-Norm(final)=2.490 | 1749.1 samples/s | 27.3 steps/s
[Step=10200 Epoch=39.3] | Loss=0.00117 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.413 | FP-Norm(final)=2.491 | 3747.6 samples/s | 58.6 steps/s
[Step=10250 Epoch=39.5] | Loss=0.00108 | Reg=0.00198 | acc=1.0000 | FP-Norm=1.389 | FP-Norm(final)=2.491 | 3800.6 samples/s | 59.4 steps/s
[Step=10300 Epoch=39.6] | Loss=0.00100 | Reg=0.00192 | acc=1.0000 | FP-Norm=1.366 | FP-Norm(final)=2.492 | 3689.3 samples/s | 57.6 steps/s
[Step=10350 Epoch=39.8] | Loss=0.00094 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.344 | FP-Norm(final)=2.492 | 3747.2 samples/s | 58.6 steps/s
[Step=10400 Epoch=40.0] | Loss=0.00088 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.323 | FP-Norm(final)=2.492 | 1791.5 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29048 | acc=0.8120 | tpr=0.7306 | fpr=0.0114 | 3850.6 samples/s | 15.0 steps/s
Avg test loss: 0.29535, Avg test acc: 0.81024, Avg tpr: 0.73002, Avg fpr: 0.01333, total FA: 104

Testing server on iccad2012
[Step=  50] | Loss=0.29738 | acc=0.8542 | tpr=0.9513 | fpr=0.1475 | 3857.7 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.29588 | acc=0.8541 | tpr=0.9638 | fpr=0.1479 | 7306.3 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.30203 | acc=0.8522 | tpr=0.9683 | fpr=0.1499 | 7187.9 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.30561 | acc=0.8512 | tpr=0.9705 | fpr=0.1509 | 7200.8 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.30487 | acc=0.8512 | tpr=0.9721 | fpr=0.1510 | 7180.6 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.30612 | acc=0.8510 | tpr=0.9709 | fpr=0.1512 | 7391.5 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.30769 | acc=0.8508 | tpr=0.9712 | fpr=0.1514 | 7305.7 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.30827 | acc=0.8504 | tpr=0.9688 | fpr=0.1518 | 7308.8 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.30985 | acc=0.8503 | tpr=0.9684 | fpr=0.1519 | 7217.5 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.31003 | acc=0.8500 | tpr=0.9696 | fpr=0.1522 | 7245.2 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.30976 | acc=0.8500 | tpr=0.9686 | fpr=0.1521 | 13493.9 samples/s | 52.7 steps/s
Avg test loss: 0.30959, Avg test acc: 0.85003, Avg tpr: 0.96830, Avg fpr: 0.15212, total FA: 21122

server round 13/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=20.3] | Loss=0.08697 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.492 | 3654.8 samples/s | 57.1 steps/s
[Step=10450 Epoch=20.4] | Loss=0.03843 | Reg=0.00100 | acc=0.9844 | FP-Norm=0.958 | FP-Norm(final)=2.477 | 3663.2 samples/s | 57.2 steps/s
[Step=10500 Epoch=20.5] | Loss=0.03175 | Reg=0.00107 | acc=0.9375 | FP-Norm=1.014 | FP-Norm(final)=2.476 | 3891.7 samples/s | 60.8 steps/s
[Step=10550 Epoch=20.6] | Loss=0.02864 | Reg=0.00110 | acc=0.9844 | FP-Norm=1.034 | FP-Norm(final)=2.476 | 3886.0 samples/s | 60.7 steps/s
[Step=10600 Epoch=20.7] | Loss=0.02646 | Reg=0.00115 | acc=0.9688 | FP-Norm=1.060 | FP-Norm(final)=2.476 | 3926.8 samples/s | 61.4 steps/s
[Step=10650 Epoch=20.8] | Loss=0.02553 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.076 | FP-Norm(final)=2.478 | 3872.7 samples/s | 60.5 steps/s
[Step=10700 Epoch=20.9] | Loss=0.02543 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.093 | FP-Norm(final)=2.478 | 3900.9 samples/s | 61.0 steps/s
[Step=10750 Epoch=21.0] | Loss=0.02512 | Reg=0.00124 | acc=0.9688 | FP-Norm=1.107 | FP-Norm(final)=2.477 | 3894.5 samples/s | 60.9 steps/s
[Step=10800 Epoch=21.1] | Loss=0.02445 | Reg=0.00127 | acc=0.9844 | FP-Norm=1.119 | FP-Norm(final)=2.477 | 3891.3 samples/s | 60.8 steps/s
[Step=10850 Epoch=21.2] | Loss=0.02366 | Reg=0.00129 | acc=0.9844 | FP-Norm=1.128 | FP-Norm(final)=2.477 | 3874.6 samples/s | 60.5 steps/s
[Step=10900 Epoch=21.3] | Loss=0.02349 | Reg=0.00131 | acc=0.9844 | FP-Norm=1.139 | FP-Norm(final)=2.478 | 4619.8 samples/s | 72.2 steps/s
[Step=10950 Epoch=21.4] | Loss=0.02306 | Reg=0.00134 | acc=0.9688 | FP-Norm=1.150 | FP-Norm(final)=2.479 | 1678.2 samples/s | 26.2 steps/s
[Step=11000 Epoch=21.5] | Loss=0.02264 | Reg=0.00136 | acc=0.9688 | FP-Norm=1.159 | FP-Norm(final)=2.480 | 3989.9 samples/s | 62.3 steps/s
[Step=11050 Epoch=21.6] | Loss=0.02229 | Reg=0.00138 | acc=0.9844 | FP-Norm=1.169 | FP-Norm(final)=2.481 | 4025.9 samples/s | 62.9 steps/s
[Step=11100 Epoch=21.6] | Loss=0.02170 | Reg=0.00140 | acc=0.9688 | FP-Norm=1.177 | FP-Norm(final)=2.482 | 4011.9 samples/s | 62.7 steps/s
[Step=11150 Epoch=21.7] | Loss=0.02118 | Reg=0.00142 | acc=0.9844 | FP-Norm=1.185 | FP-Norm(final)=2.483 | 3973.6 samples/s | 62.1 steps/s
[Step=11200 Epoch=21.8] | Loss=0.02106 | Reg=0.00144 | acc=0.9844 | FP-Norm=1.192 | FP-Norm(final)=2.484 | 4019.3 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step11200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=20.3] | Loss=0.23007 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.491 | 3724.7 samples/s | 58.2 steps/s
[Step=10450 Epoch=20.4] | Loss=0.03710 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.872 | FP-Norm(final)=2.478 | 3827.1 samples/s | 59.8 steps/s
[Step=10500 Epoch=20.5] | Loss=0.02975 | Reg=0.00093 | acc=0.9531 | FP-Norm=0.942 | FP-Norm(final)=2.479 | 4008.1 samples/s | 62.6 steps/s
[Step=10550 Epoch=20.6] | Loss=0.02750 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.982 | FP-Norm(final)=2.482 | 3976.2 samples/s | 62.1 steps/s
[Step=10600 Epoch=20.7] | Loss=0.02648 | Reg=0.00105 | acc=0.9844 | FP-Norm=1.013 | FP-Norm(final)=2.483 | 3944.9 samples/s | 61.6 steps/s
[Step=10650 Epoch=20.8] | Loss=0.02521 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.040 | FP-Norm(final)=2.485 | 3892.3 samples/s | 60.8 steps/s
[Step=10700 Epoch=20.9] | Loss=0.02421 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.062 | FP-Norm(final)=2.486 | 3911.6 samples/s | 61.1 steps/s
[Step=10750 Epoch=21.0] | Loss=0.02409 | Reg=0.00119 | acc=0.9688 | FP-Norm=1.082 | FP-Norm(final)=2.487 | 3896.1 samples/s | 60.9 steps/s
[Step=10800 Epoch=21.1] | Loss=0.02337 | Reg=0.00123 | acc=0.9688 | FP-Norm=1.099 | FP-Norm(final)=2.489 | 3914.6 samples/s | 61.2 steps/s
[Step=10850 Epoch=21.2] | Loss=0.02355 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.118 | FP-Norm(final)=2.489 | 3900.9 samples/s | 61.0 steps/s
[Step=10900 Epoch=21.3] | Loss=0.02345 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.135 | FP-Norm(final)=2.489 | 4663.0 samples/s | 72.9 steps/s
[Step=10950 Epoch=21.4] | Loss=0.02277 | Reg=0.00134 | acc=0.9688 | FP-Norm=1.150 | FP-Norm(final)=2.490 | 1723.9 samples/s | 26.9 steps/s
[Step=11000 Epoch=21.5] | Loss=0.02193 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.162 | FP-Norm(final)=2.491 | 3890.2 samples/s | 60.8 steps/s
[Step=11050 Epoch=21.6] | Loss=0.02170 | Reg=0.00140 | acc=0.9844 | FP-Norm=1.174 | FP-Norm(final)=2.492 | 3994.6 samples/s | 62.4 steps/s
[Step=11100 Epoch=21.7] | Loss=0.02149 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.187 | FP-Norm(final)=2.492 | 3965.4 samples/s | 62.0 steps/s
[Step=11150 Epoch=21.8] | Loss=0.02137 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.199 | FP-Norm(final)=2.493 | 4008.0 samples/s | 62.6 steps/s
[Step=11200 Epoch=21.9] | Loss=0.02105 | Reg=0.00149 | acc=1.0000 | FP-Norm=1.210 | FP-Norm(final)=2.494 | 4021.6 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step11200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=39.9] | Loss=0.09095 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.492 | 4039.8 samples/s | 63.1 steps/s
[Step=10450 Epoch=40.0] | Loss=0.01070 | Reg=0.00222 | acc=0.9688 | FP-Norm=1.418 | FP-Norm(final)=2.490 | 3313.3 samples/s | 51.8 steps/s
[Step=10500 Epoch=40.2] | Loss=0.00717 | Reg=0.00284 | acc=1.0000 | FP-Norm=1.641 | FP-Norm(final)=2.483 | 3841.1 samples/s | 60.0 steps/s
[Step=10550 Epoch=40.4] | Loss=0.00513 | Reg=0.00300 | acc=1.0000 | FP-Norm=1.700 | FP-Norm(final)=2.480 | 3749.7 samples/s | 58.6 steps/s
[Step=10600 Epoch=40.6] | Loss=0.00402 | Reg=0.00296 | acc=1.0000 | FP-Norm=1.698 | FP-Norm(final)=2.481 | 3821.3 samples/s | 59.7 steps/s
[Step=10650 Epoch=40.8] | Loss=0.00350 | Reg=0.00289 | acc=1.0000 | FP-Norm=1.680 | FP-Norm(final)=2.484 | 4527.1 samples/s | 70.7 steps/s
[Step=10700 Epoch=41.0] | Loss=0.00336 | Reg=0.00289 | acc=1.0000 | FP-Norm=1.684 | FP-Norm(final)=2.485 | 1647.0 samples/s | 25.7 steps/s
[Step=10750 Epoch=41.2] | Loss=0.00290 | Reg=0.00287 | acc=1.0000 | FP-Norm=1.681 | FP-Norm(final)=2.486 | 3677.9 samples/s | 57.5 steps/s
[Step=10800 Epoch=41.4] | Loss=0.00255 | Reg=0.00283 | acc=1.0000 | FP-Norm=1.669 | FP-Norm(final)=2.487 | 3700.6 samples/s | 57.8 steps/s
[Step=10850 Epoch=41.6] | Loss=0.00228 | Reg=0.00277 | acc=1.0000 | FP-Norm=1.652 | FP-Norm(final)=2.488 | 3694.1 samples/s | 57.7 steps/s
[Step=10900 Epoch=41.8] | Loss=0.00205 | Reg=0.00270 | acc=1.0000 | FP-Norm=1.632 | FP-Norm(final)=2.490 | 4054.9 samples/s | 63.4 steps/s
[Step=10950 Epoch=42.0] | Loss=0.00187 | Reg=0.00264 | acc=1.0000 | FP-Norm=1.611 | FP-Norm(final)=2.491 | 1737.6 samples/s | 27.2 steps/s
[Step=11000 Epoch=42.1] | Loss=0.00172 | Reg=0.00257 | acc=1.0000 | FP-Norm=1.590 | FP-Norm(final)=2.492 | 3799.6 samples/s | 59.4 steps/s
[Step=11050 Epoch=42.3] | Loss=0.00159 | Reg=0.00250 | acc=1.0000 | FP-Norm=1.568 | FP-Norm(final)=2.493 | 3797.7 samples/s | 59.3 steps/s
[Step=11100 Epoch=42.5] | Loss=0.00148 | Reg=0.00244 | acc=1.0000 | FP-Norm=1.546 | FP-Norm(final)=2.494 | 3787.9 samples/s | 59.2 steps/s
[Step=11150 Epoch=42.7] | Loss=0.00138 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.524 | FP-Norm(final)=2.495 | 3795.0 samples/s | 59.3 steps/s
[Step=11200 Epoch=42.9] | Loss=0.00130 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.503 | FP-Norm(final)=2.496 | 1812.6 samples/s | 28.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step11200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=40.0] | Loss=0.06990 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.492 | 3554.6 samples/s | 55.5 steps/s
[Step=10450 Epoch=40.2] | Loss=0.01191 | Reg=0.00274 | acc=1.0000 | FP-Norm=1.584 | FP-Norm(final)=2.483 | 3630.8 samples/s | 56.7 steps/s
[Step=10500 Epoch=40.4] | Loss=0.00667 | Reg=0.00299 | acc=1.0000 | FP-Norm=1.692 | FP-Norm(final)=2.481 | 3809.3 samples/s | 59.5 steps/s
[Step=10550 Epoch=40.6] | Loss=0.00477 | Reg=0.00295 | acc=1.0000 | FP-Norm=1.693 | FP-Norm(final)=2.484 | 3706.3 samples/s | 57.9 steps/s
[Step=10600 Epoch=40.8] | Loss=0.00361 | Reg=0.00285 | acc=1.0000 | FP-Norm=1.667 | FP-Norm(final)=2.486 | 3770.6 samples/s | 58.9 steps/s
[Step=10650 Epoch=41.0] | Loss=0.00294 | Reg=0.00273 | acc=1.0000 | FP-Norm=1.634 | FP-Norm(final)=2.489 | 4577.5 samples/s | 71.5 steps/s
[Step=10700 Epoch=41.2] | Loss=0.00246 | Reg=0.00262 | acc=1.0000 | FP-Norm=1.601 | FP-Norm(final)=2.491 | 1662.7 samples/s | 26.0 steps/s
[Step=10750 Epoch=41.4] | Loss=0.00211 | Reg=0.00251 | acc=1.0000 | FP-Norm=1.567 | FP-Norm(final)=2.493 | 3738.1 samples/s | 58.4 steps/s
[Step=10800 Epoch=41.6] | Loss=0.00185 | Reg=0.00241 | acc=1.0000 | FP-Norm=1.535 | FP-Norm(final)=2.495 | 3682.9 samples/s | 57.5 steps/s
[Step=10850 Epoch=41.8] | Loss=0.00165 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.503 | FP-Norm(final)=2.496 | 3735.4 samples/s | 58.4 steps/s
[Step=10900 Epoch=42.0] | Loss=0.00149 | Reg=0.00223 | acc=1.0000 | FP-Norm=1.473 | FP-Norm(final)=2.497 | 4118.9 samples/s | 64.4 steps/s
[Step=10950 Epoch=42.2] | Loss=0.00136 | Reg=0.00215 | acc=1.0000 | FP-Norm=1.444 | FP-Norm(final)=2.498 | 1726.0 samples/s | 27.0 steps/s
[Step=11000 Epoch=42.3] | Loss=0.00124 | Reg=0.00207 | acc=1.0000 | FP-Norm=1.416 | FP-Norm(final)=2.499 | 3693.4 samples/s | 57.7 steps/s
[Step=11050 Epoch=42.5] | Loss=0.00115 | Reg=0.00200 | acc=1.0000 | FP-Norm=1.390 | FP-Norm(final)=2.499 | 3692.3 samples/s | 57.7 steps/s
[Step=11100 Epoch=42.7] | Loss=0.00107 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.365 | FP-Norm(final)=2.500 | 3732.5 samples/s | 58.3 steps/s
[Step=11150 Epoch=42.9] | Loss=0.00100 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.340 | FP-Norm(final)=2.501 | 3725.7 samples/s | 58.2 steps/s
[Step=11200 Epoch=43.1] | Loss=0.00094 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.317 | FP-Norm(final)=2.501 | 1786.4 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33358 | acc=0.7895 | tpr=0.6973 | fpr=0.0102 | 3826.4 samples/s | 14.9 steps/s
Avg test loss: 0.33990, Avg test acc: 0.78792, Avg tpr: 0.69680, Avg fpr: 0.01167, total FA: 91

Testing server on iccad2012
[Step=  50] | Loss=0.25646 | acc=0.8723 | tpr=0.9425 | fpr=0.1289 | 3848.9 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.25540 | acc=0.8761 | tpr=0.9595 | fpr=0.1255 | 7329.7 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.26136 | acc=0.8743 | tpr=0.9669 | fpr=0.1274 | 7738.9 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.26478 | acc=0.8734 | tpr=0.9705 | fpr=0.1283 | 7290.9 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.26335 | acc=0.8738 | tpr=0.9712 | fpr=0.1280 | 7104.5 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.26474 | acc=0.8734 | tpr=0.9687 | fpr=0.1284 | 7335.0 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.26638 | acc=0.8732 | tpr=0.9687 | fpr=0.1286 | 7413.6 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.26714 | acc=0.8730 | tpr=0.9666 | fpr=0.1287 | 7316.3 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.26855 | acc=0.8730 | tpr=0.9669 | fpr=0.1287 | 7127.7 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.26871 | acc=0.8724 | tpr=0.9678 | fpr=0.1293 | 7328.6 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.26837 | acc=0.8726 | tpr=0.9670 | fpr=0.1291 | 13358.5 samples/s | 52.2 steps/s
Avg test loss: 0.26826, Avg test acc: 0.87256, Avg tpr: 0.96672, Avg fpr: 0.12915, total FA: 17932

server round 14/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=21.8] | Loss=0.08537 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.504 | 3415.6 samples/s | 53.4 steps/s
[Step=11250 Epoch=21.9] | Loss=0.04034 | Reg=0.00102 | acc=0.9531 | FP-Norm=0.960 | FP-Norm(final)=2.491 | 3982.8 samples/s | 62.2 steps/s
[Step=11300 Epoch=22.0] | Loss=0.02967 | Reg=0.00111 | acc=0.9844 | FP-Norm=1.027 | FP-Norm(final)=2.490 | 3959.2 samples/s | 61.9 steps/s
[Step=11350 Epoch=22.1] | Loss=0.02744 | Reg=0.00112 | acc=0.9844 | FP-Norm=1.044 | FP-Norm(final)=2.493 | 4018.5 samples/s | 62.8 steps/s
[Step=11400 Epoch=22.2] | Loss=0.02696 | Reg=0.00115 | acc=0.9844 | FP-Norm=1.060 | FP-Norm(final)=2.494 | 3975.4 samples/s | 62.1 steps/s
[Step=11450 Epoch=22.3] | Loss=0.02456 | Reg=0.00119 | acc=0.9844 | FP-Norm=1.081 | FP-Norm(final)=2.495 | 4003.8 samples/s | 62.6 steps/s
[Step=11500 Epoch=22.4] | Loss=0.02500 | Reg=0.00123 | acc=0.9688 | FP-Norm=1.098 | FP-Norm(final)=2.496 | 3996.9 samples/s | 62.5 steps/s
[Step=11550 Epoch=22.5] | Loss=0.02448 | Reg=0.00126 | acc=0.9844 | FP-Norm=1.113 | FP-Norm(final)=2.496 | 4013.6 samples/s | 62.7 steps/s
[Step=11600 Epoch=22.6] | Loss=0.02347 | Reg=0.00128 | acc=0.9688 | FP-Norm=1.125 | FP-Norm(final)=2.497 | 4010.0 samples/s | 62.7 steps/s
[Step=11650 Epoch=22.7] | Loss=0.02332 | Reg=0.00131 | acc=0.9844 | FP-Norm=1.137 | FP-Norm(final)=2.497 | 3992.2 samples/s | 62.4 steps/s
[Step=11700 Epoch=22.8] | Loss=0.02302 | Reg=0.00133 | acc=0.9844 | FP-Norm=1.148 | FP-Norm(final)=2.498 | 4743.1 samples/s | 74.1 steps/s
[Step=11750 Epoch=22.9] | Loss=0.02230 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.157 | FP-Norm(final)=2.498 | 1674.8 samples/s | 26.2 steps/s
[Step=11800 Epoch=23.0] | Loss=0.02175 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.165 | FP-Norm(final)=2.499 | 4009.7 samples/s | 62.7 steps/s
[Step=11850 Epoch=23.1] | Loss=0.02116 | Reg=0.00139 | acc=1.0000 | FP-Norm=1.172 | FP-Norm(final)=2.500 | 3912.5 samples/s | 61.1 steps/s
[Step=11900 Epoch=23.2] | Loss=0.02075 | Reg=0.00140 | acc=0.9688 | FP-Norm=1.178 | FP-Norm(final)=2.502 | 3897.4 samples/s | 60.9 steps/s
[Step=11950 Epoch=23.3] | Loss=0.02059 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.186 | FP-Norm(final)=2.503 | 3891.7 samples/s | 60.8 steps/s
[Step=12000 Epoch=23.4] | Loss=0.02039 | Reg=0.00144 | acc=0.9844 | FP-Norm=1.195 | FP-Norm(final)=2.504 | 3903.1 samples/s | 61.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=21.9] | Loss=0.15671 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.504 | 3722.4 samples/s | 58.2 steps/s
[Step=11250 Epoch=22.0] | Loss=0.03647 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.054 | FP-Norm(final)=2.494 | 3716.3 samples/s | 58.1 steps/s
[Step=11300 Epoch=22.1] | Loss=0.02955 | Reg=0.00131 | acc=0.9688 | FP-Norm=1.119 | FP-Norm(final)=2.496 | 3909.3 samples/s | 61.1 steps/s
[Step=11350 Epoch=22.2] | Loss=0.02562 | Reg=0.00131 | acc=0.9531 | FP-Norm=1.127 | FP-Norm(final)=2.498 | 3893.9 samples/s | 60.8 steps/s
[Step=11400 Epoch=22.3] | Loss=0.02565 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.141 | FP-Norm(final)=2.499 | 4010.5 samples/s | 62.7 steps/s
[Step=11450 Epoch=22.4] | Loss=0.02475 | Reg=0.00135 | acc=1.0000 | FP-Norm=1.153 | FP-Norm(final)=2.500 | 4026.6 samples/s | 62.9 steps/s
[Step=11500 Epoch=22.5] | Loss=0.02397 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.162 | FP-Norm(final)=2.500 | 4005.2 samples/s | 62.6 steps/s
[Step=11550 Epoch=22.6] | Loss=0.02397 | Reg=0.00139 | acc=0.9844 | FP-Norm=1.173 | FP-Norm(final)=2.499 | 4010.7 samples/s | 62.7 steps/s
[Step=11600 Epoch=22.7] | Loss=0.02342 | Reg=0.00141 | acc=0.9531 | FP-Norm=1.180 | FP-Norm(final)=2.500 | 4023.2 samples/s | 62.9 steps/s
[Step=11650 Epoch=22.8] | Loss=0.02367 | Reg=0.00143 | acc=0.9844 | FP-Norm=1.188 | FP-Norm(final)=2.499 | 4034.0 samples/s | 63.0 steps/s
[Step=11700 Epoch=22.9] | Loss=0.02344 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.199 | FP-Norm(final)=2.499 | 4786.4 samples/s | 74.8 steps/s
[Step=11750 Epoch=23.0] | Loss=0.02247 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.207 | FP-Norm(final)=2.499 | 1704.0 samples/s | 26.6 steps/s
[Step=11800 Epoch=23.1] | Loss=0.02167 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.212 | FP-Norm(final)=2.500 | 3881.9 samples/s | 60.7 steps/s
[Step=11850 Epoch=23.2] | Loss=0.02132 | Reg=0.00150 | acc=0.9844 | FP-Norm=1.218 | FP-Norm(final)=2.500 | 3899.3 samples/s | 60.9 steps/s
[Step=11900 Epoch=23.3] | Loss=0.02130 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.225 | FP-Norm(final)=2.501 | 3854.8 samples/s | 60.2 steps/s
[Step=11950 Epoch=23.4] | Loss=0.02093 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.231 | FP-Norm(final)=2.502 | 3889.8 samples/s | 60.8 steps/s
[Step=12000 Epoch=23.5] | Loss=0.02058 | Reg=0.00154 | acc=0.9844 | FP-Norm=1.238 | FP-Norm(final)=2.503 | 3899.9 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step12000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=42.9] | Loss=0.06226 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.504 | 4052.5 samples/s | 63.3 steps/s
[Step=11250 Epoch=43.1] | Loss=0.00510 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.152 | FP-Norm(final)=2.510 | 3203.2 samples/s | 50.0 steps/s
[Step=11300 Epoch=43.3] | Loss=0.00285 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.253 | FP-Norm(final)=2.513 | 3693.6 samples/s | 57.7 steps/s
[Step=11350 Epoch=43.5] | Loss=0.00194 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.246 | FP-Norm(final)=2.516 | 3703.0 samples/s | 57.9 steps/s
[Step=11400 Epoch=43.7] | Loss=0.00148 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.217 | FP-Norm(final)=2.518 | 3724.4 samples/s | 58.2 steps/s
[Step=11450 Epoch=43.9] | Loss=0.00133 | Reg=0.00144 | acc=0.9688 | FP-Norm=1.185 | FP-Norm(final)=2.520 | 4490.1 samples/s | 70.2 steps/s
[Step=11500 Epoch=44.1] | Loss=0.00166 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.199 | FP-Norm(final)=2.521 | 1678.1 samples/s | 26.2 steps/s
[Step=11550 Epoch=44.3] | Loss=0.00145 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.226 | FP-Norm(final)=2.521 | 3705.5 samples/s | 57.9 steps/s
[Step=11600 Epoch=44.4] | Loss=0.00135 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.236 | FP-Norm(final)=2.522 | 3698.9 samples/s | 57.8 steps/s
[Step=11650 Epoch=44.6] | Loss=0.00124 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.241 | FP-Norm(final)=2.523 | 3718.5 samples/s | 58.1 steps/s
[Step=11700 Epoch=44.8] | Loss=0.00112 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.241 | FP-Norm(final)=2.523 | 4003.6 samples/s | 62.6 steps/s
[Step=11750 Epoch=45.0] | Loss=0.00102 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.235 | FP-Norm(final)=2.524 | 1709.1 samples/s | 26.7 steps/s
[Step=11800 Epoch=45.2] | Loss=0.00094 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.226 | FP-Norm(final)=2.525 | 3694.0 samples/s | 57.7 steps/s
[Step=11850 Epoch=45.4] | Loss=0.00087 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.215 | FP-Norm(final)=2.525 | 3725.8 samples/s | 58.2 steps/s
[Step=11900 Epoch=45.6] | Loss=0.00081 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.202 | FP-Norm(final)=2.526 | 3702.9 samples/s | 57.9 steps/s
[Step=11950 Epoch=45.8] | Loss=0.00076 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.189 | FP-Norm(final)=2.526 | 3680.5 samples/s | 57.5 steps/s
[Step=12000 Epoch=46.0] | Loss=0.00071 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.175 | FP-Norm(final)=2.527 | 1796.5 samples/s | 28.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step12000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=43.1] | Loss=0.07350 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.503 | 3639.2 samples/s | 56.9 steps/s
[Step=11250 Epoch=43.3] | Loss=0.00528 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.275 | FP-Norm(final)=2.514 | 3671.6 samples/s | 57.4 steps/s
[Step=11300 Epoch=43.5] | Loss=0.00296 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.335 | FP-Norm(final)=2.519 | 3741.1 samples/s | 58.5 steps/s
[Step=11350 Epoch=43.7] | Loss=0.00206 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.313 | FP-Norm(final)=2.524 | 3702.9 samples/s | 57.9 steps/s
[Step=11400 Epoch=43.9] | Loss=0.00157 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.278 | FP-Norm(final)=2.528 | 3697.3 samples/s | 57.8 steps/s
[Step=11450 Epoch=44.1] | Loss=0.00129 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.243 | FP-Norm(final)=2.530 | 4590.2 samples/s | 71.7 steps/s
[Step=11500 Epoch=44.3] | Loss=0.00108 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.210 | FP-Norm(final)=2.533 | 1642.0 samples/s | 25.7 steps/s
[Step=11550 Epoch=44.5] | Loss=0.00093 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.177 | FP-Norm(final)=2.534 | 3722.2 samples/s | 58.2 steps/s
[Step=11600 Epoch=44.7] | Loss=0.00082 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.147 | FP-Norm(final)=2.535 | 3711.3 samples/s | 58.0 steps/s
[Step=11650 Epoch=44.8] | Loss=0.00073 | Reg=0.00129 | acc=1.0000 | FP-Norm=1.118 | FP-Norm(final)=2.536 | 3696.1 samples/s | 57.8 steps/s
[Step=11700 Epoch=45.0] | Loss=0.00066 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.092 | FP-Norm(final)=2.537 | 4070.2 samples/s | 63.6 steps/s
[Step=11750 Epoch=45.2] | Loss=0.00061 | Reg=0.00119 | acc=1.0000 | FP-Norm=1.067 | FP-Norm(final)=2.537 | 1705.6 samples/s | 26.7 steps/s
[Step=11800 Epoch=45.4] | Loss=0.00056 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.044 | FP-Norm(final)=2.538 | 3738.2 samples/s | 58.4 steps/s
[Step=11850 Epoch=45.6] | Loss=0.00052 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.022 | FP-Norm(final)=2.538 | 3664.4 samples/s | 57.3 steps/s
[Step=11900 Epoch=45.8] | Loss=0.00048 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.001 | FP-Norm(final)=2.538 | 3702.5 samples/s | 57.9 steps/s
[Step=11950 Epoch=46.0] | Loss=0.00045 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.981 | FP-Norm(final)=2.539 | 3847.9 samples/s | 60.1 steps/s
[Step=12000 Epoch=46.2] | Loss=0.00043 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.962 | FP-Norm(final)=2.539 | 1817.9 samples/s | 28.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24455 | acc=0.8444 | tpr=0.7783 | fpr=0.0121 | 3814.7 samples/s | 14.9 steps/s
Avg test loss: 0.25111, Avg test acc: 0.84290, Avg tpr: 0.77846, Avg fpr: 0.01538, total FA: 120

Testing server on iccad2012
[Step=  50] | Loss=0.35457 | acc=0.8190 | tpr=0.9469 | fpr=0.1833 | 3897.5 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.35016 | acc=0.8225 | tpr=0.9616 | fpr=0.1801 | 7447.5 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.35653 | acc=0.8218 | tpr=0.9654 | fpr=0.1808 | 7134.4 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.36003 | acc=0.8211 | tpr=0.9683 | fpr=0.1815 | 7143.4 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.35835 | acc=0.8222 | tpr=0.9694 | fpr=0.1805 | 7323.4 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.35919 | acc=0.8221 | tpr=0.9680 | fpr=0.1806 | 7372.2 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.36143 | acc=0.8220 | tpr=0.9681 | fpr=0.1806 | 7436.0 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.36201 | acc=0.8221 | tpr=0.9655 | fpr=0.1805 | 7296.8 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.36363 | acc=0.8217 | tpr=0.9659 | fpr=0.1809 | 7206.1 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.36388 | acc=0.8217 | tpr=0.9670 | fpr=0.1809 | 7194.6 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.36327 | acc=0.8217 | tpr=0.9658 | fpr=0.1809 | 13486.0 samples/s | 52.7 steps/s
Avg test loss: 0.36320, Avg test acc: 0.82168, Avg tpr: 0.96553, Avg fpr: 0.18094, total FA: 25123

server round 15/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=23.4] | Loss=0.16754 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.527 | 3358.0 samples/s | 52.5 steps/s
[Step=12050 Epoch=23.5] | Loss=0.03057 | Reg=0.00075 | acc=0.9844 | FP-Norm=0.831 | FP-Norm(final)=2.519 | 3885.6 samples/s | 60.7 steps/s
[Step=12100 Epoch=23.6] | Loss=0.02319 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.894 | FP-Norm(final)=2.520 | 3884.1 samples/s | 60.7 steps/s
[Step=12150 Epoch=23.7] | Loss=0.02313 | Reg=0.00089 | acc=0.9844 | FP-Norm=0.932 | FP-Norm(final)=2.523 | 3900.7 samples/s | 60.9 steps/s
[Step=12200 Epoch=23.8] | Loss=0.02223 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.973 | FP-Norm(final)=2.525 | 3897.7 samples/s | 60.9 steps/s
[Step=12250 Epoch=23.9] | Loss=0.02183 | Reg=0.00104 | acc=0.9531 | FP-Norm=1.007 | FP-Norm(final)=2.525 | 3905.7 samples/s | 61.0 steps/s
[Step=12300 Epoch=24.0] | Loss=0.02237 | Reg=0.00110 | acc=0.9844 | FP-Norm=1.036 | FP-Norm(final)=2.526 | 3886.0 samples/s | 60.7 steps/s
[Step=12350 Epoch=24.1] | Loss=0.02201 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.059 | FP-Norm(final)=2.526 | 3891.0 samples/s | 60.8 steps/s
[Step=12400 Epoch=24.2] | Loss=0.02161 | Reg=0.00119 | acc=1.0000 | FP-Norm=1.079 | FP-Norm(final)=2.526 | 4012.9 samples/s | 62.7 steps/s
[Step=12450 Epoch=24.3] | Loss=0.02181 | Reg=0.00123 | acc=0.9844 | FP-Norm=1.098 | FP-Norm(final)=2.526 | 3985.3 samples/s | 62.3 steps/s
[Step=12500 Epoch=24.4] | Loss=0.02161 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.118 | FP-Norm(final)=2.526 | 4609.4 samples/s | 72.0 steps/s
[Step=12550 Epoch=24.5] | Loss=0.02112 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.135 | FP-Norm(final)=2.526 | 1630.3 samples/s | 25.5 steps/s
[Step=12600 Epoch=24.6] | Loss=0.02106 | Reg=0.00135 | acc=1.0000 | FP-Norm=1.150 | FP-Norm(final)=2.526 | 3866.3 samples/s | 60.4 steps/s
[Step=12650 Epoch=24.7] | Loss=0.02047 | Reg=0.00138 | acc=0.9844 | FP-Norm=1.164 | FP-Norm(final)=2.527 | 3893.6 samples/s | 60.8 steps/s
[Step=12700 Epoch=24.8] | Loss=0.02016 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.175 | FP-Norm(final)=2.528 | 3898.1 samples/s | 60.9 steps/s
[Step=12750 Epoch=24.9] | Loss=0.01998 | Reg=0.00143 | acc=0.9844 | FP-Norm=1.186 | FP-Norm(final)=2.528 | 3885.8 samples/s | 60.7 steps/s
[Step=12800 Epoch=25.0] | Loss=0.02000 | Reg=0.00146 | acc=0.9688 | FP-Norm=1.196 | FP-Norm(final)=2.529 | 3880.8 samples/s | 60.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step12800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=23.5] | Loss=0.17565 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.527 | 3660.3 samples/s | 57.2 steps/s
[Step=12050 Epoch=23.6] | Loss=0.03035 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.520 | 3805.6 samples/s | 59.5 steps/s
[Step=12100 Epoch=23.7] | Loss=0.02521 | Reg=0.00076 | acc=0.9844 | FP-Norm=0.851 | FP-Norm(final)=2.519 | 3898.4 samples/s | 60.9 steps/s
[Step=12150 Epoch=23.8] | Loss=0.02423 | Reg=0.00084 | acc=0.9844 | FP-Norm=0.900 | FP-Norm(final)=2.519 | 3857.6 samples/s | 60.3 steps/s
[Step=12200 Epoch=23.9] | Loss=0.02414 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.931 | FP-Norm(final)=2.519 | 3874.5 samples/s | 60.5 steps/s
[Step=12250 Epoch=23.9] | Loss=0.02354 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.958 | FP-Norm(final)=2.519 | 3898.8 samples/s | 60.9 steps/s
[Step=12300 Epoch=24.0] | Loss=0.02227 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.982 | FP-Norm(final)=2.520 | 3917.1 samples/s | 61.2 steps/s
[Step=12350 Epoch=24.1] | Loss=0.02167 | Reg=0.00102 | acc=0.9844 | FP-Norm=0.999 | FP-Norm(final)=2.522 | 3913.5 samples/s | 61.1 steps/s
[Step=12400 Epoch=24.2] | Loss=0.02138 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.018 | FP-Norm(final)=2.524 | 3905.0 samples/s | 61.0 steps/s
[Step=12450 Epoch=24.3] | Loss=0.02064 | Reg=0.00110 | acc=0.9844 | FP-Norm=1.039 | FP-Norm(final)=2.525 | 3883.3 samples/s | 60.7 steps/s
[Step=12500 Epoch=24.4] | Loss=0.02086 | Reg=0.00114 | acc=0.9844 | FP-Norm=1.057 | FP-Norm(final)=2.527 | 4665.7 samples/s | 72.9 steps/s
[Step=12550 Epoch=24.5] | Loss=0.02043 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.071 | FP-Norm(final)=2.527 | 1702.4 samples/s | 26.6 steps/s
[Step=12600 Epoch=24.6] | Loss=0.01988 | Reg=0.00119 | acc=1.0000 | FP-Norm=1.081 | FP-Norm(final)=2.527 | 3865.3 samples/s | 60.4 steps/s
[Step=12650 Epoch=24.7] | Loss=0.01970 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.091 | FP-Norm(final)=2.528 | 3885.2 samples/s | 60.7 steps/s
[Step=12700 Epoch=24.8] | Loss=0.01928 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.101 | FP-Norm(final)=2.529 | 3901.7 samples/s | 61.0 steps/s
[Step=12750 Epoch=24.9] | Loss=0.01882 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.110 | FP-Norm(final)=2.530 | 3869.5 samples/s | 60.5 steps/s
[Step=12800 Epoch=25.0] | Loss=0.01854 | Reg=0.00127 | acc=0.9531 | FP-Norm=1.119 | FP-Norm(final)=2.531 | 3951.9 samples/s | 61.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step12800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=46.0] | Loss=0.04465 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.527 | 3732.7 samples/s | 58.3 steps/s
[Step=12050 Epoch=46.2] | Loss=0.00955 | Reg=0.00250 | acc=1.0000 | FP-Norm=1.502 | FP-Norm(final)=2.523 | 3491.2 samples/s | 54.6 steps/s
[Step=12100 Epoch=46.4] | Loss=0.00575 | Reg=0.00293 | acc=1.0000 | FP-Norm=1.668 | FP-Norm(final)=2.523 | 3676.5 samples/s | 57.4 steps/s
[Step=12150 Epoch=46.6] | Loss=0.00393 | Reg=0.00292 | acc=1.0000 | FP-Norm=1.680 | FP-Norm(final)=2.526 | 3681.8 samples/s | 57.5 steps/s
[Step=12200 Epoch=46.7] | Loss=0.00299 | Reg=0.00282 | acc=1.0000 | FP-Norm=1.656 | FP-Norm(final)=2.528 | 3721.3 samples/s | 58.1 steps/s
[Step=12250 Epoch=46.9] | Loss=0.00241 | Reg=0.00270 | acc=1.0000 | FP-Norm=1.624 | FP-Norm(final)=2.530 | 4452.8 samples/s | 69.6 steps/s
[Step=12300 Epoch=47.1] | Loss=0.00202 | Reg=0.00259 | acc=1.0000 | FP-Norm=1.591 | FP-Norm(final)=2.532 | 1640.6 samples/s | 25.6 steps/s
[Step=12350 Epoch=47.3] | Loss=0.00174 | Reg=0.00249 | acc=1.0000 | FP-Norm=1.558 | FP-Norm(final)=2.534 | 3725.7 samples/s | 58.2 steps/s
[Step=12400 Epoch=47.5] | Loss=0.00153 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.525 | FP-Norm(final)=2.535 | 3667.8 samples/s | 57.3 steps/s
[Step=12450 Epoch=47.7] | Loss=0.00136 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.494 | FP-Norm(final)=2.536 | 3669.7 samples/s | 57.3 steps/s
[Step=12500 Epoch=47.9] | Loss=0.00123 | Reg=0.00221 | acc=1.0000 | FP-Norm=1.464 | FP-Norm(final)=2.537 | 4039.4 samples/s | 63.1 steps/s
[Step=12550 Epoch=48.1] | Loss=0.00112 | Reg=0.00213 | acc=1.0000 | FP-Norm=1.436 | FP-Norm(final)=2.538 | 1739.1 samples/s | 27.2 steps/s
[Step=12600 Epoch=48.3] | Loss=0.00103 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.409 | FP-Norm(final)=2.538 | 3717.2 samples/s | 58.1 steps/s
[Step=12650 Epoch=48.5] | Loss=0.00095 | Reg=0.00198 | acc=1.0000 | FP-Norm=1.384 | FP-Norm(final)=2.539 | 3693.6 samples/s | 57.7 steps/s
[Step=12700 Epoch=48.7] | Loss=0.00089 | Reg=0.00192 | acc=1.0000 | FP-Norm=1.360 | FP-Norm(final)=2.540 | 3686.7 samples/s | 57.6 steps/s
[Step=12750 Epoch=48.9] | Loss=0.00083 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.336 | FP-Norm(final)=2.540 | 3700.9 samples/s | 57.8 steps/s
[Step=12800 Epoch=49.0] | Loss=0.00078 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.314 | FP-Norm(final)=2.541 | 1801.8 samples/s | 28.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step12800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=46.2] | Loss=0.12289 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.526 | 3764.6 samples/s | 58.8 steps/s
[Step=12050 Epoch=46.4] | Loss=0.00905 | Reg=0.00271 | acc=1.0000 | FP-Norm=1.575 | FP-Norm(final)=2.535 | 3490.1 samples/s | 54.5 steps/s
[Step=12100 Epoch=46.6] | Loss=0.00800 | Reg=0.00354 | acc=1.0000 | FP-Norm=1.832 | FP-Norm(final)=2.525 | 3809.0 samples/s | 59.5 steps/s
[Step=12150 Epoch=46.8] | Loss=0.00604 | Reg=0.00371 | acc=1.0000 | FP-Norm=1.893 | FP-Norm(final)=2.518 | 3777.7 samples/s | 59.0 steps/s
[Step=12200 Epoch=47.0] | Loss=0.00462 | Reg=0.00368 | acc=1.0000 | FP-Norm=1.894 | FP-Norm(final)=2.516 | 3703.4 samples/s | 57.9 steps/s
[Step=12250 Epoch=47.2] | Loss=0.00383 | Reg=0.00359 | acc=1.0000 | FP-Norm=1.874 | FP-Norm(final)=2.516 | 4529.6 samples/s | 70.8 steps/s
[Step=12300 Epoch=47.3] | Loss=0.00322 | Reg=0.00349 | acc=1.0000 | FP-Norm=1.850 | FP-Norm(final)=2.517 | 1670.3 samples/s | 26.1 steps/s
[Step=12350 Epoch=47.5] | Loss=0.00284 | Reg=0.00339 | acc=1.0000 | FP-Norm=1.824 | FP-Norm(final)=2.518 | 3756.2 samples/s | 58.7 steps/s
[Step=12400 Epoch=47.7] | Loss=0.00251 | Reg=0.00329 | acc=1.0000 | FP-Norm=1.798 | FP-Norm(final)=2.519 | 3715.5 samples/s | 58.1 steps/s
[Step=12450 Epoch=47.9] | Loss=0.00224 | Reg=0.00320 | acc=1.0000 | FP-Norm=1.772 | FP-Norm(final)=2.520 | 3731.3 samples/s | 58.3 steps/s
[Step=12500 Epoch=48.1] | Loss=0.00202 | Reg=0.00311 | acc=1.0000 | FP-Norm=1.746 | FP-Norm(final)=2.521 | 4113.2 samples/s | 64.3 steps/s
[Step=12550 Epoch=48.3] | Loss=0.00184 | Reg=0.00302 | acc=1.0000 | FP-Norm=1.719 | FP-Norm(final)=2.523 | 1723.1 samples/s | 26.9 steps/s
[Step=12600 Epoch=48.5] | Loss=0.00169 | Reg=0.00293 | acc=1.0000 | FP-Norm=1.692 | FP-Norm(final)=2.523 | 3743.8 samples/s | 58.5 steps/s
[Step=12650 Epoch=48.7] | Loss=0.00156 | Reg=0.00284 | acc=1.0000 | FP-Norm=1.666 | FP-Norm(final)=2.524 | 3679.5 samples/s | 57.5 steps/s
[Step=12700 Epoch=48.9] | Loss=0.00145 | Reg=0.00276 | acc=1.0000 | FP-Norm=1.640 | FP-Norm(final)=2.525 | 3813.9 samples/s | 59.6 steps/s
[Step=12750 Epoch=49.1] | Loss=0.00136 | Reg=0.00268 | acc=1.0000 | FP-Norm=1.616 | FP-Norm(final)=2.526 | 3870.2 samples/s | 60.5 steps/s
[Step=12800 Epoch=49.3] | Loss=0.00127 | Reg=0.00261 | acc=1.0000 | FP-Norm=1.591 | FP-Norm(final)=2.526 | 1786.7 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30840 | acc=0.8059 | tpr=0.7217 | fpr=0.0111 | 3874.4 samples/s | 15.1 steps/s
Avg test loss: 0.31318, Avg test acc: 0.80583, Avg tpr: 0.72361, Avg fpr: 0.01333, total FA: 104

Testing server on iccad2012
[Step=  50] | Loss=0.29829 | acc=0.8619 | tpr=0.9602 | fpr=0.1399 | 3845.6 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.29566 | acc=0.8639 | tpr=0.9701 | fpr=0.1381 | 7324.4 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.30289 | acc=0.8624 | tpr=0.9712 | fpr=0.1396 | 7163.3 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.30724 | acc=0.8618 | tpr=0.9727 | fpr=0.1402 | 7398.4 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.30527 | acc=0.8621 | tpr=0.9729 | fpr=0.1399 | 7253.8 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.30659 | acc=0.8621 | tpr=0.9709 | fpr=0.1399 | 7418.9 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.30897 | acc=0.8616 | tpr=0.9712 | fpr=0.1404 | 7580.1 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.30932 | acc=0.8616 | tpr=0.9683 | fpr=0.1403 | 4572.0 samples/s | 17.9 steps/s
[Step= 450] | Loss=0.31136 | acc=0.8611 | tpr=0.9684 | fpr=0.1408 | 7138.7 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.31180 | acc=0.8606 | tpr=0.9692 | fpr=0.1414 | 7576.2 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.31135 | acc=0.8607 | tpr=0.9682 | fpr=0.1412 | 12557.0 samples/s | 49.1 steps/s
Avg test loss: 0.31121, Avg test acc: 0.86074, Avg tpr: 0.96791, Avg fpr: 0.14121, total FA: 19607

server round 16/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=25.0] | Loss=0.10324 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.540 | 3700.7 samples/s | 57.8 steps/s
[Step=12850 Epoch=25.1] | Loss=0.03120 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.938 | FP-Norm(final)=2.529 | 3664.1 samples/s | 57.3 steps/s
[Step=12900 Epoch=25.2] | Loss=0.02311 | Reg=0.00103 | acc=1.0000 | FP-Norm=0.992 | FP-Norm(final)=2.532 | 3982.1 samples/s | 62.2 steps/s
[Step=12950 Epoch=25.3] | Loss=0.02229 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.009 | FP-Norm(final)=2.535 | 4016.8 samples/s | 62.8 steps/s
[Step=13000 Epoch=25.4] | Loss=0.02178 | Reg=0.00112 | acc=0.9844 | FP-Norm=1.046 | FP-Norm(final)=2.536 | 3991.0 samples/s | 62.4 steps/s
[Step=13050 Epoch=25.5] | Loss=0.02148 | Reg=0.00118 | acc=0.9844 | FP-Norm=1.076 | FP-Norm(final)=2.538 | 4057.7 samples/s | 63.4 steps/s
[Step=13100 Epoch=25.6] | Loss=0.02158 | Reg=0.00122 | acc=0.9844 | FP-Norm=1.095 | FP-Norm(final)=2.539 | 3987.8 samples/s | 62.3 steps/s
[Step=13150 Epoch=25.6] | Loss=0.02160 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.111 | FP-Norm(final)=2.539 | 4043.6 samples/s | 63.2 steps/s
[Step=13200 Epoch=25.7] | Loss=0.02138 | Reg=0.00129 | acc=0.9844 | FP-Norm=1.127 | FP-Norm(final)=2.540 | 3964.3 samples/s | 61.9 steps/s
[Step=13250 Epoch=25.8] | Loss=0.02134 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.141 | FP-Norm(final)=2.541 | 3953.1 samples/s | 61.8 steps/s
[Step=13300 Epoch=25.9] | Loss=0.02142 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.156 | FP-Norm(final)=2.540 | 4596.1 samples/s | 71.8 steps/s
[Step=13350 Epoch=26.0] | Loss=0.02121 | Reg=0.00139 | acc=0.9688 | FP-Norm=1.170 | FP-Norm(final)=2.540 | 1654.3 samples/s | 25.8 steps/s
[Step=13400 Epoch=26.1] | Loss=0.02062 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.181 | FP-Norm(final)=2.540 | 3871.2 samples/s | 60.5 steps/s
[Step=13450 Epoch=26.2] | Loss=0.01997 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.190 | FP-Norm(final)=2.541 | 3891.5 samples/s | 60.8 steps/s
[Step=13500 Epoch=26.3] | Loss=0.01948 | Reg=0.00145 | acc=0.9688 | FP-Norm=1.199 | FP-Norm(final)=2.542 | 3919.9 samples/s | 61.2 steps/s
[Step=13550 Epoch=26.4] | Loss=0.01904 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.207 | FP-Norm(final)=2.543 | 3884.4 samples/s | 60.7 steps/s
[Step=13600 Epoch=26.5] | Loss=0.01886 | Reg=0.00149 | acc=0.9844 | FP-Norm=1.214 | FP-Norm(final)=2.544 | 3893.9 samples/s | 60.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step13600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=25.0] | Loss=0.16608 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.541 | 3817.6 samples/s | 59.6 steps/s
[Step=12850 Epoch=25.1] | Loss=0.03876 | Reg=0.00131 | acc=0.9688 | FP-Norm=1.098 | FP-Norm(final)=2.524 | 3706.6 samples/s | 57.9 steps/s
[Step=12900 Epoch=25.2] | Loss=0.02955 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.131 | FP-Norm(final)=2.526 | 3859.6 samples/s | 60.3 steps/s
[Step=12950 Epoch=25.3] | Loss=0.02631 | Reg=0.00133 | acc=0.9844 | FP-Norm=1.137 | FP-Norm(final)=2.529 | 3900.1 samples/s | 60.9 steps/s
[Step=13000 Epoch=25.4] | Loss=0.02434 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.143 | FP-Norm(final)=2.529 | 3926.6 samples/s | 61.4 steps/s
[Step=13050 Epoch=25.5] | Loss=0.02442 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.150 | FP-Norm(final)=2.530 | 3857.9 samples/s | 60.3 steps/s
[Step=13100 Epoch=25.6] | Loss=0.02425 | Reg=0.00136 | acc=0.9688 | FP-Norm=1.158 | FP-Norm(final)=2.530 | 3901.6 samples/s | 61.0 steps/s
[Step=13150 Epoch=25.7] | Loss=0.02311 | Reg=0.00137 | acc=0.9688 | FP-Norm=1.165 | FP-Norm(final)=2.532 | 3912.2 samples/s | 61.1 steps/s
[Step=13200 Epoch=25.8] | Loss=0.02267 | Reg=0.00139 | acc=0.9844 | FP-Norm=1.173 | FP-Norm(final)=2.533 | 3941.6 samples/s | 61.6 steps/s
[Step=13250 Epoch=25.9] | Loss=0.02193 | Reg=0.00141 | acc=0.9688 | FP-Norm=1.180 | FP-Norm(final)=2.535 | 3887.6 samples/s | 60.7 steps/s
[Step=13300 Epoch=26.0] | Loss=0.02140 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.186 | FP-Norm(final)=2.536 | 4668.9 samples/s | 73.0 steps/s
[Step=13350 Epoch=26.1] | Loss=0.02118 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.191 | FP-Norm(final)=2.537 | 1720.6 samples/s | 26.9 steps/s
[Step=13400 Epoch=26.2] | Loss=0.02022 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.196 | FP-Norm(final)=2.539 | 3989.1 samples/s | 62.3 steps/s
[Step=13450 Epoch=26.3] | Loss=0.01958 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.200 | FP-Norm(final)=2.542 | 3975.2 samples/s | 62.1 steps/s
[Step=13500 Epoch=26.4] | Loss=0.01922 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.207 | FP-Norm(final)=2.543 | 3970.4 samples/s | 62.0 steps/s
[Step=13550 Epoch=26.5] | Loss=0.01902 | Reg=0.00148 | acc=0.9844 | FP-Norm=1.214 | FP-Norm(final)=2.545 | 4005.7 samples/s | 62.6 steps/s
[Step=13600 Epoch=26.6] | Loss=0.01894 | Reg=0.00150 | acc=0.9844 | FP-Norm=1.222 | FP-Norm(final)=2.546 | 4014.2 samples/s | 62.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step13600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=49.0] | Loss=0.15434 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.540 | 3600.2 samples/s | 56.3 steps/s
[Step=12850 Epoch=49.2] | Loss=0.00585 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.189 | FP-Norm(final)=2.540 | 3676.1 samples/s | 57.4 steps/s
[Step=12900 Epoch=49.4] | Loss=0.00310 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.245 | FP-Norm(final)=2.543 | 3689.4 samples/s | 57.6 steps/s
[Step=12950 Epoch=49.6] | Loss=0.00213 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.228 | FP-Norm(final)=2.547 | 3688.4 samples/s | 57.6 steps/s
[Step=13000 Epoch=49.8] | Loss=0.00166 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.200 | FP-Norm(final)=2.550 | 3706.4 samples/s | 57.9 steps/s
[Step=13050 Epoch=50.0] | Loss=0.00135 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.173 | FP-Norm(final)=2.553 | 4512.6 samples/s | 70.5 steps/s
[Step=13100 Epoch=50.2] | Loss=0.00114 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.144 | FP-Norm(final)=2.555 | 1654.7 samples/s | 25.9 steps/s
[Step=13150 Epoch=50.4] | Loss=0.00098 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.116 | FP-Norm(final)=2.556 | 3728.6 samples/s | 58.3 steps/s
[Step=13200 Epoch=50.6] | Loss=0.00086 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.091 | FP-Norm(final)=2.558 | 3708.4 samples/s | 57.9 steps/s
[Step=13250 Epoch=50.8] | Loss=0.00077 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.066 | FP-Norm(final)=2.559 | 3673.0 samples/s | 57.4 steps/s
[Step=13300 Epoch=51.0] | Loss=0.00070 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.042 | FP-Norm(final)=2.559 | 4045.8 samples/s | 63.2 steps/s
[Step=13350 Epoch=51.2] | Loss=0.00064 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.020 | FP-Norm(final)=2.560 | 1746.9 samples/s | 27.3 steps/s
[Step=13400 Epoch=51.3] | Loss=0.00059 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.000 | FP-Norm(final)=2.561 | 3775.7 samples/s | 59.0 steps/s
[Step=13450 Epoch=51.5] | Loss=0.00054 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.980 | FP-Norm(final)=2.561 | 3750.1 samples/s | 58.6 steps/s
[Step=13500 Epoch=51.7] | Loss=0.00051 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.961 | FP-Norm(final)=2.561 | 3689.4 samples/s | 57.6 steps/s
[Step=13550 Epoch=51.9] | Loss=0.00048 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.943 | FP-Norm(final)=2.562 | 3705.0 samples/s | 57.9 steps/s
[Step=13600 Epoch=52.1] | Loss=0.00045 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.926 | FP-Norm(final)=2.562 | 1782.5 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step13600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=49.3] | Loss=0.06322 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.541 | 3598.7 samples/s | 56.2 steps/s
[Step=12850 Epoch=49.5] | Loss=0.00483 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.147 | FP-Norm(final)=2.551 | 3703.7 samples/s | 57.9 steps/s
[Step=12900 Epoch=49.7] | Loss=0.00342 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.311 | FP-Norm(final)=2.552 | 3783.3 samples/s | 59.1 steps/s
[Step=12950 Epoch=49.8] | Loss=0.00239 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.341 | FP-Norm(final)=2.554 | 3774.7 samples/s | 59.0 steps/s
[Step=13000 Epoch=50.0] | Loss=0.00185 | Reg=0.00183 | acc=1.0000 | FP-Norm=1.335 | FP-Norm(final)=2.557 | 3704.4 samples/s | 57.9 steps/s
[Step=13050 Epoch=50.2] | Loss=0.00152 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.321 | FP-Norm(final)=2.559 | 4555.0 samples/s | 71.2 steps/s
[Step=13100 Epoch=50.4] | Loss=0.00128 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.301 | FP-Norm(final)=2.560 | 1657.1 samples/s | 25.9 steps/s
[Step=13150 Epoch=50.6] | Loss=0.00110 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.278 | FP-Norm(final)=2.561 | 3811.0 samples/s | 59.5 steps/s
[Step=13200 Epoch=50.8] | Loss=0.00097 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.255 | FP-Norm(final)=2.562 | 3798.7 samples/s | 59.4 steps/s
[Step=13250 Epoch=51.0] | Loss=0.00086 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.233 | FP-Norm(final)=2.563 | 3784.2 samples/s | 59.1 steps/s
[Step=13300 Epoch=51.2] | Loss=0.00078 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.211 | FP-Norm(final)=2.564 | 4245.8 samples/s | 66.3 steps/s
[Step=13350 Epoch=51.4] | Loss=0.00071 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.189 | FP-Norm(final)=2.564 | 1753.5 samples/s | 27.4 steps/s
[Step=13400 Epoch=51.6] | Loss=0.00065 | Reg=0.00140 | acc=1.0000 | FP-Norm=1.168 | FP-Norm(final)=2.565 | 3759.5 samples/s | 58.7 steps/s
[Step=13450 Epoch=51.8] | Loss=0.00061 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.148 | FP-Norm(final)=2.565 | 3788.2 samples/s | 59.2 steps/s
[Step=13500 Epoch=52.0] | Loss=0.00056 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.129 | FP-Norm(final)=2.565 | 3704.7 samples/s | 57.9 steps/s
[Step=13550 Epoch=52.2] | Loss=0.00053 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.111 | FP-Norm(final)=2.566 | 3774.7 samples/s | 59.0 steps/s
[Step=13600 Epoch=52.4] | Loss=0.00050 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.093 | FP-Norm(final)=2.566 | 1792.4 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26012 | acc=0.8403 | tpr=0.7718 | fpr=0.0109 | 3877.7 samples/s | 15.1 steps/s
Avg test loss: 0.26540, Avg test acc: 0.83797, Avg tpr: 0.77012, Avg fpr: 0.01282, total FA: 100

Testing server on iccad2012
[Step=  50] | Loss=0.34538 | acc=0.8328 | tpr=0.9558 | fpr=0.1694 | 3882.5 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.34290 | acc=0.8376 | tpr=0.9659 | fpr=0.1648 | 7142.4 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.35111 | acc=0.8359 | tpr=0.9669 | fpr=0.1665 | 7600.1 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.35568 | acc=0.8342 | tpr=0.9683 | fpr=0.1683 | 4594.2 samples/s | 17.9 steps/s
[Step= 250] | Loss=0.35378 | acc=0.8348 | tpr=0.9694 | fpr=0.1677 | 7203.9 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.35496 | acc=0.8346 | tpr=0.9673 | fpr=0.1678 | 7184.6 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.35703 | acc=0.8344 | tpr=0.9687 | fpr=0.1681 | 7298.6 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.35707 | acc=0.8344 | tpr=0.9650 | fpr=0.1680 | 7132.8 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.35917 | acc=0.8341 | tpr=0.9659 | fpr=0.1683 | 7197.8 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.35961 | acc=0.8338 | tpr=0.9670 | fpr=0.1686 | 7316.5 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.35900 | acc=0.8338 | tpr=0.9662 | fpr=0.1686 | 12974.6 samples/s | 50.7 steps/s
Avg test loss: 0.35892, Avg test acc: 0.83381, Avg tpr: 0.96593, Avg fpr: 0.16859, total FA: 23408

server round 17/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=26.5] | Loss=0.13641 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.561 | 3747.7 samples/s | 58.6 steps/s
[Step=13650 Epoch=26.6] | Loss=0.02519 | Reg=0.00075 | acc=0.9844 | FP-Norm=0.835 | FP-Norm(final)=2.554 | 3684.2 samples/s | 57.6 steps/s
[Step=13700 Epoch=26.7] | Loss=0.02297 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.904 | FP-Norm(final)=2.554 | 3871.2 samples/s | 60.5 steps/s
[Step=13750 Epoch=26.8] | Loss=0.02342 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.940 | FP-Norm(final)=2.550 | 3890.0 samples/s | 60.8 steps/s
[Step=13800 Epoch=26.9] | Loss=0.02244 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.959 | FP-Norm(final)=2.549 | 3898.7 samples/s | 60.9 steps/s
[Step=13850 Epoch=27.0] | Loss=0.02221 | Reg=0.00097 | acc=0.9688 | FP-Norm=0.978 | FP-Norm(final)=2.547 | 3890.9 samples/s | 60.8 steps/s
[Step=13900 Epoch=27.1] | Loss=0.02145 | Reg=0.00100 | acc=0.9844 | FP-Norm=0.993 | FP-Norm(final)=2.547 | 3911.7 samples/s | 61.1 steps/s
[Step=13950 Epoch=27.2] | Loss=0.02088 | Reg=0.00103 | acc=1.0000 | FP-Norm=1.009 | FP-Norm(final)=2.546 | 3937.8 samples/s | 61.5 steps/s
[Step=14000 Epoch=27.3] | Loss=0.02096 | Reg=0.00107 | acc=0.9688 | FP-Norm=1.028 | FP-Norm(final)=2.546 | 3895.2 samples/s | 60.9 steps/s
[Step=14050 Epoch=27.4] | Loss=0.02023 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.049 | FP-Norm(final)=2.546 | 3891.2 samples/s | 60.8 steps/s
[Step=14100 Epoch=27.5] | Loss=0.02001 | Reg=0.00115 | acc=0.9375 | FP-Norm=1.064 | FP-Norm(final)=2.547 | 4510.2 samples/s | 70.5 steps/s
[Step=14150 Epoch=27.6] | Loss=0.01985 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.079 | FP-Norm(final)=2.547 | 1654.1 samples/s | 25.8 steps/s
[Step=14200 Epoch=27.7] | Loss=0.01946 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.092 | FP-Norm(final)=2.547 | 3873.5 samples/s | 60.5 steps/s
[Step=14250 Epoch=27.8] | Loss=0.01926 | Reg=0.00124 | acc=0.9844 | FP-Norm=1.104 | FP-Norm(final)=2.547 | 3912.8 samples/s | 61.1 steps/s
[Step=14300 Epoch=27.9] | Loss=0.01880 | Reg=0.00127 | acc=0.9844 | FP-Norm=1.116 | FP-Norm(final)=2.547 | 3901.0 samples/s | 61.0 steps/s
[Step=14350 Epoch=28.0] | Loss=0.01848 | Reg=0.00129 | acc=0.9844 | FP-Norm=1.128 | FP-Norm(final)=2.548 | 3870.9 samples/s | 60.5 steps/s
[Step=14400 Epoch=28.1] | Loss=0.01861 | Reg=0.00132 | acc=0.9531 | FP-Norm=1.140 | FP-Norm(final)=2.548 | 3822.6 samples/s | 59.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step14400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=26.6] | Loss=0.20153 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.561 | 3557.3 samples/s | 55.6 steps/s
[Step=13650 Epoch=26.7] | Loss=0.03491 | Reg=0.00103 | acc=0.9844 | FP-Norm=0.974 | FP-Norm(final)=2.549 | 3954.2 samples/s | 61.8 steps/s
[Step=13700 Epoch=26.8] | Loss=0.02711 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.031 | FP-Norm(final)=2.550 | 3885.6 samples/s | 60.7 steps/s
[Step=13750 Epoch=26.9] | Loss=0.02682 | Reg=0.00116 | acc=0.9844 | FP-Norm=1.064 | FP-Norm(final)=2.550 | 3871.4 samples/s | 60.5 steps/s
[Step=13800 Epoch=27.0] | Loss=0.02392 | Reg=0.00119 | acc=1.0000 | FP-Norm=1.079 | FP-Norm(final)=2.552 | 3904.6 samples/s | 61.0 steps/s
[Step=13850 Epoch=27.1] | Loss=0.02410 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.094 | FP-Norm(final)=2.552 | 3923.4 samples/s | 61.3 steps/s
[Step=13900 Epoch=27.2] | Loss=0.02316 | Reg=0.00125 | acc=0.9844 | FP-Norm=1.111 | FP-Norm(final)=2.551 | 3893.0 samples/s | 60.8 steps/s
[Step=13950 Epoch=27.3] | Loss=0.02199 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.121 | FP-Norm(final)=2.552 | 3916.2 samples/s | 61.2 steps/s
[Step=14000 Epoch=27.4] | Loss=0.02077 | Reg=0.00129 | acc=1.0000 | FP-Norm=1.130 | FP-Norm(final)=2.553 | 3904.0 samples/s | 61.0 steps/s
[Step=14050 Epoch=27.5] | Loss=0.02099 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.140 | FP-Norm(final)=2.554 | 3894.5 samples/s | 60.9 steps/s
[Step=14100 Epoch=27.6] | Loss=0.02064 | Reg=0.00134 | acc=0.9688 | FP-Norm=1.150 | FP-Norm(final)=2.554 | 4629.0 samples/s | 72.3 steps/s
[Step=14150 Epoch=27.7] | Loss=0.01999 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.160 | FP-Norm(final)=2.555 | 1696.4 samples/s | 26.5 steps/s
[Step=14200 Epoch=27.8] | Loss=0.01924 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.166 | FP-Norm(final)=2.556 | 3871.7 samples/s | 60.5 steps/s
[Step=14250 Epoch=27.9] | Loss=0.01894 | Reg=0.00138 | acc=0.9844 | FP-Norm=1.171 | FP-Norm(final)=2.557 | 3928.9 samples/s | 61.4 steps/s
[Step=14300 Epoch=28.0] | Loss=0.01880 | Reg=0.00140 | acc=0.9844 | FP-Norm=1.178 | FP-Norm(final)=2.558 | 3970.4 samples/s | 62.0 steps/s
[Step=14350 Epoch=28.1] | Loss=0.01852 | Reg=0.00142 | acc=0.9688 | FP-Norm=1.186 | FP-Norm(final)=2.559 | 3906.0 samples/s | 61.0 steps/s
[Step=14400 Epoch=28.2] | Loss=0.01833 | Reg=0.00144 | acc=0.9844 | FP-Norm=1.193 | FP-Norm(final)=2.560 | 3887.3 samples/s | 60.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step14400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=52.1] | Loss=0.06402 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.561 | 3807.5 samples/s | 59.5 steps/s
[Step=13650 Epoch=52.3] | Loss=0.00268 | Reg=0.00129 | acc=1.0000 | FP-Norm=1.091 | FP-Norm(final)=2.576 | 3438.8 samples/s | 53.7 steps/s
[Step=13700 Epoch=52.5] | Loss=0.00144 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.118 | FP-Norm(final)=2.582 | 3671.5 samples/s | 57.4 steps/s
[Step=13750 Epoch=52.7] | Loss=0.00102 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.093 | FP-Norm(final)=2.585 | 3690.7 samples/s | 57.7 steps/s
[Step=13800 Epoch=52.9] | Loss=0.00078 | Reg=0.00116 | acc=1.0000 | FP-Norm=1.062 | FP-Norm(final)=2.587 | 3712.8 samples/s | 58.0 steps/s
[Step=13850 Epoch=53.1] | Loss=0.00063 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.027 | FP-Norm(final)=2.589 | 4508.2 samples/s | 70.4 steps/s
[Step=13900 Epoch=53.3] | Loss=0.00053 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.992 | FP-Norm(final)=2.589 | 1678.9 samples/s | 26.2 steps/s
[Step=13950 Epoch=53.5] | Loss=0.00046 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.961 | FP-Norm(final)=2.589 | 3699.5 samples/s | 57.8 steps/s
[Step=14000 Epoch=53.6] | Loss=0.00040 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.932 | FP-Norm(final)=2.589 | 3696.7 samples/s | 57.8 steps/s
[Step=14050 Epoch=53.8] | Loss=0.00036 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.906 | FP-Norm(final)=2.589 | 3699.5 samples/s | 57.8 steps/s
[Step=14100 Epoch=54.0] | Loss=0.00033 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.883 | FP-Norm(final)=2.590 | 4046.6 samples/s | 63.2 steps/s
[Step=14150 Epoch=54.2] | Loss=0.00030 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.861 | FP-Norm(final)=2.590 | 1743.0 samples/s | 27.2 steps/s
[Step=14200 Epoch=54.4] | Loss=0.00028 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.840 | FP-Norm(final)=2.590 | 3690.6 samples/s | 57.7 steps/s
[Step=14250 Epoch=54.6] | Loss=0.00026 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.590 | 3699.3 samples/s | 57.8 steps/s
[Step=14300 Epoch=54.8] | Loss=0.00024 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.802 | FP-Norm(final)=2.590 | 3709.3 samples/s | 58.0 steps/s
[Step=14350 Epoch=55.0] | Loss=0.00023 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.785 | FP-Norm(final)=2.590 | 3710.7 samples/s | 58.0 steps/s
[Step=14400 Epoch=55.2] | Loss=0.00022 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.769 | FP-Norm(final)=2.590 | 1783.0 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step14400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=52.4] | Loss=0.07228 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.561 | 3692.4 samples/s | 57.7 steps/s
[Step=13650 Epoch=52.5] | Loss=0.00424 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.291 | FP-Norm(final)=2.566 | 3624.1 samples/s | 56.6 steps/s
[Step=13700 Epoch=52.7] | Loss=0.00452 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.441 | FP-Norm(final)=2.569 | 3690.9 samples/s | 57.7 steps/s
[Step=13750 Epoch=52.9] | Loss=0.00339 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.542 | FP-Norm(final)=2.569 | 3702.1 samples/s | 57.8 steps/s
[Step=13800 Epoch=53.1] | Loss=0.00298 | Reg=0.00256 | acc=1.0000 | FP-Norm=1.576 | FP-Norm(final)=2.570 | 3744.5 samples/s | 58.5 steps/s
[Step=13850 Epoch=53.3] | Loss=0.00253 | Reg=0.00259 | acc=1.0000 | FP-Norm=1.592 | FP-Norm(final)=2.571 | 4563.9 samples/s | 71.3 steps/s
[Step=13900 Epoch=53.5] | Loss=0.00219 | Reg=0.00258 | acc=1.0000 | FP-Norm=1.592 | FP-Norm(final)=2.572 | 1658.2 samples/s | 25.9 steps/s
[Step=13950 Epoch=53.7] | Loss=0.00189 | Reg=0.00255 | acc=1.0000 | FP-Norm=1.583 | FP-Norm(final)=2.574 | 3778.0 samples/s | 59.0 steps/s
[Step=14000 Epoch=53.9] | Loss=0.00165 | Reg=0.00250 | acc=1.0000 | FP-Norm=1.568 | FP-Norm(final)=2.574 | 3769.6 samples/s | 58.9 steps/s
[Step=14050 Epoch=54.1] | Loss=0.00147 | Reg=0.00243 | acc=1.0000 | FP-Norm=1.548 | FP-Norm(final)=2.575 | 3696.5 samples/s | 57.8 steps/s
[Step=14100 Epoch=54.3] | Loss=0.00133 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.528 | FP-Norm(final)=2.576 | 4124.2 samples/s | 64.4 steps/s
[Step=14150 Epoch=54.5] | Loss=0.00121 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.506 | FP-Norm(final)=2.576 | 1222.7 samples/s | 19.1 steps/s
[Step=14200 Epoch=54.7] | Loss=0.00111 | Reg=0.00224 | acc=1.0000 | FP-Norm=1.484 | FP-Norm(final)=2.576 | 3692.5 samples/s | 57.7 steps/s
[Step=14250 Epoch=54.9] | Loss=0.00103 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.463 | FP-Norm(final)=2.577 | 3471.3 samples/s | 54.2 steps/s
[Step=14300 Epoch=55.0] | Loss=0.00095 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.441 | FP-Norm(final)=2.577 | 3687.8 samples/s | 57.6 steps/s
[Step=14350 Epoch=55.2] | Loss=0.00089 | Reg=0.00207 | acc=1.0000 | FP-Norm=1.420 | FP-Norm(final)=2.577 | 3511.1 samples/s | 54.9 steps/s
[Step=14400 Epoch=55.4] | Loss=0.00084 | Reg=0.00201 | acc=1.0000 | FP-Norm=1.400 | FP-Norm(final)=2.577 | 1762.9 samples/s | 27.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27074 | acc=0.8287 | tpr=0.7546 | fpr=0.0104 | 3822.6 samples/s | 14.9 steps/s
Avg test loss: 0.27462, Avg test acc: 0.82699, Avg tpr: 0.75444, Avg fpr: 0.01346, total FA: 105

Testing server on iccad2012
[Step=  50] | Loss=0.30966 | acc=0.8535 | tpr=0.9602 | fpr=0.1484 | 3795.2 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.30616 | acc=0.8566 | tpr=0.9659 | fpr=0.1454 | 7485.8 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.31328 | acc=0.8533 | tpr=0.9697 | fpr=0.1489 | 7264.8 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.31691 | acc=0.8521 | tpr=0.9672 | fpr=0.1500 | 7223.0 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.31546 | acc=0.8523 | tpr=0.9668 | fpr=0.1498 | 7414.2 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.31638 | acc=0.8526 | tpr=0.9651 | fpr=0.1494 | 7315.4 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.31850 | acc=0.8518 | tpr=0.9656 | fpr=0.1503 | 7405.0 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.31878 | acc=0.8518 | tpr=0.9623 | fpr=0.1502 | 7400.0 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.32070 | acc=0.8513 | tpr=0.9625 | fpr=0.1508 | 7281.6 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.32101 | acc=0.8509 | tpr=0.9634 | fpr=0.1511 | 7310.9 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.32058 | acc=0.8510 | tpr=0.9618 | fpr=0.1510 | 13209.6 samples/s | 51.6 steps/s
Avg test loss: 0.32051, Avg test acc: 0.85102, Avg tpr: 0.96157, Avg fpr: 0.15099, total FA: 20965

server round 18/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=28.1] | Loss=0.07550 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.571 | 3602.5 samples/s | 56.3 steps/s
[Step=14450 Epoch=28.2] | Loss=0.02651 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.868 | FP-Norm(final)=2.564 | 3834.2 samples/s | 59.9 steps/s
[Step=14500 Epoch=28.3] | Loss=0.02199 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.930 | FP-Norm(final)=2.565 | 3997.5 samples/s | 62.5 steps/s
[Step=14550 Epoch=28.4] | Loss=0.02055 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.956 | FP-Norm(final)=2.568 | 4013.9 samples/s | 62.7 steps/s
[Step=14600 Epoch=28.5] | Loss=0.02097 | Reg=0.00098 | acc=0.9844 | FP-Norm=0.977 | FP-Norm(final)=2.569 | 3995.3 samples/s | 62.4 steps/s
[Step=14650 Epoch=28.6] | Loss=0.02114 | Reg=0.00102 | acc=0.9688 | FP-Norm=1.000 | FP-Norm(final)=2.568 | 3981.5 samples/s | 62.2 steps/s
[Step=14700 Epoch=28.7] | Loss=0.02076 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.021 | FP-Norm(final)=2.567 | 3907.8 samples/s | 61.1 steps/s
[Step=14750 Epoch=28.8] | Loss=0.02013 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.038 | FP-Norm(final)=2.567 | 3892.7 samples/s | 60.8 steps/s
[Step=14800 Epoch=28.9] | Loss=0.02058 | Reg=0.00113 | acc=0.9688 | FP-Norm=1.057 | FP-Norm(final)=2.567 | 3917.6 samples/s | 61.2 steps/s
[Step=14850 Epoch=29.0] | Loss=0.02014 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.076 | FP-Norm(final)=2.566 | 3897.1 samples/s | 60.9 steps/s
[Step=14900 Epoch=29.1] | Loss=0.02013 | Reg=0.00121 | acc=0.9688 | FP-Norm=1.091 | FP-Norm(final)=2.566 | 4615.4 samples/s | 72.1 steps/s
[Step=14950 Epoch=29.2] | Loss=0.01965 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.108 | FP-Norm(final)=2.566 | 1665.7 samples/s | 26.0 steps/s
[Step=15000 Epoch=29.3] | Loss=0.01946 | Reg=0.00128 | acc=0.9844 | FP-Norm=1.122 | FP-Norm(final)=2.566 | 3968.4 samples/s | 62.0 steps/s
[Step=15050 Epoch=29.4] | Loss=0.01918 | Reg=0.00131 | acc=0.9844 | FP-Norm=1.135 | FP-Norm(final)=2.565 | 3951.6 samples/s | 61.7 steps/s
[Step=15100 Epoch=29.5] | Loss=0.01889 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.146 | FP-Norm(final)=2.565 | 3992.7 samples/s | 62.4 steps/s
[Step=15150 Epoch=29.5] | Loss=0.01892 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.157 | FP-Norm(final)=2.564 | 4015.4 samples/s | 62.7 steps/s
[Step=15200 Epoch=29.6] | Loss=0.01856 | Reg=0.00138 | acc=0.9844 | FP-Norm=1.165 | FP-Norm(final)=2.563 | 3922.7 samples/s | 61.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step15200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=28.2] | Loss=0.23224 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.571 | 3715.5 samples/s | 58.1 steps/s
[Step=14450 Epoch=28.2] | Loss=0.02760 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.899 | FP-Norm(final)=2.564 | 3829.9 samples/s | 59.8 steps/s
[Step=14500 Epoch=28.3] | Loss=0.02255 | Reg=0.00096 | acc=0.9688 | FP-Norm=0.961 | FP-Norm(final)=2.567 | 3909.9 samples/s | 61.1 steps/s
[Step=14550 Epoch=28.4] | Loss=0.02219 | Reg=0.00099 | acc=0.9844 | FP-Norm=0.981 | FP-Norm(final)=2.569 | 3895.0 samples/s | 60.9 steps/s
[Step=14600 Epoch=28.5] | Loss=0.01971 | Reg=0.00101 | acc=0.9844 | FP-Norm=0.995 | FP-Norm(final)=2.570 | 3896.5 samples/s | 60.9 steps/s
[Step=14650 Epoch=28.6] | Loss=0.02036 | Reg=0.00104 | acc=0.9531 | FP-Norm=1.010 | FP-Norm(final)=2.572 | 3852.0 samples/s | 60.2 steps/s
[Step=14700 Epoch=28.7] | Loss=0.01975 | Reg=0.00108 | acc=0.9844 | FP-Norm=1.031 | FP-Norm(final)=2.572 | 3917.0 samples/s | 61.2 steps/s
[Step=14750 Epoch=28.8] | Loss=0.01999 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.047 | FP-Norm(final)=2.572 | 3884.3 samples/s | 60.7 steps/s
[Step=14800 Epoch=28.9] | Loss=0.01945 | Reg=0.00115 | acc=0.9844 | FP-Norm=1.063 | FP-Norm(final)=2.572 | 3913.4 samples/s | 61.1 steps/s
[Step=14850 Epoch=29.0] | Loss=0.01934 | Reg=0.00118 | acc=0.9844 | FP-Norm=1.078 | FP-Norm(final)=2.573 | 3891.8 samples/s | 60.8 steps/s
[Step=14900 Epoch=29.1] | Loss=0.01945 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.093 | FP-Norm(final)=2.572 | 4671.4 samples/s | 73.0 steps/s
[Step=14950 Epoch=29.2] | Loss=0.01904 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.109 | FP-Norm(final)=2.572 | 1734.6 samples/s | 27.1 steps/s
[Step=15000 Epoch=29.3] | Loss=0.01886 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.123 | FP-Norm(final)=2.572 | 3998.1 samples/s | 62.5 steps/s
[Step=15050 Epoch=29.4] | Loss=0.01844 | Reg=0.00131 | acc=0.9844 | FP-Norm=1.136 | FP-Norm(final)=2.572 | 3989.2 samples/s | 62.3 steps/s
[Step=15100 Epoch=29.5] | Loss=0.01827 | Reg=0.00133 | acc=0.9844 | FP-Norm=1.147 | FP-Norm(final)=2.573 | 4004.1 samples/s | 62.6 steps/s
[Step=15150 Epoch=29.6] | Loss=0.01808 | Reg=0.00136 | acc=0.9844 | FP-Norm=1.158 | FP-Norm(final)=2.573 | 3974.9 samples/s | 62.1 steps/s
[Step=15200 Epoch=29.7] | Loss=0.01778 | Reg=0.00138 | acc=1.0000 | FP-Norm=1.168 | FP-Norm(final)=2.573 | 3999.8 samples/s | 62.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step15200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=55.2] | Loss=0.05222 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.572 | 3588.6 samples/s | 56.1 steps/s
[Step=14450 Epoch=55.4] | Loss=0.00699 | Reg=0.00265 | acc=1.0000 | FP-Norm=1.550 | FP-Norm(final)=2.576 | 3621.7 samples/s | 56.6 steps/s
[Step=14500 Epoch=55.6] | Loss=0.00636 | Reg=0.00346 | acc=1.0000 | FP-Norm=1.809 | FP-Norm(final)=2.570 | 3697.3 samples/s | 57.8 steps/s
[Step=14550 Epoch=55.8] | Loss=0.00479 | Reg=0.00375 | acc=1.0000 | FP-Norm=1.899 | FP-Norm(final)=2.567 | 3710.5 samples/s | 58.0 steps/s
[Step=14600 Epoch=55.9] | Loss=0.00384 | Reg=0.00379 | acc=1.0000 | FP-Norm=1.918 | FP-Norm(final)=2.567 | 3702.7 samples/s | 57.9 steps/s
[Step=14650 Epoch=56.1] | Loss=0.00318 | Reg=0.00378 | acc=1.0000 | FP-Norm=1.921 | FP-Norm(final)=2.568 | 4504.5 samples/s | 70.4 steps/s
[Step=14700 Epoch=56.3] | Loss=0.00288 | Reg=0.00372 | acc=1.0000 | FP-Norm=1.911 | FP-Norm(final)=2.568 | 1667.3 samples/s | 26.1 steps/s
[Step=14750 Epoch=56.5] | Loss=0.00251 | Reg=0.00369 | acc=1.0000 | FP-Norm=1.904 | FP-Norm(final)=2.568 | 3730.9 samples/s | 58.3 steps/s
[Step=14800 Epoch=56.7] | Loss=0.00220 | Reg=0.00363 | acc=1.0000 | FP-Norm=1.889 | FP-Norm(final)=2.569 | 3717.0 samples/s | 58.1 steps/s
[Step=14850 Epoch=56.9] | Loss=0.00196 | Reg=0.00355 | acc=1.0000 | FP-Norm=1.869 | FP-Norm(final)=2.570 | 3687.4 samples/s | 57.6 steps/s
[Step=14900 Epoch=57.1] | Loss=0.00177 | Reg=0.00346 | acc=1.0000 | FP-Norm=1.846 | FP-Norm(final)=2.571 | 4001.7 samples/s | 62.5 steps/s
[Step=14950 Epoch=57.3] | Loss=0.00161 | Reg=0.00337 | acc=1.0000 | FP-Norm=1.822 | FP-Norm(final)=2.572 | 1727.2 samples/s | 27.0 steps/s
[Step=15000 Epoch=57.5] | Loss=0.00148 | Reg=0.00329 | acc=1.0000 | FP-Norm=1.797 | FP-Norm(final)=2.572 | 3758.2 samples/s | 58.7 steps/s
[Step=15050 Epoch=57.7] | Loss=0.00137 | Reg=0.00320 | acc=1.0000 | FP-Norm=1.773 | FP-Norm(final)=2.573 | 3658.4 samples/s | 57.2 steps/s
[Step=15100 Epoch=57.9] | Loss=0.00127 | Reg=0.00312 | acc=1.0000 | FP-Norm=1.748 | FP-Norm(final)=2.574 | 3700.9 samples/s | 57.8 steps/s
[Step=15150 Epoch=58.0] | Loss=0.00119 | Reg=0.00304 | acc=1.0000 | FP-Norm=1.724 | FP-Norm(final)=2.575 | 3678.1 samples/s | 57.5 steps/s
[Step=15200 Epoch=58.2] | Loss=0.00112 | Reg=0.00296 | acc=1.0000 | FP-Norm=1.699 | FP-Norm(final)=2.576 | 1799.7 samples/s | 28.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step15200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=55.4] | Loss=0.07256 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.571 | 3699.6 samples/s | 57.8 steps/s
[Step=14450 Epoch=55.6] | Loss=0.01036 | Reg=0.00198 | acc=0.9688 | FP-Norm=1.336 | FP-Norm(final)=2.573 | 3631.4 samples/s | 56.7 steps/s
[Step=14500 Epoch=55.8] | Loss=0.00646 | Reg=0.00282 | acc=1.0000 | FP-Norm=1.625 | FP-Norm(final)=2.565 | 3799.9 samples/s | 59.4 steps/s
[Step=14550 Epoch=56.0] | Loss=0.00535 | Reg=0.00312 | acc=1.0000 | FP-Norm=1.727 | FP-Norm(final)=2.561 | 3788.5 samples/s | 59.2 steps/s
[Step=14600 Epoch=56.2] | Loss=0.00409 | Reg=0.00320 | acc=1.0000 | FP-Norm=1.759 | FP-Norm(final)=2.560 | 3744.6 samples/s | 58.5 steps/s
[Step=14650 Epoch=56.4] | Loss=0.00334 | Reg=0.00320 | acc=1.0000 | FP-Norm=1.763 | FP-Norm(final)=2.560 | 4500.9 samples/s | 70.3 steps/s
[Step=14700 Epoch=56.6] | Loss=0.00280 | Reg=0.00314 | acc=1.0000 | FP-Norm=1.752 | FP-Norm(final)=2.561 | 1581.3 samples/s | 24.7 steps/s
[Step=14750 Epoch=56.8] | Loss=0.00240 | Reg=0.00307 | acc=1.0000 | FP-Norm=1.733 | FP-Norm(final)=2.562 | 3507.7 samples/s | 54.8 steps/s
[Step=14800 Epoch=57.0] | Loss=0.00211 | Reg=0.00299 | acc=1.0000 | FP-Norm=1.712 | FP-Norm(final)=2.563 | 3583.4 samples/s | 56.0 steps/s
[Step=14850 Epoch=57.2] | Loss=0.00188 | Reg=0.00291 | acc=1.0000 | FP-Norm=1.689 | FP-Norm(final)=2.564 | 3282.7 samples/s | 51.3 steps/s
[Step=14900 Epoch=57.4] | Loss=0.00169 | Reg=0.00283 | acc=1.0000 | FP-Norm=1.666 | FP-Norm(final)=2.565 | 3660.3 samples/s | 57.2 steps/s
[Step=14950 Epoch=57.5] | Loss=0.00154 | Reg=0.00275 | acc=1.0000 | FP-Norm=1.642 | FP-Norm(final)=2.566 | 1558.6 samples/s | 24.4 steps/s
[Step=15000 Epoch=57.7] | Loss=0.00142 | Reg=0.00268 | acc=1.0000 | FP-Norm=1.620 | FP-Norm(final)=2.567 | 3483.6 samples/s | 54.4 steps/s
[Step=15050 Epoch=57.9] | Loss=0.00131 | Reg=0.00261 | acc=1.0000 | FP-Norm=1.597 | FP-Norm(final)=2.568 | 3409.1 samples/s | 53.3 steps/s
[Step=15100 Epoch=58.1] | Loss=0.00122 | Reg=0.00254 | acc=1.0000 | FP-Norm=1.576 | FP-Norm(final)=2.569 | 3528.6 samples/s | 55.1 steps/s
[Step=15150 Epoch=58.3] | Loss=0.00114 | Reg=0.00248 | acc=1.0000 | FP-Norm=1.554 | FP-Norm(final)=2.570 | 3832.6 samples/s | 59.9 steps/s
[Step=15200 Epoch=58.5] | Loss=0.00107 | Reg=0.00242 | acc=1.0000 | FP-Norm=1.534 | FP-Norm(final)=2.570 | 1787.5 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29689 | acc=0.8185 | tpr=0.7401 | fpr=0.0111 | 3894.0 samples/s | 15.2 steps/s
Avg test loss: 0.30074, Avg test acc: 0.81665, Avg tpr: 0.73929, Avg fpr: 0.01320, total FA: 103

Testing server on iccad2012
[Step=  50] | Loss=0.30948 | acc=0.8593 | tpr=0.9690 | fpr=0.1427 | 3824.8 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.30691 | acc=0.8618 | tpr=0.9765 | fpr=0.1404 | 7253.4 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.31465 | acc=0.8600 | tpr=0.9769 | fpr=0.1421 | 7337.7 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.31871 | acc=0.8587 | tpr=0.9770 | fpr=0.1434 | 7426.1 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.31635 | acc=0.8592 | tpr=0.9747 | fpr=0.1429 | 7480.3 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.31710 | acc=0.8593 | tpr=0.9731 | fpr=0.1427 | 7307.3 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.31914 | acc=0.8587 | tpr=0.9731 | fpr=0.1434 | 7105.3 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.31946 | acc=0.8583 | tpr=0.9699 | fpr=0.1438 | 7451.2 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.32145 | acc=0.8578 | tpr=0.9688 | fpr=0.1442 | 7250.1 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.32172 | acc=0.8576 | tpr=0.9700 | fpr=0.1444 | 7127.6 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.32113 | acc=0.8577 | tpr=0.9686 | fpr=0.1443 | 13184.0 samples/s | 51.5 steps/s
Avg test loss: 0.32107, Avg test acc: 0.85765, Avg tpr: 0.96830, Avg fpr: 0.14437, total FA: 20045

server round 19/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=29.6] | Loss=0.25674 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.575 | 3471.0 samples/s | 54.2 steps/s
[Step=15250 Epoch=29.7] | Loss=0.02934 | Reg=0.00101 | acc=0.9844 | FP-Norm=0.968 | FP-Norm(final)=2.564 | 3996.0 samples/s | 62.4 steps/s
[Step=15300 Epoch=29.8] | Loss=0.02331 | Reg=0.00108 | acc=0.9375 | FP-Norm=1.021 | FP-Norm(final)=2.565 | 3991.4 samples/s | 62.4 steps/s
[Step=15350 Epoch=29.9] | Loss=0.02151 | Reg=0.00110 | acc=0.9688 | FP-Norm=1.036 | FP-Norm(final)=2.566 | 4007.8 samples/s | 62.6 steps/s
[Step=15400 Epoch=30.0] | Loss=0.02120 | Reg=0.00112 | acc=0.9844 | FP-Norm=1.050 | FP-Norm(final)=2.565 | 3982.5 samples/s | 62.2 steps/s
[Step=15450 Epoch=30.1] | Loss=0.02051 | Reg=0.00116 | acc=0.9844 | FP-Norm=1.067 | FP-Norm(final)=2.565 | 3994.2 samples/s | 62.4 steps/s
[Step=15500 Epoch=30.2] | Loss=0.02064 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.091 | FP-Norm(final)=2.564 | 3907.6 samples/s | 61.1 steps/s
[Step=15550 Epoch=30.3] | Loss=0.02042 | Reg=0.00125 | acc=0.9844 | FP-Norm=1.109 | FP-Norm(final)=2.563 | 3877.1 samples/s | 60.6 steps/s
[Step=15600 Epoch=30.4] | Loss=0.02061 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.123 | FP-Norm(final)=2.563 | 3932.6 samples/s | 61.4 steps/s
[Step=15650 Epoch=30.5] | Loss=0.02060 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.140 | FP-Norm(final)=2.562 | 3865.0 samples/s | 60.4 steps/s
[Step=15700 Epoch=30.6] | Loss=0.02052 | Reg=0.00135 | acc=1.0000 | FP-Norm=1.154 | FP-Norm(final)=2.561 | 4591.6 samples/s | 71.7 steps/s
[Step=15750 Epoch=30.7] | Loss=0.02024 | Reg=0.00138 | acc=1.0000 | FP-Norm=1.166 | FP-Norm(final)=2.561 | 1678.0 samples/s | 26.2 steps/s
[Step=15800 Epoch=30.8] | Loss=0.01952 | Reg=0.00140 | acc=0.9844 | FP-Norm=1.174 | FP-Norm(final)=2.561 | 3982.9 samples/s | 62.2 steps/s
[Step=15850 Epoch=30.9] | Loss=0.01891 | Reg=0.00141 | acc=0.9844 | FP-Norm=1.182 | FP-Norm(final)=2.562 | 3998.7 samples/s | 62.5 steps/s
[Step=15900 Epoch=31.0] | Loss=0.01857 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.188 | FP-Norm(final)=2.564 | 4034.1 samples/s | 63.0 steps/s
[Step=15950 Epoch=31.1] | Loss=0.01843 | Reg=0.00144 | acc=0.9844 | FP-Norm=1.196 | FP-Norm(final)=2.565 | 4008.8 samples/s | 62.6 steps/s
[Step=16000 Epoch=31.2] | Loss=0.01813 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.202 | FP-Norm(final)=2.566 | 3940.0 samples/s | 61.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=29.7] | Loss=0.20351 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.575 | 3756.3 samples/s | 58.7 steps/s
[Step=15250 Epoch=29.8] | Loss=0.02906 | Reg=0.00109 | acc=0.9844 | FP-Norm=1.002 | FP-Norm(final)=2.564 | 3744.1 samples/s | 58.5 steps/s
[Step=15300 Epoch=29.9] | Loss=0.02458 | Reg=0.00117 | acc=0.9844 | FP-Norm=1.059 | FP-Norm(final)=2.564 | 3877.2 samples/s | 60.6 steps/s
[Step=15350 Epoch=30.0] | Loss=0.02353 | Reg=0.00122 | acc=0.9688 | FP-Norm=1.090 | FP-Norm(final)=2.564 | 3959.0 samples/s | 61.9 steps/s
[Step=15400 Epoch=30.1] | Loss=0.02174 | Reg=0.00125 | acc=0.9844 | FP-Norm=1.108 | FP-Norm(final)=2.563 | 4005.7 samples/s | 62.6 steps/s
[Step=15450 Epoch=30.2] | Loss=0.02162 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.120 | FP-Norm(final)=2.564 | 3993.3 samples/s | 62.4 steps/s
[Step=15500 Epoch=30.3] | Loss=0.02154 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.132 | FP-Norm(final)=2.564 | 4007.8 samples/s | 62.6 steps/s
[Step=15550 Epoch=30.4] | Loss=0.02071 | Reg=0.00132 | acc=0.9844 | FP-Norm=1.142 | FP-Norm(final)=2.564 | 3905.7 samples/s | 61.0 steps/s
[Step=15600 Epoch=30.5] | Loss=0.02050 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.150 | FP-Norm(final)=2.565 | 3907.5 samples/s | 61.1 steps/s
[Step=15650 Epoch=30.6] | Loss=0.02041 | Reg=0.00136 | acc=0.9688 | FP-Norm=1.160 | FP-Norm(final)=2.566 | 3930.8 samples/s | 61.4 steps/s
[Step=15700 Epoch=30.7] | Loss=0.01994 | Reg=0.00138 | acc=0.9844 | FP-Norm=1.169 | FP-Norm(final)=2.566 | 4637.1 samples/s | 72.5 steps/s
[Step=15750 Epoch=30.8] | Loss=0.01933 | Reg=0.00139 | acc=0.9844 | FP-Norm=1.175 | FP-Norm(final)=2.568 | 1708.3 samples/s | 26.7 steps/s
[Step=15800 Epoch=30.9] | Loss=0.01903 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.181 | FP-Norm(final)=2.570 | 3853.5 samples/s | 60.2 steps/s
[Step=15850 Epoch=31.0] | Loss=0.01856 | Reg=0.00142 | acc=0.9844 | FP-Norm=1.186 | FP-Norm(final)=2.571 | 3904.8 samples/s | 61.0 steps/s
[Step=15900 Epoch=31.1] | Loss=0.01816 | Reg=0.00143 | acc=0.9688 | FP-Norm=1.193 | FP-Norm(final)=2.573 | 3912.6 samples/s | 61.1 steps/s
[Step=15950 Epoch=31.2] | Loss=0.01786 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.199 | FP-Norm(final)=2.574 | 3889.8 samples/s | 60.8 steps/s
[Step=16000 Epoch=31.3] | Loss=0.01761 | Reg=0.00146 | acc=0.9844 | FP-Norm=1.205 | FP-Norm(final)=2.576 | 3904.7 samples/s | 61.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step16000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=58.2] | Loss=0.03453 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.576 | 3756.5 samples/s | 58.7 steps/s
[Step=15250 Epoch=58.4] | Loss=0.00512 | Reg=0.00201 | acc=0.9844 | FP-Norm=1.346 | FP-Norm(final)=2.576 | 3533.8 samples/s | 55.2 steps/s
[Step=15300 Epoch=58.6] | Loss=0.00415 | Reg=0.00254 | acc=1.0000 | FP-Norm=1.548 | FP-Norm(final)=2.575 | 3688.7 samples/s | 57.6 steps/s
[Step=15350 Epoch=58.8] | Loss=0.00333 | Reg=0.00273 | acc=1.0000 | FP-Norm=1.620 | FP-Norm(final)=2.573 | 3693.7 samples/s | 57.7 steps/s
[Step=15400 Epoch=59.0] | Loss=0.00272 | Reg=0.00275 | acc=1.0000 | FP-Norm=1.633 | FP-Norm(final)=2.574 | 3710.0 samples/s | 58.0 steps/s
[Step=15450 Epoch=59.2] | Loss=0.00221 | Reg=0.00271 | acc=1.0000 | FP-Norm=1.626 | FP-Norm(final)=2.574 | 4497.9 samples/s | 70.3 steps/s
[Step=15500 Epoch=59.4] | Loss=0.00186 | Reg=0.00264 | acc=1.0000 | FP-Norm=1.609 | FP-Norm(final)=2.575 | 1666.1 samples/s | 26.0 steps/s
[Step=15550 Epoch=59.6] | Loss=0.00160 | Reg=0.00257 | acc=1.0000 | FP-Norm=1.587 | FP-Norm(final)=2.575 | 3731.7 samples/s | 58.3 steps/s
[Step=15600 Epoch=59.8] | Loss=0.00141 | Reg=0.00249 | acc=1.0000 | FP-Norm=1.562 | FP-Norm(final)=2.576 | 3706.0 samples/s | 57.9 steps/s
[Step=15650 Epoch=60.0] | Loss=0.00125 | Reg=0.00241 | acc=1.0000 | FP-Norm=1.537 | FP-Norm(final)=2.577 | 3688.2 samples/s | 57.6 steps/s
[Step=15700 Epoch=60.2] | Loss=0.00113 | Reg=0.00233 | acc=1.0000 | FP-Norm=1.512 | FP-Norm(final)=2.578 | 4046.0 samples/s | 63.2 steps/s
[Step=15750 Epoch=60.3] | Loss=0.00103 | Reg=0.00226 | acc=1.0000 | FP-Norm=1.487 | FP-Norm(final)=2.579 | 1701.5 samples/s | 26.6 steps/s
[Step=15800 Epoch=60.5] | Loss=0.00094 | Reg=0.00219 | acc=1.0000 | FP-Norm=1.463 | FP-Norm(final)=2.579 | 3710.7 samples/s | 58.0 steps/s
[Step=15850 Epoch=60.7] | Loss=0.00087 | Reg=0.00213 | acc=1.0000 | FP-Norm=1.440 | FP-Norm(final)=2.580 | 3720.5 samples/s | 58.1 steps/s
[Step=15900 Epoch=60.9] | Loss=0.00081 | Reg=0.00207 | acc=1.0000 | FP-Norm=1.417 | FP-Norm(final)=2.581 | 3708.6 samples/s | 57.9 steps/s
[Step=15950 Epoch=61.1] | Loss=0.00076 | Reg=0.00201 | acc=1.0000 | FP-Norm=1.395 | FP-Norm(final)=2.581 | 3693.9 samples/s | 57.7 steps/s
[Step=16000 Epoch=61.3] | Loss=0.00072 | Reg=0.00195 | acc=1.0000 | FP-Norm=1.375 | FP-Norm(final)=2.582 | 1789.3 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step16000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=58.5] | Loss=0.11042 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.574 | 3624.7 samples/s | 56.6 steps/s
[Step=15250 Epoch=58.7] | Loss=0.00401 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.165 | FP-Norm(final)=2.575 | 3535.1 samples/s | 55.2 steps/s
[Step=15300 Epoch=58.9] | Loss=0.00205 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.184 | FP-Norm(final)=2.578 | 3684.2 samples/s | 57.6 steps/s
[Step=15350 Epoch=59.1] | Loss=0.00140 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.141 | FP-Norm(final)=2.580 | 3716.2 samples/s | 58.1 steps/s
[Step=15400 Epoch=59.3] | Loss=0.00106 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.096 | FP-Norm(final)=2.582 | 3727.3 samples/s | 58.2 steps/s
[Step=15450 Epoch=59.5] | Loss=0.00086 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.056 | FP-Norm(final)=2.583 | 4627.8 samples/s | 72.3 steps/s
[Step=15500 Epoch=59.7] | Loss=0.00072 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.019 | FP-Norm(final)=2.584 | 1630.2 samples/s | 25.5 steps/s
[Step=15550 Epoch=59.9] | Loss=0.00063 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.986 | FP-Norm(final)=2.585 | 3731.1 samples/s | 58.3 steps/s
[Step=15600 Epoch=60.1] | Loss=0.00055 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.956 | FP-Norm(final)=2.586 | 3687.6 samples/s | 57.6 steps/s
[Step=15650 Epoch=60.2] | Loss=0.00049 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.929 | FP-Norm(final)=2.587 | 3703.6 samples/s | 57.9 steps/s
[Step=15700 Epoch=60.4] | Loss=0.00045 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.904 | FP-Norm(final)=2.588 | 4091.2 samples/s | 63.9 steps/s
[Step=15750 Epoch=60.6] | Loss=0.00041 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.882 | FP-Norm(final)=2.588 | 1706.6 samples/s | 26.7 steps/s
[Step=15800 Epoch=60.8] | Loss=0.00038 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.861 | FP-Norm(final)=2.589 | 3829.7 samples/s | 59.8 steps/s
[Step=15850 Epoch=61.0] | Loss=0.00035 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.841 | FP-Norm(final)=2.589 | 3823.7 samples/s | 59.7 steps/s
[Step=15900 Epoch=61.2] | Loss=0.00033 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.822 | FP-Norm(final)=2.590 | 3779.5 samples/s | 59.1 steps/s
[Step=15950 Epoch=61.4] | Loss=0.00031 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.805 | FP-Norm(final)=2.590 | 3860.5 samples/s | 60.3 steps/s
[Step=16000 Epoch=61.6] | Loss=0.00029 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.789 | FP-Norm(final)=2.591 | 1805.3 samples/s | 28.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27728 | acc=0.8298 | tpr=0.7562 | fpr=0.0104 | 3834.3 samples/s | 15.0 steps/s
Avg test loss: 0.28128, Avg test acc: 0.82915, Avg tpr: 0.75736, Avg fpr: 0.01295, total FA: 101

Testing server on iccad2012
[Step=  50] | Loss=0.32143 | acc=0.8546 | tpr=0.9602 | fpr=0.1473 | 3829.7 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.31899 | acc=0.8583 | tpr=0.9680 | fpr=0.1437 | 7569.1 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.32694 | acc=0.8556 | tpr=0.9683 | fpr=0.1465 | 7219.9 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.33103 | acc=0.8549 | tpr=0.9705 | fpr=0.1472 | 7299.8 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.32858 | acc=0.8552 | tpr=0.9703 | fpr=0.1469 | 7757.6 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.32925 | acc=0.8556 | tpr=0.9687 | fpr=0.1465 | 7319.6 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.33209 | acc=0.8550 | tpr=0.9693 | fpr=0.1471 | 6911.7 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.33258 | acc=0.8547 | tpr=0.9666 | fpr=0.1473 | 7443.3 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.33451 | acc=0.8546 | tpr=0.9669 | fpr=0.1475 | 7121.3 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.33468 | acc=0.8545 | tpr=0.9678 | fpr=0.1475 | 7096.9 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.33409 | acc=0.8548 | tpr=0.9666 | fpr=0.1473 | 13659.5 samples/s | 53.4 steps/s
Avg test loss: 0.33401, Avg test acc: 0.85474, Avg tpr: 0.96632, Avg fpr: 0.14728, total FA: 20450

server round 20/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=31.2] | Loss=0.17759 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.591 | 3382.1 samples/s | 52.8 steps/s
[Step=16050 Epoch=31.3] | Loss=0.02501 | Reg=0.00039 | acc=0.9844 | FP-Norm=0.596 | FP-Norm(final)=2.587 | 3854.6 samples/s | 60.2 steps/s
[Step=16100 Epoch=31.4] | Loss=0.01964 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.588 | 3897.5 samples/s | 60.9 steps/s
[Step=16150 Epoch=31.5] | Loss=0.01705 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.630 | FP-Norm(final)=2.589 | 3853.1 samples/s | 60.2 steps/s
[Step=16200 Epoch=31.6] | Loss=0.01564 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.633 | FP-Norm(final)=2.591 | 3908.0 samples/s | 61.1 steps/s
[Step=16250 Epoch=31.7] | Loss=0.01531 | Reg=0.00041 | acc=0.9844 | FP-Norm=0.637 | FP-Norm(final)=2.593 | 3931.5 samples/s | 61.4 steps/s
[Step=16300 Epoch=31.8] | Loss=0.01526 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.642 | FP-Norm(final)=2.594 | 3892.1 samples/s | 60.8 steps/s
[Step=16350 Epoch=31.9] | Loss=0.01502 | Reg=0.00043 | acc=0.9844 | FP-Norm=0.648 | FP-Norm(final)=2.594 | 3902.4 samples/s | 61.0 steps/s
[Step=16400 Epoch=32.0] | Loss=0.01469 | Reg=0.00043 | acc=0.9844 | FP-Norm=0.654 | FP-Norm(final)=2.595 | 3919.7 samples/s | 61.2 steps/s
[Step=16450 Epoch=32.1] | Loss=0.01423 | Reg=0.00044 | acc=0.9844 | FP-Norm=0.658 | FP-Norm(final)=2.596 | 3910.0 samples/s | 61.1 steps/s
[Step=16500 Epoch=32.2] | Loss=0.01381 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.662 | FP-Norm(final)=2.597 | 4591.3 samples/s | 71.7 steps/s
[Step=16550 Epoch=32.3] | Loss=0.01337 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.668 | FP-Norm(final)=2.598 | 1654.6 samples/s | 25.9 steps/s
[Step=16600 Epoch=32.4] | Loss=0.01277 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.672 | FP-Norm(final)=2.600 | 3851.4 samples/s | 60.2 steps/s
[Step=16650 Epoch=32.5] | Loss=0.01261 | Reg=0.00046 | acc=0.9844 | FP-Norm=0.676 | FP-Norm(final)=2.601 | 3898.7 samples/s | 60.9 steps/s
[Step=16700 Epoch=32.6] | Loss=0.01212 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.681 | FP-Norm(final)=2.603 | 3889.6 samples/s | 60.8 steps/s
[Step=16750 Epoch=32.7] | Loss=0.01214 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.685 | FP-Norm(final)=2.605 | 3882.1 samples/s | 60.7 steps/s
[Step=16800 Epoch=32.8] | Loss=0.01196 | Reg=0.00048 | acc=0.9688 | FP-Norm=0.688 | FP-Norm(final)=2.606 | 3914.2 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step16800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=31.3] | Loss=0.11720 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.591 | 3675.2 samples/s | 57.4 steps/s
[Step=16050 Epoch=31.4] | Loss=0.02700 | Reg=0.00045 | acc=0.9844 | FP-Norm=0.640 | FP-Norm(final)=2.586 | 3913.4 samples/s | 61.1 steps/s
[Step=16100 Epoch=31.5] | Loss=0.01897 | Reg=0.00047 | acc=0.9688 | FP-Norm=0.671 | FP-Norm(final)=2.588 | 3880.6 samples/s | 60.6 steps/s
[Step=16150 Epoch=31.6] | Loss=0.01651 | Reg=0.00046 | acc=0.9844 | FP-Norm=0.669 | FP-Norm(final)=2.591 | 3912.3 samples/s | 61.1 steps/s
[Step=16200 Epoch=31.7] | Loss=0.01586 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.665 | FP-Norm(final)=2.593 | 3890.2 samples/s | 60.8 steps/s
[Step=16250 Epoch=31.8] | Loss=0.01457 | Reg=0.00045 | acc=0.9844 | FP-Norm=0.666 | FP-Norm(final)=2.595 | 3907.8 samples/s | 61.1 steps/s
[Step=16300 Epoch=31.9] | Loss=0.01418 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.667 | FP-Norm(final)=2.597 | 3899.5 samples/s | 60.9 steps/s
[Step=16350 Epoch=32.0] | Loss=0.01377 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.669 | FP-Norm(final)=2.599 | 3894.8 samples/s | 60.9 steps/s
[Step=16400 Epoch=32.1] | Loss=0.01362 | Reg=0.00046 | acc=0.9844 | FP-Norm=0.672 | FP-Norm(final)=2.600 | 3882.7 samples/s | 60.7 steps/s
[Step=16450 Epoch=32.2] | Loss=0.01322 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.675 | FP-Norm(final)=2.602 | 3900.3 samples/s | 60.9 steps/s
[Step=16500 Epoch=32.3] | Loss=0.01358 | Reg=0.00047 | acc=0.9688 | FP-Norm=0.679 | FP-Norm(final)=2.603 | 4683.9 samples/s | 73.2 steps/s
[Step=16550 Epoch=32.4] | Loss=0.01313 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.683 | FP-Norm(final)=2.603 | 1698.6 samples/s | 26.5 steps/s
[Step=16600 Epoch=32.5] | Loss=0.01271 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.605 | 3979.9 samples/s | 62.2 steps/s
[Step=16650 Epoch=32.6] | Loss=0.01246 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.690 | FP-Norm(final)=2.606 | 3977.3 samples/s | 62.1 steps/s
[Step=16700 Epoch=32.6] | Loss=0.01206 | Reg=0.00048 | acc=0.9844 | FP-Norm=0.692 | FP-Norm(final)=2.607 | 3937.5 samples/s | 61.5 steps/s
[Step=16750 Epoch=32.7] | Loss=0.01192 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.696 | FP-Norm(final)=2.609 | 3901.2 samples/s | 61.0 steps/s
[Step=16800 Epoch=32.8] | Loss=0.01166 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.699 | FP-Norm(final)=2.610 | 3937.0 samples/s | 61.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step16800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=61.3] | Loss=0.08258 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.591 | 3580.6 samples/s | 55.9 steps/s
[Step=16050 Epoch=61.5] | Loss=0.00540 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.590 | 3642.0 samples/s | 56.9 steps/s
[Step=16100 Epoch=61.7] | Loss=0.00276 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.853 | FP-Norm(final)=2.592 | 3684.8 samples/s | 57.6 steps/s
[Step=16150 Epoch=61.9] | Loss=0.00191 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.841 | FP-Norm(final)=2.594 | 3684.5 samples/s | 57.6 steps/s
[Step=16200 Epoch=62.1] | Loss=0.00145 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.823 | FP-Norm(final)=2.595 | 3726.7 samples/s | 58.2 steps/s
[Step=16250 Epoch=62.3] | Loss=0.00118 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.803 | FP-Norm(final)=2.596 | 4523.0 samples/s | 70.7 steps/s
[Step=16300 Epoch=62.5] | Loss=0.00099 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.784 | FP-Norm(final)=2.598 | 1640.4 samples/s | 25.6 steps/s
[Step=16350 Epoch=62.6] | Loss=0.00085 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.767 | FP-Norm(final)=2.598 | 3673.3 samples/s | 57.4 steps/s
[Step=16400 Epoch=62.8] | Loss=0.00075 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.751 | FP-Norm(final)=2.599 | 3754.4 samples/s | 58.7 steps/s
[Step=16450 Epoch=63.0] | Loss=0.00067 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.736 | FP-Norm(final)=2.600 | 3754.1 samples/s | 58.7 steps/s
[Step=16500 Epoch=63.2] | Loss=0.00061 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.721 | FP-Norm(final)=2.601 | 4136.8 samples/s | 64.6 steps/s
[Step=16550 Epoch=63.4] | Loss=0.00056 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.708 | FP-Norm(final)=2.601 | 1723.3 samples/s | 26.9 steps/s
[Step=16600 Epoch=63.6] | Loss=0.00051 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.696 | FP-Norm(final)=2.602 | 3882.9 samples/s | 60.7 steps/s
[Step=16650 Epoch=63.8] | Loss=0.00048 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.684 | FP-Norm(final)=2.602 | 3777.4 samples/s | 59.0 steps/s
[Step=16700 Epoch=64.0] | Loss=0.00045 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.673 | FP-Norm(final)=2.603 | 3706.6 samples/s | 57.9 steps/s
[Step=16750 Epoch=64.2] | Loss=0.00042 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.663 | FP-Norm(final)=2.603 | 3718.8 samples/s | 58.1 steps/s
[Step=16800 Epoch=64.4] | Loss=0.00040 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.654 | FP-Norm(final)=2.604 | 1804.5 samples/s | 28.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step16800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=61.6] | Loss=0.12697 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.591 | 3545.9 samples/s | 55.4 steps/s
[Step=16050 Epoch=61.8] | Loss=0.00722 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.902 | FP-Norm(final)=2.589 | 3776.5 samples/s | 59.0 steps/s
[Step=16100 Epoch=62.0] | Loss=0.00374 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.949 | FP-Norm(final)=2.591 | 3790.0 samples/s | 59.2 steps/s
[Step=16150 Epoch=62.2] | Loss=0.00254 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.939 | FP-Norm(final)=2.592 | 3787.4 samples/s | 59.2 steps/s
[Step=16200 Epoch=62.4] | Loss=0.00197 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.923 | FP-Norm(final)=2.594 | 3782.0 samples/s | 59.1 steps/s
[Step=16250 Epoch=62.6] | Loss=0.00159 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.907 | FP-Norm(final)=2.595 | 4677.4 samples/s | 73.1 steps/s
[Step=16300 Epoch=62.7] | Loss=0.00133 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.889 | FP-Norm(final)=2.596 | 1647.7 samples/s | 25.7 steps/s
[Step=16350 Epoch=62.9] | Loss=0.00115 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.596 | 3819.3 samples/s | 59.7 steps/s
[Step=16400 Epoch=63.1] | Loss=0.00101 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.855 | FP-Norm(final)=2.597 | 3761.3 samples/s | 58.8 steps/s
[Step=16450 Epoch=63.3] | Loss=0.00090 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.839 | FP-Norm(final)=2.598 | 3802.8 samples/s | 59.4 steps/s
[Step=16500 Epoch=63.5] | Loss=0.00082 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.825 | FP-Norm(final)=2.598 | 4204.5 samples/s | 65.7 steps/s
[Step=16550 Epoch=63.7] | Loss=0.00074 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.811 | FP-Norm(final)=2.599 | 1710.5 samples/s | 26.7 steps/s
[Step=16600 Epoch=63.9] | Loss=0.00069 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.599 | 3741.0 samples/s | 58.5 steps/s
[Step=16650 Epoch=64.1] | Loss=0.00063 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.600 | 3665.3 samples/s | 57.3 steps/s
[Step=16700 Epoch=64.3] | Loss=0.00059 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.600 | 3695.7 samples/s | 57.7 steps/s
[Step=16750 Epoch=64.5] | Loss=0.00055 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.763 | FP-Norm(final)=2.600 | 3784.2 samples/s | 59.1 steps/s
[Step=16800 Epoch=64.7] | Loss=0.00052 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.753 | FP-Norm(final)=2.601 | 1806.1 samples/s | 28.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29556 | acc=0.8241 | tpr=0.7483 | fpr=0.0114 | 3882.1 samples/s | 15.2 steps/s
Avg test loss: 0.30014, Avg test acc: 0.82362, Avg tpr: 0.74996, Avg fpr: 0.01436, total FA: 112

Testing server on iccad2012
[Step=  50] | Loss=0.31529 | acc=0.8719 | tpr=0.9602 | fpr=0.1297 | 3891.2 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.31386 | acc=0.8754 | tpr=0.9680 | fpr=0.1263 | 7310.9 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.32199 | acc=0.8730 | tpr=0.9697 | fpr=0.1288 | 7554.1 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.32690 | acc=0.8722 | tpr=0.9716 | fpr=0.1296 | 6959.6 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.32417 | acc=0.8718 | tpr=0.9721 | fpr=0.1301 | 7428.0 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.32547 | acc=0.8720 | tpr=0.9687 | fpr=0.1298 | 7362.4 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.32834 | acc=0.8715 | tpr=0.9699 | fpr=0.1303 | 7503.4 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.32887 | acc=0.8713 | tpr=0.9666 | fpr=0.1304 | 7577.1 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.33095 | acc=0.8711 | tpr=0.9669 | fpr=0.1306 | 7123.5 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.33103 | acc=0.8708 | tpr=0.9678 | fpr=0.1309 | 7090.7 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.33034 | acc=0.8711 | tpr=0.9666 | fpr=0.1307 | 13676.0 samples/s | 53.4 steps/s
Avg test loss: 0.33017, Avg test acc: 0.87108, Avg tpr: 0.96632, Avg fpr: 0.13065, total FA: 18141

server round 21/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=32.8] | Loss=0.17237 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.618 | 3384.4 samples/s | 52.9 steps/s
[Step=16850 Epoch=32.9] | Loss=0.03126 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.719 | FP-Norm(final)=2.610 | 3955.1 samples/s | 61.8 steps/s
[Step=16900 Epoch=33.0] | Loss=0.02183 | Reg=0.00058 | acc=0.9688 | FP-Norm=0.743 | FP-Norm(final)=2.610 | 4007.9 samples/s | 62.6 steps/s
[Step=16950 Epoch=33.1] | Loss=0.01869 | Reg=0.00057 | acc=0.9688 | FP-Norm=0.741 | FP-Norm(final)=2.612 | 3893.7 samples/s | 60.8 steps/s
[Step=17000 Epoch=33.2] | Loss=0.01754 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.742 | FP-Norm(final)=2.612 | 3865.5 samples/s | 60.4 steps/s
[Step=17050 Epoch=33.3] | Loss=0.01582 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.737 | FP-Norm(final)=2.613 | 3909.4 samples/s | 61.1 steps/s
[Step=17100 Epoch=33.4] | Loss=0.01498 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.731 | FP-Norm(final)=2.615 | 3899.8 samples/s | 60.9 steps/s
[Step=17150 Epoch=33.4] | Loss=0.01439 | Reg=0.00054 | acc=0.9688 | FP-Norm=0.728 | FP-Norm(final)=2.617 | 3895.2 samples/s | 60.9 steps/s
[Step=17200 Epoch=33.5] | Loss=0.01393 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.730 | FP-Norm(final)=2.619 | 3921.6 samples/s | 61.3 steps/s
[Step=17250 Epoch=33.6] | Loss=0.01379 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.731 | FP-Norm(final)=2.620 | 3898.6 samples/s | 60.9 steps/s
[Step=17300 Epoch=33.7] | Loss=0.01336 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.731 | FP-Norm(final)=2.622 | 4604.3 samples/s | 71.9 steps/s
[Step=17350 Epoch=33.8] | Loss=0.01299 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.733 | FP-Norm(final)=2.624 | 1657.1 samples/s | 25.9 steps/s
[Step=17400 Epoch=33.9] | Loss=0.01269 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.735 | FP-Norm(final)=2.625 | 3983.1 samples/s | 62.2 steps/s
[Step=17450 Epoch=34.0] | Loss=0.01234 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.736 | FP-Norm(final)=2.626 | 4014.8 samples/s | 62.7 steps/s
[Step=17500 Epoch=34.1] | Loss=0.01215 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.738 | FP-Norm(final)=2.628 | 3981.5 samples/s | 62.2 steps/s
[Step=17550 Epoch=34.2] | Loss=0.01194 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.739 | FP-Norm(final)=2.629 | 4000.1 samples/s | 62.5 steps/s
[Step=17600 Epoch=34.3] | Loss=0.01180 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.741 | FP-Norm(final)=2.630 | 4032.7 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step17600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=32.8] | Loss=0.20232 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.618 | 3884.9 samples/s | 60.7 steps/s
[Step=16850 Epoch=32.9] | Loss=0.02990 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.701 | FP-Norm(final)=2.610 | 3690.1 samples/s | 57.7 steps/s
[Step=16900 Epoch=33.0] | Loss=0.02099 | Reg=0.00057 | acc=0.9688 | FP-Norm=0.736 | FP-Norm(final)=2.610 | 3919.0 samples/s | 61.2 steps/s
[Step=16950 Epoch=33.1] | Loss=0.01726 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.737 | FP-Norm(final)=2.612 | 3878.3 samples/s | 60.6 steps/s
[Step=17000 Epoch=33.2] | Loss=0.01523 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.732 | FP-Norm(final)=2.615 | 3907.9 samples/s | 61.1 steps/s
[Step=17050 Epoch=33.3] | Loss=0.01460 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.731 | FP-Norm(final)=2.617 | 3915.0 samples/s | 61.2 steps/s
[Step=17100 Epoch=33.4] | Loss=0.01381 | Reg=0.00054 | acc=0.9688 | FP-Norm=0.730 | FP-Norm(final)=2.620 | 3893.1 samples/s | 60.8 steps/s
[Step=17150 Epoch=33.5] | Loss=0.01348 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.731 | FP-Norm(final)=2.621 | 3899.2 samples/s | 60.9 steps/s
[Step=17200 Epoch=33.6] | Loss=0.01309 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.728 | FP-Norm(final)=2.623 | 3981.8 samples/s | 62.2 steps/s
[Step=17250 Epoch=33.7] | Loss=0.01296 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.728 | FP-Norm(final)=2.624 | 4033.7 samples/s | 63.0 steps/s
[Step=17300 Epoch=33.8] | Loss=0.01310 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.728 | FP-Norm(final)=2.626 | 4742.7 samples/s | 74.1 steps/s
[Step=17350 Epoch=33.9] | Loss=0.01254 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.729 | FP-Norm(final)=2.627 | 1712.5 samples/s | 26.8 steps/s
[Step=17400 Epoch=34.0] | Loss=0.01215 | Reg=0.00053 | acc=0.9844 | FP-Norm=0.728 | FP-Norm(final)=2.629 | 3945.2 samples/s | 61.6 steps/s
[Step=17450 Epoch=34.1] | Loss=0.01182 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.728 | FP-Norm(final)=2.630 | 3908.7 samples/s | 61.1 steps/s
[Step=17500 Epoch=34.2] | Loss=0.01154 | Reg=0.00053 | acc=0.9844 | FP-Norm=0.728 | FP-Norm(final)=2.632 | 3869.0 samples/s | 60.5 steps/s
[Step=17550 Epoch=34.3] | Loss=0.01134 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.729 | FP-Norm(final)=2.633 | 3941.6 samples/s | 61.6 steps/s
[Step=17600 Epoch=34.4] | Loss=0.01121 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.730 | FP-Norm(final)=2.635 | 3892.4 samples/s | 60.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step17600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=64.4] | Loss=0.01492 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.619 | 3580.9 samples/s | 56.0 steps/s
[Step=16850 Epoch=64.6] | Loss=0.00495 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.785 | FP-Norm(final)=2.620 | 3632.8 samples/s | 56.8 steps/s
[Step=16900 Epoch=64.8] | Loss=0.00348 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.885 | FP-Norm(final)=2.620 | 3818.2 samples/s | 59.7 steps/s
[Step=16950 Epoch=64.9] | Loss=0.00236 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.902 | FP-Norm(final)=2.622 | 3785.7 samples/s | 59.2 steps/s
[Step=17000 Epoch=65.1] | Loss=0.00183 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.901 | FP-Norm(final)=2.623 | 3688.4 samples/s | 57.6 steps/s
[Step=17050 Epoch=65.3] | Loss=0.00148 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.892 | FP-Norm(final)=2.624 | 4507.9 samples/s | 70.4 steps/s
[Step=17100 Epoch=65.5] | Loss=0.00124 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.880 | FP-Norm(final)=2.625 | 1661.5 samples/s | 26.0 steps/s
[Step=17150 Epoch=65.7] | Loss=0.00107 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.867 | FP-Norm(final)=2.626 | 3678.8 samples/s | 57.5 steps/s
[Step=17200 Epoch=65.9] | Loss=0.00094 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.853 | FP-Norm(final)=2.627 | 3681.2 samples/s | 57.5 steps/s
[Step=17250 Epoch=66.1] | Loss=0.00084 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.840 | FP-Norm(final)=2.628 | 3690.1 samples/s | 57.7 steps/s
[Step=17300 Epoch=66.3] | Loss=0.00076 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.828 | FP-Norm(final)=2.628 | 4034.6 samples/s | 63.0 steps/s
[Step=17350 Epoch=66.5] | Loss=0.00070 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.629 | 1745.9 samples/s | 27.3 steps/s
[Step=17400 Epoch=66.7] | Loss=0.00064 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.804 | FP-Norm(final)=2.629 | 3830.4 samples/s | 59.9 steps/s
[Step=17450 Epoch=66.9] | Loss=0.00059 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.630 | 3702.8 samples/s | 57.9 steps/s
[Step=17500 Epoch=67.1] | Loss=0.00055 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.783 | FP-Norm(final)=2.630 | 3683.2 samples/s | 57.6 steps/s
[Step=17550 Epoch=67.2] | Loss=0.00052 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.773 | FP-Norm(final)=2.631 | 3706.1 samples/s | 57.9 steps/s
[Step=17600 Epoch=67.4] | Loss=0.00049 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.763 | FP-Norm(final)=2.631 | 1770.7 samples/s | 27.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step17600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=64.7] | Loss=0.03037 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.618 | 3785.4 samples/s | 59.1 steps/s
[Step=16850 Epoch=64.9] | Loss=0.00462 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.875 | FP-Norm(final)=2.624 | 3584.7 samples/s | 56.0 steps/s
[Step=16900 Epoch=65.1] | Loss=0.00274 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.944 | FP-Norm(final)=2.627 | 3772.5 samples/s | 58.9 steps/s
[Step=16950 Epoch=65.2] | Loss=0.00185 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.935 | FP-Norm(final)=2.628 | 3701.8 samples/s | 57.8 steps/s
[Step=17000 Epoch=65.4] | Loss=0.00141 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.916 | FP-Norm(final)=2.629 | 3696.2 samples/s | 57.8 steps/s
[Step=17050 Epoch=65.6] | Loss=0.00114 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.897 | FP-Norm(final)=2.630 | 4601.8 samples/s | 71.9 steps/s
[Step=17100 Epoch=65.8] | Loss=0.00096 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.878 | FP-Norm(final)=2.630 | 1646.1 samples/s | 25.7 steps/s
[Step=17150 Epoch=66.0] | Loss=0.00082 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.860 | FP-Norm(final)=2.631 | 3664.9 samples/s | 57.3 steps/s
[Step=17200 Epoch=66.2] | Loss=0.00073 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.843 | FP-Norm(final)=2.631 | 3679.3 samples/s | 57.5 steps/s
[Step=17250 Epoch=66.4] | Loss=0.00065 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.827 | FP-Norm(final)=2.631 | 3701.0 samples/s | 57.8 steps/s
[Step=17300 Epoch=66.6] | Loss=0.00059 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.632 | 4145.9 samples/s | 64.8 steps/s
[Step=17350 Epoch=66.8] | Loss=0.00054 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.799 | FP-Norm(final)=2.632 | 1714.1 samples/s | 26.8 steps/s
[Step=17400 Epoch=67.0] | Loss=0.00049 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.632 | 3692.8 samples/s | 57.7 steps/s
[Step=17450 Epoch=67.2] | Loss=0.00046 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.632 | 3689.2 samples/s | 57.6 steps/s
[Step=17500 Epoch=67.4] | Loss=0.00043 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.633 | 3717.6 samples/s | 58.1 steps/s
[Step=17550 Epoch=67.6] | Loss=0.00040 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.751 | FP-Norm(final)=2.633 | 3747.0 samples/s | 58.5 steps/s
[Step=17600 Epoch=67.7] | Loss=0.00038 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.740 | FP-Norm(final)=2.633 | 1785.9 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26333 | acc=0.8447 | tpr=0.7780 | fpr=0.0104 | 3819.1 samples/s | 14.9 steps/s
Avg test loss: 0.26838, Avg test acc: 0.84438, Avg tpr: 0.77945, Avg fpr: 0.01282, total FA: 100

Testing server on iccad2012
[Step=  50] | Loss=0.36830 | acc=0.8450 | tpr=0.9602 | fpr=0.1571 | 3867.5 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.36590 | acc=0.8470 | tpr=0.9680 | fpr=0.1553 | 7146.7 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.37424 | acc=0.8447 | tpr=0.9712 | fpr=0.1576 | 7380.8 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.37871 | acc=0.8444 | tpr=0.9716 | fpr=0.1580 | 7680.3 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.37583 | acc=0.8444 | tpr=0.9721 | fpr=0.1579 | 7191.8 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.37699 | acc=0.8445 | tpr=0.9687 | fpr=0.1578 | 7171.9 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.38039 | acc=0.8440 | tpr=0.9693 | fpr=0.1582 | 7384.7 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.38106 | acc=0.8436 | tpr=0.9672 | fpr=0.1586 | 7215.5 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.38329 | acc=0.8435 | tpr=0.9669 | fpr=0.1587 | 7126.7 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.38361 | acc=0.8434 | tpr=0.9683 | fpr=0.1588 | 7303.9 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.38302 | acc=0.8435 | tpr=0.9666 | fpr=0.1587 | 13769.1 samples/s | 53.8 steps/s
Avg test loss: 0.38291, Avg test acc: 0.84348, Avg tpr: 0.96632, Avg fpr: 0.15875, total FA: 22042

server round 22/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=34.3] | Loss=0.06125 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.644 | 3450.2 samples/s | 53.9 steps/s
[Step=17650 Epoch=34.4] | Loss=0.02927 | Reg=0.00051 | acc=0.9844 | FP-Norm=0.676 | FP-Norm(final)=2.639 | 3765.5 samples/s | 58.8 steps/s
[Step=17700 Epoch=34.5] | Loss=0.02091 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.725 | FP-Norm(final)=2.638 | 3997.2 samples/s | 62.5 steps/s
[Step=17750 Epoch=34.6] | Loss=0.01778 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.732 | FP-Norm(final)=2.638 | 3988.4 samples/s | 62.3 steps/s
[Step=17800 Epoch=34.7] | Loss=0.01648 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.734 | FP-Norm(final)=2.639 | 3961.9 samples/s | 61.9 steps/s
[Step=17850 Epoch=34.8] | Loss=0.01592 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.733 | FP-Norm(final)=2.639 | 4010.9 samples/s | 62.7 steps/s
[Step=17900 Epoch=34.9] | Loss=0.01473 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.731 | FP-Norm(final)=2.640 | 4024.0 samples/s | 62.9 steps/s
[Step=17950 Epoch=35.0] | Loss=0.01411 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.730 | FP-Norm(final)=2.642 | 3993.8 samples/s | 62.4 steps/s
[Step=18000 Epoch=35.1] | Loss=0.01365 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.731 | FP-Norm(final)=2.643 | 4009.1 samples/s | 62.6 steps/s
[Step=18050 Epoch=35.2] | Loss=0.01362 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.733 | FP-Norm(final)=2.644 | 4015.9 samples/s | 62.7 steps/s
[Step=18100 Epoch=35.3] | Loss=0.01361 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.736 | FP-Norm(final)=2.644 | 4722.5 samples/s | 73.8 steps/s
[Step=18150 Epoch=35.4] | Loss=0.01326 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.737 | FP-Norm(final)=2.645 | 1682.3 samples/s | 26.3 steps/s
[Step=18200 Epoch=35.5] | Loss=0.01278 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.739 | FP-Norm(final)=2.645 | 3857.5 samples/s | 60.3 steps/s
[Step=18250 Epoch=35.6] | Loss=0.01246 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.740 | FP-Norm(final)=2.646 | 3918.0 samples/s | 61.2 steps/s
[Step=18300 Epoch=35.7] | Loss=0.01212 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.740 | FP-Norm(final)=2.647 | 3876.2 samples/s | 60.6 steps/s
[Step=18350 Epoch=35.8] | Loss=0.01221 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.741 | FP-Norm(final)=2.648 | 3859.9 samples/s | 60.3 steps/s
[Step=18400 Epoch=35.9] | Loss=0.01191 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.742 | FP-Norm(final)=2.649 | 3941.0 samples/s | 61.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step18400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=34.4] | Loss=0.17096 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.644 | 3654.7 samples/s | 57.1 steps/s
[Step=17650 Epoch=34.5] | Loss=0.02227 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.601 | FP-Norm(final)=2.642 | 3861.8 samples/s | 60.3 steps/s
[Step=17700 Epoch=34.6] | Loss=0.01682 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.641 | FP-Norm(final)=2.642 | 3891.9 samples/s | 60.8 steps/s
[Step=17750 Epoch=34.7] | Loss=0.01572 | Reg=0.00044 | acc=0.9688 | FP-Norm=0.653 | FP-Norm(final)=2.643 | 3929.0 samples/s | 61.4 steps/s
[Step=17800 Epoch=34.8] | Loss=0.01670 | Reg=0.00044 | acc=0.9688 | FP-Norm=0.660 | FP-Norm(final)=2.644 | 3885.3 samples/s | 60.7 steps/s
[Step=17850 Epoch=34.9] | Loss=0.01531 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.666 | FP-Norm(final)=2.644 | 3929.0 samples/s | 61.4 steps/s
[Step=17900 Epoch=35.0] | Loss=0.01480 | Reg=0.00045 | acc=0.9844 | FP-Norm=0.669 | FP-Norm(final)=2.644 | 3895.6 samples/s | 60.9 steps/s
[Step=17950 Epoch=35.1] | Loss=0.01390 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.677 | FP-Norm(final)=2.645 | 3926.8 samples/s | 61.4 steps/s
[Step=18000 Epoch=35.2] | Loss=0.01348 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.685 | FP-Norm(final)=2.646 | 3900.0 samples/s | 60.9 steps/s
[Step=18050 Epoch=35.3] | Loss=0.01287 | Reg=0.00048 | acc=0.9844 | FP-Norm=0.690 | FP-Norm(final)=2.648 | 3929.0 samples/s | 61.4 steps/s
[Step=18100 Epoch=35.4] | Loss=0.01296 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.696 | FP-Norm(final)=2.649 | 4656.2 samples/s | 72.8 steps/s
[Step=18150 Epoch=35.5] | Loss=0.01246 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.700 | FP-Norm(final)=2.650 | 1727.7 samples/s | 27.0 steps/s
[Step=18200 Epoch=35.6] | Loss=0.01215 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.703 | FP-Norm(final)=2.652 | 4008.2 samples/s | 62.6 steps/s
[Step=18250 Epoch=35.7] | Loss=0.01182 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.706 | FP-Norm(final)=2.653 | 3982.0 samples/s | 62.2 steps/s
[Step=18300 Epoch=35.8] | Loss=0.01152 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.708 | FP-Norm(final)=2.654 | 3985.4 samples/s | 62.3 steps/s
[Step=18350 Epoch=35.9] | Loss=0.01135 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.711 | FP-Norm(final)=2.656 | 3987.4 samples/s | 62.3 steps/s
[Step=18400 Epoch=36.0] | Loss=0.01122 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.713 | FP-Norm(final)=2.657 | 4009.8 samples/s | 62.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step18400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=67.4] | Loss=0.13634 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.644 | 3929.8 samples/s | 61.4 steps/s
[Step=17650 Epoch=67.6] | Loss=0.00601 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.945 | FP-Norm(final)=2.642 | 3426.5 samples/s | 53.5 steps/s
[Step=17700 Epoch=67.8] | Loss=0.00310 | Reg=0.00103 | acc=1.0000 | FP-Norm=0.994 | FP-Norm(final)=2.644 | 3799.3 samples/s | 59.4 steps/s
[Step=17750 Epoch=68.0] | Loss=0.00210 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.980 | FP-Norm(final)=2.645 | 3801.3 samples/s | 59.4 steps/s
[Step=17800 Epoch=68.2] | Loss=0.00159 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.957 | FP-Norm(final)=2.646 | 3818.3 samples/s | 59.7 steps/s
[Step=17850 Epoch=68.4] | Loss=0.00128 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.934 | FP-Norm(final)=2.647 | 4570.6 samples/s | 71.4 steps/s
[Step=17900 Epoch=68.6] | Loss=0.00107 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.913 | FP-Norm(final)=2.648 | 1637.2 samples/s | 25.6 steps/s
[Step=17950 Epoch=68.8] | Loss=0.00093 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.893 | FP-Norm(final)=2.648 | 3719.1 samples/s | 58.1 steps/s
[Step=18000 Epoch=69.0] | Loss=0.00082 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.874 | FP-Norm(final)=2.649 | 3651.5 samples/s | 57.1 steps/s
[Step=18050 Epoch=69.2] | Loss=0.00073 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.857 | FP-Norm(final)=2.649 | 3727.3 samples/s | 58.2 steps/s
[Step=18100 Epoch=69.4] | Loss=0.00066 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.841 | FP-Norm(final)=2.650 | 4010.2 samples/s | 62.7 steps/s
[Step=18150 Epoch=69.5] | Loss=0.00060 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.650 | 1749.9 samples/s | 27.3 steps/s
[Step=18200 Epoch=69.7] | Loss=0.00055 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.650 | 3701.2 samples/s | 57.8 steps/s
[Step=18250 Epoch=69.9] | Loss=0.00051 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.651 | 3714.7 samples/s | 58.0 steps/s
[Step=18300 Epoch=70.1] | Loss=0.00048 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.651 | 3721.7 samples/s | 58.2 steps/s
[Step=18350 Epoch=70.3] | Loss=0.00045 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.651 | 3724.6 samples/s | 58.2 steps/s
[Step=18400 Epoch=70.5] | Loss=0.00042 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.763 | FP-Norm(final)=2.652 | 1814.2 samples/s | 28.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step18400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=67.8] | Loss=0.14833 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.644 | 3605.4 samples/s | 56.3 steps/s
[Step=17650 Epoch=67.9] | Loss=0.00745 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.021 | FP-Norm(final)=2.643 | 3581.2 samples/s | 56.0 steps/s
[Step=17700 Epoch=68.1] | Loss=0.00396 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.064 | FP-Norm(final)=2.645 | 3736.8 samples/s | 58.4 steps/s
[Step=17750 Epoch=68.3] | Loss=0.00268 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.056 | FP-Norm(final)=2.646 | 3688.0 samples/s | 57.6 steps/s
[Step=17800 Epoch=68.5] | Loss=0.00202 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.034 | FP-Norm(final)=2.647 | 3731.7 samples/s | 58.3 steps/s
[Step=17850 Epoch=68.7] | Loss=0.00162 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.011 | FP-Norm(final)=2.648 | 4655.8 samples/s | 72.7 steps/s
[Step=17900 Epoch=68.9] | Loss=0.00135 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.989 | FP-Norm(final)=2.648 | 1641.8 samples/s | 25.7 steps/s
[Step=17950 Epoch=69.1] | Loss=0.00116 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.968 | FP-Norm(final)=2.648 | 3776.0 samples/s | 59.0 steps/s
[Step=18000 Epoch=69.3] | Loss=0.00102 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.949 | FP-Norm(final)=2.648 | 3681.4 samples/s | 57.5 steps/s
[Step=18050 Epoch=69.5] | Loss=0.00091 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.931 | FP-Norm(final)=2.648 | 3702.2 samples/s | 57.8 steps/s
[Step=18100 Epoch=69.7] | Loss=0.00082 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.914 | FP-Norm(final)=2.649 | 4100.6 samples/s | 64.1 steps/s
[Step=18150 Epoch=69.9] | Loss=0.00075 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.898 | FP-Norm(final)=2.649 | 1712.7 samples/s | 26.8 steps/s
[Step=18200 Epoch=70.1] | Loss=0.00069 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.882 | FP-Norm(final)=2.649 | 3809.8 samples/s | 59.5 steps/s
[Step=18250 Epoch=70.3] | Loss=0.00063 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.868 | FP-Norm(final)=2.649 | 3806.5 samples/s | 59.5 steps/s
[Step=18300 Epoch=70.4] | Loss=0.00059 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.854 | FP-Norm(final)=2.649 | 3776.5 samples/s | 59.0 steps/s
[Step=18350 Epoch=70.6] | Loss=0.00055 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.841 | FP-Norm(final)=2.649 | 3862.1 samples/s | 60.3 steps/s
[Step=18400 Epoch=70.8] | Loss=0.00052 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.649 | 1802.7 samples/s | 28.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34587 | acc=0.8046 | tpr=0.7188 | fpr=0.0092 | 3844.9 samples/s | 15.0 steps/s
Avg test loss: 0.34991, Avg test acc: 0.80335, Avg tpr: 0.71907, Avg fpr: 0.01128, total FA: 88

Testing server on iccad2012
[Step=  50] | Loss=0.29276 | acc=0.8891 | tpr=0.9646 | fpr=0.1123 | 3853.8 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.29129 | acc=0.8921 | tpr=0.9701 | fpr=0.1093 | 7466.8 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.29888 | acc=0.8901 | tpr=0.9697 | fpr=0.1114 | 7243.6 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.30368 | acc=0.8896 | tpr=0.9727 | fpr=0.1119 | 7394.7 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.30064 | acc=0.8896 | tpr=0.9721 | fpr=0.1119 | 7322.8 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.30248 | acc=0.8896 | tpr=0.9695 | fpr=0.1119 | 7135.9 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.30566 | acc=0.8888 | tpr=0.9699 | fpr=0.1127 | 7346.1 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.30662 | acc=0.8882 | tpr=0.9666 | fpr=0.1132 | 7257.1 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.30900 | acc=0.8880 | tpr=0.9664 | fpr=0.1134 | 7179.0 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.30890 | acc=0.8880 | tpr=0.9678 | fpr=0.1134 | 7300.0 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.30801 | acc=0.8882 | tpr=0.9666 | fpr=0.1132 | 12842.1 samples/s | 50.2 steps/s
Avg test loss: 0.30786, Avg test acc: 0.88825, Avg tpr: 0.96632, Avg fpr: 0.11317, total FA: 15714

server round 23/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=35.9] | Loss=0.21362 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.660 | 3523.4 samples/s | 55.1 steps/s
[Step=18450 Epoch=36.0] | Loss=0.02415 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.640 | FP-Norm(final)=2.658 | 3842.8 samples/s | 60.0 steps/s
[Step=18500 Epoch=36.1] | Loss=0.01760 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.689 | FP-Norm(final)=2.658 | 3863.0 samples/s | 60.4 steps/s
[Step=18550 Epoch=36.2] | Loss=0.01603 | Reg=0.00051 | acc=0.9844 | FP-Norm=0.705 | FP-Norm(final)=2.659 | 3903.4 samples/s | 61.0 steps/s
[Step=18600 Epoch=36.3] | Loss=0.01489 | Reg=0.00052 | acc=0.9688 | FP-Norm=0.712 | FP-Norm(final)=2.660 | 3884.6 samples/s | 60.7 steps/s
[Step=18650 Epoch=36.4] | Loss=0.01461 | Reg=0.00053 | acc=0.9688 | FP-Norm=0.718 | FP-Norm(final)=2.661 | 3900.3 samples/s | 60.9 steps/s
[Step=18700 Epoch=36.5] | Loss=0.01412 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.723 | FP-Norm(final)=2.661 | 3888.3 samples/s | 60.8 steps/s
[Step=18750 Epoch=36.6] | Loss=0.01343 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.728 | FP-Norm(final)=2.662 | 3889.3 samples/s | 60.8 steps/s
[Step=18800 Epoch=36.7] | Loss=0.01292 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.729 | FP-Norm(final)=2.664 | 3888.7 samples/s | 60.8 steps/s
[Step=18850 Epoch=36.8] | Loss=0.01279 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.729 | FP-Norm(final)=2.665 | 3905.7 samples/s | 61.0 steps/s
[Step=18900 Epoch=36.9] | Loss=0.01276 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.729 | FP-Norm(final)=2.666 | 4613.0 samples/s | 72.1 steps/s
[Step=18950 Epoch=37.0] | Loss=0.01237 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.730 | FP-Norm(final)=2.666 | 1689.8 samples/s | 26.4 steps/s
[Step=19000 Epoch=37.1] | Loss=0.01191 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.730 | FP-Norm(final)=2.667 | 3985.9 samples/s | 62.3 steps/s
[Step=19050 Epoch=37.2] | Loss=0.01176 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.732 | FP-Norm(final)=2.668 | 4021.4 samples/s | 62.8 steps/s
[Step=19100 Epoch=37.3] | Loss=0.01161 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.733 | FP-Norm(final)=2.669 | 3987.0 samples/s | 62.3 steps/s
[Step=19150 Epoch=37.3] | Loss=0.01166 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.734 | FP-Norm(final)=2.669 | 3917.3 samples/s | 61.2 steps/s
[Step=19200 Epoch=37.4] | Loss=0.01150 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.735 | FP-Norm(final)=2.670 | 3928.3 samples/s | 61.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step19200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=36.0] | Loss=0.09783 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.660 | 3732.0 samples/s | 58.3 steps/s
[Step=18450 Epoch=36.1] | Loss=0.03252 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.656 | 3670.1 samples/s | 57.3 steps/s
[Step=18500 Epoch=36.2] | Loss=0.02243 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.655 | 3869.5 samples/s | 60.5 steps/s
[Step=18550 Epoch=36.3] | Loss=0.01846 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.810 | FP-Norm(final)=2.657 | 3899.3 samples/s | 60.9 steps/s
[Step=18600 Epoch=36.4] | Loss=0.01689 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.805 | FP-Norm(final)=2.658 | 4009.5 samples/s | 62.6 steps/s
[Step=18650 Epoch=36.5] | Loss=0.01581 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.801 | FP-Norm(final)=2.660 | 4010.6 samples/s | 62.7 steps/s
[Step=18700 Epoch=36.6] | Loss=0.01510 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.799 | FP-Norm(final)=2.661 | 3981.6 samples/s | 62.2 steps/s
[Step=18750 Epoch=36.7] | Loss=0.01428 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.795 | FP-Norm(final)=2.662 | 4014.2 samples/s | 62.7 steps/s
[Step=18800 Epoch=36.8] | Loss=0.01400 | Reg=0.00064 | acc=0.9688 | FP-Norm=0.793 | FP-Norm(final)=2.664 | 3978.1 samples/s | 62.2 steps/s
[Step=18850 Epoch=36.9] | Loss=0.01352 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.792 | FP-Norm(final)=2.665 | 4013.9 samples/s | 62.7 steps/s
[Step=18900 Epoch=36.9] | Loss=0.01328 | Reg=0.00063 | acc=0.9844 | FP-Norm=0.791 | FP-Norm(final)=2.666 | 4798.2 samples/s | 75.0 steps/s
[Step=18950 Epoch=37.0] | Loss=0.01281 | Reg=0.00063 | acc=0.9688 | FP-Norm=0.790 | FP-Norm(final)=2.668 | 1721.5 samples/s | 26.9 steps/s
[Step=19000 Epoch=37.1] | Loss=0.01237 | Reg=0.00063 | acc=0.9844 | FP-Norm=0.788 | FP-Norm(final)=2.669 | 3957.6 samples/s | 61.8 steps/s
[Step=19050 Epoch=37.2] | Loss=0.01207 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.787 | FP-Norm(final)=2.671 | 3980.7 samples/s | 62.2 steps/s
[Step=19100 Epoch=37.3] | Loss=0.01189 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.786 | FP-Norm(final)=2.672 | 3992.1 samples/s | 62.4 steps/s
[Step=19150 Epoch=37.4] | Loss=0.01160 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.785 | FP-Norm(final)=2.673 | 3984.5 samples/s | 62.3 steps/s
[Step=19200 Epoch=37.5] | Loss=0.01151 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.785 | FP-Norm(final)=2.674 | 3921.8 samples/s | 61.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step19200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=70.5] | Loss=0.03124 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.660 | 3731.6 samples/s | 58.3 steps/s
[Step=18450 Epoch=70.7] | Loss=0.00289 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.744 | FP-Norm(final)=2.668 | 3515.0 samples/s | 54.9 steps/s
[Step=18500 Epoch=70.9] | Loss=0.00156 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.796 | FP-Norm(final)=2.670 | 3688.6 samples/s | 57.6 steps/s
[Step=18550 Epoch=71.1] | Loss=0.00106 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.790 | FP-Norm(final)=2.671 | 3719.6 samples/s | 58.1 steps/s
[Step=18600 Epoch=71.3] | Loss=0.00080 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.776 | FP-Norm(final)=2.672 | 3695.1 samples/s | 57.7 steps/s
[Step=18650 Epoch=71.5] | Loss=0.00065 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.760 | FP-Norm(final)=2.673 | 4520.3 samples/s | 70.6 steps/s
[Step=18700 Epoch=71.7] | Loss=0.00055 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.744 | FP-Norm(final)=2.673 | 1669.8 samples/s | 26.1 steps/s
[Step=18750 Epoch=71.8] | Loss=0.00047 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.728 | FP-Norm(final)=2.673 | 3666.7 samples/s | 57.3 steps/s
[Step=18800 Epoch=72.0] | Loss=0.00042 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.714 | FP-Norm(final)=2.674 | 3733.8 samples/s | 58.3 steps/s
[Step=18850 Epoch=72.2] | Loss=0.00037 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.700 | FP-Norm(final)=2.674 | 3664.5 samples/s | 57.3 steps/s
[Step=18900 Epoch=72.4] | Loss=0.00034 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.687 | FP-Norm(final)=2.674 | 4050.1 samples/s | 63.3 steps/s
[Step=18950 Epoch=72.6] | Loss=0.00031 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.675 | FP-Norm(final)=2.674 | 1727.6 samples/s | 27.0 steps/s
[Step=19000 Epoch=72.8] | Loss=0.00029 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.664 | FP-Norm(final)=2.674 | 3834.0 samples/s | 59.9 steps/s
[Step=19050 Epoch=73.0] | Loss=0.00027 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.653 | FP-Norm(final)=2.675 | 3615.0 samples/s | 56.5 steps/s
[Step=19100 Epoch=73.2] | Loss=0.00025 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.643 | FP-Norm(final)=2.675 | 3734.4 samples/s | 58.4 steps/s
[Step=19150 Epoch=73.4] | Loss=0.00023 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.634 | FP-Norm(final)=2.675 | 3801.8 samples/s | 59.4 steps/s
[Step=19200 Epoch=73.6] | Loss=0.00022 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.625 | FP-Norm(final)=2.675 | 1802.0 samples/s | 28.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step19200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=70.8] | Loss=0.00831 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.660 | 3724.5 samples/s | 58.2 steps/s
[Step=18450 Epoch=71.0] | Loss=0.00588 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.942 | FP-Norm(final)=2.663 | 3604.4 samples/s | 56.3 steps/s
[Step=18500 Epoch=71.2] | Loss=0.00315 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.016 | FP-Norm(final)=2.666 | 3725.8 samples/s | 58.2 steps/s
[Step=18550 Epoch=71.4] | Loss=0.00214 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.013 | FP-Norm(final)=2.667 | 3704.2 samples/s | 57.9 steps/s
[Step=18600 Epoch=71.6] | Loss=0.00162 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.996 | FP-Norm(final)=2.668 | 3691.4 samples/s | 57.7 steps/s
[Step=18650 Epoch=71.8] | Loss=0.00132 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.978 | FP-Norm(final)=2.669 | 4591.8 samples/s | 71.7 steps/s
[Step=18700 Epoch=72.0] | Loss=0.00111 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.959 | FP-Norm(final)=2.670 | 1656.5 samples/s | 25.9 steps/s
[Step=18750 Epoch=72.2] | Loss=0.00095 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.941 | FP-Norm(final)=2.670 | 3772.4 samples/s | 58.9 steps/s
[Step=18800 Epoch=72.4] | Loss=0.00084 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.924 | FP-Norm(final)=2.671 | 3644.1 samples/s | 56.9 steps/s
[Step=18850 Epoch=72.6] | Loss=0.00075 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.908 | FP-Norm(final)=2.671 | 3715.1 samples/s | 58.0 steps/s
[Step=18900 Epoch=72.8] | Loss=0.00067 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.893 | FP-Norm(final)=2.671 | 4102.4 samples/s | 64.1 steps/s
[Step=18950 Epoch=72.9] | Loss=0.00061 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.878 | FP-Norm(final)=2.671 | 1705.5 samples/s | 26.6 steps/s
[Step=19000 Epoch=73.1] | Loss=0.00056 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.865 | FP-Norm(final)=2.671 | 3681.2 samples/s | 57.5 steps/s
[Step=19050 Epoch=73.3] | Loss=0.00052 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.852 | FP-Norm(final)=2.672 | 3691.4 samples/s | 57.7 steps/s
[Step=19100 Epoch=73.5] | Loss=0.00049 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.840 | FP-Norm(final)=2.672 | 3667.4 samples/s | 57.3 steps/s
[Step=19150 Epoch=73.7] | Loss=0.00046 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.828 | FP-Norm(final)=2.672 | 3733.9 samples/s | 58.3 steps/s
[Step=19200 Epoch=73.9] | Loss=0.00043 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.672 | 1788.0 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27702 | acc=0.8403 | tpr=0.7720 | fpr=0.0114 | 3822.0 samples/s | 14.9 steps/s
Avg test loss: 0.28273, Avg test acc: 0.83941, Avg tpr: 0.77280, Avg fpr: 0.01410, total FA: 110

Testing server on iccad2012
[Step=  50] | Loss=0.34691 | acc=0.8594 | tpr=0.9646 | fpr=0.1425 | 3862.7 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.34458 | acc=0.8625 | tpr=0.9701 | fpr=0.1395 | 7160.6 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.35242 | acc=0.8608 | tpr=0.9712 | fpr=0.1412 | 7221.9 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.35666 | acc=0.8601 | tpr=0.9727 | fpr=0.1420 | 7319.1 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.35311 | acc=0.8602 | tpr=0.9729 | fpr=0.1419 | 7496.4 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.35476 | acc=0.8601 | tpr=0.9695 | fpr=0.1418 | 7243.1 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.35858 | acc=0.8596 | tpr=0.9706 | fpr=0.1425 | 7401.5 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.35948 | acc=0.8591 | tpr=0.9677 | fpr=0.1429 | 7251.4 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.36178 | acc=0.8588 | tpr=0.9684 | fpr=0.1432 | 7131.2 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.36193 | acc=0.8587 | tpr=0.9692 | fpr=0.1433 | 7309.9 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.36108 | acc=0.8589 | tpr=0.9674 | fpr=0.1430 | 13511.3 samples/s | 52.8 steps/s
Avg test loss: 0.36093, Avg test acc: 0.85896, Avg tpr: 0.96712, Avg fpr: 0.14301, total FA: 19856

server round 24/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=37.4] | Loss=0.27356 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.680 | 3449.2 samples/s | 53.9 steps/s
[Step=19250 Epoch=37.5] | Loss=0.02300 | Reg=0.00042 | acc=0.9844 | FP-Norm=0.623 | FP-Norm(final)=2.677 | 3897.1 samples/s | 60.9 steps/s
[Step=19300 Epoch=37.6] | Loss=0.01765 | Reg=0.00044 | acc=0.9844 | FP-Norm=0.653 | FP-Norm(final)=2.677 | 3929.2 samples/s | 61.4 steps/s
[Step=19350 Epoch=37.7] | Loss=0.01489 | Reg=0.00044 | acc=0.9844 | FP-Norm=0.655 | FP-Norm(final)=2.678 | 3886.3 samples/s | 60.7 steps/s
[Step=19400 Epoch=37.8] | Loss=0.01377 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.658 | FP-Norm(final)=2.680 | 3883.6 samples/s | 60.7 steps/s
[Step=19450 Epoch=37.9] | Loss=0.01347 | Reg=0.00045 | acc=0.9844 | FP-Norm=0.662 | FP-Norm(final)=2.682 | 3896.9 samples/s | 60.9 steps/s
[Step=19500 Epoch=38.0] | Loss=0.01316 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.668 | FP-Norm(final)=2.683 | 3900.2 samples/s | 60.9 steps/s
[Step=19550 Epoch=38.1] | Loss=0.01263 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.674 | FP-Norm(final)=2.684 | 3875.5 samples/s | 60.6 steps/s
[Step=19600 Epoch=38.2] | Loss=0.01244 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.677 | FP-Norm(final)=2.685 | 3902.3 samples/s | 61.0 steps/s
[Step=19650 Epoch=38.3] | Loss=0.01238 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.681 | FP-Norm(final)=2.686 | 3880.6 samples/s | 60.6 steps/s
[Step=19700 Epoch=38.4] | Loss=0.01216 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.683 | FP-Norm(final)=2.687 | 4620.7 samples/s | 72.2 steps/s
[Step=19750 Epoch=38.5] | Loss=0.01183 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.685 | FP-Norm(final)=2.688 | 1660.2 samples/s | 25.9 steps/s
[Step=19800 Epoch=38.6] | Loss=0.01155 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.688 | FP-Norm(final)=2.689 | 3874.8 samples/s | 60.5 steps/s
[Step=19850 Epoch=38.7] | Loss=0.01120 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.690 | FP-Norm(final)=2.690 | 3895.5 samples/s | 60.9 steps/s
[Step=19900 Epoch=38.8] | Loss=0.01138 | Reg=0.00048 | acc=0.9844 | FP-Norm=0.694 | FP-Norm(final)=2.691 | 3893.2 samples/s | 60.8 steps/s
[Step=19950 Epoch=38.9] | Loss=0.01135 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.698 | FP-Norm(final)=2.692 | 3887.1 samples/s | 60.7 steps/s
[Step=20000 Epoch=39.0] | Loss=0.01117 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.701 | FP-Norm(final)=2.692 | 3895.2 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=37.5] | Loss=0.29087 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.680 | 3675.9 samples/s | 57.4 steps/s
[Step=19250 Epoch=37.6] | Loss=0.02220 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.660 | FP-Norm(final)=2.676 | 3728.6 samples/s | 58.3 steps/s
[Step=19300 Epoch=37.7] | Loss=0.01656 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.698 | FP-Norm(final)=2.676 | 3895.9 samples/s | 60.9 steps/s
[Step=19350 Epoch=37.8] | Loss=0.01477 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.699 | FP-Norm(final)=2.678 | 3903.1 samples/s | 61.0 steps/s
[Step=19400 Epoch=37.9] | Loss=0.01406 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.698 | FP-Norm(final)=2.679 | 3894.7 samples/s | 60.9 steps/s
[Step=19450 Epoch=38.0] | Loss=0.01316 | Reg=0.00049 | acc=0.9688 | FP-Norm=0.696 | FP-Norm(final)=2.680 | 3897.1 samples/s | 60.9 steps/s
[Step=19500 Epoch=38.1] | Loss=0.01257 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.695 | FP-Norm(final)=2.682 | 3904.8 samples/s | 61.0 steps/s
[Step=19550 Epoch=38.2] | Loss=0.01238 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.693 | FP-Norm(final)=2.683 | 3895.0 samples/s | 60.9 steps/s
[Step=19600 Epoch=38.3] | Loss=0.01206 | Reg=0.00048 | acc=0.9844 | FP-Norm=0.691 | FP-Norm(final)=2.684 | 3898.6 samples/s | 60.9 steps/s
[Step=19650 Epoch=38.4] | Loss=0.01188 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.691 | FP-Norm(final)=2.685 | 3898.0 samples/s | 60.9 steps/s
[Step=19700 Epoch=38.5] | Loss=0.01184 | Reg=0.00048 | acc=0.9688 | FP-Norm=0.692 | FP-Norm(final)=2.686 | 4650.0 samples/s | 72.7 steps/s
[Step=19750 Epoch=38.6] | Loss=0.01195 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.695 | FP-Norm(final)=2.686 | 1720.2 samples/s | 26.9 steps/s
[Step=19800 Epoch=38.7] | Loss=0.01151 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.697 | FP-Norm(final)=2.687 | 3966.0 samples/s | 62.0 steps/s
[Step=19850 Epoch=38.8] | Loss=0.01141 | Reg=0.00049 | acc=0.9844 | FP-Norm=0.699 | FP-Norm(final)=2.687 | 3996.0 samples/s | 62.4 steps/s
[Step=19900 Epoch=38.9] | Loss=0.01107 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.702 | FP-Norm(final)=2.688 | 4018.9 samples/s | 62.8 steps/s
[Step=19950 Epoch=39.0] | Loss=0.01088 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.705 | FP-Norm(final)=2.689 | 3997.6 samples/s | 62.5 steps/s
[Step=20000 Epoch=39.1] | Loss=0.01090 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.707 | FP-Norm(final)=2.690 | 4024.5 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step20000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=73.6] | Loss=0.07910 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.680 | 4104.2 samples/s | 64.1 steps/s
[Step=19250 Epoch=73.8] | Loss=0.00519 | Reg=0.00103 | acc=1.0000 | FP-Norm=0.976 | FP-Norm(final)=2.683 | 3262.2 samples/s | 51.0 steps/s
[Step=19300 Epoch=74.0] | Loss=0.00264 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.008 | FP-Norm(final)=2.684 | 3758.4 samples/s | 58.7 steps/s
[Step=19350 Epoch=74.1] | Loss=0.00185 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.994 | FP-Norm(final)=2.685 | 3682.3 samples/s | 57.5 steps/s
[Step=19400 Epoch=74.3] | Loss=0.00140 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.972 | FP-Norm(final)=2.686 | 3743.0 samples/s | 58.5 steps/s
[Step=19450 Epoch=74.5] | Loss=0.00114 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.951 | FP-Norm(final)=2.687 | 4478.2 samples/s | 70.0 steps/s
[Step=19500 Epoch=74.7] | Loss=0.00095 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.931 | FP-Norm(final)=2.688 | 1686.5 samples/s | 26.4 steps/s
[Step=19550 Epoch=74.9] | Loss=0.00082 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.910 | FP-Norm(final)=2.688 | 3762.9 samples/s | 58.8 steps/s
[Step=19600 Epoch=75.1] | Loss=0.00072 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.891 | FP-Norm(final)=2.688 | 3814.0 samples/s | 59.6 steps/s
[Step=19650 Epoch=75.3] | Loss=0.00064 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.873 | FP-Norm(final)=2.689 | 3804.1 samples/s | 59.4 steps/s
[Step=19700 Epoch=75.5] | Loss=0.00058 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.857 | FP-Norm(final)=2.689 | 4166.5 samples/s | 65.1 steps/s
[Step=19750 Epoch=75.7] | Loss=0.00053 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.841 | FP-Norm(final)=2.689 | 1737.4 samples/s | 27.1 steps/s
[Step=19800 Epoch=75.9] | Loss=0.00049 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.827 | FP-Norm(final)=2.689 | 3685.3 samples/s | 57.6 steps/s
[Step=19850 Epoch=76.1] | Loss=0.00045 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.689 | 3697.2 samples/s | 57.8 steps/s
[Step=19900 Epoch=76.2] | Loss=0.00042 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.799 | FP-Norm(final)=2.689 | 3704.5 samples/s | 57.9 steps/s
[Step=19950 Epoch=76.4] | Loss=0.00039 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.787 | FP-Norm(final)=2.690 | 3696.8 samples/s | 57.8 steps/s
[Step=20000 Epoch=76.6] | Loss=0.00037 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.690 | 1792.0 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step20000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=73.9] | Loss=0.01572 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.680 | 3741.2 samples/s | 58.5 steps/s
[Step=19250 Epoch=74.1] | Loss=0.00611 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.919 | FP-Norm(final)=2.681 | 3541.7 samples/s | 55.3 steps/s
[Step=19300 Epoch=74.3] | Loss=0.00314 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.980 | FP-Norm(final)=2.682 | 3714.8 samples/s | 58.0 steps/s
[Step=19350 Epoch=74.5] | Loss=0.00211 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.976 | FP-Norm(final)=2.683 | 3724.1 samples/s | 58.2 steps/s
[Step=19400 Epoch=74.7] | Loss=0.00160 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.960 | FP-Norm(final)=2.683 | 3811.2 samples/s | 59.6 steps/s
[Step=19450 Epoch=74.9] | Loss=0.00129 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.943 | FP-Norm(final)=2.684 | 4700.5 samples/s | 73.4 steps/s
[Step=19500 Epoch=75.1] | Loss=0.00108 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.926 | FP-Norm(final)=2.684 | 1683.5 samples/s | 26.3 steps/s
[Step=19550 Epoch=75.3] | Loss=0.00093 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.910 | FP-Norm(final)=2.685 | 3715.4 samples/s | 58.1 steps/s
[Step=19600 Epoch=75.4] | Loss=0.00082 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.895 | FP-Norm(final)=2.685 | 3787.9 samples/s | 59.2 steps/s
[Step=19650 Epoch=75.6] | Loss=0.00073 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.881 | FP-Norm(final)=2.686 | 3760.1 samples/s | 58.8 steps/s
[Step=19700 Epoch=75.8] | Loss=0.00066 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.867 | FP-Norm(final)=2.686 | 4130.3 samples/s | 64.5 steps/s
[Step=19750 Epoch=76.0] | Loss=0.00060 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.854 | FP-Norm(final)=2.686 | 1713.5 samples/s | 26.8 steps/s
[Step=19800 Epoch=76.2] | Loss=0.00056 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.842 | FP-Norm(final)=2.687 | 3705.6 samples/s | 57.9 steps/s
[Step=19850 Epoch=76.4] | Loss=0.00051 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.830 | FP-Norm(final)=2.687 | 3691.3 samples/s | 57.7 steps/s
[Step=19900 Epoch=76.6] | Loss=0.00048 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.819 | FP-Norm(final)=2.687 | 3707.0 samples/s | 57.9 steps/s
[Step=19950 Epoch=76.8] | Loss=0.00045 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.808 | FP-Norm(final)=2.688 | 3756.1 samples/s | 58.7 steps/s
[Step=20000 Epoch=77.0] | Loss=0.00042 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.688 | 1786.0 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25923 | acc=0.8487 | tpr=0.7849 | fpr=0.0129 | 3810.8 samples/s | 14.9 steps/s
Avg test loss: 0.26406, Avg test acc: 0.84782, Avg tpr: 0.78574, Avg fpr: 0.01564, total FA: 122

Testing server on iccad2012
[Step=  50] | Loss=0.34371 | acc=0.8645 | tpr=0.9690 | fpr=0.1373 | 3907.3 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.34307 | acc=0.8675 | tpr=0.9744 | fpr=0.1345 | 7160.4 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.35061 | acc=0.8660 | tpr=0.9755 | fpr=0.1361 | 7381.2 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.35516 | acc=0.8657 | tpr=0.9760 | fpr=0.1363 | 7263.2 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.35161 | acc=0.8656 | tpr=0.9755 | fpr=0.1364 | 7274.0 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.35347 | acc=0.8654 | tpr=0.9731 | fpr=0.1365 | 7381.1 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.35721 | acc=0.8645 | tpr=0.9731 | fpr=0.1374 | 7291.2 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.35817 | acc=0.8640 | tpr=0.9699 | fpr=0.1379 | 7344.6 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.36036 | acc=0.8638 | tpr=0.9698 | fpr=0.1382 | 7227.1 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.36029 | acc=0.8637 | tpr=0.9709 | fpr=0.1383 | 7016.5 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.35937 | acc=0.8640 | tpr=0.9686 | fpr=0.1379 | 13355.5 samples/s | 52.2 steps/s
Avg test loss: 0.35923, Avg test acc: 0.86404, Avg tpr: 0.96830, Avg fpr: 0.13786, total FA: 19141

server round 25/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=39.0] | Loss=0.13348 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.696 | 3802.8 samples/s | 59.4 steps/s
[Step=20050 Epoch=39.1] | Loss=0.02741 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.662 | FP-Norm(final)=2.690 | 3449.3 samples/s | 53.9 steps/s
[Step=20100 Epoch=39.2] | Loss=0.01874 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.703 | FP-Norm(final)=2.687 | 3887.8 samples/s | 60.7 steps/s
[Step=20150 Epoch=39.3] | Loss=0.01562 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.707 | FP-Norm(final)=2.687 | 3862.3 samples/s | 60.3 steps/s
[Step=20200 Epoch=39.4] | Loss=0.01503 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.703 | FP-Norm(final)=2.688 | 3907.5 samples/s | 61.1 steps/s
[Step=20250 Epoch=39.5] | Loss=0.01369 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.701 | FP-Norm(final)=2.689 | 3896.2 samples/s | 60.9 steps/s
[Step=20300 Epoch=39.6] | Loss=0.01328 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.699 | FP-Norm(final)=2.690 | 4000.2 samples/s | 62.5 steps/s
[Step=20350 Epoch=39.7] | Loss=0.01280 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.701 | FP-Norm(final)=2.692 | 4043.2 samples/s | 63.2 steps/s
[Step=20400 Epoch=39.8] | Loss=0.01243 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.701 | FP-Norm(final)=2.693 | 3982.4 samples/s | 62.2 steps/s
[Step=20450 Epoch=39.9] | Loss=0.01231 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.702 | FP-Norm(final)=2.694 | 4027.4 samples/s | 62.9 steps/s
[Step=20500 Epoch=40.0] | Loss=0.01238 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.705 | FP-Norm(final)=2.694 | 4714.1 samples/s | 73.7 steps/s
[Step=20550 Epoch=40.1] | Loss=0.01197 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.707 | FP-Norm(final)=2.695 | 1684.1 samples/s | 26.3 steps/s
[Step=20600 Epoch=40.2] | Loss=0.01185 | Reg=0.00051 | acc=0.9844 | FP-Norm=0.709 | FP-Norm(final)=2.695 | 3864.7 samples/s | 60.4 steps/s
[Step=20650 Epoch=40.3] | Loss=0.01151 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.711 | FP-Norm(final)=2.696 | 3922.6 samples/s | 61.3 steps/s
[Step=20700 Epoch=40.4] | Loss=0.01116 | Reg=0.00051 | acc=0.9844 | FP-Norm=0.712 | FP-Norm(final)=2.697 | 3873.6 samples/s | 60.5 steps/s
[Step=20750 Epoch=40.5] | Loss=0.01111 | Reg=0.00051 | acc=0.9688 | FP-Norm=0.713 | FP-Norm(final)=2.698 | 3886.7 samples/s | 60.7 steps/s
[Step=20800 Epoch=40.6] | Loss=0.01107 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.715 | FP-Norm(final)=2.699 | 3916.2 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step20800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=39.1] | Loss=0.17071 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.696 | 3711.8 samples/s | 58.0 steps/s
[Step=20050 Epoch=39.2] | Loss=0.02171 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.601 | FP-Norm(final)=2.693 | 3897.1 samples/s | 60.9 steps/s
[Step=20100 Epoch=39.3] | Loss=0.01656 | Reg=0.00042 | acc=0.9688 | FP-Norm=0.635 | FP-Norm(final)=2.696 | 3908.4 samples/s | 61.1 steps/s
[Step=20150 Epoch=39.4] | Loss=0.01575 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.657 | FP-Norm(final)=2.697 | 3867.1 samples/s | 60.4 steps/s
[Step=20200 Epoch=39.5] | Loss=0.01455 | Reg=0.00046 | acc=0.9844 | FP-Norm=0.670 | FP-Norm(final)=2.698 | 3951.8 samples/s | 61.7 steps/s
[Step=20250 Epoch=39.6] | Loss=0.01332 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.678 | FP-Norm(final)=2.699 | 3985.8 samples/s | 62.3 steps/s
[Step=20300 Epoch=39.7] | Loss=0.01281 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.684 | FP-Norm(final)=2.701 | 4015.0 samples/s | 62.7 steps/s
[Step=20350 Epoch=39.8] | Loss=0.01272 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.688 | FP-Norm(final)=2.702 | 4033.8 samples/s | 63.0 steps/s
[Step=20400 Epoch=39.9] | Loss=0.01228 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.691 | FP-Norm(final)=2.703 | 3997.6 samples/s | 62.5 steps/s
[Step=20450 Epoch=40.0] | Loss=0.01207 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.695 | FP-Norm(final)=2.705 | 4022.6 samples/s | 62.9 steps/s
[Step=20500 Epoch=40.1] | Loss=0.01182 | Reg=0.00049 | acc=0.9844 | FP-Norm=0.699 | FP-Norm(final)=2.706 | 4769.2 samples/s | 74.5 steps/s
[Step=20550 Epoch=40.2] | Loss=0.01120 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.701 | FP-Norm(final)=2.707 | 1704.3 samples/s | 26.6 steps/s
[Step=20600 Epoch=40.3] | Loss=0.01096 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.702 | FP-Norm(final)=2.709 | 3887.0 samples/s | 60.7 steps/s
[Step=20650 Epoch=40.4] | Loss=0.01091 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.704 | FP-Norm(final)=2.710 | 3896.5 samples/s | 60.9 steps/s
[Step=20700 Epoch=40.5] | Loss=0.01064 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.705 | FP-Norm(final)=2.711 | 3875.3 samples/s | 60.6 steps/s
[Step=20750 Epoch=40.6] | Loss=0.01041 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.706 | FP-Norm(final)=2.712 | 3874.4 samples/s | 60.5 steps/s
[Step=20800 Epoch=40.7] | Loss=0.01037 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.709 | FP-Norm(final)=2.713 | 3890.7 samples/s | 60.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step20800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=76.6] | Loss=0.06855 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.696 | 3647.7 samples/s | 57.0 steps/s
[Step=20050 Epoch=76.8] | Loss=0.00691 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.009 | FP-Norm(final)=2.697 | 3663.6 samples/s | 57.2 steps/s
[Step=20100 Epoch=77.0] | Loss=0.00369 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.096 | FP-Norm(final)=2.697 | 3715.5 samples/s | 58.1 steps/s
[Step=20150 Epoch=77.2] | Loss=0.00259 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.103 | FP-Norm(final)=2.698 | 3712.0 samples/s | 58.0 steps/s
[Step=20200 Epoch=77.4] | Loss=0.00195 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.089 | FP-Norm(final)=2.698 | 3720.4 samples/s | 58.1 steps/s
[Step=20250 Epoch=77.6] | Loss=0.00157 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.072 | FP-Norm(final)=2.699 | 4467.0 samples/s | 69.8 steps/s
[Step=20300 Epoch=77.8] | Loss=0.00132 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.054 | FP-Norm(final)=2.699 | 1647.9 samples/s | 25.7 steps/s
[Step=20350 Epoch=78.0] | Loss=0.00113 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.037 | FP-Norm(final)=2.699 | 3760.9 samples/s | 58.8 steps/s
[Step=20400 Epoch=78.2] | Loss=0.00099 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.020 | FP-Norm(final)=2.699 | 3819.1 samples/s | 59.7 steps/s
[Step=20450 Epoch=78.4] | Loss=0.00088 | Reg=0.00103 | acc=1.0000 | FP-Norm=1.004 | FP-Norm(final)=2.700 | 3710.4 samples/s | 58.0 steps/s
[Step=20500 Epoch=78.5] | Loss=0.00080 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.989 | FP-Norm(final)=2.700 | 4096.9 samples/s | 64.0 steps/s
[Step=20550 Epoch=78.7] | Loss=0.00073 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.975 | FP-Norm(final)=2.700 | 1749.9 samples/s | 27.3 steps/s
[Step=20600 Epoch=78.9] | Loss=0.00067 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.961 | FP-Norm(final)=2.700 | 3719.7 samples/s | 58.1 steps/s
[Step=20650 Epoch=79.1] | Loss=0.00062 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.948 | FP-Norm(final)=2.700 | 3709.9 samples/s | 58.0 steps/s
[Step=20700 Epoch=79.3] | Loss=0.00058 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.936 | FP-Norm(final)=2.701 | 3701.6 samples/s | 57.8 steps/s
[Step=20750 Epoch=79.5] | Loss=0.00054 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.924 | FP-Norm(final)=2.701 | 3677.9 samples/s | 57.5 steps/s
[Step=20800 Epoch=79.7] | Loss=0.00051 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.913 | FP-Norm(final)=2.701 | 1791.8 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step20800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=77.0] | Loss=0.02801 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.696 | 3566.1 samples/s | 55.7 steps/s
[Step=20050 Epoch=77.2] | Loss=0.00257 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.705 | 3768.2 samples/s | 58.9 steps/s
[Step=20100 Epoch=77.4] | Loss=0.00133 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.860 | FP-Norm(final)=2.708 | 3803.5 samples/s | 59.4 steps/s
[Step=20150 Epoch=77.6] | Loss=0.00093 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.852 | FP-Norm(final)=2.709 | 3748.5 samples/s | 58.6 steps/s
[Step=20200 Epoch=77.8] | Loss=0.00071 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.838 | FP-Norm(final)=2.710 | 3707.2 samples/s | 57.9 steps/s
[Step=20250 Epoch=78.0] | Loss=0.00060 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.823 | FP-Norm(final)=2.710 | 4565.1 samples/s | 71.3 steps/s
[Step=20300 Epoch=78.1] | Loss=0.00051 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.808 | FP-Norm(final)=2.710 | 1655.0 samples/s | 25.9 steps/s
[Step=20350 Epoch=78.3] | Loss=0.00044 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.791 | FP-Norm(final)=2.710 | 3809.8 samples/s | 59.5 steps/s
[Step=20400 Epoch=78.5] | Loss=0.00038 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.776 | FP-Norm(final)=2.711 | 3841.9 samples/s | 60.0 steps/s
[Step=20450 Epoch=78.7] | Loss=0.00034 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.761 | FP-Norm(final)=2.711 | 3761.3 samples/s | 58.8 steps/s
[Step=20500 Epoch=78.9] | Loss=0.00031 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.747 | FP-Norm(final)=2.711 | 4246.2 samples/s | 66.3 steps/s
[Step=20550 Epoch=79.1] | Loss=0.00028 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.734 | FP-Norm(final)=2.711 | 1716.4 samples/s | 26.8 steps/s
[Step=20600 Epoch=79.3] | Loss=0.00026 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.722 | FP-Norm(final)=2.711 | 3764.2 samples/s | 58.8 steps/s
[Step=20650 Epoch=79.5] | Loss=0.00024 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.710 | FP-Norm(final)=2.711 | 3705.6 samples/s | 57.9 steps/s
[Step=20700 Epoch=79.7] | Loss=0.00023 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.699 | FP-Norm(final)=2.711 | 3669.8 samples/s | 57.3 steps/s
[Step=20750 Epoch=79.9] | Loss=0.00021 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.689 | FP-Norm(final)=2.711 | 3862.9 samples/s | 60.4 steps/s
[Step=20800 Epoch=80.1] | Loss=0.00020 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.679 | FP-Norm(final)=2.711 | 1805.0 samples/s | 28.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26694 | acc=0.8481 | tpr=0.7839 | fpr=0.0124 | 3853.9 samples/s | 15.1 steps/s
Avg test loss: 0.27188, Avg test acc: 0.84762, Avg tpr: 0.78522, Avg fpr: 0.01513, total FA: 118

Testing server on iccad2012
[Step=  50] | Loss=0.36333 | acc=0.8600 | tpr=0.9690 | fpr=0.1420 | 3887.2 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.36139 | acc=0.8647 | tpr=0.9765 | fpr=0.1374 | 7077.1 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.36964 | acc=0.8631 | tpr=0.9784 | fpr=0.1390 | 7317.9 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.37399 | acc=0.8624 | tpr=0.9792 | fpr=0.1397 | 7418.9 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.37042 | acc=0.8624 | tpr=0.9773 | fpr=0.1397 | 6932.2 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.37255 | acc=0.8626 | tpr=0.9731 | fpr=0.1394 | 7269.4 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.37634 | acc=0.8618 | tpr=0.9731 | fpr=0.1402 | 7240.2 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.37722 | acc=0.8614 | tpr=0.9699 | fpr=0.1406 | 7127.3 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.37970 | acc=0.8614 | tpr=0.9698 | fpr=0.1406 | 7269.5 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.37975 | acc=0.8614 | tpr=0.9705 | fpr=0.1406 | 7227.3 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.37879 | acc=0.8617 | tpr=0.9690 | fpr=0.1403 | 13190.4 samples/s | 51.5 steps/s
Avg test loss: 0.37862, Avg test acc: 0.86173, Avg tpr: 0.96870, Avg fpr: 0.14021, total FA: 19468

server round 26/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=40.6] | Loss=0.11674 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.714 | 3617.2 samples/s | 56.5 steps/s
[Step=20850 Epoch=40.7] | Loss=0.02513 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.653 | FP-Norm(final)=2.705 | 3663.3 samples/s | 57.2 steps/s
[Step=20900 Epoch=40.8] | Loss=0.01763 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.681 | FP-Norm(final)=2.706 | 4000.4 samples/s | 62.5 steps/s
[Step=20950 Epoch=40.9] | Loss=0.01548 | Reg=0.00049 | acc=0.9688 | FP-Norm=0.690 | FP-Norm(final)=2.707 | 4009.8 samples/s | 62.7 steps/s
[Step=21000 Epoch=41.0] | Loss=0.01456 | Reg=0.00049 | acc=0.9844 | FP-Norm=0.690 | FP-Norm(final)=2.708 | 4004.2 samples/s | 62.6 steps/s
[Step=21050 Epoch=41.1] | Loss=0.01415 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.694 | FP-Norm(final)=2.709 | 4006.0 samples/s | 62.6 steps/s
[Step=21100 Epoch=41.2] | Loss=0.01347 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.695 | FP-Norm(final)=2.710 | 4014.1 samples/s | 62.7 steps/s
[Step=21150 Epoch=41.3] | Loss=0.01299 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.696 | FP-Norm(final)=2.710 | 4039.6 samples/s | 63.1 steps/s
[Step=21200 Epoch=41.3] | Loss=0.01281 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.699 | FP-Norm(final)=2.711 | 4018.3 samples/s | 62.8 steps/s
[Step=21250 Epoch=41.4] | Loss=0.01251 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.701 | FP-Norm(final)=2.711 | 4000.5 samples/s | 62.5 steps/s
[Step=21300 Epoch=41.5] | Loss=0.01248 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.704 | FP-Norm(final)=2.711 | 4743.0 samples/s | 74.1 steps/s
[Step=21350 Epoch=41.6] | Loss=0.01208 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.705 | FP-Norm(final)=2.712 | 1673.1 samples/s | 26.1 steps/s
[Step=21400 Epoch=41.7] | Loss=0.01179 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.706 | FP-Norm(final)=2.712 | 3871.5 samples/s | 60.5 steps/s
[Step=21450 Epoch=41.8] | Loss=0.01128 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.705 | FP-Norm(final)=2.713 | 3928.4 samples/s | 61.4 steps/s
[Step=21500 Epoch=41.9] | Loss=0.01118 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.706 | FP-Norm(final)=2.714 | 3877.1 samples/s | 60.6 steps/s
[Step=21550 Epoch=42.0] | Loss=0.01107 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.706 | FP-Norm(final)=2.715 | 3916.8 samples/s | 61.2 steps/s
[Step=21600 Epoch=42.1] | Loss=0.01093 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.707 | FP-Norm(final)=2.715 | 3889.9 samples/s | 60.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step21600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=40.7] | Loss=0.16645 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.714 | 3646.7 samples/s | 57.0 steps/s
[Step=20850 Epoch=40.8] | Loss=0.02580 | Reg=0.00050 | acc=0.9688 | FP-Norm=0.678 | FP-Norm(final)=2.707 | 3919.9 samples/s | 61.2 steps/s
[Step=20900 Epoch=40.9] | Loss=0.01775 | Reg=0.00050 | acc=0.9688 | FP-Norm=0.694 | FP-Norm(final)=2.706 | 3906.6 samples/s | 61.0 steps/s
[Step=20950 Epoch=41.0] | Loss=0.01453 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.690 | FP-Norm(final)=2.707 | 3889.8 samples/s | 60.8 steps/s
[Step=21000 Epoch=41.1] | Loss=0.01283 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.710 | 3881.5 samples/s | 60.6 steps/s
[Step=21050 Epoch=41.2] | Loss=0.01215 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.684 | FP-Norm(final)=2.712 | 3897.3 samples/s | 60.9 steps/s
[Step=21100 Epoch=41.2] | Loss=0.01179 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.684 | FP-Norm(final)=2.714 | 3905.6 samples/s | 61.0 steps/s
[Step=21150 Epoch=41.3] | Loss=0.01178 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.685 | FP-Norm(final)=2.715 | 3905.0 samples/s | 61.0 steps/s
[Step=21200 Epoch=41.4] | Loss=0.01194 | Reg=0.00048 | acc=0.9844 | FP-Norm=0.686 | FP-Norm(final)=2.716 | 3936.4 samples/s | 61.5 steps/s
[Step=21250 Epoch=41.5] | Loss=0.01200 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.689 | FP-Norm(final)=2.716 | 3897.4 samples/s | 60.9 steps/s
[Step=21300 Epoch=41.6] | Loss=0.01188 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.692 | FP-Norm(final)=2.717 | 4602.5 samples/s | 71.9 steps/s
[Step=21350 Epoch=41.7] | Loss=0.01153 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.695 | FP-Norm(final)=2.718 | 1713.6 samples/s | 26.8 steps/s
[Step=21400 Epoch=41.8] | Loss=0.01133 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.698 | FP-Norm(final)=2.719 | 3888.3 samples/s | 60.8 steps/s
[Step=21450 Epoch=41.9] | Loss=0.01102 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.701 | FP-Norm(final)=2.720 | 3894.4 samples/s | 60.9 steps/s
[Step=21500 Epoch=42.0] | Loss=0.01085 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.704 | FP-Norm(final)=2.720 | 3888.9 samples/s | 60.8 steps/s
[Step=21550 Epoch=42.1] | Loss=0.01066 | Reg=0.00050 | acc=0.9688 | FP-Norm=0.707 | FP-Norm(final)=2.721 | 3906.6 samples/s | 61.0 steps/s
[Step=21600 Epoch=42.2] | Loss=0.01062 | Reg=0.00051 | acc=0.9844 | FP-Norm=0.709 | FP-Norm(final)=2.722 | 3936.3 samples/s | 61.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step21600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=79.7] | Loss=0.04304 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.714 | 3708.2 samples/s | 57.9 steps/s
[Step=20850 Epoch=79.9] | Loss=0.00444 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.842 | FP-Norm(final)=2.715 | 3610.8 samples/s | 56.4 steps/s
[Step=20900 Epoch=80.1] | Loss=0.00229 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.878 | FP-Norm(final)=2.717 | 3809.9 samples/s | 59.5 steps/s
[Step=20950 Epoch=80.3] | Loss=0.00154 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.860 | FP-Norm(final)=2.718 | 3782.4 samples/s | 59.1 steps/s
[Step=21000 Epoch=80.5] | Loss=0.00116 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.837 | FP-Norm(final)=2.718 | 3793.7 samples/s | 59.3 steps/s
[Step=21050 Epoch=80.7] | Loss=0.00093 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.814 | FP-Norm(final)=2.719 | 4598.7 samples/s | 71.9 steps/s
[Step=21100 Epoch=80.8] | Loss=0.00078 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.719 | 1650.1 samples/s | 25.8 steps/s
[Step=21150 Epoch=81.0] | Loss=0.00067 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.719 | 3677.8 samples/s | 57.5 steps/s
[Step=21200 Epoch=81.2] | Loss=0.00059 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.757 | FP-Norm(final)=2.719 | 3705.6 samples/s | 57.9 steps/s
[Step=21250 Epoch=81.4] | Loss=0.00053 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.741 | FP-Norm(final)=2.720 | 3712.2 samples/s | 58.0 steps/s
[Step=21300 Epoch=81.6] | Loss=0.00048 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.726 | FP-Norm(final)=2.720 | 4003.8 samples/s | 62.6 steps/s
[Step=21350 Epoch=81.8] | Loss=0.00044 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.712 | FP-Norm(final)=2.720 | 1748.4 samples/s | 27.3 steps/s
[Step=21400 Epoch=82.0] | Loss=0.00040 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.700 | FP-Norm(final)=2.720 | 3780.6 samples/s | 59.1 steps/s
[Step=21450 Epoch=82.2] | Loss=0.00037 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.687 | FP-Norm(final)=2.721 | 3793.0 samples/s | 59.3 steps/s
[Step=21500 Epoch=82.4] | Loss=0.00035 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.676 | FP-Norm(final)=2.721 | 3766.8 samples/s | 58.9 steps/s
[Step=21550 Epoch=82.6] | Loss=0.00033 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.665 | FP-Norm(final)=2.721 | 3702.4 samples/s | 57.8 steps/s
[Step=21600 Epoch=82.8] | Loss=0.00031 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.655 | FP-Norm(final)=2.721 | 1784.8 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step21600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=80.1] | Loss=0.01760 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.714 | 3527.5 samples/s | 55.1 steps/s
[Step=20850 Epoch=80.3] | Loss=0.00453 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.903 | FP-Norm(final)=2.718 | 3715.3 samples/s | 58.1 steps/s
[Step=20900 Epoch=80.5] | Loss=0.00229 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.958 | FP-Norm(final)=2.720 | 3775.9 samples/s | 59.0 steps/s
[Step=20950 Epoch=80.6] | Loss=0.00155 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.948 | FP-Norm(final)=2.720 | 3709.5 samples/s | 58.0 steps/s
[Step=21000 Epoch=80.8] | Loss=0.00119 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.930 | FP-Norm(final)=2.721 | 3724.3 samples/s | 58.2 steps/s
[Step=21050 Epoch=81.0] | Loss=0.00096 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.911 | FP-Norm(final)=2.721 | 4558.5 samples/s | 71.2 steps/s
[Step=21100 Epoch=81.2] | Loss=0.00081 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.893 | FP-Norm(final)=2.722 | 1659.6 samples/s | 25.9 steps/s
[Step=21150 Epoch=81.4] | Loss=0.00069 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.876 | FP-Norm(final)=2.722 | 3705.6 samples/s | 57.9 steps/s
[Step=21200 Epoch=81.6] | Loss=0.00061 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.859 | FP-Norm(final)=2.722 | 3745.7 samples/s | 58.5 steps/s
[Step=21250 Epoch=81.8] | Loss=0.00054 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.843 | FP-Norm(final)=2.722 | 3823.7 samples/s | 59.7 steps/s
[Step=21300 Epoch=82.0] | Loss=0.00049 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.828 | FP-Norm(final)=2.722 | 4171.8 samples/s | 65.2 steps/s
[Step=21350 Epoch=82.2] | Loss=0.00045 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.814 | FP-Norm(final)=2.723 | 1729.4 samples/s | 27.0 steps/s
[Step=21400 Epoch=82.4] | Loss=0.00041 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.723 | 3779.3 samples/s | 59.1 steps/s
[Step=21450 Epoch=82.6] | Loss=0.00038 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.788 | FP-Norm(final)=2.723 | 3773.9 samples/s | 59.0 steps/s
[Step=21500 Epoch=82.8] | Loss=0.00036 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.776 | FP-Norm(final)=2.723 | 3814.3 samples/s | 59.6 steps/s
[Step=21550 Epoch=83.0] | Loss=0.00034 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.764 | FP-Norm(final)=2.723 | 3884.6 samples/s | 60.7 steps/s
[Step=21600 Epoch=83.1] | Loss=0.00032 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.753 | FP-Norm(final)=2.723 | 1761.1 samples/s | 27.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27273 | acc=0.8464 | tpr=0.7815 | fpr=0.0126 | 3903.9 samples/s | 15.2 steps/s
Avg test loss: 0.27795, Avg test acc: 0.84598, Avg tpr: 0.78254, Avg fpr: 0.01449, total FA: 113

Testing server on iccad2012
[Step=  50] | Loss=0.33908 | acc=0.8733 | tpr=0.9690 | fpr=0.1284 | 3868.9 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.33935 | acc=0.8770 | tpr=0.9744 | fpr=0.1248 | 7259.4 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.34702 | acc=0.8751 | tpr=0.9741 | fpr=0.1268 | 7278.5 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.35180 | acc=0.8746 | tpr=0.9749 | fpr=0.1273 | 7362.6 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.34769 | acc=0.8748 | tpr=0.9747 | fpr=0.1270 | 7396.2 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.35011 | acc=0.8749 | tpr=0.9724 | fpr=0.1268 | 7073.1 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.35430 | acc=0.8739 | tpr=0.9724 | fpr=0.1279 | 7099.6 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.35500 | acc=0.8735 | tpr=0.9688 | fpr=0.1282 | 7846.0 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.35743 | acc=0.8732 | tpr=0.9679 | fpr=0.1285 | 6848.0 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.35733 | acc=0.8731 | tpr=0.9687 | fpr=0.1287 | 7195.8 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.35650 | acc=0.8732 | tpr=0.9670 | fpr=0.1285 | 13096.0 samples/s | 51.2 steps/s
Avg test loss: 0.35631, Avg test acc: 0.87322, Avg tpr: 0.96672, Avg fpr: 0.12848, total FA: 17839

server round 27/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=42.1] | Loss=0.19066 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.727 | 3549.5 samples/s | 55.5 steps/s
[Step=21650 Epoch=42.2] | Loss=0.02348 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.715 | FP-Norm(final)=2.720 | 3728.1 samples/s | 58.3 steps/s
[Step=21700 Epoch=42.3] | Loss=0.01714 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.741 | FP-Norm(final)=2.718 | 3870.6 samples/s | 60.5 steps/s
[Step=21750 Epoch=42.4] | Loss=0.01583 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.740 | FP-Norm(final)=2.719 | 3865.1 samples/s | 60.4 steps/s
[Step=21800 Epoch=42.5] | Loss=0.01460 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.733 | FP-Norm(final)=2.719 | 3906.4 samples/s | 61.0 steps/s
[Step=21850 Epoch=42.6] | Loss=0.01333 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.727 | FP-Norm(final)=2.720 | 3921.3 samples/s | 61.3 steps/s
[Step=21900 Epoch=42.7] | Loss=0.01268 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.724 | FP-Norm(final)=2.721 | 3903.5 samples/s | 61.0 steps/s
[Step=21950 Epoch=42.8] | Loss=0.01238 | Reg=0.00053 | acc=0.9844 | FP-Norm=0.721 | FP-Norm(final)=2.721 | 3890.7 samples/s | 60.8 steps/s
[Step=22000 Epoch=42.9] | Loss=0.01237 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.721 | FP-Norm(final)=2.722 | 3918.3 samples/s | 61.2 steps/s
[Step=22050 Epoch=43.0] | Loss=0.01201 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.720 | FP-Norm(final)=2.723 | 3888.0 samples/s | 60.7 steps/s
[Step=22100 Epoch=43.1] | Loss=0.01176 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.719 | FP-Norm(final)=2.724 | 4632.1 samples/s | 72.4 steps/s
[Step=22150 Epoch=43.2] | Loss=0.01134 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.718 | FP-Norm(final)=2.724 | 1660.0 samples/s | 25.9 steps/s
[Step=22200 Epoch=43.3] | Loss=0.01117 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.717 | FP-Norm(final)=2.725 | 3892.4 samples/s | 60.8 steps/s
[Step=22250 Epoch=43.4] | Loss=0.01101 | Reg=0.00052 | acc=0.9844 | FP-Norm=0.717 | FP-Norm(final)=2.726 | 3886.4 samples/s | 60.7 steps/s
[Step=22300 Epoch=43.5] | Loss=0.01083 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.717 | FP-Norm(final)=2.726 | 3889.5 samples/s | 60.8 steps/s
[Step=22350 Epoch=43.6] | Loss=0.01056 | Reg=0.00052 | acc=0.9844 | FP-Norm=0.717 | FP-Norm(final)=2.727 | 3905.9 samples/s | 61.0 steps/s
[Step=22400 Epoch=43.7] | Loss=0.01058 | Reg=0.00052 | acc=0.9844 | FP-Norm=0.717 | FP-Norm(final)=2.728 | 3923.4 samples/s | 61.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step22400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=42.2] | Loss=0.19000 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.727 | 3485.8 samples/s | 54.5 steps/s
[Step=21650 Epoch=42.3] | Loss=0.02653 | Reg=0.00048 | acc=0.9688 | FP-Norm=0.665 | FP-Norm(final)=2.718 | 4061.9 samples/s | 63.5 steps/s
[Step=21700 Epoch=42.4] | Loss=0.01944 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.692 | FP-Norm(final)=2.717 | 4003.5 samples/s | 62.6 steps/s
[Step=21750 Epoch=42.5] | Loss=0.01564 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.696 | FP-Norm(final)=2.718 | 3918.2 samples/s | 61.2 steps/s
[Step=21800 Epoch=42.6] | Loss=0.01396 | Reg=0.00049 | acc=0.9844 | FP-Norm=0.691 | FP-Norm(final)=2.720 | 3915.3 samples/s | 61.2 steps/s
[Step=21850 Epoch=42.7] | Loss=0.01258 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.685 | FP-Norm(final)=2.722 | 3901.9 samples/s | 61.0 steps/s
[Step=21900 Epoch=42.8] | Loss=0.01178 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.684 | FP-Norm(final)=2.724 | 3905.9 samples/s | 61.0 steps/s
[Step=21950 Epoch=42.9] | Loss=0.01219 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.687 | FP-Norm(final)=2.726 | 3877.9 samples/s | 60.6 steps/s
[Step=22000 Epoch=43.0] | Loss=0.01163 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.690 | FP-Norm(final)=2.727 | 3922.9 samples/s | 61.3 steps/s
[Step=22050 Epoch=43.1] | Loss=0.01133 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.692 | FP-Norm(final)=2.729 | 3859.0 samples/s | 60.3 steps/s
[Step=22100 Epoch=43.2] | Loss=0.01105 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.694 | FP-Norm(final)=2.730 | 4675.8 samples/s | 73.1 steps/s
[Step=22150 Epoch=43.3] | Loss=0.01089 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.696 | FP-Norm(final)=2.731 | 1715.3 samples/s | 26.8 steps/s
[Step=22200 Epoch=43.4] | Loss=0.01084 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.697 | FP-Norm(final)=2.732 | 3888.9 samples/s | 60.8 steps/s
[Step=22250 Epoch=43.5] | Loss=0.01089 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.699 | FP-Norm(final)=2.733 | 3864.4 samples/s | 60.4 steps/s
[Step=22300 Epoch=43.6] | Loss=0.01050 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.701 | FP-Norm(final)=2.733 | 3890.3 samples/s | 60.8 steps/s
[Step=22350 Epoch=43.7] | Loss=0.01027 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.702 | FP-Norm(final)=2.734 | 3934.5 samples/s | 61.5 steps/s
[Step=22400 Epoch=43.8] | Loss=0.01016 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.703 | FP-Norm(final)=2.735 | 3880.2 samples/s | 60.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step22400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=82.8] | Loss=0.04403 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.727 | 3667.5 samples/s | 57.3 steps/s
[Step=21650 Epoch=83.0] | Loss=0.00214 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.702 | FP-Norm(final)=2.735 | 3589.2 samples/s | 56.1 steps/s
[Step=21700 Epoch=83.1] | Loss=0.00110 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.722 | FP-Norm(final)=2.736 | 3815.2 samples/s | 59.6 steps/s
[Step=21750 Epoch=83.3] | Loss=0.00079 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.707 | FP-Norm(final)=2.737 | 3801.2 samples/s | 59.4 steps/s
[Step=21800 Epoch=83.5] | Loss=0.00060 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.693 | FP-Norm(final)=2.738 | 3828.5 samples/s | 59.8 steps/s
[Step=21850 Epoch=83.7] | Loss=0.00049 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.676 | FP-Norm(final)=2.738 | 4591.5 samples/s | 71.7 steps/s
[Step=21900 Epoch=83.9] | Loss=0.00041 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.661 | FP-Norm(final)=2.738 | 1674.2 samples/s | 26.2 steps/s
[Step=21950 Epoch=84.1] | Loss=0.00035 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.646 | FP-Norm(final)=2.739 | 3778.0 samples/s | 59.0 steps/s
[Step=22000 Epoch=84.3] | Loss=0.00031 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.632 | FP-Norm(final)=2.739 | 3790.2 samples/s | 59.2 steps/s
[Step=22050 Epoch=84.5] | Loss=0.00028 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.619 | FP-Norm(final)=2.739 | 3749.6 samples/s | 58.6 steps/s
[Step=22100 Epoch=84.7] | Loss=0.00026 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.607 | FP-Norm(final)=2.739 | 4051.8 samples/s | 63.3 steps/s
[Step=22150 Epoch=84.9] | Loss=0.00023 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.739 | 1737.3 samples/s | 27.1 steps/s
[Step=22200 Epoch=85.1] | Loss=0.00022 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.585 | FP-Norm(final)=2.739 | 3717.6 samples/s | 58.1 steps/s
[Step=22250 Epoch=85.3] | Loss=0.00020 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.739 | 3692.0 samples/s | 57.7 steps/s
[Step=22300 Epoch=85.4] | Loss=0.00019 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.740 | 3693.3 samples/s | 57.7 steps/s
[Step=22350 Epoch=85.6] | Loss=0.00018 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.740 | 3708.4 samples/s | 57.9 steps/s
[Step=22400 Epoch=85.8] | Loss=0.00017 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.740 | 1790.2 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step22400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=83.2] | Loss=0.04351 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.727 | 3602.5 samples/s | 56.3 steps/s
[Step=21650 Epoch=83.3] | Loss=0.00301 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.794 | FP-Norm(final)=2.734 | 3683.0 samples/s | 57.5 steps/s
[Step=21700 Epoch=83.5] | Loss=0.00153 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.861 | FP-Norm(final)=2.736 | 3701.4 samples/s | 57.8 steps/s
[Step=21750 Epoch=83.7] | Loss=0.00121 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.867 | FP-Norm(final)=2.737 | 3680.8 samples/s | 57.5 steps/s
[Step=21800 Epoch=83.9] | Loss=0.00091 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.856 | FP-Norm(final)=2.737 | 3711.3 samples/s | 58.0 steps/s
[Step=21850 Epoch=84.1] | Loss=0.00073 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.841 | FP-Norm(final)=2.737 | 4580.8 samples/s | 71.6 steps/s
[Step=21900 Epoch=84.3] | Loss=0.00061 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.825 | FP-Norm(final)=2.737 | 1672.1 samples/s | 26.1 steps/s
[Step=21950 Epoch=84.5] | Loss=0.00053 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.737 | 3730.8 samples/s | 58.3 steps/s
[Step=22000 Epoch=84.7] | Loss=0.00046 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.737 | 3711.3 samples/s | 58.0 steps/s
[Step=22050 Epoch=84.9] | Loss=0.00042 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.779 | FP-Norm(final)=2.737 | 3681.9 samples/s | 57.5 steps/s
[Step=22100 Epoch=85.1] | Loss=0.00038 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.737 | 4118.7 samples/s | 64.4 steps/s
[Step=22150 Epoch=85.3] | Loss=0.00034 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.753 | FP-Norm(final)=2.737 | 1711.4 samples/s | 26.7 steps/s
[Step=22200 Epoch=85.5] | Loss=0.00032 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.740 | FP-Norm(final)=2.737 | 3743.5 samples/s | 58.5 steps/s
[Step=22250 Epoch=85.6] | Loss=0.00029 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.729 | FP-Norm(final)=2.737 | 3708.3 samples/s | 57.9 steps/s
[Step=22300 Epoch=85.8] | Loss=0.00027 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.718 | FP-Norm(final)=2.737 | 3659.7 samples/s | 57.2 steps/s
[Step=22350 Epoch=86.0] | Loss=0.00026 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.707 | FP-Norm(final)=2.738 | 3768.0 samples/s | 58.9 steps/s
[Step=22400 Epoch=86.2] | Loss=0.00024 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.697 | FP-Norm(final)=2.738 | 1763.4 samples/s | 27.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22841 | acc=0.8712 | tpr=0.8180 | fpr=0.0131 | 3832.1 samples/s | 15.0 steps/s
Avg test loss: 0.23456, Avg test acc: 0.87086, Avg tpr: 0.81932, Avg fpr: 0.01577, total FA: 123

Testing server on iccad2012
[Step=  50] | Loss=0.39480 | acc=0.8528 | tpr=0.9646 | fpr=0.1492 | 3857.7 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.39510 | acc=0.8558 | tpr=0.9744 | fpr=0.1464 | 7306.8 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.40350 | acc=0.8536 | tpr=0.9755 | fpr=0.1486 | 7266.2 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.40808 | acc=0.8530 | tpr=0.9770 | fpr=0.1492 | 7251.5 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.40427 | acc=0.8532 | tpr=0.9782 | fpr=0.1490 | 7312.7 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.40650 | acc=0.8530 | tpr=0.9753 | fpr=0.1492 | 7276.3 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.41100 | acc=0.8523 | tpr=0.9750 | fpr=0.1499 | 7074.4 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.41177 | acc=0.8520 | tpr=0.9716 | fpr=0.1502 | 7445.6 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.41414 | acc=0.8515 | tpr=0.9698 | fpr=0.1506 | 6910.2 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.41426 | acc=0.8516 | tpr=0.9705 | fpr=0.1506 | 7140.8 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.41340 | acc=0.8517 | tpr=0.9694 | fpr=0.1505 | 12116.6 samples/s | 47.3 steps/s
Avg test loss: 0.41322, Avg test acc: 0.85172, Avg tpr: 0.96910, Avg fpr: 0.15041, total FA: 20884

server round 28/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=43.7] | Loss=0.08614 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.740 | 3541.7 samples/s | 55.3 steps/s
[Step=22450 Epoch=43.8] | Loss=0.02185 | Reg=0.00044 | acc=0.9844 | FP-Norm=0.632 | FP-Norm(final)=2.734 | 3821.9 samples/s | 59.7 steps/s
[Step=22500 Epoch=43.9] | Loss=0.01610 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.667 | FP-Norm(final)=2.734 | 3954.5 samples/s | 61.8 steps/s
[Step=22550 Epoch=44.0] | Loss=0.01396 | Reg=0.00046 | acc=0.9844 | FP-Norm=0.668 | FP-Norm(final)=2.735 | 4014.3 samples/s | 62.7 steps/s
[Step=22600 Epoch=44.1] | Loss=0.01311 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.675 | FP-Norm(final)=2.735 | 3961.7 samples/s | 61.9 steps/s
[Step=22650 Epoch=44.2] | Loss=0.01280 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.678 | FP-Norm(final)=2.736 | 3945.5 samples/s | 61.6 steps/s
[Step=22700 Epoch=44.3] | Loss=0.01242 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.679 | FP-Norm(final)=2.737 | 3891.4 samples/s | 60.8 steps/s
[Step=22750 Epoch=44.4] | Loss=0.01229 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.683 | FP-Norm(final)=2.738 | 3915.0 samples/s | 61.2 steps/s
[Step=22800 Epoch=44.5] | Loss=0.01201 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.738 | 3892.8 samples/s | 60.8 steps/s
[Step=22850 Epoch=44.6] | Loss=0.01180 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.689 | FP-Norm(final)=2.739 | 3881.8 samples/s | 60.7 steps/s
[Step=22900 Epoch=44.7] | Loss=0.01187 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.691 | FP-Norm(final)=2.739 | 4622.5 samples/s | 72.2 steps/s
[Step=22950 Epoch=44.8] | Loss=0.01157 | Reg=0.00048 | acc=0.9844 | FP-Norm=0.693 | FP-Norm(final)=2.740 | 1683.5 samples/s | 26.3 steps/s
[Step=23000 Epoch=44.9] | Loss=0.01122 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.695 | FP-Norm(final)=2.740 | 3974.5 samples/s | 62.1 steps/s
[Step=23050 Epoch=45.0] | Loss=0.01097 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.695 | FP-Norm(final)=2.740 | 3970.0 samples/s | 62.0 steps/s
[Step=23100 Epoch=45.1] | Loss=0.01075 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.696 | FP-Norm(final)=2.741 | 4005.0 samples/s | 62.6 steps/s
[Step=23150 Epoch=45.2] | Loss=0.01063 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.698 | FP-Norm(final)=2.742 | 3984.6 samples/s | 62.3 steps/s
[Step=23200 Epoch=45.2] | Loss=0.01061 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.699 | FP-Norm(final)=2.742 | 3988.5 samples/s | 62.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step23200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=43.8] | Loss=0.06830 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.741 | 4238.4 samples/s | 66.2 steps/s
[Step=22450 Epoch=43.9] | Loss=0.01955 | Reg=0.00033 | acc=0.9688 | FP-Norm=0.548 | FP-Norm(final)=2.741 | 3391.5 samples/s | 53.0 steps/s
[Step=22500 Epoch=44.0] | Loss=0.01434 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.598 | FP-Norm(final)=2.742 | 3895.2 samples/s | 60.9 steps/s
[Step=22550 Epoch=44.1] | Loss=0.01264 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.613 | FP-Norm(final)=2.743 | 3889.0 samples/s | 60.8 steps/s
[Step=22600 Epoch=44.2] | Loss=0.01244 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.745 | 3899.6 samples/s | 60.9 steps/s
[Step=22650 Epoch=44.3] | Loss=0.01153 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.630 | FP-Norm(final)=2.746 | 3904.5 samples/s | 61.0 steps/s
[Step=22700 Epoch=44.4] | Loss=0.01150 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.634 | FP-Norm(final)=2.747 | 3933.3 samples/s | 61.5 steps/s
[Step=22750 Epoch=44.5] | Loss=0.01121 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.639 | FP-Norm(final)=2.747 | 3913.8 samples/s | 61.2 steps/s
[Step=22800 Epoch=44.6] | Loss=0.01081 | Reg=0.00042 | acc=0.9844 | FP-Norm=0.643 | FP-Norm(final)=2.748 | 3906.3 samples/s | 61.0 steps/s
[Step=22850 Epoch=44.7] | Loss=0.01085 | Reg=0.00042 | acc=0.9844 | FP-Norm=0.646 | FP-Norm(final)=2.749 | 3889.7 samples/s | 60.8 steps/s
[Step=22900 Epoch=44.8] | Loss=0.01070 | Reg=0.00043 | acc=0.9688 | FP-Norm=0.650 | FP-Norm(final)=2.750 | 4638.0 samples/s | 72.5 steps/s
[Step=22950 Epoch=44.9] | Loss=0.01037 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.657 | FP-Norm(final)=2.750 | 1705.5 samples/s | 26.6 steps/s
[Step=23000 Epoch=45.0] | Loss=0.01039 | Reg=0.00044 | acc=0.9688 | FP-Norm=0.662 | FP-Norm(final)=2.751 | 3883.5 samples/s | 60.7 steps/s
[Step=23050 Epoch=45.1] | Loss=0.01026 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.665 | FP-Norm(final)=2.751 | 3895.9 samples/s | 60.9 steps/s
[Step=23100 Epoch=45.2] | Loss=0.01020 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.669 | FP-Norm(final)=2.752 | 3888.4 samples/s | 60.8 steps/s
[Step=23150 Epoch=45.3] | Loss=0.01004 | Reg=0.00046 | acc=0.9688 | FP-Norm=0.673 | FP-Norm(final)=2.752 | 3892.1 samples/s | 60.8 steps/s
[Step=23200 Epoch=45.4] | Loss=0.00993 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.676 | FP-Norm(final)=2.753 | 3910.8 samples/s | 61.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step23200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=85.8] | Loss=0.20820 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.740 | 3520.1 samples/s | 55.0 steps/s
[Step=22450 Epoch=86.0] | Loss=0.00531 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.007 | FP-Norm(final)=2.742 | 3701.6 samples/s | 57.8 steps/s
[Step=22500 Epoch=86.2] | Loss=0.00276 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.051 | FP-Norm(final)=2.743 | 3687.0 samples/s | 57.6 steps/s
[Step=22550 Epoch=86.4] | Loss=0.00191 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.041 | FP-Norm(final)=2.743 | 3666.7 samples/s | 57.3 steps/s
[Step=22600 Epoch=86.6] | Loss=0.00145 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.024 | FP-Norm(final)=2.744 | 3713.4 samples/s | 58.0 steps/s
[Step=22650 Epoch=86.8] | Loss=0.00117 | Reg=0.00103 | acc=1.0000 | FP-Norm=1.004 | FP-Norm(final)=2.744 | 4542.6 samples/s | 71.0 steps/s
[Step=22700 Epoch=87.0] | Loss=0.00098 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.985 | FP-Norm(final)=2.745 | 1665.2 samples/s | 26.0 steps/s
[Step=22750 Epoch=87.2] | Loss=0.00084 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.966 | FP-Norm(final)=2.745 | 3807.9 samples/s | 59.5 steps/s
[Step=22800 Epoch=87.4] | Loss=0.00074 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.948 | FP-Norm(final)=2.745 | 3795.8 samples/s | 59.3 steps/s
[Step=22850 Epoch=87.6] | Loss=0.00066 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.931 | FP-Norm(final)=2.745 | 3813.3 samples/s | 59.6 steps/s
[Step=22900 Epoch=87.7] | Loss=0.00059 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.914 | FP-Norm(final)=2.745 | 4009.3 samples/s | 62.6 steps/s
[Step=22950 Epoch=87.9] | Loss=0.00054 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.899 | FP-Norm(final)=2.745 | 1758.3 samples/s | 27.5 steps/s
[Step=23000 Epoch=88.1] | Loss=0.00050 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.885 | FP-Norm(final)=2.745 | 3781.3 samples/s | 59.1 steps/s
[Step=23050 Epoch=88.3] | Loss=0.00046 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.746 | 3778.5 samples/s | 59.0 steps/s
[Step=23100 Epoch=88.5] | Loss=0.00043 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.858 | FP-Norm(final)=2.746 | 3744.6 samples/s | 58.5 steps/s
[Step=23150 Epoch=88.7] | Loss=0.00040 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.845 | FP-Norm(final)=2.746 | 3715.6 samples/s | 58.1 steps/s
[Step=23200 Epoch=88.9] | Loss=0.00038 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.833 | FP-Norm(final)=2.746 | 1772.9 samples/s | 27.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step23200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=86.2] | Loss=0.19560 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.740 | 3604.4 samples/s | 56.3 steps/s
[Step=22450 Epoch=86.4] | Loss=0.00653 | Reg=0.00108 | acc=1.0000 | FP-Norm=0.995 | FP-Norm(final)=2.741 | 3587.4 samples/s | 56.1 steps/s
[Step=22500 Epoch=86.6] | Loss=0.00332 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.046 | FP-Norm(final)=2.742 | 3731.7 samples/s | 58.3 steps/s
[Step=22550 Epoch=86.8] | Loss=0.00223 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.034 | FP-Norm(final)=2.743 | 3705.8 samples/s | 57.9 steps/s
[Step=22600 Epoch=87.0] | Loss=0.00169 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.013 | FP-Norm(final)=2.743 | 3706.2 samples/s | 57.9 steps/s
[Step=22650 Epoch=87.2] | Loss=0.00138 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.992 | FP-Norm(final)=2.744 | 4507.8 samples/s | 70.4 steps/s
[Step=22700 Epoch=87.4] | Loss=0.00115 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.971 | FP-Norm(final)=2.744 | 1661.9 samples/s | 26.0 steps/s
[Step=22750 Epoch=87.6] | Loss=0.00099 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.951 | FP-Norm(final)=2.745 | 3694.8 samples/s | 57.7 steps/s
[Step=22800 Epoch=87.8] | Loss=0.00087 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.931 | FP-Norm(final)=2.745 | 3672.2 samples/s | 57.4 steps/s
[Step=22850 Epoch=88.0] | Loss=0.00077 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.913 | FP-Norm(final)=2.745 | 3703.3 samples/s | 57.9 steps/s
[Step=22900 Epoch=88.2] | Loss=0.00070 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.896 | FP-Norm(final)=2.745 | 4124.6 samples/s | 64.4 steps/s
[Step=22950 Epoch=88.3] | Loss=0.00063 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.880 | FP-Norm(final)=2.745 | 1698.5 samples/s | 26.5 steps/s
[Step=23000 Epoch=88.5] | Loss=0.00058 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.865 | FP-Norm(final)=2.745 | 3703.1 samples/s | 57.9 steps/s
[Step=23050 Epoch=88.7] | Loss=0.00054 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.851 | FP-Norm(final)=2.745 | 3722.5 samples/s | 58.2 steps/s
[Step=23100 Epoch=88.9] | Loss=0.00050 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.838 | FP-Norm(final)=2.745 | 3673.5 samples/s | 57.4 steps/s
[Step=23150 Epoch=89.1] | Loss=0.00047 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.825 | FP-Norm(final)=2.745 | 3775.1 samples/s | 59.0 steps/s
[Step=23200 Epoch=89.3] | Loss=0.00044 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.745 | 1790.3 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31259 | acc=0.8232 | tpr=0.7465 | fpr=0.0102 | 3759.1 samples/s | 14.7 steps/s
Avg test loss: 0.31703, Avg test acc: 0.82206, Avg tpr: 0.74698, Avg fpr: 0.01282, total FA: 100

Testing server on iccad2012
[Step=  50] | Loss=0.30192 | acc=0.8968 | tpr=0.9646 | fpr=0.1044 | 3848.2 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.30377 | acc=0.8984 | tpr=0.9680 | fpr=0.1029 | 7506.9 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.31098 | acc=0.8959 | tpr=0.9683 | fpr=0.1055 | 7225.8 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.31516 | acc=0.8950 | tpr=0.9705 | fpr=0.1063 | 7338.9 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.31138 | acc=0.8954 | tpr=0.9712 | fpr=0.1060 | 7151.0 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.31365 | acc=0.8953 | tpr=0.9702 | fpr=0.1061 | 7566.5 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.31735 | acc=0.8945 | tpr=0.9706 | fpr=0.1069 | 7241.9 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.31823 | acc=0.8941 | tpr=0.9683 | fpr=0.1073 | 7393.0 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.32043 | acc=0.8937 | tpr=0.9664 | fpr=0.1076 | 7115.4 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.31997 | acc=0.8936 | tpr=0.9674 | fpr=0.1077 | 7267.6 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.31911 | acc=0.8937 | tpr=0.9662 | fpr=0.1076 | 13595.1 samples/s | 53.1 steps/s
Avg test loss: 0.31898, Avg test acc: 0.89376, Avg tpr: 0.96593, Avg fpr: 0.10756, total FA: 14934

server round 29/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=45.3] | Loss=0.23479 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.751 | 3784.1 samples/s | 59.1 steps/s
[Step=23250 Epoch=45.3] | Loss=0.02857 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.773 | FP-Norm(final)=2.744 | 3444.5 samples/s | 53.8 steps/s
[Step=23300 Epoch=45.4] | Loss=0.01913 | Reg=0.00067 | acc=0.9844 | FP-Norm=0.800 | FP-Norm(final)=2.743 | 4000.5 samples/s | 62.5 steps/s
[Step=23350 Epoch=45.5] | Loss=0.01664 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.792 | FP-Norm(final)=2.744 | 3992.3 samples/s | 62.4 steps/s
[Step=23400 Epoch=45.6] | Loss=0.01510 | Reg=0.00063 | acc=0.9844 | FP-Norm=0.782 | FP-Norm(final)=2.744 | 3981.5 samples/s | 62.2 steps/s
[Step=23450 Epoch=45.7] | Loss=0.01360 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.745 | 3990.3 samples/s | 62.3 steps/s
[Step=23500 Epoch=45.8] | Loss=0.01363 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.746 | 3892.7 samples/s | 60.8 steps/s
[Step=23550 Epoch=45.9] | Loss=0.01320 | Reg=0.00060 | acc=0.9688 | FP-Norm=0.769 | FP-Norm(final)=2.746 | 3903.4 samples/s | 61.0 steps/s
[Step=23600 Epoch=46.0] | Loss=0.01357 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.768 | FP-Norm(final)=2.746 | 3880.9 samples/s | 60.6 steps/s
[Step=23650 Epoch=46.1] | Loss=0.01299 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.746 | 3918.1 samples/s | 61.2 steps/s
[Step=23700 Epoch=46.2] | Loss=0.01255 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.763 | FP-Norm(final)=2.746 | 4602.5 samples/s | 71.9 steps/s
[Step=23750 Epoch=46.3] | Loss=0.01222 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.760 | FP-Norm(final)=2.747 | 1661.1 samples/s | 26.0 steps/s
[Step=23800 Epoch=46.4] | Loss=0.01163 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.758 | FP-Norm(final)=2.747 | 3849.4 samples/s | 60.1 steps/s
[Step=23850 Epoch=46.5] | Loss=0.01134 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.755 | FP-Norm(final)=2.748 | 3905.0 samples/s | 61.0 steps/s
[Step=23900 Epoch=46.6] | Loss=0.01095 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.754 | FP-Norm(final)=2.749 | 3899.1 samples/s | 60.9 steps/s
[Step=23950 Epoch=46.7] | Loss=0.01072 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.752 | FP-Norm(final)=2.750 | 3959.1 samples/s | 61.9 steps/s
[Step=24000 Epoch=46.8] | Loss=0.01064 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.751 | FP-Norm(final)=2.751 | 3903.7 samples/s | 61.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=45.4] | Loss=0.23057 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.750 | 3649.4 samples/s | 57.0 steps/s
[Step=23250 Epoch=45.5] | Loss=0.02585 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.774 | FP-Norm(final)=2.747 | 3993.6 samples/s | 62.4 steps/s
[Step=23300 Epoch=45.6] | Loss=0.01847 | Reg=0.00069 | acc=0.9844 | FP-Norm=0.810 | FP-Norm(final)=2.747 | 3999.8 samples/s | 62.5 steps/s
[Step=23350 Epoch=45.6] | Loss=0.01469 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.747 | 4016.0 samples/s | 62.7 steps/s
[Step=23400 Epoch=45.7] | Loss=0.01399 | Reg=0.00064 | acc=0.9531 | FP-Norm=0.789 | FP-Norm(final)=2.749 | 4000.0 samples/s | 62.5 steps/s
[Step=23450 Epoch=45.8] | Loss=0.01332 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.784 | FP-Norm(final)=2.750 | 4000.2 samples/s | 62.5 steps/s
[Step=23500 Epoch=45.9] | Loss=0.01256 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.779 | FP-Norm(final)=2.751 | 4020.0 samples/s | 62.8 steps/s
[Step=23550 Epoch=46.0] | Loss=0.01214 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.776 | FP-Norm(final)=2.752 | 4012.6 samples/s | 62.7 steps/s
[Step=23600 Epoch=46.1] | Loss=0.01195 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.773 | FP-Norm(final)=2.753 | 4006.9 samples/s | 62.6 steps/s
[Step=23650 Epoch=46.2] | Loss=0.01185 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.754 | 4002.0 samples/s | 62.5 steps/s
[Step=23700 Epoch=46.3] | Loss=0.01158 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.771 | FP-Norm(final)=2.755 | 4791.6 samples/s | 74.9 steps/s
[Step=23750 Epoch=46.4] | Loss=0.01117 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.755 | 1709.7 samples/s | 26.7 steps/s
[Step=23800 Epoch=46.5] | Loss=0.01088 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.770 | FP-Norm(final)=2.756 | 3900.2 samples/s | 60.9 steps/s
[Step=23850 Epoch=46.6] | Loss=0.01041 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.768 | FP-Norm(final)=2.757 | 3879.7 samples/s | 60.6 steps/s
[Step=23900 Epoch=46.7] | Loss=0.01022 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.766 | FP-Norm(final)=2.758 | 3878.9 samples/s | 60.6 steps/s
[Step=23950 Epoch=46.8] | Loss=0.01007 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.759 | 3885.8 samples/s | 60.7 steps/s
[Step=24000 Epoch=46.9] | Loss=0.00997 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.765 | FP-Norm(final)=2.760 | 3891.8 samples/s | 60.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step24000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=88.9] | Loss=0.04466 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.751 | 3799.1 samples/s | 59.4 steps/s
[Step=23250 Epoch=89.1] | Loss=0.00344 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.761 | FP-Norm(final)=2.756 | 3529.4 samples/s | 55.1 steps/s
[Step=23300 Epoch=89.3] | Loss=0.00201 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.758 | 3752.7 samples/s | 58.6 steps/s
[Step=23350 Epoch=89.5] | Loss=0.00136 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.840 | FP-Norm(final)=2.759 | 3716.7 samples/s | 58.1 steps/s
[Step=23400 Epoch=89.7] | Loss=0.00111 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.833 | FP-Norm(final)=2.760 | 3698.6 samples/s | 57.8 steps/s
[Step=23450 Epoch=89.9] | Loss=0.00092 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.827 | FP-Norm(final)=2.761 | 4522.0 samples/s | 70.7 steps/s
[Step=23500 Epoch=90.0] | Loss=0.00078 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.761 | 1666.0 samples/s | 26.0 steps/s
[Step=23550 Epoch=90.2] | Loss=0.00067 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.811 | FP-Norm(final)=2.762 | 3702.1 samples/s | 57.8 steps/s
[Step=23600 Epoch=90.4] | Loss=0.00059 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.762 | 3704.3 samples/s | 57.9 steps/s
[Step=23650 Epoch=90.6] | Loss=0.00053 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.791 | FP-Norm(final)=2.762 | 3692.3 samples/s | 57.7 steps/s
[Step=23700 Epoch=90.8] | Loss=0.00048 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.762 | 4043.2 samples/s | 63.2 steps/s
[Step=23750 Epoch=91.0] | Loss=0.00043 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.770 | FP-Norm(final)=2.762 | 1718.8 samples/s | 26.9 steps/s
[Step=23800 Epoch=91.2] | Loss=0.00040 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.759 | FP-Norm(final)=2.762 | 3699.5 samples/s | 57.8 steps/s
[Step=23850 Epoch=91.4] | Loss=0.00037 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.749 | FP-Norm(final)=2.763 | 3701.3 samples/s | 57.8 steps/s
[Step=23900 Epoch=91.6] | Loss=0.00035 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.739 | FP-Norm(final)=2.763 | 3671.0 samples/s | 57.4 steps/s
[Step=23950 Epoch=91.8] | Loss=0.00032 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.730 | FP-Norm(final)=2.763 | 3696.2 samples/s | 57.8 steps/s
[Step=24000 Epoch=92.0] | Loss=0.00030 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.721 | FP-Norm(final)=2.763 | 1803.8 samples/s | 28.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step24000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=89.3] | Loss=0.01033 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.751 | 3568.9 samples/s | 55.8 steps/s
[Step=23250 Epoch=89.5] | Loss=0.00361 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.763 | FP-Norm(final)=2.758 | 3678.8 samples/s | 57.5 steps/s
[Step=23300 Epoch=89.7] | Loss=0.00183 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.824 | FP-Norm(final)=2.760 | 3732.9 samples/s | 58.3 steps/s
[Step=23350 Epoch=89.9] | Loss=0.00123 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.761 | 3700.2 samples/s | 57.8 steps/s
[Step=23400 Epoch=90.1] | Loss=0.00094 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.799 | FP-Norm(final)=2.761 | 3657.3 samples/s | 57.1 steps/s
[Step=23450 Epoch=90.3] | Loss=0.00076 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.782 | FP-Norm(final)=2.761 | 4574.0 samples/s | 71.5 steps/s
[Step=23500 Epoch=90.5] | Loss=0.00063 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.762 | 1646.0 samples/s | 25.7 steps/s
[Step=23550 Epoch=90.7] | Loss=0.00055 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.749 | FP-Norm(final)=2.762 | 3713.3 samples/s | 58.0 steps/s
[Step=23600 Epoch=90.8] | Loss=0.00048 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.734 | FP-Norm(final)=2.762 | 3770.1 samples/s | 58.9 steps/s
[Step=23650 Epoch=91.0] | Loss=0.00043 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.720 | FP-Norm(final)=2.762 | 3763.5 samples/s | 58.8 steps/s
[Step=23700 Epoch=91.2] | Loss=0.00039 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.707 | FP-Norm(final)=2.762 | 4137.6 samples/s | 64.6 steps/s
[Step=23750 Epoch=91.4] | Loss=0.00035 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.694 | FP-Norm(final)=2.762 | 1728.3 samples/s | 27.0 steps/s
[Step=23800 Epoch=91.6] | Loss=0.00033 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.683 | FP-Norm(final)=2.762 | 3752.6 samples/s | 58.6 steps/s
[Step=23850 Epoch=91.8] | Loss=0.00030 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.672 | FP-Norm(final)=2.762 | 3735.9 samples/s | 58.4 steps/s
[Step=23900 Epoch=92.0] | Loss=0.00028 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.662 | FP-Norm(final)=2.763 | 3695.3 samples/s | 57.7 steps/s
[Step=23950 Epoch=92.2] | Loss=0.00027 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.652 | FP-Norm(final)=2.763 | 3767.1 samples/s | 58.9 steps/s
[Step=24000 Epoch=92.4] | Loss=0.00025 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.642 | FP-Norm(final)=2.763 | 1777.4 samples/s | 27.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23169 | acc=0.8693 | tpr=0.8144 | fpr=0.0114 | 3838.6 samples/s | 15.0 steps/s
Avg test loss: 0.23728, Avg test acc: 0.86882, Avg tpr: 0.81576, Avg fpr: 0.01449, total FA: 113

Testing server on iccad2012
[Step=  50] | Loss=0.39680 | acc=0.8504 | tpr=0.9558 | fpr=0.1515 | 3846.1 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.39600 | acc=0.8529 | tpr=0.9638 | fpr=0.1491 | 7292.4 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.40394 | acc=0.8513 | tpr=0.9654 | fpr=0.1508 | 7388.8 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.40817 | acc=0.8512 | tpr=0.9672 | fpr=0.1510 | 7404.6 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.40481 | acc=0.8515 | tpr=0.9694 | fpr=0.1506 | 7151.2 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.40707 | acc=0.8513 | tpr=0.9680 | fpr=0.1508 | 7309.8 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.41132 | acc=0.8507 | tpr=0.9681 | fpr=0.1514 | 7151.4 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.41206 | acc=0.8504 | tpr=0.9655 | fpr=0.1517 | 7472.7 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.41447 | acc=0.8501 | tpr=0.9645 | fpr=0.1519 | 7334.4 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.41408 | acc=0.8502 | tpr=0.9656 | fpr=0.1519 | 7210.5 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.41314 | acc=0.8503 | tpr=0.9642 | fpr=0.1518 | 13623.4 samples/s | 53.2 steps/s
Avg test loss: 0.41306, Avg test acc: 0.85030, Avg tpr: 0.96355, Avg fpr: 0.15176, total FA: 21072

server round 30/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=46.8] | Loss=0.06482 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.765 | 3702.6 samples/s | 57.9 steps/s
[Step=24050 Epoch=46.9] | Loss=0.02388 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.474 | FP-Norm(final)=2.764 | 3560.2 samples/s | 55.6 steps/s
[Step=24100 Epoch=47.0] | Loss=0.01513 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.765 | 3871.0 samples/s | 60.5 steps/s
[Step=24150 Epoch=47.1] | Loss=0.01185 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.492 | FP-Norm(final)=2.766 | 3889.7 samples/s | 60.8 steps/s
[Step=24200 Epoch=47.2] | Loss=0.01087 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=2.768 | 3895.4 samples/s | 60.9 steps/s
[Step=24250 Epoch=47.3] | Loss=0.01024 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.488 | FP-Norm(final)=2.769 | 3913.3 samples/s | 61.1 steps/s
[Step=24300 Epoch=47.4] | Loss=0.00962 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=2.770 | 3924.6 samples/s | 61.3 steps/s
[Step=24350 Epoch=47.5] | Loss=0.00940 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=2.771 | 3896.7 samples/s | 60.9 steps/s
[Step=24400 Epoch=47.6] | Loss=0.00932 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.485 | FP-Norm(final)=2.772 | 3985.8 samples/s | 62.3 steps/s
[Step=24450 Epoch=47.7] | Loss=0.00916 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.487 | FP-Norm(final)=2.773 | 4047.9 samples/s | 63.2 steps/s
[Step=24500 Epoch=47.8] | Loss=0.00891 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.774 | 4656.4 samples/s | 72.8 steps/s
[Step=24550 Epoch=47.9] | Loss=0.00874 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.775 | 1656.6 samples/s | 25.9 steps/s
[Step=24600 Epoch=48.0] | Loss=0.00846 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=2.775 | 3875.3 samples/s | 60.6 steps/s
[Step=24650 Epoch=48.1] | Loss=0.00829 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.776 | 3902.4 samples/s | 61.0 steps/s
[Step=24700 Epoch=48.2] | Loss=0.00809 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.777 | 3885.8 samples/s | 60.7 steps/s
[Step=24750 Epoch=48.3] | Loss=0.00794 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=2.778 | 3897.6 samples/s | 60.9 steps/s
[Step=24800 Epoch=48.4] | Loss=0.00786 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=2.779 | 3895.4 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step24800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=46.9] | Loss=0.12660 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.765 | 3612.8 samples/s | 56.4 steps/s
[Step=24050 Epoch=47.0] | Loss=0.02232 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.423 | FP-Norm(final)=2.764 | 3983.6 samples/s | 62.2 steps/s
[Step=24100 Epoch=47.1] | Loss=0.01564 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=2.764 | 3990.0 samples/s | 62.3 steps/s
[Step=24150 Epoch=47.2] | Loss=0.01297 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.461 | FP-Norm(final)=2.765 | 3974.0 samples/s | 62.1 steps/s
[Step=24200 Epoch=47.3] | Loss=0.01148 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=2.766 | 3998.7 samples/s | 62.5 steps/s
[Step=24250 Epoch=47.4] | Loss=0.01057 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.465 | FP-Norm(final)=2.767 | 4041.8 samples/s | 63.2 steps/s
[Step=24300 Epoch=47.5] | Loss=0.00986 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=2.768 | 4002.7 samples/s | 62.5 steps/s
[Step=24350 Epoch=47.6] | Loss=0.00913 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=2.769 | 3993.9 samples/s | 62.4 steps/s
[Step=24400 Epoch=47.7] | Loss=0.00883 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.770 | 3995.3 samples/s | 62.4 steps/s
[Step=24450 Epoch=47.8] | Loss=0.00871 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.463 | FP-Norm(final)=2.772 | 3986.7 samples/s | 62.3 steps/s
[Step=24500 Epoch=47.9] | Loss=0.00860 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=2.773 | 4665.1 samples/s | 72.9 steps/s
[Step=24550 Epoch=48.0] | Loss=0.00827 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.460 | FP-Norm(final)=2.774 | 1706.6 samples/s | 26.7 steps/s
[Step=24600 Epoch=48.1] | Loss=0.00809 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.460 | FP-Norm(final)=2.775 | 3899.7 samples/s | 60.9 steps/s
[Step=24650 Epoch=48.2] | Loss=0.00783 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.461 | FP-Norm(final)=2.777 | 3898.8 samples/s | 60.9 steps/s
[Step=24700 Epoch=48.3] | Loss=0.00766 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.462 | FP-Norm(final)=2.778 | 3833.6 samples/s | 59.9 steps/s
[Step=24750 Epoch=48.4] | Loss=0.00751 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.463 | FP-Norm(final)=2.779 | 3987.7 samples/s | 62.3 steps/s
[Step=24800 Epoch=48.5] | Loss=0.00738 | Reg=0.00022 | acc=0.9688 | FP-Norm=0.463 | FP-Norm(final)=2.780 | 4026.2 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step24800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=92.0] | Loss=0.06118 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.765 | 3513.6 samples/s | 54.9 steps/s
[Step=24050 Epoch=92.2] | Loss=0.00562 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.769 | 3803.1 samples/s | 59.4 steps/s
[Step=24100 Epoch=92.3] | Loss=0.00284 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.714 | FP-Norm(final)=2.770 | 3805.3 samples/s | 59.5 steps/s
[Step=24150 Epoch=92.5] | Loss=0.00191 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.705 | FP-Norm(final)=2.770 | 3807.8 samples/s | 59.5 steps/s
[Step=24200 Epoch=92.7] | Loss=0.00144 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.692 | FP-Norm(final)=2.770 | 3783.9 samples/s | 59.1 steps/s
[Step=24250 Epoch=92.9] | Loss=0.00116 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.679 | FP-Norm(final)=2.771 | 4658.3 samples/s | 72.8 steps/s
[Step=24300 Epoch=93.1] | Loss=0.00097 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.667 | FP-Norm(final)=2.771 | 1658.1 samples/s | 25.9 steps/s
[Step=24350 Epoch=93.3] | Loss=0.00084 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.655 | FP-Norm(final)=2.771 | 3686.5 samples/s | 57.6 steps/s
[Step=24400 Epoch=93.5] | Loss=0.00074 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.644 | FP-Norm(final)=2.771 | 3714.7 samples/s | 58.0 steps/s
[Step=24450 Epoch=93.7] | Loss=0.00066 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.634 | FP-Norm(final)=2.771 | 3679.2 samples/s | 57.5 steps/s
[Step=24500 Epoch=93.9] | Loss=0.00060 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.771 | 4049.2 samples/s | 63.3 steps/s
[Step=24550 Epoch=94.1] | Loss=0.00054 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.615 | FP-Norm(final)=2.771 | 1735.5 samples/s | 27.1 steps/s
[Step=24600 Epoch=94.3] | Loss=0.00050 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.606 | FP-Norm(final)=2.771 | 3796.4 samples/s | 59.3 steps/s
[Step=24650 Epoch=94.5] | Loss=0.00046 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.598 | FP-Norm(final)=2.771 | 3820.3 samples/s | 59.7 steps/s
[Step=24700 Epoch=94.6] | Loss=0.00043 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.771 | 3801.2 samples/s | 59.4 steps/s
[Step=24750 Epoch=94.8] | Loss=0.00041 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.771 | 3796.8 samples/s | 59.3 steps/s
[Step=24800 Epoch=95.0] | Loss=0.00038 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.771 | 1801.0 samples/s | 28.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step24800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=92.4] | Loss=0.06791 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.765 | 3676.7 samples/s | 57.4 steps/s
[Step=24050 Epoch=92.6] | Loss=0.00605 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.649 | FP-Norm(final)=2.764 | 3751.5 samples/s | 58.6 steps/s
[Step=24100 Epoch=92.8] | Loss=0.00309 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.681 | FP-Norm(final)=2.765 | 3784.7 samples/s | 59.1 steps/s
[Step=24150 Epoch=93.0] | Loss=0.00208 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.677 | FP-Norm(final)=2.766 | 3749.4 samples/s | 58.6 steps/s
[Step=24200 Epoch=93.2] | Loss=0.00159 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.668 | FP-Norm(final)=2.766 | 3700.5 samples/s | 57.8 steps/s
[Step=24250 Epoch=93.3] | Loss=0.00128 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.658 | FP-Norm(final)=2.767 | 4599.1 samples/s | 71.9 steps/s
[Step=24300 Epoch=93.5] | Loss=0.00108 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.647 | FP-Norm(final)=2.767 | 1650.8 samples/s | 25.8 steps/s
[Step=24350 Epoch=93.7] | Loss=0.00093 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.636 | FP-Norm(final)=2.767 | 3700.0 samples/s | 57.8 steps/s
[Step=24400 Epoch=93.9] | Loss=0.00082 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.626 | FP-Norm(final)=2.767 | 3696.7 samples/s | 57.8 steps/s
[Step=24450 Epoch=94.1] | Loss=0.00073 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.617 | FP-Norm(final)=2.768 | 3705.9 samples/s | 57.9 steps/s
[Step=24500 Epoch=94.3] | Loss=0.00066 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.608 | FP-Norm(final)=2.768 | 4124.7 samples/s | 64.4 steps/s
[Step=24550 Epoch=94.5] | Loss=0.00060 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.599 | FP-Norm(final)=2.768 | 1717.7 samples/s | 26.8 steps/s
[Step=24600 Epoch=94.7] | Loss=0.00055 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.768 | 3825.2 samples/s | 59.8 steps/s
[Step=24650 Epoch=94.9] | Loss=0.00051 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.584 | FP-Norm(final)=2.769 | 3714.2 samples/s | 58.0 steps/s
[Step=24700 Epoch=95.1] | Loss=0.00048 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.769 | 3695.4 samples/s | 57.7 steps/s
[Step=24750 Epoch=95.3] | Loss=0.00045 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.769 | 3775.9 samples/s | 59.0 steps/s
[Step=24800 Epoch=95.5] | Loss=0.00042 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.769 | 1772.9 samples/s | 27.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27864 | acc=0.8428 | tpr=0.7754 | fpr=0.0109 | 3847.0 samples/s | 15.0 steps/s
Avg test loss: 0.28419, Avg test acc: 0.84278, Avg tpr: 0.77747, Avg fpr: 0.01359, total FA: 106

Testing server on iccad2012
[Step=  50] | Loss=0.33350 | acc=0.8848 | tpr=0.9558 | fpr=0.1164 | 3899.1 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.33531 | acc=0.8874 | tpr=0.9680 | fpr=0.1141 | 7096.5 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.34252 | acc=0.8854 | tpr=0.9697 | fpr=0.1162 | 7502.2 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.34705 | acc=0.8846 | tpr=0.9716 | fpr=0.1170 | 7027.4 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.34331 | acc=0.8851 | tpr=0.9721 | fpr=0.1165 | 7355.6 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.34565 | acc=0.8850 | tpr=0.9702 | fpr=0.1165 | 7245.8 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.34939 | acc=0.8843 | tpr=0.9699 | fpr=0.1173 | 7457.2 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.35036 | acc=0.8837 | tpr=0.9661 | fpr=0.1178 | 7252.3 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.35282 | acc=0.8832 | tpr=0.9659 | fpr=0.1183 | 7143.5 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.35239 | acc=0.8831 | tpr=0.9670 | fpr=0.1184 | 7370.5 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.35141 | acc=0.8833 | tpr=0.9650 | fpr=0.1181 | 13155.0 samples/s | 51.4 steps/s
Avg test loss: 0.35125, Avg test acc: 0.88336, Avg tpr: 0.96474, Avg fpr: 0.11812, total FA: 16401

server round 31/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=48.4] | Loss=0.08778 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.783 | 3442.6 samples/s | 53.8 steps/s
[Step=24850 Epoch=48.5] | Loss=0.02737 | Reg=0.00023 | acc=0.9531 | FP-Norm=0.457 | FP-Norm(final)=2.781 | 3891.9 samples/s | 60.8 steps/s
[Step=24900 Epoch=48.6] | Loss=0.01747 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=2.781 | 3867.6 samples/s | 60.4 steps/s
[Step=24950 Epoch=48.7] | Loss=0.01422 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.495 | FP-Norm(final)=2.782 | 3891.8 samples/s | 60.8 steps/s
[Step=25000 Epoch=48.8] | Loss=0.01304 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.498 | FP-Norm(final)=2.782 | 3890.2 samples/s | 60.8 steps/s
[Step=25050 Epoch=48.9] | Loss=0.01164 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=2.783 | 3919.4 samples/s | 61.2 steps/s
[Step=25100 Epoch=49.0] | Loss=0.01095 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=2.784 | 3887.4 samples/s | 60.7 steps/s
[Step=25150 Epoch=49.1] | Loss=0.01034 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.500 | FP-Norm(final)=2.785 | 3910.2 samples/s | 61.1 steps/s
[Step=25200 Epoch=49.1] | Loss=0.00982 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.786 | 3907.9 samples/s | 61.1 steps/s
[Step=25250 Epoch=49.2] | Loss=0.00944 | Reg=0.00025 | acc=0.9688 | FP-Norm=0.500 | FP-Norm(final)=2.787 | 3930.0 samples/s | 61.4 steps/s
[Step=25300 Epoch=49.3] | Loss=0.00926 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.501 | FP-Norm(final)=2.789 | 4596.8 samples/s | 71.8 steps/s
[Step=25350 Epoch=49.4] | Loss=0.00886 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.790 | 1664.8 samples/s | 26.0 steps/s
[Step=25400 Epoch=49.5] | Loss=0.00862 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.791 | 3876.1 samples/s | 60.6 steps/s
[Step=25450 Epoch=49.6] | Loss=0.00837 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.792 | 3901.3 samples/s | 61.0 steps/s
[Step=25500 Epoch=49.7] | Loss=0.00818 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.500 | FP-Norm(final)=2.793 | 3875.8 samples/s | 60.6 steps/s
[Step=25550 Epoch=49.8] | Loss=0.00810 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.500 | FP-Norm(final)=2.794 | 3897.2 samples/s | 60.9 steps/s
[Step=25600 Epoch=49.9] | Loss=0.00780 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.795 | 3912.4 samples/s | 61.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step25600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=48.5] | Loss=0.22172 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.783 | 3809.8 samples/s | 59.5 steps/s
[Step=24850 Epoch=48.6] | Loss=0.03335 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=2.779 | 3797.5 samples/s | 59.3 steps/s
[Step=24900 Epoch=48.7] | Loss=0.01991 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.778 | 3906.8 samples/s | 61.0 steps/s
[Step=24950 Epoch=48.8] | Loss=0.01551 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.779 | 3914.9 samples/s | 61.2 steps/s
[Step=25000 Epoch=48.9] | Loss=0.01311 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.537 | FP-Norm(final)=2.781 | 3889.4 samples/s | 60.8 steps/s
[Step=25050 Epoch=49.0] | Loss=0.01200 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.782 | 3903.0 samples/s | 61.0 steps/s
[Step=25100 Epoch=49.1] | Loss=0.01111 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.533 | FP-Norm(final)=2.783 | 3873.9 samples/s | 60.5 steps/s
[Step=25150 Epoch=49.2] | Loss=0.01041 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.785 | 3933.6 samples/s | 61.5 steps/s
[Step=25200 Epoch=49.3] | Loss=0.01009 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=2.786 | 3895.0 samples/s | 60.9 steps/s
[Step=25250 Epoch=49.4] | Loss=0.00979 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.525 | FP-Norm(final)=2.787 | 3894.2 samples/s | 60.8 steps/s
[Step=25300 Epoch=49.5] | Loss=0.00947 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.522 | FP-Norm(final)=2.788 | 4683.5 samples/s | 73.2 steps/s
[Step=25350 Epoch=49.6] | Loss=0.00906 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.520 | FP-Norm(final)=2.788 | 1706.9 samples/s | 26.7 steps/s
[Step=25400 Epoch=49.7] | Loss=0.00874 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.789 | 3903.7 samples/s | 61.0 steps/s
[Step=25450 Epoch=49.8] | Loss=0.00840 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=2.790 | 3866.7 samples/s | 60.4 steps/s
[Step=25500 Epoch=49.9] | Loss=0.00825 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=2.791 | 3894.6 samples/s | 60.9 steps/s
[Step=25550 Epoch=49.9] | Loss=0.00816 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=2.792 | 3902.0 samples/s | 61.0 steps/s
[Step=25600 Epoch=50.0] | Loss=0.00807 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.514 | FP-Norm(final)=2.793 | 3877.8 samples/s | 60.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step25600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=95.0] | Loss=0.02118 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.783 | 3545.9 samples/s | 55.4 steps/s
[Step=24850 Epoch=95.2] | Loss=0.00491 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.784 | 3725.6 samples/s | 58.2 steps/s
[Step=24900 Epoch=95.4] | Loss=0.00252 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.785 | 3692.1 samples/s | 57.7 steps/s
[Step=24950 Epoch=95.6] | Loss=0.00169 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=2.786 | 3715.6 samples/s | 58.1 steps/s
[Step=25000 Epoch=95.8] | Loss=0.00128 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.786 | 3694.7 samples/s | 57.7 steps/s
[Step=25050 Epoch=96.0] | Loss=0.00103 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.786 | 4517.5 samples/s | 70.6 steps/s
[Step=25100 Epoch=96.2] | Loss=0.00087 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=2.787 | 1641.1 samples/s | 25.6 steps/s
[Step=25150 Epoch=96.4] | Loss=0.00075 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.787 | 3670.4 samples/s | 57.3 steps/s
[Step=25200 Epoch=96.6] | Loss=0.00066 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.787 | 3690.7 samples/s | 57.7 steps/s
[Step=25250 Epoch=96.7] | Loss=0.00059 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.787 | 3725.7 samples/s | 58.2 steps/s
[Step=25300 Epoch=96.9] | Loss=0.00053 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=2.787 | 4015.1 samples/s | 62.7 steps/s
[Step=25350 Epoch=97.1] | Loss=0.00049 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=2.788 | 1734.5 samples/s | 27.1 steps/s
[Step=25400 Epoch=97.3] | Loss=0.00045 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.788 | 3696.8 samples/s | 57.8 steps/s
[Step=25450 Epoch=97.5] | Loss=0.00042 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=2.788 | 3708.6 samples/s | 57.9 steps/s
[Step=25500 Epoch=97.7] | Loss=0.00039 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.788 | 3675.6 samples/s | 57.4 steps/s
[Step=25550 Epoch=97.9] | Loss=0.00036 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=2.788 | 3700.6 samples/s | 57.8 steps/s
[Step=25600 Epoch=98.1] | Loss=0.00034 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.788 | 1812.9 samples/s | 28.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step25600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=95.5] | Loss=0.03600 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.783 | 3848.1 samples/s | 60.1 steps/s
[Step=24850 Epoch=95.7] | Loss=0.00392 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=2.787 | 3527.1 samples/s | 55.1 steps/s
[Step=24900 Epoch=95.8] | Loss=0.00203 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.617 | FP-Norm(final)=2.788 | 3777.3 samples/s | 59.0 steps/s
[Step=24950 Epoch=96.0] | Loss=0.00136 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.789 | 3738.0 samples/s | 58.4 steps/s
[Step=25000 Epoch=96.2] | Loss=0.00104 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.619 | FP-Norm(final)=2.789 | 3713.8 samples/s | 58.0 steps/s
[Step=25050 Epoch=96.4] | Loss=0.00084 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.611 | FP-Norm(final)=2.789 | 4530.4 samples/s | 70.8 steps/s
[Step=25100 Epoch=96.6] | Loss=0.00071 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.602 | FP-Norm(final)=2.790 | 1649.4 samples/s | 25.8 steps/s
[Step=25150 Epoch=96.8] | Loss=0.00061 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=2.790 | 3818.5 samples/s | 59.7 steps/s
[Step=25200 Epoch=97.0] | Loss=0.00054 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.585 | FP-Norm(final)=2.790 | 3765.1 samples/s | 58.8 steps/s
[Step=25250 Epoch=97.2] | Loss=0.00048 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=2.790 | 3721.7 samples/s | 58.2 steps/s
[Step=25300 Epoch=97.4] | Loss=0.00043 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.790 | 4139.6 samples/s | 64.7 steps/s
[Step=25350 Epoch=97.6] | Loss=0.00040 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.790 | 1707.6 samples/s | 26.7 steps/s
[Step=25400 Epoch=97.8] | Loss=0.00036 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.790 | 3726.9 samples/s | 58.2 steps/s
[Step=25450 Epoch=98.0] | Loss=0.00034 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.790 | 3682.4 samples/s | 57.5 steps/s
[Step=25500 Epoch=98.2] | Loss=0.00032 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.790 | 3702.0 samples/s | 57.8 steps/s
[Step=25550 Epoch=98.4] | Loss=0.00030 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.791 | 3764.4 samples/s | 58.8 steps/s
[Step=25600 Epoch=98.5] | Loss=0.00028 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.791 | 1783.2 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24983 | acc=0.8642 | tpr=0.8073 | fpr=0.0121 | 3853.7 samples/s | 15.1 steps/s
Avg test loss: 0.25634, Avg test acc: 0.86373, Avg tpr: 0.80812, Avg fpr: 0.01397, total FA: 109

Testing server on iccad2012
[Step=  50] | Loss=0.36516 | acc=0.8732 | tpr=0.9558 | fpr=0.1283 | 3874.1 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.36672 | acc=0.8757 | tpr=0.9680 | fpr=0.1260 | 6957.4 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.37411 | acc=0.8737 | tpr=0.9697 | fpr=0.1281 | 6753.6 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.37910 | acc=0.8736 | tpr=0.9705 | fpr=0.1282 | 6287.8 samples/s | 24.6 steps/s
[Step= 250] | Loss=0.37544 | acc=0.8737 | tpr=0.9712 | fpr=0.1280 | 6007.5 samples/s | 23.5 steps/s
[Step= 300] | Loss=0.37785 | acc=0.8738 | tpr=0.9695 | fpr=0.1279 | 6125.1 samples/s | 23.9 steps/s
[Step= 350] | Loss=0.38204 | acc=0.8729 | tpr=0.9687 | fpr=0.1288 | 7037.6 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.38285 | acc=0.8725 | tpr=0.9650 | fpr=0.1291 | 7393.3 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.38540 | acc=0.8723 | tpr=0.9649 | fpr=0.1294 | 7232.5 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.38508 | acc=0.8722 | tpr=0.9661 | fpr=0.1295 | 6995.0 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.38397 | acc=0.8724 | tpr=0.9642 | fpr=0.1293 | 13161.8 samples/s | 51.4 steps/s
Avg test loss: 0.38383, Avg test acc: 0.87237, Avg tpr: 0.96395, Avg fpr: 0.12929, total FA: 17952

server round 32/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=49.9] | Loss=0.09182 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.799 | 3565.8 samples/s | 55.7 steps/s
[Step=25650 Epoch=50.0] | Loss=0.01853 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.463 | FP-Norm(final)=2.800 | 3638.4 samples/s | 56.8 steps/s
[Step=25700 Epoch=50.1] | Loss=0.01311 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.483 | FP-Norm(final)=2.800 | 4000.6 samples/s | 62.5 steps/s
[Step=25750 Epoch=50.2] | Loss=0.01131 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=2.800 | 3981.2 samples/s | 62.2 steps/s
[Step=25800 Epoch=50.3] | Loss=0.01068 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=2.801 | 4005.3 samples/s | 62.6 steps/s
[Step=25850 Epoch=50.4] | Loss=0.01047 | Reg=0.00024 | acc=0.9688 | FP-Norm=0.487 | FP-Norm(final)=2.802 | 3958.3 samples/s | 61.8 steps/s
[Step=25900 Epoch=50.5] | Loss=0.00971 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.488 | FP-Norm(final)=2.803 | 3875.4 samples/s | 60.6 steps/s
[Step=25950 Epoch=50.6] | Loss=0.00938 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.486 | FP-Norm(final)=2.803 | 3932.3 samples/s | 61.4 steps/s
[Step=26000 Epoch=50.7] | Loss=0.00886 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=2.804 | 3862.7 samples/s | 60.4 steps/s
[Step=26050 Epoch=50.8] | Loss=0.00871 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.484 | FP-Norm(final)=2.805 | 3889.7 samples/s | 60.8 steps/s
[Step=26100 Epoch=50.9] | Loss=0.00865 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.484 | FP-Norm(final)=2.805 | 4613.6 samples/s | 72.1 steps/s
[Step=26150 Epoch=51.0] | Loss=0.00835 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.484 | FP-Norm(final)=2.806 | 1679.2 samples/s | 26.2 steps/s
[Step=26200 Epoch=51.1] | Loss=0.00799 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.483 | FP-Norm(final)=2.807 | 3873.5 samples/s | 60.5 steps/s
[Step=26250 Epoch=51.2] | Loss=0.00789 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.483 | FP-Norm(final)=2.807 | 3880.4 samples/s | 60.6 steps/s
[Step=26300 Epoch=51.3] | Loss=0.00767 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.483 | FP-Norm(final)=2.808 | 3900.8 samples/s | 61.0 steps/s
[Step=26350 Epoch=51.4] | Loss=0.00760 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.484 | FP-Norm(final)=2.809 | 3881.0 samples/s | 60.6 steps/s
[Step=26400 Epoch=51.5] | Loss=0.00752 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.485 | FP-Norm(final)=2.810 | 3920.3 samples/s | 61.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step26400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=50.0] | Loss=0.05030 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.799 | 3861.7 samples/s | 60.3 steps/s
[Step=25650 Epoch=50.1] | Loss=0.02427 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.799 | 3656.7 samples/s | 57.1 steps/s
[Step=25700 Epoch=50.2] | Loss=0.01556 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.483 | FP-Norm(final)=2.798 | 3866.2 samples/s | 60.4 steps/s
[Step=25750 Epoch=50.3] | Loss=0.01226 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=2.799 | 3987.8 samples/s | 62.3 steps/s
[Step=25800 Epoch=50.4] | Loss=0.01136 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.478 | FP-Norm(final)=2.800 | 3974.5 samples/s | 62.1 steps/s
[Step=25850 Epoch=50.5] | Loss=0.01022 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.479 | FP-Norm(final)=2.801 | 3999.8 samples/s | 62.5 steps/s
[Step=25900 Epoch=50.6] | Loss=0.00955 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=2.802 | 3892.3 samples/s | 60.8 steps/s
[Step=25950 Epoch=50.7] | Loss=0.00914 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.474 | FP-Norm(final)=2.803 | 3899.1 samples/s | 60.9 steps/s
[Step=26000 Epoch=50.8] | Loss=0.00870 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.472 | FP-Norm(final)=2.804 | 3905.5 samples/s | 61.0 steps/s
[Step=26050 Epoch=50.9] | Loss=0.00856 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.471 | FP-Norm(final)=2.805 | 3929.9 samples/s | 61.4 steps/s
[Step=26100 Epoch=51.0] | Loss=0.00863 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.471 | FP-Norm(final)=2.806 | 4655.7 samples/s | 72.7 steps/s
[Step=26150 Epoch=51.1] | Loss=0.00828 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=2.807 | 1712.6 samples/s | 26.8 steps/s
[Step=26200 Epoch=51.2] | Loss=0.00809 | Reg=0.00022 | acc=0.9688 | FP-Norm=0.471 | FP-Norm(final)=2.808 | 4005.1 samples/s | 62.6 steps/s
[Step=26250 Epoch=51.3] | Loss=0.00789 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.470 | FP-Norm(final)=2.809 | 3997.1 samples/s | 62.5 steps/s
[Step=26300 Epoch=51.4] | Loss=0.00778 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=2.810 | 3977.3 samples/s | 62.1 steps/s
[Step=26350 Epoch=51.5] | Loss=0.00753 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.470 | FP-Norm(final)=2.810 | 4016.6 samples/s | 62.8 steps/s
[Step=26400 Epoch=51.6] | Loss=0.00736 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.470 | FP-Norm(final)=2.811 | 4009.8 samples/s | 62.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step26400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=98.1] | Loss=0.09065 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.799 | 3714.9 samples/s | 58.0 steps/s
[Step=25650 Epoch=98.3] | Loss=0.00585 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.649 | FP-Norm(final)=2.799 | 3635.4 samples/s | 56.8 steps/s
[Step=25700 Epoch=98.5] | Loss=0.00295 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.676 | FP-Norm(final)=2.799 | 3696.1 samples/s | 57.8 steps/s
[Step=25750 Epoch=98.7] | Loss=0.00198 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.668 | FP-Norm(final)=2.799 | 3704.6 samples/s | 57.9 steps/s
[Step=25800 Epoch=98.9] | Loss=0.00150 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.656 | FP-Norm(final)=2.800 | 3708.7 samples/s | 57.9 steps/s
[Step=25850 Epoch=99.0] | Loss=0.00121 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.644 | FP-Norm(final)=2.800 | 4500.4 samples/s | 70.3 steps/s
[Step=25900 Epoch=99.2] | Loss=0.00101 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.633 | FP-Norm(final)=2.800 | 1666.6 samples/s | 26.0 steps/s
[Step=25950 Epoch=99.4] | Loss=0.00087 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.622 | FP-Norm(final)=2.800 | 3651.3 samples/s | 57.1 steps/s
[Step=26000 Epoch=99.6] | Loss=0.00077 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.612 | FP-Norm(final)=2.800 | 3700.0 samples/s | 57.8 steps/s
[Step=26050 Epoch=99.8] | Loss=0.00068 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.603 | FP-Norm(final)=2.801 | 3710.7 samples/s | 58.0 steps/s
[Step=26100 Epoch=100.0] | Loss=0.00062 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=2.801 | 4031.9 samples/s | 63.0 steps/s
[Step=26150 Epoch=100.2] | Loss=0.00056 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.585 | FP-Norm(final)=2.801 | 1721.1 samples/s | 26.9 steps/s
[Step=26200 Epoch=100.4] | Loss=0.00052 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=2.801 | 3658.8 samples/s | 57.2 steps/s
[Step=26250 Epoch=100.6] | Loss=0.00048 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.801 | 3699.0 samples/s | 57.8 steps/s
[Step=26300 Epoch=100.8] | Loss=0.00045 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.801 | 3698.9 samples/s | 57.8 steps/s
[Step=26350 Epoch=101.0] | Loss=0.00042 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.801 | 3735.9 samples/s | 58.4 steps/s
[Step=26400 Epoch=101.2] | Loss=0.00039 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.549 | FP-Norm(final)=2.802 | 1793.0 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step26400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=98.5] | Loss=0.01459 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.800 | 3689.4 samples/s | 57.6 steps/s
[Step=25650 Epoch=98.7] | Loss=0.00724 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.684 | FP-Norm(final)=2.801 | 3528.3 samples/s | 55.1 steps/s
[Step=25700 Epoch=98.9] | Loss=0.00367 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.721 | FP-Norm(final)=2.801 | 3728.7 samples/s | 58.3 steps/s
[Step=25750 Epoch=99.1] | Loss=0.00247 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.717 | FP-Norm(final)=2.801 | 3693.9 samples/s | 57.7 steps/s
[Step=25800 Epoch=99.3] | Loss=0.00186 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.706 | FP-Norm(final)=2.802 | 3681.2 samples/s | 57.5 steps/s
[Step=25850 Epoch=99.5] | Loss=0.00151 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.695 | FP-Norm(final)=2.802 | 4607.9 samples/s | 72.0 steps/s
[Step=25900 Epoch=99.7] | Loss=0.00126 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.683 | FP-Norm(final)=2.802 | 1632.7 samples/s | 25.5 steps/s
[Step=25950 Epoch=99.9] | Loss=0.00109 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.672 | FP-Norm(final)=2.802 | 3717.4 samples/s | 58.1 steps/s
[Step=26000 Epoch=100.1] | Loss=0.00095 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.662 | FP-Norm(final)=2.802 | 3681.6 samples/s | 57.5 steps/s
[Step=26050 Epoch=100.3] | Loss=0.00085 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.652 | FP-Norm(final)=2.802 | 3666.0 samples/s | 57.3 steps/s
[Step=26100 Epoch=100.5] | Loss=0.00077 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.642 | FP-Norm(final)=2.802 | 4143.8 samples/s | 64.7 steps/s
[Step=26150 Epoch=100.7] | Loss=0.00070 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.633 | FP-Norm(final)=2.802 | 1721.7 samples/s | 26.9 steps/s
[Step=26200 Epoch=100.9] | Loss=0.00064 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.625 | FP-Norm(final)=2.802 | 3852.4 samples/s | 60.2 steps/s
[Step=26250 Epoch=101.0] | Loss=0.00059 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.617 | FP-Norm(final)=2.802 | 3777.1 samples/s | 59.0 steps/s
[Step=26300 Epoch=101.2] | Loss=0.00055 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.610 | FP-Norm(final)=2.802 | 3749.4 samples/s | 58.6 steps/s
[Step=26350 Epoch=101.4] | Loss=0.00052 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.602 | FP-Norm(final)=2.802 | 3772.4 samples/s | 58.9 steps/s
[Step=26400 Epoch=101.6] | Loss=0.00049 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.803 | 1797.9 samples/s | 28.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29380 | acc=0.8428 | tpr=0.7757 | fpr=0.0114 | 3903.5 samples/s | 15.2 steps/s
Avg test loss: 0.29960, Avg test acc: 0.84254, Avg tpr: 0.77700, Avg fpr: 0.01333, total FA: 104

Testing server on iccad2012
[Step=  50] | Loss=0.31637 | acc=0.8988 | tpr=0.9558 | fpr=0.1023 | 3892.9 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.31915 | acc=0.9003 | tpr=0.9659 | fpr=0.1010 | 6975.7 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.32678 | acc=0.8974 | tpr=0.9669 | fpr=0.1038 | 7230.3 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.33113 | acc=0.8969 | tpr=0.9683 | fpr=0.1044 | 7371.7 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.32719 | acc=0.8972 | tpr=0.9686 | fpr=0.1040 | 7452.5 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.33015 | acc=0.8972 | tpr=0.9673 | fpr=0.1041 | 7182.0 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.33395 | acc=0.8966 | tpr=0.9668 | fpr=0.1047 | 7464.0 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.33482 | acc=0.8960 | tpr=0.9633 | fpr=0.1052 | 7300.0 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.33745 | acc=0.8956 | tpr=0.9625 | fpr=0.1057 | 7020.8 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.33697 | acc=0.8954 | tpr=0.9634 | fpr=0.1058 | 7083.1 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.33592 | acc=0.8955 | tpr=0.9618 | fpr=0.1057 | 13357.2 samples/s | 52.2 steps/s
Avg test loss: 0.33576, Avg test acc: 0.89554, Avg tpr: 0.96157, Avg fpr: 0.10566, total FA: 14671

server round 33/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=51.5] | Loss=0.16301 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.813 | 3906.1 samples/s | 61.0 steps/s
[Step=26450 Epoch=51.6] | Loss=0.02265 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.488 | FP-Norm(final)=2.812 | 3425.8 samples/s | 53.5 steps/s
[Step=26500 Epoch=51.7] | Loss=0.01480 | Reg=0.00027 | acc=0.9688 | FP-Norm=0.507 | FP-Norm(final)=2.812 | 3881.7 samples/s | 60.7 steps/s
[Step=26550 Epoch=51.8] | Loss=0.01250 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=2.813 | 3914.3 samples/s | 61.2 steps/s
[Step=26600 Epoch=51.9] | Loss=0.01079 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=2.814 | 3890.7 samples/s | 60.8 steps/s
[Step=26650 Epoch=52.0] | Loss=0.00998 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.514 | FP-Norm(final)=2.815 | 3892.9 samples/s | 60.8 steps/s
[Step=26700 Epoch=52.1] | Loss=0.00954 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=2.816 | 3912.4 samples/s | 61.1 steps/s
[Step=26750 Epoch=52.2] | Loss=0.00918 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.513 | FP-Norm(final)=2.817 | 3932.3 samples/s | 61.4 steps/s
[Step=26800 Epoch=52.3] | Loss=0.00875 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.512 | FP-Norm(final)=2.818 | 3899.1 samples/s | 60.9 steps/s
[Step=26850 Epoch=52.4] | Loss=0.00881 | Reg=0.00027 | acc=0.9688 | FP-Norm=0.512 | FP-Norm(final)=2.819 | 3974.7 samples/s | 62.1 steps/s
[Step=26900 Epoch=52.5] | Loss=0.00874 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.820 | 4729.9 samples/s | 73.9 steps/s
[Step=26950 Epoch=52.6] | Loss=0.00847 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.820 | 1658.6 samples/s | 25.9 steps/s
[Step=27000 Epoch=52.7] | Loss=0.00828 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.821 | 3913.3 samples/s | 61.1 steps/s
[Step=27050 Epoch=52.8] | Loss=0.00804 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.822 | 3862.5 samples/s | 60.4 steps/s
[Step=27100 Epoch=52.9] | Loss=0.00809 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.512 | FP-Norm(final)=2.823 | 3898.2 samples/s | 60.9 steps/s
[Step=27150 Epoch=53.0] | Loss=0.00797 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.823 | 3893.2 samples/s | 60.8 steps/s
[Step=27200 Epoch=53.1] | Loss=0.00785 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.824 | 3905.2 samples/s | 61.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step27200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=51.6] | Loss=0.17984 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.813 | 3701.7 samples/s | 57.8 steps/s
[Step=26450 Epoch=51.7] | Loss=0.02423 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.522 | FP-Norm(final)=2.812 | 3897.9 samples/s | 60.9 steps/s
[Step=26500 Epoch=51.8] | Loss=0.01546 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.812 | 3925.5 samples/s | 61.3 steps/s
[Step=26550 Epoch=51.9] | Loss=0.01264 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.532 | FP-Norm(final)=2.813 | 3874.5 samples/s | 60.5 steps/s
[Step=26600 Epoch=52.0] | Loss=0.01124 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.814 | 3897.7 samples/s | 60.9 steps/s
[Step=26650 Epoch=52.1] | Loss=0.01011 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.524 | FP-Norm(final)=2.815 | 3893.5 samples/s | 60.8 steps/s
[Step=26700 Epoch=52.2] | Loss=0.00949 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.521 | FP-Norm(final)=2.816 | 3904.0 samples/s | 61.0 steps/s
[Step=26750 Epoch=52.3] | Loss=0.00913 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.521 | FP-Norm(final)=2.817 | 3886.8 samples/s | 60.7 steps/s
[Step=26800 Epoch=52.4] | Loss=0.00918 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.520 | FP-Norm(final)=2.818 | 3890.5 samples/s | 60.8 steps/s
[Step=26850 Epoch=52.5] | Loss=0.00894 | Reg=0.00027 | acc=0.9688 | FP-Norm=0.519 | FP-Norm(final)=2.819 | 3905.9 samples/s | 61.0 steps/s
[Step=26900 Epoch=52.6] | Loss=0.00863 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=2.819 | 4664.5 samples/s | 72.9 steps/s
[Step=26950 Epoch=52.7] | Loss=0.00835 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=2.820 | 1728.2 samples/s | 27.0 steps/s
[Step=27000 Epoch=52.8] | Loss=0.00820 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.514 | FP-Norm(final)=2.821 | 3914.9 samples/s | 61.2 steps/s
[Step=27050 Epoch=52.9] | Loss=0.00803 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=2.822 | 3902.7 samples/s | 61.0 steps/s
[Step=27100 Epoch=53.0] | Loss=0.00792 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.822 | 3891.4 samples/s | 60.8 steps/s
[Step=27150 Epoch=53.1] | Loss=0.00777 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.823 | 3887.5 samples/s | 60.7 steps/s
[Step=27200 Epoch=53.2] | Loss=0.00759 | Reg=0.00026 | acc=0.9688 | FP-Norm=0.511 | FP-Norm(final)=2.824 | 3909.6 samples/s | 61.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step27200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=101.2] | Loss=0.00427 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.813 | 3654.9 samples/s | 57.1 steps/s
[Step=26450 Epoch=101.3] | Loss=0.00290 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=2.816 | 3628.6 samples/s | 56.7 steps/s
[Step=26500 Epoch=101.5] | Loss=0.00149 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.480 | FP-Norm(final)=2.817 | 3814.4 samples/s | 59.6 steps/s
[Step=26550 Epoch=101.7] | Loss=0.00101 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=2.818 | 3770.5 samples/s | 58.9 steps/s
[Step=26600 Epoch=101.9] | Loss=0.00078 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.470 | FP-Norm(final)=2.819 | 3837.7 samples/s | 60.0 steps/s
[Step=26650 Epoch=102.1] | Loss=0.00063 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.819 | 4555.4 samples/s | 71.2 steps/s
[Step=26700 Epoch=102.3] | Loss=0.00053 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=2.819 | 1667.5 samples/s | 26.1 steps/s
[Step=26750 Epoch=102.5] | Loss=0.00046 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=2.820 | 3702.5 samples/s | 57.9 steps/s
[Step=26800 Epoch=102.7] | Loss=0.00040 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.443 | FP-Norm(final)=2.820 | 3711.1 samples/s | 58.0 steps/s
[Step=26850 Epoch=102.9] | Loss=0.00036 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.820 | 3717.8 samples/s | 58.1 steps/s
[Step=26900 Epoch=103.1] | Loss=0.00033 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=2.820 | 4057.9 samples/s | 63.4 steps/s
[Step=26950 Epoch=103.3] | Loss=0.00030 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.821 | 1718.7 samples/s | 26.9 steps/s
[Step=27000 Epoch=103.5] | Loss=0.00028 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.821 | 3797.9 samples/s | 59.3 steps/s
[Step=27050 Epoch=103.6] | Loss=0.00026 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=2.821 | 3789.9 samples/s | 59.2 steps/s
[Step=27100 Epoch=103.8] | Loss=0.00024 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.821 | 3695.4 samples/s | 57.7 steps/s
[Step=27150 Epoch=104.0] | Loss=0.00023 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.821 | 3705.7 samples/s | 57.9 steps/s
[Step=27200 Epoch=104.2] | Loss=0.00021 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.821 | 1813.8 samples/s | 28.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step27200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=101.6] | Loss=0.00574 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.813 | 3657.6 samples/s | 57.2 steps/s
[Step=26450 Epoch=101.8] | Loss=0.00258 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=2.816 | 3624.5 samples/s | 56.6 steps/s
[Step=26500 Epoch=102.0] | Loss=0.00132 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.478 | FP-Norm(final)=2.816 | 3690.6 samples/s | 57.7 steps/s
[Step=26550 Epoch=102.2] | Loss=0.00090 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.473 | FP-Norm(final)=2.817 | 3710.0 samples/s | 58.0 steps/s
[Step=26600 Epoch=102.4] | Loss=0.00069 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=2.817 | 3696.5 samples/s | 57.8 steps/s
[Step=26650 Epoch=102.6] | Loss=0.00056 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=2.818 | 4580.7 samples/s | 71.6 steps/s
[Step=26700 Epoch=102.8] | Loss=0.00047 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=2.818 | 1669.9 samples/s | 26.1 steps/s
[Step=26750 Epoch=103.0] | Loss=0.00041 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=2.818 | 3766.8 samples/s | 58.9 steps/s
[Step=26800 Epoch=103.2] | Loss=0.00036 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=2.818 | 3832.6 samples/s | 59.9 steps/s
[Step=26850 Epoch=103.4] | Loss=0.00032 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.434 | FP-Norm(final)=2.818 | 3694.0 samples/s | 57.7 steps/s
[Step=26900 Epoch=103.5] | Loss=0.00029 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=2.819 | 4129.8 samples/s | 64.5 steps/s
[Step=26950 Epoch=103.7] | Loss=0.00027 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.819 | 1692.1 samples/s | 26.4 steps/s
[Step=27000 Epoch=103.9] | Loss=0.00025 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.819 | 3705.1 samples/s | 57.9 steps/s
[Step=27050 Epoch=104.1] | Loss=0.00023 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=2.819 | 3781.5 samples/s | 59.1 steps/s
[Step=27100 Epoch=104.3] | Loss=0.00022 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.819 | 3792.1 samples/s | 59.3 steps/s
[Step=27150 Epoch=104.5] | Loss=0.00020 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.819 | 3877.3 samples/s | 60.6 steps/s
[Step=27200 Epoch=104.7] | Loss=0.00019 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.819 | 1777.9 samples/s | 27.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20696 | acc=0.8909 | tpr=0.8465 | fpr=0.0129 | 3886.5 samples/s | 15.2 steps/s
Avg test loss: 0.21425, Avg test acc: 0.88917, Avg tpr: 0.84554, Avg fpr: 0.01487, total FA: 116

Testing server on iccad2012
[Step=  50] | Loss=0.42905 | acc=0.8509 | tpr=0.9558 | fpr=0.1509 | 3852.0 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.43064 | acc=0.8533 | tpr=0.9680 | fpr=0.1489 | 6993.8 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.43882 | acc=0.8510 | tpr=0.9712 | fpr=0.1512 | 7383.3 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.44400 | acc=0.8506 | tpr=0.9716 | fpr=0.1516 | 7221.3 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.44061 | acc=0.8507 | tpr=0.9721 | fpr=0.1515 | 7611.8 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.44305 | acc=0.8507 | tpr=0.9695 | fpr=0.1514 | 7178.0 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.44750 | acc=0.8501 | tpr=0.9693 | fpr=0.1521 | 7057.0 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.44842 | acc=0.8497 | tpr=0.9650 | fpr=0.1524 | 7575.9 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.45106 | acc=0.8495 | tpr=0.9645 | fpr=0.1526 | 7087.9 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.45085 | acc=0.8495 | tpr=0.9656 | fpr=0.1526 | 7308.9 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.44986 | acc=0.8497 | tpr=0.9638 | fpr=0.1524 | 13270.5 samples/s | 51.8 steps/s
Avg test loss: 0.44976, Avg test acc: 0.84970, Avg tpr: 0.96315, Avg fpr: 0.15236, total FA: 21155

server round 34/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=53.1] | Loss=0.07523 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.828 | 3385.2 samples/s | 52.9 steps/s
[Step=27250 Epoch=53.1] | Loss=0.01956 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.827 | 3956.1 samples/s | 61.8 steps/s
[Step=27300 Epoch=53.2] | Loss=0.01346 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.438 | FP-Norm(final)=2.827 | 3858.6 samples/s | 60.3 steps/s
[Step=27350 Epoch=53.3] | Loss=0.01068 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.443 | FP-Norm(final)=2.828 | 3875.2 samples/s | 60.6 steps/s
[Step=27400 Epoch=53.4] | Loss=0.01009 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=2.829 | 3903.7 samples/s | 61.0 steps/s
[Step=27450 Epoch=53.5] | Loss=0.00931 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.829 | 3893.3 samples/s | 60.8 steps/s
[Step=27500 Epoch=53.6] | Loss=0.00878 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.445 | FP-Norm(final)=2.830 | 3923.2 samples/s | 61.3 steps/s
[Step=27550 Epoch=53.7] | Loss=0.00876 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=2.831 | 3900.9 samples/s | 61.0 steps/s
[Step=27600 Epoch=53.8] | Loss=0.00840 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.832 | 3910.8 samples/s | 61.1 steps/s
[Step=27650 Epoch=53.9] | Loss=0.00815 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.832 | 3886.3 samples/s | 60.7 steps/s
[Step=27700 Epoch=54.0] | Loss=0.00804 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=2.833 | 4616.9 samples/s | 72.1 steps/s
[Step=27750 Epoch=54.1] | Loss=0.00795 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.448 | FP-Norm(final)=2.834 | 1652.2 samples/s | 25.8 steps/s
[Step=27800 Epoch=54.2] | Loss=0.00766 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.448 | FP-Norm(final)=2.835 | 3861.0 samples/s | 60.3 steps/s
[Step=27850 Epoch=54.3] | Loss=0.00761 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.448 | FP-Norm(final)=2.835 | 3878.2 samples/s | 60.6 steps/s
[Step=27900 Epoch=54.4] | Loss=0.00758 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.450 | FP-Norm(final)=2.836 | 3921.8 samples/s | 61.3 steps/s
[Step=27950 Epoch=54.5] | Loss=0.00750 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.451 | FP-Norm(final)=2.837 | 3864.6 samples/s | 60.4 steps/s
[Step=28000 Epoch=54.6] | Loss=0.00738 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.837 | 3895.7 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step28000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=53.2] | Loss=0.03341 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.828 | 3937.2 samples/s | 61.5 steps/s
[Step=27250 Epoch=53.3] | Loss=0.01910 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.829 | 3608.0 samples/s | 56.4 steps/s
[Step=27300 Epoch=53.4] | Loss=0.01336 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=2.829 | 3948.3 samples/s | 61.7 steps/s
[Step=27350 Epoch=53.5] | Loss=0.01160 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.449 | FP-Norm(final)=2.830 | 3870.5 samples/s | 60.5 steps/s
[Step=27400 Epoch=53.6] | Loss=0.01023 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.450 | FP-Norm(final)=2.830 | 3919.1 samples/s | 61.2 steps/s
[Step=27450 Epoch=53.7] | Loss=0.00938 | Reg=0.00021 | acc=0.9531 | FP-Norm=0.448 | FP-Norm(final)=2.831 | 3900.6 samples/s | 60.9 steps/s
[Step=27500 Epoch=53.8] | Loss=0.00870 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.446 | FP-Norm(final)=2.832 | 3904.3 samples/s | 61.0 steps/s
[Step=27550 Epoch=53.9] | Loss=0.00826 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=2.833 | 3895.3 samples/s | 60.9 steps/s
[Step=27600 Epoch=54.0] | Loss=0.00792 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.444 | FP-Norm(final)=2.834 | 3880.0 samples/s | 60.6 steps/s
[Step=27650 Epoch=54.1] | Loss=0.00791 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.443 | FP-Norm(final)=2.835 | 3926.2 samples/s | 61.3 steps/s
[Step=27700 Epoch=54.2] | Loss=0.00786 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.443 | FP-Norm(final)=2.836 | 4660.0 samples/s | 72.8 steps/s
[Step=27750 Epoch=54.3] | Loss=0.00758 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=2.837 | 1723.9 samples/s | 26.9 steps/s
[Step=27800 Epoch=54.3] | Loss=0.00731 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=2.838 | 3867.3 samples/s | 60.4 steps/s
[Step=27850 Epoch=54.4] | Loss=0.00720 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.839 | 3905.4 samples/s | 61.0 steps/s
[Step=27900 Epoch=54.5] | Loss=0.00701 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.840 | 3848.5 samples/s | 60.1 steps/s
[Step=27950 Epoch=54.6] | Loss=0.00688 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=2.840 | 3911.8 samples/s | 61.1 steps/s
[Step=28000 Epoch=54.7] | Loss=0.00681 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=2.841 | 3898.1 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step28000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=104.2] | Loss=0.04564 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.828 | 3545.9 samples/s | 55.4 steps/s
[Step=27250 Epoch=104.4] | Loss=0.00340 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=2.831 | 3679.8 samples/s | 57.5 steps/s
[Step=27300 Epoch=104.6] | Loss=0.00174 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=2.832 | 3691.2 samples/s | 57.7 steps/s
[Step=27350 Epoch=104.8] | Loss=0.00117 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.590 | FP-Norm(final)=2.832 | 3721.5 samples/s | 58.1 steps/s
[Step=27400 Epoch=105.0] | Loss=0.00089 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.832 | 3687.9 samples/s | 57.6 steps/s
[Step=27450 Epoch=105.2] | Loss=0.00072 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.833 | 4526.3 samples/s | 70.7 steps/s
[Step=27500 Epoch=105.4] | Loss=0.00060 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.833 | 1652.6 samples/s | 25.8 steps/s
[Step=27550 Epoch=105.6] | Loss=0.00052 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.833 | 3735.1 samples/s | 58.4 steps/s
[Step=27600 Epoch=105.8] | Loss=0.00046 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.833 | 3702.8 samples/s | 57.9 steps/s
[Step=27650 Epoch=105.9] | Loss=0.00041 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.833 | 3661.4 samples/s | 57.2 steps/s
[Step=27700 Epoch=106.1] | Loss=0.00037 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=2.833 | 4038.1 samples/s | 63.1 steps/s
[Step=27750 Epoch=106.3] | Loss=0.00034 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=2.833 | 1745.5 samples/s | 27.3 steps/s
[Step=27800 Epoch=106.5] | Loss=0.00031 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.834 | 3708.6 samples/s | 57.9 steps/s
[Step=27850 Epoch=106.7] | Loss=0.00029 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=2.834 | 3787.5 samples/s | 59.2 steps/s
[Step=27900 Epoch=106.9] | Loss=0.00027 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=2.834 | 3865.7 samples/s | 60.4 steps/s
[Step=27950 Epoch=107.1] | Loss=0.00025 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=2.834 | 3673.5 samples/s | 57.4 steps/s
[Step=28000 Epoch=107.3] | Loss=0.00024 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=2.834 | 1781.1 samples/s | 27.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step28000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=104.7] | Loss=0.05272 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.828 | 3688.2 samples/s | 57.6 steps/s
[Step=27250 Epoch=104.9] | Loss=0.00388 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.598 | FP-Norm(final)=2.830 | 3521.6 samples/s | 55.0 steps/s
[Step=27300 Epoch=105.1] | Loss=0.00196 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.626 | FP-Norm(final)=2.831 | 3690.4 samples/s | 57.7 steps/s
[Step=27350 Epoch=105.3] | Loss=0.00132 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.831 | 3661.9 samples/s | 57.2 steps/s
[Step=27400 Epoch=105.5] | Loss=0.00100 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.610 | FP-Norm(final)=2.831 | 3721.3 samples/s | 58.1 steps/s
[Step=27450 Epoch=105.7] | Loss=0.00081 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.599 | FP-Norm(final)=2.832 | 4534.5 samples/s | 70.9 steps/s
[Step=27500 Epoch=105.9] | Loss=0.00068 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.588 | FP-Norm(final)=2.832 | 1654.7 samples/s | 25.9 steps/s
[Step=27550 Epoch=106.1] | Loss=0.00058 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.832 | 3664.8 samples/s | 57.3 steps/s
[Step=27600 Epoch=106.2] | Loss=0.00051 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.832 | 3686.1 samples/s | 57.6 steps/s
[Step=27650 Epoch=106.4] | Loss=0.00046 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.832 | 3695.9 samples/s | 57.7 steps/s
[Step=27700 Epoch=106.6] | Loss=0.00041 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.832 | 4121.3 samples/s | 64.4 steps/s
[Step=27750 Epoch=106.8] | Loss=0.00038 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.832 | 1707.3 samples/s | 26.7 steps/s
[Step=27800 Epoch=107.0] | Loss=0.00035 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.832 | 3689.0 samples/s | 57.6 steps/s
[Step=27850 Epoch=107.2] | Loss=0.00032 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=2.832 | 3704.7 samples/s | 57.9 steps/s
[Step=27900 Epoch=107.4] | Loss=0.00030 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.521 | FP-Norm(final)=2.832 | 3699.9 samples/s | 57.8 steps/s
[Step=27950 Epoch=107.6] | Loss=0.00028 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=2.832 | 3722.5 samples/s | 58.2 steps/s
[Step=28000 Epoch=107.8] | Loss=0.00027 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=2.832 | 1796.4 samples/s | 28.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24361 | acc=0.8741 | tpr=0.8215 | fpr=0.0119 | 3899.2 samples/s | 15.2 steps/s
Avg test loss: 0.25100, Avg test acc: 0.87275, Avg tpr: 0.82112, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.37979 | acc=0.8764 | tpr=0.9469 | fpr=0.1249 | 3373.4 samples/s | 13.2 steps/s
[Step= 100] | Loss=0.38240 | acc=0.8787 | tpr=0.9616 | fpr=0.1229 | 7087.5 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.39036 | acc=0.8768 | tpr=0.9669 | fpr=0.1249 | 7264.8 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.39543 | acc=0.8767 | tpr=0.9683 | fpr=0.1250 | 6308.8 samples/s | 24.6 steps/s
[Step= 250] | Loss=0.39155 | acc=0.8769 | tpr=0.9694 | fpr=0.1248 | 7225.6 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.39419 | acc=0.8770 | tpr=0.9665 | fpr=0.1246 | 7226.2 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.39859 | acc=0.8762 | tpr=0.9668 | fpr=0.1255 | 6288.4 samples/s | 24.6 steps/s
[Step= 400] | Loss=0.39949 | acc=0.8757 | tpr=0.9633 | fpr=0.1259 | 6966.6 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.40236 | acc=0.8755 | tpr=0.9625 | fpr=0.1261 | 7371.8 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.40220 | acc=0.8753 | tpr=0.9634 | fpr=0.1263 | 7085.7 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.40114 | acc=0.8756 | tpr=0.9618 | fpr=0.1260 | 13320.2 samples/s | 52.0 steps/s
Avg test loss: 0.40100, Avg test acc: 0.87558, Avg tpr: 0.96117, Avg fpr: 0.12598, total FA: 17492

server round 35/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=54.6] | Loss=0.06978 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.842 | 3454.7 samples/s | 54.0 steps/s
[Step=28050 Epoch=54.7] | Loss=0.02208 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.842 | 3813.9 samples/s | 59.6 steps/s
[Step=28100 Epoch=54.8] | Loss=0.01480 | Reg=0.00028 | acc=0.9688 | FP-Norm=0.511 | FP-Norm(final)=2.842 | 3896.9 samples/s | 60.9 steps/s
[Step=28150 Epoch=54.9] | Loss=0.01240 | Reg=0.00027 | acc=0.9688 | FP-Norm=0.513 | FP-Norm(final)=2.842 | 3889.3 samples/s | 60.8 steps/s
[Step=28200 Epoch=55.0] | Loss=0.01096 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.843 | 3908.4 samples/s | 61.1 steps/s
[Step=28250 Epoch=55.1] | Loss=0.00997 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.844 | 3893.7 samples/s | 60.8 steps/s
[Step=28300 Epoch=55.2] | Loss=0.00937 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.510 | FP-Norm(final)=2.844 | 3924.8 samples/s | 61.3 steps/s
[Step=28350 Epoch=55.3] | Loss=0.00883 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.507 | FP-Norm(final)=2.845 | 3880.1 samples/s | 60.6 steps/s
[Step=28400 Epoch=55.4] | Loss=0.00838 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=2.846 | 3920.2 samples/s | 61.3 steps/s
[Step=28450 Epoch=55.5] | Loss=0.00825 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.847 | 3844.1 samples/s | 60.1 steps/s
[Step=28500 Epoch=55.6] | Loss=0.00823 | Reg=0.00025 | acc=0.9531 | FP-Norm=0.500 | FP-Norm(final)=2.847 | 4538.9 samples/s | 70.9 steps/s
[Step=28550 Epoch=55.7] | Loss=0.00816 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=2.848 | 1678.0 samples/s | 26.2 steps/s
[Step=28600 Epoch=55.8] | Loss=0.00800 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=2.848 | 3861.6 samples/s | 60.3 steps/s
[Step=28650 Epoch=55.9] | Loss=0.00782 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=2.849 | 3907.1 samples/s | 61.0 steps/s
[Step=28700 Epoch=56.0] | Loss=0.00766 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.494 | FP-Norm(final)=2.849 | 3892.0 samples/s | 60.8 steps/s
[Step=28750 Epoch=56.1] | Loss=0.00744 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.850 | 3895.8 samples/s | 60.9 steps/s
[Step=28800 Epoch=56.2] | Loss=0.00740 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.492 | FP-Norm(final)=2.850 | 3905.3 samples/s | 61.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step28800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=54.7] | Loss=0.05171 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.842 | 3738.3 samples/s | 58.4 steps/s
[Step=28050 Epoch=54.8] | Loss=0.01917 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=2.841 | 3845.8 samples/s | 60.1 steps/s
[Step=28100 Epoch=54.9] | Loss=0.01246 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.462 | FP-Norm(final)=2.841 | 3995.3 samples/s | 62.4 steps/s
[Step=28150 Epoch=55.0] | Loss=0.01086 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.460 | FP-Norm(final)=2.842 | 4009.9 samples/s | 62.7 steps/s
[Step=28200 Epoch=55.1] | Loss=0.00972 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.458 | FP-Norm(final)=2.843 | 4022.9 samples/s | 62.9 steps/s
[Step=28250 Epoch=55.2] | Loss=0.00853 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.454 | FP-Norm(final)=2.844 | 3917.3 samples/s | 61.2 steps/s
[Step=28300 Epoch=55.3] | Loss=0.00817 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.845 | 3842.6 samples/s | 60.0 steps/s
[Step=28350 Epoch=55.4] | Loss=0.00820 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.451 | FP-Norm(final)=2.846 | 3810.7 samples/s | 59.5 steps/s
[Step=28400 Epoch=55.5] | Loss=0.00804 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=2.847 | 3860.9 samples/s | 60.3 steps/s
[Step=28450 Epoch=55.6] | Loss=0.00802 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.451 | FP-Norm(final)=2.848 | 3920.6 samples/s | 61.3 steps/s
[Step=28500 Epoch=55.7] | Loss=0.00786 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.849 | 4674.5 samples/s | 73.0 steps/s
[Step=28550 Epoch=55.8] | Loss=0.00768 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=2.850 | 1697.9 samples/s | 26.5 steps/s
[Step=28600 Epoch=55.9] | Loss=0.00752 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=2.850 | 3886.7 samples/s | 60.7 steps/s
[Step=28650 Epoch=56.0] | Loss=0.00737 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.455 | FP-Norm(final)=2.851 | 3900.6 samples/s | 60.9 steps/s
[Step=28700 Epoch=56.1] | Loss=0.00715 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.456 | FP-Norm(final)=2.852 | 3900.8 samples/s | 61.0 steps/s
[Step=28750 Epoch=56.2] | Loss=0.00696 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=2.853 | 3925.6 samples/s | 61.3 steps/s
[Step=28800 Epoch=56.3] | Loss=0.00688 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=2.854 | 3859.5 samples/s | 60.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step28800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=107.3] | Loss=0.01614 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.842 | 3509.1 samples/s | 54.8 steps/s
[Step=28050 Epoch=107.5] | Loss=0.00288 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.613 | FP-Norm(final)=2.845 | 3542.7 samples/s | 55.4 steps/s
[Step=28100 Epoch=107.7] | Loss=0.00147 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.644 | FP-Norm(final)=2.845 | 3606.3 samples/s | 56.3 steps/s
[Step=28150 Epoch=107.9] | Loss=0.00098 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.638 | FP-Norm(final)=2.845 | 3631.1 samples/s | 56.7 steps/s
[Step=28200 Epoch=108.1] | Loss=0.00074 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.627 | FP-Norm(final)=2.846 | 3661.5 samples/s | 57.2 steps/s
[Step=28250 Epoch=108.2] | Loss=0.00060 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.615 | FP-Norm(final)=2.846 | 4527.0 samples/s | 70.7 steps/s
[Step=28300 Epoch=108.4] | Loss=0.00051 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=2.846 | 1654.1 samples/s | 25.8 steps/s
[Step=28350 Epoch=108.6] | Loss=0.00044 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=2.846 | 3692.7 samples/s | 57.7 steps/s
[Step=28400 Epoch=108.8] | Loss=0.00038 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.584 | FP-Norm(final)=2.846 | 3791.0 samples/s | 59.2 steps/s
[Step=28450 Epoch=109.0] | Loss=0.00034 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.846 | 3782.3 samples/s | 59.1 steps/s
[Step=28500 Epoch=109.2] | Loss=0.00031 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.846 | 4054.2 samples/s | 63.3 steps/s
[Step=28550 Epoch=109.4] | Loss=0.00028 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.846 | 1730.2 samples/s | 27.0 steps/s
[Step=28600 Epoch=109.6] | Loss=0.00026 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.846 | 3717.6 samples/s | 58.1 steps/s
[Step=28650 Epoch=109.8] | Loss=0.00024 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.846 | 3688.1 samples/s | 57.6 steps/s
[Step=28700 Epoch=110.0] | Loss=0.00023 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.846 | 3720.7 samples/s | 58.1 steps/s
[Step=28750 Epoch=110.2] | Loss=0.00021 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.846 | 3683.3 samples/s | 57.6 steps/s
[Step=28800 Epoch=110.4] | Loss=0.00020 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.522 | FP-Norm(final)=2.846 | 1798.9 samples/s | 28.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step28800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=107.8] | Loss=0.10388 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.842 | 3701.1 samples/s | 57.8 steps/s
[Step=28050 Epoch=108.0] | Loss=0.00436 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.598 | FP-Norm(final)=2.843 | 3601.9 samples/s | 56.3 steps/s
[Step=28100 Epoch=108.2] | Loss=0.00219 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.625 | FP-Norm(final)=2.844 | 3717.3 samples/s | 58.1 steps/s
[Step=28150 Epoch=108.4] | Loss=0.00148 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.617 | FP-Norm(final)=2.844 | 3689.3 samples/s | 57.6 steps/s
[Step=28200 Epoch=108.6] | Loss=0.00112 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.606 | FP-Norm(final)=2.844 | 3720.5 samples/s | 58.1 steps/s
[Step=28250 Epoch=108.7] | Loss=0.00090 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=2.844 | 4588.8 samples/s | 71.7 steps/s
[Step=28300 Epoch=108.9] | Loss=0.00075 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.584 | FP-Norm(final)=2.844 | 1659.4 samples/s | 25.9 steps/s
[Step=28350 Epoch=109.1] | Loss=0.00065 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.574 | FP-Norm(final)=2.844 | 3642.0 samples/s | 56.9 steps/s
[Step=28400 Epoch=109.3] | Loss=0.00057 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.564 | FP-Norm(final)=2.844 | 3695.9 samples/s | 57.7 steps/s
[Step=28450 Epoch=109.5] | Loss=0.00051 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.844 | 3773.8 samples/s | 59.0 steps/s
[Step=28500 Epoch=109.7] | Loss=0.00046 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.844 | 4209.4 samples/s | 65.8 steps/s
[Step=28550 Epoch=109.9] | Loss=0.00042 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.844 | 1723.0 samples/s | 26.9 steps/s
[Step=28600 Epoch=110.1] | Loss=0.00039 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.844 | 3708.4 samples/s | 57.9 steps/s
[Step=28650 Epoch=110.3] | Loss=0.00036 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=2.844 | 3716.1 samples/s | 58.1 steps/s
[Step=28700 Epoch=110.5] | Loss=0.00033 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.844 | 3737.3 samples/s | 58.4 steps/s
[Step=28750 Epoch=110.7] | Loss=0.00031 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.845 | 3726.2 samples/s | 58.2 steps/s
[Step=28800 Epoch=110.9] | Loss=0.00029 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=2.845 | 1776.8 samples/s | 27.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27092 | acc=0.8616 | tpr=0.8031 | fpr=0.0114 | 3812.7 samples/s | 14.9 steps/s
Avg test loss: 0.27838, Avg test acc: 0.86033, Avg tpr: 0.80294, Avg fpr: 0.01346, total FA: 105

Testing server on iccad2012
[Step=  50] | Loss=0.35228 | acc=0.8898 | tpr=0.9425 | fpr=0.1112 | 3836.8 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.35569 | acc=0.8912 | tpr=0.9574 | fpr=0.1101 | 7709.7 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.36321 | acc=0.8893 | tpr=0.9625 | fpr=0.1120 | 7110.2 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.36832 | acc=0.8888 | tpr=0.9639 | fpr=0.1125 | 7045.2 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.36416 | acc=0.8888 | tpr=0.9651 | fpr=0.1126 | 7830.2 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.36713 | acc=0.8887 | tpr=0.9629 | fpr=0.1126 | 7083.6 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.37127 | acc=0.8881 | tpr=0.9637 | fpr=0.1132 | 7252.3 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.37215 | acc=0.8878 | tpr=0.9606 | fpr=0.1136 | 7364.8 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.37484 | acc=0.8875 | tpr=0.9596 | fpr=0.1138 | 7277.8 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.37457 | acc=0.8875 | tpr=0.9608 | fpr=0.1138 | 7113.9 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.37345 | acc=0.8879 | tpr=0.9594 | fpr=0.1134 | 13600.4 samples/s | 53.1 steps/s
Avg test loss: 0.37327, Avg test acc: 0.88787, Avg tpr: 0.95880, Avg fpr: 0.11342, total FA: 15748

server round 36/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=56.2] | Loss=0.17343 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.854 | 3408.9 samples/s | 53.3 steps/s
[Step=28850 Epoch=56.3] | Loss=0.02544 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.852 | 3944.7 samples/s | 61.6 steps/s
[Step=28900 Epoch=56.4] | Loss=0.01634 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=2.852 | 3938.8 samples/s | 61.5 steps/s
[Step=28950 Epoch=56.5] | Loss=0.01275 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=2.853 | 3884.6 samples/s | 60.7 steps/s
[Step=29000 Epoch=56.6] | Loss=0.01116 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=2.854 | 3888.5 samples/s | 60.8 steps/s
[Step=29050 Epoch=56.7] | Loss=0.01057 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=2.855 | 3915.4 samples/s | 61.2 steps/s
[Step=29100 Epoch=56.8] | Loss=0.00981 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=2.855 | 3880.9 samples/s | 60.6 steps/s
[Step=29150 Epoch=56.9] | Loss=0.00928 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.856 | 3877.5 samples/s | 60.6 steps/s
[Step=29200 Epoch=57.0] | Loss=0.00885 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=2.857 | 3917.3 samples/s | 61.2 steps/s
[Step=29250 Epoch=57.0] | Loss=0.00865 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=2.857 | 3881.0 samples/s | 60.6 steps/s
[Step=29300 Epoch=57.1] | Loss=0.00862 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=2.858 | 4581.8 samples/s | 71.6 steps/s
[Step=29350 Epoch=57.2] | Loss=0.00848 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.503 | FP-Norm(final)=2.859 | 1656.8 samples/s | 25.9 steps/s
[Step=29400 Epoch=57.3] | Loss=0.00809 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.501 | FP-Norm(final)=2.859 | 3943.8 samples/s | 61.6 steps/s
[Step=29450 Epoch=57.4] | Loss=0.00784 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.860 | 3849.4 samples/s | 60.1 steps/s
[Step=29500 Epoch=57.5] | Loss=0.00772 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=2.860 | 3925.4 samples/s | 61.3 steps/s
[Step=29550 Epoch=57.6] | Loss=0.00749 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=2.861 | 3991.5 samples/s | 62.4 steps/s
[Step=29600 Epoch=57.7] | Loss=0.00740 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=2.862 | 3953.3 samples/s | 61.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step29600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=56.3] | Loss=0.11779 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.854 | 3925.3 samples/s | 61.3 steps/s
[Step=28850 Epoch=56.4] | Loss=0.02398 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.487 | FP-Norm(final)=2.852 | 3664.2 samples/s | 57.3 steps/s
[Step=28900 Epoch=56.5] | Loss=0.01563 | Reg=0.00027 | acc=0.9688 | FP-Norm=0.510 | FP-Norm(final)=2.853 | 3946.6 samples/s | 61.7 steps/s
[Step=28950 Epoch=56.6] | Loss=0.01352 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.522 | FP-Norm(final)=2.853 | 3928.6 samples/s | 61.4 steps/s
[Step=29000 Epoch=56.7] | Loss=0.01202 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.525 | FP-Norm(final)=2.854 | 3904.4 samples/s | 61.0 steps/s
[Step=29050 Epoch=56.8] | Loss=0.01088 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=2.855 | 3965.1 samples/s | 62.0 steps/s
[Step=29100 Epoch=56.9] | Loss=0.00998 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.856 | 4040.4 samples/s | 63.1 steps/s
[Step=29150 Epoch=57.0] | Loss=0.00937 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=2.857 | 4018.1 samples/s | 62.8 steps/s
[Step=29200 Epoch=57.1] | Loss=0.00895 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=2.858 | 3963.2 samples/s | 61.9 steps/s
[Step=29250 Epoch=57.2] | Loss=0.00849 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=2.859 | 3985.6 samples/s | 62.3 steps/s
[Step=29300 Epoch=57.3] | Loss=0.00807 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=2.860 | 4781.9 samples/s | 74.7 steps/s
[Step=29350 Epoch=57.4] | Loss=0.00797 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=2.861 | 1705.8 samples/s | 26.7 steps/s
[Step=29400 Epoch=57.5] | Loss=0.00767 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.504 | FP-Norm(final)=2.862 | 3880.6 samples/s | 60.6 steps/s
[Step=29450 Epoch=57.6] | Loss=0.00757 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=2.863 | 3864.0 samples/s | 60.4 steps/s
[Step=29500 Epoch=57.7] | Loss=0.00727 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.864 | 3889.0 samples/s | 60.8 steps/s
[Step=29550 Epoch=57.8] | Loss=0.00710 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.865 | 3884.6 samples/s | 60.7 steps/s
[Step=29600 Epoch=57.9] | Loss=0.00697 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.498 | FP-Norm(final)=2.866 | 3887.5 samples/s | 60.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step29600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=110.4] | Loss=0.00542 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.854 | 3662.1 samples/s | 57.2 steps/s
[Step=28850 Epoch=110.5] | Loss=0.00196 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=2.858 | 3465.2 samples/s | 54.1 steps/s
[Step=28900 Epoch=110.7] | Loss=0.00100 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=2.859 | 3657.6 samples/s | 57.1 steps/s
[Step=28950 Epoch=110.9] | Loss=0.00067 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=2.859 | 3698.4 samples/s | 57.8 steps/s
[Step=29000 Epoch=111.1] | Loss=0.00051 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=2.860 | 3673.8 samples/s | 57.4 steps/s
[Step=29050 Epoch=111.3] | Loss=0.00041 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=2.860 | 4478.2 samples/s | 70.0 steps/s
[Step=29100 Epoch=111.5] | Loss=0.00035 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.484 | FP-Norm(final)=2.860 | 1655.2 samples/s | 25.9 steps/s
[Step=29150 Epoch=111.7] | Loss=0.00030 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.475 | FP-Norm(final)=2.860 | 3802.2 samples/s | 59.4 steps/s
[Step=29200 Epoch=111.9] | Loss=0.00027 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.466 | FP-Norm(final)=2.860 | 3801.3 samples/s | 59.4 steps/s
[Step=29250 Epoch=112.1] | Loss=0.00024 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.458 | FP-Norm(final)=2.860 | 3769.1 samples/s | 58.9 steps/s
[Step=29300 Epoch=112.3] | Loss=0.00022 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=2.860 | 4091.6 samples/s | 63.9 steps/s
[Step=29350 Epoch=112.5] | Loss=0.00020 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.444 | FP-Norm(final)=2.860 | 1716.0 samples/s | 26.8 steps/s
[Step=29400 Epoch=112.7] | Loss=0.00018 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.860 | 3688.6 samples/s | 57.6 steps/s
[Step=29450 Epoch=112.8] | Loss=0.00017 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.431 | FP-Norm(final)=2.860 | 3545.8 samples/s | 55.4 steps/s
[Step=29500 Epoch=113.0] | Loss=0.00016 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.860 | 3245.4 samples/s | 50.7 steps/s
[Step=29550 Epoch=113.2] | Loss=0.00015 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=2.860 | 3236.5 samples/s | 50.6 steps/s
[Step=29600 Epoch=113.4] | Loss=0.00014 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.861 | 1768.4 samples/s | 27.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step29600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=110.9] | Loss=0.06707 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.854 | 3615.4 samples/s | 56.5 steps/s
[Step=28850 Epoch=111.1] | Loss=0.00352 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.856 | 3828.1 samples/s | 59.8 steps/s
[Step=28900 Epoch=111.2] | Loss=0.00179 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.856 | 3874.0 samples/s | 60.5 steps/s
[Step=28950 Epoch=111.4] | Loss=0.00121 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.857 | 3896.3 samples/s | 60.9 steps/s
[Step=29000 Epoch=111.6] | Loss=0.00092 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=2.857 | 3850.7 samples/s | 60.2 steps/s
[Step=29050 Epoch=111.8] | Loss=0.00074 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.857 | 4821.5 samples/s | 75.3 steps/s
[Step=29100 Epoch=112.0] | Loss=0.00062 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=2.857 | 1694.2 samples/s | 26.5 steps/s
[Step=29150 Epoch=112.2] | Loss=0.00053 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.857 | 3761.5 samples/s | 58.8 steps/s
[Step=29200 Epoch=112.4] | Loss=0.00047 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=2.858 | 3836.4 samples/s | 59.9 steps/s
[Step=29250 Epoch=112.6] | Loss=0.00042 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=2.858 | 3756.5 samples/s | 58.7 steps/s
[Step=29300 Epoch=112.8] | Loss=0.00038 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=2.858 | 4173.2 samples/s | 65.2 steps/s
[Step=29350 Epoch=113.0] | Loss=0.00035 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=2.858 | 1770.2 samples/s | 27.7 steps/s
[Step=29400 Epoch=113.2] | Loss=0.00032 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=2.858 | 3793.1 samples/s | 59.3 steps/s
[Step=29450 Epoch=113.4] | Loss=0.00030 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=2.858 | 3705.3 samples/s | 57.9 steps/s
[Step=29500 Epoch=113.6] | Loss=0.00028 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.484 | FP-Norm(final)=2.858 | 3796.0 samples/s | 59.3 steps/s
[Step=29550 Epoch=113.7] | Loss=0.00026 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.478 | FP-Norm(final)=2.858 | 3917.7 samples/s | 61.2 steps/s
[Step=29600 Epoch=113.9] | Loss=0.00024 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.473 | FP-Norm(final)=2.858 | 1836.7 samples/s | 28.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23641 | acc=0.8784 | tpr=0.8283 | fpr=0.0126 | 3866.3 samples/s | 15.1 steps/s
Avg test loss: 0.24405, Avg test acc: 0.87791, Avg tpr: 0.82922, Avg fpr: 0.01500, total FA: 117

Testing server on iccad2012
[Step=  50] | Loss=0.39825 | acc=0.8704 | tpr=0.9425 | fpr=0.1309 | 3892.8 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.40020 | acc=0.8730 | tpr=0.9595 | fpr=0.1286 | 7621.8 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.40859 | acc=0.8712 | tpr=0.9640 | fpr=0.1305 | 7487.9 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.41371 | acc=0.8714 | tpr=0.9650 | fpr=0.1303 | 7659.4 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.40952 | acc=0.8715 | tpr=0.9668 | fpr=0.1302 | 7390.7 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.41246 | acc=0.8717 | tpr=0.9651 | fpr=0.1300 | 7551.9 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.41680 | acc=0.8708 | tpr=0.9656 | fpr=0.1309 | 7187.7 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.41764 | acc=0.8704 | tpr=0.9617 | fpr=0.1313 | 7310.4 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.42040 | acc=0.8701 | tpr=0.9611 | fpr=0.1316 | 7443.2 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.42022 | acc=0.8700 | tpr=0.9621 | fpr=0.1316 | 7432.2 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.41907 | acc=0.8702 | tpr=0.9606 | fpr=0.1314 | 13177.9 samples/s | 51.5 steps/s
Avg test loss: 0.41896, Avg test acc: 0.87024, Avg tpr: 0.95998, Avg fpr: 0.13140, total FA: 18244

server round 37/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=57.7] | Loss=0.02240 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.868 | 3587.2 samples/s | 56.1 steps/s
[Step=29650 Epoch=57.8] | Loss=0.01734 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=2.868 | 3671.5 samples/s | 57.4 steps/s
[Step=29700 Epoch=57.9] | Loss=0.01184 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.445 | FP-Norm(final)=2.868 | 3964.9 samples/s | 62.0 steps/s
[Step=29750 Epoch=58.0] | Loss=0.01130 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.869 | 3986.3 samples/s | 62.3 steps/s
[Step=29800 Epoch=58.1] | Loss=0.01015 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.451 | FP-Norm(final)=2.869 | 3974.1 samples/s | 62.1 steps/s
[Step=29850 Epoch=58.2] | Loss=0.00942 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.451 | FP-Norm(final)=2.869 | 3996.6 samples/s | 62.4 steps/s
[Step=29900 Epoch=58.3] | Loss=0.00878 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.869 | 4013.7 samples/s | 62.7 steps/s
[Step=29950 Epoch=58.4] | Loss=0.00827 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.451 | FP-Norm(final)=2.870 | 3956.6 samples/s | 61.8 steps/s
[Step=30000 Epoch=58.5] | Loss=0.00794 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.451 | FP-Norm(final)=2.871 | 3960.3 samples/s | 61.9 steps/s
[Step=30050 Epoch=58.6] | Loss=0.00779 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.451 | FP-Norm(final)=2.872 | 3942.1 samples/s | 61.6 steps/s
[Step=30100 Epoch=58.7] | Loss=0.00774 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.452 | FP-Norm(final)=2.873 | 4684.3 samples/s | 73.2 steps/s
[Step=30150 Epoch=58.8] | Loss=0.00753 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.873 | 1697.6 samples/s | 26.5 steps/s
[Step=30200 Epoch=58.9] | Loss=0.00753 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.874 | 3984.2 samples/s | 62.3 steps/s
[Step=30250 Epoch=59.0] | Loss=0.00739 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=2.875 | 3966.7 samples/s | 62.0 steps/s
[Step=30300 Epoch=59.1] | Loss=0.00716 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=2.875 | 3999.8 samples/s | 62.5 steps/s
[Step=30350 Epoch=59.2] | Loss=0.00699 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=2.876 | 3992.8 samples/s | 62.4 steps/s
[Step=30400 Epoch=59.3] | Loss=0.00694 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=2.877 | 4020.1 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step30400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=57.9] | Loss=0.15564 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.868 | 3807.6 samples/s | 59.5 steps/s
[Step=29650 Epoch=58.0] | Loss=0.02099 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.866 | 3850.9 samples/s | 60.2 steps/s
[Step=29700 Epoch=58.1] | Loss=0.01457 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=2.867 | 3981.1 samples/s | 62.2 steps/s
[Step=29750 Epoch=58.2] | Loss=0.01210 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.460 | FP-Norm(final)=2.867 | 3998.4 samples/s | 62.5 steps/s
[Step=29800 Epoch=58.3] | Loss=0.01064 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.458 | FP-Norm(final)=2.868 | 4039.9 samples/s | 63.1 steps/s
[Step=29850 Epoch=58.4] | Loss=0.00997 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=2.869 | 4088.6 samples/s | 63.9 steps/s
[Step=29900 Epoch=58.5] | Loss=0.00916 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.455 | FP-Norm(final)=2.870 | 4118.9 samples/s | 64.4 steps/s
[Step=29950 Epoch=58.6] | Loss=0.00852 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.455 | FP-Norm(final)=2.870 | 4104.9 samples/s | 64.1 steps/s
[Step=30000 Epoch=58.6] | Loss=0.00844 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=2.871 | 4105.7 samples/s | 64.2 steps/s
[Step=30050 Epoch=58.7] | Loss=0.00826 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=2.872 | 4091.3 samples/s | 63.9 steps/s
[Step=30100 Epoch=58.8] | Loss=0.00783 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.873 | 4885.5 samples/s | 76.3 steps/s
[Step=30150 Epoch=58.9] | Loss=0.00752 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.451 | FP-Norm(final)=2.873 | 1768.2 samples/s | 27.6 steps/s
[Step=30200 Epoch=59.0] | Loss=0.00735 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=2.874 | 4058.7 samples/s | 63.4 steps/s
[Step=30250 Epoch=59.1] | Loss=0.00715 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=2.875 | 4071.3 samples/s | 63.6 steps/s
[Step=30300 Epoch=59.2] | Loss=0.00697 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=2.876 | 4055.2 samples/s | 63.4 steps/s
[Step=30350 Epoch=59.3] | Loss=0.00695 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=2.876 | 4091.1 samples/s | 63.9 steps/s
[Step=30400 Epoch=59.4] | Loss=0.00683 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.451 | FP-Norm(final)=2.877 | 4076.3 samples/s | 63.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step30400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=113.4] | Loss=0.15834 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.868 | 3647.4 samples/s | 57.0 steps/s
[Step=29650 Epoch=113.6] | Loss=0.00459 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=2.869 | 3762.5 samples/s | 58.8 steps/s
[Step=29700 Epoch=113.8] | Loss=0.00232 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.630 | FP-Norm(final)=2.869 | 3867.1 samples/s | 60.4 steps/s
[Step=29750 Epoch=114.0] | Loss=0.00156 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.622 | FP-Norm(final)=2.869 | 3813.4 samples/s | 59.6 steps/s
[Step=29800 Epoch=114.2] | Loss=0.00118 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.611 | FP-Norm(final)=2.869 | 3787.3 samples/s | 59.2 steps/s
[Step=29850 Epoch=114.4] | Loss=0.00095 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.600 | FP-Norm(final)=2.869 | 4629.9 samples/s | 72.3 steps/s
[Step=29900 Epoch=114.6] | Loss=0.00079 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.589 | FP-Norm(final)=2.870 | 1691.3 samples/s | 26.4 steps/s
[Step=29950 Epoch=114.8] | Loss=0.00068 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.870 | 3739.0 samples/s | 58.4 steps/s
[Step=30000 Epoch=114.9] | Loss=0.00060 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.870 | 3777.4 samples/s | 59.0 steps/s
[Step=30050 Epoch=115.1] | Loss=0.00054 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.870 | 3799.7 samples/s | 59.4 steps/s
[Step=30100 Epoch=115.3] | Loss=0.00049 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.870 | 4082.8 samples/s | 63.8 steps/s
[Step=30150 Epoch=115.5] | Loss=0.00044 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=2.870 | 1761.5 samples/s | 27.5 steps/s
[Step=30200 Epoch=115.7] | Loss=0.00041 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.870 | 3781.8 samples/s | 59.1 steps/s
[Step=30250 Epoch=115.9] | Loss=0.00038 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.870 | 3862.0 samples/s | 60.3 steps/s
[Step=30300 Epoch=116.1] | Loss=0.00035 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=2.870 | 3871.1 samples/s | 60.5 steps/s
[Step=30350 Epoch=116.3] | Loss=0.00033 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.871 | 3872.7 samples/s | 60.5 steps/s
[Step=30400 Epoch=116.5] | Loss=0.00031 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.871 | 1849.0 samples/s | 28.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step30400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=113.9] | Loss=0.17399 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.868 | 3750.0 samples/s | 58.6 steps/s
[Step=29650 Epoch=114.1] | Loss=0.00629 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.610 | FP-Norm(final)=2.867 | 3673.8 samples/s | 57.4 steps/s
[Step=29700 Epoch=114.3] | Loss=0.00323 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.637 | FP-Norm(final)=2.867 | 3762.3 samples/s | 58.8 steps/s
[Step=29750 Epoch=114.5] | Loss=0.00216 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.638 | FP-Norm(final)=2.867 | 3785.0 samples/s | 59.1 steps/s
[Step=29800 Epoch=114.7] | Loss=0.00163 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.630 | FP-Norm(final)=2.867 | 3794.3 samples/s | 59.3 steps/s
[Step=29850 Epoch=114.9] | Loss=0.00130 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.868 | 4688.1 samples/s | 73.3 steps/s
[Step=29900 Epoch=115.1] | Loss=0.00109 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.611 | FP-Norm(final)=2.868 | 1698.1 samples/s | 26.5 steps/s
[Step=29950 Epoch=115.3] | Loss=0.00094 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.601 | FP-Norm(final)=2.868 | 3830.6 samples/s | 59.9 steps/s
[Step=30000 Epoch=115.5] | Loss=0.00082 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=2.868 | 3805.5 samples/s | 59.5 steps/s
[Step=30050 Epoch=115.7] | Loss=0.00073 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.868 | 3812.3 samples/s | 59.6 steps/s
[Step=30100 Epoch=115.9] | Loss=0.00066 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.868 | 4225.5 samples/s | 66.0 steps/s
[Step=30150 Epoch=116.1] | Loss=0.00060 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.567 | FP-Norm(final)=2.868 | 1758.1 samples/s | 27.5 steps/s
[Step=30200 Epoch=116.3] | Loss=0.00055 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.868 | 3880.5 samples/s | 60.6 steps/s
[Step=30250 Epoch=116.4] | Loss=0.00051 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.553 | FP-Norm(final)=2.868 | 3792.8 samples/s | 59.3 steps/s
[Step=30300 Epoch=116.6] | Loss=0.00048 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.868 | 3782.1 samples/s | 59.1 steps/s
[Step=30350 Epoch=116.8] | Loss=0.00045 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.868 | 3861.1 samples/s | 60.3 steps/s
[Step=30400 Epoch=117.0] | Loss=0.00042 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.868 | 1800.6 samples/s | 28.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25670 | acc=0.8688 | tpr=0.8140 | fpr=0.0121 | 3968.1 samples/s | 15.5 steps/s
Avg test loss: 0.26365, Avg test acc: 0.86926, Avg tpr: 0.81628, Avg fpr: 0.01423, total FA: 111

Testing server on iccad2012
[Step=  50] | Loss=0.36462 | acc=0.8904 | tpr=0.9513 | fpr=0.1107 | 3853.1 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.36860 | acc=0.8919 | tpr=0.9659 | fpr=0.1095 | 7193.2 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.37687 | acc=0.8896 | tpr=0.9683 | fpr=0.1119 | 7317.2 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.38218 | acc=0.8887 | tpr=0.9683 | fpr=0.1128 | 7449.2 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.37764 | acc=0.8886 | tpr=0.9694 | fpr=0.1129 | 7387.6 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.38098 | acc=0.8885 | tpr=0.9673 | fpr=0.1129 | 7508.6 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.38523 | acc=0.8876 | tpr=0.9668 | fpr=0.1138 | 7498.4 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.38611 | acc=0.8872 | tpr=0.9633 | fpr=0.1141 | 7492.2 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.38890 | acc=0.8868 | tpr=0.9625 | fpr=0.1145 | 7262.7 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.38858 | acc=0.8869 | tpr=0.9634 | fpr=0.1145 | 7367.0 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.38742 | acc=0.8871 | tpr=0.9622 | fpr=0.1143 | 13632.4 samples/s | 53.3 steps/s
Avg test loss: 0.38726, Avg test acc: 0.88711, Avg tpr: 0.96157, Avg fpr: 0.11424, total FA: 15862

server round 38/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=59.3] | Loss=0.22295 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.879 | 3362.4 samples/s | 52.5 steps/s
[Step=30450 Epoch=59.4] | Loss=0.02438 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.477 | FP-Norm(final)=2.875 | 4095.8 samples/s | 64.0 steps/s
[Step=30500 Epoch=59.5] | Loss=0.01672 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.498 | FP-Norm(final)=2.874 | 4050.3 samples/s | 63.3 steps/s
[Step=30550 Epoch=59.6] | Loss=0.01365 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=2.874 | 4068.3 samples/s | 63.6 steps/s
[Step=30600 Epoch=59.7] | Loss=0.01186 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=2.874 | 3997.9 samples/s | 62.5 steps/s
[Step=30650 Epoch=59.8] | Loss=0.01058 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.492 | FP-Norm(final)=2.875 | 3911.1 samples/s | 61.1 steps/s
[Step=30700 Epoch=59.9] | Loss=0.00993 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.875 | 3968.8 samples/s | 62.0 steps/s
[Step=30750 Epoch=60.0] | Loss=0.00949 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.489 | FP-Norm(final)=2.876 | 3918.0 samples/s | 61.2 steps/s
[Step=30800 Epoch=60.1] | Loss=0.00906 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.489 | FP-Norm(final)=2.877 | 3944.7 samples/s | 61.6 steps/s
[Step=30850 Epoch=60.2] | Loss=0.00858 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.487 | FP-Norm(final)=2.878 | 3975.3 samples/s | 62.1 steps/s
[Step=30900 Epoch=60.3] | Loss=0.00816 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.484 | FP-Norm(final)=2.879 | 4789.8 samples/s | 74.8 steps/s
[Step=30950 Epoch=60.4] | Loss=0.00791 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=2.879 | 1713.3 samples/s | 26.8 steps/s
[Step=31000 Epoch=60.5] | Loss=0.00764 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=2.880 | 3959.8 samples/s | 61.9 steps/s
[Step=31050 Epoch=60.6] | Loss=0.00747 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.479 | FP-Norm(final)=2.881 | 3932.7 samples/s | 61.4 steps/s
[Step=31100 Epoch=60.7] | Loss=0.00736 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.478 | FP-Norm(final)=2.882 | 3905.2 samples/s | 61.0 steps/s
[Step=31150 Epoch=60.8] | Loss=0.00713 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.477 | FP-Norm(final)=2.882 | 3939.8 samples/s | 61.6 steps/s
[Step=31200 Epoch=60.9] | Loss=0.00693 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=2.883 | 3919.5 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step31200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=59.4] | Loss=0.16246 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.879 | 3989.2 samples/s | 62.3 steps/s
[Step=30450 Epoch=59.5] | Loss=0.01756 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.880 | 3601.3 samples/s | 56.3 steps/s
[Step=30500 Epoch=59.6] | Loss=0.01266 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=2.881 | 3937.7 samples/s | 61.5 steps/s
[Step=30550 Epoch=59.7] | Loss=0.01035 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.882 | 3895.0 samples/s | 60.9 steps/s
[Step=30600 Epoch=59.8] | Loss=0.00933 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.462 | FP-Norm(final)=2.882 | 3921.1 samples/s | 61.3 steps/s
[Step=30650 Epoch=59.9] | Loss=0.00856 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=2.883 | 3975.7 samples/s | 62.1 steps/s
[Step=30700 Epoch=60.0] | Loss=0.00820 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.460 | FP-Norm(final)=2.884 | 3919.4 samples/s | 61.2 steps/s
[Step=30750 Epoch=60.1] | Loss=0.00791 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=2.885 | 3918.6 samples/s | 61.2 steps/s
[Step=30800 Epoch=60.2] | Loss=0.00764 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=2.886 | 3951.8 samples/s | 61.7 steps/s
[Step=30850 Epoch=60.3] | Loss=0.00743 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=2.887 | 3928.4 samples/s | 61.4 steps/s
[Step=30900 Epoch=60.4] | Loss=0.00738 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=2.888 | 4694.3 samples/s | 73.3 steps/s
[Step=30950 Epoch=60.5] | Loss=0.00741 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.458 | FP-Norm(final)=2.888 | 1735.8 samples/s | 27.1 steps/s
[Step=31000 Epoch=60.6] | Loss=0.00719 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=2.889 | 3951.6 samples/s | 61.7 steps/s
[Step=31050 Epoch=60.7] | Loss=0.00693 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=2.889 | 3969.8 samples/s | 62.0 steps/s
[Step=31100 Epoch=60.8] | Loss=0.00664 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.455 | FP-Norm(final)=2.890 | 3917.3 samples/s | 61.2 steps/s
[Step=31150 Epoch=60.9] | Loss=0.00657 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.455 | FP-Norm(final)=2.891 | 3921.0 samples/s | 61.3 steps/s
[Step=31200 Epoch=61.0] | Loss=0.00647 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.455 | FP-Norm(final)=2.891 | 3865.4 samples/s | 60.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step31200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=116.5] | Loss=0.06015 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.879 | 3644.4 samples/s | 56.9 steps/s
[Step=30450 Epoch=116.7] | Loss=0.00474 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.628 | FP-Norm(final)=2.879 | 3716.9 samples/s | 58.1 steps/s
[Step=30500 Epoch=116.9] | Loss=0.00240 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.657 | FP-Norm(final)=2.879 | 3835.7 samples/s | 59.9 steps/s
[Step=30550 Epoch=117.1] | Loss=0.00161 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.652 | FP-Norm(final)=2.880 | 3881.0 samples/s | 60.6 steps/s
[Step=30600 Epoch=117.2] | Loss=0.00121 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.642 | FP-Norm(final)=2.880 | 3791.6 samples/s | 59.2 steps/s
[Step=30650 Epoch=117.4] | Loss=0.00098 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.632 | FP-Norm(final)=2.880 | 4707.1 samples/s | 73.5 steps/s
[Step=30700 Epoch=117.6] | Loss=0.00082 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.622 | FP-Norm(final)=2.880 | 1666.5 samples/s | 26.0 steps/s
[Step=30750 Epoch=117.8] | Loss=0.00071 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.613 | FP-Norm(final)=2.880 | 3661.7 samples/s | 57.2 steps/s
[Step=30800 Epoch=118.0] | Loss=0.00062 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.604 | FP-Norm(final)=2.880 | 3790.3 samples/s | 59.2 steps/s
[Step=30850 Epoch=118.2] | Loss=0.00056 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=2.880 | 3773.1 samples/s | 59.0 steps/s
[Step=30900 Epoch=118.4] | Loss=0.00050 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=2.880 | 4074.6 samples/s | 63.7 steps/s
[Step=30950 Epoch=118.6] | Loss=0.00046 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.880 | 1757.3 samples/s | 27.5 steps/s
[Step=31000 Epoch=118.8] | Loss=0.00042 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=2.880 | 3780.8 samples/s | 59.1 steps/s
[Step=31050 Epoch=119.0] | Loss=0.00039 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.880 | 3745.6 samples/s | 58.5 steps/s
[Step=31100 Epoch=119.2] | Loss=0.00036 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=2.880 | 3803.7 samples/s | 59.4 steps/s
[Step=31150 Epoch=119.4] | Loss=0.00034 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.881 | 3878.9 samples/s | 60.6 steps/s
[Step=31200 Epoch=119.5] | Loss=0.00032 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.881 | 1817.8 samples/s | 28.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step31200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=117.0] | Loss=0.06703 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.879 | 3592.5 samples/s | 56.1 steps/s
[Step=30450 Epoch=117.2] | Loss=0.00321 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.880 | 3747.5 samples/s | 58.6 steps/s
[Step=30500 Epoch=117.4] | Loss=0.00162 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.880 | 3905.9 samples/s | 61.0 steps/s
[Step=30550 Epoch=117.6] | Loss=0.00109 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.880 | 3714.1 samples/s | 58.0 steps/s
[Step=30600 Epoch=117.8] | Loss=0.00082 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.549 | FP-Norm(final)=2.880 | 3732.9 samples/s | 58.3 steps/s
[Step=30650 Epoch=118.0] | Loss=0.00066 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.880 | 4772.2 samples/s | 74.6 steps/s
[Step=30700 Epoch=118.2] | Loss=0.00055 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.880 | 1675.5 samples/s | 26.2 steps/s
[Step=30750 Epoch=118.4] | Loss=0.00048 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=2.880 | 3773.9 samples/s | 59.0 steps/s
[Step=30800 Epoch=118.6] | Loss=0.00042 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.880 | 3830.8 samples/s | 59.9 steps/s
[Step=30850 Epoch=118.8] | Loss=0.00038 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=2.881 | 3831.6 samples/s | 59.9 steps/s
[Step=30900 Epoch=118.9] | Loss=0.00034 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=2.881 | 4154.0 samples/s | 64.9 steps/s
[Step=30950 Epoch=119.1] | Loss=0.00031 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=2.881 | 1741.9 samples/s | 27.2 steps/s
[Step=31000 Epoch=119.3] | Loss=0.00029 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.483 | FP-Norm(final)=2.881 | 3731.4 samples/s | 58.3 steps/s
[Step=31050 Epoch=119.5] | Loss=0.00027 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.477 | FP-Norm(final)=2.881 | 3717.1 samples/s | 58.1 steps/s
[Step=31100 Epoch=119.7] | Loss=0.00025 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=2.881 | 3684.5 samples/s | 57.6 steps/s
[Step=31150 Epoch=119.9] | Loss=0.00023 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.466 | FP-Norm(final)=2.881 | 3802.5 samples/s | 59.4 steps/s
[Step=31200 Epoch=120.1] | Loss=0.00022 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=2.881 | 1767.6 samples/s | 27.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25265 | acc=0.8734 | tpr=0.8206 | fpr=0.0121 | 3874.6 samples/s | 15.1 steps/s
Avg test loss: 0.25995, Avg test acc: 0.87295, Avg tpr: 0.82182, Avg fpr: 0.01461, total FA: 114

Testing server on iccad2012
[Step=  50] | Loss=0.38004 | acc=0.8808 | tpr=0.9469 | fpr=0.1204 | 3887.4 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.38355 | acc=0.8830 | tpr=0.9638 | fpr=0.1185 | 7166.7 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.39169 | acc=0.8811 | tpr=0.9669 | fpr=0.1205 | 7395.2 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.39711 | acc=0.8809 | tpr=0.9672 | fpr=0.1206 | 7608.1 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.39244 | acc=0.8813 | tpr=0.9677 | fpr=0.1202 | 7258.0 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.39538 | acc=0.8815 | tpr=0.9658 | fpr=0.1201 | 7415.0 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.39980 | acc=0.8805 | tpr=0.9662 | fpr=0.1211 | 7379.5 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.40064 | acc=0.8803 | tpr=0.9623 | fpr=0.1212 | 7192.5 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.40352 | acc=0.8798 | tpr=0.9611 | fpr=0.1216 | 7138.0 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.40328 | acc=0.8797 | tpr=0.9626 | fpr=0.1218 | 6822.8 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.40203 | acc=0.8800 | tpr=0.9610 | fpr=0.1215 | 13200.2 samples/s | 51.6 steps/s
Avg test loss: 0.40189, Avg test acc: 0.87998, Avg tpr: 0.96038, Avg fpr: 0.12149, total FA: 16868

server round 39/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=60.9] | Loss=0.12350 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.890 | 3526.9 samples/s | 55.1 steps/s
[Step=31250 Epoch=60.9] | Loss=0.03028 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.884 | 3887.8 samples/s | 60.7 steps/s
[Step=31300 Epoch=61.0] | Loss=0.01971 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.883 | 3948.0 samples/s | 61.7 steps/s
[Step=31350 Epoch=61.1] | Loss=0.01577 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=2.882 | 3913.0 samples/s | 61.1 steps/s
[Step=31400 Epoch=61.2] | Loss=0.01320 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=2.883 | 3933.1 samples/s | 61.5 steps/s
[Step=31450 Epoch=61.3] | Loss=0.01194 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=2.884 | 3877.7 samples/s | 60.6 steps/s
[Step=31500 Epoch=61.4] | Loss=0.01069 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.884 | 3942.8 samples/s | 61.6 steps/s
[Step=31550 Epoch=61.5] | Loss=0.01018 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.885 | 3904.9 samples/s | 61.0 steps/s
[Step=31600 Epoch=61.6] | Loss=0.00950 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=2.886 | 3935.5 samples/s | 61.5 steps/s
[Step=31650 Epoch=61.7] | Loss=0.00922 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=2.887 | 3865.0 samples/s | 60.4 steps/s
[Step=31700 Epoch=61.8] | Loss=0.00873 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.888 | 4661.1 samples/s | 72.8 steps/s
[Step=31750 Epoch=61.9] | Loss=0.00833 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=2.888 | 1717.1 samples/s | 26.8 steps/s
[Step=31800 Epoch=62.0] | Loss=0.00807 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=2.889 | 3915.7 samples/s | 61.2 steps/s
[Step=31850 Epoch=62.1] | Loss=0.00788 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=2.890 | 3939.2 samples/s | 61.6 steps/s
[Step=31900 Epoch=62.2] | Loss=0.00775 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=2.891 | 3890.3 samples/s | 60.8 steps/s
[Step=31950 Epoch=62.3] | Loss=0.00755 | Reg=0.00024 | acc=0.9688 | FP-Norm=0.492 | FP-Norm(final)=2.891 | 3888.7 samples/s | 60.8 steps/s
[Step=32000 Epoch=62.4] | Loss=0.00752 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.892 | 3916.8 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=61.0] | Loss=0.07486 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.890 | 3816.3 samples/s | 59.6 steps/s
[Step=31250 Epoch=61.1] | Loss=0.01606 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=2.890 | 3743.3 samples/s | 58.5 steps/s
[Step=31300 Epoch=61.2] | Loss=0.01117 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.460 | FP-Norm(final)=2.891 | 3880.4 samples/s | 60.6 steps/s
[Step=31350 Epoch=61.3] | Loss=0.00994 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.469 | FP-Norm(final)=2.891 | 3906.7 samples/s | 61.0 steps/s
[Step=31400 Epoch=61.4] | Loss=0.00963 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.470 | FP-Norm(final)=2.891 | 3899.4 samples/s | 60.9 steps/s
[Step=31450 Epoch=61.5] | Loss=0.00908 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.470 | FP-Norm(final)=2.892 | 3927.7 samples/s | 61.4 steps/s
[Step=31500 Epoch=61.6] | Loss=0.00834 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.467 | FP-Norm(final)=2.892 | 3964.0 samples/s | 61.9 steps/s
[Step=31550 Epoch=61.7] | Loss=0.00810 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.467 | FP-Norm(final)=2.893 | 3957.4 samples/s | 61.8 steps/s
[Step=31600 Epoch=61.8] | Loss=0.00778 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.466 | FP-Norm(final)=2.894 | 3995.9 samples/s | 62.4 steps/s
[Step=31650 Epoch=61.9] | Loss=0.00756 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=2.894 | 3942.2 samples/s | 61.6 steps/s
[Step=31700 Epoch=62.0] | Loss=0.00744 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.466 | FP-Norm(final)=2.895 | 4750.0 samples/s | 74.2 steps/s
[Step=31750 Epoch=62.1] | Loss=0.00710 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.466 | FP-Norm(final)=2.896 | 1727.6 samples/s | 27.0 steps/s
[Step=31800 Epoch=62.2] | Loss=0.00684 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=2.897 | 4029.0 samples/s | 63.0 steps/s
[Step=31850 Epoch=62.3] | Loss=0.00673 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.897 | 3878.6 samples/s | 60.6 steps/s
[Step=31900 Epoch=62.4] | Loss=0.00664 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.898 | 3977.6 samples/s | 62.1 steps/s
[Step=31950 Epoch=62.5] | Loss=0.00653 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.899 | 3937.2 samples/s | 61.5 steps/s
[Step=32000 Epoch=62.6] | Loss=0.00647 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.463 | FP-Norm(final)=2.900 | 3909.6 samples/s | 61.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step32000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=119.6] | Loss=0.11359 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.890 | 3802.3 samples/s | 59.4 steps/s
[Step=31250 Epoch=119.7] | Loss=0.00508 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.597 | FP-Norm(final)=2.888 | 3471.4 samples/s | 54.2 steps/s
[Step=31300 Epoch=119.9] | Loss=0.00260 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.635 | FP-Norm(final)=2.888 | 3725.8 samples/s | 58.2 steps/s
[Step=31350 Epoch=120.1] | Loss=0.00175 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.639 | FP-Norm(final)=2.888 | 3654.4 samples/s | 57.1 steps/s
[Step=31400 Epoch=120.3] | Loss=0.00132 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.632 | FP-Norm(final)=2.889 | 3769.5 samples/s | 58.9 steps/s
[Step=31450 Epoch=120.5] | Loss=0.00106 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.623 | FP-Norm(final)=2.889 | 4616.3 samples/s | 72.1 steps/s
[Step=31500 Epoch=120.7] | Loss=0.00089 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.613 | FP-Norm(final)=2.889 | 1663.4 samples/s | 26.0 steps/s
[Step=31550 Epoch=120.9] | Loss=0.00077 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.604 | FP-Norm(final)=2.889 | 3743.3 samples/s | 58.5 steps/s
[Step=31600 Epoch=121.1] | Loss=0.00067 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=2.889 | 3678.5 samples/s | 57.5 steps/s
[Step=31650 Epoch=121.3] | Loss=0.00060 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=2.889 | 3616.9 samples/s | 56.5 steps/s
[Step=31700 Epoch=121.5] | Loss=0.00054 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.889 | 3955.1 samples/s | 61.8 steps/s
[Step=31750 Epoch=121.7] | Loss=0.00050 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=2.890 | 1679.1 samples/s | 26.2 steps/s
[Step=31800 Epoch=121.8] | Loss=0.00046 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.890 | 3786.4 samples/s | 59.2 steps/s
[Step=31850 Epoch=122.0] | Loss=0.00042 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=2.890 | 3691.6 samples/s | 57.7 steps/s
[Step=31900 Epoch=122.2] | Loss=0.00039 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.890 | 3725.3 samples/s | 58.2 steps/s
[Step=31950 Epoch=122.4] | Loss=0.00037 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.890 | 3636.9 samples/s | 56.8 steps/s
[Step=32000 Epoch=122.6] | Loss=0.00035 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.890 | 1804.2 samples/s | 28.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step32000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=120.1] | Loss=0.13569 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.890 | 3810.9 samples/s | 59.5 steps/s
[Step=31250 Epoch=120.3] | Loss=0.00512 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=2.889 | 3461.9 samples/s | 54.1 steps/s
[Step=31300 Epoch=120.5] | Loss=0.00259 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.890 | 3695.1 samples/s | 57.7 steps/s
[Step=31350 Epoch=120.7] | Loss=0.00174 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.890 | 3744.2 samples/s | 58.5 steps/s
[Step=31400 Epoch=120.9] | Loss=0.00131 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.890 | 3723.9 samples/s | 58.2 steps/s
[Step=31450 Epoch=121.1] | Loss=0.00106 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=2.890 | 4563.2 samples/s | 71.3 steps/s
[Step=31500 Epoch=121.3] | Loss=0.00089 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.890 | 1649.7 samples/s | 25.8 steps/s
[Step=31550 Epoch=121.4] | Loss=0.00076 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.891 | 3669.5 samples/s | 57.3 steps/s
[Step=31600 Epoch=121.6] | Loss=0.00067 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.521 | FP-Norm(final)=2.891 | 3735.1 samples/s | 58.4 steps/s
[Step=31650 Epoch=121.8] | Loss=0.00060 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=2.891 | 3623.9 samples/s | 56.6 steps/s
[Step=31700 Epoch=122.0] | Loss=0.00054 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=2.891 | 4126.8 samples/s | 64.5 steps/s
[Step=31750 Epoch=122.2] | Loss=0.00049 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.891 | 1714.9 samples/s | 26.8 steps/s
[Step=31800 Epoch=122.4] | Loss=0.00045 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=2.891 | 3856.8 samples/s | 60.3 steps/s
[Step=31850 Epoch=122.6] | Loss=0.00042 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.488 | FP-Norm(final)=2.891 | 3781.8 samples/s | 59.1 steps/s
[Step=31900 Epoch=122.8] | Loss=0.00039 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.483 | FP-Norm(final)=2.891 | 3729.7 samples/s | 58.3 steps/s
[Step=31950 Epoch=123.0] | Loss=0.00037 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.478 | FP-Norm(final)=2.891 | 3732.0 samples/s | 58.3 steps/s
[Step=32000 Epoch=123.2] | Loss=0.00034 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.472 | FP-Norm(final)=2.891 | 1784.8 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24588 | acc=0.8745 | tpr=0.8228 | fpr=0.0131 | 3707.1 samples/s | 14.5 steps/s
Avg test loss: 0.25352, Avg test acc: 0.87367, Avg tpr: 0.82328, Avg fpr: 0.01551, total FA: 121

Testing server on iccad2012
[Step=  50] | Loss=0.36876 | acc=0.8872 | tpr=0.9469 | fpr=0.1139 | 3845.5 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.37237 | acc=0.8893 | tpr=0.9638 | fpr=0.1121 | 7278.0 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.38057 | acc=0.8869 | tpr=0.9654 | fpr=0.1145 | 7207.0 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.38610 | acc=0.8864 | tpr=0.9661 | fpr=0.1150 | 7276.4 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.38072 | acc=0.8869 | tpr=0.9686 | fpr=0.1146 | 7552.2 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.38390 | acc=0.8870 | tpr=0.9665 | fpr=0.1144 | 7248.8 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.38811 | acc=0.8862 | tpr=0.9662 | fpr=0.1152 | 6913.2 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.38898 | acc=0.8860 | tpr=0.9628 | fpr=0.1154 | 4574.8 samples/s | 17.9 steps/s
[Step= 450] | Loss=0.39181 | acc=0.8857 | tpr=0.9615 | fpr=0.1157 | 7076.3 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.39154 | acc=0.8857 | tpr=0.9630 | fpr=0.1157 | 7284.1 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.39043 | acc=0.8858 | tpr=0.9618 | fpr=0.1156 | 13368.3 samples/s | 52.2 steps/s
Avg test loss: 0.39027, Avg test acc: 0.88583, Avg tpr: 0.96157, Avg fpr: 0.11554, total FA: 16043

server round 40/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=62.4] | Loss=0.10335 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.899 | 3458.9 samples/s | 54.0 steps/s
[Step=32050 Epoch=62.5] | Loss=0.02374 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.350 | FP-Norm(final)=2.899 | 3770.5 samples/s | 58.9 steps/s
[Step=32100 Epoch=62.6] | Loss=0.01474 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.899 | 3900.7 samples/s | 60.9 steps/s
[Step=32150 Epoch=62.7] | Loss=0.01186 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=2.900 | 3985.8 samples/s | 62.3 steps/s
[Step=32200 Epoch=62.8] | Loss=0.01066 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=2.900 | 4001.0 samples/s | 62.5 steps/s
[Step=32250 Epoch=62.9] | Loss=0.00943 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.900 | 4036.5 samples/s | 63.1 steps/s
[Step=32300 Epoch=63.0] | Loss=0.00885 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=2.901 | 3929.8 samples/s | 61.4 steps/s
[Step=32350 Epoch=63.1] | Loss=0.00843 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.901 | 3890.5 samples/s | 60.8 steps/s
[Step=32400 Epoch=63.2] | Loss=0.00797 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.388 | FP-Norm(final)=2.902 | 3912.6 samples/s | 61.1 steps/s
[Step=32450 Epoch=63.3] | Loss=0.00767 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=2.902 | 3872.3 samples/s | 60.5 steps/s
[Step=32500 Epoch=63.4] | Loss=0.00731 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=2.903 | 4584.1 samples/s | 71.6 steps/s
[Step=32550 Epoch=63.5] | Loss=0.00695 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=2.903 | 1640.3 samples/s | 25.6 steps/s
[Step=32600 Epoch=63.6] | Loss=0.00668 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.904 | 3876.8 samples/s | 60.6 steps/s
[Step=32650 Epoch=63.7] | Loss=0.00650 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.387 | FP-Norm(final)=2.904 | 3962.9 samples/s | 61.9 steps/s
[Step=32700 Epoch=63.8] | Loss=0.00630 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=2.905 | 3904.8 samples/s | 61.0 steps/s
[Step=32750 Epoch=63.9] | Loss=0.00630 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.388 | FP-Norm(final)=2.905 | 3879.1 samples/s | 60.6 steps/s
[Step=32800 Epoch=64.0] | Loss=0.00625 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.387 | FP-Norm(final)=2.906 | 3911.7 samples/s | 61.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step32800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=62.6] | Loss=0.26198 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.898 | 3721.8 samples/s | 58.2 steps/s
[Step=32050 Epoch=62.7] | Loss=0.02998 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=2.898 | 3716.3 samples/s | 58.1 steps/s
[Step=32100 Epoch=62.8] | Loss=0.01799 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=2.898 | 3874.0 samples/s | 60.5 steps/s
[Step=32150 Epoch=62.9] | Loss=0.01394 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=2.898 | 3882.9 samples/s | 60.7 steps/s
[Step=32200 Epoch=63.0] | Loss=0.01185 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=2.899 | 3879.2 samples/s | 60.6 steps/s
[Step=32250 Epoch=63.0] | Loss=0.01042 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.899 | 3899.8 samples/s | 60.9 steps/s
[Step=32300 Epoch=63.1] | Loss=0.00945 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.900 | 3884.8 samples/s | 60.7 steps/s
[Step=32350 Epoch=63.2] | Loss=0.00884 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.900 | 3895.8 samples/s | 60.9 steps/s
[Step=32400 Epoch=63.3] | Loss=0.00833 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.901 | 3882.8 samples/s | 60.7 steps/s
[Step=32450 Epoch=63.4] | Loss=0.00794 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.901 | 3893.7 samples/s | 60.8 steps/s
[Step=32500 Epoch=63.5] | Loss=0.00777 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.902 | 4634.1 samples/s | 72.4 steps/s
[Step=32550 Epoch=63.6] | Loss=0.00749 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.902 | 1685.7 samples/s | 26.3 steps/s
[Step=32600 Epoch=63.7] | Loss=0.00723 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.903 | 3966.6 samples/s | 62.0 steps/s
[Step=32650 Epoch=63.8] | Loss=0.00691 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=2.903 | 3983.2 samples/s | 62.2 steps/s
[Step=32700 Epoch=63.9] | Loss=0.00664 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.372 | FP-Norm(final)=2.904 | 3863.9 samples/s | 60.4 steps/s
[Step=32750 Epoch=64.0] | Loss=0.00654 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=2.905 | 3885.3 samples/s | 60.7 steps/s
[Step=32800 Epoch=64.1] | Loss=0.00643 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.372 | FP-Norm(final)=2.905 | 3886.9 samples/s | 60.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step32800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=122.6] | Loss=0.11348 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.898 | 3522.5 samples/s | 55.0 steps/s
[Step=32050 Epoch=122.8] | Loss=0.00598 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=2.899 | 3678.5 samples/s | 57.5 steps/s
[Step=32100 Epoch=123.0] | Loss=0.00304 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.899 | 3694.0 samples/s | 57.7 steps/s
[Step=32150 Epoch=123.2] | Loss=0.00206 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=2.900 | 3667.5 samples/s | 57.3 steps/s
[Step=32200 Epoch=123.4] | Loss=0.00156 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.900 | 3687.7 samples/s | 57.6 steps/s
[Step=32250 Epoch=123.6] | Loss=0.00126 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.900 | 4488.6 samples/s | 70.1 steps/s
[Step=32300 Epoch=123.8] | Loss=0.00106 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=2.900 | 1660.3 samples/s | 25.9 steps/s
[Step=32350 Epoch=124.0] | Loss=0.00091 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=2.901 | 3733.0 samples/s | 58.3 steps/s
[Step=32400 Epoch=124.1] | Loss=0.00080 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=2.901 | 3676.2 samples/s | 57.4 steps/s
[Step=32450 Epoch=124.3] | Loss=0.00072 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.901 | 3720.2 samples/s | 58.1 steps/s
[Step=32500 Epoch=124.5] | Loss=0.00065 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=2.901 | 4003.2 samples/s | 62.6 steps/s
[Step=32550 Epoch=124.7] | Loss=0.00059 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=2.901 | 1735.9 samples/s | 27.1 steps/s
[Step=32600 Epoch=124.9] | Loss=0.00055 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=2.901 | 3697.1 samples/s | 57.8 steps/s
[Step=32650 Epoch=125.1] | Loss=0.00051 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=2.901 | 3670.0 samples/s | 57.3 steps/s
[Step=32700 Epoch=125.3] | Loss=0.00047 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=2.901 | 3744.8 samples/s | 58.5 steps/s
[Step=32750 Epoch=125.5] | Loss=0.00044 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=2.902 | 3708.5 samples/s | 57.9 steps/s
[Step=32800 Epoch=125.7] | Loss=0.00042 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=2.902 | 1787.7 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step32800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=123.2] | Loss=0.01811 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.899 | 3795.5 samples/s | 59.3 steps/s
[Step=32050 Epoch=123.4] | Loss=0.00426 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=2.900 | 3398.8 samples/s | 53.1 steps/s
[Step=32100 Epoch=123.6] | Loss=0.00219 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.901 | 3645.6 samples/s | 57.0 steps/s
[Step=32150 Epoch=123.8] | Loss=0.00147 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.901 | 3714.2 samples/s | 58.0 steps/s
[Step=32200 Epoch=124.0] | Loss=0.00112 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.902 | 3675.5 samples/s | 57.4 steps/s
[Step=32250 Epoch=124.1] | Loss=0.00091 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.902 | 4567.3 samples/s | 71.4 steps/s
[Step=32300 Epoch=124.3] | Loss=0.00076 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.902 | 1650.8 samples/s | 25.8 steps/s
[Step=32350 Epoch=124.5] | Loss=0.00066 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.902 | 3660.5 samples/s | 57.2 steps/s
[Step=32400 Epoch=124.7] | Loss=0.00058 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.902 | 3680.0 samples/s | 57.5 steps/s
[Step=32450 Epoch=124.9] | Loss=0.00052 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=2.902 | 3701.6 samples/s | 57.8 steps/s
[Step=32500 Epoch=125.1] | Loss=0.00047 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=2.902 | 4102.2 samples/s | 64.1 steps/s
[Step=32550 Epoch=125.3] | Loss=0.00043 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=2.903 | 1719.0 samples/s | 26.9 steps/s
[Step=32600 Epoch=125.5] | Loss=0.00040 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.903 | 3731.0 samples/s | 58.3 steps/s
[Step=32650 Epoch=125.7] | Loss=0.00037 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.903 | 3792.8 samples/s | 59.3 steps/s
[Step=32700 Epoch=125.9] | Loss=0.00035 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=2.903 | 3736.7 samples/s | 58.4 steps/s
[Step=32750 Epoch=126.1] | Loss=0.00032 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=2.903 | 3877.1 samples/s | 60.6 steps/s
[Step=32800 Epoch=126.3] | Loss=0.00031 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=2.903 | 1793.4 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21883 | acc=0.8906 | tpr=0.8455 | fpr=0.0114 | 3811.5 samples/s | 14.9 steps/s
Avg test loss: 0.22765, Avg test acc: 0.88829, Avg tpr: 0.84397, Avg fpr: 0.01423, total FA: 111

Testing server on iccad2012
[Step=  50] | Loss=0.41240 | acc=0.8711 | tpr=0.9425 | fpr=0.1302 | 3834.3 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.41472 | acc=0.8736 | tpr=0.9595 | fpr=0.1280 | 7291.3 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.42324 | acc=0.8710 | tpr=0.9625 | fpr=0.1307 | 7358.4 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.42880 | acc=0.8710 | tpr=0.9639 | fpr=0.1307 | 4681.4 samples/s | 18.3 steps/s
[Step= 250] | Loss=0.42372 | acc=0.8713 | tpr=0.9659 | fpr=0.1304 | 7602.1 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.42653 | acc=0.8716 | tpr=0.9644 | fpr=0.1300 | 6999.1 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.43076 | acc=0.8707 | tpr=0.9649 | fpr=0.1310 | 7417.0 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.43158 | acc=0.8704 | tpr=0.9612 | fpr=0.1313 | 7294.5 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.43427 | acc=0.8701 | tpr=0.9601 | fpr=0.1315 | 6998.4 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.43411 | acc=0.8700 | tpr=0.9617 | fpr=0.1317 | 7234.9 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.43308 | acc=0.8702 | tpr=0.9606 | fpr=0.1315 | 13037.5 samples/s | 50.9 steps/s
Avg test loss: 0.43297, Avg test acc: 0.87018, Avg tpr: 0.95998, Avg fpr: 0.13145, total FA: 18252

server round 41/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=64.0] | Loss=0.06225 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.908 | 3464.6 samples/s | 54.1 steps/s
[Step=32850 Epoch=64.1] | Loss=0.02253 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=2.909 | 3864.9 samples/s | 60.4 steps/s
[Step=32900 Epoch=64.2] | Loss=0.01498 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=2.909 | 3904.5 samples/s | 61.0 steps/s
[Step=32950 Epoch=64.3] | Loss=0.01186 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=2.909 | 3867.1 samples/s | 60.4 steps/s
[Step=33000 Epoch=64.4] | Loss=0.01010 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.368 | FP-Norm(final)=2.910 | 3884.8 samples/s | 60.7 steps/s
[Step=33050 Epoch=64.5] | Loss=0.00901 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=2.910 | 3903.3 samples/s | 61.0 steps/s
[Step=33100 Epoch=64.6] | Loss=0.00833 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.365 | FP-Norm(final)=2.911 | 3903.6 samples/s | 61.0 steps/s
[Step=33150 Epoch=64.7] | Loss=0.00780 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=2.911 | 3872.9 samples/s | 60.5 steps/s
[Step=33200 Epoch=64.8] | Loss=0.00743 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.363 | FP-Norm(final)=2.912 | 3858.0 samples/s | 60.3 steps/s
[Step=33250 Epoch=64.9] | Loss=0.00715 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=2.913 | 3903.5 samples/s | 61.0 steps/s
[Step=33300 Epoch=64.9] | Loss=0.00709 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.361 | FP-Norm(final)=2.913 | 4587.3 samples/s | 71.7 steps/s
[Step=33350 Epoch=65.0] | Loss=0.00672 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.361 | FP-Norm(final)=2.914 | 1660.4 samples/s | 25.9 steps/s
[Step=33400 Epoch=65.1] | Loss=0.00650 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.914 | 3853.8 samples/s | 60.2 steps/s
[Step=33450 Epoch=65.2] | Loss=0.00630 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.915 | 3847.4 samples/s | 60.1 steps/s
[Step=33500 Epoch=65.3] | Loss=0.00613 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=2.915 | 3893.1 samples/s | 60.8 steps/s
[Step=33550 Epoch=65.4] | Loss=0.00599 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=2.916 | 3885.4 samples/s | 60.7 steps/s
[Step=33600 Epoch=65.5] | Loss=0.00587 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=2.916 | 3867.6 samples/s | 60.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step33600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=64.1] | Loss=0.20426 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.908 | 3631.8 samples/s | 56.7 steps/s
[Step=32850 Epoch=64.2] | Loss=0.02259 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.331 | FP-Norm(final)=2.908 | 3916.8 samples/s | 61.2 steps/s
[Step=32900 Epoch=64.3] | Loss=0.01357 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=2.908 | 3983.7 samples/s | 62.2 steps/s
[Step=32950 Epoch=64.4] | Loss=0.01102 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.346 | FP-Norm(final)=2.909 | 3985.6 samples/s | 62.3 steps/s
[Step=33000 Epoch=64.5] | Loss=0.00983 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.345 | FP-Norm(final)=2.909 | 3909.2 samples/s | 61.1 steps/s
[Step=33050 Epoch=64.6] | Loss=0.00880 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.344 | FP-Norm(final)=2.910 | 3885.4 samples/s | 60.7 steps/s
[Step=33100 Epoch=64.7] | Loss=0.00817 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=2.910 | 3841.7 samples/s | 60.0 steps/s
[Step=33150 Epoch=64.8] | Loss=0.00789 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.341 | FP-Norm(final)=2.911 | 3882.6 samples/s | 60.7 steps/s
[Step=33200 Epoch=64.9] | Loss=0.00742 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.342 | FP-Norm(final)=2.911 | 3890.1 samples/s | 60.8 steps/s
[Step=33250 Epoch=65.0] | Loss=0.00716 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=2.912 | 3877.0 samples/s | 60.6 steps/s
[Step=33300 Epoch=65.1] | Loss=0.00687 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=2.912 | 4645.9 samples/s | 72.6 steps/s
[Step=33350 Epoch=65.2] | Loss=0.00664 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=2.913 | 1689.6 samples/s | 26.4 steps/s
[Step=33400 Epoch=65.3] | Loss=0.00640 | Reg=0.00012 | acc=0.9688 | FP-Norm=0.341 | FP-Norm(final)=2.913 | 3882.0 samples/s | 60.7 steps/s
[Step=33450 Epoch=65.4] | Loss=0.00617 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=2.914 | 3853.0 samples/s | 60.2 steps/s
[Step=33500 Epoch=65.5] | Loss=0.00599 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=2.915 | 3884.1 samples/s | 60.7 steps/s
[Step=33550 Epoch=65.6] | Loss=0.00596 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=2.915 | 3851.3 samples/s | 60.2 steps/s
[Step=33600 Epoch=65.7] | Loss=0.00582 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=2.916 | 3904.2 samples/s | 61.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step33600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=125.7] | Loss=0.05292 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.908 | 3621.8 samples/s | 56.6 steps/s
[Step=32850 Epoch=125.9] | Loss=0.00578 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.909 | 3695.5 samples/s | 57.7 steps/s
[Step=32900 Epoch=126.1] | Loss=0.00293 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.430 | FP-Norm(final)=2.910 | 3660.0 samples/s | 57.2 steps/s
[Step=32950 Epoch=126.3] | Loss=0.00197 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=2.910 | 3667.9 samples/s | 57.3 steps/s
[Step=33000 Epoch=126.4] | Loss=0.00149 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.910 | 3693.6 samples/s | 57.7 steps/s
[Step=33050 Epoch=126.6] | Loss=0.00120 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.910 | 4535.7 samples/s | 70.9 steps/s
[Step=33100 Epoch=126.8] | Loss=0.00100 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.910 | 1647.0 samples/s | 25.7 steps/s
[Step=33150 Epoch=127.0] | Loss=0.00086 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=2.910 | 3721.1 samples/s | 58.1 steps/s
[Step=33200 Epoch=127.2] | Loss=0.00076 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.911 | 3710.5 samples/s | 58.0 steps/s
[Step=33250 Epoch=127.4] | Loss=0.00068 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.911 | 3675.5 samples/s | 57.4 steps/s
[Step=33300 Epoch=127.6] | Loss=0.00062 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.911 | 4053.9 samples/s | 63.3 steps/s
[Step=33350 Epoch=127.8] | Loss=0.00056 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.911 | 1728.1 samples/s | 27.0 steps/s
[Step=33400 Epoch=128.0] | Loss=0.00052 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=2.911 | 3787.7 samples/s | 59.2 steps/s
[Step=33450 Epoch=128.2] | Loss=0.00048 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.911 | 3791.6 samples/s | 59.2 steps/s
[Step=33500 Epoch=128.4] | Loss=0.00045 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=2.911 | 3720.2 samples/s | 58.1 steps/s
[Step=33550 Epoch=128.6] | Loss=0.00042 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=2.911 | 3701.6 samples/s | 57.8 steps/s
[Step=33600 Epoch=128.7] | Loss=0.00040 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.911 | 1768.4 samples/s | 27.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step33600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=126.3] | Loss=0.06308 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.908 | 3491.3 samples/s | 54.6 steps/s
[Step=32850 Epoch=126.5] | Loss=0.00640 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.908 | 3722.9 samples/s | 58.2 steps/s
[Step=32900 Epoch=126.6] | Loss=0.00323 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.909 | 3820.0 samples/s | 59.7 steps/s
[Step=32950 Epoch=126.8] | Loss=0.00218 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.909 | 3756.9 samples/s | 58.7 steps/s
[Step=33000 Epoch=127.0] | Loss=0.00164 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=2.909 | 3661.1 samples/s | 57.2 steps/s
[Step=33050 Epoch=127.2] | Loss=0.00132 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.909 | 4570.1 samples/s | 71.4 steps/s
[Step=33100 Epoch=127.4] | Loss=0.00111 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.909 | 1625.8 samples/s | 25.4 steps/s
[Step=33150 Epoch=127.6] | Loss=0.00096 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.909 | 3727.1 samples/s | 58.2 steps/s
[Step=33200 Epoch=127.8] | Loss=0.00084 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.909 | 3678.5 samples/s | 57.5 steps/s
[Step=33250 Epoch=128.0] | Loss=0.00075 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=2.909 | 3691.6 samples/s | 57.7 steps/s
[Step=33300 Epoch=128.2] | Loss=0.00068 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=2.910 | 4140.2 samples/s | 64.7 steps/s
[Step=33350 Epoch=128.4] | Loss=0.00062 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.910 | 1226.4 samples/s | 19.2 steps/s
[Step=33400 Epoch=128.6] | Loss=0.00057 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=2.910 | 3707.5 samples/s | 57.9 steps/s
[Step=33450 Epoch=128.8] | Loss=0.00053 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=2.910 | 3483.8 samples/s | 54.4 steps/s
[Step=33500 Epoch=129.0] | Loss=0.00049 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.910 | 3665.8 samples/s | 57.3 steps/s
[Step=33550 Epoch=129.1] | Loss=0.00046 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.910 | 3531.5 samples/s | 55.2 steps/s
[Step=33600 Epoch=129.3] | Loss=0.00043 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.910 | 1761.0 samples/s | 27.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22639 | acc=0.8898 | tpr=0.8442 | fpr=0.0114 | 3855.5 samples/s | 15.1 steps/s
Avg test loss: 0.23528, Avg test acc: 0.88797, Avg tpr: 0.84339, Avg fpr: 0.01397, total FA: 109

Testing server on iccad2012
[Step=  50] | Loss=0.40517 | acc=0.8773 | tpr=0.9425 | fpr=0.1239 | 3817.8 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.40795 | acc=0.8788 | tpr=0.9595 | fpr=0.1227 | 7322.5 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.41622 | acc=0.8761 | tpr=0.9611 | fpr=0.1255 | 7403.3 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.42175 | acc=0.8760 | tpr=0.9628 | fpr=0.1256 | 7043.7 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.41636 | acc=0.8763 | tpr=0.9642 | fpr=0.1253 | 7208.7 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.41921 | acc=0.8768 | tpr=0.9607 | fpr=0.1248 | 7259.5 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.42356 | acc=0.8760 | tpr=0.9612 | fpr=0.1255 | 7107.3 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.42438 | acc=0.8757 | tpr=0.9579 | fpr=0.1258 | 7461.9 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.42699 | acc=0.8756 | tpr=0.9572 | fpr=0.1259 | 6949.9 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.42678 | acc=0.8756 | tpr=0.9590 | fpr=0.1259 | 7259.4 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.42573 | acc=0.8757 | tpr=0.9578 | fpr=0.1258 | 12984.7 samples/s | 50.7 steps/s
Avg test loss: 0.42563, Avg test acc: 0.87575, Avg tpr: 0.95721, Avg fpr: 0.12573, total FA: 17457

server round 42/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=65.5] | Loss=0.13058 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.918 | 3704.3 samples/s | 57.9 steps/s
[Step=33650 Epoch=65.6] | Loss=0.02494 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=2.917 | 3632.4 samples/s | 56.8 steps/s
[Step=33700 Epoch=65.7] | Loss=0.01588 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=2.917 | 3884.5 samples/s | 60.7 steps/s
[Step=33750 Epoch=65.8] | Loss=0.01315 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=2.917 | 3864.4 samples/s | 60.4 steps/s
[Step=33800 Epoch=65.9] | Loss=0.01096 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=2.918 | 3876.6 samples/s | 60.6 steps/s
[Step=33850 Epoch=66.0] | Loss=0.00951 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=2.918 | 3894.2 samples/s | 60.8 steps/s
[Step=33900 Epoch=66.1] | Loss=0.00867 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.919 | 3914.6 samples/s | 61.2 steps/s
[Step=33950 Epoch=66.2] | Loss=0.00819 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=2.919 | 3868.2 samples/s | 60.4 steps/s
[Step=34000 Epoch=66.3] | Loss=0.00771 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.361 | FP-Norm(final)=2.920 | 4025.3 samples/s | 62.9 steps/s
[Step=34050 Epoch=66.4] | Loss=0.00744 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.920 | 3992.1 samples/s | 62.4 steps/s
[Step=34100 Epoch=66.5] | Loss=0.00734 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.921 | 4745.6 samples/s | 74.2 steps/s
[Step=34150 Epoch=66.6] | Loss=0.00712 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.921 | 1657.7 samples/s | 25.9 steps/s
[Step=34200 Epoch=66.7] | Loss=0.00693 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.922 | 3933.2 samples/s | 61.5 steps/s
[Step=34250 Epoch=66.8] | Loss=0.00665 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=2.922 | 3976.9 samples/s | 62.1 steps/s
[Step=34300 Epoch=66.9] | Loss=0.00639 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=2.923 | 3943.3 samples/s | 61.6 steps/s
[Step=34350 Epoch=67.0] | Loss=0.00623 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=2.923 | 3972.7 samples/s | 62.1 steps/s
[Step=34400 Epoch=67.1] | Loss=0.00612 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=2.924 | 3920.7 samples/s | 61.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step34400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=65.7] | Loss=0.18911 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.918 | 3615.4 samples/s | 56.5 steps/s
[Step=33650 Epoch=65.8] | Loss=0.01984 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.326 | FP-Norm(final)=2.918 | 3931.9 samples/s | 61.4 steps/s
[Step=33700 Epoch=65.9] | Loss=0.01324 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=2.919 | 3985.5 samples/s | 62.3 steps/s
[Step=33750 Epoch=66.0] | Loss=0.01058 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=2.919 | 4000.6 samples/s | 62.5 steps/s
[Step=33800 Epoch=66.1] | Loss=0.00918 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.920 | 3966.5 samples/s | 62.0 steps/s
[Step=33850 Epoch=66.2] | Loss=0.00821 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=2.921 | 3994.6 samples/s | 62.4 steps/s
[Step=33900 Epoch=66.3] | Loss=0.00753 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.344 | FP-Norm(final)=2.921 | 3861.6 samples/s | 60.3 steps/s
[Step=33950 Epoch=66.4] | Loss=0.00724 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.922 | 3886.9 samples/s | 60.7 steps/s
[Step=34000 Epoch=66.5] | Loss=0.00690 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=2.922 | 3887.6 samples/s | 60.7 steps/s
[Step=34050 Epoch=66.6] | Loss=0.00673 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.345 | FP-Norm(final)=2.923 | 3921.7 samples/s | 61.3 steps/s
[Step=34100 Epoch=66.7] | Loss=0.00646 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.345 | FP-Norm(final)=2.923 | 4653.3 samples/s | 72.7 steps/s
[Step=34150 Epoch=66.8] | Loss=0.00631 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=2.924 | 1720.3 samples/s | 26.9 steps/s
[Step=34200 Epoch=66.9] | Loss=0.00611 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.924 | 3940.4 samples/s | 61.6 steps/s
[Step=34250 Epoch=67.0] | Loss=0.00593 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.344 | FP-Norm(final)=2.925 | 3873.0 samples/s | 60.5 steps/s
[Step=34300 Epoch=67.1] | Loss=0.00575 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=2.925 | 3889.8 samples/s | 60.8 steps/s
[Step=34350 Epoch=67.2] | Loss=0.00559 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=2.926 | 3896.5 samples/s | 60.9 steps/s
[Step=34400 Epoch=67.3] | Loss=0.00555 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.342 | FP-Norm(final)=2.926 | 3889.9 samples/s | 60.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step34400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=128.7] | Loss=0.00388 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.918 | 3621.4 samples/s | 56.6 steps/s
[Step=33650 Epoch=128.9] | Loss=0.00856 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.918 | 3596.8 samples/s | 56.2 steps/s
[Step=33700 Epoch=129.1] | Loss=0.00430 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.466 | FP-Norm(final)=2.918 | 3690.6 samples/s | 57.7 steps/s
[Step=33750 Epoch=129.3] | Loss=0.00288 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.918 | 3691.5 samples/s | 57.7 steps/s
[Step=33800 Epoch=129.5] | Loss=0.00217 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.458 | FP-Norm(final)=2.918 | 3667.1 samples/s | 57.3 steps/s
[Step=33850 Epoch=129.7] | Loss=0.00174 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.451 | FP-Norm(final)=2.918 | 4486.1 samples/s | 70.1 steps/s
[Step=33900 Epoch=129.9] | Loss=0.00146 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.918 | 1678.3 samples/s | 26.2 steps/s
[Step=33950 Epoch=130.1] | Loss=0.00125 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=2.918 | 3777.7 samples/s | 59.0 steps/s
[Step=34000 Epoch=130.3] | Loss=0.00110 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.434 | FP-Norm(final)=2.918 | 3754.8 samples/s | 58.7 steps/s
[Step=34050 Epoch=130.5] | Loss=0.00098 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.918 | 3793.5 samples/s | 59.3 steps/s
[Step=34100 Epoch=130.7] | Loss=0.00088 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=2.918 | 4112.0 samples/s | 64.3 steps/s
[Step=34150 Epoch=130.9] | Loss=0.00081 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=2.918 | 1735.0 samples/s | 27.1 steps/s
[Step=34200 Epoch=131.0] | Loss=0.00074 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.918 | 3668.0 samples/s | 57.3 steps/s
[Step=34250 Epoch=131.2] | Loss=0.00068 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.919 | 3653.0 samples/s | 57.1 steps/s
[Step=34300 Epoch=131.4] | Loss=0.00064 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.919 | 3708.2 samples/s | 57.9 steps/s
[Step=34350 Epoch=131.6] | Loss=0.00060 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.919 | 3669.6 samples/s | 57.3 steps/s
[Step=34400 Epoch=131.8] | Loss=0.00056 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.919 | 1778.2 samples/s | 27.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step34400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=129.3] | Loss=0.12776 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.918 | 3508.2 samples/s | 54.8 steps/s
[Step=33650 Epoch=129.5] | Loss=0.00880 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=2.918 | 3685.2 samples/s | 57.6 steps/s
[Step=33700 Epoch=129.7] | Loss=0.00443 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.462 | FP-Norm(final)=2.918 | 3689.2 samples/s | 57.6 steps/s
[Step=33750 Epoch=129.9] | Loss=0.00297 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.460 | FP-Norm(final)=2.918 | 3664.1 samples/s | 57.3 steps/s
[Step=33800 Epoch=130.1] | Loss=0.00223 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=2.918 | 3715.9 samples/s | 58.1 steps/s
[Step=33850 Epoch=130.3] | Loss=0.00179 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.447 | FP-Norm(final)=2.918 | 4580.8 samples/s | 71.6 steps/s
[Step=33900 Epoch=130.5] | Loss=0.00150 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.918 | 1647.7 samples/s | 25.7 steps/s
[Step=33950 Epoch=130.7] | Loss=0.00129 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.436 | FP-Norm(final)=2.918 | 3693.5 samples/s | 57.7 steps/s
[Step=34000 Epoch=130.9] | Loss=0.00113 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.430 | FP-Norm(final)=2.918 | 3677.0 samples/s | 57.5 steps/s
[Step=34050 Epoch=131.1] | Loss=0.00101 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.918 | 3682.9 samples/s | 57.5 steps/s
[Step=34100 Epoch=131.3] | Loss=0.00091 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=2.919 | 4314.1 samples/s | 67.4 steps/s
[Step=34150 Epoch=131.5] | Loss=0.00083 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=2.919 | 1741.8 samples/s | 27.2 steps/s
[Step=34200 Epoch=131.6] | Loss=0.00076 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=2.919 | 3840.7 samples/s | 60.0 steps/s
[Step=34250 Epoch=131.8] | Loss=0.00070 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.919 | 3782.8 samples/s | 59.1 steps/s
[Step=34300 Epoch=132.0] | Loss=0.00066 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.919 | 3768.2 samples/s | 58.9 steps/s
[Step=34350 Epoch=132.2] | Loss=0.00061 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.919 | 3873.3 samples/s | 60.5 steps/s
[Step=34400 Epoch=132.4] | Loss=0.00058 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.919 | 1772.2 samples/s | 27.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23801 | acc=0.8845 | tpr=0.8366 | fpr=0.0114 | 3823.6 samples/s | 14.9 steps/s
Avg test loss: 0.24667, Avg test acc: 0.88260, Avg tpr: 0.83564, Avg fpr: 0.01410, total FA: 110

Testing server on iccad2012
[Step=  50] | Loss=0.36775 | acc=0.8913 | tpr=0.9381 | fpr=0.1095 | 3835.5 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.37098 | acc=0.8936 | tpr=0.9574 | fpr=0.1076 | 7280.2 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.37861 | acc=0.8910 | tpr=0.9611 | fpr=0.1103 | 7507.1 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.38387 | acc=0.8905 | tpr=0.9628 | fpr=0.1108 | 7228.9 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.37882 | acc=0.8904 | tpr=0.9633 | fpr=0.1109 | 7360.8 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.38190 | acc=0.8905 | tpr=0.9607 | fpr=0.1108 | 7271.6 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.38609 | acc=0.8899 | tpr=0.9612 | fpr=0.1114 | 7329.6 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.38698 | acc=0.8898 | tpr=0.9579 | fpr=0.1115 | 7216.2 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.38955 | acc=0.8896 | tpr=0.9572 | fpr=0.1116 | 7629.3 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.38934 | acc=0.8896 | tpr=0.9590 | fpr=0.1116 | 6827.0 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.38836 | acc=0.8897 | tpr=0.9578 | fpr=0.1115 | 13035.5 samples/s | 50.9 steps/s
Avg test loss: 0.38821, Avg test acc: 0.88977, Avg tpr: 0.95721, Avg fpr: 0.11146, total FA: 15476

server round 43/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=67.1] | Loss=0.08720 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.926 | 3241.0 samples/s | 50.6 steps/s
[Step=34450 Epoch=67.2] | Loss=0.02183 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=2.926 | 3959.5 samples/s | 61.9 steps/s
[Step=34500 Epoch=67.3] | Loss=0.01399 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.364 | FP-Norm(final)=2.927 | 3922.7 samples/s | 61.3 steps/s
[Step=34550 Epoch=67.4] | Loss=0.01075 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.366 | FP-Norm(final)=2.927 | 3910.5 samples/s | 61.1 steps/s
[Step=34600 Epoch=67.5] | Loss=0.00921 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=2.928 | 3886.2 samples/s | 60.7 steps/s
[Step=34650 Epoch=67.6] | Loss=0.00822 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.928 | 3889.5 samples/s | 60.8 steps/s
[Step=34700 Epoch=67.7] | Loss=0.00810 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.365 | FP-Norm(final)=2.929 | 3895.3 samples/s | 60.9 steps/s
[Step=34750 Epoch=67.8] | Loss=0.00760 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.364 | FP-Norm(final)=2.929 | 3906.7 samples/s | 61.0 steps/s
[Step=34800 Epoch=67.9] | Loss=0.00727 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=2.930 | 3877.9 samples/s | 60.6 steps/s
[Step=34850 Epoch=68.0] | Loss=0.00694 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.930 | 3902.9 samples/s | 61.0 steps/s
[Step=34900 Epoch=68.1] | Loss=0.00678 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.931 | 4583.1 samples/s | 71.6 steps/s
[Step=34950 Epoch=68.2] | Loss=0.00663 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.931 | 1640.6 samples/s | 25.6 steps/s
[Step=35000 Epoch=68.3] | Loss=0.00646 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=2.932 | 3896.9 samples/s | 60.9 steps/s
[Step=35050 Epoch=68.4] | Loss=0.00628 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=2.932 | 3868.5 samples/s | 60.4 steps/s
[Step=35100 Epoch=68.5] | Loss=0.00616 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=2.933 | 3894.7 samples/s | 60.9 steps/s
[Step=35150 Epoch=68.6] | Loss=0.00606 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=2.933 | 3864.8 samples/s | 60.4 steps/s
[Step=35200 Epoch=68.7] | Loss=0.00596 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=2.934 | 3885.5 samples/s | 60.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step35200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=67.3] | Loss=0.22293 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.926 | 3666.7 samples/s | 57.3 steps/s
[Step=34450 Epoch=67.3] | Loss=0.02129 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=2.926 | 3839.2 samples/s | 60.0 steps/s
[Step=34500 Epoch=67.4] | Loss=0.01433 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=2.927 | 3893.7 samples/s | 60.8 steps/s
[Step=34550 Epoch=67.5] | Loss=0.01130 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=2.927 | 3854.8 samples/s | 60.2 steps/s
[Step=34600 Epoch=67.6] | Loss=0.00933 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=2.928 | 3833.3 samples/s | 59.9 steps/s
[Step=34650 Epoch=67.7] | Loss=0.00852 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.350 | FP-Norm(final)=2.928 | 3882.3 samples/s | 60.7 steps/s
[Step=34700 Epoch=67.8] | Loss=0.00806 | Reg=0.00013 | acc=0.9688 | FP-Norm=0.351 | FP-Norm(final)=2.929 | 3885.9 samples/s | 60.7 steps/s
[Step=34750 Epoch=67.9] | Loss=0.00746 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=2.929 | 3910.7 samples/s | 61.1 steps/s
[Step=34800 Epoch=68.0] | Loss=0.00723 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=2.930 | 3900.6 samples/s | 60.9 steps/s
[Step=34850 Epoch=68.1] | Loss=0.00688 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=2.930 | 3886.3 samples/s | 60.7 steps/s
[Step=34900 Epoch=68.2] | Loss=0.00661 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=2.931 | 4643.4 samples/s | 72.6 steps/s
[Step=34950 Epoch=68.3] | Loss=0.00623 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=2.932 | 1715.1 samples/s | 26.8 steps/s
[Step=35000 Epoch=68.4] | Loss=0.00602 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=2.932 | 3798.8 samples/s | 59.4 steps/s
[Step=35050 Epoch=68.5] | Loss=0.00598 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.349 | FP-Norm(final)=2.933 | 3944.5 samples/s | 61.6 steps/s
[Step=35100 Epoch=68.6] | Loss=0.00584 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=2.933 | 3908.2 samples/s | 61.1 steps/s
[Step=35150 Epoch=68.7] | Loss=0.00566 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=2.934 | 4001.8 samples/s | 62.5 steps/s
[Step=35200 Epoch=68.8] | Loss=0.00553 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=2.934 | 4024.6 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step35200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=131.8] | Loss=0.00712 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.926 | 3641.4 samples/s | 56.9 steps/s
[Step=34450 Epoch=132.0] | Loss=0.00587 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=2.927 | 3529.4 samples/s | 55.1 steps/s
[Step=34500 Epoch=132.2] | Loss=0.00296 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.928 | 3699.6 samples/s | 57.8 steps/s
[Step=34550 Epoch=132.4] | Loss=0.00199 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.928 | 3693.5 samples/s | 57.7 steps/s
[Step=34600 Epoch=132.6] | Loss=0.00150 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=2.928 | 3735.0 samples/s | 58.4 steps/s
[Step=34650 Epoch=132.8] | Loss=0.00121 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=2.928 | 4479.8 samples/s | 70.0 steps/s
[Step=34700 Epoch=133.0] | Loss=0.00102 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=2.928 | 1637.7 samples/s | 25.6 steps/s
[Step=34750 Epoch=133.1] | Loss=0.00088 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.928 | 3631.2 samples/s | 56.7 steps/s
[Step=34800 Epoch=133.3] | Loss=0.00077 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.928 | 3662.8 samples/s | 57.2 steps/s
[Step=34850 Epoch=133.5] | Loss=0.00069 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=2.928 | 3713.5 samples/s | 58.0 steps/s
[Step=34900 Epoch=133.7] | Loss=0.00062 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=2.929 | 4029.3 samples/s | 63.0 steps/s
[Step=34950 Epoch=133.9] | Loss=0.00057 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=2.929 | 1741.6 samples/s | 27.2 steps/s
[Step=35000 Epoch=134.1] | Loss=0.00052 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=2.929 | 3779.3 samples/s | 59.1 steps/s
[Step=35050 Epoch=134.3] | Loss=0.00048 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=2.929 | 3789.8 samples/s | 59.2 steps/s
[Step=35100 Epoch=134.5] | Loss=0.00045 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=2.929 | 3793.1 samples/s | 59.3 steps/s
[Step=35150 Epoch=134.7] | Loss=0.00042 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=2.929 | 3666.6 samples/s | 57.3 steps/s
[Step=35200 Epoch=134.9] | Loss=0.00040 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=2.929 | 1753.0 samples/s | 27.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step35200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=132.4] | Loss=0.06480 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.926 | 3556.0 samples/s | 55.6 steps/s
[Step=34450 Epoch=132.6] | Loss=0.00663 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=2.926 | 3647.9 samples/s | 57.0 steps/s
[Step=34500 Epoch=132.8] | Loss=0.00336 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.927 | 3752.6 samples/s | 58.6 steps/s
[Step=34550 Epoch=133.0] | Loss=0.00226 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=2.927 | 3668.5 samples/s | 57.3 steps/s
[Step=34600 Epoch=133.2] | Loss=0.00170 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.927 | 3695.9 samples/s | 57.7 steps/s
[Step=34650 Epoch=133.4] | Loss=0.00137 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=2.927 | 4551.9 samples/s | 71.1 steps/s
[Step=34700 Epoch=133.6] | Loss=0.00115 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=2.927 | 1649.4 samples/s | 25.8 steps/s
[Step=34750 Epoch=133.8] | Loss=0.00099 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=2.927 | 3794.0 samples/s | 59.3 steps/s
[Step=34800 Epoch=134.0] | Loss=0.00087 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.928 | 3800.3 samples/s | 59.4 steps/s
[Step=34850 Epoch=134.2] | Loss=0.00077 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.928 | 3733.8 samples/s | 58.3 steps/s
[Step=34900 Epoch=134.3] | Loss=0.00070 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=2.928 | 4124.4 samples/s | 64.4 steps/s
[Step=34950 Epoch=134.5] | Loss=0.00064 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=2.928 | 1708.2 samples/s | 26.7 steps/s
[Step=35000 Epoch=134.7] | Loss=0.00059 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=2.928 | 3804.9 samples/s | 59.5 steps/s
[Step=35050 Epoch=134.9] | Loss=0.00055 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=2.928 | 3765.5 samples/s | 58.8 steps/s
[Step=35100 Epoch=135.1] | Loss=0.00051 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=2.928 | 3798.2 samples/s | 59.3 steps/s
[Step=35150 Epoch=135.3] | Loss=0.00048 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=2.928 | 3815.4 samples/s | 59.6 steps/s
[Step=35200 Epoch=135.5] | Loss=0.00045 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=2.928 | 1784.7 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23009 | acc=0.8893 | tpr=0.8436 | fpr=0.0114 | 3838.7 samples/s | 15.0 steps/s
Avg test loss: 0.23861, Avg test acc: 0.88809, Avg tpr: 0.84345, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.38600 | acc=0.8853 | tpr=0.9381 | fpr=0.1156 | 3869.4 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.38938 | acc=0.8877 | tpr=0.9552 | fpr=0.1136 | 7235.2 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.39719 | acc=0.8849 | tpr=0.9597 | fpr=0.1165 | 7171.6 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.40259 | acc=0.8847 | tpr=0.9617 | fpr=0.1167 | 7219.9 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.39767 | acc=0.8844 | tpr=0.9624 | fpr=0.1170 | 7392.5 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.40073 | acc=0.8848 | tpr=0.9600 | fpr=0.1166 | 7250.6 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.40509 | acc=0.8843 | tpr=0.9606 | fpr=0.1171 | 7312.9 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.40600 | acc=0.8841 | tpr=0.9568 | fpr=0.1172 | 7328.2 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.40856 | acc=0.8839 | tpr=0.9562 | fpr=0.1175 | 7238.1 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.40836 | acc=0.8839 | tpr=0.9581 | fpr=0.1174 | 7209.2 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.40737 | acc=0.8841 | tpr=0.9570 | fpr=0.1173 | 12793.9 samples/s | 50.0 steps/s
Avg test loss: 0.40723, Avg test acc: 0.88407, Avg tpr: 0.95642, Avg fpr: 0.11724, total FA: 16279

server round 44/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=68.7] | Loss=0.10601 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.935 | 3488.2 samples/s | 54.5 steps/s
[Step=35250 Epoch=68.8] | Loss=0.02210 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=2.936 | 3826.2 samples/s | 59.8 steps/s
[Step=35300 Epoch=68.8] | Loss=0.01427 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=2.936 | 3947.3 samples/s | 61.7 steps/s
[Step=35350 Epoch=68.9] | Loss=0.01125 | Reg=0.00014 | acc=0.9688 | FP-Norm=0.367 | FP-Norm(final)=2.936 | 3920.8 samples/s | 61.3 steps/s
[Step=35400 Epoch=69.0] | Loss=0.00942 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.937 | 3894.8 samples/s | 60.9 steps/s
[Step=35450 Epoch=69.1] | Loss=0.00894 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=2.937 | 3883.8 samples/s | 60.7 steps/s
[Step=35500 Epoch=69.2] | Loss=0.00825 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=2.938 | 3858.7 samples/s | 60.3 steps/s
[Step=35550 Epoch=69.3] | Loss=0.00764 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.938 | 3896.2 samples/s | 60.9 steps/s
[Step=35600 Epoch=69.4] | Loss=0.00742 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.362 | FP-Norm(final)=2.939 | 4004.1 samples/s | 62.6 steps/s
[Step=35650 Epoch=69.5] | Loss=0.00715 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.939 | 4024.9 samples/s | 62.9 steps/s
[Step=35700 Epoch=69.6] | Loss=0.00700 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.940 | 4586.0 samples/s | 71.7 steps/s
[Step=35750 Epoch=69.7] | Loss=0.00676 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.940 | 1693.4 samples/s | 26.5 steps/s
[Step=35800 Epoch=69.8] | Loss=0.00651 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=2.940 | 3871.7 samples/s | 60.5 steps/s
[Step=35850 Epoch=69.9] | Loss=0.00637 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=2.941 | 3857.1 samples/s | 60.3 steps/s
[Step=35900 Epoch=70.0] | Loss=0.00624 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=2.941 | 3850.2 samples/s | 60.2 steps/s
[Step=35950 Epoch=70.1] | Loss=0.00615 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=2.942 | 3879.4 samples/s | 60.6 steps/s
[Step=36000 Epoch=70.2] | Loss=0.00595 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=2.942 | 3899.5 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=68.8] | Loss=0.07140 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.935 | 3590.0 samples/s | 56.1 steps/s
[Step=35250 Epoch=68.9] | Loss=0.02154 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.332 | FP-Norm(final)=2.936 | 3898.2 samples/s | 60.9 steps/s
[Step=35300 Epoch=69.0] | Loss=0.01434 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=2.936 | 3969.5 samples/s | 62.0 steps/s
[Step=35350 Epoch=69.1] | Loss=0.01144 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=2.936 | 3944.5 samples/s | 61.6 steps/s
[Step=35400 Epoch=69.2] | Loss=0.00978 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=2.936 | 3975.5 samples/s | 62.1 steps/s
[Step=35450 Epoch=69.3] | Loss=0.00852 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=2.937 | 3878.7 samples/s | 60.6 steps/s
[Step=35500 Epoch=69.4] | Loss=0.00781 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.346 | FP-Norm(final)=2.937 | 3913.8 samples/s | 61.2 steps/s
[Step=35550 Epoch=69.5] | Loss=0.00739 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=2.938 | 3866.3 samples/s | 60.4 steps/s
[Step=35600 Epoch=69.6] | Loss=0.00700 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=2.938 | 3901.1 samples/s | 61.0 steps/s
[Step=35650 Epoch=69.7] | Loss=0.00686 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=2.939 | 3897.6 samples/s | 60.9 steps/s
[Step=35700 Epoch=69.8] | Loss=0.00651 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=2.939 | 4747.3 samples/s | 74.2 steps/s
[Step=35750 Epoch=69.9] | Loss=0.00632 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.343 | FP-Norm(final)=2.940 | 1701.1 samples/s | 26.6 steps/s
[Step=35800 Epoch=70.0] | Loss=0.00615 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.940 | 3873.6 samples/s | 60.5 steps/s
[Step=35850 Epoch=70.1] | Loss=0.00601 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=2.941 | 3905.5 samples/s | 61.0 steps/s
[Step=35900 Epoch=70.2] | Loss=0.00591 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.941 | 3882.5 samples/s | 60.7 steps/s
[Step=35950 Epoch=70.3] | Loss=0.00580 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.942 | 3869.4 samples/s | 60.5 steps/s
[Step=36000 Epoch=70.4] | Loss=0.00564 | Reg=0.00012 | acc=0.9688 | FP-Norm=0.343 | FP-Norm(final)=2.942 | 3898.5 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step36000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=134.9] | Loss=0.02895 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.935 | 3613.1 samples/s | 56.5 steps/s
[Step=35250 Epoch=135.1] | Loss=0.00450 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=2.936 | 3633.7 samples/s | 56.8 steps/s
[Step=35300 Epoch=135.3] | Loss=0.00228 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.936 | 3710.1 samples/s | 58.0 steps/s
[Step=35350 Epoch=135.4] | Loss=0.00153 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=2.937 | 3673.0 samples/s | 57.4 steps/s
[Step=35400 Epoch=135.6] | Loss=0.00116 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.937 | 3716.7 samples/s | 58.1 steps/s
[Step=35450 Epoch=135.8] | Loss=0.00093 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.937 | 4483.6 samples/s | 70.1 steps/s
[Step=35500 Epoch=136.0] | Loss=0.00078 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.937 | 1630.5 samples/s | 25.5 steps/s
[Step=35550 Epoch=136.2] | Loss=0.00067 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=2.937 | 3669.9 samples/s | 57.3 steps/s
[Step=35600 Epoch=136.4] | Loss=0.00059 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=2.937 | 3682.7 samples/s | 57.5 steps/s
[Step=35650 Epoch=136.6] | Loss=0.00053 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=2.937 | 3736.7 samples/s | 58.4 steps/s
[Step=35700 Epoch=136.8] | Loss=0.00048 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.937 | 4057.8 samples/s | 63.4 steps/s
[Step=35750 Epoch=137.0] | Loss=0.00044 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=2.937 | 1708.1 samples/s | 26.7 steps/s
[Step=35800 Epoch=137.2] | Loss=0.00040 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=2.937 | 3769.8 samples/s | 58.9 steps/s
[Step=35850 Epoch=137.4] | Loss=0.00037 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=2.937 | 3797.0 samples/s | 59.3 steps/s
[Step=35900 Epoch=137.6] | Loss=0.00035 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.937 | 3768.1 samples/s | 58.9 steps/s
[Step=35950 Epoch=137.7] | Loss=0.00033 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=2.937 | 3760.6 samples/s | 58.8 steps/s
[Step=36000 Epoch=137.9] | Loss=0.00031 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=2.937 | 1780.2 samples/s | 27.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step36000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=135.5] | Loss=0.12638 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.935 | 3476.2 samples/s | 54.3 steps/s
[Step=35250 Epoch=135.7] | Loss=0.00660 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.936 | 3691.7 samples/s | 57.7 steps/s
[Step=35300 Epoch=135.9] | Loss=0.00332 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.937 | 3696.7 samples/s | 57.8 steps/s
[Step=35350 Epoch=136.1] | Loss=0.00223 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.937 | 3696.6 samples/s | 57.8 steps/s
[Step=35400 Epoch=136.3] | Loss=0.00168 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.937 | 3665.7 samples/s | 57.3 steps/s
[Step=35450 Epoch=136.5] | Loss=0.00135 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.937 | 4581.1 samples/s | 71.6 steps/s
[Step=35500 Epoch=136.7] | Loss=0.00113 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=2.937 | 1633.2 samples/s | 25.5 steps/s
[Step=35550 Epoch=136.8] | Loss=0.00097 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=2.937 | 3679.4 samples/s | 57.5 steps/s
[Step=35600 Epoch=137.0] | Loss=0.00085 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=2.937 | 3690.9 samples/s | 57.7 steps/s
[Step=35650 Epoch=137.2] | Loss=0.00076 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.937 | 3697.3 samples/s | 57.8 steps/s
[Step=35700 Epoch=137.4] | Loss=0.00069 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=2.937 | 4055.5 samples/s | 63.4 steps/s
[Step=35750 Epoch=137.6] | Loss=0.00063 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=2.937 | 1715.8 samples/s | 26.8 steps/s
[Step=35800 Epoch=137.8] | Loss=0.00057 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.937 | 3705.8 samples/s | 57.9 steps/s
[Step=35850 Epoch=138.0] | Loss=0.00053 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=2.937 | 3670.4 samples/s | 57.4 steps/s
[Step=35900 Epoch=138.2] | Loss=0.00050 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=2.937 | 3695.3 samples/s | 57.7 steps/s
[Step=35950 Epoch=138.4] | Loss=0.00046 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=2.937 | 3747.2 samples/s | 58.5 steps/s
[Step=36000 Epoch=138.6] | Loss=0.00044 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=2.937 | 1765.5 samples/s | 27.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22754 | acc=0.8898 | tpr=0.8445 | fpr=0.0116 | 3840.3 samples/s | 15.0 steps/s
Avg test loss: 0.23662, Avg test acc: 0.88793, Avg tpr: 0.84350, Avg fpr: 0.01436, total FA: 112

Testing server on iccad2012
[Step=  50] | Loss=0.38404 | acc=0.8870 | tpr=0.9381 | fpr=0.1139 | 3812.5 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.38795 | acc=0.8890 | tpr=0.9552 | fpr=0.1122 | 7396.1 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.39599 | acc=0.8862 | tpr=0.9597 | fpr=0.1151 | 7201.1 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.40143 | acc=0.8861 | tpr=0.9617 | fpr=0.1152 | 7394.0 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.39651 | acc=0.8860 | tpr=0.9624 | fpr=0.1154 | 7122.3 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.39957 | acc=0.8864 | tpr=0.9607 | fpr=0.1150 | 6842.5 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.40375 | acc=0.8858 | tpr=0.9612 | fpr=0.1156 | 7422.8 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.40469 | acc=0.8854 | tpr=0.9568 | fpr=0.1159 | 7075.2 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.40738 | acc=0.8850 | tpr=0.9562 | fpr=0.1163 | 7038.7 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.40722 | acc=0.8851 | tpr=0.9581 | fpr=0.1162 | 7036.0 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.40620 | acc=0.8853 | tpr=0.9570 | fpr=0.1160 | 13933.0 samples/s | 54.4 steps/s
Avg test loss: 0.40607, Avg test acc: 0.88532, Avg tpr: 0.95642, Avg fpr: 0.11597, total FA: 16102

server round 45/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=70.2] | Loss=0.17535 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.943 | 3234.2 samples/s | 50.5 steps/s
[Step=36050 Epoch=70.3] | Loss=0.01972 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.331 | FP-Norm(final)=2.944 | 3749.3 samples/s | 58.6 steps/s
[Step=36100 Epoch=70.4] | Loss=0.01269 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=2.944 | 3503.3 samples/s | 54.7 steps/s
[Step=36150 Epoch=70.5] | Loss=0.01039 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.344 | FP-Norm(final)=2.944 | 3775.2 samples/s | 59.0 steps/s
[Step=36200 Epoch=70.6] | Loss=0.00926 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=2.945 | 3613.6 samples/s | 56.5 steps/s
[Step=36250 Epoch=70.7] | Loss=0.00837 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=2.945 | 3476.4 samples/s | 54.3 steps/s
[Step=36300 Epoch=70.8] | Loss=0.00778 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=2.946 | 3603.7 samples/s | 56.3 steps/s
[Step=36350 Epoch=70.9] | Loss=0.00740 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=2.946 | 3660.2 samples/s | 57.2 steps/s
[Step=36400 Epoch=71.0] | Loss=0.00713 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.348 | FP-Norm(final)=2.947 | 3687.1 samples/s | 57.6 steps/s
[Step=36450 Epoch=71.1] | Loss=0.00691 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=2.947 | 3653.1 samples/s | 57.1 steps/s
[Step=36500 Epoch=71.2] | Loss=0.00665 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.347 | FP-Norm(final)=2.948 | 4351.5 samples/s | 68.0 steps/s
[Step=36550 Epoch=71.3] | Loss=0.00638 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=2.948 | 1612.4 samples/s | 25.2 steps/s
[Step=36600 Epoch=71.4] | Loss=0.00618 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=2.949 | 3814.0 samples/s | 59.6 steps/s
[Step=36650 Epoch=71.5] | Loss=0.00607 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=2.949 | 3816.9 samples/s | 59.6 steps/s
[Step=36700 Epoch=71.6] | Loss=0.00598 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=2.950 | 3914.9 samples/s | 61.2 steps/s
[Step=36750 Epoch=71.7] | Loss=0.00584 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.950 | 4018.7 samples/s | 62.8 steps/s
[Step=36800 Epoch=71.8] | Loss=0.00578 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.951 | 3978.8 samples/s | 62.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step36800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=70.4] | Loss=0.16335 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.943 | 3785.4 samples/s | 59.1 steps/s
[Step=36050 Epoch=70.5] | Loss=0.01899 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=2.944 | 3776.0 samples/s | 59.0 steps/s
[Step=36100 Epoch=70.6] | Loss=0.01224 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=2.944 | 3978.7 samples/s | 62.2 steps/s
[Step=36150 Epoch=70.7] | Loss=0.00935 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=2.945 | 3974.0 samples/s | 62.1 steps/s
[Step=36200 Epoch=70.8] | Loss=0.00809 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.945 | 3882.4 samples/s | 60.7 steps/s
[Step=36250 Epoch=70.9] | Loss=0.00728 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=2.946 | 3884.8 samples/s | 60.7 steps/s
[Step=36300 Epoch=71.0] | Loss=0.00688 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=2.946 | 3903.3 samples/s | 61.0 steps/s
[Step=36350 Epoch=71.1] | Loss=0.00682 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=2.947 | 3889.8 samples/s | 60.8 steps/s
[Step=36400 Epoch=71.2] | Loss=0.00674 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=2.947 | 3895.5 samples/s | 60.9 steps/s
[Step=36450 Epoch=71.3] | Loss=0.00649 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=2.948 | 3897.0 samples/s | 60.9 steps/s
[Step=36500 Epoch=71.4] | Loss=0.00623 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=2.948 | 4657.9 samples/s | 72.8 steps/s
[Step=36550 Epoch=71.5] | Loss=0.00607 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=2.949 | 1676.6 samples/s | 26.2 steps/s
[Step=36600 Epoch=71.6] | Loss=0.00596 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=2.949 | 3795.7 samples/s | 59.3 steps/s
[Step=36650 Epoch=71.6] | Loss=0.00577 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=2.950 | 3814.1 samples/s | 59.6 steps/s
[Step=36700 Epoch=71.7] | Loss=0.00563 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=2.950 | 3819.0 samples/s | 59.7 steps/s
[Step=36750 Epoch=71.8] | Loss=0.00551 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=2.951 | 3921.3 samples/s | 61.3 steps/s
[Step=36800 Epoch=71.9] | Loss=0.00545 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.333 | FP-Norm(final)=2.951 | 4006.0 samples/s | 62.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step36800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=137.9] | Loss=0.10062 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.943 | 3773.9 samples/s | 59.0 steps/s
[Step=36050 Epoch=138.1] | Loss=0.00393 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.331 | FP-Norm(final)=2.945 | 3432.7 samples/s | 53.6 steps/s
[Step=36100 Epoch=138.3] | Loss=0.00201 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=2.945 | 3670.1 samples/s | 57.3 steps/s
[Step=36150 Epoch=138.5] | Loss=0.00135 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=2.946 | 3816.5 samples/s | 59.6 steps/s
[Step=36200 Epoch=138.7] | Loss=0.00103 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=2.946 | 3776.5 samples/s | 59.0 steps/s
[Step=36250 Epoch=138.9] | Loss=0.00084 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=2.946 | 4572.4 samples/s | 71.4 steps/s
[Step=36300 Epoch=139.1] | Loss=0.00070 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=2.946 | 1650.4 samples/s | 25.8 steps/s
[Step=36350 Epoch=139.3] | Loss=0.00061 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.946 | 3742.0 samples/s | 58.5 steps/s
[Step=36400 Epoch=139.5] | Loss=0.00054 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=2.946 | 3777.9 samples/s | 59.0 steps/s
[Step=36450 Epoch=139.7] | Loss=0.00048 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=2.947 | 3753.9 samples/s | 58.7 steps/s
[Step=36500 Epoch=139.9] | Loss=0.00044 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=2.947 | 4051.3 samples/s | 63.3 steps/s
[Step=36550 Epoch=140.0] | Loss=0.00040 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=2.947 | 1731.8 samples/s | 27.1 steps/s
[Step=36600 Epoch=140.2] | Loss=0.00037 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.330 | FP-Norm(final)=2.947 | 3798.2 samples/s | 59.3 steps/s
[Step=36650 Epoch=140.4] | Loss=0.00034 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=2.947 | 3780.5 samples/s | 59.1 steps/s
[Step=36700 Epoch=140.6] | Loss=0.00032 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.325 | FP-Norm(final)=2.947 | 3847.0 samples/s | 60.1 steps/s
[Step=36750 Epoch=140.8] | Loss=0.00030 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.323 | FP-Norm(final)=2.947 | 3784.0 samples/s | 59.1 steps/s
[Step=36800 Epoch=141.0] | Loss=0.00028 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.321 | FP-Norm(final)=2.947 | 1812.7 samples/s | 28.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step36800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=138.6] | Loss=0.06409 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.943 | 3543.1 samples/s | 55.4 steps/s
[Step=36050 Epoch=138.8] | Loss=0.00560 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=2.945 | 3548.7 samples/s | 55.4 steps/s
[Step=36100 Epoch=139.0] | Loss=0.00282 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.946 | 3721.6 samples/s | 58.1 steps/s
[Step=36150 Epoch=139.2] | Loss=0.00190 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.946 | 3795.2 samples/s | 59.3 steps/s
[Step=36200 Epoch=139.3] | Loss=0.00143 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.946 | 3687.8 samples/s | 57.6 steps/s
[Step=36250 Epoch=139.5] | Loss=0.00115 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.946 | 4610.8 samples/s | 72.0 steps/s
[Step=36300 Epoch=139.7] | Loss=0.00096 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.946 | 1647.8 samples/s | 25.7 steps/s
[Step=36350 Epoch=139.9] | Loss=0.00083 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.946 | 3697.7 samples/s | 57.8 steps/s
[Step=36400 Epoch=140.1] | Loss=0.00073 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.946 | 3679.6 samples/s | 57.5 steps/s
[Step=36450 Epoch=140.3] | Loss=0.00065 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=2.946 | 3765.0 samples/s | 58.8 steps/s
[Step=36500 Epoch=140.5] | Loss=0.00059 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.946 | 4248.7 samples/s | 66.4 steps/s
[Step=36550 Epoch=140.7] | Loss=0.00053 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.946 | 1716.8 samples/s | 26.8 steps/s
[Step=36600 Epoch=140.9] | Loss=0.00049 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=2.946 | 3676.4 samples/s | 57.4 steps/s
[Step=36650 Epoch=141.1] | Loss=0.00046 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=2.946 | 3628.1 samples/s | 56.7 steps/s
[Step=36700 Epoch=141.3] | Loss=0.00042 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.946 | 3604.6 samples/s | 56.3 steps/s
[Step=36750 Epoch=141.5] | Loss=0.00040 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=2.946 | 3645.8 samples/s | 57.0 steps/s
[Step=36800 Epoch=141.7] | Loss=0.00037 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=2.947 | 1761.0 samples/s | 27.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21147 | acc=0.8987 | tpr=0.8578 | fpr=0.0126 | 3827.9 samples/s | 15.0 steps/s
Avg test loss: 0.22060, Avg test acc: 0.89631, Avg tpr: 0.85615, Avg fpr: 0.01538, total FA: 120

Testing server on iccad2012
[Step=  50] | Loss=0.40168 | acc=0.8811 | tpr=0.9381 | fpr=0.1199 | 3849.2 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.40538 | acc=0.8839 | tpr=0.9552 | fpr=0.1174 | 7246.7 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.41370 | acc=0.8816 | tpr=0.9597 | fpr=0.1198 | 7521.3 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.41917 | acc=0.8817 | tpr=0.9617 | fpr=0.1198 | 7037.5 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.41407 | acc=0.8816 | tpr=0.9624 | fpr=0.1199 | 7172.8 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.41703 | acc=0.8820 | tpr=0.9593 | fpr=0.1194 | 7392.2 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.42122 | acc=0.8815 | tpr=0.9599 | fpr=0.1199 | 7296.2 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.42212 | acc=0.8812 | tpr=0.9562 | fpr=0.1202 | 7066.6 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.42477 | acc=0.8808 | tpr=0.9557 | fpr=0.1206 | 7354.4 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.42462 | acc=0.8809 | tpr=0.9577 | fpr=0.1205 | 7077.6 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.42358 | acc=0.8810 | tpr=0.9566 | fpr=0.1204 | 13560.5 samples/s | 53.0 steps/s
Avg test loss: 0.42345, Avg test acc: 0.88098, Avg tpr: 0.95602, Avg fpr: 0.12038, total FA: 16715

server round 46/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=71.8] | Loss=0.12529 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.953 | 3516.5 samples/s | 54.9 steps/s
[Step=36850 Epoch=71.9] | Loss=0.02070 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=2.953 | 3939.0 samples/s | 61.5 steps/s
[Step=36900 Epoch=72.0] | Loss=0.01325 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.344 | FP-Norm(final)=2.953 | 3811.7 samples/s | 59.6 steps/s
[Step=36950 Epoch=72.1] | Loss=0.01014 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=2.953 | 3794.2 samples/s | 59.3 steps/s
[Step=37000 Epoch=72.2] | Loss=0.00880 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=2.954 | 3833.2 samples/s | 59.9 steps/s
[Step=37050 Epoch=72.3] | Loss=0.00800 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=2.955 | 3791.4 samples/s | 59.2 steps/s
[Step=37100 Epoch=72.4] | Loss=0.00748 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=2.955 | 3816.8 samples/s | 59.6 steps/s
[Step=37150 Epoch=72.5] | Loss=0.00709 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=2.956 | 3913.0 samples/s | 61.1 steps/s
[Step=37200 Epoch=72.6] | Loss=0.00679 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.334 | FP-Norm(final)=2.956 | 3893.1 samples/s | 60.8 steps/s
[Step=37250 Epoch=72.7] | Loss=0.00661 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=2.956 | 3889.9 samples/s | 60.8 steps/s
[Step=37300 Epoch=72.7] | Loss=0.00647 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=2.957 | 4606.7 samples/s | 72.0 steps/s
[Step=37350 Epoch=72.8] | Loss=0.00643 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=2.957 | 1639.4 samples/s | 25.6 steps/s
[Step=37400 Epoch=72.9] | Loss=0.00617 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=2.957 | 3869.6 samples/s | 60.5 steps/s
[Step=37450 Epoch=73.0] | Loss=0.00598 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=2.958 | 3875.6 samples/s | 60.6 steps/s
[Step=37500 Epoch=73.1] | Loss=0.00579 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=2.958 | 3861.4 samples/s | 60.3 steps/s
[Step=37550 Epoch=73.2] | Loss=0.00575 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.335 | FP-Norm(final)=2.959 | 3961.2 samples/s | 61.9 steps/s
[Step=37600 Epoch=73.3] | Loss=0.00567 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=2.959 | 4016.1 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step37600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=71.9] | Loss=0.21879 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.953 | 3629.5 samples/s | 56.7 steps/s
[Step=36850 Epoch=72.0] | Loss=0.01870 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=2.953 | 3838.1 samples/s | 60.0 steps/s
[Step=36900 Epoch=72.1] | Loss=0.01223 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=2.953 | 3883.2 samples/s | 60.7 steps/s
[Step=36950 Epoch=72.2] | Loss=0.00973 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.954 | 3885.8 samples/s | 60.7 steps/s
[Step=37000 Epoch=72.3] | Loss=0.00874 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=2.954 | 3882.4 samples/s | 60.7 steps/s
[Step=37050 Epoch=72.4] | Loss=0.00792 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.341 | FP-Norm(final)=2.954 | 3897.6 samples/s | 60.9 steps/s
[Step=37100 Epoch=72.5] | Loss=0.00728 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=2.955 | 3917.2 samples/s | 61.2 steps/s
[Step=37150 Epoch=72.6] | Loss=0.00691 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=2.955 | 3836.4 samples/s | 59.9 steps/s
[Step=37200 Epoch=72.7] | Loss=0.00671 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=2.956 | 3875.7 samples/s | 60.6 steps/s
[Step=37250 Epoch=72.8] | Loss=0.00664 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.335 | FP-Norm(final)=2.956 | 3895.8 samples/s | 60.9 steps/s
[Step=37300 Epoch=72.9] | Loss=0.00634 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=2.957 | 4660.2 samples/s | 72.8 steps/s
[Step=37350 Epoch=73.0] | Loss=0.00610 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=2.957 | 1680.9 samples/s | 26.3 steps/s
[Step=37400 Epoch=73.1] | Loss=0.00595 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.330 | FP-Norm(final)=2.958 | 3849.5 samples/s | 60.1 steps/s
[Step=37450 Epoch=73.2] | Loss=0.00576 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.329 | FP-Norm(final)=2.958 | 3882.3 samples/s | 60.7 steps/s
[Step=37500 Epoch=73.3] | Loss=0.00564 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.328 | FP-Norm(final)=2.958 | 3880.8 samples/s | 60.6 steps/s
[Step=37550 Epoch=73.4] | Loss=0.00566 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.327 | FP-Norm(final)=2.959 | 3879.6 samples/s | 60.6 steps/s
[Step=37600 Epoch=73.5] | Loss=0.00561 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=2.959 | 3875.4 samples/s | 60.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step37600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=141.0] | Loss=0.06071 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.953 | 3621.3 samples/s | 56.6 steps/s
[Step=36850 Epoch=141.2] | Loss=0.00601 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=2.954 | 3620.0 samples/s | 56.6 steps/s
[Step=36900 Epoch=141.4] | Loss=0.00303 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.954 | 3796.8 samples/s | 59.3 steps/s
[Step=36950 Epoch=141.6] | Loss=0.00203 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.954 | 3766.1 samples/s | 58.8 steps/s
[Step=37000 Epoch=141.8] | Loss=0.00153 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.954 | 3686.5 samples/s | 57.6 steps/s
[Step=37050 Epoch=142.0] | Loss=0.00123 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.954 | 4488.9 samples/s | 70.1 steps/s
[Step=37100 Epoch=142.2] | Loss=0.00103 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=2.954 | 1666.7 samples/s | 26.0 steps/s
[Step=37150 Epoch=142.3] | Loss=0.00088 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=2.954 | 3707.7 samples/s | 57.9 steps/s
[Step=37200 Epoch=142.5] | Loss=0.00078 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.954 | 3653.5 samples/s | 57.1 steps/s
[Step=37250 Epoch=142.7] | Loss=0.00069 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.954 | 3716.0 samples/s | 58.1 steps/s
[Step=37300 Epoch=142.9] | Loss=0.00063 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=2.954 | 4066.6 samples/s | 63.5 steps/s
[Step=37350 Epoch=143.1] | Loss=0.00057 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=2.954 | 1724.9 samples/s | 27.0 steps/s
[Step=37400 Epoch=143.3] | Loss=0.00052 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=2.954 | 3660.8 samples/s | 57.2 steps/s
[Step=37450 Epoch=143.5] | Loss=0.00049 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=2.954 | 3698.1 samples/s | 57.8 steps/s
[Step=37500 Epoch=143.7] | Loss=0.00045 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=2.954 | 3721.4 samples/s | 58.1 steps/s
[Step=37550 Epoch=143.9] | Loss=0.00042 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=2.954 | 3669.3 samples/s | 57.3 steps/s
[Step=37600 Epoch=144.1] | Loss=0.00040 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=2.954 | 1783.5 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step37600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=141.7] | Loss=0.14833 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.953 | 3635.5 samples/s | 56.8 steps/s
[Step=36850 Epoch=141.9] | Loss=0.00529 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=2.954 | 3593.3 samples/s | 56.1 steps/s
[Step=36900 Epoch=142.0] | Loss=0.00267 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.954 | 3814.5 samples/s | 59.6 steps/s
[Step=36950 Epoch=142.2] | Loss=0.00179 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=2.954 | 3800.4 samples/s | 59.4 steps/s
[Step=37000 Epoch=142.4] | Loss=0.00135 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.955 | 3813.3 samples/s | 59.6 steps/s
[Step=37050 Epoch=142.6] | Loss=0.00109 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=2.955 | 4661.0 samples/s | 72.8 steps/s
[Step=37100 Epoch=142.8] | Loss=0.00091 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=2.955 | 1673.2 samples/s | 26.1 steps/s
[Step=37150 Epoch=143.0] | Loss=0.00078 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.955 | 3752.3 samples/s | 58.6 steps/s
[Step=37200 Epoch=143.2] | Loss=0.00069 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=2.955 | 3759.7 samples/s | 58.7 steps/s
[Step=37250 Epoch=143.4] | Loss=0.00061 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=2.955 | 3743.9 samples/s | 58.5 steps/s
[Step=37300 Epoch=143.6] | Loss=0.00055 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=2.955 | 4043.4 samples/s | 63.2 steps/s
[Step=37350 Epoch=143.8] | Loss=0.00051 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=2.955 | 1729.2 samples/s | 27.0 steps/s
[Step=37400 Epoch=144.0] | Loss=0.00047 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=2.955 | 3688.4 samples/s | 57.6 steps/s
[Step=37450 Epoch=144.2] | Loss=0.00043 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=2.955 | 3687.2 samples/s | 57.6 steps/s
[Step=37500 Epoch=144.4] | Loss=0.00040 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=2.955 | 3687.9 samples/s | 57.6 steps/s
[Step=37550 Epoch=144.5] | Loss=0.00038 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=2.955 | 3757.4 samples/s | 58.7 steps/s
[Step=37600 Epoch=144.7] | Loss=0.00035 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=2.955 | 1773.7 samples/s | 27.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21070 | acc=0.8987 | tpr=0.8576 | fpr=0.0121 | 3853.7 samples/s | 15.1 steps/s
Avg test loss: 0.22012, Avg test acc: 0.89611, Avg tpr: 0.85563, Avg fpr: 0.01487, total FA: 116

Testing server on iccad2012
[Step=  50] | Loss=0.39907 | acc=0.8845 | tpr=0.9381 | fpr=0.1164 | 3860.8 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.40263 | acc=0.8863 | tpr=0.9552 | fpr=0.1150 | 7215.8 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.41095 | acc=0.8835 | tpr=0.9582 | fpr=0.1178 | 7682.7 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.41653 | acc=0.8837 | tpr=0.9607 | fpr=0.1177 | 6948.1 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.41144 | acc=0.8836 | tpr=0.9616 | fpr=0.1178 | 7399.8 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.41470 | acc=0.8839 | tpr=0.9578 | fpr=0.1174 | 7299.0 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.41892 | acc=0.8832 | tpr=0.9587 | fpr=0.1182 | 6885.9 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.41973 | acc=0.8828 | tpr=0.9557 | fpr=0.1186 | 7245.5 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.42249 | acc=0.8825 | tpr=0.9552 | fpr=0.1188 | 7144.8 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.42229 | acc=0.8826 | tpr=0.9573 | fpr=0.1187 | 7354.4 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.42115 | acc=0.8827 | tpr=0.9562 | fpr=0.1186 | 13116.0 samples/s | 51.2 steps/s
Avg test loss: 0.42100, Avg test acc: 0.88275, Avg tpr: 0.95563, Avg fpr: 0.11858, total FA: 16464

server round 47/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=73.3] | Loss=0.05812 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.960 | 3508.3 samples/s | 54.8 steps/s
[Step=37650 Epoch=73.4] | Loss=0.01829 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=2.960 | 3922.0 samples/s | 61.3 steps/s
[Step=37700 Epoch=73.5] | Loss=0.01235 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=2.960 | 3910.2 samples/s | 61.1 steps/s
[Step=37750 Epoch=73.6] | Loss=0.00993 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.349 | FP-Norm(final)=2.961 | 3862.8 samples/s | 60.4 steps/s
[Step=37800 Epoch=73.7] | Loss=0.00869 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.961 | 3892.7 samples/s | 60.8 steps/s
[Step=37850 Epoch=73.8] | Loss=0.00798 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=2.962 | 3879.3 samples/s | 60.6 steps/s
[Step=37900 Epoch=73.9] | Loss=0.00745 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=2.962 | 3901.4 samples/s | 61.0 steps/s
[Step=37950 Epoch=74.0] | Loss=0.00703 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=2.962 | 3888.4 samples/s | 60.8 steps/s
[Step=38000 Epoch=74.1] | Loss=0.00665 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.337 | FP-Norm(final)=2.963 | 3904.1 samples/s | 61.0 steps/s
[Step=38050 Epoch=74.2] | Loss=0.00645 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=2.963 | 3915.9 samples/s | 61.2 steps/s
[Step=38100 Epoch=74.3] | Loss=0.00635 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.335 | FP-Norm(final)=2.964 | 4605.1 samples/s | 72.0 steps/s
[Step=38150 Epoch=74.4] | Loss=0.00611 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=2.964 | 1662.3 samples/s | 26.0 steps/s
[Step=38200 Epoch=74.5] | Loss=0.00595 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=2.965 | 3907.6 samples/s | 61.1 steps/s
[Step=38250 Epoch=74.6] | Loss=0.00587 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=2.965 | 3874.4 samples/s | 60.5 steps/s
[Step=38300 Epoch=74.7] | Loss=0.00576 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.338 | FP-Norm(final)=2.966 | 3913.6 samples/s | 61.1 steps/s
[Step=38350 Epoch=74.8] | Loss=0.00573 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=2.966 | 3882.8 samples/s | 60.7 steps/s
[Step=38400 Epoch=74.9] | Loss=0.00556 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=2.966 | 3884.8 samples/s | 60.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step38400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=73.5] | Loss=0.12355 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.960 | 3825.9 samples/s | 59.8 steps/s
[Step=37650 Epoch=73.6] | Loss=0.01774 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=2.961 | 3693.3 samples/s | 57.7 steps/s
[Step=37700 Epoch=73.7] | Loss=0.01078 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=2.961 | 3937.0 samples/s | 61.5 steps/s
[Step=37750 Epoch=73.8] | Loss=0.00876 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=2.962 | 3887.1 samples/s | 60.7 steps/s
[Step=37800 Epoch=73.9] | Loss=0.00782 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=2.962 | 3996.9 samples/s | 62.5 steps/s
[Step=37850 Epoch=74.0] | Loss=0.00728 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=2.963 | 4019.7 samples/s | 62.8 steps/s
[Step=37900 Epoch=74.1] | Loss=0.00684 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=2.963 | 3993.5 samples/s | 62.4 steps/s
[Step=37950 Epoch=74.2] | Loss=0.00633 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.336 | FP-Norm(final)=2.964 | 4000.5 samples/s | 62.5 steps/s
[Step=38000 Epoch=74.3] | Loss=0.00610 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=2.965 | 3924.9 samples/s | 61.3 steps/s
[Step=38050 Epoch=74.4] | Loss=0.00590 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=2.965 | 3896.1 samples/s | 60.9 steps/s
[Step=38100 Epoch=74.5] | Loss=0.00597 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.334 | FP-Norm(final)=2.966 | 4676.8 samples/s | 73.1 steps/s
[Step=38150 Epoch=74.6] | Loss=0.00574 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=2.966 | 1712.2 samples/s | 26.8 steps/s
[Step=38200 Epoch=74.7] | Loss=0.00555 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.334 | FP-Norm(final)=2.967 | 3851.3 samples/s | 60.2 steps/s
[Step=38250 Epoch=74.8] | Loss=0.00536 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=2.967 | 3877.9 samples/s | 60.6 steps/s
[Step=38300 Epoch=74.9] | Loss=0.00521 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=2.968 | 3899.2 samples/s | 60.9 steps/s
[Step=38350 Epoch=75.0] | Loss=0.00510 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=2.968 | 3881.1 samples/s | 60.6 steps/s
[Step=38400 Epoch=75.1] | Loss=0.00508 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=2.968 | 3899.5 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step38400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=144.1] | Loss=0.08993 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.960 | 3661.9 samples/s | 57.2 steps/s
[Step=37650 Epoch=144.3] | Loss=0.00445 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=2.962 | 3546.3 samples/s | 55.4 steps/s
[Step=37700 Epoch=144.5] | Loss=0.00226 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.962 | 3697.3 samples/s | 57.8 steps/s
[Step=37750 Epoch=144.6] | Loss=0.00154 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.963 | 3691.7 samples/s | 57.7 steps/s
[Step=37800 Epoch=144.8] | Loss=0.00117 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.963 | 3690.3 samples/s | 57.7 steps/s
[Step=37850 Epoch=145.0] | Loss=0.00094 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=2.963 | 4570.8 samples/s | 71.4 steps/s
[Step=37900 Epoch=145.2] | Loss=0.00079 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=2.963 | 1660.0 samples/s | 25.9 steps/s
[Step=37950 Epoch=145.4] | Loss=0.00068 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=2.963 | 3756.0 samples/s | 58.7 steps/s
[Step=38000 Epoch=145.6] | Loss=0.00060 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=2.963 | 3725.9 samples/s | 58.2 steps/s
[Step=38050 Epoch=145.8] | Loss=0.00053 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=2.963 | 3678.1 samples/s | 57.5 steps/s
[Step=38100 Epoch=146.0] | Loss=0.00048 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=2.963 | 4019.6 samples/s | 62.8 steps/s
[Step=38150 Epoch=146.2] | Loss=0.00044 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=2.963 | 1757.6 samples/s | 27.5 steps/s
[Step=38200 Epoch=146.4] | Loss=0.00041 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=2.963 | 3773.9 samples/s | 59.0 steps/s
[Step=38250 Epoch=146.6] | Loss=0.00038 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=2.963 | 3764.0 samples/s | 58.8 steps/s
[Step=38300 Epoch=146.8] | Loss=0.00035 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=2.963 | 3695.6 samples/s | 57.7 steps/s
[Step=38350 Epoch=146.9] | Loss=0.00033 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=2.963 | 3697.9 samples/s | 57.8 steps/s
[Step=38400 Epoch=147.1] | Loss=0.00031 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.331 | FP-Norm(final)=2.963 | 1784.0 samples/s | 27.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step38400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=144.7] | Loss=0.04181 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.960 | 3584.9 samples/s | 56.0 steps/s
[Step=37650 Epoch=144.9] | Loss=0.00494 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=2.961 | 3745.9 samples/s | 58.5 steps/s
[Step=37700 Epoch=145.1] | Loss=0.00249 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=2.962 | 3700.8 samples/s | 57.8 steps/s
[Step=37750 Epoch=145.3] | Loss=0.00166 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=2.962 | 3677.4 samples/s | 57.5 steps/s
[Step=37800 Epoch=145.5] | Loss=0.00125 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.962 | 3709.7 samples/s | 58.0 steps/s
[Step=37850 Epoch=145.7] | Loss=0.00101 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=2.962 | 4494.0 samples/s | 70.2 steps/s
[Step=37900 Epoch=145.9] | Loss=0.00085 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=2.962 | 1663.2 samples/s | 26.0 steps/s
[Step=37950 Epoch=146.1] | Loss=0.00073 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.962 | 3829.3 samples/s | 59.8 steps/s
[Step=38000 Epoch=146.3] | Loss=0.00064 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=2.962 | 3744.2 samples/s | 58.5 steps/s
[Step=38050 Epoch=146.5] | Loss=0.00057 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=2.962 | 3697.3 samples/s | 57.8 steps/s
[Step=38100 Epoch=146.7] | Loss=0.00052 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=2.962 | 4109.7 samples/s | 64.2 steps/s
[Step=38150 Epoch=146.9] | Loss=0.00047 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=2.962 | 1708.0 samples/s | 26.7 steps/s
[Step=38200 Epoch=147.0] | Loss=0.00043 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=2.962 | 3715.7 samples/s | 58.1 steps/s
[Step=38250 Epoch=147.2] | Loss=0.00040 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=2.962 | 3728.7 samples/s | 58.3 steps/s
[Step=38300 Epoch=147.4] | Loss=0.00037 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=2.962 | 3692.5 samples/s | 57.7 steps/s
[Step=38350 Epoch=147.6] | Loss=0.00035 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.330 | FP-Norm(final)=2.962 | 3746.8 samples/s | 58.5 steps/s
[Step=38400 Epoch=147.8] | Loss=0.00033 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=2.962 | 1775.5 samples/s | 27.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20970 | acc=0.8995 | tpr=0.8590 | fpr=0.0126 | 3816.2 samples/s | 14.9 steps/s
Avg test loss: 0.21969, Avg test acc: 0.89763, Avg tpr: 0.85802, Avg fpr: 0.01525, total FA: 119

Testing server on iccad2012
[Step=  50] | Loss=0.39819 | acc=0.8855 | tpr=0.9381 | fpr=0.1155 | 3862.1 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.40166 | acc=0.8875 | tpr=0.9531 | fpr=0.1137 | 7194.5 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.40982 | acc=0.8851 | tpr=0.9568 | fpr=0.1163 | 7261.7 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.41547 | acc=0.8851 | tpr=0.9596 | fpr=0.1162 | 7034.6 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.41016 | acc=0.8851 | tpr=0.9607 | fpr=0.1163 | 7238.0 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.41339 | acc=0.8855 | tpr=0.9571 | fpr=0.1158 | 7445.2 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.41772 | acc=0.8849 | tpr=0.9580 | fpr=0.1165 | 7214.4 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.41846 | acc=0.8846 | tpr=0.9551 | fpr=0.1166 | 7242.3 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.42119 | acc=0.8844 | tpr=0.9547 | fpr=0.1169 | 7300.7 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.42096 | acc=0.8844 | tpr=0.9568 | fpr=0.1169 | 7231.9 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.41988 | acc=0.8845 | tpr=0.9554 | fpr=0.1168 | 13092.6 samples/s | 51.1 steps/s
Avg test loss: 0.41972, Avg test acc: 0.88450, Avg tpr: 0.95483, Avg fpr: 0.11678, total FA: 16215

server round 48/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=74.9] | Loss=0.23297 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.968 | 3623.7 samples/s | 56.6 steps/s
[Step=38450 Epoch=75.0] | Loss=0.01876 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.329 | FP-Norm(final)=2.968 | 3586.3 samples/s | 56.0 steps/s
[Step=38500 Epoch=75.1] | Loss=0.01177 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=2.969 | 4020.8 samples/s | 62.8 steps/s
[Step=38550 Epoch=75.2] | Loss=0.00936 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=2.969 | 3938.4 samples/s | 61.5 steps/s
[Step=38600 Epoch=75.3] | Loss=0.00824 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=2.970 | 3894.6 samples/s | 60.9 steps/s
[Step=38650 Epoch=75.4] | Loss=0.00750 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=2.970 | 3930.5 samples/s | 61.4 steps/s
[Step=38700 Epoch=75.5] | Loss=0.00739 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=2.971 | 3900.3 samples/s | 60.9 steps/s
[Step=38750 Epoch=75.6] | Loss=0.00689 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.339 | FP-Norm(final)=2.971 | 3900.5 samples/s | 60.9 steps/s
[Step=38800 Epoch=75.7] | Loss=0.00658 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=2.972 | 3887.3 samples/s | 60.7 steps/s
[Step=38850 Epoch=75.8] | Loss=0.00645 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=2.972 | 3900.2 samples/s | 60.9 steps/s
[Step=38900 Epoch=75.9] | Loss=0.00635 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=2.972 | 4562.0 samples/s | 71.3 steps/s
[Step=38950 Epoch=76.0] | Loss=0.00617 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=2.973 | 1667.1 samples/s | 26.0 steps/s
[Step=39000 Epoch=76.1] | Loss=0.00586 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=2.973 | 3867.9 samples/s | 60.4 steps/s
[Step=39050 Epoch=76.2] | Loss=0.00568 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=2.974 | 3895.9 samples/s | 60.9 steps/s
[Step=39100 Epoch=76.3] | Loss=0.00564 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=2.974 | 3873.0 samples/s | 60.5 steps/s
[Step=39150 Epoch=76.4] | Loss=0.00559 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=2.974 | 3919.9 samples/s | 61.2 steps/s
[Step=39200 Epoch=76.5] | Loss=0.00554 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=2.975 | 3870.5 samples/s | 60.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step39200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=75.1] | Loss=0.08088 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.968 | 3707.7 samples/s | 57.9 steps/s
[Step=38450 Epoch=75.2] | Loss=0.01178 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.277 | FP-Norm(final)=2.970 | 3701.6 samples/s | 57.8 steps/s
[Step=38500 Epoch=75.3] | Loss=0.00953 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.303 | FP-Norm(final)=2.970 | 3851.4 samples/s | 60.2 steps/s
[Step=38550 Epoch=75.4] | Loss=0.00757 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.306 | FP-Norm(final)=2.971 | 3874.2 samples/s | 60.5 steps/s
[Step=38600 Epoch=75.5] | Loss=0.00659 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.307 | FP-Norm(final)=2.972 | 3947.7 samples/s | 61.7 steps/s
[Step=38650 Epoch=75.6] | Loss=0.00634 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.308 | FP-Norm(final)=2.972 | 3987.6 samples/s | 62.3 steps/s
[Step=38700 Epoch=75.7] | Loss=0.00600 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.311 | FP-Norm(final)=2.973 | 3972.8 samples/s | 62.1 steps/s
[Step=38750 Epoch=75.8] | Loss=0.00574 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.311 | FP-Norm(final)=2.973 | 3871.2 samples/s | 60.5 steps/s
[Step=38800 Epoch=75.9] | Loss=0.00566 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.310 | FP-Norm(final)=2.974 | 3925.6 samples/s | 61.3 steps/s
[Step=38850 Epoch=76.0] | Loss=0.00566 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.310 | FP-Norm(final)=2.974 | 3895.4 samples/s | 60.9 steps/s
[Step=38900 Epoch=76.0] | Loss=0.00565 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.310 | FP-Norm(final)=2.975 | 4640.1 samples/s | 72.5 steps/s
[Step=38950 Epoch=76.1] | Loss=0.00562 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.312 | FP-Norm(final)=2.975 | 1688.8 samples/s | 26.4 steps/s
[Step=39000 Epoch=76.2] | Loss=0.00546 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.311 | FP-Norm(final)=2.975 | 3875.5 samples/s | 60.6 steps/s
[Step=39050 Epoch=76.3] | Loss=0.00537 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.311 | FP-Norm(final)=2.976 | 3916.8 samples/s | 61.2 steps/s
[Step=39100 Epoch=76.4] | Loss=0.00518 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.311 | FP-Norm(final)=2.976 | 3958.2 samples/s | 61.8 steps/s
[Step=39150 Epoch=76.5] | Loss=0.00518 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.310 | FP-Norm(final)=2.977 | 4023.8 samples/s | 62.9 steps/s
[Step=39200 Epoch=76.6] | Loss=0.00512 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.311 | FP-Norm(final)=2.977 | 3961.6 samples/s | 61.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step39200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=147.1] | Loss=0.13954 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.968 | 3589.8 samples/s | 56.1 steps/s
[Step=38450 Epoch=147.3] | Loss=0.00650 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.969 | 3635.3 samples/s | 56.8 steps/s
[Step=38500 Epoch=147.5] | Loss=0.00328 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.970 | 3739.7 samples/s | 58.4 steps/s
[Step=38550 Epoch=147.7] | Loss=0.00220 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.970 | 3744.9 samples/s | 58.5 steps/s
[Step=38600 Epoch=147.9] | Loss=0.00166 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.970 | 3699.3 samples/s | 57.8 steps/s
[Step=38650 Epoch=148.1] | Loss=0.00133 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=2.970 | 4522.3 samples/s | 70.7 steps/s
[Step=38700 Epoch=148.3] | Loss=0.00111 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.970 | 1648.9 samples/s | 25.8 steps/s
[Step=38750 Epoch=148.5] | Loss=0.00096 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.970 | 3678.7 samples/s | 57.5 steps/s
[Step=38800 Epoch=148.7] | Loss=0.00084 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.970 | 3752.8 samples/s | 58.6 steps/s
[Step=38850 Epoch=148.9] | Loss=0.00075 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.970 | 3671.0 samples/s | 57.4 steps/s
[Step=38900 Epoch=149.1] | Loss=0.00068 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.970 | 4021.3 samples/s | 62.8 steps/s
[Step=38950 Epoch=149.2] | Loss=0.00062 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=2.970 | 1714.0 samples/s | 26.8 steps/s
[Step=39000 Epoch=149.4] | Loss=0.00057 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=2.970 | 3696.5 samples/s | 57.8 steps/s
[Step=39050 Epoch=149.6] | Loss=0.00053 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.970 | 3664.6 samples/s | 57.3 steps/s
[Step=39100 Epoch=149.8] | Loss=0.00049 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=2.970 | 3709.1 samples/s | 58.0 steps/s
[Step=39150 Epoch=150.0] | Loss=0.00046 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=2.970 | 3664.7 samples/s | 57.3 steps/s
[Step=39200 Epoch=150.2] | Loss=0.00043 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=2.970 | 1794.1 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step39200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=147.8] | Loss=0.14368 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.968 | 3543.1 samples/s | 55.4 steps/s
[Step=38450 Epoch=148.0] | Loss=0.00462 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.329 | FP-Norm(final)=2.969 | 3697.0 samples/s | 57.8 steps/s
[Step=38500 Epoch=148.2] | Loss=0.00236 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=2.970 | 3706.8 samples/s | 57.9 steps/s
[Step=38550 Epoch=148.4] | Loss=0.00158 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=2.970 | 3691.1 samples/s | 57.7 steps/s
[Step=38600 Epoch=148.6] | Loss=0.00119 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=2.970 | 3684.1 samples/s | 57.6 steps/s
[Step=38650 Epoch=148.8] | Loss=0.00096 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=2.970 | 4581.5 samples/s | 71.6 steps/s
[Step=38700 Epoch=149.0] | Loss=0.00081 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=2.970 | 1639.1 samples/s | 25.6 steps/s
[Step=38750 Epoch=149.2] | Loss=0.00069 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=2.970 | 3690.7 samples/s | 57.7 steps/s
[Step=38800 Epoch=149.4] | Loss=0.00061 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=2.970 | 3734.4 samples/s | 58.4 steps/s
[Step=38850 Epoch=149.5] | Loss=0.00055 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=2.970 | 3713.1 samples/s | 58.0 steps/s
[Step=38900 Epoch=149.7] | Loss=0.00049 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=2.970 | 4242.0 samples/s | 66.3 steps/s
[Step=38950 Epoch=149.9] | Loss=0.00045 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.329 | FP-Norm(final)=2.971 | 1730.2 samples/s | 27.0 steps/s
[Step=39000 Epoch=150.1] | Loss=0.00042 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.326 | FP-Norm(final)=2.971 | 3765.4 samples/s | 58.8 steps/s
[Step=39050 Epoch=150.3] | Loss=0.00038 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.323 | FP-Norm(final)=2.971 | 3790.6 samples/s | 59.2 steps/s
[Step=39100 Epoch=150.5] | Loss=0.00036 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.320 | FP-Norm(final)=2.971 | 3664.9 samples/s | 57.3 steps/s
[Step=39150 Epoch=150.7] | Loss=0.00034 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.318 | FP-Norm(final)=2.971 | 3744.4 samples/s | 58.5 steps/s
[Step=39200 Epoch=150.9] | Loss=0.00032 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.315 | FP-Norm(final)=2.971 | 1768.9 samples/s | 27.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20816 | acc=0.9020 | tpr=0.8625 | fpr=0.0121 | 3831.1 samples/s | 15.0 steps/s
Avg test loss: 0.21719, Avg test acc: 0.90063, Avg tpr: 0.86227, Avg fpr: 0.01500, total FA: 117

Testing server on iccad2012
[Step=  50] | Loss=0.41137 | acc=0.8825 | tpr=0.9381 | fpr=0.1185 | 3845.1 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.41454 | acc=0.8844 | tpr=0.9552 | fpr=0.1169 | 7189.9 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.42248 | acc=0.8820 | tpr=0.9597 | fpr=0.1195 | 7407.9 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.42813 | acc=0.8818 | tpr=0.9617 | fpr=0.1197 | 7263.0 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.42279 | acc=0.8816 | tpr=0.9633 | fpr=0.1199 | 7237.1 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.42608 | acc=0.8820 | tpr=0.9593 | fpr=0.1194 | 7626.3 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.43052 | acc=0.8813 | tpr=0.9606 | fpr=0.1201 | 7151.0 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.43129 | acc=0.8811 | tpr=0.9568 | fpr=0.1202 | 7388.2 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.43406 | acc=0.8809 | tpr=0.9567 | fpr=0.1204 | 7199.9 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.43389 | acc=0.8809 | tpr=0.9586 | fpr=0.1205 | 7302.3 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.43273 | acc=0.8810 | tpr=0.9574 | fpr=0.1204 | 12204.3 samples/s | 47.7 steps/s
Avg test loss: 0.43255, Avg test acc: 0.88100, Avg tpr: 0.95681, Avg fpr: 0.12038, total FA: 16714

server round 49/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=76.5] | Loss=0.09654 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.977 | 3866.5 samples/s | 60.4 steps/s
[Step=39250 Epoch=76.6] | Loss=0.02122 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.325 | FP-Norm(final)=2.976 | 3620.6 samples/s | 56.6 steps/s
[Step=39300 Epoch=76.7] | Loss=0.01262 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=2.976 | 3857.3 samples/s | 60.3 steps/s
[Step=39350 Epoch=76.7] | Loss=0.01032 | Reg=0.00011 | acc=0.9688 | FP-Norm=0.330 | FP-Norm(final)=2.977 | 3904.2 samples/s | 61.0 steps/s
[Step=39400 Epoch=76.8] | Loss=0.00922 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.329 | FP-Norm(final)=2.977 | 3863.8 samples/s | 60.4 steps/s
[Step=39450 Epoch=76.9] | Loss=0.00862 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.329 | FP-Norm(final)=2.977 | 3912.3 samples/s | 61.1 steps/s
[Step=39500 Epoch=77.0] | Loss=0.00786 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=2.978 | 3891.0 samples/s | 60.8 steps/s
[Step=39550 Epoch=77.1] | Loss=0.00754 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.328 | FP-Norm(final)=2.978 | 3896.5 samples/s | 60.9 steps/s
[Step=39600 Epoch=77.2] | Loss=0.00710 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.328 | FP-Norm(final)=2.978 | 3916.4 samples/s | 61.2 steps/s
[Step=39650 Epoch=77.3] | Loss=0.00673 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.326 | FP-Norm(final)=2.979 | 3887.9 samples/s | 60.7 steps/s
[Step=39700 Epoch=77.4] | Loss=0.00659 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.326 | FP-Norm(final)=2.979 | 4640.4 samples/s | 72.5 steps/s
[Step=39750 Epoch=77.5] | Loss=0.00630 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.325 | FP-Norm(final)=2.980 | 1626.2 samples/s | 25.4 steps/s
[Step=39800 Epoch=77.6] | Loss=0.00614 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.325 | FP-Norm(final)=2.980 | 3958.3 samples/s | 61.8 steps/s
[Step=39850 Epoch=77.7] | Loss=0.00603 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.325 | FP-Norm(final)=2.981 | 3989.1 samples/s | 62.3 steps/s
[Step=39900 Epoch=77.8] | Loss=0.00585 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.324 | FP-Norm(final)=2.981 | 3890.1 samples/s | 60.8 steps/s
[Step=39950 Epoch=77.9] | Loss=0.00571 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.323 | FP-Norm(final)=2.981 | 3885.2 samples/s | 60.7 steps/s
[Step=40000 Epoch=78.0] | Loss=0.00559 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.323 | FP-Norm(final)=2.982 | 3900.2 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=76.6] | Loss=0.04251 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.977 | 3600.2 samples/s | 56.3 steps/s
[Step=39250 Epoch=76.7] | Loss=0.01572 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.307 | FP-Norm(final)=2.977 | 3784.2 samples/s | 59.1 steps/s
[Step=39300 Epoch=76.8] | Loss=0.01041 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.326 | FP-Norm(final)=2.978 | 3874.5 samples/s | 60.5 steps/s
[Step=39350 Epoch=76.9] | Loss=0.00831 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.327 | FP-Norm(final)=2.978 | 3896.2 samples/s | 60.9 steps/s
[Step=39400 Epoch=77.0] | Loss=0.00712 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.323 | FP-Norm(final)=2.979 | 3855.7 samples/s | 60.2 steps/s
[Step=39450 Epoch=77.1] | Loss=0.00656 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.321 | FP-Norm(final)=2.979 | 3917.6 samples/s | 61.2 steps/s
[Step=39500 Epoch=77.2] | Loss=0.00639 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.322 | FP-Norm(final)=2.980 | 3871.8 samples/s | 60.5 steps/s
[Step=39550 Epoch=77.3] | Loss=0.00619 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.320 | FP-Norm(final)=2.981 | 3913.4 samples/s | 61.1 steps/s
[Step=39600 Epoch=77.4] | Loss=0.00603 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.319 | FP-Norm(final)=2.981 | 3879.7 samples/s | 60.6 steps/s
[Step=39650 Epoch=77.5] | Loss=0.00581 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.318 | FP-Norm(final)=2.982 | 3909.0 samples/s | 61.1 steps/s
[Step=39700 Epoch=77.6] | Loss=0.00570 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.318 | FP-Norm(final)=2.982 | 4642.1 samples/s | 72.5 steps/s
[Step=39750 Epoch=77.7] | Loss=0.00566 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.318 | FP-Norm(final)=2.982 | 1693.3 samples/s | 26.5 steps/s
[Step=39800 Epoch=77.8] | Loss=0.00570 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.317 | FP-Norm(final)=2.983 | 3871.9 samples/s | 60.5 steps/s
[Step=39850 Epoch=77.9] | Loss=0.00555 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.317 | FP-Norm(final)=2.983 | 3987.5 samples/s | 62.3 steps/s
[Step=39900 Epoch=78.0] | Loss=0.00543 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.316 | FP-Norm(final)=2.984 | 3873.3 samples/s | 60.5 steps/s
[Step=39950 Epoch=78.1] | Loss=0.00529 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.316 | FP-Norm(final)=2.984 | 3917.5 samples/s | 61.2 steps/s
[Step=40000 Epoch=78.2] | Loss=0.00524 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.316 | FP-Norm(final)=2.985 | 3878.7 samples/s | 60.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_asml1_1/client_state-step40000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=150.2] | Loss=0.03413 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.977 | 3683.0 samples/s | 57.5 steps/s
[Step=39250 Epoch=150.4] | Loss=0.00306 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=2.979 | 3542.2 samples/s | 55.3 steps/s
[Step=39300 Epoch=150.6] | Loss=0.00156 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=2.980 | 3705.8 samples/s | 57.9 steps/s
[Step=39350 Epoch=150.8] | Loss=0.00106 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=2.980 | 3676.8 samples/s | 57.4 steps/s
[Step=39400 Epoch=151.0] | Loss=0.00080 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=2.981 | 3671.2 samples/s | 57.4 steps/s
[Step=39450 Epoch=151.2] | Loss=0.00065 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=2.981 | 4491.4 samples/s | 70.2 steps/s
[Step=39500 Epoch=151.4] | Loss=0.00055 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=2.981 | 1644.4 samples/s | 25.7 steps/s
[Step=39550 Epoch=151.5] | Loss=0.00047 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=2.981 | 3687.8 samples/s | 57.6 steps/s
[Step=39600 Epoch=151.7] | Loss=0.00042 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=2.981 | 3706.7 samples/s | 57.9 steps/s
[Step=39650 Epoch=151.9] | Loss=0.00037 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=2.981 | 3678.2 samples/s | 57.5 steps/s
[Step=39700 Epoch=152.1] | Loss=0.00034 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=2.981 | 4042.0 samples/s | 63.2 steps/s
[Step=39750 Epoch=152.3] | Loss=0.00031 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=2.981 | 1729.7 samples/s | 27.0 steps/s
[Step=39800 Epoch=152.5] | Loss=0.00029 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=2.981 | 3742.9 samples/s | 58.5 steps/s
[Step=39850 Epoch=152.7] | Loss=0.00027 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.329 | FP-Norm(final)=2.981 | 3782.9 samples/s | 59.1 steps/s
[Step=39900 Epoch=152.9] | Loss=0.00025 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.326 | FP-Norm(final)=2.981 | 3807.5 samples/s | 59.5 steps/s
[Step=39950 Epoch=153.1] | Loss=0.00023 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.323 | FP-Norm(final)=2.981 | 3788.4 samples/s | 59.2 steps/s
[Step=40000 Epoch=153.3] | Loss=0.00022 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.321 | FP-Norm(final)=2.981 | 1778.4 samples/s | 27.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step40000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=150.9] | Loss=0.01095 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.977 | 3447.9 samples/s | 53.9 steps/s
[Step=39250 Epoch=151.1] | Loss=0.00534 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=2.978 | 3711.0 samples/s | 58.0 steps/s
[Step=39300 Epoch=151.3] | Loss=0.00268 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.458 | FP-Norm(final)=2.979 | 3710.1 samples/s | 58.0 steps/s
[Step=39350 Epoch=151.5] | Loss=0.00179 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.458 | FP-Norm(final)=2.979 | 3714.3 samples/s | 58.0 steps/s
[Step=39400 Epoch=151.7] | Loss=0.00135 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.979 | 3656.5 samples/s | 57.1 steps/s
[Step=39450 Epoch=151.9] | Loss=0.00108 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.979 | 4565.5 samples/s | 71.3 steps/s
[Step=39500 Epoch=152.1] | Loss=0.00091 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=2.979 | 1647.0 samples/s | 25.7 steps/s
[Step=39550 Epoch=152.2] | Loss=0.00078 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.431 | FP-Norm(final)=2.979 | 3825.9 samples/s | 59.8 steps/s
[Step=39600 Epoch=152.4] | Loss=0.00068 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.979 | 3784.7 samples/s | 59.1 steps/s
[Step=39650 Epoch=152.6] | Loss=0.00061 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=2.979 | 3758.1 samples/s | 58.7 steps/s
[Step=39700 Epoch=152.8] | Loss=0.00055 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.979 | 4216.0 samples/s | 65.9 steps/s
[Step=39750 Epoch=153.0] | Loss=0.00050 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.979 | 1713.6 samples/s | 26.8 steps/s
[Step=39800 Epoch=153.2] | Loss=0.00046 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.979 | 3729.5 samples/s | 58.3 steps/s
[Step=39850 Epoch=153.4] | Loss=0.00043 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=2.979 | 3623.2 samples/s | 56.6 steps/s
[Step=39900 Epoch=153.6] | Loss=0.00040 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=2.979 | 3721.7 samples/s | 58.2 steps/s
[Step=39950 Epoch=153.8] | Loss=0.00037 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=2.979 | 3747.2 samples/s | 58.6 steps/s
[Step=40000 Epoch=154.0] | Loss=0.00035 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=2.979 | 1793.1 samples/s | 28.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22773 | acc=0.8924 | tpr=0.8484 | fpr=0.0119 | 3836.6 samples/s | 15.0 steps/s
Avg test loss: 0.23706, Avg test acc: 0.89138, Avg tpr: 0.84863, Avg fpr: 0.01461, total FA: 114

Testing server on iccad2012
[Step=  50] | Loss=0.38484 | acc=0.8920 | tpr=0.9381 | fpr=0.1089 | 3811.0 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.38864 | acc=0.8936 | tpr=0.9552 | fpr=0.1076 | 7090.3 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.39659 | acc=0.8916 | tpr=0.9568 | fpr=0.1096 | 6927.2 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.40197 | acc=0.8919 | tpr=0.9596 | fpr=0.1093 | 6941.3 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.39652 | acc=0.8918 | tpr=0.9607 | fpr=0.1094 | 7329.6 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.39984 | acc=0.8920 | tpr=0.9571 | fpr=0.1091 | 7319.6 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.40418 | acc=0.8915 | tpr=0.9580 | fpr=0.1097 | 7166.1 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.40498 | acc=0.8913 | tpr=0.9546 | fpr=0.1098 | 7154.9 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.40774 | acc=0.8912 | tpr=0.9547 | fpr=0.1100 | 6730.0 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.40754 | acc=0.8913 | tpr=0.9568 | fpr=0.1099 | 6982.3 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.40649 | acc=0.8913 | tpr=0.9558 | fpr=0.1099 | 13261.1 samples/s | 51.8 steps/s
Avg test loss: 0.40630, Avg test acc: 0.89132, Avg tpr: 0.95523, Avg fpr: 0.10985, total FA: 15252
