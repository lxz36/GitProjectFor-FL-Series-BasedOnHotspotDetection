#clients of iccad2012: 2
#clients of asml1: 2
select ratio: 0.5
Total num clients: 4
client model path: ['models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0', 'models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1', 'models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0', 'models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32814, 144, 32)
Using transform option: train
#pos = 17102, #neg = 15712
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32737, 144, 32)
Using transform option: train
#pos = 17179, #neg = 15558
loading data into the main memory...
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16703, 144, 32)
Using transform option: train
#pos = 8134, #neg = 8569
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16626, 144, 32)
Using transform option: train
#pos = 8099, #neg = 8527
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34927 | Reg=0.00000 | acc=0.5781 | FP-Norm=0.000 | FP-Norm(final)=1.915 | 2487.3 samples/s | 38.9 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.30551 | Reg=0.00215 | acc=0.6719 | FP-Norm=1.385 | FP-Norm(final)=1.907 | 3747.6 samples/s | 58.6 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.27063 | Reg=0.00384 | acc=0.8750 | FP-Norm=1.866 | FP-Norm(final)=1.920 | 3770.3 samples/s | 58.9 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.24106 | Reg=0.00532 | acc=0.9375 | FP-Norm=2.203 | FP-Norm(final)=1.930 | 3732.8 samples/s | 58.3 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.22014 | Reg=0.00648 | acc=0.8750 | FP-Norm=2.440 | FP-Norm(final)=1.941 | 3743.2 samples/s | 58.5 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.20426 | Reg=0.00746 | acc=0.9375 | FP-Norm=2.627 | FP-Norm(final)=1.950 | 3772.2 samples/s | 58.9 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.19213 | Reg=0.00837 | acc=0.8906 | FP-Norm=2.788 | FP-Norm(final)=1.957 | 3766.4 samples/s | 58.9 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.18160 | Reg=0.00923 | acc=0.9219 | FP-Norm=2.932 | FP-Norm(final)=1.964 | 3696.9 samples/s | 57.8 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.17183 | Reg=0.01003 | acc=0.9844 | FP-Norm=3.059 | FP-Norm(final)=1.971 | 3717.3 samples/s | 58.1 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.16412 | Reg=0.01075 | acc=0.8906 | FP-Norm=3.171 | FP-Norm(final)=1.978 | 3724.1 samples/s | 58.2 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.15758 | Reg=0.01142 | acc=0.9688 | FP-Norm=3.271 | FP-Norm(final)=1.984 | 4434.6 samples/s | 69.3 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.15068 | Reg=0.01205 | acc=0.9375 | FP-Norm=3.363 | FP-Norm(final)=1.990 | 1606.8 samples/s | 25.1 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.14368 | Reg=0.01262 | acc=0.9844 | FP-Norm=3.446 | FP-Norm(final)=1.997 | 3648.6 samples/s | 57.0 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.13867 | Reg=0.01318 | acc=0.9531 | FP-Norm=3.524 | FP-Norm(final)=2.003 | 3654.6 samples/s | 57.1 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.13479 | Reg=0.01371 | acc=0.9688 | FP-Norm=3.596 | FP-Norm(final)=2.009 | 3693.8 samples/s | 57.7 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.13125 | Reg=0.01420 | acc=0.9219 | FP-Norm=3.662 | FP-Norm(final)=2.014 | 3722.1 samples/s | 58.2 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.12765 | Reg=0.01465 | acc=0.9531 | FP-Norm=3.723 | FP-Norm(final)=2.020 | 3699.4 samples/s | 57.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.41052 | Reg=0.00000 | acc=0.5781 | FP-Norm=0.000 | FP-Norm(final)=1.914 | 3542.5 samples/s | 55.4 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.17271 | Reg=0.00300 | acc=0.8750 | FP-Norm=1.613 | FP-Norm(final)=1.943 | 3230.6 samples/s | 50.5 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.10851 | Reg=0.00471 | acc=1.0000 | FP-Norm=2.072 | FP-Norm(final)=1.963 | 3468.6 samples/s | 54.2 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.07987 | Reg=0.00554 | acc=0.9844 | FP-Norm=2.277 | FP-Norm(final)=1.978 | 3477.5 samples/s | 54.3 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.06339 | Reg=0.00606 | acc=1.0000 | FP-Norm=2.397 | FP-Norm(final)=1.989 | 3477.5 samples/s | 54.3 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.05331 | Reg=0.00643 | acc=1.0000 | FP-Norm=2.481 | FP-Norm(final)=1.999 | 4315.9 samples/s | 67.4 steps/s
[Step= 300 Epoch= 1.1] | Loss=0.04498 | Reg=0.00671 | acc=1.0000 | FP-Norm=2.541 | FP-Norm(final)=2.008 | 1534.1 samples/s | 24.0 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.03895 | Reg=0.00686 | acc=1.0000 | FP-Norm=2.576 | FP-Norm(final)=2.017 | 3519.3 samples/s | 55.0 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.03592 | Reg=0.00704 | acc=1.0000 | FP-Norm=2.614 | FP-Norm(final)=2.023 | 3494.6 samples/s | 54.6 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.03229 | Reg=0.00727 | acc=1.0000 | FP-Norm=2.658 | FP-Norm(final)=2.030 | 3466.3 samples/s | 54.2 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.02925 | Reg=0.00740 | acc=1.0000 | FP-Norm=2.686 | FP-Norm(final)=2.036 | 3740.8 samples/s | 58.5 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.02663 | Reg=0.00746 | acc=1.0000 | FP-Norm=2.699 | FP-Norm(final)=2.042 | 1610.2 samples/s | 25.2 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.02449 | Reg=0.00745 | acc=1.0000 | FP-Norm=2.702 | FP-Norm(final)=2.047 | 3468.6 samples/s | 54.2 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.02265 | Reg=0.00742 | acc=1.0000 | FP-Norm=2.698 | FP-Norm(final)=2.052 | 3458.2 samples/s | 54.0 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.02108 | Reg=0.00736 | acc=1.0000 | FP-Norm=2.689 | FP-Norm(final)=2.057 | 3472.5 samples/s | 54.3 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.01978 | Reg=0.00730 | acc=1.0000 | FP-Norm=2.678 | FP-Norm(final)=2.062 | 3471.6 samples/s | 54.2 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.01868 | Reg=0.00724 | acc=1.0000 | FP-Norm=2.669 | FP-Norm(final)=2.066 | 1687.5 samples/s | 26.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33339 | acc=0.5977 | tpr=0.5130 | fpr=0.2183 | 3505.6 samples/s | 13.7 steps/s
Avg test loss: 0.33402, Avg test acc: 0.59440, Avg tpr: 0.51011, Avg fpr: 0.22023, total FA: 1718

Testing server on iccad2012
[Step=  50] | Loss=0.31522 | acc=0.6948 | tpr=0.8142 | fpr=0.3073 | 3540.3 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.31527 | acc=0.6928 | tpr=0.7804 | fpr=0.3089 | 6333.9 samples/s | 24.7 steps/s
[Step= 150] | Loss=0.31515 | acc=0.6939 | tpr=0.7824 | fpr=0.3077 | 6748.5 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.31539 | acc=0.6927 | tpr=0.7836 | fpr=0.3089 | 6604.4 samples/s | 25.8 steps/s
[Step= 250] | Loss=0.31545 | acc=0.6921 | tpr=0.7790 | fpr=0.3095 | 6494.1 samples/s | 25.4 steps/s
[Step= 300] | Loss=0.31560 | acc=0.6920 | tpr=0.7760 | fpr=0.3096 | 6721.4 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.31570 | acc=0.6916 | tpr=0.7821 | fpr=0.3100 | 6413.0 samples/s | 25.1 steps/s
[Step= 400] | Loss=0.31575 | acc=0.6910 | tpr=0.7823 | fpr=0.3106 | 6589.8 samples/s | 25.7 steps/s
[Step= 450] | Loss=0.31588 | acc=0.6901 | tpr=0.7795 | fpr=0.3115 | 6507.3 samples/s | 25.4 steps/s
[Step= 500] | Loss=0.31576 | acc=0.6904 | tpr=0.7802 | fpr=0.3113 | 6278.1 samples/s | 24.5 steps/s
[Step= 550] | Loss=0.31566 | acc=0.6911 | tpr=0.7855 | fpr=0.3106 | 12502.2 samples/s | 48.8 steps/s
Avg test loss: 0.31569, Avg test acc: 0.69106, Avg tpr: 0.78566, Avg fpr: 0.31066, total FA: 43135

server round 1/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.1] | Loss=0.28285 | Reg=0.00000 | acc=0.7188 | FP-Norm=0.000 | FP-Norm(final)=1.999 | 3600.6 samples/s | 56.3 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.09968 | Reg=0.00566 | acc=0.9531 | FP-Norm=2.228 | FP-Norm(final)=2.005 | 3253.0 samples/s | 50.8 steps/s
[Step= 900 Epoch= 3.4] | Loss=0.05737 | Reg=0.00694 | acc=1.0000 | FP-Norm=2.548 | FP-Norm(final)=2.022 | 3477.7 samples/s | 54.3 steps/s
[Step= 950 Epoch= 3.6] | Loss=0.04061 | Reg=0.00724 | acc=1.0000 | FP-Norm=2.631 | FP-Norm(final)=2.037 | 3478.8 samples/s | 54.4 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.03135 | Reg=0.00722 | acc=1.0000 | FP-Norm=2.644 | FP-Norm(final)=2.048 | 3475.8 samples/s | 54.3 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.02626 | Reg=0.00719 | acc=1.0000 | FP-Norm=2.647 | FP-Norm(final)=2.058 | 4241.9 samples/s | 66.3 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.02230 | Reg=0.00717 | acc=1.0000 | FP-Norm=2.649 | FP-Norm(final)=2.065 | 1554.2 samples/s | 24.3 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01932 | Reg=0.00707 | acc=1.0000 | FP-Norm=2.633 | FP-Norm(final)=2.072 | 3513.4 samples/s | 54.9 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01704 | Reg=0.00695 | acc=1.0000 | FP-Norm=2.613 | FP-Norm(final)=2.078 | 3495.5 samples/s | 54.6 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01525 | Reg=0.00681 | acc=1.0000 | FP-Norm=2.589 | FP-Norm(final)=2.084 | 3506.6 samples/s | 54.8 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.01381 | Reg=0.00667 | acc=1.0000 | FP-Norm=2.562 | FP-Norm(final)=2.090 | 3756.5 samples/s | 58.7 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.01260 | Reg=0.00653 | acc=1.0000 | FP-Norm=2.534 | FP-Norm(final)=2.096 | 1652.5 samples/s | 25.8 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.01160 | Reg=0.00638 | acc=1.0000 | FP-Norm=2.505 | FP-Norm(final)=2.101 | 3492.1 samples/s | 54.6 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.01073 | Reg=0.00623 | acc=1.0000 | FP-Norm=2.474 | FP-Norm(final)=2.105 | 3439.7 samples/s | 53.7 steps/s
[Step=1500 Epoch= 5.7] | Loss=0.00998 | Reg=0.00608 | acc=1.0000 | FP-Norm=2.443 | FP-Norm(final)=2.110 | 3457.5 samples/s | 54.0 steps/s
[Step=1550 Epoch= 5.9] | Loss=0.00934 | Reg=0.00594 | acc=1.0000 | FP-Norm=2.412 | FP-Norm(final)=2.113 | 3448.2 samples/s | 53.9 steps/s
[Step=1600 Epoch= 6.1] | Loss=0.00878 | Reg=0.00580 | acc=1.0000 | FP-Norm=2.381 | FP-Norm(final)=2.117 | 1689.5 samples/s | 26.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step1600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.28364 | Reg=0.00000 | acc=0.7812 | FP-Norm=0.000 | FP-Norm(final)=2.003 | 3462.4 samples/s | 54.1 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.09345 | Reg=0.00239 | acc=0.9531 | FP-Norm=1.480 | FP-Norm(final)=2.032 | 3322.1 samples/s | 51.9 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.06459 | Reg=0.00326 | acc=0.9844 | FP-Norm=1.755 | FP-Norm(final)=2.047 | 3553.1 samples/s | 55.5 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.04819 | Reg=0.00383 | acc=0.9688 | FP-Norm=1.913 | FP-Norm(final)=2.056 | 3480.4 samples/s | 54.4 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.03752 | Reg=0.00418 | acc=1.0000 | FP-Norm=2.006 | FP-Norm(final)=2.066 | 3487.6 samples/s | 54.5 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.03123 | Reg=0.00439 | acc=1.0000 | FP-Norm=2.063 | FP-Norm(final)=2.074 | 4406.6 samples/s | 68.9 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.02659 | Reg=0.00454 | acc=1.0000 | FP-Norm=2.102 | FP-Norm(final)=2.082 | 1569.2 samples/s | 24.5 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.02325 | Reg=0.00463 | acc=0.9844 | FP-Norm=2.126 | FP-Norm(final)=2.089 | 3476.5 samples/s | 54.3 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.02074 | Reg=0.00472 | acc=1.0000 | FP-Norm=2.149 | FP-Norm(final)=2.095 | 3492.5 samples/s | 54.6 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.01891 | Reg=0.00481 | acc=1.0000 | FP-Norm=2.171 | FP-Norm(final)=2.102 | 3537.3 samples/s | 55.3 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.01741 | Reg=0.00491 | acc=1.0000 | FP-Norm=2.197 | FP-Norm(final)=2.107 | 3925.5 samples/s | 61.3 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.01587 | Reg=0.00499 | acc=1.0000 | FP-Norm=2.215 | FP-Norm(final)=2.113 | 1607.3 samples/s | 25.1 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.01460 | Reg=0.00501 | acc=1.0000 | FP-Norm=2.222 | FP-Norm(final)=2.118 | 3477.7 samples/s | 54.3 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.01354 | Reg=0.00501 | acc=1.0000 | FP-Norm=2.222 | FP-Norm(final)=2.123 | 3520.6 samples/s | 55.0 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.01261 | Reg=0.00499 | acc=1.0000 | FP-Norm=2.218 | FP-Norm(final)=2.127 | 3516.5 samples/s | 54.9 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.01202 | Reg=0.00496 | acc=0.9844 | FP-Norm=2.214 | FP-Norm(final)=2.132 | 3568.4 samples/s | 55.8 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.01167 | Reg=0.00505 | acc=1.0000 | FP-Norm=2.233 | FP-Norm(final)=2.135 | 1665.7 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40120 | acc=0.4695 | tpr=0.3327 | fpr=0.2334 | 3480.5 samples/s | 13.6 steps/s
Avg test loss: 0.40177, Avg test acc: 0.46702, Avg tpr: 0.33147, Avg fpr: 0.23484, total FA: 1832

Testing server on iccad2012
[Step=  50] | Loss=0.19659 | acc=0.8904 | tpr=0.9558 | fpr=0.1108 | 3465.2 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.19799 | acc=0.8888 | tpr=0.9616 | fpr=0.1126 | 6665.8 samples/s | 26.0 steps/s
[Step= 150] | Loss=0.19873 | acc=0.8882 | tpr=0.9582 | fpr=0.1131 | 6187.5 samples/s | 24.2 steps/s
[Step= 200] | Loss=0.19926 | acc=0.8879 | tpr=0.9617 | fpr=0.1135 | 6671.6 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.19942 | acc=0.8874 | tpr=0.9581 | fpr=0.1139 | 6551.5 samples/s | 25.6 steps/s
[Step= 300] | Loss=0.19978 | acc=0.8874 | tpr=0.9571 | fpr=0.1139 | 6745.5 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.20003 | acc=0.8869 | tpr=0.9587 | fpr=0.1144 | 6580.9 samples/s | 25.7 steps/s
[Step= 400] | Loss=0.20013 | acc=0.8867 | tpr=0.9601 | fpr=0.1146 | 6551.3 samples/s | 25.6 steps/s
[Step= 450] | Loss=0.20047 | acc=0.8859 | tpr=0.9586 | fpr=0.1154 | 6511.5 samples/s | 25.4 steps/s
[Step= 500] | Loss=0.20021 | acc=0.8864 | tpr=0.9612 | fpr=0.1150 | 6405.0 samples/s | 25.0 steps/s
[Step= 550] | Loss=0.20003 | acc=0.8866 | tpr=0.9630 | fpr=0.1148 | 12306.7 samples/s | 48.1 steps/s
Avg test loss: 0.19999, Avg test acc: 0.88665, Avg tpr: 0.96315, Avg fpr: 0.11474, total FA: 15931

server round 2/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 1.6] | Loss=0.37815 | Reg=0.00000 | acc=0.5312 | FP-Norm=0.000 | FP-Norm(final)=2.077 | 3596.4 samples/s | 56.2 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.18003 | Reg=0.00350 | acc=0.8906 | FP-Norm=1.771 | FP-Norm(final)=2.068 | 3546.3 samples/s | 55.4 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.15578 | Reg=0.00429 | acc=0.8906 | FP-Norm=2.011 | FP-Norm(final)=2.076 | 3632.0 samples/s | 56.7 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.14027 | Reg=0.00479 | acc=0.9531 | FP-Norm=2.144 | FP-Norm(final)=2.084 | 3717.8 samples/s | 58.1 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.12920 | Reg=0.00527 | acc=0.8750 | FP-Norm=2.255 | FP-Norm(final)=2.091 | 3709.1 samples/s | 58.0 steps/s
[Step=1050 Epoch= 2.1] | Loss=0.12200 | Reg=0.00570 | acc=0.9375 | FP-Norm=2.349 | FP-Norm(final)=2.096 | 3690.4 samples/s | 57.7 steps/s
[Step=1100 Epoch= 2.2] | Loss=0.11406 | Reg=0.00611 | acc=0.9531 | FP-Norm=2.433 | FP-Norm(final)=2.102 | 3663.2 samples/s | 57.2 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.11002 | Reg=0.00651 | acc=0.9688 | FP-Norm=2.511 | FP-Norm(final)=2.109 | 3655.4 samples/s | 57.1 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.10688 | Reg=0.00689 | acc=0.9062 | FP-Norm=2.584 | FP-Norm(final)=2.113 | 3702.4 samples/s | 57.8 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.10408 | Reg=0.00724 | acc=1.0000 | FP-Norm=2.650 | FP-Norm(final)=2.116 | 3655.4 samples/s | 57.1 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.10142 | Reg=0.00758 | acc=0.9375 | FP-Norm=2.710 | FP-Norm(final)=2.120 | 4431.0 samples/s | 69.2 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.09811 | Reg=0.00792 | acc=0.9688 | FP-Norm=2.769 | FP-Norm(final)=2.123 | 1594.5 samples/s | 24.9 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.09483 | Reg=0.00823 | acc=0.9531 | FP-Norm=2.824 | FP-Norm(final)=2.126 | 3647.8 samples/s | 57.0 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.09270 | Reg=0.00852 | acc=0.9062 | FP-Norm=2.872 | FP-Norm(final)=2.130 | 3629.3 samples/s | 56.7 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.08973 | Reg=0.00879 | acc=0.9844 | FP-Norm=2.919 | FP-Norm(final)=2.134 | 3634.5 samples/s | 56.8 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.08770 | Reg=0.00907 | acc=0.9688 | FP-Norm=2.964 | FP-Norm(final)=2.138 | 3644.6 samples/s | 56.9 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.08581 | Reg=0.00935 | acc=0.9688 | FP-Norm=3.008 | FP-Norm(final)=2.142 | 3674.2 samples/s | 57.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step1600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.1] | Loss=0.13582 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.080 | 3444.6 samples/s | 53.8 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.05950 | Reg=0.00377 | acc=0.9844 | FP-Norm=1.807 | FP-Norm(final)=2.091 | 3307.5 samples/s | 51.7 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.03728 | Reg=0.00522 | acc=1.0000 | FP-Norm=2.195 | FP-Norm(final)=2.093 | 3479.3 samples/s | 54.4 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.02662 | Reg=0.00546 | acc=0.9688 | FP-Norm=2.275 | FP-Norm(final)=2.101 | 3445.4 samples/s | 53.8 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02082 | Reg=0.00546 | acc=1.0000 | FP-Norm=2.290 | FP-Norm(final)=2.109 | 3526.4 samples/s | 55.1 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.01717 | Reg=0.00537 | acc=1.0000 | FP-Norm=2.280 | FP-Norm(final)=2.116 | 4324.1 samples/s | 67.6 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01451 | Reg=0.00525 | acc=1.0000 | FP-Norm=2.260 | FP-Norm(final)=2.123 | 1556.3 samples/s | 24.3 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01252 | Reg=0.00511 | acc=1.0000 | FP-Norm=2.231 | FP-Norm(final)=2.129 | 3497.9 samples/s | 54.7 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01104 | Reg=0.00496 | acc=1.0000 | FP-Norm=2.201 | FP-Norm(final)=2.134 | 3540.0 samples/s | 55.3 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.00986 | Reg=0.00482 | acc=1.0000 | FP-Norm=2.170 | FP-Norm(final)=2.139 | 3513.7 samples/s | 54.9 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00894 | Reg=0.00469 | acc=1.0000 | FP-Norm=2.139 | FP-Norm(final)=2.143 | 3955.0 samples/s | 61.8 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00817 | Reg=0.00456 | acc=1.0000 | FP-Norm=2.109 | FP-Norm(final)=2.147 | 1620.0 samples/s | 25.3 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00752 | Reg=0.00443 | acc=1.0000 | FP-Norm=2.079 | FP-Norm(final)=2.151 | 3560.4 samples/s | 55.6 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00698 | Reg=0.00432 | acc=1.0000 | FP-Norm=2.050 | FP-Norm(final)=2.154 | 3491.8 samples/s | 54.6 steps/s
[Step=1500 Epoch= 5.8] | Loss=0.00650 | Reg=0.00421 | acc=1.0000 | FP-Norm=2.023 | FP-Norm(final)=2.158 | 3534.5 samples/s | 55.2 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.00609 | Reg=0.00410 | acc=1.0000 | FP-Norm=1.995 | FP-Norm(final)=2.161 | 3571.2 samples/s | 55.8 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.00572 | Reg=0.00400 | acc=1.0000 | FP-Norm=1.968 | FP-Norm(final)=2.164 | 1693.0 samples/s | 26.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43184 | acc=0.4579 | tpr=0.3106 | fpr=0.2222 | 3453.5 samples/s | 13.5 steps/s
Avg test loss: 0.43302, Avg test acc: 0.45609, Avg tpr: 0.31118, Avg fpr: 0.22523, total FA: 1757

Testing server on iccad2012
[Step=  50] | Loss=0.16809 | acc=0.9016 | tpr=0.9690 | fpr=0.0996 | 3467.4 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.16946 | acc=0.9005 | tpr=0.9808 | fpr=0.1010 | 6350.6 samples/s | 24.8 steps/s
[Step= 150] | Loss=0.17059 | acc=0.9002 | tpr=0.9784 | fpr=0.1013 | 6620.0 samples/s | 25.9 steps/s
[Step= 200] | Loss=0.17115 | acc=0.8998 | tpr=0.9781 | fpr=0.1016 | 6594.3 samples/s | 25.8 steps/s
[Step= 250] | Loss=0.17118 | acc=0.8998 | tpr=0.9782 | fpr=0.1016 | 6762.0 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.17132 | acc=0.9001 | tpr=0.9782 | fpr=0.1014 | 6345.0 samples/s | 24.8 steps/s
[Step= 350] | Loss=0.17149 | acc=0.8998 | tpr=0.9781 | fpr=0.1016 | 6483.8 samples/s | 25.3 steps/s
[Step= 400] | Loss=0.17172 | acc=0.8993 | tpr=0.9781 | fpr=0.1021 | 6514.3 samples/s | 25.4 steps/s
[Step= 450] | Loss=0.17215 | acc=0.8989 | tpr=0.9776 | fpr=0.1025 | 6323.9 samples/s | 24.7 steps/s
[Step= 500] | Loss=0.17179 | acc=0.8992 | tpr=0.9784 | fpr=0.1022 | 6419.5 samples/s | 25.1 steps/s
[Step= 550] | Loss=0.17156 | acc=0.8993 | tpr=0.9797 | fpr=0.1021 | 12349.2 samples/s | 48.2 steps/s
Avg test loss: 0.17149, Avg test acc: 0.89939, Avg tpr: 0.97979, Avg fpr: 0.10208, total FA: 14173

server round 3/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 3.1] | Loss=0.32469 | Reg=0.00000 | acc=0.6562 | FP-Norm=0.000 | FP-Norm(final)=2.110 | 3709.6 samples/s | 58.0 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.17840 | Reg=0.00391 | acc=0.8906 | FP-Norm=1.871 | FP-Norm(final)=2.093 | 3336.5 samples/s | 52.1 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.14901 | Reg=0.00463 | acc=0.8906 | FP-Norm=2.092 | FP-Norm(final)=2.100 | 3637.3 samples/s | 56.8 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.12921 | Reg=0.00498 | acc=0.9219 | FP-Norm=2.188 | FP-Norm(final)=2.112 | 3713.9 samples/s | 58.0 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.11905 | Reg=0.00531 | acc=0.9531 | FP-Norm=2.269 | FP-Norm(final)=2.122 | 3703.7 samples/s | 57.9 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.11241 | Reg=0.00566 | acc=0.8594 | FP-Norm=2.347 | FP-Norm(final)=2.131 | 3705.9 samples/s | 57.9 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.10781 | Reg=0.00597 | acc=0.9688 | FP-Norm=2.413 | FP-Norm(final)=2.138 | 3695.8 samples/s | 57.7 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.10357 | Reg=0.00627 | acc=0.9219 | FP-Norm=2.474 | FP-Norm(final)=2.145 | 3703.4 samples/s | 57.9 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.09941 | Reg=0.00659 | acc=0.9375 | FP-Norm=2.536 | FP-Norm(final)=2.151 | 3672.5 samples/s | 57.4 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.09609 | Reg=0.00689 | acc=0.9844 | FP-Norm=2.593 | FP-Norm(final)=2.157 | 3650.4 samples/s | 57.0 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.09370 | Reg=0.00717 | acc=0.9688 | FP-Norm=2.645 | FP-Norm(final)=2.162 | 4471.7 samples/s | 69.9 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.08971 | Reg=0.00745 | acc=0.9375 | FP-Norm=2.695 | FP-Norm(final)=2.166 | 1602.6 samples/s | 25.0 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.08650 | Reg=0.00771 | acc=0.9375 | FP-Norm=2.742 | FP-Norm(final)=2.172 | 3624.1 samples/s | 56.6 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.08336 | Reg=0.00797 | acc=0.9688 | FP-Norm=2.787 | FP-Norm(final)=2.178 | 3696.2 samples/s | 57.8 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.08167 | Reg=0.00824 | acc=0.9375 | FP-Norm=2.833 | FP-Norm(final)=2.183 | 3727.2 samples/s | 58.2 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.08037 | Reg=0.00850 | acc=0.9688 | FP-Norm=2.876 | FP-Norm(final)=2.187 | 3701.1 samples/s | 57.8 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.07872 | Reg=0.00875 | acc=0.9531 | FP-Norm=2.917 | FP-Norm(final)=2.191 | 3668.1 samples/s | 57.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step2400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 6.2] | Loss=0.11180 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.113 | 3300.8 samples/s | 51.6 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.03265 | Reg=0.00352 | acc=1.0000 | FP-Norm=1.769 | FP-Norm(final)=2.127 | 3455.8 samples/s | 54.0 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.02016 | Reg=0.00438 | acc=1.0000 | FP-Norm=2.028 | FP-Norm(final)=2.132 | 3504.2 samples/s | 54.8 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.01567 | Reg=0.00465 | acc=1.0000 | FP-Norm=2.112 | FP-Norm(final)=2.137 | 3504.3 samples/s | 54.8 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.01251 | Reg=0.00476 | acc=1.0000 | FP-Norm=2.148 | FP-Norm(final)=2.144 | 3485.9 samples/s | 54.5 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.01064 | Reg=0.00481 | acc=1.0000 | FP-Norm=2.166 | FP-Norm(final)=2.150 | 4380.1 samples/s | 68.4 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00915 | Reg=0.00487 | acc=1.0000 | FP-Norm=2.184 | FP-Norm(final)=2.155 | 1525.4 samples/s | 23.8 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00791 | Reg=0.00484 | acc=1.0000 | FP-Norm=2.180 | FP-Norm(final)=2.161 | 3446.3 samples/s | 53.8 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00694 | Reg=0.00476 | acc=1.0000 | FP-Norm=2.164 | FP-Norm(final)=2.165 | 3469.0 samples/s | 54.2 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.00626 | Reg=0.00467 | acc=1.0000 | FP-Norm=2.143 | FP-Norm(final)=2.170 | 3469.5 samples/s | 54.2 steps/s
[Step=2100 Epoch= 8.1] | Loss=0.00566 | Reg=0.00456 | acc=1.0000 | FP-Norm=2.119 | FP-Norm(final)=2.174 | 3800.7 samples/s | 59.4 steps/s
[Step=2150 Epoch= 8.3] | Loss=0.00524 | Reg=0.00446 | acc=1.0000 | FP-Norm=2.096 | FP-Norm(final)=2.177 | 1577.7 samples/s | 24.7 steps/s
[Step=2200 Epoch= 8.5] | Loss=0.00482 | Reg=0.00437 | acc=1.0000 | FP-Norm=2.074 | FP-Norm(final)=2.181 | 3518.5 samples/s | 55.0 steps/s
[Step=2250 Epoch= 8.7] | Loss=0.00462 | Reg=0.00430 | acc=1.0000 | FP-Norm=2.057 | FP-Norm(final)=2.184 | 3551.8 samples/s | 55.5 steps/s
[Step=2300 Epoch= 8.9] | Loss=0.00451 | Reg=0.00429 | acc=1.0000 | FP-Norm=2.057 | FP-Norm(final)=2.187 | 3423.0 samples/s | 53.5 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.00425 | Reg=0.00430 | acc=1.0000 | FP-Norm=2.060 | FP-Norm(final)=2.190 | 3524.9 samples/s | 55.1 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.00403 | Reg=0.00429 | acc=1.0000 | FP-Norm=2.058 | FP-Norm(final)=2.194 | 1676.0 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.54514 | acc=0.3767 | tpr=0.1203 | fpr=0.0664 | 3440.7 samples/s | 13.4 steps/s
Avg test loss: 0.54846, Avg test acc: 0.37375, Avg tpr: 0.11832, Avg fpr: 0.06448, total FA: 503

Testing server on iccad2012
[Step=  50] | Loss=0.11554 | acc=0.9495 | tpr=0.9425 | fpr=0.0504 | 3514.2 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.11715 | acc=0.9481 | tpr=0.9424 | fpr=0.0518 | 6569.4 samples/s | 25.7 steps/s
[Step= 150] | Loss=0.11803 | acc=0.9462 | tpr=0.9424 | fpr=0.0538 | 6438.4 samples/s | 25.2 steps/s
[Step= 200] | Loss=0.11855 | acc=0.9456 | tpr=0.9454 | fpr=0.0544 | 6751.9 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.11840 | acc=0.9460 | tpr=0.9476 | fpr=0.0540 | 6557.8 samples/s | 25.6 steps/s
[Step= 300] | Loss=0.11858 | acc=0.9456 | tpr=0.9455 | fpr=0.0544 | 6586.0 samples/s | 25.7 steps/s
[Step= 350] | Loss=0.11872 | acc=0.9455 | tpr=0.9468 | fpr=0.0545 | 6420.3 samples/s | 25.1 steps/s
[Step= 400] | Loss=0.11894 | acc=0.9455 | tpr=0.9480 | fpr=0.0546 | 6475.2 samples/s | 25.3 steps/s
[Step= 450] | Loss=0.11940 | acc=0.9448 | tpr=0.9469 | fpr=0.0552 | 6575.6 samples/s | 25.7 steps/s
[Step= 500] | Loss=0.11909 | acc=0.9451 | tpr=0.9480 | fpr=0.0549 | 6224.6 samples/s | 24.3 steps/s
[Step= 550] | Loss=0.11883 | acc=0.9454 | tpr=0.9487 | fpr=0.0547 | 11470.7 samples/s | 44.8 steps/s
Avg test loss: 0.11878, Avg test acc: 0.94541, Avg tpr: 0.94889, Avg fpr: 0.05466, total FA: 7589

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36344 | Reg=0.00000 | acc=0.6562 | FP-Norm=0.000 | FP-Norm(final)=2.131 | 3385.9 samples/s | 52.9 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.17218 | Reg=0.00181 | acc=0.8906 | FP-Norm=1.288 | FP-Norm(final)=2.137 | 3306.1 samples/s | 51.7 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.14822 | Reg=0.00249 | acc=0.9219 | FP-Norm=1.533 | FP-Norm(final)=2.145 | 3668.5 samples/s | 57.3 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.13424 | Reg=0.00306 | acc=0.8750 | FP-Norm=1.705 | FP-Norm(final)=2.153 | 3721.0 samples/s | 58.1 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.12708 | Reg=0.00357 | acc=0.9531 | FP-Norm=1.843 | FP-Norm(final)=2.157 | 3628.7 samples/s | 56.7 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.12013 | Reg=0.00402 | acc=0.9062 | FP-Norm=1.957 | FP-Norm(final)=2.161 | 3656.2 samples/s | 57.1 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.11408 | Reg=0.00443 | acc=0.9531 | FP-Norm=2.055 | FP-Norm(final)=2.166 | 3634.4 samples/s | 56.8 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.11021 | Reg=0.00483 | acc=0.9219 | FP-Norm=2.145 | FP-Norm(final)=2.169 | 3668.2 samples/s | 57.3 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.10755 | Reg=0.00522 | acc=0.9375 | FP-Norm=2.230 | FP-Norm(final)=2.172 | 3634.0 samples/s | 56.8 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.10408 | Reg=0.00559 | acc=0.9531 | FP-Norm=2.307 | FP-Norm(final)=2.175 | 3640.6 samples/s | 56.9 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.10117 | Reg=0.00594 | acc=0.9375 | FP-Norm=2.377 | FP-Norm(final)=2.179 | 4346.0 samples/s | 67.9 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.09663 | Reg=0.00629 | acc=0.9531 | FP-Norm=2.445 | FP-Norm(final)=2.183 | 1601.2 samples/s | 25.0 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.09300 | Reg=0.00660 | acc=0.9531 | FP-Norm=2.505 | FP-Norm(final)=2.187 | 3665.2 samples/s | 57.3 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.08983 | Reg=0.00690 | acc=0.9531 | FP-Norm=2.562 | FP-Norm(final)=2.192 | 3648.2 samples/s | 57.0 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.08810 | Reg=0.00720 | acc=1.0000 | FP-Norm=2.618 | FP-Norm(final)=2.196 | 3675.9 samples/s | 57.4 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.08620 | Reg=0.00750 | acc=0.9688 | FP-Norm=2.670 | FP-Norm(final)=2.199 | 3689.9 samples/s | 57.7 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.08445 | Reg=0.00779 | acc=1.0000 | FP-Norm=2.722 | FP-Norm(final)=2.203 | 3686.3 samples/s | 57.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 4.7] | Loss=0.45316 | Reg=0.00000 | acc=0.4688 | FP-Norm=0.000 | FP-Norm(final)=2.129 | 3579.4 samples/s | 55.9 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.17730 | Reg=0.00430 | acc=0.8906 | FP-Norm=1.975 | FP-Norm(final)=2.110 | 3538.0 samples/s | 55.3 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.14130 | Reg=0.00484 | acc=0.9531 | FP-Norm=2.148 | FP-Norm(final)=2.125 | 3704.5 samples/s | 57.9 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.12494 | Reg=0.00508 | acc=0.9844 | FP-Norm=2.217 | FP-Norm(final)=2.138 | 3699.2 samples/s | 57.8 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.11627 | Reg=0.00535 | acc=0.9062 | FP-Norm=2.284 | FP-Norm(final)=2.149 | 3701.7 samples/s | 57.8 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.10826 | Reg=0.00564 | acc=0.9531 | FP-Norm=2.349 | FP-Norm(final)=2.158 | 3712.9 samples/s | 58.0 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.10336 | Reg=0.00593 | acc=0.9688 | FP-Norm=2.410 | FP-Norm(final)=2.166 | 3718.0 samples/s | 58.1 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.09960 | Reg=0.00623 | acc=0.9531 | FP-Norm=2.471 | FP-Norm(final)=2.172 | 3699.0 samples/s | 57.8 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.09577 | Reg=0.00654 | acc=0.9375 | FP-Norm=2.530 | FP-Norm(final)=2.177 | 3644.3 samples/s | 56.9 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.09226 | Reg=0.00685 | acc=0.9688 | FP-Norm=2.589 | FP-Norm(final)=2.183 | 3674.8 samples/s | 57.4 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.08908 | Reg=0.00713 | acc=0.9062 | FP-Norm=2.640 | FP-Norm(final)=2.188 | 4481.8 samples/s | 70.0 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.08568 | Reg=0.00738 | acc=0.9219 | FP-Norm=2.686 | FP-Norm(final)=2.193 | 1621.8 samples/s | 25.3 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.08269 | Reg=0.00765 | acc=0.9375 | FP-Norm=2.734 | FP-Norm(final)=2.199 | 3663.3 samples/s | 57.2 steps/s
[Step=3050 Epoch= 6.0] | Loss=0.08065 | Reg=0.00793 | acc=0.9688 | FP-Norm=2.782 | FP-Norm(final)=2.204 | 3711.8 samples/s | 58.0 steps/s
[Step=3100 Epoch= 6.1] | Loss=0.07921 | Reg=0.00820 | acc=0.9219 | FP-Norm=2.827 | FP-Norm(final)=2.209 | 3671.6 samples/s | 57.4 steps/s
[Step=3150 Epoch= 6.2] | Loss=0.07761 | Reg=0.00845 | acc=0.9375 | FP-Norm=2.869 | FP-Norm(final)=2.213 | 3702.5 samples/s | 57.9 steps/s
[Step=3200 Epoch= 6.3] | Loss=0.07564 | Reg=0.00868 | acc=0.9844 | FP-Norm=2.907 | FP-Norm(final)=2.217 | 3729.1 samples/s | 58.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31705 | acc=0.6894 | tpr=0.5615 | fpr=0.0330 | 3490.5 samples/s | 13.6 steps/s
Avg test loss: 0.32202, Avg test acc: 0.68519, Avg tpr: 0.55814, Avg fpr: 0.03538, total FA: 276

Testing server on iccad2012
[Step=  50] | Loss=0.25073 | acc=0.7984 | tpr=0.9513 | fpr=0.2044 | 3505.1 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.25277 | acc=0.7967 | tpr=0.9552 | fpr=0.2063 | 6505.5 samples/s | 25.4 steps/s
[Step= 150] | Loss=0.25359 | acc=0.7976 | tpr=0.9524 | fpr=0.2053 | 6663.1 samples/s | 26.0 steps/s
[Step= 200] | Loss=0.25451 | acc=0.7956 | tpr=0.9519 | fpr=0.2072 | 6563.9 samples/s | 25.6 steps/s
[Step= 250] | Loss=0.25460 | acc=0.7948 | tpr=0.9511 | fpr=0.2081 | 6211.5 samples/s | 24.3 steps/s
[Step= 300] | Loss=0.25554 | acc=0.7939 | tpr=0.9505 | fpr=0.2089 | 6659.0 samples/s | 26.0 steps/s
[Step= 350] | Loss=0.25553 | acc=0.7941 | tpr=0.9487 | fpr=0.2087 | 6825.5 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.25648 | acc=0.7933 | tpr=0.9480 | fpr=0.2096 | 6348.9 samples/s | 24.8 steps/s
[Step= 450] | Loss=0.25700 | acc=0.7932 | tpr=0.9469 | fpr=0.2096 | 6308.0 samples/s | 24.6 steps/s
[Step= 500] | Loss=0.25645 | acc=0.7935 | tpr=0.9476 | fpr=0.2093 | 6641.4 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.25595 | acc=0.7942 | tpr=0.9467 | fpr=0.2086 | 11836.7 samples/s | 46.2 steps/s
Avg test loss: 0.25594, Avg test acc: 0.79415, Avg tpr: 0.94651, Avg fpr: 0.20862, total FA: 28966

server round 5/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch= 6.3] | Loss=0.27753 | Reg=0.00000 | acc=0.7656 | FP-Norm=0.000 | FP-Norm(final)=2.224 | 3574.0 samples/s | 55.8 steps/s
[Step=3250 Epoch= 6.4] | Loss=0.10553 | Reg=0.00197 | acc=0.9062 | FP-Norm=1.338 | FP-Norm(final)=2.218 | 3517.3 samples/s | 55.0 steps/s
[Step=3300 Epoch= 6.5] | Loss=0.08992 | Reg=0.00247 | acc=0.9375 | FP-Norm=1.529 | FP-Norm(final)=2.229 | 3660.2 samples/s | 57.2 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.08356 | Reg=0.00283 | acc=0.9688 | FP-Norm=1.647 | FP-Norm(final)=2.237 | 3702.1 samples/s | 57.8 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.07999 | Reg=0.00315 | acc=0.9688 | FP-Norm=1.742 | FP-Norm(final)=2.244 | 3691.9 samples/s | 57.7 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.07842 | Reg=0.00348 | acc=0.8594 | FP-Norm=1.831 | FP-Norm(final)=2.249 | 3665.5 samples/s | 57.3 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.07559 | Reg=0.00377 | acc=0.9531 | FP-Norm=1.908 | FP-Norm(final)=2.253 | 3715.8 samples/s | 58.1 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.07362 | Reg=0.00405 | acc=1.0000 | FP-Norm=1.976 | FP-Norm(final)=2.257 | 3733.8 samples/s | 58.3 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.07237 | Reg=0.00431 | acc=0.9844 | FP-Norm=2.039 | FP-Norm(final)=2.260 | 3685.5 samples/s | 57.6 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.07164 | Reg=0.00457 | acc=0.9531 | FP-Norm=2.100 | FP-Norm(final)=2.262 | 3677.5 samples/s | 57.5 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.07036 | Reg=0.00482 | acc=0.9688 | FP-Norm=2.156 | FP-Norm(final)=2.263 | 4382.1 samples/s | 68.5 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.06812 | Reg=0.00506 | acc=0.9844 | FP-Norm=2.207 | FP-Norm(final)=2.265 | 1604.0 samples/s | 25.1 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.06597 | Reg=0.00527 | acc=0.9844 | FP-Norm=2.252 | FP-Norm(final)=2.267 | 3636.5 samples/s | 56.8 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.06467 | Reg=0.00547 | acc=0.9844 | FP-Norm=2.296 | FP-Norm(final)=2.269 | 3618.7 samples/s | 56.5 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.06373 | Reg=0.00567 | acc=0.9375 | FP-Norm=2.337 | FP-Norm(final)=2.271 | 3655.6 samples/s | 57.1 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.06264 | Reg=0.00585 | acc=0.9531 | FP-Norm=2.374 | FP-Norm(final)=2.273 | 3691.5 samples/s | 57.7 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.06089 | Reg=0.00602 | acc=0.9375 | FP-Norm=2.409 | FP-Norm(final)=2.274 | 3636.3 samples/s | 56.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step4000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 9.2] | Loss=0.08595 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.227 | 3272.9 samples/s | 51.1 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.03456 | Reg=0.00523 | acc=1.0000 | FP-Norm=2.169 | FP-Norm(final)=2.204 | 3391.3 samples/s | 53.0 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.02137 | Reg=0.00616 | acc=1.0000 | FP-Norm=2.416 | FP-Norm(final)=2.203 | 3513.1 samples/s | 54.9 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.01602 | Reg=0.00619 | acc=1.0000 | FP-Norm=2.444 | FP-Norm(final)=2.207 | 3533.9 samples/s | 55.2 steps/s
[Step=2600 Epoch=10.0] | Loss=0.01276 | Reg=0.00606 | acc=0.9688 | FP-Norm=2.427 | FP-Norm(final)=2.213 | 3496.8 samples/s | 54.6 steps/s
[Step=2650 Epoch=10.2] | Loss=0.01097 | Reg=0.00594 | acc=0.9844 | FP-Norm=2.411 | FP-Norm(final)=2.218 | 4378.7 samples/s | 68.4 steps/s
[Step=2700 Epoch=10.4] | Loss=0.00947 | Reg=0.00583 | acc=1.0000 | FP-Norm=2.391 | FP-Norm(final)=2.223 | 1541.9 samples/s | 24.1 steps/s
[Step=2750 Epoch=10.6] | Loss=0.00816 | Reg=0.00572 | acc=1.0000 | FP-Norm=2.370 | FP-Norm(final)=2.228 | 3471.9 samples/s | 54.2 steps/s
[Step=2800 Epoch=10.8] | Loss=0.00717 | Reg=0.00557 | acc=1.0000 | FP-Norm=2.340 | FP-Norm(final)=2.232 | 3472.1 samples/s | 54.3 steps/s
[Step=2850 Epoch=11.0] | Loss=0.00641 | Reg=0.00541 | acc=1.0000 | FP-Norm=2.305 | FP-Norm(final)=2.237 | 3475.8 samples/s | 54.3 steps/s
[Step=2900 Epoch=11.2] | Loss=0.00578 | Reg=0.00524 | acc=1.0000 | FP-Norm=2.268 | FP-Norm(final)=2.241 | 3867.5 samples/s | 60.4 steps/s
[Step=2950 Epoch=11.4] | Loss=0.00527 | Reg=0.00507 | acc=1.0000 | FP-Norm=2.229 | FP-Norm(final)=2.244 | 1605.2 samples/s | 25.1 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00484 | Reg=0.00490 | acc=1.0000 | FP-Norm=2.189 | FP-Norm(final)=2.248 | 3460.5 samples/s | 54.1 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00447 | Reg=0.00474 | acc=1.0000 | FP-Norm=2.150 | FP-Norm(final)=2.251 | 3463.9 samples/s | 54.1 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00417 | Reg=0.00459 | acc=1.0000 | FP-Norm=2.111 | FP-Norm(final)=2.254 | 3456.7 samples/s | 54.0 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00390 | Reg=0.00445 | acc=1.0000 | FP-Norm=2.074 | FP-Norm(final)=2.257 | 3516.2 samples/s | 54.9 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00367 | Reg=0.00431 | acc=1.0000 | FP-Norm=2.039 | FP-Norm(final)=2.259 | 1626.8 samples/s | 25.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22095 | acc=0.8030 | tpr=0.7355 | fpr=0.0503 | 3494.7 samples/s | 13.7 steps/s
Avg test loss: 0.22436, Avg test acc: 0.79722, Avg tpr: 0.72851, Avg fpr: 0.05166, total FA: 403

Testing server on iccad2012
[Step=  50] | Loss=0.38575 | acc=0.6650 | tpr=0.9558 | fpr=0.3402 | 3486.5 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.38795 | acc=0.6648 | tpr=0.9595 | fpr=0.3407 | 6535.2 samples/s | 25.5 steps/s
[Step= 150] | Loss=0.38911 | acc=0.6636 | tpr=0.9568 | fpr=0.3418 | 6632.2 samples/s | 25.9 steps/s
[Step= 200] | Loss=0.38983 | acc=0.6624 | tpr=0.9574 | fpr=0.3430 | 6520.6 samples/s | 25.5 steps/s
[Step= 250] | Loss=0.39011 | acc=0.6617 | tpr=0.9590 | fpr=0.3437 | 6585.5 samples/s | 25.7 steps/s
[Step= 300] | Loss=0.39158 | acc=0.6607 | tpr=0.9600 | fpr=0.3447 | 6400.0 samples/s | 25.0 steps/s
[Step= 350] | Loss=0.39154 | acc=0.6613 | tpr=0.9587 | fpr=0.3441 | 6827.8 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.39302 | acc=0.6601 | tpr=0.9595 | fpr=0.3453 | 6525.3 samples/s | 25.5 steps/s
[Step= 450] | Loss=0.39370 | acc=0.6605 | tpr=0.9596 | fpr=0.3450 | 6423.3 samples/s | 25.1 steps/s
[Step= 500] | Loss=0.39326 | acc=0.6605 | tpr=0.9599 | fpr=0.3449 | 6499.5 samples/s | 25.4 steps/s
[Step= 550] | Loss=0.39275 | acc=0.6605 | tpr=0.9594 | fpr=0.3449 | 11619.7 samples/s | 45.4 steps/s
Avg test loss: 0.39279, Avg test acc: 0.66041, Avg tpr: 0.95919, Avg fpr: 0.34502, total FA: 47905

server round 6/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 1.6] | Loss=0.24788 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.246 | 3423.6 samples/s | 53.5 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.08869 | Reg=0.00159 | acc=0.9375 | FP-Norm=1.201 | FP-Norm(final)=2.241 | 3532.4 samples/s | 55.2 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.08464 | Reg=0.00201 | acc=0.9375 | FP-Norm=1.379 | FP-Norm(final)=2.249 | 3696.6 samples/s | 57.8 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.08246 | Reg=0.00240 | acc=0.9531 | FP-Norm=1.515 | FP-Norm(final)=2.253 | 3711.7 samples/s | 58.0 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.08088 | Reg=0.00272 | acc=0.9531 | FP-Norm=1.616 | FP-Norm(final)=2.258 | 3698.0 samples/s | 57.8 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.07746 | Reg=0.00303 | acc=0.9062 | FP-Norm=1.704 | FP-Norm(final)=2.260 | 3702.6 samples/s | 57.9 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.07471 | Reg=0.00329 | acc=0.9375 | FP-Norm=1.778 | FP-Norm(final)=2.263 | 3704.6 samples/s | 57.9 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.07235 | Reg=0.00353 | acc=0.9688 | FP-Norm=1.842 | FP-Norm(final)=2.266 | 3704.9 samples/s | 57.9 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.07034 | Reg=0.00376 | acc=0.9219 | FP-Norm=1.901 | FP-Norm(final)=2.268 | 3676.9 samples/s | 57.5 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.06912 | Reg=0.00399 | acc=0.9219 | FP-Norm=1.959 | FP-Norm(final)=2.269 | 3661.8 samples/s | 57.2 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.06793 | Reg=0.00423 | acc=0.9844 | FP-Norm=2.016 | FP-Norm(final)=2.271 | 4335.3 samples/s | 67.7 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.06635 | Reg=0.00446 | acc=0.9688 | FP-Norm=2.069 | FP-Norm(final)=2.273 | 1595.0 samples/s | 24.9 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.06427 | Reg=0.00467 | acc=0.9375 | FP-Norm=2.116 | FP-Norm(final)=2.275 | 3704.5 samples/s | 57.9 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.06296 | Reg=0.00486 | acc=0.9844 | FP-Norm=2.160 | FP-Norm(final)=2.278 | 3673.5 samples/s | 57.4 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.06255 | Reg=0.00507 | acc=0.9844 | FP-Norm=2.205 | FP-Norm(final)=2.280 | 3673.1 samples/s | 57.4 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.06092 | Reg=0.00527 | acc=0.9844 | FP-Norm=2.247 | FP-Norm(final)=2.282 | 3660.6 samples/s | 57.2 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.06082 | Reg=0.00547 | acc=0.9062 | FP-Norm=2.288 | FP-Norm(final)=2.283 | 3691.7 samples/s | 57.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step1600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 6.1] | Loss=0.14013 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.248 | 3487.4 samples/s | 54.5 steps/s
[Step=1650 Epoch= 6.3] | Loss=0.02964 | Reg=0.00545 | acc=1.0000 | FP-Norm=2.219 | FP-Norm(final)=2.221 | 3187.9 samples/s | 49.8 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.01817 | Reg=0.00623 | acc=1.0000 | FP-Norm=2.432 | FP-Norm(final)=2.214 | 3498.5 samples/s | 54.7 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.01325 | Reg=0.00614 | acc=1.0000 | FP-Norm=2.436 | FP-Norm(final)=2.217 | 3516.4 samples/s | 54.9 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.01023 | Reg=0.00591 | acc=1.0000 | FP-Norm=2.397 | FP-Norm(final)=2.221 | 3499.1 samples/s | 54.7 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00828 | Reg=0.00564 | acc=1.0000 | FP-Norm=2.346 | FP-Norm(final)=2.227 | 4311.7 samples/s | 67.4 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00731 | Reg=0.00542 | acc=1.0000 | FP-Norm=2.301 | FP-Norm(final)=2.231 | 1518.5 samples/s | 23.7 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00630 | Reg=0.00521 | acc=1.0000 | FP-Norm=2.257 | FP-Norm(final)=2.236 | 3468.8 samples/s | 54.2 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00553 | Reg=0.00501 | acc=1.0000 | FP-Norm=2.210 | FP-Norm(final)=2.240 | 3439.8 samples/s | 53.7 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.00494 | Reg=0.00480 | acc=1.0000 | FP-Norm=2.163 | FP-Norm(final)=2.244 | 3463.5 samples/s | 54.1 steps/s
[Step=2100 Epoch= 8.0] | Loss=0.00451 | Reg=0.00463 | acc=1.0000 | FP-Norm=2.122 | FP-Norm(final)=2.248 | 3785.8 samples/s | 59.2 steps/s
[Step=2150 Epoch= 8.2] | Loss=0.00412 | Reg=0.00447 | acc=1.0000 | FP-Norm=2.083 | FP-Norm(final)=2.251 | 1595.8 samples/s | 24.9 steps/s
[Step=2200 Epoch= 8.4] | Loss=0.00378 | Reg=0.00432 | acc=1.0000 | FP-Norm=2.044 | FP-Norm(final)=2.254 | 3466.8 samples/s | 54.2 steps/s
[Step=2250 Epoch= 8.6] | Loss=0.00350 | Reg=0.00416 | acc=1.0000 | FP-Norm=2.004 | FP-Norm(final)=2.257 | 3468.3 samples/s | 54.2 steps/s
[Step=2300 Epoch= 8.8] | Loss=0.00326 | Reg=0.00402 | acc=1.0000 | FP-Norm=1.966 | FP-Norm(final)=2.260 | 3479.7 samples/s | 54.4 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.00305 | Reg=0.00388 | acc=1.0000 | FP-Norm=1.928 | FP-Norm(final)=2.263 | 3450.9 samples/s | 53.9 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.00287 | Reg=0.00375 | acc=1.0000 | FP-Norm=1.892 | FP-Norm(final)=2.265 | 1688.0 samples/s | 26.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.16480 | acc=0.8597 | tpr=0.8196 | fpr=0.0533 | 3484.9 samples/s | 13.6 steps/s
Avg test loss: 0.16760, Avg test acc: 0.85620, Avg tpr: 0.81512, Avg fpr: 0.05345, total FA: 417

Testing server on iccad2012
[Step=  50] | Loss=0.53540 | acc=0.5559 | tpr=0.9646 | fpr=0.4514 | 3530.9 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.53599 | acc=0.5567 | tpr=0.9659 | fpr=0.4510 | 6754.3 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.53904 | acc=0.5545 | tpr=0.9712 | fpr=0.4532 | 6470.4 samples/s | 25.3 steps/s
[Step= 200] | Loss=0.53978 | acc=0.5541 | tpr=0.9639 | fpr=0.4533 | 6642.4 samples/s | 25.9 steps/s
[Step= 250] | Loss=0.54100 | acc=0.5533 | tpr=0.9651 | fpr=0.4542 | 6602.5 samples/s | 25.8 steps/s
[Step= 300] | Loss=0.54333 | acc=0.5520 | tpr=0.9658 | fpr=0.4556 | 6416.2 samples/s | 25.1 steps/s
[Step= 350] | Loss=0.54306 | acc=0.5528 | tpr=0.9662 | fpr=0.4547 | 6307.6 samples/s | 24.6 steps/s
[Step= 400] | Loss=0.54493 | acc=0.5514 | tpr=0.9666 | fpr=0.4561 | 6740.9 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.54588 | acc=0.5509 | tpr=0.9669 | fpr=0.4566 | 6328.3 samples/s | 24.7 steps/s
[Step= 500] | Loss=0.54580 | acc=0.5510 | tpr=0.9674 | fpr=0.4565 | 6481.5 samples/s | 25.3 steps/s
[Step= 550] | Loss=0.54540 | acc=0.5502 | tpr=0.9674 | fpr=0.4574 | 12372.0 samples/s | 48.3 steps/s
Avg test loss: 0.54548, Avg test acc: 0.55017, Avg tpr: 0.96712, Avg fpr: 0.45741, total FA: 63510

server round 7/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 3.1] | Loss=0.12691 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.299 | 3181.4 samples/s | 49.7 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.08166 | Reg=0.00127 | acc=0.9531 | FP-Norm=1.062 | FP-Norm(final)=2.292 | 3599.7 samples/s | 56.2 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.07459 | Reg=0.00178 | acc=0.9375 | FP-Norm=1.286 | FP-Norm(final)=2.292 | 3622.9 samples/s | 56.6 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.06815 | Reg=0.00212 | acc=0.9375 | FP-Norm=1.416 | FP-Norm(final)=2.294 | 3647.6 samples/s | 57.0 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.06708 | Reg=0.00244 | acc=0.9531 | FP-Norm=1.521 | FP-Norm(final)=2.296 | 3654.8 samples/s | 57.1 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.06432 | Reg=0.00271 | acc=0.9844 | FP-Norm=1.607 | FP-Norm(final)=2.297 | 3625.5 samples/s | 56.6 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.06357 | Reg=0.00294 | acc=0.9688 | FP-Norm=1.678 | FP-Norm(final)=2.297 | 3643.5 samples/s | 56.9 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.06219 | Reg=0.00316 | acc=0.9688 | FP-Norm=1.739 | FP-Norm(final)=2.298 | 3621.1 samples/s | 56.6 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.06199 | Reg=0.00337 | acc=1.0000 | FP-Norm=1.798 | FP-Norm(final)=2.298 | 3628.0 samples/s | 56.7 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.06103 | Reg=0.00359 | acc=0.9844 | FP-Norm=1.854 | FP-Norm(final)=2.299 | 3727.4 samples/s | 58.2 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.06014 | Reg=0.00379 | acc=0.9688 | FP-Norm=1.905 | FP-Norm(final)=2.300 | 4346.9 samples/s | 67.9 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.05820 | Reg=0.00398 | acc=1.0000 | FP-Norm=1.952 | FP-Norm(final)=2.303 | 1573.4 samples/s | 24.6 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.05677 | Reg=0.00415 | acc=0.9688 | FP-Norm=1.995 | FP-Norm(final)=2.304 | 3664.5 samples/s | 57.3 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.05592 | Reg=0.00433 | acc=0.9688 | FP-Norm=2.036 | FP-Norm(final)=2.305 | 3711.2 samples/s | 58.0 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.05497 | Reg=0.00450 | acc=0.9688 | FP-Norm=2.076 | FP-Norm(final)=2.307 | 3676.9 samples/s | 57.5 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.05442 | Reg=0.00466 | acc=0.9844 | FP-Norm=2.112 | FP-Norm(final)=2.308 | 3479.8 samples/s | 54.4 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.05342 | Reg=0.00481 | acc=0.9844 | FP-Norm=2.147 | FP-Norm(final)=2.309 | 3653.4 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step2400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 9.2] | Loss=0.21869 | Reg=0.00000 | acc=0.7812 | FP-Norm=0.000 | FP-Norm(final)=2.300 | 3405.3 samples/s | 53.2 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.03169 | Reg=0.00723 | acc=0.9844 | FP-Norm=2.559 | FP-Norm(final)=2.258 | 3439.2 samples/s | 53.7 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.01815 | Reg=0.00790 | acc=1.0000 | FP-Norm=2.742 | FP-Norm(final)=2.252 | 3507.3 samples/s | 54.8 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.01299 | Reg=0.00758 | acc=1.0000 | FP-Norm=2.706 | FP-Norm(final)=2.254 | 3464.0 samples/s | 54.1 steps/s
[Step=2600 Epoch=10.0] | Loss=0.00988 | Reg=0.00717 | acc=1.0000 | FP-Norm=2.638 | FP-Norm(final)=2.257 | 3477.9 samples/s | 54.3 steps/s
[Step=2650 Epoch=10.2] | Loss=0.00923 | Reg=0.00681 | acc=1.0000 | FP-Norm=2.575 | FP-Norm(final)=2.261 | 4244.2 samples/s | 66.3 steps/s
[Step=2700 Epoch=10.3] | Loss=0.00812 | Reg=0.00663 | acc=1.0000 | FP-Norm=2.545 | FP-Norm(final)=2.263 | 1554.2 samples/s | 24.3 steps/s
[Step=2750 Epoch=10.5] | Loss=0.00712 | Reg=0.00645 | acc=1.0000 | FP-Norm=2.513 | FP-Norm(final)=2.267 | 3534.8 samples/s | 55.2 steps/s
[Step=2800 Epoch=10.7] | Loss=0.00650 | Reg=0.00629 | acc=1.0000 | FP-Norm=2.482 | FP-Norm(final)=2.270 | 3533.3 samples/s | 55.2 steps/s
[Step=2850 Epoch=10.9] | Loss=0.00609 | Reg=0.00624 | acc=1.0000 | FP-Norm=2.475 | FP-Norm(final)=2.274 | 3477.8 samples/s | 54.3 steps/s
[Step=2900 Epoch=11.1] | Loss=0.00555 | Reg=0.00618 | acc=1.0000 | FP-Norm=2.465 | FP-Norm(final)=2.278 | 3797.8 samples/s | 59.3 steps/s
[Step=2950 Epoch=11.3] | Loss=0.00506 | Reg=0.00608 | acc=1.0000 | FP-Norm=2.446 | FP-Norm(final)=2.281 | 1618.1 samples/s | 25.3 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00466 | Reg=0.00596 | acc=1.0000 | FP-Norm=2.421 | FP-Norm(final)=2.285 | 3434.7 samples/s | 53.7 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00431 | Reg=0.00582 | acc=1.0000 | FP-Norm=2.391 | FP-Norm(final)=2.288 | 3479.2 samples/s | 54.4 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00401 | Reg=0.00567 | acc=1.0000 | FP-Norm=2.358 | FP-Norm(final)=2.291 | 3458.5 samples/s | 54.0 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00375 | Reg=0.00552 | acc=1.0000 | FP-Norm=2.324 | FP-Norm(final)=2.294 | 3477.6 samples/s | 54.3 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00352 | Reg=0.00536 | acc=1.0000 | FP-Norm=2.288 | FP-Norm(final)=2.296 | 1654.2 samples/s | 25.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22410 | acc=0.8086 | tpr=0.7378 | fpr=0.0377 | 3504.4 samples/s | 13.7 steps/s
Avg test loss: 0.22876, Avg test acc: 0.80507, Avg tpr: 0.73346, Avg fpr: 0.03743, total FA: 292

Testing server on iccad2012
[Step=  50] | Loss=0.39423 | acc=0.6915 | tpr=0.9469 | fpr=0.3131 | 3498.2 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.39624 | acc=0.6904 | tpr=0.9510 | fpr=0.3145 | 6517.9 samples/s | 25.5 steps/s
[Step= 150] | Loss=0.39923 | acc=0.6899 | tpr=0.9568 | fpr=0.3150 | 6401.6 samples/s | 25.0 steps/s
[Step= 200] | Loss=0.40037 | acc=0.6887 | tpr=0.9574 | fpr=0.3162 | 6404.6 samples/s | 25.0 steps/s
[Step= 250] | Loss=0.40149 | acc=0.6878 | tpr=0.9581 | fpr=0.3171 | 6616.8 samples/s | 25.8 steps/s
[Step= 300] | Loss=0.40339 | acc=0.6867 | tpr=0.9571 | fpr=0.3183 | 6687.0 samples/s | 26.1 steps/s
[Step= 350] | Loss=0.40298 | acc=0.6872 | tpr=0.9568 | fpr=0.3177 | 6448.9 samples/s | 25.2 steps/s
[Step= 400] | Loss=0.40479 | acc=0.6859 | tpr=0.9562 | fpr=0.3190 | 6482.5 samples/s | 25.3 steps/s
[Step= 450] | Loss=0.40565 | acc=0.6854 | tpr=0.9557 | fpr=0.3195 | 6591.3 samples/s | 25.7 steps/s
[Step= 500] | Loss=0.40546 | acc=0.6854 | tpr=0.9568 | fpr=0.3195 | 6525.8 samples/s | 25.5 steps/s
[Step= 550] | Loss=0.40491 | acc=0.6853 | tpr=0.9566 | fpr=0.3196 | 12513.7 samples/s | 48.9 steps/s
Avg test loss: 0.40501, Avg test acc: 0.68523, Avg tpr: 0.95642, Avg fpr: 0.31969, total FA: 44389

server round 8/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 4.7] | Loss=0.16731 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.314 | 3522.8 samples/s | 55.0 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.07775 | Reg=0.00151 | acc=0.9688 | FP-Norm=1.166 | FP-Norm(final)=2.303 | 3367.8 samples/s | 52.6 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.06925 | Reg=0.00193 | acc=0.9531 | FP-Norm=1.349 | FP-Norm(final)=2.305 | 3675.6 samples/s | 57.4 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.06505 | Reg=0.00222 | acc=0.9688 | FP-Norm=1.459 | FP-Norm(final)=2.310 | 3712.7 samples/s | 58.0 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.06141 | Reg=0.00253 | acc=1.0000 | FP-Norm=1.557 | FP-Norm(final)=2.315 | 3688.5 samples/s | 57.6 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.06024 | Reg=0.00281 | acc=0.9062 | FP-Norm=1.643 | FP-Norm(final)=2.317 | 3625.3 samples/s | 56.6 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.05912 | Reg=0.00307 | acc=0.9375 | FP-Norm=1.718 | FP-Norm(final)=2.317 | 3670.7 samples/s | 57.4 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.05859 | Reg=0.00331 | acc=0.9688 | FP-Norm=1.784 | FP-Norm(final)=2.318 | 3693.5 samples/s | 57.7 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.05749 | Reg=0.00355 | acc=0.9688 | FP-Norm=1.845 | FP-Norm(final)=2.318 | 3706.4 samples/s | 57.9 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.05628 | Reg=0.00377 | acc=0.9844 | FP-Norm=1.902 | FP-Norm(final)=2.319 | 3695.2 samples/s | 57.7 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.05631 | Reg=0.00399 | acc=0.9219 | FP-Norm=1.956 | FP-Norm(final)=2.319 | 4427.0 samples/s | 69.2 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.05503 | Reg=0.00420 | acc=0.9844 | FP-Norm=2.008 | FP-Norm(final)=2.320 | 1544.4 samples/s | 24.1 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.05332 | Reg=0.00440 | acc=0.9844 | FP-Norm=2.054 | FP-Norm(final)=2.321 | 3705.1 samples/s | 57.9 steps/s
[Step=3050 Epoch= 5.9] | Loss=0.05260 | Reg=0.00457 | acc=0.9844 | FP-Norm=2.094 | FP-Norm(final)=2.323 | 3674.6 samples/s | 57.4 steps/s
[Step=3100 Epoch= 6.0] | Loss=0.05157 | Reg=0.00474 | acc=0.9375 | FP-Norm=2.132 | FP-Norm(final)=2.324 | 3664.8 samples/s | 57.3 steps/s
[Step=3150 Epoch= 6.1] | Loss=0.05133 | Reg=0.00491 | acc=0.9531 | FP-Norm=2.169 | FP-Norm(final)=2.325 | 3608.5 samples/s | 56.4 steps/s
[Step=3200 Epoch= 6.2] | Loss=0.05049 | Reg=0.00507 | acc=0.9844 | FP-Norm=2.204 | FP-Norm(final)=2.325 | 3730.5 samples/s | 58.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step3200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=12.3] | Loss=0.23046 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.316 | 3569.7 samples/s | 55.8 steps/s
[Step=3250 Epoch=12.5] | Loss=0.03067 | Reg=0.00685 | acc=1.0000 | FP-Norm=2.492 | FP-Norm(final)=2.275 | 3174.6 samples/s | 49.6 steps/s
[Step=3300 Epoch=12.7] | Loss=0.01811 | Reg=0.00731 | acc=1.0000 | FP-Norm=2.639 | FP-Norm(final)=2.270 | 3518.8 samples/s | 55.0 steps/s
[Step=3350 Epoch=12.9] | Loss=0.01352 | Reg=0.00702 | acc=0.9844 | FP-Norm=2.604 | FP-Norm(final)=2.274 | 3521.2 samples/s | 55.0 steps/s
[Step=3400 Epoch=13.1] | Loss=0.01179 | Reg=0.00684 | acc=1.0000 | FP-Norm=2.582 | FP-Norm(final)=2.277 | 3514.0 samples/s | 54.9 steps/s
[Step=3450 Epoch=13.3] | Loss=0.01083 | Reg=0.00678 | acc=1.0000 | FP-Norm=2.577 | FP-Norm(final)=2.279 | 4362.1 samples/s | 68.2 steps/s
[Step=3500 Epoch=13.5] | Loss=0.00926 | Reg=0.00675 | acc=1.0000 | FP-Norm=2.575 | FP-Norm(final)=2.282 | 1543.2 samples/s | 24.1 steps/s
[Step=3550 Epoch=13.7] | Loss=0.00800 | Reg=0.00664 | acc=1.0000 | FP-Norm=2.556 | FP-Norm(final)=2.286 | 3474.0 samples/s | 54.3 steps/s
[Step=3600 Epoch=13.9] | Loss=0.00703 | Reg=0.00648 | acc=1.0000 | FP-Norm=2.526 | FP-Norm(final)=2.290 | 3512.5 samples/s | 54.9 steps/s
[Step=3650 Epoch=14.1] | Loss=0.00627 | Reg=0.00629 | acc=1.0000 | FP-Norm=2.489 | FP-Norm(final)=2.294 | 3480.6 samples/s | 54.4 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00565 | Reg=0.00610 | acc=1.0000 | FP-Norm=2.449 | FP-Norm(final)=2.298 | 3942.7 samples/s | 61.6 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00515 | Reg=0.00590 | acc=1.0000 | FP-Norm=2.406 | FP-Norm(final)=2.301 | 1611.0 samples/s | 25.2 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00473 | Reg=0.00570 | acc=1.0000 | FP-Norm=2.362 | FP-Norm(final)=2.304 | 3505.8 samples/s | 54.8 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00437 | Reg=0.00551 | acc=1.0000 | FP-Norm=2.319 | FP-Norm(final)=2.307 | 3517.2 samples/s | 55.0 steps/s
[Step=3900 Epoch=15.0] | Loss=0.00406 | Reg=0.00533 | acc=1.0000 | FP-Norm=2.276 | FP-Norm(final)=2.309 | 3508.8 samples/s | 54.8 steps/s
[Step=3950 Epoch=15.2] | Loss=0.00380 | Reg=0.00515 | acc=1.0000 | FP-Norm=2.233 | FP-Norm(final)=2.312 | 3583.5 samples/s | 56.0 steps/s
[Step=4000 Epoch=15.4] | Loss=0.00357 | Reg=0.00499 | acc=1.0000 | FP-Norm=2.192 | FP-Norm(final)=2.314 | 1654.3 samples/s | 25.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26639 | acc=0.7691 | tpr=0.6755 | fpr=0.0278 | 3484.6 samples/s | 13.6 steps/s
Avg test loss: 0.27179, Avg test acc: 0.76364, Avg tpr: 0.67011, Avg fpr: 0.03064, total FA: 239

Testing server on iccad2012
[Step=  50] | Loss=0.31505 | acc=0.7637 | tpr=0.9602 | fpr=0.2399 | 3488.7 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.31899 | acc=0.7607 | tpr=0.9616 | fpr=0.2431 | 6318.1 samples/s | 24.7 steps/s
[Step= 150] | Loss=0.32247 | acc=0.7589 | tpr=0.9625 | fpr=0.2448 | 6527.1 samples/s | 25.5 steps/s
[Step= 200] | Loss=0.32342 | acc=0.7574 | tpr=0.9617 | fpr=0.2464 | 6558.7 samples/s | 25.6 steps/s
[Step= 250] | Loss=0.32463 | acc=0.7559 | tpr=0.9607 | fpr=0.2478 | 6372.9 samples/s | 24.9 steps/s
[Step= 300] | Loss=0.32651 | acc=0.7550 | tpr=0.9593 | fpr=0.2488 | 6678.3 samples/s | 26.1 steps/s
[Step= 350] | Loss=0.32645 | acc=0.7552 | tpr=0.9574 | fpr=0.2485 | 6629.5 samples/s | 25.9 steps/s
[Step= 400] | Loss=0.32805 | acc=0.7538 | tpr=0.9546 | fpr=0.2498 | 6527.8 samples/s | 25.5 steps/s
[Step= 450] | Loss=0.32883 | acc=0.7534 | tpr=0.9523 | fpr=0.2502 | 6555.7 samples/s | 25.6 steps/s
[Step= 500] | Loss=0.32856 | acc=0.7535 | tpr=0.9524 | fpr=0.2501 | 6514.7 samples/s | 25.4 steps/s
[Step= 550] | Loss=0.32813 | acc=0.7533 | tpr=0.9522 | fpr=0.2503 | 12062.3 samples/s | 47.1 steps/s
Avg test loss: 0.32815, Avg test acc: 0.75326, Avg tpr: 0.95206, Avg fpr: 0.25035, total FA: 34761

server round 9/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.26496 | Reg=0.00000 | acc=0.7656 | FP-Norm=0.000 | FP-Norm(final)=2.324 | 3523.1 samples/s | 55.0 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.06322 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.204 | FP-Norm(final)=2.317 | 3563.9 samples/s | 55.7 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.05675 | Reg=0.00192 | acc=0.9062 | FP-Norm=1.353 | FP-Norm(final)=2.319 | 3623.5 samples/s | 56.6 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.05618 | Reg=0.00215 | acc=0.9844 | FP-Norm=1.440 | FP-Norm(final)=2.320 | 3652.3 samples/s | 57.1 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.05561 | Reg=0.00236 | acc=0.9375 | FP-Norm=1.512 | FP-Norm(final)=2.321 | 3618.0 samples/s | 56.5 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.05399 | Reg=0.00258 | acc=0.9688 | FP-Norm=1.582 | FP-Norm(final)=2.322 | 3655.0 samples/s | 57.1 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.05318 | Reg=0.00280 | acc=0.9844 | FP-Norm=1.648 | FP-Norm(final)=2.322 | 3630.5 samples/s | 56.7 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.05336 | Reg=0.00302 | acc=0.9844 | FP-Norm=1.710 | FP-Norm(final)=2.322 | 3654.4 samples/s | 57.1 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.05271 | Reg=0.00324 | acc=0.9219 | FP-Norm=1.768 | FP-Norm(final)=2.321 | 3620.4 samples/s | 56.6 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.05250 | Reg=0.00343 | acc=0.9531 | FP-Norm=1.821 | FP-Norm(final)=2.320 | 3648.5 samples/s | 57.0 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.05200 | Reg=0.00362 | acc=0.9688 | FP-Norm=1.868 | FP-Norm(final)=2.319 | 4384.0 samples/s | 68.5 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.05058 | Reg=0.00379 | acc=0.9688 | FP-Norm=1.913 | FP-Norm(final)=2.319 | 1606.0 samples/s | 25.1 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.04915 | Reg=0.00396 | acc=1.0000 | FP-Norm=1.953 | FP-Norm(final)=2.320 | 3675.6 samples/s | 57.4 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.04789 | Reg=0.00411 | acc=0.9844 | FP-Norm=1.990 | FP-Norm(final)=2.321 | 3679.6 samples/s | 57.5 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.04695 | Reg=0.00424 | acc=0.9531 | FP-Norm=2.023 | FP-Norm(final)=2.322 | 3676.7 samples/s | 57.4 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.04667 | Reg=0.00438 | acc=0.9688 | FP-Norm=2.056 | FP-Norm(final)=2.323 | 3683.0 samples/s | 57.5 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.04613 | Reg=0.00452 | acc=0.9688 | FP-Norm=2.087 | FP-Norm(final)=2.323 | 3661.1 samples/s | 57.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step4800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=15.4] | Loss=0.14764 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.327 | 3304.4 samples/s | 51.6 steps/s
[Step=4050 Epoch=15.6] | Loss=0.02725 | Reg=0.00564 | acc=0.9844 | FP-Norm=2.258 | FP-Norm(final)=2.303 | 3322.7 samples/s | 51.9 steps/s
[Step=4100 Epoch=15.8] | Loss=0.01780 | Reg=0.00667 | acc=1.0000 | FP-Norm=2.516 | FP-Norm(final)=2.294 | 3527.7 samples/s | 55.1 steps/s
[Step=4150 Epoch=16.0] | Loss=0.01336 | Reg=0.00675 | acc=1.0000 | FP-Norm=2.553 | FP-Norm(final)=2.297 | 3502.2 samples/s | 54.7 steps/s
[Step=4200 Epoch=16.2] | Loss=0.01125 | Reg=0.00665 | acc=1.0000 | FP-Norm=2.544 | FP-Norm(final)=2.300 | 3497.0 samples/s | 54.6 steps/s
[Step=4250 Epoch=16.4] | Loss=0.00944 | Reg=0.00654 | acc=1.0000 | FP-Norm=2.531 | FP-Norm(final)=2.305 | 4388.1 samples/s | 68.6 steps/s
[Step=4300 Epoch=16.6] | Loss=0.00899 | Reg=0.00654 | acc=1.0000 | FP-Norm=2.534 | FP-Norm(final)=2.306 | 1530.0 samples/s | 23.9 steps/s
[Step=4350 Epoch=16.7] | Loss=0.00794 | Reg=0.00651 | acc=1.0000 | FP-Norm=2.533 | FP-Norm(final)=2.309 | 3438.6 samples/s | 53.7 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00709 | Reg=0.00645 | acc=1.0000 | FP-Norm=2.522 | FP-Norm(final)=2.312 | 3499.7 samples/s | 54.7 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00643 | Reg=0.00638 | acc=1.0000 | FP-Norm=2.510 | FP-Norm(final)=2.315 | 3508.9 samples/s | 54.8 steps/s
[Step=4500 Epoch=17.3] | Loss=0.00582 | Reg=0.00628 | acc=1.0000 | FP-Norm=2.491 | FP-Norm(final)=2.318 | 3912.8 samples/s | 61.1 steps/s
[Step=4550 Epoch=17.5] | Loss=0.00531 | Reg=0.00615 | acc=1.0000 | FP-Norm=2.465 | FP-Norm(final)=2.321 | 1582.8 samples/s | 24.7 steps/s
[Step=4600 Epoch=17.7] | Loss=0.00488 | Reg=0.00600 | acc=1.0000 | FP-Norm=2.434 | FP-Norm(final)=2.324 | 3519.7 samples/s | 55.0 steps/s
[Step=4650 Epoch=17.9] | Loss=0.00451 | Reg=0.00584 | acc=1.0000 | FP-Norm=2.399 | FP-Norm(final)=2.327 | 3537.4 samples/s | 55.3 steps/s
[Step=4700 Epoch=18.1] | Loss=0.00419 | Reg=0.00568 | acc=1.0000 | FP-Norm=2.362 | FP-Norm(final)=2.330 | 3482.5 samples/s | 54.4 steps/s
[Step=4750 Epoch=18.3] | Loss=0.00392 | Reg=0.00552 | acc=1.0000 | FP-Norm=2.325 | FP-Norm(final)=2.332 | 3567.4 samples/s | 55.7 steps/s
[Step=4800 Epoch=18.5] | Loss=0.00368 | Reg=0.00536 | acc=1.0000 | FP-Norm=2.287 | FP-Norm(final)=2.334 | 1665.2 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24952 | acc=0.7866 | tpr=0.7071 | fpr=0.0406 | 3532.0 samples/s | 13.8 steps/s
Avg test loss: 0.25278, Avg test acc: 0.78420, Avg tpr: 0.70426, Avg fpr: 0.03999, total FA: 312

Testing server on iccad2012
[Step=  50] | Loss=0.33497 | acc=0.7530 | tpr=0.9646 | fpr=0.2508 | 3505.1 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.33995 | acc=0.7504 | tpr=0.9595 | fpr=0.2536 | 6626.0 samples/s | 25.9 steps/s
[Step= 150] | Loss=0.34380 | acc=0.7490 | tpr=0.9611 | fpr=0.2549 | 6468.4 samples/s | 25.3 steps/s
[Step= 200] | Loss=0.34503 | acc=0.7492 | tpr=0.9628 | fpr=0.2547 | 6606.7 samples/s | 25.8 steps/s
[Step= 250] | Loss=0.34605 | acc=0.7482 | tpr=0.9633 | fpr=0.2557 | 6652.1 samples/s | 26.0 steps/s
[Step= 300] | Loss=0.34773 | acc=0.7479 | tpr=0.9644 | fpr=0.2561 | 6665.7 samples/s | 26.0 steps/s
[Step= 350] | Loss=0.34753 | acc=0.7488 | tpr=0.9643 | fpr=0.2551 | 6558.9 samples/s | 25.6 steps/s
[Step= 400] | Loss=0.34897 | acc=0.7475 | tpr=0.9623 | fpr=0.2564 | 6435.2 samples/s | 25.1 steps/s
[Step= 450] | Loss=0.34996 | acc=0.7470 | tpr=0.9601 | fpr=0.2568 | 6681.8 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.34981 | acc=0.7468 | tpr=0.9612 | fpr=0.2570 | 6370.3 samples/s | 24.9 steps/s
[Step= 550] | Loss=0.34952 | acc=0.7466 | tpr=0.9606 | fpr=0.2572 | 12064.4 samples/s | 47.1 steps/s
Avg test loss: 0.34952, Avg test acc: 0.74660, Avg tpr: 0.96038, Avg fpr: 0.25729, total FA: 35724

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch= 6.2] | Loss=0.12762 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.335 | 3330.5 samples/s | 52.0 steps/s
[Step=3250 Epoch= 6.3] | Loss=0.05884 | Reg=0.00072 | acc=0.9844 | FP-Norm=0.810 | FP-Norm(final)=2.331 | 3222.7 samples/s | 50.4 steps/s
[Step=3300 Epoch= 6.4] | Loss=0.05142 | Reg=0.00087 | acc=0.9688 | FP-Norm=0.909 | FP-Norm(final)=2.335 | 3253.7 samples/s | 50.8 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.04827 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.959 | FP-Norm(final)=2.340 | 3490.2 samples/s | 54.5 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.04389 | Reg=0.00103 | acc=1.0000 | FP-Norm=1.000 | FP-Norm(final)=2.344 | 3515.3 samples/s | 54.9 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.04263 | Reg=0.00110 | acc=0.9688 | FP-Norm=1.036 | FP-Norm(final)=2.349 | 3440.0 samples/s | 53.7 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.04240 | Reg=0.00117 | acc=0.9688 | FP-Norm=1.068 | FP-Norm(final)=2.351 | 3499.3 samples/s | 54.7 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.04149 | Reg=0.00124 | acc=0.9688 | FP-Norm=1.097 | FP-Norm(final)=2.353 | 3581.3 samples/s | 56.0 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.04008 | Reg=0.00129 | acc=0.9844 | FP-Norm=1.122 | FP-Norm(final)=2.355 | 3579.8 samples/s | 55.9 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.03945 | Reg=0.00134 | acc=0.9531 | FP-Norm=1.146 | FP-Norm(final)=2.358 | 3556.4 samples/s | 55.6 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.03933 | Reg=0.00140 | acc=0.9844 | FP-Norm=1.170 | FP-Norm(final)=2.360 | 4278.4 samples/s | 66.8 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.03805 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.195 | FP-Norm(final)=2.363 | 1479.9 samples/s | 23.1 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.03692 | Reg=0.00152 | acc=0.9844 | FP-Norm=1.217 | FP-Norm(final)=2.365 | 3456.5 samples/s | 54.0 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.03600 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.237 | FP-Norm(final)=2.368 | 3419.4 samples/s | 53.4 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.03545 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.256 | FP-Norm(final)=2.371 | 3489.2 samples/s | 54.5 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.03451 | Reg=0.00167 | acc=0.9844 | FP-Norm=1.274 | FP-Norm(final)=2.374 | 3746.4 samples/s | 58.5 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.03386 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.292 | FP-Norm(final)=2.376 | 3726.2 samples/s | 58.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch= 9.4] | Loss=0.22574 | Reg=0.00000 | acc=0.7812 | FP-Norm=0.000 | FP-Norm(final)=2.334 | 3629.7 samples/s | 56.7 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.06163 | Reg=0.00074 | acc=0.9844 | FP-Norm=0.818 | FP-Norm(final)=2.328 | 3433.5 samples/s | 53.6 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.04960 | Reg=0.00090 | acc=0.9531 | FP-Norm=0.923 | FP-Norm(final)=2.333 | 3702.1 samples/s | 57.8 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.04562 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.968 | FP-Norm(final)=2.337 | 3573.1 samples/s | 55.8 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.04239 | Reg=0.00102 | acc=0.9219 | FP-Norm=0.998 | FP-Norm(final)=2.341 | 3601.2 samples/s | 56.3 steps/s
[Step=5050 Epoch= 9.9] | Loss=0.04152 | Reg=0.00108 | acc=0.9219 | FP-Norm=1.025 | FP-Norm(final)=2.345 | 3776.1 samples/s | 59.0 steps/s
[Step=5100 Epoch=10.0] | Loss=0.04087 | Reg=0.00114 | acc=0.9531 | FP-Norm=1.054 | FP-Norm(final)=2.347 | 3760.3 samples/s | 58.8 steps/s
[Step=5150 Epoch=10.1] | Loss=0.03952 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.085 | FP-Norm(final)=2.349 | 3753.1 samples/s | 58.6 steps/s
[Step=5200 Epoch=10.2] | Loss=0.03858 | Reg=0.00126 | acc=0.9688 | FP-Norm=1.111 | FP-Norm(final)=2.352 | 3719.7 samples/s | 58.1 steps/s
[Step=5250 Epoch=10.3] | Loss=0.03788 | Reg=0.00132 | acc=0.9688 | FP-Norm=1.135 | FP-Norm(final)=2.354 | 3582.9 samples/s | 56.0 steps/s
[Step=5300 Epoch=10.4] | Loss=0.03754 | Reg=0.00138 | acc=1.0000 | FP-Norm=1.159 | FP-Norm(final)=2.357 | 4199.7 samples/s | 65.6 steps/s
[Step=5350 Epoch=10.5] | Loss=0.03611 | Reg=0.00143 | acc=0.9688 | FP-Norm=1.182 | FP-Norm(final)=2.359 | 1533.6 samples/s | 24.0 steps/s
[Step=5400 Epoch=10.6] | Loss=0.03453 | Reg=0.00148 | acc=0.9844 | FP-Norm=1.202 | FP-Norm(final)=2.362 | 3594.3 samples/s | 56.2 steps/s
[Step=5450 Epoch=10.7] | Loss=0.03370 | Reg=0.00153 | acc=0.9688 | FP-Norm=1.220 | FP-Norm(final)=2.365 | 3639.7 samples/s | 56.9 steps/s
[Step=5500 Epoch=10.8] | Loss=0.03284 | Reg=0.00157 | acc=0.9844 | FP-Norm=1.238 | FP-Norm(final)=2.368 | 3660.0 samples/s | 57.2 steps/s
[Step=5550 Epoch=10.9] | Loss=0.03240 | Reg=0.00162 | acc=0.9688 | FP-Norm=1.256 | FP-Norm(final)=2.371 | 3656.5 samples/s | 57.1 steps/s
[Step=5600 Epoch=10.9] | Loss=0.03157 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.275 | FP-Norm(final)=2.373 | 3653.9 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27266 | acc=0.7758 | tpr=0.6981 | fpr=0.0555 | 3501.9 samples/s | 13.7 steps/s
Avg test loss: 0.27752, Avg test acc: 0.77346, Avg tpr: 0.69383, Avg fpr: 0.05140, total FA: 401

Testing server on iccad2012
[Step=  50] | Loss=0.34208 | acc=0.7777 | tpr=0.9735 | fpr=0.2259 | 3401.7 samples/s | 13.3 steps/s
[Step= 100] | Loss=0.34818 | acc=0.7758 | tpr=0.9680 | fpr=0.2278 | 5871.6 samples/s | 22.9 steps/s
[Step= 150] | Loss=0.35315 | acc=0.7753 | tpr=0.9741 | fpr=0.2283 | 6615.4 samples/s | 25.8 steps/s
[Step= 200] | Loss=0.35459 | acc=0.7754 | tpr=0.9760 | fpr=0.2283 | 6415.4 samples/s | 25.1 steps/s
[Step= 250] | Loss=0.35625 | acc=0.7744 | tpr=0.9747 | fpr=0.2293 | 6102.4 samples/s | 23.8 steps/s
[Step= 300] | Loss=0.35835 | acc=0.7734 | tpr=0.9745 | fpr=0.2303 | 6633.6 samples/s | 25.9 steps/s
[Step= 350] | Loss=0.35846 | acc=0.7741 | tpr=0.9756 | fpr=0.2295 | 6881.2 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.35997 | acc=0.7731 | tpr=0.9748 | fpr=0.2306 | 5989.0 samples/s | 23.4 steps/s
[Step= 450] | Loss=0.36161 | acc=0.7725 | tpr=0.9737 | fpr=0.2311 | 6550.4 samples/s | 25.6 steps/s
[Step= 500] | Loss=0.36149 | acc=0.7722 | tpr=0.9740 | fpr=0.2314 | 6928.9 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.36087 | acc=0.7721 | tpr=0.9741 | fpr=0.2316 | 12198.4 samples/s | 47.7 steps/s
Avg test loss: 0.36079, Avg test acc: 0.77202, Avg tpr: 0.97385, Avg fpr: 0.23165, total FA: 32164

server round 11/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=10.9] | Loss=0.19266 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.382 | 3454.5 samples/s | 54.0 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05564 | Reg=0.00091 | acc=0.9375 | FP-Norm=0.907 | FP-Norm(final)=2.377 | 3641.4 samples/s | 56.9 steps/s
[Step=5700 Epoch=11.1] | Loss=0.04535 | Reg=0.00108 | acc=0.9531 | FP-Norm=1.011 | FP-Norm(final)=2.381 | 3720.7 samples/s | 58.1 steps/s
[Step=5750 Epoch=11.2] | Loss=0.04278 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.056 | FP-Norm(final)=2.386 | 3698.3 samples/s | 57.8 steps/s
[Step=5800 Epoch=11.3] | Loss=0.04048 | Reg=0.00122 | acc=0.9531 | FP-Norm=1.090 | FP-Norm(final)=2.389 | 3743.3 samples/s | 58.5 steps/s
[Step=5850 Epoch=11.4] | Loss=0.04080 | Reg=0.00128 | acc=0.9844 | FP-Norm=1.118 | FP-Norm(final)=2.392 | 3709.9 samples/s | 58.0 steps/s
[Step=5900 Epoch=11.5] | Loss=0.03958 | Reg=0.00134 | acc=0.9688 | FP-Norm=1.146 | FP-Norm(final)=2.395 | 3722.8 samples/s | 58.2 steps/s
[Step=5950 Epoch=11.6] | Loss=0.03872 | Reg=0.00140 | acc=0.9531 | FP-Norm=1.170 | FP-Norm(final)=2.397 | 3728.3 samples/s | 58.3 steps/s
[Step=6000 Epoch=11.7] | Loss=0.03800 | Reg=0.00146 | acc=0.9688 | FP-Norm=1.195 | FP-Norm(final)=2.399 | 3717.9 samples/s | 58.1 steps/s
[Step=6050 Epoch=11.8] | Loss=0.03756 | Reg=0.00152 | acc=0.9688 | FP-Norm=1.220 | FP-Norm(final)=2.401 | 3712.3 samples/s | 58.0 steps/s
[Step=6100 Epoch=11.9] | Loss=0.03744 | Reg=0.00157 | acc=0.9844 | FP-Norm=1.241 | FP-Norm(final)=2.403 | 4417.5 samples/s | 69.0 steps/s
[Step=6150 Epoch=12.0] | Loss=0.03583 | Reg=0.00162 | acc=0.9844 | FP-Norm=1.262 | FP-Norm(final)=2.405 | 1606.4 samples/s | 25.1 steps/s
[Step=6200 Epoch=12.1] | Loss=0.03475 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.280 | FP-Norm(final)=2.408 | 3729.9 samples/s | 58.3 steps/s
[Step=6250 Epoch=12.2] | Loss=0.03389 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.297 | FP-Norm(final)=2.411 | 3726.9 samples/s | 58.2 steps/s
[Step=6300 Epoch=12.3] | Loss=0.03304 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.315 | FP-Norm(final)=2.414 | 3567.8 samples/s | 55.7 steps/s
[Step=6350 Epoch=12.4] | Loss=0.03256 | Reg=0.00182 | acc=0.9844 | FP-Norm=1.333 | FP-Norm(final)=2.417 | 3719.0 samples/s | 58.1 steps/s
[Step=6400 Epoch=12.5] | Loss=0.03228 | Reg=0.00187 | acc=0.9844 | FP-Norm=1.351 | FP-Norm(final)=2.420 | 3768.0 samples/s | 58.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step6400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=12.3] | Loss=0.14129 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.383 | 3518.4 samples/s | 55.0 steps/s
[Step=3250 Epoch=12.5] | Loss=0.01227 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.172 | FP-Norm(final)=2.381 | 3239.6 samples/s | 50.6 steps/s
[Step=3300 Epoch=12.6] | Loss=0.00750 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.324 | FP-Norm(final)=2.380 | 3476.6 samples/s | 54.3 steps/s
[Step=3350 Epoch=12.8] | Loss=0.00519 | Reg=0.00190 | acc=1.0000 | FP-Norm=1.354 | FP-Norm(final)=2.380 | 3482.3 samples/s | 54.4 steps/s
[Step=3400 Epoch=13.0] | Loss=0.00395 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.348 | FP-Norm(final)=2.382 | 3482.4 samples/s | 54.4 steps/s
[Step=3450 Epoch=13.2] | Loss=0.00319 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.331 | FP-Norm(final)=2.383 | 4376.5 samples/s | 68.4 steps/s
[Step=3500 Epoch=13.4] | Loss=0.00267 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.309 | FP-Norm(final)=2.385 | 1569.9 samples/s | 24.5 steps/s
[Step=3550 Epoch=13.6] | Loss=0.00230 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.286 | FP-Norm(final)=2.386 | 3503.3 samples/s | 54.7 steps/s
[Step=3600 Epoch=13.8] | Loss=0.00203 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.263 | FP-Norm(final)=2.387 | 3545.7 samples/s | 55.4 steps/s
[Step=3650 Epoch=14.0] | Loss=0.00181 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.242 | FP-Norm(final)=2.389 | 3541.4 samples/s | 55.3 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00164 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.221 | FP-Norm(final)=2.390 | 3879.8 samples/s | 60.6 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00150 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.200 | FP-Norm(final)=2.391 | 1656.4 samples/s | 25.9 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00138 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.180 | FP-Norm(final)=2.392 | 3490.9 samples/s | 54.5 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00127 | Reg=0.00139 | acc=1.0000 | FP-Norm=1.160 | FP-Norm(final)=2.393 | 3527.4 samples/s | 55.1 steps/s
[Step=3900 Epoch=14.9] | Loss=0.00119 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.142 | FP-Norm(final)=2.394 | 3565.2 samples/s | 55.7 steps/s
[Step=3950 Epoch=15.1] | Loss=0.00111 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.124 | FP-Norm(final)=2.395 | 3518.1 samples/s | 55.0 steps/s
[Step=4000 Epoch=15.3] | Loss=0.00105 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.107 | FP-Norm(final)=2.396 | 1648.6 samples/s | 25.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22362 | acc=0.8156 | tpr=0.7564 | fpr=0.0557 | 3555.0 samples/s | 13.9 steps/s
Avg test loss: 0.22638, Avg test acc: 0.81509, Avg tpr: 0.75514, Avg fpr: 0.05307, total FA: 414

Testing server on iccad2012
[Step=  50] | Loss=0.42330 | acc=0.7245 | tpr=0.9779 | fpr=0.2801 | 3560.7 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.42959 | acc=0.7237 | tpr=0.9744 | fpr=0.2810 | 6710.2 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.43558 | acc=0.7215 | tpr=0.9769 | fpr=0.2832 | 6645.4 samples/s | 26.0 steps/s
[Step= 200] | Loss=0.43740 | acc=0.7216 | tpr=0.9781 | fpr=0.2831 | 6853.1 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.43916 | acc=0.7204 | tpr=0.9764 | fpr=0.2843 | 6383.4 samples/s | 24.9 steps/s
[Step= 300] | Loss=0.44176 | acc=0.7198 | tpr=0.9767 | fpr=0.2849 | 6616.1 samples/s | 25.8 steps/s
[Step= 350] | Loss=0.44188 | acc=0.7200 | tpr=0.9781 | fpr=0.2847 | 6963.1 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.44372 | acc=0.7188 | tpr=0.9776 | fpr=0.2859 | 6376.2 samples/s | 24.9 steps/s
[Step= 450] | Loss=0.44548 | acc=0.7183 | tpr=0.9766 | fpr=0.2864 | 6812.1 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.44540 | acc=0.7181 | tpr=0.9767 | fpr=0.2866 | 6659.8 samples/s | 26.0 steps/s
[Step= 550] | Loss=0.44488 | acc=0.7177 | tpr=0.9765 | fpr=0.2870 | 12075.5 samples/s | 47.2 steps/s
Avg test loss: 0.44481, Avg test acc: 0.71771, Avg tpr: 0.97623, Avg fpr: 0.28699, total FA: 39848

server round 12/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch= 7.8] | Loss=0.28974 | Reg=0.00000 | acc=0.7812 | FP-Norm=0.000 | FP-Norm(final)=2.411 | 3264.8 samples/s | 51.0 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.06192 | Reg=0.00079 | acc=0.9844 | FP-Norm=0.847 | FP-Norm(final)=2.396 | 3728.6 samples/s | 58.3 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.05066 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.941 | FP-Norm(final)=2.400 | 3617.8 samples/s | 56.5 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.04435 | Reg=0.00099 | acc=0.9531 | FP-Norm=0.980 | FP-Norm(final)=2.405 | 3710.2 samples/s | 58.0 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.04178 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.016 | FP-Norm(final)=2.410 | 3695.6 samples/s | 57.7 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.04099 | Reg=0.00114 | acc=0.9844 | FP-Norm=1.052 | FP-Norm(final)=2.413 | 3726.8 samples/s | 58.2 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.04059 | Reg=0.00121 | acc=0.9688 | FP-Norm=1.087 | FP-Norm(final)=2.415 | 3646.2 samples/s | 57.0 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.03988 | Reg=0.00129 | acc=0.9531 | FP-Norm=1.119 | FP-Norm(final)=2.417 | 3719.7 samples/s | 58.1 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.03869 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.145 | FP-Norm(final)=2.419 | 3673.8 samples/s | 57.4 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.03803 | Reg=0.00139 | acc=0.9531 | FP-Norm=1.167 | FP-Norm(final)=2.422 | 3689.9 samples/s | 57.7 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.03740 | Reg=0.00145 | acc=0.9531 | FP-Norm=1.190 | FP-Norm(final)=2.424 | 4368.6 samples/s | 68.3 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.03637 | Reg=0.00150 | acc=0.9531 | FP-Norm=1.211 | FP-Norm(final)=2.426 | 1570.8 samples/s | 24.5 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.03530 | Reg=0.00155 | acc=0.9844 | FP-Norm=1.230 | FP-Norm(final)=2.428 | 3651.4 samples/s | 57.1 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.03422 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.248 | FP-Norm(final)=2.430 | 3654.2 samples/s | 57.1 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.03363 | Reg=0.00164 | acc=0.9688 | FP-Norm=1.265 | FP-Norm(final)=2.433 | 3623.9 samples/s | 56.6 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.03323 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.282 | FP-Norm(final)=2.435 | 3645.5 samples/s | 57.0 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.03282 | Reg=0.00173 | acc=0.9688 | FP-Norm=1.299 | FP-Norm(final)=2.437 | 3643.6 samples/s | 56.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step4800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=15.3] | Loss=0.10309 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.413 | 3442.8 samples/s | 53.8 steps/s
[Step=4050 Epoch=15.5] | Loss=0.01640 | Reg=0.00270 | acc=0.9844 | FP-Norm=1.558 | FP-Norm(final)=2.409 | 3204.2 samples/s | 50.1 steps/s
[Step=4100 Epoch=15.7] | Loss=0.00905 | Reg=0.00306 | acc=1.0000 | FP-Norm=1.704 | FP-Norm(final)=2.408 | 3500.5 samples/s | 54.7 steps/s
[Step=4150 Epoch=15.9] | Loss=0.00615 | Reg=0.00301 | acc=1.0000 | FP-Norm=1.702 | FP-Norm(final)=2.410 | 3469.7 samples/s | 54.2 steps/s
[Step=4200 Epoch=16.1] | Loss=0.00470 | Reg=0.00288 | acc=1.0000 | FP-Norm=1.673 | FP-Norm(final)=2.412 | 3407.6 samples/s | 53.2 steps/s
[Step=4250 Epoch=16.3] | Loss=0.00409 | Reg=0.00276 | acc=1.0000 | FP-Norm=1.640 | FP-Norm(final)=2.413 | 4237.1 samples/s | 66.2 steps/s
[Step=4300 Epoch=16.5] | Loss=0.00344 | Reg=0.00265 | acc=1.0000 | FP-Norm=1.607 | FP-Norm(final)=2.415 | 1524.5 samples/s | 23.8 steps/s
[Step=4350 Epoch=16.7] | Loss=0.00296 | Reg=0.00254 | acc=1.0000 | FP-Norm=1.575 | FP-Norm(final)=2.416 | 3426.0 samples/s | 53.5 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00260 | Reg=0.00244 | acc=1.0000 | FP-Norm=1.542 | FP-Norm(final)=2.418 | 3438.3 samples/s | 53.7 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00231 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.511 | FP-Norm(final)=2.419 | 3414.1 samples/s | 53.3 steps/s
[Step=4500 Epoch=17.2] | Loss=0.00209 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.480 | FP-Norm(final)=2.420 | 3789.4 samples/s | 59.2 steps/s
[Step=4550 Epoch=17.4] | Loss=0.00190 | Reg=0.00217 | acc=1.0000 | FP-Norm=1.450 | FP-Norm(final)=2.421 | 1629.0 samples/s | 25.5 steps/s
[Step=4600 Epoch=17.6] | Loss=0.00175 | Reg=0.00209 | acc=1.0000 | FP-Norm=1.422 | FP-Norm(final)=2.422 | 3528.9 samples/s | 55.1 steps/s
[Step=4650 Epoch=17.8] | Loss=0.00162 | Reg=0.00202 | acc=1.0000 | FP-Norm=1.395 | FP-Norm(final)=2.423 | 3524.3 samples/s | 55.1 steps/s
[Step=4700 Epoch=18.0] | Loss=0.00151 | Reg=0.00195 | acc=1.0000 | FP-Norm=1.369 | FP-Norm(final)=2.424 | 3508.3 samples/s | 54.8 steps/s
[Step=4750 Epoch=18.2] | Loss=0.00141 | Reg=0.00189 | acc=1.0000 | FP-Norm=1.344 | FP-Norm(final)=2.425 | 3475.8 samples/s | 54.3 steps/s
[Step=4800 Epoch=18.4] | Loss=0.00132 | Reg=0.00183 | acc=1.0000 | FP-Norm=1.321 | FP-Norm(final)=2.425 | 1686.0 samples/s | 26.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23868 | acc=0.8027 | tpr=0.7356 | fpr=0.0518 | 3436.5 samples/s | 13.4 steps/s
Avg test loss: 0.24241, Avg test acc: 0.80171, Avg tpr: 0.73463, Avg fpr: 0.05076, total FA: 396

Testing server on iccad2012
[Step=  50] | Loss=0.38179 | acc=0.7519 | tpr=0.9779 | fpr=0.2522 | 3375.1 samples/s | 13.2 steps/s
[Step= 100] | Loss=0.38851 | acc=0.7504 | tpr=0.9787 | fpr=0.2538 | 6214.6 samples/s | 24.3 steps/s
[Step= 150] | Loss=0.39441 | acc=0.7490 | tpr=0.9813 | fpr=0.2553 | 6389.2 samples/s | 25.0 steps/s
[Step= 200] | Loss=0.39630 | acc=0.7489 | tpr=0.9814 | fpr=0.2554 | 6383.3 samples/s | 24.9 steps/s
[Step= 250] | Loss=0.39751 | acc=0.7482 | tpr=0.9799 | fpr=0.2560 | 6650.9 samples/s | 26.0 steps/s
[Step= 300] | Loss=0.40010 | acc=0.7470 | tpr=0.9796 | fpr=0.2572 | 6415.8 samples/s | 25.1 steps/s
[Step= 350] | Loss=0.40021 | acc=0.7475 | tpr=0.9806 | fpr=0.2567 | 6531.0 samples/s | 25.5 steps/s
[Step= 400] | Loss=0.40178 | acc=0.7466 | tpr=0.9809 | fpr=0.2577 | 6483.3 samples/s | 25.3 steps/s
[Step= 450] | Loss=0.40320 | acc=0.7464 | tpr=0.9800 | fpr=0.2578 | 6500.4 samples/s | 25.4 steps/s
[Step= 500] | Loss=0.40312 | acc=0.7463 | tpr=0.9793 | fpr=0.2579 | 6210.1 samples/s | 24.3 steps/s
[Step= 550] | Loss=0.40247 | acc=0.7462 | tpr=0.9797 | fpr=0.2581 | 12060.9 samples/s | 47.1 steps/s
Avg test loss: 0.40239, Avg test acc: 0.74617, Avg tpr: 0.97940, Avg fpr: 0.25807, total FA: 35832

server round 13/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch= 9.4] | Loss=0.16577 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.431 | 3224.4 samples/s | 50.4 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.05389 | Reg=0.00093 | acc=0.9688 | FP-Norm=0.916 | FP-Norm(final)=2.421 | 3574.3 samples/s | 55.8 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.04247 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.002 | FP-Norm(final)=2.423 | 3695.9 samples/s | 57.7 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.03963 | Reg=0.00109 | acc=0.9688 | FP-Norm=1.027 | FP-Norm(final)=2.426 | 3573.7 samples/s | 55.8 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.04059 | Reg=0.00115 | acc=0.9531 | FP-Norm=1.060 | FP-Norm(final)=2.429 | 3606.3 samples/s | 56.3 steps/s
[Step=5050 Epoch= 9.8] | Loss=0.03874 | Reg=0.00123 | acc=0.9844 | FP-Norm=1.094 | FP-Norm(final)=2.430 | 3632.2 samples/s | 56.8 steps/s
[Step=5100 Epoch= 9.9] | Loss=0.03894 | Reg=0.00128 | acc=0.9844 | FP-Norm=1.120 | FP-Norm(final)=2.431 | 3443.3 samples/s | 53.8 steps/s
[Step=5150 Epoch=10.0] | Loss=0.03825 | Reg=0.00134 | acc=0.9844 | FP-Norm=1.146 | FP-Norm(final)=2.433 | 3276.0 samples/s | 51.2 steps/s
[Step=5200 Epoch=10.1] | Loss=0.03762 | Reg=0.00140 | acc=0.9688 | FP-Norm=1.171 | FP-Norm(final)=2.434 | 3286.6 samples/s | 51.4 steps/s
[Step=5250 Epoch=10.2] | Loss=0.03706 | Reg=0.00145 | acc=0.9844 | FP-Norm=1.191 | FP-Norm(final)=2.435 | 3585.8 samples/s | 56.0 steps/s
[Step=5300 Epoch=10.3] | Loss=0.03670 | Reg=0.00150 | acc=0.9688 | FP-Norm=1.212 | FP-Norm(final)=2.437 | 4336.2 samples/s | 67.8 steps/s
[Step=5350 Epoch=10.4] | Loss=0.03504 | Reg=0.00154 | acc=0.9219 | FP-Norm=1.230 | FP-Norm(final)=2.439 | 1580.5 samples/s | 24.7 steps/s
[Step=5400 Epoch=10.5] | Loss=0.03413 | Reg=0.00159 | acc=0.9688 | FP-Norm=1.247 | FP-Norm(final)=2.442 | 3724.9 samples/s | 58.2 steps/s
[Step=5450 Epoch=10.6] | Loss=0.03296 | Reg=0.00163 | acc=0.9844 | FP-Norm=1.263 | FP-Norm(final)=2.445 | 3779.7 samples/s | 59.1 steps/s
[Step=5500 Epoch=10.7] | Loss=0.03243 | Reg=0.00167 | acc=0.9531 | FP-Norm=1.279 | FP-Norm(final)=2.448 | 3761.6 samples/s | 58.8 steps/s
[Step=5550 Epoch=10.8] | Loss=0.03188 | Reg=0.00171 | acc=0.9688 | FP-Norm=1.294 | FP-Norm(final)=2.451 | 3769.6 samples/s | 58.9 steps/s
[Step=5600 Epoch=10.9] | Loss=0.03130 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.308 | FP-Norm(final)=2.453 | 3765.6 samples/s | 58.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step5600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=18.4] | Loss=0.11968 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.432 | 3213.1 samples/s | 50.2 steps/s
[Step=4850 Epoch=18.6] | Loss=0.00935 | Reg=0.00183 | acc=1.0000 | FP-Norm=1.283 | FP-Norm(final)=2.431 | 3463.3 samples/s | 54.1 steps/s
[Step=4900 Epoch=18.8] | Loss=0.00570 | Reg=0.00216 | acc=1.0000 | FP-Norm=1.429 | FP-Norm(final)=2.434 | 3590.1 samples/s | 56.1 steps/s
[Step=4950 Epoch=19.0] | Loss=0.00432 | Reg=0.00223 | acc=1.0000 | FP-Norm=1.465 | FP-Norm(final)=2.437 | 3590.2 samples/s | 56.1 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00376 | Reg=0.00224 | acc=1.0000 | FP-Norm=1.478 | FP-Norm(final)=2.440 | 3586.1 samples/s | 56.0 steps/s
[Step=5050 Epoch=19.3] | Loss=0.00317 | Reg=0.00227 | acc=1.0000 | FP-Norm=1.492 | FP-Norm(final)=2.443 | 4398.1 samples/s | 68.7 steps/s
[Step=5100 Epoch=19.5] | Loss=0.00265 | Reg=0.00226 | acc=1.0000 | FP-Norm=1.490 | FP-Norm(final)=2.445 | 1595.0 samples/s | 24.9 steps/s
[Step=5150 Epoch=19.7] | Loss=0.00228 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.478 | FP-Norm(final)=2.447 | 3530.5 samples/s | 55.2 steps/s
[Step=5200 Epoch=19.9] | Loss=0.00201 | Reg=0.00217 | acc=1.0000 | FP-Norm=1.461 | FP-Norm(final)=2.448 | 3506.2 samples/s | 54.8 steps/s
[Step=5250 Epoch=20.1] | Loss=0.00179 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.441 | FP-Norm(final)=2.449 | 3248.2 samples/s | 50.8 steps/s
[Step=5300 Epoch=20.3] | Loss=0.00162 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.420 | FP-Norm(final)=2.450 | 3846.2 samples/s | 60.1 steps/s
[Step=5350 Epoch=20.5] | Loss=0.00147 | Reg=0.00199 | acc=1.0000 | FP-Norm=1.399 | FP-Norm(final)=2.451 | 1632.0 samples/s | 25.5 steps/s
[Step=5400 Epoch=20.7] | Loss=0.00135 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.377 | FP-Norm(final)=2.452 | 3504.3 samples/s | 54.8 steps/s
[Step=5450 Epoch=20.9] | Loss=0.00125 | Reg=0.00188 | acc=1.0000 | FP-Norm=1.355 | FP-Norm(final)=2.453 | 3530.4 samples/s | 55.2 steps/s
[Step=5500 Epoch=21.1] | Loss=0.00116 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.334 | FP-Norm(final)=2.453 | 3620.7 samples/s | 56.6 steps/s
[Step=5550 Epoch=21.3] | Loss=0.00109 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.313 | FP-Norm(final)=2.454 | 3540.8 samples/s | 55.3 steps/s
[Step=5600 Epoch=21.5] | Loss=0.00102 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.293 | FP-Norm(final)=2.455 | 1702.3 samples/s | 26.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21490 | acc=0.8246 | tpr=0.7687 | fpr=0.0540 | 3661.0 samples/s | 14.3 steps/s
Avg test loss: 0.21821, Avg test acc: 0.82499, Avg tpr: 0.76913, Avg fpr: 0.05217, total FA: 407

Testing server on iccad2012
[Step=  50] | Loss=0.44613 | acc=0.7146 | tpr=0.9779 | fpr=0.2901 | 3626.9 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.45272 | acc=0.7130 | tpr=0.9744 | fpr=0.2918 | 6879.6 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.45880 | acc=0.7109 | tpr=0.9741 | fpr=0.2940 | 6858.4 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.46019 | acc=0.7105 | tpr=0.9760 | fpr=0.2944 | 6640.9 samples/s | 25.9 steps/s
[Step= 250] | Loss=0.46188 | acc=0.7090 | tpr=0.9755 | fpr=0.2959 | 6792.9 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.46468 | acc=0.7079 | tpr=0.9760 | fpr=0.2969 | 7020.1 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.46450 | acc=0.7084 | tpr=0.9775 | fpr=0.2965 | 6965.1 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.46616 | acc=0.7072 | tpr=0.9781 | fpr=0.2977 | 6839.3 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.46786 | acc=0.7068 | tpr=0.9781 | fpr=0.2981 | 6835.7 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.46800 | acc=0.7065 | tpr=0.9780 | fpr=0.2984 | 6880.8 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.46727 | acc=0.7063 | tpr=0.9781 | fpr=0.2986 | 12303.3 samples/s | 48.1 steps/s
Avg test loss: 0.46720, Avg test acc: 0.70629, Avg tpr: 0.97781, Avg fpr: 0.29864, total FA: 41466

server round 14/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=21.5] | Loss=0.15484 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.445 | 3428.0 samples/s | 53.6 steps/s
[Step=5650 Epoch=21.6] | Loss=0.01353 | Reg=0.00269 | acc=0.9844 | FP-Norm=1.561 | FP-Norm(final)=2.442 | 3423.5 samples/s | 53.5 steps/s
[Step=5700 Epoch=21.8] | Loss=0.00932 | Reg=0.00325 | acc=1.0000 | FP-Norm=1.757 | FP-Norm(final)=2.436 | 3571.2 samples/s | 55.8 steps/s
[Step=5750 Epoch=22.0] | Loss=0.00709 | Reg=0.00336 | acc=1.0000 | FP-Norm=1.801 | FP-Norm(final)=2.435 | 3628.8 samples/s | 56.7 steps/s
[Step=5800 Epoch=22.2] | Loss=0.00557 | Reg=0.00331 | acc=1.0000 | FP-Norm=1.795 | FP-Norm(final)=2.437 | 3530.2 samples/s | 55.2 steps/s
[Step=5850 Epoch=22.4] | Loss=0.00454 | Reg=0.00321 | acc=1.0000 | FP-Norm=1.772 | FP-Norm(final)=2.439 | 4308.4 samples/s | 67.3 steps/s
[Step=5900 Epoch=22.6] | Loss=0.00381 | Reg=0.00310 | acc=1.0000 | FP-Norm=1.744 | FP-Norm(final)=2.441 | 1593.8 samples/s | 24.9 steps/s
[Step=5950 Epoch=22.8] | Loss=0.00327 | Reg=0.00299 | acc=1.0000 | FP-Norm=1.713 | FP-Norm(final)=2.443 | 3589.3 samples/s | 56.1 steps/s
[Step=6000 Epoch=23.0] | Loss=0.00287 | Reg=0.00288 | acc=1.0000 | FP-Norm=1.681 | FP-Norm(final)=2.445 | 3560.7 samples/s | 55.6 steps/s
[Step=6050 Epoch=23.2] | Loss=0.00256 | Reg=0.00278 | acc=1.0000 | FP-Norm=1.649 | FP-Norm(final)=2.446 | 3591.0 samples/s | 56.1 steps/s
[Step=6100 Epoch=23.4] | Loss=0.00231 | Reg=0.00268 | acc=1.0000 | FP-Norm=1.619 | FP-Norm(final)=2.447 | 3954.8 samples/s | 61.8 steps/s
[Step=6150 Epoch=23.6] | Loss=0.00210 | Reg=0.00259 | acc=1.0000 | FP-Norm=1.590 | FP-Norm(final)=2.449 | 1644.8 samples/s | 25.7 steps/s
[Step=6200 Epoch=23.8] | Loss=0.00193 | Reg=0.00251 | acc=1.0000 | FP-Norm=1.562 | FP-Norm(final)=2.450 | 3571.5 samples/s | 55.8 steps/s
[Step=6250 Epoch=23.9] | Loss=0.00179 | Reg=0.00243 | acc=1.0000 | FP-Norm=1.534 | FP-Norm(final)=2.451 | 3587.2 samples/s | 56.1 steps/s
[Step=6300 Epoch=24.1] | Loss=0.00166 | Reg=0.00235 | acc=1.0000 | FP-Norm=1.508 | FP-Norm(final)=2.452 | 3558.9 samples/s | 55.6 steps/s
[Step=6350 Epoch=24.3] | Loss=0.00155 | Reg=0.00228 | acc=1.0000 | FP-Norm=1.483 | FP-Norm(final)=2.453 | 3483.8 samples/s | 54.4 steps/s
[Step=6400 Epoch=24.5] | Loss=0.00146 | Reg=0.00221 | acc=1.0000 | FP-Norm=1.458 | FP-Norm(final)=2.454 | 1730.8 samples/s | 27.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step6400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=18.5] | Loss=0.30313 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.444 | 3410.7 samples/s | 53.3 steps/s
[Step=4850 Epoch=18.7] | Loss=0.01708 | Reg=0.00226 | acc=1.0000 | FP-Norm=1.437 | FP-Norm(final)=2.433 | 3557.9 samples/s | 55.6 steps/s
[Step=4900 Epoch=18.9] | Loss=0.00922 | Reg=0.00248 | acc=1.0000 | FP-Norm=1.541 | FP-Norm(final)=2.432 | 3607.4 samples/s | 56.4 steps/s
[Step=4950 Epoch=19.1] | Loss=0.00633 | Reg=0.00242 | acc=1.0000 | FP-Norm=1.532 | FP-Norm(final)=2.435 | 3583.5 samples/s | 56.0 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00488 | Reg=0.00231 | acc=0.9844 | FP-Norm=1.502 | FP-Norm(final)=2.437 | 3601.3 samples/s | 56.3 steps/s
[Step=5050 Epoch=19.4] | Loss=0.00396 | Reg=0.00221 | acc=1.0000 | FP-Norm=1.471 | FP-Norm(final)=2.440 | 4453.8 samples/s | 69.6 steps/s
[Step=5100 Epoch=19.6] | Loss=0.00331 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.439 | FP-Norm(final)=2.442 | 1577.2 samples/s | 24.6 steps/s
[Step=5150 Epoch=19.8] | Loss=0.00285 | Reg=0.00203 | acc=1.0000 | FP-Norm=1.407 | FP-Norm(final)=2.443 | 3555.6 samples/s | 55.6 steps/s
[Step=5200 Epoch=20.0] | Loss=0.00250 | Reg=0.00194 | acc=1.0000 | FP-Norm=1.376 | FP-Norm(final)=2.445 | 3573.5 samples/s | 55.8 steps/s
[Step=5250 Epoch=20.2] | Loss=0.00223 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.347 | FP-Norm(final)=2.446 | 3612.1 samples/s | 56.4 steps/s
[Step=5300 Epoch=20.4] | Loss=0.00202 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.319 | FP-Norm(final)=2.447 | 3926.7 samples/s | 61.4 steps/s
[Step=5350 Epoch=20.6] | Loss=0.00184 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.292 | FP-Norm(final)=2.449 | 1645.2 samples/s | 25.7 steps/s
[Step=5400 Epoch=20.8] | Loss=0.00169 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.267 | FP-Norm(final)=2.450 | 3613.5 samples/s | 56.5 steps/s
[Step=5450 Epoch=21.0] | Loss=0.00157 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.243 | FP-Norm(final)=2.451 | 3535.6 samples/s | 55.2 steps/s
[Step=5500 Epoch=21.2] | Loss=0.00146 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.221 | FP-Norm(final)=2.452 | 3552.5 samples/s | 55.5 steps/s
[Step=5550 Epoch=21.4] | Loss=0.00137 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.199 | FP-Norm(final)=2.453 | 3554.4 samples/s | 55.5 steps/s
[Step=5600 Epoch=21.6] | Loss=0.00129 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.179 | FP-Norm(final)=2.453 | 1707.1 samples/s | 26.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25250 | acc=0.8002 | tpr=0.7216 | fpr=0.0290 | 3642.1 samples/s | 14.2 steps/s
Avg test loss: 0.25690, Avg test acc: 0.79666, Avg tpr: 0.71703, Avg fpr: 0.02820, total FA: 220

Testing server on iccad2012
[Step=  50] | Loss=0.37487 | acc=0.7629 | tpr=0.9646 | fpr=0.2407 | 3685.4 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.38139 | acc=0.7609 | tpr=0.9638 | fpr=0.2428 | 6747.7 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.38665 | acc=0.7597 | tpr=0.9654 | fpr=0.2441 | 6783.1 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.38822 | acc=0.7592 | tpr=0.9661 | fpr=0.2445 | 7015.0 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.38960 | acc=0.7582 | tpr=0.9659 | fpr=0.2456 | 6845.7 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.39228 | acc=0.7568 | tpr=0.9673 | fpr=0.2471 | 7157.4 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.39245 | acc=0.7574 | tpr=0.9674 | fpr=0.2464 | 6625.1 samples/s | 25.9 steps/s
[Step= 400] | Loss=0.39408 | acc=0.7563 | tpr=0.9677 | fpr=0.2476 | 6793.7 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.39579 | acc=0.7558 | tpr=0.9664 | fpr=0.2480 | 6898.3 samples/s | 26.9 steps/s
[Step= 500] | Loss=0.39579 | acc=0.7557 | tpr=0.9670 | fpr=0.2481 | 6911.4 samples/s | 27.0 steps/s
[Step= 550] | Loss=0.39486 | acc=0.7553 | tpr=0.9674 | fpr=0.2485 | 12539.6 samples/s | 49.0 steps/s
Avg test loss: 0.39478, Avg test acc: 0.75531, Avg tpr: 0.96712, Avg fpr: 0.24854, total FA: 34509

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=10.9] | Loss=0.28247 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.469 | 3331.2 samples/s | 52.1 steps/s
[Step=5650 Epoch=11.0] | Loss=0.04856 | Reg=0.00095 | acc=0.9844 | FP-Norm=0.936 | FP-Norm(final)=2.460 | 3608.6 samples/s | 56.4 steps/s
[Step=5700 Epoch=11.1] | Loss=0.04361 | Reg=0.00107 | acc=0.9531 | FP-Norm=1.014 | FP-Norm(final)=2.460 | 3625.4 samples/s | 56.6 steps/s
[Step=5750 Epoch=11.2] | Loss=0.03842 | Reg=0.00112 | acc=0.9844 | FP-Norm=1.042 | FP-Norm(final)=2.461 | 3694.4 samples/s | 57.7 steps/s
[Step=5800 Epoch=11.3] | Loss=0.03593 | Reg=0.00115 | acc=0.9688 | FP-Norm=1.063 | FP-Norm(final)=2.465 | 3697.0 samples/s | 57.8 steps/s
[Step=5850 Epoch=11.4] | Loss=0.03508 | Reg=0.00120 | acc=0.9844 | FP-Norm=1.083 | FP-Norm(final)=2.468 | 3580.0 samples/s | 55.9 steps/s
[Step=5900 Epoch=11.5] | Loss=0.03439 | Reg=0.00123 | acc=0.9688 | FP-Norm=1.102 | FP-Norm(final)=2.469 | 3604.1 samples/s | 56.3 steps/s
[Step=5950 Epoch=11.6] | Loss=0.03381 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.122 | FP-Norm(final)=2.471 | 3602.4 samples/s | 56.3 steps/s
[Step=6000 Epoch=11.7] | Loss=0.03411 | Reg=0.00132 | acc=0.9531 | FP-Norm=1.142 | FP-Norm(final)=2.472 | 3615.8 samples/s | 56.5 steps/s
[Step=6050 Epoch=11.8] | Loss=0.03323 | Reg=0.00137 | acc=0.9688 | FP-Norm=1.163 | FP-Norm(final)=2.474 | 3656.4 samples/s | 57.1 steps/s
[Step=6100 Epoch=11.9] | Loss=0.03346 | Reg=0.00142 | acc=0.9844 | FP-Norm=1.182 | FP-Norm(final)=2.475 | 4307.7 samples/s | 67.3 steps/s
[Step=6150 Epoch=12.0] | Loss=0.03251 | Reg=0.00147 | acc=0.9844 | FP-Norm=1.202 | FP-Norm(final)=2.476 | 1546.0 samples/s | 24.2 steps/s
[Step=6200 Epoch=12.1] | Loss=0.03173 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.220 | FP-Norm(final)=2.478 | 3679.4 samples/s | 57.5 steps/s
[Step=6250 Epoch=12.2] | Loss=0.03065 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.237 | FP-Norm(final)=2.480 | 3769.8 samples/s | 58.9 steps/s
[Step=6300 Epoch=12.3] | Loss=0.02991 | Reg=0.00159 | acc=0.9531 | FP-Norm=1.251 | FP-Norm(final)=2.482 | 3724.6 samples/s | 58.2 steps/s
[Step=6350 Epoch=12.4] | Loss=0.02929 | Reg=0.00163 | acc=0.9688 | FP-Norm=1.265 | FP-Norm(final)=2.484 | 3778.7 samples/s | 59.0 steps/s
[Step=6400 Epoch=12.5] | Loss=0.02879 | Reg=0.00166 | acc=0.9688 | FP-Norm=1.278 | FP-Norm(final)=2.487 | 3775.1 samples/s | 59.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step6400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=12.5] | Loss=0.18908 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.470 | 3735.1 samples/s | 58.4 steps/s
[Step=6450 Epoch=12.6] | Loss=0.04490 | Reg=0.00083 | acc=0.9844 | FP-Norm=0.870 | FP-Norm(final)=2.459 | 3565.4 samples/s | 55.7 steps/s
[Step=6500 Epoch=12.7] | Loss=0.03826 | Reg=0.00096 | acc=0.9844 | FP-Norm=0.956 | FP-Norm(final)=2.461 | 3584.6 samples/s | 56.0 steps/s
[Step=6550 Epoch=12.8] | Loss=0.03557 | Reg=0.00103 | acc=0.9844 | FP-Norm=1.000 | FP-Norm(final)=2.463 | 3707.8 samples/s | 57.9 steps/s
[Step=6600 Epoch=12.9] | Loss=0.03466 | Reg=0.00109 | acc=0.9844 | FP-Norm=1.032 | FP-Norm(final)=2.465 | 3692.9 samples/s | 57.7 steps/s
[Step=6650 Epoch=13.0] | Loss=0.03335 | Reg=0.00115 | acc=0.9844 | FP-Norm=1.059 | FP-Norm(final)=2.467 | 3680.3 samples/s | 57.5 steps/s
[Step=6700 Epoch=13.1] | Loss=0.03245 | Reg=0.00119 | acc=1.0000 | FP-Norm=1.080 | FP-Norm(final)=2.469 | 3673.9 samples/s | 57.4 steps/s
[Step=6750 Epoch=13.2] | Loss=0.03144 | Reg=0.00122 | acc=0.9844 | FP-Norm=1.096 | FP-Norm(final)=2.472 | 3693.5 samples/s | 57.7 steps/s
[Step=6800 Epoch=13.3] | Loss=0.03185 | Reg=0.00126 | acc=0.9844 | FP-Norm=1.114 | FP-Norm(final)=2.473 | 3680.0 samples/s | 57.5 steps/s
[Step=6850 Epoch=13.4] | Loss=0.03120 | Reg=0.00131 | acc=0.9844 | FP-Norm=1.133 | FP-Norm(final)=2.474 | 3719.1 samples/s | 58.1 steps/s
[Step=6900 Epoch=13.5] | Loss=0.03102 | Reg=0.00135 | acc=0.9844 | FP-Norm=1.152 | FP-Norm(final)=2.476 | 4536.8 samples/s | 70.9 steps/s
[Step=6950 Epoch=13.6] | Loss=0.03066 | Reg=0.00139 | acc=1.0000 | FP-Norm=1.170 | FP-Norm(final)=2.477 | 1622.0 samples/s | 25.3 steps/s
[Step=7000 Epoch=13.7] | Loss=0.02988 | Reg=0.00144 | acc=0.9844 | FP-Norm=1.188 | FP-Norm(final)=2.478 | 3661.9 samples/s | 57.2 steps/s
[Step=7050 Epoch=13.8] | Loss=0.02893 | Reg=0.00147 | acc=0.9844 | FP-Norm=1.203 | FP-Norm(final)=2.480 | 3681.1 samples/s | 57.5 steps/s
[Step=7100 Epoch=13.9] | Loss=0.02862 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.218 | FP-Norm(final)=2.482 | 3668.2 samples/s | 57.3 steps/s
[Step=7150 Epoch=14.0] | Loss=0.02810 | Reg=0.00155 | acc=0.9688 | FP-Norm=1.233 | FP-Norm(final)=2.483 | 3695.0 samples/s | 57.7 steps/s
[Step=7200 Epoch=14.1] | Loss=0.02803 | Reg=0.00159 | acc=0.9844 | FP-Norm=1.247 | FP-Norm(final)=2.485 | 3684.4 samples/s | 57.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31731 | acc=0.7563 | tpr=0.6538 | fpr=0.0211 | 3611.5 samples/s | 14.1 steps/s
Avg test loss: 0.32263, Avg test acc: 0.75379, Avg tpr: 0.65186, Avg fpr: 0.02205, total FA: 172

Testing server on iccad2012
[Step=  50] | Loss=0.31037 | acc=0.8104 | tpr=0.9646 | fpr=0.1924 | 3627.4 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.31755 | acc=0.8077 | tpr=0.9595 | fpr=0.1951 | 6865.5 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.32267 | acc=0.8064 | tpr=0.9625 | fpr=0.1965 | 6782.1 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.32409 | acc=0.8059 | tpr=0.9639 | fpr=0.1970 | 6698.3 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.32519 | acc=0.8045 | tpr=0.9651 | fpr=0.1984 | 6862.9 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.32766 | acc=0.8034 | tpr=0.9658 | fpr=0.1996 | 6784.1 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.32781 | acc=0.8039 | tpr=0.9656 | fpr=0.1990 | 6932.1 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.32932 | acc=0.8032 | tpr=0.9655 | fpr=0.1998 | 6574.8 samples/s | 25.7 steps/s
[Step= 450] | Loss=0.33082 | acc=0.8025 | tpr=0.9645 | fpr=0.2005 | 6797.5 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.33083 | acc=0.8026 | tpr=0.9648 | fpr=0.2003 | 6688.2 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.32986 | acc=0.8028 | tpr=0.9638 | fpr=0.2002 | 12538.9 samples/s | 49.0 steps/s
Avg test loss: 0.32976, Avg test acc: 0.80271, Avg tpr: 0.96355, Avg fpr: 0.20021, total FA: 27799

server round 16/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=24.5] | Loss=0.09833 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.489 | 3420.3 samples/s | 53.4 steps/s
[Step=6450 Epoch=24.7] | Loss=0.01207 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.437 | FP-Norm(final)=2.480 | 3515.9 samples/s | 54.9 steps/s
[Step=6500 Epoch=24.9] | Loss=0.00631 | Reg=0.00255 | acc=1.0000 | FP-Norm=1.555 | FP-Norm(final)=2.482 | 3498.2 samples/s | 54.7 steps/s
[Step=6550 Epoch=25.1] | Loss=0.00470 | Reg=0.00251 | acc=1.0000 | FP-Norm=1.556 | FP-Norm(final)=2.485 | 3507.3 samples/s | 54.8 steps/s
[Step=6600 Epoch=25.3] | Loss=0.00356 | Reg=0.00245 | acc=1.0000 | FP-Norm=1.545 | FP-Norm(final)=2.488 | 3457.1 samples/s | 54.0 steps/s
[Step=6650 Epoch=25.5] | Loss=0.00291 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.522 | FP-Norm(final)=2.491 | 4353.8 samples/s | 68.0 steps/s
[Step=6700 Epoch=25.7] | Loss=0.00248 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.497 | FP-Norm(final)=2.494 | 1578.2 samples/s | 24.7 steps/s
[Step=6750 Epoch=25.9] | Loss=0.00213 | Reg=0.00221 | acc=1.0000 | FP-Norm=1.470 | FP-Norm(final)=2.496 | 3488.0 samples/s | 54.5 steps/s
[Step=6800 Epoch=26.1] | Loss=0.00187 | Reg=0.00213 | acc=1.0000 | FP-Norm=1.442 | FP-Norm(final)=2.498 | 3519.6 samples/s | 55.0 steps/s
[Step=6850 Epoch=26.2] | Loss=0.00167 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.415 | FP-Norm(final)=2.499 | 3471.0 samples/s | 54.2 steps/s
[Step=6900 Epoch=26.4] | Loss=0.00151 | Reg=0.00198 | acc=1.0000 | FP-Norm=1.388 | FP-Norm(final)=2.501 | 3854.8 samples/s | 60.2 steps/s
[Step=6950 Epoch=26.6] | Loss=0.00137 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.362 | FP-Norm(final)=2.502 | 1596.4 samples/s | 24.9 steps/s
[Step=7000 Epoch=26.8] | Loss=0.00126 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.337 | FP-Norm(final)=2.503 | 3567.0 samples/s | 55.7 steps/s
[Step=7050 Epoch=27.0] | Loss=0.00117 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.313 | FP-Norm(final)=2.504 | 3514.8 samples/s | 54.9 steps/s
[Step=7100 Epoch=27.2] | Loss=0.00109 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.290 | FP-Norm(final)=2.505 | 3523.8 samples/s | 55.1 steps/s
[Step=7150 Epoch=27.4] | Loss=0.00102 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.268 | FP-Norm(final)=2.506 | 3526.5 samples/s | 55.1 steps/s
[Step=7200 Epoch=27.6] | Loss=0.00096 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.246 | FP-Norm(final)=2.507 | 1704.3 samples/s | 26.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step7200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=21.6] | Loss=0.14172 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.488 | 3470.0 samples/s | 54.2 steps/s
[Step=5650 Epoch=21.7] | Loss=0.01043 | Reg=0.00228 | acc=0.9844 | FP-Norm=1.437 | FP-Norm(final)=2.489 | 3462.3 samples/s | 54.1 steps/s
[Step=5700 Epoch=21.9] | Loss=0.00834 | Reg=0.00257 | acc=1.0000 | FP-Norm=1.564 | FP-Norm(final)=2.489 | 3524.8 samples/s | 55.1 steps/s
[Step=5750 Epoch=22.1] | Loss=0.00596 | Reg=0.00267 | acc=1.0000 | FP-Norm=1.607 | FP-Norm(final)=2.489 | 3545.5 samples/s | 55.4 steps/s
[Step=5800 Epoch=22.3] | Loss=0.00452 | Reg=0.00263 | acc=1.0000 | FP-Norm=1.602 | FP-Norm(final)=2.490 | 3589.9 samples/s | 56.1 steps/s
[Step=5850 Epoch=22.5] | Loss=0.00383 | Reg=0.00256 | acc=1.0000 | FP-Norm=1.583 | FP-Norm(final)=2.491 | 4413.9 samples/s | 69.0 steps/s
[Step=5900 Epoch=22.7] | Loss=0.00321 | Reg=0.00248 | acc=1.0000 | FP-Norm=1.560 | FP-Norm(final)=2.492 | 1569.3 samples/s | 24.5 steps/s
[Step=5950 Epoch=22.9] | Loss=0.00276 | Reg=0.00240 | acc=1.0000 | FP-Norm=1.534 | FP-Norm(final)=2.493 | 3468.0 samples/s | 54.2 steps/s
[Step=6000 Epoch=23.1] | Loss=0.00243 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.507 | FP-Norm(final)=2.494 | 3523.9 samples/s | 55.1 steps/s
[Step=6050 Epoch=23.3] | Loss=0.00217 | Reg=0.00224 | acc=1.0000 | FP-Norm=1.481 | FP-Norm(final)=2.495 | 3534.1 samples/s | 55.2 steps/s
[Step=6100 Epoch=23.5] | Loss=0.00196 | Reg=0.00216 | acc=1.0000 | FP-Norm=1.455 | FP-Norm(final)=2.496 | 3841.9 samples/s | 60.0 steps/s
[Step=6150 Epoch=23.7] | Loss=0.00178 | Reg=0.00209 | acc=1.0000 | FP-Norm=1.430 | FP-Norm(final)=2.497 | 1629.8 samples/s | 25.5 steps/s
[Step=6200 Epoch=23.9] | Loss=0.00164 | Reg=0.00203 | acc=1.0000 | FP-Norm=1.406 | FP-Norm(final)=2.498 | 3599.6 samples/s | 56.2 steps/s
[Step=6250 Epoch=24.1] | Loss=0.00152 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.383 | FP-Norm(final)=2.499 | 3608.0 samples/s | 56.4 steps/s
[Step=6300 Epoch=24.3] | Loss=0.00141 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.360 | FP-Norm(final)=2.500 | 3570.1 samples/s | 55.8 steps/s
[Step=6350 Epoch=24.4] | Loss=0.00132 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.338 | FP-Norm(final)=2.500 | 3625.2 samples/s | 56.6 steps/s
[Step=6400 Epoch=24.6] | Loss=0.00124 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.318 | FP-Norm(final)=2.501 | 1691.2 samples/s | 26.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31401 | acc=0.7630 | tpr=0.6637 | fpr=0.0213 | 3613.5 samples/s | 14.1 steps/s
Avg test loss: 0.31928, Avg test acc: 0.76044, Avg tpr: 0.66165, Avg fpr: 0.02230, total FA: 174

Testing server on iccad2012
[Step=  50] | Loss=0.32947 | acc=0.7948 | tpr=0.9690 | fpr=0.2083 | 3607.0 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.33619 | acc=0.7943 | tpr=0.9595 | fpr=0.2088 | 6491.9 samples/s | 25.4 steps/s
[Step= 150] | Loss=0.34115 | acc=0.7927 | tpr=0.9611 | fpr=0.2104 | 6556.4 samples/s | 25.6 steps/s
[Step= 200] | Loss=0.34235 | acc=0.7927 | tpr=0.9596 | fpr=0.2103 | 6666.9 samples/s | 26.0 steps/s
[Step= 250] | Loss=0.34348 | acc=0.7916 | tpr=0.9607 | fpr=0.2115 | 6509.3 samples/s | 25.4 steps/s
[Step= 300] | Loss=0.34550 | acc=0.7907 | tpr=0.9622 | fpr=0.2125 | 6734.5 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.34571 | acc=0.7914 | tpr=0.9631 | fpr=0.2117 | 6391.0 samples/s | 25.0 steps/s
[Step= 400] | Loss=0.34730 | acc=0.7908 | tpr=0.9644 | fpr=0.2124 | 6447.8 samples/s | 25.2 steps/s
[Step= 450] | Loss=0.34898 | acc=0.7903 | tpr=0.9635 | fpr=0.2129 | 6624.8 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.34902 | acc=0.7902 | tpr=0.9630 | fpr=0.2129 | 6817.0 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.34811 | acc=0.7902 | tpr=0.9618 | fpr=0.2129 | 11043.2 samples/s | 43.1 steps/s
Avg test loss: 0.34801, Avg test acc: 0.79020, Avg tpr: 0.96157, Avg fpr: 0.21292, total FA: 29563

server round 17/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=14.1] | Loss=0.32603 | Reg=0.00000 | acc=0.7500 | FP-Norm=0.000 | FP-Norm(final)=2.511 | 3729.8 samples/s | 58.3 steps/s
[Step=7250 Epoch=14.2] | Loss=0.04991 | Reg=0.00093 | acc=0.9844 | FP-Norm=0.924 | FP-Norm(final)=2.497 | 3256.1 samples/s | 50.9 steps/s
[Step=7300 Epoch=14.3] | Loss=0.03975 | Reg=0.00105 | acc=0.9844 | FP-Norm=1.003 | FP-Norm(final)=2.497 | 3579.3 samples/s | 55.9 steps/s
[Step=7350 Epoch=14.4] | Loss=0.03447 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.026 | FP-Norm(final)=2.500 | 3510.5 samples/s | 54.9 steps/s
[Step=7400 Epoch=14.5] | Loss=0.03226 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.049 | FP-Norm(final)=2.503 | 3234.1 samples/s | 50.5 steps/s
[Step=7450 Epoch=14.6] | Loss=0.03134 | Reg=0.00116 | acc=0.9844 | FP-Norm=1.069 | FP-Norm(final)=2.505 | 3475.5 samples/s | 54.3 steps/s
[Step=7500 Epoch=14.7] | Loss=0.03061 | Reg=0.00120 | acc=0.9688 | FP-Norm=1.085 | FP-Norm(final)=2.507 | 3451.9 samples/s | 53.9 steps/s
[Step=7550 Epoch=14.8] | Loss=0.03031 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.099 | FP-Norm(final)=2.508 | 3452.6 samples/s | 53.9 steps/s
[Step=7600 Epoch=14.9] | Loss=0.03026 | Reg=0.00126 | acc=0.9844 | FP-Norm=1.116 | FP-Norm(final)=2.509 | 3384.4 samples/s | 52.9 steps/s
[Step=7650 Epoch=15.0] | Loss=0.02973 | Reg=0.00130 | acc=0.9844 | FP-Norm=1.132 | FP-Norm(final)=2.510 | 3454.1 samples/s | 54.0 steps/s
[Step=7700 Epoch=15.1] | Loss=0.02967 | Reg=0.00134 | acc=0.9688 | FP-Norm=1.148 | FP-Norm(final)=2.510 | 4266.5 samples/s | 66.7 steps/s
[Step=7750 Epoch=15.2] | Loss=0.02888 | Reg=0.00138 | acc=0.9688 | FP-Norm=1.166 | FP-Norm(final)=2.511 | 1556.5 samples/s | 24.3 steps/s
[Step=7800 Epoch=15.2] | Loss=0.02806 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.181 | FP-Norm(final)=2.512 | 3631.2 samples/s | 56.7 steps/s
[Step=7850 Epoch=15.3] | Loss=0.02765 | Reg=0.00145 | acc=0.9844 | FP-Norm=1.195 | FP-Norm(final)=2.514 | 3529.9 samples/s | 55.2 steps/s
[Step=7900 Epoch=15.4] | Loss=0.02685 | Reg=0.00148 | acc=0.9844 | FP-Norm=1.207 | FP-Norm(final)=2.515 | 3504.6 samples/s | 54.8 steps/s
[Step=7950 Epoch=15.5] | Loss=0.02636 | Reg=0.00151 | acc=0.9844 | FP-Norm=1.219 | FP-Norm(final)=2.516 | 3480.2 samples/s | 54.4 steps/s
[Step=8000 Epoch=15.6] | Loss=0.02610 | Reg=0.00154 | acc=0.9844 | FP-Norm=1.230 | FP-Norm(final)=2.518 | 3456.1 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step8000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=27.6] | Loss=0.10074 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.514 | 3297.0 samples/s | 51.5 steps/s
[Step=7250 Epoch=27.8] | Loss=0.01801 | Reg=0.00293 | acc=1.0000 | FP-Norm=1.625 | FP-Norm(final)=2.502 | 3128.0 samples/s | 48.9 steps/s
[Step=7300 Epoch=28.0] | Loss=0.01013 | Reg=0.00340 | acc=1.0000 | FP-Norm=1.795 | FP-Norm(final)=2.497 | 3111.2 samples/s | 48.6 steps/s
[Step=7350 Epoch=28.2] | Loss=0.00736 | Reg=0.00335 | acc=1.0000 | FP-Norm=1.799 | FP-Norm(final)=2.498 | 3276.0 samples/s | 51.2 steps/s
[Step=7400 Epoch=28.4] | Loss=0.00575 | Reg=0.00326 | acc=1.0000 | FP-Norm=1.780 | FP-Norm(final)=2.500 | 3197.3 samples/s | 50.0 steps/s
[Step=7450 Epoch=28.5] | Loss=0.00471 | Reg=0.00314 | acc=1.0000 | FP-Norm=1.751 | FP-Norm(final)=2.502 | 4108.7 samples/s | 64.2 steps/s
[Step=7500 Epoch=28.7] | Loss=0.00394 | Reg=0.00303 | acc=1.0000 | FP-Norm=1.721 | FP-Norm(final)=2.505 | 1497.7 samples/s | 23.4 steps/s
[Step=7550 Epoch=28.9] | Loss=0.00339 | Reg=0.00292 | acc=1.0000 | FP-Norm=1.689 | FP-Norm(final)=2.507 | 3358.3 samples/s | 52.5 steps/s
[Step=7600 Epoch=29.1] | Loss=0.00297 | Reg=0.00281 | acc=1.0000 | FP-Norm=1.657 | FP-Norm(final)=2.509 | 3377.6 samples/s | 52.8 steps/s
[Step=7650 Epoch=29.3] | Loss=0.00264 | Reg=0.00271 | acc=1.0000 | FP-Norm=1.625 | FP-Norm(final)=2.511 | 3338.0 samples/s | 52.2 steps/s
[Step=7700 Epoch=29.5] | Loss=0.00239 | Reg=0.00261 | acc=1.0000 | FP-Norm=1.595 | FP-Norm(final)=2.512 | 3629.2 samples/s | 56.7 steps/s
[Step=7750 Epoch=29.7] | Loss=0.00217 | Reg=0.00252 | acc=1.0000 | FP-Norm=1.565 | FP-Norm(final)=2.514 | 1623.1 samples/s | 25.4 steps/s
[Step=7800 Epoch=29.9] | Loss=0.00200 | Reg=0.00243 | acc=1.0000 | FP-Norm=1.537 | FP-Norm(final)=2.515 | 3379.1 samples/s | 52.8 steps/s
[Step=7850 Epoch=30.1] | Loss=0.00185 | Reg=0.00235 | acc=1.0000 | FP-Norm=1.510 | FP-Norm(final)=2.516 | 3427.1 samples/s | 53.5 steps/s
[Step=7900 Epoch=30.3] | Loss=0.00172 | Reg=0.00228 | acc=1.0000 | FP-Norm=1.483 | FP-Norm(final)=2.517 | 3422.5 samples/s | 53.5 steps/s
[Step=7950 Epoch=30.5] | Loss=0.00160 | Reg=0.00221 | acc=1.0000 | FP-Norm=1.458 | FP-Norm(final)=2.518 | 3404.0 samples/s | 53.2 steps/s
[Step=8000 Epoch=30.7] | Loss=0.00151 | Reg=0.00214 | acc=1.0000 | FP-Norm=1.434 | FP-Norm(final)=2.519 | 1660.9 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33715 | acc=0.7462 | tpr=0.6427 | fpr=0.0292 | 3523.7 samples/s | 13.8 steps/s
Avg test loss: 0.34208, Avg test acc: 0.74485, Avg tpr: 0.64230, Avg fpr: 0.02961, total FA: 231

Testing server on iccad2012
[Step=  50] | Loss=0.29674 | acc=0.8202 | tpr=0.9735 | fpr=0.1826 | 3475.0 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.30318 | acc=0.8196 | tpr=0.9616 | fpr=0.1831 | 6615.1 samples/s | 25.8 steps/s
[Step= 150] | Loss=0.30834 | acc=0.8190 | tpr=0.9654 | fpr=0.1837 | 6926.5 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.30959 | acc=0.8188 | tpr=0.9661 | fpr=0.1838 | 6141.2 samples/s | 24.0 steps/s
[Step= 250] | Loss=0.31032 | acc=0.8179 | tpr=0.9659 | fpr=0.1848 | 6591.8 samples/s | 25.7 steps/s
[Step= 300] | Loss=0.31226 | acc=0.8170 | tpr=0.9673 | fpr=0.1857 | 6465.6 samples/s | 25.3 steps/s
[Step= 350] | Loss=0.31259 | acc=0.8180 | tpr=0.9693 | fpr=0.1848 | 6602.7 samples/s | 25.8 steps/s
[Step= 400] | Loss=0.31428 | acc=0.8173 | tpr=0.9699 | fpr=0.1855 | 6311.8 samples/s | 24.7 steps/s
[Step= 450] | Loss=0.31592 | acc=0.8167 | tpr=0.9703 | fpr=0.1861 | 6581.5 samples/s | 25.7 steps/s
[Step= 500] | Loss=0.31600 | acc=0.8168 | tpr=0.9700 | fpr=0.1860 | 6441.7 samples/s | 25.2 steps/s
[Step= 550] | Loss=0.31514 | acc=0.8170 | tpr=0.9694 | fpr=0.1858 | 12059.5 samples/s | 47.1 steps/s
Avg test loss: 0.31502, Avg test acc: 0.81701, Avg tpr: 0.96910, Avg fpr: 0.18576, total FA: 25792

server round 18/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=15.6] | Loss=0.21366 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.523 | 3495.9 samples/s | 54.6 steps/s
[Step=8050 Epoch=15.7] | Loss=0.04178 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.957 | FP-Norm(final)=2.513 | 3503.2 samples/s | 54.7 steps/s
[Step=8100 Epoch=15.8] | Loss=0.03475 | Reg=0.00110 | acc=0.9844 | FP-Norm=1.024 | FP-Norm(final)=2.516 | 3638.5 samples/s | 56.9 steps/s
[Step=8150 Epoch=15.9] | Loss=0.03098 | Reg=0.00114 | acc=0.9844 | FP-Norm=1.051 | FP-Norm(final)=2.518 | 3685.8 samples/s | 57.6 steps/s
[Step=8200 Epoch=16.0] | Loss=0.03186 | Reg=0.00118 | acc=0.9844 | FP-Norm=1.072 | FP-Norm(final)=2.519 | 3713.7 samples/s | 58.0 steps/s
[Step=8250 Epoch=16.1] | Loss=0.03046 | Reg=0.00121 | acc=0.9688 | FP-Norm=1.089 | FP-Norm(final)=2.520 | 3725.2 samples/s | 58.2 steps/s
[Step=8300 Epoch=16.2] | Loss=0.03028 | Reg=0.00125 | acc=0.9844 | FP-Norm=1.108 | FP-Norm(final)=2.520 | 3686.2 samples/s | 57.6 steps/s
[Step=8350 Epoch=16.3] | Loss=0.03045 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.129 | FP-Norm(final)=2.521 | 3635.9 samples/s | 56.8 steps/s
[Step=8400 Epoch=16.4] | Loss=0.03016 | Reg=0.00134 | acc=0.9844 | FP-Norm=1.150 | FP-Norm(final)=2.521 | 3579.6 samples/s | 55.9 steps/s
[Step=8450 Epoch=16.5] | Loss=0.02963 | Reg=0.00138 | acc=0.9844 | FP-Norm=1.167 | FP-Norm(final)=2.521 | 3639.8 samples/s | 56.9 steps/s
[Step=8500 Epoch=16.6] | Loss=0.02902 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.182 | FP-Norm(final)=2.521 | 4387.3 samples/s | 68.6 steps/s
[Step=8550 Epoch=16.7] | Loss=0.02809 | Reg=0.00145 | acc=0.9688 | FP-Norm=1.196 | FP-Norm(final)=2.521 | 1600.1 samples/s | 25.0 steps/s
[Step=8600 Epoch=16.8] | Loss=0.02738 | Reg=0.00148 | acc=0.9375 | FP-Norm=1.208 | FP-Norm(final)=2.522 | 3650.0 samples/s | 57.0 steps/s
[Step=8650 Epoch=16.9] | Loss=0.02677 | Reg=0.00151 | acc=0.9531 | FP-Norm=1.219 | FP-Norm(final)=2.523 | 3663.4 samples/s | 57.2 steps/s
[Step=8700 Epoch=17.0] | Loss=0.02612 | Reg=0.00153 | acc=0.9844 | FP-Norm=1.229 | FP-Norm(final)=2.524 | 3621.6 samples/s | 56.6 steps/s
[Step=8750 Epoch=17.1] | Loss=0.02594 | Reg=0.00156 | acc=0.9844 | FP-Norm=1.241 | FP-Norm(final)=2.525 | 3608.1 samples/s | 56.4 steps/s
[Step=8800 Epoch=17.2] | Loss=0.02557 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.253 | FP-Norm(final)=2.525 | 3669.5 samples/s | 57.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step8800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=30.7] | Loss=0.04783 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.525 | 3546.1 samples/s | 55.4 steps/s
[Step=8050 Epoch=30.8] | Loss=0.01637 | Reg=0.00212 | acc=0.9844 | FP-Norm=1.384 | FP-Norm(final)=2.525 | 3196.5 samples/s | 49.9 steps/s
[Step=8100 Epoch=31.0] | Loss=0.01139 | Reg=0.00311 | acc=1.0000 | FP-Norm=1.704 | FP-Norm(final)=2.510 | 3449.5 samples/s | 53.9 steps/s
[Step=8150 Epoch=31.2] | Loss=0.00787 | Reg=0.00328 | acc=1.0000 | FP-Norm=1.771 | FP-Norm(final)=2.507 | 3482.1 samples/s | 54.4 steps/s
[Step=8200 Epoch=31.4] | Loss=0.00612 | Reg=0.00324 | acc=0.9844 | FP-Norm=1.770 | FP-Norm(final)=2.508 | 3527.3 samples/s | 55.1 steps/s
[Step=8250 Epoch=31.6] | Loss=0.00501 | Reg=0.00315 | acc=1.0000 | FP-Norm=1.749 | FP-Norm(final)=2.510 | 4324.1 samples/s | 67.6 steps/s
[Step=8300 Epoch=31.8] | Loss=0.00419 | Reg=0.00305 | acc=1.0000 | FP-Norm=1.722 | FP-Norm(final)=2.512 | 1556.1 samples/s | 24.3 steps/s
[Step=8350 Epoch=32.0] | Loss=0.00360 | Reg=0.00294 | acc=1.0000 | FP-Norm=1.693 | FP-Norm(final)=2.514 | 3487.3 samples/s | 54.5 steps/s
[Step=8400 Epoch=32.2] | Loss=0.00315 | Reg=0.00283 | acc=1.0000 | FP-Norm=1.662 | FP-Norm(final)=2.515 | 3440.2 samples/s | 53.8 steps/s
[Step=8450 Epoch=32.4] | Loss=0.00281 | Reg=0.00274 | acc=1.0000 | FP-Norm=1.632 | FP-Norm(final)=2.517 | 3476.0 samples/s | 54.3 steps/s
[Step=8500 Epoch=32.6] | Loss=0.00253 | Reg=0.00264 | acc=1.0000 | FP-Norm=1.603 | FP-Norm(final)=2.518 | 3831.8 samples/s | 59.9 steps/s
[Step=8550 Epoch=32.8] | Loss=0.00231 | Reg=0.00255 | acc=1.0000 | FP-Norm=1.575 | FP-Norm(final)=2.520 | 1628.2 samples/s | 25.4 steps/s
[Step=8600 Epoch=33.0] | Loss=0.00212 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.548 | FP-Norm(final)=2.521 | 3454.3 samples/s | 54.0 steps/s
[Step=8650 Epoch=33.1] | Loss=0.00196 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.522 | FP-Norm(final)=2.522 | 3485.0 samples/s | 54.5 steps/s
[Step=8700 Epoch=33.3] | Loss=0.00182 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.497 | FP-Norm(final)=2.524 | 3484.2 samples/s | 54.4 steps/s
[Step=8750 Epoch=33.5] | Loss=0.00170 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.472 | FP-Norm(final)=2.525 | 3464.4 samples/s | 54.1 steps/s
[Step=8800 Epoch=33.7] | Loss=0.00160 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.449 | FP-Norm(final)=2.526 | 1663.1 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29065 | acc=0.7812 | tpr=0.6927 | fpr=0.0268 | 3475.9 samples/s | 13.6 steps/s
Avg test loss: 0.29453, Avg test acc: 0.77779, Avg tpr: 0.68893, Avg fpr: 0.02679, total FA: 209

Testing server on iccad2012
[Step=  50] | Loss=0.35783 | acc=0.7802 | tpr=0.9735 | fpr=0.2232 | 3483.4 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.36536 | acc=0.7798 | tpr=0.9659 | fpr=0.2237 | 6692.6 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.37175 | acc=0.7778 | tpr=0.9697 | fpr=0.2257 | 6542.0 samples/s | 25.6 steps/s
[Step= 200] | Loss=0.37309 | acc=0.7781 | tpr=0.9683 | fpr=0.2254 | 6430.1 samples/s | 25.1 steps/s
[Step= 250] | Loss=0.37429 | acc=0.7772 | tpr=0.9677 | fpr=0.2263 | 6537.8 samples/s | 25.5 steps/s
[Step= 300] | Loss=0.37675 | acc=0.7761 | tpr=0.9687 | fpr=0.2274 | 6464.6 samples/s | 25.3 steps/s
[Step= 350] | Loss=0.37689 | acc=0.7770 | tpr=0.9699 | fpr=0.2265 | 6838.7 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.37863 | acc=0.7762 | tpr=0.9710 | fpr=0.2273 | 6306.8 samples/s | 24.6 steps/s
[Step= 450] | Loss=0.38042 | acc=0.7759 | tpr=0.9718 | fpr=0.2277 | 6628.7 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.38064 | acc=0.7759 | tpr=0.9714 | fpr=0.2276 | 6441.4 samples/s | 25.2 steps/s
[Step= 550] | Loss=0.37975 | acc=0.7761 | tpr=0.9710 | fpr=0.2274 | 12430.2 samples/s | 48.6 steps/s
Avg test loss: 0.37958, Avg test acc: 0.77609, Avg tpr: 0.97068, Avg fpr: 0.22745, total FA: 31581

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=12.5] | Loss=0.24323 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.526 | 3532.7 samples/s | 55.2 steps/s
[Step=6450 Epoch=12.6] | Loss=0.04318 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.851 | FP-Norm(final)=2.514 | 3362.9 samples/s | 52.5 steps/s
[Step=6500 Epoch=12.7] | Loss=0.03469 | Reg=0.00088 | acc=0.9844 | FP-Norm=0.921 | FP-Norm(final)=2.516 | 3686.1 samples/s | 57.6 steps/s
[Step=6550 Epoch=12.8] | Loss=0.03449 | Reg=0.00096 | acc=0.9844 | FP-Norm=0.964 | FP-Norm(final)=2.517 | 3691.9 samples/s | 57.7 steps/s
[Step=6600 Epoch=12.9] | Loss=0.03452 | Reg=0.00102 | acc=0.9531 | FP-Norm=1.000 | FP-Norm(final)=2.516 | 3730.3 samples/s | 58.3 steps/s
[Step=6650 Epoch=13.0] | Loss=0.03301 | Reg=0.00108 | acc=0.9688 | FP-Norm=1.030 | FP-Norm(final)=2.515 | 3718.5 samples/s | 58.1 steps/s
[Step=6700 Epoch=13.1] | Loss=0.03302 | Reg=0.00113 | acc=0.9844 | FP-Norm=1.052 | FP-Norm(final)=2.515 | 3737.2 samples/s | 58.4 steps/s
[Step=6750 Epoch=13.2] | Loss=0.03217 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.073 | FP-Norm(final)=2.515 | 3658.9 samples/s | 57.2 steps/s
[Step=6800 Epoch=13.3] | Loss=0.03137 | Reg=0.00122 | acc=0.9844 | FP-Norm=1.094 | FP-Norm(final)=2.516 | 3636.4 samples/s | 56.8 steps/s
[Step=6850 Epoch=13.4] | Loss=0.03144 | Reg=0.00126 | acc=0.9688 | FP-Norm=1.113 | FP-Norm(final)=2.516 | 3675.2 samples/s | 57.4 steps/s
[Step=6900 Epoch=13.5] | Loss=0.03078 | Reg=0.00131 | acc=0.9688 | FP-Norm=1.133 | FP-Norm(final)=2.516 | 4387.2 samples/s | 68.5 steps/s
[Step=6950 Epoch=13.6] | Loss=0.02975 | Reg=0.00135 | acc=0.9844 | FP-Norm=1.152 | FP-Norm(final)=2.517 | 1607.8 samples/s | 25.1 steps/s
[Step=7000 Epoch=13.7] | Loss=0.02881 | Reg=0.00139 | acc=1.0000 | FP-Norm=1.167 | FP-Norm(final)=2.518 | 3614.4 samples/s | 56.5 steps/s
[Step=7050 Epoch=13.8] | Loss=0.02802 | Reg=0.00142 | acc=0.9844 | FP-Norm=1.181 | FP-Norm(final)=2.519 | 3666.0 samples/s | 57.3 steps/s
[Step=7100 Epoch=13.8] | Loss=0.02715 | Reg=0.00145 | acc=0.9688 | FP-Norm=1.193 | FP-Norm(final)=2.521 | 3640.6 samples/s | 56.9 steps/s
[Step=7150 Epoch=13.9] | Loss=0.02697 | Reg=0.00148 | acc=0.9688 | FP-Norm=1.205 | FP-Norm(final)=2.522 | 3591.8 samples/s | 56.1 steps/s
[Step=7200 Epoch=14.0] | Loss=0.02685 | Reg=0.00151 | acc=0.9688 | FP-Norm=1.218 | FP-Norm(final)=2.523 | 3608.1 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step7200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=17.2] | Loss=0.23710 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.526 | 3601.4 samples/s | 56.3 steps/s
[Step=8850 Epoch=17.3] | Loss=0.04833 | Reg=0.00104 | acc=0.9844 | FP-Norm=0.972 | FP-Norm(final)=2.512 | 3504.6 samples/s | 54.8 steps/s
[Step=8900 Epoch=17.4] | Loss=0.03911 | Reg=0.00116 | acc=0.9688 | FP-Norm=1.052 | FP-Norm(final)=2.510 | 3737.9 samples/s | 58.4 steps/s
[Step=8950 Epoch=17.5] | Loss=0.03336 | Reg=0.00119 | acc=0.9844 | FP-Norm=1.074 | FP-Norm(final)=2.513 | 3665.6 samples/s | 57.3 steps/s
[Step=9000 Epoch=17.6] | Loss=0.03148 | Reg=0.00121 | acc=0.9531 | FP-Norm=1.086 | FP-Norm(final)=2.515 | 3717.2 samples/s | 58.1 steps/s
[Step=9050 Epoch=17.7] | Loss=0.03018 | Reg=0.00123 | acc=0.9688 | FP-Norm=1.099 | FP-Norm(final)=2.517 | 3699.4 samples/s | 57.8 steps/s
[Step=9100 Epoch=17.8] | Loss=0.02985 | Reg=0.00126 | acc=0.9844 | FP-Norm=1.115 | FP-Norm(final)=2.519 | 3679.6 samples/s | 57.5 steps/s
[Step=9150 Epoch=17.9] | Loss=0.02831 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.131 | FP-Norm(final)=2.520 | 3664.5 samples/s | 57.3 steps/s
[Step=9200 Epoch=18.0] | Loss=0.02781 | Reg=0.00133 | acc=0.9062 | FP-Norm=1.144 | FP-Norm(final)=2.522 | 3694.2 samples/s | 57.7 steps/s
[Step=9250 Epoch=18.1] | Loss=0.02792 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.158 | FP-Norm(final)=2.524 | 3636.6 samples/s | 56.8 steps/s
[Step=9300 Epoch=18.2] | Loss=0.02826 | Reg=0.00140 | acc=1.0000 | FP-Norm=1.174 | FP-Norm(final)=2.524 | 4464.6 samples/s | 69.8 steps/s
[Step=9350 Epoch=18.3] | Loss=0.02808 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.190 | FP-Norm(final)=2.524 | 1624.6 samples/s | 25.4 steps/s
[Step=9400 Epoch=18.4] | Loss=0.02750 | Reg=0.00147 | acc=0.9688 | FP-Norm=1.205 | FP-Norm(final)=2.524 | 3715.7 samples/s | 58.1 steps/s
[Step=9450 Epoch=18.5] | Loss=0.02719 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.216 | FP-Norm(final)=2.524 | 3690.0 samples/s | 57.7 steps/s
[Step=9500 Epoch=18.6] | Loss=0.02674 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.227 | FP-Norm(final)=2.525 | 3679.4 samples/s | 57.5 steps/s
[Step=9550 Epoch=18.7] | Loss=0.02607 | Reg=0.00155 | acc=0.9844 | FP-Norm=1.238 | FP-Norm(final)=2.525 | 3723.7 samples/s | 58.2 steps/s
[Step=9600 Epoch=18.8] | Loss=0.02577 | Reg=0.00158 | acc=0.9844 | FP-Norm=1.248 | FP-Norm(final)=2.526 | 3702.3 samples/s | 57.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24998 | acc=0.8084 | tpr=0.7371 | fpr=0.0369 | 3417.3 samples/s | 13.3 steps/s
Avg test loss: 0.25307, Avg test acc: 0.80752, Avg tpr: 0.73608, Avg fpr: 0.03538, total FA: 276

Testing server on iccad2012
[Step=  50] | Loss=0.38080 | acc=0.7671 | tpr=0.9735 | fpr=0.2366 | 3452.6 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.38829 | acc=0.7680 | tpr=0.9680 | fpr=0.2357 | 6683.9 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.39503 | acc=0.7656 | tpr=0.9726 | fpr=0.2382 | 6556.5 samples/s | 25.6 steps/s
[Step= 200] | Loss=0.39666 | acc=0.7658 | tpr=0.9716 | fpr=0.2379 | 6743.7 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.39821 | acc=0.7650 | tpr=0.9721 | fpr=0.2388 | 6489.6 samples/s | 25.3 steps/s
[Step= 300] | Loss=0.40042 | acc=0.7637 | tpr=0.9724 | fpr=0.2401 | 6522.6 samples/s | 25.5 steps/s
[Step= 350] | Loss=0.40052 | acc=0.7646 | tpr=0.9737 | fpr=0.2392 | 6469.6 samples/s | 25.3 steps/s
[Step= 400] | Loss=0.40252 | acc=0.7636 | tpr=0.9748 | fpr=0.2402 | 6549.6 samples/s | 25.6 steps/s
[Step= 450] | Loss=0.40437 | acc=0.7632 | tpr=0.9757 | fpr=0.2407 | 6795.1 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.40460 | acc=0.7632 | tpr=0.9758 | fpr=0.2407 | 6372.6 samples/s | 24.9 steps/s
[Step= 550] | Loss=0.40358 | acc=0.7634 | tpr=0.9753 | fpr=0.2405 | 12260.9 samples/s | 47.9 steps/s
Avg test loss: 0.40345, Avg test acc: 0.76330, Avg tpr: 0.97504, Avg fpr: 0.24055, total FA: 33400

server round 20/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=7201 Epoch=14.0] | Loss=0.12130 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.531 | 3239.6 samples/s | 50.6 steps/s
[Step=7250 Epoch=14.1] | Loss=0.04225 | Reg=0.00039 | acc=0.9844 | FP-Norm=0.598 | FP-Norm(final)=2.528 | 3602.6 samples/s | 56.3 steps/s
[Step=7300 Epoch=14.2] | Loss=0.03171 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.651 | FP-Norm(final)=2.530 | 3558.2 samples/s | 55.6 steps/s
[Step=7350 Epoch=14.3] | Loss=0.02762 | Reg=0.00046 | acc=0.9531 | FP-Norm=0.668 | FP-Norm(final)=2.533 | 3622.1 samples/s | 56.6 steps/s
[Step=7400 Epoch=14.4] | Loss=0.02479 | Reg=0.00048 | acc=0.9844 | FP-Norm=0.682 | FP-Norm(final)=2.537 | 3637.8 samples/s | 56.8 steps/s
[Step=7450 Epoch=14.5] | Loss=0.02451 | Reg=0.00049 | acc=0.9531 | FP-Norm=0.693 | FP-Norm(final)=2.539 | 3701.5 samples/s | 57.8 steps/s
[Step=7500 Epoch=14.6] | Loss=0.02373 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.704 | FP-Norm(final)=2.541 | 3729.3 samples/s | 58.3 steps/s
[Step=7550 Epoch=14.7] | Loss=0.02283 | Reg=0.00052 | acc=0.9844 | FP-Norm=0.714 | FP-Norm(final)=2.544 | 3712.4 samples/s | 58.0 steps/s
[Step=7600 Epoch=14.8] | Loss=0.02251 | Reg=0.00053 | acc=0.9844 | FP-Norm=0.724 | FP-Norm(final)=2.546 | 3745.9 samples/s | 58.5 steps/s
[Step=7650 Epoch=14.9] | Loss=0.02177 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.733 | FP-Norm(final)=2.548 | 3675.3 samples/s | 57.4 steps/s
[Step=7700 Epoch=15.0] | Loss=0.02141 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.740 | FP-Norm(final)=2.550 | 4387.0 samples/s | 68.5 steps/s
[Step=7750 Epoch=15.1] | Loss=0.02068 | Reg=0.00057 | acc=0.9844 | FP-Norm=0.747 | FP-Norm(final)=2.552 | 1561.4 samples/s | 24.4 steps/s
[Step=7800 Epoch=15.2] | Loss=0.01992 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.754 | FP-Norm(final)=2.554 | 3667.2 samples/s | 57.3 steps/s
[Step=7850 Epoch=15.3] | Loss=0.01932 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.760 | FP-Norm(final)=2.556 | 3634.8 samples/s | 56.8 steps/s
[Step=7900 Epoch=15.4] | Loss=0.01893 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.766 | FP-Norm(final)=2.558 | 3617.5 samples/s | 56.5 steps/s
[Step=7950 Epoch=15.5] | Loss=0.01828 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.773 | FP-Norm(final)=2.560 | 3652.7 samples/s | 57.1 steps/s
[Step=8000 Epoch=15.6] | Loss=0.01815 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.779 | FP-Norm(final)=2.563 | 3671.8 samples/s | 57.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step8000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=6401 Epoch=24.6] | Loss=0.15483 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.532 | 3632.1 samples/s | 56.8 steps/s
[Step=6450 Epoch=24.8] | Loss=0.00965 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.886 | FP-Norm(final)=2.536 | 3206.3 samples/s | 50.1 steps/s
[Step=6500 Epoch=25.0] | Loss=0.00538 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.980 | FP-Norm(final)=2.538 | 3526.1 samples/s | 55.1 steps/s
[Step=6550 Epoch=25.2] | Loss=0.00383 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.991 | FP-Norm(final)=2.540 | 3540.5 samples/s | 55.3 steps/s
[Step=6600 Epoch=25.4] | Loss=0.00299 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.986 | FP-Norm(final)=2.542 | 3535.9 samples/s | 55.2 steps/s
[Step=6650 Epoch=25.6] | Loss=0.00247 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.977 | FP-Norm(final)=2.543 | 4383.7 samples/s | 68.5 steps/s
[Step=6700 Epoch=25.8] | Loss=0.00208 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.965 | FP-Norm(final)=2.545 | 1485.5 samples/s | 23.2 steps/s
[Step=6750 Epoch=26.0] | Loss=0.00179 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.952 | FP-Norm(final)=2.546 | 3405.2 samples/s | 53.2 steps/s
[Step=6800 Epoch=26.2] | Loss=0.00157 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.939 | FP-Norm(final)=2.547 | 3508.8 samples/s | 54.8 steps/s
[Step=6850 Epoch=26.4] | Loss=0.00141 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.926 | FP-Norm(final)=2.548 | 3504.6 samples/s | 54.8 steps/s
[Step=6900 Epoch=26.6] | Loss=0.00128 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.913 | FP-Norm(final)=2.549 | 3948.0 samples/s | 61.7 steps/s
[Step=6950 Epoch=26.8] | Loss=0.00117 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.900 | FP-Norm(final)=2.549 | 1595.7 samples/s | 24.9 steps/s
[Step=7000 Epoch=26.9] | Loss=0.00108 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.888 | FP-Norm(final)=2.550 | 3494.1 samples/s | 54.6 steps/s
[Step=7050 Epoch=27.1] | Loss=0.00100 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.551 | 3501.2 samples/s | 54.7 steps/s
[Step=7100 Epoch=27.3] | Loss=0.00093 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.866 | FP-Norm(final)=2.551 | 3537.5 samples/s | 55.3 steps/s
[Step=7150 Epoch=27.5] | Loss=0.00087 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.855 | FP-Norm(final)=2.552 | 3518.5 samples/s | 55.0 steps/s
[Step=7200 Epoch=27.7] | Loss=0.00082 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.845 | FP-Norm(final)=2.552 | 1647.1 samples/s | 25.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27911 | acc=0.7945 | tpr=0.7102 | fpr=0.0223 | 3485.7 samples/s | 13.6 steps/s
Avg test loss: 0.28338, Avg test acc: 0.79345, Avg tpr: 0.70951, Avg fpr: 0.02192, total FA: 171

Testing server on iccad2012
[Step=  50] | Loss=0.36850 | acc=0.7867 | tpr=0.9735 | fpr=0.2166 | 3498.7 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.37575 | acc=0.7884 | tpr=0.9680 | fpr=0.2150 | 6657.7 samples/s | 26.0 steps/s
[Step= 150] | Loss=0.38313 | acc=0.7862 | tpr=0.9726 | fpr=0.2173 | 6456.1 samples/s | 25.2 steps/s
[Step= 200] | Loss=0.38488 | acc=0.7866 | tpr=0.9705 | fpr=0.2168 | 6708.8 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.38684 | acc=0.7852 | tpr=0.9703 | fpr=0.2182 | 6703.6 samples/s | 26.2 steps/s
[Step= 300] | Loss=0.38895 | acc=0.7842 | tpr=0.9709 | fpr=0.2192 | 6504.5 samples/s | 25.4 steps/s
[Step= 350] | Loss=0.38940 | acc=0.7848 | tpr=0.9724 | fpr=0.2186 | 6569.0 samples/s | 25.7 steps/s
[Step= 400] | Loss=0.39175 | acc=0.7836 | tpr=0.9726 | fpr=0.2198 | 6435.2 samples/s | 25.1 steps/s
[Step= 450] | Loss=0.39362 | acc=0.7832 | tpr=0.9727 | fpr=0.2203 | 6389.1 samples/s | 25.0 steps/s
[Step= 500] | Loss=0.39388 | acc=0.7830 | tpr=0.9731 | fpr=0.2205 | 6321.0 samples/s | 24.7 steps/s
[Step= 550] | Loss=0.39274 | acc=0.7832 | tpr=0.9729 | fpr=0.2202 | 11571.0 samples/s | 45.2 steps/s
Avg test loss: 0.39261, Avg test acc: 0.78321, Avg tpr: 0.97266, Avg fpr: 0.22023, total FA: 30579

server round 21/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=33.7] | Loss=0.04632 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.559 | 3717.4 samples/s | 58.1 steps/s
[Step=8850 Epoch=33.9] | Loss=0.00695 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.894 | FP-Norm(final)=2.564 | 3225.4 samples/s | 50.4 steps/s
[Step=8900 Epoch=34.1] | Loss=0.00382 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.968 | FP-Norm(final)=2.567 | 3495.6 samples/s | 54.6 steps/s
[Step=8950 Epoch=34.3] | Loss=0.00264 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.972 | FP-Norm(final)=2.569 | 3450.7 samples/s | 53.9 steps/s
[Step=9000 Epoch=34.5] | Loss=0.00200 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.958 | FP-Norm(final)=2.570 | 3464.8 samples/s | 54.1 steps/s
[Step=9050 Epoch=34.7] | Loss=0.00163 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.940 | FP-Norm(final)=2.571 | 4261.6 samples/s | 66.6 steps/s
[Step=9100 Epoch=34.9] | Loss=0.00137 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.923 | FP-Norm(final)=2.573 | 1571.9 samples/s | 24.6 steps/s
[Step=9150 Epoch=35.1] | Loss=0.00118 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.906 | FP-Norm(final)=2.574 | 3490.7 samples/s | 54.5 steps/s
[Step=9200 Epoch=35.3] | Loss=0.00104 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.889 | FP-Norm(final)=2.574 | 3473.7 samples/s | 54.3 steps/s
[Step=9250 Epoch=35.4] | Loss=0.00093 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.874 | FP-Norm(final)=2.575 | 3486.4 samples/s | 54.5 steps/s
[Step=9300 Epoch=35.6] | Loss=0.00084 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.859 | FP-Norm(final)=2.576 | 3795.8 samples/s | 59.3 steps/s
[Step=9350 Epoch=35.8] | Loss=0.00077 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.846 | FP-Norm(final)=2.576 | 1641.0 samples/s | 25.6 steps/s
[Step=9400 Epoch=36.0] | Loss=0.00071 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.833 | FP-Norm(final)=2.577 | 3505.7 samples/s | 54.8 steps/s
[Step=9450 Epoch=36.2] | Loss=0.00066 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.577 | 3552.9 samples/s | 55.5 steps/s
[Step=9500 Epoch=36.4] | Loss=0.00062 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.578 | 3505.8 samples/s | 54.8 steps/s
[Step=9550 Epoch=36.6] | Loss=0.00058 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.578 | 3495.6 samples/s | 54.6 steps/s
[Step=9600 Epoch=36.8] | Loss=0.00055 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.787 | FP-Norm(final)=2.579 | 1674.6 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step9600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=7201 Epoch=27.7] | Loss=0.18853 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.558 | 3611.8 samples/s | 56.4 steps/s
[Step=7250 Epoch=27.9] | Loss=0.00820 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.892 | FP-Norm(final)=2.565 | 3184.4 samples/s | 49.8 steps/s
[Step=7300 Epoch=28.1] | Loss=0.00441 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.960 | FP-Norm(final)=2.568 | 3495.0 samples/s | 54.6 steps/s
[Step=7350 Epoch=28.3] | Loss=0.00313 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.963 | FP-Norm(final)=2.571 | 3456.3 samples/s | 54.0 steps/s
[Step=7400 Epoch=28.5] | Loss=0.00249 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.959 | FP-Norm(final)=2.573 | 3478.3 samples/s | 54.3 steps/s
[Step=7450 Epoch=28.7] | Loss=0.00204 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.950 | FP-Norm(final)=2.574 | 4304.9 samples/s | 67.3 steps/s
[Step=7500 Epoch=28.9] | Loss=0.00172 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.938 | FP-Norm(final)=2.575 | 1538.3 samples/s | 24.0 steps/s
[Step=7550 Epoch=29.1] | Loss=0.00148 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.924 | FP-Norm(final)=2.577 | 3519.6 samples/s | 55.0 steps/s
[Step=7600 Epoch=29.3] | Loss=0.00130 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.910 | FP-Norm(final)=2.577 | 3470.6 samples/s | 54.2 steps/s
[Step=7650 Epoch=29.4] | Loss=0.00116 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.896 | FP-Norm(final)=2.578 | 3450.7 samples/s | 53.9 steps/s
[Step=7700 Epoch=29.6] | Loss=0.00105 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.883 | FP-Norm(final)=2.579 | 3954.3 samples/s | 61.8 steps/s
[Step=7750 Epoch=29.8] | Loss=0.00096 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.579 | 1600.2 samples/s | 25.0 steps/s
[Step=7800 Epoch=30.0] | Loss=0.00089 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.859 | FP-Norm(final)=2.580 | 3512.0 samples/s | 54.9 steps/s
[Step=7850 Epoch=30.2] | Loss=0.00082 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.847 | FP-Norm(final)=2.580 | 3501.5 samples/s | 54.7 steps/s
[Step=7900 Epoch=30.4] | Loss=0.00077 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.836 | FP-Norm(final)=2.581 | 3455.8 samples/s | 54.0 steps/s
[Step=7950 Epoch=30.6] | Loss=0.00072 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.825 | FP-Norm(final)=2.581 | 3554.4 samples/s | 55.5 steps/s
[Step=8000 Epoch=30.8] | Loss=0.00068 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.581 | 1663.5 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28994 | acc=0.7962 | tpr=0.7102 | fpr=0.0171 | 3499.1 samples/s | 13.7 steps/s
Avg test loss: 0.29413, Avg test acc: 0.79445, Avg tpr: 0.70898, Avg fpr: 0.01756, total FA: 137

Testing server on iccad2012
[Step=  50] | Loss=0.38360 | acc=0.7808 | tpr=0.9735 | fpr=0.2227 | 3419.1 samples/s | 13.4 steps/s
[Step= 100] | Loss=0.38992 | acc=0.7810 | tpr=0.9616 | fpr=0.2224 | 6644.9 samples/s | 26.0 steps/s
[Step= 150] | Loss=0.39782 | acc=0.7784 | tpr=0.9625 | fpr=0.2250 | 6771.8 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.39973 | acc=0.7786 | tpr=0.9628 | fpr=0.2247 | 6685.0 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.40141 | acc=0.7778 | tpr=0.9642 | fpr=0.2256 | 6635.0 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.40328 | acc=0.7767 | tpr=0.9651 | fpr=0.2267 | 6549.7 samples/s | 25.6 steps/s
[Step= 350] | Loss=0.40388 | acc=0.7774 | tpr=0.9674 | fpr=0.2260 | 6766.5 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.40631 | acc=0.7765 | tpr=0.9688 | fpr=0.2270 | 6313.3 samples/s | 24.7 steps/s
[Step= 450] | Loss=0.40828 | acc=0.7761 | tpr=0.9684 | fpr=0.2274 | 6385.8 samples/s | 24.9 steps/s
[Step= 500] | Loss=0.40830 | acc=0.7759 | tpr=0.9683 | fpr=0.2276 | 6255.9 samples/s | 24.4 steps/s
[Step= 550] | Loss=0.40694 | acc=0.7761 | tpr=0.9674 | fpr=0.2274 | 12580.6 samples/s | 49.1 steps/s
Avg test loss: 0.40685, Avg test acc: 0.77604, Avg tpr: 0.96712, Avg fpr: 0.22744, total FA: 31579

server round 22/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=15.6] | Loss=0.15496 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.575 | 3352.9 samples/s | 52.4 steps/s
[Step=8050 Epoch=15.7] | Loss=0.03541 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.570 | 3485.1 samples/s | 54.5 steps/s
[Step=8100 Epoch=15.8] | Loss=0.02875 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.667 | FP-Norm(final)=2.570 | 3629.3 samples/s | 56.7 steps/s
[Step=8150 Epoch=15.9] | Loss=0.02581 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.572 | 3654.3 samples/s | 57.1 steps/s
[Step=8200 Epoch=16.0] | Loss=0.02476 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.701 | FP-Norm(final)=2.574 | 3670.1 samples/s | 57.3 steps/s
[Step=8250 Epoch=16.1] | Loss=0.02322 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.714 | FP-Norm(final)=2.575 | 3634.7 samples/s | 56.8 steps/s
[Step=8300 Epoch=16.2] | Loss=0.02216 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.721 | FP-Norm(final)=2.577 | 3659.3 samples/s | 57.2 steps/s
[Step=8350 Epoch=16.3] | Loss=0.02141 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.728 | FP-Norm(final)=2.579 | 3663.1 samples/s | 57.2 steps/s
[Step=8400 Epoch=16.4] | Loss=0.02093 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.733 | FP-Norm(final)=2.581 | 3712.3 samples/s | 58.0 steps/s
[Step=8450 Epoch=16.5] | Loss=0.02093 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.739 | FP-Norm(final)=2.582 | 3722.4 samples/s | 58.2 steps/s
[Step=8500 Epoch=16.6] | Loss=0.02072 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.747 | FP-Norm(final)=2.584 | 4423.0 samples/s | 69.1 steps/s
[Step=8550 Epoch=16.7] | Loss=0.02010 | Reg=0.00057 | acc=0.9688 | FP-Norm=0.753 | FP-Norm(final)=2.585 | 1573.4 samples/s | 24.6 steps/s
[Step=8600 Epoch=16.8] | Loss=0.01946 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.759 | FP-Norm(final)=2.587 | 3682.3 samples/s | 57.5 steps/s
[Step=8650 Epoch=16.9] | Loss=0.01900 | Reg=0.00059 | acc=0.9688 | FP-Norm=0.766 | FP-Norm(final)=2.589 | 3678.6 samples/s | 57.5 steps/s
[Step=8700 Epoch=17.0] | Loss=0.01843 | Reg=0.00060 | acc=0.9688 | FP-Norm=0.772 | FP-Norm(final)=2.590 | 3681.9 samples/s | 57.5 steps/s
[Step=8750 Epoch=17.1] | Loss=0.01841 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.592 | 3623.2 samples/s | 56.6 steps/s
[Step=8800 Epoch=17.2] | Loss=0.01810 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.784 | FP-Norm(final)=2.594 | 3663.6 samples/s | 57.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step8800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=30.8] | Loss=0.09384 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.576 | 3499.8 samples/s | 54.7 steps/s
[Step=8050 Epoch=31.0] | Loss=0.01105 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.955 | FP-Norm(final)=2.580 | 3265.4 samples/s | 51.0 steps/s
[Step=8100 Epoch=31.2] | Loss=0.00607 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.048 | FP-Norm(final)=2.581 | 3449.6 samples/s | 53.9 steps/s
[Step=8150 Epoch=31.4] | Loss=0.00416 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.055 | FP-Norm(final)=2.583 | 3453.6 samples/s | 54.0 steps/s
[Step=8200 Epoch=31.6] | Loss=0.00314 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.044 | FP-Norm(final)=2.585 | 3460.7 samples/s | 54.1 steps/s
[Step=8250 Epoch=31.8] | Loss=0.00255 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.029 | FP-Norm(final)=2.586 | 4318.6 samples/s | 67.5 steps/s
[Step=8300 Epoch=31.9] | Loss=0.00215 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.014 | FP-Norm(final)=2.587 | 1505.9 samples/s | 23.5 steps/s
[Step=8350 Epoch=32.1] | Loss=0.00185 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.999 | FP-Norm(final)=2.588 | 3505.0 samples/s | 54.8 steps/s
[Step=8400 Epoch=32.3] | Loss=0.00163 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.984 | FP-Norm(final)=2.589 | 3529.9 samples/s | 55.2 steps/s
[Step=8450 Epoch=32.5] | Loss=0.00146 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.969 | FP-Norm(final)=2.590 | 3450.7 samples/s | 53.9 steps/s
[Step=8500 Epoch=32.7] | Loss=0.00132 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.956 | FP-Norm(final)=2.590 | 3855.3 samples/s | 60.2 steps/s
[Step=8550 Epoch=32.9] | Loss=0.00120 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.942 | FP-Norm(final)=2.591 | 1604.3 samples/s | 25.1 steps/s
[Step=8600 Epoch=33.1] | Loss=0.00111 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.930 | FP-Norm(final)=2.592 | 3482.4 samples/s | 54.4 steps/s
[Step=8650 Epoch=33.3] | Loss=0.00103 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.918 | FP-Norm(final)=2.592 | 3392.6 samples/s | 53.0 steps/s
[Step=8700 Epoch=33.5] | Loss=0.00096 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.906 | FP-Norm(final)=2.593 | 3404.5 samples/s | 53.2 steps/s
[Step=8750 Epoch=33.7] | Loss=0.00090 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.895 | FP-Norm(final)=2.593 | 3517.5 samples/s | 55.0 steps/s
[Step=8800 Epoch=33.9] | Loss=0.00084 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.884 | FP-Norm(final)=2.594 | 1673.4 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27246 | acc=0.8096 | tpr=0.7311 | fpr=0.0198 | 3518.1 samples/s | 13.7 steps/s
Avg test loss: 0.27610, Avg test acc: 0.80768, Avg tpr: 0.72903, Avg fpr: 0.01936, total FA: 151

Testing server on iccad2012
[Step=  50] | Loss=0.39554 | acc=0.7747 | tpr=0.9690 | fpr=0.2288 | 3431.5 samples/s | 13.4 steps/s
[Step= 100] | Loss=0.40140 | acc=0.7751 | tpr=0.9595 | fpr=0.2284 | 6602.1 samples/s | 25.8 steps/s
[Step= 150] | Loss=0.40927 | acc=0.7727 | tpr=0.9625 | fpr=0.2308 | 6597.3 samples/s | 25.8 steps/s
[Step= 200] | Loss=0.41084 | acc=0.7732 | tpr=0.9639 | fpr=0.2302 | 6466.8 samples/s | 25.3 steps/s
[Step= 250] | Loss=0.41266 | acc=0.7721 | tpr=0.9651 | fpr=0.2314 | 6624.5 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.41439 | acc=0.7710 | tpr=0.9658 | fpr=0.2325 | 6660.8 samples/s | 26.0 steps/s
[Step= 350] | Loss=0.41486 | acc=0.7721 | tpr=0.9681 | fpr=0.2314 | 6817.6 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.41721 | acc=0.7710 | tpr=0.9694 | fpr=0.2326 | 6465.7 samples/s | 25.3 steps/s
[Step= 450] | Loss=0.41908 | acc=0.7707 | tpr=0.9688 | fpr=0.2329 | 6056.3 samples/s | 23.7 steps/s
[Step= 500] | Loss=0.41913 | acc=0.7705 | tpr=0.9687 | fpr=0.2330 | 6732.4 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.41767 | acc=0.7710 | tpr=0.9678 | fpr=0.2326 | 11608.8 samples/s | 45.3 steps/s
Avg test loss: 0.41760, Avg test acc: 0.77090, Avg tpr: 0.96751, Avg fpr: 0.23267, total FA: 32306

server round 23/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=18.8] | Loss=0.12356 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.584 | 3459.5 samples/s | 54.1 steps/s
[Step=9650 Epoch=18.9] | Loss=0.02713 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=2.581 | 3684.4 samples/s | 57.6 steps/s
[Step=9700 Epoch=19.0] | Loss=0.02224 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.545 | FP-Norm(final)=2.584 | 3691.7 samples/s | 57.7 steps/s
[Step=9750 Epoch=19.1] | Loss=0.01995 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.586 | 3677.1 samples/s | 57.5 steps/s
[Step=9800 Epoch=19.2] | Loss=0.01906 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.584 | FP-Norm(final)=2.588 | 3664.3 samples/s | 57.3 steps/s
[Step=9850 Epoch=19.3] | Loss=0.01791 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=2.590 | 3690.7 samples/s | 57.7 steps/s
[Step=9900 Epoch=19.4] | Loss=0.01721 | Reg=0.00037 | acc=0.9688 | FP-Norm=0.606 | FP-Norm(final)=2.592 | 3714.6 samples/s | 58.0 steps/s
[Step=9950 Epoch=19.5] | Loss=0.01712 | Reg=0.00039 | acc=0.9844 | FP-Norm=0.616 | FP-Norm(final)=2.594 | 3708.2 samples/s | 57.9 steps/s
[Step=10000 Epoch=19.5] | Loss=0.01680 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.596 | 3704.6 samples/s | 57.9 steps/s
[Step=10050 Epoch=19.6] | Loss=0.01656 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.632 | FP-Norm(final)=2.597 | 3652.5 samples/s | 57.1 steps/s
[Step=10100 Epoch=19.7] | Loss=0.01661 | Reg=0.00042 | acc=0.9688 | FP-Norm=0.640 | FP-Norm(final)=2.599 | 4411.3 samples/s | 68.9 steps/s
[Step=10150 Epoch=19.8] | Loss=0.01615 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.648 | FP-Norm(final)=2.600 | 1608.4 samples/s | 25.1 steps/s
[Step=10200 Epoch=19.9] | Loss=0.01578 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.655 | FP-Norm(final)=2.601 | 3635.9 samples/s | 56.8 steps/s
[Step=10250 Epoch=20.0] | Loss=0.01547 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.663 | FP-Norm(final)=2.603 | 3566.5 samples/s | 55.7 steps/s
[Step=10300 Epoch=20.1] | Loss=0.01514 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.669 | FP-Norm(final)=2.604 | 3611.8 samples/s | 56.4 steps/s
[Step=10350 Epoch=20.2] | Loss=0.01487 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.674 | FP-Norm(final)=2.606 | 3615.3 samples/s | 56.5 steps/s
[Step=10400 Epoch=20.3] | Loss=0.01485 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.680 | FP-Norm(final)=2.607 | 3616.4 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step10400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=36.8] | Loss=0.13663 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.585 | 3434.9 samples/s | 53.7 steps/s
[Step=9650 Epoch=37.0] | Loss=0.00747 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.048 | FP-Norm(final)=2.591 | 3358.8 samples/s | 52.5 steps/s
[Step=9700 Epoch=37.2] | Loss=0.00389 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.096 | FP-Norm(final)=2.593 | 3468.0 samples/s | 54.2 steps/s
[Step=9750 Epoch=37.4] | Loss=0.00266 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.081 | FP-Norm(final)=2.595 | 3488.6 samples/s | 54.5 steps/s
[Step=9800 Epoch=37.6] | Loss=0.00216 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.058 | FP-Norm(final)=2.596 | 3450.2 samples/s | 53.9 steps/s
[Step=9850 Epoch=37.7] | Loss=0.00174 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.036 | FP-Norm(final)=2.597 | 4273.8 samples/s | 66.8 steps/s
[Step=9900 Epoch=37.9] | Loss=0.00146 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.015 | FP-Norm(final)=2.598 | 1546.1 samples/s | 24.2 steps/s
[Step=9950 Epoch=38.1] | Loss=0.00128 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.995 | FP-Norm(final)=2.598 | 3518.8 samples/s | 55.0 steps/s
[Step=10000 Epoch=38.3] | Loss=0.00114 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.977 | FP-Norm(final)=2.599 | 3538.9 samples/s | 55.3 steps/s
[Step=10050 Epoch=38.5] | Loss=0.00102 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.961 | FP-Norm(final)=2.600 | 3471.2 samples/s | 54.2 steps/s
[Step=10100 Epoch=38.7] | Loss=0.00092 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.944 | FP-Norm(final)=2.600 | 3809.2 samples/s | 59.5 steps/s
[Step=10150 Epoch=38.9] | Loss=0.00084 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.930 | FP-Norm(final)=2.601 | 1641.2 samples/s | 25.6 steps/s
[Step=10200 Epoch=39.1] | Loss=0.00077 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.915 | FP-Norm(final)=2.601 | 3508.1 samples/s | 54.8 steps/s
[Step=10250 Epoch=39.3] | Loss=0.00072 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.902 | FP-Norm(final)=2.602 | 3504.4 samples/s | 54.8 steps/s
[Step=10300 Epoch=39.5] | Loss=0.00067 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.888 | FP-Norm(final)=2.602 | 3517.7 samples/s | 55.0 steps/s
[Step=10350 Epoch=39.7] | Loss=0.00063 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.876 | FP-Norm(final)=2.602 | 3497.5 samples/s | 54.6 steps/s
[Step=10400 Epoch=39.8] | Loss=0.00059 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.864 | FP-Norm(final)=2.603 | 1684.8 samples/s | 26.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38193 | acc=0.7502 | tpr=0.6426 | fpr=0.0161 | 3422.7 samples/s | 13.4 steps/s
Avg test loss: 0.38578, Avg test acc: 0.74794, Avg tpr: 0.64044, Avg fpr: 0.01564, total FA: 122

Testing server on iccad2012
[Step=  50] | Loss=0.29818 | acc=0.8473 | tpr=0.9735 | fpr=0.1550 | 3547.8 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.30589 | acc=0.8454 | tpr=0.9595 | fpr=0.1567 | 6147.3 samples/s | 24.0 steps/s
[Step= 150] | Loss=0.31427 | acc=0.8436 | tpr=0.9640 | fpr=0.1586 | 6520.6 samples/s | 25.5 steps/s
[Step= 200] | Loss=0.31612 | acc=0.8447 | tpr=0.9639 | fpr=0.1574 | 6518.9 samples/s | 25.5 steps/s
[Step= 250] | Loss=0.31757 | acc=0.8436 | tpr=0.9659 | fpr=0.1586 | 6642.1 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.31940 | acc=0.8430 | tpr=0.9658 | fpr=0.1592 | 6598.3 samples/s | 25.8 steps/s
[Step= 350] | Loss=0.32039 | acc=0.8437 | tpr=0.9681 | fpr=0.1586 | 6719.1 samples/s | 26.2 steps/s
[Step= 400] | Loss=0.32244 | acc=0.8428 | tpr=0.9694 | fpr=0.1595 | 6386.0 samples/s | 24.9 steps/s
[Step= 450] | Loss=0.32413 | acc=0.8421 | tpr=0.9693 | fpr=0.1602 | 6400.0 samples/s | 25.0 steps/s
[Step= 500] | Loss=0.32416 | acc=0.8420 | tpr=0.9696 | fpr=0.1603 | 6622.8 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.32265 | acc=0.8424 | tpr=0.9678 | fpr=0.1598 | 12029.2 samples/s | 47.0 steps/s
Avg test loss: 0.32249, Avg test acc: 0.84244, Avg tpr: 0.96751, Avg fpr: 0.15984, total FA: 22193

server round 24/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=39.9] | Loss=0.10498 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.613 | 3334.9 samples/s | 52.1 steps/s
[Step=10450 Epoch=40.0] | Loss=0.00592 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.869 | FP-Norm(final)=2.618 | 3407.3 samples/s | 53.2 steps/s
[Step=10500 Epoch=40.2] | Loss=0.00321 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.937 | FP-Norm(final)=2.619 | 3544.9 samples/s | 55.4 steps/s
[Step=10550 Epoch=40.4] | Loss=0.00223 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.935 | FP-Norm(final)=2.620 | 3422.3 samples/s | 53.5 steps/s
[Step=10600 Epoch=40.6] | Loss=0.00171 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.923 | FP-Norm(final)=2.621 | 3482.9 samples/s | 54.4 steps/s
[Step=10650 Epoch=40.8] | Loss=0.00138 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.906 | FP-Norm(final)=2.622 | 4258.9 samples/s | 66.5 steps/s
[Step=10700 Epoch=41.0] | Loss=0.00116 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.890 | FP-Norm(final)=2.623 | 1550.5 samples/s | 24.2 steps/s
[Step=10750 Epoch=41.2] | Loss=0.00100 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.873 | FP-Norm(final)=2.624 | 3425.6 samples/s | 53.5 steps/s
[Step=10800 Epoch=41.4] | Loss=0.00088 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.857 | FP-Norm(final)=2.624 | 3428.1 samples/s | 53.6 steps/s
[Step=10850 Epoch=41.6] | Loss=0.00079 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.842 | FP-Norm(final)=2.625 | 3503.1 samples/s | 54.7 steps/s
[Step=10900 Epoch=41.8] | Loss=0.00071 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.828 | FP-Norm(final)=2.625 | 3856.5 samples/s | 60.3 steps/s
[Step=10950 Epoch=42.0] | Loss=0.00065 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.626 | 1625.6 samples/s | 25.4 steps/s
[Step=11000 Epoch=42.1] | Loss=0.00060 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.803 | FP-Norm(final)=2.626 | 3544.8 samples/s | 55.4 steps/s
[Step=11050 Epoch=42.3] | Loss=0.00056 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.791 | FP-Norm(final)=2.627 | 3539.2 samples/s | 55.3 steps/s
[Step=11100 Epoch=42.5] | Loss=0.00052 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.627 | 3536.4 samples/s | 55.3 steps/s
[Step=11150 Epoch=42.7] | Loss=0.00049 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.769 | FP-Norm(final)=2.627 | 3513.8 samples/s | 54.9 steps/s
[Step=11200 Epoch=42.9] | Loss=0.00046 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.758 | FP-Norm(final)=2.628 | 1697.5 samples/s | 26.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step11200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=33.9] | Loss=0.05186 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.613 | 3489.2 samples/s | 54.5 steps/s
[Step=8850 Epoch=34.1] | Loss=0.00810 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.885 | FP-Norm(final)=2.614 | 3290.6 samples/s | 51.4 steps/s
[Step=8900 Epoch=34.3] | Loss=0.00491 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.964 | FP-Norm(final)=2.616 | 3368.3 samples/s | 52.6 steps/s
[Step=8950 Epoch=34.5] | Loss=0.00343 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.975 | FP-Norm(final)=2.618 | 3455.1 samples/s | 54.0 steps/s
[Step=9000 Epoch=34.6] | Loss=0.00266 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.969 | FP-Norm(final)=2.620 | 3459.6 samples/s | 54.1 steps/s
[Step=9050 Epoch=34.8] | Loss=0.00217 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.958 | FP-Norm(final)=2.622 | 4306.1 samples/s | 67.3 steps/s
[Step=9100 Epoch=35.0] | Loss=0.00182 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.946 | FP-Norm(final)=2.624 | 1547.2 samples/s | 24.2 steps/s
[Step=9150 Epoch=35.2] | Loss=0.00157 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.931 | FP-Norm(final)=2.625 | 3511.7 samples/s | 54.9 steps/s
[Step=9200 Epoch=35.4] | Loss=0.00138 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.917 | FP-Norm(final)=2.626 | 3500.2 samples/s | 54.7 steps/s
[Step=9250 Epoch=35.6] | Loss=0.00123 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.903 | FP-Norm(final)=2.626 | 3455.4 samples/s | 54.0 steps/s
[Step=9300 Epoch=35.8] | Loss=0.00111 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.890 | FP-Norm(final)=2.627 | 3835.5 samples/s | 59.9 steps/s
[Step=9350 Epoch=36.0] | Loss=0.00102 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.878 | FP-Norm(final)=2.628 | 1578.6 samples/s | 24.7 steps/s
[Step=9400 Epoch=36.2] | Loss=0.00093 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.865 | FP-Norm(final)=2.628 | 3489.3 samples/s | 54.5 steps/s
[Step=9450 Epoch=36.4] | Loss=0.00087 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.854 | FP-Norm(final)=2.629 | 3467.0 samples/s | 54.2 steps/s
[Step=9500 Epoch=36.6] | Loss=0.00081 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.842 | FP-Norm(final)=2.629 | 3496.7 samples/s | 54.6 steps/s
[Step=9550 Epoch=36.8] | Loss=0.00076 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.831 | FP-Norm(final)=2.630 | 3549.5 samples/s | 55.5 steps/s
[Step=9600 Epoch=37.0] | Loss=0.00071 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.821 | FP-Norm(final)=2.630 | 1682.3 samples/s | 26.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33581 | acc=0.7758 | tpr=0.6809 | fpr=0.0181 | 3382.6 samples/s | 13.2 steps/s
Avg test loss: 0.33900, Avg test acc: 0.77382, Avg tpr: 0.67850, Avg fpr: 0.01654, total FA: 129

Testing server on iccad2012
[Step=  50] | Loss=0.33572 | acc=0.8297 | tpr=0.9735 | fpr=0.1729 | 3487.9 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.34309 | acc=0.8269 | tpr=0.9616 | fpr=0.1756 | 6301.7 samples/s | 24.6 steps/s
[Step= 150] | Loss=0.35143 | acc=0.8248 | tpr=0.9654 | fpr=0.1777 | 6770.8 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.35320 | acc=0.8254 | tpr=0.9661 | fpr=0.1772 | 6508.0 samples/s | 25.4 steps/s
[Step= 250] | Loss=0.35459 | acc=0.8241 | tpr=0.9677 | fpr=0.1785 | 6699.8 samples/s | 26.2 steps/s
[Step= 300] | Loss=0.35647 | acc=0.8232 | tpr=0.9680 | fpr=0.1794 | 6638.2 samples/s | 25.9 steps/s
[Step= 350] | Loss=0.35741 | acc=0.8238 | tpr=0.9699 | fpr=0.1788 | 6627.7 samples/s | 25.9 steps/s
[Step= 400] | Loss=0.35955 | acc=0.8230 | tpr=0.9716 | fpr=0.1797 | 6602.4 samples/s | 25.8 steps/s
[Step= 450] | Loss=0.36134 | acc=0.8224 | tpr=0.9718 | fpr=0.1803 | 6347.5 samples/s | 24.8 steps/s
[Step= 500] | Loss=0.36124 | acc=0.8223 | tpr=0.9714 | fpr=0.1804 | 6481.6 samples/s | 25.3 steps/s
[Step= 550] | Loss=0.35975 | acc=0.8227 | tpr=0.9694 | fpr=0.1800 | 12120.3 samples/s | 47.3 steps/s
Avg test loss: 0.35961, Avg test acc: 0.82267, Avg tpr: 0.96910, Avg fpr: 0.17999, total FA: 24991

server round 25/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=42.9] | Loss=0.13884 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.629 | 3346.8 samples/s | 52.3 steps/s
[Step=11250 Epoch=43.1] | Loss=0.01061 | Reg=0.00108 | acc=1.0000 | FP-Norm=0.992 | FP-Norm(final)=2.628 | 3417.2 samples/s | 53.4 steps/s
[Step=11300 Epoch=43.3] | Loss=0.00584 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.078 | FP-Norm(final)=2.627 | 3530.1 samples/s | 55.2 steps/s
[Step=11350 Epoch=43.5] | Loss=0.00398 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.081 | FP-Norm(final)=2.628 | 3472.6 samples/s | 54.3 steps/s
[Step=11400 Epoch=43.7] | Loss=0.00301 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.068 | FP-Norm(final)=2.629 | 3535.6 samples/s | 55.2 steps/s
[Step=11450 Epoch=43.9] | Loss=0.00243 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.052 | FP-Norm(final)=2.630 | 4315.3 samples/s | 67.4 steps/s
[Step=11500 Epoch=44.1] | Loss=0.00203 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.036 | FP-Norm(final)=2.631 | 1522.9 samples/s | 23.8 steps/s
[Step=11550 Epoch=44.3] | Loss=0.00175 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.019 | FP-Norm(final)=2.632 | 3491.2 samples/s | 54.6 steps/s
[Step=11600 Epoch=44.4] | Loss=0.00154 | Reg=0.00102 | acc=1.0000 | FP-Norm=1.003 | FP-Norm(final)=2.632 | 3455.2 samples/s | 54.0 steps/s
[Step=11650 Epoch=44.6] | Loss=0.00137 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.987 | FP-Norm(final)=2.633 | 3437.1 samples/s | 53.7 steps/s
[Step=11700 Epoch=44.8] | Loss=0.00124 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.972 | FP-Norm(final)=2.633 | 3812.8 samples/s | 59.6 steps/s
[Step=11750 Epoch=45.0] | Loss=0.00113 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.958 | FP-Norm(final)=2.634 | 1621.2 samples/s | 25.3 steps/s
[Step=11800 Epoch=45.2] | Loss=0.00104 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.944 | FP-Norm(final)=2.634 | 3450.5 samples/s | 53.9 steps/s
[Step=11850 Epoch=45.4] | Loss=0.00096 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.931 | FP-Norm(final)=2.635 | 3519.1 samples/s | 55.0 steps/s
[Step=11900 Epoch=45.6] | Loss=0.00090 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.919 | FP-Norm(final)=2.635 | 3493.1 samples/s | 54.6 steps/s
[Step=11950 Epoch=45.8] | Loss=0.00084 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.907 | FP-Norm(final)=2.635 | 3524.8 samples/s | 55.1 steps/s
[Step=12000 Epoch=46.0] | Loss=0.00079 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.895 | FP-Norm(final)=2.636 | 1639.5 samples/s | 25.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step12000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=37.0] | Loss=0.15171 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.629 | 3463.1 samples/s | 54.1 steps/s
[Step=9650 Epoch=37.1] | Loss=0.00946 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.954 | FP-Norm(final)=2.630 | 3342.8 samples/s | 52.2 steps/s
[Step=9700 Epoch=37.3] | Loss=0.00594 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.044 | FP-Norm(final)=2.630 | 3463.6 samples/s | 54.1 steps/s
[Step=9750 Epoch=37.5] | Loss=0.00407 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.058 | FP-Norm(final)=2.631 | 3467.9 samples/s | 54.2 steps/s
[Step=9800 Epoch=37.7] | Loss=0.00319 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.053 | FP-Norm(final)=2.632 | 3445.2 samples/s | 53.8 steps/s
[Step=9850 Epoch=37.9] | Loss=0.00258 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.042 | FP-Norm(final)=2.633 | 4340.5 samples/s | 67.8 steps/s
[Step=9900 Epoch=38.1] | Loss=0.00216 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.028 | FP-Norm(final)=2.634 | 1535.9 samples/s | 24.0 steps/s
[Step=9950 Epoch=38.3] | Loss=0.00186 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.013 | FP-Norm(final)=2.635 | 3525.6 samples/s | 55.1 steps/s
[Step=10000 Epoch=38.5] | Loss=0.00163 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.999 | FP-Norm(final)=2.636 | 3477.5 samples/s | 54.3 steps/s
[Step=10050 Epoch=38.7] | Loss=0.00146 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.985 | FP-Norm(final)=2.637 | 3554.2 samples/s | 55.5 steps/s
[Step=10100 Epoch=38.9] | Loss=0.00132 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.972 | FP-Norm(final)=2.638 | 3930.2 samples/s | 61.4 steps/s
[Step=10150 Epoch=39.1] | Loss=0.00121 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.960 | FP-Norm(final)=2.638 | 1626.3 samples/s | 25.4 steps/s
[Step=10200 Epoch=39.3] | Loss=0.00111 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.948 | FP-Norm(final)=2.639 | 3510.5 samples/s | 54.9 steps/s
[Step=10250 Epoch=39.5] | Loss=0.00103 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.936 | FP-Norm(final)=2.639 | 3533.5 samples/s | 55.2 steps/s
[Step=10300 Epoch=39.6] | Loss=0.00096 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.925 | FP-Norm(final)=2.640 | 3507.5 samples/s | 54.8 steps/s
[Step=10350 Epoch=39.8] | Loss=0.00090 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.914 | FP-Norm(final)=2.640 | 3575.5 samples/s | 55.9 steps/s
[Step=10400 Epoch=40.0] | Loss=0.00084 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.904 | FP-Norm(final)=2.641 | 1664.4 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36458 | acc=0.7586 | tpr=0.6545 | fpr=0.0154 | 3517.3 samples/s | 13.7 steps/s
Avg test loss: 0.36889, Avg test acc: 0.75611, Avg tpr: 0.65192, Avg fpr: 0.01474, total FA: 115

Testing server on iccad2012
[Step=  50] | Loss=0.31073 | acc=0.8402 | tpr=0.9735 | fpr=0.1622 | 3510.0 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.31673 | acc=0.8375 | tpr=0.9595 | fpr=0.1647 | 6650.1 samples/s | 26.0 steps/s
[Step= 150] | Loss=0.32475 | acc=0.8358 | tpr=0.9640 | fpr=0.1666 | 6545.2 samples/s | 25.6 steps/s
[Step= 200] | Loss=0.32619 | acc=0.8368 | tpr=0.9650 | fpr=0.1656 | 6817.7 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.32738 | acc=0.8356 | tpr=0.9659 | fpr=0.1668 | 6454.7 samples/s | 25.2 steps/s
[Step= 300] | Loss=0.32911 | acc=0.8353 | tpr=0.9665 | fpr=0.1671 | 6498.2 samples/s | 25.4 steps/s
[Step= 350] | Loss=0.32984 | acc=0.8360 | tpr=0.9687 | fpr=0.1664 | 6567.8 samples/s | 25.7 steps/s
[Step= 400] | Loss=0.33189 | acc=0.8353 | tpr=0.9699 | fpr=0.1671 | 6539.3 samples/s | 25.5 steps/s
[Step= 450] | Loss=0.33352 | acc=0.8347 | tpr=0.9698 | fpr=0.1677 | 6565.7 samples/s | 25.6 steps/s
[Step= 500] | Loss=0.33345 | acc=0.8347 | tpr=0.9692 | fpr=0.1677 | 6443.5 samples/s | 25.2 steps/s
[Step= 550] | Loss=0.33204 | acc=0.8349 | tpr=0.9678 | fpr=0.1675 | 12020.0 samples/s | 47.0 steps/s
Avg test loss: 0.33192, Avg test acc: 0.83489, Avg tpr: 0.96751, Avg fpr: 0.16752, total FA: 23260

server round 26/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=17.2] | Loss=0.18396 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.632 | 3267.7 samples/s | 51.1 steps/s
[Step=8850 Epoch=17.3] | Loss=0.04199 | Reg=0.00058 | acc=0.9531 | FP-Norm=0.727 | FP-Norm(final)=2.623 | 3580.9 samples/s | 56.0 steps/s
[Step=8900 Epoch=17.4] | Loss=0.03096 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.769 | FP-Norm(final)=2.623 | 3686.1 samples/s | 57.6 steps/s
[Step=8950 Epoch=17.5] | Loss=0.02630 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.625 | 3706.5 samples/s | 57.9 steps/s
[Step=9000 Epoch=17.6] | Loss=0.02441 | Reg=0.00061 | acc=0.9531 | FP-Norm=0.775 | FP-Norm(final)=2.626 | 3723.7 samples/s | 58.2 steps/s
[Step=9050 Epoch=17.7] | Loss=0.02279 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.628 | 3663.3 samples/s | 57.2 steps/s
[Step=9100 Epoch=17.7] | Loss=0.02177 | Reg=0.00061 | acc=0.9844 | FP-Norm=0.776 | FP-Norm(final)=2.630 | 3685.6 samples/s | 57.6 steps/s
[Step=9150 Epoch=17.8] | Loss=0.02127 | Reg=0.00061 | acc=0.9688 | FP-Norm=0.777 | FP-Norm(final)=2.632 | 3684.4 samples/s | 57.6 steps/s
[Step=9200 Epoch=17.9] | Loss=0.02067 | Reg=0.00061 | acc=0.9844 | FP-Norm=0.780 | FP-Norm(final)=2.633 | 3662.1 samples/s | 57.2 steps/s
[Step=9250 Epoch=18.0] | Loss=0.01989 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.782 | FP-Norm(final)=2.635 | 3711.1 samples/s | 58.0 steps/s
[Step=9300 Epoch=18.1] | Loss=0.01900 | Reg=0.00062 | acc=0.9688 | FP-Norm=0.783 | FP-Norm(final)=2.636 | 4412.1 samples/s | 68.9 steps/s
[Step=9350 Epoch=18.2] | Loss=0.01863 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.638 | 1579.0 samples/s | 24.7 steps/s
[Step=9400 Epoch=18.3] | Loss=0.01810 | Reg=0.00062 | acc=0.9531 | FP-Norm=0.787 | FP-Norm(final)=2.639 | 3684.3 samples/s | 57.6 steps/s
[Step=9450 Epoch=18.4] | Loss=0.01739 | Reg=0.00063 | acc=0.9844 | FP-Norm=0.789 | FP-Norm(final)=2.641 | 3614.8 samples/s | 56.5 steps/s
[Step=9500 Epoch=18.5] | Loss=0.01692 | Reg=0.00063 | acc=0.9844 | FP-Norm=0.791 | FP-Norm(final)=2.642 | 3636.1 samples/s | 56.8 steps/s
[Step=9550 Epoch=18.6] | Loss=0.01676 | Reg=0.00063 | acc=0.9688 | FP-Norm=0.793 | FP-Norm(final)=2.644 | 3689.6 samples/s | 57.6 steps/s
[Step=9600 Epoch=18.7] | Loss=0.01638 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.796 | FP-Norm(final)=2.645 | 3655.9 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step9600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=46.0] | Loss=0.13344 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.633 | 3501.8 samples/s | 54.7 steps/s
[Step=12050 Epoch=46.2] | Loss=0.00500 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.910 | FP-Norm(final)=2.640 | 3201.3 samples/s | 50.0 steps/s
[Step=12100 Epoch=46.4] | Loss=0.00273 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.958 | FP-Norm(final)=2.642 | 3474.9 samples/s | 54.3 steps/s
[Step=12150 Epoch=46.6] | Loss=0.00185 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.946 | FP-Norm(final)=2.643 | 3480.2 samples/s | 54.4 steps/s
[Step=12200 Epoch=46.7] | Loss=0.00144 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.927 | FP-Norm(final)=2.644 | 3444.8 samples/s | 53.8 steps/s
[Step=12250 Epoch=46.9] | Loss=0.00119 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.908 | FP-Norm(final)=2.645 | 4250.8 samples/s | 66.4 steps/s
[Step=12300 Epoch=47.1] | Loss=0.00101 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.893 | FP-Norm(final)=2.646 | 1533.6 samples/s | 24.0 steps/s
[Step=12350 Epoch=47.3] | Loss=0.00087 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.646 | 3434.7 samples/s | 53.7 steps/s
[Step=12400 Epoch=47.5] | Loss=0.00076 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.862 | FP-Norm(final)=2.647 | 3487.8 samples/s | 54.5 steps/s
[Step=12450 Epoch=47.7] | Loss=0.00068 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.847 | FP-Norm(final)=2.647 | 3525.6 samples/s | 55.1 steps/s
[Step=12500 Epoch=47.9] | Loss=0.00062 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.833 | FP-Norm(final)=2.647 | 3863.4 samples/s | 60.4 steps/s
[Step=12550 Epoch=48.1] | Loss=0.00056 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.648 | 1598.3 samples/s | 25.0 steps/s
[Step=12600 Epoch=48.3] | Loss=0.00052 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.648 | 3550.8 samples/s | 55.5 steps/s
[Step=12650 Epoch=48.5] | Loss=0.00048 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.795 | FP-Norm(final)=2.648 | 3506.6 samples/s | 54.8 steps/s
[Step=12700 Epoch=48.7] | Loss=0.00045 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.783 | FP-Norm(final)=2.648 | 3535.9 samples/s | 55.2 steps/s
[Step=12750 Epoch=48.9] | Loss=0.00042 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.649 | 3468.2 samples/s | 54.2 steps/s
[Step=12800 Epoch=49.0] | Loss=0.00040 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.649 | 1674.3 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38233 | acc=0.7536 | tpr=0.6459 | fpr=0.0126 | 3481.0 samples/s | 13.6 steps/s
Avg test loss: 0.38628, Avg test acc: 0.75186, Avg tpr: 0.64475, Avg fpr: 0.01256, total FA: 98

Testing server on iccad2012
[Step=  50] | Loss=0.30789 | acc=0.8461 | tpr=0.9735 | fpr=0.1562 | 3484.4 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.31436 | acc=0.8446 | tpr=0.9616 | fpr=0.1575 | 6573.9 samples/s | 25.7 steps/s
[Step= 150] | Loss=0.32285 | acc=0.8420 | tpr=0.9640 | fpr=0.1602 | 6597.9 samples/s | 25.8 steps/s
[Step= 200] | Loss=0.32404 | acc=0.8424 | tpr=0.9650 | fpr=0.1598 | 6725.1 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.32532 | acc=0.8411 | tpr=0.9651 | fpr=0.1612 | 6881.6 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.32698 | acc=0.8403 | tpr=0.9658 | fpr=0.1620 | 6438.6 samples/s | 25.2 steps/s
[Step= 350] | Loss=0.32789 | acc=0.8409 | tpr=0.9681 | fpr=0.1614 | 6622.4 samples/s | 25.9 steps/s
[Step= 400] | Loss=0.32987 | acc=0.8401 | tpr=0.9688 | fpr=0.1622 | 6242.8 samples/s | 24.4 steps/s
[Step= 450] | Loss=0.33169 | acc=0.8394 | tpr=0.9688 | fpr=0.1630 | 6727.9 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.33158 | acc=0.8395 | tpr=0.9678 | fpr=0.1628 | 5548.2 samples/s | 21.7 steps/s
[Step= 550] | Loss=0.33008 | acc=0.8398 | tpr=0.9654 | fpr=0.1625 | 12488.1 samples/s | 48.8 steps/s
Avg test loss: 0.32994, Avg test acc: 0.83979, Avg tpr: 0.96513, Avg fpr: 0.16249, total FA: 22561

server round 27/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=18.7] | Loss=0.26521 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.647 | 3353.1 samples/s | 52.4 steps/s
[Step=9650 Epoch=18.8] | Loss=0.03974 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.728 | FP-Norm(final)=2.636 | 3506.0 samples/s | 54.8 steps/s
[Step=9700 Epoch=18.9] | Loss=0.02727 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.756 | FP-Norm(final)=2.637 | 3634.4 samples/s | 56.8 steps/s
[Step=9750 Epoch=19.0] | Loss=0.02336 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.754 | FP-Norm(final)=2.639 | 3618.6 samples/s | 56.5 steps/s
[Step=9800 Epoch=19.1] | Loss=0.02133 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.752 | FP-Norm(final)=2.641 | 3634.3 samples/s | 56.8 steps/s
[Step=9850 Epoch=19.2] | Loss=0.01990 | Reg=0.00057 | acc=0.9531 | FP-Norm=0.750 | FP-Norm(final)=2.644 | 3649.0 samples/s | 57.0 steps/s
[Step=9900 Epoch=19.3] | Loss=0.01920 | Reg=0.00057 | acc=0.9844 | FP-Norm=0.748 | FP-Norm(final)=2.646 | 3698.5 samples/s | 57.8 steps/s
[Step=9950 Epoch=19.4] | Loss=0.01860 | Reg=0.00057 | acc=0.9688 | FP-Norm=0.749 | FP-Norm(final)=2.648 | 3705.6 samples/s | 57.9 steps/s
[Step=10000 Epoch=19.5] | Loss=0.01839 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.752 | FP-Norm(final)=2.649 | 3692.6 samples/s | 57.7 steps/s
[Step=10050 Epoch=19.6] | Loss=0.01829 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.753 | FP-Norm(final)=2.650 | 3704.4 samples/s | 57.9 steps/s
[Step=10100 Epoch=19.7] | Loss=0.01860 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.757 | FP-Norm(final)=2.651 | 4406.1 samples/s | 68.8 steps/s
[Step=10150 Epoch=19.8] | Loss=0.01822 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.761 | FP-Norm(final)=2.652 | 1574.0 samples/s | 24.6 steps/s
[Step=10200 Epoch=19.9] | Loss=0.01758 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.652 | 3628.8 samples/s | 56.7 steps/s
[Step=10250 Epoch=20.0] | Loss=0.01719 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.767 | FP-Norm(final)=2.653 | 3656.8 samples/s | 57.1 steps/s
[Step=10300 Epoch=20.1] | Loss=0.01703 | Reg=0.00060 | acc=0.9688 | FP-Norm=0.770 | FP-Norm(final)=2.654 | 3615.0 samples/s | 56.5 steps/s
[Step=10350 Epoch=20.2] | Loss=0.01662 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.772 | FP-Norm(final)=2.655 | 3629.3 samples/s | 56.7 steps/s
[Step=10400 Epoch=20.3] | Loss=0.01633 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.775 | FP-Norm(final)=2.656 | 3648.8 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step10400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12801 Epoch=49.0] | Loss=0.06471 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.649 | 3492.8 samples/s | 54.6 steps/s
[Step=12850 Epoch=49.2] | Loss=0.00305 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.808 | FP-Norm(final)=2.659 | 3199.6 samples/s | 50.0 steps/s
[Step=12900 Epoch=49.4] | Loss=0.00160 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.844 | FP-Norm(final)=2.661 | 3443.0 samples/s | 53.8 steps/s
[Step=12950 Epoch=49.6] | Loss=0.00112 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.834 | FP-Norm(final)=2.662 | 3461.2 samples/s | 54.1 steps/s
[Step=13000 Epoch=49.8] | Loss=0.00086 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.817 | FP-Norm(final)=2.663 | 3450.0 samples/s | 53.9 steps/s
[Step=13050 Epoch=50.0] | Loss=0.00069 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.799 | FP-Norm(final)=2.664 | 4242.8 samples/s | 66.3 steps/s
[Step=13100 Epoch=50.2] | Loss=0.00058 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.782 | FP-Norm(final)=2.664 | 1552.9 samples/s | 24.3 steps/s
[Step=13150 Epoch=50.4] | Loss=0.00050 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.665 | 3485.7 samples/s | 54.5 steps/s
[Step=13200 Epoch=50.6] | Loss=0.00044 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.750 | FP-Norm(final)=2.665 | 3530.4 samples/s | 55.2 steps/s
[Step=13250 Epoch=50.8] | Loss=0.00040 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.735 | FP-Norm(final)=2.665 | 3516.3 samples/s | 54.9 steps/s
[Step=13300 Epoch=51.0] | Loss=0.00036 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.721 | FP-Norm(final)=2.665 | 3764.4 samples/s | 58.8 steps/s
[Step=13350 Epoch=51.2] | Loss=0.00033 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.709 | FP-Norm(final)=2.666 | 1610.3 samples/s | 25.2 steps/s
[Step=13400 Epoch=51.3] | Loss=0.00031 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.697 | FP-Norm(final)=2.666 | 3501.8 samples/s | 54.7 steps/s
[Step=13450 Epoch=51.5] | Loss=0.00029 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.666 | 3491.7 samples/s | 54.6 steps/s
[Step=13500 Epoch=51.7] | Loss=0.00027 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.675 | FP-Norm(final)=2.666 | 3469.5 samples/s | 54.2 steps/s
[Step=13550 Epoch=51.9] | Loss=0.00025 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.665 | FP-Norm(final)=2.666 | 3484.4 samples/s | 54.4 steps/s
[Step=13600 Epoch=52.1] | Loss=0.00024 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.655 | FP-Norm(final)=2.666 | 1693.7 samples/s | 26.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36377 | acc=0.7666 | tpr=0.6650 | fpr=0.0129 | 3503.2 samples/s | 13.7 steps/s
Avg test loss: 0.36764, Avg test acc: 0.76533, Avg tpr: 0.66428, Avg fpr: 0.01243, total FA: 97

Testing server on iccad2012
[Step=  50] | Loss=0.33124 | acc=0.8330 | tpr=0.9735 | fpr=0.1696 | 3486.7 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.33763 | acc=0.8305 | tpr=0.9595 | fpr=0.1719 | 6461.2 samples/s | 25.2 steps/s
[Step= 150] | Loss=0.34603 | acc=0.8271 | tpr=0.9611 | fpr=0.1754 | 6597.9 samples/s | 25.8 steps/s
[Step= 200] | Loss=0.34735 | acc=0.8279 | tpr=0.9628 | fpr=0.1745 | 6589.1 samples/s | 25.7 steps/s
[Step= 250] | Loss=0.34870 | acc=0.8269 | tpr=0.9642 | fpr=0.1756 | 6433.6 samples/s | 25.1 steps/s
[Step= 300] | Loss=0.35019 | acc=0.8262 | tpr=0.9651 | fpr=0.1763 | 6277.6 samples/s | 24.5 steps/s
[Step= 350] | Loss=0.35081 | acc=0.8268 | tpr=0.9668 | fpr=0.1758 | 4348.9 samples/s | 17.0 steps/s
[Step= 400] | Loss=0.35301 | acc=0.8258 | tpr=0.9677 | fpr=0.1768 | 6521.2 samples/s | 25.5 steps/s
[Step= 450] | Loss=0.35486 | acc=0.8250 | tpr=0.9674 | fpr=0.1776 | 6213.3 samples/s | 24.3 steps/s
[Step= 500] | Loss=0.35487 | acc=0.8250 | tpr=0.9670 | fpr=0.1776 | 6469.7 samples/s | 25.3 steps/s
[Step= 550] | Loss=0.35337 | acc=0.8252 | tpr=0.9646 | fpr=0.1773 | 10141.9 samples/s | 39.6 steps/s
Avg test loss: 0.35325, Avg test acc: 0.82523, Avg tpr: 0.96434, Avg fpr: 0.17729, total FA: 24617

server round 28/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=20.3] | Loss=0.12489 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.652 | 3236.4 samples/s | 50.6 steps/s
[Step=10450 Epoch=20.4] | Loss=0.02998 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.642 | FP-Norm(final)=2.646 | 3565.3 samples/s | 55.7 steps/s
[Step=10500 Epoch=20.5] | Loss=0.02384 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.672 | FP-Norm(final)=2.648 | 3691.3 samples/s | 57.7 steps/s
[Step=10550 Epoch=20.6] | Loss=0.02155 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.685 | FP-Norm(final)=2.649 | 3728.9 samples/s | 58.3 steps/s
[Step=10600 Epoch=20.7] | Loss=0.02169 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.697 | FP-Norm(final)=2.650 | 3689.9 samples/s | 57.7 steps/s
[Step=10650 Epoch=20.8] | Loss=0.02034 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.702 | FP-Norm(final)=2.651 | 3729.3 samples/s | 58.3 steps/s
[Step=10700 Epoch=20.9] | Loss=0.01957 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.705 | FP-Norm(final)=2.651 | 3720.7 samples/s | 58.1 steps/s
[Step=10750 Epoch=21.0] | Loss=0.01901 | Reg=0.00051 | acc=0.9844 | FP-Norm=0.708 | FP-Norm(final)=2.652 | 3720.9 samples/s | 58.1 steps/s
[Step=10800 Epoch=21.1] | Loss=0.01864 | Reg=0.00051 | acc=0.9844 | FP-Norm=0.712 | FP-Norm(final)=2.653 | 3725.3 samples/s | 58.2 steps/s
[Step=10850 Epoch=21.2] | Loss=0.01811 | Reg=0.00052 | acc=0.9844 | FP-Norm=0.717 | FP-Norm(final)=2.654 | 3708.8 samples/s | 57.9 steps/s
[Step=10900 Epoch=21.3] | Loss=0.01795 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.723 | FP-Norm(final)=2.655 | 4405.6 samples/s | 68.8 steps/s
[Step=10950 Epoch=21.4] | Loss=0.01765 | Reg=0.00053 | acc=0.9844 | FP-Norm=0.727 | FP-Norm(final)=2.656 | 1572.3 samples/s | 24.6 steps/s
[Step=11000 Epoch=21.5] | Loss=0.01716 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.730 | FP-Norm(final)=2.656 | 3610.7 samples/s | 56.4 steps/s
[Step=11050 Epoch=21.6] | Loss=0.01669 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.733 | FP-Norm(final)=2.657 | 3660.7 samples/s | 57.2 steps/s
[Step=11100 Epoch=21.6] | Loss=0.01640 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.736 | FP-Norm(final)=2.658 | 3722.7 samples/s | 58.2 steps/s
[Step=11150 Epoch=21.7] | Loss=0.01605 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.740 | FP-Norm(final)=2.659 | 3618.0 samples/s | 56.5 steps/s
[Step=11200 Epoch=21.8] | Loss=0.01572 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.743 | FP-Norm(final)=2.660 | 3474.5 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step11200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=40.0] | Loss=0.08102 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.653 | 3397.4 samples/s | 53.1 steps/s
[Step=10450 Epoch=40.2] | Loss=0.00674 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.918 | FP-Norm(final)=2.657 | 3302.0 samples/s | 51.6 steps/s
[Step=10500 Epoch=40.4] | Loss=0.00361 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.983 | FP-Norm(final)=2.659 | 3455.7 samples/s | 54.0 steps/s
[Step=10550 Epoch=40.6] | Loss=0.00245 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.977 | FP-Norm(final)=2.660 | 3425.3 samples/s | 53.5 steps/s
[Step=10600 Epoch=40.8] | Loss=0.00186 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.959 | FP-Norm(final)=2.662 | 3478.7 samples/s | 54.4 steps/s
[Step=10650 Epoch=41.0] | Loss=0.00157 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.943 | FP-Norm(final)=2.663 | 4329.5 samples/s | 67.6 steps/s
[Step=10700 Epoch=41.2] | Loss=0.00132 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.926 | FP-Norm(final)=2.664 | 1561.5 samples/s | 24.4 steps/s
[Step=10750 Epoch=41.4] | Loss=0.00114 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.910 | FP-Norm(final)=2.665 | 3473.8 samples/s | 54.3 steps/s
[Step=10800 Epoch=41.6] | Loss=0.00100 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.894 | FP-Norm(final)=2.665 | 3437.1 samples/s | 53.7 steps/s
[Step=10850 Epoch=41.8] | Loss=0.00089 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.879 | FP-Norm(final)=2.666 | 3504.7 samples/s | 54.8 steps/s
[Step=10900 Epoch=42.0] | Loss=0.00082 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.867 | FP-Norm(final)=2.667 | 3855.2 samples/s | 60.2 steps/s
[Step=10950 Epoch=42.2] | Loss=0.00075 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.854 | FP-Norm(final)=2.667 | 1599.4 samples/s | 25.0 steps/s
[Step=11000 Epoch=42.3] | Loss=0.00069 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.842 | FP-Norm(final)=2.667 | 3414.3 samples/s | 53.3 steps/s
[Step=11050 Epoch=42.5] | Loss=0.00064 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.830 | FP-Norm(final)=2.668 | 3453.4 samples/s | 54.0 steps/s
[Step=11100 Epoch=42.7] | Loss=0.00059 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.819 | FP-Norm(final)=2.668 | 3482.6 samples/s | 54.4 steps/s
[Step=11150 Epoch=42.9] | Loss=0.00056 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.669 | 3485.4 samples/s | 54.5 steps/s
[Step=11200 Epoch=43.1] | Loss=0.00052 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.669 | 1671.5 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32601 | acc=0.7918 | tpr=0.7023 | fpr=0.0139 | 3511.4 samples/s | 13.7 steps/s
Avg test loss: 0.32944, Avg test acc: 0.79053, Avg tpr: 0.70152, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.37230 | acc=0.8129 | tpr=0.9735 | fpr=0.1900 | 3540.5 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.37881 | acc=0.8097 | tpr=0.9616 | fpr=0.1931 | 6599.9 samples/s | 25.8 steps/s
[Step= 150] | Loss=0.38735 | acc=0.8070 | tpr=0.9625 | fpr=0.1959 | 6648.1 samples/s | 26.0 steps/s
[Step= 200] | Loss=0.38874 | acc=0.8077 | tpr=0.9628 | fpr=0.1951 | 6707.4 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.39006 | acc=0.8062 | tpr=0.9642 | fpr=0.1967 | 6608.1 samples/s | 25.8 steps/s
[Step= 300] | Loss=0.39179 | acc=0.8057 | tpr=0.9651 | fpr=0.1973 | 6651.0 samples/s | 26.0 steps/s
[Step= 350] | Loss=0.39239 | acc=0.8061 | tpr=0.9668 | fpr=0.1968 | 6536.5 samples/s | 25.5 steps/s
[Step= 400] | Loss=0.39488 | acc=0.8050 | tpr=0.9688 | fpr=0.1980 | 4097.1 samples/s | 16.0 steps/s
[Step= 450] | Loss=0.39702 | acc=0.8043 | tpr=0.9688 | fpr=0.1986 | 6573.0 samples/s | 25.7 steps/s
[Step= 500] | Loss=0.39711 | acc=0.8043 | tpr=0.9687 | fpr=0.1987 | 6654.1 samples/s | 26.0 steps/s
[Step= 550] | Loss=0.39563 | acc=0.8045 | tpr=0.9662 | fpr=0.1985 | 11618.3 samples/s | 45.4 steps/s
Avg test loss: 0.39549, Avg test acc: 0.80445, Avg tpr: 0.96593, Avg fpr: 0.19848, total FA: 27559

server round 29/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=20.3] | Loss=0.12610 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.660 | 3506.9 samples/s | 54.8 steps/s
[Step=10450 Epoch=20.4] | Loss=0.03699 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.726 | FP-Norm(final)=2.649 | 3560.3 samples/s | 55.6 steps/s
[Step=10500 Epoch=20.5] | Loss=0.02832 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.758 | FP-Norm(final)=2.648 | 3690.0 samples/s | 57.7 steps/s
[Step=10550 Epoch=20.6] | Loss=0.02351 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.752 | FP-Norm(final)=2.649 | 3719.9 samples/s | 58.1 steps/s
[Step=10600 Epoch=20.7] | Loss=0.02141 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.744 | FP-Norm(final)=2.650 | 3685.6 samples/s | 57.6 steps/s
[Step=10650 Epoch=20.8] | Loss=0.01979 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.738 | FP-Norm(final)=2.651 | 3707.2 samples/s | 57.9 steps/s
[Step=10700 Epoch=20.9] | Loss=0.01920 | Reg=0.00055 | acc=0.9688 | FP-Norm=0.734 | FP-Norm(final)=2.652 | 3720.2 samples/s | 58.1 steps/s
[Step=10750 Epoch=21.0] | Loss=0.01881 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.732 | FP-Norm(final)=2.653 | 3668.2 samples/s | 57.3 steps/s
[Step=10800 Epoch=21.1] | Loss=0.01795 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.731 | FP-Norm(final)=2.654 | 3728.2 samples/s | 58.3 steps/s
[Step=10850 Epoch=21.2] | Loss=0.01719 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.731 | FP-Norm(final)=2.655 | 3699.8 samples/s | 57.8 steps/s
[Step=10900 Epoch=21.3] | Loss=0.01717 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.731 | FP-Norm(final)=2.656 | 4460.2 samples/s | 69.7 steps/s
[Step=10950 Epoch=21.4] | Loss=0.01682 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.733 | FP-Norm(final)=2.657 | 1607.7 samples/s | 25.1 steps/s
[Step=11000 Epoch=21.5] | Loss=0.01647 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.736 | FP-Norm(final)=2.658 | 3665.4 samples/s | 57.3 steps/s
[Step=11050 Epoch=21.6] | Loss=0.01598 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.738 | FP-Norm(final)=2.659 | 3687.8 samples/s | 57.6 steps/s
[Step=11100 Epoch=21.7] | Loss=0.01553 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.740 | FP-Norm(final)=2.660 | 3643.9 samples/s | 56.9 steps/s
[Step=11150 Epoch=21.8] | Loss=0.01526 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.742 | FP-Norm(final)=2.661 | 3633.2 samples/s | 56.8 steps/s
[Step=11200 Epoch=21.9] | Loss=0.01511 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.744 | FP-Norm(final)=2.662 | 3656.6 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step11200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=13601 Epoch=52.1] | Loss=0.09008 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.661 | 3404.3 samples/s | 53.2 steps/s
[Step=13650 Epoch=52.3] | Loss=0.00905 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.079 | FP-Norm(final)=2.665 | 3372.2 samples/s | 52.7 steps/s
[Step=13700 Epoch=52.5] | Loss=0.00471 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.172 | FP-Norm(final)=2.663 | 3502.6 samples/s | 54.7 steps/s
[Step=13750 Epoch=52.7] | Loss=0.00317 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.169 | FP-Norm(final)=2.664 | 3454.0 samples/s | 54.0 steps/s
[Step=13800 Epoch=52.9] | Loss=0.00242 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.152 | FP-Norm(final)=2.664 | 3436.0 samples/s | 53.7 steps/s
[Step=13850 Epoch=53.1] | Loss=0.00196 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.132 | FP-Norm(final)=2.664 | 4230.1 samples/s | 66.1 steps/s
[Step=13900 Epoch=53.3] | Loss=0.00164 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.112 | FP-Norm(final)=2.665 | 1568.5 samples/s | 24.5 steps/s
[Step=13950 Epoch=53.5] | Loss=0.00141 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.092 | FP-Norm(final)=2.665 | 3491.9 samples/s | 54.6 steps/s
[Step=14000 Epoch=53.6] | Loss=0.00124 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.074 | FP-Norm(final)=2.666 | 3480.4 samples/s | 54.4 steps/s
[Step=14050 Epoch=53.8] | Loss=0.00111 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.056 | FP-Norm(final)=2.666 | 3477.2 samples/s | 54.3 steps/s
[Step=14100 Epoch=54.0] | Loss=0.00100 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.039 | FP-Norm(final)=2.667 | 3700.3 samples/s | 57.8 steps/s
[Step=14150 Epoch=54.2] | Loss=0.00091 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.024 | FP-Norm(final)=2.667 | 1586.9 samples/s | 24.8 steps/s
[Step=14200 Epoch=54.4] | Loss=0.00084 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.009 | FP-Norm(final)=2.667 | 3476.7 samples/s | 54.3 steps/s
[Step=14250 Epoch=54.6] | Loss=0.00078 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.994 | FP-Norm(final)=2.668 | 3440.7 samples/s | 53.8 steps/s
[Step=14300 Epoch=54.8] | Loss=0.00072 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.980 | FP-Norm(final)=2.668 | 3489.9 samples/s | 54.5 steps/s
[Step=14350 Epoch=55.0] | Loss=0.00068 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.967 | FP-Norm(final)=2.668 | 3480.3 samples/s | 54.4 steps/s
[Step=14400 Epoch=55.2] | Loss=0.00064 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.954 | FP-Norm(final)=2.669 | 1682.8 samples/s | 26.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33638 | acc=0.7837 | tpr=0.6910 | fpr=0.0151 | 3459.7 samples/s | 13.5 steps/s
Avg test loss: 0.34080, Avg test acc: 0.78263, Avg tpr: 0.69039, Avg fpr: 0.01449, total FA: 113

Testing server on iccad2012
[Step=  50] | Loss=0.35728 | acc=0.8198 | tpr=0.9735 | fpr=0.1829 | 3533.6 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.36395 | acc=0.8176 | tpr=0.9616 | fpr=0.1851 | 4014.0 samples/s | 15.7 steps/s
[Step= 150] | Loss=0.37215 | acc=0.8156 | tpr=0.9640 | fpr=0.1872 | 6359.7 samples/s | 24.8 steps/s
[Step= 200] | Loss=0.37369 | acc=0.8169 | tpr=0.9650 | fpr=0.1858 | 6596.8 samples/s | 25.8 steps/s
[Step= 250] | Loss=0.37472 | acc=0.8157 | tpr=0.9677 | fpr=0.1870 | 6642.0 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.37621 | acc=0.8154 | tpr=0.9680 | fpr=0.1874 | 6644.4 samples/s | 26.0 steps/s
[Step= 350] | Loss=0.37691 | acc=0.8159 | tpr=0.9687 | fpr=0.1869 | 6492.0 samples/s | 25.4 steps/s
[Step= 400] | Loss=0.37923 | acc=0.8148 | tpr=0.9699 | fpr=0.1880 | 6539.3 samples/s | 25.5 steps/s
[Step= 450] | Loss=0.38121 | acc=0.8142 | tpr=0.9698 | fpr=0.1887 | 6305.9 samples/s | 24.6 steps/s
[Step= 500] | Loss=0.38130 | acc=0.8142 | tpr=0.9696 | fpr=0.1886 | 6670.4 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.37979 | acc=0.8148 | tpr=0.9670 | fpr=0.1880 | 12060.7 samples/s | 47.1 steps/s
Avg test loss: 0.37960, Avg test acc: 0.81480, Avg tpr: 0.96672, Avg fpr: 0.18796, total FA: 26098

server round 30/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=11201 Epoch=21.8] | Loss=0.19177 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.674 | 3414.6 samples/s | 53.4 steps/s
[Step=11250 Epoch=21.9] | Loss=0.04174 | Reg=0.00029 | acc=0.9531 | FP-Norm=0.515 | FP-Norm(final)=2.668 | 3485.4 samples/s | 54.5 steps/s
[Step=11300 Epoch=22.0] | Loss=0.02883 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.668 | 3704.2 samples/s | 57.9 steps/s
[Step=11350 Epoch=22.1] | Loss=0.02381 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.669 | 3679.0 samples/s | 57.5 steps/s
[Step=11400 Epoch=22.2] | Loss=0.02158 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.670 | 3692.9 samples/s | 57.7 steps/s
[Step=11450 Epoch=22.3] | Loss=0.01990 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.671 | 3688.5 samples/s | 57.6 steps/s
[Step=11500 Epoch=22.4] | Loss=0.01822 | Reg=0.00032 | acc=0.9844 | FP-Norm=0.563 | FP-Norm(final)=2.673 | 3702.1 samples/s | 57.8 steps/s
[Step=11550 Epoch=22.5] | Loss=0.01712 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.674 | 3716.8 samples/s | 58.1 steps/s
[Step=11600 Epoch=22.6] | Loss=0.01622 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=2.675 | 3654.3 samples/s | 57.1 steps/s
[Step=11650 Epoch=22.7] | Loss=0.01561 | Reg=0.00031 | acc=0.9531 | FP-Norm=0.557 | FP-Norm(final)=2.677 | 3607.3 samples/s | 56.4 steps/s
[Step=11700 Epoch=22.8] | Loss=0.01505 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.556 | FP-Norm(final)=2.678 | 4356.3 samples/s | 68.1 steps/s
[Step=11750 Epoch=22.9] | Loss=0.01454 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.679 | 1577.8 samples/s | 24.7 steps/s
[Step=11800 Epoch=23.0] | Loss=0.01420 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.681 | 3674.7 samples/s | 57.4 steps/s
[Step=11850 Epoch=23.1] | Loss=0.01378 | Reg=0.00031 | acc=0.9688 | FP-Norm=0.555 | FP-Norm(final)=2.682 | 3627.6 samples/s | 56.7 steps/s
[Step=11900 Epoch=23.2] | Loss=0.01325 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.683 | 3625.5 samples/s | 56.6 steps/s
[Step=11950 Epoch=23.3] | Loss=0.01293 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.556 | FP-Norm(final)=2.685 | 3650.3 samples/s | 57.0 steps/s
[Step=12000 Epoch=23.4] | Loss=0.01271 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.557 | FP-Norm(final)=2.686 | 3576.2 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step12000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=11201 Epoch=43.1] | Loss=0.08432 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.675 | 3418.9 samples/s | 53.4 steps/s
[Step=11250 Epoch=43.3] | Loss=0.00624 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=2.680 | 3236.6 samples/s | 50.6 steps/s
[Step=11300 Epoch=43.5] | Loss=0.00325 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.646 | FP-Norm(final)=2.682 | 3497.8 samples/s | 54.7 steps/s
[Step=11350 Epoch=43.7] | Loss=0.00224 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.644 | FP-Norm(final)=2.682 | 3499.4 samples/s | 54.7 steps/s
[Step=11400 Epoch=43.9] | Loss=0.00175 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.636 | FP-Norm(final)=2.683 | 3519.6 samples/s | 55.0 steps/s
[Step=11450 Epoch=44.1] | Loss=0.00142 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.627 | FP-Norm(final)=2.684 | 4327.7 samples/s | 67.6 steps/s
[Step=11500 Epoch=44.3] | Loss=0.00120 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.618 | FP-Norm(final)=2.685 | 1550.4 samples/s | 24.2 steps/s
[Step=11550 Epoch=44.5] | Loss=0.00104 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=2.685 | 3498.3 samples/s | 54.7 steps/s
[Step=11600 Epoch=44.7] | Loss=0.00092 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.600 | FP-Norm(final)=2.686 | 3509.3 samples/s | 54.8 steps/s
[Step=11650 Epoch=44.8] | Loss=0.00082 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=2.686 | 3447.4 samples/s | 53.9 steps/s
[Step=11700 Epoch=45.0] | Loss=0.00075 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.585 | FP-Norm(final)=2.686 | 3845.2 samples/s | 60.1 steps/s
[Step=11750 Epoch=45.2] | Loss=0.00068 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=2.687 | 1608.8 samples/s | 25.1 steps/s
[Step=11800 Epoch=45.4] | Loss=0.00063 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.687 | 3510.2 samples/s | 54.8 steps/s
[Step=11850 Epoch=45.6] | Loss=0.00059 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.564 | FP-Norm(final)=2.687 | 3481.4 samples/s | 54.4 steps/s
[Step=11900 Epoch=45.8] | Loss=0.00055 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=2.688 | 3480.4 samples/s | 54.4 steps/s
[Step=11950 Epoch=46.0] | Loss=0.00052 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.688 | 3512.9 samples/s | 54.9 steps/s
[Step=12000 Epoch=46.2] | Loss=0.00049 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.688 | 1666.8 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38656 | acc=0.7588 | tpr=0.6540 | fpr=0.0139 | 3455.6 samples/s | 13.5 steps/s
Avg test loss: 0.39192, Avg test acc: 0.75795, Avg tpr: 0.65396, Avg fpr: 0.01333, total FA: 104

Testing server on iccad2012
[Step=  50] | Loss=0.33472 | acc=0.8373 | tpr=0.9735 | fpr=0.1651 | 3462.8 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.34092 | acc=0.8355 | tpr=0.9595 | fpr=0.1668 | 6786.5 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.34863 | acc=0.8339 | tpr=0.9640 | fpr=0.1685 | 4154.1 samples/s | 16.2 steps/s
[Step= 200] | Loss=0.35057 | acc=0.8342 | tpr=0.9639 | fpr=0.1682 | 6686.9 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.35144 | acc=0.8334 | tpr=0.9651 | fpr=0.1690 | 6329.7 samples/s | 24.7 steps/s
[Step= 300] | Loss=0.35270 | acc=0.8329 | tpr=0.9658 | fpr=0.1696 | 6693.3 samples/s | 26.1 steps/s
[Step= 350] | Loss=0.35356 | acc=0.8331 | tpr=0.9681 | fpr=0.1693 | 6582.1 samples/s | 25.7 steps/s
[Step= 400] | Loss=0.35593 | acc=0.8320 | tpr=0.9694 | fpr=0.1705 | 6654.3 samples/s | 26.0 steps/s
[Step= 450] | Loss=0.35782 | acc=0.8313 | tpr=0.9688 | fpr=0.1712 | 6397.2 samples/s | 25.0 steps/s
[Step= 500] | Loss=0.35783 | acc=0.8313 | tpr=0.9683 | fpr=0.1712 | 6445.0 samples/s | 25.2 steps/s
[Step= 550] | Loss=0.35631 | acc=0.8318 | tpr=0.9662 | fpr=0.1706 | 11988.5 samples/s | 46.8 steps/s
Avg test loss: 0.35610, Avg test acc: 0.83184, Avg tpr: 0.96593, Avg fpr: 0.17060, total FA: 23687

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=23.4] | Loss=0.30516 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.686 | 3247.2 samples/s | 50.7 steps/s
[Step=12050 Epoch=23.5] | Loss=0.03927 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.522 | FP-Norm(final)=2.680 | 3609.9 samples/s | 56.4 steps/s
[Step=12100 Epoch=23.6] | Loss=0.02618 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.680 | 3710.5 samples/s | 58.0 steps/s
[Step=12150 Epoch=23.7] | Loss=0.02170 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.682 | 3738.7 samples/s | 58.4 steps/s
[Step=12200 Epoch=23.8] | Loss=0.01894 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.683 | 3714.2 samples/s | 58.0 steps/s
[Step=12250 Epoch=23.9] | Loss=0.01754 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.552 | FP-Norm(final)=2.685 | 3743.6 samples/s | 58.5 steps/s
[Step=12300 Epoch=24.0] | Loss=0.01656 | Reg=0.00031 | acc=0.9688 | FP-Norm=0.552 | FP-Norm(final)=2.686 | 3618.8 samples/s | 56.5 steps/s
[Step=12350 Epoch=24.1] | Loss=0.01620 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.553 | FP-Norm(final)=2.688 | 3659.0 samples/s | 57.2 steps/s
[Step=12400 Epoch=24.2] | Loss=0.01587 | Reg=0.00031 | acc=0.9688 | FP-Norm=0.554 | FP-Norm(final)=2.689 | 3639.4 samples/s | 56.9 steps/s
[Step=12450 Epoch=24.3] | Loss=0.01541 | Reg=0.00031 | acc=0.9531 | FP-Norm=0.555 | FP-Norm(final)=2.690 | 3654.6 samples/s | 57.1 steps/s
[Step=12500 Epoch=24.4] | Loss=0.01498 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.691 | 4401.8 samples/s | 68.8 steps/s
[Step=12550 Epoch=24.5] | Loss=0.01439 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=2.692 | 1576.7 samples/s | 24.6 steps/s
[Step=12600 Epoch=24.6] | Loss=0.01381 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=2.694 | 3613.7 samples/s | 56.5 steps/s
[Step=12650 Epoch=24.7] | Loss=0.01336 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.695 | 3674.4 samples/s | 57.4 steps/s
[Step=12700 Epoch=24.8] | Loss=0.01319 | Reg=0.00032 | acc=0.9844 | FP-Norm=0.560 | FP-Norm(final)=2.696 | 3714.5 samples/s | 58.0 steps/s
[Step=12750 Epoch=24.9] | Loss=0.01289 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.697 | 3627.7 samples/s | 56.7 steps/s
[Step=12800 Epoch=25.0] | Loss=0.01260 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.698 | 3658.3 samples/s | 57.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step12800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=11201 Epoch=21.9] | Loss=0.20124 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.687 | 3448.9 samples/s | 53.9 steps/s
[Step=11250 Epoch=22.0] | Loss=0.03149 | Reg=0.00022 | acc=0.9688 | FP-Norm=0.451 | FP-Norm(final)=2.682 | 3612.0 samples/s | 56.4 steps/s
[Step=11300 Epoch=22.1] | Loss=0.02232 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.487 | FP-Norm(final)=2.683 | 3644.8 samples/s | 57.0 steps/s
[Step=11350 Epoch=22.2] | Loss=0.01912 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=2.684 | 3698.3 samples/s | 57.8 steps/s
[Step=11400 Epoch=22.3] | Loss=0.01692 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=2.685 | 3699.8 samples/s | 57.8 steps/s
[Step=11450 Epoch=22.4] | Loss=0.01573 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.501 | FP-Norm(final)=2.687 | 3702.8 samples/s | 57.9 steps/s
[Step=11500 Epoch=22.5] | Loss=0.01503 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=2.688 | 3725.5 samples/s | 58.2 steps/s
[Step=11550 Epoch=22.6] | Loss=0.01452 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=2.689 | 3697.9 samples/s | 57.8 steps/s
[Step=11600 Epoch=22.7] | Loss=0.01386 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.504 | FP-Norm(final)=2.690 | 3625.5 samples/s | 56.6 steps/s
[Step=11650 Epoch=22.8] | Loss=0.01327 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=2.691 | 3675.5 samples/s | 57.4 steps/s
[Step=11700 Epoch=22.9] | Loss=0.01283 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.505 | FP-Norm(final)=2.692 | 4483.3 samples/s | 70.1 steps/s
[Step=11750 Epoch=23.0] | Loss=0.01240 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=2.693 | 1609.2 samples/s | 25.1 steps/s
[Step=11800 Epoch=23.1] | Loss=0.01195 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.507 | FP-Norm(final)=2.694 | 3634.2 samples/s | 56.8 steps/s
[Step=11850 Epoch=23.2] | Loss=0.01150 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=2.695 | 3708.9 samples/s | 58.0 steps/s
[Step=11900 Epoch=23.3] | Loss=0.01132 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.697 | 3690.4 samples/s | 57.7 steps/s
[Step=11950 Epoch=23.4] | Loss=0.01104 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=2.698 | 3699.5 samples/s | 57.8 steps/s
[Step=12000 Epoch=23.5] | Loss=0.01089 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.699 | 3654.1 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40915 | acc=0.7530 | tpr=0.6450 | fpr=0.0124 | 2996.5 samples/s | 11.7 steps/s
Avg test loss: 0.41533, Avg test acc: 0.75126, Avg tpr: 0.64394, Avg fpr: 0.01269, total FA: 99

Testing server on iccad2012
[Step=  50] | Loss=0.32644 | acc=0.8510 | tpr=0.9735 | fpr=0.1512 | 2686.5 samples/s | 10.5 steps/s
[Step= 100] | Loss=0.33309 | acc=0.8502 | tpr=0.9638 | fpr=0.1519 | 6468.2 samples/s | 25.3 steps/s
[Step= 150] | Loss=0.34150 | acc=0.8489 | tpr=0.9683 | fpr=0.1533 | 6502.1 samples/s | 25.4 steps/s
[Step= 200] | Loss=0.34380 | acc=0.8494 | tpr=0.9683 | fpr=0.1528 | 6763.2 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.34474 | acc=0.8485 | tpr=0.9703 | fpr=0.1537 | 6676.1 samples/s | 26.1 steps/s
[Step= 300] | Loss=0.34600 | acc=0.8481 | tpr=0.9702 | fpr=0.1541 | 6375.5 samples/s | 24.9 steps/s
[Step= 350] | Loss=0.34695 | acc=0.8485 | tpr=0.9718 | fpr=0.1538 | 6554.8 samples/s | 25.6 steps/s
[Step= 400] | Loss=0.34932 | acc=0.8474 | tpr=0.9732 | fpr=0.1549 | 6536.5 samples/s | 25.5 steps/s
[Step= 450] | Loss=0.35133 | acc=0.8470 | tpr=0.9737 | fpr=0.1553 | 6764.1 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.35139 | acc=0.8470 | tpr=0.9727 | fpr=0.1552 | 6132.8 samples/s | 24.0 steps/s
[Step= 550] | Loss=0.34978 | acc=0.8474 | tpr=0.9706 | fpr=0.1548 | 12574.4 samples/s | 49.1 steps/s
Avg test loss: 0.34952, Avg test acc: 0.84747, Avg tpr: 0.97029, Avg fpr: 0.15477, total FA: 21489

server round 32/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=55.2] | Loss=0.05320 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.699 | 3394.3 samples/s | 53.0 steps/s
[Step=14450 Epoch=55.4] | Loss=0.00659 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.701 | 3320.9 samples/s | 51.9 steps/s
[Step=14500 Epoch=55.6] | Loss=0.00359 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.606 | FP-Norm(final)=2.702 | 3505.2 samples/s | 54.8 steps/s
[Step=14550 Epoch=55.8] | Loss=0.00243 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.614 | FP-Norm(final)=2.703 | 3487.4 samples/s | 54.5 steps/s
[Step=14600 Epoch=55.9] | Loss=0.00187 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.611 | FP-Norm(final)=2.704 | 3491.0 samples/s | 54.5 steps/s
[Step=14650 Epoch=56.1] | Loss=0.00152 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.607 | FP-Norm(final)=2.704 | 4302.6 samples/s | 67.2 steps/s
[Step=14700 Epoch=56.3] | Loss=0.00128 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.601 | FP-Norm(final)=2.705 | 1524.9 samples/s | 23.8 steps/s
[Step=14750 Epoch=56.5] | Loss=0.00110 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=2.705 | 3465.1 samples/s | 54.1 steps/s
[Step=14800 Epoch=56.7] | Loss=0.00097 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=2.706 | 3464.1 samples/s | 54.1 steps/s
[Step=14850 Epoch=56.9] | Loss=0.00087 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.706 | 3456.9 samples/s | 54.0 steps/s
[Step=14900 Epoch=57.1] | Loss=0.00079 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.706 | 3762.0 samples/s | 58.8 steps/s
[Step=14950 Epoch=57.3] | Loss=0.00072 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.707 | 1151.8 samples/s | 18.0 steps/s
[Step=15000 Epoch=57.5] | Loss=0.00066 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.707 | 3478.8 samples/s | 54.4 steps/s
[Step=15050 Epoch=57.7] | Loss=0.00062 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=2.707 | 3253.3 samples/s | 50.8 steps/s
[Step=15100 Epoch=57.9] | Loss=0.00057 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.553 | FP-Norm(final)=2.707 | 3528.4 samples/s | 55.1 steps/s
[Step=15150 Epoch=58.0] | Loss=0.00054 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.708 | 3467.1 samples/s | 54.2 steps/s
[Step=15200 Epoch=58.2] | Loss=0.00051 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.708 | 1620.8 samples/s | 25.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step15200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=46.2] | Loss=0.11066 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.699 | 3298.7 samples/s | 51.5 steps/s
[Step=12050 Epoch=46.4] | Loss=0.00563 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.704 | 3406.5 samples/s | 53.2 steps/s
[Step=12100 Epoch=46.6] | Loss=0.00302 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.600 | FP-Norm(final)=2.705 | 3501.3 samples/s | 54.7 steps/s
[Step=12150 Epoch=46.8] | Loss=0.00205 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.604 | FP-Norm(final)=2.706 | 3520.4 samples/s | 55.0 steps/s
[Step=12200 Epoch=47.0] | Loss=0.00161 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.602 | FP-Norm(final)=2.707 | 3501.5 samples/s | 54.7 steps/s
[Step=12250 Epoch=47.2] | Loss=0.00132 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.597 | FP-Norm(final)=2.707 | 4279.5 samples/s | 66.9 steps/s
[Step=12300 Epoch=47.3] | Loss=0.00111 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.590 | FP-Norm(final)=2.708 | 1550.7 samples/s | 24.2 steps/s
[Step=12350 Epoch=47.5] | Loss=0.00096 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.709 | 3533.4 samples/s | 55.2 steps/s
[Step=12400 Epoch=47.7] | Loss=0.00085 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.709 | 3448.0 samples/s | 53.9 steps/s
[Step=12450 Epoch=47.9] | Loss=0.00076 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.709 | 3427.9 samples/s | 53.6 steps/s
[Step=12500 Epoch=48.1] | Loss=0.00069 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.710 | 3874.4 samples/s | 60.5 steps/s
[Step=12550 Epoch=48.3] | Loss=0.00064 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.710 | 1588.8 samples/s | 24.8 steps/s
[Step=12600 Epoch=48.5] | Loss=0.00059 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.711 | 3457.4 samples/s | 54.0 steps/s
[Step=12650 Epoch=48.7] | Loss=0.00054 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=2.711 | 3436.3 samples/s | 53.7 steps/s
[Step=12700 Epoch=48.9] | Loss=0.00051 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.711 | 3444.9 samples/s | 53.8 steps/s
[Step=12750 Epoch=49.1] | Loss=0.00048 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.711 | 3564.5 samples/s | 55.7 steps/s
[Step=12800 Epoch=49.3] | Loss=0.00045 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.712 | 1688.9 samples/s | 26.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35382 | acc=0.7863 | tpr=0.6934 | fpr=0.0119 | 3449.3 samples/s | 13.5 steps/s
Avg test loss: 0.35985, Avg test acc: 0.78231, Avg tpr: 0.68882, Avg fpr: 0.01205, total FA: 94

Testing server on iccad2012
[Step=  50] | Loss=0.38758 | acc=0.8134 | tpr=0.9735 | fpr=0.1894 | 3513.0 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.39248 | acc=0.8120 | tpr=0.9616 | fpr=0.1908 | 6555.9 samples/s | 25.6 steps/s
[Step= 150] | Loss=0.40118 | acc=0.8102 | tpr=0.9654 | fpr=0.1927 | 6395.5 samples/s | 25.0 steps/s
[Step= 200] | Loss=0.40311 | acc=0.8107 | tpr=0.9639 | fpr=0.1921 | 6644.5 samples/s | 26.0 steps/s
[Step= 250] | Loss=0.40425 | acc=0.8099 | tpr=0.9668 | fpr=0.1930 | 6476.2 samples/s | 25.3 steps/s
[Step= 300] | Loss=0.40572 | acc=0.8096 | tpr=0.9673 | fpr=0.1933 | 6561.6 samples/s | 25.6 steps/s
[Step= 350] | Loss=0.40638 | acc=0.8104 | tpr=0.9693 | fpr=0.1924 | 6714.3 samples/s | 26.2 steps/s
[Step= 400] | Loss=0.40907 | acc=0.8094 | tpr=0.9710 | fpr=0.1935 | 6433.1 samples/s | 25.1 steps/s
[Step= 450] | Loss=0.41112 | acc=0.8088 | tpr=0.9698 | fpr=0.1941 | 6657.6 samples/s | 26.0 steps/s
[Step= 500] | Loss=0.41110 | acc=0.8088 | tpr=0.9692 | fpr=0.1941 | 6418.4 samples/s | 25.1 steps/s
[Step= 550] | Loss=0.40936 | acc=0.8092 | tpr=0.9670 | fpr=0.1937 | 12138.1 samples/s | 47.4 steps/s
Avg test loss: 0.40920, Avg test acc: 0.80914, Avg tpr: 0.96672, Avg fpr: 0.19372, total FA: 26898

server round 33/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=25.0] | Loss=0.13482 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.714 | 3376.2 samples/s | 52.8 steps/s
[Step=12850 Epoch=25.1] | Loss=0.03050 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.482 | FP-Norm(final)=2.710 | 3501.7 samples/s | 54.7 steps/s
[Step=12900 Epoch=25.2] | Loss=0.02065 | Reg=0.00028 | acc=0.9688 | FP-Norm=0.517 | FP-Norm(final)=2.711 | 3600.7 samples/s | 56.3 steps/s
[Step=12950 Epoch=25.3] | Loss=0.01740 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.711 | 3638.5 samples/s | 56.9 steps/s
[Step=13000 Epoch=25.4] | Loss=0.01576 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=2.713 | 3656.3 samples/s | 57.1 steps/s
[Step=13050 Epoch=25.5] | Loss=0.01568 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.514 | FP-Norm(final)=2.714 | 3615.6 samples/s | 56.5 steps/s
[Step=13100 Epoch=25.6] | Loss=0.01530 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=2.715 | 3614.1 samples/s | 56.5 steps/s
[Step=13150 Epoch=25.6] | Loss=0.01477 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.515 | FP-Norm(final)=2.716 | 3662.6 samples/s | 57.2 steps/s
[Step=13200 Epoch=25.7] | Loss=0.01397 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.515 | FP-Norm(final)=2.717 | 3646.1 samples/s | 57.0 steps/s
[Step=13250 Epoch=25.8] | Loss=0.01369 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=2.718 | 3669.2 samples/s | 57.3 steps/s
[Step=13300 Epoch=25.9] | Loss=0.01337 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.519 | FP-Norm(final)=2.719 | 4327.4 samples/s | 67.6 steps/s
[Step=13350 Epoch=26.0] | Loss=0.01304 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=2.720 | 1550.9 samples/s | 24.2 steps/s
[Step=13400 Epoch=26.1] | Loss=0.01248 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.519 | FP-Norm(final)=2.721 | 3651.4 samples/s | 57.1 steps/s
[Step=13450 Epoch=26.2] | Loss=0.01204 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.520 | FP-Norm(final)=2.723 | 3717.5 samples/s | 58.1 steps/s
[Step=13500 Epoch=26.3] | Loss=0.01195 | Reg=0.00027 | acc=0.9688 | FP-Norm=0.521 | FP-Norm(final)=2.724 | 3679.3 samples/s | 57.5 steps/s
[Step=13550 Epoch=26.4] | Loss=0.01170 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.522 | FP-Norm(final)=2.725 | 3630.8 samples/s | 56.7 steps/s
[Step=13600 Epoch=26.5] | Loss=0.01158 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=2.726 | 3675.5 samples/s | 57.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step13600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=49.3] | Loss=0.02499 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.715 | 3363.7 samples/s | 52.6 steps/s
[Step=12850 Epoch=49.5] | Loss=0.00455 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.721 | 3335.2 samples/s | 52.1 steps/s
[Step=12900 Epoch=49.7] | Loss=0.00250 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.638 | FP-Norm(final)=2.722 | 3522.5 samples/s | 55.0 steps/s
[Step=12950 Epoch=49.8] | Loss=0.00170 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.641 | FP-Norm(final)=2.723 | 3461.1 samples/s | 54.1 steps/s
[Step=13000 Epoch=50.0] | Loss=0.00130 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.635 | FP-Norm(final)=2.724 | 3503.9 samples/s | 54.7 steps/s
[Step=13050 Epoch=50.2] | Loss=0.00107 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.627 | FP-Norm(final)=2.724 | 4283.5 samples/s | 66.9 steps/s
[Step=13100 Epoch=50.4] | Loss=0.00090 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.620 | FP-Norm(final)=2.725 | 1519.6 samples/s | 23.7 steps/s
[Step=13150 Epoch=50.6] | Loss=0.00078 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.613 | FP-Norm(final)=2.725 | 3474.5 samples/s | 54.3 steps/s
[Step=13200 Epoch=50.8] | Loss=0.00069 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=2.726 | 3511.1 samples/s | 54.9 steps/s
[Step=13250 Epoch=51.0] | Loss=0.00062 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.597 | FP-Norm(final)=2.726 | 3446.5 samples/s | 53.9 steps/s
[Step=13300 Epoch=51.2] | Loss=0.00056 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.589 | FP-Norm(final)=2.726 | 3857.5 samples/s | 60.3 steps/s
[Step=13350 Epoch=51.4] | Loss=0.00051 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.582 | FP-Norm(final)=2.726 | 1611.0 samples/s | 25.2 steps/s
[Step=13400 Epoch=51.6] | Loss=0.00047 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.727 | 3396.8 samples/s | 53.1 steps/s
[Step=13450 Epoch=51.8] | Loss=0.00044 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.727 | 3454.4 samples/s | 54.0 steps/s
[Step=13500 Epoch=52.0] | Loss=0.00041 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.727 | 3464.8 samples/s | 54.1 steps/s
[Step=13550 Epoch=52.2] | Loss=0.00038 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.727 | 3518.4 samples/s | 55.0 steps/s
[Step=13600 Epoch=52.4] | Loss=0.00036 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.727 | 1659.2 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34317 | acc=0.7941 | tpr=0.7049 | fpr=0.0121 | 3514.5 samples/s | 13.7 steps/s
Avg test loss: 0.34895, Avg test acc: 0.79057, Avg tpr: 0.70094, Avg fpr: 0.01231, total FA: 96

Testing server on iccad2012
[Step=  50] | Loss=0.39168 | acc=0.8171 | tpr=0.9779 | fpr=0.1858 | 3481.7 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.39733 | acc=0.8157 | tpr=0.9616 | fpr=0.1870 | 6523.5 samples/s | 25.5 steps/s
[Step= 150] | Loss=0.40594 | acc=0.8139 | tpr=0.9654 | fpr=0.1889 | 6458.6 samples/s | 25.2 steps/s
[Step= 200] | Loss=0.40814 | acc=0.8141 | tpr=0.9650 | fpr=0.1886 | 6609.6 samples/s | 25.8 steps/s
[Step= 250] | Loss=0.40939 | acc=0.8128 | tpr=0.9668 | fpr=0.1900 | 6435.9 samples/s | 25.1 steps/s
[Step= 300] | Loss=0.41078 | acc=0.8125 | tpr=0.9673 | fpr=0.1903 | 6678.2 samples/s | 26.1 steps/s
[Step= 350] | Loss=0.41165 | acc=0.8130 | tpr=0.9699 | fpr=0.1898 | 6705.5 samples/s | 26.2 steps/s
[Step= 400] | Loss=0.41441 | acc=0.8119 | tpr=0.9716 | fpr=0.1910 | 6152.7 samples/s | 24.0 steps/s
[Step= 450] | Loss=0.41658 | acc=0.8114 | tpr=0.9713 | fpr=0.1915 | 6989.9 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.41654 | acc=0.8114 | tpr=0.9705 | fpr=0.1914 | 5988.4 samples/s | 23.4 steps/s
[Step= 550] | Loss=0.41481 | acc=0.8118 | tpr=0.9686 | fpr=0.1910 | 11494.0 samples/s | 44.9 steps/s
Avg test loss: 0.41465, Avg test acc: 0.81183, Avg tpr: 0.96830, Avg fpr: 0.19101, total FA: 26522

server round 34/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=23.5] | Loss=0.23112 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.724 | 3650.1 samples/s | 57.0 steps/s
[Step=12050 Epoch=23.6] | Loss=0.03806 | Reg=0.00032 | acc=0.9844 | FP-Norm=0.538 | FP-Norm(final)=2.718 | 3381.4 samples/s | 52.8 steps/s
[Step=12100 Epoch=23.7] | Loss=0.02391 | Reg=0.00033 | acc=0.9844 | FP-Norm=0.564 | FP-Norm(final)=2.718 | 3666.5 samples/s | 57.3 steps/s
[Step=12150 Epoch=23.8] | Loss=0.01916 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.719 | 3677.9 samples/s | 57.5 steps/s
[Step=12200 Epoch=23.9] | Loss=0.01671 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.720 | 3672.7 samples/s | 57.4 steps/s
[Step=12250 Epoch=23.9] | Loss=0.01550 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.553 | FP-Norm(final)=2.721 | 3689.5 samples/s | 57.6 steps/s
[Step=12300 Epoch=24.0] | Loss=0.01423 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.722 | 3675.4 samples/s | 57.4 steps/s
[Step=12350 Epoch=24.1] | Loss=0.01377 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.546 | FP-Norm(final)=2.723 | 3663.8 samples/s | 57.2 steps/s
[Step=12400 Epoch=24.2] | Loss=0.01346 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.724 | 3694.1 samples/s | 57.7 steps/s
[Step=12450 Epoch=24.3] | Loss=0.01304 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.542 | FP-Norm(final)=2.725 | 3695.9 samples/s | 57.7 steps/s
[Step=12500 Epoch=24.4] | Loss=0.01268 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.726 | 4366.9 samples/s | 68.2 steps/s
[Step=12550 Epoch=24.5] | Loss=0.01228 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=2.727 | 1588.5 samples/s | 24.8 steps/s
[Step=12600 Epoch=24.6] | Loss=0.01190 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.538 | FP-Norm(final)=2.728 | 3691.7 samples/s | 57.7 steps/s
[Step=12650 Epoch=24.7] | Loss=0.01157 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.728 | 3724.8 samples/s | 58.2 steps/s
[Step=12700 Epoch=24.8] | Loss=0.01128 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.536 | FP-Norm(final)=2.729 | 3673.5 samples/s | 57.4 steps/s
[Step=12750 Epoch=24.9] | Loss=0.01116 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.536 | FP-Norm(final)=2.730 | 3641.0 samples/s | 56.9 steps/s
[Step=12800 Epoch=25.0] | Loss=0.01105 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.536 | FP-Norm(final)=2.731 | 3672.5 samples/s | 57.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step12800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=52.4] | Loss=0.06575 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.725 | 3488.9 samples/s | 54.5 steps/s
[Step=13650 Epoch=52.5] | Loss=0.00479 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.629 | FP-Norm(final)=2.731 | 3243.8 samples/s | 50.7 steps/s
[Step=13700 Epoch=52.7] | Loss=0.00255 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.680 | FP-Norm(final)=2.733 | 3499.1 samples/s | 54.7 steps/s
[Step=13750 Epoch=52.9] | Loss=0.00174 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.682 | FP-Norm(final)=2.734 | 3363.0 samples/s | 52.5 steps/s
[Step=13800 Epoch=53.1] | Loss=0.00133 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.673 | FP-Norm(final)=2.735 | 3421.2 samples/s | 53.5 steps/s
[Step=13850 Epoch=53.3] | Loss=0.00109 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.663 | FP-Norm(final)=2.735 | 4317.6 samples/s | 67.5 steps/s
[Step=13900 Epoch=53.5] | Loss=0.00091 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.652 | FP-Norm(final)=2.736 | 1560.1 samples/s | 24.4 steps/s
[Step=13950 Epoch=53.7] | Loss=0.00079 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.641 | FP-Norm(final)=2.736 | 3513.6 samples/s | 54.9 steps/s
[Step=14000 Epoch=53.9] | Loss=0.00070 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.631 | FP-Norm(final)=2.736 | 3522.7 samples/s | 55.0 steps/s
[Step=14050 Epoch=54.1] | Loss=0.00062 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.737 | 3540.3 samples/s | 55.3 steps/s
[Step=14100 Epoch=54.3] | Loss=0.00057 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.612 | FP-Norm(final)=2.737 | 3937.5 samples/s | 61.5 steps/s
[Step=14150 Epoch=54.5] | Loss=0.00052 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.604 | FP-Norm(final)=2.737 | 1608.0 samples/s | 25.1 steps/s
[Step=14200 Epoch=54.7] | Loss=0.00048 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.737 | 3514.1 samples/s | 54.9 steps/s
[Step=14250 Epoch=54.9] | Loss=0.00044 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.588 | FP-Norm(final)=2.737 | 3537.0 samples/s | 55.3 steps/s
[Step=14300 Epoch=55.0] | Loss=0.00041 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.738 | 3525.4 samples/s | 55.1 steps/s
[Step=14350 Epoch=55.2] | Loss=0.00039 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.738 | 3561.3 samples/s | 55.6 steps/s
[Step=14400 Epoch=55.4] | Loss=0.00037 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.738 | 1651.0 samples/s | 25.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36786 | acc=0.7805 | tpr=0.6847 | fpr=0.0116 | 3447.8 samples/s | 13.5 steps/s
Avg test loss: 0.37409, Avg test acc: 0.77674, Avg tpr: 0.68066, Avg fpr: 0.01192, total FA: 93

Testing server on iccad2012
[Step=  50] | Loss=0.36949 | acc=0.8323 | tpr=0.9779 | fpr=0.1703 | 3556.0 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.37554 | acc=0.8305 | tpr=0.9616 | fpr=0.1719 | 6530.1 samples/s | 25.5 steps/s
[Step= 150] | Loss=0.38446 | acc=0.8286 | tpr=0.9654 | fpr=0.1740 | 6440.3 samples/s | 25.2 steps/s
[Step= 200] | Loss=0.38666 | acc=0.8287 | tpr=0.9650 | fpr=0.1737 | 6635.1 samples/s | 25.9 steps/s
[Step= 250] | Loss=0.38782 | acc=0.8276 | tpr=0.9677 | fpr=0.1749 | 6594.8 samples/s | 25.8 steps/s
[Step= 300] | Loss=0.38924 | acc=0.8272 | tpr=0.9680 | fpr=0.1754 | 7103.6 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.39019 | acc=0.8275 | tpr=0.9706 | fpr=0.1751 | 6299.3 samples/s | 24.6 steps/s
[Step= 400] | Loss=0.39273 | acc=0.8263 | tpr=0.9721 | fpr=0.1763 | 6417.1 samples/s | 25.1 steps/s
[Step= 450] | Loss=0.39489 | acc=0.8257 | tpr=0.9708 | fpr=0.1769 | 6387.9 samples/s | 25.0 steps/s
[Step= 500] | Loss=0.39488 | acc=0.8259 | tpr=0.9705 | fpr=0.1767 | 6734.2 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.39316 | acc=0.8262 | tpr=0.9678 | fpr=0.1764 | 12154.4 samples/s | 47.5 steps/s
Avg test loss: 0.39297, Avg test acc: 0.82626, Avg tpr: 0.96751, Avg fpr: 0.17631, total FA: 24480

server round 35/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=26.5] | Loss=0.25995 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.734 | 3437.3 samples/s | 53.7 steps/s
[Step=13650 Epoch=26.6] | Loss=0.03580 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.511 | FP-Norm(final)=2.728 | 3449.3 samples/s | 53.9 steps/s
[Step=13700 Epoch=26.7] | Loss=0.02443 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.728 | 3669.7 samples/s | 57.3 steps/s
[Step=13750 Epoch=26.8] | Loss=0.02013 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.539 | FP-Norm(final)=2.729 | 3669.0 samples/s | 57.3 steps/s
[Step=13800 Epoch=26.9] | Loss=0.01775 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.730 | 3675.2 samples/s | 57.4 steps/s
[Step=13850 Epoch=27.0] | Loss=0.01615 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.732 | 3719.8 samples/s | 58.1 steps/s
[Step=13900 Epoch=27.1] | Loss=0.01516 | Reg=0.00029 | acc=0.9688 | FP-Norm=0.532 | FP-Norm(final)=2.733 | 3724.5 samples/s | 58.2 steps/s
[Step=13950 Epoch=27.2] | Loss=0.01444 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.734 | 3682.7 samples/s | 57.5 steps/s
[Step=14000 Epoch=27.3] | Loss=0.01404 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.735 | 3714.5 samples/s | 58.0 steps/s
[Step=14050 Epoch=27.4] | Loss=0.01376 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.736 | 3712.5 samples/s | 58.0 steps/s
[Step=14100 Epoch=27.5] | Loss=0.01341 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.737 | 4352.5 samples/s | 68.0 steps/s
[Step=14150 Epoch=27.6] | Loss=0.01291 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.738 | 1556.5 samples/s | 24.3 steps/s
[Step=14200 Epoch=27.7] | Loss=0.01235 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.739 | 3598.5 samples/s | 56.2 steps/s
[Step=14250 Epoch=27.8] | Loss=0.01196 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.740 | 3652.9 samples/s | 57.1 steps/s
[Step=14300 Epoch=27.9] | Loss=0.01169 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.741 | 3642.3 samples/s | 56.9 steps/s
[Step=14350 Epoch=28.0] | Loss=0.01143 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.743 | 3605.8 samples/s | 56.3 steps/s
[Step=14400 Epoch=28.1] | Loss=0.01127 | Reg=0.00028 | acc=0.9688 | FP-Norm=0.529 | FP-Norm(final)=2.744 | 3647.2 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step14400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=58.2] | Loss=0.13403 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.734 | 3421.4 samples/s | 53.5 steps/s
[Step=15250 Epoch=58.4] | Loss=0.00561 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.597 | FP-Norm(final)=2.740 | 3344.4 samples/s | 52.3 steps/s
[Step=15300 Epoch=58.6] | Loss=0.00287 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.630 | FP-Norm(final)=2.741 | 3474.5 samples/s | 54.3 steps/s
[Step=15350 Epoch=58.8] | Loss=0.00194 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.626 | FP-Norm(final)=2.742 | 3482.3 samples/s | 54.4 steps/s
[Step=15400 Epoch=59.0] | Loss=0.00147 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.616 | FP-Norm(final)=2.742 | 3437.3 samples/s | 53.7 steps/s
[Step=15450 Epoch=59.2] | Loss=0.00120 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=2.742 | 4270.2 samples/s | 66.7 steps/s
[Step=15500 Epoch=59.4] | Loss=0.00100 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=2.742 | 1558.3 samples/s | 24.3 steps/s
[Step=15550 Epoch=59.6] | Loss=0.00087 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.585 | FP-Norm(final)=2.743 | 3533.5 samples/s | 55.2 steps/s
[Step=15600 Epoch=59.8] | Loss=0.00076 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.743 | 3486.6 samples/s | 54.5 steps/s
[Step=15650 Epoch=60.0] | Loss=0.00068 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.743 | 3484.0 samples/s | 54.4 steps/s
[Step=15700 Epoch=60.2] | Loss=0.00062 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.743 | 3777.8 samples/s | 59.0 steps/s
[Step=15750 Epoch=60.3] | Loss=0.00057 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.743 | 1613.6 samples/s | 25.2 steps/s
[Step=15800 Epoch=60.5] | Loss=0.00052 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=2.744 | 3482.5 samples/s | 54.4 steps/s
[Step=15850 Epoch=60.7] | Loss=0.00048 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=2.744 | 3470.5 samples/s | 54.2 steps/s
[Step=15900 Epoch=60.9] | Loss=0.00045 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.532 | FP-Norm(final)=2.744 | 3434.9 samples/s | 53.7 steps/s
[Step=15950 Epoch=61.1] | Loss=0.00042 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.526 | FP-Norm(final)=2.744 | 3440.8 samples/s | 53.8 steps/s
[Step=16000 Epoch=61.3] | Loss=0.00040 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.521 | FP-Norm(final)=2.744 | 1701.8 samples/s | 26.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38498 | acc=0.7762 | tpr=0.6780 | fpr=0.0104 | 3481.6 samples/s | 13.6 steps/s
Avg test loss: 0.39170, Avg test acc: 0.77294, Avg tpr: 0.67459, Avg fpr: 0.01077, total FA: 84

Testing server on iccad2012
[Step=  50] | Loss=0.35513 | acc=0.8451 | tpr=0.9735 | fpr=0.1572 | 3561.8 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.36116 | acc=0.8428 | tpr=0.9616 | fpr=0.1594 | 6385.7 samples/s | 24.9 steps/s
[Step= 150] | Loss=0.37035 | acc=0.8410 | tpr=0.9654 | fpr=0.1612 | 6848.6 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.37249 | acc=0.8411 | tpr=0.9639 | fpr=0.1611 | 6587.6 samples/s | 25.7 steps/s
[Step= 250] | Loss=0.37370 | acc=0.8403 | tpr=0.9659 | fpr=0.1620 | 6674.3 samples/s | 26.1 steps/s
[Step= 300] | Loss=0.37503 | acc=0.8397 | tpr=0.9665 | fpr=0.1626 | 6572.7 samples/s | 25.7 steps/s
[Step= 350] | Loss=0.37612 | acc=0.8399 | tpr=0.9687 | fpr=0.1625 | 6356.3 samples/s | 24.8 steps/s
[Step= 400] | Loss=0.37861 | acc=0.8388 | tpr=0.9705 | fpr=0.1636 | 6093.5 samples/s | 23.8 steps/s
[Step= 450] | Loss=0.38078 | acc=0.8382 | tpr=0.9693 | fpr=0.1642 | 6094.1 samples/s | 23.8 steps/s
[Step= 500] | Loss=0.38080 | acc=0.8382 | tpr=0.9683 | fpr=0.1642 | 6570.4 samples/s | 25.7 steps/s
[Step= 550] | Loss=0.37913 | acc=0.8384 | tpr=0.9654 | fpr=0.1639 | 11147.1 samples/s | 43.5 steps/s
Avg test loss: 0.37894, Avg test acc: 0.83837, Avg tpr: 0.96513, Avg fpr: 0.16393, total FA: 22762

server round 36/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=61.3] | Loss=0.13541 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.747 | 3430.3 samples/s | 53.6 steps/s
[Step=16050 Epoch=61.5] | Loss=0.00750 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.667 | FP-Norm(final)=2.752 | 3295.5 samples/s | 51.5 steps/s
[Step=16100 Epoch=61.7] | Loss=0.00385 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.719 | FP-Norm(final)=2.753 | 3464.3 samples/s | 54.1 steps/s
[Step=16150 Epoch=61.9] | Loss=0.00258 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.717 | FP-Norm(final)=2.753 | 3476.3 samples/s | 54.3 steps/s
[Step=16200 Epoch=62.1] | Loss=0.00197 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.707 | FP-Norm(final)=2.753 | 3476.4 samples/s | 54.3 steps/s
[Step=16250 Epoch=62.3] | Loss=0.00159 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.698 | FP-Norm(final)=2.754 | 4254.4 samples/s | 66.5 steps/s
[Step=16300 Epoch=62.5] | Loss=0.00133 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.687 | FP-Norm(final)=2.754 | 1537.1 samples/s | 24.0 steps/s
[Step=16350 Epoch=62.6] | Loss=0.00115 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.677 | FP-Norm(final)=2.754 | 3501.2 samples/s | 54.7 steps/s
[Step=16400 Epoch=62.8] | Loss=0.00101 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.667 | FP-Norm(final)=2.754 | 3435.8 samples/s | 53.7 steps/s
[Step=16450 Epoch=63.0] | Loss=0.00090 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.658 | FP-Norm(final)=2.754 | 3513.4 samples/s | 54.9 steps/s
[Step=16500 Epoch=63.2] | Loss=0.00081 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.649 | FP-Norm(final)=2.754 | 3796.8 samples/s | 59.3 steps/s
[Step=16550 Epoch=63.4] | Loss=0.00074 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.641 | FP-Norm(final)=2.754 | 1626.5 samples/s | 25.4 steps/s
[Step=16600 Epoch=63.6] | Loss=0.00068 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.633 | FP-Norm(final)=2.754 | 3458.9 samples/s | 54.0 steps/s
[Step=16650 Epoch=63.8] | Loss=0.00063 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.625 | FP-Norm(final)=2.755 | 3517.5 samples/s | 55.0 steps/s
[Step=16700 Epoch=64.0] | Loss=0.00059 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.619 | FP-Norm(final)=2.755 | 3538.0 samples/s | 55.3 steps/s
[Step=16750 Epoch=64.2] | Loss=0.00055 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.612 | FP-Norm(final)=2.755 | 3464.3 samples/s | 54.1 steps/s
[Step=16800 Epoch=64.4] | Loss=0.00052 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.606 | FP-Norm(final)=2.755 | 1684.7 samples/s | 26.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step16800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=55.4] | Loss=0.10231 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.747 | 3403.0 samples/s | 53.2 steps/s
[Step=14450 Epoch=55.6] | Loss=0.00699 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.638 | FP-Norm(final)=2.752 | 3289.6 samples/s | 51.4 steps/s
[Step=14500 Epoch=55.8] | Loss=0.00363 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.690 | FP-Norm(final)=2.753 | 3455.4 samples/s | 54.0 steps/s
[Step=14550 Epoch=56.0] | Loss=0.00245 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.693 | FP-Norm(final)=2.753 | 3442.6 samples/s | 53.8 steps/s
[Step=14600 Epoch=56.2] | Loss=0.00186 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.754 | 3485.1 samples/s | 54.5 steps/s
[Step=14650 Epoch=56.4] | Loss=0.00150 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.676 | FP-Norm(final)=2.754 | 4266.1 samples/s | 66.7 steps/s
[Step=14700 Epoch=56.6] | Loss=0.00126 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.667 | FP-Norm(final)=2.755 | 1553.3 samples/s | 24.3 steps/s
[Step=14750 Epoch=56.8] | Loss=0.00109 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.657 | FP-Norm(final)=2.755 | 3406.0 samples/s | 53.2 steps/s
[Step=14800 Epoch=57.0] | Loss=0.00096 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.648 | FP-Norm(final)=2.755 | 3454.4 samples/s | 54.0 steps/s
[Step=14850 Epoch=57.2] | Loss=0.00086 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.640 | FP-Norm(final)=2.755 | 3428.9 samples/s | 53.6 steps/s
[Step=14900 Epoch=57.4] | Loss=0.00077 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.632 | FP-Norm(final)=2.755 | 3878.6 samples/s | 60.6 steps/s
[Step=14950 Epoch=57.5] | Loss=0.00071 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.756 | 1594.8 samples/s | 24.9 steps/s
[Step=15000 Epoch=57.7] | Loss=0.00065 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.617 | FP-Norm(final)=2.756 | 3505.6 samples/s | 54.8 steps/s
[Step=15050 Epoch=57.9] | Loss=0.00060 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.610 | FP-Norm(final)=2.756 | 3472.7 samples/s | 54.3 steps/s
[Step=15100 Epoch=58.1] | Loss=0.00056 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.603 | FP-Norm(final)=2.756 | 3401.8 samples/s | 53.2 steps/s
[Step=15150 Epoch=58.3] | Loss=0.00053 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.597 | FP-Norm(final)=2.756 | 3434.0 samples/s | 53.7 steps/s
[Step=15200 Epoch=58.5] | Loss=0.00050 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.756 | 1678.1 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39195 | acc=0.7722 | tpr=0.6725 | fpr=0.0114 | 3467.2 samples/s | 13.5 steps/s
Avg test loss: 0.39919, Avg test acc: 0.76977, Avg tpr: 0.67034, Avg fpr: 0.01154, total FA: 90

Testing server on iccad2012
[Step=  50] | Loss=0.34823 | acc=0.8477 | tpr=0.9735 | fpr=0.1545 | 3488.9 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.35419 | acc=0.8461 | tpr=0.9616 | fpr=0.1561 | 6354.5 samples/s | 24.8 steps/s
[Step= 150] | Loss=0.36354 | acc=0.8440 | tpr=0.9654 | fpr=0.1582 | 6466.4 samples/s | 25.3 steps/s
[Step= 200] | Loss=0.36557 | acc=0.8443 | tpr=0.9650 | fpr=0.1579 | 6524.6 samples/s | 25.5 steps/s
[Step= 250] | Loss=0.36652 | acc=0.8435 | tpr=0.9668 | fpr=0.1587 | 6591.8 samples/s | 25.7 steps/s
[Step= 300] | Loss=0.36766 | acc=0.8430 | tpr=0.9673 | fpr=0.1593 | 6298.7 samples/s | 24.6 steps/s
[Step= 350] | Loss=0.36880 | acc=0.8434 | tpr=0.9699 | fpr=0.1589 | 6671.9 samples/s | 26.1 steps/s
[Step= 400] | Loss=0.37118 | acc=0.8424 | tpr=0.9716 | fpr=0.1599 | 6376.1 samples/s | 24.9 steps/s
[Step= 450] | Loss=0.37343 | acc=0.8416 | tpr=0.9708 | fpr=0.1607 | 6482.2 samples/s | 25.3 steps/s
[Step= 500] | Loss=0.37346 | acc=0.8417 | tpr=0.9700 | fpr=0.1606 | 6521.3 samples/s | 25.5 steps/s
[Step= 550] | Loss=0.37172 | acc=0.8421 | tpr=0.9666 | fpr=0.1601 | 12118.9 samples/s | 47.3 steps/s
Avg test loss: 0.37152, Avg test acc: 0.84215, Avg tpr: 0.96632, Avg fpr: 0.16011, total FA: 22231

server round 37/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=28.1] | Loss=0.13862 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.754 | 3322.9 samples/s | 51.9 steps/s
[Step=14450 Epoch=28.2] | Loss=0.02917 | Reg=0.00024 | acc=0.9688 | FP-Norm=0.464 | FP-Norm(final)=2.750 | 3516.3 samples/s | 54.9 steps/s
[Step=14500 Epoch=28.3] | Loss=0.02063 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.750 | 3699.8 samples/s | 57.8 steps/s
[Step=14550 Epoch=28.4] | Loss=0.01740 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.509 | FP-Norm(final)=2.751 | 3645.7 samples/s | 57.0 steps/s
[Step=14600 Epoch=28.5] | Loss=0.01511 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.514 | FP-Norm(final)=2.752 | 3641.9 samples/s | 56.9 steps/s
[Step=14650 Epoch=28.6] | Loss=0.01405 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=2.753 | 3609.5 samples/s | 56.4 steps/s
[Step=14700 Epoch=28.7] | Loss=0.01340 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.513 | FP-Norm(final)=2.754 | 3645.7 samples/s | 57.0 steps/s
[Step=14750 Epoch=28.8] | Loss=0.01281 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.513 | FP-Norm(final)=2.755 | 3729.9 samples/s | 58.3 steps/s
[Step=14800 Epoch=28.9] | Loss=0.01266 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=2.756 | 3621.5 samples/s | 56.6 steps/s
[Step=14850 Epoch=29.0] | Loss=0.01250 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.516 | FP-Norm(final)=2.757 | 3688.7 samples/s | 57.6 steps/s
[Step=14900 Epoch=29.1] | Loss=0.01236 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.758 | 4409.0 samples/s | 68.9 steps/s
[Step=14950 Epoch=29.2] | Loss=0.01218 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.519 | FP-Norm(final)=2.759 | 1566.5 samples/s | 24.5 steps/s
[Step=15000 Epoch=29.3] | Loss=0.01188 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.519 | FP-Norm(final)=2.759 | 3683.2 samples/s | 57.5 steps/s
[Step=15050 Epoch=29.4] | Loss=0.01159 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.520 | FP-Norm(final)=2.760 | 3724.4 samples/s | 58.2 steps/s
[Step=15100 Epoch=29.5] | Loss=0.01125 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.521 | FP-Norm(final)=2.761 | 3610.3 samples/s | 56.4 steps/s
[Step=15150 Epoch=29.5] | Loss=0.01115 | Reg=0.00027 | acc=0.9688 | FP-Norm=0.522 | FP-Norm(final)=2.762 | 3653.5 samples/s | 57.1 steps/s
[Step=15200 Epoch=29.6] | Loss=0.01086 | Reg=0.00027 | acc=0.9688 | FP-Norm=0.523 | FP-Norm(final)=2.763 | 3627.7 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step15200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16801 Epoch=64.4] | Loss=0.11743 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.754 | 3411.5 samples/s | 53.3 steps/s
[Step=16850 Epoch=64.6] | Loss=0.00633 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.580 | FP-Norm(final)=2.758 | 3351.6 samples/s | 52.4 steps/s
[Step=16900 Epoch=64.8] | Loss=0.00326 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.759 | 3476.3 samples/s | 54.3 steps/s
[Step=16950 Epoch=64.9] | Loss=0.00221 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.759 | 3516.7 samples/s | 54.9 steps/s
[Step=17000 Epoch=65.1] | Loss=0.00168 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.617 | FP-Norm(final)=2.760 | 3502.7 samples/s | 54.7 steps/s
[Step=17050 Epoch=65.3] | Loss=0.00135 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.607 | FP-Norm(final)=2.760 | 4313.2 samples/s | 67.4 steps/s
[Step=17100 Epoch=65.5] | Loss=0.00114 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.598 | FP-Norm(final)=2.760 | 1528.9 samples/s | 23.9 steps/s
[Step=17150 Epoch=65.7] | Loss=0.00098 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.588 | FP-Norm(final)=2.760 | 3459.0 samples/s | 54.0 steps/s
[Step=17200 Epoch=65.9] | Loss=0.00086 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.761 | 3449.3 samples/s | 53.9 steps/s
[Step=17250 Epoch=66.1] | Loss=0.00077 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.761 | 3444.1 samples/s | 53.8 steps/s
[Step=17300 Epoch=66.3] | Loss=0.00070 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.761 | 3782.5 samples/s | 59.1 steps/s
[Step=17350 Epoch=66.5] | Loss=0.00064 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.761 | 1620.2 samples/s | 25.3 steps/s
[Step=17400 Epoch=66.7] | Loss=0.00059 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.549 | FP-Norm(final)=2.761 | 3478.0 samples/s | 54.3 steps/s
[Step=17450 Epoch=66.9] | Loss=0.00054 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.761 | 3428.9 samples/s | 53.6 steps/s
[Step=17500 Epoch=67.1] | Loss=0.00051 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.762 | 3399.0 samples/s | 53.1 steps/s
[Step=17550 Epoch=67.2] | Loss=0.00047 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.762 | 3362.2 samples/s | 52.5 steps/s
[Step=17600 Epoch=67.4] | Loss=0.00045 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=2.762 | 1675.0 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39206 | acc=0.7733 | tpr=0.6741 | fpr=0.0114 | 3528.0 samples/s | 13.8 steps/s
Avg test loss: 0.39894, Avg test acc: 0.77118, Avg tpr: 0.67232, Avg fpr: 0.01141, total FA: 89

Testing server on iccad2012
[Step=  50] | Loss=0.34912 | acc=0.8485 | tpr=0.9735 | fpr=0.1537 | 3478.5 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.35551 | acc=0.8475 | tpr=0.9595 | fpr=0.1546 | 6935.9 samples/s | 27.1 steps/s
[Step= 150] | Loss=0.36507 | acc=0.8452 | tpr=0.9640 | fpr=0.1570 | 6396.6 samples/s | 25.0 steps/s
[Step= 200] | Loss=0.36703 | acc=0.8459 | tpr=0.9639 | fpr=0.1563 | 6516.4 samples/s | 25.5 steps/s
[Step= 250] | Loss=0.36831 | acc=0.8448 | tpr=0.9659 | fpr=0.1574 | 6764.6 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.36960 | acc=0.8444 | tpr=0.9665 | fpr=0.1578 | 6544.8 samples/s | 25.6 steps/s
[Step= 350] | Loss=0.37074 | acc=0.8446 | tpr=0.9693 | fpr=0.1577 | 6387.1 samples/s | 24.9 steps/s
[Step= 400] | Loss=0.37305 | acc=0.8436 | tpr=0.9710 | fpr=0.1587 | 6675.2 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.37536 | acc=0.8427 | tpr=0.9698 | fpr=0.1596 | 6538.9 samples/s | 25.5 steps/s
[Step= 500] | Loss=0.37536 | acc=0.8426 | tpr=0.9692 | fpr=0.1596 | 6646.8 samples/s | 26.0 steps/s
[Step= 550] | Loss=0.37372 | acc=0.8431 | tpr=0.9662 | fpr=0.1592 | 12403.1 samples/s | 48.4 steps/s
Avg test loss: 0.37351, Avg test acc: 0.84309, Avg tpr: 0.96593, Avg fpr: 0.15915, total FA: 22097

server round 38/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=25.0] | Loss=0.53647 | Reg=0.00000 | acc=0.7500 | FP-Norm=0.000 | FP-Norm(final)=2.760 | 3439.7 samples/s | 53.7 steps/s
[Step=12850 Epoch=25.1] | Loss=0.04041 | Reg=0.00025 | acc=0.9688 | FP-Norm=0.480 | FP-Norm(final)=2.754 | 3638.9 samples/s | 56.9 steps/s
[Step=12900 Epoch=25.2] | Loss=0.02446 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.754 | 3637.7 samples/s | 56.8 steps/s
[Step=12950 Epoch=25.3] | Loss=0.01940 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.499 | FP-Norm(final)=2.755 | 3667.7 samples/s | 57.3 steps/s
[Step=13000 Epoch=25.4] | Loss=0.01724 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.499 | FP-Norm(final)=2.756 | 3635.3 samples/s | 56.8 steps/s
[Step=13050 Epoch=25.5] | Loss=0.01563 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=2.756 | 3574.9 samples/s | 55.9 steps/s
[Step=13100 Epoch=25.6] | Loss=0.01469 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.499 | FP-Norm(final)=2.757 | 3643.7 samples/s | 56.9 steps/s
[Step=13150 Epoch=25.7] | Loss=0.01393 | Reg=0.00025 | acc=0.9531 | FP-Norm=0.499 | FP-Norm(final)=2.758 | 3652.7 samples/s | 57.1 steps/s
[Step=13200 Epoch=25.8] | Loss=0.01301 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.759 | 3655.7 samples/s | 57.1 steps/s
[Step=13250 Epoch=25.9] | Loss=0.01258 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.760 | 3665.0 samples/s | 57.3 steps/s
[Step=13300 Epoch=26.0] | Loss=0.01235 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.761 | 4389.3 samples/s | 68.6 steps/s
[Step=13350 Epoch=26.1] | Loss=0.01185 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.762 | 1607.7 samples/s | 25.1 steps/s
[Step=13400 Epoch=26.2] | Loss=0.01149 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.762 | 3609.8 samples/s | 56.4 steps/s
[Step=13450 Epoch=26.3] | Loss=0.01117 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.763 | 3564.7 samples/s | 55.7 steps/s
[Step=13500 Epoch=26.4] | Loss=0.01089 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.764 | 3622.2 samples/s | 56.6 steps/s
[Step=13550 Epoch=26.5] | Loss=0.01067 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.765 | 3634.4 samples/s | 56.8 steps/s
[Step=13600 Epoch=26.6] | Loss=0.01041 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.501 | FP-Norm(final)=2.766 | 3645.0 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step13600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=58.5] | Loss=0.17001 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.761 | 3487.6 samples/s | 54.5 steps/s
[Step=15250 Epoch=58.7] | Loss=0.00685 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.765 | 3265.0 samples/s | 51.0 steps/s
[Step=15300 Epoch=58.9] | Loss=0.00351 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.585 | FP-Norm(final)=2.765 | 3447.9 samples/s | 53.9 steps/s
[Step=15350 Epoch=59.1] | Loss=0.00240 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.766 | 3442.2 samples/s | 53.8 steps/s
[Step=15400 Epoch=59.3] | Loss=0.00182 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=2.767 | 3453.9 samples/s | 54.0 steps/s
[Step=15450 Epoch=59.5] | Loss=0.00148 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.767 | 4286.7 samples/s | 67.0 steps/s
[Step=15500 Epoch=59.7] | Loss=0.00124 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.768 | 1512.3 samples/s | 23.6 steps/s
[Step=15550 Epoch=59.9] | Loss=0.00107 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.768 | 3422.4 samples/s | 53.5 steps/s
[Step=15600 Epoch=60.1] | Loss=0.00095 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.768 | 3455.3 samples/s | 54.0 steps/s
[Step=15650 Epoch=60.2] | Loss=0.00085 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.768 | 3487.8 samples/s | 54.5 steps/s
[Step=15700 Epoch=60.4] | Loss=0.00077 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=2.769 | 3883.5 samples/s | 60.7 steps/s
[Step=15750 Epoch=60.6] | Loss=0.00070 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=2.769 | 1607.2 samples/s | 25.1 steps/s
[Step=15800 Epoch=60.8] | Loss=0.00065 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.522 | FP-Norm(final)=2.769 | 3479.0 samples/s | 54.4 steps/s
[Step=15850 Epoch=61.0] | Loss=0.00060 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=2.769 | 3434.8 samples/s | 53.7 steps/s
[Step=15900 Epoch=61.2] | Loss=0.00056 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.769 | 3442.7 samples/s | 53.8 steps/s
[Step=15950 Epoch=61.4] | Loss=0.00053 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=2.770 | 3514.4 samples/s | 54.9 steps/s
[Step=16000 Epoch=61.6] | Loss=0.00049 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=2.770 | 1665.6 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37631 | acc=0.7837 | tpr=0.6891 | fpr=0.0109 | 3487.8 samples/s | 13.6 steps/s
Avg test loss: 0.38319, Avg test acc: 0.78139, Avg tpr: 0.68701, Avg fpr: 0.01102, total FA: 86

Testing server on iccad2012
[Step=  50] | Loss=0.36154 | acc=0.8441 | tpr=0.9735 | fpr=0.1583 | 3498.0 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.36848 | acc=0.8422 | tpr=0.9595 | fpr=0.1600 | 6567.2 samples/s | 25.7 steps/s
[Step= 150] | Loss=0.37820 | acc=0.8394 | tpr=0.9640 | fpr=0.1629 | 6682.1 samples/s | 26.1 steps/s
[Step= 200] | Loss=0.38000 | acc=0.8396 | tpr=0.9628 | fpr=0.1626 | 6438.7 samples/s | 25.2 steps/s
[Step= 250] | Loss=0.38149 | acc=0.8382 | tpr=0.9651 | fpr=0.1641 | 6425.8 samples/s | 25.1 steps/s
[Step= 300] | Loss=0.38298 | acc=0.8377 | tpr=0.9658 | fpr=0.1646 | 6269.8 samples/s | 24.5 steps/s
[Step= 350] | Loss=0.38406 | acc=0.8379 | tpr=0.9681 | fpr=0.1645 | 6618.9 samples/s | 25.9 steps/s
[Step= 400] | Loss=0.38648 | acc=0.8370 | tpr=0.9699 | fpr=0.1654 | 6312.6 samples/s | 24.7 steps/s
[Step= 450] | Loss=0.38884 | acc=0.8360 | tpr=0.9688 | fpr=0.1664 | 6564.0 samples/s | 25.6 steps/s
[Step= 500] | Loss=0.38892 | acc=0.8359 | tpr=0.9678 | fpr=0.1665 | 6443.6 samples/s | 25.2 steps/s
[Step= 550] | Loss=0.38724 | acc=0.8362 | tpr=0.9650 | fpr=0.1661 | 11977.2 samples/s | 46.8 steps/s
Avg test loss: 0.38703, Avg test acc: 0.83623, Avg tpr: 0.96474, Avg fpr: 0.16611, total FA: 23064

server round 39/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=17601 Epoch=67.4] | Loss=0.07535 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.773 | 3572.2 samples/s | 55.8 steps/s
[Step=17650 Epoch=67.6] | Loss=0.00465 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.779 | 3190.4 samples/s | 49.8 steps/s
[Step=17700 Epoch=67.8] | Loss=0.00236 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.657 | FP-Norm(final)=2.780 | 3421.7 samples/s | 53.5 steps/s
[Step=17750 Epoch=68.0] | Loss=0.00158 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.650 | FP-Norm(final)=2.780 | 3405.4 samples/s | 53.2 steps/s
[Step=17800 Epoch=68.2] | Loss=0.00120 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.639 | FP-Norm(final)=2.781 | 3494.9 samples/s | 54.6 steps/s
[Step=17850 Epoch=68.4] | Loss=0.00097 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.627 | FP-Norm(final)=2.781 | 4313.6 samples/s | 67.4 steps/s
[Step=17900 Epoch=68.6] | Loss=0.00082 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.617 | FP-Norm(final)=2.781 | 1565.6 samples/s | 24.5 steps/s
[Step=17950 Epoch=68.8] | Loss=0.00070 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.606 | FP-Norm(final)=2.781 | 3367.5 samples/s | 52.6 steps/s
[Step=18000 Epoch=69.0] | Loss=0.00062 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.782 | 3421.3 samples/s | 53.5 steps/s
[Step=18050 Epoch=69.2] | Loss=0.00056 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=2.782 | 3534.8 samples/s | 55.2 steps/s
[Step=18100 Epoch=69.4] | Loss=0.00050 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.782 | 3834.3 samples/s | 59.9 steps/s
[Step=18150 Epoch=69.5] | Loss=0.00046 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.782 | 1628.5 samples/s | 25.4 steps/s
[Step=18200 Epoch=69.7] | Loss=0.00042 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.782 | 3506.8 samples/s | 54.8 steps/s
[Step=18250 Epoch=69.9] | Loss=0.00039 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.782 | 3496.7 samples/s | 54.6 steps/s
[Step=18300 Epoch=70.1] | Loss=0.00037 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.782 | 3511.9 samples/s | 54.9 steps/s
[Step=18350 Epoch=70.3] | Loss=0.00034 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.782 | 3515.2 samples/s | 54.9 steps/s
[Step=18400 Epoch=70.5] | Loss=0.00032 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.782 | 1671.5 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step18400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=61.6] | Loss=0.06202 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.773 | 3678.0 samples/s | 57.5 steps/s
[Step=16050 Epoch=61.8] | Loss=0.00541 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.601 | FP-Norm(final)=2.777 | 3225.7 samples/s | 50.4 steps/s
[Step=16100 Epoch=62.0] | Loss=0.00281 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.638 | FP-Norm(final)=2.778 | 3439.7 samples/s | 53.7 steps/s
[Step=16150 Epoch=62.2] | Loss=0.00195 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.638 | FP-Norm(final)=2.779 | 3387.4 samples/s | 52.9 steps/s
[Step=16200 Epoch=62.4] | Loss=0.00151 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.631 | FP-Norm(final)=2.780 | 3463.1 samples/s | 54.1 steps/s
[Step=16250 Epoch=62.6] | Loss=0.00122 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.623 | FP-Norm(final)=2.781 | 4312.4 samples/s | 67.4 steps/s
[Step=16300 Epoch=62.7] | Loss=0.00102 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.614 | FP-Norm(final)=2.781 | 1555.3 samples/s | 24.3 steps/s
[Step=16350 Epoch=62.9] | Loss=0.00088 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=2.781 | 3507.2 samples/s | 54.8 steps/s
[Step=16400 Epoch=63.1] | Loss=0.00078 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.782 | 3517.7 samples/s | 55.0 steps/s
[Step=16450 Epoch=63.3] | Loss=0.00070 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=2.782 | 3499.9 samples/s | 54.7 steps/s
[Step=16500 Epoch=63.5] | Loss=0.00063 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.580 | FP-Norm(final)=2.782 | 3921.1 samples/s | 61.3 steps/s
[Step=16550 Epoch=63.7] | Loss=0.00058 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=2.783 | 1607.2 samples/s | 25.1 steps/s
[Step=16600 Epoch=63.9] | Loss=0.00053 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.783 | 3531.2 samples/s | 55.2 steps/s
[Step=16650 Epoch=64.1] | Loss=0.00049 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.783 | 3514.0 samples/s | 54.9 steps/s
[Step=16700 Epoch=64.3] | Loss=0.00046 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.783 | 3555.0 samples/s | 55.5 steps/s
[Step=16750 Epoch=64.5] | Loss=0.00043 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.783 | 3543.6 samples/s | 55.4 steps/s
[Step=16800 Epoch=64.7] | Loss=0.00041 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.783 | 1647.1 samples/s | 25.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36519 | acc=0.7909 | tpr=0.6996 | fpr=0.0107 | 3375.4 samples/s | 13.2 steps/s
Avg test loss: 0.37338, Avg test acc: 0.78804, Avg tpr: 0.69651, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.37272 | acc=0.8341 | tpr=0.9735 | fpr=0.1684 | 3509.3 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.37898 | acc=0.8340 | tpr=0.9574 | fpr=0.1683 | 6448.3 samples/s | 25.2 steps/s
[Step= 150] | Loss=0.38814 | acc=0.8321 | tpr=0.9625 | fpr=0.1703 | 6585.8 samples/s | 25.7 steps/s
[Step= 200] | Loss=0.38990 | acc=0.8327 | tpr=0.9617 | fpr=0.1697 | 6372.0 samples/s | 24.9 steps/s
[Step= 250] | Loss=0.39150 | acc=0.8315 | tpr=0.9633 | fpr=0.1709 | 6233.7 samples/s | 24.4 steps/s
[Step= 300] | Loss=0.39318 | acc=0.8310 | tpr=0.9651 | fpr=0.1715 | 6584.7 samples/s | 25.7 steps/s
[Step= 350] | Loss=0.39415 | acc=0.8314 | tpr=0.9674 | fpr=0.1710 | 6782.8 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.39664 | acc=0.8302 | tpr=0.9694 | fpr=0.1723 | 6580.8 samples/s | 25.7 steps/s
[Step= 450] | Loss=0.39892 | acc=0.8295 | tpr=0.9684 | fpr=0.1730 | 6537.1 samples/s | 25.5 steps/s
[Step= 500] | Loss=0.39911 | acc=0.8294 | tpr=0.9670 | fpr=0.1731 | 6585.7 samples/s | 25.7 steps/s
[Step= 550] | Loss=0.39735 | acc=0.8296 | tpr=0.9634 | fpr=0.1729 | 12610.2 samples/s | 49.3 steps/s
Avg test loss: 0.39716, Avg test acc: 0.82960, Avg tpr: 0.96315, Avg fpr: 0.17283, total FA: 23997

server round 40/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=29.6] | Loss=0.20224 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.781 | 3448.9 samples/s | 53.9 steps/s
[Step=15250 Epoch=29.7] | Loss=0.03648 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.777 | 3394.7 samples/s | 53.0 steps/s
[Step=15300 Epoch=29.8] | Loss=0.02353 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.777 | 3633.6 samples/s | 56.8 steps/s
[Step=15350 Epoch=29.9] | Loss=0.01891 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.405 | FP-Norm(final)=2.777 | 3660.6 samples/s | 57.2 steps/s
[Step=15400 Epoch=30.0] | Loss=0.01707 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.778 | 3717.3 samples/s | 58.1 steps/s
[Step=15450 Epoch=30.1] | Loss=0.01529 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.778 | 3684.8 samples/s | 57.6 steps/s
[Step=15500 Epoch=30.2] | Loss=0.01455 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.779 | 3718.6 samples/s | 58.1 steps/s
[Step=15550 Epoch=30.3] | Loss=0.01371 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.779 | 3655.8 samples/s | 57.1 steps/s
[Step=15600 Epoch=30.4] | Loss=0.01299 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.780 | 3732.6 samples/s | 58.3 steps/s
[Step=15650 Epoch=30.5] | Loss=0.01214 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.781 | 3709.4 samples/s | 58.0 steps/s
[Step=15700 Epoch=30.6] | Loss=0.01190 | Reg=0.00017 | acc=0.9688 | FP-Norm=0.410 | FP-Norm(final)=2.781 | 4369.3 samples/s | 68.3 steps/s
[Step=15750 Epoch=30.7] | Loss=0.01144 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.782 | 1612.3 samples/s | 25.2 steps/s
[Step=15800 Epoch=30.8] | Loss=0.01113 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.410 | FP-Norm(final)=2.783 | 3545.9 samples/s | 55.4 steps/s
[Step=15850 Epoch=30.9] | Loss=0.01086 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.783 | 3621.0 samples/s | 56.6 steps/s
[Step=15900 Epoch=31.0] | Loss=0.01053 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.784 | 3652.6 samples/s | 57.1 steps/s
[Step=15950 Epoch=31.1] | Loss=0.01034 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.785 | 3722.0 samples/s | 58.2 steps/s
[Step=16000 Epoch=31.2] | Loss=0.01011 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.785 | 3688.5 samples/s | 57.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step16000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=64.7] | Loss=0.05703 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.781 | 3427.9 samples/s | 53.6 steps/s
[Step=16850 Epoch=64.9] | Loss=0.00563 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.785 | 3379.1 samples/s | 52.8 steps/s
[Step=16900 Epoch=65.1] | Loss=0.00294 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=2.786 | 3544.1 samples/s | 55.4 steps/s
[Step=16950 Epoch=65.2] | Loss=0.00201 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=2.787 | 3451.1 samples/s | 53.9 steps/s
[Step=17000 Epoch=65.4] | Loss=0.00154 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=2.787 | 3510.0 samples/s | 54.8 steps/s
[Step=17050 Epoch=65.6] | Loss=0.00125 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=2.787 | 4294.6 samples/s | 67.1 steps/s
[Step=17100 Epoch=65.8] | Loss=0.00105 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.436 | FP-Norm(final)=2.788 | 1553.3 samples/s | 24.3 steps/s
[Step=17150 Epoch=66.0] | Loss=0.00091 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=2.788 | 3501.7 samples/s | 54.7 steps/s
[Step=17200 Epoch=66.2] | Loss=0.00081 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.788 | 3484.0 samples/s | 54.4 steps/s
[Step=17250 Epoch=66.4] | Loss=0.00073 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.788 | 3472.4 samples/s | 54.3 steps/s
[Step=17300 Epoch=66.6] | Loss=0.00066 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.789 | 3897.3 samples/s | 60.9 steps/s
[Step=17350 Epoch=66.8] | Loss=0.00061 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=2.789 | 1618.3 samples/s | 25.3 steps/s
[Step=17400 Epoch=67.0] | Loss=0.00056 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.789 | 3464.1 samples/s | 54.1 steps/s
[Step=17450 Epoch=67.2] | Loss=0.00052 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=2.789 | 3503.2 samples/s | 54.7 steps/s
[Step=17500 Epoch=67.4] | Loss=0.00049 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.789 | 3451.9 samples/s | 53.9 steps/s
[Step=17550 Epoch=67.6] | Loss=0.00046 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.790 | 3583.3 samples/s | 56.0 steps/s
[Step=17600 Epoch=67.7] | Loss=0.00043 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.790 | 1658.3 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34906 | acc=0.8014 | tpr=0.7151 | fpr=0.0111 | 3493.2 samples/s | 13.6 steps/s
Avg test loss: 0.35683, Avg test acc: 0.79802, Avg tpr: 0.71102, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.38519 | acc=0.8294 | tpr=0.9779 | fpr=0.1733 | 3504.1 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.39200 | acc=0.8284 | tpr=0.9616 | fpr=0.1740 | 6300.7 samples/s | 24.6 steps/s
[Step= 150] | Loss=0.40112 | acc=0.8276 | tpr=0.9654 | fpr=0.1749 | 6457.5 samples/s | 25.2 steps/s
[Step= 200] | Loss=0.40313 | acc=0.8282 | tpr=0.9639 | fpr=0.1742 | 6633.7 samples/s | 25.9 steps/s
[Step= 250] | Loss=0.40482 | acc=0.8271 | tpr=0.9651 | fpr=0.1755 | 6607.8 samples/s | 25.8 steps/s
[Step= 300] | Loss=0.40674 | acc=0.8265 | tpr=0.9658 | fpr=0.1761 | 6595.5 samples/s | 25.8 steps/s
[Step= 350] | Loss=0.40778 | acc=0.8269 | tpr=0.9681 | fpr=0.1756 | 6210.6 samples/s | 24.3 steps/s
[Step= 400] | Loss=0.41041 | acc=0.8257 | tpr=0.9688 | fpr=0.1769 | 6271.6 samples/s | 24.5 steps/s
[Step= 450] | Loss=0.41288 | acc=0.8250 | tpr=0.9679 | fpr=0.1776 | 6588.0 samples/s | 25.7 steps/s
[Step= 500] | Loss=0.41307 | acc=0.8249 | tpr=0.9670 | fpr=0.1776 | 6736.1 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.41127 | acc=0.8252 | tpr=0.9642 | fpr=0.1773 | 10977.1 samples/s | 42.9 steps/s
Avg test loss: 0.41109, Avg test acc: 0.82523, Avg tpr: 0.96395, Avg fpr: 0.17729, total FA: 24617

server round 41/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=13601 Epoch=26.6] | Loss=0.16475 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.787 | 3621.7 samples/s | 56.6 steps/s
[Step=13650 Epoch=26.7] | Loss=0.03573 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.349 | FP-Norm(final)=2.784 | 3415.9 samples/s | 53.4 steps/s
[Step=13700 Epoch=26.8] | Loss=0.02315 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.380 | FP-Norm(final)=2.784 | 3686.5 samples/s | 57.6 steps/s
[Step=13750 Epoch=26.9] | Loss=0.01773 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.390 | FP-Norm(final)=2.784 | 3700.6 samples/s | 57.8 steps/s
[Step=13800 Epoch=27.0] | Loss=0.01523 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.785 | 3625.9 samples/s | 56.7 steps/s
[Step=13850 Epoch=27.1] | Loss=0.01348 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.395 | FP-Norm(final)=2.785 | 3620.3 samples/s | 56.6 steps/s
[Step=13900 Epoch=27.2] | Loss=0.01264 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.396 | FP-Norm(final)=2.786 | 3640.2 samples/s | 56.9 steps/s
[Step=13950 Epoch=27.3] | Loss=0.01192 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.787 | 3626.3 samples/s | 56.7 steps/s
[Step=14000 Epoch=27.4] | Loss=0.01133 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=2.787 | 3550.6 samples/s | 55.5 steps/s
[Step=14050 Epoch=27.5] | Loss=0.01084 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.399 | FP-Norm(final)=2.788 | 3609.1 samples/s | 56.4 steps/s
[Step=14100 Epoch=27.6] | Loss=0.01060 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.788 | 4441.6 samples/s | 69.4 steps/s
[Step=14150 Epoch=27.7] | Loss=0.01020 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.789 | 1604.0 samples/s | 25.1 steps/s
[Step=14200 Epoch=27.8] | Loss=0.00974 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.790 | 3663.5 samples/s | 57.2 steps/s
[Step=14250 Epoch=27.9] | Loss=0.00950 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.790 | 3636.6 samples/s | 56.8 steps/s
[Step=14300 Epoch=28.0] | Loss=0.00920 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.791 | 3652.2 samples/s | 57.1 steps/s
[Step=14350 Epoch=28.1] | Loss=0.00896 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.791 | 3618.2 samples/s | 56.5 steps/s
[Step=14400 Epoch=28.2] | Loss=0.00880 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.792 | 3629.9 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step14400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=67.8] | Loss=0.03900 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.787 | 3203.1 samples/s | 50.0 steps/s
[Step=17650 Epoch=67.9] | Loss=0.00564 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=2.792 | 3262.6 samples/s | 51.0 steps/s
[Step=17700 Epoch=68.1] | Loss=0.00293 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=2.792 | 3482.9 samples/s | 54.4 steps/s
[Step=17750 Epoch=68.3] | Loss=0.00199 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.793 | 3413.7 samples/s | 53.3 steps/s
[Step=17800 Epoch=68.5] | Loss=0.00153 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.793 | 3555.2 samples/s | 55.6 steps/s
[Step=17850 Epoch=68.7] | Loss=0.00125 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.794 | 4317.5 samples/s | 67.5 steps/s
[Step=17900 Epoch=68.9] | Loss=0.00106 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=2.794 | 1535.5 samples/s | 24.0 steps/s
[Step=17950 Epoch=69.1] | Loss=0.00092 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.794 | 3442.1 samples/s | 53.8 steps/s
[Step=18000 Epoch=69.3] | Loss=0.00082 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.795 | 3554.4 samples/s | 55.5 steps/s
[Step=18050 Epoch=69.5] | Loss=0.00073 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.795 | 3453.2 samples/s | 54.0 steps/s
[Step=18100 Epoch=69.7] | Loss=0.00067 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.795 | 3838.1 samples/s | 60.0 steps/s
[Step=18150 Epoch=69.9] | Loss=0.00061 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.795 | 1610.0 samples/s | 25.2 steps/s
[Step=18200 Epoch=70.1] | Loss=0.00056 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.795 | 3505.7 samples/s | 54.8 steps/s
[Step=18250 Epoch=70.3] | Loss=0.00053 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=2.796 | 3536.0 samples/s | 55.3 steps/s
[Step=18300 Epoch=70.4] | Loss=0.00049 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=2.796 | 3466.7 samples/s | 54.2 steps/s
[Step=18350 Epoch=70.6] | Loss=0.00046 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.796 | 3462.0 samples/s | 54.1 steps/s
[Step=18400 Epoch=70.8] | Loss=0.00044 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=2.796 | 1645.4 samples/s | 25.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38310 | acc=0.7841 | tpr=0.6894 | fpr=0.0102 | 3506.4 samples/s | 13.7 steps/s
Avg test loss: 0.39106, Avg test acc: 0.78151, Avg tpr: 0.68648, Avg fpr: 0.00949, total FA: 74

Testing server on iccad2012
[Step=  50] | Loss=0.35725 | acc=0.8489 | tpr=0.9735 | fpr=0.1533 | 3494.0 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.36432 | acc=0.8480 | tpr=0.9595 | fpr=0.1541 | 6667.1 samples/s | 26.0 steps/s
[Step= 150] | Loss=0.37363 | acc=0.8467 | tpr=0.9640 | fpr=0.1555 | 6581.2 samples/s | 25.7 steps/s
[Step= 200] | Loss=0.37563 | acc=0.8468 | tpr=0.9628 | fpr=0.1554 | 6835.7 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.37719 | acc=0.8456 | tpr=0.9642 | fpr=0.1566 | 6415.3 samples/s | 25.1 steps/s
[Step= 300] | Loss=0.37901 | acc=0.8450 | tpr=0.9651 | fpr=0.1572 | 6520.4 samples/s | 25.5 steps/s
[Step= 350] | Loss=0.38021 | acc=0.8452 | tpr=0.9681 | fpr=0.1570 | 6644.0 samples/s | 26.0 steps/s
[Step= 400] | Loss=0.38275 | acc=0.8440 | tpr=0.9688 | fpr=0.1583 | 6591.2 samples/s | 25.7 steps/s
[Step= 450] | Loss=0.38522 | acc=0.8434 | tpr=0.9679 | fpr=0.1589 | 6666.8 samples/s | 26.0 steps/s
[Step= 500] | Loss=0.38536 | acc=0.8432 | tpr=0.9665 | fpr=0.1590 | 6441.1 samples/s | 25.2 steps/s
[Step= 550] | Loss=0.38354 | acc=0.8435 | tpr=0.9642 | fpr=0.1587 | 11596.2 samples/s | 45.3 steps/s
Avg test loss: 0.38337, Avg test acc: 0.84357, Avg tpr: 0.96395, Avg fpr: 0.15862, total FA: 22024

server round 42/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=14401 Epoch=28.2] | Loss=0.21819 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.794 | 3538.7 samples/s | 55.3 steps/s
[Step=14450 Epoch=28.2] | Loss=0.03892 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.379 | FP-Norm(final)=2.790 | 3542.4 samples/s | 55.4 steps/s
[Step=14500 Epoch=28.3] | Loss=0.02410 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.790 | 3671.1 samples/s | 57.4 steps/s
[Step=14550 Epoch=28.4] | Loss=0.01962 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.790 | 3640.1 samples/s | 56.9 steps/s
[Step=14600 Epoch=28.5] | Loss=0.01655 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.791 | 3654.9 samples/s | 57.1 steps/s
[Step=14650 Epoch=28.6] | Loss=0.01439 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.791 | 3654.1 samples/s | 57.1 steps/s
[Step=14700 Epoch=28.7] | Loss=0.01324 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.403 | FP-Norm(final)=2.792 | 3648.5 samples/s | 57.0 steps/s
[Step=14750 Epoch=28.8] | Loss=0.01272 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.793 | 3643.2 samples/s | 56.9 steps/s
[Step=14800 Epoch=28.9] | Loss=0.01207 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.793 | 3606.4 samples/s | 56.3 steps/s
[Step=14850 Epoch=29.0] | Loss=0.01167 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.794 | 3640.6 samples/s | 56.9 steps/s
[Step=14900 Epoch=29.1] | Loss=0.01115 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.794 | 4455.9 samples/s | 69.6 steps/s
[Step=14950 Epoch=29.2] | Loss=0.01069 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.795 | 1585.8 samples/s | 24.8 steps/s
[Step=15000 Epoch=29.3] | Loss=0.01039 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.796 | 3667.4 samples/s | 57.3 steps/s
[Step=15050 Epoch=29.4] | Loss=0.01010 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.796 | 3727.4 samples/s | 58.2 steps/s
[Step=15100 Epoch=29.5] | Loss=0.00979 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.797 | 3683.3 samples/s | 57.6 steps/s
[Step=15150 Epoch=29.6] | Loss=0.00957 | Reg=0.00016 | acc=0.9688 | FP-Norm=0.403 | FP-Norm(final)=2.797 | 3726.0 samples/s | 58.2 steps/s
[Step=15200 Epoch=29.7] | Loss=0.00938 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.798 | 3702.8 samples/s | 57.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step15200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=70.5] | Loss=0.17009 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.795 | 3543.6 samples/s | 55.4 steps/s
[Step=18450 Epoch=70.7] | Loss=0.00868 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.430 | FP-Norm(final)=2.799 | 3251.5 samples/s | 50.8 steps/s
[Step=18500 Epoch=70.9] | Loss=0.00438 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=2.799 | 3518.8 samples/s | 55.0 steps/s
[Step=18550 Epoch=71.1] | Loss=0.00296 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.458 | FP-Norm(final)=2.800 | 3539.4 samples/s | 55.3 steps/s
[Step=18600 Epoch=71.3] | Loss=0.00225 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=2.800 | 3453.1 samples/s | 54.0 steps/s
[Step=18650 Epoch=71.5] | Loss=0.00182 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=2.800 | 4287.7 samples/s | 67.0 steps/s
[Step=18700 Epoch=71.7] | Loss=0.00153 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.449 | FP-Norm(final)=2.800 | 1523.6 samples/s | 23.8 steps/s
[Step=18750 Epoch=71.8] | Loss=0.00132 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.800 | 3531.9 samples/s | 55.2 steps/s
[Step=18800 Epoch=72.0] | Loss=0.00116 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.800 | 3442.4 samples/s | 53.8 steps/s
[Step=18850 Epoch=72.2] | Loss=0.00104 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.801 | 3475.7 samples/s | 54.3 steps/s
[Step=18900 Epoch=72.4] | Loss=0.00094 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.434 | FP-Norm(final)=2.801 | 3733.7 samples/s | 58.3 steps/s
[Step=18950 Epoch=72.6] | Loss=0.00086 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.430 | FP-Norm(final)=2.801 | 1607.2 samples/s | 25.1 steps/s
[Step=19000 Epoch=72.8] | Loss=0.00079 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.801 | 3503.9 samples/s | 54.7 steps/s
[Step=19050 Epoch=73.0] | Loss=0.00073 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=2.801 | 3453.0 samples/s | 54.0 steps/s
[Step=19100 Epoch=73.2] | Loss=0.00068 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=2.801 | 3466.7 samples/s | 54.2 steps/s
[Step=19150 Epoch=73.4] | Loss=0.00064 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.801 | 3441.2 samples/s | 53.8 steps/s
[Step=19200 Epoch=73.6] | Loss=0.00060 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.801 | 1683.5 samples/s | 26.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35201 | acc=0.8038 | tpr=0.7182 | fpr=0.0102 | 3469.0 samples/s | 13.6 steps/s
Avg test loss: 0.36028, Avg test acc: 0.80014, Avg tpr: 0.71376, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.39334 | acc=0.8304 | tpr=0.9779 | fpr=0.1723 | 3476.3 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.40007 | acc=0.8293 | tpr=0.9595 | fpr=0.1731 | 6474.4 samples/s | 25.3 steps/s
[Step= 150] | Loss=0.40954 | acc=0.8279 | tpr=0.9640 | fpr=0.1746 | 6688.8 samples/s | 26.1 steps/s
[Step= 200] | Loss=0.41141 | acc=0.8284 | tpr=0.9628 | fpr=0.1741 | 6552.4 samples/s | 25.6 steps/s
[Step= 250] | Loss=0.41325 | acc=0.8272 | tpr=0.9642 | fpr=0.1753 | 6546.5 samples/s | 25.6 steps/s
[Step= 300] | Loss=0.41511 | acc=0.8266 | tpr=0.9651 | fpr=0.1760 | 6326.2 samples/s | 24.7 steps/s
[Step= 350] | Loss=0.41618 | acc=0.8271 | tpr=0.9674 | fpr=0.1755 | 6538.8 samples/s | 25.5 steps/s
[Step= 400] | Loss=0.41889 | acc=0.8260 | tpr=0.9683 | fpr=0.1766 | 6188.4 samples/s | 24.2 steps/s
[Step= 450] | Loss=0.42135 | acc=0.8255 | tpr=0.9674 | fpr=0.1771 | 6660.1 samples/s | 26.0 steps/s
[Step= 500] | Loss=0.42146 | acc=0.8253 | tpr=0.9661 | fpr=0.1772 | 6884.0 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.41965 | acc=0.8256 | tpr=0.9634 | fpr=0.1769 | 10863.7 samples/s | 42.4 steps/s
Avg test loss: 0.41948, Avg test acc: 0.82557, Avg tpr: 0.96315, Avg fpr: 0.17693, total FA: 24566

server round 43/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=73.6] | Loss=0.06718 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.801 | 3468.4 samples/s | 54.2 steps/s
[Step=19250 Epoch=73.8] | Loss=0.00750 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.805 | 3305.2 samples/s | 51.6 steps/s
[Step=19300 Epoch=74.0] | Loss=0.00382 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.805 | 3485.8 samples/s | 54.5 steps/s
[Step=19350 Epoch=74.1] | Loss=0.00259 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=2.805 | 3510.5 samples/s | 54.9 steps/s
[Step=19400 Epoch=74.3] | Loss=0.00196 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=2.806 | 3500.4 samples/s | 54.7 steps/s
[Step=19450 Epoch=74.5] | Loss=0.00158 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.469 | FP-Norm(final)=2.806 | 4271.2 samples/s | 66.7 steps/s
[Step=19500 Epoch=74.7] | Loss=0.00133 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=2.806 | 1545.4 samples/s | 24.1 steps/s
[Step=19550 Epoch=74.9] | Loss=0.00114 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=2.806 | 3448.3 samples/s | 53.9 steps/s
[Step=19600 Epoch=75.1] | Loss=0.00101 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=2.806 | 3496.4 samples/s | 54.6 steps/s
[Step=19650 Epoch=75.3] | Loss=0.00090 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=2.806 | 3538.2 samples/s | 55.3 steps/s
[Step=19700 Epoch=75.5] | Loss=0.00081 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.449 | FP-Norm(final)=2.807 | 3825.4 samples/s | 59.8 steps/s
[Step=19750 Epoch=75.7] | Loss=0.00074 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=2.807 | 1611.8 samples/s | 25.2 steps/s
[Step=19800 Epoch=75.9] | Loss=0.00069 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=2.807 | 3530.7 samples/s | 55.2 steps/s
[Step=19850 Epoch=76.1] | Loss=0.00064 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=2.807 | 3515.7 samples/s | 54.9 steps/s
[Step=19900 Epoch=76.2] | Loss=0.00059 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=2.807 | 3429.9 samples/s | 53.6 steps/s
[Step=19950 Epoch=76.4] | Loss=0.00056 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=2.807 | 3436.4 samples/s | 53.7 steps/s
[Step=20000 Epoch=76.6] | Loss=0.00052 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.807 | 1697.8 samples/s | 26.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step20000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=70.8] | Loss=0.08607 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.801 | 3319.1 samples/s | 51.9 steps/s
[Step=18450 Epoch=71.0] | Loss=0.00508 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.805 | 3441.5 samples/s | 53.8 steps/s
[Step=18500 Epoch=71.2] | Loss=0.00262 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.806 | 3504.6 samples/s | 54.8 steps/s
[Step=18550 Epoch=71.4] | Loss=0.00178 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.806 | 3535.0 samples/s | 55.2 steps/s
[Step=18600 Epoch=71.6] | Loss=0.00136 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.807 | 3484.9 samples/s | 54.5 steps/s
[Step=18650 Epoch=71.8] | Loss=0.00111 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=2.807 | 4253.7 samples/s | 66.5 steps/s
[Step=18700 Epoch=72.0] | Loss=0.00094 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=2.807 | 1550.3 samples/s | 24.2 steps/s
[Step=18750 Epoch=72.2] | Loss=0.00081 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.808 | 3490.0 samples/s | 54.5 steps/s
[Step=18800 Epoch=72.4] | Loss=0.00072 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=2.808 | 3482.9 samples/s | 54.4 steps/s
[Step=18850 Epoch=72.6] | Loss=0.00064 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.808 | 3527.6 samples/s | 55.1 steps/s
[Step=18900 Epoch=72.8] | Loss=0.00058 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.808 | 3928.3 samples/s | 61.4 steps/s
[Step=18950 Epoch=72.9] | Loss=0.00054 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.808 | 1578.4 samples/s | 24.7 steps/s
[Step=19000 Epoch=73.1] | Loss=0.00050 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.808 | 3472.7 samples/s | 54.3 steps/s
[Step=19050 Epoch=73.3] | Loss=0.00046 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.809 | 3384.1 samples/s | 52.9 steps/s
[Step=19100 Epoch=73.5] | Loss=0.00043 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=2.809 | 3431.8 samples/s | 53.6 steps/s
[Step=19150 Epoch=73.7] | Loss=0.00041 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=2.809 | 3492.5 samples/s | 54.6 steps/s
[Step=19200 Epoch=73.9] | Loss=0.00038 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=2.809 | 1653.0 samples/s | 25.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34293 | acc=0.8122 | tpr=0.7303 | fpr=0.0099 | 3460.5 samples/s | 13.5 steps/s
Avg test loss: 0.35082, Avg test acc: 0.80800, Avg tpr: 0.72524, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.40176 | acc=0.8262 | tpr=0.9779 | fpr=0.1766 | 3366.9 samples/s | 13.2 steps/s
[Step= 100] | Loss=0.40874 | acc=0.8243 | tpr=0.9595 | fpr=0.1782 | 6310.9 samples/s | 24.7 steps/s
[Step= 150] | Loss=0.41829 | acc=0.8238 | tpr=0.9640 | fpr=0.1788 | 6380.5 samples/s | 24.9 steps/s
[Step= 200] | Loss=0.42004 | acc=0.8244 | tpr=0.9628 | fpr=0.1782 | 6273.8 samples/s | 24.5 steps/s
[Step= 250] | Loss=0.42182 | acc=0.8233 | tpr=0.9642 | fpr=0.1793 | 6345.7 samples/s | 24.8 steps/s
[Step= 300] | Loss=0.42368 | acc=0.8228 | tpr=0.9651 | fpr=0.1798 | 6610.7 samples/s | 25.8 steps/s
[Step= 350] | Loss=0.42477 | acc=0.8233 | tpr=0.9662 | fpr=0.1793 | 6519.1 samples/s | 25.5 steps/s
[Step= 400] | Loss=0.42756 | acc=0.8219 | tpr=0.9672 | fpr=0.1807 | 6482.9 samples/s | 25.3 steps/s
[Step= 450] | Loss=0.43010 | acc=0.8215 | tpr=0.9664 | fpr=0.1811 | 6255.4 samples/s | 24.4 steps/s
[Step= 500] | Loss=0.43024 | acc=0.8214 | tpr=0.9652 | fpr=0.1812 | 6587.2 samples/s | 25.7 steps/s
[Step= 550] | Loss=0.42831 | acc=0.8217 | tpr=0.9626 | fpr=0.1809 | 12129.5 samples/s | 47.4 steps/s
Avg test loss: 0.42815, Avg test acc: 0.82167, Avg tpr: 0.96236, Avg fpr: 0.18089, total FA: 25116

server round 44/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=31.2] | Loss=0.26761 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.805 | 3380.7 samples/s | 52.8 steps/s
[Step=16050 Epoch=31.3] | Loss=0.03084 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=2.801 | 3616.4 samples/s | 56.5 steps/s
[Step=16100 Epoch=31.4] | Loss=0.02067 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.802 | 3667.0 samples/s | 57.3 steps/s
[Step=16150 Epoch=31.5] | Loss=0.01706 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=2.802 | 3689.8 samples/s | 57.7 steps/s
[Step=16200 Epoch=31.6] | Loss=0.01461 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.803 | 3687.2 samples/s | 57.6 steps/s
[Step=16250 Epoch=31.7] | Loss=0.01343 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.374 | FP-Norm(final)=2.803 | 3696.5 samples/s | 57.8 steps/s
[Step=16300 Epoch=31.8] | Loss=0.01270 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.804 | 3700.5 samples/s | 57.8 steps/s
[Step=16350 Epoch=31.9] | Loss=0.01213 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.377 | FP-Norm(final)=2.805 | 3708.4 samples/s | 57.9 steps/s
[Step=16400 Epoch=32.0] | Loss=0.01155 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.805 | 3674.0 samples/s | 57.4 steps/s
[Step=16450 Epoch=32.1] | Loss=0.01109 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.377 | FP-Norm(final)=2.806 | 3642.5 samples/s | 56.9 steps/s
[Step=16500 Epoch=32.2] | Loss=0.01075 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.806 | 4273.3 samples/s | 66.8 steps/s
[Step=16550 Epoch=32.3] | Loss=0.01038 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.807 | 1579.2 samples/s | 24.7 steps/s
[Step=16600 Epoch=32.4] | Loss=0.01010 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.807 | 3602.6 samples/s | 56.3 steps/s
[Step=16650 Epoch=32.5] | Loss=0.00978 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.808 | 3614.7 samples/s | 56.5 steps/s
[Step=16700 Epoch=32.6] | Loss=0.00943 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.809 | 3636.4 samples/s | 56.8 steps/s
[Step=16750 Epoch=32.7] | Loss=0.00931 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.809 | 3637.9 samples/s | 56.8 steps/s
[Step=16800 Epoch=32.8] | Loss=0.00908 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.810 | 3653.5 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step16800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=73.9] | Loss=0.07534 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.805 | 3453.9 samples/s | 54.0 steps/s
[Step=19250 Epoch=74.1] | Loss=0.00724 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.809 | 3267.1 samples/s | 51.0 steps/s
[Step=19300 Epoch=74.3] | Loss=0.00382 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.477 | FP-Norm(final)=2.809 | 3466.6 samples/s | 54.2 steps/s
[Step=19350 Epoch=74.5] | Loss=0.00257 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.479 | FP-Norm(final)=2.810 | 3459.2 samples/s | 54.0 steps/s
[Step=19400 Epoch=74.7] | Loss=0.00197 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=2.810 | 3351.0 samples/s | 52.4 steps/s
[Step=19450 Epoch=74.9] | Loss=0.00159 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=2.810 | 4326.8 samples/s | 67.6 steps/s
[Step=19500 Epoch=75.1] | Loss=0.00134 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=2.811 | 1541.6 samples/s | 24.1 steps/s
[Step=19550 Epoch=75.3] | Loss=0.00115 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.460 | FP-Norm(final)=2.811 | 3520.5 samples/s | 55.0 steps/s
[Step=19600 Epoch=75.4] | Loss=0.00102 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.455 | FP-Norm(final)=2.811 | 3523.0 samples/s | 55.0 steps/s
[Step=19650 Epoch=75.6] | Loss=0.00091 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=2.811 | 3530.7 samples/s | 55.2 steps/s
[Step=19700 Epoch=75.8] | Loss=0.00082 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.811 | 3929.0 samples/s | 61.4 steps/s
[Step=19750 Epoch=76.0] | Loss=0.00075 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.811 | 1589.0 samples/s | 24.8 steps/s
[Step=19800 Epoch=76.2] | Loss=0.00070 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.812 | 3463.6 samples/s | 54.1 steps/s
[Step=19850 Epoch=76.4] | Loss=0.00064 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=2.812 | 3523.0 samples/s | 55.0 steps/s
[Step=19900 Epoch=76.6] | Loss=0.00060 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.812 | 3501.5 samples/s | 54.7 steps/s
[Step=19950 Epoch=76.8] | Loss=0.00056 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.812 | 3573.3 samples/s | 55.8 steps/s
[Step=20000 Epoch=77.0] | Loss=0.00053 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.812 | 1658.0 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36309 | acc=0.7994 | tpr=0.7117 | fpr=0.0102 | 3497.8 samples/s | 13.7 steps/s
Avg test loss: 0.37114, Avg test acc: 0.79554, Avg tpr: 0.70717, Avg fpr: 0.01013, total FA: 79

Testing server on iccad2012
[Step=  50] | Loss=0.37441 | acc=0.8427 | tpr=0.9779 | fpr=0.1598 | 3472.8 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.38205 | acc=0.8421 | tpr=0.9616 | fpr=0.1602 | 6480.4 samples/s | 25.3 steps/s
[Step= 150] | Loss=0.39141 | acc=0.8411 | tpr=0.9654 | fpr=0.1611 | 6408.3 samples/s | 25.0 steps/s
[Step= 200] | Loss=0.39341 | acc=0.8415 | tpr=0.9639 | fpr=0.1608 | 6452.8 samples/s | 25.2 steps/s
[Step= 250] | Loss=0.39484 | acc=0.8402 | tpr=0.9651 | fpr=0.1621 | 6913.3 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.39669 | acc=0.8396 | tpr=0.9658 | fpr=0.1627 | 6510.7 samples/s | 25.4 steps/s
[Step= 350] | Loss=0.39797 | acc=0.8402 | tpr=0.9681 | fpr=0.1621 | 6604.1 samples/s | 25.8 steps/s
[Step= 400] | Loss=0.40069 | acc=0.8391 | tpr=0.9694 | fpr=0.1633 | 6225.8 samples/s | 24.3 steps/s
[Step= 450] | Loss=0.40325 | acc=0.8385 | tpr=0.9684 | fpr=0.1639 | 6631.7 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.40332 | acc=0.8383 | tpr=0.9670 | fpr=0.1640 | 6346.0 samples/s | 24.8 steps/s
[Step= 550] | Loss=0.40137 | acc=0.8386 | tpr=0.9642 | fpr=0.1637 | 12011.8 samples/s | 46.9 steps/s
Avg test loss: 0.40119, Avg test acc: 0.83857, Avg tpr: 0.96395, Avg fpr: 0.16370, total FA: 22730

server round 45/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=29.7] | Loss=0.37971 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.812 | 3651.5 samples/s | 57.1 steps/s
[Step=15250 Epoch=29.8] | Loss=0.02942 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=2.809 | 3409.2 samples/s | 53.3 steps/s
[Step=15300 Epoch=29.9] | Loss=0.01924 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=2.809 | 3590.8 samples/s | 56.1 steps/s
[Step=15350 Epoch=30.0] | Loss=0.01486 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.368 | FP-Norm(final)=2.810 | 3605.2 samples/s | 56.3 steps/s
[Step=15400 Epoch=30.1] | Loss=0.01361 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=2.810 | 3609.8 samples/s | 56.4 steps/s
[Step=15450 Epoch=30.2] | Loss=0.01240 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=2.811 | 3596.8 samples/s | 56.2 steps/s
[Step=15500 Epoch=30.3] | Loss=0.01138 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.811 | 3653.8 samples/s | 57.1 steps/s
[Step=15550 Epoch=30.4] | Loss=0.01112 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.377 | FP-Norm(final)=2.812 | 3628.2 samples/s | 56.7 steps/s
[Step=15600 Epoch=30.5] | Loss=0.01043 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.812 | 3629.0 samples/s | 56.7 steps/s
[Step=15650 Epoch=30.6] | Loss=0.01001 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.813 | 3634.7 samples/s | 56.8 steps/s
[Step=15700 Epoch=30.7] | Loss=0.00971 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.813 | 4385.1 samples/s | 68.5 steps/s
[Step=15750 Epoch=30.8] | Loss=0.00939 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.814 | 1584.0 samples/s | 24.8 steps/s
[Step=15800 Epoch=30.9] | Loss=0.00916 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.377 | FP-Norm(final)=2.815 | 3681.5 samples/s | 57.5 steps/s
[Step=15850 Epoch=31.0] | Loss=0.00899 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.815 | 3640.6 samples/s | 56.9 steps/s
[Step=15900 Epoch=31.1] | Loss=0.00874 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.816 | 3606.9 samples/s | 56.4 steps/s
[Step=15950 Epoch=31.2] | Loss=0.00861 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.816 | 3686.7 samples/s | 57.6 steps/s
[Step=16000 Epoch=31.3] | Loss=0.00846 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.817 | 3715.8 samples/s | 58.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step16000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=77.0] | Loss=0.08690 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.812 | 3551.7 samples/s | 55.5 steps/s
[Step=20050 Epoch=77.2] | Loss=0.00608 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.817 | 3342.1 samples/s | 52.2 steps/s
[Step=20100 Epoch=77.4] | Loss=0.00311 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=2.817 | 3484.3 samples/s | 54.4 steps/s
[Step=20150 Epoch=77.6] | Loss=0.00210 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=2.818 | 3461.1 samples/s | 54.1 steps/s
[Step=20200 Epoch=77.8] | Loss=0.00160 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=2.818 | 3440.6 samples/s | 53.8 steps/s
[Step=20250 Epoch=78.0] | Loss=0.00130 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.448 | FP-Norm(final)=2.818 | 4330.2 samples/s | 67.7 steps/s
[Step=20300 Epoch=78.1] | Loss=0.00110 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.444 | FP-Norm(final)=2.818 | 1544.4 samples/s | 24.1 steps/s
[Step=20350 Epoch=78.3] | Loss=0.00095 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=2.818 | 3538.8 samples/s | 55.3 steps/s
[Step=20400 Epoch=78.5] | Loss=0.00084 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.434 | FP-Norm(final)=2.819 | 3498.9 samples/s | 54.7 steps/s
[Step=20450 Epoch=78.7] | Loss=0.00075 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.430 | FP-Norm(final)=2.819 | 3517.8 samples/s | 55.0 steps/s
[Step=20500 Epoch=78.9] | Loss=0.00068 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.819 | 3919.7 samples/s | 61.2 steps/s
[Step=20550 Epoch=79.1] | Loss=0.00063 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.819 | 1593.4 samples/s | 24.9 steps/s
[Step=20600 Epoch=79.3] | Loss=0.00058 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=2.819 | 3456.3 samples/s | 54.0 steps/s
[Step=20650 Epoch=79.5] | Loss=0.00054 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.819 | 3498.5 samples/s | 54.7 steps/s
[Step=20700 Epoch=79.7] | Loss=0.00050 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.819 | 3457.8 samples/s | 54.0 steps/s
[Step=20750 Epoch=79.9] | Loss=0.00047 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.819 | 3540.8 samples/s | 55.3 steps/s
[Step=20800 Epoch=80.1] | Loss=0.00044 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.820 | 1666.4 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36809 | acc=0.8000 | tpr=0.7123 | fpr=0.0097 | 3384.0 samples/s | 13.2 steps/s
Avg test loss: 0.37636, Avg test acc: 0.79490, Avg tpr: 0.70595, Avg fpr: 0.00949, total FA: 74

Testing server on iccad2012
[Step=  50] | Loss=0.37684 | acc=0.8428 | tpr=0.9779 | fpr=0.1596 | 3494.8 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.38411 | acc=0.8419 | tpr=0.9638 | fpr=0.1604 | 6680.7 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.39377 | acc=0.8411 | tpr=0.9669 | fpr=0.1612 | 6490.2 samples/s | 25.4 steps/s
[Step= 200] | Loss=0.39564 | acc=0.8418 | tpr=0.9650 | fpr=0.1605 | 6378.1 samples/s | 24.9 steps/s
[Step= 250] | Loss=0.39698 | acc=0.8408 | tpr=0.9651 | fpr=0.1615 | 6722.8 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.39889 | acc=0.8402 | tpr=0.9658 | fpr=0.1620 | 6571.0 samples/s | 25.7 steps/s
[Step= 350] | Loss=0.40021 | acc=0.8406 | tpr=0.9681 | fpr=0.1617 | 6690.3 samples/s | 26.1 steps/s
[Step= 400] | Loss=0.40292 | acc=0.8393 | tpr=0.9694 | fpr=0.1631 | 6269.0 samples/s | 24.5 steps/s
[Step= 450] | Loss=0.40556 | acc=0.8388 | tpr=0.9688 | fpr=0.1635 | 6603.3 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.40569 | acc=0.8385 | tpr=0.9674 | fpr=0.1638 | 6695.7 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.40369 | acc=0.8389 | tpr=0.9646 | fpr=0.1634 | 11953.3 samples/s | 46.7 steps/s
Avg test loss: 0.40353, Avg test acc: 0.83888, Avg tpr: 0.96434, Avg fpr: 0.16340, total FA: 22688

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=32.8] | Loss=0.22313 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.818 | 3398.8 samples/s | 53.1 steps/s
[Step=16850 Epoch=32.9] | Loss=0.03713 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.814 | 3493.8 samples/s | 54.6 steps/s
[Step=16900 Epoch=33.0] | Loss=0.02322 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.390 | FP-Norm(final)=2.814 | 3630.5 samples/s | 56.7 steps/s
[Step=16950 Epoch=33.1] | Loss=0.01809 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=2.815 | 3634.2 samples/s | 56.8 steps/s
[Step=17000 Epoch=33.2] | Loss=0.01595 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.396 | FP-Norm(final)=2.815 | 3652.1 samples/s | 57.1 steps/s
[Step=17050 Epoch=33.3] | Loss=0.01458 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.397 | FP-Norm(final)=2.816 | 3658.6 samples/s | 57.2 steps/s
[Step=17100 Epoch=33.4] | Loss=0.01342 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.816 | 3598.3 samples/s | 56.2 steps/s
[Step=17150 Epoch=33.4] | Loss=0.01251 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.817 | 3640.3 samples/s | 56.9 steps/s
[Step=17200 Epoch=33.5] | Loss=0.01220 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.817 | 3713.7 samples/s | 58.0 steps/s
[Step=17250 Epoch=33.6] | Loss=0.01170 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.818 | 3711.3 samples/s | 58.0 steps/s
[Step=17300 Epoch=33.7] | Loss=0.01121 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.818 | 4411.0 samples/s | 68.9 steps/s
[Step=17350 Epoch=33.8] | Loss=0.01066 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.819 | 1531.7 samples/s | 23.9 steps/s
[Step=17400 Epoch=33.9] | Loss=0.01021 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.820 | 3613.5 samples/s | 56.5 steps/s
[Step=17450 Epoch=34.0] | Loss=0.00994 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.820 | 3621.2 samples/s | 56.6 steps/s
[Step=17500 Epoch=34.1] | Loss=0.00970 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.821 | 3656.8 samples/s | 57.1 steps/s
[Step=17550 Epoch=34.2] | Loss=0.00949 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.821 | 3684.6 samples/s | 57.6 steps/s
[Step=17600 Epoch=34.3] | Loss=0.00932 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.822 | 3676.1 samples/s | 57.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_0/client_state-step17600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=31.3] | Loss=0.13159 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.818 | 3615.0 samples/s | 56.5 steps/s
[Step=16050 Epoch=31.4] | Loss=0.02908 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=2.815 | 3404.0 samples/s | 53.2 steps/s
[Step=16100 Epoch=31.5] | Loss=0.01949 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=2.815 | 3688.9 samples/s | 57.6 steps/s
[Step=16150 Epoch=31.6] | Loss=0.01563 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=2.816 | 3630.7 samples/s | 56.7 steps/s
[Step=16200 Epoch=31.7] | Loss=0.01339 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.816 | 3706.8 samples/s | 57.9 steps/s
[Step=16250 Epoch=31.8] | Loss=0.01246 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=2.817 | 3739.8 samples/s | 58.4 steps/s
[Step=16300 Epoch=31.9] | Loss=0.01125 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.367 | FP-Norm(final)=2.818 | 3703.9 samples/s | 57.9 steps/s
[Step=16350 Epoch=32.0] | Loss=0.01064 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.367 | FP-Norm(final)=2.818 | 3705.8 samples/s | 57.9 steps/s
[Step=16400 Epoch=32.1] | Loss=0.01040 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=2.819 | 3736.9 samples/s | 58.4 steps/s
[Step=16450 Epoch=32.2] | Loss=0.01008 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=2.820 | 3704.1 samples/s | 57.9 steps/s
[Step=16500 Epoch=32.3] | Loss=0.00969 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=2.820 | 4453.5 samples/s | 69.6 steps/s
[Step=16550 Epoch=32.4] | Loss=0.00944 | Reg=0.00014 | acc=0.9688 | FP-Norm=0.371 | FP-Norm(final)=2.821 | 1624.6 samples/s | 25.4 steps/s
[Step=16600 Epoch=32.5] | Loss=0.00909 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.821 | 3624.8 samples/s | 56.6 steps/s
[Step=16650 Epoch=32.6] | Loss=0.00892 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.373 | FP-Norm(final)=2.822 | 3668.4 samples/s | 57.3 steps/s
[Step=16700 Epoch=32.6] | Loss=0.00866 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=2.822 | 3659.2 samples/s | 57.2 steps/s
[Step=16750 Epoch=32.7] | Loss=0.00853 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.823 | 3641.8 samples/s | 56.9 steps/s
[Step=16800 Epoch=32.8] | Loss=0.00827 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.823 | 3728.6 samples/s | 58.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37943 | acc=0.7955 | tpr=0.7056 | fpr=0.0094 | 3484.9 samples/s | 13.6 steps/s
Avg test loss: 0.38738, Avg test acc: 0.79145, Avg tpr: 0.70082, Avg fpr: 0.00923, total FA: 72

Testing server on iccad2012
[Step=  50] | Loss=0.36865 | acc=0.8493 | tpr=0.9779 | fpr=0.1530 | 3518.5 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.37600 | acc=0.8486 | tpr=0.9638 | fpr=0.1536 | 6518.3 samples/s | 25.5 steps/s
[Step= 150] | Loss=0.38581 | acc=0.8478 | tpr=0.9669 | fpr=0.1544 | 6640.0 samples/s | 25.9 steps/s
[Step= 200] | Loss=0.38763 | acc=0.8482 | tpr=0.9650 | fpr=0.1540 | 6551.0 samples/s | 25.6 steps/s
[Step= 250] | Loss=0.38895 | acc=0.8471 | tpr=0.9659 | fpr=0.1551 | 6598.4 samples/s | 25.8 steps/s
[Step= 300] | Loss=0.39081 | acc=0.8463 | tpr=0.9665 | fpr=0.1559 | 6599.7 samples/s | 25.8 steps/s
[Step= 350] | Loss=0.39213 | acc=0.8467 | tpr=0.9681 | fpr=0.1555 | 6503.8 samples/s | 25.4 steps/s
[Step= 400] | Loss=0.39474 | acc=0.8454 | tpr=0.9694 | fpr=0.1568 | 6861.2 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.39739 | acc=0.8447 | tpr=0.9688 | fpr=0.1575 | 5960.0 samples/s | 23.3 steps/s
[Step= 500] | Loss=0.39751 | acc=0.8444 | tpr=0.9674 | fpr=0.1578 | 6485.1 samples/s | 25.3 steps/s
[Step= 550] | Loss=0.39549 | acc=0.8450 | tpr=0.9642 | fpr=0.1572 | 12125.9 samples/s | 47.4 steps/s
Avg test loss: 0.39534, Avg test acc: 0.84499, Avg tpr: 0.96395, Avg fpr: 0.15717, total FA: 21823

server round 47/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=32.8] | Loss=0.26748 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.823 | 3556.7 samples/s | 55.6 steps/s
[Step=16850 Epoch=32.9] | Loss=0.03689 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=2.819 | 3554.8 samples/s | 55.5 steps/s
[Step=16900 Epoch=33.0] | Loss=0.02245 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.819 | 3722.7 samples/s | 58.2 steps/s
[Step=16950 Epoch=33.1] | Loss=0.01773 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.819 | 3693.8 samples/s | 57.7 steps/s
[Step=17000 Epoch=33.2] | Loss=0.01521 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.820 | 3644.6 samples/s | 56.9 steps/s
[Step=17050 Epoch=33.3] | Loss=0.01368 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.820 | 3648.0 samples/s | 57.0 steps/s
[Step=17100 Epoch=33.4] | Loss=0.01249 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.821 | 3710.8 samples/s | 58.0 steps/s
[Step=17150 Epoch=33.5] | Loss=0.01197 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.401 | FP-Norm(final)=2.821 | 3707.5 samples/s | 57.9 steps/s
[Step=17200 Epoch=33.6] | Loss=0.01140 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.400 | FP-Norm(final)=2.822 | 3660.6 samples/s | 57.2 steps/s
[Step=17250 Epoch=33.7] | Loss=0.01092 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.822 | 3651.5 samples/s | 57.1 steps/s
[Step=17300 Epoch=33.8] | Loss=0.01056 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.823 | 4373.1 samples/s | 68.3 steps/s
[Step=17350 Epoch=33.9] | Loss=0.01012 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.823 | 1590.6 samples/s | 24.9 steps/s
[Step=17400 Epoch=34.0] | Loss=0.00979 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.396 | FP-Norm(final)=2.824 | 3649.0 samples/s | 57.0 steps/s
[Step=17450 Epoch=34.1] | Loss=0.00948 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.395 | FP-Norm(final)=2.824 | 3595.8 samples/s | 56.2 steps/s
[Step=17500 Epoch=34.2] | Loss=0.00929 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.825 | 3697.8 samples/s | 57.8 steps/s
[Step=17550 Epoch=34.3] | Loss=0.00903 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=2.825 | 3636.4 samples/s | 56.8 steps/s
[Step=17600 Epoch=34.4] | Loss=0.00879 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.394 | FP-Norm(final)=2.826 | 3676.0 samples/s | 57.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step17600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=76.6] | Loss=0.11489 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.823 | 3341.4 samples/s | 52.2 steps/s
[Step=20050 Epoch=76.8] | Loss=0.00553 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=2.827 | 3458.3 samples/s | 54.0 steps/s
[Step=20100 Epoch=77.0] | Loss=0.00287 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.828 | 3477.3 samples/s | 54.3 steps/s
[Step=20150 Epoch=77.2] | Loss=0.00195 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.828 | 3495.5 samples/s | 54.6 steps/s
[Step=20200 Epoch=77.4] | Loss=0.00148 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.828 | 3507.3 samples/s | 54.8 steps/s
[Step=20250 Epoch=77.6] | Loss=0.00120 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.828 | 4316.4 samples/s | 67.4 steps/s
[Step=20300 Epoch=77.8] | Loss=0.00101 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=2.828 | 1557.6 samples/s | 24.3 steps/s
[Step=20350 Epoch=78.0] | Loss=0.00087 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.829 | 3426.6 samples/s | 53.5 steps/s
[Step=20400 Epoch=78.2] | Loss=0.00077 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.829 | 3429.4 samples/s | 53.6 steps/s
[Step=20450 Epoch=78.4] | Loss=0.00069 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=2.829 | 3433.3 samples/s | 53.6 steps/s
[Step=20500 Epoch=78.5] | Loss=0.00063 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=2.829 | 3789.3 samples/s | 59.2 steps/s
[Step=20550 Epoch=78.7] | Loss=0.00057 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=2.829 | 1620.5 samples/s | 25.3 steps/s
[Step=20600 Epoch=78.9] | Loss=0.00053 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=2.829 | 3551.2 samples/s | 55.5 steps/s
[Step=20650 Epoch=79.1] | Loss=0.00049 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.829 | 3462.6 samples/s | 54.1 steps/s
[Step=20700 Epoch=79.3] | Loss=0.00046 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.829 | 3458.7 samples/s | 54.0 steps/s
[Step=20750 Epoch=79.5] | Loss=0.00043 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=2.829 | 3429.7 samples/s | 53.6 steps/s
[Step=20800 Epoch=79.7] | Loss=0.00041 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=2.830 | 1692.5 samples/s | 26.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36298 | acc=0.8057 | tpr=0.7204 | fpr=0.0092 | 3463.4 samples/s | 13.5 steps/s
Avg test loss: 0.37154, Avg test acc: 0.80131, Avg tpr: 0.71516, Avg fpr: 0.00923, total FA: 72

Testing server on iccad2012
[Step=  50] | Loss=0.38796 | acc=0.8400 | tpr=0.9735 | fpr=0.1624 | 3501.5 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.39485 | acc=0.8387 | tpr=0.9595 | fpr=0.1636 | 6559.5 samples/s | 25.6 steps/s
[Step= 150] | Loss=0.40489 | acc=0.8375 | tpr=0.9640 | fpr=0.1648 | 6676.9 samples/s | 26.1 steps/s
[Step= 200] | Loss=0.40644 | acc=0.8385 | tpr=0.9628 | fpr=0.1638 | 6459.6 samples/s | 25.2 steps/s
[Step= 250] | Loss=0.40790 | acc=0.8376 | tpr=0.9633 | fpr=0.1647 | 6776.8 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.40989 | acc=0.8370 | tpr=0.9644 | fpr=0.1653 | 6644.1 samples/s | 26.0 steps/s
[Step= 350] | Loss=0.41115 | acc=0.8376 | tpr=0.9656 | fpr=0.1648 | 6223.8 samples/s | 24.3 steps/s
[Step= 400] | Loss=0.41384 | acc=0.8363 | tpr=0.9666 | fpr=0.1660 | 6070.4 samples/s | 23.7 steps/s
[Step= 450] | Loss=0.41649 | acc=0.8358 | tpr=0.9664 | fpr=0.1666 | 6565.3 samples/s | 25.6 steps/s
[Step= 500] | Loss=0.41667 | acc=0.8355 | tpr=0.9652 | fpr=0.1668 | 6360.2 samples/s | 24.8 steps/s
[Step= 550] | Loss=0.41462 | acc=0.8358 | tpr=0.9622 | fpr=0.1665 | 12720.9 samples/s | 49.7 steps/s
Avg test loss: 0.41447, Avg test acc: 0.83585, Avg tpr: 0.96197, Avg fpr: 0.16644, total FA: 23110

server round 48/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=34.4] | Loss=0.26553 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.829 | 3495.2 samples/s | 54.6 steps/s
[Step=17650 Epoch=34.5] | Loss=0.03344 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=2.826 | 3691.0 samples/s | 57.7 steps/s
[Step=17700 Epoch=34.6] | Loss=0.02110 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=2.826 | 3651.1 samples/s | 57.0 steps/s
[Step=17750 Epoch=34.7] | Loss=0.01705 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.826 | 3674.5 samples/s | 57.4 steps/s
[Step=17800 Epoch=34.8] | Loss=0.01424 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.827 | 3605.9 samples/s | 56.3 steps/s
[Step=17850 Epoch=34.9] | Loss=0.01259 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.827 | 3681.4 samples/s | 57.5 steps/s
[Step=17900 Epoch=35.0] | Loss=0.01202 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.828 | 3695.3 samples/s | 57.7 steps/s
[Step=17950 Epoch=35.1] | Loss=0.01124 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.828 | 3699.1 samples/s | 57.8 steps/s
[Step=18000 Epoch=35.2] | Loss=0.01090 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.829 | 3731.6 samples/s | 58.3 steps/s
[Step=18050 Epoch=35.3] | Loss=0.01039 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.379 | FP-Norm(final)=2.829 | 3755.0 samples/s | 58.7 steps/s
[Step=18100 Epoch=35.4] | Loss=0.01002 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.830 | 4416.4 samples/s | 69.0 steps/s
[Step=18150 Epoch=35.5] | Loss=0.00956 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.830 | 1595.8 samples/s | 24.9 steps/s
[Step=18200 Epoch=35.6] | Loss=0.00911 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.831 | 3620.1 samples/s | 56.6 steps/s
[Step=18250 Epoch=35.7] | Loss=0.00873 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.832 | 3663.2 samples/s | 57.2 steps/s
[Step=18300 Epoch=35.8] | Loss=0.00852 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.832 | 3658.3 samples/s | 57.2 steps/s
[Step=18350 Epoch=35.9] | Loss=0.00834 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.378 | FP-Norm(final)=2.833 | 3679.9 samples/s | 57.5 steps/s
[Step=18400 Epoch=36.0] | Loss=0.00820 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.833 | 3632.4 samples/s | 56.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step18400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20801 Epoch=80.1] | Loss=0.09708 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.829 | 3460.4 samples/s | 54.1 steps/s
[Step=20850 Epoch=80.3] | Loss=0.00770 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.833 | 3341.9 samples/s | 52.2 steps/s
[Step=20900 Epoch=80.5] | Loss=0.00392 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.833 | 3452.1 samples/s | 53.9 steps/s
[Step=20950 Epoch=80.6] | Loss=0.00264 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=2.833 | 3409.4 samples/s | 53.3 steps/s
[Step=21000 Epoch=80.8] | Loss=0.00200 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.833 | 3446.6 samples/s | 53.9 steps/s
[Step=21050 Epoch=81.0] | Loss=0.00161 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.834 | 4239.8 samples/s | 66.2 steps/s
[Step=21100 Epoch=81.2] | Loss=0.00135 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.834 | 1558.1 samples/s | 24.3 steps/s
[Step=21150 Epoch=81.4] | Loss=0.00117 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=2.834 | 3419.9 samples/s | 53.4 steps/s
[Step=21200 Epoch=81.6] | Loss=0.00103 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.834 | 3410.2 samples/s | 53.3 steps/s
[Step=21250 Epoch=81.8] | Loss=0.00092 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.834 | 3532.9 samples/s | 55.2 steps/s
[Step=21300 Epoch=82.0] | Loss=0.00083 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.834 | 3926.5 samples/s | 61.4 steps/s
[Step=21350 Epoch=82.2] | Loss=0.00076 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.835 | 1605.2 samples/s | 25.1 steps/s
[Step=21400 Epoch=82.4] | Loss=0.00070 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=2.835 | 3498.0 samples/s | 54.7 steps/s
[Step=21450 Epoch=82.6] | Loss=0.00065 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=2.835 | 3504.6 samples/s | 54.8 steps/s
[Step=21500 Epoch=82.8] | Loss=0.00061 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.835 | 3505.2 samples/s | 54.8 steps/s
[Step=21550 Epoch=83.0] | Loss=0.00057 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=2.835 | 3552.5 samples/s | 55.5 steps/s
[Step=21600 Epoch=83.1] | Loss=0.00054 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=2.835 | 1690.5 samples/s | 26.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35196 | acc=0.8120 | tpr=0.7303 | fpr=0.0104 | 3470.6 samples/s | 13.6 steps/s
Avg test loss: 0.36060, Avg test acc: 0.80724, Avg tpr: 0.72419, Avg fpr: 0.01013, total FA: 79

Testing server on iccad2012
[Step=  50] | Loss=0.39771 | acc=0.8374 | tpr=0.9779 | fpr=0.1651 | 3504.5 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.40453 | acc=0.8358 | tpr=0.9595 | fpr=0.1665 | 6444.5 samples/s | 25.2 steps/s
[Step= 150] | Loss=0.41470 | acc=0.8347 | tpr=0.9640 | fpr=0.1677 | 6648.3 samples/s | 26.0 steps/s
[Step= 200] | Loss=0.41628 | acc=0.8355 | tpr=0.9628 | fpr=0.1668 | 6514.8 samples/s | 25.4 steps/s
[Step= 250] | Loss=0.41789 | acc=0.8344 | tpr=0.9642 | fpr=0.1680 | 6450.6 samples/s | 25.2 steps/s
[Step= 300] | Loss=0.41993 | acc=0.8340 | tpr=0.9651 | fpr=0.1683 | 6699.3 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.42119 | acc=0.8346 | tpr=0.9668 | fpr=0.1678 | 6543.9 samples/s | 25.6 steps/s
[Step= 400] | Loss=0.42390 | acc=0.8334 | tpr=0.9683 | fpr=0.1691 | 6413.0 samples/s | 25.1 steps/s
[Step= 450] | Loss=0.42657 | acc=0.8329 | tpr=0.9679 | fpr=0.1696 | 6312.9 samples/s | 24.7 steps/s
[Step= 500] | Loss=0.42676 | acc=0.8326 | tpr=0.9670 | fpr=0.1699 | 6615.0 samples/s | 25.8 steps/s
[Step= 550] | Loss=0.42469 | acc=0.8329 | tpr=0.9638 | fpr=0.1695 | 11885.0 samples/s | 46.4 steps/s
Avg test loss: 0.42454, Avg test acc: 0.83289, Avg tpr: 0.96355, Avg fpr: 0.16949, total FA: 23533

server round 49/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=36.0] | Loss=0.20732 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.835 | 3411.6 samples/s | 53.3 steps/s
[Step=18450 Epoch=36.1] | Loss=0.03480 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=2.832 | 3573.5 samples/s | 55.8 steps/s
[Step=18500 Epoch=36.2] | Loss=0.02094 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=2.832 | 3654.8 samples/s | 57.1 steps/s
[Step=18550 Epoch=36.3] | Loss=0.01674 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=2.832 | 3600.6 samples/s | 56.3 steps/s
[Step=18600 Epoch=36.4] | Loss=0.01469 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.833 | 3710.7 samples/s | 58.0 steps/s
[Step=18650 Epoch=36.5] | Loss=0.01332 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.833 | 3716.2 samples/s | 58.1 steps/s
[Step=18700 Epoch=36.6] | Loss=0.01231 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.833 | 3677.7 samples/s | 57.5 steps/s
[Step=18750 Epoch=36.7] | Loss=0.01149 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=2.834 | 3709.9 samples/s | 58.0 steps/s
[Step=18800 Epoch=36.8] | Loss=0.01093 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.834 | 3690.4 samples/s | 57.7 steps/s
[Step=18850 Epoch=36.9] | Loss=0.01033 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.835 | 3699.3 samples/s | 57.8 steps/s
[Step=18900 Epoch=36.9] | Loss=0.00993 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.373 | FP-Norm(final)=2.835 | 4437.9 samples/s | 69.3 steps/s
[Step=18950 Epoch=37.0] | Loss=0.00968 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=2.836 | 1593.3 samples/s | 24.9 steps/s
[Step=19000 Epoch=37.1] | Loss=0.00923 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=2.836 | 3646.4 samples/s | 57.0 steps/s
[Step=19050 Epoch=37.2] | Loss=0.00905 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=2.837 | 3648.4 samples/s | 57.0 steps/s
[Step=19100 Epoch=37.3] | Loss=0.00875 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=2.837 | 3657.6 samples/s | 57.2 steps/s
[Step=19150 Epoch=37.4] | Loss=0.00844 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.838 | 3641.7 samples/s | 56.9 steps/s
[Step=19200 Epoch=37.5] | Loss=0.00818 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.372 | FP-Norm(final)=2.838 | 3638.6 samples/s | 56.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_asml1_1/client_state-step19200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20801 Epoch=79.7] | Loss=0.09094 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.835 | 3471.8 samples/s | 54.2 steps/s
[Step=20850 Epoch=79.9] | Loss=0.00757 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=2.840 | 3384.8 samples/s | 52.9 steps/s
[Step=20900 Epoch=80.1] | Loss=0.00383 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=2.840 | 3476.7 samples/s | 54.3 steps/s
[Step=20950 Epoch=80.3] | Loss=0.00258 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.482 | FP-Norm(final)=2.841 | 3457.9 samples/s | 54.0 steps/s
[Step=21000 Epoch=80.5] | Loss=0.00194 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.479 | FP-Norm(final)=2.841 | 3442.4 samples/s | 53.8 steps/s
[Step=21050 Epoch=80.7] | Loss=0.00157 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.474 | FP-Norm(final)=2.841 | 4188.6 samples/s | 65.4 steps/s
[Step=21100 Epoch=80.8] | Loss=0.00131 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.469 | FP-Norm(final)=2.841 | 1550.2 samples/s | 24.2 steps/s
[Step=21150 Epoch=81.0] | Loss=0.00113 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.841 | 3411.5 samples/s | 53.3 steps/s
[Step=21200 Epoch=81.2] | Loss=0.00099 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=2.841 | 3465.6 samples/s | 54.1 steps/s
[Step=21250 Epoch=81.4] | Loss=0.00089 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=2.841 | 3451.1 samples/s | 53.9 steps/s
[Step=21300 Epoch=81.6] | Loss=0.00080 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=2.841 | 3763.0 samples/s | 58.8 steps/s
[Step=21350 Epoch=81.8] | Loss=0.00073 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.841 | 1607.3 samples/s | 25.1 steps/s
[Step=21400 Epoch=82.0] | Loss=0.00067 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.841 | 3436.4 samples/s | 53.7 steps/s
[Step=21450 Epoch=82.2] | Loss=0.00062 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.841 | 3468.6 samples/s | 54.2 steps/s
[Step=21500 Epoch=82.4] | Loss=0.00058 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=2.841 | 3520.8 samples/s | 55.0 steps/s
[Step=21550 Epoch=82.6] | Loss=0.00054 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.842 | 3521.4 samples/s | 55.0 steps/s
[Step=21600 Epoch=82.8] | Loss=0.00051 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.842 | 1671.0 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37878 | acc=0.7987 | tpr=0.7104 | fpr=0.0094 | 3444.8 samples/s | 13.5 steps/s
Avg test loss: 0.38751, Avg test acc: 0.79490, Avg tpr: 0.70583, Avg fpr: 0.00923, total FA: 72

Testing server on iccad2012
[Step=  50] | Loss=0.37323 | acc=0.8497 | tpr=0.9779 | fpr=0.1526 | 3457.7 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.37984 | acc=0.8491 | tpr=0.9595 | fpr=0.1529 | 6750.7 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.38981 | acc=0.8478 | tpr=0.9640 | fpr=0.1543 | 6473.5 samples/s | 25.3 steps/s
[Step= 200] | Loss=0.39145 | acc=0.8487 | tpr=0.9628 | fpr=0.1534 | 6598.8 samples/s | 25.8 steps/s
[Step= 250] | Loss=0.39301 | acc=0.8480 | tpr=0.9642 | fpr=0.1542 | 6238.2 samples/s | 24.4 steps/s
[Step= 300] | Loss=0.39496 | acc=0.8473 | tpr=0.9651 | fpr=0.1548 | 6511.7 samples/s | 25.4 steps/s
[Step= 350] | Loss=0.39634 | acc=0.8477 | tpr=0.9674 | fpr=0.1544 | 6428.4 samples/s | 25.1 steps/s
[Step= 400] | Loss=0.39887 | acc=0.8467 | tpr=0.9683 | fpr=0.1555 | 6598.4 samples/s | 25.8 steps/s
[Step= 450] | Loss=0.40151 | acc=0.8461 | tpr=0.9679 | fpr=0.1561 | 6523.5 samples/s | 25.5 steps/s
[Step= 500] | Loss=0.40164 | acc=0.8458 | tpr=0.9665 | fpr=0.1564 | 6383.7 samples/s | 24.9 steps/s
[Step= 550] | Loss=0.39965 | acc=0.8462 | tpr=0.9634 | fpr=0.1560 | 11616.2 samples/s | 45.4 steps/s
Avg test loss: 0.39949, Avg test acc: 0.84618, Avg tpr: 0.96315, Avg fpr: 0.15595, total FA: 21653
