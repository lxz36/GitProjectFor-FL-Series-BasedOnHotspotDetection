#clients of iccad2012: 1
#clients of asml1: 1
select ratio: 1.0
Total num clients: 2
client model path: ['models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0', 'models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (49916, 144, 32)
Resampled dataset to size (65551, 144, 32)
Using transform option: train
#pos = 34281, #neg = 31270
loading data into the main memory...
Allocated dataset with size (18300, 144, 32)
Resampled dataset to size (33952, 144, 32)
Using transform option: train
#pos = 16856, #neg = 17096
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33857 | Reg=0.00357 | FP-Reg=0.000 | acc=0.6250 | L2-Norm=18.907 | L2-Norm(final)=1.930 | 1432.1 samples/s | 22.4 steps/s
[Step=  50 Epoch= 0.0] | Loss=0.29784 | Reg=0.00358 | FP-Reg=0.009 | acc=0.6875 | L2-Norm=18.915 | L2-Norm(final)=1.927 | 3499.8 samples/s | 54.7 steps/s
[Step= 100 Epoch= 0.1] | Loss=0.26116 | Reg=0.00359 | FP-Reg=0.016 | acc=0.8281 | L2-Norm=18.940 | L2-Norm(final)=1.940 | 3652.8 samples/s | 57.1 steps/s
[Step= 150 Epoch= 0.1] | Loss=0.23225 | Reg=0.00359 | FP-Reg=0.021 | acc=0.8906 | L2-Norm=18.957 | L2-Norm(final)=1.950 | 3674.2 samples/s | 57.4 steps/s
[Step= 200 Epoch= 0.2] | Loss=0.21731 | Reg=0.00360 | FP-Reg=0.025 | acc=0.7969 | L2-Norm=18.969 | L2-Norm(final)=1.959 | 3601.6 samples/s | 56.3 steps/s
[Step= 250 Epoch= 0.2] | Loss=0.20773 | Reg=0.00360 | FP-Reg=0.029 | acc=0.7344 | L2-Norm=18.980 | L2-Norm(final)=1.963 | 3593.7 samples/s | 56.2 steps/s
[Step= 300 Epoch= 0.3] | Loss=0.19719 | Reg=0.00361 | FP-Reg=0.032 | acc=0.8906 | L2-Norm=18.987 | L2-Norm(final)=1.970 | 3579.3 samples/s | 55.9 steps/s
[Step= 350 Epoch= 0.3] | Loss=0.18947 | Reg=0.00361 | FP-Reg=0.034 | acc=0.9062 | L2-Norm=18.994 | L2-Norm(final)=1.976 | 3563.3 samples/s | 55.7 steps/s
[Step= 400 Epoch= 0.4] | Loss=0.18182 | Reg=0.00361 | FP-Reg=0.036 | acc=0.9375 | L2-Norm=19.000 | L2-Norm(final)=1.982 | 3566.7 samples/s | 55.7 steps/s
[Step= 450 Epoch= 0.4] | Loss=0.17763 | Reg=0.00361 | FP-Reg=0.038 | acc=0.9062 | L2-Norm=19.005 | L2-Norm(final)=1.988 | 3574.2 samples/s | 55.8 steps/s
[Step= 500 Epoch= 0.5] | Loss=0.17347 | Reg=0.00361 | FP-Reg=0.039 | acc=0.8906 | L2-Norm=19.010 | L2-Norm(final)=1.993 | 3606.2 samples/s | 56.3 steps/s
[Step= 550 Epoch= 0.5] | Loss=0.16956 | Reg=0.00362 | FP-Reg=0.041 | acc=0.9219 | L2-Norm=19.013 | L2-Norm(final)=1.998 | 3568.4 samples/s | 55.8 steps/s
[Step= 600 Epoch= 0.6] | Loss=0.16606 | Reg=0.00362 | FP-Reg=0.042 | acc=0.9062 | L2-Norm=19.017 | L2-Norm(final)=2.003 | 3574.1 samples/s | 55.8 steps/s
[Step= 650 Epoch= 0.6] | Loss=0.16328 | Reg=0.00362 | FP-Reg=0.043 | acc=0.8906 | L2-Norm=19.019 | L2-Norm(final)=2.009 | 3669.1 samples/s | 57.3 steps/s
[Step= 700 Epoch= 0.7] | Loss=0.15983 | Reg=0.00362 | FP-Reg=0.044 | acc=0.9219 | L2-Norm=19.022 | L2-Norm(final)=2.014 | 3680.3 samples/s | 57.5 steps/s
[Step= 750 Epoch= 0.7] | Loss=0.15679 | Reg=0.00362 | FP-Reg=0.045 | acc=0.9219 | L2-Norm=19.024 | L2-Norm(final)=2.019 | 3560.8 samples/s | 55.6 steps/s
[Step= 800 Epoch= 0.8] | Loss=0.15445 | Reg=0.00362 | FP-Reg=0.046 | acc=0.9219 | L2-Norm=19.027 | L2-Norm(final)=2.023 | 3583.0 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36099 | Reg=0.00357 | FP-Reg=0.000 | acc=0.5156 | L2-Norm=18.907 | L2-Norm(final)=1.930 | 4389.4 samples/s | 68.6 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.17011 | Reg=0.00359 | FP-Reg=0.016 | acc=0.9844 | L2-Norm=18.935 | L2-Norm(final)=1.940 | 3026.9 samples/s | 47.3 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.11821 | Reg=0.00359 | FP-Reg=0.022 | acc=0.9844 | L2-Norm=18.954 | L2-Norm(final)=1.955 | 3444.3 samples/s | 53.8 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.08988 | Reg=0.00360 | FP-Reg=0.024 | acc=0.9688 | L2-Norm=18.961 | L2-Norm(final)=1.968 | 3415.8 samples/s | 53.4 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.07437 | Reg=0.00360 | FP-Reg=0.025 | acc=0.9844 | L2-Norm=18.964 | L2-Norm(final)=1.978 | 3374.8 samples/s | 52.7 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.06661 | Reg=0.00360 | FP-Reg=0.027 | acc=1.0000 | L2-Norm=18.967 | L2-Norm(final)=1.986 | 3381.5 samples/s | 52.8 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.05849 | Reg=0.00360 | FP-Reg=0.028 | acc=0.9844 | L2-Norm=18.969 | L2-Norm(final)=1.993 | 3410.3 samples/s | 53.3 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.05423 | Reg=0.00360 | FP-Reg=0.028 | acc=0.9844 | L2-Norm=18.970 | L2-Norm(final)=1.999 | 3400.9 samples/s | 53.1 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.05007 | Reg=0.00360 | FP-Reg=0.028 | acc=1.0000 | L2-Norm=18.970 | L2-Norm(final)=2.005 | 3419.3 samples/s | 53.4 steps/s
[Step= 450 Epoch= 0.8] | Loss=0.04659 | Reg=0.00360 | FP-Reg=0.029 | acc=1.0000 | L2-Norm=18.970 | L2-Norm(final)=2.010 | 3471.4 samples/s | 54.2 steps/s
[Step= 500 Epoch= 0.9] | Loss=0.04371 | Reg=0.00360 | FP-Reg=0.029 | acc=1.0000 | L2-Norm=18.971 | L2-Norm(final)=2.015 | 3472.7 samples/s | 54.3 steps/s
[Step= 550 Epoch= 1.0] | Loss=0.04123 | Reg=0.00360 | FP-Reg=0.029 | acc=1.0000 | L2-Norm=18.971 | L2-Norm(final)=2.020 | 1753.1 samples/s | 27.4 steps/s
[Step= 600 Epoch= 1.1] | Loss=0.03876 | Reg=0.00360 | FP-Reg=0.029 | acc=0.9844 | L2-Norm=18.971 | L2-Norm(final)=2.024 | 3420.4 samples/s | 53.4 steps/s
[Step= 650 Epoch= 1.2] | Loss=0.03686 | Reg=0.00360 | FP-Reg=0.029 | acc=0.9531 | L2-Norm=18.971 | L2-Norm(final)=2.028 | 3360.8 samples/s | 52.5 steps/s
[Step= 700 Epoch= 1.3] | Loss=0.03605 | Reg=0.00360 | FP-Reg=0.029 | acc=1.0000 | L2-Norm=18.972 | L2-Norm(final)=2.032 | 3370.6 samples/s | 52.7 steps/s
[Step= 750 Epoch= 1.4] | Loss=0.03471 | Reg=0.00360 | FP-Reg=0.029 | acc=1.0000 | L2-Norm=18.972 | L2-Norm(final)=2.035 | 3391.9 samples/s | 53.0 steps/s
[Step= 800 Epoch= 1.5] | Loss=0.03340 | Reg=0.00360 | FP-Reg=0.029 | acc=1.0000 | L2-Norm=18.972 | L2-Norm(final)=2.038 | 3447.1 samples/s | 53.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28982 | acc=0.6904 | tpr=0.6982 | fpr=0.3266 | 3845.1 samples/s | 15.0 steps/s
Avg test loss: 0.28939, Avg test acc: 0.69264, Avg tpr: 0.69867, Avg fpr: 0.32060, total FA: 2501

Testing server on iccad2012
[Step=  50] | Loss=0.40508 | acc=0.5336 | tpr=0.9956 | fpr=0.4747 | 3824.1 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.40468 | acc=0.5338 | tpr=0.9979 | fpr=0.4748 | 7081.9 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.40483 | acc=0.5355 | tpr=0.9971 | fpr=0.4730 | 7244.8 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.40489 | acc=0.5349 | tpr=0.9967 | fpr=0.4735 | 6827.4 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.40624 | acc=0.5330 | tpr=0.9974 | fpr=0.4755 | 7258.1 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.40646 | acc=0.5327 | tpr=0.9956 | fpr=0.4757 | 6933.7 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.40693 | acc=0.5319 | tpr=0.9944 | fpr=0.4765 | 7016.3 samples/s | 27.4 steps/s
[Step= 400] | Loss=0.40725 | acc=0.5310 | tpr=0.9940 | fpr=0.4774 | 7239.7 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.40732 | acc=0.5318 | tpr=0.9937 | fpr=0.4766 | 6927.8 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.40730 | acc=0.5315 | tpr=0.9943 | fpr=0.4769 | 6932.8 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.40704 | acc=0.5317 | tpr=0.9940 | fpr=0.4767 | 13119.3 samples/s | 51.2 steps/s
Avg test loss: 0.40700, Avg test acc: 0.53172, Avg tpr: 0.99406, Avg fpr: 0.47668, total FA: 66186

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 0.8] | Loss=0.31171 | Reg=0.00360 | FP-Reg=0.000 | acc=0.7031 | L2-Norm=18.965 | L2-Norm(final)=2.078 | 4006.4 samples/s | 62.6 steps/s
[Step= 850 Epoch= 0.8] | Loss=0.18274 | Reg=0.00361 | FP-Reg=0.008 | acc=0.8594 | L2-Norm=18.990 | L2-Norm(final)=2.087 | 3424.8 samples/s | 53.5 steps/s
[Step= 900 Epoch= 0.9] | Loss=0.15962 | Reg=0.00361 | FP-Reg=0.012 | acc=0.8906 | L2-Norm=19.010 | L2-Norm(final)=2.092 | 3516.3 samples/s | 54.9 steps/s
[Step= 950 Epoch= 0.9] | Loss=0.15129 | Reg=0.00362 | FP-Reg=0.015 | acc=0.9062 | L2-Norm=19.024 | L2-Norm(final)=2.098 | 3635.2 samples/s | 56.8 steps/s
[Step=1000 Epoch= 1.0] | Loss=0.14222 | Reg=0.00362 | FP-Reg=0.017 | acc=0.9219 | L2-Norm=19.034 | L2-Norm(final)=2.103 | 3604.2 samples/s | 56.3 steps/s
[Step=1050 Epoch= 1.0] | Loss=0.13774 | Reg=0.00363 | FP-Reg=0.019 | acc=0.8750 | L2-Norm=19.043 | L2-Norm(final)=2.109 | 3623.4 samples/s | 56.6 steps/s
[Step=1100 Epoch= 1.1] | Loss=0.13376 | Reg=0.00363 | FP-Reg=0.021 | acc=0.9062 | L2-Norm=19.051 | L2-Norm(final)=2.114 | 3540.3 samples/s | 55.3 steps/s
[Step=1150 Epoch= 1.1] | Loss=0.12975 | Reg=0.00363 | FP-Reg=0.022 | acc=0.9375 | L2-Norm=19.058 | L2-Norm(final)=2.118 | 3542.3 samples/s | 55.3 steps/s
[Step=1200 Epoch= 1.2] | Loss=0.12640 | Reg=0.00363 | FP-Reg=0.023 | acc=0.9219 | L2-Norm=19.063 | L2-Norm(final)=2.123 | 3555.0 samples/s | 55.5 steps/s
[Step=1250 Epoch= 1.2] | Loss=0.12273 | Reg=0.00364 | FP-Reg=0.024 | acc=0.9062 | L2-Norm=19.068 | L2-Norm(final)=2.127 | 3553.8 samples/s | 55.5 steps/s
[Step=1300 Epoch= 1.3] | Loss=0.11982 | Reg=0.00364 | FP-Reg=0.025 | acc=0.8750 | L2-Norm=19.073 | L2-Norm(final)=2.131 | 3546.0 samples/s | 55.4 steps/s
[Step=1350 Epoch= 1.3] | Loss=0.11796 | Reg=0.00364 | FP-Reg=0.026 | acc=0.8906 | L2-Norm=19.077 | L2-Norm(final)=2.134 | 3558.5 samples/s | 55.6 steps/s
[Step=1400 Epoch= 1.4] | Loss=0.11637 | Reg=0.00364 | FP-Reg=0.027 | acc=0.9062 | L2-Norm=19.080 | L2-Norm(final)=2.137 | 3569.2 samples/s | 55.8 steps/s
[Step=1450 Epoch= 1.4] | Loss=0.11445 | Reg=0.00364 | FP-Reg=0.027 | acc=0.9062 | L2-Norm=19.083 | L2-Norm(final)=2.141 | 3548.8 samples/s | 55.5 steps/s
[Step=1500 Epoch= 1.5] | Loss=0.11347 | Reg=0.00364 | FP-Reg=0.028 | acc=0.9219 | L2-Norm=19.085 | L2-Norm(final)=2.144 | 3527.7 samples/s | 55.1 steps/s
[Step=1550 Epoch= 1.5] | Loss=0.11168 | Reg=0.00364 | FP-Reg=0.028 | acc=0.9375 | L2-Norm=19.088 | L2-Norm(final)=2.147 | 3558.2 samples/s | 55.6 steps/s
[Step=1600 Epoch= 1.6] | Loss=0.11034 | Reg=0.00364 | FP-Reg=0.029 | acc=0.8750 | L2-Norm=19.091 | L2-Norm(final)=2.150 | 3563.2 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step1600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 1.5] | Loss=0.22782 | Reg=0.00360 | FP-Reg=0.000 | acc=0.7188 | L2-Norm=18.965 | L2-Norm(final)=2.078 | 3803.9 samples/s | 59.4 steps/s
[Step= 850 Epoch= 1.6] | Loss=0.05822 | Reg=0.00361 | FP-Reg=0.012 | acc=0.9688 | L2-Norm=18.999 | L2-Norm(final)=2.094 | 3271.0 samples/s | 51.1 steps/s
[Step= 900 Epoch= 1.7] | Loss=0.04347 | Reg=0.00361 | FP-Reg=0.014 | acc=0.9375 | L2-Norm=19.006 | L2-Norm(final)=2.099 | 3349.5 samples/s | 52.3 steps/s
[Step= 950 Epoch= 1.8] | Loss=0.03376 | Reg=0.00361 | FP-Reg=0.015 | acc=1.0000 | L2-Norm=19.009 | L2-Norm(final)=2.105 | 3361.9 samples/s | 52.5 steps/s
[Step=1000 Epoch= 1.9] | Loss=0.02777 | Reg=0.00361 | FP-Reg=0.015 | acc=0.9844 | L2-Norm=19.009 | L2-Norm(final)=2.111 | 3355.7 samples/s | 52.4 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.02427 | Reg=0.00361 | FP-Reg=0.015 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.117 | 3364.3 samples/s | 52.6 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.02131 | Reg=0.00361 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.008 | L2-Norm(final)=2.122 | 3369.8 samples/s | 52.7 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.02021 | Reg=0.00361 | FP-Reg=0.014 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.127 | 3357.3 samples/s | 52.5 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.01932 | Reg=0.00361 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.010 | L2-Norm(final)=2.130 | 3380.5 samples/s | 52.8 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.01828 | Reg=0.00361 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.010 | L2-Norm(final)=2.133 | 3351.2 samples/s | 52.4 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.01749 | Reg=0.00361 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.010 | L2-Norm(final)=2.136 | 3422.9 samples/s | 53.5 steps/s
[Step=1350 Epoch= 2.5] | Loss=0.01677 | Reg=0.00361 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.011 | L2-Norm(final)=2.139 | 1805.0 samples/s | 28.2 steps/s
[Step=1400 Epoch= 2.6] | Loss=0.01600 | Reg=0.00361 | FP-Reg=0.014 | acc=1.0000 | L2-Norm=19.012 | L2-Norm(final)=2.142 | 3475.3 samples/s | 54.3 steps/s
[Step=1450 Epoch= 2.7] | Loss=0.01554 | Reg=0.00361 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.012 | L2-Norm(final)=2.144 | 3413.7 samples/s | 53.3 steps/s
[Step=1500 Epoch= 2.8] | Loss=0.01500 | Reg=0.00361 | FP-Reg=0.014 | acc=1.0000 | L2-Norm=19.013 | L2-Norm(final)=2.147 | 3445.0 samples/s | 53.8 steps/s
[Step=1550 Epoch= 2.9] | Loss=0.01474 | Reg=0.00362 | FP-Reg=0.014 | acc=0.9531 | L2-Norm=19.013 | L2-Norm(final)=2.149 | 3396.3 samples/s | 53.1 steps/s
[Step=1600 Epoch= 3.0] | Loss=0.01465 | Reg=0.00362 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.014 | L2-Norm(final)=2.150 | 3416.2 samples/s | 53.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38514 | acc=0.6251 | tpr=0.4878 | fpr=0.0768 | 3849.7 samples/s | 15.0 steps/s
Avg test loss: 0.38743, Avg test acc: 0.62357, Avg tpr: 0.48657, Avg fpr: 0.07512, total FA: 586

Testing server on iccad2012
[Step=  50] | Loss=0.29929 | acc=0.7502 | tpr=0.9912 | fpr=0.2542 | 3832.3 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.29818 | acc=0.7512 | tpr=0.9915 | fpr=0.2533 | 7075.8 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.29928 | acc=0.7497 | tpr=0.9899 | fpr=0.2547 | 6889.0 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.29919 | acc=0.7492 | tpr=0.9902 | fpr=0.2552 | 7023.8 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.30060 | acc=0.7478 | tpr=0.9913 | fpr=0.2566 | 6976.5 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.30096 | acc=0.7482 | tpr=0.9876 | fpr=0.2561 | 7138.0 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.30187 | acc=0.7478 | tpr=0.9869 | fpr=0.2565 | 7076.8 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.30207 | acc=0.7475 | tpr=0.9852 | fpr=0.2568 | 7033.3 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.30231 | acc=0.7482 | tpr=0.9854 | fpr=0.2561 | 6881.6 samples/s | 26.9 steps/s
[Step= 500] | Loss=0.30222 | acc=0.7483 | tpr=0.9859 | fpr=0.2560 | 7015.5 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.30168 | acc=0.7485 | tpr=0.9857 | fpr=0.2558 | 12984.8 samples/s | 50.7 steps/s
Avg test loss: 0.30161, Avg test acc: 0.74858, Avg tpr: 0.98534, Avg fpr: 0.25573, total FA: 35507

server round 2/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 1.6] | Loss=0.29548 | Reg=0.00362 | FP-Reg=0.000 | acc=0.6875 | L2-Norm=19.036 | L2-Norm(final)=2.181 | 4423.4 samples/s | 69.1 steps/s
[Step=1650 Epoch= 1.6] | Loss=0.12612 | Reg=0.00363 | FP-Reg=0.009 | acc=0.9062 | L2-Norm=19.057 | L2-Norm(final)=2.185 | 3198.7 samples/s | 50.0 steps/s
[Step=1700 Epoch= 1.7] | Loss=0.12192 | Reg=0.00364 | FP-Reg=0.011 | acc=0.9844 | L2-Norm=19.076 | L2-Norm(final)=2.192 | 3520.1 samples/s | 55.0 steps/s
[Step=1750 Epoch= 1.7] | Loss=0.11584 | Reg=0.00364 | FP-Reg=0.013 | acc=0.9688 | L2-Norm=19.090 | L2-Norm(final)=2.197 | 3525.3 samples/s | 55.1 steps/s
[Step=1800 Epoch= 1.8] | Loss=0.10976 | Reg=0.00365 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.100 | L2-Norm(final)=2.202 | 3500.5 samples/s | 54.7 steps/s
[Step=1850 Epoch= 1.8] | Loss=0.10554 | Reg=0.00365 | FP-Reg=0.016 | acc=0.9219 | L2-Norm=19.108 | L2-Norm(final)=2.206 | 3533.4 samples/s | 55.2 steps/s
[Step=1900 Epoch= 1.9] | Loss=0.10120 | Reg=0.00365 | FP-Reg=0.017 | acc=0.9688 | L2-Norm=19.114 | L2-Norm(final)=2.211 | 3538.2 samples/s | 55.3 steps/s
[Step=1950 Epoch= 1.9] | Loss=0.09907 | Reg=0.00366 | FP-Reg=0.017 | acc=0.8906 | L2-Norm=19.120 | L2-Norm(final)=2.214 | 3585.3 samples/s | 56.0 steps/s
[Step=2000 Epoch= 2.0] | Loss=0.09860 | Reg=0.00366 | FP-Reg=0.018 | acc=0.9219 | L2-Norm=19.125 | L2-Norm(final)=2.218 | 3569.7 samples/s | 55.8 steps/s
[Step=2050 Epoch= 2.0] | Loss=0.09690 | Reg=0.00366 | FP-Reg=0.019 | acc=0.9219 | L2-Norm=19.129 | L2-Norm(final)=2.220 | 3556.9 samples/s | 55.6 steps/s
[Step=2100 Epoch= 2.1] | Loss=0.09580 | Reg=0.00366 | FP-Reg=0.020 | acc=0.9531 | L2-Norm=19.133 | L2-Norm(final)=2.222 | 3550.9 samples/s | 55.5 steps/s
[Step=2150 Epoch= 2.1] | Loss=0.09449 | Reg=0.00366 | FP-Reg=0.020 | acc=0.9375 | L2-Norm=19.136 | L2-Norm(final)=2.224 | 3639.4 samples/s | 56.9 steps/s
[Step=2200 Epoch= 2.1] | Loss=0.09311 | Reg=0.00366 | FP-Reg=0.021 | acc=0.9219 | L2-Norm=19.140 | L2-Norm(final)=2.227 | 3655.7 samples/s | 57.1 steps/s
[Step=2250 Epoch= 2.2] | Loss=0.09229 | Reg=0.00366 | FP-Reg=0.021 | acc=0.9219 | L2-Norm=19.143 | L2-Norm(final)=2.229 | 3646.1 samples/s | 57.0 steps/s
[Step=2300 Epoch= 2.2] | Loss=0.09051 | Reg=0.00367 | FP-Reg=0.022 | acc=0.9844 | L2-Norm=19.145 | L2-Norm(final)=2.232 | 3649.4 samples/s | 57.0 steps/s
[Step=2350 Epoch= 2.3] | Loss=0.09000 | Reg=0.00367 | FP-Reg=0.022 | acc=0.9219 | L2-Norm=19.148 | L2-Norm(final)=2.235 | 3600.9 samples/s | 56.3 steps/s
[Step=2400 Epoch= 2.3] | Loss=0.08947 | Reg=0.00367 | FP-Reg=0.022 | acc=0.9688 | L2-Norm=19.150 | L2-Norm(final)=2.237 | 3550.5 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step2400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 3.0] | Loss=0.13526 | Reg=0.00362 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.036 | L2-Norm(final)=2.182 | 3775.6 samples/s | 59.0 steps/s
[Step=1650 Epoch= 3.1] | Loss=0.04018 | Reg=0.00364 | FP-Reg=0.013 | acc=0.9844 | L2-Norm=19.066 | L2-Norm(final)=2.181 | 3178.0 samples/s | 49.7 steps/s
[Step=1700 Epoch= 3.2] | Loss=0.02594 | Reg=0.00364 | FP-Reg=0.013 | acc=0.9688 | L2-Norm=19.068 | L2-Norm(final)=2.186 | 3346.8 samples/s | 52.3 steps/s
[Step=1750 Epoch= 3.3] | Loss=0.01980 | Reg=0.00364 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.068 | L2-Norm(final)=2.192 | 3360.9 samples/s | 52.5 steps/s
[Step=1800 Epoch= 3.4] | Loss=0.01707 | Reg=0.00364 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.068 | L2-Norm(final)=2.198 | 3347.8 samples/s | 52.3 steps/s
[Step=1850 Epoch= 3.5] | Loss=0.01557 | Reg=0.00364 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.068 | L2-Norm(final)=2.202 | 3357.4 samples/s | 52.5 steps/s
[Step=1900 Epoch= 3.6] | Loss=0.01578 | Reg=0.00364 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.070 | L2-Norm(final)=2.205 | 3373.0 samples/s | 52.7 steps/s
[Step=1950 Epoch= 3.7] | Loss=0.01506 | Reg=0.00364 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.073 | L2-Norm(final)=2.207 | 3373.4 samples/s | 52.7 steps/s
[Step=2000 Epoch= 3.8] | Loss=0.01381 | Reg=0.00364 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.074 | L2-Norm(final)=2.210 | 3392.4 samples/s | 53.0 steps/s
[Step=2050 Epoch= 3.9] | Loss=0.01284 | Reg=0.00364 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.075 | L2-Norm(final)=2.213 | 3351.3 samples/s | 52.4 steps/s
[Step=2100 Epoch= 4.0] | Loss=0.01235 | Reg=0.00364 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.075 | L2-Norm(final)=2.216 | 3397.7 samples/s | 53.1 steps/s
[Step=2150 Epoch= 4.1] | Loss=0.01165 | Reg=0.00364 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.075 | L2-Norm(final)=2.218 | 1750.2 samples/s | 27.3 steps/s
[Step=2200 Epoch= 4.1] | Loss=0.01104 | Reg=0.00364 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.075 | L2-Norm(final)=2.221 | 3450.9 samples/s | 53.9 steps/s
[Step=2250 Epoch= 4.2] | Loss=0.01057 | Reg=0.00364 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.074 | L2-Norm(final)=2.222 | 3437.4 samples/s | 53.7 steps/s
[Step=2300 Epoch= 4.3] | Loss=0.01062 | Reg=0.00364 | FP-Reg=0.011 | acc=0.9531 | L2-Norm=19.074 | L2-Norm(final)=2.225 | 3392.1 samples/s | 53.0 steps/s
[Step=2350 Epoch= 4.4] | Loss=0.01060 | Reg=0.00364 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.075 | L2-Norm(final)=2.226 | 3368.0 samples/s | 52.6 steps/s
[Step=2400 Epoch= 4.5] | Loss=0.01049 | Reg=0.00364 | FP-Reg=0.012 | acc=0.9844 | L2-Norm=19.076 | L2-Norm(final)=2.227 | 3344.1 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31549 | acc=0.7057 | tpr=0.5939 | fpr=0.0515 | 3810.6 samples/s | 14.9 steps/s
Avg test loss: 0.31827, Avg test acc: 0.70258, Avg tpr: 0.59066, Avg fpr: 0.05128, total FA: 400

Testing server on iccad2012
[Step=  50] | Loss=0.39306 | acc=0.7029 | tpr=0.9867 | fpr=0.3022 | 3808.2 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.39288 | acc=0.7029 | tpr=0.9915 | fpr=0.3025 | 7430.6 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.39612 | acc=0.6987 | tpr=0.9899 | fpr=0.3066 | 6648.7 samples/s | 26.0 steps/s
[Step= 200] | Loss=0.39623 | acc=0.6982 | tpr=0.9913 | fpr=0.3071 | 7012.5 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.39809 | acc=0.6965 | tpr=0.9904 | fpr=0.3088 | 7106.0 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.39827 | acc=0.6963 | tpr=0.9891 | fpr=0.3090 | 7069.6 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.39930 | acc=0.6959 | tpr=0.9887 | fpr=0.3094 | 7363.8 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.39937 | acc=0.6955 | tpr=0.9885 | fpr=0.3099 | 6989.0 samples/s | 27.3 steps/s
[Step= 450] | Loss=0.39974 | acc=0.6957 | tpr=0.9893 | fpr=0.3096 | 7015.1 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.39967 | acc=0.6958 | tpr=0.9903 | fpr=0.3095 | 6751.8 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.39880 | acc=0.6961 | tpr=0.9901 | fpr=0.3093 | 12814.4 samples/s | 50.1 steps/s
Avg test loss: 0.39864, Avg test acc: 0.69610, Avg tpr: 0.98970, Avg fpr: 0.30924, total FA: 42937

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 2.3] | Loss=0.20293 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.107 | L2-Norm(final)=2.258 | 4001.7 samples/s | 62.5 steps/s
[Step=2450 Epoch= 2.4] | Loss=0.10195 | Reg=0.00366 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.122 | L2-Norm(final)=2.262 | 3434.9 samples/s | 53.7 steps/s
[Step=2500 Epoch= 2.4] | Loss=0.09476 | Reg=0.00366 | FP-Reg=0.008 | acc=0.9375 | L2-Norm=19.138 | L2-Norm(final)=2.269 | 3607.0 samples/s | 56.4 steps/s
[Step=2550 Epoch= 2.5] | Loss=0.09460 | Reg=0.00367 | FP-Reg=0.010 | acc=0.9062 | L2-Norm=19.150 | L2-Norm(final)=2.270 | 3582.0 samples/s | 56.0 steps/s
[Step=2600 Epoch= 2.5] | Loss=0.08940 | Reg=0.00367 | FP-Reg=0.012 | acc=0.9375 | L2-Norm=19.160 | L2-Norm(final)=2.275 | 3374.2 samples/s | 52.7 steps/s
[Step=2650 Epoch= 2.6] | Loss=0.08755 | Reg=0.00367 | FP-Reg=0.013 | acc=0.9531 | L2-Norm=19.168 | L2-Norm(final)=2.278 | 3257.8 samples/s | 50.9 steps/s
[Step=2700 Epoch= 2.6] | Loss=0.08468 | Reg=0.00368 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.176 | L2-Norm(final)=2.282 | 3320.1 samples/s | 51.9 steps/s
[Step=2750 Epoch= 2.7] | Loss=0.08415 | Reg=0.00368 | FP-Reg=0.015 | acc=0.9531 | L2-Norm=19.182 | L2-Norm(final)=2.285 | 3539.8 samples/s | 55.3 steps/s
[Step=2800 Epoch= 2.7] | Loss=0.08260 | Reg=0.00368 | FP-Reg=0.015 | acc=0.9688 | L2-Norm=19.186 | L2-Norm(final)=2.287 | 3540.9 samples/s | 55.3 steps/s
[Step=2850 Epoch= 2.8] | Loss=0.08213 | Reg=0.00368 | FP-Reg=0.016 | acc=0.9844 | L2-Norm=19.190 | L2-Norm(final)=2.288 | 3520.3 samples/s | 55.0 steps/s
[Step=2900 Epoch= 2.8] | Loss=0.08210 | Reg=0.00368 | FP-Reg=0.017 | acc=0.9531 | L2-Norm=19.194 | L2-Norm(final)=2.289 | 3521.1 samples/s | 55.0 steps/s
[Step=2950 Epoch= 2.9] | Loss=0.08068 | Reg=0.00369 | FP-Reg=0.017 | acc=0.9531 | L2-Norm=19.197 | L2-Norm(final)=2.291 | 3529.4 samples/s | 55.1 steps/s
[Step=3000 Epoch= 2.9] | Loss=0.08030 | Reg=0.00369 | FP-Reg=0.017 | acc=0.9844 | L2-Norm=19.200 | L2-Norm(final)=2.292 | 3537.9 samples/s | 55.3 steps/s
[Step=3050 Epoch= 3.0] | Loss=0.07999 | Reg=0.00369 | FP-Reg=0.018 | acc=0.9531 | L2-Norm=19.203 | L2-Norm(final)=2.293 | 3527.0 samples/s | 55.1 steps/s
[Step=3100 Epoch= 3.0] | Loss=0.07934 | Reg=0.00369 | FP-Reg=0.018 | acc=0.9062 | L2-Norm=19.206 | L2-Norm(final)=2.295 | 3539.8 samples/s | 55.3 steps/s
[Step=3150 Epoch= 3.1] | Loss=0.07865 | Reg=0.00369 | FP-Reg=0.018 | acc=1.0000 | L2-Norm=19.208 | L2-Norm(final)=2.296 | 3537.9 samples/s | 55.3 steps/s
[Step=3200 Epoch= 3.1] | Loss=0.07818 | Reg=0.00369 | FP-Reg=0.019 | acc=0.9844 | L2-Norm=19.210 | L2-Norm(final)=2.297 | 3567.8 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step3200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 4.5] | Loss=0.26181 | Reg=0.00365 | FP-Reg=0.000 | acc=0.7812 | L2-Norm=19.107 | L2-Norm(final)=2.257 | 3612.2 samples/s | 56.4 steps/s
[Step=2450 Epoch= 4.6] | Loss=0.02261 | Reg=0.00366 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=2.266 | 3251.4 samples/s | 50.8 steps/s
[Step=2500 Epoch= 4.7] | Loss=0.01639 | Reg=0.00366 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.131 | L2-Norm(final)=2.270 | 3343.5 samples/s | 52.2 steps/s
[Step=2550 Epoch= 4.8] | Loss=0.01296 | Reg=0.00366 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.131 | L2-Norm(final)=2.273 | 3372.3 samples/s | 52.7 steps/s
[Step=2600 Epoch= 4.9] | Loss=0.01238 | Reg=0.00366 | FP-Reg=0.010 | acc=0.9688 | L2-Norm=19.131 | L2-Norm(final)=2.276 | 3313.9 samples/s | 51.8 steps/s
[Step=2650 Epoch= 5.0] | Loss=0.01175 | Reg=0.00366 | FP-Reg=0.010 | acc=0.9844 | L2-Norm=19.132 | L2-Norm(final)=2.276 | 3374.7 samples/s | 52.7 steps/s
[Step=2700 Epoch= 5.1] | Loss=0.01048 | Reg=0.00366 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.132 | L2-Norm(final)=2.277 | 3360.2 samples/s | 52.5 steps/s
[Step=2750 Epoch= 5.2] | Loss=0.01117 | Reg=0.00366 | FP-Reg=0.011 | acc=0.9844 | L2-Norm=19.134 | L2-Norm(final)=2.279 | 3439.1 samples/s | 53.7 steps/s
[Step=2800 Epoch= 5.3] | Loss=0.01043 | Reg=0.00366 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.136 | L2-Norm(final)=2.280 | 3446.9 samples/s | 53.9 steps/s
[Step=2850 Epoch= 5.4] | Loss=0.00965 | Reg=0.00366 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.138 | L2-Norm(final)=2.283 | 3405.5 samples/s | 53.2 steps/s
[Step=2900 Epoch= 5.5] | Loss=0.00889 | Reg=0.00366 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.138 | L2-Norm(final)=2.285 | 3493.2 samples/s | 54.6 steps/s
[Step=2950 Epoch= 5.6] | Loss=0.00839 | Reg=0.00366 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.138 | L2-Norm(final)=2.287 | 1791.1 samples/s | 28.0 steps/s
[Step=3000 Epoch= 5.7] | Loss=0.00790 | Reg=0.00366 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.289 | 3409.0 samples/s | 53.3 steps/s
[Step=3050 Epoch= 5.7] | Loss=0.00751 | Reg=0.00366 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.291 | 3425.4 samples/s | 53.5 steps/s
[Step=3100 Epoch= 5.8] | Loss=0.00730 | Reg=0.00366 | FP-Reg=0.010 | acc=0.9844 | L2-Norm=19.137 | L2-Norm(final)=2.293 | 3348.7 samples/s | 52.3 steps/s
[Step=3150 Epoch= 5.9] | Loss=0.00737 | Reg=0.00366 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.138 | L2-Norm(final)=2.294 | 3447.7 samples/s | 53.9 steps/s
[Step=3200 Epoch= 6.0] | Loss=0.00738 | Reg=0.00366 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.139 | L2-Norm(final)=2.294 | 3420.5 samples/s | 53.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.61668 | acc=0.5602 | tpr=0.3633 | fpr=0.0124 | 3874.6 samples/s | 15.1 steps/s
Avg test loss: 0.62287, Avg test acc: 0.55537, Avg tpr: 0.35869, Avg fpr: 0.01205, total FA: 94

Testing server on iccad2012
[Step=  50] | Loss=0.23737 | acc=0.8328 | tpr=0.9735 | fpr=0.1697 | 3845.1 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.23786 | acc=0.8359 | tpr=0.9659 | fpr=0.1666 | 7234.2 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.24083 | acc=0.8347 | tpr=0.9697 | fpr=0.1678 | 6847.9 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.24061 | acc=0.8349 | tpr=0.9716 | fpr=0.1676 | 7086.3 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.24180 | acc=0.8341 | tpr=0.9721 | fpr=0.1684 | 6932.3 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.24189 | acc=0.8338 | tpr=0.9709 | fpr=0.1687 | 7175.0 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.24290 | acc=0.8338 | tpr=0.9718 | fpr=0.1687 | 6883.4 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.24274 | acc=0.8340 | tpr=0.9716 | fpr=0.1685 | 6957.7 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.24345 | acc=0.8339 | tpr=0.9722 | fpr=0.1686 | 7333.0 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.24319 | acc=0.8342 | tpr=0.9736 | fpr=0.1683 | 6569.2 samples/s | 25.7 steps/s
[Step= 550] | Loss=0.24247 | acc=0.8344 | tpr=0.9741 | fpr=0.1682 | 12993.2 samples/s | 50.8 steps/s
Avg test loss: 0.24239, Avg test acc: 0.83437, Avg tpr: 0.97385, Avg fpr: 0.16816, total FA: 23349

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch= 3.1] | Loss=0.50485 | Reg=0.00368 | FP-Reg=0.000 | acc=0.6094 | L2-Norm=19.174 | L2-Norm(final)=2.310 | 4318.5 samples/s | 67.5 steps/s
[Step=3250 Epoch= 3.2] | Loss=0.11089 | Reg=0.00368 | FP-Reg=0.013 | acc=0.9531 | L2-Norm=19.195 | L2-Norm(final)=2.288 | 3026.7 samples/s | 47.3 steps/s
[Step=3300 Epoch= 3.2] | Loss=0.09346 | Reg=0.00369 | FP-Reg=0.013 | acc=0.9531 | L2-Norm=19.205 | L2-Norm(final)=2.296 | 3464.3 samples/s | 54.1 steps/s
[Step=3350 Epoch= 3.3] | Loss=0.08675 | Reg=0.00369 | FP-Reg=0.013 | acc=0.9375 | L2-Norm=19.214 | L2-Norm(final)=2.303 | 3525.5 samples/s | 55.1 steps/s
[Step=3400 Epoch= 3.3] | Loss=0.08288 | Reg=0.00369 | FP-Reg=0.013 | acc=1.0000 | L2-Norm=19.221 | L2-Norm(final)=2.309 | 3545.5 samples/s | 55.4 steps/s
[Step=3450 Epoch= 3.4] | Loss=0.07957 | Reg=0.00370 | FP-Reg=0.013 | acc=0.9219 | L2-Norm=19.228 | L2-Norm(final)=2.315 | 3629.1 samples/s | 56.7 steps/s
[Step=3500 Epoch= 3.4] | Loss=0.07642 | Reg=0.00370 | FP-Reg=0.014 | acc=0.9219 | L2-Norm=19.234 | L2-Norm(final)=2.321 | 3576.0 samples/s | 55.9 steps/s
[Step=3550 Epoch= 3.5] | Loss=0.07688 | Reg=0.00370 | FP-Reg=0.014 | acc=0.9219 | L2-Norm=19.239 | L2-Norm(final)=2.323 | 3523.2 samples/s | 55.1 steps/s
[Step=3600 Epoch= 3.5] | Loss=0.07664 | Reg=0.00370 | FP-Reg=0.015 | acc=0.9375 | L2-Norm=19.245 | L2-Norm(final)=2.325 | 3546.0 samples/s | 55.4 steps/s
[Step=3650 Epoch= 3.6] | Loss=0.07503 | Reg=0.00371 | FP-Reg=0.015 | acc=0.9375 | L2-Norm=19.249 | L2-Norm(final)=2.327 | 3523.0 samples/s | 55.0 steps/s
[Step=3700 Epoch= 3.6] | Loss=0.07386 | Reg=0.00371 | FP-Reg=0.016 | acc=0.9062 | L2-Norm=19.253 | L2-Norm(final)=2.329 | 3550.8 samples/s | 55.5 steps/s
[Step=3750 Epoch= 3.7] | Loss=0.07306 | Reg=0.00371 | FP-Reg=0.016 | acc=0.9844 | L2-Norm=19.256 | L2-Norm(final)=2.331 | 3540.0 samples/s | 55.3 steps/s
[Step=3800 Epoch= 3.7] | Loss=0.07323 | Reg=0.00371 | FP-Reg=0.016 | acc=0.9688 | L2-Norm=19.259 | L2-Norm(final)=2.332 | 3556.1 samples/s | 55.6 steps/s
[Step=3850 Epoch= 3.8] | Loss=0.07262 | Reg=0.00371 | FP-Reg=0.017 | acc=0.9375 | L2-Norm=19.263 | L2-Norm(final)=2.334 | 3547.6 samples/s | 55.4 steps/s
[Step=3900 Epoch= 3.8] | Loss=0.07219 | Reg=0.00371 | FP-Reg=0.017 | acc=0.9688 | L2-Norm=19.266 | L2-Norm(final)=2.337 | 3551.7 samples/s | 55.5 steps/s
[Step=3950 Epoch= 3.9] | Loss=0.07211 | Reg=0.00371 | FP-Reg=0.018 | acc=0.9531 | L2-Norm=19.269 | L2-Norm(final)=2.338 | 3553.0 samples/s | 55.5 steps/s
[Step=4000 Epoch= 3.9] | Loss=0.07163 | Reg=0.00371 | FP-Reg=0.018 | acc=1.0000 | L2-Norm=19.272 | L2-Norm(final)=2.340 | 3557.2 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step4000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch= 6.0] | Loss=0.11447 | Reg=0.00368 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.174 | L2-Norm(final)=2.312 | 3946.2 samples/s | 61.7 steps/s
[Step=3250 Epoch= 6.1] | Loss=0.01794 | Reg=0.00368 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.315 | 3168.4 samples/s | 49.5 steps/s
[Step=3300 Epoch= 6.2] | Loss=0.01304 | Reg=0.00368 | FP-Reg=0.010 | acc=0.9844 | L2-Norm=19.196 | L2-Norm(final)=2.321 | 3267.7 samples/s | 51.1 steps/s
[Step=3350 Epoch= 6.3] | Loss=0.01077 | Reg=0.00369 | FP-Reg=0.010 | acc=0.9844 | L2-Norm=19.198 | L2-Norm(final)=2.323 | 3372.1 samples/s | 52.7 steps/s
[Step=3400 Epoch= 6.4] | Loss=0.00936 | Reg=0.00369 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.198 | L2-Norm(final)=2.326 | 3425.7 samples/s | 53.5 steps/s
[Step=3450 Epoch= 6.5] | Loss=0.00872 | Reg=0.00369 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.198 | L2-Norm(final)=2.328 | 3466.6 samples/s | 54.2 steps/s
[Step=3500 Epoch= 6.6] | Loss=0.00950 | Reg=0.00369 | FP-Reg=0.010 | acc=0.9531 | L2-Norm=19.198 | L2-Norm(final)=2.330 | 3378.2 samples/s | 52.8 steps/s
[Step=3550 Epoch= 6.7] | Loss=0.00927 | Reg=0.00369 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.202 | L2-Norm(final)=2.330 | 3373.1 samples/s | 52.7 steps/s
[Step=3600 Epoch= 6.8] | Loss=0.00899 | Reg=0.00369 | FP-Reg=0.011 | acc=0.9844 | L2-Norm=19.203 | L2-Norm(final)=2.330 | 3360.7 samples/s | 52.5 steps/s
[Step=3650 Epoch= 6.9] | Loss=0.00851 | Reg=0.00369 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.330 | 3364.0 samples/s | 52.6 steps/s
[Step=3700 Epoch= 7.0] | Loss=0.00828 | Reg=0.00369 | FP-Reg=0.011 | acc=0.9844 | L2-Norm=19.202 | L2-Norm(final)=2.331 | 3420.8 samples/s | 53.5 steps/s
[Step=3750 Epoch= 7.1] | Loss=0.00792 | Reg=0.00369 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.332 | 1777.0 samples/s | 27.8 steps/s
[Step=3800 Epoch= 7.2] | Loss=0.00746 | Reg=0.00369 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.333 | 3461.1 samples/s | 54.1 steps/s
[Step=3850 Epoch= 7.3] | Loss=0.00714 | Reg=0.00369 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.202 | L2-Norm(final)=2.334 | 3457.9 samples/s | 54.0 steps/s
[Step=3900 Epoch= 7.4] | Loss=0.00708 | Reg=0.00369 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.202 | L2-Norm(final)=2.335 | 3423.8 samples/s | 53.5 steps/s
[Step=3950 Epoch= 7.4] | Loss=0.00678 | Reg=0.00369 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.202 | L2-Norm(final)=2.336 | 3464.7 samples/s | 54.1 steps/s
[Step=4000 Epoch= 7.5] | Loss=0.00654 | Reg=0.00369 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.202 | L2-Norm(final)=2.337 | 3423.9 samples/s | 53.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27537 | acc=0.7769 | tpr=0.6854 | fpr=0.0245 | 3826.8 samples/s | 14.9 steps/s
Avg test loss: 0.27978, Avg test acc: 0.77254, Avg tpr: 0.68060, Avg fpr: 0.02525, total FA: 197

Testing server on iccad2012
[Step=  50] | Loss=0.52135 | acc=0.6584 | tpr=0.9956 | fpr=0.3477 | 3835.7 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.52196 | acc=0.6611 | tpr=0.9936 | fpr=0.3451 | 7190.1 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.52679 | acc=0.6596 | tpr=0.9928 | fpr=0.3465 | 7077.4 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.52653 | acc=0.6603 | tpr=0.9934 | fpr=0.3458 | 6836.5 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.52896 | acc=0.6598 | tpr=0.9930 | fpr=0.3463 | 7016.7 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.52929 | acc=0.6599 | tpr=0.9920 | fpr=0.3461 | 7097.0 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.53052 | acc=0.6603 | tpr=0.9919 | fpr=0.3457 | 6940.0 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.53055 | acc=0.6595 | tpr=0.9918 | fpr=0.3465 | 7157.4 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.53113 | acc=0.6594 | tpr=0.9927 | fpr=0.3467 | 6834.1 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.53097 | acc=0.6591 | tpr=0.9930 | fpr=0.3469 | 6988.2 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.52977 | acc=0.6597 | tpr=0.9932 | fpr=0.3463 | 12794.9 samples/s | 50.0 steps/s
Avg test loss: 0.52954, Avg test acc: 0.65980, Avg tpr: 0.99326, Avg fpr: 0.34626, total FA: 48078

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch= 3.9] | Loss=0.25226 | Reg=0.00370 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.231 | L2-Norm(final)=2.356 | 4029.2 samples/s | 63.0 steps/s
[Step=4050 Epoch= 4.0] | Loss=0.08076 | Reg=0.00370 | FP-Reg=0.006 | acc=0.9375 | L2-Norm=19.243 | L2-Norm(final)=2.351 | 3497.9 samples/s | 54.7 steps/s
[Step=4100 Epoch= 4.0] | Loss=0.07610 | Reg=0.00371 | FP-Reg=0.007 | acc=0.8906 | L2-Norm=19.254 | L2-Norm(final)=2.355 | 3571.4 samples/s | 55.8 steps/s
[Step=4150 Epoch= 4.1] | Loss=0.07610 | Reg=0.00371 | FP-Reg=0.009 | acc=0.9062 | L2-Norm=19.264 | L2-Norm(final)=2.357 | 3602.1 samples/s | 56.3 steps/s
[Step=4200 Epoch= 4.1] | Loss=0.07213 | Reg=0.00371 | FP-Reg=0.010 | acc=0.9531 | L2-Norm=19.273 | L2-Norm(final)=2.360 | 3508.4 samples/s | 54.8 steps/s
[Step=4250 Epoch= 4.1] | Loss=0.07076 | Reg=0.00372 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.279 | L2-Norm(final)=2.362 | 3518.7 samples/s | 55.0 steps/s
[Step=4300 Epoch= 4.2] | Loss=0.06747 | Reg=0.00372 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.285 | L2-Norm(final)=2.365 | 3537.8 samples/s | 55.3 steps/s
[Step=4350 Epoch= 4.2] | Loss=0.06726 | Reg=0.00372 | FP-Reg=0.012 | acc=0.9062 | L2-Norm=19.290 | L2-Norm(final)=2.368 | 3623.3 samples/s | 56.6 steps/s
[Step=4400 Epoch= 4.3] | Loss=0.06715 | Reg=0.00372 | FP-Reg=0.013 | acc=0.9688 | L2-Norm=19.293 | L2-Norm(final)=2.368 | 3597.6 samples/s | 56.2 steps/s
[Step=4450 Epoch= 4.3] | Loss=0.06660 | Reg=0.00372 | FP-Reg=0.013 | acc=0.9531 | L2-Norm=19.297 | L2-Norm(final)=2.369 | 3541.9 samples/s | 55.3 steps/s
[Step=4500 Epoch= 4.4] | Loss=0.06616 | Reg=0.00372 | FP-Reg=0.014 | acc=0.9531 | L2-Norm=19.300 | L2-Norm(final)=2.369 | 3556.5 samples/s | 55.6 steps/s
[Step=4550 Epoch= 4.4] | Loss=0.06534 | Reg=0.00373 | FP-Reg=0.014 | acc=0.9688 | L2-Norm=19.303 | L2-Norm(final)=2.370 | 3524.0 samples/s | 55.1 steps/s
[Step=4600 Epoch= 4.5] | Loss=0.06460 | Reg=0.00373 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.305 | L2-Norm(final)=2.371 | 3537.9 samples/s | 55.3 steps/s
[Step=4650 Epoch= 4.5] | Loss=0.06399 | Reg=0.00373 | FP-Reg=0.015 | acc=0.9844 | L2-Norm=19.308 | L2-Norm(final)=2.372 | 3534.6 samples/s | 55.2 steps/s
[Step=4700 Epoch= 4.6] | Loss=0.06407 | Reg=0.00373 | FP-Reg=0.015 | acc=0.9219 | L2-Norm=19.310 | L2-Norm(final)=2.373 | 3532.2 samples/s | 55.2 steps/s
[Step=4750 Epoch= 4.6] | Loss=0.06389 | Reg=0.00373 | FP-Reg=0.015 | acc=0.9062 | L2-Norm=19.312 | L2-Norm(final)=2.373 | 3543.8 samples/s | 55.4 steps/s
[Step=4800 Epoch= 4.7] | Loss=0.06410 | Reg=0.00373 | FP-Reg=0.015 | acc=0.9375 | L2-Norm=19.314 | L2-Norm(final)=2.374 | 3534.1 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step4800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch= 7.5] | Loss=0.21011 | Reg=0.00370 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.231 | L2-Norm(final)=2.356 | 3859.0 samples/s | 60.3 steps/s
[Step=4050 Epoch= 7.6] | Loss=0.02686 | Reg=0.00371 | FP-Reg=0.015 | acc=1.0000 | L2-Norm=19.254 | L2-Norm(final)=2.343 | 3339.0 samples/s | 52.2 steps/s
[Step=4100 Epoch= 7.7] | Loss=0.01658 | Reg=0.00371 | FP-Reg=0.014 | acc=1.0000 | L2-Norm=19.255 | L2-Norm(final)=2.347 | 3424.3 samples/s | 53.5 steps/s
[Step=4150 Epoch= 7.8] | Loss=0.01269 | Reg=0.00371 | FP-Reg=0.013 | acc=1.0000 | L2-Norm=19.254 | L2-Norm(final)=2.353 | 3435.2 samples/s | 53.7 steps/s
[Step=4200 Epoch= 7.9] | Loss=0.01010 | Reg=0.00371 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.252 | L2-Norm(final)=2.357 | 3451.1 samples/s | 53.9 steps/s
[Step=4250 Epoch= 8.0] | Loss=0.00852 | Reg=0.00371 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.251 | L2-Norm(final)=2.361 | 3448.8 samples/s | 53.9 steps/s
[Step=4300 Epoch= 8.1] | Loss=0.00833 | Reg=0.00371 | FP-Reg=0.010 | acc=0.9844 | L2-Norm=19.251 | L2-Norm(final)=2.364 | 3465.9 samples/s | 54.2 steps/s
[Step=4350 Epoch= 8.2] | Loss=0.00796 | Reg=0.00371 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.253 | L2-Norm(final)=2.366 | 3349.7 samples/s | 52.3 steps/s
[Step=4400 Epoch= 8.3] | Loss=0.00753 | Reg=0.00371 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.254 | L2-Norm(final)=2.367 | 3372.5 samples/s | 52.7 steps/s
[Step=4450 Epoch= 8.4] | Loss=0.00703 | Reg=0.00371 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.255 | L2-Norm(final)=2.369 | 3387.6 samples/s | 52.9 steps/s
[Step=4500 Epoch= 8.5] | Loss=0.00801 | Reg=0.00371 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.258 | L2-Norm(final)=2.369 | 3482.4 samples/s | 54.4 steps/s
[Step=4550 Epoch= 8.6] | Loss=0.00748 | Reg=0.00371 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.260 | L2-Norm(final)=2.369 | 1807.4 samples/s | 28.2 steps/s
[Step=4600 Epoch= 8.7] | Loss=0.00702 | Reg=0.00371 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.260 | L2-Norm(final)=2.370 | 3465.3 samples/s | 54.1 steps/s
[Step=4650 Epoch= 8.8] | Loss=0.00719 | Reg=0.00371 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.260 | L2-Norm(final)=2.371 | 3421.7 samples/s | 53.5 steps/s
[Step=4700 Epoch= 8.9] | Loss=0.00693 | Reg=0.00371 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.371 | 3421.1 samples/s | 53.5 steps/s
[Step=4750 Epoch= 9.0] | Loss=0.00674 | Reg=0.00371 | FP-Reg=0.011 | acc=0.9844 | L2-Norm=19.261 | L2-Norm(final)=2.372 | 3419.6 samples/s | 53.4 steps/s
[Step=4800 Epoch= 9.0] | Loss=0.00655 | Reg=0.00371 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.372 | 3442.1 samples/s | 53.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29860 | acc=0.7452 | tpr=0.6368 | fpr=0.0196 | 3864.4 samples/s | 15.1 steps/s
Avg test loss: 0.30341, Avg test acc: 0.74277, Avg tpr: 0.63525, Avg fpr: 0.02077, total FA: 162

Testing server on iccad2012
[Step=  50] | Loss=0.44281 | acc=0.7193 | tpr=0.9823 | fpr=0.2854 | 3903.3 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.44421 | acc=0.7198 | tpr=0.9893 | fpr=0.2853 | 6854.8 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.44819 | acc=0.7183 | tpr=0.9899 | fpr=0.2867 | 7187.9 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.44882 | acc=0.7174 | tpr=0.9923 | fpr=0.2876 | 6939.5 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.45161 | acc=0.7159 | tpr=0.9930 | fpr=0.2891 | 7119.8 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.45194 | acc=0.7167 | tpr=0.9920 | fpr=0.2884 | 7134.1 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.45355 | acc=0.7164 | tpr=0.9912 | fpr=0.2885 | 7073.3 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.45378 | acc=0.7163 | tpr=0.9918 | fpr=0.2887 | 7107.8 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.45464 | acc=0.7166 | tpr=0.9927 | fpr=0.2884 | 6869.9 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.45462 | acc=0.7164 | tpr=0.9930 | fpr=0.2886 | 6977.2 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.45349 | acc=0.7166 | tpr=0.9928 | fpr=0.2884 | 12795.4 samples/s | 50.0 steps/s
Avg test loss: 0.45332, Avg test acc: 0.71664, Avg tpr: 0.99287, Avg fpr: 0.28838, total FA: 40041

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch= 4.7] | Loss=0.13711 | Reg=0.00372 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.277 | L2-Norm(final)=2.372 | 3998.8 samples/s | 62.5 steps/s
[Step=4850 Epoch= 4.7] | Loss=0.06714 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9219 | L2-Norm=19.285 | L2-Norm(final)=2.373 | 3428.7 samples/s | 53.6 steps/s
[Step=4900 Epoch= 4.8] | Loss=0.06630 | Reg=0.00372 | FP-Reg=0.007 | acc=0.9531 | L2-Norm=19.298 | L2-Norm(final)=2.377 | 3575.9 samples/s | 55.9 steps/s
[Step=4950 Epoch= 4.8] | Loss=0.06439 | Reg=0.00373 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.308 | L2-Norm(final)=2.381 | 3508.4 samples/s | 54.8 steps/s
[Step=5000 Epoch= 4.9] | Loss=0.06447 | Reg=0.00373 | FP-Reg=0.009 | acc=0.9219 | L2-Norm=19.315 | L2-Norm(final)=2.384 | 3550.2 samples/s | 55.5 steps/s
[Step=5050 Epoch= 4.9] | Loss=0.06394 | Reg=0.00373 | FP-Reg=0.010 | acc=0.9688 | L2-Norm=19.321 | L2-Norm(final)=2.386 | 3617.2 samples/s | 56.5 steps/s
[Step=5100 Epoch= 5.0] | Loss=0.06138 | Reg=0.00373 | FP-Reg=0.011 | acc=0.9531 | L2-Norm=19.325 | L2-Norm(final)=2.387 | 3580.5 samples/s | 55.9 steps/s
[Step=5150 Epoch= 5.0] | Loss=0.06180 | Reg=0.00374 | FP-Reg=0.011 | acc=0.9219 | L2-Norm=19.329 | L2-Norm(final)=2.388 | 3557.3 samples/s | 55.6 steps/s
[Step=5200 Epoch= 5.1] | Loss=0.06157 | Reg=0.00374 | FP-Reg=0.012 | acc=0.9844 | L2-Norm=19.333 | L2-Norm(final)=2.388 | 3549.6 samples/s | 55.5 steps/s
[Step=5250 Epoch= 5.1] | Loss=0.06093 | Reg=0.00374 | FP-Reg=0.012 | acc=0.9688 | L2-Norm=19.338 | L2-Norm(final)=2.390 | 3529.9 samples/s | 55.2 steps/s
[Step=5300 Epoch= 5.2] | Loss=0.06030 | Reg=0.00374 | FP-Reg=0.013 | acc=0.9844 | L2-Norm=19.342 | L2-Norm(final)=2.391 | 3546.3 samples/s | 55.4 steps/s
[Step=5350 Epoch= 5.2] | Loss=0.06007 | Reg=0.00374 | FP-Reg=0.013 | acc=0.9375 | L2-Norm=19.346 | L2-Norm(final)=2.392 | 3586.6 samples/s | 56.0 steps/s
[Step=5400 Epoch= 5.3] | Loss=0.05954 | Reg=0.00374 | FP-Reg=0.014 | acc=0.9688 | L2-Norm=19.349 | L2-Norm(final)=2.393 | 3640.3 samples/s | 56.9 steps/s
[Step=5450 Epoch= 5.3] | Loss=0.05922 | Reg=0.00375 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.352 | L2-Norm(final)=2.394 | 3637.9 samples/s | 56.8 steps/s
[Step=5500 Epoch= 5.4] | Loss=0.05921 | Reg=0.00375 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.355 | L2-Norm(final)=2.394 | 3646.2 samples/s | 57.0 steps/s
[Step=5550 Epoch= 5.4] | Loss=0.05945 | Reg=0.00375 | FP-Reg=0.014 | acc=0.9062 | L2-Norm=19.357 | L2-Norm(final)=2.395 | 3578.7 samples/s | 55.9 steps/s
[Step=5600 Epoch= 5.5] | Loss=0.05906 | Reg=0.00375 | FP-Reg=0.015 | acc=0.9844 | L2-Norm=19.359 | L2-Norm(final)=2.395 | 3526.5 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step5600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch= 9.0] | Loss=0.13031 | Reg=0.00372 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.277 | L2-Norm(final)=2.372 | 3981.6 samples/s | 62.2 steps/s
[Step=4850 Epoch= 9.1] | Loss=0.01540 | Reg=0.00372 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.299 | L2-Norm(final)=2.375 | 3267.2 samples/s | 51.0 steps/s
[Step=4900 Epoch= 9.2] | Loss=0.01214 | Reg=0.00373 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.300 | L2-Norm(final)=2.377 | 3434.9 samples/s | 53.7 steps/s
[Step=4950 Epoch= 9.3] | Loss=0.01115 | Reg=0.00373 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.302 | L2-Norm(final)=2.377 | 3423.8 samples/s | 53.5 steps/s
[Step=5000 Epoch= 9.4] | Loss=0.00949 | Reg=0.00373 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.303 | L2-Norm(final)=2.378 | 3435.6 samples/s | 53.7 steps/s
[Step=5050 Epoch= 9.5] | Loss=0.00807 | Reg=0.00373 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.302 | L2-Norm(final)=2.382 | 3436.6 samples/s | 53.7 steps/s
[Step=5100 Epoch= 9.6] | Loss=0.00710 | Reg=0.00373 | FP-Reg=0.010 | acc=0.9844 | L2-Norm=19.301 | L2-Norm(final)=2.384 | 3419.8 samples/s | 53.4 steps/s
[Step=5150 Epoch= 9.7] | Loss=0.00644 | Reg=0.00372 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.300 | L2-Norm(final)=2.387 | 3371.9 samples/s | 52.7 steps/s
[Step=5200 Epoch= 9.8] | Loss=0.00586 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.299 | L2-Norm(final)=2.389 | 3353.2 samples/s | 52.4 steps/s
[Step=5250 Epoch= 9.9] | Loss=0.00555 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.299 | L2-Norm(final)=2.391 | 3367.8 samples/s | 52.6 steps/s
[Step=5300 Epoch=10.0] | Loss=0.00521 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.299 | L2-Norm(final)=2.393 | 3399.0 samples/s | 53.1 steps/s
[Step=5350 Epoch=10.1] | Loss=0.00528 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.299 | L2-Norm(final)=2.394 | 1790.9 samples/s | 28.0 steps/s
[Step=5400 Epoch=10.2] | Loss=0.00519 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.299 | L2-Norm(final)=2.394 | 3368.4 samples/s | 52.6 steps/s
[Step=5450 Epoch=10.3] | Loss=0.00502 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.300 | L2-Norm(final)=2.395 | 3356.9 samples/s | 52.5 steps/s
[Step=5500 Epoch=10.4] | Loss=0.00492 | Reg=0.00372 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.300 | L2-Norm(final)=2.395 | 3353.1 samples/s | 52.4 steps/s
[Step=5550 Epoch=10.5] | Loss=0.00489 | Reg=0.00372 | FP-Reg=0.009 | acc=0.9844 | L2-Norm=19.300 | L2-Norm(final)=2.396 | 3361.8 samples/s | 52.5 steps/s
[Step=5600 Epoch=10.6] | Loss=0.00490 | Reg=0.00373 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.300 | L2-Norm(final)=2.396 | 3355.0 samples/s | 52.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32653 | acc=0.7305 | tpr=0.6173 | fpr=0.0235 | 3853.8 samples/s | 15.1 steps/s
Avg test loss: 0.32803, Avg test acc: 0.72814, Avg tpr: 0.61689, Avg fpr: 0.02718, total FA: 212

Testing server on iccad2012
[Step=  50] | Loss=0.38963 | acc=0.7640 | tpr=0.9956 | fpr=0.2402 | 3826.2 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.39070 | acc=0.7655 | tpr=0.9957 | fpr=0.2388 | 7056.1 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.39495 | acc=0.7633 | tpr=0.9957 | fpr=0.2410 | 7021.8 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.39494 | acc=0.7633 | tpr=0.9956 | fpr=0.2409 | 6718.9 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.39738 | acc=0.7621 | tpr=0.9956 | fpr=0.2421 | 6505.2 samples/s | 25.4 steps/s
[Step= 300] | Loss=0.39759 | acc=0.7630 | tpr=0.9956 | fpr=0.2413 | 5507.3 samples/s | 21.5 steps/s
[Step= 350] | Loss=0.39925 | acc=0.7627 | tpr=0.9950 | fpr=0.2415 | 5858.0 samples/s | 22.9 steps/s
[Step= 400] | Loss=0.39929 | acc=0.7629 | tpr=0.9956 | fpr=0.2413 | 5789.8 samples/s | 22.6 steps/s
[Step= 450] | Loss=0.40054 | acc=0.7623 | tpr=0.9956 | fpr=0.2420 | 6791.3 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.40077 | acc=0.7617 | tpr=0.9952 | fpr=0.2425 | 6888.5 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.39979 | acc=0.7618 | tpr=0.9944 | fpr=0.2425 | 13227.0 samples/s | 51.7 steps/s
Avg test loss: 0.39947, Avg test acc: 0.76186, Avg tpr: 0.99445, Avg fpr: 0.24237, total FA: 33652

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch= 5.5] | Loss=0.16539 | Reg=0.00374 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.327 | L2-Norm(final)=2.392 | 3816.0 samples/s | 59.6 steps/s
[Step=5650 Epoch= 5.5] | Loss=0.06844 | Reg=0.00374 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.341 | L2-Norm(final)=2.393 | 3501.3 samples/s | 54.7 steps/s
[Step=5700 Epoch= 5.6] | Loss=0.07035 | Reg=0.00374 | FP-Reg=0.009 | acc=0.9688 | L2-Norm=19.349 | L2-Norm(final)=2.389 | 3517.4 samples/s | 55.0 steps/s
[Step=5750 Epoch= 5.6] | Loss=0.06528 | Reg=0.00375 | FP-Reg=0.010 | acc=0.9844 | L2-Norm=19.354 | L2-Norm(final)=2.388 | 3553.3 samples/s | 55.5 steps/s
[Step=5800 Epoch= 5.7] | Loss=0.06313 | Reg=0.00375 | FP-Reg=0.010 | acc=0.9688 | L2-Norm=19.361 | L2-Norm(final)=2.390 | 3542.8 samples/s | 55.4 steps/s
[Step=5850 Epoch= 5.7] | Loss=0.06200 | Reg=0.00375 | FP-Reg=0.011 | acc=0.9375 | L2-Norm=19.367 | L2-Norm(final)=2.393 | 3519.7 samples/s | 55.0 steps/s
[Step=5900 Epoch= 5.8] | Loss=0.05988 | Reg=0.00375 | FP-Reg=0.012 | acc=0.9531 | L2-Norm=19.373 | L2-Norm(final)=2.396 | 3539.8 samples/s | 55.3 steps/s
[Step=5950 Epoch= 5.8] | Loss=0.05935 | Reg=0.00375 | FP-Reg=0.012 | acc=0.9688 | L2-Norm=19.378 | L2-Norm(final)=2.398 | 3532.0 samples/s | 55.2 steps/s
[Step=6000 Epoch= 5.9] | Loss=0.05954 | Reg=0.00376 | FP-Reg=0.013 | acc=1.0000 | L2-Norm=19.382 | L2-Norm(final)=2.399 | 3534.6 samples/s | 55.2 steps/s
[Step=6050 Epoch= 5.9] | Loss=0.05865 | Reg=0.00376 | FP-Reg=0.013 | acc=0.9688 | L2-Norm=19.386 | L2-Norm(final)=2.399 | 3619.1 samples/s | 56.5 steps/s
[Step=6100 Epoch= 6.0] | Loss=0.05911 | Reg=0.00376 | FP-Reg=0.014 | acc=0.9688 | L2-Norm=19.390 | L2-Norm(final)=2.400 | 3618.6 samples/s | 56.5 steps/s
[Step=6150 Epoch= 6.0] | Loss=0.05831 | Reg=0.00376 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.393 | L2-Norm(final)=2.401 | 3670.6 samples/s | 57.4 steps/s
[Step=6200 Epoch= 6.1] | Loss=0.05789 | Reg=0.00376 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.395 | L2-Norm(final)=2.401 | 3622.6 samples/s | 56.6 steps/s
[Step=6250 Epoch= 6.1] | Loss=0.05717 | Reg=0.00376 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.398 | L2-Norm(final)=2.402 | 3550.8 samples/s | 55.5 steps/s
[Step=6300 Epoch= 6.2] | Loss=0.05689 | Reg=0.00376 | FP-Reg=0.015 | acc=0.9688 | L2-Norm=19.400 | L2-Norm(final)=2.402 | 3538.0 samples/s | 55.3 steps/s
[Step=6350 Epoch= 6.2] | Loss=0.05618 | Reg=0.00376 | FP-Reg=0.015 | acc=0.9531 | L2-Norm=19.402 | L2-Norm(final)=2.403 | 3559.2 samples/s | 55.6 steps/s
[Step=6400 Epoch= 6.2] | Loss=0.05576 | Reg=0.00377 | FP-Reg=0.015 | acc=0.9844 | L2-Norm=19.404 | L2-Norm(final)=2.404 | 3511.7 samples/s | 54.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step6400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=10.6] | Loss=0.07229 | Reg=0.00374 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.327 | L2-Norm(final)=2.393 | 4099.7 samples/s | 64.1 steps/s
[Step=5650 Epoch=10.7] | Loss=0.01712 | Reg=0.00374 | FP-Reg=0.010 | acc=0.9844 | L2-Norm=19.341 | L2-Norm(final)=2.391 | 3086.7 samples/s | 48.2 steps/s
[Step=5700 Epoch=10.7] | Loss=0.01130 | Reg=0.00374 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.346 | L2-Norm(final)=2.396 | 3403.1 samples/s | 53.2 steps/s
[Step=5750 Epoch=10.8] | Loss=0.00833 | Reg=0.00374 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.345 | L2-Norm(final)=2.399 | 3459.5 samples/s | 54.1 steps/s
[Step=5800 Epoch=10.9] | Loss=0.00721 | Reg=0.00374 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.345 | L2-Norm(final)=2.402 | 3312.2 samples/s | 51.8 steps/s
[Step=5850 Epoch=11.0] | Loss=0.00677 | Reg=0.00374 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.346 | L2-Norm(final)=2.405 | 3329.8 samples/s | 52.0 steps/s
[Step=5900 Epoch=11.1] | Loss=0.00617 | Reg=0.00374 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.346 | L2-Norm(final)=2.407 | 3229.1 samples/s | 50.5 steps/s
[Step=5950 Epoch=11.2] | Loss=0.00585 | Reg=0.00374 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.346 | L2-Norm(final)=2.408 | 3234.3 samples/s | 50.5 steps/s
[Step=6000 Epoch=11.3] | Loss=0.00574 | Reg=0.00374 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.347 | L2-Norm(final)=2.409 | 3141.6 samples/s | 49.1 steps/s
[Step=6050 Epoch=11.4] | Loss=0.00534 | Reg=0.00374 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.347 | L2-Norm(final)=2.411 | 3377.6 samples/s | 52.8 steps/s
[Step=6100 Epoch=11.5] | Loss=0.00520 | Reg=0.00374 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.348 | L2-Norm(final)=2.411 | 3490.3 samples/s | 54.5 steps/s
[Step=6150 Epoch=11.6] | Loss=0.00621 | Reg=0.00374 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.350 | L2-Norm(final)=2.411 | 1782.5 samples/s | 27.9 steps/s
[Step=6200 Epoch=11.7] | Loss=0.00623 | Reg=0.00375 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.353 | L2-Norm(final)=2.409 | 3361.7 samples/s | 52.5 steps/s
[Step=6250 Epoch=11.8] | Loss=0.00596 | Reg=0.00375 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.354 | L2-Norm(final)=2.409 | 3338.5 samples/s | 52.2 steps/s
[Step=6300 Epoch=11.9] | Loss=0.00557 | Reg=0.00375 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.354 | L2-Norm(final)=2.410 | 3355.2 samples/s | 52.4 steps/s
[Step=6350 Epoch=12.0] | Loss=0.00526 | Reg=0.00375 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.353 | L2-Norm(final)=2.410 | 3356.4 samples/s | 52.4 steps/s
[Step=6400 Epoch=12.1] | Loss=0.00530 | Reg=0.00375 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.353 | L2-Norm(final)=2.410 | 3306.7 samples/s | 51.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20199 | acc=0.8316 | tpr=0.7688 | fpr=0.0322 | 3727.5 samples/s | 14.6 steps/s
Avg test loss: 0.20543, Avg test acc: 0.82967, Avg tpr: 0.76779, Avg fpr: 0.03423, total FA: 267

Testing server on iccad2012
[Step=  50] | Loss=0.51073 | acc=0.6868 | tpr=1.0000 | fpr=0.3188 | 3551.0 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.51534 | acc=0.6892 | tpr=1.0000 | fpr=0.3166 | 6749.9 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.52132 | acc=0.6869 | tpr=0.9986 | fpr=0.3188 | 6591.2 samples/s | 25.7 steps/s
[Step= 200] | Loss=0.52146 | acc=0.6872 | tpr=0.9989 | fpr=0.3185 | 6603.8 samples/s | 25.8 steps/s
[Step= 250] | Loss=0.52343 | acc=0.6861 | tpr=0.9983 | fpr=0.3196 | 6655.9 samples/s | 26.0 steps/s
[Step= 300] | Loss=0.52333 | acc=0.6869 | tpr=0.9971 | fpr=0.3188 | 6695.3 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.52502 | acc=0.6866 | tpr=0.9962 | fpr=0.3191 | 6651.9 samples/s | 26.0 steps/s
[Step= 400] | Loss=0.52546 | acc=0.6862 | tpr=0.9967 | fpr=0.3195 | 6293.5 samples/s | 24.6 steps/s
[Step= 450] | Loss=0.52654 | acc=0.6862 | tpr=0.9966 | fpr=0.3194 | 6435.9 samples/s | 25.1 steps/s
[Step= 500] | Loss=0.52698 | acc=0.6858 | tpr=0.9960 | fpr=0.3198 | 6210.4 samples/s | 24.3 steps/s
[Step= 550] | Loss=0.52596 | acc=0.6864 | tpr=0.9960 | fpr=0.3192 | 11029.1 samples/s | 43.1 steps/s
Avg test loss: 0.52578, Avg test acc: 0.68648, Avg tpr: 0.99604, Avg fpr: 0.31915, total FA: 44313

server round 8/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch= 6.2] | Loss=0.10624 | Reg=0.00376 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.381 | L2-Norm(final)=2.412 | 3561.6 samples/s | 55.6 steps/s
[Step=6450 Epoch= 6.3] | Loss=0.06626 | Reg=0.00376 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.390 | L2-Norm(final)=2.407 | 3293.3 samples/s | 51.5 steps/s
[Step=6500 Epoch= 6.3] | Loss=0.05872 | Reg=0.00376 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.402 | L2-Norm(final)=2.411 | 3367.8 samples/s | 52.6 steps/s
[Step=6550 Epoch= 6.4] | Loss=0.05496 | Reg=0.00377 | FP-Reg=0.008 | acc=0.9219 | L2-Norm=19.409 | L2-Norm(final)=2.415 | 3347.5 samples/s | 52.3 steps/s
[Step=6600 Epoch= 6.4] | Loss=0.05602 | Reg=0.00377 | FP-Reg=0.009 | acc=0.9375 | L2-Norm=19.415 | L2-Norm(final)=2.417 | 3353.8 samples/s | 52.4 steps/s
[Step=6650 Epoch= 6.5] | Loss=0.05568 | Reg=0.00377 | FP-Reg=0.010 | acc=0.9375 | L2-Norm=19.420 | L2-Norm(final)=2.415 | 3361.0 samples/s | 52.5 steps/s
[Step=6700 Epoch= 6.5] | Loss=0.05552 | Reg=0.00377 | FP-Reg=0.011 | acc=0.9375 | L2-Norm=19.424 | L2-Norm(final)=2.415 | 3381.0 samples/s | 52.8 steps/s
[Step=6750 Epoch= 6.6] | Loss=0.05498 | Reg=0.00377 | FP-Reg=0.011 | acc=0.9219 | L2-Norm=19.429 | L2-Norm(final)=2.416 | 3350.9 samples/s | 52.4 steps/s
[Step=6800 Epoch= 6.6] | Loss=0.05443 | Reg=0.00378 | FP-Reg=0.012 | acc=0.9844 | L2-Norm=19.434 | L2-Norm(final)=2.417 | 3352.4 samples/s | 52.4 steps/s
[Step=6850 Epoch= 6.7] | Loss=0.05434 | Reg=0.00378 | FP-Reg=0.012 | acc=0.9688 | L2-Norm=19.437 | L2-Norm(final)=2.417 | 3387.3 samples/s | 52.9 steps/s
[Step=6900 Epoch= 6.7] | Loss=0.05388 | Reg=0.00378 | FP-Reg=0.013 | acc=0.9844 | L2-Norm=19.441 | L2-Norm(final)=2.417 | 3351.7 samples/s | 52.4 steps/s
[Step=6950 Epoch= 6.8] | Loss=0.05336 | Reg=0.00378 | FP-Reg=0.013 | acc=0.9375 | L2-Norm=19.444 | L2-Norm(final)=2.418 | 3429.4 samples/s | 53.6 steps/s
[Step=7000 Epoch= 6.8] | Loss=0.05354 | Reg=0.00378 | FP-Reg=0.013 | acc=0.9531 | L2-Norm=19.447 | L2-Norm(final)=2.419 | 3386.8 samples/s | 52.9 steps/s
[Step=7050 Epoch= 6.9] | Loss=0.05339 | Reg=0.00378 | FP-Reg=0.013 | acc=0.9688 | L2-Norm=19.450 | L2-Norm(final)=2.419 | 3361.4 samples/s | 52.5 steps/s
[Step=7100 Epoch= 6.9] | Loss=0.05334 | Reg=0.00378 | FP-Reg=0.014 | acc=0.9688 | L2-Norm=19.453 | L2-Norm(final)=2.419 | 3390.3 samples/s | 53.0 steps/s
[Step=7150 Epoch= 7.0] | Loss=0.05308 | Reg=0.00379 | FP-Reg=0.014 | acc=0.9531 | L2-Norm=19.455 | L2-Norm(final)=2.420 | 3289.0 samples/s | 51.4 steps/s
[Step=7200 Epoch= 7.0] | Loss=0.05264 | Reg=0.00379 | FP-Reg=0.014 | acc=0.9688 | L2-Norm=19.458 | L2-Norm(final)=2.420 | 3108.7 samples/s | 48.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step7200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=12.1] | Loss=0.17068 | Reg=0.00376 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.381 | L2-Norm(final)=2.412 | 3657.6 samples/s | 57.2 steps/s
[Step=6450 Epoch=12.2] | Loss=0.02110 | Reg=0.00377 | FP-Reg=0.016 | acc=0.9844 | L2-Norm=19.410 | L2-Norm(final)=2.395 | 2861.8 samples/s | 44.7 steps/s
[Step=6500 Epoch=12.3] | Loss=0.01233 | Reg=0.00377 | FP-Reg=0.014 | acc=1.0000 | L2-Norm=19.407 | L2-Norm(final)=2.400 | 3065.6 samples/s | 47.9 steps/s
[Step=6550 Epoch=12.3] | Loss=0.01048 | Reg=0.00377 | FP-Reg=0.013 | acc=1.0000 | L2-Norm=19.404 | L2-Norm(final)=2.405 | 3043.3 samples/s | 47.6 steps/s
[Step=6600 Epoch=12.4] | Loss=0.00873 | Reg=0.00377 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.404 | L2-Norm(final)=2.409 | 3180.6 samples/s | 49.7 steps/s
[Step=6650 Epoch=12.5] | Loss=0.00770 | Reg=0.00377 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.404 | L2-Norm(final)=2.412 | 3247.2 samples/s | 50.7 steps/s
[Step=6700 Epoch=12.6] | Loss=0.00665 | Reg=0.00376 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.403 | L2-Norm(final)=2.415 | 3228.8 samples/s | 50.4 steps/s
[Step=6750 Epoch=12.7] | Loss=0.00582 | Reg=0.00376 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.402 | L2-Norm(final)=2.418 | 3210.8 samples/s | 50.2 steps/s
[Step=6800 Epoch=12.8] | Loss=0.00553 | Reg=0.00376 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.400 | L2-Norm(final)=2.421 | 3187.5 samples/s | 49.8 steps/s
[Step=6850 Epoch=12.9] | Loss=0.00531 | Reg=0.00376 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.400 | L2-Norm(final)=2.423 | 3245.0 samples/s | 50.7 steps/s
[Step=6900 Epoch=13.0] | Loss=0.00505 | Reg=0.00376 | FP-Reg=0.009 | acc=0.9844 | L2-Norm=19.400 | L2-Norm(final)=2.424 | 3272.4 samples/s | 51.1 steps/s
[Step=6950 Epoch=13.1] | Loss=0.00494 | Reg=0.00376 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.401 | L2-Norm(final)=2.425 | 1710.7 samples/s | 26.7 steps/s
[Step=7000 Epoch=13.2] | Loss=0.00494 | Reg=0.00376 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.402 | L2-Norm(final)=2.426 | 3197.9 samples/s | 50.0 steps/s
[Step=7050 Epoch=13.3] | Loss=0.00465 | Reg=0.00376 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.403 | L2-Norm(final)=2.427 | 3177.3 samples/s | 49.6 steps/s
[Step=7100 Epoch=13.4] | Loss=0.00462 | Reg=0.00376 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.403 | L2-Norm(final)=2.428 | 3156.8 samples/s | 49.3 steps/s
[Step=7150 Epoch=13.5] | Loss=0.00440 | Reg=0.00376 | FP-Reg=0.009 | acc=0.9844 | L2-Norm=19.403 | L2-Norm(final)=2.429 | 3198.6 samples/s | 50.0 steps/s
[Step=7200 Epoch=13.6] | Loss=0.00423 | Reg=0.00376 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.403 | L2-Norm(final)=2.430 | 3100.7 samples/s | 48.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21614 | acc=0.8299 | tpr=0.7626 | fpr=0.0238 | 3537.7 samples/s | 13.8 steps/s
Avg test loss: 0.21901, Avg test acc: 0.82899, Avg tpr: 0.76214, Avg fpr: 0.02397, total FA: 187

Testing server on iccad2012
[Step=  50] | Loss=0.61779 | acc=0.6642 | tpr=0.9956 | fpr=0.3417 | 3470.6 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.61969 | acc=0.6674 | tpr=0.9957 | fpr=0.3387 | 6851.3 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.62566 | acc=0.6674 | tpr=0.9957 | fpr=0.3387 | 6476.9 samples/s | 25.3 steps/s
[Step= 200] | Loss=0.62549 | acc=0.6687 | tpr=0.9967 | fpr=0.3373 | 6374.4 samples/s | 24.9 steps/s
[Step= 250] | Loss=0.62844 | acc=0.6680 | tpr=0.9965 | fpr=0.3380 | 6887.0 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.62867 | acc=0.6693 | tpr=0.9949 | fpr=0.3366 | 6795.3 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.63062 | acc=0.6690 | tpr=0.9937 | fpr=0.3369 | 6249.8 samples/s | 24.4 steps/s
[Step= 400] | Loss=0.63088 | acc=0.6691 | tpr=0.9945 | fpr=0.3368 | 6240.5 samples/s | 24.4 steps/s
[Step= 450] | Loss=0.63206 | acc=0.6690 | tpr=0.9946 | fpr=0.3369 | 6534.8 samples/s | 25.5 steps/s
[Step= 500] | Loss=0.63208 | acc=0.6688 | tpr=0.9943 | fpr=0.3370 | 5978.5 samples/s | 23.4 steps/s
[Step= 550] | Loss=0.63049 | acc=0.6692 | tpr=0.9940 | fpr=0.3367 | 11280.4 samples/s | 44.1 steps/s
Avg test loss: 0.63011, Avg test acc: 0.66927, Avg tpr: 0.99406, Avg fpr: 0.33663, total FA: 46741

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch= 7.0] | Loss=0.10360 | Reg=0.00378 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.432 | L2-Norm(final)=2.440 | 3760.9 samples/s | 58.8 steps/s
[Step=7250 Epoch= 7.1] | Loss=0.05483 | Reg=0.00378 | FP-Reg=0.006 | acc=0.9375 | L2-Norm=19.434 | L2-Norm(final)=2.433 | 3113.8 samples/s | 48.7 steps/s
[Step=7300 Epoch= 7.1] | Loss=0.05418 | Reg=0.00378 | FP-Reg=0.007 | acc=0.9688 | L2-Norm=19.446 | L2-Norm(final)=2.437 | 3408.9 samples/s | 53.3 steps/s
[Step=7350 Epoch= 7.2] | Loss=0.05055 | Reg=0.00379 | FP-Reg=0.008 | acc=0.9531 | L2-Norm=19.456 | L2-Norm(final)=2.442 | 3369.7 samples/s | 52.7 steps/s
[Step=7400 Epoch= 7.2] | Loss=0.05158 | Reg=0.00379 | FP-Reg=0.009 | acc=0.9531 | L2-Norm=19.465 | L2-Norm(final)=2.443 | 3336.8 samples/s | 52.1 steps/s
[Step=7450 Epoch= 7.3] | Loss=0.05083 | Reg=0.00379 | FP-Reg=0.010 | acc=0.9844 | L2-Norm=19.472 | L2-Norm(final)=2.443 | 3282.8 samples/s | 51.3 steps/s
[Step=7500 Epoch= 7.3] | Loss=0.05033 | Reg=0.00379 | FP-Reg=0.011 | acc=0.9531 | L2-Norm=19.477 | L2-Norm(final)=2.443 | 3347.2 samples/s | 52.3 steps/s
[Step=7550 Epoch= 7.4] | Loss=0.05034 | Reg=0.00380 | FP-Reg=0.012 | acc=0.9688 | L2-Norm=19.482 | L2-Norm(final)=2.443 | 3357.9 samples/s | 52.5 steps/s
[Step=7600 Epoch= 7.4] | Loss=0.05111 | Reg=0.00380 | FP-Reg=0.012 | acc=0.9688 | L2-Norm=19.486 | L2-Norm(final)=2.443 | 3223.3 samples/s | 50.4 steps/s
[Step=7650 Epoch= 7.5] | Loss=0.05065 | Reg=0.00380 | FP-Reg=0.013 | acc=0.9688 | L2-Norm=19.490 | L2-Norm(final)=2.442 | 3121.6 samples/s | 48.8 steps/s
[Step=7700 Epoch= 7.5] | Loss=0.05038 | Reg=0.00380 | FP-Reg=0.013 | acc=0.9375 | L2-Norm=19.493 | L2-Norm(final)=2.443 | 3110.7 samples/s | 48.6 steps/s
[Step=7750 Epoch= 7.6] | Loss=0.05075 | Reg=0.00380 | FP-Reg=0.013 | acc=0.9531 | L2-Norm=19.496 | L2-Norm(final)=2.443 | 3097.9 samples/s | 48.4 steps/s
[Step=7800 Epoch= 7.6] | Loss=0.05048 | Reg=0.00380 | FP-Reg=0.014 | acc=0.9688 | L2-Norm=19.498 | L2-Norm(final)=2.442 | 3112.9 samples/s | 48.6 steps/s
[Step=7850 Epoch= 7.7] | Loss=0.05081 | Reg=0.00380 | FP-Reg=0.014 | acc=0.9531 | L2-Norm=19.500 | L2-Norm(final)=2.441 | 3215.2 samples/s | 50.2 steps/s
[Step=7900 Epoch= 7.7] | Loss=0.05057 | Reg=0.00380 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.502 | L2-Norm(final)=2.441 | 3270.2 samples/s | 51.1 steps/s
[Step=7950 Epoch= 7.8] | Loss=0.05070 | Reg=0.00380 | FP-Reg=0.014 | acc=0.9844 | L2-Norm=19.504 | L2-Norm(final)=2.441 | 3339.2 samples/s | 52.2 steps/s
[Step=8000 Epoch= 7.8] | Loss=0.05077 | Reg=0.00380 | FP-Reg=0.014 | acc=0.9375 | L2-Norm=19.506 | L2-Norm(final)=2.440 | 3308.3 samples/s | 51.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step8000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=13.6] | Loss=0.26218 | Reg=0.00378 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.432 | L2-Norm(final)=2.438 | 3694.8 samples/s | 57.7 steps/s
[Step=7250 Epoch=13.7] | Loss=0.01767 | Reg=0.00379 | FP-Reg=0.019 | acc=1.0000 | L2-Norm=19.460 | L2-Norm(final)=2.420 | 3035.5 samples/s | 47.4 steps/s
[Step=7300 Epoch=13.8] | Loss=0.01100 | Reg=0.00379 | FP-Reg=0.016 | acc=1.0000 | L2-Norm=19.457 | L2-Norm(final)=2.423 | 3188.6 samples/s | 49.8 steps/s
[Step=7350 Epoch=13.9] | Loss=0.00775 | Reg=0.00378 | FP-Reg=0.014 | acc=1.0000 | L2-Norm=19.452 | L2-Norm(final)=2.429 | 3165.9 samples/s | 49.5 steps/s
[Step=7400 Epoch=13.9] | Loss=0.00653 | Reg=0.00378 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.449 | L2-Norm(final)=2.433 | 3144.7 samples/s | 49.1 steps/s
[Step=7450 Epoch=14.0] | Loss=0.00568 | Reg=0.00378 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.447 | L2-Norm(final)=2.436 | 3163.6 samples/s | 49.4 steps/s
[Step=7500 Epoch=14.1] | Loss=0.00497 | Reg=0.00378 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.445 | L2-Norm(final)=2.439 | 3233.3 samples/s | 50.5 steps/s
[Step=7550 Epoch=14.2] | Loss=0.00459 | Reg=0.00378 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.445 | L2-Norm(final)=2.442 | 3203.7 samples/s | 50.1 steps/s
[Step=7600 Epoch=14.3] | Loss=0.00413 | Reg=0.00378 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.445 | L2-Norm(final)=2.444 | 3178.4 samples/s | 49.7 steps/s
[Step=7650 Epoch=14.4] | Loss=0.00371 | Reg=0.00378 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.444 | L2-Norm(final)=2.446 | 3139.0 samples/s | 49.0 steps/s
[Step=7700 Epoch=14.5] | Loss=0.00386 | Reg=0.00378 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.443 | L2-Norm(final)=2.447 | 3097.3 samples/s | 48.4 steps/s
[Step=7750 Epoch=14.6] | Loss=0.00462 | Reg=0.00378 | FP-Reg=0.008 | acc=0.9375 | L2-Norm=19.443 | L2-Norm(final)=2.447 | 1545.1 samples/s | 24.1 steps/s
[Step=7800 Epoch=14.7] | Loss=0.00498 | Reg=0.00378 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.447 | L2-Norm(final)=2.444 | 2879.1 samples/s | 45.0 steps/s
[Step=7850 Epoch=14.8] | Loss=0.00476 | Reg=0.00378 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.449 | L2-Norm(final)=2.443 | 2926.1 samples/s | 45.7 steps/s
[Step=7900 Epoch=14.9] | Loss=0.00464 | Reg=0.00378 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.450 | L2-Norm(final)=2.442 | 2955.1 samples/s | 46.2 steps/s
[Step=7950 Epoch=15.0] | Loss=0.00493 | Reg=0.00378 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.451 | L2-Norm(final)=2.442 | 3250.5 samples/s | 50.8 steps/s
[Step=8000 Epoch=15.1] | Loss=0.00476 | Reg=0.00378 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.451 | L2-Norm(final)=2.442 | 3233.4 samples/s | 50.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37692 | acc=0.7141 | tpr=0.5864 | fpr=0.0087 | 3605.1 samples/s | 14.1 steps/s
Avg test loss: 0.38228, Avg test acc: 0.71188, Avg tpr: 0.58495, Avg fpr: 0.00897, total FA: 70

Testing server on iccad2012
[Step=  50] | Loss=0.36866 | acc=0.7864 | tpr=0.9867 | fpr=0.2172 | 3316.0 samples/s | 13.0 steps/s
[Step= 100] | Loss=0.37481 | acc=0.7868 | tpr=0.9872 | fpr=0.2169 | 6078.0 samples/s | 23.7 steps/s
[Step= 150] | Loss=0.38003 | acc=0.7853 | tpr=0.9856 | fpr=0.2184 | 6169.0 samples/s | 24.1 steps/s
[Step= 200] | Loss=0.38010 | acc=0.7869 | tpr=0.9869 | fpr=0.2168 | 5975.6 samples/s | 23.3 steps/s
[Step= 250] | Loss=0.38291 | acc=0.7851 | tpr=0.9878 | fpr=0.2186 | 6295.1 samples/s | 24.6 steps/s
[Step= 300] | Loss=0.38305 | acc=0.7858 | tpr=0.9862 | fpr=0.2179 | 6300.4 samples/s | 24.6 steps/s
[Step= 350] | Loss=0.38423 | acc=0.7855 | tpr=0.9856 | fpr=0.2181 | 6458.7 samples/s | 25.2 steps/s
[Step= 400] | Loss=0.38455 | acc=0.7854 | tpr=0.9852 | fpr=0.2183 | 6657.8 samples/s | 26.0 steps/s
[Step= 450] | Loss=0.38594 | acc=0.7856 | tpr=0.9859 | fpr=0.2180 | 6309.8 samples/s | 24.6 steps/s
[Step= 500] | Loss=0.38558 | acc=0.7853 | tpr=0.9855 | fpr=0.2183 | 6569.9 samples/s | 25.7 steps/s
[Step= 550] | Loss=0.38456 | acc=0.7854 | tpr=0.9861 | fpr=0.2182 | 11866.5 samples/s | 46.4 steps/s
Avg test loss: 0.38435, Avg test acc: 0.78545, Avg tpr: 0.98613, Avg fpr: 0.21820, total FA: 30297

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch= 7.8] | Loss=0.17819 | Reg=0.00379 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=19.473 | L2-Norm(final)=2.433 | 3459.8 samples/s | 54.1 steps/s
[Step=8050 Epoch= 7.9] | Loss=0.05975 | Reg=0.00379 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.475 | L2-Norm(final)=2.429 | 3190.3 samples/s | 49.8 steps/s
[Step=8100 Epoch= 7.9] | Loss=0.04787 | Reg=0.00379 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.479 | L2-Norm(final)=2.434 | 3312.0 samples/s | 51.8 steps/s
[Step=8150 Epoch= 8.0] | Loss=0.04447 | Reg=0.00380 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.483 | L2-Norm(final)=2.440 | 3339.6 samples/s | 52.2 steps/s
[Step=8200 Epoch= 8.0] | Loss=0.04241 | Reg=0.00380 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.486 | L2-Norm(final)=2.444 | 3321.0 samples/s | 51.9 steps/s
[Step=8250 Epoch= 8.1] | Loss=0.04102 | Reg=0.00380 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.488 | L2-Norm(final)=2.448 | 3302.1 samples/s | 51.6 steps/s
[Step=8300 Epoch= 8.1] | Loss=0.03963 | Reg=0.00380 | FP-Reg=0.005 | acc=0.9219 | L2-Norm=19.490 | L2-Norm(final)=2.450 | 3305.7 samples/s | 51.7 steps/s
[Step=8350 Epoch= 8.2] | Loss=0.03910 | Reg=0.00380 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.492 | L2-Norm(final)=2.453 | 3303.0 samples/s | 51.6 steps/s
[Step=8400 Epoch= 8.2] | Loss=0.03882 | Reg=0.00380 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.494 | L2-Norm(final)=2.455 | 3312.4 samples/s | 51.8 steps/s
[Step=8450 Epoch= 8.3] | Loss=0.03852 | Reg=0.00380 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.495 | L2-Norm(final)=2.457 | 3356.5 samples/s | 52.4 steps/s
[Step=8500 Epoch= 8.3] | Loss=0.03839 | Reg=0.00380 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.497 | L2-Norm(final)=2.458 | 3306.7 samples/s | 51.7 steps/s
[Step=8550 Epoch= 8.3] | Loss=0.03840 | Reg=0.00380 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.498 | L2-Norm(final)=2.460 | 3346.9 samples/s | 52.3 steps/s
[Step=8600 Epoch= 8.4] | Loss=0.03794 | Reg=0.00380 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.500 | L2-Norm(final)=2.462 | 3315.1 samples/s | 51.8 steps/s
[Step=8650 Epoch= 8.4] | Loss=0.03799 | Reg=0.00380 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.501 | L2-Norm(final)=2.462 | 3335.2 samples/s | 52.1 steps/s
[Step=8700 Epoch= 8.5] | Loss=0.03709 | Reg=0.00380 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.502 | L2-Norm(final)=2.464 | 3356.3 samples/s | 52.4 steps/s
[Step=8750 Epoch= 8.5] | Loss=0.03695 | Reg=0.00380 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.504 | L2-Norm(final)=2.465 | 3315.5 samples/s | 51.8 steps/s
[Step=8800 Epoch= 8.6] | Loss=0.03680 | Reg=0.00380 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.505 | L2-Norm(final)=2.466 | 3317.9 samples/s | 51.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step8800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=15.1] | Loss=0.09318 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.473 | L2-Norm(final)=2.434 | 3542.7 samples/s | 55.4 steps/s
[Step=8050 Epoch=15.2] | Loss=0.01170 | Reg=0.00379 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.472 | L2-Norm(final)=2.433 | 3090.7 samples/s | 48.3 steps/s
[Step=8100 Epoch=15.3] | Loss=0.00680 | Reg=0.00379 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.472 | L2-Norm(final)=2.435 | 3139.3 samples/s | 49.1 steps/s
[Step=8150 Epoch=15.4] | Loss=0.00505 | Reg=0.00379 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.471 | L2-Norm(final)=2.438 | 3146.2 samples/s | 49.2 steps/s
[Step=8200 Epoch=15.5] | Loss=0.00419 | Reg=0.00379 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.471 | L2-Norm(final)=2.441 | 3174.9 samples/s | 49.6 steps/s
[Step=8250 Epoch=15.6] | Loss=0.00360 | Reg=0.00379 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.471 | L2-Norm(final)=2.443 | 3190.7 samples/s | 49.9 steps/s
[Step=8300 Epoch=15.6] | Loss=0.00320 | Reg=0.00379 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.471 | L2-Norm(final)=2.445 | 3160.4 samples/s | 49.4 steps/s
[Step=8350 Epoch=15.7] | Loss=0.00282 | Reg=0.00379 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.470 | L2-Norm(final)=2.446 | 3157.0 samples/s | 49.3 steps/s
[Step=8400 Epoch=15.8] | Loss=0.00265 | Reg=0.00379 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.470 | L2-Norm(final)=2.447 | 3133.3 samples/s | 49.0 steps/s
[Step=8450 Epoch=15.9] | Loss=0.00242 | Reg=0.00379 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.470 | L2-Norm(final)=2.448 | 3133.0 samples/s | 49.0 steps/s
[Step=8500 Epoch=16.0] | Loss=0.00222 | Reg=0.00379 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.470 | L2-Norm(final)=2.449 | 3158.1 samples/s | 49.3 steps/s
[Step=8550 Epoch=16.1] | Loss=0.00213 | Reg=0.00379 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.470 | L2-Norm(final)=2.450 | 1682.7 samples/s | 26.3 steps/s
[Step=8600 Epoch=16.2] | Loss=0.00199 | Reg=0.00379 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.469 | L2-Norm(final)=2.450 | 3152.4 samples/s | 49.3 steps/s
[Step=8650 Epoch=16.3] | Loss=0.00186 | Reg=0.00379 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.469 | L2-Norm(final)=2.451 | 3128.5 samples/s | 48.9 steps/s
[Step=8700 Epoch=16.4] | Loss=0.00176 | Reg=0.00379 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.469 | L2-Norm(final)=2.451 | 3129.6 samples/s | 48.9 steps/s
[Step=8750 Epoch=16.5] | Loss=0.00167 | Reg=0.00379 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.469 | L2-Norm(final)=2.452 | 3130.1 samples/s | 48.9 steps/s
[Step=8800 Epoch=16.6] | Loss=0.00160 | Reg=0.00379 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.469 | L2-Norm(final)=2.452 | 3130.6 samples/s | 48.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27663 | acc=0.8041 | tpr=0.7214 | fpr=0.0161 | 3431.0 samples/s | 13.4 steps/s
Avg test loss: 0.28222, Avg test acc: 0.80235, Avg tpr: 0.72111, Avg fpr: 0.01897, total FA: 148

Testing server on iccad2012
[Step=  50] | Loss=0.64989 | acc=0.6958 | tpr=1.0000 | fpr=0.3097 | 3420.4 samples/s | 13.4 steps/s
[Step= 100] | Loss=0.65509 | acc=0.6999 | tpr=0.9979 | fpr=0.3057 | 6131.6 samples/s | 24.0 steps/s
[Step= 150] | Loss=0.66207 | acc=0.6986 | tpr=0.9971 | fpr=0.3069 | 6296.7 samples/s | 24.6 steps/s
[Step= 200] | Loss=0.66059 | acc=0.7003 | tpr=0.9978 | fpr=0.3051 | 6167.0 samples/s | 24.1 steps/s
[Step= 250] | Loss=0.66622 | acc=0.6989 | tpr=0.9974 | fpr=0.3065 | 6016.2 samples/s | 23.5 steps/s
[Step= 300] | Loss=0.66605 | acc=0.6993 | tpr=0.9956 | fpr=0.3061 | 6126.2 samples/s | 23.9 steps/s
[Step= 350] | Loss=0.66719 | acc=0.6987 | tpr=0.9944 | fpr=0.3067 | 6001.5 samples/s | 23.4 steps/s
[Step= 400] | Loss=0.66730 | acc=0.6985 | tpr=0.9951 | fpr=0.3069 | 5964.0 samples/s | 23.3 steps/s
[Step= 450] | Loss=0.66908 | acc=0.6986 | tpr=0.9951 | fpr=0.3068 | 5987.4 samples/s | 23.4 steps/s
[Step= 500] | Loss=0.66926 | acc=0.6984 | tpr=0.9947 | fpr=0.3070 | 5976.2 samples/s | 23.3 steps/s
[Step= 550] | Loss=0.66798 | acc=0.6989 | tpr=0.9948 | fpr=0.3065 | 12076.1 samples/s | 47.2 steps/s
Avg test loss: 0.66755, Avg test acc: 0.69896, Avg tpr: 0.99485, Avg fpr: 0.30642, total FA: 42546

server round 11/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch= 8.6] | Loss=0.33351 | Reg=0.00380 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=19.490 | L2-Norm(final)=2.472 | 4139.2 samples/s | 64.7 steps/s
[Step=8850 Epoch= 8.6] | Loss=0.04553 | Reg=0.00380 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.488 | L2-Norm(final)=2.464 | 2992.5 samples/s | 46.8 steps/s
[Step=8900 Epoch= 8.7] | Loss=0.03708 | Reg=0.00380 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.493 | L2-Norm(final)=2.469 | 3240.7 samples/s | 50.6 steps/s
[Step=8950 Epoch= 8.7] | Loss=0.03609 | Reg=0.00380 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.496 | L2-Norm(final)=2.475 | 3227.9 samples/s | 50.4 steps/s
[Step=9000 Epoch= 8.8] | Loss=0.03769 | Reg=0.00380 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.499 | L2-Norm(final)=2.478 | 3301.2 samples/s | 51.6 steps/s
[Step=9050 Epoch= 8.8] | Loss=0.03737 | Reg=0.00380 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.501 | L2-Norm(final)=2.479 | 3260.0 samples/s | 50.9 steps/s
[Step=9100 Epoch= 8.9] | Loss=0.03778 | Reg=0.00380 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.503 | L2-Norm(final)=2.480 | 3266.7 samples/s | 51.0 steps/s
[Step=9150 Epoch= 8.9] | Loss=0.03721 | Reg=0.00380 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.505 | L2-Norm(final)=2.481 | 3276.9 samples/s | 51.2 steps/s
[Step=9200 Epoch= 9.0] | Loss=0.03705 | Reg=0.00381 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.507 | L2-Norm(final)=2.482 | 3264.6 samples/s | 51.0 steps/s
[Step=9250 Epoch= 9.0] | Loss=0.03645 | Reg=0.00381 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.508 | L2-Norm(final)=2.484 | 3240.7 samples/s | 50.6 steps/s
[Step=9300 Epoch= 9.1] | Loss=0.03638 | Reg=0.00381 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.510 | L2-Norm(final)=2.485 | 3301.2 samples/s | 51.6 steps/s
[Step=9350 Epoch= 9.1] | Loss=0.03576 | Reg=0.00381 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.512 | L2-Norm(final)=2.486 | 3318.1 samples/s | 51.8 steps/s
[Step=9400 Epoch= 9.2] | Loss=0.03526 | Reg=0.00381 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.513 | L2-Norm(final)=2.487 | 3242.0 samples/s | 50.7 steps/s
[Step=9450 Epoch= 9.2] | Loss=0.03520 | Reg=0.00381 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.515 | L2-Norm(final)=2.489 | 3347.2 samples/s | 52.3 steps/s
[Step=9500 Epoch= 9.3] | Loss=0.03478 | Reg=0.00381 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.516 | L2-Norm(final)=2.490 | 3303.0 samples/s | 51.6 steps/s
[Step=9550 Epoch= 9.3] | Loss=0.03471 | Reg=0.00381 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.517 | L2-Norm(final)=2.491 | 3341.8 samples/s | 52.2 steps/s
[Step=9600 Epoch= 9.4] | Loss=0.03452 | Reg=0.00381 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.518 | L2-Norm(final)=2.492 | 3293.2 samples/s | 51.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step9600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=16.6] | Loss=0.22114 | Reg=0.00380 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.490 | L2-Norm(final)=2.472 | 3696.7 samples/s | 57.8 steps/s
[Step=8850 Epoch=16.7] | Loss=0.01118 | Reg=0.00380 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.491 | L2-Norm(final)=2.469 | 2966.9 samples/s | 46.4 steps/s
[Step=8900 Epoch=16.8] | Loss=0.00665 | Reg=0.00380 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.491 | L2-Norm(final)=2.471 | 3162.5 samples/s | 49.4 steps/s
[Step=8950 Epoch=16.9] | Loss=0.00477 | Reg=0.00380 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.490 | L2-Norm(final)=2.474 | 3171.0 samples/s | 49.5 steps/s
[Step=9000 Epoch=17.0] | Loss=0.00373 | Reg=0.00380 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.489 | L2-Norm(final)=2.475 | 3212.5 samples/s | 50.2 steps/s
[Step=9050 Epoch=17.1] | Loss=0.00323 | Reg=0.00380 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.488 | L2-Norm(final)=2.477 | 3183.7 samples/s | 49.7 steps/s
[Step=9100 Epoch=17.2] | Loss=0.00276 | Reg=0.00380 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.488 | L2-Norm(final)=2.479 | 3143.2 samples/s | 49.1 steps/s
[Step=9150 Epoch=17.2] | Loss=0.00239 | Reg=0.00380 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.487 | L2-Norm(final)=2.480 | 3158.3 samples/s | 49.3 steps/s
[Step=9200 Epoch=17.3] | Loss=0.00212 | Reg=0.00380 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.487 | L2-Norm(final)=2.482 | 3124.1 samples/s | 48.8 steps/s
[Step=9250 Epoch=17.4] | Loss=0.00194 | Reg=0.00380 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.486 | L2-Norm(final)=2.483 | 3149.8 samples/s | 49.2 steps/s
[Step=9300 Epoch=17.5] | Loss=0.00188 | Reg=0.00380 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.486 | L2-Norm(final)=2.484 | 3189.5 samples/s | 49.8 steps/s
[Step=9350 Epoch=17.6] | Loss=0.00184 | Reg=0.00380 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.486 | L2-Norm(final)=2.485 | 1662.6 samples/s | 26.0 steps/s
[Step=9400 Epoch=17.7] | Loss=0.00172 | Reg=0.00380 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.486 | L2-Norm(final)=2.486 | 3158.6 samples/s | 49.4 steps/s
[Step=9450 Epoch=17.8] | Loss=0.00160 | Reg=0.00380 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.486 | L2-Norm(final)=2.486 | 3146.2 samples/s | 49.2 steps/s
[Step=9500 Epoch=17.9] | Loss=0.00150 | Reg=0.00380 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.486 | L2-Norm(final)=2.487 | 3136.3 samples/s | 49.0 steps/s
[Step=9550 Epoch=18.0] | Loss=0.00142 | Reg=0.00380 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.486 | L2-Norm(final)=2.487 | 3118.9 samples/s | 48.7 steps/s
[Step=9600 Epoch=18.1] | Loss=0.00135 | Reg=0.00380 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.485 | L2-Norm(final)=2.488 | 3119.7 samples/s | 48.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23836 | acc=0.8302 | tpr=0.7608 | fpr=0.0193 | 3347.5 samples/s | 13.1 steps/s
Avg test loss: 0.24256, Avg test acc: 0.82923, Avg tpr: 0.76074, Avg fpr: 0.02013, total FA: 157

Testing server on iccad2012
[Step=  50] | Loss=0.73667 | acc=0.6823 | tpr=1.0000 | fpr=0.3234 | 3445.1 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.74080 | acc=0.6850 | tpr=0.9979 | fpr=0.3208 | 6028.6 samples/s | 23.5 steps/s
[Step= 150] | Loss=0.74801 | acc=0.6832 | tpr=0.9971 | fpr=0.3226 | 6092.5 samples/s | 23.8 steps/s
[Step= 200] | Loss=0.74592 | acc=0.6850 | tpr=0.9978 | fpr=0.3207 | 6194.1 samples/s | 24.2 steps/s
[Step= 250] | Loss=0.75169 | acc=0.6836 | tpr=0.9974 | fpr=0.3221 | 5883.1 samples/s | 23.0 steps/s
[Step= 300] | Loss=0.75102 | acc=0.6839 | tpr=0.9956 | fpr=0.3217 | 6031.7 samples/s | 23.6 steps/s
[Step= 350] | Loss=0.75242 | acc=0.6841 | tpr=0.9950 | fpr=0.3215 | 6237.2 samples/s | 24.4 steps/s
[Step= 400] | Loss=0.75272 | acc=0.6836 | tpr=0.9956 | fpr=0.3221 | 5978.3 samples/s | 23.4 steps/s
[Step= 450] | Loss=0.75432 | acc=0.6835 | tpr=0.9956 | fpr=0.3222 | 6033.2 samples/s | 23.6 steps/s
[Step= 500] | Loss=0.75475 | acc=0.6833 | tpr=0.9952 | fpr=0.3223 | 5913.5 samples/s | 23.1 steps/s
[Step= 550] | Loss=0.75338 | acc=0.6838 | tpr=0.9952 | fpr=0.3218 | 11477.5 samples/s | 44.8 steps/s
Avg test loss: 0.75294, Avg test acc: 0.68390, Avg tpr: 0.99525, Avg fpr: 0.32176, total FA: 44676

server round 12/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch= 9.4] | Loss=0.17371 | Reg=0.00380 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.505 | L2-Norm(final)=2.500 | 3610.7 samples/s | 56.4 steps/s
[Step=9650 Epoch= 9.4] | Loss=0.02986 | Reg=0.00380 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.504 | L2-Norm(final)=2.500 | 3208.4 samples/s | 50.1 steps/s
[Step=9700 Epoch= 9.5] | Loss=0.03010 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.507 | L2-Norm(final)=2.504 | 3270.7 samples/s | 51.1 steps/s
[Step=9750 Epoch= 9.5] | Loss=0.02939 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.510 | L2-Norm(final)=2.507 | 3265.3 samples/s | 51.0 steps/s
[Step=9800 Epoch= 9.6] | Loss=0.02915 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.513 | L2-Norm(final)=2.509 | 3289.4 samples/s | 51.4 steps/s
[Step=9850 Epoch= 9.6] | Loss=0.02936 | Reg=0.00381 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.515 | L2-Norm(final)=2.512 | 3289.6 samples/s | 51.4 steps/s
[Step=9900 Epoch= 9.7] | Loss=0.03007 | Reg=0.00381 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.518 | L2-Norm(final)=2.514 | 3237.9 samples/s | 50.6 steps/s
[Step=9950 Epoch= 9.7] | Loss=0.03115 | Reg=0.00381 | FP-Reg=0.004 | acc=0.9219 | L2-Norm=19.520 | L2-Norm(final)=2.515 | 3275.4 samples/s | 51.2 steps/s
[Step=10000 Epoch= 9.8] | Loss=0.03158 | Reg=0.00381 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.523 | L2-Norm(final)=2.517 | 3289.7 samples/s | 51.4 steps/s
[Step=10050 Epoch= 9.8] | Loss=0.03190 | Reg=0.00381 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.525 | L2-Norm(final)=2.518 | 3315.4 samples/s | 51.8 steps/s
[Step=10100 Epoch= 9.9] | Loss=0.03225 | Reg=0.00381 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.527 | L2-Norm(final)=2.519 | 3253.7 samples/s | 50.8 steps/s
[Step=10150 Epoch= 9.9] | Loss=0.03220 | Reg=0.00381 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.529 | L2-Norm(final)=2.520 | 3283.3 samples/s | 51.3 steps/s
[Step=10200 Epoch=10.0] | Loss=0.03238 | Reg=0.00381 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.531 | L2-Norm(final)=2.521 | 3252.9 samples/s | 50.8 steps/s
[Step=10250 Epoch=10.0] | Loss=0.03269 | Reg=0.00382 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.533 | L2-Norm(final)=2.521 | 3306.9 samples/s | 51.7 steps/s
[Step=10300 Epoch=10.1] | Loss=0.03233 | Reg=0.00382 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.534 | L2-Norm(final)=2.522 | 3298.7 samples/s | 51.5 steps/s
[Step=10350 Epoch=10.1] | Loss=0.03186 | Reg=0.00382 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.536 | L2-Norm(final)=2.523 | 3299.3 samples/s | 51.6 steps/s
[Step=10400 Epoch=10.2] | Loss=0.03199 | Reg=0.00382 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.537 | L2-Norm(final)=2.524 | 3255.5 samples/s | 50.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step10400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=18.1] | Loss=0.21062 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.505 | L2-Norm(final)=2.499 | 3571.8 samples/s | 55.8 steps/s
[Step=9650 Epoch=18.2] | Loss=0.01710 | Reg=0.00381 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.518 | L2-Norm(final)=2.484 | 3014.5 samples/s | 47.1 steps/s
[Step=9700 Epoch=18.3] | Loss=0.00934 | Reg=0.00381 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.518 | L2-Norm(final)=2.487 | 3145.5 samples/s | 49.1 steps/s
[Step=9750 Epoch=18.4] | Loss=0.00669 | Reg=0.00381 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.516 | L2-Norm(final)=2.491 | 3103.9 samples/s | 48.5 steps/s
[Step=9800 Epoch=18.5] | Loss=0.00535 | Reg=0.00381 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.514 | L2-Norm(final)=2.495 | 3143.4 samples/s | 49.1 steps/s
[Step=9850 Epoch=18.6] | Loss=0.00493 | Reg=0.00381 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.512 | L2-Norm(final)=2.496 | 3109.3 samples/s | 48.6 steps/s
[Step=9900 Epoch=18.7] | Loss=0.00422 | Reg=0.00381 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.512 | L2-Norm(final)=2.499 | 3121.3 samples/s | 48.8 steps/s
[Step=9950 Epoch=18.8] | Loss=0.00369 | Reg=0.00381 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.511 | L2-Norm(final)=2.501 | 3100.4 samples/s | 48.4 steps/s
[Step=10000 Epoch=18.9] | Loss=0.00329 | Reg=0.00381 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.510 | L2-Norm(final)=2.502 | 3096.8 samples/s | 48.4 steps/s
[Step=10050 Epoch=18.9] | Loss=0.00310 | Reg=0.00381 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.509 | L2-Norm(final)=2.503 | 3153.2 samples/s | 49.3 steps/s
[Step=10100 Epoch=19.0] | Loss=0.00294 | Reg=0.00381 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.508 | L2-Norm(final)=2.505 | 3154.1 samples/s | 49.3 steps/s
[Step=10150 Epoch=19.1] | Loss=0.00272 | Reg=0.00381 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.508 | L2-Norm(final)=2.506 | 1657.3 samples/s | 25.9 steps/s
[Step=10200 Epoch=19.2] | Loss=0.00253 | Reg=0.00381 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.508 | L2-Norm(final)=2.507 | 3134.4 samples/s | 49.0 steps/s
[Step=10250 Epoch=19.3] | Loss=0.00236 | Reg=0.00381 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.507 | L2-Norm(final)=2.508 | 3088.7 samples/s | 48.3 steps/s
[Step=10300 Epoch=19.4] | Loss=0.00221 | Reg=0.00381 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.506 | L2-Norm(final)=2.508 | 3111.5 samples/s | 48.6 steps/s
[Step=10350 Epoch=19.5] | Loss=0.00210 | Reg=0.00380 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.506 | L2-Norm(final)=2.509 | 3131.1 samples/s | 48.9 steps/s
[Step=10400 Epoch=19.6] | Loss=0.00199 | Reg=0.00380 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.505 | L2-Norm(final)=2.510 | 3089.6 samples/s | 48.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.16095 | acc=0.8831 | tpr=0.8397 | fpr=0.0225 | 3419.1 samples/s | 13.4 steps/s
Avg test loss: 0.16540, Avg test acc: 0.88264, Avg tpr: 0.84036, Avg fpr: 0.02436, total FA: 190

Testing server on iccad2012
[Step=  50] | Loss=0.89276 | acc=0.6185 | tpr=1.0000 | fpr=0.3883 | 3463.9 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.89326 | acc=0.6239 | tpr=0.9979 | fpr=0.3831 | 6071.4 samples/s | 23.7 steps/s
[Step= 150] | Loss=0.89857 | acc=0.6239 | tpr=0.9971 | fpr=0.3829 | 6094.4 samples/s | 23.8 steps/s
[Step= 200] | Loss=0.89641 | acc=0.6246 | tpr=0.9978 | fpr=0.3822 | 6190.5 samples/s | 24.2 steps/s
[Step= 250] | Loss=0.90263 | acc=0.6237 | tpr=0.9974 | fpr=0.3831 | 6212.7 samples/s | 24.3 steps/s
[Step= 300] | Loss=0.90172 | acc=0.6240 | tpr=0.9956 | fpr=0.3828 | 5985.5 samples/s | 23.4 steps/s
[Step= 350] | Loss=0.90315 | acc=0.6244 | tpr=0.9950 | fpr=0.3823 | 6113.3 samples/s | 23.9 steps/s
[Step= 400] | Loss=0.90378 | acc=0.6242 | tpr=0.9956 | fpr=0.3826 | 6008.9 samples/s | 23.5 steps/s
[Step= 450] | Loss=0.90500 | acc=0.6242 | tpr=0.9956 | fpr=0.3826 | 5940.9 samples/s | 23.2 steps/s
[Step= 500] | Loss=0.90563 | acc=0.6239 | tpr=0.9952 | fpr=0.3828 | 5892.2 samples/s | 23.0 steps/s
[Step= 550] | Loss=0.90408 | acc=0.6243 | tpr=0.9952 | fpr=0.3824 | 11570.1 samples/s | 45.2 steps/s
Avg test loss: 0.90356, Avg test acc: 0.62436, Avg tpr: 0.99525, Avg fpr: 0.38238, total FA: 53093

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=10.2] | Loss=0.14199 | Reg=0.00381 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.521 | L2-Norm(final)=2.525 | 3769.8 samples/s | 58.9 steps/s
[Step=10450 Epoch=10.2] | Loss=0.02897 | Reg=0.00381 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.517 | L2-Norm(final)=2.527 | 3167.8 samples/s | 49.5 steps/s
[Step=10500 Epoch=10.3] | Loss=0.02732 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.521 | L2-Norm(final)=2.532 | 3263.0 samples/s | 51.0 steps/s
[Step=10550 Epoch=10.3] | Loss=0.02763 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.524 | L2-Norm(final)=2.535 | 3248.7 samples/s | 50.8 steps/s
[Step=10600 Epoch=10.3] | Loss=0.02994 | Reg=0.00381 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.526 | L2-Norm(final)=2.536 | 3256.7 samples/s | 50.9 steps/s
[Step=10650 Epoch=10.4] | Loss=0.03106 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.529 | L2-Norm(final)=2.536 | 3351.6 samples/s | 52.4 steps/s
[Step=10700 Epoch=10.4] | Loss=0.03087 | Reg=0.00381 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.531 | L2-Norm(final)=2.536 | 3299.8 samples/s | 51.6 steps/s
[Step=10750 Epoch=10.5] | Loss=0.03034 | Reg=0.00382 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.533 | L2-Norm(final)=2.537 | 3318.1 samples/s | 51.8 steps/s
[Step=10800 Epoch=10.5] | Loss=0.02984 | Reg=0.00382 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.535 | L2-Norm(final)=2.539 | 3308.6 samples/s | 51.7 steps/s
[Step=10850 Epoch=10.6] | Loss=0.02970 | Reg=0.00382 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.537 | L2-Norm(final)=2.540 | 3307.1 samples/s | 51.7 steps/s
[Step=10900 Epoch=10.6] | Loss=0.02945 | Reg=0.00382 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.539 | L2-Norm(final)=2.542 | 3312.2 samples/s | 51.8 steps/s
[Step=10950 Epoch=10.7] | Loss=0.03028 | Reg=0.00382 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.541 | L2-Norm(final)=2.543 | 3305.1 samples/s | 51.6 steps/s
[Step=11000 Epoch=10.7] | Loss=0.03039 | Reg=0.00382 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.543 | L2-Norm(final)=2.543 | 3301.9 samples/s | 51.6 steps/s
[Step=11050 Epoch=10.8] | Loss=0.03029 | Reg=0.00382 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.545 | L2-Norm(final)=2.544 | 3292.1 samples/s | 51.4 steps/s
[Step=11100 Epoch=10.8] | Loss=0.03010 | Reg=0.00382 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.546 | L2-Norm(final)=2.545 | 3279.4 samples/s | 51.2 steps/s
[Step=11150 Epoch=10.9] | Loss=0.02989 | Reg=0.00382 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.548 | L2-Norm(final)=2.545 | 3290.6 samples/s | 51.4 steps/s
[Step=11200 Epoch=10.9] | Loss=0.02996 | Reg=0.00382 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.549 | L2-Norm(final)=2.546 | 3294.6 samples/s | 51.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step11200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=19.6] | Loss=0.30806 | Reg=0.00381 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.521 | L2-Norm(final)=2.525 | 3699.1 samples/s | 57.8 steps/s
[Step=10450 Epoch=19.7] | Loss=0.02924 | Reg=0.00382 | FP-Reg=0.016 | acc=1.0000 | L2-Norm=19.540 | L2-Norm(final)=2.492 | 2978.5 samples/s | 46.5 steps/s
[Step=10500 Epoch=19.8] | Loss=0.01593 | Reg=0.00382 | FP-Reg=0.015 | acc=1.0000 | L2-Norm=19.537 | L2-Norm(final)=2.492 | 3131.5 samples/s | 48.9 steps/s
[Step=10550 Epoch=19.9] | Loss=0.01100 | Reg=0.00382 | FP-Reg=0.013 | acc=1.0000 | L2-Norm=19.533 | L2-Norm(final)=2.496 | 3146.7 samples/s | 49.2 steps/s
[Step=10600 Epoch=20.0] | Loss=0.00843 | Reg=0.00381 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.530 | L2-Norm(final)=2.501 | 3134.2 samples/s | 49.0 steps/s
[Step=10650 Epoch=20.1] | Loss=0.00683 | Reg=0.00381 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.528 | L2-Norm(final)=2.505 | 3124.8 samples/s | 48.8 steps/s
[Step=10700 Epoch=20.2] | Loss=0.00573 | Reg=0.00381 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.526 | L2-Norm(final)=2.509 | 3131.2 samples/s | 48.9 steps/s
[Step=10750 Epoch=20.3] | Loss=0.00496 | Reg=0.00381 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.525 | L2-Norm(final)=2.512 | 3143.2 samples/s | 49.1 steps/s
[Step=10800 Epoch=20.4] | Loss=0.00437 | Reg=0.00381 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.523 | L2-Norm(final)=2.515 | 3148.1 samples/s | 49.2 steps/s
[Step=10850 Epoch=20.5] | Loss=0.00391 | Reg=0.00381 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.522 | L2-Norm(final)=2.517 | 3157.5 samples/s | 49.3 steps/s
[Step=10900 Epoch=20.5] | Loss=0.00361 | Reg=0.00381 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.521 | L2-Norm(final)=2.519 | 3198.0 samples/s | 50.0 steps/s
[Step=10950 Epoch=20.6] | Loss=0.00330 | Reg=0.00381 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.520 | L2-Norm(final)=2.521 | 1673.7 samples/s | 26.2 steps/s
[Step=11000 Epoch=20.7] | Loss=0.00304 | Reg=0.00381 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.520 | L2-Norm(final)=2.522 | 3160.6 samples/s | 49.4 steps/s
[Step=11050 Epoch=20.8] | Loss=0.00282 | Reg=0.00381 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.519 | L2-Norm(final)=2.523 | 3135.4 samples/s | 49.0 steps/s
[Step=11100 Epoch=20.9] | Loss=0.00266 | Reg=0.00381 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.519 | L2-Norm(final)=2.524 | 3150.0 samples/s | 49.2 steps/s
[Step=11150 Epoch=21.0] | Loss=0.00250 | Reg=0.00381 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.518 | L2-Norm(final)=2.525 | 3164.8 samples/s | 49.4 steps/s
[Step=11200 Epoch=21.1] | Loss=0.00236 | Reg=0.00381 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.518 | L2-Norm(final)=2.526 | 3134.8 samples/s | 49.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20355 | acc=0.8495 | tpr=0.7881 | fpr=0.0173 | 3377.9 samples/s | 13.2 steps/s
Avg test loss: 0.20988, Avg test acc: 0.84875, Avg tpr: 0.78813, Avg fpr: 0.01795, total FA: 140

Testing server on iccad2012
[Step=  50] | Loss=0.77239 | acc=0.6695 | tpr=1.0000 | fpr=0.3365 | 3433.2 samples/s | 13.4 steps/s
[Step= 100] | Loss=0.77459 | acc=0.6734 | tpr=0.9979 | fpr=0.3326 | 5966.3 samples/s | 23.3 steps/s
[Step= 150] | Loss=0.77864 | acc=0.6718 | tpr=0.9971 | fpr=0.3342 | 6053.9 samples/s | 23.6 steps/s
[Step= 200] | Loss=0.77628 | acc=0.6729 | tpr=0.9978 | fpr=0.3331 | 6148.6 samples/s | 24.0 steps/s
[Step= 250] | Loss=0.78213 | acc=0.6707 | tpr=0.9965 | fpr=0.3352 | 6137.0 samples/s | 24.0 steps/s
[Step= 300] | Loss=0.78169 | acc=0.6711 | tpr=0.9942 | fpr=0.3348 | 6189.0 samples/s | 24.2 steps/s
[Step= 350] | Loss=0.78313 | acc=0.6713 | tpr=0.9937 | fpr=0.3346 | 6121.0 samples/s | 23.9 steps/s
[Step= 400] | Loss=0.78352 | acc=0.6710 | tpr=0.9945 | fpr=0.3349 | 6036.4 samples/s | 23.6 steps/s
[Step= 450] | Loss=0.78477 | acc=0.6711 | tpr=0.9946 | fpr=0.3348 | 6113.8 samples/s | 23.9 steps/s
[Step= 500] | Loss=0.78543 | acc=0.6708 | tpr=0.9943 | fpr=0.3350 | 5931.2 samples/s | 23.2 steps/s
[Step= 550] | Loss=0.78439 | acc=0.6712 | tpr=0.9944 | fpr=0.3347 | 12014.3 samples/s | 46.9 steps/s
Avg test loss: 0.78399, Avg test acc: 0.67121, Avg tpr: 0.99445, Avg fpr: 0.33467, total FA: 46468

server round 14/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=10.9] | Loss=0.08686 | Reg=0.00382 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.533 | L2-Norm(final)=2.546 | 3710.8 samples/s | 58.0 steps/s
[Step=11250 Epoch=11.0] | Loss=0.03185 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.530 | L2-Norm(final)=2.545 | 3076.4 samples/s | 48.1 steps/s
[Step=11300 Epoch=11.0] | Loss=0.02811 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.534 | L2-Norm(final)=2.548 | 3252.7 samples/s | 50.8 steps/s
[Step=11350 Epoch=11.1] | Loss=0.02858 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.537 | L2-Norm(final)=2.551 | 3227.4 samples/s | 50.4 steps/s
[Step=11400 Epoch=11.1] | Loss=0.02743 | Reg=0.00382 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.540 | L2-Norm(final)=2.555 | 3267.3 samples/s | 51.1 steps/s
[Step=11450 Epoch=11.2] | Loss=0.02789 | Reg=0.00382 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.543 | L2-Norm(final)=2.558 | 3318.1 samples/s | 51.8 steps/s
[Step=11500 Epoch=11.2] | Loss=0.02944 | Reg=0.00382 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.545 | L2-Norm(final)=2.559 | 3288.3 samples/s | 51.4 steps/s
[Step=11550 Epoch=11.3] | Loss=0.02983 | Reg=0.00382 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.548 | L2-Norm(final)=2.560 | 3264.3 samples/s | 51.0 steps/s
[Step=11600 Epoch=11.3] | Loss=0.03033 | Reg=0.00382 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.549 | L2-Norm(final)=2.560 | 3305.4 samples/s | 51.6 steps/s
[Step=11650 Epoch=11.4] | Loss=0.03008 | Reg=0.00382 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.551 | L2-Norm(final)=2.561 | 3336.1 samples/s | 52.1 steps/s
[Step=11700 Epoch=11.4] | Loss=0.02962 | Reg=0.00382 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.553 | L2-Norm(final)=2.562 | 3234.6 samples/s | 50.5 steps/s
[Step=11750 Epoch=11.5] | Loss=0.03004 | Reg=0.00382 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.554 | L2-Norm(final)=2.563 | 3200.1 samples/s | 50.0 steps/s
[Step=11800 Epoch=11.5] | Loss=0.02972 | Reg=0.00382 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.556 | L2-Norm(final)=2.563 | 3242.1 samples/s | 50.7 steps/s
[Step=11850 Epoch=11.6] | Loss=0.02959 | Reg=0.00382 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.557 | L2-Norm(final)=2.563 | 3246.5 samples/s | 50.7 steps/s
[Step=11900 Epoch=11.6] | Loss=0.02975 | Reg=0.00383 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.558 | L2-Norm(final)=2.564 | 3201.9 samples/s | 50.0 steps/s
[Step=11950 Epoch=11.7] | Loss=0.02964 | Reg=0.00383 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.559 | L2-Norm(final)=2.564 | 3297.5 samples/s | 51.5 steps/s
[Step=12000 Epoch=11.7] | Loss=0.02979 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.560 | L2-Norm(final)=2.565 | 3219.8 samples/s | 50.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step12000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=21.1] | Loss=0.25729 | Reg=0.00382 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.533 | L2-Norm(final)=2.544 | 3752.4 samples/s | 58.6 steps/s
[Step=11250 Epoch=21.2] | Loss=0.01870 | Reg=0.00382 | FP-Reg=0.010 | acc=0.9844 | L2-Norm=19.543 | L2-Norm(final)=2.529 | 2912.8 samples/s | 45.5 steps/s
[Step=11300 Epoch=21.3] | Loss=0.01023 | Reg=0.00382 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.544 | L2-Norm(final)=2.532 | 3121.0 samples/s | 48.8 steps/s
[Step=11350 Epoch=21.4] | Loss=0.00712 | Reg=0.00382 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.542 | L2-Norm(final)=2.536 | 3136.8 samples/s | 49.0 steps/s
[Step=11400 Epoch=21.5] | Loss=0.00548 | Reg=0.00382 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.540 | L2-Norm(final)=2.540 | 3121.0 samples/s | 48.8 steps/s
[Step=11450 Epoch=21.6] | Loss=0.00469 | Reg=0.00382 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.539 | L2-Norm(final)=2.542 | 3126.2 samples/s | 48.8 steps/s
[Step=11500 Epoch=21.7] | Loss=0.00396 | Reg=0.00382 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.537 | L2-Norm(final)=2.544 | 3167.8 samples/s | 49.5 steps/s
[Step=11550 Epoch=21.8] | Loss=0.00344 | Reg=0.00382 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.536 | L2-Norm(final)=2.546 | 3128.3 samples/s | 48.9 steps/s
[Step=11600 Epoch=21.9] | Loss=0.00309 | Reg=0.00382 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.535 | L2-Norm(final)=2.548 | 3126.4 samples/s | 48.9 steps/s
[Step=11650 Epoch=22.0] | Loss=0.00281 | Reg=0.00382 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.534 | L2-Norm(final)=2.549 | 3124.9 samples/s | 48.8 steps/s
[Step=11700 Epoch=22.1] | Loss=0.00257 | Reg=0.00382 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.534 | L2-Norm(final)=2.550 | 3172.7 samples/s | 49.6 steps/s
[Step=11750 Epoch=22.1] | Loss=0.00235 | Reg=0.00382 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.533 | L2-Norm(final)=2.551 | 1666.2 samples/s | 26.0 steps/s
[Step=11800 Epoch=22.2] | Loss=0.00216 | Reg=0.00382 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.532 | L2-Norm(final)=2.552 | 3202.6 samples/s | 50.0 steps/s
[Step=11850 Epoch=22.3] | Loss=0.00201 | Reg=0.00381 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.532 | L2-Norm(final)=2.552 | 3152.3 samples/s | 49.3 steps/s
[Step=11900 Epoch=22.4] | Loss=0.00187 | Reg=0.00381 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.531 | L2-Norm(final)=2.553 | 3127.5 samples/s | 48.9 steps/s
[Step=11950 Epoch=22.5] | Loss=0.00191 | Reg=0.00381 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.531 | L2-Norm(final)=2.553 | 3169.1 samples/s | 49.5 steps/s
[Step=12000 Epoch=22.6] | Loss=0.00184 | Reg=0.00381 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.531 | L2-Norm(final)=2.553 | 3120.9 samples/s | 48.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25198 | acc=0.8221 | tpr=0.7481 | fpr=0.0171 | 3408.8 samples/s | 13.3 steps/s
Avg test loss: 0.25991, Avg test acc: 0.82114, Avg tpr: 0.74821, Avg fpr: 0.01846, total FA: 144

Testing server on iccad2012
[Step=  50] | Loss=0.71700 | acc=0.6923 | tpr=0.9912 | fpr=0.3131 | 3435.7 samples/s | 13.4 steps/s
[Step= 100] | Loss=0.72007 | acc=0.6968 | tpr=0.9936 | fpr=0.3087 | 6014.9 samples/s | 23.5 steps/s
[Step= 150] | Loss=0.72518 | acc=0.6968 | tpr=0.9957 | fpr=0.3087 | 6128.1 samples/s | 23.9 steps/s
[Step= 200] | Loss=0.72366 | acc=0.6988 | tpr=0.9967 | fpr=0.3066 | 6195.1 samples/s | 24.2 steps/s
[Step= 250] | Loss=0.72940 | acc=0.6970 | tpr=0.9965 | fpr=0.3084 | 6264.3 samples/s | 24.5 steps/s
[Step= 300] | Loss=0.72881 | acc=0.6979 | tpr=0.9949 | fpr=0.3075 | 6043.9 samples/s | 23.6 steps/s
[Step= 350] | Loss=0.73031 | acc=0.6979 | tpr=0.9944 | fpr=0.3075 | 6012.8 samples/s | 23.5 steps/s
[Step= 400] | Loss=0.73095 | acc=0.6977 | tpr=0.9951 | fpr=0.3077 | 5935.6 samples/s | 23.2 steps/s
[Step= 450] | Loss=0.73282 | acc=0.6975 | tpr=0.9951 | fpr=0.3079 | 5657.0 samples/s | 22.1 steps/s
[Step= 500] | Loss=0.73318 | acc=0.6972 | tpr=0.9947 | fpr=0.3082 | 5820.6 samples/s | 22.7 steps/s
[Step= 550] | Loss=0.73187 | acc=0.6973 | tpr=0.9948 | fpr=0.3081 | 10704.3 samples/s | 41.8 steps/s
Avg test loss: 0.73142, Avg test acc: 0.69734, Avg tpr: 0.99485, Avg fpr: 0.30807, total FA: 42775

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=11.7] | Loss=0.15583 | Reg=0.00382 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.547 | L2-Norm(final)=2.565 | 3930.9 samples/s | 61.4 steps/s
[Step=12050 Epoch=11.8] | Loss=0.03767 | Reg=0.00382 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.548 | L2-Norm(final)=2.558 | 3228.7 samples/s | 50.4 steps/s
[Step=12100 Epoch=11.8] | Loss=0.03240 | Reg=0.00382 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.551 | L2-Norm(final)=2.561 | 3354.2 samples/s | 52.4 steps/s
[Step=12150 Epoch=11.9] | Loss=0.03201 | Reg=0.00382 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.554 | L2-Norm(final)=2.565 | 3362.2 samples/s | 52.5 steps/s
[Step=12200 Epoch=11.9] | Loss=0.02982 | Reg=0.00382 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.557 | L2-Norm(final)=2.567 | 3350.0 samples/s | 52.3 steps/s
[Step=12250 Epoch=12.0] | Loss=0.03006 | Reg=0.00383 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.561 | L2-Norm(final)=2.571 | 3383.6 samples/s | 52.9 steps/s
[Step=12300 Epoch=12.0] | Loss=0.03010 | Reg=0.00383 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.564 | L2-Norm(final)=2.573 | 3406.1 samples/s | 53.2 steps/s
[Step=12350 Epoch=12.1] | Loss=0.02890 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.566 | L2-Norm(final)=2.575 | 3421.1 samples/s | 53.5 steps/s
[Step=12400 Epoch=12.1] | Loss=0.02875 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.568 | L2-Norm(final)=2.577 | 3429.4 samples/s | 53.6 steps/s
[Step=12450 Epoch=12.2] | Loss=0.02906 | Reg=0.00383 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.570 | L2-Norm(final)=2.579 | 3395.8 samples/s | 53.1 steps/s
[Step=12500 Epoch=12.2] | Loss=0.02899 | Reg=0.00383 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.571 | L2-Norm(final)=2.580 | 3376.1 samples/s | 52.8 steps/s
[Step=12550 Epoch=12.3] | Loss=0.02865 | Reg=0.00383 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.573 | L2-Norm(final)=2.581 | 3379.2 samples/s | 52.8 steps/s
[Step=12600 Epoch=12.3] | Loss=0.02840 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.574 | L2-Norm(final)=2.583 | 3371.1 samples/s | 52.7 steps/s
[Step=12650 Epoch=12.4] | Loss=0.02856 | Reg=0.00383 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.575 | L2-Norm(final)=2.583 | 3379.4 samples/s | 52.8 steps/s
[Step=12700 Epoch=12.4] | Loss=0.02904 | Reg=0.00383 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.576 | L2-Norm(final)=2.584 | 3400.5 samples/s | 53.1 steps/s
[Step=12750 Epoch=12.4] | Loss=0.02905 | Reg=0.00383 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.577 | L2-Norm(final)=2.584 | 3422.2 samples/s | 53.5 steps/s
[Step=12800 Epoch=12.5] | Loss=0.02880 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.578 | L2-Norm(final)=2.584 | 3412.0 samples/s | 53.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step12800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=22.6] | Loss=0.28144 | Reg=0.00382 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.547 | L2-Norm(final)=2.564 | 3784.2 samples/s | 59.1 steps/s
[Step=12050 Epoch=22.7] | Loss=0.02105 | Reg=0.00383 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.558 | L2-Norm(final)=2.539 | 3119.7 samples/s | 48.7 steps/s
[Step=12100 Epoch=22.8] | Loss=0.01223 | Reg=0.00383 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.559 | L2-Norm(final)=2.543 | 3266.9 samples/s | 51.0 steps/s
[Step=12150 Epoch=22.9] | Loss=0.00952 | Reg=0.00383 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.558 | L2-Norm(final)=2.547 | 3239.2 samples/s | 50.6 steps/s
[Step=12200 Epoch=23.0] | Loss=0.00745 | Reg=0.00382 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.557 | L2-Norm(final)=2.550 | 3267.6 samples/s | 51.1 steps/s
[Step=12250 Epoch=23.1] | Loss=0.00611 | Reg=0.00382 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.555 | L2-Norm(final)=2.554 | 3246.0 samples/s | 50.7 steps/s
[Step=12300 Epoch=23.2] | Loss=0.00517 | Reg=0.00382 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.554 | L2-Norm(final)=2.556 | 3238.9 samples/s | 50.6 steps/s
[Step=12350 Epoch=23.3] | Loss=0.00450 | Reg=0.00382 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.552 | L2-Norm(final)=2.559 | 3253.9 samples/s | 50.8 steps/s
[Step=12400 Epoch=23.4] | Loss=0.00396 | Reg=0.00382 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.551 | L2-Norm(final)=2.560 | 3271.9 samples/s | 51.1 steps/s
[Step=12450 Epoch=23.5] | Loss=0.00353 | Reg=0.00382 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.550 | L2-Norm(final)=2.562 | 3234.9 samples/s | 50.5 steps/s
[Step=12500 Epoch=23.6] | Loss=0.00323 | Reg=0.00382 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.549 | L2-Norm(final)=2.563 | 3249.5 samples/s | 50.8 steps/s
[Step=12550 Epoch=23.7] | Loss=0.00296 | Reg=0.00382 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.548 | L2-Norm(final)=2.564 | 1723.5 samples/s | 26.9 steps/s
[Step=12600 Epoch=23.8] | Loss=0.00276 | Reg=0.00382 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.547 | L2-Norm(final)=2.566 | 3214.6 samples/s | 50.2 steps/s
[Step=12650 Epoch=23.8] | Loss=0.00257 | Reg=0.00382 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.546 | L2-Norm(final)=2.567 | 3212.8 samples/s | 50.2 steps/s
[Step=12700 Epoch=23.9] | Loss=0.00242 | Reg=0.00382 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.546 | L2-Norm(final)=2.568 | 3205.4 samples/s | 50.1 steps/s
[Step=12750 Epoch=24.0] | Loss=0.00227 | Reg=0.00382 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.545 | L2-Norm(final)=2.568 | 3241.8 samples/s | 50.7 steps/s
[Step=12800 Epoch=24.1] | Loss=0.00214 | Reg=0.00382 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.545 | L2-Norm(final)=2.569 | 3271.1 samples/s | 51.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25423 | acc=0.8271 | tpr=0.7537 | fpr=0.0134 | 3597.1 samples/s | 14.1 steps/s
Avg test loss: 0.26266, Avg test acc: 0.82358, Avg tpr: 0.75071, Avg fpr: 0.01615, total FA: 126

Testing server on iccad2012
[Step=  50] | Loss=0.78642 | acc=0.6770 | tpr=0.9912 | fpr=0.3286 | 3633.8 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.78842 | acc=0.6816 | tpr=0.9936 | fpr=0.3242 | 6595.8 samples/s | 25.8 steps/s
[Step= 150] | Loss=0.79384 | acc=0.6817 | tpr=0.9942 | fpr=0.3240 | 5987.8 samples/s | 23.4 steps/s
[Step= 200] | Loss=0.79161 | acc=0.6836 | tpr=0.9956 | fpr=0.3221 | 5920.5 samples/s | 23.1 steps/s
[Step= 250] | Loss=0.79784 | acc=0.6827 | tpr=0.9956 | fpr=0.3230 | 7226.1 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.79759 | acc=0.6836 | tpr=0.9942 | fpr=0.3221 | 6625.9 samples/s | 25.9 steps/s
[Step= 350] | Loss=0.79927 | acc=0.6834 | tpr=0.9937 | fpr=0.3222 | 7245.6 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.79957 | acc=0.6833 | tpr=0.9945 | fpr=0.3224 | 6810.8 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.80148 | acc=0.6830 | tpr=0.9946 | fpr=0.3227 | 6856.1 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.80171 | acc=0.6828 | tpr=0.9943 | fpr=0.3228 | 6932.6 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.80031 | acc=0.6834 | tpr=0.9944 | fpr=0.3222 | 12924.7 samples/s | 50.5 steps/s
Avg test loss: 0.79982, Avg test acc: 0.68349, Avg tpr: 0.99445, Avg fpr: 0.32217, total FA: 44732

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=12.5] | Loss=0.16053 | Reg=0.00383 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.561 | L2-Norm(final)=2.585 | 4032.9 samples/s | 63.0 steps/s
[Step=12850 Epoch=12.5] | Loss=0.03079 | Reg=0.00383 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.560 | L2-Norm(final)=2.582 | 3291.0 samples/s | 51.4 steps/s
[Step=12900 Epoch=12.6] | Loss=0.02690 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.564 | L2-Norm(final)=2.584 | 3527.9 samples/s | 55.1 steps/s
[Step=12950 Epoch=12.6] | Loss=0.02571 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.567 | L2-Norm(final)=2.588 | 3515.5 samples/s | 54.9 steps/s
[Step=13000 Epoch=12.7] | Loss=0.02522 | Reg=0.00383 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.570 | L2-Norm(final)=2.591 | 3531.8 samples/s | 55.2 steps/s
[Step=13050 Epoch=12.7] | Loss=0.02618 | Reg=0.00383 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.572 | L2-Norm(final)=2.594 | 3553.1 samples/s | 55.5 steps/s
[Step=13100 Epoch=12.8] | Loss=0.02685 | Reg=0.00383 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.574 | L2-Norm(final)=2.595 | 3543.1 samples/s | 55.4 steps/s
[Step=13150 Epoch=12.8] | Loss=0.02760 | Reg=0.00383 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.575 | L2-Norm(final)=2.595 | 3544.7 samples/s | 55.4 steps/s
[Step=13200 Epoch=12.9] | Loss=0.02742 | Reg=0.00383 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.577 | L2-Norm(final)=2.595 | 3542.3 samples/s | 55.3 steps/s
[Step=13250 Epoch=12.9] | Loss=0.02724 | Reg=0.00383 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.578 | L2-Norm(final)=2.596 | 3523.9 samples/s | 55.1 steps/s
[Step=13300 Epoch=13.0] | Loss=0.02712 | Reg=0.00383 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.580 | L2-Norm(final)=2.596 | 3543.2 samples/s | 55.4 steps/s
[Step=13350 Epoch=13.0] | Loss=0.02715 | Reg=0.00383 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.581 | L2-Norm(final)=2.597 | 3549.4 samples/s | 55.5 steps/s
[Step=13400 Epoch=13.1] | Loss=0.02707 | Reg=0.00383 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.583 | L2-Norm(final)=2.597 | 3527.6 samples/s | 55.1 steps/s
[Step=13450 Epoch=13.1] | Loss=0.02681 | Reg=0.00384 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.584 | L2-Norm(final)=2.598 | 3531.2 samples/s | 55.2 steps/s
[Step=13500 Epoch=13.2] | Loss=0.02713 | Reg=0.00384 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.585 | L2-Norm(final)=2.599 | 3534.6 samples/s | 55.2 steps/s
[Step=13550 Epoch=13.2] | Loss=0.02711 | Reg=0.00384 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.587 | L2-Norm(final)=2.599 | 3531.6 samples/s | 55.2 steps/s
[Step=13600 Epoch=13.3] | Loss=0.02717 | Reg=0.00384 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.588 | L2-Norm(final)=2.599 | 3527.1 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step13600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=24.1] | Loss=0.11488 | Reg=0.00383 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.561 | L2-Norm(final)=2.585 | 3681.1 samples/s | 57.5 steps/s
[Step=12850 Epoch=24.2] | Loss=0.01424 | Reg=0.00383 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.571 | L2-Norm(final)=2.574 | 3368.0 samples/s | 52.6 steps/s
[Step=12900 Epoch=24.3] | Loss=0.00834 | Reg=0.00383 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.572 | L2-Norm(final)=2.572 | 3326.8 samples/s | 52.0 steps/s
[Step=12950 Epoch=24.4] | Loss=0.00591 | Reg=0.00383 | FP-Reg=0.009 | acc=0.9844 | L2-Norm=19.570 | L2-Norm(final)=2.575 | 3332.7 samples/s | 52.1 steps/s
[Step=13000 Epoch=24.5] | Loss=0.00452 | Reg=0.00383 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.568 | L2-Norm(final)=2.578 | 3347.4 samples/s | 52.3 steps/s
[Step=13050 Epoch=24.6] | Loss=0.00367 | Reg=0.00383 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.566 | L2-Norm(final)=2.580 | 3302.2 samples/s | 51.6 steps/s
[Step=13100 Epoch=24.7] | Loss=0.00309 | Reg=0.00383 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.564 | L2-Norm(final)=2.582 | 3457.8 samples/s | 54.0 steps/s
[Step=13150 Epoch=24.8] | Loss=0.00270 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.562 | L2-Norm(final)=2.584 | 3436.3 samples/s | 53.7 steps/s
[Step=13200 Epoch=24.9] | Loss=0.00238 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.561 | L2-Norm(final)=2.585 | 3432.2 samples/s | 53.6 steps/s
[Step=13250 Epoch=25.0] | Loss=0.00213 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.560 | L2-Norm(final)=2.587 | 3451.7 samples/s | 53.9 steps/s
[Step=13300 Epoch=25.1] | Loss=0.00193 | Reg=0.00383 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.559 | L2-Norm(final)=2.588 | 3470.0 samples/s | 54.2 steps/s
[Step=13350 Epoch=25.2] | Loss=0.00177 | Reg=0.00383 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.558 | L2-Norm(final)=2.588 | 1775.8 samples/s | 27.7 steps/s
[Step=13400 Epoch=25.3] | Loss=0.00163 | Reg=0.00382 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.557 | L2-Norm(final)=2.589 | 3404.1 samples/s | 53.2 steps/s
[Step=13450 Epoch=25.4] | Loss=0.00152 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.557 | L2-Norm(final)=2.590 | 3407.6 samples/s | 53.2 steps/s
[Step=13500 Epoch=25.4] | Loss=0.00147 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.556 | L2-Norm(final)=2.590 | 3434.9 samples/s | 53.7 steps/s
[Step=13550 Epoch=25.5] | Loss=0.00145 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.556 | L2-Norm(final)=2.591 | 3425.6 samples/s | 53.5 steps/s
[Step=13600 Epoch=25.6] | Loss=0.00142 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.557 | L2-Norm(final)=2.591 | 3398.5 samples/s | 53.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29705 | acc=0.8037 | tpr=0.7194 | fpr=0.0131 | 3822.0 samples/s | 14.9 steps/s
Avg test loss: 0.30749, Avg test acc: 0.80018, Avg tpr: 0.71580, Avg fpr: 0.01423, total FA: 111

Testing server on iccad2012
[Step=  50] | Loss=0.72766 | acc=0.7020 | tpr=1.0000 | fpr=0.3033 | 3855.6 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.72867 | acc=0.7086 | tpr=0.9979 | fpr=0.2968 | 6956.3 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.73418 | acc=0.7079 | tpr=0.9971 | fpr=0.2974 | 7094.4 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.73221 | acc=0.7103 | tpr=0.9967 | fpr=0.2949 | 6943.9 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.73818 | acc=0.7084 | tpr=0.9965 | fpr=0.2969 | 7866.0 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.73704 | acc=0.7095 | tpr=0.9949 | fpr=0.2957 | 6411.2 samples/s | 25.0 steps/s
[Step= 350] | Loss=0.73859 | acc=0.7094 | tpr=0.9944 | fpr=0.2958 | 7004.8 samples/s | 27.4 steps/s
[Step= 400] | Loss=0.73921 | acc=0.7090 | tpr=0.9945 | fpr=0.2962 | 7147.0 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.74091 | acc=0.7088 | tpr=0.9946 | fpr=0.2963 | 6829.9 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.74109 | acc=0.7087 | tpr=0.9943 | fpr=0.2965 | 7173.9 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.74002 | acc=0.7087 | tpr=0.9940 | fpr=0.2965 | 12867.3 samples/s | 50.3 steps/s
Avg test loss: 0.73960, Avg test acc: 0.70877, Avg tpr: 0.99406, Avg fpr: 0.29642, total FA: 41157

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=13.3] | Loss=0.15788 | Reg=0.00383 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.575 | L2-Norm(final)=2.602 | 4044.2 samples/s | 63.2 steps/s
[Step=13650 Epoch=13.3] | Loss=0.03606 | Reg=0.00383 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.573 | L2-Norm(final)=2.596 | 3429.6 samples/s | 53.6 steps/s
[Step=13700 Epoch=13.4] | Loss=0.03170 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.577 | L2-Norm(final)=2.597 | 3589.1 samples/s | 56.1 steps/s
[Step=13750 Epoch=13.4] | Loss=0.02824 | Reg=0.00383 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.580 | L2-Norm(final)=2.601 | 3581.6 samples/s | 56.0 steps/s
[Step=13800 Epoch=13.5] | Loss=0.02784 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.584 | L2-Norm(final)=2.605 | 3620.3 samples/s | 56.6 steps/s
[Step=13850 Epoch=13.5] | Loss=0.02644 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.587 | L2-Norm(final)=2.608 | 3604.5 samples/s | 56.3 steps/s
[Step=13900 Epoch=13.6] | Loss=0.02715 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.589 | L2-Norm(final)=2.610 | 3598.7 samples/s | 56.2 steps/s
[Step=13950 Epoch=13.6] | Loss=0.02715 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.591 | L2-Norm(final)=2.612 | 3588.5 samples/s | 56.1 steps/s
[Step=14000 Epoch=13.7] | Loss=0.02659 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.593 | L2-Norm(final)=2.613 | 3525.5 samples/s | 55.1 steps/s
[Step=14050 Epoch=13.7] | Loss=0.02715 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.594 | L2-Norm(final)=2.614 | 3531.3 samples/s | 55.2 steps/s
[Step=14100 Epoch=13.8] | Loss=0.02739 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.596 | L2-Norm(final)=2.614 | 3532.1 samples/s | 55.2 steps/s
[Step=14150 Epoch=13.8] | Loss=0.02734 | Reg=0.00384 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.597 | L2-Norm(final)=2.614 | 3544.8 samples/s | 55.4 steps/s
[Step=14200 Epoch=13.9] | Loss=0.02745 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.598 | L2-Norm(final)=2.614 | 3527.9 samples/s | 55.1 steps/s
[Step=14250 Epoch=13.9] | Loss=0.02717 | Reg=0.00384 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.599 | L2-Norm(final)=2.614 | 3528.3 samples/s | 55.1 steps/s
[Step=14300 Epoch=14.0] | Loss=0.02711 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.600 | L2-Norm(final)=2.615 | 3536.8 samples/s | 55.3 steps/s
[Step=14350 Epoch=14.0] | Loss=0.02697 | Reg=0.00384 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.601 | L2-Norm(final)=2.615 | 3525.1 samples/s | 55.1 steps/s
[Step=14400 Epoch=14.1] | Loss=0.02674 | Reg=0.00384 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.602 | L2-Norm(final)=2.616 | 3527.8 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step14400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=25.6] | Loss=0.20228 | Reg=0.00383 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.575 | L2-Norm(final)=2.602 | 3549.9 samples/s | 55.5 steps/s
[Step=13650 Epoch=25.7] | Loss=0.02198 | Reg=0.00384 | FP-Reg=0.015 | acc=0.9844 | L2-Norm=19.597 | L2-Norm(final)=2.580 | 3405.6 samples/s | 53.2 steps/s
[Step=13700 Epoch=25.8] | Loss=0.01299 | Reg=0.00384 | FP-Reg=0.015 | acc=1.0000 | L2-Norm=19.598 | L2-Norm(final)=2.577 | 3436.4 samples/s | 53.7 steps/s
[Step=13750 Epoch=25.9] | Loss=0.00896 | Reg=0.00384 | FP-Reg=0.013 | acc=1.0000 | L2-Norm=19.595 | L2-Norm(final)=2.581 | 3441.1 samples/s | 53.8 steps/s
[Step=13800 Epoch=26.0] | Loss=0.00684 | Reg=0.00384 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.584 | 3426.9 samples/s | 53.5 steps/s
[Step=13850 Epoch=26.1] | Loss=0.00555 | Reg=0.00384 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.587 | 3407.3 samples/s | 53.2 steps/s
[Step=13900 Epoch=26.2] | Loss=0.00473 | Reg=0.00384 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.590 | 3443.9 samples/s | 53.8 steps/s
[Step=13950 Epoch=26.3] | Loss=0.00411 | Reg=0.00384 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.584 | L2-Norm(final)=2.592 | 3423.1 samples/s | 53.5 steps/s
[Step=14000 Epoch=26.4] | Loss=0.00371 | Reg=0.00383 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.583 | L2-Norm(final)=2.594 | 3403.9 samples/s | 53.2 steps/s
[Step=14050 Epoch=26.5] | Loss=0.00332 | Reg=0.00383 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.581 | L2-Norm(final)=2.596 | 3463.7 samples/s | 54.1 steps/s
[Step=14100 Epoch=26.6] | Loss=0.00301 | Reg=0.00383 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.580 | L2-Norm(final)=2.598 | 3450.5 samples/s | 53.9 steps/s
[Step=14150 Epoch=26.7] | Loss=0.00274 | Reg=0.00383 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.579 | L2-Norm(final)=2.599 | 1802.7 samples/s | 28.2 steps/s
[Step=14200 Epoch=26.8] | Loss=0.00252 | Reg=0.00383 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.578 | L2-Norm(final)=2.600 | 3363.2 samples/s | 52.6 steps/s
[Step=14250 Epoch=26.9] | Loss=0.00233 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.577 | L2-Norm(final)=2.601 | 3345.4 samples/s | 52.3 steps/s
[Step=14300 Epoch=27.0] | Loss=0.00218 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.576 | L2-Norm(final)=2.602 | 3341.2 samples/s | 52.2 steps/s
[Step=14350 Epoch=27.0] | Loss=0.00204 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.575 | L2-Norm(final)=2.602 | 3337.7 samples/s | 52.2 steps/s
[Step=14400 Epoch=27.1] | Loss=0.00192 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.574 | L2-Norm(final)=2.603 | 3347.9 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19370 | acc=0.8675 | tpr=0.8145 | fpr=0.0173 | 3844.4 samples/s | 15.0 steps/s
Avg test loss: 0.20208, Avg test acc: 0.86630, Avg tpr: 0.81355, Avg fpr: 0.01769, total FA: 138

Testing server on iccad2012
[Step=  50] | Loss=0.96556 | acc=0.6203 | tpr=1.0000 | fpr=0.3865 | 3825.7 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.96006 | acc=0.6266 | tpr=1.0000 | fpr=0.3804 | 7332.3 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.96543 | acc=0.6264 | tpr=0.9986 | fpr=0.3805 | 6892.0 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.96316 | acc=0.6275 | tpr=0.9967 | fpr=0.3792 | 7060.7 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.96904 | acc=0.6267 | tpr=0.9965 | fpr=0.3800 | 7035.1 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.96724 | acc=0.6277 | tpr=0.9942 | fpr=0.3789 | 7334.3 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.96840 | acc=0.6279 | tpr=0.9937 | fpr=0.3787 | 6895.7 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.96888 | acc=0.6280 | tpr=0.9940 | fpr=0.3787 | 7046.5 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.97048 | acc=0.6277 | tpr=0.9942 | fpr=0.3789 | 6913.4 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.97099 | acc=0.6276 | tpr=0.9938 | fpr=0.3790 | 7481.9 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.97005 | acc=0.6278 | tpr=0.9940 | fpr=0.3788 | 11926.8 samples/s | 46.6 steps/s
Avg test loss: 0.96967, Avg test acc: 0.62785, Avg tpr: 0.99406, Avg fpr: 0.37881, total FA: 52597

server round 18/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=14.1] | Loss=0.09480 | Reg=0.00384 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.585 | L2-Norm(final)=2.617 | 3854.1 samples/s | 60.2 steps/s
[Step=14450 Epoch=14.1] | Loss=0.02335 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.584 | L2-Norm(final)=2.620 | 3525.4 samples/s | 55.1 steps/s
[Step=14500 Epoch=14.2] | Loss=0.02310 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.588 | L2-Norm(final)=2.624 | 3531.8 samples/s | 55.2 steps/s
[Step=14550 Epoch=14.2] | Loss=0.02409 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.626 | 3523.2 samples/s | 55.1 steps/s
[Step=14600 Epoch=14.3] | Loss=0.02404 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.591 | L2-Norm(final)=2.626 | 3534.7 samples/s | 55.2 steps/s
[Step=14650 Epoch=14.3] | Loss=0.02455 | Reg=0.00384 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.593 | L2-Norm(final)=2.626 | 3524.3 samples/s | 55.1 steps/s
[Step=14700 Epoch=14.4] | Loss=0.02481 | Reg=0.00384 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.596 | L2-Norm(final)=2.627 | 3537.8 samples/s | 55.3 steps/s
[Step=14750 Epoch=14.4] | Loss=0.02467 | Reg=0.00384 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.598 | L2-Norm(final)=2.628 | 3531.2 samples/s | 55.2 steps/s
[Step=14800 Epoch=14.4] | Loss=0.02478 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.599 | L2-Norm(final)=2.628 | 3521.9 samples/s | 55.0 steps/s
[Step=14850 Epoch=14.5] | Loss=0.02517 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.600 | L2-Norm(final)=2.628 | 3532.8 samples/s | 55.2 steps/s
[Step=14900 Epoch=14.5] | Loss=0.02470 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.602 | L2-Norm(final)=2.628 | 3528.9 samples/s | 55.1 steps/s
[Step=14950 Epoch=14.6] | Loss=0.02489 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.603 | L2-Norm(final)=2.628 | 3540.1 samples/s | 55.3 steps/s
[Step=15000 Epoch=14.6] | Loss=0.02531 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.604 | L2-Norm(final)=2.628 | 3521.3 samples/s | 55.0 steps/s
[Step=15050 Epoch=14.7] | Loss=0.02537 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.605 | L2-Norm(final)=2.628 | 3497.6 samples/s | 54.6 steps/s
[Step=15100 Epoch=14.7] | Loss=0.02540 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.606 | L2-Norm(final)=2.628 | 3540.2 samples/s | 55.3 steps/s
[Step=15150 Epoch=14.8] | Loss=0.02570 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.607 | L2-Norm(final)=2.628 | 3623.5 samples/s | 56.6 steps/s
[Step=15200 Epoch=14.8] | Loss=0.02587 | Reg=0.00384 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.608 | L2-Norm(final)=2.627 | 3616.5 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step15200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=27.1] | Loss=0.20312 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.585 | L2-Norm(final)=2.617 | 3841.5 samples/s | 60.0 steps/s
[Step=14450 Epoch=27.2] | Loss=0.01526 | Reg=0.00384 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.603 | L2-Norm(final)=2.603 | 3367.9 samples/s | 52.6 steps/s
[Step=14500 Epoch=27.3] | Loss=0.00931 | Reg=0.00384 | FP-Reg=0.011 | acc=0.9844 | L2-Norm=19.602 | L2-Norm(final)=2.604 | 3404.9 samples/s | 53.2 steps/s
[Step=14550 Epoch=27.4] | Loss=0.00726 | Reg=0.00384 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.601 | L2-Norm(final)=2.605 | 3418.4 samples/s | 53.4 steps/s
[Step=14600 Epoch=27.5] | Loss=0.00583 | Reg=0.00384 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.600 | L2-Norm(final)=2.607 | 3418.4 samples/s | 53.4 steps/s
[Step=14650 Epoch=27.6] | Loss=0.00477 | Reg=0.00384 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.598 | L2-Norm(final)=2.609 | 3437.8 samples/s | 53.7 steps/s
[Step=14700 Epoch=27.7] | Loss=0.00400 | Reg=0.00384 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.596 | L2-Norm(final)=2.611 | 3424.6 samples/s | 53.5 steps/s
[Step=14750 Epoch=27.8] | Loss=0.00346 | Reg=0.00384 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.594 | L2-Norm(final)=2.612 | 3435.5 samples/s | 53.7 steps/s
[Step=14800 Epoch=27.9] | Loss=0.00316 | Reg=0.00384 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.614 | 3439.8 samples/s | 53.7 steps/s
[Step=14850 Epoch=28.0] | Loss=0.00283 | Reg=0.00384 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.591 | L2-Norm(final)=2.615 | 3456.8 samples/s | 54.0 steps/s
[Step=14900 Epoch=28.1] | Loss=0.00257 | Reg=0.00384 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.616 | 3477.5 samples/s | 54.3 steps/s
[Step=14950 Epoch=28.2] | Loss=0.00234 | Reg=0.00384 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.617 | 1816.6 samples/s | 28.4 steps/s
[Step=15000 Epoch=28.3] | Loss=0.00215 | Reg=0.00384 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.618 | 3405.2 samples/s | 53.2 steps/s
[Step=15050 Epoch=28.4] | Loss=0.00200 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.618 | 3432.4 samples/s | 53.6 steps/s
[Step=15100 Epoch=28.5] | Loss=0.00187 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.585 | L2-Norm(final)=2.619 | 3449.4 samples/s | 53.9 steps/s
[Step=15150 Epoch=28.6] | Loss=0.00175 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.584 | L2-Norm(final)=2.620 | 3420.4 samples/s | 53.4 steps/s
[Step=15200 Epoch=28.7] | Loss=0.00165 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.584 | L2-Norm(final)=2.620 | 3425.3 samples/s | 53.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26180 | acc=0.8308 | tpr=0.7595 | fpr=0.0144 | 3866.0 samples/s | 15.1 steps/s
Avg test loss: 0.27090, Avg test acc: 0.82955, Avg tpr: 0.75911, Avg fpr: 0.01551, total FA: 121

Testing server on iccad2012
[Step=  50] | Loss=0.88199 | acc=0.6635 | tpr=0.9956 | fpr=0.3425 | 3801.5 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.87762 | acc=0.6704 | tpr=0.9979 | fpr=0.3358 | 7134.8 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.88299 | acc=0.6699 | tpr=0.9971 | fpr=0.3361 | 7158.3 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.88091 | acc=0.6714 | tpr=0.9967 | fpr=0.3345 | 6971.7 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.88706 | acc=0.6706 | tpr=0.9965 | fpr=0.3353 | 7081.0 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.88565 | acc=0.6714 | tpr=0.9942 | fpr=0.3344 | 7044.2 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.88727 | acc=0.6710 | tpr=0.9937 | fpr=0.3349 | 7181.3 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.88742 | acc=0.6709 | tpr=0.9940 | fpr=0.3350 | 6758.9 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.88874 | acc=0.6705 | tpr=0.9942 | fpr=0.3354 | 6883.5 samples/s | 26.9 steps/s
[Step= 500] | Loss=0.88894 | acc=0.6705 | tpr=0.9938 | fpr=0.3354 | 7061.2 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.88795 | acc=0.6704 | tpr=0.9940 | fpr=0.3354 | 12589.2 samples/s | 49.2 steps/s
Avg test loss: 0.88748, Avg test acc: 0.67051, Avg tpr: 0.99406, Avg fpr: 0.33537, total FA: 46566

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=14.8] | Loss=0.21960 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.592 | L2-Norm(final)=2.623 | 3945.5 samples/s | 61.6 steps/s
[Step=15250 Epoch=14.9] | Loss=0.03375 | Reg=0.00384 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.593 | L2-Norm(final)=2.616 | 3409.7 samples/s | 53.3 steps/s
[Step=15300 Epoch=14.9] | Loss=0.02745 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.595 | L2-Norm(final)=2.618 | 3612.9 samples/s | 56.5 steps/s
[Step=15350 Epoch=15.0] | Loss=0.02580 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.597 | L2-Norm(final)=2.622 | 3623.8 samples/s | 56.6 steps/s
[Step=15400 Epoch=15.0] | Loss=0.02599 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.599 | L2-Norm(final)=2.624 | 3599.2 samples/s | 56.2 steps/s
[Step=15450 Epoch=15.1] | Loss=0.02539 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.600 | L2-Norm(final)=2.624 | 3546.8 samples/s | 55.4 steps/s
[Step=15500 Epoch=15.1] | Loss=0.02522 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.601 | L2-Norm(final)=2.625 | 3531.2 samples/s | 55.2 steps/s
[Step=15550 Epoch=15.2] | Loss=0.02518 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.602 | L2-Norm(final)=2.626 | 3546.0 samples/s | 55.4 steps/s
[Step=15600 Epoch=15.2] | Loss=0.02447 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.604 | L2-Norm(final)=2.626 | 3544.3 samples/s | 55.4 steps/s
[Step=15650 Epoch=15.3] | Loss=0.02440 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.605 | L2-Norm(final)=2.627 | 3541.1 samples/s | 55.3 steps/s
[Step=15700 Epoch=15.3] | Loss=0.02467 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.606 | L2-Norm(final)=2.628 | 3532.0 samples/s | 55.2 steps/s
[Step=15750 Epoch=15.4] | Loss=0.02480 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.607 | L2-Norm(final)=2.628 | 3530.4 samples/s | 55.2 steps/s
[Step=15800 Epoch=15.4] | Loss=0.02511 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.608 | L2-Norm(final)=2.628 | 3548.0 samples/s | 55.4 steps/s
[Step=15850 Epoch=15.5] | Loss=0.02541 | Reg=0.00385 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.609 | L2-Norm(final)=2.628 | 3543.9 samples/s | 55.4 steps/s
[Step=15900 Epoch=15.5] | Loss=0.02511 | Reg=0.00385 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.610 | L2-Norm(final)=2.628 | 3536.6 samples/s | 55.3 steps/s
[Step=15950 Epoch=15.6] | Loss=0.02504 | Reg=0.00385 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.611 | L2-Norm(final)=2.628 | 3559.8 samples/s | 55.6 steps/s
[Step=16000 Epoch=15.6] | Loss=0.02507 | Reg=0.00385 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.612 | L2-Norm(final)=2.628 | 3538.2 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step16000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=28.7] | Loss=0.39468 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.592 | L2-Norm(final)=2.622 | 3976.5 samples/s | 62.1 steps/s
[Step=15250 Epoch=28.7] | Loss=0.03135 | Reg=0.00385 | FP-Reg=0.017 | acc=1.0000 | L2-Norm=19.609 | L2-Norm(final)=2.583 | 3218.2 samples/s | 50.3 steps/s
[Step=15300 Epoch=28.8] | Loss=0.01653 | Reg=0.00384 | FP-Reg=0.016 | acc=1.0000 | L2-Norm=19.607 | L2-Norm(final)=2.583 | 3423.1 samples/s | 53.5 steps/s
[Step=15350 Epoch=28.9] | Loss=0.01148 | Reg=0.00384 | FP-Reg=0.014 | acc=1.0000 | L2-Norm=19.604 | L2-Norm(final)=2.588 | 3435.4 samples/s | 53.7 steps/s
[Step=15400 Epoch=29.0] | Loss=0.00872 | Reg=0.00384 | FP-Reg=0.012 | acc=1.0000 | L2-Norm=19.601 | L2-Norm(final)=2.593 | 3417.3 samples/s | 53.4 steps/s
[Step=15450 Epoch=29.1] | Loss=0.00718 | Reg=0.00384 | FP-Reg=0.011 | acc=1.0000 | L2-Norm=19.598 | L2-Norm(final)=2.597 | 3413.9 samples/s | 53.3 steps/s
[Step=15500 Epoch=29.2] | Loss=0.00608 | Reg=0.00384 | FP-Reg=0.010 | acc=1.0000 | L2-Norm=19.596 | L2-Norm(final)=2.600 | 3366.1 samples/s | 52.6 steps/s
[Step=15550 Epoch=29.3] | Loss=0.00524 | Reg=0.00384 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.595 | L2-Norm(final)=2.603 | 3342.1 samples/s | 52.2 steps/s
[Step=15600 Epoch=29.4] | Loss=0.00464 | Reg=0.00384 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.593 | L2-Norm(final)=2.606 | 3370.8 samples/s | 52.7 steps/s
[Step=15650 Epoch=29.5] | Loss=0.00415 | Reg=0.00384 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.609 | 3367.7 samples/s | 52.6 steps/s
[Step=15700 Epoch=29.6] | Loss=0.00374 | Reg=0.00384 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.591 | L2-Norm(final)=2.611 | 3378.4 samples/s | 52.8 steps/s
[Step=15750 Epoch=29.7] | Loss=0.00341 | Reg=0.00384 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.612 | 1761.7 samples/s | 27.5 steps/s
[Step=15800 Epoch=29.8] | Loss=0.00314 | Reg=0.00384 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.589 | L2-Norm(final)=2.614 | 3365.7 samples/s | 52.6 steps/s
[Step=15850 Epoch=29.9] | Loss=0.00291 | Reg=0.00384 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.615 | 3329.8 samples/s | 52.0 steps/s
[Step=15900 Epoch=30.0] | Loss=0.00272 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.616 | 3349.9 samples/s | 52.3 steps/s
[Step=15950 Epoch=30.1] | Loss=0.00256 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.618 | 3332.5 samples/s | 52.1 steps/s
[Step=16000 Epoch=30.2] | Loss=0.00240 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.619 | 3360.6 samples/s | 52.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27674 | acc=0.8211 | tpr=0.7449 | fpr=0.0134 | 3928.7 samples/s | 15.3 steps/s
Avg test loss: 0.28644, Avg test acc: 0.81922, Avg tpr: 0.74325, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.83468 | acc=0.6770 | tpr=0.9867 | fpr=0.3285 | 3849.1 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.83088 | acc=0.6849 | tpr=0.9936 | fpr=0.3209 | 7140.2 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.83687 | acc=0.6839 | tpr=0.9942 | fpr=0.3218 | 6961.6 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.83613 | acc=0.6851 | tpr=0.9934 | fpr=0.3205 | 7143.1 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.84255 | acc=0.6836 | tpr=0.9939 | fpr=0.3220 | 7047.6 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.84131 | acc=0.6849 | tpr=0.9927 | fpr=0.3207 | 7038.6 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.84248 | acc=0.6849 | tpr=0.9925 | fpr=0.3207 | 6906.2 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.84270 | acc=0.6849 | tpr=0.9929 | fpr=0.3207 | 7138.3 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.84421 | acc=0.6847 | tpr=0.9932 | fpr=0.3209 | 6864.8 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.84433 | acc=0.6847 | tpr=0.9925 | fpr=0.3208 | 7004.2 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.84321 | acc=0.6850 | tpr=0.9928 | fpr=0.3206 | 13165.9 samples/s | 51.4 steps/s
Avg test loss: 0.84279, Avg test acc: 0.68513, Avg tpr: 0.99287, Avg fpr: 0.32047, total FA: 44496

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=15.6] | Loss=0.15476 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.598 | L2-Norm(final)=2.632 | 4235.5 samples/s | 66.2 steps/s
[Step=16050 Epoch=15.7] | Loss=0.02582 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.593 | L2-Norm(final)=2.630 | 3439.5 samples/s | 53.7 steps/s
[Step=16100 Epoch=15.7] | Loss=0.02202 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.594 | L2-Norm(final)=2.632 | 3607.3 samples/s | 56.4 steps/s
[Step=16150 Epoch=15.8] | Loss=0.02118 | Reg=0.00384 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.595 | L2-Norm(final)=2.635 | 3614.1 samples/s | 56.5 steps/s
[Step=16200 Epoch=15.8] | Loss=0.02004 | Reg=0.00384 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.596 | L2-Norm(final)=2.638 | 3579.8 samples/s | 55.9 steps/s
[Step=16250 Epoch=15.9] | Loss=0.01939 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.597 | L2-Norm(final)=2.640 | 3534.2 samples/s | 55.2 steps/s
[Step=16300 Epoch=15.9] | Loss=0.01843 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.598 | L2-Norm(final)=2.642 | 3552.2 samples/s | 55.5 steps/s
[Step=16350 Epoch=16.0] | Loss=0.01782 | Reg=0.00384 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.599 | L2-Norm(final)=2.644 | 3504.0 samples/s | 54.7 steps/s
[Step=16400 Epoch=16.0] | Loss=0.01758 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.600 | L2-Norm(final)=2.645 | 3533.0 samples/s | 55.2 steps/s
[Step=16450 Epoch=16.1] | Loss=0.01747 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.600 | L2-Norm(final)=2.647 | 3542.7 samples/s | 55.4 steps/s
[Step=16500 Epoch=16.1] | Loss=0.01765 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.601 | L2-Norm(final)=2.648 | 3538.6 samples/s | 55.3 steps/s
[Step=16550 Epoch=16.2] | Loss=0.01737 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.602 | L2-Norm(final)=2.650 | 3536.5 samples/s | 55.3 steps/s
[Step=16600 Epoch=16.2] | Loss=0.01735 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.603 | L2-Norm(final)=2.651 | 3535.3 samples/s | 55.2 steps/s
[Step=16650 Epoch=16.3] | Loss=0.01752 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.603 | L2-Norm(final)=2.652 | 3533.4 samples/s | 55.2 steps/s
[Step=16700 Epoch=16.3] | Loss=0.01744 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.604 | L2-Norm(final)=2.653 | 3522.8 samples/s | 55.0 steps/s
[Step=16750 Epoch=16.4] | Loss=0.01724 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.604 | L2-Norm(final)=2.653 | 3518.6 samples/s | 55.0 steps/s
[Step=16800 Epoch=16.4] | Loss=0.01728 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.605 | L2-Norm(final)=2.654 | 3542.9 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step16800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=30.2] | Loss=0.17523 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.598 | L2-Norm(final)=2.631 | 3596.4 samples/s | 56.2 steps/s
[Step=16050 Epoch=30.3] | Loss=0.01663 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.596 | L2-Norm(final)=2.626 | 3409.0 samples/s | 53.3 steps/s
[Step=16100 Epoch=30.3] | Loss=0.00953 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.596 | L2-Norm(final)=2.625 | 3357.4 samples/s | 52.5 steps/s
[Step=16150 Epoch=30.4] | Loss=0.00661 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.595 | L2-Norm(final)=2.626 | 3381.2 samples/s | 52.8 steps/s
[Step=16200 Epoch=30.5] | Loss=0.00504 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.594 | L2-Norm(final)=2.627 | 3343.2 samples/s | 52.2 steps/s
[Step=16250 Epoch=30.6] | Loss=0.00410 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.593 | L2-Norm(final)=2.628 | 3374.5 samples/s | 52.7 steps/s
[Step=16300 Epoch=30.7] | Loss=0.00346 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.629 | 3442.3 samples/s | 53.8 steps/s
[Step=16350 Epoch=30.8] | Loss=0.00300 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.630 | 3463.7 samples/s | 54.1 steps/s
[Step=16400 Epoch=30.9] | Loss=0.00264 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.591 | L2-Norm(final)=2.631 | 3448.6 samples/s | 53.9 steps/s
[Step=16450 Epoch=31.0] | Loss=0.00236 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.631 | 3421.7 samples/s | 53.5 steps/s
[Step=16500 Epoch=31.1] | Loss=0.00214 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.632 | 3432.0 samples/s | 53.6 steps/s
[Step=16550 Epoch=31.2] | Loss=0.00196 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.633 | 1789.6 samples/s | 28.0 steps/s
[Step=16600 Epoch=31.3] | Loss=0.00180 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.589 | L2-Norm(final)=2.633 | 3391.7 samples/s | 53.0 steps/s
[Step=16650 Epoch=31.4] | Loss=0.00168 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.589 | L2-Norm(final)=2.634 | 3330.4 samples/s | 52.0 steps/s
[Step=16700 Epoch=31.5] | Loss=0.00156 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.589 | L2-Norm(final)=2.634 | 3335.4 samples/s | 52.1 steps/s
[Step=16750 Epoch=31.6] | Loss=0.00147 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.634 | 3353.7 samples/s | 52.4 steps/s
[Step=16800 Epoch=31.7] | Loss=0.00138 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.635 | 3342.7 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21863 | acc=0.8597 | tpr=0.8036 | fpr=0.0186 | 3809.1 samples/s | 14.9 steps/s
Avg test loss: 0.22806, Avg test acc: 0.85800, Avg tpr: 0.80270, Avg fpr: 0.02038, total FA: 159

Testing server on iccad2012
[Step=  50] | Loss=0.96385 | acc=0.6575 | tpr=1.0000 | fpr=0.3487 | 3859.6 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.95968 | acc=0.6639 | tpr=1.0000 | fpr=0.3423 | 7184.6 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.96728 | acc=0.6635 | tpr=0.9986 | fpr=0.3427 | 7501.9 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.96613 | acc=0.6650 | tpr=0.9978 | fpr=0.3411 | 6747.7 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.97324 | acc=0.6637 | tpr=0.9974 | fpr=0.3424 | 7141.4 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.97117 | acc=0.6642 | tpr=0.9964 | fpr=0.3418 | 7083.8 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.97252 | acc=0.6642 | tpr=0.9956 | fpr=0.3419 | 7088.7 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.97298 | acc=0.6639 | tpr=0.9956 | fpr=0.3421 | 6992.2 samples/s | 27.3 steps/s
[Step= 450] | Loss=0.97510 | acc=0.6639 | tpr=0.9956 | fpr=0.3422 | 7078.4 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.97548 | acc=0.6637 | tpr=0.9952 | fpr=0.3423 | 6910.5 samples/s | 27.0 steps/s
[Step= 550] | Loss=0.97442 | acc=0.6638 | tpr=0.9952 | fpr=0.3422 | 13160.5 samples/s | 51.4 steps/s
Avg test loss: 0.97391, Avg test acc: 0.66391, Avg tpr: 0.99525, Avg fpr: 0.34212, total FA: 47502

server round 21/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=16.4] | Loss=0.19979 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.597 | L2-Norm(final)=2.654 | 4308.5 samples/s | 67.3 steps/s
[Step=16850 Epoch=16.5] | Loss=0.02184 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.651 | 3387.4 samples/s | 52.9 steps/s
[Step=16900 Epoch=16.5] | Loss=0.01820 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.594 | L2-Norm(final)=2.655 | 3569.1 samples/s | 55.8 steps/s
[Step=16950 Epoch=16.5] | Loss=0.01692 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.596 | L2-Norm(final)=2.659 | 3592.1 samples/s | 56.1 steps/s
[Step=17000 Epoch=16.6] | Loss=0.01669 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.598 | L2-Norm(final)=2.662 | 3595.5 samples/s | 56.2 steps/s
[Step=17050 Epoch=16.6] | Loss=0.01698 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.599 | L2-Norm(final)=2.664 | 3622.4 samples/s | 56.6 steps/s
[Step=17100 Epoch=16.7] | Loss=0.01720 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.599 | L2-Norm(final)=2.665 | 3629.3 samples/s | 56.7 steps/s
[Step=17150 Epoch=16.7] | Loss=0.01733 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.600 | L2-Norm(final)=2.667 | 3647.1 samples/s | 57.0 steps/s
[Step=17200 Epoch=16.8] | Loss=0.01737 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.601 | L2-Norm(final)=2.668 | 3612.0 samples/s | 56.4 steps/s
[Step=17250 Epoch=16.8] | Loss=0.01754 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.602 | L2-Norm(final)=2.669 | 3621.9 samples/s | 56.6 steps/s
[Step=17300 Epoch=16.9] | Loss=0.01772 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.602 | L2-Norm(final)=2.669 | 3533.6 samples/s | 55.2 steps/s
[Step=17350 Epoch=16.9] | Loss=0.01759 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.603 | L2-Norm(final)=2.670 | 3535.9 samples/s | 55.2 steps/s
[Step=17400 Epoch=17.0] | Loss=0.01738 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.604 | L2-Norm(final)=2.671 | 3541.4 samples/s | 55.3 steps/s
[Step=17450 Epoch=17.0] | Loss=0.01705 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.604 | L2-Norm(final)=2.672 | 3533.0 samples/s | 55.2 steps/s
[Step=17500 Epoch=17.1] | Loss=0.01703 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.605 | L2-Norm(final)=2.673 | 3525.0 samples/s | 55.1 steps/s
[Step=17550 Epoch=17.1] | Loss=0.01707 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.606 | L2-Norm(final)=2.674 | 3527.7 samples/s | 55.1 steps/s
[Step=17600 Epoch=17.2] | Loss=0.01720 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.606 | L2-Norm(final)=2.675 | 3557.2 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step17600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=31.7] | Loss=0.26789 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.597 | L2-Norm(final)=2.654 | 5783.5 samples/s | 90.4 steps/s
[Step=16850 Epoch=31.8] | Loss=0.01515 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.596 | L2-Norm(final)=2.645 | 2671.6 samples/s | 41.7 steps/s
[Step=16900 Epoch=31.9] | Loss=0.00795 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.594 | L2-Norm(final)=2.645 | 3348.0 samples/s | 52.3 steps/s
[Step=16950 Epoch=32.0] | Loss=0.00556 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.593 | L2-Norm(final)=2.646 | 3374.3 samples/s | 52.7 steps/s
[Step=17000 Epoch=32.0] | Loss=0.00424 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.647 | 3366.5 samples/s | 52.6 steps/s
[Step=17050 Epoch=32.1] | Loss=0.00343 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.591 | L2-Norm(final)=2.648 | 3387.1 samples/s | 52.9 steps/s
[Step=17100 Epoch=32.2] | Loss=0.00288 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.649 | 3360.6 samples/s | 52.5 steps/s
[Step=17150 Epoch=32.3] | Loss=0.00248 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.650 | 3366.5 samples/s | 52.6 steps/s
[Step=17200 Epoch=32.4] | Loss=0.00219 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.589 | L2-Norm(final)=2.651 | 3380.7 samples/s | 52.8 steps/s
[Step=17250 Epoch=32.5] | Loss=0.00196 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.589 | L2-Norm(final)=2.652 | 3373.3 samples/s | 52.7 steps/s
[Step=17300 Epoch=32.6] | Loss=0.00178 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.653 | 3409.6 samples/s | 53.3 steps/s
[Step=17350 Epoch=32.7] | Loss=0.00163 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.653 | 1775.4 samples/s | 27.7 steps/s
[Step=17400 Epoch=32.8] | Loss=0.00150 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.654 | 3452.0 samples/s | 53.9 steps/s
[Step=17450 Epoch=32.9] | Loss=0.00139 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.654 | 3405.4 samples/s | 53.2 steps/s
[Step=17500 Epoch=33.0] | Loss=0.00130 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.655 | 3415.0 samples/s | 53.4 steps/s
[Step=17550 Epoch=33.1] | Loss=0.00122 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.655 | 3417.0 samples/s | 53.4 steps/s
[Step=17600 Epoch=33.2] | Loss=0.00115 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.655 | 3407.5 samples/s | 53.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19488 | acc=0.8748 | tpr=0.8270 | fpr=0.0216 | 3825.8 samples/s | 14.9 steps/s
Avg test loss: 0.20341, Avg test acc: 0.87279, Avg tpr: 0.82544, Avg fpr: 0.02307, total FA: 180

Testing server on iccad2012
[Step=  50] | Loss=1.07123 | acc=0.6365 | tpr=1.0000 | fpr=0.3700 | 3887.3 samples/s | 15.2 steps/s
[Step= 100] | Loss=1.06580 | acc=0.6431 | tpr=1.0000 | fpr=0.3636 | 7028.0 samples/s | 27.5 steps/s
[Step= 150] | Loss=1.07354 | acc=0.6425 | tpr=1.0000 | fpr=0.3641 | 7056.7 samples/s | 27.6 steps/s
[Step= 200] | Loss=1.07217 | acc=0.6434 | tpr=1.0000 | fpr=0.3631 | 7298.2 samples/s | 28.5 steps/s
[Step= 250] | Loss=1.07968 | acc=0.6425 | tpr=0.9991 | fpr=0.3640 | 6790.4 samples/s | 26.5 steps/s
[Step= 300] | Loss=1.07783 | acc=0.6430 | tpr=0.9971 | fpr=0.3635 | 7113.6 samples/s | 27.8 steps/s
[Step= 350] | Loss=1.07933 | acc=0.6427 | tpr=0.9962 | fpr=0.3637 | 7088.5 samples/s | 27.7 steps/s
[Step= 400] | Loss=1.07970 | acc=0.6425 | tpr=0.9967 | fpr=0.3640 | 6836.4 samples/s | 26.7 steps/s
[Step= 450] | Loss=1.08172 | acc=0.6423 | tpr=0.9966 | fpr=0.3641 | 6866.5 samples/s | 26.8 steps/s
[Step= 500] | Loss=1.08241 | acc=0.6421 | tpr=0.9960 | fpr=0.3643 | 7101.4 samples/s | 27.7 steps/s
[Step= 550] | Loss=1.08117 | acc=0.6425 | tpr=0.9960 | fpr=0.3639 | 12609.0 samples/s | 49.3 steps/s
Avg test loss: 1.08066, Avg test acc: 0.64252, Avg tpr: 0.99604, Avg fpr: 0.36391, total FA: 50528

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=17.2] | Loss=0.24354 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.598 | L2-Norm(final)=2.675 | 4273.3 samples/s | 66.8 steps/s
[Step=17650 Epoch=17.2] | Loss=0.02447 | Reg=0.00384 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.672 | 3363.8 samples/s | 52.6 steps/s
[Step=17700 Epoch=17.3] | Loss=0.01993 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.593 | L2-Norm(final)=2.675 | 3618.1 samples/s | 56.5 steps/s
[Step=17750 Epoch=17.3] | Loss=0.01932 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.594 | L2-Norm(final)=2.677 | 3625.1 samples/s | 56.6 steps/s
[Step=17800 Epoch=17.4] | Loss=0.01744 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.595 | L2-Norm(final)=2.679 | 3644.5 samples/s | 56.9 steps/s
[Step=17850 Epoch=17.4] | Loss=0.01762 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.596 | L2-Norm(final)=2.681 | 3641.4 samples/s | 56.9 steps/s
[Step=17900 Epoch=17.5] | Loss=0.01812 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.597 | L2-Norm(final)=2.682 | 3649.2 samples/s | 57.0 steps/s
[Step=17950 Epoch=17.5] | Loss=0.01784 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.598 | L2-Norm(final)=2.684 | 3544.3 samples/s | 55.4 steps/s
[Step=18000 Epoch=17.6] | Loss=0.01779 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.599 | L2-Norm(final)=2.685 | 3546.4 samples/s | 55.4 steps/s
[Step=18050 Epoch=17.6] | Loss=0.01767 | Reg=0.00384 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.600 | L2-Norm(final)=2.686 | 3586.1 samples/s | 56.0 steps/s
[Step=18100 Epoch=17.7] | Loss=0.01789 | Reg=0.00384 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.600 | L2-Norm(final)=2.687 | 3632.4 samples/s | 56.8 steps/s
[Step=18150 Epoch=17.7] | Loss=0.01772 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.601 | L2-Norm(final)=2.688 | 3542.5 samples/s | 55.4 steps/s
[Step=18200 Epoch=17.8] | Loss=0.01754 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.602 | L2-Norm(final)=2.689 | 3543.2 samples/s | 55.4 steps/s
[Step=18250 Epoch=17.8] | Loss=0.01740 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.603 | L2-Norm(final)=2.690 | 3546.3 samples/s | 55.4 steps/s
[Step=18300 Epoch=17.9] | Loss=0.01723 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.603 | L2-Norm(final)=2.690 | 3555.9 samples/s | 55.6 steps/s
[Step=18350 Epoch=17.9] | Loss=0.01695 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.604 | L2-Norm(final)=2.691 | 3551.9 samples/s | 55.5 steps/s
[Step=18400 Epoch=18.0] | Loss=0.01706 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.605 | L2-Norm(final)=2.692 | 3538.3 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step18400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=33.2] | Loss=0.37855 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.598 | L2-Norm(final)=2.674 | 3882.3 samples/s | 60.7 steps/s
[Step=17650 Epoch=33.3] | Loss=0.02353 | Reg=0.00384 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.595 | L2-Norm(final)=2.659 | 3119.2 samples/s | 48.7 steps/s
[Step=17700 Epoch=33.4] | Loss=0.01286 | Reg=0.00384 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.593 | L2-Norm(final)=2.658 | 3346.6 samples/s | 52.3 steps/s
[Step=17750 Epoch=33.5] | Loss=0.00899 | Reg=0.00384 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.659 | 3377.7 samples/s | 52.8 steps/s
[Step=17800 Epoch=33.6] | Loss=0.00684 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.591 | L2-Norm(final)=2.660 | 3357.4 samples/s | 52.5 steps/s
[Step=17850 Epoch=33.6] | Loss=0.00553 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.662 | 3356.8 samples/s | 52.5 steps/s
[Step=17900 Epoch=33.7] | Loss=0.00466 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.589 | L2-Norm(final)=2.663 | 3404.2 samples/s | 53.2 steps/s
[Step=17950 Epoch=33.8] | Loss=0.00402 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.589 | L2-Norm(final)=2.664 | 3399.4 samples/s | 53.1 steps/s
[Step=18000 Epoch=33.9] | Loss=0.00354 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.665 | 3351.1 samples/s | 52.4 steps/s
[Step=18050 Epoch=34.0] | Loss=0.00317 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.666 | 3371.5 samples/s | 52.7 steps/s
[Step=18100 Epoch=34.1] | Loss=0.00287 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.667 | 3482.8 samples/s | 54.4 steps/s
[Step=18150 Epoch=34.2] | Loss=0.00262 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.668 | 1823.3 samples/s | 28.5 steps/s
[Step=18200 Epoch=34.3] | Loss=0.00240 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.669 | 3452.9 samples/s | 54.0 steps/s
[Step=18250 Epoch=34.4] | Loss=0.00223 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.669 | 3367.0 samples/s | 52.6 steps/s
[Step=18300 Epoch=34.5] | Loss=0.00207 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.670 | 3343.7 samples/s | 52.2 steps/s
[Step=18350 Epoch=34.6] | Loss=0.00194 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.670 | 3361.4 samples/s | 52.5 steps/s
[Step=18400 Epoch=34.7] | Loss=0.00183 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.671 | 3370.6 samples/s | 52.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25131 | acc=0.8402 | tpr=0.7743 | fpr=0.0168 | 3869.7 samples/s | 15.1 steps/s
Avg test loss: 0.25919, Avg test acc: 0.84113, Avg tpr: 0.77723, Avg fpr: 0.01833, total FA: 143

Testing server on iccad2012
[Step=  50] | Loss=0.87371 | acc=0.6923 | tpr=1.0000 | fpr=0.3133 | 3887.8 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.87206 | acc=0.6995 | tpr=1.0000 | fpr=0.3061 | 7105.1 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.87918 | acc=0.6988 | tpr=0.9986 | fpr=0.3067 | 6929.3 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.87799 | acc=0.7000 | tpr=0.9978 | fpr=0.3054 | 7166.1 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.88482 | acc=0.6982 | tpr=0.9974 | fpr=0.3073 | 6966.8 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.88350 | acc=0.6990 | tpr=0.9956 | fpr=0.3064 | 6781.4 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.88548 | acc=0.6989 | tpr=0.9950 | fpr=0.3065 | 6961.7 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.88565 | acc=0.6985 | tpr=0.9951 | fpr=0.3069 | 6961.8 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.88752 | acc=0.6985 | tpr=0.9951 | fpr=0.3069 | 7172.0 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.88783 | acc=0.6983 | tpr=0.9947 | fpr=0.3070 | 6794.5 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.88681 | acc=0.6985 | tpr=0.9948 | fpr=0.3069 | 13062.7 samples/s | 51.0 steps/s
Avg test loss: 0.88636, Avg test acc: 0.69860, Avg tpr: 0.99485, Avg fpr: 0.30678, total FA: 42596

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=18.0] | Loss=0.24573 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.596 | L2-Norm(final)=2.691 | 3848.1 samples/s | 60.1 steps/s
[Step=18450 Epoch=18.0] | Loss=0.02394 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.688 | 3503.0 samples/s | 54.7 steps/s
[Step=18500 Epoch=18.1] | Loss=0.01969 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.592 | L2-Norm(final)=2.689 | 3504.9 samples/s | 54.8 steps/s
[Step=18550 Epoch=18.1] | Loss=0.01872 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.593 | L2-Norm(final)=2.692 | 3509.9 samples/s | 54.8 steps/s
[Step=18600 Epoch=18.2] | Loss=0.01876 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.594 | L2-Norm(final)=2.693 | 3526.9 samples/s | 55.1 steps/s
[Step=18650 Epoch=18.2] | Loss=0.01851 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.595 | L2-Norm(final)=2.695 | 3601.7 samples/s | 56.3 steps/s
[Step=18700 Epoch=18.3] | Loss=0.01792 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.596 | L2-Norm(final)=2.696 | 3617.4 samples/s | 56.5 steps/s
[Step=18750 Epoch=18.3] | Loss=0.01761 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.596 | L2-Norm(final)=2.697 | 3651.7 samples/s | 57.1 steps/s
[Step=18800 Epoch=18.4] | Loss=0.01750 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.597 | L2-Norm(final)=2.698 | 3645.3 samples/s | 57.0 steps/s
[Step=18850 Epoch=18.4] | Loss=0.01730 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.598 | L2-Norm(final)=2.699 | 3641.2 samples/s | 56.9 steps/s
[Step=18900 Epoch=18.5] | Loss=0.01718 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.598 | L2-Norm(final)=2.700 | 3637.5 samples/s | 56.8 steps/s
[Step=18950 Epoch=18.5] | Loss=0.01702 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.599 | L2-Norm(final)=2.701 | 3616.3 samples/s | 56.5 steps/s
[Step=19000 Epoch=18.6] | Loss=0.01714 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.600 | L2-Norm(final)=2.702 | 3616.6 samples/s | 56.5 steps/s
[Step=19050 Epoch=18.6] | Loss=0.01731 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.600 | L2-Norm(final)=2.703 | 3625.5 samples/s | 56.6 steps/s
[Step=19100 Epoch=18.6] | Loss=0.01725 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.601 | L2-Norm(final)=2.703 | 3581.1 samples/s | 56.0 steps/s
[Step=19150 Epoch=18.7] | Loss=0.01723 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.601 | L2-Norm(final)=2.704 | 3545.2 samples/s | 55.4 steps/s
[Step=19200 Epoch=18.7] | Loss=0.01691 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.602 | L2-Norm(final)=2.704 | 3539.8 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step19200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=34.7] | Loss=0.22157 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.596 | L2-Norm(final)=2.691 | 3589.2 samples/s | 56.1 steps/s
[Step=18450 Epoch=34.8] | Loss=0.02241 | Reg=0.00384 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.594 | L2-Norm(final)=2.677 | 3319.7 samples/s | 51.9 steps/s
[Step=18500 Epoch=34.9] | Loss=0.01152 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.675 | 3410.6 samples/s | 53.3 steps/s
[Step=18550 Epoch=35.0] | Loss=0.00781 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.591 | L2-Norm(final)=2.676 | 3451.6 samples/s | 53.9 steps/s
[Step=18600 Epoch=35.1] | Loss=0.00600 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.678 | 3448.4 samples/s | 53.9 steps/s
[Step=18650 Epoch=35.2] | Loss=0.00483 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.589 | L2-Norm(final)=2.679 | 3440.1 samples/s | 53.8 steps/s
[Step=18700 Epoch=35.2] | Loss=0.00405 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.680 | 3429.2 samples/s | 53.6 steps/s
[Step=18750 Epoch=35.3] | Loss=0.00349 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.681 | 3444.8 samples/s | 53.8 steps/s
[Step=18800 Epoch=35.4] | Loss=0.00307 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.682 | 3466.4 samples/s | 54.2 steps/s
[Step=18850 Epoch=35.5] | Loss=0.00275 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.683 | 3441.4 samples/s | 53.8 steps/s
[Step=18900 Epoch=35.6] | Loss=0.00249 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.585 | L2-Norm(final)=2.684 | 3415.0 samples/s | 53.4 steps/s
[Step=18950 Epoch=35.7] | Loss=0.00227 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.585 | L2-Norm(final)=2.685 | 1775.8 samples/s | 27.7 steps/s
[Step=19000 Epoch=35.8] | Loss=0.00209 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.585 | L2-Norm(final)=2.686 | 3401.9 samples/s | 53.2 steps/s
[Step=19050 Epoch=35.9] | Loss=0.00193 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.584 | L2-Norm(final)=2.686 | 3332.4 samples/s | 52.1 steps/s
[Step=19100 Epoch=36.0] | Loss=0.00180 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.584 | L2-Norm(final)=2.687 | 3376.5 samples/s | 52.8 steps/s
[Step=19150 Epoch=36.1] | Loss=0.00169 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.584 | L2-Norm(final)=2.687 | 3269.2 samples/s | 51.1 steps/s
[Step=19200 Epoch=36.2] | Loss=0.00159 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.584 | L2-Norm(final)=2.688 | 3318.6 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25506 | acc=0.8380 | tpr=0.7693 | fpr=0.0126 | 3847.0 samples/s | 15.0 steps/s
Avg test loss: 0.26375, Avg test acc: 0.83681, Avg tpr: 0.76919, Avg fpr: 0.01449, total FA: 113

Testing server on iccad2012
[Step=  50] | Loss=0.84643 | acc=0.7002 | tpr=1.0000 | fpr=0.3052 | 3843.6 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.84413 | acc=0.7065 | tpr=1.0000 | fpr=0.2990 | 7315.2 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.85169 | acc=0.7044 | tpr=0.9971 | fpr=0.3010 | 6912.4 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.85125 | acc=0.7053 | tpr=0.9967 | fpr=0.3000 | 7065.3 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.85763 | acc=0.7037 | tpr=0.9965 | fpr=0.3017 | 7141.3 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.85645 | acc=0.7047 | tpr=0.9942 | fpr=0.3006 | 7134.1 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.85824 | acc=0.7047 | tpr=0.9937 | fpr=0.3005 | 7285.6 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.85830 | acc=0.7046 | tpr=0.9940 | fpr=0.3007 | 6549.7 samples/s | 25.6 steps/s
[Step= 450] | Loss=0.86010 | acc=0.7047 | tpr=0.9942 | fpr=0.3005 | 7077.0 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.86041 | acc=0.7045 | tpr=0.9938 | fpr=0.3007 | 6891.9 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.85943 | acc=0.7046 | tpr=0.9940 | fpr=0.3007 | 12879.6 samples/s | 50.3 steps/s
Avg test loss: 0.85898, Avg test acc: 0.70467, Avg tpr: 0.99406, Avg fpr: 0.30059, total FA: 41737

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=18.7] | Loss=0.20487 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.594 | L2-Norm(final)=2.706 | 4275.2 samples/s | 66.8 steps/s
[Step=19250 Epoch=18.8] | Loss=0.02071 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.590 | L2-Norm(final)=2.705 | 3382.0 samples/s | 52.8 steps/s
[Step=19300 Epoch=18.8] | Loss=0.01754 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.591 | L2-Norm(final)=2.708 | 3508.2 samples/s | 54.8 steps/s
[Step=19350 Epoch=18.9] | Loss=0.01606 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.711 | 3523.8 samples/s | 55.1 steps/s
[Step=19400 Epoch=18.9] | Loss=0.01505 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.593 | L2-Norm(final)=2.714 | 3513.5 samples/s | 54.9 steps/s
[Step=19450 Epoch=19.0] | Loss=0.01559 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.594 | L2-Norm(final)=2.716 | 3497.8 samples/s | 54.7 steps/s
[Step=19500 Epoch=19.0] | Loss=0.01605 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.595 | L2-Norm(final)=2.717 | 3533.7 samples/s | 55.2 steps/s
[Step=19550 Epoch=19.1] | Loss=0.01556 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.596 | L2-Norm(final)=2.718 | 3528.1 samples/s | 55.1 steps/s
[Step=19600 Epoch=19.1] | Loss=0.01577 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.596 | L2-Norm(final)=2.719 | 3540.6 samples/s | 55.3 steps/s
[Step=19650 Epoch=19.2] | Loss=0.01587 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.597 | L2-Norm(final)=2.720 | 3517.9 samples/s | 55.0 steps/s
[Step=19700 Epoch=19.2] | Loss=0.01578 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.597 | L2-Norm(final)=2.721 | 3534.4 samples/s | 55.2 steps/s
[Step=19750 Epoch=19.3] | Loss=0.01561 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.598 | L2-Norm(final)=2.722 | 3544.2 samples/s | 55.4 steps/s
[Step=19800 Epoch=19.3] | Loss=0.01580 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.598 | L2-Norm(final)=2.722 | 3520.4 samples/s | 55.0 steps/s
[Step=19850 Epoch=19.4] | Loss=0.01564 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.599 | L2-Norm(final)=2.723 | 3539.8 samples/s | 55.3 steps/s
[Step=19900 Epoch=19.4] | Loss=0.01556 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.600 | L2-Norm(final)=2.724 | 3549.7 samples/s | 55.5 steps/s
[Step=19950 Epoch=19.5] | Loss=0.01579 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.600 | L2-Norm(final)=2.724 | 3543.5 samples/s | 55.4 steps/s
[Step=20000 Epoch=19.5] | Loss=0.01587 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.601 | L2-Norm(final)=2.725 | 3544.0 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step20000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=36.2] | Loss=0.13924 | Reg=0.00384 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.594 | L2-Norm(final)=2.706 | 4139.1 samples/s | 64.7 steps/s
[Step=19250 Epoch=36.3] | Loss=0.01703 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.698 | 3178.9 samples/s | 49.7 steps/s
[Step=19300 Epoch=36.4] | Loss=0.00893 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.697 | 3441.3 samples/s | 53.8 steps/s
[Step=19350 Epoch=36.5] | Loss=0.00612 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.591 | L2-Norm(final)=2.698 | 3432.6 samples/s | 53.6 steps/s
[Step=19400 Epoch=36.6] | Loss=0.00465 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.699 | 3435.1 samples/s | 53.7 steps/s
[Step=19450 Epoch=36.7] | Loss=0.00377 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.589 | L2-Norm(final)=2.700 | 3438.9 samples/s | 53.7 steps/s
[Step=19500 Epoch=36.8] | Loss=0.00316 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.701 | 3416.3 samples/s | 53.4 steps/s
[Step=19550 Epoch=36.9] | Loss=0.00272 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.702 | 3364.9 samples/s | 52.6 steps/s
[Step=19600 Epoch=36.9] | Loss=0.00242 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.702 | 3368.5 samples/s | 52.6 steps/s
[Step=19650 Epoch=37.0] | Loss=0.00216 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.703 | 3345.0 samples/s | 52.3 steps/s
[Step=19700 Epoch=37.1] | Loss=0.00195 | Reg=0.00384 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.704 | 3405.5 samples/s | 53.2 steps/s
[Step=19750 Epoch=37.2] | Loss=0.00178 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.585 | L2-Norm(final)=2.704 | 1789.5 samples/s | 28.0 steps/s
[Step=19800 Epoch=37.3] | Loss=0.00164 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.585 | L2-Norm(final)=2.705 | 3338.6 samples/s | 52.2 steps/s
[Step=19850 Epoch=37.4] | Loss=0.00152 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.585 | L2-Norm(final)=2.705 | 3347.9 samples/s | 52.3 steps/s
[Step=19900 Epoch=37.5] | Loss=0.00142 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.584 | L2-Norm(final)=2.706 | 3336.3 samples/s | 52.1 steps/s
[Step=19950 Epoch=37.6] | Loss=0.00133 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.584 | L2-Norm(final)=2.706 | 3354.7 samples/s | 52.4 steps/s
[Step=20000 Epoch=37.7] | Loss=0.00125 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.584 | L2-Norm(final)=2.706 | 3371.6 samples/s | 52.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29616 | acc=0.8243 | tpr=0.7487 | fpr=0.0116 | 3922.9 samples/s | 15.3 steps/s
Avg test loss: 0.30671, Avg test acc: 0.82378, Avg tpr: 0.74955, Avg fpr: 0.01295, total FA: 101

Testing server on iccad2012
[Step=  50] | Loss=0.91626 | acc=0.6957 | tpr=1.0000 | fpr=0.3098 | 3790.9 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.91298 | acc=0.7019 | tpr=1.0000 | fpr=0.3037 | 7213.2 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.92050 | acc=0.7003 | tpr=0.9986 | fpr=0.3052 | 7114.4 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.91983 | acc=0.7012 | tpr=0.9978 | fpr=0.3042 | 6920.0 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.92693 | acc=0.6995 | tpr=0.9974 | fpr=0.3059 | 7125.8 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.92557 | acc=0.7005 | tpr=0.9949 | fpr=0.3049 | 7182.0 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.92746 | acc=0.7005 | tpr=0.9944 | fpr=0.3049 | 7131.0 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.92759 | acc=0.7002 | tpr=0.9951 | fpr=0.3051 | 7000.8 samples/s | 27.3 steps/s
[Step= 450] | Loss=0.92978 | acc=0.7002 | tpr=0.9951 | fpr=0.3052 | 6953.9 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.92997 | acc=0.7002 | tpr=0.9947 | fpr=0.3051 | 7049.0 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.92869 | acc=0.7004 | tpr=0.9948 | fpr=0.3050 | 12816.2 samples/s | 50.1 steps/s
Avg test loss: 0.92823, Avg test acc: 0.70046, Avg tpr: 0.99485, Avg fpr: 0.30489, total FA: 42333

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=19.5] | Loss=0.08652 | Reg=0.00384 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.592 | L2-Norm(final)=2.721 | 4164.8 samples/s | 65.1 steps/s
[Step=20050 Epoch=19.6] | Loss=0.02611 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.589 | L2-Norm(final)=2.718 | 3426.3 samples/s | 53.5 steps/s
[Step=20100 Epoch=19.6] | Loss=0.02124 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.589 | L2-Norm(final)=2.719 | 3531.9 samples/s | 55.2 steps/s
[Step=20150 Epoch=19.7] | Loss=0.01935 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.721 | 3521.3 samples/s | 55.0 steps/s
[Step=20200 Epoch=19.7] | Loss=0.01751 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.591 | L2-Norm(final)=2.723 | 3510.9 samples/s | 54.9 steps/s
[Step=20250 Epoch=19.8] | Loss=0.01662 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.725 | 3544.8 samples/s | 55.4 steps/s
[Step=20300 Epoch=19.8] | Loss=0.01645 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.593 | L2-Norm(final)=2.728 | 3528.4 samples/s | 55.1 steps/s
[Step=20350 Epoch=19.9] | Loss=0.01614 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.594 | L2-Norm(final)=2.729 | 3513.2 samples/s | 54.9 steps/s
[Step=20400 Epoch=19.9] | Loss=0.01576 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.595 | L2-Norm(final)=2.731 | 3525.2 samples/s | 55.1 steps/s
[Step=20450 Epoch=20.0] | Loss=0.01594 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.596 | L2-Norm(final)=2.732 | 3529.3 samples/s | 55.1 steps/s
[Step=20500 Epoch=20.0] | Loss=0.01574 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.597 | L2-Norm(final)=2.734 | 3543.4 samples/s | 55.4 steps/s
[Step=20550 Epoch=20.1] | Loss=0.01611 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.597 | L2-Norm(final)=2.735 | 3542.0 samples/s | 55.3 steps/s
[Step=20600 Epoch=20.1] | Loss=0.01607 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.598 | L2-Norm(final)=2.735 | 3529.6 samples/s | 55.2 steps/s
[Step=20650 Epoch=20.2] | Loss=0.01610 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.598 | L2-Norm(final)=2.736 | 3534.0 samples/s | 55.2 steps/s
[Step=20700 Epoch=20.2] | Loss=0.01618 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.599 | L2-Norm(final)=2.736 | 3540.5 samples/s | 55.3 steps/s
[Step=20750 Epoch=20.3] | Loss=0.01618 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.599 | L2-Norm(final)=2.737 | 3535.8 samples/s | 55.2 steps/s
[Step=20800 Epoch=20.3] | Loss=0.01591 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.600 | L2-Norm(final)=2.737 | 3522.7 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step20800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=37.7] | Loss=0.40796 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.592 | L2-Norm(final)=2.721 | 3924.6 samples/s | 61.3 steps/s
[Step=20050 Epoch=37.8] | Loss=0.02794 | Reg=0.00384 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.705 | 3363.1 samples/s | 52.5 steps/s
[Step=20100 Epoch=37.9] | Loss=0.01484 | Reg=0.00384 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.702 | 3416.8 samples/s | 53.4 steps/s
[Step=20150 Epoch=38.0] | Loss=0.01002 | Reg=0.00384 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.703 | 3391.8 samples/s | 53.0 steps/s
[Step=20200 Epoch=38.1] | Loss=0.00764 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.704 | 3424.7 samples/s | 53.5 steps/s
[Step=20250 Epoch=38.2] | Loss=0.00616 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.706 | 3439.1 samples/s | 53.7 steps/s
[Step=20300 Epoch=38.3] | Loss=0.00515 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.585 | L2-Norm(final)=2.707 | 3436.0 samples/s | 53.7 steps/s
[Step=20350 Epoch=38.4] | Loss=0.00443 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.584 | L2-Norm(final)=2.708 | 3381.6 samples/s | 52.8 steps/s
[Step=20400 Epoch=38.5] | Loss=0.00389 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.584 | L2-Norm(final)=2.709 | 3383.7 samples/s | 52.9 steps/s
[Step=20450 Epoch=38.5] | Loss=0.00347 | Reg=0.00383 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.583 | L2-Norm(final)=2.710 | 3375.7 samples/s | 52.7 steps/s
[Step=20500 Epoch=38.6] | Loss=0.00313 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.582 | L2-Norm(final)=2.711 | 3412.3 samples/s | 53.3 steps/s
[Step=20550 Epoch=38.7] | Loss=0.00286 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.582 | L2-Norm(final)=2.712 | 1778.4 samples/s | 27.8 steps/s
[Step=20600 Epoch=38.8] | Loss=0.00263 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.582 | L2-Norm(final)=2.713 | 3471.4 samples/s | 54.2 steps/s
[Step=20650 Epoch=38.9] | Loss=0.00243 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.581 | L2-Norm(final)=2.713 | 3456.3 samples/s | 54.0 steps/s
[Step=20700 Epoch=39.0] | Loss=0.00226 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.581 | L2-Norm(final)=2.714 | 3414.7 samples/s | 53.4 steps/s
[Step=20750 Epoch=39.1] | Loss=0.00212 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.580 | L2-Norm(final)=2.715 | 3432.9 samples/s | 53.6 steps/s
[Step=20800 Epoch=39.2] | Loss=0.00199 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.580 | L2-Norm(final)=2.715 | 3437.1 samples/s | 53.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29513 | acc=0.8241 | tpr=0.7484 | fpr=0.0114 | 3793.2 samples/s | 14.8 steps/s
Avg test loss: 0.30425, Avg test acc: 0.82326, Avg tpr: 0.74873, Avg fpr: 0.01282, total FA: 100

Testing server on iccad2012
[Step=  50] | Loss=0.84341 | acc=0.7147 | tpr=1.0000 | fpr=0.2904 | 3861.2 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.84159 | acc=0.7213 | tpr=1.0000 | fpr=0.2839 | 7147.2 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.84908 | acc=0.7195 | tpr=0.9986 | fpr=0.2857 | 6968.0 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.84878 | acc=0.7211 | tpr=0.9978 | fpr=0.2840 | 7231.1 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.85574 | acc=0.7188 | tpr=0.9974 | fpr=0.2863 | 6964.7 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.85474 | acc=0.7195 | tpr=0.9949 | fpr=0.2855 | 7077.1 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.85675 | acc=0.7202 | tpr=0.9944 | fpr=0.2848 | 7213.9 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.85690 | acc=0.7199 | tpr=0.9945 | fpr=0.2851 | 6930.3 samples/s | 27.1 steps/s
[Step= 450] | Loss=0.85906 | acc=0.7198 | tpr=0.9946 | fpr=0.2852 | 6972.0 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.85903 | acc=0.7198 | tpr=0.9943 | fpr=0.2851 | 7017.6 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.85784 | acc=0.7201 | tpr=0.9944 | fpr=0.2848 | 12473.2 samples/s | 48.7 steps/s
Avg test loss: 0.85737, Avg test acc: 0.72021, Avg tpr: 0.99445, Avg fpr: 0.28478, total FA: 39541

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=20.3] | Loss=0.27651 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.590 | L2-Norm(final)=2.735 | 4217.1 samples/s | 65.9 steps/s
[Step=20850 Epoch=20.4] | Loss=0.02346 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.585 | L2-Norm(final)=2.732 | 3359.0 samples/s | 52.5 steps/s
[Step=20900 Epoch=20.4] | Loss=0.01812 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.586 | L2-Norm(final)=2.734 | 3536.8 samples/s | 55.3 steps/s
[Step=20950 Epoch=20.5] | Loss=0.01809 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.736 | 3530.0 samples/s | 55.2 steps/s
[Step=21000 Epoch=20.5] | Loss=0.01755 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.738 | 3513.0 samples/s | 54.9 steps/s
[Step=21050 Epoch=20.6] | Loss=0.01666 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.589 | L2-Norm(final)=2.740 | 3534.0 samples/s | 55.2 steps/s
[Step=21100 Epoch=20.6] | Loss=0.01657 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.589 | L2-Norm(final)=2.741 | 3538.9 samples/s | 55.3 steps/s
[Step=21150 Epoch=20.6] | Loss=0.01626 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.742 | 3546.4 samples/s | 55.4 steps/s
[Step=21200 Epoch=20.7] | Loss=0.01607 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.591 | L2-Norm(final)=2.743 | 3545.4 samples/s | 55.4 steps/s
[Step=21250 Epoch=20.7] | Loss=0.01610 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.591 | L2-Norm(final)=2.744 | 3568.4 samples/s | 55.8 steps/s
[Step=21300 Epoch=20.8] | Loss=0.01622 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.592 | L2-Norm(final)=2.745 | 3628.6 samples/s | 56.7 steps/s
[Step=21350 Epoch=20.8] | Loss=0.01585 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.593 | L2-Norm(final)=2.746 | 3664.8 samples/s | 57.3 steps/s
[Step=21400 Epoch=20.9] | Loss=0.01590 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.594 | L2-Norm(final)=2.747 | 3648.4 samples/s | 57.0 steps/s
[Step=21450 Epoch=20.9] | Loss=0.01552 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.594 | L2-Norm(final)=2.747 | 3638.5 samples/s | 56.9 steps/s
[Step=21500 Epoch=21.0] | Loss=0.01556 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.595 | L2-Norm(final)=2.748 | 3628.9 samples/s | 56.7 steps/s
[Step=21550 Epoch=21.0] | Loss=0.01568 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.595 | L2-Norm(final)=2.749 | 3641.1 samples/s | 56.9 steps/s
[Step=21600 Epoch=21.1] | Loss=0.01553 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.596 | L2-Norm(final)=2.750 | 3651.6 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step21600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=39.2] | Loss=0.34663 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.590 | L2-Norm(final)=2.735 | 4035.6 samples/s | 63.1 steps/s
[Step=20850 Epoch=39.3] | Loss=0.01867 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.724 | 3119.1 samples/s | 48.7 steps/s
[Step=20900 Epoch=39.4] | Loss=0.00964 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.585 | L2-Norm(final)=2.724 | 3354.6 samples/s | 52.4 steps/s
[Step=20950 Epoch=39.5] | Loss=0.00651 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.584 | L2-Norm(final)=2.725 | 3349.8 samples/s | 52.3 steps/s
[Step=21000 Epoch=39.6] | Loss=0.00494 | Reg=0.00383 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.583 | L2-Norm(final)=2.726 | 3277.1 samples/s | 51.2 steps/s
[Step=21050 Epoch=39.7] | Loss=0.00400 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.582 | L2-Norm(final)=2.727 | 3277.6 samples/s | 51.2 steps/s
[Step=21100 Epoch=39.8] | Loss=0.00335 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.581 | L2-Norm(final)=2.728 | 2994.7 samples/s | 46.8 steps/s
[Step=21150 Epoch=39.9] | Loss=0.00289 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.580 | L2-Norm(final)=2.729 | 3238.3 samples/s | 50.6 steps/s
[Step=21200 Epoch=40.0] | Loss=0.00255 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.580 | L2-Norm(final)=2.730 | 3382.7 samples/s | 52.9 steps/s
[Step=21250 Epoch=40.1] | Loss=0.00227 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.579 | L2-Norm(final)=2.731 | 3475.4 samples/s | 54.3 steps/s
[Step=21300 Epoch=40.2] | Loss=0.00206 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.579 | L2-Norm(final)=2.731 | 3477.0 samples/s | 54.3 steps/s
[Step=21350 Epoch=40.2] | Loss=0.00188 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.579 | L2-Norm(final)=2.732 | 1795.6 samples/s | 28.1 steps/s
[Step=21400 Epoch=40.3] | Loss=0.00172 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.578 | L2-Norm(final)=2.732 | 3380.0 samples/s | 52.8 steps/s
[Step=21450 Epoch=40.4] | Loss=0.00160 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.578 | L2-Norm(final)=2.733 | 3372.7 samples/s | 52.7 steps/s
[Step=21500 Epoch=40.5] | Loss=0.00149 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.578 | L2-Norm(final)=2.733 | 3381.7 samples/s | 52.8 steps/s
[Step=21550 Epoch=40.6] | Loss=0.00139 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.577 | L2-Norm(final)=2.734 | 3359.0 samples/s | 52.5 steps/s
[Step=21600 Epoch=40.7] | Loss=0.00131 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.577 | L2-Norm(final)=2.734 | 3352.0 samples/s | 52.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25604 | acc=0.8446 | tpr=0.7801 | fpr=0.0154 | 3875.9 samples/s | 15.1 steps/s
Avg test loss: 0.26516, Avg test acc: 0.84242, Avg tpr: 0.77857, Avg fpr: 0.01718, total FA: 134

Testing server on iccad2012
[Step=  50] | Loss=0.85053 | acc=0.7100 | tpr=1.0000 | fpr=0.2952 | 3832.8 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.84891 | acc=0.7164 | tpr=1.0000 | fpr=0.2888 | 7064.8 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.85687 | acc=0.7163 | tpr=0.9986 | fpr=0.2889 | 7086.8 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.85655 | acc=0.7177 | tpr=0.9978 | fpr=0.2874 | 7010.3 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.86356 | acc=0.7160 | tpr=0.9974 | fpr=0.2891 | 7042.0 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.86265 | acc=0.7165 | tpr=0.9949 | fpr=0.2886 | 7744.4 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.86459 | acc=0.7168 | tpr=0.9944 | fpr=0.2883 | 6484.5 samples/s | 25.3 steps/s
[Step= 400] | Loss=0.86477 | acc=0.7166 | tpr=0.9945 | fpr=0.2884 | 7102.1 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.86685 | acc=0.7165 | tpr=0.9946 | fpr=0.2885 | 6924.7 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.86693 | acc=0.7164 | tpr=0.9943 | fpr=0.2886 | 6868.6 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.86577 | acc=0.7166 | tpr=0.9944 | fpr=0.2885 | 12710.2 samples/s | 49.6 steps/s
Avg test loss: 0.86528, Avg test acc: 0.71661, Avg tpr: 0.99445, Avg fpr: 0.28844, total FA: 40050

server round 27/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=21.1] | Loss=0.14504 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.588 | L2-Norm(final)=2.750 | 3871.4 samples/s | 60.5 steps/s
[Step=21650 Epoch=21.1] | Loss=0.02146 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.583 | L2-Norm(final)=2.748 | 3555.2 samples/s | 55.6 steps/s
[Step=21700 Epoch=21.2] | Loss=0.01732 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.584 | L2-Norm(final)=2.751 | 3628.2 samples/s | 56.7 steps/s
[Step=21750 Epoch=21.2] | Loss=0.01451 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.586 | L2-Norm(final)=2.754 | 3544.0 samples/s | 55.4 steps/s
[Step=21800 Epoch=21.3] | Loss=0.01444 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.757 | 3537.8 samples/s | 55.3 steps/s
[Step=21850 Epoch=21.3] | Loss=0.01396 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.758 | 3539.5 samples/s | 55.3 steps/s
[Step=21900 Epoch=21.4] | Loss=0.01371 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.589 | L2-Norm(final)=2.760 | 3548.7 samples/s | 55.4 steps/s
[Step=21950 Epoch=21.4] | Loss=0.01424 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.589 | L2-Norm(final)=2.761 | 3544.2 samples/s | 55.4 steps/s
[Step=22000 Epoch=21.5] | Loss=0.01434 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.590 | L2-Norm(final)=2.762 | 3533.6 samples/s | 55.2 steps/s
[Step=22050 Epoch=21.5] | Loss=0.01429 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.590 | L2-Norm(final)=2.763 | 3533.9 samples/s | 55.2 steps/s
[Step=22100 Epoch=21.6] | Loss=0.01428 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.591 | L2-Norm(final)=2.763 | 3554.0 samples/s | 55.5 steps/s
[Step=22150 Epoch=21.6] | Loss=0.01457 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.591 | L2-Norm(final)=2.764 | 3554.0 samples/s | 55.5 steps/s
[Step=22200 Epoch=21.7] | Loss=0.01457 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.592 | L2-Norm(final)=2.764 | 3533.1 samples/s | 55.2 steps/s
[Step=22250 Epoch=21.7] | Loss=0.01481 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.593 | L2-Norm(final)=2.765 | 3518.4 samples/s | 55.0 steps/s
[Step=22300 Epoch=21.8] | Loss=0.01484 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.593 | L2-Norm(final)=2.765 | 3530.4 samples/s | 55.2 steps/s
[Step=22350 Epoch=21.8] | Loss=0.01514 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.594 | L2-Norm(final)=2.766 | 3533.9 samples/s | 55.2 steps/s
[Step=22400 Epoch=21.9] | Loss=0.01518 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.594 | L2-Norm(final)=2.766 | 3535.7 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step22400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=40.7] | Loss=0.13688 | Reg=0.00384 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.588 | L2-Norm(final)=2.750 | 3665.6 samples/s | 57.3 steps/s
[Step=21650 Epoch=40.8] | Loss=0.01345 | Reg=0.00384 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.583 | L2-Norm(final)=2.741 | 3342.3 samples/s | 52.2 steps/s
[Step=21700 Epoch=40.9] | Loss=0.00723 | Reg=0.00383 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.582 | L2-Norm(final)=2.741 | 3440.2 samples/s | 53.8 steps/s
[Step=21750 Epoch=41.0] | Loss=0.00489 | Reg=0.00383 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.581 | L2-Norm(final)=2.742 | 3375.9 samples/s | 52.7 steps/s
[Step=21800 Epoch=41.1] | Loss=0.00370 | Reg=0.00383 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.580 | L2-Norm(final)=2.743 | 3349.3 samples/s | 52.3 steps/s
[Step=21850 Epoch=41.2] | Loss=0.00298 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.579 | L2-Norm(final)=2.743 | 3343.5 samples/s | 52.2 steps/s
[Step=21900 Epoch=41.3] | Loss=0.00250 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.579 | L2-Norm(final)=2.744 | 3348.6 samples/s | 52.3 steps/s
[Step=21950 Epoch=41.4] | Loss=0.00215 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.578 | L2-Norm(final)=2.745 | 3361.3 samples/s | 52.5 steps/s
[Step=22000 Epoch=41.5] | Loss=0.00190 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.577 | L2-Norm(final)=2.746 | 3365.4 samples/s | 52.6 steps/s
[Step=22050 Epoch=41.6] | Loss=0.00170 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.577 | L2-Norm(final)=2.746 | 3367.3 samples/s | 52.6 steps/s
[Step=22100 Epoch=41.7] | Loss=0.00154 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.576 | L2-Norm(final)=2.747 | 3385.5 samples/s | 52.9 steps/s
[Step=22150 Epoch=41.8] | Loss=0.00140 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.576 | L2-Norm(final)=2.747 | 1780.2 samples/s | 27.8 steps/s
[Step=22200 Epoch=41.8] | Loss=0.00129 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.576 | L2-Norm(final)=2.748 | 3465.7 samples/s | 54.2 steps/s
[Step=22250 Epoch=41.9] | Loss=0.00120 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.576 | L2-Norm(final)=2.748 | 3448.4 samples/s | 53.9 steps/s
[Step=22300 Epoch=42.0] | Loss=0.00111 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.575 | L2-Norm(final)=2.749 | 3456.3 samples/s | 54.0 steps/s
[Step=22350 Epoch=42.1] | Loss=0.00105 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.575 | L2-Norm(final)=2.749 | 3368.2 samples/s | 52.6 steps/s
[Step=22400 Epoch=42.2] | Loss=0.00098 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.575 | L2-Norm(final)=2.749 | 3409.1 samples/s | 53.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18977 | acc=0.8830 | tpr=0.8365 | fpr=0.0159 | 3843.9 samples/s | 15.0 steps/s
Avg test loss: 0.19757, Avg test acc: 0.88052, Avg tpr: 0.83430, Avg fpr: 0.01782, total FA: 139

Testing server on iccad2012
[Step=  50] | Loss=1.06772 | acc=0.6528 | tpr=1.0000 | fpr=0.3534 | 3847.4 samples/s | 15.0 steps/s
[Step= 100] | Loss=1.06220 | acc=0.6609 | tpr=1.0000 | fpr=0.3454 | 7130.1 samples/s | 27.9 steps/s
[Step= 150] | Loss=1.06934 | acc=0.6612 | tpr=1.0000 | fpr=0.3450 | 7097.7 samples/s | 27.7 steps/s
[Step= 200] | Loss=1.06829 | acc=0.6621 | tpr=0.9989 | fpr=0.3440 | 7204.4 samples/s | 28.1 steps/s
[Step= 250] | Loss=1.07650 | acc=0.6605 | tpr=0.9983 | fpr=0.3456 | 7050.2 samples/s | 27.5 steps/s
[Step= 300] | Loss=1.07451 | acc=0.6615 | tpr=0.9956 | fpr=0.3446 | 7004.2 samples/s | 27.4 steps/s
[Step= 350] | Loss=1.07618 | acc=0.6613 | tpr=0.9950 | fpr=0.3448 | 7139.9 samples/s | 27.9 steps/s
[Step= 400] | Loss=1.07600 | acc=0.6611 | tpr=0.9951 | fpr=0.3450 | 7096.8 samples/s | 27.7 steps/s
[Step= 450] | Loss=1.07779 | acc=0.6613 | tpr=0.9951 | fpr=0.3448 | 6744.7 samples/s | 26.3 steps/s
[Step= 500] | Loss=1.07833 | acc=0.6610 | tpr=0.9947 | fpr=0.3450 | 7124.5 samples/s | 27.8 steps/s
[Step= 550] | Loss=1.07705 | acc=0.6612 | tpr=0.9948 | fpr=0.3449 | 13212.9 samples/s | 51.6 steps/s
Avg test loss: 1.07651, Avg test acc: 0.66121, Avg tpr: 0.99485, Avg fpr: 0.34485, total FA: 47882

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=21.9] | Loss=0.07244 | Reg=0.00384 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.585 | L2-Norm(final)=2.763 | 4227.1 samples/s | 66.0 steps/s
[Step=22450 Epoch=21.9] | Loss=0.01461 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.580 | L2-Norm(final)=2.764 | 3319.8 samples/s | 51.9 steps/s
[Step=22500 Epoch=22.0] | Loss=0.01326 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.581 | L2-Norm(final)=2.766 | 3601.0 samples/s | 56.3 steps/s
[Step=22550 Epoch=22.0] | Loss=0.01332 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.582 | L2-Norm(final)=2.768 | 3635.9 samples/s | 56.8 steps/s
[Step=22600 Epoch=22.1] | Loss=0.01390 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.583 | L2-Norm(final)=2.770 | 3565.1 samples/s | 55.7 steps/s
[Step=22650 Epoch=22.1] | Loss=0.01345 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.584 | L2-Norm(final)=2.772 | 3553.5 samples/s | 55.5 steps/s
[Step=22700 Epoch=22.2] | Loss=0.01301 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.585 | L2-Norm(final)=2.774 | 3551.9 samples/s | 55.5 steps/s
[Step=22750 Epoch=22.2] | Loss=0.01386 | Reg=0.00384 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.585 | L2-Norm(final)=2.775 | 3590.3 samples/s | 56.1 steps/s
[Step=22800 Epoch=22.3] | Loss=0.01418 | Reg=0.00384 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.586 | L2-Norm(final)=2.775 | 3603.0 samples/s | 56.3 steps/s
[Step=22850 Epoch=22.3] | Loss=0.01465 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.586 | L2-Norm(final)=2.776 | 3529.7 samples/s | 55.2 steps/s
[Step=22900 Epoch=22.4] | Loss=0.01447 | Reg=0.00384 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.776 | 3601.5 samples/s | 56.3 steps/s
[Step=22950 Epoch=22.4] | Loss=0.01425 | Reg=0.00384 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.776 | 3638.0 samples/s | 56.8 steps/s
[Step=23000 Epoch=22.5] | Loss=0.01439 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.588 | L2-Norm(final)=2.777 | 3622.9 samples/s | 56.6 steps/s
[Step=23050 Epoch=22.5] | Loss=0.01436 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.588 | L2-Norm(final)=2.777 | 3633.8 samples/s | 56.8 steps/s
[Step=23100 Epoch=22.6] | Loss=0.01432 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.589 | L2-Norm(final)=2.778 | 3530.8 samples/s | 55.2 steps/s
[Step=23150 Epoch=22.6] | Loss=0.01439 | Reg=0.00384 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.589 | L2-Norm(final)=2.778 | 3536.2 samples/s | 55.3 steps/s
[Step=23200 Epoch=22.7] | Loss=0.01475 | Reg=0.00384 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.778 | 3543.5 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step23200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=42.2] | Loss=0.43660 | Reg=0.00384 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.585 | L2-Norm(final)=2.762 | 4123.5 samples/s | 64.4 steps/s
[Step=22450 Epoch=42.3] | Loss=0.02329 | Reg=0.00384 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.583 | L2-Norm(final)=2.747 | 3113.0 samples/s | 48.6 steps/s
[Step=22500 Epoch=42.4] | Loss=0.01201 | Reg=0.00383 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.582 | L2-Norm(final)=2.747 | 3343.1 samples/s | 52.2 steps/s
[Step=22550 Epoch=42.5] | Loss=0.00815 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.580 | L2-Norm(final)=2.748 | 3363.5 samples/s | 52.6 steps/s
[Step=22600 Epoch=42.6] | Loss=0.00618 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.579 | L2-Norm(final)=2.750 | 3352.8 samples/s | 52.4 steps/s
[Step=22650 Epoch=42.7] | Loss=0.00500 | Reg=0.00383 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.578 | L2-Norm(final)=2.751 | 3371.2 samples/s | 52.7 steps/s
[Step=22700 Epoch=42.8] | Loss=0.00419 | Reg=0.00383 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.577 | L2-Norm(final)=2.752 | 3370.5 samples/s | 52.7 steps/s
[Step=22750 Epoch=42.9] | Loss=0.00362 | Reg=0.00383 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.576 | L2-Norm(final)=2.753 | 3375.9 samples/s | 52.7 steps/s
[Step=22800 Epoch=43.0] | Loss=0.00318 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.576 | L2-Norm(final)=2.754 | 3372.1 samples/s | 52.7 steps/s
[Step=22850 Epoch=43.1] | Loss=0.00283 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.575 | L2-Norm(final)=2.755 | 3352.3 samples/s | 52.4 steps/s
[Step=22900 Epoch=43.2] | Loss=0.00256 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.575 | L2-Norm(final)=2.756 | 3382.4 samples/s | 52.8 steps/s
[Step=22950 Epoch=43.3] | Loss=0.00233 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.575 | L2-Norm(final)=2.757 | 1762.3 samples/s | 27.5 steps/s
[Step=23000 Epoch=43.4] | Loss=0.00214 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.574 | L2-Norm(final)=2.757 | 3398.9 samples/s | 53.1 steps/s
[Step=23050 Epoch=43.4] | Loss=0.00198 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.574 | L2-Norm(final)=2.758 | 3309.3 samples/s | 51.7 steps/s
[Step=23100 Epoch=43.5] | Loss=0.00185 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.574 | L2-Norm(final)=2.758 | 3350.7 samples/s | 52.4 steps/s
[Step=23150 Epoch=43.6] | Loss=0.00173 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.573 | L2-Norm(final)=2.759 | 3343.3 samples/s | 52.2 steps/s
[Step=23200 Epoch=43.7] | Loss=0.00162 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.573 | L2-Norm(final)=2.759 | 3357.1 samples/s | 52.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25373 | acc=0.8491 | tpr=0.7867 | fpr=0.0156 | 3876.4 samples/s | 15.1 steps/s
Avg test loss: 0.26245, Avg test acc: 0.84823, Avg tpr: 0.78720, Avg fpr: 0.01756, total FA: 137

Testing server on iccad2012
[Step=  50] | Loss=0.88116 | acc=0.7063 | tpr=0.9956 | fpr=0.2990 | 3874.9 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.87947 | acc=0.7140 | tpr=0.9979 | fpr=0.2913 | 7062.6 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.88643 | acc=0.7134 | tpr=0.9971 | fpr=0.2919 | 6955.5 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.88562 | acc=0.7143 | tpr=0.9967 | fpr=0.2909 | 7363.5 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.89317 | acc=0.7120 | tpr=0.9965 | fpr=0.2932 | 6955.2 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.89176 | acc=0.7129 | tpr=0.9942 | fpr=0.2923 | 7201.8 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.89368 | acc=0.7130 | tpr=0.9937 | fpr=0.2921 | 7167.5 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.89379 | acc=0.7127 | tpr=0.9940 | fpr=0.2924 | 6880.6 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.89558 | acc=0.7125 | tpr=0.9942 | fpr=0.2926 | 7108.7 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.89577 | acc=0.7124 | tpr=0.9938 | fpr=0.2927 | 6856.7 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.89468 | acc=0.7126 | tpr=0.9940 | fpr=0.2926 | 12778.2 samples/s | 49.9 steps/s
Avg test loss: 0.89427, Avg test acc: 0.71260, Avg tpr: 0.99406, Avg fpr: 0.29252, total FA: 40616

server round 29/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=22.7] | Loss=0.18520 | Reg=0.00383 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.580 | L2-Norm(final)=2.772 | 4114.3 samples/s | 64.3 steps/s
[Step=23250 Epoch=22.7] | Loss=0.02299 | Reg=0.00383 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.576 | L2-Norm(final)=2.769 | 3325.2 samples/s | 52.0 steps/s
[Step=23300 Epoch=22.7] | Loss=0.01818 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.576 | L2-Norm(final)=2.770 | 3544.4 samples/s | 55.4 steps/s
[Step=23350 Epoch=22.8] | Loss=0.01670 | Reg=0.00383 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.577 | L2-Norm(final)=2.772 | 3600.2 samples/s | 56.3 steps/s
[Step=23400 Epoch=22.8] | Loss=0.01589 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.578 | L2-Norm(final)=2.773 | 3617.0 samples/s | 56.5 steps/s
[Step=23450 Epoch=22.9] | Loss=0.01509 | Reg=0.00383 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.579 | L2-Norm(final)=2.775 | 3617.2 samples/s | 56.5 steps/s
[Step=23500 Epoch=22.9] | Loss=0.01464 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.580 | L2-Norm(final)=2.777 | 3622.8 samples/s | 56.6 steps/s
[Step=23550 Epoch=23.0] | Loss=0.01444 | Reg=0.00383 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.581 | L2-Norm(final)=2.779 | 3546.7 samples/s | 55.4 steps/s
[Step=23600 Epoch=23.0] | Loss=0.01517 | Reg=0.00383 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.581 | L2-Norm(final)=2.780 | 3527.4 samples/s | 55.1 steps/s
[Step=23650 Epoch=23.1] | Loss=0.01522 | Reg=0.00383 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.582 | L2-Norm(final)=2.780 | 3530.7 samples/s | 55.2 steps/s
[Step=23700 Epoch=23.1] | Loss=0.01497 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.583 | L2-Norm(final)=2.781 | 3537.1 samples/s | 55.3 steps/s
[Step=23750 Epoch=23.2] | Loss=0.01522 | Reg=0.00383 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.583 | L2-Norm(final)=2.782 | 3591.7 samples/s | 56.1 steps/s
[Step=23800 Epoch=23.2] | Loss=0.01514 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.584 | L2-Norm(final)=2.782 | 3633.1 samples/s | 56.8 steps/s
[Step=23850 Epoch=23.3] | Loss=0.01500 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.584 | L2-Norm(final)=2.783 | 3594.6 samples/s | 56.2 steps/s
[Step=23900 Epoch=23.3] | Loss=0.01496 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.585 | L2-Norm(final)=2.783 | 3540.9 samples/s | 55.3 steps/s
[Step=23950 Epoch=23.4] | Loss=0.01485 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.585 | L2-Norm(final)=2.784 | 3530.8 samples/s | 55.2 steps/s
[Step=24000 Epoch=23.4] | Loss=0.01494 | Reg=0.00384 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.585 | L2-Norm(final)=2.784 | 3520.4 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step24000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=43.7] | Loss=0.16964 | Reg=0.00383 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.580 | L2-Norm(final)=2.772 | 3663.4 samples/s | 57.2 steps/s
[Step=23250 Epoch=43.8] | Loss=0.00711 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.575 | L2-Norm(final)=2.769 | 3340.2 samples/s | 52.2 steps/s
[Step=23300 Epoch=43.9] | Loss=0.00520 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.574 | L2-Norm(final)=2.769 | 3372.4 samples/s | 52.7 steps/s
[Step=23350 Epoch=44.0] | Loss=0.00350 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.573 | L2-Norm(final)=2.770 | 3440.6 samples/s | 53.8 steps/s
[Step=23400 Epoch=44.1] | Loss=0.00267 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.572 | L2-Norm(final)=2.770 | 3443.6 samples/s | 53.8 steps/s
[Step=23450 Epoch=44.2] | Loss=0.00215 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.572 | L2-Norm(final)=2.771 | 3448.1 samples/s | 53.9 steps/s
[Step=23500 Epoch=44.3] | Loss=0.00181 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.571 | L2-Norm(final)=2.771 | 3438.3 samples/s | 53.7 steps/s
[Step=23550 Epoch=44.4] | Loss=0.00156 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.570 | L2-Norm(final)=2.772 | 3379.6 samples/s | 52.8 steps/s
[Step=23600 Epoch=44.5] | Loss=0.00138 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.570 | L2-Norm(final)=2.772 | 3350.6 samples/s | 52.4 steps/s
[Step=23650 Epoch=44.6] | Loss=0.00123 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.569 | L2-Norm(final)=2.772 | 3370.7 samples/s | 52.7 steps/s
[Step=23700 Epoch=44.7] | Loss=0.00111 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.569 | L2-Norm(final)=2.773 | 3397.8 samples/s | 53.1 steps/s
[Step=23750 Epoch=44.8] | Loss=0.00102 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.569 | L2-Norm(final)=2.773 | 1769.4 samples/s | 27.6 steps/s
[Step=23800 Epoch=44.9] | Loss=0.00094 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.568 | L2-Norm(final)=2.773 | 3403.2 samples/s | 53.2 steps/s
[Step=23850 Epoch=45.0] | Loss=0.00087 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.568 | L2-Norm(final)=2.774 | 3446.1 samples/s | 53.8 steps/s
[Step=23900 Epoch=45.1] | Loss=0.00081 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.568 | L2-Norm(final)=2.774 | 3440.8 samples/s | 53.8 steps/s
[Step=23950 Epoch=45.1] | Loss=0.00076 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.568 | L2-Norm(final)=2.774 | 3449.1 samples/s | 53.9 steps/s
[Step=24000 Epoch=45.2] | Loss=0.00072 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.567 | L2-Norm(final)=2.774 | 3433.1 samples/s | 53.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22654 | acc=0.8633 | tpr=0.8085 | fpr=0.0178 | 3898.3 samples/s | 15.2 steps/s
Avg test loss: 0.23420, Avg test acc: 0.86285, Avg tpr: 0.80894, Avg fpr: 0.01859, total FA: 145

Testing server on iccad2012
[Step=  50] | Loss=0.99815 | acc=0.6836 | tpr=1.0000 | fpr=0.3221 | 3828.6 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.99256 | acc=0.6918 | tpr=1.0000 | fpr=0.3140 | 7070.2 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.99993 | acc=0.6911 | tpr=0.9986 | fpr=0.3145 | 7145.3 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.99882 | acc=0.6921 | tpr=0.9978 | fpr=0.3134 | 6921.2 samples/s | 27.0 steps/s
[Step= 250] | Loss=1.00759 | acc=0.6900 | tpr=0.9974 | fpr=0.3156 | 7036.5 samples/s | 27.5 steps/s
[Step= 300] | Loss=1.00610 | acc=0.6909 | tpr=0.9949 | fpr=0.3147 | 7002.8 samples/s | 27.4 steps/s
[Step= 350] | Loss=1.00814 | acc=0.6910 | tpr=0.9944 | fpr=0.3145 | 7125.4 samples/s | 27.8 steps/s
[Step= 400] | Loss=1.00841 | acc=0.6908 | tpr=0.9945 | fpr=0.3147 | 6985.0 samples/s | 27.3 steps/s
[Step= 450] | Loss=1.01023 | acc=0.6906 | tpr=0.9946 | fpr=0.3149 | 6967.6 samples/s | 27.2 steps/s
[Step= 500] | Loss=1.01023 | acc=0.6905 | tpr=0.9943 | fpr=0.3150 | 7156.8 samples/s | 28.0 steps/s
[Step= 550] | Loss=1.00929 | acc=0.6908 | tpr=0.9944 | fpr=0.3147 | 12953.1 samples/s | 50.6 steps/s
Avg test loss: 1.00882, Avg test acc: 0.69080, Avg tpr: 0.99445, Avg fpr: 0.31472, total FA: 43698

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=23.4] | Loss=0.14243 | Reg=0.00383 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.576 | L2-Norm(final)=2.784 | 3958.8 samples/s | 61.9 steps/s
[Step=24050 Epoch=23.5] | Loss=0.01697 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.570 | L2-Norm(final)=2.783 | 3413.9 samples/s | 53.3 steps/s
[Step=24100 Epoch=23.5] | Loss=0.01259 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.571 | L2-Norm(final)=2.785 | 3530.4 samples/s | 55.2 steps/s
[Step=24150 Epoch=23.6] | Loss=0.01136 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.571 | L2-Norm(final)=2.786 | 3533.0 samples/s | 55.2 steps/s
[Step=24200 Epoch=23.6] | Loss=0.01103 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.571 | L2-Norm(final)=2.788 | 3531.6 samples/s | 55.2 steps/s
[Step=24250 Epoch=23.7] | Loss=0.01088 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.572 | L2-Norm(final)=2.789 | 3533.8 samples/s | 55.2 steps/s
[Step=24300 Epoch=23.7] | Loss=0.01087 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.572 | L2-Norm(final)=2.791 | 3553.7 samples/s | 55.5 steps/s
[Step=24350 Epoch=23.8] | Loss=0.01044 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.573 | L2-Norm(final)=2.792 | 3536.3 samples/s | 55.3 steps/s
[Step=24400 Epoch=23.8] | Loss=0.01022 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.573 | L2-Norm(final)=2.793 | 3560.0 samples/s | 55.6 steps/s
[Step=24450 Epoch=23.9] | Loss=0.01045 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.574 | L2-Norm(final)=2.794 | 3531.9 samples/s | 55.2 steps/s
[Step=24500 Epoch=23.9] | Loss=0.01047 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.574 | L2-Norm(final)=2.795 | 3525.0 samples/s | 55.1 steps/s
[Step=24550 Epoch=24.0] | Loss=0.01051 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.574 | L2-Norm(final)=2.796 | 3533.3 samples/s | 55.2 steps/s
[Step=24600 Epoch=24.0] | Loss=0.01038 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.575 | L2-Norm(final)=2.797 | 3534.4 samples/s | 55.2 steps/s
[Step=24650 Epoch=24.1] | Loss=0.01032 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.575 | L2-Norm(final)=2.798 | 3545.2 samples/s | 55.4 steps/s
[Step=24700 Epoch=24.1] | Loss=0.01045 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.576 | L2-Norm(final)=2.799 | 3539.3 samples/s | 55.3 steps/s
[Step=24750 Epoch=24.2] | Loss=0.01049 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.576 | L2-Norm(final)=2.800 | 3553.3 samples/s | 55.5 steps/s
[Step=24800 Epoch=24.2] | Loss=0.01044 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.576 | L2-Norm(final)=2.800 | 3487.4 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step24800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=45.2] | Loss=0.36640 | Reg=0.00383 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.576 | L2-Norm(final)=2.784 | 3895.1 samples/s | 60.9 steps/s
[Step=24050 Epoch=45.3] | Loss=0.02168 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.572 | L2-Norm(final)=2.779 | 3268.1 samples/s | 51.1 steps/s
[Step=24100 Epoch=45.4] | Loss=0.01099 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.571 | L2-Norm(final)=2.778 | 3448.8 samples/s | 53.9 steps/s
[Step=24150 Epoch=45.5] | Loss=0.00743 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.570 | L2-Norm(final)=2.778 | 3442.9 samples/s | 53.8 steps/s
[Step=24200 Epoch=45.6] | Loss=0.00560 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.569 | L2-Norm(final)=2.778 | 3372.2 samples/s | 52.7 steps/s
[Step=24250 Epoch=45.7] | Loss=0.00453 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.568 | L2-Norm(final)=2.779 | 3356.7 samples/s | 52.4 steps/s
[Step=24300 Epoch=45.8] | Loss=0.00381 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.567 | L2-Norm(final)=2.779 | 3368.8 samples/s | 52.6 steps/s
[Step=24350 Epoch=45.9] | Loss=0.00328 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.567 | L2-Norm(final)=2.779 | 3371.3 samples/s | 52.7 steps/s
[Step=24400 Epoch=46.0] | Loss=0.00288 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.566 | L2-Norm(final)=2.780 | 3353.3 samples/s | 52.4 steps/s
[Step=24450 Epoch=46.1] | Loss=0.00257 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.566 | L2-Norm(final)=2.780 | 3358.4 samples/s | 52.5 steps/s
[Step=24500 Epoch=46.2] | Loss=0.00232 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.565 | L2-Norm(final)=2.780 | 3399.9 samples/s | 53.1 steps/s
[Step=24550 Epoch=46.3] | Loss=0.00211 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.565 | L2-Norm(final)=2.781 | 1821.1 samples/s | 28.5 steps/s
[Step=24600 Epoch=46.4] | Loss=0.00195 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.565 | L2-Norm(final)=2.781 | 3461.8 samples/s | 54.1 steps/s
[Step=24650 Epoch=46.5] | Loss=0.00180 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.565 | L2-Norm(final)=2.781 | 3429.1 samples/s | 53.6 steps/s
[Step=24700 Epoch=46.6] | Loss=0.00168 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.564 | L2-Norm(final)=2.781 | 3414.0 samples/s | 53.3 steps/s
[Step=24750 Epoch=46.7] | Loss=0.00157 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.564 | L2-Norm(final)=2.782 | 3431.3 samples/s | 53.6 steps/s
[Step=24800 Epoch=46.7] | Loss=0.00147 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.564 | L2-Norm(final)=2.782 | 3438.0 samples/s | 53.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23026 | acc=0.8630 | tpr=0.8085 | fpr=0.0186 | 3902.2 samples/s | 15.2 steps/s
Avg test loss: 0.23857, Avg test acc: 0.86161, Avg tpr: 0.80743, Avg fpr: 0.01923, total FA: 150

Testing server on iccad2012
[Step=  50] | Loss=0.91546 | acc=0.7080 | tpr=1.0000 | fpr=0.2973 | 3827.9 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.91397 | acc=0.7155 | tpr=1.0000 | fpr=0.2898 | 7079.5 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.92208 | acc=0.7138 | tpr=0.9986 | fpr=0.2915 | 6955.7 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.92182 | acc=0.7151 | tpr=0.9978 | fpr=0.2901 | 7371.1 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.92960 | acc=0.7131 | tpr=0.9974 | fpr=0.2920 | 7144.6 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.92835 | acc=0.7142 | tpr=0.9949 | fpr=0.2909 | 7098.5 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.93101 | acc=0.7144 | tpr=0.9944 | fpr=0.2907 | 7147.0 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.93100 | acc=0.7141 | tpr=0.9945 | fpr=0.2910 | 7063.3 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.93295 | acc=0.7140 | tpr=0.9946 | fpr=0.2911 | 6921.9 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.93272 | acc=0.7139 | tpr=0.9943 | fpr=0.2912 | 6901.7 samples/s | 27.0 steps/s
[Step= 550] | Loss=0.93174 | acc=0.7140 | tpr=0.9944 | fpr=0.2911 | 13199.5 samples/s | 51.6 steps/s
Avg test loss: 0.93126, Avg test acc: 0.71399, Avg tpr: 0.99445, Avg fpr: 0.29111, total FA: 40420

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=24.2] | Loss=0.09818 | Reg=0.00383 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.571 | L2-Norm(final)=2.800 | 3757.8 samples/s | 58.7 steps/s
[Step=24850 Epoch=24.3] | Loss=0.01876 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.565 | L2-Norm(final)=2.799 | 3561.0 samples/s | 55.6 steps/s
[Step=24900 Epoch=24.3] | Loss=0.01441 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.565 | L2-Norm(final)=2.800 | 3507.8 samples/s | 54.8 steps/s
[Step=24950 Epoch=24.4] | Loss=0.01290 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.565 | L2-Norm(final)=2.801 | 3521.6 samples/s | 55.0 steps/s
[Step=25000 Epoch=24.4] | Loss=0.01252 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.565 | L2-Norm(final)=2.803 | 3515.8 samples/s | 54.9 steps/s
[Step=25050 Epoch=24.5] | Loss=0.01155 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.566 | L2-Norm(final)=2.804 | 3531.9 samples/s | 55.2 steps/s
[Step=25100 Epoch=24.5] | Loss=0.01106 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.566 | L2-Norm(final)=2.805 | 3542.3 samples/s | 55.3 steps/s
[Step=25150 Epoch=24.6] | Loss=0.01096 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.567 | L2-Norm(final)=2.807 | 3538.5 samples/s | 55.3 steps/s
[Step=25200 Epoch=24.6] | Loss=0.01118 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.567 | L2-Norm(final)=2.808 | 3533.0 samples/s | 55.2 steps/s
[Step=25250 Epoch=24.7] | Loss=0.01106 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.567 | L2-Norm(final)=2.809 | 3522.4 samples/s | 55.0 steps/s
[Step=25300 Epoch=24.7] | Loss=0.01107 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.568 | L2-Norm(final)=2.810 | 3531.6 samples/s | 55.2 steps/s
[Step=25350 Epoch=24.8] | Loss=0.01104 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.568 | L2-Norm(final)=2.811 | 3533.0 samples/s | 55.2 steps/s
[Step=25400 Epoch=24.8] | Loss=0.01099 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.568 | L2-Norm(final)=2.811 | 3526.2 samples/s | 55.1 steps/s
[Step=25450 Epoch=24.8] | Loss=0.01111 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.569 | L2-Norm(final)=2.812 | 3524.5 samples/s | 55.1 steps/s
[Step=25500 Epoch=24.9] | Loss=0.01117 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.569 | L2-Norm(final)=2.813 | 3539.8 samples/s | 55.3 steps/s
[Step=25550 Epoch=24.9] | Loss=0.01114 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.569 | L2-Norm(final)=2.813 | 3542.9 samples/s | 55.4 steps/s
[Step=25600 Epoch=25.0] | Loss=0.01099 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.570 | L2-Norm(final)=2.814 | 3541.5 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step25600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=46.8] | Loss=0.22314 | Reg=0.00383 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.571 | L2-Norm(final)=2.799 | 4219.5 samples/s | 65.9 steps/s
[Step=24850 Epoch=46.8] | Loss=0.01720 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.564 | L2-Norm(final)=2.794 | 3125.3 samples/s | 48.8 steps/s
[Step=24900 Epoch=46.9] | Loss=0.00886 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.563 | L2-Norm(final)=2.794 | 3419.9 samples/s | 53.4 steps/s
[Step=24950 Epoch=47.0] | Loss=0.00595 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.561 | L2-Norm(final)=2.794 | 3435.9 samples/s | 53.7 steps/s
[Step=25000 Epoch=47.1] | Loss=0.00450 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.561 | L2-Norm(final)=2.795 | 3357.9 samples/s | 52.5 steps/s
[Step=25050 Epoch=47.2] | Loss=0.00361 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.560 | L2-Norm(final)=2.795 | 3346.0 samples/s | 52.3 steps/s
[Step=25100 Epoch=47.3] | Loss=0.00303 | Reg=0.00383 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.559 | L2-Norm(final)=2.795 | 3448.0 samples/s | 53.9 steps/s
[Step=25150 Epoch=47.4] | Loss=0.00260 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.559 | L2-Norm(final)=2.796 | 3440.6 samples/s | 53.8 steps/s
[Step=25200 Epoch=47.5] | Loss=0.00229 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.559 | L2-Norm(final)=2.796 | 3366.6 samples/s | 52.6 steps/s
[Step=25250 Epoch=47.6] | Loss=0.00204 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.558 | L2-Norm(final)=2.796 | 3358.7 samples/s | 52.5 steps/s
[Step=25300 Epoch=47.7] | Loss=0.00185 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.558 | L2-Norm(final)=2.796 | 3427.7 samples/s | 53.6 steps/s
[Step=25350 Epoch=47.8] | Loss=0.00168 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.558 | L2-Norm(final)=2.797 | 1798.2 samples/s | 28.1 steps/s
[Step=25400 Epoch=47.9] | Loss=0.00155 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.557 | L2-Norm(final)=2.797 | 3476.7 samples/s | 54.3 steps/s
[Step=25450 Epoch=48.0] | Loss=0.00143 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.557 | L2-Norm(final)=2.797 | 3422.4 samples/s | 53.5 steps/s
[Step=25500 Epoch=48.1] | Loss=0.00134 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.557 | L2-Norm(final)=2.797 | 3370.0 samples/s | 52.7 steps/s
[Step=25550 Epoch=48.2] | Loss=0.00125 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.557 | L2-Norm(final)=2.797 | 3359.5 samples/s | 52.5 steps/s
[Step=25600 Epoch=48.3] | Loss=0.00118 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.557 | L2-Norm(final)=2.798 | 3365.0 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24234 | acc=0.8577 | tpr=0.7995 | fpr=0.0159 | 3857.9 samples/s | 15.1 steps/s
Avg test loss: 0.25065, Avg test acc: 0.85608, Avg tpr: 0.79822, Avg fpr: 0.01666, total FA: 130

Testing server on iccad2012
[Step=  50] | Loss=0.88180 | acc=0.7178 | tpr=1.0000 | fpr=0.2873 | 3888.4 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.88191 | acc=0.7245 | tpr=1.0000 | fpr=0.2806 | 6985.8 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.89042 | acc=0.7234 | tpr=0.9986 | fpr=0.2816 | 7187.1 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.89081 | acc=0.7247 | tpr=0.9978 | fpr=0.2803 | 7038.9 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.89829 | acc=0.7223 | tpr=0.9974 | fpr=0.2827 | 7052.6 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.89690 | acc=0.7231 | tpr=0.9949 | fpr=0.2819 | 6975.1 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.89957 | acc=0.7233 | tpr=0.9944 | fpr=0.2816 | 7107.1 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.89945 | acc=0.7232 | tpr=0.9945 | fpr=0.2818 | 7052.8 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.90134 | acc=0.7231 | tpr=0.9946 | fpr=0.2819 | 7048.1 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.90105 | acc=0.7230 | tpr=0.9943 | fpr=0.2819 | 7023.2 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.90003 | acc=0.7232 | tpr=0.9940 | fpr=0.2817 | 12728.0 samples/s | 49.7 steps/s
Avg test loss: 0.89954, Avg test acc: 0.72327, Avg tpr: 0.99406, Avg fpr: 0.28165, total FA: 39107

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=25.0] | Loss=0.05694 | Reg=0.00383 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.563 | L2-Norm(final)=2.813 | 4072.5 samples/s | 63.6 steps/s
[Step=25650 Epoch=25.0] | Loss=0.01733 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.557 | L2-Norm(final)=2.812 | 3612.8 samples/s | 56.5 steps/s
[Step=25700 Epoch=25.1] | Loss=0.01358 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.557 | L2-Norm(final)=2.814 | 3602.2 samples/s | 56.3 steps/s
[Step=25750 Epoch=25.1] | Loss=0.01218 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.558 | L2-Norm(final)=2.815 | 3648.2 samples/s | 57.0 steps/s
[Step=25800 Epoch=25.2] | Loss=0.01179 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.558 | L2-Norm(final)=2.816 | 3628.8 samples/s | 56.7 steps/s
[Step=25850 Epoch=25.2] | Loss=0.01124 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.558 | L2-Norm(final)=2.818 | 3629.4 samples/s | 56.7 steps/s
[Step=25900 Epoch=25.3] | Loss=0.01097 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.559 | L2-Norm(final)=2.819 | 3644.6 samples/s | 56.9 steps/s
[Step=25950 Epoch=25.3] | Loss=0.01083 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.559 | L2-Norm(final)=2.820 | 3660.4 samples/s | 57.2 steps/s
[Step=26000 Epoch=25.4] | Loss=0.01082 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.560 | L2-Norm(final)=2.821 | 3649.4 samples/s | 57.0 steps/s
[Step=26050 Epoch=25.4] | Loss=0.01074 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.560 | L2-Norm(final)=2.822 | 3653.3 samples/s | 57.1 steps/s
[Step=26100 Epoch=25.5] | Loss=0.01067 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.561 | L2-Norm(final)=2.823 | 3649.0 samples/s | 57.0 steps/s
[Step=26150 Epoch=25.5] | Loss=0.01093 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.561 | L2-Norm(final)=2.824 | 3611.1 samples/s | 56.4 steps/s
[Step=26200 Epoch=25.6] | Loss=0.01090 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.561 | L2-Norm(final)=2.825 | 3617.2 samples/s | 56.5 steps/s
[Step=26250 Epoch=25.6] | Loss=0.01098 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.562 | L2-Norm(final)=2.826 | 3616.9 samples/s | 56.5 steps/s
[Step=26300 Epoch=25.7] | Loss=0.01085 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.562 | L2-Norm(final)=2.826 | 3620.6 samples/s | 56.6 steps/s
[Step=26350 Epoch=25.7] | Loss=0.01091 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.562 | L2-Norm(final)=2.827 | 3602.0 samples/s | 56.3 steps/s
[Step=26400 Epoch=25.8] | Loss=0.01090 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.563 | L2-Norm(final)=2.827 | 3549.0 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step26400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=48.3] | Loss=0.07549 | Reg=0.00383 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=19.563 | L2-Norm(final)=2.813 | 4193.7 samples/s | 65.5 steps/s
[Step=25650 Epoch=48.4] | Loss=0.01450 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.557 | L2-Norm(final)=2.809 | 3105.3 samples/s | 48.5 steps/s
[Step=25700 Epoch=48.4] | Loss=0.00732 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.556 | L2-Norm(final)=2.808 | 3419.0 samples/s | 53.4 steps/s
[Step=25750 Epoch=48.5] | Loss=0.00495 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.554 | L2-Norm(final)=2.809 | 3345.3 samples/s | 52.3 steps/s
[Step=25800 Epoch=48.6] | Loss=0.00373 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.554 | L2-Norm(final)=2.809 | 3448.9 samples/s | 53.9 steps/s
[Step=25850 Epoch=48.7] | Loss=0.00300 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.553 | L2-Norm(final)=2.809 | 3473.2 samples/s | 54.3 steps/s
[Step=25900 Epoch=48.8] | Loss=0.00251 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.553 | L2-Norm(final)=2.810 | 3460.9 samples/s | 54.1 steps/s
[Step=25950 Epoch=48.9] | Loss=0.00217 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.552 | L2-Norm(final)=2.810 | 3442.7 samples/s | 53.8 steps/s
[Step=26000 Epoch=49.0] | Loss=0.00191 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.552 | L2-Norm(final)=2.810 | 3430.0 samples/s | 53.6 steps/s
[Step=26050 Epoch=49.1] | Loss=0.00170 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.552 | L2-Norm(final)=2.810 | 3446.2 samples/s | 53.8 steps/s
[Step=26100 Epoch=49.2] | Loss=0.00154 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.551 | L2-Norm(final)=2.811 | 3475.8 samples/s | 54.3 steps/s
[Step=26150 Epoch=49.3] | Loss=0.00140 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.551 | L2-Norm(final)=2.811 | 1814.6 samples/s | 28.4 steps/s
[Step=26200 Epoch=49.4] | Loss=0.00129 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.551 | L2-Norm(final)=2.811 | 3420.0 samples/s | 53.4 steps/s
[Step=26250 Epoch=49.5] | Loss=0.00119 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.551 | L2-Norm(final)=2.811 | 3431.5 samples/s | 53.6 steps/s
[Step=26300 Epoch=49.6] | Loss=0.00111 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.551 | L2-Norm(final)=2.812 | 3423.5 samples/s | 53.5 steps/s
[Step=26350 Epoch=49.7] | Loss=0.00104 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.550 | L2-Norm(final)=2.812 | 3422.6 samples/s | 53.5 steps/s
[Step=26400 Epoch=49.8] | Loss=0.00098 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.550 | L2-Norm(final)=2.812 | 3369.0 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24424 | acc=0.8566 | tpr=0.7975 | fpr=0.0151 | 3817.3 samples/s | 14.9 steps/s
Avg test loss: 0.25336, Avg test acc: 0.85544, Avg tpr: 0.79699, Avg fpr: 0.01602, total FA: 125

Testing server on iccad2012
[Step=  50] | Loss=0.87736 | acc=0.7178 | tpr=1.0000 | fpr=0.2873 | 3850.2 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.87758 | acc=0.7244 | tpr=1.0000 | fpr=0.2807 | 7092.9 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.88633 | acc=0.7239 | tpr=0.9986 | fpr=0.2812 | 6984.3 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.88643 | acc=0.7253 | tpr=0.9978 | fpr=0.2797 | 7018.2 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.89413 | acc=0.7231 | tpr=0.9974 | fpr=0.2819 | 7120.9 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.89284 | acc=0.7241 | tpr=0.9949 | fpr=0.2808 | 7038.6 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.89549 | acc=0.7244 | tpr=0.9944 | fpr=0.2805 | 7125.8 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.89550 | acc=0.7242 | tpr=0.9945 | fpr=0.2807 | 6981.0 samples/s | 27.3 steps/s
[Step= 450] | Loss=0.89744 | acc=0.7243 | tpr=0.9946 | fpr=0.2806 | 6768.0 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.89730 | acc=0.7242 | tpr=0.9943 | fpr=0.2807 | 7258.1 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.89627 | acc=0.7244 | tpr=0.9940 | fpr=0.2805 | 13011.7 samples/s | 50.8 steps/s
Avg test loss: 0.89575, Avg test acc: 0.72447, Avg tpr: 0.99406, Avg fpr: 0.28043, total FA: 38937

server round 33/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=25.8] | Loss=0.14787 | Reg=0.00382 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.557 | L2-Norm(final)=2.826 | 3819.1 samples/s | 59.7 steps/s
[Step=26450 Epoch=25.8] | Loss=0.01855 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.551 | L2-Norm(final)=2.825 | 3554.5 samples/s | 55.5 steps/s
[Step=26500 Epoch=25.9] | Loss=0.01461 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.551 | L2-Norm(final)=2.826 | 3607.6 samples/s | 56.4 steps/s
[Step=26550 Epoch=25.9] | Loss=0.01306 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.551 | L2-Norm(final)=2.828 | 3613.1 samples/s | 56.5 steps/s
[Step=26600 Epoch=26.0] | Loss=0.01287 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.551 | L2-Norm(final)=2.829 | 3561.7 samples/s | 55.7 steps/s
[Step=26650 Epoch=26.0] | Loss=0.01252 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.552 | L2-Norm(final)=2.830 | 3527.9 samples/s | 55.1 steps/s
[Step=26700 Epoch=26.1] | Loss=0.01240 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.552 | L2-Norm(final)=2.831 | 3564.0 samples/s | 55.7 steps/s
[Step=26750 Epoch=26.1] | Loss=0.01205 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.552 | L2-Norm(final)=2.832 | 3536.9 samples/s | 55.3 steps/s
[Step=26800 Epoch=26.2] | Loss=0.01166 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.552 | L2-Norm(final)=2.832 | 3520.4 samples/s | 55.0 steps/s
[Step=26850 Epoch=26.2] | Loss=0.01155 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.553 | L2-Norm(final)=2.833 | 3502.6 samples/s | 54.7 steps/s
[Step=26900 Epoch=26.3] | Loss=0.01143 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.553 | L2-Norm(final)=2.834 | 3556.8 samples/s | 55.6 steps/s
[Step=26950 Epoch=26.3] | Loss=0.01127 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.553 | L2-Norm(final)=2.835 | 3550.6 samples/s | 55.5 steps/s
[Step=27000 Epoch=26.4] | Loss=0.01129 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.554 | L2-Norm(final)=2.836 | 3558.7 samples/s | 55.6 steps/s
[Step=27050 Epoch=26.4] | Loss=0.01124 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.554 | L2-Norm(final)=2.837 | 3567.7 samples/s | 55.7 steps/s
[Step=27100 Epoch=26.5] | Loss=0.01128 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.554 | L2-Norm(final)=2.837 | 3571.8 samples/s | 55.8 steps/s
[Step=27150 Epoch=26.5] | Loss=0.01112 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.555 | L2-Norm(final)=2.838 | 3544.5 samples/s | 55.4 steps/s
[Step=27200 Epoch=26.6] | Loss=0.01091 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.555 | L2-Norm(final)=2.839 | 3541.9 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step27200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=49.8] | Loss=0.48959 | Reg=0.00382 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.557 | L2-Norm(final)=2.825 | 3940.6 samples/s | 61.6 steps/s
[Step=26450 Epoch=49.9] | Loss=0.01848 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.549 | L2-Norm(final)=2.820 | 3303.6 samples/s | 51.6 steps/s
[Step=26500 Epoch=50.0] | Loss=0.00939 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.548 | L2-Norm(final)=2.820 | 3443.8 samples/s | 53.8 steps/s
[Step=26550 Epoch=50.0] | Loss=0.00633 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.546 | L2-Norm(final)=2.820 | 3427.5 samples/s | 53.6 steps/s
[Step=26600 Epoch=50.1] | Loss=0.00481 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.546 | L2-Norm(final)=2.820 | 3412.8 samples/s | 53.3 steps/s
[Step=26650 Epoch=50.2] | Loss=0.00386 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.545 | L2-Norm(final)=2.821 | 3389.3 samples/s | 53.0 steps/s
[Step=26700 Epoch=50.3] | Loss=0.00323 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.545 | L2-Norm(final)=2.821 | 3358.3 samples/s | 52.5 steps/s
[Step=26750 Epoch=50.4] | Loss=0.00278 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.544 | L2-Norm(final)=2.821 | 3354.9 samples/s | 52.4 steps/s
[Step=26800 Epoch=50.5] | Loss=0.00244 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.544 | L2-Norm(final)=2.822 | 3440.1 samples/s | 53.8 steps/s
[Step=26850 Epoch=50.6] | Loss=0.00218 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.544 | L2-Norm(final)=2.822 | 3441.1 samples/s | 53.8 steps/s
[Step=26900 Epoch=50.7] | Loss=0.00196 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.543 | L2-Norm(final)=2.822 | 3495.3 samples/s | 54.6 steps/s
[Step=26950 Epoch=50.8] | Loss=0.00179 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.543 | L2-Norm(final)=2.822 | 1815.7 samples/s | 28.4 steps/s
[Step=27000 Epoch=50.9] | Loss=0.00164 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.543 | L2-Norm(final)=2.823 | 3392.5 samples/s | 53.0 steps/s
[Step=27050 Epoch=51.0] | Loss=0.00152 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.543 | L2-Norm(final)=2.823 | 3349.3 samples/s | 52.3 steps/s
[Step=27100 Epoch=51.1] | Loss=0.00142 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.542 | L2-Norm(final)=2.823 | 3378.0 samples/s | 52.8 steps/s
[Step=27150 Epoch=51.2] | Loss=0.00133 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.542 | L2-Norm(final)=2.823 | 3424.6 samples/s | 53.5 steps/s
[Step=27200 Epoch=51.3] | Loss=0.00125 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.542 | L2-Norm(final)=2.824 | 3470.5 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25058 | acc=0.8559 | tpr=0.7956 | fpr=0.0134 | 3805.1 samples/s | 14.9 steps/s
Avg test loss: 0.26014, Avg test acc: 0.85395, Avg tpr: 0.79419, Avg fpr: 0.01461, total FA: 114

Testing server on iccad2012
[Step=  50] | Loss=0.83954 | acc=0.7276 | tpr=1.0000 | fpr=0.2773 | 3909.2 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.84153 | acc=0.7347 | tpr=1.0000 | fpr=0.2702 | 6937.0 samples/s | 27.1 steps/s
[Step= 150] | Loss=0.84990 | acc=0.7343 | tpr=0.9986 | fpr=0.2706 | 6995.0 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.85063 | acc=0.7359 | tpr=0.9978 | fpr=0.2689 | 7152.8 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.85801 | acc=0.7339 | tpr=0.9974 | fpr=0.2709 | 7168.2 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.85642 | acc=0.7349 | tpr=0.9949 | fpr=0.2698 | 7123.7 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.85931 | acc=0.7350 | tpr=0.9944 | fpr=0.2697 | 7051.7 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.85924 | acc=0.7348 | tpr=0.9945 | fpr=0.2699 | 6815.7 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.86104 | acc=0.7347 | tpr=0.9946 | fpr=0.2700 | 7014.3 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.86092 | acc=0.7347 | tpr=0.9943 | fpr=0.2700 | 6917.1 samples/s | 27.0 steps/s
[Step= 550] | Loss=0.85994 | acc=0.7349 | tpr=0.9940 | fpr=0.2698 | 12964.9 samples/s | 50.6 steps/s
Avg test loss: 0.85949, Avg test acc: 0.73490, Avg tpr: 0.99406, Avg fpr: 0.26981, total FA: 37463

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=26.6] | Loss=0.13956 | Reg=0.00382 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.549 | L2-Norm(final)=2.838 | 4205.8 samples/s | 65.7 steps/s
[Step=27250 Epoch=26.6] | Loss=0.02454 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.544 | L2-Norm(final)=2.835 | 3426.9 samples/s | 53.5 steps/s
[Step=27300 Epoch=26.7] | Loss=0.01792 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.544 | L2-Norm(final)=2.836 | 3600.2 samples/s | 56.3 steps/s
[Step=27350 Epoch=26.7] | Loss=0.01518 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.544 | L2-Norm(final)=2.837 | 3617.0 samples/s | 56.5 steps/s
[Step=27400 Epoch=26.8] | Loss=0.01419 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.544 | L2-Norm(final)=2.839 | 3607.4 samples/s | 56.4 steps/s
[Step=27450 Epoch=26.8] | Loss=0.01311 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.545 | L2-Norm(final)=2.840 | 3599.6 samples/s | 56.2 steps/s
[Step=27500 Epoch=26.8] | Loss=0.01295 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.545 | L2-Norm(final)=2.841 | 3630.2 samples/s | 56.7 steps/s
[Step=27550 Epoch=26.9] | Loss=0.01272 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.545 | L2-Norm(final)=2.842 | 3550.9 samples/s | 55.5 steps/s
[Step=27600 Epoch=26.9] | Loss=0.01238 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.546 | L2-Norm(final)=2.843 | 3528.0 samples/s | 55.1 steps/s
[Step=27650 Epoch=27.0] | Loss=0.01198 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.546 | L2-Norm(final)=2.844 | 3534.4 samples/s | 55.2 steps/s
[Step=27700 Epoch=27.0] | Loss=0.01195 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.547 | L2-Norm(final)=2.845 | 3554.7 samples/s | 55.5 steps/s
[Step=27750 Epoch=27.1] | Loss=0.01198 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.547 | L2-Norm(final)=2.846 | 3559.4 samples/s | 55.6 steps/s
[Step=27800 Epoch=27.1] | Loss=0.01182 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.547 | L2-Norm(final)=2.847 | 3556.2 samples/s | 55.6 steps/s
[Step=27850 Epoch=27.2] | Loss=0.01157 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.548 | L2-Norm(final)=2.847 | 3556.4 samples/s | 55.6 steps/s
[Step=27900 Epoch=27.2] | Loss=0.01164 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.548 | L2-Norm(final)=2.848 | 3562.6 samples/s | 55.7 steps/s
[Step=27950 Epoch=27.3] | Loss=0.01148 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.548 | L2-Norm(final)=2.849 | 3640.2 samples/s | 56.9 steps/s
[Step=28000 Epoch=27.3] | Loss=0.01148 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.549 | L2-Norm(final)=2.849 | 3665.2 samples/s | 57.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step28000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=51.3] | Loss=0.40193 | Reg=0.00382 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.549 | L2-Norm(final)=2.838 | 3954.1 samples/s | 61.8 steps/s
[Step=27250 Epoch=51.4] | Loss=0.01480 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.544 | L2-Norm(final)=2.836 | 3215.6 samples/s | 50.2 steps/s
[Step=27300 Epoch=51.5] | Loss=0.00772 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.543 | L2-Norm(final)=2.836 | 3464.4 samples/s | 54.1 steps/s
[Step=27350 Epoch=51.6] | Loss=0.00521 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.542 | L2-Norm(final)=2.836 | 3422.3 samples/s | 53.5 steps/s
[Step=27400 Epoch=51.6] | Loss=0.00394 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.541 | L2-Norm(final)=2.836 | 3454.3 samples/s | 54.0 steps/s
[Step=27450 Epoch=51.7] | Loss=0.00316 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.540 | L2-Norm(final)=2.836 | 3425.1 samples/s | 53.5 steps/s
[Step=27500 Epoch=51.8] | Loss=0.00264 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.540 | L2-Norm(final)=2.837 | 3441.3 samples/s | 53.8 steps/s
[Step=27550 Epoch=51.9] | Loss=0.00228 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.539 | L2-Norm(final)=2.837 | 3451.4 samples/s | 53.9 steps/s
[Step=27600 Epoch=52.0] | Loss=0.00200 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.539 | L2-Norm(final)=2.837 | 3463.3 samples/s | 54.1 steps/s
[Step=27650 Epoch=52.1] | Loss=0.00178 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.538 | L2-Norm(final)=2.837 | 3358.1 samples/s | 52.5 steps/s
[Step=27700 Epoch=52.2] | Loss=0.00161 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.538 | L2-Norm(final)=2.837 | 3390.5 samples/s | 53.0 steps/s
[Step=27750 Epoch=52.3] | Loss=0.00147 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.538 | L2-Norm(final)=2.837 | 1788.1 samples/s | 27.9 steps/s
[Step=27800 Epoch=52.4] | Loss=0.00135 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.537 | L2-Norm(final)=2.838 | 3484.1 samples/s | 54.4 steps/s
[Step=27850 Epoch=52.5] | Loss=0.00125 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.537 | L2-Norm(final)=2.838 | 3421.0 samples/s | 53.5 steps/s
[Step=27900 Epoch=52.6] | Loss=0.00116 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.537 | L2-Norm(final)=2.838 | 3429.9 samples/s | 53.6 steps/s
[Step=27950 Epoch=52.7] | Loss=0.00109 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.537 | L2-Norm(final)=2.838 | 3415.7 samples/s | 53.4 steps/s
[Step=28000 Epoch=52.8] | Loss=0.00103 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.537 | L2-Norm(final)=2.838 | 3433.2 samples/s | 53.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26247 | acc=0.8514 | tpr=0.7886 | fpr=0.0121 | 3868.5 samples/s | 15.1 steps/s
Avg test loss: 0.27130, Avg test acc: 0.84999, Avg tpr: 0.78813, Avg fpr: 0.01397, total FA: 109

Testing server on iccad2012
[Step=  50] | Loss=0.79160 | acc=0.7412 | tpr=1.0000 | fpr=0.2634 | 3885.6 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.79467 | acc=0.7484 | tpr=1.0000 | fpr=0.2563 | 7096.5 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.80302 | acc=0.7468 | tpr=0.9986 | fpr=0.2578 | 7064.4 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.80408 | acc=0.7482 | tpr=0.9967 | fpr=0.2564 | 7127.3 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.81140 | acc=0.7460 | tpr=0.9965 | fpr=0.2586 | 6909.2 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.81027 | acc=0.7470 | tpr=0.9942 | fpr=0.2575 | 7267.7 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.81349 | acc=0.7472 | tpr=0.9931 | fpr=0.2573 | 6994.1 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.81348 | acc=0.7473 | tpr=0.9929 | fpr=0.2571 | 6958.9 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.81518 | acc=0.7473 | tpr=0.9932 | fpr=0.2572 | 6950.3 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.81489 | acc=0.7474 | tpr=0.9930 | fpr=0.2570 | 7075.3 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.81393 | acc=0.7475 | tpr=0.9928 | fpr=0.2570 | 12951.6 samples/s | 50.6 steps/s
Avg test loss: 0.81344, Avg test acc: 0.74753, Avg tpr: 0.99287, Avg fpr: 0.25693, total FA: 35674

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=27.3] | Loss=0.16833 | Reg=0.00382 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.542 | L2-Norm(final)=2.849 | 3711.5 samples/s | 58.0 steps/s
[Step=28050 Epoch=27.4] | Loss=0.01903 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.536 | L2-Norm(final)=2.849 | 3516.9 samples/s | 55.0 steps/s
[Step=28100 Epoch=27.4] | Loss=0.01353 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.536 | L2-Norm(final)=2.850 | 3489.8 samples/s | 54.5 steps/s
[Step=28150 Epoch=27.5] | Loss=0.01196 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.536 | L2-Norm(final)=2.852 | 3505.3 samples/s | 54.8 steps/s
[Step=28200 Epoch=27.5] | Loss=0.01114 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.537 | L2-Norm(final)=2.853 | 3526.1 samples/s | 55.1 steps/s
[Step=28250 Epoch=27.6] | Loss=0.01128 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.537 | L2-Norm(final)=2.854 | 3542.0 samples/s | 55.3 steps/s
[Step=28300 Epoch=27.6] | Loss=0.01103 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.537 | L2-Norm(final)=2.855 | 3525.4 samples/s | 55.1 steps/s
[Step=28350 Epoch=27.7] | Loss=0.01108 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.538 | L2-Norm(final)=2.856 | 3534.2 samples/s | 55.2 steps/s
[Step=28400 Epoch=27.7] | Loss=0.01075 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.538 | L2-Norm(final)=2.857 | 3530.7 samples/s | 55.2 steps/s
[Step=28450 Epoch=27.8] | Loss=0.01063 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.539 | L2-Norm(final)=2.858 | 3531.8 samples/s | 55.2 steps/s
[Step=28500 Epoch=27.8] | Loss=0.01061 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.539 | L2-Norm(final)=2.859 | 3549.8 samples/s | 55.5 steps/s
[Step=28550 Epoch=27.9] | Loss=0.01059 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.539 | L2-Norm(final)=2.859 | 3572.6 samples/s | 55.8 steps/s
[Step=28600 Epoch=27.9] | Loss=0.01046 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.540 | L2-Norm(final)=2.860 | 3647.1 samples/s | 57.0 steps/s
[Step=28650 Epoch=28.0] | Loss=0.01043 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.540 | L2-Norm(final)=2.861 | 3638.5 samples/s | 56.9 steps/s
[Step=28700 Epoch=28.0] | Loss=0.01040 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.540 | L2-Norm(final)=2.862 | 3618.6 samples/s | 56.5 steps/s
[Step=28750 Epoch=28.1] | Loss=0.01047 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.541 | L2-Norm(final)=2.862 | 3590.7 samples/s | 56.1 steps/s
[Step=28800 Epoch=28.1] | Loss=0.01037 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.541 | L2-Norm(final)=2.863 | 3648.7 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step28800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=52.8] | Loss=0.13645 | Reg=0.00382 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.542 | L2-Norm(final)=2.849 | 3729.0 samples/s | 58.3 steps/s
[Step=28050 Epoch=52.9] | Loss=0.01312 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.538 | L2-Norm(final)=2.847 | 3336.0 samples/s | 52.1 steps/s
[Step=28100 Epoch=53.0] | Loss=0.00704 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.536 | L2-Norm(final)=2.847 | 3423.0 samples/s | 53.5 steps/s
[Step=28150 Epoch=53.1] | Loss=0.00474 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.535 | L2-Norm(final)=2.847 | 3441.0 samples/s | 53.8 steps/s
[Step=28200 Epoch=53.2] | Loss=0.00358 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.534 | L2-Norm(final)=2.848 | 3439.6 samples/s | 53.7 steps/s
[Step=28250 Epoch=53.3] | Loss=0.00288 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.534 | L2-Norm(final)=2.848 | 3387.2 samples/s | 52.9 steps/s
[Step=28300 Epoch=53.3] | Loss=0.00242 | Reg=0.00382 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.533 | L2-Norm(final)=2.848 | 3361.7 samples/s | 52.5 steps/s
[Step=28350 Epoch=53.4] | Loss=0.00208 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.532 | L2-Norm(final)=2.848 | 3373.0 samples/s | 52.7 steps/s
[Step=28400 Epoch=53.5] | Loss=0.00183 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.532 | L2-Norm(final)=2.848 | 3343.0 samples/s | 52.2 steps/s
[Step=28450 Epoch=53.6] | Loss=0.00163 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.532 | L2-Norm(final)=2.848 | 3357.0 samples/s | 52.5 steps/s
[Step=28500 Epoch=53.7] | Loss=0.00147 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.531 | L2-Norm(final)=2.848 | 3395.9 samples/s | 53.1 steps/s
[Step=28550 Epoch=53.8] | Loss=0.00134 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.531 | L2-Norm(final)=2.849 | 1786.0 samples/s | 27.9 steps/s
[Step=28600 Epoch=53.9] | Loss=0.00123 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.531 | L2-Norm(final)=2.849 | 3449.1 samples/s | 53.9 steps/s
[Step=28650 Epoch=54.0] | Loss=0.00114 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.530 | L2-Norm(final)=2.849 | 3416.5 samples/s | 53.4 steps/s
[Step=28700 Epoch=54.1] | Loss=0.00106 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.530 | L2-Norm(final)=2.849 | 3440.3 samples/s | 53.8 steps/s
[Step=28750 Epoch=54.2] | Loss=0.00100 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.530 | L2-Norm(final)=2.849 | 3409.3 samples/s | 53.3 steps/s
[Step=28800 Epoch=54.3] | Loss=0.00094 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.530 | L2-Norm(final)=2.849 | 3364.1 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24516 | acc=0.8598 | tpr=0.8015 | fpr=0.0134 | 3880.1 samples/s | 15.2 steps/s
Avg test loss: 0.25487, Avg test acc: 0.85916, Avg tpr: 0.80177, Avg fpr: 0.01461, total FA: 114

Testing server on iccad2012
[Step=  50] | Loss=0.84660 | acc=0.7316 | tpr=1.0000 | fpr=0.2733 | 3832.4 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.84782 | acc=0.7393 | tpr=1.0000 | fpr=0.2656 | 7115.0 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.85644 | acc=0.7382 | tpr=0.9986 | fpr=0.2666 | 7231.9 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.85747 | acc=0.7395 | tpr=0.9967 | fpr=0.2651 | 7021.9 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.86526 | acc=0.7376 | tpr=0.9965 | fpr=0.2671 | 7068.9 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.86394 | acc=0.7385 | tpr=0.9942 | fpr=0.2662 | 6991.8 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.86677 | acc=0.7388 | tpr=0.9931 | fpr=0.2659 | 7072.8 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.86676 | acc=0.7386 | tpr=0.9934 | fpr=0.2660 | 6967.9 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.86846 | acc=0.7385 | tpr=0.9937 | fpr=0.2662 | 7240.7 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.86828 | acc=0.7384 | tpr=0.9934 | fpr=0.2662 | 6822.0 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.86725 | acc=0.7385 | tpr=0.9932 | fpr=0.2661 | 13232.2 samples/s | 51.7 steps/s
Avg test loss: 0.86675, Avg test acc: 0.73853, Avg tpr: 0.99326, Avg fpr: 0.26610, total FA: 36947

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=28.1] | Loss=0.27561 | Reg=0.00382 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.535 | L2-Norm(final)=2.861 | 4074.2 samples/s | 63.7 steps/s
[Step=28850 Epoch=28.2] | Loss=0.02201 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.529 | L2-Norm(final)=2.859 | 3460.6 samples/s | 54.1 steps/s
[Step=28900 Epoch=28.2] | Loss=0.01677 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.528 | L2-Norm(final)=2.859 | 3564.6 samples/s | 55.7 steps/s
[Step=28950 Epoch=28.3] | Loss=0.01446 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.528 | L2-Norm(final)=2.859 | 3561.0 samples/s | 55.6 steps/s
[Step=29000 Epoch=28.3] | Loss=0.01325 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.528 | L2-Norm(final)=2.861 | 3525.4 samples/s | 55.1 steps/s
[Step=29050 Epoch=28.4] | Loss=0.01272 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.528 | L2-Norm(final)=2.862 | 3545.2 samples/s | 55.4 steps/s
[Step=29100 Epoch=28.4] | Loss=0.01189 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.529 | L2-Norm(final)=2.863 | 3559.8 samples/s | 55.6 steps/s
[Step=29150 Epoch=28.5] | Loss=0.01158 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.529 | L2-Norm(final)=2.864 | 3548.2 samples/s | 55.4 steps/s
[Step=29200 Epoch=28.5] | Loss=0.01126 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.529 | L2-Norm(final)=2.865 | 3531.4 samples/s | 55.2 steps/s
[Step=29250 Epoch=28.6] | Loss=0.01105 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.530 | L2-Norm(final)=2.866 | 3551.2 samples/s | 55.5 steps/s
[Step=29300 Epoch=28.6] | Loss=0.01092 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.530 | L2-Norm(final)=2.867 | 3545.2 samples/s | 55.4 steps/s
[Step=29350 Epoch=28.7] | Loss=0.01075 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.531 | L2-Norm(final)=2.868 | 3539.0 samples/s | 55.3 steps/s
[Step=29400 Epoch=28.7] | Loss=0.01074 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.531 | L2-Norm(final)=2.869 | 3559.0 samples/s | 55.6 steps/s
[Step=29450 Epoch=28.8] | Loss=0.01053 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.532 | L2-Norm(final)=2.870 | 3536.3 samples/s | 55.3 steps/s
[Step=29500 Epoch=28.8] | Loss=0.01054 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.532 | L2-Norm(final)=2.870 | 3541.3 samples/s | 55.3 steps/s
[Step=29550 Epoch=28.9] | Loss=0.01046 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.532 | L2-Norm(final)=2.871 | 3561.3 samples/s | 55.6 steps/s
[Step=29600 Epoch=28.9] | Loss=0.01042 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.533 | L2-Norm(final)=2.872 | 3648.1 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step29600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=54.3] | Loss=0.35350 | Reg=0.00382 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.535 | L2-Norm(final)=2.861 | 4146.2 samples/s | 64.8 steps/s
[Step=28850 Epoch=54.4] | Loss=0.01361 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.528 | L2-Norm(final)=2.857 | 3106.0 samples/s | 48.5 steps/s
[Step=28900 Epoch=54.5] | Loss=0.00694 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.527 | L2-Norm(final)=2.856 | 3419.3 samples/s | 53.4 steps/s
[Step=28950 Epoch=54.6] | Loss=0.00467 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.525 | L2-Norm(final)=2.857 | 3361.3 samples/s | 52.5 steps/s
[Step=29000 Epoch=54.7] | Loss=0.00352 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.525 | L2-Norm(final)=2.857 | 3426.1 samples/s | 53.5 steps/s
[Step=29050 Epoch=54.8] | Loss=0.00283 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.524 | L2-Norm(final)=2.857 | 3458.4 samples/s | 54.0 steps/s
[Step=29100 Epoch=54.9] | Loss=0.00237 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.523 | L2-Norm(final)=2.857 | 3450.0 samples/s | 53.9 steps/s
[Step=29150 Epoch=54.9] | Loss=0.00204 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.523 | L2-Norm(final)=2.858 | 3409.7 samples/s | 53.3 steps/s
[Step=29200 Epoch=55.0] | Loss=0.00179 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.523 | L2-Norm(final)=2.858 | 3367.7 samples/s | 52.6 steps/s
[Step=29250 Epoch=55.1] | Loss=0.00160 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.522 | L2-Norm(final)=2.858 | 3354.9 samples/s | 52.4 steps/s
[Step=29300 Epoch=55.2] | Loss=0.00144 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.522 | L2-Norm(final)=2.858 | 3394.8 samples/s | 53.0 steps/s
[Step=29350 Epoch=55.3] | Loss=0.00132 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.522 | L2-Norm(final)=2.859 | 1806.4 samples/s | 28.2 steps/s
[Step=29400 Epoch=55.4] | Loss=0.00121 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.522 | L2-Norm(final)=2.859 | 3427.8 samples/s | 53.6 steps/s
[Step=29450 Epoch=55.5] | Loss=0.00112 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.521 | L2-Norm(final)=2.859 | 3433.8 samples/s | 53.7 steps/s
[Step=29500 Epoch=55.6] | Loss=0.00105 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.521 | L2-Norm(final)=2.859 | 3405.1 samples/s | 53.2 steps/s
[Step=29550 Epoch=55.7] | Loss=0.00098 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.521 | L2-Norm(final)=2.859 | 3404.6 samples/s | 53.2 steps/s
[Step=29600 Epoch=55.8] | Loss=0.00092 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.521 | L2-Norm(final)=2.860 | 3433.7 samples/s | 53.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27497 | acc=0.8469 | tpr=0.7827 | fpr=0.0139 | 3864.7 samples/s | 15.1 steps/s
Avg test loss: 0.28430, Avg test acc: 0.84582, Avg tpr: 0.78248, Avg fpr: 0.01487, total FA: 116

Testing server on iccad2012
[Step=  50] | Loss=0.78940 | acc=0.7526 | tpr=1.0000 | fpr=0.2519 | 3885.4 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.79194 | acc=0.7594 | tpr=1.0000 | fpr=0.2451 | 7012.3 samples/s | 27.4 steps/s
[Step= 150] | Loss=0.80078 | acc=0.7586 | tpr=0.9986 | fpr=0.2458 | 7185.9 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.80222 | acc=0.7598 | tpr=0.9978 | fpr=0.2446 | 7015.2 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.80962 | acc=0.7576 | tpr=0.9974 | fpr=0.2468 | 7039.0 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.80900 | acc=0.7585 | tpr=0.9949 | fpr=0.2458 | 7152.1 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.81207 | acc=0.7588 | tpr=0.9937 | fpr=0.2454 | 6874.2 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.81195 | acc=0.7589 | tpr=0.9929 | fpr=0.2454 | 7214.6 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.81384 | acc=0.7590 | tpr=0.9927 | fpr=0.2452 | 7151.5 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.81353 | acc=0.7589 | tpr=0.9925 | fpr=0.2453 | 6914.2 samples/s | 27.0 steps/s
[Step= 550] | Loss=0.81261 | acc=0.7590 | tpr=0.9924 | fpr=0.2453 | 13442.0 samples/s | 52.5 steps/s
Avg test loss: 0.81209, Avg test acc: 0.75903, Avg tpr: 0.99247, Avg fpr: 0.24521, total FA: 34047

server round 37/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=28.9] | Loss=0.10336 | Reg=0.00381 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.527 | L2-Norm(final)=2.872 | 4212.1 samples/s | 65.8 steps/s
[Step=29650 Epoch=28.9] | Loss=0.01817 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.522 | L2-Norm(final)=2.871 | 3318.6 samples/s | 51.9 steps/s
[Step=29700 Epoch=29.0] | Loss=0.01419 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.522 | L2-Norm(final)=2.872 | 3510.6 samples/s | 54.9 steps/s
[Step=29750 Epoch=29.0] | Loss=0.01177 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.522 | L2-Norm(final)=2.873 | 3506.0 samples/s | 54.8 steps/s
[Step=29800 Epoch=29.1] | Loss=0.01145 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.522 | L2-Norm(final)=2.874 | 3527.0 samples/s | 55.1 steps/s
[Step=29850 Epoch=29.1] | Loss=0.01099 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.522 | L2-Norm(final)=2.875 | 3525.1 samples/s | 55.1 steps/s
[Step=29900 Epoch=29.2] | Loss=0.01051 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.522 | L2-Norm(final)=2.876 | 3545.4 samples/s | 55.4 steps/s
[Step=29950 Epoch=29.2] | Loss=0.01043 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.523 | L2-Norm(final)=2.877 | 3540.4 samples/s | 55.3 steps/s
[Step=30000 Epoch=29.3] | Loss=0.01046 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.523 | L2-Norm(final)=2.878 | 3552.2 samples/s | 55.5 steps/s
[Step=30050 Epoch=29.3] | Loss=0.01027 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.523 | L2-Norm(final)=2.878 | 3545.8 samples/s | 55.4 steps/s
[Step=30100 Epoch=29.4] | Loss=0.01064 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.524 | L2-Norm(final)=2.879 | 3521.9 samples/s | 55.0 steps/s
[Step=30150 Epoch=29.4] | Loss=0.01058 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.524 | L2-Norm(final)=2.879 | 3527.1 samples/s | 55.1 steps/s
[Step=30200 Epoch=29.5] | Loss=0.01055 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.524 | L2-Norm(final)=2.880 | 3493.0 samples/s | 54.6 steps/s
[Step=30250 Epoch=29.5] | Loss=0.01048 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.524 | L2-Norm(final)=2.881 | 3527.4 samples/s | 55.1 steps/s
[Step=30300 Epoch=29.6] | Loss=0.01053 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.524 | L2-Norm(final)=2.881 | 3554.3 samples/s | 55.5 steps/s
[Step=30350 Epoch=29.6] | Loss=0.01038 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.525 | L2-Norm(final)=2.882 | 3565.5 samples/s | 55.7 steps/s
[Step=30400 Epoch=29.7] | Loss=0.01031 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.525 | L2-Norm(final)=2.882 | 3553.8 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step30400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=55.8] | Loss=0.24205 | Reg=0.00381 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.527 | L2-Norm(final)=2.872 | 4326.2 samples/s | 67.6 steps/s
[Step=29650 Epoch=55.9] | Loss=0.01481 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.521 | L2-Norm(final)=2.868 | 3100.5 samples/s | 48.4 steps/s
[Step=29700 Epoch=56.0] | Loss=0.00756 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.520 | L2-Norm(final)=2.868 | 3367.6 samples/s | 52.6 steps/s
[Step=29750 Epoch=56.1] | Loss=0.00510 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.519 | L2-Norm(final)=2.868 | 3404.3 samples/s | 53.2 steps/s
[Step=29800 Epoch=56.2] | Loss=0.00384 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.518 | L2-Norm(final)=2.868 | 3389.6 samples/s | 53.0 steps/s
[Step=29850 Epoch=56.3] | Loss=0.00308 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.518 | L2-Norm(final)=2.868 | 3352.2 samples/s | 52.4 steps/s
[Step=29900 Epoch=56.4] | Loss=0.00258 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.517 | L2-Norm(final)=2.869 | 3358.9 samples/s | 52.5 steps/s
[Step=29950 Epoch=56.5] | Loss=0.00222 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.517 | L2-Norm(final)=2.869 | 3376.2 samples/s | 52.8 steps/s
[Step=30000 Epoch=56.6] | Loss=0.00195 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.516 | L2-Norm(final)=2.869 | 3415.8 samples/s | 53.4 steps/s
[Step=30050 Epoch=56.6] | Loss=0.00174 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.516 | L2-Norm(final)=2.869 | 3462.2 samples/s | 54.1 steps/s
[Step=30100 Epoch=56.7] | Loss=0.00157 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.515 | L2-Norm(final)=2.870 | 3461.5 samples/s | 54.1 steps/s
[Step=30150 Epoch=56.8] | Loss=0.00143 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.515 | L2-Norm(final)=2.870 | 1808.4 samples/s | 28.3 steps/s
[Step=30200 Epoch=56.9] | Loss=0.00132 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.515 | L2-Norm(final)=2.870 | 3341.5 samples/s | 52.2 steps/s
[Step=30250 Epoch=57.0] | Loss=0.00122 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.515 | L2-Norm(final)=2.870 | 3355.4 samples/s | 52.4 steps/s
[Step=30300 Epoch=57.1] | Loss=0.00114 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.514 | L2-Norm(final)=2.870 | 3392.7 samples/s | 53.0 steps/s
[Step=30350 Epoch=57.2] | Loss=0.00106 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.514 | L2-Norm(final)=2.870 | 3415.3 samples/s | 53.4 steps/s
[Step=30400 Epoch=57.3] | Loss=0.00100 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.514 | L2-Norm(final)=2.870 | 3414.1 samples/s | 53.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26613 | acc=0.8523 | tpr=0.7911 | fpr=0.0146 | 3858.3 samples/s | 15.1 steps/s
Avg test loss: 0.27560, Avg test acc: 0.85107, Avg tpr: 0.79035, Avg fpr: 0.01538, total FA: 120

Testing server on iccad2012
[Step=  50] | Loss=0.86943 | acc=0.7330 | tpr=1.0000 | fpr=0.2718 | 3941.2 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.87076 | acc=0.7402 | tpr=1.0000 | fpr=0.2647 | 6803.2 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.87974 | acc=0.7396 | tpr=0.9986 | fpr=0.2651 | 6978.2 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.88111 | acc=0.7405 | tpr=0.9978 | fpr=0.2642 | 7068.8 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.88892 | acc=0.7384 | tpr=0.9974 | fpr=0.2663 | 6867.0 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.88786 | acc=0.7396 | tpr=0.9949 | fpr=0.2651 | 7214.2 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.89093 | acc=0.7399 | tpr=0.9937 | fpr=0.2647 | 7106.9 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.89077 | acc=0.7400 | tpr=0.9940 | fpr=0.2647 | 7054.8 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.89266 | acc=0.7398 | tpr=0.9942 | fpr=0.2648 | 7058.7 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.89236 | acc=0.7398 | tpr=0.9938 | fpr=0.2647 | 6954.4 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.89137 | acc=0.7400 | tpr=0.9936 | fpr=0.2646 | 12826.4 samples/s | 50.1 steps/s
Avg test loss: 0.89087, Avg test acc: 0.74004, Avg tpr: 0.99366, Avg fpr: 0.26457, total FA: 36735

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=29.7] | Loss=0.12900 | Reg=0.00381 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.519 | L2-Norm(final)=2.882 | 4525.0 samples/s | 70.7 steps/s
[Step=30450 Epoch=29.7] | Loss=0.01990 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.513 | L2-Norm(final)=2.880 | 3219.7 samples/s | 50.3 steps/s
[Step=30500 Epoch=29.8] | Loss=0.01432 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.513 | L2-Norm(final)=2.881 | 3594.4 samples/s | 56.2 steps/s
[Step=30550 Epoch=29.8] | Loss=0.01389 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.513 | L2-Norm(final)=2.882 | 3606.0 samples/s | 56.3 steps/s
[Step=30600 Epoch=29.9] | Loss=0.01268 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.514 | L2-Norm(final)=2.883 | 3627.4 samples/s | 56.7 steps/s
[Step=30650 Epoch=29.9] | Loss=0.01196 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.514 | L2-Norm(final)=2.884 | 3545.0 samples/s | 55.4 steps/s
[Step=30700 Epoch=30.0] | Loss=0.01153 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.514 | L2-Norm(final)=2.885 | 3512.9 samples/s | 54.9 steps/s
[Step=30750 Epoch=30.0] | Loss=0.01104 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.515 | L2-Norm(final)=2.886 | 3537.0 samples/s | 55.3 steps/s
[Step=30800 Epoch=30.1] | Loss=0.01063 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.515 | L2-Norm(final)=2.887 | 3541.1 samples/s | 55.3 steps/s
[Step=30850 Epoch=30.1] | Loss=0.01058 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.516 | L2-Norm(final)=2.889 | 3519.5 samples/s | 55.0 steps/s
[Step=30900 Epoch=30.2] | Loss=0.01053 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.516 | L2-Norm(final)=2.889 | 3533.3 samples/s | 55.2 steps/s
[Step=30950 Epoch=30.2] | Loss=0.01049 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.516 | L2-Norm(final)=2.890 | 3545.6 samples/s | 55.4 steps/s
[Step=31000 Epoch=30.3] | Loss=0.01036 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.517 | L2-Norm(final)=2.891 | 3552.2 samples/s | 55.5 steps/s
[Step=31050 Epoch=30.3] | Loss=0.01042 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.517 | L2-Norm(final)=2.892 | 3554.9 samples/s | 55.5 steps/s
[Step=31100 Epoch=30.4] | Loss=0.01044 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.517 | L2-Norm(final)=2.892 | 3549.4 samples/s | 55.5 steps/s
[Step=31150 Epoch=30.4] | Loss=0.01038 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.517 | L2-Norm(final)=2.893 | 3525.1 samples/s | 55.1 steps/s
[Step=31200 Epoch=30.5] | Loss=0.01035 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.518 | L2-Norm(final)=2.894 | 3531.3 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step31200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=57.3] | Loss=0.30205 | Reg=0.00381 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.519 | L2-Norm(final)=2.882 | 3795.7 samples/s | 59.3 steps/s
[Step=30450 Epoch=57.4] | Loss=0.01721 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.514 | L2-Norm(final)=2.878 | 3259.7 samples/s | 50.9 steps/s
[Step=30500 Epoch=57.5] | Loss=0.00879 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.513 | L2-Norm(final)=2.877 | 3340.5 samples/s | 52.2 steps/s
[Step=30550 Epoch=57.6] | Loss=0.00591 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.512 | L2-Norm(final)=2.877 | 3340.9 samples/s | 52.2 steps/s
[Step=30600 Epoch=57.7] | Loss=0.00445 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.511 | L2-Norm(final)=2.877 | 3359.9 samples/s | 52.5 steps/s
[Step=30650 Epoch=57.8] | Loss=0.00358 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.510 | L2-Norm(final)=2.877 | 3369.6 samples/s | 52.7 steps/s
[Step=30700 Epoch=57.9] | Loss=0.00299 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.509 | L2-Norm(final)=2.878 | 3360.0 samples/s | 52.5 steps/s
[Step=30750 Epoch=58.0] | Loss=0.00258 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.509 | L2-Norm(final)=2.878 | 3466.8 samples/s | 54.2 steps/s
[Step=30800 Epoch=58.1] | Loss=0.00226 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.509 | L2-Norm(final)=2.878 | 3475.9 samples/s | 54.3 steps/s
[Step=30850 Epoch=58.2] | Loss=0.00202 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.508 | L2-Norm(final)=2.878 | 3335.5 samples/s | 52.1 steps/s
[Step=30900 Epoch=58.2] | Loss=0.00182 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.508 | L2-Norm(final)=2.879 | 3344.9 samples/s | 52.3 steps/s
[Step=30950 Epoch=58.3] | Loss=0.00166 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.508 | L2-Norm(final)=2.879 | 1719.1 samples/s | 26.9 steps/s
[Step=31000 Epoch=58.4] | Loss=0.00152 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.507 | L2-Norm(final)=2.879 | 3294.5 samples/s | 51.5 steps/s
[Step=31050 Epoch=58.5] | Loss=0.00141 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.507 | L2-Norm(final)=2.879 | 3299.0 samples/s | 51.5 steps/s
[Step=31100 Epoch=58.6] | Loss=0.00131 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.507 | L2-Norm(final)=2.879 | 3301.1 samples/s | 51.6 steps/s
[Step=31150 Epoch=58.7] | Loss=0.00123 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.506 | L2-Norm(final)=2.880 | 3242.3 samples/s | 50.7 steps/s
[Step=31200 Epoch=58.8] | Loss=0.00115 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.506 | L2-Norm(final)=2.880 | 3360.8 samples/s | 52.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21910 | acc=0.8700 | tpr=0.8177 | fpr=0.0164 | 3875.7 samples/s | 15.1 steps/s
Avg test loss: 0.22817, Avg test acc: 0.86978, Avg tpr: 0.81827, Avg fpr: 0.01692, total FA: 132

Testing server on iccad2012
[Step=  50] | Loss=0.88429 | acc=0.7257 | tpr=1.0000 | fpr=0.2792 | 3817.0 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.88618 | acc=0.7327 | tpr=1.0000 | fpr=0.2723 | 7090.3 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.89463 | acc=0.7324 | tpr=0.9986 | fpr=0.2725 | 7076.5 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.89568 | acc=0.7334 | tpr=0.9978 | fpr=0.2714 | 6867.2 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.90347 | acc=0.7315 | tpr=0.9974 | fpr=0.2734 | 7256.9 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.90183 | acc=0.7325 | tpr=0.9949 | fpr=0.2723 | 6987.2 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.90490 | acc=0.7325 | tpr=0.9937 | fpr=0.2723 | 7049.9 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.90519 | acc=0.7324 | tpr=0.9940 | fpr=0.2724 | 7115.2 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.90705 | acc=0.7324 | tpr=0.9942 | fpr=0.2724 | 6866.9 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.90678 | acc=0.7322 | tpr=0.9938 | fpr=0.2725 | 6995.6 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.90574 | acc=0.7324 | tpr=0.9936 | fpr=0.2724 | 13755.1 samples/s | 53.7 steps/s
Avg test loss: 0.90523, Avg test acc: 0.73238, Avg tpr: 0.99366, Avg fpr: 0.27237, total FA: 37818

server round 39/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=30.5] | Loss=0.11500 | Reg=0.00381 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.512 | L2-Norm(final)=2.893 | 4359.3 samples/s | 68.1 steps/s
[Step=31250 Epoch=30.5] | Loss=0.01771 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.506 | L2-Norm(final)=2.893 | 3239.8 samples/s | 50.6 steps/s
[Step=31300 Epoch=30.6] | Loss=0.01315 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.506 | L2-Norm(final)=2.894 | 3513.2 samples/s | 54.9 steps/s
[Step=31350 Epoch=30.6] | Loss=0.01159 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.507 | L2-Norm(final)=2.896 | 3520.7 samples/s | 55.0 steps/s
[Step=31400 Epoch=30.7] | Loss=0.01079 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.507 | L2-Norm(final)=2.897 | 3524.5 samples/s | 55.1 steps/s
[Step=31450 Epoch=30.7] | Loss=0.01025 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.507 | L2-Norm(final)=2.898 | 3540.0 samples/s | 55.3 steps/s
[Step=31500 Epoch=30.8] | Loss=0.01001 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.508 | L2-Norm(final)=2.899 | 3535.2 samples/s | 55.2 steps/s
[Step=31550 Epoch=30.8] | Loss=0.00980 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.508 | L2-Norm(final)=2.900 | 3542.1 samples/s | 55.3 steps/s
[Step=31600 Epoch=30.9] | Loss=0.00945 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.508 | L2-Norm(final)=2.901 | 3504.9 samples/s | 54.8 steps/s
[Step=31650 Epoch=30.9] | Loss=0.00918 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.508 | L2-Norm(final)=2.902 | 3520.6 samples/s | 55.0 steps/s
[Step=31700 Epoch=30.9] | Loss=0.00927 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.509 | L2-Norm(final)=2.903 | 3524.1 samples/s | 55.1 steps/s
[Step=31750 Epoch=31.0] | Loss=0.00946 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.509 | L2-Norm(final)=2.904 | 3545.5 samples/s | 55.4 steps/s
[Step=31800 Epoch=31.0] | Loss=0.00961 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.509 | L2-Norm(final)=2.904 | 3517.6 samples/s | 55.0 steps/s
[Step=31850 Epoch=31.1] | Loss=0.00958 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.510 | L2-Norm(final)=2.905 | 3529.7 samples/s | 55.2 steps/s
[Step=31900 Epoch=31.1] | Loss=0.00970 | Reg=0.00381 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.510 | L2-Norm(final)=2.905 | 3539.4 samples/s | 55.3 steps/s
[Step=31950 Epoch=31.2] | Loss=0.00987 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.510 | L2-Norm(final)=2.906 | 3538.0 samples/s | 55.3 steps/s
[Step=32000 Epoch=31.2] | Loss=0.00997 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.510 | L2-Norm(final)=2.906 | 3540.9 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step32000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=58.8] | Loss=0.43307 | Reg=0.00381 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.512 | L2-Norm(final)=2.893 | 3711.7 samples/s | 58.0 steps/s
[Step=31250 Epoch=58.9] | Loss=0.02494 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.507 | L2-Norm(final)=2.886 | 3436.3 samples/s | 53.7 steps/s
[Step=31300 Epoch=59.0] | Loss=0.01275 | Reg=0.00380 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.505 | L2-Norm(final)=2.885 | 3374.3 samples/s | 52.7 steps/s
[Step=31350 Epoch=59.1] | Loss=0.00855 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.504 | L2-Norm(final)=2.885 | 3301.0 samples/s | 51.6 steps/s
[Step=31400 Epoch=59.2] | Loss=0.00644 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.503 | L2-Norm(final)=2.886 | 3324.4 samples/s | 51.9 steps/s
[Step=31450 Epoch=59.3] | Loss=0.00517 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.502 | L2-Norm(final)=2.886 | 3294.1 samples/s | 51.5 steps/s
[Step=31500 Epoch=59.4] | Loss=0.00432 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.502 | L2-Norm(final)=2.886 | 3360.3 samples/s | 52.5 steps/s
[Step=31550 Epoch=59.5] | Loss=0.00372 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.501 | L2-Norm(final)=2.887 | 3369.5 samples/s | 52.6 steps/s
[Step=31600 Epoch=59.6] | Loss=0.00326 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.501 | L2-Norm(final)=2.887 | 3305.7 samples/s | 51.7 steps/s
[Step=31650 Epoch=59.7] | Loss=0.00290 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.500 | L2-Norm(final)=2.887 | 3306.7 samples/s | 51.7 steps/s
[Step=31700 Epoch=59.8] | Loss=0.00262 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.500 | L2-Norm(final)=2.887 | 3315.5 samples/s | 51.8 steps/s
[Step=31750 Epoch=59.8] | Loss=0.00238 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.500 | L2-Norm(final)=2.888 | 1775.7 samples/s | 27.7 steps/s
[Step=31800 Epoch=59.9] | Loss=0.00219 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.499 | L2-Norm(final)=2.888 | 3311.8 samples/s | 51.7 steps/s
[Step=31850 Epoch=60.0] | Loss=0.00202 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.499 | L2-Norm(final)=2.888 | 3327.3 samples/s | 52.0 steps/s
[Step=31900 Epoch=60.1] | Loss=0.00188 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.499 | L2-Norm(final)=2.888 | 3353.4 samples/s | 52.4 steps/s
[Step=31950 Epoch=60.2] | Loss=0.00176 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.499 | L2-Norm(final)=2.889 | 3383.4 samples/s | 52.9 steps/s
[Step=32000 Epoch=60.3] | Loss=0.00165 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.498 | L2-Norm(final)=2.889 | 3349.3 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24514 | acc=0.8577 | tpr=0.7999 | fpr=0.0168 | 3667.1 samples/s | 14.3 steps/s
Avg test loss: 0.25402, Avg test acc: 0.85604, Avg tpr: 0.79851, Avg fpr: 0.01743, total FA: 136

Testing server on iccad2012
[Step=  50] | Loss=0.75187 | acc=0.7619 | tpr=0.9956 | fpr=0.2423 | 3762.8 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.75691 | acc=0.7660 | tpr=0.9936 | fpr=0.2383 | 6495.0 samples/s | 25.4 steps/s
[Step= 150] | Loss=0.76531 | acc=0.7655 | tpr=0.9942 | fpr=0.2387 | 6598.1 samples/s | 25.8 steps/s
[Step= 200] | Loss=0.76670 | acc=0.7667 | tpr=0.9934 | fpr=0.2374 | 6684.9 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.77322 | acc=0.7644 | tpr=0.9939 | fpr=0.2397 | 6567.8 samples/s | 25.7 steps/s
[Step= 300] | Loss=0.77253 | acc=0.7657 | tpr=0.9920 | fpr=0.2384 | 6583.5 samples/s | 25.7 steps/s
[Step= 350] | Loss=0.77590 | acc=0.7658 | tpr=0.9912 | fpr=0.2383 | 6729.3 samples/s | 26.3 steps/s
[Step= 400] | Loss=0.77595 | acc=0.7658 | tpr=0.9912 | fpr=0.2383 | 6689.1 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.77795 | acc=0.7660 | tpr=0.9912 | fpr=0.2381 | 6754.7 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.77766 | acc=0.7658 | tpr=0.9912 | fpr=0.2383 | 6768.6 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.77665 | acc=0.7659 | tpr=0.9912 | fpr=0.2382 | 12114.4 samples/s | 47.3 steps/s
Avg test loss: 0.77615, Avg test acc: 0.76590, Avg tpr: 0.99128, Avg fpr: 0.23820, total FA: 33073

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=31.2] | Loss=0.16322 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.503 | L2-Norm(final)=2.901 | 3750.1 samples/s | 58.6 steps/s
[Step=32050 Epoch=31.3] | Loss=0.01847 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.496 | L2-Norm(final)=2.901 | 3417.3 samples/s | 53.4 steps/s
[Step=32100 Epoch=31.3] | Loss=0.01316 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.496 | L2-Norm(final)=2.902 | 3421.6 samples/s | 53.5 steps/s
[Step=32150 Epoch=31.4] | Loss=0.01123 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.496 | L2-Norm(final)=2.903 | 3425.8 samples/s | 53.5 steps/s
[Step=32200 Epoch=31.4] | Loss=0.01055 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.496 | L2-Norm(final)=2.904 | 3431.3 samples/s | 53.6 steps/s
[Step=32250 Epoch=31.5] | Loss=0.00963 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.496 | L2-Norm(final)=2.905 | 3433.1 samples/s | 53.6 steps/s
[Step=32300 Epoch=31.5] | Loss=0.00970 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.496 | L2-Norm(final)=2.905 | 3448.9 samples/s | 53.9 steps/s
[Step=32350 Epoch=31.6] | Loss=0.00949 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.496 | L2-Norm(final)=2.906 | 3450.9 samples/s | 53.9 steps/s
[Step=32400 Epoch=31.6] | Loss=0.00943 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.497 | L2-Norm(final)=2.907 | 3394.2 samples/s | 53.0 steps/s
[Step=32450 Epoch=31.7] | Loss=0.00938 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.497 | L2-Norm(final)=2.908 | 3101.7 samples/s | 48.5 steps/s
[Step=32500 Epoch=31.7] | Loss=0.00935 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.497 | L2-Norm(final)=2.908 | 3071.8 samples/s | 48.0 steps/s
[Step=32550 Epoch=31.8] | Loss=0.00926 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.497 | L2-Norm(final)=2.909 | 3345.0 samples/s | 52.3 steps/s
[Step=32600 Epoch=31.8] | Loss=0.00925 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.497 | L2-Norm(final)=2.910 | 3359.3 samples/s | 52.5 steps/s
[Step=32650 Epoch=31.9] | Loss=0.00908 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.498 | L2-Norm(final)=2.910 | 3346.3 samples/s | 52.3 steps/s
[Step=32700 Epoch=31.9] | Loss=0.00897 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.498 | L2-Norm(final)=2.911 | 3428.8 samples/s | 53.6 steps/s
[Step=32750 Epoch=32.0] | Loss=0.00883 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.498 | L2-Norm(final)=2.911 | 3450.2 samples/s | 53.9 steps/s
[Step=32800 Epoch=32.0] | Loss=0.00884 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.498 | L2-Norm(final)=2.912 | 3461.5 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step32800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=60.3] | Loss=0.24725 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.503 | L2-Norm(final)=2.901 | 3746.3 samples/s | 58.5 steps/s
[Step=32050 Epoch=60.4] | Loss=0.01618 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.497 | L2-Norm(final)=2.901 | 3190.4 samples/s | 49.8 steps/s
[Step=32100 Epoch=60.5] | Loss=0.00813 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.495 | L2-Norm(final)=2.901 | 3262.1 samples/s | 51.0 steps/s
[Step=32150 Epoch=60.6] | Loss=0.00548 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.494 | L2-Norm(final)=2.901 | 3261.2 samples/s | 51.0 steps/s
[Step=32200 Epoch=60.7] | Loss=0.00414 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.493 | L2-Norm(final)=2.901 | 3271.6 samples/s | 51.1 steps/s
[Step=32250 Epoch=60.8] | Loss=0.00333 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.493 | L2-Norm(final)=2.901 | 3287.6 samples/s | 51.4 steps/s
[Step=32300 Epoch=60.9] | Loss=0.00279 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.492 | L2-Norm(final)=2.901 | 3279.1 samples/s | 51.2 steps/s
[Step=32350 Epoch=61.0] | Loss=0.00240 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.492 | L2-Norm(final)=2.901 | 3291.3 samples/s | 51.4 steps/s
[Step=32400 Epoch=61.1] | Loss=0.00211 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.492 | L2-Norm(final)=2.901 | 3280.0 samples/s | 51.2 steps/s
[Step=32450 Epoch=61.2] | Loss=0.00188 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.491 | L2-Norm(final)=2.901 | 3294.2 samples/s | 51.5 steps/s
[Step=32500 Epoch=61.3] | Loss=0.00170 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.491 | L2-Norm(final)=2.901 | 3314.6 samples/s | 51.8 steps/s
[Step=32550 Epoch=61.4] | Loss=0.00155 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.491 | L2-Norm(final)=2.901 | 1720.9 samples/s | 26.9 steps/s
[Step=32600 Epoch=61.5] | Loss=0.00142 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.491 | L2-Norm(final)=2.901 | 3279.3 samples/s | 51.2 steps/s
[Step=32650 Epoch=61.5] | Loss=0.00132 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.490 | L2-Norm(final)=2.901 | 3289.2 samples/s | 51.4 steps/s
[Step=32700 Epoch=61.6] | Loss=0.00123 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.490 | L2-Norm(final)=2.901 | 3290.4 samples/s | 51.4 steps/s
[Step=32750 Epoch=61.7] | Loss=0.00115 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.490 | L2-Norm(final)=2.901 | 3284.4 samples/s | 51.3 steps/s
[Step=32800 Epoch=61.8] | Loss=0.00108 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.490 | L2-Norm(final)=2.902 | 3313.5 samples/s | 51.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22435 | acc=0.8709 | tpr=0.8183 | fpr=0.0151 | 3730.2 samples/s | 14.6 steps/s
Avg test loss: 0.23375, Avg test acc: 0.86826, Avg tpr: 0.81553, Avg fpr: 0.01577, total FA: 123

Testing server on iccad2012
[Step=  50] | Loss=0.79346 | acc=0.7523 | tpr=0.9956 | fpr=0.2521 | 3661.3 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.79836 | acc=0.7566 | tpr=0.9936 | fpr=0.2478 | 6997.2 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.80667 | acc=0.7562 | tpr=0.9942 | fpr=0.2482 | 6884.8 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.80801 | acc=0.7575 | tpr=0.9934 | fpr=0.2468 | 6616.7 samples/s | 25.8 steps/s
[Step= 250] | Loss=0.81494 | acc=0.7554 | tpr=0.9930 | fpr=0.2490 | 6884.3 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.81382 | acc=0.7565 | tpr=0.9913 | fpr=0.2478 | 6831.4 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.81717 | acc=0.7568 | tpr=0.9906 | fpr=0.2475 | 6781.4 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.81723 | acc=0.7569 | tpr=0.9907 | fpr=0.2474 | 6829.2 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.81919 | acc=0.7571 | tpr=0.9912 | fpr=0.2471 | 6636.4 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.81908 | acc=0.7570 | tpr=0.9912 | fpr=0.2473 | 7144.2 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.81811 | acc=0.7571 | tpr=0.9912 | fpr=0.2472 | 11517.7 samples/s | 45.0 steps/s
Avg test loss: 0.81761, Avg test acc: 0.75714, Avg tpr: 0.99128, Avg fpr: 0.24711, total FA: 34311

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=32.0] | Loss=0.12187 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.493 | L2-Norm(final)=2.911 | 4064.1 samples/s | 63.5 steps/s
[Step=32850 Epoch=32.1] | Loss=0.01821 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.488 | L2-Norm(final)=2.911 | 3266.1 samples/s | 51.0 steps/s
[Step=32900 Epoch=32.1] | Loss=0.01305 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.487 | L2-Norm(final)=2.912 | 3441.8 samples/s | 53.8 steps/s
[Step=32950 Epoch=32.2] | Loss=0.01143 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.487 | L2-Norm(final)=2.913 | 3455.4 samples/s | 54.0 steps/s
[Step=33000 Epoch=32.2] | Loss=0.01038 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.487 | L2-Norm(final)=2.914 | 3454.6 samples/s | 54.0 steps/s
[Step=33050 Epoch=32.3] | Loss=0.00972 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.487 | L2-Norm(final)=2.915 | 3458.0 samples/s | 54.0 steps/s
[Step=33100 Epoch=32.3] | Loss=0.00925 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.487 | L2-Norm(final)=2.915 | 3468.5 samples/s | 54.2 steps/s
[Step=33150 Epoch=32.4] | Loss=0.00913 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.488 | L2-Norm(final)=2.916 | 3462.6 samples/s | 54.1 steps/s
[Step=33200 Epoch=32.4] | Loss=0.00882 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.488 | L2-Norm(final)=2.917 | 3453.0 samples/s | 54.0 steps/s
[Step=33250 Epoch=32.5] | Loss=0.00884 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.488 | L2-Norm(final)=2.917 | 3466.9 samples/s | 54.2 steps/s
[Step=33300 Epoch=32.5] | Loss=0.00871 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.488 | L2-Norm(final)=2.918 | 3443.5 samples/s | 53.8 steps/s
[Step=33350 Epoch=32.6] | Loss=0.00867 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.488 | L2-Norm(final)=2.918 | 3454.5 samples/s | 54.0 steps/s
[Step=33400 Epoch=32.6] | Loss=0.00858 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.488 | L2-Norm(final)=2.919 | 3451.3 samples/s | 53.9 steps/s
[Step=33450 Epoch=32.7] | Loss=0.00845 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.489 | L2-Norm(final)=2.920 | 3460.8 samples/s | 54.1 steps/s
[Step=33500 Epoch=32.7] | Loss=0.00842 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.489 | L2-Norm(final)=2.920 | 3433.5 samples/s | 53.6 steps/s
[Step=33550 Epoch=32.8] | Loss=0.00844 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.489 | L2-Norm(final)=2.921 | 3445.0 samples/s | 53.8 steps/s
[Step=33600 Epoch=32.8] | Loss=0.00845 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.489 | L2-Norm(final)=2.921 | 3454.5 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step33600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=61.8] | Loss=0.00676 | Reg=0.00380 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.493 | L2-Norm(final)=2.911 | 4024.2 samples/s | 62.9 steps/s
[Step=32850 Epoch=61.9] | Loss=0.01477 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.488 | L2-Norm(final)=2.911 | 3043.5 samples/s | 47.6 steps/s
[Step=32900 Epoch=62.0] | Loss=0.00745 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.486 | L2-Norm(final)=2.911 | 3279.2 samples/s | 51.2 steps/s
[Step=32950 Epoch=62.1] | Loss=0.00500 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.485 | L2-Norm(final)=2.911 | 3270.0 samples/s | 51.1 steps/s
[Step=33000 Epoch=62.2] | Loss=0.00377 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.485 | L2-Norm(final)=2.911 | 3244.9 samples/s | 50.7 steps/s
[Step=33050 Epoch=62.3] | Loss=0.00303 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.484 | L2-Norm(final)=2.911 | 3282.3 samples/s | 51.3 steps/s
[Step=33100 Epoch=62.4] | Loss=0.00253 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.484 | L2-Norm(final)=2.911 | 3298.1 samples/s | 51.5 steps/s
[Step=33150 Epoch=62.5] | Loss=0.00218 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.483 | L2-Norm(final)=2.911 | 3280.0 samples/s | 51.2 steps/s
[Step=33200 Epoch=62.6] | Loss=0.00191 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.483 | L2-Norm(final)=2.911 | 3273.4 samples/s | 51.1 steps/s
[Step=33250 Epoch=62.7] | Loss=0.00171 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.483 | L2-Norm(final)=2.911 | 3280.7 samples/s | 51.3 steps/s
[Step=33300 Epoch=62.8] | Loss=0.00154 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.482 | L2-Norm(final)=2.911 | 3305.6 samples/s | 51.7 steps/s
[Step=33350 Epoch=62.9] | Loss=0.00140 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.482 | L2-Norm(final)=2.911 | 1737.4 samples/s | 27.1 steps/s
[Step=33400 Epoch=63.0] | Loss=0.00129 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.482 | L2-Norm(final)=2.911 | 3290.7 samples/s | 51.4 steps/s
[Step=33450 Epoch=63.1] | Loss=0.00120 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.482 | L2-Norm(final)=2.911 | 3268.6 samples/s | 51.1 steps/s
[Step=33500 Epoch=63.1] | Loss=0.00111 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.482 | L2-Norm(final)=2.911 | 3274.5 samples/s | 51.2 steps/s
[Step=33550 Epoch=63.2] | Loss=0.00104 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.481 | L2-Norm(final)=2.911 | 3255.0 samples/s | 50.9 steps/s
[Step=33600 Epoch=63.3] | Loss=0.00098 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.481 | L2-Norm(final)=2.911 | 3270.6 samples/s | 51.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24242 | acc=0.8638 | tpr=0.8077 | fpr=0.0146 | 3676.9 samples/s | 14.4 steps/s
Avg test loss: 0.25132, Avg test acc: 0.86201, Avg tpr: 0.80620, Avg fpr: 0.01525, total FA: 119

Testing server on iccad2012
[Step=  50] | Loss=0.76802 | acc=0.7622 | tpr=0.9956 | fpr=0.2420 | 3730.6 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.77240 | acc=0.7676 | tpr=0.9936 | fpr=0.2366 | 6744.6 samples/s | 26.3 steps/s
[Step= 150] | Loss=0.78111 | acc=0.7672 | tpr=0.9942 | fpr=0.2369 | 6704.4 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.78277 | acc=0.7687 | tpr=0.9934 | fpr=0.2354 | 6775.9 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.78978 | acc=0.7666 | tpr=0.9930 | fpr=0.2375 | 6777.6 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.78903 | acc=0.7680 | tpr=0.9913 | fpr=0.2361 | 7000.3 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.79275 | acc=0.7681 | tpr=0.9906 | fpr=0.2359 | 6727.9 samples/s | 26.3 steps/s
[Step= 400] | Loss=0.79285 | acc=0.7683 | tpr=0.9907 | fpr=0.2358 | 6700.2 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.79478 | acc=0.7686 | tpr=0.9912 | fpr=0.2355 | 6677.1 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.79436 | acc=0.7684 | tpr=0.9912 | fpr=0.2356 | 6710.8 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.79314 | acc=0.7686 | tpr=0.9912 | fpr=0.2354 | 12557.9 samples/s | 49.1 steps/s
Avg test loss: 0.79263, Avg test acc: 0.76870, Avg tpr: 0.99128, Avg fpr: 0.23534, total FA: 32677

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=32.8] | Loss=0.16257 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.484 | L2-Norm(final)=2.921 | 3769.6 samples/s | 58.9 steps/s
[Step=33650 Epoch=32.9] | Loss=0.01962 | Reg=0.00379 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.478 | L2-Norm(final)=2.920 | 3385.7 samples/s | 52.9 steps/s
[Step=33700 Epoch=32.9] | Loss=0.01327 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.478 | L2-Norm(final)=2.921 | 3445.8 samples/s | 53.8 steps/s
[Step=33750 Epoch=33.0] | Loss=0.01094 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.478 | L2-Norm(final)=2.922 | 3449.6 samples/s | 53.9 steps/s
[Step=33800 Epoch=33.0] | Loss=0.01007 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.478 | L2-Norm(final)=2.922 | 3446.1 samples/s | 53.8 steps/s
[Step=33850 Epoch=33.0] | Loss=0.00960 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.478 | L2-Norm(final)=2.923 | 3460.2 samples/s | 54.1 steps/s
[Step=33900 Epoch=33.1] | Loss=0.00952 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.478 | L2-Norm(final)=2.924 | 3463.3 samples/s | 54.1 steps/s
[Step=33950 Epoch=33.1] | Loss=0.00927 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.478 | L2-Norm(final)=2.925 | 3429.0 samples/s | 53.6 steps/s
[Step=34000 Epoch=33.2] | Loss=0.00908 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.478 | L2-Norm(final)=2.925 | 3442.5 samples/s | 53.8 steps/s
[Step=34050 Epoch=33.2] | Loss=0.00897 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.479 | L2-Norm(final)=2.926 | 3441.0 samples/s | 53.8 steps/s
[Step=34100 Epoch=33.3] | Loss=0.00873 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.479 | L2-Norm(final)=2.927 | 3444.3 samples/s | 53.8 steps/s
[Step=34150 Epoch=33.3] | Loss=0.00859 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.479 | L2-Norm(final)=2.927 | 3446.1 samples/s | 53.8 steps/s
[Step=34200 Epoch=33.4] | Loss=0.00861 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.479 | L2-Norm(final)=2.928 | 3433.9 samples/s | 53.7 steps/s
[Step=34250 Epoch=33.4] | Loss=0.00862 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.479 | L2-Norm(final)=2.928 | 3442.3 samples/s | 53.8 steps/s
[Step=34300 Epoch=33.5] | Loss=0.00851 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.480 | L2-Norm(final)=2.929 | 3469.8 samples/s | 54.2 steps/s
[Step=34350 Epoch=33.5] | Loss=0.00850 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.480 | L2-Norm(final)=2.929 | 3453.7 samples/s | 54.0 steps/s
[Step=34400 Epoch=33.6] | Loss=0.00846 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.480 | L2-Norm(final)=2.930 | 3459.8 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step34400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=63.3] | Loss=0.30688 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.484 | L2-Norm(final)=2.921 | 3682.3 samples/s | 57.5 steps/s
[Step=33650 Epoch=63.4] | Loss=0.02043 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.477 | L2-Norm(final)=2.919 | 3211.4 samples/s | 50.2 steps/s
[Step=33700 Epoch=63.5] | Loss=0.01027 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.475 | L2-Norm(final)=2.918 | 3282.9 samples/s | 51.3 steps/s
[Step=33750 Epoch=63.6] | Loss=0.00689 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.474 | L2-Norm(final)=2.918 | 3263.4 samples/s | 51.0 steps/s
[Step=33800 Epoch=63.7] | Loss=0.00518 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.473 | L2-Norm(final)=2.918 | 3283.6 samples/s | 51.3 steps/s
[Step=33850 Epoch=63.8] | Loss=0.00416 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.473 | L2-Norm(final)=2.918 | 3303.2 samples/s | 51.6 steps/s
[Step=33900 Epoch=63.9] | Loss=0.00347 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.472 | L2-Norm(final)=2.919 | 3273.9 samples/s | 51.2 steps/s
[Step=33950 Epoch=64.0] | Loss=0.00298 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.472 | L2-Norm(final)=2.919 | 3304.8 samples/s | 51.6 steps/s
[Step=34000 Epoch=64.1] | Loss=0.00262 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.472 | L2-Norm(final)=2.919 | 3311.0 samples/s | 51.7 steps/s
[Step=34050 Epoch=64.2] | Loss=0.00233 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.471 | L2-Norm(final)=2.919 | 3299.1 samples/s | 51.5 steps/s
[Step=34100 Epoch=64.3] | Loss=0.00210 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.471 | L2-Norm(final)=2.919 | 3324.1 samples/s | 51.9 steps/s
[Step=34150 Epoch=64.4] | Loss=0.00192 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.471 | L2-Norm(final)=2.919 | 1735.9 samples/s | 27.1 steps/s
[Step=34200 Epoch=64.5] | Loss=0.00176 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.471 | L2-Norm(final)=2.919 | 3284.8 samples/s | 51.3 steps/s
[Step=34250 Epoch=64.6] | Loss=0.00163 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.471 | L2-Norm(final)=2.919 | 3290.9 samples/s | 51.4 steps/s
[Step=34300 Epoch=64.7] | Loss=0.00151 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.470 | L2-Norm(final)=2.919 | 3289.5 samples/s | 51.4 steps/s
[Step=34350 Epoch=64.8] | Loss=0.00141 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.470 | L2-Norm(final)=2.919 | 3282.3 samples/s | 51.3 steps/s
[Step=34400 Epoch=64.8] | Loss=0.00133 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.470 | L2-Norm(final)=2.919 | 3296.6 samples/s | 51.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23055 | acc=0.8708 | tpr=0.8177 | fpr=0.0139 | 3626.6 samples/s | 14.2 steps/s
Avg test loss: 0.23972, Avg test acc: 0.86826, Avg tpr: 0.81500, Avg fpr: 0.01461, total FA: 114

Testing server on iccad2012
[Step=  50] | Loss=0.77960 | acc=0.7620 | tpr=0.9956 | fpr=0.2422 | 3691.3 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.78381 | acc=0.7674 | tpr=0.9936 | fpr=0.2368 | 6810.8 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.79259 | acc=0.7671 | tpr=0.9942 | fpr=0.2371 | 6849.2 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.79420 | acc=0.7682 | tpr=0.9934 | fpr=0.2359 | 6814.6 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.80116 | acc=0.7660 | tpr=0.9930 | fpr=0.2382 | 7013.5 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.80020 | acc=0.7673 | tpr=0.9913 | fpr=0.2368 | 6626.6 samples/s | 25.9 steps/s
[Step= 350] | Loss=0.80408 | acc=0.7674 | tpr=0.9906 | fpr=0.2367 | 6825.9 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.80415 | acc=0.7675 | tpr=0.9907 | fpr=0.2365 | 6704.7 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.80617 | acc=0.7678 | tpr=0.9912 | fpr=0.2362 | 6929.6 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.80573 | acc=0.7677 | tpr=0.9912 | fpr=0.2363 | 6594.7 samples/s | 25.8 steps/s
[Step= 550] | Loss=0.80459 | acc=0.7678 | tpr=0.9912 | fpr=0.2363 | 12578.8 samples/s | 49.1 steps/s
Avg test loss: 0.80407, Avg test acc: 0.76787, Avg tpr: 0.99128, Avg fpr: 0.23619, total FA: 32795

server round 43/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=33.6] | Loss=0.10182 | Reg=0.00379 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.475 | L2-Norm(final)=2.929 | 3825.4 samples/s | 59.8 steps/s
[Step=34450 Epoch=33.6] | Loss=0.01925 | Reg=0.00379 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.469 | L2-Norm(final)=2.929 | 3410.8 samples/s | 53.3 steps/s
[Step=34500 Epoch=33.7] | Loss=0.01297 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.469 | L2-Norm(final)=2.929 | 3411.5 samples/s | 53.3 steps/s
[Step=34550 Epoch=33.7] | Loss=0.01150 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.469 | L2-Norm(final)=2.930 | 3411.9 samples/s | 53.3 steps/s
[Step=34600 Epoch=33.8] | Loss=0.01064 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.469 | L2-Norm(final)=2.931 | 3417.6 samples/s | 53.4 steps/s
[Step=34650 Epoch=33.8] | Loss=0.01030 | Reg=0.00379 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.469 | L2-Norm(final)=2.932 | 3434.6 samples/s | 53.7 steps/s
[Step=34700 Epoch=33.9] | Loss=0.00990 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.469 | L2-Norm(final)=2.932 | 3461.5 samples/s | 54.1 steps/s
[Step=34750 Epoch=33.9] | Loss=0.00979 | Reg=0.00379 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.469 | L2-Norm(final)=2.933 | 3438.2 samples/s | 53.7 steps/s
[Step=34800 Epoch=34.0] | Loss=0.00941 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=19.470 | L2-Norm(final)=2.934 | 3425.1 samples/s | 53.5 steps/s
[Step=34850 Epoch=34.0] | Loss=0.00931 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.470 | L2-Norm(final)=2.934 | 3437.7 samples/s | 53.7 steps/s
[Step=34900 Epoch=34.1] | Loss=0.00901 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.470 | L2-Norm(final)=2.935 | 3429.8 samples/s | 53.6 steps/s
[Step=34950 Epoch=34.1] | Loss=0.00884 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.470 | L2-Norm(final)=2.936 | 3447.0 samples/s | 53.9 steps/s
[Step=35000 Epoch=34.2] | Loss=0.00863 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.470 | L2-Norm(final)=2.936 | 3447.9 samples/s | 53.9 steps/s
[Step=35050 Epoch=34.2] | Loss=0.00852 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.470 | L2-Norm(final)=2.937 | 3467.3 samples/s | 54.2 steps/s
[Step=35100 Epoch=34.3] | Loss=0.00859 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.471 | L2-Norm(final)=2.937 | 3462.9 samples/s | 54.1 steps/s
[Step=35150 Epoch=34.3] | Loss=0.00854 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=19.471 | L2-Norm(final)=2.938 | 3445.7 samples/s | 53.8 steps/s
[Step=35200 Epoch=34.4] | Loss=0.00852 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.471 | L2-Norm(final)=2.938 | 3439.7 samples/s | 53.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step35200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=64.8] | Loss=0.19916 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.475 | L2-Norm(final)=2.929 | 3957.1 samples/s | 61.8 steps/s
[Step=34450 Epoch=64.9] | Loss=0.01448 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.469 | L2-Norm(final)=2.930 | 3110.4 samples/s | 48.6 steps/s
[Step=34500 Epoch=65.0] | Loss=0.00728 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.467 | L2-Norm(final)=2.929 | 3246.4 samples/s | 50.7 steps/s
[Step=34550 Epoch=65.1] | Loss=0.00487 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.466 | L2-Norm(final)=2.929 | 3250.1 samples/s | 50.8 steps/s
[Step=34600 Epoch=65.2] | Loss=0.00368 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.465 | L2-Norm(final)=2.929 | 3258.5 samples/s | 50.9 steps/s
[Step=34650 Epoch=65.3] | Loss=0.00295 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.464 | L2-Norm(final)=2.929 | 3254.7 samples/s | 50.9 steps/s
[Step=34700 Epoch=65.4] | Loss=0.00247 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.464 | L2-Norm(final)=2.929 | 3264.0 samples/s | 51.0 steps/s
[Step=34750 Epoch=65.5] | Loss=0.00213 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.464 | L2-Norm(final)=2.929 | 3291.3 samples/s | 51.4 steps/s
[Step=34800 Epoch=65.6] | Loss=0.00187 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.463 | L2-Norm(final)=2.929 | 3277.3 samples/s | 51.2 steps/s
[Step=34850 Epoch=65.7] | Loss=0.00167 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.463 | L2-Norm(final)=2.930 | 3290.6 samples/s | 51.4 steps/s
[Step=34900 Epoch=65.8] | Loss=0.00150 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.463 | L2-Norm(final)=2.930 | 3311.5 samples/s | 51.7 steps/s
[Step=34950 Epoch=65.9] | Loss=0.00137 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.462 | L2-Norm(final)=2.930 | 1722.6 samples/s | 26.9 steps/s
[Step=35000 Epoch=66.0] | Loss=0.00126 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.462 | L2-Norm(final)=2.930 | 3303.6 samples/s | 51.6 steps/s
[Step=35050 Epoch=66.1] | Loss=0.00117 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.462 | L2-Norm(final)=2.930 | 3267.2 samples/s | 51.0 steps/s
[Step=35100 Epoch=66.2] | Loss=0.00109 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.462 | L2-Norm(final)=2.930 | 3273.5 samples/s | 51.1 steps/s
[Step=35150 Epoch=66.3] | Loss=0.00102 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.462 | L2-Norm(final)=2.930 | 3256.3 samples/s | 50.9 steps/s
[Step=35200 Epoch=66.4] | Loss=0.00096 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.462 | L2-Norm(final)=2.930 | 3280.1 samples/s | 51.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23946 | acc=0.8676 | tpr=0.8125 | fpr=0.0129 | 3687.7 samples/s | 14.4 steps/s
Avg test loss: 0.24937, Avg test acc: 0.86581, Avg tpr: 0.81116, Avg fpr: 0.01397, total FA: 109

Testing server on iccad2012
[Step=  50] | Loss=0.78456 | acc=0.7629 | tpr=0.9912 | fpr=0.2412 | 3711.4 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.78857 | acc=0.7677 | tpr=0.9915 | fpr=0.2365 | 6815.1 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.79683 | acc=0.7672 | tpr=0.9914 | fpr=0.2369 | 6712.2 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.79863 | acc=0.7682 | tpr=0.9913 | fpr=0.2358 | 6930.5 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.80583 | acc=0.7662 | tpr=0.9913 | fpr=0.2378 | 6785.2 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.80492 | acc=0.7676 | tpr=0.9898 | fpr=0.2365 | 6738.4 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.80866 | acc=0.7676 | tpr=0.9894 | fpr=0.2364 | 6685.8 samples/s | 26.1 steps/s
[Step= 400] | Loss=0.80883 | acc=0.7678 | tpr=0.9896 | fpr=0.2362 | 6826.1 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.81091 | acc=0.7682 | tpr=0.9903 | fpr=0.2358 | 6623.6 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.81051 | acc=0.7680 | tpr=0.9903 | fpr=0.2360 | 6758.5 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.80938 | acc=0.7682 | tpr=0.9904 | fpr=0.2359 | 12727.9 samples/s | 49.7 steps/s
Avg test loss: 0.80889, Avg test acc: 0.76826, Avg tpr: 0.99049, Avg fpr: 0.23578, total FA: 32738

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=34.4] | Loss=0.11574 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.465 | L2-Norm(final)=2.938 | 4179.7 samples/s | 65.3 steps/s
[Step=35250 Epoch=34.4] | Loss=0.01960 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.460 | L2-Norm(final)=2.938 | 3164.6 samples/s | 49.4 steps/s
[Step=35300 Epoch=34.5] | Loss=0.01310 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.459 | L2-Norm(final)=2.938 | 3443.5 samples/s | 53.8 steps/s
[Step=35350 Epoch=34.5] | Loss=0.01119 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.459 | L2-Norm(final)=2.939 | 3372.2 samples/s | 52.7 steps/s
[Step=35400 Epoch=34.6] | Loss=0.01046 | Reg=0.00379 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.459 | L2-Norm(final)=2.940 | 3361.0 samples/s | 52.5 steps/s
[Step=35450 Epoch=34.6] | Loss=0.00985 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.459 | L2-Norm(final)=2.940 | 3407.3 samples/s | 53.2 steps/s
[Step=35500 Epoch=34.7] | Loss=0.00932 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.459 | L2-Norm(final)=2.941 | 3401.3 samples/s | 53.1 steps/s
[Step=35550 Epoch=34.7] | Loss=0.00903 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.460 | L2-Norm(final)=2.942 | 3338.4 samples/s | 52.2 steps/s
[Step=35600 Epoch=34.8] | Loss=0.00876 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.460 | L2-Norm(final)=2.943 | 3354.6 samples/s | 52.4 steps/s
[Step=35650 Epoch=34.8] | Loss=0.00855 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.460 | L2-Norm(final)=2.943 | 3351.8 samples/s | 52.4 steps/s
[Step=35700 Epoch=34.9] | Loss=0.00845 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.460 | L2-Norm(final)=2.944 | 3383.5 samples/s | 52.9 steps/s
[Step=35750 Epoch=34.9] | Loss=0.00829 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.460 | L2-Norm(final)=2.944 | 3421.3 samples/s | 53.5 steps/s
[Step=35800 Epoch=35.0] | Loss=0.00817 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.460 | L2-Norm(final)=2.945 | 3434.4 samples/s | 53.7 steps/s
[Step=35850 Epoch=35.0] | Loss=0.00835 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.461 | L2-Norm(final)=2.945 | 3447.9 samples/s | 53.9 steps/s
[Step=35900 Epoch=35.1] | Loss=0.00826 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.461 | L2-Norm(final)=2.946 | 3452.9 samples/s | 54.0 steps/s
[Step=35950 Epoch=35.1] | Loss=0.00825 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=19.461 | L2-Norm(final)=2.947 | 3451.9 samples/s | 53.9 steps/s
[Step=36000 Epoch=35.1] | Loss=0.00826 | Reg=0.00379 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.461 | L2-Norm(final)=2.947 | 3446.0 samples/s | 53.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step36000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=66.4] | Loss=0.10941 | Reg=0.00379 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.465 | L2-Norm(final)=2.938 | 3746.2 samples/s | 58.5 steps/s
[Step=35250 Epoch=66.4] | Loss=0.01358 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.459 | L2-Norm(final)=2.938 | 3199.2 samples/s | 50.0 steps/s
[Step=35300 Epoch=66.5] | Loss=0.00683 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.458 | L2-Norm(final)=2.937 | 3271.8 samples/s | 51.1 steps/s
[Step=35350 Epoch=66.6] | Loss=0.00459 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.457 | L2-Norm(final)=2.937 | 3282.9 samples/s | 51.3 steps/s
[Step=35400 Epoch=66.7] | Loss=0.00346 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.456 | L2-Norm(final)=2.937 | 3298.9 samples/s | 51.5 steps/s
[Step=35450 Epoch=66.8] | Loss=0.00277 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.455 | L2-Norm(final)=2.937 | 3299.5 samples/s | 51.6 steps/s
[Step=35500 Epoch=66.9] | Loss=0.00232 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.455 | L2-Norm(final)=2.937 | 3295.9 samples/s | 51.5 steps/s
[Step=35550 Epoch=67.0] | Loss=0.00200 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.455 | L2-Norm(final)=2.938 | 3250.4 samples/s | 50.8 steps/s
[Step=35600 Epoch=67.1] | Loss=0.00176 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.454 | L2-Norm(final)=2.938 | 3291.7 samples/s | 51.4 steps/s
[Step=35650 Epoch=67.2] | Loss=0.00157 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.454 | L2-Norm(final)=2.938 | 3313.1 samples/s | 51.8 steps/s
[Step=35700 Epoch=67.3] | Loss=0.00142 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.454 | L2-Norm(final)=2.938 | 3325.9 samples/s | 52.0 steps/s
[Step=35750 Epoch=67.4] | Loss=0.00129 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.454 | L2-Norm(final)=2.938 | 1702.2 samples/s | 26.6 steps/s
[Step=35800 Epoch=67.5] | Loss=0.00119 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.453 | L2-Norm(final)=2.938 | 3288.5 samples/s | 51.4 steps/s
[Step=35850 Epoch=67.6] | Loss=0.00110 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.453 | L2-Norm(final)=2.938 | 3268.4 samples/s | 51.1 steps/s
[Step=35900 Epoch=67.7] | Loss=0.00102 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.453 | L2-Norm(final)=2.938 | 3272.0 samples/s | 51.1 steps/s
[Step=35950 Epoch=67.8] | Loss=0.00096 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.453 | L2-Norm(final)=2.938 | 3249.5 samples/s | 50.8 steps/s
[Step=36000 Epoch=67.9] | Loss=0.00090 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.453 | L2-Norm(final)=2.938 | 3290.8 samples/s | 51.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22764 | acc=0.8738 | tpr=0.8225 | fpr=0.0149 | 3584.8 samples/s | 14.0 steps/s
Avg test loss: 0.23684, Avg test acc: 0.87102, Avg tpr: 0.81990, Avg fpr: 0.01654, total FA: 129

Testing server on iccad2012
[Step=  50] | Loss=0.78663 | acc=0.7655 | tpr=0.9956 | fpr=0.2387 | 3267.9 samples/s | 12.8 steps/s
[Step= 100] | Loss=0.79138 | acc=0.7717 | tpr=0.9957 | fpr=0.2325 | 6534.4 samples/s | 25.5 steps/s
[Step= 150] | Loss=0.80038 | acc=0.7711 | tpr=0.9942 | fpr=0.2330 | 7123.1 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.80229 | acc=0.7723 | tpr=0.9934 | fpr=0.2317 | 6990.0 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.80907 | acc=0.7703 | tpr=0.9939 | fpr=0.2338 | 7342.4 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.80831 | acc=0.7719 | tpr=0.9920 | fpr=0.2321 | 7221.9 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.81218 | acc=0.7719 | tpr=0.9912 | fpr=0.2321 | 6771.9 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.81244 | acc=0.7720 | tpr=0.9918 | fpr=0.2320 | 7150.5 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.81465 | acc=0.7723 | tpr=0.9922 | fpr=0.2317 | 6909.3 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.81417 | acc=0.7722 | tpr=0.9921 | fpr=0.2318 | 6931.3 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.81298 | acc=0.7723 | tpr=0.9920 | fpr=0.2317 | 12080.7 samples/s | 47.2 steps/s
Avg test loss: 0.81244, Avg test acc: 0.77241, Avg tpr: 0.99208, Avg fpr: 0.23158, total FA: 32155

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=35.1] | Loss=0.10560 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.456 | L2-Norm(final)=2.947 | 4172.0 samples/s | 65.2 steps/s
[Step=36050 Epoch=35.2] | Loss=0.01547 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.451 | L2-Norm(final)=2.947 | 3212.2 samples/s | 50.2 steps/s
[Step=36100 Epoch=35.2] | Loss=0.01072 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.450 | L2-Norm(final)=2.948 | 3366.3 samples/s | 52.6 steps/s
[Step=36150 Epoch=35.3] | Loss=0.01029 | Reg=0.00378 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.450 | L2-Norm(final)=2.949 | 3323.1 samples/s | 51.9 steps/s
[Step=36200 Epoch=35.3] | Loss=0.00932 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.450 | L2-Norm(final)=2.950 | 3330.9 samples/s | 52.0 steps/s
[Step=36250 Epoch=35.4] | Loss=0.00894 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.450 | L2-Norm(final)=2.950 | 3384.7 samples/s | 52.9 steps/s
[Step=36300 Epoch=35.4] | Loss=0.00870 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.450 | L2-Norm(final)=2.951 | 3408.7 samples/s | 53.3 steps/s
[Step=36350 Epoch=35.5] | Loss=0.00853 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.451 | L2-Norm(final)=2.952 | 3423.2 samples/s | 53.5 steps/s
[Step=36400 Epoch=35.5] | Loss=0.00848 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.451 | L2-Norm(final)=2.952 | 3421.1 samples/s | 53.5 steps/s
[Step=36450 Epoch=35.6] | Loss=0.00835 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.451 | L2-Norm(final)=2.953 | 3425.7 samples/s | 53.5 steps/s
[Step=36500 Epoch=35.6] | Loss=0.00819 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.451 | L2-Norm(final)=2.953 | 3415.8 samples/s | 53.4 steps/s
[Step=36550 Epoch=35.7] | Loss=0.00820 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.451 | L2-Norm(final)=2.954 | 3434.4 samples/s | 53.7 steps/s
[Step=36600 Epoch=35.7] | Loss=0.00819 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.451 | L2-Norm(final)=2.954 | 3458.6 samples/s | 54.0 steps/s
[Step=36650 Epoch=35.8] | Loss=0.00817 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.452 | L2-Norm(final)=2.955 | 3450.7 samples/s | 53.9 steps/s
[Step=36700 Epoch=35.8] | Loss=0.00815 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.452 | L2-Norm(final)=2.955 | 3433.2 samples/s | 53.6 steps/s
[Step=36750 Epoch=35.9] | Loss=0.00808 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.452 | L2-Norm(final)=2.956 | 3428.3 samples/s | 53.6 steps/s
[Step=36800 Epoch=35.9] | Loss=0.00795 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.452 | L2-Norm(final)=2.956 | 3455.6 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step36800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=67.9] | Loss=0.03569 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=19.456 | L2-Norm(final)=2.947 | 3822.1 samples/s | 59.7 steps/s
[Step=36050 Epoch=68.0] | Loss=0.01255 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.451 | L2-Norm(final)=2.947 | 3106.4 samples/s | 48.5 steps/s
[Step=36100 Epoch=68.0] | Loss=0.00637 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.449 | L2-Norm(final)=2.947 | 3271.6 samples/s | 51.1 steps/s
[Step=36150 Epoch=68.1] | Loss=0.00426 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.448 | L2-Norm(final)=2.947 | 3273.8 samples/s | 51.2 steps/s
[Step=36200 Epoch=68.2] | Loss=0.00321 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.447 | L2-Norm(final)=2.947 | 3260.9 samples/s | 51.0 steps/s
[Step=36250 Epoch=68.3] | Loss=0.00257 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.446 | L2-Norm(final)=2.947 | 3277.9 samples/s | 51.2 steps/s
[Step=36300 Epoch=68.4] | Loss=0.00215 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.446 | L2-Norm(final)=2.947 | 3276.6 samples/s | 51.2 steps/s
[Step=36350 Epoch=68.5] | Loss=0.00185 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.446 | L2-Norm(final)=2.947 | 3259.1 samples/s | 50.9 steps/s
[Step=36400 Epoch=68.6] | Loss=0.00162 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.445 | L2-Norm(final)=2.947 | 3146.0 samples/s | 49.2 steps/s
[Step=36450 Epoch=68.7] | Loss=0.00145 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.445 | L2-Norm(final)=2.947 | 2935.1 samples/s | 45.9 steps/s
[Step=36500 Epoch=68.8] | Loss=0.00131 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.445 | L2-Norm(final)=2.947 | 3127.0 samples/s | 48.9 steps/s
[Step=36550 Epoch=68.9] | Loss=0.00119 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.444 | L2-Norm(final)=2.947 | 1702.6 samples/s | 26.6 steps/s
[Step=36600 Epoch=69.0] | Loss=0.00110 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.444 | L2-Norm(final)=2.947 | 3273.4 samples/s | 51.1 steps/s
[Step=36650 Epoch=69.1] | Loss=0.00102 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.444 | L2-Norm(final)=2.947 | 3238.1 samples/s | 50.6 steps/s
[Step=36700 Epoch=69.2] | Loss=0.00095 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.444 | L2-Norm(final)=2.947 | 3279.5 samples/s | 51.2 steps/s
[Step=36750 Epoch=69.3] | Loss=0.00089 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.444 | L2-Norm(final)=2.947 | 3271.3 samples/s | 51.1 steps/s
[Step=36800 Epoch=69.4] | Loss=0.00083 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.443 | L2-Norm(final)=2.947 | 3301.5 samples/s | 51.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25889 | acc=0.8627 | tpr=0.8052 | fpr=0.0124 | 3728.2 samples/s | 14.6 steps/s
Avg test loss: 0.26859, Avg test acc: 0.85944, Avg tpr: 0.80183, Avg fpr: 0.01384, total FA: 108

Testing server on iccad2012
[Step=  50] | Loss=0.72480 | acc=0.7834 | tpr=0.9912 | fpr=0.2203 | 3738.1 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.73129 | acc=0.7883 | tpr=0.9893 | fpr=0.2154 | 6709.4 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.74014 | acc=0.7879 | tpr=0.9914 | fpr=0.2158 | 6866.4 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.74196 | acc=0.7891 | tpr=0.9913 | fpr=0.2146 | 6882.7 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.74824 | acc=0.7868 | tpr=0.9913 | fpr=0.2169 | 6817.6 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.74790 | acc=0.7878 | tpr=0.9898 | fpr=0.2159 | 6838.8 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.75202 | acc=0.7875 | tpr=0.9894 | fpr=0.2162 | 6691.0 samples/s | 26.1 steps/s
[Step= 400] | Loss=0.75234 | acc=0.7876 | tpr=0.9896 | fpr=0.2160 | 6796.7 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.75450 | acc=0.7880 | tpr=0.9898 | fpr=0.2157 | 6714.7 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.75399 | acc=0.7878 | tpr=0.9899 | fpr=0.2158 | 6004.8 samples/s | 23.5 steps/s
[Step= 550] | Loss=0.75282 | acc=0.7880 | tpr=0.9901 | fpr=0.2156 | 8258.7 samples/s | 32.3 steps/s
Avg test loss: 0.75233, Avg test acc: 0.78811, Avg tpr: 0.99010, Avg fpr: 0.21557, total FA: 29931

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=35.9] | Loss=0.23306 | Reg=0.00378 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.447 | L2-Norm(final)=2.956 | 3783.0 samples/s | 59.1 steps/s
[Step=36850 Epoch=36.0] | Loss=0.02060 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.441 | L2-Norm(final)=2.955 | 3380.9 samples/s | 52.8 steps/s
[Step=36900 Epoch=36.0] | Loss=0.01331 | Reg=0.00378 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.441 | L2-Norm(final)=2.955 | 3428.9 samples/s | 53.6 steps/s
[Step=36950 Epoch=36.1] | Loss=0.01196 | Reg=0.00378 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.441 | L2-Norm(final)=2.956 | 3433.8 samples/s | 53.7 steps/s
[Step=37000 Epoch=36.1] | Loss=0.01082 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.441 | L2-Norm(final)=2.956 | 3425.9 samples/s | 53.5 steps/s
[Step=37050 Epoch=36.2] | Loss=0.01035 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.441 | L2-Norm(final)=2.957 | 3437.4 samples/s | 53.7 steps/s
[Step=37100 Epoch=36.2] | Loss=0.00972 | Reg=0.00378 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.441 | L2-Norm(final)=2.958 | 3428.6 samples/s | 53.6 steps/s
[Step=37150 Epoch=36.3] | Loss=0.00937 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.441 | L2-Norm(final)=2.958 | 3458.5 samples/s | 54.0 steps/s
[Step=37200 Epoch=36.3] | Loss=0.00898 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.441 | L2-Norm(final)=2.959 | 3420.5 samples/s | 53.4 steps/s
[Step=37250 Epoch=36.4] | Loss=0.00880 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.441 | L2-Norm(final)=2.960 | 3376.4 samples/s | 52.8 steps/s
[Step=37300 Epoch=36.4] | Loss=0.00857 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.441 | L2-Norm(final)=2.960 | 3447.3 samples/s | 53.9 steps/s
[Step=37350 Epoch=36.5] | Loss=0.00833 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.442 | L2-Norm(final)=2.961 | 3439.3 samples/s | 53.7 steps/s
[Step=37400 Epoch=36.5] | Loss=0.00817 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.442 | L2-Norm(final)=2.962 | 3459.7 samples/s | 54.1 steps/s
[Step=37450 Epoch=36.6] | Loss=0.00812 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.442 | L2-Norm(final)=2.962 | 3441.7 samples/s | 53.8 steps/s
[Step=37500 Epoch=36.6] | Loss=0.00806 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.442 | L2-Norm(final)=2.963 | 3447.3 samples/s | 53.9 steps/s
[Step=37550 Epoch=36.7] | Loss=0.00806 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.442 | L2-Norm(final)=2.963 | 3433.8 samples/s | 53.7 steps/s
[Step=37600 Epoch=36.7] | Loss=0.00807 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.443 | L2-Norm(final)=2.964 | 3447.4 samples/s | 53.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step37600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=69.4] | Loss=0.10820 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.447 | L2-Norm(final)=2.956 | 3903.5 samples/s | 61.0 steps/s
[Step=36850 Epoch=69.5] | Loss=0.01567 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.441 | L2-Norm(final)=2.955 | 3109.3 samples/s | 48.6 steps/s
[Step=36900 Epoch=69.6] | Loss=0.00787 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.439 | L2-Norm(final)=2.954 | 3292.5 samples/s | 51.4 steps/s
[Step=36950 Epoch=69.7] | Loss=0.00528 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.438 | L2-Norm(final)=2.954 | 3306.1 samples/s | 51.7 steps/s
[Step=37000 Epoch=69.7] | Loss=0.00398 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.437 | L2-Norm(final)=2.954 | 3313.4 samples/s | 51.8 steps/s
[Step=37050 Epoch=69.8] | Loss=0.00320 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.437 | L2-Norm(final)=2.954 | 3305.2 samples/s | 51.6 steps/s
[Step=37100 Epoch=69.9] | Loss=0.00267 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.437 | L2-Norm(final)=2.954 | 3293.0 samples/s | 51.5 steps/s
[Step=37150 Epoch=70.0] | Loss=0.00230 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.436 | L2-Norm(final)=2.954 | 3306.4 samples/s | 51.7 steps/s
[Step=37200 Epoch=70.1] | Loss=0.00202 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.436 | L2-Norm(final)=2.954 | 3304.6 samples/s | 51.6 steps/s
[Step=37250 Epoch=70.2] | Loss=0.00179 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.436 | L2-Norm(final)=2.954 | 3310.8 samples/s | 51.7 steps/s
[Step=37300 Epoch=70.3] | Loss=0.00162 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.435 | L2-Norm(final)=2.954 | 3349.1 samples/s | 52.3 steps/s
[Step=37350 Epoch=70.4] | Loss=0.00147 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.435 | L2-Norm(final)=2.954 | 1763.9 samples/s | 27.6 steps/s
[Step=37400 Epoch=70.5] | Loss=0.00135 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.435 | L2-Norm(final)=2.954 | 3284.0 samples/s | 51.3 steps/s
[Step=37450 Epoch=70.6] | Loss=0.00125 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.435 | L2-Norm(final)=2.955 | 3270.6 samples/s | 51.1 steps/s
[Step=37500 Epoch=70.7] | Loss=0.00116 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.435 | L2-Norm(final)=2.955 | 3274.5 samples/s | 51.2 steps/s
[Step=37550 Epoch=70.8] | Loss=0.00109 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.434 | L2-Norm(final)=2.955 | 3288.8 samples/s | 51.4 steps/s
[Step=37600 Epoch=70.9] | Loss=0.00102 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.434 | L2-Norm(final)=2.955 | 3296.1 samples/s | 51.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23287 | acc=0.8715 | tpr=0.8189 | fpr=0.0144 | 3731.7 samples/s | 14.6 steps/s
Avg test loss: 0.24277, Avg test acc: 0.86814, Avg tpr: 0.81541, Avg fpr: 0.01590, total FA: 124

Testing server on iccad2012
[Step=  50] | Loss=0.76018 | acc=0.7744 | tpr=0.9956 | fpr=0.2296 | 3676.2 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.76647 | acc=0.7795 | tpr=0.9936 | fpr=0.2245 | 7023.3 samples/s | 27.4 steps/s
[Step= 150] | Loss=0.77531 | acc=0.7789 | tpr=0.9928 | fpr=0.2250 | 6316.8 samples/s | 24.7 steps/s
[Step= 200] | Loss=0.77715 | acc=0.7801 | tpr=0.9923 | fpr=0.2238 | 6245.8 samples/s | 24.4 steps/s
[Step= 250] | Loss=0.78356 | acc=0.7782 | tpr=0.9921 | fpr=0.2257 | 5858.8 samples/s | 22.9 steps/s
[Step= 300] | Loss=0.78298 | acc=0.7793 | tpr=0.9905 | fpr=0.2246 | 6384.1 samples/s | 24.9 steps/s
[Step= 350] | Loss=0.78720 | acc=0.7789 | tpr=0.9900 | fpr=0.2250 | 6809.3 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.78736 | acc=0.7790 | tpr=0.9907 | fpr=0.2249 | 6815.6 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.78953 | acc=0.7793 | tpr=0.9912 | fpr=0.2245 | 4504.2 samples/s | 17.6 steps/s
[Step= 500] | Loss=0.78922 | acc=0.7792 | tpr=0.9912 | fpr=0.2247 | 7017.0 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.78799 | acc=0.7793 | tpr=0.9912 | fpr=0.2245 | 12689.4 samples/s | 49.6 steps/s
Avg test loss: 0.78746, Avg test acc: 0.77943, Avg tpr: 0.99128, Avg fpr: 0.22443, total FA: 31161

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=36.7] | Loss=0.22186 | Reg=0.00378 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.438 | L2-Norm(final)=2.963 | 3980.1 samples/s | 62.2 steps/s
[Step=37650 Epoch=36.8] | Loss=0.01913 | Reg=0.00378 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.432 | L2-Norm(final)=2.963 | 3269.4 samples/s | 51.1 steps/s
[Step=37700 Epoch=36.8] | Loss=0.01291 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.432 | L2-Norm(final)=2.964 | 3446.2 samples/s | 53.8 steps/s
[Step=37750 Epoch=36.9] | Loss=0.01113 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.432 | L2-Norm(final)=2.964 | 3457.0 samples/s | 54.0 steps/s
[Step=37800 Epoch=36.9] | Loss=0.01015 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.432 | L2-Norm(final)=2.965 | 3439.4 samples/s | 53.7 steps/s
[Step=37850 Epoch=37.0] | Loss=0.00983 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.432 | L2-Norm(final)=2.966 | 3472.3 samples/s | 54.3 steps/s
[Step=37900 Epoch=37.0] | Loss=0.00924 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.432 | L2-Norm(final)=2.967 | 3480.5 samples/s | 54.4 steps/s
[Step=37950 Epoch=37.1] | Loss=0.00901 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.432 | L2-Norm(final)=2.967 | 3486.7 samples/s | 54.5 steps/s
[Step=38000 Epoch=37.1] | Loss=0.00858 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.432 | L2-Norm(final)=2.968 | 3476.4 samples/s | 54.3 steps/s
[Step=38050 Epoch=37.1] | Loss=0.00843 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.432 | L2-Norm(final)=2.969 | 3469.0 samples/s | 54.2 steps/s
[Step=38100 Epoch=37.2] | Loss=0.00826 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.432 | L2-Norm(final)=2.969 | 3475.5 samples/s | 54.3 steps/s
[Step=38150 Epoch=37.2] | Loss=0.00816 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.433 | L2-Norm(final)=2.970 | 3472.6 samples/s | 54.3 steps/s
[Step=38200 Epoch=37.3] | Loss=0.00830 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.433 | L2-Norm(final)=2.970 | 3464.6 samples/s | 54.1 steps/s
[Step=38250 Epoch=37.3] | Loss=0.00822 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.433 | L2-Norm(final)=2.971 | 3476.4 samples/s | 54.3 steps/s
[Step=38300 Epoch=37.4] | Loss=0.00812 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.433 | L2-Norm(final)=2.971 | 3482.1 samples/s | 54.4 steps/s
[Step=38350 Epoch=37.4] | Loss=0.00811 | Reg=0.00378 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.433 | L2-Norm(final)=2.972 | 3482.4 samples/s | 54.4 steps/s
[Step=38400 Epoch=37.5] | Loss=0.00805 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.433 | L2-Norm(final)=2.972 | 3479.1 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step38400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=70.9] | Loss=0.07646 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.438 | L2-Norm(final)=2.963 | 3681.8 samples/s | 57.5 steps/s
[Step=37650 Epoch=71.0] | Loss=0.01817 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.432 | L2-Norm(final)=2.962 | 3145.9 samples/s | 49.2 steps/s
[Step=37700 Epoch=71.1] | Loss=0.00918 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.431 | L2-Norm(final)=2.961 | 3293.1 samples/s | 51.5 steps/s
[Step=37750 Epoch=71.2] | Loss=0.00616 | Reg=0.00378 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.430 | L2-Norm(final)=2.961 | 3269.9 samples/s | 51.1 steps/s
[Step=37800 Epoch=71.3] | Loss=0.00463 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.429 | L2-Norm(final)=2.961 | 3274.3 samples/s | 51.2 steps/s
[Step=37850 Epoch=71.3] | Loss=0.00373 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.429 | L2-Norm(final)=2.961 | 3290.1 samples/s | 51.4 steps/s
[Step=37900 Epoch=71.4] | Loss=0.00311 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.428 | L2-Norm(final)=2.961 | 3274.5 samples/s | 51.2 steps/s
[Step=37950 Epoch=71.5] | Loss=0.00267 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.428 | L2-Norm(final)=2.961 | 3302.0 samples/s | 51.6 steps/s
[Step=38000 Epoch=71.6] | Loss=0.00234 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.427 | L2-Norm(final)=2.962 | 3312.4 samples/s | 51.8 steps/s
[Step=38050 Epoch=71.7] | Loss=0.00209 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.427 | L2-Norm(final)=2.962 | 3282.0 samples/s | 51.3 steps/s
[Step=38100 Epoch=71.8] | Loss=0.00188 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.427 | L2-Norm(final)=2.962 | 3318.6 samples/s | 51.9 steps/s
[Step=38150 Epoch=71.9] | Loss=0.00172 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.426 | L2-Norm(final)=2.962 | 1712.8 samples/s | 26.8 steps/s
[Step=38200 Epoch=72.0] | Loss=0.00158 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.426 | L2-Norm(final)=2.962 | 3324.3 samples/s | 51.9 steps/s
[Step=38250 Epoch=72.1] | Loss=0.00146 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.426 | L2-Norm(final)=2.962 | 3265.6 samples/s | 51.0 steps/s
[Step=38300 Epoch=72.2] | Loss=0.00136 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.426 | L2-Norm(final)=2.962 | 3279.2 samples/s | 51.2 steps/s
[Step=38350 Epoch=72.3] | Loss=0.00127 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.426 | L2-Norm(final)=2.962 | 3266.5 samples/s | 51.0 steps/s
[Step=38400 Epoch=72.4] | Loss=0.00119 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.426 | L2-Norm(final)=2.962 | 3288.9 samples/s | 51.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27009 | acc=0.8558 | tpr=0.7952 | fpr=0.0126 | 3730.3 samples/s | 14.6 steps/s
Avg test loss: 0.27995, Avg test acc: 0.85283, Avg tpr: 0.79227, Avg fpr: 0.01397, total FA: 109

Testing server on iccad2012
[Step=  50] | Loss=0.69437 | acc=0.7939 | tpr=0.9912 | fpr=0.2096 | 3730.0 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.70137 | acc=0.7983 | tpr=0.9915 | fpr=0.2053 | 6674.1 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.71092 | acc=0.7973 | tpr=0.9899 | fpr=0.2063 | 6891.1 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.71328 | acc=0.7981 | tpr=0.9902 | fpr=0.2054 | 6778.3 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.71894 | acc=0.7958 | tpr=0.9904 | fpr=0.2078 | 6807.8 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.71893 | acc=0.7968 | tpr=0.9891 | fpr=0.2067 | 6879.6 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.72306 | acc=0.7965 | tpr=0.9881 | fpr=0.2070 | 4275.5 samples/s | 16.7 steps/s
[Step= 400] | Loss=0.72318 | acc=0.7969 | tpr=0.9891 | fpr=0.2066 | 6538.0 samples/s | 25.5 steps/s
[Step= 450] | Loss=0.72563 | acc=0.7970 | tpr=0.9893 | fpr=0.2065 | 6798.5 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.72528 | acc=0.7967 | tpr=0.9894 | fpr=0.2068 | 6479.1 samples/s | 25.3 steps/s
[Step= 550] | Loss=0.72409 | acc=0.7968 | tpr=0.9897 | fpr=0.2067 | 12602.8 samples/s | 49.2 steps/s
Avg test loss: 0.72359, Avg test acc: 0.79683, Avg tpr: 0.98970, Avg fpr: 0.20667, total FA: 28696

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=37.5] | Loss=0.20602 | Reg=0.00377 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.429 | L2-Norm(final)=2.971 | 4752.2 samples/s | 74.3 steps/s
[Step=38450 Epoch=37.5] | Loss=0.02079 | Reg=0.00377 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.423 | L2-Norm(final)=2.970 | 2988.3 samples/s | 46.7 steps/s
[Step=38500 Epoch=37.6] | Loss=0.01384 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.423 | L2-Norm(final)=2.971 | 3438.3 samples/s | 53.7 steps/s
[Step=38550 Epoch=37.6] | Loss=0.01186 | Reg=0.00377 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.423 | L2-Norm(final)=2.972 | 3425.7 samples/s | 53.5 steps/s
[Step=38600 Epoch=37.7] | Loss=0.01097 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.423 | L2-Norm(final)=2.973 | 3441.0 samples/s | 53.8 steps/s
[Step=38650 Epoch=37.7] | Loss=0.00995 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.423 | L2-Norm(final)=2.973 | 3445.8 samples/s | 53.8 steps/s
[Step=38700 Epoch=37.8] | Loss=0.00982 | Reg=0.00377 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.423 | L2-Norm(final)=2.974 | 3442.6 samples/s | 53.8 steps/s
[Step=38750 Epoch=37.8] | Loss=0.00938 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.423 | L2-Norm(final)=2.975 | 3448.2 samples/s | 53.9 steps/s
[Step=38800 Epoch=37.9] | Loss=0.00914 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.423 | L2-Norm(final)=2.975 | 3449.2 samples/s | 53.9 steps/s
[Step=38850 Epoch=37.9] | Loss=0.00882 | Reg=0.00377 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.423 | L2-Norm(final)=2.976 | 3426.5 samples/s | 53.5 steps/s
[Step=38900 Epoch=38.0] | Loss=0.00861 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.424 | L2-Norm(final)=2.977 | 3457.5 samples/s | 54.0 steps/s
[Step=38950 Epoch=38.0] | Loss=0.00848 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.424 | L2-Norm(final)=2.977 | 3447.4 samples/s | 53.9 steps/s
[Step=39000 Epoch=38.1] | Loss=0.00844 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.424 | L2-Norm(final)=2.978 | 3442.3 samples/s | 53.8 steps/s
[Step=39050 Epoch=38.1] | Loss=0.00824 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.424 | L2-Norm(final)=2.978 | 3439.2 samples/s | 53.7 steps/s
[Step=39100 Epoch=38.2] | Loss=0.00812 | Reg=0.00377 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.424 | L2-Norm(final)=2.979 | 3447.0 samples/s | 53.9 steps/s
[Step=39150 Epoch=38.2] | Loss=0.00816 | Reg=0.00377 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.424 | L2-Norm(final)=2.979 | 3469.4 samples/s | 54.2 steps/s
[Step=39200 Epoch=38.3] | Loss=0.00816 | Reg=0.00377 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.425 | L2-Norm(final)=2.980 | 3470.1 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step39200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=72.4] | Loss=0.14247 | Reg=0.00377 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.429 | L2-Norm(final)=2.971 | 4104.5 samples/s | 64.1 steps/s
[Step=38450 Epoch=72.5] | Loss=0.01370 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.422 | L2-Norm(final)=2.971 | 3025.0 samples/s | 47.3 steps/s
[Step=38500 Epoch=72.6] | Loss=0.00688 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.421 | L2-Norm(final)=2.971 | 3268.6 samples/s | 51.1 steps/s
[Step=38550 Epoch=72.7] | Loss=0.00462 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.420 | L2-Norm(final)=2.970 | 3276.2 samples/s | 51.2 steps/s
[Step=38600 Epoch=72.8] | Loss=0.00348 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.419 | L2-Norm(final)=2.970 | 3232.9 samples/s | 50.5 steps/s
[Step=38650 Epoch=72.9] | Loss=0.00279 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.418 | L2-Norm(final)=2.970 | 3285.5 samples/s | 51.3 steps/s
[Step=38700 Epoch=73.0] | Loss=0.00234 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.418 | L2-Norm(final)=2.971 | 3297.3 samples/s | 51.5 steps/s
[Step=38750 Epoch=73.0] | Loss=0.00201 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.418 | L2-Norm(final)=2.971 | 3280.1 samples/s | 51.3 steps/s
[Step=38800 Epoch=73.1] | Loss=0.00177 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.417 | L2-Norm(final)=2.971 | 3280.9 samples/s | 51.3 steps/s
[Step=38850 Epoch=73.2] | Loss=0.00157 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.417 | L2-Norm(final)=2.971 | 3275.2 samples/s | 51.2 steps/s
[Step=38900 Epoch=73.3] | Loss=0.00142 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.417 | L2-Norm(final)=2.971 | 3328.3 samples/s | 52.0 steps/s
[Step=38950 Epoch=73.4] | Loss=0.00129 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.417 | L2-Norm(final)=2.971 | 1736.0 samples/s | 27.1 steps/s
[Step=39000 Epoch=73.5] | Loss=0.00119 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.416 | L2-Norm(final)=2.971 | 3297.6 samples/s | 51.5 steps/s
[Step=39050 Epoch=73.6] | Loss=0.00110 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.416 | L2-Norm(final)=2.971 | 3299.2 samples/s | 51.5 steps/s
[Step=39100 Epoch=73.7] | Loss=0.00102 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.416 | L2-Norm(final)=2.971 | 3282.2 samples/s | 51.3 steps/s
[Step=39150 Epoch=73.8] | Loss=0.00096 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.416 | L2-Norm(final)=2.971 | 3290.9 samples/s | 51.4 steps/s
[Step=39200 Epoch=73.9] | Loss=0.00090 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.416 | L2-Norm(final)=2.971 | 3298.0 samples/s | 51.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22754 | acc=0.8749 | tpr=0.8242 | fpr=0.0149 | 3754.8 samples/s | 14.7 steps/s
Avg test loss: 0.23699, Avg test acc: 0.87231, Avg tpr: 0.82176, Avg fpr: 0.01654, total FA: 129

Testing server on iccad2012
[Step=  50] | Loss=0.75358 | acc=0.7796 | tpr=0.9912 | fpr=0.2242 | 3758.6 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.75943 | acc=0.7843 | tpr=0.9915 | fpr=0.2195 | 6555.5 samples/s | 25.6 steps/s
[Step= 150] | Loss=0.76842 | acc=0.7841 | tpr=0.9899 | fpr=0.2197 | 6849.8 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.77063 | acc=0.7849 | tpr=0.9902 | fpr=0.2188 | 6792.1 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.77711 | acc=0.7827 | tpr=0.9904 | fpr=0.2211 | 6525.6 samples/s | 25.5 steps/s
[Step= 300] | Loss=0.77701 | acc=0.7838 | tpr=0.9891 | fpr=0.2199 | 4388.6 samples/s | 17.1 steps/s
[Step= 350] | Loss=0.78129 | acc=0.7835 | tpr=0.9881 | fpr=0.2202 | 6731.5 samples/s | 26.3 steps/s
[Step= 400] | Loss=0.78153 | acc=0.7838 | tpr=0.9885 | fpr=0.2199 | 6630.4 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.78394 | acc=0.7840 | tpr=0.9888 | fpr=0.2198 | 7025.1 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.78374 | acc=0.7837 | tpr=0.9890 | fpr=0.2200 | 6647.0 samples/s | 26.0 steps/s
[Step= 550] | Loss=0.78260 | acc=0.7840 | tpr=0.9893 | fpr=0.2197 | 12701.8 samples/s | 49.6 steps/s
Avg test loss: 0.78206, Avg test acc: 0.78407, Avg tpr: 0.98930, Avg fpr: 0.21966, total FA: 30500

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=38.3] | Loss=0.05999 | Reg=0.00377 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.420 | L2-Norm(final)=2.979 | 4164.1 samples/s | 65.1 steps/s
[Step=39250 Epoch=38.3] | Loss=0.01914 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.414 | L2-Norm(final)=2.979 | 3162.0 samples/s | 49.4 steps/s
[Step=39300 Epoch=38.4] | Loss=0.01391 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.413 | L2-Norm(final)=2.979 | 3424.7 samples/s | 53.5 steps/s
[Step=39350 Epoch=38.4] | Loss=0.01203 | Reg=0.00377 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=19.413 | L2-Norm(final)=2.980 | 3451.7 samples/s | 53.9 steps/s
[Step=39400 Epoch=38.5] | Loss=0.01035 | Reg=0.00377 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.413 | L2-Norm(final)=2.981 | 3461.4 samples/s | 54.1 steps/s
[Step=39450 Epoch=38.5] | Loss=0.00952 | Reg=0.00377 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.413 | L2-Norm(final)=2.982 | 3467.7 samples/s | 54.2 steps/s
[Step=39500 Epoch=38.6] | Loss=0.00917 | Reg=0.00377 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=19.413 | L2-Norm(final)=2.982 | 3476.0 samples/s | 54.3 steps/s
[Step=39550 Epoch=38.6] | Loss=0.00893 | Reg=0.00377 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.413 | L2-Norm(final)=2.983 | 3448.3 samples/s | 53.9 steps/s
[Step=39600 Epoch=38.7] | Loss=0.00857 | Reg=0.00377 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.413 | L2-Norm(final)=2.984 | 3467.8 samples/s | 54.2 steps/s
[Step=39650 Epoch=38.7] | Loss=0.00861 | Reg=0.00377 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.414 | L2-Norm(final)=2.984 | 3477.3 samples/s | 54.3 steps/s
[Step=39700 Epoch=38.8] | Loss=0.00847 | Reg=0.00377 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.414 | L2-Norm(final)=2.985 | 3477.0 samples/s | 54.3 steps/s
[Step=39750 Epoch=38.8] | Loss=0.00829 | Reg=0.00377 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.414 | L2-Norm(final)=2.985 | 3465.8 samples/s | 54.2 steps/s
[Step=39800 Epoch=38.9] | Loss=0.00808 | Reg=0.00377 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.414 | L2-Norm(final)=2.986 | 3460.4 samples/s | 54.1 steps/s
[Step=39850 Epoch=38.9] | Loss=0.00798 | Reg=0.00377 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.414 | L2-Norm(final)=2.986 | 3460.4 samples/s | 54.1 steps/s
[Step=39900 Epoch=39.0] | Loss=0.00799 | Reg=0.00377 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.415 | L2-Norm(final)=2.987 | 3467.9 samples/s | 54.2 steps/s
[Step=39950 Epoch=39.0] | Loss=0.00797 | Reg=0.00377 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=19.415 | L2-Norm(final)=2.987 | 3469.5 samples/s | 54.2 steps/s
[Step=40000 Epoch=39.1] | Loss=0.00785 | Reg=0.00377 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.415 | L2-Norm(final)=2.988 | 3471.3 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_asml1_0/client_state-step40000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=73.9] | Loss=0.22440 | Reg=0.00377 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.420 | L2-Norm(final)=2.979 | 3758.4 samples/s | 58.7 steps/s
[Step=39250 Epoch=74.0] | Loss=0.01189 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.413 | L2-Norm(final)=2.979 | 3178.9 samples/s | 49.7 steps/s
[Step=39300 Epoch=74.1] | Loss=0.00597 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.412 | L2-Norm(final)=2.979 | 3290.2 samples/s | 51.4 steps/s
[Step=39350 Epoch=74.2] | Loss=0.00400 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.411 | L2-Norm(final)=2.979 | 3273.0 samples/s | 51.1 steps/s
[Step=39400 Epoch=74.3] | Loss=0.00301 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.410 | L2-Norm(final)=2.979 | 3284.8 samples/s | 51.3 steps/s
[Step=39450 Epoch=74.4] | Loss=0.00242 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.409 | L2-Norm(final)=2.979 | 3269.0 samples/s | 51.1 steps/s
[Step=39500 Epoch=74.5] | Loss=0.00202 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.409 | L2-Norm(final)=2.979 | 3291.2 samples/s | 51.4 steps/s
[Step=39550 Epoch=74.6] | Loss=0.00174 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.409 | L2-Norm(final)=2.979 | 3289.5 samples/s | 51.4 steps/s
[Step=39600 Epoch=74.6] | Loss=0.00153 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.408 | L2-Norm(final)=2.979 | 3291.8 samples/s | 51.4 steps/s
[Step=39650 Epoch=74.7] | Loss=0.00136 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.408 | L2-Norm(final)=2.979 | 3286.7 samples/s | 51.4 steps/s
[Step=39700 Epoch=74.8] | Loss=0.00123 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.408 | L2-Norm(final)=2.979 | 3313.2 samples/s | 51.8 steps/s
[Step=39750 Epoch=74.9] | Loss=0.00112 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.408 | L2-Norm(final)=2.979 | 1750.4 samples/s | 27.4 steps/s
[Step=39800 Epoch=75.0] | Loss=0.00103 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.407 | L2-Norm(final)=2.979 | 3325.1 samples/s | 52.0 steps/s
[Step=39850 Epoch=75.1] | Loss=0.00095 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.407 | L2-Norm(final)=2.979 | 3275.5 samples/s | 51.2 steps/s
[Step=39900 Epoch=75.2] | Loss=0.00089 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.407 | L2-Norm(final)=2.979 | 3297.7 samples/s | 51.5 steps/s
[Step=39950 Epoch=75.3] | Loss=0.00083 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.407 | L2-Norm(final)=2.979 | 3282.9 samples/s | 51.3 steps/s
[Step=40000 Epoch=75.4] | Loss=0.00078 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.407 | L2-Norm(final)=2.979 | 3303.3 samples/s | 51.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-2-withl2/client_iccad2012_0/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23959 | acc=0.8712 | tpr=0.8188 | fpr=0.0149 | 3708.7 samples/s | 14.5 steps/s
Avg test loss: 0.24940, Avg test acc: 0.86846, Avg tpr: 0.81559, Avg fpr: 0.01525, total FA: 119

Testing server on iccad2012
[Step=  50] | Loss=0.71383 | acc=0.7912 | tpr=0.9912 | fpr=0.2124 | 3716.6 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.72075 | acc=0.7954 | tpr=0.9915 | fpr=0.2082 | 6762.9 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.72980 | acc=0.7952 | tpr=0.9914 | fpr=0.2085 | 6909.5 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.73235 | acc=0.7957 | tpr=0.9913 | fpr=0.2078 | 4173.1 samples/s | 16.3 steps/s
[Step= 250] | Loss=0.73828 | acc=0.7935 | tpr=0.9913 | fpr=0.2102 | 6867.6 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.73813 | acc=0.7945 | tpr=0.9898 | fpr=0.2091 | 6759.3 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.74246 | acc=0.7939 | tpr=0.9887 | fpr=0.2096 | 6625.1 samples/s | 25.9 steps/s
[Step= 400] | Loss=0.74255 | acc=0.7943 | tpr=0.9885 | fpr=0.2092 | 6930.1 samples/s | 27.1 steps/s
[Step= 450] | Loss=0.74480 | acc=0.7944 | tpr=0.9888 | fpr=0.2091 | 6575.8 samples/s | 25.7 steps/s
[Step= 500] | Loss=0.74454 | acc=0.7942 | tpr=0.9890 | fpr=0.2093 | 6758.1 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.74337 | acc=0.7945 | tpr=0.9893 | fpr=0.2091 | 12511.9 samples/s | 48.9 steps/s
Avg test loss: 0.74288, Avg test acc: 0.79453, Avg tpr: 0.98930, Avg fpr: 0.20901, total FA: 29021
