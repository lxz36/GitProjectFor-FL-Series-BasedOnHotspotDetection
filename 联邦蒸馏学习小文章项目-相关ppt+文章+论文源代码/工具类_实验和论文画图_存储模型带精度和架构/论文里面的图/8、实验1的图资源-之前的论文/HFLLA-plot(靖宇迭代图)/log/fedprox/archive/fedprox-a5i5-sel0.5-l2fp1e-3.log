#clients of iccad2012: 5
#clients of asml1: 5
select ratio: 0.5
Total num clients: 10
client model path: ['models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3', 'models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13125, 144, 32)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13116, 144, 32)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13135, 144, 32)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13124, 144, 32)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 32)
Resampled dataset to size (13051, 144, 32)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6754, 144, 32)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6728, 144, 32)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6702, 144, 32)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6792, 144, 32)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6715, 144, 32)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 4 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35307 | Reg=0.00000 | acc=0.5312 | FP-Norm=0.000 | FP-Norm(final)=1.964 | 2544.6 samples/s | 39.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.29786 | Reg=0.00202 | acc=0.7969 | FP-Norm=1.327 | FP-Norm(final)=1.957 | 3786.1 samples/s | 59.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.25321 | Reg=0.00378 | acc=0.7188 | FP-Norm=1.838 | FP-Norm(final)=1.970 | 3679.1 samples/s | 57.5 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22159 | Reg=0.00504 | acc=0.9062 | FP-Norm=2.141 | FP-Norm(final)=1.981 | 3737.5 samples/s | 58.4 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.21032 | Reg=0.00618 | acc=0.8906 | FP-Norm=2.380 | FP-Norm(final)=1.987 | 4791.9 samples/s | 74.9 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.19293 | Reg=0.00730 | acc=0.8281 | FP-Norm=2.591 | FP-Norm(final)=1.995 | 1593.1 samples/s | 24.9 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17736 | Reg=0.00827 | acc=0.9375 | FP-Norm=2.763 | FP-Norm(final)=2.005 | 3667.5 samples/s | 57.3 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16759 | Reg=0.00910 | acc=0.8750 | FP-Norm=2.904 | FP-Norm(final)=2.014 | 3570.8 samples/s | 55.8 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15846 | Reg=0.00991 | acc=0.9375 | FP-Norm=3.034 | FP-Norm(final)=2.023 | 4481.2 samples/s | 70.0 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14877 | Reg=0.01070 | acc=0.9219 | FP-Norm=3.155 | FP-Norm(final)=2.032 | 1599.7 samples/s | 25.0 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.14060 | Reg=0.01146 | acc=0.9219 | FP-Norm=3.267 | FP-Norm(final)=2.043 | 3682.7 samples/s | 57.5 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.13341 | Reg=0.01212 | acc=0.9531 | FP-Norm=3.364 | FP-Norm(final)=2.054 | 3676.0 samples/s | 57.4 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12790 | Reg=0.01272 | acc=0.9219 | FP-Norm=3.450 | FP-Norm(final)=2.063 | 4240.9 samples/s | 66.3 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.12343 | Reg=0.01331 | acc=0.9844 | FP-Norm=3.532 | FP-Norm(final)=2.073 | 1619.5 samples/s | 25.3 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11790 | Reg=0.01391 | acc=1.0000 | FP-Norm=3.612 | FP-Norm(final)=2.082 | 3623.5 samples/s | 56.6 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.11334 | Reg=0.01443 | acc=0.9531 | FP-Norm=3.682 | FP-Norm(final)=2.092 | 3641.2 samples/s | 56.9 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10912 | Reg=0.01491 | acc=0.9219 | FP-Norm=3.746 | FP-Norm(final)=2.101 | 3900.6 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37758 | Reg=0.00000 | acc=0.5000 | FP-Norm=0.000 | FP-Norm(final)=1.963 | 3586.5 samples/s | 56.0 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.28274 | Reg=0.00206 | acc=0.7031 | FP-Norm=1.336 | FP-Norm(final)=1.965 | 3379.5 samples/s | 52.8 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24406 | Reg=0.00365 | acc=0.8281 | FP-Norm=1.811 | FP-Norm(final)=1.977 | 3652.6 samples/s | 57.1 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22200 | Reg=0.00487 | acc=0.8281 | FP-Norm=2.107 | FP-Norm(final)=1.987 | 3672.7 samples/s | 57.4 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20272 | Reg=0.00597 | acc=0.8594 | FP-Norm=2.341 | FP-Norm(final)=1.996 | 4801.9 samples/s | 75.0 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18516 | Reg=0.00699 | acc=0.9844 | FP-Norm=2.539 | FP-Norm(final)=2.006 | 1556.0 samples/s | 24.3 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17098 | Reg=0.00794 | acc=0.9688 | FP-Norm=2.710 | FP-Norm(final)=2.017 | 3642.6 samples/s | 56.9 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16067 | Reg=0.00883 | acc=0.9531 | FP-Norm=2.860 | FP-Norm(final)=2.028 | 3627.2 samples/s | 56.7 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15301 | Reg=0.00965 | acc=0.9531 | FP-Norm=2.992 | FP-Norm(final)=2.039 | 4580.2 samples/s | 71.6 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14368 | Reg=0.01041 | acc=0.9844 | FP-Norm=3.111 | FP-Norm(final)=2.048 | 1578.2 samples/s | 24.7 steps/s
[Step= 500 Epoch= 2.5] | Loss=0.13576 | Reg=0.01114 | acc=0.9688 | FP-Norm=3.221 | FP-Norm(final)=2.059 | 3731.0 samples/s | 58.3 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12923 | Reg=0.01181 | acc=0.9531 | FP-Norm=3.319 | FP-Norm(final)=2.069 | 3671.6 samples/s | 57.4 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12404 | Reg=0.01243 | acc=0.9531 | FP-Norm=3.409 | FP-Norm(final)=2.080 | 4464.1 samples/s | 69.8 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11810 | Reg=0.01303 | acc=0.9688 | FP-Norm=3.492 | FP-Norm(final)=2.089 | 1589.2 samples/s | 24.8 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11224 | Reg=0.01356 | acc=0.9688 | FP-Norm=3.565 | FP-Norm(final)=2.099 | 3667.3 samples/s | 57.3 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10768 | Reg=0.01405 | acc=0.9531 | FP-Norm=3.633 | FP-Norm(final)=2.109 | 3737.6 samples/s | 58.4 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10395 | Reg=0.01454 | acc=0.9688 | FP-Norm=3.698 | FP-Norm(final)=2.119 | 4232.1 samples/s | 66.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.40324 | Reg=0.00000 | acc=0.5156 | FP-Norm=0.000 | FP-Norm(final)=1.963 | 3565.0 samples/s | 55.7 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.17029 | Reg=0.00317 | acc=0.9062 | FP-Norm=1.640 | FP-Norm(final)=1.988 | 3230.1 samples/s | 50.5 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.09878 | Reg=0.00530 | acc=0.9688 | FP-Norm=2.182 | FP-Norm(final)=2.015 | 4676.8 samples/s | 73.1 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.06810 | Reg=0.00629 | acc=1.0000 | FP-Norm=2.413 | FP-Norm(final)=2.035 | 1503.9 samples/s | 23.5 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.05148 | Reg=0.00664 | acc=1.0000 | FP-Norm=2.503 | FP-Norm(final)=2.049 | 4374.8 samples/s | 68.4 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.04164 | Reg=0.00672 | acc=1.0000 | FP-Norm=2.534 | FP-Norm(final)=2.060 | 1538.4 samples/s | 24.0 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.03484 | Reg=0.00669 | acc=1.0000 | FP-Norm=2.537 | FP-Norm(final)=2.069 | 4052.7 samples/s | 63.3 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02998 | Reg=0.00660 | acc=1.0000 | FP-Norm=2.526 | FP-Norm(final)=2.077 | 1590.5 samples/s | 24.9 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02631 | Reg=0.00647 | acc=1.0000 | FP-Norm=2.505 | FP-Norm(final)=2.084 | 3893.7 samples/s | 60.8 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02345 | Reg=0.00633 | acc=1.0000 | FP-Norm=2.481 | FP-Norm(final)=2.091 | 1595.4 samples/s | 24.9 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.02116 | Reg=0.00619 | acc=1.0000 | FP-Norm=2.455 | FP-Norm(final)=2.097 | 3755.9 samples/s | 58.7 steps/s
[Step= 550 Epoch= 5.3] | Loss=0.01928 | Reg=0.00606 | acc=1.0000 | FP-Norm=2.429 | FP-Norm(final)=2.103 | 1623.2 samples/s | 25.4 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01772 | Reg=0.00593 | acc=1.0000 | FP-Norm=2.403 | FP-Norm(final)=2.109 | 3572.4 samples/s | 55.8 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01639 | Reg=0.00580 | acc=1.0000 | FP-Norm=2.379 | FP-Norm(final)=2.115 | 1663.5 samples/s | 26.0 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01526 | Reg=0.00569 | acc=1.0000 | FP-Norm=2.355 | FP-Norm(final)=2.121 | 3512.6 samples/s | 54.9 steps/s
[Step= 750 Epoch= 7.2] | Loss=0.01430 | Reg=0.00559 | acc=1.0000 | FP-Norm=2.334 | FP-Norm(final)=2.126 | 1662.8 samples/s | 26.0 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01343 | Reg=0.00551 | acc=1.0000 | FP-Norm=2.318 | FP-Norm(final)=2.131 | 3539.0 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.38709 | Reg=0.00000 | acc=0.5781 | FP-Norm=0.000 | FP-Norm(final)=1.964 | 3689.9 samples/s | 57.7 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.17756 | Reg=0.00309 | acc=0.9844 | FP-Norm=1.633 | FP-Norm(final)=1.983 | 3252.1 samples/s | 50.8 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.10494 | Reg=0.00519 | acc=0.9688 | FP-Norm=2.165 | FP-Norm(final)=2.004 | 4452.8 samples/s | 69.6 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.07173 | Reg=0.00613 | acc=1.0000 | FP-Norm=2.387 | FP-Norm(final)=2.021 | 1512.1 samples/s | 23.6 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.05521 | Reg=0.00647 | acc=1.0000 | FP-Norm=2.473 | FP-Norm(final)=2.033 | 4194.5 samples/s | 65.5 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.04445 | Reg=0.00660 | acc=1.0000 | FP-Norm=2.512 | FP-Norm(final)=2.043 | 1543.5 samples/s | 24.1 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.03718 | Reg=0.00659 | acc=1.0000 | FP-Norm=2.521 | FP-Norm(final)=2.052 | 3861.9 samples/s | 60.3 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.03197 | Reg=0.00652 | acc=1.0000 | FP-Norm=2.513 | FP-Norm(final)=2.060 | 1587.9 samples/s | 24.8 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02805 | Reg=0.00641 | acc=1.0000 | FP-Norm=2.496 | FP-Norm(final)=2.067 | 3602.8 samples/s | 56.3 steps/s
[Step= 450 Epoch= 4.2] | Loss=0.02500 | Reg=0.00629 | acc=1.0000 | FP-Norm=2.474 | FP-Norm(final)=2.073 | 1627.2 samples/s | 25.4 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.02256 | Reg=0.00616 | acc=1.0000 | FP-Norm=2.451 | FP-Norm(final)=2.079 | 3530.4 samples/s | 55.2 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.02056 | Reg=0.00604 | acc=1.0000 | FP-Norm=2.428 | FP-Norm(final)=2.085 | 1655.7 samples/s | 25.9 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01888 | Reg=0.00592 | acc=1.0000 | FP-Norm=2.405 | FP-Norm(final)=2.091 | 3590.8 samples/s | 56.1 steps/s
[Step= 650 Epoch= 6.1] | Loss=0.01747 | Reg=0.00581 | acc=1.0000 | FP-Norm=2.382 | FP-Norm(final)=2.096 | 1709.6 samples/s | 26.7 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01625 | Reg=0.00570 | acc=1.0000 | FP-Norm=2.359 | FP-Norm(final)=2.101 | 3527.7 samples/s | 55.1 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01521 | Reg=0.00560 | acc=1.0000 | FP-Norm=2.338 | FP-Norm(final)=2.106 | 1693.3 samples/s | 26.5 steps/s
[Step= 800 Epoch= 7.5] | Loss=0.01428 | Reg=0.00550 | acc=1.0000 | FP-Norm=2.318 | FP-Norm(final)=2.111 | 3357.2 samples/s | 52.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.40208 | Reg=0.00000 | acc=0.5156 | FP-Norm=0.000 | FP-Norm(final)=1.964 | 3370.6 samples/s | 52.7 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.19325 | Reg=0.00293 | acc=0.9375 | FP-Norm=1.575 | FP-Norm(final)=1.968 | 3390.2 samples/s | 53.0 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.11123 | Reg=0.00519 | acc=1.0000 | FP-Norm=2.150 | FP-Norm(final)=1.999 | 4620.4 samples/s | 72.2 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.07553 | Reg=0.00618 | acc=1.0000 | FP-Norm=2.386 | FP-Norm(final)=2.023 | 1493.8 samples/s | 23.3 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.05721 | Reg=0.00650 | acc=1.0000 | FP-Norm=2.472 | FP-Norm(final)=2.040 | 4375.0 samples/s | 68.4 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.04601 | Reg=0.00658 | acc=1.0000 | FP-Norm=2.504 | FP-Norm(final)=2.053 | 1543.2 samples/s | 24.1 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.03844 | Reg=0.00653 | acc=1.0000 | FP-Norm=2.504 | FP-Norm(final)=2.064 | 4160.2 samples/s | 65.0 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.03303 | Reg=0.00641 | acc=1.0000 | FP-Norm=2.486 | FP-Norm(final)=2.074 | 1575.4 samples/s | 24.6 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02898 | Reg=0.00626 | acc=1.0000 | FP-Norm=2.462 | FP-Norm(final)=2.082 | 3913.6 samples/s | 61.1 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02585 | Reg=0.00614 | acc=1.0000 | FP-Norm=2.441 | FP-Norm(final)=2.090 | 1596.9 samples/s | 25.0 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.02332 | Reg=0.00602 | acc=1.0000 | FP-Norm=2.420 | FP-Norm(final)=2.097 | 3716.8 samples/s | 58.1 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.02124 | Reg=0.00591 | acc=1.0000 | FP-Norm=2.397 | FP-Norm(final)=2.104 | 1624.9 samples/s | 25.4 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01952 | Reg=0.00578 | acc=1.0000 | FP-Norm=2.373 | FP-Norm(final)=2.110 | 3614.9 samples/s | 56.5 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01806 | Reg=0.00568 | acc=1.0000 | FP-Norm=2.352 | FP-Norm(final)=2.116 | 1666.6 samples/s | 26.0 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01680 | Reg=0.00557 | acc=1.0000 | FP-Norm=2.329 | FP-Norm(final)=2.122 | 3496.9 samples/s | 54.6 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01573 | Reg=0.00548 | acc=1.0000 | FP-Norm=2.312 | FP-Norm(final)=2.128 | 1656.9 samples/s | 25.9 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01711 | Reg=0.00565 | acc=1.0000 | FP-Norm=2.340 | FP-Norm(final)=2.132 | 3565.7 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35475 | acc=0.5556 | tpr=0.4589 | fpr=0.2344 | 3504.4 samples/s | 13.7 steps/s
Avg test loss: 0.35475, Avg test acc: 0.55341, Avg tpr: 0.45538, Avg fpr: 0.23100, total FA: 1802

Testing server on iccad2012
[Step=  50] | Loss=0.26002 | acc=0.8324 | tpr=0.7965 | fpr=0.1669 | 3495.8 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.26021 | acc=0.8318 | tpr=0.7846 | fpr=0.1673 | 6558.6 samples/s | 25.6 steps/s
[Step= 150] | Loss=0.25983 | acc=0.8322 | tpr=0.7925 | fpr=0.1670 | 6633.0 samples/s | 25.9 steps/s
[Step= 200] | Loss=0.25999 | acc=0.8318 | tpr=0.7923 | fpr=0.1675 | 6753.1 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.25969 | acc=0.8315 | tpr=0.7921 | fpr=0.1678 | 6449.8 samples/s | 25.2 steps/s
[Step= 300] | Loss=0.25958 | acc=0.8317 | tpr=0.7964 | fpr=0.1676 | 6533.7 samples/s | 25.5 steps/s
[Step= 350] | Loss=0.25956 | acc=0.8320 | tpr=0.8015 | fpr=0.1674 | 6233.3 samples/s | 24.3 steps/s
[Step= 400] | Loss=0.25964 | acc=0.8316 | tpr=0.7981 | fpr=0.1678 | 6340.4 samples/s | 24.8 steps/s
[Step= 450] | Loss=0.25975 | acc=0.8312 | tpr=0.7965 | fpr=0.1682 | 6222.6 samples/s | 24.3 steps/s
[Step= 500] | Loss=0.25973 | acc=0.8313 | tpr=0.7987 | fpr=0.1681 | 6626.5 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.25969 | acc=0.8315 | tpr=0.8006 | fpr=0.1679 | 12081.2 samples/s | 47.2 steps/s
Avg test loss: 0.25979, Avg test acc: 0.83143, Avg tpr: 0.80032, Avg fpr: 0.16800, total FA: 23327

server round 1/50

clients selected: [0 2 3 5 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.32024 | Reg=0.00000 | acc=0.6562 | FP-Norm=0.000 | FP-Norm(final)=2.070 | 3677.8 samples/s | 57.5 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.25552 | Reg=0.00266 | acc=0.7656 | FP-Norm=1.515 | FP-Norm(final)=2.068 | 3539.6 samples/s | 55.3 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.21242 | Reg=0.00412 | acc=0.8750 | FP-Norm=1.939 | FP-Norm(final)=2.069 | 3621.7 samples/s | 56.6 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.18597 | Reg=0.00480 | acc=0.9062 | FP-Norm=2.119 | FP-Norm(final)=2.078 | 3698.8 samples/s | 57.8 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.17252 | Reg=0.00545 | acc=0.9062 | FP-Norm=2.269 | FP-Norm(final)=2.087 | 4808.1 samples/s | 75.1 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.15644 | Reg=0.00609 | acc=0.9219 | FP-Norm=2.403 | FP-Norm(final)=2.096 | 1557.1 samples/s | 24.3 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.14570 | Reg=0.00671 | acc=0.9375 | FP-Norm=2.525 | FP-Norm(final)=2.105 | 3594.7 samples/s | 56.2 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.13744 | Reg=0.00730 | acc=0.9688 | FP-Norm=2.635 | FP-Norm(final)=2.115 | 3620.0 samples/s | 56.6 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.13017 | Reg=0.00785 | acc=0.9219 | FP-Norm=2.733 | FP-Norm(final)=2.124 | 4310.9 samples/s | 67.4 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.12244 | Reg=0.00838 | acc=0.9531 | FP-Norm=2.823 | FP-Norm(final)=2.134 | 1589.6 samples/s | 24.8 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.11553 | Reg=0.00889 | acc=0.9688 | FP-Norm=2.908 | FP-Norm(final)=2.144 | 3642.5 samples/s | 56.9 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.11059 | Reg=0.00940 | acc=0.9219 | FP-Norm=2.991 | FP-Norm(final)=2.153 | 3648.2 samples/s | 57.0 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.10557 | Reg=0.00987 | acc=1.0000 | FP-Norm=3.064 | FP-Norm(final)=2.161 | 4138.3 samples/s | 64.7 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.10053 | Reg=0.01030 | acc=0.9844 | FP-Norm=3.131 | FP-Norm(final)=2.170 | 1638.8 samples/s | 25.6 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.09616 | Reg=0.01070 | acc=0.9844 | FP-Norm=3.192 | FP-Norm(final)=2.179 | 3720.0 samples/s | 58.1 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.09235 | Reg=0.01106 | acc=0.9844 | FP-Norm=3.247 | FP-Norm(final)=2.187 | 3671.0 samples/s | 57.4 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.08922 | Reg=0.01139 | acc=0.9375 | FP-Norm=3.296 | FP-Norm(final)=2.195 | 3938.4 samples/s | 61.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step1600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34192 | Reg=0.00000 | acc=0.5781 | FP-Norm=0.000 | FP-Norm(final)=2.070 | 3543.7 samples/s | 55.4 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.22596 | Reg=0.00189 | acc=0.8125 | FP-Norm=1.304 | FP-Norm(final)=2.071 | 3595.3 samples/s | 56.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.19495 | Reg=0.00295 | acc=0.7969 | FP-Norm=1.652 | FP-Norm(final)=2.078 | 3700.7 samples/s | 57.8 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.17736 | Reg=0.00377 | acc=0.8438 | FP-Norm=1.876 | FP-Norm(final)=2.085 | 3723.0 samples/s | 58.2 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.16566 | Reg=0.00454 | acc=0.8750 | FP-Norm=2.060 | FP-Norm(final)=2.093 | 4760.4 samples/s | 74.4 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.15075 | Reg=0.00524 | acc=0.9219 | FP-Norm=2.216 | FP-Norm(final)=2.103 | 1541.6 samples/s | 24.1 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.14092 | Reg=0.00594 | acc=0.8750 | FP-Norm=2.359 | FP-Norm(final)=2.113 | 3634.7 samples/s | 56.8 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.13239 | Reg=0.00659 | acc=0.9688 | FP-Norm=2.483 | FP-Norm(final)=2.123 | 3620.1 samples/s | 56.6 steps/s
[Step= 400 Epoch= 1.9] | Loss=0.12715 | Reg=0.00719 | acc=0.9375 | FP-Norm=2.596 | FP-Norm(final)=2.132 | 4376.8 samples/s | 68.4 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.12039 | Reg=0.00780 | acc=0.9688 | FP-Norm=2.703 | FP-Norm(final)=2.140 | 1616.3 samples/s | 25.3 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.11424 | Reg=0.00837 | acc=0.9375 | FP-Norm=2.800 | FP-Norm(final)=2.149 | 3695.3 samples/s | 57.7 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.10853 | Reg=0.00890 | acc=0.9844 | FP-Norm=2.889 | FP-Norm(final)=2.158 | 3710.9 samples/s | 58.0 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.10433 | Reg=0.00940 | acc=0.9531 | FP-Norm=2.969 | FP-Norm(final)=2.167 | 4241.1 samples/s | 66.3 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.09947 | Reg=0.00986 | acc=1.0000 | FP-Norm=3.043 | FP-Norm(final)=2.176 | 1630.4 samples/s | 25.5 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.09498 | Reg=0.01029 | acc=0.9531 | FP-Norm=3.110 | FP-Norm(final)=2.185 | 3706.0 samples/s | 57.9 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.09165 | Reg=0.01070 | acc=1.0000 | FP-Norm=3.172 | FP-Norm(final)=2.194 | 3679.4 samples/s | 57.5 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.08866 | Reg=0.01110 | acc=0.9844 | FP-Norm=3.233 | FP-Norm(final)=2.202 | 3969.6 samples/s | 62.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.29224 | Reg=0.00000 | acc=0.6875 | FP-Norm=0.000 | FP-Norm(final)=2.073 | 3453.8 samples/s | 54.0 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.22495 | Reg=0.00189 | acc=0.7812 | FP-Norm=1.306 | FP-Norm(final)=2.080 | 3614.5 samples/s | 56.5 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.19021 | Reg=0.00306 | acc=0.8594 | FP-Norm=1.679 | FP-Norm(final)=2.092 | 3646.9 samples/s | 57.0 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.17386 | Reg=0.00395 | acc=0.8750 | FP-Norm=1.916 | FP-Norm(final)=2.102 | 3715.0 samples/s | 58.0 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.16011 | Reg=0.00471 | acc=0.8594 | FP-Norm=2.099 | FP-Norm(final)=2.111 | 4734.3 samples/s | 74.0 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.14579 | Reg=0.00547 | acc=0.9844 | FP-Norm=2.262 | FP-Norm(final)=2.121 | 1569.3 samples/s | 24.5 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.13693 | Reg=0.00617 | acc=0.8750 | FP-Norm=2.404 | FP-Norm(final)=2.132 | 3724.3 samples/s | 58.2 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.12882 | Reg=0.00687 | acc=0.9531 | FP-Norm=2.535 | FP-Norm(final)=2.142 | 3701.4 samples/s | 57.8 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.12287 | Reg=0.00750 | acc=0.8594 | FP-Norm=2.649 | FP-Norm(final)=2.151 | 4506.1 samples/s | 70.4 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.11517 | Reg=0.00808 | acc=0.9375 | FP-Norm=2.751 | FP-Norm(final)=2.159 | 1573.1 samples/s | 24.6 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.10927 | Reg=0.00862 | acc=0.9375 | FP-Norm=2.843 | FP-Norm(final)=2.168 | 3658.8 samples/s | 57.2 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.10399 | Reg=0.00912 | acc=0.9375 | FP-Norm=2.927 | FP-Norm(final)=2.176 | 3742.7 samples/s | 58.5 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.09973 | Reg=0.00959 | acc=0.9531 | FP-Norm=3.003 | FP-Norm(final)=2.184 | 4151.9 samples/s | 64.9 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.10023 | Reg=0.01013 | acc=0.9531 | FP-Norm=3.085 | FP-Norm(final)=2.189 | 1628.7 samples/s | 25.4 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.09702 | Reg=0.01077 | acc=1.0000 | FP-Norm=3.176 | FP-Norm(final)=2.194 | 3664.9 samples/s | 57.3 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.09376 | Reg=0.01128 | acc=1.0000 | FP-Norm=3.252 | FP-Norm(final)=2.199 | 3529.6 samples/s | 55.1 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.09076 | Reg=0.01172 | acc=0.9844 | FP-Norm=3.316 | FP-Norm(final)=2.204 | 3950.5 samples/s | 61.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.25791 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.072 | 3587.9 samples/s | 56.1 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.10544 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.398 | FP-Norm(final)=2.088 | 3249.5 samples/s | 50.8 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.05970 | Reg=0.00317 | acc=1.0000 | FP-Norm=1.715 | FP-Norm(final)=2.108 | 4466.6 samples/s | 69.8 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.04149 | Reg=0.00355 | acc=1.0000 | FP-Norm=1.834 | FP-Norm(final)=2.120 | 1487.8 samples/s | 23.2 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.03159 | Reg=0.00371 | acc=1.0000 | FP-Norm=1.887 | FP-Norm(final)=2.131 | 4224.4 samples/s | 66.0 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.02542 | Reg=0.00374 | acc=1.0000 | FP-Norm=1.903 | FP-Norm(final)=2.140 | 1529.4 samples/s | 23.9 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.02127 | Reg=0.00370 | acc=1.0000 | FP-Norm=1.899 | FP-Norm(final)=2.147 | 3992.9 samples/s | 62.4 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.01830 | Reg=0.00364 | acc=1.0000 | FP-Norm=1.887 | FP-Norm(final)=2.154 | 1562.1 samples/s | 24.4 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.01605 | Reg=0.00357 | acc=1.0000 | FP-Norm=1.868 | FP-Norm(final)=2.159 | 3814.3 samples/s | 59.6 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.01431 | Reg=0.00349 | acc=1.0000 | FP-Norm=1.848 | FP-Norm(final)=2.164 | 1612.3 samples/s | 25.2 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.01291 | Reg=0.00340 | acc=1.0000 | FP-Norm=1.827 | FP-Norm(final)=2.168 | 3591.3 samples/s | 56.1 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01176 | Reg=0.00333 | acc=1.0000 | FP-Norm=1.806 | FP-Norm(final)=2.172 | 1649.3 samples/s | 25.8 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01081 | Reg=0.00325 | acc=1.0000 | FP-Norm=1.786 | FP-Norm(final)=2.176 | 3540.0 samples/s | 55.3 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01000 | Reg=0.00318 | acc=1.0000 | FP-Norm=1.766 | FP-Norm(final)=2.180 | 1682.1 samples/s | 26.3 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.00931 | Reg=0.00312 | acc=1.0000 | FP-Norm=1.748 | FP-Norm(final)=2.184 | 3574.1 samples/s | 55.8 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00871 | Reg=0.00306 | acc=1.0000 | FP-Norm=1.732 | FP-Norm(final)=2.187 | 1697.7 samples/s | 26.5 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00818 | Reg=0.00301 | acc=1.0000 | FP-Norm=1.716 | FP-Norm(final)=2.191 | 3500.8 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.5] | Loss=0.25751 | Reg=0.00000 | acc=0.7656 | FP-Norm=0.000 | FP-Norm(final)=2.071 | 3481.1 samples/s | 54.4 steps/s
[Step= 850 Epoch= 8.0] | Loss=0.08437 | Reg=0.00711 | acc=0.9844 | FP-Norm=2.469 | FP-Norm(final)=2.087 | 3334.8 samples/s | 52.1 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.04890 | Reg=0.00957 | acc=1.0000 | FP-Norm=2.968 | FP-Norm(final)=2.097 | 4537.1 samples/s | 70.9 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.03327 | Reg=0.00994 | acc=1.0000 | FP-Norm=3.068 | FP-Norm(final)=2.104 | 1504.6 samples/s | 23.5 steps/s
[Step=1000 Epoch= 9.4] | Loss=0.02542 | Reg=0.00975 | acc=1.0000 | FP-Norm=3.058 | FP-Norm(final)=2.111 | 4133.6 samples/s | 64.6 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.02044 | Reg=0.00943 | acc=1.0000 | FP-Norm=3.017 | FP-Norm(final)=2.117 | 1579.0 samples/s | 24.7 steps/s
[Step=1100 Epoch=10.4] | Loss=0.01711 | Reg=0.00906 | acc=1.0000 | FP-Norm=2.963 | FP-Norm(final)=2.123 | 3866.4 samples/s | 60.4 steps/s
[Step=1150 Epoch=10.8] | Loss=0.01471 | Reg=0.00870 | acc=1.0000 | FP-Norm=2.904 | FP-Norm(final)=2.128 | 1621.8 samples/s | 25.3 steps/s
[Step=1200 Epoch=11.3] | Loss=0.01291 | Reg=0.00835 | acc=1.0000 | FP-Norm=2.845 | FP-Norm(final)=2.132 | 3537.2 samples/s | 55.3 steps/s
[Step=1250 Epoch=11.8] | Loss=0.01151 | Reg=0.00802 | acc=1.0000 | FP-Norm=2.787 | FP-Norm(final)=2.136 | 1655.9 samples/s | 25.9 steps/s
[Step=1300 Epoch=12.2] | Loss=0.01040 | Reg=0.00772 | acc=1.0000 | FP-Norm=2.731 | FP-Norm(final)=2.140 | 3500.8 samples/s | 54.7 steps/s
[Step=1350 Epoch=12.7] | Loss=0.00948 | Reg=0.00743 | acc=1.0000 | FP-Norm=2.678 | FP-Norm(final)=2.144 | 1665.7 samples/s | 26.0 steps/s
[Step=1400 Epoch=13.2] | Loss=0.00872 | Reg=0.00717 | acc=1.0000 | FP-Norm=2.627 | FP-Norm(final)=2.147 | 3539.6 samples/s | 55.3 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00807 | Reg=0.00693 | acc=1.0000 | FP-Norm=2.579 | FP-Norm(final)=2.151 | 1688.0 samples/s | 26.4 steps/s
[Step=1500 Epoch=14.1] | Loss=0.00751 | Reg=0.00670 | acc=1.0000 | FP-Norm=2.534 | FP-Norm(final)=2.154 | 3509.2 samples/s | 54.8 steps/s
[Step=1550 Epoch=14.6] | Loss=0.00703 | Reg=0.00650 | acc=1.0000 | FP-Norm=2.491 | FP-Norm(final)=2.158 | 1728.3 samples/s | 27.0 steps/s
[Step=1600 Epoch=15.1] | Loss=0.00662 | Reg=0.00630 | acc=1.0000 | FP-Norm=2.450 | FP-Norm(final)=2.161 | 3310.7 samples/s | 51.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29832 | acc=0.6888 | tpr=0.6376 | fpr=0.2000 | 3476.8 samples/s | 13.6 steps/s
Avg test loss: 0.29792, Avg test acc: 0.68920, Avg tpr: 0.63589, Avg fpr: 0.19356, total FA: 1510

Testing server on iccad2012
[Step=  50] | Loss=0.28922 | acc=0.7288 | tpr=0.9115 | fpr=0.2745 | 3468.4 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.28928 | acc=0.7293 | tpr=0.9424 | fpr=0.2747 | 6580.3 samples/s | 25.7 steps/s
[Step= 150] | Loss=0.28908 | acc=0.7295 | tpr=0.9424 | fpr=0.2744 | 6613.7 samples/s | 25.8 steps/s
[Step= 200] | Loss=0.28966 | acc=0.7293 | tpr=0.9399 | fpr=0.2745 | 6519.0 samples/s | 25.5 steps/s
[Step= 250] | Loss=0.28913 | acc=0.7289 | tpr=0.9380 | fpr=0.2749 | 6566.8 samples/s | 25.7 steps/s
[Step= 300] | Loss=0.28883 | acc=0.7292 | tpr=0.9360 | fpr=0.2746 | 6413.2 samples/s | 25.1 steps/s
[Step= 350] | Loss=0.28918 | acc=0.7291 | tpr=0.9374 | fpr=0.2746 | 6267.6 samples/s | 24.5 steps/s
[Step= 400] | Loss=0.28961 | acc=0.7286 | tpr=0.9371 | fpr=0.2752 | 6199.7 samples/s | 24.2 steps/s
[Step= 450] | Loss=0.29011 | acc=0.7284 | tpr=0.9367 | fpr=0.2753 | 6358.0 samples/s | 24.8 steps/s
[Step= 500] | Loss=0.29015 | acc=0.7285 | tpr=0.9388 | fpr=0.2753 | 6552.8 samples/s | 25.6 steps/s
[Step= 550] | Loss=0.28986 | acc=0.7285 | tpr=0.9399 | fpr=0.2754 | 12413.4 samples/s | 48.5 steps/s
Avg test loss: 0.29010, Avg test acc: 0.72823, Avg tpr: 0.94017, Avg fpr: 0.27563, total FA: 38270

server round 2/50

clients selected: [1 4 5 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.27749 | Reg=0.00000 | acc=0.7344 | FP-Norm=0.000 | FP-Norm(final)=2.174 | 3793.7 samples/s | 59.3 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.16867 | Reg=0.00172 | acc=0.8594 | FP-Norm=1.264 | FP-Norm(final)=2.181 | 3274.0 samples/s | 51.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.15117 | Reg=0.00251 | acc=0.8438 | FP-Norm=1.538 | FP-Norm(final)=2.188 | 3677.6 samples/s | 57.5 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.13884 | Reg=0.00316 | acc=0.9531 | FP-Norm=1.730 | FP-Norm(final)=2.193 | 3610.6 samples/s | 56.4 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.13056 | Reg=0.00378 | acc=0.9375 | FP-Norm=1.891 | FP-Norm(final)=2.200 | 4668.1 samples/s | 72.9 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.11746 | Reg=0.00434 | acc=0.9375 | FP-Norm=2.026 | FP-Norm(final)=2.207 | 1546.5 samples/s | 24.2 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.10886 | Reg=0.00487 | acc=0.9688 | FP-Norm=2.144 | FP-Norm(final)=2.216 | 3697.8 samples/s | 57.8 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.10316 | Reg=0.00536 | acc=0.9375 | FP-Norm=2.250 | FP-Norm(final)=2.224 | 3690.5 samples/s | 57.7 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.09914 | Reg=0.00581 | acc=0.9844 | FP-Norm=2.343 | FP-Norm(final)=2.232 | 4557.4 samples/s | 71.2 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.09320 | Reg=0.00626 | acc=0.9531 | FP-Norm=2.431 | FP-Norm(final)=2.239 | 1592.3 samples/s | 24.9 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.08873 | Reg=0.00668 | acc=0.9688 | FP-Norm=2.511 | FP-Norm(final)=2.246 | 3691.8 samples/s | 57.7 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.08503 | Reg=0.00706 | acc=0.9375 | FP-Norm=2.583 | FP-Norm(final)=2.254 | 3694.3 samples/s | 57.7 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.08121 | Reg=0.00742 | acc=0.9688 | FP-Norm=2.649 | FP-Norm(final)=2.262 | 4306.1 samples/s | 67.3 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.07811 | Reg=0.00776 | acc=0.9688 | FP-Norm=2.710 | FP-Norm(final)=2.269 | 1615.1 samples/s | 25.2 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.07523 | Reg=0.00809 | acc=0.9688 | FP-Norm=2.768 | FP-Norm(final)=2.276 | 3678.8 samples/s | 57.5 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.07259 | Reg=0.00843 | acc=0.9844 | FP-Norm=2.824 | FP-Norm(final)=2.283 | 3692.6 samples/s | 57.7 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.07046 | Reg=0.00875 | acc=0.9531 | FP-Norm=2.878 | FP-Norm(final)=2.290 | 4126.9 samples/s | 64.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.25532 | Reg=0.00000 | acc=0.7500 | FP-Norm=0.000 | FP-Norm(final)=2.175 | 3557.0 samples/s | 55.6 steps/s
[Step= 850 Epoch= 4.2] | Loss=0.16760 | Reg=0.00208 | acc=0.9219 | FP-Norm=1.341 | FP-Norm(final)=2.173 | 3490.8 samples/s | 54.5 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.14363 | Reg=0.00307 | acc=0.9062 | FP-Norm=1.677 | FP-Norm(final)=2.179 | 3656.6 samples/s | 57.1 steps/s
[Step= 950 Epoch= 4.7] | Loss=0.12972 | Reg=0.00378 | acc=0.9375 | FP-Norm=1.877 | FP-Norm(final)=2.187 | 3700.4 samples/s | 57.8 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.11937 | Reg=0.00436 | acc=0.9688 | FP-Norm=2.025 | FP-Norm(final)=2.194 | 4825.9 samples/s | 75.4 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.10809 | Reg=0.00491 | acc=0.9844 | FP-Norm=2.153 | FP-Norm(final)=2.202 | 1526.8 samples/s | 23.9 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.10016 | Reg=0.00544 | acc=0.9688 | FP-Norm=2.269 | FP-Norm(final)=2.211 | 3602.9 samples/s | 56.3 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09395 | Reg=0.00595 | acc=0.9688 | FP-Norm=2.373 | FP-Norm(final)=2.221 | 3634.5 samples/s | 56.8 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.08979 | Reg=0.00642 | acc=0.9844 | FP-Norm=2.466 | FP-Norm(final)=2.229 | 4640.5 samples/s | 72.5 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08442 | Reg=0.00686 | acc=0.9688 | FP-Norm=2.550 | FP-Norm(final)=2.236 | 1575.1 samples/s | 24.6 steps/s
[Step=1300 Epoch= 6.4] | Loss=0.07984 | Reg=0.00724 | acc=0.9531 | FP-Norm=2.622 | FP-Norm(final)=2.244 | 3639.2 samples/s | 56.9 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.07644 | Reg=0.00759 | acc=0.9844 | FP-Norm=2.687 | FP-Norm(final)=2.251 | 3704.6 samples/s | 57.9 steps/s
[Step=1400 Epoch= 6.9] | Loss=0.07334 | Reg=0.00792 | acc=0.9531 | FP-Norm=2.746 | FP-Norm(final)=2.258 | 4317.0 samples/s | 67.5 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07005 | Reg=0.00825 | acc=1.0000 | FP-Norm=2.803 | FP-Norm(final)=2.265 | 1615.1 samples/s | 25.2 steps/s
[Step=1500 Epoch= 7.4] | Loss=0.06711 | Reg=0.00854 | acc=0.9844 | FP-Norm=2.854 | FP-Norm(final)=2.272 | 3704.5 samples/s | 57.9 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06475 | Reg=0.00882 | acc=0.9688 | FP-Norm=2.902 | FP-Norm(final)=2.278 | 3722.7 samples/s | 58.2 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06266 | Reg=0.00908 | acc=1.0000 | FP-Norm=2.945 | FP-Norm(final)=2.284 | 4278.2 samples/s | 66.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step1600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.16625 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.175 | 3660.8 samples/s | 57.2 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.03740 | Reg=0.00575 | acc=1.0000 | FP-Norm=2.258 | FP-Norm(final)=2.189 | 3167.7 samples/s | 49.5 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.02313 | Reg=0.00657 | acc=1.0000 | FP-Norm=2.489 | FP-Norm(final)=2.198 | 4584.7 samples/s | 71.6 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01590 | Reg=0.00672 | acc=1.0000 | FP-Norm=2.542 | FP-Norm(final)=2.205 | 1519.7 samples/s | 23.7 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01198 | Reg=0.00652 | acc=1.0000 | FP-Norm=2.515 | FP-Norm(final)=2.210 | 4213.6 samples/s | 65.8 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.00961 | Reg=0.00622 | acc=1.0000 | FP-Norm=2.460 | FP-Norm(final)=2.215 | 1529.6 samples/s | 23.9 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00804 | Reg=0.00592 | acc=1.0000 | FP-Norm=2.399 | FP-Norm(final)=2.218 | 4037.6 samples/s | 63.1 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00691 | Reg=0.00562 | acc=1.0000 | FP-Norm=2.337 | FP-Norm(final)=2.222 | 1586.7 samples/s | 24.8 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00606 | Reg=0.00535 | acc=1.0000 | FP-Norm=2.278 | FP-Norm(final)=2.224 | 3750.6 samples/s | 58.6 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00541 | Reg=0.00511 | acc=1.0000 | FP-Norm=2.222 | FP-Norm(final)=2.227 | 1630.0 samples/s | 25.5 steps/s
[Step=1300 Epoch=12.3] | Loss=0.00488 | Reg=0.00488 | acc=1.0000 | FP-Norm=2.168 | FP-Norm(final)=2.230 | 3586.7 samples/s | 56.0 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00445 | Reg=0.00468 | acc=1.0000 | FP-Norm=2.118 | FP-Norm(final)=2.232 | 1630.1 samples/s | 25.5 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00409 | Reg=0.00449 | acc=1.0000 | FP-Norm=2.071 | FP-Norm(final)=2.235 | 3571.2 samples/s | 55.8 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00379 | Reg=0.00431 | acc=1.0000 | FP-Norm=2.026 | FP-Norm(final)=2.237 | 1644.2 samples/s | 25.7 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00353 | Reg=0.00415 | acc=1.0000 | FP-Norm=1.984 | FP-Norm(final)=2.239 | 3545.6 samples/s | 55.4 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00331 | Reg=0.00400 | acc=1.0000 | FP-Norm=1.945 | FP-Norm(final)=2.242 | 1671.3 samples/s | 26.1 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00311 | Reg=0.00387 | acc=1.0000 | FP-Norm=1.908 | FP-Norm(final)=2.244 | 3473.2 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step1600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.1] | Loss=0.22696 | Reg=0.00000 | acc=0.7656 | FP-Norm=0.000 | FP-Norm(final)=2.174 | 3435.1 samples/s | 53.7 steps/s
[Step=1650 Epoch=15.5] | Loss=0.05146 | Reg=0.00584 | acc=1.0000 | FP-Norm=2.281 | FP-Norm(final)=2.178 | 3293.1 samples/s | 51.5 steps/s
[Step=1700 Epoch=16.0] | Loss=0.02945 | Reg=0.00687 | acc=1.0000 | FP-Norm=2.546 | FP-Norm(final)=2.183 | 4562.8 samples/s | 71.3 steps/s
[Step=1750 Epoch=16.5] | Loss=0.02071 | Reg=0.00702 | acc=1.0000 | FP-Norm=2.599 | FP-Norm(final)=2.191 | 1531.4 samples/s | 23.9 steps/s
[Step=1800 Epoch=17.0] | Loss=0.01561 | Reg=0.00687 | acc=1.0000 | FP-Norm=2.583 | FP-Norm(final)=2.198 | 4209.9 samples/s | 65.8 steps/s
[Step=1850 Epoch=17.4] | Loss=0.01255 | Reg=0.00661 | acc=1.0000 | FP-Norm=2.539 | FP-Norm(final)=2.203 | 1565.6 samples/s | 24.5 steps/s
[Step=1900 Epoch=17.9] | Loss=0.01049 | Reg=0.00632 | acc=1.0000 | FP-Norm=2.483 | FP-Norm(final)=2.208 | 3878.6 samples/s | 60.6 steps/s
[Step=1950 Epoch=18.4] | Loss=0.00901 | Reg=0.00604 | acc=1.0000 | FP-Norm=2.426 | FP-Norm(final)=2.212 | 1569.5 samples/s | 24.5 steps/s
[Step=2000 Epoch=18.8] | Loss=0.00791 | Reg=0.00577 | acc=1.0000 | FP-Norm=2.369 | FP-Norm(final)=2.215 | 3644.0 samples/s | 56.9 steps/s
[Step=2050 Epoch=19.3] | Loss=0.00705 | Reg=0.00552 | acc=1.0000 | FP-Norm=2.314 | FP-Norm(final)=2.218 | 1652.3 samples/s | 25.8 steps/s
[Step=2100 Epoch=19.8] | Loss=0.00636 | Reg=0.00529 | acc=1.0000 | FP-Norm=2.261 | FP-Norm(final)=2.222 | 3475.5 samples/s | 54.3 steps/s
[Step=2150 Epoch=20.3] | Loss=0.00580 | Reg=0.00507 | acc=1.0000 | FP-Norm=2.212 | FP-Norm(final)=2.224 | 1692.4 samples/s | 26.4 steps/s
[Step=2200 Epoch=20.7] | Loss=0.00533 | Reg=0.00488 | acc=1.0000 | FP-Norm=2.164 | FP-Norm(final)=2.227 | 3494.8 samples/s | 54.6 steps/s
[Step=2250 Epoch=21.2] | Loss=0.00494 | Reg=0.00469 | acc=1.0000 | FP-Norm=2.120 | FP-Norm(final)=2.230 | 1682.4 samples/s | 26.3 steps/s
[Step=2300 Epoch=21.7] | Loss=0.00460 | Reg=0.00453 | acc=1.0000 | FP-Norm=2.078 | FP-Norm(final)=2.233 | 3460.8 samples/s | 54.1 steps/s
[Step=2350 Epoch=22.1] | Loss=0.00431 | Reg=0.00437 | acc=1.0000 | FP-Norm=2.038 | FP-Norm(final)=2.235 | 1735.1 samples/s | 27.1 steps/s
[Step=2400 Epoch=22.6] | Loss=0.00405 | Reg=0.00423 | acc=1.0000 | FP-Norm=2.001 | FP-Norm(final)=2.238 | 3276.3 samples/s | 51.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step2400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.13975 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.174 | 3327.2 samples/s | 52.0 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.03957 | Reg=0.00337 | acc=1.0000 | FP-Norm=1.726 | FP-Norm(final)=2.190 | 3509.7 samples/s | 54.8 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.02084 | Reg=0.00388 | acc=1.0000 | FP-Norm=1.909 | FP-Norm(final)=2.203 | 4647.7 samples/s | 72.6 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.01467 | Reg=0.00392 | acc=1.0000 | FP-Norm=1.939 | FP-Norm(final)=2.213 | 1486.3 samples/s | 23.2 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01127 | Reg=0.00389 | acc=1.0000 | FP-Norm=1.942 | FP-Norm(final)=2.220 | 4396.7 samples/s | 68.7 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00912 | Reg=0.00381 | acc=1.0000 | FP-Norm=1.926 | FP-Norm(final)=2.226 | 1530.5 samples/s | 23.9 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00763 | Reg=0.00369 | acc=1.0000 | FP-Norm=1.899 | FP-Norm(final)=2.230 | 4096.0 samples/s | 64.0 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00657 | Reg=0.00356 | acc=1.0000 | FP-Norm=1.866 | FP-Norm(final)=2.234 | 1572.7 samples/s | 24.6 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00578 | Reg=0.00343 | acc=1.0000 | FP-Norm=1.832 | FP-Norm(final)=2.237 | 3918.2 samples/s | 61.2 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00516 | Reg=0.00331 | acc=1.0000 | FP-Norm=1.798 | FP-Norm(final)=2.240 | 1580.2 samples/s | 24.7 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00466 | Reg=0.00320 | acc=1.0000 | FP-Norm=1.766 | FP-Norm(final)=2.243 | 3693.5 samples/s | 57.7 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00426 | Reg=0.00309 | acc=1.0000 | FP-Norm=1.736 | FP-Norm(final)=2.245 | 1618.3 samples/s | 25.3 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00393 | Reg=0.00300 | acc=1.0000 | FP-Norm=1.707 | FP-Norm(final)=2.247 | 3609.9 samples/s | 56.4 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00364 | Reg=0.00291 | acc=1.0000 | FP-Norm=1.680 | FP-Norm(final)=2.250 | 1667.0 samples/s | 26.0 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00340 | Reg=0.00282 | acc=1.0000 | FP-Norm=1.654 | FP-Norm(final)=2.252 | 3514.6 samples/s | 54.9 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00318 | Reg=0.00275 | acc=1.0000 | FP-Norm=1.630 | FP-Norm(final)=2.254 | 1666.6 samples/s | 26.0 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00300 | Reg=0.00268 | acc=1.0000 | FP-Norm=1.607 | FP-Norm(final)=2.257 | 3564.7 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18383 | acc=0.8351 | tpr=0.8131 | fpr=0.1172 | 3568.8 samples/s | 13.9 steps/s
Avg test loss: 0.18487, Avg test acc: 0.83504, Avg tpr: 0.81232, Avg fpr: 0.11499, total FA: 897

Testing server on iccad2012
[Step=  50] | Loss=0.57825 | acc=0.4595 | tpr=0.9292 | fpr=0.5489 | 3391.2 samples/s | 13.2 steps/s
[Step= 100] | Loss=0.57856 | acc=0.4589 | tpr=0.9510 | fpr=0.5503 | 6697.6 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.57867 | acc=0.4603 | tpr=0.9452 | fpr=0.5486 | 6743.2 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.57929 | acc=0.4607 | tpr=0.9454 | fpr=0.5481 | 6500.8 samples/s | 25.4 steps/s
[Step= 250] | Loss=0.57914 | acc=0.4604 | tpr=0.9450 | fpr=0.5484 | 6616.0 samples/s | 25.8 steps/s
[Step= 300] | Loss=0.57891 | acc=0.4608 | tpr=0.9418 | fpr=0.5479 | 6362.2 samples/s | 24.9 steps/s
[Step= 350] | Loss=0.57929 | acc=0.4611 | tpr=0.9443 | fpr=0.5476 | 6523.4 samples/s | 25.5 steps/s
[Step= 400] | Loss=0.58056 | acc=0.4604 | tpr=0.9469 | fpr=0.5484 | 6507.8 samples/s | 25.4 steps/s
[Step= 450] | Loss=0.58168 | acc=0.4604 | tpr=0.9469 | fpr=0.5484 | 6416.4 samples/s | 25.1 steps/s
[Step= 500] | Loss=0.58208 | acc=0.4606 | tpr=0.9489 | fpr=0.5482 | 6440.9 samples/s | 25.2 steps/s
[Step= 550] | Loss=0.58113 | acc=0.4606 | tpr=0.9495 | fpr=0.5483 | 12292.8 samples/s | 48.0 steps/s
Avg test loss: 0.58164, Avg test acc: 0.46035, Avg tpr: 0.94968, Avg fpr: 0.54854, total FA: 76164

server round 3/50

clients selected: [1 2 3 5 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.18826 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.257 | 3512.1 samples/s | 54.9 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.13111 | Reg=0.00154 | acc=0.9062 | FP-Norm=1.158 | FP-Norm(final)=2.247 | 3549.2 samples/s | 55.5 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.11409 | Reg=0.00225 | acc=0.9375 | FP-Norm=1.437 | FP-Norm(final)=2.252 | 3649.3 samples/s | 57.0 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.11145 | Reg=0.00281 | acc=0.8906 | FP-Norm=1.619 | FP-Norm(final)=2.256 | 3707.5 samples/s | 57.9 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.10558 | Reg=0.00330 | acc=0.9375 | FP-Norm=1.761 | FP-Norm(final)=2.259 | 4764.9 samples/s | 74.5 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.09591 | Reg=0.00372 | acc=0.9844 | FP-Norm=1.872 | FP-Norm(final)=2.265 | 1539.2 samples/s | 24.0 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.08762 | Reg=0.00408 | acc=0.9844 | FP-Norm=1.964 | FP-Norm(final)=2.273 | 3661.4 samples/s | 57.2 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.08333 | Reg=0.00443 | acc=0.9688 | FP-Norm=2.048 | FP-Norm(final)=2.281 | 3668.5 samples/s | 57.3 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.07940 | Reg=0.00477 | acc=0.9062 | FP-Norm=2.128 | FP-Norm(final)=2.287 | 4508.7 samples/s | 70.4 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.07543 | Reg=0.00511 | acc=0.9531 | FP-Norm=2.202 | FP-Norm(final)=2.294 | 1586.9 samples/s | 24.8 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.07109 | Reg=0.00542 | acc=0.9844 | FP-Norm=2.267 | FP-Norm(final)=2.301 | 3733.3 samples/s | 58.3 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.06842 | Reg=0.00571 | acc=0.9531 | FP-Norm=2.329 | FP-Norm(final)=2.308 | 3606.3 samples/s | 56.3 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.06638 | Reg=0.00601 | acc=0.9844 | FP-Norm=2.388 | FP-Norm(final)=2.314 | 4313.3 samples/s | 67.4 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.06323 | Reg=0.00628 | acc=1.0000 | FP-Norm=2.442 | FP-Norm(final)=2.320 | 1583.3 samples/s | 24.7 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.06098 | Reg=0.00653 | acc=1.0000 | FP-Norm=2.492 | FP-Norm(final)=2.327 | 3662.7 samples/s | 57.2 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.05924 | Reg=0.00678 | acc=0.9688 | FP-Norm=2.539 | FP-Norm(final)=2.333 | 3669.0 samples/s | 57.3 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.05717 | Reg=0.00701 | acc=0.9688 | FP-Norm=2.583 | FP-Norm(final)=2.339 | 4091.6 samples/s | 63.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step1600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.17344 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.258 | 3543.3 samples/s | 55.4 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.13118 | Reg=0.00125 | acc=0.9531 | FP-Norm=1.031 | FP-Norm(final)=2.253 | 3538.4 samples/s | 55.3 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.11770 | Reg=0.00199 | acc=0.9219 | FP-Norm=1.340 | FP-Norm(final)=2.254 | 3704.7 samples/s | 57.9 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.10985 | Reg=0.00251 | acc=0.9844 | FP-Norm=1.523 | FP-Norm(final)=2.258 | 3692.9 samples/s | 57.7 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.10082 | Reg=0.00300 | acc=0.9219 | FP-Norm=1.669 | FP-Norm(final)=2.264 | 4736.7 samples/s | 74.0 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.09140 | Reg=0.00347 | acc=0.9688 | FP-Norm=1.799 | FP-Norm(final)=2.271 | 1549.5 samples/s | 24.2 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.08660 | Reg=0.00393 | acc=0.9844 | FP-Norm=1.914 | FP-Norm(final)=2.279 | 3648.0 samples/s | 57.0 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.08065 | Reg=0.00435 | acc=0.9844 | FP-Norm=2.015 | FP-Norm(final)=2.286 | 3722.3 samples/s | 58.2 steps/s
[Step=1200 Epoch= 5.8] | Loss=0.07760 | Reg=0.00474 | acc=1.0000 | FP-Norm=2.105 | FP-Norm(final)=2.293 | 4417.7 samples/s | 69.0 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.07410 | Reg=0.00512 | acc=0.9844 | FP-Norm=2.188 | FP-Norm(final)=2.298 | 1610.3 samples/s | 25.2 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.07033 | Reg=0.00547 | acc=0.9531 | FP-Norm=2.262 | FP-Norm(final)=2.305 | 3707.7 samples/s | 57.9 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.06701 | Reg=0.00579 | acc=1.0000 | FP-Norm=2.330 | FP-Norm(final)=2.311 | 3709.1 samples/s | 58.0 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.06425 | Reg=0.00608 | acc=0.9531 | FP-Norm=2.390 | FP-Norm(final)=2.318 | 4226.0 samples/s | 66.0 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.06192 | Reg=0.00637 | acc=0.9531 | FP-Norm=2.447 | FP-Norm(final)=2.324 | 1626.4 samples/s | 25.4 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.05934 | Reg=0.00663 | acc=1.0000 | FP-Norm=2.499 | FP-Norm(final)=2.329 | 3655.1 samples/s | 57.1 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.05726 | Reg=0.00688 | acc=0.9531 | FP-Norm=2.547 | FP-Norm(final)=2.336 | 3586.1 samples/s | 56.0 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.05586 | Reg=0.00713 | acc=0.9844 | FP-Norm=2.594 | FP-Norm(final)=2.342 | 3950.2 samples/s | 61.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step1600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.09746 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.258 | 3538.1 samples/s | 55.3 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.12938 | Reg=0.00132 | acc=0.9688 | FP-Norm=1.061 | FP-Norm(final)=2.251 | 3641.8 samples/s | 56.9 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.11115 | Reg=0.00188 | acc=0.9688 | FP-Norm=1.310 | FP-Norm(final)=2.257 | 3708.9 samples/s | 58.0 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.10406 | Reg=0.00230 | acc=0.9375 | FP-Norm=1.464 | FP-Norm(final)=2.264 | 3640.9 samples/s | 56.9 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.09592 | Reg=0.00270 | acc=0.9531 | FP-Norm=1.592 | FP-Norm(final)=2.269 | 4749.1 samples/s | 74.2 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.08640 | Reg=0.00308 | acc=0.9531 | FP-Norm=1.703 | FP-Norm(final)=2.276 | 1565.3 samples/s | 24.5 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.08118 | Reg=0.00344 | acc=0.9531 | FP-Norm=1.800 | FP-Norm(final)=2.283 | 3620.9 samples/s | 56.6 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.07564 | Reg=0.00379 | acc=0.9688 | FP-Norm=1.890 | FP-Norm(final)=2.290 | 3689.8 samples/s | 57.7 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.07304 | Reg=0.00412 | acc=0.9375 | FP-Norm=1.971 | FP-Norm(final)=2.297 | 4359.0 samples/s | 68.1 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.06840 | Reg=0.00443 | acc=1.0000 | FP-Norm=2.044 | FP-Norm(final)=2.302 | 1597.3 samples/s | 25.0 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.06435 | Reg=0.00472 | acc=0.9688 | FP-Norm=2.110 | FP-Norm(final)=2.309 | 3679.8 samples/s | 57.5 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.06119 | Reg=0.00498 | acc=0.9688 | FP-Norm=2.169 | FP-Norm(final)=2.316 | 3696.2 samples/s | 57.8 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.05907 | Reg=0.00522 | acc=1.0000 | FP-Norm=2.222 | FP-Norm(final)=2.322 | 4214.9 samples/s | 65.9 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.05667 | Reg=0.00545 | acc=0.9844 | FP-Norm=2.270 | FP-Norm(final)=2.327 | 1620.0 samples/s | 25.3 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.05479 | Reg=0.00566 | acc=0.9688 | FP-Norm=2.316 | FP-Norm(final)=2.332 | 3700.1 samples/s | 57.8 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.05332 | Reg=0.00589 | acc=0.9844 | FP-Norm=2.362 | FP-Norm(final)=2.337 | 3665.8 samples/s | 57.3 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.05154 | Reg=0.00612 | acc=0.9688 | FP-Norm=2.407 | FP-Norm(final)=2.343 | 3996.2 samples/s | 62.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step1600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.23429 | Reg=0.00000 | acc=0.7500 | FP-Norm=0.000 | FP-Norm(final)=2.256 | 3255.5 samples/s | 50.9 steps/s
[Step=1650 Epoch=15.6] | Loss=0.05668 | Reg=0.01014 | acc=0.9688 | FP-Norm=3.023 | FP-Norm(final)=2.221 | 3445.0 samples/s | 53.8 steps/s
[Step=1700 Epoch=16.1] | Loss=0.03139 | Reg=0.01105 | acc=1.0000 | FP-Norm=3.240 | FP-Norm(final)=2.223 | 4602.8 samples/s | 71.9 steps/s
[Step=1750 Epoch=16.6] | Loss=0.02119 | Reg=0.01068 | acc=1.0000 | FP-Norm=3.211 | FP-Norm(final)=2.231 | 1488.2 samples/s | 23.3 steps/s
[Step=1800 Epoch=17.1] | Loss=0.01598 | Reg=0.01008 | acc=1.0000 | FP-Norm=3.128 | FP-Norm(final)=2.238 | 4111.5 samples/s | 64.2 steps/s
[Step=1850 Epoch=17.5] | Loss=0.01282 | Reg=0.00948 | acc=1.0000 | FP-Norm=3.034 | FP-Norm(final)=2.243 | 1553.3 samples/s | 24.3 steps/s
[Step=1900 Epoch=18.0] | Loss=0.01072 | Reg=0.00893 | acc=1.0000 | FP-Norm=2.943 | FP-Norm(final)=2.248 | 3883.2 samples/s | 60.7 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00921 | Reg=0.00844 | acc=1.0000 | FP-Norm=2.856 | FP-Norm(final)=2.252 | 1559.5 samples/s | 24.4 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00807 | Reg=0.00799 | acc=1.0000 | FP-Norm=2.775 | FP-Norm(final)=2.256 | 3778.9 samples/s | 59.0 steps/s
[Step=2050 Epoch=19.4] | Loss=0.00719 | Reg=0.00759 | acc=1.0000 | FP-Norm=2.698 | FP-Norm(final)=2.260 | 1604.8 samples/s | 25.1 steps/s
[Step=2100 Epoch=19.9] | Loss=0.00648 | Reg=0.00722 | acc=1.0000 | FP-Norm=2.627 | FP-Norm(final)=2.263 | 3533.1 samples/s | 55.2 steps/s
[Step=2150 Epoch=20.4] | Loss=0.00591 | Reg=0.00689 | acc=1.0000 | FP-Norm=2.559 | FP-Norm(final)=2.266 | 1646.8 samples/s | 25.7 steps/s
[Step=2200 Epoch=20.8] | Loss=0.00543 | Reg=0.00658 | acc=1.0000 | FP-Norm=2.496 | FP-Norm(final)=2.269 | 3489.6 samples/s | 54.5 steps/s
[Step=2250 Epoch=21.3] | Loss=0.00502 | Reg=0.00630 | acc=1.0000 | FP-Norm=2.436 | FP-Norm(final)=2.272 | 1672.9 samples/s | 26.1 steps/s
[Step=2300 Epoch=21.8] | Loss=0.00467 | Reg=0.00605 | acc=1.0000 | FP-Norm=2.380 | FP-Norm(final)=2.275 | 3459.9 samples/s | 54.1 steps/s
[Step=2350 Epoch=22.3] | Loss=0.00437 | Reg=0.00581 | acc=1.0000 | FP-Norm=2.327 | FP-Norm(final)=2.277 | 1646.9 samples/s | 25.7 steps/s
[Step=2400 Epoch=22.7] | Loss=0.00410 | Reg=0.00559 | acc=1.0000 | FP-Norm=2.276 | FP-Norm(final)=2.280 | 3413.3 samples/s | 53.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step2400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.42279 | Reg=0.00000 | acc=0.6094 | FP-Norm=0.000 | FP-Norm(final)=2.255 | 3247.1 samples/s | 50.7 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.06087 | Reg=0.00815 | acc=1.0000 | FP-Norm=2.708 | FP-Norm(final)=2.227 | 3484.5 samples/s | 54.4 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.03205 | Reg=0.00913 | acc=1.0000 | FP-Norm=2.943 | FP-Norm(final)=2.231 | 4647.0 samples/s | 72.6 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.02149 | Reg=0.00886 | acc=1.0000 | FP-Norm=2.924 | FP-Norm(final)=2.238 | 1465.4 samples/s | 22.9 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01621 | Reg=0.00841 | acc=1.0000 | FP-Norm=2.856 | FP-Norm(final)=2.243 | 4209.6 samples/s | 65.8 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01301 | Reg=0.00796 | acc=1.0000 | FP-Norm=2.782 | FP-Norm(final)=2.247 | 1525.2 samples/s | 23.8 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01098 | Reg=0.00758 | acc=1.0000 | FP-Norm=2.716 | FP-Norm(final)=2.251 | 4044.2 samples/s | 63.2 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00943 | Reg=0.00724 | acc=1.0000 | FP-Norm=2.652 | FP-Norm(final)=2.254 | 1558.7 samples/s | 24.4 steps/s
[Step=1200 Epoch=11.5] | Loss=0.00827 | Reg=0.00691 | acc=1.0000 | FP-Norm=2.589 | FP-Norm(final)=2.257 | 3878.5 samples/s | 60.6 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00737 | Reg=0.00660 | acc=1.0000 | FP-Norm=2.527 | FP-Norm(final)=2.260 | 1566.1 samples/s | 24.5 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00665 | Reg=0.00632 | acc=1.0000 | FP-Norm=2.468 | FP-Norm(final)=2.263 | 3718.4 samples/s | 58.1 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00606 | Reg=0.00605 | acc=1.0000 | FP-Norm=2.412 | FP-Norm(final)=2.265 | 1615.8 samples/s | 25.2 steps/s
[Step=1400 Epoch=13.4] | Loss=0.00557 | Reg=0.00581 | acc=1.0000 | FP-Norm=2.359 | FP-Norm(final)=2.268 | 3476.1 samples/s | 54.3 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00516 | Reg=0.00558 | acc=1.0000 | FP-Norm=2.308 | FP-Norm(final)=2.271 | 1666.5 samples/s | 26.0 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00480 | Reg=0.00537 | acc=1.0000 | FP-Norm=2.259 | FP-Norm(final)=2.273 | 3523.4 samples/s | 55.1 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00449 | Reg=0.00518 | acc=1.0000 | FP-Norm=2.213 | FP-Norm(final)=2.275 | 1663.3 samples/s | 26.0 steps/s
[Step=1600 Epoch=15.3] | Loss=0.00422 | Reg=0.00500 | acc=1.0000 | FP-Norm=2.169 | FP-Norm(final)=2.278 | 3522.9 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17918 | acc=0.8401 | tpr=0.8148 | fpr=0.1051 | 3444.9 samples/s | 13.5 steps/s
Avg test loss: 0.18039, Avg test acc: 0.84149, Avg tpr: 0.81506, Avg fpr: 0.10037, total FA: 783

Testing server on iccad2012
[Step=  50] | Loss=0.58984 | acc=0.4889 | tpr=0.9513 | fpr=0.5194 | 3482.7 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.59076 | acc=0.4895 | tpr=0.9659 | fpr=0.5194 | 6673.0 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.59092 | acc=0.4913 | tpr=0.9669 | fpr=0.5175 | 6567.5 samples/s | 25.7 steps/s
[Step= 200] | Loss=0.59162 | acc=0.4922 | tpr=0.9650 | fpr=0.5164 | 6574.8 samples/s | 25.7 steps/s
[Step= 250] | Loss=0.59138 | acc=0.4922 | tpr=0.9633 | fpr=0.5164 | 6538.2 samples/s | 25.5 steps/s
[Step= 300] | Loss=0.59139 | acc=0.4924 | tpr=0.9607 | fpr=0.5161 | 6653.9 samples/s | 26.0 steps/s
[Step= 350] | Loss=0.59194 | acc=0.4928 | tpr=0.9618 | fpr=0.5157 | 6454.6 samples/s | 25.2 steps/s
[Step= 400] | Loss=0.59340 | acc=0.4919 | tpr=0.9633 | fpr=0.5167 | 6477.6 samples/s | 25.3 steps/s
[Step= 450] | Loss=0.59495 | acc=0.4912 | tpr=0.9640 | fpr=0.5173 | 6242.1 samples/s | 24.4 steps/s
[Step= 500] | Loss=0.59554 | acc=0.4919 | tpr=0.9656 | fpr=0.5166 | 6565.3 samples/s | 25.6 steps/s
[Step= 550] | Loss=0.59448 | acc=0.4922 | tpr=0.9658 | fpr=0.5164 | 11961.0 samples/s | 46.7 steps/s
Avg test loss: 0.59504, Avg test acc: 0.49187, Avg tpr: 0.96593, Avg fpr: 0.51675, total FA: 71750

server round 4/50

clients selected: [1 3 4 5 6]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.13860 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.301 | 3542.0 samples/s | 55.3 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.12120 | Reg=0.00171 | acc=0.8594 | FP-Norm=1.222 | FP-Norm(final)=2.289 | 3458.4 samples/s | 54.0 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.10577 | Reg=0.00231 | acc=0.9375 | FP-Norm=1.463 | FP-Norm(final)=2.289 | 3650.6 samples/s | 57.0 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.09507 | Reg=0.00271 | acc=0.9844 | FP-Norm=1.601 | FP-Norm(final)=2.295 | 3639.9 samples/s | 56.9 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08936 | Reg=0.00312 | acc=0.9844 | FP-Norm=1.722 | FP-Norm(final)=2.300 | 4718.4 samples/s | 73.7 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08084 | Reg=0.00350 | acc=0.9375 | FP-Norm=1.825 | FP-Norm(final)=2.305 | 1557.8 samples/s | 24.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07709 | Reg=0.00384 | acc=0.8906 | FP-Norm=1.913 | FP-Norm(final)=2.311 | 3652.9 samples/s | 57.1 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07296 | Reg=0.00418 | acc=0.9844 | FP-Norm=1.996 | FP-Norm(final)=2.317 | 3618.2 samples/s | 56.5 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06905 | Reg=0.00449 | acc=1.0000 | FP-Norm=2.068 | FP-Norm(final)=2.323 | 4388.9 samples/s | 68.6 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06526 | Reg=0.00478 | acc=1.0000 | FP-Norm=2.135 | FP-Norm(final)=2.330 | 1571.2 samples/s | 24.5 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06170 | Reg=0.00505 | acc=0.9844 | FP-Norm=2.194 | FP-Norm(final)=2.337 | 3655.4 samples/s | 57.1 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05954 | Reg=0.00531 | acc=1.0000 | FP-Norm=2.251 | FP-Norm(final)=2.343 | 3679.1 samples/s | 57.5 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05711 | Reg=0.00556 | acc=0.9375 | FP-Norm=2.304 | FP-Norm(final)=2.349 | 4291.7 samples/s | 67.1 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05503 | Reg=0.00581 | acc=0.9844 | FP-Norm=2.355 | FP-Norm(final)=2.355 | 1616.6 samples/s | 25.3 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05277 | Reg=0.00604 | acc=0.9844 | FP-Norm=2.401 | FP-Norm(final)=2.361 | 3597.3 samples/s | 56.2 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05108 | Reg=0.00626 | acc=0.9844 | FP-Norm=2.444 | FP-Norm(final)=2.366 | 3694.5 samples/s | 57.7 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04962 | Reg=0.00646 | acc=0.9531 | FP-Norm=2.484 | FP-Norm(final)=2.372 | 4063.7 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step2400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.14062 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.301 | 3479.3 samples/s | 54.4 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.10088 | Reg=0.00111 | acc=0.8906 | FP-Norm=0.981 | FP-Norm(final)=2.305 | 3416.8 samples/s | 53.4 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.09430 | Reg=0.00173 | acc=0.9375 | FP-Norm=1.257 | FP-Norm(final)=2.306 | 3674.6 samples/s | 57.4 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.08693 | Reg=0.00219 | acc=0.9219 | FP-Norm=1.425 | FP-Norm(final)=2.309 | 3640.0 samples/s | 56.9 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08207 | Reg=0.00262 | acc=0.9531 | FP-Norm=1.563 | FP-Norm(final)=2.314 | 4724.4 samples/s | 73.8 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07507 | Reg=0.00303 | acc=0.9688 | FP-Norm=1.682 | FP-Norm(final)=2.319 | 1548.9 samples/s | 24.2 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07018 | Reg=0.00339 | acc=0.9688 | FP-Norm=1.782 | FP-Norm(final)=2.326 | 3669.1 samples/s | 57.3 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.06674 | Reg=0.00376 | acc=0.9844 | FP-Norm=1.876 | FP-Norm(final)=2.332 | 3675.1 samples/s | 57.4 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06389 | Reg=0.00412 | acc=0.9844 | FP-Norm=1.963 | FP-Norm(final)=2.336 | 4476.6 samples/s | 69.9 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06951 | Reg=0.00472 | acc=0.9062 | FP-Norm=2.086 | FP-Norm(final)=2.335 | 1587.0 samples/s | 24.8 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06726 | Reg=0.00538 | acc=0.9688 | FP-Norm=2.214 | FP-Norm(final)=2.332 | 3694.8 samples/s | 57.7 steps/s
[Step=2150 Epoch=10.5] | Loss=0.06489 | Reg=0.00586 | acc=0.9844 | FP-Norm=2.310 | FP-Norm(final)=2.332 | 3701.8 samples/s | 57.8 steps/s
[Step=2200 Epoch=10.7] | Loss=0.06210 | Reg=0.00624 | acc=0.9844 | FP-Norm=2.386 | FP-Norm(final)=2.332 | 4184.7 samples/s | 65.4 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05962 | Reg=0.00656 | acc=0.9844 | FP-Norm=2.450 | FP-Norm(final)=2.334 | 1626.4 samples/s | 25.4 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05693 | Reg=0.00683 | acc=0.9844 | FP-Norm=2.505 | FP-Norm(final)=2.336 | 3687.6 samples/s | 57.6 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05465 | Reg=0.00706 | acc=1.0000 | FP-Norm=2.552 | FP-Norm(final)=2.339 | 3676.5 samples/s | 57.4 steps/s
[Step=2400 Epoch=11.7] | Loss=0.05283 | Reg=0.00726 | acc=1.0000 | FP-Norm=2.592 | FP-Norm(final)=2.342 | 3977.1 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step2400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.9] | Loss=0.11634 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.302 | 3615.0 samples/s | 56.5 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.09692 | Reg=0.00119 | acc=0.8906 | FP-Norm=1.008 | FP-Norm(final)=2.304 | 3446.9 samples/s | 53.9 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.09729 | Reg=0.00200 | acc=0.9062 | FP-Norm=1.342 | FP-Norm(final)=2.302 | 3695.3 samples/s | 57.7 steps/s
[Step=1750 Epoch= 8.6] | Loss=0.08956 | Reg=0.00255 | acc=0.9375 | FP-Norm=1.531 | FP-Norm(final)=2.306 | 3682.1 samples/s | 57.5 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08315 | Reg=0.00301 | acc=0.9375 | FP-Norm=1.671 | FP-Norm(final)=2.311 | 4816.1 samples/s | 75.3 steps/s
[Step=1850 Epoch= 9.1] | Loss=0.07496 | Reg=0.00342 | acc=0.9688 | FP-Norm=1.788 | FP-Norm(final)=2.318 | 1554.0 samples/s | 24.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.06976 | Reg=0.00378 | acc=0.9844 | FP-Norm=1.884 | FP-Norm(final)=2.327 | 3624.6 samples/s | 56.6 steps/s
[Step=1950 Epoch= 9.6] | Loss=0.06535 | Reg=0.00412 | acc=0.9688 | FP-Norm=1.969 | FP-Norm(final)=2.335 | 3685.9 samples/s | 57.6 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06263 | Reg=0.00444 | acc=0.9844 | FP-Norm=2.045 | FP-Norm(final)=2.340 | 4624.2 samples/s | 72.3 steps/s
[Step=2050 Epoch=10.1] | Loss=0.05928 | Reg=0.00474 | acc=1.0000 | FP-Norm=2.114 | FP-Norm(final)=2.345 | 1541.2 samples/s | 24.1 steps/s
[Step=2100 Epoch=10.3] | Loss=0.05651 | Reg=0.00501 | acc=0.9688 | FP-Norm=2.177 | FP-Norm(final)=2.351 | 3654.4 samples/s | 57.1 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05443 | Reg=0.00529 | acc=0.9531 | FP-Norm=2.237 | FP-Norm(final)=2.357 | 3710.7 samples/s | 58.0 steps/s
[Step=2200 Epoch=10.8] | Loss=0.05284 | Reg=0.00555 | acc=1.0000 | FP-Norm=2.293 | FP-Norm(final)=2.361 | 4355.3 samples/s | 68.1 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05112 | Reg=0.00580 | acc=0.9688 | FP-Norm=2.345 | FP-Norm(final)=2.366 | 1582.4 samples/s | 24.7 steps/s
[Step=2300 Epoch=11.3] | Loss=0.04935 | Reg=0.00604 | acc=1.0000 | FP-Norm=2.393 | FP-Norm(final)=2.371 | 3691.0 samples/s | 57.7 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04815 | Reg=0.00628 | acc=0.9844 | FP-Norm=2.440 | FP-Norm(final)=2.376 | 3726.1 samples/s | 58.2 steps/s
[Step=2400 Epoch=11.8] | Loss=0.04702 | Reg=0.00650 | acc=1.0000 | FP-Norm=2.484 | FP-Norm(final)=2.380 | 4171.0 samples/s | 65.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step2400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.16306 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.300 | 3333.7 samples/s | 52.1 steps/s
[Step=2450 Epoch=23.2] | Loss=0.02388 | Reg=0.00792 | acc=0.9844 | FP-Norm=2.681 | FP-Norm(final)=2.296 | 3428.8 samples/s | 53.6 steps/s
[Step=2500 Epoch=23.7] | Loss=0.01863 | Reg=0.00853 | acc=0.9844 | FP-Norm=2.851 | FP-Norm(final)=2.298 | 4567.4 samples/s | 71.4 steps/s
[Step=2550 Epoch=24.2] | Loss=0.01548 | Reg=0.00912 | acc=0.9844 | FP-Norm=2.971 | FP-Norm(final)=2.293 | 1519.0 samples/s | 23.7 steps/s
[Step=2600 Epoch=24.6] | Loss=0.01183 | Reg=0.00928 | acc=1.0000 | FP-Norm=3.008 | FP-Norm(final)=2.289 | 4247.1 samples/s | 66.4 steps/s
[Step=2650 Epoch=25.1] | Loss=0.00951 | Reg=0.00911 | acc=1.0000 | FP-Norm=2.988 | FP-Norm(final)=2.289 | 1548.1 samples/s | 24.2 steps/s
[Step=2700 Epoch=25.6] | Loss=0.00794 | Reg=0.00882 | acc=1.0000 | FP-Norm=2.942 | FP-Norm(final)=2.290 | 3999.3 samples/s | 62.5 steps/s
[Step=2750 Epoch=26.1] | Loss=0.00682 | Reg=0.00849 | acc=1.0000 | FP-Norm=2.886 | FP-Norm(final)=2.291 | 1564.2 samples/s | 24.4 steps/s
[Step=2800 Epoch=26.5] | Loss=0.00597 | Reg=0.00815 | acc=1.0000 | FP-Norm=2.826 | FP-Norm(final)=2.293 | 3745.6 samples/s | 58.5 steps/s
[Step=2850 Epoch=27.0] | Loss=0.00532 | Reg=0.00783 | acc=1.0000 | FP-Norm=2.766 | FP-Norm(final)=2.295 | 1605.0 samples/s | 25.1 steps/s
[Step=2900 Epoch=27.5] | Loss=0.00479 | Reg=0.00751 | acc=1.0000 | FP-Norm=2.706 | FP-Norm(final)=2.296 | 3634.1 samples/s | 56.8 steps/s
[Step=2950 Epoch=28.0] | Loss=0.00436 | Reg=0.00722 | acc=1.0000 | FP-Norm=2.648 | FP-Norm(final)=2.298 | 1630.6 samples/s | 25.5 steps/s
[Step=3000 Epoch=28.4] | Loss=0.00401 | Reg=0.00694 | acc=1.0000 | FP-Norm=2.592 | FP-Norm(final)=2.300 | 3495.8 samples/s | 54.6 steps/s
[Step=3050 Epoch=28.9] | Loss=0.00371 | Reg=0.00668 | acc=1.0000 | FP-Norm=2.537 | FP-Norm(final)=2.302 | 1632.2 samples/s | 25.5 steps/s
[Step=3100 Epoch=29.4] | Loss=0.00345 | Reg=0.00644 | acc=1.0000 | FP-Norm=2.485 | FP-Norm(final)=2.304 | 3527.0 samples/s | 55.1 steps/s
[Step=3150 Epoch=29.8] | Loss=0.00323 | Reg=0.00620 | acc=1.0000 | FP-Norm=2.434 | FP-Norm(final)=2.306 | 1692.4 samples/s | 26.4 steps/s
[Step=3200 Epoch=30.3] | Loss=0.00303 | Reg=0.00599 | acc=1.0000 | FP-Norm=2.385 | FP-Norm(final)=2.308 | 3448.3 samples/s | 53.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step3200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.22566 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.301 | 3452.7 samples/s | 53.9 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.03903 | Reg=0.00186 | acc=0.9688 | FP-Norm=1.308 | FP-Norm(final)=2.304 | 3360.8 samples/s | 52.5 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.02236 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.456 | FP-Norm(final)=2.318 | 4641.0 samples/s | 72.5 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.01567 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.499 | FP-Norm(final)=2.327 | 1467.8 samples/s | 22.9 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.01185 | Reg=0.00228 | acc=1.0000 | FP-Norm=1.493 | FP-Norm(final)=2.334 | 4316.4 samples/s | 67.4 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.00964 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.476 | FP-Norm(final)=2.340 | 1546.7 samples/s | 24.2 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.00807 | Reg=0.00215 | acc=1.0000 | FP-Norm=1.454 | FP-Norm(final)=2.346 | 4035.9 samples/s | 63.1 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.00694 | Reg=0.00208 | acc=1.0000 | FP-Norm=1.428 | FP-Norm(final)=2.350 | 1554.5 samples/s | 24.3 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.00609 | Reg=0.00200 | acc=1.0000 | FP-Norm=1.400 | FP-Norm(final)=2.354 | 3836.8 samples/s | 59.9 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.00543 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.374 | FP-Norm(final)=2.358 | 1624.3 samples/s | 25.4 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.00490 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.348 | FP-Norm(final)=2.361 | 3579.3 samples/s | 55.9 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.00447 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.325 | FP-Norm(final)=2.364 | 1667.7 samples/s | 26.1 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.00411 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.303 | FP-Norm(final)=2.367 | 3494.4 samples/s | 54.6 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.00381 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.283 | FP-Norm(final)=2.369 | 1658.9 samples/s | 25.9 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.00355 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.265 | FP-Norm(final)=2.372 | 3571.6 samples/s | 55.8 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00332 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.247 | FP-Norm(final)=2.375 | 1622.6 samples/s | 25.4 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00312 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.231 | FP-Norm(final)=2.377 | 3517.3 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22432 | acc=0.8156 | tpr=0.7631 | fpr=0.0704 | 3480.4 samples/s | 13.6 steps/s
Avg test loss: 0.22802, Avg test acc: 0.81557, Avg tpr: 0.76255, Avg fpr: 0.06781, total FA: 529

Testing server on iccad2012
[Step=  50] | Loss=0.53208 | acc=0.6022 | tpr=0.9558 | fpr=0.4042 | 3439.8 samples/s | 13.4 steps/s
[Step= 100] | Loss=0.53443 | acc=0.6026 | tpr=0.9638 | fpr=0.4042 | 6684.8 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.53541 | acc=0.6047 | tpr=0.9669 | fpr=0.4020 | 6461.0 samples/s | 25.2 steps/s
[Step= 200] | Loss=0.53610 | acc=0.6049 | tpr=0.9650 | fpr=0.4016 | 6340.6 samples/s | 24.8 steps/s
[Step= 250] | Loss=0.53589 | acc=0.6054 | tpr=0.9642 | fpr=0.4012 | 6532.6 samples/s | 25.5 steps/s
[Step= 300] | Loss=0.53600 | acc=0.6053 | tpr=0.9615 | fpr=0.4012 | 6554.7 samples/s | 25.6 steps/s
[Step= 350] | Loss=0.53684 | acc=0.6059 | tpr=0.9606 | fpr=0.4005 | 6877.1 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.53845 | acc=0.6044 | tpr=0.9606 | fpr=0.4021 | 6295.8 samples/s | 24.6 steps/s
[Step= 450] | Loss=0.54058 | acc=0.6040 | tpr=0.9611 | fpr=0.4025 | 6256.0 samples/s | 24.4 steps/s
[Step= 500] | Loss=0.54128 | acc=0.6040 | tpr=0.9621 | fpr=0.4025 | 6390.9 samples/s | 25.0 steps/s
[Step= 550] | Loss=0.54001 | acc=0.6046 | tpr=0.9626 | fpr=0.4019 | 12192.9 samples/s | 47.6 steps/s
Avg test loss: 0.54053, Avg test acc: 0.60433, Avg tpr: 0.96276, Avg fpr: 0.40218, total FA: 55842

server round 5/50

clients selected: [1 3 5 6 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.25940 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.358 | 3512.7 samples/s | 54.9 steps/s
[Step=2450 Epoch=12.0] | Loss=0.09405 | Reg=0.00156 | acc=0.9844 | FP-Norm=1.184 | FP-Norm(final)=2.343 | 3603.3 samples/s | 56.3 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08842 | Reg=0.00215 | acc=0.9531 | FP-Norm=1.420 | FP-Norm(final)=2.343 | 3697.0 samples/s | 57.8 steps/s
[Step=2550 Epoch=12.4] | Loss=0.08225 | Reg=0.00260 | acc=0.9531 | FP-Norm=1.570 | FP-Norm(final)=2.346 | 3683.3 samples/s | 57.6 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07892 | Reg=0.00303 | acc=0.8906 | FP-Norm=1.697 | FP-Norm(final)=2.347 | 4772.5 samples/s | 74.6 steps/s
[Step=2650 Epoch=12.9] | Loss=0.07125 | Reg=0.00340 | acc=0.9844 | FP-Norm=1.800 | FP-Norm(final)=2.350 | 1515.6 samples/s | 23.7 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06497 | Reg=0.00372 | acc=0.9531 | FP-Norm=1.883 | FP-Norm(final)=2.356 | 3676.7 samples/s | 57.4 steps/s
[Step=2750 Epoch=13.4] | Loss=0.06189 | Reg=0.00400 | acc=0.9688 | FP-Norm=1.956 | FP-Norm(final)=2.362 | 3722.7 samples/s | 58.2 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05959 | Reg=0.00428 | acc=0.9688 | FP-Norm=2.024 | FP-Norm(final)=2.366 | 4513.6 samples/s | 70.5 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05651 | Reg=0.00456 | acc=0.9844 | FP-Norm=2.087 | FP-Norm(final)=2.371 | 1591.1 samples/s | 24.9 steps/s
[Step=2900 Epoch=14.2] | Loss=0.05383 | Reg=0.00481 | acc=0.9844 | FP-Norm=2.145 | FP-Norm(final)=2.376 | 3680.2 samples/s | 57.5 steps/s
[Step=2950 Epoch=14.4] | Loss=0.05151 | Reg=0.00503 | acc=0.9844 | FP-Norm=2.194 | FP-Norm(final)=2.381 | 3710.6 samples/s | 58.0 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04974 | Reg=0.00524 | acc=1.0000 | FP-Norm=2.239 | FP-Norm(final)=2.386 | 4300.5 samples/s | 67.2 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04816 | Reg=0.00544 | acc=0.9844 | FP-Norm=2.283 | FP-Norm(final)=2.391 | 1607.2 samples/s | 25.1 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04635 | Reg=0.00562 | acc=0.9531 | FP-Norm=2.322 | FP-Norm(final)=2.396 | 3665.3 samples/s | 57.3 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04471 | Reg=0.00579 | acc=0.9844 | FP-Norm=2.358 | FP-Norm(final)=2.401 | 3725.1 samples/s | 58.2 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04337 | Reg=0.00596 | acc=0.9531 | FP-Norm=2.392 | FP-Norm(final)=2.406 | 4089.5 samples/s | 63.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step3200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.14187 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.359 | 3613.7 samples/s | 56.5 steps/s
[Step=2450 Epoch=11.9] | Loss=0.09358 | Reg=0.00139 | acc=0.9688 | FP-Norm=1.108 | FP-Norm(final)=2.349 | 3450.8 samples/s | 53.9 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08593 | Reg=0.00188 | acc=0.9531 | FP-Norm=1.325 | FP-Norm(final)=2.351 | 3690.5 samples/s | 57.7 steps/s
[Step=2550 Epoch=12.4] | Loss=0.08003 | Reg=0.00225 | acc=0.9688 | FP-Norm=1.457 | FP-Norm(final)=2.353 | 3691.0 samples/s | 57.7 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07572 | Reg=0.00257 | acc=0.9531 | FP-Norm=1.564 | FP-Norm(final)=2.357 | 4749.7 samples/s | 74.2 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06848 | Reg=0.00290 | acc=0.9531 | FP-Norm=1.662 | FP-Norm(final)=2.363 | 1550.6 samples/s | 24.2 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06309 | Reg=0.00320 | acc=1.0000 | FP-Norm=1.746 | FP-Norm(final)=2.369 | 3674.0 samples/s | 57.4 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05888 | Reg=0.00346 | acc=0.9531 | FP-Norm=1.817 | FP-Norm(final)=2.375 | 3680.4 samples/s | 57.5 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05699 | Reg=0.00372 | acc=0.9531 | FP-Norm=1.884 | FP-Norm(final)=2.382 | 4458.5 samples/s | 69.7 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05462 | Reg=0.00396 | acc=1.0000 | FP-Norm=1.944 | FP-Norm(final)=2.387 | 1594.4 samples/s | 24.9 steps/s
[Step=2900 Epoch=14.1] | Loss=0.05236 | Reg=0.00420 | acc=0.9688 | FP-Norm=2.003 | FP-Norm(final)=2.391 | 3612.5 samples/s | 56.4 steps/s
[Step=2950 Epoch=14.4] | Loss=0.05027 | Reg=0.00443 | acc=0.9844 | FP-Norm=2.056 | FP-Norm(final)=2.396 | 3627.9 samples/s | 56.7 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04791 | Reg=0.00464 | acc=0.9844 | FP-Norm=2.104 | FP-Norm(final)=2.401 | 4218.0 samples/s | 65.9 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04858 | Reg=0.00490 | acc=0.9531 | FP-Norm=2.160 | FP-Norm(final)=2.405 | 1594.7 samples/s | 24.9 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04798 | Reg=0.00524 | acc=0.9531 | FP-Norm=2.227 | FP-Norm(final)=2.407 | 3705.4 samples/s | 57.9 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04700 | Reg=0.00552 | acc=0.9688 | FP-Norm=2.284 | FP-Norm(final)=2.410 | 3678.7 samples/s | 57.5 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04598 | Reg=0.00578 | acc=0.9688 | FP-Norm=2.335 | FP-Norm(final)=2.413 | 3989.6 samples/s | 62.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step3200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.3] | Loss=0.24664 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.356 | 3268.7 samples/s | 51.1 steps/s
[Step=3250 Epoch=30.8] | Loss=0.04665 | Reg=0.00862 | acc=0.9688 | FP-Norm=2.778 | FP-Norm(final)=2.309 | 3415.3 samples/s | 53.4 steps/s
[Step=3300 Epoch=31.3] | Loss=0.02865 | Reg=0.01035 | acc=1.0000 | FP-Norm=3.126 | FP-Norm(final)=2.296 | 4491.5 samples/s | 70.2 steps/s
[Step=3350 Epoch=31.7] | Loss=0.01985 | Reg=0.01030 | acc=1.0000 | FP-Norm=3.149 | FP-Norm(final)=2.295 | 1501.7 samples/s | 23.5 steps/s
[Step=3400 Epoch=32.2] | Loss=0.01515 | Reg=0.00988 | acc=1.0000 | FP-Norm=3.095 | FP-Norm(final)=2.299 | 4284.1 samples/s | 66.9 steps/s
[Step=3450 Epoch=32.7] | Loss=0.01216 | Reg=0.00941 | acc=1.0000 | FP-Norm=3.024 | FP-Norm(final)=2.303 | 1532.1 samples/s | 23.9 steps/s
[Step=3500 Epoch=33.2] | Loss=0.01017 | Reg=0.00894 | acc=1.0000 | FP-Norm=2.948 | FP-Norm(final)=2.308 | 4029.3 samples/s | 63.0 steps/s
[Step=3550 Epoch=33.6] | Loss=0.00873 | Reg=0.00850 | acc=1.0000 | FP-Norm=2.874 | FP-Norm(final)=2.312 | 1576.7 samples/s | 24.6 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00765 | Reg=0.00810 | acc=1.0000 | FP-Norm=2.802 | FP-Norm(final)=2.315 | 3810.1 samples/s | 59.5 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00681 | Reg=0.00773 | acc=1.0000 | FP-Norm=2.733 | FP-Norm(final)=2.319 | 1586.8 samples/s | 24.8 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00614 | Reg=0.00739 | acc=1.0000 | FP-Norm=2.667 | FP-Norm(final)=2.322 | 3559.7 samples/s | 55.6 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00559 | Reg=0.00707 | acc=1.0000 | FP-Norm=2.605 | FP-Norm(final)=2.325 | 1649.0 samples/s | 25.8 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00513 | Reg=0.00678 | acc=1.0000 | FP-Norm=2.546 | FP-Norm(final)=2.328 | 3552.4 samples/s | 55.5 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00474 | Reg=0.00652 | acc=1.0000 | FP-Norm=2.490 | FP-Norm(final)=2.331 | 1662.2 samples/s | 26.0 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00441 | Reg=0.00626 | acc=1.0000 | FP-Norm=2.436 | FP-Norm(final)=2.334 | 3548.5 samples/s | 55.4 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00412 | Reg=0.00603 | acc=1.0000 | FP-Norm=2.384 | FP-Norm(final)=2.337 | 1663.6 samples/s | 26.0 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00387 | Reg=0.00581 | acc=1.0000 | FP-Norm=2.335 | FP-Norm(final)=2.340 | 3495.8 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.30517 | Reg=0.00000 | acc=0.7344 | FP-Norm=0.000 | FP-Norm(final)=2.357 | 3565.9 samples/s | 55.7 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.05152 | Reg=0.00875 | acc=1.0000 | FP-Norm=2.821 | FP-Norm(final)=2.318 | 3297.9 samples/s | 51.5 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.02744 | Reg=0.00932 | acc=1.0000 | FP-Norm=2.982 | FP-Norm(final)=2.321 | 4563.8 samples/s | 71.3 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01841 | Reg=0.00887 | acc=1.0000 | FP-Norm=2.928 | FP-Norm(final)=2.329 | 1507.2 samples/s | 23.6 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01388 | Reg=0.00833 | acc=1.0000 | FP-Norm=2.843 | FP-Norm(final)=2.336 | 4269.3 samples/s | 66.7 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01114 | Reg=0.00782 | acc=1.0000 | FP-Norm=2.757 | FP-Norm(final)=2.341 | 1547.9 samples/s | 24.2 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00930 | Reg=0.00737 | acc=1.0000 | FP-Norm=2.674 | FP-Norm(final)=2.346 | 3958.4 samples/s | 61.9 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00799 | Reg=0.00697 | acc=1.0000 | FP-Norm=2.597 | FP-Norm(final)=2.350 | 1575.8 samples/s | 24.6 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00701 | Reg=0.00661 | acc=1.0000 | FP-Norm=2.525 | FP-Norm(final)=2.354 | 3818.2 samples/s | 59.7 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00625 | Reg=0.00628 | acc=1.0000 | FP-Norm=2.458 | FP-Norm(final)=2.357 | 1603.1 samples/s | 25.0 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00563 | Reg=0.00599 | acc=1.0000 | FP-Norm=2.395 | FP-Norm(final)=2.360 | 3625.8 samples/s | 56.7 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00513 | Reg=0.00572 | acc=1.0000 | FP-Norm=2.336 | FP-Norm(final)=2.363 | 1635.1 samples/s | 25.5 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00471 | Reg=0.00548 | acc=1.0000 | FP-Norm=2.280 | FP-Norm(final)=2.366 | 3503.0 samples/s | 54.7 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00436 | Reg=0.00525 | acc=1.0000 | FP-Norm=2.227 | FP-Norm(final)=2.369 | 1668.4 samples/s | 26.1 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00406 | Reg=0.00504 | acc=1.0000 | FP-Norm=2.176 | FP-Norm(final)=2.371 | 3467.1 samples/s | 54.2 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00380 | Reg=0.00485 | acc=1.0000 | FP-Norm=2.129 | FP-Norm(final)=2.374 | 1681.5 samples/s | 26.3 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00357 | Reg=0.00467 | acc=1.0000 | FP-Norm=2.084 | FP-Norm(final)=2.377 | 3449.1 samples/s | 53.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step1600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.3] | Loss=0.25556 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.357 | 3479.0 samples/s | 54.4 steps/s
[Step=1650 Epoch=15.7] | Loss=0.03019 | Reg=0.00537 | acc=1.0000 | FP-Norm=2.199 | FP-Norm(final)=2.330 | 3332.2 samples/s | 52.1 steps/s
[Step=1700 Epoch=16.2] | Loss=0.01639 | Reg=0.00601 | acc=1.0000 | FP-Norm=2.388 | FP-Norm(final)=2.334 | 4565.8 samples/s | 71.3 steps/s
[Step=1750 Epoch=16.7] | Loss=0.01113 | Reg=0.00590 | acc=1.0000 | FP-Norm=2.386 | FP-Norm(final)=2.339 | 1509.0 samples/s | 23.6 steps/s
[Step=1800 Epoch=17.2] | Loss=0.00841 | Reg=0.00564 | acc=1.0000 | FP-Norm=2.341 | FP-Norm(final)=2.344 | 4379.0 samples/s | 68.4 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00674 | Reg=0.00536 | acc=1.0000 | FP-Norm=2.284 | FP-Norm(final)=2.348 | 1510.4 samples/s | 23.6 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00563 | Reg=0.00508 | acc=1.0000 | FP-Norm=2.224 | FP-Norm(final)=2.351 | 4140.9 samples/s | 64.7 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00484 | Reg=0.00483 | acc=1.0000 | FP-Norm=2.166 | FP-Norm(final)=2.354 | 1570.6 samples/s | 24.5 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00425 | Reg=0.00459 | acc=1.0000 | FP-Norm=2.110 | FP-Norm(final)=2.356 | 3933.9 samples/s | 61.5 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00379 | Reg=0.00438 | acc=1.0000 | FP-Norm=2.056 | FP-Norm(final)=2.358 | 1572.1 samples/s | 24.6 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00342 | Reg=0.00418 | acc=1.0000 | FP-Norm=2.006 | FP-Norm(final)=2.360 | 3751.2 samples/s | 58.6 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00312 | Reg=0.00400 | acc=1.0000 | FP-Norm=1.957 | FP-Norm(final)=2.363 | 1641.2 samples/s | 25.6 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00287 | Reg=0.00383 | acc=1.0000 | FP-Norm=1.911 | FP-Norm(final)=2.364 | 3554.8 samples/s | 55.5 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00265 | Reg=0.00368 | acc=1.0000 | FP-Norm=1.868 | FP-Norm(final)=2.366 | 1664.9 samples/s | 26.0 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00247 | Reg=0.00353 | acc=1.0000 | FP-Norm=1.827 | FP-Norm(final)=2.368 | 3523.1 samples/s | 55.0 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00232 | Reg=0.00340 | acc=1.0000 | FP-Norm=1.788 | FP-Norm(final)=2.370 | 1642.4 samples/s | 25.7 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00218 | Reg=0.00327 | acc=1.0000 | FP-Norm=1.750 | FP-Norm(final)=2.372 | 3519.2 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25252 | acc=0.7952 | tpr=0.7289 | fpr=0.0610 | 3480.4 samples/s | 13.6 steps/s
Avg test loss: 0.25612, Avg test acc: 0.79369, Avg tpr: 0.72670, Avg fpr: 0.05897, total FA: 460

Testing server on iccad2012
[Step=  50] | Loss=0.44406 | acc=0.6929 | tpr=0.9602 | fpr=0.3119 | 3472.8 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.44727 | acc=0.6911 | tpr=0.9701 | fpr=0.3141 | 6586.4 samples/s | 25.7 steps/s
[Step= 150] | Loss=0.44814 | acc=0.6930 | tpr=0.9669 | fpr=0.3121 | 6322.8 samples/s | 24.7 steps/s
[Step= 200] | Loss=0.44874 | acc=0.6930 | tpr=0.9650 | fpr=0.3119 | 6552.9 samples/s | 25.6 steps/s
[Step= 250] | Loss=0.44872 | acc=0.6935 | tpr=0.9651 | fpr=0.3114 | 6569.1 samples/s | 25.7 steps/s
[Step= 300] | Loss=0.44907 | acc=0.6942 | tpr=0.9629 | fpr=0.3107 | 6515.4 samples/s | 25.5 steps/s
[Step= 350] | Loss=0.45011 | acc=0.6946 | tpr=0.9618 | fpr=0.3102 | 6368.8 samples/s | 24.9 steps/s
[Step= 400] | Loss=0.45151 | acc=0.6934 | tpr=0.9617 | fpr=0.3115 | 6728.1 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.45341 | acc=0.6927 | tpr=0.9615 | fpr=0.3122 | 6347.2 samples/s | 24.8 steps/s
[Step= 500] | Loss=0.45404 | acc=0.6920 | tpr=0.9621 | fpr=0.3129 | 6397.5 samples/s | 25.0 steps/s
[Step= 550] | Loss=0.45288 | acc=0.6928 | tpr=0.9618 | fpr=0.3121 | 12323.7 samples/s | 48.1 steps/s
Avg test loss: 0.45328, Avg test acc: 0.69264, Avg tpr: 0.96197, Avg fpr: 0.31226, total FA: 43356

server round 6/50

clients selected: [2 4 5 7 8]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.13175 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.384 | 3476.8 samples/s | 54.3 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.09684 | Reg=0.00141 | acc=0.9219 | FP-Norm=1.117 | FP-Norm(final)=2.362 | 3556.4 samples/s | 55.6 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08437 | Reg=0.00198 | acc=0.9375 | FP-Norm=1.357 | FP-Norm(final)=2.364 | 3712.3 samples/s | 58.0 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.07971 | Reg=0.00234 | acc=0.9688 | FP-Norm=1.487 | FP-Norm(final)=2.367 | 3667.2 samples/s | 57.3 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.07478 | Reg=0.00267 | acc=0.9375 | FP-Norm=1.594 | FP-Norm(final)=2.371 | 4693.2 samples/s | 73.3 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.06791 | Reg=0.00298 | acc=1.0000 | FP-Norm=1.685 | FP-Norm(final)=2.374 | 1547.9 samples/s | 24.2 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.06385 | Reg=0.00326 | acc=0.9688 | FP-Norm=1.765 | FP-Norm(final)=2.380 | 3647.9 samples/s | 57.0 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.06075 | Reg=0.00357 | acc=0.9688 | FP-Norm=1.846 | FP-Norm(final)=2.385 | 3711.1 samples/s | 58.0 steps/s
[Step=2000 Epoch= 9.7] | Loss=0.05781 | Reg=0.00386 | acc=1.0000 | FP-Norm=1.918 | FP-Norm(final)=2.389 | 4487.2 samples/s | 70.1 steps/s
[Step=2050 Epoch=10.0] | Loss=0.05482 | Reg=0.00413 | acc=0.9844 | FP-Norm=1.984 | FP-Norm(final)=2.394 | 1598.0 samples/s | 25.0 steps/s
[Step=2100 Epoch=10.2] | Loss=0.05187 | Reg=0.00438 | acc=0.9531 | FP-Norm=2.043 | FP-Norm(final)=2.400 | 3721.2 samples/s | 58.1 steps/s
[Step=2150 Epoch=10.5] | Loss=0.04987 | Reg=0.00462 | acc=0.9844 | FP-Norm=2.097 | FP-Norm(final)=2.405 | 3676.0 samples/s | 57.4 steps/s
[Step=2200 Epoch=10.7] | Loss=0.04896 | Reg=0.00485 | acc=0.9844 | FP-Norm=2.149 | FP-Norm(final)=2.410 | 4152.2 samples/s | 64.9 steps/s
[Step=2250 Epoch=11.0] | Loss=0.04788 | Reg=0.00511 | acc=0.9688 | FP-Norm=2.204 | FP-Norm(final)=2.414 | 1601.8 samples/s | 25.0 steps/s
[Step=2300 Epoch=11.2] | Loss=0.04719 | Reg=0.00539 | acc=1.0000 | FP-Norm=2.261 | FP-Norm(final)=2.417 | 3736.4 samples/s | 58.4 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04615 | Reg=0.00564 | acc=1.0000 | FP-Norm=2.313 | FP-Norm(final)=2.420 | 3711.7 samples/s | 58.0 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04484 | Reg=0.00588 | acc=0.9844 | FP-Norm=2.360 | FP-Norm(final)=2.423 | 3975.3 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step2400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.8] | Loss=0.27774 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.383 | 3400.0 samples/s | 53.1 steps/s
[Step=2450 Epoch=12.0] | Loss=0.09550 | Reg=0.00165 | acc=0.9531 | FP-Norm=1.216 | FP-Norm(final)=2.359 | 3592.2 samples/s | 56.1 steps/s
[Step=2500 Epoch=12.3] | Loss=0.08368 | Reg=0.00218 | acc=0.9375 | FP-Norm=1.430 | FP-Norm(final)=2.358 | 3618.5 samples/s | 56.5 steps/s
[Step=2550 Epoch=12.5] | Loss=0.07600 | Reg=0.00255 | acc=1.0000 | FP-Norm=1.559 | FP-Norm(final)=2.361 | 3610.4 samples/s | 56.4 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07129 | Reg=0.00290 | acc=0.9844 | FP-Norm=1.664 | FP-Norm(final)=2.365 | 4723.4 samples/s | 73.8 steps/s
[Step=2650 Epoch=13.0] | Loss=0.06364 | Reg=0.00322 | acc=0.9844 | FP-Norm=1.757 | FP-Norm(final)=2.369 | 1539.9 samples/s | 24.1 steps/s
[Step=2700 Epoch=13.2] | Loss=0.05870 | Reg=0.00350 | acc=1.0000 | FP-Norm=1.832 | FP-Norm(final)=2.376 | 3674.0 samples/s | 57.4 steps/s
[Step=2750 Epoch=13.5] | Loss=0.05641 | Reg=0.00376 | acc=0.9375 | FP-Norm=1.901 | FP-Norm(final)=2.383 | 3631.8 samples/s | 56.7 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05405 | Reg=0.00401 | acc=0.9844 | FP-Norm=1.963 | FP-Norm(final)=2.388 | 4582.9 samples/s | 71.6 steps/s
[Step=2850 Epoch=14.0] | Loss=0.05116 | Reg=0.00425 | acc=0.9844 | FP-Norm=2.020 | FP-Norm(final)=2.392 | 1574.6 samples/s | 24.6 steps/s
[Step=2900 Epoch=14.2] | Loss=0.04866 | Reg=0.00446 | acc=1.0000 | FP-Norm=2.070 | FP-Norm(final)=2.397 | 3693.7 samples/s | 57.7 steps/s
[Step=2950 Epoch=14.5] | Loss=0.04719 | Reg=0.00466 | acc=0.9844 | FP-Norm=2.117 | FP-Norm(final)=2.401 | 3727.7 samples/s | 58.2 steps/s
[Step=3000 Epoch=14.7] | Loss=0.04545 | Reg=0.00485 | acc=1.0000 | FP-Norm=2.159 | FP-Norm(final)=2.406 | 4339.7 samples/s | 67.8 steps/s
[Step=3050 Epoch=15.0] | Loss=0.04358 | Reg=0.00504 | acc=0.9531 | FP-Norm=2.201 | FP-Norm(final)=2.410 | 1574.5 samples/s | 24.6 steps/s
[Step=3100 Epoch=15.2] | Loss=0.04205 | Reg=0.00521 | acc=1.0000 | FP-Norm=2.238 | FP-Norm(final)=2.415 | 3670.4 samples/s | 57.3 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04120 | Reg=0.00536 | acc=0.9688 | FP-Norm=2.273 | FP-Norm(final)=2.419 | 3686.9 samples/s | 57.6 steps/s
[Step=3200 Epoch=15.7] | Loss=0.04005 | Reg=0.00551 | acc=0.9531 | FP-Norm=2.305 | FP-Norm(final)=2.423 | 4256.3 samples/s | 66.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step3200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=37.9] | Loss=0.07209 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.384 | 3480.6 samples/s | 54.4 steps/s
[Step=4050 Epoch=38.4] | Loss=0.02962 | Reg=0.00519 | acc=1.0000 | FP-Norm=2.145 | FP-Norm(final)=2.363 | 3217.2 samples/s | 50.3 steps/s
[Step=4100 Epoch=38.9] | Loss=0.01624 | Reg=0.00603 | acc=1.0000 | FP-Norm=2.383 | FP-Norm(final)=2.358 | 4540.3 samples/s | 70.9 steps/s
[Step=4150 Epoch=39.3] | Loss=0.01096 | Reg=0.00591 | acc=1.0000 | FP-Norm=2.381 | FP-Norm(final)=2.362 | 1493.2 samples/s | 23.3 steps/s
[Step=4200 Epoch=39.8] | Loss=0.00825 | Reg=0.00561 | acc=1.0000 | FP-Norm=2.329 | FP-Norm(final)=2.366 | 4231.4 samples/s | 66.1 steps/s
[Step=4250 Epoch=40.3] | Loss=0.00662 | Reg=0.00530 | acc=1.0000 | FP-Norm=2.265 | FP-Norm(final)=2.370 | 1541.8 samples/s | 24.1 steps/s
[Step=4300 Epoch=40.7] | Loss=0.00553 | Reg=0.00500 | acc=1.0000 | FP-Norm=2.201 | FP-Norm(final)=2.373 | 4006.1 samples/s | 62.6 steps/s
[Step=4350 Epoch=41.2] | Loss=0.00475 | Reg=0.00473 | acc=1.0000 | FP-Norm=2.139 | FP-Norm(final)=2.376 | 1580.1 samples/s | 24.7 steps/s
[Step=4400 Epoch=41.7] | Loss=0.00416 | Reg=0.00449 | acc=1.0000 | FP-Norm=2.080 | FP-Norm(final)=2.379 | 3774.7 samples/s | 59.0 steps/s
[Step=4450 Epoch=42.2] | Loss=0.00371 | Reg=0.00427 | acc=1.0000 | FP-Norm=2.025 | FP-Norm(final)=2.382 | 1622.1 samples/s | 25.3 steps/s
[Step=4500 Epoch=42.6] | Loss=0.00335 | Reg=0.00407 | acc=1.0000 | FP-Norm=1.972 | FP-Norm(final)=2.384 | 3547.5 samples/s | 55.4 steps/s
[Step=4550 Epoch=43.1] | Loss=0.00305 | Reg=0.00388 | acc=1.0000 | FP-Norm=1.923 | FP-Norm(final)=2.387 | 1651.3 samples/s | 25.8 steps/s
[Step=4600 Epoch=43.6] | Loss=0.00280 | Reg=0.00372 | acc=1.0000 | FP-Norm=1.877 | FP-Norm(final)=2.389 | 3489.2 samples/s | 54.5 steps/s
[Step=4650 Epoch=44.1] | Loss=0.00259 | Reg=0.00356 | acc=1.0000 | FP-Norm=1.833 | FP-Norm(final)=2.391 | 1674.0 samples/s | 26.2 steps/s
[Step=4700 Epoch=44.5] | Loss=0.00241 | Reg=0.00342 | acc=1.0000 | FP-Norm=1.790 | FP-Norm(final)=2.393 | 3555.9 samples/s | 55.6 steps/s
[Step=4750 Epoch=45.0] | Loss=0.00226 | Reg=0.00328 | acc=1.0000 | FP-Norm=1.751 | FP-Norm(final)=2.395 | 1682.7 samples/s | 26.3 steps/s
[Step=4800 Epoch=45.5] | Loss=0.00212 | Reg=0.00316 | acc=1.0000 | FP-Norm=1.713 | FP-Norm(final)=2.397 | 3516.1 samples/s | 54.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step4800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.3] | Loss=0.19394 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.382 | 3470.1 samples/s | 54.2 steps/s
[Step=1650 Epoch=15.8] | Loss=0.03114 | Reg=0.00521 | acc=0.9844 | FP-Norm=2.158 | FP-Norm(final)=2.356 | 3318.4 samples/s | 51.9 steps/s
[Step=1700 Epoch=16.2] | Loss=0.02126 | Reg=0.00665 | acc=1.0000 | FP-Norm=2.500 | FP-Norm(final)=2.345 | 4588.3 samples/s | 71.7 steps/s
[Step=1750 Epoch=16.7] | Loss=0.01487 | Reg=0.00725 | acc=1.0000 | FP-Norm=2.636 | FP-Norm(final)=2.339 | 1501.4 samples/s | 23.5 steps/s
[Step=1800 Epoch=17.2] | Loss=0.01122 | Reg=0.00729 | acc=1.0000 | FP-Norm=2.657 | FP-Norm(final)=2.340 | 4392.5 samples/s | 68.6 steps/s
[Step=1850 Epoch=17.7] | Loss=0.00901 | Reg=0.00713 | acc=1.0000 | FP-Norm=2.636 | FP-Norm(final)=2.342 | 1541.5 samples/s | 24.1 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00752 | Reg=0.00691 | acc=1.0000 | FP-Norm=2.597 | FP-Norm(final)=2.344 | 4109.0 samples/s | 64.2 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00646 | Reg=0.00666 | acc=1.0000 | FP-Norm=2.552 | FP-Norm(final)=2.346 | 1563.2 samples/s | 24.4 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00566 | Reg=0.00642 | acc=1.0000 | FP-Norm=2.503 | FP-Norm(final)=2.349 | 3935.1 samples/s | 61.5 steps/s
[Step=2050 Epoch=19.6] | Loss=0.00504 | Reg=0.00617 | acc=1.0000 | FP-Norm=2.454 | FP-Norm(final)=2.351 | 1584.0 samples/s | 24.8 steps/s
[Step=2100 Epoch=20.1] | Loss=0.00454 | Reg=0.00594 | acc=1.0000 | FP-Norm=2.404 | FP-Norm(final)=2.353 | 3678.5 samples/s | 57.5 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00414 | Reg=0.00572 | acc=1.0000 | FP-Norm=2.355 | FP-Norm(final)=2.356 | 1610.5 samples/s | 25.2 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00380 | Reg=0.00550 | acc=1.0000 | FP-Norm=2.308 | FP-Norm(final)=2.358 | 3481.5 samples/s | 54.4 steps/s
[Step=2250 Epoch=21.5] | Loss=0.00351 | Reg=0.00530 | acc=1.0000 | FP-Norm=2.261 | FP-Norm(final)=2.360 | 1654.1 samples/s | 25.8 steps/s
[Step=2300 Epoch=22.0] | Loss=0.00327 | Reg=0.00511 | acc=1.0000 | FP-Norm=2.215 | FP-Norm(final)=2.362 | 3493.1 samples/s | 54.6 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00305 | Reg=0.00493 | acc=1.0000 | FP-Norm=2.171 | FP-Norm(final)=2.364 | 1679.3 samples/s | 26.2 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00287 | Reg=0.00476 | acc=1.0000 | FP-Norm=2.128 | FP-Norm(final)=2.366 | 3512.8 samples/s | 54.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step2400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.6] | Loss=0.21205 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.382 | 3353.6 samples/s | 52.4 steps/s
[Step=2450 Epoch=23.1] | Loss=0.03254 | Reg=0.00716 | acc=1.0000 | FP-Norm=2.550 | FP-Norm(final)=2.345 | 3393.0 samples/s | 53.0 steps/s
[Step=2500 Epoch=23.6] | Loss=0.01931 | Reg=0.00797 | acc=1.0000 | FP-Norm=2.757 | FP-Norm(final)=2.344 | 4457.4 samples/s | 69.6 steps/s
[Step=2550 Epoch=24.0] | Loss=0.01314 | Reg=0.00779 | acc=1.0000 | FP-Norm=2.746 | FP-Norm(final)=2.349 | 1505.8 samples/s | 23.5 steps/s
[Step=2600 Epoch=24.5] | Loss=0.00990 | Reg=0.00741 | acc=1.0000 | FP-Norm=2.685 | FP-Norm(final)=2.354 | 4233.1 samples/s | 66.1 steps/s
[Step=2650 Epoch=25.0] | Loss=0.00793 | Reg=0.00700 | acc=1.0000 | FP-Norm=2.611 | FP-Norm(final)=2.358 | 1551.0 samples/s | 24.2 steps/s
[Step=2700 Epoch=25.4] | Loss=0.00662 | Reg=0.00661 | acc=1.0000 | FP-Norm=2.536 | FP-Norm(final)=2.362 | 3874.5 samples/s | 60.5 steps/s
[Step=2750 Epoch=25.9] | Loss=0.00568 | Reg=0.00626 | acc=1.0000 | FP-Norm=2.464 | FP-Norm(final)=2.365 | 1615.3 samples/s | 25.2 steps/s
[Step=2800 Epoch=26.4] | Loss=0.00498 | Reg=0.00593 | acc=1.0000 | FP-Norm=2.396 | FP-Norm(final)=2.368 | 3601.4 samples/s | 56.3 steps/s
[Step=2850 Epoch=26.9] | Loss=0.00444 | Reg=0.00564 | acc=1.0000 | FP-Norm=2.331 | FP-Norm(final)=2.370 | 1605.7 samples/s | 25.1 steps/s
[Step=2900 Epoch=27.3] | Loss=0.00400 | Reg=0.00537 | acc=1.0000 | FP-Norm=2.269 | FP-Norm(final)=2.373 | 3512.0 samples/s | 54.9 steps/s
[Step=2950 Epoch=27.8] | Loss=0.00365 | Reg=0.00512 | acc=1.0000 | FP-Norm=2.211 | FP-Norm(final)=2.375 | 1660.6 samples/s | 25.9 steps/s
[Step=3000 Epoch=28.3] | Loss=0.00335 | Reg=0.00490 | acc=1.0000 | FP-Norm=2.156 | FP-Norm(final)=2.377 | 3547.6 samples/s | 55.4 steps/s
[Step=3050 Epoch=28.7] | Loss=0.00310 | Reg=0.00469 | acc=1.0000 | FP-Norm=2.103 | FP-Norm(final)=2.380 | 1650.9 samples/s | 25.8 steps/s
[Step=3100 Epoch=29.2] | Loss=0.00288 | Reg=0.00449 | acc=1.0000 | FP-Norm=2.054 | FP-Norm(final)=2.382 | 3471.7 samples/s | 54.2 steps/s
[Step=3150 Epoch=29.7] | Loss=0.00270 | Reg=0.00431 | acc=1.0000 | FP-Norm=2.006 | FP-Norm(final)=2.384 | 1761.8 samples/s | 27.5 steps/s
[Step=3200 Epoch=30.2] | Loss=0.00253 | Reg=0.00415 | acc=1.0000 | FP-Norm=1.961 | FP-Norm(final)=2.386 | 3141.7 samples/s | 49.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24104 | acc=0.8084 | tpr=0.7411 | fpr=0.0453 | 3467.2 samples/s | 13.5 steps/s
Avg test loss: 0.24588, Avg test acc: 0.80968, Avg tpr: 0.74279, Avg fpr: 0.04320, total FA: 337

Testing server on iccad2012
[Step=  50] | Loss=0.52042 | acc=0.6655 | tpr=0.9646 | fpr=0.3398 | 3461.4 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.52411 | acc=0.6642 | tpr=0.9680 | fpr=0.3415 | 4858.4 samples/s | 19.0 steps/s
[Step= 150] | Loss=0.52468 | acc=0.6664 | tpr=0.9611 | fpr=0.3390 | 5298.0 samples/s | 20.7 steps/s
[Step= 200] | Loss=0.52523 | acc=0.6663 | tpr=0.9585 | fpr=0.3390 | 6173.2 samples/s | 24.1 steps/s
[Step= 250] | Loss=0.52536 | acc=0.6668 | tpr=0.9590 | fpr=0.3385 | 6901.2 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.52578 | acc=0.6670 | tpr=0.9585 | fpr=0.3383 | 6285.0 samples/s | 24.6 steps/s
[Step= 350] | Loss=0.52704 | acc=0.6674 | tpr=0.9580 | fpr=0.3379 | 6546.5 samples/s | 25.6 steps/s
[Step= 400] | Loss=0.52851 | acc=0.6660 | tpr=0.9595 | fpr=0.3393 | 6492.9 samples/s | 25.4 steps/s
[Step= 450] | Loss=0.53056 | acc=0.6654 | tpr=0.9601 | fpr=0.3400 | 6546.8 samples/s | 25.6 steps/s
[Step= 500] | Loss=0.53144 | acc=0.6652 | tpr=0.9612 | fpr=0.3401 | 6576.7 samples/s | 25.7 steps/s
[Step= 550] | Loss=0.53022 | acc=0.6659 | tpr=0.9618 | fpr=0.3395 | 12347.1 samples/s | 48.2 steps/s
Avg test loss: 0.53064, Avg test acc: 0.66567, Avg tpr: 0.96197, Avg fpr: 0.33972, total FA: 47169

server round 7/50

clients selected: [1 2 3 5 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.16152 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.421 | 3537.1 samples/s | 55.3 steps/s
[Step=3250 Epoch=15.9] | Loss=0.08571 | Reg=0.00204 | acc=0.9688 | FP-Norm=1.352 | FP-Norm(final)=2.390 | 3493.4 samples/s | 54.6 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07709 | Reg=0.00250 | acc=0.9375 | FP-Norm=1.536 | FP-Norm(final)=2.388 | 3668.3 samples/s | 57.3 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07120 | Reg=0.00276 | acc=0.9219 | FP-Norm=1.627 | FP-Norm(final)=2.389 | 3633.1 samples/s | 56.8 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06872 | Reg=0.00307 | acc=0.8906 | FP-Norm=1.721 | FP-Norm(final)=2.390 | 4676.2 samples/s | 73.1 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06318 | Reg=0.00335 | acc=0.9688 | FP-Norm=1.798 | FP-Norm(final)=2.391 | 1562.8 samples/s | 24.4 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05795 | Reg=0.00356 | acc=0.9844 | FP-Norm=1.858 | FP-Norm(final)=2.395 | 3698.5 samples/s | 57.8 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05430 | Reg=0.00376 | acc=0.9688 | FP-Norm=1.909 | FP-Norm(final)=2.399 | 3627.9 samples/s | 56.7 steps/s
[Step=3600 Epoch=17.6] | Loss=0.05243 | Reg=0.00395 | acc=1.0000 | FP-Norm=1.959 | FP-Norm(final)=2.402 | 4510.3 samples/s | 70.5 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04955 | Reg=0.00415 | acc=0.9844 | FP-Norm=2.008 | FP-Norm(final)=2.407 | 1562.6 samples/s | 24.4 steps/s
[Step=3700 Epoch=18.1] | Loss=0.04745 | Reg=0.00433 | acc=0.9531 | FP-Norm=2.050 | FP-Norm(final)=2.411 | 3604.6 samples/s | 56.3 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04537 | Reg=0.00450 | acc=1.0000 | FP-Norm=2.090 | FP-Norm(final)=2.416 | 3554.3 samples/s | 55.5 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04428 | Reg=0.00465 | acc=0.9531 | FP-Norm=2.126 | FP-Norm(final)=2.419 | 4153.2 samples/s | 64.9 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04241 | Reg=0.00481 | acc=1.0000 | FP-Norm=2.161 | FP-Norm(final)=2.422 | 1591.4 samples/s | 24.9 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04105 | Reg=0.00496 | acc=1.0000 | FP-Norm=2.194 | FP-Norm(final)=2.425 | 3626.1 samples/s | 56.7 steps/s
[Step=3950 Epoch=19.3] | Loss=0.04000 | Reg=0.00510 | acc=0.9688 | FP-Norm=2.225 | FP-Norm(final)=2.428 | 3652.4 samples/s | 57.1 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03929 | Reg=0.00524 | acc=1.0000 | FP-Norm=2.256 | FP-Norm(final)=2.431 | 4113.1 samples/s | 64.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step4000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.18821 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.421 | 3636.3 samples/s | 56.8 steps/s
[Step=2450 Epoch=11.9] | Loss=0.07494 | Reg=0.00133 | acc=0.9531 | FP-Norm=1.087 | FP-Norm(final)=2.406 | 3396.2 samples/s | 53.1 steps/s
[Step=2500 Epoch=12.2] | Loss=0.07072 | Reg=0.00191 | acc=0.9375 | FP-Norm=1.332 | FP-Norm(final)=2.400 | 3642.7 samples/s | 56.9 steps/s
[Step=2550 Epoch=12.4] | Loss=0.06672 | Reg=0.00226 | acc=0.9375 | FP-Norm=1.462 | FP-Norm(final)=2.402 | 3672.2 samples/s | 57.4 steps/s
[Step=2600 Epoch=12.7] | Loss=0.06498 | Reg=0.00260 | acc=0.9688 | FP-Norm=1.571 | FP-Norm(final)=2.404 | 4716.5 samples/s | 73.7 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06014 | Reg=0.00291 | acc=0.9688 | FP-Norm=1.665 | FP-Norm(final)=2.406 | 1562.3 samples/s | 24.4 steps/s
[Step=2700 Epoch=13.2] | Loss=0.05608 | Reg=0.00318 | acc=0.9844 | FP-Norm=1.743 | FP-Norm(final)=2.411 | 3648.3 samples/s | 57.0 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05316 | Reg=0.00342 | acc=0.9688 | FP-Norm=1.808 | FP-Norm(final)=2.415 | 3687.1 samples/s | 57.6 steps/s
[Step=2800 Epoch=13.6] | Loss=0.05123 | Reg=0.00366 | acc=0.9375 | FP-Norm=1.871 | FP-Norm(final)=2.419 | 4471.1 samples/s | 69.9 steps/s
[Step=2850 Epoch=13.9] | Loss=0.04889 | Reg=0.00389 | acc=0.9844 | FP-Norm=1.930 | FP-Norm(final)=2.423 | 1117.3 samples/s | 17.5 steps/s
[Step=2900 Epoch=14.1] | Loss=0.04735 | Reg=0.00410 | acc=0.9688 | FP-Norm=1.982 | FP-Norm(final)=2.426 | 3317.1 samples/s | 51.8 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04575 | Reg=0.00431 | acc=0.9688 | FP-Norm=2.030 | FP-Norm(final)=2.429 | 3662.6 samples/s | 57.2 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04456 | Reg=0.00450 | acc=0.9844 | FP-Norm=2.075 | FP-Norm(final)=2.432 | 4170.2 samples/s | 65.2 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04295 | Reg=0.00469 | acc=0.9688 | FP-Norm=2.119 | FP-Norm(final)=2.436 | 1620.9 samples/s | 25.3 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04140 | Reg=0.00485 | acc=0.9688 | FP-Norm=2.156 | FP-Norm(final)=2.440 | 3689.5 samples/s | 57.6 steps/s
[Step=3150 Epoch=15.3] | Loss=0.03996 | Reg=0.00500 | acc=0.9844 | FP-Norm=2.190 | FP-Norm(final)=2.443 | 3697.4 samples/s | 57.8 steps/s
[Step=3200 Epoch=15.6] | Loss=0.03912 | Reg=0.00515 | acc=0.9531 | FP-Norm=2.223 | FP-Norm(final)=2.447 | 3953.0 samples/s | 61.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step3200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.07882 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.421 | 3641.3 samples/s | 56.9 steps/s
[Step=3250 Epoch=15.8] | Loss=0.08269 | Reg=0.00151 | acc=0.9531 | FP-Norm=1.157 | FP-Norm(final)=2.394 | 3390.2 samples/s | 53.0 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07673 | Reg=0.00191 | acc=0.9375 | FP-Norm=1.339 | FP-Norm(final)=2.390 | 3662.8 samples/s | 57.2 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06916 | Reg=0.00215 | acc=0.9844 | FP-Norm=1.434 | FP-Norm(final)=2.391 | 3687.9 samples/s | 57.6 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06435 | Reg=0.00240 | acc=0.9844 | FP-Norm=1.520 | FP-Norm(final)=2.394 | 4755.2 samples/s | 74.3 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05810 | Reg=0.00266 | acc=0.9844 | FP-Norm=1.598 | FP-Norm(final)=2.398 | 1549.1 samples/s | 24.2 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05370 | Reg=0.00287 | acc=0.9844 | FP-Norm=1.663 | FP-Norm(final)=2.404 | 3686.7 samples/s | 57.6 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05014 | Reg=0.00306 | acc=0.9844 | FP-Norm=1.719 | FP-Norm(final)=2.410 | 3586.6 samples/s | 56.0 steps/s
[Step=3600 Epoch=17.6] | Loss=0.04830 | Reg=0.00325 | acc=0.9531 | FP-Norm=1.771 | FP-Norm(final)=2.416 | 4384.6 samples/s | 68.5 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04578 | Reg=0.00344 | acc=0.9844 | FP-Norm=1.822 | FP-Norm(final)=2.421 | 1560.9 samples/s | 24.4 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04398 | Reg=0.00361 | acc=0.9688 | FP-Norm=1.866 | FP-Norm(final)=2.426 | 3698.9 samples/s | 57.8 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04234 | Reg=0.00378 | acc=1.0000 | FP-Norm=1.909 | FP-Norm(final)=2.432 | 3674.4 samples/s | 57.4 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04107 | Reg=0.00395 | acc=0.9844 | FP-Norm=1.952 | FP-Norm(final)=2.436 | 4188.1 samples/s | 65.4 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04025 | Reg=0.00413 | acc=0.9844 | FP-Norm=1.994 | FP-Norm(final)=2.440 | 1614.9 samples/s | 25.2 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03896 | Reg=0.00430 | acc=1.0000 | FP-Norm=2.034 | FP-Norm(final)=2.444 | 3696.6 samples/s | 57.8 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03818 | Reg=0.00447 | acc=0.9688 | FP-Norm=2.072 | FP-Norm(final)=2.448 | 3669.7 samples/s | 57.3 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03720 | Reg=0.00462 | acc=1.0000 | FP-Norm=2.107 | FP-Norm(final)=2.451 | 3939.1 samples/s | 61.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step4000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.5] | Loss=0.23896 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.418 | 3427.6 samples/s | 53.6 steps/s
[Step=4850 Epoch=46.0] | Loss=0.03149 | Reg=0.00805 | acc=1.0000 | FP-Norm=2.703 | FP-Norm(final)=2.376 | 3254.1 samples/s | 50.8 steps/s
[Step=4900 Epoch=46.4] | Loss=0.01944 | Reg=0.00915 | acc=1.0000 | FP-Norm=2.952 | FP-Norm(final)=2.362 | 4510.4 samples/s | 70.5 steps/s
[Step=4950 Epoch=46.9] | Loss=0.01403 | Reg=0.00925 | acc=0.9844 | FP-Norm=2.992 | FP-Norm(final)=2.359 | 1505.4 samples/s | 23.5 steps/s
[Step=5000 Epoch=47.4] | Loss=0.01095 | Reg=0.00904 | acc=1.0000 | FP-Norm=2.970 | FP-Norm(final)=2.361 | 4231.7 samples/s | 66.1 steps/s
[Step=5050 Epoch=47.9] | Loss=0.00880 | Reg=0.00871 | acc=1.0000 | FP-Norm=2.920 | FP-Norm(final)=2.365 | 1526.4 samples/s | 23.9 steps/s
[Step=5100 Epoch=48.3] | Loss=0.00734 | Reg=0.00833 | acc=1.0000 | FP-Norm=2.855 | FP-Norm(final)=2.369 | 3931.8 samples/s | 61.4 steps/s
[Step=5150 Epoch=48.8] | Loss=0.00630 | Reg=0.00795 | acc=1.0000 | FP-Norm=2.788 | FP-Norm(final)=2.372 | 1549.8 samples/s | 24.2 steps/s
[Step=5200 Epoch=49.3] | Loss=0.00552 | Reg=0.00759 | acc=1.0000 | FP-Norm=2.721 | FP-Norm(final)=2.376 | 3803.8 samples/s | 59.4 steps/s
[Step=5250 Epoch=49.7] | Loss=0.00491 | Reg=0.00725 | acc=1.0000 | FP-Norm=2.655 | FP-Norm(final)=2.379 | 1626.9 samples/s | 25.4 steps/s
[Step=5300 Epoch=50.2] | Loss=0.00442 | Reg=0.00694 | acc=1.0000 | FP-Norm=2.592 | FP-Norm(final)=2.382 | 3552.4 samples/s | 55.5 steps/s
[Step=5350 Epoch=50.7] | Loss=0.00403 | Reg=0.00665 | acc=1.0000 | FP-Norm=2.532 | FP-Norm(final)=2.385 | 1660.2 samples/s | 25.9 steps/s
[Step=5400 Epoch=51.2] | Loss=0.00370 | Reg=0.00637 | acc=1.0000 | FP-Norm=2.474 | FP-Norm(final)=2.388 | 3556.9 samples/s | 55.6 steps/s
[Step=5450 Epoch=51.6] | Loss=0.00342 | Reg=0.00612 | acc=1.0000 | FP-Norm=2.419 | FP-Norm(final)=2.390 | 1646.7 samples/s | 25.7 steps/s
[Step=5500 Epoch=52.1] | Loss=0.00318 | Reg=0.00588 | acc=1.0000 | FP-Norm=2.366 | FP-Norm(final)=2.393 | 3529.4 samples/s | 55.1 steps/s
[Step=5550 Epoch=52.6] | Loss=0.00297 | Reg=0.00566 | acc=1.0000 | FP-Norm=2.315 | FP-Norm(final)=2.395 | 1664.0 samples/s | 26.0 steps/s
[Step=5600 Epoch=53.1] | Loss=0.00279 | Reg=0.00545 | acc=1.0000 | FP-Norm=2.266 | FP-Norm(final)=2.398 | 3531.0 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step5600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.9] | Loss=0.33908 | Reg=0.00000 | acc=0.7031 | FP-Norm=0.000 | FP-Norm(final)=2.418 | 3390.6 samples/s | 53.0 steps/s
[Step=2450 Epoch=23.4] | Loss=0.04496 | Reg=0.00895 | acc=0.9688 | FP-Norm=2.830 | FP-Norm(final)=2.375 | 3331.2 samples/s | 52.0 steps/s
[Step=2500 Epoch=23.9] | Loss=0.02428 | Reg=0.01020 | acc=1.0000 | FP-Norm=3.107 | FP-Norm(final)=2.367 | 4579.6 samples/s | 71.6 steps/s
[Step=2550 Epoch=24.4] | Loss=0.01665 | Reg=0.01001 | acc=1.0000 | FP-Norm=3.105 | FP-Norm(final)=2.367 | 1494.3 samples/s | 23.3 steps/s
[Step=2600 Epoch=24.8] | Loss=0.01257 | Reg=0.00958 | acc=1.0000 | FP-Norm=3.049 | FP-Norm(final)=2.371 | 4304.8 samples/s | 67.3 steps/s
[Step=2650 Epoch=25.3] | Loss=0.01008 | Reg=0.00912 | acc=1.0000 | FP-Norm=2.978 | FP-Norm(final)=2.375 | 1531.3 samples/s | 23.9 steps/s
[Step=2700 Epoch=25.8] | Loss=0.00843 | Reg=0.00867 | acc=1.0000 | FP-Norm=2.905 | FP-Norm(final)=2.378 | 4094.8 samples/s | 64.0 steps/s
[Step=2750 Epoch=26.3] | Loss=0.00724 | Reg=0.00826 | acc=1.0000 | FP-Norm=2.833 | FP-Norm(final)=2.382 | 1573.2 samples/s | 24.6 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00635 | Reg=0.00788 | acc=1.0000 | FP-Norm=2.764 | FP-Norm(final)=2.385 | 3862.7 samples/s | 60.4 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00565 | Reg=0.00753 | acc=1.0000 | FP-Norm=2.698 | FP-Norm(final)=2.388 | 1565.9 samples/s | 24.5 steps/s
[Step=2900 Epoch=27.7] | Loss=0.00510 | Reg=0.00720 | acc=1.0000 | FP-Norm=2.636 | FP-Norm(final)=2.391 | 3712.2 samples/s | 58.0 steps/s
[Step=2950 Epoch=28.2] | Loss=0.00465 | Reg=0.00691 | acc=1.0000 | FP-Norm=2.577 | FP-Norm(final)=2.395 | 1592.8 samples/s | 24.9 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00427 | Reg=0.00663 | acc=1.0000 | FP-Norm=2.520 | FP-Norm(final)=2.398 | 3556.1 samples/s | 55.6 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00395 | Reg=0.00638 | acc=1.0000 | FP-Norm=2.467 | FP-Norm(final)=2.400 | 1649.3 samples/s | 25.8 steps/s
[Step=3100 Epoch=29.6] | Loss=0.00368 | Reg=0.00614 | acc=1.0000 | FP-Norm=2.415 | FP-Norm(final)=2.403 | 3519.0 samples/s | 55.0 steps/s
[Step=3150 Epoch=30.1] | Loss=0.00344 | Reg=0.00592 | acc=1.0000 | FP-Norm=2.366 | FP-Norm(final)=2.406 | 1656.9 samples/s | 25.9 steps/s
[Step=3200 Epoch=30.6] | Loss=0.00323 | Reg=0.00571 | acc=1.0000 | FP-Norm=2.319 | FP-Norm(final)=2.409 | 3475.7 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20938 | acc=0.8305 | tpr=0.7802 | fpr=0.0602 | 3502.1 samples/s | 13.7 steps/s
Avg test loss: 0.21358, Avg test acc: 0.83052, Avg tpr: 0.78009, Avg fpr: 0.05858, total FA: 457

Testing server on iccad2012
[Step=  50] | Loss=0.51049 | acc=0.6935 | tpr=0.9602 | fpr=0.3113 | 3478.3 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.51757 | acc=0.6912 | tpr=0.9701 | fpr=0.3140 | 6520.6 samples/s | 25.5 steps/s
[Step= 150] | Loss=0.51787 | acc=0.6924 | tpr=0.9669 | fpr=0.3127 | 6331.1 samples/s | 24.7 steps/s
[Step= 200] | Loss=0.51846 | acc=0.6921 | tpr=0.9639 | fpr=0.3129 | 6340.8 samples/s | 24.8 steps/s
[Step= 250] | Loss=0.51856 | acc=0.6921 | tpr=0.9659 | fpr=0.3129 | 6204.2 samples/s | 24.2 steps/s
[Step= 300] | Loss=0.51896 | acc=0.6923 | tpr=0.9644 | fpr=0.3127 | 6411.6 samples/s | 25.0 steps/s
[Step= 350] | Loss=0.52000 | acc=0.6927 | tpr=0.9637 | fpr=0.3122 | 7129.6 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.52120 | acc=0.6916 | tpr=0.9655 | fpr=0.3134 | 6173.5 samples/s | 24.1 steps/s
[Step= 450] | Loss=0.52374 | acc=0.6910 | tpr=0.9664 | fpr=0.3140 | 6292.5 samples/s | 24.6 steps/s
[Step= 500] | Loss=0.52464 | acc=0.6904 | tpr=0.9678 | fpr=0.3146 | 6217.0 samples/s | 24.3 steps/s
[Step= 550] | Loss=0.52324 | acc=0.6912 | tpr=0.9694 | fpr=0.3139 | 12159.4 samples/s | 47.5 steps/s
Avg test loss: 0.52360, Avg test acc: 0.69107, Avg tpr: 0.96949, Avg fpr: 0.31399, total FA: 43597

server round 8/50

clients selected: [0 1 2 3 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.09928 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.434 | 3507.1 samples/s | 54.8 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.06922 | Reg=0.00140 | acc=0.9844 | FP-Norm=1.111 | FP-Norm(final)=2.427 | 3491.0 samples/s | 54.5 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.06511 | Reg=0.00205 | acc=0.9062 | FP-Norm=1.377 | FP-Norm(final)=2.427 | 3586.4 samples/s | 56.0 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.06345 | Reg=0.00250 | acc=0.9688 | FP-Norm=1.533 | FP-Norm(final)=2.424 | 3593.9 samples/s | 56.2 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.06158 | Reg=0.00288 | acc=0.9531 | FP-Norm=1.650 | FP-Norm(final)=2.422 | 4639.7 samples/s | 72.5 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.06248 | Reg=0.00340 | acc=0.9688 | FP-Norm=1.787 | FP-Norm(final)=2.420 | 1540.3 samples/s | 24.1 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.05909 | Reg=0.00387 | acc=0.9688 | FP-Norm=1.906 | FP-Norm(final)=2.420 | 3603.2 samples/s | 56.3 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.05656 | Reg=0.00423 | acc=0.9844 | FP-Norm=1.994 | FP-Norm(final)=2.420 | 3586.5 samples/s | 56.0 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.05408 | Reg=0.00452 | acc=0.9844 | FP-Norm=2.064 | FP-Norm(final)=2.420 | 4350.4 samples/s | 68.0 steps/s
[Step=2050 Epoch=10.0] | Loss=0.05116 | Reg=0.00477 | acc=0.9688 | FP-Norm=2.124 | FP-Norm(final)=2.421 | 1584.1 samples/s | 24.8 steps/s
[Step=2100 Epoch=10.2] | Loss=0.04848 | Reg=0.00498 | acc=1.0000 | FP-Norm=2.174 | FP-Norm(final)=2.422 | 3687.1 samples/s | 57.6 steps/s
[Step=2150 Epoch=10.5] | Loss=0.04613 | Reg=0.00516 | acc=0.9531 | FP-Norm=2.216 | FP-Norm(final)=2.424 | 3706.5 samples/s | 57.9 steps/s
[Step=2200 Epoch=10.7] | Loss=0.04443 | Reg=0.00533 | acc=1.0000 | FP-Norm=2.255 | FP-Norm(final)=2.426 | 4184.8 samples/s | 65.4 steps/s
[Step=2250 Epoch=11.0] | Loss=0.04295 | Reg=0.00549 | acc=1.0000 | FP-Norm=2.291 | FP-Norm(final)=2.428 | 1620.6 samples/s | 25.3 steps/s
[Step=2300 Epoch=11.2] | Loss=0.04167 | Reg=0.00565 | acc=1.0000 | FP-Norm=2.326 | FP-Norm(final)=2.431 | 3690.6 samples/s | 57.7 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04071 | Reg=0.00581 | acc=1.0000 | FP-Norm=2.361 | FP-Norm(final)=2.433 | 3653.7 samples/s | 57.1 steps/s
[Step=2400 Epoch=11.7] | Loss=0.03987 | Reg=0.00597 | acc=0.9844 | FP-Norm=2.393 | FP-Norm(final)=2.435 | 3979.7 samples/s | 62.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step2400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.15746 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.434 | 3657.2 samples/s | 57.1 steps/s
[Step=4050 Epoch=19.8] | Loss=0.07160 | Reg=0.00143 | acc=0.9219 | FP-Norm=1.129 | FP-Norm(final)=2.415 | 3358.2 samples/s | 52.5 steps/s
[Step=4100 Epoch=20.0] | Loss=0.06786 | Reg=0.00195 | acc=0.9375 | FP-Norm=1.351 | FP-Norm(final)=2.413 | 3656.9 samples/s | 57.1 steps/s
[Step=4150 Epoch=20.3] | Loss=0.06644 | Reg=0.00241 | acc=0.9844 | FP-Norm=1.509 | FP-Norm(final)=2.410 | 3678.8 samples/s | 57.5 steps/s
[Step=4200 Epoch=20.5] | Loss=0.06269 | Reg=0.00276 | acc=0.9531 | FP-Norm=1.620 | FP-Norm(final)=2.410 | 4721.9 samples/s | 73.8 steps/s
[Step=4250 Epoch=20.7] | Loss=0.05649 | Reg=0.00307 | acc=0.9688 | FP-Norm=1.710 | FP-Norm(final)=2.414 | 1549.1 samples/s | 24.2 steps/s
[Step=4300 Epoch=21.0] | Loss=0.05245 | Reg=0.00331 | acc=0.9844 | FP-Norm=1.778 | FP-Norm(final)=2.421 | 3686.4 samples/s | 57.6 steps/s
[Step=4350 Epoch=21.2] | Loss=0.05082 | Reg=0.00357 | acc=0.9375 | FP-Norm=1.848 | FP-Norm(final)=2.426 | 3666.8 samples/s | 57.3 steps/s
[Step=4400 Epoch=21.5] | Loss=0.04989 | Reg=0.00384 | acc=1.0000 | FP-Norm=1.918 | FP-Norm(final)=2.428 | 4454.6 samples/s | 69.6 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04774 | Reg=0.00409 | acc=1.0000 | FP-Norm=1.979 | FP-Norm(final)=2.432 | 1570.1 samples/s | 24.5 steps/s
[Step=4500 Epoch=22.0] | Loss=0.04522 | Reg=0.00432 | acc=0.9688 | FP-Norm=2.032 | FP-Norm(final)=2.437 | 3628.9 samples/s | 56.7 steps/s
[Step=4550 Epoch=22.2] | Loss=0.04398 | Reg=0.00452 | acc=0.9844 | FP-Norm=2.081 | FP-Norm(final)=2.440 | 3590.9 samples/s | 56.1 steps/s
[Step=4600 Epoch=22.4] | Loss=0.04260 | Reg=0.00471 | acc=0.9688 | FP-Norm=2.125 | FP-Norm(final)=2.443 | 4178.5 samples/s | 65.3 steps/s
[Step=4650 Epoch=22.7] | Loss=0.04109 | Reg=0.00488 | acc=0.9688 | FP-Norm=2.163 | FP-Norm(final)=2.445 | 1607.4 samples/s | 25.1 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03961 | Reg=0.00503 | acc=0.9844 | FP-Norm=2.197 | FP-Norm(final)=2.447 | 3633.2 samples/s | 56.8 steps/s
[Step=4750 Epoch=23.2] | Loss=0.03835 | Reg=0.00517 | acc=1.0000 | FP-Norm=2.228 | FP-Norm(final)=2.450 | 3612.1 samples/s | 56.4 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03735 | Reg=0.00530 | acc=0.9688 | FP-Norm=2.257 | FP-Norm(final)=2.453 | 4025.6 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step4800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.10391 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.435 | 3623.3 samples/s | 56.6 steps/s
[Step=3250 Epoch=15.8] | Loss=0.07631 | Reg=0.00162 | acc=0.9375 | FP-Norm=1.200 | FP-Norm(final)=2.415 | 3467.8 samples/s | 54.2 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07611 | Reg=0.00229 | acc=0.9688 | FP-Norm=1.461 | FP-Norm(final)=2.406 | 3667.6 samples/s | 57.3 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07211 | Reg=0.00270 | acc=0.9688 | FP-Norm=1.599 | FP-Norm(final)=2.403 | 3694.3 samples/s | 57.7 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06894 | Reg=0.00301 | acc=0.9375 | FP-Norm=1.696 | FP-Norm(final)=2.403 | 4752.4 samples/s | 74.3 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06297 | Reg=0.00330 | acc=0.9375 | FP-Norm=1.778 | FP-Norm(final)=2.405 | 1546.4 samples/s | 24.2 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05880 | Reg=0.00353 | acc=0.9219 | FP-Norm=1.843 | FP-Norm(final)=2.410 | 3645.9 samples/s | 57.0 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05594 | Reg=0.00377 | acc=0.9688 | FP-Norm=1.905 | FP-Norm(final)=2.415 | 3722.1 samples/s | 58.2 steps/s
[Step=3600 Epoch=17.5] | Loss=0.05269 | Reg=0.00398 | acc=0.9844 | FP-Norm=1.958 | FP-Norm(final)=2.420 | 4448.2 samples/s | 69.5 steps/s
[Step=3650 Epoch=17.8] | Loss=0.05095 | Reg=0.00421 | acc=0.9844 | FP-Norm=2.015 | FP-Norm(final)=2.424 | 1591.1 samples/s | 24.9 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04868 | Reg=0.00443 | acc=0.9531 | FP-Norm=2.066 | FP-Norm(final)=2.428 | 3690.4 samples/s | 57.7 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04676 | Reg=0.00463 | acc=0.9688 | FP-Norm=2.113 | FP-Norm(final)=2.431 | 3712.6 samples/s | 58.0 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04603 | Reg=0.00483 | acc=0.9844 | FP-Norm=2.157 | FP-Norm(final)=2.434 | 4206.9 samples/s | 65.7 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04461 | Reg=0.00501 | acc=0.9844 | FP-Norm=2.198 | FP-Norm(final)=2.437 | 1610.4 samples/s | 25.2 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04285 | Reg=0.00519 | acc=0.9688 | FP-Norm=2.236 | FP-Norm(final)=2.440 | 3654.7 samples/s | 57.1 steps/s
[Step=3950 Epoch=19.2] | Loss=0.04195 | Reg=0.00534 | acc=0.9844 | FP-Norm=2.270 | FP-Norm(final)=2.443 | 3646.3 samples/s | 57.0 steps/s
[Step=4000 Epoch=19.5] | Loss=0.04098 | Reg=0.00549 | acc=0.9375 | FP-Norm=2.302 | FP-Norm(final)=2.446 | 3954.8 samples/s | 61.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step4000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.15998 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.434 | 3468.1 samples/s | 54.2 steps/s
[Step=4050 Epoch=19.8] | Loss=0.07156 | Reg=0.00158 | acc=0.9688 | FP-Norm=1.189 | FP-Norm(final)=2.422 | 3591.4 samples/s | 56.1 steps/s
[Step=4100 Epoch=20.0] | Loss=0.06552 | Reg=0.00203 | acc=0.9219 | FP-Norm=1.382 | FP-Norm(final)=2.420 | 3682.4 samples/s | 57.5 steps/s
[Step=4150 Epoch=20.2] | Loss=0.06740 | Reg=0.00239 | acc=0.9375 | FP-Norm=1.508 | FP-Norm(final)=2.415 | 3700.1 samples/s | 57.8 steps/s
[Step=4200 Epoch=20.5] | Loss=0.06359 | Reg=0.00274 | acc=0.9688 | FP-Norm=1.618 | FP-Norm(final)=2.409 | 4662.1 samples/s | 72.8 steps/s
[Step=4250 Epoch=20.7] | Loss=0.05719 | Reg=0.00303 | acc=0.9375 | FP-Norm=1.703 | FP-Norm(final)=2.409 | 1557.6 samples/s | 24.3 steps/s
[Step=4300 Epoch=21.0] | Loss=0.05258 | Reg=0.00324 | acc=0.9688 | FP-Norm=1.765 | FP-Norm(final)=2.413 | 3675.6 samples/s | 57.4 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04942 | Reg=0.00342 | acc=0.9844 | FP-Norm=1.816 | FP-Norm(final)=2.417 | 3688.6 samples/s | 57.6 steps/s
[Step=4400 Epoch=21.5] | Loss=0.04859 | Reg=0.00362 | acc=0.9844 | FP-Norm=1.869 | FP-Norm(final)=2.419 | 4423.6 samples/s | 69.1 steps/s
[Step=4450 Epoch=21.7] | Loss=0.05203 | Reg=0.00412 | acc=0.9844 | FP-Norm=1.974 | FP-Norm(final)=2.419 | 1579.9 samples/s | 24.7 steps/s
[Step=4500 Epoch=21.9] | Loss=0.05173 | Reg=0.00476 | acc=0.9688 | FP-Norm=2.101 | FP-Norm(final)=2.416 | 3699.9 samples/s | 57.8 steps/s
[Step=4550 Epoch=22.2] | Loss=0.05119 | Reg=0.00524 | acc=0.9844 | FP-Norm=2.199 | FP-Norm(final)=2.413 | 3688.4 samples/s | 57.6 steps/s
[Step=4600 Epoch=22.4] | Loss=0.04993 | Reg=0.00562 | acc=0.9844 | FP-Norm=2.276 | FP-Norm(final)=2.412 | 4175.5 samples/s | 65.2 steps/s
[Step=4650 Epoch=22.7] | Loss=0.04885 | Reg=0.00593 | acc=1.0000 | FP-Norm=2.340 | FP-Norm(final)=2.410 | 1596.4 samples/s | 24.9 steps/s
[Step=4700 Epoch=22.9] | Loss=0.04683 | Reg=0.00618 | acc=1.0000 | FP-Norm=2.392 | FP-Norm(final)=2.410 | 3625.7 samples/s | 56.7 steps/s
[Step=4750 Epoch=23.2] | Loss=0.04505 | Reg=0.00639 | acc=0.9688 | FP-Norm=2.436 | FP-Norm(final)=2.411 | 3599.8 samples/s | 56.2 steps/s
[Step=4800 Epoch=23.4] | Loss=0.04373 | Reg=0.00656 | acc=1.0000 | FP-Norm=2.473 | FP-Norm(final)=2.412 | 3848.9 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step4800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.2] | Loss=0.16810 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.433 | 3396.0 samples/s | 53.1 steps/s
[Step=3250 Epoch=30.6] | Loss=0.03443 | Reg=0.00796 | acc=0.9844 | FP-Norm=2.671 | FP-Norm(final)=2.392 | 3280.3 samples/s | 51.3 steps/s
[Step=3300 Epoch=31.1] | Loss=0.01962 | Reg=0.00899 | acc=1.0000 | FP-Norm=2.918 | FP-Norm(final)=2.387 | 4461.6 samples/s | 69.7 steps/s
[Step=3350 Epoch=31.6] | Loss=0.01941 | Reg=0.00985 | acc=1.0000 | FP-Norm=3.076 | FP-Norm(final)=2.381 | 1488.6 samples/s | 23.3 steps/s
[Step=3400 Epoch=32.0] | Loss=0.01502 | Reg=0.01039 | acc=1.0000 | FP-Norm=3.174 | FP-Norm(final)=2.380 | 4148.7 samples/s | 64.8 steps/s
[Step=3450 Epoch=32.5] | Loss=0.01238 | Reg=0.01048 | acc=1.0000 | FP-Norm=3.198 | FP-Norm(final)=2.383 | 1549.6 samples/s | 24.2 steps/s
[Step=3500 Epoch=33.0] | Loss=0.01041 | Reg=0.01039 | acc=1.0000 | FP-Norm=3.189 | FP-Norm(final)=2.387 | 3863.8 samples/s | 60.4 steps/s
[Step=3550 Epoch=33.5] | Loss=0.00894 | Reg=0.01018 | acc=1.0000 | FP-Norm=3.160 | FP-Norm(final)=2.391 | 1574.7 samples/s | 24.6 steps/s
[Step=3600 Epoch=33.9] | Loss=0.00783 | Reg=0.00991 | acc=1.0000 | FP-Norm=3.119 | FP-Norm(final)=2.395 | 3682.0 samples/s | 57.5 steps/s
[Step=3650 Epoch=34.4] | Loss=0.00697 | Reg=0.00962 | acc=1.0000 | FP-Norm=3.073 | FP-Norm(final)=2.398 | 1622.5 samples/s | 25.4 steps/s
[Step=3700 Epoch=34.9] | Loss=0.00629 | Reg=0.00932 | acc=1.0000 | FP-Norm=3.023 | FP-Norm(final)=2.402 | 3465.9 samples/s | 54.2 steps/s
[Step=3750 Epoch=35.3] | Loss=0.00572 | Reg=0.00903 | acc=1.0000 | FP-Norm=2.973 | FP-Norm(final)=2.405 | 1663.4 samples/s | 26.0 steps/s
[Step=3800 Epoch=35.8] | Loss=0.00525 | Reg=0.00874 | acc=1.0000 | FP-Norm=2.922 | FP-Norm(final)=2.408 | 3453.7 samples/s | 54.0 steps/s
[Step=3850 Epoch=36.3] | Loss=0.00485 | Reg=0.00847 | acc=1.0000 | FP-Norm=2.872 | FP-Norm(final)=2.411 | 1680.2 samples/s | 26.3 steps/s
[Step=3900 Epoch=36.7] | Loss=0.00451 | Reg=0.00820 | acc=1.0000 | FP-Norm=2.823 | FP-Norm(final)=2.413 | 3498.5 samples/s | 54.7 steps/s
[Step=3950 Epoch=37.2] | Loss=0.00422 | Reg=0.00795 | acc=1.0000 | FP-Norm=2.774 | FP-Norm(final)=2.416 | 1790.3 samples/s | 28.0 steps/s
[Step=4000 Epoch=37.7] | Loss=0.00396 | Reg=0.00770 | acc=1.0000 | FP-Norm=2.727 | FP-Norm(final)=2.418 | 2961.6 samples/s | 46.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21321 | acc=0.8273 | tpr=0.7750 | fpr=0.0590 | 3471.2 samples/s | 13.6 steps/s
Avg test loss: 0.21745, Avg test acc: 0.82667, Avg tpr: 0.77368, Avg fpr: 0.05679, total FA: 443

Testing server on iccad2012
[Step=  50] | Loss=0.47837 | acc=0.7226 | tpr=0.9646 | fpr=0.2818 | 3404.8 samples/s | 13.3 steps/s
[Step= 100] | Loss=0.48609 | acc=0.7195 | tpr=0.9680 | fpr=0.2851 | 6594.6 samples/s | 25.8 steps/s
[Step= 150] | Loss=0.48629 | acc=0.7199 | tpr=0.9669 | fpr=0.2846 | 6467.3 samples/s | 25.3 steps/s
[Step= 200] | Loss=0.48692 | acc=0.7202 | tpr=0.9639 | fpr=0.2843 | 6705.1 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.48685 | acc=0.7207 | tpr=0.9659 | fpr=0.2837 | 6406.2 samples/s | 25.0 steps/s
[Step= 300] | Loss=0.48708 | acc=0.7208 | tpr=0.9665 | fpr=0.2836 | 6542.6 samples/s | 25.6 steps/s
[Step= 350] | Loss=0.48786 | acc=0.7215 | tpr=0.9656 | fpr=0.2830 | 6513.6 samples/s | 25.4 steps/s
[Step= 400] | Loss=0.48899 | acc=0.7206 | tpr=0.9661 | fpr=0.2838 | 6487.9 samples/s | 25.3 steps/s
[Step= 450] | Loss=0.49149 | acc=0.7199 | tpr=0.9674 | fpr=0.2846 | 6430.2 samples/s | 25.1 steps/s
[Step= 500] | Loss=0.49249 | acc=0.7191 | tpr=0.9692 | fpr=0.2854 | 6249.8 samples/s | 24.4 steps/s
[Step= 550] | Loss=0.49102 | acc=0.7199 | tpr=0.9702 | fpr=0.2847 | 12297.5 samples/s | 48.0 steps/s
Avg test loss: 0.49133, Avg test acc: 0.71978, Avg tpr: 0.97029, Avg fpr: 0.28477, total FA: 39540

server round 9/50

clients selected: [2 5 7 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.13460 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.447 | 3516.5 samples/s | 54.9 steps/s
[Step=4050 Epoch=19.7] | Loss=0.07171 | Reg=0.00149 | acc=0.9375 | FP-Norm=1.156 | FP-Norm(final)=2.423 | 3585.9 samples/s | 56.0 steps/s
[Step=4100 Epoch=20.0] | Loss=0.06635 | Reg=0.00203 | acc=0.8906 | FP-Norm=1.380 | FP-Norm(final)=2.418 | 3662.5 samples/s | 57.2 steps/s
[Step=4150 Epoch=20.2] | Loss=0.06287 | Reg=0.00243 | acc=0.9219 | FP-Norm=1.519 | FP-Norm(final)=2.417 | 3678.2 samples/s | 57.5 steps/s
[Step=4200 Epoch=20.5] | Loss=0.06088 | Reg=0.00275 | acc=0.9688 | FP-Norm=1.619 | FP-Norm(final)=2.417 | 4737.5 samples/s | 74.0 steps/s
[Step=4250 Epoch=20.7] | Loss=0.05465 | Reg=0.00300 | acc=0.9531 | FP-Norm=1.696 | FP-Norm(final)=2.421 | 1548.0 samples/s | 24.2 steps/s
[Step=4300 Epoch=21.0] | Loss=0.05108 | Reg=0.00323 | acc=1.0000 | FP-Norm=1.762 | FP-Norm(final)=2.425 | 3669.0 samples/s | 57.3 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04851 | Reg=0.00345 | acc=0.9531 | FP-Norm=1.823 | FP-Norm(final)=2.430 | 3693.5 samples/s | 57.7 steps/s
[Step=4400 Epoch=21.4] | Loss=0.04684 | Reg=0.00367 | acc=0.9844 | FP-Norm=1.880 | FP-Norm(final)=2.435 | 4451.8 samples/s | 69.6 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04453 | Reg=0.00389 | acc=0.9688 | FP-Norm=1.935 | FP-Norm(final)=2.440 | 1582.2 samples/s | 24.7 steps/s
[Step=4500 Epoch=21.9] | Loss=0.04229 | Reg=0.00408 | acc=0.9844 | FP-Norm=1.983 | FP-Norm(final)=2.444 | 3703.6 samples/s | 57.9 steps/s
[Step=4550 Epoch=22.2] | Loss=0.04128 | Reg=0.00427 | acc=0.9844 | FP-Norm=2.027 | FP-Norm(final)=2.448 | 3689.1 samples/s | 57.6 steps/s
[Step=4600 Epoch=22.4] | Loss=0.04031 | Reg=0.00445 | acc=0.9844 | FP-Norm=2.069 | FP-Norm(final)=2.451 | 4215.3 samples/s | 65.9 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03848 | Reg=0.00462 | acc=0.9844 | FP-Norm=2.109 | FP-Norm(final)=2.454 | 1599.3 samples/s | 25.0 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03704 | Reg=0.00476 | acc=0.9688 | FP-Norm=2.141 | FP-Norm(final)=2.459 | 3625.5 samples/s | 56.6 steps/s
[Step=4750 Epoch=23.1] | Loss=0.03587 | Reg=0.00488 | acc=0.9844 | FP-Norm=2.169 | FP-Norm(final)=2.462 | 3626.4 samples/s | 56.7 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03522 | Reg=0.00499 | acc=0.9844 | FP-Norm=2.196 | FP-Norm(final)=2.465 | 3933.0 samples/s | 61.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step4800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.1] | Loss=0.17535 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.446 | 3271.6 samples/s | 51.1 steps/s
[Step=5650 Epoch=53.5] | Loss=0.02521 | Reg=0.00673 | acc=0.9688 | FP-Norm=2.469 | FP-Norm(final)=2.411 | 3352.2 samples/s | 52.4 steps/s
[Step=5700 Epoch=54.0] | Loss=0.01513 | Reg=0.00752 | acc=1.0000 | FP-Norm=2.676 | FP-Norm(final)=2.405 | 4524.4 samples/s | 70.7 steps/s
[Step=5750 Epoch=54.5] | Loss=0.01087 | Reg=0.00750 | acc=1.0000 | FP-Norm=2.693 | FP-Norm(final)=2.408 | 1482.5 samples/s | 23.2 steps/s
[Step=5800 Epoch=55.0] | Loss=0.00918 | Reg=0.00744 | acc=1.0000 | FP-Norm=2.695 | FP-Norm(final)=2.411 | 4227.2 samples/s | 66.0 steps/s
[Step=5850 Epoch=55.4] | Loss=0.00789 | Reg=0.00749 | acc=1.0000 | FP-Norm=2.710 | FP-Norm(final)=2.415 | 1544.5 samples/s | 24.1 steps/s
[Step=5900 Epoch=55.9] | Loss=0.00659 | Reg=0.00740 | acc=1.0000 | FP-Norm=2.697 | FP-Norm(final)=2.420 | 3941.4 samples/s | 61.6 steps/s
[Step=5950 Epoch=56.4] | Loss=0.00565 | Reg=0.00720 | acc=1.0000 | FP-Norm=2.663 | FP-Norm(final)=2.425 | 1581.6 samples/s | 24.7 steps/s
[Step=6000 Epoch=56.9] | Loss=0.00495 | Reg=0.00697 | acc=1.0000 | FP-Norm=2.619 | FP-Norm(final)=2.429 | 3777.7 samples/s | 59.0 steps/s
[Step=6050 Epoch=57.3] | Loss=0.00441 | Reg=0.00673 | acc=1.0000 | FP-Norm=2.571 | FP-Norm(final)=2.432 | 1623.7 samples/s | 25.4 steps/s
[Step=6100 Epoch=57.8] | Loss=0.00397 | Reg=0.00648 | acc=1.0000 | FP-Norm=2.521 | FP-Norm(final)=2.435 | 3456.1 samples/s | 54.0 steps/s
[Step=6150 Epoch=58.3] | Loss=0.00361 | Reg=0.00625 | acc=1.0000 | FP-Norm=2.471 | FP-Norm(final)=2.438 | 1675.4 samples/s | 26.2 steps/s
[Step=6200 Epoch=58.8] | Loss=0.00332 | Reg=0.00602 | acc=1.0000 | FP-Norm=2.422 | FP-Norm(final)=2.440 | 3486.0 samples/s | 54.5 steps/s
[Step=6250 Epoch=59.2] | Loss=0.00307 | Reg=0.00581 | acc=1.0000 | FP-Norm=2.373 | FP-Norm(final)=2.442 | 1653.1 samples/s | 25.8 steps/s
[Step=6300 Epoch=59.7] | Loss=0.00285 | Reg=0.00560 | acc=1.0000 | FP-Norm=2.326 | FP-Norm(final)=2.444 | 3495.5 samples/s | 54.6 steps/s
[Step=6350 Epoch=60.2] | Loss=0.00266 | Reg=0.00540 | acc=1.0000 | FP-Norm=2.279 | FP-Norm(final)=2.446 | 1676.6 samples/s | 26.2 steps/s
[Step=6400 Epoch=60.6] | Loss=0.00250 | Reg=0.00522 | acc=1.0000 | FP-Norm=2.235 | FP-Norm(final)=2.448 | 3386.8 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step6400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.6] | Loss=0.16992 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.447 | 3517.3 samples/s | 55.0 steps/s
[Step=3250 Epoch=31.0] | Loss=0.03099 | Reg=0.00594 | acc=1.0000 | FP-Norm=2.308 | FP-Norm(final)=2.418 | 3256.1 samples/s | 50.9 steps/s
[Step=3300 Epoch=31.5] | Loss=0.02000 | Reg=0.00737 | acc=1.0000 | FP-Norm=2.637 | FP-Norm(final)=2.404 | 4603.6 samples/s | 71.9 steps/s
[Step=3350 Epoch=32.0] | Loss=0.01392 | Reg=0.00756 | acc=1.0000 | FP-Norm=2.696 | FP-Norm(final)=2.402 | 1511.8 samples/s | 23.6 steps/s
[Step=3400 Epoch=32.5] | Loss=0.01050 | Reg=0.00736 | acc=1.0000 | FP-Norm=2.672 | FP-Norm(final)=2.404 | 4326.5 samples/s | 67.6 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00842 | Reg=0.00706 | acc=1.0000 | FP-Norm=2.623 | FP-Norm(final)=2.407 | 1541.0 samples/s | 24.1 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00703 | Reg=0.00676 | acc=1.0000 | FP-Norm=2.567 | FP-Norm(final)=2.409 | 4046.7 samples/s | 63.2 steps/s
[Step=3550 Epoch=33.9] | Loss=0.00604 | Reg=0.00646 | acc=1.0000 | FP-Norm=2.509 | FP-Norm(final)=2.412 | 1539.0 samples/s | 24.0 steps/s
[Step=3600 Epoch=34.4] | Loss=0.00529 | Reg=0.00618 | acc=1.0000 | FP-Norm=2.452 | FP-Norm(final)=2.414 | 3872.2 samples/s | 60.5 steps/s
[Step=3650 Epoch=34.9] | Loss=0.00471 | Reg=0.00592 | acc=1.0000 | FP-Norm=2.396 | FP-Norm(final)=2.417 | 1560.8 samples/s | 24.4 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00425 | Reg=0.00567 | acc=1.0000 | FP-Norm=2.343 | FP-Norm(final)=2.419 | 3680.3 samples/s | 57.5 steps/s
[Step=3750 Epoch=35.8] | Loss=0.00387 | Reg=0.00544 | acc=1.0000 | FP-Norm=2.291 | FP-Norm(final)=2.421 | 1619.7 samples/s | 25.3 steps/s
[Step=3800 Epoch=36.3] | Loss=0.00355 | Reg=0.00523 | acc=1.0000 | FP-Norm=2.241 | FP-Norm(final)=2.424 | 3554.8 samples/s | 55.5 steps/s
[Step=3850 Epoch=36.8] | Loss=0.00328 | Reg=0.00503 | acc=1.0000 | FP-Norm=2.194 | FP-Norm(final)=2.426 | 1619.2 samples/s | 25.3 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00305 | Reg=0.00484 | acc=1.0000 | FP-Norm=2.148 | FP-Norm(final)=2.428 | 3532.9 samples/s | 55.2 steps/s
[Step=3950 Epoch=37.7] | Loss=0.00285 | Reg=0.00466 | acc=1.0000 | FP-Norm=2.104 | FP-Norm(final)=2.430 | 1642.7 samples/s | 25.7 steps/s
[Step=4000 Epoch=38.2] | Loss=0.00268 | Reg=0.00450 | acc=1.0000 | FP-Norm=2.061 | FP-Norm(final)=2.432 | 3431.5 samples/s | 53.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step4000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=37.7] | Loss=0.23407 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.446 | 3563.3 samples/s | 55.7 steps/s
[Step=4050 Epoch=38.2] | Loss=0.02776 | Reg=0.00632 | acc=1.0000 | FP-Norm=2.400 | FP-Norm(final)=2.411 | 3349.7 samples/s | 52.3 steps/s
[Step=4100 Epoch=38.6] | Loss=0.01570 | Reg=0.00668 | acc=1.0000 | FP-Norm=2.525 | FP-Norm(final)=2.416 | 4494.4 samples/s | 70.2 steps/s
[Step=4150 Epoch=39.1] | Loss=0.01085 | Reg=0.00639 | acc=1.0000 | FP-Norm=2.487 | FP-Norm(final)=2.424 | 1519.2 samples/s | 23.7 steps/s
[Step=4200 Epoch=39.6] | Loss=0.00821 | Reg=0.00603 | acc=1.0000 | FP-Norm=2.421 | FP-Norm(final)=2.432 | 4229.4 samples/s | 66.1 steps/s
[Step=4250 Epoch=40.0] | Loss=0.00661 | Reg=0.00567 | acc=1.0000 | FP-Norm=2.349 | FP-Norm(final)=2.437 | 1560.1 samples/s | 24.4 steps/s
[Step=4300 Epoch=40.5] | Loss=0.00551 | Reg=0.00535 | acc=1.0000 | FP-Norm=2.279 | FP-Norm(final)=2.441 | 3915.1 samples/s | 61.2 steps/s
[Step=4350 Epoch=41.0] | Loss=0.00474 | Reg=0.00505 | acc=1.0000 | FP-Norm=2.211 | FP-Norm(final)=2.445 | 1595.5 samples/s | 24.9 steps/s
[Step=4400 Epoch=41.5] | Loss=0.00415 | Reg=0.00478 | acc=1.0000 | FP-Norm=2.148 | FP-Norm(final)=2.448 | 3664.9 samples/s | 57.3 steps/s
[Step=4450 Epoch=41.9] | Loss=0.00370 | Reg=0.00454 | acc=1.0000 | FP-Norm=2.088 | FP-Norm(final)=2.451 | 1618.2 samples/s | 25.3 steps/s
[Step=4500 Epoch=42.4] | Loss=0.00333 | Reg=0.00432 | acc=1.0000 | FP-Norm=2.033 | FP-Norm(final)=2.453 | 3509.3 samples/s | 54.8 steps/s
[Step=4550 Epoch=42.9] | Loss=0.00304 | Reg=0.00412 | acc=1.0000 | FP-Norm=1.980 | FP-Norm(final)=2.455 | 1664.1 samples/s | 26.0 steps/s
[Step=4600 Epoch=43.3] | Loss=0.00279 | Reg=0.00394 | acc=1.0000 | FP-Norm=1.931 | FP-Norm(final)=2.457 | 3530.1 samples/s | 55.2 steps/s
[Step=4650 Epoch=43.8] | Loss=0.00258 | Reg=0.00377 | acc=1.0000 | FP-Norm=1.885 | FP-Norm(final)=2.459 | 1685.1 samples/s | 26.3 steps/s
[Step=4700 Epoch=44.3] | Loss=0.00240 | Reg=0.00362 | acc=1.0000 | FP-Norm=1.841 | FP-Norm(final)=2.461 | 3435.5 samples/s | 53.7 steps/s
[Step=4750 Epoch=44.8] | Loss=0.00224 | Reg=0.00347 | acc=1.0000 | FP-Norm=1.799 | FP-Norm(final)=2.463 | 1735.0 samples/s | 27.1 steps/s
[Step=4800 Epoch=45.2] | Loss=0.00211 | Reg=0.00334 | acc=1.0000 | FP-Norm=1.759 | FP-Norm(final)=2.465 | 3265.1 samples/s | 51.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step4800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.9] | Loss=0.11390 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.448 | 3548.2 samples/s | 55.4 steps/s
[Step=2450 Epoch=23.4] | Loss=0.02995 | Reg=0.00541 | acc=0.9844 | FP-Norm=2.192 | FP-Norm(final)=2.413 | 3332.9 samples/s | 52.1 steps/s
[Step=2500 Epoch=23.8] | Loss=0.01603 | Reg=0.00641 | acc=1.0000 | FP-Norm=2.457 | FP-Norm(final)=2.412 | 4526.0 samples/s | 70.7 steps/s
[Step=2550 Epoch=24.3] | Loss=0.01073 | Reg=0.00632 | acc=1.0000 | FP-Norm=2.464 | FP-Norm(final)=2.416 | 1507.4 samples/s | 23.6 steps/s
[Step=2600 Epoch=24.8] | Loss=0.00808 | Reg=0.00604 | acc=1.0000 | FP-Norm=2.417 | FP-Norm(final)=2.420 | 4323.7 samples/s | 67.6 steps/s
[Step=2650 Epoch=25.3] | Loss=0.00648 | Reg=0.00573 | acc=1.0000 | FP-Norm=2.358 | FP-Norm(final)=2.423 | 1517.3 samples/s | 23.7 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00541 | Reg=0.00543 | acc=1.0000 | FP-Norm=2.296 | FP-Norm(final)=2.426 | 4153.0 samples/s | 64.9 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00465 | Reg=0.00515 | acc=1.0000 | FP-Norm=2.234 | FP-Norm(final)=2.428 | 1559.2 samples/s | 24.4 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00408 | Reg=0.00490 | acc=1.0000 | FP-Norm=2.175 | FP-Norm(final)=2.430 | 3833.4 samples/s | 59.9 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00363 | Reg=0.00466 | acc=1.0000 | FP-Norm=2.119 | FP-Norm(final)=2.433 | 1588.6 samples/s | 24.8 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00328 | Reg=0.00445 | acc=1.0000 | FP-Norm=2.065 | FP-Norm(final)=2.435 | 3723.5 samples/s | 58.2 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00299 | Reg=0.00425 | acc=1.0000 | FP-Norm=2.014 | FP-Norm(final)=2.437 | 1590.9 samples/s | 24.9 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00274 | Reg=0.00406 | acc=1.0000 | FP-Norm=1.965 | FP-Norm(final)=2.439 | 3604.0 samples/s | 56.3 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00254 | Reg=0.00389 | acc=1.0000 | FP-Norm=1.918 | FP-Norm(final)=2.441 | 1650.6 samples/s | 25.8 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00236 | Reg=0.00373 | acc=1.0000 | FP-Norm=1.873 | FP-Norm(final)=2.442 | 3497.9 samples/s | 54.7 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00221 | Reg=0.00358 | acc=1.0000 | FP-Norm=1.830 | FP-Norm(final)=2.444 | 1670.9 samples/s | 26.1 steps/s
[Step=3200 Epoch=30.5] | Loss=0.00207 | Reg=0.00345 | acc=1.0000 | FP-Norm=1.789 | FP-Norm(final)=2.446 | 3530.9 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31617 | acc=0.7659 | tpr=0.6748 | fpr=0.0362 | 3467.5 samples/s | 13.5 steps/s
Avg test loss: 0.32279, Avg test acc: 0.76505, Avg tpr: 0.67325, Avg fpr: 0.03307, total FA: 258

Testing server on iccad2012
[Step=  50] | Loss=0.38865 | acc=0.7854 | tpr=0.9558 | fpr=0.2177 | 3525.7 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.39622 | acc=0.7809 | tpr=0.9574 | fpr=0.2224 | 6429.1 samples/s | 25.1 steps/s
[Step= 150] | Loss=0.39800 | acc=0.7808 | tpr=0.9582 | fpr=0.2225 | 6141.0 samples/s | 24.0 steps/s
[Step= 200] | Loss=0.39901 | acc=0.7798 | tpr=0.9574 | fpr=0.2234 | 6616.2 samples/s | 25.8 steps/s
[Step= 250] | Loss=0.39926 | acc=0.7800 | tpr=0.9598 | fpr=0.2233 | 6560.5 samples/s | 25.6 steps/s
[Step= 300] | Loss=0.39997 | acc=0.7796 | tpr=0.9585 | fpr=0.2237 | 6631.3 samples/s | 25.9 steps/s
[Step= 350] | Loss=0.40094 | acc=0.7804 | tpr=0.9587 | fpr=0.2229 | 6582.2 samples/s | 25.7 steps/s
[Step= 400] | Loss=0.40164 | acc=0.7797 | tpr=0.9584 | fpr=0.2235 | 6512.4 samples/s | 25.4 steps/s
[Step= 450] | Loss=0.40376 | acc=0.7793 | tpr=0.9596 | fpr=0.2240 | 6471.6 samples/s | 25.3 steps/s
[Step= 500] | Loss=0.40448 | acc=0.7786 | tpr=0.9608 | fpr=0.2247 | 6692.3 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.40309 | acc=0.7794 | tpr=0.9614 | fpr=0.2239 | 11730.3 samples/s | 45.8 steps/s
Avg test loss: 0.40333, Avg test acc: 0.77923, Avg tpr: 0.96157, Avg fpr: 0.22409, total FA: 31114

server round 10/50

clients selected: [1 2 5 6 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.30106 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.466 | 3389.7 samples/s | 53.0 steps/s
[Step=4850 Epoch=23.7] | Loss=0.06969 | Reg=0.00102 | acc=0.9531 | FP-Norm=0.965 | FP-Norm(final)=2.450 | 3650.4 samples/s | 57.0 steps/s
[Step=4900 Epoch=23.9] | Loss=0.06044 | Reg=0.00120 | acc=0.9375 | FP-Norm=1.071 | FP-Norm(final)=2.447 | 3679.7 samples/s | 57.5 steps/s
[Step=4950 Epoch=24.2] | Loss=0.05126 | Reg=0.00129 | acc=0.9688 | FP-Norm=1.117 | FP-Norm(final)=2.449 | 3600.3 samples/s | 56.3 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04614 | Reg=0.00135 | acc=0.9844 | FP-Norm=1.149 | FP-Norm(final)=2.454 | 4671.8 samples/s | 73.0 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04118 | Reg=0.00141 | acc=0.9688 | FP-Norm=1.177 | FP-Norm(final)=2.459 | 1530.6 samples/s | 23.9 steps/s
[Step=5100 Epoch=24.9] | Loss=0.03711 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.195 | FP-Norm(final)=2.465 | 3684.4 samples/s | 57.6 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03526 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.216 | FP-Norm(final)=2.470 | 3690.1 samples/s | 57.7 steps/s
[Step=5200 Epoch=25.4] | Loss=0.03354 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.238 | FP-Norm(final)=2.475 | 4278.5 samples/s | 66.9 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03223 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.258 | FP-Norm(final)=2.479 | 1569.7 samples/s | 24.5 steps/s
[Step=5300 Epoch=25.9] | Loss=0.03034 | Reg=0.00165 | acc=0.9844 | FP-Norm=1.275 | FP-Norm(final)=2.484 | 3655.5 samples/s | 57.1 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02841 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.289 | FP-Norm(final)=2.489 | 3680.1 samples/s | 57.5 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02714 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.301 | FP-Norm(final)=2.494 | 4268.0 samples/s | 66.7 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02578 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.314 | FP-Norm(final)=2.498 | 1622.9 samples/s | 25.4 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02468 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.325 | FP-Norm(final)=2.503 | 3660.7 samples/s | 57.2 steps/s
[Step=5550 Epoch=27.1] | Loss=0.02393 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.336 | FP-Norm(final)=2.507 | 3623.1 samples/s | 56.6 steps/s
[Step=5600 Epoch=27.3] | Loss=0.02338 | Reg=0.00184 | acc=0.9844 | FP-Norm=1.347 | FP-Norm(final)=2.511 | 4083.9 samples/s | 63.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step5600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.39787 | Reg=0.00000 | acc=0.7344 | FP-Norm=0.000 | FP-Norm(final)=2.466 | 3537.0 samples/s | 55.3 steps/s
[Step=4850 Epoch=23.6] | Loss=0.07675 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.939 | FP-Norm(final)=2.445 | 3514.9 samples/s | 54.9 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05811 | Reg=0.00111 | acc=0.9844 | FP-Norm=1.029 | FP-Norm(final)=2.448 | 3630.2 samples/s | 56.7 steps/s
[Step=4950 Epoch=24.1] | Loss=0.05254 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.078 | FP-Norm(final)=2.452 | 3681.2 samples/s | 57.5 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04810 | Reg=0.00129 | acc=1.0000 | FP-Norm=1.122 | FP-Norm(final)=2.457 | 4616.6 samples/s | 72.1 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04343 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.155 | FP-Norm(final)=2.462 | 1552.9 samples/s | 24.3 steps/s
[Step=5100 Epoch=24.8] | Loss=0.03876 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.178 | FP-Norm(final)=2.469 | 3688.0 samples/s | 57.6 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03637 | Reg=0.00146 | acc=0.9844 | FP-Norm=1.198 | FP-Norm(final)=2.475 | 3552.5 samples/s | 55.5 steps/s
[Step=5200 Epoch=25.3] | Loss=0.03455 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.219 | FP-Norm(final)=2.482 | 4354.7 samples/s | 68.0 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03205 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.237 | FP-Norm(final)=2.487 | 1601.0 samples/s | 25.0 steps/s
[Step=5300 Epoch=25.8] | Loss=0.03040 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.254 | FP-Norm(final)=2.493 | 3642.1 samples/s | 56.9 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02895 | Reg=0.00164 | acc=0.9844 | FP-Norm=1.270 | FP-Norm(final)=2.499 | 3638.3 samples/s | 56.8 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02760 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.285 | FP-Norm(final)=2.505 | 4190.4 samples/s | 65.5 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02631 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.300 | FP-Norm(final)=2.510 | 1615.2 samples/s | 25.2 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02558 | Reg=0.00175 | acc=0.9531 | FP-Norm=1.313 | FP-Norm(final)=2.516 | 3630.2 samples/s | 56.7 steps/s
[Step=5550 Epoch=27.0] | Loss=0.02475 | Reg=0.00178 | acc=0.9688 | FP-Norm=1.325 | FP-Norm(final)=2.521 | 3649.7 samples/s | 57.0 steps/s
[Step=5600 Epoch=27.3] | Loss=0.02398 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.337 | FP-Norm(final)=2.525 | 3898.3 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step5600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=60.7] | Loss=0.12312 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.466 | 3418.8 samples/s | 53.4 steps/s
[Step=6450 Epoch=61.1] | Loss=0.01660 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.312 | FP-Norm(final)=2.459 | 3310.0 samples/s | 51.7 steps/s
[Step=6500 Epoch=61.6] | Loss=0.01011 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.504 | FP-Norm(final)=2.460 | 4583.6 samples/s | 71.6 steps/s
[Step=6550 Epoch=62.1] | Loss=0.00683 | Reg=0.00242 | acc=1.0000 | FP-Norm=1.527 | FP-Norm(final)=2.464 | 1515.1 samples/s | 23.7 steps/s
[Step=6600 Epoch=62.5] | Loss=0.00517 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.509 | FP-Norm(final)=2.468 | 4188.7 samples/s | 65.4 steps/s
[Step=6650 Epoch=63.0] | Loss=0.00416 | Reg=0.00224 | acc=1.0000 | FP-Norm=1.479 | FP-Norm(final)=2.471 | 1507.6 samples/s | 23.6 steps/s
[Step=6700 Epoch=63.5] | Loss=0.00348 | Reg=0.00215 | acc=1.0000 | FP-Norm=1.447 | FP-Norm(final)=2.474 | 4049.6 samples/s | 63.3 steps/s
[Step=6750 Epoch=64.0] | Loss=0.00299 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.415 | FP-Norm(final)=2.476 | 1566.8 samples/s | 24.5 steps/s
[Step=6800 Epoch=64.4] | Loss=0.00262 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.384 | FP-Norm(final)=2.478 | 3759.5 samples/s | 58.7 steps/s
[Step=6850 Epoch=64.9] | Loss=0.00234 | Reg=0.00189 | acc=1.0000 | FP-Norm=1.355 | FP-Norm(final)=2.480 | 1598.5 samples/s | 25.0 steps/s
[Step=6900 Epoch=65.4] | Loss=0.00212 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.328 | FP-Norm(final)=2.481 | 3617.5 samples/s | 56.5 steps/s
[Step=6950 Epoch=65.9] | Loss=0.00193 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.302 | FP-Norm(final)=2.483 | 1618.0 samples/s | 25.3 steps/s
[Step=7000 Epoch=66.3] | Loss=0.00177 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.278 | FP-Norm(final)=2.484 | 3473.5 samples/s | 54.3 steps/s
[Step=7050 Epoch=66.8] | Loss=0.00164 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.255 | FP-Norm(final)=2.485 | 1662.4 samples/s | 26.0 steps/s
[Step=7100 Epoch=67.3] | Loss=0.00153 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.233 | FP-Norm(final)=2.487 | 3510.6 samples/s | 54.9 steps/s
[Step=7150 Epoch=67.8] | Loss=0.00143 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.212 | FP-Norm(final)=2.488 | 1681.8 samples/s | 26.3 steps/s
[Step=7200 Epoch=68.2] | Loss=0.00135 | Reg=0.00149 | acc=1.0000 | FP-Norm=1.192 | FP-Norm(final)=2.489 | 3519.8 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step7200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=1601 Epoch=15.2] | Loss=0.29126 | Reg=0.00000 | acc=0.7656 | FP-Norm=0.000 | FP-Norm(final)=2.465 | 3326.0 samples/s | 52.0 steps/s
[Step=1650 Epoch=15.7] | Loss=0.03831 | Reg=0.00270 | acc=1.0000 | FP-Norm=1.555 | FP-Norm(final)=2.435 | 3363.9 samples/s | 52.6 steps/s
[Step=1700 Epoch=16.2] | Loss=0.02033 | Reg=0.00320 | acc=1.0000 | FP-Norm=1.741 | FP-Norm(final)=2.437 | 4447.1 samples/s | 69.5 steps/s
[Step=1750 Epoch=16.6] | Loss=0.01376 | Reg=0.00322 | acc=1.0000 | FP-Norm=1.763 | FP-Norm(final)=2.441 | 1501.3 samples/s | 23.5 steps/s
[Step=1800 Epoch=17.1] | Loss=0.01037 | Reg=0.00314 | acc=1.0000 | FP-Norm=1.746 | FP-Norm(final)=2.445 | 4293.7 samples/s | 67.1 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00832 | Reg=0.00303 | acc=1.0000 | FP-Norm=1.720 | FP-Norm(final)=2.448 | 1532.4 samples/s | 23.9 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00695 | Reg=0.00293 | acc=1.0000 | FP-Norm=1.691 | FP-Norm(final)=2.450 | 4042.5 samples/s | 63.2 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00598 | Reg=0.00282 | acc=1.0000 | FP-Norm=1.662 | FP-Norm(final)=2.452 | 1548.1 samples/s | 24.2 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00524 | Reg=0.00273 | acc=1.0000 | FP-Norm=1.633 | FP-Norm(final)=2.454 | 3689.9 samples/s | 57.7 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00467 | Reg=0.00264 | acc=1.0000 | FP-Norm=1.606 | FP-Norm(final)=2.455 | 1611.6 samples/s | 25.2 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00421 | Reg=0.00256 | acc=1.0000 | FP-Norm=1.580 | FP-Norm(final)=2.457 | 3588.5 samples/s | 56.1 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00384 | Reg=0.00248 | acc=1.0000 | FP-Norm=1.555 | FP-Norm(final)=2.458 | 1641.3 samples/s | 25.6 steps/s
[Step=2200 Epoch=20.9] | Loss=0.00352 | Reg=0.00240 | acc=1.0000 | FP-Norm=1.531 | FP-Norm(final)=2.460 | 3556.0 samples/s | 55.6 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00326 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.508 | FP-Norm(final)=2.461 | 1657.8 samples/s | 25.9 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00303 | Reg=0.00227 | acc=1.0000 | FP-Norm=1.485 | FP-Norm(final)=2.462 | 3437.1 samples/s | 53.7 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00283 | Reg=0.00221 | acc=1.0000 | FP-Norm=1.464 | FP-Norm(final)=2.464 | 1681.2 samples/s | 26.3 steps/s
[Step=2400 Epoch=22.8] | Loss=0.00266 | Reg=0.00215 | acc=1.0000 | FP-Norm=1.444 | FP-Norm(final)=2.465 | 3479.1 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step2400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=30.5] | Loss=0.16270 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.466 | 3406.2 samples/s | 53.2 steps/s
[Step=3250 Epoch=31.0] | Loss=0.01920 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.253 | FP-Norm(final)=2.457 | 3233.8 samples/s | 50.5 steps/s
[Step=3300 Epoch=31.5] | Loss=0.01168 | Reg=0.00230 | acc=1.0000 | FP-Norm=1.466 | FP-Norm(final)=2.461 | 4564.8 samples/s | 71.3 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00790 | Reg=0.00245 | acc=1.0000 | FP-Norm=1.529 | FP-Norm(final)=2.463 | 1499.3 samples/s | 23.4 steps/s
[Step=3400 Epoch=32.4] | Loss=0.00597 | Reg=0.00244 | acc=1.0000 | FP-Norm=1.535 | FP-Norm(final)=2.466 | 4276.1 samples/s | 66.8 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00480 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.523 | FP-Norm(final)=2.468 | 1519.3 samples/s | 23.7 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00401 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.503 | FP-Norm(final)=2.470 | 4118.0 samples/s | 64.3 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00345 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.481 | FP-Norm(final)=2.472 | 1562.5 samples/s | 24.4 steps/s
[Step=3600 Epoch=34.3] | Loss=0.00303 | Reg=0.00217 | acc=1.0000 | FP-Norm=1.457 | FP-Norm(final)=2.473 | 3928.8 samples/s | 61.4 steps/s
[Step=3650 Epoch=34.8] | Loss=0.00270 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.434 | FP-Norm(final)=2.475 | 1597.4 samples/s | 25.0 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00244 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.411 | FP-Norm(final)=2.476 | 3703.4 samples/s | 57.9 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00222 | Reg=0.00198 | acc=1.0000 | FP-Norm=1.389 | FP-Norm(final)=2.477 | 1610.4 samples/s | 25.2 steps/s
[Step=3800 Epoch=36.2] | Loss=0.00204 | Reg=0.00192 | acc=1.0000 | FP-Norm=1.367 | FP-Norm(final)=2.478 | 3530.1 samples/s | 55.2 steps/s
[Step=3850 Epoch=36.7] | Loss=0.00189 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.346 | FP-Norm(final)=2.479 | 1640.9 samples/s | 25.6 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00176 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.326 | FP-Norm(final)=2.480 | 3463.8 samples/s | 54.1 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00165 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.306 | FP-Norm(final)=2.481 | 1663.6 samples/s | 26.0 steps/s
[Step=4000 Epoch=38.1] | Loss=0.00155 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.287 | FP-Norm(final)=2.482 | 3484.1 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34470 | acc=0.7555 | tpr=0.6567 | fpr=0.0300 | 3492.5 samples/s | 13.6 steps/s
Avg test loss: 0.35357, Avg test acc: 0.75395, Avg tpr: 0.65518, Avg fpr: 0.02884, total FA: 225

Testing server on iccad2012
[Step=  50] | Loss=0.35065 | acc=0.8130 | tpr=0.9558 | fpr=0.1895 | 3453.9 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.35729 | acc=0.8105 | tpr=0.9574 | fpr=0.1922 | 6755.5 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.35992 | acc=0.8100 | tpr=0.9611 | fpr=0.1928 | 6358.6 samples/s | 24.8 steps/s
[Step= 200] | Loss=0.36095 | acc=0.8095 | tpr=0.9617 | fpr=0.1933 | 6608.6 samples/s | 25.8 steps/s
[Step= 250] | Loss=0.36125 | acc=0.8095 | tpr=0.9633 | fpr=0.1933 | 6509.1 samples/s | 25.4 steps/s
[Step= 300] | Loss=0.36180 | acc=0.8096 | tpr=0.9629 | fpr=0.1931 | 6387.3 samples/s | 25.0 steps/s
[Step= 350] | Loss=0.36276 | acc=0.8102 | tpr=0.9624 | fpr=0.1925 | 6433.5 samples/s | 25.1 steps/s
[Step= 400] | Loss=0.36321 | acc=0.8098 | tpr=0.9644 | fpr=0.1930 | 6479.0 samples/s | 25.3 steps/s
[Step= 450] | Loss=0.36531 | acc=0.8094 | tpr=0.9654 | fpr=0.1934 | 6499.1 samples/s | 25.4 steps/s
[Step= 500] | Loss=0.36604 | acc=0.8088 | tpr=0.9656 | fpr=0.1941 | 6505.9 samples/s | 25.4 steps/s
[Step= 550] | Loss=0.36468 | acc=0.8095 | tpr=0.9662 | fpr=0.1934 | 11982.0 samples/s | 46.8 steps/s
Avg test loss: 0.36488, Avg test acc: 0.80935, Avg tpr: 0.96632, Avg fpr: 0.19351, total FA: 26868

server round 11/50

clients selected: [3 4 7 8 9]

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.24370 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.495 | 3428.3 samples/s | 53.6 steps/s
[Step=4850 Epoch=23.7] | Loss=0.05747 | Reg=0.00079 | acc=0.9688 | FP-Norm=0.849 | FP-Norm(final)=2.485 | 3603.9 samples/s | 56.3 steps/s
[Step=4900 Epoch=23.9] | Loss=0.04823 | Reg=0.00091 | acc=0.9531 | FP-Norm=0.930 | FP-Norm(final)=2.485 | 3641.0 samples/s | 56.9 steps/s
[Step=4950 Epoch=24.1] | Loss=0.04419 | Reg=0.00096 | acc=0.9531 | FP-Norm=0.962 | FP-Norm(final)=2.486 | 3692.2 samples/s | 57.7 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04074 | Reg=0.00101 | acc=0.9688 | FP-Norm=0.993 | FP-Norm(final)=2.487 | 4730.2 samples/s | 73.9 steps/s
[Step=5050 Epoch=24.6] | Loss=0.03587 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.021 | FP-Norm(final)=2.490 | 1557.4 samples/s | 24.3 steps/s
[Step=5100 Epoch=24.9] | Loss=0.03263 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.040 | FP-Norm(final)=2.495 | 3665.4 samples/s | 57.3 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03069 | Reg=0.00114 | acc=0.9844 | FP-Norm=1.057 | FP-Norm(final)=2.499 | 3660.9 samples/s | 57.2 steps/s
[Step=5200 Epoch=25.4] | Loss=0.02888 | Reg=0.00117 | acc=0.9844 | FP-Norm=1.072 | FP-Norm(final)=2.503 | 4421.9 samples/s | 69.1 steps/s
[Step=5250 Epoch=25.6] | Loss=0.02669 | Reg=0.00120 | acc=0.9844 | FP-Norm=1.086 | FP-Norm(final)=2.507 | 1595.9 samples/s | 24.9 steps/s
[Step=5300 Epoch=25.8] | Loss=0.02523 | Reg=0.00122 | acc=0.9688 | FP-Norm=1.097 | FP-Norm(final)=2.512 | 3659.2 samples/s | 57.2 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02414 | Reg=0.00124 | acc=0.9844 | FP-Norm=1.107 | FP-Norm(final)=2.516 | 3679.8 samples/s | 57.5 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02326 | Reg=0.00127 | acc=0.9844 | FP-Norm=1.119 | FP-Norm(final)=2.519 | 4206.7 samples/s | 65.7 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02231 | Reg=0.00129 | acc=1.0000 | FP-Norm=1.129 | FP-Norm(final)=2.522 | 1623.2 samples/s | 25.4 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02128 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.139 | FP-Norm(final)=2.526 | 3645.2 samples/s | 57.0 steps/s
[Step=5550 Epoch=27.1] | Loss=0.02058 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.149 | FP-Norm(final)=2.530 | 3608.8 samples/s | 56.4 steps/s
[Step=5600 Epoch=27.3] | Loss=0.01988 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.159 | FP-Norm(final)=2.533 | 3896.6 samples/s | 60.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step5600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=15.7] | Loss=0.26354 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.495 | 3364.7 samples/s | 52.6 steps/s
[Step=3250 Epoch=15.9] | Loss=0.06142 | Reg=0.00072 | acc=0.9531 | FP-Norm=0.812 | FP-Norm(final)=2.481 | 3507.6 samples/s | 54.8 steps/s
[Step=3300 Epoch=16.2] | Loss=0.05100 | Reg=0.00090 | acc=0.9844 | FP-Norm=0.925 | FP-Norm(final)=2.481 | 3571.2 samples/s | 55.8 steps/s
[Step=3350 Epoch=16.4] | Loss=0.04469 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.975 | FP-Norm(final)=2.483 | 3633.5 samples/s | 56.8 steps/s
[Step=3400 Epoch=16.7] | Loss=0.04174 | Reg=0.00107 | acc=0.9531 | FP-Norm=1.020 | FP-Norm(final)=2.486 | 4697.1 samples/s | 73.4 steps/s
[Step=3450 Epoch=16.9] | Loss=0.03665 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.057 | FP-Norm(final)=2.489 | 1509.1 samples/s | 23.6 steps/s
[Step=3500 Epoch=17.2] | Loss=0.03368 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.084 | FP-Norm(final)=2.493 | 3528.6 samples/s | 55.1 steps/s
[Step=3550 Epoch=17.4] | Loss=0.03108 | Reg=0.00126 | acc=0.9844 | FP-Norm=1.109 | FP-Norm(final)=2.497 | 3621.6 samples/s | 56.6 steps/s
[Step=3600 Epoch=17.7] | Loss=0.02900 | Reg=0.00131 | acc=0.9688 | FP-Norm=1.131 | FP-Norm(final)=2.501 | 4541.4 samples/s | 71.0 steps/s
[Step=3650 Epoch=17.9] | Loss=0.02665 | Reg=0.00135 | acc=1.0000 | FP-Norm=1.149 | FP-Norm(final)=2.506 | 1582.3 samples/s | 24.7 steps/s
[Step=3700 Epoch=18.1] | Loss=0.02542 | Reg=0.00138 | acc=0.9688 | FP-Norm=1.164 | FP-Norm(final)=2.510 | 3668.7 samples/s | 57.3 steps/s
[Step=3750 Epoch=18.4] | Loss=0.02418 | Reg=0.00142 | acc=0.9688 | FP-Norm=1.180 | FP-Norm(final)=2.514 | 3675.5 samples/s | 57.4 steps/s
[Step=3800 Epoch=18.6] | Loss=0.02323 | Reg=0.00145 | acc=0.9844 | FP-Norm=1.193 | FP-Norm(final)=2.518 | 4450.3 samples/s | 69.5 steps/s
[Step=3850 Epoch=18.9] | Loss=0.02233 | Reg=0.00148 | acc=0.9844 | FP-Norm=1.206 | FP-Norm(final)=2.522 | 1587.6 samples/s | 24.8 steps/s
[Step=3900 Epoch=19.1] | Loss=0.02129 | Reg=0.00151 | acc=0.9844 | FP-Norm=1.218 | FP-Norm(final)=2.525 | 3684.5 samples/s | 57.6 steps/s
[Step=3950 Epoch=19.4] | Loss=0.02059 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.229 | FP-Norm(final)=2.529 | 3681.1 samples/s | 57.5 steps/s
[Step=4000 Epoch=19.6] | Loss=0.02011 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.240 | FP-Norm(final)=2.532 | 4266.7 samples/s | 66.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step4000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=38.2] | Loss=0.09855 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.495 | 3457.2 samples/s | 54.0 steps/s
[Step=4050 Epoch=38.7] | Loss=0.02393 | Reg=0.00195 | acc=1.0000 | FP-Norm=1.305 | FP-Norm(final)=2.483 | 3293.0 samples/s | 51.5 steps/s
[Step=4100 Epoch=39.2] | Loss=0.01323 | Reg=0.00241 | acc=1.0000 | FP-Norm=1.498 | FP-Norm(final)=2.485 | 4602.8 samples/s | 71.9 steps/s
[Step=4150 Epoch=39.6] | Loss=0.00936 | Reg=0.00245 | acc=1.0000 | FP-Norm=1.528 | FP-Norm(final)=2.488 | 1485.9 samples/s | 23.2 steps/s
[Step=4200 Epoch=40.1] | Loss=0.00706 | Reg=0.00240 | acc=1.0000 | FP-Norm=1.520 | FP-Norm(final)=2.490 | 4320.7 samples/s | 67.5 steps/s
[Step=4250 Epoch=40.6] | Loss=0.00567 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.501 | FP-Norm(final)=2.492 | 1532.4 samples/s | 23.9 steps/s
[Step=4300 Epoch=41.1] | Loss=0.00474 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.479 | FP-Norm(final)=2.493 | 4139.1 samples/s | 64.7 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00407 | Reg=0.00217 | acc=1.0000 | FP-Norm=1.455 | FP-Norm(final)=2.495 | 1558.4 samples/s | 24.3 steps/s
[Step=4400 Epoch=42.0] | Loss=0.00357 | Reg=0.00210 | acc=1.0000 | FP-Norm=1.432 | FP-Norm(final)=2.496 | 3894.4 samples/s | 60.8 steps/s
[Step=4450 Epoch=42.5] | Loss=0.00318 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.409 | FP-Norm(final)=2.497 | 1599.6 samples/s | 25.0 steps/s
[Step=4500 Epoch=43.0] | Loss=0.00287 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.387 | FP-Norm(final)=2.498 | 3705.5 samples/s | 57.9 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00262 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.366 | FP-Norm(final)=2.500 | 1632.3 samples/s | 25.5 steps/s
[Step=4600 Epoch=43.9] | Loss=0.00240 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.345 | FP-Norm(final)=2.501 | 3567.9 samples/s | 55.7 steps/s
[Step=4650 Epoch=44.4] | Loss=0.00222 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.326 | FP-Norm(final)=2.502 | 1635.1 samples/s | 25.5 steps/s
[Step=4700 Epoch=44.9] | Loss=0.00207 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.307 | FP-Norm(final)=2.503 | 3531.9 samples/s | 55.2 steps/s
[Step=4750 Epoch=45.4] | Loss=0.00194 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.288 | FP-Norm(final)=2.504 | 1674.2 samples/s | 26.2 steps/s
[Step=4800 Epoch=45.8] | Loss=0.00182 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.271 | FP-Norm(final)=2.504 | 3544.5 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step4800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=45.2] | Loss=0.05428 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.495 | 3377.6 samples/s | 52.8 steps/s
[Step=4850 Epoch=45.7] | Loss=0.01683 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.340 | FP-Norm(final)=2.484 | 3209.1 samples/s | 50.1 steps/s
[Step=4900 Epoch=46.2] | Loss=0.00962 | Reg=0.00245 | acc=1.0000 | FP-Norm=1.516 | FP-Norm(final)=2.486 | 4525.9 samples/s | 70.7 steps/s
[Step=4950 Epoch=46.6] | Loss=0.00670 | Reg=0.00249 | acc=1.0000 | FP-Norm=1.544 | FP-Norm(final)=2.490 | 1499.6 samples/s | 23.4 steps/s
[Step=5000 Epoch=47.1] | Loss=0.00506 | Reg=0.00242 | acc=1.0000 | FP-Norm=1.531 | FP-Norm(final)=2.493 | 4212.5 samples/s | 65.8 steps/s
[Step=5050 Epoch=47.6] | Loss=0.00409 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.508 | FP-Norm(final)=2.496 | 1564.0 samples/s | 24.4 steps/s
[Step=5100 Epoch=48.1] | Loss=0.00342 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.481 | FP-Norm(final)=2.498 | 3821.4 samples/s | 59.7 steps/s
[Step=5150 Epoch=48.5] | Loss=0.00294 | Reg=0.00217 | acc=1.0000 | FP-Norm=1.454 | FP-Norm(final)=2.500 | 1561.9 samples/s | 24.4 steps/s
[Step=5200 Epoch=49.0] | Loss=0.00258 | Reg=0.00209 | acc=1.0000 | FP-Norm=1.427 | FP-Norm(final)=2.502 | 3572.8 samples/s | 55.8 steps/s
[Step=5250 Epoch=49.5] | Loss=0.00230 | Reg=0.00202 | acc=1.0000 | FP-Norm=1.401 | FP-Norm(final)=2.504 | 1636.5 samples/s | 25.6 steps/s
[Step=5300 Epoch=49.9] | Loss=0.00208 | Reg=0.00195 | acc=1.0000 | FP-Norm=1.376 | FP-Norm(final)=2.505 | 3479.2 samples/s | 54.4 steps/s
[Step=5350 Epoch=50.4] | Loss=0.00189 | Reg=0.00188 | acc=1.0000 | FP-Norm=1.352 | FP-Norm(final)=2.506 | 1679.1 samples/s | 26.2 steps/s
[Step=5400 Epoch=50.9] | Loss=0.00174 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.330 | FP-Norm(final)=2.508 | 3572.3 samples/s | 55.8 steps/s
[Step=5450 Epoch=51.4] | Loss=0.00161 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.308 | FP-Norm(final)=2.509 | 1676.6 samples/s | 26.2 steps/s
[Step=5500 Epoch=51.8] | Loss=0.00150 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.287 | FP-Norm(final)=2.510 | 3490.3 samples/s | 54.5 steps/s
[Step=5550 Epoch=52.3] | Loss=0.00141 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.267 | FP-Norm(final)=2.511 | 1745.0 samples/s | 27.3 steps/s
[Step=5600 Epoch=52.8] | Loss=0.00132 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.248 | FP-Norm(final)=2.512 | 3257.0 samples/s | 50.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step5600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=38.1] | Loss=0.13398 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.494 | 3253.1 samples/s | 50.8 steps/s
[Step=4050 Epoch=38.6] | Loss=0.02155 | Reg=0.00219 | acc=1.0000 | FP-Norm=1.394 | FP-Norm(final)=2.484 | 3423.3 samples/s | 53.5 steps/s
[Step=4100 Epoch=39.1] | Loss=0.01255 | Reg=0.00276 | acc=1.0000 | FP-Norm=1.609 | FP-Norm(final)=2.487 | 4623.1 samples/s | 72.2 steps/s
[Step=4150 Epoch=39.6] | Loss=0.00845 | Reg=0.00282 | acc=1.0000 | FP-Norm=1.645 | FP-Norm(final)=2.492 | 1503.6 samples/s | 23.5 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00635 | Reg=0.00276 | acc=1.0000 | FP-Norm=1.635 | FP-Norm(final)=2.495 | 4306.9 samples/s | 67.3 steps/s
[Step=4250 Epoch=40.5] | Loss=0.00510 | Reg=0.00267 | acc=1.0000 | FP-Norm=1.613 | FP-Norm(final)=2.498 | 1517.0 samples/s | 23.7 steps/s
[Step=4300 Epoch=41.0] | Loss=0.00427 | Reg=0.00258 | acc=1.0000 | FP-Norm=1.586 | FP-Norm(final)=2.500 | 4070.0 samples/s | 63.6 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00367 | Reg=0.00249 | acc=1.0000 | FP-Norm=1.558 | FP-Norm(final)=2.502 | 1544.6 samples/s | 24.1 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00322 | Reg=0.00240 | acc=1.0000 | FP-Norm=1.531 | FP-Norm(final)=2.503 | 3832.1 samples/s | 59.9 steps/s
[Step=4450 Epoch=42.4] | Loss=0.00287 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.504 | FP-Norm(final)=2.505 | 1587.1 samples/s | 24.8 steps/s
[Step=4500 Epoch=42.9] | Loss=0.00259 | Reg=0.00224 | acc=1.0000 | FP-Norm=1.478 | FP-Norm(final)=2.506 | 3698.5 samples/s | 57.8 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00236 | Reg=0.00217 | acc=1.0000 | FP-Norm=1.453 | FP-Norm(final)=2.507 | 1637.0 samples/s | 25.6 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00217 | Reg=0.00210 | acc=1.0000 | FP-Norm=1.429 | FP-Norm(final)=2.508 | 3550.6 samples/s | 55.5 steps/s
[Step=4650 Epoch=44.3] | Loss=0.00201 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.406 | FP-Norm(final)=2.510 | 1660.1 samples/s | 25.9 steps/s
[Step=4700 Epoch=44.8] | Loss=0.00187 | Reg=0.00198 | acc=1.0000 | FP-Norm=1.384 | FP-Norm(final)=2.511 | 3558.8 samples/s | 55.6 steps/s
[Step=4750 Epoch=45.3] | Loss=0.00175 | Reg=0.00192 | acc=1.0000 | FP-Norm=1.363 | FP-Norm(final)=2.512 | 1636.6 samples/s | 25.6 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00164 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.342 | FP-Norm(final)=2.513 | 3454.2 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35739 | acc=0.7567 | tpr=0.6567 | fpr=0.0260 | 3510.1 samples/s | 13.7 steps/s
Avg test loss: 0.36729, Avg test acc: 0.75611, Avg tpr: 0.65653, Avg fpr: 0.02487, total FA: 194

Testing server on iccad2012
[Step=  50] | Loss=0.36670 | acc=0.8200 | tpr=0.9602 | fpr=0.1825 | 3489.6 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.37339 | acc=0.8154 | tpr=0.9616 | fpr=0.1874 | 6499.1 samples/s | 25.4 steps/s
[Step= 150] | Loss=0.37662 | acc=0.8146 | tpr=0.9640 | fpr=0.1882 | 6530.9 samples/s | 25.5 steps/s
[Step= 200] | Loss=0.37794 | acc=0.8136 | tpr=0.9650 | fpr=0.1891 | 6530.1 samples/s | 25.5 steps/s
[Step= 250] | Loss=0.37843 | acc=0.8137 | tpr=0.9659 | fpr=0.1891 | 6804.6 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.37907 | acc=0.8133 | tpr=0.9658 | fpr=0.1894 | 6177.9 samples/s | 24.1 steps/s
[Step= 350] | Loss=0.38021 | acc=0.8137 | tpr=0.9656 | fpr=0.1890 | 6848.0 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.38059 | acc=0.8132 | tpr=0.9672 | fpr=0.1896 | 6300.1 samples/s | 24.6 steps/s
[Step= 450] | Loss=0.38307 | acc=0.8127 | tpr=0.9669 | fpr=0.1901 | 6514.3 samples/s | 25.4 steps/s
[Step= 500] | Loss=0.38374 | acc=0.8123 | tpr=0.9670 | fpr=0.1905 | 6405.3 samples/s | 25.0 steps/s
[Step= 550] | Loss=0.38228 | acc=0.8129 | tpr=0.9670 | fpr=0.1899 | 11403.7 samples/s | 44.5 steps/s
Avg test loss: 0.38251, Avg test acc: 0.81288, Avg tpr: 0.96712, Avg fpr: 0.18993, total FA: 26371

server round 12/50

clients selected: [0 2 5 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=2401 Epoch=11.7] | Loss=0.35232 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.534 | 3537.3 samples/s | 55.3 steps/s
[Step=2450 Epoch=11.9] | Loss=0.06152 | Reg=0.00085 | acc=0.9688 | FP-Norm=0.881 | FP-Norm(final)=2.518 | 3485.9 samples/s | 54.5 steps/s
[Step=2500 Epoch=12.2] | Loss=0.04969 | Reg=0.00104 | acc=0.9531 | FP-Norm=0.992 | FP-Norm(final)=2.516 | 3704.1 samples/s | 57.9 steps/s
[Step=2550 Epoch=12.4] | Loss=0.04456 | Reg=0.00112 | acc=0.9844 | FP-Norm=1.039 | FP-Norm(final)=2.515 | 3677.1 samples/s | 57.5 steps/s
[Step=2600 Epoch=12.7] | Loss=0.04148 | Reg=0.00118 | acc=0.9531 | FP-Norm=1.070 | FP-Norm(final)=2.517 | 4747.4 samples/s | 74.2 steps/s
[Step=2650 Epoch=12.9] | Loss=0.03716 | Reg=0.00123 | acc=0.9688 | FP-Norm=1.097 | FP-Norm(final)=2.519 | 1537.0 samples/s | 24.0 steps/s
[Step=2700 Epoch=13.2] | Loss=0.03359 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.115 | FP-Norm(final)=2.523 | 3668.0 samples/s | 57.3 steps/s
[Step=2750 Epoch=13.4] | Loss=0.03090 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.130 | FP-Norm(final)=2.526 | 3613.3 samples/s | 56.5 steps/s
[Step=2800 Epoch=13.7] | Loss=0.02937 | Reg=0.00133 | acc=0.9844 | FP-Norm=1.144 | FP-Norm(final)=2.530 | 4458.3 samples/s | 69.7 steps/s
[Step=2850 Epoch=13.9] | Loss=0.02768 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.160 | FP-Norm(final)=2.534 | 1597.8 samples/s | 25.0 steps/s
[Step=2900 Epoch=14.1] | Loss=0.02638 | Reg=0.00140 | acc=0.9844 | FP-Norm=1.174 | FP-Norm(final)=2.537 | 3651.7 samples/s | 57.1 steps/s
[Step=2950 Epoch=14.4] | Loss=0.02472 | Reg=0.00143 | acc=0.9844 | FP-Norm=1.186 | FP-Norm(final)=2.541 | 3680.7 samples/s | 57.5 steps/s
[Step=3000 Epoch=14.6] | Loss=0.02370 | Reg=0.00146 | acc=0.9844 | FP-Norm=1.198 | FP-Norm(final)=2.544 | 4191.1 samples/s | 65.5 steps/s
[Step=3050 Epoch=14.9] | Loss=0.02267 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.209 | FP-Norm(final)=2.548 | 1614.5 samples/s | 25.2 steps/s
[Step=3100 Epoch=15.1] | Loss=0.02190 | Reg=0.00151 | acc=0.9844 | FP-Norm=1.219 | FP-Norm(final)=2.551 | 3672.6 samples/s | 57.4 steps/s
[Step=3150 Epoch=15.4] | Loss=0.02103 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.230 | FP-Norm(final)=2.554 | 3640.0 samples/s | 56.9 steps/s
[Step=3200 Epoch=15.6] | Loss=0.02022 | Reg=0.00156 | acc=0.9844 | FP-Norm=1.239 | FP-Norm(final)=2.557 | 3942.0 samples/s | 61.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step3200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.28842 | Reg=0.00000 | acc=0.7500 | FP-Norm=0.000 | FP-Norm(final)=2.534 | 3421.6 samples/s | 53.5 steps/s
[Step=5650 Epoch=27.5] | Loss=0.07429 | Reg=0.00095 | acc=0.9844 | FP-Norm=0.931 | FP-Norm(final)=2.509 | 3486.3 samples/s | 54.5 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05776 | Reg=0.00115 | acc=0.9531 | FP-Norm=1.046 | FP-Norm(final)=2.507 | 3627.2 samples/s | 56.7 steps/s
[Step=5750 Epoch=28.0] | Loss=0.05054 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.091 | FP-Norm(final)=2.510 | 3611.0 samples/s | 56.4 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04643 | Reg=0.00132 | acc=0.9531 | FP-Norm=1.132 | FP-Norm(final)=2.512 | 4716.8 samples/s | 73.7 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04144 | Reg=0.00139 | acc=1.0000 | FP-Norm=1.163 | FP-Norm(final)=2.516 | 1569.9 samples/s | 24.5 steps/s
[Step=5900 Epoch=28.7] | Loss=0.03735 | Reg=0.00144 | acc=0.9688 | FP-Norm=1.188 | FP-Norm(final)=2.522 | 3613.5 samples/s | 56.5 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03470 | Reg=0.00149 | acc=0.9688 | FP-Norm=1.209 | FP-Norm(final)=2.528 | 3662.9 samples/s | 57.2 steps/s
[Step=6000 Epoch=29.2] | Loss=0.03235 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.230 | FP-Norm(final)=2.533 | 4398.1 samples/s | 68.7 steps/s
[Step=6050 Epoch=29.5] | Loss=0.03070 | Reg=0.00159 | acc=0.9688 | FP-Norm=1.249 | FP-Norm(final)=2.538 | 1574.2 samples/s | 24.6 steps/s
[Step=6100 Epoch=29.7] | Loss=0.02890 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.264 | FP-Norm(final)=2.542 | 3688.7 samples/s | 57.6 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02769 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.278 | FP-Norm(final)=2.546 | 3693.4 samples/s | 57.7 steps/s
[Step=6200 Epoch=30.2] | Loss=0.02638 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.292 | FP-Norm(final)=2.551 | 4193.0 samples/s | 65.5 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02538 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.306 | FP-Norm(final)=2.555 | 1603.5 samples/s | 25.1 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02439 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.319 | FP-Norm(final)=2.559 | 3628.2 samples/s | 56.7 steps/s
[Step=6350 Epoch=30.9] | Loss=0.02344 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.330 | FP-Norm(final)=2.563 | 3608.6 samples/s | 56.4 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02268 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.340 | FP-Norm(final)=2.567 | 3906.3 samples/s | 61.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step6400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=68.2] | Loss=0.03817 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.535 | 3379.5 samples/s | 52.8 steps/s
[Step=7250 Epoch=68.7] | Loss=0.01244 | Reg=0.00196 | acc=1.0000 | FP-Norm=1.314 | FP-Norm(final)=2.529 | 3248.5 samples/s | 50.8 steps/s
[Step=7300 Epoch=69.2] | Loss=0.00680 | Reg=0.00233 | acc=1.0000 | FP-Norm=1.480 | FP-Norm(final)=2.533 | 4536.6 samples/s | 70.9 steps/s
[Step=7350 Epoch=69.6] | Loss=0.00458 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.498 | FP-Norm(final)=2.538 | 1499.4 samples/s | 23.4 steps/s
[Step=7400 Epoch=70.1] | Loss=0.00352 | Reg=0.00226 | acc=1.0000 | FP-Norm=1.479 | FP-Norm(final)=2.541 | 4261.2 samples/s | 66.6 steps/s
[Step=7450 Epoch=70.6] | Loss=0.00283 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.456 | FP-Norm(final)=2.543 | 1545.5 samples/s | 24.1 steps/s
[Step=7500 Epoch=71.1] | Loss=0.00237 | Reg=0.00209 | acc=1.0000 | FP-Norm=1.428 | FP-Norm(final)=2.545 | 3965.6 samples/s | 62.0 steps/s
[Step=7550 Epoch=71.5] | Loss=0.00203 | Reg=0.00201 | acc=1.0000 | FP-Norm=1.400 | FP-Norm(final)=2.547 | 1577.8 samples/s | 24.7 steps/s
[Step=7600 Epoch=72.0] | Loss=0.00178 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.372 | FP-Norm(final)=2.548 | 3799.3 samples/s | 59.4 steps/s
[Step=7650 Epoch=72.5] | Loss=0.00159 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.345 | FP-Norm(final)=2.549 | 1598.5 samples/s | 25.0 steps/s
[Step=7700 Epoch=73.0] | Loss=0.00143 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.319 | FP-Norm(final)=2.550 | 3548.9 samples/s | 55.5 steps/s
[Step=7750 Epoch=73.4] | Loss=0.00131 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.294 | FP-Norm(final)=2.551 | 1641.2 samples/s | 25.6 steps/s
[Step=7800 Epoch=73.9] | Loss=0.00120 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.271 | FP-Norm(final)=2.552 | 3521.3 samples/s | 55.0 steps/s
[Step=7850 Epoch=74.4] | Loss=0.00111 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.248 | FP-Norm(final)=2.552 | 1662.6 samples/s | 26.0 steps/s
[Step=7900 Epoch=74.9] | Loss=0.00104 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.226 | FP-Norm(final)=2.553 | 3536.4 samples/s | 55.3 steps/s
[Step=7950 Epoch=75.3] | Loss=0.00097 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.206 | FP-Norm(final)=2.554 | 1672.6 samples/s | 26.1 steps/s
[Step=8000 Epoch=75.8] | Loss=0.00091 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.186 | FP-Norm(final)=2.554 | 3459.7 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step8000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=52.8] | Loss=0.08600 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.534 | 3625.0 samples/s | 56.6 steps/s
[Step=5650 Epoch=53.2] | Loss=0.01540 | Reg=0.00216 | acc=0.9688 | FP-Norm=1.387 | FP-Norm(final)=2.527 | 3202.7 samples/s | 50.0 steps/s
[Step=5700 Epoch=53.7] | Loss=0.00998 | Reg=0.00277 | acc=1.0000 | FP-Norm=1.614 | FP-Norm(final)=2.531 | 4523.8 samples/s | 70.7 steps/s
[Step=5750 Epoch=54.2] | Loss=0.00682 | Reg=0.00289 | acc=1.0000 | FP-Norm=1.663 | FP-Norm(final)=2.536 | 1509.1 samples/s | 23.6 steps/s
[Step=5800 Epoch=54.7] | Loss=0.00516 | Reg=0.00285 | acc=1.0000 | FP-Norm=1.661 | FP-Norm(final)=2.541 | 4150.4 samples/s | 64.9 steps/s
[Step=5850 Epoch=55.1] | Loss=0.00414 | Reg=0.00276 | acc=1.0000 | FP-Norm=1.639 | FP-Norm(final)=2.544 | 1559.1 samples/s | 24.4 steps/s
[Step=5900 Epoch=55.6] | Loss=0.00346 | Reg=0.00266 | acc=1.0000 | FP-Norm=1.612 | FP-Norm(final)=2.546 | 3894.3 samples/s | 60.8 steps/s
[Step=5950 Epoch=56.1] | Loss=0.00298 | Reg=0.00257 | acc=1.0000 | FP-Norm=1.583 | FP-Norm(final)=2.548 | 1599.9 samples/s | 25.0 steps/s
[Step=6000 Epoch=56.5] | Loss=0.00261 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.554 | FP-Norm(final)=2.550 | 3688.6 samples/s | 57.6 steps/s
[Step=6050 Epoch=57.0] | Loss=0.00233 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.525 | FP-Norm(final)=2.552 | 1638.6 samples/s | 25.6 steps/s
[Step=6100 Epoch=57.5] | Loss=0.00210 | Reg=0.00230 | acc=1.0000 | FP-Norm=1.498 | FP-Norm(final)=2.553 | 3564.7 samples/s | 55.7 steps/s
[Step=6150 Epoch=58.0] | Loss=0.00191 | Reg=0.00223 | acc=1.0000 | FP-Norm=1.472 | FP-Norm(final)=2.554 | 1684.8 samples/s | 26.3 steps/s
[Step=6200 Epoch=58.4] | Loss=0.00176 | Reg=0.00216 | acc=1.0000 | FP-Norm=1.447 | FP-Norm(final)=2.555 | 3479.7 samples/s | 54.4 steps/s
[Step=6250 Epoch=58.9] | Loss=0.00163 | Reg=0.00209 | acc=1.0000 | FP-Norm=1.423 | FP-Norm(final)=2.556 | 1690.4 samples/s | 26.4 steps/s
[Step=6300 Epoch=59.4] | Loss=0.00151 | Reg=0.00203 | acc=1.0000 | FP-Norm=1.399 | FP-Norm(final)=2.557 | 3408.7 samples/s | 53.3 steps/s
[Step=6350 Epoch=59.8] | Loss=0.00142 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.377 | FP-Norm(final)=2.558 | 1778.9 samples/s | 27.8 steps/s
[Step=6400 Epoch=60.3] | Loss=0.00133 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.356 | FP-Norm(final)=2.559 | 2879.8 samples/s | 45.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step6400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=45.8] | Loss=0.05630 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.534 | 3434.5 samples/s | 53.7 steps/s
[Step=4850 Epoch=46.2] | Loss=0.01637 | Reg=0.00195 | acc=0.9688 | FP-Norm=1.313 | FP-Norm(final)=2.528 | 3356.2 samples/s | 52.4 steps/s
[Step=4900 Epoch=46.7] | Loss=0.00957 | Reg=0.00260 | acc=1.0000 | FP-Norm=1.558 | FP-Norm(final)=2.531 | 4613.2 samples/s | 72.1 steps/s
[Step=4950 Epoch=47.2] | Loss=0.00656 | Reg=0.00267 | acc=1.0000 | FP-Norm=1.598 | FP-Norm(final)=2.535 | 1476.2 samples/s | 23.1 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00498 | Reg=0.00263 | acc=1.0000 | FP-Norm=1.594 | FP-Norm(final)=2.539 | 4375.7 samples/s | 68.4 steps/s
[Step=5050 Epoch=48.1] | Loss=0.00400 | Reg=0.00255 | acc=1.0000 | FP-Norm=1.574 | FP-Norm(final)=2.541 | 1533.1 samples/s | 24.0 steps/s
[Step=5100 Epoch=48.6] | Loss=0.00335 | Reg=0.00246 | acc=1.0000 | FP-Norm=1.547 | FP-Norm(final)=2.543 | 4108.6 samples/s | 64.2 steps/s
[Step=5150 Epoch=49.1] | Loss=0.00288 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.520 | FP-Norm(final)=2.545 | 1569.4 samples/s | 24.5 steps/s
[Step=5200 Epoch=49.6] | Loss=0.00253 | Reg=0.00228 | acc=1.0000 | FP-Norm=1.492 | FP-Norm(final)=2.546 | 3934.6 samples/s | 61.5 steps/s
[Step=5250 Epoch=50.0] | Loss=0.00225 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.465 | FP-Norm(final)=2.548 | 1570.3 samples/s | 24.5 steps/s
[Step=5300 Epoch=50.5] | Loss=0.00203 | Reg=0.00213 | acc=1.0000 | FP-Norm=1.439 | FP-Norm(final)=2.549 | 3757.1 samples/s | 58.7 steps/s
[Step=5350 Epoch=51.0] | Loss=0.00185 | Reg=0.00206 | acc=1.0000 | FP-Norm=1.414 | FP-Norm(final)=2.550 | 1634.3 samples/s | 25.5 steps/s
[Step=5400 Epoch=51.5] | Loss=0.00170 | Reg=0.00199 | acc=1.0000 | FP-Norm=1.390 | FP-Norm(final)=2.551 | 3554.4 samples/s | 55.5 steps/s
[Step=5450 Epoch=51.9] | Loss=0.00157 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.366 | FP-Norm(final)=2.552 | 1649.6 samples/s | 25.8 steps/s
[Step=5500 Epoch=52.4] | Loss=0.00147 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.344 | FP-Norm(final)=2.553 | 3393.1 samples/s | 53.0 steps/s
[Step=5550 Epoch=52.9] | Loss=0.00137 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.323 | FP-Norm(final)=2.553 | 1659.7 samples/s | 25.9 steps/s
[Step=5600 Epoch=53.4] | Loss=0.00129 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.302 | FP-Norm(final)=2.554 | 3524.3 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33778 | acc=0.7742 | tpr=0.6818 | fpr=0.0250 | 3510.1 samples/s | 13.7 steps/s
Avg test loss: 0.34791, Avg test acc: 0.77410, Avg tpr: 0.68235, Avg fpr: 0.02410, total FA: 188

Testing server on iccad2012
[Step=  50] | Loss=0.42769 | acc=0.8000 | tpr=0.9602 | fpr=0.2029 | 3471.4 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.43484 | acc=0.7978 | tpr=0.9659 | fpr=0.2054 | 6462.0 samples/s | 25.2 steps/s
[Step= 150] | Loss=0.43858 | acc=0.7959 | tpr=0.9697 | fpr=0.2073 | 6572.0 samples/s | 25.7 steps/s
[Step= 200] | Loss=0.43942 | acc=0.7955 | tpr=0.9705 | fpr=0.2076 | 6560.7 samples/s | 25.6 steps/s
[Step= 250] | Loss=0.43980 | acc=0.7962 | tpr=0.9703 | fpr=0.2070 | 6294.0 samples/s | 24.6 steps/s
[Step= 300] | Loss=0.44054 | acc=0.7959 | tpr=0.9716 | fpr=0.2073 | 6452.4 samples/s | 25.2 steps/s
[Step= 350] | Loss=0.44152 | acc=0.7969 | tpr=0.9712 | fpr=0.2062 | 6310.9 samples/s | 24.7 steps/s
[Step= 400] | Loss=0.44187 | acc=0.7965 | tpr=0.9726 | fpr=0.2067 | 6308.4 samples/s | 24.6 steps/s
[Step= 450] | Loss=0.44484 | acc=0.7963 | tpr=0.9732 | fpr=0.2069 | 6522.6 samples/s | 25.5 steps/s
[Step= 500] | Loss=0.44574 | acc=0.7957 | tpr=0.9744 | fpr=0.2075 | 6362.8 samples/s | 24.9 steps/s
[Step= 550] | Loss=0.44412 | acc=0.7963 | tpr=0.9737 | fpr=0.2069 | 12267.2 samples/s | 47.9 steps/s
Avg test loss: 0.44437, Avg test acc: 0.79616, Avg tpr: 0.97385, Avg fpr: 0.20707, total FA: 28751

server round 13/50

clients selected: [0 2 3 5 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=15.6] | Loss=0.23167 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.566 | 3458.3 samples/s | 54.0 steps/s
[Step=3250 Epoch=15.8] | Loss=0.05612 | Reg=0.00081 | acc=0.9688 | FP-Norm=0.860 | FP-Norm(final)=2.549 | 3586.5 samples/s | 56.0 steps/s
[Step=3300 Epoch=16.1] | Loss=0.04736 | Reg=0.00099 | acc=0.9844 | FP-Norm=0.973 | FP-Norm(final)=2.547 | 3704.5 samples/s | 57.9 steps/s
[Step=3350 Epoch=16.3] | Loss=0.04252 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.036 | FP-Norm(final)=2.548 | 3702.8 samples/s | 57.9 steps/s
[Step=3400 Epoch=16.6] | Loss=0.03992 | Reg=0.00120 | acc=0.9844 | FP-Norm=1.080 | FP-Norm(final)=2.549 | 4733.9 samples/s | 74.0 steps/s
[Step=3450 Epoch=16.8] | Loss=0.03855 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.136 | FP-Norm(final)=2.551 | 1535.4 samples/s | 24.0 steps/s
[Step=3500 Epoch=17.1] | Loss=0.03521 | Reg=0.00144 | acc=0.9844 | FP-Norm=1.180 | FP-Norm(final)=2.553 | 3659.2 samples/s | 57.2 steps/s
[Step=3550 Epoch=17.3] | Loss=0.03271 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.210 | FP-Norm(final)=2.556 | 3631.5 samples/s | 56.7 steps/s
[Step=3600 Epoch=17.6] | Loss=0.03093 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.236 | FP-Norm(final)=2.560 | 4421.2 samples/s | 69.1 steps/s
[Step=3650 Epoch=17.8] | Loss=0.02898 | Reg=0.00163 | acc=0.9844 | FP-Norm=1.259 | FP-Norm(final)=2.563 | 1579.9 samples/s | 24.7 steps/s
[Step=3700 Epoch=18.0] | Loss=0.02703 | Reg=0.00167 | acc=0.9844 | FP-Norm=1.277 | FP-Norm(final)=2.567 | 3621.7 samples/s | 56.6 steps/s
[Step=3750 Epoch=18.3] | Loss=0.02578 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.291 | FP-Norm(final)=2.570 | 3614.8 samples/s | 56.5 steps/s
[Step=3800 Epoch=18.5] | Loss=0.02479 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.305 | FP-Norm(final)=2.574 | 4096.5 samples/s | 64.0 steps/s
[Step=3850 Epoch=18.8] | Loss=0.02358 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.318 | FP-Norm(final)=2.577 | 1613.3 samples/s | 25.2 steps/s
[Step=3900 Epoch=19.0] | Loss=0.02274 | Reg=0.00180 | acc=0.9531 | FP-Norm=1.328 | FP-Norm(final)=2.580 | 3652.1 samples/s | 57.1 steps/s
[Step=3950 Epoch=19.3] | Loss=0.02191 | Reg=0.00183 | acc=1.0000 | FP-Norm=1.339 | FP-Norm(final)=2.583 | 3681.8 samples/s | 57.5 steps/s
[Step=4000 Epoch=19.5] | Loss=0.02147 | Reg=0.00185 | acc=0.9844 | FP-Norm=1.348 | FP-Norm(final)=2.586 | 3951.5 samples/s | 61.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step4000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=31.2] | Loss=0.21823 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.566 | 3398.0 samples/s | 53.1 steps/s
[Step=6450 Epoch=31.4] | Loss=0.07855 | Reg=0.00148 | acc=0.9688 | FP-Norm=1.156 | FP-Norm(final)=2.528 | 3621.9 samples/s | 56.6 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05950 | Reg=0.00164 | acc=0.9844 | FP-Norm=1.250 | FP-Norm(final)=2.522 | 3614.0 samples/s | 56.5 steps/s
[Step=6550 Epoch=31.9] | Loss=0.05201 | Reg=0.00168 | acc=0.9844 | FP-Norm=1.276 | FP-Norm(final)=2.524 | 3622.8 samples/s | 56.6 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04747 | Reg=0.00174 | acc=0.9688 | FP-Norm=1.301 | FP-Norm(final)=2.526 | 4663.4 samples/s | 72.9 steps/s
[Step=6650 Epoch=32.4] | Loss=0.04154 | Reg=0.00177 | acc=0.9844 | FP-Norm=1.318 | FP-Norm(final)=2.531 | 1536.4 samples/s | 24.0 steps/s
[Step=6700 Epoch=32.6] | Loss=0.03770 | Reg=0.00180 | acc=0.9688 | FP-Norm=1.329 | FP-Norm(final)=2.536 | 3654.1 samples/s | 57.1 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03491 | Reg=0.00182 | acc=0.9844 | FP-Norm=1.339 | FP-Norm(final)=2.541 | 3613.1 samples/s | 56.5 steps/s
[Step=6800 Epoch=33.1] | Loss=0.03307 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.350 | FP-Norm(final)=2.545 | 4409.2 samples/s | 68.9 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03065 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.360 | FP-Norm(final)=2.550 | 1578.1 samples/s | 24.7 steps/s
[Step=6900 Epoch=33.6] | Loss=0.02891 | Reg=0.00189 | acc=0.9844 | FP-Norm=1.368 | FP-Norm(final)=2.555 | 3686.1 samples/s | 57.6 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02710 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.375 | FP-Norm(final)=2.560 | 3673.8 samples/s | 57.4 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02575 | Reg=0.00192 | acc=0.9844 | FP-Norm=1.380 | FP-Norm(final)=2.565 | 4179.2 samples/s | 65.3 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02479 | Reg=0.00194 | acc=1.0000 | FP-Norm=1.388 | FP-Norm(final)=2.570 | 1625.0 samples/s | 25.4 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02382 | Reg=0.00197 | acc=0.9844 | FP-Norm=1.396 | FP-Norm(final)=2.574 | 3631.2 samples/s | 56.7 steps/s
[Step=7150 Epoch=34.8] | Loss=0.02301 | Reg=0.00198 | acc=0.9688 | FP-Norm=1.402 | FP-Norm(final)=2.578 | 3618.0 samples/s | 56.5 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02230 | Reg=0.00200 | acc=0.9844 | FP-Norm=1.409 | FP-Norm(final)=2.582 | 3914.6 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step7200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.30260 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.566 | 3746.2 samples/s | 58.5 steps/s
[Step=5650 Epoch=27.6] | Loss=0.06735 | Reg=0.00090 | acc=0.9688 | FP-Norm=0.898 | FP-Norm(final)=2.546 | 3212.9 samples/s | 50.2 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05433 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.020 | FP-Norm(final)=2.540 | 3699.1 samples/s | 57.8 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04865 | Reg=0.00121 | acc=0.9688 | FP-Norm=1.077 | FP-Norm(final)=2.540 | 3675.1 samples/s | 57.4 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04283 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.112 | FP-Norm(final)=2.540 | 4717.0 samples/s | 73.7 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03759 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.139 | FP-Norm(final)=2.543 | 1570.5 samples/s | 24.5 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03393 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.156 | FP-Norm(final)=2.548 | 3678.6 samples/s | 57.5 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03142 | Reg=0.00140 | acc=0.9844 | FP-Norm=1.170 | FP-Norm(final)=2.552 | 3705.1 samples/s | 57.9 steps/s
[Step=6000 Epoch=29.3] | Loss=0.02924 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.181 | FP-Norm(final)=2.556 | 4464.4 samples/s | 69.8 steps/s
[Step=6050 Epoch=29.5] | Loss=0.02753 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.192 | FP-Norm(final)=2.560 | 1597.9 samples/s | 25.0 steps/s
[Step=6100 Epoch=29.7] | Loss=0.02619 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.205 | FP-Norm(final)=2.563 | 3694.3 samples/s | 57.7 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02474 | Reg=0.00150 | acc=0.9844 | FP-Norm=1.216 | FP-Norm(final)=2.567 | 3696.8 samples/s | 57.8 steps/s
[Step=6200 Epoch=30.2] | Loss=0.02369 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.227 | FP-Norm(final)=2.571 | 4158.6 samples/s | 65.0 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02278 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.239 | FP-Norm(final)=2.574 | 1624.5 samples/s | 25.4 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02193 | Reg=0.00158 | acc=0.9375 | FP-Norm=1.251 | FP-Norm(final)=2.578 | 3726.0 samples/s | 58.2 steps/s
[Step=6350 Epoch=31.0] | Loss=0.02123 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.261 | FP-Norm(final)=2.581 | 3654.5 samples/s | 57.1 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02051 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.271 | FP-Norm(final)=2.584 | 3974.1 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step6400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=75.8] | Loss=0.21479 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.566 | 3140.7 samples/s | 49.1 steps/s
[Step=8050 Epoch=76.3] | Loss=0.02107 | Reg=0.00277 | acc=0.9844 | FP-Norm=1.582 | FP-Norm(final)=2.547 | 3644.5 samples/s | 56.9 steps/s
[Step=8100 Epoch=76.8] | Loss=0.01283 | Reg=0.00336 | acc=1.0000 | FP-Norm=1.784 | FP-Norm(final)=2.541 | 4524.6 samples/s | 70.7 steps/s
[Step=8150 Epoch=77.2] | Loss=0.00869 | Reg=0.00339 | acc=1.0000 | FP-Norm=1.809 | FP-Norm(final)=2.542 | 1480.4 samples/s | 23.1 steps/s
[Step=8200 Epoch=77.7] | Loss=0.00656 | Reg=0.00329 | acc=1.0000 | FP-Norm=1.788 | FP-Norm(final)=2.544 | 4177.6 samples/s | 65.3 steps/s
[Step=8250 Epoch=78.2] | Loss=0.00526 | Reg=0.00316 | acc=1.0000 | FP-Norm=1.756 | FP-Norm(final)=2.546 | 1539.0 samples/s | 24.0 steps/s
[Step=8300 Epoch=78.6] | Loss=0.00439 | Reg=0.00303 | acc=1.0000 | FP-Norm=1.721 | FP-Norm(final)=2.548 | 3988.5 samples/s | 62.3 steps/s
[Step=8350 Epoch=79.1] | Loss=0.00378 | Reg=0.00291 | acc=1.0000 | FP-Norm=1.687 | FP-Norm(final)=2.550 | 1589.5 samples/s | 24.8 steps/s
[Step=8400 Epoch=79.6] | Loss=0.00331 | Reg=0.00280 | acc=1.0000 | FP-Norm=1.654 | FP-Norm(final)=2.552 | 3765.7 samples/s | 58.8 steps/s
[Step=8450 Epoch=80.1] | Loss=0.00295 | Reg=0.00270 | acc=1.0000 | FP-Norm=1.623 | FP-Norm(final)=2.554 | 1599.0 samples/s | 25.0 steps/s
[Step=8500 Epoch=80.5] | Loss=0.00266 | Reg=0.00261 | acc=1.0000 | FP-Norm=1.594 | FP-Norm(final)=2.555 | 3562.5 samples/s | 55.7 steps/s
[Step=8550 Epoch=81.0] | Loss=0.00243 | Reg=0.00252 | acc=1.0000 | FP-Norm=1.566 | FP-Norm(final)=2.557 | 1660.7 samples/s | 25.9 steps/s
[Step=8600 Epoch=81.5] | Loss=0.00223 | Reg=0.00244 | acc=1.0000 | FP-Norm=1.539 | FP-Norm(final)=2.558 | 3569.0 samples/s | 55.8 steps/s
[Step=8650 Epoch=82.0] | Loss=0.00206 | Reg=0.00236 | acc=1.0000 | FP-Norm=1.514 | FP-Norm(final)=2.560 | 1669.8 samples/s | 26.1 steps/s
[Step=8700 Epoch=82.4] | Loss=0.00192 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.489 | FP-Norm(final)=2.561 | 3562.1 samples/s | 55.7 steps/s
[Step=8750 Epoch=82.9] | Loss=0.00179 | Reg=0.00223 | acc=1.0000 | FP-Norm=1.466 | FP-Norm(final)=2.562 | 1645.2 samples/s | 25.7 steps/s
[Step=8800 Epoch=83.4] | Loss=0.00168 | Reg=0.00216 | acc=1.0000 | FP-Norm=1.443 | FP-Norm(final)=2.564 | 3517.4 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step8800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=53.4] | Loss=0.03346 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.567 | 3619.3 samples/s | 56.6 steps/s
[Step=5650 Epoch=53.8] | Loss=0.01760 | Reg=0.00278 | acc=1.0000 | FP-Norm=1.566 | FP-Norm(final)=2.545 | 3132.4 samples/s | 48.9 steps/s
[Step=5700 Epoch=54.3] | Loss=0.01028 | Reg=0.00320 | acc=1.0000 | FP-Norm=1.734 | FP-Norm(final)=2.548 | 4510.8 samples/s | 70.5 steps/s
[Step=5750 Epoch=54.8] | Loss=0.00699 | Reg=0.00318 | acc=1.0000 | FP-Norm=1.745 | FP-Norm(final)=2.553 | 1503.0 samples/s | 23.5 steps/s
[Step=5800 Epoch=55.3] | Loss=0.00528 | Reg=0.00306 | acc=1.0000 | FP-Norm=1.722 | FP-Norm(final)=2.557 | 4293.8 samples/s | 67.1 steps/s
[Step=5850 Epoch=55.8] | Loss=0.00423 | Reg=0.00293 | acc=1.0000 | FP-Norm=1.688 | FP-Norm(final)=2.561 | 1532.2 samples/s | 23.9 steps/s
[Step=5900 Epoch=56.2] | Loss=0.00354 | Reg=0.00281 | acc=1.0000 | FP-Norm=1.652 | FP-Norm(final)=2.563 | 4054.5 samples/s | 63.4 steps/s
[Step=5950 Epoch=56.7] | Loss=0.00304 | Reg=0.00269 | acc=1.0000 | FP-Norm=1.617 | FP-Norm(final)=2.565 | 1577.9 samples/s | 24.7 steps/s
[Step=6000 Epoch=57.2] | Loss=0.00267 | Reg=0.00258 | acc=1.0000 | FP-Norm=1.583 | FP-Norm(final)=2.567 | 3889.1 samples/s | 60.8 steps/s
[Step=6050 Epoch=57.7] | Loss=0.00238 | Reg=0.00248 | acc=1.0000 | FP-Norm=1.551 | FP-Norm(final)=2.569 | 1601.1 samples/s | 25.0 steps/s
[Step=6100 Epoch=58.1] | Loss=0.00215 | Reg=0.00238 | acc=1.0000 | FP-Norm=1.520 | FP-Norm(final)=2.570 | 3742.1 samples/s | 58.5 steps/s
[Step=6150 Epoch=58.6] | Loss=0.00195 | Reg=0.00230 | acc=1.0000 | FP-Norm=1.491 | FP-Norm(final)=2.572 | 1630.2 samples/s | 25.5 steps/s
[Step=6200 Epoch=59.1] | Loss=0.00180 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.464 | FP-Norm(final)=2.573 | 3498.5 samples/s | 54.7 steps/s
[Step=6250 Epoch=59.6] | Loss=0.00166 | Reg=0.00215 | acc=1.0000 | FP-Norm=1.437 | FP-Norm(final)=2.574 | 1662.1 samples/s | 26.0 steps/s
[Step=6300 Epoch=60.0] | Loss=0.00155 | Reg=0.00208 | acc=1.0000 | FP-Norm=1.412 | FP-Norm(final)=2.575 | 3541.7 samples/s | 55.3 steps/s
[Step=6350 Epoch=60.5] | Loss=0.00145 | Reg=0.00201 | acc=1.0000 | FP-Norm=1.388 | FP-Norm(final)=2.576 | 1681.0 samples/s | 26.3 steps/s
[Step=6400 Epoch=61.0] | Loss=0.00136 | Reg=0.00195 | acc=1.0000 | FP-Norm=1.365 | FP-Norm(final)=2.577 | 3567.8 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31264 | acc=0.7867 | tpr=0.6997 | fpr=0.0243 | 3403.5 samples/s | 13.3 steps/s
Avg test loss: 0.32188, Avg test acc: 0.78528, Avg tpr: 0.69797, Avg fpr: 0.02269, total FA: 177

Testing server on iccad2012
[Step=  50] | Loss=0.41418 | acc=0.8063 | tpr=0.9602 | fpr=0.1965 | 3620.1 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.41971 | acc=0.8044 | tpr=0.9680 | fpr=0.1986 | 6184.7 samples/s | 24.2 steps/s
[Step= 150] | Loss=0.42301 | acc=0.8030 | tpr=0.9712 | fpr=0.2001 | 6491.5 samples/s | 25.4 steps/s
[Step= 200] | Loss=0.42373 | acc=0.8020 | tpr=0.9727 | fpr=0.2011 | 6694.5 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.42416 | acc=0.8024 | tpr=0.9721 | fpr=0.2007 | 6702.3 samples/s | 26.2 steps/s
[Step= 300] | Loss=0.42495 | acc=0.8021 | tpr=0.9724 | fpr=0.2010 | 6109.2 samples/s | 23.9 steps/s
[Step= 350] | Loss=0.42584 | acc=0.8031 | tpr=0.9712 | fpr=0.1999 | 6252.1 samples/s | 24.4 steps/s
[Step= 400] | Loss=0.42623 | acc=0.8028 | tpr=0.9737 | fpr=0.2003 | 6268.2 samples/s | 24.5 steps/s
[Step= 450] | Loss=0.42927 | acc=0.8022 | tpr=0.9747 | fpr=0.2009 | 6421.6 samples/s | 25.1 steps/s
[Step= 500] | Loss=0.43018 | acc=0.8016 | tpr=0.9753 | fpr=0.2015 | 6450.7 samples/s | 25.2 steps/s
[Step= 550] | Loss=0.42847 | acc=0.8023 | tpr=0.9749 | fpr=0.2008 | 12286.9 samples/s | 48.0 steps/s
Avg test loss: 0.42872, Avg test acc: 0.80219, Avg tpr: 0.97504, Avg fpr: 0.20095, total FA: 27902

server round 14/50

clients selected: [1 3 5 6 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.22069 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.578 | 3393.1 samples/s | 53.0 steps/s
[Step=5650 Epoch=27.6] | Loss=0.05574 | Reg=0.00079 | acc=0.9531 | FP-Norm=0.854 | FP-Norm(final)=2.559 | 3581.7 samples/s | 56.0 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04634 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.963 | FP-Norm(final)=2.556 | 3679.4 samples/s | 57.5 steps/s
[Step=5750 Epoch=28.1] | Loss=0.04357 | Reg=0.00110 | acc=0.9688 | FP-Norm=1.029 | FP-Norm(final)=2.556 | 3720.2 samples/s | 58.1 steps/s
[Step=5800 Epoch=28.3] | Loss=0.03945 | Reg=0.00120 | acc=0.9688 | FP-Norm=1.080 | FP-Norm(final)=2.557 | 4755.3 samples/s | 74.3 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03505 | Reg=0.00129 | acc=1.0000 | FP-Norm=1.119 | FP-Norm(final)=2.560 | 1536.7 samples/s | 24.0 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03186 | Reg=0.00135 | acc=0.9844 | FP-Norm=1.147 | FP-Norm(final)=2.565 | 3718.6 samples/s | 58.1 steps/s
[Step=5950 Epoch=29.0] | Loss=0.02902 | Reg=0.00140 | acc=0.9531 | FP-Norm=1.170 | FP-Norm(final)=2.570 | 3675.3 samples/s | 57.4 steps/s
[Step=6000 Epoch=29.3] | Loss=0.02811 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.189 | FP-Norm(final)=2.574 | 4477.4 samples/s | 70.0 steps/s
[Step=6050 Epoch=29.5] | Loss=0.02645 | Reg=0.00149 | acc=1.0000 | FP-Norm=1.210 | FP-Norm(final)=2.577 | 1566.0 samples/s | 24.5 steps/s
[Step=6100 Epoch=29.8] | Loss=0.02493 | Reg=0.00154 | acc=0.9531 | FP-Norm=1.228 | FP-Norm(final)=2.581 | 3598.1 samples/s | 56.2 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02417 | Reg=0.00159 | acc=0.9844 | FP-Norm=1.247 | FP-Norm(final)=2.585 | 3677.1 samples/s | 57.5 steps/s
[Step=6200 Epoch=30.3] | Loss=0.02313 | Reg=0.00163 | acc=0.9688 | FP-Norm=1.263 | FP-Norm(final)=2.588 | 4324.3 samples/s | 67.6 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02216 | Reg=0.00166 | acc=0.9688 | FP-Norm=1.277 | FP-Norm(final)=2.592 | 1620.6 samples/s | 25.3 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02117 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.288 | FP-Norm(final)=2.595 | 3679.0 samples/s | 57.5 steps/s
[Step=6350 Epoch=31.0] | Loss=0.02046 | Reg=0.00171 | acc=0.9844 | FP-Norm=1.298 | FP-Norm(final)=2.599 | 3669.5 samples/s | 57.3 steps/s
[Step=6400 Epoch=31.2] | Loss=0.01991 | Reg=0.00174 | acc=0.9844 | FP-Norm=1.308 | FP-Norm(final)=2.602 | 4003.5 samples/s | 62.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step6400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=31.2] | Loss=0.28544 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.578 | 3529.8 samples/s | 55.2 steps/s
[Step=6450 Epoch=31.5] | Loss=0.05314 | Reg=0.00117 | acc=0.9844 | FP-Norm=1.036 | FP-Norm(final)=2.564 | 3524.2 samples/s | 55.1 steps/s
[Step=6500 Epoch=31.7] | Loss=0.04350 | Reg=0.00135 | acc=0.9688 | FP-Norm=1.135 | FP-Norm(final)=2.566 | 3686.7 samples/s | 57.6 steps/s
[Step=6550 Epoch=31.9] | Loss=0.03952 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.175 | FP-Norm(final)=2.568 | 3721.7 samples/s | 58.2 steps/s
[Step=6600 Epoch=32.2] | Loss=0.03860 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.210 | FP-Norm(final)=2.568 | 4727.2 samples/s | 73.9 steps/s
[Step=6650 Epoch=32.4] | Loss=0.03706 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.269 | FP-Norm(final)=2.570 | 1562.3 samples/s | 24.4 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03471 | Reg=0.00181 | acc=0.9688 | FP-Norm=1.325 | FP-Norm(final)=2.571 | 3706.4 samples/s | 57.9 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03231 | Reg=0.00191 | acc=0.9844 | FP-Norm=1.361 | FP-Norm(final)=2.574 | 3660.7 samples/s | 57.2 steps/s
[Step=6800 Epoch=33.2] | Loss=0.03064 | Reg=0.00198 | acc=0.9844 | FP-Norm=1.388 | FP-Norm(final)=2.576 | 4481.0 samples/s | 70.0 steps/s
[Step=6850 Epoch=33.4] | Loss=0.02870 | Reg=0.00204 | acc=0.9844 | FP-Norm=1.410 | FP-Norm(final)=2.578 | 1592.4 samples/s | 24.9 steps/s
[Step=6900 Epoch=33.6] | Loss=0.02700 | Reg=0.00208 | acc=1.0000 | FP-Norm=1.425 | FP-Norm(final)=2.581 | 3636.0 samples/s | 56.8 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02584 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.437 | FP-Norm(final)=2.584 | 3652.4 samples/s | 57.1 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02479 | Reg=0.00214 | acc=1.0000 | FP-Norm=1.447 | FP-Norm(final)=2.586 | 4213.8 samples/s | 65.8 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02520 | Reg=0.00219 | acc=1.0000 | FP-Norm=1.466 | FP-Norm(final)=2.588 | 1612.1 samples/s | 25.2 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02414 | Reg=0.00227 | acc=1.0000 | FP-Norm=1.490 | FP-Norm(final)=2.589 | 3667.7 samples/s | 57.3 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02329 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.507 | FP-Norm(final)=2.590 | 3603.7 samples/s | 56.3 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02290 | Reg=0.00236 | acc=1.0000 | FP-Norm=1.522 | FP-Norm(final)=2.592 | 3873.8 samples/s | 60.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step7200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=83.4] | Loss=0.15928 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.578 | 3747.9 samples/s | 58.6 steps/s
[Step=8850 Epoch=83.9] | Loss=0.01608 | Reg=0.00257 | acc=1.0000 | FP-Norm=1.523 | FP-Norm(final)=2.560 | 3102.9 samples/s | 48.5 steps/s
[Step=8900 Epoch=84.3] | Loss=0.00903 | Reg=0.00285 | acc=1.0000 | FP-Norm=1.645 | FP-Norm(final)=2.563 | 4476.1 samples/s | 69.9 steps/s
[Step=8950 Epoch=84.8] | Loss=0.00620 | Reg=0.00279 | acc=1.0000 | FP-Norm=1.640 | FP-Norm(final)=2.569 | 1466.2 samples/s | 22.9 steps/s
[Step=9000 Epoch=85.3] | Loss=0.00471 | Reg=0.00266 | acc=1.0000 | FP-Norm=1.609 | FP-Norm(final)=2.573 | 4125.0 samples/s | 64.5 steps/s
[Step=9050 Epoch=85.8] | Loss=0.00378 | Reg=0.00253 | acc=1.0000 | FP-Norm=1.571 | FP-Norm(final)=2.577 | 1449.3 samples/s | 22.6 steps/s
[Step=9100 Epoch=86.2] | Loss=0.00316 | Reg=0.00241 | acc=1.0000 | FP-Norm=1.533 | FP-Norm(final)=2.580 | 3723.4 samples/s | 58.2 steps/s
[Step=9150 Epoch=86.7] | Loss=0.00272 | Reg=0.00230 | acc=1.0000 | FP-Norm=1.498 | FP-Norm(final)=2.582 | 1506.0 samples/s | 23.5 steps/s
[Step=9200 Epoch=87.2] | Loss=0.00239 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.464 | FP-Norm(final)=2.584 | 3608.3 samples/s | 56.4 steps/s
[Step=9250 Epoch=87.7] | Loss=0.00213 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.432 | FP-Norm(final)=2.586 | 1577.1 samples/s | 24.6 steps/s
[Step=9300 Epoch=88.1] | Loss=0.00192 | Reg=0.00203 | acc=1.0000 | FP-Norm=1.402 | FP-Norm(final)=2.588 | 3526.9 samples/s | 55.1 steps/s
[Step=9350 Epoch=88.6] | Loss=0.00175 | Reg=0.00196 | acc=1.0000 | FP-Norm=1.374 | FP-Norm(final)=2.589 | 1558.9 samples/s | 24.4 steps/s
[Step=9400 Epoch=89.1] | Loss=0.00161 | Reg=0.00189 | acc=1.0000 | FP-Norm=1.348 | FP-Norm(final)=2.591 | 3327.3 samples/s | 52.0 steps/s
[Step=9450 Epoch=89.5] | Loss=0.00149 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.323 | FP-Norm(final)=2.592 | 1613.7 samples/s | 25.2 steps/s
[Step=9500 Epoch=90.0] | Loss=0.00139 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.299 | FP-Norm(final)=2.593 | 3609.6 samples/s | 56.4 steps/s
[Step=9550 Epoch=90.5] | Loss=0.00130 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.276 | FP-Norm(final)=2.594 | 1661.3 samples/s | 26.0 steps/s
[Step=9600 Epoch=91.0] | Loss=0.00122 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.254 | FP-Norm(final)=2.595 | 3520.7 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step9600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=2401 Epoch=22.8] | Loss=0.12276 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.578 | 3428.7 samples/s | 53.6 steps/s
[Step=2450 Epoch=23.3] | Loss=0.01690 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.308 | FP-Norm(final)=2.562 | 3000.3 samples/s | 46.9 steps/s
[Step=2500 Epoch=23.8] | Loss=0.01124 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.493 | FP-Norm(final)=2.563 | 4569.2 samples/s | 71.4 steps/s
[Step=2550 Epoch=24.3] | Loss=0.00759 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.541 | FP-Norm(final)=2.564 | 1500.0 samples/s | 23.4 steps/s
[Step=2600 Epoch=24.7] | Loss=0.00572 | Reg=0.00244 | acc=1.0000 | FP-Norm=1.538 | FP-Norm(final)=2.566 | 4113.6 samples/s | 64.3 steps/s
[Step=2650 Epoch=25.2] | Loss=0.00459 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.521 | FP-Norm(final)=2.568 | 1483.3 samples/s | 23.2 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00384 | Reg=0.00230 | acc=1.0000 | FP-Norm=1.499 | FP-Norm(final)=2.569 | 3825.8 samples/s | 59.8 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00330 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.474 | FP-Norm(final)=2.571 | 1538.0 samples/s | 24.0 steps/s
[Step=2800 Epoch=26.6] | Loss=0.00289 | Reg=0.00215 | acc=1.0000 | FP-Norm=1.450 | FP-Norm(final)=2.572 | 3688.4 samples/s | 57.6 steps/s
[Step=2850 Epoch=27.1] | Loss=0.00258 | Reg=0.00208 | acc=1.0000 | FP-Norm=1.426 | FP-Norm(final)=2.573 | 1608.5 samples/s | 25.1 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00233 | Reg=0.00202 | acc=1.0000 | FP-Norm=1.403 | FP-Norm(final)=2.574 | 3639.3 samples/s | 56.9 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00212 | Reg=0.00195 | acc=1.0000 | FP-Norm=1.381 | FP-Norm(final)=2.575 | 1669.2 samples/s | 26.1 steps/s
[Step=3000 Epoch=28.5] | Loss=0.00195 | Reg=0.00190 | acc=1.0000 | FP-Norm=1.359 | FP-Norm(final)=2.576 | 3480.1 samples/s | 54.4 steps/s
[Step=3050 Epoch=29.0] | Loss=0.00180 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.338 | FP-Norm(final)=2.577 | 1663.5 samples/s | 26.0 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00168 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.319 | FP-Norm(final)=2.579 | 3460.4 samples/s | 54.1 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00157 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.300 | FP-Norm(final)=2.580 | 1677.9 samples/s | 26.2 steps/s
[Step=3200 Epoch=30.4] | Loss=0.00148 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.282 | FP-Norm(final)=2.581 | 3473.3 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step3200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=60.3] | Loss=0.11410 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.578 | 3542.8 samples/s | 55.4 steps/s
[Step=6450 Epoch=60.8] | Loss=0.01369 | Reg=0.00241 | acc=1.0000 | FP-Norm=1.476 | FP-Norm(final)=2.566 | 3227.5 samples/s | 50.4 steps/s
[Step=6500 Epoch=61.2] | Loss=0.00866 | Reg=0.00283 | acc=1.0000 | FP-Norm=1.639 | FP-Norm(final)=2.566 | 4513.5 samples/s | 70.5 steps/s
[Step=6550 Epoch=61.7] | Loss=0.00593 | Reg=0.00287 | acc=1.0000 | FP-Norm=1.665 | FP-Norm(final)=2.567 | 1520.7 samples/s | 23.8 steps/s
[Step=6600 Epoch=62.2] | Loss=0.00449 | Reg=0.00279 | acc=1.0000 | FP-Norm=1.649 | FP-Norm(final)=2.570 | 4161.0 samples/s | 65.0 steps/s
[Step=6650 Epoch=62.7] | Loss=0.00360 | Reg=0.00269 | acc=1.0000 | FP-Norm=1.620 | FP-Norm(final)=2.572 | 1550.7 samples/s | 24.2 steps/s
[Step=6700 Epoch=63.1] | Loss=0.00301 | Reg=0.00258 | acc=1.0000 | FP-Norm=1.589 | FP-Norm(final)=2.574 | 3848.4 samples/s | 60.1 steps/s
[Step=6750 Epoch=63.6] | Loss=0.00259 | Reg=0.00248 | acc=1.0000 | FP-Norm=1.556 | FP-Norm(final)=2.576 | 1617.1 samples/s | 25.3 steps/s
[Step=6800 Epoch=64.1] | Loss=0.00227 | Reg=0.00238 | acc=1.0000 | FP-Norm=1.525 | FP-Norm(final)=2.578 | 3646.3 samples/s | 57.0 steps/s
[Step=6850 Epoch=64.5] | Loss=0.00202 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.495 | FP-Norm(final)=2.579 | 1623.3 samples/s | 25.4 steps/s
[Step=6900 Epoch=65.0] | Loss=0.00183 | Reg=0.00221 | acc=1.0000 | FP-Norm=1.467 | FP-Norm(final)=2.581 | 3487.7 samples/s | 54.5 steps/s
[Step=6950 Epoch=65.5] | Loss=0.00167 | Reg=0.00213 | acc=1.0000 | FP-Norm=1.440 | FP-Norm(final)=2.582 | 1663.0 samples/s | 26.0 steps/s
[Step=7000 Epoch=66.0] | Loss=0.00153 | Reg=0.00206 | acc=1.0000 | FP-Norm=1.414 | FP-Norm(final)=2.583 | 3569.4 samples/s | 55.8 steps/s
[Step=7050 Epoch=66.4] | Loss=0.00141 | Reg=0.00199 | acc=1.0000 | FP-Norm=1.389 | FP-Norm(final)=2.584 | 1683.0 samples/s | 26.3 steps/s
[Step=7100 Epoch=66.9] | Loss=0.00132 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.364 | FP-Norm(final)=2.585 | 3503.8 samples/s | 54.7 steps/s
[Step=7150 Epoch=67.4] | Loss=0.00123 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.342 | FP-Norm(final)=2.586 | 1784.9 samples/s | 27.9 steps/s
[Step=7200 Epoch=67.8] | Loss=0.00116 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.320 | FP-Norm(final)=2.587 | 3127.5 samples/s | 48.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29594 | acc=0.7963 | tpr=0.7131 | fpr=0.0230 | 3454.3 samples/s | 13.5 steps/s
Avg test loss: 0.30494, Avg test acc: 0.79518, Avg tpr: 0.71236, Avg fpr: 0.02269, total FA: 177

Testing server on iccad2012
[Step=  50] | Loss=0.42753 | acc=0.8010 | tpr=0.9602 | fpr=0.2018 | 3477.9 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.43321 | acc=0.7988 | tpr=0.9701 | fpr=0.2044 | 6548.4 samples/s | 25.6 steps/s
[Step= 150] | Loss=0.43609 | acc=0.7983 | tpr=0.9726 | fpr=0.2050 | 6478.5 samples/s | 25.3 steps/s
[Step= 200] | Loss=0.43640 | acc=0.7978 | tpr=0.9727 | fpr=0.2054 | 6667.6 samples/s | 26.0 steps/s
[Step= 250] | Loss=0.43671 | acc=0.7978 | tpr=0.9729 | fpr=0.2054 | 6629.1 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.43749 | acc=0.7978 | tpr=0.9731 | fpr=0.2054 | 6172.3 samples/s | 24.1 steps/s
[Step= 350] | Loss=0.43854 | acc=0.7985 | tpr=0.9731 | fpr=0.2047 | 6385.9 samples/s | 24.9 steps/s
[Step= 400] | Loss=0.43901 | acc=0.7981 | tpr=0.9754 | fpr=0.2051 | 6601.4 samples/s | 25.8 steps/s
[Step= 450] | Loss=0.44223 | acc=0.7976 | tpr=0.9757 | fpr=0.2057 | 6284.4 samples/s | 24.5 steps/s
[Step= 500] | Loss=0.44312 | acc=0.7971 | tpr=0.9749 | fpr=0.2061 | 6175.3 samples/s | 24.1 steps/s
[Step= 550] | Loss=0.44130 | acc=0.7979 | tpr=0.9753 | fpr=0.2054 | 11851.8 samples/s | 46.3 steps/s
Avg test loss: 0.44155, Avg test acc: 0.79775, Avg tpr: 0.97544, Avg fpr: 0.20548, total FA: 28530

server round 15/50

clients selected: [1 2 4 7 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=31.2] | Loss=0.28869 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.601 | 3503.6 samples/s | 54.7 steps/s
[Step=6450 Epoch=31.5] | Loss=0.05307 | Reg=0.00112 | acc=0.9375 | FP-Norm=1.014 | FP-Norm(final)=2.579 | 3451.2 samples/s | 53.9 steps/s
[Step=6500 Epoch=31.7] | Loss=0.04548 | Reg=0.00129 | acc=0.9844 | FP-Norm=1.113 | FP-Norm(final)=2.574 | 3639.4 samples/s | 56.9 steps/s
[Step=6550 Epoch=32.0] | Loss=0.04030 | Reg=0.00140 | acc=0.9531 | FP-Norm=1.164 | FP-Norm(final)=2.573 | 3636.0 samples/s | 56.8 steps/s
[Step=6600 Epoch=32.2] | Loss=0.03838 | Reg=0.00150 | acc=0.9688 | FP-Norm=1.210 | FP-Norm(final)=2.573 | 4667.3 samples/s | 72.9 steps/s
[Step=6650 Epoch=32.4] | Loss=0.03401 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.245 | FP-Norm(final)=2.575 | 1544.3 samples/s | 24.1 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03105 | Reg=0.00163 | acc=0.9844 | FP-Norm=1.264 | FP-Norm(final)=2.578 | 3674.7 samples/s | 57.4 steps/s
[Step=6750 Epoch=32.9] | Loss=0.02894 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.278 | FP-Norm(final)=2.582 | 3659.0 samples/s | 57.2 steps/s
[Step=6800 Epoch=33.2] | Loss=0.02794 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.291 | FP-Norm(final)=2.585 | 4461.2 samples/s | 69.7 steps/s
[Step=6850 Epoch=33.4] | Loss=0.02643 | Reg=0.00173 | acc=0.9844 | FP-Norm=1.305 | FP-Norm(final)=2.587 | 1582.1 samples/s | 24.7 steps/s
[Step=6900 Epoch=33.7] | Loss=0.02462 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.314 | FP-Norm(final)=2.590 | 3673.4 samples/s | 57.4 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02357 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.322 | FP-Norm(final)=2.593 | 3714.0 samples/s | 58.0 steps/s
[Step=7000 Epoch=34.2] | Loss=0.02259 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.329 | FP-Norm(final)=2.596 | 4272.2 samples/s | 66.8 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02168 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.335 | FP-Norm(final)=2.599 | 1601.8 samples/s | 25.0 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02089 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.342 | FP-Norm(final)=2.603 | 3614.6 samples/s | 56.5 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02026 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.349 | FP-Norm(final)=2.606 | 3619.8 samples/s | 56.6 steps/s
[Step=7200 Epoch=35.1] | Loss=0.01976 | Reg=0.00186 | acc=0.9688 | FP-Norm=1.356 | FP-Norm(final)=2.609 | 4032.7 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step7200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=35.1] | Loss=0.09991 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.602 | 3592.5 samples/s | 56.1 steps/s
[Step=7250 Epoch=35.3] | Loss=0.05811 | Reg=0.00105 | acc=0.9531 | FP-Norm=0.976 | FP-Norm(final)=2.582 | 3348.8 samples/s | 52.3 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04814 | Reg=0.00127 | acc=0.9531 | FP-Norm=1.100 | FP-Norm(final)=2.576 | 3638.7 samples/s | 56.9 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04387 | Reg=0.00141 | acc=0.9688 | FP-Norm=1.167 | FP-Norm(final)=2.575 | 3635.0 samples/s | 56.8 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04015 | Reg=0.00151 | acc=0.9688 | FP-Norm=1.212 | FP-Norm(final)=2.575 | 4728.3 samples/s | 73.9 steps/s
[Step=7450 Epoch=36.3] | Loss=0.03505 | Reg=0.00158 | acc=0.9844 | FP-Norm=1.242 | FP-Norm(final)=2.577 | 1546.6 samples/s | 24.2 steps/s
[Step=7500 Epoch=36.5] | Loss=0.03244 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.260 | FP-Norm(final)=2.580 | 3618.3 samples/s | 56.5 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03080 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.276 | FP-Norm(final)=2.583 | 3695.3 samples/s | 57.7 steps/s
[Step=7600 Epoch=37.0] | Loss=0.02920 | Reg=0.00170 | acc=0.9844 | FP-Norm=1.292 | FP-Norm(final)=2.586 | 4441.2 samples/s | 69.4 steps/s
[Step=7650 Epoch=37.3] | Loss=0.02733 | Reg=0.00173 | acc=0.9844 | FP-Norm=1.305 | FP-Norm(final)=2.590 | 1577.9 samples/s | 24.7 steps/s
[Step=7700 Epoch=37.5] | Loss=0.02562 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.316 | FP-Norm(final)=2.593 | 3663.5 samples/s | 57.2 steps/s
[Step=7750 Epoch=37.8] | Loss=0.02469 | Reg=0.00178 | acc=0.9844 | FP-Norm=1.325 | FP-Norm(final)=2.597 | 3690.9 samples/s | 57.7 steps/s
[Step=7800 Epoch=38.0] | Loss=0.02389 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.335 | FP-Norm(final)=2.600 | 4104.0 samples/s | 64.1 steps/s
[Step=7850 Epoch=38.2] | Loss=0.02304 | Reg=0.00183 | acc=0.9844 | FP-Norm=1.345 | FP-Norm(final)=2.603 | 1598.7 samples/s | 25.0 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02210 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.355 | FP-Norm(final)=2.606 | 3684.2 samples/s | 57.6 steps/s
[Step=7950 Epoch=38.7] | Loss=0.02133 | Reg=0.00188 | acc=1.0000 | FP-Norm=1.363 | FP-Norm(final)=2.609 | 3695.5 samples/s | 57.7 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02055 | Reg=0.00190 | acc=0.9844 | FP-Norm=1.371 | FP-Norm(final)=2.612 | 3957.6 samples/s | 61.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step8000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=19.6] | Loss=0.20154 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.602 | 3580.2 samples/s | 55.9 steps/s
[Step=4050 Epoch=19.9] | Loss=0.04590 | Reg=0.00071 | acc=0.9688 | FP-Norm=0.800 | FP-Norm(final)=2.592 | 3460.9 samples/s | 54.1 steps/s
[Step=4100 Epoch=20.1] | Loss=0.04180 | Reg=0.00095 | acc=0.9531 | FP-Norm=0.947 | FP-Norm(final)=2.590 | 3640.6 samples/s | 56.9 steps/s
[Step=4150 Epoch=20.4] | Loss=0.03878 | Reg=0.00112 | acc=0.9844 | FP-Norm=1.032 | FP-Norm(final)=2.587 | 3626.7 samples/s | 56.7 steps/s
[Step=4200 Epoch=20.6] | Loss=0.03533 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.084 | FP-Norm(final)=2.588 | 4710.1 samples/s | 73.6 steps/s
[Step=4250 Epoch=20.8] | Loss=0.03075 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.120 | FP-Norm(final)=2.590 | 1524.4 samples/s | 23.8 steps/s
[Step=4300 Epoch=21.1] | Loss=0.02803 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.142 | FP-Norm(final)=2.593 | 3661.4 samples/s | 57.2 steps/s
[Step=4350 Epoch=21.3] | Loss=0.02643 | Reg=0.00138 | acc=0.9844 | FP-Norm=1.160 | FP-Norm(final)=2.596 | 3681.4 samples/s | 57.5 steps/s
[Step=4400 Epoch=21.6] | Loss=0.02512 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.178 | FP-Norm(final)=2.598 | 4619.4 samples/s | 72.2 steps/s
[Step=4450 Epoch=21.8] | Loss=0.02394 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.193 | FP-Norm(final)=2.601 | 1574.2 samples/s | 24.6 steps/s
[Step=4500 Epoch=22.1] | Loss=0.02222 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.206 | FP-Norm(final)=2.603 | 3577.9 samples/s | 55.9 steps/s
[Step=4550 Epoch=22.3] | Loss=0.02135 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.215 | FP-Norm(final)=2.605 | 3606.1 samples/s | 56.3 steps/s
[Step=4600 Epoch=22.6] | Loss=0.02037 | Reg=0.00153 | acc=0.9688 | FP-Norm=1.225 | FP-Norm(final)=2.608 | 4312.9 samples/s | 67.4 steps/s
[Step=4650 Epoch=22.8] | Loss=0.01964 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.235 | FP-Norm(final)=2.610 | 1589.5 samples/s | 24.8 steps/s
[Step=4700 Epoch=23.0] | Loss=0.01872 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.244 | FP-Norm(final)=2.612 | 3637.2 samples/s | 56.8 steps/s
[Step=4750 Epoch=23.3] | Loss=0.01815 | Reg=0.00159 | acc=0.9688 | FP-Norm=1.253 | FP-Norm(final)=2.615 | 3621.2 samples/s | 56.6 steps/s
[Step=4800 Epoch=23.5] | Loss=0.01782 | Reg=0.00162 | acc=0.9844 | FP-Norm=1.262 | FP-Norm(final)=2.618 | 4220.1 samples/s | 65.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step4800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=45.8] | Loss=0.04891 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.602 | 3567.7 samples/s | 55.7 steps/s
[Step=4850 Epoch=46.3] | Loss=0.00690 | Reg=0.00114 | acc=1.0000 | FP-Norm=0.997 | FP-Norm(final)=2.607 | 3181.0 samples/s | 49.7 steps/s
[Step=4900 Epoch=46.8] | Loss=0.00498 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.189 | FP-Norm(final)=2.612 | 4510.2 samples/s | 70.5 steps/s
[Step=4950 Epoch=47.3] | Loss=0.00385 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.295 | FP-Norm(final)=2.613 | 1484.2 samples/s | 23.2 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00292 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.332 | FP-Norm(final)=2.614 | 4181.6 samples/s | 65.3 steps/s
[Step=5050 Epoch=48.2] | Loss=0.00234 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.338 | FP-Norm(final)=2.616 | 1542.3 samples/s | 24.1 steps/s
[Step=5100 Epoch=48.7] | Loss=0.00196 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.331 | FP-Norm(final)=2.616 | 4072.9 samples/s | 63.6 steps/s
[Step=5150 Epoch=49.2] | Loss=0.00169 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.318 | FP-Norm(final)=2.617 | 1556.4 samples/s | 24.3 steps/s
[Step=5200 Epoch=49.7] | Loss=0.00148 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.302 | FP-Norm(final)=2.618 | 3914.6 samples/s | 61.2 steps/s
[Step=5250 Epoch=50.1] | Loss=0.00132 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.285 | FP-Norm(final)=2.618 | 1598.9 samples/s | 25.0 steps/s
[Step=5300 Epoch=50.6] | Loss=0.00119 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.268 | FP-Norm(final)=2.619 | 3696.2 samples/s | 57.8 steps/s
[Step=5350 Epoch=51.1] | Loss=0.00108 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.250 | FP-Norm(final)=2.619 | 1610.3 samples/s | 25.2 steps/s
[Step=5400 Epoch=51.6] | Loss=0.00100 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.233 | FP-Norm(final)=2.620 | 3603.0 samples/s | 56.3 steps/s
[Step=5450 Epoch=52.0] | Loss=0.00092 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.215 | FP-Norm(final)=2.620 | 1640.8 samples/s | 25.6 steps/s
[Step=5500 Epoch=52.5] | Loss=0.00086 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.198 | FP-Norm(final)=2.621 | 3537.7 samples/s | 55.3 steps/s
[Step=5550 Epoch=53.0] | Loss=0.00080 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.181 | FP-Norm(final)=2.621 | 1669.6 samples/s | 26.1 steps/s
[Step=5600 Epoch=53.5] | Loss=0.00075 | Reg=0.00140 | acc=1.0000 | FP-Norm=1.165 | FP-Norm(final)=2.621 | 3512.9 samples/s | 54.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step5600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=67.9] | Loss=0.04041 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.603 | 3397.2 samples/s | 53.1 steps/s
[Step=7250 Epoch=68.3] | Loss=0.01750 | Reg=0.00224 | acc=1.0000 | FP-Norm=1.412 | FP-Norm(final)=2.587 | 3314.4 samples/s | 51.8 steps/s
[Step=7300 Epoch=68.8] | Loss=0.01174 | Reg=0.00297 | acc=1.0000 | FP-Norm=1.668 | FP-Norm(final)=2.579 | 4476.6 samples/s | 69.9 steps/s
[Step=7350 Epoch=69.3] | Loss=0.00818 | Reg=0.00313 | acc=1.0000 | FP-Norm=1.730 | FP-Norm(final)=2.578 | 1499.9 samples/s | 23.4 steps/s
[Step=7400 Epoch=69.7] | Loss=0.00618 | Reg=0.00311 | acc=1.0000 | FP-Norm=1.733 | FP-Norm(final)=2.579 | 4125.3 samples/s | 64.5 steps/s
[Step=7450 Epoch=70.2] | Loss=0.00495 | Reg=0.00302 | acc=1.0000 | FP-Norm=1.715 | FP-Norm(final)=2.581 | 1543.0 samples/s | 24.1 steps/s
[Step=7500 Epoch=70.7] | Loss=0.00414 | Reg=0.00292 | acc=1.0000 | FP-Norm=1.688 | FP-Norm(final)=2.583 | 3842.7 samples/s | 60.0 steps/s
[Step=7550 Epoch=71.1] | Loss=0.00355 | Reg=0.00282 | acc=1.0000 | FP-Norm=1.660 | FP-Norm(final)=2.585 | 1598.4 samples/s | 25.0 steps/s
[Step=7600 Epoch=71.6] | Loss=0.00311 | Reg=0.00272 | acc=1.0000 | FP-Norm=1.631 | FP-Norm(final)=2.586 | 3677.7 samples/s | 57.5 steps/s
[Step=7650 Epoch=72.1] | Loss=0.00277 | Reg=0.00263 | acc=1.0000 | FP-Norm=1.603 | FP-Norm(final)=2.588 | 1643.8 samples/s | 25.7 steps/s
[Step=7700 Epoch=72.6] | Loss=0.00250 | Reg=0.00255 | acc=1.0000 | FP-Norm=1.575 | FP-Norm(final)=2.589 | 3476.7 samples/s | 54.3 steps/s
[Step=7750 Epoch=73.0] | Loss=0.00228 | Reg=0.00246 | acc=1.0000 | FP-Norm=1.549 | FP-Norm(final)=2.590 | 1652.8 samples/s | 25.8 steps/s
[Step=7800 Epoch=73.5] | Loss=0.00209 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.523 | FP-Norm(final)=2.592 | 3433.3 samples/s | 53.6 steps/s
[Step=7850 Epoch=74.0] | Loss=0.00193 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.499 | FP-Norm(final)=2.593 | 1667.9 samples/s | 26.1 steps/s
[Step=7900 Epoch=74.4] | Loss=0.00180 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.475 | FP-Norm(final)=2.594 | 3460.0 samples/s | 54.1 steps/s
[Step=7950 Epoch=74.9] | Loss=0.00168 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.453 | FP-Norm(final)=2.595 | 1771.3 samples/s | 27.7 steps/s
[Step=8000 Epoch=75.4] | Loss=0.00158 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.431 | FP-Norm(final)=2.596 | 3126.9 samples/s | 48.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26882 | acc=0.8149 | tpr=0.7390 | fpr=0.0203 | 3476.0 samples/s | 13.6 steps/s
Avg test loss: 0.27761, Avg test acc: 0.81240, Avg tpr: 0.73649, Avg fpr: 0.02064, total FA: 161

Testing server on iccad2012
[Step=  50] | Loss=0.47654 | acc=0.7801 | tpr=0.9558 | fpr=0.2231 | 3549.9 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.48154 | acc=0.7793 | tpr=0.9616 | fpr=0.2241 | 6211.6 samples/s | 24.3 steps/s
[Step= 150] | Loss=0.48498 | acc=0.7802 | tpr=0.9669 | fpr=0.2233 | 6309.0 samples/s | 24.6 steps/s
[Step= 200] | Loss=0.48511 | acc=0.7794 | tpr=0.9683 | fpr=0.2240 | 6666.3 samples/s | 26.0 steps/s
[Step= 250] | Loss=0.48546 | acc=0.7797 | tpr=0.9686 | fpr=0.2237 | 6449.5 samples/s | 25.2 steps/s
[Step= 300] | Loss=0.48614 | acc=0.7798 | tpr=0.9695 | fpr=0.2237 | 6707.0 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.48701 | acc=0.7806 | tpr=0.9699 | fpr=0.2228 | 6366.7 samples/s | 24.9 steps/s
[Step= 400] | Loss=0.48723 | acc=0.7805 | tpr=0.9721 | fpr=0.2230 | 6318.3 samples/s | 24.7 steps/s
[Step= 450] | Loss=0.49088 | acc=0.7802 | tpr=0.9727 | fpr=0.2233 | 6192.9 samples/s | 24.2 steps/s
[Step= 500] | Loss=0.49196 | acc=0.7798 | tpr=0.9722 | fpr=0.2236 | 6330.8 samples/s | 24.7 steps/s
[Step= 550] | Loss=0.48992 | acc=0.7805 | tpr=0.9725 | fpr=0.2230 | 12405.7 samples/s | 48.5 steps/s
Avg test loss: 0.49021, Avg test acc: 0.78030, Avg tpr: 0.97266, Avg fpr: 0.22319, total FA: 30990

server round 16/50

clients selected: [2 4 5 7 8]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.22629 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.624 | 3341.4 samples/s | 52.2 steps/s
[Step=8050 Epoch=39.2] | Loss=0.05146 | Reg=0.00107 | acc=1.0000 | FP-Norm=0.991 | FP-Norm(final)=2.611 | 3572.7 samples/s | 55.8 steps/s
[Step=8100 Epoch=39.5] | Loss=0.04289 | Reg=0.00129 | acc=0.9844 | FP-Norm=1.110 | FP-Norm(final)=2.606 | 3645.2 samples/s | 57.0 steps/s
[Step=8150 Epoch=39.7] | Loss=0.04194 | Reg=0.00143 | acc=0.9844 | FP-Norm=1.176 | FP-Norm(final)=2.602 | 3689.1 samples/s | 57.6 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03869 | Reg=0.00153 | acc=0.9688 | FP-Norm=1.219 | FP-Norm(final)=2.602 | 4651.2 samples/s | 72.7 steps/s
[Step=8250 Epoch=40.2] | Loss=0.03545 | Reg=0.00162 | acc=0.9688 | FP-Norm=1.257 | FP-Norm(final)=2.604 | 1562.6 samples/s | 24.4 steps/s
[Step=8300 Epoch=40.4] | Loss=0.03264 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.280 | FP-Norm(final)=2.606 | 3700.4 samples/s | 57.8 steps/s
[Step=8350 Epoch=40.7] | Loss=0.03062 | Reg=0.00172 | acc=0.9375 | FP-Norm=1.297 | FP-Norm(final)=2.609 | 3702.8 samples/s | 57.9 steps/s
[Step=8400 Epoch=40.9] | Loss=0.02891 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.311 | FP-Norm(final)=2.611 | 4462.5 samples/s | 69.7 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02711 | Reg=0.00178 | acc=0.9844 | FP-Norm=1.323 | FP-Norm(final)=2.613 | 1593.0 samples/s | 24.9 steps/s
[Step=8500 Epoch=41.4] | Loss=0.02563 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.331 | FP-Norm(final)=2.616 | 3575.3 samples/s | 55.9 steps/s
[Step=8550 Epoch=41.7] | Loss=0.02423 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.339 | FP-Norm(final)=2.619 | 3561.7 samples/s | 55.7 steps/s
[Step=8600 Epoch=41.9] | Loss=0.02344 | Reg=0.00183 | acc=1.0000 | FP-Norm=1.345 | FP-Norm(final)=2.622 | 4134.0 samples/s | 64.6 steps/s
[Step=8650 Epoch=42.1] | Loss=0.02240 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.352 | FP-Norm(final)=2.624 | 1634.7 samples/s | 25.5 steps/s
[Step=8700 Epoch=42.4] | Loss=0.02148 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.358 | FP-Norm(final)=2.626 | 3645.3 samples/s | 57.0 steps/s
[Step=8750 Epoch=42.6] | Loss=0.02083 | Reg=0.00188 | acc=0.9688 | FP-Norm=1.364 | FP-Norm(final)=2.629 | 3697.9 samples/s | 57.8 steps/s
[Step=8800 Epoch=42.9] | Loss=0.02023 | Reg=0.00189 | acc=0.9844 | FP-Norm=1.369 | FP-Norm(final)=2.631 | 3916.8 samples/s | 61.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step8800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.5] | Loss=0.14354 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.624 | 3642.4 samples/s | 56.9 steps/s
[Step=4850 Epoch=23.8] | Loss=0.04891 | Reg=0.00062 | acc=0.9688 | FP-Norm=0.743 | FP-Norm(final)=2.612 | 3384.9 samples/s | 52.9 steps/s
[Step=4900 Epoch=24.0] | Loss=0.04183 | Reg=0.00092 | acc=0.9688 | FP-Norm=0.923 | FP-Norm(final)=2.605 | 3693.5 samples/s | 57.7 steps/s
[Step=4950 Epoch=24.3] | Loss=0.03874 | Reg=0.00109 | acc=0.9688 | FP-Norm=1.013 | FP-Norm(final)=2.603 | 3666.9 samples/s | 57.3 steps/s
[Step=5000 Epoch=24.5] | Loss=0.03686 | Reg=0.00123 | acc=0.9688 | FP-Norm=1.081 | FP-Norm(final)=2.602 | 4769.4 samples/s | 74.5 steps/s
[Step=5050 Epoch=24.8] | Loss=0.03332 | Reg=0.00135 | acc=0.9844 | FP-Norm=1.137 | FP-Norm(final)=2.601 | 1528.4 samples/s | 23.9 steps/s
[Step=5100 Epoch=25.0] | Loss=0.02976 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.172 | FP-Norm(final)=2.602 | 3681.0 samples/s | 57.5 steps/s
[Step=5150 Epoch=25.3] | Loss=0.02775 | Reg=0.00149 | acc=0.9844 | FP-Norm=1.198 | FP-Norm(final)=2.605 | 3696.1 samples/s | 57.8 steps/s
[Step=5200 Epoch=25.5] | Loss=0.02598 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.221 | FP-Norm(final)=2.608 | 4571.9 samples/s | 71.4 steps/s
[Step=5250 Epoch=25.7] | Loss=0.02440 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.237 | FP-Norm(final)=2.611 | 1566.0 samples/s | 24.5 steps/s
[Step=5300 Epoch=26.0] | Loss=0.02322 | Reg=0.00161 | acc=0.9844 | FP-Norm=1.250 | FP-Norm(final)=2.614 | 3699.2 samples/s | 57.8 steps/s
[Step=5350 Epoch=26.2] | Loss=0.02188 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.261 | FP-Norm(final)=2.617 | 3669.6 samples/s | 57.3 steps/s
[Step=5400 Epoch=26.5] | Loss=0.02073 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.270 | FP-Norm(final)=2.619 | 4459.5 samples/s | 69.7 steps/s
[Step=5450 Epoch=26.7] | Loss=0.01947 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.277 | FP-Norm(final)=2.623 | 1592.8 samples/s | 24.9 steps/s
[Step=5500 Epoch=27.0] | Loss=0.01856 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.283 | FP-Norm(final)=2.626 | 3665.5 samples/s | 57.3 steps/s
[Step=5550 Epoch=27.2] | Loss=0.01791 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.289 | FP-Norm(final)=2.629 | 3696.8 samples/s | 57.8 steps/s
[Step=5600 Epoch=27.5] | Loss=0.01746 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.296 | FP-Norm(final)=2.632 | 4238.9 samples/s | 66.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step5600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.0] | Loss=0.11129 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.624 | 3376.3 samples/s | 52.8 steps/s
[Step=9650 Epoch=91.4] | Loss=0.01806 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.396 | FP-Norm(final)=2.609 | 3304.1 samples/s | 51.6 steps/s
[Step=9700 Epoch=91.9] | Loss=0.01116 | Reg=0.00294 | acc=0.9844 | FP-Norm=1.660 | FP-Norm(final)=2.601 | 4508.9 samples/s | 70.5 steps/s
[Step=9750 Epoch=92.4] | Loss=0.00773 | Reg=0.00305 | acc=1.0000 | FP-Norm=1.709 | FP-Norm(final)=2.600 | 1501.7 samples/s | 23.5 steps/s
[Step=9800 Epoch=92.9] | Loss=0.00584 | Reg=0.00300 | acc=1.0000 | FP-Norm=1.703 | FP-Norm(final)=2.602 | 4214.2 samples/s | 65.8 steps/s
[Step=9850 Epoch=93.3] | Loss=0.00468 | Reg=0.00290 | acc=1.0000 | FP-Norm=1.681 | FP-Norm(final)=2.604 | 1518.8 samples/s | 23.7 steps/s
[Step=9900 Epoch=93.8] | Loss=0.00391 | Reg=0.00280 | acc=1.0000 | FP-Norm=1.652 | FP-Norm(final)=2.606 | 3930.8 samples/s | 61.4 steps/s
[Step=9950 Epoch=94.3] | Loss=0.00336 | Reg=0.00270 | acc=1.0000 | FP-Norm=1.623 | FP-Norm(final)=2.608 | 1569.0 samples/s | 24.5 steps/s
[Step=10000 Epoch=94.8] | Loss=0.00295 | Reg=0.00261 | acc=1.0000 | FP-Norm=1.595 | FP-Norm(final)=2.609 | 3698.1 samples/s | 57.8 steps/s
[Step=10050 Epoch=95.2] | Loss=0.00262 | Reg=0.00252 | acc=1.0000 | FP-Norm=1.567 | FP-Norm(final)=2.611 | 1598.8 samples/s | 25.0 steps/s
[Step=10100 Epoch=95.7] | Loss=0.00237 | Reg=0.00244 | acc=1.0000 | FP-Norm=1.541 | FP-Norm(final)=2.612 | 3574.8 samples/s | 55.9 steps/s
[Step=10150 Epoch=96.2] | Loss=0.00216 | Reg=0.00236 | acc=1.0000 | FP-Norm=1.515 | FP-Norm(final)=2.614 | 1652.6 samples/s | 25.8 steps/s
[Step=10200 Epoch=96.7] | Loss=0.00198 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.491 | FP-Norm(final)=2.615 | 3487.5 samples/s | 54.5 steps/s
[Step=10250 Epoch=97.1] | Loss=0.00183 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.467 | FP-Norm(final)=2.617 | 1663.6 samples/s | 26.0 steps/s
[Step=10300 Epoch=97.6] | Loss=0.00170 | Reg=0.00215 | acc=1.0000 | FP-Norm=1.445 | FP-Norm(final)=2.618 | 3459.8 samples/s | 54.1 steps/s
[Step=10350 Epoch=98.1] | Loss=0.00159 | Reg=0.00209 | acc=1.0000 | FP-Norm=1.423 | FP-Norm(final)=2.619 | 1658.3 samples/s | 25.9 steps/s
[Step=10400 Epoch=98.5] | Loss=0.00149 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.402 | FP-Norm(final)=2.620 | 3520.6 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step10400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=53.5] | Loss=0.10633 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.624 | 3487.8 samples/s | 54.5 steps/s
[Step=5650 Epoch=54.0] | Loss=0.01348 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.370 | FP-Norm(final)=2.612 | 3302.0 samples/s | 51.6 steps/s
[Step=5700 Epoch=54.4] | Loss=0.00847 | Reg=0.00260 | acc=1.0000 | FP-Norm=1.565 | FP-Norm(final)=2.612 | 4590.6 samples/s | 71.7 steps/s
[Step=5750 Epoch=54.9] | Loss=0.00573 | Reg=0.00269 | acc=1.0000 | FP-Norm=1.605 | FP-Norm(final)=2.614 | 1476.6 samples/s | 23.1 steps/s
[Step=5800 Epoch=55.4] | Loss=0.00431 | Reg=0.00264 | acc=1.0000 | FP-Norm=1.599 | FP-Norm(final)=2.616 | 4281.7 samples/s | 66.9 steps/s
[Step=5850 Epoch=55.9] | Loss=0.00347 | Reg=0.00256 | acc=1.0000 | FP-Norm=1.578 | FP-Norm(final)=2.618 | 1523.5 samples/s | 23.8 steps/s
[Step=5900 Epoch=56.3] | Loss=0.00289 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.552 | FP-Norm(final)=2.619 | 4023.0 samples/s | 62.9 steps/s
[Step=5950 Epoch=56.8] | Loss=0.00249 | Reg=0.00238 | acc=1.0000 | FP-Norm=1.525 | FP-Norm(final)=2.620 | 1572.2 samples/s | 24.6 steps/s
[Step=6000 Epoch=57.3] | Loss=0.00218 | Reg=0.00230 | acc=1.0000 | FP-Norm=1.498 | FP-Norm(final)=2.621 | 3876.6 samples/s | 60.6 steps/s
[Step=6050 Epoch=57.8] | Loss=0.00194 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.471 | FP-Norm(final)=2.622 | 1550.7 samples/s | 24.2 steps/s
[Step=6100 Epoch=58.3] | Loss=0.00175 | Reg=0.00214 | acc=1.0000 | FP-Norm=1.446 | FP-Norm(final)=2.623 | 3619.2 samples/s | 56.6 steps/s
[Step=6150 Epoch=58.7] | Loss=0.00159 | Reg=0.00207 | acc=1.0000 | FP-Norm=1.421 | FP-Norm(final)=2.624 | 1610.4 samples/s | 25.2 steps/s
[Step=6200 Epoch=59.2] | Loss=0.00146 | Reg=0.00201 | acc=1.0000 | FP-Norm=1.398 | FP-Norm(final)=2.625 | 3573.4 samples/s | 55.8 steps/s
[Step=6250 Epoch=59.7] | Loss=0.00135 | Reg=0.00195 | acc=1.0000 | FP-Norm=1.375 | FP-Norm(final)=2.626 | 1654.9 samples/s | 25.9 steps/s
[Step=6300 Epoch=60.2] | Loss=0.00126 | Reg=0.00189 | acc=1.0000 | FP-Norm=1.353 | FP-Norm(final)=2.626 | 3433.3 samples/s | 53.6 steps/s
[Step=6350 Epoch=60.6] | Loss=0.00118 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.331 | FP-Norm(final)=2.627 | 1589.5 samples/s | 24.8 steps/s
[Step=6400 Epoch=61.1] | Loss=0.00110 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.311 | FP-Norm(final)=2.628 | 3470.0 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step6400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=75.4] | Loss=0.15405 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.624 | 3646.3 samples/s | 57.0 steps/s
[Step=8050 Epoch=75.9] | Loss=0.01489 | Reg=0.00296 | acc=0.9844 | FP-Norm=1.643 | FP-Norm(final)=2.606 | 3146.2 samples/s | 49.2 steps/s
[Step=8100 Epoch=76.3] | Loss=0.00824 | Reg=0.00321 | acc=0.9844 | FP-Norm=1.750 | FP-Norm(final)=2.607 | 4515.5 samples/s | 70.6 steps/s
[Step=8150 Epoch=76.8] | Loss=0.00669 | Reg=0.00323 | acc=1.0000 | FP-Norm=1.771 | FP-Norm(final)=2.610 | 1505.9 samples/s | 23.5 steps/s
[Step=8200 Epoch=77.3] | Loss=0.00506 | Reg=0.00319 | acc=1.0000 | FP-Norm=1.767 | FP-Norm(final)=2.613 | 4128.5 samples/s | 64.5 steps/s
[Step=8250 Epoch=77.7] | Loss=0.00407 | Reg=0.00309 | acc=1.0000 | FP-Norm=1.741 | FP-Norm(final)=2.617 | 1503.4 samples/s | 23.5 steps/s
[Step=8300 Epoch=78.2] | Loss=0.00340 | Reg=0.00298 | acc=1.0000 | FP-Norm=1.710 | FP-Norm(final)=2.619 | 3913.3 samples/s | 61.1 steps/s
[Step=8350 Epoch=78.7] | Loss=0.00292 | Reg=0.00287 | acc=1.0000 | FP-Norm=1.678 | FP-Norm(final)=2.621 | 1562.1 samples/s | 24.4 steps/s
[Step=8400 Epoch=79.2] | Loss=0.00256 | Reg=0.00277 | acc=1.0000 | FP-Norm=1.647 | FP-Norm(final)=2.623 | 3659.8 samples/s | 57.2 steps/s
[Step=8450 Epoch=79.6] | Loss=0.00228 | Reg=0.00267 | acc=1.0000 | FP-Norm=1.616 | FP-Norm(final)=2.625 | 1632.7 samples/s | 25.5 steps/s
[Step=8500 Epoch=80.1] | Loss=0.00206 | Reg=0.00258 | acc=1.0000 | FP-Norm=1.587 | FP-Norm(final)=2.626 | 3510.1 samples/s | 54.8 steps/s
[Step=8550 Epoch=80.6] | Loss=0.00188 | Reg=0.00249 | acc=1.0000 | FP-Norm=1.559 | FP-Norm(final)=2.627 | 1642.2 samples/s | 25.7 steps/s
[Step=8600 Epoch=81.0] | Loss=0.00172 | Reg=0.00241 | acc=1.0000 | FP-Norm=1.533 | FP-Norm(final)=2.629 | 3549.0 samples/s | 55.5 steps/s
[Step=8650 Epoch=81.5] | Loss=0.00159 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.507 | FP-Norm(final)=2.630 | 1675.5 samples/s | 26.2 steps/s
[Step=8700 Epoch=82.0] | Loss=0.00148 | Reg=0.00227 | acc=1.0000 | FP-Norm=1.483 | FP-Norm(final)=2.631 | 3465.1 samples/s | 54.1 steps/s
[Step=8750 Epoch=82.4] | Loss=0.00139 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.459 | FP-Norm(final)=2.632 | 1747.6 samples/s | 27.3 steps/s
[Step=8800 Epoch=82.9] | Loss=0.00130 | Reg=0.00214 | acc=1.0000 | FP-Norm=1.437 | FP-Norm(final)=2.633 | 3280.8 samples/s | 51.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27755 | acc=0.8084 | tpr=0.7300 | fpr=0.0216 | 3419.6 samples/s | 13.4 steps/s
Avg test loss: 0.28538, Avg test acc: 0.80595, Avg tpr: 0.72734, Avg fpr: 0.02115, total FA: 165

Testing server on iccad2012
[Step=  50] | Loss=0.48016 | acc=0.7845 | tpr=0.9646 | fpr=0.2187 | 3507.7 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.48514 | acc=0.7833 | tpr=0.9701 | fpr=0.2202 | 6469.1 samples/s | 25.3 steps/s
[Step= 150] | Loss=0.48966 | acc=0.7829 | tpr=0.9741 | fpr=0.2207 | 5938.8 samples/s | 23.2 steps/s
[Step= 200] | Loss=0.48944 | acc=0.7827 | tpr=0.9760 | fpr=0.2209 | 6544.2 samples/s | 25.6 steps/s
[Step= 250] | Loss=0.48986 | acc=0.7828 | tpr=0.9755 | fpr=0.2207 | 6300.2 samples/s | 24.6 steps/s
[Step= 300] | Loss=0.49089 | acc=0.7829 | tpr=0.9745 | fpr=0.2206 | 4348.6 samples/s | 17.0 steps/s
[Step= 350] | Loss=0.49189 | acc=0.7836 | tpr=0.9743 | fpr=0.2198 | 6357.9 samples/s | 24.8 steps/s
[Step= 400] | Loss=0.49208 | acc=0.7834 | tpr=0.9765 | fpr=0.2201 | 6495.1 samples/s | 25.4 steps/s
[Step= 450] | Loss=0.49586 | acc=0.7832 | tpr=0.9766 | fpr=0.2203 | 6022.6 samples/s | 23.5 steps/s
[Step= 500] | Loss=0.49698 | acc=0.7826 | tpr=0.9771 | fpr=0.2209 | 6442.2 samples/s | 25.2 steps/s
[Step= 550] | Loss=0.49482 | acc=0.7832 | tpr=0.9769 | fpr=0.2203 | 12365.4 samples/s | 48.3 steps/s
Avg test loss: 0.49507, Avg test acc: 0.78303, Avg tpr: 0.97702, Avg fpr: 0.22050, total FA: 30616

server round 17/50

clients selected: [0 2 3 4 6]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=19.5] | Loss=0.09165 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.634 | 3718.6 samples/s | 58.1 steps/s
[Step=4050 Epoch=19.7] | Loss=0.05170 | Reg=0.00077 | acc=0.9844 | FP-Norm=0.830 | FP-Norm(final)=2.618 | 3251.9 samples/s | 50.8 steps/s
[Step=4100 Epoch=20.0] | Loss=0.04572 | Reg=0.00101 | acc=0.9375 | FP-Norm=0.976 | FP-Norm(final)=2.613 | 3630.3 samples/s | 56.7 steps/s
[Step=4150 Epoch=20.2] | Loss=0.03970 | Reg=0.00116 | acc=0.9844 | FP-Norm=1.053 | FP-Norm(final)=2.611 | 3585.4 samples/s | 56.0 steps/s
[Step=4200 Epoch=20.5] | Loss=0.03608 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.101 | FP-Norm(final)=2.612 | 4669.0 samples/s | 73.0 steps/s
[Step=4250 Epoch=20.7] | Loss=0.03228 | Reg=0.00136 | acc=0.9844 | FP-Norm=1.148 | FP-Norm(final)=2.613 | 1560.1 samples/s | 24.4 steps/s
[Step=4300 Epoch=21.0] | Loss=0.02955 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.183 | FP-Norm(final)=2.617 | 3600.6 samples/s | 56.3 steps/s
[Step=4350 Epoch=21.2] | Loss=0.02750 | Reg=0.00150 | acc=0.9844 | FP-Norm=1.207 | FP-Norm(final)=2.620 | 3655.1 samples/s | 57.1 steps/s
[Step=4400 Epoch=21.5] | Loss=0.02663 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.227 | FP-Norm(final)=2.622 | 4459.1 samples/s | 69.7 steps/s
[Step=4450 Epoch=21.7] | Loss=0.02507 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.246 | FP-Norm(final)=2.624 | 1596.5 samples/s | 24.9 steps/s
[Step=4500 Epoch=21.9] | Loss=0.02354 | Reg=0.00162 | acc=0.9844 | FP-Norm=1.259 | FP-Norm(final)=2.627 | 3673.5 samples/s | 57.4 steps/s
[Step=4550 Epoch=22.2] | Loss=0.02242 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.270 | FP-Norm(final)=2.629 | 3676.1 samples/s | 57.4 steps/s
[Step=4600 Epoch=22.4] | Loss=0.02182 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.282 | FP-Norm(final)=2.632 | 4156.7 samples/s | 64.9 steps/s
[Step=4650 Epoch=22.7] | Loss=0.02114 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.293 | FP-Norm(final)=2.634 | 1625.7 samples/s | 25.4 steps/s
[Step=4700 Epoch=22.9] | Loss=0.02027 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.303 | FP-Norm(final)=2.636 | 3543.1 samples/s | 55.4 steps/s
[Step=4750 Epoch=23.2] | Loss=0.01966 | Reg=0.00175 | acc=0.9844 | FP-Norm=1.313 | FP-Norm(final)=2.638 | 3662.9 samples/s | 57.2 steps/s
[Step=4800 Epoch=23.4] | Loss=0.01918 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.321 | FP-Norm(final)=2.640 | 3966.3 samples/s | 62.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step4800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.20906 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.634 | 3522.9 samples/s | 55.0 steps/s
[Step=8850 Epoch=43.1] | Loss=0.04963 | Reg=0.00094 | acc=0.9531 | FP-Norm=0.924 | FP-Norm(final)=2.620 | 3468.9 samples/s | 54.2 steps/s
[Step=8900 Epoch=43.4] | Loss=0.04050 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.064 | FP-Norm(final)=2.615 | 3579.9 samples/s | 55.9 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03807 | Reg=0.00131 | acc=0.9844 | FP-Norm=1.121 | FP-Norm(final)=2.615 | 3625.4 samples/s | 56.6 steps/s
[Step=9000 Epoch=43.9] | Loss=0.03678 | Reg=0.00140 | acc=0.9844 | FP-Norm=1.163 | FP-Norm(final)=2.615 | 4676.0 samples/s | 73.1 steps/s
[Step=9050 Epoch=44.1] | Loss=0.03352 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.201 | FP-Norm(final)=2.616 | 1530.5 samples/s | 23.9 steps/s
[Step=9100 Epoch=44.3] | Loss=0.03071 | Reg=0.00153 | acc=0.9688 | FP-Norm=1.223 | FP-Norm(final)=2.618 | 3621.7 samples/s | 56.6 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02837 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.240 | FP-Norm(final)=2.622 | 3696.1 samples/s | 57.8 steps/s
[Step=9200 Epoch=44.8] | Loss=0.02686 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.255 | FP-Norm(final)=2.625 | 4426.8 samples/s | 69.2 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02539 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.269 | FP-Norm(final)=2.629 | 1576.1 samples/s | 24.6 steps/s
[Step=9300 Epoch=45.3] | Loss=0.02430 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.283 | FP-Norm(final)=2.633 | 3693.5 samples/s | 57.7 steps/s
[Step=9350 Epoch=45.6] | Loss=0.02335 | Reg=0.00170 | acc=0.9688 | FP-Norm=1.294 | FP-Norm(final)=2.636 | 3678.4 samples/s | 57.5 steps/s
[Step=9400 Epoch=45.8] | Loss=0.02246 | Reg=0.00173 | acc=0.9844 | FP-Norm=1.304 | FP-Norm(final)=2.640 | 4181.8 samples/s | 65.3 steps/s
[Step=9450 Epoch=46.0] | Loss=0.02139 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.313 | FP-Norm(final)=2.643 | 1623.8 samples/s | 25.4 steps/s
[Step=9500 Epoch=46.3] | Loss=0.02066 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.320 | FP-Norm(final)=2.646 | 3664.1 samples/s | 57.3 steps/s
[Step=9550 Epoch=46.5] | Loss=0.01989 | Reg=0.00178 | acc=0.9844 | FP-Norm=1.327 | FP-Norm(final)=2.649 | 3717.2 samples/s | 58.1 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01950 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.334 | FP-Norm(final)=2.651 | 3972.6 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step9600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=35.1] | Loss=0.25928 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.634 | 3388.9 samples/s | 53.0 steps/s
[Step=7250 Epoch=35.4] | Loss=0.04911 | Reg=0.00102 | acc=0.9688 | FP-Norm=0.965 | FP-Norm(final)=2.618 | 3520.1 samples/s | 55.0 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04054 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.059 | FP-Norm(final)=2.616 | 3636.9 samples/s | 56.8 steps/s
[Step=7350 Epoch=35.8] | Loss=0.03685 | Reg=0.00126 | acc=0.9844 | FP-Norm=1.104 | FP-Norm(final)=2.617 | 3621.6 samples/s | 56.6 steps/s
[Step=7400 Epoch=36.1] | Loss=0.03446 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.136 | FP-Norm(final)=2.618 | 4600.4 samples/s | 71.9 steps/s
[Step=7450 Epoch=36.3] | Loss=0.03054 | Reg=0.00137 | acc=0.9688 | FP-Norm=1.158 | FP-Norm(final)=2.619 | 1529.5 samples/s | 23.9 steps/s
[Step=7500 Epoch=36.6] | Loss=0.02765 | Reg=0.00139 | acc=1.0000 | FP-Norm=1.171 | FP-Norm(final)=2.622 | 3661.0 samples/s | 57.2 steps/s
[Step=7550 Epoch=36.8] | Loss=0.02538 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.180 | FP-Norm(final)=2.625 | 3555.6 samples/s | 55.6 steps/s
[Step=7600 Epoch=37.1] | Loss=0.02427 | Reg=0.00144 | acc=0.9844 | FP-Norm=1.191 | FP-Norm(final)=2.628 | 4403.0 samples/s | 68.8 steps/s
[Step=7650 Epoch=37.3] | Loss=0.02279 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.200 | FP-Norm(final)=2.631 | 1615.9 samples/s | 25.2 steps/s
[Step=7700 Epoch=37.5] | Loss=0.02123 | Reg=0.00147 | acc=0.9844 | FP-Norm=1.205 | FP-Norm(final)=2.634 | 3666.8 samples/s | 57.3 steps/s
[Step=7750 Epoch=37.8] | Loss=0.02026 | Reg=0.00148 | acc=0.9844 | FP-Norm=1.209 | FP-Norm(final)=2.637 | 3679.8 samples/s | 57.5 steps/s
[Step=7800 Epoch=38.0] | Loss=0.01955 | Reg=0.00149 | acc=0.9688 | FP-Norm=1.214 | FP-Norm(final)=2.640 | 4213.8 samples/s | 65.8 steps/s
[Step=7850 Epoch=38.3] | Loss=0.01901 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.220 | FP-Norm(final)=2.642 | 1627.4 samples/s | 25.4 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01825 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.228 | FP-Norm(final)=2.645 | 3693.5 samples/s | 57.7 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01764 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.234 | FP-Norm(final)=2.647 | 3680.0 samples/s | 57.5 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01724 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.240 | FP-Norm(final)=2.649 | 3976.4 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step8000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=27.5] | Loss=0.23527 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.634 | 3708.8 samples/s | 58.0 steps/s
[Step=5650 Epoch=27.7] | Loss=0.04795 | Reg=0.00081 | acc=0.9531 | FP-Norm=0.856 | FP-Norm(final)=2.618 | 3411.7 samples/s | 53.3 steps/s
[Step=5700 Epoch=28.0] | Loss=0.04581 | Reg=0.00108 | acc=0.9688 | FP-Norm=1.009 | FP-Norm(final)=2.611 | 3668.3 samples/s | 57.3 steps/s
[Step=5750 Epoch=28.2] | Loss=0.04020 | Reg=0.00128 | acc=0.9844 | FP-Norm=1.106 | FP-Norm(final)=2.609 | 3695.7 samples/s | 57.7 steps/s
[Step=5800 Epoch=28.4] | Loss=0.03688 | Reg=0.00142 | acc=0.9844 | FP-Norm=1.166 | FP-Norm(final)=2.609 | 4752.7 samples/s | 74.3 steps/s
[Step=5850 Epoch=28.7] | Loss=0.03268 | Reg=0.00151 | acc=0.9844 | FP-Norm=1.209 | FP-Norm(final)=2.611 | 1548.7 samples/s | 24.2 steps/s
[Step=5900 Epoch=28.9] | Loss=0.03011 | Reg=0.00158 | acc=0.9844 | FP-Norm=1.238 | FP-Norm(final)=2.614 | 3691.0 samples/s | 57.7 steps/s
[Step=5950 Epoch=29.2] | Loss=0.02840 | Reg=0.00164 | acc=0.9844 | FP-Norm=1.264 | FP-Norm(final)=2.617 | 3709.7 samples/s | 58.0 steps/s
[Step=6000 Epoch=29.4] | Loss=0.02697 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.285 | FP-Norm(final)=2.619 | 4558.3 samples/s | 71.2 steps/s
[Step=6050 Epoch=29.7] | Loss=0.02591 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.302 | FP-Norm(final)=2.621 | 1559.5 samples/s | 24.4 steps/s
[Step=6100 Epoch=29.9] | Loss=0.02418 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.315 | FP-Norm(final)=2.623 | 3660.4 samples/s | 57.2 steps/s
[Step=6150 Epoch=30.2] | Loss=0.02295 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.324 | FP-Norm(final)=2.626 | 3630.4 samples/s | 56.7 steps/s
[Step=6200 Epoch=30.4] | Loss=0.02207 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.334 | FP-Norm(final)=2.629 | 4370.7 samples/s | 68.3 steps/s
[Step=6250 Epoch=30.6] | Loss=0.02114 | Reg=0.00183 | acc=1.0000 | FP-Norm=1.342 | FP-Norm(final)=2.631 | 1570.8 samples/s | 24.5 steps/s
[Step=6300 Epoch=30.9] | Loss=0.02023 | Reg=0.00185 | acc=0.9844 | FP-Norm=1.348 | FP-Norm(final)=2.634 | 3671.9 samples/s | 57.4 steps/s
[Step=6350 Epoch=31.1] | Loss=0.01935 | Reg=0.00186 | acc=0.9844 | FP-Norm=1.354 | FP-Norm(final)=2.636 | 3666.4 samples/s | 57.3 steps/s
[Step=6400 Epoch=31.4] | Loss=0.01893 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.359 | FP-Norm(final)=2.639 | 4242.8 samples/s | 66.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step6400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch=30.4] | Loss=0.14706 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.634 | 3416.3 samples/s | 53.4 steps/s
[Step=3250 Epoch=30.9] | Loss=0.01699 | Reg=0.00256 | acc=1.0000 | FP-Norm=1.528 | FP-Norm(final)=2.625 | 3304.9 samples/s | 51.6 steps/s
[Step=3300 Epoch=31.4] | Loss=0.01033 | Reg=0.00294 | acc=1.0000 | FP-Norm=1.676 | FP-Norm(final)=2.623 | 4610.4 samples/s | 72.0 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00729 | Reg=0.00296 | acc=1.0000 | FP-Norm=1.692 | FP-Norm(final)=2.624 | 1501.2 samples/s | 23.5 steps/s
[Step=3400 Epoch=32.3] | Loss=0.00552 | Reg=0.00288 | acc=1.0000 | FP-Norm=1.676 | FP-Norm(final)=2.626 | 4179.3 samples/s | 65.3 steps/s
[Step=3450 Epoch=32.8] | Loss=0.00443 | Reg=0.00277 | acc=1.0000 | FP-Norm=1.648 | FP-Norm(final)=2.627 | 1109.1 samples/s | 17.3 steps/s
[Step=3500 Epoch=33.3] | Loss=0.00370 | Reg=0.00267 | acc=1.0000 | FP-Norm=1.617 | FP-Norm(final)=2.629 | 4039.7 samples/s | 63.1 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00318 | Reg=0.00257 | acc=1.0000 | FP-Norm=1.587 | FP-Norm(final)=2.630 | 1571.4 samples/s | 24.6 steps/s
[Step=3600 Epoch=34.2] | Loss=0.00279 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.557 | FP-Norm(final)=2.631 | 3815.4 samples/s | 59.6 steps/s
[Step=3650 Epoch=34.7] | Loss=0.00248 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.528 | FP-Norm(final)=2.632 | 1610.0 samples/s | 25.2 steps/s
[Step=3700 Epoch=35.2] | Loss=0.00224 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.500 | FP-Norm(final)=2.633 | 3568.1 samples/s | 55.8 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00204 | Reg=0.00223 | acc=1.0000 | FP-Norm=1.474 | FP-Norm(final)=2.634 | 1650.4 samples/s | 25.8 steps/s
[Step=3800 Epoch=36.1] | Loss=0.00187 | Reg=0.00216 | acc=1.0000 | FP-Norm=1.449 | FP-Norm(final)=2.635 | 3488.0 samples/s | 54.5 steps/s
[Step=3850 Epoch=36.6] | Loss=0.00173 | Reg=0.00209 | acc=1.0000 | FP-Norm=1.425 | FP-Norm(final)=2.636 | 1656.4 samples/s | 25.9 steps/s
[Step=3900 Epoch=37.1] | Loss=0.00161 | Reg=0.00203 | acc=1.0000 | FP-Norm=1.402 | FP-Norm(final)=2.637 | 3436.0 samples/s | 53.7 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00151 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.379 | FP-Norm(final)=2.638 | 1682.1 samples/s | 26.3 steps/s
[Step=4000 Epoch=38.0] | Loss=0.00141 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.358 | FP-Norm(final)=2.638 | 3443.5 samples/s | 53.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26432 | acc=0.8141 | tpr=0.7393 | fpr=0.0235 | 3510.4 samples/s | 13.7 steps/s
Avg test loss: 0.27135, Avg test acc: 0.81224, Avg tpr: 0.73708, Avg fpr: 0.02243, total FA: 175

Testing server on iccad2012
[Step=  50] | Loss=0.46506 | acc=0.7966 | tpr=0.9602 | fpr=0.2064 | 3429.4 samples/s | 13.4 steps/s
[Step= 100] | Loss=0.47087 | acc=0.7940 | tpr=0.9680 | fpr=0.2093 | 6524.2 samples/s | 25.5 steps/s
[Step= 150] | Loss=0.47605 | acc=0.7927 | tpr=0.9741 | fpr=0.2106 | 6647.5 samples/s | 26.0 steps/s
[Step= 200] | Loss=0.47586 | acc=0.7923 | tpr=0.9770 | fpr=0.2110 | 6391.0 samples/s | 25.0 steps/s
[Step= 250] | Loss=0.47632 | acc=0.7920 | tpr=0.9764 | fpr=0.2113 | 6714.0 samples/s | 26.2 steps/s
[Step= 300] | Loss=0.47760 | acc=0.7919 | tpr=0.9753 | fpr=0.2114 | 6238.4 samples/s | 24.4 steps/s
[Step= 350] | Loss=0.47893 | acc=0.7922 | tpr=0.9762 | fpr=0.2111 | 6665.6 samples/s | 26.0 steps/s
[Step= 400] | Loss=0.47910 | acc=0.7923 | tpr=0.9781 | fpr=0.2111 | 6173.8 samples/s | 24.1 steps/s
[Step= 450] | Loss=0.48279 | acc=0.7919 | tpr=0.9781 | fpr=0.2115 | 6820.3 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.48377 | acc=0.7913 | tpr=0.9784 | fpr=0.2120 | 6123.5 samples/s | 23.9 steps/s
[Step= 550] | Loss=0.48155 | acc=0.7918 | tpr=0.9785 | fpr=0.2116 | 12096.6 samples/s | 47.3 steps/s
Avg test loss: 0.48174, Avg test acc: 0.79159, Avg tpr: 0.97861, Avg fpr: 0.21181, total FA: 29409

server round 18/50

clients selected: [0 1 3 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.23493 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.651 | 3529.4 samples/s | 55.1 steps/s
[Step=4850 Epoch=23.6] | Loss=0.04738 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.919 | FP-Norm(final)=2.634 | 3522.8 samples/s | 55.0 steps/s
[Step=4900 Epoch=23.9] | Loss=0.04158 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.028 | FP-Norm(final)=2.631 | 3640.6 samples/s | 56.9 steps/s
[Step=4950 Epoch=24.1] | Loss=0.03752 | Reg=0.00121 | acc=0.9844 | FP-Norm=1.082 | FP-Norm(final)=2.631 | 3638.8 samples/s | 56.9 steps/s
[Step=5000 Epoch=24.4] | Loss=0.03411 | Reg=0.00129 | acc=0.9844 | FP-Norm=1.118 | FP-Norm(final)=2.632 | 4650.8 samples/s | 72.7 steps/s
[Step=5050 Epoch=24.6] | Loss=0.03016 | Reg=0.00135 | acc=0.9531 | FP-Norm=1.147 | FP-Norm(final)=2.635 | 1561.4 samples/s | 24.4 steps/s
[Step=5100 Epoch=24.9] | Loss=0.02779 | Reg=0.00139 | acc=0.9531 | FP-Norm=1.169 | FP-Norm(final)=2.639 | 3713.2 samples/s | 58.0 steps/s
[Step=5150 Epoch=25.1] | Loss=0.02630 | Reg=0.00144 | acc=0.9844 | FP-Norm=1.187 | FP-Norm(final)=2.643 | 3656.1 samples/s | 57.1 steps/s
[Step=5200 Epoch=25.4] | Loss=0.02503 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.205 | FP-Norm(final)=2.647 | 4424.4 samples/s | 69.1 steps/s
[Step=5250 Epoch=25.6] | Loss=0.02405 | Reg=0.00153 | acc=0.9844 | FP-Norm=1.225 | FP-Norm(final)=2.650 | 1559.6 samples/s | 24.4 steps/s
[Step=5300 Epoch=25.8] | Loss=0.02304 | Reg=0.00158 | acc=0.9844 | FP-Norm=1.247 | FP-Norm(final)=2.654 | 3654.1 samples/s | 57.1 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02236 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.265 | FP-Norm(final)=2.657 | 3626.8 samples/s | 56.7 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02143 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.281 | FP-Norm(final)=2.659 | 4202.1 samples/s | 65.7 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02043 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.295 | FP-Norm(final)=2.662 | 1598.7 samples/s | 25.0 steps/s
[Step=5500 Epoch=26.8] | Loss=0.01972 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.307 | FP-Norm(final)=2.665 | 3704.0 samples/s | 57.9 steps/s
[Step=5550 Epoch=27.1] | Loss=0.01905 | Reg=0.00176 | acc=0.9844 | FP-Norm=1.316 | FP-Norm(final)=2.667 | 3674.0 samples/s | 57.4 steps/s
[Step=5600 Epoch=27.3] | Loss=0.01843 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.324 | FP-Norm(final)=2.670 | 3920.5 samples/s | 61.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step5600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=35.1] | Loss=0.16252 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.652 | 3630.1 samples/s | 56.7 steps/s
[Step=7250 Epoch=35.4] | Loss=0.04247 | Reg=0.00076 | acc=0.9688 | FP-Norm=0.830 | FP-Norm(final)=2.642 | 3419.7 samples/s | 53.4 steps/s
[Step=7300 Epoch=35.6] | Loss=0.03957 | Reg=0.00103 | acc=0.9844 | FP-Norm=0.983 | FP-Norm(final)=2.635 | 3640.2 samples/s | 56.9 steps/s
[Step=7350 Epoch=35.9] | Loss=0.03928 | Reg=0.00121 | acc=0.9844 | FP-Norm=1.076 | FP-Norm(final)=2.627 | 3622.2 samples/s | 56.6 steps/s
[Step=7400 Epoch=36.1] | Loss=0.03628 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.130 | FP-Norm(final)=2.626 | 4608.7 samples/s | 72.0 steps/s
[Step=7450 Epoch=36.4] | Loss=0.03246 | Reg=0.00140 | acc=1.0000 | FP-Norm=1.163 | FP-Norm(final)=2.627 | 1548.2 samples/s | 24.2 steps/s
[Step=7500 Epoch=36.6] | Loss=0.02886 | Reg=0.00144 | acc=0.9844 | FP-Norm=1.182 | FP-Norm(final)=2.629 | 3681.5 samples/s | 57.5 steps/s
[Step=7550 Epoch=36.8] | Loss=0.02751 | Reg=0.00147 | acc=0.9688 | FP-Norm=1.198 | FP-Norm(final)=2.632 | 3662.7 samples/s | 57.2 steps/s
[Step=7600 Epoch=37.1] | Loss=0.02596 | Reg=0.00151 | acc=0.9688 | FP-Norm=1.214 | FP-Norm(final)=2.635 | 4497.9 samples/s | 70.3 steps/s
[Step=7650 Epoch=37.3] | Loss=0.02413 | Reg=0.00154 | acc=0.9844 | FP-Norm=1.226 | FP-Norm(final)=2.637 | 1570.2 samples/s | 24.5 steps/s
[Step=7700 Epoch=37.6] | Loss=0.02292 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.236 | FP-Norm(final)=2.640 | 3611.6 samples/s | 56.4 steps/s
[Step=7750 Epoch=37.8] | Loss=0.02194 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.244 | FP-Norm(final)=2.643 | 3577.3 samples/s | 55.9 steps/s
[Step=7800 Epoch=38.1] | Loss=0.02108 | Reg=0.00160 | acc=0.9688 | FP-Norm=1.254 | FP-Norm(final)=2.645 | 4165.9 samples/s | 65.1 steps/s
[Step=7850 Epoch=38.3] | Loss=0.02041 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.265 | FP-Norm(final)=2.648 | 1593.6 samples/s | 24.9 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01977 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.274 | FP-Norm(final)=2.650 | 3654.8 samples/s | 57.1 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01913 | Reg=0.00167 | acc=0.9844 | FP-Norm=1.283 | FP-Norm(final)=2.653 | 3677.6 samples/s | 57.5 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01855 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.291 | FP-Norm(final)=2.655 | 4050.0 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.14369 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.652 | 3383.4 samples/s | 52.9 steps/s
[Step=8050 Epoch=39.3] | Loss=0.04731 | Reg=0.00089 | acc=0.9844 | FP-Norm=0.900 | FP-Norm(final)=2.643 | 3702.2 samples/s | 57.8 steps/s
[Step=8100 Epoch=39.5] | Loss=0.04380 | Reg=0.00114 | acc=0.9688 | FP-Norm=1.040 | FP-Norm(final)=2.640 | 3708.3 samples/s | 57.9 steps/s
[Step=8150 Epoch=39.7] | Loss=0.03784 | Reg=0.00129 | acc=0.9688 | FP-Norm=1.115 | FP-Norm(final)=2.638 | 3643.3 samples/s | 56.9 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03577 | Reg=0.00138 | acc=0.9375 | FP-Norm=1.156 | FP-Norm(final)=2.638 | 4734.6 samples/s | 74.0 steps/s
[Step=8250 Epoch=40.2] | Loss=0.03207 | Reg=0.00145 | acc=0.9844 | FP-Norm=1.189 | FP-Norm(final)=2.639 | 1546.1 samples/s | 24.2 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02928 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.210 | FP-Norm(final)=2.641 | 3616.5 samples/s | 56.5 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02782 | Reg=0.00153 | acc=0.9844 | FP-Norm=1.226 | FP-Norm(final)=2.644 | 3630.8 samples/s | 56.7 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02614 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.240 | FP-Norm(final)=2.646 | 4486.5 samples/s | 70.1 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02444 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.253 | FP-Norm(final)=2.648 | 1579.2 samples/s | 24.7 steps/s
[Step=8500 Epoch=41.5] | Loss=0.02308 | Reg=0.00162 | acc=0.9844 | FP-Norm=1.263 | FP-Norm(final)=2.650 | 3629.0 samples/s | 56.7 steps/s
[Step=8550 Epoch=41.7] | Loss=0.02209 | Reg=0.00164 | acc=0.9844 | FP-Norm=1.273 | FP-Norm(final)=2.653 | 3582.6 samples/s | 56.0 steps/s
[Step=8600 Epoch=41.9] | Loss=0.02109 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.282 | FP-Norm(final)=2.655 | 4147.8 samples/s | 64.8 steps/s
[Step=8650 Epoch=42.2] | Loss=0.02030 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.290 | FP-Norm(final)=2.658 | 1618.7 samples/s | 25.3 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01959 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.296 | FP-Norm(final)=2.660 | 3586.9 samples/s | 56.0 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01897 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.303 | FP-Norm(final)=2.661 | 3636.4 samples/s | 56.8 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01828 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.309 | FP-Norm(final)=2.663 | 3876.2 samples/s | 60.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step8800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=38.1] | Loss=0.14250 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.651 | 3362.2 samples/s | 52.5 steps/s
[Step=4050 Epoch=38.5] | Loss=0.01384 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.448 | FP-Norm(final)=2.643 | 3157.8 samples/s | 49.3 steps/s
[Step=4100 Epoch=39.0] | Loss=0.01016 | Reg=0.00281 | acc=1.0000 | FP-Norm=1.633 | FP-Norm(final)=2.644 | 4574.2 samples/s | 71.5 steps/s
[Step=4150 Epoch=39.5] | Loss=0.00752 | Reg=0.00308 | acc=1.0000 | FP-Norm=1.722 | FP-Norm(final)=2.643 | 1509.0 samples/s | 23.6 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00609 | Reg=0.00316 | acc=1.0000 | FP-Norm=1.754 | FP-Norm(final)=2.644 | 4237.5 samples/s | 66.2 steps/s
[Step=4250 Epoch=40.4] | Loss=0.00490 | Reg=0.00317 | acc=1.0000 | FP-Norm=1.762 | FP-Norm(final)=2.644 | 1542.2 samples/s | 24.1 steps/s
[Step=4300 Epoch=40.9] | Loss=0.00409 | Reg=0.00313 | acc=1.0000 | FP-Norm=1.751 | FP-Norm(final)=2.645 | 4049.1 samples/s | 63.3 steps/s
[Step=4350 Epoch=41.4] | Loss=0.00353 | Reg=0.00306 | acc=1.0000 | FP-Norm=1.735 | FP-Norm(final)=2.646 | 1586.2 samples/s | 24.8 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00310 | Reg=0.00299 | acc=1.0000 | FP-Norm=1.714 | FP-Norm(final)=2.648 | 3789.0 samples/s | 59.2 steps/s
[Step=4450 Epoch=42.3] | Loss=0.00276 | Reg=0.00291 | acc=1.0000 | FP-Norm=1.692 | FP-Norm(final)=2.649 | 1594.1 samples/s | 24.9 steps/s
[Step=4500 Epoch=42.8] | Loss=0.00248 | Reg=0.00283 | acc=1.0000 | FP-Norm=1.669 | FP-Norm(final)=2.649 | 3565.8 samples/s | 55.7 steps/s
[Step=4550 Epoch=43.3] | Loss=0.00226 | Reg=0.00276 | acc=1.0000 | FP-Norm=1.646 | FP-Norm(final)=2.650 | 1638.3 samples/s | 25.6 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00208 | Reg=0.00269 | acc=1.0000 | FP-Norm=1.624 | FP-Norm(final)=2.651 | 3476.3 samples/s | 54.3 steps/s
[Step=4650 Epoch=44.2] | Loss=0.00192 | Reg=0.00262 | acc=1.0000 | FP-Norm=1.601 | FP-Norm(final)=2.652 | 1681.5 samples/s | 26.3 steps/s
[Step=4700 Epoch=44.7] | Loss=0.00178 | Reg=0.00255 | acc=1.0000 | FP-Norm=1.580 | FP-Norm(final)=2.653 | 3520.8 samples/s | 55.0 steps/s
[Step=4750 Epoch=45.2] | Loss=0.00167 | Reg=0.00248 | acc=1.0000 | FP-Norm=1.558 | FP-Norm(final)=2.653 | 1641.1 samples/s | 25.6 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00156 | Reg=0.00242 | acc=1.0000 | FP-Norm=1.537 | FP-Norm(final)=2.654 | 3465.8 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step4800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=61.1] | Loss=0.13103 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.651 | 3275.9 samples/s | 51.2 steps/s
[Step=6450 Epoch=61.6] | Loss=0.00988 | Reg=0.00210 | acc=1.0000 | FP-Norm=1.381 | FP-Norm(final)=2.647 | 3399.4 samples/s | 53.1 steps/s
[Step=6500 Epoch=62.1] | Loss=0.00554 | Reg=0.00228 | acc=1.0000 | FP-Norm=1.473 | FP-Norm(final)=2.652 | 4606.7 samples/s | 72.0 steps/s
[Step=6550 Epoch=62.5] | Loss=0.00377 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.477 | FP-Norm(final)=2.655 | 1462.0 samples/s | 22.8 steps/s
[Step=6600 Epoch=63.0] | Loss=0.00287 | Reg=0.00217 | acc=1.0000 | FP-Norm=1.453 | FP-Norm(final)=2.657 | 4281.2 samples/s | 66.9 steps/s
[Step=6650 Epoch=63.5] | Loss=0.00230 | Reg=0.00207 | acc=1.0000 | FP-Norm=1.423 | FP-Norm(final)=2.658 | 1512.4 samples/s | 23.6 steps/s
[Step=6700 Epoch=64.0] | Loss=0.00192 | Reg=0.00198 | acc=1.0000 | FP-Norm=1.392 | FP-Norm(final)=2.659 | 4132.0 samples/s | 64.6 steps/s
[Step=6750 Epoch=64.5] | Loss=0.00165 | Reg=0.00190 | acc=1.0000 | FP-Norm=1.361 | FP-Norm(final)=2.660 | 1571.0 samples/s | 24.5 steps/s
[Step=6800 Epoch=64.9] | Loss=0.00145 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.331 | FP-Norm(final)=2.661 | 3857.3 samples/s | 60.3 steps/s
[Step=6850 Epoch=65.4] | Loss=0.00129 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.302 | FP-Norm(final)=2.661 | 1604.3 samples/s | 25.1 steps/s
[Step=6900 Epoch=65.9] | Loss=0.00116 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.275 | FP-Norm(final)=2.662 | 3721.1 samples/s | 58.1 steps/s
[Step=6950 Epoch=66.4] | Loss=0.00106 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.250 | FP-Norm(final)=2.662 | 1585.9 samples/s | 24.8 steps/s
[Step=7000 Epoch=66.8] | Loss=0.00098 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.225 | FP-Norm(final)=2.663 | 3547.4 samples/s | 55.4 steps/s
[Step=7050 Epoch=67.3] | Loss=0.00090 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.202 | FP-Norm(final)=2.663 | 1664.5 samples/s | 26.0 steps/s
[Step=7100 Epoch=67.8] | Loss=0.00084 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.180 | FP-Norm(final)=2.664 | 3565.9 samples/s | 55.7 steps/s
[Step=7150 Epoch=68.3] | Loss=0.00079 | Reg=0.00140 | acc=1.0000 | FP-Norm=1.159 | FP-Norm(final)=2.664 | 1652.3 samples/s | 25.8 steps/s
[Step=7200 Epoch=68.8] | Loss=0.00074 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.138 | FP-Norm(final)=2.664 | 3472.0 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27454 | acc=0.8119 | tpr=0.7345 | fpr=0.0201 | 3427.2 samples/s | 13.4 steps/s
Avg test loss: 0.28208, Avg test acc: 0.80868, Avg tpr: 0.73084, Avg fpr: 0.02013, total FA: 157

Testing server on iccad2012
[Step=  50] | Loss=0.48359 | acc=0.7987 | tpr=0.9646 | fpr=0.2042 | 3496.2 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.48935 | acc=0.7954 | tpr=0.9701 | fpr=0.2079 | 6691.9 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.49445 | acc=0.7937 | tpr=0.9755 | fpr=0.2096 | 6213.7 samples/s | 24.3 steps/s
[Step= 200] | Loss=0.49429 | acc=0.7937 | tpr=0.9781 | fpr=0.2097 | 6367.2 samples/s | 24.9 steps/s
[Step= 250] | Loss=0.49452 | acc=0.7938 | tpr=0.9773 | fpr=0.2096 | 6527.4 samples/s | 25.5 steps/s
[Step= 300] | Loss=0.49575 | acc=0.7935 | tpr=0.9767 | fpr=0.2098 | 6565.0 samples/s | 25.6 steps/s
[Step= 350] | Loss=0.49724 | acc=0.7938 | tpr=0.9775 | fpr=0.2096 | 6275.2 samples/s | 24.5 steps/s
[Step= 400] | Loss=0.49733 | acc=0.7936 | tpr=0.9792 | fpr=0.2097 | 6505.6 samples/s | 25.4 steps/s
[Step= 450] | Loss=0.50154 | acc=0.7931 | tpr=0.9791 | fpr=0.2103 | 6479.8 samples/s | 25.3 steps/s
[Step= 500] | Loss=0.50272 | acc=0.7925 | tpr=0.9793 | fpr=0.2109 | 6283.4 samples/s | 24.5 steps/s
[Step= 550] | Loss=0.50033 | acc=0.7931 | tpr=0.9797 | fpr=0.2103 | 12369.6 samples/s | 48.3 steps/s
Avg test loss: 0.50050, Avg test acc: 0.79296, Avg tpr: 0.97979, Avg fpr: 0.21043, total FA: 29218

server round 19/50

clients selected: [1 2 6 7 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.11278 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.665 | 3765.5 samples/s | 58.8 steps/s
[Step=8050 Epoch=39.3] | Loss=0.05245 | Reg=0.00103 | acc=0.9688 | FP-Norm=0.970 | FP-Norm(final)=2.643 | 3242.3 samples/s | 50.7 steps/s
[Step=8100 Epoch=39.5] | Loss=0.04398 | Reg=0.00131 | acc=0.9844 | FP-Norm=1.114 | FP-Norm(final)=2.635 | 3699.1 samples/s | 57.8 steps/s
[Step=8150 Epoch=39.8] | Loss=0.03990 | Reg=0.00143 | acc=0.9844 | FP-Norm=1.172 | FP-Norm(final)=2.632 | 3671.9 samples/s | 57.4 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03707 | Reg=0.00152 | acc=0.9844 | FP-Norm=1.215 | FP-Norm(final)=2.630 | 4721.2 samples/s | 73.8 steps/s
[Step=8250 Epoch=40.3] | Loss=0.03313 | Reg=0.00160 | acc=0.9844 | FP-Norm=1.247 | FP-Norm(final)=2.631 | 1541.8 samples/s | 24.1 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02994 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.265 | FP-Norm(final)=2.633 | 3696.5 samples/s | 57.8 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02815 | Reg=0.00167 | acc=0.9844 | FP-Norm=1.280 | FP-Norm(final)=2.636 | 3695.2 samples/s | 57.7 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02605 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.291 | FP-Norm(final)=2.640 | 4474.2 samples/s | 69.9 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02444 | Reg=0.00172 | acc=0.9844 | FP-Norm=1.300 | FP-Norm(final)=2.643 | 1573.4 samples/s | 24.6 steps/s
[Step=8500 Epoch=41.5] | Loss=0.02308 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.307 | FP-Norm(final)=2.647 | 3649.7 samples/s | 57.0 steps/s
[Step=8550 Epoch=41.7] | Loss=0.02185 | Reg=0.00174 | acc=0.9688 | FP-Norm=1.312 | FP-Norm(final)=2.650 | 3644.5 samples/s | 56.9 steps/s
[Step=8600 Epoch=42.0] | Loss=0.02123 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.317 | FP-Norm(final)=2.653 | 4246.5 samples/s | 66.4 steps/s
[Step=8650 Epoch=42.2] | Loss=0.02057 | Reg=0.00177 | acc=0.9688 | FP-Norm=1.323 | FP-Norm(final)=2.655 | 1612.4 samples/s | 25.2 steps/s
[Step=8700 Epoch=42.5] | Loss=0.01980 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.329 | FP-Norm(final)=2.658 | 3703.8 samples/s | 57.9 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01915 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.334 | FP-Norm(final)=2.660 | 3674.9 samples/s | 57.4 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01850 | Reg=0.00181 | acc=0.9844 | FP-Norm=1.339 | FP-Norm(final)=2.662 | 4059.2 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step8800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.26418 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.665 | 3385.9 samples/s | 52.9 steps/s
[Step=9650 Epoch=47.0] | Loss=0.04971 | Reg=0.00110 | acc=0.9844 | FP-Norm=1.002 | FP-Norm(final)=2.641 | 3550.7 samples/s | 55.5 steps/s
[Step=9700 Epoch=47.3] | Loss=0.04145 | Reg=0.00131 | acc=0.9844 | FP-Norm=1.118 | FP-Norm(final)=2.635 | 3513.7 samples/s | 54.9 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03772 | Reg=0.00141 | acc=0.9844 | FP-Norm=1.167 | FP-Norm(final)=2.634 | 3675.9 samples/s | 57.4 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03652 | Reg=0.00150 | acc=0.9688 | FP-Norm=1.208 | FP-Norm(final)=2.632 | 4716.3 samples/s | 73.7 steps/s
[Step=9850 Epoch=48.0] | Loss=0.03225 | Reg=0.00156 | acc=0.9844 | FP-Norm=1.235 | FP-Norm(final)=2.632 | 1545.1 samples/s | 24.1 steps/s
[Step=9900 Epoch=48.2] | Loss=0.02931 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.251 | FP-Norm(final)=2.635 | 3578.2 samples/s | 55.9 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02771 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.267 | FP-Norm(final)=2.637 | 3651.8 samples/s | 57.1 steps/s
[Step=10000 Epoch=48.7] | Loss=0.02654 | Reg=0.00166 | acc=0.9844 | FP-Norm=1.281 | FP-Norm(final)=2.640 | 4352.7 samples/s | 68.0 steps/s
[Step=10050 Epoch=49.0] | Loss=0.02465 | Reg=0.00169 | acc=0.9844 | FP-Norm=1.293 | FP-Norm(final)=2.643 | 1579.5 samples/s | 24.7 steps/s
[Step=10100 Epoch=49.2] | Loss=0.02357 | Reg=0.00171 | acc=0.9688 | FP-Norm=1.301 | FP-Norm(final)=2.646 | 3695.2 samples/s | 57.7 steps/s
[Step=10150 Epoch=49.5] | Loss=0.02252 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.308 | FP-Norm(final)=2.649 | 3688.1 samples/s | 57.6 steps/s
[Step=10200 Epoch=49.7] | Loss=0.02164 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.316 | FP-Norm(final)=2.652 | 4179.1 samples/s | 65.3 steps/s
[Step=10250 Epoch=49.9] | Loss=0.02086 | Reg=0.00177 | acc=0.9844 | FP-Norm=1.323 | FP-Norm(final)=2.655 | 1615.5 samples/s | 25.2 steps/s
[Step=10300 Epoch=50.2] | Loss=0.02015 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.329 | FP-Norm(final)=2.657 | 3538.1 samples/s | 55.3 steps/s
[Step=10350 Epoch=50.4] | Loss=0.01941 | Reg=0.00180 | acc=0.9844 | FP-Norm=1.334 | FP-Norm(final)=2.660 | 3646.8 samples/s | 57.0 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01887 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.339 | FP-Norm(final)=2.662 | 3906.9 samples/s | 61.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step10400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=45.7] | Loss=0.10357 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.665 | 3295.4 samples/s | 51.5 steps/s
[Step=4850 Epoch=46.1] | Loss=0.01931 | Reg=0.00257 | acc=1.0000 | FP-Norm=1.512 | FP-Norm(final)=2.641 | 3468.9 samples/s | 54.2 steps/s
[Step=4900 Epoch=46.6] | Loss=0.01384 | Reg=0.00308 | acc=1.0000 | FP-Norm=1.703 | FP-Norm(final)=2.630 | 4626.6 samples/s | 72.3 steps/s
[Step=4950 Epoch=47.1] | Loss=0.00934 | Reg=0.00308 | acc=1.0000 | FP-Norm=1.721 | FP-Norm(final)=2.630 | 1506.7 samples/s | 23.5 steps/s
[Step=5000 Epoch=47.6] | Loss=0.00710 | Reg=0.00299 | acc=1.0000 | FP-Norm=1.702 | FP-Norm(final)=2.632 | 4244.9 samples/s | 66.3 steps/s
[Step=5050 Epoch=48.0] | Loss=0.00570 | Reg=0.00287 | acc=1.0000 | FP-Norm=1.672 | FP-Norm(final)=2.634 | 1559.3 samples/s | 24.4 steps/s
[Step=5100 Epoch=48.5] | Loss=0.00476 | Reg=0.00276 | acc=1.0000 | FP-Norm=1.639 | FP-Norm(final)=2.636 | 4021.6 samples/s | 62.8 steps/s
[Step=5150 Epoch=49.0] | Loss=0.00409 | Reg=0.00265 | acc=1.0000 | FP-Norm=1.607 | FP-Norm(final)=2.638 | 1599.0 samples/s | 25.0 steps/s
[Step=5200 Epoch=49.5] | Loss=0.00358 | Reg=0.00255 | acc=1.0000 | FP-Norm=1.575 | FP-Norm(final)=2.640 | 3793.0 samples/s | 59.3 steps/s
[Step=5250 Epoch=49.9] | Loss=0.00319 | Reg=0.00245 | acc=1.0000 | FP-Norm=1.545 | FP-Norm(final)=2.641 | 1624.7 samples/s | 25.4 steps/s
[Step=5300 Epoch=50.4] | Loss=0.00288 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.517 | FP-Norm(final)=2.643 | 3619.5 samples/s | 56.6 steps/s
[Step=5350 Epoch=50.9] | Loss=0.00262 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.490 | FP-Norm(final)=2.645 | 1619.4 samples/s | 25.3 steps/s
[Step=5400 Epoch=51.4] | Loss=0.00240 | Reg=0.00221 | acc=1.0000 | FP-Norm=1.464 | FP-Norm(final)=2.646 | 3564.4 samples/s | 55.7 steps/s
[Step=5450 Epoch=51.8] | Loss=0.00222 | Reg=0.00214 | acc=1.0000 | FP-Norm=1.440 | FP-Norm(final)=2.648 | 1667.3 samples/s | 26.1 steps/s
[Step=5500 Epoch=52.3] | Loss=0.00207 | Reg=0.00208 | acc=1.0000 | FP-Norm=1.416 | FP-Norm(final)=2.649 | 3574.8 samples/s | 55.9 steps/s
[Step=5550 Epoch=52.8] | Loss=0.00193 | Reg=0.00202 | acc=1.0000 | FP-Norm=1.394 | FP-Norm(final)=2.650 | 1675.7 samples/s | 26.2 steps/s
[Step=5600 Epoch=53.3] | Loss=0.00181 | Reg=0.00196 | acc=1.0000 | FP-Norm=1.373 | FP-Norm(final)=2.652 | 3485.0 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step5600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=68.8] | Loss=0.06737 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.666 | 3502.2 samples/s | 54.7 steps/s
[Step=7250 Epoch=69.2] | Loss=0.01384 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.271 | FP-Norm(final)=2.668 | 3234.2 samples/s | 50.5 steps/s
[Step=7300 Epoch=69.7] | Loss=0.00904 | Reg=0.00268 | acc=1.0000 | FP-Norm=1.576 | FP-Norm(final)=2.663 | 4532.0 samples/s | 70.8 steps/s
[Step=7350 Epoch=70.2] | Loss=0.00606 | Reg=0.00283 | acc=1.0000 | FP-Norm=1.641 | FP-Norm(final)=2.661 | 1489.1 samples/s | 23.3 steps/s
[Step=7400 Epoch=70.7] | Loss=0.00456 | Reg=0.00280 | acc=1.0000 | FP-Norm=1.643 | FP-Norm(final)=2.661 | 4376.1 samples/s | 68.4 steps/s
[Step=7450 Epoch=71.1] | Loss=0.00365 | Reg=0.00273 | acc=1.0000 | FP-Norm=1.626 | FP-Norm(final)=2.662 | 1535.7 samples/s | 24.0 steps/s
[Step=7500 Epoch=71.6] | Loss=0.00305 | Reg=0.00264 | acc=1.0000 | FP-Norm=1.603 | FP-Norm(final)=2.663 | 4150.7 samples/s | 64.9 steps/s
[Step=7550 Epoch=72.1] | Loss=0.00262 | Reg=0.00256 | acc=1.0000 | FP-Norm=1.578 | FP-Norm(final)=2.663 | 1552.4 samples/s | 24.3 steps/s
[Step=7600 Epoch=72.6] | Loss=0.00229 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.552 | FP-Norm(final)=2.664 | 3875.9 samples/s | 60.6 steps/s
[Step=7650 Epoch=73.1] | Loss=0.00204 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.527 | FP-Norm(final)=2.665 | 1583.9 samples/s | 24.7 steps/s
[Step=7700 Epoch=73.5] | Loss=0.00184 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.502 | FP-Norm(final)=2.665 | 3674.1 samples/s | 57.4 steps/s
[Step=7750 Epoch=74.0] | Loss=0.00168 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.478 | FP-Norm(final)=2.666 | 1614.1 samples/s | 25.2 steps/s
[Step=7800 Epoch=74.5] | Loss=0.00154 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.455 | FP-Norm(final)=2.667 | 3540.7 samples/s | 55.3 steps/s
[Step=7850 Epoch=75.0] | Loss=0.00142 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.432 | FP-Norm(final)=2.667 | 1620.3 samples/s | 25.3 steps/s
[Step=7900 Epoch=75.4] | Loss=0.00132 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.410 | FP-Norm(final)=2.668 | 3440.9 samples/s | 53.8 steps/s
[Step=7950 Epoch=75.9] | Loss=0.00124 | Reg=0.00200 | acc=1.0000 | FP-Norm=1.389 | FP-Norm(final)=2.668 | 1643.9 samples/s | 25.7 steps/s
[Step=8000 Epoch=76.4] | Loss=0.00116 | Reg=0.00194 | acc=1.0000 | FP-Norm=1.368 | FP-Norm(final)=2.669 | 3490.0 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step8000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=82.9] | Loss=0.14095 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.665 | 3511.5 samples/s | 54.9 steps/s
[Step=8850 Epoch=83.4] | Loss=0.01503 | Reg=0.00277 | acc=1.0000 | FP-Norm=1.576 | FP-Norm(final)=2.646 | 3230.6 samples/s | 50.5 steps/s
[Step=8900 Epoch=83.9] | Loss=0.00860 | Reg=0.00316 | acc=1.0000 | FP-Norm=1.729 | FP-Norm(final)=2.643 | 4529.2 samples/s | 70.8 steps/s
[Step=8950 Epoch=84.3] | Loss=0.00585 | Reg=0.00309 | acc=1.0000 | FP-Norm=1.725 | FP-Norm(final)=2.645 | 1515.3 samples/s | 23.7 steps/s
[Step=9000 Epoch=84.8] | Loss=0.00441 | Reg=0.00296 | acc=1.0000 | FP-Norm=1.695 | FP-Norm(final)=2.648 | 4174.1 samples/s | 65.2 steps/s
[Step=9050 Epoch=85.3] | Loss=0.00354 | Reg=0.00282 | acc=1.0000 | FP-Norm=1.658 | FP-Norm(final)=2.650 | 1545.3 samples/s | 24.1 steps/s
[Step=9100 Epoch=85.7] | Loss=0.00296 | Reg=0.00270 | acc=1.0000 | FP-Norm=1.622 | FP-Norm(final)=2.652 | 3828.1 samples/s | 59.8 steps/s
[Step=9150 Epoch=86.2] | Loss=0.00254 | Reg=0.00258 | acc=1.0000 | FP-Norm=1.587 | FP-Norm(final)=2.654 | 1614.5 samples/s | 25.2 steps/s
[Step=9200 Epoch=86.7] | Loss=0.00223 | Reg=0.00248 | acc=1.0000 | FP-Norm=1.554 | FP-Norm(final)=2.655 | 3667.0 samples/s | 57.3 steps/s
[Step=9250 Epoch=87.2] | Loss=0.00198 | Reg=0.00238 | acc=1.0000 | FP-Norm=1.523 | FP-Norm(final)=2.657 | 1642.4 samples/s | 25.7 steps/s
[Step=9300 Epoch=87.6] | Loss=0.00179 | Reg=0.00230 | acc=1.0000 | FP-Norm=1.493 | FP-Norm(final)=2.658 | 3440.1 samples/s | 53.8 steps/s
[Step=9350 Epoch=88.1] | Loss=0.00163 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.466 | FP-Norm(final)=2.659 | 1649.5 samples/s | 25.8 steps/s
[Step=9400 Epoch=88.6] | Loss=0.00150 | Reg=0.00214 | acc=1.0000 | FP-Norm=1.439 | FP-Norm(final)=2.660 | 3566.5 samples/s | 55.7 steps/s
[Step=9450 Epoch=89.0] | Loss=0.00138 | Reg=0.00207 | acc=1.0000 | FP-Norm=1.414 | FP-Norm(final)=2.661 | 1682.7 samples/s | 26.3 steps/s
[Step=9500 Epoch=89.5] | Loss=0.00129 | Reg=0.00201 | acc=1.0000 | FP-Norm=1.390 | FP-Norm(final)=2.662 | 3398.0 samples/s | 53.1 steps/s
[Step=9550 Epoch=90.0] | Loss=0.00120 | Reg=0.00195 | acc=1.0000 | FP-Norm=1.368 | FP-Norm(final)=2.663 | 1704.2 samples/s | 26.6 steps/s
[Step=9600 Epoch=90.5] | Loss=0.00113 | Reg=0.00189 | acc=1.0000 | FP-Norm=1.346 | FP-Norm(final)=2.664 | 3304.7 samples/s | 51.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28574 | acc=0.8038 | tpr=0.7227 | fpr=0.0201 | 3429.2 samples/s | 13.4 steps/s
Avg test loss: 0.29365, Avg test acc: 0.80139, Avg tpr: 0.72023, Avg fpr: 0.02013, total FA: 157

Testing server on iccad2012
[Step=  50] | Loss=0.46793 | acc=0.8083 | tpr=0.9646 | fpr=0.1945 | 3423.2 samples/s | 13.4 steps/s
[Step= 100] | Loss=0.47316 | acc=0.8043 | tpr=0.9680 | fpr=0.1988 | 6541.2 samples/s | 25.6 steps/s
[Step= 150] | Loss=0.47876 | acc=0.8029 | tpr=0.9726 | fpr=0.2002 | 6365.3 samples/s | 24.9 steps/s
[Step= 200] | Loss=0.47895 | acc=0.8029 | tpr=0.9738 | fpr=0.2002 | 6547.3 samples/s | 25.6 steps/s
[Step= 250] | Loss=0.47891 | acc=0.8035 | tpr=0.9729 | fpr=0.1996 | 6414.2 samples/s | 25.1 steps/s
[Step= 300] | Loss=0.48010 | acc=0.8032 | tpr=0.9731 | fpr=0.1999 | 6398.4 samples/s | 25.0 steps/s
[Step= 350] | Loss=0.48161 | acc=0.8034 | tpr=0.9743 | fpr=0.1997 | 6671.4 samples/s | 26.1 steps/s
[Step= 400] | Loss=0.48170 | acc=0.8032 | tpr=0.9765 | fpr=0.2000 | 6593.4 samples/s | 25.8 steps/s
[Step= 450] | Loss=0.48596 | acc=0.8025 | tpr=0.9761 | fpr=0.2006 | 6455.6 samples/s | 25.2 steps/s
[Step= 500] | Loss=0.48693 | acc=0.8020 | tpr=0.9771 | fpr=0.2012 | 6280.1 samples/s | 24.5 steps/s
[Step= 550] | Loss=0.48449 | acc=0.8027 | tpr=0.9769 | fpr=0.2005 | 11891.6 samples/s | 46.5 steps/s
Avg test loss: 0.48466, Avg test acc: 0.80254, Avg tpr: 0.97702, Avg fpr: 0.20063, total FA: 27857

server round 20/50

clients selected: [0 1 2 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=5601 Epoch=27.3] | Loss=0.24756 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.672 | 3465.7 samples/s | 54.2 steps/s
[Step=5650 Epoch=27.6] | Loss=0.04504 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.664 | 3581.7 samples/s | 56.0 steps/s
[Step=5700 Epoch=27.8] | Loss=0.03470 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.663 | 3606.6 samples/s | 56.4 steps/s
[Step=5750 Epoch=28.0] | Loss=0.02997 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.659 | FP-Norm(final)=2.665 | 3633.6 samples/s | 56.8 steps/s
[Step=5800 Epoch=28.3] | Loss=0.02643 | Reg=0.00049 | acc=0.9844 | FP-Norm=0.689 | FP-Norm(final)=2.667 | 4681.7 samples/s | 73.2 steps/s
[Step=5850 Epoch=28.5] | Loss=0.02299 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.710 | FP-Norm(final)=2.671 | 1558.3 samples/s | 24.3 steps/s
[Step=5900 Epoch=28.8] | Loss=0.02093 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.726 | FP-Norm(final)=2.675 | 3668.7 samples/s | 57.3 steps/s
[Step=5950 Epoch=29.0] | Loss=0.01957 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.736 | FP-Norm(final)=2.678 | 3613.9 samples/s | 56.5 steps/s
[Step=6000 Epoch=29.3] | Loss=0.01813 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.744 | FP-Norm(final)=2.682 | 4405.2 samples/s | 68.8 steps/s
[Step=6050 Epoch=29.5] | Loss=0.01693 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.751 | FP-Norm(final)=2.686 | 1573.1 samples/s | 24.6 steps/s
[Step=6100 Epoch=29.7] | Loss=0.01605 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.758 | FP-Norm(final)=2.689 | 3685.0 samples/s | 57.6 steps/s
[Step=6150 Epoch=30.0] | Loss=0.01522 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.764 | FP-Norm(final)=2.693 | 3673.9 samples/s | 57.4 steps/s
[Step=6200 Epoch=30.2] | Loss=0.01446 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.769 | FP-Norm(final)=2.696 | 4167.2 samples/s | 65.1 steps/s
[Step=6250 Epoch=30.5] | Loss=0.01382 | Reg=0.00061 | acc=0.9844 | FP-Norm=0.775 | FP-Norm(final)=2.699 | 1613.6 samples/s | 25.2 steps/s
[Step=6300 Epoch=30.7] | Loss=0.01323 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.702 | 3628.3 samples/s | 56.7 steps/s
[Step=6350 Epoch=31.0] | Loss=0.01275 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.705 | 3596.6 samples/s | 56.2 steps/s
[Step=6400 Epoch=31.2] | Loss=0.01243 | Reg=0.00063 | acc=0.9844 | FP-Norm=0.790 | FP-Norm(final)=2.708 | 3888.6 samples/s | 60.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step6400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=42.9] | Loss=0.11644 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.672 | 3566.4 samples/s | 55.7 steps/s
[Step=8850 Epoch=43.2] | Loss=0.04118 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.659 | FP-Norm(final)=2.667 | 3493.1 samples/s | 54.6 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03412 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.733 | FP-Norm(final)=2.664 | 3640.8 samples/s | 56.9 steps/s
[Step=8950 Epoch=43.7] | Loss=0.03015 | Reg=0.00060 | acc=0.9688 | FP-Norm=0.760 | FP-Norm(final)=2.665 | 3620.5 samples/s | 56.6 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02778 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.781 | FP-Norm(final)=2.666 | 4639.0 samples/s | 72.5 steps/s
[Step=9050 Epoch=44.2] | Loss=0.02452 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.797 | FP-Norm(final)=2.668 | 1550.9 samples/s | 24.2 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02217 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.805 | FP-Norm(final)=2.671 | 3644.2 samples/s | 56.9 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02029 | Reg=0.00067 | acc=0.9844 | FP-Norm=0.811 | FP-Norm(final)=2.674 | 3696.9 samples/s | 57.8 steps/s
[Step=9200 Epoch=44.9] | Loss=0.01897 | Reg=0.00068 | acc=0.9844 | FP-Norm=0.817 | FP-Norm(final)=2.678 | 4427.7 samples/s | 69.2 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01796 | Reg=0.00069 | acc=0.9844 | FP-Norm=0.824 | FP-Norm(final)=2.681 | 1564.9 samples/s | 24.5 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01690 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.684 | 3624.2 samples/s | 56.6 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01607 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.833 | FP-Norm(final)=2.688 | 3617.0 samples/s | 56.5 steps/s
[Step=9400 Epoch=45.9] | Loss=0.01532 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.837 | FP-Norm(final)=2.691 | 4213.9 samples/s | 65.8 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01472 | Reg=0.00071 | acc=0.9844 | FP-Norm=0.840 | FP-Norm(final)=2.694 | 1575.7 samples/s | 24.6 steps/s
[Step=9500 Epoch=46.4] | Loss=0.01408 | Reg=0.00072 | acc=0.9844 | FP-Norm=0.843 | FP-Norm(final)=2.696 | 3677.7 samples/s | 57.5 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01362 | Reg=0.00072 | acc=0.9844 | FP-Norm=0.846 | FP-Norm(final)=2.699 | 3687.3 samples/s | 57.6 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01313 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.849 | FP-Norm(final)=2.702 | 4073.5 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step9600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=50.7] | Loss=0.14734 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.672 | 3387.1 samples/s | 52.9 steps/s
[Step=10450 Epoch=50.9] | Loss=0.04668 | Reg=0.00045 | acc=0.9688 | FP-Norm=0.642 | FP-Norm(final)=2.662 | 3520.7 samples/s | 55.0 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03852 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.724 | FP-Norm(final)=2.659 | 3626.1 samples/s | 56.7 steps/s
[Step=10550 Epoch=51.4] | Loss=0.03185 | Reg=0.00058 | acc=0.9688 | FP-Norm=0.752 | FP-Norm(final)=2.660 | 3625.7 samples/s | 56.7 steps/s
[Step=10600 Epoch=51.6] | Loss=0.02834 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.767 | FP-Norm(final)=2.663 | 4599.6 samples/s | 71.9 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02453 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.667 | 1560.9 samples/s | 24.4 steps/s
[Step=10700 Epoch=52.1] | Loss=0.02211 | Reg=0.00063 | acc=0.9844 | FP-Norm=0.785 | FP-Norm(final)=2.672 | 3637.1 samples/s | 56.8 steps/s
[Step=10750 Epoch=52.4] | Loss=0.02027 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.791 | FP-Norm(final)=2.676 | 3606.0 samples/s | 56.3 steps/s
[Step=10800 Epoch=52.6] | Loss=0.01871 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.796 | FP-Norm(final)=2.681 | 4410.8 samples/s | 68.9 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01751 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.801 | FP-Norm(final)=2.685 | 1590.1 samples/s | 24.8 steps/s
[Step=10900 Epoch=53.1] | Loss=0.01646 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.805 | FP-Norm(final)=2.690 | 3664.4 samples/s | 57.3 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01554 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.694 | 3701.7 samples/s | 57.8 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01484 | Reg=0.00067 | acc=0.9844 | FP-Norm=0.812 | FP-Norm(final)=2.697 | 4022.6 samples/s | 62.9 steps/s
[Step=11050 Epoch=53.8] | Loss=0.01407 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.701 | 1623.6 samples/s | 25.4 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01336 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.819 | FP-Norm(final)=2.705 | 3652.3 samples/s | 57.1 steps/s
[Step=11150 Epoch=54.3] | Loss=0.01290 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.822 | FP-Norm(final)=2.708 | 3671.2 samples/s | 57.4 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01267 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.711 | 3956.9 samples/s | 61.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step11200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=90.5] | Loss=0.08654 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.672 | 3282.0 samples/s | 51.3 steps/s
[Step=9650 Epoch=90.9] | Loss=0.01001 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.879 | FP-Norm(final)=2.670 | 3489.9 samples/s | 54.5 steps/s
[Step=9700 Epoch=91.4] | Loss=0.00563 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.964 | FP-Norm(final)=2.674 | 4526.0 samples/s | 70.7 steps/s
[Step=9750 Epoch=91.9] | Loss=0.00381 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.967 | FP-Norm(final)=2.677 | 1514.7 samples/s | 23.7 steps/s
[Step=9800 Epoch=92.3] | Loss=0.00289 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.954 | FP-Norm(final)=2.679 | 4211.0 samples/s | 65.8 steps/s
[Step=9850 Epoch=92.8] | Loss=0.00233 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.938 | FP-Norm(final)=2.681 | 1568.4 samples/s | 24.5 steps/s
[Step=9900 Epoch=93.3] | Loss=0.00196 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.922 | FP-Norm(final)=2.683 | 3922.2 samples/s | 61.3 steps/s
[Step=9950 Epoch=93.8] | Loss=0.00169 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.906 | FP-Norm(final)=2.684 | 1602.1 samples/s | 25.0 steps/s
[Step=10000 Epoch=94.2] | Loss=0.00148 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.891 | FP-Norm(final)=2.685 | 3581.3 samples/s | 56.0 steps/s
[Step=10050 Epoch=94.7] | Loss=0.00133 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.686 | 1639.4 samples/s | 25.6 steps/s
[Step=10100 Epoch=95.2] | Loss=0.00120 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.864 | FP-Norm(final)=2.687 | 3491.7 samples/s | 54.6 steps/s
[Step=10150 Epoch=95.6] | Loss=0.00109 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.852 | FP-Norm(final)=2.688 | 1675.1 samples/s | 26.2 steps/s
[Step=10200 Epoch=96.1] | Loss=0.00101 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.840 | FP-Norm(final)=2.688 | 3533.8 samples/s | 55.2 steps/s
[Step=10250 Epoch=96.6] | Loss=0.00093 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.689 | 1692.0 samples/s | 26.4 steps/s
[Step=10300 Epoch=97.1] | Loss=0.00087 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.690 | 3512.9 samples/s | 54.9 steps/s
[Step=10350 Epoch=97.5] | Loss=0.00082 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.808 | FP-Norm(final)=2.690 | 1774.4 samples/s | 27.7 steps/s
[Step=10400 Epoch=98.0] | Loss=0.00077 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.691 | 3252.6 samples/s | 50.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step10400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=6401 Epoch=61.0] | Loss=0.06081 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.672 | 3399.5 samples/s | 53.1 steps/s
[Step=6450 Epoch=61.5] | Loss=0.00859 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.669 | 3247.2 samples/s | 50.7 steps/s
[Step=6500 Epoch=62.0] | Loss=0.00478 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.899 | FP-Norm(final)=2.673 | 4515.1 samples/s | 70.5 steps/s
[Step=6550 Epoch=62.4] | Loss=0.00325 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.906 | FP-Norm(final)=2.676 | 1493.5 samples/s | 23.3 steps/s
[Step=6600 Epoch=62.9] | Loss=0.00246 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.897 | FP-Norm(final)=2.678 | 4224.1 samples/s | 66.0 steps/s
[Step=6650 Epoch=63.4] | Loss=0.00198 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.883 | FP-Norm(final)=2.680 | 1498.2 samples/s | 23.4 steps/s
[Step=6700 Epoch=63.9] | Loss=0.00167 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.868 | FP-Norm(final)=2.681 | 3993.2 samples/s | 62.4 steps/s
[Step=6750 Epoch=64.3] | Loss=0.00144 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.854 | FP-Norm(final)=2.682 | 1544.0 samples/s | 24.1 steps/s
[Step=6800 Epoch=64.8] | Loss=0.00127 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.840 | FP-Norm(final)=2.683 | 3747.5 samples/s | 58.6 steps/s
[Step=6850 Epoch=65.3] | Loss=0.00113 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.827 | FP-Norm(final)=2.684 | 1525.3 samples/s | 23.8 steps/s
[Step=6900 Epoch=65.8] | Loss=0.00103 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.685 | 3703.6 samples/s | 57.9 steps/s
[Step=6950 Epoch=66.2] | Loss=0.00094 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.803 | FP-Norm(final)=2.686 | 1591.6 samples/s | 24.9 steps/s
[Step=7000 Epoch=66.7] | Loss=0.00086 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.792 | FP-Norm(final)=2.686 | 3503.8 samples/s | 54.7 steps/s
[Step=7050 Epoch=67.2] | Loss=0.00080 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.781 | FP-Norm(final)=2.687 | 1603.7 samples/s | 25.1 steps/s
[Step=7100 Epoch=67.7] | Loss=0.00075 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.688 | 3432.2 samples/s | 53.6 steps/s
[Step=7150 Epoch=68.1] | Loss=0.00070 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.688 | 1664.7 samples/s | 26.0 steps/s
[Step=7200 Epoch=68.6] | Loss=0.00066 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.753 | FP-Norm(final)=2.689 | 3477.7 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27896 | acc=0.8126 | tpr=0.7356 | fpr=0.0203 | 3345.5 samples/s | 13.1 steps/s
Avg test loss: 0.28634, Avg test acc: 0.81000, Avg tpr: 0.73305, Avg fpr: 0.02077, total FA: 162

Testing server on iccad2012
[Step=  50] | Loss=0.49198 | acc=0.8064 | tpr=0.9602 | fpr=0.1964 | 3442.6 samples/s | 13.4 steps/s
[Step= 100] | Loss=0.49637 | acc=0.8031 | tpr=0.9659 | fpr=0.2000 | 6409.0 samples/s | 25.0 steps/s
[Step= 150] | Loss=0.50244 | acc=0.8021 | tpr=0.9712 | fpr=0.2011 | 6414.2 samples/s | 25.1 steps/s
[Step= 200] | Loss=0.50288 | acc=0.8021 | tpr=0.9727 | fpr=0.2010 | 6692.8 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.50272 | acc=0.8022 | tpr=0.9721 | fpr=0.2009 | 6654.8 samples/s | 26.0 steps/s
[Step= 300] | Loss=0.50401 | acc=0.8020 | tpr=0.9716 | fpr=0.2011 | 6437.6 samples/s | 25.1 steps/s
[Step= 350] | Loss=0.50567 | acc=0.8023 | tpr=0.9731 | fpr=0.2008 | 6610.0 samples/s | 25.8 steps/s
[Step= 400] | Loss=0.50569 | acc=0.8022 | tpr=0.9754 | fpr=0.2010 | 6338.5 samples/s | 24.8 steps/s
[Step= 450] | Loss=0.51013 | acc=0.8016 | tpr=0.9752 | fpr=0.2015 | 6623.7 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.51122 | acc=0.8011 | tpr=0.9762 | fpr=0.2021 | 6566.5 samples/s | 25.7 steps/s
[Step= 550] | Loss=0.50867 | acc=0.8017 | tpr=0.9757 | fpr=0.2015 | 11659.6 samples/s | 45.5 steps/s
Avg test loss: 0.50886, Avg test acc: 0.80157, Avg tpr: 0.97544, Avg fpr: 0.20159, total FA: 27990

server round 21/50

clients selected: [1 2 4 5 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=46.8] | Loss=0.10604 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.700 | 3544.0 samples/s | 55.4 steps/s
[Step=9650 Epoch=47.1] | Loss=0.03887 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.652 | FP-Norm(final)=2.693 | 3459.2 samples/s | 54.0 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03389 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.740 | FP-Norm(final)=2.690 | 3676.3 samples/s | 57.4 steps/s
[Step=9750 Epoch=47.6] | Loss=0.02926 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.788 | FP-Norm(final)=2.689 | 3692.1 samples/s | 57.7 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02651 | Reg=0.00068 | acc=0.9844 | FP-Norm=0.811 | FP-Norm(final)=2.690 | 4693.7 samples/s | 73.3 steps/s
[Step=9850 Epoch=48.1] | Loss=0.02411 | Reg=0.00070 | acc=0.9844 | FP-Norm=0.824 | FP-Norm(final)=2.692 | 1550.3 samples/s | 24.2 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02163 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.831 | FP-Norm(final)=2.694 | 3612.5 samples/s | 56.4 steps/s
[Step=9950 Epoch=48.6] | Loss=0.01986 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.838 | FP-Norm(final)=2.698 | 3623.7 samples/s | 56.6 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01839 | Reg=0.00072 | acc=0.9844 | FP-Norm=0.844 | FP-Norm(final)=2.701 | 4373.8 samples/s | 68.3 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01728 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.848 | FP-Norm(final)=2.704 | 1543.4 samples/s | 24.1 steps/s
[Step=10100 Epoch=49.3] | Loss=0.01651 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.852 | FP-Norm(final)=2.707 | 3606.9 samples/s | 56.4 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01570 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.854 | FP-Norm(final)=2.710 | 3626.0 samples/s | 56.7 steps/s
[Step=10200 Epoch=49.8] | Loss=0.01487 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.857 | FP-Norm(final)=2.713 | 4202.9 samples/s | 65.7 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01401 | Reg=0.00075 | acc=0.9844 | FP-Norm=0.860 | FP-Norm(final)=2.716 | 1591.5 samples/s | 24.9 steps/s
[Step=10300 Epoch=50.3] | Loss=0.01337 | Reg=0.00075 | acc=0.9844 | FP-Norm=0.862 | FP-Norm(final)=2.720 | 3673.4 samples/s | 57.4 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01280 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.865 | FP-Norm(final)=2.723 | 3632.6 samples/s | 56.8 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01246 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.868 | FP-Norm(final)=2.726 | 4094.1 samples/s | 64.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step10400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=54.6] | Loss=0.36358 | Reg=0.00000 | acc=0.7812 | FP-Norm=0.000 | FP-Norm(final)=2.699 | 3514.1 samples/s | 54.9 steps/s
[Step=11250 Epoch=54.8] | Loss=0.04349 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.720 | FP-Norm(final)=2.690 | 3440.9 samples/s | 53.8 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03671 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.784 | FP-Norm(final)=2.688 | 3666.4 samples/s | 57.3 steps/s
[Step=11350 Epoch=55.3] | Loss=0.03167 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.811 | FP-Norm(final)=2.689 | 3594.9 samples/s | 56.2 steps/s
[Step=11400 Epoch=55.5] | Loss=0.02829 | Reg=0.00070 | acc=0.9844 | FP-Norm=0.828 | FP-Norm(final)=2.691 | 4655.7 samples/s | 72.7 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02469 | Reg=0.00071 | acc=0.9844 | FP-Norm=0.837 | FP-Norm(final)=2.694 | 1562.5 samples/s | 24.4 steps/s
[Step=11500 Epoch=56.0] | Loss=0.02206 | Reg=0.00072 | acc=0.9688 | FP-Norm=0.842 | FP-Norm(final)=2.698 | 3694.8 samples/s | 57.7 steps/s
[Step=11550 Epoch=56.3] | Loss=0.02046 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.846 | FP-Norm(final)=2.702 | 3620.0 samples/s | 56.6 steps/s
[Step=11600 Epoch=56.5] | Loss=0.01904 | Reg=0.00073 | acc=0.9844 | FP-Norm=0.850 | FP-Norm(final)=2.705 | 4399.8 samples/s | 68.7 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01776 | Reg=0.00073 | acc=0.9844 | FP-Norm=0.853 | FP-Norm(final)=2.709 | 1571.6 samples/s | 24.6 steps/s
[Step=11700 Epoch=57.0] | Loss=0.01670 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.856 | FP-Norm(final)=2.713 | 3609.2 samples/s | 56.4 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01562 | Reg=0.00074 | acc=0.9844 | FP-Norm=0.859 | FP-Norm(final)=2.716 | 3609.0 samples/s | 56.4 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01491 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.861 | FP-Norm(final)=2.720 | 4113.0 samples/s | 64.3 steps/s
[Step=11850 Epoch=57.7] | Loss=0.01424 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.863 | FP-Norm(final)=2.723 | 1622.6 samples/s | 25.4 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01358 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.866 | FP-Norm(final)=2.726 | 3685.3 samples/s | 57.6 steps/s
[Step=11950 Epoch=58.2] | Loss=0.01326 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.869 | FP-Norm(final)=2.729 | 3561.8 samples/s | 55.7 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01279 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.732 | 3951.8 samples/s | 61.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step12000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=6401 Epoch=31.4] | Loss=0.16859 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.699 | 3625.0 samples/s | 56.6 steps/s
[Step=6450 Epoch=31.6] | Loss=0.03622 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.529 | FP-Norm(final)=2.691 | 3462.5 samples/s | 54.1 steps/s
[Step=6500 Epoch=31.9] | Loss=0.03094 | Reg=0.00041 | acc=0.9688 | FP-Norm=0.620 | FP-Norm(final)=2.689 | 3631.2 samples/s | 56.7 steps/s
[Step=6550 Epoch=32.1] | Loss=0.02763 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.665 | FP-Norm(final)=2.689 | 3632.9 samples/s | 56.8 steps/s
[Step=6600 Epoch=32.4] | Loss=0.02524 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.694 | FP-Norm(final)=2.690 | 4674.8 samples/s | 73.0 steps/s
[Step=6650 Epoch=32.6] | Loss=0.02172 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.718 | FP-Norm(final)=2.693 | 1547.8 samples/s | 24.2 steps/s
[Step=6700 Epoch=32.9] | Loss=0.01944 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.731 | FP-Norm(final)=2.696 | 3580.2 samples/s | 55.9 steps/s
[Step=6750 Epoch=33.1] | Loss=0.01778 | Reg=0.00056 | acc=0.9688 | FP-Norm=0.738 | FP-Norm(final)=2.699 | 3612.5 samples/s | 56.4 steps/s
[Step=6800 Epoch=33.3] | Loss=0.01671 | Reg=0.00056 | acc=0.9688 | FP-Norm=0.744 | FP-Norm(final)=2.702 | 4478.5 samples/s | 70.0 steps/s
[Step=6850 Epoch=33.6] | Loss=0.01559 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.750 | FP-Norm(final)=2.705 | 1564.1 samples/s | 24.4 steps/s
[Step=6900 Epoch=33.8] | Loss=0.01471 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.755 | FP-Norm(final)=2.708 | 3619.9 samples/s | 56.6 steps/s
[Step=6950 Epoch=34.1] | Loss=0.01397 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.761 | FP-Norm(final)=2.711 | 3641.1 samples/s | 56.9 steps/s
[Step=7000 Epoch=34.3] | Loss=0.01350 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.766 | FP-Norm(final)=2.713 | 4360.4 samples/s | 68.1 steps/s
[Step=7050 Epoch=34.6] | Loss=0.01288 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.771 | FP-Norm(final)=2.716 | 1595.0 samples/s | 24.9 steps/s
[Step=7100 Epoch=34.8] | Loss=0.01225 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.776 | FP-Norm(final)=2.718 | 3600.5 samples/s | 56.3 steps/s
[Step=7150 Epoch=35.1] | Loss=0.01179 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.721 | 3649.7 samples/s | 57.0 steps/s
[Step=7200 Epoch=35.3] | Loss=0.01151 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.783 | FP-Norm(final)=2.723 | 4171.0 samples/s | 65.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step7200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=98.6] | Loss=0.08235 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.700 | 3580.0 samples/s | 55.9 steps/s
[Step=10450 Epoch=99.0] | Loss=0.01151 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.933 | FP-Norm(final)=2.695 | 3281.9 samples/s | 51.3 steps/s
[Step=10500 Epoch=99.5] | Loss=0.00645 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.021 | FP-Norm(final)=2.696 | 4526.6 samples/s | 70.7 steps/s
[Step=10550 Epoch=100.0] | Loss=0.00436 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.021 | FP-Norm(final)=2.698 | 1508.0 samples/s | 23.6 steps/s
[Step=10600 Epoch=100.4] | Loss=0.00330 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.005 | FP-Norm(final)=2.700 | 4195.9 samples/s | 65.6 steps/s
[Step=10650 Epoch=100.9] | Loss=0.00265 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.986 | FP-Norm(final)=2.701 | 1520.2 samples/s | 23.8 steps/s
[Step=10700 Epoch=101.4] | Loss=0.00223 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.967 | FP-Norm(final)=2.703 | 4024.0 samples/s | 62.9 steps/s
[Step=10750 Epoch=101.9] | Loss=0.00192 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.949 | FP-Norm(final)=2.704 | 1581.6 samples/s | 24.7 steps/s
[Step=10800 Epoch=102.3] | Loss=0.00169 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.932 | FP-Norm(final)=2.705 | 3772.6 samples/s | 58.9 steps/s
[Step=10850 Epoch=102.8] | Loss=0.00151 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.916 | FP-Norm(final)=2.705 | 1603.8 samples/s | 25.1 steps/s
[Step=10900 Epoch=103.3] | Loss=0.00136 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.901 | FP-Norm(final)=2.706 | 3624.5 samples/s | 56.6 steps/s
[Step=10950 Epoch=103.8] | Loss=0.00124 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.887 | FP-Norm(final)=2.707 | 1635.3 samples/s | 25.6 steps/s
[Step=11000 Epoch=104.2] | Loss=0.00114 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.874 | FP-Norm(final)=2.708 | 3471.4 samples/s | 54.2 steps/s
[Step=11050 Epoch=104.7] | Loss=0.00106 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.861 | FP-Norm(final)=2.708 | 1669.8 samples/s | 26.1 steps/s
[Step=11100 Epoch=105.2] | Loss=0.00099 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.849 | FP-Norm(final)=2.709 | 3532.2 samples/s | 55.2 steps/s
[Step=11150 Epoch=105.7] | Loss=0.00092 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.838 | FP-Norm(final)=2.710 | 1671.6 samples/s | 26.1 steps/s
[Step=11200 Epoch=106.1] | Loss=0.00087 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.827 | FP-Norm(final)=2.710 | 3449.6 samples/s | 53.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step11200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=98.0] | Loss=0.07309 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.700 | 3454.7 samples/s | 54.0 steps/s
[Step=10450 Epoch=98.5] | Loss=0.01179 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.951 | FP-Norm(final)=2.694 | 3102.0 samples/s | 48.5 steps/s
[Step=10500 Epoch=98.9] | Loss=0.00633 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.043 | FP-Norm(final)=2.697 | 4455.8 samples/s | 69.6 steps/s
[Step=10550 Epoch=99.4] | Loss=0.00428 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.043 | FP-Norm(final)=2.700 | 1513.2 samples/s | 23.6 steps/s
[Step=10600 Epoch=99.9] | Loss=0.00324 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.027 | FP-Norm(final)=2.702 | 4195.3 samples/s | 65.6 steps/s
[Step=10650 Epoch=100.4] | Loss=0.00261 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.008 | FP-Norm(final)=2.703 | 1530.0 samples/s | 23.9 steps/s
[Step=10700 Epoch=100.8] | Loss=0.00218 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.989 | FP-Norm(final)=2.705 | 3878.0 samples/s | 60.6 steps/s
[Step=10750 Epoch=101.3] | Loss=0.00188 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.972 | FP-Norm(final)=2.706 | 1575.6 samples/s | 24.6 steps/s
[Step=10800 Epoch=101.8] | Loss=0.00165 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.955 | FP-Norm(final)=2.707 | 3598.0 samples/s | 56.2 steps/s
[Step=10850 Epoch=102.2] | Loss=0.00148 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.940 | FP-Norm(final)=2.708 | 1655.1 samples/s | 25.9 steps/s
[Step=10900 Epoch=102.7] | Loss=0.00133 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.925 | FP-Norm(final)=2.709 | 3525.6 samples/s | 55.1 steps/s
[Step=10950 Epoch=103.2] | Loss=0.00122 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.912 | FP-Norm(final)=2.710 | 1659.8 samples/s | 25.9 steps/s
[Step=11000 Epoch=103.7] | Loss=0.00112 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.899 | FP-Norm(final)=2.710 | 3411.6 samples/s | 53.3 steps/s
[Step=11050 Epoch=104.1] | Loss=0.00104 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.887 | FP-Norm(final)=2.711 | 1641.4 samples/s | 25.6 steps/s
[Step=11100 Epoch=104.6] | Loss=0.00097 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.876 | FP-Norm(final)=2.712 | 3425.6 samples/s | 53.5 steps/s
[Step=11150 Epoch=105.1] | Loss=0.00090 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.865 | FP-Norm(final)=2.712 | 1721.0 samples/s | 26.9 steps/s
[Step=11200 Epoch=105.5] | Loss=0.00085 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.854 | FP-Norm(final)=2.713 | 3185.8 samples/s | 49.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29414 | acc=0.8098 | tpr=0.7304 | fpr=0.0178 | 3449.0 samples/s | 13.5 steps/s
Avg test loss: 0.30215, Avg test acc: 0.80708, Avg tpr: 0.72810, Avg fpr: 0.01923, total FA: 150

Testing server on iccad2012
[Step=  50] | Loss=0.47642 | acc=0.8173 | tpr=0.9646 | fpr=0.1853 | 3460.6 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.48008 | acc=0.8143 | tpr=0.9680 | fpr=0.1886 | 6709.1 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.48613 | acc=0.8132 | tpr=0.9741 | fpr=0.1897 | 6871.3 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.48679 | acc=0.8136 | tpr=0.9760 | fpr=0.1894 | 6217.8 samples/s | 24.3 steps/s
[Step= 250] | Loss=0.48660 | acc=0.8136 | tpr=0.9764 | fpr=0.1894 | 6389.6 samples/s | 25.0 steps/s
[Step= 300] | Loss=0.48779 | acc=0.8133 | tpr=0.9760 | fpr=0.1896 | 6572.1 samples/s | 25.7 steps/s
[Step= 350] | Loss=0.48954 | acc=0.8134 | tpr=0.9768 | fpr=0.1895 | 6488.2 samples/s | 25.3 steps/s
[Step= 400] | Loss=0.48965 | acc=0.8134 | tpr=0.9787 | fpr=0.1896 | 6305.0 samples/s | 24.6 steps/s
[Step= 450] | Loss=0.49423 | acc=0.8131 | tpr=0.9781 | fpr=0.1899 | 6150.9 samples/s | 24.0 steps/s
[Step= 500] | Loss=0.49524 | acc=0.8126 | tpr=0.9784 | fpr=0.1904 | 6669.6 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.49272 | acc=0.8133 | tpr=0.9789 | fpr=0.1898 | 11712.9 samples/s | 45.8 steps/s
Avg test loss: 0.49288, Avg test acc: 0.81310, Avg tpr: 0.97861, Avg fpr: 0.18991, total FA: 26369

server round 22/50

clients selected: [0 2 4 5 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=6401 Epoch=31.2] | Loss=0.25170 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.723 | 3461.7 samples/s | 54.1 steps/s
[Step=6450 Epoch=31.5] | Loss=0.03612 | Reg=0.00040 | acc=0.9844 | FP-Norm=0.609 | FP-Norm(final)=2.717 | 3548.9 samples/s | 55.5 steps/s
[Step=6500 Epoch=31.7] | Loss=0.02902 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.688 | FP-Norm(final)=2.716 | 3687.0 samples/s | 57.6 steps/s
[Step=6550 Epoch=31.9] | Loss=0.02654 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.729 | FP-Norm(final)=2.716 | 3529.1 samples/s | 55.1 steps/s
[Step=6600 Epoch=32.2] | Loss=0.02553 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.753 | FP-Norm(final)=2.717 | 4473.6 samples/s | 69.9 steps/s
[Step=6650 Epoch=32.4] | Loss=0.02369 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.718 | 1539.3 samples/s | 24.1 steps/s
[Step=6700 Epoch=32.7] | Loss=0.02141 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.720 | 3577.4 samples/s | 55.9 steps/s
[Step=6750 Epoch=32.9] | Loss=0.01997 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.794 | FP-Norm(final)=2.722 | 3601.1 samples/s | 56.3 steps/s
[Step=6800 Epoch=33.2] | Loss=0.01844 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.800 | FP-Norm(final)=2.724 | 4348.6 samples/s | 67.9 steps/s
[Step=6850 Epoch=33.4] | Loss=0.01784 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.727 | 1581.2 samples/s | 24.7 steps/s
[Step=6900 Epoch=33.6] | Loss=0.01668 | Reg=0.00070 | acc=0.9688 | FP-Norm=0.828 | FP-Norm(final)=2.729 | 3636.6 samples/s | 56.8 steps/s
[Step=6950 Epoch=33.9] | Loss=0.01599 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.838 | FP-Norm(final)=2.732 | 3626.1 samples/s | 56.7 steps/s
[Step=7000 Epoch=34.1] | Loss=0.01567 | Reg=0.00073 | acc=0.9844 | FP-Norm=0.846 | FP-Norm(final)=2.734 | 4116.7 samples/s | 64.3 steps/s
[Step=7050 Epoch=34.4] | Loss=0.01489 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.853 | FP-Norm(final)=2.737 | 1589.2 samples/s | 24.8 steps/s
[Step=7100 Epoch=34.6] | Loss=0.01431 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.859 | FP-Norm(final)=2.739 | 3665.0 samples/s | 57.3 steps/s
[Step=7150 Epoch=34.9] | Loss=0.01418 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.864 | FP-Norm(final)=2.741 | 3645.6 samples/s | 57.0 steps/s
[Step=7200 Epoch=35.1] | Loss=0.01373 | Reg=0.00076 | acc=0.9688 | FP-Norm=0.868 | FP-Norm(final)=2.743 | 3972.5 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step7200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=58.5] | Loss=0.16668 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.723 | 3539.4 samples/s | 55.3 steps/s
[Step=12050 Epoch=58.7] | Loss=0.04791 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.703 | FP-Norm(final)=2.711 | 3513.8 samples/s | 54.9 steps/s
[Step=12100 Epoch=59.0] | Loss=0.03587 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.781 | FP-Norm(final)=2.708 | 3676.9 samples/s | 57.5 steps/s
[Step=12150 Epoch=59.2] | Loss=0.03203 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.803 | FP-Norm(final)=2.710 | 3685.0 samples/s | 57.6 steps/s
[Step=12200 Epoch=59.4] | Loss=0.02841 | Reg=0.00069 | acc=0.9844 | FP-Norm=0.821 | FP-Norm(final)=2.712 | 4693.8 samples/s | 73.3 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02483 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.833 | FP-Norm(final)=2.715 | 1543.4 samples/s | 24.1 steps/s
[Step=12300 Epoch=59.9] | Loss=0.02219 | Reg=0.00072 | acc=0.9844 | FP-Norm=0.841 | FP-Norm(final)=2.718 | 3606.8 samples/s | 56.4 steps/s
[Step=12350 Epoch=60.2] | Loss=0.02045 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.845 | FP-Norm(final)=2.722 | 3688.5 samples/s | 57.6 steps/s
[Step=12400 Epoch=60.4] | Loss=0.01888 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.848 | FP-Norm(final)=2.726 | 4421.5 samples/s | 69.1 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01767 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.851 | FP-Norm(final)=2.729 | 1593.4 samples/s | 24.9 steps/s
[Step=12500 Epoch=60.9] | Loss=0.01640 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.854 | FP-Norm(final)=2.733 | 3606.3 samples/s | 56.3 steps/s
[Step=12550 Epoch=61.1] | Loss=0.01563 | Reg=0.00074 | acc=0.9844 | FP-Norm=0.856 | FP-Norm(final)=2.736 | 3622.7 samples/s | 56.6 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01499 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.859 | FP-Norm(final)=2.739 | 4166.2 samples/s | 65.1 steps/s
[Step=12650 Epoch=61.6] | Loss=0.01421 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.861 | FP-Norm(final)=2.742 | 1631.0 samples/s | 25.5 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01367 | Reg=0.00075 | acc=0.9844 | FP-Norm=0.863 | FP-Norm(final)=2.746 | 3699.9 samples/s | 57.8 steps/s
[Step=12750 Epoch=62.1] | Loss=0.01315 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.866 | FP-Norm(final)=2.749 | 3713.0 samples/s | 58.0 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01286 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.869 | FP-Norm(final)=2.751 | 3978.1 samples/s | 62.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step12800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=7201 Epoch=35.3] | Loss=0.19933 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.723 | 3602.7 samples/s | 56.3 steps/s
[Step=7250 Epoch=35.6] | Loss=0.04467 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.650 | FP-Norm(final)=2.713 | 3585.6 samples/s | 56.0 steps/s
[Step=7300 Epoch=35.8] | Loss=0.03528 | Reg=0.00057 | acc=0.9688 | FP-Norm=0.735 | FP-Norm(final)=2.710 | 3601.2 samples/s | 56.3 steps/s
[Step=7350 Epoch=36.0] | Loss=0.03026 | Reg=0.00061 | acc=0.9844 | FP-Norm=0.767 | FP-Norm(final)=2.710 | 3615.4 samples/s | 56.5 steps/s
[Step=7400 Epoch=36.3] | Loss=0.02633 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.787 | FP-Norm(final)=2.711 | 4762.2 samples/s | 74.4 steps/s
[Step=7450 Epoch=36.5] | Loss=0.02247 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.797 | FP-Norm(final)=2.714 | 1550.8 samples/s | 24.2 steps/s
[Step=7500 Epoch=36.8] | Loss=0.02036 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.717 | 3693.1 samples/s | 57.7 steps/s
[Step=7550 Epoch=37.0] | Loss=0.01865 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.804 | FP-Norm(final)=2.720 | 3677.7 samples/s | 57.5 steps/s
[Step=7600 Epoch=37.3] | Loss=0.01738 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.723 | 4598.4 samples/s | 71.8 steps/s
[Step=7650 Epoch=37.5] | Loss=0.01609 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.810 | FP-Norm(final)=2.726 | 1557.7 samples/s | 24.3 steps/s
[Step=7700 Epoch=37.8] | Loss=0.01510 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.729 | 3612.2 samples/s | 56.4 steps/s
[Step=7750 Epoch=38.0] | Loss=0.01430 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.732 | 3643.2 samples/s | 56.9 steps/s
[Step=7800 Epoch=38.2] | Loss=0.01375 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.734 | 4328.0 samples/s | 67.6 steps/s
[Step=7850 Epoch=38.5] | Loss=0.01327 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.821 | FP-Norm(final)=2.737 | 1581.6 samples/s | 24.7 steps/s
[Step=7900 Epoch=38.7] | Loss=0.01291 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.823 | FP-Norm(final)=2.739 | 3626.1 samples/s | 56.7 steps/s
[Step=7950 Epoch=39.0] | Loss=0.01237 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.824 | FP-Norm(final)=2.741 | 3678.4 samples/s | 57.5 steps/s
[Step=8000 Epoch=39.2] | Loss=0.01195 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.827 | FP-Norm(final)=2.743 | 4244.6 samples/s | 66.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step8000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=106.1] | Loss=0.06669 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.724 | 3533.0 samples/s | 55.2 steps/s
[Step=11250 Epoch=106.6] | Loss=0.00937 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.941 | FP-Norm(final)=2.720 | 3243.2 samples/s | 50.7 steps/s
[Step=11300 Epoch=107.1] | Loss=0.00521 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.004 | FP-Norm(final)=2.722 | 4518.5 samples/s | 70.6 steps/s
[Step=11350 Epoch=107.6] | Loss=0.00352 | Reg=0.00103 | acc=1.0000 | FP-Norm=0.998 | FP-Norm(final)=2.724 | 1528.9 samples/s | 23.9 steps/s
[Step=11400 Epoch=108.0] | Loss=0.00267 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.981 | FP-Norm(final)=2.726 | 4284.5 samples/s | 66.9 steps/s
[Step=11450 Epoch=108.5] | Loss=0.00214 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.963 | FP-Norm(final)=2.727 | 1560.1 samples/s | 24.4 steps/s
[Step=11500 Epoch=109.0] | Loss=0.00179 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.944 | FP-Norm(final)=2.728 | 3927.2 samples/s | 61.4 steps/s
[Step=11550 Epoch=109.4] | Loss=0.00154 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.927 | FP-Norm(final)=2.729 | 1579.3 samples/s | 24.7 steps/s
[Step=11600 Epoch=109.9] | Loss=0.00136 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.910 | FP-Norm(final)=2.729 | 3699.8 samples/s | 57.8 steps/s
[Step=11650 Epoch=110.4] | Loss=0.00121 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.894 | FP-Norm(final)=2.730 | 1612.9 samples/s | 25.2 steps/s
[Step=11700 Epoch=110.9] | Loss=0.00109 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.879 | FP-Norm(final)=2.731 | 3558.2 samples/s | 55.6 steps/s
[Step=11750 Epoch=111.3] | Loss=0.00100 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.866 | FP-Norm(final)=2.731 | 1663.4 samples/s | 26.0 steps/s
[Step=11800 Epoch=111.8] | Loss=0.00092 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.853 | FP-Norm(final)=2.732 | 3419.2 samples/s | 53.4 steps/s
[Step=11850 Epoch=112.3] | Loss=0.00085 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.840 | FP-Norm(final)=2.732 | 1655.7 samples/s | 25.9 steps/s
[Step=11900 Epoch=112.8] | Loss=0.00079 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.733 | 3629.4 samples/s | 56.7 steps/s
[Step=11950 Epoch=113.2] | Loss=0.00074 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.817 | FP-Norm(final)=2.733 | 1695.6 samples/s | 26.5 steps/s
[Step=12000 Epoch=113.7] | Loss=0.00070 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.734 | 3542.7 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step12000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=105.5] | Loss=0.01561 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.724 | 3705.6 samples/s | 57.9 steps/s
[Step=11250 Epoch=106.0] | Loss=0.00781 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.842 | FP-Norm(final)=2.725 | 3266.1 samples/s | 51.0 steps/s
[Step=11300 Epoch=106.5] | Loss=0.00437 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.946 | FP-Norm(final)=2.729 | 4555.0 samples/s | 71.2 steps/s
[Step=11350 Epoch=106.9] | Loss=0.00297 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.959 | FP-Norm(final)=2.732 | 1480.8 samples/s | 23.1 steps/s
[Step=11400 Epoch=107.4] | Loss=0.00228 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.951 | FP-Norm(final)=2.733 | 4205.5 samples/s | 65.7 steps/s
[Step=11450 Epoch=107.9] | Loss=0.00184 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.939 | FP-Norm(final)=2.735 | 1501.4 samples/s | 23.5 steps/s
[Step=11500 Epoch=108.4] | Loss=0.00154 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.925 | FP-Norm(final)=2.736 | 3931.6 samples/s | 61.4 steps/s
[Step=11550 Epoch=108.8] | Loss=0.00133 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.910 | FP-Norm(final)=2.737 | 1597.6 samples/s | 25.0 steps/s
[Step=11600 Epoch=109.3] | Loss=0.00117 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.896 | FP-Norm(final)=2.738 | 3598.1 samples/s | 56.2 steps/s
[Step=11650 Epoch=109.8] | Loss=0.00104 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.883 | FP-Norm(final)=2.738 | 1616.1 samples/s | 25.3 steps/s
[Step=11700 Epoch=110.2] | Loss=0.00094 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.739 | 3441.0 samples/s | 53.8 steps/s
[Step=11750 Epoch=110.7] | Loss=0.00086 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.859 | FP-Norm(final)=2.740 | 1669.6 samples/s | 26.1 steps/s
[Step=11800 Epoch=111.2] | Loss=0.00079 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.847 | FP-Norm(final)=2.740 | 3532.7 samples/s | 55.2 steps/s
[Step=11850 Epoch=111.7] | Loss=0.00073 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.836 | FP-Norm(final)=2.741 | 1675.7 samples/s | 26.2 steps/s
[Step=11900 Epoch=112.1] | Loss=0.00068 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.741 | 3432.4 samples/s | 53.6 steps/s
[Step=11950 Epoch=112.6] | Loss=0.00064 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.741 | 1707.2 samples/s | 26.7 steps/s
[Step=12000 Epoch=113.1] | Loss=0.00060 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.742 | 3321.4 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28400 | acc=0.8159 | tpr=0.7405 | fpr=0.0206 | 3477.5 samples/s | 13.6 steps/s
Avg test loss: 0.29128, Avg test acc: 0.81248, Avg tpr: 0.73690, Avg fpr: 0.02128, total FA: 166

Testing server on iccad2012
[Step=  50] | Loss=0.50255 | acc=0.8080 | tpr=0.9646 | fpr=0.1948 | 3491.5 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.50603 | acc=0.8048 | tpr=0.9701 | fpr=0.1982 | 6467.5 samples/s | 25.3 steps/s
[Step= 150] | Loss=0.51232 | acc=0.8039 | tpr=0.9769 | fpr=0.1993 | 6616.8 samples/s | 25.8 steps/s
[Step= 200] | Loss=0.51278 | acc=0.8043 | tpr=0.9781 | fpr=0.1989 | 6611.6 samples/s | 25.8 steps/s
[Step= 250] | Loss=0.51266 | acc=0.8045 | tpr=0.9782 | fpr=0.1986 | 6543.4 samples/s | 25.6 steps/s
[Step= 300] | Loss=0.51399 | acc=0.8043 | tpr=0.9782 | fpr=0.1988 | 6177.7 samples/s | 24.1 steps/s
[Step= 350] | Loss=0.51583 | acc=0.8044 | tpr=0.9787 | fpr=0.1987 | 6679.9 samples/s | 26.1 steps/s
[Step= 400] | Loss=0.51606 | acc=0.8044 | tpr=0.9803 | fpr=0.1988 | 6135.1 samples/s | 24.0 steps/s
[Step= 450] | Loss=0.52078 | acc=0.8041 | tpr=0.9800 | fpr=0.1991 | 6156.0 samples/s | 24.0 steps/s
[Step= 500] | Loss=0.52173 | acc=0.8033 | tpr=0.9802 | fpr=0.1999 | 6055.1 samples/s | 23.7 steps/s
[Step= 550] | Loss=0.51911 | acc=0.8040 | tpr=0.9801 | fpr=0.1992 | 11571.1 samples/s | 45.2 steps/s
Avg test loss: 0.51934, Avg test acc: 0.80379, Avg tpr: 0.97979, Avg fpr: 0.19941, total FA: 27687

server round 23/50

clients selected: [1 2 5 6 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=50.8] | Loss=0.20400 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.733 | 3591.6 samples/s | 56.1 steps/s
[Step=10450 Epoch=51.0] | Loss=0.04204 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.716 | FP-Norm(final)=2.723 | 3537.3 samples/s | 55.3 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03285 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.791 | FP-Norm(final)=2.721 | 3581.9 samples/s | 56.0 steps/s
[Step=10550 Epoch=51.5] | Loss=0.03038 | Reg=0.00069 | acc=0.9688 | FP-Norm=0.816 | FP-Norm(final)=2.720 | 3618.8 samples/s | 56.5 steps/s
[Step=10600 Epoch=51.7] | Loss=0.02753 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.837 | FP-Norm(final)=2.720 | 4682.9 samples/s | 73.2 steps/s
[Step=10650 Epoch=52.0] | Loss=0.02409 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.853 | FP-Norm(final)=2.721 | 1559.2 samples/s | 24.4 steps/s
[Step=10700 Epoch=52.2] | Loss=0.02128 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.861 | FP-Norm(final)=2.723 | 3662.1 samples/s | 57.2 steps/s
[Step=10750 Epoch=52.5] | Loss=0.01975 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.864 | FP-Norm(final)=2.725 | 3695.2 samples/s | 57.7 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01879 | Reg=0.00076 | acc=0.9844 | FP-Norm=0.868 | FP-Norm(final)=2.728 | 4309.5 samples/s | 67.3 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01752 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.730 | 1566.7 samples/s | 24.5 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01641 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.872 | FP-Norm(final)=2.733 | 3623.2 samples/s | 56.6 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01586 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.874 | FP-Norm(final)=2.735 | 3636.9 samples/s | 56.8 steps/s
[Step=11000 Epoch=53.7] | Loss=0.01517 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.737 | 4221.3 samples/s | 66.0 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01441 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.879 | FP-Norm(final)=2.739 | 1594.1 samples/s | 24.9 steps/s
[Step=11100 Epoch=54.2] | Loss=0.01380 | Reg=0.00078 | acc=0.9844 | FP-Norm=0.881 | FP-Norm(final)=2.742 | 3630.2 samples/s | 56.7 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01339 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.883 | FP-Norm(final)=2.744 | 3602.3 samples/s | 56.3 steps/s
[Step=11200 Epoch=54.7] | Loss=0.01297 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.886 | FP-Norm(final)=2.746 | 4030.0 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step11200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12801 Epoch=62.4] | Loss=0.06804 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.733 | 3461.8 samples/s | 54.1 steps/s
[Step=12850 Epoch=62.6] | Loss=0.03892 | Reg=0.00046 | acc=0.9844 | FP-Norm=0.646 | FP-Norm(final)=2.724 | 3420.7 samples/s | 53.4 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03278 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.738 | FP-Norm(final)=2.722 | 3474.6 samples/s | 54.3 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02850 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.782 | FP-Norm(final)=2.722 | 3563.1 samples/s | 55.7 steps/s
[Step=13000 Epoch=63.3] | Loss=0.02557 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.802 | FP-Norm(final)=2.724 | 4742.5 samples/s | 74.1 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02276 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.726 | 1546.7 samples/s | 24.2 steps/s
[Step=13100 Epoch=63.8] | Loss=0.02029 | Reg=0.00070 | acc=0.9844 | FP-Norm=0.827 | FP-Norm(final)=2.730 | 3671.5 samples/s | 57.4 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01879 | Reg=0.00070 | acc=0.9688 | FP-Norm=0.832 | FP-Norm(final)=2.733 | 3617.2 samples/s | 56.5 steps/s
[Step=13200 Epoch=64.3] | Loss=0.01777 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.836 | FP-Norm(final)=2.736 | 4341.3 samples/s | 67.8 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01664 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.839 | FP-Norm(final)=2.740 | 1570.4 samples/s | 24.5 steps/s
[Step=13300 Epoch=64.8] | Loss=0.01546 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.841 | FP-Norm(final)=2.743 | 3611.5 samples/s | 56.4 steps/s
[Step=13350 Epoch=65.0] | Loss=0.01474 | Reg=0.00072 | acc=0.9844 | FP-Norm=0.844 | FP-Norm(final)=2.746 | 3614.2 samples/s | 56.5 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01413 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.845 | FP-Norm(final)=2.749 | 4098.2 samples/s | 64.0 steps/s
[Step=13450 Epoch=65.5] | Loss=0.01342 | Reg=0.00072 | acc=0.9844 | FP-Norm=0.847 | FP-Norm(final)=2.752 | 1608.8 samples/s | 25.1 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01272 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.849 | FP-Norm(final)=2.754 | 3693.3 samples/s | 57.7 steps/s
[Step=13550 Epoch=66.0] | Loss=0.01238 | Reg=0.00073 | acc=0.9844 | FP-Norm=0.851 | FP-Norm(final)=2.757 | 3623.1 samples/s | 56.6 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01201 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.853 | FP-Norm(final)=2.760 | 3956.9 samples/s | 61.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step13600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=113.7] | Loss=0.10081 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.733 | 3602.9 samples/s | 56.3 steps/s
[Step=12050 Epoch=114.2] | Loss=0.01000 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.029 | FP-Norm(final)=2.730 | 3207.0 samples/s | 50.1 steps/s
[Step=12100 Epoch=114.7] | Loss=0.00546 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.086 | FP-Norm(final)=2.732 | 4341.2 samples/s | 67.8 steps/s
[Step=12150 Epoch=115.1] | Loss=0.00370 | Reg=0.00119 | acc=1.0000 | FP-Norm=1.075 | FP-Norm(final)=2.735 | 1419.5 samples/s | 22.2 steps/s
[Step=12200 Epoch=115.6] | Loss=0.00281 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.054 | FP-Norm(final)=2.736 | 3957.4 samples/s | 61.8 steps/s
[Step=12250 Epoch=116.1] | Loss=0.00227 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.033 | FP-Norm(final)=2.738 | 1452.4 samples/s | 22.7 steps/s
[Step=12300 Epoch=116.6] | Loss=0.00190 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.013 | FP-Norm(final)=2.739 | 3692.0 samples/s | 57.7 steps/s
[Step=12350 Epoch=117.0] | Loss=0.00164 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.993 | FP-Norm(final)=2.740 | 1497.8 samples/s | 23.4 steps/s
[Step=12400 Epoch=117.5] | Loss=0.00144 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.976 | FP-Norm(final)=2.741 | 3579.3 samples/s | 55.9 steps/s
[Step=12450 Epoch=118.0] | Loss=0.00129 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.959 | FP-Norm(final)=2.742 | 1650.8 samples/s | 25.8 steps/s
[Step=12500 Epoch=118.4] | Loss=0.00117 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.943 | FP-Norm(final)=2.743 | 3582.1 samples/s | 56.0 steps/s
[Step=12550 Epoch=118.9] | Loss=0.00107 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.929 | FP-Norm(final)=2.743 | 1673.9 samples/s | 26.2 steps/s
[Step=12600 Epoch=119.4] | Loss=0.00098 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.915 | FP-Norm(final)=2.744 | 3569.2 samples/s | 55.8 steps/s
[Step=12650 Epoch=119.9] | Loss=0.00091 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.902 | FP-Norm(final)=2.744 | 1695.3 samples/s | 26.5 steps/s
[Step=12700 Epoch=120.3] | Loss=0.00085 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.890 | FP-Norm(final)=2.745 | 3492.8 samples/s | 54.6 steps/s
[Step=12750 Epoch=120.8] | Loss=0.00079 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.878 | FP-Norm(final)=2.745 | 1694.2 samples/s | 26.5 steps/s
[Step=12800 Epoch=121.3] | Loss=0.00075 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.867 | FP-Norm(final)=2.746 | 3570.8 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step12800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=5601 Epoch=53.3] | Loss=0.13978 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.733 | 3514.4 samples/s | 54.9 steps/s
[Step=5650 Epoch=53.7] | Loss=0.01318 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.935 | FP-Norm(final)=2.724 | 3290.6 samples/s | 51.4 steps/s
[Step=5700 Epoch=54.2] | Loss=0.00733 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.013 | FP-Norm(final)=2.727 | 4580.5 samples/s | 71.6 steps/s
[Step=5750 Epoch=54.7] | Loss=0.00495 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.009 | FP-Norm(final)=2.729 | 1520.3 samples/s | 23.8 steps/s
[Step=5800 Epoch=55.2] | Loss=0.00374 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.990 | FP-Norm(final)=2.731 | 4297.5 samples/s | 67.1 steps/s
[Step=5850 Epoch=55.6] | Loss=0.00301 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.970 | FP-Norm(final)=2.733 | 1561.7 samples/s | 24.4 steps/s
[Step=5900 Epoch=56.1] | Loss=0.00252 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.951 | FP-Norm(final)=2.734 | 4013.7 samples/s | 62.7 steps/s
[Step=5950 Epoch=56.6] | Loss=0.00217 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.932 | FP-Norm(final)=2.735 | 1584.3 samples/s | 24.8 steps/s
[Step=6000 Epoch=57.1] | Loss=0.00191 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.915 | FP-Norm(final)=2.736 | 3835.1 samples/s | 59.9 steps/s
[Step=6050 Epoch=57.6] | Loss=0.00170 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.899 | FP-Norm(final)=2.737 | 1637.4 samples/s | 25.6 steps/s
[Step=6100 Epoch=58.0] | Loss=0.00154 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.884 | FP-Norm(final)=2.738 | 3639.9 samples/s | 56.9 steps/s
[Step=6150 Epoch=58.5] | Loss=0.00140 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.739 | 1687.1 samples/s | 26.4 steps/s
[Step=6200 Epoch=59.0] | Loss=0.00129 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.858 | FP-Norm(final)=2.739 | 3558.5 samples/s | 55.6 steps/s
[Step=6250 Epoch=59.5] | Loss=0.00119 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.845 | FP-Norm(final)=2.740 | 1683.7 samples/s | 26.3 steps/s
[Step=6300 Epoch=59.9] | Loss=0.00111 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.834 | FP-Norm(final)=2.740 | 3570.0 samples/s | 55.8 steps/s
[Step=6350 Epoch=60.4] | Loss=0.00104 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.823 | FP-Norm(final)=2.741 | 1687.4 samples/s | 26.4 steps/s
[Step=6400 Epoch=60.9] | Loss=0.00098 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.742 | 3397.4 samples/s | 53.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step6400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=76.4] | Loss=0.15074 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.733 | 3225.4 samples/s | 50.4 steps/s
[Step=8050 Epoch=76.9] | Loss=0.00945 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.903 | FP-Norm(final)=2.731 | 3480.3 samples/s | 54.4 steps/s
[Step=8100 Epoch=77.4] | Loss=0.00510 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.982 | FP-Norm(final)=2.734 | 4619.3 samples/s | 72.2 steps/s
[Step=8150 Epoch=77.8] | Loss=0.00343 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.979 | FP-Norm(final)=2.736 | 1510.4 samples/s | 23.6 steps/s
[Step=8200 Epoch=78.3] | Loss=0.00259 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.962 | FP-Norm(final)=2.737 | 4382.2 samples/s | 68.5 steps/s
[Step=8250 Epoch=78.8] | Loss=0.00208 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.943 | FP-Norm(final)=2.738 | 1548.8 samples/s | 24.2 steps/s
[Step=8300 Epoch=79.3] | Loss=0.00174 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.924 | FP-Norm(final)=2.739 | 4117.3 samples/s | 64.3 steps/s
[Step=8350 Epoch=79.7] | Loss=0.00150 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.906 | FP-Norm(final)=2.740 | 1585.3 samples/s | 24.8 steps/s
[Step=8400 Epoch=80.2] | Loss=0.00132 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.889 | FP-Norm(final)=2.741 | 3987.3 samples/s | 62.3 steps/s
[Step=8450 Epoch=80.7] | Loss=0.00117 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.873 | FP-Norm(final)=2.741 | 1601.1 samples/s | 25.0 steps/s
[Step=8500 Epoch=81.2] | Loss=0.00106 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.858 | FP-Norm(final)=2.742 | 3768.5 samples/s | 58.9 steps/s
[Step=8550 Epoch=81.6] | Loss=0.00097 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.844 | FP-Norm(final)=2.742 | 1656.2 samples/s | 25.9 steps/s
[Step=8600 Epoch=82.1] | Loss=0.00089 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.831 | FP-Norm(final)=2.743 | 3574.6 samples/s | 55.9 steps/s
[Step=8650 Epoch=82.6] | Loss=0.00082 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.819 | FP-Norm(final)=2.743 | 1673.3 samples/s | 26.1 steps/s
[Step=8700 Epoch=83.1] | Loss=0.00077 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.743 | 3576.4 samples/s | 55.9 steps/s
[Step=8750 Epoch=83.6] | Loss=0.00072 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.796 | FP-Norm(final)=2.744 | 1700.2 samples/s | 26.6 steps/s
[Step=8800 Epoch=84.0] | Loss=0.00068 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.744 | 3584.0 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28919 | acc=0.8132 | tpr=0.7352 | fpr=0.0173 | 3586.1 samples/s | 14.0 steps/s
Avg test loss: 0.29636, Avg test acc: 0.81088, Avg tpr: 0.73311, Avg fpr: 0.01807, total FA: 141

Testing server on iccad2012
[Step=  50] | Loss=0.49216 | acc=0.8092 | tpr=0.9558 | fpr=0.1934 | 3586.0 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.49519 | acc=0.8068 | tpr=0.9638 | fpr=0.1961 | 6717.4 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.50195 | acc=0.8066 | tpr=0.9726 | fpr=0.1965 | 6755.7 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.50228 | acc=0.8073 | tpr=0.9749 | fpr=0.1957 | 6931.4 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.50250 | acc=0.8071 | tpr=0.9755 | fpr=0.1959 | 6654.0 samples/s | 26.0 steps/s
[Step= 300] | Loss=0.50385 | acc=0.8071 | tpr=0.9745 | fpr=0.1960 | 6869.2 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.50560 | acc=0.8073 | tpr=0.9756 | fpr=0.1958 | 6808.4 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.50551 | acc=0.8072 | tpr=0.9781 | fpr=0.1959 | 6803.5 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.51026 | acc=0.8068 | tpr=0.9776 | fpr=0.1963 | 6555.5 samples/s | 25.6 steps/s
[Step= 500] | Loss=0.51120 | acc=0.8060 | tpr=0.9780 | fpr=0.1971 | 6881.5 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.50854 | acc=0.8067 | tpr=0.9773 | fpr=0.1964 | 11716.9 samples/s | 45.8 steps/s
Avg test loss: 0.50878, Avg test acc: 0.80656, Avg tpr: 0.97702, Avg fpr: 0.19654, total FA: 27289

server round 24/50

clients selected: [1 4 5 7 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=54.7] | Loss=0.06357 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.751 | 3711.4 samples/s | 58.0 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04601 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.715 | FP-Norm(final)=2.739 | 3436.4 samples/s | 53.7 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03538 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.788 | FP-Norm(final)=2.734 | 3734.9 samples/s | 58.4 steps/s
[Step=11350 Epoch=55.4] | Loss=0.03049 | Reg=0.00069 | acc=0.9844 | FP-Norm=0.814 | FP-Norm(final)=2.733 | 3774.7 samples/s | 59.0 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02676 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.830 | FP-Norm(final)=2.733 | 4876.6 samples/s | 76.2 steps/s
[Step=11450 Epoch=55.9] | Loss=0.02372 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.839 | FP-Norm(final)=2.735 | 1562.7 samples/s | 24.4 steps/s
[Step=11500 Epoch=56.1] | Loss=0.02089 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.843 | FP-Norm(final)=2.737 | 3731.4 samples/s | 58.3 steps/s
[Step=11550 Epoch=56.4] | Loss=0.01941 | Reg=0.00072 | acc=0.9844 | FP-Norm=0.845 | FP-Norm(final)=2.740 | 3705.1 samples/s | 57.9 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01822 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.849 | FP-Norm(final)=2.743 | 4484.3 samples/s | 70.1 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01688 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.851 | FP-Norm(final)=2.746 | 1596.4 samples/s | 24.9 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01593 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.852 | FP-Norm(final)=2.749 | 3698.6 samples/s | 57.8 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01494 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.854 | FP-Norm(final)=2.752 | 3728.5 samples/s | 58.3 steps/s
[Step=11800 Epoch=57.6] | Loss=0.01435 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.855 | FP-Norm(final)=2.754 | 4400.7 samples/s | 68.8 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01386 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.856 | FP-Norm(final)=2.757 | 1641.7 samples/s | 25.7 steps/s
[Step=11900 Epoch=58.1] | Loss=0.01325 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.857 | FP-Norm(final)=2.760 | 3716.2 samples/s | 58.1 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01261 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.858 | FP-Norm(final)=2.762 | 3697.8 samples/s | 57.8 steps/s
[Step=12000 Epoch=58.6] | Loss=0.01211 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.859 | FP-Norm(final)=2.765 | 4134.9 samples/s | 64.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step12000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=39.2] | Loss=0.11700 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.751 | 3455.8 samples/s | 54.0 steps/s
[Step=8050 Epoch=39.5] | Loss=0.04096 | Reg=0.00050 | acc=0.9531 | FP-Norm=0.669 | FP-Norm(final)=2.740 | 3656.2 samples/s | 57.1 steps/s
[Step=8100 Epoch=39.7] | Loss=0.03510 | Reg=0.00060 | acc=0.9531 | FP-Norm=0.756 | FP-Norm(final)=2.736 | 3676.9 samples/s | 57.5 steps/s
[Step=8150 Epoch=40.0] | Loss=0.03036 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.795 | FP-Norm(final)=2.734 | 3679.0 samples/s | 57.5 steps/s
[Step=8200 Epoch=40.2] | Loss=0.02783 | Reg=0.00070 | acc=0.9531 | FP-Norm=0.822 | FP-Norm(final)=2.734 | 4822.3 samples/s | 75.3 steps/s
[Step=8250 Epoch=40.5] | Loss=0.02380 | Reg=0.00072 | acc=0.9844 | FP-Norm=0.837 | FP-Norm(final)=2.735 | 1566.8 samples/s | 24.5 steps/s
[Step=8300 Epoch=40.7] | Loss=0.02129 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.844 | FP-Norm(final)=2.737 | 3699.7 samples/s | 57.8 steps/s
[Step=8350 Epoch=40.9] | Loss=0.01933 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.848 | FP-Norm(final)=2.740 | 3709.0 samples/s | 58.0 steps/s
[Step=8400 Epoch=41.2] | Loss=0.01835 | Reg=0.00074 | acc=0.9844 | FP-Norm=0.851 | FP-Norm(final)=2.743 | 4640.1 samples/s | 72.5 steps/s
[Step=8450 Epoch=41.4] | Loss=0.01689 | Reg=0.00074 | acc=0.9844 | FP-Norm=0.853 | FP-Norm(final)=2.745 | 1584.4 samples/s | 24.8 steps/s
[Step=8500 Epoch=41.7] | Loss=0.01584 | Reg=0.00074 | acc=0.9844 | FP-Norm=0.855 | FP-Norm(final)=2.748 | 3722.6 samples/s | 58.2 steps/s
[Step=8550 Epoch=41.9] | Loss=0.01520 | Reg=0.00074 | acc=0.9844 | FP-Norm=0.857 | FP-Norm(final)=2.750 | 3685.7 samples/s | 57.6 steps/s
[Step=8600 Epoch=42.2] | Loss=0.01440 | Reg=0.00075 | acc=0.9844 | FP-Norm=0.859 | FP-Norm(final)=2.753 | 4423.3 samples/s | 69.1 steps/s
[Step=8650 Epoch=42.4] | Loss=0.01393 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.861 | FP-Norm(final)=2.755 | 1571.9 samples/s | 24.6 steps/s
[Step=8700 Epoch=42.7] | Loss=0.01331 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.863 | FP-Norm(final)=2.757 | 3697.3 samples/s | 57.8 steps/s
[Step=8750 Epoch=42.9] | Loss=0.01269 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.864 | FP-Norm(final)=2.760 | 3696.6 samples/s | 57.8 steps/s
[Step=8800 Epoch=43.2] | Loss=0.01236 | Reg=0.00075 | acc=0.9844 | FP-Norm=0.865 | FP-Norm(final)=2.762 | 4167.1 samples/s | 65.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step8800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12801 Epoch=121.3] | Loss=0.12982 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.751 | 3571.4 samples/s | 55.8 steps/s
[Step=12850 Epoch=121.8] | Loss=0.00860 | Reg=0.00103 | acc=1.0000 | FP-Norm=0.967 | FP-Norm(final)=2.750 | 3453.1 samples/s | 54.0 steps/s
[Step=12900 Epoch=122.2] | Loss=0.00490 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.045 | FP-Norm(final)=2.751 | 4621.5 samples/s | 72.2 steps/s
[Step=12950 Epoch=122.7] | Loss=0.00342 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.047 | FP-Norm(final)=2.753 | 1520.7 samples/s | 23.8 steps/s
[Step=13000 Epoch=123.2] | Loss=0.00258 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.030 | FP-Norm(final)=2.754 | 4251.0 samples/s | 66.4 steps/s
[Step=13050 Epoch=123.7] | Loss=0.00208 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.009 | FP-Norm(final)=2.755 | 1566.9 samples/s | 24.5 steps/s
[Step=13100 Epoch=124.1] | Loss=0.00174 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.988 | FP-Norm(final)=2.756 | 4029.4 samples/s | 63.0 steps/s
[Step=13150 Epoch=124.6] | Loss=0.00150 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.969 | FP-Norm(final)=2.757 | 1592.3 samples/s | 24.9 steps/s
[Step=13200 Epoch=125.1] | Loss=0.00132 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.951 | FP-Norm(final)=2.757 | 3834.9 samples/s | 59.9 steps/s
[Step=13250 Epoch=125.6] | Loss=0.00117 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.934 | FP-Norm(final)=2.758 | 1640.8 samples/s | 25.6 steps/s
[Step=13300 Epoch=126.0] | Loss=0.00106 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.918 | FP-Norm(final)=2.758 | 3594.9 samples/s | 56.2 steps/s
[Step=13350 Epoch=126.5] | Loss=0.00097 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.904 | FP-Norm(final)=2.759 | 1680.5 samples/s | 26.3 steps/s
[Step=13400 Epoch=127.0] | Loss=0.00089 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.890 | FP-Norm(final)=2.759 | 3560.7 samples/s | 55.6 steps/s
[Step=13450 Epoch=127.5] | Loss=0.00082 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.760 | 1686.9 samples/s | 26.4 steps/s
[Step=13500 Epoch=127.9] | Loss=0.00077 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.865 | FP-Norm(final)=2.760 | 3630.8 samples/s | 56.7 steps/s
[Step=13550 Epoch=128.4] | Loss=0.00072 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.853 | FP-Norm(final)=2.760 | 1702.6 samples/s | 26.6 steps/s
[Step=13600 Epoch=128.9] | Loss=0.00068 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.842 | FP-Norm(final)=2.761 | 3532.6 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step13600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=84.0] | Loss=0.01557 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.752 | 3464.0 samples/s | 54.1 steps/s
[Step=8850 Epoch=84.5] | Loss=0.01020 | Reg=0.00103 | acc=1.0000 | FP-Norm=0.953 | FP-Norm(final)=2.750 | 3405.4 samples/s | 53.2 steps/s
[Step=8900 Epoch=85.0] | Loss=0.00538 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.069 | FP-Norm(final)=2.751 | 4672.1 samples/s | 73.0 steps/s
[Step=8950 Epoch=85.5] | Loss=0.00372 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.081 | FP-Norm(final)=2.754 | 1525.9 samples/s | 23.8 steps/s
[Step=9000 Epoch=85.9] | Loss=0.00281 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.067 | FP-Norm(final)=2.755 | 4446.1 samples/s | 69.5 steps/s
[Step=9050 Epoch=86.4] | Loss=0.00226 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.049 | FP-Norm(final)=2.756 | 1534.0 samples/s | 24.0 steps/s
[Step=9100 Epoch=86.9] | Loss=0.00189 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.030 | FP-Norm(final)=2.757 | 4142.0 samples/s | 64.7 steps/s
[Step=9150 Epoch=87.4] | Loss=0.00163 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.013 | FP-Norm(final)=2.758 | 1585.8 samples/s | 24.8 steps/s
[Step=9200 Epoch=87.9] | Loss=0.00143 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.995 | FP-Norm(final)=2.758 | 3914.0 samples/s | 61.2 steps/s
[Step=9250 Epoch=88.3] | Loss=0.00128 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.979 | FP-Norm(final)=2.759 | 1609.7 samples/s | 25.2 steps/s
[Step=9300 Epoch=88.8] | Loss=0.00115 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.964 | FP-Norm(final)=2.760 | 3728.7 samples/s | 58.3 steps/s
[Step=9350 Epoch=89.3] | Loss=0.00105 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.950 | FP-Norm(final)=2.760 | 1623.5 samples/s | 25.4 steps/s
[Step=9400 Epoch=89.8] | Loss=0.00097 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.936 | FP-Norm(final)=2.761 | 3628.6 samples/s | 56.7 steps/s
[Step=9450 Epoch=90.2] | Loss=0.00090 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.923 | FP-Norm(final)=2.761 | 1675.3 samples/s | 26.2 steps/s
[Step=9500 Epoch=90.7] | Loss=0.00083 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.911 | FP-Norm(final)=2.762 | 3573.5 samples/s | 55.8 steps/s
[Step=9550 Epoch=91.2] | Loss=0.00078 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.899 | FP-Norm(final)=2.762 | 1684.2 samples/s | 26.3 steps/s
[Step=9600 Epoch=91.7] | Loss=0.00073 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.888 | FP-Norm(final)=2.762 | 3621.6 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step9600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=7201 Epoch=68.6] | Loss=0.04606 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.751 | 3309.8 samples/s | 51.7 steps/s
[Step=7250 Epoch=69.1] | Loss=0.01186 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.842 | FP-Norm(final)=2.748 | 3576.9 samples/s | 55.9 steps/s
[Step=7300 Epoch=69.6] | Loss=0.00699 | Reg=0.00107 | acc=1.0000 | FP-Norm=0.996 | FP-Norm(final)=2.749 | 4617.7 samples/s | 72.2 steps/s
[Step=7350 Epoch=70.1] | Loss=0.00471 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.026 | FP-Norm(final)=2.750 | 1508.8 samples/s | 23.6 steps/s
[Step=7400 Epoch=70.5] | Loss=0.00357 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.026 | FP-Norm(final)=2.752 | 4350.7 samples/s | 68.0 steps/s
[Step=7450 Epoch=71.0] | Loss=0.00287 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.017 | FP-Norm(final)=2.753 | 1537.0 samples/s | 24.0 steps/s
[Step=7500 Epoch=71.5] | Loss=0.00240 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.005 | FP-Norm(final)=2.754 | 4131.7 samples/s | 64.6 steps/s
[Step=7550 Epoch=72.0] | Loss=0.00206 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.991 | FP-Norm(final)=2.755 | 1584.8 samples/s | 24.8 steps/s
[Step=7600 Epoch=72.4] | Loss=0.00181 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.978 | FP-Norm(final)=2.755 | 3896.5 samples/s | 60.9 steps/s
[Step=7650 Epoch=72.9] | Loss=0.00161 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.965 | FP-Norm(final)=2.756 | 1590.2 samples/s | 24.8 steps/s
[Step=7700 Epoch=73.4] | Loss=0.00146 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.952 | FP-Norm(final)=2.757 | 3789.1 samples/s | 59.2 steps/s
[Step=7750 Epoch=73.9] | Loss=0.00133 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.940 | FP-Norm(final)=2.758 | 1649.8 samples/s | 25.8 steps/s
[Step=7800 Epoch=74.3] | Loss=0.00122 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.928 | FP-Norm(final)=2.758 | 3637.7 samples/s | 56.8 steps/s
[Step=7850 Epoch=74.8] | Loss=0.00113 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.917 | FP-Norm(final)=2.759 | 1689.9 samples/s | 26.4 steps/s
[Step=7900 Epoch=75.3] | Loss=0.00105 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.906 | FP-Norm(final)=2.759 | 3528.8 samples/s | 55.1 steps/s
[Step=7950 Epoch=75.8] | Loss=0.00098 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.896 | FP-Norm(final)=2.760 | 1674.3 samples/s | 26.2 steps/s
[Step=8000 Epoch=76.2] | Loss=0.00092 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.886 | FP-Norm(final)=2.760 | 3569.4 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29650 | acc=0.8092 | tpr=0.7292 | fpr=0.0171 | 3515.5 samples/s | 13.7 steps/s
Avg test loss: 0.30360, Avg test acc: 0.80716, Avg tpr: 0.72775, Avg fpr: 0.01820, total FA: 142

Testing server on iccad2012
[Step=  50] | Loss=0.48627 | acc=0.8130 | tpr=0.9558 | fpr=0.1895 | 3504.6 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.48903 | acc=0.8098 | tpr=0.9616 | fpr=0.1930 | 6836.3 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.49577 | acc=0.8091 | tpr=0.9712 | fpr=0.1939 | 6753.6 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.49588 | acc=0.8100 | tpr=0.9727 | fpr=0.1929 | 6742.6 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.49593 | acc=0.8100 | tpr=0.9738 | fpr=0.1930 | 6612.6 samples/s | 25.8 steps/s
[Step= 300] | Loss=0.49732 | acc=0.8098 | tpr=0.9731 | fpr=0.1932 | 6878.5 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.49899 | acc=0.8099 | tpr=0.9743 | fpr=0.1931 | 6494.7 samples/s | 25.4 steps/s
[Step= 400] | Loss=0.49896 | acc=0.8097 | tpr=0.9770 | fpr=0.1933 | 6586.5 samples/s | 25.7 steps/s
[Step= 450] | Loss=0.50358 | acc=0.8090 | tpr=0.9766 | fpr=0.1940 | 6754.7 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.50458 | acc=0.8084 | tpr=0.9771 | fpr=0.1946 | 6642.9 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.50188 | acc=0.8092 | tpr=0.9769 | fpr=0.1939 | 12562.9 samples/s | 49.1 steps/s
Avg test loss: 0.50211, Avg test acc: 0.80901, Avg tpr: 0.97662, Avg fpr: 0.19403, total FA: 26941

server round 25/50

clients selected: [0 1 3 6 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=7201 Epoch=35.1] | Loss=0.11214 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.766 | 3367.1 samples/s | 52.6 steps/s
[Step=7250 Epoch=35.4] | Loss=0.03648 | Reg=0.00040 | acc=0.9844 | FP-Norm=0.607 | FP-Norm(final)=2.760 | 3584.9 samples/s | 56.0 steps/s
[Step=7300 Epoch=35.6] | Loss=0.02925 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.683 | FP-Norm(final)=2.759 | 3543.0 samples/s | 55.4 steps/s
[Step=7350 Epoch=35.8] | Loss=0.02623 | Reg=0.00054 | acc=0.9688 | FP-Norm=0.721 | FP-Norm(final)=2.758 | 3592.1 samples/s | 56.1 steps/s
[Step=7400 Epoch=36.1] | Loss=0.02382 | Reg=0.00057 | acc=0.9844 | FP-Norm=0.745 | FP-Norm(final)=2.759 | 4667.7 samples/s | 72.9 steps/s
[Step=7450 Epoch=36.3] | Loss=0.02112 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.760 | FP-Norm(final)=2.760 | 1580.1 samples/s | 24.7 steps/s
[Step=7500 Epoch=36.6] | Loss=0.01900 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.768 | FP-Norm(final)=2.762 | 3742.3 samples/s | 58.5 steps/s
[Step=7550 Epoch=36.8] | Loss=0.01750 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.773 | FP-Norm(final)=2.765 | 3718.2 samples/s | 58.1 steps/s
[Step=7600 Epoch=37.1] | Loss=0.01655 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.777 | FP-Norm(final)=2.767 | 4510.0 samples/s | 70.5 steps/s
[Step=7650 Epoch=37.3] | Loss=0.01560 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.769 | 1607.7 samples/s | 25.1 steps/s
[Step=7700 Epoch=37.5] | Loss=0.01462 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.782 | FP-Norm(final)=2.772 | 3721.2 samples/s | 58.1 steps/s
[Step=7750 Epoch=37.8] | Loss=0.01365 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.785 | FP-Norm(final)=2.774 | 3718.3 samples/s | 58.1 steps/s
[Step=7800 Epoch=38.0] | Loss=0.01314 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.788 | FP-Norm(final)=2.777 | 4234.9 samples/s | 66.2 steps/s
[Step=7850 Epoch=38.3] | Loss=0.01282 | Reg=0.00063 | acc=0.9844 | FP-Norm=0.792 | FP-Norm(final)=2.779 | 1631.1 samples/s | 25.5 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01223 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.794 | FP-Norm(final)=2.781 | 3714.6 samples/s | 58.0 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01180 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.797 | FP-Norm(final)=2.783 | 3746.3 samples/s | 58.5 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01164 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.800 | FP-Norm(final)=2.786 | 3998.3 samples/s | 62.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=58.6] | Loss=0.22694 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.766 | 3448.4 samples/s | 53.9 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03782 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.647 | FP-Norm(final)=2.755 | 3618.4 samples/s | 56.5 steps/s
[Step=12100 Epoch=59.0] | Loss=0.03081 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.731 | FP-Norm(final)=2.752 | 3730.4 samples/s | 58.3 steps/s
[Step=12150 Epoch=59.3] | Loss=0.02942 | Reg=0.00062 | acc=0.9688 | FP-Norm=0.772 | FP-Norm(final)=2.749 | 3735.4 samples/s | 58.4 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02661 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.804 | FP-Norm(final)=2.748 | 4826.4 samples/s | 75.4 steps/s
[Step=12250 Epoch=59.8] | Loss=0.02324 | Reg=0.00070 | acc=0.9531 | FP-Norm=0.825 | FP-Norm(final)=2.749 | 1569.2 samples/s | 24.5 steps/s
[Step=12300 Epoch=60.0] | Loss=0.02020 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.835 | FP-Norm(final)=2.751 | 3738.4 samples/s | 58.4 steps/s
[Step=12350 Epoch=60.3] | Loss=0.01861 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.839 | FP-Norm(final)=2.754 | 3732.0 samples/s | 58.3 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01786 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.845 | FP-Norm(final)=2.757 | 4555.2 samples/s | 71.2 steps/s
[Step=12450 Epoch=60.8] | Loss=0.01681 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.849 | FP-Norm(final)=2.759 | 1611.0 samples/s | 25.2 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01583 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.852 | FP-Norm(final)=2.761 | 3767.9 samples/s | 58.9 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01509 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.854 | FP-Norm(final)=2.763 | 3747.7 samples/s | 58.6 steps/s
[Step=12600 Epoch=61.5] | Loss=0.01452 | Reg=0.00074 | acc=0.9844 | FP-Norm=0.856 | FP-Norm(final)=2.766 | 4338.1 samples/s | 67.8 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01388 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.859 | FP-Norm(final)=2.768 | 1649.9 samples/s | 25.8 steps/s
[Step=12700 Epoch=62.0] | Loss=0.01325 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.861 | FP-Norm(final)=2.770 | 3716.0 samples/s | 58.1 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01297 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.863 | FP-Norm(final)=2.771 | 3716.7 samples/s | 58.1 steps/s
[Step=12800 Epoch=62.5] | Loss=0.01259 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.865 | FP-Norm(final)=2.773 | 4136.8 samples/s | 64.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step12800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=42.9] | Loss=0.18752 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.766 | 3555.7 samples/s | 55.6 steps/s
[Step=8850 Epoch=43.2] | Loss=0.03577 | Reg=0.00048 | acc=0.9688 | FP-Norm=0.659 | FP-Norm(final)=2.758 | 3615.1 samples/s | 56.5 steps/s
[Step=8900 Epoch=43.4] | Loss=0.02670 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.728 | FP-Norm(final)=2.757 | 3675.1 samples/s | 57.4 steps/s
[Step=8950 Epoch=43.6] | Loss=0.02350 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.753 | FP-Norm(final)=2.758 | 3730.1 samples/s | 58.3 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02111 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.761 | FP-Norm(final)=2.759 | 4774.8 samples/s | 74.6 steps/s
[Step=9050 Epoch=44.1] | Loss=0.01850 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.770 | FP-Norm(final)=2.762 | 1577.2 samples/s | 24.6 steps/s
[Step=9100 Epoch=44.4] | Loss=0.01691 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.773 | FP-Norm(final)=2.764 | 3668.2 samples/s | 57.3 steps/s
[Step=9150 Epoch=44.6] | Loss=0.01573 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.766 | 3726.5 samples/s | 58.2 steps/s
[Step=9200 Epoch=44.9] | Loss=0.01470 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.777 | FP-Norm(final)=2.768 | 4481.7 samples/s | 70.0 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01359 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.777 | FP-Norm(final)=2.771 | 1614.7 samples/s | 25.2 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01270 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.777 | FP-Norm(final)=2.773 | 3700.1 samples/s | 57.8 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01221 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.775 | 3738.2 samples/s | 58.4 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01190 | Reg=0.00061 | acc=0.9688 | FP-Norm=0.779 | FP-Norm(final)=2.777 | 4243.8 samples/s | 66.3 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01147 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.781 | FP-Norm(final)=2.778 | 1636.7 samples/s | 25.6 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01104 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.783 | FP-Norm(final)=2.780 | 3764.9 samples/s | 58.8 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01064 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.784 | FP-Norm(final)=2.782 | 3734.5 samples/s | 58.4 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01032 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.784 | 4025.7 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step9600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=6401 Epoch=60.9] | Loss=0.04981 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.767 | 3587.3 samples/s | 56.1 steps/s
[Step=6450 Epoch=61.4] | Loss=0.01241 | Reg=0.00108 | acc=1.0000 | FP-Norm=0.992 | FP-Norm(final)=2.764 | 3284.4 samples/s | 51.3 steps/s
[Step=6500 Epoch=61.8] | Loss=0.00673 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.095 | FP-Norm(final)=2.766 | 4626.8 samples/s | 72.3 steps/s
[Step=6550 Epoch=62.3] | Loss=0.00452 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.098 | FP-Norm(final)=2.769 | 1504.1 samples/s | 23.5 steps/s
[Step=6600 Epoch=62.8] | Loss=0.00342 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.082 | FP-Norm(final)=2.770 | 4299.4 samples/s | 67.2 steps/s
[Step=6650 Epoch=63.3] | Loss=0.00275 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.062 | FP-Norm(final)=2.771 | 1563.7 samples/s | 24.4 steps/s
[Step=6700 Epoch=63.7] | Loss=0.00230 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.042 | FP-Norm(final)=2.772 | 4018.8 samples/s | 62.8 steps/s
[Step=6750 Epoch=64.2] | Loss=0.00198 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.023 | FP-Norm(final)=2.773 | 1601.2 samples/s | 25.0 steps/s
[Step=6800 Epoch=64.7] | Loss=0.00174 | Reg=0.00103 | acc=1.0000 | FP-Norm=1.005 | FP-Norm(final)=2.774 | 3778.4 samples/s | 59.0 steps/s
[Step=6850 Epoch=65.2] | Loss=0.00155 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.988 | FP-Norm(final)=2.774 | 1627.7 samples/s | 25.4 steps/s
[Step=6900 Epoch=65.6] | Loss=0.00140 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.972 | FP-Norm(final)=2.775 | 3649.8 samples/s | 57.0 steps/s
[Step=6950 Epoch=66.1] | Loss=0.00128 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.958 | FP-Norm(final)=2.775 | 1658.7 samples/s | 25.9 steps/s
[Step=7000 Epoch=66.6] | Loss=0.00117 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.944 | FP-Norm(final)=2.776 | 3593.6 samples/s | 56.1 steps/s
[Step=7050 Epoch=67.1] | Loss=0.00109 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.930 | FP-Norm(final)=2.776 | 1689.3 samples/s | 26.4 steps/s
[Step=7100 Epoch=67.5] | Loss=0.00101 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.918 | FP-Norm(final)=2.776 | 3560.4 samples/s | 55.6 steps/s
[Step=7150 Epoch=68.0] | Loss=0.00095 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.906 | FP-Norm(final)=2.777 | 1708.0 samples/s | 26.7 steps/s
[Step=7200 Epoch=68.5] | Loss=0.00089 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.895 | FP-Norm(final)=2.777 | 3508.4 samples/s | 54.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step7200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=76.3] | Loss=0.20731 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.766 | 3584.5 samples/s | 56.0 steps/s
[Step=8050 Epoch=76.7] | Loss=0.01155 | Reg=0.00106 | acc=1.0000 | FP-Norm=0.983 | FP-Norm(final)=2.759 | 3273.8 samples/s | 51.2 steps/s
[Step=8100 Epoch=77.2] | Loss=0.00609 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.082 | FP-Norm(final)=2.760 | 4669.4 samples/s | 73.0 steps/s
[Step=8150 Epoch=77.7] | Loss=0.00411 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.086 | FP-Norm(final)=2.762 | 1526.8 samples/s | 23.9 steps/s
[Step=8200 Epoch=78.2] | Loss=0.00311 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.071 | FP-Norm(final)=2.764 | 4391.1 samples/s | 68.6 steps/s
[Step=8250 Epoch=78.6] | Loss=0.00250 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.053 | FP-Norm(final)=2.765 | 1560.8 samples/s | 24.4 steps/s
[Step=8300 Epoch=79.1] | Loss=0.00210 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.034 | FP-Norm(final)=2.766 | 4124.1 samples/s | 64.4 steps/s
[Step=8350 Epoch=79.6] | Loss=0.00181 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.016 | FP-Norm(final)=2.767 | 1600.0 samples/s | 25.0 steps/s
[Step=8400 Epoch=80.1] | Loss=0.00159 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.999 | FP-Norm(final)=2.768 | 3948.8 samples/s | 61.7 steps/s
[Step=8450 Epoch=80.5] | Loss=0.00142 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.984 | FP-Norm(final)=2.769 | 1611.8 samples/s | 25.2 steps/s
[Step=8500 Epoch=81.0] | Loss=0.00128 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.969 | FP-Norm(final)=2.770 | 3799.6 samples/s | 59.4 steps/s
[Step=8550 Epoch=81.5] | Loss=0.00117 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.954 | FP-Norm(final)=2.770 | 1660.6 samples/s | 25.9 steps/s
[Step=8600 Epoch=82.0] | Loss=0.00107 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.941 | FP-Norm(final)=2.771 | 3598.5 samples/s | 56.2 steps/s
[Step=8650 Epoch=82.4] | Loss=0.00099 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.928 | FP-Norm(final)=2.772 | 1662.9 samples/s | 26.0 steps/s
[Step=8700 Epoch=82.9] | Loss=0.00093 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.916 | FP-Norm(final)=2.772 | 3589.0 samples/s | 56.1 steps/s
[Step=8750 Epoch=83.4] | Loss=0.00087 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.905 | FP-Norm(final)=2.773 | 1678.7 samples/s | 26.2 steps/s
[Step=8800 Epoch=83.9] | Loss=0.00082 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.894 | FP-Norm(final)=2.773 | 3648.2 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33691 | acc=0.7901 | tpr=0.7006 | fpr=0.0156 | 3555.5 samples/s | 13.9 steps/s
Avg test loss: 0.34430, Avg test acc: 0.78832, Avg tpr: 0.69966, Avg fpr: 0.01666, total FA: 130

Testing server on iccad2012
[Step=  50] | Loss=0.44237 | acc=0.8352 | tpr=0.9558 | fpr=0.1670 | 3595.4 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.44387 | acc=0.8345 | tpr=0.9638 | fpr=0.1680 | 6624.7 samples/s | 25.9 steps/s
[Step= 150] | Loss=0.45106 | acc=0.8334 | tpr=0.9726 | fpr=0.1692 | 6783.2 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.45087 | acc=0.8344 | tpr=0.9738 | fpr=0.1682 | 6777.7 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.45067 | acc=0.8339 | tpr=0.9747 | fpr=0.1686 | 6832.7 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.45225 | acc=0.8337 | tpr=0.9738 | fpr=0.1688 | 6705.2 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.45417 | acc=0.8337 | tpr=0.9737 | fpr=0.1689 | 6650.2 samples/s | 26.0 steps/s
[Step= 400] | Loss=0.45420 | acc=0.8335 | tpr=0.9765 | fpr=0.1691 | 6672.7 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.45881 | acc=0.8329 | tpr=0.9761 | fpr=0.1697 | 6503.1 samples/s | 25.4 steps/s
[Step= 500] | Loss=0.45959 | acc=0.8322 | tpr=0.9762 | fpr=0.1704 | 6488.2 samples/s | 25.3 steps/s
[Step= 550] | Loss=0.45700 | acc=0.8328 | tpr=0.9757 | fpr=0.1698 | 12530.5 samples/s | 48.9 steps/s
Avg test loss: 0.45717, Avg test acc: 0.83264, Avg tpr: 0.97544, Avg fpr: 0.16996, total FA: 23598

server round 26/50

clients selected: [1 2 3 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12801 Epoch=62.5] | Loss=0.36024 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.786 | 3664.2 samples/s | 57.3 steps/s
[Step=12850 Epoch=62.7] | Loss=0.05689 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.823 | FP-Norm(final)=2.764 | 3477.3 samples/s | 54.3 steps/s
[Step=12900 Epoch=62.9] | Loss=0.04004 | Reg=0.00079 | acc=0.9844 | FP-Norm=0.869 | FP-Norm(final)=2.759 | 3712.7 samples/s | 58.0 steps/s
[Step=12950 Epoch=63.2] | Loss=0.03268 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.876 | FP-Norm(final)=2.759 | 3761.6 samples/s | 58.8 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02929 | Reg=0.00079 | acc=0.9688 | FP-Norm=0.881 | FP-Norm(final)=2.761 | 4780.4 samples/s | 74.7 steps/s
[Step=13050 Epoch=63.7] | Loss=0.02518 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.886 | FP-Norm(final)=2.763 | 1571.0 samples/s | 24.5 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02266 | Reg=0.00080 | acc=0.9844 | FP-Norm=0.886 | FP-Norm(final)=2.765 | 3707.0 samples/s | 57.9 steps/s
[Step=13150 Epoch=64.2] | Loss=0.02038 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.884 | FP-Norm(final)=2.767 | 3736.3 samples/s | 58.4 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01917 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.882 | FP-Norm(final)=2.770 | 4520.4 samples/s | 70.6 steps/s
[Step=13250 Epoch=64.7] | Loss=0.01798 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.881 | FP-Norm(final)=2.772 | 1609.6 samples/s | 25.1 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01695 | Reg=0.00078 | acc=0.9844 | FP-Norm=0.880 | FP-Norm(final)=2.774 | 3731.7 samples/s | 58.3 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01590 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.878 | FP-Norm(final)=2.777 | 3744.8 samples/s | 58.5 steps/s
[Step=13400 Epoch=65.4] | Loss=0.01512 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.876 | FP-Norm(final)=2.779 | 4341.3 samples/s | 67.8 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01432 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.875 | FP-Norm(final)=2.781 | 1611.0 samples/s | 25.2 steps/s
[Step=13500 Epoch=65.9] | Loss=0.01378 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.873 | FP-Norm(final)=2.783 | 3747.8 samples/s | 58.6 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01318 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.872 | FP-Norm(final)=2.785 | 3751.9 samples/s | 58.6 steps/s
[Step=13600 Epoch=66.4] | Loss=0.01280 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.787 | 4128.0 samples/s | 64.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step13600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=13601 Epoch=66.3] | Loss=0.30836 | Reg=0.00000 | acc=0.7656 | FP-Norm=0.000 | FP-Norm(final)=2.786 | 3574.0 samples/s | 55.8 steps/s
[Step=13650 Epoch=66.5] | Loss=0.04056 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.734 | FP-Norm(final)=2.776 | 3651.6 samples/s | 57.1 steps/s
[Step=13700 Epoch=66.8] | Loss=0.03370 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.811 | FP-Norm(final)=2.772 | 3708.5 samples/s | 57.9 steps/s
[Step=13750 Epoch=67.0] | Loss=0.02851 | Reg=0.00072 | acc=0.9688 | FP-Norm=0.838 | FP-Norm(final)=2.771 | 3797.0 samples/s | 59.3 steps/s
[Step=13800 Epoch=67.2] | Loss=0.02547 | Reg=0.00073 | acc=0.9844 | FP-Norm=0.846 | FP-Norm(final)=2.773 | 4775.2 samples/s | 74.6 steps/s
[Step=13850 Epoch=67.5] | Loss=0.02325 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.856 | FP-Norm(final)=2.775 | 1587.9 samples/s | 24.8 steps/s
[Step=13900 Epoch=67.7] | Loss=0.02086 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.862 | FP-Norm(final)=2.777 | 3712.2 samples/s | 58.0 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01925 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.864 | FP-Norm(final)=2.779 | 3718.7 samples/s | 58.1 steps/s
[Step=14000 Epoch=68.2] | Loss=0.01822 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.866 | FP-Norm(final)=2.782 | 4498.6 samples/s | 70.3 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01708 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.867 | FP-Norm(final)=2.784 | 1623.1 samples/s | 25.4 steps/s
[Step=14100 Epoch=68.7] | Loss=0.01602 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.869 | FP-Norm(final)=2.786 | 3681.7 samples/s | 57.5 steps/s
[Step=14150 Epoch=68.9] | Loss=0.01504 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.870 | FP-Norm(final)=2.789 | 3777.8 samples/s | 59.0 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01450 | Reg=0.00076 | acc=0.9844 | FP-Norm=0.870 | FP-Norm(final)=2.791 | 4216.7 samples/s | 65.9 steps/s
[Step=14250 Epoch=69.4] | Loss=0.01378 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.793 | 1632.2 samples/s | 25.5 steps/s
[Step=14300 Epoch=69.7] | Loss=0.01308 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.796 | 3723.9 samples/s | 58.2 steps/s
[Step=14350 Epoch=69.9] | Loss=0.01263 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.798 | 3734.2 samples/s | 58.3 steps/s
[Step=14400 Epoch=70.2] | Loss=0.01232 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.872 | FP-Norm(final)=2.800 | 4005.0 samples/s | 62.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step14400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=46.8] | Loss=0.19613 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.786 | 3570.6 samples/s | 55.8 steps/s
[Step=9650 Epoch=47.1] | Loss=0.04128 | Reg=0.00057 | acc=0.9844 | FP-Norm=0.722 | FP-Norm(final)=2.774 | 3510.4 samples/s | 54.9 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03261 | Reg=0.00064 | acc=0.9531 | FP-Norm=0.783 | FP-Norm(final)=2.772 | 3660.6 samples/s | 57.2 steps/s
[Step=9750 Epoch=47.5] | Loss=0.02745 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.771 | 3714.7 samples/s | 58.0 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02502 | Reg=0.00068 | acc=0.9375 | FP-Norm=0.814 | FP-Norm(final)=2.772 | 4790.3 samples/s | 74.8 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02180 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.821 | FP-Norm(final)=2.773 | 1585.1 samples/s | 24.8 steps/s
[Step=9900 Epoch=48.3] | Loss=0.01940 | Reg=0.00069 | acc=0.9844 | FP-Norm=0.823 | FP-Norm(final)=2.775 | 3727.2 samples/s | 58.2 steps/s
[Step=9950 Epoch=48.5] | Loss=0.01808 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.824 | FP-Norm(final)=2.777 | 3789.4 samples/s | 59.2 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01677 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.825 | FP-Norm(final)=2.778 | 4430.4 samples/s | 69.2 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01547 | Reg=0.00069 | acc=0.9844 | FP-Norm=0.825 | FP-Norm(final)=2.781 | 1606.2 samples/s | 25.1 steps/s
[Step=10100 Epoch=49.3] | Loss=0.01444 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.825 | FP-Norm(final)=2.783 | 3721.7 samples/s | 58.2 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01361 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.825 | FP-Norm(final)=2.785 | 3744.6 samples/s | 58.5 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01307 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.787 | 4240.0 samples/s | 66.2 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01247 | Reg=0.00069 | acc=0.9844 | FP-Norm=0.827 | FP-Norm(final)=2.789 | 1634.6 samples/s | 25.5 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01205 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.828 | FP-Norm(final)=2.791 | 3704.2 samples/s | 57.9 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01151 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.793 | 3715.7 samples/s | 58.1 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01129 | Reg=0.00069 | acc=0.9844 | FP-Norm=0.830 | FP-Norm(final)=2.795 | 4025.2 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step10400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=113.1] | Loss=0.17828 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.786 | 3677.9 samples/s | 57.5 steps/s
[Step=12050 Epoch=113.5] | Loss=0.01019 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.926 | FP-Norm(final)=2.778 | 3164.7 samples/s | 49.4 steps/s
[Step=12100 Epoch=114.0] | Loss=0.00539 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.988 | FP-Norm(final)=2.780 | 4550.4 samples/s | 71.1 steps/s
[Step=12150 Epoch=114.5] | Loss=0.00363 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.982 | FP-Norm(final)=2.783 | 1508.2 samples/s | 23.6 steps/s
[Step=12200 Epoch=115.0] | Loss=0.00274 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.963 | FP-Norm(final)=2.784 | 4196.6 samples/s | 65.6 steps/s
[Step=12250 Epoch=115.4] | Loss=0.00220 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.944 | FP-Norm(final)=2.785 | 1581.2 samples/s | 24.7 steps/s
[Step=12300 Epoch=115.9] | Loss=0.00185 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.925 | FP-Norm(final)=2.786 | 3939.5 samples/s | 61.6 steps/s
[Step=12350 Epoch=116.4] | Loss=0.00159 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.908 | FP-Norm(final)=2.787 | 1623.6 samples/s | 25.4 steps/s
[Step=12400 Epoch=116.8] | Loss=0.00140 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.892 | FP-Norm(final)=2.788 | 3650.4 samples/s | 57.0 steps/s
[Step=12450 Epoch=117.3] | Loss=0.00125 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.789 | 1656.0 samples/s | 25.9 steps/s
[Step=12500 Epoch=117.8] | Loss=0.00113 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.863 | FP-Norm(final)=2.789 | 3547.9 samples/s | 55.4 steps/s
[Step=12550 Epoch=118.3] | Loss=0.00103 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.850 | FP-Norm(final)=2.790 | 1681.2 samples/s | 26.3 steps/s
[Step=12600 Epoch=118.7] | Loss=0.00095 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.838 | FP-Norm(final)=2.790 | 3582.7 samples/s | 56.0 steps/s
[Step=12650 Epoch=119.2] | Loss=0.00088 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.827 | FP-Norm(final)=2.791 | 1697.5 samples/s | 26.5 steps/s
[Step=12700 Epoch=119.7] | Loss=0.00082 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.791 | 3526.8 samples/s | 55.1 steps/s
[Step=12750 Epoch=120.1] | Loss=0.00076 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.806 | FP-Norm(final)=2.792 | 1758.9 samples/s | 27.5 steps/s
[Step=12800 Epoch=120.6] | Loss=0.00072 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.796 | FP-Norm(final)=2.792 | 3336.9 samples/s | 52.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step12800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=83.9] | Loss=0.07965 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.786 | 3427.6 samples/s | 53.6 steps/s
[Step=8850 Epoch=84.3] | Loss=0.00994 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.910 | FP-Norm(final)=2.780 | 3399.7 samples/s | 53.1 steps/s
[Step=8900 Epoch=84.8] | Loss=0.00520 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.987 | FP-Norm(final)=2.782 | 4611.7 samples/s | 72.1 steps/s
[Step=8950 Epoch=85.3] | Loss=0.00350 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.983 | FP-Norm(final)=2.784 | 1507.3 samples/s | 23.6 steps/s
[Step=9000 Epoch=85.8] | Loss=0.00265 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.965 | FP-Norm(final)=2.785 | 4351.3 samples/s | 68.0 steps/s
[Step=9050 Epoch=86.3] | Loss=0.00213 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.945 | FP-Norm(final)=2.787 | 1559.5 samples/s | 24.4 steps/s
[Step=9100 Epoch=86.7] | Loss=0.00179 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.926 | FP-Norm(final)=2.788 | 4104.8 samples/s | 64.1 steps/s
[Step=9150 Epoch=87.2] | Loss=0.00154 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.907 | FP-Norm(final)=2.789 | 1566.9 samples/s | 24.5 steps/s
[Step=9200 Epoch=87.7] | Loss=0.00135 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.891 | FP-Norm(final)=2.789 | 3944.1 samples/s | 61.6 steps/s
[Step=9250 Epoch=88.2] | Loss=0.00121 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.875 | FP-Norm(final)=2.790 | 1596.7 samples/s | 24.9 steps/s
[Step=9300 Epoch=88.6] | Loss=0.00109 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.861 | FP-Norm(final)=2.791 | 3783.2 samples/s | 59.1 steps/s
[Step=9350 Epoch=89.1] | Loss=0.00099 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.847 | FP-Norm(final)=2.792 | 1639.2 samples/s | 25.6 steps/s
[Step=9400 Epoch=89.6] | Loss=0.00091 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.834 | FP-Norm(final)=2.792 | 3623.5 samples/s | 56.6 steps/s
[Step=9450 Epoch=90.1] | Loss=0.00085 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.823 | FP-Norm(final)=2.793 | 1660.3 samples/s | 25.9 steps/s
[Step=9500 Epoch=90.5] | Loss=0.00079 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.811 | FP-Norm(final)=2.793 | 3525.8 samples/s | 55.1 steps/s
[Step=9550 Epoch=91.0] | Loss=0.00074 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.800 | FP-Norm(final)=2.794 | 1660.8 samples/s | 25.9 steps/s
[Step=9600 Epoch=91.5] | Loss=0.00069 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.790 | FP-Norm(final)=2.794 | 3619.8 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31933 | acc=0.7995 | tpr=0.7145 | fpr=0.0159 | 3536.5 samples/s | 13.8 steps/s
Avg test loss: 0.32651, Avg test acc: 0.79754, Avg tpr: 0.71324, Avg fpr: 0.01705, total FA: 133

Testing server on iccad2012
[Step=  50] | Loss=0.45208 | acc=0.8328 | tpr=0.9602 | fpr=0.1695 | 3576.8 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.45380 | acc=0.8313 | tpr=0.9659 | fpr=0.1712 | 6704.4 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.46060 | acc=0.8304 | tpr=0.9741 | fpr=0.1722 | 6898.7 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.45984 | acc=0.8314 | tpr=0.9749 | fpr=0.1712 | 6762.1 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.45977 | acc=0.8309 | tpr=0.9755 | fpr=0.1717 | 6772.1 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.46138 | acc=0.8305 | tpr=0.9745 | fpr=0.1721 | 6629.4 samples/s | 25.9 steps/s
[Step= 350] | Loss=0.46334 | acc=0.8306 | tpr=0.9743 | fpr=0.1720 | 6884.4 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.46330 | acc=0.8305 | tpr=0.9765 | fpr=0.1721 | 6894.5 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.46795 | acc=0.8300 | tpr=0.9761 | fpr=0.1726 | 6411.7 samples/s | 25.0 steps/s
[Step= 500] | Loss=0.46890 | acc=0.8293 | tpr=0.9762 | fpr=0.1734 | 6684.3 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.46623 | acc=0.8300 | tpr=0.9753 | fpr=0.1727 | 12727.6 samples/s | 49.7 steps/s
Avg test loss: 0.46640, Avg test acc: 0.82986, Avg tpr: 0.97504, Avg fpr: 0.17278, total FA: 23990

server round 27/50

clients selected: [1 2 4 6 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=13601 Epoch=66.4] | Loss=0.21190 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.800 | 3525.8 samples/s | 55.1 steps/s
[Step=13650 Epoch=66.6] | Loss=0.04383 | Reg=0.00066 | acc=0.9531 | FP-Norm=0.775 | FP-Norm(final)=2.786 | 3652.2 samples/s | 57.1 steps/s
[Step=13700 Epoch=66.8] | Loss=0.03455 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.839 | FP-Norm(final)=2.780 | 3727.3 samples/s | 58.2 steps/s
[Step=13750 Epoch=67.1] | Loss=0.02988 | Reg=0.00076 | acc=0.9844 | FP-Norm=0.860 | FP-Norm(final)=2.777 | 3698.0 samples/s | 57.8 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02703 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.875 | FP-Norm(final)=2.776 | 4780.7 samples/s | 74.7 steps/s
[Step=13850 Epoch=67.6] | Loss=0.02347 | Reg=0.00080 | acc=0.9688 | FP-Norm=0.884 | FP-Norm(final)=2.777 | 1568.1 samples/s | 24.5 steps/s
[Step=13900 Epoch=67.8] | Loss=0.02094 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.885 | FP-Norm(final)=2.778 | 3685.1 samples/s | 57.6 steps/s
[Step=13950 Epoch=68.1] | Loss=0.01899 | Reg=0.00079 | acc=0.9844 | FP-Norm=0.884 | FP-Norm(final)=2.781 | 3678.8 samples/s | 57.5 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01778 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.882 | FP-Norm(final)=2.783 | 4520.3 samples/s | 70.6 steps/s
[Step=14050 Epoch=68.6] | Loss=0.01660 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.881 | FP-Norm(final)=2.785 | 1589.7 samples/s | 24.8 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01568 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.880 | FP-Norm(final)=2.788 | 3743.7 samples/s | 58.5 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01487 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.879 | FP-Norm(final)=2.790 | 3733.6 samples/s | 58.3 steps/s
[Step=14200 Epoch=69.3] | Loss=0.01417 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.879 | FP-Norm(final)=2.792 | 4323.0 samples/s | 67.5 steps/s
[Step=14250 Epoch=69.5] | Loss=0.01358 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.879 | FP-Norm(final)=2.795 | 1620.2 samples/s | 25.3 steps/s
[Step=14300 Epoch=69.8] | Loss=0.01318 | Reg=0.00078 | acc=0.9844 | FP-Norm=0.879 | FP-Norm(final)=2.797 | 3723.7 samples/s | 58.2 steps/s
[Step=14350 Epoch=70.0] | Loss=0.01274 | Reg=0.00078 | acc=0.9844 | FP-Norm=0.878 | FP-Norm(final)=2.799 | 3706.7 samples/s | 57.9 steps/s
[Step=14400 Epoch=70.3] | Loss=0.01227 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.878 | FP-Norm(final)=2.800 | 4200.6 samples/s | 65.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step14400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=14401 Epoch=70.2] | Loss=0.22261 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.800 | 3441.2 samples/s | 53.8 steps/s
[Step=14450 Epoch=70.4] | Loss=0.04267 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.688 | FP-Norm(final)=2.788 | 3694.3 samples/s | 57.7 steps/s
[Step=14500 Epoch=70.7] | Loss=0.03083 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.759 | FP-Norm(final)=2.786 | 3739.9 samples/s | 58.4 steps/s
[Step=14550 Epoch=70.9] | Loss=0.02660 | Reg=0.00063 | acc=0.9844 | FP-Norm=0.782 | FP-Norm(final)=2.786 | 3729.2 samples/s | 58.3 steps/s
[Step=14600 Epoch=71.1] | Loss=0.02401 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.797 | FP-Norm(final)=2.788 | 4767.2 samples/s | 74.5 steps/s
[Step=14650 Epoch=71.4] | Loss=0.02086 | Reg=0.00066 | acc=0.9688 | FP-Norm=0.804 | FP-Norm(final)=2.790 | 1566.8 samples/s | 24.5 steps/s
[Step=14700 Epoch=71.6] | Loss=0.01876 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.807 | FP-Norm(final)=2.793 | 3729.5 samples/s | 58.3 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01714 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.808 | FP-Norm(final)=2.796 | 3661.1 samples/s | 57.2 steps/s
[Step=14800 Epoch=72.1] | Loss=0.01603 | Reg=0.00066 | acc=0.9688 | FP-Norm=0.809 | FP-Norm(final)=2.799 | 4484.6 samples/s | 70.1 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01513 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.810 | FP-Norm(final)=2.801 | 1613.9 samples/s | 25.2 steps/s
[Step=14900 Epoch=72.6] | Loss=0.01408 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.810 | FP-Norm(final)=2.804 | 3707.0 samples/s | 57.9 steps/s
[Step=14950 Epoch=72.8] | Loss=0.01347 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.810 | FP-Norm(final)=2.806 | 3726.3 samples/s | 58.2 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01291 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.811 | FP-Norm(final)=2.809 | 4212.1 samples/s | 65.8 steps/s
[Step=15050 Epoch=73.3] | Loss=0.01229 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.811 | 1645.4 samples/s | 25.7 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01177 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.813 | 3749.5 samples/s | 58.6 steps/s
[Step=15150 Epoch=73.8] | Loss=0.01145 | Reg=0.00067 | acc=0.9688 | FP-Norm=0.813 | FP-Norm(final)=2.816 | 3711.6 samples/s | 58.0 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01119 | Reg=0.00067 | acc=0.9844 | FP-Norm=0.815 | FP-Norm(final)=2.818 | 3981.4 samples/s | 62.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step15200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=43.2] | Loss=0.15626 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.799 | 3542.8 samples/s | 55.4 steps/s
[Step=8850 Epoch=43.4] | Loss=0.03571 | Reg=0.00044 | acc=0.9844 | FP-Norm=0.638 | FP-Norm(final)=2.792 | 3576.2 samples/s | 55.9 steps/s
[Step=8900 Epoch=43.6] | Loss=0.02949 | Reg=0.00056 | acc=0.9531 | FP-Norm=0.731 | FP-Norm(final)=2.788 | 3733.0 samples/s | 58.3 steps/s
[Step=8950 Epoch=43.9] | Loss=0.02598 | Reg=0.00061 | acc=0.9844 | FP-Norm=0.770 | FP-Norm(final)=2.786 | 3724.2 samples/s | 58.2 steps/s
[Step=9000 Epoch=44.1] | Loss=0.02351 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.794 | FP-Norm(final)=2.787 | 4844.2 samples/s | 75.7 steps/s
[Step=9050 Epoch=44.4] | Loss=0.02059 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.808 | FP-Norm(final)=2.788 | 1558.2 samples/s | 24.3 steps/s
[Step=9100 Epoch=44.6] | Loss=0.01889 | Reg=0.00068 | acc=0.9844 | FP-Norm=0.815 | FP-Norm(final)=2.790 | 3717.7 samples/s | 58.1 steps/s
[Step=9150 Epoch=44.9] | Loss=0.01756 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.819 | FP-Norm(final)=2.792 | 3715.2 samples/s | 58.0 steps/s
[Step=9200 Epoch=45.1] | Loss=0.01608 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.821 | FP-Norm(final)=2.793 | 4638.4 samples/s | 72.5 steps/s
[Step=9250 Epoch=45.4] | Loss=0.01483 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.822 | FP-Norm(final)=2.795 | 1579.3 samples/s | 24.7 steps/s
[Step=9300 Epoch=45.6] | Loss=0.01373 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.822 | FP-Norm(final)=2.797 | 3762.2 samples/s | 58.8 steps/s
[Step=9350 Epoch=45.9] | Loss=0.01320 | Reg=0.00068 | acc=0.9688 | FP-Norm=0.822 | FP-Norm(final)=2.799 | 3731.5 samples/s | 58.3 steps/s
[Step=9400 Epoch=46.1] | Loss=0.01296 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.824 | FP-Norm(final)=2.801 | 4455.0 samples/s | 69.6 steps/s
[Step=9450 Epoch=46.3] | Loss=0.01229 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.825 | FP-Norm(final)=2.803 | 1619.9 samples/s | 25.3 steps/s
[Step=9500 Epoch=46.6] | Loss=0.01171 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.804 | 3738.4 samples/s | 58.4 steps/s
[Step=9550 Epoch=46.8] | Loss=0.01138 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.806 | 3665.7 samples/s | 57.3 steps/s
[Step=9600 Epoch=47.1] | Loss=0.01103 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.827 | FP-Norm(final)=2.808 | 4280.8 samples/s | 66.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step9600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=7201 Epoch=68.5] | Loss=0.14673 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.799 | 3707.4 samples/s | 57.9 steps/s
[Step=7250 Epoch=69.0] | Loss=0.00711 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.799 | 3279.4 samples/s | 51.2 steps/s
[Step=7300 Epoch=69.4] | Loss=0.00396 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.891 | FP-Norm(final)=2.802 | 4638.1 samples/s | 72.5 steps/s
[Step=7350 Epoch=69.9] | Loss=0.00267 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.894 | FP-Norm(final)=2.805 | 1516.0 samples/s | 23.7 steps/s
[Step=7400 Epoch=70.4] | Loss=0.00203 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.881 | FP-Norm(final)=2.806 | 4342.3 samples/s | 67.8 steps/s
[Step=7450 Epoch=70.9] | Loss=0.00163 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.865 | FP-Norm(final)=2.807 | 1547.4 samples/s | 24.2 steps/s
[Step=7500 Epoch=71.3] | Loss=0.00136 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.848 | FP-Norm(final)=2.808 | 4052.6 samples/s | 63.3 steps/s
[Step=7550 Epoch=71.8] | Loss=0.00118 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.833 | FP-Norm(final)=2.809 | 1585.2 samples/s | 24.8 steps/s
[Step=7600 Epoch=72.3] | Loss=0.00103 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.810 | 3831.2 samples/s | 59.9 steps/s
[Step=7650 Epoch=72.8] | Loss=0.00092 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.804 | FP-Norm(final)=2.810 | 1621.0 samples/s | 25.3 steps/s
[Step=7700 Epoch=73.2] | Loss=0.00083 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.792 | FP-Norm(final)=2.811 | 3655.7 samples/s | 57.1 steps/s
[Step=7750 Epoch=73.7] | Loss=0.00076 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.811 | 1671.9 samples/s | 26.1 steps/s
[Step=7800 Epoch=74.2] | Loss=0.00070 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.769 | FP-Norm(final)=2.811 | 3640.1 samples/s | 56.9 steps/s
[Step=7850 Epoch=74.7] | Loss=0.00065 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.758 | FP-Norm(final)=2.812 | 1709.1 samples/s | 26.7 steps/s
[Step=7900 Epoch=75.1] | Loss=0.00060 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.748 | FP-Norm(final)=2.812 | 3552.3 samples/s | 55.5 steps/s
[Step=7950 Epoch=75.6] | Loss=0.00057 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.739 | FP-Norm(final)=2.813 | 1707.5 samples/s | 26.7 steps/s
[Step=8000 Epoch=76.1] | Loss=0.00053 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.729 | FP-Norm(final)=2.813 | 3534.6 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step8000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12801 Epoch=120.6] | Loss=0.03662 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.800 | 3481.3 samples/s | 54.4 steps/s
[Step=12850 Epoch=121.1] | Loss=0.00655 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.835 | FP-Norm(final)=2.799 | 3261.3 samples/s | 51.0 steps/s
[Step=12900 Epoch=121.6] | Loss=0.00427 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.919 | FP-Norm(final)=2.802 | 4532.3 samples/s | 70.8 steps/s
[Step=12950 Epoch=122.0] | Loss=0.00290 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.944 | FP-Norm(final)=2.805 | 1543.3 samples/s | 24.1 steps/s
[Step=13000 Epoch=122.5] | Loss=0.00219 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.940 | FP-Norm(final)=2.807 | 4210.9 samples/s | 65.8 steps/s
[Step=13050 Epoch=123.0] | Loss=0.00176 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.929 | FP-Norm(final)=2.808 | 1577.2 samples/s | 24.6 steps/s
[Step=13100 Epoch=123.4] | Loss=0.00147 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.915 | FP-Norm(final)=2.809 | 3963.4 samples/s | 61.9 steps/s
[Step=13150 Epoch=123.9] | Loss=0.00126 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.900 | FP-Norm(final)=2.809 | 1621.7 samples/s | 25.3 steps/s
[Step=13200 Epoch=124.4] | Loss=0.00111 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.887 | FP-Norm(final)=2.810 | 3661.9 samples/s | 57.2 steps/s
[Step=13250 Epoch=124.9] | Loss=0.00099 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.873 | FP-Norm(final)=2.810 | 1659.0 samples/s | 25.9 steps/s
[Step=13300 Epoch=125.3] | Loss=0.00089 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.861 | FP-Norm(final)=2.811 | 3572.9 samples/s | 55.8 steps/s
[Step=13350 Epoch=125.8] | Loss=0.00081 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.849 | FP-Norm(final)=2.811 | 1683.6 samples/s | 26.3 steps/s
[Step=13400 Epoch=126.3] | Loss=0.00075 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.838 | FP-Norm(final)=2.811 | 3615.3 samples/s | 56.5 steps/s
[Step=13450 Epoch=126.7] | Loss=0.00069 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.827 | FP-Norm(final)=2.812 | 1691.0 samples/s | 26.4 steps/s
[Step=13500 Epoch=127.2] | Loss=0.00064 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.812 | 3548.6 samples/s | 55.4 steps/s
[Step=13550 Epoch=127.7] | Loss=0.00060 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.806 | FP-Norm(final)=2.812 | 1759.6 samples/s | 27.5 steps/s
[Step=13600 Epoch=128.2] | Loss=0.00057 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.797 | FP-Norm(final)=2.812 | 3326.7 samples/s | 52.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30093 | acc=0.8113 | tpr=0.7321 | fpr=0.0166 | 3533.3 samples/s | 13.8 steps/s
Avg test loss: 0.30798, Avg test acc: 0.80904, Avg tpr: 0.73020, Avg fpr: 0.01756, total FA: 137

Testing server on iccad2012
[Step=  50] | Loss=0.47209 | acc=0.8279 | tpr=0.9646 | fpr=0.1746 | 3573.6 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.47399 | acc=0.8260 | tpr=0.9701 | fpr=0.1767 | 6718.4 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.48069 | acc=0.8253 | tpr=0.9769 | fpr=0.1775 | 6828.0 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.48046 | acc=0.8262 | tpr=0.9770 | fpr=0.1765 | 6848.3 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.48034 | acc=0.8257 | tpr=0.9764 | fpr=0.1770 | 6274.9 samples/s | 24.5 steps/s
[Step= 300] | Loss=0.48173 | acc=0.8256 | tpr=0.9753 | fpr=0.1772 | 4387.2 samples/s | 17.1 steps/s
[Step= 350] | Loss=0.48378 | acc=0.8258 | tpr=0.9762 | fpr=0.1769 | 6788.3 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.48362 | acc=0.8258 | tpr=0.9787 | fpr=0.1770 | 6582.3 samples/s | 25.7 steps/s
[Step= 450] | Loss=0.48849 | acc=0.8251 | tpr=0.9786 | fpr=0.1777 | 6778.3 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.48951 | acc=0.8244 | tpr=0.9789 | fpr=0.1784 | 6532.9 samples/s | 25.5 steps/s
[Step= 550] | Loss=0.48674 | acc=0.8250 | tpr=0.9785 | fpr=0.1778 | 12412.5 samples/s | 48.5 steps/s
Avg test loss: 0.48687, Avg test acc: 0.82487, Avg tpr: 0.97821, Avg fpr: 0.17792, total FA: 24704

server round 28/50

clients selected: [0 1 5 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=39.0] | Loss=0.28520 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.811 | 3670.9 samples/s | 57.4 steps/s
[Step=8050 Epoch=39.3] | Loss=0.04063 | Reg=0.00046 | acc=0.9844 | FP-Norm=0.649 | FP-Norm(final)=2.798 | 3479.7 samples/s | 54.4 steps/s
[Step=8100 Epoch=39.5] | Loss=0.02998 | Reg=0.00054 | acc=0.9375 | FP-Norm=0.721 | FP-Norm(final)=2.795 | 3694.3 samples/s | 57.7 steps/s
[Step=8150 Epoch=39.7] | Loss=0.02554 | Reg=0.00057 | acc=0.9844 | FP-Norm=0.744 | FP-Norm(final)=2.795 | 3692.7 samples/s | 57.7 steps/s
[Step=8200 Epoch=40.0] | Loss=0.02452 | Reg=0.00060 | acc=0.9531 | FP-Norm=0.763 | FP-Norm(final)=2.796 | 4753.9 samples/s | 74.3 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02185 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.778 | FP-Norm(final)=2.797 | 1565.2 samples/s | 24.5 steps/s
[Step=8300 Epoch=40.5] | Loss=0.01995 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.787 | FP-Norm(final)=2.799 | 3718.5 samples/s | 58.1 steps/s
[Step=8350 Epoch=40.7] | Loss=0.01822 | Reg=0.00063 | acc=0.9844 | FP-Norm=0.790 | FP-Norm(final)=2.801 | 3731.0 samples/s | 58.3 steps/s
[Step=8400 Epoch=41.0] | Loss=0.01710 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.792 | FP-Norm(final)=2.803 | 4478.8 samples/s | 70.0 steps/s
[Step=8450 Epoch=41.2] | Loss=0.01597 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.794 | FP-Norm(final)=2.805 | 1617.6 samples/s | 25.3 steps/s
[Step=8500 Epoch=41.4] | Loss=0.01500 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.795 | FP-Norm(final)=2.807 | 3717.6 samples/s | 58.1 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01442 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.797 | FP-Norm(final)=2.810 | 3668.4 samples/s | 57.3 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01375 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.799 | FP-Norm(final)=2.812 | 4240.1 samples/s | 66.3 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01307 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.802 | FP-Norm(final)=2.814 | 1640.3 samples/s | 25.6 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01251 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.804 | FP-Norm(final)=2.816 | 3743.7 samples/s | 58.5 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01203 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.818 | 3714.8 samples/s | 58.0 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01162 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.821 | 4019.8 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step8800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=14401 Epoch=70.3] | Loss=0.27089 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.811 | 3674.7 samples/s | 57.4 steps/s
[Step=14450 Epoch=70.5] | Loss=0.04640 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.748 | FP-Norm(final)=2.799 | 3515.6 samples/s | 54.9 steps/s
[Step=14500 Epoch=70.8] | Loss=0.03744 | Reg=0.00072 | acc=0.9844 | FP-Norm=0.829 | FP-Norm(final)=2.792 | 3684.7 samples/s | 57.6 steps/s
[Step=14550 Epoch=71.0] | Loss=0.03110 | Reg=0.00076 | acc=0.9688 | FP-Norm=0.858 | FP-Norm(final)=2.789 | 3740.3 samples/s | 58.4 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02716 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.868 | FP-Norm(final)=2.789 | 4804.0 samples/s | 75.1 steps/s
[Step=14650 Epoch=71.5] | Loss=0.02323 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.790 | 1573.1 samples/s | 24.6 steps/s
[Step=14700 Epoch=71.7] | Loss=0.02104 | Reg=0.00077 | acc=0.9844 | FP-Norm=0.871 | FP-Norm(final)=2.793 | 3711.9 samples/s | 58.0 steps/s
[Step=14750 Epoch=72.0] | Loss=0.01879 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.870 | FP-Norm(final)=2.795 | 3706.4 samples/s | 57.9 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01783 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.869 | FP-Norm(final)=2.797 | 4569.5 samples/s | 71.4 steps/s
[Step=14850 Epoch=72.5] | Loss=0.01652 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.868 | FP-Norm(final)=2.799 | 1582.0 samples/s | 24.7 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01572 | Reg=0.00076 | acc=0.9844 | FP-Norm=0.867 | FP-Norm(final)=2.801 | 3689.9 samples/s | 57.7 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01474 | Reg=0.00076 | acc=0.9844 | FP-Norm=0.866 | FP-Norm(final)=2.803 | 3719.4 samples/s | 58.1 steps/s
[Step=15000 Epoch=73.2] | Loss=0.01423 | Reg=0.00075 | acc=0.9844 | FP-Norm=0.865 | FP-Norm(final)=2.805 | 4303.4 samples/s | 67.2 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01368 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.864 | FP-Norm(final)=2.807 | 1619.5 samples/s | 25.3 steps/s
[Step=15100 Epoch=73.7] | Loss=0.01317 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.864 | FP-Norm(final)=2.809 | 3720.2 samples/s | 58.1 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01268 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.864 | FP-Norm(final)=2.811 | 3717.1 samples/s | 58.1 steps/s
[Step=15200 Epoch=74.2] | Loss=0.01223 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.863 | FP-Norm(final)=2.812 | 4101.2 samples/s | 64.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step15200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=13601 Epoch=128.9] | Loss=0.10838 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.811 | 3655.3 samples/s | 57.1 steps/s
[Step=13650 Epoch=129.3] | Loss=0.00476 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.692 | FP-Norm(final)=2.812 | 3160.5 samples/s | 49.4 steps/s
[Step=13700 Epoch=129.8] | Loss=0.00279 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.759 | FP-Norm(final)=2.815 | 4614.4 samples/s | 72.1 steps/s
[Step=13750 Epoch=130.3] | Loss=0.00189 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.767 | FP-Norm(final)=2.818 | 1523.5 samples/s | 23.8 steps/s
[Step=13800 Epoch=130.8] | Loss=0.00144 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.761 | FP-Norm(final)=2.820 | 4333.9 samples/s | 67.7 steps/s
[Step=13850 Epoch=131.2] | Loss=0.00116 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.751 | FP-Norm(final)=2.821 | 1560.7 samples/s | 24.4 steps/s
[Step=13900 Epoch=131.7] | Loss=0.00097 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.740 | FP-Norm(final)=2.822 | 4063.3 samples/s | 63.5 steps/s
[Step=13950 Epoch=132.2] | Loss=0.00084 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.729 | FP-Norm(final)=2.823 | 1578.1 samples/s | 24.7 steps/s
[Step=14000 Epoch=132.7] | Loss=0.00074 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.718 | FP-Norm(final)=2.823 | 3825.2 samples/s | 59.8 steps/s
[Step=14050 Epoch=133.1] | Loss=0.00066 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.707 | FP-Norm(final)=2.824 | 1632.1 samples/s | 25.5 steps/s
[Step=14100 Epoch=133.6] | Loss=0.00060 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.697 | FP-Norm(final)=2.825 | 3633.3 samples/s | 56.8 steps/s
[Step=14150 Epoch=134.1] | Loss=0.00055 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.688 | FP-Norm(final)=2.825 | 1657.9 samples/s | 25.9 steps/s
[Step=14200 Epoch=134.6] | Loss=0.00050 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.679 | FP-Norm(final)=2.825 | 3563.3 samples/s | 55.7 steps/s
[Step=14250 Epoch=135.0] | Loss=0.00047 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.670 | FP-Norm(final)=2.826 | 1694.0 samples/s | 26.5 steps/s
[Step=14300 Epoch=135.5] | Loss=0.00044 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.662 | FP-Norm(final)=2.826 | 3552.1 samples/s | 55.5 steps/s
[Step=14350 Epoch=136.0] | Loss=0.00041 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.654 | FP-Norm(final)=2.827 | 1698.6 samples/s | 26.5 steps/s
[Step=14400 Epoch=136.5] | Loss=0.00039 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.646 | FP-Norm(final)=2.827 | 3556.3 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step14400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=76.1] | Loss=0.14484 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.811 | 3250.4 samples/s | 50.8 steps/s
[Step=8050 Epoch=76.6] | Loss=0.00943 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.864 | FP-Norm(final)=2.808 | 1819.6 samples/s | 28.4 steps/s
[Step=8100 Epoch=77.1] | Loss=0.00503 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.923 | FP-Norm(final)=2.810 | 4273.7 samples/s | 66.8 steps/s
[Step=8150 Epoch=77.5] | Loss=0.00339 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.920 | FP-Norm(final)=2.812 | 1498.4 samples/s | 23.4 steps/s
[Step=8200 Epoch=78.0] | Loss=0.00256 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.905 | FP-Norm(final)=2.813 | 4372.3 samples/s | 68.3 steps/s
[Step=8250 Epoch=78.5] | Loss=0.00208 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.889 | FP-Norm(final)=2.815 | 1581.3 samples/s | 24.7 steps/s
[Step=8300 Epoch=79.0] | Loss=0.00174 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.873 | FP-Norm(final)=2.816 | 4051.9 samples/s | 63.3 steps/s
[Step=8350 Epoch=79.4] | Loss=0.00150 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.857 | FP-Norm(final)=2.817 | 1617.0 samples/s | 25.3 steps/s
[Step=8400 Epoch=79.9] | Loss=0.00132 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.842 | FP-Norm(final)=2.818 | 3837.2 samples/s | 60.0 steps/s
[Step=8450 Epoch=80.4] | Loss=0.00117 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.818 | 1651.1 samples/s | 25.8 steps/s
[Step=8500 Epoch=80.9] | Loss=0.00106 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.819 | 3647.0 samples/s | 57.0 steps/s
[Step=8550 Epoch=81.3] | Loss=0.00097 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.804 | FP-Norm(final)=2.819 | 1682.1 samples/s | 26.3 steps/s
[Step=8600 Epoch=81.8] | Loss=0.00089 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.820 | 3560.8 samples/s | 55.6 steps/s
[Step=8650 Epoch=82.3] | Loss=0.00082 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.782 | FP-Norm(final)=2.820 | 1718.8 samples/s | 26.9 steps/s
[Step=8700 Epoch=82.8] | Loss=0.00077 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.821 | 3537.0 samples/s | 55.3 steps/s
[Step=8750 Epoch=83.2] | Loss=0.00072 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.821 | 1719.1 samples/s | 26.9 steps/s
[Step=8800 Epoch=83.7] | Loss=0.00067 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.752 | FP-Norm(final)=2.822 | 3418.9 samples/s | 53.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step8800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=91.7] | Loss=0.08043 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.811 | 3610.9 samples/s | 56.4 steps/s
[Step=9650 Epoch=92.2] | Loss=0.00762 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.859 | FP-Norm(final)=2.809 | 3287.9 samples/s | 51.4 steps/s
[Step=9700 Epoch=92.6] | Loss=0.00402 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.938 | FP-Norm(final)=2.810 | 4632.7 samples/s | 72.4 steps/s
[Step=9750 Epoch=93.1] | Loss=0.00272 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.939 | FP-Norm(final)=2.812 | 1532.5 samples/s | 23.9 steps/s
[Step=9800 Epoch=93.6] | Loss=0.00206 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.923 | FP-Norm(final)=2.813 | 4418.3 samples/s | 69.0 steps/s
[Step=9850 Epoch=94.1] | Loss=0.00166 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.906 | FP-Norm(final)=2.814 | 1540.8 samples/s | 24.1 steps/s
[Step=9900 Epoch=94.5] | Loss=0.00139 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.889 | FP-Norm(final)=2.815 | 4141.1 samples/s | 64.7 steps/s
[Step=9950 Epoch=95.0] | Loss=0.00119 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.873 | FP-Norm(final)=2.816 | 1599.2 samples/s | 25.0 steps/s
[Step=10000 Epoch=95.5] | Loss=0.00105 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.858 | FP-Norm(final)=2.816 | 3981.6 samples/s | 62.2 steps/s
[Step=10050 Epoch=96.0] | Loss=0.00094 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.843 | FP-Norm(final)=2.817 | 1615.9 samples/s | 25.2 steps/s
[Step=10100 Epoch=96.4] | Loss=0.00085 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.830 | FP-Norm(final)=2.818 | 3751.0 samples/s | 58.6 steps/s
[Step=10150 Epoch=96.9] | Loss=0.00077 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.818 | 1641.0 samples/s | 25.6 steps/s
[Step=10200 Epoch=97.4] | Loss=0.00071 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.806 | FP-Norm(final)=2.819 | 3601.2 samples/s | 56.3 steps/s
[Step=10250 Epoch=97.9] | Loss=0.00066 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.795 | FP-Norm(final)=2.819 | 1687.2 samples/s | 26.4 steps/s
[Step=10300 Epoch=98.4] | Loss=0.00061 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.784 | FP-Norm(final)=2.820 | 3537.9 samples/s | 55.3 steps/s
[Step=10350 Epoch=98.8] | Loss=0.00057 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.820 | 1690.1 samples/s | 26.4 steps/s
[Step=10400 Epoch=99.3] | Loss=0.00054 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.820 | 3607.4 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28887 | acc=0.8209 | tpr=0.7458 | fpr=0.0159 | 3555.0 samples/s | 13.9 steps/s
Avg test loss: 0.29533, Avg test acc: 0.81858, Avg tpr: 0.74366, Avg fpr: 0.01666, total FA: 130

Testing server on iccad2012
[Step=  50] | Loss=0.49911 | acc=0.8201 | tpr=0.9558 | fpr=0.1824 | 3591.9 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.50142 | acc=0.8169 | tpr=0.9638 | fpr=0.1858 | 6749.2 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.50802 | acc=0.8160 | tpr=0.9726 | fpr=0.1868 | 6777.4 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.50757 | acc=0.8171 | tpr=0.9738 | fpr=0.1858 | 6832.3 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.50786 | acc=0.8166 | tpr=0.9747 | fpr=0.1863 | 6711.5 samples/s | 26.2 steps/s
[Step= 300] | Loss=0.50936 | acc=0.8161 | tpr=0.9738 | fpr=0.1868 | 6733.9 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.51155 | acc=0.8165 | tpr=0.9750 | fpr=0.1864 | 6769.5 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.51143 | acc=0.8164 | tpr=0.9765 | fpr=0.1865 | 6618.0 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.51640 | acc=0.8159 | tpr=0.9766 | fpr=0.1871 | 6591.7 samples/s | 25.7 steps/s
[Step= 500] | Loss=0.51744 | acc=0.8150 | tpr=0.9771 | fpr=0.1879 | 6855.5 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.51446 | acc=0.8158 | tpr=0.9765 | fpr=0.1871 | 12413.2 samples/s | 48.5 steps/s
Avg test loss: 0.51459, Avg test acc: 0.81571, Avg tpr: 0.97623, Avg fpr: 0.18721, total FA: 25994

server round 29/50

clients selected: [0 5 6 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=42.9] | Loss=0.34514 | Reg=0.00000 | acc=0.7812 | FP-Norm=0.000 | FP-Norm(final)=2.829 | 3787.9 samples/s | 59.2 steps/s
[Step=8850 Epoch=43.2] | Loss=0.03919 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.721 | FP-Norm(final)=2.817 | 3338.3 samples/s | 52.2 steps/s
[Step=8900 Epoch=43.4] | Loss=0.02924 | Reg=0.00064 | acc=0.9688 | FP-Norm=0.784 | FP-Norm(final)=2.813 | 3735.6 samples/s | 58.4 steps/s
[Step=8950 Epoch=43.6] | Loss=0.02463 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.804 | FP-Norm(final)=2.813 | 3731.9 samples/s | 58.3 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02408 | Reg=0.00068 | acc=0.9688 | FP-Norm=0.817 | FP-Norm(final)=2.814 | 4775.0 samples/s | 74.6 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02135 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.827 | FP-Norm(final)=2.814 | 1587.8 samples/s | 24.8 steps/s
[Step=9100 Epoch=44.4] | Loss=0.01927 | Reg=0.00070 | acc=0.9844 | FP-Norm=0.831 | FP-Norm(final)=2.816 | 3719.2 samples/s | 58.1 steps/s
[Step=9150 Epoch=44.6] | Loss=0.01744 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.832 | FP-Norm(final)=2.818 | 3738.5 samples/s | 58.4 steps/s
[Step=9200 Epoch=44.9] | Loss=0.01638 | Reg=0.00070 | acc=0.9844 | FP-Norm=0.832 | FP-Norm(final)=2.821 | 4484.8 samples/s | 70.1 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01531 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.831 | FP-Norm(final)=2.823 | 1606.8 samples/s | 25.1 steps/s
[Step=9300 Epoch=45.3] | Loss=0.01423 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.830 | FP-Norm(final)=2.826 | 3701.9 samples/s | 57.8 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01344 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.828 | 3741.2 samples/s | 58.5 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01301 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.830 | 4225.2 samples/s | 66.0 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01254 | Reg=0.00069 | acc=0.9844 | FP-Norm=0.830 | FP-Norm(final)=2.832 | 1662.7 samples/s | 26.0 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01202 | Reg=0.00069 | acc=0.9844 | FP-Norm=0.830 | FP-Norm(final)=2.834 | 3711.3 samples/s | 58.0 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01150 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.836 | 3710.8 samples/s | 58.0 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01118 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.838 | 4024.3 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step9600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=14401 Epoch=136.5] | Loss=0.19185 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.829 | 3453.9 samples/s | 54.0 steps/s
[Step=14450 Epoch=136.9] | Loss=0.01306 | Reg=0.00121 | acc=0.9844 | FP-Norm=1.052 | FP-Norm(final)=2.820 | 3384.4 samples/s | 52.9 steps/s
[Step=14500 Epoch=137.4] | Loss=0.00705 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.128 | FP-Norm(final)=2.821 | 4593.8 samples/s | 71.8 steps/s
[Step=14550 Epoch=137.9] | Loss=0.00474 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.128 | FP-Norm(final)=2.822 | 1527.6 samples/s | 23.9 steps/s
[Step=14600 Epoch=138.3] | Loss=0.00358 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.112 | FP-Norm(final)=2.823 | 4298.2 samples/s | 67.2 steps/s
[Step=14650 Epoch=138.8] | Loss=0.00288 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.094 | FP-Norm(final)=2.823 | 1566.5 samples/s | 24.5 steps/s
[Step=14700 Epoch=139.3] | Loss=0.00240 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.075 | FP-Norm(final)=2.824 | 4042.2 samples/s | 63.2 steps/s
[Step=14750 Epoch=139.8] | Loss=0.00207 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.057 | FP-Norm(final)=2.825 | 1607.2 samples/s | 25.1 steps/s
[Step=14800 Epoch=140.2] | Loss=0.00182 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.041 | FP-Norm(final)=2.825 | 3814.8 samples/s | 59.6 steps/s
[Step=14850 Epoch=140.7] | Loss=0.00162 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.025 | FP-Norm(final)=2.826 | 1645.3 samples/s | 25.7 steps/s
[Step=14900 Epoch=141.2] | Loss=0.00146 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.010 | FP-Norm(final)=2.827 | 3632.5 samples/s | 56.8 steps/s
[Step=14950 Epoch=141.7] | Loss=0.00133 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.996 | FP-Norm(final)=2.827 | 1668.4 samples/s | 26.1 steps/s
[Step=15000 Epoch=142.1] | Loss=0.00122 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.983 | FP-Norm(final)=2.828 | 3545.4 samples/s | 55.4 steps/s
[Step=15050 Epoch=142.6] | Loss=0.00113 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.971 | FP-Norm(final)=2.828 | 1676.4 samples/s | 26.2 steps/s
[Step=15100 Epoch=143.1] | Loss=0.00105 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.959 | FP-Norm(final)=2.829 | 3586.6 samples/s | 56.0 steps/s
[Step=15150 Epoch=143.6] | Loss=0.00098 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.947 | FP-Norm(final)=2.829 | 1696.1 samples/s | 26.5 steps/s
[Step=15200 Epoch=144.0] | Loss=0.00092 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.936 | FP-Norm(final)=2.829 | 3523.0 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step15200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=83.7] | Loss=0.14891 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.829 | 3549.5 samples/s | 55.5 steps/s
[Step=8850 Epoch=84.2] | Loss=0.01670 | Reg=0.00126 | acc=0.9844 | FP-Norm=1.076 | FP-Norm(final)=2.821 | 3371.6 samples/s | 52.7 steps/s
[Step=8900 Epoch=84.7] | Loss=0.00885 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.171 | FP-Norm(final)=2.823 | 4631.4 samples/s | 72.4 steps/s
[Step=8950 Epoch=85.1] | Loss=0.00595 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.172 | FP-Norm(final)=2.825 | 1538.2 samples/s | 24.0 steps/s
[Step=9000 Epoch=85.6] | Loss=0.00448 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.155 | FP-Norm(final)=2.826 | 4296.7 samples/s | 67.1 steps/s
[Step=9050 Epoch=86.1] | Loss=0.00360 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.135 | FP-Norm(final)=2.828 | 1548.0 samples/s | 24.2 steps/s
[Step=9100 Epoch=86.6] | Loss=0.00301 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.115 | FP-Norm(final)=2.829 | 4055.6 samples/s | 63.4 steps/s
[Step=9150 Epoch=87.0] | Loss=0.00259 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.096 | FP-Norm(final)=2.829 | 1599.3 samples/s | 25.0 steps/s
[Step=9200 Epoch=87.5] | Loss=0.00227 | Reg=0.00119 | acc=1.0000 | FP-Norm=1.078 | FP-Norm(final)=2.830 | 3831.8 samples/s | 59.9 steps/s
[Step=9250 Epoch=88.0] | Loss=0.00203 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.062 | FP-Norm(final)=2.831 | 1634.3 samples/s | 25.5 steps/s
[Step=9300 Epoch=88.5] | Loss=0.00183 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.046 | FP-Norm(final)=2.832 | 3623.5 samples/s | 56.6 steps/s
[Step=9350 Epoch=88.9] | Loss=0.00167 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.031 | FP-Norm(final)=2.832 | 1656.9 samples/s | 25.9 steps/s
[Step=9400 Epoch=89.4] | Loss=0.00153 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.018 | FP-Norm(final)=2.833 | 3548.5 samples/s | 55.4 steps/s
[Step=9450 Epoch=89.9] | Loss=0.00142 | Reg=0.00103 | acc=1.0000 | FP-Norm=1.004 | FP-Norm(final)=2.833 | 1692.2 samples/s | 26.4 steps/s
[Step=9500 Epoch=90.4] | Loss=0.00132 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.992 | FP-Norm(final)=2.834 | 3576.5 samples/s | 55.9 steps/s
[Step=9550 Epoch=90.8] | Loss=0.00123 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.980 | FP-Norm(final)=2.834 | 1684.1 samples/s | 26.3 steps/s
[Step=9600 Epoch=91.3] | Loss=0.00116 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.968 | FP-Norm(final)=2.835 | 3526.5 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step9600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=99.3] | Loss=0.02412 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.830 | 3335.1 samples/s | 52.1 steps/s
[Step=10450 Epoch=99.8] | Loss=0.00461 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.785 | FP-Norm(final)=2.832 | 3505.4 samples/s | 54.8 steps/s
[Step=10500 Epoch=100.3] | Loss=0.00250 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.835 | FP-Norm(final)=2.835 | 4667.4 samples/s | 72.9 steps/s
[Step=10550 Epoch=100.7] | Loss=0.00170 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.827 | FP-Norm(final)=2.838 | 1513.1 samples/s | 23.6 steps/s
[Step=10600 Epoch=101.2] | Loss=0.00129 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.839 | 4411.4 samples/s | 68.9 steps/s
[Step=10650 Epoch=101.7] | Loss=0.00104 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.792 | FP-Norm(final)=2.840 | 1547.6 samples/s | 24.2 steps/s
[Step=10700 Epoch=102.2] | Loss=0.00087 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.841 | 4156.1 samples/s | 64.9 steps/s
[Step=10750 Epoch=102.7] | Loss=0.00075 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.760 | FP-Norm(final)=2.842 | 1579.2 samples/s | 24.7 steps/s
[Step=10800 Epoch=103.1] | Loss=0.00066 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.746 | FP-Norm(final)=2.843 | 3974.3 samples/s | 62.1 steps/s
[Step=10850 Epoch=103.6] | Loss=0.00059 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.732 | FP-Norm(final)=2.843 | 1612.8 samples/s | 25.2 steps/s
[Step=10900 Epoch=104.1] | Loss=0.00054 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.720 | FP-Norm(final)=2.844 | 3808.5 samples/s | 59.5 steps/s
[Step=10950 Epoch=104.6] | Loss=0.00049 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.709 | FP-Norm(final)=2.844 | 1641.2 samples/s | 25.6 steps/s
[Step=11000 Epoch=105.0] | Loss=0.00045 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.698 | FP-Norm(final)=2.844 | 3667.7 samples/s | 57.3 steps/s
[Step=11050 Epoch=105.5] | Loss=0.00042 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.688 | FP-Norm(final)=2.845 | 1653.3 samples/s | 25.8 steps/s
[Step=11100 Epoch=106.0] | Loss=0.00039 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.679 | FP-Norm(final)=2.845 | 3582.8 samples/s | 56.0 steps/s
[Step=11150 Epoch=106.5] | Loss=0.00037 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.670 | FP-Norm(final)=2.845 | 1674.4 samples/s | 26.2 steps/s
[Step=11200 Epoch=107.0] | Loss=0.00035 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.661 | FP-Norm(final)=2.846 | 3582.4 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step11200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=91.5] | Loss=0.12644 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.829 | 3568.9 samples/s | 55.8 steps/s
[Step=9650 Epoch=92.0] | Loss=0.00854 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.875 | FP-Norm(final)=2.825 | 3323.2 samples/s | 51.9 steps/s
[Step=9700 Epoch=92.4] | Loss=0.00447 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.953 | FP-Norm(final)=2.826 | 4641.8 samples/s | 72.5 steps/s
[Step=9750 Epoch=92.9] | Loss=0.00301 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.957 | FP-Norm(final)=2.828 | 1529.2 samples/s | 23.9 steps/s
[Step=9800 Epoch=93.4] | Loss=0.00228 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.945 | FP-Norm(final)=2.829 | 4399.7 samples/s | 68.7 steps/s
[Step=9850 Epoch=93.9] | Loss=0.00183 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.931 | FP-Norm(final)=2.830 | 1569.5 samples/s | 24.5 steps/s
[Step=9900 Epoch=94.4] | Loss=0.00153 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.915 | FP-Norm(final)=2.830 | 4151.7 samples/s | 64.9 steps/s
[Step=9950 Epoch=94.8] | Loss=0.00131 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.901 | FP-Norm(final)=2.831 | 1582.8 samples/s | 24.7 steps/s
[Step=10000 Epoch=95.3] | Loss=0.00115 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.887 | FP-Norm(final)=2.832 | 3971.5 samples/s | 62.1 steps/s
[Step=10050 Epoch=95.8] | Loss=0.00103 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.873 | FP-Norm(final)=2.832 | 1596.1 samples/s | 24.9 steps/s
[Step=10100 Epoch=96.3] | Loss=0.00093 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.861 | FP-Norm(final)=2.832 | 3740.0 samples/s | 58.4 steps/s
[Step=10150 Epoch=96.7] | Loss=0.00085 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.849 | FP-Norm(final)=2.833 | 1666.1 samples/s | 26.0 steps/s
[Step=10200 Epoch=97.2] | Loss=0.00078 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.838 | FP-Norm(final)=2.833 | 3604.1 samples/s | 56.3 steps/s
[Step=10250 Epoch=97.7] | Loss=0.00072 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.827 | FP-Norm(final)=2.834 | 1669.1 samples/s | 26.1 steps/s
[Step=10300 Epoch=98.2] | Loss=0.00067 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.817 | FP-Norm(final)=2.834 | 3606.2 samples/s | 56.3 steps/s
[Step=10350 Epoch=98.6] | Loss=0.00063 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.834 | 1666.7 samples/s | 26.0 steps/s
[Step=10400 Epoch=99.1] | Loss=0.00059 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.834 | 3581.9 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29889 | acc=0.8153 | tpr=0.7378 | fpr=0.0164 | 3541.5 samples/s | 13.8 steps/s
Avg test loss: 0.30553, Avg test acc: 0.81240, Avg tpr: 0.73504, Avg fpr: 0.01743, total FA: 136

Testing server on iccad2012
[Step=  50] | Loss=0.47886 | acc=0.8305 | tpr=0.9602 | fpr=0.1719 | 3586.1 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.48078 | acc=0.8283 | tpr=0.9680 | fpr=0.1743 | 6806.4 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.48796 | acc=0.8273 | tpr=0.9755 | fpr=0.1754 | 6727.4 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.48776 | acc=0.8282 | tpr=0.9770 | fpr=0.1745 | 6965.0 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.48773 | acc=0.8278 | tpr=0.9782 | fpr=0.1750 | 6739.4 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.48934 | acc=0.8273 | tpr=0.9767 | fpr=0.1754 | 6764.1 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.49171 | acc=0.8276 | tpr=0.9768 | fpr=0.1752 | 6816.4 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.49162 | acc=0.8274 | tpr=0.9781 | fpr=0.1753 | 6683.0 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.49667 | acc=0.8268 | tpr=0.9781 | fpr=0.1760 | 6744.8 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.49741 | acc=0.8261 | tpr=0.9784 | fpr=0.1766 | 6508.5 samples/s | 25.4 steps/s
[Step= 550] | Loss=0.49452 | acc=0.8268 | tpr=0.9781 | fpr=0.1759 | 12474.8 samples/s | 48.7 steps/s
Avg test loss: 0.49465, Avg test acc: 0.82674, Avg tpr: 0.97781, Avg fpr: 0.17601, total FA: 24438

server round 30/50

clients selected: [1 5 7 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=74.2] | Loss=0.15663 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.839 | 3731.5 samples/s | 58.3 steps/s
[Step=15250 Epoch=74.4] | Loss=0.03658 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.497 | FP-Norm(final)=2.835 | 3428.8 samples/s | 53.6 steps/s
[Step=15300 Epoch=74.7] | Loss=0.02695 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.834 | 3707.5 samples/s | 57.9 steps/s
[Step=15350 Epoch=74.9] | Loss=0.02343 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.834 | 3737.8 samples/s | 58.4 steps/s
[Step=15400 Epoch=75.1] | Loss=0.02121 | Reg=0.00033 | acc=0.9688 | FP-Norm=0.571 | FP-Norm(final)=2.834 | 4817.3 samples/s | 75.3 steps/s
[Step=15450 Epoch=75.4] | Loss=0.01897 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.835 | 1567.1 samples/s | 24.5 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01669 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.836 | 3726.0 samples/s | 58.2 steps/s
[Step=15550 Epoch=75.9] | Loss=0.01511 | Reg=0.00035 | acc=0.9844 | FP-Norm=0.585 | FP-Norm(final)=2.838 | 3728.8 samples/s | 58.3 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01413 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.586 | FP-Norm(final)=2.839 | 4527.4 samples/s | 70.7 steps/s
[Step=15650 Epoch=76.4] | Loss=0.01314 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.588 | FP-Norm(final)=2.841 | 1588.5 samples/s | 24.8 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01243 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.588 | FP-Norm(final)=2.843 | 3717.4 samples/s | 58.1 steps/s
[Step=15750 Epoch=76.9] | Loss=0.01168 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.589 | FP-Norm(final)=2.844 | 3689.3 samples/s | 57.6 steps/s
[Step=15800 Epoch=77.1] | Loss=0.01110 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.589 | FP-Norm(final)=2.846 | 4297.7 samples/s | 67.2 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01059 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.590 | FP-Norm(final)=2.848 | 1619.4 samples/s | 25.3 steps/s
[Step=15900 Epoch=77.6] | Loss=0.01008 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.849 | 3753.4 samples/s | 58.6 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00970 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=2.851 | 3722.4 samples/s | 58.2 steps/s
[Step=16000 Epoch=78.1] | Loss=0.00942 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=2.853 | 4135.0 samples/s | 64.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=144.0] | Loss=0.15735 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.838 | 3360.3 samples/s | 52.5 steps/s
[Step=15250 Epoch=144.5] | Loss=0.00948 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.838 | 3533.0 samples/s | 55.2 steps/s
[Step=15300 Epoch=145.0] | Loss=0.00495 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.660 | FP-Norm(final)=2.839 | 4582.8 samples/s | 71.6 steps/s
[Step=15350 Epoch=145.5] | Loss=0.00337 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.656 | FP-Norm(final)=2.840 | 1535.7 samples/s | 24.0 steps/s
[Step=15400 Epoch=145.9] | Loss=0.00255 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.647 | FP-Norm(final)=2.841 | 4277.8 samples/s | 66.8 steps/s
[Step=15450 Epoch=146.4] | Loss=0.00206 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.635 | FP-Norm(final)=2.841 | 1574.5 samples/s | 24.6 steps/s
[Step=15500 Epoch=146.9] | Loss=0.00173 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.842 | 4048.2 samples/s | 63.3 steps/s
[Step=15550 Epoch=147.3] | Loss=0.00149 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.613 | FP-Norm(final)=2.842 | 1599.9 samples/s | 25.0 steps/s
[Step=15600 Epoch=147.8] | Loss=0.00131 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.603 | FP-Norm(final)=2.843 | 3830.5 samples/s | 59.9 steps/s
[Step=15650 Epoch=148.3] | Loss=0.00117 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=2.843 | 1632.0 samples/s | 25.5 steps/s
[Step=15700 Epoch=148.8] | Loss=0.00106 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.585 | FP-Norm(final)=2.843 | 3636.9 samples/s | 56.8 steps/s
[Step=15750 Epoch=149.2] | Loss=0.00097 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.844 | 1666.9 samples/s | 26.0 steps/s
[Step=15800 Epoch=149.7] | Loss=0.00089 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.844 | 3599.8 samples/s | 56.2 steps/s
[Step=15850 Epoch=150.2] | Loss=0.00083 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.844 | 1680.9 samples/s | 26.3 steps/s
[Step=15900 Epoch=150.7] | Loss=0.00077 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.845 | 3522.6 samples/s | 55.0 steps/s
[Step=15950 Epoch=151.1] | Loss=0.00072 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.845 | 1687.1 samples/s | 26.4 steps/s
[Step=16000 Epoch=151.6] | Loss=0.00068 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=2.845 | 3581.8 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step16000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=11201 Epoch=107.0] | Loss=0.08557 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.838 | 3765.8 samples/s | 58.8 steps/s
[Step=11250 Epoch=107.4] | Loss=0.01124 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.623 | FP-Norm(final)=2.836 | 3136.9 samples/s | 49.0 steps/s
[Step=11300 Epoch=107.9] | Loss=0.00590 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.689 | FP-Norm(final)=2.837 | 4664.7 samples/s | 72.9 steps/s
[Step=11350 Epoch=108.4] | Loss=0.00398 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.697 | FP-Norm(final)=2.838 | 1520.4 samples/s | 23.8 steps/s
[Step=11400 Epoch=108.9] | Loss=0.00301 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.690 | FP-Norm(final)=2.839 | 4385.1 samples/s | 68.5 steps/s
[Step=11450 Epoch=109.3] | Loss=0.00242 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.680 | FP-Norm(final)=2.839 | 1538.5 samples/s | 24.0 steps/s
[Step=11500 Epoch=109.8] | Loss=0.00203 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.670 | FP-Norm(final)=2.840 | 4193.5 samples/s | 65.5 steps/s
[Step=11550 Epoch=110.3] | Loss=0.00175 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.661 | FP-Norm(final)=2.840 | 1592.0 samples/s | 24.9 steps/s
[Step=11600 Epoch=110.8] | Loss=0.00154 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.652 | FP-Norm(final)=2.841 | 3921.0 samples/s | 61.3 steps/s
[Step=11650 Epoch=111.3] | Loss=0.00137 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.643 | FP-Norm(final)=2.841 | 1626.3 samples/s | 25.4 steps/s
[Step=11700 Epoch=111.7] | Loss=0.00124 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.635 | FP-Norm(final)=2.841 | 3756.5 samples/s | 58.7 steps/s
[Step=11750 Epoch=112.2] | Loss=0.00113 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.628 | FP-Norm(final)=2.842 | 1644.9 samples/s | 25.7 steps/s
[Step=11800 Epoch=112.7] | Loss=0.00104 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.842 | 3649.8 samples/s | 57.0 steps/s
[Step=11850 Epoch=113.2] | Loss=0.00097 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.614 | FP-Norm(final)=2.842 | 1667.2 samples/s | 26.1 steps/s
[Step=11900 Epoch=113.6] | Loss=0.00090 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.608 | FP-Norm(final)=2.843 | 3575.6 samples/s | 55.9 steps/s
[Step=11950 Epoch=114.1] | Loss=0.00084 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.602 | FP-Norm(final)=2.843 | 1683.7 samples/s | 26.3 steps/s
[Step=12000 Epoch=114.6] | Loss=0.00079 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.597 | FP-Norm(final)=2.843 | 3581.3 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step12000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=128.2] | Loss=0.11579 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.838 | 3570.9 samples/s | 55.8 steps/s
[Step=13650 Epoch=128.6] | Loss=0.00858 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.836 | 3376.0 samples/s | 52.8 steps/s
[Step=13700 Epoch=129.1] | Loss=0.00458 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.635 | FP-Norm(final)=2.837 | 4590.0 samples/s | 71.7 steps/s
[Step=13750 Epoch=129.6] | Loss=0.00310 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.643 | FP-Norm(final)=2.838 | 1510.6 samples/s | 23.6 steps/s
[Step=13800 Epoch=130.0] | Loss=0.00236 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.639 | FP-Norm(final)=2.839 | 4220.0 samples/s | 65.9 steps/s
[Step=13850 Epoch=130.5] | Loss=0.00190 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.631 | FP-Norm(final)=2.840 | 1566.2 samples/s | 24.5 steps/s
[Step=13900 Epoch=131.0] | Loss=0.00160 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.623 | FP-Norm(final)=2.841 | 3973.4 samples/s | 62.1 steps/s
[Step=13950 Epoch=131.4] | Loss=0.00138 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.614 | FP-Norm(final)=2.842 | 1621.8 samples/s | 25.3 steps/s
[Step=14000 Epoch=131.9] | Loss=0.00121 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.606 | FP-Norm(final)=2.842 | 3667.6 samples/s | 57.3 steps/s
[Step=14050 Epoch=132.4] | Loss=0.00109 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.598 | FP-Norm(final)=2.843 | 1672.3 samples/s | 26.1 steps/s
[Step=14100 Epoch=132.9] | Loss=0.00098 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.844 | 3592.9 samples/s | 56.1 steps/s
[Step=14150 Epoch=133.3] | Loss=0.00090 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.584 | FP-Norm(final)=2.844 | 1672.4 samples/s | 26.1 steps/s
[Step=14200 Epoch=133.8] | Loss=0.00083 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.845 | 3602.6 samples/s | 56.3 steps/s
[Step=14250 Epoch=134.3] | Loss=0.00077 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=2.845 | 1675.2 samples/s | 26.2 steps/s
[Step=14300 Epoch=134.7] | Loss=0.00072 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.846 | 3515.7 samples/s | 54.9 steps/s
[Step=14350 Epoch=135.2] | Loss=0.00067 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.846 | 1801.4 samples/s | 28.1 steps/s
[Step=14400 Epoch=135.7] | Loss=0.00063 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.847 | 3257.6 samples/s | 50.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step14400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=10401 Epoch=99.1] | Loss=0.04541 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.839 | 3423.7 samples/s | 53.5 steps/s
[Step=10450 Epoch=99.6] | Loss=0.00706 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.839 | 3365.0 samples/s | 52.6 steps/s
[Step=10500 Epoch=100.1] | Loss=0.00367 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.588 | FP-Norm(final)=2.841 | 4652.3 samples/s | 72.7 steps/s
[Step=10550 Epoch=100.6] | Loss=0.00253 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=2.842 | 1536.9 samples/s | 24.0 steps/s
[Step=10600 Epoch=101.0] | Loss=0.00192 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.586 | FP-Norm(final)=2.843 | 4403.7 samples/s | 68.8 steps/s
[Step=10650 Epoch=101.5] | Loss=0.00156 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.844 | 1550.2 samples/s | 24.2 steps/s
[Step=10700 Epoch=102.0] | Loss=0.00131 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.844 | 4179.9 samples/s | 65.3 steps/s
[Step=10750 Epoch=102.5] | Loss=0.00114 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.845 | 1565.6 samples/s | 24.5 steps/s
[Step=10800 Epoch=102.9] | Loss=0.00100 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.846 | 3993.7 samples/s | 62.4 steps/s
[Step=10850 Epoch=103.4] | Loss=0.00090 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.846 | 1606.9 samples/s | 25.1 steps/s
[Step=10900 Epoch=103.9] | Loss=0.00082 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.847 | 3710.7 samples/s | 58.0 steps/s
[Step=10950 Epoch=104.4] | Loss=0.00075 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.847 | 1618.6 samples/s | 25.3 steps/s
[Step=11000 Epoch=104.8] | Loss=0.00069 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.848 | 3550.0 samples/s | 55.5 steps/s
[Step=11050 Epoch=105.3] | Loss=0.00064 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=2.848 | 1669.4 samples/s | 26.1 steps/s
[Step=11100 Epoch=105.8] | Loss=0.00060 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.849 | 3593.9 samples/s | 56.2 steps/s
[Step=11150 Epoch=106.3] | Loss=0.00056 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=2.849 | 1674.4 samples/s | 26.2 steps/s
[Step=11200 Epoch=106.7] | Loss=0.00053 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=2.849 | 3607.5 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27385 | acc=0.8311 | tpr=0.7604 | fpr=0.0154 | 3543.4 samples/s | 13.8 steps/s
Avg test loss: 0.28032, Avg test acc: 0.82859, Avg tpr: 0.75817, Avg fpr: 0.01654, total FA: 129

Testing server on iccad2012
[Step=  50] | Loss=0.49915 | acc=0.8184 | tpr=0.9558 | fpr=0.1840 | 3587.9 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.50112 | acc=0.8162 | tpr=0.9638 | fpr=0.1865 | 6695.1 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.50765 | acc=0.8157 | tpr=0.9712 | fpr=0.1872 | 6965.1 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.50709 | acc=0.8164 | tpr=0.9727 | fpr=0.1864 | 6587.7 samples/s | 25.7 steps/s
[Step= 250] | Loss=0.50723 | acc=0.8159 | tpr=0.9729 | fpr=0.1870 | 6750.2 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.50886 | acc=0.8153 | tpr=0.9724 | fpr=0.1876 | 6856.3 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.51113 | acc=0.8154 | tpr=0.9724 | fpr=0.1874 | 6759.7 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.51123 | acc=0.8153 | tpr=0.9737 | fpr=0.1876 | 7153.9 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.51613 | acc=0.8147 | tpr=0.9737 | fpr=0.1882 | 6565.3 samples/s | 25.6 steps/s
[Step= 500] | Loss=0.51708 | acc=0.8140 | tpr=0.9744 | fpr=0.1889 | 6521.4 samples/s | 25.5 steps/s
[Step= 550] | Loss=0.51414 | acc=0.8147 | tpr=0.9741 | fpr=0.1882 | 12246.8 samples/s | 47.8 steps/s
Avg test loss: 0.51433, Avg test acc: 0.81453, Avg tpr: 0.97385, Avg fpr: 0.18836, total FA: 26154

server round 31/50

clients selected: [0 3 5 6 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=9601 Epoch=46.8] | Loss=0.18683 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.849 | 3558.3 samples/s | 55.6 steps/s
[Step=9650 Epoch=47.1] | Loss=0.03434 | Reg=0.00020 | acc=0.9688 | FP-Norm=0.425 | FP-Norm(final)=2.847 | 3518.2 samples/s | 55.0 steps/s
[Step=9700 Epoch=47.3] | Loss=0.02484 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.473 | FP-Norm(final)=2.846 | 3730.5 samples/s | 58.3 steps/s
[Step=9750 Epoch=47.5] | Loss=0.02187 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=2.847 | 3719.8 samples/s | 58.1 steps/s
[Step=9800 Epoch=47.8] | Loss=0.01932 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=2.847 | 4764.2 samples/s | 74.4 steps/s
[Step=9850 Epoch=48.0] | Loss=0.01678 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.848 | 1567.6 samples/s | 24.5 steps/s
[Step=9900 Epoch=48.3] | Loss=0.01531 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=2.850 | 3719.1 samples/s | 58.1 steps/s
[Step=9950 Epoch=48.5] | Loss=0.01412 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.852 | 3723.7 samples/s | 58.2 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01307 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.854 | 4485.0 samples/s | 70.1 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01225 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.855 | 1587.8 samples/s | 24.8 steps/s
[Step=10100 Epoch=49.2] | Loss=0.01153 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.857 | 3736.2 samples/s | 58.4 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01093 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.859 | 3744.6 samples/s | 58.5 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01046 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.861 | 4225.2 samples/s | 66.0 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01004 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.863 | 1640.4 samples/s | 25.6 steps/s
[Step=10300 Epoch=50.2] | Loss=0.00960 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.865 | 3712.5 samples/s | 58.0 steps/s
[Step=10350 Epoch=50.5] | Loss=0.00920 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=2.866 | 3718.4 samples/s | 58.1 steps/s
[Step=10400 Epoch=50.7] | Loss=0.00894 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.868 | 4003.5 samples/s | 62.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step10400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=10401 Epoch=50.7] | Loss=0.09911 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.849 | 3503.8 samples/s | 54.7 steps/s
[Step=10450 Epoch=51.0] | Loss=0.03256 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.436 | FP-Norm(final)=2.845 | 3567.4 samples/s | 55.7 steps/s
[Step=10500 Epoch=51.2] | Loss=0.02401 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.481 | FP-Norm(final)=2.845 | 3658.5 samples/s | 57.2 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02069 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.845 | 3720.1 samples/s | 58.1 steps/s
[Step=10600 Epoch=51.7] | Loss=0.01830 | Reg=0.00027 | acc=0.9688 | FP-Norm=0.512 | FP-Norm(final)=2.846 | 4799.8 samples/s | 75.0 steps/s
[Step=10650 Epoch=51.9] | Loss=0.01550 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.520 | FP-Norm(final)=2.848 | 1584.5 samples/s | 24.8 steps/s
[Step=10700 Epoch=52.2] | Loss=0.01382 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=2.849 | 3762.4 samples/s | 58.8 steps/s
[Step=10750 Epoch=52.4] | Loss=0.01280 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.526 | FP-Norm(final)=2.851 | 3701.9 samples/s | 57.8 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01205 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.852 | 4495.9 samples/s | 70.2 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01132 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.854 | 1611.0 samples/s | 25.2 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01057 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.532 | FP-Norm(final)=2.856 | 3741.2 samples/s | 58.5 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01000 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.858 | 3742.5 samples/s | 58.5 steps/s
[Step=11000 Epoch=53.6] | Loss=0.00953 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.859 | 4246.6 samples/s | 66.4 steps/s
[Step=11050 Epoch=53.9] | Loss=0.00905 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.537 | FP-Norm(final)=2.861 | 1661.4 samples/s | 26.0 steps/s
[Step=11100 Epoch=54.1] | Loss=0.00869 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.539 | FP-Norm(final)=2.863 | 3737.4 samples/s | 58.4 steps/s
[Step=11150 Epoch=54.4] | Loss=0.00841 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.864 | 3721.8 samples/s | 58.2 steps/s
[Step=11200 Epoch=54.6] | Loss=0.00810 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.866 | 4015.7 samples/s | 62.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step11200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=151.6] | Loss=0.06842 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.849 | 3508.0 samples/s | 54.8 steps/s
[Step=16050 Epoch=152.1] | Loss=0.00824 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.851 | 3354.5 samples/s | 52.4 steps/s
[Step=16100 Epoch=152.6] | Loss=0.00441 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.852 | 4638.4 samples/s | 72.5 steps/s
[Step=16150 Epoch=153.0] | Loss=0.00305 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.626 | FP-Norm(final)=2.853 | 1518.2 samples/s | 23.7 steps/s
[Step=16200 Epoch=153.5] | Loss=0.00231 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.619 | FP-Norm(final)=2.854 | 4319.3 samples/s | 67.5 steps/s
[Step=16250 Epoch=154.0] | Loss=0.00186 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.610 | FP-Norm(final)=2.855 | 1567.4 samples/s | 24.5 steps/s
[Step=16300 Epoch=154.5] | Loss=0.00157 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.600 | FP-Norm(final)=2.855 | 4070.7 samples/s | 63.6 steps/s
[Step=16350 Epoch=154.9] | Loss=0.00135 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=2.856 | 1592.8 samples/s | 24.9 steps/s
[Step=16400 Epoch=155.4] | Loss=0.00119 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.857 | 3797.8 samples/s | 59.3 steps/s
[Step=16450 Epoch=155.9] | Loss=0.00106 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.857 | 1638.8 samples/s | 25.6 steps/s
[Step=16500 Epoch=156.4] | Loss=0.00096 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.857 | 3640.4 samples/s | 56.9 steps/s
[Step=16550 Epoch=156.8] | Loss=0.00088 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.858 | 1695.7 samples/s | 26.5 steps/s
[Step=16600 Epoch=157.3] | Loss=0.00081 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.858 | 3586.3 samples/s | 56.0 steps/s
[Step=16650 Epoch=157.8] | Loss=0.00075 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.549 | FP-Norm(final)=2.859 | 1695.2 samples/s | 26.5 steps/s
[Step=16700 Epoch=158.2] | Loss=0.00070 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.859 | 3588.7 samples/s | 56.1 steps/s
[Step=16750 Epoch=158.7] | Loss=0.00066 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.859 | 1706.1 samples/s | 26.7 steps/s
[Step=16800 Epoch=159.2] | Loss=0.00062 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.532 | FP-Norm(final)=2.859 | 3537.8 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step16800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=9601 Epoch=91.3] | Loss=0.14588 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.849 | 3565.4 samples/s | 55.7 steps/s
[Step=9650 Epoch=91.8] | Loss=0.00830 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.590 | FP-Norm(final)=2.852 | 3300.3 samples/s | 51.6 steps/s
[Step=9700 Epoch=92.3] | Loss=0.00439 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.641 | FP-Norm(final)=2.853 | 4634.6 samples/s | 72.4 steps/s
[Step=9750 Epoch=92.7] | Loss=0.00297 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.641 | FP-Norm(final)=2.855 | 1532.7 samples/s | 23.9 steps/s
[Step=9800 Epoch=93.2] | Loss=0.00225 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.632 | FP-Norm(final)=2.856 | 4324.1 samples/s | 67.6 steps/s
[Step=9850 Epoch=93.7] | Loss=0.00182 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.856 | 1578.8 samples/s | 24.7 steps/s
[Step=9900 Epoch=94.2] | Loss=0.00152 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.611 | FP-Norm(final)=2.857 | 4078.9 samples/s | 63.7 steps/s
[Step=9950 Epoch=94.6] | Loss=0.00132 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.600 | FP-Norm(final)=2.858 | 1584.4 samples/s | 24.8 steps/s
[Step=10000 Epoch=95.1] | Loss=0.00116 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.858 | 3872.4 samples/s | 60.5 steps/s
[Step=10050 Epoch=95.6] | Loss=0.00104 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.582 | FP-Norm(final)=2.859 | 1645.4 samples/s | 25.7 steps/s
[Step=10100 Epoch=96.1] | Loss=0.00094 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.574 | FP-Norm(final)=2.859 | 3650.2 samples/s | 57.0 steps/s
[Step=10150 Epoch=96.6] | Loss=0.00086 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.859 | 1683.2 samples/s | 26.3 steps/s
[Step=10200 Epoch=97.0] | Loss=0.00079 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.860 | 3611.5 samples/s | 56.4 steps/s
[Step=10250 Epoch=97.5] | Loss=0.00073 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.860 | 1695.0 samples/s | 26.5 steps/s
[Step=10300 Epoch=98.0] | Loss=0.00069 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.860 | 3579.8 samples/s | 55.9 steps/s
[Step=10350 Epoch=98.5] | Loss=0.00064 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.861 | 1701.4 samples/s | 26.6 steps/s
[Step=10400 Epoch=98.9] | Loss=0.00060 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.861 | 3544.6 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step10400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=11201 Epoch=106.8] | Loss=0.08838 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.849 | 3354.4 samples/s | 52.4 steps/s
[Step=11250 Epoch=107.2] | Loss=0.00557 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.853 | 3489.7 samples/s | 54.5 steps/s
[Step=11300 Epoch=107.7] | Loss=0.00331 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.619 | FP-Norm(final)=2.855 | 4633.9 samples/s | 72.4 steps/s
[Step=11350 Epoch=108.2] | Loss=0.00225 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.629 | FP-Norm(final)=2.856 | 1530.0 samples/s | 23.9 steps/s
[Step=11400 Epoch=108.7] | Loss=0.00171 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.625 | FP-Norm(final)=2.857 | 4430.4 samples/s | 69.2 steps/s
[Step=11450 Epoch=109.1] | Loss=0.00139 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.617 | FP-Norm(final)=2.858 | 1552.5 samples/s | 24.3 steps/s
[Step=11500 Epoch=109.6] | Loss=0.00117 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=2.858 | 4128.2 samples/s | 64.5 steps/s
[Step=11550 Epoch=110.1] | Loss=0.00101 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.600 | FP-Norm(final)=2.859 | 1591.3 samples/s | 24.9 steps/s
[Step=11600 Epoch=110.6] | Loss=0.00089 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=2.860 | 3960.2 samples/s | 61.9 steps/s
[Step=11650 Epoch=111.0] | Loss=0.00080 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.584 | FP-Norm(final)=2.860 | 1606.4 samples/s | 25.1 steps/s
[Step=11700 Epoch=111.5] | Loss=0.00073 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.860 | 3782.1 samples/s | 59.1 steps/s
[Step=11750 Epoch=112.0] | Loss=0.00066 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.861 | 1661.0 samples/s | 26.0 steps/s
[Step=11800 Epoch=112.5] | Loss=0.00061 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.861 | 3585.4 samples/s | 56.0 steps/s
[Step=11850 Epoch=112.9] | Loss=0.00057 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.862 | 1690.4 samples/s | 26.4 steps/s
[Step=11900 Epoch=113.4] | Loss=0.00053 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=2.862 | 3591.3 samples/s | 56.1 steps/s
[Step=11950 Epoch=113.9] | Loss=0.00050 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=2.862 | 1698.8 samples/s | 26.5 steps/s
[Step=12000 Epoch=114.4] | Loss=0.00047 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.863 | 3603.4 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28176 | acc=0.8304 | tpr=0.7592 | fpr=0.0151 | 3576.5 samples/s | 14.0 steps/s
Avg test loss: 0.28886, Avg test acc: 0.82851, Avg tpr: 0.75782, Avg fpr: 0.01602, total FA: 125

Testing server on iccad2012
[Step=  50] | Loss=0.51430 | acc=0.8187 | tpr=0.9513 | fpr=0.1836 | 3612.9 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.51580 | acc=0.8163 | tpr=0.9595 | fpr=0.1863 | 6693.3 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.52257 | acc=0.8155 | tpr=0.9683 | fpr=0.1873 | 6735.7 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.52185 | acc=0.8164 | tpr=0.9694 | fpr=0.1864 | 6979.9 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.52196 | acc=0.8158 | tpr=0.9694 | fpr=0.1870 | 6873.8 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.52363 | acc=0.8155 | tpr=0.9695 | fpr=0.1873 | 6699.5 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.52603 | acc=0.8156 | tpr=0.9699 | fpr=0.1872 | 6867.8 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.52599 | acc=0.8155 | tpr=0.9716 | fpr=0.1874 | 6627.7 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.53106 | acc=0.8149 | tpr=0.9718 | fpr=0.1880 | 6924.0 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.53213 | acc=0.8142 | tpr=0.9727 | fpr=0.1887 | 6741.5 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.52904 | acc=0.8149 | tpr=0.9725 | fpr=0.1880 | 12822.7 samples/s | 50.1 steps/s
Avg test loss: 0.52923, Avg test acc: 0.81477, Avg tpr: 0.97227, Avg fpr: 0.18810, total FA: 26117

server round 32/50

clients selected: [0 3 5 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=10401 Epoch=50.7] | Loss=0.14001 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.864 | 3779.8 samples/s | 59.1 steps/s
[Step=10450 Epoch=51.0] | Loss=0.03673 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.447 | FP-Norm(final)=2.859 | 3349.6 samples/s | 52.3 steps/s
[Step=10500 Epoch=51.2] | Loss=0.02642 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.858 | 3788.1 samples/s | 59.2 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02261 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.514 | FP-Norm(final)=2.858 | 3722.0 samples/s | 58.2 steps/s
[Step=10600 Epoch=51.7] | Loss=0.01970 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=2.859 | 4770.6 samples/s | 74.5 steps/s
[Step=10650 Epoch=51.9] | Loss=0.01704 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.860 | 1576.0 samples/s | 24.6 steps/s
[Step=10700 Epoch=52.2] | Loss=0.01503 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.861 | 3727.7 samples/s | 58.2 steps/s
[Step=10750 Epoch=52.4] | Loss=0.01383 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.535 | FP-Norm(final)=2.863 | 3745.8 samples/s | 58.5 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01299 | Reg=0.00029 | acc=0.9688 | FP-Norm=0.536 | FP-Norm(final)=2.865 | 4485.3 samples/s | 70.1 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01219 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.867 | 1605.9 samples/s | 25.1 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01135 | Reg=0.00029 | acc=0.9688 | FP-Norm=0.539 | FP-Norm(final)=2.869 | 3757.3 samples/s | 58.7 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01072 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.871 | 3713.9 samples/s | 58.0 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01030 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.873 | 4248.8 samples/s | 66.4 steps/s
[Step=11050 Epoch=53.9] | Loss=0.00976 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.874 | 1636.5 samples/s | 25.6 steps/s
[Step=11100 Epoch=54.1] | Loss=0.00936 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.876 | 3723.9 samples/s | 58.2 steps/s
[Step=11150 Epoch=54.4] | Loss=0.00904 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.878 | 3745.4 samples/s | 58.5 steps/s
[Step=11200 Epoch=54.6] | Loss=0.00870 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=2.880 | 4049.3 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step11200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=11201 Epoch=54.6] | Loss=0.19340 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.864 | 3520.4 samples/s | 55.0 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04274 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=2.857 | 3645.2 samples/s | 57.0 steps/s
[Step=11300 Epoch=55.1] | Loss=0.02803 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.856 | 3703.1 samples/s | 57.9 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02238 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.857 | 3738.6 samples/s | 58.4 steps/s
[Step=11400 Epoch=55.6] | Loss=0.01944 | Reg=0.00033 | acc=0.9844 | FP-Norm=0.572 | FP-Norm(final)=2.858 | 4776.0 samples/s | 74.6 steps/s
[Step=11450 Epoch=55.8] | Loss=0.01698 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=2.859 | 1593.7 samples/s | 24.9 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01568 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.861 | 3736.2 samples/s | 58.4 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01406 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.862 | 3713.3 samples/s | 58.0 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01307 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.864 | 4485.6 samples/s | 70.1 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01204 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.865 | 1616.7 samples/s | 25.3 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01126 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.574 | FP-Norm(final)=2.867 | 3745.8 samples/s | 58.5 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01071 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=2.868 | 3718.2 samples/s | 58.1 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01020 | Reg=0.00033 | acc=0.9844 | FP-Norm=0.573 | FP-Norm(final)=2.870 | 4259.7 samples/s | 66.6 steps/s
[Step=11850 Epoch=57.8] | Loss=0.00970 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.574 | FP-Norm(final)=2.871 | 1633.3 samples/s | 25.5 steps/s
[Step=11900 Epoch=58.0] | Loss=0.00921 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.574 | FP-Norm(final)=2.873 | 3733.3 samples/s | 58.3 steps/s
[Step=11950 Epoch=58.3] | Loss=0.00885 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.875 | 3752.5 samples/s | 58.6 steps/s
[Step=12000 Epoch=58.5] | Loss=0.00861 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.876 | 3996.4 samples/s | 62.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16801 Epoch=159.2] | Loss=0.11683 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.864 | 3449.4 samples/s | 53.9 steps/s
[Step=16850 Epoch=159.7] | Loss=0.00952 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.656 | FP-Norm(final)=2.863 | 3434.1 samples/s | 53.7 steps/s
[Step=16900 Epoch=160.1] | Loss=0.00509 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.699 | FP-Norm(final)=2.864 | 4667.1 samples/s | 72.9 steps/s
[Step=16950 Epoch=160.6] | Loss=0.00343 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.696 | FP-Norm(final)=2.865 | 1535.2 samples/s | 24.0 steps/s
[Step=17000 Epoch=161.1] | Loss=0.00260 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.866 | 4282.2 samples/s | 66.9 steps/s
[Step=17050 Epoch=161.6] | Loss=0.00210 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.674 | FP-Norm(final)=2.866 | 1547.2 samples/s | 24.2 steps/s
[Step=17100 Epoch=162.0] | Loss=0.00176 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.662 | FP-Norm(final)=2.867 | 4090.7 samples/s | 63.9 steps/s
[Step=17150 Epoch=162.5] | Loss=0.00152 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.651 | FP-Norm(final)=2.867 | 1546.0 samples/s | 24.2 steps/s
[Step=17200 Epoch=163.0] | Loss=0.00133 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.641 | FP-Norm(final)=2.868 | 3389.7 samples/s | 53.0 steps/s
[Step=17250 Epoch=163.5] | Loss=0.00119 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.632 | FP-Norm(final)=2.868 | 1542.7 samples/s | 24.1 steps/s
[Step=17300 Epoch=163.9] | Loss=0.00108 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.623 | FP-Norm(final)=2.869 | 3262.5 samples/s | 51.0 steps/s
[Step=17350 Epoch=164.4] | Loss=0.00099 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.615 | FP-Norm(final)=2.869 | 1556.2 samples/s | 24.3 steps/s
[Step=17400 Epoch=164.9] | Loss=0.00091 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.607 | FP-Norm(final)=2.869 | 3255.6 samples/s | 50.9 steps/s
[Step=17450 Epoch=165.4] | Loss=0.00084 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.600 | FP-Norm(final)=2.870 | 1612.3 samples/s | 25.2 steps/s
[Step=17500 Epoch=165.8] | Loss=0.00078 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.593 | FP-Norm(final)=2.870 | 3409.8 samples/s | 53.3 steps/s
[Step=17550 Epoch=166.3] | Loss=0.00074 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.586 | FP-Norm(final)=2.870 | 1709.6 samples/s | 26.7 steps/s
[Step=17600 Epoch=166.8] | Loss=0.00069 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.580 | FP-Norm(final)=2.871 | 3570.7 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step17600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=10401 Epoch=98.9] | Loss=0.14864 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.864 | 3459.5 samples/s | 54.1 steps/s
[Step=10450 Epoch=99.4] | Loss=0.00928 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.863 | 3391.3 samples/s | 53.0 steps/s
[Step=10500 Epoch=99.9] | Loss=0.00478 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.648 | FP-Norm(final)=2.865 | 4627.5 samples/s | 72.3 steps/s
[Step=10550 Epoch=100.4] | Loss=0.00329 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.655 | FP-Norm(final)=2.866 | 1513.9 samples/s | 23.7 steps/s
[Step=10600 Epoch=100.8] | Loss=0.00249 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.649 | FP-Norm(final)=2.867 | 4298.9 samples/s | 67.2 steps/s
[Step=10650 Epoch=101.3] | Loss=0.00200 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.640 | FP-Norm(final)=2.868 | 1565.8 samples/s | 24.5 steps/s
[Step=10700 Epoch=101.8] | Loss=0.00168 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.630 | FP-Norm(final)=2.868 | 4071.3 samples/s | 63.6 steps/s
[Step=10750 Epoch=102.3] | Loss=0.00145 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.869 | 1605.4 samples/s | 25.1 steps/s
[Step=10800 Epoch=102.7] | Loss=0.00128 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.612 | FP-Norm(final)=2.869 | 3848.9 samples/s | 60.1 steps/s
[Step=10850 Epoch=103.2] | Loss=0.00114 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.604 | FP-Norm(final)=2.870 | 1648.4 samples/s | 25.8 steps/s
[Step=10900 Epoch=103.7] | Loss=0.00103 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.597 | FP-Norm(final)=2.870 | 3561.7 samples/s | 55.7 steps/s
[Step=10950 Epoch=104.2] | Loss=0.00094 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.589 | FP-Norm(final)=2.871 | 1668.0 samples/s | 26.1 steps/s
[Step=11000 Epoch=104.6] | Loss=0.00087 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.582 | FP-Norm(final)=2.871 | 3567.2 samples/s | 55.7 steps/s
[Step=11050 Epoch=105.1] | Loss=0.00080 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.871 | 1682.3 samples/s | 26.3 steps/s
[Step=11100 Epoch=105.6] | Loss=0.00075 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.872 | 3573.9 samples/s | 55.8 steps/s
[Step=11150 Epoch=106.1] | Loss=0.00070 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.564 | FP-Norm(final)=2.872 | 1670.8 samples/s | 26.1 steps/s
[Step=11200 Epoch=106.5] | Loss=0.00066 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.872 | 3572.0 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step11200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=114.6] | Loss=0.07253 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.864 | 3719.1 samples/s | 58.1 steps/s
[Step=12050 Epoch=115.1] | Loss=0.00793 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.599 | FP-Norm(final)=2.863 | 3175.5 samples/s | 49.6 steps/s
[Step=12100 Epoch=115.5] | Loss=0.00411 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.646 | FP-Norm(final)=2.864 | 4719.8 samples/s | 73.7 steps/s
[Step=12150 Epoch=116.0] | Loss=0.00278 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.646 | FP-Norm(final)=2.865 | 1538.4 samples/s | 24.0 steps/s
[Step=12200 Epoch=116.5] | Loss=0.00211 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.637 | FP-Norm(final)=2.866 | 4432.1 samples/s | 69.3 steps/s
[Step=12250 Epoch=117.0] | Loss=0.00171 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.626 | FP-Norm(final)=2.867 | 1542.8 samples/s | 24.1 steps/s
[Step=12300 Epoch=117.5] | Loss=0.00143 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.616 | FP-Norm(final)=2.868 | 4217.9 samples/s | 65.9 steps/s
[Step=12350 Epoch=117.9] | Loss=0.00124 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.606 | FP-Norm(final)=2.868 | 1564.2 samples/s | 24.4 steps/s
[Step=12400 Epoch=118.4] | Loss=0.00109 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.597 | FP-Norm(final)=2.869 | 3967.8 samples/s | 62.0 steps/s
[Step=12450 Epoch=118.9] | Loss=0.00098 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.589 | FP-Norm(final)=2.869 | 1606.0 samples/s | 25.1 steps/s
[Step=12500 Epoch=119.4] | Loss=0.00088 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.870 | 3808.2 samples/s | 59.5 steps/s
[Step=12550 Epoch=119.8] | Loss=0.00081 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.574 | FP-Norm(final)=2.870 | 1661.1 samples/s | 26.0 steps/s
[Step=12600 Epoch=120.3] | Loss=0.00075 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.567 | FP-Norm(final)=2.870 | 3646.1 samples/s | 57.0 steps/s
[Step=12650 Epoch=120.8] | Loss=0.00069 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.871 | 1644.3 samples/s | 25.7 steps/s
[Step=12700 Epoch=121.3] | Loss=0.00065 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.871 | 3602.8 samples/s | 56.3 steps/s
[Step=12750 Epoch=121.8] | Loss=0.00061 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.871 | 1692.1 samples/s | 26.4 steps/s
[Step=12800 Epoch=122.2] | Loss=0.00057 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.872 | 3590.1 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28503 | acc=0.8288 | tpr=0.7567 | fpr=0.0146 | 3570.3 samples/s | 13.9 steps/s
Avg test loss: 0.29307, Avg test acc: 0.82715, Avg tpr: 0.75573, Avg fpr: 0.01577, total FA: 123

Testing server on iccad2012
[Step=  50] | Loss=0.50565 | acc=0.8248 | tpr=0.9513 | fpr=0.1775 | 3585.2 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.50706 | acc=0.8226 | tpr=0.9616 | fpr=0.1800 | 6809.6 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.51341 | acc=0.8219 | tpr=0.9697 | fpr=0.1808 | 6843.4 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.51287 | acc=0.8226 | tpr=0.9716 | fpr=0.1801 | 6694.7 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.51281 | acc=0.8222 | tpr=0.9721 | fpr=0.1806 | 7034.0 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.51430 | acc=0.8215 | tpr=0.9716 | fpr=0.1812 | 6519.6 samples/s | 25.5 steps/s
[Step= 350] | Loss=0.51677 | acc=0.8218 | tpr=0.9724 | fpr=0.1809 | 6681.5 samples/s | 26.1 steps/s
[Step= 400] | Loss=0.51665 | acc=0.8217 | tpr=0.9737 | fpr=0.1811 | 6788.4 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.52162 | acc=0.8210 | tpr=0.9737 | fpr=0.1818 | 6709.2 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.52263 | acc=0.8204 | tpr=0.9744 | fpr=0.1824 | 6767.0 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.51967 | acc=0.8210 | tpr=0.9741 | fpr=0.1817 | 12225.9 samples/s | 47.8 steps/s
Avg test loss: 0.51984, Avg test acc: 0.82091, Avg tpr: 0.97385, Avg fpr: 0.18188, total FA: 25253

server round 33/50

clients selected: [2 5 7 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=74.1] | Loss=0.16639 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.871 | 3535.8 samples/s | 55.2 steps/s
[Step=15250 Epoch=74.3] | Loss=0.03335 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.867 | 3562.5 samples/s | 55.7 steps/s
[Step=15300 Epoch=74.5] | Loss=0.02540 | Reg=0.00027 | acc=0.9688 | FP-Norm=0.506 | FP-Norm(final)=2.865 | 3697.2 samples/s | 57.8 steps/s
[Step=15350 Epoch=74.8] | Loss=0.02087 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=2.866 | 3714.6 samples/s | 58.0 steps/s
[Step=15400 Epoch=75.0] | Loss=0.01822 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.526 | FP-Norm(final)=2.866 | 4766.3 samples/s | 74.5 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01593 | Reg=0.00029 | acc=0.9531 | FP-Norm=0.532 | FP-Norm(final)=2.868 | 1565.7 samples/s | 24.5 steps/s
[Step=15500 Epoch=75.5] | Loss=0.01409 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.534 | FP-Norm(final)=2.870 | 3754.4 samples/s | 58.7 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01269 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.872 | 3726.2 samples/s | 58.2 steps/s
[Step=15600 Epoch=76.0] | Loss=0.01199 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.874 | 4476.6 samples/s | 69.9 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01123 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.876 | 1618.7 samples/s | 25.3 steps/s
[Step=15700 Epoch=76.5] | Loss=0.01046 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.537 | FP-Norm(final)=2.877 | 3680.4 samples/s | 57.5 steps/s
[Step=15750 Epoch=76.7] | Loss=0.00988 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.879 | 3744.7 samples/s | 58.5 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00940 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.881 | 4233.0 samples/s | 66.1 steps/s
[Step=15850 Epoch=77.2] | Loss=0.00895 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=2.883 | 1636.6 samples/s | 25.6 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00860 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.540 | FP-Norm(final)=2.885 | 3696.4 samples/s | 57.8 steps/s
[Step=15950 Epoch=77.7] | Loss=0.00830 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.541 | FP-Norm(final)=2.887 | 3715.0 samples/s | 58.0 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00802 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.889 | 3997.0 samples/s | 62.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=17601 Epoch=166.8] | Loss=0.16387 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.871 | 3770.7 samples/s | 58.9 steps/s
[Step=17650 Epoch=167.2] | Loss=0.00774 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.574 | FP-Norm(final)=2.872 | 3153.0 samples/s | 49.3 steps/s
[Step=17700 Epoch=167.7] | Loss=0.00419 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.874 | 4564.5 samples/s | 71.3 steps/s
[Step=17750 Epoch=168.2] | Loss=0.00282 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.629 | FP-Norm(final)=2.875 | 1528.7 samples/s | 23.9 steps/s
[Step=17800 Epoch=168.7] | Loss=0.00214 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.876 | 4278.7 samples/s | 66.9 steps/s
[Step=17850 Epoch=169.1] | Loss=0.00174 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.613 | FP-Norm(final)=2.876 | 1572.8 samples/s | 24.6 steps/s
[Step=17900 Epoch=169.6] | Loss=0.00146 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.603 | FP-Norm(final)=2.877 | 4052.6 samples/s | 63.3 steps/s
[Step=17950 Epoch=170.1] | Loss=0.00126 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=2.877 | 1611.4 samples/s | 25.2 steps/s
[Step=18000 Epoch=170.6] | Loss=0.00111 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.585 | FP-Norm(final)=2.877 | 3787.6 samples/s | 59.2 steps/s
[Step=18050 Epoch=171.0] | Loss=0.00099 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.878 | 1645.1 samples/s | 25.7 steps/s
[Step=18100 Epoch=171.5] | Loss=0.00089 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.878 | 3629.3 samples/s | 56.7 steps/s
[Step=18150 Epoch=172.0] | Loss=0.00082 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.878 | 1680.0 samples/s | 26.3 steps/s
[Step=18200 Epoch=172.5] | Loss=0.00075 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.879 | 3595.5 samples/s | 56.2 steps/s
[Step=18250 Epoch=172.9] | Loss=0.00070 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.879 | 1686.0 samples/s | 26.3 steps/s
[Step=18300 Epoch=173.4] | Loss=0.00065 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.879 | 3589.3 samples/s | 56.1 steps/s
[Step=18350 Epoch=173.9] | Loss=0.00061 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.879 | 1682.8 samples/s | 26.3 steps/s
[Step=18400 Epoch=174.4] | Loss=0.00057 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.880 | 3549.4 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step18400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=122.2] | Loss=0.05080 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.871 | 3411.5 samples/s | 53.3 steps/s
[Step=12850 Epoch=122.7] | Loss=0.00652 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=2.873 | 3461.2 samples/s | 54.1 steps/s
[Step=12900 Epoch=123.2] | Loss=0.00352 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.643 | FP-Norm(final)=2.875 | 4636.0 samples/s | 72.4 steps/s
[Step=12950 Epoch=123.7] | Loss=0.00238 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.643 | FP-Norm(final)=2.876 | 1514.1 samples/s | 23.7 steps/s
[Step=13000 Epoch=124.1] | Loss=0.00181 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.634 | FP-Norm(final)=2.877 | 4359.0 samples/s | 68.1 steps/s
[Step=13050 Epoch=124.6] | Loss=0.00146 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.878 | 1541.4 samples/s | 24.1 steps/s
[Step=13100 Epoch=125.1] | Loss=0.00123 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.613 | FP-Norm(final)=2.878 | 4155.7 samples/s | 64.9 steps/s
[Step=13150 Epoch=125.6] | Loss=0.00106 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.603 | FP-Norm(final)=2.879 | 1578.0 samples/s | 24.7 steps/s
[Step=13200 Epoch=126.1] | Loss=0.00093 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.593 | FP-Norm(final)=2.879 | 3958.9 samples/s | 61.9 steps/s
[Step=13250 Epoch=126.5] | Loss=0.00084 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.585 | FP-Norm(final)=2.879 | 1598.6 samples/s | 25.0 steps/s
[Step=13300 Epoch=127.0] | Loss=0.00076 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.880 | 3752.1 samples/s | 58.6 steps/s
[Step=13350 Epoch=127.5] | Loss=0.00069 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.880 | 1636.0 samples/s | 25.6 steps/s
[Step=13400 Epoch=128.0] | Loss=0.00064 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.880 | 3624.7 samples/s | 56.6 steps/s
[Step=13450 Epoch=128.4] | Loss=0.00059 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.881 | 1676.1 samples/s | 26.2 steps/s
[Step=13500 Epoch=128.9] | Loss=0.00055 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.881 | 3612.2 samples/s | 56.4 steps/s
[Step=13550 Epoch=129.4] | Loss=0.00052 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.881 | 1680.0 samples/s | 26.3 steps/s
[Step=13600 Epoch=129.9] | Loss=0.00049 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.881 | 3622.6 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step13600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=135.7] | Loss=0.19286 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.871 | 3727.5 samples/s | 58.2 steps/s
[Step=14450 Epoch=136.2] | Loss=0.01427 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.708 | FP-Norm(final)=2.868 | 3347.0 samples/s | 52.3 steps/s
[Step=14500 Epoch=136.6] | Loss=0.00766 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.751 | FP-Norm(final)=2.867 | 4545.6 samples/s | 71.0 steps/s
[Step=14550 Epoch=137.1] | Loss=0.00517 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.750 | FP-Norm(final)=2.867 | 1528.3 samples/s | 23.9 steps/s
[Step=14600 Epoch=137.6] | Loss=0.00389 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.740 | FP-Norm(final)=2.868 | 4239.4 samples/s | 66.2 steps/s
[Step=14650 Epoch=138.0] | Loss=0.00313 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.727 | FP-Norm(final)=2.868 | 1572.9 samples/s | 24.6 steps/s
[Step=14700 Epoch=138.5] | Loss=0.00262 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.715 | FP-Norm(final)=2.869 | 3959.7 samples/s | 61.9 steps/s
[Step=14750 Epoch=139.0] | Loss=0.00226 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.704 | FP-Norm(final)=2.869 | 1639.9 samples/s | 25.6 steps/s
[Step=14800 Epoch=139.5] | Loss=0.00198 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.694 | FP-Norm(final)=2.869 | 3728.0 samples/s | 58.2 steps/s
[Step=14850 Epoch=139.9] | Loss=0.00177 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.684 | FP-Norm(final)=2.870 | 1656.9 samples/s | 25.9 steps/s
[Step=14900 Epoch=140.4] | Loss=0.00160 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.675 | FP-Norm(final)=2.870 | 3589.0 samples/s | 56.1 steps/s
[Step=14950 Epoch=140.9] | Loss=0.00146 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.666 | FP-Norm(final)=2.870 | 1699.7 samples/s | 26.6 steps/s
[Step=15000 Epoch=141.3] | Loss=0.00134 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.658 | FP-Norm(final)=2.871 | 3601.7 samples/s | 56.3 steps/s
[Step=15050 Epoch=141.8] | Loss=0.00124 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.651 | FP-Norm(final)=2.871 | 1670.2 samples/s | 26.1 steps/s
[Step=15100 Epoch=142.3] | Loss=0.00115 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.644 | FP-Norm(final)=2.871 | 3532.5 samples/s | 55.2 steps/s
[Step=15150 Epoch=142.8] | Loss=0.00108 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.637 | FP-Norm(final)=2.872 | 1868.9 samples/s | 29.2 steps/s
[Step=15200 Epoch=143.2] | Loss=0.00101 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.630 | FP-Norm(final)=2.872 | 3103.6 samples/s | 48.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step15200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=114.4] | Loss=0.10961 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.871 | 3530.0 samples/s | 55.2 steps/s
[Step=12050 Epoch=114.8] | Loss=0.00876 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.869 | 3302.1 samples/s | 51.6 steps/s
[Step=12100 Epoch=115.3] | Loss=0.00486 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.629 | FP-Norm(final)=2.871 | 4642.6 samples/s | 72.5 steps/s
[Step=12150 Epoch=115.8] | Loss=0.00330 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.639 | FP-Norm(final)=2.873 | 1521.5 samples/s | 23.8 steps/s
[Step=12200 Epoch=116.3] | Loss=0.00249 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.634 | FP-Norm(final)=2.874 | 4417.6 samples/s | 69.0 steps/s
[Step=12250 Epoch=116.8] | Loss=0.00201 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.626 | FP-Norm(final)=2.875 | 1557.0 samples/s | 24.3 steps/s
[Step=12300 Epoch=117.2] | Loss=0.00168 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.616 | FP-Norm(final)=2.876 | 4166.6 samples/s | 65.1 steps/s
[Step=12350 Epoch=117.7] | Loss=0.00145 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.607 | FP-Norm(final)=2.876 | 1597.3 samples/s | 25.0 steps/s
[Step=12400 Epoch=118.2] | Loss=0.00127 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.599 | FP-Norm(final)=2.877 | 3984.4 samples/s | 62.3 steps/s
[Step=12450 Epoch=118.7] | Loss=0.00114 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.877 | 1608.4 samples/s | 25.1 steps/s
[Step=12500 Epoch=119.1] | Loss=0.00103 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.877 | 3797.7 samples/s | 59.3 steps/s
[Step=12550 Epoch=119.6] | Loss=0.00094 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.878 | 1642.8 samples/s | 25.7 steps/s
[Step=12600 Epoch=120.1] | Loss=0.00086 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.878 | 3622.6 samples/s | 56.6 steps/s
[Step=12650 Epoch=120.6] | Loss=0.00080 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.879 | 1681.3 samples/s | 26.3 steps/s
[Step=12700 Epoch=121.0] | Loss=0.00075 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.879 | 3614.9 samples/s | 56.5 steps/s
[Step=12750 Epoch=121.5] | Loss=0.00070 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.879 | 1694.4 samples/s | 26.5 steps/s
[Step=12800 Epoch=122.0] | Loss=0.00066 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.880 | 3595.5 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29116 | acc=0.8270 | tpr=0.7550 | fpr=0.0166 | 3542.3 samples/s | 13.8 steps/s
Avg test loss: 0.29918, Avg test acc: 0.82547, Avg tpr: 0.75374, Avg fpr: 0.01679, total FA: 131

Testing server on iccad2012
[Step=  50] | Loss=0.49598 | acc=0.8316 | tpr=0.9469 | fpr=0.1704 | 3569.3 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.49709 | acc=0.8296 | tpr=0.9595 | fpr=0.1728 | 6791.1 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.50336 | acc=0.8289 | tpr=0.9683 | fpr=0.1736 | 6726.1 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.50312 | acc=0.8296 | tpr=0.9716 | fpr=0.1730 | 6944.0 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.50295 | acc=0.8292 | tpr=0.9721 | fpr=0.1734 | 6636.3 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.50430 | acc=0.8285 | tpr=0.9716 | fpr=0.1741 | 6890.0 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.50687 | acc=0.8284 | tpr=0.9724 | fpr=0.1742 | 6736.1 samples/s | 26.3 steps/s
[Step= 400] | Loss=0.50675 | acc=0.8282 | tpr=0.9737 | fpr=0.1744 | 6707.0 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.51185 | acc=0.8276 | tpr=0.9742 | fpr=0.1751 | 6673.1 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.51275 | acc=0.8270 | tpr=0.9749 | fpr=0.1757 | 6897.2 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.50976 | acc=0.8275 | tpr=0.9741 | fpr=0.1751 | 11263.9 samples/s | 44.0 steps/s
Avg test loss: 0.50989, Avg test acc: 0.82742, Avg tpr: 0.97385, Avg fpr: 0.17524, total FA: 24332

server round 34/50

clients selected: [2 3 5 6 7]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=78.0] | Loss=0.14610 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.884 | 3853.9 samples/s | 60.2 steps/s
[Step=16050 Epoch=78.2] | Loss=0.02929 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.463 | FP-Norm(final)=2.880 | 3268.6 samples/s | 51.1 steps/s
[Step=16100 Epoch=78.4] | Loss=0.02320 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.510 | FP-Norm(final)=2.879 | 3728.7 samples/s | 58.3 steps/s
[Step=16150 Epoch=78.7] | Loss=0.02029 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.528 | FP-Norm(final)=2.880 | 3720.3 samples/s | 58.1 steps/s
[Step=16200 Epoch=78.9] | Loss=0.01798 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.537 | FP-Norm(final)=2.881 | 4790.4 samples/s | 74.8 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01573 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.882 | 1577.3 samples/s | 24.6 steps/s
[Step=16300 Epoch=79.4] | Loss=0.01395 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.884 | 3691.9 samples/s | 57.7 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01289 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.549 | FP-Norm(final)=2.885 | 3737.6 samples/s | 58.4 steps/s
[Step=16400 Epoch=79.9] | Loss=0.01194 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=2.887 | 4470.2 samples/s | 69.8 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01108 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=2.889 | 1593.2 samples/s | 24.9 steps/s
[Step=16500 Epoch=80.4] | Loss=0.01042 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.891 | 3731.4 samples/s | 58.3 steps/s
[Step=16550 Epoch=80.6] | Loss=0.01000 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.553 | FP-Norm(final)=2.893 | 3750.6 samples/s | 58.6 steps/s
[Step=16600 Epoch=80.9] | Loss=0.00942 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.553 | FP-Norm(final)=2.895 | 4254.9 samples/s | 66.5 steps/s
[Step=16650 Epoch=81.1] | Loss=0.00892 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.554 | FP-Norm(final)=2.896 | 1649.9 samples/s | 25.8 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00840 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.898 | 3646.0 samples/s | 57.0 steps/s
[Step=16750 Epoch=81.6] | Loss=0.00809 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.900 | 3750.1 samples/s | 58.6 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00782 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.902 | 3977.3 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step16800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=58.5] | Loss=0.13141 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.884 | 3668.8 samples/s | 57.3 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03704 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=2.880 | 3554.0 samples/s | 55.5 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02662 | Reg=0.00032 | acc=0.9844 | FP-Norm=0.553 | FP-Norm(final)=2.878 | 3730.7 samples/s | 58.3 steps/s
[Step=12150 Epoch=59.3] | Loss=0.02033 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.878 | 3713.0 samples/s | 58.0 steps/s
[Step=12200 Epoch=59.5] | Loss=0.01800 | Reg=0.00034 | acc=0.9844 | FP-Norm=0.575 | FP-Norm(final)=2.879 | 4790.3 samples/s | 74.8 steps/s
[Step=12250 Epoch=59.7] | Loss=0.01578 | Reg=0.00034 | acc=0.9844 | FP-Norm=0.580 | FP-Norm(final)=2.881 | 1571.7 samples/s | 24.6 steps/s
[Step=12300 Epoch=60.0] | Loss=0.01395 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.882 | 3732.1 samples/s | 58.3 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01287 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.884 | 3735.0 samples/s | 58.4 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01222 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.582 | FP-Norm(final)=2.885 | 4492.0 samples/s | 70.2 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01136 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.886 | 1607.4 samples/s | 25.1 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01073 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.888 | 3745.8 samples/s | 58.5 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01011 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.889 | 3741.1 samples/s | 58.5 steps/s
[Step=12600 Epoch=61.4] | Loss=0.00962 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.891 | 4254.1 samples/s | 66.5 steps/s
[Step=12650 Epoch=61.7] | Loss=0.00913 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.584 | FP-Norm(final)=2.892 | 1651.8 samples/s | 25.8 steps/s
[Step=12700 Epoch=61.9] | Loss=0.00873 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.585 | FP-Norm(final)=2.894 | 3712.9 samples/s | 58.0 steps/s
[Step=12750 Epoch=62.2] | Loss=0.00846 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.585 | FP-Norm(final)=2.895 | 3737.3 samples/s | 58.4 steps/s
[Step=12800 Epoch=62.4] | Loss=0.00813 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.586 | FP-Norm(final)=2.897 | 4029.1 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step12800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=18401 Epoch=174.4] | Loss=0.06442 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.884 | 3689.7 samples/s | 57.7 steps/s
[Step=18450 Epoch=174.8] | Loss=0.00879 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.586 | FP-Norm(final)=2.882 | 3213.8 samples/s | 50.2 steps/s
[Step=18500 Epoch=175.3] | Loss=0.00450 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.631 | FP-Norm(final)=2.883 | 4618.0 samples/s | 72.2 steps/s
[Step=18550 Epoch=175.8] | Loss=0.00308 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.635 | FP-Norm(final)=2.885 | 1518.1 samples/s | 23.7 steps/s
[Step=18600 Epoch=176.3] | Loss=0.00233 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.629 | FP-Norm(final)=2.885 | 4276.5 samples/s | 66.8 steps/s
[Step=18650 Epoch=176.7] | Loss=0.00190 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.622 | FP-Norm(final)=2.886 | 1532.9 samples/s | 24.0 steps/s
[Step=18700 Epoch=177.2] | Loss=0.00159 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.613 | FP-Norm(final)=2.887 | 4082.1 samples/s | 63.8 steps/s
[Step=18750 Epoch=177.7] | Loss=0.00137 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=2.887 | 1588.5 samples/s | 24.8 steps/s
[Step=18800 Epoch=178.1] | Loss=0.00121 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.597 | FP-Norm(final)=2.888 | 3808.1 samples/s | 59.5 steps/s
[Step=18850 Epoch=178.6] | Loss=0.00108 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.589 | FP-Norm(final)=2.888 | 1644.8 samples/s | 25.7 steps/s
[Step=18900 Epoch=179.1] | Loss=0.00097 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.888 | 3657.9 samples/s | 57.2 steps/s
[Step=18950 Epoch=179.6] | Loss=0.00089 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.889 | 1687.0 samples/s | 26.4 steps/s
[Step=19000 Epoch=180.0] | Loss=0.00082 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.889 | 3580.0 samples/s | 55.9 steps/s
[Step=19050 Epoch=180.5] | Loss=0.00076 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.890 | 1693.6 samples/s | 26.5 steps/s
[Step=19100 Epoch=181.0] | Loss=0.00071 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.890 | 3622.4 samples/s | 56.6 steps/s
[Step=19150 Epoch=181.5] | Loss=0.00066 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=2.890 | 1699.6 samples/s | 26.6 steps/s
[Step=19200 Epoch=181.9] | Loss=0.00062 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.890 | 3549.3 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step19200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=11201 Epoch=106.5] | Loss=0.14012 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.884 | 3475.6 samples/s | 54.3 steps/s
[Step=11250 Epoch=107.0] | Loss=0.00876 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.628 | FP-Norm(final)=2.884 | 3328.0 samples/s | 52.0 steps/s
[Step=11300 Epoch=107.5] | Loss=0.00460 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.670 | FP-Norm(final)=2.886 | 4636.0 samples/s | 72.4 steps/s
[Step=11350 Epoch=108.0] | Loss=0.00312 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.666 | FP-Norm(final)=2.887 | 1537.4 samples/s | 24.0 steps/s
[Step=11400 Epoch=108.4] | Loss=0.00236 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.654 | FP-Norm(final)=2.887 | 4350.6 samples/s | 68.0 steps/s
[Step=11450 Epoch=108.9] | Loss=0.00190 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.642 | FP-Norm(final)=2.888 | 1568.8 samples/s | 24.5 steps/s
[Step=11500 Epoch=109.4] | Loss=0.00160 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.630 | FP-Norm(final)=2.889 | 4018.3 samples/s | 62.8 steps/s
[Step=11550 Epoch=109.9] | Loss=0.00138 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.619 | FP-Norm(final)=2.889 | 1596.3 samples/s | 24.9 steps/s
[Step=11600 Epoch=110.3] | Loss=0.00121 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=2.890 | 3846.2 samples/s | 60.1 steps/s
[Step=11650 Epoch=110.8] | Loss=0.00108 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.600 | FP-Norm(final)=2.890 | 1629.9 samples/s | 25.5 steps/s
[Step=11700 Epoch=111.3] | Loss=0.00098 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.890 | 3679.8 samples/s | 57.5 steps/s
[Step=11750 Epoch=111.8] | Loss=0.00089 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.891 | 1686.1 samples/s | 26.3 steps/s
[Step=11800 Epoch=112.2] | Loss=0.00082 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.891 | 3602.9 samples/s | 56.3 steps/s
[Step=11850 Epoch=112.7] | Loss=0.00076 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.891 | 1700.0 samples/s | 26.6 steps/s
[Step=11900 Epoch=113.2] | Loss=0.00071 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.891 | 3616.0 samples/s | 56.5 steps/s
[Step=11950 Epoch=113.7] | Loss=0.00067 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.892 | 1715.0 samples/s | 26.8 steps/s
[Step=12000 Epoch=114.1] | Loss=0.00063 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.892 | 3534.8 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step12000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=129.9] | Loss=0.23471 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.883 | 3456.6 samples/s | 54.0 steps/s
[Step=13650 Epoch=130.3] | Loss=0.00919 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=2.883 | 3402.8 samples/s | 53.2 steps/s
[Step=13700 Epoch=130.8] | Loss=0.00478 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.647 | FP-Norm(final)=2.885 | 4656.4 samples/s | 72.8 steps/s
[Step=13750 Epoch=131.3] | Loss=0.00321 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.649 | FP-Norm(final)=2.886 | 1534.9 samples/s | 24.0 steps/s
[Step=13800 Epoch=131.8] | Loss=0.00243 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.641 | FP-Norm(final)=2.886 | 4381.5 samples/s | 68.5 steps/s
[Step=13850 Epoch=132.3] | Loss=0.00196 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.632 | FP-Norm(final)=2.887 | 1553.9 samples/s | 24.3 steps/s
[Step=13900 Epoch=132.7] | Loss=0.00164 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.622 | FP-Norm(final)=2.888 | 4143.4 samples/s | 64.7 steps/s
[Step=13950 Epoch=133.2] | Loss=0.00142 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.613 | FP-Norm(final)=2.888 | 1582.0 samples/s | 24.7 steps/s
[Step=14000 Epoch=133.7] | Loss=0.00124 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.604 | FP-Norm(final)=2.888 | 3928.7 samples/s | 61.4 steps/s
[Step=14050 Epoch=134.2] | Loss=0.00111 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=2.889 | 1606.6 samples/s | 25.1 steps/s
[Step=14100 Epoch=134.6] | Loss=0.00100 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=2.889 | 3797.5 samples/s | 59.3 steps/s
[Step=14150 Epoch=135.1] | Loss=0.00092 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.580 | FP-Norm(final)=2.889 | 1648.9 samples/s | 25.8 steps/s
[Step=14200 Epoch=135.6] | Loss=0.00084 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=2.890 | 3635.1 samples/s | 56.8 steps/s
[Step=14250 Epoch=136.1] | Loss=0.00078 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.890 | 1681.0 samples/s | 26.3 steps/s
[Step=14300 Epoch=136.6] | Loss=0.00073 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.890 | 3629.7 samples/s | 56.7 steps/s
[Step=14350 Epoch=137.0] | Loss=0.00068 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.890 | 1669.5 samples/s | 26.1 steps/s
[Step=14400 Epoch=137.5] | Loss=0.00064 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.890 | 3575.4 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29911 | acc=0.8239 | tpr=0.7498 | fpr=0.0151 | 3561.3 samples/s | 13.9 steps/s
Avg test loss: 0.30729, Avg test acc: 0.82226, Avg tpr: 0.74862, Avg fpr: 0.01577, total FA: 123

Testing server on iccad2012
[Step=  50] | Loss=0.49895 | acc=0.8315 | tpr=0.9469 | fpr=0.1706 | 3597.7 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.50055 | acc=0.8291 | tpr=0.9595 | fpr=0.1733 | 6777.4 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.50727 | acc=0.8286 | tpr=0.9697 | fpr=0.1740 | 6674.5 samples/s | 26.1 steps/s
[Step= 200] | Loss=0.50680 | acc=0.8294 | tpr=0.9716 | fpr=0.1732 | 6799.3 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.50649 | acc=0.8293 | tpr=0.9721 | fpr=0.1733 | 6915.8 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.50798 | acc=0.8286 | tpr=0.9716 | fpr=0.1740 | 6708.6 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.51056 | acc=0.8287 | tpr=0.9718 | fpr=0.1739 | 6697.5 samples/s | 26.2 steps/s
[Step= 400] | Loss=0.51055 | acc=0.8285 | tpr=0.9732 | fpr=0.1742 | 6813.6 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.51571 | acc=0.8278 | tpr=0.9732 | fpr=0.1748 | 6603.9 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.51657 | acc=0.8271 | tpr=0.9740 | fpr=0.1756 | 6767.9 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.51346 | acc=0.8277 | tpr=0.9733 | fpr=0.1750 | 12235.9 samples/s | 47.8 steps/s
Avg test loss: 0.51359, Avg test acc: 0.82756, Avg tpr: 0.97306, Avg fpr: 0.17508, total FA: 24310

server round 35/50

clients selected: [1 2 4 5 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=78.1] | Loss=0.18906 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.891 | 3538.2 samples/s | 55.3 steps/s
[Step=16050 Epoch=78.3] | Loss=0.03839 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=2.885 | 3534.8 samples/s | 55.2 steps/s
[Step=16100 Epoch=78.6] | Loss=0.02888 | Reg=0.00027 | acc=0.9688 | FP-Norm=0.510 | FP-Norm(final)=2.883 | 3722.1 samples/s | 58.2 steps/s
[Step=16150 Epoch=78.8] | Loss=0.02417 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.531 | FP-Norm(final)=2.882 | 3710.3 samples/s | 58.0 steps/s
[Step=16200 Epoch=79.0] | Loss=0.02047 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.544 | FP-Norm(final)=2.882 | 4789.4 samples/s | 74.8 steps/s
[Step=16250 Epoch=79.3] | Loss=0.01759 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.883 | 1544.8 samples/s | 24.1 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01590 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.885 | 3702.8 samples/s | 57.9 steps/s
[Step=16350 Epoch=79.8] | Loss=0.01451 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=2.886 | 3766.4 samples/s | 58.8 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01339 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.888 | 4558.1 samples/s | 71.2 steps/s
[Step=16450 Epoch=80.3] | Loss=0.01236 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.890 | 1595.8 samples/s | 24.9 steps/s
[Step=16500 Epoch=80.5] | Loss=0.01161 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.891 | 3723.8 samples/s | 58.2 steps/s
[Step=16550 Epoch=80.8] | Loss=0.01103 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.893 | 3734.0 samples/s | 58.3 steps/s
[Step=16600 Epoch=81.0] | Loss=0.01067 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.564 | FP-Norm(final)=2.895 | 4353.7 samples/s | 68.0 steps/s
[Step=16650 Epoch=81.2] | Loss=0.01017 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.896 | 1634.3 samples/s | 25.5 steps/s
[Step=16700 Epoch=81.5] | Loss=0.00974 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.898 | 3651.2 samples/s | 57.1 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00936 | Reg=0.00032 | acc=0.9688 | FP-Norm=0.567 | FP-Norm(final)=2.900 | 3772.5 samples/s | 58.9 steps/s
[Step=16800 Epoch=82.0] | Loss=0.00902 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.901 | 4130.5 samples/s | 64.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step16800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16801 Epoch=81.9] | Loss=0.15967 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.891 | 3564.7 samples/s | 55.7 steps/s
[Step=16850 Epoch=82.1] | Loss=0.03309 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=2.887 | 3542.5 samples/s | 55.4 steps/s
[Step=16900 Epoch=82.3] | Loss=0.02516 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.886 | 3504.5 samples/s | 54.8 steps/s
[Step=16950 Epoch=82.6] | Loss=0.02066 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.886 | 3270.3 samples/s | 51.1 steps/s
[Step=17000 Epoch=82.8] | Loss=0.01803 | Reg=0.00034 | acc=0.9844 | FP-Norm=0.573 | FP-Norm(final)=2.887 | 4231.9 samples/s | 66.1 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01558 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.889 | 1574.2 samples/s | 24.6 steps/s
[Step=17100 Epoch=83.3] | Loss=0.01375 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.580 | FP-Norm(final)=2.891 | 3810.8 samples/s | 59.5 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01271 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.893 | 3764.4 samples/s | 58.8 steps/s
[Step=17200 Epoch=83.8] | Loss=0.01188 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.894 | 4557.0 samples/s | 71.2 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01103 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.896 | 1643.2 samples/s | 25.7 steps/s
[Step=17300 Epoch=84.3] | Loss=0.01057 | Reg=0.00034 | acc=0.9844 | FP-Norm=0.580 | FP-Norm(final)=2.898 | 3791.4 samples/s | 59.2 steps/s
[Step=17350 Epoch=84.5] | Loss=0.00989 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.900 | 3793.7 samples/s | 59.3 steps/s
[Step=17400 Epoch=84.8] | Loss=0.00936 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.902 | 4291.8 samples/s | 67.1 steps/s
[Step=17450 Epoch=85.0] | Loss=0.00903 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.904 | 1671.4 samples/s | 26.1 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00861 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.905 | 3772.4 samples/s | 58.9 steps/s
[Step=17550 Epoch=85.5] | Loss=0.00827 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.907 | 3820.4 samples/s | 59.7 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00796 | Reg=0.00034 | acc=0.9844 | FP-Norm=0.578 | FP-Norm(final)=2.909 | 4030.8 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step17600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=9601 Epoch=47.1] | Loss=0.05452 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.891 | 3701.4 samples/s | 57.8 steps/s
[Step=9650 Epoch=47.3] | Loss=0.03297 | Reg=0.00023 | acc=0.9688 | FP-Norm=0.452 | FP-Norm(final)=2.887 | 3521.3 samples/s | 55.0 steps/s
[Step=9700 Epoch=47.6] | Loss=0.02322 | Reg=0.00026 | acc=0.9688 | FP-Norm=0.496 | FP-Norm(final)=2.886 | 3796.4 samples/s | 59.3 steps/s
[Step=9750 Epoch=47.8] | Loss=0.01987 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.514 | FP-Norm(final)=2.885 | 3790.3 samples/s | 59.2 steps/s
[Step=9800 Epoch=48.1] | Loss=0.01719 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=2.886 | 4907.3 samples/s | 76.7 steps/s
[Step=9850 Epoch=48.3] | Loss=0.01477 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.887 | 1586.3 samples/s | 24.8 steps/s
[Step=9900 Epoch=48.5] | Loss=0.01319 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.889 | 3779.8 samples/s | 59.1 steps/s
[Step=9950 Epoch=48.8] | Loss=0.01190 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.891 | 3774.2 samples/s | 59.0 steps/s
[Step=10000 Epoch=49.0] | Loss=0.01106 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.530 | FP-Norm(final)=2.892 | 4710.5 samples/s | 73.6 steps/s
[Step=10050 Epoch=49.3] | Loss=0.01018 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.529 | FP-Norm(final)=2.894 | 1581.8 samples/s | 24.7 steps/s
[Step=10100 Epoch=49.5] | Loss=0.00949 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.896 | 3773.0 samples/s | 59.0 steps/s
[Step=10150 Epoch=49.8] | Loss=0.00895 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.898 | 3794.8 samples/s | 59.3 steps/s
[Step=10200 Epoch=50.0] | Loss=0.00865 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.529 | FP-Norm(final)=2.899 | 4515.6 samples/s | 70.6 steps/s
[Step=10250 Epoch=50.3] | Loss=0.00836 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.901 | 1621.6 samples/s | 25.3 steps/s
[Step=10300 Epoch=50.5] | Loss=0.00794 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.902 | 3789.1 samples/s | 59.2 steps/s
[Step=10350 Epoch=50.8] | Loss=0.00762 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.904 | 3783.5 samples/s | 59.1 steps/s
[Step=10400 Epoch=51.0] | Loss=0.00737 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.905 | 4356.8 samples/s | 68.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step10400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=19201 Epoch=181.9] | Loss=0.12535 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.891 | 3388.6 samples/s | 52.9 steps/s
[Step=19250 Epoch=182.4] | Loss=0.00721 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.891 | 3574.6 samples/s | 55.9 steps/s
[Step=19300 Epoch=182.9] | Loss=0.00385 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.892 | 4632.1 samples/s | 72.4 steps/s
[Step=19350 Epoch=183.4] | Loss=0.00259 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.601 | FP-Norm(final)=2.894 | 1536.0 samples/s | 24.0 steps/s
[Step=19400 Epoch=183.8] | Loss=0.00197 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.894 | 4410.2 samples/s | 68.9 steps/s
[Step=19450 Epoch=184.3] | Loss=0.00158 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=2.895 | 1594.4 samples/s | 24.9 steps/s
[Step=19500 Epoch=184.8] | Loss=0.00133 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.896 | 4111.6 samples/s | 64.2 steps/s
[Step=19550 Epoch=185.3] | Loss=0.00115 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.896 | 1616.5 samples/s | 25.3 steps/s
[Step=19600 Epoch=185.7] | Loss=0.00101 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.897 | 3891.0 samples/s | 60.8 steps/s
[Step=19650 Epoch=186.2] | Loss=0.00090 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.897 | 1648.6 samples/s | 25.8 steps/s
[Step=19700 Epoch=186.7] | Loss=0.00082 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.898 | 3703.6 samples/s | 57.9 steps/s
[Step=19750 Epoch=187.1] | Loss=0.00075 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.898 | 1706.5 samples/s | 26.7 steps/s
[Step=19800 Epoch=187.6] | Loss=0.00069 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.898 | 3591.6 samples/s | 56.1 steps/s
[Step=19850 Epoch=188.1] | Loss=0.00064 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.899 | 1724.0 samples/s | 26.9 steps/s
[Step=19900 Epoch=188.6] | Loss=0.00060 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=2.899 | 3649.6 samples/s | 57.0 steps/s
[Step=19950 Epoch=189.0] | Loss=0.00056 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.899 | 1721.8 samples/s | 26.9 steps/s
[Step=20000 Epoch=189.5] | Loss=0.00053 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.899 | 3614.6 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step20000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=137.5] | Loss=0.03640 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.891 | 3867.9 samples/s | 60.4 steps/s
[Step=14450 Epoch=138.0] | Loss=0.00832 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.892 | 3158.0 samples/s | 49.3 steps/s
[Step=14500 Epoch=138.5] | Loss=0.00429 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=2.893 | 4734.8 samples/s | 74.0 steps/s
[Step=14550 Epoch=138.9] | Loss=0.00290 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.895 | 1546.3 samples/s | 24.2 steps/s
[Step=14600 Epoch=139.4] | Loss=0.00220 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=2.895 | 4497.8 samples/s | 70.3 steps/s
[Step=14650 Epoch=139.9] | Loss=0.00178 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.586 | FP-Norm(final)=2.896 | 1568.5 samples/s | 24.5 steps/s
[Step=14700 Epoch=140.4] | Loss=0.00150 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.897 | 4222.3 samples/s | 66.0 steps/s
[Step=14750 Epoch=140.9] | Loss=0.00129 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=2.897 | 1601.7 samples/s | 25.0 steps/s
[Step=14800 Epoch=141.3] | Loss=0.00114 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.898 | 4006.6 samples/s | 62.6 steps/s
[Step=14850 Epoch=141.8] | Loss=0.00102 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.898 | 1632.4 samples/s | 25.5 steps/s
[Step=14900 Epoch=142.3] | Loss=0.00092 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.898 | 3854.9 samples/s | 60.2 steps/s
[Step=14950 Epoch=142.8] | Loss=0.00084 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.549 | FP-Norm(final)=2.899 | 1659.2 samples/s | 25.9 steps/s
[Step=15000 Epoch=143.2] | Loss=0.00077 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.899 | 3715.4 samples/s | 58.1 steps/s
[Step=15050 Epoch=143.7] | Loss=0.00072 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=2.899 | 1709.6 samples/s | 26.7 steps/s
[Step=15100 Epoch=144.2] | Loss=0.00067 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.900 | 3625.1 samples/s | 56.6 steps/s
[Step=15150 Epoch=144.7] | Loss=0.00063 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.900 | 1718.1 samples/s | 26.8 steps/s
[Step=15200 Epoch=145.2] | Loss=0.00059 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=2.900 | 3665.6 samples/s | 57.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30157 | acc=0.8239 | tpr=0.7505 | fpr=0.0166 | 3623.7 samples/s | 14.2 steps/s
Avg test loss: 0.30944, Avg test acc: 0.82214, Avg tpr: 0.74885, Avg fpr: 0.01666, total FA: 130

Testing server on iccad2012
[Step=  50] | Loss=0.49966 | acc=0.8337 | tpr=0.9513 | fpr=0.1684 | 3676.2 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.50112 | acc=0.8316 | tpr=0.9638 | fpr=0.1708 | 6727.8 samples/s | 26.3 steps/s
[Step= 150] | Loss=0.50800 | acc=0.8309 | tpr=0.9726 | fpr=0.1717 | 7034.7 samples/s | 27.5 steps/s
[Step= 200] | Loss=0.50785 | acc=0.8321 | tpr=0.9749 | fpr=0.1705 | 7026.9 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.50751 | acc=0.8315 | tpr=0.9755 | fpr=0.1711 | 6892.5 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.50896 | acc=0.8308 | tpr=0.9745 | fpr=0.1718 | 6835.2 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.51166 | acc=0.8309 | tpr=0.9750 | fpr=0.1717 | 6955.5 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.51171 | acc=0.8305 | tpr=0.9765 | fpr=0.1721 | 6764.0 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.51711 | acc=0.8299 | tpr=0.9766 | fpr=0.1728 | 7070.7 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.51795 | acc=0.8293 | tpr=0.9771 | fpr=0.1733 | 6486.5 samples/s | 25.3 steps/s
[Step= 550] | Loss=0.51478 | acc=0.8300 | tpr=0.9765 | fpr=0.1727 | 12325.7 samples/s | 48.1 steps/s
Avg test loss: 0.51489, Avg test acc: 0.82983, Avg tpr: 0.97623, Avg fpr: 0.17283, total FA: 23997

server round 36/50

clients selected: [0 3 5 6 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=11201 Epoch=54.6] | Loss=0.20019 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.908 | 3533.0 samples/s | 55.2 steps/s
[Step=11250 Epoch=54.9] | Loss=0.02750 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.477 | FP-Norm(final)=2.906 | 3705.2 samples/s | 57.9 steps/s
[Step=11300 Epoch=55.1] | Loss=0.02281 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.522 | FP-Norm(final)=2.905 | 3790.6 samples/s | 59.2 steps/s
[Step=11350 Epoch=55.3] | Loss=0.01871 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.536 | FP-Norm(final)=2.904 | 3798.8 samples/s | 59.4 steps/s
[Step=11400 Epoch=55.6] | Loss=0.01746 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.543 | FP-Norm(final)=2.905 | 4862.9 samples/s | 76.0 steps/s
[Step=11450 Epoch=55.8] | Loss=0.01568 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.905 | 1613.0 samples/s | 25.2 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01443 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.552 | FP-Norm(final)=2.906 | 3792.7 samples/s | 59.3 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01332 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.908 | 3778.4 samples/s | 59.0 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01220 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.909 | 4573.9 samples/s | 71.5 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01129 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.553 | FP-Norm(final)=2.910 | 1647.0 samples/s | 25.7 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01055 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.912 | 3803.7 samples/s | 59.4 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01011 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.914 | 3799.8 samples/s | 59.4 steps/s
[Step=11800 Epoch=57.5] | Loss=0.00966 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.915 | 4292.4 samples/s | 67.1 steps/s
[Step=11850 Epoch=57.8] | Loss=0.00953 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.917 | 1684.0 samples/s | 26.3 steps/s
[Step=11900 Epoch=58.0] | Loss=0.00920 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.555 | FP-Norm(final)=2.918 | 3789.1 samples/s | 59.2 steps/s
[Step=11950 Epoch=58.3] | Loss=0.00882 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.556 | FP-Norm(final)=2.919 | 3787.8 samples/s | 59.2 steps/s
[Step=12000 Epoch=58.5] | Loss=0.00857 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.921 | 4074.4 samples/s | 63.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step12000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=62.4] | Loss=0.26095 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.907 | 3775.8 samples/s | 59.0 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03604 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=2.902 | 3490.5 samples/s | 54.5 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02511 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.901 | 3789.6 samples/s | 59.2 steps/s
[Step=12950 Epoch=63.2] | Loss=0.02057 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.551 | FP-Norm(final)=2.901 | 3751.1 samples/s | 58.6 steps/s
[Step=13000 Epoch=63.4] | Loss=0.01796 | Reg=0.00032 | acc=0.9844 | FP-Norm=0.558 | FP-Norm(final)=2.902 | 4664.4 samples/s | 72.9 steps/s
[Step=13050 Epoch=63.6] | Loss=0.01545 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.904 | 1560.0 samples/s | 24.4 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01370 | Reg=0.00032 | acc=0.9844 | FP-Norm=0.562 | FP-Norm(final)=2.905 | 3671.3 samples/s | 57.4 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01237 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.907 | 3720.6 samples/s | 58.1 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01170 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.564 | FP-Norm(final)=2.908 | 4471.9 samples/s | 69.9 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01090 | Reg=0.00032 | acc=0.9844 | FP-Norm=0.564 | FP-Norm(final)=2.910 | 1603.1 samples/s | 25.0 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01038 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.911 | 3759.5 samples/s | 58.7 steps/s
[Step=13350 Epoch=65.1] | Loss=0.00976 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.913 | 3778.0 samples/s | 59.0 steps/s
[Step=13400 Epoch=65.3] | Loss=0.00926 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.914 | 4287.7 samples/s | 67.0 steps/s
[Step=13450 Epoch=65.6] | Loss=0.00885 | Reg=0.00032 | acc=0.9844 | FP-Norm=0.566 | FP-Norm(final)=2.916 | 1656.1 samples/s | 25.9 steps/s
[Step=13500 Epoch=65.8] | Loss=0.00841 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.567 | FP-Norm(final)=2.917 | 3820.8 samples/s | 59.7 steps/s
[Step=13550 Epoch=66.1] | Loss=0.00811 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.567 | FP-Norm(final)=2.919 | 3741.4 samples/s | 58.5 steps/s
[Step=13600 Epoch=66.3] | Loss=0.00781 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.920 | 4054.4 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step13600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=20001 Epoch=189.5] | Loss=0.20102 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.907 | 3551.2 samples/s | 55.5 steps/s
[Step=20050 Epoch=190.0] | Loss=0.00823 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.907 | 3388.3 samples/s | 52.9 steps/s
[Step=20100 Epoch=190.5] | Loss=0.00440 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.614 | FP-Norm(final)=2.908 | 4707.4 samples/s | 73.6 steps/s
[Step=20150 Epoch=190.9] | Loss=0.00296 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.616 | FP-Norm(final)=2.909 | 1548.7 samples/s | 24.2 steps/s
[Step=20200 Epoch=191.4] | Loss=0.00224 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=2.909 | 4345.2 samples/s | 67.9 steps/s
[Step=20250 Epoch=191.9] | Loss=0.00181 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.600 | FP-Norm(final)=2.910 | 1573.1 samples/s | 24.6 steps/s
[Step=20300 Epoch=192.4] | Loss=0.00151 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.910 | 4101.5 samples/s | 64.1 steps/s
[Step=20350 Epoch=192.8] | Loss=0.00130 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.582 | FP-Norm(final)=2.911 | 1602.4 samples/s | 25.0 steps/s
[Step=20400 Epoch=193.3] | Loss=0.00115 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.574 | FP-Norm(final)=2.911 | 3877.5 samples/s | 60.6 steps/s
[Step=20450 Epoch=193.8] | Loss=0.00102 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.912 | 1665.0 samples/s | 26.0 steps/s
[Step=20500 Epoch=194.3] | Loss=0.00093 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.912 | 3698.9 samples/s | 57.8 steps/s
[Step=20550 Epoch=194.7] | Loss=0.00085 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.912 | 1683.4 samples/s | 26.3 steps/s
[Step=20600 Epoch=195.2] | Loss=0.00078 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=2.913 | 3643.9 samples/s | 56.9 steps/s
[Step=20650 Epoch=195.7] | Loss=0.00072 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=2.913 | 1708.4 samples/s | 26.7 steps/s
[Step=20700 Epoch=196.2] | Loss=0.00067 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=2.913 | 3592.1 samples/s | 56.1 steps/s
[Step=20750 Epoch=196.6] | Loss=0.00063 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=2.913 | 1703.4 samples/s | 26.6 steps/s
[Step=20800 Epoch=197.1] | Loss=0.00059 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.522 | FP-Norm(final)=2.914 | 3576.4 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step20800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=114.2] | Loss=0.05122 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.908 | 3850.0 samples/s | 60.2 steps/s
[Step=12050 Epoch=114.6] | Loss=0.00652 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.909 | 3163.0 samples/s | 49.4 steps/s
[Step=12100 Epoch=115.1] | Loss=0.00361 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.910 | 4704.2 samples/s | 73.5 steps/s
[Step=12150 Epoch=115.6] | Loss=0.00244 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=2.911 | 1542.4 samples/s | 24.1 steps/s
[Step=12200 Epoch=116.1] | Loss=0.00184 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=2.912 | 4379.4 samples/s | 68.4 steps/s
[Step=12250 Epoch=116.5] | Loss=0.00148 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.913 | 1566.0 samples/s | 24.5 steps/s
[Step=12300 Epoch=117.0] | Loss=0.00124 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.913 | 4125.6 samples/s | 64.5 steps/s
[Step=12350 Epoch=117.5] | Loss=0.00107 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.914 | 1606.6 samples/s | 25.1 steps/s
[Step=12400 Epoch=118.0] | Loss=0.00094 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=2.914 | 3924.5 samples/s | 61.3 steps/s
[Step=12450 Epoch=118.4] | Loss=0.00084 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.914 | 1661.5 samples/s | 26.0 steps/s
[Step=12500 Epoch=118.9] | Loss=0.00076 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.915 | 3716.0 samples/s | 58.1 steps/s
[Step=12550 Epoch=119.4] | Loss=0.00070 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.915 | 1694.9 samples/s | 26.5 steps/s
[Step=12600 Epoch=119.9] | Loss=0.00064 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.522 | FP-Norm(final)=2.915 | 3606.0 samples/s | 56.3 steps/s
[Step=12650 Epoch=120.3] | Loss=0.00059 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=2.916 | 1725.4 samples/s | 27.0 steps/s
[Step=12700 Epoch=120.8] | Loss=0.00055 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=2.916 | 3620.4 samples/s | 56.6 steps/s
[Step=12750 Epoch=121.3] | Loss=0.00052 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=2.916 | 1699.8 samples/s | 26.6 steps/s
[Step=12800 Epoch=121.8] | Loss=0.00049 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=2.916 | 3616.5 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step12800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=143.2] | Loss=0.08056 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.908 | 3911.1 samples/s | 61.1 steps/s
[Step=15250 Epoch=143.7] | Loss=0.00917 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.907 | 3207.1 samples/s | 50.1 steps/s
[Step=15300 Epoch=144.2] | Loss=0.00486 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.607 | FP-Norm(final)=2.908 | 4640.9 samples/s | 72.5 steps/s
[Step=15350 Epoch=144.6] | Loss=0.00330 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.616 | FP-Norm(final)=2.909 | 1540.8 samples/s | 24.1 steps/s
[Step=15400 Epoch=145.1] | Loss=0.00249 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.612 | FP-Norm(final)=2.910 | 4316.4 samples/s | 67.4 steps/s
[Step=15450 Epoch=145.6] | Loss=0.00200 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.606 | FP-Norm(final)=2.911 | 1600.4 samples/s | 25.0 steps/s
[Step=15500 Epoch=146.1] | Loss=0.00168 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.598 | FP-Norm(final)=2.911 | 3970.7 samples/s | 62.0 steps/s
[Step=15550 Epoch=146.5] | Loss=0.00145 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.912 | 1624.7 samples/s | 25.4 steps/s
[Step=15600 Epoch=147.0] | Loss=0.00128 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.584 | FP-Norm(final)=2.912 | 3752.9 samples/s | 58.6 steps/s
[Step=15650 Epoch=147.5] | Loss=0.00114 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.912 | 1694.3 samples/s | 26.5 steps/s
[Step=15700 Epoch=147.9] | Loss=0.00103 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.913 | 3598.3 samples/s | 56.2 steps/s
[Step=15750 Epoch=148.4] | Loss=0.00094 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.913 | 1696.7 samples/s | 26.5 steps/s
[Step=15800 Epoch=148.9] | Loss=0.00087 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.913 | 3648.1 samples/s | 57.0 steps/s
[Step=15850 Epoch=149.4] | Loss=0.00080 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.914 | 1720.8 samples/s | 26.9 steps/s
[Step=15900 Epoch=149.8] | Loss=0.00075 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.549 | FP-Norm(final)=2.914 | 3593.7 samples/s | 56.2 steps/s
[Step=15950 Epoch=150.3] | Loss=0.00070 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.914 | 1793.6 samples/s | 28.0 steps/s
[Step=16000 Epoch=150.8] | Loss=0.00066 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=2.914 | 3347.3 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29508 | acc=0.8295 | tpr=0.7584 | fpr=0.0161 | 3638.8 samples/s | 14.2 steps/s
Avg test loss: 0.30344, Avg test acc: 0.82715, Avg tpr: 0.75602, Avg fpr: 0.01641, total FA: 128

Testing server on iccad2012
[Step=  50] | Loss=0.51203 | acc=0.8310 | tpr=0.9469 | fpr=0.1711 | 3676.7 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.51410 | acc=0.8287 | tpr=0.9595 | fpr=0.1737 | 6787.2 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.52118 | acc=0.8280 | tpr=0.9697 | fpr=0.1746 | 6859.7 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.52101 | acc=0.8287 | tpr=0.9727 | fpr=0.1739 | 6953.5 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.52054 | acc=0.8281 | tpr=0.9729 | fpr=0.1745 | 6977.2 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.52204 | acc=0.8275 | tpr=0.9724 | fpr=0.1751 | 7013.8 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.52468 | acc=0.8278 | tpr=0.9718 | fpr=0.1748 | 6902.4 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.52473 | acc=0.8275 | tpr=0.9737 | fpr=0.1751 | 6726.2 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.53013 | acc=0.8269 | tpr=0.9742 | fpr=0.1757 | 6928.8 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.53099 | acc=0.8263 | tpr=0.9749 | fpr=0.1764 | 6828.5 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.52781 | acc=0.8269 | tpr=0.9745 | fpr=0.1758 | 12634.5 samples/s | 49.4 steps/s
Avg test loss: 0.52794, Avg test acc: 0.82675, Avg tpr: 0.97425, Avg fpr: 0.17593, total FA: 24428

server round 37/50

clients selected: [2 3 5 6 8]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=17601 Epoch=85.8] | Loss=0.25926 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.921 | 3481.6 samples/s | 54.4 steps/s
[Step=17650 Epoch=86.0] | Loss=0.03721 | Reg=0.00027 | acc=0.9688 | FP-Norm=0.502 | FP-Norm(final)=2.915 | 3754.3 samples/s | 58.7 steps/s
[Step=17700 Epoch=86.2] | Loss=0.02618 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.553 | FP-Norm(final)=2.914 | 3774.3 samples/s | 59.0 steps/s
[Step=17750 Epoch=86.5] | Loss=0.02089 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.564 | FP-Norm(final)=2.915 | 3789.1 samples/s | 59.2 steps/s
[Step=17800 Epoch=86.7] | Loss=0.01820 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.916 | 4855.2 samples/s | 75.9 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01566 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.574 | FP-Norm(final)=2.918 | 1592.3 samples/s | 24.9 steps/s
[Step=17900 Epoch=87.2] | Loss=0.01387 | Reg=0.00033 | acc=0.9844 | FP-Norm=0.573 | FP-Norm(final)=2.919 | 3794.4 samples/s | 59.3 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01270 | Reg=0.00033 | acc=0.9844 | FP-Norm=0.571 | FP-Norm(final)=2.921 | 3781.9 samples/s | 59.1 steps/s
[Step=18000 Epoch=87.7] | Loss=0.01172 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.923 | 4558.6 samples/s | 71.2 steps/s
[Step=18050 Epoch=87.9] | Loss=0.01102 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.924 | 1632.9 samples/s | 25.5 steps/s
[Step=18100 Epoch=88.2] | Loss=0.01036 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.926 | 3742.8 samples/s | 58.5 steps/s
[Step=18150 Epoch=88.4] | Loss=0.00978 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.928 | 3753.6 samples/s | 58.6 steps/s
[Step=18200 Epoch=88.7] | Loss=0.00926 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.929 | 4287.2 samples/s | 67.0 steps/s
[Step=18250 Epoch=88.9] | Loss=0.00879 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.931 | 1658.2 samples/s | 25.9 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00840 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.932 | 3793.9 samples/s | 59.3 steps/s
[Step=18350 Epoch=89.4] | Loss=0.00813 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.564 | FP-Norm(final)=2.934 | 3776.0 samples/s | 59.0 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00792 | Reg=0.00032 | acc=0.9844 | FP-Norm=0.564 | FP-Norm(final)=2.935 | 4069.0 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step18400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=66.3] | Loss=0.17641 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.921 | 3553.0 samples/s | 55.5 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03292 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.445 | FP-Norm(final)=2.918 | 3687.2 samples/s | 57.6 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02311 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.917 | 3774.7 samples/s | 59.0 steps/s
[Step=13750 Epoch=67.1] | Loss=0.01889 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.510 | FP-Norm(final)=2.917 | 3777.1 samples/s | 59.0 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01700 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.918 | 4864.6 samples/s | 76.0 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01455 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=2.919 | 1584.0 samples/s | 24.7 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01335 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.531 | FP-Norm(final)=2.920 | 3788.6 samples/s | 59.2 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01204 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.533 | FP-Norm(final)=2.922 | 3798.3 samples/s | 59.3 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01133 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.923 | 4542.3 samples/s | 71.0 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01051 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.924 | 1631.7 samples/s | 25.5 steps/s
[Step=14100 Epoch=68.8] | Loss=0.00992 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.926 | 3793.9 samples/s | 59.3 steps/s
[Step=14150 Epoch=69.0] | Loss=0.00947 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.537 | FP-Norm(final)=2.927 | 3762.7 samples/s | 58.8 steps/s
[Step=14200 Epoch=69.2] | Loss=0.00901 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=2.928 | 4315.5 samples/s | 67.4 steps/s
[Step=14250 Epoch=69.5] | Loss=0.00866 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.930 | 1641.3 samples/s | 25.6 steps/s
[Step=14300 Epoch=69.7] | Loss=0.00826 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.931 | 3786.3 samples/s | 59.2 steps/s
[Step=14350 Epoch=70.0] | Loss=0.00800 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.932 | 3780.3 samples/s | 59.1 steps/s
[Step=14400 Epoch=70.2] | Loss=0.00774 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.934 | 4075.1 samples/s | 63.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step14400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=20801 Epoch=197.1] | Loss=0.09563 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.921 | 3386.0 samples/s | 52.9 steps/s
[Step=20850 Epoch=197.6] | Loss=0.00724 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.608 | FP-Norm(final)=2.922 | 3510.5 samples/s | 54.9 steps/s
[Step=20900 Epoch=198.0] | Loss=0.00376 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.646 | FP-Norm(final)=2.923 | 4673.9 samples/s | 73.0 steps/s
[Step=20950 Epoch=198.5] | Loss=0.00257 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.648 | FP-Norm(final)=2.924 | 1539.7 samples/s | 24.1 steps/s
[Step=21000 Epoch=199.0] | Loss=0.00195 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.641 | FP-Norm(final)=2.924 | 4367.3 samples/s | 68.2 steps/s
[Step=21050 Epoch=199.5] | Loss=0.00158 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.633 | FP-Norm(final)=2.925 | 1588.3 samples/s | 24.8 steps/s
[Step=21100 Epoch=199.9] | Loss=0.00133 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=2.925 | 4068.2 samples/s | 63.6 steps/s
[Step=21150 Epoch=200.4] | Loss=0.00114 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.615 | FP-Norm(final)=2.926 | 1623.6 samples/s | 25.4 steps/s
[Step=21200 Epoch=200.9] | Loss=0.00100 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.607 | FP-Norm(final)=2.926 | 3895.5 samples/s | 60.9 steps/s
[Step=21250 Epoch=201.4] | Loss=0.00090 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.598 | FP-Norm(final)=2.926 | 1653.9 samples/s | 25.8 steps/s
[Step=21300 Epoch=201.8] | Loss=0.00081 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.590 | FP-Norm(final)=2.926 | 3666.1 samples/s | 57.3 steps/s
[Step=21350 Epoch=202.3] | Loss=0.00074 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.927 | 1706.5 samples/s | 26.7 steps/s
[Step=21400 Epoch=202.8] | Loss=0.00068 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.927 | 3577.0 samples/s | 55.9 steps/s
[Step=21450 Epoch=203.3] | Loss=0.00063 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.927 | 1719.1 samples/s | 26.9 steps/s
[Step=21500 Epoch=203.7] | Loss=0.00059 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.927 | 3622.1 samples/s | 56.6 steps/s
[Step=21550 Epoch=204.2] | Loss=0.00055 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.927 | 1722.8 samples/s | 26.9 steps/s
[Step=21600 Epoch=204.7] | Loss=0.00052 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.928 | 3524.5 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step21600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=121.8] | Loss=0.19770 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.921 | 3614.2 samples/s | 56.5 steps/s
[Step=12850 Epoch=122.2] | Loss=0.01176 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.659 | FP-Norm(final)=2.920 | 3268.9 samples/s | 51.1 steps/s
[Step=12900 Epoch=122.7] | Loss=0.00617 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.725 | FP-Norm(final)=2.921 | 4645.8 samples/s | 72.6 steps/s
[Step=12950 Epoch=123.2] | Loss=0.00415 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.729 | FP-Norm(final)=2.922 | 1525.5 samples/s | 23.8 steps/s
[Step=13000 Epoch=123.7] | Loss=0.00314 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.720 | FP-Norm(final)=2.923 | 4333.3 samples/s | 67.7 steps/s
[Step=13050 Epoch=124.1] | Loss=0.00252 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.709 | FP-Norm(final)=2.924 | 1560.6 samples/s | 24.4 steps/s
[Step=13100 Epoch=124.6] | Loss=0.00212 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.697 | FP-Norm(final)=2.924 | 4103.7 samples/s | 64.1 steps/s
[Step=13150 Epoch=125.1] | Loss=0.00182 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.687 | FP-Norm(final)=2.924 | 1591.1 samples/s | 24.9 steps/s
[Step=13200 Epoch=125.6] | Loss=0.00160 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.677 | FP-Norm(final)=2.925 | 3838.8 samples/s | 60.0 steps/s
[Step=13250 Epoch=126.0] | Loss=0.00143 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.667 | FP-Norm(final)=2.925 | 1648.1 samples/s | 25.8 steps/s
[Step=13300 Epoch=126.5] | Loss=0.00129 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.658 | FP-Norm(final)=2.925 | 3620.1 samples/s | 56.6 steps/s
[Step=13350 Epoch=127.0] | Loss=0.00118 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.650 | FP-Norm(final)=2.926 | 1691.7 samples/s | 26.4 steps/s
[Step=13400 Epoch=127.5] | Loss=0.00108 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.642 | FP-Norm(final)=2.926 | 3603.6 samples/s | 56.3 steps/s
[Step=13450 Epoch=127.9] | Loss=0.00100 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.635 | FP-Norm(final)=2.926 | 1698.9 samples/s | 26.5 steps/s
[Step=13500 Epoch=128.4] | Loss=0.00093 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.628 | FP-Norm(final)=2.927 | 3610.8 samples/s | 56.4 steps/s
[Step=13550 Epoch=128.9] | Loss=0.00088 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.927 | 1710.6 samples/s | 26.7 steps/s
[Step=13600 Epoch=129.4] | Loss=0.00082 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.615 | FP-Norm(final)=2.927 | 3572.8 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step13600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=150.8] | Loss=0.08795 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.921 | 3588.1 samples/s | 56.1 steps/s
[Step=16050 Epoch=151.2] | Loss=0.00987 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.634 | FP-Norm(final)=2.920 | 3366.3 samples/s | 52.6 steps/s
[Step=16100 Epoch=151.7] | Loss=0.00520 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.676 | FP-Norm(final)=2.920 | 4603.6 samples/s | 71.9 steps/s
[Step=16150 Epoch=152.2] | Loss=0.00350 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.674 | FP-Norm(final)=2.921 | 1560.3 samples/s | 24.4 steps/s
[Step=16200 Epoch=152.7] | Loss=0.00264 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.665 | FP-Norm(final)=2.921 | 4206.6 samples/s | 65.7 steps/s
[Step=16250 Epoch=153.1] | Loss=0.00213 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.653 | FP-Norm(final)=2.921 | 1586.0 samples/s | 24.8 steps/s
[Step=16300 Epoch=153.6] | Loss=0.00178 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.642 | FP-Norm(final)=2.922 | 3954.0 samples/s | 61.8 steps/s
[Step=16350 Epoch=154.1] | Loss=0.00154 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.632 | FP-Norm(final)=2.922 | 1620.0 samples/s | 25.3 steps/s
[Step=16400 Epoch=154.5] | Loss=0.00135 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.623 | FP-Norm(final)=2.923 | 3746.6 samples/s | 58.5 steps/s
[Step=16450 Epoch=155.0] | Loss=0.00121 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.614 | FP-Norm(final)=2.923 | 1654.0 samples/s | 25.8 steps/s
[Step=16500 Epoch=155.5] | Loss=0.00109 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=2.923 | 3606.8 samples/s | 56.4 steps/s
[Step=16550 Epoch=155.9] | Loss=0.00099 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.598 | FP-Norm(final)=2.923 | 1701.6 samples/s | 26.6 steps/s
[Step=16600 Epoch=156.4] | Loss=0.00091 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.924 | 3595.4 samples/s | 56.2 steps/s
[Step=16650 Epoch=156.9] | Loss=0.00085 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.584 | FP-Norm(final)=2.924 | 1679.2 samples/s | 26.2 steps/s
[Step=16700 Epoch=157.4] | Loss=0.00079 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=2.924 | 3553.7 samples/s | 55.5 steps/s
[Step=16750 Epoch=157.8] | Loss=0.00074 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.924 | 1790.4 samples/s | 28.0 steps/s
[Step=16800 Epoch=158.3] | Loss=0.00070 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.925 | 3331.5 samples/s | 52.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31907 | acc=0.8170 | tpr=0.7398 | fpr=0.0156 | 3624.0 samples/s | 14.2 steps/s
Avg test loss: 0.32797, Avg test acc: 0.81473, Avg tpr: 0.73772, Avg fpr: 0.01590, total FA: 124

Testing server on iccad2012
[Step=  50] | Loss=0.47087 | acc=0.8451 | tpr=0.9469 | fpr=0.1568 | 3591.6 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.47280 | acc=0.8438 | tpr=0.9595 | fpr=0.1584 | 4260.8 samples/s | 16.6 steps/s
[Step= 150] | Loss=0.47959 | acc=0.8433 | tpr=0.9697 | fpr=0.1590 | 6761.6 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.47963 | acc=0.8441 | tpr=0.9727 | fpr=0.1583 | 7011.9 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.47905 | acc=0.8432 | tpr=0.9738 | fpr=0.1592 | 6726.2 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.48038 | acc=0.8427 | tpr=0.9731 | fpr=0.1597 | 6817.9 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.48318 | acc=0.8428 | tpr=0.9724 | fpr=0.1595 | 6814.4 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.48329 | acc=0.8428 | tpr=0.9737 | fpr=0.1596 | 6756.3 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.48874 | acc=0.8422 | tpr=0.9737 | fpr=0.1602 | 6639.7 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.48946 | acc=0.8416 | tpr=0.9744 | fpr=0.1608 | 6715.1 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.48640 | acc=0.8421 | tpr=0.9741 | fpr=0.1603 | 13054.0 samples/s | 51.0 steps/s
Avg test loss: 0.48649, Avg test acc: 0.84204, Avg tpr: 0.97385, Avg fpr: 0.16036, total FA: 22265

server round 38/50

clients selected: [0 4 5 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=58.5] | Loss=0.31192 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.928 | 3502.0 samples/s | 54.7 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03943 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.920 | 3639.7 samples/s | 56.9 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02752 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.918 | 3742.7 samples/s | 58.5 steps/s
[Step=12150 Epoch=59.2] | Loss=0.02372 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.918 | 3727.9 samples/s | 58.2 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02024 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.918 | 4826.6 samples/s | 75.4 steps/s
[Step=12250 Epoch=59.7] | Loss=0.01730 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.919 | 1603.7 samples/s | 25.1 steps/s
[Step=12300 Epoch=60.0] | Loss=0.01542 | Reg=0.00034 | acc=0.9844 | FP-Norm=0.577 | FP-Norm(final)=2.921 | 3720.6 samples/s | 58.1 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01397 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.922 | 3745.8 samples/s | 58.5 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01310 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.923 | 4497.0 samples/s | 70.3 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01218 | Reg=0.00033 | acc=0.9844 | FP-Norm=0.574 | FP-Norm(final)=2.925 | 1605.3 samples/s | 25.1 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01146 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=2.927 | 3744.2 samples/s | 58.5 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01071 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=2.928 | 3731.5 samples/s | 58.3 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01029 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=2.930 | 4273.4 samples/s | 66.8 steps/s
[Step=12650 Epoch=61.7] | Loss=0.00976 | Reg=0.00033 | acc=0.9844 | FP-Norm=0.571 | FP-Norm(final)=2.931 | 1658.7 samples/s | 25.9 steps/s
[Step=12700 Epoch=61.9] | Loss=0.00939 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.933 | 3728.1 samples/s | 58.3 steps/s
[Step=12750 Epoch=62.2] | Loss=0.00903 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.934 | 3764.1 samples/s | 58.8 steps/s
[Step=12800 Epoch=62.4] | Loss=0.00868 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.936 | 4024.5 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step12800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=10401 Epoch=51.0] | Loss=0.14526 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.928 | 3252.2 samples/s | 50.8 steps/s
[Step=10450 Epoch=51.2] | Loss=0.03378 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.488 | FP-Norm(final)=2.923 | 1919.7 samples/s | 30.0 steps/s
[Step=10500 Epoch=51.5] | Loss=0.02478 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.922 | 3503.3 samples/s | 54.7 steps/s
[Step=10550 Epoch=51.7] | Loss=0.01931 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.922 | 3727.3 samples/s | 58.2 steps/s
[Step=10600 Epoch=52.0] | Loss=0.01733 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.923 | 4893.5 samples/s | 76.5 steps/s
[Step=10650 Epoch=52.2] | Loss=0.01511 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.924 | 1570.2 samples/s | 24.5 steps/s
[Step=10700 Epoch=52.5] | Loss=0.01356 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.926 | 3722.9 samples/s | 58.2 steps/s
[Step=10750 Epoch=52.7] | Loss=0.01224 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.927 | 3751.0 samples/s | 58.6 steps/s
[Step=10800 Epoch=53.0] | Loss=0.01130 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.929 | 4641.3 samples/s | 72.5 steps/s
[Step=10850 Epoch=53.2] | Loss=0.01031 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.930 | 1600.8 samples/s | 25.0 steps/s
[Step=10900 Epoch=53.5] | Loss=0.00975 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=2.932 | 3757.5 samples/s | 58.7 steps/s
[Step=10950 Epoch=53.7] | Loss=0.00916 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.557 | FP-Norm(final)=2.933 | 3764.3 samples/s | 58.8 steps/s
[Step=11000 Epoch=53.9] | Loss=0.00874 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.935 | 4480.5 samples/s | 70.0 steps/s
[Step=11050 Epoch=54.2] | Loss=0.00837 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.936 | 1626.5 samples/s | 25.4 steps/s
[Step=11100 Epoch=54.4] | Loss=0.00801 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.937 | 3727.9 samples/s | 58.2 steps/s
[Step=11150 Epoch=54.7] | Loss=0.00766 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.939 | 3773.3 samples/s | 59.0 steps/s
[Step=11200 Epoch=54.9] | Loss=0.00743 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.940 | 4321.1 samples/s | 67.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step11200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=21601 Epoch=204.7] | Loss=0.16052 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.928 | 3646.6 samples/s | 57.0 steps/s
[Step=21650 Epoch=205.2] | Loss=0.00592 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.931 | 3315.1 samples/s | 51.8 steps/s
[Step=21700 Epoch=205.6] | Loss=0.00309 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.932 | 4633.5 samples/s | 72.4 steps/s
[Step=21750 Epoch=206.1] | Loss=0.00212 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.933 | 1545.5 samples/s | 24.1 steps/s
[Step=21800 Epoch=206.6] | Loss=0.00160 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=2.933 | 4377.0 samples/s | 68.4 steps/s
[Step=21850 Epoch=207.0] | Loss=0.00129 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.564 | FP-Norm(final)=2.934 | 1571.9 samples/s | 24.6 steps/s
[Step=21900 Epoch=207.5] | Loss=0.00109 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.934 | 4071.9 samples/s | 63.6 steps/s
[Step=21950 Epoch=208.0] | Loss=0.00094 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.934 | 1583.9 samples/s | 24.7 steps/s
[Step=22000 Epoch=208.5] | Loss=0.00083 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=2.935 | 3818.0 samples/s | 59.7 steps/s
[Step=22050 Epoch=208.9] | Loss=0.00074 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.935 | 1658.2 samples/s | 25.9 steps/s
[Step=22100 Epoch=209.4] | Loss=0.00067 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=2.935 | 3646.8 samples/s | 57.0 steps/s
[Step=22150 Epoch=209.9] | Loss=0.00061 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.936 | 1680.0 samples/s | 26.2 steps/s
[Step=22200 Epoch=210.4] | Loss=0.00056 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.936 | 3636.9 samples/s | 56.8 steps/s
[Step=22250 Epoch=210.8] | Loss=0.00052 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=2.936 | 1686.2 samples/s | 26.3 steps/s
[Step=22300 Epoch=211.3] | Loss=0.00049 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.936 | 3644.4 samples/s | 56.9 steps/s
[Step=22350 Epoch=211.8] | Loss=0.00046 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=2.936 | 1682.1 samples/s | 26.3 steps/s
[Step=22400 Epoch=212.3] | Loss=0.00043 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.937 | 3571.2 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step22400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=145.2] | Loss=0.01409 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.928 | 3632.4 samples/s | 56.8 steps/s
[Step=15250 Epoch=145.6] | Loss=0.00574 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.931 | 3344.1 samples/s | 52.3 steps/s
[Step=15300 Epoch=146.1] | Loss=0.00297 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.932 | 4663.2 samples/s | 72.9 steps/s
[Step=15350 Epoch=146.6] | Loss=0.00201 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=2.933 | 1545.6 samples/s | 24.1 steps/s
[Step=15400 Epoch=147.1] | Loss=0.00152 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.933 | 4390.7 samples/s | 68.6 steps/s
[Step=15450 Epoch=147.5] | Loss=0.00123 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.934 | 1549.8 samples/s | 24.2 steps/s
[Step=15500 Epoch=148.0] | Loss=0.00104 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.934 | 4155.8 samples/s | 64.9 steps/s
[Step=15550 Epoch=148.5] | Loss=0.00089 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.526 | FP-Norm(final)=2.935 | 1577.2 samples/s | 24.6 steps/s
[Step=15600 Epoch=149.0] | Loss=0.00079 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=2.935 | 3974.4 samples/s | 62.1 steps/s
[Step=15650 Epoch=149.4] | Loss=0.00070 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.935 | 1595.1 samples/s | 24.9 steps/s
[Step=15700 Epoch=149.9] | Loss=0.00064 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=2.936 | 3823.9 samples/s | 59.7 steps/s
[Step=15750 Epoch=150.4] | Loss=0.00058 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.936 | 1659.9 samples/s | 25.9 steps/s
[Step=15800 Epoch=150.9] | Loss=0.00054 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=2.936 | 3662.2 samples/s | 57.2 steps/s
[Step=15850 Epoch=151.4] | Loss=0.00050 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=2.936 | 1655.0 samples/s | 25.9 steps/s
[Step=15900 Epoch=151.8] | Loss=0.00047 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=2.937 | 3599.1 samples/s | 56.2 steps/s
[Step=15950 Epoch=152.3] | Loss=0.00044 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.480 | FP-Norm(final)=2.937 | 1689.8 samples/s | 26.4 steps/s
[Step=16000 Epoch=152.8] | Loss=0.00041 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=2.937 | 3617.4 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step16000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16801 Epoch=158.3] | Loss=0.10593 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.928 | 3551.4 samples/s | 55.5 steps/s
[Step=16850 Epoch=158.8] | Loss=0.01020 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.925 | 3302.6 samples/s | 51.6 steps/s
[Step=16900 Epoch=159.2] | Loss=0.00527 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.604 | FP-Norm(final)=2.926 | 4623.7 samples/s | 72.2 steps/s
[Step=16950 Epoch=159.7] | Loss=0.00357 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.610 | FP-Norm(final)=2.927 | 1536.7 samples/s | 24.0 steps/s
[Step=17000 Epoch=160.2] | Loss=0.00269 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=2.928 | 4255.1 samples/s | 66.5 steps/s
[Step=17050 Epoch=160.7] | Loss=0.00217 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.597 | FP-Norm(final)=2.929 | 1578.4 samples/s | 24.7 steps/s
[Step=17100 Epoch=161.1] | Loss=0.00182 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.589 | FP-Norm(final)=2.929 | 4004.5 samples/s | 62.6 steps/s
[Step=17150 Epoch=161.6] | Loss=0.00156 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.580 | FP-Norm(final)=2.929 | 1622.3 samples/s | 25.3 steps/s
[Step=17200 Epoch=162.1] | Loss=0.00137 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=2.930 | 3704.3 samples/s | 57.9 steps/s
[Step=17250 Epoch=162.5] | Loss=0.00123 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.930 | 1667.1 samples/s | 26.0 steps/s
[Step=17300 Epoch=163.0] | Loss=0.00111 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.930 | 3569.1 samples/s | 55.8 steps/s
[Step=17350 Epoch=163.5] | Loss=0.00101 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.931 | 1705.4 samples/s | 26.6 steps/s
[Step=17400 Epoch=164.0] | Loss=0.00093 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.931 | 3633.3 samples/s | 56.8 steps/s
[Step=17450 Epoch=164.4] | Loss=0.00086 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.931 | 1699.7 samples/s | 26.6 steps/s
[Step=17500 Epoch=164.9] | Loss=0.00080 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.932 | 3524.9 samples/s | 55.1 steps/s
[Step=17550 Epoch=165.4] | Loss=0.00075 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.932 | 1773.2 samples/s | 27.7 steps/s
[Step=17600 Epoch=165.8] | Loss=0.00071 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=2.932 | 3368.7 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30156 | acc=0.8281 | tpr=0.7560 | fpr=0.0154 | 3698.5 samples/s | 14.4 steps/s
Avg test loss: 0.31048, Avg test acc: 0.82619, Avg tpr: 0.75439, Avg fpr: 0.01590, total FA: 124

Testing server on iccad2012
[Step=  50] | Loss=0.50758 | acc=0.8316 | tpr=0.9469 | fpr=0.1704 | 3622.5 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.51022 | acc=0.8306 | tpr=0.9595 | fpr=0.1718 | 6711.1 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.51706 | acc=0.8305 | tpr=0.9697 | fpr=0.1721 | 6885.8 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.51703 | acc=0.8316 | tpr=0.9727 | fpr=0.1709 | 6874.6 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.51657 | acc=0.8310 | tpr=0.9738 | fpr=0.1716 | 6789.5 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.51802 | acc=0.8306 | tpr=0.9731 | fpr=0.1720 | 6842.2 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.52077 | acc=0.8307 | tpr=0.9724 | fpr=0.1719 | 6955.2 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.52094 | acc=0.8307 | tpr=0.9737 | fpr=0.1719 | 6634.9 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.52646 | acc=0.8301 | tpr=0.9737 | fpr=0.1725 | 6858.3 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.52740 | acc=0.8294 | tpr=0.9744 | fpr=0.1732 | 6718.7 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.52415 | acc=0.8299 | tpr=0.9737 | fpr=0.1727 | 12820.9 samples/s | 50.1 steps/s
Avg test loss: 0.52427, Avg test acc: 0.82983, Avg tpr: 0.97345, Avg fpr: 0.17278, total FA: 23990

server round 39/50

clients selected: [0 1 2 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=62.4] | Loss=0.21179 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.938 | 3593.2 samples/s | 56.1 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03455 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.500 | FP-Norm(final)=2.934 | 3541.4 samples/s | 55.3 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02476 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.933 | 3750.5 samples/s | 58.6 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02106 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=2.933 | 3742.1 samples/s | 58.5 steps/s
[Step=13000 Epoch=63.4] | Loss=0.01848 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.933 | 4802.7 samples/s | 75.0 steps/s
[Step=13050 Epoch=63.6] | Loss=0.01615 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.934 | 1585.0 samples/s | 24.8 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01435 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.936 | 3725.8 samples/s | 58.2 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01315 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.937 | 3721.4 samples/s | 58.1 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01205 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.939 | 4497.3 samples/s | 70.3 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01113 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.940 | 1627.6 samples/s | 25.4 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01059 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.942 | 3749.2 samples/s | 58.6 steps/s
[Step=13350 Epoch=65.1] | Loss=0.00995 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.944 | 3730.5 samples/s | 58.3 steps/s
[Step=13400 Epoch=65.3] | Loss=0.00955 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.945 | 4275.3 samples/s | 66.8 steps/s
[Step=13450 Epoch=65.6] | Loss=0.00907 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.947 | 1641.0 samples/s | 25.6 steps/s
[Step=13500 Epoch=65.8] | Loss=0.00867 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.948 | 3740.2 samples/s | 58.4 steps/s
[Step=13550 Epoch=66.1] | Loss=0.00848 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.950 | 3726.8 samples/s | 58.2 steps/s
[Step=13600 Epoch=66.3] | Loss=0.00819 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.951 | 4027.1 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step13600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16801 Epoch=82.0] | Loss=0.16306 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.938 | 3343.0 samples/s | 52.2 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03341 | Reg=0.00026 | acc=0.9688 | FP-Norm=0.491 | FP-Norm(final)=2.935 | 3775.4 samples/s | 59.0 steps/s
[Step=16900 Epoch=82.5] | Loss=0.02451 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.933 | 3736.1 samples/s | 58.4 steps/s
[Step=16950 Epoch=82.7] | Loss=0.02131 | Reg=0.00032 | acc=0.9844 | FP-Norm=0.557 | FP-Norm(final)=2.932 | 3715.7 samples/s | 58.1 steps/s
[Step=17000 Epoch=83.0] | Loss=0.01897 | Reg=0.00033 | acc=0.9531 | FP-Norm=0.569 | FP-Norm(final)=2.932 | 4783.2 samples/s | 74.7 steps/s
[Step=17050 Epoch=83.2] | Loss=0.01610 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=2.933 | 1571.6 samples/s | 24.6 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01442 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.574 | FP-Norm(final)=2.934 | 3744.3 samples/s | 58.5 steps/s
[Step=17150 Epoch=83.7] | Loss=0.01320 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.574 | FP-Norm(final)=2.935 | 3730.6 samples/s | 58.3 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01233 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.937 | 4560.5 samples/s | 71.3 steps/s
[Step=17250 Epoch=84.2] | Loss=0.01152 | Reg=0.00033 | acc=0.9688 | FP-Norm=0.574 | FP-Norm(final)=2.938 | 1606.6 samples/s | 25.1 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01080 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=2.939 | 3763.4 samples/s | 58.8 steps/s
[Step=17350 Epoch=84.7] | Loss=0.01011 | Reg=0.00033 | acc=0.9844 | FP-Norm=0.572 | FP-Norm(final)=2.941 | 3740.6 samples/s | 58.4 steps/s
[Step=17400 Epoch=84.9] | Loss=0.00968 | Reg=0.00033 | acc=0.9844 | FP-Norm=0.572 | FP-Norm(final)=2.942 | 4349.0 samples/s | 68.0 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00928 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.943 | 1640.0 samples/s | 25.6 steps/s
[Step=17500 Epoch=85.4] | Loss=0.00893 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.945 | 3718.2 samples/s | 58.1 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00855 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.946 | 3717.0 samples/s | 58.1 steps/s
[Step=17600 Epoch=85.9] | Loss=0.00827 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.947 | 4163.6 samples/s | 65.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step17600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=18401 Epoch=89.7] | Loss=0.09021 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.938 | 3622.6 samples/s | 56.6 steps/s
[Step=18450 Epoch=89.9] | Loss=0.02729 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=2.935 | 3514.0 samples/s | 54.9 steps/s
[Step=18500 Epoch=90.1] | Loss=0.01982 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.503 | FP-Norm(final)=2.935 | 3712.6 samples/s | 58.0 steps/s
[Step=18550 Epoch=90.4] | Loss=0.01757 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.519 | FP-Norm(final)=2.935 | 3765.1 samples/s | 58.8 steps/s
[Step=18600 Epoch=90.6] | Loss=0.01594 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.526 | FP-Norm(final)=2.936 | 4768.6 samples/s | 74.5 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01381 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.532 | FP-Norm(final)=2.937 | 1595.2 samples/s | 24.9 steps/s
[Step=18700 Epoch=91.1] | Loss=0.01241 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.938 | 3756.8 samples/s | 58.7 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01142 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.940 | 3739.5 samples/s | 58.4 steps/s
[Step=18800 Epoch=91.6] | Loss=0.01058 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.942 | 4495.7 samples/s | 70.2 steps/s
[Step=18850 Epoch=91.8] | Loss=0.00982 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.943 | 1602.1 samples/s | 25.0 steps/s
[Step=18900 Epoch=92.1] | Loss=0.00928 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.945 | 3755.0 samples/s | 58.7 steps/s
[Step=18950 Epoch=92.3] | Loss=0.00881 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.947 | 3774.0 samples/s | 59.0 steps/s
[Step=19000 Epoch=92.6] | Loss=0.00841 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.948 | 4264.3 samples/s | 66.6 steps/s
[Step=19050 Epoch=92.8] | Loss=0.00804 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.950 | 1654.4 samples/s | 25.8 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00776 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.951 | 3734.2 samples/s | 58.3 steps/s
[Step=19150 Epoch=93.3] | Loss=0.00753 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.953 | 3755.0 samples/s | 58.7 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00721 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=2.954 | 3995.8 samples/s | 62.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step19200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=129.4] | Loss=0.01638 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.939 | 3703.6 samples/s | 57.9 steps/s
[Step=13650 Epoch=129.8] | Loss=0.00968 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.938 | 3339.2 samples/s | 52.2 steps/s
[Step=13700 Epoch=130.3] | Loss=0.00520 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.644 | FP-Norm(final)=2.939 | 4678.1 samples/s | 73.1 steps/s
[Step=13750 Epoch=130.8] | Loss=0.00350 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.648 | FP-Norm(final)=2.940 | 1533.1 samples/s | 24.0 steps/s
[Step=13800 Epoch=131.3] | Loss=0.00264 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.641 | FP-Norm(final)=2.941 | 4353.4 samples/s | 68.0 steps/s
[Step=13850 Epoch=131.7] | Loss=0.00213 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.631 | FP-Norm(final)=2.941 | 1572.0 samples/s | 24.6 steps/s
[Step=13900 Epoch=132.2] | Loss=0.00178 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.941 | 4081.1 samples/s | 63.8 steps/s
[Step=13950 Epoch=132.7] | Loss=0.00154 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.612 | FP-Norm(final)=2.942 | 1607.7 samples/s | 25.1 steps/s
[Step=14000 Epoch=133.2] | Loss=0.00135 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.603 | FP-Norm(final)=2.942 | 3874.7 samples/s | 60.5 steps/s
[Step=14050 Epoch=133.7] | Loss=0.00120 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=2.942 | 1648.0 samples/s | 25.8 steps/s
[Step=14100 Epoch=134.1] | Loss=0.00109 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.586 | FP-Norm(final)=2.943 | 3639.7 samples/s | 56.9 steps/s
[Step=14150 Epoch=134.6] | Loss=0.00099 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.943 | 1677.9 samples/s | 26.2 steps/s
[Step=14200 Epoch=135.1] | Loss=0.00091 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=2.943 | 3596.5 samples/s | 56.2 steps/s
[Step=14250 Epoch=135.6] | Loss=0.00084 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.944 | 1703.2 samples/s | 26.6 steps/s
[Step=14300 Epoch=136.0] | Loss=0.00079 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.944 | 3637.7 samples/s | 56.8 steps/s
[Step=14350 Epoch=136.5] | Loss=0.00074 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.553 | FP-Norm(final)=2.944 | 1687.3 samples/s | 26.4 steps/s
[Step=14400 Epoch=137.0] | Loss=0.00069 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.944 | 3544.4 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step14400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=152.8] | Loss=0.14986 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.938 | 3602.3 samples/s | 56.3 steps/s
[Step=16050 Epoch=153.3] | Loss=0.00699 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.649 | FP-Norm(final)=2.940 | 3254.4 samples/s | 50.9 steps/s
[Step=16100 Epoch=153.7] | Loss=0.00361 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.689 | FP-Norm(final)=2.941 | 4600.0 samples/s | 71.9 steps/s
[Step=16150 Epoch=154.2] | Loss=0.00245 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.685 | FP-Norm(final)=2.942 | 1515.2 samples/s | 23.7 steps/s
[Step=16200 Epoch=154.7] | Loss=0.00186 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.673 | FP-Norm(final)=2.943 | 4437.8 samples/s | 69.3 steps/s
[Step=16250 Epoch=155.2] | Loss=0.00150 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.661 | FP-Norm(final)=2.944 | 1548.4 samples/s | 24.2 steps/s
[Step=16300 Epoch=155.7] | Loss=0.00126 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.649 | FP-Norm(final)=2.944 | 4190.0 samples/s | 65.5 steps/s
[Step=16350 Epoch=156.1] | Loss=0.00108 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.637 | FP-Norm(final)=2.945 | 1601.2 samples/s | 25.0 steps/s
[Step=16400 Epoch=156.6] | Loss=0.00096 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.626 | FP-Norm(final)=2.945 | 3960.1 samples/s | 61.9 steps/s
[Step=16450 Epoch=157.1] | Loss=0.00085 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.617 | FP-Norm(final)=2.945 | 1607.5 samples/s | 25.1 steps/s
[Step=16500 Epoch=157.6] | Loss=0.00077 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.607 | FP-Norm(final)=2.946 | 3744.8 samples/s | 58.5 steps/s
[Step=16550 Epoch=158.0] | Loss=0.00071 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.599 | FP-Norm(final)=2.946 | 1636.3 samples/s | 25.6 steps/s
[Step=16600 Epoch=158.5] | Loss=0.00065 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.591 | FP-Norm(final)=2.946 | 3611.3 samples/s | 56.4 steps/s
[Step=16650 Epoch=159.0] | Loss=0.00060 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.584 | FP-Norm(final)=2.947 | 1671.3 samples/s | 26.1 steps/s
[Step=16700 Epoch=159.5] | Loss=0.00056 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=2.947 | 3615.9 samples/s | 56.5 steps/s
[Step=16750 Epoch=160.0] | Loss=0.00053 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.947 | 1685.6 samples/s | 26.3 steps/s
[Step=16800 Epoch=160.4] | Loss=0.00050 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.564 | FP-Norm(final)=2.947 | 3618.3 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31786 | acc=0.8186 | tpr=0.7419 | fpr=0.0149 | 3580.3 samples/s | 14.0 steps/s
Avg test loss: 0.32681, Avg test acc: 0.81641, Avg tpr: 0.73993, Avg fpr: 0.01538, total FA: 120

Testing server on iccad2012
[Step=  50] | Loss=0.48741 | acc=0.8412 | tpr=0.9469 | fpr=0.1607 | 3594.1 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.48998 | acc=0.8405 | tpr=0.9595 | fpr=0.1618 | 6774.6 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.49684 | acc=0.8402 | tpr=0.9697 | fpr=0.1622 | 6864.8 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.49689 | acc=0.8409 | tpr=0.9716 | fpr=0.1615 | 6722.0 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.49612 | acc=0.8400 | tpr=0.9729 | fpr=0.1624 | 7000.8 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.49758 | acc=0.8397 | tpr=0.9724 | fpr=0.1627 | 6783.8 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.50025 | acc=0.8398 | tpr=0.9718 | fpr=0.1626 | 6808.8 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.50044 | acc=0.8399 | tpr=0.9732 | fpr=0.1625 | 6950.6 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.50593 | acc=0.8394 | tpr=0.9732 | fpr=0.1630 | 6613.6 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.50668 | acc=0.8387 | tpr=0.9740 | fpr=0.1637 | 6753.6 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.50346 | acc=0.8393 | tpr=0.9733 | fpr=0.1631 | 12651.9 samples/s | 49.4 steps/s
Avg test loss: 0.50356, Avg test acc: 0.83920, Avg tpr: 0.97306, Avg fpr: 0.16323, total FA: 22664

server round 40/50

clients selected: [0 1 4 5 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=13601 Epoch=66.3] | Loss=0.13023 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.949 | 3706.0 samples/s | 57.9 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03960 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=2.947 | 3475.3 samples/s | 54.3 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02739 | Reg=0.00018 | acc=0.9688 | FP-Norm=0.412 | FP-Norm(final)=2.946 | 3740.2 samples/s | 58.4 steps/s
[Step=13750 Epoch=67.0] | Loss=0.02178 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=2.946 | 3729.5 samples/s | 58.3 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01824 | Reg=0.00018 | acc=0.9844 | FP-Norm=0.423 | FP-Norm(final)=2.947 | 4798.6 samples/s | 75.0 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01548 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.947 | 1568.7 samples/s | 24.5 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01388 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=2.948 | 3690.5 samples/s | 57.7 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01271 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.949 | 3761.0 samples/s | 58.8 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01203 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.429 | FP-Norm(final)=2.950 | 4504.0 samples/s | 70.4 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01128 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.431 | FP-Norm(final)=2.951 | 1608.1 samples/s | 25.1 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01060 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.432 | FP-Norm(final)=2.952 | 3758.1 samples/s | 58.7 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01004 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=2.953 | 3745.7 samples/s | 58.5 steps/s
[Step=14200 Epoch=69.2] | Loss=0.00956 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.434 | FP-Norm(final)=2.954 | 4234.3 samples/s | 66.2 steps/s
[Step=14250 Epoch=69.5] | Loss=0.00913 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.434 | FP-Norm(final)=2.955 | 1650.3 samples/s | 25.8 steps/s
[Step=14300 Epoch=69.7] | Loss=0.00878 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=2.956 | 3729.8 samples/s | 58.3 steps/s
[Step=14350 Epoch=70.0] | Loss=0.00850 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.436 | FP-Norm(final)=2.957 | 3743.4 samples/s | 58.5 steps/s
[Step=14400 Epoch=70.2] | Loss=0.00821 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.958 | 4040.7 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step14400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=85.9] | Loss=0.23825 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.949 | 3684.7 samples/s | 57.6 steps/s
[Step=17650 Epoch=86.1] | Loss=0.04189 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.946 | 3539.0 samples/s | 55.3 steps/s
[Step=17700 Epoch=86.4] | Loss=0.02840 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=2.945 | 3710.7 samples/s | 58.0 steps/s
[Step=17750 Epoch=86.6] | Loss=0.02357 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.436 | FP-Norm(final)=2.945 | 3753.1 samples/s | 58.6 steps/s
[Step=17800 Epoch=86.9] | Loss=0.02052 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.945 | 4781.6 samples/s | 74.7 steps/s
[Step=17850 Epoch=87.1] | Loss=0.01783 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.945 | 1572.7 samples/s | 24.6 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01584 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.448 | FP-Norm(final)=2.946 | 3746.3 samples/s | 58.5 steps/s
[Step=17950 Epoch=87.6] | Loss=0.01438 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=2.946 | 3759.7 samples/s | 58.7 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01332 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.947 | 4568.1 samples/s | 71.4 steps/s
[Step=18050 Epoch=88.1] | Loss=0.01231 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=2.948 | 1621.2 samples/s | 25.3 steps/s
[Step=18100 Epoch=88.3] | Loss=0.01152 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=2.949 | 3756.0 samples/s | 58.7 steps/s
[Step=18150 Epoch=88.6] | Loss=0.01089 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=2.950 | 3778.1 samples/s | 59.0 steps/s
[Step=18200 Epoch=88.8] | Loss=0.01038 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.455 | FP-Norm(final)=2.951 | 4367.5 samples/s | 68.2 steps/s
[Step=18250 Epoch=89.1] | Loss=0.00983 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=2.952 | 1625.4 samples/s | 25.4 steps/s
[Step=18300 Epoch=89.3] | Loss=0.00936 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=2.953 | 3684.8 samples/s | 57.6 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00898 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=2.953 | 3724.2 samples/s | 58.2 steps/s
[Step=18400 Epoch=89.8] | Loss=0.00867 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.458 | FP-Norm(final)=2.954 | 4154.1 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step18400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=11201 Epoch=54.9] | Loss=0.40182 | Reg=0.00000 | acc=0.7812 | FP-Norm=0.000 | FP-Norm(final)=2.949 | 3859.1 samples/s | 60.3 steps/s
[Step=11250 Epoch=55.2] | Loss=0.03836 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=2.947 | 3320.3 samples/s | 51.9 steps/s
[Step=11300 Epoch=55.4] | Loss=0.02613 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=2.946 | 3736.5 samples/s | 58.4 steps/s
[Step=11350 Epoch=55.7] | Loss=0.02069 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.947 | 3707.9 samples/s | 57.9 steps/s
[Step=11400 Epoch=55.9] | Loss=0.01773 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.947 | 4883.6 samples/s | 76.3 steps/s
[Step=11450 Epoch=56.1] | Loss=0.01506 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.948 | 1570.4 samples/s | 24.5 steps/s
[Step=11500 Epoch=56.4] | Loss=0.01344 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.405 | FP-Norm(final)=2.949 | 3746.9 samples/s | 58.5 steps/s
[Step=11550 Epoch=56.6] | Loss=0.01220 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.950 | 3722.8 samples/s | 58.2 steps/s
[Step=11600 Epoch=56.9] | Loss=0.01135 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.951 | 4658.0 samples/s | 72.8 steps/s
[Step=11650 Epoch=57.1] | Loss=0.01055 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.952 | 1593.1 samples/s | 24.9 steps/s
[Step=11700 Epoch=57.4] | Loss=0.00983 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.952 | 3735.6 samples/s | 58.4 steps/s
[Step=11750 Epoch=57.6] | Loss=0.00932 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=2.953 | 3734.5 samples/s | 58.4 steps/s
[Step=11800 Epoch=57.9] | Loss=0.00885 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=2.954 | 4468.2 samples/s | 69.8 steps/s
[Step=11850 Epoch=58.1] | Loss=0.00845 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.955 | 1635.8 samples/s | 25.6 steps/s
[Step=11900 Epoch=58.4] | Loss=0.00812 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.956 | 3759.5 samples/s | 58.7 steps/s
[Step=11950 Epoch=58.6] | Loss=0.00779 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.416 | FP-Norm(final)=2.957 | 3748.1 samples/s | 58.6 steps/s
[Step=12000 Epoch=58.8] | Loss=0.00749 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.958 | 4270.8 samples/s | 66.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=22401 Epoch=212.3] | Loss=0.06346 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.949 | 3321.5 samples/s | 51.9 steps/s
[Step=22450 Epoch=212.7] | Loss=0.00895 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.949 | 3575.3 samples/s | 55.9 steps/s
[Step=22500 Epoch=213.2] | Loss=0.00479 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=2.950 | 4660.5 samples/s | 72.8 steps/s
[Step=22550 Epoch=213.7] | Loss=0.00324 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=2.950 | 1546.5 samples/s | 24.2 steps/s
[Step=22600 Epoch=214.2] | Loss=0.00246 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=2.951 | 4327.3 samples/s | 67.6 steps/s
[Step=22650 Epoch=214.6] | Loss=0.00199 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=2.951 | 1567.5 samples/s | 24.5 steps/s
[Step=22700 Epoch=215.1] | Loss=0.00167 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.431 | FP-Norm(final)=2.952 | 4052.8 samples/s | 63.3 steps/s
[Step=22750 Epoch=215.6] | Loss=0.00145 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.952 | 1611.5 samples/s | 25.2 steps/s
[Step=22800 Epoch=216.0] | Loss=0.00127 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=2.952 | 3831.1 samples/s | 59.9 steps/s
[Step=22850 Epoch=216.5] | Loss=0.00114 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=2.953 | 1615.1 samples/s | 25.2 steps/s
[Step=22900 Epoch=217.0] | Loss=0.00103 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.953 | 3640.8 samples/s | 56.9 steps/s
[Step=22950 Epoch=217.5] | Loss=0.00095 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.953 | 1703.5 samples/s | 26.6 steps/s
[Step=23000 Epoch=217.9] | Loss=0.00087 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.953 | 3593.3 samples/s | 56.1 steps/s
[Step=23050 Epoch=218.4] | Loss=0.00081 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.954 | 1695.8 samples/s | 26.5 steps/s
[Step=23100 Epoch=218.9] | Loss=0.00075 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.954 | 3586.1 samples/s | 56.0 steps/s
[Step=23150 Epoch=219.4] | Loss=0.00071 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.954 | 1666.2 samples/s | 26.0 steps/s
[Step=23200 Epoch=219.8] | Loss=0.00067 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.954 | 3574.4 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step23200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=165.9] | Loss=0.07381 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.949 | 3630.1 samples/s | 56.7 steps/s
[Step=17650 Epoch=166.3] | Loss=0.00924 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=2.950 | 3243.4 samples/s | 50.7 steps/s
[Step=17700 Epoch=166.8] | Loss=0.00477 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.430 | FP-Norm(final)=2.950 | 4625.6 samples/s | 72.3 steps/s
[Step=17750 Epoch=167.3] | Loss=0.00325 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=2.951 | 1543.2 samples/s | 24.1 steps/s
[Step=17800 Epoch=167.7] | Loss=0.00247 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.951 | 4254.6 samples/s | 66.5 steps/s
[Step=17850 Epoch=168.2] | Loss=0.00200 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=2.952 | 1588.0 samples/s | 24.8 steps/s
[Step=17900 Epoch=168.7] | Loss=0.00168 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.952 | 3928.6 samples/s | 61.4 steps/s
[Step=17950 Epoch=169.1] | Loss=0.00145 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.952 | 1612.4 samples/s | 25.2 steps/s
[Step=18000 Epoch=169.6] | Loss=0.00128 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.952 | 3688.6 samples/s | 57.6 steps/s
[Step=18050 Epoch=170.1] | Loss=0.00115 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=2.953 | 1676.1 samples/s | 26.2 steps/s
[Step=18100 Epoch=170.6] | Loss=0.00104 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.953 | 3614.7 samples/s | 56.5 steps/s
[Step=18150 Epoch=171.0] | Loss=0.00095 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.953 | 1678.0 samples/s | 26.2 steps/s
[Step=18200 Epoch=171.5] | Loss=0.00088 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.953 | 3595.0 samples/s | 56.2 steps/s
[Step=18250 Epoch=172.0] | Loss=0.00082 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.954 | 1699.0 samples/s | 26.5 steps/s
[Step=18300 Epoch=172.4] | Loss=0.00076 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.954 | 3557.2 samples/s | 55.6 steps/s
[Step=18350 Epoch=172.9] | Loss=0.00072 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=2.954 | 1840.8 samples/s | 28.8 steps/s
[Step=18400 Epoch=173.4] | Loss=0.00068 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.954 | 3137.9 samples/s | 49.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31999 | acc=0.8184 | tpr=0.7416 | fpr=0.0146 | 3566.5 samples/s | 13.9 steps/s
Avg test loss: 0.32866, Avg test acc: 0.81709, Avg tpr: 0.74086, Avg fpr: 0.01525, total FA: 119

Testing server on iccad2012
[Step=  50] | Loss=0.48172 | acc=0.8433 | tpr=0.9469 | fpr=0.1586 | 3603.3 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.48391 | acc=0.8430 | tpr=0.9595 | fpr=0.1592 | 6708.2 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.49081 | acc=0.8429 | tpr=0.9697 | fpr=0.1594 | 7003.3 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.49104 | acc=0.8438 | tpr=0.9727 | fpr=0.1586 | 6593.0 samples/s | 25.8 steps/s
[Step= 250] | Loss=0.49008 | acc=0.8432 | tpr=0.9729 | fpr=0.1591 | 6888.1 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.49154 | acc=0.8430 | tpr=0.9716 | fpr=0.1594 | 6786.0 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.49433 | acc=0.8432 | tpr=0.9712 | fpr=0.1591 | 7020.8 samples/s | 27.4 steps/s
[Step= 400] | Loss=0.49460 | acc=0.8431 | tpr=0.9726 | fpr=0.1592 | 6505.3 samples/s | 25.4 steps/s
[Step= 450] | Loss=0.50013 | acc=0.8427 | tpr=0.9732 | fpr=0.1596 | 6990.0 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.50082 | acc=0.8421 | tpr=0.9740 | fpr=0.1603 | 6643.4 samples/s | 26.0 steps/s
[Step= 550] | Loss=0.49764 | acc=0.8427 | tpr=0.9733 | fpr=0.1597 | 12650.7 samples/s | 49.4 steps/s
Avg test loss: 0.49771, Avg test acc: 0.84259, Avg tpr: 0.97306, Avg fpr: 0.15979, total FA: 22186

server round 41/50

clients selected: [0 2 4 5 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=14401 Epoch=70.2] | Loss=0.06811 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.954 | 3624.0 samples/s | 56.6 steps/s
[Step=14450 Epoch=70.5] | Loss=0.03062 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.329 | FP-Norm(final)=2.954 | 3523.4 samples/s | 55.1 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02436 | Reg=0.00014 | acc=0.9531 | FP-Norm=0.367 | FP-Norm(final)=2.954 | 3746.6 samples/s | 58.5 steps/s
[Step=14550 Epoch=70.9] | Loss=0.01970 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=2.953 | 3755.1 samples/s | 58.7 steps/s
[Step=14600 Epoch=71.2] | Loss=0.01749 | Reg=0.00016 | acc=0.9688 | FP-Norm=0.392 | FP-Norm(final)=2.954 | 4822.8 samples/s | 75.4 steps/s
[Step=14650 Epoch=71.4] | Loss=0.01519 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.954 | 1595.6 samples/s | 24.9 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01367 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.955 | 3712.8 samples/s | 58.0 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01248 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.956 | 3756.9 samples/s | 58.7 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01169 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.957 | 4512.2 samples/s | 70.5 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01095 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.958 | 1622.9 samples/s | 25.4 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01025 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=2.959 | 3745.2 samples/s | 58.5 steps/s
[Step=14950 Epoch=72.9] | Loss=0.00988 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.959 | 3781.5 samples/s | 59.1 steps/s
[Step=15000 Epoch=73.1] | Loss=0.00937 | Reg=0.00018 | acc=0.9844 | FP-Norm=0.416 | FP-Norm(final)=2.960 | 4245.8 samples/s | 66.3 steps/s
[Step=15050 Epoch=73.4] | Loss=0.00898 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=2.961 | 1639.3 samples/s | 25.6 steps/s
[Step=15100 Epoch=73.6] | Loss=0.00861 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=2.962 | 3750.0 samples/s | 58.6 steps/s
[Step=15150 Epoch=73.9] | Loss=0.00826 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=2.963 | 3709.2 samples/s | 58.0 steps/s
[Step=15200 Epoch=74.1] | Loss=0.00807 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.964 | 4041.7 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step15200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=93.6] | Loss=0.04797 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.954 | 3847.7 samples/s | 60.1 steps/s
[Step=19250 Epoch=93.8] | Loss=0.03721 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=2.952 | 3405.8 samples/s | 53.2 steps/s
[Step=19300 Epoch=94.0] | Loss=0.02472 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.952 | 3742.7 samples/s | 58.5 steps/s
[Step=19350 Epoch=94.3] | Loss=0.01993 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.952 | 3737.8 samples/s | 58.4 steps/s
[Step=19400 Epoch=94.5] | Loss=0.01715 | Reg=0.00018 | acc=0.9844 | FP-Norm=0.416 | FP-Norm(final)=2.953 | 4814.9 samples/s | 75.2 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01503 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=2.954 | 1581.6 samples/s | 24.7 steps/s
[Step=19500 Epoch=95.0] | Loss=0.01338 | Reg=0.00018 | acc=0.9844 | FP-Norm=0.423 | FP-Norm(final)=2.955 | 3737.8 samples/s | 58.4 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01209 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.956 | 3755.5 samples/s | 58.7 steps/s
[Step=19600 Epoch=95.5] | Loss=0.01113 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.957 | 4506.8 samples/s | 70.4 steps/s
[Step=19650 Epoch=95.7] | Loss=0.01032 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.958 | 1621.1 samples/s | 25.3 steps/s
[Step=19700 Epoch=96.0] | Loss=0.00968 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.959 | 3746.1 samples/s | 58.5 steps/s
[Step=19750 Epoch=96.2] | Loss=0.00914 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.960 | 3736.4 samples/s | 58.4 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00877 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=2.961 | 4226.4 samples/s | 66.0 steps/s
[Step=19850 Epoch=96.7] | Loss=0.00830 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.962 | 1640.3 samples/s | 25.6 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00790 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.430 | FP-Norm(final)=2.964 | 3782.6 samples/s | 59.1 steps/s
[Step=19950 Epoch=97.2] | Loss=0.00762 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.431 | FP-Norm(final)=2.965 | 3770.7 samples/s | 58.9 steps/s
[Step=20000 Epoch=97.4] | Loss=0.00743 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.431 | FP-Norm(final)=2.966 | 4054.7 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step20000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=12001 Epoch=58.9] | Loss=0.33290 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.954 | 3398.5 samples/s | 53.1 steps/s
[Step=12050 Epoch=59.1] | Loss=0.03412 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.333 | FP-Norm(final)=2.953 | 3752.2 samples/s | 58.6 steps/s
[Step=12100 Epoch=59.3] | Loss=0.02277 | Reg=0.00014 | acc=0.9688 | FP-Norm=0.359 | FP-Norm(final)=2.953 | 3732.9 samples/s | 58.3 steps/s
[Step=12150 Epoch=59.6] | Loss=0.01939 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.953 | 3738.8 samples/s | 58.4 steps/s
[Step=12200 Epoch=59.8] | Loss=0.01637 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.384 | FP-Norm(final)=2.954 | 4852.4 samples/s | 75.8 steps/s
[Step=12250 Epoch=60.1] | Loss=0.01410 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=2.955 | 1574.5 samples/s | 24.6 steps/s
[Step=12300 Epoch=60.3] | Loss=0.01282 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.955 | 3729.4 samples/s | 58.3 steps/s
[Step=12350 Epoch=60.6] | Loss=0.01174 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.956 | 3729.6 samples/s | 58.3 steps/s
[Step=12400 Epoch=60.8] | Loss=0.01078 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.957 | 4675.2 samples/s | 73.0 steps/s
[Step=12450 Epoch=61.1] | Loss=0.01003 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.399 | FP-Norm(final)=2.958 | 1577.8 samples/s | 24.7 steps/s
[Step=12500 Epoch=61.3] | Loss=0.00946 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.959 | 3733.7 samples/s | 58.3 steps/s
[Step=12550 Epoch=61.5] | Loss=0.00897 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.402 | FP-Norm(final)=2.960 | 3761.8 samples/s | 58.8 steps/s
[Step=12600 Epoch=61.8] | Loss=0.00847 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.961 | 4473.0 samples/s | 69.9 steps/s
[Step=12650 Epoch=62.0] | Loss=0.00805 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.962 | 1618.6 samples/s | 25.3 steps/s
[Step=12700 Epoch=62.3] | Loss=0.00771 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.963 | 3761.0 samples/s | 58.8 steps/s
[Step=12750 Epoch=62.5] | Loss=0.00744 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.964 | 3777.8 samples/s | 59.0 steps/s
[Step=12800 Epoch=62.8] | Loss=0.00721 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.965 | 4316.0 samples/s | 67.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step12800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=23201 Epoch=219.8] | Loss=0.02558 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.954 | 3531.3 samples/s | 55.2 steps/s
[Step=23250 Epoch=220.3] | Loss=0.00694 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.955 | 3485.9 samples/s | 54.5 steps/s
[Step=23300 Epoch=220.8] | Loss=0.00371 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.956 | 4652.4 samples/s | 72.7 steps/s
[Step=23350 Epoch=221.3] | Loss=0.00251 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=2.957 | 1543.3 samples/s | 24.1 steps/s
[Step=23400 Epoch=221.7] | Loss=0.00191 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=2.957 | 4322.4 samples/s | 67.5 steps/s
[Step=23450 Epoch=222.2] | Loss=0.00154 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.436 | FP-Norm(final)=2.957 | 1565.8 samples/s | 24.5 steps/s
[Step=23500 Epoch=222.7] | Loss=0.00130 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=2.958 | 4074.0 samples/s | 63.7 steps/s
[Step=23550 Epoch=223.2] | Loss=0.00112 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.958 | 1619.2 samples/s | 25.3 steps/s
[Step=23600 Epoch=223.6] | Loss=0.00099 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.958 | 3819.6 samples/s | 59.7 steps/s
[Step=23650 Epoch=224.1] | Loss=0.00089 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=2.959 | 1628.7 samples/s | 25.4 steps/s
[Step=23700 Epoch=224.6] | Loss=0.00081 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.959 | 3671.6 samples/s | 57.4 steps/s
[Step=23750 Epoch=225.1] | Loss=0.00074 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.959 | 1685.9 samples/s | 26.3 steps/s
[Step=23800 Epoch=225.5] | Loss=0.00068 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.959 | 3609.1 samples/s | 56.4 steps/s
[Step=23850 Epoch=226.0] | Loss=0.00063 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.959 | 1700.1 samples/s | 26.6 steps/s
[Step=23900 Epoch=226.5] | Loss=0.00059 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.960 | 3626.7 samples/s | 56.7 steps/s
[Step=23950 Epoch=226.9] | Loss=0.00055 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.960 | 1700.4 samples/s | 26.6 steps/s
[Step=24000 Epoch=227.4] | Loss=0.00052 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.960 | 3553.5 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step24000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=160.4] | Loss=0.01474 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.954 | 3893.3 samples/s | 60.8 steps/s
[Step=16850 Epoch=160.9] | Loss=0.01091 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.955 | 3070.6 samples/s | 48.0 steps/s
[Step=16900 Epoch=161.4] | Loss=0.00586 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=2.955 | 4683.9 samples/s | 73.2 steps/s
[Step=16950 Epoch=161.9] | Loss=0.00396 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.468 | FP-Norm(final)=2.956 | 1514.1 samples/s | 23.7 steps/s
[Step=17000 Epoch=162.3] | Loss=0.00300 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.470 | FP-Norm(final)=2.956 | 4391.6 samples/s | 68.6 steps/s
[Step=17050 Epoch=162.8] | Loss=0.00241 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.468 | FP-Norm(final)=2.957 | 1471.0 samples/s | 23.0 steps/s
[Step=17100 Epoch=163.3] | Loss=0.00203 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.957 | 3867.4 samples/s | 60.4 steps/s
[Step=17150 Epoch=163.8] | Loss=0.00175 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.460 | FP-Norm(final)=2.957 | 1557.1 samples/s | 24.3 steps/s
[Step=17200 Epoch=164.2] | Loss=0.00154 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=2.957 | 3989.6 samples/s | 62.3 steps/s
[Step=17250 Epoch=164.7] | Loss=0.00138 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.958 | 1623.2 samples/s | 25.4 steps/s
[Step=17300 Epoch=165.2] | Loss=0.00124 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.448 | FP-Norm(final)=2.958 | 3792.8 samples/s | 59.3 steps/s
[Step=17350 Epoch=165.7] | Loss=0.00114 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.444 | FP-Norm(final)=2.958 | 1652.3 samples/s | 25.8 steps/s
[Step=17400 Epoch=166.2] | Loss=0.00105 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=2.958 | 3649.5 samples/s | 57.0 steps/s
[Step=17450 Epoch=166.6] | Loss=0.00097 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.958 | 1668.6 samples/s | 26.1 steps/s
[Step=17500 Epoch=167.1] | Loss=0.00091 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=2.959 | 3603.4 samples/s | 56.3 steps/s
[Step=17550 Epoch=167.6] | Loss=0.00085 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.430 | FP-Norm(final)=2.959 | 1704.8 samples/s | 26.6 steps/s
[Step=17600 Epoch=168.1] | Loss=0.00080 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.959 | 3611.6 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31341 | acc=0.8226 | tpr=0.7478 | fpr=0.0151 | 3605.9 samples/s | 14.1 steps/s
Avg test loss: 0.32207, Avg test acc: 0.82094, Avg tpr: 0.74663, Avg fpr: 0.01564, total FA: 122

Testing server on iccad2012
[Step=  50] | Loss=0.48186 | acc=0.8441 | tpr=0.9469 | fpr=0.1578 | 3639.6 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.48379 | acc=0.8441 | tpr=0.9574 | fpr=0.1581 | 6845.4 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.49043 | acc=0.8441 | tpr=0.9683 | fpr=0.1582 | 6837.2 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.49081 | acc=0.8452 | tpr=0.9716 | fpr=0.1571 | 6773.9 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.48979 | acc=0.8444 | tpr=0.9721 | fpr=0.1579 | 6977.3 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.49124 | acc=0.8440 | tpr=0.9709 | fpr=0.1583 | 6760.2 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.49416 | acc=0.8444 | tpr=0.9706 | fpr=0.1579 | 6723.6 samples/s | 26.3 steps/s
[Step= 400] | Loss=0.49453 | acc=0.8443 | tpr=0.9721 | fpr=0.1580 | 6616.1 samples/s | 25.8 steps/s
[Step= 450] | Loss=0.50008 | acc=0.8439 | tpr=0.9722 | fpr=0.1584 | 6886.4 samples/s | 26.9 steps/s
[Step= 500] | Loss=0.50075 | acc=0.8433 | tpr=0.9731 | fpr=0.1590 | 6692.1 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.49758 | acc=0.8439 | tpr=0.9725 | fpr=0.1584 | 12155.9 samples/s | 47.5 steps/s
Avg test loss: 0.49766, Avg test acc: 0.84380, Avg tpr: 0.97227, Avg fpr: 0.15854, total FA: 22013

server round 42/50

clients selected: [1 3 4 7 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=89.8] | Loss=0.14481 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.958 | 3701.0 samples/s | 57.8 steps/s
[Step=18450 Epoch=90.0] | Loss=0.03900 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=2.955 | 3473.4 samples/s | 54.3 steps/s
[Step=18500 Epoch=90.3] | Loss=0.02720 | Reg=0.00018 | acc=0.9688 | FP-Norm=0.413 | FP-Norm(final)=2.955 | 3745.6 samples/s | 58.5 steps/s
[Step=18550 Epoch=90.5] | Loss=0.02256 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=2.955 | 3748.1 samples/s | 58.6 steps/s
[Step=18600 Epoch=90.8] | Loss=0.01997 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.955 | 4810.6 samples/s | 75.2 steps/s
[Step=18650 Epoch=91.0] | Loss=0.01717 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=2.955 | 1575.5 samples/s | 24.6 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01555 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.436 | FP-Norm(final)=2.956 | 3733.2 samples/s | 58.3 steps/s
[Step=18750 Epoch=91.5] | Loss=0.01400 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=2.956 | 3773.4 samples/s | 59.0 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01298 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.440 | FP-Norm(final)=2.957 | 4602.4 samples/s | 71.9 steps/s
[Step=18850 Epoch=92.0] | Loss=0.01208 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=2.958 | 1590.2 samples/s | 24.8 steps/s
[Step=18900 Epoch=92.2] | Loss=0.01128 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=2.959 | 3745.9 samples/s | 58.5 steps/s
[Step=18950 Epoch=92.5] | Loss=0.01071 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.444 | FP-Norm(final)=2.960 | 3736.9 samples/s | 58.4 steps/s
[Step=19000 Epoch=92.7] | Loss=0.01008 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.444 | FP-Norm(final)=2.961 | 4328.8 samples/s | 67.6 steps/s
[Step=19050 Epoch=93.0] | Loss=0.00967 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.962 | 1627.9 samples/s | 25.4 steps/s
[Step=19100 Epoch=93.2] | Loss=0.00929 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=2.962 | 3769.2 samples/s | 58.9 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00899 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.446 | FP-Norm(final)=2.963 | 3732.1 samples/s | 58.3 steps/s
[Step=19200 Epoch=93.7] | Loss=0.00866 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.447 | FP-Norm(final)=2.964 | 4173.2 samples/s | 65.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step19200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=14401 Epoch=70.2] | Loss=0.12576 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.958 | 3604.0 samples/s | 56.3 steps/s
[Step=14450 Epoch=70.5] | Loss=0.03273 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=2.957 | 3564.8 samples/s | 55.7 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02318 | Reg=0.00018 | acc=0.9688 | FP-Norm=0.411 | FP-Norm(final)=2.957 | 3715.7 samples/s | 58.1 steps/s
[Step=14550 Epoch=71.0] | Loss=0.01884 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.957 | 3756.2 samples/s | 58.7 steps/s
[Step=14600 Epoch=71.2] | Loss=0.01642 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.957 | 4798.1 samples/s | 75.0 steps/s
[Step=14650 Epoch=71.4] | Loss=0.01415 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=2.958 | 1589.3 samples/s | 24.8 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01245 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.959 | 3720.7 samples/s | 58.1 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01138 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=2.960 | 3774.4 samples/s | 59.0 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01069 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=2.961 | 4513.4 samples/s | 70.5 steps/s
[Step=14850 Epoch=72.4] | Loss=0.00994 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=2.962 | 1618.9 samples/s | 25.3 steps/s
[Step=14900 Epoch=72.7] | Loss=0.00933 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.963 | 3743.1 samples/s | 58.5 steps/s
[Step=14950 Epoch=72.9] | Loss=0.00882 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.442 | FP-Norm(final)=2.964 | 3753.4 samples/s | 58.6 steps/s
[Step=15000 Epoch=73.1] | Loss=0.00839 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=2.965 | 4240.4 samples/s | 66.3 steps/s
[Step=15050 Epoch=73.4] | Loss=0.00805 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.443 | FP-Norm(final)=2.966 | 1660.1 samples/s | 25.9 steps/s
[Step=15100 Epoch=73.6] | Loss=0.00773 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.443 | FP-Norm(final)=2.967 | 3762.8 samples/s | 58.8 steps/s
[Step=15150 Epoch=73.9] | Loss=0.00739 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.444 | FP-Norm(final)=2.968 | 3762.2 samples/s | 58.8 steps/s
[Step=15200 Epoch=74.1] | Loss=0.00714 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.969 | 4037.7 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step15200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=12801 Epoch=62.8] | Loss=0.15809 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.958 | 3679.7 samples/s | 57.5 steps/s
[Step=12850 Epoch=63.0] | Loss=0.03628 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=2.955 | 3482.6 samples/s | 54.4 steps/s
[Step=12900 Epoch=63.3] | Loss=0.02435 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=2.955 | 3757.3 samples/s | 58.7 steps/s
[Step=12950 Epoch=63.5] | Loss=0.01936 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.955 | 3747.1 samples/s | 58.5 steps/s
[Step=13000 Epoch=63.7] | Loss=0.01690 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.956 | 4876.5 samples/s | 76.2 steps/s
[Step=13050 Epoch=64.0] | Loss=0.01466 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=2.956 | 1571.6 samples/s | 24.6 steps/s
[Step=13100 Epoch=64.2] | Loss=0.01320 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.957 | 3738.8 samples/s | 58.4 steps/s
[Step=13150 Epoch=64.5] | Loss=0.01185 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.958 | 3733.5 samples/s | 58.3 steps/s
[Step=13200 Epoch=64.7] | Loss=0.01089 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.959 | 4668.3 samples/s | 72.9 steps/s
[Step=13250 Epoch=65.0] | Loss=0.01014 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.960 | 1594.1 samples/s | 24.9 steps/s
[Step=13300 Epoch=65.2] | Loss=0.00953 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.961 | 3772.2 samples/s | 58.9 steps/s
[Step=13350 Epoch=65.5] | Loss=0.00903 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.962 | 3777.9 samples/s | 59.0 steps/s
[Step=13400 Epoch=65.7] | Loss=0.00863 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.963 | 4486.7 samples/s | 70.1 steps/s
[Step=13450 Epoch=66.0] | Loss=0.00818 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.408 | FP-Norm(final)=2.964 | 1604.4 samples/s | 25.1 steps/s
[Step=13500 Epoch=66.2] | Loss=0.00775 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.965 | 3731.5 samples/s | 58.3 steps/s
[Step=13550 Epoch=66.4] | Loss=0.00752 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.966 | 3754.3 samples/s | 58.7 steps/s
[Step=13600 Epoch=66.7] | Loss=0.00729 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.967 | 4295.2 samples/s | 67.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step13600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=168.1] | Loss=0.17462 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.957 | 3542.9 samples/s | 55.4 steps/s
[Step=17650 Epoch=168.5] | Loss=0.00952 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=2.958 | 3345.4 samples/s | 52.3 steps/s
[Step=17700 Epoch=169.0] | Loss=0.00502 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.959 | 4688.0 samples/s | 73.2 steps/s
[Step=17750 Epoch=169.5] | Loss=0.00340 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.959 | 1522.0 samples/s | 23.8 steps/s
[Step=17800 Epoch=170.0] | Loss=0.00259 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.960 | 4377.7 samples/s | 68.4 steps/s
[Step=17850 Epoch=170.5] | Loss=0.00209 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.960 | 1562.0 samples/s | 24.4 steps/s
[Step=17900 Epoch=170.9] | Loss=0.00177 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=2.961 | 4196.9 samples/s | 65.6 steps/s
[Step=17950 Epoch=171.4] | Loss=0.00153 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=2.961 | 1588.5 samples/s | 24.8 steps/s
[Step=18000 Epoch=171.9] | Loss=0.00135 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=2.961 | 3995.1 samples/s | 62.4 steps/s
[Step=18050 Epoch=172.4] | Loss=0.00121 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.962 | 1611.6 samples/s | 25.2 steps/s
[Step=18100 Epoch=172.8] | Loss=0.00109 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.962 | 3773.4 samples/s | 59.0 steps/s
[Step=18150 Epoch=173.3] | Loss=0.00100 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=2.962 | 1641.7 samples/s | 25.7 steps/s
[Step=18200 Epoch=173.8] | Loss=0.00092 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=2.962 | 3663.3 samples/s | 57.2 steps/s
[Step=18250 Epoch=174.3] | Loss=0.00086 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=2.963 | 1678.2 samples/s | 26.2 steps/s
[Step=18300 Epoch=174.8] | Loss=0.00080 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=2.963 | 3588.4 samples/s | 56.1 steps/s
[Step=18350 Epoch=175.2] | Loss=0.00075 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=2.963 | 1700.1 samples/s | 26.6 steps/s
[Step=18400 Epoch=175.7] | Loss=0.00071 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=2.963 | 3614.0 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step18400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=12801 Epoch=122.0] | Loss=0.03580 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.958 | 3571.5 samples/s | 55.8 steps/s
[Step=12850 Epoch=122.5] | Loss=0.00557 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.960 | 3318.7 samples/s | 51.9 steps/s
[Step=12900 Epoch=122.9] | Loss=0.00299 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.961 | 4672.6 samples/s | 73.0 steps/s
[Step=12950 Epoch=123.4] | Loss=0.00204 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.962 | 1537.4 samples/s | 24.0 steps/s
[Step=13000 Epoch=123.9] | Loss=0.00156 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.962 | 4376.3 samples/s | 68.4 steps/s
[Step=13050 Epoch=124.4] | Loss=0.00126 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.963 | 1571.2 samples/s | 24.6 steps/s
[Step=13100 Epoch=124.9] | Loss=0.00107 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.963 | 4151.0 samples/s | 64.9 steps/s
[Step=13150 Epoch=125.3] | Loss=0.00093 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=2.964 | 1583.3 samples/s | 24.7 steps/s
[Step=13200 Epoch=125.8] | Loss=0.00082 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=2.964 | 3956.5 samples/s | 61.8 steps/s
[Step=13250 Epoch=126.3] | Loss=0.00074 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=2.964 | 1614.6 samples/s | 25.2 steps/s
[Step=13300 Epoch=126.8] | Loss=0.00067 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=2.964 | 3819.6 samples/s | 59.7 steps/s
[Step=13350 Epoch=127.2] | Loss=0.00061 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.965 | 1649.8 samples/s | 25.8 steps/s
[Step=13400 Epoch=127.7] | Loss=0.00057 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=2.965 | 3640.6 samples/s | 56.9 steps/s
[Step=13450 Epoch=128.2] | Loss=0.00053 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=2.965 | 1681.5 samples/s | 26.3 steps/s
[Step=13500 Epoch=128.7] | Loss=0.00049 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=2.965 | 3580.8 samples/s | 56.0 steps/s
[Step=13550 Epoch=129.1] | Loss=0.00046 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.966 | 1698.0 samples/s | 26.5 steps/s
[Step=13600 Epoch=129.6] | Loss=0.00044 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=2.966 | 3641.7 samples/s | 56.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29709 | acc=0.8306 | tpr=0.7595 | fpr=0.0149 | 3621.8 samples/s | 14.1 steps/s
Avg test loss: 0.30531, Avg test acc: 0.82923, Avg tpr: 0.75864, Avg fpr: 0.01551, total FA: 121

Testing server on iccad2012
[Step=  50] | Loss=0.50094 | acc=0.8411 | tpr=0.9469 | fpr=0.1608 | 3600.6 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.50302 | acc=0.8404 | tpr=0.9552 | fpr=0.1617 | 6949.6 samples/s | 27.1 steps/s
[Step= 150] | Loss=0.50967 | acc=0.8405 | tpr=0.9669 | fpr=0.1618 | 6860.3 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.51007 | acc=0.8412 | tpr=0.9694 | fpr=0.1611 | 6760.1 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.50899 | acc=0.8408 | tpr=0.9703 | fpr=0.1616 | 6786.7 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.51051 | acc=0.8402 | tpr=0.9695 | fpr=0.1622 | 6961.0 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.51348 | acc=0.8404 | tpr=0.9693 | fpr=0.1619 | 6654.4 samples/s | 26.0 steps/s
[Step= 400] | Loss=0.51393 | acc=0.8403 | tpr=0.9710 | fpr=0.1621 | 6771.4 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.51953 | acc=0.8398 | tpr=0.9718 | fpr=0.1626 | 6908.0 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.52035 | acc=0.8391 | tpr=0.9727 | fpr=0.1633 | 6750.0 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.51706 | acc=0.8396 | tpr=0.9721 | fpr=0.1628 | 12205.7 samples/s | 47.7 steps/s
Avg test loss: 0.51715, Avg test acc: 0.83951, Avg tpr: 0.97187, Avg fpr: 0.16290, total FA: 22618

server round 43/50

clients selected: [0 5 6 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=74.1] | Loss=0.41789 | Reg=0.00000 | acc=0.7656 | FP-Norm=0.000 | FP-Norm(final)=2.971 | 3779.1 samples/s | 59.0 steps/s
[Step=15250 Epoch=74.4] | Loss=0.03699 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.365 | FP-Norm(final)=2.970 | 3599.7 samples/s | 56.2 steps/s
[Step=15300 Epoch=74.6] | Loss=0.02516 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.969 | 3775.5 samples/s | 59.0 steps/s
[Step=15350 Epoch=74.8] | Loss=0.02017 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.399 | FP-Norm(final)=2.969 | 3732.4 samples/s | 58.3 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01740 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.970 | 4820.9 samples/s | 75.3 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01537 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.970 | 1591.3 samples/s | 24.9 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01372 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.971 | 3785.1 samples/s | 59.1 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01244 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.972 | 3769.9 samples/s | 58.9 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01184 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.973 | 4522.9 samples/s | 70.7 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01092 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.413 | FP-Norm(final)=2.973 | 1622.7 samples/s | 25.4 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01032 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.414 | FP-Norm(final)=2.974 | 3723.6 samples/s | 58.2 steps/s
[Step=15750 Epoch=76.8] | Loss=0.00979 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.975 | 3772.8 samples/s | 59.0 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00936 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=2.976 | 4227.4 samples/s | 66.1 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00890 | Reg=0.00018 | acc=0.9844 | FP-Norm=0.417 | FP-Norm(final)=2.977 | 1673.6 samples/s | 26.2 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00851 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.978 | 3778.2 samples/s | 59.0 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00827 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=2.979 | 3745.4 samples/s | 58.5 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00799 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=2.980 | 4050.2 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=24001 Epoch=227.4] | Loss=0.04415 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.971 | 3462.3 samples/s | 54.1 steps/s
[Step=24050 Epoch=227.9] | Loss=0.00648 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.972 | 3422.3 samples/s | 53.5 steps/s
[Step=24100 Epoch=228.4] | Loss=0.00331 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=2.973 | 4655.6 samples/s | 72.7 steps/s
[Step=24150 Epoch=228.8] | Loss=0.00223 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.974 | 1540.5 samples/s | 24.1 steps/s
[Step=24200 Epoch=229.3] | Loss=0.00170 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=2.974 | 4377.9 samples/s | 68.4 steps/s
[Step=24250 Epoch=229.8] | Loss=0.00138 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=2.974 | 1588.1 samples/s | 24.8 steps/s
[Step=24300 Epoch=230.3] | Loss=0.00116 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.975 | 4076.0 samples/s | 63.7 steps/s
[Step=24350 Epoch=230.7] | Loss=0.00100 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.975 | 1607.1 samples/s | 25.1 steps/s
[Step=24400 Epoch=231.2] | Loss=0.00088 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.975 | 3845.8 samples/s | 60.1 steps/s
[Step=24450 Epoch=231.7] | Loss=0.00079 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=2.975 | 1661.4 samples/s | 26.0 steps/s
[Step=24500 Epoch=232.2] | Loss=0.00072 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.976 | 3630.3 samples/s | 56.7 steps/s
[Step=24550 Epoch=232.6] | Loss=0.00066 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.976 | 1689.5 samples/s | 26.4 steps/s
[Step=24600 Epoch=233.1] | Loss=0.00061 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.976 | 3585.3 samples/s | 56.0 steps/s
[Step=24650 Epoch=233.6] | Loss=0.00056 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.976 | 1704.5 samples/s | 26.6 steps/s
[Step=24700 Epoch=234.1] | Loss=0.00053 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.977 | 3617.4 samples/s | 56.5 steps/s
[Step=24750 Epoch=234.5] | Loss=0.00049 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=2.977 | 1703.7 samples/s | 26.6 steps/s
[Step=24800 Epoch=235.0] | Loss=0.00047 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=2.977 | 3535.4 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step24800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=14401 Epoch=137.0] | Loss=0.03260 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.971 | 3603.3 samples/s | 56.3 steps/s
[Step=14450 Epoch=137.5] | Loss=0.00783 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.972 | 3319.6 samples/s | 51.9 steps/s
[Step=14500 Epoch=137.9] | Loss=0.00403 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.973 | 4664.8 samples/s | 72.9 steps/s
[Step=14550 Epoch=138.4] | Loss=0.00275 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.448 | FP-Norm(final)=2.974 | 1544.2 samples/s | 24.1 steps/s
[Step=14600 Epoch=138.9] | Loss=0.00209 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.444 | FP-Norm(final)=2.974 | 4354.1 samples/s | 68.0 steps/s
[Step=14650 Epoch=139.4] | Loss=0.00169 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=2.974 | 1563.5 samples/s | 24.4 steps/s
[Step=14700 Epoch=139.8] | Loss=0.00142 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=2.975 | 4058.3 samples/s | 63.4 steps/s
[Step=14750 Epoch=140.3] | Loss=0.00123 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=2.975 | 1598.4 samples/s | 25.0 steps/s
[Step=14800 Epoch=140.8] | Loss=0.00108 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.975 | 3862.5 samples/s | 60.4 steps/s
[Step=14850 Epoch=141.3] | Loss=0.00097 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.975 | 1646.3 samples/s | 25.7 steps/s
[Step=14900 Epoch=141.7] | Loss=0.00088 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=2.976 | 3646.1 samples/s | 57.0 steps/s
[Step=14950 Epoch=142.2] | Loss=0.00080 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.976 | 1680.9 samples/s | 26.3 steps/s
[Step=15000 Epoch=142.7] | Loss=0.00074 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.976 | 3578.4 samples/s | 55.9 steps/s
[Step=15050 Epoch=143.2] | Loss=0.00069 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.976 | 1702.0 samples/s | 26.6 steps/s
[Step=15100 Epoch=143.6] | Loss=0.00064 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.976 | 3624.9 samples/s | 56.6 steps/s
[Step=15150 Epoch=144.1] | Loss=0.00060 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.977 | 1710.7 samples/s | 26.7 steps/s
[Step=15200 Epoch=144.6] | Loss=0.00057 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=2.977 | 3555.3 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step15200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=175.7] | Loss=0.04269 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.971 | 3595.0 samples/s | 56.2 steps/s
[Step=18450 Epoch=176.2] | Loss=0.00916 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=2.972 | 3278.6 samples/s | 51.2 steps/s
[Step=18500 Epoch=176.7] | Loss=0.00482 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=2.973 | 4685.7 samples/s | 73.2 steps/s
[Step=18550 Epoch=177.1] | Loss=0.00326 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.466 | FP-Norm(final)=2.973 | 1527.9 samples/s | 23.9 steps/s
[Step=18600 Epoch=177.6] | Loss=0.00249 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.974 | 4413.4 samples/s | 69.0 steps/s
[Step=18650 Epoch=178.1] | Loss=0.00201 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=2.974 | 1567.4 samples/s | 24.5 steps/s
[Step=18700 Epoch=178.6] | Loss=0.00169 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=2.974 | 4211.8 samples/s | 65.8 steps/s
[Step=18750 Epoch=179.1] | Loss=0.00146 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.449 | FP-Norm(final)=2.975 | 1571.5 samples/s | 24.6 steps/s
[Step=18800 Epoch=179.5] | Loss=0.00129 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.975 | 3986.3 samples/s | 62.3 steps/s
[Step=18850 Epoch=180.0] | Loss=0.00115 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=2.975 | 1610.3 samples/s | 25.2 steps/s
[Step=18900 Epoch=180.5] | Loss=0.00105 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.436 | FP-Norm(final)=2.976 | 3796.1 samples/s | 59.3 steps/s
[Step=18950 Epoch=181.0] | Loss=0.00096 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=2.976 | 1637.3 samples/s | 25.6 steps/s
[Step=19000 Epoch=181.4] | Loss=0.00088 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=2.976 | 3645.0 samples/s | 57.0 steps/s
[Step=19050 Epoch=181.9] | Loss=0.00082 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.976 | 1681.9 samples/s | 26.3 steps/s
[Step=19100 Epoch=182.4] | Loss=0.00077 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=2.976 | 3629.3 samples/s | 56.7 steps/s
[Step=19150 Epoch=182.9] | Loss=0.00072 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=2.977 | 1700.3 samples/s | 26.6 steps/s
[Step=19200 Epoch=183.3] | Loss=0.00068 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.977 | 3608.8 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step19200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=13601 Epoch=129.6] | Loss=0.09994 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.971 | 3530.7 samples/s | 55.2 steps/s
[Step=13650 Epoch=130.1] | Loss=0.00775 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=2.972 | 3352.7 samples/s | 52.4 steps/s
[Step=13700 Epoch=130.6] | Loss=0.00406 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=2.972 | 4705.9 samples/s | 73.5 steps/s
[Step=13750 Epoch=131.0] | Loss=0.00275 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.973 | 1523.8 samples/s | 23.8 steps/s
[Step=13800 Epoch=131.5] | Loss=0.00209 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=2.973 | 4387.4 samples/s | 68.6 steps/s
[Step=13850 Epoch=132.0] | Loss=0.00169 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=2.974 | 1559.6 samples/s | 24.4 steps/s
[Step=13900 Epoch=132.5] | Loss=0.00142 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=2.974 | 4187.7 samples/s | 65.4 steps/s
[Step=13950 Epoch=133.0] | Loss=0.00123 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.974 | 1592.5 samples/s | 24.9 steps/s
[Step=14000 Epoch=133.4] | Loss=0.00108 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.974 | 3991.3 samples/s | 62.4 steps/s
[Step=14050 Epoch=133.9] | Loss=0.00097 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.975 | 1612.8 samples/s | 25.2 steps/s
[Step=14100 Epoch=134.4] | Loss=0.00088 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.975 | 3794.5 samples/s | 59.3 steps/s
[Step=14150 Epoch=134.9] | Loss=0.00080 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=2.975 | 1657.6 samples/s | 25.9 steps/s
[Step=14200 Epoch=135.3] | Loss=0.00074 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.975 | 3637.9 samples/s | 56.8 steps/s
[Step=14250 Epoch=135.8] | Loss=0.00069 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.976 | 1687.2 samples/s | 26.4 steps/s
[Step=14300 Epoch=136.3] | Loss=0.00064 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=2.976 | 3585.4 samples/s | 56.0 steps/s
[Step=14350 Epoch=136.8] | Loss=0.00060 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=2.976 | 1695.0 samples/s | 26.5 steps/s
[Step=14400 Epoch=137.2] | Loss=0.00057 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=2.976 | 3576.0 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28587 | acc=0.8378 | tpr=0.7700 | fpr=0.0149 | 3592.4 samples/s | 14.0 steps/s
Avg test loss: 0.29403, Avg test acc: 0.83628, Avg tpr: 0.76890, Avg fpr: 0.01551, total FA: 121

Testing server on iccad2012
[Step=  50] | Loss=0.51912 | acc=0.8362 | tpr=0.9425 | fpr=0.1657 | 3595.4 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.52144 | acc=0.8352 | tpr=0.9552 | fpr=0.1670 | 6758.6 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.52840 | acc=0.8349 | tpr=0.9669 | fpr=0.1675 | 6817.8 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.52877 | acc=0.8358 | tpr=0.9683 | fpr=0.1666 | 6900.0 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.52764 | acc=0.8353 | tpr=0.9686 | fpr=0.1672 | 6800.3 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.52918 | acc=0.8346 | tpr=0.9680 | fpr=0.1678 | 6856.4 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.53221 | acc=0.8348 | tpr=0.9681 | fpr=0.1677 | 6839.6 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.53279 | acc=0.8347 | tpr=0.9699 | fpr=0.1678 | 6859.2 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.53852 | acc=0.8343 | tpr=0.9708 | fpr=0.1682 | 6568.8 samples/s | 25.7 steps/s
[Step= 500] | Loss=0.53947 | acc=0.8336 | tpr=0.9718 | fpr=0.1689 | 6784.1 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.53604 | acc=0.8340 | tpr=0.9710 | fpr=0.1685 | 12490.7 samples/s | 48.8 steps/s
Avg test loss: 0.53616, Avg test acc: 0.83390, Avg tpr: 0.97068, Avg fpr: 0.16859, total FA: 23408

server round 44/50

clients selected: [0 1 2 5 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=78.0] | Loss=0.18905 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.979 | 3751.4 samples/s | 58.6 steps/s
[Step=16050 Epoch=78.3] | Loss=0.03684 | Reg=0.00013 | acc=0.9531 | FP-Norm=0.346 | FP-Norm(final)=2.978 | 3441.2 samples/s | 53.8 steps/s
[Step=16100 Epoch=78.5] | Loss=0.02552 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=2.977 | 3756.9 samples/s | 58.7 steps/s
[Step=16150 Epoch=78.8] | Loss=0.02076 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.388 | FP-Norm(final)=2.977 | 3760.5 samples/s | 58.8 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01785 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=2.978 | 4802.4 samples/s | 75.0 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01564 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.978 | 1595.8 samples/s | 24.9 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01399 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.979 | 3770.2 samples/s | 58.9 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01286 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.980 | 3752.6 samples/s | 58.6 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01204 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.980 | 4510.3 samples/s | 70.5 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01115 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.981 | 1619.1 samples/s | 25.3 steps/s
[Step=16500 Epoch=80.5] | Loss=0.01058 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.982 | 3759.4 samples/s | 58.7 steps/s
[Step=16550 Epoch=80.7] | Loss=0.00997 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.983 | 3772.8 samples/s | 58.9 steps/s
[Step=16600 Epoch=80.9] | Loss=0.00952 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.984 | 4240.6 samples/s | 66.3 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00907 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.984 | 1658.9 samples/s | 25.9 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00867 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.985 | 3747.0 samples/s | 58.5 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00828 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.986 | 3745.5 samples/s | 58.5 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00806 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.987 | 4051.7 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step16800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=93.7] | Loss=0.15115 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.980 | 3873.6 samples/s | 60.5 steps/s
[Step=19250 Epoch=93.9] | Loss=0.03103 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.329 | FP-Norm(final)=2.979 | 3323.7 samples/s | 51.9 steps/s
[Step=19300 Epoch=94.2] | Loss=0.02223 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=2.979 | 3741.3 samples/s | 58.5 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01892 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.379 | FP-Norm(final)=2.979 | 3747.3 samples/s | 58.6 steps/s
[Step=19400 Epoch=94.7] | Loss=0.01647 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.979 | 4808.8 samples/s | 75.1 steps/s
[Step=19450 Epoch=94.9] | Loss=0.01432 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.394 | FP-Norm(final)=2.980 | 1575.5 samples/s | 24.6 steps/s
[Step=19500 Epoch=95.2] | Loss=0.01294 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.980 | 3752.6 samples/s | 58.6 steps/s
[Step=19550 Epoch=95.4] | Loss=0.01189 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.401 | FP-Norm(final)=2.981 | 3748.3 samples/s | 58.6 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01108 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.982 | 4563.1 samples/s | 71.3 steps/s
[Step=19650 Epoch=95.9] | Loss=0.01027 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.405 | FP-Norm(final)=2.983 | 1586.7 samples/s | 24.8 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00962 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.984 | 3759.8 samples/s | 58.7 steps/s
[Step=19750 Epoch=96.4] | Loss=0.00903 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.985 | 3789.7 samples/s | 59.2 steps/s
[Step=19800 Epoch=96.6] | Loss=0.00867 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.986 | 4334.5 samples/s | 67.7 steps/s
[Step=19850 Epoch=96.9] | Loss=0.00834 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.987 | 1640.8 samples/s | 25.6 steps/s
[Step=19900 Epoch=97.1] | Loss=0.00798 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.988 | 3723.8 samples/s | 58.2 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00764 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=2.988 | 3729.6 samples/s | 58.3 steps/s
[Step=20000 Epoch=97.6] | Loss=0.00748 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=2.989 | 4175.6 samples/s | 65.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step20000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=97.5] | Loss=0.16407 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.979 | 3491.3 samples/s | 54.6 steps/s
[Step=20050 Epoch=97.7] | Loss=0.03389 | Reg=0.00014 | acc=0.9688 | FP-Norm=0.354 | FP-Norm(final)=2.978 | 3577.0 samples/s | 55.9 steps/s
[Step=20100 Epoch=97.9] | Loss=0.02236 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=2.977 | 3740.4 samples/s | 58.4 steps/s
[Step=20150 Epoch=98.2] | Loss=0.01827 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.390 | FP-Norm(final)=2.978 | 3729.2 samples/s | 58.3 steps/s
[Step=20200 Epoch=98.4] | Loss=0.01605 | Reg=0.00016 | acc=0.9688 | FP-Norm=0.394 | FP-Norm(final)=2.978 | 4780.8 samples/s | 74.7 steps/s
[Step=20250 Epoch=98.7] | Loss=0.01414 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.979 | 1587.7 samples/s | 24.8 steps/s
[Step=20300 Epoch=98.9] | Loss=0.01269 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.980 | 3767.9 samples/s | 58.9 steps/s
[Step=20350 Epoch=99.2] | Loss=0.01152 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.981 | 3753.2 samples/s | 58.6 steps/s
[Step=20400 Epoch=99.4] | Loss=0.01073 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.982 | 4505.9 samples/s | 70.4 steps/s
[Step=20450 Epoch=99.6] | Loss=0.01001 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.983 | 1619.2 samples/s | 25.3 steps/s
[Step=20500 Epoch=99.9] | Loss=0.00936 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.984 | 3736.3 samples/s | 58.4 steps/s
[Step=20550 Epoch=100.1] | Loss=0.00888 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.985 | 3757.8 samples/s | 58.7 steps/s
[Step=20600 Epoch=100.4] | Loss=0.00844 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.986 | 4237.3 samples/s | 66.2 steps/s
[Step=20650 Epoch=100.6] | Loss=0.00805 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.987 | 1638.7 samples/s | 25.6 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00774 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.407 | FP-Norm(final)=2.988 | 3786.8 samples/s | 59.2 steps/s
[Step=20750 Epoch=101.1] | Loss=0.00741 | Reg=0.00017 | acc=0.9688 | FP-Norm=0.408 | FP-Norm(final)=2.989 | 3773.5 samples/s | 59.0 steps/s
[Step=20800 Epoch=101.3] | Loss=0.00713 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.990 | 4034.9 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step20800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=24801 Epoch=235.0] | Loss=0.01838 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.980 | 3472.6 samples/s | 54.3 steps/s
[Step=24850 Epoch=235.5] | Loss=0.00909 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=2.980 | 3425.1 samples/s | 53.5 steps/s
[Step=24900 Epoch=235.9] | Loss=0.00462 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=2.981 | 4610.3 samples/s | 72.0 steps/s
[Step=24950 Epoch=236.4] | Loss=0.00312 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.455 | FP-Norm(final)=2.981 | 1543.8 samples/s | 24.1 steps/s
[Step=25000 Epoch=236.9] | Loss=0.00236 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.981 | 4330.2 samples/s | 67.7 steps/s
[Step=25050 Epoch=237.4] | Loss=0.00190 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.447 | FP-Norm(final)=2.982 | 1579.3 samples/s | 24.7 steps/s
[Step=25100 Epoch=237.8] | Loss=0.00160 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.982 | 4075.9 samples/s | 63.7 steps/s
[Step=25150 Epoch=238.3] | Loss=0.00138 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.436 | FP-Norm(final)=2.982 | 1601.3 samples/s | 25.0 steps/s
[Step=25200 Epoch=238.8] | Loss=0.00121 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.431 | FP-Norm(final)=2.982 | 3864.1 samples/s | 60.4 steps/s
[Step=25250 Epoch=239.3] | Loss=0.00108 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.983 | 1642.7 samples/s | 25.7 steps/s
[Step=25300 Epoch=239.7] | Loss=0.00098 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.983 | 3642.9 samples/s | 56.9 steps/s
[Step=25350 Epoch=240.2] | Loss=0.00090 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=2.983 | 1677.7 samples/s | 26.2 steps/s
[Step=25400 Epoch=240.7] | Loss=0.00083 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.983 | 3574.5 samples/s | 55.9 steps/s
[Step=25450 Epoch=241.2] | Loss=0.00077 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.983 | 1692.6 samples/s | 26.4 steps/s
[Step=25500 Epoch=241.6] | Loss=0.00071 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.984 | 3630.4 samples/s | 56.7 steps/s
[Step=25550 Epoch=242.1] | Loss=0.00067 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.984 | 1676.8 samples/s | 26.2 steps/s
[Step=25600 Epoch=242.6] | Loss=0.00063 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.984 | 3534.5 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step25600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=14401 Epoch=137.3] | Loss=0.05361 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.980 | 3451.4 samples/s | 53.9 steps/s
[Step=14450 Epoch=137.7] | Loss=0.00694 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.436 | FP-Norm(final)=2.981 | 3462.6 samples/s | 54.1 steps/s
[Step=14500 Epoch=138.2] | Loss=0.00365 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.982 | 4712.7 samples/s | 73.6 steps/s
[Step=14550 Epoch=138.7] | Loss=0.00247 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.468 | FP-Norm(final)=2.983 | 1530.6 samples/s | 23.9 steps/s
[Step=14600 Epoch=139.2] | Loss=0.00188 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=2.983 | 4407.3 samples/s | 68.9 steps/s
[Step=14650 Epoch=139.6] | Loss=0.00152 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.460 | FP-Norm(final)=2.983 | 1559.5 samples/s | 24.4 steps/s
[Step=14700 Epoch=140.1] | Loss=0.00128 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=2.984 | 4158.7 samples/s | 65.0 steps/s
[Step=14750 Epoch=140.6] | Loss=0.00111 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.449 | FP-Norm(final)=2.984 | 1595.3 samples/s | 24.9 steps/s
[Step=14800 Epoch=141.1] | Loss=0.00098 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.443 | FP-Norm(final)=2.984 | 4003.1 samples/s | 62.5 steps/s
[Step=14850 Epoch=141.5] | Loss=0.00087 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=2.984 | 1622.1 samples/s | 25.3 steps/s
[Step=14900 Epoch=142.0] | Loss=0.00079 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.434 | FP-Norm(final)=2.985 | 3789.1 samples/s | 59.2 steps/s
[Step=14950 Epoch=142.5] | Loss=0.00073 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.985 | 1655.4 samples/s | 25.9 steps/s
[Step=15000 Epoch=143.0] | Loss=0.00067 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.985 | 3646.3 samples/s | 57.0 steps/s
[Step=15050 Epoch=143.4] | Loss=0.00062 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=2.985 | 1693.1 samples/s | 26.5 steps/s
[Step=15100 Epoch=143.9] | Loss=0.00058 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.985 | 3612.6 samples/s | 56.4 steps/s
[Step=15150 Epoch=144.4] | Loss=0.00054 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=2.985 | 1675.2 samples/s | 26.2 steps/s
[Step=15200 Epoch=144.9] | Loss=0.00051 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.986 | 3629.1 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29237 | acc=0.8366 | tpr=0.7683 | fpr=0.0149 | 3630.9 samples/s | 14.2 steps/s
Avg test loss: 0.30089, Avg test acc: 0.83492, Avg tpr: 0.76692, Avg fpr: 0.01551, total FA: 121

Testing server on iccad2012
[Step=  50] | Loss=0.50789 | acc=0.8419 | tpr=0.9425 | fpr=0.1599 | 3581.0 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.51041 | acc=0.8406 | tpr=0.9552 | fpr=0.1616 | 6985.5 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.51750 | acc=0.8407 | tpr=0.9669 | fpr=0.1616 | 6671.0 samples/s | 26.1 steps/s
[Step= 200] | Loss=0.51807 | acc=0.8413 | tpr=0.9683 | fpr=0.1610 | 6872.6 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.51679 | acc=0.8407 | tpr=0.9686 | fpr=0.1616 | 7014.7 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.51829 | acc=0.8402 | tpr=0.9680 | fpr=0.1622 | 6822.7 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.52143 | acc=0.8405 | tpr=0.9681 | fpr=0.1618 | 6739.0 samples/s | 26.3 steps/s
[Step= 400] | Loss=0.52199 | acc=0.8404 | tpr=0.9699 | fpr=0.1619 | 6747.7 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.52778 | acc=0.8400 | tpr=0.9708 | fpr=0.1623 | 6572.8 samples/s | 25.7 steps/s
[Step= 500] | Loss=0.52865 | acc=0.8394 | tpr=0.9718 | fpr=0.1630 | 6809.9 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.52528 | acc=0.8399 | tpr=0.9710 | fpr=0.1625 | 12218.4 samples/s | 47.7 steps/s
Avg test loss: 0.52539, Avg test acc: 0.83975, Avg tpr: 0.97068, Avg fpr: 0.16263, total FA: 22581

server round 45/50

clients selected: [0 3 4 5 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=81.9] | Loss=0.10971 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.987 | 3547.8 samples/s | 55.4 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03973 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.372 | FP-Norm(final)=2.984 | 3613.2 samples/s | 56.5 steps/s
[Step=16900 Epoch=82.4] | Loss=0.02554 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=2.984 | 3752.3 samples/s | 58.6 steps/s
[Step=16950 Epoch=82.7] | Loss=0.02074 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.984 | 3773.2 samples/s | 59.0 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01792 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.984 | 4828.4 samples/s | 75.4 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01531 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.412 | FP-Norm(final)=2.985 | 1575.6 samples/s | 24.6 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01377 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=2.986 | 3730.8 samples/s | 58.3 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01273 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=2.986 | 3776.0 samples/s | 59.0 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01178 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.987 | 4522.1 samples/s | 70.7 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01085 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.988 | 1610.6 samples/s | 25.2 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01013 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.989 | 3747.5 samples/s | 58.6 steps/s
[Step=17350 Epoch=84.6] | Loss=0.00960 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.990 | 3770.9 samples/s | 58.9 steps/s
[Step=17400 Epoch=84.8] | Loss=0.00932 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.991 | 4253.9 samples/s | 66.5 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00893 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=2.992 | 1643.7 samples/s | 25.7 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00862 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.992 | 3732.1 samples/s | 58.3 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00835 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.993 | 3765.8 samples/s | 58.8 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00799 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=2.994 | 4013.6 samples/s | 62.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step17600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=74.1] | Loss=0.05656 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.987 | 3533.8 samples/s | 55.2 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02818 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=2.986 | 3676.3 samples/s | 57.4 steps/s
[Step=15300 Epoch=74.6] | Loss=0.02025 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.986 | 3734.5 samples/s | 58.4 steps/s
[Step=15350 Epoch=74.9] | Loss=0.01757 | Reg=0.00018 | acc=0.9844 | FP-Norm=0.410 | FP-Norm(final)=2.986 | 3743.4 samples/s | 58.5 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01551 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=2.986 | 4770.8 samples/s | 74.5 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01326 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=2.987 | 1584.4 samples/s | 24.8 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01197 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.988 | 3736.9 samples/s | 58.4 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01097 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=2.989 | 3750.1 samples/s | 58.6 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01013 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.989 | 4516.8 samples/s | 70.6 steps/s
[Step=15650 Epoch=76.3] | Loss=0.00943 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.990 | 1608.5 samples/s | 25.1 steps/s
[Step=15700 Epoch=76.6] | Loss=0.00880 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.991 | 3778.8 samples/s | 59.0 steps/s
[Step=15750 Epoch=76.8] | Loss=0.00835 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.992 | 3718.5 samples/s | 58.1 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00791 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.993 | 4274.5 samples/s | 66.8 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00769 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.994 | 1648.8 samples/s | 25.8 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00731 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.995 | 3733.0 samples/s | 58.3 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00703 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=2.996 | 3747.9 samples/s | 58.6 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00682 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=2.996 | 4034.2 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step16000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=13601 Epoch=66.7] | Loss=0.13509 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.987 | 3540.2 samples/s | 55.3 steps/s
[Step=13650 Epoch=66.9] | Loss=0.02745 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.320 | FP-Norm(final)=2.986 | 3633.6 samples/s | 56.8 steps/s
[Step=13700 Epoch=67.2] | Loss=0.01926 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=2.986 | 3756.4 samples/s | 58.7 steps/s
[Step=13750 Epoch=67.4] | Loss=0.01603 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=2.987 | 3760.3 samples/s | 58.8 steps/s
[Step=13800 Epoch=67.7] | Loss=0.01430 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=2.987 | 4844.5 samples/s | 75.7 steps/s
[Step=13850 Epoch=67.9] | Loss=0.01237 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=2.988 | 1571.8 samples/s | 24.6 steps/s
[Step=13900 Epoch=68.2] | Loss=0.01103 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.989 | 3765.4 samples/s | 58.8 steps/s
[Step=13950 Epoch=68.4] | Loss=0.01011 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=2.990 | 3749.9 samples/s | 58.6 steps/s
[Step=14000 Epoch=68.7] | Loss=0.00947 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.381 | FP-Norm(final)=2.991 | 4679.0 samples/s | 73.1 steps/s
[Step=14050 Epoch=68.9] | Loss=0.00879 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=2.992 | 1581.1 samples/s | 24.7 steps/s
[Step=14100 Epoch=69.1] | Loss=0.00828 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.385 | FP-Norm(final)=2.993 | 3738.3 samples/s | 58.4 steps/s
[Step=14150 Epoch=69.4] | Loss=0.00785 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=2.994 | 3730.9 samples/s | 58.3 steps/s
[Step=14200 Epoch=69.6] | Loss=0.00753 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=2.994 | 4486.5 samples/s | 70.1 steps/s
[Step=14250 Epoch=69.9] | Loss=0.00721 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=2.995 | 1626.5 samples/s | 25.4 steps/s
[Step=14300 Epoch=70.1] | Loss=0.00694 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=2.996 | 3732.9 samples/s | 58.3 steps/s
[Step=14350 Epoch=70.4] | Loss=0.00670 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=2.997 | 3757.9 samples/s | 58.7 steps/s
[Step=14400 Epoch=70.6] | Loss=0.00646 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=2.998 | 4280.9 samples/s | 66.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step14400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=25601 Epoch=242.6] | Loss=0.02529 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.987 | 3536.2 samples/s | 55.3 steps/s
[Step=25650 Epoch=243.1] | Loss=0.00806 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.987 | 3306.5 samples/s | 51.7 steps/s
[Step=25700 Epoch=243.5] | Loss=0.00415 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=2.987 | 4647.3 samples/s | 72.6 steps/s
[Step=25750 Epoch=244.0] | Loss=0.00280 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.443 | FP-Norm(final)=2.988 | 1535.4 samples/s | 24.0 steps/s
[Step=25800 Epoch=244.5] | Loss=0.00212 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=2.988 | 4270.8 samples/s | 66.7 steps/s
[Step=25850 Epoch=245.0] | Loss=0.00172 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=2.988 | 1573.7 samples/s | 24.6 steps/s
[Step=25900 Epoch=245.4] | Loss=0.00144 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=2.989 | 4067.9 samples/s | 63.6 steps/s
[Step=25950 Epoch=245.9] | Loss=0.00124 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=2.989 | 1612.5 samples/s | 25.2 steps/s
[Step=26000 Epoch=246.4] | Loss=0.00110 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=2.989 | 3859.2 samples/s | 60.3 steps/s
[Step=26050 Epoch=246.8] | Loss=0.00098 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=2.989 | 1633.7 samples/s | 25.5 steps/s
[Step=26100 Epoch=247.3] | Loss=0.00089 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.990 | 3656.0 samples/s | 57.1 steps/s
[Step=26150 Epoch=247.8] | Loss=0.00081 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.990 | 1672.9 samples/s | 26.1 steps/s
[Step=26200 Epoch=248.3] | Loss=0.00075 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.990 | 3593.3 samples/s | 56.1 steps/s
[Step=26250 Epoch=248.7] | Loss=0.00069 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=2.990 | 1690.9 samples/s | 26.4 steps/s
[Step=26300 Epoch=249.2] | Loss=0.00065 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.990 | 3611.1 samples/s | 56.4 steps/s
[Step=26350 Epoch=249.7] | Loss=0.00061 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=2.990 | 1714.4 samples/s | 26.8 steps/s
[Step=26400 Epoch=250.2] | Loss=0.00057 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=2.991 | 3586.8 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step26400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=183.4] | Loss=0.01717 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.987 | 3578.2 samples/s | 55.9 steps/s
[Step=19250 Epoch=183.8] | Loss=0.00841 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=2.988 | 3373.5 samples/s | 52.7 steps/s
[Step=19300 Epoch=184.3] | Loss=0.00437 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=2.989 | 4704.5 samples/s | 73.5 steps/s
[Step=19350 Epoch=184.8] | Loss=0.00296 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=2.989 | 1523.9 samples/s | 23.8 steps/s
[Step=19400 Epoch=185.3] | Loss=0.00225 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=2.989 | 4409.8 samples/s | 68.9 steps/s
[Step=19450 Epoch=185.7] | Loss=0.00182 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.990 | 1554.7 samples/s | 24.3 steps/s
[Step=19500 Epoch=186.2] | Loss=0.00153 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=2.990 | 4127.5 samples/s | 64.5 steps/s
[Step=19550 Epoch=186.7] | Loss=0.00133 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=2.990 | 1601.0 samples/s | 25.0 steps/s
[Step=19600 Epoch=187.2] | Loss=0.00117 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.991 | 3973.6 samples/s | 62.1 steps/s
[Step=19650 Epoch=187.6] | Loss=0.00105 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.991 | 1610.5 samples/s | 25.2 steps/s
[Step=19700 Epoch=188.1] | Loss=0.00095 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.991 | 3809.6 samples/s | 59.5 steps/s
[Step=19750 Epoch=188.6] | Loss=0.00087 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.991 | 1669.2 samples/s | 26.1 steps/s
[Step=19800 Epoch=189.1] | Loss=0.00080 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=2.991 | 3588.8 samples/s | 56.1 steps/s
[Step=19850 Epoch=189.6] | Loss=0.00074 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=2.992 | 1687.7 samples/s | 26.4 steps/s
[Step=19900 Epoch=190.0] | Loss=0.00070 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=2.992 | 3646.6 samples/s | 57.0 steps/s
[Step=19950 Epoch=190.5] | Loss=0.00065 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=2.992 | 1705.2 samples/s | 26.6 steps/s
[Step=20000 Epoch=191.0] | Loss=0.00061 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=2.992 | 3614.6 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29337 | acc=0.8380 | tpr=0.7704 | fpr=0.0151 | 3633.3 samples/s | 14.2 steps/s
Avg test loss: 0.30188, Avg test acc: 0.83580, Avg tpr: 0.76820, Avg fpr: 0.01551, total FA: 121

Testing server on iccad2012
[Step=  50] | Loss=0.51594 | acc=0.8405 | tpr=0.9469 | fpr=0.1614 | 3597.1 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.51817 | acc=0.8393 | tpr=0.9574 | fpr=0.1629 | 6920.2 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.52543 | acc=0.8395 | tpr=0.9683 | fpr=0.1629 | 6848.0 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.52591 | acc=0.8401 | tpr=0.9694 | fpr=0.1623 | 6730.0 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.52464 | acc=0.8397 | tpr=0.9703 | fpr=0.1626 | 6860.7 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.52619 | acc=0.8392 | tpr=0.9695 | fpr=0.1632 | 6890.3 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.52937 | acc=0.8395 | tpr=0.9693 | fpr=0.1628 | 6994.6 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.52997 | acc=0.8395 | tpr=0.9710 | fpr=0.1629 | 6600.3 samples/s | 25.8 steps/s
[Step= 450] | Loss=0.53585 | acc=0.8390 | tpr=0.9718 | fpr=0.1634 | 6871.9 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.53676 | acc=0.8384 | tpr=0.9727 | fpr=0.1641 | 6740.5 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.53328 | acc=0.8388 | tpr=0.9717 | fpr=0.1636 | 11958.3 samples/s | 46.7 steps/s
Avg test loss: 0.53337, Avg test acc: 0.83876, Avg tpr: 0.97147, Avg fpr: 0.16365, total FA: 22723

server round 46/50

clients selected: [0 2 3 4 5]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=85.8] | Loss=0.16596 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.995 | 3572.5 samples/s | 55.8 steps/s
[Step=17650 Epoch=86.1] | Loss=0.03784 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.365 | FP-Norm(final)=2.994 | 3569.7 samples/s | 55.8 steps/s
[Step=17700 Epoch=86.3] | Loss=0.02528 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.392 | FP-Norm(final)=2.993 | 3750.6 samples/s | 58.6 steps/s
[Step=17750 Epoch=86.6] | Loss=0.02033 | Reg=0.00016 | acc=0.9688 | FP-Norm=0.398 | FP-Norm(final)=2.993 | 3721.2 samples/s | 58.1 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01717 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.993 | 4798.8 samples/s | 75.0 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01490 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.994 | 1588.6 samples/s | 24.8 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01306 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.408 | FP-Norm(final)=2.995 | 3741.2 samples/s | 58.5 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01212 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=2.996 | 3716.7 samples/s | 58.1 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01135 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=2.996 | 4518.9 samples/s | 70.6 steps/s
[Step=18050 Epoch=88.0] | Loss=0.01064 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.997 | 1613.3 samples/s | 25.2 steps/s
[Step=18100 Epoch=88.3] | Loss=0.01003 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.998 | 3726.3 samples/s | 58.2 steps/s
[Step=18150 Epoch=88.5] | Loss=0.00955 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.412 | FP-Norm(final)=2.999 | 3721.0 samples/s | 58.1 steps/s
[Step=18200 Epoch=88.7] | Loss=0.00901 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=3.000 | 4237.1 samples/s | 66.2 steps/s
[Step=18250 Epoch=89.0] | Loss=0.00861 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=3.000 | 1659.7 samples/s | 25.9 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00826 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=3.001 | 3745.5 samples/s | 58.5 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00798 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=3.002 | 3745.3 samples/s | 58.5 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00776 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.413 | FP-Norm(final)=3.003 | 4021.4 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step18400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20801 Epoch=101.4] | Loss=0.21886 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.995 | 3547.2 samples/s | 55.4 steps/s
[Step=20850 Epoch=101.6] | Loss=0.03357 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=2.993 | 3605.4 samples/s | 56.3 steps/s
[Step=20900 Epoch=101.8] | Loss=0.02161 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=2.993 | 3756.7 samples/s | 58.7 steps/s
[Step=20950 Epoch=102.1] | Loss=0.01756 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=2.993 | 3772.2 samples/s | 58.9 steps/s
[Step=21000 Epoch=102.3] | Loss=0.01533 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.994 | 4809.4 samples/s | 75.1 steps/s
[Step=21050 Epoch=102.6] | Loss=0.01318 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.994 | 1581.7 samples/s | 24.7 steps/s
[Step=21100 Epoch=102.8] | Loss=0.01173 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.995 | 3719.0 samples/s | 58.1 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01067 | Reg=0.00017 | acc=0.9688 | FP-Norm=0.405 | FP-Norm(final)=2.996 | 3726.8 samples/s | 58.2 steps/s
[Step=21200 Epoch=103.3] | Loss=0.01009 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.997 | 4501.6 samples/s | 70.3 steps/s
[Step=21250 Epoch=103.5] | Loss=0.00938 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.998 | 1613.0 samples/s | 25.2 steps/s
[Step=21300 Epoch=103.8] | Loss=0.00887 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.999 | 3738.7 samples/s | 58.4 steps/s
[Step=21350 Epoch=104.0] | Loss=0.00840 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.406 | FP-Norm(final)=3.000 | 3748.9 samples/s | 58.6 steps/s
[Step=21400 Epoch=104.3] | Loss=0.00800 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.001 | 4273.4 samples/s | 66.8 steps/s
[Step=21450 Epoch=104.5] | Loss=0.00759 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.002 | 1661.2 samples/s | 26.0 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00730 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.003 | 3744.2 samples/s | 58.5 steps/s
[Step=21550 Epoch=105.0] | Loss=0.00702 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.004 | 3734.4 samples/s | 58.4 steps/s
[Step=21600 Epoch=105.2] | Loss=0.00681 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.004 | 4036.3 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step21600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=78.0] | Loss=0.32790 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.995 | 3712.9 samples/s | 58.0 steps/s
[Step=16050 Epoch=78.3] | Loss=0.02983 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.341 | FP-Norm(final)=2.994 | 3448.4 samples/s | 53.9 steps/s
[Step=16100 Epoch=78.5] | Loss=0.02015 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.365 | FP-Norm(final)=2.994 | 3735.0 samples/s | 58.4 steps/s
[Step=16150 Epoch=78.8] | Loss=0.01581 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=2.995 | 3725.4 samples/s | 58.2 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01476 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.382 | FP-Norm(final)=2.995 | 4803.8 samples/s | 75.1 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01283 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=2.996 | 1581.9 samples/s | 24.7 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01147 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.997 | 3754.1 samples/s | 58.7 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01030 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=2.998 | 3757.0 samples/s | 58.7 steps/s
[Step=16400 Epoch=80.0] | Loss=0.00977 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.400 | FP-Norm(final)=2.999 | 4522.9 samples/s | 70.7 steps/s
[Step=16450 Epoch=80.2] | Loss=0.00906 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.999 | 1624.8 samples/s | 25.4 steps/s
[Step=16500 Epoch=80.5] | Loss=0.00861 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=3.000 | 3768.5 samples/s | 58.9 steps/s
[Step=16550 Epoch=80.7] | Loss=0.00818 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=3.001 | 3736.9 samples/s | 58.4 steps/s
[Step=16600 Epoch=81.0] | Loss=0.00781 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=3.002 | 4264.4 samples/s | 66.6 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00744 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.003 | 1635.0 samples/s | 25.5 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00712 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.407 | FP-Norm(final)=3.004 | 3763.1 samples/s | 58.8 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00683 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.005 | 3744.2 samples/s | 58.5 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00664 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.005 | 4051.2 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step16800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=14401 Epoch=70.6] | Loss=0.24584 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.995 | 3629.4 samples/s | 56.7 steps/s
[Step=14450 Epoch=70.9] | Loss=0.04000 | Reg=0.00016 | acc=0.9688 | FP-Norm=0.374 | FP-Norm(final)=2.993 | 3550.7 samples/s | 55.5 steps/s
[Step=14500 Epoch=71.1] | Loss=0.02582 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.387 | FP-Norm(final)=2.993 | 3740.3 samples/s | 58.4 steps/s
[Step=14550 Epoch=71.4] | Loss=0.01971 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=2.993 | 3761.9 samples/s | 58.8 steps/s
[Step=14600 Epoch=71.6] | Loss=0.01713 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=2.994 | 4820.5 samples/s | 75.3 steps/s
[Step=14650 Epoch=71.8] | Loss=0.01452 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.994 | 1582.9 samples/s | 24.7 steps/s
[Step=14700 Epoch=72.1] | Loss=0.01292 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.995 | 3745.7 samples/s | 58.5 steps/s
[Step=14750 Epoch=72.3] | Loss=0.01167 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.996 | 3728.1 samples/s | 58.3 steps/s
[Step=14800 Epoch=72.6] | Loss=0.01084 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=2.996 | 4678.6 samples/s | 73.1 steps/s
[Step=14850 Epoch=72.8] | Loss=0.00998 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.997 | 1581.0 samples/s | 24.7 steps/s
[Step=14900 Epoch=73.1] | Loss=0.00930 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.998 | 3744.3 samples/s | 58.5 steps/s
[Step=14950 Epoch=73.3] | Loss=0.00880 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.999 | 3735.3 samples/s | 58.4 steps/s
[Step=15000 Epoch=73.6] | Loss=0.00849 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.000 | 4496.7 samples/s | 70.3 steps/s
[Step=15050 Epoch=73.8] | Loss=0.00805 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.001 | 1619.7 samples/s | 25.3 steps/s
[Step=15100 Epoch=74.0] | Loss=0.00763 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.001 | 3760.8 samples/s | 58.8 steps/s
[Step=15150 Epoch=74.3] | Loss=0.00741 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.002 | 3802.0 samples/s | 59.4 steps/s
[Step=15200 Epoch=74.5] | Loss=0.00713 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.003 | 4305.0 samples/s | 67.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step15200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=26401 Epoch=250.2] | Loss=0.12332 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.995 | 3477.4 samples/s | 54.3 steps/s
[Step=26450 Epoch=250.6] | Loss=0.00690 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.996 | 3377.5 samples/s | 52.8 steps/s
[Step=26500 Epoch=251.1] | Loss=0.00352 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.997 | 4638.5 samples/s | 72.5 steps/s
[Step=26550 Epoch=251.6] | Loss=0.00238 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=2.997 | 1532.8 samples/s | 24.0 steps/s
[Step=26600 Epoch=252.1] | Loss=0.00181 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=2.998 | 4334.5 samples/s | 67.7 steps/s
[Step=26650 Epoch=252.5] | Loss=0.00146 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=2.998 | 1591.9 samples/s | 24.9 steps/s
[Step=26700 Epoch=253.0] | Loss=0.00123 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=2.998 | 4031.4 samples/s | 63.0 steps/s
[Step=26750 Epoch=253.5] | Loss=0.00106 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=2.999 | 1593.1 samples/s | 24.9 steps/s
[Step=26800 Epoch=254.0] | Loss=0.00094 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=2.999 | 3877.1 samples/s | 60.6 steps/s
[Step=26850 Epoch=254.4] | Loss=0.00084 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=2.999 | 1636.4 samples/s | 25.6 steps/s
[Step=26900 Epoch=254.9] | Loss=0.00076 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=2.999 | 3601.5 samples/s | 56.3 steps/s
[Step=26950 Epoch=255.4] | Loss=0.00070 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=2.999 | 1668.5 samples/s | 26.1 steps/s
[Step=27000 Epoch=255.8] | Loss=0.00064 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=3.000 | 3555.6 samples/s | 55.6 steps/s
[Step=27050 Epoch=256.3] | Loss=0.00060 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.000 | 1685.7 samples/s | 26.3 steps/s
[Step=27100 Epoch=256.8] | Loss=0.00056 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.000 | 3592.7 samples/s | 56.1 steps/s
[Step=27150 Epoch=257.3] | Loss=0.00052 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.000 | 1701.2 samples/s | 26.6 steps/s
[Step=27200 Epoch=257.7] | Loss=0.00049 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.000 | 3578.6 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30136 | acc=0.8345 | tpr=0.7651 | fpr=0.0149 | 3618.2 samples/s | 14.1 steps/s
Avg test loss: 0.30986, Avg test acc: 0.83240, Avg tpr: 0.76325, Avg fpr: 0.01551, total FA: 121

Testing server on iccad2012
[Step=  50] | Loss=0.50595 | acc=0.8436 | tpr=0.9381 | fpr=0.1581 | 3583.0 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.50811 | acc=0.8432 | tpr=0.9531 | fpr=0.1589 | 6910.4 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.51515 | acc=0.8435 | tpr=0.9654 | fpr=0.1588 | 6857.3 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.51579 | acc=0.8438 | tpr=0.9672 | fpr=0.1584 | 7033.1 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.51438 | acc=0.8434 | tpr=0.9686 | fpr=0.1589 | 6822.7 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.51583 | acc=0.8430 | tpr=0.9680 | fpr=0.1593 | 6714.4 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.51903 | acc=0.8433 | tpr=0.9681 | fpr=0.1589 | 6770.1 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.51958 | acc=0.8434 | tpr=0.9699 | fpr=0.1589 | 6729.2 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.52545 | acc=0.8429 | tpr=0.9708 | fpr=0.1594 | 6698.9 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.52632 | acc=0.8422 | tpr=0.9718 | fpr=0.1601 | 6777.2 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.52289 | acc=0.8428 | tpr=0.9706 | fpr=0.1596 | 12463.3 samples/s | 48.7 steps/s
Avg test loss: 0.52299, Avg test acc: 0.84267, Avg tpr: 0.97029, Avg fpr: 0.15965, total FA: 22167

server round 47/50

clients selected: [3 4 5 7 8]

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=81.9] | Loss=0.15916 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.999 | 3676.2 samples/s | 57.4 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03082 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=2.999 | 3490.1 samples/s | 54.5 steps/s
[Step=16900 Epoch=82.4] | Loss=0.02061 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=2.999 | 3754.2 samples/s | 58.7 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01656 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=2.999 | 3794.4 samples/s | 59.3 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01454 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=2.999 | 4781.3 samples/s | 74.7 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01268 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.000 | 1587.0 samples/s | 24.8 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01141 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=3.001 | 3700.9 samples/s | 57.8 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01033 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=3.002 | 3732.5 samples/s | 58.3 steps/s
[Step=17200 Epoch=83.9] | Loss=0.00963 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.003 | 4514.9 samples/s | 70.5 steps/s
[Step=17250 Epoch=84.1] | Loss=0.00896 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=3.004 | 1615.4 samples/s | 25.2 steps/s
[Step=17300 Epoch=84.4] | Loss=0.00844 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=3.005 | 3746.8 samples/s | 58.5 steps/s
[Step=17350 Epoch=84.6] | Loss=0.00795 | Reg=0.00018 | acc=0.9844 | FP-Norm=0.417 | FP-Norm(final)=3.005 | 3721.0 samples/s | 58.1 steps/s
[Step=17400 Epoch=84.9] | Loss=0.00764 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.006 | 4251.7 samples/s | 66.4 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00727 | Reg=0.00018 | acc=0.9844 | FP-Norm=0.418 | FP-Norm(final)=3.007 | 1652.8 samples/s | 25.8 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00697 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=3.008 | 3766.4 samples/s | 58.9 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00678 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=3.009 | 3752.4 samples/s | 58.6 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00651 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=3.010 | 4009.4 samples/s | 62.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step17600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=74.5] | Loss=0.05026 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.999 | 3793.5 samples/s | 59.3 steps/s
[Step=15250 Epoch=74.8] | Loss=0.02454 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.302 | FP-Norm(final)=2.999 | 3418.8 samples/s | 53.4 steps/s
[Step=15300 Epoch=75.0] | Loss=0.01886 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.332 | FP-Norm(final)=2.999 | 3745.0 samples/s | 58.5 steps/s
[Step=15350 Epoch=75.3] | Loss=0.01590 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.344 | FP-Norm(final)=3.000 | 3781.5 samples/s | 59.1 steps/s
[Step=15400 Epoch=75.5] | Loss=0.01399 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.000 | 4863.8 samples/s | 76.0 steps/s
[Step=15450 Epoch=75.8] | Loss=0.01228 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.001 | 1584.5 samples/s | 24.8 steps/s
[Step=15500 Epoch=76.0] | Loss=0.01096 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.002 | 3746.8 samples/s | 58.5 steps/s
[Step=15550 Epoch=76.3] | Loss=0.01005 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.372 | FP-Norm(final)=3.003 | 3787.2 samples/s | 59.2 steps/s
[Step=15600 Epoch=76.5] | Loss=0.00938 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.004 | 4643.0 samples/s | 72.5 steps/s
[Step=15650 Epoch=76.7] | Loss=0.00859 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.005 | 1600.9 samples/s | 25.0 steps/s
[Step=15700 Epoch=77.0] | Loss=0.00806 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.006 | 3755.5 samples/s | 58.7 steps/s
[Step=15750 Epoch=77.2] | Loss=0.00777 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.007 | 3750.3 samples/s | 58.6 steps/s
[Step=15800 Epoch=77.5] | Loss=0.00735 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.007 | 4505.6 samples/s | 70.4 steps/s
[Step=15850 Epoch=77.7] | Loss=0.00708 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.008 | 1621.2 samples/s | 25.3 steps/s
[Step=15900 Epoch=78.0] | Loss=0.00673 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.009 | 3753.0 samples/s | 58.6 steps/s
[Step=15950 Epoch=78.2] | Loss=0.00654 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.010 | 3753.2 samples/s | 58.6 steps/s
[Step=16000 Epoch=78.5] | Loss=0.00638 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.011 | 4315.5 samples/s | 67.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_4/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=27201 Epoch=257.8] | Loss=0.08852 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.999 | 3433.6 samples/s | 53.7 steps/s
[Step=27250 Epoch=258.2] | Loss=0.00945 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=2.999 | 3442.8 samples/s | 53.8 steps/s
[Step=27300 Epoch=258.7] | Loss=0.00480 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=2.999 | 4632.6 samples/s | 72.4 steps/s
[Step=27350 Epoch=259.2] | Loss=0.00325 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=3.000 | 1541.0 samples/s | 24.1 steps/s
[Step=27400 Epoch=259.6] | Loss=0.00246 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.000 | 4350.8 samples/s | 68.0 steps/s
[Step=27450 Epoch=260.1] | Loss=0.00198 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=3.000 | 1569.8 samples/s | 24.5 steps/s
[Step=27500 Epoch=260.6] | Loss=0.00166 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.000 | 4074.4 samples/s | 63.7 steps/s
[Step=27550 Epoch=261.1] | Loss=0.00144 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=3.001 | 1602.5 samples/s | 25.0 steps/s
[Step=27600 Epoch=261.5] | Loss=0.00127 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=3.001 | 3914.8 samples/s | 61.2 steps/s
[Step=27650 Epoch=262.0] | Loss=0.00113 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=3.001 | 1626.4 samples/s | 25.4 steps/s
[Step=27700 Epoch=262.5] | Loss=0.00103 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=3.001 | 3630.6 samples/s | 56.7 steps/s
[Step=27750 Epoch=263.0] | Loss=0.00094 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=3.002 | 1697.7 samples/s | 26.5 steps/s
[Step=27800 Epoch=263.4] | Loss=0.00086 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.002 | 3609.0 samples/s | 56.4 steps/s
[Step=27850 Epoch=263.9] | Loss=0.00080 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.002 | 1686.1 samples/s | 26.3 steps/s
[Step=27900 Epoch=264.4] | Loss=0.00075 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.002 | 3594.1 samples/s | 56.2 steps/s
[Step=27950 Epoch=264.9] | Loss=0.00070 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.002 | 1692.9 samples/s | 26.5 steps/s
[Step=28000 Epoch=265.3] | Loss=0.00066 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.003 | 3560.4 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step28000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=191.0] | Loss=0.06527 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.999 | 3489.0 samples/s | 54.5 steps/s
[Step=20050 Epoch=191.5] | Loss=0.00860 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.000 | 3419.6 samples/s | 53.4 steps/s
[Step=20100 Epoch=191.9] | Loss=0.00448 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=3.001 | 4654.2 samples/s | 72.7 steps/s
[Step=20150 Epoch=192.4] | Loss=0.00303 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=3.002 | 1532.8 samples/s | 23.9 steps/s
[Step=20200 Epoch=192.9] | Loss=0.00230 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.436 | FP-Norm(final)=3.002 | 4393.0 samples/s | 68.6 steps/s
[Step=20250 Epoch=193.4] | Loss=0.00186 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.431 | FP-Norm(final)=3.002 | 1563.2 samples/s | 24.4 steps/s
[Step=20300 Epoch=193.9] | Loss=0.00157 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=3.003 | 4190.9 samples/s | 65.5 steps/s
[Step=20350 Epoch=194.3] | Loss=0.00135 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=3.003 | 1567.4 samples/s | 24.5 steps/s
[Step=20400 Epoch=194.8] | Loss=0.00120 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.003 | 3983.7 samples/s | 62.2 steps/s
[Step=20450 Epoch=195.3] | Loss=0.00107 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=3.003 | 1599.0 samples/s | 25.0 steps/s
[Step=20500 Epoch=195.8] | Loss=0.00097 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.004 | 3830.1 samples/s | 59.8 steps/s
[Step=20550 Epoch=196.2] | Loss=0.00089 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=3.004 | 1657.4 samples/s | 25.9 steps/s
[Step=20600 Epoch=196.7] | Loss=0.00082 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=3.004 | 3633.8 samples/s | 56.8 steps/s
[Step=20650 Epoch=197.2] | Loss=0.00076 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=3.004 | 1693.1 samples/s | 26.5 steps/s
[Step=20700 Epoch=197.7] | Loss=0.00071 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=3.004 | 3558.8 samples/s | 55.6 steps/s
[Step=20750 Epoch=198.1] | Loss=0.00066 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=3.004 | 1695.9 samples/s | 26.5 steps/s
[Step=20800 Epoch=198.6] | Loss=0.00063 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=3.005 | 3611.4 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_2/client_state-step20800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=173.4] | Loss=0.03570 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.999 | 3365.6 samples/s | 52.6 steps/s
[Step=18450 Epoch=173.9] | Loss=0.00793 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=3.001 | 3564.5 samples/s | 55.7 steps/s
[Step=18500 Epoch=174.3] | Loss=0.00404 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=3.001 | 4577.2 samples/s | 71.5 steps/s
[Step=18550 Epoch=174.8] | Loss=0.00274 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=3.002 | 1540.0 samples/s | 24.1 steps/s
[Step=18600 Epoch=175.3] | Loss=0.00208 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.455 | FP-Norm(final)=3.002 | 4269.9 samples/s | 66.7 steps/s
[Step=18650 Epoch=175.7] | Loss=0.00168 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.449 | FP-Norm(final)=3.002 | 1586.2 samples/s | 24.8 steps/s
[Step=18700 Epoch=176.2] | Loss=0.00141 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.444 | FP-Norm(final)=3.002 | 3978.8 samples/s | 62.2 steps/s
[Step=18750 Epoch=176.7] | Loss=0.00122 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=3.003 | 1617.0 samples/s | 25.3 steps/s
[Step=18800 Epoch=177.1] | Loss=0.00108 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=3.003 | 3716.0 samples/s | 58.1 steps/s
[Step=18850 Epoch=177.6] | Loss=0.00096 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=3.003 | 1650.7 samples/s | 25.8 steps/s
[Step=18900 Epoch=178.1] | Loss=0.00087 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=3.003 | 3587.4 samples/s | 56.1 steps/s
[Step=18950 Epoch=178.6] | Loss=0.00080 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=3.004 | 1670.1 samples/s | 26.1 steps/s
[Step=19000 Epoch=179.0] | Loss=0.00074 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.004 | 3635.4 samples/s | 56.8 steps/s
[Step=19050 Epoch=179.5] | Loss=0.00068 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=3.004 | 1694.3 samples/s | 26.5 steps/s
[Step=19100 Epoch=180.0] | Loss=0.00064 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.004 | 3556.9 samples/s | 55.6 steps/s
[Step=19150 Epoch=180.4] | Loss=0.00060 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=3.004 | 1759.1 samples/s | 27.5 steps/s
[Step=19200 Epoch=180.9] | Loss=0.00056 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=3.004 | 3339.7 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29838 | acc=0.8372 | tpr=0.7692 | fpr=0.0151 | 3580.1 samples/s | 14.0 steps/s
Avg test loss: 0.30679, Avg test acc: 0.83532, Avg tpr: 0.76756, Avg fpr: 0.01564, total FA: 122

Testing server on iccad2012
[Step=  50] | Loss=0.51165 | acc=0.8429 | tpr=0.9425 | fpr=0.1589 | 3612.8 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.51393 | acc=0.8423 | tpr=0.9552 | fpr=0.1598 | 6746.9 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.52104 | acc=0.8423 | tpr=0.9669 | fpr=0.1600 | 6901.5 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.52155 | acc=0.8428 | tpr=0.9683 | fpr=0.1595 | 6826.9 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.52014 | acc=0.8421 | tpr=0.9686 | fpr=0.1602 | 6993.3 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.52156 | acc=0.8417 | tpr=0.9680 | fpr=0.1606 | 6732.2 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.52479 | acc=0.8420 | tpr=0.9681 | fpr=0.1603 | 6733.9 samples/s | 26.3 steps/s
[Step= 400] | Loss=0.52543 | acc=0.8421 | tpr=0.9699 | fpr=0.1602 | 6750.7 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.53135 | acc=0.8417 | tpr=0.9708 | fpr=0.1607 | 6760.1 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.53228 | acc=0.8410 | tpr=0.9718 | fpr=0.1614 | 6485.1 samples/s | 25.3 steps/s
[Step= 550] | Loss=0.52882 | acc=0.8415 | tpr=0.9706 | fpr=0.1608 | 12421.1 samples/s | 48.5 steps/s
Avg test loss: 0.52892, Avg test acc: 0.84141, Avg tpr: 0.97029, Avg fpr: 0.16093, total FA: 22345

server round 48/50

clients selected: [0 1 3 5 6]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=89.7] | Loss=0.12651 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.007 | 3643.1 samples/s | 56.9 steps/s
[Step=18450 Epoch=90.0] | Loss=0.03657 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.005 | 3501.4 samples/s | 54.7 steps/s
[Step=18500 Epoch=90.2] | Loss=0.02565 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.396 | FP-Norm(final)=3.005 | 3730.3 samples/s | 58.3 steps/s
[Step=18550 Epoch=90.5] | Loss=0.02039 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.005 | 3699.3 samples/s | 57.8 steps/s
[Step=18600 Epoch=90.7] | Loss=0.01757 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=3.005 | 4782.3 samples/s | 74.7 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01504 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=3.005 | 1588.2 samples/s | 24.8 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01344 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.006 | 3735.0 samples/s | 58.4 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01238 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=3.007 | 3737.4 samples/s | 58.4 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01152 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.008 | 4515.3 samples/s | 70.6 steps/s
[Step=18850 Epoch=91.9] | Loss=0.01078 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=3.008 | 1619.9 samples/s | 25.3 steps/s
[Step=18900 Epoch=92.2] | Loss=0.01010 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=3.009 | 3747.9 samples/s | 58.6 steps/s
[Step=18950 Epoch=92.4] | Loss=0.00950 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=3.010 | 3739.5 samples/s | 58.4 steps/s
[Step=19000 Epoch=92.6] | Loss=0.00909 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=3.011 | 4262.8 samples/s | 66.6 steps/s
[Step=19050 Epoch=92.9] | Loss=0.00870 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=3.011 | 1650.8 samples/s | 25.8 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00830 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.012 | 3748.1 samples/s | 58.6 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00801 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.013 | 3723.6 samples/s | 58.2 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00777 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.014 | 4005.4 samples/s | 62.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_0/client_state-step19200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=97.6] | Loss=0.13602 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.007 | 3576.5 samples/s | 55.9 steps/s
[Step=20050 Epoch=97.8] | Loss=0.02892 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=3.006 | 3575.3 samples/s | 55.9 steps/s
[Step=20100 Epoch=98.1] | Loss=0.02155 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.369 | FP-Norm(final)=3.006 | 3728.0 samples/s | 58.3 steps/s
[Step=20150 Epoch=98.3] | Loss=0.01876 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.006 | 3723.0 samples/s | 58.2 steps/s
[Step=20200 Epoch=98.6] | Loss=0.01649 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.391 | FP-Norm(final)=3.006 | 4816.2 samples/s | 75.3 steps/s
[Step=20250 Epoch=98.8] | Loss=0.01427 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=3.006 | 1576.3 samples/s | 24.6 steps/s
[Step=20300 Epoch=99.1] | Loss=0.01271 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=3.007 | 3730.4 samples/s | 58.3 steps/s
[Step=20350 Epoch=99.3] | Loss=0.01154 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=3.007 | 3714.4 samples/s | 58.0 steps/s
[Step=20400 Epoch=99.5] | Loss=0.01079 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.008 | 4525.5 samples/s | 70.7 steps/s
[Step=20450 Epoch=99.8] | Loss=0.01009 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=3.009 | 1604.6 samples/s | 25.1 steps/s
[Step=20500 Epoch=100.0] | Loss=0.00943 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.010 | 3726.6 samples/s | 58.2 steps/s
[Step=20550 Epoch=100.3] | Loss=0.00884 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.011 | 3737.6 samples/s | 58.4 steps/s
[Step=20600 Epoch=100.5] | Loss=0.00849 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.011 | 4365.7 samples/s | 68.2 steps/s
[Step=20650 Epoch=100.8] | Loss=0.00812 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.012 | 1634.3 samples/s | 25.5 steps/s
[Step=20700 Epoch=101.0] | Loss=0.00771 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.013 | 3721.8 samples/s | 58.2 steps/s
[Step=20750 Epoch=101.3] | Loss=0.00747 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.014 | 3698.2 samples/s | 57.8 steps/s
[Step=20800 Epoch=101.5] | Loss=0.00720 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=3.015 | 4124.5 samples/s | 64.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step20800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=85.8] | Loss=0.10654 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.007 | 3472.7 samples/s | 54.3 steps/s
[Step=17650 Epoch=86.1] | Loss=0.03284 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.006 | 3670.2 samples/s | 57.3 steps/s
[Step=17700 Epoch=86.3] | Loss=0.02228 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.005 | 3739.4 samples/s | 58.4 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01810 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.006 | 3723.7 samples/s | 58.2 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01512 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=3.006 | 4770.6 samples/s | 74.5 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01306 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=3.007 | 1585.3 samples/s | 24.8 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01167 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=3.008 | 3739.2 samples/s | 58.4 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01057 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=3.009 | 3761.2 samples/s | 58.8 steps/s
[Step=18000 Epoch=87.8] | Loss=0.00988 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.009 | 4508.7 samples/s | 70.4 steps/s
[Step=18050 Epoch=88.0] | Loss=0.00916 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=3.010 | 1599.4 samples/s | 25.0 steps/s
[Step=18100 Epoch=88.3] | Loss=0.00856 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.011 | 3711.4 samples/s | 58.0 steps/s
[Step=18150 Epoch=88.5] | Loss=0.00804 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.012 | 3738.0 samples/s | 58.4 steps/s
[Step=18200 Epoch=88.8] | Loss=0.00770 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.013 | 4267.4 samples/s | 66.7 steps/s
[Step=18250 Epoch=89.0] | Loss=0.00732 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.014 | 1655.1 samples/s | 25.9 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00703 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.014 | 3751.8 samples/s | 58.6 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00680 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.015 | 3729.6 samples/s | 58.3 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00654 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.016 | 4045.7 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_3/client_state-step18400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=28001 Epoch=265.3] | Loss=0.06260 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.007 | 3408.5 samples/s | 53.3 steps/s
[Step=28050 Epoch=265.8] | Loss=0.00579 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=3.009 | 3409.8 samples/s | 53.3 steps/s
[Step=28100 Epoch=266.3] | Loss=0.00308 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=3.009 | 4601.9 samples/s | 71.9 steps/s
[Step=28150 Epoch=266.7] | Loss=0.00208 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=3.010 | 1529.3 samples/s | 23.9 steps/s
[Step=28200 Epoch=267.2] | Loss=0.00158 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=3.010 | 4314.1 samples/s | 67.4 steps/s
[Step=28250 Epoch=267.7] | Loss=0.00127 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=3.010 | 1565.8 samples/s | 24.5 steps/s
[Step=28300 Epoch=268.2] | Loss=0.00107 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=3.011 | 4046.8 samples/s | 63.2 steps/s
[Step=28350 Epoch=268.6] | Loss=0.00093 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.011 | 1584.5 samples/s | 24.8 steps/s
[Step=28400 Epoch=269.1] | Loss=0.00082 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=3.011 | 3794.1 samples/s | 59.3 steps/s
[Step=28450 Epoch=269.6] | Loss=0.00073 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=3.011 | 1639.8 samples/s | 25.6 steps/s
[Step=28500 Epoch=270.1] | Loss=0.00066 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=3.011 | 3650.4 samples/s | 57.0 steps/s
[Step=28550 Epoch=270.5] | Loss=0.00061 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.012 | 1661.4 samples/s | 26.0 steps/s
[Step=28600 Epoch=271.0] | Loss=0.00056 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.012 | 3589.4 samples/s | 56.1 steps/s
[Step=28650 Epoch=271.5] | Loss=0.00052 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.012 | 1697.8 samples/s | 26.5 steps/s
[Step=28700 Epoch=272.0] | Loss=0.00048 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.012 | 3615.3 samples/s | 56.5 steps/s
[Step=28750 Epoch=272.4] | Loss=0.00046 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.012 | 1689.5 samples/s | 26.4 steps/s
[Step=28800 Epoch=272.9] | Loss=0.00043 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.012 | 3533.4 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step28800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=144.6] | Loss=0.07399 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.007 | 3434.1 samples/s | 53.7 steps/s
[Step=15250 Epoch=145.1] | Loss=0.00685 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=3.008 | 3343.8 samples/s | 52.2 steps/s
[Step=15300 Epoch=145.5] | Loss=0.00359 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=3.009 | 4654.1 samples/s | 72.7 steps/s
[Step=15350 Epoch=146.0] | Loss=0.00247 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=3.010 | 1530.3 samples/s | 23.9 steps/s
[Step=15400 Epoch=146.5] | Loss=0.00187 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=3.010 | 4329.9 samples/s | 67.7 steps/s
[Step=15450 Epoch=147.0] | Loss=0.00151 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=3.011 | 1560.2 samples/s | 24.4 steps/s
[Step=15500 Epoch=147.4] | Loss=0.00127 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=3.011 | 4058.6 samples/s | 63.4 steps/s
[Step=15550 Epoch=147.9] | Loss=0.00110 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=3.011 | 1596.2 samples/s | 24.9 steps/s
[Step=15600 Epoch=148.4] | Loss=0.00097 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=3.011 | 3850.8 samples/s | 60.2 steps/s
[Step=15650 Epoch=148.9] | Loss=0.00087 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=3.012 | 1631.1 samples/s | 25.5 steps/s
[Step=15700 Epoch=149.3] | Loss=0.00079 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.012 | 3645.1 samples/s | 57.0 steps/s
[Step=15750 Epoch=149.8] | Loss=0.00072 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=3.012 | 1675.0 samples/s | 26.2 steps/s
[Step=15800 Epoch=150.3] | Loss=0.00066 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.012 | 3531.2 samples/s | 55.2 steps/s
[Step=15850 Epoch=150.8] | Loss=0.00061 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=3.012 | 1693.8 samples/s | 26.5 steps/s
[Step=15900 Epoch=151.2] | Loss=0.00057 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=3.012 | 3612.8 samples/s | 56.4 steps/s
[Step=15950 Epoch=151.7] | Loss=0.00054 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=3.013 | 1687.7 samples/s | 26.4 steps/s
[Step=16000 Epoch=152.2] | Loss=0.00051 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=3.013 | 3592.3 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29823 | acc=0.8387 | tpr=0.7715 | fpr=0.0154 | 3524.7 samples/s | 13.8 steps/s
Avg test loss: 0.30669, Avg test acc: 0.83725, Avg tpr: 0.77041, Avg fpr: 0.01577, total FA: 123

Testing server on iccad2012
[Step=  50] | Loss=0.51484 | acc=0.8438 | tpr=0.9336 | fpr=0.1578 | 3598.6 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.51677 | acc=0.8438 | tpr=0.9510 | fpr=0.1583 | 6677.3 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.52391 | acc=0.8440 | tpr=0.9640 | fpr=0.1583 | 6781.1 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.52462 | acc=0.8446 | tpr=0.9661 | fpr=0.1576 | 4298.8 samples/s | 16.8 steps/s
[Step= 250] | Loss=0.52323 | acc=0.8439 | tpr=0.9668 | fpr=0.1583 | 6621.9 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.52468 | acc=0.8436 | tpr=0.9665 | fpr=0.1587 | 6771.5 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.52800 | acc=0.8439 | tpr=0.9668 | fpr=0.1583 | 7103.3 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.52871 | acc=0.8440 | tpr=0.9688 | fpr=0.1583 | 6458.5 samples/s | 25.2 steps/s
[Step= 450] | Loss=0.53467 | acc=0.8435 | tpr=0.9698 | fpr=0.1588 | 6982.4 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.53558 | acc=0.8427 | tpr=0.9709 | fpr=0.1596 | 6592.3 samples/s | 25.8 steps/s
[Step= 550] | Loss=0.53209 | acc=0.8432 | tpr=0.9698 | fpr=0.1591 | 12158.3 samples/s | 47.5 steps/s
Avg test loss: 0.53218, Avg test acc: 0.84314, Avg tpr: 0.96949, Avg fpr: 0.15916, total FA: 22099

server round 49/50

clients selected: [1 2 5 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20801 Epoch=101.5] | Loss=0.16701 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=3.016 | 3627.9 samples/s | 56.7 steps/s
[Step=20850 Epoch=101.7] | Loss=0.02649 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.330 | FP-Norm(final)=3.015 | 3506.3 samples/s | 54.8 steps/s
[Step=20900 Epoch=102.0] | Loss=0.01981 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=3.015 | 3741.9 samples/s | 58.5 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01689 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.380 | FP-Norm(final)=3.015 | 3762.6 samples/s | 58.8 steps/s
[Step=21000 Epoch=102.5] | Loss=0.01505 | Reg=0.00016 | acc=0.9844 | FP-Norm=0.389 | FP-Norm(final)=3.015 | 4795.2 samples/s | 74.9 steps/s
[Step=21050 Epoch=102.7] | Loss=0.01345 | Reg=0.00016 | acc=0.9688 | FP-Norm=0.394 | FP-Norm(final)=3.016 | 1559.2 samples/s | 24.4 steps/s
[Step=21100 Epoch=103.0] | Loss=0.01192 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=3.016 | 3734.2 samples/s | 58.3 steps/s
[Step=21150 Epoch=103.2] | Loss=0.01091 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=3.017 | 3734.6 samples/s | 58.4 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01020 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.404 | FP-Norm(final)=3.018 | 4571.4 samples/s | 71.4 steps/s
[Step=21250 Epoch=103.7] | Loss=0.00950 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=3.018 | 1606.3 samples/s | 25.1 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00893 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.019 | 3705.7 samples/s | 57.9 steps/s
[Step=21350 Epoch=104.2] | Loss=0.00849 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.020 | 3735.5 samples/s | 58.4 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00812 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.021 | 4307.5 samples/s | 67.3 steps/s
[Step=21450 Epoch=104.7] | Loss=0.00778 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.021 | 1646.6 samples/s | 25.7 steps/s
[Step=21500 Epoch=104.9] | Loss=0.00746 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=3.022 | 3699.4 samples/s | 57.8 steps/s
[Step=21550 Epoch=105.2] | Loss=0.00716 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.411 | FP-Norm(final)=3.023 | 3698.2 samples/s | 57.8 steps/s
[Step=21600 Epoch=105.4] | Loss=0.00687 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=3.024 | 4113.2 samples/s | 64.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_1/client_state-step21600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=21601 Epoch=105.3] | Loss=0.26616 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=3.016 | 3764.2 samples/s | 58.8 steps/s
[Step=21650 Epoch=105.5] | Loss=0.03155 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=3.014 | 3615.7 samples/s | 56.5 steps/s
[Step=21700 Epoch=105.7] | Loss=0.02163 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.014 | 3765.7 samples/s | 58.8 steps/s
[Step=21750 Epoch=106.0] | Loss=0.01714 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.015 | 3715.2 samples/s | 58.1 steps/s
[Step=21800 Epoch=106.2] | Loss=0.01473 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.379 | FP-Norm(final)=3.015 | 4770.1 samples/s | 74.5 steps/s
[Step=21850 Epoch=106.5] | Loss=0.01280 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.016 | 1540.5 samples/s | 24.1 steps/s
[Step=21900 Epoch=106.7] | Loss=0.01152 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.017 | 3684.1 samples/s | 57.6 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01049 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.018 | 3721.5 samples/s | 58.1 steps/s
[Step=22000 Epoch=107.2] | Loss=0.00965 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.018 | 4500.7 samples/s | 70.3 steps/s
[Step=22050 Epoch=107.4] | Loss=0.00911 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.386 | FP-Norm(final)=3.019 | 1603.4 samples/s | 25.1 steps/s
[Step=22100 Epoch=107.7] | Loss=0.00848 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=3.020 | 3732.5 samples/s | 58.3 steps/s
[Step=22150 Epoch=107.9] | Loss=0.00798 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=3.021 | 3712.2 samples/s | 58.0 steps/s
[Step=22200 Epoch=108.2] | Loss=0.00772 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=3.022 | 4235.2 samples/s | 66.2 steps/s
[Step=22250 Epoch=108.4] | Loss=0.00734 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.023 | 1637.2 samples/s | 25.6 steps/s
[Step=22300 Epoch=108.7] | Loss=0.00706 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=3.024 | 3716.2 samples/s | 58.1 steps/s
[Step=22350 Epoch=108.9] | Loss=0.00683 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=3.024 | 3732.7 samples/s | 58.3 steps/s
[Step=22400 Epoch=109.1] | Loss=0.00657 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=3.025 | 3973.7 samples/s | 62.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_asml1_2/client_state-step22400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=28801 Epoch=272.9] | Loss=0.04864 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.016 | 3353.4 samples/s | 52.4 steps/s
[Step=28850 Epoch=273.4] | Loss=0.00861 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.016 | 3455.9 samples/s | 54.0 steps/s
[Step=28900 Epoch=273.9] | Loss=0.00444 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=3.016 | 4621.3 samples/s | 72.2 steps/s
[Step=28950 Epoch=274.3] | Loss=0.00299 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.443 | FP-Norm(final)=3.016 | 1519.3 samples/s | 23.7 steps/s
[Step=29000 Epoch=274.8] | Loss=0.00226 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=3.016 | 4315.7 samples/s | 67.4 steps/s
[Step=29050 Epoch=275.3] | Loss=0.00182 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=3.017 | 1134.3 samples/s | 17.7 steps/s
[Step=29100 Epoch=275.7] | Loss=0.00152 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=3.017 | 4035.3 samples/s | 63.1 steps/s
[Step=29150 Epoch=276.2] | Loss=0.00131 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=3.017 | 1598.6 samples/s | 25.0 steps/s
[Step=29200 Epoch=276.7] | Loss=0.00116 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=3.017 | 3831.7 samples/s | 59.9 steps/s
[Step=29250 Epoch=277.2] | Loss=0.00103 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.017 | 1623.3 samples/s | 25.4 steps/s
[Step=29300 Epoch=277.6] | Loss=0.00093 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=3.018 | 3643.4 samples/s | 56.9 steps/s
[Step=29350 Epoch=278.1] | Loss=0.00085 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.018 | 1675.0 samples/s | 26.2 steps/s
[Step=29400 Epoch=278.6] | Loss=0.00078 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=3.018 | 3586.1 samples/s | 56.0 steps/s
[Step=29450 Epoch=279.1] | Loss=0.00073 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=3.018 | 1696.0 samples/s | 26.5 steps/s
[Step=29500 Epoch=279.5] | Loss=0.00068 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=3.018 | 3551.4 samples/s | 55.5 steps/s
[Step=29550 Epoch=280.0] | Loss=0.00063 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=3.018 | 1713.9 samples/s | 26.8 steps/s
[Step=29600 Epoch=280.5] | Loss=0.00060 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=3.018 | 3536.5 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_0/client_state-step29600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=180.9] | Loss=0.16236 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.016 | 3523.6 samples/s | 55.1 steps/s
[Step=19250 Epoch=181.4] | Loss=0.00850 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=3.017 | 3245.0 samples/s | 50.7 steps/s
[Step=19300 Epoch=181.9] | Loss=0.00447 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=3.017 | 4565.2 samples/s | 71.3 steps/s
[Step=19350 Epoch=182.3] | Loss=0.00302 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.472 | FP-Norm(final)=3.018 | 1537.4 samples/s | 24.0 steps/s
[Step=19400 Epoch=182.8] | Loss=0.00228 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.468 | FP-Norm(final)=3.018 | 4157.3 samples/s | 65.0 steps/s
[Step=19450 Epoch=183.3] | Loss=0.00183 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=3.018 | 1573.0 samples/s | 24.6 steps/s
[Step=19500 Epoch=183.7] | Loss=0.00154 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.455 | FP-Norm(final)=3.018 | 3932.9 samples/s | 61.5 steps/s
[Step=19550 Epoch=184.2] | Loss=0.00133 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.449 | FP-Norm(final)=3.019 | 1622.7 samples/s | 25.4 steps/s
[Step=19600 Epoch=184.7] | Loss=0.00117 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.443 | FP-Norm(final)=3.019 | 3717.9 samples/s | 58.1 steps/s
[Step=19650 Epoch=185.2] | Loss=0.00105 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=3.019 | 1666.9 samples/s | 26.0 steps/s
[Step=19700 Epoch=185.6] | Loss=0.00095 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=3.019 | 3595.8 samples/s | 56.2 steps/s
[Step=19750 Epoch=186.1] | Loss=0.00086 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=3.019 | 1692.2 samples/s | 26.4 steps/s
[Step=19800 Epoch=186.6] | Loss=0.00080 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=3.019 | 3594.7 samples/s | 56.2 steps/s
[Step=19850 Epoch=187.0] | Loss=0.00074 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=3.019 | 1705.5 samples/s | 26.6 steps/s
[Step=19900 Epoch=187.5] | Loss=0.00069 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.020 | 3492.3 samples/s | 54.6 steps/s
[Step=19950 Epoch=188.0] | Loss=0.00065 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=3.020 | 1684.2 samples/s | 26.3 steps/s
[Step=20000 Epoch=188.5] | Loss=0.00061 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.020 | 3651.3 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_3/client_state-step20000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=144.9] | Loss=0.14515 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.016 | 3488.5 samples/s | 54.5 steps/s
[Step=15250 Epoch=145.3] | Loss=0.00893 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.016 | 3389.1 samples/s | 53.0 steps/s
[Step=15300 Epoch=145.8] | Loss=0.00459 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=3.017 | 4675.1 samples/s | 73.0 steps/s
[Step=15350 Epoch=146.3] | Loss=0.00309 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=3.018 | 1510.7 samples/s | 23.6 steps/s
[Step=15400 Epoch=146.8] | Loss=0.00234 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=3.018 | 4377.4 samples/s | 68.4 steps/s
[Step=15450 Epoch=147.3] | Loss=0.00189 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=3.018 | 1558.1 samples/s | 24.3 steps/s
[Step=15500 Epoch=147.7] | Loss=0.00159 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=3.018 | 4179.6 samples/s | 65.3 steps/s
[Step=15550 Epoch=148.2] | Loss=0.00137 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=3.019 | 1591.4 samples/s | 24.9 steps/s
[Step=15600 Epoch=148.7] | Loss=0.00120 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.019 | 3956.6 samples/s | 61.8 steps/s
[Step=15650 Epoch=149.2] | Loss=0.00108 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.019 | 1625.8 samples/s | 25.4 steps/s
[Step=15700 Epoch=149.6] | Loss=0.00097 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=3.019 | 3752.5 samples/s | 58.6 steps/s
[Step=15750 Epoch=150.1] | Loss=0.00089 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=3.019 | 1642.2 samples/s | 25.7 steps/s
[Step=15800 Epoch=150.6] | Loss=0.00082 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=3.020 | 3597.9 samples/s | 56.2 steps/s
[Step=15850 Epoch=151.1] | Loss=0.00076 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.020 | 1672.2 samples/s | 26.1 steps/s
[Step=15900 Epoch=151.5] | Loss=0.00071 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.020 | 3534.5 samples/s | 55.2 steps/s
[Step=15950 Epoch=152.0] | Loss=0.00066 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.020 | 1698.9 samples/s | 26.5 steps/s
[Step=16000 Epoch=152.5] | Loss=0.00062 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.020 | 3592.4 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel0.5-l2fp1e-3/client_iccad2012_4/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30510 | acc=0.8362 | tpr=0.7676 | fpr=0.0149 | 3611.4 samples/s | 14.1 steps/s
Avg test loss: 0.31404, Avg test acc: 0.83448, Avg tpr: 0.76622, Avg fpr: 0.01538, total FA: 120

Testing server on iccad2012
[Step=  50] | Loss=0.50098 | acc=0.8496 | tpr=0.9381 | fpr=0.1520 | 3542.6 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.50297 | acc=0.8490 | tpr=0.9510 | fpr=0.1529 | 6830.9 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.51016 | acc=0.8492 | tpr=0.9640 | fpr=0.1529 | 6848.0 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.51122 | acc=0.8497 | tpr=0.9661 | fpr=0.1524 | 6722.6 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.50960 | acc=0.8494 | tpr=0.9668 | fpr=0.1527 | 6865.9 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.51113 | acc=0.8489 | tpr=0.9665 | fpr=0.1533 | 6771.0 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.51448 | acc=0.8492 | tpr=0.9662 | fpr=0.1529 | 6862.6 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.51511 | acc=0.8491 | tpr=0.9683 | fpr=0.1530 | 6634.6 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.52110 | acc=0.8487 | tpr=0.9693 | fpr=0.1534 | 6615.0 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.52198 | acc=0.8480 | tpr=0.9705 | fpr=0.1542 | 6635.7 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.51855 | acc=0.8487 | tpr=0.9694 | fpr=0.1535 | 12665.6 samples/s | 49.5 steps/s
Avg test loss: 0.51863, Avg test acc: 0.84858, Avg tpr: 0.96910, Avg fpr: 0.15361, total FA: 21328
