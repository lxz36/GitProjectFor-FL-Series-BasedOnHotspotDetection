#clients of iccad2012: 5
#clients of asml1: 5
select ratio: 1.0
Total num clients: 10
client model path: ['models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3', 'models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13125, 144, 32)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13116, 144, 32)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13135, 144, 32)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13124, 144, 32)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 32)
Resampled dataset to size (13051, 144, 32)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6754, 144, 32)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6728, 144, 32)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6702, 144, 32)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6792, 144, 32)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6715, 144, 32)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34242 | Reg=0.00000 | acc=0.5625 | FP-Norm=0.000 | FP-Norm(final)=1.933 | 2647.0 samples/s | 41.4 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.28766 | Reg=0.00188 | acc=0.7969 | FP-Norm=1.276 | FP-Norm(final)=1.937 | 4087.8 samples/s | 63.9 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24796 | Reg=0.00360 | acc=0.8281 | FP-Norm=1.789 | FP-Norm(final)=1.950 | 4010.7 samples/s | 62.7 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22058 | Reg=0.00490 | acc=0.8750 | FP-Norm=2.105 | FP-Norm(final)=1.956 | 4013.1 samples/s | 62.7 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20444 | Reg=0.00591 | acc=0.8750 | FP-Norm=2.326 | FP-Norm(final)=1.964 | 5046.9 samples/s | 78.9 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18917 | Reg=0.00691 | acc=0.9688 | FP-Norm=2.520 | FP-Norm(final)=1.973 | 1711.6 samples/s | 26.7 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17410 | Reg=0.00783 | acc=0.9688 | FP-Norm=2.689 | FP-Norm(final)=1.982 | 3884.6 samples/s | 60.7 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16413 | Reg=0.00858 | acc=0.8906 | FP-Norm=2.821 | FP-Norm(final)=1.991 | 3886.4 samples/s | 60.7 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15644 | Reg=0.00929 | acc=0.9844 | FP-Norm=2.940 | FP-Norm(final)=1.999 | 4674.7 samples/s | 73.0 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14767 | Reg=0.00999 | acc=1.0000 | FP-Norm=3.052 | FP-Norm(final)=2.007 | 1734.2 samples/s | 27.1 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13949 | Reg=0.01066 | acc=0.9531 | FP-Norm=3.155 | FP-Norm(final)=2.016 | 3860.0 samples/s | 60.3 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.13258 | Reg=0.01129 | acc=0.9688 | FP-Norm=3.250 | FP-Norm(final)=2.025 | 3855.5 samples/s | 60.2 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12724 | Reg=0.01185 | acc=0.9844 | FP-Norm=3.333 | FP-Norm(final)=2.034 | 4328.2 samples/s | 67.6 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.12105 | Reg=0.01238 | acc=1.0000 | FP-Norm=3.410 | FP-Norm(final)=2.043 | 1768.8 samples/s | 27.6 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11581 | Reg=0.01288 | acc=0.9688 | FP-Norm=3.480 | FP-Norm(final)=2.052 | 3875.1 samples/s | 60.5 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.11123 | Reg=0.01335 | acc=0.9844 | FP-Norm=3.546 | FP-Norm(final)=2.060 | 3862.8 samples/s | 60.4 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10768 | Reg=0.01381 | acc=0.9688 | FP-Norm=3.609 | FP-Norm(final)=2.069 | 4152.9 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.40937 | Reg=0.00000 | acc=0.3594 | FP-Norm=0.000 | FP-Norm(final)=1.933 | 3703.6 samples/s | 57.9 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.30592 | Reg=0.00189 | acc=0.7969 | FP-Norm=1.288 | FP-Norm(final)=1.927 | 3922.9 samples/s | 61.3 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.25837 | Reg=0.00362 | acc=0.8281 | FP-Norm=1.797 | FP-Norm(final)=1.940 | 3917.1 samples/s | 61.2 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.23135 | Reg=0.00501 | acc=0.8125 | FP-Norm=2.128 | FP-Norm(final)=1.952 | 4002.5 samples/s | 62.5 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20766 | Reg=0.00624 | acc=0.8750 | FP-Norm=2.384 | FP-Norm(final)=1.964 | 5052.2 samples/s | 78.9 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18713 | Reg=0.00728 | acc=0.9375 | FP-Norm=2.584 | FP-Norm(final)=1.976 | 1659.9 samples/s | 25.9 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17527 | Reg=0.00820 | acc=0.9375 | FP-Norm=2.748 | FP-Norm(final)=1.987 | 3856.8 samples/s | 60.3 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16472 | Reg=0.00904 | acc=0.8906 | FP-Norm=2.891 | FP-Norm(final)=1.997 | 3894.2 samples/s | 60.8 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15728 | Reg=0.00979 | acc=0.9688 | FP-Norm=3.016 | FP-Norm(final)=2.006 | 4706.3 samples/s | 73.5 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14758 | Reg=0.01051 | acc=0.9219 | FP-Norm=3.128 | FP-Norm(final)=2.015 | 1719.5 samples/s | 26.9 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13879 | Reg=0.01118 | acc=0.9375 | FP-Norm=3.231 | FP-Norm(final)=2.025 | 3946.0 samples/s | 61.7 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.13292 | Reg=0.01179 | acc=0.9062 | FP-Norm=3.321 | FP-Norm(final)=2.034 | 3970.8 samples/s | 62.0 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12683 | Reg=0.01237 | acc=0.9844 | FP-Norm=3.405 | FP-Norm(final)=2.043 | 4634.1 samples/s | 72.4 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.12108 | Reg=0.01291 | acc=0.9688 | FP-Norm=3.482 | FP-Norm(final)=2.051 | 1736.4 samples/s | 27.1 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11592 | Reg=0.01340 | acc=0.9375 | FP-Norm=3.551 | FP-Norm(final)=2.059 | 3843.7 samples/s | 60.1 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.11106 | Reg=0.01386 | acc=0.9844 | FP-Norm=3.615 | FP-Norm(final)=2.067 | 3876.2 samples/s | 60.6 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10657 | Reg=0.01429 | acc=0.9531 | FP-Norm=3.674 | FP-Norm(final)=2.075 | 4286.0 samples/s | 67.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34768 | Reg=0.00000 | acc=0.5469 | FP-Norm=0.000 | FP-Norm(final)=1.933 | 3814.7 samples/s | 59.6 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.28664 | Reg=0.00207 | acc=0.7812 | FP-Norm=1.349 | FP-Norm(final)=1.940 | 3787.7 samples/s | 59.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24689 | Reg=0.00367 | acc=0.8750 | FP-Norm=1.820 | FP-Norm(final)=1.951 | 3962.6 samples/s | 61.9 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22345 | Reg=0.00495 | acc=0.8438 | FP-Norm=2.126 | FP-Norm(final)=1.961 | 3985.5 samples/s | 62.3 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20494 | Reg=0.00606 | acc=0.8906 | FP-Norm=2.361 | FP-Norm(final)=1.972 | 5086.7 samples/s | 79.5 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18596 | Reg=0.00707 | acc=0.9531 | FP-Norm=2.554 | FP-Norm(final)=1.982 | 1664.4 samples/s | 26.0 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17254 | Reg=0.00799 | acc=0.9688 | FP-Norm=2.720 | FP-Norm(final)=1.994 | 3856.6 samples/s | 60.3 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16178 | Reg=0.00883 | acc=0.9219 | FP-Norm=2.863 | FP-Norm(final)=2.005 | 3859.6 samples/s | 60.3 steps/s
[Step= 400 Epoch= 1.9] | Loss=0.15347 | Reg=0.00959 | acc=0.9062 | FP-Norm=2.988 | FP-Norm(final)=2.014 | 4634.7 samples/s | 72.4 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14555 | Reg=0.01029 | acc=0.9531 | FP-Norm=3.099 | FP-Norm(final)=2.023 | 1704.5 samples/s | 26.6 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13770 | Reg=0.01094 | acc=0.9688 | FP-Norm=3.199 | FP-Norm(final)=2.033 | 3849.1 samples/s | 60.1 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.13126 | Reg=0.01157 | acc=0.9219 | FP-Norm=3.292 | FP-Norm(final)=2.042 | 3856.7 samples/s | 60.3 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12570 | Reg=0.01215 | acc=0.9688 | FP-Norm=3.377 | FP-Norm(final)=2.051 | 4396.2 samples/s | 68.7 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11953 | Reg=0.01270 | acc=0.9531 | FP-Norm=3.455 | FP-Norm(final)=2.061 | 1720.2 samples/s | 26.9 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11432 | Reg=0.01321 | acc=0.9375 | FP-Norm=3.526 | FP-Norm(final)=2.070 | 3972.3 samples/s | 62.1 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.11032 | Reg=0.01370 | acc=0.9531 | FP-Norm=3.594 | FP-Norm(final)=2.078 | 3881.3 samples/s | 60.6 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10640 | Reg=0.01418 | acc=0.9375 | FP-Norm=3.658 | FP-Norm(final)=2.086 | 4171.5 samples/s | 65.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35336 | Reg=0.00000 | acc=0.5000 | FP-Norm=0.000 | FP-Norm(final)=1.933 | 4224.6 samples/s | 66.0 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.28849 | Reg=0.00212 | acc=0.8281 | FP-Norm=1.362 | FP-Norm(final)=1.939 | 3518.8 samples/s | 55.0 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24671 | Reg=0.00370 | acc=0.8281 | FP-Norm=1.828 | FP-Norm(final)=1.953 | 3936.7 samples/s | 61.5 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22297 | Reg=0.00494 | acc=0.8750 | FP-Norm=2.126 | FP-Norm(final)=1.963 | 3962.7 samples/s | 61.9 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20721 | Reg=0.00603 | acc=0.7969 | FP-Norm=2.357 | FP-Norm(final)=1.971 | 5102.6 samples/s | 79.7 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18793 | Reg=0.00711 | acc=0.9844 | FP-Norm=2.561 | FP-Norm(final)=1.980 | 1682.2 samples/s | 26.3 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17600 | Reg=0.00807 | acc=0.9219 | FP-Norm=2.732 | FP-Norm(final)=1.989 | 3893.9 samples/s | 60.8 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16599 | Reg=0.00894 | acc=0.9531 | FP-Norm=2.879 | FP-Norm(final)=1.997 | 3800.4 samples/s | 59.4 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15661 | Reg=0.00972 | acc=0.9375 | FP-Norm=3.006 | FP-Norm(final)=2.006 | 4650.5 samples/s | 72.7 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14643 | Reg=0.01045 | acc=0.9375 | FP-Norm=3.121 | FP-Norm(final)=2.014 | 1714.1 samples/s | 26.8 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13812 | Reg=0.01110 | acc=0.9375 | FP-Norm=3.220 | FP-Norm(final)=2.023 | 3976.2 samples/s | 62.1 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.13123 | Reg=0.01170 | acc=0.9375 | FP-Norm=3.310 | FP-Norm(final)=2.031 | 3977.8 samples/s | 62.2 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12544 | Reg=0.01226 | acc=0.9531 | FP-Norm=3.391 | FP-Norm(final)=2.039 | 4526.1 samples/s | 70.7 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11944 | Reg=0.01280 | acc=0.9688 | FP-Norm=3.468 | FP-Norm(final)=2.047 | 1752.7 samples/s | 27.4 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11459 | Reg=0.01331 | acc=0.9844 | FP-Norm=3.539 | FP-Norm(final)=2.055 | 3971.4 samples/s | 62.1 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10990 | Reg=0.01379 | acc=1.0000 | FP-Norm=3.605 | FP-Norm(final)=2.063 | 3882.2 samples/s | 60.7 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10656 | Reg=0.01423 | acc=1.0000 | FP-Norm=3.666 | FP-Norm(final)=2.071 | 4155.9 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37484 | Reg=0.00000 | acc=0.4219 | FP-Norm=0.000 | FP-Norm(final)=1.933 | 3804.8 samples/s | 59.5 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.29347 | Reg=0.00211 | acc=0.8906 | FP-Norm=1.354 | FP-Norm(final)=1.934 | 3810.7 samples/s | 59.5 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.25188 | Reg=0.00384 | acc=0.6719 | FP-Norm=1.855 | FP-Norm(final)=1.950 | 3892.9 samples/s | 60.8 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22509 | Reg=0.00520 | acc=0.7969 | FP-Norm=2.174 | FP-Norm(final)=1.960 | 3852.0 samples/s | 60.2 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20746 | Reg=0.00632 | acc=0.8750 | FP-Norm=2.408 | FP-Norm(final)=1.968 | 5006.5 samples/s | 78.2 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18631 | Reg=0.00729 | acc=0.9219 | FP-Norm=2.595 | FP-Norm(final)=1.979 | 1651.3 samples/s | 25.8 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17262 | Reg=0.00815 | acc=0.9375 | FP-Norm=2.751 | FP-Norm(final)=1.990 | 3899.1 samples/s | 60.9 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16117 | Reg=0.00893 | acc=0.9375 | FP-Norm=2.885 | FP-Norm(final)=2.000 | 3857.4 samples/s | 60.3 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15419 | Reg=0.00961 | acc=0.9219 | FP-Norm=2.998 | FP-Norm(final)=2.010 | 4804.3 samples/s | 75.1 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14437 | Reg=0.01024 | acc=0.9531 | FP-Norm=3.099 | FP-Norm(final)=2.020 | 1678.4 samples/s | 26.2 steps/s
[Step= 500 Epoch= 2.5] | Loss=0.13682 | Reg=0.01086 | acc=0.9219 | FP-Norm=3.194 | FP-Norm(final)=2.031 | 3851.6 samples/s | 60.2 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.13002 | Reg=0.01146 | acc=0.9688 | FP-Norm=3.284 | FP-Norm(final)=2.042 | 3839.2 samples/s | 60.0 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12554 | Reg=0.01201 | acc=0.9375 | FP-Norm=3.364 | FP-Norm(final)=2.052 | 4526.3 samples/s | 70.7 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11983 | Reg=0.01254 | acc=0.9844 | FP-Norm=3.440 | FP-Norm(final)=2.061 | 1691.7 samples/s | 26.4 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11440 | Reg=0.01303 | acc=0.9688 | FP-Norm=3.509 | FP-Norm(final)=2.071 | 3965.9 samples/s | 62.0 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10962 | Reg=0.01348 | acc=0.9531 | FP-Norm=3.572 | FP-Norm(final)=2.081 | 3958.3 samples/s | 61.8 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10592 | Reg=0.01390 | acc=1.0000 | FP-Norm=3.630 | FP-Norm(final)=2.091 | 4601.1 samples/s | 71.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.42339 | Reg=0.00000 | acc=0.5781 | FP-Norm=0.000 | FP-Norm(final)=1.933 | 3600.1 samples/s | 56.3 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.16307 | Reg=0.00345 | acc=0.9531 | FP-Norm=1.727 | FP-Norm(final)=1.947 | 3672.9 samples/s | 57.4 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.09753 | Reg=0.00519 | acc=1.0000 | FP-Norm=2.180 | FP-Norm(final)=1.965 | 4885.1 samples/s | 76.3 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.06769 | Reg=0.00597 | acc=1.0000 | FP-Norm=2.367 | FP-Norm(final)=1.981 | 1602.6 samples/s | 25.0 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.05245 | Reg=0.00630 | acc=0.9844 | FP-Norm=2.452 | FP-Norm(final)=1.995 | 4397.7 samples/s | 68.7 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.04254 | Reg=0.00652 | acc=1.0000 | FP-Norm=2.505 | FP-Norm(final)=2.006 | 1610.3 samples/s | 25.2 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.03591 | Reg=0.00660 | acc=1.0000 | FP-Norm=2.529 | FP-Norm(final)=2.015 | 4281.0 samples/s | 66.9 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.03089 | Reg=0.00662 | acc=1.0000 | FP-Norm=2.537 | FP-Norm(final)=2.024 | 1661.7 samples/s | 26.0 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02713 | Reg=0.00656 | acc=1.0000 | FP-Norm=2.530 | FP-Norm(final)=2.031 | 3966.5 samples/s | 62.0 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02420 | Reg=0.00647 | acc=1.0000 | FP-Norm=2.516 | FP-Norm(final)=2.038 | 1711.6 samples/s | 26.7 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.02184 | Reg=0.00637 | acc=1.0000 | FP-Norm=2.497 | FP-Norm(final)=2.044 | 3818.9 samples/s | 59.7 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01990 | Reg=0.00625 | acc=1.0000 | FP-Norm=2.475 | FP-Norm(final)=2.050 | 1721.8 samples/s | 26.9 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01829 | Reg=0.00613 | acc=1.0000 | FP-Norm=2.452 | FP-Norm(final)=2.055 | 3642.5 samples/s | 56.9 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01703 | Reg=0.00602 | acc=1.0000 | FP-Norm=2.430 | FP-Norm(final)=2.060 | 1783.0 samples/s | 27.9 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01870 | Reg=0.00638 | acc=1.0000 | FP-Norm=2.491 | FP-Norm(final)=2.062 | 3794.9 samples/s | 59.3 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01755 | Reg=0.00683 | acc=1.0000 | FP-Norm=2.566 | FP-Norm(final)=2.065 | 1760.7 samples/s | 27.5 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01653 | Reg=0.00710 | acc=1.0000 | FP-Norm=2.615 | FP-Norm(final)=2.068 | 3634.2 samples/s | 56.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.41976 | Reg=0.00000 | acc=0.5469 | FP-Norm=0.000 | FP-Norm(final)=1.932 | 3524.5 samples/s | 55.1 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.16794 | Reg=0.00341 | acc=0.9844 | FP-Norm=1.710 | FP-Norm(final)=1.942 | 3730.2 samples/s | 58.3 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.09817 | Reg=0.00515 | acc=1.0000 | FP-Norm=2.168 | FP-Norm(final)=1.966 | 4936.4 samples/s | 77.1 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.06802 | Reg=0.00586 | acc=1.0000 | FP-Norm=2.345 | FP-Norm(final)=1.984 | 1596.7 samples/s | 24.9 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.05304 | Reg=0.00623 | acc=1.0000 | FP-Norm=2.437 | FP-Norm(final)=1.998 | 4441.5 samples/s | 69.4 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.04323 | Reg=0.00660 | acc=1.0000 | FP-Norm=2.516 | FP-Norm(final)=2.011 | 1661.7 samples/s | 26.0 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.03625 | Reg=0.00677 | acc=1.0000 | FP-Norm=2.558 | FP-Norm(final)=2.021 | 4144.2 samples/s | 64.8 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.03115 | Reg=0.00679 | acc=1.0000 | FP-Norm=2.567 | FP-Norm(final)=2.031 | 1667.6 samples/s | 26.1 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02732 | Reg=0.00671 | acc=1.0000 | FP-Norm=2.556 | FP-Norm(final)=2.038 | 3943.6 samples/s | 61.6 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02435 | Reg=0.00660 | acc=1.0000 | FP-Norm=2.537 | FP-Norm(final)=2.045 | 1681.0 samples/s | 26.3 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.02196 | Reg=0.00647 | acc=1.0000 | FP-Norm=2.514 | FP-Norm(final)=2.051 | 3733.5 samples/s | 58.3 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.02001 | Reg=0.00633 | acc=1.0000 | FP-Norm=2.488 | FP-Norm(final)=2.057 | 1738.4 samples/s | 27.2 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01838 | Reg=0.00620 | acc=1.0000 | FP-Norm=2.462 | FP-Norm(final)=2.063 | 3737.2 samples/s | 58.4 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01699 | Reg=0.00607 | acc=1.0000 | FP-Norm=2.436 | FP-Norm(final)=2.068 | 1787.3 samples/s | 27.9 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01581 | Reg=0.00594 | acc=1.0000 | FP-Norm=2.410 | FP-Norm(final)=2.074 | 3684.5 samples/s | 57.6 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01480 | Reg=0.00583 | acc=1.0000 | FP-Norm=2.387 | FP-Norm(final)=2.079 | 1793.2 samples/s | 28.0 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01390 | Reg=0.00573 | acc=1.0000 | FP-Norm=2.366 | FP-Norm(final)=2.084 | 3751.0 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.42790 | Reg=0.00000 | acc=0.5781 | FP-Norm=0.000 | FP-Norm(final)=1.932 | 3737.5 samples/s | 58.4 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.15831 | Reg=0.00367 | acc=0.9844 | FP-Norm=1.780 | FP-Norm(final)=1.950 | 3450.5 samples/s | 53.9 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.09070 | Reg=0.00532 | acc=1.0000 | FP-Norm=2.210 | FP-Norm(final)=1.973 | 4899.7 samples/s | 76.6 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.06727 | Reg=0.00629 | acc=1.0000 | FP-Norm=2.429 | FP-Norm(final)=1.990 | 1582.9 samples/s | 24.7 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.05181 | Reg=0.00685 | acc=1.0000 | FP-Norm=2.551 | FP-Norm(final)=2.002 | 4495.0 samples/s | 70.2 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.04183 | Reg=0.00705 | acc=1.0000 | FP-Norm=2.601 | FP-Norm(final)=2.012 | 1625.5 samples/s | 25.4 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.03501 | Reg=0.00707 | acc=1.0000 | FP-Norm=2.614 | FP-Norm(final)=2.020 | 4382.1 samples/s | 68.5 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.03008 | Reg=0.00699 | acc=1.0000 | FP-Norm=2.606 | FP-Norm(final)=2.027 | 1660.7 samples/s | 25.9 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02641 | Reg=0.00687 | acc=1.0000 | FP-Norm=2.586 | FP-Norm(final)=2.033 | 4078.3 samples/s | 63.7 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02353 | Reg=0.00673 | acc=1.0000 | FP-Norm=2.563 | FP-Norm(final)=2.039 | 1727.1 samples/s | 27.0 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.02126 | Reg=0.00659 | acc=1.0000 | FP-Norm=2.537 | FP-Norm(final)=2.044 | 4019.0 samples/s | 62.8 steps/s
[Step= 550 Epoch= 5.3] | Loss=0.01938 | Reg=0.00646 | acc=1.0000 | FP-Norm=2.513 | FP-Norm(final)=2.050 | 1706.5 samples/s | 26.7 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01781 | Reg=0.00633 | acc=1.0000 | FP-Norm=2.489 | FP-Norm(final)=2.054 | 3737.6 samples/s | 58.4 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01647 | Reg=0.00621 | acc=1.0000 | FP-Norm=2.464 | FP-Norm(final)=2.059 | 1774.4 samples/s | 27.7 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01533 | Reg=0.00609 | acc=1.0000 | FP-Norm=2.440 | FP-Norm(final)=2.064 | 3793.3 samples/s | 59.3 steps/s
[Step= 750 Epoch= 7.2] | Loss=0.01437 | Reg=0.00599 | acc=1.0000 | FP-Norm=2.421 | FP-Norm(final)=2.068 | 1776.1 samples/s | 27.8 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01349 | Reg=0.00589 | acc=1.0000 | FP-Norm=2.401 | FP-Norm(final)=2.072 | 3727.6 samples/s | 58.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.43078 | Reg=0.00000 | acc=0.5469 | FP-Norm=0.000 | FP-Norm(final)=1.932 | 3794.2 samples/s | 59.3 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.17133 | Reg=0.00326 | acc=0.9688 | FP-Norm=1.684 | FP-Norm(final)=1.943 | 3282.8 samples/s | 51.3 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.10228 | Reg=0.00513 | acc=1.0000 | FP-Norm=2.165 | FP-Norm(final)=1.967 | 4715.7 samples/s | 73.7 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.07140 | Reg=0.00605 | acc=1.0000 | FP-Norm=2.378 | FP-Norm(final)=1.984 | 1597.0 samples/s | 25.0 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.05618 | Reg=0.00652 | acc=1.0000 | FP-Norm=2.488 | FP-Norm(final)=1.997 | 4350.2 samples/s | 68.0 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.04545 | Reg=0.00682 | acc=1.0000 | FP-Norm=2.557 | FP-Norm(final)=2.008 | 1624.4 samples/s | 25.4 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.03810 | Reg=0.00690 | acc=1.0000 | FP-Norm=2.581 | FP-Norm(final)=2.017 | 4059.1 samples/s | 63.4 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.03275 | Reg=0.00687 | acc=1.0000 | FP-Norm=2.582 | FP-Norm(final)=2.025 | 1677.6 samples/s | 26.2 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02872 | Reg=0.00677 | acc=1.0000 | FP-Norm=2.568 | FP-Norm(final)=2.032 | 3786.7 samples/s | 59.2 steps/s
[Step= 450 Epoch= 4.2] | Loss=0.02559 | Reg=0.00665 | acc=1.0000 | FP-Norm=2.547 | FP-Norm(final)=2.038 | 1744.0 samples/s | 27.2 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.02309 | Reg=0.00652 | acc=1.0000 | FP-Norm=2.523 | FP-Norm(final)=2.043 | 3774.5 samples/s | 59.0 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.02105 | Reg=0.00639 | acc=1.0000 | FP-Norm=2.498 | FP-Norm(final)=2.049 | 1792.2 samples/s | 28.0 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01934 | Reg=0.00626 | acc=1.0000 | FP-Norm=2.474 | FP-Norm(final)=2.054 | 3733.9 samples/s | 58.3 steps/s
[Step= 650 Epoch= 6.1] | Loss=0.01790 | Reg=0.00614 | acc=1.0000 | FP-Norm=2.451 | FP-Norm(final)=2.059 | 1807.6 samples/s | 28.2 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01665 | Reg=0.00603 | acc=1.0000 | FP-Norm=2.429 | FP-Norm(final)=2.064 | 3652.5 samples/s | 57.1 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01557 | Reg=0.00592 | acc=1.0000 | FP-Norm=2.406 | FP-Norm(final)=2.068 | 1867.4 samples/s | 29.2 steps/s
[Step= 800 Epoch= 7.5] | Loss=0.01463 | Reg=0.00581 | acc=1.0000 | FP-Norm=2.383 | FP-Norm(final)=2.073 | 3295.3 samples/s | 51.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.46494 | Reg=0.00000 | acc=0.4375 | FP-Norm=0.000 | FP-Norm(final)=1.933 | 3824.4 samples/s | 59.8 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.18129 | Reg=0.00326 | acc=0.9375 | FP-Norm=1.674 | FP-Norm(final)=1.945 | 3362.3 samples/s | 52.5 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.10263 | Reg=0.00508 | acc=1.0000 | FP-Norm=2.149 | FP-Norm(final)=1.969 | 4923.4 samples/s | 76.9 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.07291 | Reg=0.00589 | acc=0.9688 | FP-Norm=2.347 | FP-Norm(final)=1.988 | 1596.7 samples/s | 24.9 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.05567 | Reg=0.00638 | acc=1.0000 | FP-Norm=2.460 | FP-Norm(final)=2.001 | 4527.7 samples/s | 70.7 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.04479 | Reg=0.00657 | acc=1.0000 | FP-Norm=2.510 | FP-Norm(final)=2.013 | 1629.2 samples/s | 25.5 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.03751 | Reg=0.00658 | acc=1.0000 | FP-Norm=2.521 | FP-Norm(final)=2.022 | 4350.4 samples/s | 68.0 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.03225 | Reg=0.00651 | acc=1.0000 | FP-Norm=2.514 | FP-Norm(final)=2.031 | 1671.9 samples/s | 26.1 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02830 | Reg=0.00640 | acc=1.0000 | FP-Norm=2.496 | FP-Norm(final)=2.038 | 4147.0 samples/s | 64.8 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02522 | Reg=0.00628 | acc=1.0000 | FP-Norm=2.475 | FP-Norm(final)=2.045 | 1695.9 samples/s | 26.5 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.02275 | Reg=0.00615 | acc=1.0000 | FP-Norm=2.450 | FP-Norm(final)=2.051 | 3876.8 samples/s | 60.6 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.02074 | Reg=0.00602 | acc=1.0000 | FP-Norm=2.424 | FP-Norm(final)=2.056 | 1700.8 samples/s | 26.6 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01904 | Reg=0.00589 | acc=1.0000 | FP-Norm=2.399 | FP-Norm(final)=2.062 | 3806.4 samples/s | 59.5 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01762 | Reg=0.00577 | acc=1.0000 | FP-Norm=2.374 | FP-Norm(final)=2.067 | 1754.1 samples/s | 27.4 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01639 | Reg=0.00565 | acc=1.0000 | FP-Norm=2.350 | FP-Norm(final)=2.072 | 3637.8 samples/s | 56.8 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01534 | Reg=0.00554 | acc=1.0000 | FP-Norm=2.327 | FP-Norm(final)=2.077 | 1769.4 samples/s | 27.6 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01727 | Reg=0.00575 | acc=1.0000 | FP-Norm=2.360 | FP-Norm(final)=2.079 | 3705.5 samples/s | 57.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30248 | acc=0.6661 | tpr=0.6214 | fpr=0.2369 | 3817.8 samples/s | 14.9 steps/s
Avg test loss: 0.30300, Avg test acc: 0.66676, Avg tpr: 0.62441, Avg fpr: 0.24010, total FA: 1873

Testing server on iccad2012
[Step=  50] | Loss=0.28950 | acc=0.7515 | tpr=0.9336 | fpr=0.2518 | 3789.2 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.29084 | acc=0.7520 | tpr=0.9254 | fpr=0.2512 | 7195.9 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.29181 | acc=0.7498 | tpr=0.9294 | fpr=0.2535 | 7197.3 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.29207 | acc=0.7491 | tpr=0.9333 | fpr=0.2542 | 7147.0 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.29180 | acc=0.7499 | tpr=0.9345 | fpr=0.2535 | 7168.0 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.29191 | acc=0.7493 | tpr=0.9302 | fpr=0.2540 | 7419.5 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.29187 | acc=0.7497 | tpr=0.9311 | fpr=0.2536 | 6803.4 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.29270 | acc=0.7487 | tpr=0.9316 | fpr=0.2546 | 7132.1 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.29294 | acc=0.7488 | tpr=0.9304 | fpr=0.2545 | 7061.7 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.29276 | acc=0.7487 | tpr=0.9282 | fpr=0.2545 | 6994.3 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.29252 | acc=0.7494 | tpr=0.9284 | fpr=0.2538 | 13098.0 samples/s | 51.2 steps/s
Avg test loss: 0.29246, Avg test acc: 0.74943, Avg tpr: 0.92789, Avg fpr: 0.25381, total FA: 35241

server round 1/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.28910 | Reg=0.00000 | acc=0.6875 | FP-Norm=0.000 | FP-Norm(final)=2.140 | 3712.2 samples/s | 58.0 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.17861 | Reg=0.00329 | acc=0.9062 | FP-Norm=1.716 | FP-Norm(final)=2.152 | 3769.0 samples/s | 58.9 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.15623 | Reg=0.00386 | acc=0.8750 | FP-Norm=1.910 | FP-Norm(final)=2.153 | 3859.6 samples/s | 60.3 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.14159 | Reg=0.00419 | acc=0.9688 | FP-Norm=2.008 | FP-Norm(final)=2.156 | 3842.2 samples/s | 60.0 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.13021 | Reg=0.00459 | acc=0.9531 | FP-Norm=2.107 | FP-Norm(final)=2.163 | 4969.7 samples/s | 77.7 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.12081 | Reg=0.00504 | acc=0.9688 | FP-Norm=2.209 | FP-Norm(final)=2.170 | 1697.7 samples/s | 26.5 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.11164 | Reg=0.00550 | acc=0.9375 | FP-Norm=2.306 | FP-Norm(final)=2.176 | 3984.5 samples/s | 62.3 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.10546 | Reg=0.00589 | acc=0.9688 | FP-Norm=2.386 | FP-Norm(final)=2.183 | 3926.7 samples/s | 61.4 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.10029 | Reg=0.00625 | acc=0.9531 | FP-Norm=2.458 | FP-Norm(final)=2.189 | 4742.4 samples/s | 74.1 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.09585 | Reg=0.00664 | acc=1.0000 | FP-Norm=2.532 | FP-Norm(final)=2.195 | 1721.6 samples/s | 26.9 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.09174 | Reg=0.00703 | acc=0.9375 | FP-Norm=2.603 | FP-Norm(final)=2.200 | 3948.0 samples/s | 61.7 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08826 | Reg=0.00739 | acc=0.9531 | FP-Norm=2.668 | FP-Norm(final)=2.206 | 3970.7 samples/s | 62.0 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.08474 | Reg=0.00773 | acc=0.9219 | FP-Norm=2.728 | FP-Norm(final)=2.211 | 4477.9 samples/s | 70.0 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.08102 | Reg=0.00804 | acc=0.9375 | FP-Norm=2.783 | FP-Norm(final)=2.217 | 1757.9 samples/s | 27.5 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.07736 | Reg=0.00833 | acc=1.0000 | FP-Norm=2.832 | FP-Norm(final)=2.222 | 3869.4 samples/s | 60.5 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07476 | Reg=0.00861 | acc=0.9844 | FP-Norm=2.878 | FP-Norm(final)=2.228 | 3856.9 samples/s | 60.3 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.07235 | Reg=0.00887 | acc=0.9375 | FP-Norm=2.923 | FP-Norm(final)=2.234 | 4167.8 samples/s | 65.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step1600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.33166 | Reg=0.00000 | acc=0.5938 | FP-Norm=0.000 | FP-Norm(final)=2.139 | 3802.8 samples/s | 59.4 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.20341 | Reg=0.00332 | acc=0.8594 | FP-Norm=1.711 | FP-Norm(final)=2.134 | 3740.5 samples/s | 58.4 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.16923 | Reg=0.00417 | acc=0.9531 | FP-Norm=1.976 | FP-Norm(final)=2.139 | 3811.4 samples/s | 59.6 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.15100 | Reg=0.00469 | acc=0.9062 | FP-Norm=2.116 | FP-Norm(final)=2.147 | 3860.4 samples/s | 60.3 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.13893 | Reg=0.00510 | acc=0.9375 | FP-Norm=2.216 | FP-Norm(final)=2.152 | 4972.3 samples/s | 77.7 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.12522 | Reg=0.00553 | acc=0.9219 | FP-Norm=2.310 | FP-Norm(final)=2.160 | 1685.2 samples/s | 26.3 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.11495 | Reg=0.00596 | acc=0.9844 | FP-Norm=2.400 | FP-Norm(final)=2.169 | 3954.8 samples/s | 61.8 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.10880 | Reg=0.00637 | acc=0.9531 | FP-Norm=2.481 | FP-Norm(final)=2.177 | 3929.0 samples/s | 61.4 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.10395 | Reg=0.00675 | acc=0.9219 | FP-Norm=2.556 | FP-Norm(final)=2.185 | 4711.4 samples/s | 73.6 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.09803 | Reg=0.00711 | acc=0.9531 | FP-Norm=2.622 | FP-Norm(final)=2.192 | 1702.2 samples/s | 26.6 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.09269 | Reg=0.00746 | acc=0.9688 | FP-Norm=2.686 | FP-Norm(final)=2.199 | 3842.8 samples/s | 60.0 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08838 | Reg=0.00781 | acc=0.9219 | FP-Norm=2.748 | FP-Norm(final)=2.207 | 3935.0 samples/s | 61.5 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.08527 | Reg=0.00814 | acc=0.9219 | FP-Norm=2.804 | FP-Norm(final)=2.215 | 4514.7 samples/s | 70.5 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.08175 | Reg=0.00845 | acc=0.9688 | FP-Norm=2.857 | FP-Norm(final)=2.221 | 1734.3 samples/s | 27.1 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.07867 | Reg=0.00875 | acc=0.9688 | FP-Norm=2.908 | FP-Norm(final)=2.228 | 3967.1 samples/s | 62.0 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07583 | Reg=0.00905 | acc=0.9844 | FP-Norm=2.956 | FP-Norm(final)=2.235 | 3967.1 samples/s | 62.0 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.07350 | Reg=0.00933 | acc=0.9844 | FP-Norm=3.000 | FP-Norm(final)=2.242 | 4412.6 samples/s | 68.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step1600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.27004 | Reg=0.00000 | acc=0.7188 | FP-Norm=0.000 | FP-Norm(final)=2.140 | 3724.9 samples/s | 58.2 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.18520 | Reg=0.00282 | acc=0.8750 | FP-Norm=1.590 | FP-Norm(final)=2.146 | 3796.5 samples/s | 59.3 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.16393 | Reg=0.00334 | acc=0.9375 | FP-Norm=1.776 | FP-Norm(final)=2.149 | 3994.0 samples/s | 62.4 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.15568 | Reg=0.00381 | acc=0.8906 | FP-Norm=1.910 | FP-Norm(final)=2.152 | 3957.5 samples/s | 61.8 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.14273 | Reg=0.00428 | acc=0.9062 | FP-Norm=2.030 | FP-Norm(final)=2.155 | 5132.1 samples/s | 80.2 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.12899 | Reg=0.00473 | acc=0.9219 | FP-Norm=2.134 | FP-Norm(final)=2.162 | 1673.0 samples/s | 26.1 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.11944 | Reg=0.00515 | acc=0.9688 | FP-Norm=2.228 | FP-Norm(final)=2.170 | 3980.7 samples/s | 62.2 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.11221 | Reg=0.00559 | acc=0.9688 | FP-Norm=2.319 | FP-Norm(final)=2.179 | 3954.0 samples/s | 61.8 steps/s
[Step=1200 Epoch= 5.8] | Loss=0.10697 | Reg=0.00601 | acc=0.9844 | FP-Norm=2.402 | FP-Norm(final)=2.187 | 4801.3 samples/s | 75.0 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.10080 | Reg=0.00640 | acc=0.9688 | FP-Norm=2.479 | FP-Norm(final)=2.194 | 1687.7 samples/s | 26.4 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.09521 | Reg=0.00679 | acc=1.0000 | FP-Norm=2.551 | FP-Norm(final)=2.202 | 3856.3 samples/s | 60.3 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.09202 | Reg=0.00718 | acc=0.9688 | FP-Norm=2.623 | FP-Norm(final)=2.210 | 3848.2 samples/s | 60.1 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.08879 | Reg=0.00757 | acc=0.9844 | FP-Norm=2.691 | FP-Norm(final)=2.217 | 4357.2 samples/s | 68.1 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.08579 | Reg=0.00793 | acc=0.9688 | FP-Norm=2.754 | FP-Norm(final)=2.223 | 1738.3 samples/s | 27.2 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.08249 | Reg=0.00829 | acc=0.9844 | FP-Norm=2.813 | FP-Norm(final)=2.230 | 3846.9 samples/s | 60.1 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07905 | Reg=0.00861 | acc=0.9844 | FP-Norm=2.868 | FP-Norm(final)=2.236 | 3869.9 samples/s | 60.5 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.07656 | Reg=0.00892 | acc=0.9531 | FP-Norm=2.918 | FP-Norm(final)=2.243 | 4143.4 samples/s | 64.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step1600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.26767 | Reg=0.00000 | acc=0.7812 | FP-Norm=0.000 | FP-Norm(final)=2.140 | 3592.2 samples/s | 56.1 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.18084 | Reg=0.00329 | acc=0.9375 | FP-Norm=1.727 | FP-Norm(final)=2.146 | 3870.1 samples/s | 60.5 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.15975 | Reg=0.00392 | acc=1.0000 | FP-Norm=1.929 | FP-Norm(final)=2.152 | 3839.6 samples/s | 60.0 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.14412 | Reg=0.00433 | acc=0.9219 | FP-Norm=2.043 | FP-Norm(final)=2.158 | 3847.0 samples/s | 60.1 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.13266 | Reg=0.00474 | acc=0.8750 | FP-Norm=2.142 | FP-Norm(final)=2.165 | 4981.3 samples/s | 77.8 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.11962 | Reg=0.00518 | acc=1.0000 | FP-Norm=2.241 | FP-Norm(final)=2.172 | 1696.1 samples/s | 26.5 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.11090 | Reg=0.00558 | acc=0.9531 | FP-Norm=2.326 | FP-Norm(final)=2.181 | 3950.9 samples/s | 61.7 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.10429 | Reg=0.00597 | acc=0.9844 | FP-Norm=2.406 | FP-Norm(final)=2.188 | 3903.0 samples/s | 61.0 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.09986 | Reg=0.00636 | acc=0.9688 | FP-Norm=2.482 | FP-Norm(final)=2.195 | 4673.6 samples/s | 73.0 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.09376 | Reg=0.00673 | acc=0.9844 | FP-Norm=2.552 | FP-Norm(final)=2.202 | 1719.4 samples/s | 26.9 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.08832 | Reg=0.00708 | acc=0.9375 | FP-Norm=2.616 | FP-Norm(final)=2.210 | 3900.4 samples/s | 60.9 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08446 | Reg=0.00741 | acc=0.9688 | FP-Norm=2.677 | FP-Norm(final)=2.218 | 3836.5 samples/s | 59.9 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.08102 | Reg=0.00771 | acc=0.9531 | FP-Norm=2.730 | FP-Norm(final)=2.225 | 4390.4 samples/s | 68.6 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07727 | Reg=0.00801 | acc=1.0000 | FP-Norm=2.782 | FP-Norm(final)=2.233 | 1730.8 samples/s | 27.0 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.07376 | Reg=0.00829 | acc=1.0000 | FP-Norm=2.830 | FP-Norm(final)=2.241 | 3869.2 samples/s | 60.5 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07110 | Reg=0.00856 | acc=0.9375 | FP-Norm=2.875 | FP-Norm(final)=2.248 | 3837.6 samples/s | 60.0 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06912 | Reg=0.00880 | acc=0.9688 | FP-Norm=2.916 | FP-Norm(final)=2.255 | 4128.4 samples/s | 64.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step1600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.26860 | Reg=0.00000 | acc=0.7812 | FP-Norm=0.000 | FP-Norm(final)=2.139 | 3826.8 samples/s | 59.8 steps/s
[Step= 850 Epoch= 4.2] | Loss=0.17951 | Reg=0.00294 | acc=0.9062 | FP-Norm=1.605 | FP-Norm(final)=2.151 | 3705.1 samples/s | 57.9 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.15443 | Reg=0.00380 | acc=0.8906 | FP-Norm=1.883 | FP-Norm(final)=2.157 | 3849.7 samples/s | 60.2 steps/s
[Step= 950 Epoch= 4.7] | Loss=0.13823 | Reg=0.00434 | acc=0.9531 | FP-Norm=2.031 | FP-Norm(final)=2.163 | 3857.0 samples/s | 60.3 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.13228 | Reg=0.00480 | acc=0.8750 | FP-Norm=2.144 | FP-Norm(final)=2.167 | 5018.0 samples/s | 78.4 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.12029 | Reg=0.00525 | acc=0.9219 | FP-Norm=2.247 | FP-Norm(final)=2.173 | 1659.2 samples/s | 25.9 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.11115 | Reg=0.00568 | acc=0.9375 | FP-Norm=2.338 | FP-Norm(final)=2.182 | 3746.0 samples/s | 58.5 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.10488 | Reg=0.00610 | acc=0.9688 | FP-Norm=2.424 | FP-Norm(final)=2.190 | 3770.6 samples/s | 58.9 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.10078 | Reg=0.00647 | acc=0.9375 | FP-Norm=2.497 | FP-Norm(final)=2.197 | 4675.5 samples/s | 73.1 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.09462 | Reg=0.00683 | acc=1.0000 | FP-Norm=2.566 | FP-Norm(final)=2.203 | 1659.1 samples/s | 25.9 steps/s
[Step=1300 Epoch= 6.4] | Loss=0.08997 | Reg=0.00718 | acc=0.9062 | FP-Norm=2.630 | FP-Norm(final)=2.211 | 3770.8 samples/s | 58.9 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08644 | Reg=0.00751 | acc=0.9844 | FP-Norm=2.691 | FP-Norm(final)=2.218 | 3801.1 samples/s | 59.4 steps/s
[Step=1400 Epoch= 6.9] | Loss=0.08293 | Reg=0.00783 | acc=1.0000 | FP-Norm=2.747 | FP-Norm(final)=2.225 | 4522.3 samples/s | 70.7 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07922 | Reg=0.00814 | acc=0.9531 | FP-Norm=2.800 | FP-Norm(final)=2.232 | 1681.2 samples/s | 26.3 steps/s
[Step=1500 Epoch= 7.4] | Loss=0.07555 | Reg=0.00843 | acc=0.9688 | FP-Norm=2.849 | FP-Norm(final)=2.240 | 3852.4 samples/s | 60.2 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07263 | Reg=0.00870 | acc=1.0000 | FP-Norm=2.895 | FP-Norm(final)=2.247 | 3878.2 samples/s | 60.6 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.07124 | Reg=0.00896 | acc=0.9844 | FP-Norm=2.938 | FP-Norm(final)=2.254 | 4404.7 samples/s | 68.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step1600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.16563 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.139 | 3636.0 samples/s | 56.8 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.04620 | Reg=0.00442 | acc=1.0000 | FP-Norm=1.991 | FP-Norm(final)=2.149 | 3512.4 samples/s | 54.9 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.02484 | Reg=0.00478 | acc=1.0000 | FP-Norm=2.129 | FP-Norm(final)=2.166 | 4770.1 samples/s | 74.5 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01828 | Reg=0.00463 | acc=1.0000 | FP-Norm=2.113 | FP-Norm(final)=2.178 | 1621.6 samples/s | 25.3 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01416 | Reg=0.00462 | acc=1.0000 | FP-Norm=2.121 | FP-Norm(final)=2.185 | 4404.5 samples/s | 68.8 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01149 | Reg=0.00454 | acc=1.0000 | FP-Norm=2.107 | FP-Norm(final)=2.192 | 1621.4 samples/s | 25.3 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00965 | Reg=0.00441 | acc=1.0000 | FP-Norm=2.078 | FP-Norm(final)=2.198 | 4163.4 samples/s | 65.1 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00830 | Reg=0.00426 | acc=1.0000 | FP-Norm=2.045 | FP-Norm(final)=2.203 | 1672.2 samples/s | 26.1 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00729 | Reg=0.00412 | acc=1.0000 | FP-Norm=2.009 | FP-Norm(final)=2.206 | 3865.3 samples/s | 60.4 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00650 | Reg=0.00398 | acc=1.0000 | FP-Norm=1.974 | FP-Norm(final)=2.210 | 1693.1 samples/s | 26.5 steps/s
[Step=1300 Epoch=12.3] | Loss=0.00587 | Reg=0.00384 | acc=1.0000 | FP-Norm=1.939 | FP-Norm(final)=2.213 | 3732.5 samples/s | 58.3 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00536 | Reg=0.00372 | acc=1.0000 | FP-Norm=1.905 | FP-Norm(final)=2.216 | 1755.5 samples/s | 27.4 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00493 | Reg=0.00360 | acc=1.0000 | FP-Norm=1.873 | FP-Norm(final)=2.219 | 3721.6 samples/s | 58.2 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00457 | Reg=0.00349 | acc=1.0000 | FP-Norm=1.843 | FP-Norm(final)=2.221 | 1780.2 samples/s | 27.8 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00426 | Reg=0.00339 | acc=1.0000 | FP-Norm=1.814 | FP-Norm(final)=2.224 | 3690.4 samples/s | 57.7 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00399 | Reg=0.00330 | acc=1.0000 | FP-Norm=1.787 | FP-Norm(final)=2.226 | 1813.9 samples/s | 28.3 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00375 | Reg=0.00321 | acc=1.0000 | FP-Norm=1.761 | FP-Norm(final)=2.228 | 3746.8 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step1600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.20392 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.138 | 3725.9 samples/s | 58.2 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.06742 | Reg=0.00755 | acc=1.0000 | FP-Norm=2.593 | FP-Norm(final)=2.133 | 3568.8 samples/s | 55.8 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.03777 | Reg=0.00882 | acc=1.0000 | FP-Norm=2.884 | FP-Norm(final)=2.137 | 4931.8 samples/s | 77.1 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.02700 | Reg=0.00889 | acc=1.0000 | FP-Norm=2.925 | FP-Norm(final)=2.144 | 1604.4 samples/s | 25.1 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.02047 | Reg=0.00866 | acc=1.0000 | FP-Norm=2.899 | FP-Norm(final)=2.151 | 4459.0 samples/s | 69.7 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01647 | Reg=0.00832 | acc=1.0000 | FP-Norm=2.846 | FP-Norm(final)=2.159 | 1643.3 samples/s | 25.7 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01376 | Reg=0.00795 | acc=1.0000 | FP-Norm=2.784 | FP-Norm(final)=2.165 | 4212.6 samples/s | 65.8 steps/s
[Step=1150 Epoch=10.9] | Loss=0.01183 | Reg=0.00759 | acc=1.0000 | FP-Norm=2.720 | FP-Norm(final)=2.171 | 1702.8 samples/s | 26.6 steps/s
[Step=1200 Epoch=11.4] | Loss=0.01039 | Reg=0.00726 | acc=1.0000 | FP-Norm=2.657 | FP-Norm(final)=2.176 | 4054.4 samples/s | 63.4 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00926 | Reg=0.00695 | acc=1.0000 | FP-Norm=2.597 | FP-Norm(final)=2.181 | 1743.7 samples/s | 27.2 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00836 | Reg=0.00667 | acc=1.0000 | FP-Norm=2.541 | FP-Norm(final)=2.185 | 3808.9 samples/s | 59.5 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00762 | Reg=0.00641 | acc=1.0000 | FP-Norm=2.488 | FP-Norm(final)=2.189 | 1741.0 samples/s | 27.2 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00701 | Reg=0.00617 | acc=1.0000 | FP-Norm=2.437 | FP-Norm(final)=2.193 | 3674.2 samples/s | 57.4 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00649 | Reg=0.00595 | acc=1.0000 | FP-Norm=2.389 | FP-Norm(final)=2.197 | 1808.8 samples/s | 28.3 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00604 | Reg=0.00575 | acc=1.0000 | FP-Norm=2.344 | FP-Norm(final)=2.201 | 3740.0 samples/s | 58.4 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00565 | Reg=0.00556 | acc=1.0000 | FP-Norm=2.302 | FP-Norm(final)=2.204 | 1773.0 samples/s | 27.7 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00531 | Reg=0.00538 | acc=1.0000 | FP-Norm=2.261 | FP-Norm(final)=2.208 | 3654.7 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step1600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.22372 | Reg=0.00000 | acc=0.7344 | FP-Norm=0.000 | FP-Norm(final)=2.139 | 3708.1 samples/s | 57.9 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.04576 | Reg=0.00617 | acc=1.0000 | FP-Norm=2.365 | FP-Norm(final)=2.146 | 3481.4 samples/s | 54.4 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.02573 | Reg=0.00693 | acc=1.0000 | FP-Norm=2.568 | FP-Norm(final)=2.154 | 4802.2 samples/s | 75.0 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.01736 | Reg=0.00677 | acc=1.0000 | FP-Norm=2.558 | FP-Norm(final)=2.163 | 1578.3 samples/s | 24.7 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01312 | Reg=0.00644 | acc=1.0000 | FP-Norm=2.502 | FP-Norm(final)=2.170 | 4534.3 samples/s | 70.8 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01054 | Reg=0.00609 | acc=1.0000 | FP-Norm=2.435 | FP-Norm(final)=2.176 | 1627.7 samples/s | 25.4 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00881 | Reg=0.00576 | acc=1.0000 | FP-Norm=2.367 | FP-Norm(final)=2.180 | 4286.0 samples/s | 67.0 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00758 | Reg=0.00547 | acc=1.0000 | FP-Norm=2.304 | FP-Norm(final)=2.184 | 1666.9 samples/s | 26.0 steps/s
[Step=1200 Epoch=11.5] | Loss=0.00666 | Reg=0.00520 | acc=1.0000 | FP-Norm=2.245 | FP-Norm(final)=2.188 | 4104.3 samples/s | 64.1 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00595 | Reg=0.00497 | acc=1.0000 | FP-Norm=2.191 | FP-Norm(final)=2.191 | 1728.8 samples/s | 27.0 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00538 | Reg=0.00476 | acc=1.0000 | FP-Norm=2.141 | FP-Norm(final)=2.195 | 3946.4 samples/s | 61.7 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00491 | Reg=0.00457 | acc=1.0000 | FP-Norm=2.094 | FP-Norm(final)=2.198 | 1727.6 samples/s | 27.0 steps/s
[Step=1400 Epoch=13.4] | Loss=0.00452 | Reg=0.00439 | acc=1.0000 | FP-Norm=2.051 | FP-Norm(final)=2.201 | 3850.9 samples/s | 60.2 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00418 | Reg=0.00423 | acc=1.0000 | FP-Norm=2.010 | FP-Norm(final)=2.204 | 1792.7 samples/s | 28.0 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00390 | Reg=0.00409 | acc=1.0000 | FP-Norm=1.972 | FP-Norm(final)=2.207 | 3689.2 samples/s | 57.6 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00365 | Reg=0.00395 | acc=1.0000 | FP-Norm=1.936 | FP-Norm(final)=2.210 | 1825.1 samples/s | 28.5 steps/s
[Step=1600 Epoch=15.3] | Loss=0.00344 | Reg=0.00383 | acc=1.0000 | FP-Norm=1.903 | FP-Norm(final)=2.212 | 3804.2 samples/s | 59.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step1600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.5] | Loss=0.20654 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.138 | 3904.5 samples/s | 61.0 steps/s
[Step= 850 Epoch= 8.0] | Loss=0.05383 | Reg=0.00597 | acc=0.9844 | FP-Norm=2.325 | FP-Norm(final)=2.141 | 3461.6 samples/s | 54.1 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.03019 | Reg=0.00676 | acc=0.9844 | FP-Norm=2.537 | FP-Norm(final)=2.148 | 4900.1 samples/s | 76.6 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.02061 | Reg=0.00661 | acc=1.0000 | FP-Norm=2.528 | FP-Norm(final)=2.156 | 1616.4 samples/s | 25.3 steps/s
[Step=1000 Epoch= 9.4] | Loss=0.01570 | Reg=0.00633 | acc=1.0000 | FP-Norm=2.482 | FP-Norm(final)=2.163 | 4357.5 samples/s | 68.1 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01264 | Reg=0.00603 | acc=1.0000 | FP-Norm=2.426 | FP-Norm(final)=2.169 | 1668.6 samples/s | 26.1 steps/s
[Step=1100 Epoch=10.4] | Loss=0.01057 | Reg=0.00574 | acc=1.0000 | FP-Norm=2.367 | FP-Norm(final)=2.175 | 4097.8 samples/s | 64.0 steps/s
[Step=1150 Epoch=10.8] | Loss=0.00910 | Reg=0.00547 | acc=1.0000 | FP-Norm=2.309 | FP-Norm(final)=2.180 | 1731.9 samples/s | 27.1 steps/s
[Step=1200 Epoch=11.3] | Loss=0.00799 | Reg=0.00523 | acc=1.0000 | FP-Norm=2.254 | FP-Norm(final)=2.184 | 3832.3 samples/s | 59.9 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00713 | Reg=0.00500 | acc=1.0000 | FP-Norm=2.203 | FP-Norm(final)=2.188 | 1767.5 samples/s | 27.6 steps/s
[Step=1300 Epoch=12.2] | Loss=0.00645 | Reg=0.00480 | acc=1.0000 | FP-Norm=2.154 | FP-Norm(final)=2.192 | 3677.4 samples/s | 57.5 steps/s
[Step=1350 Epoch=12.7] | Loss=0.00588 | Reg=0.00461 | acc=1.0000 | FP-Norm=2.110 | FP-Norm(final)=2.195 | 1768.1 samples/s | 27.6 steps/s
[Step=1400 Epoch=13.2] | Loss=0.00541 | Reg=0.00444 | acc=1.0000 | FP-Norm=2.067 | FP-Norm(final)=2.199 | 3765.9 samples/s | 58.8 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00502 | Reg=0.00429 | acc=1.0000 | FP-Norm=2.028 | FP-Norm(final)=2.202 | 1834.9 samples/s | 28.7 steps/s
[Step=1500 Epoch=14.1] | Loss=0.00468 | Reg=0.00415 | acc=1.0000 | FP-Norm=1.993 | FP-Norm(final)=2.205 | 3655.4 samples/s | 57.1 steps/s
[Step=1550 Epoch=14.6] | Loss=0.00439 | Reg=0.00402 | acc=1.0000 | FP-Norm=1.959 | FP-Norm(final)=2.208 | 1825.3 samples/s | 28.5 steps/s
[Step=1600 Epoch=15.1] | Loss=0.00414 | Reg=0.00391 | acc=1.0000 | FP-Norm=1.930 | FP-Norm(final)=2.211 | 3319.7 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step1600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.19400 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.139 | 3502.3 samples/s | 54.7 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.04044 | Reg=0.00400 | acc=1.0000 | FP-Norm=1.903 | FP-Norm(final)=2.152 | 3482.7 samples/s | 54.4 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.02251 | Reg=0.00441 | acc=1.0000 | FP-Norm=2.048 | FP-Norm(final)=2.162 | 4909.1 samples/s | 76.7 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.01546 | Reg=0.00434 | acc=1.0000 | FP-Norm=2.048 | FP-Norm(final)=2.171 | 1616.0 samples/s | 25.2 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01186 | Reg=0.00417 | acc=1.0000 | FP-Norm=2.015 | FP-Norm(final)=2.177 | 4666.5 samples/s | 72.9 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00954 | Reg=0.00401 | acc=1.0000 | FP-Norm=1.980 | FP-Norm(final)=2.182 | 1637.6 samples/s | 25.6 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00799 | Reg=0.00385 | acc=1.0000 | FP-Norm=1.940 | FP-Norm(final)=2.187 | 4343.2 samples/s | 67.9 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00688 | Reg=0.00369 | acc=1.0000 | FP-Norm=1.900 | FP-Norm(final)=2.190 | 1692.7 samples/s | 26.4 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00605 | Reg=0.00355 | acc=1.0000 | FP-Norm=1.862 | FP-Norm(final)=2.194 | 4080.3 samples/s | 63.8 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00540 | Reg=0.00342 | acc=1.0000 | FP-Norm=1.825 | FP-Norm(final)=2.197 | 1698.8 samples/s | 26.5 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00489 | Reg=0.00329 | acc=1.0000 | FP-Norm=1.791 | FP-Norm(final)=2.200 | 3875.1 samples/s | 60.5 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00446 | Reg=0.00318 | acc=1.0000 | FP-Norm=1.759 | FP-Norm(final)=2.202 | 1745.8 samples/s | 27.3 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00411 | Reg=0.00308 | acc=1.0000 | FP-Norm=1.729 | FP-Norm(final)=2.205 | 3817.0 samples/s | 59.6 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00381 | Reg=0.00299 | acc=1.0000 | FP-Norm=1.701 | FP-Norm(final)=2.207 | 1777.6 samples/s | 27.8 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00356 | Reg=0.00290 | acc=1.0000 | FP-Norm=1.675 | FP-Norm(final)=2.210 | 3750.9 samples/s | 58.6 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00333 | Reg=0.00282 | acc=1.0000 | FP-Norm=1.650 | FP-Norm(final)=2.212 | 1758.9 samples/s | 27.5 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00314 | Reg=0.00275 | acc=1.0000 | FP-Norm=1.627 | FP-Norm(final)=2.214 | 3773.1 samples/s | 59.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18507 | acc=0.8324 | tpr=0.8243 | fpr=0.1499 | 3853.3 samples/s | 15.1 steps/s
Avg test loss: 0.18569, Avg test acc: 0.83184, Avg tpr: 0.82415, Avg fpr: 0.15126, total FA: 1180

Testing server on iccad2012
[Step=  50] | Loss=0.54653 | acc=0.5860 | tpr=0.9735 | fpr=0.4209 | 3790.6 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.54825 | acc=0.5861 | tpr=0.9701 | fpr=0.4211 | 7313.1 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.55092 | acc=0.5873 | tpr=0.9726 | fpr=0.4198 | 7137.6 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.54980 | acc=0.5883 | tpr=0.9749 | fpr=0.4187 | 7187.8 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.54972 | acc=0.5891 | tpr=0.9721 | fpr=0.4179 | 6890.7 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.55015 | acc=0.5885 | tpr=0.9695 | fpr=0.4184 | 6923.3 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.54977 | acc=0.5882 | tpr=0.9674 | fpr=0.4187 | 7232.6 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.55178 | acc=0.5873 | tpr=0.9683 | fpr=0.4197 | 7051.7 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.55249 | acc=0.5873 | tpr=0.9684 | fpr=0.4196 | 7104.1 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.55277 | acc=0.5870 | tpr=0.9678 | fpr=0.4198 | 7107.6 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.55221 | acc=0.5875 | tpr=0.9670 | fpr=0.4194 | 12740.5 samples/s | 49.8 steps/s
Avg test loss: 0.55210, Avg test acc: 0.58753, Avg tpr: 0.96672, Avg fpr: 0.41937, total FA: 58228

server round 2/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.19804 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.293 | 3667.9 samples/s | 57.3 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.12303 | Reg=0.00187 | acc=0.9219 | FP-Norm=1.293 | FP-Norm(final)=2.283 | 3791.0 samples/s | 59.2 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.10633 | Reg=0.00234 | acc=0.9219 | FP-Norm=1.484 | FP-Norm(final)=2.288 | 3855.3 samples/s | 60.2 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.09997 | Reg=0.00270 | acc=0.9531 | FP-Norm=1.607 | FP-Norm(final)=2.292 | 3862.6 samples/s | 60.4 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09510 | Reg=0.00303 | acc=0.9844 | FP-Norm=1.704 | FP-Norm(final)=2.297 | 4917.1 samples/s | 76.8 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08608 | Reg=0.00332 | acc=1.0000 | FP-Norm=1.788 | FP-Norm(final)=2.303 | 1661.8 samples/s | 26.0 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07974 | Reg=0.00358 | acc=0.9375 | FP-Norm=1.857 | FP-Norm(final)=2.311 | 3862.3 samples/s | 60.3 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07507 | Reg=0.00387 | acc=0.9375 | FP-Norm=1.930 | FP-Norm(final)=2.319 | 3866.9 samples/s | 60.4 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.07284 | Reg=0.00417 | acc=0.9844 | FP-Norm=2.002 | FP-Norm(final)=2.325 | 4657.3 samples/s | 72.8 steps/s
[Step=2050 Epoch=10.0] | Loss=0.07254 | Reg=0.00461 | acc=0.9375 | FP-Norm=2.096 | FP-Norm(final)=2.329 | 1689.7 samples/s | 26.4 steps/s
[Step=2100 Epoch=10.2] | Loss=0.07065 | Reg=0.00509 | acc=0.9531 | FP-Norm=2.194 | FP-Norm(final)=2.332 | 3869.1 samples/s | 60.5 steps/s
[Step=2150 Epoch=10.5] | Loss=0.06829 | Reg=0.00549 | acc=0.9844 | FP-Norm=2.274 | FP-Norm(final)=2.336 | 3833.9 samples/s | 59.9 steps/s
[Step=2200 Epoch=10.7] | Loss=0.06647 | Reg=0.00582 | acc=0.9688 | FP-Norm=2.341 | FP-Norm(final)=2.340 | 4374.8 samples/s | 68.4 steps/s
[Step=2250 Epoch=11.0] | Loss=0.06547 | Reg=0.00616 | acc=0.9688 | FP-Norm=2.407 | FP-Norm(final)=2.343 | 1743.9 samples/s | 27.2 steps/s
[Step=2300 Epoch=11.2] | Loss=0.06300 | Reg=0.00652 | acc=0.9844 | FP-Norm=2.473 | FP-Norm(final)=2.347 | 3928.5 samples/s | 61.4 steps/s
[Step=2350 Epoch=11.5] | Loss=0.06109 | Reg=0.00681 | acc=0.9688 | FP-Norm=2.529 | FP-Norm(final)=2.351 | 3849.7 samples/s | 60.2 steps/s
[Step=2400 Epoch=11.7] | Loss=0.05922 | Reg=0.00708 | acc=1.0000 | FP-Norm=2.578 | FP-Norm(final)=2.355 | 4144.4 samples/s | 64.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step2400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.18921 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.292 | 3992.5 samples/s | 62.4 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.10410 | Reg=0.00177 | acc=0.8906 | FP-Norm=1.262 | FP-Norm(final)=2.287 | 3621.3 samples/s | 56.6 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.10121 | Reg=0.00225 | acc=0.8594 | FP-Norm=1.456 | FP-Norm(final)=2.288 | 3928.7 samples/s | 61.4 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.09407 | Reg=0.00263 | acc=0.9219 | FP-Norm=1.585 | FP-Norm(final)=2.288 | 3769.9 samples/s | 58.9 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09193 | Reg=0.00298 | acc=0.9375 | FP-Norm=1.691 | FP-Norm(final)=2.289 | 4889.1 samples/s | 76.4 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08346 | Reg=0.00332 | acc=0.9688 | FP-Norm=1.786 | FP-Norm(final)=2.293 | 1619.3 samples/s | 25.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07827 | Reg=0.00363 | acc=0.9375 | FP-Norm=1.867 | FP-Norm(final)=2.298 | 3814.3 samples/s | 59.6 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07446 | Reg=0.00394 | acc=0.9531 | FP-Norm=1.944 | FP-Norm(final)=2.304 | 3782.8 samples/s | 59.1 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.07188 | Reg=0.00424 | acc=0.9531 | FP-Norm=2.016 | FP-Norm(final)=2.310 | 4614.0 samples/s | 72.1 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06802 | Reg=0.00455 | acc=0.9531 | FP-Norm=2.086 | FP-Norm(final)=2.316 | 1649.8 samples/s | 25.8 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06460 | Reg=0.00483 | acc=1.0000 | FP-Norm=2.149 | FP-Norm(final)=2.323 | 3870.7 samples/s | 60.5 steps/s
[Step=2150 Epoch=10.5] | Loss=0.06250 | Reg=0.00510 | acc=1.0000 | FP-Norm=2.208 | FP-Norm(final)=2.329 | 3947.4 samples/s | 61.7 steps/s
[Step=2200 Epoch=10.7] | Loss=0.06042 | Reg=0.00536 | acc=0.9531 | FP-Norm=2.263 | FP-Norm(final)=2.334 | 4616.1 samples/s | 72.1 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05810 | Reg=0.00560 | acc=1.0000 | FP-Norm=2.313 | FP-Norm(final)=2.340 | 1749.8 samples/s | 27.3 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05618 | Reg=0.00583 | acc=0.9375 | FP-Norm=2.359 | FP-Norm(final)=2.345 | 3962.3 samples/s | 61.9 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05446 | Reg=0.00606 | acc=0.9688 | FP-Norm=2.405 | FP-Norm(final)=2.350 | 3826.8 samples/s | 59.8 steps/s
[Step=2400 Epoch=11.7] | Loss=0.05327 | Reg=0.00628 | acc=0.9844 | FP-Norm=2.448 | FP-Norm(final)=2.355 | 4269.9 samples/s | 66.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step2400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.09237 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.293 | 3916.2 samples/s | 61.2 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.11493 | Reg=0.00191 | acc=0.8906 | FP-Norm=1.296 | FP-Norm(final)=2.288 | 3700.2 samples/s | 57.8 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.10337 | Reg=0.00236 | acc=0.9219 | FP-Norm=1.488 | FP-Norm(final)=2.289 | 3956.0 samples/s | 61.8 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.09805 | Reg=0.00267 | acc=0.9375 | FP-Norm=1.596 | FP-Norm(final)=2.292 | 3956.9 samples/s | 61.8 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09361 | Reg=0.00301 | acc=0.9219 | FP-Norm=1.699 | FP-Norm(final)=2.295 | 5092.4 samples/s | 79.6 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08779 | Reg=0.00338 | acc=0.9844 | FP-Norm=1.800 | FP-Norm(final)=2.300 | 1680.8 samples/s | 26.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.08177 | Reg=0.00375 | acc=0.9219 | FP-Norm=1.893 | FP-Norm(final)=2.306 | 3846.3 samples/s | 60.1 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07648 | Reg=0.00408 | acc=0.9844 | FP-Norm=1.976 | FP-Norm(final)=2.313 | 3861.2 samples/s | 60.3 steps/s
[Step=2000 Epoch= 9.7] | Loss=0.07308 | Reg=0.00440 | acc=0.9844 | FP-Norm=2.051 | FP-Norm(final)=2.321 | 4659.8 samples/s | 72.8 steps/s
[Step=2050 Epoch=10.0] | Loss=0.07123 | Reg=0.00473 | acc=0.9844 | FP-Norm=2.125 | FP-Norm(final)=2.327 | 1698.8 samples/s | 26.5 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06760 | Reg=0.00505 | acc=0.9844 | FP-Norm=2.193 | FP-Norm(final)=2.333 | 3878.1 samples/s | 60.6 steps/s
[Step=2150 Epoch=10.5] | Loss=0.06543 | Reg=0.00532 | acc=0.9844 | FP-Norm=2.251 | FP-Norm(final)=2.338 | 3861.4 samples/s | 60.3 steps/s
[Step=2200 Epoch=10.7] | Loss=0.06329 | Reg=0.00558 | acc=0.9531 | FP-Norm=2.306 | FP-Norm(final)=2.344 | 4359.9 samples/s | 68.1 steps/s
[Step=2250 Epoch=11.0] | Loss=0.06079 | Reg=0.00583 | acc=0.9688 | FP-Norm=2.356 | FP-Norm(final)=2.349 | 1770.0 samples/s | 27.7 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05807 | Reg=0.00605 | acc=0.9531 | FP-Norm=2.401 | FP-Norm(final)=2.355 | 3868.5 samples/s | 60.4 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05590 | Reg=0.00625 | acc=0.9844 | FP-Norm=2.442 | FP-Norm(final)=2.361 | 3922.4 samples/s | 61.3 steps/s
[Step=2400 Epoch=11.7] | Loss=0.05429 | Reg=0.00644 | acc=1.0000 | FP-Norm=2.480 | FP-Norm(final)=2.367 | 4157.6 samples/s | 65.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step2400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.18600 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.293 | 3822.5 samples/s | 59.7 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.11123 | Reg=0.00218 | acc=0.9219 | FP-Norm=1.404 | FP-Norm(final)=2.288 | 3636.9 samples/s | 56.8 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.09962 | Reg=0.00259 | acc=0.9219 | FP-Norm=1.568 | FP-Norm(final)=2.293 | 3857.9 samples/s | 60.3 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.09356 | Reg=0.00292 | acc=0.9375 | FP-Norm=1.676 | FP-Norm(final)=2.296 | 3885.3 samples/s | 60.7 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08616 | Reg=0.00327 | acc=0.9375 | FP-Norm=1.775 | FP-Norm(final)=2.302 | 4923.4 samples/s | 76.9 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07770 | Reg=0.00361 | acc=0.9531 | FP-Norm=1.866 | FP-Norm(final)=2.309 | 1662.4 samples/s | 26.0 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07388 | Reg=0.00388 | acc=0.9531 | FP-Norm=1.937 | FP-Norm(final)=2.318 | 3845.2 samples/s | 60.1 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07023 | Reg=0.00420 | acc=0.9844 | FP-Norm=2.013 | FP-Norm(final)=2.323 | 3860.2 samples/s | 60.3 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06732 | Reg=0.00448 | acc=0.9688 | FP-Norm=2.078 | FP-Norm(final)=2.329 | 4657.8 samples/s | 72.8 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06374 | Reg=0.00476 | acc=1.0000 | FP-Norm=2.142 | FP-Norm(final)=2.335 | 1682.6 samples/s | 26.3 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06075 | Reg=0.00502 | acc=0.9844 | FP-Norm=2.198 | FP-Norm(final)=2.341 | 3864.1 samples/s | 60.4 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05834 | Reg=0.00525 | acc=0.9375 | FP-Norm=2.249 | FP-Norm(final)=2.346 | 3848.7 samples/s | 60.1 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05582 | Reg=0.00548 | acc=0.9688 | FP-Norm=2.298 | FP-Norm(final)=2.352 | 4393.3 samples/s | 68.6 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05326 | Reg=0.00570 | acc=0.9688 | FP-Norm=2.342 | FP-Norm(final)=2.359 | 1737.5 samples/s | 27.1 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05157 | Reg=0.00589 | acc=0.9219 | FP-Norm=2.383 | FP-Norm(final)=2.365 | 3913.2 samples/s | 61.1 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05058 | Reg=0.00611 | acc=0.9688 | FP-Norm=2.425 | FP-Norm(final)=2.370 | 3848.9 samples/s | 60.1 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04964 | Reg=0.00632 | acc=1.0000 | FP-Norm=2.466 | FP-Norm(final)=2.375 | 4157.1 samples/s | 65.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step2400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.9] | Loss=0.17324 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.293 | 3701.5 samples/s | 57.8 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.12216 | Reg=0.00199 | acc=0.9062 | FP-Norm=1.335 | FP-Norm(final)=2.280 | 3861.6 samples/s | 60.3 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.10918 | Reg=0.00255 | acc=0.9531 | FP-Norm=1.548 | FP-Norm(final)=2.279 | 3869.4 samples/s | 60.5 steps/s
[Step=1750 Epoch= 8.6] | Loss=0.09979 | Reg=0.00288 | acc=0.9844 | FP-Norm=1.659 | FP-Norm(final)=2.282 | 3836.5 samples/s | 59.9 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09440 | Reg=0.00326 | acc=0.9375 | FP-Norm=1.768 | FP-Norm(final)=2.287 | 5007.0 samples/s | 78.2 steps/s
[Step=1850 Epoch= 9.1] | Loss=0.08504 | Reg=0.00360 | acc=0.9375 | FP-Norm=1.859 | FP-Norm(final)=2.294 | 1680.0 samples/s | 26.2 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07905 | Reg=0.00390 | acc=0.9219 | FP-Norm=1.936 | FP-Norm(final)=2.301 | 3928.6 samples/s | 61.4 steps/s
[Step=1950 Epoch= 9.6] | Loss=0.07456 | Reg=0.00419 | acc=0.9844 | FP-Norm=2.009 | FP-Norm(final)=2.307 | 3870.8 samples/s | 60.5 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.07143 | Reg=0.00449 | acc=0.9688 | FP-Norm=2.078 | FP-Norm(final)=2.313 | 4785.7 samples/s | 74.8 steps/s
[Step=2050 Epoch=10.1] | Loss=0.06671 | Reg=0.00478 | acc=0.9688 | FP-Norm=2.143 | FP-Norm(final)=2.319 | 1690.4 samples/s | 26.4 steps/s
[Step=2100 Epoch=10.3] | Loss=0.06374 | Reg=0.00503 | acc=0.9531 | FP-Norm=2.198 | FP-Norm(final)=2.324 | 3981.8 samples/s | 62.2 steps/s
[Step=2150 Epoch=10.5] | Loss=0.06098 | Reg=0.00526 | acc=0.9844 | FP-Norm=2.249 | FP-Norm(final)=2.330 | 3908.4 samples/s | 61.1 steps/s
[Step=2200 Epoch=10.8] | Loss=0.05821 | Reg=0.00550 | acc=0.9844 | FP-Norm=2.299 | FP-Norm(final)=2.336 | 4756.7 samples/s | 74.3 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05567 | Reg=0.00571 | acc=1.0000 | FP-Norm=2.343 | FP-Norm(final)=2.343 | 1697.1 samples/s | 26.5 steps/s
[Step=2300 Epoch=11.3] | Loss=0.05382 | Reg=0.00591 | acc=0.9844 | FP-Norm=2.384 | FP-Norm(final)=2.349 | 3866.8 samples/s | 60.4 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05252 | Reg=0.00610 | acc=0.9375 | FP-Norm=2.422 | FP-Norm(final)=2.355 | 3885.4 samples/s | 60.7 steps/s
[Step=2400 Epoch=11.8] | Loss=0.05138 | Reg=0.00631 | acc=0.9844 | FP-Norm=2.464 | FP-Norm(final)=2.359 | 4435.2 samples/s | 69.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step2400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.33594 | Reg=0.00000 | acc=0.7656 | FP-Norm=0.000 | FP-Norm(final)=2.290 | 3508.2 samples/s | 54.8 steps/s
[Step=1650 Epoch=15.6] | Loss=0.03026 | Reg=0.00531 | acc=1.0000 | FP-Norm=2.203 | FP-Norm(final)=2.262 | 3708.1 samples/s | 57.9 steps/s
[Step=1700 Epoch=16.1] | Loss=0.01887 | Reg=0.00581 | acc=1.0000 | FP-Norm=2.358 | FP-Norm(final)=2.266 | 4754.1 samples/s | 74.3 steps/s
[Step=1750 Epoch=16.6] | Loss=0.01327 | Reg=0.00567 | acc=1.0000 | FP-Norm=2.344 | FP-Norm(final)=2.270 | 1591.0 samples/s | 24.9 steps/s
[Step=1800 Epoch=17.1] | Loss=0.01026 | Reg=0.00543 | acc=1.0000 | FP-Norm=2.302 | FP-Norm(final)=2.275 | 4387.4 samples/s | 68.6 steps/s
[Step=1850 Epoch=17.5] | Loss=0.00823 | Reg=0.00520 | acc=1.0000 | FP-Norm=2.254 | FP-Norm(final)=2.280 | 1640.4 samples/s | 25.6 steps/s
[Step=1900 Epoch=18.0] | Loss=0.00687 | Reg=0.00495 | acc=1.0000 | FP-Norm=2.200 | FP-Norm(final)=2.284 | 4274.8 samples/s | 66.8 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00590 | Reg=0.00472 | acc=1.0000 | FP-Norm=2.146 | FP-Norm(final)=2.287 | 1715.1 samples/s | 26.8 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00518 | Reg=0.00450 | acc=1.0000 | FP-Norm=2.092 | FP-Norm(final)=2.290 | 3941.6 samples/s | 61.6 steps/s
[Step=2050 Epoch=19.4] | Loss=0.00461 | Reg=0.00429 | acc=1.0000 | FP-Norm=2.041 | FP-Norm(final)=2.293 | 1700.7 samples/s | 26.6 steps/s
[Step=2100 Epoch=19.9] | Loss=0.00416 | Reg=0.00411 | acc=1.0000 | FP-Norm=1.993 | FP-Norm(final)=2.295 | 3722.3 samples/s | 58.2 steps/s
[Step=2150 Epoch=20.4] | Loss=0.00379 | Reg=0.00393 | acc=1.0000 | FP-Norm=1.946 | FP-Norm(final)=2.297 | 1759.5 samples/s | 27.5 steps/s
[Step=2200 Epoch=20.8] | Loss=0.00348 | Reg=0.00377 | acc=1.0000 | FP-Norm=1.903 | FP-Norm(final)=2.300 | 3745.6 samples/s | 58.5 steps/s
[Step=2250 Epoch=21.3] | Loss=0.00322 | Reg=0.00363 | acc=1.0000 | FP-Norm=1.861 | FP-Norm(final)=2.302 | 1747.5 samples/s | 27.3 steps/s
[Step=2300 Epoch=21.8] | Loss=0.00300 | Reg=0.00349 | acc=1.0000 | FP-Norm=1.821 | FP-Norm(final)=2.304 | 3648.0 samples/s | 57.0 steps/s
[Step=2350 Epoch=22.3] | Loss=0.00281 | Reg=0.00336 | acc=1.0000 | FP-Norm=1.783 | FP-Norm(final)=2.306 | 1749.7 samples/s | 27.3 steps/s
[Step=2400 Epoch=22.7] | Loss=0.00264 | Reg=0.00324 | acc=1.0000 | FP-Norm=1.748 | FP-Norm(final)=2.308 | 3652.3 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step2400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.22581 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.291 | 3620.4 samples/s | 56.6 steps/s
[Step=1650 Epoch=15.7] | Loss=0.03186 | Reg=0.00666 | acc=1.0000 | FP-Norm=2.465 | FP-Norm(final)=2.260 | 3479.4 samples/s | 54.4 steps/s
[Step=1700 Epoch=16.2] | Loss=0.01758 | Reg=0.00700 | acc=1.0000 | FP-Norm=2.586 | FP-Norm(final)=2.265 | 4894.0 samples/s | 76.5 steps/s
[Step=1750 Epoch=16.6] | Loss=0.01198 | Reg=0.00673 | acc=1.0000 | FP-Norm=2.552 | FP-Norm(final)=2.271 | 1589.1 samples/s | 24.8 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00904 | Reg=0.00634 | acc=1.0000 | FP-Norm=2.483 | FP-Norm(final)=2.277 | 4415.5 samples/s | 69.0 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00726 | Reg=0.00595 | acc=1.0000 | FP-Norm=2.406 | FP-Norm(final)=2.281 | 1641.3 samples/s | 25.6 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00607 | Reg=0.00560 | acc=1.0000 | FP-Norm=2.331 | FP-Norm(final)=2.285 | 4330.2 samples/s | 67.7 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00521 | Reg=0.00528 | acc=1.0000 | FP-Norm=2.260 | FP-Norm(final)=2.289 | 1660.5 samples/s | 25.9 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00458 | Reg=0.00499 | acc=1.0000 | FP-Norm=2.194 | FP-Norm(final)=2.292 | 3912.9 samples/s | 61.1 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00408 | Reg=0.00474 | acc=1.0000 | FP-Norm=2.132 | FP-Norm(final)=2.295 | 1673.5 samples/s | 26.1 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00369 | Reg=0.00450 | acc=1.0000 | FP-Norm=2.074 | FP-Norm(final)=2.298 | 3822.9 samples/s | 59.7 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00336 | Reg=0.00430 | acc=1.0000 | FP-Norm=2.020 | FP-Norm(final)=2.301 | 1758.0 samples/s | 27.5 steps/s
[Step=2200 Epoch=20.9] | Loss=0.00309 | Reg=0.00410 | acc=1.0000 | FP-Norm=1.970 | FP-Norm(final)=2.304 | 3708.3 samples/s | 57.9 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00286 | Reg=0.00393 | acc=1.0000 | FP-Norm=1.922 | FP-Norm(final)=2.306 | 1767.9 samples/s | 27.6 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00267 | Reg=0.00377 | acc=1.0000 | FP-Norm=1.877 | FP-Norm(final)=2.309 | 3697.6 samples/s | 57.8 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00250 | Reg=0.00362 | acc=1.0000 | FP-Norm=1.836 | FP-Norm(final)=2.311 | 1770.6 samples/s | 27.7 steps/s
[Step=2400 Epoch=22.8] | Loss=0.00235 | Reg=0.00349 | acc=1.0000 | FP-Norm=1.796 | FP-Norm(final)=2.314 | 3681.1 samples/s | 57.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step2400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.3] | Loss=0.25076 | Reg=0.00000 | acc=0.7031 | FP-Norm=0.000 | FP-Norm(final)=2.291 | 3569.9 samples/s | 55.8 steps/s
[Step=1650 Epoch=15.8] | Loss=0.05079 | Reg=0.00865 | acc=0.9844 | FP-Norm=2.800 | FP-Norm(final)=2.241 | 3527.6 samples/s | 55.1 steps/s
[Step=1700 Epoch=16.2] | Loss=0.02688 | Reg=0.00920 | acc=1.0000 | FP-Norm=2.960 | FP-Norm(final)=2.246 | 4883.7 samples/s | 76.3 steps/s
[Step=1750 Epoch=16.7] | Loss=0.01799 | Reg=0.00876 | acc=1.0000 | FP-Norm=2.909 | FP-Norm(final)=2.253 | 1593.0 samples/s | 24.9 steps/s
[Step=1800 Epoch=17.2] | Loss=0.01356 | Reg=0.00822 | acc=1.0000 | FP-Norm=2.824 | FP-Norm(final)=2.258 | 4521.2 samples/s | 70.6 steps/s
[Step=1850 Epoch=17.7] | Loss=0.01088 | Reg=0.00772 | acc=1.0000 | FP-Norm=2.737 | FP-Norm(final)=2.263 | 1609.5 samples/s | 25.1 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00909 | Reg=0.00726 | acc=1.0000 | FP-Norm=2.653 | FP-Norm(final)=2.266 | 4259.9 samples/s | 66.6 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00781 | Reg=0.00686 | acc=1.0000 | FP-Norm=2.574 | FP-Norm(final)=2.270 | 1598.0 samples/s | 25.0 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00685 | Reg=0.00649 | acc=1.0000 | FP-Norm=2.501 | FP-Norm(final)=2.273 | 4031.5 samples/s | 63.0 steps/s
[Step=2050 Epoch=19.6] | Loss=0.00610 | Reg=0.00617 | acc=1.0000 | FP-Norm=2.432 | FP-Norm(final)=2.276 | 1686.3 samples/s | 26.3 steps/s
[Step=2100 Epoch=20.1] | Loss=0.00550 | Reg=0.00587 | acc=1.0000 | FP-Norm=2.367 | FP-Norm(final)=2.279 | 3805.0 samples/s | 59.5 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00502 | Reg=0.00560 | acc=1.0000 | FP-Norm=2.307 | FP-Norm(final)=2.282 | 1689.1 samples/s | 26.4 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00461 | Reg=0.00535 | acc=1.0000 | FP-Norm=2.251 | FP-Norm(final)=2.285 | 3698.0 samples/s | 57.8 steps/s
[Step=2250 Epoch=21.5] | Loss=0.00426 | Reg=0.00513 | acc=1.0000 | FP-Norm=2.197 | FP-Norm(final)=2.287 | 1740.3 samples/s | 27.2 steps/s
[Step=2300 Epoch=22.0] | Loss=0.00397 | Reg=0.00492 | acc=1.0000 | FP-Norm=2.147 | FP-Norm(final)=2.290 | 3663.8 samples/s | 57.2 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00371 | Reg=0.00473 | acc=1.0000 | FP-Norm=2.099 | FP-Norm(final)=2.292 | 1771.5 samples/s | 27.7 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00349 | Reg=0.00455 | acc=1.0000 | FP-Norm=2.054 | FP-Norm(final)=2.295 | 3719.2 samples/s | 58.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step2400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.1] | Loss=0.17117 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.292 | 3507.1 samples/s | 54.8 steps/s
[Step=1650 Epoch=15.5] | Loss=0.03879 | Reg=0.00725 | acc=1.0000 | FP-Norm=2.563 | FP-Norm(final)=2.255 | 3600.4 samples/s | 56.3 steps/s
[Step=1700 Epoch=16.0] | Loss=0.02124 | Reg=0.00776 | acc=1.0000 | FP-Norm=2.719 | FP-Norm(final)=2.261 | 4849.1 samples/s | 75.8 steps/s
[Step=1750 Epoch=16.5] | Loss=0.01483 | Reg=0.00755 | acc=1.0000 | FP-Norm=2.703 | FP-Norm(final)=2.268 | 1608.8 samples/s | 25.1 steps/s
[Step=1800 Epoch=17.0] | Loss=0.01134 | Reg=0.00724 | acc=1.0000 | FP-Norm=2.654 | FP-Norm(final)=2.275 | 4333.3 samples/s | 67.7 steps/s
[Step=1850 Epoch=17.4] | Loss=0.00914 | Reg=0.00690 | acc=1.0000 | FP-Norm=2.595 | FP-Norm(final)=2.280 | 1662.7 samples/s | 26.0 steps/s
[Step=1900 Epoch=17.9] | Loss=0.00763 | Reg=0.00656 | acc=1.0000 | FP-Norm=2.530 | FP-Norm(final)=2.285 | 4158.3 samples/s | 65.0 steps/s
[Step=1950 Epoch=18.4] | Loss=0.00656 | Reg=0.00624 | acc=1.0000 | FP-Norm=2.465 | FP-Norm(final)=2.289 | 1689.9 samples/s | 26.4 steps/s
[Step=2000 Epoch=18.8] | Loss=0.00575 | Reg=0.00594 | acc=1.0000 | FP-Norm=2.401 | FP-Norm(final)=2.292 | 3831.5 samples/s | 59.9 steps/s
[Step=2050 Epoch=19.3] | Loss=0.00512 | Reg=0.00566 | acc=1.0000 | FP-Norm=2.341 | FP-Norm(final)=2.296 | 1730.2 samples/s | 27.0 steps/s
[Step=2100 Epoch=19.8] | Loss=0.00462 | Reg=0.00540 | acc=1.0000 | FP-Norm=2.283 | FP-Norm(final)=2.298 | 3766.0 samples/s | 58.8 steps/s
[Step=2150 Epoch=20.3] | Loss=0.00421 | Reg=0.00517 | acc=1.0000 | FP-Norm=2.228 | FP-Norm(final)=2.301 | 1804.0 samples/s | 28.2 steps/s
[Step=2200 Epoch=20.7] | Loss=0.00387 | Reg=0.00495 | acc=1.0000 | FP-Norm=2.175 | FP-Norm(final)=2.304 | 3645.1 samples/s | 57.0 steps/s
[Step=2250 Epoch=21.2] | Loss=0.00358 | Reg=0.00475 | acc=1.0000 | FP-Norm=2.126 | FP-Norm(final)=2.306 | 1811.5 samples/s | 28.3 steps/s
[Step=2300 Epoch=21.7] | Loss=0.00333 | Reg=0.00456 | acc=1.0000 | FP-Norm=2.078 | FP-Norm(final)=2.309 | 3804.6 samples/s | 59.4 steps/s
[Step=2350 Epoch=22.1] | Loss=0.00312 | Reg=0.00439 | acc=1.0000 | FP-Norm=2.033 | FP-Norm(final)=2.311 | 1828.0 samples/s | 28.6 steps/s
[Step=2400 Epoch=22.6] | Loss=0.00293 | Reg=0.00423 | acc=1.0000 | FP-Norm=1.991 | FP-Norm(final)=2.313 | 3398.5 samples/s | 53.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step2400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.3] | Loss=0.37092 | Reg=0.00000 | acc=0.7031 | FP-Norm=0.000 | FP-Norm(final)=2.290 | 3680.1 samples/s | 57.5 steps/s
[Step=1650 Epoch=15.7] | Loss=0.03450 | Reg=0.00541 | acc=1.0000 | FP-Norm=2.219 | FP-Norm(final)=2.268 | 3431.9 samples/s | 53.6 steps/s
[Step=1700 Epoch=16.2] | Loss=0.02174 | Reg=0.00618 | acc=1.0000 | FP-Norm=2.429 | FP-Norm(final)=2.273 | 4793.6 samples/s | 74.9 steps/s
[Step=1750 Epoch=16.7] | Loss=0.01519 | Reg=0.00635 | acc=1.0000 | FP-Norm=2.481 | FP-Norm(final)=2.279 | 1601.8 samples/s | 25.0 steps/s
[Step=1800 Epoch=17.2] | Loss=0.01149 | Reg=0.00625 | acc=1.0000 | FP-Norm=2.470 | FP-Norm(final)=2.284 | 4581.4 samples/s | 71.6 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00923 | Reg=0.00604 | acc=1.0000 | FP-Norm=2.432 | FP-Norm(final)=2.287 | 1637.4 samples/s | 25.6 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00771 | Reg=0.00580 | acc=1.0000 | FP-Norm=2.385 | FP-Norm(final)=2.291 | 4260.1 samples/s | 66.6 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00662 | Reg=0.00557 | acc=1.0000 | FP-Norm=2.335 | FP-Norm(final)=2.293 | 1668.6 samples/s | 26.1 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00581 | Reg=0.00534 | acc=1.0000 | FP-Norm=2.285 | FP-Norm(final)=2.296 | 4090.8 samples/s | 63.9 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00518 | Reg=0.00512 | acc=1.0000 | FP-Norm=2.235 | FP-Norm(final)=2.298 | 1707.8 samples/s | 26.7 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00467 | Reg=0.00491 | acc=1.0000 | FP-Norm=2.187 | FP-Norm(final)=2.300 | 3975.0 samples/s | 62.1 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00426 | Reg=0.00472 | acc=1.0000 | FP-Norm=2.141 | FP-Norm(final)=2.302 | 1726.8 samples/s | 27.0 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00392 | Reg=0.00455 | acc=1.0000 | FP-Norm=2.096 | FP-Norm(final)=2.304 | 3727.6 samples/s | 58.2 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00362 | Reg=0.00438 | acc=1.0000 | FP-Norm=2.054 | FP-Norm(final)=2.306 | 1730.5 samples/s | 27.0 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00338 | Reg=0.00422 | acc=1.0000 | FP-Norm=2.013 | FP-Norm(final)=2.308 | 3627.5 samples/s | 56.7 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00316 | Reg=0.00408 | acc=1.0000 | FP-Norm=1.973 | FP-Norm(final)=2.310 | 1744.1 samples/s | 27.3 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00297 | Reg=0.00394 | acc=1.0000 | FP-Norm=1.936 | FP-Norm(final)=2.312 | 3814.2 samples/s | 59.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21745 | acc=0.8073 | tpr=0.7600 | fpr=0.0899 | 3802.8 samples/s | 14.9 steps/s
Avg test loss: 0.21682, Avg test acc: 0.80908, Avg tpr: 0.76243, Avg fpr: 0.08832, total FA: 689

Testing server on iccad2012
[Step=  50] | Loss=0.43844 | acc=0.7177 | tpr=0.9690 | fpr=0.2869 | 3848.9 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.44182 | acc=0.7170 | tpr=0.9616 | fpr=0.2875 | 7135.5 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.44498 | acc=0.7171 | tpr=0.9669 | fpr=0.2875 | 6995.8 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.44450 | acc=0.7187 | tpr=0.9694 | fpr=0.2859 | 7272.3 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.44366 | acc=0.7190 | tpr=0.9659 | fpr=0.2855 | 7327.1 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.44360 | acc=0.7192 | tpr=0.9607 | fpr=0.2852 | 7076.9 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.44394 | acc=0.7186 | tpr=0.9631 | fpr=0.2859 | 7059.2 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.44577 | acc=0.7173 | tpr=0.9628 | fpr=0.2872 | 7167.6 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.44716 | acc=0.7174 | tpr=0.9640 | fpr=0.2871 | 7209.9 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.44765 | acc=0.7170 | tpr=0.9643 | fpr=0.2874 | 7087.6 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.44715 | acc=0.7174 | tpr=0.9638 | fpr=0.2871 | 12615.1 samples/s | 49.3 steps/s
Avg test loss: 0.44711, Avg test acc: 0.71742, Avg tpr: 0.96395, Avg fpr: 0.28706, total FA: 39858

server round 3/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.20214 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.383 | 3665.4 samples/s | 57.3 steps/s
[Step=2450 Epoch=11.9] | Loss=0.08511 | Reg=0.00144 | acc=0.9531 | FP-Norm=1.142 | FP-Norm(final)=2.376 | 3874.4 samples/s | 60.5 steps/s
[Step=2500 Epoch=12.2] | Loss=0.07694 | Reg=0.00186 | acc=0.9688 | FP-Norm=1.327 | FP-Norm(final)=2.377 | 3942.3 samples/s | 61.6 steps/s
[Step=2550 Epoch=12.4] | Loss=0.07448 | Reg=0.00218 | acc=0.9688 | FP-Norm=1.443 | FP-Norm(final)=2.379 | 3974.3 samples/s | 62.1 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07053 | Reg=0.00242 | acc=0.9531 | FP-Norm=1.527 | FP-Norm(final)=2.381 | 5090.0 samples/s | 79.5 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06568 | Reg=0.00276 | acc=0.9844 | FP-Norm=1.626 | FP-Norm(final)=2.385 | 1664.5 samples/s | 26.0 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06374 | Reg=0.00308 | acc=1.0000 | FP-Norm=1.715 | FP-Norm(final)=2.390 | 3855.0 samples/s | 60.2 steps/s
[Step=2750 Epoch=13.4] | Loss=0.06137 | Reg=0.00335 | acc=0.9844 | FP-Norm=1.790 | FP-Norm(final)=2.393 | 3846.0 samples/s | 60.1 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05857 | Reg=0.00359 | acc=0.9531 | FP-Norm=1.853 | FP-Norm(final)=2.396 | 4619.5 samples/s | 72.2 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05478 | Reg=0.00381 | acc=0.9688 | FP-Norm=1.909 | FP-Norm(final)=2.401 | 1684.3 samples/s | 26.3 steps/s
[Step=2900 Epoch=14.1] | Loss=0.05175 | Reg=0.00400 | acc=0.9688 | FP-Norm=1.957 | FP-Norm(final)=2.406 | 3837.3 samples/s | 60.0 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04988 | Reg=0.00418 | acc=1.0000 | FP-Norm=2.001 | FP-Norm(final)=2.411 | 3843.2 samples/s | 60.1 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04815 | Reg=0.00435 | acc=0.9844 | FP-Norm=2.041 | FP-Norm(final)=2.416 | 4414.4 samples/s | 69.0 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04640 | Reg=0.00451 | acc=0.9531 | FP-Norm=2.081 | FP-Norm(final)=2.420 | 1770.4 samples/s | 27.7 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04477 | Reg=0.00467 | acc=0.9844 | FP-Norm=2.118 | FP-Norm(final)=2.425 | 3851.8 samples/s | 60.2 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04325 | Reg=0.00482 | acc=1.0000 | FP-Norm=2.151 | FP-Norm(final)=2.429 | 3852.5 samples/s | 60.2 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04245 | Reg=0.00496 | acc=0.9844 | FP-Norm=2.182 | FP-Norm(final)=2.434 | 4152.6 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step3200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.18310 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.382 | 3730.8 samples/s | 58.3 steps/s
[Step=2450 Epoch=12.0] | Loss=0.09230 | Reg=0.00214 | acc=0.9531 | FP-Norm=1.396 | FP-Norm(final)=2.371 | 3711.7 samples/s | 58.0 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08419 | Reg=0.00254 | acc=0.9531 | FP-Norm=1.555 | FP-Norm(final)=2.370 | 3832.5 samples/s | 59.9 steps/s
[Step=2550 Epoch=12.4] | Loss=0.07781 | Reg=0.00285 | acc=0.9375 | FP-Norm=1.656 | FP-Norm(final)=2.370 | 3870.8 samples/s | 60.5 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07370 | Reg=0.00310 | acc=0.9219 | FP-Norm=1.734 | FP-Norm(final)=2.371 | 4990.5 samples/s | 78.0 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06663 | Reg=0.00331 | acc=0.9844 | FP-Norm=1.795 | FP-Norm(final)=2.375 | 1687.6 samples/s | 26.4 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06141 | Reg=0.00352 | acc=0.9688 | FP-Norm=1.852 | FP-Norm(final)=2.382 | 3930.5 samples/s | 61.4 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05778 | Reg=0.00372 | acc=0.9844 | FP-Norm=1.904 | FP-Norm(final)=2.389 | 3859.9 samples/s | 60.3 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05631 | Reg=0.00393 | acc=0.9688 | FP-Norm=1.956 | FP-Norm(final)=2.395 | 4616.8 samples/s | 72.1 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05409 | Reg=0.00415 | acc=0.9688 | FP-Norm=2.010 | FP-Norm(final)=2.400 | 1664.2 samples/s | 26.0 steps/s
[Step=2900 Epoch=14.2] | Loss=0.05173 | Reg=0.00438 | acc=0.9844 | FP-Norm=2.061 | FP-Norm(final)=2.406 | 3824.8 samples/s | 59.8 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04986 | Reg=0.00459 | acc=0.9844 | FP-Norm=2.111 | FP-Norm(final)=2.412 | 3910.9 samples/s | 61.1 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04898 | Reg=0.00483 | acc=0.9688 | FP-Norm=2.161 | FP-Norm(final)=2.417 | 4509.0 samples/s | 70.5 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04743 | Reg=0.00503 | acc=0.9844 | FP-Norm=2.206 | FP-Norm(final)=2.421 | 1720.8 samples/s | 26.9 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04603 | Reg=0.00522 | acc=0.9844 | FP-Norm=2.246 | FP-Norm(final)=2.426 | 3863.5 samples/s | 60.4 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04493 | Reg=0.00539 | acc=0.9844 | FP-Norm=2.281 | FP-Norm(final)=2.430 | 3845.2 samples/s | 60.1 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04373 | Reg=0.00555 | acc=0.9688 | FP-Norm=2.315 | FP-Norm(final)=2.433 | 4288.4 samples/s | 67.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step3200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.19070 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.383 | 3716.1 samples/s | 58.1 steps/s
[Step=2450 Epoch=11.9] | Loss=0.09075 | Reg=0.00157 | acc=0.9844 | FP-Norm=1.191 | FP-Norm(final)=2.373 | 3918.4 samples/s | 61.2 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08252 | Reg=0.00191 | acc=0.9531 | FP-Norm=1.346 | FP-Norm(final)=2.374 | 3948.6 samples/s | 61.7 steps/s
[Step=2550 Epoch=12.4] | Loss=0.08010 | Reg=0.00222 | acc=0.8906 | FP-Norm=1.458 | FP-Norm(final)=2.373 | 3856.1 samples/s | 60.3 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07757 | Reg=0.00254 | acc=0.9688 | FP-Norm=1.561 | FP-Norm(final)=2.372 | 4909.5 samples/s | 76.7 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06909 | Reg=0.00282 | acc=0.9688 | FP-Norm=1.646 | FP-Norm(final)=2.376 | 1685.6 samples/s | 26.3 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06304 | Reg=0.00307 | acc=1.0000 | FP-Norm=1.717 | FP-Norm(final)=2.382 | 3864.1 samples/s | 60.4 steps/s
[Step=2750 Epoch=13.4] | Loss=0.06073 | Reg=0.00333 | acc=0.9844 | FP-Norm=1.788 | FP-Norm(final)=2.389 | 3882.8 samples/s | 60.7 steps/s
[Step=2800 Epoch=13.6] | Loss=0.05863 | Reg=0.00361 | acc=0.9688 | FP-Norm=1.859 | FP-Norm(final)=2.394 | 4625.1 samples/s | 72.3 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05603 | Reg=0.00387 | acc=0.9531 | FP-Norm=1.924 | FP-Norm(final)=2.400 | 1730.1 samples/s | 27.0 steps/s
[Step=2900 Epoch=14.1] | Loss=0.05371 | Reg=0.00411 | acc=0.9688 | FP-Norm=1.983 | FP-Norm(final)=2.406 | 3957.8 samples/s | 61.8 steps/s
[Step=2950 Epoch=14.4] | Loss=0.05147 | Reg=0.00434 | acc=1.0000 | FP-Norm=2.036 | FP-Norm(final)=2.411 | 3964.7 samples/s | 61.9 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04992 | Reg=0.00456 | acc=0.9688 | FP-Norm=2.086 | FP-Norm(final)=2.416 | 4433.1 samples/s | 69.3 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04809 | Reg=0.00477 | acc=0.9844 | FP-Norm=2.135 | FP-Norm(final)=2.421 | 1732.6 samples/s | 27.1 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04674 | Reg=0.00498 | acc=1.0000 | FP-Norm=2.179 | FP-Norm(final)=2.426 | 3863.3 samples/s | 60.4 steps/s
[Step=3150 Epoch=15.3] | Loss=0.04557 | Reg=0.00517 | acc=0.9844 | FP-Norm=2.221 | FP-Norm(final)=2.430 | 3855.3 samples/s | 60.2 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04458 | Reg=0.00537 | acc=0.9844 | FP-Norm=2.264 | FP-Norm(final)=2.434 | 4149.8 samples/s | 64.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step3200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.20650 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.383 | 4137.2 samples/s | 64.6 steps/s
[Step=2450 Epoch=11.9] | Loss=0.09036 | Reg=0.00191 | acc=0.9531 | FP-Norm=1.319 | FP-Norm(final)=2.372 | 3330.9 samples/s | 52.0 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08496 | Reg=0.00237 | acc=0.9062 | FP-Norm=1.502 | FP-Norm(final)=2.370 | 3771.2 samples/s | 58.9 steps/s
[Step=2550 Epoch=12.4] | Loss=0.08064 | Reg=0.00264 | acc=0.9062 | FP-Norm=1.596 | FP-Norm(final)=2.371 | 3583.1 samples/s | 56.0 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07534 | Reg=0.00291 | acc=0.9688 | FP-Norm=1.677 | FP-Norm(final)=2.374 | 4520.7 samples/s | 70.6 steps/s
[Step=2650 Epoch=12.9] | Loss=0.07152 | Reg=0.00332 | acc=0.9688 | FP-Norm=1.787 | FP-Norm(final)=2.377 | 1631.4 samples/s | 25.5 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06769 | Reg=0.00371 | acc=0.9844 | FP-Norm=1.886 | FP-Norm(final)=2.381 | 3984.3 samples/s | 62.3 steps/s
[Step=2750 Epoch=13.4] | Loss=0.06353 | Reg=0.00402 | acc=0.9531 | FP-Norm=1.964 | FP-Norm(final)=2.386 | 3983.0 samples/s | 62.2 steps/s
[Step=2800 Epoch=13.7] | Loss=0.06115 | Reg=0.00431 | acc=1.0000 | FP-Norm=2.031 | FP-Norm(final)=2.391 | 4751.0 samples/s | 74.2 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05810 | Reg=0.00457 | acc=0.9844 | FP-Norm=2.093 | FP-Norm(final)=2.395 | 1717.0 samples/s | 26.8 steps/s
[Step=2900 Epoch=14.1] | Loss=0.05540 | Reg=0.00480 | acc=0.9844 | FP-Norm=2.147 | FP-Norm(final)=2.399 | 3842.8 samples/s | 60.0 steps/s
[Step=2950 Epoch=14.4] | Loss=0.05253 | Reg=0.00501 | acc=0.9531 | FP-Norm=2.193 | FP-Norm(final)=2.403 | 3875.5 samples/s | 60.6 steps/s
[Step=3000 Epoch=14.6] | Loss=0.05019 | Reg=0.00518 | acc=0.9844 | FP-Norm=2.232 | FP-Norm(final)=2.407 | 4510.7 samples/s | 70.5 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04848 | Reg=0.00536 | acc=0.9688 | FP-Norm=2.272 | FP-Norm(final)=2.411 | 1761.7 samples/s | 27.5 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04620 | Reg=0.00553 | acc=1.0000 | FP-Norm=2.308 | FP-Norm(final)=2.415 | 3984.6 samples/s | 62.3 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04512 | Reg=0.00569 | acc=1.0000 | FP-Norm=2.341 | FP-Norm(final)=2.420 | 3947.3 samples/s | 61.7 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04417 | Reg=0.00585 | acc=1.0000 | FP-Norm=2.375 | FP-Norm(final)=2.423 | 4239.1 samples/s | 66.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step3200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.8] | Loss=0.13624 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.383 | 3968.4 samples/s | 62.0 steps/s
[Step=2450 Epoch=12.0] | Loss=0.08619 | Reg=0.00168 | acc=0.9062 | FP-Norm=1.230 | FP-Norm(final)=2.374 | 3578.2 samples/s | 55.9 steps/s
[Step=2500 Epoch=12.3] | Loss=0.07932 | Reg=0.00213 | acc=0.8906 | FP-Norm=1.417 | FP-Norm(final)=2.370 | 3846.1 samples/s | 60.1 steps/s
[Step=2550 Epoch=12.5] | Loss=0.07736 | Reg=0.00246 | acc=0.9531 | FP-Norm=1.533 | FP-Norm(final)=2.370 | 3862.2 samples/s | 60.3 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07403 | Reg=0.00279 | acc=0.9844 | FP-Norm=1.636 | FP-Norm(final)=2.370 | 5049.0 samples/s | 78.9 steps/s
[Step=2650 Epoch=13.0] | Loss=0.06773 | Reg=0.00308 | acc=0.9844 | FP-Norm=1.721 | FP-Norm(final)=2.373 | 1629.7 samples/s | 25.5 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06242 | Reg=0.00333 | acc=1.0000 | FP-Norm=1.792 | FP-Norm(final)=2.378 | 3814.1 samples/s | 59.6 steps/s
[Step=2750 Epoch=13.5] | Loss=0.05953 | Reg=0.00357 | acc=0.9844 | FP-Norm=1.854 | FP-Norm(final)=2.383 | 3763.5 samples/s | 58.8 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05648 | Reg=0.00379 | acc=0.9688 | FP-Norm=1.912 | FP-Norm(final)=2.388 | 4704.2 samples/s | 73.5 steps/s
[Step=2850 Epoch=14.0] | Loss=0.05294 | Reg=0.00399 | acc=0.9844 | FP-Norm=1.962 | FP-Norm(final)=2.394 | 1707.7 samples/s | 26.7 steps/s
[Step=2900 Epoch=14.2] | Loss=0.05071 | Reg=0.00418 | acc=0.9844 | FP-Norm=2.008 | FP-Norm(final)=2.400 | 3918.0 samples/s | 61.2 steps/s
[Step=2950 Epoch=14.5] | Loss=0.04832 | Reg=0.00436 | acc=0.9688 | FP-Norm=2.050 | FP-Norm(final)=2.405 | 3926.0 samples/s | 61.3 steps/s
[Step=3000 Epoch=14.7] | Loss=0.04634 | Reg=0.00452 | acc=0.9688 | FP-Norm=2.089 | FP-Norm(final)=2.411 | 4789.7 samples/s | 74.8 steps/s
[Step=3050 Epoch=15.0] | Loss=0.04460 | Reg=0.00468 | acc=0.9844 | FP-Norm=2.127 | FP-Norm(final)=2.417 | 1701.6 samples/s | 26.6 steps/s
[Step=3100 Epoch=15.2] | Loss=0.04311 | Reg=0.00483 | acc=0.9688 | FP-Norm=2.161 | FP-Norm(final)=2.421 | 3848.5 samples/s | 60.1 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04157 | Reg=0.00498 | acc=0.9844 | FP-Norm=2.193 | FP-Norm(final)=2.426 | 3875.8 samples/s | 60.6 steps/s
[Step=3200 Epoch=15.7] | Loss=0.04048 | Reg=0.00511 | acc=1.0000 | FP-Norm=2.222 | FP-Norm(final)=2.431 | 4429.7 samples/s | 69.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step3200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.22484 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.380 | 3564.7 samples/s | 55.7 steps/s
[Step=2450 Epoch=23.2] | Loss=0.02803 | Reg=0.00500 | acc=0.9844 | FP-Norm=2.121 | FP-Norm(final)=2.348 | 3541.0 samples/s | 55.3 steps/s
[Step=2500 Epoch=23.7] | Loss=0.01628 | Reg=0.00588 | acc=1.0000 | FP-Norm=2.361 | FP-Norm(final)=2.350 | 4873.7 samples/s | 76.2 steps/s
[Step=2550 Epoch=24.2] | Loss=0.01132 | Reg=0.00596 | acc=1.0000 | FP-Norm=2.399 | FP-Norm(final)=2.356 | 1575.1 samples/s | 24.6 steps/s
[Step=2600 Epoch=24.6] | Loss=0.00885 | Reg=0.00584 | acc=1.0000 | FP-Norm=2.383 | FP-Norm(final)=2.361 | 4444.1 samples/s | 69.4 steps/s
[Step=2650 Epoch=25.1] | Loss=0.00711 | Reg=0.00564 | acc=1.0000 | FP-Norm=2.348 | FP-Norm(final)=2.366 | 1636.8 samples/s | 25.6 steps/s
[Step=2700 Epoch=25.6] | Loss=0.00593 | Reg=0.00542 | acc=1.0000 | FP-Norm=2.301 | FP-Norm(final)=2.370 | 4192.0 samples/s | 65.5 steps/s
[Step=2750 Epoch=26.1] | Loss=0.00510 | Reg=0.00519 | acc=1.0000 | FP-Norm=2.251 | FP-Norm(final)=2.373 | 1670.5 samples/s | 26.1 steps/s
[Step=2800 Epoch=26.5] | Loss=0.00447 | Reg=0.00496 | acc=1.0000 | FP-Norm=2.200 | FP-Norm(final)=2.376 | 3903.5 samples/s | 61.0 steps/s
[Step=2850 Epoch=27.0] | Loss=0.00398 | Reg=0.00475 | acc=1.0000 | FP-Norm=2.150 | FP-Norm(final)=2.378 | 1711.7 samples/s | 26.7 steps/s
[Step=2900 Epoch=27.5] | Loss=0.00359 | Reg=0.00455 | acc=1.0000 | FP-Norm=2.102 | FP-Norm(final)=2.381 | 3741.0 samples/s | 58.5 steps/s
[Step=2950 Epoch=28.0] | Loss=0.00327 | Reg=0.00437 | acc=1.0000 | FP-Norm=2.055 | FP-Norm(final)=2.383 | 1763.6 samples/s | 27.6 steps/s
[Step=3000 Epoch=28.4] | Loss=0.00300 | Reg=0.00419 | acc=1.0000 | FP-Norm=2.009 | FP-Norm(final)=2.385 | 3789.5 samples/s | 59.2 steps/s
[Step=3050 Epoch=28.9] | Loss=0.00278 | Reg=0.00403 | acc=1.0000 | FP-Norm=1.966 | FP-Norm(final)=2.387 | 1785.6 samples/s | 27.9 steps/s
[Step=3100 Epoch=29.4] | Loss=0.00258 | Reg=0.00388 | acc=1.0000 | FP-Norm=1.923 | FP-Norm(final)=2.389 | 3650.0 samples/s | 57.0 steps/s
[Step=3150 Epoch=29.8] | Loss=0.00242 | Reg=0.00374 | acc=1.0000 | FP-Norm=1.883 | FP-Norm(final)=2.390 | 1763.4 samples/s | 27.6 steps/s
[Step=3200 Epoch=30.3] | Loss=0.00227 | Reg=0.00360 | acc=1.0000 | FP-Norm=1.844 | FP-Norm(final)=2.392 | 3683.2 samples/s | 57.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step3200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.20424 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.380 | 3898.6 samples/s | 60.9 steps/s
[Step=2450 Epoch=23.3] | Loss=0.03504 | Reg=0.00654 | acc=0.9844 | FP-Norm=2.408 | FP-Norm(final)=2.334 | 3186.8 samples/s | 49.8 steps/s
[Step=2500 Epoch=23.8] | Loss=0.01980 | Reg=0.00792 | acc=1.0000 | FP-Norm=2.729 | FP-Norm(final)=2.331 | 4777.4 samples/s | 74.6 steps/s
[Step=2550 Epoch=24.3] | Loss=0.01347 | Reg=0.00789 | acc=1.0000 | FP-Norm=2.752 | FP-Norm(final)=2.336 | 1592.0 samples/s | 24.9 steps/s
[Step=2600 Epoch=24.7] | Loss=0.01012 | Reg=0.00758 | acc=1.0000 | FP-Norm=2.707 | FP-Norm(final)=2.340 | 4476.7 samples/s | 69.9 steps/s
[Step=2650 Epoch=25.2] | Loss=0.00811 | Reg=0.00720 | acc=1.0000 | FP-Norm=2.643 | FP-Norm(final)=2.345 | 1600.0 samples/s | 25.0 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00678 | Reg=0.00684 | acc=1.0000 | FP-Norm=2.576 | FP-Norm(final)=2.348 | 4184.4 samples/s | 65.4 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00582 | Reg=0.00649 | acc=1.0000 | FP-Norm=2.509 | FP-Norm(final)=2.352 | 1670.2 samples/s | 26.1 steps/s
[Step=2800 Epoch=26.6] | Loss=0.00510 | Reg=0.00618 | acc=1.0000 | FP-Norm=2.444 | FP-Norm(final)=2.355 | 3878.5 samples/s | 60.6 steps/s
[Step=2850 Epoch=27.1] | Loss=0.00455 | Reg=0.00589 | acc=1.0000 | FP-Norm=2.382 | FP-Norm(final)=2.358 | 1718.8 samples/s | 26.9 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00410 | Reg=0.00562 | acc=1.0000 | FP-Norm=2.323 | FP-Norm(final)=2.361 | 3835.1 samples/s | 59.9 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00373 | Reg=0.00537 | acc=1.0000 | FP-Norm=2.267 | FP-Norm(final)=2.364 | 1776.3 samples/s | 27.8 steps/s
[Step=3000 Epoch=28.5] | Loss=0.00343 | Reg=0.00514 | acc=1.0000 | FP-Norm=2.213 | FP-Norm(final)=2.367 | 3679.3 samples/s | 57.5 steps/s
[Step=3050 Epoch=29.0] | Loss=0.00317 | Reg=0.00493 | acc=1.0000 | FP-Norm=2.162 | FP-Norm(final)=2.370 | 1788.3 samples/s | 27.9 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00295 | Reg=0.00473 | acc=1.0000 | FP-Norm=2.113 | FP-Norm(final)=2.372 | 3765.7 samples/s | 58.8 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00277 | Reg=0.00455 | acc=1.0000 | FP-Norm=2.066 | FP-Norm(final)=2.375 | 1744.1 samples/s | 27.3 steps/s
[Step=3200 Epoch=30.4] | Loss=0.00260 | Reg=0.00438 | acc=1.0000 | FP-Norm=2.022 | FP-Norm(final)=2.378 | 3680.8 samples/s | 57.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step3200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.9] | Loss=0.11063 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.382 | 3442.7 samples/s | 53.8 steps/s
[Step=2450 Epoch=23.4] | Loss=0.02574 | Reg=0.00523 | acc=0.9844 | FP-Norm=2.153 | FP-Norm(final)=2.356 | 3617.9 samples/s | 56.5 steps/s
[Step=2500 Epoch=23.9] | Loss=0.01732 | Reg=0.00630 | acc=1.0000 | FP-Norm=2.433 | FP-Norm(final)=2.353 | 4750.2 samples/s | 74.2 steps/s
[Step=2550 Epoch=24.4] | Loss=0.01173 | Reg=0.00664 | acc=1.0000 | FP-Norm=2.525 | FP-Norm(final)=2.352 | 1580.6 samples/s | 24.7 steps/s
[Step=2600 Epoch=24.8] | Loss=0.00890 | Reg=0.00656 | acc=1.0000 | FP-Norm=2.522 | FP-Norm(final)=2.354 | 4547.0 samples/s | 71.0 steps/s
[Step=2650 Epoch=25.3] | Loss=0.00716 | Reg=0.00635 | acc=1.0000 | FP-Norm=2.487 | FP-Norm(final)=2.356 | 1620.1 samples/s | 25.3 steps/s
[Step=2700 Epoch=25.8] | Loss=0.00598 | Reg=0.00611 | acc=1.0000 | FP-Norm=2.441 | FP-Norm(final)=2.359 | 4348.2 samples/s | 67.9 steps/s
[Step=2750 Epoch=26.3] | Loss=0.00513 | Reg=0.00586 | acc=1.0000 | FP-Norm=2.390 | FP-Norm(final)=2.361 | 1647.2 samples/s | 25.7 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00450 | Reg=0.00561 | acc=1.0000 | FP-Norm=2.337 | FP-Norm(final)=2.363 | 4162.2 samples/s | 65.0 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00400 | Reg=0.00537 | acc=1.0000 | FP-Norm=2.284 | FP-Norm(final)=2.365 | 1688.8 samples/s | 26.4 steps/s
[Step=2900 Epoch=27.7] | Loss=0.00361 | Reg=0.00515 | acc=1.0000 | FP-Norm=2.232 | FP-Norm(final)=2.367 | 4012.7 samples/s | 62.7 steps/s
[Step=2950 Epoch=28.2] | Loss=0.00328 | Reg=0.00493 | acc=1.0000 | FP-Norm=2.182 | FP-Norm(final)=2.369 | 1728.5 samples/s | 27.0 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00302 | Reg=0.00474 | acc=1.0000 | FP-Norm=2.133 | FP-Norm(final)=2.371 | 3670.3 samples/s | 57.3 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00279 | Reg=0.00455 | acc=1.0000 | FP-Norm=2.086 | FP-Norm(final)=2.373 | 1766.5 samples/s | 27.6 steps/s
[Step=3100 Epoch=29.6] | Loss=0.00259 | Reg=0.00438 | acc=1.0000 | FP-Norm=2.041 | FP-Norm(final)=2.375 | 3708.1 samples/s | 57.9 steps/s
[Step=3150 Epoch=30.1] | Loss=0.00243 | Reg=0.00421 | acc=1.0000 | FP-Norm=1.997 | FP-Norm(final)=2.376 | 1751.9 samples/s | 27.4 steps/s
[Step=3200 Epoch=30.6] | Loss=0.00228 | Reg=0.00406 | acc=1.0000 | FP-Norm=1.955 | FP-Norm(final)=2.378 | 3770.5 samples/s | 58.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step3200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.6] | Loss=0.19847 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.380 | 3531.7 samples/s | 55.2 steps/s
[Step=2450 Epoch=23.1] | Loss=0.04349 | Reg=0.00767 | acc=0.9844 | FP-Norm=2.600 | FP-Norm(final)=2.318 | 3618.7 samples/s | 56.5 steps/s
[Step=2500 Epoch=23.6] | Loss=0.02526 | Reg=0.00895 | acc=1.0000 | FP-Norm=2.898 | FP-Norm(final)=2.311 | 4740.1 samples/s | 74.1 steps/s
[Step=2550 Epoch=24.0] | Loss=0.01712 | Reg=0.00882 | acc=1.0000 | FP-Norm=2.907 | FP-Norm(final)=2.315 | 1583.1 samples/s | 24.7 steps/s
[Step=2600 Epoch=24.5] | Loss=0.01296 | Reg=0.00844 | acc=1.0000 | FP-Norm=2.855 | FP-Norm(final)=2.320 | 4344.5 samples/s | 67.9 steps/s
[Step=2650 Epoch=25.0] | Loss=0.01040 | Reg=0.00802 | acc=1.0000 | FP-Norm=2.789 | FP-Norm(final)=2.325 | 1143.6 samples/s | 17.9 steps/s
[Step=2700 Epoch=25.4] | Loss=0.00869 | Reg=0.00762 | acc=1.0000 | FP-Norm=2.718 | FP-Norm(final)=2.330 | 4147.5 samples/s | 64.8 steps/s
[Step=2750 Epoch=25.9] | Loss=0.00746 | Reg=0.00724 | acc=1.0000 | FP-Norm=2.649 | FP-Norm(final)=2.334 | 1689.4 samples/s | 26.4 steps/s
[Step=2800 Epoch=26.4] | Loss=0.00654 | Reg=0.00690 | acc=1.0000 | FP-Norm=2.582 | FP-Norm(final)=2.338 | 3821.1 samples/s | 59.7 steps/s
[Step=2850 Epoch=26.9] | Loss=0.00583 | Reg=0.00658 | acc=1.0000 | FP-Norm=2.518 | FP-Norm(final)=2.342 | 1717.8 samples/s | 26.8 steps/s
[Step=2900 Epoch=27.3] | Loss=0.00525 | Reg=0.00629 | acc=1.0000 | FP-Norm=2.458 | FP-Norm(final)=2.345 | 3679.8 samples/s | 57.5 steps/s
[Step=2950 Epoch=27.8] | Loss=0.00478 | Reg=0.00602 | acc=1.0000 | FP-Norm=2.400 | FP-Norm(final)=2.348 | 1778.0 samples/s | 27.8 steps/s
[Step=3000 Epoch=28.3] | Loss=0.00439 | Reg=0.00577 | acc=1.0000 | FP-Norm=2.345 | FP-Norm(final)=2.352 | 3709.9 samples/s | 58.0 steps/s
[Step=3050 Epoch=28.7] | Loss=0.00406 | Reg=0.00554 | acc=1.0000 | FP-Norm=2.293 | FP-Norm(final)=2.355 | 1797.2 samples/s | 28.1 steps/s
[Step=3100 Epoch=29.2] | Loss=0.00378 | Reg=0.00533 | acc=1.0000 | FP-Norm=2.244 | FP-Norm(final)=2.358 | 3620.9 samples/s | 56.6 steps/s
[Step=3150 Epoch=29.7] | Loss=0.00353 | Reg=0.00513 | acc=1.0000 | FP-Norm=2.196 | FP-Norm(final)=2.361 | 1831.4 samples/s | 28.6 steps/s
[Step=3200 Epoch=30.2] | Loss=0.00332 | Reg=0.00494 | acc=1.0000 | FP-Norm=2.150 | FP-Norm(final)=2.364 | 3488.6 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step3200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.9] | Loss=0.13596 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.382 | 3607.4 samples/s | 56.4 steps/s
[Step=2450 Epoch=23.4] | Loss=0.02432 | Reg=0.00481 | acc=0.9844 | FP-Norm=2.075 | FP-Norm(final)=2.362 | 3562.0 samples/s | 55.7 steps/s
[Step=2500 Epoch=23.8] | Loss=0.01518 | Reg=0.00602 | acc=1.0000 | FP-Norm=2.381 | FP-Norm(final)=2.356 | 4946.2 samples/s | 77.3 steps/s
[Step=2550 Epoch=24.3] | Loss=0.01028 | Reg=0.00613 | acc=1.0000 | FP-Norm=2.427 | FP-Norm(final)=2.357 | 1599.0 samples/s | 25.0 steps/s
[Step=2600 Epoch=24.8] | Loss=0.00777 | Reg=0.00595 | acc=1.0000 | FP-Norm=2.403 | FP-Norm(final)=2.359 | 4489.9 samples/s | 70.2 steps/s
[Step=2650 Epoch=25.3] | Loss=0.00623 | Reg=0.00571 | acc=1.0000 | FP-Norm=2.358 | FP-Norm(final)=2.362 | 1626.7 samples/s | 25.4 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00521 | Reg=0.00546 | acc=1.0000 | FP-Norm=2.306 | FP-Norm(final)=2.364 | 4341.8 samples/s | 67.8 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00447 | Reg=0.00521 | acc=1.0000 | FP-Norm=2.253 | FP-Norm(final)=2.366 | 1671.7 samples/s | 26.1 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00392 | Reg=0.00498 | acc=1.0000 | FP-Norm=2.200 | FP-Norm(final)=2.368 | 4083.2 samples/s | 63.8 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00350 | Reg=0.00476 | acc=1.0000 | FP-Norm=2.148 | FP-Norm(final)=2.370 | 1705.7 samples/s | 26.7 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00315 | Reg=0.00456 | acc=1.0000 | FP-Norm=2.099 | FP-Norm(final)=2.372 | 3951.1 samples/s | 61.7 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00287 | Reg=0.00437 | acc=1.0000 | FP-Norm=2.051 | FP-Norm(final)=2.374 | 1754.9 samples/s | 27.4 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00264 | Reg=0.00419 | acc=1.0000 | FP-Norm=2.005 | FP-Norm(final)=2.376 | 3856.1 samples/s | 60.3 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00244 | Reg=0.00403 | acc=1.0000 | FP-Norm=1.961 | FP-Norm(final)=2.378 | 1770.1 samples/s | 27.7 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00228 | Reg=0.00387 | acc=1.0000 | FP-Norm=1.918 | FP-Norm(final)=2.379 | 3675.5 samples/s | 57.4 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00213 | Reg=0.00373 | acc=1.0000 | FP-Norm=1.878 | FP-Norm(final)=2.381 | 1776.8 samples/s | 27.8 steps/s
[Step=3200 Epoch=30.5] | Loss=0.00200 | Reg=0.00359 | acc=1.0000 | FP-Norm=1.839 | FP-Norm(final)=2.383 | 3712.2 samples/s | 58.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20728 | acc=0.8287 | tpr=0.7754 | fpr=0.0557 | 3803.4 samples/s | 14.9 steps/s
Avg test loss: 0.20756, Avg test acc: 0.82903, Avg tpr: 0.77543, Avg fpr: 0.05307, total FA: 414

Testing server on iccad2012
[Step=  50] | Loss=0.49247 | acc=0.7122 | tpr=0.9558 | fpr=0.2922 | 3768.5 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.49677 | acc=0.7134 | tpr=0.9552 | fpr=0.2911 | 7208.8 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.50018 | acc=0.7132 | tpr=0.9582 | fpr=0.2913 | 7155.5 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.49962 | acc=0.7146 | tpr=0.9617 | fpr=0.2899 | 7170.3 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.49872 | acc=0.7151 | tpr=0.9590 | fpr=0.2893 | 7124.1 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.49948 | acc=0.7158 | tpr=0.9556 | fpr=0.2886 | 7204.8 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.49971 | acc=0.7155 | tpr=0.9587 | fpr=0.2889 | 7035.1 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.50085 | acc=0.7143 | tpr=0.9584 | fpr=0.2902 | 7265.7 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.50206 | acc=0.7143 | tpr=0.9591 | fpr=0.2902 | 6954.9 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.50310 | acc=0.7139 | tpr=0.9595 | fpr=0.2905 | 7114.2 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.50254 | acc=0.7145 | tpr=0.9594 | fpr=0.2900 | 13063.1 samples/s | 51.0 steps/s
Avg test loss: 0.50265, Avg test acc: 0.71442, Avg tpr: 0.95959, Avg fpr: 0.29004, total FA: 40271

server round 4/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.17116 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.447 | 3844.4 samples/s | 60.1 steps/s
[Step=3250 Epoch=15.8] | Loss=0.08147 | Reg=0.00141 | acc=0.9844 | FP-Norm=1.129 | FP-Norm(final)=2.430 | 3783.7 samples/s | 59.1 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07631 | Reg=0.00186 | acc=0.9531 | FP-Norm=1.323 | FP-Norm(final)=2.429 | 3982.6 samples/s | 62.2 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07058 | Reg=0.00217 | acc=0.9688 | FP-Norm=1.438 | FP-Norm(final)=2.429 | 3932.1 samples/s | 61.4 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06563 | Reg=0.00241 | acc=0.9531 | FP-Norm=1.522 | FP-Norm(final)=2.430 | 5061.7 samples/s | 79.1 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06172 | Reg=0.00275 | acc=0.9844 | FP-Norm=1.622 | FP-Norm(final)=2.429 | 1673.0 samples/s | 26.1 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05756 | Reg=0.00300 | acc=0.9375 | FP-Norm=1.696 | FP-Norm(final)=2.430 | 3963.2 samples/s | 61.9 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05479 | Reg=0.00320 | acc=0.9844 | FP-Norm=1.753 | FP-Norm(final)=2.432 | 3965.4 samples/s | 62.0 steps/s
[Step=3600 Epoch=17.6] | Loss=0.05204 | Reg=0.00337 | acc=1.0000 | FP-Norm=1.801 | FP-Norm(final)=2.436 | 4852.0 samples/s | 75.8 steps/s
[Step=3650 Epoch=17.8] | Loss=0.05105 | Reg=0.00365 | acc=0.9219 | FP-Norm=1.869 | FP-Norm(final)=2.439 | 1713.8 samples/s | 26.8 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04953 | Reg=0.00395 | acc=0.9844 | FP-Norm=1.941 | FP-Norm(final)=2.442 | 3829.0 samples/s | 59.8 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04731 | Reg=0.00419 | acc=0.9531 | FP-Norm=1.998 | FP-Norm(final)=2.445 | 3851.8 samples/s | 60.2 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04579 | Reg=0.00440 | acc=0.9844 | FP-Norm=2.046 | FP-Norm(final)=2.448 | 4398.6 samples/s | 68.7 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04400 | Reg=0.00457 | acc=1.0000 | FP-Norm=2.088 | FP-Norm(final)=2.451 | 1718.8 samples/s | 26.9 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04227 | Reg=0.00473 | acc=1.0000 | FP-Norm=2.124 | FP-Norm(final)=2.454 | 3852.4 samples/s | 60.2 steps/s
[Step=3950 Epoch=19.3] | Loss=0.04100 | Reg=0.00485 | acc=1.0000 | FP-Norm=2.154 | FP-Norm(final)=2.458 | 3836.9 samples/s | 60.0 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03962 | Reg=0.00497 | acc=0.9688 | FP-Norm=2.182 | FP-Norm(final)=2.461 | 4152.2 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.15711 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.447 | 3972.0 samples/s | 62.1 steps/s
[Step=3250 Epoch=15.9] | Loss=0.07429 | Reg=0.00145 | acc=0.9375 | FP-Norm=1.149 | FP-Norm(final)=2.436 | 3664.2 samples/s | 57.3 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07042 | Reg=0.00194 | acc=0.8906 | FP-Norm=1.352 | FP-Norm(final)=2.432 | 3942.1 samples/s | 61.6 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06881 | Reg=0.00229 | acc=0.9375 | FP-Norm=1.479 | FP-Norm(final)=2.429 | 3932.8 samples/s | 61.5 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06577 | Reg=0.00257 | acc=0.9531 | FP-Norm=1.571 | FP-Norm(final)=2.428 | 5129.7 samples/s | 80.2 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06022 | Reg=0.00283 | acc=0.9688 | FP-Norm=1.649 | FP-Norm(final)=2.429 | 1655.8 samples/s | 25.9 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05612 | Reg=0.00304 | acc=0.9531 | FP-Norm=1.712 | FP-Norm(final)=2.433 | 3828.9 samples/s | 59.8 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05259 | Reg=0.00324 | acc=0.9531 | FP-Norm=1.769 | FP-Norm(final)=2.436 | 3870.7 samples/s | 60.5 steps/s
[Step=3600 Epoch=17.6] | Loss=0.05069 | Reg=0.00345 | acc=0.9688 | FP-Norm=1.824 | FP-Norm(final)=2.440 | 4717.6 samples/s | 73.7 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04851 | Reg=0.00366 | acc=0.9688 | FP-Norm=1.878 | FP-Norm(final)=2.445 | 1731.8 samples/s | 27.1 steps/s
[Step=3700 Epoch=18.1] | Loss=0.04669 | Reg=0.00384 | acc=1.0000 | FP-Norm=1.924 | FP-Norm(final)=2.449 | 3925.3 samples/s | 61.3 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04476 | Reg=0.00402 | acc=0.9844 | FP-Norm=1.968 | FP-Norm(final)=2.453 | 3836.3 samples/s | 59.9 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04369 | Reg=0.00419 | acc=1.0000 | FP-Norm=2.010 | FP-Norm(final)=2.457 | 4501.0 samples/s | 70.3 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04199 | Reg=0.00436 | acc=0.9844 | FP-Norm=2.050 | FP-Norm(final)=2.461 | 1705.6 samples/s | 26.7 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04064 | Reg=0.00452 | acc=0.9688 | FP-Norm=2.086 | FP-Norm(final)=2.466 | 3857.6 samples/s | 60.3 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03932 | Reg=0.00467 | acc=1.0000 | FP-Norm=2.121 | FP-Norm(final)=2.470 | 3848.1 samples/s | 60.1 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03826 | Reg=0.00481 | acc=0.9688 | FP-Norm=2.153 | FP-Norm(final)=2.473 | 4356.2 samples/s | 68.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step4000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.11162 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.447 | 3784.7 samples/s | 59.1 steps/s
[Step=3250 Epoch=15.8] | Loss=0.08092 | Reg=0.00172 | acc=0.9062 | FP-Norm=1.251 | FP-Norm(final)=2.432 | 3796.1 samples/s | 59.3 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07623 | Reg=0.00222 | acc=0.9531 | FP-Norm=1.451 | FP-Norm(final)=2.426 | 3972.2 samples/s | 62.1 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07056 | Reg=0.00254 | acc=0.9844 | FP-Norm=1.561 | FP-Norm(final)=2.422 | 3922.7 samples/s | 61.3 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06723 | Reg=0.00281 | acc=0.9688 | FP-Norm=1.645 | FP-Norm(final)=2.421 | 5058.7 samples/s | 79.0 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06103 | Reg=0.00305 | acc=0.9375 | FP-Norm=1.716 | FP-Norm(final)=2.424 | 1692.9 samples/s | 26.5 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05817 | Reg=0.00327 | acc=0.9688 | FP-Norm=1.779 | FP-Norm(final)=2.428 | 3883.3 samples/s | 60.7 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05495 | Reg=0.00348 | acc=1.0000 | FP-Norm=1.836 | FP-Norm(final)=2.433 | 3818.5 samples/s | 59.7 steps/s
[Step=3600 Epoch=17.5] | Loss=0.05193 | Reg=0.00369 | acc=1.0000 | FP-Norm=1.890 | FP-Norm(final)=2.438 | 4723.9 samples/s | 73.8 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04929 | Reg=0.00390 | acc=0.9688 | FP-Norm=1.943 | FP-Norm(final)=2.443 | 1699.4 samples/s | 26.6 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04717 | Reg=0.00409 | acc=0.9844 | FP-Norm=1.990 | FP-Norm(final)=2.448 | 3821.0 samples/s | 59.7 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04546 | Reg=0.00427 | acc=0.9688 | FP-Norm=2.033 | FP-Norm(final)=2.453 | 3867.0 samples/s | 60.4 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04471 | Reg=0.00445 | acc=0.9375 | FP-Norm=2.074 | FP-Norm(final)=2.456 | 4393.7 samples/s | 68.7 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04380 | Reg=0.00463 | acc=1.0000 | FP-Norm=2.116 | FP-Norm(final)=2.459 | 1772.1 samples/s | 27.7 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04233 | Reg=0.00480 | acc=0.9844 | FP-Norm=2.154 | FP-Norm(final)=2.462 | 3940.3 samples/s | 61.6 steps/s
[Step=3950 Epoch=19.2] | Loss=0.04092 | Reg=0.00494 | acc=0.9844 | FP-Norm=2.186 | FP-Norm(final)=2.465 | 3973.1 samples/s | 62.1 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03969 | Reg=0.00508 | acc=0.9844 | FP-Norm=2.215 | FP-Norm(final)=2.468 | 4140.7 samples/s | 64.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step4000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.20473 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.447 | 4067.3 samples/s | 63.6 steps/s
[Step=3250 Epoch=15.8] | Loss=0.07138 | Reg=0.00187 | acc=0.9844 | FP-Norm=1.312 | FP-Norm(final)=2.431 | 3534.0 samples/s | 55.2 steps/s
[Step=3300 Epoch=16.1] | Loss=0.06815 | Reg=0.00234 | acc=0.9688 | FP-Norm=1.493 | FP-Norm(final)=2.425 | 3934.6 samples/s | 61.5 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06578 | Reg=0.00263 | acc=1.0000 | FP-Norm=1.594 | FP-Norm(final)=2.423 | 3956.1 samples/s | 61.8 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06127 | Reg=0.00286 | acc=0.9844 | FP-Norm=1.664 | FP-Norm(final)=2.424 | 5119.8 samples/s | 80.0 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05711 | Reg=0.00318 | acc=1.0000 | FP-Norm=1.755 | FP-Norm(final)=2.427 | 1673.3 samples/s | 26.1 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05272 | Reg=0.00346 | acc=0.9844 | FP-Norm=1.830 | FP-Norm(final)=2.432 | 3861.9 samples/s | 60.3 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05057 | Reg=0.00367 | acc=0.9531 | FP-Norm=1.885 | FP-Norm(final)=2.438 | 3856.4 samples/s | 60.3 steps/s
[Step=3600 Epoch=17.6] | Loss=0.04857 | Reg=0.00388 | acc=0.9688 | FP-Norm=1.939 | FP-Norm(final)=2.442 | 4613.5 samples/s | 72.1 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04689 | Reg=0.00409 | acc=1.0000 | FP-Norm=1.990 | FP-Norm(final)=2.447 | 1687.0 samples/s | 26.4 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04464 | Reg=0.00430 | acc=0.9688 | FP-Norm=2.040 | FP-Norm(final)=2.452 | 3838.3 samples/s | 60.0 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04345 | Reg=0.00449 | acc=0.9688 | FP-Norm=2.084 | FP-Norm(final)=2.455 | 3859.2 samples/s | 60.3 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04232 | Reg=0.00466 | acc=0.9844 | FP-Norm=2.124 | FP-Norm(final)=2.459 | 4396.0 samples/s | 68.7 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04088 | Reg=0.00483 | acc=1.0000 | FP-Norm=2.162 | FP-Norm(final)=2.462 | 1736.5 samples/s | 27.1 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03928 | Reg=0.00498 | acc=0.9688 | FP-Norm=2.195 | FP-Norm(final)=2.466 | 3833.1 samples/s | 59.9 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03791 | Reg=0.00511 | acc=1.0000 | FP-Norm=2.225 | FP-Norm(final)=2.470 | 3828.4 samples/s | 59.8 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03692 | Reg=0.00523 | acc=0.9688 | FP-Norm=2.252 | FP-Norm(final)=2.473 | 4113.0 samples/s | 64.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step4000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.7] | Loss=0.17020 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.447 | 3684.2 samples/s | 57.6 steps/s
[Step=3250 Epoch=15.9] | Loss=0.08168 | Reg=0.00153 | acc=0.9219 | FP-Norm=1.171 | FP-Norm(final)=2.425 | 3941.0 samples/s | 61.6 steps/s
[Step=3300 Epoch=16.2] | Loss=0.07366 | Reg=0.00212 | acc=0.9531 | FP-Norm=1.408 | FP-Norm(final)=2.417 | 3918.7 samples/s | 61.2 steps/s
[Step=3350 Epoch=16.4] | Loss=0.07061 | Reg=0.00247 | acc=0.9219 | FP-Norm=1.532 | FP-Norm(final)=2.417 | 3838.1 samples/s | 60.0 steps/s
[Step=3400 Epoch=16.7] | Loss=0.06699 | Reg=0.00281 | acc=0.9531 | FP-Norm=1.637 | FP-Norm(final)=2.418 | 4987.1 samples/s | 77.9 steps/s
[Step=3450 Epoch=16.9] | Loss=0.06025 | Reg=0.00311 | acc=0.9688 | FP-Norm=1.727 | FP-Norm(final)=2.421 | 1673.5 samples/s | 26.1 steps/s
[Step=3500 Epoch=17.2] | Loss=0.05587 | Reg=0.00336 | acc=0.9531 | FP-Norm=1.795 | FP-Norm(final)=2.426 | 3942.6 samples/s | 61.6 steps/s
[Step=3550 Epoch=17.4] | Loss=0.05334 | Reg=0.00359 | acc=0.9844 | FP-Norm=1.857 | FP-Norm(final)=2.430 | 3951.8 samples/s | 61.7 steps/s
[Step=3600 Epoch=17.7] | Loss=0.05131 | Reg=0.00379 | acc=1.0000 | FP-Norm=1.910 | FP-Norm(final)=2.434 | 4906.6 samples/s | 76.7 steps/s
[Step=3650 Epoch=17.9] | Loss=0.04827 | Reg=0.00399 | acc=0.9688 | FP-Norm=1.960 | FP-Norm(final)=2.438 | 1691.4 samples/s | 26.4 steps/s
[Step=3700 Epoch=18.1] | Loss=0.04571 | Reg=0.00417 | acc=1.0000 | FP-Norm=2.004 | FP-Norm(final)=2.444 | 3941.9 samples/s | 61.6 steps/s
[Step=3750 Epoch=18.4] | Loss=0.04483 | Reg=0.00436 | acc=0.9531 | FP-Norm=2.050 | FP-Norm(final)=2.448 | 3925.1 samples/s | 61.3 steps/s
[Step=3800 Epoch=18.6] | Loss=0.04366 | Reg=0.00457 | acc=0.9688 | FP-Norm=2.099 | FP-Norm(final)=2.452 | 4610.7 samples/s | 72.0 steps/s
[Step=3850 Epoch=18.9] | Loss=0.04226 | Reg=0.00477 | acc=0.9688 | FP-Norm=2.142 | FP-Norm(final)=2.455 | 1710.6 samples/s | 26.7 steps/s
[Step=3900 Epoch=19.1] | Loss=0.04072 | Reg=0.00493 | acc=1.0000 | FP-Norm=2.179 | FP-Norm(final)=2.459 | 3928.8 samples/s | 61.4 steps/s
[Step=3950 Epoch=19.4] | Loss=0.03969 | Reg=0.00508 | acc=0.9688 | FP-Norm=2.212 | FP-Norm(final)=2.462 | 3962.1 samples/s | 61.9 steps/s
[Step=4000 Epoch=19.6] | Loss=0.03874 | Reg=0.00523 | acc=0.9844 | FP-Norm=2.244 | FP-Norm(final)=2.466 | 4495.5 samples/s | 70.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step4000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.3] | Loss=0.12898 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.447 | 3604.5 samples/s | 56.3 steps/s
[Step=3250 Epoch=30.8] | Loss=0.03340 | Reg=0.00786 | acc=1.0000 | FP-Norm=2.648 | FP-Norm(final)=2.376 | 3653.8 samples/s | 57.1 steps/s
[Step=3300 Epoch=31.3] | Loss=0.02085 | Reg=0.00886 | acc=1.0000 | FP-Norm=2.894 | FP-Norm(final)=2.366 | 4754.5 samples/s | 74.3 steps/s
[Step=3350 Epoch=31.7] | Loss=0.01410 | Reg=0.00871 | acc=1.0000 | FP-Norm=2.896 | FP-Norm(final)=2.368 | 1605.6 samples/s | 25.1 steps/s
[Step=3400 Epoch=32.2] | Loss=0.01072 | Reg=0.00830 | acc=1.0000 | FP-Norm=2.836 | FP-Norm(final)=2.373 | 4545.0 samples/s | 71.0 steps/s
[Step=3450 Epoch=32.7] | Loss=0.00861 | Reg=0.00786 | acc=1.0000 | FP-Norm=2.763 | FP-Norm(final)=2.379 | 1647.8 samples/s | 25.7 steps/s
[Step=3500 Epoch=33.2] | Loss=0.00720 | Reg=0.00745 | acc=1.0000 | FP-Norm=2.689 | FP-Norm(final)=2.384 | 4273.8 samples/s | 66.8 steps/s
[Step=3550 Epoch=33.6] | Loss=0.00618 | Reg=0.00707 | acc=1.0000 | FP-Norm=2.617 | FP-Norm(final)=2.389 | 1662.0 samples/s | 26.0 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00542 | Reg=0.00672 | acc=1.0000 | FP-Norm=2.548 | FP-Norm(final)=2.393 | 3920.1 samples/s | 61.3 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00483 | Reg=0.00640 | acc=1.0000 | FP-Norm=2.483 | FP-Norm(final)=2.396 | 1713.7 samples/s | 26.8 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00435 | Reg=0.00610 | acc=1.0000 | FP-Norm=2.420 | FP-Norm(final)=2.400 | 3767.1 samples/s | 58.9 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00396 | Reg=0.00583 | acc=1.0000 | FP-Norm=2.360 | FP-Norm(final)=2.403 | 1762.2 samples/s | 27.5 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00364 | Reg=0.00558 | acc=1.0000 | FP-Norm=2.303 | FP-Norm(final)=2.406 | 3742.9 samples/s | 58.5 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00336 | Reg=0.00535 | acc=1.0000 | FP-Norm=2.249 | FP-Norm(final)=2.409 | 1768.2 samples/s | 27.6 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00313 | Reg=0.00513 | acc=1.0000 | FP-Norm=2.198 | FP-Norm(final)=2.412 | 3651.0 samples/s | 57.0 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00292 | Reg=0.00493 | acc=1.0000 | FP-Norm=2.149 | FP-Norm(final)=2.415 | 1759.0 samples/s | 27.5 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00274 | Reg=0.00474 | acc=1.0000 | FP-Norm=2.102 | FP-Norm(final)=2.417 | 3775.6 samples/s | 59.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.4] | Loss=0.16903 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.445 | 3904.7 samples/s | 61.0 steps/s
[Step=3250 Epoch=30.9] | Loss=0.04119 | Reg=0.00765 | acc=0.9844 | FP-Norm=2.609 | FP-Norm(final)=2.382 | 3253.1 samples/s | 50.8 steps/s
[Step=3300 Epoch=31.4] | Loss=0.02323 | Reg=0.00913 | acc=1.0000 | FP-Norm=2.932 | FP-Norm(final)=2.368 | 4737.9 samples/s | 74.0 steps/s
[Step=3350 Epoch=31.9] | Loss=0.01556 | Reg=0.00904 | acc=1.0000 | FP-Norm=2.946 | FP-Norm(final)=2.371 | 1636.5 samples/s | 25.6 steps/s
[Step=3400 Epoch=32.3] | Loss=0.01173 | Reg=0.00866 | acc=1.0000 | FP-Norm=2.896 | FP-Norm(final)=2.375 | 4587.0 samples/s | 71.7 steps/s
[Step=3450 Epoch=32.8] | Loss=0.00943 | Reg=0.00825 | acc=1.0000 | FP-Norm=2.831 | FP-Norm(final)=2.380 | 1679.1 samples/s | 26.2 steps/s
[Step=3500 Epoch=33.3] | Loss=0.00786 | Reg=0.00785 | acc=1.0000 | FP-Norm=2.762 | FP-Norm(final)=2.384 | 4286.0 samples/s | 67.0 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00675 | Reg=0.00747 | acc=1.0000 | FP-Norm=2.693 | FP-Norm(final)=2.388 | 1705.2 samples/s | 26.6 steps/s
[Step=3600 Epoch=34.2] | Loss=0.00591 | Reg=0.00712 | acc=1.0000 | FP-Norm=2.627 | FP-Norm(final)=2.391 | 3963.9 samples/s | 61.9 steps/s
[Step=3650 Epoch=34.7] | Loss=0.00526 | Reg=0.00680 | acc=1.0000 | FP-Norm=2.564 | FP-Norm(final)=2.395 | 1703.2 samples/s | 26.6 steps/s
[Step=3700 Epoch=35.2] | Loss=0.00474 | Reg=0.00651 | acc=1.0000 | FP-Norm=2.503 | FP-Norm(final)=2.398 | 3807.9 samples/s | 59.5 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00432 | Reg=0.00623 | acc=1.0000 | FP-Norm=2.445 | FP-Norm(final)=2.401 | 1757.1 samples/s | 27.5 steps/s
[Step=3800 Epoch=36.1] | Loss=0.00396 | Reg=0.00598 | acc=1.0000 | FP-Norm=2.390 | FP-Norm(final)=2.404 | 3738.2 samples/s | 58.4 steps/s
[Step=3850 Epoch=36.6] | Loss=0.00366 | Reg=0.00574 | acc=1.0000 | FP-Norm=2.337 | FP-Norm(final)=2.407 | 1770.1 samples/s | 27.7 steps/s
[Step=3900 Epoch=37.1] | Loss=0.00341 | Reg=0.00552 | acc=1.0000 | FP-Norm=2.287 | FP-Norm(final)=2.410 | 3597.6 samples/s | 56.2 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00318 | Reg=0.00531 | acc=1.0000 | FP-Norm=2.238 | FP-Norm(final)=2.413 | 1770.1 samples/s | 27.7 steps/s
[Step=4000 Epoch=38.0] | Loss=0.00299 | Reg=0.00512 | acc=1.0000 | FP-Norm=2.191 | FP-Norm(final)=2.415 | 3612.7 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step4000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.6] | Loss=0.24226 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.445 | 4048.3 samples/s | 63.3 steps/s
[Step=3250 Epoch=31.0] | Loss=0.03906 | Reg=0.00798 | acc=1.0000 | FP-Norm=2.681 | FP-Norm(final)=2.378 | 3259.2 samples/s | 50.9 steps/s
[Step=3300 Epoch=31.5] | Loss=0.02162 | Reg=0.00897 | acc=1.0000 | FP-Norm=2.919 | FP-Norm(final)=2.364 | 4933.9 samples/s | 77.1 steps/s
[Step=3350 Epoch=32.0] | Loss=0.01460 | Reg=0.00874 | acc=1.0000 | FP-Norm=2.905 | FP-Norm(final)=2.365 | 1579.8 samples/s | 24.7 steps/s
[Step=3400 Epoch=32.5] | Loss=0.01099 | Reg=0.00834 | acc=1.0000 | FP-Norm=2.845 | FP-Norm(final)=2.368 | 4536.9 samples/s | 70.9 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00884 | Reg=0.00793 | acc=1.0000 | FP-Norm=2.778 | FP-Norm(final)=2.372 | 1621.6 samples/s | 25.3 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00738 | Reg=0.00753 | acc=1.0000 | FP-Norm=2.707 | FP-Norm(final)=2.375 | 4356.3 samples/s | 68.1 steps/s
[Step=3550 Epoch=33.9] | Loss=0.00633 | Reg=0.00716 | acc=1.0000 | FP-Norm=2.637 | FP-Norm(final)=2.379 | 1674.1 samples/s | 26.2 steps/s
[Step=3600 Epoch=34.4] | Loss=0.00554 | Reg=0.00681 | acc=1.0000 | FP-Norm=2.570 | FP-Norm(final)=2.382 | 4088.3 samples/s | 63.9 steps/s
[Step=3650 Epoch=34.9] | Loss=0.00493 | Reg=0.00650 | acc=1.0000 | FP-Norm=2.506 | FP-Norm(final)=2.385 | 1691.1 samples/s | 26.4 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00445 | Reg=0.00620 | acc=1.0000 | FP-Norm=2.444 | FP-Norm(final)=2.388 | 4009.3 samples/s | 62.6 steps/s
[Step=3750 Epoch=35.8] | Loss=0.00405 | Reg=0.00594 | acc=1.0000 | FP-Norm=2.386 | FP-Norm(final)=2.390 | 1750.8 samples/s | 27.4 steps/s
[Step=3800 Epoch=36.3] | Loss=0.00371 | Reg=0.00569 | acc=1.0000 | FP-Norm=2.330 | FP-Norm(final)=2.393 | 3839.2 samples/s | 60.0 steps/s
[Step=3850 Epoch=36.8] | Loss=0.00343 | Reg=0.00545 | acc=1.0000 | FP-Norm=2.276 | FP-Norm(final)=2.396 | 1753.1 samples/s | 27.4 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00319 | Reg=0.00524 | acc=1.0000 | FP-Norm=2.225 | FP-Norm(final)=2.398 | 3657.9 samples/s | 57.2 steps/s
[Step=3950 Epoch=37.7] | Loss=0.00298 | Reg=0.00504 | acc=1.0000 | FP-Norm=2.176 | FP-Norm(final)=2.401 | 1804.1 samples/s | 28.2 steps/s
[Step=4000 Epoch=38.2] | Loss=0.00280 | Reg=0.00485 | acc=1.0000 | FP-Norm=2.129 | FP-Norm(final)=2.403 | 3847.0 samples/s | 60.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step4000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.2] | Loss=0.23237 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.445 | 3756.0 samples/s | 58.7 steps/s
[Step=3250 Epoch=30.6] | Loss=0.03617 | Reg=0.00790 | acc=1.0000 | FP-Norm=2.675 | FP-Norm(final)=2.377 | 3550.9 samples/s | 55.5 steps/s
[Step=3300 Epoch=31.1] | Loss=0.02065 | Reg=0.00859 | acc=1.0000 | FP-Norm=2.861 | FP-Norm(final)=2.375 | 4833.2 samples/s | 75.5 steps/s
[Step=3350 Epoch=31.6] | Loss=0.01427 | Reg=0.00839 | acc=1.0000 | FP-Norm=2.848 | FP-Norm(final)=2.377 | 1618.5 samples/s | 25.3 steps/s
[Step=3400 Epoch=32.0] | Loss=0.01076 | Reg=0.00802 | acc=1.0000 | FP-Norm=2.794 | FP-Norm(final)=2.381 | 4394.1 samples/s | 68.7 steps/s
[Step=3450 Epoch=32.5] | Loss=0.00862 | Reg=0.00762 | acc=1.0000 | FP-Norm=2.725 | FP-Norm(final)=2.385 | 1652.0 samples/s | 25.8 steps/s
[Step=3500 Epoch=33.0] | Loss=0.00719 | Reg=0.00723 | acc=1.0000 | FP-Norm=2.654 | FP-Norm(final)=2.389 | 4131.2 samples/s | 64.6 steps/s
[Step=3550 Epoch=33.5] | Loss=0.00617 | Reg=0.00687 | acc=1.0000 | FP-Norm=2.584 | FP-Norm(final)=2.392 | 1690.7 samples/s | 26.4 steps/s
[Step=3600 Epoch=33.9] | Loss=0.00541 | Reg=0.00653 | acc=1.0000 | FP-Norm=2.518 | FP-Norm(final)=2.395 | 3822.7 samples/s | 59.7 steps/s
[Step=3650 Epoch=34.4] | Loss=0.00481 | Reg=0.00623 | acc=1.0000 | FP-Norm=2.454 | FP-Norm(final)=2.398 | 1753.5 samples/s | 27.4 steps/s
[Step=3700 Epoch=34.9] | Loss=0.00434 | Reg=0.00595 | acc=1.0000 | FP-Norm=2.394 | FP-Norm(final)=2.401 | 3769.6 samples/s | 58.9 steps/s
[Step=3750 Epoch=35.3] | Loss=0.00395 | Reg=0.00569 | acc=1.0000 | FP-Norm=2.337 | FP-Norm(final)=2.404 | 1776.6 samples/s | 27.8 steps/s
[Step=3800 Epoch=35.8] | Loss=0.00362 | Reg=0.00545 | acc=1.0000 | FP-Norm=2.282 | FP-Norm(final)=2.406 | 3770.8 samples/s | 58.9 steps/s
[Step=3850 Epoch=36.3] | Loss=0.00335 | Reg=0.00523 | acc=1.0000 | FP-Norm=2.230 | FP-Norm(final)=2.409 | 1804.0 samples/s | 28.2 steps/s
[Step=3900 Epoch=36.7] | Loss=0.00312 | Reg=0.00503 | acc=1.0000 | FP-Norm=2.180 | FP-Norm(final)=2.411 | 3711.8 samples/s | 58.0 steps/s
[Step=3950 Epoch=37.2] | Loss=0.00291 | Reg=0.00483 | acc=1.0000 | FP-Norm=2.132 | FP-Norm(final)=2.414 | 1898.2 samples/s | 29.7 steps/s
[Step=4000 Epoch=37.7] | Loss=0.00273 | Reg=0.00465 | acc=1.0000 | FP-Norm=2.086 | FP-Norm(final)=2.416 | 3229.2 samples/s | 50.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step4000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.5] | Loss=0.15628 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.446 | 3963.9 samples/s | 61.9 steps/s
[Step=3250 Epoch=31.0] | Loss=0.03359 | Reg=0.00739 | acc=1.0000 | FP-Norm=2.572 | FP-Norm(final)=2.393 | 3368.0 samples/s | 52.6 steps/s
[Step=3300 Epoch=31.5] | Loss=0.01867 | Reg=0.00800 | acc=1.0000 | FP-Norm=2.753 | FP-Norm(final)=2.397 | 4744.5 samples/s | 74.1 steps/s
[Step=3350 Epoch=31.9] | Loss=0.01263 | Reg=0.00770 | acc=1.0000 | FP-Norm=2.722 | FP-Norm(final)=2.403 | 1632.0 samples/s | 25.5 steps/s
[Step=3400 Epoch=32.4] | Loss=0.00960 | Reg=0.00728 | acc=1.0000 | FP-Norm=2.655 | FP-Norm(final)=2.409 | 4604.1 samples/s | 71.9 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00771 | Reg=0.00688 | acc=1.0000 | FP-Norm=2.584 | FP-Norm(final)=2.414 | 1666.9 samples/s | 26.0 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00644 | Reg=0.00651 | acc=1.0000 | FP-Norm=2.512 | FP-Norm(final)=2.418 | 4393.1 samples/s | 68.6 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00553 | Reg=0.00616 | acc=1.0000 | FP-Norm=2.443 | FP-Norm(final)=2.421 | 1667.6 samples/s | 26.1 steps/s
[Step=3600 Epoch=34.3] | Loss=0.00485 | Reg=0.00585 | acc=1.0000 | FP-Norm=2.377 | FP-Norm(final)=2.424 | 4033.1 samples/s | 63.0 steps/s
[Step=3650 Epoch=34.8] | Loss=0.00432 | Reg=0.00557 | acc=1.0000 | FP-Norm=2.315 | FP-Norm(final)=2.427 | 1680.1 samples/s | 26.3 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00389 | Reg=0.00531 | acc=1.0000 | FP-Norm=2.256 | FP-Norm(final)=2.430 | 3924.6 samples/s | 61.3 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00354 | Reg=0.00507 | acc=1.0000 | FP-Norm=2.200 | FP-Norm(final)=2.432 | 1720.0 samples/s | 26.9 steps/s
[Step=3800 Epoch=36.2] | Loss=0.00325 | Reg=0.00485 | acc=1.0000 | FP-Norm=2.147 | FP-Norm(final)=2.435 | 3788.9 samples/s | 59.2 steps/s
[Step=3850 Epoch=36.7] | Loss=0.00302 | Reg=0.00465 | acc=1.0000 | FP-Norm=2.097 | FP-Norm(final)=2.437 | 1751.2 samples/s | 27.4 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00281 | Reg=0.00447 | acc=1.0000 | FP-Norm=2.050 | FP-Norm(final)=2.439 | 3701.5 samples/s | 57.8 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00262 | Reg=0.00430 | acc=1.0000 | FP-Norm=2.004 | FP-Norm(final)=2.442 | 1759.1 samples/s | 27.5 steps/s
[Step=4000 Epoch=38.1] | Loss=0.00246 | Reg=0.00413 | acc=1.0000 | FP-Norm=1.961 | FP-Norm(final)=2.444 | 3700.6 samples/s | 57.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22337 | acc=0.8189 | tpr=0.7543 | fpr=0.0409 | 3786.8 samples/s | 14.8 steps/s
Avg test loss: 0.22286, Avg test acc: 0.81990, Avg tpr: 0.75666, Avg fpr: 0.04102, total FA: 320

Testing server on iccad2012
[Step=  50] | Loss=0.42452 | acc=0.7719 | tpr=0.9602 | fpr=0.2315 | 3832.5 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.43075 | acc=0.7707 | tpr=0.9595 | fpr=0.2328 | 7227.0 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.43437 | acc=0.7689 | tpr=0.9611 | fpr=0.2347 | 7205.9 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.43422 | acc=0.7699 | tpr=0.9650 | fpr=0.2336 | 7222.4 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.43257 | acc=0.7709 | tpr=0.9633 | fpr=0.2326 | 7228.4 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.43369 | acc=0.7710 | tpr=0.9615 | fpr=0.2324 | 7067.8 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.43400 | acc=0.7711 | tpr=0.9631 | fpr=0.2324 | 7227.7 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.43482 | acc=0.7707 | tpr=0.9623 | fpr=0.2328 | 6967.1 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.43643 | acc=0.7711 | tpr=0.9625 | fpr=0.2324 | 7376.4 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.43769 | acc=0.7707 | tpr=0.9639 | fpr=0.2328 | 7003.8 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.43712 | acc=0.7713 | tpr=0.9634 | fpr=0.2322 | 12999.7 samples/s | 50.8 steps/s
Avg test loss: 0.43716, Avg test acc: 0.77127, Avg tpr: 0.96355, Avg fpr: 0.23223, total FA: 32244

server round 5/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.15296 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.485 | 3634.8 samples/s | 56.8 steps/s
[Step=4050 Epoch=19.7] | Loss=0.06306 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.174 | FP-Norm(final)=2.478 | 3815.0 samples/s | 59.6 steps/s
[Step=4100 Epoch=20.0] | Loss=0.06101 | Reg=0.00199 | acc=0.9531 | FP-Norm=1.371 | FP-Norm(final)=2.473 | 3849.9 samples/s | 60.2 steps/s
[Step=4150 Epoch=20.2] | Loss=0.05796 | Reg=0.00239 | acc=0.9688 | FP-Norm=1.509 | FP-Norm(final)=2.468 | 3957.2 samples/s | 61.8 steps/s
[Step=4200 Epoch=20.5] | Loss=0.05549 | Reg=0.00267 | acc=0.9531 | FP-Norm=1.601 | FP-Norm(final)=2.467 | 5053.0 samples/s | 79.0 steps/s
[Step=4250 Epoch=20.7] | Loss=0.05126 | Reg=0.00297 | acc=1.0000 | FP-Norm=1.688 | FP-Norm(final)=2.469 | 1659.9 samples/s | 25.9 steps/s
[Step=4300 Epoch=21.0] | Loss=0.04823 | Reg=0.00322 | acc=1.0000 | FP-Norm=1.759 | FP-Norm(final)=2.471 | 3854.8 samples/s | 60.2 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04506 | Reg=0.00340 | acc=1.0000 | FP-Norm=1.810 | FP-Norm(final)=2.475 | 3870.4 samples/s | 60.5 steps/s
[Step=4400 Epoch=21.5] | Loss=0.04462 | Reg=0.00358 | acc=0.9688 | FP-Norm=1.859 | FP-Norm(final)=2.477 | 4634.0 samples/s | 72.4 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04498 | Reg=0.00386 | acc=1.0000 | FP-Norm=1.926 | FP-Norm(final)=2.477 | 1720.9 samples/s | 26.9 steps/s
[Step=4500 Epoch=21.9] | Loss=0.04324 | Reg=0.00416 | acc=0.9375 | FP-Norm=1.995 | FP-Norm(final)=2.478 | 3924.4 samples/s | 61.3 steps/s
[Step=4550 Epoch=22.2] | Loss=0.04211 | Reg=0.00440 | acc=0.9844 | FP-Norm=2.051 | FP-Norm(final)=2.480 | 3858.0 samples/s | 60.3 steps/s
[Step=4600 Epoch=22.4] | Loss=0.04138 | Reg=0.00461 | acc=0.9844 | FP-Norm=2.099 | FP-Norm(final)=2.481 | 4360.7 samples/s | 68.1 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03986 | Reg=0.00480 | acc=0.9844 | FP-Norm=2.142 | FP-Norm(final)=2.483 | 1728.5 samples/s | 27.0 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03894 | Reg=0.00496 | acc=1.0000 | FP-Norm=2.179 | FP-Norm(final)=2.485 | 3886.7 samples/s | 60.7 steps/s
[Step=4750 Epoch=23.2] | Loss=0.03775 | Reg=0.00510 | acc=1.0000 | FP-Norm=2.212 | FP-Norm(final)=2.486 | 3870.4 samples/s | 60.5 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03689 | Reg=0.00524 | acc=0.9688 | FP-Norm=2.242 | FP-Norm(final)=2.488 | 4143.4 samples/s | 64.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step4800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.20553 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.484 | 4148.9 samples/s | 64.8 steps/s
[Step=4050 Epoch=19.8] | Loss=0.06960 | Reg=0.00160 | acc=0.9844 | FP-Norm=1.209 | FP-Norm(final)=2.467 | 3388.4 samples/s | 52.9 steps/s
[Step=4100 Epoch=20.0] | Loss=0.06592 | Reg=0.00207 | acc=0.9688 | FP-Norm=1.401 | FP-Norm(final)=2.462 | 3865.9 samples/s | 60.4 steps/s
[Step=4150 Epoch=20.3] | Loss=0.06465 | Reg=0.00246 | acc=0.9062 | FP-Norm=1.534 | FP-Norm(final)=2.456 | 3845.0 samples/s | 60.1 steps/s
[Step=4200 Epoch=20.5] | Loss=0.06131 | Reg=0.00282 | acc=0.9375 | FP-Norm=1.644 | FP-Norm(final)=2.453 | 4953.7 samples/s | 77.4 steps/s
[Step=4250 Epoch=20.7] | Loss=0.05644 | Reg=0.00313 | acc=0.9844 | FP-Norm=1.733 | FP-Norm(final)=2.452 | 1651.5 samples/s | 25.8 steps/s
[Step=4300 Epoch=21.0] | Loss=0.05207 | Reg=0.00335 | acc=0.9531 | FP-Norm=1.797 | FP-Norm(final)=2.453 | 3873.1 samples/s | 60.5 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04947 | Reg=0.00356 | acc=0.9375 | FP-Norm=1.854 | FP-Norm(final)=2.455 | 3857.6 samples/s | 60.3 steps/s
[Step=4400 Epoch=21.5] | Loss=0.04709 | Reg=0.00376 | acc=0.9844 | FP-Norm=1.905 | FP-Norm(final)=2.457 | 4722.0 samples/s | 73.8 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04534 | Reg=0.00394 | acc=0.9531 | FP-Norm=1.952 | FP-Norm(final)=2.460 | 1674.6 samples/s | 26.2 steps/s
[Step=4500 Epoch=22.0] | Loss=0.04343 | Reg=0.00412 | acc=1.0000 | FP-Norm=1.997 | FP-Norm(final)=2.463 | 3845.9 samples/s | 60.1 steps/s
[Step=4550 Epoch=22.2] | Loss=0.04134 | Reg=0.00429 | acc=0.9844 | FP-Norm=2.037 | FP-Norm(final)=2.467 | 3851.0 samples/s | 60.2 steps/s
[Step=4600 Epoch=22.4] | Loss=0.04014 | Reg=0.00446 | acc=0.9844 | FP-Norm=2.077 | FP-Norm(final)=2.470 | 4502.6 samples/s | 70.4 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03893 | Reg=0.00462 | acc=0.9375 | FP-Norm=2.114 | FP-Norm(final)=2.473 | 1728.2 samples/s | 27.0 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03793 | Reg=0.00477 | acc=0.9844 | FP-Norm=2.147 | FP-Norm(final)=2.476 | 3866.1 samples/s | 60.4 steps/s
[Step=4750 Epoch=23.2] | Loss=0.03686 | Reg=0.00489 | acc=1.0000 | FP-Norm=2.175 | FP-Norm(final)=2.478 | 3845.6 samples/s | 60.1 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03594 | Reg=0.00500 | acc=0.9844 | FP-Norm=2.201 | FP-Norm(final)=2.480 | 4253.5 samples/s | 66.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step4800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.18151 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.485 | 3694.3 samples/s | 57.7 steps/s
[Step=4050 Epoch=19.7] | Loss=0.08963 | Reg=0.00210 | acc=0.9531 | FP-Norm=1.382 | FP-Norm(final)=2.463 | 3880.6 samples/s | 60.6 steps/s
[Step=4100 Epoch=20.0] | Loss=0.07119 | Reg=0.00250 | acc=0.9531 | FP-Norm=1.542 | FP-Norm(final)=2.460 | 3919.1 samples/s | 61.2 steps/s
[Step=4150 Epoch=20.2] | Loss=0.06648 | Reg=0.00276 | acc=0.9531 | FP-Norm=1.631 | FP-Norm(final)=2.456 | 3926.2 samples/s | 61.3 steps/s
[Step=4200 Epoch=20.5] | Loss=0.06263 | Reg=0.00298 | acc=0.9531 | FP-Norm=1.700 | FP-Norm(final)=2.455 | 5060.7 samples/s | 79.1 steps/s
[Step=4250 Epoch=20.7] | Loss=0.05643 | Reg=0.00318 | acc=0.9688 | FP-Norm=1.760 | FP-Norm(final)=2.457 | 1682.6 samples/s | 26.3 steps/s
[Step=4300 Epoch=21.0] | Loss=0.05170 | Reg=0.00334 | acc=1.0000 | FP-Norm=1.804 | FP-Norm(final)=2.462 | 3881.6 samples/s | 60.7 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04911 | Reg=0.00350 | acc=0.9062 | FP-Norm=1.848 | FP-Norm(final)=2.467 | 3873.0 samples/s | 60.5 steps/s
[Step=4400 Epoch=21.4] | Loss=0.04769 | Reg=0.00368 | acc=0.9688 | FP-Norm=1.895 | FP-Norm(final)=2.470 | 4644.1 samples/s | 72.6 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04581 | Reg=0.00387 | acc=0.9844 | FP-Norm=1.942 | FP-Norm(final)=2.470 | 1701.4 samples/s | 26.6 steps/s
[Step=4500 Epoch=21.9] | Loss=0.04360 | Reg=0.00403 | acc=1.0000 | FP-Norm=1.983 | FP-Norm(final)=2.473 | 3965.6 samples/s | 62.0 steps/s
[Step=4550 Epoch=22.2] | Loss=0.04182 | Reg=0.00418 | acc=1.0000 | FP-Norm=2.019 | FP-Norm(final)=2.476 | 3960.7 samples/s | 61.9 steps/s
[Step=4600 Epoch=22.4] | Loss=0.04104 | Reg=0.00433 | acc=0.9688 | FP-Norm=2.054 | FP-Norm(final)=2.479 | 4479.0 samples/s | 70.0 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03976 | Reg=0.00448 | acc=0.9844 | FP-Norm=2.089 | FP-Norm(final)=2.482 | 1766.5 samples/s | 27.6 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03860 | Reg=0.00462 | acc=0.9688 | FP-Norm=2.122 | FP-Norm(final)=2.484 | 3863.6 samples/s | 60.4 steps/s
[Step=4750 Epoch=23.1] | Loss=0.03748 | Reg=0.00478 | acc=0.9844 | FP-Norm=2.156 | FP-Norm(final)=2.487 | 3872.5 samples/s | 60.5 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03712 | Reg=0.00493 | acc=0.9688 | FP-Norm=2.189 | FP-Norm(final)=2.489 | 4122.8 samples/s | 64.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step4800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.14771 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.485 | 3790.7 samples/s | 59.2 steps/s
[Step=4050 Epoch=19.8] | Loss=0.06704 | Reg=0.00173 | acc=0.9688 | FP-Norm=1.256 | FP-Norm(final)=2.477 | 3817.1 samples/s | 59.6 steps/s
[Step=4100 Epoch=20.0] | Loss=0.05754 | Reg=0.00221 | acc=0.9844 | FP-Norm=1.448 | FP-Norm(final)=2.473 | 3829.6 samples/s | 59.8 steps/s
[Step=4150 Epoch=20.2] | Loss=0.05663 | Reg=0.00257 | acc=0.9688 | FP-Norm=1.569 | FP-Norm(final)=2.470 | 3856.8 samples/s | 60.3 steps/s
[Step=4200 Epoch=20.5] | Loss=0.05418 | Reg=0.00284 | acc=0.9531 | FP-Norm=1.654 | FP-Norm(final)=2.465 | 4928.0 samples/s | 77.0 steps/s
[Step=4250 Epoch=20.7] | Loss=0.04872 | Reg=0.00304 | acc=0.9844 | FP-Norm=1.715 | FP-Norm(final)=2.466 | 1667.8 samples/s | 26.1 steps/s
[Step=4300 Epoch=21.0] | Loss=0.04568 | Reg=0.00321 | acc=0.9844 | FP-Norm=1.766 | FP-Norm(final)=2.469 | 3838.9 samples/s | 60.0 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04346 | Reg=0.00340 | acc=0.9844 | FP-Norm=1.817 | FP-Norm(final)=2.473 | 3882.8 samples/s | 60.7 steps/s
[Step=4400 Epoch=21.5] | Loss=0.04214 | Reg=0.00357 | acc=1.0000 | FP-Norm=1.864 | FP-Norm(final)=2.476 | 4649.0 samples/s | 72.6 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04021 | Reg=0.00374 | acc=0.9844 | FP-Norm=1.907 | FP-Norm(final)=2.478 | 1672.6 samples/s | 26.1 steps/s
[Step=4500 Epoch=21.9] | Loss=0.03789 | Reg=0.00388 | acc=0.9844 | FP-Norm=1.943 | FP-Norm(final)=2.482 | 3818.3 samples/s | 59.7 steps/s
[Step=4550 Epoch=22.2] | Loss=0.03722 | Reg=0.00400 | acc=0.9844 | FP-Norm=1.975 | FP-Norm(final)=2.485 | 3856.0 samples/s | 60.3 steps/s
[Step=4600 Epoch=22.4] | Loss=0.03596 | Reg=0.00413 | acc=0.9844 | FP-Norm=2.007 | FP-Norm(final)=2.488 | 4367.5 samples/s | 68.2 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03489 | Reg=0.00426 | acc=1.0000 | FP-Norm=2.037 | FP-Norm(final)=2.491 | 1714.5 samples/s | 26.8 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03358 | Reg=0.00437 | acc=1.0000 | FP-Norm=2.064 | FP-Norm(final)=2.494 | 3871.7 samples/s | 60.5 steps/s
[Step=4750 Epoch=23.2] | Loss=0.03249 | Reg=0.00447 | acc=0.9844 | FP-Norm=2.088 | FP-Norm(final)=2.498 | 3861.9 samples/s | 60.3 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03244 | Reg=0.00458 | acc=0.9844 | FP-Norm=2.113 | FP-Norm(final)=2.500 | 4138.5 samples/s | 64.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step4800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.6] | Loss=0.20580 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.485 | 3967.7 samples/s | 62.0 steps/s
[Step=4050 Epoch=19.9] | Loss=0.07308 | Reg=0.00187 | acc=0.9375 | FP-Norm=1.307 | FP-Norm(final)=2.465 | 3651.3 samples/s | 57.1 steps/s
[Step=4100 Epoch=20.1] | Loss=0.06821 | Reg=0.00228 | acc=0.9688 | FP-Norm=1.473 | FP-Norm(final)=2.457 | 3926.7 samples/s | 61.4 steps/s
[Step=4150 Epoch=20.4] | Loss=0.06285 | Reg=0.00256 | acc=0.9688 | FP-Norm=1.570 | FP-Norm(final)=2.455 | 3944.1 samples/s | 61.6 steps/s
[Step=4200 Epoch=20.6] | Loss=0.05665 | Reg=0.00283 | acc=0.9844 | FP-Norm=1.654 | FP-Norm(final)=2.458 | 5006.6 samples/s | 78.2 steps/s
[Step=4250 Epoch=20.8] | Loss=0.05064 | Reg=0.00307 | acc=0.9844 | FP-Norm=1.725 | FP-Norm(final)=2.462 | 1664.0 samples/s | 26.0 steps/s
[Step=4300 Epoch=21.1] | Loss=0.04769 | Reg=0.00329 | acc=0.9688 | FP-Norm=1.786 | FP-Norm(final)=2.466 | 3882.9 samples/s | 60.7 steps/s
[Step=4350 Epoch=21.3] | Loss=0.04513 | Reg=0.00347 | acc=0.9375 | FP-Norm=1.835 | FP-Norm(final)=2.470 | 3814.4 samples/s | 59.6 steps/s
[Step=4400 Epoch=21.6] | Loss=0.04375 | Reg=0.00366 | acc=0.9844 | FP-Norm=1.885 | FP-Norm(final)=2.474 | 4803.2 samples/s | 75.0 steps/s
[Step=4450 Epoch=21.8] | Loss=0.04110 | Reg=0.00384 | acc=1.0000 | FP-Norm=1.931 | FP-Norm(final)=2.477 | 1695.7 samples/s | 26.5 steps/s
[Step=4500 Epoch=22.1] | Loss=0.03958 | Reg=0.00399 | acc=1.0000 | FP-Norm=1.969 | FP-Norm(final)=2.481 | 3847.9 samples/s | 60.1 steps/s
[Step=4550 Epoch=22.3] | Loss=0.03841 | Reg=0.00413 | acc=1.0000 | FP-Norm=2.005 | FP-Norm(final)=2.483 | 3828.4 samples/s | 59.8 steps/s
[Step=4600 Epoch=22.6] | Loss=0.03718 | Reg=0.00426 | acc=0.9844 | FP-Norm=2.036 | FP-Norm(final)=2.485 | 4607.4 samples/s | 72.0 steps/s
[Step=4650 Epoch=22.8] | Loss=0.03592 | Reg=0.00439 | acc=1.0000 | FP-Norm=2.067 | FP-Norm(final)=2.487 | 1671.8 samples/s | 26.1 steps/s
[Step=4700 Epoch=23.0] | Loss=0.03442 | Reg=0.00450 | acc=1.0000 | FP-Norm=2.093 | FP-Norm(final)=2.490 | 3911.8 samples/s | 61.1 steps/s
[Step=4750 Epoch=23.3] | Loss=0.03318 | Reg=0.00459 | acc=0.9844 | FP-Norm=2.116 | FP-Norm(final)=2.493 | 3986.2 samples/s | 62.3 steps/s
[Step=4800 Epoch=23.5] | Loss=0.03283 | Reg=0.00470 | acc=1.0000 | FP-Norm=2.140 | FP-Norm(final)=2.496 | 4554.7 samples/s | 71.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step4800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=37.9] | Loss=0.17163 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.484 | 3560.8 samples/s | 55.6 steps/s
[Step=4050 Epoch=38.4] | Loss=0.02269 | Reg=0.00755 | acc=1.0000 | FP-Norm=2.609 | FP-Norm(final)=2.435 | 3634.8 samples/s | 56.8 steps/s
[Step=4100 Epoch=38.9] | Loss=0.01607 | Reg=0.00851 | acc=1.0000 | FP-Norm=2.842 | FP-Norm(final)=2.425 | 4772.6 samples/s | 74.6 steps/s
[Step=4150 Epoch=39.3] | Loss=0.01082 | Reg=0.00837 | acc=1.0000 | FP-Norm=2.843 | FP-Norm(final)=2.425 | 1635.8 samples/s | 25.6 steps/s
[Step=4200 Epoch=39.8] | Loss=0.00847 | Reg=0.00804 | acc=1.0000 | FP-Norm=2.795 | FP-Norm(final)=2.427 | 4552.4 samples/s | 71.1 steps/s
[Step=4250 Epoch=40.3] | Loss=0.00680 | Reg=0.00767 | acc=1.0000 | FP-Norm=2.734 | FP-Norm(final)=2.430 | 1631.0 samples/s | 25.5 steps/s
[Step=4300 Epoch=40.7] | Loss=0.00568 | Reg=0.00730 | acc=1.0000 | FP-Norm=2.668 | FP-Norm(final)=2.433 | 4164.0 samples/s | 65.1 steps/s
[Step=4350 Epoch=41.2] | Loss=0.00488 | Reg=0.00696 | acc=1.0000 | FP-Norm=2.603 | FP-Norm(final)=2.436 | 1716.7 samples/s | 26.8 steps/s
[Step=4400 Epoch=41.7] | Loss=0.00427 | Reg=0.00664 | acc=1.0000 | FP-Norm=2.539 | FP-Norm(final)=2.439 | 4054.0 samples/s | 63.3 steps/s
[Step=4450 Epoch=42.2] | Loss=0.00381 | Reg=0.00634 | acc=1.0000 | FP-Norm=2.478 | FP-Norm(final)=2.442 | 1741.0 samples/s | 27.2 steps/s
[Step=4500 Epoch=42.6] | Loss=0.00343 | Reg=0.00606 | acc=1.0000 | FP-Norm=2.420 | FP-Norm(final)=2.445 | 3719.6 samples/s | 58.1 steps/s
[Step=4550 Epoch=43.1] | Loss=0.00312 | Reg=0.00581 | acc=1.0000 | FP-Norm=2.364 | FP-Norm(final)=2.448 | 1761.4 samples/s | 27.5 steps/s
[Step=4600 Epoch=43.6] | Loss=0.00287 | Reg=0.00557 | acc=1.0000 | FP-Norm=2.311 | FP-Norm(final)=2.451 | 3800.2 samples/s | 59.4 steps/s
[Step=4650 Epoch=44.1] | Loss=0.00265 | Reg=0.00536 | acc=1.0000 | FP-Norm=2.260 | FP-Norm(final)=2.453 | 1813.7 samples/s | 28.3 steps/s
[Step=4700 Epoch=44.5] | Loss=0.00247 | Reg=0.00515 | acc=1.0000 | FP-Norm=2.212 | FP-Norm(final)=2.456 | 3761.6 samples/s | 58.8 steps/s
[Step=4750 Epoch=45.0] | Loss=0.00231 | Reg=0.00496 | acc=1.0000 | FP-Norm=2.165 | FP-Norm(final)=2.458 | 1819.5 samples/s | 28.4 steps/s
[Step=4800 Epoch=45.5] | Loss=0.00217 | Reg=0.00478 | acc=1.0000 | FP-Norm=2.120 | FP-Norm(final)=2.461 | 3763.7 samples/s | 58.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step4800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.09427 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.485 | 3881.2 samples/s | 60.6 steps/s
[Step=4050 Epoch=38.5] | Loss=0.03204 | Reg=0.00493 | acc=1.0000 | FP-Norm=2.063 | FP-Norm(final)=2.444 | 3223.1 samples/s | 50.4 steps/s
[Step=4100 Epoch=39.0] | Loss=0.01940 | Reg=0.00724 | acc=1.0000 | FP-Norm=2.577 | FP-Norm(final)=2.419 | 4794.9 samples/s | 74.9 steps/s
[Step=4150 Epoch=39.5] | Loss=0.01320 | Reg=0.00755 | acc=1.0000 | FP-Norm=2.671 | FP-Norm(final)=2.417 | 1633.7 samples/s | 25.5 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00993 | Reg=0.00739 | acc=1.0000 | FP-Norm=2.659 | FP-Norm(final)=2.419 | 4487.6 samples/s | 70.1 steps/s
[Step=4250 Epoch=40.4] | Loss=0.00796 | Reg=0.00710 | acc=1.0000 | FP-Norm=2.616 | FP-Norm(final)=2.422 | 1635.5 samples/s | 25.6 steps/s
[Step=4300 Epoch=40.9] | Loss=0.00664 | Reg=0.00680 | acc=1.0000 | FP-Norm=2.562 | FP-Norm(final)=2.425 | 4218.2 samples/s | 65.9 steps/s
[Step=4350 Epoch=41.4] | Loss=0.00570 | Reg=0.00650 | acc=1.0000 | FP-Norm=2.506 | FP-Norm(final)=2.428 | 1678.1 samples/s | 26.2 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00500 | Reg=0.00621 | acc=1.0000 | FP-Norm=2.450 | FP-Norm(final)=2.432 | 3940.9 samples/s | 61.6 steps/s
[Step=4450 Epoch=42.3] | Loss=0.00445 | Reg=0.00595 | acc=1.0000 | FP-Norm=2.394 | FP-Norm(final)=2.435 | 1708.8 samples/s | 26.7 steps/s
[Step=4500 Epoch=42.8] | Loss=0.00401 | Reg=0.00570 | acc=1.0000 | FP-Norm=2.341 | FP-Norm(final)=2.438 | 3779.2 samples/s | 59.1 steps/s
[Step=4550 Epoch=43.3] | Loss=0.00365 | Reg=0.00546 | acc=1.0000 | FP-Norm=2.289 | FP-Norm(final)=2.440 | 1811.0 samples/s | 28.3 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00335 | Reg=0.00525 | acc=1.0000 | FP-Norm=2.239 | FP-Norm(final)=2.443 | 3705.1 samples/s | 57.9 steps/s
[Step=4650 Epoch=44.2] | Loss=0.00309 | Reg=0.00504 | acc=1.0000 | FP-Norm=2.191 | FP-Norm(final)=2.446 | 1794.3 samples/s | 28.0 steps/s
[Step=4700 Epoch=44.7] | Loss=0.00288 | Reg=0.00485 | acc=1.0000 | FP-Norm=2.145 | FP-Norm(final)=2.448 | 3697.5 samples/s | 57.8 steps/s
[Step=4750 Epoch=45.2] | Loss=0.00269 | Reg=0.00468 | acc=1.0000 | FP-Norm=2.100 | FP-Norm(final)=2.451 | 1798.6 samples/s | 28.1 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00252 | Reg=0.00451 | acc=1.0000 | FP-Norm=2.057 | FP-Norm(final)=2.453 | 3746.6 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step4800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=38.2] | Loss=0.07951 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.485 | 3765.8 samples/s | 58.8 steps/s
[Step=4050 Epoch=38.7] | Loss=0.03664 | Reg=0.00729 | acc=1.0000 | FP-Norm=2.508 | FP-Norm(final)=2.424 | 3328.7 samples/s | 52.0 steps/s
[Step=4100 Epoch=39.2] | Loss=0.02177 | Reg=0.00898 | acc=1.0000 | FP-Norm=2.886 | FP-Norm(final)=2.405 | 4844.2 samples/s | 75.7 steps/s
[Step=4150 Epoch=39.6] | Loss=0.01466 | Reg=0.00896 | acc=1.0000 | FP-Norm=2.920 | FP-Norm(final)=2.402 | 1591.7 samples/s | 24.9 steps/s
[Step=4200 Epoch=40.1] | Loss=0.01103 | Reg=0.00859 | acc=1.0000 | FP-Norm=2.874 | FP-Norm(final)=2.404 | 4602.2 samples/s | 71.9 steps/s
[Step=4250 Epoch=40.6] | Loss=0.00884 | Reg=0.00817 | acc=1.0000 | FP-Norm=2.808 | FP-Norm(final)=2.406 | 1631.8 samples/s | 25.5 steps/s
[Step=4300 Epoch=41.1] | Loss=0.00738 | Reg=0.00776 | acc=1.0000 | FP-Norm=2.739 | FP-Norm(final)=2.409 | 4342.1 samples/s | 67.8 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00633 | Reg=0.00738 | acc=1.0000 | FP-Norm=2.670 | FP-Norm(final)=2.412 | 1701.2 samples/s | 26.6 steps/s
[Step=4400 Epoch=42.0] | Loss=0.00554 | Reg=0.00703 | acc=1.0000 | FP-Norm=2.604 | FP-Norm(final)=2.415 | 4220.8 samples/s | 65.9 steps/s
[Step=4450 Epoch=42.5] | Loss=0.00493 | Reg=0.00671 | acc=1.0000 | FP-Norm=2.541 | FP-Norm(final)=2.418 | 1713.4 samples/s | 26.8 steps/s
[Step=4500 Epoch=43.0] | Loss=0.00444 | Reg=0.00642 | acc=1.0000 | FP-Norm=2.480 | FP-Norm(final)=2.421 | 3901.5 samples/s | 61.0 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00405 | Reg=0.00614 | acc=1.0000 | FP-Norm=2.423 | FP-Norm(final)=2.423 | 1695.9 samples/s | 26.5 steps/s
[Step=4600 Epoch=43.9] | Loss=0.00371 | Reg=0.00589 | acc=1.0000 | FP-Norm=2.368 | FP-Norm(final)=2.426 | 3748.3 samples/s | 58.6 steps/s
[Step=4650 Epoch=44.4] | Loss=0.00343 | Reg=0.00566 | acc=1.0000 | FP-Norm=2.316 | FP-Norm(final)=2.429 | 1772.2 samples/s | 27.7 steps/s
[Step=4700 Epoch=44.9] | Loss=0.00319 | Reg=0.00544 | acc=1.0000 | FP-Norm=2.265 | FP-Norm(final)=2.431 | 3720.6 samples/s | 58.1 steps/s
[Step=4750 Epoch=45.4] | Loss=0.00298 | Reg=0.00523 | acc=1.0000 | FP-Norm=2.217 | FP-Norm(final)=2.434 | 1777.1 samples/s | 27.8 steps/s
[Step=4800 Epoch=45.8] | Loss=0.00280 | Reg=0.00504 | acc=1.0000 | FP-Norm=2.171 | FP-Norm(final)=2.436 | 3715.1 samples/s | 58.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step4800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=37.7] | Loss=0.09316 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.484 | 3738.3 samples/s | 58.4 steps/s
[Step=4050 Epoch=38.2] | Loss=0.02495 | Reg=0.00531 | acc=1.0000 | FP-Norm=2.171 | FP-Norm(final)=2.439 | 3383.3 samples/s | 52.9 steps/s
[Step=4100 Epoch=38.6] | Loss=0.01426 | Reg=0.00614 | acc=1.0000 | FP-Norm=2.405 | FP-Norm(final)=2.440 | 4714.2 samples/s | 73.7 steps/s
[Step=4150 Epoch=39.1] | Loss=0.01145 | Reg=0.00639 | acc=1.0000 | FP-Norm=2.477 | FP-Norm(final)=2.443 | 1616.8 samples/s | 25.3 steps/s
[Step=4200 Epoch=39.6] | Loss=0.00911 | Reg=0.00657 | acc=1.0000 | FP-Norm=2.526 | FP-Norm(final)=2.445 | 4450.8 samples/s | 69.5 steps/s
[Step=4250 Epoch=40.0] | Loss=0.00745 | Reg=0.00655 | acc=1.0000 | FP-Norm=2.528 | FP-Norm(final)=2.448 | 1675.4 samples/s | 26.2 steps/s
[Step=4300 Epoch=40.5] | Loss=0.00624 | Reg=0.00640 | acc=1.0000 | FP-Norm=2.503 | FP-Norm(final)=2.451 | 4116.2 samples/s | 64.3 steps/s
[Step=4350 Epoch=41.0] | Loss=0.00536 | Reg=0.00621 | acc=1.0000 | FP-Norm=2.467 | FP-Norm(final)=2.454 | 1689.6 samples/s | 26.4 steps/s
[Step=4400 Epoch=41.5] | Loss=0.00469 | Reg=0.00600 | acc=1.0000 | FP-Norm=2.425 | FP-Norm(final)=2.457 | 3848.9 samples/s | 60.1 steps/s
[Step=4450 Epoch=41.9] | Loss=0.00417 | Reg=0.00579 | acc=1.0000 | FP-Norm=2.381 | FP-Norm(final)=2.459 | 1735.7 samples/s | 27.1 steps/s
[Step=4500 Epoch=42.4] | Loss=0.00376 | Reg=0.00558 | acc=1.0000 | FP-Norm=2.335 | FP-Norm(final)=2.462 | 3656.6 samples/s | 57.1 steps/s
[Step=4550 Epoch=42.9] | Loss=0.00342 | Reg=0.00538 | acc=1.0000 | FP-Norm=2.289 | FP-Norm(final)=2.464 | 1750.4 samples/s | 27.4 steps/s
[Step=4600 Epoch=43.3] | Loss=0.00314 | Reg=0.00518 | acc=1.0000 | FP-Norm=2.243 | FP-Norm(final)=2.466 | 3802.8 samples/s | 59.4 steps/s
[Step=4650 Epoch=43.8] | Loss=0.00290 | Reg=0.00500 | acc=1.0000 | FP-Norm=2.199 | FP-Norm(final)=2.468 | 1769.4 samples/s | 27.6 steps/s
[Step=4700 Epoch=44.3] | Loss=0.00270 | Reg=0.00482 | acc=1.0000 | FP-Norm=2.155 | FP-Norm(final)=2.469 | 3741.5 samples/s | 58.5 steps/s
[Step=4750 Epoch=44.8] | Loss=0.00252 | Reg=0.00465 | acc=1.0000 | FP-Norm=2.113 | FP-Norm(final)=2.471 | 1882.9 samples/s | 29.4 steps/s
[Step=4800 Epoch=45.2] | Loss=0.00236 | Reg=0.00449 | acc=1.0000 | FP-Norm=2.072 | FP-Norm(final)=2.473 | 3456.1 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step4800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.19629 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.484 | 3740.9 samples/s | 58.5 steps/s
[Step=4050 Epoch=38.6] | Loss=0.03625 | Reg=0.00704 | acc=0.9844 | FP-Norm=2.514 | FP-Norm(final)=2.417 | 3371.9 samples/s | 52.7 steps/s
[Step=4100 Epoch=39.1] | Loss=0.01950 | Reg=0.00791 | acc=1.0000 | FP-Norm=2.738 | FP-Norm(final)=2.417 | 4896.7 samples/s | 76.5 steps/s
[Step=4150 Epoch=39.6] | Loss=0.01319 | Reg=0.00779 | acc=1.0000 | FP-Norm=2.740 | FP-Norm(final)=2.424 | 1583.6 samples/s | 24.7 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00996 | Reg=0.00745 | acc=1.0000 | FP-Norm=2.690 | FP-Norm(final)=2.431 | 4509.9 samples/s | 70.5 steps/s
[Step=4250 Epoch=40.5] | Loss=0.00799 | Reg=0.00708 | acc=1.0000 | FP-Norm=2.625 | FP-Norm(final)=2.436 | 1621.3 samples/s | 25.3 steps/s
[Step=4300 Epoch=41.0] | Loss=0.00668 | Reg=0.00673 | acc=1.0000 | FP-Norm=2.558 | FP-Norm(final)=2.440 | 4257.5 samples/s | 66.5 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00574 | Reg=0.00640 | acc=1.0000 | FP-Norm=2.493 | FP-Norm(final)=2.444 | 1645.0 samples/s | 25.7 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00503 | Reg=0.00609 | acc=1.0000 | FP-Norm=2.430 | FP-Norm(final)=2.448 | 4191.1 samples/s | 65.5 steps/s
[Step=4450 Epoch=42.4] | Loss=0.00448 | Reg=0.00581 | acc=1.0000 | FP-Norm=2.370 | FP-Norm(final)=2.451 | 1716.5 samples/s | 26.8 steps/s
[Step=4500 Epoch=42.9] | Loss=0.00404 | Reg=0.00555 | acc=1.0000 | FP-Norm=2.312 | FP-Norm(final)=2.454 | 3845.4 samples/s | 60.1 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00368 | Reg=0.00531 | acc=1.0000 | FP-Norm=2.257 | FP-Norm(final)=2.457 | 1702.8 samples/s | 26.6 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00338 | Reg=0.00509 | acc=1.0000 | FP-Norm=2.205 | FP-Norm(final)=2.460 | 3805.9 samples/s | 59.5 steps/s
[Step=4650 Epoch=44.3] | Loss=0.00313 | Reg=0.00488 | acc=1.0000 | FP-Norm=2.155 | FP-Norm(final)=2.462 | 1762.9 samples/s | 27.5 steps/s
[Step=4700 Epoch=44.8] | Loss=0.00291 | Reg=0.00469 | acc=1.0000 | FP-Norm=2.107 | FP-Norm(final)=2.465 | 3655.0 samples/s | 57.1 steps/s
[Step=4750 Epoch=45.3] | Loss=0.00272 | Reg=0.00451 | acc=1.0000 | FP-Norm=2.061 | FP-Norm(final)=2.467 | 1781.0 samples/s | 27.8 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00256 | Reg=0.00435 | acc=1.0000 | FP-Norm=2.017 | FP-Norm(final)=2.470 | 3738.7 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21366 | acc=0.8267 | tpr=0.7643 | fpr=0.0377 | 3806.3 samples/s | 14.9 steps/s
Avg test loss: 0.21306, Avg test acc: 0.82819, Avg tpr: 0.76674, Avg fpr: 0.03666, total FA: 286

Testing server on iccad2012
[Step=  50] | Loss=0.47817 | acc=0.7544 | tpr=0.9646 | fpr=0.2494 | 3819.8 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.48397 | acc=0.7552 | tpr=0.9595 | fpr=0.2486 | 7095.9 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.48719 | acc=0.7541 | tpr=0.9611 | fpr=0.2497 | 7029.0 samples/s | 27.5 steps/s
[Step= 200] | Loss=0.48652 | acc=0.7553 | tpr=0.9650 | fpr=0.2485 | 7258.2 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.48479 | acc=0.7557 | tpr=0.9651 | fpr=0.2481 | 7370.0 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.48586 | acc=0.7560 | tpr=0.9600 | fpr=0.2478 | 6889.6 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.48615 | acc=0.7559 | tpr=0.9618 | fpr=0.2478 | 7310.9 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.48644 | acc=0.7556 | tpr=0.9612 | fpr=0.2482 | 6941.5 samples/s | 27.1 steps/s
[Step= 450] | Loss=0.48787 | acc=0.7559 | tpr=0.9611 | fpr=0.2478 | 6949.2 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.48941 | acc=0.7555 | tpr=0.9626 | fpr=0.2482 | 7244.1 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.48901 | acc=0.7558 | tpr=0.9622 | fpr=0.2479 | 13053.8 samples/s | 51.0 steps/s
Avg test loss: 0.48909, Avg test acc: 0.75577, Avg tpr: 0.96236, Avg fpr: 0.24798, total FA: 34432

server round 6/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.22121 | Reg=0.00000 | acc=0.7969 | FP-Norm=0.000 | FP-Norm(final)=2.504 | 3962.5 samples/s | 61.9 steps/s
[Step=4850 Epoch=23.6] | Loss=0.05968 | Reg=0.00190 | acc=0.9375 | FP-Norm=1.316 | FP-Norm(final)=2.492 | 3546.0 samples/s | 55.4 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05578 | Reg=0.00233 | acc=0.9688 | FP-Norm=1.488 | FP-Norm(final)=2.487 | 3821.9 samples/s | 59.7 steps/s
[Step=4950 Epoch=24.1] | Loss=0.05401 | Reg=0.00266 | acc=0.9531 | FP-Norm=1.601 | FP-Norm(final)=2.479 | 3875.8 samples/s | 60.6 steps/s
[Step=5000 Epoch=24.4] | Loss=0.05217 | Reg=0.00292 | acc=1.0000 | FP-Norm=1.681 | FP-Norm(final)=2.475 | 4962.6 samples/s | 77.5 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04649 | Reg=0.00307 | acc=0.9688 | FP-Norm=1.727 | FP-Norm(final)=2.475 | 1690.3 samples/s | 26.4 steps/s
[Step=5100 Epoch=24.9] | Loss=0.04327 | Reg=0.00317 | acc=0.9844 | FP-Norm=1.759 | FP-Norm(final)=2.477 | 3873.9 samples/s | 60.5 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04057 | Reg=0.00326 | acc=1.0000 | FP-Norm=1.786 | FP-Norm(final)=2.480 | 3849.3 samples/s | 60.1 steps/s
[Step=5200 Epoch=25.4] | Loss=0.04041 | Reg=0.00337 | acc=0.9688 | FP-Norm=1.816 | FP-Norm(final)=2.483 | 4642.2 samples/s | 72.5 steps/s
[Step=5250 Epoch=25.6] | Loss=0.04076 | Reg=0.00360 | acc=1.0000 | FP-Norm=1.873 | FP-Norm(final)=2.483 | 1722.4 samples/s | 26.9 steps/s
[Step=5300 Epoch=25.8] | Loss=0.03924 | Reg=0.00384 | acc=1.0000 | FP-Norm=1.931 | FP-Norm(final)=2.483 | 3902.5 samples/s | 61.0 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03761 | Reg=0.00402 | acc=1.0000 | FP-Norm=1.976 | FP-Norm(final)=2.485 | 3947.2 samples/s | 61.7 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03707 | Reg=0.00418 | acc=0.9844 | FP-Norm=2.014 | FP-Norm(final)=2.487 | 4483.6 samples/s | 70.1 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03536 | Reg=0.00433 | acc=1.0000 | FP-Norm=2.049 | FP-Norm(final)=2.489 | 1755.3 samples/s | 27.4 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03430 | Reg=0.00444 | acc=1.0000 | FP-Norm=2.077 | FP-Norm(final)=2.492 | 3931.9 samples/s | 61.4 steps/s
[Step=5550 Epoch=27.1] | Loss=0.03338 | Reg=0.00456 | acc=0.9688 | FP-Norm=2.103 | FP-Norm(final)=2.494 | 3965.6 samples/s | 62.0 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03306 | Reg=0.00468 | acc=1.0000 | FP-Norm=2.132 | FP-Norm(final)=2.497 | 4273.3 samples/s | 66.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step5600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.12992 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.505 | 3671.2 samples/s | 57.4 steps/s
[Step=4850 Epoch=23.7] | Loss=0.06518 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.268 | FP-Norm(final)=2.492 | 3746.8 samples/s | 58.5 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05781 | Reg=0.00219 | acc=0.9688 | FP-Norm=1.443 | FP-Norm(final)=2.486 | 3888.8 samples/s | 60.8 steps/s
[Step=4950 Epoch=24.2] | Loss=0.05520 | Reg=0.00261 | acc=0.9844 | FP-Norm=1.579 | FP-Norm(final)=2.482 | 3831.1 samples/s | 59.9 steps/s
[Step=5000 Epoch=24.4] | Loss=0.05402 | Reg=0.00297 | acc=0.9844 | FP-Norm=1.687 | FP-Norm(final)=2.477 | 4976.9 samples/s | 77.8 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04947 | Reg=0.00324 | acc=0.9844 | FP-Norm=1.765 | FP-Norm(final)=2.475 | 1667.7 samples/s | 26.1 steps/s
[Step=5100 Epoch=24.9] | Loss=0.04626 | Reg=0.00343 | acc=0.9844 | FP-Norm=1.821 | FP-Norm(final)=2.476 | 3937.8 samples/s | 61.5 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04462 | Reg=0.00361 | acc=0.9688 | FP-Norm=1.870 | FP-Norm(final)=2.477 | 3936.7 samples/s | 61.5 steps/s
[Step=5200 Epoch=25.4] | Loss=0.04298 | Reg=0.00379 | acc=0.9844 | FP-Norm=1.917 | FP-Norm(final)=2.477 | 4836.3 samples/s | 75.6 steps/s
[Step=5250 Epoch=25.6] | Loss=0.04177 | Reg=0.00397 | acc=1.0000 | FP-Norm=1.962 | FP-Norm(final)=2.478 | 1707.8 samples/s | 26.7 steps/s
[Step=5300 Epoch=25.9] | Loss=0.04032 | Reg=0.00416 | acc=0.9688 | FP-Norm=2.007 | FP-Norm(final)=2.478 | 3916.7 samples/s | 61.2 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03900 | Reg=0.00433 | acc=1.0000 | FP-Norm=2.048 | FP-Norm(final)=2.479 | 3890.3 samples/s | 60.8 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03823 | Reg=0.00450 | acc=0.9844 | FP-Norm=2.088 | FP-Norm(final)=2.480 | 4537.5 samples/s | 70.9 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03692 | Reg=0.00465 | acc=0.9844 | FP-Norm=2.123 | FP-Norm(final)=2.480 | 1744.1 samples/s | 27.3 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03549 | Reg=0.00477 | acc=1.0000 | FP-Norm=2.152 | FP-Norm(final)=2.482 | 3972.9 samples/s | 62.1 steps/s
[Step=5550 Epoch=27.1] | Loss=0.03428 | Reg=0.00488 | acc=0.9844 | FP-Norm=2.177 | FP-Norm(final)=2.484 | 3944.9 samples/s | 61.6 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03327 | Reg=0.00498 | acc=1.0000 | FP-Norm=2.200 | FP-Norm(final)=2.486 | 4352.1 samples/s | 68.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step5600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.23344 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.503 | 3647.8 samples/s | 57.0 steps/s
[Step=4850 Epoch=23.6] | Loss=0.06735 | Reg=0.00210 | acc=0.9375 | FP-Norm=1.385 | FP-Norm(final)=2.487 | 3881.9 samples/s | 60.7 steps/s
[Step=4900 Epoch=23.9] | Loss=0.06173 | Reg=0.00254 | acc=0.9844 | FP-Norm=1.554 | FP-Norm(final)=2.478 | 3784.6 samples/s | 59.1 steps/s
[Step=4950 Epoch=24.1] | Loss=0.05761 | Reg=0.00277 | acc=0.9062 | FP-Norm=1.636 | FP-Norm(final)=2.475 | 3842.2 samples/s | 60.0 steps/s
[Step=5000 Epoch=24.4] | Loss=0.05330 | Reg=0.00300 | acc=0.9531 | FP-Norm=1.706 | FP-Norm(final)=2.475 | 4940.1 samples/s | 77.2 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04848 | Reg=0.00320 | acc=0.9844 | FP-Norm=1.766 | FP-Norm(final)=2.478 | 1687.0 samples/s | 26.4 steps/s
[Step=5100 Epoch=24.8] | Loss=0.04552 | Reg=0.00338 | acc=0.9844 | FP-Norm=1.815 | FP-Norm(final)=2.481 | 3828.5 samples/s | 59.8 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04368 | Reg=0.00355 | acc=1.0000 | FP-Norm=1.862 | FP-Norm(final)=2.484 | 3835.3 samples/s | 59.9 steps/s
[Step=5200 Epoch=25.3] | Loss=0.04122 | Reg=0.00372 | acc=0.9688 | FP-Norm=1.906 | FP-Norm(final)=2.486 | 4666.2 samples/s | 72.9 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03879 | Reg=0.00388 | acc=1.0000 | FP-Norm=1.947 | FP-Norm(final)=2.489 | 1718.0 samples/s | 26.8 steps/s
[Step=5300 Epoch=25.8] | Loss=0.03744 | Reg=0.00401 | acc=0.9688 | FP-Norm=1.979 | FP-Norm(final)=2.492 | 3895.3 samples/s | 60.9 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03651 | Reg=0.00413 | acc=0.9844 | FP-Norm=2.009 | FP-Norm(final)=2.494 | 3865.5 samples/s | 60.4 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03570 | Reg=0.00425 | acc=1.0000 | FP-Norm=2.038 | FP-Norm(final)=2.496 | 4404.4 samples/s | 68.8 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03440 | Reg=0.00436 | acc=1.0000 | FP-Norm=2.066 | FP-Norm(final)=2.498 | 1726.9 samples/s | 27.0 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03366 | Reg=0.00447 | acc=1.0000 | FP-Norm=2.092 | FP-Norm(final)=2.500 | 3820.5 samples/s | 59.7 steps/s
[Step=5550 Epoch=27.0] | Loss=0.03280 | Reg=0.00458 | acc=0.9844 | FP-Norm=2.117 | FP-Norm(final)=2.502 | 3749.8 samples/s | 58.6 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03220 | Reg=0.00469 | acc=0.9844 | FP-Norm=2.142 | FP-Norm(final)=2.503 | 4053.9 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step5600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.22912 | Reg=0.00000 | acc=0.7500 | FP-Norm=0.000 | FP-Norm(final)=2.504 | 3623.3 samples/s | 56.6 steps/s
[Step=4850 Epoch=23.7] | Loss=0.06655 | Reg=0.00177 | acc=0.9219 | FP-Norm=1.276 | FP-Norm(final)=2.485 | 3712.2 samples/s | 58.0 steps/s
[Step=4900 Epoch=23.9] | Loss=0.06045 | Reg=0.00224 | acc=0.9531 | FP-Norm=1.461 | FP-Norm(final)=2.480 | 3858.8 samples/s | 60.3 steps/s
[Step=4950 Epoch=24.1] | Loss=0.05535 | Reg=0.00255 | acc=0.9531 | FP-Norm=1.566 | FP-Norm(final)=2.477 | 3911.2 samples/s | 61.1 steps/s
[Step=5000 Epoch=24.4] | Loss=0.05481 | Reg=0.00283 | acc=0.9531 | FP-Norm=1.654 | FP-Norm(final)=2.473 | 4982.4 samples/s | 77.8 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04912 | Reg=0.00303 | acc=1.0000 | FP-Norm=1.714 | FP-Norm(final)=2.473 | 1657.7 samples/s | 25.9 steps/s
[Step=5100 Epoch=24.9] | Loss=0.04521 | Reg=0.00319 | acc=0.9844 | FP-Norm=1.762 | FP-Norm(final)=2.477 | 3857.1 samples/s | 60.3 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04346 | Reg=0.00335 | acc=0.9688 | FP-Norm=1.807 | FP-Norm(final)=2.479 | 3847.2 samples/s | 60.1 steps/s
[Step=5200 Epoch=25.4] | Loss=0.04168 | Reg=0.00351 | acc=0.9688 | FP-Norm=1.850 | FP-Norm(final)=2.481 | 4626.8 samples/s | 72.3 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03875 | Reg=0.00365 | acc=1.0000 | FP-Norm=1.888 | FP-Norm(final)=2.484 | 1695.6 samples/s | 26.5 steps/s
[Step=5300 Epoch=25.8] | Loss=0.03708 | Reg=0.00376 | acc=0.9219 | FP-Norm=1.916 | FP-Norm(final)=2.488 | 3829.9 samples/s | 59.8 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03619 | Reg=0.00387 | acc=0.9531 | FP-Norm=1.944 | FP-Norm(final)=2.491 | 4001.0 samples/s | 62.5 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03499 | Reg=0.00398 | acc=1.0000 | FP-Norm=1.971 | FP-Norm(final)=2.493 | 4455.4 samples/s | 69.6 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03368 | Reg=0.00408 | acc=1.0000 | FP-Norm=1.997 | FP-Norm(final)=2.496 | 1763.7 samples/s | 27.6 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03297 | Reg=0.00418 | acc=0.9844 | FP-Norm=2.022 | FP-Norm(final)=2.498 | 3851.7 samples/s | 60.2 steps/s
[Step=5550 Epoch=27.1] | Loss=0.03183 | Reg=0.00427 | acc=0.9844 | FP-Norm=2.044 | FP-Norm(final)=2.501 | 3831.8 samples/s | 59.9 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03078 | Reg=0.00436 | acc=0.9844 | FP-Norm=2.065 | FP-Norm(final)=2.504 | 4141.2 samples/s | 64.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step5600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.5] | Loss=0.10889 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.505 | 3790.9 samples/s | 59.2 steps/s
[Step=4850 Epoch=23.8] | Loss=0.06719 | Reg=0.00175 | acc=0.9844 | FP-Norm=1.255 | FP-Norm(final)=2.481 | 3745.4 samples/s | 58.5 steps/s
[Step=4900 Epoch=24.0] | Loss=0.06077 | Reg=0.00225 | acc=0.9844 | FP-Norm=1.456 | FP-Norm(final)=2.479 | 3886.3 samples/s | 60.7 steps/s
[Step=4950 Epoch=24.3] | Loss=0.05565 | Reg=0.00261 | acc=0.9375 | FP-Norm=1.580 | FP-Norm(final)=2.478 | 3830.9 samples/s | 59.9 steps/s
[Step=5000 Epoch=24.5] | Loss=0.05392 | Reg=0.00294 | acc=0.9531 | FP-Norm=1.681 | FP-Norm(final)=2.475 | 5025.3 samples/s | 78.5 steps/s
[Step=5050 Epoch=24.8] | Loss=0.04934 | Reg=0.00323 | acc=0.9688 | FP-Norm=1.764 | FP-Norm(final)=2.474 | 1679.6 samples/s | 26.2 steps/s
[Step=5100 Epoch=25.0] | Loss=0.04654 | Reg=0.00346 | acc=1.0000 | FP-Norm=1.827 | FP-Norm(final)=2.476 | 3933.6 samples/s | 61.5 steps/s
[Step=5150 Epoch=25.3] | Loss=0.04426 | Reg=0.00364 | acc=0.9688 | FP-Norm=1.877 | FP-Norm(final)=2.479 | 3941.6 samples/s | 61.6 steps/s
[Step=5200 Epoch=25.5] | Loss=0.04218 | Reg=0.00383 | acc=0.9844 | FP-Norm=1.926 | FP-Norm(final)=2.481 | 4946.1 samples/s | 77.3 steps/s
[Step=5250 Epoch=25.7] | Loss=0.03938 | Reg=0.00400 | acc=0.9688 | FP-Norm=1.969 | FP-Norm(final)=2.483 | 1701.9 samples/s | 26.6 steps/s
[Step=5300 Epoch=26.0] | Loss=0.03748 | Reg=0.00414 | acc=0.9688 | FP-Norm=2.004 | FP-Norm(final)=2.487 | 3972.6 samples/s | 62.1 steps/s
[Step=5350 Epoch=26.2] | Loss=0.03645 | Reg=0.00426 | acc=0.9531 | FP-Norm=2.034 | FP-Norm(final)=2.490 | 3866.1 samples/s | 60.4 steps/s
[Step=5400 Epoch=26.5] | Loss=0.03517 | Reg=0.00438 | acc=1.0000 | FP-Norm=2.063 | FP-Norm(final)=2.493 | 4557.4 samples/s | 71.2 steps/s
[Step=5450 Epoch=26.7] | Loss=0.03369 | Reg=0.00448 | acc=0.9844 | FP-Norm=2.089 | FP-Norm(final)=2.496 | 1699.0 samples/s | 26.5 steps/s
[Step=5500 Epoch=27.0] | Loss=0.03275 | Reg=0.00458 | acc=0.9531 | FP-Norm=2.113 | FP-Norm(final)=2.500 | 3846.9 samples/s | 60.1 steps/s
[Step=5550 Epoch=27.2] | Loss=0.03168 | Reg=0.00468 | acc=0.9844 | FP-Norm=2.135 | FP-Norm(final)=2.502 | 3887.4 samples/s | 60.7 steps/s
[Step=5600 Epoch=27.5] | Loss=0.03097 | Reg=0.00476 | acc=1.0000 | FP-Norm=2.156 | FP-Norm(final)=2.505 | 4385.8 samples/s | 68.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step5600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.5] | Loss=0.29689 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.501 | 3504.5 samples/s | 54.8 steps/s
[Step=4850 Epoch=46.0] | Loss=0.03929 | Reg=0.00885 | acc=0.9688 | FP-Norm=2.828 | FP-Norm(final)=2.438 | 3616.5 samples/s | 56.5 steps/s
[Step=4900 Epoch=46.4] | Loss=0.02407 | Reg=0.01029 | acc=1.0000 | FP-Norm=3.127 | FP-Norm(final)=2.410 | 4860.7 samples/s | 75.9 steps/s
[Step=4950 Epoch=46.9] | Loss=0.01622 | Reg=0.01013 | acc=1.0000 | FP-Norm=3.128 | FP-Norm(final)=2.408 | 1601.1 samples/s | 25.0 steps/s
[Step=5000 Epoch=47.4] | Loss=0.01222 | Reg=0.00966 | acc=1.0000 | FP-Norm=3.063 | FP-Norm(final)=2.411 | 4536.8 samples/s | 70.9 steps/s
[Step=5050 Epoch=47.9] | Loss=0.00980 | Reg=0.00915 | acc=1.0000 | FP-Norm=2.985 | FP-Norm(final)=2.415 | 1645.0 samples/s | 25.7 steps/s
[Step=5100 Epoch=48.3] | Loss=0.00818 | Reg=0.00868 | acc=1.0000 | FP-Norm=2.907 | FP-Norm(final)=2.418 | 4165.2 samples/s | 65.1 steps/s
[Step=5150 Epoch=48.8] | Loss=0.00702 | Reg=0.00825 | acc=1.0000 | FP-Norm=2.831 | FP-Norm(final)=2.422 | 1682.4 samples/s | 26.3 steps/s
[Step=5200 Epoch=49.3] | Loss=0.00615 | Reg=0.00786 | acc=1.0000 | FP-Norm=2.760 | FP-Norm(final)=2.425 | 4025.0 samples/s | 62.9 steps/s
[Step=5250 Epoch=49.7] | Loss=0.00547 | Reg=0.00750 | acc=1.0000 | FP-Norm=2.692 | FP-Norm(final)=2.429 | 1717.0 samples/s | 26.8 steps/s
[Step=5300 Epoch=50.2] | Loss=0.00493 | Reg=0.00717 | acc=1.0000 | FP-Norm=2.628 | FP-Norm(final)=2.432 | 3709.4 samples/s | 58.0 steps/s
[Step=5350 Epoch=50.7] | Loss=0.00449 | Reg=0.00687 | acc=1.0000 | FP-Norm=2.567 | FP-Norm(final)=2.435 | 1758.3 samples/s | 27.5 steps/s
[Step=5400 Epoch=51.2] | Loss=0.00412 | Reg=0.00659 | acc=1.0000 | FP-Norm=2.509 | FP-Norm(final)=2.438 | 3694.8 samples/s | 57.7 steps/s
[Step=5450 Epoch=51.6] | Loss=0.00381 | Reg=0.00633 | acc=1.0000 | FP-Norm=2.454 | FP-Norm(final)=2.441 | 1788.8 samples/s | 27.9 steps/s
[Step=5500 Epoch=52.1] | Loss=0.00354 | Reg=0.00609 | acc=1.0000 | FP-Norm=2.402 | FP-Norm(final)=2.444 | 3678.8 samples/s | 57.5 steps/s
[Step=5550 Epoch=52.6] | Loss=0.00331 | Reg=0.00586 | acc=1.0000 | FP-Norm=2.351 | FP-Norm(final)=2.447 | 1791.4 samples/s | 28.0 steps/s
[Step=5600 Epoch=53.1] | Loss=0.00311 | Reg=0.00565 | acc=1.0000 | FP-Norm=2.303 | FP-Norm(final)=2.450 | 3648.6 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step5600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.7] | Loss=0.05600 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.504 | 3493.4 samples/s | 54.6 steps/s
[Step=4850 Epoch=46.1] | Loss=0.02779 | Reg=0.00579 | acc=1.0000 | FP-Norm=2.243 | FP-Norm(final)=2.447 | 3641.6 samples/s | 56.9 steps/s
[Step=4900 Epoch=46.6] | Loss=0.01714 | Reg=0.00705 | acc=1.0000 | FP-Norm=2.564 | FP-Norm(final)=2.441 | 4897.3 samples/s | 76.5 steps/s
[Step=4950 Epoch=47.1] | Loss=0.01162 | Reg=0.00712 | acc=1.0000 | FP-Norm=2.607 | FP-Norm(final)=2.447 | 1594.4 samples/s | 24.9 steps/s
[Step=5000 Epoch=47.6] | Loss=0.00879 | Reg=0.00689 | acc=1.0000 | FP-Norm=2.578 | FP-Norm(final)=2.454 | 4426.1 samples/s | 69.2 steps/s
[Step=5050 Epoch=48.0] | Loss=0.00705 | Reg=0.00658 | acc=1.0000 | FP-Norm=2.524 | FP-Norm(final)=2.459 | 1632.7 samples/s | 25.5 steps/s
[Step=5100 Epoch=48.5] | Loss=0.00588 | Reg=0.00626 | acc=1.0000 | FP-Norm=2.463 | FP-Norm(final)=2.464 | 4266.5 samples/s | 66.7 steps/s
[Step=5150 Epoch=49.0] | Loss=0.00505 | Reg=0.00595 | acc=1.0000 | FP-Norm=2.401 | FP-Norm(final)=2.468 | 1640.7 samples/s | 25.6 steps/s
[Step=5200 Epoch=49.5] | Loss=0.00442 | Reg=0.00567 | acc=1.0000 | FP-Norm=2.340 | FP-Norm(final)=2.472 | 3944.7 samples/s | 61.6 steps/s
[Step=5250 Epoch=49.9] | Loss=0.00394 | Reg=0.00540 | acc=1.0000 | FP-Norm=2.281 | FP-Norm(final)=2.475 | 1710.6 samples/s | 26.7 steps/s
[Step=5300 Epoch=50.4] | Loss=0.00355 | Reg=0.00516 | acc=1.0000 | FP-Norm=2.225 | FP-Norm(final)=2.478 | 3726.6 samples/s | 58.2 steps/s
[Step=5350 Epoch=50.9] | Loss=0.00323 | Reg=0.00493 | acc=1.0000 | FP-Norm=2.171 | FP-Norm(final)=2.481 | 1755.7 samples/s | 27.4 steps/s
[Step=5400 Epoch=51.4] | Loss=0.00296 | Reg=0.00472 | acc=1.0000 | FP-Norm=2.119 | FP-Norm(final)=2.484 | 3656.3 samples/s | 57.1 steps/s
[Step=5450 Epoch=51.8] | Loss=0.00274 | Reg=0.00453 | acc=1.0000 | FP-Norm=2.070 | FP-Norm(final)=2.486 | 1753.2 samples/s | 27.4 steps/s
[Step=5500 Epoch=52.3] | Loss=0.00255 | Reg=0.00435 | acc=1.0000 | FP-Norm=2.023 | FP-Norm(final)=2.488 | 3725.9 samples/s | 58.2 steps/s
[Step=5550 Epoch=52.8] | Loss=0.00238 | Reg=0.00418 | acc=1.0000 | FP-Norm=1.978 | FP-Norm(final)=2.491 | 1785.1 samples/s | 27.9 steps/s
[Step=5600 Epoch=53.3] | Loss=0.00224 | Reg=0.00402 | acc=1.0000 | FP-Norm=1.935 | FP-Norm(final)=2.493 | 3638.9 samples/s | 56.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step5600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.8] | Loss=0.19533 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.501 | 3566.9 samples/s | 55.7 steps/s
[Step=4850 Epoch=46.3] | Loss=0.03292 | Reg=0.00707 | acc=1.0000 | FP-Norm=2.506 | FP-Norm(final)=2.440 | 3565.7 samples/s | 55.7 steps/s
[Step=4900 Epoch=46.8] | Loss=0.01751 | Reg=0.00787 | acc=1.0000 | FP-Norm=2.724 | FP-Norm(final)=2.440 | 4836.5 samples/s | 75.6 steps/s
[Step=4950 Epoch=47.3] | Loss=0.01171 | Reg=0.00757 | acc=1.0000 | FP-Norm=2.696 | FP-Norm(final)=2.445 | 1563.9 samples/s | 24.4 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00881 | Reg=0.00714 | acc=1.0000 | FP-Norm=2.626 | FP-Norm(final)=2.450 | 4532.7 samples/s | 70.8 steps/s
[Step=5050 Epoch=48.2] | Loss=0.00706 | Reg=0.00672 | acc=1.0000 | FP-Norm=2.549 | FP-Norm(final)=2.454 | 1634.3 samples/s | 25.5 steps/s
[Step=5100 Epoch=48.7] | Loss=0.00589 | Reg=0.00633 | acc=1.0000 | FP-Norm=2.475 | FP-Norm(final)=2.458 | 4410.1 samples/s | 68.9 steps/s
[Step=5150 Epoch=49.2] | Loss=0.00506 | Reg=0.00599 | acc=1.0000 | FP-Norm=2.405 | FP-Norm(final)=2.461 | 1660.6 samples/s | 25.9 steps/s
[Step=5200 Epoch=49.7] | Loss=0.00443 | Reg=0.00568 | acc=1.0000 | FP-Norm=2.338 | FP-Norm(final)=2.464 | 4018.6 samples/s | 62.8 steps/s
[Step=5250 Epoch=50.1] | Loss=0.00395 | Reg=0.00540 | acc=1.0000 | FP-Norm=2.276 | FP-Norm(final)=2.467 | 1675.1 samples/s | 26.2 steps/s
[Step=5300 Epoch=50.6] | Loss=0.00356 | Reg=0.00515 | acc=1.0000 | FP-Norm=2.217 | FP-Norm(final)=2.470 | 3869.1 samples/s | 60.5 steps/s
[Step=5350 Epoch=51.1] | Loss=0.00324 | Reg=0.00492 | acc=1.0000 | FP-Norm=2.162 | FP-Norm(final)=2.473 | 1726.4 samples/s | 27.0 steps/s
[Step=5400 Epoch=51.6] | Loss=0.00297 | Reg=0.00470 | acc=1.0000 | FP-Norm=2.110 | FP-Norm(final)=2.475 | 3702.4 samples/s | 57.8 steps/s
[Step=5450 Epoch=52.0] | Loss=0.00275 | Reg=0.00451 | acc=1.0000 | FP-Norm=2.060 | FP-Norm(final)=2.478 | 1758.9 samples/s | 27.5 steps/s
[Step=5500 Epoch=52.5] | Loss=0.00256 | Reg=0.00432 | acc=1.0000 | FP-Norm=2.013 | FP-Norm(final)=2.480 | 3674.1 samples/s | 57.4 steps/s
[Step=5550 Epoch=53.0] | Loss=0.00239 | Reg=0.00415 | acc=1.0000 | FP-Norm=1.968 | FP-Norm(final)=2.482 | 1751.4 samples/s | 27.4 steps/s
[Step=5600 Epoch=53.5] | Loss=0.00224 | Reg=0.00400 | acc=1.0000 | FP-Norm=1.924 | FP-Norm(final)=2.484 | 3770.0 samples/s | 58.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step5600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.2] | Loss=0.20745 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.502 | 3730.4 samples/s | 58.3 steps/s
[Step=4850 Epoch=45.7] | Loss=0.02127 | Reg=0.00621 | acc=1.0000 | FP-Norm=2.360 | FP-Norm(final)=2.454 | 3381.9 samples/s | 52.8 steps/s
[Step=4900 Epoch=46.2] | Loss=0.01790 | Reg=0.00745 | acc=0.9844 | FP-Norm=2.653 | FP-Norm(final)=2.439 | 4854.6 samples/s | 75.9 steps/s
[Step=4950 Epoch=46.6] | Loss=0.01246 | Reg=0.00793 | acc=1.0000 | FP-Norm=2.763 | FP-Norm(final)=2.429 | 1590.9 samples/s | 24.9 steps/s
[Step=5000 Epoch=47.1] | Loss=0.00940 | Reg=0.00781 | acc=1.0000 | FP-Norm=2.754 | FP-Norm(final)=2.429 | 4325.5 samples/s | 67.6 steps/s
[Step=5050 Epoch=47.6] | Loss=0.00753 | Reg=0.00752 | acc=1.0000 | FP-Norm=2.708 | FP-Norm(final)=2.431 | 1624.6 samples/s | 25.4 steps/s
[Step=5100 Epoch=48.1] | Loss=0.00628 | Reg=0.00720 | acc=1.0000 | FP-Norm=2.650 | FP-Norm(final)=2.434 | 4064.5 samples/s | 63.5 steps/s
[Step=5150 Epoch=48.5] | Loss=0.00539 | Reg=0.00688 | acc=1.0000 | FP-Norm=2.589 | FP-Norm(final)=2.437 | 1710.1 samples/s | 26.7 steps/s
[Step=5200 Epoch=49.0] | Loss=0.00472 | Reg=0.00657 | acc=1.0000 | FP-Norm=2.529 | FP-Norm(final)=2.440 | 3810.6 samples/s | 59.5 steps/s
[Step=5250 Epoch=49.5] | Loss=0.00420 | Reg=0.00628 | acc=1.0000 | FP-Norm=2.469 | FP-Norm(final)=2.443 | 1746.2 samples/s | 27.3 steps/s
[Step=5300 Epoch=49.9] | Loss=0.00379 | Reg=0.00601 | acc=1.0000 | FP-Norm=2.412 | FP-Norm(final)=2.446 | 3752.1 samples/s | 58.6 steps/s
[Step=5350 Epoch=50.4] | Loss=0.00345 | Reg=0.00576 | acc=1.0000 | FP-Norm=2.357 | FP-Norm(final)=2.449 | 1807.8 samples/s | 28.2 steps/s
[Step=5400 Epoch=50.9] | Loss=0.00316 | Reg=0.00553 | acc=1.0000 | FP-Norm=2.304 | FP-Norm(final)=2.452 | 3815.8 samples/s | 59.6 steps/s
[Step=5450 Epoch=51.4] | Loss=0.00292 | Reg=0.00531 | acc=1.0000 | FP-Norm=2.253 | FP-Norm(final)=2.455 | 1770.8 samples/s | 27.7 steps/s
[Step=5500 Epoch=51.8] | Loss=0.00272 | Reg=0.00511 | acc=1.0000 | FP-Norm=2.204 | FP-Norm(final)=2.457 | 3571.2 samples/s | 55.8 steps/s
[Step=5550 Epoch=52.3] | Loss=0.00254 | Reg=0.00492 | acc=1.0000 | FP-Norm=2.157 | FP-Norm(final)=2.460 | 1876.7 samples/s | 29.3 steps/s
[Step=5600 Epoch=52.8] | Loss=0.00238 | Reg=0.00474 | acc=1.0000 | FP-Norm=2.112 | FP-Norm(final)=2.463 | 3381.8 samples/s | 52.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step5600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.8] | Loss=0.08853 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.504 | 3589.4 samples/s | 56.1 steps/s
[Step=4850 Epoch=46.2] | Loss=0.01858 | Reg=0.00450 | acc=1.0000 | FP-Norm=2.003 | FP-Norm(final)=2.473 | 3459.9 samples/s | 54.1 steps/s
[Step=4900 Epoch=46.7] | Loss=0.01332 | Reg=0.00596 | acc=1.0000 | FP-Norm=2.364 | FP-Norm(final)=2.464 | 4947.6 samples/s | 77.3 steps/s
[Step=4950 Epoch=47.2] | Loss=0.00953 | Reg=0.00648 | acc=1.0000 | FP-Norm=2.490 | FP-Norm(final)=2.465 | 1595.8 samples/s | 24.9 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00723 | Reg=0.00656 | acc=1.0000 | FP-Norm=2.519 | FP-Norm(final)=2.469 | 4504.0 samples/s | 70.4 steps/s
[Step=5050 Epoch=48.1] | Loss=0.00580 | Reg=0.00644 | acc=1.0000 | FP-Norm=2.503 | FP-Norm(final)=2.473 | 1625.4 samples/s | 25.4 steps/s
[Step=5100 Epoch=48.6] | Loss=0.00484 | Reg=0.00624 | acc=1.0000 | FP-Norm=2.467 | FP-Norm(final)=2.476 | 4283.1 samples/s | 66.9 steps/s
[Step=5150 Epoch=49.1] | Loss=0.00416 | Reg=0.00601 | acc=1.0000 | FP-Norm=2.423 | FP-Norm(final)=2.479 | 1662.2 samples/s | 26.0 steps/s
[Step=5200 Epoch=49.6] | Loss=0.00365 | Reg=0.00578 | acc=1.0000 | FP-Norm=2.376 | FP-Norm(final)=2.482 | 4104.2 samples/s | 64.1 steps/s
[Step=5250 Epoch=50.0] | Loss=0.00325 | Reg=0.00556 | acc=1.0000 | FP-Norm=2.327 | FP-Norm(final)=2.484 | 1700.4 samples/s | 26.6 steps/s
[Step=5300 Epoch=50.5] | Loss=0.00293 | Reg=0.00534 | acc=1.0000 | FP-Norm=2.279 | FP-Norm(final)=2.486 | 3889.1 samples/s | 60.8 steps/s
[Step=5350 Epoch=51.0] | Loss=0.00266 | Reg=0.00514 | acc=1.0000 | FP-Norm=2.232 | FP-Norm(final)=2.488 | 1716.9 samples/s | 26.8 steps/s
[Step=5400 Epoch=51.5] | Loss=0.00245 | Reg=0.00495 | acc=1.0000 | FP-Norm=2.186 | FP-Norm(final)=2.490 | 3699.2 samples/s | 57.8 steps/s
[Step=5450 Epoch=51.9] | Loss=0.00226 | Reg=0.00476 | acc=1.0000 | FP-Norm=2.141 | FP-Norm(final)=2.492 | 1798.9 samples/s | 28.1 steps/s
[Step=5500 Epoch=52.4] | Loss=0.00210 | Reg=0.00459 | acc=1.0000 | FP-Norm=2.097 | FP-Norm(final)=2.494 | 3758.7 samples/s | 58.7 steps/s
[Step=5550 Epoch=52.9] | Loss=0.00197 | Reg=0.00442 | acc=1.0000 | FP-Norm=2.054 | FP-Norm(final)=2.495 | 1767.4 samples/s | 27.6 steps/s
[Step=5600 Epoch=53.4] | Loss=0.00185 | Reg=0.00427 | acc=1.0000 | FP-Norm=2.013 | FP-Norm(final)=2.497 | 3736.2 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25250 | acc=0.8091 | tpr=0.7335 | fpr=0.0268 | 3743.2 samples/s | 14.6 steps/s
Avg test loss: 0.25093, Avg test acc: 0.81080, Avg tpr: 0.73649, Avg fpr: 0.02577, total FA: 201

Testing server on iccad2012
[Step=  50] | Loss=0.44985 | acc=0.7796 | tpr=0.9558 | fpr=0.2236 | 3717.6 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.45445 | acc=0.7804 | tpr=0.9531 | fpr=0.2228 | 7156.6 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.45833 | acc=0.7796 | tpr=0.9582 | fpr=0.2237 | 7176.4 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.45756 | acc=0.7803 | tpr=0.9639 | fpr=0.2230 | 7300.4 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.45577 | acc=0.7806 | tpr=0.9633 | fpr=0.2227 | 7092.2 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.45709 | acc=0.7808 | tpr=0.9585 | fpr=0.2224 | 7153.2 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.45754 | acc=0.7807 | tpr=0.9606 | fpr=0.2225 | 7246.1 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.45754 | acc=0.7801 | tpr=0.9601 | fpr=0.2232 | 7120.3 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.45900 | acc=0.7806 | tpr=0.9611 | fpr=0.2226 | 7070.8 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.46060 | acc=0.7801 | tpr=0.9612 | fpr=0.2231 | 7097.8 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.46025 | acc=0.7802 | tpr=0.9610 | fpr=0.2231 | 13146.7 samples/s | 51.4 steps/s
Avg test loss: 0.46030, Avg test acc: 0.78021, Avg tpr: 0.96117, Avg fpr: 0.22308, total FA: 30974

server round 7/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.23719 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.519 | 3726.4 samples/s | 58.2 steps/s
[Step=5650 Epoch=27.6] | Loss=0.05738 | Reg=0.00188 | acc=0.9531 | FP-Norm=1.314 | FP-Norm(final)=2.510 | 3807.0 samples/s | 59.5 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05469 | Reg=0.00244 | acc=0.9844 | FP-Norm=1.522 | FP-Norm(final)=2.496 | 3860.4 samples/s | 60.3 steps/s
[Step=5750 Epoch=28.0] | Loss=0.05353 | Reg=0.00273 | acc=0.9844 | FP-Norm=1.620 | FP-Norm(final)=2.489 | 3911.3 samples/s | 61.1 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04941 | Reg=0.00293 | acc=0.9844 | FP-Norm=1.684 | FP-Norm(final)=2.485 | 5099.4 samples/s | 79.7 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04786 | Reg=0.00328 | acc=0.9375 | FP-Norm=1.779 | FP-Norm(final)=2.482 | 1662.0 samples/s | 26.0 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04606 | Reg=0.00361 | acc=0.9844 | FP-Norm=1.865 | FP-Norm(final)=2.480 | 3807.1 samples/s | 59.5 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04392 | Reg=0.00385 | acc=0.9844 | FP-Norm=1.927 | FP-Norm(final)=2.479 | 3841.6 samples/s | 60.0 steps/s
[Step=6000 Epoch=29.3] | Loss=0.04244 | Reg=0.00402 | acc=0.9688 | FP-Norm=1.972 | FP-Norm(final)=2.479 | 4657.0 samples/s | 72.8 steps/s
[Step=6050 Epoch=29.5] | Loss=0.03976 | Reg=0.00416 | acc=0.9844 | FP-Norm=2.008 | FP-Norm(final)=2.479 | 1706.6 samples/s | 26.7 steps/s
[Step=6100 Epoch=29.7] | Loss=0.03734 | Reg=0.00426 | acc=1.0000 | FP-Norm=2.035 | FP-Norm(final)=2.482 | 3850.1 samples/s | 60.2 steps/s
[Step=6150 Epoch=30.0] | Loss=0.03594 | Reg=0.00435 | acc=0.9844 | FP-Norm=2.057 | FP-Norm(final)=2.484 | 3844.0 samples/s | 60.1 steps/s
[Step=6200 Epoch=30.2] | Loss=0.03455 | Reg=0.00443 | acc=1.0000 | FP-Norm=2.078 | FP-Norm(final)=2.486 | 4371.5 samples/s | 68.3 steps/s
[Step=6250 Epoch=30.5] | Loss=0.03318 | Reg=0.00451 | acc=0.9844 | FP-Norm=2.099 | FP-Norm(final)=2.489 | 1754.6 samples/s | 27.4 steps/s
[Step=6300 Epoch=30.7] | Loss=0.03179 | Reg=0.00458 | acc=1.0000 | FP-Norm=2.116 | FP-Norm(final)=2.492 | 3860.1 samples/s | 60.3 steps/s
[Step=6350 Epoch=31.0] | Loss=0.03076 | Reg=0.00465 | acc=1.0000 | FP-Norm=2.133 | FP-Norm(final)=2.496 | 3858.6 samples/s | 60.3 steps/s
[Step=6400 Epoch=31.2] | Loss=0.03013 | Reg=0.00473 | acc=1.0000 | FP-Norm=2.151 | FP-Norm(final)=2.499 | 4161.9 samples/s | 65.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step6400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.14467 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.520 | 3945.8 samples/s | 61.7 steps/s
[Step=5650 Epoch=27.6] | Loss=0.06164 | Reg=0.00182 | acc=0.9844 | FP-Norm=1.289 | FP-Norm(final)=2.503 | 3486.1 samples/s | 54.5 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05687 | Reg=0.00229 | acc=0.9844 | FP-Norm=1.476 | FP-Norm(final)=2.494 | 3806.7 samples/s | 59.5 steps/s
[Step=5750 Epoch=28.1] | Loss=0.05289 | Reg=0.00258 | acc=0.9531 | FP-Norm=1.577 | FP-Norm(final)=2.489 | 3852.8 samples/s | 60.2 steps/s
[Step=5800 Epoch=28.3] | Loss=0.05114 | Reg=0.00285 | acc=0.9688 | FP-Norm=1.659 | FP-Norm(final)=2.488 | 4931.4 samples/s | 77.1 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04720 | Reg=0.00315 | acc=0.9844 | FP-Norm=1.745 | FP-Norm(final)=2.486 | 1660.0 samples/s | 25.9 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04435 | Reg=0.00338 | acc=0.9844 | FP-Norm=1.809 | FP-Norm(final)=2.485 | 3805.4 samples/s | 59.5 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04166 | Reg=0.00355 | acc=0.9844 | FP-Norm=1.857 | FP-Norm(final)=2.486 | 3925.8 samples/s | 61.3 steps/s
[Step=6000 Epoch=29.3] | Loss=0.04067 | Reg=0.00373 | acc=1.0000 | FP-Norm=1.903 | FP-Norm(final)=2.487 | 4711.7 samples/s | 73.6 steps/s
[Step=6050 Epoch=29.5] | Loss=0.03883 | Reg=0.00389 | acc=1.0000 | FP-Norm=1.944 | FP-Norm(final)=2.488 | 1698.4 samples/s | 26.5 steps/s
[Step=6100 Epoch=29.8] | Loss=0.03663 | Reg=0.00403 | acc=1.0000 | FP-Norm=1.979 | FP-Norm(final)=2.490 | 3859.0 samples/s | 60.3 steps/s
[Step=6150 Epoch=30.0] | Loss=0.03558 | Reg=0.00414 | acc=0.9844 | FP-Norm=2.008 | FP-Norm(final)=2.492 | 3883.8 samples/s | 60.7 steps/s
[Step=6200 Epoch=30.3] | Loss=0.03453 | Reg=0.00425 | acc=0.9844 | FP-Norm=2.035 | FP-Norm(final)=2.494 | 4560.4 samples/s | 71.3 steps/s
[Step=6250 Epoch=30.5] | Loss=0.03356 | Reg=0.00437 | acc=1.0000 | FP-Norm=2.064 | FP-Norm(final)=2.495 | 1740.8 samples/s | 27.2 steps/s
[Step=6300 Epoch=30.7] | Loss=0.03218 | Reg=0.00447 | acc=1.0000 | FP-Norm=2.089 | FP-Norm(final)=2.497 | 3845.4 samples/s | 60.1 steps/s
[Step=6350 Epoch=31.0] | Loss=0.03112 | Reg=0.00456 | acc=1.0000 | FP-Norm=2.110 | FP-Norm(final)=2.499 | 3851.8 samples/s | 60.2 steps/s
[Step=6400 Epoch=31.2] | Loss=0.03074 | Reg=0.00465 | acc=1.0000 | FP-Norm=2.131 | FP-Norm(final)=2.501 | 4301.7 samples/s | 67.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step6400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.24832 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.519 | 3670.4 samples/s | 57.4 steps/s
[Step=5650 Epoch=27.5] | Loss=0.05970 | Reg=0.00164 | acc=0.9531 | FP-Norm=1.225 | FP-Norm(final)=2.499 | 3756.0 samples/s | 58.7 steps/s
[Step=5700 Epoch=27.8] | Loss=0.06288 | Reg=0.00220 | acc=0.9688 | FP-Norm=1.441 | FP-Norm(final)=2.487 | 3861.5 samples/s | 60.3 steps/s
[Step=5750 Epoch=28.0] | Loss=0.05847 | Reg=0.00257 | acc=0.9844 | FP-Norm=1.569 | FP-Norm(final)=2.478 | 3847.5 samples/s | 60.1 steps/s
[Step=5800 Epoch=28.3] | Loss=0.05517 | Reg=0.00290 | acc=0.9688 | FP-Norm=1.669 | FP-Norm(final)=2.476 | 4870.8 samples/s | 76.1 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04986 | Reg=0.00313 | acc=0.9844 | FP-Norm=1.739 | FP-Norm(final)=2.477 | 1692.1 samples/s | 26.4 steps/s
[Step=5900 Epoch=28.7] | Loss=0.04547 | Reg=0.00331 | acc=0.9844 | FP-Norm=1.790 | FP-Norm(final)=2.479 | 3910.0 samples/s | 61.1 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04332 | Reg=0.00347 | acc=0.9375 | FP-Norm=1.835 | FP-Norm(final)=2.482 | 3955.5 samples/s | 61.8 steps/s
[Step=6000 Epoch=29.2] | Loss=0.04123 | Reg=0.00365 | acc=1.0000 | FP-Norm=1.882 | FP-Norm(final)=2.483 | 4782.2 samples/s | 74.7 steps/s
[Step=6050 Epoch=29.5] | Loss=0.04008 | Reg=0.00382 | acc=0.9844 | FP-Norm=1.925 | FP-Norm(final)=2.484 | 1717.8 samples/s | 26.8 steps/s
[Step=6100 Epoch=29.7] | Loss=0.03829 | Reg=0.00397 | acc=0.9844 | FP-Norm=1.964 | FP-Norm(final)=2.485 | 3934.8 samples/s | 61.5 steps/s
[Step=6150 Epoch=30.0] | Loss=0.03665 | Reg=0.00410 | acc=0.9688 | FP-Norm=1.997 | FP-Norm(final)=2.487 | 3841.6 samples/s | 60.0 steps/s
[Step=6200 Epoch=30.2] | Loss=0.03562 | Reg=0.00423 | acc=0.9844 | FP-Norm=2.028 | FP-Norm(final)=2.488 | 4355.1 samples/s | 68.0 steps/s
[Step=6250 Epoch=30.5] | Loss=0.03440 | Reg=0.00434 | acc=0.9688 | FP-Norm=2.056 | FP-Norm(final)=2.490 | 1744.9 samples/s | 27.3 steps/s
[Step=6300 Epoch=30.7] | Loss=0.03328 | Reg=0.00445 | acc=1.0000 | FP-Norm=2.081 | FP-Norm(final)=2.492 | 3949.8 samples/s | 61.7 steps/s
[Step=6350 Epoch=30.9] | Loss=0.03208 | Reg=0.00454 | acc=1.0000 | FP-Norm=2.105 | FP-Norm(final)=2.495 | 3883.9 samples/s | 60.7 steps/s
[Step=6400 Epoch=31.2] | Loss=0.03152 | Reg=0.00465 | acc=1.0000 | FP-Norm=2.129 | FP-Norm(final)=2.498 | 4066.1 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step6400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.18350 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.519 | 3917.9 samples/s | 61.2 steps/s
[Step=5650 Epoch=27.6] | Loss=0.06671 | Reg=0.00240 | acc=0.9219 | FP-Norm=1.485 | FP-Norm(final)=2.498 | 3545.8 samples/s | 55.4 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05849 | Reg=0.00282 | acc=0.9531 | FP-Norm=1.640 | FP-Norm(final)=2.490 | 3840.2 samples/s | 60.0 steps/s
[Step=5750 Epoch=28.0] | Loss=0.05627 | Reg=0.00316 | acc=0.9375 | FP-Norm=1.747 | FP-Norm(final)=2.485 | 3849.7 samples/s | 60.2 steps/s
[Step=5800 Epoch=28.3] | Loss=0.05311 | Reg=0.00350 | acc=1.0000 | FP-Norm=1.841 | FP-Norm(final)=2.479 | 4940.2 samples/s | 77.2 steps/s
[Step=5850 Epoch=28.5] | Loss=0.05442 | Reg=0.00404 | acc=0.9844 | FP-Norm=1.970 | FP-Norm(final)=2.469 | 1659.9 samples/s | 25.9 steps/s
[Step=5900 Epoch=28.8] | Loss=0.05168 | Reg=0.00449 | acc=1.0000 | FP-Norm=2.073 | FP-Norm(final)=2.461 | 3949.1 samples/s | 61.7 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04968 | Reg=0.00476 | acc=0.9688 | FP-Norm=2.139 | FP-Norm(final)=2.456 | 3840.7 samples/s | 60.0 steps/s
[Step=6000 Epoch=29.3] | Loss=0.04835 | Reg=0.00497 | acc=1.0000 | FP-Norm=2.189 | FP-Norm(final)=2.452 | 4634.7 samples/s | 72.4 steps/s
[Step=6050 Epoch=29.5] | Loss=0.04528 | Reg=0.00513 | acc=0.9844 | FP-Norm=2.227 | FP-Norm(final)=2.449 | 1734.1 samples/s | 27.1 steps/s
[Step=6100 Epoch=29.7] | Loss=0.04290 | Reg=0.00525 | acc=1.0000 | FP-Norm=2.255 | FP-Norm(final)=2.449 | 3930.1 samples/s | 61.4 steps/s
[Step=6150 Epoch=30.0] | Loss=0.04075 | Reg=0.00534 | acc=0.9844 | FP-Norm=2.277 | FP-Norm(final)=2.451 | 3945.4 samples/s | 61.6 steps/s
[Step=6200 Epoch=30.2] | Loss=0.03931 | Reg=0.00541 | acc=0.9531 | FP-Norm=2.295 | FP-Norm(final)=2.452 | 4451.6 samples/s | 69.6 steps/s
[Step=6250 Epoch=30.5] | Loss=0.03923 | Reg=0.00554 | acc=0.9844 | FP-Norm=2.323 | FP-Norm(final)=2.452 | 1771.8 samples/s | 27.7 steps/s
[Step=6300 Epoch=30.7] | Loss=0.03811 | Reg=0.00576 | acc=1.0000 | FP-Norm=2.366 | FP-Norm(final)=2.452 | 3885.3 samples/s | 60.7 steps/s
[Step=6350 Epoch=31.0] | Loss=0.03761 | Reg=0.00592 | acc=0.9844 | FP-Norm=2.400 | FP-Norm(final)=2.452 | 3813.0 samples/s | 59.6 steps/s
[Step=6400 Epoch=31.2] | Loss=0.03657 | Reg=0.00606 | acc=1.0000 | FP-Norm=2.429 | FP-Norm(final)=2.452 | 4151.9 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step6400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.5] | Loss=0.12131 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.520 | 3674.4 samples/s | 57.4 steps/s
[Step=5650 Epoch=27.7] | Loss=0.06966 | Reg=0.00289 | acc=0.9844 | FP-Norm=1.626 | FP-Norm(final)=2.494 | 3938.5 samples/s | 61.5 steps/s
[Step=5700 Epoch=28.0] | Loss=0.05854 | Reg=0.00321 | acc=0.9688 | FP-Norm=1.753 | FP-Norm(final)=2.487 | 3943.8 samples/s | 61.6 steps/s
[Step=5750 Epoch=28.2] | Loss=0.05351 | Reg=0.00337 | acc=0.9688 | FP-Norm=1.808 | FP-Norm(final)=2.486 | 3921.5 samples/s | 61.3 steps/s
[Step=5800 Epoch=28.4] | Loss=0.05074 | Reg=0.00355 | acc=0.9844 | FP-Norm=1.861 | FP-Norm(final)=2.482 | 5149.9 samples/s | 80.5 steps/s
[Step=5850 Epoch=28.7] | Loss=0.04560 | Reg=0.00372 | acc=1.0000 | FP-Norm=1.910 | FP-Norm(final)=2.481 | 1668.7 samples/s | 26.1 steps/s
[Step=5900 Epoch=28.9] | Loss=0.04243 | Reg=0.00383 | acc=1.0000 | FP-Norm=1.941 | FP-Norm(final)=2.481 | 3839.9 samples/s | 60.0 steps/s
[Step=5950 Epoch=29.2] | Loss=0.04069 | Reg=0.00395 | acc=0.9531 | FP-Norm=1.971 | FP-Norm(final)=2.483 | 3855.8 samples/s | 60.2 steps/s
[Step=6000 Epoch=29.4] | Loss=0.03901 | Reg=0.00408 | acc=0.9688 | FP-Norm=2.003 | FP-Norm(final)=2.485 | 4819.3 samples/s | 75.3 steps/s
[Step=6050 Epoch=29.7] | Loss=0.03710 | Reg=0.00421 | acc=1.0000 | FP-Norm=2.036 | FP-Norm(final)=2.485 | 1690.8 samples/s | 26.4 steps/s
[Step=6100 Epoch=29.9] | Loss=0.03576 | Reg=0.00433 | acc=0.9688 | FP-Norm=2.065 | FP-Norm(final)=2.487 | 3842.7 samples/s | 60.0 steps/s
[Step=6150 Epoch=30.2] | Loss=0.03442 | Reg=0.00444 | acc=1.0000 | FP-Norm=2.091 | FP-Norm(final)=2.488 | 3855.0 samples/s | 60.2 steps/s
[Step=6200 Epoch=30.4] | Loss=0.03361 | Reg=0.00456 | acc=1.0000 | FP-Norm=2.118 | FP-Norm(final)=2.489 | 4633.8 samples/s | 72.4 steps/s
[Step=6250 Epoch=30.6] | Loss=0.03232 | Reg=0.00468 | acc=0.9688 | FP-Norm=2.146 | FP-Norm(final)=2.490 | 1706.1 samples/s | 26.7 steps/s
[Step=6300 Epoch=30.9] | Loss=0.03118 | Reg=0.00479 | acc=0.9844 | FP-Norm=2.170 | FP-Norm(final)=2.492 | 3807.2 samples/s | 59.5 steps/s
[Step=6350 Epoch=31.1] | Loss=0.03055 | Reg=0.00489 | acc=0.9844 | FP-Norm=2.194 | FP-Norm(final)=2.494 | 3835.7 samples/s | 59.9 steps/s
[Step=6400 Epoch=31.4] | Loss=0.03020 | Reg=0.00499 | acc=0.9531 | FP-Norm=2.216 | FP-Norm(final)=2.494 | 4422.2 samples/s | 69.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step6400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.1] | Loss=0.17891 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.518 | 3931.8 samples/s | 61.4 steps/s
[Step=5650 Epoch=53.5] | Loss=0.03263 | Reg=0.00745 | acc=0.9844 | FP-Norm=2.584 | FP-Norm(final)=2.448 | 3248.4 samples/s | 50.8 steps/s
[Step=5700 Epoch=54.0] | Loss=0.02426 | Reg=0.00845 | acc=0.9688 | FP-Norm=2.828 | FP-Norm(final)=2.434 | 4856.8 samples/s | 75.9 steps/s
[Step=5750 Epoch=54.5] | Loss=0.01924 | Reg=0.00906 | acc=1.0000 | FP-Norm=2.955 | FP-Norm(final)=2.411 | 1620.7 samples/s | 25.3 steps/s
[Step=5800 Epoch=55.0] | Loss=0.01466 | Reg=0.00907 | acc=1.0000 | FP-Norm=2.970 | FP-Norm(final)=2.405 | 4437.7 samples/s | 69.3 steps/s
[Step=5850 Epoch=55.4] | Loss=0.01201 | Reg=0.00886 | acc=1.0000 | FP-Norm=2.942 | FP-Norm(final)=2.403 | 1640.2 samples/s | 25.6 steps/s
[Step=5900 Epoch=55.9] | Loss=0.01002 | Reg=0.00856 | acc=1.0000 | FP-Norm=2.894 | FP-Norm(final)=2.404 | 4160.7 samples/s | 65.0 steps/s
[Step=5950 Epoch=56.4] | Loss=0.00859 | Reg=0.00823 | acc=1.0000 | FP-Norm=2.839 | FP-Norm(final)=2.406 | 1699.1 samples/s | 26.5 steps/s
[Step=6000 Epoch=56.9] | Loss=0.00753 | Reg=0.00792 | acc=1.0000 | FP-Norm=2.782 | FP-Norm(final)=2.409 | 3944.9 samples/s | 61.6 steps/s
[Step=6050 Epoch=57.3] | Loss=0.00670 | Reg=0.00761 | acc=1.0000 | FP-Norm=2.725 | FP-Norm(final)=2.412 | 1706.1 samples/s | 26.7 steps/s
[Step=6100 Epoch=57.8] | Loss=0.00603 | Reg=0.00732 | acc=1.0000 | FP-Norm=2.670 | FP-Norm(final)=2.415 | 3793.3 samples/s | 59.3 steps/s
[Step=6150 Epoch=58.3] | Loss=0.00549 | Reg=0.00704 | acc=1.0000 | FP-Norm=2.615 | FP-Norm(final)=2.418 | 1736.4 samples/s | 27.1 steps/s
[Step=6200 Epoch=58.8] | Loss=0.00503 | Reg=0.00678 | acc=1.0000 | FP-Norm=2.562 | FP-Norm(final)=2.421 | 3625.5 samples/s | 56.6 steps/s
[Step=6250 Epoch=59.2] | Loss=0.00465 | Reg=0.00654 | acc=1.0000 | FP-Norm=2.511 | FP-Norm(final)=2.424 | 1727.2 samples/s | 27.0 steps/s
[Step=6300 Epoch=59.7] | Loss=0.00432 | Reg=0.00631 | acc=1.0000 | FP-Norm=2.462 | FP-Norm(final)=2.427 | 3700.8 samples/s | 57.8 steps/s
[Step=6350 Epoch=60.2] | Loss=0.00403 | Reg=0.00609 | acc=1.0000 | FP-Norm=2.414 | FP-Norm(final)=2.430 | 1756.3 samples/s | 27.4 steps/s
[Step=6400 Epoch=60.6] | Loss=0.00379 | Reg=0.00588 | acc=1.0000 | FP-Norm=2.367 | FP-Norm(final)=2.433 | 3723.3 samples/s | 58.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step6400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.3] | Loss=0.06515 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.519 | 3678.6 samples/s | 57.5 steps/s
[Step=5650 Epoch=53.7] | Loss=0.02667 | Reg=0.00673 | acc=1.0000 | FP-Norm=2.432 | FP-Norm(final)=2.467 | 3412.8 samples/s | 53.3 steps/s
[Step=5700 Epoch=54.2] | Loss=0.01579 | Reg=0.00879 | acc=0.9844 | FP-Norm=2.862 | FP-Norm(final)=2.445 | 4861.8 samples/s | 76.0 steps/s
[Step=5750 Epoch=54.7] | Loss=0.01063 | Reg=0.00880 | acc=1.0000 | FP-Norm=2.897 | FP-Norm(final)=2.447 | 1569.5 samples/s | 24.5 steps/s
[Step=5800 Epoch=55.2] | Loss=0.00800 | Reg=0.00845 | acc=1.0000 | FP-Norm=2.854 | FP-Norm(final)=2.451 | 4462.4 samples/s | 69.7 steps/s
[Step=5850 Epoch=55.6] | Loss=0.00694 | Reg=0.00817 | acc=1.0000 | FP-Norm=2.813 | FP-Norm(final)=2.455 | 1612.9 samples/s | 25.2 steps/s
[Step=5900 Epoch=56.1] | Loss=0.00613 | Reg=0.00805 | acc=1.0000 | FP-Norm=2.800 | FP-Norm(final)=2.456 | 4173.4 samples/s | 65.2 steps/s
[Step=5950 Epoch=56.6] | Loss=0.00527 | Reg=0.00786 | acc=1.0000 | FP-Norm=2.770 | FP-Norm(final)=2.459 | 1661.6 samples/s | 26.0 steps/s
[Step=6000 Epoch=57.1] | Loss=0.00461 | Reg=0.00762 | acc=1.0000 | FP-Norm=2.727 | FP-Norm(final)=2.462 | 3919.1 samples/s | 61.2 steps/s
[Step=6050 Epoch=57.6] | Loss=0.00411 | Reg=0.00736 | acc=1.0000 | FP-Norm=2.680 | FP-Norm(final)=2.465 | 1692.4 samples/s | 26.4 steps/s
[Step=6100 Epoch=58.0] | Loss=0.00370 | Reg=0.00710 | acc=1.0000 | FP-Norm=2.630 | FP-Norm(final)=2.468 | 3818.8 samples/s | 59.7 steps/s
[Step=6150 Epoch=58.5] | Loss=0.00337 | Reg=0.00685 | acc=1.0000 | FP-Norm=2.580 | FP-Norm(final)=2.471 | 1747.4 samples/s | 27.3 steps/s
[Step=6200 Epoch=59.0] | Loss=0.00309 | Reg=0.00660 | acc=1.0000 | FP-Norm=2.530 | FP-Norm(final)=2.474 | 3745.5 samples/s | 58.5 steps/s
[Step=6250 Epoch=59.5] | Loss=0.00286 | Reg=0.00637 | acc=1.0000 | FP-Norm=2.481 | FP-Norm(final)=2.477 | 1748.3 samples/s | 27.3 steps/s
[Step=6300 Epoch=59.9] | Loss=0.00265 | Reg=0.00615 | acc=1.0000 | FP-Norm=2.433 | FP-Norm(final)=2.480 | 3749.9 samples/s | 58.6 steps/s
[Step=6350 Epoch=60.4] | Loss=0.00248 | Reg=0.00594 | acc=1.0000 | FP-Norm=2.386 | FP-Norm(final)=2.482 | 1763.3 samples/s | 27.6 steps/s
[Step=6400 Epoch=60.9] | Loss=0.00233 | Reg=0.00574 | acc=1.0000 | FP-Norm=2.341 | FP-Norm(final)=2.485 | 3669.6 samples/s | 57.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step6400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.5] | Loss=0.12180 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.518 | 3555.0 samples/s | 55.5 steps/s
[Step=5650 Epoch=54.0] | Loss=0.02572 | Reg=0.00782 | acc=1.0000 | FP-Norm=2.638 | FP-Norm(final)=2.454 | 3550.8 samples/s | 55.5 steps/s
[Step=5700 Epoch=54.4] | Loss=0.01411 | Reg=0.00861 | acc=1.0000 | FP-Norm=2.850 | FP-Norm(final)=2.452 | 4889.9 samples/s | 76.4 steps/s
[Step=5750 Epoch=54.9] | Loss=0.00946 | Reg=0.00826 | acc=1.0000 | FP-Norm=2.816 | FP-Norm(final)=2.457 | 1591.8 samples/s | 24.9 steps/s
[Step=5800 Epoch=55.4] | Loss=0.00713 | Reg=0.00778 | acc=1.0000 | FP-Norm=2.742 | FP-Norm(final)=2.463 | 4487.3 samples/s | 70.1 steps/s
[Step=5850 Epoch=55.9] | Loss=0.00571 | Reg=0.00732 | acc=1.0000 | FP-Norm=2.661 | FP-Norm(final)=2.468 | 1608.2 samples/s | 25.1 steps/s
[Step=5900 Epoch=56.3] | Loss=0.00477 | Reg=0.00690 | acc=1.0000 | FP-Norm=2.582 | FP-Norm(final)=2.472 | 4237.9 samples/s | 66.2 steps/s
[Step=5950 Epoch=56.8] | Loss=0.00410 | Reg=0.00652 | acc=1.0000 | FP-Norm=2.508 | FP-Norm(final)=2.476 | 1627.9 samples/s | 25.4 steps/s
[Step=6000 Epoch=57.3] | Loss=0.00359 | Reg=0.00618 | acc=1.0000 | FP-Norm=2.438 | FP-Norm(final)=2.479 | 4065.5 samples/s | 63.5 steps/s
[Step=6050 Epoch=57.8] | Loss=0.00320 | Reg=0.00587 | acc=1.0000 | FP-Norm=2.373 | FP-Norm(final)=2.482 | 1671.3 samples/s | 26.1 steps/s
[Step=6100 Epoch=58.3] | Loss=0.00288 | Reg=0.00559 | acc=1.0000 | FP-Norm=2.311 | FP-Norm(final)=2.485 | 3885.8 samples/s | 60.7 steps/s
[Step=6150 Epoch=58.7] | Loss=0.00262 | Reg=0.00534 | acc=1.0000 | FP-Norm=2.253 | FP-Norm(final)=2.488 | 1693.4 samples/s | 26.5 steps/s
[Step=6200 Epoch=59.2] | Loss=0.00241 | Reg=0.00510 | acc=1.0000 | FP-Norm=2.197 | FP-Norm(final)=2.491 | 3703.1 samples/s | 57.9 steps/s
[Step=6250 Epoch=59.7] | Loss=0.00223 | Reg=0.00489 | acc=1.0000 | FP-Norm=2.145 | FP-Norm(final)=2.493 | 1733.9 samples/s | 27.1 steps/s
[Step=6300 Epoch=60.2] | Loss=0.00207 | Reg=0.00469 | acc=1.0000 | FP-Norm=2.095 | FP-Norm(final)=2.496 | 3663.7 samples/s | 57.2 steps/s
[Step=6350 Epoch=60.6] | Loss=0.00193 | Reg=0.00450 | acc=1.0000 | FP-Norm=2.047 | FP-Norm(final)=2.498 | 1751.7 samples/s | 27.4 steps/s
[Step=6400 Epoch=61.1] | Loss=0.00182 | Reg=0.00433 | acc=1.0000 | FP-Norm=2.000 | FP-Norm(final)=2.500 | 3647.3 samples/s | 57.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step6400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=52.8] | Loss=0.10910 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.517 | 4064.0 samples/s | 63.5 steps/s
[Step=5650 Epoch=53.2] | Loss=0.01954 | Reg=0.00620 | acc=1.0000 | FP-Norm=2.362 | FP-Norm(final)=2.479 | 3129.3 samples/s | 48.9 steps/s
[Step=5700 Epoch=53.7] | Loss=0.01139 | Reg=0.00695 | acc=1.0000 | FP-Norm=2.567 | FP-Norm(final)=2.476 | 4865.0 samples/s | 76.0 steps/s
[Step=5750 Epoch=54.2] | Loss=0.00763 | Reg=0.00673 | acc=1.0000 | FP-Norm=2.548 | FP-Norm(final)=2.479 | 1614.7 samples/s | 25.2 steps/s
[Step=5800 Epoch=54.7] | Loss=0.00574 | Reg=0.00637 | acc=1.0000 | FP-Norm=2.486 | FP-Norm(final)=2.483 | 4325.9 samples/s | 67.6 steps/s
[Step=5850 Epoch=55.1] | Loss=0.00460 | Reg=0.00601 | acc=1.0000 | FP-Norm=2.416 | FP-Norm(final)=2.487 | 1660.5 samples/s | 25.9 steps/s
[Step=5900 Epoch=55.6] | Loss=0.00384 | Reg=0.00567 | acc=1.0000 | FP-Norm=2.346 | FP-Norm(final)=2.491 | 4057.9 samples/s | 63.4 steps/s
[Step=5950 Epoch=56.1] | Loss=0.00330 | Reg=0.00537 | acc=1.0000 | FP-Norm=2.280 | FP-Norm(final)=2.494 | 1733.2 samples/s | 27.1 steps/s
[Step=6000 Epoch=56.5] | Loss=0.00289 | Reg=0.00509 | acc=1.0000 | FP-Norm=2.217 | FP-Norm(final)=2.496 | 3837.5 samples/s | 60.0 steps/s
[Step=6050 Epoch=57.0] | Loss=0.00257 | Reg=0.00484 | acc=1.0000 | FP-Norm=2.158 | FP-Norm(final)=2.499 | 1769.8 samples/s | 27.7 steps/s
[Step=6100 Epoch=57.5] | Loss=0.00232 | Reg=0.00461 | acc=1.0000 | FP-Norm=2.102 | FP-Norm(final)=2.501 | 3648.1 samples/s | 57.0 steps/s
[Step=6150 Epoch=58.0] | Loss=0.00211 | Reg=0.00440 | acc=1.0000 | FP-Norm=2.049 | FP-Norm(final)=2.504 | 1745.5 samples/s | 27.3 steps/s
[Step=6200 Epoch=58.4] | Loss=0.00194 | Reg=0.00421 | acc=1.0000 | FP-Norm=1.999 | FP-Norm(final)=2.506 | 3768.6 samples/s | 58.9 steps/s
[Step=6250 Epoch=58.9] | Loss=0.00179 | Reg=0.00403 | acc=1.0000 | FP-Norm=1.951 | FP-Norm(final)=2.508 | 1821.6 samples/s | 28.5 steps/s
[Step=6300 Epoch=59.4] | Loss=0.00167 | Reg=0.00387 | acc=1.0000 | FP-Norm=1.906 | FP-Norm(final)=2.510 | 3712.5 samples/s | 58.0 steps/s
[Step=6350 Epoch=59.8] | Loss=0.00156 | Reg=0.00372 | acc=1.0000 | FP-Norm=1.862 | FP-Norm(final)=2.511 | 1868.7 samples/s | 29.2 steps/s
[Step=6400 Epoch=60.3] | Loss=0.00146 | Reg=0.00357 | acc=1.0000 | FP-Norm=1.821 | FP-Norm(final)=2.513 | 3509.2 samples/s | 54.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step6400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.4] | Loss=0.10818 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.518 | 3771.3 samples/s | 58.9 steps/s
[Step=5650 Epoch=53.8] | Loss=0.03554 | Reg=0.00727 | acc=1.0000 | FP-Norm=2.514 | FP-Norm(final)=2.446 | 3349.8 samples/s | 52.3 steps/s
[Step=5700 Epoch=54.3] | Loss=0.01945 | Reg=0.00873 | acc=1.0000 | FP-Norm=2.852 | FP-Norm(final)=2.435 | 4848.5 samples/s | 75.8 steps/s
[Step=5750 Epoch=54.8] | Loss=0.01304 | Reg=0.00856 | acc=1.0000 | FP-Norm=2.857 | FP-Norm(final)=2.440 | 1594.5 samples/s | 24.9 steps/s
[Step=5800 Epoch=55.3] | Loss=0.00980 | Reg=0.00815 | acc=1.0000 | FP-Norm=2.800 | FP-Norm(final)=2.445 | 4566.7 samples/s | 71.4 steps/s
[Step=5850 Epoch=55.8] | Loss=0.00786 | Reg=0.00772 | acc=1.0000 | FP-Norm=2.730 | FP-Norm(final)=2.451 | 1603.5 samples/s | 25.1 steps/s
[Step=5900 Epoch=56.2] | Loss=0.00656 | Reg=0.00731 | acc=1.0000 | FP-Norm=2.657 | FP-Norm(final)=2.455 | 4263.8 samples/s | 66.6 steps/s
[Step=5950 Epoch=56.7] | Loss=0.00563 | Reg=0.00693 | acc=1.0000 | FP-Norm=2.586 | FP-Norm(final)=2.459 | 1648.5 samples/s | 25.8 steps/s
[Step=6000 Epoch=57.2] | Loss=0.00493 | Reg=0.00659 | acc=1.0000 | FP-Norm=2.519 | FP-Norm(final)=2.463 | 4163.9 samples/s | 65.1 steps/s
[Step=6050 Epoch=57.7] | Loss=0.00439 | Reg=0.00628 | acc=1.0000 | FP-Norm=2.455 | FP-Norm(final)=2.467 | 1696.5 samples/s | 26.5 steps/s
[Step=6100 Epoch=58.1] | Loss=0.00396 | Reg=0.00599 | acc=1.0000 | FP-Norm=2.394 | FP-Norm(final)=2.470 | 3908.2 samples/s | 61.1 steps/s
[Step=6150 Epoch=58.6] | Loss=0.00360 | Reg=0.00573 | acc=1.0000 | FP-Norm=2.336 | FP-Norm(final)=2.473 | 1693.5 samples/s | 26.5 steps/s
[Step=6200 Epoch=59.1] | Loss=0.00331 | Reg=0.00548 | acc=1.0000 | FP-Norm=2.281 | FP-Norm(final)=2.477 | 3687.9 samples/s | 57.6 steps/s
[Step=6250 Epoch=59.6] | Loss=0.00306 | Reg=0.00526 | acc=1.0000 | FP-Norm=2.228 | FP-Norm(final)=2.479 | 1740.0 samples/s | 27.2 steps/s
[Step=6300 Epoch=60.0] | Loss=0.00284 | Reg=0.00505 | acc=1.0000 | FP-Norm=2.177 | FP-Norm(final)=2.482 | 3672.3 samples/s | 57.4 steps/s
[Step=6350 Epoch=60.5] | Loss=0.00265 | Reg=0.00485 | acc=1.0000 | FP-Norm=2.129 | FP-Norm(final)=2.485 | 1775.5 samples/s | 27.7 steps/s
[Step=6400 Epoch=61.0] | Loss=0.00249 | Reg=0.00467 | acc=1.0000 | FP-Norm=2.082 | FP-Norm(final)=2.488 | 3763.4 samples/s | 58.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23506 | acc=0.8204 | tpr=0.7502 | fpr=0.0273 | 3710.3 samples/s | 14.5 steps/s
Avg test loss: 0.23345, Avg test acc: 0.82338, Avg tpr: 0.75538, Avg fpr: 0.02705, total FA: 211

Testing server on iccad2012
[Step=  50] | Loss=0.46365 | acc=0.7778 | tpr=0.9558 | fpr=0.2254 | 3841.2 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.47039 | acc=0.7781 | tpr=0.9488 | fpr=0.2251 | 7075.2 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.47485 | acc=0.7771 | tpr=0.9539 | fpr=0.2262 | 7119.5 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.47432 | acc=0.7776 | tpr=0.9574 | fpr=0.2257 | 7308.4 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.47241 | acc=0.7777 | tpr=0.9555 | fpr=0.2256 | 7499.1 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.47426 | acc=0.7773 | tpr=0.9542 | fpr=0.2259 | 6896.7 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.47435 | acc=0.7773 | tpr=0.9574 | fpr=0.2259 | 7185.6 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.47445 | acc=0.7767 | tpr=0.9590 | fpr=0.2266 | 7231.3 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.47610 | acc=0.7770 | tpr=0.9596 | fpr=0.2263 | 6872.5 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.47766 | acc=0.7768 | tpr=0.9612 | fpr=0.2265 | 7105.9 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.47720 | acc=0.7770 | tpr=0.9610 | fpr=0.2264 | 13565.4 samples/s | 53.0 steps/s
Avg test loss: 0.47739, Avg test acc: 0.77697, Avg tpr: 0.96117, Avg fpr: 0.22638, total FA: 31432

server round 8/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.08706 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.513 | 3641.1 samples/s | 56.9 steps/s
[Step=6450 Epoch=31.5] | Loss=0.05462 | Reg=0.00162 | acc=0.9531 | FP-Norm=1.202 | FP-Norm(final)=2.499 | 3817.0 samples/s | 59.6 steps/s
[Step=6500 Epoch=31.7] | Loss=0.04956 | Reg=0.00216 | acc=1.0000 | FP-Norm=1.423 | FP-Norm(final)=2.488 | 3850.8 samples/s | 60.2 steps/s
[Step=6550 Epoch=31.9] | Loss=0.04944 | Reg=0.00258 | acc=0.9844 | FP-Norm=1.564 | FP-Norm(final)=2.477 | 3875.2 samples/s | 60.5 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04774 | Reg=0.00289 | acc=1.0000 | FP-Norm=1.662 | FP-Norm(final)=2.468 | 5073.9 samples/s | 79.3 steps/s
[Step=6650 Epoch=32.4] | Loss=0.04323 | Reg=0.00308 | acc=0.9688 | FP-Norm=1.722 | FP-Norm(final)=2.465 | 1640.0 samples/s | 25.6 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03929 | Reg=0.00320 | acc=0.9844 | FP-Norm=1.760 | FP-Norm(final)=2.466 | 3954.1 samples/s | 61.8 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03733 | Reg=0.00332 | acc=1.0000 | FP-Norm=1.796 | FP-Norm(final)=2.470 | 3930.9 samples/s | 61.4 steps/s
[Step=6800 Epoch=33.2] | Loss=0.03623 | Reg=0.00345 | acc=0.9844 | FP-Norm=1.832 | FP-Norm(final)=2.471 | 4766.1 samples/s | 74.5 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03410 | Reg=0.00357 | acc=0.9844 | FP-Norm=1.864 | FP-Norm(final)=2.473 | 1719.4 samples/s | 26.9 steps/s
[Step=6900 Epoch=33.6] | Loss=0.03220 | Reg=0.00366 | acc=1.0000 | FP-Norm=1.889 | FP-Norm(final)=2.476 | 3941.7 samples/s | 61.6 steps/s
[Step=6950 Epoch=33.9] | Loss=0.03129 | Reg=0.00375 | acc=0.9844 | FP-Norm=1.913 | FP-Norm(final)=2.478 | 3956.2 samples/s | 61.8 steps/s
[Step=7000 Epoch=34.1] | Loss=0.03061 | Reg=0.00384 | acc=0.9844 | FP-Norm=1.937 | FP-Norm(final)=2.481 | 4500.5 samples/s | 70.3 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02969 | Reg=0.00394 | acc=1.0000 | FP-Norm=1.963 | FP-Norm(final)=2.482 | 1761.8 samples/s | 27.5 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02883 | Reg=0.00403 | acc=1.0000 | FP-Norm=1.986 | FP-Norm(final)=2.484 | 3845.0 samples/s | 60.1 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02876 | Reg=0.00414 | acc=1.0000 | FP-Norm=2.011 | FP-Norm(final)=2.485 | 3836.2 samples/s | 59.9 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02846 | Reg=0.00425 | acc=0.9844 | FP-Norm=2.037 | FP-Norm(final)=2.486 | 4155.3 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step7200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.13655 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.513 | 3741.9 samples/s | 58.5 steps/s
[Step=6450 Epoch=31.5] | Loss=0.05388 | Reg=0.00174 | acc=0.9688 | FP-Norm=1.256 | FP-Norm(final)=2.500 | 3782.0 samples/s | 59.1 steps/s
[Step=6500 Epoch=31.7] | Loss=0.04867 | Reg=0.00229 | acc=0.9531 | FP-Norm=1.468 | FP-Norm(final)=2.497 | 3943.4 samples/s | 61.6 steps/s
[Step=6550 Epoch=32.0] | Loss=0.04816 | Reg=0.00259 | acc=0.9531 | FP-Norm=1.576 | FP-Norm(final)=2.493 | 3967.1 samples/s | 62.0 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04526 | Reg=0.00290 | acc=0.9531 | FP-Norm=1.670 | FP-Norm(final)=2.491 | 5081.4 samples/s | 79.4 steps/s
[Step=6650 Epoch=32.4] | Loss=0.04167 | Reg=0.00314 | acc=1.0000 | FP-Norm=1.741 | FP-Norm(final)=2.491 | 1642.8 samples/s | 25.7 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03850 | Reg=0.00330 | acc=0.9844 | FP-Norm=1.788 | FP-Norm(final)=2.494 | 3863.6 samples/s | 60.4 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03653 | Reg=0.00344 | acc=0.9844 | FP-Norm=1.828 | FP-Norm(final)=2.496 | 3942.7 samples/s | 61.6 steps/s
[Step=6800 Epoch=33.2] | Loss=0.03622 | Reg=0.00360 | acc=0.9844 | FP-Norm=1.871 | FP-Norm(final)=2.498 | 4827.7 samples/s | 75.4 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03388 | Reg=0.00376 | acc=1.0000 | FP-Norm=1.913 | FP-Norm(final)=2.500 | 1722.0 samples/s | 26.9 steps/s
[Step=6900 Epoch=33.7] | Loss=0.03258 | Reg=0.00389 | acc=1.0000 | FP-Norm=1.946 | FP-Norm(final)=2.504 | 3865.6 samples/s | 60.4 steps/s
[Step=6950 Epoch=33.9] | Loss=0.03170 | Reg=0.00399 | acc=0.9531 | FP-Norm=1.972 | FP-Norm(final)=2.506 | 3942.6 samples/s | 61.6 steps/s
[Step=7000 Epoch=34.2] | Loss=0.03073 | Reg=0.00408 | acc=1.0000 | FP-Norm=1.995 | FP-Norm(final)=2.508 | 4571.7 samples/s | 71.4 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02933 | Reg=0.00416 | acc=1.0000 | FP-Norm=2.015 | FP-Norm(final)=2.509 | 1739.9 samples/s | 27.2 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02822 | Reg=0.00422 | acc=1.0000 | FP-Norm=2.031 | FP-Norm(final)=2.512 | 3892.1 samples/s | 60.8 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02745 | Reg=0.00428 | acc=0.9844 | FP-Norm=2.047 | FP-Norm(final)=2.514 | 3950.1 samples/s | 61.7 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02664 | Reg=0.00434 | acc=1.0000 | FP-Norm=2.062 | FP-Norm(final)=2.516 | 4402.5 samples/s | 68.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step7200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.20781 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.512 | 3995.6 samples/s | 62.4 steps/s
[Step=6450 Epoch=31.4] | Loss=0.05804 | Reg=0.00193 | acc=0.9219 | FP-Norm=1.328 | FP-Norm(final)=2.489 | 3598.7 samples/s | 56.2 steps/s
[Step=6500 Epoch=31.7] | Loss=0.04970 | Reg=0.00234 | acc=0.9688 | FP-Norm=1.493 | FP-Norm(final)=2.486 | 3989.1 samples/s | 62.3 steps/s
[Step=6550 Epoch=31.9] | Loss=0.04764 | Reg=0.00266 | acc=0.9844 | FP-Norm=1.600 | FP-Norm(final)=2.484 | 3947.6 samples/s | 61.7 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04659 | Reg=0.00294 | acc=1.0000 | FP-Norm=1.687 | FP-Norm(final)=2.481 | 5061.9 samples/s | 79.1 steps/s
[Step=6650 Epoch=32.4] | Loss=0.04093 | Reg=0.00315 | acc=0.9844 | FP-Norm=1.750 | FP-Norm(final)=2.482 | 1679.8 samples/s | 26.2 steps/s
[Step=6700 Epoch=32.6] | Loss=0.03858 | Reg=0.00330 | acc=1.0000 | FP-Norm=1.792 | FP-Norm(final)=2.483 | 3948.5 samples/s | 61.7 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03779 | Reg=0.00343 | acc=0.9688 | FP-Norm=1.831 | FP-Norm(final)=2.484 | 3939.4 samples/s | 61.6 steps/s
[Step=6800 Epoch=33.1] | Loss=0.03686 | Reg=0.00360 | acc=0.9688 | FP-Norm=1.875 | FP-Norm(final)=2.483 | 4704.2 samples/s | 73.5 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03519 | Reg=0.00375 | acc=0.9531 | FP-Norm=1.913 | FP-Norm(final)=2.482 | 1678.6 samples/s | 26.2 steps/s
[Step=6900 Epoch=33.6] | Loss=0.03390 | Reg=0.00386 | acc=0.9844 | FP-Norm=1.942 | FP-Norm(final)=2.483 | 3829.0 samples/s | 59.8 steps/s
[Step=6950 Epoch=33.9] | Loss=0.03274 | Reg=0.00398 | acc=1.0000 | FP-Norm=1.972 | FP-Norm(final)=2.483 | 3836.1 samples/s | 59.9 steps/s
[Step=7000 Epoch=34.1] | Loss=0.03169 | Reg=0.00408 | acc=1.0000 | FP-Norm=1.998 | FP-Norm(final)=2.484 | 4376.2 samples/s | 68.4 steps/s
[Step=7050 Epoch=34.4] | Loss=0.03069 | Reg=0.00417 | acc=1.0000 | FP-Norm=2.021 | FP-Norm(final)=2.485 | 1731.5 samples/s | 27.1 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02971 | Reg=0.00425 | acc=0.9844 | FP-Norm=2.041 | FP-Norm(final)=2.487 | 3855.1 samples/s | 60.2 steps/s
[Step=7150 Epoch=34.8] | Loss=0.02878 | Reg=0.00432 | acc=0.9844 | FP-Norm=2.059 | FP-Norm(final)=2.489 | 3857.2 samples/s | 60.3 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02831 | Reg=0.00440 | acc=1.0000 | FP-Norm=2.076 | FP-Norm(final)=2.491 | 4159.6 samples/s | 65.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step7200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.08554 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.513 | 3635.7 samples/s | 56.8 steps/s
[Step=6450 Epoch=31.5] | Loss=0.04843 | Reg=0.00222 | acc=0.9688 | FP-Norm=1.425 | FP-Norm(final)=2.508 | 3930.3 samples/s | 61.4 steps/s
[Step=6500 Epoch=31.7] | Loss=0.04478 | Reg=0.00258 | acc=0.9844 | FP-Norm=1.570 | FP-Norm(final)=2.502 | 3829.8 samples/s | 59.8 steps/s
[Step=6550 Epoch=31.9] | Loss=0.04331 | Reg=0.00274 | acc=0.9688 | FP-Norm=1.630 | FP-Norm(final)=2.498 | 3861.8 samples/s | 60.3 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04283 | Reg=0.00297 | acc=1.0000 | FP-Norm=1.701 | FP-Norm(final)=2.490 | 4991.7 samples/s | 78.0 steps/s
[Step=6650 Epoch=32.4] | Loss=0.03829 | Reg=0.00314 | acc=1.0000 | FP-Norm=1.752 | FP-Norm(final)=2.488 | 1656.9 samples/s | 25.9 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03553 | Reg=0.00325 | acc=0.9844 | FP-Norm=1.783 | FP-Norm(final)=2.490 | 3824.7 samples/s | 59.8 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03385 | Reg=0.00336 | acc=0.9688 | FP-Norm=1.815 | FP-Norm(final)=2.492 | 3844.1 samples/s | 60.1 steps/s
[Step=6800 Epoch=33.2] | Loss=0.03313 | Reg=0.00346 | acc=0.9688 | FP-Norm=1.844 | FP-Norm(final)=2.493 | 4634.3 samples/s | 72.4 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03128 | Reg=0.00357 | acc=1.0000 | FP-Norm=1.873 | FP-Norm(final)=2.493 | 1730.3 samples/s | 27.0 steps/s
[Step=6900 Epoch=33.6] | Loss=0.02982 | Reg=0.00366 | acc=1.0000 | FP-Norm=1.897 | FP-Norm(final)=2.496 | 3914.8 samples/s | 61.2 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02889 | Reg=0.00375 | acc=1.0000 | FP-Norm=1.920 | FP-Norm(final)=2.498 | 3862.9 samples/s | 60.4 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02863 | Reg=0.00386 | acc=0.9844 | FP-Norm=1.949 | FP-Norm(final)=2.500 | 4363.4 samples/s | 68.2 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02845 | Reg=0.00400 | acc=0.9688 | FP-Norm=1.982 | FP-Norm(final)=2.501 | 1756.5 samples/s | 27.4 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02777 | Reg=0.00413 | acc=0.9844 | FP-Norm=2.013 | FP-Norm(final)=2.501 | 3973.1 samples/s | 62.1 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02722 | Reg=0.00424 | acc=1.0000 | FP-Norm=2.039 | FP-Norm(final)=2.502 | 3941.1 samples/s | 61.6 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02682 | Reg=0.00436 | acc=0.9844 | FP-Norm=2.066 | FP-Norm(final)=2.502 | 4228.0 samples/s | 66.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step7200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.4] | Loss=0.04694 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.513 | 3739.8 samples/s | 58.4 steps/s
[Step=6450 Epoch=31.6] | Loss=0.04569 | Reg=0.00167 | acc=0.9531 | FP-Norm=1.231 | FP-Norm(final)=2.509 | 3740.4 samples/s | 58.4 steps/s
[Step=6500 Epoch=31.9] | Loss=0.04776 | Reg=0.00228 | acc=0.9375 | FP-Norm=1.463 | FP-Norm(final)=2.498 | 3836.8 samples/s | 60.0 steps/s
[Step=6550 Epoch=32.1] | Loss=0.04523 | Reg=0.00265 | acc=0.9844 | FP-Norm=1.590 | FP-Norm(final)=2.490 | 3848.9 samples/s | 60.1 steps/s
[Step=6600 Epoch=32.4] | Loss=0.04357 | Reg=0.00290 | acc=1.0000 | FP-Norm=1.669 | FP-Norm(final)=2.486 | 5012.3 samples/s | 78.3 steps/s
[Step=6650 Epoch=32.6] | Loss=0.03968 | Reg=0.00311 | acc=0.9688 | FP-Norm=1.733 | FP-Norm(final)=2.483 | 1671.3 samples/s | 26.1 steps/s
[Step=6700 Epoch=32.9] | Loss=0.03800 | Reg=0.00328 | acc=0.9688 | FP-Norm=1.783 | FP-Norm(final)=2.483 | 3908.1 samples/s | 61.1 steps/s
[Step=6750 Epoch=33.1] | Loss=0.03673 | Reg=0.00345 | acc=0.9688 | FP-Norm=1.831 | FP-Norm(final)=2.482 | 3953.5 samples/s | 61.8 steps/s
[Step=6800 Epoch=33.3] | Loss=0.03537 | Reg=0.00362 | acc=0.9688 | FP-Norm=1.876 | FP-Norm(final)=2.482 | 4882.8 samples/s | 76.3 steps/s
[Step=6850 Epoch=33.6] | Loss=0.03381 | Reg=0.00378 | acc=0.9688 | FP-Norm=1.917 | FP-Norm(final)=2.482 | 1700.8 samples/s | 26.6 steps/s
[Step=6900 Epoch=33.8] | Loss=0.03190 | Reg=0.00390 | acc=1.0000 | FP-Norm=1.948 | FP-Norm(final)=2.484 | 3832.2 samples/s | 59.9 steps/s
[Step=6950 Epoch=34.1] | Loss=0.03087 | Reg=0.00401 | acc=1.0000 | FP-Norm=1.977 | FP-Norm(final)=2.486 | 3780.9 samples/s | 59.1 steps/s
[Step=7000 Epoch=34.3] | Loss=0.02985 | Reg=0.00410 | acc=1.0000 | FP-Norm=2.001 | FP-Norm(final)=2.489 | 4571.4 samples/s | 71.4 steps/s
[Step=7050 Epoch=34.6] | Loss=0.02872 | Reg=0.00419 | acc=0.9844 | FP-Norm=2.023 | FP-Norm(final)=2.491 | 1723.8 samples/s | 26.9 steps/s
[Step=7100 Epoch=34.8] | Loss=0.02801 | Reg=0.00428 | acc=1.0000 | FP-Norm=2.045 | FP-Norm(final)=2.493 | 3940.0 samples/s | 61.6 steps/s
[Step=7150 Epoch=35.1] | Loss=0.02752 | Reg=0.00436 | acc=0.9844 | FP-Norm=2.066 | FP-Norm(final)=2.495 | 3967.1 samples/s | 62.0 steps/s
[Step=7200 Epoch=35.3] | Loss=0.02739 | Reg=0.00445 | acc=1.0000 | FP-Norm=2.087 | FP-Norm(final)=2.495 | 4559.9 samples/s | 71.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step7200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=60.7] | Loss=0.08548 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.512 | 3844.6 samples/s | 60.1 steps/s
[Step=6450 Epoch=61.1] | Loss=0.04128 | Reg=0.00666 | acc=1.0000 | FP-Norm=2.389 | FP-Norm(final)=2.451 | 3476.2 samples/s | 54.3 steps/s
[Step=6500 Epoch=61.6] | Loss=0.02439 | Reg=0.00852 | acc=0.9844 | FP-Norm=2.805 | FP-Norm(final)=2.432 | 4826.7 samples/s | 75.4 steps/s
[Step=6550 Epoch=62.1] | Loss=0.01684 | Reg=0.00872 | acc=1.0000 | FP-Norm=2.876 | FP-Norm(final)=2.428 | 1597.0 samples/s | 25.0 steps/s
[Step=6600 Epoch=62.5] | Loss=0.01285 | Reg=0.00846 | acc=1.0000 | FP-Norm=2.850 | FP-Norm(final)=2.431 | 4541.5 samples/s | 71.0 steps/s
[Step=6650 Epoch=63.0] | Loss=0.01036 | Reg=0.00814 | acc=1.0000 | FP-Norm=2.803 | FP-Norm(final)=2.435 | 1648.6 samples/s | 25.8 steps/s
[Step=6700 Epoch=63.5] | Loss=0.00865 | Reg=0.00779 | acc=1.0000 | FP-Norm=2.745 | FP-Norm(final)=2.440 | 4273.9 samples/s | 66.8 steps/s
[Step=6750 Epoch=64.0] | Loss=0.00742 | Reg=0.00744 | acc=1.0000 | FP-Norm=2.683 | FP-Norm(final)=2.444 | 1652.6 samples/s | 25.8 steps/s
[Step=6800 Epoch=64.4] | Loss=0.00650 | Reg=0.00711 | acc=1.0000 | FP-Norm=2.623 | FP-Norm(final)=2.448 | 3891.0 samples/s | 60.8 steps/s
[Step=6850 Epoch=64.9] | Loss=0.00579 | Reg=0.00681 | acc=1.0000 | FP-Norm=2.563 | FP-Norm(final)=2.452 | 1722.0 samples/s | 26.9 steps/s
[Step=6900 Epoch=65.4] | Loss=0.00522 | Reg=0.00653 | acc=1.0000 | FP-Norm=2.507 | FP-Norm(final)=2.456 | 3740.9 samples/s | 58.5 steps/s
[Step=6950 Epoch=65.9] | Loss=0.00475 | Reg=0.00626 | acc=1.0000 | FP-Norm=2.452 | FP-Norm(final)=2.459 | 1763.2 samples/s | 27.5 steps/s
[Step=7000 Epoch=66.3] | Loss=0.00436 | Reg=0.00602 | acc=1.0000 | FP-Norm=2.400 | FP-Norm(final)=2.462 | 3777.2 samples/s | 59.0 steps/s
[Step=7050 Epoch=66.8] | Loss=0.00403 | Reg=0.00579 | acc=1.0000 | FP-Norm=2.350 | FP-Norm(final)=2.466 | 1776.5 samples/s | 27.8 steps/s
[Step=7100 Epoch=67.3] | Loss=0.00375 | Reg=0.00558 | acc=1.0000 | FP-Norm=2.301 | FP-Norm(final)=2.469 | 3692.7 samples/s | 57.7 steps/s
[Step=7150 Epoch=67.8] | Loss=0.00350 | Reg=0.00538 | acc=1.0000 | FP-Norm=2.255 | FP-Norm(final)=2.471 | 1774.0 samples/s | 27.7 steps/s
[Step=7200 Epoch=68.2] | Loss=0.00328 | Reg=0.00519 | acc=1.0000 | FP-Norm=2.210 | FP-Norm(final)=2.474 | 3691.5 samples/s | 57.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step7200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=60.9] | Loss=0.06587 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.512 | 3769.6 samples/s | 58.9 steps/s
[Step=6450 Epoch=61.4] | Loss=0.01580 | Reg=0.00535 | acc=1.0000 | FP-Norm=2.189 | FP-Norm(final)=2.485 | 3496.5 samples/s | 54.6 steps/s
[Step=6500 Epoch=61.8] | Loss=0.01266 | Reg=0.00681 | acc=1.0000 | FP-Norm=2.532 | FP-Norm(final)=2.463 | 4779.7 samples/s | 74.7 steps/s
[Step=6550 Epoch=62.3] | Loss=0.00905 | Reg=0.00731 | acc=1.0000 | FP-Norm=2.649 | FP-Norm(final)=2.451 | 1602.6 samples/s | 25.0 steps/s
[Step=6600 Epoch=62.8] | Loss=0.00686 | Reg=0.00725 | acc=1.0000 | FP-Norm=2.651 | FP-Norm(final)=2.450 | 4556.1 samples/s | 71.2 steps/s
[Step=6650 Epoch=63.3] | Loss=0.00550 | Reg=0.00702 | acc=1.0000 | FP-Norm=2.614 | FP-Norm(final)=2.451 | 1637.4 samples/s | 25.6 steps/s
[Step=6700 Epoch=63.7] | Loss=0.00459 | Reg=0.00674 | acc=1.0000 | FP-Norm=2.564 | FP-Norm(final)=2.454 | 4163.9 samples/s | 65.1 steps/s
[Step=6750 Epoch=64.2] | Loss=0.00394 | Reg=0.00646 | acc=1.0000 | FP-Norm=2.510 | FP-Norm(final)=2.457 | 1712.8 samples/s | 26.8 steps/s
[Step=6800 Epoch=64.7] | Loss=0.00345 | Reg=0.00619 | acc=1.0000 | FP-Norm=2.455 | FP-Norm(final)=2.460 | 3936.9 samples/s | 61.5 steps/s
[Step=6850 Epoch=65.2] | Loss=0.00307 | Reg=0.00593 | acc=1.0000 | FP-Norm=2.400 | FP-Norm(final)=2.463 | 1716.8 samples/s | 26.8 steps/s
[Step=6900 Epoch=65.6] | Loss=0.00277 | Reg=0.00569 | acc=1.0000 | FP-Norm=2.347 | FP-Norm(final)=2.466 | 3750.7 samples/s | 58.6 steps/s
[Step=6950 Epoch=66.1] | Loss=0.00252 | Reg=0.00546 | acc=1.0000 | FP-Norm=2.296 | FP-Norm(final)=2.469 | 1716.0 samples/s | 26.8 steps/s
[Step=7000 Epoch=66.6] | Loss=0.00232 | Reg=0.00524 | acc=1.0000 | FP-Norm=2.246 | FP-Norm(final)=2.472 | 3677.2 samples/s | 57.5 steps/s
[Step=7050 Epoch=67.1] | Loss=0.00214 | Reg=0.00504 | acc=1.0000 | FP-Norm=2.199 | FP-Norm(final)=2.475 | 1788.6 samples/s | 27.9 steps/s
[Step=7100 Epoch=67.5] | Loss=0.00199 | Reg=0.00486 | acc=1.0000 | FP-Norm=2.152 | FP-Norm(final)=2.478 | 3726.9 samples/s | 58.2 steps/s
[Step=7150 Epoch=68.0] | Loss=0.00186 | Reg=0.00468 | acc=1.0000 | FP-Norm=2.108 | FP-Norm(final)=2.480 | 1778.5 samples/s | 27.8 steps/s
[Step=7200 Epoch=68.5] | Loss=0.00175 | Reg=0.00451 | acc=1.0000 | FP-Norm=2.065 | FP-Norm(final)=2.483 | 3615.4 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step7200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=61.1] | Loss=0.12362 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.511 | 3650.5 samples/s | 57.0 steps/s
[Step=6450 Epoch=61.6] | Loss=0.02012 | Reg=0.00576 | acc=1.0000 | FP-Norm=2.265 | FP-Norm(final)=2.475 | 3528.9 samples/s | 55.1 steps/s
[Step=6500 Epoch=62.1] | Loss=0.01589 | Reg=0.00751 | acc=1.0000 | FP-Norm=2.653 | FP-Norm(final)=2.455 | 4818.5 samples/s | 75.3 steps/s
[Step=6550 Epoch=62.5] | Loss=0.01092 | Reg=0.00808 | acc=1.0000 | FP-Norm=2.780 | FP-Norm(final)=2.443 | 1614.6 samples/s | 25.2 steps/s
[Step=6600 Epoch=63.0] | Loss=0.00825 | Reg=0.00798 | acc=1.0000 | FP-Norm=2.777 | FP-Norm(final)=2.442 | 4542.5 samples/s | 71.0 steps/s
[Step=6650 Epoch=63.5] | Loss=0.00661 | Reg=0.00770 | acc=1.0000 | FP-Norm=2.735 | FP-Norm(final)=2.444 | 1628.3 samples/s | 25.4 steps/s
[Step=6700 Epoch=64.0] | Loss=0.00552 | Reg=0.00737 | acc=1.0000 | FP-Norm=2.678 | FP-Norm(final)=2.447 | 4257.9 samples/s | 66.5 steps/s
[Step=6750 Epoch=64.5] | Loss=0.00473 | Reg=0.00704 | acc=1.0000 | FP-Norm=2.617 | FP-Norm(final)=2.450 | 1657.9 samples/s | 25.9 steps/s
[Step=6800 Epoch=64.9] | Loss=0.00415 | Reg=0.00673 | acc=1.0000 | FP-Norm=2.556 | FP-Norm(final)=2.453 | 3958.6 samples/s | 61.9 steps/s
[Step=6850 Epoch=65.4] | Loss=0.00369 | Reg=0.00643 | acc=1.0000 | FP-Norm=2.496 | FP-Norm(final)=2.456 | 1718.0 samples/s | 26.8 steps/s
[Step=6900 Epoch=65.9] | Loss=0.00332 | Reg=0.00615 | acc=1.0000 | FP-Norm=2.438 | FP-Norm(final)=2.459 | 4042.9 samples/s | 63.2 steps/s
[Step=6950 Epoch=66.4] | Loss=0.00303 | Reg=0.00590 | acc=1.0000 | FP-Norm=2.382 | FP-Norm(final)=2.461 | 1750.2 samples/s | 27.3 steps/s
[Step=7000 Epoch=66.8] | Loss=0.00278 | Reg=0.00566 | acc=1.0000 | FP-Norm=2.328 | FP-Norm(final)=2.464 | 3758.3 samples/s | 58.7 steps/s
[Step=7050 Epoch=67.3] | Loss=0.00257 | Reg=0.00543 | acc=1.0000 | FP-Norm=2.276 | FP-Norm(final)=2.467 | 1750.3 samples/s | 27.3 steps/s
[Step=7100 Epoch=67.8] | Loss=0.00239 | Reg=0.00522 | acc=1.0000 | FP-Norm=2.226 | FP-Norm(final)=2.470 | 3682.0 samples/s | 57.5 steps/s
[Step=7150 Epoch=68.3] | Loss=0.00223 | Reg=0.00502 | acc=1.0000 | FP-Norm=2.178 | FP-Norm(final)=2.472 | 1747.0 samples/s | 27.3 steps/s
[Step=7200 Epoch=68.8] | Loss=0.00209 | Reg=0.00484 | acc=1.0000 | FP-Norm=2.131 | FP-Norm(final)=2.475 | 3775.3 samples/s | 59.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step7200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=60.3] | Loss=0.14533 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.510 | 3465.2 samples/s | 54.1 steps/s
[Step=6450 Epoch=60.8] | Loss=0.02528 | Reg=0.00741 | acc=0.9688 | FP-Norm=2.580 | FP-Norm(final)=2.448 | 3597.7 samples/s | 56.2 steps/s
[Step=6500 Epoch=61.2] | Loss=0.01641 | Reg=0.00869 | acc=1.0000 | FP-Norm=2.868 | FP-Norm(final)=2.425 | 4685.8 samples/s | 73.2 steps/s
[Step=6550 Epoch=61.7] | Loss=0.01128 | Reg=0.00859 | acc=1.0000 | FP-Norm=2.877 | FP-Norm(final)=2.422 | 1596.4 samples/s | 24.9 steps/s
[Step=6600 Epoch=62.2] | Loss=0.00849 | Reg=0.00820 | acc=1.0000 | FP-Norm=2.821 | FP-Norm(final)=2.426 | 4418.8 samples/s | 69.0 steps/s
[Step=6650 Epoch=62.7] | Loss=0.00776 | Reg=0.00803 | acc=0.9844 | FP-Norm=2.798 | FP-Norm(final)=2.429 | 1625.1 samples/s | 25.4 steps/s
[Step=6700 Epoch=63.1] | Loss=0.00661 | Reg=0.00801 | acc=1.0000 | FP-Norm=2.800 | FP-Norm(final)=2.433 | 3967.8 samples/s | 62.0 steps/s
[Step=6750 Epoch=63.6] | Loss=0.00568 | Reg=0.00784 | acc=1.0000 | FP-Norm=2.773 | FP-Norm(final)=2.438 | 1665.4 samples/s | 26.0 steps/s
[Step=6800 Epoch=64.1] | Loss=0.00498 | Reg=0.00760 | acc=1.0000 | FP-Norm=2.731 | FP-Norm(final)=2.443 | 3782.1 samples/s | 59.1 steps/s
[Step=6850 Epoch=64.5] | Loss=0.00443 | Reg=0.00735 | acc=1.0000 | FP-Norm=2.683 | FP-Norm(final)=2.447 | 1729.8 samples/s | 27.0 steps/s
[Step=6900 Epoch=65.0] | Loss=0.00399 | Reg=0.00709 | acc=1.0000 | FP-Norm=2.633 | FP-Norm(final)=2.451 | 3799.1 samples/s | 59.4 steps/s
[Step=6950 Epoch=65.5] | Loss=0.00363 | Reg=0.00683 | acc=1.0000 | FP-Norm=2.582 | FP-Norm(final)=2.455 | 1755.6 samples/s | 27.4 steps/s
[Step=7000 Epoch=66.0] | Loss=0.00333 | Reg=0.00658 | acc=1.0000 | FP-Norm=2.531 | FP-Norm(final)=2.459 | 3597.0 samples/s | 56.2 steps/s
[Step=7050 Epoch=66.4] | Loss=0.00308 | Reg=0.00635 | acc=1.0000 | FP-Norm=2.480 | FP-Norm(final)=2.462 | 1777.8 samples/s | 27.8 steps/s
[Step=7100 Epoch=66.9] | Loss=0.00286 | Reg=0.00612 | acc=1.0000 | FP-Norm=2.430 | FP-Norm(final)=2.465 | 3735.7 samples/s | 58.4 steps/s
[Step=7150 Epoch=67.4] | Loss=0.00267 | Reg=0.00591 | acc=1.0000 | FP-Norm=2.382 | FP-Norm(final)=2.468 | 1817.9 samples/s | 28.4 steps/s
[Step=7200 Epoch=67.8] | Loss=0.00251 | Reg=0.00570 | acc=1.0000 | FP-Norm=2.335 | FP-Norm(final)=2.471 | 3491.2 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step7200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=61.0] | Loss=0.11806 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.511 | 3189.7 samples/s | 49.8 steps/s
[Step=6450 Epoch=61.5] | Loss=0.02181 | Reg=0.00572 | acc=1.0000 | FP-Norm=2.258 | FP-Norm(final)=2.473 | 3385.1 samples/s | 52.9 steps/s
[Step=6500 Epoch=62.0] | Loss=0.01462 | Reg=0.00735 | acc=0.9688 | FP-Norm=2.627 | FP-Norm(final)=2.455 | 4328.9 samples/s | 67.6 steps/s
[Step=6550 Epoch=62.4] | Loss=0.01044 | Reg=0.00774 | acc=1.0000 | FP-Norm=2.725 | FP-Norm(final)=2.450 | 1589.4 samples/s | 24.8 steps/s
[Step=6600 Epoch=62.9] | Loss=0.00824 | Reg=0.00772 | acc=1.0000 | FP-Norm=2.735 | FP-Norm(final)=2.449 | 4529.0 samples/s | 70.8 steps/s
[Step=6650 Epoch=63.4] | Loss=0.00663 | Reg=0.00754 | acc=1.0000 | FP-Norm=2.710 | FP-Norm(final)=2.450 | 1608.0 samples/s | 25.1 steps/s
[Step=6700 Epoch=63.9] | Loss=0.00553 | Reg=0.00728 | acc=1.0000 | FP-Norm=2.665 | FP-Norm(final)=2.453 | 4280.6 samples/s | 66.9 steps/s
[Step=6750 Epoch=64.3] | Loss=0.00474 | Reg=0.00700 | acc=1.0000 | FP-Norm=2.614 | FP-Norm(final)=2.455 | 1633.6 samples/s | 25.5 steps/s
[Step=6800 Epoch=64.8] | Loss=0.00416 | Reg=0.00671 | acc=1.0000 | FP-Norm=2.559 | FP-Norm(final)=2.458 | 4056.5 samples/s | 63.4 steps/s
[Step=6850 Epoch=65.3] | Loss=0.00370 | Reg=0.00644 | acc=1.0000 | FP-Norm=2.505 | FP-Norm(final)=2.461 | 1714.8 samples/s | 26.8 steps/s
[Step=6900 Epoch=65.8] | Loss=0.00333 | Reg=0.00618 | acc=1.0000 | FP-Norm=2.451 | FP-Norm(final)=2.463 | 3827.8 samples/s | 59.8 steps/s
[Step=6950 Epoch=66.2] | Loss=0.00303 | Reg=0.00594 | acc=1.0000 | FP-Norm=2.398 | FP-Norm(final)=2.466 | 1717.0 samples/s | 26.8 steps/s
[Step=7000 Epoch=66.7] | Loss=0.00278 | Reg=0.00571 | acc=1.0000 | FP-Norm=2.346 | FP-Norm(final)=2.469 | 3734.6 samples/s | 58.4 steps/s
[Step=7050 Epoch=67.2] | Loss=0.00257 | Reg=0.00549 | acc=1.0000 | FP-Norm=2.297 | FP-Norm(final)=2.471 | 1758.7 samples/s | 27.5 steps/s
[Step=7100 Epoch=67.7] | Loss=0.00239 | Reg=0.00529 | acc=1.0000 | FP-Norm=2.248 | FP-Norm(final)=2.473 | 3684.1 samples/s | 57.6 steps/s
[Step=7150 Epoch=68.1] | Loss=0.00223 | Reg=0.00510 | acc=1.0000 | FP-Norm=2.202 | FP-Norm(final)=2.476 | 1755.2 samples/s | 27.4 steps/s
[Step=7200 Epoch=68.6] | Loss=0.00209 | Reg=0.00491 | acc=1.0000 | FP-Norm=2.157 | FP-Norm(final)=2.478 | 3717.7 samples/s | 58.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25473 | acc=0.8084 | tpr=0.7291 | fpr=0.0193 | 3803.1 samples/s | 14.9 steps/s
Avg test loss: 0.25232, Avg test acc: 0.81228, Avg tpr: 0.73556, Avg fpr: 0.01897, total FA: 148

Testing server on iccad2012
[Step=  50] | Loss=0.43022 | acc=0.7913 | tpr=0.9469 | fpr=0.2115 | 3795.0 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.43711 | acc=0.7910 | tpr=0.9510 | fpr=0.2120 | 7042.9 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.44158 | acc=0.7900 | tpr=0.9539 | fpr=0.2130 | 7125.9 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.44185 | acc=0.7906 | tpr=0.9585 | fpr=0.2124 | 4430.2 samples/s | 17.3 steps/s
[Step= 250] | Loss=0.43930 | acc=0.7914 | tpr=0.9555 | fpr=0.2116 | 7110.3 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.44144 | acc=0.7910 | tpr=0.9549 | fpr=0.2120 | 7167.1 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.44130 | acc=0.7917 | tpr=0.9574 | fpr=0.2113 | 7265.2 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.44144 | acc=0.7911 | tpr=0.9573 | fpr=0.2120 | 7026.0 samples/s | 27.4 steps/s
[Step= 450] | Loss=0.44311 | acc=0.7915 | tpr=0.9576 | fpr=0.2115 | 6942.6 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.44447 | acc=0.7913 | tpr=0.9586 | fpr=0.2118 | 7135.5 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.44401 | acc=0.7916 | tpr=0.9578 | fpr=0.2114 | 12874.1 samples/s | 50.3 steps/s
Avg test loss: 0.44426, Avg test acc: 0.79151, Avg tpr: 0.95761, Avg fpr: 0.21151, total FA: 29368

server round 9/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.14056 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.509 | 3671.8 samples/s | 57.4 steps/s
[Step=7250 Epoch=35.4] | Loss=0.04717 | Reg=0.00169 | acc=0.9844 | FP-Norm=1.238 | FP-Norm(final)=2.499 | 3954.7 samples/s | 61.8 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04565 | Reg=0.00224 | acc=0.9688 | FP-Norm=1.453 | FP-Norm(final)=2.490 | 3924.9 samples/s | 61.3 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04529 | Reg=0.00264 | acc=0.9375 | FP-Norm=1.589 | FP-Norm(final)=2.477 | 3825.0 samples/s | 59.8 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04529 | Reg=0.00295 | acc=0.9688 | FP-Norm=1.684 | FP-Norm(final)=2.467 | 4876.1 samples/s | 76.2 steps/s
[Step=7450 Epoch=36.3] | Loss=0.04662 | Reg=0.00345 | acc=0.9531 | FP-Norm=1.813 | FP-Norm(final)=2.458 | 1661.9 samples/s | 26.0 steps/s
[Step=7500 Epoch=36.6] | Loss=0.04320 | Reg=0.00381 | acc=1.0000 | FP-Norm=1.904 | FP-Norm(final)=2.455 | 3798.1 samples/s | 59.3 steps/s
[Step=7550 Epoch=36.8] | Loss=0.04044 | Reg=0.00403 | acc=1.0000 | FP-Norm=1.964 | FP-Norm(final)=2.455 | 3833.8 samples/s | 59.9 steps/s
[Step=7600 Epoch=37.1] | Loss=0.03925 | Reg=0.00422 | acc=0.9844 | FP-Norm=2.012 | FP-Norm(final)=2.454 | 4634.5 samples/s | 72.4 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03679 | Reg=0.00436 | acc=1.0000 | FP-Norm=2.049 | FP-Norm(final)=2.454 | 1715.2 samples/s | 26.8 steps/s
[Step=7700 Epoch=37.5] | Loss=0.03453 | Reg=0.00446 | acc=0.9844 | FP-Norm=2.076 | FP-Norm(final)=2.457 | 3930.5 samples/s | 61.4 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03351 | Reg=0.00455 | acc=0.9844 | FP-Norm=2.100 | FP-Norm(final)=2.459 | 3934.8 samples/s | 61.5 steps/s
[Step=7800 Epoch=38.0] | Loss=0.03248 | Reg=0.00465 | acc=1.0000 | FP-Norm=2.123 | FP-Norm(final)=2.460 | 4447.3 samples/s | 69.5 steps/s
[Step=7850 Epoch=38.3] | Loss=0.03085 | Reg=0.00473 | acc=1.0000 | FP-Norm=2.144 | FP-Norm(final)=2.462 | 1764.4 samples/s | 27.6 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02943 | Reg=0.00478 | acc=1.0000 | FP-Norm=2.158 | FP-Norm(final)=2.465 | 3811.9 samples/s | 59.6 steps/s
[Step=7950 Epoch=38.8] | Loss=0.02896 | Reg=0.00484 | acc=0.9844 | FP-Norm=2.172 | FP-Norm(final)=2.467 | 3870.5 samples/s | 60.5 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02828 | Reg=0.00489 | acc=0.9688 | FP-Norm=2.185 | FP-Norm(final)=2.468 | 4104.7 samples/s | 64.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.13184 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.510 | 3662.0 samples/s | 57.2 steps/s
[Step=7250 Epoch=35.4] | Loss=0.05371 | Reg=0.00195 | acc=0.9375 | FP-Norm=1.333 | FP-Norm(final)=2.495 | 3873.7 samples/s | 60.5 steps/s
[Step=7300 Epoch=35.6] | Loss=0.05054 | Reg=0.00251 | acc=0.9531 | FP-Norm=1.542 | FP-Norm(final)=2.490 | 3969.3 samples/s | 62.0 steps/s
[Step=7350 Epoch=35.9] | Loss=0.04730 | Reg=0.00293 | acc=0.9531 | FP-Norm=1.676 | FP-Norm(final)=2.483 | 3920.7 samples/s | 61.3 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04619 | Reg=0.00328 | acc=0.9688 | FP-Norm=1.775 | FP-Norm(final)=2.474 | 5001.0 samples/s | 78.1 steps/s
[Step=7450 Epoch=36.4] | Loss=0.04192 | Reg=0.00351 | acc=0.9688 | FP-Norm=1.841 | FP-Norm(final)=2.472 | 1659.9 samples/s | 25.9 steps/s
[Step=7500 Epoch=36.6] | Loss=0.03829 | Reg=0.00367 | acc=0.9688 | FP-Norm=1.888 | FP-Norm(final)=2.474 | 3812.5 samples/s | 59.6 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03668 | Reg=0.00381 | acc=0.9844 | FP-Norm=1.926 | FP-Norm(final)=2.476 | 3843.7 samples/s | 60.1 steps/s
[Step=7600 Epoch=37.1] | Loss=0.03560 | Reg=0.00396 | acc=1.0000 | FP-Norm=1.965 | FP-Norm(final)=2.478 | 4694.7 samples/s | 73.4 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03431 | Reg=0.00411 | acc=0.9844 | FP-Norm=2.004 | FP-Norm(final)=2.478 | 1694.7 samples/s | 26.5 steps/s
[Step=7700 Epoch=37.6] | Loss=0.03281 | Reg=0.00423 | acc=0.9844 | FP-Norm=2.033 | FP-Norm(final)=2.479 | 3830.4 samples/s | 59.8 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03194 | Reg=0.00434 | acc=0.9688 | FP-Norm=2.061 | FP-Norm(final)=2.480 | 3839.7 samples/s | 60.0 steps/s
[Step=7800 Epoch=38.1] | Loss=0.03107 | Reg=0.00447 | acc=0.9844 | FP-Norm=2.091 | FP-Norm(final)=2.480 | 4404.3 samples/s | 68.8 steps/s
[Step=7850 Epoch=38.3] | Loss=0.02997 | Reg=0.00459 | acc=0.9844 | FP-Norm=2.119 | FP-Norm(final)=2.480 | 1735.0 samples/s | 27.1 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02863 | Reg=0.00469 | acc=1.0000 | FP-Norm=2.141 | FP-Norm(final)=2.482 | 3956.5 samples/s | 61.8 steps/s
[Step=7950 Epoch=38.8] | Loss=0.02758 | Reg=0.00477 | acc=0.9844 | FP-Norm=2.161 | FP-Norm(final)=2.484 | 3929.5 samples/s | 61.4 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02729 | Reg=0.00484 | acc=0.9688 | FP-Norm=2.178 | FP-Norm(final)=2.486 | 4337.1 samples/s | 67.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step8000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.19258 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.509 | 3766.9 samples/s | 58.9 steps/s
[Step=7250 Epoch=35.3] | Loss=0.05236 | Reg=0.00158 | acc=0.9688 | FP-Norm=1.197 | FP-Norm(final)=2.497 | 3775.0 samples/s | 59.0 steps/s
[Step=7300 Epoch=35.6] | Loss=0.05094 | Reg=0.00232 | acc=0.9062 | FP-Norm=1.472 | FP-Norm(final)=2.483 | 3853.2 samples/s | 60.2 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04877 | Reg=0.00273 | acc=0.9844 | FP-Norm=1.610 | FP-Norm(final)=2.475 | 3835.9 samples/s | 59.9 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04547 | Reg=0.00307 | acc=0.9844 | FP-Norm=1.714 | FP-Norm(final)=2.467 | 4912.3 samples/s | 76.8 steps/s
[Step=7450 Epoch=36.3] | Loss=0.04075 | Reg=0.00329 | acc=0.9688 | FP-Norm=1.779 | FP-Norm(final)=2.466 | 1646.3 samples/s | 25.7 steps/s
[Step=7500 Epoch=36.5] | Loss=0.03829 | Reg=0.00346 | acc=0.9531 | FP-Norm=1.827 | FP-Norm(final)=2.469 | 3819.9 samples/s | 59.7 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03696 | Reg=0.00364 | acc=1.0000 | FP-Norm=1.876 | FP-Norm(final)=2.471 | 3839.1 samples/s | 60.0 steps/s
[Step=7600 Epoch=37.0] | Loss=0.03514 | Reg=0.00379 | acc=1.0000 | FP-Norm=1.917 | FP-Norm(final)=2.474 | 4645.0 samples/s | 72.6 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03380 | Reg=0.00394 | acc=0.9844 | FP-Norm=1.957 | FP-Norm(final)=2.477 | 1195.7 samples/s | 18.7 steps/s
[Step=7700 Epoch=37.5] | Loss=0.03303 | Reg=0.00410 | acc=0.9844 | FP-Norm=1.996 | FP-Norm(final)=2.480 | 3690.0 samples/s | 57.7 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03232 | Reg=0.00427 | acc=0.9688 | FP-Norm=2.036 | FP-Norm(final)=2.482 | 3926.2 samples/s | 61.3 steps/s
[Step=7800 Epoch=38.0] | Loss=0.03179 | Reg=0.00444 | acc=0.9844 | FP-Norm=2.077 | FP-Norm(final)=2.484 | 4437.7 samples/s | 69.3 steps/s
[Step=7850 Epoch=38.2] | Loss=0.03091 | Reg=0.00463 | acc=1.0000 | FP-Norm=2.119 | FP-Norm(final)=2.486 | 1745.6 samples/s | 27.3 steps/s
[Step=7900 Epoch=38.5] | Loss=0.03018 | Reg=0.00481 | acc=0.9844 | FP-Norm=2.159 | FP-Norm(final)=2.489 | 3898.2 samples/s | 60.9 steps/s
[Step=7950 Epoch=38.7] | Loss=0.02934 | Reg=0.00497 | acc=1.0000 | FP-Norm=2.193 | FP-Norm(final)=2.491 | 3804.7 samples/s | 59.4 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02898 | Reg=0.00512 | acc=1.0000 | FP-Norm=2.225 | FP-Norm(final)=2.494 | 4154.1 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.10565 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.510 | 4035.0 samples/s | 63.0 steps/s
[Step=7250 Epoch=35.4] | Loss=0.05140 | Reg=0.00166 | acc=0.9531 | FP-Norm=1.231 | FP-Norm(final)=2.498 | 3587.2 samples/s | 56.1 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04373 | Reg=0.00209 | acc=0.9219 | FP-Norm=1.411 | FP-Norm(final)=2.499 | 3822.6 samples/s | 59.7 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04211 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.516 | FP-Norm(final)=2.497 | 3838.1 samples/s | 60.0 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04026 | Reg=0.00263 | acc=0.9531 | FP-Norm=1.596 | FP-Norm(final)=2.495 | 4939.0 samples/s | 77.2 steps/s
[Step=7450 Epoch=36.3] | Loss=0.03705 | Reg=0.00285 | acc=0.9844 | FP-Norm=1.661 | FP-Norm(final)=2.495 | 1683.2 samples/s | 26.3 steps/s
[Step=7500 Epoch=36.6] | Loss=0.03422 | Reg=0.00301 | acc=0.9844 | FP-Norm=1.710 | FP-Norm(final)=2.497 | 3874.0 samples/s | 60.5 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03208 | Reg=0.00314 | acc=1.0000 | FP-Norm=1.748 | FP-Norm(final)=2.499 | 3851.7 samples/s | 60.2 steps/s
[Step=7600 Epoch=37.1] | Loss=0.03123 | Reg=0.00327 | acc=0.9531 | FP-Norm=1.785 | FP-Norm(final)=2.502 | 4809.4 samples/s | 75.1 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03073 | Reg=0.00346 | acc=0.9688 | FP-Norm=1.835 | FP-Norm(final)=2.502 | 1737.3 samples/s | 27.1 steps/s
[Step=7700 Epoch=37.5] | Loss=0.02957 | Reg=0.00365 | acc=1.0000 | FP-Norm=1.882 | FP-Norm(final)=2.503 | 3961.5 samples/s | 61.9 steps/s
[Step=7750 Epoch=37.8] | Loss=0.02908 | Reg=0.00383 | acc=1.0000 | FP-Norm=1.926 | FP-Norm(final)=2.504 | 3903.8 samples/s | 61.0 steps/s
[Step=7800 Epoch=38.0] | Loss=0.02887 | Reg=0.00399 | acc=1.0000 | FP-Norm=1.966 | FP-Norm(final)=2.503 | 4507.1 samples/s | 70.4 steps/s
[Step=7850 Epoch=38.3] | Loss=0.02810 | Reg=0.00414 | acc=1.0000 | FP-Norm=2.002 | FP-Norm(final)=2.503 | 1766.0 samples/s | 27.6 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02752 | Reg=0.00428 | acc=0.9844 | FP-Norm=2.035 | FP-Norm(final)=2.503 | 3889.2 samples/s | 60.8 steps/s
[Step=7950 Epoch=38.8] | Loss=0.02700 | Reg=0.00441 | acc=0.9844 | FP-Norm=2.067 | FP-Norm(final)=2.503 | 3847.1 samples/s | 60.1 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02634 | Reg=0.00453 | acc=0.9844 | FP-Norm=2.095 | FP-Norm(final)=2.504 | 4130.5 samples/s | 64.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step8000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.3] | Loss=0.07098 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.510 | 3785.1 samples/s | 59.1 steps/s
[Step=7250 Epoch=35.6] | Loss=0.03967 | Reg=0.00134 | acc=0.9688 | FP-Norm=1.098 | FP-Norm(final)=2.513 | 3857.4 samples/s | 60.3 steps/s
[Step=7300 Epoch=35.8] | Loss=0.04414 | Reg=0.00207 | acc=0.9062 | FP-Norm=1.384 | FP-Norm(final)=2.504 | 3904.7 samples/s | 61.0 steps/s
[Step=7350 Epoch=36.0] | Loss=0.04337 | Reg=0.00249 | acc=0.9688 | FP-Norm=1.532 | FP-Norm(final)=2.497 | 3848.2 samples/s | 60.1 steps/s
[Step=7400 Epoch=36.3] | Loss=0.04346 | Reg=0.00285 | acc=0.9531 | FP-Norm=1.645 | FP-Norm(final)=2.488 | 4999.9 samples/s | 78.1 steps/s
[Step=7450 Epoch=36.5] | Loss=0.04034 | Reg=0.00317 | acc=0.9688 | FP-Norm=1.737 | FP-Norm(final)=2.482 | 1666.0 samples/s | 26.0 steps/s
[Step=7500 Epoch=36.8] | Loss=0.03743 | Reg=0.00340 | acc=1.0000 | FP-Norm=1.803 | FP-Norm(final)=2.481 | 3827.2 samples/s | 59.8 steps/s
[Step=7550 Epoch=37.0] | Loss=0.03532 | Reg=0.00359 | acc=1.0000 | FP-Norm=1.856 | FP-Norm(final)=2.481 | 3846.5 samples/s | 60.1 steps/s
[Step=7600 Epoch=37.3] | Loss=0.03383 | Reg=0.00375 | acc=0.9688 | FP-Norm=1.901 | FP-Norm(final)=2.483 | 4784.2 samples/s | 74.8 steps/s
[Step=7650 Epoch=37.5] | Loss=0.03246 | Reg=0.00394 | acc=1.0000 | FP-Norm=1.948 | FP-Norm(final)=2.483 | 1654.5 samples/s | 25.9 steps/s
[Step=7700 Epoch=37.8] | Loss=0.03110 | Reg=0.00407 | acc=0.9688 | FP-Norm=1.983 | FP-Norm(final)=2.485 | 3871.7 samples/s | 60.5 steps/s
[Step=7750 Epoch=38.0] | Loss=0.03048 | Reg=0.00419 | acc=0.9688 | FP-Norm=2.013 | FP-Norm(final)=2.485 | 3859.2 samples/s | 60.3 steps/s
[Step=7800 Epoch=38.2] | Loss=0.02983 | Reg=0.00432 | acc=0.9688 | FP-Norm=2.046 | FP-Norm(final)=2.484 | 4562.1 samples/s | 71.3 steps/s
[Step=7850 Epoch=38.5] | Loss=0.02857 | Reg=0.00443 | acc=1.0000 | FP-Norm=2.072 | FP-Norm(final)=2.484 | 1705.1 samples/s | 26.6 steps/s
[Step=7900 Epoch=38.7] | Loss=0.02771 | Reg=0.00453 | acc=0.9844 | FP-Norm=2.096 | FP-Norm(final)=2.485 | 3853.5 samples/s | 60.2 steps/s
[Step=7950 Epoch=39.0] | Loss=0.02760 | Reg=0.00464 | acc=0.9844 | FP-Norm=2.123 | FP-Norm(final)=2.486 | 3841.0 samples/s | 60.0 steps/s
[Step=8000 Epoch=39.2] | Loss=0.02741 | Reg=0.00477 | acc=1.0000 | FP-Norm=2.152 | FP-Norm(final)=2.486 | 4459.7 samples/s | 69.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step8000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.2] | Loss=0.12770 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.508 | 4022.7 samples/s | 62.9 steps/s
[Step=7250 Epoch=68.7] | Loss=0.01636 | Reg=0.00447 | acc=1.0000 | FP-Norm=2.010 | FP-Norm(final)=2.483 | 3539.7 samples/s | 55.3 steps/s
[Step=7300 Epoch=69.2] | Loss=0.00931 | Reg=0.00510 | acc=1.0000 | FP-Norm=2.201 | FP-Norm(final)=2.479 | 4843.9 samples/s | 75.7 steps/s
[Step=7350 Epoch=69.6] | Loss=0.00632 | Reg=0.00497 | acc=1.0000 | FP-Norm=2.191 | FP-Norm(final)=2.484 | 1597.1 samples/s | 25.0 steps/s
[Step=7400 Epoch=70.1] | Loss=0.00482 | Reg=0.00473 | acc=1.0000 | FP-Norm=2.144 | FP-Norm(final)=2.489 | 4447.2 samples/s | 69.5 steps/s
[Step=7450 Epoch=70.6] | Loss=0.00387 | Reg=0.00449 | acc=1.0000 | FP-Norm=2.090 | FP-Norm(final)=2.494 | 1611.6 samples/s | 25.2 steps/s
[Step=7500 Epoch=71.1] | Loss=0.00323 | Reg=0.00426 | acc=1.0000 | FP-Norm=2.035 | FP-Norm(final)=2.497 | 4159.2 samples/s | 65.0 steps/s
[Step=7550 Epoch=71.5] | Loss=0.00278 | Reg=0.00404 | acc=1.0000 | FP-Norm=1.980 | FP-Norm(final)=2.500 | 1681.7 samples/s | 26.3 steps/s
[Step=7600 Epoch=72.0] | Loss=0.00244 | Reg=0.00384 | acc=1.0000 | FP-Norm=1.928 | FP-Norm(final)=2.503 | 3963.2 samples/s | 61.9 steps/s
[Step=7650 Epoch=72.5] | Loss=0.00217 | Reg=0.00366 | acc=1.0000 | FP-Norm=1.879 | FP-Norm(final)=2.505 | 1715.0 samples/s | 26.8 steps/s
[Step=7700 Epoch=73.0] | Loss=0.00196 | Reg=0.00349 | acc=1.0000 | FP-Norm=1.832 | FP-Norm(final)=2.507 | 3697.2 samples/s | 57.8 steps/s
[Step=7750 Epoch=73.4] | Loss=0.00178 | Reg=0.00334 | acc=1.0000 | FP-Norm=1.787 | FP-Norm(final)=2.509 | 1780.9 samples/s | 27.8 steps/s
[Step=7800 Epoch=73.9] | Loss=0.00164 | Reg=0.00319 | acc=1.0000 | FP-Norm=1.745 | FP-Norm(final)=2.511 | 3704.3 samples/s | 57.9 steps/s
[Step=7850 Epoch=74.4] | Loss=0.00151 | Reg=0.00306 | acc=1.0000 | FP-Norm=1.704 | FP-Norm(final)=2.513 | 1784.4 samples/s | 27.9 steps/s
[Step=7900 Epoch=74.9] | Loss=0.00141 | Reg=0.00294 | acc=1.0000 | FP-Norm=1.666 | FP-Norm(final)=2.514 | 3803.2 samples/s | 59.4 steps/s
[Step=7950 Epoch=75.3] | Loss=0.00132 | Reg=0.00283 | acc=1.0000 | FP-Norm=1.629 | FP-Norm(final)=2.516 | 1785.2 samples/s | 27.9 steps/s
[Step=8000 Epoch=75.8] | Loss=0.00124 | Reg=0.00272 | acc=1.0000 | FP-Norm=1.593 | FP-Norm(final)=2.517 | 3627.8 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step8000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.5] | Loss=0.02039 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.510 | 3822.4 samples/s | 59.7 steps/s
[Step=7250 Epoch=69.0] | Loss=0.01572 | Reg=0.00459 | acc=0.9688 | FP-Norm=2.035 | FP-Norm(final)=2.485 | 3300.8 samples/s | 51.6 steps/s
[Step=7300 Epoch=69.4] | Loss=0.01136 | Reg=0.00595 | acc=1.0000 | FP-Norm=2.369 | FP-Norm(final)=2.475 | 4907.3 samples/s | 76.7 steps/s
[Step=7350 Epoch=69.9] | Loss=0.00785 | Reg=0.00616 | acc=1.0000 | FP-Norm=2.433 | FP-Norm(final)=2.476 | 1623.5 samples/s | 25.4 steps/s
[Step=7400 Epoch=70.4] | Loss=0.00592 | Reg=0.00599 | acc=1.0000 | FP-Norm=2.411 | FP-Norm(final)=2.481 | 4469.5 samples/s | 69.8 steps/s
[Step=7450 Epoch=70.9] | Loss=0.00475 | Reg=0.00574 | acc=1.0000 | FP-Norm=2.364 | FP-Norm(final)=2.485 | 1670.9 samples/s | 26.1 steps/s
[Step=7500 Epoch=71.3] | Loss=0.00396 | Reg=0.00547 | acc=1.0000 | FP-Norm=2.308 | FP-Norm(final)=2.489 | 4285.8 samples/s | 67.0 steps/s
[Step=7550 Epoch=71.8] | Loss=0.00340 | Reg=0.00521 | acc=1.0000 | FP-Norm=2.251 | FP-Norm(final)=2.492 | 1700.9 samples/s | 26.6 steps/s
[Step=7600 Epoch=72.3] | Loss=0.00298 | Reg=0.00496 | acc=1.0000 | FP-Norm=2.195 | FP-Norm(final)=2.495 | 4078.1 samples/s | 63.7 steps/s
[Step=7650 Epoch=72.8] | Loss=0.00265 | Reg=0.00473 | acc=1.0000 | FP-Norm=2.140 | FP-Norm(final)=2.497 | 1707.5 samples/s | 26.7 steps/s
[Step=7700 Epoch=73.2] | Loss=0.00239 | Reg=0.00452 | acc=1.0000 | FP-Norm=2.087 | FP-Norm(final)=2.499 | 3787.9 samples/s | 59.2 steps/s
[Step=7750 Epoch=73.7] | Loss=0.00218 | Reg=0.00432 | acc=1.0000 | FP-Norm=2.037 | FP-Norm(final)=2.501 | 1790.1 samples/s | 28.0 steps/s
[Step=7800 Epoch=74.2] | Loss=0.00200 | Reg=0.00414 | acc=1.0000 | FP-Norm=1.988 | FP-Norm(final)=2.503 | 3707.9 samples/s | 57.9 steps/s
[Step=7850 Epoch=74.7] | Loss=0.00185 | Reg=0.00397 | acc=1.0000 | FP-Norm=1.942 | FP-Norm(final)=2.505 | 1792.4 samples/s | 28.0 steps/s
[Step=7900 Epoch=75.1] | Loss=0.00172 | Reg=0.00381 | acc=1.0000 | FP-Norm=1.897 | FP-Norm(final)=2.507 | 3724.4 samples/s | 58.2 steps/s
[Step=7950 Epoch=75.6] | Loss=0.00160 | Reg=0.00366 | acc=1.0000 | FP-Norm=1.854 | FP-Norm(final)=2.508 | 1764.8 samples/s | 27.6 steps/s
[Step=8000 Epoch=76.1] | Loss=0.00151 | Reg=0.00352 | acc=1.0000 | FP-Norm=1.813 | FP-Norm(final)=2.510 | 3560.2 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step8000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.8] | Loss=0.17354 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.507 | 3381.0 samples/s | 52.8 steps/s
[Step=7250 Epoch=69.2] | Loss=0.02194 | Reg=0.00658 | acc=1.0000 | FP-Norm=2.439 | FP-Norm(final)=2.478 | 3473.2 samples/s | 54.3 steps/s
[Step=7300 Epoch=69.7] | Loss=0.01768 | Reg=0.00884 | acc=1.0000 | FP-Norm=2.885 | FP-Norm(final)=2.436 | 4860.7 samples/s | 75.9 steps/s
[Step=7350 Epoch=70.2] | Loss=0.01229 | Reg=0.00910 | acc=1.0000 | FP-Norm=2.957 | FP-Norm(final)=2.424 | 1588.2 samples/s | 24.8 steps/s
[Step=7400 Epoch=70.7] | Loss=0.00926 | Reg=0.00883 | acc=1.0000 | FP-Norm=2.926 | FP-Norm(final)=2.421 | 4696.9 samples/s | 73.4 steps/s
[Step=7450 Epoch=71.1] | Loss=0.00742 | Reg=0.00846 | acc=1.0000 | FP-Norm=2.869 | FP-Norm(final)=2.422 | 1630.9 samples/s | 25.5 steps/s
[Step=7500 Epoch=71.6] | Loss=0.00619 | Reg=0.00807 | acc=1.0000 | FP-Norm=2.803 | FP-Norm(final)=2.423 | 4286.7 samples/s | 67.0 steps/s
[Step=7550 Epoch=72.1] | Loss=0.00531 | Reg=0.00770 | acc=1.0000 | FP-Norm=2.736 | FP-Norm(final)=2.426 | 1647.0 samples/s | 25.7 steps/s
[Step=7600 Epoch=72.6] | Loss=0.00465 | Reg=0.00735 | acc=1.0000 | FP-Norm=2.671 | FP-Norm(final)=2.428 | 4041.3 samples/s | 63.1 steps/s
[Step=7650 Epoch=73.1] | Loss=0.00413 | Reg=0.00702 | acc=1.0000 | FP-Norm=2.608 | FP-Norm(final)=2.431 | 1641.0 samples/s | 25.6 steps/s
[Step=7700 Epoch=73.5] | Loss=0.00372 | Reg=0.00672 | acc=1.0000 | FP-Norm=2.547 | FP-Norm(final)=2.434 | 3768.8 samples/s | 58.9 steps/s
[Step=7750 Epoch=74.0] | Loss=0.00339 | Reg=0.00644 | acc=1.0000 | FP-Norm=2.489 | FP-Norm(final)=2.436 | 1711.7 samples/s | 26.7 steps/s
[Step=7800 Epoch=74.5] | Loss=0.00311 | Reg=0.00618 | acc=1.0000 | FP-Norm=2.433 | FP-Norm(final)=2.439 | 3808.4 samples/s | 59.5 steps/s
[Step=7850 Epoch=75.0] | Loss=0.00287 | Reg=0.00594 | acc=1.0000 | FP-Norm=2.379 | FP-Norm(final)=2.442 | 1743.6 samples/s | 27.2 steps/s
[Step=7900 Epoch=75.4] | Loss=0.00267 | Reg=0.00571 | acc=1.0000 | FP-Norm=2.328 | FP-Norm(final)=2.445 | 3761.5 samples/s | 58.8 steps/s
[Step=7950 Epoch=75.9] | Loss=0.00249 | Reg=0.00550 | acc=1.0000 | FP-Norm=2.278 | FP-Norm(final)=2.447 | 1781.7 samples/s | 27.8 steps/s
[Step=8000 Epoch=76.4] | Loss=0.00234 | Reg=0.00530 | acc=1.0000 | FP-Norm=2.231 | FP-Norm(final)=2.450 | 3681.8 samples/s | 57.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step8000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=67.9] | Loss=0.08422 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.509 | 3737.9 samples/s | 58.4 steps/s
[Step=7250 Epoch=68.3] | Loss=0.01443 | Reg=0.00574 | acc=1.0000 | FP-Norm=2.271 | FP-Norm(final)=2.469 | 3435.9 samples/s | 53.7 steps/s
[Step=7300 Epoch=68.8] | Loss=0.00920 | Reg=0.00631 | acc=1.0000 | FP-Norm=2.448 | FP-Norm(final)=2.474 | 4717.7 samples/s | 73.7 steps/s
[Step=7350 Epoch=69.3] | Loss=0.00694 | Reg=0.00633 | acc=1.0000 | FP-Norm=2.472 | FP-Norm(final)=2.479 | 1574.6 samples/s | 24.6 steps/s
[Step=7400 Epoch=69.7] | Loss=0.00527 | Reg=0.00628 | acc=1.0000 | FP-Norm=2.473 | FP-Norm(final)=2.483 | 4327.7 samples/s | 67.6 steps/s
[Step=7450 Epoch=70.2] | Loss=0.00424 | Reg=0.00607 | acc=1.0000 | FP-Norm=2.436 | FP-Norm(final)=2.487 | 1624.7 samples/s | 25.4 steps/s
[Step=7500 Epoch=70.7] | Loss=0.00354 | Reg=0.00581 | acc=1.0000 | FP-Norm=2.385 | FP-Norm(final)=2.490 | 4045.0 samples/s | 63.2 steps/s
[Step=7550 Epoch=71.1] | Loss=0.00304 | Reg=0.00556 | acc=1.0000 | FP-Norm=2.330 | FP-Norm(final)=2.494 | 1664.8 samples/s | 26.0 steps/s
[Step=7600 Epoch=71.6] | Loss=0.00266 | Reg=0.00531 | acc=1.0000 | FP-Norm=2.275 | FP-Norm(final)=2.496 | 3806.6 samples/s | 59.5 steps/s
[Step=7650 Epoch=72.1] | Loss=0.00237 | Reg=0.00507 | acc=1.0000 | FP-Norm=2.220 | FP-Norm(final)=2.499 | 1737.6 samples/s | 27.2 steps/s
[Step=7700 Epoch=72.6] | Loss=0.00213 | Reg=0.00485 | acc=1.0000 | FP-Norm=2.168 | FP-Norm(final)=2.501 | 3742.6 samples/s | 58.5 steps/s
[Step=7750 Epoch=73.0] | Loss=0.00194 | Reg=0.00465 | acc=1.0000 | FP-Norm=2.117 | FP-Norm(final)=2.503 | 1785.6 samples/s | 27.9 steps/s
[Step=7800 Epoch=73.5] | Loss=0.00178 | Reg=0.00445 | acc=1.0000 | FP-Norm=2.068 | FP-Norm(final)=2.505 | 3708.2 samples/s | 57.9 steps/s
[Step=7850 Epoch=74.0] | Loss=0.00165 | Reg=0.00427 | acc=1.0000 | FP-Norm=2.021 | FP-Norm(final)=2.507 | 1794.4 samples/s | 28.0 steps/s
[Step=7900 Epoch=74.4] | Loss=0.00153 | Reg=0.00411 | acc=1.0000 | FP-Norm=1.976 | FP-Norm(final)=2.508 | 3668.7 samples/s | 57.3 steps/s
[Step=7950 Epoch=74.9] | Loss=0.00143 | Reg=0.00395 | acc=1.0000 | FP-Norm=1.932 | FP-Norm(final)=2.510 | 1857.4 samples/s | 29.0 steps/s
[Step=8000 Epoch=75.4] | Loss=0.00134 | Reg=0.00380 | acc=1.0000 | FP-Norm=1.890 | FP-Norm(final)=2.511 | 3340.3 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step8000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.6] | Loss=0.05261 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.509 | 3580.4 samples/s | 55.9 steps/s
[Step=7250 Epoch=69.1] | Loss=0.02009 | Reg=0.00499 | acc=1.0000 | FP-Norm=2.078 | FP-Norm(final)=2.478 | 3580.1 samples/s | 55.9 steps/s
[Step=7300 Epoch=69.6] | Loss=0.01417 | Reg=0.00696 | acc=0.9688 | FP-Norm=2.534 | FP-Norm(final)=2.458 | 4922.7 samples/s | 76.9 steps/s
[Step=7350 Epoch=70.1] | Loss=0.01016 | Reg=0.00756 | acc=1.0000 | FP-Norm=2.674 | FP-Norm(final)=2.449 | 1576.3 samples/s | 24.6 steps/s
[Step=7400 Epoch=70.5] | Loss=0.00772 | Reg=0.00760 | acc=1.0000 | FP-Norm=2.701 | FP-Norm(final)=2.449 | 4574.2 samples/s | 71.5 steps/s
[Step=7450 Epoch=71.0] | Loss=0.00618 | Reg=0.00740 | acc=1.0000 | FP-Norm=2.675 | FP-Norm(final)=2.451 | 1631.2 samples/s | 25.5 steps/s
[Step=7500 Epoch=71.5] | Loss=0.00516 | Reg=0.00713 | acc=1.0000 | FP-Norm=2.629 | FP-Norm(final)=2.454 | 4283.9 samples/s | 66.9 steps/s
[Step=7550 Epoch=72.0] | Loss=0.00442 | Reg=0.00684 | acc=1.0000 | FP-Norm=2.576 | FP-Norm(final)=2.457 | 1617.1 samples/s | 25.3 steps/s
[Step=7600 Epoch=72.4] | Loss=0.00387 | Reg=0.00656 | acc=1.0000 | FP-Norm=2.521 | FP-Norm(final)=2.460 | 3945.6 samples/s | 61.6 steps/s
[Step=7650 Epoch=72.9] | Loss=0.00345 | Reg=0.00628 | acc=1.0000 | FP-Norm=2.466 | FP-Norm(final)=2.463 | 1683.7 samples/s | 26.3 steps/s
[Step=7700 Epoch=73.4] | Loss=0.00311 | Reg=0.00603 | acc=1.0000 | FP-Norm=2.413 | FP-Norm(final)=2.466 | 3860.1 samples/s | 60.3 steps/s
[Step=7750 Epoch=73.9] | Loss=0.00283 | Reg=0.00579 | acc=1.0000 | FP-Norm=2.360 | FP-Norm(final)=2.468 | 1725.5 samples/s | 27.0 steps/s
[Step=7800 Epoch=74.3] | Loss=0.00259 | Reg=0.00556 | acc=1.0000 | FP-Norm=2.309 | FP-Norm(final)=2.471 | 3689.4 samples/s | 57.6 steps/s
[Step=7850 Epoch=74.8] | Loss=0.00240 | Reg=0.00535 | acc=1.0000 | FP-Norm=2.260 | FP-Norm(final)=2.473 | 1731.3 samples/s | 27.1 steps/s
[Step=7900 Epoch=75.3] | Loss=0.00223 | Reg=0.00515 | acc=1.0000 | FP-Norm=2.212 | FP-Norm(final)=2.476 | 3570.3 samples/s | 55.8 steps/s
[Step=7950 Epoch=75.8] | Loss=0.00208 | Reg=0.00496 | acc=1.0000 | FP-Norm=2.166 | FP-Norm(final)=2.478 | 1641.7 samples/s | 25.7 steps/s
[Step=8000 Epoch=76.2] | Loss=0.00195 | Reg=0.00478 | acc=1.0000 | FP-Norm=2.122 | FP-Norm(final)=2.480 | 3537.7 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19802 | acc=0.8545 | tpr=0.7986 | fpr=0.0240 | 3507.9 samples/s | 13.7 steps/s
Avg test loss: 0.19813, Avg test acc: 0.85484, Avg tpr: 0.79962, Avg fpr: 0.02371, total FA: 185

Testing server on iccad2012
[Step=  50] | Loss=0.52756 | acc=0.7557 | tpr=0.9602 | fpr=0.2480 | 3513.8 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.53507 | acc=0.7543 | tpr=0.9638 | fpr=0.2497 | 6536.1 samples/s | 25.5 steps/s
[Step= 150] | Loss=0.53873 | acc=0.7550 | tpr=0.9654 | fpr=0.2489 | 6690.3 samples/s | 26.1 steps/s
[Step= 200] | Loss=0.53942 | acc=0.7552 | tpr=0.9672 | fpr=0.2487 | 6801.2 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.53783 | acc=0.7553 | tpr=0.9642 | fpr=0.2485 | 6961.4 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.53990 | acc=0.7548 | tpr=0.9636 | fpr=0.2491 | 6716.4 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.53971 | acc=0.7552 | tpr=0.9649 | fpr=0.2486 | 7139.1 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.53969 | acc=0.7546 | tpr=0.9650 | fpr=0.2493 | 7074.1 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.54143 | acc=0.7549 | tpr=0.9654 | fpr=0.2489 | 5878.7 samples/s | 23.0 steps/s
[Step= 500] | Loss=0.54292 | acc=0.7548 | tpr=0.9665 | fpr=0.2490 | 6525.5 samples/s | 25.5 steps/s
[Step= 550] | Loss=0.54239 | acc=0.7550 | tpr=0.9658 | fpr=0.2488 | 12956.4 samples/s | 50.6 steps/s
Avg test loss: 0.54267, Avg test acc: 0.75502, Avg tpr: 0.96593, Avg fpr: 0.24882, total FA: 34548

server round 10/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.10551 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.510 | 3853.1 samples/s | 60.2 steps/s
[Step=8050 Epoch=39.3] | Loss=0.04432 | Reg=0.00066 | acc=0.9531 | FP-Norm=0.773 | FP-Norm(final)=2.497 | 3485.6 samples/s | 54.5 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03653 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.874 | FP-Norm(final)=2.497 | 3744.2 samples/s | 58.5 steps/s
[Step=8150 Epoch=39.7] | Loss=0.03428 | Reg=0.00089 | acc=0.9688 | FP-Norm=0.924 | FP-Norm(final)=2.498 | 3726.1 samples/s | 58.2 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03173 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.962 | FP-Norm(final)=2.499 | 4672.8 samples/s | 73.0 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02786 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.989 | FP-Norm(final)=2.502 | 1606.5 samples/s | 25.1 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02533 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.009 | FP-Norm(final)=2.506 | 3758.5 samples/s | 58.7 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02347 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.025 | FP-Norm(final)=2.511 | 3725.1 samples/s | 58.2 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02202 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.039 | FP-Norm(final)=2.516 | 4487.2 samples/s | 70.1 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02100 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.051 | FP-Norm(final)=2.519 | 1626.0 samples/s | 25.4 steps/s
[Step=8500 Epoch=41.4] | Loss=0.02008 | Reg=0.00115 | acc=0.9844 | FP-Norm=1.063 | FP-Norm(final)=2.522 | 3631.5 samples/s | 56.7 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01932 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.073 | FP-Norm(final)=2.526 | 3549.4 samples/s | 55.5 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01856 | Reg=0.00119 | acc=0.9844 | FP-Norm=1.083 | FP-Norm(final)=2.529 | 4083.4 samples/s | 63.8 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01790 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.095 | FP-Norm(final)=2.532 | 1637.1 samples/s | 25.6 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01753 | Reg=0.00124 | acc=0.9844 | FP-Norm=1.105 | FP-Norm(final)=2.534 | 3776.7 samples/s | 59.0 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01683 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.113 | FP-Norm(final)=2.537 | 3807.3 samples/s | 59.5 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01623 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.122 | FP-Norm(final)=2.540 | 4044.4 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step8800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.24536 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.510 | 3613.6 samples/s | 56.5 steps/s
[Step=8050 Epoch=39.3] | Loss=0.03668 | Reg=0.00072 | acc=0.9844 | FP-Norm=0.812 | FP-Norm(final)=2.503 | 3754.2 samples/s | 58.7 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03476 | Reg=0.00083 | acc=0.9062 | FP-Norm=0.890 | FP-Norm(final)=2.503 | 3771.8 samples/s | 58.9 steps/s
[Step=8150 Epoch=39.8] | Loss=0.03173 | Reg=0.00090 | acc=0.9531 | FP-Norm=0.932 | FP-Norm(final)=2.504 | 3788.8 samples/s | 59.2 steps/s
[Step=8200 Epoch=40.0] | Loss=0.02962 | Reg=0.00097 | acc=0.9844 | FP-Norm=0.973 | FP-Norm(final)=2.506 | 4839.3 samples/s | 75.6 steps/s
[Step=8250 Epoch=40.3] | Loss=0.02638 | Reg=0.00104 | acc=0.9844 | FP-Norm=1.009 | FP-Norm(final)=2.509 | 1597.9 samples/s | 25.0 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02374 | Reg=0.00109 | acc=0.9844 | FP-Norm=1.033 | FP-Norm(final)=2.514 | 3766.6 samples/s | 58.9 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02254 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.050 | FP-Norm(final)=2.518 | 3794.1 samples/s | 59.3 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02148 | Reg=0.00116 | acc=0.9844 | FP-Norm=1.066 | FP-Norm(final)=2.523 | 4589.2 samples/s | 71.7 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02017 | Reg=0.00119 | acc=1.0000 | FP-Norm=1.082 | FP-Norm(final)=2.527 | 1632.1 samples/s | 25.5 steps/s
[Step=8500 Epoch=41.5] | Loss=0.01931 | Reg=0.00122 | acc=0.9844 | FP-Norm=1.096 | FP-Norm(final)=2.531 | 3791.5 samples/s | 59.2 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01833 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.107 | FP-Norm(final)=2.535 | 3748.7 samples/s | 58.6 steps/s
[Step=8600 Epoch=42.0] | Loss=0.01752 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.115 | FP-Norm(final)=2.538 | 4412.0 samples/s | 68.9 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01675 | Reg=0.00128 | acc=0.9844 | FP-Norm=1.123 | FP-Norm(final)=2.542 | 1671.6 samples/s | 26.1 steps/s
[Step=8700 Epoch=42.5] | Loss=0.01623 | Reg=0.00130 | acc=0.9844 | FP-Norm=1.131 | FP-Norm(final)=2.545 | 3763.2 samples/s | 58.8 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01585 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.138 | FP-Norm(final)=2.548 | 3819.7 samples/s | 59.7 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01519 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.144 | FP-Norm(final)=2.551 | 4182.6 samples/s | 65.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step8800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.12964 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.510 | 3611.4 samples/s | 56.4 steps/s
[Step=8050 Epoch=39.2] | Loss=0.05115 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.806 | FP-Norm(final)=2.500 | 3702.3 samples/s | 57.8 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03962 | Reg=0.00088 | acc=0.9844 | FP-Norm=0.911 | FP-Norm(final)=2.499 | 3776.4 samples/s | 59.0 steps/s
[Step=8150 Epoch=39.7] | Loss=0.03493 | Reg=0.00094 | acc=0.9688 | FP-Norm=0.952 | FP-Norm(final)=2.502 | 3793.8 samples/s | 59.3 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03246 | Reg=0.00099 | acc=0.9844 | FP-Norm=0.981 | FP-Norm(final)=2.504 | 4814.1 samples/s | 75.2 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02867 | Reg=0.00103 | acc=1.0000 | FP-Norm=1.004 | FP-Norm(final)=2.507 | 1618.9 samples/s | 25.3 steps/s
[Step=8300 Epoch=40.4] | Loss=0.02617 | Reg=0.00107 | acc=0.9688 | FP-Norm=1.022 | FP-Norm(final)=2.513 | 3778.2 samples/s | 59.0 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02405 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.036 | FP-Norm(final)=2.518 | 3891.1 samples/s | 60.8 steps/s
[Step=8400 Epoch=40.9] | Loss=0.02257 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.047 | FP-Norm(final)=2.523 | 4576.0 samples/s | 71.5 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02115 | Reg=0.00114 | acc=0.9844 | FP-Norm=1.057 | FP-Norm(final)=2.527 | 1672.4 samples/s | 26.1 steps/s
[Step=8500 Epoch=41.4] | Loss=0.02002 | Reg=0.00115 | acc=0.9844 | FP-Norm=1.066 | FP-Norm(final)=2.532 | 3782.5 samples/s | 59.1 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01907 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.075 | FP-Norm(final)=2.536 | 3773.5 samples/s | 59.0 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01838 | Reg=0.00119 | acc=0.9844 | FP-Norm=1.085 | FP-Norm(final)=2.541 | 4306.7 samples/s | 67.3 steps/s
[Step=8650 Epoch=42.1] | Loss=0.01774 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.095 | FP-Norm(final)=2.545 | 1691.1 samples/s | 26.4 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01724 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.104 | FP-Norm(final)=2.549 | 3810.1 samples/s | 59.5 steps/s
[Step=8750 Epoch=42.6] | Loss=0.01651 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.111 | FP-Norm(final)=2.552 | 3768.3 samples/s | 58.9 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01609 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.119 | FP-Norm(final)=2.556 | 4065.0 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step8800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.08953 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.510 | 3726.4 samples/s | 58.2 steps/s
[Step=8050 Epoch=39.3] | Loss=0.03637 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.753 | FP-Norm(final)=2.504 | 3709.9 samples/s | 58.0 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03332 | Reg=0.00076 | acc=0.9844 | FP-Norm=0.849 | FP-Norm(final)=2.505 | 3801.9 samples/s | 59.4 steps/s
[Step=8150 Epoch=39.7] | Loss=0.03021 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.900 | FP-Norm(final)=2.507 | 3791.5 samples/s | 59.2 steps/s
[Step=8200 Epoch=40.0] | Loss=0.02783 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.937 | FP-Norm(final)=2.509 | 4838.1 samples/s | 75.6 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02523 | Reg=0.00095 | acc=0.9844 | FP-Norm=0.963 | FP-Norm(final)=2.512 | 1609.8 samples/s | 25.2 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02291 | Reg=0.00098 | acc=0.9688 | FP-Norm=0.981 | FP-Norm(final)=2.516 | 3790.3 samples/s | 59.2 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02140 | Reg=0.00101 | acc=0.9688 | FP-Norm=0.994 | FP-Norm(final)=2.520 | 3740.4 samples/s | 58.4 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02022 | Reg=0.00103 | acc=1.0000 | FP-Norm=1.006 | FP-Norm(final)=2.524 | 4589.8 samples/s | 71.7 steps/s
[Step=8450 Epoch=41.2] | Loss=0.01888 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.019 | FP-Norm(final)=2.529 | 1658.3 samples/s | 25.9 steps/s
[Step=8500 Epoch=41.5] | Loss=0.01793 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.031 | FP-Norm(final)=2.533 | 3761.8 samples/s | 58.8 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01707 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.043 | FP-Norm(final)=2.538 | 3757.2 samples/s | 58.7 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01655 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.054 | FP-Norm(final)=2.542 | 4296.7 samples/s | 67.1 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01593 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.063 | FP-Norm(final)=2.546 | 1680.6 samples/s | 26.3 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01530 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.072 | FP-Norm(final)=2.549 | 3781.5 samples/s | 59.1 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01481 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.079 | FP-Norm(final)=2.552 | 3782.9 samples/s | 59.1 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01435 | Reg=0.00120 | acc=0.9844 | FP-Norm=1.086 | FP-Norm(final)=2.555 | 4069.6 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step8800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.2] | Loss=0.06865 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.511 | 3854.8 samples/s | 60.2 steps/s
[Step=8050 Epoch=39.5] | Loss=0.04259 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.762 | FP-Norm(final)=2.505 | 3482.6 samples/s | 54.4 steps/s
[Step=8100 Epoch=39.7] | Loss=0.03360 | Reg=0.00078 | acc=0.9844 | FP-Norm=0.862 | FP-Norm(final)=2.503 | 3827.3 samples/s | 59.8 steps/s
[Step=8150 Epoch=40.0] | Loss=0.03047 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.916 | FP-Norm(final)=2.504 | 3753.1 samples/s | 58.6 steps/s
[Step=8200 Epoch=40.2] | Loss=0.02748 | Reg=0.00093 | acc=0.9688 | FP-Norm=0.951 | FP-Norm(final)=2.507 | 4938.2 samples/s | 77.2 steps/s
[Step=8250 Epoch=40.5] | Loss=0.02451 | Reg=0.00099 | acc=0.9531 | FP-Norm=0.981 | FP-Norm(final)=2.512 | 1621.1 samples/s | 25.3 steps/s
[Step=8300 Epoch=40.7] | Loss=0.02261 | Reg=0.00102 | acc=0.9844 | FP-Norm=1.000 | FP-Norm(final)=2.516 | 3811.9 samples/s | 59.6 steps/s
[Step=8350 Epoch=40.9] | Loss=0.02111 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.014 | FP-Norm(final)=2.520 | 3763.2 samples/s | 58.8 steps/s
[Step=8400 Epoch=41.2] | Loss=0.02033 | Reg=0.00108 | acc=0.9844 | FP-Norm=1.028 | FP-Norm(final)=2.524 | 4721.2 samples/s | 73.8 steps/s
[Step=8450 Epoch=41.4] | Loss=0.01899 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.040 | FP-Norm(final)=2.528 | 1614.8 samples/s | 25.2 steps/s
[Step=8500 Epoch=41.7] | Loss=0.01808 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.051 | FP-Norm(final)=2.532 | 3743.5 samples/s | 58.5 steps/s
[Step=8550 Epoch=41.9] | Loss=0.01714 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.058 | FP-Norm(final)=2.535 | 3778.9 samples/s | 59.0 steps/s
[Step=8600 Epoch=42.2] | Loss=0.01649 | Reg=0.00115 | acc=0.9844 | FP-Norm=1.066 | FP-Norm(final)=2.539 | 4495.2 samples/s | 70.2 steps/s
[Step=8650 Epoch=42.4] | Loss=0.01585 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.076 | FP-Norm(final)=2.542 | 1648.4 samples/s | 25.8 steps/s
[Step=8700 Epoch=42.7] | Loss=0.01530 | Reg=0.00119 | acc=1.0000 | FP-Norm=1.084 | FP-Norm(final)=2.545 | 3774.2 samples/s | 59.0 steps/s
[Step=8750 Epoch=42.9] | Loss=0.01480 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.091 | FP-Norm(final)=2.547 | 3783.7 samples/s | 59.1 steps/s
[Step=8800 Epoch=43.2] | Loss=0.01435 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.098 | FP-Norm(final)=2.549 | 4285.8 samples/s | 67.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step8800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=75.8] | Loss=0.13334 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.509 | 3775.3 samples/s | 59.0 steps/s
[Step=8050 Epoch=76.3] | Loss=0.01768 | Reg=0.00263 | acc=1.0000 | FP-Norm=1.540 | FP-Norm(final)=2.489 | 3169.3 samples/s | 49.5 steps/s
[Step=8100 Epoch=76.8] | Loss=0.00939 | Reg=0.00295 | acc=1.0000 | FP-Norm=1.675 | FP-Norm(final)=2.487 | 4612.1 samples/s | 72.1 steps/s
[Step=8150 Epoch=77.2] | Loss=0.00639 | Reg=0.00287 | acc=1.0000 | FP-Norm=1.665 | FP-Norm(final)=2.490 | 1549.9 samples/s | 24.2 steps/s
[Step=8200 Epoch=77.7] | Loss=0.00483 | Reg=0.00273 | acc=1.0000 | FP-Norm=1.629 | FP-Norm(final)=2.493 | 4332.4 samples/s | 67.7 steps/s
[Step=8250 Epoch=78.2] | Loss=0.00389 | Reg=0.00260 | acc=1.0000 | FP-Norm=1.590 | FP-Norm(final)=2.496 | 1595.4 samples/s | 24.9 steps/s
[Step=8300 Epoch=78.6] | Loss=0.00326 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.552 | FP-Norm(final)=2.498 | 4014.1 samples/s | 62.7 steps/s
[Step=8350 Epoch=79.1] | Loss=0.00280 | Reg=0.00236 | acc=1.0000 | FP-Norm=1.516 | FP-Norm(final)=2.500 | 1606.4 samples/s | 25.1 steps/s
[Step=8400 Epoch=79.6] | Loss=0.00246 | Reg=0.00226 | acc=1.0000 | FP-Norm=1.481 | FP-Norm(final)=2.502 | 3784.1 samples/s | 59.1 steps/s
[Step=8450 Epoch=80.1] | Loss=0.00219 | Reg=0.00217 | acc=1.0000 | FP-Norm=1.450 | FP-Norm(final)=2.504 | 1649.5 samples/s | 25.8 steps/s
[Step=8500 Epoch=80.5] | Loss=0.00198 | Reg=0.00208 | acc=1.0000 | FP-Norm=1.420 | FP-Norm(final)=2.505 | 3611.2 samples/s | 56.4 steps/s
[Step=8550 Epoch=81.0] | Loss=0.00180 | Reg=0.00200 | acc=1.0000 | FP-Norm=1.392 | FP-Norm(final)=2.507 | 1683.2 samples/s | 26.3 steps/s
[Step=8600 Epoch=81.5] | Loss=0.00166 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.365 | FP-Norm(final)=2.508 | 3582.2 samples/s | 56.0 steps/s
[Step=8650 Epoch=82.0] | Loss=0.00153 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.340 | FP-Norm(final)=2.509 | 1710.1 samples/s | 26.7 steps/s
[Step=8700 Epoch=82.4] | Loss=0.00142 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.317 | FP-Norm(final)=2.510 | 3586.3 samples/s | 56.0 steps/s
[Step=8750 Epoch=82.9] | Loss=0.00133 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.294 | FP-Norm(final)=2.511 | 1695.4 samples/s | 26.5 steps/s
[Step=8800 Epoch=83.4] | Loss=0.00125 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.273 | FP-Norm(final)=2.513 | 3531.9 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step8800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=76.1] | Loss=0.14699 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.509 | 3528.3 samples/s | 55.1 steps/s
[Step=8050 Epoch=76.6] | Loss=0.01005 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.286 | FP-Norm(final)=2.495 | 3335.7 samples/s | 52.1 steps/s
[Step=8100 Epoch=77.1] | Loss=0.00601 | Reg=0.00202 | acc=1.0000 | FP-Norm=1.390 | FP-Norm(final)=2.499 | 4656.6 samples/s | 72.8 steps/s
[Step=8150 Epoch=77.5] | Loss=0.00406 | Reg=0.00199 | acc=1.0000 | FP-Norm=1.390 | FP-Norm(final)=2.503 | 1519.5 samples/s | 23.7 steps/s
[Step=8200 Epoch=78.0] | Loss=0.00307 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.363 | FP-Norm(final)=2.507 | 4331.7 samples/s | 67.7 steps/s
[Step=8250 Epoch=78.5] | Loss=0.00247 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.333 | FP-Norm(final)=2.510 | 1577.1 samples/s | 24.6 steps/s
[Step=8300 Epoch=79.0] | Loss=0.00206 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.301 | FP-Norm(final)=2.512 | 4115.6 samples/s | 64.3 steps/s
[Step=8350 Epoch=79.4] | Loss=0.00177 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.271 | FP-Norm(final)=2.513 | 1618.3 samples/s | 25.3 steps/s
[Step=8400 Epoch=79.9] | Loss=0.00156 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.243 | FP-Norm(final)=2.515 | 3839.4 samples/s | 60.0 steps/s
[Step=8450 Epoch=80.4] | Loss=0.00139 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.217 | FP-Norm(final)=2.516 | 1661.8 samples/s | 26.0 steps/s
[Step=8500 Epoch=80.9] | Loss=0.00125 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.192 | FP-Norm(final)=2.518 | 3648.5 samples/s | 57.0 steps/s
[Step=8550 Epoch=81.3] | Loss=0.00114 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.169 | FP-Norm(final)=2.519 | 1703.7 samples/s | 26.6 steps/s
[Step=8600 Epoch=81.8] | Loss=0.00105 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.147 | FP-Norm(final)=2.520 | 3594.3 samples/s | 56.2 steps/s
[Step=8650 Epoch=82.3] | Loss=0.00097 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.126 | FP-Norm(final)=2.521 | 1712.9 samples/s | 26.8 steps/s
[Step=8700 Epoch=82.8] | Loss=0.00091 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.106 | FP-Norm(final)=2.522 | 3572.3 samples/s | 55.8 steps/s
[Step=8750 Epoch=83.2] | Loss=0.00085 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.087 | FP-Norm(final)=2.523 | 1730.3 samples/s | 27.0 steps/s
[Step=8800 Epoch=83.7] | Loss=0.00080 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.069 | FP-Norm(final)=2.524 | 3546.8 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step8800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=76.4] | Loss=0.14395 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.509 | 3625.8 samples/s | 56.7 steps/s
[Step=8050 Epoch=76.9] | Loss=0.01566 | Reg=0.00261 | acc=1.0000 | FP-Norm=1.544 | FP-Norm(final)=2.496 | 3246.2 samples/s | 50.7 steps/s
[Step=8100 Epoch=77.4] | Loss=0.00972 | Reg=0.00294 | acc=1.0000 | FP-Norm=1.678 | FP-Norm(final)=2.496 | 4636.2 samples/s | 72.4 steps/s
[Step=8150 Epoch=77.8] | Loss=0.00662 | Reg=0.00295 | acc=1.0000 | FP-Norm=1.692 | FP-Norm(final)=2.497 | 1539.5 samples/s | 24.1 steps/s
[Step=8200 Epoch=78.3] | Loss=0.00500 | Reg=0.00285 | acc=1.0000 | FP-Norm=1.670 | FP-Norm(final)=2.499 | 4424.3 samples/s | 69.1 steps/s
[Step=8250 Epoch=78.8] | Loss=0.00401 | Reg=0.00274 | acc=1.0000 | FP-Norm=1.639 | FP-Norm(final)=2.500 | 1566.3 samples/s | 24.5 steps/s
[Step=8300 Epoch=79.3] | Loss=0.00335 | Reg=0.00263 | acc=1.0000 | FP-Norm=1.606 | FP-Norm(final)=2.501 | 4192.2 samples/s | 65.5 steps/s
[Step=8350 Epoch=79.7] | Loss=0.00288 | Reg=0.00253 | acc=1.0000 | FP-Norm=1.574 | FP-Norm(final)=2.503 | 1603.8 samples/s | 25.1 steps/s
[Step=8400 Epoch=80.2] | Loss=0.00252 | Reg=0.00243 | acc=1.0000 | FP-Norm=1.542 | FP-Norm(final)=2.504 | 3986.2 samples/s | 62.3 steps/s
[Step=8450 Epoch=80.7] | Loss=0.00225 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.513 | FP-Norm(final)=2.505 | 1629.9 samples/s | 25.5 steps/s
[Step=8500 Epoch=81.2] | Loss=0.00203 | Reg=0.00226 | acc=1.0000 | FP-Norm=1.485 | FP-Norm(final)=2.506 | 3776.9 samples/s | 59.0 steps/s
[Step=8550 Epoch=81.6] | Loss=0.00185 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.458 | FP-Norm(final)=2.507 | 1632.2 samples/s | 25.5 steps/s
[Step=8600 Epoch=82.1] | Loss=0.00170 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.433 | FP-Norm(final)=2.507 | 3640.7 samples/s | 56.9 steps/s
[Step=8650 Epoch=82.6] | Loss=0.00157 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.409 | FP-Norm(final)=2.508 | 1662.8 samples/s | 26.0 steps/s
[Step=8700 Epoch=83.1] | Loss=0.00146 | Reg=0.00199 | acc=1.0000 | FP-Norm=1.386 | FP-Norm(final)=2.509 | 3560.1 samples/s | 55.6 steps/s
[Step=8750 Epoch=83.6] | Loss=0.00136 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.364 | FP-Norm(final)=2.510 | 1704.7 samples/s | 26.6 steps/s
[Step=8800 Epoch=84.0] | Loss=0.00128 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.343 | FP-Norm(final)=2.511 | 3606.3 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step8800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=75.4] | Loss=0.13928 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.509 | 3493.1 samples/s | 54.6 steps/s
[Step=8050 Epoch=75.9] | Loss=0.02273 | Reg=0.00243 | acc=1.0000 | FP-Norm=1.480 | FP-Norm(final)=2.477 | 3386.9 samples/s | 52.9 steps/s
[Step=8100 Epoch=76.3] | Loss=0.01201 | Reg=0.00287 | acc=1.0000 | FP-Norm=1.648 | FP-Norm(final)=2.472 | 4570.4 samples/s | 71.4 steps/s
[Step=8150 Epoch=76.8] | Loss=0.00805 | Reg=0.00284 | acc=1.0000 | FP-Norm=1.655 | FP-Norm(final)=2.476 | 1534.3 samples/s | 24.0 steps/s
[Step=8200 Epoch=77.3] | Loss=0.00606 | Reg=0.00273 | acc=1.0000 | FP-Norm=1.628 | FP-Norm(final)=2.478 | 4243.7 samples/s | 66.3 steps/s
[Step=8250 Epoch=77.7] | Loss=0.00491 | Reg=0.00262 | acc=1.0000 | FP-Norm=1.597 | FP-Norm(final)=2.481 | 1600.1 samples/s | 25.0 steps/s
[Step=8300 Epoch=78.2] | Loss=0.00410 | Reg=0.00251 | acc=1.0000 | FP-Norm=1.565 | FP-Norm(final)=2.483 | 3923.6 samples/s | 61.3 steps/s
[Step=8350 Epoch=78.7] | Loss=0.00352 | Reg=0.00241 | acc=1.0000 | FP-Norm=1.533 | FP-Norm(final)=2.485 | 1634.1 samples/s | 25.5 steps/s
[Step=8400 Epoch=79.2] | Loss=0.00309 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.502 | FP-Norm(final)=2.487 | 3729.6 samples/s | 58.3 steps/s
[Step=8450 Epoch=79.6] | Loss=0.00275 | Reg=0.00223 | acc=1.0000 | FP-Norm=1.473 | FP-Norm(final)=2.489 | 1665.8 samples/s | 26.0 steps/s
[Step=8500 Epoch=80.1] | Loss=0.00248 | Reg=0.00215 | acc=1.0000 | FP-Norm=1.445 | FP-Norm(final)=2.491 | 3568.7 samples/s | 55.8 steps/s
[Step=8550 Epoch=80.6] | Loss=0.00226 | Reg=0.00207 | acc=1.0000 | FP-Norm=1.419 | FP-Norm(final)=2.493 | 1720.3 samples/s | 26.9 steps/s
[Step=8600 Epoch=81.0] | Loss=0.00207 | Reg=0.00201 | acc=1.0000 | FP-Norm=1.394 | FP-Norm(final)=2.494 | 3598.6 samples/s | 56.2 steps/s
[Step=8650 Epoch=81.5] | Loss=0.00192 | Reg=0.00194 | acc=1.0000 | FP-Norm=1.370 | FP-Norm(final)=2.496 | 1701.1 samples/s | 26.6 steps/s
[Step=8700 Epoch=82.0] | Loss=0.00178 | Reg=0.00188 | acc=1.0000 | FP-Norm=1.347 | FP-Norm(final)=2.497 | 3552.2 samples/s | 55.5 steps/s
[Step=8750 Epoch=82.4] | Loss=0.00167 | Reg=0.00183 | acc=1.0000 | FP-Norm=1.326 | FP-Norm(final)=2.498 | 1826.7 samples/s | 28.5 steps/s
[Step=8800 Epoch=82.9] | Loss=0.00157 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.305 | FP-Norm(final)=2.500 | 3185.0 samples/s | 49.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step8800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=76.3] | Loss=0.15161 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.509 | 3558.8 samples/s | 55.6 steps/s
[Step=8050 Epoch=76.7] | Loss=0.01957 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.440 | FP-Norm(final)=2.481 | 3309.8 samples/s | 51.7 steps/s
[Step=8100 Epoch=77.2] | Loss=0.01077 | Reg=0.00250 | acc=1.0000 | FP-Norm=1.544 | FP-Norm(final)=2.481 | 4690.0 samples/s | 73.3 steps/s
[Step=8150 Epoch=77.7] | Loss=0.00729 | Reg=0.00245 | acc=1.0000 | FP-Norm=1.539 | FP-Norm(final)=2.483 | 1534.3 samples/s | 24.0 steps/s
[Step=8200 Epoch=78.2] | Loss=0.00550 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.511 | FP-Norm(final)=2.486 | 4429.5 samples/s | 69.2 steps/s
[Step=8250 Epoch=78.6] | Loss=0.00442 | Reg=0.00224 | acc=1.0000 | FP-Norm=1.479 | FP-Norm(final)=2.489 | 1548.1 samples/s | 24.2 steps/s
[Step=8300 Epoch=79.1] | Loss=0.00369 | Reg=0.00214 | acc=1.0000 | FP-Norm=1.446 | FP-Norm(final)=2.491 | 4178.3 samples/s | 65.3 steps/s
[Step=8350 Epoch=79.6] | Loss=0.00317 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.415 | FP-Norm(final)=2.494 | 1604.1 samples/s | 25.1 steps/s
[Step=8400 Epoch=80.1] | Loss=0.00278 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.386 | FP-Norm(final)=2.496 | 3955.6 samples/s | 61.8 steps/s
[Step=8450 Epoch=80.5] | Loss=0.00248 | Reg=0.00190 | acc=1.0000 | FP-Norm=1.359 | FP-Norm(final)=2.497 | 1635.1 samples/s | 25.5 steps/s
[Step=8500 Epoch=81.0] | Loss=0.00224 | Reg=0.00183 | acc=1.0000 | FP-Norm=1.333 | FP-Norm(final)=2.499 | 3769.1 samples/s | 58.9 steps/s
[Step=8550 Epoch=81.5] | Loss=0.00204 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.308 | FP-Norm(final)=2.501 | 1673.2 samples/s | 26.1 steps/s
[Step=8600 Epoch=82.0] | Loss=0.00187 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.285 | FP-Norm(final)=2.502 | 3638.9 samples/s | 56.9 steps/s
[Step=8650 Epoch=82.4] | Loss=0.00173 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.263 | FP-Norm(final)=2.504 | 1711.8 samples/s | 26.7 steps/s
[Step=8700 Epoch=82.9] | Loss=0.00161 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.242 | FP-Norm(final)=2.505 | 3580.0 samples/s | 55.9 steps/s
[Step=8750 Epoch=83.4] | Loss=0.00151 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.222 | FP-Norm(final)=2.507 | 1700.0 samples/s | 26.6 steps/s
[Step=8800 Epoch=83.9] | Loss=0.00141 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.203 | FP-Norm(final)=2.508 | 3604.7 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29553 | acc=0.8023 | tpr=0.7196 | fpr=0.0181 | 3661.2 samples/s | 14.3 steps/s
Avg test loss: 0.29540, Avg test acc: 0.80387, Avg tpr: 0.72320, Avg fpr: 0.01872, total FA: 146

Testing server on iccad2012
[Step=  50] | Loss=0.40448 | acc=0.8336 | tpr=0.9646 | fpr=0.1688 | 3631.7 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.41538 | acc=0.8324 | tpr=0.9638 | fpr=0.1700 | 7018.8 samples/s | 27.4 steps/s
[Step= 150] | Loss=0.41885 | acc=0.8319 | tpr=0.9640 | fpr=0.1706 | 6628.8 samples/s | 25.9 steps/s
[Step= 200] | Loss=0.41972 | acc=0.8314 | tpr=0.9661 | fpr=0.1710 | 6923.7 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.41787 | acc=0.8312 | tpr=0.9633 | fpr=0.1712 | 6959.0 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.42016 | acc=0.8308 | tpr=0.9629 | fpr=0.1716 | 6933.5 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.42038 | acc=0.8314 | tpr=0.9643 | fpr=0.1710 | 6508.1 samples/s | 25.4 steps/s
[Step= 400] | Loss=0.42070 | acc=0.8312 | tpr=0.9650 | fpr=0.1713 | 6756.4 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.42294 | acc=0.8313 | tpr=0.9649 | fpr=0.1711 | 6768.3 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.42425 | acc=0.8310 | tpr=0.9665 | fpr=0.1714 | 6781.2 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.42380 | acc=0.8313 | tpr=0.9662 | fpr=0.1712 | 12517.4 samples/s | 48.9 steps/s
Avg test loss: 0.42386, Avg test acc: 0.83128, Avg tpr: 0.96632, Avg fpr: 0.17117, total FA: 23767

server round 11/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.14582 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.562 | 4020.1 samples/s | 62.8 steps/s
[Step=8850 Epoch=43.2] | Loss=0.04800 | Reg=0.00133 | acc=0.9688 | FP-Norm=1.103 | FP-Norm(final)=2.544 | 3314.0 samples/s | 51.8 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03613 | Reg=0.00149 | acc=0.9844 | FP-Norm=1.194 | FP-Norm(final)=2.539 | 3793.7 samples/s | 59.3 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03434 | Reg=0.00154 | acc=0.9844 | FP-Norm=1.221 | FP-Norm(final)=2.536 | 3784.0 samples/s | 59.1 steps/s
[Step=9000 Epoch=43.9] | Loss=0.03118 | Reg=0.00159 | acc=0.9844 | FP-Norm=1.245 | FP-Norm(final)=2.537 | 4856.3 samples/s | 75.9 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02777 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.260 | FP-Norm(final)=2.540 | 1629.8 samples/s | 25.5 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02552 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.266 | FP-Norm(final)=2.544 | 3759.3 samples/s | 58.7 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02363 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.271 | FP-Norm(final)=2.547 | 3792.4 samples/s | 59.3 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02214 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.277 | FP-Norm(final)=2.550 | 4565.7 samples/s | 71.3 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02163 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.283 | FP-Norm(final)=2.553 | 1654.5 samples/s | 25.9 steps/s
[Step=9300 Epoch=45.3] | Loss=0.02071 | Reg=0.00168 | acc=0.9844 | FP-Norm=1.291 | FP-Norm(final)=2.556 | 3749.8 samples/s | 58.6 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01953 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.297 | FP-Norm(final)=2.558 | 3804.7 samples/s | 59.4 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01891 | Reg=0.00171 | acc=0.9844 | FP-Norm=1.301 | FP-Norm(final)=2.561 | 4285.8 samples/s | 67.0 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01810 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.304 | FP-Norm(final)=2.563 | 1696.7 samples/s | 26.5 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01723 | Reg=0.00172 | acc=0.9844 | FP-Norm=1.306 | FP-Norm(final)=2.566 | 3781.6 samples/s | 59.1 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01674 | Reg=0.00172 | acc=0.9688 | FP-Norm=1.308 | FP-Norm(final)=2.569 | 3805.7 samples/s | 59.5 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01641 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.310 | FP-Norm(final)=2.571 | 4045.4 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step9600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.20793 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.561 | 3976.2 samples/s | 62.1 steps/s
[Step=8850 Epoch=43.2] | Loss=0.04636 | Reg=0.00126 | acc=0.9844 | FP-Norm=1.072 | FP-Norm(final)=2.538 | 3306.3 samples/s | 51.7 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03566 | Reg=0.00135 | acc=0.9844 | FP-Norm=1.139 | FP-Norm(final)=2.538 | 3780.7 samples/s | 59.1 steps/s
[Step=8950 Epoch=43.7] | Loss=0.03237 | Reg=0.00138 | acc=0.9844 | FP-Norm=1.159 | FP-Norm(final)=2.541 | 3782.3 samples/s | 59.1 steps/s
[Step=9000 Epoch=43.9] | Loss=0.03047 | Reg=0.00144 | acc=0.9844 | FP-Norm=1.185 | FP-Norm(final)=2.544 | 4887.4 samples/s | 76.4 steps/s
[Step=9050 Epoch=44.2] | Loss=0.02687 | Reg=0.00147 | acc=0.9844 | FP-Norm=1.202 | FP-Norm(final)=2.546 | 1614.5 samples/s | 25.2 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02423 | Reg=0.00148 | acc=0.9844 | FP-Norm=1.208 | FP-Norm(final)=2.550 | 3774.6 samples/s | 59.0 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02259 | Reg=0.00149 | acc=1.0000 | FP-Norm=1.214 | FP-Norm(final)=2.554 | 3777.9 samples/s | 59.0 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02145 | Reg=0.00150 | acc=0.9844 | FP-Norm=1.219 | FP-Norm(final)=2.558 | 4616.5 samples/s | 72.1 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02012 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.224 | FP-Norm(final)=2.561 | 1656.6 samples/s | 25.9 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01928 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.227 | FP-Norm(final)=2.564 | 3740.1 samples/s | 58.4 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01849 | Reg=0.00153 | acc=0.9844 | FP-Norm=1.230 | FP-Norm(final)=2.566 | 3789.6 samples/s | 59.2 steps/s
[Step=9400 Epoch=45.9] | Loss=0.01761 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.233 | FP-Norm(final)=2.569 | 4376.5 samples/s | 68.4 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01677 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.236 | FP-Norm(final)=2.572 | 1672.6 samples/s | 26.1 steps/s
[Step=9500 Epoch=46.4] | Loss=0.01613 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.240 | FP-Norm(final)=2.575 | 3807.6 samples/s | 59.5 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01571 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.244 | FP-Norm(final)=2.578 | 3762.3 samples/s | 58.8 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01523 | Reg=0.00157 | acc=0.9844 | FP-Norm=1.248 | FP-Norm(final)=2.581 | 4190.5 samples/s | 65.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step9600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.14745 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.561 | 3795.6 samples/s | 59.3 steps/s
[Step=8850 Epoch=43.1] | Loss=0.04627 | Reg=0.00125 | acc=0.9688 | FP-Norm=1.070 | FP-Norm(final)=2.545 | 3520.7 samples/s | 55.0 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03816 | Reg=0.00140 | acc=0.9531 | FP-Norm=1.157 | FP-Norm(final)=2.542 | 3755.0 samples/s | 58.7 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03331 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.189 | FP-Norm(final)=2.542 | 3782.8 samples/s | 59.1 steps/s
[Step=9000 Epoch=43.9] | Loss=0.03078 | Reg=0.00150 | acc=0.9688 | FP-Norm=1.209 | FP-Norm(final)=2.543 | 4819.4 samples/s | 75.3 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02790 | Reg=0.00152 | acc=0.9844 | FP-Norm=1.222 | FP-Norm(final)=2.546 | 1603.4 samples/s | 25.1 steps/s
[Step=9100 Epoch=44.3] | Loss=0.02504 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.231 | FP-Norm(final)=2.550 | 3774.6 samples/s | 59.0 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02329 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.236 | FP-Norm(final)=2.554 | 3783.6 samples/s | 59.1 steps/s
[Step=9200 Epoch=44.8] | Loss=0.02194 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.240 | FP-Norm(final)=2.558 | 4538.5 samples/s | 70.9 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02116 | Reg=0.00157 | acc=0.9844 | FP-Norm=1.248 | FP-Norm(final)=2.562 | 1650.2 samples/s | 25.8 steps/s
[Step=9300 Epoch=45.3] | Loss=0.01997 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.256 | FP-Norm(final)=2.565 | 3779.2 samples/s | 59.0 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01919 | Reg=0.00161 | acc=0.9844 | FP-Norm=1.262 | FP-Norm(final)=2.569 | 3751.0 samples/s | 58.6 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01881 | Reg=0.00162 | acc=0.9688 | FP-Norm=1.268 | FP-Norm(final)=2.572 | 4309.4 samples/s | 67.3 steps/s
[Step=9450 Epoch=46.0] | Loss=0.01798 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.274 | FP-Norm(final)=2.575 | 1706.4 samples/s | 26.7 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01725 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.279 | FP-Norm(final)=2.578 | 3761.4 samples/s | 58.8 steps/s
[Step=9550 Epoch=46.5] | Loss=0.01649 | Reg=0.00166 | acc=0.9688 | FP-Norm=1.282 | FP-Norm(final)=2.581 | 3775.8 samples/s | 59.0 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01614 | Reg=0.00166 | acc=0.9844 | FP-Norm=1.285 | FP-Norm(final)=2.585 | 4077.6 samples/s | 63.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step9600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.19586 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.561 | 3662.0 samples/s | 57.2 steps/s
[Step=8850 Epoch=43.2] | Loss=0.04607 | Reg=0.00153 | acc=0.9844 | FP-Norm=1.184 | FP-Norm(final)=2.546 | 3730.4 samples/s | 58.3 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03836 | Reg=0.00164 | acc=0.9844 | FP-Norm=1.255 | FP-Norm(final)=2.542 | 3800.8 samples/s | 59.4 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03353 | Reg=0.00167 | acc=0.9531 | FP-Norm=1.275 | FP-Norm(final)=2.540 | 3778.0 samples/s | 59.0 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02992 | Reg=0.00167 | acc=0.9844 | FP-Norm=1.281 | FP-Norm(final)=2.542 | 4866.3 samples/s | 76.0 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02683 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.292 | FP-Norm(final)=2.545 | 1623.8 samples/s | 25.4 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02425 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.300 | FP-Norm(final)=2.549 | 3768.6 samples/s | 58.9 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02285 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.304 | FP-Norm(final)=2.553 | 3806.4 samples/s | 59.5 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02153 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.306 | FP-Norm(final)=2.555 | 4537.6 samples/s | 70.9 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02021 | Reg=0.00172 | acc=0.9844 | FP-Norm=1.306 | FP-Norm(final)=2.559 | 1642.6 samples/s | 25.7 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01900 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.304 | FP-Norm(final)=2.563 | 3784.5 samples/s | 59.1 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01797 | Reg=0.00171 | acc=0.9844 | FP-Norm=1.303 | FP-Norm(final)=2.566 | 3776.9 samples/s | 59.0 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01728 | Reg=0.00171 | acc=0.9844 | FP-Norm=1.302 | FP-Norm(final)=2.570 | 4303.1 samples/s | 67.2 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01670 | Reg=0.00171 | acc=0.9688 | FP-Norm=1.303 | FP-Norm(final)=2.573 | 1693.5 samples/s | 26.5 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01605 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.303 | FP-Norm(final)=2.576 | 3797.9 samples/s | 59.3 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01571 | Reg=0.00171 | acc=0.9844 | FP-Norm=1.304 | FP-Norm(final)=2.579 | 3789.7 samples/s | 59.2 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01525 | Reg=0.00171 | acc=0.9844 | FP-Norm=1.305 | FP-Norm(final)=2.581 | 4051.4 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step9600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=43.2] | Loss=0.15159 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.561 | 3775.7 samples/s | 59.0 steps/s
[Step=8850 Epoch=43.4] | Loss=0.05303 | Reg=0.00128 | acc=0.9531 | FP-Norm=1.085 | FP-Norm(final)=2.536 | 3511.5 samples/s | 54.9 steps/s
[Step=8900 Epoch=43.6] | Loss=0.03905 | Reg=0.00145 | acc=0.9844 | FP-Norm=1.177 | FP-Norm(final)=2.532 | 3781.5 samples/s | 59.1 steps/s
[Step=8950 Epoch=43.9] | Loss=0.03390 | Reg=0.00147 | acc=0.9844 | FP-Norm=1.195 | FP-Norm(final)=2.533 | 3762.3 samples/s | 58.8 steps/s
[Step=9000 Epoch=44.1] | Loss=0.03062 | Reg=0.00150 | acc=0.9688 | FP-Norm=1.210 | FP-Norm(final)=2.536 | 4900.0 samples/s | 76.6 steps/s
[Step=9050 Epoch=44.4] | Loss=0.02618 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.214 | FP-Norm(final)=2.539 | 1602.6 samples/s | 25.0 steps/s
[Step=9100 Epoch=44.6] | Loss=0.02379 | Reg=0.00150 | acc=0.9844 | FP-Norm=1.215 | FP-Norm(final)=2.543 | 3778.3 samples/s | 59.0 steps/s
[Step=9150 Epoch=44.9] | Loss=0.02234 | Reg=0.00150 | acc=0.9844 | FP-Norm=1.217 | FP-Norm(final)=2.548 | 3789.0 samples/s | 59.2 steps/s
[Step=9200 Epoch=45.1] | Loss=0.02127 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.221 | FP-Norm(final)=2.551 | 4736.7 samples/s | 74.0 steps/s
[Step=9250 Epoch=45.4] | Loss=0.01996 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.224 | FP-Norm(final)=2.555 | 1629.6 samples/s | 25.5 steps/s
[Step=9300 Epoch=45.6] | Loss=0.01886 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.226 | FP-Norm(final)=2.559 | 3782.2 samples/s | 59.1 steps/s
[Step=9350 Epoch=45.9] | Loss=0.01825 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.228 | FP-Norm(final)=2.562 | 3777.1 samples/s | 59.0 steps/s
[Step=9400 Epoch=46.1] | Loss=0.01733 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.234 | FP-Norm(final)=2.566 | 4508.4 samples/s | 70.4 steps/s
[Step=9450 Epoch=46.3] | Loss=0.01683 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.239 | FP-Norm(final)=2.569 | 1652.9 samples/s | 25.8 steps/s
[Step=9500 Epoch=46.6] | Loss=0.01617 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.245 | FP-Norm(final)=2.571 | 3773.1 samples/s | 59.0 steps/s
[Step=9550 Epoch=46.8] | Loss=0.01574 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.250 | FP-Norm(final)=2.574 | 3798.3 samples/s | 59.3 steps/s
[Step=9600 Epoch=47.1] | Loss=0.01529 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.254 | FP-Norm(final)=2.576 | 4341.0 samples/s | 67.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step9600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=83.4] | Loss=0.01367 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.562 | 3521.6 samples/s | 55.0 steps/s
[Step=8850 Epoch=83.9] | Loss=0.01514 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.181 | FP-Norm(final)=2.551 | 3502.5 samples/s | 54.7 steps/s
[Step=8900 Epoch=84.3] | Loss=0.00819 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.436 | FP-Norm(final)=2.538 | 4654.7 samples/s | 72.7 steps/s
[Step=8950 Epoch=84.8] | Loss=0.00549 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.475 | FP-Norm(final)=2.536 | 1539.3 samples/s | 24.1 steps/s
[Step=9000 Epoch=85.3] | Loss=0.00413 | Reg=0.00224 | acc=1.0000 | FP-Norm=1.468 | FP-Norm(final)=2.536 | 4344.3 samples/s | 67.9 steps/s
[Step=9050 Epoch=85.8] | Loss=0.00331 | Reg=0.00217 | acc=1.0000 | FP-Norm=1.449 | FP-Norm(final)=2.537 | 1587.0 samples/s | 24.8 steps/s
[Step=9100 Epoch=86.2] | Loss=0.00277 | Reg=0.00209 | acc=1.0000 | FP-Norm=1.425 | FP-Norm(final)=2.538 | 4028.7 samples/s | 62.9 steps/s
[Step=9150 Epoch=86.7] | Loss=0.00237 | Reg=0.00201 | acc=1.0000 | FP-Norm=1.400 | FP-Norm(final)=2.539 | 1619.6 samples/s | 25.3 steps/s
[Step=9200 Epoch=87.2] | Loss=0.00208 | Reg=0.00194 | acc=1.0000 | FP-Norm=1.375 | FP-Norm(final)=2.540 | 3874.0 samples/s | 60.5 steps/s
[Step=9250 Epoch=87.7] | Loss=0.00185 | Reg=0.00188 | acc=1.0000 | FP-Norm=1.351 | FP-Norm(final)=2.541 | 1647.2 samples/s | 25.7 steps/s
[Step=9300 Epoch=88.1] | Loss=0.00167 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.328 | FP-Norm(final)=2.543 | 3668.2 samples/s | 57.3 steps/s
[Step=9350 Epoch=88.6] | Loss=0.00152 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.305 | FP-Norm(final)=2.544 | 1693.2 samples/s | 26.5 steps/s
[Step=9400 Epoch=89.1] | Loss=0.00140 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.284 | FP-Norm(final)=2.545 | 3579.0 samples/s | 55.9 steps/s
[Step=9450 Epoch=89.5] | Loss=0.00129 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.263 | FP-Norm(final)=2.546 | 1698.6 samples/s | 26.5 steps/s
[Step=9500 Epoch=90.0] | Loss=0.00120 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.243 | FP-Norm(final)=2.547 | 3615.7 samples/s | 56.5 steps/s
[Step=9550 Epoch=90.5] | Loss=0.00112 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.223 | FP-Norm(final)=2.548 | 1721.8 samples/s | 26.9 steps/s
[Step=9600 Epoch=91.0] | Loss=0.00105 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.205 | FP-Norm(final)=2.549 | 3581.3 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step9600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=83.7] | Loss=0.01751 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.562 | 3429.8 samples/s | 53.6 steps/s
[Step=8850 Epoch=84.2] | Loss=0.00684 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.243 | FP-Norm(final)=2.558 | 3449.5 samples/s | 53.9 steps/s
[Step=8900 Epoch=84.7] | Loss=0.00433 | Reg=0.00203 | acc=1.0000 | FP-Norm=1.386 | FP-Norm(final)=2.563 | 4680.9 samples/s | 73.1 steps/s
[Step=8950 Epoch=85.1] | Loss=0.00298 | Reg=0.00214 | acc=1.0000 | FP-Norm=1.434 | FP-Norm(final)=2.567 | 1555.0 samples/s | 24.3 steps/s
[Step=9000 Epoch=85.6] | Loss=0.00253 | Reg=0.00213 | acc=1.0000 | FP-Norm=1.440 | FP-Norm(final)=2.570 | 4339.3 samples/s | 67.8 steps/s
[Step=9050 Epoch=86.1] | Loss=0.00205 | Reg=0.00213 | acc=1.0000 | FP-Norm=1.442 | FP-Norm(final)=2.572 | 1576.3 samples/s | 24.6 steps/s
[Step=9100 Epoch=86.6] | Loss=0.00172 | Reg=0.00209 | acc=1.0000 | FP-Norm=1.431 | FP-Norm(final)=2.573 | 4080.1 samples/s | 63.8 steps/s
[Step=9150 Epoch=87.0] | Loss=0.00148 | Reg=0.00203 | acc=1.0000 | FP-Norm=1.412 | FP-Norm(final)=2.575 | 1617.7 samples/s | 25.3 steps/s
[Step=9200 Epoch=87.5] | Loss=0.00130 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.391 | FP-Norm(final)=2.576 | 3853.5 samples/s | 60.2 steps/s
[Step=9250 Epoch=88.0] | Loss=0.00115 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.370 | FP-Norm(final)=2.577 | 1661.7 samples/s | 26.0 steps/s
[Step=9300 Epoch=88.5] | Loss=0.00104 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.348 | FP-Norm(final)=2.577 | 3653.3 samples/s | 57.1 steps/s
[Step=9350 Epoch=88.9] | Loss=0.00095 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.326 | FP-Norm(final)=2.578 | 1698.4 samples/s | 26.5 steps/s
[Step=9400 Epoch=89.4] | Loss=0.00087 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.304 | FP-Norm(final)=2.578 | 3598.8 samples/s | 56.2 steps/s
[Step=9450 Epoch=89.9] | Loss=0.00081 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.283 | FP-Norm(final)=2.579 | 1712.1 samples/s | 26.8 steps/s
[Step=9500 Epoch=90.4] | Loss=0.00075 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.262 | FP-Norm(final)=2.579 | 3592.0 samples/s | 56.1 steps/s
[Step=9550 Epoch=90.8] | Loss=0.00070 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.242 | FP-Norm(final)=2.580 | 1709.5 samples/s | 26.7 steps/s
[Step=9600 Epoch=91.3] | Loss=0.00066 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.223 | FP-Norm(final)=2.580 | 3556.8 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step9600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=84.0] | Loss=0.14458 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.560 | 3631.4 samples/s | 56.7 steps/s
[Step=8850 Epoch=84.5] | Loss=0.01402 | Reg=0.00176 | acc=0.9844 | FP-Norm=1.252 | FP-Norm(final)=2.546 | 3416.0 samples/s | 53.4 steps/s
[Step=8900 Epoch=85.0] | Loss=0.00880 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.444 | FP-Norm(final)=2.539 | 4721.8 samples/s | 73.8 steps/s
[Step=8950 Epoch=85.5] | Loss=0.00594 | Reg=0.00228 | acc=1.0000 | FP-Norm=1.478 | FP-Norm(final)=2.540 | 1534.5 samples/s | 24.0 steps/s
[Step=9000 Epoch=85.9] | Loss=0.00448 | Reg=0.00223 | acc=1.0000 | FP-Norm=1.470 | FP-Norm(final)=2.542 | 4461.7 samples/s | 69.7 steps/s
[Step=9050 Epoch=86.4] | Loss=0.00359 | Reg=0.00216 | acc=1.0000 | FP-Norm=1.449 | FP-Norm(final)=2.543 | 1563.1 samples/s | 24.4 steps/s
[Step=9100 Epoch=86.9] | Loss=0.00300 | Reg=0.00208 | acc=1.0000 | FP-Norm=1.423 | FP-Norm(final)=2.545 | 4193.5 samples/s | 65.5 steps/s
[Step=9150 Epoch=87.4] | Loss=0.00258 | Reg=0.00200 | acc=1.0000 | FP-Norm=1.396 | FP-Norm(final)=2.546 | 1609.7 samples/s | 25.2 steps/s
[Step=9200 Epoch=87.9] | Loss=0.00226 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.370 | FP-Norm(final)=2.548 | 3936.1 samples/s | 61.5 steps/s
[Step=9250 Epoch=88.3] | Loss=0.00201 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.345 | FP-Norm(final)=2.549 | 1613.3 samples/s | 25.2 steps/s
[Step=9300 Epoch=88.8] | Loss=0.00181 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.321 | FP-Norm(final)=2.550 | 3816.2 samples/s | 59.6 steps/s
[Step=9350 Epoch=89.3] | Loss=0.00165 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.298 | FP-Norm(final)=2.551 | 1674.2 samples/s | 26.2 steps/s
[Step=9400 Epoch=89.8] | Loss=0.00152 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.276 | FP-Norm(final)=2.552 | 3638.5 samples/s | 56.9 steps/s
[Step=9450 Epoch=90.2] | Loss=0.00140 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.255 | FP-Norm(final)=2.553 | 1690.6 samples/s | 26.4 steps/s
[Step=9500 Epoch=90.7] | Loss=0.00130 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.235 | FP-Norm(final)=2.554 | 3567.1 samples/s | 55.7 steps/s
[Step=9550 Epoch=91.2] | Loss=0.00122 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.215 | FP-Norm(final)=2.555 | 1695.6 samples/s | 26.5 steps/s
[Step=9600 Epoch=91.7] | Loss=0.00114 | Reg=0.00149 | acc=1.0000 | FP-Norm=1.196 | FP-Norm(final)=2.556 | 3590.6 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step9600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=82.9] | Loss=0.03053 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.561 | 3554.4 samples/s | 55.5 steps/s
[Step=8850 Epoch=83.4] | Loss=0.02189 | Reg=0.00265 | acc=0.9688 | FP-Norm=1.522 | FP-Norm(final)=2.524 | 3442.5 samples/s | 53.8 steps/s
[Step=8900 Epoch=83.9] | Loss=0.01174 | Reg=0.00308 | acc=1.0000 | FP-Norm=1.698 | FP-Norm(final)=2.519 | 4633.6 samples/s | 72.4 steps/s
[Step=8950 Epoch=84.3] | Loss=0.00790 | Reg=0.00305 | acc=1.0000 | FP-Norm=1.707 | FP-Norm(final)=2.520 | 1547.2 samples/s | 24.2 steps/s
[Step=9000 Epoch=84.8] | Loss=0.00599 | Reg=0.00294 | acc=1.0000 | FP-Norm=1.685 | FP-Norm(final)=2.523 | 4247.1 samples/s | 66.4 steps/s
[Step=9050 Epoch=85.3] | Loss=0.00480 | Reg=0.00282 | acc=1.0000 | FP-Norm=1.655 | FP-Norm(final)=2.525 | 1603.4 samples/s | 25.1 steps/s
[Step=9100 Epoch=85.7] | Loss=0.00401 | Reg=0.00271 | acc=1.0000 | FP-Norm=1.623 | FP-Norm(final)=2.528 | 3955.2 samples/s | 61.8 steps/s
[Step=9150 Epoch=86.2] | Loss=0.00344 | Reg=0.00260 | acc=1.0000 | FP-Norm=1.591 | FP-Norm(final)=2.530 | 1625.8 samples/s | 25.4 steps/s
[Step=9200 Epoch=86.7] | Loss=0.00302 | Reg=0.00250 | acc=1.0000 | FP-Norm=1.561 | FP-Norm(final)=2.532 | 3725.9 samples/s | 58.2 steps/s
[Step=9250 Epoch=87.2] | Loss=0.00269 | Reg=0.00241 | acc=1.0000 | FP-Norm=1.532 | FP-Norm(final)=2.533 | 1712.5 samples/s | 26.8 steps/s
[Step=9300 Epoch=87.6] | Loss=0.00242 | Reg=0.00233 | acc=1.0000 | FP-Norm=1.504 | FP-Norm(final)=2.535 | 3624.5 samples/s | 56.6 steps/s
[Step=9350 Epoch=88.1] | Loss=0.00221 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.478 | FP-Norm(final)=2.537 | 1723.3 samples/s | 26.9 steps/s
[Step=9400 Epoch=88.6] | Loss=0.00202 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.453 | FP-Norm(final)=2.538 | 3588.9 samples/s | 56.1 steps/s
[Step=9450 Epoch=89.0] | Loss=0.00187 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.429 | FP-Norm(final)=2.540 | 1700.3 samples/s | 26.6 steps/s
[Step=9500 Epoch=89.5] | Loss=0.00174 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.406 | FP-Norm(final)=2.541 | 3556.7 samples/s | 55.6 steps/s
[Step=9550 Epoch=90.0] | Loss=0.00163 | Reg=0.00199 | acc=1.0000 | FP-Norm=1.383 | FP-Norm(final)=2.542 | 1889.1 samples/s | 29.5 steps/s
[Step=9600 Epoch=90.5] | Loss=0.00153 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.362 | FP-Norm(final)=2.544 | 3119.0 samples/s | 48.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step9600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=83.9] | Loss=0.03456 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.561 | 3595.9 samples/s | 56.2 steps/s
[Step=8850 Epoch=84.3] | Loss=0.01396 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.337 | FP-Norm(final)=2.545 | 3295.5 samples/s | 51.5 steps/s
[Step=8900 Epoch=84.8] | Loss=0.00786 | Reg=0.00256 | acc=1.0000 | FP-Norm=1.544 | FP-Norm(final)=2.541 | 4690.5 samples/s | 73.3 steps/s
[Step=8950 Epoch=85.3] | Loss=0.00529 | Reg=0.00258 | acc=1.0000 | FP-Norm=1.568 | FP-Norm(final)=2.544 | 1532.6 samples/s | 23.9 steps/s
[Step=9000 Epoch=85.8] | Loss=0.00398 | Reg=0.00250 | acc=1.0000 | FP-Norm=1.553 | FP-Norm(final)=2.546 | 4449.2 samples/s | 69.5 steps/s
[Step=9050 Epoch=86.3] | Loss=0.00319 | Reg=0.00240 | acc=1.0000 | FP-Norm=1.526 | FP-Norm(final)=2.548 | 1554.4 samples/s | 24.3 steps/s
[Step=9100 Epoch=86.7] | Loss=0.00267 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.498 | FP-Norm(final)=2.550 | 4211.6 samples/s | 65.8 steps/s
[Step=9150 Epoch=87.2] | Loss=0.00230 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.470 | FP-Norm(final)=2.552 | 1594.0 samples/s | 24.9 steps/s
[Step=9200 Epoch=87.7] | Loss=0.00201 | Reg=0.00214 | acc=1.0000 | FP-Norm=1.442 | FP-Norm(final)=2.553 | 3937.6 samples/s | 61.5 steps/s
[Step=9250 Epoch=88.2] | Loss=0.00179 | Reg=0.00206 | acc=1.0000 | FP-Norm=1.416 | FP-Norm(final)=2.555 | 1614.1 samples/s | 25.2 steps/s
[Step=9300 Epoch=88.6] | Loss=0.00162 | Reg=0.00199 | acc=1.0000 | FP-Norm=1.390 | FP-Norm(final)=2.556 | 3800.8 samples/s | 59.4 steps/s
[Step=9350 Epoch=89.1] | Loss=0.00147 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.366 | FP-Norm(final)=2.557 | 1662.2 samples/s | 26.0 steps/s
[Step=9400 Epoch=89.6] | Loss=0.00135 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.343 | FP-Norm(final)=2.558 | 3619.3 samples/s | 56.6 steps/s
[Step=9450 Epoch=90.1] | Loss=0.00125 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.321 | FP-Norm(final)=2.559 | 1689.9 samples/s | 26.4 steps/s
[Step=9500 Epoch=90.5] | Loss=0.00117 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.299 | FP-Norm(final)=2.560 | 3589.7 samples/s | 56.1 steps/s
[Step=9550 Epoch=91.0] | Loss=0.00109 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.278 | FP-Norm(final)=2.561 | 1720.9 samples/s | 26.9 steps/s
[Step=9600 Epoch=91.5] | Loss=0.00102 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.258 | FP-Norm(final)=2.562 | 3630.8 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21320 | acc=0.8548 | tpr=0.7969 | fpr=0.0196 | 3722.6 samples/s | 14.5 steps/s
Avg test loss: 0.21338, Avg test acc: 0.85592, Avg tpr: 0.79973, Avg fpr: 0.02051, total FA: 160

Testing server on iccad2012
[Step=  50] | Loss=0.55430 | acc=0.7752 | tpr=0.9690 | fpr=0.2282 | 3666.1 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.56512 | acc=0.7737 | tpr=0.9659 | fpr=0.2299 | 6689.8 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.57034 | acc=0.7727 | tpr=0.9654 | fpr=0.2308 | 7022.3 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.57105 | acc=0.7728 | tpr=0.9672 | fpr=0.2308 | 6848.3 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.56895 | acc=0.7727 | tpr=0.9659 | fpr=0.2308 | 6940.6 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.57134 | acc=0.7720 | tpr=0.9658 | fpr=0.2316 | 6742.9 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.57160 | acc=0.7723 | tpr=0.9668 | fpr=0.2313 | 6956.7 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.57180 | acc=0.7719 | tpr=0.9677 | fpr=0.2316 | 6854.8 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.57393 | acc=0.7720 | tpr=0.9674 | fpr=0.2316 | 6744.2 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.57541 | acc=0.7721 | tpr=0.9683 | fpr=0.2315 | 6803.8 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.57504 | acc=0.7723 | tpr=0.9678 | fpr=0.2312 | 12716.3 samples/s | 49.7 steps/s
Avg test loss: 0.57512, Avg test acc: 0.77239, Avg tpr: 0.96791, Avg fpr: 0.23117, total FA: 32097

server round 12/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.19036 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.593 | 3837.0 samples/s | 60.0 steps/s
[Step=9650 Epoch=47.1] | Loss=0.04177 | Reg=0.00074 | acc=0.9531 | FP-Norm=0.817 | FP-Norm(final)=2.580 | 3527.6 samples/s | 55.1 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03395 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.963 | FP-Norm(final)=2.577 | 3780.4 samples/s | 59.1 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03113 | Reg=0.00111 | acc=0.9375 | FP-Norm=1.029 | FP-Norm(final)=2.577 | 3783.6 samples/s | 59.1 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02790 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.075 | FP-Norm(final)=2.578 | 4909.2 samples/s | 76.7 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02426 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.111 | FP-Norm(final)=2.581 | 1637.6 samples/s | 25.6 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02232 | Reg=0.00131 | acc=0.9844 | FP-Norm=1.132 | FP-Norm(final)=2.587 | 3786.0 samples/s | 59.2 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02113 | Reg=0.00135 | acc=0.9688 | FP-Norm=1.147 | FP-Norm(final)=2.591 | 3784.1 samples/s | 59.1 steps/s
[Step=10000 Epoch=48.8] | Loss=0.02033 | Reg=0.00138 | acc=1.0000 | FP-Norm=1.161 | FP-Norm(final)=2.594 | 4548.6 samples/s | 71.1 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01918 | Reg=0.00140 | acc=1.0000 | FP-Norm=1.172 | FP-Norm(final)=2.596 | 1650.6 samples/s | 25.8 steps/s
[Step=10100 Epoch=49.2] | Loss=0.01808 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.181 | FP-Norm(final)=2.599 | 3760.9 samples/s | 58.8 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01723 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.189 | FP-Norm(final)=2.602 | 3775.3 samples/s | 59.0 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01643 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.196 | FP-Norm(final)=2.606 | 4280.6 samples/s | 66.9 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01575 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.203 | FP-Norm(final)=2.609 | 1705.6 samples/s | 26.7 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01532 | Reg=0.00148 | acc=0.9844 | FP-Norm=1.207 | FP-Norm(final)=2.612 | 3816.8 samples/s | 59.6 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01464 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.210 | FP-Norm(final)=2.615 | 3748.3 samples/s | 58.6 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01426 | Reg=0.00149 | acc=0.9844 | FP-Norm=1.213 | FP-Norm(final)=2.617 | 4046.7 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step10400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.09878 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.593 | 3524.5 samples/s | 55.1 steps/s
[Step=9650 Epoch=47.1] | Loss=0.04204 | Reg=0.00087 | acc=0.9531 | FP-Norm=0.889 | FP-Norm(final)=2.574 | 3779.5 samples/s | 59.1 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03300 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.015 | FP-Norm(final)=2.573 | 3786.4 samples/s | 59.2 steps/s
[Step=9750 Epoch=47.6] | Loss=0.03183 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.092 | FP-Norm(final)=2.572 | 3768.2 samples/s | 58.9 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02941 | Reg=0.00138 | acc=0.9688 | FP-Norm=1.156 | FP-Norm(final)=2.569 | 4839.8 samples/s | 75.6 steps/s
[Step=9850 Epoch=48.1] | Loss=0.02646 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.196 | FP-Norm(final)=2.568 | 1604.6 samples/s | 25.1 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02425 | Reg=0.00154 | acc=0.9844 | FP-Norm=1.222 | FP-Norm(final)=2.570 | 3749.9 samples/s | 58.6 steps/s
[Step=9950 Epoch=48.6] | Loss=0.02308 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.238 | FP-Norm(final)=2.571 | 3793.4 samples/s | 59.3 steps/s
[Step=10000 Epoch=48.8] | Loss=0.02131 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.250 | FP-Norm(final)=2.574 | 4579.7 samples/s | 71.6 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01996 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.257 | FP-Norm(final)=2.577 | 1655.6 samples/s | 25.9 steps/s
[Step=10100 Epoch=49.3] | Loss=0.01900 | Reg=0.00162 | acc=0.9688 | FP-Norm=1.263 | FP-Norm(final)=2.580 | 3765.4 samples/s | 58.8 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01852 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.268 | FP-Norm(final)=2.582 | 3746.2 samples/s | 58.5 steps/s
[Step=10200 Epoch=49.8] | Loss=0.01768 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.274 | FP-Norm(final)=2.584 | 4378.5 samples/s | 68.4 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01713 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.280 | FP-Norm(final)=2.586 | 1678.4 samples/s | 26.2 steps/s
[Step=10300 Epoch=50.3] | Loss=0.01648 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.285 | FP-Norm(final)=2.587 | 3785.6 samples/s | 59.2 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01601 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.289 | FP-Norm(final)=2.589 | 3765.4 samples/s | 58.8 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01579 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.292 | FP-Norm(final)=2.591 | 4181.3 samples/s | 65.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step10400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.12127 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.593 | 3825.7 samples/s | 59.8 steps/s
[Step=9650 Epoch=47.0] | Loss=0.03929 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.876 | FP-Norm(final)=2.586 | 3500.8 samples/s | 54.7 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03498 | Reg=0.00112 | acc=0.9531 | FP-Norm=1.027 | FP-Norm(final)=2.578 | 3761.2 samples/s | 58.8 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03328 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.113 | FP-Norm(final)=2.572 | 3763.7 samples/s | 58.8 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03020 | Reg=0.00141 | acc=0.9688 | FP-Norm=1.166 | FP-Norm(final)=2.569 | 4856.0 samples/s | 75.9 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02620 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.196 | FP-Norm(final)=2.571 | 1636.3 samples/s | 25.6 steps/s
[Step=9900 Epoch=48.2] | Loss=0.02457 | Reg=0.00152 | acc=0.9688 | FP-Norm=1.215 | FP-Norm(final)=2.573 | 3784.8 samples/s | 59.1 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02309 | Reg=0.00156 | acc=0.9844 | FP-Norm=1.233 | FP-Norm(final)=2.576 | 3774.8 samples/s | 59.0 steps/s
[Step=10000 Epoch=48.7] | Loss=0.02232 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.247 | FP-Norm(final)=2.579 | 4578.4 samples/s | 71.5 steps/s
[Step=10050 Epoch=49.0] | Loss=0.02094 | Reg=0.00162 | acc=0.9844 | FP-Norm=1.259 | FP-Norm(final)=2.581 | 1657.6 samples/s | 25.9 steps/s
[Step=10100 Epoch=49.2] | Loss=0.01985 | Reg=0.00164 | acc=0.9844 | FP-Norm=1.269 | FP-Norm(final)=2.583 | 3783.5 samples/s | 59.1 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01886 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.278 | FP-Norm(final)=2.586 | 3766.1 samples/s | 58.8 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01838 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.285 | FP-Norm(final)=2.589 | 4335.3 samples/s | 67.7 steps/s
[Step=10250 Epoch=49.9] | Loss=0.01767 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.293 | FP-Norm(final)=2.592 | 1676.6 samples/s | 26.2 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01712 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.300 | FP-Norm(final)=2.595 | 3793.2 samples/s | 59.3 steps/s
[Step=10350 Epoch=50.4] | Loss=0.01670 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.307 | FP-Norm(final)=2.597 | 3764.9 samples/s | 58.8 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01614 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.313 | FP-Norm(final)=2.599 | 4068.7 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step10400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.08176 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.593 | 3502.3 samples/s | 54.7 steps/s
[Step=9650 Epoch=47.1] | Loss=0.03526 | Reg=0.00074 | acc=0.9688 | FP-Norm=0.813 | FP-Norm(final)=2.583 | 3714.3 samples/s | 58.0 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03070 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.947 | FP-Norm(final)=2.579 | 3774.4 samples/s | 59.0 steps/s
[Step=9750 Epoch=47.5] | Loss=0.02885 | Reg=0.00111 | acc=0.9688 | FP-Norm=1.029 | FP-Norm(final)=2.576 | 3749.1 samples/s | 58.6 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02718 | Reg=0.00121 | acc=0.9688 | FP-Norm=1.078 | FP-Norm(final)=2.575 | 4855.5 samples/s | 75.9 steps/s
[Step=9850 Epoch=48.0] | Loss=0.03046 | Reg=0.00152 | acc=0.9844 | FP-Norm=1.192 | FP-Norm(final)=2.571 | 1619.8 samples/s | 25.3 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02932 | Reg=0.00181 | acc=0.9844 | FP-Norm=1.294 | FP-Norm(final)=2.568 | 3760.3 samples/s | 58.8 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02945 | Reg=0.00201 | acc=1.0000 | FP-Norm=1.365 | FP-Norm(final)=2.564 | 3788.1 samples/s | 59.2 steps/s
[Step=10000 Epoch=48.8] | Loss=0.02855 | Reg=0.00216 | acc=0.9844 | FP-Norm=1.418 | FP-Norm(final)=2.559 | 4555.1 samples/s | 71.2 steps/s
[Step=10050 Epoch=49.0] | Loss=0.02671 | Reg=0.00226 | acc=1.0000 | FP-Norm=1.456 | FP-Norm(final)=2.557 | 1647.7 samples/s | 25.7 steps/s
[Step=10100 Epoch=49.3] | Loss=0.02523 | Reg=0.00233 | acc=1.0000 | FP-Norm=1.482 | FP-Norm(final)=2.557 | 3796.2 samples/s | 59.3 steps/s
[Step=10150 Epoch=49.5] | Loss=0.02423 | Reg=0.00238 | acc=0.9844 | FP-Norm=1.502 | FP-Norm(final)=2.557 | 3749.3 samples/s | 58.6 steps/s
[Step=10200 Epoch=49.7] | Loss=0.02343 | Reg=0.00242 | acc=1.0000 | FP-Norm=1.518 | FP-Norm(final)=2.556 | 4325.6 samples/s | 67.6 steps/s
[Step=10250 Epoch=50.0] | Loss=0.02219 | Reg=0.00245 | acc=1.0000 | FP-Norm=1.531 | FP-Norm(final)=2.556 | 1701.7 samples/s | 26.6 steps/s
[Step=10300 Epoch=50.2] | Loss=0.02121 | Reg=0.00248 | acc=0.9844 | FP-Norm=1.540 | FP-Norm(final)=2.557 | 3773.1 samples/s | 59.0 steps/s
[Step=10350 Epoch=50.5] | Loss=0.02038 | Reg=0.00250 | acc=1.0000 | FP-Norm=1.549 | FP-Norm(final)=2.559 | 3781.8 samples/s | 59.1 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01953 | Reg=0.00251 | acc=0.9844 | FP-Norm=1.555 | FP-Norm(final)=2.560 | 4053.8 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step10400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=47.1] | Loss=0.10680 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.593 | 3614.0 samples/s | 56.5 steps/s
[Step=9650 Epoch=47.3] | Loss=0.04700 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.866 | FP-Norm(final)=2.581 | 3751.3 samples/s | 58.6 steps/s
[Step=9700 Epoch=47.6] | Loss=0.03541 | Reg=0.00107 | acc=0.9844 | FP-Norm=1.005 | FP-Norm(final)=2.577 | 3779.8 samples/s | 59.1 steps/s
[Step=9750 Epoch=47.8] | Loss=0.03029 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.066 | FP-Norm(final)=2.581 | 3732.6 samples/s | 58.3 steps/s
[Step=9800 Epoch=48.1] | Loss=0.02934 | Reg=0.00128 | acc=0.9688 | FP-Norm=1.115 | FP-Norm(final)=2.580 | 4921.5 samples/s | 76.9 steps/s
[Step=9850 Epoch=48.3] | Loss=0.02582 | Reg=0.00136 | acc=0.9688 | FP-Norm=1.152 | FP-Norm(final)=2.581 | 1620.2 samples/s | 25.3 steps/s
[Step=9900 Epoch=48.5] | Loss=0.02393 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.176 | FP-Norm(final)=2.582 | 3773.0 samples/s | 59.0 steps/s
[Step=9950 Epoch=48.8] | Loss=0.02244 | Reg=0.00146 | acc=0.9844 | FP-Norm=1.194 | FP-Norm(final)=2.584 | 3761.3 samples/s | 58.8 steps/s
[Step=10000 Epoch=49.0] | Loss=0.02104 | Reg=0.00149 | acc=1.0000 | FP-Norm=1.209 | FP-Norm(final)=2.586 | 4705.8 samples/s | 73.5 steps/s
[Step=10050 Epoch=49.3] | Loss=0.01972 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.222 | FP-Norm(final)=2.588 | 1644.6 samples/s | 25.7 steps/s
[Step=10100 Epoch=49.5] | Loss=0.01893 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.231 | FP-Norm(final)=2.591 | 3794.8 samples/s | 59.3 steps/s
[Step=10150 Epoch=49.8] | Loss=0.01776 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.240 | FP-Norm(final)=2.594 | 3803.4 samples/s | 59.4 steps/s
[Step=10200 Epoch=50.0] | Loss=0.01736 | Reg=0.00158 | acc=0.9688 | FP-Norm=1.247 | FP-Norm(final)=2.596 | 4505.5 samples/s | 70.4 steps/s
[Step=10250 Epoch=50.3] | Loss=0.01668 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.254 | FP-Norm(final)=2.598 | 1670.1 samples/s | 26.1 steps/s
[Step=10300 Epoch=50.5] | Loss=0.01619 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.260 | FP-Norm(final)=2.601 | 3745.9 samples/s | 58.5 steps/s
[Step=10350 Epoch=50.8] | Loss=0.01575 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.267 | FP-Norm(final)=2.602 | 3773.5 samples/s | 59.0 steps/s
[Step=10400 Epoch=51.0] | Loss=0.01546 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.273 | FP-Norm(final)=2.604 | 4333.3 samples/s | 67.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step10400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.0] | Loss=0.10597 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.592 | 3629.3 samples/s | 56.7 steps/s
[Step=9650 Epoch=91.4] | Loss=0.01490 | Reg=0.00300 | acc=1.0000 | FP-Norm=1.651 | FP-Norm(final)=2.566 | 3440.3 samples/s | 53.8 steps/s
[Step=9700 Epoch=91.9] | Loss=0.00797 | Reg=0.00333 | acc=1.0000 | FP-Norm=1.782 | FP-Norm(final)=2.560 | 4676.0 samples/s | 73.1 steps/s
[Step=9750 Epoch=92.4] | Loss=0.00539 | Reg=0.00320 | acc=1.0000 | FP-Norm=1.758 | FP-Norm(final)=2.561 | 1536.5 samples/s | 24.0 steps/s
[Step=9800 Epoch=92.9] | Loss=0.00407 | Reg=0.00302 | acc=1.0000 | FP-Norm=1.713 | FP-Norm(final)=2.563 | 4330.3 samples/s | 67.7 steps/s
[Step=9850 Epoch=93.3] | Loss=0.00327 | Reg=0.00286 | acc=1.0000 | FP-Norm=1.669 | FP-Norm(final)=2.565 | 1572.3 samples/s | 24.6 steps/s
[Step=9900 Epoch=93.8] | Loss=0.00273 | Reg=0.00272 | acc=1.0000 | FP-Norm=1.626 | FP-Norm(final)=2.567 | 4079.7 samples/s | 63.7 steps/s
[Step=9950 Epoch=94.3] | Loss=0.00234 | Reg=0.00259 | acc=1.0000 | FP-Norm=1.586 | FP-Norm(final)=2.569 | 1626.5 samples/s | 25.4 steps/s
[Step=10000 Epoch=94.8] | Loss=0.00205 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.549 | FP-Norm(final)=2.571 | 3851.7 samples/s | 60.2 steps/s
[Step=10050 Epoch=95.2] | Loss=0.00183 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.515 | FP-Norm(final)=2.572 | 1659.4 samples/s | 25.9 steps/s
[Step=10100 Epoch=95.7] | Loss=0.00165 | Reg=0.00228 | acc=1.0000 | FP-Norm=1.483 | FP-Norm(final)=2.573 | 3613.1 samples/s | 56.5 steps/s
[Step=10150 Epoch=96.2] | Loss=0.00150 | Reg=0.00219 | acc=1.0000 | FP-Norm=1.453 | FP-Norm(final)=2.575 | 1704.5 samples/s | 26.6 steps/s
[Step=10200 Epoch=96.7] | Loss=0.00138 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.425 | FP-Norm(final)=2.576 | 3581.5 samples/s | 56.0 steps/s
[Step=10250 Epoch=97.1] | Loss=0.00127 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.398 | FP-Norm(final)=2.577 | 1742.3 samples/s | 27.2 steps/s
[Step=10300 Epoch=97.6] | Loss=0.00118 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.373 | FP-Norm(final)=2.578 | 3652.5 samples/s | 57.1 steps/s
[Step=10350 Epoch=98.1] | Loss=0.00111 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.349 | FP-Norm(final)=2.579 | 1720.7 samples/s | 26.9 steps/s
[Step=10400 Epoch=98.5] | Loss=0.00104 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.326 | FP-Norm(final)=2.580 | 3539.0 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step10400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.3] | Loss=0.03626 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.593 | 3840.8 samples/s | 60.0 steps/s
[Step=9650 Epoch=91.8] | Loss=0.00670 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.290 | FP-Norm(final)=2.582 | 3191.1 samples/s | 49.9 steps/s
[Step=9700 Epoch=92.3] | Loss=0.00436 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.401 | FP-Norm(final)=2.587 | 4668.4 samples/s | 72.9 steps/s
[Step=9750 Epoch=92.7] | Loss=0.00344 | Reg=0.00221 | acc=1.0000 | FP-Norm=1.465 | FP-Norm(final)=2.589 | 1575.4 samples/s | 24.6 steps/s
[Step=9800 Epoch=93.2] | Loss=0.00273 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.506 | FP-Norm(final)=2.591 | 4375.7 samples/s | 68.4 steps/s
[Step=9850 Epoch=93.7] | Loss=0.00220 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.515 | FP-Norm(final)=2.594 | 1586.6 samples/s | 24.8 steps/s
[Step=9900 Epoch=94.2] | Loss=0.00183 | Reg=0.00230 | acc=1.0000 | FP-Norm=1.504 | FP-Norm(final)=2.595 | 4079.4 samples/s | 63.7 steps/s
[Step=9950 Epoch=94.6] | Loss=0.00157 | Reg=0.00224 | acc=1.0000 | FP-Norm=1.486 | FP-Norm(final)=2.596 | 1632.7 samples/s | 25.5 steps/s
[Step=10000 Epoch=95.1] | Loss=0.00138 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.464 | FP-Norm(final)=2.597 | 3808.0 samples/s | 59.5 steps/s
[Step=10050 Epoch=95.6] | Loss=0.00123 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.441 | FP-Norm(final)=2.598 | 1664.5 samples/s | 26.0 steps/s
[Step=10100 Epoch=96.1] | Loss=0.00111 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.418 | FP-Norm(final)=2.599 | 3681.5 samples/s | 57.5 steps/s
[Step=10150 Epoch=96.6] | Loss=0.00101 | Reg=0.00198 | acc=1.0000 | FP-Norm=1.394 | FP-Norm(final)=2.599 | 1689.9 samples/s | 26.4 steps/s
[Step=10200 Epoch=97.0] | Loss=0.00093 | Reg=0.00192 | acc=1.0000 | FP-Norm=1.372 | FP-Norm(final)=2.600 | 3577.9 samples/s | 55.9 steps/s
[Step=10250 Epoch=97.5] | Loss=0.00086 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.349 | FP-Norm(final)=2.600 | 1724.1 samples/s | 26.9 steps/s
[Step=10300 Epoch=98.0] | Loss=0.00080 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.327 | FP-Norm(final)=2.601 | 3572.7 samples/s | 55.8 steps/s
[Step=10350 Epoch=98.5] | Loss=0.00074 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.306 | FP-Norm(final)=2.601 | 1729.7 samples/s | 27.0 steps/s
[Step=10400 Epoch=98.9] | Loss=0.00070 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.285 | FP-Norm(final)=2.602 | 3525.1 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step10400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.7] | Loss=0.31713 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.591 | 3452.8 samples/s | 53.9 steps/s
[Step=9650 Epoch=92.2] | Loss=0.01673 | Reg=0.00296 | acc=1.0000 | FP-Norm=1.647 | FP-Norm(final)=2.568 | 3403.5 samples/s | 53.2 steps/s
[Step=9700 Epoch=92.6] | Loss=0.00914 | Reg=0.00328 | acc=1.0000 | FP-Norm=1.771 | FP-Norm(final)=2.567 | 4717.9 samples/s | 73.7 steps/s
[Step=9750 Epoch=93.1] | Loss=0.00613 | Reg=0.00319 | acc=1.0000 | FP-Norm=1.759 | FP-Norm(final)=2.570 | 1531.9 samples/s | 23.9 steps/s
[Step=9800 Epoch=93.6] | Loss=0.00461 | Reg=0.00304 | acc=1.0000 | FP-Norm=1.723 | FP-Norm(final)=2.572 | 4421.4 samples/s | 69.1 steps/s
[Step=9850 Epoch=94.1] | Loss=0.00370 | Reg=0.00290 | acc=1.0000 | FP-Norm=1.682 | FP-Norm(final)=2.573 | 1571.9 samples/s | 24.6 steps/s
[Step=9900 Epoch=94.5] | Loss=0.00309 | Reg=0.00276 | acc=1.0000 | FP-Norm=1.642 | FP-Norm(final)=2.575 | 4191.1 samples/s | 65.5 steps/s
[Step=9950 Epoch=95.0] | Loss=0.00265 | Reg=0.00264 | acc=1.0000 | FP-Norm=1.604 | FP-Norm(final)=2.576 | 1610.1 samples/s | 25.2 steps/s
[Step=10000 Epoch=95.5] | Loss=0.00232 | Reg=0.00253 | acc=1.0000 | FP-Norm=1.569 | FP-Norm(final)=2.577 | 3949.6 samples/s | 61.7 steps/s
[Step=10050 Epoch=96.0] | Loss=0.00207 | Reg=0.00243 | acc=1.0000 | FP-Norm=1.536 | FP-Norm(final)=2.578 | 1622.2 samples/s | 25.3 steps/s
[Step=10100 Epoch=96.4] | Loss=0.00187 | Reg=0.00233 | acc=1.0000 | FP-Norm=1.505 | FP-Norm(final)=2.579 | 3804.7 samples/s | 59.4 steps/s
[Step=10150 Epoch=96.9] | Loss=0.00170 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.476 | FP-Norm(final)=2.580 | 1677.0 samples/s | 26.2 steps/s
[Step=10200 Epoch=97.4] | Loss=0.00156 | Reg=0.00217 | acc=1.0000 | FP-Norm=1.448 | FP-Norm(final)=2.581 | 3609.0 samples/s | 56.4 steps/s
[Step=10250 Epoch=97.9] | Loss=0.00144 | Reg=0.00210 | acc=1.0000 | FP-Norm=1.422 | FP-Norm(final)=2.582 | 1693.4 samples/s | 26.5 steps/s
[Step=10300 Epoch=98.4] | Loss=0.00134 | Reg=0.00203 | acc=1.0000 | FP-Norm=1.397 | FP-Norm(final)=2.582 | 3578.3 samples/s | 55.9 steps/s
[Step=10350 Epoch=98.8] | Loss=0.00125 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.373 | FP-Norm(final)=2.583 | 1705.8 samples/s | 26.7 steps/s
[Step=10400 Epoch=99.3] | Loss=0.00118 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.350 | FP-Norm(final)=2.584 | 3267.4 samples/s | 51.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step10400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=90.5] | Loss=0.15472 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.591 | 3119.0 samples/s | 48.7 steps/s
[Step=9650 Epoch=90.9] | Loss=0.01502 | Reg=0.00259 | acc=1.0000 | FP-Norm=1.541 | FP-Norm(final)=2.566 | 3091.3 samples/s | 48.3 steps/s
[Step=9700 Epoch=91.4] | Loss=0.00794 | Reg=0.00278 | acc=1.0000 | FP-Norm=1.632 | FP-Norm(final)=2.559 | 4144.3 samples/s | 64.8 steps/s
[Step=9750 Epoch=91.9] | Loss=0.00535 | Reg=0.00268 | acc=1.0000 | FP-Norm=1.614 | FP-Norm(final)=2.561 | 1404.4 samples/s | 21.9 steps/s
[Step=9800 Epoch=92.3] | Loss=0.00403 | Reg=0.00255 | acc=1.0000 | FP-Norm=1.577 | FP-Norm(final)=2.562 | 3832.6 samples/s | 59.9 steps/s
[Step=9850 Epoch=92.8] | Loss=0.00323 | Reg=0.00243 | acc=1.0000 | FP-Norm=1.540 | FP-Norm(final)=2.564 | 1624.3 samples/s | 25.4 steps/s
[Step=9900 Epoch=93.3] | Loss=0.00270 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.504 | FP-Norm(final)=2.566 | 4024.3 samples/s | 62.9 steps/s
[Step=9950 Epoch=93.8] | Loss=0.00232 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.471 | FP-Norm(final)=2.567 | 1657.2 samples/s | 25.9 steps/s
[Step=10000 Epoch=94.2] | Loss=0.00203 | Reg=0.00213 | acc=1.0000 | FP-Norm=1.441 | FP-Norm(final)=2.569 | 3531.2 samples/s | 55.2 steps/s
[Step=10050 Epoch=94.7] | Loss=0.00181 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.412 | FP-Norm(final)=2.570 | 1644.9 samples/s | 25.7 steps/s
[Step=10100 Epoch=95.2] | Loss=0.00163 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.386 | FP-Norm(final)=2.572 | 3439.5 samples/s | 53.7 steps/s
[Step=10150 Epoch=95.6] | Loss=0.00149 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.361 | FP-Norm(final)=2.573 | 1701.7 samples/s | 26.6 steps/s
[Step=10200 Epoch=96.1] | Loss=0.00136 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.337 | FP-Norm(final)=2.574 | 3467.7 samples/s | 54.2 steps/s
[Step=10250 Epoch=96.6] | Loss=0.00126 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.314 | FP-Norm(final)=2.575 | 1671.6 samples/s | 26.1 steps/s
[Step=10300 Epoch=97.1] | Loss=0.00117 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.293 | FP-Norm(final)=2.576 | 3477.2 samples/s | 54.3 steps/s
[Step=10350 Epoch=97.5] | Loss=0.00110 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.272 | FP-Norm(final)=2.577 | 1692.2 samples/s | 26.4 steps/s
[Step=10400 Epoch=98.0] | Loss=0.00103 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.252 | FP-Norm(final)=2.578 | 3408.6 samples/s | 53.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step10400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.5] | Loss=0.32420 | Reg=0.00000 | acc=0.8125 | FP-Norm=0.000 | FP-Norm(final)=2.591 | 3530.6 samples/s | 55.2 steps/s
[Step=9650 Epoch=92.0] | Loss=0.01822 | Reg=0.00282 | acc=1.0000 | FP-Norm=1.607 | FP-Norm(final)=2.560 | 3499.9 samples/s | 54.7 steps/s
[Step=9700 Epoch=92.4] | Loss=0.00964 | Reg=0.00312 | acc=1.0000 | FP-Norm=1.727 | FP-Norm(final)=2.557 | 4581.7 samples/s | 71.6 steps/s
[Step=9750 Epoch=92.9] | Loss=0.00650 | Reg=0.00303 | acc=1.0000 | FP-Norm=1.715 | FP-Norm(final)=2.559 | 1525.9 samples/s | 23.8 steps/s
[Step=9800 Epoch=93.4] | Loss=0.00489 | Reg=0.00289 | acc=1.0000 | FP-Norm=1.680 | FP-Norm(final)=2.560 | 4313.1 samples/s | 67.4 steps/s
[Step=9850 Epoch=93.9] | Loss=0.00392 | Reg=0.00275 | acc=1.0000 | FP-Norm=1.640 | FP-Norm(final)=2.562 | 1622.3 samples/s | 25.3 steps/s
[Step=9900 Epoch=94.4] | Loss=0.00328 | Reg=0.00263 | acc=1.0000 | FP-Norm=1.602 | FP-Norm(final)=2.564 | 4270.1 samples/s | 66.7 steps/s
[Step=9950 Epoch=94.8] | Loss=0.00281 | Reg=0.00251 | acc=1.0000 | FP-Norm=1.566 | FP-Norm(final)=2.565 | 1580.8 samples/s | 24.7 steps/s
[Step=10000 Epoch=95.3] | Loss=0.00247 | Reg=0.00241 | acc=1.0000 | FP-Norm=1.532 | FP-Norm(final)=2.567 | 3829.5 samples/s | 59.8 steps/s
[Step=10050 Epoch=95.8] | Loss=0.00220 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.500 | FP-Norm(final)=2.568 | 1630.4 samples/s | 25.5 steps/s
[Step=10100 Epoch=96.3] | Loss=0.00198 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.470 | FP-Norm(final)=2.569 | 3857.0 samples/s | 60.3 steps/s
[Step=10150 Epoch=96.7] | Loss=0.00180 | Reg=0.00214 | acc=1.0000 | FP-Norm=1.442 | FP-Norm(final)=2.571 | 1682.9 samples/s | 26.3 steps/s
[Step=10200 Epoch=97.2] | Loss=0.00165 | Reg=0.00207 | acc=1.0000 | FP-Norm=1.415 | FP-Norm(final)=2.572 | 3606.8 samples/s | 56.4 steps/s
[Step=10250 Epoch=97.7] | Loss=0.00153 | Reg=0.00200 | acc=1.0000 | FP-Norm=1.389 | FP-Norm(final)=2.573 | 1687.0 samples/s | 26.4 steps/s
[Step=10300 Epoch=98.2] | Loss=0.00142 | Reg=0.00194 | acc=1.0000 | FP-Norm=1.365 | FP-Norm(final)=2.574 | 3624.5 samples/s | 56.6 steps/s
[Step=10350 Epoch=98.6] | Loss=0.00133 | Reg=0.00188 | acc=1.0000 | FP-Norm=1.342 | FP-Norm(final)=2.575 | 1694.5 samples/s | 26.5 steps/s
[Step=10400 Epoch=99.1] | Loss=0.00125 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.320 | FP-Norm(final)=2.576 | 3493.0 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28155 | acc=0.8098 | tpr=0.7304 | fpr=0.0176 | 3528.6 samples/s | 13.8 steps/s
Avg test loss: 0.28069, Avg test acc: 0.81080, Avg tpr: 0.73346, Avg fpr: 0.01910, total FA: 149

Testing server on iccad2012
[Step=  50] | Loss=0.43274 | acc=0.8314 | tpr=0.9690 | fpr=0.1711 | 3656.3 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.44524 | acc=0.8287 | tpr=0.9680 | fpr=0.1738 | 6795.5 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.44966 | acc=0.8276 | tpr=0.9683 | fpr=0.1750 | 7086.5 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.45078 | acc=0.8272 | tpr=0.9694 | fpr=0.1754 | 6834.3 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.44873 | acc=0.8272 | tpr=0.9677 | fpr=0.1754 | 6756.0 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.45150 | acc=0.8268 | tpr=0.9658 | fpr=0.1758 | 7049.9 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.45217 | acc=0.8274 | tpr=0.9668 | fpr=0.1751 | 6642.1 samples/s | 25.9 steps/s
[Step= 400] | Loss=0.45261 | acc=0.8271 | tpr=0.9672 | fpr=0.1755 | 6843.8 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.45511 | acc=0.8272 | tpr=0.9664 | fpr=0.1753 | 6688.7 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.45633 | acc=0.8270 | tpr=0.9683 | fpr=0.1756 | 6046.8 samples/s | 23.6 steps/s
[Step= 550] | Loss=0.45592 | acc=0.8272 | tpr=0.9678 | fpr=0.1753 | 10709.3 samples/s | 41.8 steps/s
Avg test loss: 0.45591, Avg test acc: 0.82726, Avg tpr: 0.96791, Avg fpr: 0.17530, total FA: 24340

server round 13/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.7] | Loss=0.15874 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.609 | 3533.9 samples/s | 55.2 steps/s
[Step=10450 Epoch=51.0] | Loss=0.03693 | Reg=0.00104 | acc=0.9844 | FP-Norm=0.976 | FP-Norm(final)=2.600 | 3270.0 samples/s | 51.1 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03189 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.117 | FP-Norm(final)=2.595 | 3875.2 samples/s | 60.6 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02955 | Reg=0.00144 | acc=0.9688 | FP-Norm=1.179 | FP-Norm(final)=2.596 | 3854.2 samples/s | 60.2 steps/s
[Step=10600 Epoch=51.7] | Loss=0.02794 | Reg=0.00156 | acc=0.9688 | FP-Norm=1.231 | FP-Norm(final)=2.594 | 5010.9 samples/s | 78.3 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02473 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.260 | FP-Norm(final)=2.595 | 1694.2 samples/s | 26.5 steps/s
[Step=10700 Epoch=52.2] | Loss=0.02262 | Reg=0.00167 | acc=0.9844 | FP-Norm=1.277 | FP-Norm(final)=2.598 | 3955.4 samples/s | 61.8 steps/s
[Step=10750 Epoch=52.4] | Loss=0.02185 | Reg=0.00169 | acc=0.9844 | FP-Norm=1.289 | FP-Norm(final)=2.601 | 3944.5 samples/s | 61.6 steps/s
[Step=10800 Epoch=52.7] | Loss=0.02083 | Reg=0.00172 | acc=0.9688 | FP-Norm=1.299 | FP-Norm(final)=2.602 | 4758.1 samples/s | 74.3 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01975 | Reg=0.00174 | acc=0.9688 | FP-Norm=1.308 | FP-Norm(final)=2.604 | 1710.1 samples/s | 26.7 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01905 | Reg=0.00176 | acc=0.9844 | FP-Norm=1.317 | FP-Norm(final)=2.606 | 3797.3 samples/s | 59.3 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01855 | Reg=0.00178 | acc=0.9844 | FP-Norm=1.325 | FP-Norm(final)=2.607 | 3884.6 samples/s | 60.7 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01792 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.331 | FP-Norm(final)=2.609 | 4389.3 samples/s | 68.6 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01690 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.336 | FP-Norm(final)=2.611 | 1754.9 samples/s | 27.4 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01611 | Reg=0.00181 | acc=0.9844 | FP-Norm=1.338 | FP-Norm(final)=2.613 | 3955.9 samples/s | 61.8 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01576 | Reg=0.00181 | acc=0.9844 | FP-Norm=1.341 | FP-Norm(final)=2.615 | 3853.3 samples/s | 60.2 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01539 | Reg=0.00182 | acc=0.9844 | FP-Norm=1.343 | FP-Norm(final)=2.617 | 4152.3 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step11200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.8] | Loss=0.15399 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.609 | 4076.3 samples/s | 63.7 steps/s
[Step=10450 Epoch=51.0] | Loss=0.03846 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.050 | FP-Norm(final)=2.600 | 3722.4 samples/s | 58.2 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03287 | Reg=0.00143 | acc=0.9688 | FP-Norm=1.167 | FP-Norm(final)=2.597 | 3813.0 samples/s | 59.6 steps/s
[Step=10550 Epoch=51.5] | Loss=0.02949 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.217 | FP-Norm(final)=2.596 | 3850.4 samples/s | 60.2 steps/s
[Step=10600 Epoch=51.7] | Loss=0.02853 | Reg=0.00161 | acc=0.9844 | FP-Norm=1.251 | FP-Norm(final)=2.598 | 4963.2 samples/s | 77.6 steps/s
[Step=10650 Epoch=52.0] | Loss=0.02556 | Reg=0.00165 | acc=0.9688 | FP-Norm=1.273 | FP-Norm(final)=2.599 | 1661.1 samples/s | 26.0 steps/s
[Step=10700 Epoch=52.2] | Loss=0.02347 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.284 | FP-Norm(final)=2.601 | 3961.9 samples/s | 61.9 steps/s
[Step=10750 Epoch=52.5] | Loss=0.02180 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.297 | FP-Norm(final)=2.604 | 3916.8 samples/s | 61.2 steps/s
[Step=10800 Epoch=52.7] | Loss=0.02035 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.306 | FP-Norm(final)=2.607 | 4771.0 samples/s | 74.5 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01908 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.310 | FP-Norm(final)=2.610 | 1687.3 samples/s | 26.4 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01793 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.313 | FP-Norm(final)=2.612 | 3834.9 samples/s | 59.9 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01700 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.313 | FP-Norm(final)=2.615 | 3886.2 samples/s | 60.7 steps/s
[Step=11000 Epoch=53.7] | Loss=0.01655 | Reg=0.00174 | acc=0.9531 | FP-Norm=1.313 | FP-Norm(final)=2.617 | 4470.8 samples/s | 69.9 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01634 | Reg=0.00175 | acc=0.9844 | FP-Norm=1.316 | FP-Norm(final)=2.618 | 1730.0 samples/s | 27.0 steps/s
[Step=11100 Epoch=54.2] | Loss=0.01607 | Reg=0.00175 | acc=0.9844 | FP-Norm=1.319 | FP-Norm(final)=2.619 | 3920.7 samples/s | 61.3 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01548 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.321 | FP-Norm(final)=2.620 | 3941.6 samples/s | 61.6 steps/s
[Step=11200 Epoch=54.7] | Loss=0.01514 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.323 | FP-Norm(final)=2.620 | 4364.4 samples/s | 68.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step11200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.7] | Loss=0.21470 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.609 | 3759.2 samples/s | 58.7 steps/s
[Step=10450 Epoch=50.9] | Loss=0.03952 | Reg=0.00108 | acc=0.9688 | FP-Norm=0.994 | FP-Norm(final)=2.595 | 3823.4 samples/s | 59.7 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03453 | Reg=0.00135 | acc=0.9688 | FP-Norm=1.132 | FP-Norm(final)=2.591 | 3940.4 samples/s | 61.6 steps/s
[Step=10550 Epoch=51.4] | Loss=0.03128 | Reg=0.00147 | acc=0.9531 | FP-Norm=1.191 | FP-Norm(final)=2.590 | 3868.1 samples/s | 60.4 steps/s
[Step=10600 Epoch=51.6] | Loss=0.03003 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.233 | FP-Norm(final)=2.588 | 4931.8 samples/s | 77.1 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02709 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.263 | FP-Norm(final)=2.588 | 1663.2 samples/s | 26.0 steps/s
[Step=10700 Epoch=52.1] | Loss=0.02447 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.276 | FP-Norm(final)=2.591 | 3831.1 samples/s | 59.9 steps/s
[Step=10750 Epoch=52.4] | Loss=0.02266 | Reg=0.00167 | acc=0.9844 | FP-Norm=1.283 | FP-Norm(final)=2.594 | 3850.9 samples/s | 60.2 steps/s
[Step=10800 Epoch=52.6] | Loss=0.02134 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.290 | FP-Norm(final)=2.598 | 4639.7 samples/s | 72.5 steps/s
[Step=10850 Epoch=52.9] | Loss=0.02032 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.299 | FP-Norm(final)=2.600 | 1696.3 samples/s | 26.5 steps/s
[Step=10900 Epoch=53.1] | Loss=0.01898 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.304 | FP-Norm(final)=2.603 | 3840.4 samples/s | 60.0 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01824 | Reg=0.00173 | acc=0.9844 | FP-Norm=1.307 | FP-Norm(final)=2.606 | 3882.3 samples/s | 60.7 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01769 | Reg=0.00173 | acc=0.9844 | FP-Norm=1.309 | FP-Norm(final)=2.608 | 4364.0 samples/s | 68.2 steps/s
[Step=11050 Epoch=53.8] | Loss=0.01717 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.313 | FP-Norm(final)=2.609 | 1763.1 samples/s | 27.5 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01661 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.315 | FP-Norm(final)=2.611 | 3937.8 samples/s | 61.5 steps/s
[Step=11150 Epoch=54.3] | Loss=0.01603 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.317 | FP-Norm(final)=2.613 | 3934.2 samples/s | 61.5 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01556 | Reg=0.00175 | acc=0.9844 | FP-Norm=1.318 | FP-Norm(final)=2.615 | 4251.6 samples/s | 66.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step11200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.7] | Loss=0.19326 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.610 | 3874.9 samples/s | 60.5 steps/s
[Step=10450 Epoch=51.0] | Loss=0.03440 | Reg=0.00114 | acc=0.9688 | FP-Norm=1.027 | FP-Norm(final)=2.603 | 3664.3 samples/s | 57.3 steps/s
[Step=10500 Epoch=51.2] | Loss=0.02753 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.094 | FP-Norm(final)=2.603 | 3814.0 samples/s | 59.6 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02540 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.113 | FP-Norm(final)=2.604 | 3831.7 samples/s | 59.9 steps/s
[Step=10600 Epoch=51.7] | Loss=0.02402 | Reg=0.00131 | acc=0.9844 | FP-Norm=1.134 | FP-Norm(final)=2.604 | 4937.7 samples/s | 77.2 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02244 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.155 | FP-Norm(final)=2.604 | 1666.4 samples/s | 26.0 steps/s
[Step=10700 Epoch=52.2] | Loss=0.02057 | Reg=0.00138 | acc=0.9688 | FP-Norm=1.167 | FP-Norm(final)=2.606 | 3877.5 samples/s | 60.6 steps/s
[Step=10750 Epoch=52.4] | Loss=0.01951 | Reg=0.00140 | acc=1.0000 | FP-Norm=1.175 | FP-Norm(final)=2.608 | 3966.8 samples/s | 62.0 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01874 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.181 | FP-Norm(final)=2.610 | 4760.4 samples/s | 74.4 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01764 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.184 | FP-Norm(final)=2.612 | 1722.9 samples/s | 26.9 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01675 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.187 | FP-Norm(final)=2.614 | 3948.0 samples/s | 61.7 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01592 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.189 | FP-Norm(final)=2.616 | 3894.5 samples/s | 60.9 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01520 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.190 | FP-Norm(final)=2.618 | 4508.2 samples/s | 70.4 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01443 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.192 | FP-Norm(final)=2.621 | 1770.8 samples/s | 27.7 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01402 | Reg=0.00143 | acc=0.9844 | FP-Norm=1.192 | FP-Norm(final)=2.624 | 3909.9 samples/s | 61.1 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01362 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.194 | FP-Norm(final)=2.626 | 3824.4 samples/s | 59.8 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01316 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.196 | FP-Norm(final)=2.628 | 4152.0 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step11200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=51.0] | Loss=0.21517 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.609 | 3884.7 samples/s | 60.7 steps/s
[Step=10450 Epoch=51.2] | Loss=0.04060 | Reg=0.00103 | acc=0.9688 | FP-Norm=0.973 | FP-Norm(final)=2.599 | 3683.3 samples/s | 57.6 steps/s
[Step=10500 Epoch=51.5] | Loss=0.03181 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.088 | FP-Norm(final)=2.598 | 3940.4 samples/s | 61.6 steps/s
[Step=10550 Epoch=51.7] | Loss=0.02865 | Reg=0.00133 | acc=0.9844 | FP-Norm=1.135 | FP-Norm(final)=2.600 | 3866.6 samples/s | 60.4 steps/s
[Step=10600 Epoch=52.0] | Loss=0.02725 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.178 | FP-Norm(final)=2.598 | 5128.5 samples/s | 80.1 steps/s
[Step=10650 Epoch=52.2] | Loss=0.02417 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.211 | FP-Norm(final)=2.598 | 1648.2 samples/s | 25.8 steps/s
[Step=10700 Epoch=52.5] | Loss=0.02214 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.226 | FP-Norm(final)=2.599 | 3968.7 samples/s | 62.0 steps/s
[Step=10750 Epoch=52.7] | Loss=0.02088 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.237 | FP-Norm(final)=2.601 | 3929.3 samples/s | 61.4 steps/s
[Step=10800 Epoch=53.0] | Loss=0.01970 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.245 | FP-Norm(final)=2.604 | 4917.2 samples/s | 76.8 steps/s
[Step=10850 Epoch=53.2] | Loss=0.01885 | Reg=0.00159 | acc=0.9844 | FP-Norm=1.254 | FP-Norm(final)=2.605 | 1705.2 samples/s | 26.6 steps/s
[Step=10900 Epoch=53.5] | Loss=0.01794 | Reg=0.00161 | acc=0.9844 | FP-Norm=1.260 | FP-Norm(final)=2.608 | 3957.3 samples/s | 61.8 steps/s
[Step=10950 Epoch=53.7] | Loss=0.01720 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.265 | FP-Norm(final)=2.610 | 3862.1 samples/s | 60.3 steps/s
[Step=11000 Epoch=53.9] | Loss=0.01673 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.270 | FP-Norm(final)=2.611 | 4612.2 samples/s | 72.1 steps/s
[Step=11050 Epoch=54.2] | Loss=0.01576 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.273 | FP-Norm(final)=2.613 | 1689.2 samples/s | 26.4 steps/s
[Step=11100 Epoch=54.4] | Loss=0.01508 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.276 | FP-Norm(final)=2.615 | 3821.6 samples/s | 59.7 steps/s
[Step=11150 Epoch=54.7] | Loss=0.01459 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.279 | FP-Norm(final)=2.617 | 3827.5 samples/s | 59.8 steps/s
[Step=11200 Epoch=54.9] | Loss=0.01430 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.282 | FP-Norm(final)=2.619 | 4524.1 samples/s | 70.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step11200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=98.6] | Loss=0.00661 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.610 | 3793.3 samples/s | 59.3 steps/s
[Step=10450 Epoch=99.0] | Loss=0.01207 | Reg=0.00230 | acc=1.0000 | FP-Norm=1.429 | FP-Norm(final)=2.601 | 3323.7 samples/s | 51.9 steps/s
[Step=10500 Epoch=99.5] | Loss=0.00805 | Reg=0.00286 | acc=0.9844 | FP-Norm=1.639 | FP-Norm(final)=2.590 | 4758.6 samples/s | 74.4 steps/s
[Step=10550 Epoch=100.0] | Loss=0.00612 | Reg=0.00299 | acc=1.0000 | FP-Norm=1.694 | FP-Norm(final)=2.588 | 1581.8 samples/s | 24.7 steps/s
[Step=10600 Epoch=100.4] | Loss=0.00498 | Reg=0.00299 | acc=1.0000 | FP-Norm=1.703 | FP-Norm(final)=2.586 | 4528.9 samples/s | 70.8 steps/s
[Step=10650 Epoch=100.9] | Loss=0.00399 | Reg=0.00293 | acc=1.0000 | FP-Norm=1.689 | FP-Norm(final)=2.586 | 1654.1 samples/s | 25.8 steps/s
[Step=10700 Epoch=101.4] | Loss=0.00334 | Reg=0.00284 | acc=1.0000 | FP-Norm=1.666 | FP-Norm(final)=2.586 | 4208.2 samples/s | 65.8 steps/s
[Step=10750 Epoch=101.9] | Loss=0.00286 | Reg=0.00275 | acc=1.0000 | FP-Norm=1.640 | FP-Norm(final)=2.587 | 1679.9 samples/s | 26.2 steps/s
[Step=10800 Epoch=102.3] | Loss=0.00251 | Reg=0.00266 | acc=1.0000 | FP-Norm=1.614 | FP-Norm(final)=2.588 | 3907.0 samples/s | 61.0 steps/s
[Step=10850 Epoch=102.8] | Loss=0.00224 | Reg=0.00258 | acc=1.0000 | FP-Norm=1.588 | FP-Norm(final)=2.588 | 1680.0 samples/s | 26.3 steps/s
[Step=10900 Epoch=103.3] | Loss=0.00201 | Reg=0.00250 | acc=1.0000 | FP-Norm=1.562 | FP-Norm(final)=2.589 | 3618.9 samples/s | 56.5 steps/s
[Step=10950 Epoch=103.8] | Loss=0.00183 | Reg=0.00242 | acc=1.0000 | FP-Norm=1.538 | FP-Norm(final)=2.590 | 1744.4 samples/s | 27.3 steps/s
[Step=11000 Epoch=104.2] | Loss=0.00168 | Reg=0.00235 | acc=1.0000 | FP-Norm=1.514 | FP-Norm(final)=2.591 | 3671.7 samples/s | 57.4 steps/s
[Step=11050 Epoch=104.7] | Loss=0.00156 | Reg=0.00228 | acc=1.0000 | FP-Norm=1.491 | FP-Norm(final)=2.592 | 1768.5 samples/s | 27.6 steps/s
[Step=11100 Epoch=105.2] | Loss=0.00145 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.469 | FP-Norm(final)=2.593 | 3665.9 samples/s | 57.3 steps/s
[Step=11150 Epoch=105.7] | Loss=0.00135 | Reg=0.00216 | acc=1.0000 | FP-Norm=1.447 | FP-Norm(final)=2.594 | 1765.5 samples/s | 27.6 steps/s
[Step=11200 Epoch=106.1] | Loss=0.00127 | Reg=0.00210 | acc=1.0000 | FP-Norm=1.426 | FP-Norm(final)=2.595 | 3607.7 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step11200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=98.9] | Loss=0.06451 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.608 | 3612.6 samples/s | 56.4 steps/s
[Step=10450 Epoch=99.4] | Loss=0.00932 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.448 | FP-Norm(final)=2.590 | 3631.7 samples/s | 56.7 steps/s
[Step=10500 Epoch=99.9] | Loss=0.00575 | Reg=0.00283 | acc=1.0000 | FP-Norm=1.634 | FP-Norm(final)=2.592 | 4898.9 samples/s | 76.5 steps/s
[Step=10550 Epoch=100.4] | Loss=0.00391 | Reg=0.00281 | acc=1.0000 | FP-Norm=1.646 | FP-Norm(final)=2.595 | 1604.8 samples/s | 25.1 steps/s
[Step=10600 Epoch=100.8] | Loss=0.00295 | Reg=0.00271 | acc=1.0000 | FP-Norm=1.622 | FP-Norm(final)=2.598 | 4578.1 samples/s | 71.5 steps/s
[Step=10650 Epoch=101.3] | Loss=0.00237 | Reg=0.00260 | acc=1.0000 | FP-Norm=1.590 | FP-Norm(final)=2.600 | 1635.5 samples/s | 25.6 steps/s
[Step=10700 Epoch=101.8] | Loss=0.00198 | Reg=0.00249 | acc=1.0000 | FP-Norm=1.557 | FP-Norm(final)=2.602 | 4151.1 samples/s | 64.9 steps/s
[Step=10750 Epoch=102.3] | Loss=0.00170 | Reg=0.00238 | acc=1.0000 | FP-Norm=1.524 | FP-Norm(final)=2.603 | 1658.6 samples/s | 25.9 steps/s
[Step=10800 Epoch=102.7] | Loss=0.00149 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.492 | FP-Norm(final)=2.605 | 3880.2 samples/s | 60.6 steps/s
[Step=10850 Epoch=103.2] | Loss=0.00133 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.462 | FP-Norm(final)=2.606 | 1672.9 samples/s | 26.1 steps/s
[Step=10900 Epoch=103.7] | Loss=0.00120 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.434 | FP-Norm(final)=2.607 | 3727.4 samples/s | 58.2 steps/s
[Step=10950 Epoch=104.2] | Loss=0.00109 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.407 | FP-Norm(final)=2.608 | 1737.3 samples/s | 27.1 steps/s
[Step=11000 Epoch=104.6] | Loss=0.00100 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.381 | FP-Norm(final)=2.609 | 3741.9 samples/s | 58.5 steps/s
[Step=11050 Epoch=105.1] | Loss=0.00092 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.356 | FP-Norm(final)=2.610 | 1771.6 samples/s | 27.7 steps/s
[Step=11100 Epoch=105.6] | Loss=0.00086 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.332 | FP-Norm(final)=2.610 | 3738.2 samples/s | 58.4 steps/s
[Step=11150 Epoch=106.1] | Loss=0.00080 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.309 | FP-Norm(final)=2.611 | 1769.3 samples/s | 27.6 steps/s
[Step=11200 Epoch=106.5] | Loss=0.00076 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.287 | FP-Norm(final)=2.612 | 3686.3 samples/s | 57.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step11200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=99.3] | Loss=0.08266 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.609 | 3694.9 samples/s | 57.7 steps/s
[Step=10450 Epoch=99.8] | Loss=0.01273 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.411 | FP-Norm(final)=2.601 | 3635.6 samples/s | 56.8 steps/s
[Step=10500 Epoch=100.3] | Loss=0.00813 | Reg=0.00270 | acc=1.0000 | FP-Norm=1.597 | FP-Norm(final)=2.601 | 4819.6 samples/s | 75.3 steps/s
[Step=10550 Epoch=100.7] | Loss=0.00548 | Reg=0.00282 | acc=1.0000 | FP-Norm=1.647 | FP-Norm(final)=2.602 | 1574.7 samples/s | 24.6 steps/s
[Step=10600 Epoch=101.2] | Loss=0.00418 | Reg=0.00277 | acc=1.0000 | FP-Norm=1.641 | FP-Norm(final)=2.603 | 4464.6 samples/s | 69.8 steps/s
[Step=10650 Epoch=101.7] | Loss=0.00335 | Reg=0.00271 | acc=1.0000 | FP-Norm=1.626 | FP-Norm(final)=2.604 | 1623.7 samples/s | 25.4 steps/s
[Step=10700 Epoch=102.2] | Loss=0.00280 | Reg=0.00263 | acc=1.0000 | FP-Norm=1.603 | FP-Norm(final)=2.605 | 4304.1 samples/s | 67.3 steps/s
[Step=10750 Epoch=102.7] | Loss=0.00240 | Reg=0.00254 | acc=1.0000 | FP-Norm=1.576 | FP-Norm(final)=2.606 | 1614.9 samples/s | 25.2 steps/s
[Step=10800 Epoch=103.1] | Loss=0.00211 | Reg=0.00245 | acc=1.0000 | FP-Norm=1.549 | FP-Norm(final)=2.606 | 4097.2 samples/s | 64.0 steps/s
[Step=10850 Epoch=103.6] | Loss=0.00187 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.523 | FP-Norm(final)=2.607 | 1690.5 samples/s | 26.4 steps/s
[Step=10900 Epoch=104.1] | Loss=0.00169 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.498 | FP-Norm(final)=2.608 | 3848.5 samples/s | 60.1 steps/s
[Step=10950 Epoch=104.6] | Loss=0.00154 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.473 | FP-Norm(final)=2.608 | 1725.1 samples/s | 27.0 steps/s
[Step=11000 Epoch=105.0] | Loss=0.00141 | Reg=0.00215 | acc=1.0000 | FP-Norm=1.449 | FP-Norm(final)=2.609 | 3731.0 samples/s | 58.3 steps/s
[Step=11050 Epoch=105.5] | Loss=0.00130 | Reg=0.00209 | acc=1.0000 | FP-Norm=1.426 | FP-Norm(final)=2.609 | 1755.9 samples/s | 27.4 steps/s
[Step=11100 Epoch=106.0] | Loss=0.00121 | Reg=0.00203 | acc=1.0000 | FP-Norm=1.404 | FP-Norm(final)=2.610 | 3770.3 samples/s | 58.9 steps/s
[Step=11150 Epoch=106.5] | Loss=0.00113 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.382 | FP-Norm(final)=2.610 | 1722.5 samples/s | 26.9 steps/s
[Step=11200 Epoch=107.0] | Loss=0.00106 | Reg=0.00192 | acc=1.0000 | FP-Norm=1.362 | FP-Norm(final)=2.611 | 3460.0 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step11200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=98.0] | Loss=0.02772 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.610 | 3264.2 samples/s | 51.0 steps/s
[Step=10450 Epoch=98.5] | Loss=0.01000 | Reg=0.00213 | acc=1.0000 | FP-Norm=1.377 | FP-Norm(final)=2.598 | 3062.9 samples/s | 47.9 steps/s
[Step=10500 Epoch=98.9] | Loss=0.00872 | Reg=0.00259 | acc=0.9844 | FP-Norm=1.560 | FP-Norm(final)=2.593 | 4228.0 samples/s | 66.1 steps/s
[Step=10550 Epoch=99.4] | Loss=0.00653 | Reg=0.00300 | acc=1.0000 | FP-Norm=1.693 | FP-Norm(final)=2.585 | 1423.5 samples/s | 22.2 steps/s
[Step=10600 Epoch=99.9] | Loss=0.00500 | Reg=0.00311 | acc=1.0000 | FP-Norm=1.734 | FP-Norm(final)=2.582 | 3808.7 samples/s | 59.5 steps/s
[Step=10650 Epoch=100.4] | Loss=0.00401 | Reg=0.00310 | acc=1.0000 | FP-Norm=1.736 | FP-Norm(final)=2.581 | 1480.1 samples/s | 23.1 steps/s
[Step=10700 Epoch=100.8] | Loss=0.00334 | Reg=0.00304 | acc=1.0000 | FP-Norm=1.723 | FP-Norm(final)=2.581 | 3606.0 samples/s | 56.3 steps/s
[Step=10750 Epoch=101.3] | Loss=0.00287 | Reg=0.00297 | acc=1.0000 | FP-Norm=1.704 | FP-Norm(final)=2.581 | 1541.9 samples/s | 24.1 steps/s
[Step=10800 Epoch=101.8] | Loss=0.00251 | Reg=0.00289 | acc=1.0000 | FP-Norm=1.682 | FP-Norm(final)=2.582 | 3543.3 samples/s | 55.4 steps/s
[Step=10850 Epoch=102.2] | Loss=0.00224 | Reg=0.00281 | acc=1.0000 | FP-Norm=1.660 | FP-Norm(final)=2.583 | 1734.5 samples/s | 27.1 steps/s
[Step=10900 Epoch=102.7] | Loss=0.00202 | Reg=0.00274 | acc=1.0000 | FP-Norm=1.637 | FP-Norm(final)=2.584 | 3552.3 samples/s | 55.5 steps/s
[Step=10950 Epoch=103.2] | Loss=0.00183 | Reg=0.00266 | acc=1.0000 | FP-Norm=1.614 | FP-Norm(final)=2.584 | 1676.3 samples/s | 26.2 steps/s
[Step=11000 Epoch=103.7] | Loss=0.00168 | Reg=0.00259 | acc=1.0000 | FP-Norm=1.591 | FP-Norm(final)=2.585 | 3469.8 samples/s | 54.2 steps/s
[Step=11050 Epoch=104.1] | Loss=0.00156 | Reg=0.00252 | acc=1.0000 | FP-Norm=1.569 | FP-Norm(final)=2.586 | 1738.6 samples/s | 27.2 steps/s
[Step=11100 Epoch=104.6] | Loss=0.00145 | Reg=0.00246 | acc=1.0000 | FP-Norm=1.548 | FP-Norm(final)=2.587 | 3710.1 samples/s | 58.0 steps/s
[Step=11150 Epoch=105.1] | Loss=0.00135 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.527 | FP-Norm(final)=2.588 | 1815.6 samples/s | 28.4 steps/s
[Step=11200 Epoch=105.5] | Loss=0.00127 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.507 | FP-Norm(final)=2.589 | 3270.0 samples/s | 51.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step11200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=99.1] | Loss=0.13369 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.609 | 3429.3 samples/s | 53.6 steps/s
[Step=10450 Epoch=99.6] | Loss=0.01464 | Reg=0.00219 | acc=1.0000 | FP-Norm=1.412 | FP-Norm(final)=2.588 | 3238.3 samples/s | 50.6 steps/s
[Step=10500 Epoch=100.1] | Loss=0.00798 | Reg=0.00254 | acc=1.0000 | FP-Norm=1.556 | FP-Norm(final)=2.586 | 4647.7 samples/s | 72.6 steps/s
[Step=10550 Epoch=100.6] | Loss=0.00538 | Reg=0.00255 | acc=1.0000 | FP-Norm=1.570 | FP-Norm(final)=2.588 | 1547.2 samples/s | 24.2 steps/s
[Step=10600 Epoch=101.0] | Loss=0.00405 | Reg=0.00246 | acc=1.0000 | FP-Norm=1.550 | FP-Norm(final)=2.589 | 4439.5 samples/s | 69.4 steps/s
[Step=10650 Epoch=101.5] | Loss=0.00325 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.523 | FP-Norm(final)=2.591 | 1576.5 samples/s | 24.6 steps/s
[Step=10700 Epoch=102.0] | Loss=0.00272 | Reg=0.00228 | acc=1.0000 | FP-Norm=1.493 | FP-Norm(final)=2.592 | 4146.6 samples/s | 64.8 steps/s
[Step=10750 Epoch=102.5] | Loss=0.00233 | Reg=0.00219 | acc=1.0000 | FP-Norm=1.464 | FP-Norm(final)=2.593 | 1624.9 samples/s | 25.4 steps/s
[Step=10800 Epoch=102.9] | Loss=0.00205 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.437 | FP-Norm(final)=2.594 | 3986.5 samples/s | 62.3 steps/s
[Step=10850 Epoch=103.4] | Loss=0.00182 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.410 | FP-Norm(final)=2.595 | 1620.8 samples/s | 25.3 steps/s
[Step=10900 Epoch=103.9] | Loss=0.00164 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.385 | FP-Norm(final)=2.596 | 3823.7 samples/s | 59.7 steps/s
[Step=10950 Epoch=104.4] | Loss=0.00150 | Reg=0.00190 | acc=1.0000 | FP-Norm=1.361 | FP-Norm(final)=2.597 | 1663.2 samples/s | 26.0 steps/s
[Step=11000 Epoch=104.8] | Loss=0.00137 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.338 | FP-Norm(final)=2.598 | 3636.4 samples/s | 56.8 steps/s
[Step=11050 Epoch=105.3] | Loss=0.00127 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.316 | FP-Norm(final)=2.599 | 1746.7 samples/s | 27.3 steps/s
[Step=11100 Epoch=105.8] | Loss=0.00118 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.295 | FP-Norm(final)=2.600 | 3596.8 samples/s | 56.2 steps/s
[Step=11150 Epoch=106.3] | Loss=0.00111 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.274 | FP-Norm(final)=2.601 | 1733.0 samples/s | 27.1 steps/s
[Step=11200 Epoch=106.7] | Loss=0.00104 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.255 | FP-Norm(final)=2.602 | 3534.0 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22529 | acc=0.8472 | tpr=0.7861 | fpr=0.0201 | 3634.4 samples/s | 14.2 steps/s
Avg test loss: 0.22556, Avg test acc: 0.84722, Avg tpr: 0.78761, Avg fpr: 0.02166, total FA: 169

Testing server on iccad2012
[Step=  50] | Loss=0.49041 | acc=0.8052 | tpr=0.9735 | fpr=0.1978 | 3626.4 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.50180 | acc=0.8037 | tpr=0.9765 | fpr=0.1995 | 6838.2 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.50701 | acc=0.8029 | tpr=0.9741 | fpr=0.2003 | 6817.5 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.50732 | acc=0.8020 | tpr=0.9749 | fpr=0.2012 | 6838.2 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.50519 | acc=0.8021 | tpr=0.9721 | fpr=0.2010 | 6945.9 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.50779 | acc=0.8020 | tpr=0.9709 | fpr=0.2011 | 6855.2 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.50841 | acc=0.8026 | tpr=0.9712 | fpr=0.2004 | 6829.4 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.50866 | acc=0.8023 | tpr=0.9721 | fpr=0.2008 | 6769.7 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.51097 | acc=0.8022 | tpr=0.9718 | fpr=0.2008 | 6823.5 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.51208 | acc=0.8022 | tpr=0.9731 | fpr=0.2009 | 6797.0 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.51163 | acc=0.8024 | tpr=0.9733 | fpr=0.2007 | 12557.7 samples/s | 49.1 steps/s
Avg test loss: 0.51167, Avg test acc: 0.80243, Avg tpr: 0.97345, Avg fpr: 0.20068, total FA: 27864

server round 14/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.6] | Loss=0.08372 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.629 | 3578.2 samples/s | 55.9 steps/s
[Step=11250 Epoch=54.9] | Loss=0.03851 | Reg=0.00081 | acc=0.9688 | FP-Norm=0.853 | FP-Norm(final)=2.612 | 3740.8 samples/s | 58.5 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03309 | Reg=0.00110 | acc=0.9531 | FP-Norm=1.016 | FP-Norm(final)=2.604 | 3770.8 samples/s | 58.9 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02874 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.086 | FP-Norm(final)=2.607 | 3754.8 samples/s | 58.7 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02696 | Reg=0.00136 | acc=0.9844 | FP-Norm=1.143 | FP-Norm(final)=2.610 | 4847.3 samples/s | 75.7 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02409 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.184 | FP-Norm(final)=2.612 | 1627.6 samples/s | 25.4 steps/s
[Step=11500 Epoch=56.1] | Loss=0.02190 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.207 | FP-Norm(final)=2.615 | 3793.5 samples/s | 59.3 steps/s
[Step=11550 Epoch=56.3] | Loss=0.02011 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.220 | FP-Norm(final)=2.617 | 3781.9 samples/s | 59.1 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01952 | Reg=0.00154 | acc=0.9844 | FP-Norm=1.229 | FP-Norm(final)=2.619 | 4547.5 samples/s | 71.1 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01825 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.238 | FP-Norm(final)=2.622 | 1672.4 samples/s | 26.1 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01743 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.244 | FP-Norm(final)=2.624 | 3751.5 samples/s | 58.6 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01660 | Reg=0.00159 | acc=0.9844 | FP-Norm=1.249 | FP-Norm(final)=2.626 | 3778.8 samples/s | 59.0 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01612 | Reg=0.00159 | acc=0.9688 | FP-Norm=1.252 | FP-Norm(final)=2.628 | 4310.7 samples/s | 67.4 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01557 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.255 | FP-Norm(final)=2.630 | 1708.1 samples/s | 26.7 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01519 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.257 | FP-Norm(final)=2.632 | 3766.4 samples/s | 58.9 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01454 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.260 | FP-Norm(final)=2.633 | 3769.4 samples/s | 58.9 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01406 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.261 | FP-Norm(final)=2.635 | 4069.4 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.7] | Loss=0.22481 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.629 | 3708.1 samples/s | 57.9 steps/s
[Step=11250 Epoch=54.9] | Loss=0.03679 | Reg=0.00113 | acc=0.9688 | FP-Norm=1.014 | FP-Norm(final)=2.624 | 3545.2 samples/s | 55.4 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03286 | Reg=0.00137 | acc=0.9688 | FP-Norm=1.142 | FP-Norm(final)=2.621 | 3772.2 samples/s | 58.9 steps/s
[Step=11350 Epoch=55.4] | Loss=0.03101 | Reg=0.00151 | acc=0.9844 | FP-Norm=1.208 | FP-Norm(final)=2.619 | 3774.0 samples/s | 59.0 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02956 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.251 | FP-Norm(final)=2.616 | 4862.7 samples/s | 76.0 steps/s
[Step=11450 Epoch=55.9] | Loss=0.02602 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.280 | FP-Norm(final)=2.617 | 1617.3 samples/s | 25.3 steps/s
[Step=11500 Epoch=56.1] | Loss=0.02434 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.294 | FP-Norm(final)=2.618 | 3750.4 samples/s | 58.6 steps/s
[Step=11550 Epoch=56.4] | Loss=0.02262 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.307 | FP-Norm(final)=2.621 | 3766.7 samples/s | 58.9 steps/s
[Step=11600 Epoch=56.6] | Loss=0.02098 | Reg=0.00176 | acc=0.9844 | FP-Norm=1.316 | FP-Norm(final)=2.623 | 4609.3 samples/s | 72.0 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01995 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.323 | FP-Norm(final)=2.625 | 1644.1 samples/s | 25.7 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01892 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.328 | FP-Norm(final)=2.627 | 3715.0 samples/s | 58.0 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01807 | Reg=0.00179 | acc=0.9844 | FP-Norm=1.331 | FP-Norm(final)=2.628 | 3671.5 samples/s | 57.4 steps/s
[Step=11800 Epoch=57.6] | Loss=0.01732 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.333 | FP-Norm(final)=2.630 | 4104.2 samples/s | 64.1 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01674 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.335 | FP-Norm(final)=2.632 | 1599.7 samples/s | 25.0 steps/s
[Step=11900 Epoch=58.1] | Loss=0.01628 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.336 | FP-Norm(final)=2.633 | 3577.1 samples/s | 55.9 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01556 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.338 | FP-Norm(final)=2.634 | 3616.1 samples/s | 56.5 steps/s
[Step=12000 Epoch=58.6] | Loss=0.01507 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.339 | FP-Norm(final)=2.636 | 4022.7 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step12000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.6] | Loss=0.12039 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.629 | 3713.7 samples/s | 58.0 steps/s
[Step=11250 Epoch=54.8] | Loss=0.03823 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.909 | FP-Norm(final)=2.617 | 3610.8 samples/s | 56.4 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03346 | Reg=0.00112 | acc=0.9688 | FP-Norm=1.030 | FP-Norm(final)=2.615 | 3757.6 samples/s | 58.7 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02997 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.092 | FP-Norm(final)=2.615 | 3812.2 samples/s | 59.6 steps/s
[Step=11400 Epoch=55.5] | Loss=0.02744 | Reg=0.00134 | acc=0.9844 | FP-Norm=1.141 | FP-Norm(final)=2.616 | 4804.2 samples/s | 75.1 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02477 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.183 | FP-Norm(final)=2.618 | 1609.8 samples/s | 25.2 steps/s
[Step=11500 Epoch=56.0] | Loss=0.02304 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.215 | FP-Norm(final)=2.623 | 3698.1 samples/s | 57.8 steps/s
[Step=11550 Epoch=56.3] | Loss=0.02196 | Reg=0.00157 | acc=0.9688 | FP-Norm=1.238 | FP-Norm(final)=2.626 | 3796.7 samples/s | 59.3 steps/s
[Step=11600 Epoch=56.5] | Loss=0.02054 | Reg=0.00161 | acc=0.9688 | FP-Norm=1.256 | FP-Norm(final)=2.629 | 4565.0 samples/s | 71.3 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01935 | Reg=0.00165 | acc=0.9844 | FP-Norm=1.271 | FP-Norm(final)=2.633 | 1668.6 samples/s | 26.1 steps/s
[Step=11700 Epoch=57.0] | Loss=0.01815 | Reg=0.00167 | acc=0.9844 | FP-Norm=1.282 | FP-Norm(final)=2.636 | 3783.1 samples/s | 59.1 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01763 | Reg=0.00169 | acc=0.9844 | FP-Norm=1.289 | FP-Norm(final)=2.640 | 3800.9 samples/s | 59.4 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01704 | Reg=0.00171 | acc=0.9844 | FP-Norm=1.296 | FP-Norm(final)=2.642 | 4299.2 samples/s | 67.2 steps/s
[Step=11850 Epoch=57.7] | Loss=0.01685 | Reg=0.00173 | acc=0.9844 | FP-Norm=1.305 | FP-Norm(final)=2.644 | 1679.7 samples/s | 26.2 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01630 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.315 | FP-Norm(final)=2.646 | 3791.3 samples/s | 59.2 steps/s
[Step=11950 Epoch=58.2] | Loss=0.01572 | Reg=0.00177 | acc=0.9844 | FP-Norm=1.323 | FP-Norm(final)=2.648 | 3778.1 samples/s | 59.0 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01546 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.330 | FP-Norm(final)=2.649 | 4091.1 samples/s | 63.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step12000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.6] | Loss=0.11551 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.630 | 3952.8 samples/s | 61.8 steps/s
[Step=11250 Epoch=54.9] | Loss=0.03220 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.825 | FP-Norm(final)=2.627 | 3383.0 samples/s | 52.9 steps/s
[Step=11300 Epoch=55.1] | Loss=0.02807 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.973 | FP-Norm(final)=2.624 | 3790.4 samples/s | 59.2 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02667 | Reg=0.00114 | acc=0.9844 | FP-Norm=1.046 | FP-Norm(final)=2.621 | 3753.4 samples/s | 58.6 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02547 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.104 | FP-Norm(final)=2.619 | 4870.2 samples/s | 76.1 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02329 | Reg=0.00135 | acc=1.0000 | FP-Norm=1.143 | FP-Norm(final)=2.620 | 1591.9 samples/s | 24.9 steps/s
[Step=11500 Epoch=56.1] | Loss=0.02133 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.170 | FP-Norm(final)=2.621 | 3779.4 samples/s | 59.1 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01991 | Reg=0.00144 | acc=0.9844 | FP-Norm=1.186 | FP-Norm(final)=2.623 | 3805.6 samples/s | 59.5 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01925 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.200 | FP-Norm(final)=2.625 | 4534.2 samples/s | 70.8 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01828 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.211 | FP-Norm(final)=2.627 | 1657.1 samples/s | 25.9 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01743 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.220 | FP-Norm(final)=2.628 | 3788.3 samples/s | 59.2 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01648 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.226 | FP-Norm(final)=2.630 | 3769.9 samples/s | 58.9 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01572 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.233 | FP-Norm(final)=2.632 | 4303.5 samples/s | 67.2 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01579 | Reg=0.00158 | acc=0.9688 | FP-Norm=1.248 | FP-Norm(final)=2.634 | 1700.0 samples/s | 26.6 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01569 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.278 | FP-Norm(final)=2.635 | 3793.6 samples/s | 59.3 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01584 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.302 | FP-Norm(final)=2.636 | 3786.4 samples/s | 59.2 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01564 | Reg=0.00179 | acc=0.9688 | FP-Norm=1.322 | FP-Norm(final)=2.635 | 4068.1 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step12000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.9] | Loss=0.12937 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.629 | 4168.0 samples/s | 65.1 steps/s
[Step=11250 Epoch=55.2] | Loss=0.03663 | Reg=0.00093 | acc=0.9531 | FP-Norm=0.925 | FP-Norm(final)=2.618 | 3227.7 samples/s | 50.4 steps/s
[Step=11300 Epoch=55.4] | Loss=0.02836 | Reg=0.00115 | acc=0.9844 | FP-Norm=1.046 | FP-Norm(final)=2.619 | 3779.3 samples/s | 59.1 steps/s
[Step=11350 Epoch=55.7] | Loss=0.02733 | Reg=0.00130 | acc=0.9844 | FP-Norm=1.120 | FP-Norm(final)=2.619 | 3777.9 samples/s | 59.0 steps/s
[Step=11400 Epoch=55.9] | Loss=0.02634 | Reg=0.00140 | acc=0.9844 | FP-Norm=1.165 | FP-Norm(final)=2.617 | 4879.5 samples/s | 76.2 steps/s
[Step=11450 Epoch=56.1] | Loss=0.02311 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.191 | FP-Norm(final)=2.617 | 1610.2 samples/s | 25.2 steps/s
[Step=11500 Epoch=56.4] | Loss=0.02153 | Reg=0.00149 | acc=1.0000 | FP-Norm=1.206 | FP-Norm(final)=2.619 | 3784.8 samples/s | 59.1 steps/s
[Step=11550 Epoch=56.6] | Loss=0.02050 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.220 | FP-Norm(final)=2.620 | 3788.4 samples/s | 59.2 steps/s
[Step=11600 Epoch=56.9] | Loss=0.01944 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.234 | FP-Norm(final)=2.622 | 4704.3 samples/s | 73.5 steps/s
[Step=11650 Epoch=57.1] | Loss=0.01810 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.244 | FP-Norm(final)=2.624 | 1637.2 samples/s | 25.6 steps/s
[Step=11700 Epoch=57.4] | Loss=0.01696 | Reg=0.00158 | acc=0.9844 | FP-Norm=1.250 | FP-Norm(final)=2.627 | 3770.0 samples/s | 58.9 steps/s
[Step=11750 Epoch=57.6] | Loss=0.01627 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.255 | FP-Norm(final)=2.629 | 3783.8 samples/s | 59.1 steps/s
[Step=11800 Epoch=57.9] | Loss=0.01584 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.261 | FP-Norm(final)=2.631 | 4527.6 samples/s | 70.7 steps/s
[Step=11850 Epoch=58.1] | Loss=0.01534 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.267 | FP-Norm(final)=2.632 | 1676.2 samples/s | 26.2 steps/s
[Step=11900 Epoch=58.4] | Loss=0.01480 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.272 | FP-Norm(final)=2.633 | 3781.8 samples/s | 59.1 steps/s
[Step=11950 Epoch=58.6] | Loss=0.01441 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.277 | FP-Norm(final)=2.635 | 3816.5 samples/s | 59.6 steps/s
[Step=12000 Epoch=58.8] | Loss=0.01421 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.282 | FP-Norm(final)=2.636 | 4329.9 samples/s | 67.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=106.1] | Loss=0.07881 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.629 | 3652.5 samples/s | 57.1 steps/s
[Step=11250 Epoch=106.6] | Loss=0.00952 | Reg=0.00188 | acc=1.0000 | FP-Norm=1.307 | FP-Norm(final)=2.618 | 3408.3 samples/s | 53.3 steps/s
[Step=11300 Epoch=107.1] | Loss=0.00529 | Reg=0.00221 | acc=1.0000 | FP-Norm=1.449 | FP-Norm(final)=2.617 | 4675.9 samples/s | 73.1 steps/s
[Step=11350 Epoch=107.6] | Loss=0.00357 | Reg=0.00217 | acc=1.0000 | FP-Norm=1.447 | FP-Norm(final)=2.620 | 1547.6 samples/s | 24.2 steps/s
[Step=11400 Epoch=108.0] | Loss=0.00268 | Reg=0.00207 | acc=1.0000 | FP-Norm=1.417 | FP-Norm(final)=2.622 | 4327.3 samples/s | 67.6 steps/s
[Step=11450 Epoch=108.5] | Loss=0.00215 | Reg=0.00196 | acc=1.0000 | FP-Norm=1.383 | FP-Norm(final)=2.624 | 1579.9 samples/s | 24.7 steps/s
[Step=11500 Epoch=109.0] | Loss=0.00180 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.349 | FP-Norm(final)=2.625 | 4086.2 samples/s | 63.8 steps/s
[Step=11550 Epoch=109.4] | Loss=0.00155 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.317 | FP-Norm(final)=2.626 | 1610.6 samples/s | 25.2 steps/s
[Step=11600 Epoch=109.9] | Loss=0.00136 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.287 | FP-Norm(final)=2.628 | 3854.0 samples/s | 60.2 steps/s
[Step=11650 Epoch=110.4] | Loss=0.00121 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.259 | FP-Norm(final)=2.629 | 1663.9 samples/s | 26.0 steps/s
[Step=11700 Epoch=110.9] | Loss=0.00109 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.233 | FP-Norm(final)=2.629 | 3617.8 samples/s | 56.5 steps/s
[Step=11750 Epoch=111.3] | Loss=0.00099 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.209 | FP-Norm(final)=2.630 | 1698.5 samples/s | 26.5 steps/s
[Step=11800 Epoch=111.8] | Loss=0.00091 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.185 | FP-Norm(final)=2.631 | 3598.9 samples/s | 56.2 steps/s
[Step=11850 Epoch=112.3] | Loss=0.00084 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.163 | FP-Norm(final)=2.632 | 1725.9 samples/s | 27.0 steps/s
[Step=11900 Epoch=112.8] | Loss=0.00078 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.143 | FP-Norm(final)=2.633 | 3532.6 samples/s | 55.2 steps/s
[Step=11950 Epoch=113.2] | Loss=0.00073 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.123 | FP-Norm(final)=2.633 | 1761.9 samples/s | 27.5 steps/s
[Step=12000 Epoch=113.7] | Loss=0.00069 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.104 | FP-Norm(final)=2.634 | 3561.9 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step12000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=106.5] | Loss=0.15782 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.629 | 3555.5 samples/s | 55.6 steps/s
[Step=11250 Epoch=107.0] | Loss=0.00984 | Reg=0.00248 | acc=1.0000 | FP-Norm=1.512 | FP-Norm(final)=2.610 | 3334.5 samples/s | 52.1 steps/s
[Step=11300 Epoch=107.5] | Loss=0.00511 | Reg=0.00259 | acc=1.0000 | FP-Norm=1.577 | FP-Norm(final)=2.612 | 4702.5 samples/s | 73.5 steps/s
[Step=11350 Epoch=108.0] | Loss=0.00343 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.547 | FP-Norm(final)=2.615 | 1545.8 samples/s | 24.2 steps/s
[Step=11400 Epoch=108.4] | Loss=0.00259 | Reg=0.00233 | acc=1.0000 | FP-Norm=1.505 | FP-Norm(final)=2.618 | 4351.1 samples/s | 68.0 steps/s
[Step=11450 Epoch=108.9] | Loss=0.00209 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.466 | FP-Norm(final)=2.620 | 1590.1 samples/s | 24.8 steps/s
[Step=11500 Epoch=109.4] | Loss=0.00175 | Reg=0.00209 | acc=1.0000 | FP-Norm=1.428 | FP-Norm(final)=2.622 | 4062.0 samples/s | 63.5 steps/s
[Step=11550 Epoch=109.9] | Loss=0.00150 | Reg=0.00199 | acc=1.0000 | FP-Norm=1.394 | FP-Norm(final)=2.624 | 1617.5 samples/s | 25.3 steps/s
[Step=11600 Epoch=110.3] | Loss=0.00132 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.362 | FP-Norm(final)=2.625 | 3850.5 samples/s | 60.2 steps/s
[Step=11650 Epoch=110.8] | Loss=0.00117 | Reg=0.00183 | acc=1.0000 | FP-Norm=1.332 | FP-Norm(final)=2.626 | 1668.9 samples/s | 26.1 steps/s
[Step=11700 Epoch=111.3] | Loss=0.00106 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.304 | FP-Norm(final)=2.628 | 3663.4 samples/s | 57.2 steps/s
[Step=11750 Epoch=111.8] | Loss=0.00097 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.277 | FP-Norm(final)=2.629 | 1691.4 samples/s | 26.4 steps/s
[Step=11800 Epoch=112.2] | Loss=0.00089 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.252 | FP-Norm(final)=2.630 | 3586.0 samples/s | 56.0 steps/s
[Step=11850 Epoch=112.7] | Loss=0.00082 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.229 | FP-Norm(final)=2.631 | 1710.3 samples/s | 26.7 steps/s
[Step=11900 Epoch=113.2] | Loss=0.00076 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.206 | FP-Norm(final)=2.631 | 3567.5 samples/s | 55.7 steps/s
[Step=11950 Epoch=113.7] | Loss=0.00072 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.185 | FP-Norm(final)=2.632 | 1726.2 samples/s | 27.0 steps/s
[Step=12000 Epoch=114.1] | Loss=0.00067 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.164 | FP-Norm(final)=2.633 | 3620.8 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step12000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=107.0] | Loss=0.07460 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.629 | 3625.2 samples/s | 56.6 steps/s
[Step=11250 Epoch=107.4] | Loss=0.00854 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.449 | FP-Norm(final)=2.627 | 3273.3 samples/s | 51.1 steps/s
[Step=11300 Epoch=107.9] | Loss=0.00556 | Reg=0.00258 | acc=1.0000 | FP-Norm=1.568 | FP-Norm(final)=2.629 | 4661.7 samples/s | 72.8 steps/s
[Step=11350 Epoch=108.4] | Loss=0.00377 | Reg=0.00260 | acc=1.0000 | FP-Norm=1.588 | FP-Norm(final)=2.631 | 1510.1 samples/s | 23.6 steps/s
[Step=11400 Epoch=108.9] | Loss=0.00284 | Reg=0.00253 | acc=1.0000 | FP-Norm=1.570 | FP-Norm(final)=2.633 | 4307.8 samples/s | 67.3 steps/s
[Step=11450 Epoch=109.3] | Loss=0.00229 | Reg=0.00243 | acc=1.0000 | FP-Norm=1.544 | FP-Norm(final)=2.634 | 1547.1 samples/s | 24.2 steps/s
[Step=11500 Epoch=109.8] | Loss=0.00191 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.514 | FP-Norm(final)=2.635 | 4190.6 samples/s | 65.5 steps/s
[Step=11550 Epoch=110.3] | Loss=0.00164 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.484 | FP-Norm(final)=2.636 | 1609.6 samples/s | 25.2 steps/s
[Step=11600 Epoch=110.8] | Loss=0.00144 | Reg=0.00216 | acc=1.0000 | FP-Norm=1.455 | FP-Norm(final)=2.637 | 3951.6 samples/s | 61.7 steps/s
[Step=11650 Epoch=111.3] | Loss=0.00128 | Reg=0.00208 | acc=1.0000 | FP-Norm=1.427 | FP-Norm(final)=2.637 | 1633.0 samples/s | 25.5 steps/s
[Step=11700 Epoch=111.7] | Loss=0.00116 | Reg=0.00201 | acc=1.0000 | FP-Norm=1.401 | FP-Norm(final)=2.638 | 3781.6 samples/s | 59.1 steps/s
[Step=11750 Epoch=112.2] | Loss=0.00105 | Reg=0.00194 | acc=1.0000 | FP-Norm=1.375 | FP-Norm(final)=2.638 | 1649.5 samples/s | 25.8 steps/s
[Step=11800 Epoch=112.7] | Loss=0.00097 | Reg=0.00188 | acc=1.0000 | FP-Norm=1.351 | FP-Norm(final)=2.638 | 3638.9 samples/s | 56.9 steps/s
[Step=11850 Epoch=113.2] | Loss=0.00089 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.328 | FP-Norm(final)=2.639 | 1709.0 samples/s | 26.7 steps/s
[Step=11900 Epoch=113.6] | Loss=0.00083 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.306 | FP-Norm(final)=2.639 | 3581.5 samples/s | 56.0 steps/s
[Step=11950 Epoch=114.1] | Loss=0.00078 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.285 | FP-Norm(final)=2.639 | 1716.5 samples/s | 26.8 steps/s
[Step=12000 Epoch=114.6] | Loss=0.00073 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.264 | FP-Norm(final)=2.639 | 3542.1 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step12000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=105.5] | Loss=0.06180 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.629 | 3786.5 samples/s | 59.2 steps/s
[Step=11250 Epoch=106.0] | Loss=0.01161 | Reg=0.00201 | acc=1.0000 | FP-Norm=1.358 | FP-Norm(final)=2.610 | 3296.6 samples/s | 51.5 steps/s
[Step=11300 Epoch=106.5] | Loss=0.00834 | Reg=0.00240 | acc=1.0000 | FP-Norm=1.515 | FP-Norm(final)=2.604 | 4588.9 samples/s | 71.7 steps/s
[Step=11350 Epoch=106.9] | Loss=0.00568 | Reg=0.00252 | acc=1.0000 | FP-Norm=1.564 | FP-Norm(final)=2.602 | 1557.6 samples/s | 24.3 steps/s
[Step=11400 Epoch=107.4] | Loss=0.00427 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.554 | FP-Norm(final)=2.603 | 4284.9 samples/s | 67.0 steps/s
[Step=11450 Epoch=107.9] | Loss=0.00343 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.530 | FP-Norm(final)=2.604 | 1581.9 samples/s | 24.7 steps/s
[Step=11500 Epoch=108.4] | Loss=0.00286 | Reg=0.00230 | acc=1.0000 | FP-Norm=1.502 | FP-Norm(final)=2.605 | 3865.6 samples/s | 60.4 steps/s
[Step=11550 Epoch=108.8] | Loss=0.00246 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.474 | FP-Norm(final)=2.606 | 1656.8 samples/s | 25.9 steps/s
[Step=11600 Epoch=109.3] | Loss=0.00215 | Reg=0.00214 | acc=1.0000 | FP-Norm=1.447 | FP-Norm(final)=2.607 | 3675.9 samples/s | 57.4 steps/s
[Step=11650 Epoch=109.8] | Loss=0.00192 | Reg=0.00206 | acc=1.0000 | FP-Norm=1.421 | FP-Norm(final)=2.608 | 1196.3 samples/s | 18.7 steps/s
[Step=11700 Epoch=110.2] | Loss=0.00173 | Reg=0.00200 | acc=1.0000 | FP-Norm=1.397 | FP-Norm(final)=2.609 | 3620.2 samples/s | 56.6 steps/s
[Step=11750 Epoch=110.7] | Loss=0.00157 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.373 | FP-Norm(final)=2.610 | 1664.0 samples/s | 26.0 steps/s
[Step=11800 Epoch=111.2] | Loss=0.00144 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.350 | FP-Norm(final)=2.611 | 3583.8 samples/s | 56.0 steps/s
[Step=11850 Epoch=111.7] | Loss=0.00133 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.329 | FP-Norm(final)=2.612 | 1736.0 samples/s | 27.1 steps/s
[Step=11900 Epoch=112.1] | Loss=0.00124 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.308 | FP-Norm(final)=2.613 | 3550.0 samples/s | 55.5 steps/s
[Step=11950 Epoch=112.6] | Loss=0.00116 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.288 | FP-Norm(final)=2.614 | 1827.7 samples/s | 28.6 steps/s
[Step=12000 Epoch=113.1] | Loss=0.00109 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.269 | FP-Norm(final)=2.615 | 3389.6 samples/s | 53.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step12000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=106.8] | Loss=0.16798 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.628 | 3407.7 samples/s | 53.2 steps/s
[Step=11250 Epoch=107.2] | Loss=0.01294 | Reg=0.00241 | acc=1.0000 | FP-Norm=1.480 | FP-Norm(final)=2.609 | 3452.3 samples/s | 53.9 steps/s
[Step=11300 Epoch=107.7] | Loss=0.00770 | Reg=0.00278 | acc=1.0000 | FP-Norm=1.627 | FP-Norm(final)=2.607 | 4698.6 samples/s | 73.4 steps/s
[Step=11350 Epoch=108.2] | Loss=0.00574 | Reg=0.00295 | acc=1.0000 | FP-Norm=1.690 | FP-Norm(final)=2.607 | 1570.6 samples/s | 24.5 steps/s
[Step=11400 Epoch=108.7] | Loss=0.00435 | Reg=0.00297 | acc=1.0000 | FP-Norm=1.702 | FP-Norm(final)=2.607 | 4449.4 samples/s | 69.5 steps/s
[Step=11450 Epoch=109.1] | Loss=0.00348 | Reg=0.00292 | acc=1.0000 | FP-Norm=1.692 | FP-Norm(final)=2.609 | 1580.2 samples/s | 24.7 steps/s
[Step=11500 Epoch=109.6] | Loss=0.00291 | Reg=0.00285 | acc=1.0000 | FP-Norm=1.672 | FP-Norm(final)=2.610 | 4147.4 samples/s | 64.8 steps/s
[Step=11550 Epoch=110.1] | Loss=0.00250 | Reg=0.00277 | acc=1.0000 | FP-Norm=1.650 | FP-Norm(final)=2.611 | 1611.4 samples/s | 25.2 steps/s
[Step=11600 Epoch=110.6] | Loss=0.00219 | Reg=0.00269 | acc=1.0000 | FP-Norm=1.626 | FP-Norm(final)=2.612 | 3962.0 samples/s | 61.9 steps/s
[Step=11650 Epoch=111.0] | Loss=0.00195 | Reg=0.00261 | acc=1.0000 | FP-Norm=1.602 | FP-Norm(final)=2.613 | 1624.2 samples/s | 25.4 steps/s
[Step=11700 Epoch=111.5] | Loss=0.00176 | Reg=0.00254 | acc=1.0000 | FP-Norm=1.579 | FP-Norm(final)=2.614 | 3772.4 samples/s | 58.9 steps/s
[Step=11750 Epoch=112.0] | Loss=0.00160 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.556 | FP-Norm(final)=2.615 | 1668.7 samples/s | 26.1 steps/s
[Step=11800 Epoch=112.5] | Loss=0.00147 | Reg=0.00240 | acc=1.0000 | FP-Norm=1.534 | FP-Norm(final)=2.616 | 3640.9 samples/s | 56.9 steps/s
[Step=11850 Epoch=112.9] | Loss=0.00136 | Reg=0.00234 | acc=1.0000 | FP-Norm=1.512 | FP-Norm(final)=2.617 | 1702.0 samples/s | 26.6 steps/s
[Step=11900 Epoch=113.4] | Loss=0.00126 | Reg=0.00227 | acc=1.0000 | FP-Norm=1.491 | FP-Norm(final)=2.618 | 3577.0 samples/s | 55.9 steps/s
[Step=11950 Epoch=113.9] | Loss=0.00118 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.470 | FP-Norm(final)=2.619 | 1709.7 samples/s | 26.7 steps/s
[Step=12000 Epoch=114.4] | Loss=0.00111 | Reg=0.00216 | acc=1.0000 | FP-Norm=1.450 | FP-Norm(final)=2.620 | 3589.7 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19459 | acc=0.8673 | tpr=0.8155 | fpr=0.0201 | 3580.8 samples/s | 14.0 steps/s
Avg test loss: 0.19476, Avg test acc: 0.86850, Avg tpr: 0.81862, Avg fpr: 0.02179, total FA: 170

Testing server on iccad2012
[Step=  50] | Loss=0.53576 | acc=0.7965 | tpr=0.9779 | fpr=0.2068 | 3514.7 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.54961 | acc=0.7945 | tpr=0.9787 | fpr=0.2089 | 6680.9 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.55549 | acc=0.7931 | tpr=0.9769 | fpr=0.2103 | 6814.5 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.55641 | acc=0.7925 | tpr=0.9770 | fpr=0.2108 | 6767.7 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.55471 | acc=0.7924 | tpr=0.9747 | fpr=0.2109 | 6989.1 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.55770 | acc=0.7919 | tpr=0.9731 | fpr=0.2114 | 6631.9 samples/s | 25.9 steps/s
[Step= 350] | Loss=0.55816 | acc=0.7922 | tpr=0.9731 | fpr=0.2111 | 6948.5 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.55884 | acc=0.7919 | tpr=0.9732 | fpr=0.2114 | 6709.8 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.56140 | acc=0.7919 | tpr=0.9732 | fpr=0.2114 | 6666.4 samples/s | 26.0 steps/s
[Step= 500] | Loss=0.56275 | acc=0.7918 | tpr=0.9744 | fpr=0.2115 | 6753.6 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.56229 | acc=0.7920 | tpr=0.9753 | fpr=0.2113 | 12249.5 samples/s | 47.8 steps/s
Avg test loss: 0.56226, Avg test acc: 0.79202, Avg tpr: 0.97544, Avg fpr: 0.21131, total FA: 29340

server round 15/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.07565 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.646 | 3742.7 samples/s | 58.5 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03519 | Reg=0.00099 | acc=0.9688 | FP-Norm=0.944 | FP-Norm(final)=2.631 | 3527.6 samples/s | 55.1 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02863 | Reg=0.00122 | acc=0.9531 | FP-Norm=1.075 | FP-Norm(final)=2.627 | 3772.6 samples/s | 58.9 steps/s
[Step=12150 Epoch=59.2] | Loss=0.02747 | Reg=0.00136 | acc=0.9844 | FP-Norm=1.144 | FP-Norm(final)=2.625 | 3784.3 samples/s | 59.1 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02679 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.202 | FP-Norm(final)=2.622 | 4810.2 samples/s | 75.2 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02407 | Reg=0.00161 | acc=0.9844 | FP-Norm=1.249 | FP-Norm(final)=2.622 | 1628.2 samples/s | 25.4 steps/s
[Step=12300 Epoch=60.0] | Loss=0.02176 | Reg=0.00168 | acc=0.9844 | FP-Norm=1.277 | FP-Norm(final)=2.626 | 3771.9 samples/s | 58.9 steps/s
[Step=12350 Epoch=60.2] | Loss=0.02074 | Reg=0.00173 | acc=0.9844 | FP-Norm=1.299 | FP-Norm(final)=2.628 | 3764.4 samples/s | 58.8 steps/s
[Step=12400 Epoch=60.5] | Loss=0.02026 | Reg=0.00177 | acc=0.9844 | FP-Norm=1.315 | FP-Norm(final)=2.630 | 4557.6 samples/s | 71.2 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01929 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.328 | FP-Norm(final)=2.631 | 1649.8 samples/s | 25.8 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01848 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.337 | FP-Norm(final)=2.633 | 3790.5 samples/s | 59.2 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01747 | Reg=0.00183 | acc=0.9844 | FP-Norm=1.342 | FP-Norm(final)=2.635 | 3776.5 samples/s | 59.0 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01700 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.347 | FP-Norm(final)=2.637 | 4308.7 samples/s | 67.3 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01631 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.351 | FP-Norm(final)=2.638 | 1689.2 samples/s | 26.4 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01564 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.353 | FP-Norm(final)=2.640 | 3766.4 samples/s | 58.9 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01485 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.355 | FP-Norm(final)=2.642 | 3757.3 samples/s | 58.7 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01468 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.357 | FP-Norm(final)=2.644 | 4053.6 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step12800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.6] | Loss=0.22303 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.645 | 3792.8 samples/s | 59.3 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03014 | Reg=0.00090 | acc=0.9844 | FP-Norm=0.905 | FP-Norm(final)=2.641 | 3519.5 samples/s | 55.0 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02663 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.010 | FP-Norm(final)=2.637 | 3768.0 samples/s | 58.9 steps/s
[Step=12150 Epoch=59.3] | Loss=0.02575 | Reg=0.00118 | acc=0.9688 | FP-Norm=1.068 | FP-Norm(final)=2.637 | 3770.1 samples/s | 58.9 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02449 | Reg=0.00128 | acc=0.9688 | FP-Norm=1.113 | FP-Norm(final)=2.637 | 4824.0 samples/s | 75.4 steps/s
[Step=12250 Epoch=59.8] | Loss=0.02246 | Reg=0.00135 | acc=1.0000 | FP-Norm=1.146 | FP-Norm(final)=2.638 | 1603.5 samples/s | 25.1 steps/s
[Step=12300 Epoch=60.0] | Loss=0.02015 | Reg=0.00140 | acc=0.9844 | FP-Norm=1.169 | FP-Norm(final)=2.640 | 3750.6 samples/s | 58.6 steps/s
[Step=12350 Epoch=60.3] | Loss=0.01928 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.184 | FP-Norm(final)=2.643 | 3775.5 samples/s | 59.0 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01836 | Reg=0.00146 | acc=0.9844 | FP-Norm=1.200 | FP-Norm(final)=2.644 | 4586.1 samples/s | 71.7 steps/s
[Step=12450 Epoch=60.8] | Loss=0.01705 | Reg=0.00149 | acc=1.0000 | FP-Norm=1.211 | FP-Norm(final)=2.647 | 1636.7 samples/s | 25.6 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01614 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.219 | FP-Norm(final)=2.650 | 3777.9 samples/s | 59.0 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01563 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.226 | FP-Norm(final)=2.653 | 3726.1 samples/s | 58.2 steps/s
[Step=12600 Epoch=61.5] | Loss=0.01515 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.232 | FP-Norm(final)=2.655 | 4373.0 samples/s | 68.3 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01444 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.237 | FP-Norm(final)=2.657 | 1679.2 samples/s | 26.2 steps/s
[Step=12700 Epoch=62.0] | Loss=0.01388 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.240 | FP-Norm(final)=2.659 | 3676.0 samples/s | 57.4 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01342 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.243 | FP-Norm(final)=2.661 | 3746.7 samples/s | 58.5 steps/s
[Step=12800 Epoch=62.5] | Loss=0.01308 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.246 | FP-Norm(final)=2.663 | 4174.2 samples/s | 65.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step12800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.12231 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.645 | 3822.6 samples/s | 59.7 steps/s
[Step=12050 Epoch=58.7] | Loss=0.03197 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.875 | FP-Norm(final)=2.636 | 3457.5 samples/s | 54.0 steps/s
[Step=12100 Epoch=59.0] | Loss=0.03038 | Reg=0.00110 | acc=0.9688 | FP-Norm=1.019 | FP-Norm(final)=2.627 | 3738.4 samples/s | 58.4 steps/s
[Step=12150 Epoch=59.2] | Loss=0.02831 | Reg=0.00123 | acc=0.9844 | FP-Norm=1.089 | FP-Norm(final)=2.625 | 3777.0 samples/s | 59.0 steps/s
[Step=12200 Epoch=59.4] | Loss=0.02691 | Reg=0.00135 | acc=0.9844 | FP-Norm=1.144 | FP-Norm(final)=2.622 | 4830.6 samples/s | 75.5 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02384 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.179 | FP-Norm(final)=2.622 | 1620.7 samples/s | 25.3 steps/s
[Step=12300 Epoch=59.9] | Loss=0.02194 | Reg=0.00147 | acc=0.9844 | FP-Norm=1.197 | FP-Norm(final)=2.624 | 3757.1 samples/s | 58.7 steps/s
[Step=12350 Epoch=60.2] | Loss=0.02045 | Reg=0.00149 | acc=0.9844 | FP-Norm=1.209 | FP-Norm(final)=2.627 | 3797.1 samples/s | 59.3 steps/s
[Step=12400 Epoch=60.4] | Loss=0.01922 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.217 | FP-Norm(final)=2.630 | 4526.0 samples/s | 70.7 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01792 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.225 | FP-Norm(final)=2.633 | 1659.3 samples/s | 25.9 steps/s
[Step=12500 Epoch=60.9] | Loss=0.01705 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.231 | FP-Norm(final)=2.636 | 3745.8 samples/s | 58.5 steps/s
[Step=12550 Epoch=61.1] | Loss=0.01640 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.236 | FP-Norm(final)=2.639 | 3774.3 samples/s | 59.0 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01586 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.240 | FP-Norm(final)=2.642 | 4274.9 samples/s | 66.8 steps/s
[Step=12650 Epoch=61.6] | Loss=0.01518 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.243 | FP-Norm(final)=2.644 | 1700.3 samples/s | 26.6 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01456 | Reg=0.00157 | acc=0.9844 | FP-Norm=1.245 | FP-Norm(final)=2.647 | 3747.4 samples/s | 58.6 steps/s
[Step=12750 Epoch=62.1] | Loss=0.01384 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.247 | FP-Norm(final)=2.650 | 3776.5 samples/s | 59.0 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01350 | Reg=0.00157 | acc=0.9844 | FP-Norm=1.249 | FP-Norm(final)=2.653 | 4040.1 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step12800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.10933 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.645 | 3806.5 samples/s | 59.5 steps/s
[Step=12050 Epoch=58.8] | Loss=0.02950 | Reg=0.00075 | acc=0.9688 | FP-Norm=0.829 | FP-Norm(final)=2.638 | 3513.1 samples/s | 54.9 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02744 | Reg=0.00092 | acc=0.9375 | FP-Norm=0.936 | FP-Norm(final)=2.635 | 3784.5 samples/s | 59.1 steps/s
[Step=12150 Epoch=59.3] | Loss=0.02570 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.009 | FP-Norm(final)=2.633 | 3777.9 samples/s | 59.0 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02369 | Reg=0.00115 | acc=0.9844 | FP-Norm=1.055 | FP-Norm(final)=2.633 | 4854.7 samples/s | 75.9 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02191 | Reg=0.00121 | acc=0.9844 | FP-Norm=1.085 | FP-Norm(final)=2.634 | 1623.2 samples/s | 25.4 steps/s
[Step=12300 Epoch=60.0] | Loss=0.02017 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.106 | FP-Norm(final)=2.635 | 3703.1 samples/s | 57.9 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01890 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.121 | FP-Norm(final)=2.637 | 3725.1 samples/s | 58.2 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01773 | Reg=0.00130 | acc=1.0000 | FP-Norm=1.130 | FP-Norm(final)=2.640 | 4557.6 samples/s | 71.2 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01649 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.137 | FP-Norm(final)=2.643 | 1648.0 samples/s | 25.7 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01574 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.142 | FP-Norm(final)=2.646 | 3757.4 samples/s | 58.7 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01533 | Reg=0.00133 | acc=0.9688 | FP-Norm=1.147 | FP-Norm(final)=2.648 | 3733.2 samples/s | 58.3 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01461 | Reg=0.00134 | acc=1.0000 | FP-Norm=1.152 | FP-Norm(final)=2.650 | 4290.9 samples/s | 67.0 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01531 | Reg=0.00138 | acc=1.0000 | FP-Norm=1.167 | FP-Norm(final)=2.652 | 1666.0 samples/s | 26.0 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01508 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.194 | FP-Norm(final)=2.652 | 3775.0 samples/s | 59.0 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01505 | Reg=0.00151 | acc=0.9844 | FP-Norm=1.215 | FP-Norm(final)=2.653 | 3782.8 samples/s | 59.1 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01477 | Reg=0.00156 | acc=0.9844 | FP-Norm=1.234 | FP-Norm(final)=2.655 | 4062.4 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step12800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.9] | Loss=0.23763 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.645 | 3491.9 samples/s | 54.6 steps/s
[Step=12050 Epoch=59.1] | Loss=0.02946 | Reg=0.00103 | acc=0.9688 | FP-Norm=0.977 | FP-Norm(final)=2.634 | 3733.8 samples/s | 58.3 steps/s
[Step=12100 Epoch=59.3] | Loss=0.02642 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.078 | FP-Norm(final)=2.631 | 3739.8 samples/s | 58.4 steps/s
[Step=12150 Epoch=59.6] | Loss=0.02513 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.132 | FP-Norm(final)=2.627 | 3776.2 samples/s | 59.0 steps/s
[Step=12200 Epoch=59.8] | Loss=0.02427 | Reg=0.00140 | acc=0.9844 | FP-Norm=1.170 | FP-Norm(final)=2.626 | 4897.2 samples/s | 76.5 steps/s
[Step=12250 Epoch=60.1] | Loss=0.02151 | Reg=0.00147 | acc=0.9844 | FP-Norm=1.201 | FP-Norm(final)=2.626 | 1585.8 samples/s | 24.8 steps/s
[Step=12300 Epoch=60.3] | Loss=0.01901 | Reg=0.00150 | acc=0.9844 | FP-Norm=1.214 | FP-Norm(final)=2.629 | 3776.8 samples/s | 59.0 steps/s
[Step=12350 Epoch=60.6] | Loss=0.01760 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.223 | FP-Norm(final)=2.632 | 3796.8 samples/s | 59.3 steps/s
[Step=12400 Epoch=60.8] | Loss=0.01735 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.234 | FP-Norm(final)=2.634 | 4694.8 samples/s | 73.4 steps/s
[Step=12450 Epoch=61.1] | Loss=0.01640 | Reg=0.00157 | acc=0.9844 | FP-Norm=1.244 | FP-Norm(final)=2.636 | 1633.2 samples/s | 25.5 steps/s
[Step=12500 Epoch=61.3] | Loss=0.01583 | Reg=0.00159 | acc=0.9844 | FP-Norm=1.254 | FP-Norm(final)=2.639 | 3792.2 samples/s | 59.3 steps/s
[Step=12550 Epoch=61.5] | Loss=0.01562 | Reg=0.00162 | acc=0.9844 | FP-Norm=1.265 | FP-Norm(final)=2.640 | 3776.4 samples/s | 59.0 steps/s
[Step=12600 Epoch=61.8] | Loss=0.01529 | Reg=0.00165 | acc=0.9688 | FP-Norm=1.277 | FP-Norm(final)=2.641 | 4492.7 samples/s | 70.2 steps/s
[Step=12650 Epoch=62.0] | Loss=0.01454 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.286 | FP-Norm(final)=2.643 | 1658.3 samples/s | 25.9 steps/s
[Step=12700 Epoch=62.3] | Loss=0.01390 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.293 | FP-Norm(final)=2.645 | 3783.0 samples/s | 59.1 steps/s
[Step=12750 Epoch=62.5] | Loss=0.01368 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.298 | FP-Norm(final)=2.646 | 3776.6 samples/s | 59.0 steps/s
[Step=12800 Epoch=62.8] | Loss=0.01349 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.304 | FP-Norm(final)=2.647 | 4356.0 samples/s | 68.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step12800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=113.7] | Loss=0.11800 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.644 | 3613.2 samples/s | 56.5 steps/s
[Step=12050 Epoch=114.2] | Loss=0.01190 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.447 | FP-Norm(final)=2.622 | 3300.8 samples/s | 51.6 steps/s
[Step=12100 Epoch=114.7] | Loss=0.00974 | Reg=0.00296 | acc=1.0000 | FP-Norm=1.674 | FP-Norm(final)=2.615 | 4627.2 samples/s | 72.3 steps/s
[Step=12150 Epoch=115.1] | Loss=0.00673 | Reg=0.00315 | acc=1.0000 | FP-Norm=1.742 | FP-Norm(final)=2.614 | 1550.3 samples/s | 24.2 steps/s
[Step=12200 Epoch=115.6] | Loss=0.00508 | Reg=0.00312 | acc=1.0000 | FP-Norm=1.741 | FP-Norm(final)=2.616 | 4302.3 samples/s | 67.2 steps/s
[Step=12250 Epoch=116.1] | Loss=0.00423 | Reg=0.00308 | acc=1.0000 | FP-Norm=1.736 | FP-Norm(final)=2.618 | 1574.9 samples/s | 24.6 steps/s
[Step=12300 Epoch=116.6] | Loss=0.00354 | Reg=0.00304 | acc=1.0000 | FP-Norm=1.726 | FP-Norm(final)=2.620 | 4048.9 samples/s | 63.3 steps/s
[Step=12350 Epoch=117.0] | Loss=0.00304 | Reg=0.00297 | acc=1.0000 | FP-Norm=1.708 | FP-Norm(final)=2.622 | 1625.3 samples/s | 25.4 steps/s
[Step=12400 Epoch=117.5] | Loss=0.00267 | Reg=0.00289 | acc=1.0000 | FP-Norm=1.686 | FP-Norm(final)=2.624 | 3826.8 samples/s | 59.8 steps/s
[Step=12450 Epoch=118.0] | Loss=0.00237 | Reg=0.00281 | acc=1.0000 | FP-Norm=1.662 | FP-Norm(final)=2.625 | 1663.9 samples/s | 26.0 steps/s
[Step=12500 Epoch=118.4] | Loss=0.00214 | Reg=0.00273 | acc=1.0000 | FP-Norm=1.637 | FP-Norm(final)=2.627 | 3624.7 samples/s | 56.6 steps/s
[Step=12550 Epoch=118.9] | Loss=0.00195 | Reg=0.00265 | acc=1.0000 | FP-Norm=1.613 | FP-Norm(final)=2.628 | 1703.9 samples/s | 26.6 steps/s
[Step=12600 Epoch=119.4] | Loss=0.00179 | Reg=0.00258 | acc=1.0000 | FP-Norm=1.588 | FP-Norm(final)=2.629 | 3576.6 samples/s | 55.9 steps/s
[Step=12650 Epoch=119.9] | Loss=0.00165 | Reg=0.00250 | acc=1.0000 | FP-Norm=1.565 | FP-Norm(final)=2.630 | 1710.0 samples/s | 26.7 steps/s
[Step=12700 Epoch=120.3] | Loss=0.00153 | Reg=0.00244 | acc=1.0000 | FP-Norm=1.542 | FP-Norm(final)=2.631 | 3586.3 samples/s | 56.0 steps/s
[Step=12750 Epoch=120.8] | Loss=0.00143 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.519 | FP-Norm(final)=2.632 | 1711.2 samples/s | 26.7 steps/s
[Step=12800 Epoch=121.3] | Loss=0.00134 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.497 | FP-Norm(final)=2.633 | 3505.6 samples/s | 54.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step12800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=114.2] | Loss=0.11194 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.645 | 3482.9 samples/s | 54.4 steps/s
[Step=12050 Epoch=114.6] | Loss=0.00978 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.398 | FP-Norm(final)=2.627 | 3385.6 samples/s | 52.9 steps/s
[Step=12100 Epoch=115.1] | Loss=0.00538 | Reg=0.00236 | acc=1.0000 | FP-Norm=1.504 | FP-Norm(final)=2.624 | 4645.2 samples/s | 72.6 steps/s
[Step=12150 Epoch=115.6] | Loss=0.00365 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.497 | FP-Norm(final)=2.626 | 1547.1 samples/s | 24.2 steps/s
[Step=12200 Epoch=116.1] | Loss=0.00274 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.467 | FP-Norm(final)=2.628 | 4372.6 samples/s | 68.3 steps/s
[Step=12250 Epoch=116.5] | Loss=0.00220 | Reg=0.00210 | acc=1.0000 | FP-Norm=1.433 | FP-Norm(final)=2.629 | 1578.3 samples/s | 24.7 steps/s
[Step=12300 Epoch=117.0] | Loss=0.00184 | Reg=0.00200 | acc=1.0000 | FP-Norm=1.399 | FP-Norm(final)=2.630 | 4089.2 samples/s | 63.9 steps/s
[Step=12350 Epoch=117.5] | Loss=0.00158 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.367 | FP-Norm(final)=2.631 | 1587.8 samples/s | 24.8 steps/s
[Step=12400 Epoch=118.0] | Loss=0.00138 | Reg=0.00183 | acc=1.0000 | FP-Norm=1.336 | FP-Norm(final)=2.632 | 3818.8 samples/s | 59.7 steps/s
[Step=12450 Epoch=118.4] | Loss=0.00123 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.307 | FP-Norm(final)=2.633 | 1638.9 samples/s | 25.6 steps/s
[Step=12500 Epoch=118.9] | Loss=0.00111 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.279 | FP-Norm(final)=2.634 | 3660.2 samples/s | 57.2 steps/s
[Step=12550 Epoch=119.4] | Loss=0.00101 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.253 | FP-Norm(final)=2.635 | 1683.7 samples/s | 26.3 steps/s
[Step=12600 Epoch=119.9] | Loss=0.00093 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.228 | FP-Norm(final)=2.635 | 3550.2 samples/s | 55.5 steps/s
[Step=12650 Epoch=120.3] | Loss=0.00086 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.205 | FP-Norm(final)=2.636 | 1716.8 samples/s | 26.8 steps/s
[Step=12700 Epoch=120.8] | Loss=0.00080 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.182 | FP-Norm(final)=2.637 | 3638.1 samples/s | 56.8 steps/s
[Step=12750 Epoch=121.3] | Loss=0.00075 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.160 | FP-Norm(final)=2.638 | 1724.8 samples/s | 26.9 steps/s
[Step=12800 Epoch=121.8] | Loss=0.00070 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.140 | FP-Norm(final)=2.638 | 3539.7 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step12800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=114.6] | Loss=0.15680 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.644 | 4073.1 samples/s | 63.6 steps/s
[Step=12050 Epoch=115.1] | Loss=0.01649 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.463 | FP-Norm(final)=2.627 | 3096.5 samples/s | 48.4 steps/s
[Step=12100 Epoch=115.5] | Loss=0.00905 | Reg=0.00310 | acc=1.0000 | FP-Norm=1.708 | FP-Norm(final)=2.617 | 4689.8 samples/s | 73.3 steps/s
[Step=12150 Epoch=116.0] | Loss=0.00615 | Reg=0.00314 | acc=1.0000 | FP-Norm=1.736 | FP-Norm(final)=2.617 | 1526.7 samples/s | 23.9 steps/s
[Step=12200 Epoch=116.5] | Loss=0.00462 | Reg=0.00304 | acc=1.0000 | FP-Norm=1.716 | FP-Norm(final)=2.619 | 4432.8 samples/s | 69.3 steps/s
[Step=12250 Epoch=117.0] | Loss=0.00370 | Reg=0.00292 | acc=1.0000 | FP-Norm=1.684 | FP-Norm(final)=2.620 | 1570.5 samples/s | 24.5 steps/s
[Step=12300 Epoch=117.5] | Loss=0.00310 | Reg=0.00280 | acc=1.0000 | FP-Norm=1.651 | FP-Norm(final)=2.621 | 4206.8 samples/s | 65.7 steps/s
[Step=12350 Epoch=117.9] | Loss=0.00267 | Reg=0.00269 | acc=1.0000 | FP-Norm=1.618 | FP-Norm(final)=2.622 | 1593.5 samples/s | 24.9 steps/s
[Step=12400 Epoch=118.4] | Loss=0.00234 | Reg=0.00259 | acc=1.0000 | FP-Norm=1.587 | FP-Norm(final)=2.623 | 3963.4 samples/s | 61.9 steps/s
[Step=12450 Epoch=118.9] | Loss=0.00208 | Reg=0.00249 | acc=1.0000 | FP-Norm=1.556 | FP-Norm(final)=2.624 | 1637.3 samples/s | 25.6 steps/s
[Step=12500 Epoch=119.4] | Loss=0.00187 | Reg=0.00240 | acc=1.0000 | FP-Norm=1.528 | FP-Norm(final)=2.625 | 3800.5 samples/s | 59.4 steps/s
[Step=12550 Epoch=119.8] | Loss=0.00171 | Reg=0.00232 | acc=1.0000 | FP-Norm=1.501 | FP-Norm(final)=2.626 | 1650.1 samples/s | 25.8 steps/s
[Step=12600 Epoch=120.3] | Loss=0.00157 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.475 | FP-Norm(final)=2.627 | 3534.7 samples/s | 55.2 steps/s
[Step=12650 Epoch=120.8] | Loss=0.00145 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.450 | FP-Norm(final)=2.628 | 1673.8 samples/s | 26.2 steps/s
[Step=12700 Epoch=121.3] | Loss=0.00135 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.426 | FP-Norm(final)=2.629 | 3524.9 samples/s | 55.1 steps/s
[Step=12750 Epoch=121.8] | Loss=0.00126 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.404 | FP-Norm(final)=2.630 | 1709.4 samples/s | 26.7 steps/s
[Step=12800 Epoch=122.2] | Loss=0.00118 | Reg=0.00199 | acc=1.0000 | FP-Norm=1.382 | FP-Norm(final)=2.631 | 3586.1 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step12800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=113.1] | Loss=0.04083 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.646 | 3631.6 samples/s | 56.7 steps/s
[Step=12050 Epoch=113.5] | Loss=0.00694 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.231 | FP-Norm(final)=2.637 | 3217.0 samples/s | 50.3 steps/s
[Step=12100 Epoch=114.0] | Loss=0.00374 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.286 | FP-Norm(final)=2.638 | 4629.1 samples/s | 72.3 steps/s
[Step=12150 Epoch=114.5] | Loss=0.00253 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.274 | FP-Norm(final)=2.641 | 1535.7 samples/s | 24.0 steps/s
[Step=12200 Epoch=115.0] | Loss=0.00191 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.245 | FP-Norm(final)=2.643 | 4277.6 samples/s | 66.8 steps/s
[Step=12250 Epoch=115.4] | Loss=0.00153 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.215 | FP-Norm(final)=2.644 | 1581.1 samples/s | 24.7 steps/s
[Step=12300 Epoch=115.9] | Loss=0.00128 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.185 | FP-Norm(final)=2.645 | 3903.0 samples/s | 61.0 steps/s
[Step=12350 Epoch=116.4] | Loss=0.00110 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.157 | FP-Norm(final)=2.646 | 1618.1 samples/s | 25.3 steps/s
[Step=12400 Epoch=116.8] | Loss=0.00097 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.132 | FP-Norm(final)=2.647 | 3670.8 samples/s | 57.4 steps/s
[Step=12450 Epoch=117.3] | Loss=0.00086 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.108 | FP-Norm(final)=2.648 | 1670.1 samples/s | 26.1 steps/s
[Step=12500 Epoch=117.8] | Loss=0.00078 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.085 | FP-Norm(final)=2.648 | 3593.6 samples/s | 56.2 steps/s
[Step=12550 Epoch=118.3] | Loss=0.00071 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.063 | FP-Norm(final)=2.649 | 1705.9 samples/s | 26.7 steps/s
[Step=12600 Epoch=118.7] | Loss=0.00065 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.043 | FP-Norm(final)=2.649 | 3526.7 samples/s | 55.1 steps/s
[Step=12650 Epoch=119.2] | Loss=0.00060 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.023 | FP-Norm(final)=2.650 | 1709.8 samples/s | 26.7 steps/s
[Step=12700 Epoch=119.7] | Loss=0.00056 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.005 | FP-Norm(final)=2.650 | 3617.0 samples/s | 56.5 steps/s
[Step=12750 Epoch=120.1] | Loss=0.00052 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.987 | FP-Norm(final)=2.651 | 1773.5 samples/s | 27.7 steps/s
[Step=12800 Epoch=120.6] | Loss=0.00049 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.970 | FP-Norm(final)=2.651 | 3360.9 samples/s | 52.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step12800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=114.4] | Loss=0.08770 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.645 | 3620.9 samples/s | 56.6 steps/s
[Step=12050 Epoch=114.8] | Loss=0.01509 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.411 | FP-Norm(final)=2.624 | 3258.9 samples/s | 50.9 steps/s
[Step=12100 Epoch=115.3] | Loss=0.00811 | Reg=0.00252 | acc=1.0000 | FP-Norm=1.546 | FP-Norm(final)=2.620 | 4691.0 samples/s | 73.3 steps/s
[Step=12150 Epoch=115.8] | Loss=0.00543 | Reg=0.00245 | acc=1.0000 | FP-Norm=1.538 | FP-Norm(final)=2.621 | 1500.5 samples/s | 23.4 steps/s
[Step=12200 Epoch=116.3] | Loss=0.00409 | Reg=0.00235 | acc=1.0000 | FP-Norm=1.510 | FP-Norm(final)=2.622 | 4359.9 samples/s | 68.1 steps/s
[Step=12250 Epoch=116.8] | Loss=0.00330 | Reg=0.00224 | acc=1.0000 | FP-Norm=1.479 | FP-Norm(final)=2.624 | 1555.3 samples/s | 24.3 steps/s
[Step=12300 Epoch=117.2] | Loss=0.00276 | Reg=0.00215 | acc=1.0000 | FP-Norm=1.448 | FP-Norm(final)=2.626 | 4139.7 samples/s | 64.7 steps/s
[Step=12350 Epoch=117.7] | Loss=0.00237 | Reg=0.00206 | acc=1.0000 | FP-Norm=1.418 | FP-Norm(final)=2.627 | 1604.5 samples/s | 25.1 steps/s
[Step=12400 Epoch=118.2] | Loss=0.00208 | Reg=0.00198 | acc=1.0000 | FP-Norm=1.390 | FP-Norm(final)=2.629 | 3918.3 samples/s | 61.2 steps/s
[Step=12450 Epoch=118.7] | Loss=0.00185 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.364 | FP-Norm(final)=2.630 | 1621.4 samples/s | 25.3 steps/s
[Step=12500 Epoch=119.1] | Loss=0.00167 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.339 | FP-Norm(final)=2.631 | 3796.5 samples/s | 59.3 steps/s
[Step=12550 Epoch=119.6] | Loss=0.00152 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.315 | FP-Norm(final)=2.633 | 1676.8 samples/s | 26.2 steps/s
[Step=12600 Epoch=120.1] | Loss=0.00140 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.293 | FP-Norm(final)=2.634 | 3620.3 samples/s | 56.6 steps/s
[Step=12650 Epoch=120.6] | Loss=0.00129 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.271 | FP-Norm(final)=2.635 | 1674.9 samples/s | 26.2 steps/s
[Step=12700 Epoch=121.0] | Loss=0.00120 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.251 | FP-Norm(final)=2.636 | 3591.4 samples/s | 56.1 steps/s
[Step=12750 Epoch=121.5] | Loss=0.00112 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.231 | FP-Norm(final)=2.637 | 1709.5 samples/s | 26.7 steps/s
[Step=12800 Epoch=122.0] | Loss=0.00105 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.212 | FP-Norm(final)=2.638 | 3581.9 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23002 | acc=0.8477 | tpr=0.7856 | fpr=0.0173 | 3646.8 samples/s | 14.2 steps/s
Avg test loss: 0.23019, Avg test acc: 0.84883, Avg tpr: 0.78837, Avg fpr: 0.01820, total FA: 142

Testing server on iccad2012
[Step=  50] | Loss=0.50826 | acc=0.8091 | tpr=0.9690 | fpr=0.1938 | 3575.5 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.52271 | acc=0.8072 | tpr=0.9744 | fpr=0.1959 | 6918.0 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.52868 | acc=0.8056 | tpr=0.9741 | fpr=0.1975 | 6916.0 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.52962 | acc=0.8057 | tpr=0.9727 | fpr=0.1973 | 6894.8 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.52799 | acc=0.8054 | tpr=0.9694 | fpr=0.1976 | 6828.6 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.53114 | acc=0.8050 | tpr=0.9680 | fpr=0.1980 | 6846.7 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.53128 | acc=0.8053 | tpr=0.9687 | fpr=0.1976 | 6923.2 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.53212 | acc=0.8051 | tpr=0.9699 | fpr=0.1979 | 6714.2 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.53488 | acc=0.8051 | tpr=0.9698 | fpr=0.1979 | 6695.3 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.53623 | acc=0.8050 | tpr=0.9714 | fpr=0.1980 | 6896.1 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.53582 | acc=0.8052 | tpr=0.9713 | fpr=0.1978 | 12281.7 samples/s | 48.0 steps/s
Avg test loss: 0.53585, Avg test acc: 0.80521, Avg tpr: 0.97147, Avg fpr: 0.19781, total FA: 27466

server round 16/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.4] | Loss=0.14345 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.663 | 3816.5 samples/s | 59.6 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03612 | Reg=0.00107 | acc=0.9688 | FP-Norm=0.989 | FP-Norm(final)=2.647 | 3526.4 samples/s | 55.1 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03120 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.123 | FP-Norm(final)=2.640 | 3777.5 samples/s | 59.0 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02709 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.171 | FP-Norm(final)=2.642 | 3770.1 samples/s | 58.9 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02623 | Reg=0.00150 | acc=0.9688 | FP-Norm=1.208 | FP-Norm(final)=2.642 | 4855.7 samples/s | 75.9 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02345 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.237 | FP-Norm(final)=2.643 | 1630.1 samples/s | 25.5 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02129 | Reg=0.00160 | acc=0.9844 | FP-Norm=1.253 | FP-Norm(final)=2.646 | 3688.2 samples/s | 57.6 steps/s
[Step=13150 Epoch=64.1] | Loss=0.02009 | Reg=0.00163 | acc=0.9688 | FP-Norm=1.266 | FP-Norm(final)=2.649 | 3749.4 samples/s | 58.6 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01956 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.277 | FP-Norm(final)=2.651 | 4541.8 samples/s | 71.0 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01834 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.286 | FP-Norm(final)=2.652 | 1661.6 samples/s | 26.0 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01772 | Reg=0.00169 | acc=0.9844 | FP-Norm=1.292 | FP-Norm(final)=2.654 | 3754.7 samples/s | 58.7 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01716 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.297 | FP-Norm(final)=2.655 | 3787.7 samples/s | 59.2 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01633 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.301 | FP-Norm(final)=2.657 | 4234.1 samples/s | 66.2 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01567 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.303 | FP-Norm(final)=2.659 | 1689.1 samples/s | 26.4 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01515 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.304 | FP-Norm(final)=2.662 | 3755.8 samples/s | 58.7 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01477 | Reg=0.00172 | acc=0.9688 | FP-Norm=1.306 | FP-Norm(final)=2.663 | 3780.7 samples/s | 59.1 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01432 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.309 | FP-Norm(final)=2.665 | 4037.1 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step13600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.5] | Loss=0.20112 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.663 | 3707.3 samples/s | 57.9 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03491 | Reg=0.00094 | acc=0.9531 | FP-Norm=0.931 | FP-Norm(final)=2.651 | 3520.2 samples/s | 55.0 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02967 | Reg=0.00122 | acc=0.9844 | FP-Norm=1.075 | FP-Norm(final)=2.648 | 3767.7 samples/s | 58.9 steps/s
[Step=12950 Epoch=63.2] | Loss=0.02792 | Reg=0.00139 | acc=1.0000 | FP-Norm=1.157 | FP-Norm(final)=2.647 | 3726.8 samples/s | 58.2 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02577 | Reg=0.00152 | acc=0.9688 | FP-Norm=1.213 | FP-Norm(final)=2.648 | 4869.9 samples/s | 76.1 steps/s
[Step=13050 Epoch=63.7] | Loss=0.02387 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.254 | FP-Norm(final)=2.648 | 1604.1 samples/s | 25.1 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02200 | Reg=0.00167 | acc=0.9844 | FP-Norm=1.275 | FP-Norm(final)=2.649 | 3709.5 samples/s | 58.0 steps/s
[Step=13150 Epoch=64.2] | Loss=0.02004 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.289 | FP-Norm(final)=2.652 | 3767.9 samples/s | 58.9 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01931 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.300 | FP-Norm(final)=2.654 | 4596.2 samples/s | 71.8 steps/s
[Step=13250 Epoch=64.7] | Loss=0.01828 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.314 | FP-Norm(final)=2.656 | 1622.6 samples/s | 25.4 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01778 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.325 | FP-Norm(final)=2.658 | 3738.4 samples/s | 58.4 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01705 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.334 | FP-Norm(final)=2.659 | 3803.6 samples/s | 59.4 steps/s
[Step=13400 Epoch=65.4] | Loss=0.01627 | Reg=0.00183 | acc=0.9844 | FP-Norm=1.342 | FP-Norm(final)=2.661 | 4344.4 samples/s | 67.9 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01560 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.349 | FP-Norm(final)=2.663 | 1677.2 samples/s | 26.2 steps/s
[Step=13500 Epoch=65.9] | Loss=0.01510 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.354 | FP-Norm(final)=2.665 | 3689.1 samples/s | 57.6 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01469 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.359 | FP-Norm(final)=2.666 | 3782.0 samples/s | 59.1 steps/s
[Step=13600 Epoch=66.4] | Loss=0.01431 | Reg=0.00188 | acc=1.0000 | FP-Norm=1.363 | FP-Norm(final)=2.668 | 4163.4 samples/s | 65.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step13600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.4] | Loss=0.06174 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.663 | 4130.2 samples/s | 64.5 steps/s
[Step=12850 Epoch=62.6] | Loss=0.03462 | Reg=0.00082 | acc=0.9688 | FP-Norm=0.863 | FP-Norm(final)=2.652 | 3270.2 samples/s | 51.1 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02833 | Reg=0.00104 | acc=0.9844 | FP-Norm=0.993 | FP-Norm(final)=2.647 | 3755.0 samples/s | 58.7 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02673 | Reg=0.00116 | acc=0.9531 | FP-Norm=1.056 | FP-Norm(final)=2.647 | 3764.2 samples/s | 58.8 steps/s
[Step=13000 Epoch=63.3] | Loss=0.02481 | Reg=0.00127 | acc=0.9844 | FP-Norm=1.110 | FP-Norm(final)=2.647 | 4825.9 samples/s | 75.4 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02223 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.153 | FP-Norm(final)=2.648 | 1623.6 samples/s | 25.4 steps/s
[Step=13100 Epoch=63.8] | Loss=0.02084 | Reg=0.00143 | acc=0.9688 | FP-Norm=1.181 | FP-Norm(final)=2.651 | 3777.7 samples/s | 59.0 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01920 | Reg=0.00147 | acc=0.9688 | FP-Norm=1.198 | FP-Norm(final)=2.652 | 3771.6 samples/s | 58.9 steps/s
[Step=13200 Epoch=64.3] | Loss=0.01884 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.211 | FP-Norm(final)=2.655 | 4569.8 samples/s | 71.4 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01807 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.228 | FP-Norm(final)=2.656 | 1664.2 samples/s | 26.0 steps/s
[Step=13300 Epoch=64.8] | Loss=0.01750 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.241 | FP-Norm(final)=2.658 | 3749.3 samples/s | 58.6 steps/s
[Step=13350 Epoch=65.0] | Loss=0.01675 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.252 | FP-Norm(final)=2.660 | 3785.1 samples/s | 59.1 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01637 | Reg=0.00162 | acc=0.9844 | FP-Norm=1.261 | FP-Norm(final)=2.662 | 4262.9 samples/s | 66.6 steps/s
[Step=13450 Epoch=65.5] | Loss=0.01561 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.270 | FP-Norm(final)=2.664 | 1690.2 samples/s | 26.4 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01491 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.276 | FP-Norm(final)=2.666 | 3757.9 samples/s | 58.7 steps/s
[Step=13550 Epoch=66.0] | Loss=0.01451 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.280 | FP-Norm(final)=2.668 | 3785.8 samples/s | 59.2 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01407 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.285 | FP-Norm(final)=2.670 | 4048.2 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step13600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.4] | Loss=0.09128 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.664 | 3608.9 samples/s | 56.4 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03400 | Reg=0.00080 | acc=0.9844 | FP-Norm=0.854 | FP-Norm(final)=2.662 | 3660.9 samples/s | 57.2 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02974 | Reg=0.00102 | acc=0.9844 | FP-Norm=0.983 | FP-Norm(final)=2.656 | 3766.3 samples/s | 58.8 steps/s
[Step=12950 Epoch=63.2] | Loss=0.02488 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.035 | FP-Norm(final)=2.656 | 3793.1 samples/s | 59.3 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02326 | Reg=0.00118 | acc=0.9844 | FP-Norm=1.070 | FP-Norm(final)=2.657 | 4808.4 samples/s | 75.1 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02082 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.099 | FP-Norm(final)=2.658 | 1626.7 samples/s | 25.4 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01914 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.117 | FP-Norm(final)=2.659 | 3791.1 samples/s | 59.2 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01811 | Reg=0.00130 | acc=0.9844 | FP-Norm=1.131 | FP-Norm(final)=2.661 | 3784.3 samples/s | 59.1 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01724 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.142 | FP-Norm(final)=2.663 | 4539.6 samples/s | 70.9 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01649 | Reg=0.00135 | acc=1.0000 | FP-Norm=1.155 | FP-Norm(final)=2.665 | 1658.4 samples/s | 25.9 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01546 | Reg=0.00138 | acc=1.0000 | FP-Norm=1.165 | FP-Norm(final)=2.668 | 3756.4 samples/s | 58.7 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01488 | Reg=0.00139 | acc=0.9844 | FP-Norm=1.171 | FP-Norm(final)=2.671 | 3781.3 samples/s | 59.1 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01425 | Reg=0.00140 | acc=0.9844 | FP-Norm=1.178 | FP-Norm(final)=2.673 | 4294.9 samples/s | 67.1 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01386 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.184 | FP-Norm(final)=2.676 | 1714.6 samples/s | 26.8 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01346 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.192 | FP-Norm(final)=2.678 | 3745.7 samples/s | 58.5 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01333 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.198 | FP-Norm(final)=2.679 | 3724.5 samples/s | 58.2 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01286 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.203 | FP-Norm(final)=2.680 | 4055.9 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step13600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.8] | Loss=0.02778 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.664 | 3514.9 samples/s | 54.9 steps/s
[Step=12850 Epoch=63.0] | Loss=0.03208 | Reg=0.00098 | acc=0.9844 | FP-Norm=0.941 | FP-Norm(final)=2.656 | 3831.1 samples/s | 59.9 steps/s
[Step=12900 Epoch=63.3] | Loss=0.02798 | Reg=0.00123 | acc=0.9531 | FP-Norm=1.078 | FP-Norm(final)=2.654 | 3777.8 samples/s | 59.0 steps/s
[Step=12950 Epoch=63.5] | Loss=0.02662 | Reg=0.00137 | acc=0.9688 | FP-Norm=1.146 | FP-Norm(final)=2.650 | 3775.0 samples/s | 59.0 steps/s
[Step=13000 Epoch=63.7] | Loss=0.02539 | Reg=0.00145 | acc=0.9844 | FP-Norm=1.186 | FP-Norm(final)=2.648 | 4900.3 samples/s | 76.6 steps/s
[Step=13050 Epoch=64.0] | Loss=0.02265 | Reg=0.00152 | acc=0.9844 | FP-Norm=1.215 | FP-Norm(final)=2.649 | 1609.5 samples/s | 25.1 steps/s
[Step=13100 Epoch=64.2] | Loss=0.02060 | Reg=0.00155 | acc=0.9844 | FP-Norm=1.233 | FP-Norm(final)=2.651 | 3766.6 samples/s | 58.9 steps/s
[Step=13150 Epoch=64.5] | Loss=0.01976 | Reg=0.00157 | acc=0.9844 | FP-Norm=1.243 | FP-Norm(final)=2.652 | 3763.1 samples/s | 58.8 steps/s
[Step=13200 Epoch=64.7] | Loss=0.01870 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.252 | FP-Norm(final)=2.653 | 4696.9 samples/s | 73.4 steps/s
[Step=13250 Epoch=65.0] | Loss=0.01757 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.259 | FP-Norm(final)=2.655 | 1636.1 samples/s | 25.6 steps/s
[Step=13300 Epoch=65.2] | Loss=0.01669 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.264 | FP-Norm(final)=2.657 | 3776.9 samples/s | 59.0 steps/s
[Step=13350 Epoch=65.5] | Loss=0.01614 | Reg=0.00163 | acc=0.9844 | FP-Norm=1.269 | FP-Norm(final)=2.659 | 3777.6 samples/s | 59.0 steps/s
[Step=13400 Epoch=65.7] | Loss=0.01574 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.275 | FP-Norm(final)=2.660 | 4496.9 samples/s | 70.3 steps/s
[Step=13450 Epoch=66.0] | Loss=0.01521 | Reg=0.00166 | acc=0.9844 | FP-Norm=1.282 | FP-Norm(final)=2.661 | 1650.9 samples/s | 25.8 steps/s
[Step=13500 Epoch=66.2] | Loss=0.01466 | Reg=0.00167 | acc=0.9844 | FP-Norm=1.286 | FP-Norm(final)=2.663 | 3771.5 samples/s | 58.9 steps/s
[Step=13550 Epoch=66.4] | Loss=0.01399 | Reg=0.00168 | acc=0.9844 | FP-Norm=1.290 | FP-Norm(final)=2.664 | 3764.1 samples/s | 58.8 steps/s
[Step=13600 Epoch=66.7] | Loss=0.01348 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.293 | FP-Norm(final)=2.666 | 4316.9 samples/s | 67.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step13600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=121.3] | Loss=0.02968 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.663 | 3503.8 samples/s | 54.7 steps/s
[Step=12850 Epoch=121.8] | Loss=0.00571 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.219 | FP-Norm(final)=2.663 | 3374.6 samples/s | 52.7 steps/s
[Step=12900 Epoch=122.2] | Loss=0.00434 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.315 | FP-Norm(final)=2.665 | 4616.4 samples/s | 72.1 steps/s
[Step=12950 Epoch=122.7] | Loss=0.00300 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.342 | FP-Norm(final)=2.665 | 1545.0 samples/s | 24.1 steps/s
[Step=13000 Epoch=123.2] | Loss=0.00229 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.328 | FP-Norm(final)=2.667 | 4356.8 samples/s | 68.1 steps/s
[Step=13050 Epoch=123.7] | Loss=0.00186 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.305 | FP-Norm(final)=2.668 | 1589.3 samples/s | 24.8 steps/s
[Step=13100 Epoch=124.1] | Loss=0.00155 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.279 | FP-Norm(final)=2.670 | 4072.2 samples/s | 63.6 steps/s
[Step=13150 Epoch=124.6] | Loss=0.00133 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.252 | FP-Norm(final)=2.671 | 1660.9 samples/s | 26.0 steps/s
[Step=13200 Epoch=125.1] | Loss=0.00117 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.225 | FP-Norm(final)=2.671 | 3868.1 samples/s | 60.4 steps/s
[Step=13250 Epoch=125.6] | Loss=0.00104 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.200 | FP-Norm(final)=2.672 | 1695.3 samples/s | 26.5 steps/s
[Step=13300 Epoch=126.0] | Loss=0.00094 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.176 | FP-Norm(final)=2.673 | 3620.6 samples/s | 56.6 steps/s
[Step=13350 Epoch=126.5] | Loss=0.00086 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.153 | FP-Norm(final)=2.673 | 1695.5 samples/s | 26.5 steps/s
[Step=13400 Epoch=127.0] | Loss=0.00079 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.131 | FP-Norm(final)=2.674 | 3603.7 samples/s | 56.3 steps/s
[Step=13450 Epoch=127.5] | Loss=0.00073 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.110 | FP-Norm(final)=2.674 | 1708.2 samples/s | 26.7 steps/s
[Step=13500 Epoch=127.9] | Loss=0.00068 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.091 | FP-Norm(final)=2.675 | 3569.8 samples/s | 55.8 steps/s
[Step=13550 Epoch=128.4] | Loss=0.00064 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.072 | FP-Norm(final)=2.675 | 1753.2 samples/s | 27.4 steps/s
[Step=13600 Epoch=128.9] | Loss=0.00060 | Reg=0.00116 | acc=1.0000 | FP-Norm=1.054 | FP-Norm(final)=2.676 | 3572.8 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step13600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=121.8] | Loss=0.04482 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.663 | 3414.3 samples/s | 53.3 steps/s
[Step=12850 Epoch=122.2] | Loss=0.01826 | Reg=0.00314 | acc=1.0000 | FP-Norm=1.672 | FP-Norm(final)=2.629 | 3441.4 samples/s | 53.8 steps/s
[Step=12900 Epoch=122.7] | Loss=0.00994 | Reg=0.00388 | acc=1.0000 | FP-Norm=1.910 | FP-Norm(final)=2.620 | 4652.7 samples/s | 72.7 steps/s
[Step=12950 Epoch=123.2] | Loss=0.00672 | Reg=0.00386 | acc=1.0000 | FP-Norm=1.924 | FP-Norm(final)=2.621 | 1539.3 samples/s | 24.1 steps/s
[Step=13000 Epoch=123.7] | Loss=0.00505 | Reg=0.00372 | acc=1.0000 | FP-Norm=1.898 | FP-Norm(final)=2.623 | 4358.2 samples/s | 68.1 steps/s
[Step=13050 Epoch=124.1] | Loss=0.00405 | Reg=0.00357 | acc=1.0000 | FP-Norm=1.864 | FP-Norm(final)=2.625 | 1593.0 samples/s | 24.9 steps/s
[Step=13100 Epoch=124.6] | Loss=0.00338 | Reg=0.00343 | acc=1.0000 | FP-Norm=1.829 | FP-Norm(final)=2.627 | 4078.6 samples/s | 63.7 steps/s
[Step=13150 Epoch=125.1] | Loss=0.00291 | Reg=0.00330 | acc=1.0000 | FP-Norm=1.794 | FP-Norm(final)=2.629 | 1615.7 samples/s | 25.2 steps/s
[Step=13200 Epoch=125.6] | Loss=0.00255 | Reg=0.00318 | acc=1.0000 | FP-Norm=1.760 | FP-Norm(final)=2.631 | 3807.5 samples/s | 59.5 steps/s
[Step=13250 Epoch=126.0] | Loss=0.00227 | Reg=0.00307 | acc=1.0000 | FP-Norm=1.728 | FP-Norm(final)=2.633 | 1676.2 samples/s | 26.2 steps/s
[Step=13300 Epoch=126.5] | Loss=0.00204 | Reg=0.00296 | acc=1.0000 | FP-Norm=1.697 | FP-Norm(final)=2.634 | 3619.8 samples/s | 56.6 steps/s
[Step=13350 Epoch=127.0] | Loss=0.00186 | Reg=0.00286 | acc=1.0000 | FP-Norm=1.668 | FP-Norm(final)=2.636 | 1688.4 samples/s | 26.4 steps/s
[Step=13400 Epoch=127.5] | Loss=0.00171 | Reg=0.00277 | acc=1.0000 | FP-Norm=1.640 | FP-Norm(final)=2.637 | 3507.8 samples/s | 54.8 steps/s
[Step=13450 Epoch=127.9] | Loss=0.00158 | Reg=0.00269 | acc=1.0000 | FP-Norm=1.613 | FP-Norm(final)=2.639 | 1692.6 samples/s | 26.4 steps/s
[Step=13500 Epoch=128.4] | Loss=0.00147 | Reg=0.00261 | acc=1.0000 | FP-Norm=1.587 | FP-Norm(final)=2.640 | 3549.5 samples/s | 55.5 steps/s
[Step=13550 Epoch=128.9] | Loss=0.00137 | Reg=0.00253 | acc=1.0000 | FP-Norm=1.562 | FP-Norm(final)=2.641 | 1712.4 samples/s | 26.8 steps/s
[Step=13600 Epoch=129.4] | Loss=0.00129 | Reg=0.00246 | acc=1.0000 | FP-Norm=1.538 | FP-Norm(final)=2.643 | 3533.2 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step13600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=122.2] | Loss=0.25389 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.661 | 3655.2 samples/s | 57.1 steps/s
[Step=12850 Epoch=122.7] | Loss=0.01138 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.399 | FP-Norm(final)=2.638 | 3242.1 samples/s | 50.7 steps/s
[Step=12900 Epoch=123.2] | Loss=0.00678 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.484 | FP-Norm(final)=2.638 | 4705.0 samples/s | 73.5 steps/s
[Step=12950 Epoch=123.7] | Loss=0.00457 | Reg=0.00223 | acc=1.0000 | FP-Norm=1.474 | FP-Norm(final)=2.637 | 1530.9 samples/s | 23.9 steps/s
[Step=13000 Epoch=124.1] | Loss=0.00348 | Reg=0.00214 | acc=1.0000 | FP-Norm=1.446 | FP-Norm(final)=2.639 | 4388.4 samples/s | 68.6 steps/s
[Step=13050 Epoch=124.6] | Loss=0.00279 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.413 | FP-Norm(final)=2.640 | 1568.9 samples/s | 24.5 steps/s
[Step=13100 Epoch=125.1] | Loss=0.00233 | Reg=0.00194 | acc=1.0000 | FP-Norm=1.378 | FP-Norm(final)=2.641 | 4177.5 samples/s | 65.3 steps/s
[Step=13150 Epoch=125.6] | Loss=0.00200 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.346 | FP-Norm(final)=2.642 | 1602.1 samples/s | 25.0 steps/s
[Step=13200 Epoch=126.1] | Loss=0.00175 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.315 | FP-Norm(final)=2.643 | 3995.0 samples/s | 62.4 steps/s
[Step=13250 Epoch=126.5] | Loss=0.00156 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.286 | FP-Norm(final)=2.644 | 1624.8 samples/s | 25.4 steps/s
[Step=13300 Epoch=127.0] | Loss=0.00141 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.259 | FP-Norm(final)=2.645 | 3774.7 samples/s | 59.0 steps/s
[Step=13350 Epoch=127.5] | Loss=0.00128 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.233 | FP-Norm(final)=2.646 | 1651.0 samples/s | 25.8 steps/s
[Step=13400 Epoch=128.0] | Loss=0.00118 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.209 | FP-Norm(final)=2.647 | 3596.2 samples/s | 56.2 steps/s
[Step=13450 Epoch=128.4] | Loss=0.00109 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.186 | FP-Norm(final)=2.648 | 1698.4 samples/s | 26.5 steps/s
[Step=13500 Epoch=128.9] | Loss=0.00101 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.164 | FP-Norm(final)=2.649 | 3585.0 samples/s | 56.0 steps/s
[Step=13550 Epoch=129.4] | Loss=0.00095 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.143 | FP-Norm(final)=2.650 | 1706.2 samples/s | 26.7 steps/s
[Step=13600 Epoch=129.9] | Loss=0.00089 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.123 | FP-Norm(final)=2.651 | 3582.5 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step13600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=120.6] | Loss=0.06162 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.663 | 3499.0 samples/s | 54.7 steps/s
[Step=12850 Epoch=121.1] | Loss=0.00834 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.457 | FP-Norm(final)=2.658 | 2955.8 samples/s | 46.2 steps/s
[Step=12900 Epoch=121.6] | Loss=0.00518 | Reg=0.00258 | acc=1.0000 | FP-Norm=1.573 | FP-Norm(final)=2.655 | 4636.5 samples/s | 72.4 steps/s
[Step=12950 Epoch=122.0] | Loss=0.00381 | Reg=0.00259 | acc=1.0000 | FP-Norm=1.586 | FP-Norm(final)=2.657 | 1554.0 samples/s | 24.3 steps/s
[Step=13000 Epoch=122.5] | Loss=0.00291 | Reg=0.00254 | acc=1.0000 | FP-Norm=1.578 | FP-Norm(final)=2.659 | 4279.7 samples/s | 66.9 steps/s
[Step=13050 Epoch=123.0] | Loss=0.00233 | Reg=0.00246 | acc=1.0000 | FP-Norm=1.555 | FP-Norm(final)=2.661 | 1578.0 samples/s | 24.7 steps/s
[Step=13100 Epoch=123.4] | Loss=0.00195 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.526 | FP-Norm(final)=2.662 | 3966.9 samples/s | 62.0 steps/s
[Step=13150 Epoch=123.9] | Loss=0.00167 | Reg=0.00228 | acc=1.0000 | FP-Norm=1.496 | FP-Norm(final)=2.663 | 1623.2 samples/s | 25.4 steps/s
[Step=13200 Epoch=124.4] | Loss=0.00147 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.467 | FP-Norm(final)=2.664 | 3730.6 samples/s | 58.3 steps/s
[Step=13250 Epoch=124.9] | Loss=0.00130 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.439 | FP-Norm(final)=2.665 | 1675.2 samples/s | 26.2 steps/s
[Step=13300 Epoch=125.3] | Loss=0.00118 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.412 | FP-Norm(final)=2.666 | 3551.1 samples/s | 55.5 steps/s
[Step=13350 Epoch=125.8] | Loss=0.00107 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.386 | FP-Norm(final)=2.666 | 1711.1 samples/s | 26.7 steps/s
[Step=13400 Epoch=126.3] | Loss=0.00098 | Reg=0.00191 | acc=1.0000 | FP-Norm=1.361 | FP-Norm(final)=2.667 | 3557.0 samples/s | 55.6 steps/s
[Step=13450 Epoch=126.7] | Loss=0.00091 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.337 | FP-Norm(final)=2.667 | 1720.3 samples/s | 26.9 steps/s
[Step=13500 Epoch=127.2] | Loss=0.00085 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.315 | FP-Norm(final)=2.668 | 3528.9 samples/s | 55.1 steps/s
[Step=13550 Epoch=127.7] | Loss=0.00079 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.292 | FP-Norm(final)=2.668 | 1796.6 samples/s | 28.1 steps/s
[Step=13600 Epoch=128.2] | Loss=0.00074 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.271 | FP-Norm(final)=2.669 | 3388.2 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step13600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=122.0] | Loss=0.06972 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.663 | 3518.5 samples/s | 55.0 steps/s
[Step=12850 Epoch=122.5] | Loss=0.00814 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.186 | FP-Norm(final)=2.656 | 3489.6 samples/s | 54.5 steps/s
[Step=12900 Epoch=122.9] | Loss=0.00438 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.322 | FP-Norm(final)=2.654 | 4720.0 samples/s | 73.8 steps/s
[Step=12950 Epoch=123.4] | Loss=0.00296 | Reg=0.00182 | acc=1.0000 | FP-Norm=1.326 | FP-Norm(final)=2.656 | 1536.2 samples/s | 24.0 steps/s
[Step=13000 Epoch=123.9] | Loss=0.00224 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.306 | FP-Norm(final)=2.658 | 4392.4 samples/s | 68.6 steps/s
[Step=13050 Epoch=124.4] | Loss=0.00180 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.279 | FP-Norm(final)=2.659 | 1580.3 samples/s | 24.7 steps/s
[Step=13100 Epoch=124.9] | Loss=0.00150 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.253 | FP-Norm(final)=2.660 | 4126.3 samples/s | 64.5 steps/s
[Step=13150 Epoch=125.3] | Loss=0.00129 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.227 | FP-Norm(final)=2.661 | 1610.5 samples/s | 25.2 steps/s
[Step=13200 Epoch=125.8] | Loss=0.00113 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.202 | FP-Norm(final)=2.662 | 3922.7 samples/s | 61.3 steps/s
[Step=13250 Epoch=126.3] | Loss=0.00101 | Reg=0.00143 | acc=1.0000 | FP-Norm=1.179 | FP-Norm(final)=2.663 | 1632.1 samples/s | 25.5 steps/s
[Step=13300 Epoch=126.8] | Loss=0.00091 | Reg=0.00138 | acc=1.0000 | FP-Norm=1.157 | FP-Norm(final)=2.664 | 3742.7 samples/s | 58.5 steps/s
[Step=13350 Epoch=127.2] | Loss=0.00083 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.136 | FP-Norm(final)=2.665 | 1671.6 samples/s | 26.1 steps/s
[Step=13400 Epoch=127.7] | Loss=0.00076 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.115 | FP-Norm(final)=2.666 | 3624.1 samples/s | 56.6 steps/s
[Step=13450 Epoch=128.2] | Loss=0.00071 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.096 | FP-Norm(final)=2.666 | 1702.5 samples/s | 26.6 steps/s
[Step=13500 Epoch=128.7] | Loss=0.00066 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.078 | FP-Norm(final)=2.667 | 3565.0 samples/s | 55.7 steps/s
[Step=13550 Epoch=129.1] | Loss=0.00062 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.060 | FP-Norm(final)=2.668 | 1701.6 samples/s | 26.6 steps/s
[Step=13600 Epoch=129.6] | Loss=0.00058 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.043 | FP-Norm(final)=2.668 | 3603.0 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21091 | acc=0.8587 | tpr=0.8020 | fpr=0.0183 | 3616.2 samples/s | 14.1 steps/s
Avg test loss: 0.21086, Avg test acc: 0.86053, Avg tpr: 0.80608, Avg fpr: 0.01974, total FA: 154

Testing server on iccad2012
[Step=  50] | Loss=0.51236 | acc=0.8097 | tpr=0.9690 | fpr=0.1932 | 3631.3 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.52651 | acc=0.8077 | tpr=0.9701 | fpr=0.1953 | 6802.4 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.53204 | acc=0.8058 | tpr=0.9697 | fpr=0.1972 | 6692.7 samples/s | 26.1 steps/s
[Step= 200] | Loss=0.53250 | acc=0.8056 | tpr=0.9716 | fpr=0.1974 | 6995.7 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.53085 | acc=0.8055 | tpr=0.9694 | fpr=0.1975 | 6759.2 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.53417 | acc=0.8047 | tpr=0.9680 | fpr=0.1982 | 6898.0 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.53430 | acc=0.8053 | tpr=0.9687 | fpr=0.1977 | 6849.7 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.53478 | acc=0.8051 | tpr=0.9688 | fpr=0.1979 | 6704.9 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.53732 | acc=0.8049 | tpr=0.9688 | fpr=0.1980 | 6823.4 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.53860 | acc=0.8046 | tpr=0.9705 | fpr=0.1984 | 6780.6 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.53813 | acc=0.8047 | tpr=0.9706 | fpr=0.1983 | 12100.2 samples/s | 47.3 steps/s
Avg test loss: 0.53815, Avg test acc: 0.80477, Avg tpr: 0.97068, Avg fpr: 0.19825, total FA: 27526

server round 17/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.3] | Loss=0.09962 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.684 | 3599.6 samples/s | 56.2 steps/s
[Step=13650 Epoch=66.6] | Loss=0.02455 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.921 | FP-Norm(final)=2.686 | 3693.8 samples/s | 57.7 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02385 | Reg=0.00109 | acc=0.9688 | FP-Norm=1.022 | FP-Norm(final)=2.685 | 3728.5 samples/s | 58.3 steps/s
[Step=13750 Epoch=67.0] | Loss=0.02339 | Reg=0.00123 | acc=0.9688 | FP-Norm=1.092 | FP-Norm(final)=2.681 | 3758.3 samples/s | 58.7 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02238 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.137 | FP-Norm(final)=2.678 | 4808.3 samples/s | 75.1 steps/s
[Step=13850 Epoch=67.5] | Loss=0.02008 | Reg=0.00139 | acc=0.9844 | FP-Norm=1.166 | FP-Norm(final)=2.678 | 1613.8 samples/s | 25.2 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01850 | Reg=0.00144 | acc=0.9688 | FP-Norm=1.186 | FP-Norm(final)=2.679 | 3764.2 samples/s | 58.8 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01841 | Reg=0.00147 | acc=0.9844 | FP-Norm=1.203 | FP-Norm(final)=2.679 | 3704.1 samples/s | 57.9 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01791 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.219 | FP-Norm(final)=2.679 | 4570.4 samples/s | 71.4 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01658 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.228 | FP-Norm(final)=2.679 | 1656.5 samples/s | 25.9 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01592 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.235 | FP-Norm(final)=2.681 | 3765.1 samples/s | 58.8 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01556 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.242 | FP-Norm(final)=2.681 | 3768.2 samples/s | 58.9 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01517 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.247 | FP-Norm(final)=2.682 | 4302.1 samples/s | 67.2 steps/s
[Step=14250 Epoch=69.5] | Loss=0.01442 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.252 | FP-Norm(final)=2.683 | 1687.0 samples/s | 26.4 steps/s
[Step=14300 Epoch=69.7] | Loss=0.01389 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.256 | FP-Norm(final)=2.684 | 3768.6 samples/s | 58.9 steps/s
[Step=14350 Epoch=70.0] | Loss=0.01353 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.260 | FP-Norm(final)=2.685 | 3756.8 samples/s | 58.7 steps/s
[Step=14400 Epoch=70.2] | Loss=0.01334 | Reg=0.00161 | acc=0.9844 | FP-Norm=1.264 | FP-Norm(final)=2.686 | 4021.1 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step14400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.4] | Loss=0.13821 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.684 | 3511.1 samples/s | 54.9 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03298 | Reg=0.00095 | acc=0.9688 | FP-Norm=0.931 | FP-Norm(final)=2.674 | 3687.5 samples/s | 57.6 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02757 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.076 | FP-Norm(final)=2.672 | 3773.5 samples/s | 59.0 steps/s
[Step=13750 Epoch=67.1] | Loss=0.02680 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.144 | FP-Norm(final)=2.672 | 3789.2 samples/s | 59.2 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02416 | Reg=0.00145 | acc=0.9375 | FP-Norm=1.185 | FP-Norm(final)=2.673 | 4818.1 samples/s | 75.3 steps/s
[Step=13850 Epoch=67.6] | Loss=0.02160 | Reg=0.00150 | acc=0.9844 | FP-Norm=1.208 | FP-Norm(final)=2.675 | 1618.2 samples/s | 25.3 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01995 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.221 | FP-Norm(final)=2.678 | 3773.1 samples/s | 59.0 steps/s
[Step=13950 Epoch=68.1] | Loss=0.01870 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.233 | FP-Norm(final)=2.681 | 3764.1 samples/s | 58.8 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01756 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.242 | FP-Norm(final)=2.684 | 4590.3 samples/s | 71.7 steps/s
[Step=14050 Epoch=68.6] | Loss=0.01685 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.247 | FP-Norm(final)=2.686 | 1636.6 samples/s | 25.6 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01600 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.249 | FP-Norm(final)=2.688 | 3802.6 samples/s | 59.4 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01562 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.251 | FP-Norm(final)=2.690 | 3732.8 samples/s | 58.3 steps/s
[Step=14200 Epoch=69.3] | Loss=0.01497 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.253 | FP-Norm(final)=2.691 | 4386.5 samples/s | 68.5 steps/s
[Step=14250 Epoch=69.5] | Loss=0.01438 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.254 | FP-Norm(final)=2.693 | 1683.0 samples/s | 26.3 steps/s
[Step=14300 Epoch=69.8] | Loss=0.01367 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.254 | FP-Norm(final)=2.695 | 3761.4 samples/s | 58.8 steps/s
[Step=14350 Epoch=70.0] | Loss=0.01327 | Reg=0.00159 | acc=0.9844 | FP-Norm=1.254 | FP-Norm(final)=2.697 | 3744.1 samples/s | 58.5 steps/s
[Step=14400 Epoch=70.3] | Loss=0.01289 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.254 | FP-Norm(final)=2.699 | 4162.3 samples/s | 65.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step14400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.3] | Loss=0.11637 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.684 | 3742.4 samples/s | 58.5 steps/s
[Step=13650 Epoch=66.5] | Loss=0.03830 | Reg=0.00093 | acc=0.9531 | FP-Norm=0.918 | FP-Norm(final)=2.671 | 3683.6 samples/s | 57.6 steps/s
[Step=13700 Epoch=66.8] | Loss=0.03179 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.071 | FP-Norm(final)=2.667 | 3787.1 samples/s | 59.2 steps/s
[Step=13750 Epoch=67.0] | Loss=0.02784 | Reg=0.00136 | acc=0.9844 | FP-Norm=1.141 | FP-Norm(final)=2.668 | 3781.2 samples/s | 59.1 steps/s
[Step=13800 Epoch=67.2] | Loss=0.02606 | Reg=0.00146 | acc=0.9844 | FP-Norm=1.187 | FP-Norm(final)=2.667 | 4863.3 samples/s | 76.0 steps/s
[Step=13850 Epoch=67.5] | Loss=0.02302 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.221 | FP-Norm(final)=2.666 | 1620.7 samples/s | 25.3 steps/s
[Step=13900 Epoch=67.7] | Loss=0.02121 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.240 | FP-Norm(final)=2.669 | 3766.6 samples/s | 58.9 steps/s
[Step=13950 Epoch=68.0] | Loss=0.02026 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.257 | FP-Norm(final)=2.670 | 3719.1 samples/s | 58.1 steps/s
[Step=14000 Epoch=68.2] | Loss=0.01868 | Reg=0.00164 | acc=0.9844 | FP-Norm=1.267 | FP-Norm(final)=2.672 | 4536.1 samples/s | 70.9 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01753 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.278 | FP-Norm(final)=2.675 | 1666.0 samples/s | 26.0 steps/s
[Step=14100 Epoch=68.7] | Loss=0.01679 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.287 | FP-Norm(final)=2.677 | 3773.2 samples/s | 59.0 steps/s
[Step=14150 Epoch=68.9] | Loss=0.01610 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.294 | FP-Norm(final)=2.680 | 3766.9 samples/s | 58.9 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01554 | Reg=0.00172 | acc=0.9688 | FP-Norm=1.301 | FP-Norm(final)=2.682 | 4301.2 samples/s | 67.2 steps/s
[Step=14250 Epoch=69.4] | Loss=0.01523 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.309 | FP-Norm(final)=2.684 | 1692.1 samples/s | 26.4 steps/s
[Step=14300 Epoch=69.7] | Loss=0.01505 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.315 | FP-Norm(final)=2.685 | 3725.4 samples/s | 58.2 steps/s
[Step=14350 Epoch=69.9] | Loss=0.01469 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.322 | FP-Norm(final)=2.686 | 3785.5 samples/s | 59.1 steps/s
[Step=14400 Epoch=70.2] | Loss=0.01435 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.326 | FP-Norm(final)=2.688 | 4062.2 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step14400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.3] | Loss=0.10440 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.685 | 3611.9 samples/s | 56.4 steps/s
[Step=13650 Epoch=66.6] | Loss=0.02920 | Reg=0.00088 | acc=0.9375 | FP-Norm=0.901 | FP-Norm(final)=2.681 | 3712.0 samples/s | 58.0 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02655 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.008 | FP-Norm(final)=2.677 | 3813.5 samples/s | 59.6 steps/s
[Step=13750 Epoch=67.1] | Loss=0.02410 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.080 | FP-Norm(final)=2.674 | 3757.8 samples/s | 58.7 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02212 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.126 | FP-Norm(final)=2.672 | 4865.8 samples/s | 76.0 steps/s
[Step=13850 Epoch=67.5] | Loss=0.02300 | Reg=0.00149 | acc=0.9844 | FP-Norm=1.199 | FP-Norm(final)=2.671 | 1616.9 samples/s | 25.3 steps/s
[Step=13900 Epoch=67.8] | Loss=0.02196 | Reg=0.00166 | acc=0.9688 | FP-Norm=1.262 | FP-Norm(final)=2.671 | 3778.6 samples/s | 59.0 steps/s
[Step=13950 Epoch=68.0] | Loss=0.02106 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.304 | FP-Norm(final)=2.672 | 3731.6 samples/s | 58.3 steps/s
[Step=14000 Epoch=68.3] | Loss=0.02017 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.332 | FP-Norm(final)=2.673 | 4543.2 samples/s | 71.0 steps/s
[Step=14050 Epoch=68.5] | Loss=0.02022 | Reg=0.00194 | acc=0.9375 | FP-Norm=1.367 | FP-Norm(final)=2.673 | 1635.9 samples/s | 25.6 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01945 | Reg=0.00204 | acc=0.9844 | FP-Norm=1.404 | FP-Norm(final)=2.673 | 3757.8 samples/s | 58.7 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01902 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.431 | FP-Norm(final)=2.674 | 3808.3 samples/s | 59.5 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01832 | Reg=0.00218 | acc=0.9688 | FP-Norm=1.451 | FP-Norm(final)=2.675 | 4265.3 samples/s | 66.6 steps/s
[Step=14250 Epoch=69.5] | Loss=0.01745 | Reg=0.00222 | acc=0.9844 | FP-Norm=1.467 | FP-Norm(final)=2.676 | 1686.2 samples/s | 26.3 steps/s
[Step=14300 Epoch=69.7] | Loss=0.01697 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.478 | FP-Norm(final)=2.678 | 3749.4 samples/s | 58.6 steps/s
[Step=14350 Epoch=70.0] | Loss=0.01640 | Reg=0.00227 | acc=1.0000 | FP-Norm=1.487 | FP-Norm(final)=2.679 | 3791.6 samples/s | 59.2 steps/s
[Step=14400 Epoch=70.2] | Loss=0.01572 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.493 | FP-Norm(final)=2.680 | 4036.4 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step14400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.7] | Loss=0.12078 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.684 | 3871.0 samples/s | 60.5 steps/s
[Step=13650 Epoch=66.9] | Loss=0.02836 | Reg=0.00093 | acc=0.9375 | FP-Norm=0.925 | FP-Norm(final)=2.681 | 3627.5 samples/s | 56.7 steps/s
[Step=13700 Epoch=67.2] | Loss=0.02609 | Reg=0.00112 | acc=0.9844 | FP-Norm=1.034 | FP-Norm(final)=2.677 | 3767.0 samples/s | 58.9 steps/s
[Step=13750 Epoch=67.4] | Loss=0.02563 | Reg=0.00129 | acc=0.9688 | FP-Norm=1.115 | FP-Norm(final)=2.672 | 3771.9 samples/s | 58.9 steps/s
[Step=13800 Epoch=67.7] | Loss=0.02385 | Reg=0.00139 | acc=0.9844 | FP-Norm=1.161 | FP-Norm(final)=2.672 | 4907.7 samples/s | 76.7 steps/s
[Step=13850 Epoch=67.9] | Loss=0.02253 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.202 | FP-Norm(final)=2.671 | 1617.6 samples/s | 25.3 steps/s
[Step=13900 Epoch=68.2] | Loss=0.02074 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.229 | FP-Norm(final)=2.671 | 3762.2 samples/s | 58.8 steps/s
[Step=13950 Epoch=68.4] | Loss=0.01937 | Reg=0.00159 | acc=1.0000 | FP-Norm=1.247 | FP-Norm(final)=2.672 | 3700.2 samples/s | 57.8 steps/s
[Step=14000 Epoch=68.7] | Loss=0.01837 | Reg=0.00162 | acc=1.0000 | FP-Norm=1.259 | FP-Norm(final)=2.673 | 4699.3 samples/s | 73.4 steps/s
[Step=14050 Epoch=68.9] | Loss=0.01835 | Reg=0.00165 | acc=0.9844 | FP-Norm=1.273 | FP-Norm(final)=2.673 | 1630.4 samples/s | 25.5 steps/s
[Step=14100 Epoch=69.1] | Loss=0.01743 | Reg=0.00168 | acc=0.9844 | FP-Norm=1.285 | FP-Norm(final)=2.672 | 3756.2 samples/s | 58.7 steps/s
[Step=14150 Epoch=69.4] | Loss=0.01677 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.293 | FP-Norm(final)=2.672 | 3772.4 samples/s | 58.9 steps/s
[Step=14200 Epoch=69.6] | Loss=0.01588 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.299 | FP-Norm(final)=2.673 | 4497.7 samples/s | 70.3 steps/s
[Step=14250 Epoch=69.9] | Loss=0.01505 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.303 | FP-Norm(final)=2.674 | 1656.2 samples/s | 25.9 steps/s
[Step=14300 Epoch=70.1] | Loss=0.01454 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.306 | FP-Norm(final)=2.675 | 3760.7 samples/s | 58.8 steps/s
[Step=14350 Epoch=70.4] | Loss=0.01405 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.309 | FP-Norm(final)=2.677 | 3770.4 samples/s | 58.9 steps/s
[Step=14400 Epoch=70.6] | Loss=0.01366 | Reg=0.00174 | acc=0.9844 | FP-Norm=1.312 | FP-Norm(final)=2.678 | 4334.7 samples/s | 67.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step14400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=128.9] | Loss=0.13016 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.683 | 3448.7 samples/s | 53.9 steps/s
[Step=13650 Epoch=129.3] | Loss=0.00873 | Reg=0.00230 | acc=1.0000 | FP-Norm=1.449 | FP-Norm(final)=2.666 | 3495.5 samples/s | 54.6 steps/s
[Step=13700 Epoch=129.8] | Loss=0.00516 | Reg=0.00251 | acc=1.0000 | FP-Norm=1.548 | FP-Norm(final)=2.666 | 4655.7 samples/s | 72.7 steps/s
[Step=13750 Epoch=130.3] | Loss=0.00368 | Reg=0.00248 | acc=1.0000 | FP-Norm=1.551 | FP-Norm(final)=2.669 | 1547.1 samples/s | 24.2 steps/s
[Step=13800 Epoch=130.8] | Loss=0.00278 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.528 | FP-Norm(final)=2.672 | 4354.0 samples/s | 68.0 steps/s
[Step=13850 Epoch=131.2] | Loss=0.00223 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.498 | FP-Norm(final)=2.674 | 1582.5 samples/s | 24.7 steps/s
[Step=13900 Epoch=131.7] | Loss=0.00187 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.466 | FP-Norm(final)=2.676 | 3989.2 samples/s | 62.3 steps/s
[Step=13950 Epoch=132.2] | Loss=0.00161 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.436 | FP-Norm(final)=2.677 | 1607.1 samples/s | 25.1 steps/s
[Step=14000 Epoch=132.7] | Loss=0.00141 | Reg=0.00202 | acc=1.0000 | FP-Norm=1.406 | FP-Norm(final)=2.679 | 3847.9 samples/s | 60.1 steps/s
[Step=14050 Epoch=133.1] | Loss=0.00126 | Reg=0.00194 | acc=1.0000 | FP-Norm=1.378 | FP-Norm(final)=2.680 | 1654.2 samples/s | 25.8 steps/s
[Step=14100 Epoch=133.6] | Loss=0.00113 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.351 | FP-Norm(final)=2.681 | 3591.5 samples/s | 56.1 steps/s
[Step=14150 Epoch=134.1] | Loss=0.00103 | Reg=0.00181 | acc=1.0000 | FP-Norm=1.325 | FP-Norm(final)=2.682 | 1677.6 samples/s | 26.2 steps/s
[Step=14200 Epoch=134.6] | Loss=0.00095 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.301 | FP-Norm(final)=2.683 | 3572.7 samples/s | 55.8 steps/s
[Step=14250 Epoch=135.0] | Loss=0.00088 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.277 | FP-Norm(final)=2.684 | 1710.0 samples/s | 26.7 steps/s
[Step=14300 Epoch=135.5] | Loss=0.00081 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.255 | FP-Norm(final)=2.684 | 3617.2 samples/s | 56.5 steps/s
[Step=14350 Epoch=136.0] | Loss=0.00076 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.234 | FP-Norm(final)=2.685 | 1726.6 samples/s | 27.0 steps/s
[Step=14400 Epoch=136.5] | Loss=0.00072 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.213 | FP-Norm(final)=2.686 | 3534.3 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step14400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=129.4] | Loss=0.12981 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.683 | 3535.1 samples/s | 55.2 steps/s
[Step=13650 Epoch=129.8] | Loss=0.00997 | Reg=0.00216 | acc=1.0000 | FP-Norm=1.401 | FP-Norm(final)=2.661 | 3487.4 samples/s | 54.5 steps/s
[Step=13700 Epoch=130.3] | Loss=0.00616 | Reg=0.00231 | acc=0.9688 | FP-Norm=1.485 | FP-Norm(final)=2.662 | 4687.8 samples/s | 73.2 steps/s
[Step=13750 Epoch=130.8] | Loss=0.00499 | Reg=0.00245 | acc=1.0000 | FP-Norm=1.542 | FP-Norm(final)=2.662 | 1556.7 samples/s | 24.3 steps/s
[Step=13800 Epoch=131.3] | Loss=0.00389 | Reg=0.00255 | acc=1.0000 | FP-Norm=1.578 | FP-Norm(final)=2.661 | 4335.3 samples/s | 67.7 steps/s
[Step=13850 Epoch=131.7] | Loss=0.00312 | Reg=0.00254 | acc=1.0000 | FP-Norm=1.578 | FP-Norm(final)=2.663 | 1584.9 samples/s | 24.8 steps/s
[Step=13900 Epoch=132.2] | Loss=0.00261 | Reg=0.00249 | acc=1.0000 | FP-Norm=1.565 | FP-Norm(final)=2.664 | 4075.3 samples/s | 63.7 steps/s
[Step=13950 Epoch=132.7] | Loss=0.00225 | Reg=0.00244 | acc=1.0000 | FP-Norm=1.549 | FP-Norm(final)=2.665 | 1623.5 samples/s | 25.4 steps/s
[Step=14000 Epoch=133.2] | Loss=0.00197 | Reg=0.00238 | acc=1.0000 | FP-Norm=1.530 | FP-Norm(final)=2.666 | 3794.1 samples/s | 59.3 steps/s
[Step=14050 Epoch=133.7] | Loss=0.00175 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.508 | FP-Norm(final)=2.667 | 1690.5 samples/s | 26.4 steps/s
[Step=14100 Epoch=134.1] | Loss=0.00158 | Reg=0.00224 | acc=1.0000 | FP-Norm=1.486 | FP-Norm(final)=2.668 | 3635.2 samples/s | 56.8 steps/s
[Step=14150 Epoch=134.6] | Loss=0.00144 | Reg=0.00218 | acc=1.0000 | FP-Norm=1.464 | FP-Norm(final)=2.669 | 1699.3 samples/s | 26.6 steps/s
[Step=14200 Epoch=135.1] | Loss=0.00132 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.442 | FP-Norm(final)=2.670 | 3588.9 samples/s | 56.1 steps/s
[Step=14250 Epoch=135.6] | Loss=0.00122 | Reg=0.00206 | acc=1.0000 | FP-Norm=1.421 | FP-Norm(final)=2.671 | 1715.2 samples/s | 26.8 steps/s
[Step=14300 Epoch=136.0] | Loss=0.00113 | Reg=0.00200 | acc=1.0000 | FP-Norm=1.400 | FP-Norm(final)=2.672 | 3603.6 samples/s | 56.3 steps/s
[Step=14350 Epoch=136.5] | Loss=0.00106 | Reg=0.00195 | acc=1.0000 | FP-Norm=1.379 | FP-Norm(final)=2.673 | 1742.8 samples/s | 27.2 steps/s
[Step=14400 Epoch=137.0] | Loss=0.00099 | Reg=0.00190 | acc=1.0000 | FP-Norm=1.359 | FP-Norm(final)=2.674 | 3575.1 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step14400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=129.9] | Loss=0.10400 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.683 | 3744.3 samples/s | 58.5 steps/s
[Step=13650 Epoch=130.3] | Loss=0.01235 | Reg=0.00275 | acc=1.0000 | FP-Norm=1.573 | FP-Norm(final)=2.664 | 3358.8 samples/s | 52.5 steps/s
[Step=13700 Epoch=130.8] | Loss=0.00634 | Reg=0.00308 | acc=1.0000 | FP-Norm=1.711 | FP-Norm(final)=2.665 | 4713.7 samples/s | 73.7 steps/s
[Step=13750 Epoch=131.3] | Loss=0.00431 | Reg=0.00300 | acc=1.0000 | FP-Norm=1.701 | FP-Norm(final)=2.669 | 1537.1 samples/s | 24.0 steps/s
[Step=13800 Epoch=131.8] | Loss=0.00324 | Reg=0.00286 | acc=1.0000 | FP-Norm=1.667 | FP-Norm(final)=2.671 | 4422.3 samples/s | 69.1 steps/s
[Step=13850 Epoch=132.3] | Loss=0.00260 | Reg=0.00272 | acc=1.0000 | FP-Norm=1.628 | FP-Norm(final)=2.673 | 1539.3 samples/s | 24.1 steps/s
[Step=13900 Epoch=132.7] | Loss=0.00217 | Reg=0.00260 | acc=1.0000 | FP-Norm=1.591 | FP-Norm(final)=2.674 | 4119.8 samples/s | 64.4 steps/s
[Step=13950 Epoch=133.2] | Loss=0.00187 | Reg=0.00249 | acc=1.0000 | FP-Norm=1.556 | FP-Norm(final)=2.675 | 1595.8 samples/s | 24.9 steps/s
[Step=14000 Epoch=133.7] | Loss=0.00164 | Reg=0.00238 | acc=1.0000 | FP-Norm=1.522 | FP-Norm(final)=2.676 | 3968.6 samples/s | 62.0 steps/s
[Step=14050 Epoch=134.2] | Loss=0.00146 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.491 | FP-Norm(final)=2.677 | 1630.3 samples/s | 25.5 steps/s
[Step=14100 Epoch=134.6] | Loss=0.00131 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.462 | FP-Norm(final)=2.678 | 3782.6 samples/s | 59.1 steps/s
[Step=14150 Epoch=135.1] | Loss=0.00120 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.434 | FP-Norm(final)=2.679 | 1669.6 samples/s | 26.1 steps/s
[Step=14200 Epoch=135.6] | Loss=0.00110 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.407 | FP-Norm(final)=2.680 | 3604.6 samples/s | 56.3 steps/s
[Step=14250 Epoch=136.1] | Loss=0.00102 | Reg=0.00198 | acc=1.0000 | FP-Norm=1.382 | FP-Norm(final)=2.680 | 1689.1 samples/s | 26.4 steps/s
[Step=14300 Epoch=136.6] | Loss=0.00095 | Reg=0.00192 | acc=1.0000 | FP-Norm=1.358 | FP-Norm(final)=2.681 | 3608.4 samples/s | 56.4 steps/s
[Step=14350 Epoch=137.0] | Loss=0.00088 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.335 | FP-Norm(final)=2.682 | 1704.2 samples/s | 26.6 steps/s
[Step=14400 Epoch=137.5] | Loss=0.00083 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.313 | FP-Norm(final)=2.682 | 3594.2 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step14400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=128.2] | Loss=0.15922 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.682 | 3720.5 samples/s | 58.1 steps/s
[Step=13650 Epoch=128.6] | Loss=0.01035 | Reg=0.00208 | acc=1.0000 | FP-Norm=1.369 | FP-Norm(final)=2.663 | 3202.1 samples/s | 50.0 steps/s
[Step=13700 Epoch=129.1] | Loss=0.00681 | Reg=0.00266 | acc=1.0000 | FP-Norm=1.585 | FP-Norm(final)=2.656 | 4596.6 samples/s | 71.8 steps/s
[Step=13750 Epoch=129.6] | Loss=0.00472 | Reg=0.00282 | acc=1.0000 | FP-Norm=1.646 | FP-Norm(final)=2.654 | 1560.5 samples/s | 24.4 steps/s
[Step=13800 Epoch=130.0] | Loss=0.00357 | Reg=0.00280 | acc=1.0000 | FP-Norm=1.649 | FP-Norm(final)=2.655 | 4241.4 samples/s | 66.3 steps/s
[Step=13850 Epoch=130.5] | Loss=0.00286 | Reg=0.00272 | acc=1.0000 | FP-Norm=1.631 | FP-Norm(final)=2.656 | 1593.5 samples/s | 24.9 steps/s
[Step=13900 Epoch=131.0] | Loss=0.00239 | Reg=0.00264 | acc=1.0000 | FP-Norm=1.606 | FP-Norm(final)=2.657 | 3969.7 samples/s | 62.0 steps/s
[Step=13950 Epoch=131.4] | Loss=0.00205 | Reg=0.00255 | acc=1.0000 | FP-Norm=1.580 | FP-Norm(final)=2.659 | 1612.7 samples/s | 25.2 steps/s
[Step=14000 Epoch=131.9] | Loss=0.00179 | Reg=0.00247 | acc=1.0000 | FP-Norm=1.554 | FP-Norm(final)=2.660 | 3593.2 samples/s | 56.1 steps/s
[Step=14050 Epoch=132.4] | Loss=0.00160 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.528 | FP-Norm(final)=2.661 | 1686.4 samples/s | 26.3 steps/s
[Step=14100 Epoch=132.9] | Loss=0.00144 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.502 | FP-Norm(final)=2.662 | 3592.7 samples/s | 56.1 steps/s
[Step=14150 Epoch=133.3] | Loss=0.00131 | Reg=0.00224 | acc=1.0000 | FP-Norm=1.478 | FP-Norm(final)=2.663 | 1732.2 samples/s | 27.1 steps/s
[Step=14200 Epoch=133.8] | Loss=0.00120 | Reg=0.00217 | acc=1.0000 | FP-Norm=1.454 | FP-Norm(final)=2.664 | 3601.1 samples/s | 56.3 steps/s
[Step=14250 Epoch=134.3] | Loss=0.00111 | Reg=0.00211 | acc=1.0000 | FP-Norm=1.432 | FP-Norm(final)=2.665 | 1719.8 samples/s | 26.9 steps/s
[Step=14300 Epoch=134.7] | Loss=0.00103 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.410 | FP-Norm(final)=2.666 | 3541.9 samples/s | 55.3 steps/s
[Step=14350 Epoch=135.2] | Loss=0.00097 | Reg=0.00199 | acc=1.0000 | FP-Norm=1.388 | FP-Norm(final)=2.667 | 1770.7 samples/s | 27.7 steps/s
[Step=14400 Epoch=135.7] | Loss=0.00091 | Reg=0.00194 | acc=1.0000 | FP-Norm=1.368 | FP-Norm(final)=2.668 | 3349.5 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step14400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=129.6] | Loss=0.12488 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.684 | 3450.8 samples/s | 53.9 steps/s
[Step=13650 Epoch=130.1] | Loss=0.01649 | Reg=0.00300 | acc=1.0000 | FP-Norm=1.655 | FP-Norm(final)=2.656 | 3321.1 samples/s | 51.9 steps/s
[Step=13700 Epoch=130.6] | Loss=0.00898 | Reg=0.00333 | acc=1.0000 | FP-Norm=1.784 | FP-Norm(final)=2.651 | 4662.1 samples/s | 72.8 steps/s
[Step=13750 Epoch=131.0] | Loss=0.00603 | Reg=0.00322 | acc=1.0000 | FP-Norm=1.765 | FP-Norm(final)=2.652 | 1537.8 samples/s | 24.0 steps/s
[Step=13800 Epoch=131.5] | Loss=0.00455 | Reg=0.00307 | acc=1.0000 | FP-Norm=1.728 | FP-Norm(final)=2.654 | 4408.8 samples/s | 68.9 steps/s
[Step=13850 Epoch=132.0] | Loss=0.00365 | Reg=0.00293 | acc=1.0000 | FP-Norm=1.690 | FP-Norm(final)=2.656 | 1574.9 samples/s | 24.6 steps/s
[Step=13900 Epoch=132.5] | Loss=0.00305 | Reg=0.00280 | acc=1.0000 | FP-Norm=1.653 | FP-Norm(final)=2.658 | 4114.2 samples/s | 64.3 steps/s
[Step=13950 Epoch=133.0] | Loss=0.00262 | Reg=0.00268 | acc=1.0000 | FP-Norm=1.618 | FP-Norm(final)=2.659 | 1605.0 samples/s | 25.1 steps/s
[Step=14000 Epoch=133.4] | Loss=0.00229 | Reg=0.00258 | acc=1.0000 | FP-Norm=1.585 | FP-Norm(final)=2.661 | 3982.2 samples/s | 62.2 steps/s
[Step=14050 Epoch=133.9] | Loss=0.00204 | Reg=0.00248 | acc=1.0000 | FP-Norm=1.554 | FP-Norm(final)=2.662 | 1619.6 samples/s | 25.3 steps/s
[Step=14100 Epoch=134.4] | Loss=0.00184 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.525 | FP-Norm(final)=2.664 | 3780.0 samples/s | 59.1 steps/s
[Step=14150 Epoch=134.9] | Loss=0.00168 | Reg=0.00231 | acc=1.0000 | FP-Norm=1.497 | FP-Norm(final)=2.665 | 1649.8 samples/s | 25.8 steps/s
[Step=14200 Epoch=135.3] | Loss=0.00154 | Reg=0.00223 | acc=1.0000 | FP-Norm=1.471 | FP-Norm(final)=2.666 | 3595.0 samples/s | 56.2 steps/s
[Step=14250 Epoch=135.8] | Loss=0.00142 | Reg=0.00216 | acc=1.0000 | FP-Norm=1.446 | FP-Norm(final)=2.668 | 1689.3 samples/s | 26.4 steps/s
[Step=14300 Epoch=136.3] | Loss=0.00132 | Reg=0.00210 | acc=1.0000 | FP-Norm=1.423 | FP-Norm(final)=2.669 | 3575.1 samples/s | 55.9 steps/s
[Step=14350 Epoch=136.8] | Loss=0.00124 | Reg=0.00203 | acc=1.0000 | FP-Norm=1.400 | FP-Norm(final)=2.670 | 1719.7 samples/s | 26.9 steps/s
[Step=14400 Epoch=137.2] | Loss=0.00116 | Reg=0.00198 | acc=1.0000 | FP-Norm=1.378 | FP-Norm(final)=2.671 | 3571.1 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18989 | acc=0.8709 | tpr=0.8225 | fpr=0.0240 | 3628.1 samples/s | 14.2 steps/s
Avg test loss: 0.19060, Avg test acc: 0.87178, Avg tpr: 0.82532, Avg fpr: 0.02602, total FA: 203

Testing server on iccad2012
[Step=  50] | Loss=0.52125 | acc=0.8095 | tpr=0.9735 | fpr=0.1934 | 3596.4 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.53759 | acc=0.8078 | tpr=0.9765 | fpr=0.1954 | 6958.4 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.54422 | acc=0.8064 | tpr=0.9741 | fpr=0.1967 | 6864.0 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.54461 | acc=0.8058 | tpr=0.9749 | fpr=0.1972 | 6824.0 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.54311 | acc=0.8059 | tpr=0.9721 | fpr=0.1972 | 6854.6 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.54676 | acc=0.8053 | tpr=0.9709 | fpr=0.1977 | 6793.3 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.54690 | acc=0.8054 | tpr=0.9712 | fpr=0.1976 | 6765.4 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.54761 | acc=0.8052 | tpr=0.9710 | fpr=0.1978 | 6883.3 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.55039 | acc=0.8051 | tpr=0.9713 | fpr=0.1979 | 6623.9 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.55172 | acc=0.8048 | tpr=0.9727 | fpr=0.1982 | 6872.6 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.55125 | acc=0.8049 | tpr=0.9729 | fpr=0.1982 | 12330.5 samples/s | 48.2 steps/s
Avg test loss: 0.55124, Avg test acc: 0.80496, Avg tpr: 0.97306, Avg fpr: 0.19809, total FA: 27505

server round 18/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.2] | Loss=0.18752 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.698 | 4013.7 samples/s | 62.7 steps/s
[Step=14450 Epoch=70.5] | Loss=0.02777 | Reg=0.00067 | acc=0.9844 | FP-Norm=0.784 | FP-Norm(final)=2.695 | 3355.9 samples/s | 52.4 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02496 | Reg=0.00090 | acc=0.9531 | FP-Norm=0.925 | FP-Norm(final)=2.690 | 3754.4 samples/s | 58.7 steps/s
[Step=14550 Epoch=70.9] | Loss=0.02353 | Reg=0.00107 | acc=0.9844 | FP-Norm=1.010 | FP-Norm(final)=2.687 | 3769.0 samples/s | 58.9 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02353 | Reg=0.00120 | acc=0.9844 | FP-Norm=1.075 | FP-Norm(final)=2.684 | 4804.2 samples/s | 75.1 steps/s
[Step=14650 Epoch=71.4] | Loss=0.02070 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.123 | FP-Norm(final)=2.684 | 1610.7 samples/s | 25.2 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01954 | Reg=0.00137 | acc=0.9844 | FP-Norm=1.152 | FP-Norm(final)=2.685 | 3756.8 samples/s | 58.7 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01853 | Reg=0.00141 | acc=0.9844 | FP-Norm=1.172 | FP-Norm(final)=2.685 | 3733.6 samples/s | 58.3 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01793 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.187 | FP-Norm(final)=2.686 | 4569.4 samples/s | 71.4 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01671 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.199 | FP-Norm(final)=2.686 | 1657.4 samples/s | 25.9 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01598 | Reg=0.00149 | acc=0.9844 | FP-Norm=1.206 | FP-Norm(final)=2.688 | 3776.7 samples/s | 59.0 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01530 | Reg=0.00150 | acc=0.9844 | FP-Norm=1.213 | FP-Norm(final)=2.689 | 3780.5 samples/s | 59.1 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01499 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.219 | FP-Norm(final)=2.690 | 4274.7 samples/s | 66.8 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01447 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.225 | FP-Norm(final)=2.691 | 1696.4 samples/s | 26.5 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01402 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.230 | FP-Norm(final)=2.691 | 3738.3 samples/s | 58.4 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01339 | Reg=0.00154 | acc=0.9844 | FP-Norm=1.234 | FP-Norm(final)=2.692 | 3738.8 samples/s | 58.4 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01308 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.236 | FP-Norm(final)=2.693 | 4067.6 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step15200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.3] | Loss=0.16426 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.697 | 3575.8 samples/s | 55.9 steps/s
[Step=14450 Epoch=70.5] | Loss=0.02650 | Reg=0.00089 | acc=0.9844 | FP-Norm=0.905 | FP-Norm(final)=2.691 | 3662.7 samples/s | 57.2 steps/s
[Step=14500 Epoch=70.8] | Loss=0.02541 | Reg=0.00107 | acc=0.9688 | FP-Norm=1.009 | FP-Norm(final)=2.687 | 3763.8 samples/s | 58.8 steps/s
[Step=14550 Epoch=71.0] | Loss=0.02483 | Reg=0.00121 | acc=0.9844 | FP-Norm=1.081 | FP-Norm(final)=2.684 | 3758.0 samples/s | 58.7 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02251 | Reg=0.00134 | acc=0.9844 | FP-Norm=1.138 | FP-Norm(final)=2.682 | 4839.9 samples/s | 75.6 steps/s
[Step=14650 Epoch=71.5] | Loss=0.02064 | Reg=0.00142 | acc=0.9844 | FP-Norm=1.175 | FP-Norm(final)=2.683 | 1618.2 samples/s | 25.3 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01914 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.196 | FP-Norm(final)=2.684 | 3732.1 samples/s | 58.3 steps/s
[Step=14750 Epoch=72.0] | Loss=0.01793 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.210 | FP-Norm(final)=2.686 | 3751.7 samples/s | 58.6 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01684 | Reg=0.00152 | acc=0.9844 | FP-Norm=1.223 | FP-Norm(final)=2.690 | 4601.5 samples/s | 71.9 steps/s
[Step=14850 Epoch=72.5] | Loss=0.01623 | Reg=0.00155 | acc=1.0000 | FP-Norm=1.234 | FP-Norm(final)=2.692 | 1634.6 samples/s | 25.5 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01581 | Reg=0.00157 | acc=1.0000 | FP-Norm=1.242 | FP-Norm(final)=2.694 | 3751.8 samples/s | 58.6 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01511 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.249 | FP-Norm(final)=2.696 | 3760.3 samples/s | 58.8 steps/s
[Step=15000 Epoch=73.2] | Loss=0.01466 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.256 | FP-Norm(final)=2.698 | 4397.6 samples/s | 68.7 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01415 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.262 | FP-Norm(final)=2.700 | 1690.6 samples/s | 26.4 steps/s
[Step=15100 Epoch=73.7] | Loss=0.01367 | Reg=0.00163 | acc=0.9844 | FP-Norm=1.269 | FP-Norm(final)=2.702 | 3778.9 samples/s | 59.0 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01326 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.274 | FP-Norm(final)=2.703 | 3779.5 samples/s | 59.1 steps/s
[Step=15200 Epoch=74.2] | Loss=0.01315 | Reg=0.00165 | acc=1.0000 | FP-Norm=1.279 | FP-Norm(final)=2.705 | 4177.6 samples/s | 65.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step15200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.2] | Loss=0.12281 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.697 | 3924.9 samples/s | 61.3 steps/s
[Step=14450 Epoch=70.4] | Loss=0.03539 | Reg=0.00092 | acc=0.9375 | FP-Norm=0.911 | FP-Norm(final)=2.682 | 3395.8 samples/s | 53.1 steps/s
[Step=14500 Epoch=70.7] | Loss=0.03072 | Reg=0.00116 | acc=0.9531 | FP-Norm=1.050 | FP-Norm(final)=2.676 | 3746.9 samples/s | 58.5 steps/s
[Step=14550 Epoch=70.9] | Loss=0.02901 | Reg=0.00135 | acc=0.9688 | FP-Norm=1.135 | FP-Norm(final)=2.671 | 3768.5 samples/s | 58.9 steps/s
[Step=14600 Epoch=71.1] | Loss=0.02563 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.181 | FP-Norm(final)=2.671 | 4820.8 samples/s | 75.3 steps/s
[Step=14650 Epoch=71.4] | Loss=0.02363 | Reg=0.00154 | acc=1.0000 | FP-Norm=1.222 | FP-Norm(final)=2.673 | 1618.4 samples/s | 25.3 steps/s
[Step=14700 Epoch=71.6] | Loss=0.02163 | Reg=0.00160 | acc=0.9844 | FP-Norm=1.247 | FP-Norm(final)=2.676 | 3768.0 samples/s | 58.9 steps/s
[Step=14750 Epoch=71.9] | Loss=0.02044 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.266 | FP-Norm(final)=2.678 | 3742.9 samples/s | 58.5 steps/s
[Step=14800 Epoch=72.1] | Loss=0.01932 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.281 | FP-Norm(final)=2.681 | 4541.1 samples/s | 71.0 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01798 | Reg=0.00170 | acc=1.0000 | FP-Norm=1.293 | FP-Norm(final)=2.684 | 1651.9 samples/s | 25.8 steps/s
[Step=14900 Epoch=72.6] | Loss=0.01679 | Reg=0.00171 | acc=0.9844 | FP-Norm=1.298 | FP-Norm(final)=2.687 | 3753.3 samples/s | 58.6 steps/s
[Step=14950 Epoch=72.8] | Loss=0.01615 | Reg=0.00172 | acc=1.0000 | FP-Norm=1.302 | FP-Norm(final)=2.690 | 3749.9 samples/s | 58.6 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01586 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.306 | FP-Norm(final)=2.692 | 4265.0 samples/s | 66.6 steps/s
[Step=15050 Epoch=73.3] | Loss=0.01529 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.310 | FP-Norm(final)=2.694 | 1679.0 samples/s | 26.2 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01472 | Reg=0.00174 | acc=0.9844 | FP-Norm=1.312 | FP-Norm(final)=2.696 | 3744.8 samples/s | 58.5 steps/s
[Step=15150 Epoch=73.8] | Loss=0.01413 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.314 | FP-Norm(final)=2.697 | 3733.1 samples/s | 58.3 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01363 | Reg=0.00175 | acc=1.0000 | FP-Norm=1.315 | FP-Norm(final)=2.699 | 4078.9 samples/s | 63.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step15200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.2] | Loss=0.18443 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.697 | 3997.8 samples/s | 62.5 steps/s
[Step=14450 Epoch=70.5] | Loss=0.02856 | Reg=0.00089 | acc=0.9844 | FP-Norm=0.906 | FP-Norm(final)=2.692 | 3533.1 samples/s | 55.2 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02353 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.981 | FP-Norm(final)=2.693 | 3759.2 samples/s | 58.7 steps/s
[Step=14550 Epoch=71.0] | Loss=0.02218 | Reg=0.00107 | acc=0.9844 | FP-Norm=1.021 | FP-Norm(final)=2.692 | 3757.2 samples/s | 58.7 steps/s
[Step=14600 Epoch=71.2] | Loss=0.01986 | Reg=0.00112 | acc=0.9531 | FP-Norm=1.045 | FP-Norm(final)=2.693 | 4858.4 samples/s | 75.9 steps/s
[Step=14650 Epoch=71.4] | Loss=0.01755 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.057 | FP-Norm(final)=2.695 | 1624.4 samples/s | 25.4 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01602 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.063 | FP-Norm(final)=2.698 | 3750.7 samples/s | 58.6 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01533 | Reg=0.00116 | acc=1.0000 | FP-Norm=1.069 | FP-Norm(final)=2.700 | 3768.5 samples/s | 58.9 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01475 | Reg=0.00117 | acc=0.9844 | FP-Norm=1.075 | FP-Norm(final)=2.702 | 4480.7 samples/s | 70.0 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01552 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.095 | FP-Norm(final)=2.702 | 1665.6 samples/s | 26.0 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01496 | Reg=0.00128 | acc=0.9844 | FP-Norm=1.121 | FP-Norm(final)=2.703 | 3762.9 samples/s | 58.8 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01471 | Reg=0.00133 | acc=0.9844 | FP-Norm=1.143 | FP-Norm(final)=2.704 | 3765.5 samples/s | 58.8 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01430 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.160 | FP-Norm(final)=2.705 | 4288.9 samples/s | 67.0 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01378 | Reg=0.00140 | acc=0.9844 | FP-Norm=1.174 | FP-Norm(final)=2.706 | 1694.0 samples/s | 26.5 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01319 | Reg=0.00143 | acc=0.9844 | FP-Norm=1.185 | FP-Norm(final)=2.708 | 3756.7 samples/s | 58.7 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01278 | Reg=0.00145 | acc=1.0000 | FP-Norm=1.195 | FP-Norm(final)=2.709 | 3758.9 samples/s | 58.7 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01260 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.202 | FP-Norm(final)=2.711 | 4048.2 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step15200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.6] | Loss=0.08876 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.698 | 3761.2 samples/s | 58.8 steps/s
[Step=14450 Epoch=70.9] | Loss=0.03465 | Reg=0.00118 | acc=0.9844 | FP-Norm=1.036 | FP-Norm(final)=2.690 | 3522.7 samples/s | 55.0 steps/s
[Step=14500 Epoch=71.1] | Loss=0.02915 | Reg=0.00149 | acc=0.9531 | FP-Norm=1.186 | FP-Norm(final)=2.685 | 3757.3 samples/s | 58.7 steps/s
[Step=14550 Epoch=71.4] | Loss=0.02654 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.253 | FP-Norm(final)=2.681 | 3756.9 samples/s | 58.7 steps/s
[Step=14600 Epoch=71.6] | Loss=0.02650 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.296 | FP-Norm(final)=2.675 | 4906.1 samples/s | 76.7 steps/s
[Step=14650 Epoch=71.8] | Loss=0.02286 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.316 | FP-Norm(final)=2.672 | 1607.4 samples/s | 25.1 steps/s
[Step=14700 Epoch=72.1] | Loss=0.02099 | Reg=0.00178 | acc=0.9844 | FP-Norm=1.321 | FP-Norm(final)=2.672 | 3778.4 samples/s | 59.0 steps/s
[Step=14750 Epoch=72.3] | Loss=0.01973 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.326 | FP-Norm(final)=2.673 | 3789.7 samples/s | 59.2 steps/s
[Step=14800 Epoch=72.6] | Loss=0.01860 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.329 | FP-Norm(final)=2.675 | 4694.7 samples/s | 73.4 steps/s
[Step=14850 Epoch=72.8] | Loss=0.01743 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.330 | FP-Norm(final)=2.676 | 1625.8 samples/s | 25.4 steps/s
[Step=14900 Epoch=73.1] | Loss=0.01656 | Reg=0.00179 | acc=0.9844 | FP-Norm=1.329 | FP-Norm(final)=2.677 | 3798.4 samples/s | 59.3 steps/s
[Step=14950 Epoch=73.3] | Loss=0.01602 | Reg=0.00178 | acc=0.9688 | FP-Norm=1.328 | FP-Norm(final)=2.678 | 3749.0 samples/s | 58.6 steps/s
[Step=15000 Epoch=73.6] | Loss=0.01532 | Reg=0.00178 | acc=0.9844 | FP-Norm=1.329 | FP-Norm(final)=2.679 | 4519.7 samples/s | 70.6 steps/s
[Step=15050 Epoch=73.8] | Loss=0.01460 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.328 | FP-Norm(final)=2.680 | 1665.4 samples/s | 26.0 steps/s
[Step=15100 Epoch=74.0] | Loss=0.01411 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.328 | FP-Norm(final)=2.682 | 3783.8 samples/s | 59.1 steps/s
[Step=15150 Epoch=74.3] | Loss=0.01358 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.330 | FP-Norm(final)=2.684 | 3727.4 samples/s | 58.2 steps/s
[Step=15200 Epoch=74.5] | Loss=0.01315 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.330 | FP-Norm(final)=2.685 | 4317.8 samples/s | 67.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step15200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=136.5] | Loss=0.01660 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.698 | 3598.3 samples/s | 56.2 steps/s
[Step=14450 Epoch=136.9] | Loss=0.00559 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.274 | FP-Norm(final)=2.696 | 3264.7 samples/s | 51.0 steps/s
[Step=14500 Epoch=137.4] | Loss=0.00392 | Reg=0.00195 | acc=0.9844 | FP-Norm=1.363 | FP-Norm(final)=2.696 | 4656.8 samples/s | 72.8 steps/s
[Step=14550 Epoch=137.9] | Loss=0.00313 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.404 | FP-Norm(final)=2.694 | 1579.5 samples/s | 24.7 steps/s
[Step=14600 Epoch=138.3] | Loss=0.00244 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.409 | FP-Norm(final)=2.693 | 4310.8 samples/s | 67.4 steps/s
[Step=14650 Epoch=138.8] | Loss=0.00195 | Reg=0.00199 | acc=1.0000 | FP-Norm=1.395 | FP-Norm(final)=2.693 | 1576.3 samples/s | 24.6 steps/s
[Step=14700 Epoch=139.3] | Loss=0.00163 | Reg=0.00192 | acc=1.0000 | FP-Norm=1.373 | FP-Norm(final)=2.694 | 4054.2 samples/s | 63.3 steps/s
[Step=14750 Epoch=139.8] | Loss=0.00140 | Reg=0.00185 | acc=1.0000 | FP-Norm=1.349 | FP-Norm(final)=2.694 | 1654.5 samples/s | 25.9 steps/s
[Step=14800 Epoch=140.2] | Loss=0.00123 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.325 | FP-Norm(final)=2.694 | 3875.9 samples/s | 60.6 steps/s
[Step=14850 Epoch=140.7] | Loss=0.00109 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.300 | FP-Norm(final)=2.695 | 1660.0 samples/s | 25.9 steps/s
[Step=14900 Epoch=141.2] | Loss=0.00099 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.277 | FP-Norm(final)=2.695 | 3609.8 samples/s | 56.4 steps/s
[Step=14950 Epoch=141.7] | Loss=0.00090 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.254 | FP-Norm(final)=2.696 | 1705.0 samples/s | 26.6 steps/s
[Step=15000 Epoch=142.1] | Loss=0.00082 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.232 | FP-Norm(final)=2.696 | 3568.9 samples/s | 55.8 steps/s
[Step=15050 Epoch=142.6] | Loss=0.00076 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.211 | FP-Norm(final)=2.697 | 1700.9 samples/s | 26.6 steps/s
[Step=15100 Epoch=143.1] | Loss=0.00071 | Reg=0.00146 | acc=1.0000 | FP-Norm=1.191 | FP-Norm(final)=2.697 | 3571.7 samples/s | 55.8 steps/s
[Step=15150 Epoch=143.6] | Loss=0.00066 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.171 | FP-Norm(final)=2.698 | 1711.6 samples/s | 26.7 steps/s
[Step=15200 Epoch=144.0] | Loss=0.00062 | Reg=0.00138 | acc=1.0000 | FP-Norm=1.152 | FP-Norm(final)=2.698 | 3510.1 samples/s | 54.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step15200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=137.0] | Loss=0.12726 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.696 | 3714.4 samples/s | 58.0 steps/s
[Step=14450 Epoch=137.5] | Loss=0.00798 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.133 | FP-Norm(final)=2.685 | 3345.9 samples/s | 52.3 steps/s
[Step=14500 Epoch=137.9] | Loss=0.00469 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.296 | FP-Norm(final)=2.682 | 4567.4 samples/s | 71.4 steps/s
[Step=14550 Epoch=138.4] | Loss=0.00320 | Reg=0.00189 | acc=1.0000 | FP-Norm=1.351 | FP-Norm(final)=2.683 | 1552.0 samples/s | 24.3 steps/s
[Step=14600 Epoch=138.9] | Loss=0.00241 | Reg=0.00188 | acc=1.0000 | FP-Norm=1.354 | FP-Norm(final)=2.685 | 4350.8 samples/s | 68.0 steps/s
[Step=14650 Epoch=139.4] | Loss=0.00193 | Reg=0.00184 | acc=1.0000 | FP-Norm=1.341 | FP-Norm(final)=2.686 | 1588.2 samples/s | 24.8 steps/s
[Step=14700 Epoch=139.8] | Loss=0.00162 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.323 | FP-Norm(final)=2.687 | 4079.5 samples/s | 63.7 steps/s
[Step=14750 Epoch=140.3] | Loss=0.00139 | Reg=0.00173 | acc=1.0000 | FP-Norm=1.303 | FP-Norm(final)=2.689 | 1616.7 samples/s | 25.3 steps/s
[Step=14800 Epoch=140.8] | Loss=0.00122 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.283 | FP-Norm(final)=2.690 | 3821.2 samples/s | 59.7 steps/s
[Step=14850 Epoch=141.3] | Loss=0.00109 | Reg=0.00163 | acc=1.0000 | FP-Norm=1.263 | FP-Norm(final)=2.691 | 1638.6 samples/s | 25.6 steps/s
[Step=14900 Epoch=141.7] | Loss=0.00098 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.243 | FP-Norm(final)=2.691 | 3626.5 samples/s | 56.7 steps/s
[Step=14950 Epoch=142.2] | Loss=0.00089 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.224 | FP-Norm(final)=2.692 | 1691.1 samples/s | 26.4 steps/s
[Step=15000 Epoch=142.7] | Loss=0.00082 | Reg=0.00149 | acc=1.0000 | FP-Norm=1.205 | FP-Norm(final)=2.693 | 3566.8 samples/s | 55.7 steps/s
[Step=15050 Epoch=143.2] | Loss=0.00076 | Reg=0.00144 | acc=1.0000 | FP-Norm=1.187 | FP-Norm(final)=2.694 | 1703.5 samples/s | 26.6 steps/s
[Step=15100 Epoch=143.6] | Loss=0.00070 | Reg=0.00140 | acc=1.0000 | FP-Norm=1.169 | FP-Norm(final)=2.695 | 3577.3 samples/s | 55.9 steps/s
[Step=15150 Epoch=144.1] | Loss=0.00066 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.152 | FP-Norm(final)=2.695 | 1708.8 samples/s | 26.7 steps/s
[Step=15200 Epoch=144.6] | Loss=0.00062 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.135 | FP-Norm(final)=2.696 | 3552.0 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step15200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=137.5] | Loss=0.12161 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.696 | 3505.6 samples/s | 54.8 steps/s
[Step=14450 Epoch=138.0] | Loss=0.00820 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.366 | FP-Norm(final)=2.692 | 3473.5 samples/s | 54.3 steps/s
[Step=14500 Epoch=138.5] | Loss=0.00425 | Reg=0.00225 | acc=1.0000 | FP-Norm=1.466 | FP-Norm(final)=2.695 | 4671.9 samples/s | 73.0 steps/s
[Step=14550 Epoch=138.9] | Loss=0.00284 | Reg=0.00215 | acc=1.0000 | FP-Norm=1.443 | FP-Norm(final)=2.698 | 1540.1 samples/s | 24.1 steps/s
[Step=14600 Epoch=139.4] | Loss=0.00214 | Reg=0.00203 | acc=1.0000 | FP-Norm=1.406 | FP-Norm(final)=2.699 | 4419.1 samples/s | 69.0 steps/s
[Step=14650 Epoch=139.9] | Loss=0.00172 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.369 | FP-Norm(final)=2.700 | 1581.6 samples/s | 24.7 steps/s
[Step=14700 Epoch=140.4] | Loss=0.00144 | Reg=0.00183 | acc=1.0000 | FP-Norm=1.334 | FP-Norm(final)=2.701 | 4145.7 samples/s | 64.8 steps/s
[Step=14750 Epoch=140.9] | Loss=0.00123 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.302 | FP-Norm(final)=2.702 | 1604.3 samples/s | 25.1 steps/s
[Step=14800 Epoch=141.3] | Loss=0.00108 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.271 | FP-Norm(final)=2.702 | 3996.0 samples/s | 62.4 steps/s
[Step=14850 Epoch=141.8] | Loss=0.00096 | Reg=0.00160 | acc=1.0000 | FP-Norm=1.243 | FP-Norm(final)=2.703 | 1640.4 samples/s | 25.6 steps/s
[Step=14900 Epoch=142.3] | Loss=0.00087 | Reg=0.00153 | acc=1.0000 | FP-Norm=1.217 | FP-Norm(final)=2.703 | 3768.5 samples/s | 58.9 steps/s
[Step=14950 Epoch=142.8] | Loss=0.00079 | Reg=0.00147 | acc=1.0000 | FP-Norm=1.192 | FP-Norm(final)=2.703 | 1640.0 samples/s | 25.6 steps/s
[Step=15000 Epoch=143.2] | Loss=0.00073 | Reg=0.00142 | acc=1.0000 | FP-Norm=1.169 | FP-Norm(final)=2.704 | 3635.5 samples/s | 56.8 steps/s
[Step=15050 Epoch=143.7] | Loss=0.00067 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.147 | FP-Norm(final)=2.704 | 1695.7 samples/s | 26.5 steps/s
[Step=15100 Epoch=144.2] | Loss=0.00063 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.126 | FP-Norm(final)=2.705 | 3544.1 samples/s | 55.4 steps/s
[Step=15150 Epoch=144.7] | Loss=0.00059 | Reg=0.00128 | acc=1.0000 | FP-Norm=1.106 | FP-Norm(final)=2.705 | 1725.7 samples/s | 27.0 steps/s
[Step=15200 Epoch=145.2] | Loss=0.00055 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.087 | FP-Norm(final)=2.705 | 3585.8 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step15200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=135.7] | Loss=0.12902 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.696 | 3709.1 samples/s | 58.0 steps/s
[Step=14450 Epoch=136.2] | Loss=0.01479 | Reg=0.00216 | acc=0.9844 | FP-Norm=1.395 | FP-Norm(final)=2.681 | 3269.8 samples/s | 51.1 steps/s
[Step=14500 Epoch=136.6] | Loss=0.00869 | Reg=0.00279 | acc=1.0000 | FP-Norm=1.622 | FP-Norm(final)=2.665 | 4604.3 samples/s | 71.9 steps/s
[Step=14550 Epoch=137.1] | Loss=0.00612 | Reg=0.00283 | acc=1.0000 | FP-Norm=1.649 | FP-Norm(final)=2.662 | 1555.1 samples/s | 24.3 steps/s
[Step=14600 Epoch=137.6] | Loss=0.00470 | Reg=0.00277 | acc=1.0000 | FP-Norm=1.640 | FP-Norm(final)=2.660 | 4225.2 samples/s | 66.0 steps/s
[Step=14650 Epoch=138.0] | Loss=0.00381 | Reg=0.00270 | acc=1.0000 | FP-Norm=1.624 | FP-Norm(final)=2.661 | 1614.4 samples/s | 25.2 steps/s
[Step=14700 Epoch=138.5] | Loss=0.00318 | Reg=0.00262 | acc=1.0000 | FP-Norm=1.601 | FP-Norm(final)=2.662 | 3964.5 samples/s | 61.9 steps/s
[Step=14750 Epoch=139.0] | Loss=0.00273 | Reg=0.00253 | acc=1.0000 | FP-Norm=1.575 | FP-Norm(final)=2.663 | 1631.0 samples/s | 25.5 steps/s
[Step=14800 Epoch=139.5] | Loss=0.00239 | Reg=0.00245 | acc=1.0000 | FP-Norm=1.549 | FP-Norm(final)=2.664 | 3677.3 samples/s | 57.5 steps/s
[Step=14850 Epoch=139.9] | Loss=0.00212 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.523 | FP-Norm(final)=2.665 | 1690.7 samples/s | 26.4 steps/s
[Step=14900 Epoch=140.4] | Loss=0.00191 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.497 | FP-Norm(final)=2.666 | 3570.3 samples/s | 55.8 steps/s
[Step=14950 Epoch=140.9] | Loss=0.00174 | Reg=0.00222 | acc=1.0000 | FP-Norm=1.473 | FP-Norm(final)=2.668 | 1717.2 samples/s | 26.8 steps/s
[Step=15000 Epoch=141.3] | Loss=0.00160 | Reg=0.00216 | acc=1.0000 | FP-Norm=1.450 | FP-Norm(final)=2.669 | 3585.7 samples/s | 56.0 steps/s
[Step=15050 Epoch=141.8] | Loss=0.00148 | Reg=0.00209 | acc=1.0000 | FP-Norm=1.427 | FP-Norm(final)=2.670 | 1728.6 samples/s | 27.0 steps/s
[Step=15100 Epoch=142.3] | Loss=0.00137 | Reg=0.00203 | acc=1.0000 | FP-Norm=1.405 | FP-Norm(final)=2.671 | 3517.3 samples/s | 55.0 steps/s
[Step=15150 Epoch=142.8] | Loss=0.00128 | Reg=0.00198 | acc=1.0000 | FP-Norm=1.384 | FP-Norm(final)=2.672 | 1785.8 samples/s | 27.9 steps/s
[Step=15200 Epoch=143.2] | Loss=0.00120 | Reg=0.00192 | acc=1.0000 | FP-Norm=1.364 | FP-Norm(final)=2.673 | 3357.8 samples/s | 52.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step15200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=137.3] | Loss=0.10946 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.697 | 3565.9 samples/s | 55.7 steps/s
[Step=14450 Epoch=137.7] | Loss=0.00832 | Reg=0.00240 | acc=1.0000 | FP-Norm=1.487 | FP-Norm(final)=2.690 | 3298.7 samples/s | 51.5 steps/s
[Step=14500 Epoch=138.2] | Loss=0.00451 | Reg=0.00248 | acc=1.0000 | FP-Norm=1.544 | FP-Norm(final)=2.692 | 4704.2 samples/s | 73.5 steps/s
[Step=14550 Epoch=138.7] | Loss=0.00326 | Reg=0.00239 | acc=1.0000 | FP-Norm=1.525 | FP-Norm(final)=2.693 | 1532.6 samples/s | 23.9 steps/s
[Step=14600 Epoch=139.2] | Loss=0.00256 | Reg=0.00236 | acc=1.0000 | FP-Norm=1.521 | FP-Norm(final)=2.694 | 4342.6 samples/s | 67.9 steps/s
[Step=14650 Epoch=139.6] | Loss=0.00206 | Reg=0.00229 | acc=1.0000 | FP-Norm=1.498 | FP-Norm(final)=2.694 | 1571.1 samples/s | 24.5 steps/s
[Step=14700 Epoch=140.1] | Loss=0.00172 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.471 | FP-Norm(final)=2.695 | 4182.2 samples/s | 65.3 steps/s
[Step=14750 Epoch=140.6] | Loss=0.00148 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.443 | FP-Norm(final)=2.696 | 1596.0 samples/s | 24.9 steps/s
[Step=14800 Epoch=141.1] | Loss=0.00129 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.414 | FP-Norm(final)=2.696 | 3959.1 samples/s | 61.9 steps/s
[Step=14850 Epoch=141.5] | Loss=0.00115 | Reg=0.00197 | acc=1.0000 | FP-Norm=1.387 | FP-Norm(final)=2.697 | 1639.3 samples/s | 25.6 steps/s
[Step=14900 Epoch=142.0] | Loss=0.00104 | Reg=0.00190 | acc=1.0000 | FP-Norm=1.361 | FP-Norm(final)=2.697 | 3764.0 samples/s | 58.8 steps/s
[Step=14950 Epoch=142.5] | Loss=0.00095 | Reg=0.00183 | acc=1.0000 | FP-Norm=1.336 | FP-Norm(final)=2.698 | 1646.1 samples/s | 25.7 steps/s
[Step=15000 Epoch=143.0] | Loss=0.00087 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.313 | FP-Norm(final)=2.698 | 3616.8 samples/s | 56.5 steps/s
[Step=15050 Epoch=143.4] | Loss=0.00080 | Reg=0.00171 | acc=1.0000 | FP-Norm=1.290 | FP-Norm(final)=2.698 | 1702.0 samples/s | 26.6 steps/s
[Step=15100 Epoch=143.9] | Loss=0.00075 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.268 | FP-Norm(final)=2.699 | 3544.6 samples/s | 55.4 steps/s
[Step=15150 Epoch=144.4] | Loss=0.00070 | Reg=0.00161 | acc=1.0000 | FP-Norm=1.247 | FP-Norm(final)=2.699 | 1709.2 samples/s | 26.7 steps/s
[Step=15200 Epoch=144.9] | Loss=0.00066 | Reg=0.00156 | acc=1.0000 | FP-Norm=1.226 | FP-Norm(final)=2.700 | 3532.5 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20357 | acc=0.8649 | tpr=0.8124 | fpr=0.0211 | 3615.6 samples/s | 14.1 steps/s
Avg test loss: 0.20338, Avg test acc: 0.86589, Avg tpr: 0.81541, Avg fpr: 0.02307, total FA: 180

Testing server on iccad2012
[Step=  50] | Loss=0.51517 | acc=0.8159 | tpr=0.9735 | fpr=0.1870 | 3625.1 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.53111 | acc=0.8139 | tpr=0.9765 | fpr=0.1891 | 6835.6 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.53829 | acc=0.8116 | tpr=0.9741 | fpr=0.1913 | 6715.1 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.53869 | acc=0.8120 | tpr=0.9770 | fpr=0.1910 | 6936.6 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.53680 | acc=0.8119 | tpr=0.9729 | fpr=0.1911 | 6825.5 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.54019 | acc=0.8115 | tpr=0.9709 | fpr=0.1914 | 6998.2 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.54053 | acc=0.8116 | tpr=0.9712 | fpr=0.1913 | 6797.0 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.54079 | acc=0.8115 | tpr=0.9721 | fpr=0.1914 | 6634.0 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.54416 | acc=0.8113 | tpr=0.9713 | fpr=0.1916 | 6727.2 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.54512 | acc=0.8109 | tpr=0.9722 | fpr=0.1920 | 6803.9 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.54442 | acc=0.8109 | tpr=0.9721 | fpr=0.1920 | 12304.9 samples/s | 48.1 steps/s
Avg test loss: 0.54444, Avg test acc: 0.81097, Avg tpr: 0.97227, Avg fpr: 0.19196, total FA: 26653

server round 19/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.1] | Loss=0.18958 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.709 | 3702.2 samples/s | 57.8 steps/s
[Step=15250 Epoch=74.4] | Loss=0.03105 | Reg=0.00095 | acc=0.9688 | FP-Norm=0.929 | FP-Norm(final)=2.698 | 3571.2 samples/s | 55.8 steps/s
[Step=15300 Epoch=74.6] | Loss=0.02843 | Reg=0.00122 | acc=0.9844 | FP-Norm=1.075 | FP-Norm(final)=2.689 | 3776.4 samples/s | 59.0 steps/s
[Step=15350 Epoch=74.8] | Loss=0.02480 | Reg=0.00135 | acc=1.0000 | FP-Norm=1.140 | FP-Norm(final)=2.686 | 3775.8 samples/s | 59.0 steps/s
[Step=15400 Epoch=75.1] | Loss=0.02324 | Reg=0.00145 | acc=0.9531 | FP-Norm=1.185 | FP-Norm(final)=2.685 | 4859.2 samples/s | 75.9 steps/s
[Step=15450 Epoch=75.3] | Loss=0.02318 | Reg=0.00158 | acc=1.0000 | FP-Norm=1.237 | FP-Norm(final)=2.684 | 1623.1 samples/s | 25.4 steps/s
[Step=15500 Epoch=75.6] | Loss=0.02170 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.273 | FP-Norm(final)=2.683 | 3790.8 samples/s | 59.2 steps/s
[Step=15550 Epoch=75.8] | Loss=0.02029 | Reg=0.00172 | acc=0.9844 | FP-Norm=1.294 | FP-Norm(final)=2.684 | 3740.1 samples/s | 58.4 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01911 | Reg=0.00175 | acc=0.9844 | FP-Norm=1.308 | FP-Norm(final)=2.685 | 4475.0 samples/s | 69.9 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01807 | Reg=0.00177 | acc=1.0000 | FP-Norm=1.317 | FP-Norm(final)=2.685 | 1666.6 samples/s | 26.0 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01671 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.322 | FP-Norm(final)=2.687 | 3778.4 samples/s | 59.0 steps/s
[Step=15750 Epoch=76.8] | Loss=0.01631 | Reg=0.00178 | acc=0.9688 | FP-Norm=1.325 | FP-Norm(final)=2.688 | 3782.3 samples/s | 59.1 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01577 | Reg=0.00179 | acc=0.9844 | FP-Norm=1.328 | FP-Norm(final)=2.688 | 4293.8 samples/s | 67.1 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01526 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.329 | FP-Norm(final)=2.689 | 1706.3 samples/s | 26.7 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01475 | Reg=0.00179 | acc=0.9844 | FP-Norm=1.330 | FP-Norm(final)=2.689 | 3741.2 samples/s | 58.5 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01409 | Reg=0.00179 | acc=0.9844 | FP-Norm=1.330 | FP-Norm(final)=2.690 | 3781.2 samples/s | 59.1 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01375 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.329 | FP-Norm(final)=2.691 | 4061.0 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.2] | Loss=0.27126 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.709 | 3826.4 samples/s | 59.8 steps/s
[Step=15250 Epoch=74.4] | Loss=0.03076 | Reg=0.00134 | acc=0.9688 | FP-Norm=1.111 | FP-Norm(final)=2.697 | 3469.7 samples/s | 54.2 steps/s
[Step=15300 Epoch=74.7] | Loss=0.02538 | Reg=0.00154 | acc=0.9688 | FP-Norm=1.212 | FP-Norm(final)=2.692 | 3790.4 samples/s | 59.2 steps/s
[Step=15350 Epoch=74.9] | Loss=0.02390 | Reg=0.00161 | acc=0.9844 | FP-Norm=1.249 | FP-Norm(final)=2.689 | 3773.0 samples/s | 59.0 steps/s
[Step=15400 Epoch=75.1] | Loss=0.02331 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.280 | FP-Norm(final)=2.688 | 4860.1 samples/s | 75.9 steps/s
[Step=15450 Epoch=75.4] | Loss=0.02096 | Reg=0.00173 | acc=0.9531 | FP-Norm=1.303 | FP-Norm(final)=2.688 | 1600.6 samples/s | 25.0 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01974 | Reg=0.00176 | acc=1.0000 | FP-Norm=1.318 | FP-Norm(final)=2.688 | 3777.9 samples/s | 59.0 steps/s
[Step=15550 Epoch=75.9] | Loss=0.01835 | Reg=0.00178 | acc=1.0000 | FP-Norm=1.326 | FP-Norm(final)=2.689 | 3778.0 samples/s | 59.0 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01750 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.330 | FP-Norm(final)=2.690 | 4550.1 samples/s | 71.1 steps/s
[Step=15650 Epoch=76.4] | Loss=0.01664 | Reg=0.00180 | acc=0.9844 | FP-Norm=1.334 | FP-Norm(final)=2.692 | 1637.1 samples/s | 25.6 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01568 | Reg=0.00180 | acc=0.9688 | FP-Norm=1.336 | FP-Norm(final)=2.693 | 3789.6 samples/s | 59.2 steps/s
[Step=15750 Epoch=76.9] | Loss=0.01532 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.335 | FP-Norm(final)=2.695 | 3748.1 samples/s | 58.6 steps/s
[Step=15800 Epoch=77.1] | Loss=0.01472 | Reg=0.00179 | acc=1.0000 | FP-Norm=1.334 | FP-Norm(final)=2.695 | 4361.3 samples/s | 68.1 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01421 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.335 | FP-Norm(final)=2.697 | 1677.2 samples/s | 26.2 steps/s
[Step=15900 Epoch=77.6] | Loss=0.01386 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.337 | FP-Norm(final)=2.698 | 3768.9 samples/s | 58.9 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01348 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.338 | FP-Norm(final)=2.699 | 3766.6 samples/s | 58.9 steps/s
[Step=16000 Epoch=78.1] | Loss=0.01309 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.339 | FP-Norm(final)=2.700 | 4160.2 samples/s | 65.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step16000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.1] | Loss=0.14747 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.709 | 3527.3 samples/s | 55.1 steps/s
[Step=15250 Epoch=74.3] | Loss=0.02937 | Reg=0.00109 | acc=0.9531 | FP-Norm=0.997 | FP-Norm(final)=2.701 | 3747.5 samples/s | 58.6 steps/s
[Step=15300 Epoch=74.5] | Loss=0.02358 | Reg=0.00129 | acc=0.9688 | FP-Norm=1.108 | FP-Norm(final)=2.700 | 3746.6 samples/s | 58.5 steps/s
[Step=15350 Epoch=74.8] | Loss=0.02306 | Reg=0.00141 | acc=0.9844 | FP-Norm=1.169 | FP-Norm(final)=2.700 | 3769.1 samples/s | 58.9 steps/s
[Step=15400 Epoch=75.0] | Loss=0.02376 | Reg=0.00152 | acc=0.9844 | FP-Norm=1.217 | FP-Norm(final)=2.698 | 4836.2 samples/s | 75.6 steps/s
[Step=15450 Epoch=75.3] | Loss=0.02153 | Reg=0.00160 | acc=0.9844 | FP-Norm=1.250 | FP-Norm(final)=2.697 | 1632.3 samples/s | 25.5 steps/s
[Step=15500 Epoch=75.5] | Loss=0.02022 | Reg=0.00165 | acc=0.9688 | FP-Norm=1.271 | FP-Norm(final)=2.697 | 3763.8 samples/s | 58.8 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01848 | Reg=0.00167 | acc=0.9844 | FP-Norm=1.280 | FP-Norm(final)=2.699 | 3781.0 samples/s | 59.1 steps/s
[Step=15600 Epoch=76.0] | Loss=0.01729 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.283 | FP-Norm(final)=2.701 | 4497.2 samples/s | 70.3 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01620 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.284 | FP-Norm(final)=2.703 | 1656.4 samples/s | 25.9 steps/s
[Step=15700 Epoch=76.5] | Loss=0.01533 | Reg=0.00167 | acc=0.9844 | FP-Norm=1.283 | FP-Norm(final)=2.705 | 3763.1 samples/s | 58.8 steps/s
[Step=15750 Epoch=76.7] | Loss=0.01484 | Reg=0.00166 | acc=1.0000 | FP-Norm=1.283 | FP-Norm(final)=2.707 | 3766.1 samples/s | 58.8 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01430 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.284 | FP-Norm(final)=2.708 | 4266.1 samples/s | 66.7 steps/s
[Step=15850 Epoch=77.2] | Loss=0.01396 | Reg=0.00167 | acc=1.0000 | FP-Norm=1.286 | FP-Norm(final)=2.709 | 1691.5 samples/s | 26.4 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01373 | Reg=0.00167 | acc=0.9844 | FP-Norm=1.288 | FP-Norm(final)=2.711 | 3771.0 samples/s | 58.9 steps/s
[Step=15950 Epoch=77.7] | Loss=0.01319 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.290 | FP-Norm(final)=2.712 | 3752.5 samples/s | 58.6 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01284 | Reg=0.00168 | acc=1.0000 | FP-Norm=1.291 | FP-Norm(final)=2.713 | 4029.1 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step16000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.1] | Loss=0.05492 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.710 | 3619.1 samples/s | 56.5 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02465 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.785 | FP-Norm(final)=2.711 | 3652.4 samples/s | 57.1 steps/s
[Step=15300 Epoch=74.6] | Loss=0.02087 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.918 | FP-Norm(final)=2.708 | 3757.5 samples/s | 58.7 steps/s
[Step=15350 Epoch=74.9] | Loss=0.01959 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.979 | FP-Norm(final)=2.709 | 3786.3 samples/s | 59.2 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01871 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.021 | FP-Norm(final)=2.708 | 4820.8 samples/s | 75.3 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01718 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.053 | FP-Norm(final)=2.709 | 1628.3 samples/s | 25.4 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01605 | Reg=0.00119 | acc=0.9844 | FP-Norm=1.075 | FP-Norm(final)=2.711 | 3773.3 samples/s | 59.0 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01491 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.090 | FP-Norm(final)=2.713 | 3727.5 samples/s | 58.2 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01439 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.101 | FP-Norm(final)=2.716 | 4507.6 samples/s | 70.4 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01403 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.112 | FP-Norm(final)=2.718 | 1667.1 samples/s | 26.0 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01322 | Reg=0.00128 | acc=0.9844 | FP-Norm=1.122 | FP-Norm(final)=2.719 | 3753.1 samples/s | 58.6 steps/s
[Step=15750 Epoch=76.8] | Loss=0.01265 | Reg=0.00129 | acc=0.9844 | FP-Norm=1.128 | FP-Norm(final)=2.721 | 3769.8 samples/s | 58.9 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01209 | Reg=0.00130 | acc=0.9844 | FP-Norm=1.133 | FP-Norm(final)=2.724 | 4280.5 samples/s | 66.9 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01168 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.136 | FP-Norm(final)=2.726 | 1700.5 samples/s | 26.6 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01118 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.140 | FP-Norm(final)=2.729 | 3782.2 samples/s | 59.1 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01084 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.142 | FP-Norm(final)=2.731 | 3786.8 samples/s | 59.2 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01068 | Reg=0.00132 | acc=0.9844 | FP-Norm=1.144 | FP-Norm(final)=2.732 | 4020.5 samples/s | 62.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step16000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.5] | Loss=0.07793 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.710 | 3654.5 samples/s | 57.1 steps/s
[Step=15250 Epoch=74.8] | Loss=0.02293 | Reg=0.00086 | acc=0.9688 | FP-Norm=0.888 | FP-Norm(final)=2.709 | 3654.1 samples/s | 57.1 steps/s
[Step=15300 Epoch=75.0] | Loss=0.02609 | Reg=0.00108 | acc=0.9688 | FP-Norm=1.014 | FP-Norm(final)=2.704 | 3759.7 samples/s | 58.7 steps/s
[Step=15350 Epoch=75.3] | Loss=0.02355 | Reg=0.00121 | acc=0.9844 | FP-Norm=1.080 | FP-Norm(final)=2.695 | 3773.3 samples/s | 59.0 steps/s
[Step=15400 Epoch=75.5] | Loss=0.02205 | Reg=0.00130 | acc=0.9844 | FP-Norm=1.123 | FP-Norm(final)=2.694 | 4896.6 samples/s | 76.5 steps/s
[Step=15450 Epoch=75.8] | Loss=0.02019 | Reg=0.00137 | acc=0.9688 | FP-Norm=1.154 | FP-Norm(final)=2.694 | 1594.9 samples/s | 24.9 steps/s
[Step=15500 Epoch=76.0] | Loss=0.01862 | Reg=0.00141 | acc=1.0000 | FP-Norm=1.173 | FP-Norm(final)=2.695 | 3759.9 samples/s | 58.7 steps/s
[Step=15550 Epoch=76.3] | Loss=0.01774 | Reg=0.00144 | acc=0.9844 | FP-Norm=1.189 | FP-Norm(final)=2.696 | 3770.6 samples/s | 58.9 steps/s
[Step=15600 Epoch=76.5] | Loss=0.01699 | Reg=0.00147 | acc=0.9688 | FP-Norm=1.201 | FP-Norm(final)=2.698 | 4640.5 samples/s | 72.5 steps/s
[Step=15650 Epoch=76.7] | Loss=0.01591 | Reg=0.00148 | acc=1.0000 | FP-Norm=1.208 | FP-Norm(final)=2.699 | 1634.1 samples/s | 25.5 steps/s
[Step=15700 Epoch=77.0] | Loss=0.01497 | Reg=0.00149 | acc=1.0000 | FP-Norm=1.213 | FP-Norm(final)=2.700 | 3761.6 samples/s | 58.8 steps/s
[Step=15750 Epoch=77.2] | Loss=0.01447 | Reg=0.00150 | acc=1.0000 | FP-Norm=1.216 | FP-Norm(final)=2.702 | 3770.3 samples/s | 58.9 steps/s
[Step=15800 Epoch=77.5] | Loss=0.01401 | Reg=0.00150 | acc=0.9844 | FP-Norm=1.219 | FP-Norm(final)=2.703 | 4520.8 samples/s | 70.6 steps/s
[Step=15850 Epoch=77.7] | Loss=0.01335 | Reg=0.00151 | acc=1.0000 | FP-Norm=1.222 | FP-Norm(final)=2.704 | 1646.5 samples/s | 25.7 steps/s
[Step=15900 Epoch=78.0] | Loss=0.01291 | Reg=0.00151 | acc=0.9844 | FP-Norm=1.223 | FP-Norm(final)=2.706 | 3774.0 samples/s | 59.0 steps/s
[Step=15950 Epoch=78.2] | Loss=0.01253 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.225 | FP-Norm(final)=2.707 | 3785.4 samples/s | 59.1 steps/s
[Step=16000 Epoch=78.5] | Loss=0.01217 | Reg=0.00152 | acc=1.0000 | FP-Norm=1.226 | FP-Norm(final)=2.708 | 4298.2 samples/s | 67.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=144.0] | Loss=0.17004 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.708 | 3593.4 samples/s | 56.1 steps/s
[Step=15250 Epoch=144.5] | Loss=0.01120 | Reg=0.00291 | acc=0.9844 | FP-Norm=1.631 | FP-Norm(final)=2.691 | 3231.6 samples/s | 50.5 steps/s
[Step=15300 Epoch=145.0] | Loss=0.00672 | Reg=0.00318 | acc=1.0000 | FP-Norm=1.745 | FP-Norm(final)=2.689 | 4591.5 samples/s | 71.7 steps/s
[Step=15350 Epoch=145.5] | Loss=0.00450 | Reg=0.00315 | acc=1.0000 | FP-Norm=1.749 | FP-Norm(final)=2.690 | 1547.6 samples/s | 24.2 steps/s
[Step=15400 Epoch=145.9] | Loss=0.00351 | Reg=0.00304 | acc=1.0000 | FP-Norm=1.723 | FP-Norm(final)=2.690 | 4296.9 samples/s | 67.1 steps/s
[Step=15450 Epoch=146.4] | Loss=0.00282 | Reg=0.00294 | acc=1.0000 | FP-Norm=1.696 | FP-Norm(final)=2.691 | 1576.3 samples/s | 24.6 steps/s
[Step=15500 Epoch=146.9] | Loss=0.00236 | Reg=0.00283 | acc=1.0000 | FP-Norm=1.666 | FP-Norm(final)=2.693 | 3804.6 samples/s | 59.4 steps/s
[Step=15550 Epoch=147.3] | Loss=0.00203 | Reg=0.00273 | acc=1.0000 | FP-Norm=1.636 | FP-Norm(final)=2.694 | 1516.3 samples/s | 23.7 steps/s
[Step=15600 Epoch=147.8] | Loss=0.00178 | Reg=0.00263 | acc=1.0000 | FP-Norm=1.605 | FP-Norm(final)=2.695 | 3477.3 samples/s | 54.3 steps/s
[Step=15650 Epoch=148.3] | Loss=0.00158 | Reg=0.00254 | acc=1.0000 | FP-Norm=1.576 | FP-Norm(final)=2.696 | 1561.8 samples/s | 24.4 steps/s
[Step=15700 Epoch=148.8] | Loss=0.00142 | Reg=0.00245 | acc=1.0000 | FP-Norm=1.549 | FP-Norm(final)=2.697 | 3270.9 samples/s | 51.1 steps/s
[Step=15750 Epoch=149.2] | Loss=0.00130 | Reg=0.00237 | acc=1.0000 | FP-Norm=1.522 | FP-Norm(final)=2.698 | 1607.3 samples/s | 25.1 steps/s
[Step=15800 Epoch=149.7] | Loss=0.00119 | Reg=0.00230 | acc=1.0000 | FP-Norm=1.496 | FP-Norm(final)=2.699 | 3294.7 samples/s | 51.5 steps/s
[Step=15850 Epoch=150.2] | Loss=0.00110 | Reg=0.00223 | acc=1.0000 | FP-Norm=1.471 | FP-Norm(final)=2.700 | 1693.3 samples/s | 26.5 steps/s
[Step=15900 Epoch=150.7] | Loss=0.00102 | Reg=0.00216 | acc=1.0000 | FP-Norm=1.448 | FP-Norm(final)=2.701 | 3557.4 samples/s | 55.6 steps/s
[Step=15950 Epoch=151.1] | Loss=0.00095 | Reg=0.00210 | acc=1.0000 | FP-Norm=1.425 | FP-Norm(final)=2.701 | 1728.4 samples/s | 27.0 steps/s
[Step=16000 Epoch=151.6] | Loss=0.00090 | Reg=0.00204 | acc=1.0000 | FP-Norm=1.403 | FP-Norm(final)=2.702 | 3524.5 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step16000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=144.6] | Loss=0.07104 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.709 | 3676.8 samples/s | 57.5 steps/s
[Step=15250 Epoch=145.1] | Loss=0.01035 | Reg=0.00230 | acc=0.9844 | FP-Norm=1.450 | FP-Norm(final)=2.692 | 3208.6 samples/s | 50.1 steps/s
[Step=15300 Epoch=145.5] | Loss=0.00598 | Reg=0.00265 | acc=1.0000 | FP-Norm=1.590 | FP-Norm(final)=2.687 | 4607.4 samples/s | 72.0 steps/s
[Step=15350 Epoch=146.0] | Loss=0.00406 | Reg=0.00264 | acc=1.0000 | FP-Norm=1.600 | FP-Norm(final)=2.687 | 1546.4 samples/s | 24.2 steps/s
[Step=15400 Epoch=146.5] | Loss=0.00306 | Reg=0.00254 | acc=1.0000 | FP-Norm=1.575 | FP-Norm(final)=2.688 | 4337.5 samples/s | 67.8 steps/s
[Step=15450 Epoch=147.0] | Loss=0.00246 | Reg=0.00244 | acc=1.0000 | FP-Norm=1.544 | FP-Norm(final)=2.690 | 1583.0 samples/s | 24.7 steps/s
[Step=15500 Epoch=147.4] | Loss=0.00205 | Reg=0.00233 | acc=1.0000 | FP-Norm=1.511 | FP-Norm(final)=2.691 | 4097.3 samples/s | 64.0 steps/s
[Step=15550 Epoch=147.9] | Loss=0.00176 | Reg=0.00224 | acc=1.0000 | FP-Norm=1.479 | FP-Norm(final)=2.693 | 1620.4 samples/s | 25.3 steps/s
[Step=15600 Epoch=148.4] | Loss=0.00154 | Reg=0.00215 | acc=1.0000 | FP-Norm=1.449 | FP-Norm(final)=2.694 | 3763.7 samples/s | 58.8 steps/s
[Step=15650 Epoch=148.9] | Loss=0.00138 | Reg=0.00207 | acc=1.0000 | FP-Norm=1.420 | FP-Norm(final)=2.695 | 1657.1 samples/s | 25.9 steps/s
[Step=15700 Epoch=149.3] | Loss=0.00124 | Reg=0.00199 | acc=1.0000 | FP-Norm=1.393 | FP-Norm(final)=2.697 | 3612.9 samples/s | 56.5 steps/s
[Step=15750 Epoch=149.8] | Loss=0.00113 | Reg=0.00192 | acc=1.0000 | FP-Norm=1.367 | FP-Norm(final)=2.698 | 1693.2 samples/s | 26.5 steps/s
[Step=15800 Epoch=150.3] | Loss=0.00104 | Reg=0.00186 | acc=1.0000 | FP-Norm=1.343 | FP-Norm(final)=2.699 | 3567.9 samples/s | 55.7 steps/s
[Step=15850 Epoch=150.8] | Loss=0.00096 | Reg=0.00180 | acc=1.0000 | FP-Norm=1.319 | FP-Norm(final)=2.700 | 1712.6 samples/s | 26.8 steps/s
[Step=15900 Epoch=151.2] | Loss=0.00089 | Reg=0.00174 | acc=1.0000 | FP-Norm=1.297 | FP-Norm(final)=2.700 | 3563.1 samples/s | 55.7 steps/s
[Step=15950 Epoch=151.7] | Loss=0.00083 | Reg=0.00169 | acc=1.0000 | FP-Norm=1.275 | FP-Norm(final)=2.701 | 1690.8 samples/s | 26.4 steps/s
[Step=16000 Epoch=152.2] | Loss=0.00078 | Reg=0.00164 | acc=1.0000 | FP-Norm=1.254 | FP-Norm(final)=2.702 | 3576.8 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step16000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=145.2] | Loss=0.13387 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.708 | 3589.4 samples/s | 56.1 steps/s
[Step=15250 Epoch=145.6] | Loss=0.01233 | Reg=0.00248 | acc=1.0000 | FP-Norm=1.489 | FP-Norm(final)=2.690 | 3248.1 samples/s | 50.8 steps/s
[Step=15300 Epoch=146.1] | Loss=0.00669 | Reg=0.00301 | acc=1.0000 | FP-Norm=1.684 | FP-Norm(final)=2.681 | 4664.1 samples/s | 72.9 steps/s
[Step=15350 Epoch=146.6] | Loss=0.00449 | Reg=0.00298 | acc=1.0000 | FP-Norm=1.694 | FP-Norm(final)=2.680 | 1529.3 samples/s | 23.9 steps/s
[Step=15400 Epoch=147.1] | Loss=0.00338 | Reg=0.00287 | acc=1.0000 | FP-Norm=1.669 | FP-Norm(final)=2.681 | 4404.5 samples/s | 68.8 steps/s
[Step=15450 Epoch=147.5] | Loss=0.00271 | Reg=0.00275 | acc=1.0000 | FP-Norm=1.636 | FP-Norm(final)=2.682 | 1578.5 samples/s | 24.7 steps/s
[Step=15500 Epoch=148.0] | Loss=0.00226 | Reg=0.00264 | acc=1.0000 | FP-Norm=1.603 | FP-Norm(final)=2.683 | 4191.7 samples/s | 65.5 steps/s
[Step=15550 Epoch=148.5] | Loss=0.00194 | Reg=0.00253 | acc=1.0000 | FP-Norm=1.571 | FP-Norm(final)=2.684 | 1589.9 samples/s | 24.8 steps/s
[Step=15600 Epoch=149.0] | Loss=0.00170 | Reg=0.00244 | acc=1.0000 | FP-Norm=1.540 | FP-Norm(final)=2.685 | 3992.8 samples/s | 62.4 steps/s
[Step=15650 Epoch=149.4] | Loss=0.00151 | Reg=0.00235 | acc=1.0000 | FP-Norm=1.511 | FP-Norm(final)=2.686 | 1641.1 samples/s | 25.6 steps/s
[Step=15700 Epoch=149.9] | Loss=0.00136 | Reg=0.00226 | acc=1.0000 | FP-Norm=1.484 | FP-Norm(final)=2.688 | 3806.3 samples/s | 59.5 steps/s
[Step=15750 Epoch=150.4] | Loss=0.00124 | Reg=0.00219 | acc=1.0000 | FP-Norm=1.457 | FP-Norm(final)=2.689 | 1644.4 samples/s | 25.7 steps/s
[Step=15800 Epoch=150.9] | Loss=0.00114 | Reg=0.00212 | acc=1.0000 | FP-Norm=1.432 | FP-Norm(final)=2.690 | 3567.0 samples/s | 55.7 steps/s
[Step=15850 Epoch=151.4] | Loss=0.00105 | Reg=0.00205 | acc=1.0000 | FP-Norm=1.408 | FP-Norm(final)=2.691 | 1691.2 samples/s | 26.4 steps/s
[Step=15900 Epoch=151.8] | Loss=0.00098 | Reg=0.00199 | acc=1.0000 | FP-Norm=1.385 | FP-Norm(final)=2.692 | 3556.5 samples/s | 55.6 steps/s
[Step=15950 Epoch=152.3] | Loss=0.00092 | Reg=0.00193 | acc=1.0000 | FP-Norm=1.362 | FP-Norm(final)=2.693 | 1708.2 samples/s | 26.7 steps/s
[Step=16000 Epoch=152.8] | Loss=0.00086 | Reg=0.00187 | acc=1.0000 | FP-Norm=1.341 | FP-Norm(final)=2.694 | 3598.9 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step16000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=143.2] | Loss=0.16699 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.708 | 3468.7 samples/s | 54.2 steps/s
[Step=15250 Epoch=143.7] | Loss=0.01863 | Reg=0.00296 | acc=1.0000 | FP-Norm=1.632 | FP-Norm(final)=2.678 | 3323.7 samples/s | 51.9 steps/s
[Step=15300 Epoch=144.2] | Loss=0.00994 | Reg=0.00341 | acc=1.0000 | FP-Norm=1.799 | FP-Norm(final)=2.667 | 4462.8 samples/s | 69.7 steps/s
[Step=15350 Epoch=144.6] | Loss=0.00667 | Reg=0.00332 | acc=1.0000 | FP-Norm=1.787 | FP-Norm(final)=2.667 | 1551.3 samples/s | 24.2 steps/s
[Step=15400 Epoch=145.1] | Loss=0.00503 | Reg=0.00316 | acc=1.0000 | FP-Norm=1.750 | FP-Norm(final)=2.669 | 4187.6 samples/s | 65.4 steps/s
[Step=15450 Epoch=145.6] | Loss=0.00404 | Reg=0.00301 | acc=1.0000 | FP-Norm=1.711 | FP-Norm(final)=2.671 | 1595.8 samples/s | 24.9 steps/s
[Step=15500 Epoch=146.1] | Loss=0.00337 | Reg=0.00287 | acc=1.0000 | FP-Norm=1.672 | FP-Norm(final)=2.673 | 3956.4 samples/s | 61.8 steps/s
[Step=15550 Epoch=146.5] | Loss=0.00289 | Reg=0.00275 | acc=1.0000 | FP-Norm=1.634 | FP-Norm(final)=2.674 | 1629.3 samples/s | 25.5 steps/s
[Step=15600 Epoch=147.0] | Loss=0.00254 | Reg=0.00263 | acc=1.0000 | FP-Norm=1.600 | FP-Norm(final)=2.676 | 3730.8 samples/s | 58.3 steps/s
[Step=15650 Epoch=147.5] | Loss=0.00226 | Reg=0.00253 | acc=1.0000 | FP-Norm=1.567 | FP-Norm(final)=2.678 | 1684.0 samples/s | 26.3 steps/s
[Step=15700 Epoch=147.9] | Loss=0.00204 | Reg=0.00244 | acc=1.0000 | FP-Norm=1.537 | FP-Norm(final)=2.679 | 3570.5 samples/s | 55.8 steps/s
[Step=15750 Epoch=148.4] | Loss=0.00185 | Reg=0.00235 | acc=1.0000 | FP-Norm=1.508 | FP-Norm(final)=2.681 | 1708.7 samples/s | 26.7 steps/s
[Step=15800 Epoch=148.9] | Loss=0.00170 | Reg=0.00227 | acc=1.0000 | FP-Norm=1.481 | FP-Norm(final)=2.682 | 3601.5 samples/s | 56.3 steps/s
[Step=15850 Epoch=149.4] | Loss=0.00157 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.455 | FP-Norm(final)=2.684 | 1722.2 samples/s | 26.9 steps/s
[Step=15900 Epoch=149.8] | Loss=0.00146 | Reg=0.00213 | acc=1.0000 | FP-Norm=1.430 | FP-Norm(final)=2.685 | 3560.1 samples/s | 55.6 steps/s
[Step=15950 Epoch=150.3] | Loss=0.00137 | Reg=0.00206 | acc=1.0000 | FP-Norm=1.406 | FP-Norm(final)=2.686 | 1779.7 samples/s | 27.8 steps/s
[Step=16000 Epoch=150.8] | Loss=0.00128 | Reg=0.00200 | acc=1.0000 | FP-Norm=1.384 | FP-Norm(final)=2.688 | 3367.8 samples/s | 52.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step16000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=144.9] | Loss=0.15142 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.708 | 3654.3 samples/s | 57.1 steps/s
[Step=15250 Epoch=145.3] | Loss=0.01509 | Reg=0.00295 | acc=1.0000 | FP-Norm=1.643 | FP-Norm(final)=2.689 | 3223.1 samples/s | 50.4 steps/s
[Step=15300 Epoch=145.8] | Loss=0.00855 | Reg=0.00336 | acc=1.0000 | FP-Norm=1.793 | FP-Norm(final)=2.678 | 4679.4 samples/s | 73.1 steps/s
[Step=15350 Epoch=146.3] | Loss=0.00572 | Reg=0.00332 | acc=1.0000 | FP-Norm=1.795 | FP-Norm(final)=2.677 | 1533.6 samples/s | 24.0 steps/s
[Step=15400 Epoch=146.8] | Loss=0.00429 | Reg=0.00320 | acc=1.0000 | FP-Norm=1.768 | FP-Norm(final)=2.677 | 4396.6 samples/s | 68.7 steps/s
[Step=15450 Epoch=147.3] | Loss=0.00345 | Reg=0.00308 | acc=1.0000 | FP-Norm=1.735 | FP-Norm(final)=2.678 | 1582.4 samples/s | 24.7 steps/s
[Step=15500 Epoch=147.7] | Loss=0.00288 | Reg=0.00295 | acc=1.0000 | FP-Norm=1.701 | FP-Norm(final)=2.679 | 4181.4 samples/s | 65.3 steps/s
[Step=15550 Epoch=148.2] | Loss=0.00247 | Reg=0.00284 | acc=1.0000 | FP-Norm=1.669 | FP-Norm(final)=2.680 | 1600.9 samples/s | 25.0 steps/s
[Step=15600 Epoch=148.7] | Loss=0.00217 | Reg=0.00274 | acc=1.0000 | FP-Norm=1.638 | FP-Norm(final)=2.681 | 3988.3 samples/s | 62.3 steps/s
[Step=15650 Epoch=149.2] | Loss=0.00193 | Reg=0.00265 | acc=1.0000 | FP-Norm=1.609 | FP-Norm(final)=2.683 | 1639.8 samples/s | 25.6 steps/s
[Step=15700 Epoch=149.6] | Loss=0.00174 | Reg=0.00256 | acc=1.0000 | FP-Norm=1.581 | FP-Norm(final)=2.684 | 3755.6 samples/s | 58.7 steps/s
[Step=15750 Epoch=150.1] | Loss=0.00158 | Reg=0.00248 | acc=1.0000 | FP-Norm=1.554 | FP-Norm(final)=2.685 | 1657.8 samples/s | 25.9 steps/s
[Step=15800 Epoch=150.6] | Loss=0.00145 | Reg=0.00240 | acc=1.0000 | FP-Norm=1.529 | FP-Norm(final)=2.686 | 3592.1 samples/s | 56.1 steps/s
[Step=15850 Epoch=151.1] | Loss=0.00134 | Reg=0.00233 | acc=1.0000 | FP-Norm=1.504 | FP-Norm(final)=2.687 | 1683.1 samples/s | 26.3 steps/s
[Step=15900 Epoch=151.5] | Loss=0.00125 | Reg=0.00226 | acc=1.0000 | FP-Norm=1.481 | FP-Norm(final)=2.689 | 3592.6 samples/s | 56.1 steps/s
[Step=15950 Epoch=152.0] | Loss=0.00117 | Reg=0.00220 | acc=1.0000 | FP-Norm=1.458 | FP-Norm(final)=2.690 | 1687.2 samples/s | 26.4 steps/s
[Step=16000 Epoch=152.5] | Loss=0.00110 | Reg=0.00214 | acc=1.0000 | FP-Norm=1.436 | FP-Norm(final)=2.691 | 3579.8 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20185 | acc=0.8641 | tpr=0.8110 | fpr=0.0208 | 3628.8 samples/s | 14.2 steps/s
Avg test loss: 0.20235, Avg test acc: 0.86553, Avg tpr: 0.81436, Avg fpr: 0.02192, total FA: 171

Testing server on iccad2012
[Step=  50] | Loss=0.52936 | acc=0.8139 | tpr=0.9779 | fpr=0.1890 | 3619.2 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.54774 | acc=0.8107 | tpr=0.9787 | fpr=0.1925 | 6757.0 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.55631 | acc=0.8085 | tpr=0.9741 | fpr=0.1945 | 6843.0 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.55668 | acc=0.8086 | tpr=0.9760 | fpr=0.1944 | 4679.6 samples/s | 18.3 steps/s
[Step= 250] | Loss=0.55462 | acc=0.8086 | tpr=0.9729 | fpr=0.1944 | 6530.2 samples/s | 25.5 steps/s
[Step= 300] | Loss=0.55797 | acc=0.8084 | tpr=0.9702 | fpr=0.1945 | 7261.7 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.55805 | acc=0.8084 | tpr=0.9706 | fpr=0.1945 | 6445.8 samples/s | 25.2 steps/s
[Step= 400] | Loss=0.55863 | acc=0.8081 | tpr=0.9716 | fpr=0.1948 | 6229.3 samples/s | 24.3 steps/s
[Step= 450] | Loss=0.56203 | acc=0.8079 | tpr=0.9718 | fpr=0.1951 | 6699.7 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.56310 | acc=0.8077 | tpr=0.9727 | fpr=0.1953 | 6897.8 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.56259 | acc=0.8078 | tpr=0.9725 | fpr=0.1952 | 12622.3 samples/s | 49.3 steps/s
Avg test loss: 0.56257, Avg test acc: 0.80785, Avg tpr: 0.97266, Avg fpr: 0.19514, total FA: 27095

server round 20/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.14485 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.717 | 3640.8 samples/s | 56.9 steps/s
[Step=16050 Epoch=78.3] | Loss=0.02638 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.713 | 3636.7 samples/s | 56.8 steps/s
[Step=16100 Epoch=78.5] | Loss=0.02205 | Reg=0.00039 | acc=0.9844 | FP-Norm=0.611 | FP-Norm(final)=2.714 | 3726.9 samples/s | 58.2 steps/s
[Step=16150 Epoch=78.8] | Loss=0.01860 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.648 | FP-Norm(final)=2.717 | 3787.0 samples/s | 59.2 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01737 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.675 | FP-Norm(final)=2.720 | 4813.0 samples/s | 75.2 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01541 | Reg=0.00049 | acc=0.9844 | FP-Norm=0.691 | FP-Norm(final)=2.723 | 1628.1 samples/s | 25.4 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01391 | Reg=0.00051 | acc=0.9844 | FP-Norm=0.704 | FP-Norm(final)=2.726 | 3767.2 samples/s | 58.9 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01252 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.711 | FP-Norm(final)=2.730 | 3818.6 samples/s | 59.7 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01163 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.715 | FP-Norm(final)=2.733 | 4554.7 samples/s | 71.2 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01093 | Reg=0.00052 | acc=0.9844 | FP-Norm=0.719 | FP-Norm(final)=2.737 | 1664.2 samples/s | 26.0 steps/s
[Step=16500 Epoch=80.5] | Loss=0.01026 | Reg=0.00053 | acc=0.9844 | FP-Norm=0.721 | FP-Norm(final)=2.739 | 3779.8 samples/s | 59.1 steps/s
[Step=16550 Epoch=80.7] | Loss=0.00979 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.723 | FP-Norm(final)=2.742 | 3768.7 samples/s | 58.9 steps/s
[Step=16600 Epoch=80.9] | Loss=0.00958 | Reg=0.00053 | acc=0.9844 | FP-Norm=0.726 | FP-Norm(final)=2.744 | 4297.9 samples/s | 67.2 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00918 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.727 | FP-Norm(final)=2.746 | 1692.2 samples/s | 26.4 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00875 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.728 | FP-Norm(final)=2.748 | 3750.1 samples/s | 58.6 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00844 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.730 | FP-Norm(final)=2.750 | 3737.0 samples/s | 58.4 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00833 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.731 | FP-Norm(final)=2.751 | 4063.6 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step16800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.1] | Loss=0.09414 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.717 | 3591.0 samples/s | 56.1 steps/s
[Step=16050 Epoch=78.3] | Loss=0.02268 | Reg=0.00038 | acc=0.9844 | FP-Norm=0.586 | FP-Norm(final)=2.722 | 3730.9 samples/s | 58.3 steps/s
[Step=16100 Epoch=78.6] | Loss=0.01719 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.646 | FP-Norm(final)=2.725 | 3787.1 samples/s | 59.2 steps/s
[Step=16150 Epoch=78.8] | Loss=0.01681 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.675 | FP-Norm(final)=2.727 | 3738.4 samples/s | 58.4 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01570 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.699 | FP-Norm(final)=2.729 | 4836.7 samples/s | 75.6 steps/s
[Step=16250 Epoch=79.3] | Loss=0.01383 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.713 | FP-Norm(final)=2.732 | 1626.0 samples/s | 25.4 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01234 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.720 | FP-Norm(final)=2.735 | 3768.5 samples/s | 58.9 steps/s
[Step=16350 Epoch=79.8] | Loss=0.01151 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.725 | FP-Norm(final)=2.738 | 3730.7 samples/s | 58.3 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01108 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.729 | FP-Norm(final)=2.740 | 4597.4 samples/s | 71.8 steps/s
[Step=16450 Epoch=80.3] | Loss=0.01027 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.732 | FP-Norm(final)=2.743 | 1654.9 samples/s | 25.9 steps/s
[Step=16500 Epoch=80.5] | Loss=0.00977 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.733 | FP-Norm(final)=2.745 | 3764.2 samples/s | 58.8 steps/s
[Step=16550 Epoch=80.8] | Loss=0.00931 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.733 | FP-Norm(final)=2.747 | 3779.8 samples/s | 59.1 steps/s
[Step=16600 Epoch=81.0] | Loss=0.00896 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.734 | FP-Norm(final)=2.749 | 4376.9 samples/s | 68.4 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00855 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.735 | FP-Norm(final)=2.751 | 1689.4 samples/s | 26.4 steps/s
[Step=16700 Epoch=81.5] | Loss=0.00826 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.736 | FP-Norm(final)=2.753 | 3770.7 samples/s | 58.9 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00792 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.736 | FP-Norm(final)=2.755 | 3746.3 samples/s | 58.5 steps/s
[Step=16800 Epoch=82.0] | Loss=0.00784 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.737 | FP-Norm(final)=2.757 | 4193.1 samples/s | 65.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step16800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.12242 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.717 | 3814.3 samples/s | 59.6 steps/s
[Step=16050 Epoch=78.2] | Loss=0.02907 | Reg=0.00038 | acc=0.9688 | FP-Norm=0.585 | FP-Norm(final)=2.713 | 3473.0 samples/s | 54.3 steps/s
[Step=16100 Epoch=78.4] | Loss=0.02187 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.654 | FP-Norm(final)=2.713 | 3749.5 samples/s | 58.6 steps/s
[Step=16150 Epoch=78.7] | Loss=0.01943 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.717 | 3761.2 samples/s | 58.8 steps/s
[Step=16200 Epoch=78.9] | Loss=0.01744 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.706 | FP-Norm(final)=2.721 | 4768.6 samples/s | 74.5 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01531 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.726 | FP-Norm(final)=2.726 | 1635.7 samples/s | 25.6 steps/s
[Step=16300 Epoch=79.4] | Loss=0.01387 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.739 | FP-Norm(final)=2.730 | 3732.9 samples/s | 58.3 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01277 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.747 | FP-Norm(final)=2.735 | 3677.6 samples/s | 57.5 steps/s
[Step=16400 Epoch=79.9] | Loss=0.01211 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.753 | FP-Norm(final)=2.739 | 4514.3 samples/s | 70.5 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01146 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.758 | FP-Norm(final)=2.742 | 1660.4 samples/s | 25.9 steps/s
[Step=16500 Epoch=80.4] | Loss=0.01097 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.762 | FP-Norm(final)=2.745 | 3765.8 samples/s | 58.8 steps/s
[Step=16550 Epoch=80.6] | Loss=0.01041 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.748 | 3771.1 samples/s | 58.9 steps/s
[Step=16600 Epoch=80.9] | Loss=0.00992 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.767 | FP-Norm(final)=2.750 | 4261.9 samples/s | 66.6 steps/s
[Step=16650 Epoch=81.1] | Loss=0.00951 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.768 | FP-Norm(final)=2.753 | 1700.5 samples/s | 26.6 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00922 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.770 | FP-Norm(final)=2.755 | 3799.1 samples/s | 59.4 steps/s
[Step=16750 Epoch=81.6] | Loss=0.00889 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.757 | 3749.4 samples/s | 58.6 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00851 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.773 | FP-Norm(final)=2.760 | 4085.5 samples/s | 63.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step16800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.17858 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.717 | 3127.9 samples/s | 48.9 steps/s
[Step=16050 Epoch=78.3] | Loss=0.02529 | Reg=0.00040 | acc=0.9844 | FP-Norm=0.608 | FP-Norm(final)=2.716 | 2014.6 samples/s | 31.5 steps/s
[Step=16100 Epoch=78.5] | Loss=0.01987 | Reg=0.00046 | acc=0.9688 | FP-Norm=0.666 | FP-Norm(final)=2.716 | 3503.3 samples/s | 54.7 steps/s
[Step=16150 Epoch=78.8] | Loss=0.01800 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.690 | FP-Norm(final)=2.718 | 3766.2 samples/s | 58.8 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01612 | Reg=0.00052 | acc=0.9844 | FP-Norm=0.710 | FP-Norm(final)=2.721 | 4866.3 samples/s | 76.0 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01424 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.721 | FP-Norm(final)=2.724 | 1614.0 samples/s | 25.2 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01320 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.729 | FP-Norm(final)=2.727 | 3784.7 samples/s | 59.1 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01198 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.733 | FP-Norm(final)=2.731 | 3742.7 samples/s | 58.5 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01111 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.736 | FP-Norm(final)=2.734 | 4544.5 samples/s | 71.0 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01032 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.738 | FP-Norm(final)=2.737 | 1678.4 samples/s | 26.2 steps/s
[Step=16500 Epoch=80.5] | Loss=0.00980 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.738 | FP-Norm(final)=2.740 | 3772.2 samples/s | 58.9 steps/s
[Step=16550 Epoch=80.7] | Loss=0.00934 | Reg=0.00055 | acc=0.9688 | FP-Norm=0.739 | FP-Norm(final)=2.743 | 3801.8 samples/s | 59.4 steps/s
[Step=16600 Epoch=81.0] | Loss=0.00904 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.741 | FP-Norm(final)=2.745 | 4248.9 samples/s | 66.4 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00881 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.745 | FP-Norm(final)=2.747 | 1698.3 samples/s | 26.5 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00851 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.752 | FP-Norm(final)=2.750 | 3683.6 samples/s | 57.6 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00815 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.756 | FP-Norm(final)=2.752 | 3793.9 samples/s | 59.3 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00800 | Reg=0.00058 | acc=0.9688 | FP-Norm=0.760 | FP-Norm(final)=2.755 | 4037.0 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step16800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.5] | Loss=0.12300 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.717 | 3592.1 samples/s | 56.1 steps/s
[Step=16050 Epoch=78.7] | Loss=0.02725 | Reg=0.00036 | acc=0.9844 | FP-Norm=0.575 | FP-Norm(final)=2.717 | 3667.3 samples/s | 57.3 steps/s
[Step=16100 Epoch=79.0] | Loss=0.02160 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.642 | FP-Norm(final)=2.719 | 3789.1 samples/s | 59.2 steps/s
[Step=16150 Epoch=79.2] | Loss=0.01924 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.680 | FP-Norm(final)=2.720 | 3772.4 samples/s | 58.9 steps/s
[Step=16200 Epoch=79.4] | Loss=0.01707 | Reg=0.00050 | acc=0.9844 | FP-Norm=0.698 | FP-Norm(final)=2.721 | 4936.3 samples/s | 77.1 steps/s
[Step=16250 Epoch=79.7] | Loss=0.01478 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.709 | FP-Norm(final)=2.723 | 1613.5 samples/s | 25.2 steps/s
[Step=16300 Epoch=79.9] | Loss=0.01356 | Reg=0.00052 | acc=0.9844 | FP-Norm=0.716 | FP-Norm(final)=2.725 | 3744.0 samples/s | 58.5 steps/s
[Step=16350 Epoch=80.2] | Loss=0.01260 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.721 | FP-Norm(final)=2.728 | 3785.7 samples/s | 59.2 steps/s
[Step=16400 Epoch=80.4] | Loss=0.01160 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.725 | FP-Norm(final)=2.731 | 4711.6 samples/s | 73.6 steps/s
[Step=16450 Epoch=80.7] | Loss=0.01074 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.728 | FP-Norm(final)=2.734 | 1645.6 samples/s | 25.7 steps/s
[Step=16500 Epoch=80.9] | Loss=0.01046 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.731 | FP-Norm(final)=2.736 | 3789.4 samples/s | 59.2 steps/s
[Step=16550 Epoch=81.2] | Loss=0.00989 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.734 | FP-Norm(final)=2.738 | 3748.3 samples/s | 58.6 steps/s
[Step=16600 Epoch=81.4] | Loss=0.00938 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.737 | FP-Norm(final)=2.740 | 4510.4 samples/s | 70.5 steps/s
[Step=16650 Epoch=81.6] | Loss=0.00905 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.738 | FP-Norm(final)=2.742 | 1664.2 samples/s | 26.0 steps/s
[Step=16700 Epoch=81.9] | Loss=0.00858 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.740 | FP-Norm(final)=2.745 | 3766.3 samples/s | 58.8 steps/s
[Step=16750 Epoch=82.1] | Loss=0.00827 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.741 | FP-Norm(final)=2.747 | 3774.5 samples/s | 59.0 steps/s
[Step=16800 Epoch=82.4] | Loss=0.00802 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.743 | FP-Norm(final)=2.749 | 4360.2 samples/s | 68.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step16800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=151.6] | Loss=0.04073 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.717 | 3422.4 samples/s | 53.5 steps/s
[Step=16050 Epoch=152.1] | Loss=0.00833 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.912 | FP-Norm(final)=2.713 | 3433.4 samples/s | 53.6 steps/s
[Step=16100 Epoch=152.6] | Loss=0.00447 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.953 | FP-Norm(final)=2.714 | 4675.7 samples/s | 73.1 steps/s
[Step=16150 Epoch=153.0] | Loss=0.00301 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.932 | FP-Norm(final)=2.716 | 1529.4 samples/s | 23.9 steps/s
[Step=16200 Epoch=153.5] | Loss=0.00228 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.907 | FP-Norm(final)=2.717 | 4329.4 samples/s | 67.6 steps/s
[Step=16250 Epoch=154.0] | Loss=0.00183 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.884 | FP-Norm(final)=2.718 | 1581.2 samples/s | 24.7 steps/s
[Step=16300 Epoch=154.5] | Loss=0.00153 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.862 | FP-Norm(final)=2.719 | 3997.4 samples/s | 62.5 steps/s
[Step=16350 Epoch=154.9] | Loss=0.00132 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.843 | FP-Norm(final)=2.720 | 1616.9 samples/s | 25.3 steps/s
[Step=16400 Epoch=155.4] | Loss=0.00116 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.825 | FP-Norm(final)=2.720 | 3855.4 samples/s | 60.2 steps/s
[Step=16450 Epoch=155.9] | Loss=0.00104 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.721 | 1665.9 samples/s | 26.0 steps/s
[Step=16500 Epoch=156.4] | Loss=0.00094 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.794 | FP-Norm(final)=2.722 | 3637.5 samples/s | 56.8 steps/s
[Step=16550 Epoch=156.8] | Loss=0.00086 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.781 | FP-Norm(final)=2.722 | 1671.3 samples/s | 26.1 steps/s
[Step=16600 Epoch=157.3] | Loss=0.00079 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.768 | FP-Norm(final)=2.723 | 3554.9 samples/s | 55.5 steps/s
[Step=16650 Epoch=157.8] | Loss=0.00073 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.756 | FP-Norm(final)=2.723 | 1720.6 samples/s | 26.9 steps/s
[Step=16700 Epoch=158.2] | Loss=0.00068 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.745 | FP-Norm(final)=2.723 | 3554.2 samples/s | 55.5 steps/s
[Step=16750 Epoch=158.7] | Loss=0.00064 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.734 | FP-Norm(final)=2.724 | 1726.7 samples/s | 27.0 steps/s
[Step=16800 Epoch=159.2] | Loss=0.00060 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.724 | FP-Norm(final)=2.724 | 3533.1 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step16800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=152.2] | Loss=0.04052 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.717 | 3702.0 samples/s | 57.8 steps/s
[Step=16050 Epoch=152.7] | Loss=0.01017 | Reg=0.00107 | acc=1.0000 | FP-Norm=0.985 | FP-Norm(final)=2.704 | 3211.4 samples/s | 50.2 steps/s
[Step=16100 Epoch=153.2] | Loss=0.00521 | Reg=0.00115 | acc=1.0000 | FP-Norm=1.046 | FP-Norm(final)=2.702 | 4720.1 samples/s | 73.8 steps/s
[Step=16150 Epoch=153.6] | Loss=0.00356 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.037 | FP-Norm(final)=2.703 | 1551.1 samples/s | 24.2 steps/s
[Step=16200 Epoch=154.1] | Loss=0.00268 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.015 | FP-Norm(final)=2.705 | 4316.3 samples/s | 67.4 steps/s
[Step=16250 Epoch=154.6] | Loss=0.00216 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.993 | FP-Norm(final)=2.706 | 1576.9 samples/s | 24.6 steps/s
[Step=16300 Epoch=155.1] | Loss=0.00180 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.972 | FP-Norm(final)=2.707 | 4076.9 samples/s | 63.7 steps/s
[Step=16350 Epoch=155.5] | Loss=0.00155 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.953 | FP-Norm(final)=2.708 | 1594.9 samples/s | 24.9 steps/s
[Step=16400 Epoch=156.0] | Loss=0.00136 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.935 | FP-Norm(final)=2.709 | 3840.4 samples/s | 60.0 steps/s
[Step=16450 Epoch=156.5] | Loss=0.00121 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.919 | FP-Norm(final)=2.709 | 1639.4 samples/s | 25.6 steps/s
[Step=16500 Epoch=157.0] | Loss=0.00110 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.904 | FP-Norm(final)=2.710 | 3646.9 samples/s | 57.0 steps/s
[Step=16550 Epoch=157.4] | Loss=0.00100 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.890 | FP-Norm(final)=2.711 | 1690.5 samples/s | 26.4 steps/s
[Step=16600 Epoch=157.9] | Loss=0.00092 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.712 | 3598.2 samples/s | 56.2 steps/s
[Step=16650 Epoch=158.4] | Loss=0.00085 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.864 | FP-Norm(final)=2.712 | 1720.3 samples/s | 26.9 steps/s
[Step=16700 Epoch=158.9] | Loss=0.00079 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.853 | FP-Norm(final)=2.713 | 3645.8 samples/s | 57.0 steps/s
[Step=16750 Epoch=159.3] | Loss=0.00074 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.842 | FP-Norm(final)=2.713 | 1715.7 samples/s | 26.8 steps/s
[Step=16800 Epoch=159.8] | Loss=0.00069 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.831 | FP-Norm(final)=2.714 | 3599.3 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step16800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=152.8] | Loss=0.08991 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.717 | 3527.2 samples/s | 55.1 steps/s
[Step=16050 Epoch=153.3] | Loss=0.00916 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.860 | FP-Norm(final)=2.707 | 3308.1 samples/s | 51.7 steps/s
[Step=16100 Epoch=153.7] | Loss=0.00465 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.894 | FP-Norm(final)=2.708 | 4687.4 samples/s | 73.2 steps/s
[Step=16150 Epoch=154.2] | Loss=0.00313 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.709 | 1537.1 samples/s | 24.0 steps/s
[Step=16200 Epoch=154.7] | Loss=0.00237 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.856 | FP-Norm(final)=2.710 | 4397.8 samples/s | 68.7 steps/s
[Step=16250 Epoch=155.2] | Loss=0.00190 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.836 | FP-Norm(final)=2.711 | 1570.8 samples/s | 24.5 steps/s
[Step=16300 Epoch=155.7] | Loss=0.00159 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.712 | 4192.3 samples/s | 65.5 steps/s
[Step=16350 Epoch=156.1] | Loss=0.00137 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.713 | 1595.4 samples/s | 24.9 steps/s
[Step=16400 Epoch=156.6] | Loss=0.00121 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.714 | 4002.1 samples/s | 62.5 steps/s
[Step=16450 Epoch=157.1] | Loss=0.00108 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.715 | 1636.9 samples/s | 25.6 steps/s
[Step=16500 Epoch=157.6] | Loss=0.00097 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.758 | FP-Norm(final)=2.716 | 3658.9 samples/s | 57.2 steps/s
[Step=16550 Epoch=158.0] | Loss=0.00089 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.746 | FP-Norm(final)=2.716 | 1661.5 samples/s | 26.0 steps/s
[Step=16600 Epoch=158.5] | Loss=0.00082 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.734 | FP-Norm(final)=2.717 | 3629.4 samples/s | 56.7 steps/s
[Step=16650 Epoch=159.0] | Loss=0.00076 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.723 | FP-Norm(final)=2.717 | 1705.7 samples/s | 26.7 steps/s
[Step=16700 Epoch=159.5] | Loss=0.00070 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.713 | FP-Norm(final)=2.718 | 3540.7 samples/s | 55.3 steps/s
[Step=16750 Epoch=160.0] | Loss=0.00066 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.703 | FP-Norm(final)=2.719 | 1684.1 samples/s | 26.3 steps/s
[Step=16800 Epoch=160.4] | Loss=0.00062 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.694 | FP-Norm(final)=2.719 | 3629.2 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step16800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=150.8] | Loss=0.01180 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.717 | 3541.8 samples/s | 55.3 steps/s
[Step=16050 Epoch=151.2] | Loss=0.00361 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.725 | FP-Norm(final)=2.719 | 3476.7 samples/s | 54.3 steps/s
[Step=16100 Epoch=151.7] | Loss=0.00187 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.751 | FP-Norm(final)=2.721 | 4644.4 samples/s | 72.6 steps/s
[Step=16150 Epoch=152.2] | Loss=0.00129 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.741 | FP-Norm(final)=2.722 | 1558.6 samples/s | 24.4 steps/s
[Step=16200 Epoch=152.7] | Loss=0.00099 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.723 | FP-Norm(final)=2.723 | 4254.1 samples/s | 66.5 steps/s
[Step=16250 Epoch=153.1] | Loss=0.00080 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.707 | FP-Norm(final)=2.724 | 1619.7 samples/s | 25.3 steps/s
[Step=16300 Epoch=153.6] | Loss=0.00067 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.690 | FP-Norm(final)=2.724 | 3968.7 samples/s | 62.0 steps/s
[Step=16350 Epoch=154.1] | Loss=0.00058 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.675 | FP-Norm(final)=2.725 | 1651.8 samples/s | 25.8 steps/s
[Step=16400 Epoch=154.5] | Loss=0.00051 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.661 | FP-Norm(final)=2.725 | 3655.5 samples/s | 57.1 steps/s
[Step=16450 Epoch=155.0] | Loss=0.00046 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.648 | FP-Norm(final)=2.726 | 1656.6 samples/s | 25.9 steps/s
[Step=16500 Epoch=155.5] | Loss=0.00041 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.636 | FP-Norm(final)=2.726 | 3553.1 samples/s | 55.5 steps/s
[Step=16550 Epoch=155.9] | Loss=0.00038 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.625 | FP-Norm(final)=2.726 | 1708.8 samples/s | 26.7 steps/s
[Step=16600 Epoch=156.4] | Loss=0.00035 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.614 | FP-Norm(final)=2.727 | 3612.3 samples/s | 56.4 steps/s
[Step=16650 Epoch=156.9] | Loss=0.00032 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=2.727 | 1716.2 samples/s | 26.8 steps/s
[Step=16700 Epoch=157.4] | Loss=0.00030 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.727 | 3521.2 samples/s | 55.0 steps/s
[Step=16750 Epoch=157.8] | Loss=0.00028 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=2.727 | 1788.2 samples/s | 27.9 steps/s
[Step=16800 Epoch=158.3] | Loss=0.00027 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.728 | 3289.1 samples/s | 51.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step16800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=152.5] | Loss=0.09926 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.717 | 3625.7 samples/s | 56.7 steps/s
[Step=16050 Epoch=153.0] | Loss=0.00424 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.723 | FP-Norm(final)=2.719 | 3365.2 samples/s | 52.6 steps/s
[Step=16100 Epoch=153.4] | Loss=0.00230 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.769 | FP-Norm(final)=2.722 | 4691.6 samples/s | 73.3 steps/s
[Step=16150 Epoch=153.9] | Loss=0.00155 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.757 | FP-Norm(final)=2.724 | 1525.9 samples/s | 23.8 steps/s
[Step=16200 Epoch=154.4] | Loss=0.00117 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.738 | FP-Norm(final)=2.726 | 4385.2 samples/s | 68.5 steps/s
[Step=16250 Epoch=154.9] | Loss=0.00095 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.720 | FP-Norm(final)=2.726 | 1566.3 samples/s | 24.5 steps/s
[Step=16300 Epoch=155.4] | Loss=0.00080 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.703 | FP-Norm(final)=2.727 | 4143.4 samples/s | 64.7 steps/s
[Step=16350 Epoch=155.8] | Loss=0.00069 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.688 | FP-Norm(final)=2.728 | 1604.4 samples/s | 25.1 steps/s
[Step=16400 Epoch=156.3] | Loss=0.00061 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.674 | FP-Norm(final)=2.728 | 3985.2 samples/s | 62.3 steps/s
[Step=16450 Epoch=156.8] | Loss=0.00054 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.662 | FP-Norm(final)=2.729 | 1637.8 samples/s | 25.6 steps/s
[Step=16500 Epoch=157.3] | Loss=0.00049 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.650 | FP-Norm(final)=2.729 | 3777.3 samples/s | 59.0 steps/s
[Step=16550 Epoch=157.7] | Loss=0.00045 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.639 | FP-Norm(final)=2.730 | 1665.5 samples/s | 26.0 steps/s
[Step=16600 Epoch=158.2] | Loss=0.00042 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.629 | FP-Norm(final)=2.730 | 3612.5 samples/s | 56.4 steps/s
[Step=16650 Epoch=158.7] | Loss=0.00039 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.620 | FP-Norm(final)=2.730 | 1680.5 samples/s | 26.3 steps/s
[Step=16700 Epoch=159.2] | Loss=0.00036 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.611 | FP-Norm(final)=2.731 | 3577.8 samples/s | 55.9 steps/s
[Step=16750 Epoch=159.6] | Loss=0.00034 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.602 | FP-Norm(final)=2.731 | 1696.4 samples/s | 26.5 steps/s
[Step=16800 Epoch=160.1] | Loss=0.00032 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=2.731 | 3557.6 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21614 | acc=0.8648 | tpr=0.8109 | fpr=0.0183 | 3670.6 samples/s | 14.3 steps/s
Avg test loss: 0.21657, Avg test acc: 0.86553, Avg tpr: 0.81349, Avg fpr: 0.02000, total FA: 156

Testing server on iccad2012
[Step=  50] | Loss=0.50941 | acc=0.8305 | tpr=0.9779 | fpr=0.1721 | 3614.9 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.52707 | acc=0.8278 | tpr=0.9787 | fpr=0.1750 | 6989.8 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.53559 | acc=0.8254 | tpr=0.9741 | fpr=0.1773 | 6900.7 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.53651 | acc=0.8255 | tpr=0.9760 | fpr=0.1772 | 6637.3 samples/s | 25.9 steps/s
[Step= 250] | Loss=0.53435 | acc=0.8253 | tpr=0.9729 | fpr=0.1773 | 7086.8 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.53787 | acc=0.8250 | tpr=0.9702 | fpr=0.1776 | 6760.4 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.53824 | acc=0.8252 | tpr=0.9706 | fpr=0.1774 | 6738.0 samples/s | 26.3 steps/s
[Step= 400] | Loss=0.53894 | acc=0.8249 | tpr=0.9721 | fpr=0.1778 | 6748.9 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.54243 | acc=0.8246 | tpr=0.9713 | fpr=0.1781 | 6905.5 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.54338 | acc=0.8243 | tpr=0.9722 | fpr=0.1784 | 6599.2 samples/s | 25.8 steps/s
[Step= 550] | Loss=0.54274 | acc=0.8245 | tpr=0.9729 | fpr=0.1782 | 12573.7 samples/s | 49.1 steps/s
Avg test loss: 0.54275, Avg test acc: 0.82453, Avg tpr: 0.97306, Avg fpr: 0.17817, total FA: 24739

server round 21/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=81.9] | Loss=0.14115 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.757 | 3641.7 samples/s | 56.9 steps/s
[Step=16850 Epoch=82.2] | Loss=0.02403 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.657 | FP-Norm(final)=2.754 | 3630.4 samples/s | 56.7 steps/s
[Step=16900 Epoch=82.4] | Loss=0.02066 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.728 | FP-Norm(final)=2.752 | 3782.3 samples/s | 59.1 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01888 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.758 | FP-Norm(final)=2.752 | 3779.5 samples/s | 59.1 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01749 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.783 | FP-Norm(final)=2.752 | 4837.8 samples/s | 75.6 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01520 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.798 | FP-Norm(final)=2.754 | 1623.1 samples/s | 25.4 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01401 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.805 | FP-Norm(final)=2.756 | 3745.0 samples/s | 58.5 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01293 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.758 | 3780.8 samples/s | 59.1 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01201 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.761 | 4520.8 samples/s | 70.6 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01107 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.808 | FP-Norm(final)=2.763 | 1660.2 samples/s | 25.9 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01039 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.766 | 3774.1 samples/s | 59.0 steps/s
[Step=17350 Epoch=84.6] | Loss=0.01014 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.807 | FP-Norm(final)=2.769 | 3762.6 samples/s | 58.8 steps/s
[Step=17400 Epoch=84.8] | Loss=0.00969 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.771 | 4296.5 samples/s | 67.1 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00936 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.807 | FP-Norm(final)=2.773 | 1702.5 samples/s | 26.6 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00907 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.806 | FP-Norm(final)=2.774 | 3773.7 samples/s | 59.0 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00867 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.805 | FP-Norm(final)=2.776 | 3793.3 samples/s | 59.3 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00845 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.805 | FP-Norm(final)=2.778 | 4071.4 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step17600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=82.0] | Loss=0.15852 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.756 | 3664.4 samples/s | 57.3 steps/s
[Step=16850 Epoch=82.2] | Loss=0.02438 | Reg=0.00047 | acc=0.9375 | FP-Norm=0.659 | FP-Norm(final)=2.755 | 3610.4 samples/s | 56.4 steps/s
[Step=16900 Epoch=82.5] | Loss=0.02049 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.717 | FP-Norm(final)=2.755 | 3776.7 samples/s | 59.0 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01850 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.744 | FP-Norm(final)=2.756 | 3776.4 samples/s | 59.0 steps/s
[Step=17000 Epoch=83.0] | Loss=0.01643 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.763 | FP-Norm(final)=2.757 | 4853.2 samples/s | 75.8 steps/s
[Step=17050 Epoch=83.2] | Loss=0.01441 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.759 | 1620.6 samples/s | 25.3 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01271 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.779 | FP-Norm(final)=2.761 | 3785.5 samples/s | 59.1 steps/s
[Step=17150 Epoch=83.7] | Loss=0.01169 | Reg=0.00062 | acc=0.9688 | FP-Norm=0.781 | FP-Norm(final)=2.764 | 3776.0 samples/s | 59.0 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01115 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.781 | FP-Norm(final)=2.767 | 4592.0 samples/s | 71.7 steps/s
[Step=17250 Epoch=84.2] | Loss=0.01043 | Reg=0.00062 | acc=0.9688 | FP-Norm=0.781 | FP-Norm(final)=2.769 | 1648.8 samples/s | 25.8 steps/s
[Step=17300 Epoch=84.4] | Loss=0.00991 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.781 | FP-Norm(final)=2.771 | 3788.3 samples/s | 59.2 steps/s
[Step=17350 Epoch=84.7] | Loss=0.00965 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.773 | 3755.9 samples/s | 58.7 steps/s
[Step=17400 Epoch=84.9] | Loss=0.00936 | Reg=0.00061 | acc=0.9844 | FP-Norm=0.780 | FP-Norm(final)=2.775 | 4395.4 samples/s | 68.7 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00902 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.776 | 1688.3 samples/s | 26.4 steps/s
[Step=17500 Epoch=85.4] | Loss=0.00871 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.779 | FP-Norm(final)=2.778 | 3770.4 samples/s | 58.9 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00839 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.779 | 3777.8 samples/s | 59.0 steps/s
[Step=17600 Epoch=85.9] | Loss=0.00812 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.781 | 4168.2 samples/s | 65.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step17600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=81.9] | Loss=0.04388 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.757 | 3654.3 samples/s | 57.1 steps/s
[Step=16850 Epoch=82.1] | Loss=0.02557 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.638 | FP-Norm(final)=2.754 | 3639.7 samples/s | 56.9 steps/s
[Step=16900 Epoch=82.3] | Loss=0.01957 | Reg=0.00052 | acc=0.9844 | FP-Norm=0.706 | FP-Norm(final)=2.754 | 3766.9 samples/s | 58.9 steps/s
[Step=16950 Epoch=82.6] | Loss=0.01813 | Reg=0.00056 | acc=0.9688 | FP-Norm=0.738 | FP-Norm(final)=2.755 | 3749.0 samples/s | 58.6 steps/s
[Step=17000 Epoch=82.8] | Loss=0.01713 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.756 | 4823.1 samples/s | 75.4 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01485 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.757 | 1618.6 samples/s | 25.3 steps/s
[Step=17100 Epoch=83.3] | Loss=0.01327 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.779 | FP-Norm(final)=2.759 | 3723.2 samples/s | 58.2 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01248 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.782 | FP-Norm(final)=2.761 | 3774.9 samples/s | 59.0 steps/s
[Step=17200 Epoch=83.8] | Loss=0.01178 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.784 | FP-Norm(final)=2.763 | 4526.2 samples/s | 70.7 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01113 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.766 | 1647.9 samples/s | 25.7 steps/s
[Step=17300 Epoch=84.3] | Loss=0.01071 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.788 | FP-Norm(final)=2.768 | 3751.9 samples/s | 58.6 steps/s
[Step=17350 Epoch=84.5] | Loss=0.01017 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.791 | FP-Norm(final)=2.770 | 3757.4 samples/s | 58.7 steps/s
[Step=17400 Epoch=84.8] | Loss=0.00987 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.792 | FP-Norm(final)=2.771 | 4265.2 samples/s | 66.6 steps/s
[Step=17450 Epoch=85.0] | Loss=0.00946 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.773 | 1667.3 samples/s | 26.1 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00910 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.775 | 3725.2 samples/s | 58.2 steps/s
[Step=17550 Epoch=85.5] | Loss=0.00883 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.777 | 3775.3 samples/s | 59.0 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00846 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.794 | FP-Norm(final)=2.778 | 4058.0 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step17600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=81.9] | Loss=0.20281 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.757 | 3745.2 samples/s | 58.5 steps/s
[Step=16850 Epoch=82.2] | Loss=0.02385 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=2.755 | 3559.5 samples/s | 55.6 steps/s
[Step=16900 Epoch=82.4] | Loss=0.02091 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.671 | FP-Norm(final)=2.755 | 3761.0 samples/s | 58.8 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01792 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.705 | FP-Norm(final)=2.755 | 3790.2 samples/s | 59.2 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01584 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.728 | FP-Norm(final)=2.758 | 4839.7 samples/s | 75.6 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01407 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.735 | FP-Norm(final)=2.760 | 1616.4 samples/s | 25.3 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01260 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.739 | FP-Norm(final)=2.762 | 3736.0 samples/s | 58.4 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01163 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.740 | FP-Norm(final)=2.765 | 3774.8 samples/s | 59.0 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01102 | Reg=0.00056 | acc=0.9688 | FP-Norm=0.742 | FP-Norm(final)=2.767 | 4545.5 samples/s | 71.0 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01033 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.744 | FP-Norm(final)=2.770 | 1673.6 samples/s | 26.2 steps/s
[Step=17300 Epoch=84.4] | Loss=0.00974 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.744 | FP-Norm(final)=2.772 | 3762.0 samples/s | 58.8 steps/s
[Step=17350 Epoch=84.6] | Loss=0.00932 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.744 | FP-Norm(final)=2.774 | 3779.8 samples/s | 59.1 steps/s
[Step=17400 Epoch=84.9] | Loss=0.00888 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.745 | FP-Norm(final)=2.775 | 4293.2 samples/s | 67.1 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00846 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.745 | FP-Norm(final)=2.777 | 1706.7 samples/s | 26.7 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00809 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.745 | FP-Norm(final)=2.779 | 3777.0 samples/s | 59.0 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00781 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.746 | FP-Norm(final)=2.781 | 3772.4 samples/s | 58.9 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00758 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.746 | FP-Norm(final)=2.783 | 4052.5 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step17600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=82.4] | Loss=0.10704 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.757 | 3890.0 samples/s | 60.8 steps/s
[Step=16850 Epoch=82.6] | Loss=0.02883 | Reg=0.00044 | acc=0.9844 | FP-Norm=0.635 | FP-Norm(final)=2.750 | 3507.4 samples/s | 54.8 steps/s
[Step=16900 Epoch=82.9] | Loss=0.02244 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.698 | FP-Norm(final)=2.750 | 3749.5 samples/s | 58.6 steps/s
[Step=16950 Epoch=83.1] | Loss=0.01815 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.731 | FP-Norm(final)=2.752 | 3768.2 samples/s | 58.9 steps/s
[Step=17000 Epoch=83.4] | Loss=0.01675 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.749 | FP-Norm(final)=2.753 | 4940.0 samples/s | 77.2 steps/s
[Step=17050 Epoch=83.6] | Loss=0.01440 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.759 | FP-Norm(final)=2.756 | 1606.1 samples/s | 25.1 steps/s
[Step=17100 Epoch=83.9] | Loss=0.01296 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.764 | FP-Norm(final)=2.758 | 3724.7 samples/s | 58.2 steps/s
[Step=17150 Epoch=84.1] | Loss=0.01213 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.768 | FP-Norm(final)=2.761 | 3772.8 samples/s | 58.9 steps/s
[Step=17200 Epoch=84.3] | Loss=0.01144 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.770 | FP-Norm(final)=2.764 | 4694.8 samples/s | 73.4 steps/s
[Step=17250 Epoch=84.6] | Loss=0.01093 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.773 | FP-Norm(final)=2.766 | 1640.5 samples/s | 25.6 steps/s
[Step=17300 Epoch=84.8] | Loss=0.01013 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.768 | 3773.2 samples/s | 59.0 steps/s
[Step=17350 Epoch=85.1] | Loss=0.00961 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.770 | 3769.4 samples/s | 58.9 steps/s
[Step=17400 Epoch=85.3] | Loss=0.00929 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.772 | 4504.4 samples/s | 70.4 steps/s
[Step=17450 Epoch=85.6] | Loss=0.00875 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.776 | FP-Norm(final)=2.774 | 1655.9 samples/s | 25.9 steps/s
[Step=17500 Epoch=85.8] | Loss=0.00839 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.776 | FP-Norm(final)=2.776 | 3738.9 samples/s | 58.4 steps/s
[Step=17550 Epoch=86.1] | Loss=0.00822 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.777 | FP-Norm(final)=2.778 | 3727.7 samples/s | 58.2 steps/s
[Step=17600 Epoch=86.3] | Loss=0.00793 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.777 | FP-Norm(final)=2.780 | 4341.7 samples/s | 67.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step17600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=159.2] | Loss=0.18720 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.756 | 3743.7 samples/s | 58.5 steps/s
[Step=16850 Epoch=159.7] | Loss=0.01021 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.926 | FP-Norm(final)=2.742 | 3327.5 samples/s | 52.0 steps/s
[Step=16900 Epoch=160.1] | Loss=0.00531 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.973 | FP-Norm(final)=2.743 | 4603.6 samples/s | 71.9 steps/s
[Step=16950 Epoch=160.6] | Loss=0.00356 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.960 | FP-Norm(final)=2.744 | 1541.4 samples/s | 24.1 steps/s
[Step=17000 Epoch=161.1] | Loss=0.00269 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.940 | FP-Norm(final)=2.745 | 4277.6 samples/s | 66.8 steps/s
[Step=17050 Epoch=161.6] | Loss=0.00216 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.919 | FP-Norm(final)=2.746 | 1580.7 samples/s | 24.7 steps/s
[Step=17100 Epoch=162.0] | Loss=0.00180 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.901 | FP-Norm(final)=2.746 | 4041.5 samples/s | 63.1 steps/s
[Step=17150 Epoch=162.5] | Loss=0.00155 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.883 | FP-Norm(final)=2.747 | 1609.4 samples/s | 25.1 steps/s
[Step=17200 Epoch=163.0] | Loss=0.00136 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.867 | FP-Norm(final)=2.748 | 3855.8 samples/s | 60.2 steps/s
[Step=17250 Epoch=163.5] | Loss=0.00121 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.852 | FP-Norm(final)=2.749 | 1683.4 samples/s | 26.3 steps/s
[Step=17300 Epoch=163.9] | Loss=0.00109 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.839 | FP-Norm(final)=2.749 | 3659.0 samples/s | 57.2 steps/s
[Step=17350 Epoch=164.4] | Loss=0.00100 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.750 | 1707.0 samples/s | 26.7 steps/s
[Step=17400 Epoch=164.9] | Loss=0.00092 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.814 | FP-Norm(final)=2.750 | 3565.3 samples/s | 55.7 steps/s
[Step=17450 Epoch=165.4] | Loss=0.00085 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.802 | FP-Norm(final)=2.751 | 1708.1 samples/s | 26.7 steps/s
[Step=17500 Epoch=165.8] | Loss=0.00079 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.792 | FP-Norm(final)=2.751 | 3583.4 samples/s | 56.0 steps/s
[Step=17550 Epoch=166.3] | Loss=0.00074 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.781 | FP-Norm(final)=2.752 | 1742.9 samples/s | 27.2 steps/s
[Step=17600 Epoch=166.8] | Loss=0.00069 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.752 | 3499.9 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step17600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=159.8] | Loss=0.08850 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.756 | 3584.9 samples/s | 56.0 steps/s
[Step=16850 Epoch=160.3] | Loss=0.00457 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.760 | FP-Norm(final)=2.755 | 3435.8 samples/s | 53.7 steps/s
[Step=16900 Epoch=160.8] | Loss=0.00241 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.757 | 4555.0 samples/s | 71.2 steps/s
[Step=16950 Epoch=161.2] | Loss=0.00163 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.790 | FP-Norm(final)=2.758 | 1526.8 samples/s | 23.9 steps/s
[Step=17000 Epoch=161.7] | Loss=0.00123 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.759 | 4349.4 samples/s | 68.0 steps/s
[Step=17050 Epoch=162.2] | Loss=0.00099 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.754 | FP-Norm(final)=2.760 | 1588.5 samples/s | 24.8 steps/s
[Step=17100 Epoch=162.7] | Loss=0.00084 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.737 | FP-Norm(final)=2.760 | 4049.7 samples/s | 63.3 steps/s
[Step=17150 Epoch=163.1] | Loss=0.00072 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.722 | FP-Norm(final)=2.761 | 1648.3 samples/s | 25.8 steps/s
[Step=17200 Epoch=163.6] | Loss=0.00063 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.709 | FP-Norm(final)=2.761 | 3873.8 samples/s | 60.5 steps/s
[Step=17250 Epoch=164.1] | Loss=0.00057 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.696 | FP-Norm(final)=2.762 | 1645.7 samples/s | 25.7 steps/s
[Step=17300 Epoch=164.6] | Loss=0.00051 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.685 | FP-Norm(final)=2.762 | 3621.0 samples/s | 56.6 steps/s
[Step=17350 Epoch=165.0] | Loss=0.00047 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.674 | FP-Norm(final)=2.763 | 1691.0 samples/s | 26.4 steps/s
[Step=17400 Epoch=165.5] | Loss=0.00043 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.664 | FP-Norm(final)=2.763 | 3568.5 samples/s | 55.8 steps/s
[Step=17450 Epoch=166.0] | Loss=0.00040 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.654 | FP-Norm(final)=2.764 | 1687.6 samples/s | 26.4 steps/s
[Step=17500 Epoch=166.5] | Loss=0.00037 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.645 | FP-Norm(final)=2.764 | 3581.8 samples/s | 56.0 steps/s
[Step=17550 Epoch=166.9] | Loss=0.00035 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.637 | FP-Norm(final)=2.764 | 1734.4 samples/s | 27.1 steps/s
[Step=17600 Epoch=167.4] | Loss=0.00033 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.629 | FP-Norm(final)=2.764 | 3553.2 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step17600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=160.4] | Loss=0.11154 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.756 | 3518.9 samples/s | 55.0 steps/s
[Step=16850 Epoch=160.9] | Loss=0.01173 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.040 | FP-Norm(final)=2.746 | 3357.5 samples/s | 52.5 steps/s
[Step=16900 Epoch=161.4] | Loss=0.00598 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.095 | FP-Norm(final)=2.745 | 4661.6 samples/s | 72.8 steps/s
[Step=16950 Epoch=161.9] | Loss=0.00400 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.083 | FP-Norm(final)=2.746 | 1540.7 samples/s | 24.1 steps/s
[Step=17000 Epoch=162.3] | Loss=0.00302 | Reg=0.00116 | acc=1.0000 | FP-Norm=1.061 | FP-Norm(final)=2.747 | 4441.1 samples/s | 69.4 steps/s
[Step=17050 Epoch=162.8] | Loss=0.00242 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.039 | FP-Norm(final)=2.747 | 1543.8 samples/s | 24.1 steps/s
[Step=17100 Epoch=163.3] | Loss=0.00202 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.017 | FP-Norm(final)=2.748 | 4150.5 samples/s | 64.9 steps/s
[Step=17150 Epoch=163.8] | Loss=0.00174 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.998 | FP-Norm(final)=2.748 | 1597.9 samples/s | 25.0 steps/s
[Step=17200 Epoch=164.2] | Loss=0.00153 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.979 | FP-Norm(final)=2.749 | 3994.0 samples/s | 62.4 steps/s
[Step=17250 Epoch=164.7] | Loss=0.00136 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.963 | FP-Norm(final)=2.749 | 1635.2 samples/s | 25.5 steps/s
[Step=17300 Epoch=165.2] | Loss=0.00123 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.947 | FP-Norm(final)=2.750 | 3759.2 samples/s | 58.7 steps/s
[Step=17350 Epoch=165.7] | Loss=0.00112 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.932 | FP-Norm(final)=2.750 | 1647.7 samples/s | 25.7 steps/s
[Step=17400 Epoch=166.2] | Loss=0.00103 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.918 | FP-Norm(final)=2.751 | 3483.4 samples/s | 54.4 steps/s
[Step=17450 Epoch=166.6] | Loss=0.00095 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.905 | FP-Norm(final)=2.751 | 1690.5 samples/s | 26.4 steps/s
[Step=17500 Epoch=167.1] | Loss=0.00088 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.892 | FP-Norm(final)=2.752 | 3565.7 samples/s | 55.7 steps/s
[Step=17550 Epoch=167.6] | Loss=0.00083 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.880 | FP-Norm(final)=2.752 | 1703.7 samples/s | 26.6 steps/s
[Step=17600 Epoch=168.1] | Loss=0.00078 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.869 | FP-Norm(final)=2.752 | 3596.3 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step17600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=158.3] | Loss=0.15624 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.756 | 3620.4 samples/s | 56.6 steps/s
[Step=16850 Epoch=158.8] | Loss=0.01002 | Reg=0.00105 | acc=1.0000 | FP-Norm=0.985 | FP-Norm(final)=2.748 | 3091.7 samples/s | 48.3 steps/s
[Step=16900 Epoch=159.2] | Loss=0.00513 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.034 | FP-Norm(final)=2.746 | 4472.8 samples/s | 69.9 steps/s
[Step=16950 Epoch=159.7] | Loss=0.00344 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.022 | FP-Norm(final)=2.746 | 1542.8 samples/s | 24.1 steps/s
[Step=17000 Epoch=160.2] | Loss=0.00259 | Reg=0.00102 | acc=1.0000 | FP-Norm=1.001 | FP-Norm(final)=2.747 | 4290.0 samples/s | 67.0 steps/s
[Step=17050 Epoch=160.7] | Loss=0.00208 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.979 | FP-Norm(final)=2.747 | 1594.8 samples/s | 24.9 steps/s
[Step=17100 Epoch=161.1] | Loss=0.00174 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.959 | FP-Norm(final)=2.748 | 3926.6 samples/s | 61.4 steps/s
[Step=17150 Epoch=161.6] | Loss=0.00149 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.941 | FP-Norm(final)=2.748 | 1639.2 samples/s | 25.6 steps/s
[Step=17200 Epoch=162.1] | Loss=0.00131 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.924 | FP-Norm(final)=2.748 | 3736.0 samples/s | 58.4 steps/s
[Step=17250 Epoch=162.5] | Loss=0.00117 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.908 | FP-Norm(final)=2.749 | 1682.3 samples/s | 26.3 steps/s
[Step=17300 Epoch=163.0] | Loss=0.00105 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.893 | FP-Norm(final)=2.749 | 3574.9 samples/s | 55.9 steps/s
[Step=17350 Epoch=163.5] | Loss=0.00096 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.879 | FP-Norm(final)=2.750 | 1694.5 samples/s | 26.5 steps/s
[Step=17400 Epoch=164.0] | Loss=0.00088 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.866 | FP-Norm(final)=2.750 | 3598.6 samples/s | 56.2 steps/s
[Step=17450 Epoch=164.4] | Loss=0.00081 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.853 | FP-Norm(final)=2.750 | 1745.5 samples/s | 27.3 steps/s
[Step=17500 Epoch=164.9] | Loss=0.00076 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.842 | FP-Norm(final)=2.751 | 3539.4 samples/s | 55.3 steps/s
[Step=17550 Epoch=165.4] | Loss=0.00071 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.830 | FP-Norm(final)=2.751 | 1784.1 samples/s | 27.9 steps/s
[Step=17600 Epoch=165.8] | Loss=0.00066 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.751 | 3226.8 samples/s | 50.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step17600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=160.1] | Loss=0.12178 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.756 | 3578.4 samples/s | 55.9 steps/s
[Step=16850 Epoch=160.6] | Loss=0.01198 | Reg=0.00107 | acc=1.0000 | FP-Norm=0.992 | FP-Norm(final)=2.745 | 3499.3 samples/s | 54.7 steps/s
[Step=16900 Epoch=161.1] | Loss=0.00632 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.058 | FP-Norm(final)=2.743 | 4671.2 samples/s | 73.0 steps/s
[Step=16950 Epoch=161.5] | Loss=0.00426 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.050 | FP-Norm(final)=2.744 | 1541.7 samples/s | 24.1 steps/s
[Step=17000 Epoch=162.0] | Loss=0.00321 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.032 | FP-Norm(final)=2.745 | 4288.0 samples/s | 67.0 steps/s
[Step=17050 Epoch=162.5] | Loss=0.00258 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.012 | FP-Norm(final)=2.746 | 1566.9 samples/s | 24.5 steps/s
[Step=17100 Epoch=163.0] | Loss=0.00215 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.994 | FP-Norm(final)=2.747 | 4122.3 samples/s | 64.4 steps/s
[Step=17150 Epoch=163.5] | Loss=0.00185 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.976 | FP-Norm(final)=2.747 | 1605.7 samples/s | 25.1 steps/s
[Step=17200 Epoch=163.9] | Loss=0.00163 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.960 | FP-Norm(final)=2.748 | 3937.9 samples/s | 61.5 steps/s
[Step=17250 Epoch=164.4] | Loss=0.00145 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.945 | FP-Norm(final)=2.749 | 1633.5 samples/s | 25.5 steps/s
[Step=17300 Epoch=164.9] | Loss=0.00131 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.931 | FP-Norm(final)=2.749 | 3699.3 samples/s | 57.8 steps/s
[Step=17350 Epoch=165.4] | Loss=0.00119 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.918 | FP-Norm(final)=2.750 | 1663.3 samples/s | 26.0 steps/s
[Step=17400 Epoch=165.8] | Loss=0.00110 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.905 | FP-Norm(final)=2.751 | 3613.6 samples/s | 56.5 steps/s
[Step=17450 Epoch=166.3] | Loss=0.00101 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.893 | FP-Norm(final)=2.751 | 1701.0 samples/s | 26.6 steps/s
[Step=17500 Epoch=166.8] | Loss=0.00094 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.882 | FP-Norm(final)=2.752 | 3580.1 samples/s | 55.9 steps/s
[Step=17550 Epoch=167.3] | Loss=0.00088 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.752 | 1709.7 samples/s | 26.7 steps/s
[Step=17600 Epoch=167.7] | Loss=0.00083 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.860 | FP-Norm(final)=2.753 | 3512.5 samples/s | 54.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23641 | acc=0.8561 | tpr=0.7978 | fpr=0.0173 | 3601.1 samples/s | 14.1 steps/s
Avg test loss: 0.23718, Avg test acc: 0.85676, Avg tpr: 0.80020, Avg fpr: 0.01884, total FA: 147

Testing server on iccad2012
[Step=  50] | Loss=0.47740 | acc=0.8467 | tpr=0.9779 | fpr=0.1556 | 3605.0 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.49509 | acc=0.8437 | tpr=0.9787 | fpr=0.1588 | 6929.5 samples/s | 27.1 steps/s
[Step= 150] | Loss=0.50343 | acc=0.8417 | tpr=0.9741 | fpr=0.1608 | 6666.9 samples/s | 26.0 steps/s
[Step= 200] | Loss=0.50406 | acc=0.8419 | tpr=0.9760 | fpr=0.1605 | 6858.3 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.50195 | acc=0.8416 | tpr=0.9721 | fpr=0.1608 | 7192.4 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.50566 | acc=0.8413 | tpr=0.9702 | fpr=0.1610 | 6510.5 samples/s | 25.4 steps/s
[Step= 350] | Loss=0.50631 | acc=0.8416 | tpr=0.9706 | fpr=0.1607 | 6779.7 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.50700 | acc=0.8413 | tpr=0.9721 | fpr=0.1611 | 6914.7 samples/s | 27.0 steps/s
[Step= 450] | Loss=0.51047 | acc=0.8410 | tpr=0.9713 | fpr=0.1614 | 6655.9 samples/s | 26.0 steps/s
[Step= 500] | Loss=0.51132 | acc=0.8406 | tpr=0.9718 | fpr=0.1617 | 6830.4 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.51073 | acc=0.8408 | tpr=0.9725 | fpr=0.1616 | 12396.2 samples/s | 48.4 steps/s
Avg test loss: 0.51073, Avg test acc: 0.84080, Avg tpr: 0.97266, Avg fpr: 0.16159, total FA: 22437

server round 22/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.8] | Loss=0.20906 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.783 | 3785.4 samples/s | 59.1 steps/s
[Step=17650 Epoch=86.1] | Loss=0.03121 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.678 | FP-Norm(final)=2.776 | 3508.9 samples/s | 54.8 steps/s
[Step=17700 Epoch=86.3] | Loss=0.02241 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.747 | FP-Norm(final)=2.775 | 3784.8 samples/s | 59.1 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01842 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.777 | FP-Norm(final)=2.777 | 3775.8 samples/s | 59.0 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01679 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.796 | FP-Norm(final)=2.779 | 4844.9 samples/s | 75.7 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01730 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.833 | FP-Norm(final)=2.780 | 1632.9 samples/s | 25.5 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01678 | Reg=0.00077 | acc=0.9688 | FP-Norm=0.867 | FP-Norm(final)=2.780 | 3791.2 samples/s | 59.2 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01556 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.885 | FP-Norm(final)=2.780 | 3725.2 samples/s | 58.2 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01456 | Reg=0.00082 | acc=0.9844 | FP-Norm=0.897 | FP-Norm(final)=2.780 | 4454.7 samples/s | 69.6 steps/s
[Step=18050 Epoch=88.0] | Loss=0.01354 | Reg=0.00084 | acc=0.9844 | FP-Norm=0.905 | FP-Norm(final)=2.781 | 1638.0 samples/s | 25.6 steps/s
[Step=18100 Epoch=88.3] | Loss=0.01278 | Reg=0.00084 | acc=0.9844 | FP-Norm=0.910 | FP-Norm(final)=2.782 | 3785.6 samples/s | 59.1 steps/s
[Step=18150 Epoch=88.5] | Loss=0.01211 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.914 | FP-Norm(final)=2.783 | 3772.1 samples/s | 58.9 steps/s
[Step=18200 Epoch=88.7] | Loss=0.01177 | Reg=0.00085 | acc=0.9844 | FP-Norm=0.917 | FP-Norm(final)=2.784 | 4310.3 samples/s | 67.3 steps/s
[Step=18250 Epoch=89.0] | Loss=0.01132 | Reg=0.00086 | acc=0.9844 | FP-Norm=0.920 | FP-Norm(final)=2.784 | 1676.1 samples/s | 26.2 steps/s
[Step=18300 Epoch=89.2] | Loss=0.01095 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.922 | FP-Norm(final)=2.785 | 3764.7 samples/s | 58.8 steps/s
[Step=18350 Epoch=89.5] | Loss=0.01049 | Reg=0.00086 | acc=0.9844 | FP-Norm=0.923 | FP-Norm(final)=2.786 | 3720.4 samples/s | 58.1 steps/s
[Step=18400 Epoch=89.7] | Loss=0.01007 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.923 | FP-Norm(final)=2.787 | 4039.9 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step18400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.9] | Loss=0.12338 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.783 | 3470.7 samples/s | 54.2 steps/s
[Step=17650 Epoch=86.1] | Loss=0.02044 | Reg=0.00040 | acc=0.9844 | FP-Norm=0.604 | FP-Norm(final)=2.784 | 3725.4 samples/s | 58.2 steps/s
[Step=17700 Epoch=86.4] | Loss=0.01705 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.674 | FP-Norm(final)=2.786 | 3716.5 samples/s | 58.1 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01543 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.709 | FP-Norm(final)=2.786 | 3800.5 samples/s | 59.4 steps/s
[Step=17800 Epoch=86.9] | Loss=0.01348 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.732 | FP-Norm(final)=2.788 | 4840.0 samples/s | 75.6 steps/s
[Step=17850 Epoch=87.1] | Loss=0.01184 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.746 | FP-Norm(final)=2.791 | 1615.0 samples/s | 25.2 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01050 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.752 | FP-Norm(final)=2.795 | 3760.9 samples/s | 58.8 steps/s
[Step=17950 Epoch=87.6] | Loss=0.00955 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.756 | FP-Norm(final)=2.798 | 3730.4 samples/s | 58.3 steps/s
[Step=18000 Epoch=87.8] | Loss=0.00933 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.759 | FP-Norm(final)=2.801 | 4649.2 samples/s | 72.6 steps/s
[Step=18050 Epoch=88.1] | Loss=0.00916 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.760 | FP-Norm(final)=2.803 | 1640.8 samples/s | 25.6 steps/s
[Step=18100 Epoch=88.3] | Loss=0.00858 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.761 | FP-Norm(final)=2.805 | 3731.3 samples/s | 58.3 steps/s
[Step=18150 Epoch=88.6] | Loss=0.00856 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.762 | FP-Norm(final)=2.806 | 3769.7 samples/s | 58.9 steps/s
[Step=18200 Epoch=88.8] | Loss=0.00831 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.763 | FP-Norm(final)=2.808 | 4376.3 samples/s | 68.4 steps/s
[Step=18250 Epoch=89.1] | Loss=0.00795 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.764 | FP-Norm(final)=2.809 | 1662.1 samples/s | 26.0 steps/s
[Step=18300 Epoch=89.3] | Loss=0.00778 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.810 | 3743.0 samples/s | 58.5 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00761 | Reg=0.00059 | acc=0.9688 | FP-Norm=0.765 | FP-Norm(final)=2.812 | 3762.2 samples/s | 58.8 steps/s
[Step=18400 Epoch=89.8] | Loss=0.00746 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.767 | FP-Norm(final)=2.813 | 4192.5 samples/s | 65.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step18400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.8] | Loss=0.16379 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.783 | 3840.3 samples/s | 60.0 steps/s
[Step=17650 Epoch=86.0] | Loss=0.02419 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=2.783 | 3526.4 samples/s | 55.1 steps/s
[Step=17700 Epoch=86.2] | Loss=0.01920 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.698 | FP-Norm(final)=2.782 | 3783.0 samples/s | 59.1 steps/s
[Step=17750 Epoch=86.5] | Loss=0.01823 | Reg=0.00057 | acc=0.9844 | FP-Norm=0.739 | FP-Norm(final)=2.782 | 3782.4 samples/s | 59.1 steps/s
[Step=17800 Epoch=86.7] | Loss=0.01660 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.782 | 4848.1 samples/s | 75.8 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01455 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.783 | 1598.8 samples/s | 25.0 steps/s
[Step=17900 Epoch=87.2] | Loss=0.01318 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.783 | FP-Norm(final)=2.786 | 3788.8 samples/s | 59.2 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01207 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.788 | 3812.9 samples/s | 59.6 steps/s
[Step=18000 Epoch=87.7] | Loss=0.01141 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.788 | FP-Norm(final)=2.791 | 4518.5 samples/s | 70.6 steps/s
[Step=18050 Epoch=87.9] | Loss=0.01097 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.791 | FP-Norm(final)=2.793 | 1666.0 samples/s | 26.0 steps/s
[Step=18100 Epoch=88.2] | Loss=0.01037 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.794 | FP-Norm(final)=2.795 | 3756.4 samples/s | 58.7 steps/s
[Step=18150 Epoch=88.4] | Loss=0.00984 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.795 | FP-Norm(final)=2.797 | 3761.1 samples/s | 58.8 steps/s
[Step=18200 Epoch=88.7] | Loss=0.00947 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.796 | FP-Norm(final)=2.799 | 4281.7 samples/s | 66.9 steps/s
[Step=18250 Epoch=88.9] | Loss=0.00914 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.797 | FP-Norm(final)=2.801 | 1682.1 samples/s | 26.3 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00867 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.797 | FP-Norm(final)=2.803 | 3758.3 samples/s | 58.7 steps/s
[Step=18350 Epoch=89.4] | Loss=0.00844 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.797 | FP-Norm(final)=2.805 | 3746.1 samples/s | 58.5 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00822 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.806 | 4067.6 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step18400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.8] | Loss=0.10815 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.783 | 3872.5 samples/s | 60.5 steps/s
[Step=17650 Epoch=86.1] | Loss=0.02494 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.656 | FP-Norm(final)=2.779 | 3427.2 samples/s | 53.5 steps/s
[Step=17700 Epoch=86.3] | Loss=0.02073 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.726 | FP-Norm(final)=2.778 | 3758.8 samples/s | 58.7 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01705 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.763 | FP-Norm(final)=2.778 | 3787.7 samples/s | 59.2 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01520 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.777 | FP-Norm(final)=2.780 | 4836.1 samples/s | 75.6 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01336 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.781 | FP-Norm(final)=2.783 | 1618.6 samples/s | 25.3 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01209 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.782 | FP-Norm(final)=2.785 | 3762.7 samples/s | 58.8 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01111 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.780 | FP-Norm(final)=2.788 | 3760.3 samples/s | 58.8 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01065 | Reg=0.00061 | acc=0.9844 | FP-Norm=0.778 | FP-Norm(final)=2.790 | 4516.9 samples/s | 70.6 steps/s
[Step=18050 Epoch=88.0] | Loss=0.00974 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.777 | FP-Norm(final)=2.792 | 1670.8 samples/s | 26.1 steps/s
[Step=18100 Epoch=88.3] | Loss=0.00915 | Reg=0.00061 | acc=0.9688 | FP-Norm=0.775 | FP-Norm(final)=2.794 | 3755.4 samples/s | 58.7 steps/s
[Step=18150 Epoch=88.5] | Loss=0.00881 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.797 | 3759.3 samples/s | 58.7 steps/s
[Step=18200 Epoch=88.8] | Loss=0.00857 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.773 | FP-Norm(final)=2.798 | 4266.6 samples/s | 66.7 steps/s
[Step=18250 Epoch=89.0] | Loss=0.00822 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.773 | FP-Norm(final)=2.800 | 1686.7 samples/s | 26.4 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00797 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.773 | FP-Norm(final)=2.802 | 3783.5 samples/s | 59.1 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00787 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.804 | 3737.4 samples/s | 58.4 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00752 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.805 | 4038.2 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step18400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=86.3] | Loss=0.19027 | Reg=0.00000 | acc=0.8281 | FP-Norm=0.000 | FP-Norm(final)=2.783 | 3834.4 samples/s | 59.9 steps/s
[Step=17650 Epoch=86.6] | Loss=0.03039 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.707 | FP-Norm(final)=2.775 | 3434.0 samples/s | 53.7 steps/s
[Step=17700 Epoch=86.8] | Loss=0.02133 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.775 | 3779.4 samples/s | 59.1 steps/s
[Step=17750 Epoch=87.0] | Loss=0.01914 | Reg=0.00064 | acc=0.9531 | FP-Norm=0.789 | FP-Norm(final)=2.775 | 3751.5 samples/s | 58.6 steps/s
[Step=17800 Epoch=87.3] | Loss=0.01702 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.803 | FP-Norm(final)=2.776 | 4897.0 samples/s | 76.5 steps/s
[Step=17850 Epoch=87.5] | Loss=0.01474 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.777 | 1601.5 samples/s | 25.0 steps/s
[Step=17900 Epoch=87.8] | Loss=0.01340 | Reg=0.00067 | acc=0.9688 | FP-Norm=0.812 | FP-Norm(final)=2.779 | 3759.9 samples/s | 58.7 steps/s
[Step=17950 Epoch=88.0] | Loss=0.01210 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.781 | 3739.3 samples/s | 58.4 steps/s
[Step=18000 Epoch=88.3] | Loss=0.01138 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.783 | 4694.0 samples/s | 73.3 steps/s
[Step=18050 Epoch=88.5] | Loss=0.01057 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.786 | 1639.3 samples/s | 25.6 steps/s
[Step=18100 Epoch=88.8] | Loss=0.00982 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.788 | 3765.5 samples/s | 58.8 steps/s
[Step=18150 Epoch=89.0] | Loss=0.00933 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.790 | 3781.0 samples/s | 59.1 steps/s
[Step=18200 Epoch=89.2] | Loss=0.00897 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.792 | 4511.3 samples/s | 70.5 steps/s
[Step=18250 Epoch=89.5] | Loss=0.00866 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.794 | 1636.5 samples/s | 25.6 steps/s
[Step=18300 Epoch=89.7] | Loss=0.00834 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.796 | 3763.7 samples/s | 58.8 steps/s
[Step=18350 Epoch=90.0] | Loss=0.00808 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.812 | FP-Norm(final)=2.797 | 3724.3 samples/s | 58.2 steps/s
[Step=18400 Epoch=90.2] | Loss=0.00785 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.811 | FP-Norm(final)=2.799 | 4328.2 samples/s | 67.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step18400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=166.8] | Loss=0.17544 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.783 | 3451.0 samples/s | 53.9 steps/s
[Step=17650 Epoch=167.2] | Loss=0.01009 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.959 | FP-Norm(final)=2.773 | 3397.6 samples/s | 53.1 steps/s
[Step=17700 Epoch=167.7] | Loss=0.00529 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.034 | FP-Norm(final)=2.772 | 4613.6 samples/s | 72.1 steps/s
[Step=17750 Epoch=168.2] | Loss=0.00356 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.033 | FP-Norm(final)=2.773 | 1540.0 samples/s | 24.1 steps/s
[Step=17800 Epoch=168.7] | Loss=0.00268 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.016 | FP-Norm(final)=2.774 | 4342.3 samples/s | 67.8 steps/s
[Step=17850 Epoch=169.1] | Loss=0.00215 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.997 | FP-Norm(final)=2.775 | 1573.8 samples/s | 24.6 steps/s
[Step=17900 Epoch=169.6] | Loss=0.00180 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.979 | FP-Norm(final)=2.775 | 3957.6 samples/s | 61.8 steps/s
[Step=17950 Epoch=170.1] | Loss=0.00155 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.962 | FP-Norm(final)=2.776 | 1613.5 samples/s | 25.2 steps/s
[Step=18000 Epoch=170.6] | Loss=0.00136 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.946 | FP-Norm(final)=2.777 | 3841.0 samples/s | 60.0 steps/s
[Step=18050 Epoch=171.0] | Loss=0.00121 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.931 | FP-Norm(final)=2.777 | 1648.7 samples/s | 25.8 steps/s
[Step=18100 Epoch=171.5] | Loss=0.00109 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.917 | FP-Norm(final)=2.778 | 3622.6 samples/s | 56.6 steps/s
[Step=18150 Epoch=172.0] | Loss=0.00100 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.904 | FP-Norm(final)=2.778 | 1687.6 samples/s | 26.4 steps/s
[Step=18200 Epoch=172.5] | Loss=0.00092 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.892 | FP-Norm(final)=2.779 | 3620.6 samples/s | 56.6 steps/s
[Step=18250 Epoch=172.9] | Loss=0.00085 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.880 | FP-Norm(final)=2.779 | 1699.2 samples/s | 26.6 steps/s
[Step=18300 Epoch=173.4] | Loss=0.00079 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.869 | FP-Norm(final)=2.779 | 3561.7 samples/s | 55.7 steps/s
[Step=18350 Epoch=173.9] | Loss=0.00074 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.859 | FP-Norm(final)=2.780 | 1749.8 samples/s | 27.3 steps/s
[Step=18400 Epoch=174.4] | Loss=0.00069 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.849 | FP-Norm(final)=2.780 | 3568.0 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step18400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=167.4] | Loss=0.03276 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.783 | 3531.5 samples/s | 55.2 steps/s
[Step=17650 Epoch=167.9] | Loss=0.00615 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.872 | FP-Norm(final)=2.779 | 3366.4 samples/s | 52.6 steps/s
[Step=17700 Epoch=168.4] | Loss=0.00341 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.936 | FP-Norm(final)=2.780 | 4617.5 samples/s | 72.1 steps/s
[Step=17750 Epoch=168.8] | Loss=0.00230 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.933 | FP-Norm(final)=2.781 | 1549.4 samples/s | 24.2 steps/s
[Step=17800 Epoch=169.3] | Loss=0.00174 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.916 | FP-Norm(final)=2.781 | 4300.6 samples/s | 67.2 steps/s
[Step=17850 Epoch=169.8] | Loss=0.00139 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.898 | FP-Norm(final)=2.782 | 1569.2 samples/s | 24.5 steps/s
[Step=17900 Epoch=170.3] | Loss=0.00117 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.881 | FP-Norm(final)=2.783 | 4069.7 samples/s | 63.6 steps/s
[Step=17950 Epoch=170.7] | Loss=0.00100 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.864 | FP-Norm(final)=2.783 | 1602.8 samples/s | 25.0 steps/s
[Step=18000 Epoch=171.2] | Loss=0.00088 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.848 | FP-Norm(final)=2.784 | 3825.5 samples/s | 59.8 steps/s
[Step=18050 Epoch=171.7] | Loss=0.00078 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.834 | FP-Norm(final)=2.784 | 1667.9 samples/s | 26.1 steps/s
[Step=18100 Epoch=172.2] | Loss=0.00071 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.784 | 3654.5 samples/s | 57.1 steps/s
[Step=18150 Epoch=172.7] | Loss=0.00065 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.785 | 1707.3 samples/s | 26.7 steps/s
[Step=18200 Epoch=173.1] | Loss=0.00059 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.795 | FP-Norm(final)=2.785 | 3517.3 samples/s | 55.0 steps/s
[Step=18250 Epoch=173.6] | Loss=0.00055 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.784 | FP-Norm(final)=2.786 | 1707.9 samples/s | 26.7 steps/s
[Step=18300 Epoch=174.1] | Loss=0.00051 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.773 | FP-Norm(final)=2.786 | 3594.6 samples/s | 56.2 steps/s
[Step=18350 Epoch=174.6] | Loss=0.00048 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.763 | FP-Norm(final)=2.786 | 1712.7 samples/s | 26.8 steps/s
[Step=18400 Epoch=175.0] | Loss=0.00045 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.753 | FP-Norm(final)=2.787 | 3543.9 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step18400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=168.1] | Loss=0.06777 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.783 | 3929.6 samples/s | 61.4 steps/s
[Step=17650 Epoch=168.5] | Loss=0.00617 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.784 | 3093.3 samples/s | 48.3 steps/s
[Step=17700 Epoch=169.0] | Loss=0.00320 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.854 | FP-Norm(final)=2.785 | 4654.7 samples/s | 72.7 steps/s
[Step=17750 Epoch=169.5] | Loss=0.00216 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.847 | FP-Norm(final)=2.786 | 1524.5 samples/s | 23.8 steps/s
[Step=17800 Epoch=170.0] | Loss=0.00163 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.787 | 4439.2 samples/s | 69.4 steps/s
[Step=17850 Epoch=170.5] | Loss=0.00132 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.788 | 1591.6 samples/s | 24.9 steps/s
[Step=17900 Epoch=170.9] | Loss=0.00110 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.796 | FP-Norm(final)=2.789 | 4169.8 samples/s | 65.2 steps/s
[Step=17950 Epoch=171.4] | Loss=0.00095 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.789 | 1614.3 samples/s | 25.2 steps/s
[Step=18000 Epoch=171.9] | Loss=0.00083 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.790 | 3996.7 samples/s | 62.4 steps/s
[Step=18050 Epoch=172.4] | Loss=0.00074 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.753 | FP-Norm(final)=2.790 | 1643.1 samples/s | 25.7 steps/s
[Step=18100 Epoch=172.8] | Loss=0.00067 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.741 | FP-Norm(final)=2.790 | 3804.4 samples/s | 59.4 steps/s
[Step=18150 Epoch=173.3] | Loss=0.00061 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.729 | FP-Norm(final)=2.791 | 1686.2 samples/s | 26.3 steps/s
[Step=18200 Epoch=173.8] | Loss=0.00056 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.719 | FP-Norm(final)=2.791 | 3602.1 samples/s | 56.3 steps/s
[Step=18250 Epoch=174.3] | Loss=0.00052 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.708 | FP-Norm(final)=2.791 | 1701.0 samples/s | 26.6 steps/s
[Step=18300 Epoch=174.8] | Loss=0.00049 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.699 | FP-Norm(final)=2.791 | 3574.0 samples/s | 55.8 steps/s
[Step=18350 Epoch=175.2] | Loss=0.00046 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.690 | FP-Norm(final)=2.792 | 1702.6 samples/s | 26.6 steps/s
[Step=18400 Epoch=175.7] | Loss=0.00043 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.681 | FP-Norm(final)=2.792 | 3564.2 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step18400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=165.9] | Loss=0.03302 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.783 | 3640.0 samples/s | 56.9 steps/s
[Step=17650 Epoch=166.3] | Loss=0.00656 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.742 | FP-Norm(final)=2.776 | 3371.3 samples/s | 52.7 steps/s
[Step=17700 Epoch=166.8] | Loss=0.00345 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.776 | 4578.3 samples/s | 71.5 steps/s
[Step=17750 Epoch=167.3] | Loss=0.00231 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.777 | 1541.0 samples/s | 24.1 steps/s
[Step=17800 Epoch=167.7] | Loss=0.00174 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.778 | 4274.2 samples/s | 66.8 steps/s
[Step=17850 Epoch=168.2] | Loss=0.00140 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.778 | 1596.4 samples/s | 24.9 steps/s
[Step=17900 Epoch=168.7] | Loss=0.00117 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.779 | 3928.0 samples/s | 61.4 steps/s
[Step=17950 Epoch=169.1] | Loss=0.00101 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.780 | 1625.1 samples/s | 25.4 steps/s
[Step=18000 Epoch=169.6] | Loss=0.00088 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.754 | FP-Norm(final)=2.780 | 3647.4 samples/s | 57.0 steps/s
[Step=18050 Epoch=170.1] | Loss=0.00079 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.743 | FP-Norm(final)=2.781 | 1676.0 samples/s | 26.2 steps/s
[Step=18100 Epoch=170.6] | Loss=0.00071 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.732 | FP-Norm(final)=2.781 | 3580.4 samples/s | 55.9 steps/s
[Step=18150 Epoch=171.0] | Loss=0.00065 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.722 | FP-Norm(final)=2.782 | 1711.6 samples/s | 26.7 steps/s
[Step=18200 Epoch=171.5] | Loss=0.00060 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.712 | FP-Norm(final)=2.782 | 3556.4 samples/s | 55.6 steps/s
[Step=18250 Epoch=172.0] | Loss=0.00055 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.703 | FP-Norm(final)=2.782 | 1725.3 samples/s | 27.0 steps/s
[Step=18300 Epoch=172.4] | Loss=0.00051 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.694 | FP-Norm(final)=2.783 | 3519.7 samples/s | 55.0 steps/s
[Step=18350 Epoch=172.9] | Loss=0.00048 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.783 | 1777.2 samples/s | 27.8 steps/s
[Step=18400 Epoch=173.4] | Loss=0.00045 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.678 | FP-Norm(final)=2.784 | 3279.3 samples/s | 51.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step18400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=167.8] | Loss=0.01987 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.783 | 3647.6 samples/s | 57.0 steps/s
[Step=17650 Epoch=168.2] | Loss=0.00769 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.828 | FP-Norm(final)=2.778 | 3241.9 samples/s | 50.7 steps/s
[Step=17700 Epoch=168.7] | Loss=0.00398 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.901 | FP-Norm(final)=2.777 | 4698.9 samples/s | 73.4 steps/s
[Step=17750 Epoch=169.2] | Loss=0.00267 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.896 | FP-Norm(final)=2.778 | 1545.9 samples/s | 24.2 steps/s
[Step=17800 Epoch=169.7] | Loss=0.00202 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.881 | FP-Norm(final)=2.778 | 4383.5 samples/s | 68.5 steps/s
[Step=17850 Epoch=170.1] | Loss=0.00162 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.864 | FP-Norm(final)=2.779 | 1573.5 samples/s | 24.6 steps/s
[Step=17900 Epoch=170.6] | Loss=0.00136 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.848 | FP-Norm(final)=2.780 | 4163.6 samples/s | 65.1 steps/s
[Step=17950 Epoch=171.1] | Loss=0.00117 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.833 | FP-Norm(final)=2.780 | 1610.4 samples/s | 25.2 steps/s
[Step=18000 Epoch=171.6] | Loss=0.00103 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.819 | FP-Norm(final)=2.781 | 3972.2 samples/s | 62.1 steps/s
[Step=18050 Epoch=172.0] | Loss=0.00091 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.805 | FP-Norm(final)=2.781 | 1639.1 samples/s | 25.6 steps/s
[Step=18100 Epoch=172.5] | Loss=0.00083 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.782 | 3753.3 samples/s | 58.6 steps/s
[Step=18150 Epoch=173.0] | Loss=0.00075 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.781 | FP-Norm(final)=2.782 | 1627.9 samples/s | 25.4 steps/s
[Step=18200 Epoch=173.5] | Loss=0.00069 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.782 | 3493.5 samples/s | 54.6 steps/s
[Step=18250 Epoch=173.9] | Loss=0.00064 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.760 | FP-Norm(final)=2.783 | 1704.9 samples/s | 26.6 steps/s
[Step=18300 Epoch=174.4] | Loss=0.00060 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.750 | FP-Norm(final)=2.783 | 3572.1 samples/s | 55.8 steps/s
[Step=18350 Epoch=174.9] | Loss=0.00056 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.741 | FP-Norm(final)=2.784 | 1715.0 samples/s | 26.8 steps/s
[Step=18400 Epoch=175.4] | Loss=0.00052 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.732 | FP-Norm(final)=2.784 | 3593.5 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20540 | acc=0.8751 | tpr=0.8258 | fpr=0.0178 | 3611.1 samples/s | 14.1 steps/s
Avg test loss: 0.20712, Avg test acc: 0.87459, Avg tpr: 0.82660, Avg fpr: 0.01987, total FA: 155

Testing server on iccad2012
[Step=  50] | Loss=0.54724 | acc=0.8229 | tpr=0.9735 | fpr=0.1798 | 3625.4 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.56538 | acc=0.8214 | tpr=0.9765 | fpr=0.1815 | 6882.6 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.57470 | acc=0.8193 | tpr=0.9726 | fpr=0.1835 | 6753.2 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.57506 | acc=0.8197 | tpr=0.9749 | fpr=0.1832 | 6817.4 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.57290 | acc=0.8194 | tpr=0.9712 | fpr=0.1833 | 6983.0 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.57704 | acc=0.8188 | tpr=0.9687 | fpr=0.1839 | 6722.3 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.57730 | acc=0.8191 | tpr=0.9693 | fpr=0.1836 | 6531.3 samples/s | 25.5 steps/s
[Step= 400] | Loss=0.57774 | acc=0.8189 | tpr=0.9710 | fpr=0.1839 | 7022.8 samples/s | 27.4 steps/s
[Step= 450] | Loss=0.58137 | acc=0.8188 | tpr=0.9703 | fpr=0.1840 | 6450.9 samples/s | 25.2 steps/s
[Step= 500] | Loss=0.58245 | acc=0.8185 | tpr=0.9714 | fpr=0.1843 | 6888.3 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.58185 | acc=0.8185 | tpr=0.9721 | fpr=0.1843 | 12313.8 samples/s | 48.1 steps/s
Avg test loss: 0.58185, Avg test acc: 0.81855, Avg tpr: 0.97227, Avg fpr: 0.18424, total FA: 25582

server round 23/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.7] | Loss=0.10968 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.807 | 3643.3 samples/s | 56.9 steps/s
[Step=18450 Epoch=90.0] | Loss=0.02763 | Reg=0.00043 | acc=0.9844 | FP-Norm=0.626 | FP-Norm(final)=2.799 | 3706.0 samples/s | 57.9 steps/s
[Step=18500 Epoch=90.2] | Loss=0.02040 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.685 | FP-Norm(final)=2.797 | 3752.8 samples/s | 58.6 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01675 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.703 | FP-Norm(final)=2.799 | 3764.8 samples/s | 58.8 steps/s
[Step=18600 Epoch=90.7] | Loss=0.01590 | Reg=0.00053 | acc=0.9844 | FP-Norm=0.716 | FP-Norm(final)=2.802 | 4846.2 samples/s | 75.7 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01373 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.724 | FP-Norm(final)=2.804 | 1606.4 samples/s | 25.1 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01246 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.726 | FP-Norm(final)=2.806 | 3732.8 samples/s | 58.3 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01140 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.727 | FP-Norm(final)=2.809 | 3775.3 samples/s | 59.0 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01071 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.727 | FP-Norm(final)=2.811 | 4478.1 samples/s | 70.0 steps/s
[Step=18850 Epoch=91.9] | Loss=0.00997 | Reg=0.00053 | acc=0.9844 | FP-Norm=0.727 | FP-Norm(final)=2.813 | 1637.4 samples/s | 25.6 steps/s
[Step=18900 Epoch=92.2] | Loss=0.00959 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.726 | FP-Norm(final)=2.815 | 3768.4 samples/s | 58.9 steps/s
[Step=18950 Epoch=92.4] | Loss=0.00934 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.727 | FP-Norm(final)=2.817 | 3772.4 samples/s | 58.9 steps/s
[Step=19000 Epoch=92.6] | Loss=0.00884 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.727 | FP-Norm(final)=2.819 | 4295.3 samples/s | 67.1 steps/s
[Step=19050 Epoch=92.9] | Loss=0.00839 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.727 | FP-Norm(final)=2.820 | 1693.0 samples/s | 26.5 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00809 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.728 | FP-Norm(final)=2.822 | 3751.9 samples/s | 58.6 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00799 | Reg=0.00053 | acc=0.9844 | FP-Norm=0.728 | FP-Norm(final)=2.823 | 3770.4 samples/s | 58.9 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00788 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.730 | FP-Norm(final)=2.824 | 4075.6 samples/s | 63.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step19200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.8] | Loss=0.11513 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.806 | 3541.0 samples/s | 55.3 steps/s
[Step=18450 Epoch=90.0] | Loss=0.02787 | Reg=0.00057 | acc=0.9688 | FP-Norm=0.717 | FP-Norm(final)=2.799 | 3624.3 samples/s | 56.6 steps/s
[Step=18500 Epoch=90.3] | Loss=0.02127 | Reg=0.00066 | acc=0.9688 | FP-Norm=0.792 | FP-Norm(final)=2.795 | 3777.4 samples/s | 59.0 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01785 | Reg=0.00068 | acc=0.9844 | FP-Norm=0.810 | FP-Norm(final)=2.794 | 3762.2 samples/s | 58.8 steps/s
[Step=18600 Epoch=90.8] | Loss=0.01644 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.795 | 4854.7 samples/s | 75.9 steps/s
[Step=18650 Epoch=91.0] | Loss=0.01463 | Reg=0.00070 | acc=0.9844 | FP-Norm=0.829 | FP-Norm(final)=2.796 | 1618.0 samples/s | 25.3 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01329 | Reg=0.00070 | acc=0.9688 | FP-Norm=0.829 | FP-Norm(final)=2.798 | 3741.0 samples/s | 58.5 steps/s
[Step=18750 Epoch=91.5] | Loss=0.01200 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.828 | FP-Norm(final)=2.800 | 3746.5 samples/s | 58.5 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01109 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.803 | 4589.5 samples/s | 71.7 steps/s
[Step=18850 Epoch=92.0] | Loss=0.01050 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.823 | FP-Norm(final)=2.805 | 1652.5 samples/s | 25.8 steps/s
[Step=18900 Epoch=92.2] | Loss=0.00985 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.807 | 3774.6 samples/s | 59.0 steps/s
[Step=18950 Epoch=92.5] | Loss=0.00955 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.817 | FP-Norm(final)=2.809 | 3795.3 samples/s | 59.3 steps/s
[Step=19000 Epoch=92.7] | Loss=0.00916 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.811 | 4376.4 samples/s | 68.4 steps/s
[Step=19050 Epoch=93.0] | Loss=0.00877 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.812 | 1675.1 samples/s | 26.2 steps/s
[Step=19100 Epoch=93.2] | Loss=0.00845 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.811 | FP-Norm(final)=2.814 | 3784.2 samples/s | 59.1 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00808 | Reg=0.00066 | acc=0.9688 | FP-Norm=0.809 | FP-Norm(final)=2.816 | 3774.7 samples/s | 59.0 steps/s
[Step=19200 Epoch=93.7] | Loss=0.00789 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.817 | 4161.9 samples/s | 65.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step19200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.7] | Loss=0.13642 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.806 | 3586.7 samples/s | 56.0 steps/s
[Step=18450 Epoch=89.9] | Loss=0.02582 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.615 | FP-Norm(final)=2.799 | 3709.6 samples/s | 58.0 steps/s
[Step=18500 Epoch=90.1] | Loss=0.02024 | Reg=0.00049 | acc=0.9844 | FP-Norm=0.684 | FP-Norm(final)=2.798 | 3774.7 samples/s | 59.0 steps/s
[Step=18550 Epoch=90.4] | Loss=0.01881 | Reg=0.00053 | acc=0.9844 | FP-Norm=0.719 | FP-Norm(final)=2.797 | 3776.6 samples/s | 59.0 steps/s
[Step=18600 Epoch=90.6] | Loss=0.01701 | Reg=0.00056 | acc=0.9688 | FP-Norm=0.740 | FP-Norm(final)=2.797 | 4837.3 samples/s | 75.6 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01483 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.751 | FP-Norm(final)=2.799 | 1612.7 samples/s | 25.2 steps/s
[Step=18700 Epoch=91.1] | Loss=0.01340 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.754 | FP-Norm(final)=2.802 | 3767.0 samples/s | 58.9 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01272 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.759 | FP-Norm(final)=2.804 | 3727.4 samples/s | 58.2 steps/s
[Step=18800 Epoch=91.6] | Loss=0.01166 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.806 | 4519.1 samples/s | 70.6 steps/s
[Step=18850 Epoch=91.8] | Loss=0.01082 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.763 | FP-Norm(final)=2.809 | 1655.9 samples/s | 25.9 steps/s
[Step=18900 Epoch=92.1] | Loss=0.01028 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.763 | FP-Norm(final)=2.811 | 3782.9 samples/s | 59.1 steps/s
[Step=18950 Epoch=92.3] | Loss=0.01003 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.764 | FP-Norm(final)=2.813 | 3760.2 samples/s | 58.8 steps/s
[Step=19000 Epoch=92.6] | Loss=0.00966 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.815 | 4278.4 samples/s | 66.9 steps/s
[Step=19050 Epoch=92.8] | Loss=0.00915 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.816 | 1711.3 samples/s | 26.7 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00879 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.764 | FP-Norm(final)=2.818 | 3720.8 samples/s | 58.1 steps/s
[Step=19150 Epoch=93.3] | Loss=0.00846 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.765 | FP-Norm(final)=2.820 | 3774.8 samples/s | 59.0 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00828 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.764 | FP-Norm(final)=2.821 | 4046.0 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step19200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.7] | Loss=0.08866 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.807 | 3541.4 samples/s | 55.3 steps/s
[Step=18450 Epoch=90.0] | Loss=0.02246 | Reg=0.00042 | acc=0.9688 | FP-Norm=0.617 | FP-Norm(final)=2.807 | 3788.4 samples/s | 59.2 steps/s
[Step=18500 Epoch=90.2] | Loss=0.01869 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.702 | FP-Norm(final)=2.805 | 3726.8 samples/s | 58.2 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01573 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.739 | FP-Norm(final)=2.805 | 3803.9 samples/s | 59.4 steps/s
[Step=18600 Epoch=90.7] | Loss=0.01417 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.760 | FP-Norm(final)=2.806 | 4805.5 samples/s | 75.1 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01287 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.808 | 1614.0 samples/s | 25.2 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01160 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.810 | 3772.1 samples/s | 58.9 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01074 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.784 | FP-Norm(final)=2.812 | 3764.5 samples/s | 58.8 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01039 | Reg=0.00063 | acc=0.9844 | FP-Norm=0.787 | FP-Norm(final)=2.814 | 4521.9 samples/s | 70.7 steps/s
[Step=18850 Epoch=91.9] | Loss=0.00968 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.790 | FP-Norm(final)=2.816 | 1653.5 samples/s | 25.8 steps/s
[Step=18900 Epoch=92.2] | Loss=0.00931 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.791 | FP-Norm(final)=2.818 | 3754.7 samples/s | 58.7 steps/s
[Step=18950 Epoch=92.4] | Loss=0.00898 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.792 | FP-Norm(final)=2.819 | 3774.1 samples/s | 59.0 steps/s
[Step=19000 Epoch=92.7] | Loss=0.00870 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.820 | 4300.0 samples/s | 67.2 steps/s
[Step=19050 Epoch=92.9] | Loss=0.00845 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.821 | 1706.7 samples/s | 26.7 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00810 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.822 | 3770.1 samples/s | 58.9 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00781 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.824 | 3737.4 samples/s | 58.4 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00750 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.825 | 4050.2 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step19200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=90.2] | Loss=0.14602 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.806 | 3612.7 samples/s | 56.4 steps/s
[Step=18450 Epoch=90.5] | Loss=0.02687 | Reg=0.00049 | acc=0.9688 | FP-Norm=0.667 | FP-Norm(final)=2.804 | 3669.6 samples/s | 57.3 steps/s
[Step=18500 Epoch=90.7] | Loss=0.02056 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.751 | FP-Norm(final)=2.800 | 3740.5 samples/s | 58.4 steps/s
[Step=18550 Epoch=91.0] | Loss=0.01866 | Reg=0.00063 | acc=0.9531 | FP-Norm=0.779 | FP-Norm(final)=2.800 | 3782.2 samples/s | 59.1 steps/s
[Step=18600 Epoch=91.2] | Loss=0.01662 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.796 | FP-Norm(final)=2.800 | 4861.5 samples/s | 76.0 steps/s
[Step=18650 Epoch=91.5] | Loss=0.01488 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.802 | 1608.8 samples/s | 25.1 steps/s
[Step=18700 Epoch=91.7] | Loss=0.01318 | Reg=0.00068 | acc=0.9844 | FP-Norm=0.816 | FP-Norm(final)=2.804 | 3769.6 samples/s | 58.9 steps/s
[Step=18750 Epoch=91.9] | Loss=0.01219 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.806 | 3774.7 samples/s | 59.0 steps/s
[Step=18800 Epoch=92.2] | Loss=0.01133 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.819 | FP-Norm(final)=2.807 | 4631.7 samples/s | 72.4 steps/s
[Step=18850 Epoch=92.4] | Loss=0.01052 | Reg=0.00068 | acc=0.9844 | FP-Norm=0.820 | FP-Norm(final)=2.809 | 1632.5 samples/s | 25.5 steps/s
[Step=18900 Epoch=92.7] | Loss=0.00982 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.811 | 3772.7 samples/s | 58.9 steps/s
[Step=18950 Epoch=92.9] | Loss=0.00923 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.817 | FP-Norm(final)=2.813 | 3767.9 samples/s | 58.9 steps/s
[Step=19000 Epoch=93.2] | Loss=0.00893 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.815 | 4536.3 samples/s | 70.9 steps/s
[Step=19050 Epoch=93.4] | Loss=0.00865 | Reg=0.00067 | acc=0.9844 | FP-Norm=0.816 | FP-Norm(final)=2.817 | 1659.9 samples/s | 25.9 steps/s
[Step=19100 Epoch=93.7] | Loss=0.00829 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.818 | 3777.0 samples/s | 59.0 steps/s
[Step=19150 Epoch=93.9] | Loss=0.00806 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.820 | 3776.8 samples/s | 59.0 steps/s
[Step=19200 Epoch=94.2] | Loss=0.00786 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.822 | 4321.5 samples/s | 67.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step19200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=174.4] | Loss=0.08207 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.807 | 3552.9 samples/s | 55.5 steps/s
[Step=18450 Epoch=174.8] | Loss=0.01190 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.051 | FP-Norm(final)=2.801 | 3335.8 samples/s | 52.1 steps/s
[Step=18500 Epoch=175.3] | Loss=0.00659 | Reg=0.00135 | acc=1.0000 | FP-Norm=1.135 | FP-Norm(final)=2.796 | 4598.6 samples/s | 71.9 steps/s
[Step=18550 Epoch=175.8] | Loss=0.00470 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.137 | FP-Norm(final)=2.794 | 1565.3 samples/s | 24.5 steps/s
[Step=18600 Epoch=176.3] | Loss=0.00356 | Reg=0.00129 | acc=1.0000 | FP-Norm=1.121 | FP-Norm(final)=2.794 | 4360.3 samples/s | 68.1 steps/s
[Step=18650 Epoch=176.7] | Loss=0.00286 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.103 | FP-Norm(final)=2.794 | 1588.4 samples/s | 24.8 steps/s
[Step=18700 Epoch=177.2] | Loss=0.00239 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.083 | FP-Norm(final)=2.794 | 4079.8 samples/s | 63.7 steps/s
[Step=18750 Epoch=177.7] | Loss=0.00205 | Reg=0.00116 | acc=1.0000 | FP-Norm=1.064 | FP-Norm(final)=2.794 | 1609.5 samples/s | 25.1 steps/s
[Step=18800 Epoch=178.1] | Loss=0.00180 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.047 | FP-Norm(final)=2.795 | 3778.7 samples/s | 59.0 steps/s
[Step=18850 Epoch=178.6] | Loss=0.00160 | Reg=0.00108 | acc=1.0000 | FP-Norm=1.030 | FP-Norm(final)=2.795 | 1644.1 samples/s | 25.7 steps/s
[Step=18900 Epoch=179.1] | Loss=0.00144 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.015 | FP-Norm(final)=2.796 | 3663.2 samples/s | 57.2 steps/s
[Step=18950 Epoch=179.6] | Loss=0.00132 | Reg=0.00102 | acc=1.0000 | FP-Norm=1.000 | FP-Norm(final)=2.796 | 1707.7 samples/s | 26.7 steps/s
[Step=19000 Epoch=180.0] | Loss=0.00121 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.986 | FP-Norm(final)=2.796 | 3527.3 samples/s | 55.1 steps/s
[Step=19050 Epoch=180.5] | Loss=0.00112 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.973 | FP-Norm(final)=2.797 | 1726.1 samples/s | 27.0 steps/s
[Step=19100 Epoch=181.0] | Loss=0.00104 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.961 | FP-Norm(final)=2.797 | 3515.9 samples/s | 54.9 steps/s
[Step=19150 Epoch=181.5] | Loss=0.00097 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.949 | FP-Norm(final)=2.797 | 1716.2 samples/s | 26.8 steps/s
[Step=19200 Epoch=181.9] | Loss=0.00091 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.938 | FP-Norm(final)=2.798 | 3548.5 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step19200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=175.0] | Loss=0.13131 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.806 | 3801.9 samples/s | 59.4 steps/s
[Step=18450 Epoch=175.5] | Loss=0.00714 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.936 | FP-Norm(final)=2.798 | 3373.2 samples/s | 52.7 steps/s
[Step=18500 Epoch=176.0] | Loss=0.00366 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.985 | FP-Norm(final)=2.799 | 4712.7 samples/s | 73.6 steps/s
[Step=18550 Epoch=176.5] | Loss=0.00245 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.970 | FP-Norm(final)=2.800 | 1523.2 samples/s | 23.8 steps/s
[Step=18600 Epoch=176.9] | Loss=0.00185 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.948 | FP-Norm(final)=2.801 | 4349.5 samples/s | 68.0 steps/s
[Step=18650 Epoch=177.4] | Loss=0.00148 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.926 | FP-Norm(final)=2.801 | 1580.1 samples/s | 24.7 steps/s
[Step=18700 Epoch=177.9] | Loss=0.00124 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.906 | FP-Norm(final)=2.802 | 4040.0 samples/s | 63.1 steps/s
[Step=18750 Epoch=178.4] | Loss=0.00107 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.888 | FP-Norm(final)=2.802 | 1603.7 samples/s | 25.1 steps/s
[Step=18800 Epoch=178.8] | Loss=0.00094 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.872 | FP-Norm(final)=2.803 | 3876.9 samples/s | 60.6 steps/s
[Step=18850 Epoch=179.3] | Loss=0.00083 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.857 | FP-Norm(final)=2.803 | 1676.4 samples/s | 26.2 steps/s
[Step=18900 Epoch=179.8] | Loss=0.00075 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.843 | FP-Norm(final)=2.803 | 3695.4 samples/s | 57.7 steps/s
[Step=18950 Epoch=180.3] | Loss=0.00069 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.830 | FP-Norm(final)=2.804 | 1703.3 samples/s | 26.6 steps/s
[Step=19000 Epoch=180.7] | Loss=0.00063 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.817 | FP-Norm(final)=2.804 | 3594.7 samples/s | 56.2 steps/s
[Step=19050 Epoch=181.2] | Loss=0.00058 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.806 | FP-Norm(final)=2.805 | 1722.8 samples/s | 26.9 steps/s
[Step=19100 Epoch=181.7] | Loss=0.00054 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.795 | FP-Norm(final)=2.805 | 3551.9 samples/s | 55.5 steps/s
[Step=19150 Epoch=182.2] | Loss=0.00051 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.784 | FP-Norm(final)=2.805 | 1727.8 samples/s | 27.0 steps/s
[Step=19200 Epoch=182.6] | Loss=0.00048 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.806 | 3525.0 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step19200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=175.7] | Loss=0.15079 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.805 | 3520.0 samples/s | 55.0 steps/s
[Step=18450 Epoch=176.2] | Loss=0.00863 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.927 | FP-Norm(final)=2.795 | 3364.9 samples/s | 52.6 steps/s
[Step=18500 Epoch=176.7] | Loss=0.00462 | Reg=0.00104 | acc=1.0000 | FP-Norm=0.995 | FP-Norm(final)=2.795 | 4685.4 samples/s | 73.2 steps/s
[Step=18550 Epoch=177.1] | Loss=0.00311 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.995 | FP-Norm(final)=2.795 | 1536.7 samples/s | 24.0 steps/s
[Step=18600 Epoch=177.6] | Loss=0.00234 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.980 | FP-Norm(final)=2.795 | 4425.4 samples/s | 69.1 steps/s
[Step=18650 Epoch=178.1] | Loss=0.00188 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.962 | FP-Norm(final)=2.796 | 1575.3 samples/s | 24.6 steps/s
[Step=18700 Epoch=178.6] | Loss=0.00157 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.944 | FP-Norm(final)=2.796 | 4173.7 samples/s | 65.2 steps/s
[Step=18750 Epoch=179.1] | Loss=0.00135 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.927 | FP-Norm(final)=2.796 | 1599.0 samples/s | 25.0 steps/s
[Step=18800 Epoch=179.5] | Loss=0.00118 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.911 | FP-Norm(final)=2.797 | 3945.9 samples/s | 61.7 steps/s
[Step=18850 Epoch=180.0] | Loss=0.00105 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.896 | FP-Norm(final)=2.797 | 1633.7 samples/s | 25.5 steps/s
[Step=18900 Epoch=180.5] | Loss=0.00095 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.882 | FP-Norm(final)=2.797 | 3804.9 samples/s | 59.5 steps/s
[Step=18950 Epoch=181.0] | Loss=0.00086 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.869 | FP-Norm(final)=2.798 | 1663.5 samples/s | 26.0 steps/s
[Step=19000 Epoch=181.4] | Loss=0.00079 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.856 | FP-Norm(final)=2.798 | 3616.2 samples/s | 56.5 steps/s
[Step=19050 Epoch=181.9] | Loss=0.00073 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.845 | FP-Norm(final)=2.798 | 1646.4 samples/s | 25.7 steps/s
[Step=19100 Epoch=182.4] | Loss=0.00068 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.833 | FP-Norm(final)=2.799 | 3522.3 samples/s | 55.0 steps/s
[Step=19150 Epoch=182.9] | Loss=0.00064 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.823 | FP-Norm(final)=2.799 | 1693.9 samples/s | 26.5 steps/s
[Step=19200 Epoch=183.3] | Loss=0.00060 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.799 | 3615.3 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step19200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=173.4] | Loss=0.11019 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.806 | 3917.4 samples/s | 61.2 steps/s
[Step=18450 Epoch=173.9] | Loss=0.00387 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.806 | 3088.7 samples/s | 48.3 steps/s
[Step=18500 Epoch=174.3] | Loss=0.00199 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.913 | FP-Norm(final)=2.807 | 4553.1 samples/s | 71.1 steps/s
[Step=18550 Epoch=174.8] | Loss=0.00134 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.897 | FP-Norm(final)=2.808 | 1543.0 samples/s | 24.1 steps/s
[Step=18600 Epoch=175.3] | Loss=0.00101 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.875 | FP-Norm(final)=2.808 | 4255.1 samples/s | 66.5 steps/s
[Step=18650 Epoch=175.7] | Loss=0.00081 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.853 | FP-Norm(final)=2.809 | 1596.5 samples/s | 24.9 steps/s
[Step=18700 Epoch=176.2] | Loss=0.00068 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.833 | FP-Norm(final)=2.809 | 3924.4 samples/s | 61.3 steps/s
[Step=18750 Epoch=176.7] | Loss=0.00059 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.809 | 1622.8 samples/s | 25.4 steps/s
[Step=18800 Epoch=177.1] | Loss=0.00051 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.810 | 3711.4 samples/s | 58.0 steps/s
[Step=18850 Epoch=177.6] | Loss=0.00046 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.783 | FP-Norm(final)=2.810 | 1657.0 samples/s | 25.9 steps/s
[Step=18900 Epoch=178.1] | Loss=0.00041 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.769 | FP-Norm(final)=2.810 | 3597.4 samples/s | 56.2 steps/s
[Step=18950 Epoch=178.6] | Loss=0.00038 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.756 | FP-Norm(final)=2.810 | 1703.6 samples/s | 26.6 steps/s
[Step=19000 Epoch=179.0] | Loss=0.00035 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.743 | FP-Norm(final)=2.810 | 3574.3 samples/s | 55.8 steps/s
[Step=19050 Epoch=179.5] | Loss=0.00032 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.732 | FP-Norm(final)=2.811 | 1704.7 samples/s | 26.6 steps/s
[Step=19100 Epoch=180.0] | Loss=0.00030 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.721 | FP-Norm(final)=2.811 | 3601.9 samples/s | 56.3 steps/s
[Step=19150 Epoch=180.4] | Loss=0.00028 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.710 | FP-Norm(final)=2.811 | 1833.9 samples/s | 28.7 steps/s
[Step=19200 Epoch=180.9] | Loss=0.00026 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.700 | FP-Norm(final)=2.811 | 3175.8 samples/s | 49.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step19200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=175.4] | Loss=0.07193 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.806 | 3629.7 samples/s | 56.7 steps/s
[Step=18450 Epoch=175.8] | Loss=0.00724 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.960 | FP-Norm(final)=2.803 | 3236.2 samples/s | 50.6 steps/s
[Step=18500 Epoch=176.3] | Loss=0.00385 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.012 | FP-Norm(final)=2.804 | 4617.4 samples/s | 72.1 steps/s
[Step=18550 Epoch=176.8] | Loss=0.00259 | Reg=0.00103 | acc=1.0000 | FP-Norm=0.999 | FP-Norm(final)=2.805 | 1542.2 samples/s | 24.1 steps/s
[Step=18600 Epoch=177.3] | Loss=0.00195 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.978 | FP-Norm(final)=2.806 | 4429.6 samples/s | 69.2 steps/s
[Step=18650 Epoch=177.8] | Loss=0.00157 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.956 | FP-Norm(final)=2.807 | 1569.2 samples/s | 24.5 steps/s
[Step=18700 Epoch=178.2] | Loss=0.00131 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.935 | FP-Norm(final)=2.807 | 4055.0 samples/s | 63.4 steps/s
[Step=18750 Epoch=178.7] | Loss=0.00113 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.916 | FP-Norm(final)=2.808 | 1587.0 samples/s | 24.8 steps/s
[Step=18800 Epoch=179.2] | Loss=0.00099 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.899 | FP-Norm(final)=2.808 | 3945.1 samples/s | 61.6 steps/s
[Step=18850 Epoch=179.7] | Loss=0.00088 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.882 | FP-Norm(final)=2.809 | 1626.1 samples/s | 25.4 steps/s
[Step=18900 Epoch=180.1] | Loss=0.00080 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.867 | FP-Norm(final)=2.809 | 3758.6 samples/s | 58.7 steps/s
[Step=18950 Epoch=180.6] | Loss=0.00073 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.853 | FP-Norm(final)=2.809 | 1665.2 samples/s | 26.0 steps/s
[Step=19000 Epoch=181.1] | Loss=0.00067 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.840 | FP-Norm(final)=2.810 | 3661.0 samples/s | 57.2 steps/s
[Step=19050 Epoch=181.6] | Loss=0.00062 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.828 | FP-Norm(final)=2.810 | 1697.0 samples/s | 26.5 steps/s
[Step=19100 Epoch=182.0] | Loss=0.00058 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.810 | 3584.1 samples/s | 56.0 steps/s
[Step=19150 Epoch=182.5] | Loss=0.00054 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.805 | FP-Norm(final)=2.810 | 1685.0 samples/s | 26.3 steps/s
[Step=19200 Epoch=183.0] | Loss=0.00051 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.794 | FP-Norm(final)=2.811 | 3576.6 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21683 | acc=0.8697 | tpr=0.8185 | fpr=0.0191 | 3615.1 samples/s | 14.1 steps/s
Avg test loss: 0.21879, Avg test acc: 0.86962, Avg tpr: 0.81972, Avg fpr: 0.02064, total FA: 161

Testing server on iccad2012
[Step=  50] | Loss=0.52498 | acc=0.8394 | tpr=0.9735 | fpr=0.1630 | 3587.9 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.54445 | acc=0.8368 | tpr=0.9765 | fpr=0.1658 | 6767.3 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.55373 | acc=0.8339 | tpr=0.9726 | fpr=0.1687 | 6874.3 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.55422 | acc=0.8337 | tpr=0.9749 | fpr=0.1689 | 7080.1 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.55216 | acc=0.8334 | tpr=0.9712 | fpr=0.1691 | 6649.0 samples/s | 26.0 steps/s
[Step= 300] | Loss=0.55629 | acc=0.8332 | tpr=0.9695 | fpr=0.1692 | 6909.5 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.55647 | acc=0.8335 | tpr=0.9699 | fpr=0.1690 | 6584.4 samples/s | 25.7 steps/s
[Step= 400] | Loss=0.55727 | acc=0.8330 | tpr=0.9710 | fpr=0.1695 | 6857.2 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.56099 | acc=0.8328 | tpr=0.9713 | fpr=0.1697 | 6808.1 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.56199 | acc=0.8324 | tpr=0.9718 | fpr=0.1701 | 6607.9 samples/s | 25.8 steps/s
[Step= 550] | Loss=0.56127 | acc=0.8327 | tpr=0.9717 | fpr=0.1699 | 12590.5 samples/s | 49.2 steps/s
Avg test loss: 0.56124, Avg test acc: 0.83269, Avg tpr: 0.97187, Avg fpr: 0.16984, total FA: 23582

server round 24/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.6] | Loss=0.08567 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.826 | 3501.1 samples/s | 54.7 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02013 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=2.826 | 3781.0 samples/s | 59.1 steps/s
[Step=19300 Epoch=94.1] | Loss=0.01749 | Reg=0.00047 | acc=0.9844 | FP-Norm=0.666 | FP-Norm(final)=2.826 | 3741.4 samples/s | 58.5 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01606 | Reg=0.00053 | acc=0.9688 | FP-Norm=0.712 | FP-Norm(final)=2.827 | 3787.7 samples/s | 59.2 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01505 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.744 | FP-Norm(final)=2.828 | 4780.0 samples/s | 74.7 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01326 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.760 | FP-Norm(final)=2.829 | 1621.9 samples/s | 25.3 steps/s
[Step=19500 Epoch=95.1] | Loss=0.01233 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.768 | FP-Norm(final)=2.830 | 3742.5 samples/s | 58.5 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01155 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.831 | 3770.2 samples/s | 58.9 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01069 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.773 | FP-Norm(final)=2.832 | 4560.6 samples/s | 71.3 steps/s
[Step=19650 Epoch=95.8] | Loss=0.01013 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.834 | 1668.4 samples/s | 26.1 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00984 | Reg=0.00061 | acc=0.9844 | FP-Norm=0.776 | FP-Norm(final)=2.835 | 3751.1 samples/s | 58.6 steps/s
[Step=19750 Epoch=96.3] | Loss=0.00932 | Reg=0.00061 | acc=0.9844 | FP-Norm=0.776 | FP-Norm(final)=2.836 | 3767.6 samples/s | 58.9 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00916 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.777 | FP-Norm(final)=2.837 | 4296.1 samples/s | 67.1 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00895 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.779 | FP-Norm(final)=2.838 | 1680.6 samples/s | 26.3 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00873 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.780 | FP-Norm(final)=2.839 | 3784.7 samples/s | 59.1 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00839 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.782 | FP-Norm(final)=2.839 | 3745.6 samples/s | 58.5 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00815 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.783 | FP-Norm(final)=2.840 | 4046.3 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.7] | Loss=0.12035 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.826 | 3834.7 samples/s | 59.9 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02372 | Reg=0.00052 | acc=0.9844 | FP-Norm=0.684 | FP-Norm(final)=2.824 | 3462.4 samples/s | 54.1 steps/s
[Step=19300 Epoch=94.2] | Loss=0.01942 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.751 | FP-Norm(final)=2.823 | 3755.5 samples/s | 58.7 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01633 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.773 | FP-Norm(final)=2.822 | 3749.7 samples/s | 58.6 steps/s
[Step=19400 Epoch=94.7] | Loss=0.01514 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.789 | FP-Norm(final)=2.823 | 4858.8 samples/s | 75.9 steps/s
[Step=19450 Epoch=94.9] | Loss=0.01302 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.824 | 1613.4 samples/s | 25.2 steps/s
[Step=19500 Epoch=95.2] | Loss=0.01181 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.801 | FP-Norm(final)=2.826 | 3771.5 samples/s | 58.9 steps/s
[Step=19550 Epoch=95.4] | Loss=0.01124 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.828 | 3770.4 samples/s | 58.9 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01055 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.830 | 4589.5 samples/s | 71.7 steps/s
[Step=19650 Epoch=95.9] | Loss=0.01007 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.800 | FP-Norm(final)=2.831 | 1653.3 samples/s | 25.8 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00952 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.833 | 3751.5 samples/s | 58.6 steps/s
[Step=19750 Epoch=96.4] | Loss=0.00916 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.795 | FP-Norm(final)=2.834 | 3844.4 samples/s | 60.1 steps/s
[Step=19800 Epoch=96.6] | Loss=0.00880 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.794 | FP-Norm(final)=2.836 | 4378.2 samples/s | 68.4 steps/s
[Step=19850 Epoch=96.9] | Loss=0.00843 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.792 | FP-Norm(final)=2.837 | 1660.8 samples/s | 25.9 steps/s
[Step=19900 Epoch=97.1] | Loss=0.00811 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.790 | FP-Norm(final)=2.839 | 3780.0 samples/s | 59.1 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00790 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.788 | FP-Norm(final)=2.840 | 3758.9 samples/s | 58.7 steps/s
[Step=20000 Epoch=97.6] | Loss=0.00761 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.787 | FP-Norm(final)=2.841 | 4204.5 samples/s | 65.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step20000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.6] | Loss=0.03610 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.826 | 3683.3 samples/s | 57.6 steps/s
[Step=19250 Epoch=93.8] | Loss=0.02600 | Reg=0.00048 | acc=0.9844 | FP-Norm=0.653 | FP-Norm(final)=2.823 | 3587.2 samples/s | 56.1 steps/s
[Step=19300 Epoch=94.0] | Loss=0.02088 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.737 | FP-Norm(final)=2.820 | 3746.0 samples/s | 58.5 steps/s
[Step=19350 Epoch=94.3] | Loss=0.01754 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.771 | FP-Norm(final)=2.819 | 3795.5 samples/s | 59.3 steps/s
[Step=19400 Epoch=94.5] | Loss=0.01607 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.789 | FP-Norm(final)=2.820 | 4798.3 samples/s | 75.0 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01425 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.799 | FP-Norm(final)=2.822 | 1623.5 samples/s | 25.4 steps/s
[Step=19500 Epoch=95.0] | Loss=0.01297 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.803 | FP-Norm(final)=2.824 | 3761.1 samples/s | 58.8 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01207 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.806 | FP-Norm(final)=2.826 | 3769.0 samples/s | 58.9 steps/s
[Step=19600 Epoch=95.5] | Loss=0.01171 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.808 | FP-Norm(final)=2.827 | 4559.7 samples/s | 71.2 steps/s
[Step=19650 Epoch=95.7] | Loss=0.01103 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.829 | 1664.2 samples/s | 26.0 steps/s
[Step=19700 Epoch=96.0] | Loss=0.01045 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.830 | 3771.7 samples/s | 58.9 steps/s
[Step=19750 Epoch=96.2] | Loss=0.00985 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.808 | FP-Norm(final)=2.832 | 3813.0 samples/s | 59.6 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00950 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.808 | FP-Norm(final)=2.833 | 4283.5 samples/s | 66.9 steps/s
[Step=19850 Epoch=96.7] | Loss=0.00905 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.835 | 1703.1 samples/s | 26.6 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00866 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.806 | FP-Norm(final)=2.837 | 3788.9 samples/s | 59.2 steps/s
[Step=19950 Epoch=97.2] | Loss=0.00840 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.806 | FP-Norm(final)=2.838 | 3756.2 samples/s | 58.7 steps/s
[Step=20000 Epoch=97.4] | Loss=0.00820 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.805 | FP-Norm(final)=2.840 | 4068.8 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step20000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.6] | Loss=0.15261 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.826 | 3937.2 samples/s | 61.5 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02348 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.721 | FP-Norm(final)=2.823 | 3393.0 samples/s | 53.0 steps/s
[Step=19300 Epoch=94.1] | Loss=0.01735 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.785 | FP-Norm(final)=2.821 | 3777.4 samples/s | 59.0 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01531 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.801 | FP-Norm(final)=2.822 | 3770.6 samples/s | 58.9 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01460 | Reg=0.00067 | acc=0.9844 | FP-Norm=0.810 | FP-Norm(final)=2.823 | 4859.1 samples/s | 75.9 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01283 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.824 | 1633.1 samples/s | 25.5 steps/s
[Step=19500 Epoch=95.1] | Loss=0.01178 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.826 | 3775.4 samples/s | 59.0 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01099 | Reg=0.00068 | acc=0.9844 | FP-Norm=0.818 | FP-Norm(final)=2.827 | 3780.4 samples/s | 59.1 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01038 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.829 | 4551.2 samples/s | 71.1 steps/s
[Step=19650 Epoch=95.8] | Loss=0.00987 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.819 | FP-Norm(final)=2.831 | 1659.2 samples/s | 25.9 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00931 | Reg=0.00068 | acc=0.9844 | FP-Norm=0.819 | FP-Norm(final)=2.833 | 3756.8 samples/s | 58.7 steps/s
[Step=19750 Epoch=96.3] | Loss=0.00886 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.835 | 3734.9 samples/s | 58.4 steps/s
[Step=19800 Epoch=96.6] | Loss=0.00866 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.836 | 4293.3 samples/s | 67.1 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00836 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.838 | 1677.0 samples/s | 26.2 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00801 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.817 | FP-Norm(final)=2.839 | 3786.6 samples/s | 59.2 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00766 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.841 | 3754.1 samples/s | 58.7 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00743 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.843 | 4077.5 samples/s | 63.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step20000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=94.2] | Loss=0.16310 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.826 | 3850.7 samples/s | 60.2 steps/s
[Step=19250 Epoch=94.4] | Loss=0.02462 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.642 | FP-Norm(final)=2.820 | 3498.3 samples/s | 54.7 steps/s
[Step=19300 Epoch=94.6] | Loss=0.01874 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.707 | FP-Norm(final)=2.819 | 3789.2 samples/s | 59.2 steps/s
[Step=19350 Epoch=94.9] | Loss=0.01571 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.730 | FP-Norm(final)=2.820 | 3757.6 samples/s | 58.7 steps/s
[Step=19400 Epoch=95.1] | Loss=0.01449 | Reg=0.00057 | acc=0.9844 | FP-Norm=0.745 | FP-Norm(final)=2.821 | 4904.4 samples/s | 76.6 steps/s
[Step=19450 Epoch=95.4] | Loss=0.01259 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.752 | FP-Norm(final)=2.823 | 1614.7 samples/s | 25.2 steps/s
[Step=19500 Epoch=95.6] | Loss=0.01131 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.753 | FP-Norm(final)=2.825 | 3773.7 samples/s | 59.0 steps/s
[Step=19550 Epoch=95.9] | Loss=0.01060 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.754 | FP-Norm(final)=2.827 | 3793.9 samples/s | 59.3 steps/s
[Step=19600 Epoch=96.1] | Loss=0.00984 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.755 | FP-Norm(final)=2.830 | 4719.9 samples/s | 73.7 steps/s
[Step=19650 Epoch=96.4] | Loss=0.00949 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.755 | FP-Norm(final)=2.831 | 1639.5 samples/s | 25.6 steps/s
[Step=19700 Epoch=96.6] | Loss=0.00901 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.755 | FP-Norm(final)=2.833 | 3774.3 samples/s | 59.0 steps/s
[Step=19750 Epoch=96.9] | Loss=0.00870 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.755 | FP-Norm(final)=2.834 | 3754.5 samples/s | 58.7 steps/s
[Step=19800 Epoch=97.1] | Loss=0.00831 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.754 | FP-Norm(final)=2.836 | 4503.7 samples/s | 70.4 steps/s
[Step=19850 Epoch=97.3] | Loss=0.00787 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.754 | FP-Norm(final)=2.837 | 1654.1 samples/s | 25.8 steps/s
[Step=19900 Epoch=97.6] | Loss=0.00759 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.753 | FP-Norm(final)=2.839 | 3781.4 samples/s | 59.1 steps/s
[Step=19950 Epoch=97.8] | Loss=0.00729 | Reg=0.00057 | acc=0.9844 | FP-Norm=0.752 | FP-Norm(final)=2.840 | 3755.1 samples/s | 58.7 steps/s
[Step=20000 Epoch=98.1] | Loss=0.00709 | Reg=0.00057 | acc=0.9844 | FP-Norm=0.751 | FP-Norm(final)=2.842 | 4352.4 samples/s | 68.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step20000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=181.9] | Loss=0.02895 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.826 | 3851.9 samples/s | 60.2 steps/s
[Step=19250 Epoch=182.4] | Loss=0.00695 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.823 | 3048.5 samples/s | 47.6 steps/s
[Step=19300 Epoch=182.9] | Loss=0.00389 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.835 | FP-Norm(final)=2.822 | 4639.9 samples/s | 72.5 steps/s
[Step=19350 Epoch=183.4] | Loss=0.00265 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.838 | FP-Norm(final)=2.823 | 1491.3 samples/s | 23.3 steps/s
[Step=19400 Epoch=183.8] | Loss=0.00202 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.824 | 4214.3 samples/s | 65.8 steps/s
[Step=19450 Epoch=184.3] | Loss=0.00163 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.825 | 1564.1 samples/s | 24.4 steps/s
[Step=19500 Epoch=184.8] | Loss=0.00136 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.802 | FP-Norm(final)=2.826 | 4076.9 samples/s | 63.7 steps/s
[Step=19550 Epoch=185.3] | Loss=0.00117 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.788 | FP-Norm(final)=2.826 | 1620.0 samples/s | 25.3 steps/s
[Step=19600 Epoch=185.7] | Loss=0.00103 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.827 | 3843.6 samples/s | 60.1 steps/s
[Step=19650 Epoch=186.2] | Loss=0.00092 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.827 | 1649.1 samples/s | 25.8 steps/s
[Step=19700 Epoch=186.7] | Loss=0.00083 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.751 | FP-Norm(final)=2.828 | 3641.3 samples/s | 56.9 steps/s
[Step=19750 Epoch=187.1] | Loss=0.00076 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.740 | FP-Norm(final)=2.828 | 1706.1 samples/s | 26.7 steps/s
[Step=19800 Epoch=187.6] | Loss=0.00069 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.729 | FP-Norm(final)=2.828 | 3565.4 samples/s | 55.7 steps/s
[Step=19850 Epoch=188.1] | Loss=0.00064 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.720 | FP-Norm(final)=2.829 | 1715.5 samples/s | 26.8 steps/s
[Step=19900 Epoch=188.6] | Loss=0.00060 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.710 | FP-Norm(final)=2.829 | 3601.5 samples/s | 56.3 steps/s
[Step=19950 Epoch=189.0] | Loss=0.00056 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.702 | FP-Norm(final)=2.829 | 1727.7 samples/s | 27.0 steps/s
[Step=20000 Epoch=189.5] | Loss=0.00053 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.693 | FP-Norm(final)=2.830 | 3474.7 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step20000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=182.6] | Loss=0.00768 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.826 | 3744.5 samples/s | 58.5 steps/s
[Step=19250 Epoch=183.1] | Loss=0.00629 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.893 | FP-Norm(final)=2.824 | 3169.6 samples/s | 49.5 steps/s
[Step=19300 Epoch=183.6] | Loss=0.00325 | Reg=0.00105 | acc=1.0000 | FP-Norm=0.998 | FP-Norm(final)=2.825 | 4619.7 samples/s | 72.2 steps/s
[Step=19350 Epoch=184.1] | Loss=0.00218 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.001 | FP-Norm(final)=2.826 | 1549.2 samples/s | 24.2 steps/s
[Step=19400 Epoch=184.5] | Loss=0.00164 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.987 | FP-Norm(final)=2.827 | 4332.4 samples/s | 67.7 steps/s
[Step=19450 Epoch=185.0] | Loss=0.00132 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.969 | FP-Norm(final)=2.827 | 1580.7 samples/s | 24.7 steps/s
[Step=19500 Epoch=185.5] | Loss=0.00110 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.951 | FP-Norm(final)=2.828 | 4043.8 samples/s | 63.2 steps/s
[Step=19550 Epoch=186.0] | Loss=0.00095 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.935 | FP-Norm(final)=2.828 | 1634.5 samples/s | 25.5 steps/s
[Step=19600 Epoch=186.4] | Loss=0.00083 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.919 | FP-Norm(final)=2.828 | 3799.7 samples/s | 59.4 steps/s
[Step=19650 Epoch=186.9] | Loss=0.00074 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.904 | FP-Norm(final)=2.829 | 1665.6 samples/s | 26.0 steps/s
[Step=19700 Epoch=187.4] | Loss=0.00067 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.891 | FP-Norm(final)=2.829 | 3610.1 samples/s | 56.4 steps/s
[Step=19750 Epoch=187.9] | Loss=0.00061 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.878 | FP-Norm(final)=2.829 | 1705.2 samples/s | 26.6 steps/s
[Step=19800 Epoch=188.3] | Loss=0.00056 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.866 | FP-Norm(final)=2.829 | 3604.3 samples/s | 56.3 steps/s
[Step=19850 Epoch=188.8] | Loss=0.00052 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.854 | FP-Norm(final)=2.829 | 1723.3 samples/s | 26.9 steps/s
[Step=19900 Epoch=189.3] | Loss=0.00048 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.843 | FP-Norm(final)=2.830 | 3535.8 samples/s | 55.2 steps/s
[Step=19950 Epoch=189.8] | Loss=0.00045 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.832 | FP-Norm(final)=2.830 | 1707.4 samples/s | 26.7 steps/s
[Step=20000 Epoch=190.2] | Loss=0.00042 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.822 | FP-Norm(final)=2.830 | 3563.6 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step20000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=183.4] | Loss=0.21882 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.825 | 3615.0 samples/s | 56.5 steps/s
[Step=19250 Epoch=183.8] | Loss=0.01153 | Reg=0.00107 | acc=1.0000 | FP-Norm=0.989 | FP-Norm(final)=2.816 | 3190.4 samples/s | 49.8 steps/s
[Step=19300 Epoch=184.3] | Loss=0.00625 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.073 | FP-Norm(final)=2.814 | 4759.3 samples/s | 74.4 steps/s
[Step=19350 Epoch=184.8] | Loss=0.00418 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.071 | FP-Norm(final)=2.813 | 1545.2 samples/s | 24.1 steps/s
[Step=19400 Epoch=185.3] | Loss=0.00316 | Reg=0.00114 | acc=1.0000 | FP-Norm=1.054 | FP-Norm(final)=2.813 | 4440.7 samples/s | 69.4 steps/s
[Step=19450 Epoch=185.7] | Loss=0.00254 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.037 | FP-Norm(final)=2.814 | 1568.7 samples/s | 24.5 steps/s
[Step=19500 Epoch=186.2] | Loss=0.00212 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.020 | FP-Norm(final)=2.814 | 4193.2 samples/s | 65.5 steps/s
[Step=19550 Epoch=186.7] | Loss=0.00182 | Reg=0.00102 | acc=1.0000 | FP-Norm=1.003 | FP-Norm(final)=2.814 | 1604.2 samples/s | 25.1 steps/s
[Step=19600 Epoch=187.2] | Loss=0.00160 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.986 | FP-Norm(final)=2.815 | 3951.8 samples/s | 61.7 steps/s
[Step=19650 Epoch=187.6] | Loss=0.00142 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.971 | FP-Norm(final)=2.815 | 1618.6 samples/s | 25.3 steps/s
[Step=19700 Epoch=188.1] | Loss=0.00128 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.957 | FP-Norm(final)=2.816 | 3796.3 samples/s | 59.3 steps/s
[Step=19750 Epoch=188.6] | Loss=0.00117 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.943 | FP-Norm(final)=2.816 | 1680.0 samples/s | 26.2 steps/s
[Step=19800 Epoch=189.1] | Loss=0.00107 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.930 | FP-Norm(final)=2.816 | 3583.0 samples/s | 56.0 steps/s
[Step=19850 Epoch=189.6] | Loss=0.00099 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.918 | FP-Norm(final)=2.817 | 1703.5 samples/s | 26.6 steps/s
[Step=19900 Epoch=190.0] | Loss=0.00092 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.907 | FP-Norm(final)=2.817 | 3599.9 samples/s | 56.2 steps/s
[Step=19950 Epoch=190.5] | Loss=0.00086 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.896 | FP-Norm(final)=2.818 | 1713.5 samples/s | 26.8 steps/s
[Step=20000 Epoch=191.0] | Loss=0.00081 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.885 | FP-Norm(final)=2.818 | 3576.8 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step20000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=180.9] | Loss=0.04625 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.826 | 3657.2 samples/s | 57.1 steps/s
[Step=19250 Epoch=181.4] | Loss=0.00630 | Reg=0.00108 | acc=1.0000 | FP-Norm=0.995 | FP-Norm(final)=2.824 | 3238.9 samples/s | 50.6 steps/s
[Step=19300 Epoch=181.9] | Loss=0.00346 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.062 | FP-Norm(final)=2.825 | 4605.3 samples/s | 72.0 steps/s
[Step=19350 Epoch=182.3] | Loss=0.00232 | Reg=0.00116 | acc=1.0000 | FP-Norm=1.060 | FP-Norm(final)=2.825 | 1536.9 samples/s | 24.0 steps/s
[Step=19400 Epoch=182.8] | Loss=0.00175 | Reg=0.00111 | acc=1.0000 | FP-Norm=1.042 | FP-Norm(final)=2.825 | 4272.9 samples/s | 66.8 steps/s
[Step=19450 Epoch=183.3] | Loss=0.00140 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.022 | FP-Norm(final)=2.825 | 1595.4 samples/s | 24.9 steps/s
[Step=19500 Epoch=183.7] | Loss=0.00117 | Reg=0.00103 | acc=1.0000 | FP-Norm=1.002 | FP-Norm(final)=2.826 | 3898.6 samples/s | 60.9 steps/s
[Step=19550 Epoch=184.2] | Loss=0.00101 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.984 | FP-Norm(final)=2.826 | 1541.3 samples/s | 24.1 steps/s
[Step=19600 Epoch=184.7] | Loss=0.00088 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.966 | FP-Norm(final)=2.827 | 3529.8 samples/s | 55.2 steps/s
[Step=19650 Epoch=185.2] | Loss=0.00079 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.950 | FP-Norm(final)=2.827 | 1688.7 samples/s | 26.4 steps/s
[Step=19700 Epoch=185.6] | Loss=0.00071 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.935 | FP-Norm(final)=2.827 | 3571.8 samples/s | 55.8 steps/s
[Step=19750 Epoch=186.1] | Loss=0.00065 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.921 | FP-Norm(final)=2.827 | 1706.4 samples/s | 26.7 steps/s
[Step=19800 Epoch=186.6] | Loss=0.00059 | Reg=0.00084 | acc=1.0000 | FP-Norm=0.907 | FP-Norm(final)=2.828 | 3590.6 samples/s | 56.1 steps/s
[Step=19850 Epoch=187.0] | Loss=0.00055 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.894 | FP-Norm(final)=2.828 | 1731.4 samples/s | 27.1 steps/s
[Step=19900 Epoch=187.5] | Loss=0.00051 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.882 | FP-Norm(final)=2.828 | 3515.3 samples/s | 54.9 steps/s
[Step=19950 Epoch=188.0] | Loss=0.00048 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.829 | 1777.6 samples/s | 27.8 steps/s
[Step=20000 Epoch=188.5] | Loss=0.00045 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.860 | FP-Norm(final)=2.829 | 3328.8 samples/s | 52.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step20000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=183.0] | Loss=0.02979 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.827 | 3891.0 samples/s | 60.8 steps/s
[Step=19250 Epoch=183.5] | Loss=0.00653 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.833 | FP-Norm(final)=2.826 | 3075.2 samples/s | 48.1 steps/s
[Step=19300 Epoch=183.9] | Loss=0.00339 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.900 | FP-Norm(final)=2.826 | 4616.7 samples/s | 72.1 steps/s
[Step=19350 Epoch=184.4] | Loss=0.00228 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.897 | FP-Norm(final)=2.827 | 1538.2 samples/s | 24.0 steps/s
[Step=19400 Epoch=184.9] | Loss=0.00175 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.885 | FP-Norm(final)=2.828 | 4459.3 samples/s | 69.7 steps/s
[Step=19450 Epoch=185.4] | Loss=0.00141 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.870 | FP-Norm(final)=2.828 | 1562.1 samples/s | 24.4 steps/s
[Step=19500 Epoch=185.9] | Loss=0.00118 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.855 | FP-Norm(final)=2.829 | 4142.0 samples/s | 64.7 steps/s
[Step=19550 Epoch=186.3] | Loss=0.00101 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.840 | FP-Norm(final)=2.830 | 1602.2 samples/s | 25.0 steps/s
[Step=19600 Epoch=186.8] | Loss=0.00089 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.830 | 3980.7 samples/s | 62.2 steps/s
[Step=19650 Epoch=187.3] | Loss=0.00079 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.830 | 1645.5 samples/s | 25.7 steps/s
[Step=19700 Epoch=187.8] | Loss=0.00071 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.831 | 3756.9 samples/s | 58.7 steps/s
[Step=19750 Epoch=188.2] | Loss=0.00065 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.789 | FP-Norm(final)=2.831 | 1647.4 samples/s | 25.7 steps/s
[Step=19800 Epoch=188.7] | Loss=0.00060 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.831 | 3640.5 samples/s | 56.9 steps/s
[Step=19850 Epoch=189.2] | Loss=0.00055 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.768 | FP-Norm(final)=2.832 | 1708.7 samples/s | 26.7 steps/s
[Step=19900 Epoch=189.7] | Loss=0.00052 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.758 | FP-Norm(final)=2.832 | 3569.3 samples/s | 55.8 steps/s
[Step=19950 Epoch=190.1] | Loss=0.00048 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.748 | FP-Norm(final)=2.832 | 1717.2 samples/s | 26.8 steps/s
[Step=20000 Epoch=190.6] | Loss=0.00045 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.739 | FP-Norm(final)=2.832 | 3605.5 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22946 | acc=0.8627 | tpr=0.8076 | fpr=0.0176 | 3660.0 samples/s | 14.3 steps/s
Avg test loss: 0.23055, Avg test acc: 0.86253, Avg tpr: 0.80871, Avg fpr: 0.01910, total FA: 149

Testing server on iccad2012
[Step=  50] | Loss=0.51001 | acc=0.8433 | tpr=0.9779 | fpr=0.1591 | 3659.8 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.52852 | acc=0.8399 | tpr=0.9787 | fpr=0.1627 | 6818.9 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.53840 | acc=0.8371 | tpr=0.9741 | fpr=0.1654 | 6878.8 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.53837 | acc=0.8375 | tpr=0.9760 | fpr=0.1650 | 6695.2 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.53633 | acc=0.8368 | tpr=0.9721 | fpr=0.1656 | 6831.1 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.54041 | acc=0.8365 | tpr=0.9702 | fpr=0.1659 | 6895.6 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.54073 | acc=0.8367 | tpr=0.9706 | fpr=0.1657 | 6898.6 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.54144 | acc=0.8365 | tpr=0.9716 | fpr=0.1660 | 6749.2 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.54508 | acc=0.8364 | tpr=0.9713 | fpr=0.1661 | 6790.4 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.54605 | acc=0.8359 | tpr=0.9718 | fpr=0.1665 | 6908.4 samples/s | 27.0 steps/s
[Step= 550] | Loss=0.54538 | acc=0.8362 | tpr=0.9717 | fpr=0.1663 | 12565.4 samples/s | 49.1 steps/s
Avg test loss: 0.54532, Avg test acc: 0.83619, Avg tpr: 0.97187, Avg fpr: 0.16628, total FA: 23087

server round 25/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.30382 | Reg=0.00000 | acc=0.8438 | FP-Norm=0.000 | FP-Norm(final)=2.846 | 3666.4 samples/s | 57.3 steps/s
[Step=20050 Epoch=97.8] | Loss=0.03386 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.739 | FP-Norm(final)=2.833 | 3585.9 samples/s | 56.0 steps/s
[Step=20100 Epoch=98.0] | Loss=0.02388 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.803 | FP-Norm(final)=2.830 | 3359.2 samples/s | 52.5 steps/s
[Step=20150 Epoch=98.3] | Loss=0.02076 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.824 | FP-Norm(final)=2.829 | 3454.0 samples/s | 54.0 steps/s
[Step=20200 Epoch=98.5] | Loss=0.01790 | Reg=0.00070 | acc=0.9844 | FP-Norm=0.830 | FP-Norm(final)=2.831 | 4642.9 samples/s | 72.5 steps/s
[Step=20250 Epoch=98.7] | Loss=0.01559 | Reg=0.00070 | acc=0.9688 | FP-Norm=0.829 | FP-Norm(final)=2.832 | 1629.9 samples/s | 25.5 steps/s
[Step=20300 Epoch=99.0] | Loss=0.01407 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.824 | FP-Norm(final)=2.834 | 3795.8 samples/s | 59.3 steps/s
[Step=20350 Epoch=99.2] | Loss=0.01272 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.836 | 3816.0 samples/s | 59.6 steps/s
[Step=20400 Epoch=99.5] | Loss=0.01207 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.838 | 4591.8 samples/s | 71.7 steps/s
[Step=20450 Epoch=99.7] | Loss=0.01138 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.840 | 1689.0 samples/s | 26.4 steps/s
[Step=20500 Epoch=100.0] | Loss=0.01067 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.842 | 3814.1 samples/s | 59.6 steps/s
[Step=20550 Epoch=100.2] | Loss=0.01021 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.805 | FP-Norm(final)=2.843 | 3825.6 samples/s | 59.8 steps/s
[Step=20600 Epoch=100.4] | Loss=0.00977 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.803 | FP-Norm(final)=2.845 | 4343.8 samples/s | 67.9 steps/s
[Step=20650 Epoch=100.7] | Loss=0.00927 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.846 | 1723.7 samples/s | 26.9 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00884 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.799 | FP-Norm(final)=2.848 | 3795.5 samples/s | 59.3 steps/s
[Step=20750 Epoch=101.2] | Loss=0.00865 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.850 | 3807.0 samples/s | 59.5 steps/s
[Step=20800 Epoch=101.4] | Loss=0.00842 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.796 | FP-Norm(final)=2.851 | 4102.4 samples/s | 64.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step20800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.6] | Loss=0.09374 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.846 | 3608.5 samples/s | 56.4 steps/s
[Step=20050 Epoch=97.8] | Loss=0.02295 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.698 | FP-Norm(final)=2.844 | 3795.0 samples/s | 59.3 steps/s
[Step=20100 Epoch=98.1] | Loss=0.01859 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.763 | FP-Norm(final)=2.843 | 3827.0 samples/s | 59.8 steps/s
[Step=20150 Epoch=98.3] | Loss=0.01525 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.788 | FP-Norm(final)=2.844 | 3815.0 samples/s | 59.6 steps/s
[Step=20200 Epoch=98.6] | Loss=0.01422 | Reg=0.00066 | acc=0.9688 | FP-Norm=0.801 | FP-Norm(final)=2.845 | 4898.6 samples/s | 76.5 steps/s
[Step=20250 Epoch=98.8] | Loss=0.01290 | Reg=0.00067 | acc=0.9844 | FP-Norm=0.810 | FP-Norm(final)=2.846 | 1641.6 samples/s | 25.6 steps/s
[Step=20300 Epoch=99.1] | Loss=0.01200 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.848 | 3790.0 samples/s | 59.2 steps/s
[Step=20350 Epoch=99.3] | Loss=0.01138 | Reg=0.00067 | acc=0.9844 | FP-Norm=0.814 | FP-Norm(final)=2.849 | 3819.3 samples/s | 59.7 steps/s
[Step=20400 Epoch=99.5] | Loss=0.01062 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.850 | 4650.6 samples/s | 72.7 steps/s
[Step=20450 Epoch=99.8] | Loss=0.00980 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.851 | 1659.7 samples/s | 25.9 steps/s
[Step=20500 Epoch=100.0] | Loss=0.00915 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.810 | FP-Norm(final)=2.853 | 3818.3 samples/s | 59.7 steps/s
[Step=20550 Epoch=100.3] | Loss=0.00868 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.808 | FP-Norm(final)=2.855 | 3812.4 samples/s | 59.6 steps/s
[Step=20600 Epoch=100.5] | Loss=0.00856 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.856 | 4442.0 samples/s | 69.4 steps/s
[Step=20650 Epoch=100.8] | Loss=0.00823 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.806 | FP-Norm(final)=2.857 | 1699.2 samples/s | 26.6 steps/s
[Step=20700 Epoch=101.0] | Loss=0.00815 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.805 | FP-Norm(final)=2.858 | 3805.0 samples/s | 59.5 steps/s
[Step=20750 Epoch=101.3] | Loss=0.00800 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.805 | FP-Norm(final)=2.859 | 3825.8 samples/s | 59.8 steps/s
[Step=20800 Epoch=101.5] | Loss=0.00789 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.805 | FP-Norm(final)=2.859 | 4247.8 samples/s | 66.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step20800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.08175 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.846 | 3670.8 samples/s | 57.4 steps/s
[Step=20050 Epoch=97.7] | Loss=0.02278 | Reg=0.00051 | acc=0.9688 | FP-Norm=0.682 | FP-Norm(final)=2.845 | 3746.4 samples/s | 58.5 steps/s
[Step=20100 Epoch=97.9] | Loss=0.01896 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.768 | FP-Norm(final)=2.842 | 3770.9 samples/s | 58.9 steps/s
[Step=20150 Epoch=98.2] | Loss=0.01702 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.796 | FP-Norm(final)=2.842 | 3832.2 samples/s | 59.9 steps/s
[Step=20200 Epoch=98.4] | Loss=0.01488 | Reg=0.00068 | acc=0.9844 | FP-Norm=0.812 | FP-Norm(final)=2.842 | 4886.3 samples/s | 76.3 steps/s
[Step=20250 Epoch=98.7] | Loss=0.01293 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.817 | FP-Norm(final)=2.843 | 1647.3 samples/s | 25.7 steps/s
[Step=20300 Epoch=98.9] | Loss=0.01168 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.845 | 3794.6 samples/s | 59.3 steps/s
[Step=20350 Epoch=99.2] | Loss=0.01095 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.847 | 3814.1 samples/s | 59.6 steps/s
[Step=20400 Epoch=99.4] | Loss=0.01015 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.849 | 4592.5 samples/s | 71.8 steps/s
[Step=20450 Epoch=99.6] | Loss=0.00954 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.811 | FP-Norm(final)=2.851 | 1678.8 samples/s | 26.2 steps/s
[Step=20500 Epoch=99.9] | Loss=0.00917 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.809 | FP-Norm(final)=2.853 | 3824.9 samples/s | 59.8 steps/s
[Step=20550 Epoch=100.1] | Loss=0.00876 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.808 | FP-Norm(final)=2.855 | 3807.6 samples/s | 59.5 steps/s
[Step=20600 Epoch=100.4] | Loss=0.00830 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.806 | FP-Norm(final)=2.857 | 4320.1 samples/s | 67.5 steps/s
[Step=20650 Epoch=100.6] | Loss=0.00798 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.804 | FP-Norm(final)=2.859 | 1719.4 samples/s | 26.9 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00769 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.802 | FP-Norm(final)=2.860 | 3819.1 samples/s | 59.7 steps/s
[Step=20750 Epoch=101.1] | Loss=0.00747 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.800 | FP-Norm(final)=2.862 | 3836.0 samples/s | 59.9 steps/s
[Step=20800 Epoch=101.3] | Loss=0.00720 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.799 | FP-Norm(final)=2.864 | 4105.6 samples/s | 64.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step20800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.12083 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.846 | 3563.7 samples/s | 55.7 steps/s
[Step=20050 Epoch=97.8] | Loss=0.02272 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.619 | FP-Norm(final)=2.844 | 3814.9 samples/s | 59.6 steps/s
[Step=20100 Epoch=98.0] | Loss=0.01682 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.682 | FP-Norm(final)=2.844 | 3804.1 samples/s | 59.4 steps/s
[Step=20150 Epoch=98.3] | Loss=0.01555 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.708 | FP-Norm(final)=2.846 | 3803.1 samples/s | 59.4 steps/s
[Step=20200 Epoch=98.5] | Loss=0.01391 | Reg=0.00055 | acc=0.9688 | FP-Norm=0.733 | FP-Norm(final)=2.847 | 4880.3 samples/s | 76.3 steps/s
[Step=20250 Epoch=98.8] | Loss=0.01246 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.748 | FP-Norm(final)=2.849 | 1648.6 samples/s | 25.8 steps/s
[Step=20300 Epoch=99.0] | Loss=0.01100 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.754 | FP-Norm(final)=2.850 | 3836.2 samples/s | 59.9 steps/s
[Step=20350 Epoch=99.2] | Loss=0.01039 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.758 | FP-Norm(final)=2.852 | 3814.7 samples/s | 59.6 steps/s
[Step=20400 Epoch=99.5] | Loss=0.00995 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.854 | 4624.2 samples/s | 72.3 steps/s
[Step=20450 Epoch=99.7] | Loss=0.00952 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.856 | 1683.5 samples/s | 26.3 steps/s
[Step=20500 Epoch=100.0] | Loss=0.00898 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.767 | FP-Norm(final)=2.858 | 3793.0 samples/s | 59.3 steps/s
[Step=20550 Epoch=100.2] | Loss=0.00873 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.768 | FP-Norm(final)=2.860 | 3814.5 samples/s | 59.6 steps/s
[Step=20600 Epoch=100.5] | Loss=0.00844 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.769 | FP-Norm(final)=2.862 | 4336.0 samples/s | 67.7 steps/s
[Step=20650 Epoch=100.7] | Loss=0.00802 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.768 | FP-Norm(final)=2.863 | 1709.7 samples/s | 26.7 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00762 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.767 | FP-Norm(final)=2.865 | 3794.7 samples/s | 59.3 steps/s
[Step=20750 Epoch=101.2] | Loss=0.00737 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.866 | 3794.3 samples/s | 59.3 steps/s
[Step=20800 Epoch=101.4] | Loss=0.00709 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.766 | FP-Norm(final)=2.867 | 4112.9 samples/s | 64.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step20800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=98.1] | Loss=0.09789 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.846 | 3654.3 samples/s | 57.1 steps/s
[Step=20050 Epoch=98.3] | Loss=0.02218 | Reg=0.00046 | acc=0.9844 | FP-Norm=0.644 | FP-Norm(final)=2.843 | 3727.7 samples/s | 58.2 steps/s
[Step=20100 Epoch=98.6] | Loss=0.01716 | Reg=0.00055 | acc=0.9688 | FP-Norm=0.724 | FP-Norm(final)=2.841 | 3811.1 samples/s | 59.5 steps/s
[Step=20150 Epoch=98.8] | Loss=0.01579 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.841 | 3829.6 samples/s | 59.8 steps/s
[Step=20200 Epoch=99.1] | Loss=0.01540 | Reg=0.00064 | acc=0.9688 | FP-Norm=0.787 | FP-Norm(final)=2.841 | 4973.9 samples/s | 77.7 steps/s
[Step=20250 Epoch=99.3] | Loss=0.01370 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.805 | FP-Norm(final)=2.842 | 1625.5 samples/s | 25.4 steps/s
[Step=20300 Epoch=99.5] | Loss=0.01252 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.814 | FP-Norm(final)=2.843 | 3802.7 samples/s | 59.4 steps/s
[Step=20350 Epoch=99.8] | Loss=0.01161 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.819 | FP-Norm(final)=2.844 | 3812.0 samples/s | 59.6 steps/s
[Step=20400 Epoch=100.0] | Loss=0.01082 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.821 | FP-Norm(final)=2.845 | 4720.7 samples/s | 73.8 steps/s
[Step=20450 Epoch=100.3] | Loss=0.01016 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.821 | FP-Norm(final)=2.847 | 1663.5 samples/s | 26.0 steps/s
[Step=20500 Epoch=100.5] | Loss=0.00949 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.821 | FP-Norm(final)=2.848 | 3824.1 samples/s | 59.8 steps/s
[Step=20550 Epoch=100.8] | Loss=0.00879 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.849 | 3791.0 samples/s | 59.2 steps/s
[Step=20600 Epoch=101.0] | Loss=0.00861 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.851 | 4572.8 samples/s | 71.4 steps/s
[Step=20650 Epoch=101.3] | Loss=0.00821 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.852 | 1688.7 samples/s | 26.4 steps/s
[Step=20700 Epoch=101.5] | Loss=0.00787 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.854 | 3819.4 samples/s | 59.7 steps/s
[Step=20750 Epoch=101.8] | Loss=0.00761 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.817 | FP-Norm(final)=2.855 | 3810.1 samples/s | 59.5 steps/s
[Step=20800 Epoch=102.0] | Loss=0.00733 | Reg=0.00067 | acc=0.9844 | FP-Norm=0.816 | FP-Norm(final)=2.856 | 4388.9 samples/s | 68.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step20800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=189.5] | Loss=0.24077 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.845 | 3474.0 samples/s | 54.3 steps/s
[Step=20050 Epoch=190.0] | Loss=0.00753 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.791 | FP-Norm(final)=2.840 | 3474.3 samples/s | 54.3 steps/s
[Step=20100 Epoch=190.5] | Loss=0.00384 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.845 | FP-Norm(final)=2.840 | 4614.7 samples/s | 72.1 steps/s
[Step=20150 Epoch=190.9] | Loss=0.00257 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.833 | FP-Norm(final)=2.840 | 1566.3 samples/s | 24.5 steps/s
[Step=20200 Epoch=191.4] | Loss=0.00194 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.841 | 4342.1 samples/s | 67.8 steps/s
[Step=20250 Epoch=191.9] | Loss=0.00155 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.794 | FP-Norm(final)=2.841 | 1594.1 samples/s | 24.9 steps/s
[Step=20300 Epoch=192.4] | Loss=0.00130 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.777 | FP-Norm(final)=2.842 | 4147.0 samples/s | 64.8 steps/s
[Step=20350 Epoch=192.8] | Loss=0.00112 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.760 | FP-Norm(final)=2.842 | 1646.2 samples/s | 25.7 steps/s
[Step=20400 Epoch=193.3] | Loss=0.00098 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.746 | FP-Norm(final)=2.842 | 3892.5 samples/s | 60.8 steps/s
[Step=20450 Epoch=193.8] | Loss=0.00087 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.732 | FP-Norm(final)=2.843 | 1690.5 samples/s | 26.4 steps/s
[Step=20500 Epoch=194.3] | Loss=0.00079 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.719 | FP-Norm(final)=2.843 | 3667.1 samples/s | 57.3 steps/s
[Step=20550 Epoch=194.7] | Loss=0.00072 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.708 | FP-Norm(final)=2.843 | 1720.1 samples/s | 26.9 steps/s
[Step=20600 Epoch=195.2] | Loss=0.00066 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.697 | FP-Norm(final)=2.844 | 3665.8 samples/s | 57.3 steps/s
[Step=20650 Epoch=195.7] | Loss=0.00061 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.844 | 1733.9 samples/s | 27.1 steps/s
[Step=20700 Epoch=196.2] | Loss=0.00057 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.677 | FP-Norm(final)=2.844 | 3628.0 samples/s | 56.7 steps/s
[Step=20750 Epoch=196.6] | Loss=0.00053 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.667 | FP-Norm(final)=2.844 | 1753.6 samples/s | 27.4 steps/s
[Step=20800 Epoch=197.1] | Loss=0.00050 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.659 | FP-Norm(final)=2.845 | 3585.8 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step20800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=190.3] | Loss=0.13891 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.845 | 3564.4 samples/s | 55.7 steps/s
[Step=20050 Epoch=190.7] | Loss=0.00490 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.694 | FP-Norm(final)=2.843 | 3411.0 samples/s | 53.3 steps/s
[Step=20100 Epoch=191.2] | Loss=0.00255 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.720 | FP-Norm(final)=2.845 | 4711.0 samples/s | 73.6 steps/s
[Step=20150 Epoch=191.7] | Loss=0.00171 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.710 | FP-Norm(final)=2.846 | 1571.0 samples/s | 24.5 steps/s
[Step=20200 Epoch=192.2] | Loss=0.00129 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.693 | FP-Norm(final)=2.847 | 4370.4 samples/s | 68.3 steps/s
[Step=20250 Epoch=192.6] | Loss=0.00103 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.677 | FP-Norm(final)=2.848 | 1593.0 samples/s | 24.9 steps/s
[Step=20300 Epoch=193.1] | Loss=0.00087 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.661 | FP-Norm(final)=2.848 | 4119.0 samples/s | 64.4 steps/s
[Step=20350 Epoch=193.6] | Loss=0.00074 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.647 | FP-Norm(final)=2.848 | 1643.2 samples/s | 25.7 steps/s
[Step=20400 Epoch=194.1] | Loss=0.00065 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.635 | FP-Norm(final)=2.849 | 3881.6 samples/s | 60.7 steps/s
[Step=20450 Epoch=194.5] | Loss=0.00058 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.623 | FP-Norm(final)=2.849 | 1683.6 samples/s | 26.3 steps/s
[Step=20500 Epoch=195.0] | Loss=0.00053 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.612 | FP-Norm(final)=2.849 | 3697.2 samples/s | 57.8 steps/s
[Step=20550 Epoch=195.5] | Loss=0.00048 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.602 | FP-Norm(final)=2.849 | 1720.0 samples/s | 26.9 steps/s
[Step=20600 Epoch=196.0] | Loss=0.00044 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.593 | FP-Norm(final)=2.850 | 3616.2 samples/s | 56.5 steps/s
[Step=20650 Epoch=196.4] | Loss=0.00041 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.584 | FP-Norm(final)=2.850 | 1727.0 samples/s | 27.0 steps/s
[Step=20700 Epoch=196.9] | Loss=0.00038 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.850 | 3541.3 samples/s | 55.3 steps/s
[Step=20750 Epoch=197.4] | Loss=0.00036 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.567 | FP-Norm(final)=2.850 | 1680.3 samples/s | 26.3 steps/s
[Step=20800 Epoch=197.9] | Loss=0.00034 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.850 | 3543.4 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step20800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=191.0] | Loss=0.10247 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.846 | 3560.9 samples/s | 55.6 steps/s
[Step=20050 Epoch=191.5] | Loss=0.00410 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.819 | FP-Norm(final)=2.848 | 3347.2 samples/s | 52.3 steps/s
[Step=20100 Epoch=191.9] | Loss=0.00254 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.859 | FP-Norm(final)=2.849 | 4710.7 samples/s | 73.6 steps/s
[Step=20150 Epoch=192.4] | Loss=0.00171 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.856 | FP-Norm(final)=2.849 | 1550.6 samples/s | 24.2 steps/s
[Step=20200 Epoch=192.9] | Loss=0.00129 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.840 | FP-Norm(final)=2.850 | 4454.8 samples/s | 69.6 steps/s
[Step=20250 Epoch=193.4] | Loss=0.00104 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.822 | FP-Norm(final)=2.850 | 1571.8 samples/s | 24.6 steps/s
[Step=20300 Epoch=193.9] | Loss=0.00087 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.804 | FP-Norm(final)=2.850 | 4166.7 samples/s | 65.1 steps/s
[Step=20350 Epoch=194.3] | Loss=0.00075 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.788 | FP-Norm(final)=2.851 | 1623.3 samples/s | 25.4 steps/s
[Step=20400 Epoch=194.8] | Loss=0.00066 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.851 | 3988.3 samples/s | 62.3 steps/s
[Step=20450 Epoch=195.3] | Loss=0.00058 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.758 | FP-Norm(final)=2.851 | 1635.9 samples/s | 25.6 steps/s
[Step=20500 Epoch=195.8] | Loss=0.00053 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.745 | FP-Norm(final)=2.851 | 3840.9 samples/s | 60.0 steps/s
[Step=20550 Epoch=196.2] | Loss=0.00048 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.733 | FP-Norm(final)=2.851 | 1681.3 samples/s | 26.3 steps/s
[Step=20600 Epoch=196.7] | Loss=0.00044 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.722 | FP-Norm(final)=2.852 | 3651.4 samples/s | 57.1 steps/s
[Step=20650 Epoch=197.2] | Loss=0.00041 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.711 | FP-Norm(final)=2.852 | 1717.8 samples/s | 26.8 steps/s
[Step=20700 Epoch=197.7] | Loss=0.00038 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.701 | FP-Norm(final)=2.852 | 3541.6 samples/s | 55.3 steps/s
[Step=20750 Epoch=198.1] | Loss=0.00036 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.691 | FP-Norm(final)=2.852 | 1709.6 samples/s | 26.7 steps/s
[Step=20800 Epoch=198.6] | Loss=0.00034 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.682 | FP-Norm(final)=2.852 | 3634.6 samples/s | 56.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step20800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=188.5] | Loss=0.17993 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.845 | 3579.3 samples/s | 55.9 steps/s
[Step=20050 Epoch=188.9] | Loss=0.00697 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.850 | FP-Norm(final)=2.840 | 3344.0 samples/s | 52.3 steps/s
[Step=20100 Epoch=189.4] | Loss=0.00364 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.890 | FP-Norm(final)=2.840 | 4594.6 samples/s | 71.8 steps/s
[Step=20150 Epoch=189.9] | Loss=0.00250 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.889 | FP-Norm(final)=2.841 | 1564.2 samples/s | 24.4 steps/s
[Step=20200 Epoch=190.3] | Loss=0.00188 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.875 | FP-Norm(final)=2.841 | 4282.0 samples/s | 66.9 steps/s
[Step=20250 Epoch=190.8] | Loss=0.00151 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.858 | FP-Norm(final)=2.842 | 1619.6 samples/s | 25.3 steps/s
[Step=20300 Epoch=191.3] | Loss=0.00126 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.841 | FP-Norm(final)=2.842 | 3954.1 samples/s | 61.8 steps/s
[Step=20350 Epoch=191.8] | Loss=0.00108 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.843 | 1653.1 samples/s | 25.8 steps/s
[Step=20400 Epoch=192.2] | Loss=0.00095 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.811 | FP-Norm(final)=2.843 | 3727.4 samples/s | 58.2 steps/s
[Step=20450 Epoch=192.7] | Loss=0.00085 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.797 | FP-Norm(final)=2.843 | 1689.7 samples/s | 26.4 steps/s
[Step=20500 Epoch=193.2] | Loss=0.00076 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.784 | FP-Norm(final)=2.843 | 3578.8 samples/s | 55.9 steps/s
[Step=20550 Epoch=193.6] | Loss=0.00069 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.844 | 1722.2 samples/s | 26.9 steps/s
[Step=20600 Epoch=194.1] | Loss=0.00064 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.761 | FP-Norm(final)=2.844 | 3594.3 samples/s | 56.2 steps/s
[Step=20650 Epoch=194.6] | Loss=0.00059 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.750 | FP-Norm(final)=2.844 | 1222.9 samples/s | 19.1 steps/s
[Step=20700 Epoch=195.1] | Loss=0.00055 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.739 | FP-Norm(final)=2.844 | 3600.0 samples/s | 56.2 steps/s
[Step=20750 Epoch=195.5] | Loss=0.00051 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.730 | FP-Norm(final)=2.845 | 1743.3 samples/s | 27.2 steps/s
[Step=20800 Epoch=196.0] | Loss=0.00048 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.720 | FP-Norm(final)=2.845 | 3239.6 samples/s | 50.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step20800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=190.6] | Loss=0.05740 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.846 | 3684.4 samples/s | 57.6 steps/s
[Step=20050 Epoch=191.1] | Loss=0.00660 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.851 | FP-Norm(final)=2.838 | 3301.7 samples/s | 51.6 steps/s
[Step=20100 Epoch=191.6] | Loss=0.00362 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.909 | FP-Norm(final)=2.839 | 4721.7 samples/s | 73.8 steps/s
[Step=20150 Epoch=192.0] | Loss=0.00245 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.910 | FP-Norm(final)=2.841 | 1555.6 samples/s | 24.3 steps/s
[Step=20200 Epoch=192.5] | Loss=0.00185 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.897 | FP-Norm(final)=2.842 | 4455.8 samples/s | 69.6 steps/s
[Step=20250 Epoch=193.0] | Loss=0.00149 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.881 | FP-Norm(final)=2.843 | 1576.1 samples/s | 24.6 steps/s
[Step=20300 Epoch=193.5] | Loss=0.00124 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.866 | FP-Norm(final)=2.843 | 4214.9 samples/s | 65.9 steps/s
[Step=20350 Epoch=194.0] | Loss=0.00107 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.851 | FP-Norm(final)=2.844 | 1614.0 samples/s | 25.2 steps/s
[Step=20400 Epoch=194.4] | Loss=0.00094 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.837 | FP-Norm(final)=2.844 | 3997.3 samples/s | 62.5 steps/s
[Step=20450 Epoch=194.9] | Loss=0.00084 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.824 | FP-Norm(final)=2.845 | 1636.6 samples/s | 25.6 steps/s
[Step=20500 Epoch=195.4] | Loss=0.00075 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.845 | 3790.2 samples/s | 59.2 steps/s
[Step=20550 Epoch=195.9] | Loss=0.00069 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.800 | FP-Norm(final)=2.846 | 1651.2 samples/s | 25.8 steps/s
[Step=20600 Epoch=196.3] | Loss=0.00063 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.789 | FP-Norm(final)=2.846 | 3654.0 samples/s | 57.1 steps/s
[Step=20650 Epoch=196.8] | Loss=0.00058 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.779 | FP-Norm(final)=2.847 | 1688.2 samples/s | 26.4 steps/s
[Step=20700 Epoch=197.3] | Loss=0.00054 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.769 | FP-Norm(final)=2.847 | 3641.1 samples/s | 56.9 steps/s
[Step=20750 Epoch=197.8] | Loss=0.00051 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.760 | FP-Norm(final)=2.847 | 1718.3 samples/s | 26.8 steps/s
[Step=20800 Epoch=198.2] | Loss=0.00048 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.751 | FP-Norm(final)=2.848 | 3602.0 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21289 | acc=0.8748 | tpr=0.8247 | fpr=0.0166 | 3819.2 samples/s | 14.9 steps/s
Avg test loss: 0.21455, Avg test acc: 0.87447, Avg tpr: 0.82584, Avg fpr: 0.01859, total FA: 145

Testing server on iccad2012
[Step=  50] | Loss=0.52691 | acc=0.8377 | tpr=0.9823 | fpr=0.1649 | 3671.8 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.54644 | acc=0.8346 | tpr=0.9787 | fpr=0.1681 | 6997.2 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.55690 | acc=0.8319 | tpr=0.9741 | fpr=0.1707 | 7003.0 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.55705 | acc=0.8320 | tpr=0.9770 | fpr=0.1706 | 6936.8 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.55482 | acc=0.8319 | tpr=0.9729 | fpr=0.1707 | 6730.3 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.55897 | acc=0.8315 | tpr=0.9702 | fpr=0.1710 | 7020.3 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.55920 | acc=0.8317 | tpr=0.9706 | fpr=0.1708 | 6934.5 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.55999 | acc=0.8315 | tpr=0.9716 | fpr=0.1711 | 7081.5 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.56382 | acc=0.8314 | tpr=0.9713 | fpr=0.1711 | 6806.2 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.56466 | acc=0.8311 | tpr=0.9722 | fpr=0.1715 | 6857.1 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.56400 | acc=0.8312 | tpr=0.9725 | fpr=0.1714 | 12418.4 samples/s | 48.5 steps/s
Avg test loss: 0.56396, Avg test acc: 0.83123, Avg tpr: 0.97266, Avg fpr: 0.17135, total FA: 23791

server round 26/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.4] | Loss=0.17665 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.865 | 3875.2 samples/s | 60.6 steps/s
[Step=20850 Epoch=101.7] | Loss=0.02410 | Reg=0.00047 | acc=0.9688 | FP-Norm=0.655 | FP-Norm(final)=2.860 | 3503.6 samples/s | 54.7 steps/s
[Step=20900 Epoch=101.9] | Loss=0.01890 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.722 | FP-Norm(final)=2.859 | 3814.6 samples/s | 59.6 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01686 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.749 | FP-Norm(final)=2.859 | 3805.4 samples/s | 59.5 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01479 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.765 | FP-Norm(final)=2.859 | 4872.8 samples/s | 76.1 steps/s
[Step=21050 Epoch=102.6] | Loss=0.01336 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.776 | FP-Norm(final)=2.860 | 1649.9 samples/s | 25.8 steps/s
[Step=21100 Epoch=102.9] | Loss=0.01235 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.780 | FP-Norm(final)=2.862 | 3798.6 samples/s | 59.4 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01142 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.863 | 3814.8 samples/s | 59.6 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01097 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.865 | 4594.1 samples/s | 71.8 steps/s
[Step=21250 Epoch=103.6] | Loss=0.01028 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.866 | 1677.0 samples/s | 26.2 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00972 | Reg=0.00061 | acc=0.9844 | FP-Norm=0.777 | FP-Norm(final)=2.867 | 3765.6 samples/s | 58.8 steps/s
[Step=21350 Epoch=104.1] | Loss=0.00943 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.776 | FP-Norm(final)=2.868 | 3767.4 samples/s | 58.9 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00914 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.869 | 4289.8 samples/s | 67.0 steps/s
[Step=21450 Epoch=104.6] | Loss=0.00874 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.870 | 1716.6 samples/s | 26.8 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00839 | Reg=0.00060 | acc=0.9688 | FP-Norm=0.775 | FP-Norm(final)=2.871 | 3755.9 samples/s | 58.7 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00808 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.872 | 3799.5 samples/s | 59.4 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00787 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.774 | FP-Norm(final)=2.873 | 4062.5 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step21600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.5] | Loss=0.10164 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.865 | 3612.1 samples/s | 56.4 steps/s
[Step=20850 Epoch=101.7] | Loss=0.02395 | Reg=0.00051 | acc=0.9844 | FP-Norm=0.678 | FP-Norm(final)=2.861 | 3636.9 samples/s | 56.8 steps/s
[Step=20900 Epoch=102.0] | Loss=0.01788 | Reg=0.00057 | acc=0.9844 | FP-Norm=0.737 | FP-Norm(final)=2.859 | 3808.1 samples/s | 59.5 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01565 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.861 | 3792.9 samples/s | 59.3 steps/s
[Step=21000 Epoch=102.5] | Loss=0.01396 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.863 | 4880.5 samples/s | 76.3 steps/s
[Step=21050 Epoch=102.7] | Loss=0.01248 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.795 | FP-Norm(final)=2.865 | 1612.8 samples/s | 25.2 steps/s
[Step=21100 Epoch=103.0] | Loss=0.01139 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.798 | FP-Norm(final)=2.867 | 3788.7 samples/s | 59.2 steps/s
[Step=21150 Epoch=103.2] | Loss=0.01051 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.796 | FP-Norm(final)=2.869 | 3786.9 samples/s | 59.2 steps/s
[Step=21200 Epoch=103.4] | Loss=0.00994 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.793 | FP-Norm(final)=2.871 | 4562.0 samples/s | 71.3 steps/s
[Step=21250 Epoch=103.7] | Loss=0.00936 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.790 | FP-Norm(final)=2.873 | 1647.2 samples/s | 25.7 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00896 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.787 | FP-Norm(final)=2.874 | 3837.2 samples/s | 60.0 steps/s
[Step=21350 Epoch=104.2] | Loss=0.00856 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.784 | FP-Norm(final)=2.876 | 3743.8 samples/s | 58.5 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00826 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.781 | FP-Norm(final)=2.877 | 4396.8 samples/s | 68.7 steps/s
[Step=21450 Epoch=104.7] | Loss=0.00791 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.879 | 1681.5 samples/s | 26.3 steps/s
[Step=21500 Epoch=104.9] | Loss=0.00756 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.880 | 3772.1 samples/s | 58.9 steps/s
[Step=21550 Epoch=105.2] | Loss=0.00741 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.772 | FP-Norm(final)=2.881 | 3771.4 samples/s | 58.9 steps/s
[Step=21600 Epoch=105.4] | Loss=0.00724 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.771 | FP-Norm(final)=2.883 | 4217.7 samples/s | 65.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step21600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.4] | Loss=0.10197 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.865 | 3749.9 samples/s | 58.6 steps/s
[Step=20850 Epoch=101.6] | Loss=0.02086 | Reg=0.00051 | acc=0.9688 | FP-Norm=0.681 | FP-Norm(final)=2.865 | 3559.9 samples/s | 55.6 steps/s
[Step=20900 Epoch=101.8] | Loss=0.01628 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.750 | FP-Norm(final)=2.864 | 3744.8 samples/s | 58.5 steps/s
[Step=20950 Epoch=102.1] | Loss=0.01498 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.776 | FP-Norm(final)=2.864 | 3779.3 samples/s | 59.1 steps/s
[Step=21000 Epoch=102.3] | Loss=0.01456 | Reg=0.00065 | acc=0.9688 | FP-Norm=0.794 | FP-Norm(final)=2.865 | 4816.4 samples/s | 75.3 steps/s
[Step=21050 Epoch=102.6] | Loss=0.01330 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.806 | FP-Norm(final)=2.865 | 1627.8 samples/s | 25.4 steps/s
[Step=21100 Epoch=102.8] | Loss=0.01198 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.867 | 3792.7 samples/s | 59.3 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01107 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.869 | 3758.3 samples/s | 58.7 steps/s
[Step=21200 Epoch=103.3] | Loss=0.01059 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.871 | 4565.1 samples/s | 71.3 steps/s
[Step=21250 Epoch=103.5] | Loss=0.00992 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.817 | FP-Norm(final)=2.872 | 1661.5 samples/s | 26.0 steps/s
[Step=21300 Epoch=103.8] | Loss=0.00958 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.817 | FP-Norm(final)=2.874 | 3788.5 samples/s | 59.2 steps/s
[Step=21350 Epoch=104.0] | Loss=0.00930 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.876 | 3778.3 samples/s | 59.0 steps/s
[Step=21400 Epoch=104.3] | Loss=0.00884 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.814 | FP-Norm(final)=2.877 | 4290.8 samples/s | 67.0 steps/s
[Step=21450 Epoch=104.5] | Loss=0.00846 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.879 | 1675.2 samples/s | 26.2 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00811 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.810 | FP-Norm(final)=2.880 | 3771.2 samples/s | 58.9 steps/s
[Step=21550 Epoch=105.0] | Loss=0.00794 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.809 | FP-Norm(final)=2.882 | 3760.2 samples/s | 58.8 steps/s
[Step=21600 Epoch=105.2] | Loss=0.00770 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.883 | 4063.0 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step21600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.4] | Loss=0.05918 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.865 | 3902.3 samples/s | 61.0 steps/s
[Step=20850 Epoch=101.7] | Loss=0.01996 | Reg=0.00046 | acc=0.9844 | FP-Norm=0.646 | FP-Norm(final)=2.865 | 3396.2 samples/s | 53.1 steps/s
[Step=20900 Epoch=101.9] | Loss=0.01597 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.716 | FP-Norm(final)=2.864 | 3774.7 samples/s | 59.0 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01356 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.744 | FP-Norm(final)=2.865 | 3773.2 samples/s | 59.0 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01267 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.759 | FP-Norm(final)=2.867 | 4855.0 samples/s | 75.9 steps/s
[Step=21050 Epoch=102.7] | Loss=0.01118 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.768 | FP-Norm(final)=2.869 | 1632.4 samples/s | 25.5 steps/s
[Step=21100 Epoch=102.9] | Loss=0.00996 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.769 | FP-Norm(final)=2.871 | 3768.0 samples/s | 58.9 steps/s
[Step=21150 Epoch=103.1] | Loss=0.00944 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.771 | FP-Norm(final)=2.873 | 3810.6 samples/s | 59.5 steps/s
[Step=21200 Epoch=103.4] | Loss=0.00935 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.875 | 4545.0 samples/s | 71.0 steps/s
[Step=21250 Epoch=103.6] | Loss=0.00896 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.876 | 1653.1 samples/s | 25.8 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00849 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.877 | 3781.6 samples/s | 59.1 steps/s
[Step=21350 Epoch=104.1] | Loss=0.00844 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.771 | FP-Norm(final)=2.878 | 3786.2 samples/s | 59.2 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00816 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.879 | 4311.2 samples/s | 67.4 steps/s
[Step=21450 Epoch=104.6] | Loss=0.00776 | Reg=0.00060 | acc=0.9688 | FP-Norm=0.772 | FP-Norm(final)=2.880 | 1684.1 samples/s | 26.3 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00755 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.881 | 3783.2 samples/s | 59.1 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00727 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.771 | FP-Norm(final)=2.882 | 3782.5 samples/s | 59.1 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00714 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.883 | 4087.4 samples/s | 63.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step21600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=102.0] | Loss=0.13419 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.865 | 3628.4 samples/s | 56.7 steps/s
[Step=20850 Epoch=102.2] | Loss=0.02686 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.648 | FP-Norm(final)=2.857 | 3714.1 samples/s | 58.0 steps/s
[Step=20900 Epoch=102.5] | Loss=0.02051 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.730 | FP-Norm(final)=2.854 | 3755.7 samples/s | 58.7 steps/s
[Step=20950 Epoch=102.7] | Loss=0.01697 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.764 | FP-Norm(final)=2.854 | 3792.4 samples/s | 59.3 steps/s
[Step=21000 Epoch=103.0] | Loss=0.01535 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.854 | 4936.7 samples/s | 77.1 steps/s
[Step=21050 Epoch=103.2] | Loss=0.01363 | Reg=0.00063 | acc=0.9844 | FP-Norm=0.784 | FP-Norm(final)=2.856 | 1629.2 samples/s | 25.5 steps/s
[Step=21100 Epoch=103.5] | Loss=0.01219 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.787 | FP-Norm(final)=2.858 | 3762.5 samples/s | 58.8 steps/s
[Step=21150 Epoch=103.7] | Loss=0.01115 | Reg=0.00063 | acc=0.9844 | FP-Norm=0.789 | FP-Norm(final)=2.860 | 3785.8 samples/s | 59.2 steps/s
[Step=21200 Epoch=104.0] | Loss=0.01034 | Reg=0.00063 | acc=0.9844 | FP-Norm=0.790 | FP-Norm(final)=2.862 | 4664.2 samples/s | 72.9 steps/s
[Step=21250 Epoch=104.2] | Loss=0.00990 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.790 | FP-Norm(final)=2.864 | 1654.2 samples/s | 25.8 steps/s
[Step=21300 Epoch=104.5] | Loss=0.00927 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.789 | FP-Norm(final)=2.866 | 3757.7 samples/s | 58.7 steps/s
[Step=21350 Epoch=104.7] | Loss=0.00879 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.788 | FP-Norm(final)=2.868 | 3794.7 samples/s | 59.3 steps/s
[Step=21400 Epoch=104.9] | Loss=0.00844 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.870 | 4525.0 samples/s | 70.7 steps/s
[Step=21450 Epoch=105.2] | Loss=0.00802 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.785 | FP-Norm(final)=2.872 | 1671.1 samples/s | 26.1 steps/s
[Step=21500 Epoch=105.4] | Loss=0.00767 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.784 | FP-Norm(final)=2.873 | 3792.1 samples/s | 59.3 steps/s
[Step=21550 Epoch=105.7] | Loss=0.00736 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.783 | FP-Norm(final)=2.875 | 3759.1 samples/s | 58.7 steps/s
[Step=21600 Epoch=105.9] | Loss=0.00735 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.783 | FP-Norm(final)=2.877 | 4394.6 samples/s | 68.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step21600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=197.1] | Loss=0.20026 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.865 | 3638.3 samples/s | 56.8 steps/s
[Step=20850 Epoch=197.6] | Loss=0.01203 | Reg=0.00124 | acc=1.0000 | FP-Norm=1.064 | FP-Norm(final)=2.860 | 3184.1 samples/s | 49.8 steps/s
[Step=20900 Epoch=198.0] | Loss=0.00651 | Reg=0.00138 | acc=1.0000 | FP-Norm=1.150 | FP-Norm(final)=2.857 | 4681.4 samples/s | 73.1 steps/s
[Step=20950 Epoch=198.5] | Loss=0.00440 | Reg=0.00136 | acc=1.0000 | FP-Norm=1.149 | FP-Norm(final)=2.857 | 1544.8 samples/s | 24.1 steps/s
[Step=21000 Epoch=199.0] | Loss=0.00331 | Reg=0.00131 | acc=1.0000 | FP-Norm=1.131 | FP-Norm(final)=2.858 | 4360.4 samples/s | 68.1 steps/s
[Step=21050 Epoch=199.5] | Loss=0.00266 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.111 | FP-Norm(final)=2.858 | 1576.2 samples/s | 24.6 steps/s
[Step=21100 Epoch=199.9] | Loss=0.00222 | Reg=0.00121 | acc=1.0000 | FP-Norm=1.091 | FP-Norm(final)=2.858 | 4066.7 samples/s | 63.5 steps/s
[Step=21150 Epoch=200.4] | Loss=0.00191 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.072 | FP-Norm(final)=2.859 | 1627.1 samples/s | 25.4 steps/s
[Step=21200 Epoch=200.9] | Loss=0.00167 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.054 | FP-Norm(final)=2.859 | 3837.3 samples/s | 60.0 steps/s
[Step=21250 Epoch=201.4] | Loss=0.00149 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.037 | FP-Norm(final)=2.859 | 1661.8 samples/s | 26.0 steps/s
[Step=21300 Epoch=201.8] | Loss=0.00134 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.021 | FP-Norm(final)=2.859 | 3636.5 samples/s | 56.8 steps/s
[Step=21350 Epoch=202.3] | Loss=0.00122 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.007 | FP-Norm(final)=2.860 | 1709.4 samples/s | 26.7 steps/s
[Step=21400 Epoch=202.8] | Loss=0.00112 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.993 | FP-Norm(final)=2.860 | 3564.8 samples/s | 55.7 steps/s
[Step=21450 Epoch=203.3] | Loss=0.00104 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.980 | FP-Norm(final)=2.860 | 1722.8 samples/s | 26.9 steps/s
[Step=21500 Epoch=203.7] | Loss=0.00096 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.967 | FP-Norm(final)=2.860 | 3574.9 samples/s | 55.9 steps/s
[Step=21550 Epoch=204.2] | Loss=0.00090 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.955 | FP-Norm(final)=2.861 | 1729.1 samples/s | 27.0 steps/s
[Step=21600 Epoch=204.7] | Loss=0.00085 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.944 | FP-Norm(final)=2.861 | 3519.5 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step21600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=197.9] | Loss=0.18189 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.865 | 3544.1 samples/s | 55.4 steps/s
[Step=20850 Epoch=198.3] | Loss=0.01014 | Reg=0.00116 | acc=1.0000 | FP-Norm=1.036 | FP-Norm(final)=2.856 | 3352.0 samples/s | 52.4 steps/s
[Step=20900 Epoch=198.8] | Loss=0.00520 | Reg=0.00126 | acc=1.0000 | FP-Norm=1.100 | FP-Norm(final)=2.855 | 4701.6 samples/s | 73.5 steps/s
[Step=20950 Epoch=199.3] | Loss=0.00353 | Reg=0.00123 | acc=1.0000 | FP-Norm=1.095 | FP-Norm(final)=2.855 | 1551.0 samples/s | 24.2 steps/s
[Step=21000 Epoch=199.8] | Loss=0.00266 | Reg=0.00118 | acc=1.0000 | FP-Norm=1.076 | FP-Norm(final)=2.855 | 4329.7 samples/s | 67.7 steps/s
[Step=21050 Epoch=200.2] | Loss=0.00213 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.055 | FP-Norm(final)=2.856 | 1584.9 samples/s | 24.8 steps/s
[Step=21100 Epoch=200.7] | Loss=0.00178 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.034 | FP-Norm(final)=2.856 | 4083.9 samples/s | 63.8 steps/s
[Step=21150 Epoch=201.2] | Loss=0.00153 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.014 | FP-Norm(final)=2.856 | 1639.0 samples/s | 25.6 steps/s
[Step=21200 Epoch=201.7] | Loss=0.00134 | Reg=0.00101 | acc=1.0000 | FP-Norm=0.996 | FP-Norm(final)=2.857 | 3860.2 samples/s | 60.3 steps/s
[Step=21250 Epoch=202.1] | Loss=0.00119 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.979 | FP-Norm(final)=2.857 | 1671.1 samples/s | 26.1 steps/s
[Step=21300 Epoch=202.6] | Loss=0.00107 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.963 | FP-Norm(final)=2.857 | 3635.9 samples/s | 56.8 steps/s
[Step=21350 Epoch=203.1] | Loss=0.00098 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.948 | FP-Norm(final)=2.858 | 1708.5 samples/s | 26.7 steps/s
[Step=21400 Epoch=203.6] | Loss=0.00090 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.934 | FP-Norm(final)=2.858 | 3611.0 samples/s | 56.4 steps/s
[Step=21450 Epoch=204.0] | Loss=0.00083 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.921 | FP-Norm(final)=2.858 | 1746.5 samples/s | 27.3 steps/s
[Step=21500 Epoch=204.5] | Loss=0.00077 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.908 | FP-Norm(final)=2.858 | 3557.0 samples/s | 55.6 steps/s
[Step=21550 Epoch=205.0] | Loss=0.00072 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.896 | FP-Norm(final)=2.859 | 1731.4 samples/s | 27.1 steps/s
[Step=21600 Epoch=205.5] | Loss=0.00068 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.885 | FP-Norm(final)=2.859 | 3568.8 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step21600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=198.6] | Loss=0.14942 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.865 | 3320.1 samples/s | 51.9 steps/s
[Step=20850 Epoch=199.1] | Loss=0.00803 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.961 | FP-Norm(final)=2.859 | 3548.5 samples/s | 55.4 steps/s
[Step=20900 Epoch=199.6] | Loss=0.00438 | Reg=0.00107 | acc=1.0000 | FP-Norm=1.012 | FP-Norm(final)=2.858 | 4657.7 samples/s | 72.8 steps/s
[Step=20950 Epoch=200.1] | Loss=0.00295 | Reg=0.00104 | acc=1.0000 | FP-Norm=1.006 | FP-Norm(final)=2.859 | 1557.0 samples/s | 24.3 steps/s
[Step=21000 Epoch=200.5] | Loss=0.00222 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.987 | FP-Norm(final)=2.859 | 4385.5 samples/s | 68.5 steps/s
[Step=21050 Epoch=201.0] | Loss=0.00179 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.967 | FP-Norm(final)=2.860 | 1564.3 samples/s | 24.4 steps/s
[Step=21100 Epoch=201.5] | Loss=0.00149 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.947 | FP-Norm(final)=2.860 | 4132.7 samples/s | 64.6 steps/s
[Step=21150 Epoch=202.0] | Loss=0.00128 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.929 | FP-Norm(final)=2.860 | 1607.6 samples/s | 25.1 steps/s
[Step=21200 Epoch=202.4] | Loss=0.00112 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.912 | FP-Norm(final)=2.860 | 3994.3 samples/s | 62.4 steps/s
[Step=21250 Epoch=202.9] | Loss=0.00100 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.897 | FP-Norm(final)=2.861 | 1646.8 samples/s | 25.7 steps/s
[Step=21300 Epoch=203.4] | Loss=0.00090 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.882 | FP-Norm(final)=2.861 | 3752.3 samples/s | 58.6 steps/s
[Step=21350 Epoch=203.9] | Loss=0.00082 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.869 | FP-Norm(final)=2.861 | 1674.9 samples/s | 26.2 steps/s
[Step=21400 Epoch=204.4] | Loss=0.00076 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.856 | FP-Norm(final)=2.862 | 3656.0 samples/s | 57.1 steps/s
[Step=21450 Epoch=204.8] | Loss=0.00070 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.844 | FP-Norm(final)=2.862 | 1716.2 samples/s | 26.8 steps/s
[Step=21500 Epoch=205.3] | Loss=0.00065 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.832 | FP-Norm(final)=2.862 | 3550.6 samples/s | 55.5 steps/s
[Step=21550 Epoch=205.8] | Loss=0.00061 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.821 | FP-Norm(final)=2.862 | 1715.9 samples/s | 26.8 steps/s
[Step=21600 Epoch=206.3] | Loss=0.00057 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.811 | FP-Norm(final)=2.863 | 3605.2 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step21600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=196.0] | Loss=0.05428 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.866 | 3649.6 samples/s | 57.0 steps/s
[Step=20850 Epoch=196.5] | Loss=0.00205 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.870 | 3366.9 samples/s | 52.6 steps/s
[Step=20900 Epoch=196.9] | Loss=0.00116 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.789 | FP-Norm(final)=2.871 | 4581.5 samples/s | 71.6 steps/s
[Step=20950 Epoch=197.4] | Loss=0.00079 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.872 | 1558.8 samples/s | 24.4 steps/s
[Step=21000 Epoch=197.9] | Loss=0.00059 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.759 | FP-Norm(final)=2.872 | 4213.0 samples/s | 65.8 steps/s
[Step=21050 Epoch=198.4] | Loss=0.00048 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.741 | FP-Norm(final)=2.873 | 1596.2 samples/s | 24.9 steps/s
[Step=21100 Epoch=198.8] | Loss=0.00040 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.723 | FP-Norm(final)=2.873 | 3896.9 samples/s | 60.9 steps/s
[Step=21150 Epoch=199.3] | Loss=0.00035 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.708 | FP-Norm(final)=2.873 | 1635.6 samples/s | 25.6 steps/s
[Step=21200 Epoch=199.8] | Loss=0.00030 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.694 | FP-Norm(final)=2.873 | 3699.0 samples/s | 57.8 steps/s
[Step=21250 Epoch=200.2] | Loss=0.00027 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.681 | FP-Norm(final)=2.873 | 1701.3 samples/s | 26.6 steps/s
[Step=21300 Epoch=200.7] | Loss=0.00025 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.668 | FP-Norm(final)=2.873 | 3544.7 samples/s | 55.4 steps/s
[Step=21350 Epoch=201.2] | Loss=0.00022 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.657 | FP-Norm(final)=2.873 | 1697.6 samples/s | 26.5 steps/s
[Step=21400 Epoch=201.6] | Loss=0.00021 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.646 | FP-Norm(final)=2.873 | 3605.5 samples/s | 56.3 steps/s
[Step=21450 Epoch=202.1] | Loss=0.00019 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.636 | FP-Norm(final)=2.874 | 1703.8 samples/s | 26.6 steps/s
[Step=21500 Epoch=202.6] | Loss=0.00018 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.627 | FP-Norm(final)=2.874 | 3510.4 samples/s | 54.8 steps/s
[Step=21550 Epoch=203.1] | Loss=0.00017 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.618 | FP-Norm(final)=2.874 | 1918.4 samples/s | 30.0 steps/s
[Step=21600 Epoch=203.5] | Loss=0.00016 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=2.874 | 2967.4 samples/s | 46.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step21600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=198.3] | Loss=0.09147 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.865 | 3569.6 samples/s | 55.8 steps/s
[Step=20850 Epoch=198.7] | Loss=0.00726 | Reg=0.00103 | acc=1.0000 | FP-Norm=0.972 | FP-Norm(final)=2.864 | 3326.0 samples/s | 52.0 steps/s
[Step=20900 Epoch=199.2] | Loss=0.00386 | Reg=0.00112 | acc=1.0000 | FP-Norm=1.038 | FP-Norm(final)=2.862 | 4711.6 samples/s | 73.6 steps/s
[Step=20950 Epoch=199.7] | Loss=0.00259 | Reg=0.00110 | acc=1.0000 | FP-Norm=1.036 | FP-Norm(final)=2.862 | 1547.2 samples/s | 24.2 steps/s
[Step=21000 Epoch=200.1] | Loss=0.00195 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.018 | FP-Norm(final)=2.862 | 4315.5 samples/s | 67.4 steps/s
[Step=21050 Epoch=200.6] | Loss=0.00157 | Reg=0.00102 | acc=1.0000 | FP-Norm=0.999 | FP-Norm(final)=2.863 | 1563.8 samples/s | 24.4 steps/s
[Step=21100 Epoch=201.1] | Loss=0.00131 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.980 | FP-Norm(final)=2.863 | 4084.6 samples/s | 63.8 steps/s
[Step=21150 Epoch=201.6] | Loss=0.00112 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.962 | FP-Norm(final)=2.863 | 1616.6 samples/s | 25.3 steps/s
[Step=21200 Epoch=202.1] | Loss=0.00099 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.945 | FP-Norm(final)=2.863 | 3998.5 samples/s | 62.5 steps/s
[Step=21250 Epoch=202.5] | Loss=0.00088 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.930 | FP-Norm(final)=2.863 | 1638.7 samples/s | 25.6 steps/s
[Step=21300 Epoch=203.0] | Loss=0.00079 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.915 | FP-Norm(final)=2.864 | 3797.0 samples/s | 59.3 steps/s
[Step=21350 Epoch=203.5] | Loss=0.00072 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.902 | FP-Norm(final)=2.864 | 1652.5 samples/s | 25.8 steps/s
[Step=21400 Epoch=204.0] | Loss=0.00066 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.889 | FP-Norm(final)=2.864 | 3625.1 samples/s | 56.6 steps/s
[Step=21450 Epoch=204.4] | Loss=0.00061 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.864 | 1698.7 samples/s | 26.5 steps/s
[Step=21500 Epoch=204.9] | Loss=0.00057 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.866 | FP-Norm(final)=2.864 | 3569.7 samples/s | 55.8 steps/s
[Step=21550 Epoch=205.4] | Loss=0.00053 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.855 | FP-Norm(final)=2.865 | 1714.7 samples/s | 26.8 steps/s
[Step=21600 Epoch=205.9] | Loss=0.00050 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.844 | FP-Norm(final)=2.865 | 3567.6 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24983 | acc=0.8532 | tpr=0.7929 | fpr=0.0159 | 3588.3 samples/s | 14.0 steps/s
Avg test loss: 0.25193, Avg test acc: 0.85319, Avg tpr: 0.79431, Avg fpr: 0.01731, total FA: 135

Testing server on iccad2012
[Step=  50] | Loss=0.47605 | acc=0.8542 | tpr=0.9735 | fpr=0.1479 | 3651.6 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.49537 | acc=0.8512 | tpr=0.9765 | fpr=0.1512 | 6768.4 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.50527 | acc=0.8490 | tpr=0.9726 | fpr=0.1533 | 6861.8 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.50520 | acc=0.8496 | tpr=0.9749 | fpr=0.1526 | 6825.9 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.50318 | acc=0.8493 | tpr=0.9712 | fpr=0.1529 | 6875.1 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.50683 | acc=0.8490 | tpr=0.9695 | fpr=0.1531 | 6911.7 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.50728 | acc=0.8495 | tpr=0.9699 | fpr=0.1527 | 6843.6 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.50777 | acc=0.8492 | tpr=0.9710 | fpr=0.1530 | 6549.9 samples/s | 25.6 steps/s
[Step= 450] | Loss=0.51120 | acc=0.8491 | tpr=0.9708 | fpr=0.1531 | 6613.2 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.51206 | acc=0.8486 | tpr=0.9714 | fpr=0.1536 | 6596.7 samples/s | 25.8 steps/s
[Step= 550] | Loss=0.51138 | acc=0.8489 | tpr=0.9713 | fpr=0.1533 | 12495.4 samples/s | 48.8 steps/s
Avg test loss: 0.51134, Avg test acc: 0.84894, Avg tpr: 0.97147, Avg fpr: 0.15329, total FA: 21284

server round 27/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.3] | Loss=0.12167 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.882 | 3638.0 samples/s | 56.8 steps/s
[Step=21650 Epoch=105.6] | Loss=0.03237 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.765 | FP-Norm(final)=2.871 | 3704.8 samples/s | 57.9 steps/s
[Step=21700 Epoch=105.8] | Loss=0.02474 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.838 | FP-Norm(final)=2.868 | 3790.2 samples/s | 59.2 steps/s
[Step=21750 Epoch=106.1] | Loss=0.02115 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.859 | FP-Norm(final)=2.866 | 3770.0 samples/s | 58.9 steps/s
[Step=21800 Epoch=106.3] | Loss=0.01830 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.868 | FP-Norm(final)=2.866 | 4849.0 samples/s | 75.8 steps/s
[Step=21850 Epoch=106.5] | Loss=0.01583 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.867 | FP-Norm(final)=2.867 | 1604.9 samples/s | 25.1 steps/s
[Step=21900 Epoch=106.8] | Loss=0.01429 | Reg=0.00076 | acc=0.9844 | FP-Norm=0.863 | FP-Norm(final)=2.868 | 3712.1 samples/s | 58.0 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01307 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.861 | FP-Norm(final)=2.869 | 3699.7 samples/s | 57.8 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01210 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.858 | FP-Norm(final)=2.870 | 4516.7 samples/s | 70.6 steps/s
[Step=22050 Epoch=107.5] | Loss=0.01123 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.855 | FP-Norm(final)=2.872 | 1654.1 samples/s | 25.8 steps/s
[Step=22100 Epoch=107.8] | Loss=0.01057 | Reg=0.00073 | acc=0.9844 | FP-Norm=0.852 | FP-Norm(final)=2.874 | 3785.6 samples/s | 59.1 steps/s
[Step=22150 Epoch=108.0] | Loss=0.01014 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.849 | FP-Norm(final)=2.875 | 3802.4 samples/s | 59.4 steps/s
[Step=22200 Epoch=108.3] | Loss=0.00983 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.846 | FP-Norm(final)=2.876 | 4309.3 samples/s | 67.3 steps/s
[Step=22250 Epoch=108.5] | Loss=0.00955 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.844 | FP-Norm(final)=2.877 | 1710.0 samples/s | 26.7 steps/s
[Step=22300 Epoch=108.7] | Loss=0.00914 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.842 | FP-Norm(final)=2.878 | 3772.3 samples/s | 58.9 steps/s
[Step=22350 Epoch=109.0] | Loss=0.00881 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.841 | FP-Norm(final)=2.879 | 3719.3 samples/s | 58.1 steps/s
[Step=22400 Epoch=109.2] | Loss=0.00856 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.839 | FP-Norm(final)=2.880 | 3979.5 samples/s | 62.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step22400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.4] | Loss=0.09354 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.882 | 3691.3 samples/s | 57.7 steps/s
[Step=21650 Epoch=105.6] | Loss=0.01825 | Reg=0.00042 | acc=0.9844 | FP-Norm=0.622 | FP-Norm(final)=2.883 | 3595.8 samples/s | 56.2 steps/s
[Step=21700 Epoch=105.9] | Loss=0.01383 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.692 | FP-Norm(final)=2.886 | 3737.7 samples/s | 58.4 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01270 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.723 | FP-Norm(final)=2.889 | 3761.8 samples/s | 58.8 steps/s
[Step=21800 Epoch=106.4] | Loss=0.01210 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.746 | FP-Norm(final)=2.891 | 4794.9 samples/s | 74.9 steps/s
[Step=21850 Epoch=106.6] | Loss=0.01061 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.761 | FP-Norm(final)=2.894 | 1612.0 samples/s | 25.2 steps/s
[Step=21900 Epoch=106.9] | Loss=0.00979 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.897 | 3783.5 samples/s | 59.1 steps/s
[Step=21950 Epoch=107.1] | Loss=0.00946 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.769 | FP-Norm(final)=2.899 | 3766.2 samples/s | 58.8 steps/s
[Step=22000 Epoch=107.3] | Loss=0.00900 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.771 | FP-Norm(final)=2.901 | 4588.9 samples/s | 71.7 steps/s
[Step=22050 Epoch=107.6] | Loss=0.00843 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.903 | 1622.4 samples/s | 25.4 steps/s
[Step=22100 Epoch=107.8] | Loss=0.00839 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.904 | 3700.8 samples/s | 57.8 steps/s
[Step=22150 Epoch=108.1] | Loss=0.00798 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.905 | 3699.4 samples/s | 57.8 steps/s
[Step=22200 Epoch=108.3] | Loss=0.00767 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.906 | 4317.6 samples/s | 67.5 steps/s
[Step=22250 Epoch=108.6] | Loss=0.00744 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.772 | FP-Norm(final)=2.907 | 1665.4 samples/s | 26.0 steps/s
[Step=22300 Epoch=108.8] | Loss=0.00728 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.908 | 3802.1 samples/s | 59.4 steps/s
[Step=22350 Epoch=109.1] | Loss=0.00712 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.909 | 3802.3 samples/s | 59.4 steps/s
[Step=22400 Epoch=109.3] | Loss=0.00705 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.910 | 4191.2 samples/s | 65.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step22400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.3] | Loss=0.08885 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.882 | 3931.3 samples/s | 61.4 steps/s
[Step=21650 Epoch=105.5] | Loss=0.02619 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.723 | FP-Norm(final)=2.876 | 3307.5 samples/s | 51.7 steps/s
[Step=21700 Epoch=105.7] | Loss=0.02197 | Reg=0.00068 | acc=0.9688 | FP-Norm=0.807 | FP-Norm(final)=2.873 | 3759.5 samples/s | 58.7 steps/s
[Step=21750 Epoch=106.0] | Loss=0.01909 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.834 | FP-Norm(final)=2.871 | 3751.4 samples/s | 58.6 steps/s
[Step=21800 Epoch=106.2] | Loss=0.01619 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.844 | FP-Norm(final)=2.872 | 4848.3 samples/s | 75.8 steps/s
[Step=21850 Epoch=106.5] | Loss=0.01406 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.845 | FP-Norm(final)=2.874 | 1640.4 samples/s | 25.6 steps/s
[Step=21900 Epoch=106.7] | Loss=0.01261 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.844 | FP-Norm(final)=2.876 | 3775.9 samples/s | 59.0 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01163 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.842 | FP-Norm(final)=2.878 | 3803.3 samples/s | 59.4 steps/s
[Step=22000 Epoch=107.2] | Loss=0.01091 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.839 | FP-Norm(final)=2.880 | 4568.8 samples/s | 71.4 steps/s
[Step=22050 Epoch=107.4] | Loss=0.01009 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.836 | FP-Norm(final)=2.883 | 1670.1 samples/s | 26.1 steps/s
[Step=22100 Epoch=107.7] | Loss=0.00934 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.834 | FP-Norm(final)=2.885 | 3683.0 samples/s | 57.5 steps/s
[Step=22150 Epoch=107.9] | Loss=0.00899 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.831 | FP-Norm(final)=2.887 | 3689.7 samples/s | 57.7 steps/s
[Step=22200 Epoch=108.2] | Loss=0.00881 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.828 | FP-Norm(final)=2.889 | 4305.2 samples/s | 67.3 steps/s
[Step=22250 Epoch=108.4] | Loss=0.00841 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.890 | 1697.6 samples/s | 26.5 steps/s
[Step=22300 Epoch=108.7] | Loss=0.00808 | Reg=0.00069 | acc=0.9844 | FP-Norm=0.824 | FP-Norm(final)=2.892 | 3786.5 samples/s | 59.2 steps/s
[Step=22350 Epoch=108.9] | Loss=0.00775 | Reg=0.00068 | acc=0.9844 | FP-Norm=0.822 | FP-Norm(final)=2.893 | 3797.2 samples/s | 59.3 steps/s
[Step=22400 Epoch=109.1] | Loss=0.00774 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.821 | FP-Norm(final)=2.894 | 4083.5 samples/s | 63.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step22400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.3] | Loss=0.11718 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.882 | 3814.8 samples/s | 59.6 steps/s
[Step=21650 Epoch=105.6] | Loss=0.02482 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.703 | FP-Norm(final)=2.875 | 3506.4 samples/s | 54.8 steps/s
[Step=21700 Epoch=105.8] | Loss=0.01773 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.769 | FP-Norm(final)=2.874 | 3756.1 samples/s | 58.7 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01660 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.791 | FP-Norm(final)=2.876 | 3779.0 samples/s | 59.0 steps/s
[Step=21800 Epoch=106.3] | Loss=0.01492 | Reg=0.00068 | acc=0.9688 | FP-Norm=0.813 | FP-Norm(final)=2.877 | 4863.6 samples/s | 76.0 steps/s
[Step=21850 Epoch=106.6] | Loss=0.01273 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.879 | 1612.3 samples/s | 25.2 steps/s
[Step=21900 Epoch=106.8] | Loss=0.01134 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.881 | 3768.8 samples/s | 58.9 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01072 | Reg=0.00068 | acc=0.9844 | FP-Norm=0.818 | FP-Norm(final)=2.883 | 3778.0 samples/s | 59.0 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01033 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.819 | FP-Norm(final)=2.884 | 4603.9 samples/s | 71.9 steps/s
[Step=22050 Epoch=107.5] | Loss=0.00982 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.885 | 1670.1 samples/s | 26.1 steps/s
[Step=22100 Epoch=107.8] | Loss=0.00937 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.886 | 3781.9 samples/s | 59.1 steps/s
[Step=22150 Epoch=108.0] | Loss=0.00887 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.819 | FP-Norm(final)=2.887 | 3792.8 samples/s | 59.3 steps/s
[Step=22200 Epoch=108.3] | Loss=0.00853 | Reg=0.00067 | acc=0.9844 | FP-Norm=0.818 | FP-Norm(final)=2.888 | 4289.2 samples/s | 67.0 steps/s
[Step=22250 Epoch=108.5] | Loss=0.00807 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.816 | FP-Norm(final)=2.889 | 1659.3 samples/s | 25.9 steps/s
[Step=22300 Epoch=108.7] | Loss=0.00775 | Reg=0.00067 | acc=0.9844 | FP-Norm=0.815 | FP-Norm(final)=2.890 | 3722.2 samples/s | 58.2 steps/s
[Step=22350 Epoch=109.0] | Loss=0.00751 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.814 | FP-Norm(final)=2.892 | 3721.3 samples/s | 58.1 steps/s
[Step=22400 Epoch=109.2] | Loss=0.00729 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.812 | FP-Norm(final)=2.893 | 4008.1 samples/s | 62.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step22400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.9] | Loss=0.26421 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.881 | 3560.2 samples/s | 55.6 steps/s
[Step=21650 Epoch=106.2] | Loss=0.02652 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.687 | FP-Norm(final)=2.872 | 3696.5 samples/s | 57.8 steps/s
[Step=21700 Epoch=106.4] | Loss=0.02021 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.746 | FP-Norm(final)=2.869 | 3786.1 samples/s | 59.2 steps/s
[Step=21750 Epoch=106.7] | Loss=0.01670 | Reg=0.00061 | acc=0.9844 | FP-Norm=0.770 | FP-Norm(final)=2.870 | 3789.5 samples/s | 59.2 steps/s
[Step=21800 Epoch=106.9] | Loss=0.01578 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.792 | FP-Norm(final)=2.870 | 4920.6 samples/s | 76.9 steps/s
[Step=21850 Epoch=107.1] | Loss=0.01386 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.871 | 1590.4 samples/s | 24.9 steps/s
[Step=21900 Epoch=107.4] | Loss=0.01273 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.807 | FP-Norm(final)=2.872 | 3717.0 samples/s | 58.1 steps/s
[Step=21950 Epoch=107.6] | Loss=0.01154 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.808 | FP-Norm(final)=2.873 | 3771.4 samples/s | 58.9 steps/s
[Step=22000 Epoch=107.9] | Loss=0.01073 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.875 | 4684.5 samples/s | 73.2 steps/s
[Step=22050 Epoch=108.1] | Loss=0.00999 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.808 | FP-Norm(final)=2.876 | 1631.1 samples/s | 25.5 steps/s
[Step=22100 Epoch=108.4] | Loss=0.00950 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.877 | 3743.4 samples/s | 58.5 steps/s
[Step=22150 Epoch=108.6] | Loss=0.00898 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.805 | FP-Norm(final)=2.879 | 3789.7 samples/s | 59.2 steps/s
[Step=22200 Epoch=108.9] | Loss=0.00859 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.803 | FP-Norm(final)=2.880 | 4478.5 samples/s | 70.0 steps/s
[Step=22250 Epoch=109.1] | Loss=0.00809 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.881 | 1650.5 samples/s | 25.8 steps/s
[Step=22300 Epoch=109.4] | Loss=0.00766 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.799 | FP-Norm(final)=2.883 | 3781.7 samples/s | 59.1 steps/s
[Step=22350 Epoch=109.6] | Loss=0.00741 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.797 | FP-Norm(final)=2.885 | 3711.3 samples/s | 58.0 steps/s
[Step=22400 Epoch=109.8] | Loss=0.00714 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.795 | FP-Norm(final)=2.886 | 4275.0 samples/s | 66.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step22400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=204.7] | Loss=0.10336 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.882 | 3954.4 samples/s | 61.8 steps/s
[Step=21650 Epoch=205.2] | Loss=0.00619 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.735 | FP-Norm(final)=2.877 | 3278.4 samples/s | 51.2 steps/s
[Step=21700 Epoch=205.6] | Loss=0.00329 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.782 | FP-Norm(final)=2.878 | 4661.0 samples/s | 72.8 steps/s
[Step=21750 Epoch=206.1] | Loss=0.00223 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.879 | 1548.3 samples/s | 24.2 steps/s
[Step=21800 Epoch=206.6] | Loss=0.00172 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.880 | 4338.3 samples/s | 67.8 steps/s
[Step=21850 Epoch=207.0] | Loss=0.00139 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.757 | FP-Norm(final)=2.881 | 1591.9 samples/s | 24.9 steps/s
[Step=21900 Epoch=207.5] | Loss=0.00116 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.746 | FP-Norm(final)=2.881 | 4042.1 samples/s | 63.2 steps/s
[Step=21950 Epoch=208.0] | Loss=0.00100 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.735 | FP-Norm(final)=2.882 | 1618.8 samples/s | 25.3 steps/s
[Step=22000 Epoch=208.5] | Loss=0.00088 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.725 | FP-Norm(final)=2.882 | 3799.8 samples/s | 59.4 steps/s
[Step=22050 Epoch=208.9] | Loss=0.00078 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.715 | FP-Norm(final)=2.883 | 1671.7 samples/s | 26.1 steps/s
[Step=22100 Epoch=209.4] | Loss=0.00071 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.705 | FP-Norm(final)=2.883 | 3634.2 samples/s | 56.8 steps/s
[Step=22150 Epoch=209.9] | Loss=0.00064 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.696 | FP-Norm(final)=2.884 | 1694.8 samples/s | 26.5 steps/s
[Step=22200 Epoch=210.4] | Loss=0.00059 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.687 | FP-Norm(final)=2.884 | 3570.4 samples/s | 55.8 steps/s
[Step=22250 Epoch=210.8] | Loss=0.00055 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.678 | FP-Norm(final)=2.884 | 1709.5 samples/s | 26.7 steps/s
[Step=22300 Epoch=211.3] | Loss=0.00051 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.670 | FP-Norm(final)=2.885 | 3563.0 samples/s | 55.7 steps/s
[Step=22350 Epoch=211.8] | Loss=0.00048 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.663 | FP-Norm(final)=2.885 | 1704.8 samples/s | 26.6 steps/s
[Step=22400 Epoch=212.3] | Loss=0.00045 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.655 | FP-Norm(final)=2.885 | 3479.1 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step22400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=205.5] | Loss=0.07275 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.882 | 3572.2 samples/s | 55.8 steps/s
[Step=21650 Epoch=205.9] | Loss=0.00447 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.836 | FP-Norm(final)=2.881 | 3424.6 samples/s | 53.5 steps/s
[Step=21700 Epoch=206.4] | Loss=0.00234 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.873 | FP-Norm(final)=2.883 | 4666.9 samples/s | 72.9 steps/s
[Step=21750 Epoch=206.9] | Loss=0.00157 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.860 | FP-Norm(final)=2.884 | 1539.6 samples/s | 24.1 steps/s
[Step=21800 Epoch=207.4] | Loss=0.00119 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.841 | FP-Norm(final)=2.885 | 4390.0 samples/s | 68.6 steps/s
[Step=21850 Epoch=207.8] | Loss=0.00095 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.822 | FP-Norm(final)=2.886 | 1578.0 samples/s | 24.7 steps/s
[Step=21900 Epoch=208.3] | Loss=0.00080 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.805 | FP-Norm(final)=2.886 | 4055.0 samples/s | 63.4 steps/s
[Step=21950 Epoch=208.8] | Loss=0.00069 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.790 | FP-Norm(final)=2.886 | 1631.4 samples/s | 25.5 steps/s
[Step=22000 Epoch=209.3] | Loss=0.00060 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.887 | 3876.1 samples/s | 60.6 steps/s
[Step=22050 Epoch=209.8] | Loss=0.00054 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.887 | 1653.9 samples/s | 25.8 steps/s
[Step=22100 Epoch=210.2] | Loss=0.00049 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.750 | FP-Norm(final)=2.887 | 3661.3 samples/s | 57.2 steps/s
[Step=22150 Epoch=210.7] | Loss=0.00044 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.738 | FP-Norm(final)=2.888 | 1704.0 samples/s | 26.6 steps/s
[Step=22200 Epoch=211.2] | Loss=0.00041 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.727 | FP-Norm(final)=2.888 | 3540.0 samples/s | 55.3 steps/s
[Step=22250 Epoch=211.7] | Loss=0.00038 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.717 | FP-Norm(final)=2.888 | 1729.5 samples/s | 27.0 steps/s
[Step=22300 Epoch=212.1] | Loss=0.00035 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.707 | FP-Norm(final)=2.888 | 3545.8 samples/s | 55.4 steps/s
[Step=22350 Epoch=212.6] | Loss=0.00033 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.698 | FP-Norm(final)=2.888 | 1735.4 samples/s | 27.1 steps/s
[Step=22400 Epoch=213.1] | Loss=0.00031 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.689 | FP-Norm(final)=2.889 | 3569.6 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step22400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=206.3] | Loss=0.03666 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.882 | 3499.8 samples/s | 54.7 steps/s
[Step=21650 Epoch=206.7] | Loss=0.00620 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.783 | FP-Norm(final)=2.880 | 3413.6 samples/s | 53.3 steps/s
[Step=21700 Epoch=207.2] | Loss=0.00323 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.861 | FP-Norm(final)=2.880 | 4669.6 samples/s | 73.0 steps/s
[Step=21750 Epoch=207.7] | Loss=0.00216 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.865 | FP-Norm(final)=2.881 | 1527.8 samples/s | 23.9 steps/s
[Step=21800 Epoch=208.2] | Loss=0.00164 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.853 | FP-Norm(final)=2.881 | 4380.3 samples/s | 68.4 steps/s
[Step=21850 Epoch=208.7] | Loss=0.00133 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.840 | FP-Norm(final)=2.882 | 1572.5 samples/s | 24.6 steps/s
[Step=21900 Epoch=209.1] | Loss=0.00111 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.827 | FP-Norm(final)=2.882 | 4127.0 samples/s | 64.5 steps/s
[Step=21950 Epoch=209.6] | Loss=0.00095 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.883 | 1571.3 samples/s | 24.6 steps/s
[Step=22000 Epoch=210.1] | Loss=0.00084 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.800 | FP-Norm(final)=2.883 | 3950.5 samples/s | 61.7 steps/s
[Step=22050 Epoch=210.6] | Loss=0.00075 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.788 | FP-Norm(final)=2.883 | 1644.3 samples/s | 25.7 steps/s
[Step=22100 Epoch=211.0] | Loss=0.00067 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.776 | FP-Norm(final)=2.884 | 3714.0 samples/s | 58.0 steps/s
[Step=22150 Epoch=211.5] | Loss=0.00061 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.884 | 1625.8 samples/s | 25.4 steps/s
[Step=22200 Epoch=212.0] | Loss=0.00057 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.755 | FP-Norm(final)=2.884 | 3596.3 samples/s | 56.2 steps/s
[Step=22250 Epoch=212.5] | Loss=0.00052 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.745 | FP-Norm(final)=2.885 | 1667.5 samples/s | 26.1 steps/s
[Step=22300 Epoch=213.0] | Loss=0.00049 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.736 | FP-Norm(final)=2.885 | 3563.7 samples/s | 55.7 steps/s
[Step=22350 Epoch=213.4] | Loss=0.00046 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.727 | FP-Norm(final)=2.885 | 1715.6 samples/s | 26.8 steps/s
[Step=22400 Epoch=213.9] | Loss=0.00043 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.719 | FP-Norm(final)=2.885 | 3580.5 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step22400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=203.5] | Loss=0.04513 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.882 | 3474.8 samples/s | 54.3 steps/s
[Step=21650 Epoch=204.0] | Loss=0.00867 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.012 | FP-Norm(final)=2.879 | 3344.9 samples/s | 52.3 steps/s
[Step=21700 Epoch=204.5] | Loss=0.00456 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.124 | FP-Norm(final)=2.876 | 4525.3 samples/s | 70.7 steps/s
[Step=21750 Epoch=204.9] | Loss=0.00308 | Reg=0.00132 | acc=1.0000 | FP-Norm=1.131 | FP-Norm(final)=2.876 | 1547.2 samples/s | 24.2 steps/s
[Step=21800 Epoch=205.4] | Loss=0.00234 | Reg=0.00129 | acc=1.0000 | FP-Norm=1.120 | FP-Norm(final)=2.877 | 4241.0 samples/s | 66.3 steps/s
[Step=21850 Epoch=205.9] | Loss=0.00188 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.103 | FP-Norm(final)=2.877 | 1610.8 samples/s | 25.2 steps/s
[Step=21900 Epoch=206.4] | Loss=0.00157 | Reg=0.00120 | acc=1.0000 | FP-Norm=1.085 | FP-Norm(final)=2.878 | 3890.3 samples/s | 60.8 steps/s
[Step=21950 Epoch=206.8] | Loss=0.00135 | Reg=0.00116 | acc=1.0000 | FP-Norm=1.067 | FP-Norm(final)=2.878 | 1642.9 samples/s | 25.7 steps/s
[Step=22000 Epoch=207.3] | Loss=0.00118 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.050 | FP-Norm(final)=2.879 | 3714.7 samples/s | 58.0 steps/s
[Step=22050 Epoch=207.8] | Loss=0.00105 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.034 | FP-Norm(final)=2.879 | 1658.6 samples/s | 25.9 steps/s
[Step=22100 Epoch=208.2] | Loss=0.00095 | Reg=0.00106 | acc=1.0000 | FP-Norm=1.019 | FP-Norm(final)=2.879 | 3593.3 samples/s | 56.1 steps/s
[Step=22150 Epoch=208.7] | Loss=0.00086 | Reg=0.00103 | acc=1.0000 | FP-Norm=1.004 | FP-Norm(final)=2.880 | 1700.6 samples/s | 26.6 steps/s
[Step=22200 Epoch=209.2] | Loss=0.00079 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.991 | FP-Norm(final)=2.880 | 3579.3 samples/s | 55.9 steps/s
[Step=22250 Epoch=209.7] | Loss=0.00073 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.978 | FP-Norm(final)=2.880 | 1727.2 samples/s | 27.0 steps/s
[Step=22300 Epoch=210.1] | Loss=0.00068 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.965 | FP-Norm(final)=2.881 | 3511.7 samples/s | 54.9 steps/s
[Step=22350 Epoch=210.6] | Loss=0.00064 | Reg=0.00093 | acc=1.0000 | FP-Norm=0.953 | FP-Norm(final)=2.881 | 1801.4 samples/s | 28.1 steps/s
[Step=22400 Epoch=211.1] | Loss=0.00060 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.942 | FP-Norm(final)=2.881 | 3149.5 samples/s | 49.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step22400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=205.9] | Loss=0.05781 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.882 | 3443.9 samples/s | 53.8 steps/s
[Step=21650 Epoch=206.3] | Loss=0.00473 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.859 | FP-Norm(final)=2.880 | 3306.4 samples/s | 51.7 steps/s
[Step=21700 Epoch=206.8] | Loss=0.00251 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.904 | FP-Norm(final)=2.881 | 4634.0 samples/s | 72.4 steps/s
[Step=21750 Epoch=207.3] | Loss=0.00168 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.895 | FP-Norm(final)=2.882 | 1510.5 samples/s | 23.6 steps/s
[Step=21800 Epoch=207.8] | Loss=0.00127 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.882 | 4412.3 samples/s | 68.9 steps/s
[Step=21850 Epoch=208.3] | Loss=0.00102 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.858 | FP-Norm(final)=2.883 | 1599.3 samples/s | 25.0 steps/s
[Step=21900 Epoch=208.7] | Loss=0.00085 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.840 | FP-Norm(final)=2.883 | 4204.4 samples/s | 65.7 steps/s
[Step=21950 Epoch=209.2] | Loss=0.00074 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.824 | FP-Norm(final)=2.884 | 1587.4 samples/s | 24.8 steps/s
[Step=22000 Epoch=209.7] | Loss=0.00065 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.808 | FP-Norm(final)=2.884 | 3943.7 samples/s | 61.6 steps/s
[Step=22050 Epoch=210.2] | Loss=0.00058 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.795 | FP-Norm(final)=2.884 | 1637.2 samples/s | 25.6 steps/s
[Step=22100 Epoch=210.6] | Loss=0.00052 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.782 | FP-Norm(final)=2.885 | 3768.2 samples/s | 58.9 steps/s
[Step=22150 Epoch=211.1] | Loss=0.00048 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.769 | FP-Norm(final)=2.885 | 1671.9 samples/s | 26.1 steps/s
[Step=22200 Epoch=211.6] | Loss=0.00044 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.758 | FP-Norm(final)=2.885 | 3641.3 samples/s | 56.9 steps/s
[Step=22250 Epoch=212.1] | Loss=0.00040 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.747 | FP-Norm(final)=2.886 | 1671.9 samples/s | 26.1 steps/s
[Step=22300 Epoch=212.5] | Loss=0.00038 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.737 | FP-Norm(final)=2.886 | 3544.7 samples/s | 55.4 steps/s
[Step=22350 Epoch=213.0] | Loss=0.00035 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.727 | FP-Norm(final)=2.886 | 1733.7 samples/s | 27.1 steps/s
[Step=22400 Epoch=213.5] | Loss=0.00033 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.718 | FP-Norm(final)=2.886 | 3597.1 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21046 | acc=0.8751 | tpr=0.8254 | fpr=0.0171 | 3641.5 samples/s | 14.2 steps/s
Avg test loss: 0.21211, Avg test acc: 0.87463, Avg tpr: 0.82637, Avg fpr: 0.01923, total FA: 150

Testing server on iccad2012
[Step=  50] | Loss=0.50942 | acc=0.8438 | tpr=0.9735 | fpr=0.1585 | 3558.7 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.52868 | acc=0.8396 | tpr=0.9765 | fpr=0.1629 | 6577.2 samples/s | 25.7 steps/s
[Step= 150] | Loss=0.53909 | acc=0.8373 | tpr=0.9712 | fpr=0.1652 | 6929.9 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.53905 | acc=0.8372 | tpr=0.9749 | fpr=0.1653 | 6705.6 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.53684 | acc=0.8368 | tpr=0.9694 | fpr=0.1656 | 6834.4 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.54071 | acc=0.8366 | tpr=0.9673 | fpr=0.1657 | 6302.8 samples/s | 24.6 steps/s
[Step= 350] | Loss=0.54109 | acc=0.8369 | tpr=0.9681 | fpr=0.1655 | 6903.1 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.54141 | acc=0.8368 | tpr=0.9688 | fpr=0.1656 | 6691.7 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.54490 | acc=0.8365 | tpr=0.9684 | fpr=0.1659 | 6749.6 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.54560 | acc=0.8362 | tpr=0.9692 | fpr=0.1662 | 6619.8 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.54491 | acc=0.8364 | tpr=0.9694 | fpr=0.1660 | 12556.9 samples/s | 49.1 steps/s
Avg test loss: 0.54494, Avg test acc: 0.83648, Avg tpr: 0.96949, Avg fpr: 0.16594, total FA: 23040

server round 28/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.2] | Loss=0.18753 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.898 | 3652.5 samples/s | 57.1 steps/s
[Step=22450 Epoch=109.5] | Loss=0.02181 | Reg=0.00040 | acc=0.9688 | FP-Norm=0.609 | FP-Norm(final)=2.895 | 3618.2 samples/s | 56.5 steps/s
[Step=22500 Epoch=109.7] | Loss=0.01696 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.675 | FP-Norm(final)=2.894 | 3794.4 samples/s | 59.3 steps/s
[Step=22550 Epoch=110.0] | Loss=0.01478 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.709 | FP-Norm(final)=2.896 | 3782.3 samples/s | 59.1 steps/s
[Step=22600 Epoch=110.2] | Loss=0.01344 | Reg=0.00054 | acc=0.9844 | FP-Norm=0.727 | FP-Norm(final)=2.897 | 4843.5 samples/s | 75.7 steps/s
[Step=22650 Epoch=110.4] | Loss=0.01222 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.737 | FP-Norm(final)=2.898 | 1635.7 samples/s | 25.6 steps/s
[Step=22700 Epoch=110.7] | Loss=0.01147 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.741 | FP-Norm(final)=2.899 | 3768.1 samples/s | 58.9 steps/s
[Step=22750 Epoch=110.9] | Loss=0.01065 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.743 | FP-Norm(final)=2.900 | 3756.3 samples/s | 58.7 steps/s
[Step=22800 Epoch=111.2] | Loss=0.01004 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.744 | FP-Norm(final)=2.900 | 4559.9 samples/s | 71.2 steps/s
[Step=22850 Epoch=111.4] | Loss=0.00955 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.744 | FP-Norm(final)=2.902 | 1660.2 samples/s | 25.9 steps/s
[Step=22900 Epoch=111.7] | Loss=0.00917 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.744 | FP-Norm(final)=2.902 | 3702.2 samples/s | 57.8 steps/s
[Step=22950 Epoch=111.9] | Loss=0.00884 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.744 | FP-Norm(final)=2.903 | 3745.6 samples/s | 58.5 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00850 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.743 | FP-Norm(final)=2.904 | 4295.2 samples/s | 67.1 steps/s
[Step=23050 Epoch=112.4] | Loss=0.00823 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.743 | FP-Norm(final)=2.905 | 1696.8 samples/s | 26.5 steps/s
[Step=23100 Epoch=112.6] | Loss=0.00787 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.743 | FP-Norm(final)=2.905 | 3781.7 samples/s | 59.1 steps/s
[Step=23150 Epoch=112.9] | Loss=0.00773 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.742 | FP-Norm(final)=2.906 | 3810.8 samples/s | 59.5 steps/s
[Step=23200 Epoch=113.1] | Loss=0.00740 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.741 | FP-Norm(final)=2.907 | 4053.4 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step23200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.3] | Loss=0.13066 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.898 | 3766.3 samples/s | 58.8 steps/s
[Step=22450 Epoch=109.5] | Loss=0.02326 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.611 | FP-Norm(final)=2.892 | 3599.8 samples/s | 56.2 steps/s
[Step=22500 Epoch=109.8] | Loss=0.01712 | Reg=0.00052 | acc=0.9844 | FP-Norm=0.702 | FP-Norm(final)=2.893 | 3674.3 samples/s | 57.4 steps/s
[Step=22550 Epoch=110.0] | Loss=0.01417 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.731 | FP-Norm(final)=2.896 | 3697.9 samples/s | 57.8 steps/s
[Step=22600 Epoch=110.3] | Loss=0.01312 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.749 | FP-Norm(final)=2.898 | 4791.7 samples/s | 74.9 steps/s
[Step=22650 Epoch=110.5] | Loss=0.01141 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.759 | FP-Norm(final)=2.901 | 1607.9 samples/s | 25.1 steps/s
[Step=22700 Epoch=110.8] | Loss=0.01036 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.760 | FP-Norm(final)=2.904 | 3752.0 samples/s | 58.6 steps/s
[Step=22750 Epoch=111.0] | Loss=0.01006 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.761 | FP-Norm(final)=2.906 | 3801.1 samples/s | 59.4 steps/s
[Step=22800 Epoch=111.3] | Loss=0.00947 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.760 | FP-Norm(final)=2.908 | 4627.1 samples/s | 72.3 steps/s
[Step=22850 Epoch=111.5] | Loss=0.00903 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.758 | FP-Norm(final)=2.910 | 1641.8 samples/s | 25.7 steps/s
[Step=22900 Epoch=111.7] | Loss=0.00847 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.756 | FP-Norm(final)=2.911 | 3765.0 samples/s | 58.8 steps/s
[Step=22950 Epoch=112.0] | Loss=0.00817 | Reg=0.00057 | acc=0.9844 | FP-Norm=0.754 | FP-Norm(final)=2.912 | 3760.3 samples/s | 58.8 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00780 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.753 | FP-Norm(final)=2.914 | 4366.3 samples/s | 68.2 steps/s
[Step=23050 Epoch=112.5] | Loss=0.00757 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.751 | FP-Norm(final)=2.915 | 1669.5 samples/s | 26.1 steps/s
[Step=23100 Epoch=112.7] | Loss=0.00730 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.750 | FP-Norm(final)=2.916 | 3784.0 samples/s | 59.1 steps/s
[Step=23150 Epoch=113.0] | Loss=0.00716 | Reg=0.00056 | acc=0.9844 | FP-Norm=0.748 | FP-Norm(final)=2.916 | 3771.0 samples/s | 58.9 steps/s
[Step=23200 Epoch=113.2] | Loss=0.00695 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.746 | FP-Norm(final)=2.917 | 4200.6 samples/s | 65.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step23200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.1] | Loss=0.12485 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.899 | 3485.7 samples/s | 54.5 steps/s
[Step=22450 Epoch=109.4] | Loss=0.02582 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.657 | FP-Norm(final)=2.896 | 3773.4 samples/s | 59.0 steps/s
[Step=22500 Epoch=109.6] | Loss=0.02060 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.743 | FP-Norm(final)=2.892 | 3778.3 samples/s | 59.0 steps/s
[Step=22550 Epoch=109.9] | Loss=0.01691 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.764 | FP-Norm(final)=2.893 | 3796.4 samples/s | 59.3 steps/s
[Step=22600 Epoch=110.1] | Loss=0.01460 | Reg=0.00061 | acc=0.9844 | FP-Norm=0.773 | FP-Norm(final)=2.895 | 4784.4 samples/s | 74.8 steps/s
[Step=22650 Epoch=110.4] | Loss=0.01319 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.897 | 1623.5 samples/s | 25.4 steps/s
[Step=22700 Epoch=110.6] | Loss=0.01187 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.777 | FP-Norm(final)=2.899 | 3792.6 samples/s | 59.3 steps/s
[Step=22750 Epoch=110.8] | Loss=0.01095 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.776 | FP-Norm(final)=2.901 | 3787.6 samples/s | 59.2 steps/s
[Step=22800 Epoch=111.1] | Loss=0.01036 | Reg=0.00061 | acc=0.9844 | FP-Norm=0.774 | FP-Norm(final)=2.904 | 4569.1 samples/s | 71.4 steps/s
[Step=22850 Epoch=111.3] | Loss=0.00973 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.905 | 1679.9 samples/s | 26.2 steps/s
[Step=22900 Epoch=111.6] | Loss=0.00925 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.769 | FP-Norm(final)=2.907 | 3797.7 samples/s | 59.3 steps/s
[Step=22950 Epoch=111.8] | Loss=0.00876 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.767 | FP-Norm(final)=2.909 | 3793.6 samples/s | 59.3 steps/s
[Step=23000 Epoch=112.1] | Loss=0.00838 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.911 | 4296.3 samples/s | 67.1 steps/s
[Step=23050 Epoch=112.3] | Loss=0.00797 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.763 | FP-Norm(final)=2.913 | 1704.2 samples/s | 26.6 steps/s
[Step=23100 Epoch=112.6] | Loss=0.00773 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.761 | FP-Norm(final)=2.915 | 3758.4 samples/s | 58.7 steps/s
[Step=23150 Epoch=112.8] | Loss=0.00748 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.760 | FP-Norm(final)=2.916 | 3768.0 samples/s | 58.9 steps/s
[Step=23200 Epoch=113.0] | Loss=0.00732 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.759 | FP-Norm(final)=2.918 | 4043.8 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step23200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.2] | Loss=0.10448 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.898 | 3642.5 samples/s | 56.9 steps/s
[Step=22450 Epoch=109.5] | Loss=0.01973 | Reg=0.00046 | acc=0.9844 | FP-Norm=0.642 | FP-Norm(final)=2.898 | 3608.5 samples/s | 56.4 steps/s
[Step=22500 Epoch=109.7] | Loss=0.01611 | Reg=0.00055 | acc=0.9688 | FP-Norm=0.718 | FP-Norm(final)=2.898 | 3745.5 samples/s | 58.5 steps/s
[Step=22550 Epoch=110.0] | Loss=0.01387 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.749 | FP-Norm(final)=2.898 | 3784.9 samples/s | 59.1 steps/s
[Step=22600 Epoch=110.2] | Loss=0.01377 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.898 | 4833.8 samples/s | 75.5 steps/s
[Step=22650 Epoch=110.5] | Loss=0.01191 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.898 | 1632.6 samples/s | 25.5 steps/s
[Step=22700 Epoch=110.7] | Loss=0.01054 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.771 | FP-Norm(final)=2.900 | 3745.0 samples/s | 58.5 steps/s
[Step=22750 Epoch=110.9] | Loss=0.00985 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.770 | FP-Norm(final)=2.901 | 3749.8 samples/s | 58.6 steps/s
[Step=22800 Epoch=111.2] | Loss=0.00944 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.767 | FP-Norm(final)=2.903 | 4548.5 samples/s | 71.1 steps/s
[Step=22850 Epoch=111.4] | Loss=0.00892 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.904 | 1647.1 samples/s | 25.7 steps/s
[Step=22900 Epoch=111.7] | Loss=0.00842 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.905 | 3713.9 samples/s | 58.0 steps/s
[Step=22950 Epoch=111.9] | Loss=0.00796 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.906 | 3772.2 samples/s | 58.9 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00763 | Reg=0.00058 | acc=0.9688 | FP-Norm=0.760 | FP-Norm(final)=2.908 | 4292.5 samples/s | 67.1 steps/s
[Step=23050 Epoch=112.4] | Loss=0.00721 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.758 | FP-Norm(final)=2.909 | 1711.9 samples/s | 26.7 steps/s
[Step=23100 Epoch=112.6] | Loss=0.00710 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.757 | FP-Norm(final)=2.911 | 3802.3 samples/s | 59.4 steps/s
[Step=23150 Epoch=112.9] | Loss=0.00684 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.755 | FP-Norm(final)=2.912 | 3781.5 samples/s | 59.1 steps/s
[Step=23200 Epoch=113.1] | Loss=0.00672 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.755 | FP-Norm(final)=2.913 | 4049.7 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step23200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.9] | Loss=0.14225 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.899 | 3556.6 samples/s | 55.6 steps/s
[Step=22450 Epoch=110.1] | Loss=0.02508 | Reg=0.00050 | acc=0.9688 | FP-Norm=0.676 | FP-Norm(final)=2.896 | 3729.2 samples/s | 58.3 steps/s
[Step=22500 Epoch=110.3] | Loss=0.01979 | Reg=0.00060 | acc=0.9844 | FP-Norm=0.755 | FP-Norm(final)=2.894 | 3768.7 samples/s | 58.9 steps/s
[Step=22550 Epoch=110.6] | Loss=0.01733 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.787 | FP-Norm(final)=2.893 | 3754.2 samples/s | 58.7 steps/s
[Step=22600 Epoch=110.8] | Loss=0.01548 | Reg=0.00066 | acc=0.9844 | FP-Norm=0.804 | FP-Norm(final)=2.893 | 4899.2 samples/s | 76.6 steps/s
[Step=22650 Epoch=111.1] | Loss=0.01358 | Reg=0.00067 | acc=0.9844 | FP-Norm=0.813 | FP-Norm(final)=2.894 | 1616.1 samples/s | 25.3 steps/s
[Step=22700 Epoch=111.3] | Loss=0.01206 | Reg=0.00068 | acc=0.9844 | FP-Norm=0.817 | FP-Norm(final)=2.896 | 3739.3 samples/s | 58.4 steps/s
[Step=22750 Epoch=111.6] | Loss=0.01114 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.819 | FP-Norm(final)=2.897 | 3788.6 samples/s | 59.2 steps/s
[Step=22800 Epoch=111.8] | Loss=0.01058 | Reg=0.00068 | acc=0.9844 | FP-Norm=0.819 | FP-Norm(final)=2.898 | 4683.2 samples/s | 73.2 steps/s
[Step=22850 Epoch=112.1] | Loss=0.00995 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.900 | 1633.1 samples/s | 25.5 steps/s
[Step=22900 Epoch=112.3] | Loss=0.00952 | Reg=0.00067 | acc=0.9844 | FP-Norm=0.816 | FP-Norm(final)=2.901 | 3773.2 samples/s | 59.0 steps/s
[Step=22950 Epoch=112.5] | Loss=0.00912 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.814 | FP-Norm(final)=2.902 | 3771.2 samples/s | 58.9 steps/s
[Step=23000 Epoch=112.8] | Loss=0.00868 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.813 | FP-Norm(final)=2.903 | 4511.8 samples/s | 70.5 steps/s
[Step=23050 Epoch=113.0] | Loss=0.00833 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.811 | FP-Norm(final)=2.904 | 1659.2 samples/s | 25.9 steps/s
[Step=23100 Epoch=113.3] | Loss=0.00786 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.810 | FP-Norm(final)=2.905 | 3774.9 samples/s | 59.0 steps/s
[Step=23150 Epoch=113.5] | Loss=0.00767 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.808 | FP-Norm(final)=2.906 | 3780.6 samples/s | 59.1 steps/s
[Step=23200 Epoch=113.8] | Loss=0.00745 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.907 | 4350.6 samples/s | 68.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step23200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=212.3] | Loss=0.08420 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.898 | 3574.9 samples/s | 55.9 steps/s
[Step=22450 Epoch=212.7] | Loss=0.00540 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.830 | FP-Norm(final)=2.900 | 3421.5 samples/s | 53.5 steps/s
[Step=22500 Epoch=213.2] | Loss=0.00299 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.887 | FP-Norm(final)=2.901 | 4681.4 samples/s | 73.1 steps/s
[Step=22550 Epoch=213.7] | Loss=0.00204 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.885 | FP-Norm(final)=2.902 | 1541.1 samples/s | 24.1 steps/s
[Step=22600 Epoch=214.2] | Loss=0.00153 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.872 | FP-Norm(final)=2.903 | 4317.2 samples/s | 67.5 steps/s
[Step=22650 Epoch=214.6] | Loss=0.00123 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.856 | FP-Norm(final)=2.903 | 1571.6 samples/s | 24.6 steps/s
[Step=22700 Epoch=215.1] | Loss=0.00103 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.840 | FP-Norm(final)=2.903 | 4069.7 samples/s | 63.6 steps/s
[Step=22750 Epoch=215.6] | Loss=0.00089 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.904 | 1616.7 samples/s | 25.3 steps/s
[Step=22800 Epoch=216.0] | Loss=0.00078 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.904 | 3823.1 samples/s | 59.7 steps/s
[Step=22850 Epoch=216.5] | Loss=0.00069 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.800 | FP-Norm(final)=2.904 | 1632.9 samples/s | 25.5 steps/s
[Step=22900 Epoch=217.0] | Loss=0.00063 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.788 | FP-Norm(final)=2.904 | 3633.3 samples/s | 56.8 steps/s
[Step=22950 Epoch=217.5] | Loss=0.00057 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.777 | FP-Norm(final)=2.904 | 1694.3 samples/s | 26.5 steps/s
[Step=23000 Epoch=217.9] | Loss=0.00053 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.905 | 3590.6 samples/s | 56.1 steps/s
[Step=23050 Epoch=218.4] | Loss=0.00049 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.757 | FP-Norm(final)=2.905 | 1720.6 samples/s | 26.9 steps/s
[Step=23100 Epoch=218.9] | Loss=0.00045 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.747 | FP-Norm(final)=2.905 | 3585.9 samples/s | 56.0 steps/s
[Step=23150 Epoch=219.4] | Loss=0.00042 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.738 | FP-Norm(final)=2.905 | 1749.0 samples/s | 27.3 steps/s
[Step=23200 Epoch=219.8] | Loss=0.00040 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.729 | FP-Norm(final)=2.905 | 3566.2 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step23200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=213.1] | Loss=0.12211 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.898 | 3475.9 samples/s | 54.3 steps/s
[Step=22450 Epoch=213.6] | Loss=0.00507 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.846 | FP-Norm(final)=2.896 | 3507.5 samples/s | 54.8 steps/s
[Step=22500 Epoch=214.0] | Loss=0.00256 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.891 | FP-Norm(final)=2.897 | 4678.2 samples/s | 73.1 steps/s
[Step=22550 Epoch=214.5] | Loss=0.00181 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.888 | FP-Norm(final)=2.898 | 1539.7 samples/s | 24.1 steps/s
[Step=22600 Epoch=215.0] | Loss=0.00136 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.873 | FP-Norm(final)=2.899 | 4364.6 samples/s | 68.2 steps/s
[Step=22650 Epoch=215.5] | Loss=0.00109 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.856 | FP-Norm(final)=2.900 | 1588.6 samples/s | 24.8 steps/s
[Step=22700 Epoch=215.9] | Loss=0.00091 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.840 | FP-Norm(final)=2.901 | 4107.2 samples/s | 64.2 steps/s
[Step=22750 Epoch=216.4] | Loss=0.00079 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.825 | FP-Norm(final)=2.901 | 1626.3 samples/s | 25.4 steps/s
[Step=22800 Epoch=216.9] | Loss=0.00069 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.811 | FP-Norm(final)=2.901 | 3826.3 samples/s | 59.8 steps/s
[Step=22850 Epoch=217.4] | Loss=0.00062 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.902 | 1666.4 samples/s | 26.0 steps/s
[Step=22900 Epoch=217.8] | Loss=0.00056 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.902 | 3678.2 samples/s | 57.5 steps/s
[Step=22950 Epoch=218.3] | Loss=0.00051 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.774 | FP-Norm(final)=2.902 | 1711.8 samples/s | 26.7 steps/s
[Step=23000 Epoch=218.8] | Loss=0.00047 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.763 | FP-Norm(final)=2.902 | 3586.6 samples/s | 56.0 steps/s
[Step=23050 Epoch=219.3] | Loss=0.00043 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.753 | FP-Norm(final)=2.903 | 1718.0 samples/s | 26.8 steps/s
[Step=23100 Epoch=219.7] | Loss=0.00040 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.743 | FP-Norm(final)=2.903 | 3570.1 samples/s | 55.8 steps/s
[Step=23150 Epoch=220.2] | Loss=0.00038 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.734 | FP-Norm(final)=2.903 | 1758.9 samples/s | 27.5 steps/s
[Step=23200 Epoch=220.7] | Loss=0.00035 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.725 | FP-Norm(final)=2.903 | 3570.2 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step23200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=213.9] | Loss=0.15514 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.898 | 3609.0 samples/s | 56.4 steps/s
[Step=22450 Epoch=214.4] | Loss=0.00582 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.839 | FP-Norm(final)=2.895 | 3291.9 samples/s | 51.4 steps/s
[Step=22500 Epoch=214.9] | Loss=0.00300 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.881 | FP-Norm(final)=2.896 | 4738.4 samples/s | 74.0 steps/s
[Step=22550 Epoch=215.3] | Loss=0.00201 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.868 | FP-Norm(final)=2.897 | 1538.8 samples/s | 24.0 steps/s
[Step=22600 Epoch=215.8] | Loss=0.00152 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.848 | FP-Norm(final)=2.897 | 4396.4 samples/s | 68.7 steps/s
[Step=22650 Epoch=216.3] | Loss=0.00122 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.897 | 1567.9 samples/s | 24.5 steps/s
[Step=22700 Epoch=216.8] | Loss=0.00102 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.811 | FP-Norm(final)=2.898 | 4221.6 samples/s | 66.0 steps/s
[Step=22750 Epoch=217.2] | Loss=0.00088 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.795 | FP-Norm(final)=2.898 | 1594.7 samples/s | 24.9 steps/s
[Step=22800 Epoch=217.7] | Loss=0.00077 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.898 | 3979.4 samples/s | 62.2 steps/s
[Step=22850 Epoch=218.2] | Loss=0.00069 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.899 | 1624.9 samples/s | 25.4 steps/s
[Step=22900 Epoch=218.7] | Loss=0.00062 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.753 | FP-Norm(final)=2.899 | 3796.8 samples/s | 59.3 steps/s
[Step=22950 Epoch=219.2] | Loss=0.00057 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.741 | FP-Norm(final)=2.899 | 1672.7 samples/s | 26.1 steps/s
[Step=23000 Epoch=219.6] | Loss=0.00052 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.730 | FP-Norm(final)=2.899 | 3614.0 samples/s | 56.5 steps/s
[Step=23050 Epoch=220.1] | Loss=0.00048 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.719 | FP-Norm(final)=2.900 | 1695.3 samples/s | 26.5 steps/s
[Step=23100 Epoch=220.6] | Loss=0.00045 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.709 | FP-Norm(final)=2.900 | 3625.6 samples/s | 56.6 steps/s
[Step=23150 Epoch=221.1] | Loss=0.00042 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.700 | FP-Norm(final)=2.900 | 1708.4 samples/s | 26.7 steps/s
[Step=23200 Epoch=221.5] | Loss=0.00039 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.691 | FP-Norm(final)=2.900 | 3598.9 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step23200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=211.1] | Loss=0.07948 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.898 | 3762.5 samples/s | 58.8 steps/s
[Step=22450 Epoch=211.5] | Loss=0.00982 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.896 | FP-Norm(final)=2.887 | 3290.6 samples/s | 51.4 steps/s
[Step=22500 Epoch=212.0] | Loss=0.00510 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.973 | FP-Norm(final)=2.886 | 4657.7 samples/s | 72.8 steps/s
[Step=22550 Epoch=212.5] | Loss=0.00341 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.979 | FP-Norm(final)=2.886 | 1538.8 samples/s | 24.0 steps/s
[Step=22600 Epoch=213.0] | Loss=0.00257 | Reg=0.00096 | acc=1.0000 | FP-Norm=0.967 | FP-Norm(final)=2.886 | 4231.2 samples/s | 66.1 steps/s
[Step=22650 Epoch=213.4] | Loss=0.00206 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.950 | FP-Norm(final)=2.886 | 1604.5 samples/s | 25.1 steps/s
[Step=22700 Epoch=213.9] | Loss=0.00172 | Reg=0.00089 | acc=1.0000 | FP-Norm=0.933 | FP-Norm(final)=2.886 | 3972.2 samples/s | 62.1 steps/s
[Step=22750 Epoch=214.4] | Loss=0.00147 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.917 | FP-Norm(final)=2.887 | 1625.2 samples/s | 25.4 steps/s
[Step=22800 Epoch=214.8] | Loss=0.00129 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.902 | FP-Norm(final)=2.887 | 3713.8 samples/s | 58.0 steps/s
[Step=22850 Epoch=215.3] | Loss=0.00115 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.888 | FP-Norm(final)=2.887 | 1680.4 samples/s | 26.3 steps/s
[Step=22900 Epoch=215.8] | Loss=0.00104 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.874 | FP-Norm(final)=2.888 | 3556.3 samples/s | 55.6 steps/s
[Step=22950 Epoch=216.3] | Loss=0.00094 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.862 | FP-Norm(final)=2.888 | 1713.3 samples/s | 26.8 steps/s
[Step=23000 Epoch=216.7] | Loss=0.00087 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.850 | FP-Norm(final)=2.889 | 3609.2 samples/s | 56.4 steps/s
[Step=23050 Epoch=217.2] | Loss=0.00080 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.838 | FP-Norm(final)=2.889 | 1713.8 samples/s | 26.8 steps/s
[Step=23100 Epoch=217.7] | Loss=0.00074 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.828 | FP-Norm(final)=2.889 | 3562.5 samples/s | 55.7 steps/s
[Step=23150 Epoch=218.1] | Loss=0.00070 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.817 | FP-Norm(final)=2.889 | 1797.9 samples/s | 28.1 steps/s
[Step=23200 Epoch=218.6] | Loss=0.00065 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.807 | FP-Norm(final)=2.890 | 3328.2 samples/s | 52.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step23200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=213.5] | Loss=0.01902 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.899 | 3475.9 samples/s | 54.3 steps/s
[Step=22450 Epoch=214.0] | Loss=0.00735 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.843 | FP-Norm(final)=2.894 | 3373.0 samples/s | 52.7 steps/s
[Step=22500 Epoch=214.4] | Loss=0.00382 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.928 | FP-Norm(final)=2.893 | 4674.4 samples/s | 73.0 steps/s
[Step=22550 Epoch=214.9] | Loss=0.00257 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.939 | FP-Norm(final)=2.894 | 1527.4 samples/s | 23.9 steps/s
[Step=22600 Epoch=215.4] | Loss=0.00194 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.927 | FP-Norm(final)=2.894 | 4421.9 samples/s | 69.1 steps/s
[Step=22650 Epoch=215.9] | Loss=0.00155 | Reg=0.00085 | acc=1.0000 | FP-Norm=0.910 | FP-Norm(final)=2.895 | 1574.0 samples/s | 24.6 steps/s
[Step=22700 Epoch=216.4] | Loss=0.00130 | Reg=0.00082 | acc=1.0000 | FP-Norm=0.893 | FP-Norm(final)=2.895 | 4152.5 samples/s | 64.9 steps/s
[Step=22750 Epoch=216.8] | Loss=0.00112 | Reg=0.00079 | acc=1.0000 | FP-Norm=0.877 | FP-Norm(final)=2.896 | 1630.5 samples/s | 25.5 steps/s
[Step=22800 Epoch=217.3] | Loss=0.00098 | Reg=0.00076 | acc=1.0000 | FP-Norm=0.862 | FP-Norm(final)=2.896 | 3989.8 samples/s | 62.3 steps/s
[Step=22850 Epoch=217.8] | Loss=0.00087 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.847 | FP-Norm(final)=2.896 | 1637.1 samples/s | 25.6 steps/s
[Step=22900 Epoch=218.3] | Loss=0.00079 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.834 | FP-Norm(final)=2.897 | 3851.4 samples/s | 60.2 steps/s
[Step=22950 Epoch=218.7] | Loss=0.00072 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.821 | FP-Norm(final)=2.897 | 1680.1 samples/s | 26.3 steps/s
[Step=23000 Epoch=219.2] | Loss=0.00066 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.897 | 3649.1 samples/s | 57.0 steps/s
[Step=23050 Epoch=219.7] | Loss=0.00061 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.898 | 1705.1 samples/s | 26.6 steps/s
[Step=23100 Epoch=220.2] | Loss=0.00057 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.787 | FP-Norm(final)=2.898 | 3556.0 samples/s | 55.6 steps/s
[Step=23150 Epoch=220.6] | Loss=0.00053 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.777 | FP-Norm(final)=2.898 | 1721.7 samples/s | 26.9 steps/s
[Step=23200 Epoch=221.1] | Loss=0.00050 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.767 | FP-Norm(final)=2.898 | 3588.5 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19632 | acc=0.8849 | tpr=0.8411 | fpr=0.0198 | 3667.2 samples/s | 14.3 steps/s
Avg test loss: 0.19840, Avg test acc: 0.88421, Avg tpr: 0.84141, Avg fpr: 0.02166, total FA: 169

Testing server on iccad2012
[Step=  50] | Loss=0.54521 | acc=0.8370 | tpr=0.9735 | fpr=0.1655 | 3641.6 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.56528 | acc=0.8336 | tpr=0.9744 | fpr=0.1690 | 6865.5 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.57653 | acc=0.8305 | tpr=0.9697 | fpr=0.1721 | 6976.3 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.57651 | acc=0.8309 | tpr=0.9738 | fpr=0.1717 | 7010.2 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.57452 | acc=0.8303 | tpr=0.9677 | fpr=0.1722 | 6908.0 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.57875 | acc=0.8300 | tpr=0.9658 | fpr=0.1725 | 6697.8 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.57895 | acc=0.8303 | tpr=0.9668 | fpr=0.1722 | 6789.5 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.57928 | acc=0.8302 | tpr=0.9677 | fpr=0.1723 | 6748.5 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.58314 | acc=0.8301 | tpr=0.9679 | fpr=0.1724 | 6923.7 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.58383 | acc=0.8296 | tpr=0.9687 | fpr=0.1729 | 6785.7 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.58339 | acc=0.8298 | tpr=0.9690 | fpr=0.1728 | 12448.0 samples/s | 48.6 steps/s
Avg test loss: 0.58341, Avg test acc: 0.82980, Avg tpr: 0.96910, Avg fpr: 0.17274, total FA: 23984

server round 29/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.1] | Loss=0.12995 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.915 | 3625.0 samples/s | 56.6 steps/s
[Step=23250 Epoch=113.4] | Loss=0.02368 | Reg=0.00043 | acc=0.9844 | FP-Norm=0.623 | FP-Norm(final)=2.909 | 3656.1 samples/s | 57.1 steps/s
[Step=23300 Epoch=113.6] | Loss=0.01999 | Reg=0.00052 | acc=0.9688 | FP-Norm=0.705 | FP-Norm(final)=2.908 | 3793.4 samples/s | 59.3 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01716 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.749 | FP-Norm(final)=2.907 | 3773.9 samples/s | 59.0 steps/s
[Step=23400 Epoch=114.1] | Loss=0.01579 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.773 | FP-Norm(final)=2.907 | 4828.4 samples/s | 75.4 steps/s
[Step=23450 Epoch=114.3] | Loss=0.01442 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.789 | FP-Norm(final)=2.907 | 1624.4 samples/s | 25.4 steps/s
[Step=23500 Epoch=114.6] | Loss=0.01291 | Reg=0.00065 | acc=0.9844 | FP-Norm=0.795 | FP-Norm(final)=2.907 | 3788.2 samples/s | 59.2 steps/s
[Step=23550 Epoch=114.8] | Loss=0.01172 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.797 | FP-Norm(final)=2.908 | 3792.1 samples/s | 59.3 steps/s
[Step=23600 Epoch=115.1] | Loss=0.01114 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.800 | FP-Norm(final)=2.908 | 4576.4 samples/s | 71.5 steps/s
[Step=23650 Epoch=115.3] | Loss=0.01039 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.800 | FP-Norm(final)=2.909 | 1668.9 samples/s | 26.1 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00981 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.799 | FP-Norm(final)=2.910 | 3800.7 samples/s | 59.4 steps/s
[Step=23750 Epoch=115.8] | Loss=0.00930 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.798 | FP-Norm(final)=2.911 | 3741.6 samples/s | 58.5 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00912 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.798 | FP-Norm(final)=2.912 | 4296.8 samples/s | 67.1 steps/s
[Step=23850 Epoch=116.3] | Loss=0.00881 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.798 | FP-Norm(final)=2.912 | 1704.5 samples/s | 26.6 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00854 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.797 | FP-Norm(final)=2.913 | 3750.6 samples/s | 58.6 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00829 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.913 | 3790.3 samples/s | 59.2 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00815 | Reg=0.00064 | acc=0.9844 | FP-Norm=0.797 | FP-Norm(final)=2.914 | 4049.9 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.2] | Loss=0.04897 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.915 | 3660.1 samples/s | 57.2 steps/s
[Step=23250 Epoch=113.4] | Loss=0.01673 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.641 | FP-Norm(final)=2.915 | 3652.1 samples/s | 57.1 steps/s
[Step=23300 Epoch=113.7] | Loss=0.01526 | Reg=0.00057 | acc=0.9844 | FP-Norm=0.731 | FP-Norm(final)=2.915 | 3773.3 samples/s | 59.0 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01408 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.776 | FP-Norm(final)=2.914 | 3777.6 samples/s | 59.0 steps/s
[Step=23400 Epoch=114.2] | Loss=0.01367 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.801 | FP-Norm(final)=2.915 | 4877.1 samples/s | 76.2 steps/s
[Step=23450 Epoch=114.4] | Loss=0.01226 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.819 | FP-Norm(final)=2.915 | 1634.9 samples/s | 25.5 steps/s
[Step=23500 Epoch=114.7] | Loss=0.01124 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.916 | 3778.7 samples/s | 59.0 steps/s
[Step=23550 Epoch=114.9] | Loss=0.01070 | Reg=0.00070 | acc=0.9688 | FP-Norm=0.829 | FP-Norm(final)=2.917 | 3768.9 samples/s | 58.9 steps/s
[Step=23600 Epoch=115.2] | Loss=0.01003 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.830 | FP-Norm(final)=2.918 | 4613.0 samples/s | 72.1 steps/s
[Step=23650 Epoch=115.4] | Loss=0.00938 | Reg=0.00070 | acc=0.9844 | FP-Norm=0.828 | FP-Norm(final)=2.919 | 1657.1 samples/s | 25.9 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00870 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.826 | FP-Norm(final)=2.920 | 3806.6 samples/s | 59.5 steps/s
[Step=23750 Epoch=115.9] | Loss=0.00843 | Reg=0.00069 | acc=0.9844 | FP-Norm=0.823 | FP-Norm(final)=2.922 | 3784.5 samples/s | 59.1 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00807 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.923 | 4384.0 samples/s | 68.5 steps/s
[Step=23850 Epoch=116.4] | Loss=0.00772 | Reg=0.00068 | acc=0.9844 | FP-Norm=0.818 | FP-Norm(final)=2.924 | 1674.9 samples/s | 26.2 steps/s
[Step=23900 Epoch=116.6] | Loss=0.00759 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.815 | FP-Norm(final)=2.925 | 3774.2 samples/s | 59.0 steps/s
[Step=23950 Epoch=116.9] | Loss=0.00731 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.926 | 3810.7 samples/s | 59.5 steps/s
[Step=24000 Epoch=117.1] | Loss=0.00711 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.809 | FP-Norm(final)=2.927 | 4206.5 samples/s | 65.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step24000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.0] | Loss=0.05814 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.915 | 3798.1 samples/s | 59.3 steps/s
[Step=23250 Epoch=113.3] | Loss=0.02472 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.608 | FP-Norm(final)=2.909 | 3525.6 samples/s | 55.1 steps/s
[Step=23300 Epoch=113.5] | Loss=0.01911 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.693 | FP-Norm(final)=2.906 | 3748.5 samples/s | 58.6 steps/s
[Step=23350 Epoch=113.8] | Loss=0.01736 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.735 | FP-Norm(final)=2.905 | 3791.6 samples/s | 59.2 steps/s
[Step=23400 Epoch=114.0] | Loss=0.01552 | Reg=0.00059 | acc=0.9844 | FP-Norm=0.755 | FP-Norm(final)=2.905 | 4820.3 samples/s | 75.3 steps/s
[Step=23450 Epoch=114.3] | Loss=0.01375 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.770 | FP-Norm(final)=2.905 | 1630.6 samples/s | 25.5 steps/s
[Step=23500 Epoch=114.5] | Loss=0.01240 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.776 | FP-Norm(final)=2.906 | 3760.5 samples/s | 58.8 steps/s
[Step=23550 Epoch=114.7] | Loss=0.01170 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.780 | FP-Norm(final)=2.908 | 3802.2 samples/s | 59.4 steps/s
[Step=23600 Epoch=115.0] | Loss=0.01106 | Reg=0.00062 | acc=0.9688 | FP-Norm=0.784 | FP-Norm(final)=2.909 | 4539.1 samples/s | 70.9 steps/s
[Step=23650 Epoch=115.2] | Loss=0.01036 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.785 | FP-Norm(final)=2.910 | 1676.9 samples/s | 26.2 steps/s
[Step=23700 Epoch=115.5] | Loss=0.00990 | Reg=0.00063 | acc=0.9688 | FP-Norm=0.786 | FP-Norm(final)=2.912 | 3819.8 samples/s | 59.7 steps/s
[Step=23750 Epoch=115.7] | Loss=0.00945 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.787 | FP-Norm(final)=2.913 | 3794.0 samples/s | 59.3 steps/s
[Step=23800 Epoch=116.0] | Loss=0.00896 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.787 | FP-Norm(final)=2.915 | 4265.0 samples/s | 66.6 steps/s
[Step=23850 Epoch=116.2] | Loss=0.00849 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.786 | FP-Norm(final)=2.917 | 1707.3 samples/s | 26.7 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00823 | Reg=0.00062 | acc=0.9844 | FP-Norm=0.785 | FP-Norm(final)=2.918 | 3804.0 samples/s | 59.4 steps/s
[Step=23950 Epoch=116.7] | Loss=0.00789 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.784 | FP-Norm(final)=2.920 | 3769.7 samples/s | 58.9 steps/s
[Step=24000 Epoch=116.9] | Loss=0.00769 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.784 | FP-Norm(final)=2.921 | 4057.4 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step24000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.1] | Loss=0.06373 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.915 | 3651.3 samples/s | 57.1 steps/s
[Step=23250 Epoch=113.4] | Loss=0.01708 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.613 | FP-Norm(final)=2.919 | 3703.1 samples/s | 57.9 steps/s
[Step=23300 Epoch=113.6] | Loss=0.01463 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.692 | FP-Norm(final)=2.920 | 3782.9 samples/s | 59.1 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01425 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.731 | FP-Norm(final)=2.921 | 3803.5 samples/s | 59.4 steps/s
[Step=23400 Epoch=114.1] | Loss=0.01265 | Reg=0.00058 | acc=0.9844 | FP-Norm=0.750 | FP-Norm(final)=2.922 | 4848.4 samples/s | 75.8 steps/s
[Step=23450 Epoch=114.4] | Loss=0.01150 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.759 | FP-Norm(final)=2.923 | 1635.9 samples/s | 25.6 steps/s
[Step=23500 Epoch=114.6] | Loss=0.01027 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.764 | FP-Norm(final)=2.924 | 3793.1 samples/s | 59.3 steps/s
[Step=23550 Epoch=114.8] | Loss=0.00986 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.765 | FP-Norm(final)=2.925 | 3767.5 samples/s | 58.9 steps/s
[Step=23600 Epoch=115.1] | Loss=0.00942 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.767 | FP-Norm(final)=2.925 | 4510.2 samples/s | 70.5 steps/s
[Step=23650 Epoch=115.3] | Loss=0.00885 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.926 | 1663.9 samples/s | 26.0 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00813 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.927 | 3759.8 samples/s | 58.7 steps/s
[Step=23750 Epoch=115.8] | Loss=0.00768 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.764 | FP-Norm(final)=2.928 | 3796.7 samples/s | 59.3 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00751 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.763 | FP-Norm(final)=2.929 | 4311.5 samples/s | 67.4 steps/s
[Step=23850 Epoch=116.3] | Loss=0.00716 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.761 | FP-Norm(final)=2.930 | 1688.1 samples/s | 26.4 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00687 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.759 | FP-Norm(final)=2.930 | 3808.5 samples/s | 59.5 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00664 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.757 | FP-Norm(final)=2.931 | 3784.7 samples/s | 59.1 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00641 | Reg=0.00058 | acc=1.0000 | FP-Norm=0.756 | FP-Norm(final)=2.932 | 4062.9 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step24000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.8] | Loss=0.18023 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.915 | 3774.7 samples/s | 59.0 steps/s
[Step=23250 Epoch=114.0] | Loss=0.01949 | Reg=0.00036 | acc=0.9531 | FP-Norm=0.577 | FP-Norm(final)=2.913 | 3526.2 samples/s | 55.1 steps/s
[Step=23300 Epoch=114.3] | Loss=0.01593 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.652 | FP-Norm(final)=2.912 | 3796.4 samples/s | 59.3 steps/s
[Step=23350 Epoch=114.5] | Loss=0.01364 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.913 | 3763.9 samples/s | 58.8 steps/s
[Step=23400 Epoch=114.7] | Loss=0.01279 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.709 | FP-Norm(final)=2.913 | 4924.6 samples/s | 76.9 steps/s
[Step=23450 Epoch=115.0] | Loss=0.01150 | Reg=0.00054 | acc=1.0000 | FP-Norm=0.725 | FP-Norm(final)=2.914 | 1619.3 samples/s | 25.3 steps/s
[Step=23500 Epoch=115.2] | Loss=0.01036 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.732 | FP-Norm(final)=2.915 | 3777.0 samples/s | 59.0 steps/s
[Step=23550 Epoch=115.5] | Loss=0.00962 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.735 | FP-Norm(final)=2.917 | 3787.0 samples/s | 59.2 steps/s
[Step=23600 Epoch=115.7] | Loss=0.00903 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.738 | FP-Norm(final)=2.919 | 4727.9 samples/s | 73.9 steps/s
[Step=23650 Epoch=116.0] | Loss=0.00827 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.738 | FP-Norm(final)=2.920 | 1637.3 samples/s | 25.6 steps/s
[Step=23700 Epoch=116.2] | Loss=0.00777 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.739 | FP-Norm(final)=2.922 | 3766.0 samples/s | 58.8 steps/s
[Step=23750 Epoch=116.5] | Loss=0.00745 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.739 | FP-Norm(final)=2.924 | 3752.4 samples/s | 58.6 steps/s
[Step=23800 Epoch=116.7] | Loss=0.00716 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.739 | FP-Norm(final)=2.925 | 4527.3 samples/s | 70.7 steps/s
[Step=23850 Epoch=117.0] | Loss=0.00696 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.738 | FP-Norm(final)=2.926 | 1665.6 samples/s | 26.0 steps/s
[Step=23900 Epoch=117.2] | Loss=0.00676 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.737 | FP-Norm(final)=2.928 | 3750.8 samples/s | 58.6 steps/s
[Step=23950 Epoch=117.4] | Loss=0.00656 | Reg=0.00055 | acc=0.9844 | FP-Norm=0.738 | FP-Norm(final)=2.929 | 3804.3 samples/s | 59.4 steps/s
[Step=24000 Epoch=117.7] | Loss=0.00647 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.738 | FP-Norm(final)=2.930 | 4327.1 samples/s | 67.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step24000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=219.8] | Loss=0.08558 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.915 | 3529.9 samples/s | 55.2 steps/s
[Step=23250 Epoch=220.3] | Loss=0.00782 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.837 | FP-Norm(final)=2.910 | 3523.6 samples/s | 55.1 steps/s
[Step=23300 Epoch=220.8] | Loss=0.00464 | Reg=0.00087 | acc=1.0000 | FP-Norm=0.911 | FP-Norm(final)=2.908 | 4657.7 samples/s | 72.8 steps/s
[Step=23350 Epoch=221.3] | Loss=0.00311 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.913 | FP-Norm(final)=2.907 | 1532.4 samples/s | 23.9 steps/s
[Step=23400 Epoch=221.7] | Loss=0.00235 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.900 | FP-Norm(final)=2.907 | 4337.5 samples/s | 67.8 steps/s
[Step=23450 Epoch=222.2] | Loss=0.00189 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.885 | FP-Norm(final)=2.908 | 1586.6 samples/s | 24.8 steps/s
[Step=23500 Epoch=222.7] | Loss=0.00158 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.869 | FP-Norm(final)=2.908 | 4100.3 samples/s | 64.1 steps/s
[Step=23550 Epoch=223.2] | Loss=0.00135 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.855 | FP-Norm(final)=2.908 | 1620.7 samples/s | 25.3 steps/s
[Step=23600 Epoch=223.6] | Loss=0.00119 | Reg=0.00072 | acc=1.0000 | FP-Norm=0.841 | FP-Norm(final)=2.909 | 3840.5 samples/s | 60.0 steps/s
[Step=23650 Epoch=224.1] | Loss=0.00106 | Reg=0.00070 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.909 | 1663.9 samples/s | 26.0 steps/s
[Step=23700 Epoch=224.6] | Loss=0.00096 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.817 | FP-Norm(final)=2.910 | 3635.8 samples/s | 56.8 steps/s
[Step=23750 Epoch=225.1] | Loss=0.00087 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.805 | FP-Norm(final)=2.910 | 1701.7 samples/s | 26.6 steps/s
[Step=23800 Epoch=225.5] | Loss=0.00080 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.795 | FP-Norm(final)=2.910 | 3559.5 samples/s | 55.6 steps/s
[Step=23850 Epoch=226.0] | Loss=0.00074 | Reg=0.00063 | acc=1.0000 | FP-Norm=0.785 | FP-Norm(final)=2.911 | 1742.5 samples/s | 27.2 steps/s
[Step=23900 Epoch=226.5] | Loss=0.00069 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.775 | FP-Norm(final)=2.911 | 3639.7 samples/s | 56.9 steps/s
[Step=23950 Epoch=226.9] | Loss=0.00064 | Reg=0.00060 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.912 | 1713.2 samples/s | 26.8 steps/s
[Step=24000 Epoch=227.4] | Loss=0.00060 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.757 | FP-Norm(final)=2.912 | 3534.2 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step24000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=220.7] | Loss=0.19186 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.914 | 3540.4 samples/s | 55.3 steps/s
[Step=23250 Epoch=221.2] | Loss=0.00944 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.910 | FP-Norm(final)=2.905 | 3460.5 samples/s | 54.1 steps/s
[Step=23300 Epoch=221.6] | Loss=0.00478 | Reg=0.00100 | acc=1.0000 | FP-Norm=0.981 | FP-Norm(final)=2.903 | 4742.7 samples/s | 74.1 steps/s
[Step=23350 Epoch=222.1] | Loss=0.00320 | Reg=0.00098 | acc=1.0000 | FP-Norm=0.975 | FP-Norm(final)=2.902 | 1547.5 samples/s | 24.2 steps/s
[Step=23400 Epoch=222.6] | Loss=0.00241 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.957 | FP-Norm(final)=2.903 | 4329.2 samples/s | 67.6 steps/s
[Step=23450 Epoch=223.1] | Loss=0.00193 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.937 | FP-Norm(final)=2.903 | 1621.7 samples/s | 25.3 steps/s
[Step=23500 Epoch=223.5] | Loss=0.00161 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.919 | FP-Norm(final)=2.903 | 4069.9 samples/s | 63.6 steps/s
[Step=23550 Epoch=224.0] | Loss=0.00139 | Reg=0.00083 | acc=1.0000 | FP-Norm=0.901 | FP-Norm(final)=2.904 | 1651.5 samples/s | 25.8 steps/s
[Step=23600 Epoch=224.5] | Loss=0.00122 | Reg=0.00080 | acc=1.0000 | FP-Norm=0.885 | FP-Norm(final)=2.904 | 3875.9 samples/s | 60.6 steps/s
[Step=23650 Epoch=225.0] | Loss=0.00108 | Reg=0.00077 | acc=1.0000 | FP-Norm=0.871 | FP-Norm(final)=2.904 | 1662.1 samples/s | 26.0 steps/s
[Step=23700 Epoch=225.4] | Loss=0.00098 | Reg=0.00075 | acc=1.0000 | FP-Norm=0.857 | FP-Norm(final)=2.905 | 3678.7 samples/s | 57.5 steps/s
[Step=23750 Epoch=225.9] | Loss=0.00089 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.844 | FP-Norm(final)=2.905 | 1710.8 samples/s | 26.7 steps/s
[Step=23800 Epoch=226.4] | Loss=0.00082 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.832 | FP-Norm(final)=2.906 | 3566.6 samples/s | 55.7 steps/s
[Step=23850 Epoch=226.9] | Loss=0.00075 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.820 | FP-Norm(final)=2.906 | 1703.0 samples/s | 26.6 steps/s
[Step=23900 Epoch=227.3] | Loss=0.00070 | Reg=0.00067 | acc=1.0000 | FP-Norm=0.810 | FP-Norm(final)=2.907 | 3596.1 samples/s | 56.2 steps/s
[Step=23950 Epoch=227.8] | Loss=0.00066 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.799 | FP-Norm(final)=2.907 | 1721.3 samples/s | 26.9 steps/s
[Step=24000 Epoch=228.3] | Loss=0.00062 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.789 | FP-Norm(final)=2.907 | 3561.1 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step24000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=221.6] | Loss=0.06638 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.915 | 3637.0 samples/s | 56.8 steps/s
[Step=23250 Epoch=222.0] | Loss=0.00971 | Reg=0.00125 | acc=1.0000 | FP-Norm=1.071 | FP-Norm(final)=2.906 | 3390.8 samples/s | 53.0 steps/s
[Step=23300 Epoch=222.5] | Loss=0.00493 | Reg=0.00137 | acc=1.0000 | FP-Norm=1.144 | FP-Norm(final)=2.903 | 4715.4 samples/s | 73.7 steps/s
[Step=23350 Epoch=223.0] | Loss=0.00330 | Reg=0.00133 | acc=1.0000 | FP-Norm=1.134 | FP-Norm(final)=2.902 | 1554.9 samples/s | 24.3 steps/s
[Step=23400 Epoch=223.5] | Loss=0.00248 | Reg=0.00127 | acc=1.0000 | FP-Norm=1.113 | FP-Norm(final)=2.902 | 4409.4 samples/s | 68.9 steps/s
[Step=23450 Epoch=223.9] | Loss=0.00199 | Reg=0.00122 | acc=1.0000 | FP-Norm=1.090 | FP-Norm(final)=2.902 | 1564.3 samples/s | 24.4 steps/s
[Step=23500 Epoch=224.4] | Loss=0.00166 | Reg=0.00117 | acc=1.0000 | FP-Norm=1.069 | FP-Norm(final)=2.902 | 4216.1 samples/s | 65.9 steps/s
[Step=23550 Epoch=224.9] | Loss=0.00143 | Reg=0.00113 | acc=1.0000 | FP-Norm=1.050 | FP-Norm(final)=2.903 | 1605.1 samples/s | 25.1 steps/s
[Step=23600 Epoch=225.4] | Loss=0.00125 | Reg=0.00109 | acc=1.0000 | FP-Norm=1.032 | FP-Norm(final)=2.903 | 3999.5 samples/s | 62.5 steps/s
[Step=23650 Epoch=225.8] | Loss=0.00111 | Reg=0.00105 | acc=1.0000 | FP-Norm=1.015 | FP-Norm(final)=2.903 | 1638.6 samples/s | 25.6 steps/s
[Step=23700 Epoch=226.3] | Loss=0.00100 | Reg=0.00102 | acc=1.0000 | FP-Norm=1.000 | FP-Norm(final)=2.903 | 3804.5 samples/s | 59.4 steps/s
[Step=23750 Epoch=226.8] | Loss=0.00092 | Reg=0.00099 | acc=1.0000 | FP-Norm=0.985 | FP-Norm(final)=2.904 | 1667.2 samples/s | 26.0 steps/s
[Step=23800 Epoch=227.3] | Loss=0.00084 | Reg=0.00097 | acc=1.0000 | FP-Norm=0.972 | FP-Norm(final)=2.904 | 3641.5 samples/s | 56.9 steps/s
[Step=23850 Epoch=227.8] | Loss=0.00078 | Reg=0.00094 | acc=1.0000 | FP-Norm=0.959 | FP-Norm(final)=2.904 | 1716.5 samples/s | 26.8 steps/s
[Step=23900 Epoch=228.2] | Loss=0.00072 | Reg=0.00092 | acc=1.0000 | FP-Norm=0.947 | FP-Norm(final)=2.905 | 3616.1 samples/s | 56.5 steps/s
[Step=23950 Epoch=228.7] | Loss=0.00068 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.935 | FP-Norm(final)=2.905 | 1727.2 samples/s | 27.0 steps/s
[Step=24000 Epoch=229.2] | Loss=0.00063 | Reg=0.00088 | acc=1.0000 | FP-Norm=0.924 | FP-Norm(final)=2.905 | 3651.6 samples/s | 57.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step24000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=218.6] | Loss=0.08810 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.914 | 3670.4 samples/s | 57.4 steps/s
[Step=23250 Epoch=219.1] | Loss=0.00585 | Reg=0.00090 | acc=1.0000 | FP-Norm=0.904 | FP-Norm(final)=2.911 | 3272.1 samples/s | 51.1 steps/s
[Step=23300 Epoch=219.6] | Loss=0.00299 | Reg=0.00095 | acc=1.0000 | FP-Norm=0.952 | FP-Norm(final)=2.913 | 4567.1 samples/s | 71.4 steps/s
[Step=23350 Epoch=220.0] | Loss=0.00200 | Reg=0.00091 | acc=1.0000 | FP-Norm=0.936 | FP-Norm(final)=2.913 | 1545.9 samples/s | 24.2 steps/s
[Step=23400 Epoch=220.5] | Loss=0.00151 | Reg=0.00086 | acc=1.0000 | FP-Norm=0.913 | FP-Norm(final)=2.914 | 4232.7 samples/s | 66.1 steps/s
[Step=23450 Epoch=221.0] | Loss=0.00121 | Reg=0.00081 | acc=1.0000 | FP-Norm=0.890 | FP-Norm(final)=2.914 | 1610.4 samples/s | 25.2 steps/s
[Step=23500 Epoch=221.4] | Loss=0.00101 | Reg=0.00078 | acc=1.0000 | FP-Norm=0.869 | FP-Norm(final)=2.915 | 3918.3 samples/s | 61.2 steps/s
[Step=23550 Epoch=221.9] | Loss=0.00087 | Reg=0.00074 | acc=1.0000 | FP-Norm=0.851 | FP-Norm(final)=2.915 | 1650.3 samples/s | 25.8 steps/s
[Step=23600 Epoch=222.4] | Loss=0.00076 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.834 | FP-Norm(final)=2.915 | 3670.3 samples/s | 57.3 steps/s
[Step=23650 Epoch=222.9] | Loss=0.00068 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.818 | FP-Norm(final)=2.915 | 1694.4 samples/s | 26.5 steps/s
[Step=23700 Epoch=223.3] | Loss=0.00061 | Reg=0.00066 | acc=1.0000 | FP-Norm=0.804 | FP-Norm(final)=2.916 | 3578.8 samples/s | 55.9 steps/s
[Step=23750 Epoch=223.8] | Loss=0.00056 | Reg=0.00064 | acc=1.0000 | FP-Norm=0.790 | FP-Norm(final)=2.916 | 1726.9 samples/s | 27.0 steps/s
[Step=23800 Epoch=224.3] | Loss=0.00051 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.916 | 3595.3 samples/s | 56.2 steps/s
[Step=23850 Epoch=224.7] | Loss=0.00048 | Reg=0.00061 | acc=1.0000 | FP-Norm=0.766 | FP-Norm(final)=2.916 | 1732.8 samples/s | 27.1 steps/s
[Step=23900 Epoch=225.2] | Loss=0.00044 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.755 | FP-Norm(final)=2.916 | 3580.6 samples/s | 55.9 steps/s
[Step=23950 Epoch=225.7] | Loss=0.00041 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.745 | FP-Norm(final)=2.917 | 1824.6 samples/s | 28.5 steps/s
[Step=24000 Epoch=226.1] | Loss=0.00039 | Reg=0.00056 | acc=1.0000 | FP-Norm=0.735 | FP-Norm(final)=2.917 | 3227.6 samples/s | 50.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step24000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=221.1] | Loss=0.05113 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.915 | 3670.3 samples/s | 57.3 steps/s
[Step=23250 Epoch=221.6] | Loss=0.00417 | Reg=0.00069 | acc=1.0000 | FP-Norm=0.798 | FP-Norm(final)=2.915 | 3160.2 samples/s | 49.4 steps/s
[Step=23300 Epoch=222.1] | Loss=0.00220 | Reg=0.00073 | acc=1.0000 | FP-Norm=0.838 | FP-Norm(final)=2.917 | 4689.3 samples/s | 73.3 steps/s
[Step=23350 Epoch=222.5] | Loss=0.00148 | Reg=0.00071 | acc=1.0000 | FP-Norm=0.829 | FP-Norm(final)=2.918 | 1536.5 samples/s | 24.0 steps/s
[Step=23400 Epoch=223.0] | Loss=0.00112 | Reg=0.00068 | acc=1.0000 | FP-Norm=0.812 | FP-Norm(final)=2.919 | 4407.6 samples/s | 68.9 steps/s
[Step=23450 Epoch=223.5] | Loss=0.00090 | Reg=0.00065 | acc=1.0000 | FP-Norm=0.794 | FP-Norm(final)=2.920 | 1579.7 samples/s | 24.7 steps/s
[Step=23500 Epoch=224.0] | Loss=0.00075 | Reg=0.00062 | acc=1.0000 | FP-Norm=0.778 | FP-Norm(final)=2.920 | 4153.2 samples/s | 64.9 steps/s
[Step=23550 Epoch=224.5] | Loss=0.00065 | Reg=0.00059 | acc=1.0000 | FP-Norm=0.762 | FP-Norm(final)=2.920 | 1602.4 samples/s | 25.0 steps/s
[Step=23600 Epoch=224.9] | Loss=0.00057 | Reg=0.00057 | acc=1.0000 | FP-Norm=0.748 | FP-Norm(final)=2.920 | 3987.0 samples/s | 62.3 steps/s
[Step=23650 Epoch=225.4] | Loss=0.00051 | Reg=0.00055 | acc=1.0000 | FP-Norm=0.734 | FP-Norm(final)=2.921 | 1622.3 samples/s | 25.3 steps/s
[Step=23700 Epoch=225.9] | Loss=0.00046 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.722 | FP-Norm(final)=2.921 | 3784.3 samples/s | 59.1 steps/s
[Step=23750 Epoch=226.4] | Loss=0.00042 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.710 | FP-Norm(final)=2.921 | 1679.6 samples/s | 26.2 steps/s
[Step=23800 Epoch=226.8] | Loss=0.00039 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.700 | FP-Norm(final)=2.921 | 3605.9 samples/s | 56.3 steps/s
[Step=23850 Epoch=227.3] | Loss=0.00036 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.689 | FP-Norm(final)=2.921 | 1708.3 samples/s | 26.7 steps/s
[Step=23900 Epoch=227.8] | Loss=0.00033 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.680 | FP-Norm(final)=2.921 | 3583.1 samples/s | 56.0 steps/s
[Step=23950 Epoch=228.3] | Loss=0.00031 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.671 | FP-Norm(final)=2.922 | 1715.4 samples/s | 26.8 steps/s
[Step=24000 Epoch=228.7] | Loss=0.00029 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.662 | FP-Norm(final)=2.922 | 3631.4 samples/s | 56.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20829 | acc=0.8764 | tpr=0.8283 | fpr=0.0191 | 3650.8 samples/s | 14.3 steps/s
Avg test loss: 0.21027, Avg test acc: 0.87619, Avg tpr: 0.82940, Avg fpr: 0.02089, total FA: 163

Testing server on iccad2012
[Step=  50] | Loss=0.49908 | acc=0.8473 | tpr=0.9735 | fpr=0.1549 | 3651.9 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.52074 | acc=0.8447 | tpr=0.9744 | fpr=0.1577 | 6784.4 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.53158 | acc=0.8418 | tpr=0.9697 | fpr=0.1606 | 6917.6 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.53114 | acc=0.8420 | tpr=0.9727 | fpr=0.1604 | 6965.2 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.52905 | acc=0.8415 | tpr=0.9677 | fpr=0.1608 | 6808.5 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.53316 | acc=0.8412 | tpr=0.9665 | fpr=0.1610 | 6872.8 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.53355 | acc=0.8417 | tpr=0.9674 | fpr=0.1606 | 6984.6 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.53402 | acc=0.8415 | tpr=0.9683 | fpr=0.1608 | 6624.2 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.53767 | acc=0.8413 | tpr=0.9679 | fpr=0.1610 | 6989.4 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.53824 | acc=0.8410 | tpr=0.9687 | fpr=0.1613 | 6742.1 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.53754 | acc=0.8412 | tpr=0.9690 | fpr=0.1611 | 12616.7 samples/s | 49.3 steps/s
Avg test loss: 0.53752, Avg test acc: 0.84126, Avg tpr: 0.96910, Avg fpr: 0.16107, total FA: 22364

server round 30/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.0] | Loss=0.20295 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.928 | 3697.9 samples/s | 57.8 steps/s
[Step=24050 Epoch=117.3] | Loss=0.02448 | Reg=0.00027 | acc=0.9688 | FP-Norm=0.491 | FP-Norm(final)=2.926 | 3631.3 samples/s | 56.7 steps/s
[Step=24100 Epoch=117.5] | Loss=0.01680 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.534 | FP-Norm(final)=2.927 | 3786.3 samples/s | 59.2 steps/s
[Step=24150 Epoch=117.8] | Loss=0.01310 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.543 | FP-Norm(final)=2.929 | 3784.8 samples/s | 59.1 steps/s
[Step=24200 Epoch=118.0] | Loss=0.01211 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.930 | 4843.8 samples/s | 75.7 steps/s
[Step=24250 Epoch=118.2] | Loss=0.01057 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.932 | 1619.6 samples/s | 25.3 steps/s
[Step=24300 Epoch=118.5] | Loss=0.00949 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.546 | FP-Norm(final)=2.933 | 3799.8 samples/s | 59.4 steps/s
[Step=24350 Epoch=118.7] | Loss=0.00874 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.935 | 3802.6 samples/s | 59.4 steps/s
[Step=24400 Epoch=119.0] | Loss=0.00808 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.936 | 4519.6 samples/s | 70.6 steps/s
[Step=24450 Epoch=119.2] | Loss=0.00759 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.938 | 1615.4 samples/s | 25.2 steps/s
[Step=24500 Epoch=119.5] | Loss=0.00717 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.940 | 3713.6 samples/s | 58.0 steps/s
[Step=24550 Epoch=119.7] | Loss=0.00686 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.941 | 3750.5 samples/s | 58.6 steps/s
[Step=24600 Epoch=120.0] | Loss=0.00650 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.942 | 4317.8 samples/s | 67.5 steps/s
[Step=24650 Epoch=120.2] | Loss=0.00621 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.944 | 1690.8 samples/s | 26.4 steps/s
[Step=24700 Epoch=120.4] | Loss=0.00595 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.534 | FP-Norm(final)=2.945 | 3765.0 samples/s | 58.8 steps/s
[Step=24750 Epoch=120.7] | Loss=0.00583 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.534 | FP-Norm(final)=2.946 | 3773.8 samples/s | 59.0 steps/s
[Step=24800 Epoch=120.9] | Loss=0.00574 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=2.948 | 4081.7 samples/s | 63.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step24800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.1] | Loss=0.03536 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.928 | 3682.0 samples/s | 57.5 steps/s
[Step=24050 Epoch=117.4] | Loss=0.02550 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=2.925 | 3746.5 samples/s | 58.5 steps/s
[Step=24100 Epoch=117.6] | Loss=0.01799 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.925 | 3785.0 samples/s | 59.1 steps/s
[Step=24150 Epoch=117.8] | Loss=0.01439 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.926 | 3804.7 samples/s | 59.4 steps/s
[Step=24200 Epoch=118.1] | Loss=0.01200 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.928 | 4796.2 samples/s | 74.9 steps/s
[Step=24250 Epoch=118.3] | Loss=0.01054 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=2.930 | 1634.1 samples/s | 25.5 steps/s
[Step=24300 Epoch=118.6] | Loss=0.00930 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.932 | 3793.6 samples/s | 59.3 steps/s
[Step=24350 Epoch=118.8] | Loss=0.00851 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.934 | 3788.0 samples/s | 59.2 steps/s
[Step=24400 Epoch=119.1] | Loss=0.00790 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=2.936 | 4604.7 samples/s | 71.9 steps/s
[Step=24450 Epoch=119.3] | Loss=0.00753 | Reg=0.00032 | acc=0.9844 | FP-Norm=0.557 | FP-Norm(final)=2.938 | 1663.4 samples/s | 26.0 steps/s
[Step=24500 Epoch=119.5] | Loss=0.00708 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.939 | 3755.0 samples/s | 58.7 steps/s
[Step=24550 Epoch=119.8] | Loss=0.00684 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=2.941 | 3781.2 samples/s | 59.1 steps/s
[Step=24600 Epoch=120.0] | Loss=0.00646 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.942 | 4418.1 samples/s | 69.0 steps/s
[Step=24650 Epoch=120.3] | Loss=0.00629 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.944 | 1670.7 samples/s | 26.1 steps/s
[Step=24700 Epoch=120.5] | Loss=0.00604 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.945 | 3767.2 samples/s | 58.9 steps/s
[Step=24750 Epoch=120.8] | Loss=0.00587 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.946 | 3784.5 samples/s | 59.1 steps/s
[Step=24800 Epoch=121.0] | Loss=0.00578 | Reg=0.00030 | acc=0.9688 | FP-Norm=0.543 | FP-Norm(final)=2.947 | 4222.0 samples/s | 66.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step24800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=116.9] | Loss=0.05150 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.928 | 3847.6 samples/s | 60.1 steps/s
[Step=24050 Epoch=117.2] | Loss=0.02693 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=2.926 | 3482.2 samples/s | 54.4 steps/s
[Step=24100 Epoch=117.4] | Loss=0.01812 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.926 | 3805.8 samples/s | 59.5 steps/s
[Step=24150 Epoch=117.7] | Loss=0.01539 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.928 | 3801.9 samples/s | 59.4 steps/s
[Step=24200 Epoch=117.9] | Loss=0.01277 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.929 | 4847.1 samples/s | 75.7 steps/s
[Step=24250 Epoch=118.2] | Loss=0.01077 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=2.931 | 1634.7 samples/s | 25.5 steps/s
[Step=24300 Epoch=118.4] | Loss=0.00958 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=2.933 | 3785.8 samples/s | 59.2 steps/s
[Step=24350 Epoch=118.6] | Loss=0.00900 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.544 | FP-Norm(final)=2.935 | 3792.4 samples/s | 59.3 steps/s
[Step=24400 Epoch=118.9] | Loss=0.00837 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.936 | 4541.5 samples/s | 71.0 steps/s
[Step=24450 Epoch=119.1] | Loss=0.00775 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.938 | 1655.2 samples/s | 25.9 steps/s
[Step=24500 Epoch=119.4] | Loss=0.00731 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.940 | 3746.3 samples/s | 58.5 steps/s
[Step=24550 Epoch=119.6] | Loss=0.00693 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.942 | 3786.1 samples/s | 59.2 steps/s
[Step=24600 Epoch=119.9] | Loss=0.00651 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.944 | 4265.0 samples/s | 66.6 steps/s
[Step=24650 Epoch=120.1] | Loss=0.00621 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.945 | 1712.5 samples/s | 26.8 steps/s
[Step=24700 Epoch=120.4] | Loss=0.00596 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.947 | 3773.5 samples/s | 59.0 steps/s
[Step=24750 Epoch=120.6] | Loss=0.00573 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.949 | 3785.5 samples/s | 59.1 steps/s
[Step=24800 Epoch=120.8] | Loss=0.00558 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.950 | 4058.4 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step24800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.0] | Loss=0.04389 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.928 | 3536.0 samples/s | 55.3 steps/s
[Step=24050 Epoch=117.3] | Loss=0.02097 | Reg=0.00025 | acc=0.9531 | FP-Norm=0.468 | FP-Norm(final)=2.930 | 3798.8 samples/s | 59.4 steps/s
[Step=24100 Epoch=117.5] | Loss=0.01435 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=2.930 | 3740.2 samples/s | 58.4 steps/s
[Step=24150 Epoch=117.8] | Loss=0.01201 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.932 | 3785.4 samples/s | 59.1 steps/s
[Step=24200 Epoch=118.0] | Loss=0.01037 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.934 | 4855.5 samples/s | 75.9 steps/s
[Step=24250 Epoch=118.3] | Loss=0.00895 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.936 | 1621.4 samples/s | 25.3 steps/s
[Step=24300 Epoch=118.5] | Loss=0.00805 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.938 | 3776.7 samples/s | 59.0 steps/s
[Step=24350 Epoch=118.7] | Loss=0.00737 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.940 | 3807.9 samples/s | 59.5 steps/s
[Step=24400 Epoch=119.0] | Loss=0.00684 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=2.942 | 4525.0 samples/s | 70.7 steps/s
[Step=24450 Epoch=119.2] | Loss=0.00639 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.944 | 1663.5 samples/s | 26.0 steps/s
[Step=24500 Epoch=119.5] | Loss=0.00599 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.945 | 3739.0 samples/s | 58.4 steps/s
[Step=24550 Epoch=119.7] | Loss=0.00573 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.534 | FP-Norm(final)=2.947 | 3776.9 samples/s | 59.0 steps/s
[Step=24600 Epoch=120.0] | Loss=0.00552 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=2.949 | 4281.0 samples/s | 66.9 steps/s
[Step=24650 Epoch=120.2] | Loss=0.00529 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.950 | 1699.8 samples/s | 26.6 steps/s
[Step=24700 Epoch=120.5] | Loss=0.00511 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.951 | 3793.6 samples/s | 59.3 steps/s
[Step=24750 Epoch=120.7] | Loss=0.00497 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.953 | 3739.7 samples/s | 58.4 steps/s
[Step=24800 Epoch=120.9] | Loss=0.00483 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.528 | FP-Norm(final)=2.954 | 4047.9 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step24800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.7] | Loss=0.11553 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.928 | 3787.9 samples/s | 59.2 steps/s
[Step=24050 Epoch=117.9] | Loss=0.02099 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.430 | FP-Norm(final)=2.930 | 3596.8 samples/s | 56.2 steps/s
[Step=24100 Epoch=118.2] | Loss=0.01538 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.468 | FP-Norm(final)=2.931 | 3759.5 samples/s | 58.7 steps/s
[Step=24150 Epoch=118.4] | Loss=0.01246 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=2.932 | 3782.0 samples/s | 59.1 steps/s
[Step=24200 Epoch=118.7] | Loss=0.01085 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=2.933 | 4898.6 samples/s | 76.5 steps/s
[Step=24250 Epoch=118.9] | Loss=0.00935 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=2.935 | 1617.9 samples/s | 25.3 steps/s
[Step=24300 Epoch=119.2] | Loss=0.00831 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=2.937 | 3780.1 samples/s | 59.1 steps/s
[Step=24350 Epoch=119.4] | Loss=0.00760 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.499 | FP-Norm(final)=2.939 | 3787.9 samples/s | 59.2 steps/s
[Step=24400 Epoch=119.7] | Loss=0.00708 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=2.940 | 4685.8 samples/s | 73.2 steps/s
[Step=24450 Epoch=119.9] | Loss=0.00665 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.942 | 1645.8 samples/s | 25.7 steps/s
[Step=24500 Epoch=120.1] | Loss=0.00628 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.944 | 3789.8 samples/s | 59.2 steps/s
[Step=24550 Epoch=120.4] | Loss=0.00600 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=2.945 | 3792.3 samples/s | 59.3 steps/s
[Step=24600 Epoch=120.6] | Loss=0.00571 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.499 | FP-Norm(final)=2.947 | 4482.8 samples/s | 70.0 steps/s
[Step=24650 Epoch=120.9] | Loss=0.00539 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=2.948 | 1655.8 samples/s | 25.9 steps/s
[Step=24700 Epoch=121.1] | Loss=0.00516 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.950 | 3787.3 samples/s | 59.2 steps/s
[Step=24750 Epoch=121.4] | Loss=0.00499 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.951 | 3782.3 samples/s | 59.1 steps/s
[Step=24800 Epoch=121.6] | Loss=0.00483 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.953 | 4369.6 samples/s | 68.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step24800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=227.4] | Loss=0.27848 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.927 | 3538.0 samples/s | 55.3 steps/s
[Step=24050 Epoch=227.9] | Loss=0.01007 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.631 | FP-Norm(final)=2.925 | 3331.1 samples/s | 52.0 steps/s
[Step=24100 Epoch=228.4] | Loss=0.00528 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.656 | FP-Norm(final)=2.925 | 4661.0 samples/s | 72.8 steps/s
[Step=24150 Epoch=228.8] | Loss=0.00354 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.652 | FP-Norm(final)=2.925 | 1542.9 samples/s | 24.1 steps/s
[Step=24200 Epoch=229.3] | Loss=0.00267 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.640 | FP-Norm(final)=2.925 | 4352.2 samples/s | 68.0 steps/s
[Step=24250 Epoch=229.8] | Loss=0.00214 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.628 | FP-Norm(final)=2.926 | 1576.2 samples/s | 24.6 steps/s
[Step=24300 Epoch=230.3] | Loss=0.00179 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.616 | FP-Norm(final)=2.926 | 4045.5 samples/s | 63.2 steps/s
[Step=24350 Epoch=230.7] | Loss=0.00154 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.606 | FP-Norm(final)=2.926 | 1643.4 samples/s | 25.7 steps/s
[Step=24400 Epoch=231.2] | Loss=0.00135 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.926 | 3794.3 samples/s | 59.3 steps/s
[Step=24450 Epoch=231.7] | Loss=0.00121 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.586 | FP-Norm(final)=2.926 | 1637.9 samples/s | 25.6 steps/s
[Step=24500 Epoch=232.2] | Loss=0.00109 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.927 | 3620.8 samples/s | 56.6 steps/s
[Step=24550 Epoch=232.6] | Loss=0.00099 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.927 | 1683.2 samples/s | 26.3 steps/s
[Step=24600 Epoch=233.1] | Loss=0.00091 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.927 | 3605.3 samples/s | 56.3 steps/s
[Step=24650 Epoch=233.6] | Loss=0.00084 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.927 | 1720.0 samples/s | 26.9 steps/s
[Step=24700 Epoch=234.1] | Loss=0.00079 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.927 | 3593.8 samples/s | 56.2 steps/s
[Step=24750 Epoch=234.5] | Loss=0.00073 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.928 | 1719.2 samples/s | 26.9 steps/s
[Step=24800 Epoch=235.0] | Loss=0.00069 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.928 | 3564.7 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step24800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=228.3] | Loss=0.14909 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.928 | 3410.0 samples/s | 53.3 steps/s
[Step=24050 Epoch=228.8] | Loss=0.00471 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.930 | 3492.8 samples/s | 54.6 steps/s
[Step=24100 Epoch=229.3] | Loss=0.00238 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.586 | FP-Norm(final)=2.931 | 4692.3 samples/s | 73.3 steps/s
[Step=24150 Epoch=229.7] | Loss=0.00160 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=2.931 | 1550.0 samples/s | 24.2 steps/s
[Step=24200 Epoch=230.2] | Loss=0.00121 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.931 | 4374.8 samples/s | 68.4 steps/s
[Step=24250 Epoch=230.7] | Loss=0.00098 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.932 | 1594.6 samples/s | 24.9 steps/s
[Step=24300 Epoch=231.2] | Loss=0.00082 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.932 | 4060.2 samples/s | 63.4 steps/s
[Step=24350 Epoch=231.6] | Loss=0.00071 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.932 | 1630.5 samples/s | 25.5 steps/s
[Step=24400 Epoch=232.1] | Loss=0.00062 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.520 | FP-Norm(final)=2.932 | 3856.1 samples/s | 60.3 steps/s
[Step=24450 Epoch=232.6] | Loss=0.00056 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.932 | 1655.2 samples/s | 25.9 steps/s
[Step=24500 Epoch=233.1] | Loss=0.00050 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=2.933 | 3630.6 samples/s | 56.7 steps/s
[Step=24550 Epoch=233.5] | Loss=0.00046 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=2.933 | 1696.3 samples/s | 26.5 steps/s
[Step=24600 Epoch=234.0] | Loss=0.00042 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.933 | 3591.3 samples/s | 56.1 steps/s
[Step=24650 Epoch=234.5] | Loss=0.00039 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=2.933 | 1701.0 samples/s | 26.6 steps/s
[Step=24700 Epoch=235.0] | Loss=0.00037 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.479 | FP-Norm(final)=2.933 | 3586.5 samples/s | 56.0 steps/s
[Step=24750 Epoch=235.4] | Loss=0.00034 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.474 | FP-Norm(final)=2.933 | 1736.7 samples/s | 27.1 steps/s
[Step=24800 Epoch=235.9] | Loss=0.00032 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.469 | FP-Norm(final)=2.933 | 3554.9 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step24800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=229.2] | Loss=0.00797 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.928 | 3446.0 samples/s | 53.8 steps/s
[Step=24050 Epoch=229.7] | Loss=0.00647 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=2.928 | 3472.5 samples/s | 54.3 steps/s
[Step=24100 Epoch=230.1] | Loss=0.00329 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=2.929 | 4724.4 samples/s | 73.8 steps/s
[Step=24150 Epoch=230.6] | Loss=0.00221 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=2.930 | 1534.4 samples/s | 24.0 steps/s
[Step=24200 Epoch=231.1] | Loss=0.00167 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.564 | FP-Norm(final)=2.930 | 4397.3 samples/s | 68.7 steps/s
[Step=24250 Epoch=231.6] | Loss=0.00134 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.930 | 1567.4 samples/s | 24.5 steps/s
[Step=24300 Epoch=232.1] | Loss=0.00113 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.931 | 4191.8 samples/s | 65.5 steps/s
[Step=24350 Epoch=232.5] | Loss=0.00097 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.931 | 1599.2 samples/s | 25.0 steps/s
[Step=24400 Epoch=233.0] | Loss=0.00085 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=2.931 | 3978.7 samples/s | 62.2 steps/s
[Step=24450 Epoch=233.5] | Loss=0.00076 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=2.931 | 1635.3 samples/s | 25.6 steps/s
[Step=24500 Epoch=234.0] | Loss=0.00069 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.931 | 3808.8 samples/s | 59.5 steps/s
[Step=24550 Epoch=234.4] | Loss=0.00063 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=2.932 | 1666.9 samples/s | 26.0 steps/s
[Step=24600 Epoch=234.9] | Loss=0.00058 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=2.932 | 3633.6 samples/s | 56.8 steps/s
[Step=24650 Epoch=235.4] | Loss=0.00054 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.932 | 1715.3 samples/s | 26.8 steps/s
[Step=24700 Epoch=235.9] | Loss=0.00050 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.487 | FP-Norm(final)=2.932 | 3533.7 samples/s | 55.2 steps/s
[Step=24750 Epoch=236.3] | Loss=0.00047 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.482 | FP-Norm(final)=2.932 | 1717.1 samples/s | 26.8 steps/s
[Step=24800 Epoch=236.8] | Loss=0.00044 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.477 | FP-Norm(final)=2.933 | 3618.5 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step24800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=226.2] | Loss=0.12075 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.928 | 3558.3 samples/s | 55.6 steps/s
[Step=24050 Epoch=226.6] | Loss=0.00736 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.615 | FP-Norm(final)=2.927 | 3312.4 samples/s | 51.8 steps/s
[Step=24100 Epoch=227.1] | Loss=0.00371 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.639 | FP-Norm(final)=2.927 | 4607.8 samples/s | 72.0 steps/s
[Step=24150 Epoch=227.6] | Loss=0.00249 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.632 | FP-Norm(final)=2.928 | 1559.6 samples/s | 24.4 steps/s
[Step=24200 Epoch=228.0] | Loss=0.00187 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.928 | 4250.8 samples/s | 66.4 steps/s
[Step=24250 Epoch=228.5] | Loss=0.00150 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=2.928 | 1583.2 samples/s | 24.7 steps/s
[Step=24300 Epoch=229.0] | Loss=0.00126 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.599 | FP-Norm(final)=2.928 | 3966.5 samples/s | 62.0 steps/s
[Step=24350 Epoch=229.4] | Loss=0.00108 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.588 | FP-Norm(final)=2.928 | 1641.1 samples/s | 25.6 steps/s
[Step=24400 Epoch=229.9] | Loss=0.00095 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.928 | 3714.5 samples/s | 58.0 steps/s
[Step=24450 Epoch=230.4] | Loss=0.00084 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.928 | 1692.6 samples/s | 26.4 steps/s
[Step=24500 Epoch=230.9] | Loss=0.00076 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.928 | 3546.8 samples/s | 55.4 steps/s
[Step=24550 Epoch=231.3] | Loss=0.00070 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.929 | 1724.9 samples/s | 27.0 steps/s
[Step=24600 Epoch=231.8] | Loss=0.00064 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.549 | FP-Norm(final)=2.929 | 3549.9 samples/s | 55.5 steps/s
[Step=24650 Epoch=232.3] | Loss=0.00059 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.929 | 1737.2 samples/s | 27.1 steps/s
[Step=24700 Epoch=232.7] | Loss=0.00055 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.929 | 3548.2 samples/s | 55.4 steps/s
[Step=24750 Epoch=233.2] | Loss=0.00051 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.929 | 1778.5 samples/s | 27.8 steps/s
[Step=24800 Epoch=233.7] | Loss=0.00048 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.526 | FP-Norm(final)=2.929 | 3403.4 samples/s | 53.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step24800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=228.8] | Loss=0.04553 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.928 | 3635.0 samples/s | 56.8 steps/s
[Step=24050 Epoch=229.2] | Loss=0.00563 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.585 | FP-Norm(final)=2.929 | 3255.4 samples/s | 50.9 steps/s
[Step=24100 Epoch=229.7] | Loss=0.00293 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.604 | FP-Norm(final)=2.930 | 4643.7 samples/s | 72.6 steps/s
[Step=24150 Epoch=230.2] | Loss=0.00198 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.931 | 1534.7 samples/s | 24.0 steps/s
[Step=24200 Epoch=230.6] | Loss=0.00149 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.584 | FP-Norm(final)=2.931 | 4426.0 samples/s | 69.2 steps/s
[Step=24250 Epoch=231.1] | Loss=0.00120 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=2.932 | 1578.0 samples/s | 24.7 steps/s
[Step=24300 Epoch=231.6] | Loss=0.00101 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.932 | 4188.1 samples/s | 65.4 steps/s
[Step=24350 Epoch=232.1] | Loss=0.00087 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=2.932 | 1604.5 samples/s | 25.1 steps/s
[Step=24400 Epoch=232.6] | Loss=0.00077 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.932 | 3975.5 samples/s | 62.1 steps/s
[Step=24450 Epoch=233.0] | Loss=0.00069 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=2.933 | 1650.1 samples/s | 25.8 steps/s
[Step=24500 Epoch=233.5] | Loss=0.00062 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=2.933 | 3767.5 samples/s | 58.9 steps/s
[Step=24550 Epoch=234.0] | Loss=0.00057 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.933 | 1664.5 samples/s | 26.0 steps/s
[Step=24600 Epoch=234.5] | Loss=0.00052 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.933 | 3644.6 samples/s | 56.9 steps/s
[Step=24650 Epoch=234.9] | Loss=0.00048 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=2.933 | 1713.8 samples/s | 26.8 steps/s
[Step=24700 Epoch=235.4] | Loss=0.00045 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=2.934 | 3609.8 samples/s | 56.4 steps/s
[Step=24750 Epoch=235.9] | Loss=0.00042 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.934 | 1708.9 samples/s | 26.7 steps/s
[Step=24800 Epoch=236.4] | Loss=0.00040 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.488 | FP-Norm(final)=2.934 | 3619.7 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18885 | acc=0.8939 | tpr=0.8542 | fpr=0.0198 | 3672.0 samples/s | 14.3 steps/s
Avg test loss: 0.19135, Avg test acc: 0.89286, Avg tpr: 0.85405, Avg fpr: 0.02179, total FA: 170

Testing server on iccad2012
[Step=  50] | Loss=0.53576 | acc=0.8384 | tpr=0.9779 | fpr=0.1641 | 3623.9 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.55814 | acc=0.8357 | tpr=0.9787 | fpr=0.1669 | 7225.5 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.57026 | acc=0.8334 | tpr=0.9726 | fpr=0.1691 | 6704.1 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.57017 | acc=0.8339 | tpr=0.9760 | fpr=0.1687 | 6874.5 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.56774 | acc=0.8333 | tpr=0.9703 | fpr=0.1692 | 4240.5 samples/s | 16.6 steps/s
[Step= 300] | Loss=0.57203 | acc=0.8331 | tpr=0.9695 | fpr=0.1693 | 6801.3 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.57245 | acc=0.8335 | tpr=0.9699 | fpr=0.1690 | 6889.8 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.57318 | acc=0.8332 | tpr=0.9705 | fpr=0.1693 | 6758.5 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.57717 | acc=0.8332 | tpr=0.9703 | fpr=0.1693 | 6768.3 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.57768 | acc=0.8329 | tpr=0.9714 | fpr=0.1696 | 6748.4 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.57706 | acc=0.8331 | tpr=0.9713 | fpr=0.1695 | 12424.6 samples/s | 48.5 steps/s
Avg test loss: 0.57702, Avg test acc: 0.83309, Avg tpr: 0.97147, Avg fpr: 0.16943, total FA: 23525

server round 31/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=120.9] | Loss=0.07142 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.952 | 3855.6 samples/s | 60.2 steps/s
[Step=24850 Epoch=121.2] | Loss=0.02556 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.951 | 3478.5 samples/s | 54.4 steps/s
[Step=24900 Epoch=121.4] | Loss=0.01879 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.529 | FP-Norm(final)=2.950 | 3773.9 samples/s | 59.0 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01514 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.951 | 3813.9 samples/s | 59.6 steps/s
[Step=25000 Epoch=121.9] | Loss=0.01262 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.952 | 4844.3 samples/s | 75.7 steps/s
[Step=25050 Epoch=122.1] | Loss=0.01131 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.953 | 1636.3 samples/s | 25.6 steps/s
[Step=25100 Epoch=122.4] | Loss=0.00994 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.542 | FP-Norm(final)=2.954 | 3787.7 samples/s | 59.2 steps/s
[Step=25150 Epoch=122.6] | Loss=0.00908 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.956 | 3785.2 samples/s | 59.1 steps/s
[Step=25200 Epoch=122.9] | Loss=0.00850 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.957 | 4579.5 samples/s | 71.6 steps/s
[Step=25250 Epoch=123.1] | Loss=0.00782 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.537 | FP-Norm(final)=2.958 | 1682.4 samples/s | 26.3 steps/s
[Step=25300 Epoch=123.4] | Loss=0.00745 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.959 | 3779.7 samples/s | 59.1 steps/s
[Step=25350 Epoch=123.6] | Loss=0.00709 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.960 | 3742.2 samples/s | 58.5 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00680 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.532 | FP-Norm(final)=2.962 | 4322.6 samples/s | 67.5 steps/s
[Step=25450 Epoch=124.1] | Loss=0.00666 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.532 | FP-Norm(final)=2.963 | 1683.1 samples/s | 26.3 steps/s
[Step=25500 Epoch=124.3] | Loss=0.00633 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.964 | 3797.0 samples/s | 59.3 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00613 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.965 | 3782.9 samples/s | 59.1 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00590 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.966 | 4059.7 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step25600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=121.0] | Loss=0.18581 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.952 | 3594.9 samples/s | 56.2 steps/s
[Step=24850 Epoch=121.3] | Loss=0.01896 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=2.951 | 3629.0 samples/s | 56.7 steps/s
[Step=24900 Epoch=121.5] | Loss=0.01513 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.472 | FP-Norm(final)=2.951 | 3727.4 samples/s | 58.2 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01267 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=2.951 | 3805.6 samples/s | 59.5 steps/s
[Step=25000 Epoch=122.0] | Loss=0.01115 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.501 | FP-Norm(final)=2.952 | 4822.6 samples/s | 75.4 steps/s
[Step=25050 Epoch=122.2] | Loss=0.00943 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=2.954 | 1628.1 samples/s | 25.4 steps/s
[Step=25100 Epoch=122.5] | Loss=0.00862 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.509 | FP-Norm(final)=2.956 | 3766.8 samples/s | 58.9 steps/s
[Step=25150 Epoch=122.7] | Loss=0.00794 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.958 | 3794.3 samples/s | 59.3 steps/s
[Step=25200 Epoch=123.0] | Loss=0.00735 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.509 | FP-Norm(final)=2.959 | 4624.7 samples/s | 72.3 steps/s
[Step=25250 Epoch=123.2] | Loss=0.00682 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.961 | 1655.5 samples/s | 25.9 steps/s
[Step=25300 Epoch=123.5] | Loss=0.00633 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.963 | 3771.8 samples/s | 58.9 steps/s
[Step=25350 Epoch=123.7] | Loss=0.00606 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.964 | 3804.0 samples/s | 59.4 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00592 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.966 | 4407.5 samples/s | 68.9 steps/s
[Step=25450 Epoch=124.2] | Loss=0.00572 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.509 | FP-Norm(final)=2.967 | 1690.6 samples/s | 26.4 steps/s
[Step=25500 Epoch=124.4] | Loss=0.00559 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=2.968 | 3796.0 samples/s | 59.3 steps/s
[Step=25550 Epoch=124.7] | Loss=0.00542 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=2.969 | 3791.8 samples/s | 59.2 steps/s
[Step=25600 Epoch=124.9] | Loss=0.00529 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=2.970 | 4195.0 samples/s | 65.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step25600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=120.8] | Loss=0.04919 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.952 | 3762.7 samples/s | 58.8 steps/s
[Step=24850 Epoch=121.1] | Loss=0.02003 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.414 | FP-Norm(final)=2.951 | 3576.9 samples/s | 55.9 steps/s
[Step=24900 Epoch=121.3] | Loss=0.01518 | Reg=0.00023 | acc=0.9688 | FP-Norm=0.468 | FP-Norm(final)=2.952 | 3786.3 samples/s | 59.2 steps/s
[Step=24950 Epoch=121.6] | Loss=0.01252 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.483 | FP-Norm(final)=2.953 | 3778.3 samples/s | 59.0 steps/s
[Step=25000 Epoch=121.8] | Loss=0.01095 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.954 | 4848.2 samples/s | 75.8 steps/s
[Step=25050 Epoch=122.1] | Loss=0.00945 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=2.956 | 1618.0 samples/s | 25.3 steps/s
[Step=25100 Epoch=122.3] | Loss=0.00848 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.500 | FP-Norm(final)=2.958 | 3780.9 samples/s | 59.1 steps/s
[Step=25150 Epoch=122.5] | Loss=0.00774 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.959 | 3776.5 samples/s | 59.0 steps/s
[Step=25200 Epoch=122.8] | Loss=0.00731 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.961 | 4554.9 samples/s | 71.2 steps/s
[Step=25250 Epoch=123.0] | Loss=0.00675 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.963 | 1647.3 samples/s | 25.7 steps/s
[Step=25300 Epoch=123.3] | Loss=0.00634 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.500 | FP-Norm(final)=2.964 | 3794.2 samples/s | 59.3 steps/s
[Step=25350 Epoch=123.5] | Loss=0.00609 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.966 | 3777.6 samples/s | 59.0 steps/s
[Step=25400 Epoch=123.8] | Loss=0.00576 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.968 | 4293.1 samples/s | 67.1 steps/s
[Step=25450 Epoch=124.0] | Loss=0.00552 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.969 | 1688.1 samples/s | 26.4 steps/s
[Step=25500 Epoch=124.2] | Loss=0.00530 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.971 | 3780.3 samples/s | 59.1 steps/s
[Step=25550 Epoch=124.5] | Loss=0.00513 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=2.973 | 3799.6 samples/s | 59.4 steps/s
[Step=25600 Epoch=124.7] | Loss=0.00493 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=2.974 | 4033.1 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step25600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=120.9] | Loss=0.01413 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.952 | 3643.2 samples/s | 56.9 steps/s
[Step=24850 Epoch=121.2] | Loss=0.01412 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=2.955 | 3678.7 samples/s | 57.5 steps/s
[Step=24900 Epoch=121.4] | Loss=0.01252 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.443 | FP-Norm(final)=2.956 | 3777.3 samples/s | 59.0 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01051 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.469 | FP-Norm(final)=2.956 | 3780.3 samples/s | 59.1 steps/s
[Step=25000 Epoch=121.9] | Loss=0.00936 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.483 | FP-Norm(final)=2.957 | 4870.8 samples/s | 76.1 steps/s
[Step=25050 Epoch=122.2] | Loss=0.00815 | Reg=0.00025 | acc=0.9688 | FP-Norm=0.491 | FP-Norm(final)=2.959 | 1619.9 samples/s | 25.3 steps/s
[Step=25100 Epoch=122.4] | Loss=0.00734 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.494 | FP-Norm(final)=2.960 | 3767.7 samples/s | 58.9 steps/s
[Step=25150 Epoch=122.6] | Loss=0.00682 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=2.962 | 3800.6 samples/s | 59.4 steps/s
[Step=25200 Epoch=122.9] | Loss=0.00644 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=2.963 | 4555.5 samples/s | 71.2 steps/s
[Step=25250 Epoch=123.1] | Loss=0.00601 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=2.965 | 1186.9 samples/s | 18.5 steps/s
[Step=25300 Epoch=123.4] | Loss=0.00564 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=2.966 | 3797.3 samples/s | 59.3 steps/s
[Step=25350 Epoch=123.6] | Loss=0.00537 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=2.968 | 3776.9 samples/s | 59.0 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00514 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=2.969 | 4314.6 samples/s | 67.4 steps/s
[Step=25450 Epoch=124.1] | Loss=0.00499 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.494 | FP-Norm(final)=2.970 | 1676.5 samples/s | 26.2 steps/s
[Step=25500 Epoch=124.4] | Loss=0.00473 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.972 | 3764.3 samples/s | 58.8 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00454 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.973 | 3768.8 samples/s | 58.9 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00453 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.974 | 4055.3 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step25600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=121.6] | Loss=0.10937 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=2.952 | 3726.2 samples/s | 58.2 steps/s
[Step=24850 Epoch=121.9] | Loss=0.01741 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=2.952 | 3612.8 samples/s | 56.5 steps/s
[Step=24900 Epoch=122.1] | Loss=0.01383 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.436 | FP-Norm(final)=2.953 | 3787.9 samples/s | 59.2 steps/s
[Step=24950 Epoch=122.4] | Loss=0.01191 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.462 | FP-Norm(final)=2.954 | 3775.8 samples/s | 59.0 steps/s
[Step=25000 Epoch=122.6] | Loss=0.01043 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.473 | FP-Norm(final)=2.955 | 4947.2 samples/s | 77.3 steps/s
[Step=25050 Epoch=122.8] | Loss=0.00911 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=2.956 | 1603.6 samples/s | 25.1 steps/s
[Step=25100 Epoch=123.1] | Loss=0.00812 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=2.958 | 3814.5 samples/s | 59.6 steps/s
[Step=25150 Epoch=123.3] | Loss=0.00746 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.487 | FP-Norm(final)=2.960 | 3759.7 samples/s | 58.7 steps/s
[Step=25200 Epoch=123.6] | Loss=0.00696 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=2.961 | 4738.2 samples/s | 74.0 steps/s
[Step=25250 Epoch=123.8] | Loss=0.00649 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=2.963 | 1639.8 samples/s | 25.6 steps/s
[Step=25300 Epoch=124.1] | Loss=0.00604 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=2.964 | 3778.3 samples/s | 59.0 steps/s
[Step=25350 Epoch=124.3] | Loss=0.00572 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.966 | 3795.1 samples/s | 59.3 steps/s
[Step=25400 Epoch=124.6] | Loss=0.00549 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.492 | FP-Norm(final)=2.967 | 4511.3 samples/s | 70.5 steps/s
[Step=25450 Epoch=124.8] | Loss=0.00525 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.969 | 1655.8 samples/s | 25.9 steps/s
[Step=25500 Epoch=125.0] | Loss=0.00503 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.970 | 3784.8 samples/s | 59.1 steps/s
[Step=25550 Epoch=125.3] | Loss=0.00485 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=2.972 | 3845.8 samples/s | 60.1 steps/s
[Step=25600 Epoch=125.5] | Loss=0.00468 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=2.973 | 4352.8 samples/s | 68.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step25600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=235.0] | Loss=0.07578 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.952 | 3554.6 samples/s | 55.5 steps/s
[Step=24850 Epoch=235.5] | Loss=0.00417 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.482 | FP-Norm(final)=2.956 | 3290.0 samples/s | 51.4 steps/s
[Step=24900 Epoch=235.9] | Loss=0.00231 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=2.958 | 4634.7 samples/s | 72.4 steps/s
[Step=24950 Epoch=236.4] | Loss=0.00157 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.958 | 1544.8 samples/s | 24.1 steps/s
[Step=25000 Epoch=236.9] | Loss=0.00119 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.959 | 4326.1 samples/s | 67.6 steps/s
[Step=25050 Epoch=237.4] | Loss=0.00096 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.959 | 1587.2 samples/s | 24.8 steps/s
[Step=25100 Epoch=237.8] | Loss=0.00080 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=2.960 | 4085.8 samples/s | 63.8 steps/s
[Step=25150 Epoch=238.3] | Loss=0.00069 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=2.960 | 1613.3 samples/s | 25.2 steps/s
[Step=25200 Epoch=238.8] | Loss=0.00061 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=2.960 | 3851.0 samples/s | 60.2 steps/s
[Step=25250 Epoch=239.3] | Loss=0.00055 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=2.960 | 1661.7 samples/s | 26.0 steps/s
[Step=25300 Epoch=239.7] | Loss=0.00049 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=2.961 | 3642.1 samples/s | 56.9 steps/s
[Step=25350 Epoch=240.2] | Loss=0.00045 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.492 | FP-Norm(final)=2.961 | 1702.3 samples/s | 26.6 steps/s
[Step=25400 Epoch=240.7] | Loss=0.00042 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=2.961 | 3611.1 samples/s | 56.4 steps/s
[Step=25450 Epoch=241.2] | Loss=0.00039 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=2.961 | 1710.2 samples/s | 26.7 steps/s
[Step=25500 Epoch=241.6] | Loss=0.00036 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=2.961 | 3596.2 samples/s | 56.2 steps/s
[Step=25550 Epoch=242.1] | Loss=0.00034 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.472 | FP-Norm(final)=2.961 | 1730.2 samples/s | 27.0 steps/s
[Step=25600 Epoch=242.6] | Loss=0.00032 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.467 | FP-Norm(final)=2.961 | 3553.6 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step25600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=235.9] | Loss=0.00479 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=2.952 | 3616.9 samples/s | 56.5 steps/s
[Step=24850 Epoch=236.4] | Loss=0.00341 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.956 | 3389.5 samples/s | 53.0 steps/s
[Step=24900 Epoch=236.9] | Loss=0.00174 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.958 | 4691.3 samples/s | 73.3 steps/s
[Step=24950 Epoch=237.3] | Loss=0.00117 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=2.958 | 1541.8 samples/s | 24.1 steps/s
[Step=25000 Epoch=237.8] | Loss=0.00089 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.958 | 4386.5 samples/s | 68.5 steps/s
[Step=25050 Epoch=238.3] | Loss=0.00072 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.959 | 1583.6 samples/s | 24.7 steps/s
[Step=25100 Epoch=238.8] | Loss=0.00060 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.959 | 4093.2 samples/s | 64.0 steps/s
[Step=25150 Epoch=239.2] | Loss=0.00052 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=2.959 | 1624.3 samples/s | 25.4 steps/s
[Step=25200 Epoch=239.7] | Loss=0.00046 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=2.959 | 3845.9 samples/s | 60.1 steps/s
[Step=25250 Epoch=240.2] | Loss=0.00041 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=2.959 | 1662.1 samples/s | 26.0 steps/s
[Step=25300 Epoch=240.7] | Loss=0.00037 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=2.959 | 3604.1 samples/s | 56.3 steps/s
[Step=25350 Epoch=241.1] | Loss=0.00034 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.488 | FP-Norm(final)=2.959 | 1694.6 samples/s | 26.5 steps/s
[Step=25400 Epoch=241.6] | Loss=0.00031 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=2.960 | 3566.4 samples/s | 55.7 steps/s
[Step=25450 Epoch=242.1] | Loss=0.00029 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.474 | FP-Norm(final)=2.960 | 1722.3 samples/s | 26.9 steps/s
[Step=25500 Epoch=242.6] | Loss=0.00027 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.468 | FP-Norm(final)=2.960 | 3574.8 samples/s | 55.9 steps/s
[Step=25550 Epoch=243.0] | Loss=0.00025 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.462 | FP-Norm(final)=2.960 | 1736.1 samples/s | 27.1 steps/s
[Step=25600 Epoch=243.5] | Loss=0.00024 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=2.960 | 3518.8 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step25600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=236.8] | Loss=0.09243 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.952 | 3464.2 samples/s | 54.1 steps/s
[Step=24850 Epoch=237.3] | Loss=0.00736 | Reg=0.00047 | acc=1.0000 | FP-Norm=0.654 | FP-Norm(final)=2.952 | 3441.0 samples/s | 53.8 steps/s
[Step=24900 Epoch=237.8] | Loss=0.00374 | Reg=0.00049 | acc=1.0000 | FP-Norm=0.686 | FP-Norm(final)=2.952 | 4742.3 samples/s | 74.1 steps/s
[Step=24950 Epoch=238.3] | Loss=0.00250 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.679 | FP-Norm(final)=2.952 | 1526.7 samples/s | 23.9 steps/s
[Step=25000 Epoch=238.7] | Loss=0.00189 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.666 | FP-Norm(final)=2.952 | 4459.7 samples/s | 69.7 steps/s
[Step=25050 Epoch=239.2] | Loss=0.00152 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.654 | FP-Norm(final)=2.952 | 1578.5 samples/s | 24.7 steps/s
[Step=25100 Epoch=239.7] | Loss=0.00127 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.642 | FP-Norm(final)=2.952 | 4227.5 samples/s | 66.1 steps/s
[Step=25150 Epoch=240.2] | Loss=0.00109 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.631 | FP-Norm(final)=2.952 | 1621.2 samples/s | 25.3 steps/s
[Step=25200 Epoch=240.6] | Loss=0.00096 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=2.952 | 3941.5 samples/s | 61.6 steps/s
[Step=25250 Epoch=241.1] | Loss=0.00086 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.611 | FP-Norm(final)=2.953 | 1630.6 samples/s | 25.5 steps/s
[Step=25300 Epoch=241.6] | Loss=0.00077 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.602 | FP-Norm(final)=2.953 | 3787.0 samples/s | 59.2 steps/s
[Step=25350 Epoch=242.1] | Loss=0.00070 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=2.953 | 1662.7 samples/s | 26.0 steps/s
[Step=25400 Epoch=242.6] | Loss=0.00065 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.586 | FP-Norm(final)=2.953 | 3636.6 samples/s | 56.8 steps/s
[Step=25450 Epoch=243.0] | Loss=0.00060 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.953 | 1708.6 samples/s | 26.7 steps/s
[Step=25500 Epoch=243.5] | Loss=0.00056 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.953 | 3575.8 samples/s | 55.9 steps/s
[Step=25550 Epoch=244.0] | Loss=0.00052 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.953 | 1716.2 samples/s | 26.8 steps/s
[Step=25600 Epoch=244.5] | Loss=0.00049 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=2.953 | 3608.1 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step25600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=233.7] | Loss=0.02762 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.952 | 3558.8 samples/s | 55.6 steps/s
[Step=24850 Epoch=234.2] | Loss=0.00535 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=2.952 | 3389.0 samples/s | 53.0 steps/s
[Step=24900 Epoch=234.6] | Loss=0.00277 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.608 | FP-Norm(final)=2.952 | 4624.3 samples/s | 72.3 steps/s
[Step=24950 Epoch=235.1] | Loss=0.00186 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.610 | FP-Norm(final)=2.953 | 1561.5 samples/s | 24.4 steps/s
[Step=25000 Epoch=235.6] | Loss=0.00141 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.601 | FP-Norm(final)=2.953 | 4278.2 samples/s | 66.8 steps/s
[Step=25050 Epoch=236.0] | Loss=0.00113 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.590 | FP-Norm(final)=2.953 | 1612.8 samples/s | 25.2 steps/s
[Step=25100 Epoch=236.5] | Loss=0.00095 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=2.953 | 3943.7 samples/s | 61.6 steps/s
[Step=25150 Epoch=237.0] | Loss=0.00081 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.568 | FP-Norm(final)=2.953 | 1645.0 samples/s | 25.7 steps/s
[Step=25200 Epoch=237.5] | Loss=0.00071 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=2.953 | 3717.0 samples/s | 58.1 steps/s
[Step=25250 Epoch=237.9] | Loss=0.00064 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.549 | FP-Norm(final)=2.954 | 1680.9 samples/s | 26.3 steps/s
[Step=25300 Epoch=238.4] | Loss=0.00058 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.954 | 3597.7 samples/s | 56.2 steps/s
[Step=25350 Epoch=238.9] | Loss=0.00053 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=2.954 | 1703.7 samples/s | 26.6 steps/s
[Step=25400 Epoch=239.3] | Loss=0.00048 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=2.954 | 3627.2 samples/s | 56.7 steps/s
[Step=25450 Epoch=239.8] | Loss=0.00045 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.954 | 1733.4 samples/s | 27.1 steps/s
[Step=25500 Epoch=240.3] | Loss=0.00042 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.954 | 3503.1 samples/s | 54.7 steps/s
[Step=25550 Epoch=240.8] | Loss=0.00039 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=2.954 | 1794.2 samples/s | 28.0 steps/s
[Step=25600 Epoch=241.2] | Loss=0.00037 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.954 | 3252.8 samples/s | 50.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step25600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=236.4] | Loss=0.11171 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.952 | 3498.8 samples/s | 54.7 steps/s
[Step=24850 Epoch=236.8] | Loss=0.00619 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.951 | 3362.1 samples/s | 52.5 steps/s
[Step=24900 Epoch=237.3] | Loss=0.00317 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.607 | FP-Norm(final)=2.952 | 4662.7 samples/s | 72.9 steps/s
[Step=24950 Epoch=237.8] | Loss=0.00213 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.602 | FP-Norm(final)=2.952 | 1541.0 samples/s | 24.1 steps/s
[Step=25000 Epoch=238.3] | Loss=0.00161 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=2.953 | 4436.6 samples/s | 69.3 steps/s
[Step=25050 Epoch=238.7] | Loss=0.00130 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=2.953 | 1573.3 samples/s | 24.6 steps/s
[Step=25100 Epoch=239.2] | Loss=0.00109 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=2.953 | 4189.9 samples/s | 65.5 steps/s
[Step=25150 Epoch=239.7] | Loss=0.00094 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.954 | 1611.7 samples/s | 25.2 steps/s
[Step=25200 Epoch=240.2] | Loss=0.00082 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=2.954 | 3931.3 samples/s | 61.4 steps/s
[Step=25250 Epoch=240.7] | Loss=0.00073 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.954 | 1632.6 samples/s | 25.5 steps/s
[Step=25300 Epoch=241.1] | Loss=0.00066 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.954 | 3788.2 samples/s | 59.2 steps/s
[Step=25350 Epoch=241.6] | Loss=0.00061 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.954 | 1661.5 samples/s | 26.0 steps/s
[Step=25400 Epoch=242.1] | Loss=0.00056 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=2.955 | 3615.5 samples/s | 56.5 steps/s
[Step=25450 Epoch=242.6] | Loss=0.00052 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=2.955 | 1699.1 samples/s | 26.5 steps/s
[Step=25500 Epoch=243.0] | Loss=0.00048 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.955 | 3598.0 samples/s | 56.2 steps/s
[Step=25550 Epoch=243.5] | Loss=0.00045 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=2.955 | 1708.7 samples/s | 26.7 steps/s
[Step=25600 Epoch=244.0] | Loss=0.00042 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.955 | 3584.7 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19928 | acc=0.8893 | tpr=0.8471 | fpr=0.0191 | 3641.5 samples/s | 14.2 steps/s
Avg test loss: 0.20122, Avg test acc: 0.88941, Avg tpr: 0.84840, Avg fpr: 0.02038, total FA: 159

Testing server on iccad2012
[Step=  50] | Loss=0.52859 | acc=0.8488 | tpr=0.9779 | fpr=0.1536 | 3653.7 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.55070 | acc=0.8452 | tpr=0.9787 | fpr=0.1573 | 6706.0 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.56242 | acc=0.8426 | tpr=0.9726 | fpr=0.1598 | 6982.8 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.56228 | acc=0.8435 | tpr=0.9760 | fpr=0.1589 | 6936.4 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.55981 | acc=0.8431 | tpr=0.9703 | fpr=0.1592 | 6725.3 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.56429 | acc=0.8427 | tpr=0.9695 | fpr=0.1596 | 6963.3 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.56477 | acc=0.8428 | tpr=0.9699 | fpr=0.1595 | 6822.7 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.56549 | acc=0.8426 | tpr=0.9705 | fpr=0.1597 | 6709.6 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.56962 | acc=0.8425 | tpr=0.9703 | fpr=0.1598 | 6757.5 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.57006 | acc=0.8423 | tpr=0.9709 | fpr=0.1600 | 6846.8 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.56948 | acc=0.8425 | tpr=0.9710 | fpr=0.1599 | 12396.2 samples/s | 48.4 steps/s
Avg test loss: 0.56944, Avg test acc: 0.84247, Avg tpr: 0.97108, Avg fpr: 0.15987, total FA: 22197

server round 32/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.8] | Loss=0.04137 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.974 | 3620.7 samples/s | 56.6 steps/s
[Step=25650 Epoch=125.1] | Loss=0.02263 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.449 | FP-Norm(final)=2.974 | 3689.4 samples/s | 57.6 steps/s
[Step=25700 Epoch=125.3] | Loss=0.01605 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=2.974 | 3797.2 samples/s | 59.3 steps/s
[Step=25750 Epoch=125.6] | Loss=0.01370 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=2.974 | 3756.2 samples/s | 58.7 steps/s
[Step=25800 Epoch=125.8] | Loss=0.01146 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=2.975 | 4852.0 samples/s | 75.8 steps/s
[Step=25850 Epoch=126.0] | Loss=0.01007 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=2.976 | 1638.7 samples/s | 25.6 steps/s
[Step=25900 Epoch=126.3] | Loss=0.00899 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.518 | FP-Norm(final)=2.977 | 3767.4 samples/s | 58.9 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00823 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=2.978 | 3765.3 samples/s | 58.8 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00768 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.516 | FP-Norm(final)=2.979 | 4575.3 samples/s | 71.5 steps/s
[Step=26050 Epoch=127.0] | Loss=0.00716 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=2.981 | 1675.3 samples/s | 26.2 steps/s
[Step=26100 Epoch=127.3] | Loss=0.00665 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=2.982 | 3778.2 samples/s | 59.0 steps/s
[Step=26150 Epoch=127.5] | Loss=0.00639 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=2.983 | 3791.1 samples/s | 59.2 steps/s
[Step=26200 Epoch=127.8] | Loss=0.00615 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.984 | 4318.8 samples/s | 67.5 steps/s
[Step=26250 Epoch=128.0] | Loss=0.00598 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.985 | 1688.0 samples/s | 26.4 steps/s
[Step=26300 Epoch=128.2] | Loss=0.00578 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.986 | 3791.4 samples/s | 59.2 steps/s
[Step=26350 Epoch=128.5] | Loss=0.00558 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.987 | 3754.4 samples/s | 58.7 steps/s
[Step=26400 Epoch=128.7] | Loss=0.00548 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.511 | FP-Norm(final)=2.988 | 4098.0 samples/s | 64.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step26400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.9] | Loss=0.04261 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.974 | 4169.8 samples/s | 65.2 steps/s
[Step=25650 Epoch=125.2] | Loss=0.02160 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=2.973 | 3254.9 samples/s | 50.9 steps/s
[Step=25700 Epoch=125.4] | Loss=0.01467 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.972 | 3797.9 samples/s | 59.3 steps/s
[Step=25750 Epoch=125.6] | Loss=0.01188 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.974 | 3773.6 samples/s | 59.0 steps/s
[Step=25800 Epoch=125.9] | Loss=0.01033 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.975 | 4840.9 samples/s | 75.6 steps/s
[Step=25850 Epoch=126.1] | Loss=0.00907 | Reg=0.00033 | acc=0.9688 | FP-Norm=0.564 | FP-Norm(final)=2.977 | 1619.4 samples/s | 25.3 steps/s
[Step=25900 Epoch=126.4] | Loss=0.00838 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.978 | 3792.6 samples/s | 59.3 steps/s
[Step=25950 Epoch=126.6] | Loss=0.00769 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=2.979 | 3786.5 samples/s | 59.2 steps/s
[Step=26000 Epoch=126.9] | Loss=0.00708 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=2.981 | 4640.1 samples/s | 72.5 steps/s
[Step=26050 Epoch=127.1] | Loss=0.00661 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.982 | 1655.0 samples/s | 25.9 steps/s
[Step=26100 Epoch=127.4] | Loss=0.00640 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.553 | FP-Norm(final)=2.983 | 3762.2 samples/s | 58.8 steps/s
[Step=26150 Epoch=127.6] | Loss=0.00606 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.984 | 3797.9 samples/s | 59.3 steps/s
[Step=26200 Epoch=127.8] | Loss=0.00581 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.985 | 4371.1 samples/s | 68.3 steps/s
[Step=26250 Epoch=128.1] | Loss=0.00554 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.545 | FP-Norm(final)=2.986 | 1684.4 samples/s | 26.3 steps/s
[Step=26300 Epoch=128.3] | Loss=0.00531 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=2.988 | 3777.9 samples/s | 59.0 steps/s
[Step=26350 Epoch=128.6] | Loss=0.00514 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.989 | 3755.1 samples/s | 58.7 steps/s
[Step=26400 Epoch=128.8] | Loss=0.00507 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=2.990 | 4174.6 samples/s | 65.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step26400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.7] | Loss=0.06779 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.974 | 3624.5 samples/s | 56.6 steps/s
[Step=25650 Epoch=125.0] | Loss=0.01970 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=2.975 | 3731.7 samples/s | 58.3 steps/s
[Step=25700 Epoch=125.2] | Loss=0.01437 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.462 | FP-Norm(final)=2.975 | 3779.8 samples/s | 59.1 steps/s
[Step=25750 Epoch=125.5] | Loss=0.01229 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=2.975 | 3785.3 samples/s | 59.1 steps/s
[Step=25800 Epoch=125.7] | Loss=0.01059 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=2.977 | 4851.5 samples/s | 75.8 steps/s
[Step=25850 Epoch=126.0] | Loss=0.00923 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=2.979 | 1638.3 samples/s | 25.6 steps/s
[Step=25900 Epoch=126.2] | Loss=0.00813 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.980 | 3764.1 samples/s | 58.8 steps/s
[Step=25950 Epoch=126.4] | Loss=0.00748 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=2.982 | 3768.0 samples/s | 58.9 steps/s
[Step=26000 Epoch=126.7] | Loss=0.00711 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.514 | FP-Norm(final)=2.984 | 4575.1 samples/s | 71.5 steps/s
[Step=26050 Epoch=126.9] | Loss=0.00667 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=2.986 | 1653.1 samples/s | 25.8 steps/s
[Step=26100 Epoch=127.2] | Loss=0.00631 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.513 | FP-Norm(final)=2.987 | 3792.6 samples/s | 59.3 steps/s
[Step=26150 Epoch=127.4] | Loss=0.00596 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=2.989 | 3792.6 samples/s | 59.3 steps/s
[Step=26200 Epoch=127.7] | Loss=0.00569 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=2.990 | 4311.9 samples/s | 67.4 steps/s
[Step=26250 Epoch=127.9] | Loss=0.00554 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=2.992 | 1705.4 samples/s | 26.6 steps/s
[Step=26300 Epoch=128.1] | Loss=0.00537 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=2.993 | 3793.1 samples/s | 59.3 steps/s
[Step=26350 Epoch=128.4] | Loss=0.00519 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=2.994 | 3751.6 samples/s | 58.6 steps/s
[Step=26400 Epoch=128.6] | Loss=0.00500 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=2.996 | 4064.0 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step26400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.8] | Loss=0.02981 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.974 | 3697.0 samples/s | 57.8 steps/s
[Step=25650 Epoch=125.1] | Loss=0.01756 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.975 | 3598.2 samples/s | 56.2 steps/s
[Step=25700 Epoch=125.3] | Loss=0.01286 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.975 | 3811.1 samples/s | 59.5 steps/s
[Step=25750 Epoch=125.6] | Loss=0.01152 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.528 | FP-Norm(final)=2.976 | 3763.9 samples/s | 58.8 steps/s
[Step=25800 Epoch=125.8] | Loss=0.01002 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=2.977 | 4885.4 samples/s | 76.3 steps/s
[Step=25850 Epoch=126.1] | Loss=0.00865 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.978 | 1628.4 samples/s | 25.4 steps/s
[Step=25900 Epoch=126.3] | Loss=0.00759 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=2.980 | 3785.8 samples/s | 59.2 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00717 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.542 | FP-Norm(final)=2.981 | 3793.4 samples/s | 59.3 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00676 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.983 | 4545.8 samples/s | 71.0 steps/s
[Step=26050 Epoch=127.0] | Loss=0.00625 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.984 | 1669.8 samples/s | 26.1 steps/s
[Step=26100 Epoch=127.3] | Loss=0.00576 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.985 | 3769.5 samples/s | 58.9 steps/s
[Step=26150 Epoch=127.5] | Loss=0.00548 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.987 | 3810.8 samples/s | 59.5 steps/s
[Step=26200 Epoch=127.8] | Loss=0.00527 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=2.988 | 4315.3 samples/s | 67.4 steps/s
[Step=26250 Epoch=128.0] | Loss=0.00506 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=2.990 | 1710.9 samples/s | 26.7 steps/s
[Step=26300 Epoch=128.3] | Loss=0.00485 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.531 | FP-Norm(final)=2.991 | 3799.0 samples/s | 59.4 steps/s
[Step=26350 Epoch=128.5] | Loss=0.00462 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.992 | 3775.3 samples/s | 59.0 steps/s
[Step=26400 Epoch=128.7] | Loss=0.00455 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.993 | 4087.6 samples/s | 63.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step26400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=125.5] | Loss=0.18559 | Reg=0.00000 | acc=0.8594 | FP-Norm=0.000 | FP-Norm(final)=2.974 | 3721.4 samples/s | 58.1 steps/s
[Step=25650 Epoch=125.8] | Loss=0.02082 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=2.974 | 3590.9 samples/s | 56.1 steps/s
[Step=25700 Epoch=126.0] | Loss=0.01529 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=2.973 | 3779.1 samples/s | 59.0 steps/s
[Step=25750 Epoch=126.3] | Loss=0.01310 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=2.973 | 3802.0 samples/s | 59.4 steps/s
[Step=25800 Epoch=126.5] | Loss=0.01116 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=2.973 | 4921.6 samples/s | 76.9 steps/s
[Step=25850 Epoch=126.8] | Loss=0.00951 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=2.974 | 1621.6 samples/s | 25.3 steps/s
[Step=25900 Epoch=127.0] | Loss=0.00841 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.534 | FP-Norm(final)=2.976 | 3791.6 samples/s | 59.2 steps/s
[Step=25950 Epoch=127.3] | Loss=0.00777 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=2.977 | 3791.9 samples/s | 59.2 steps/s
[Step=26000 Epoch=127.5] | Loss=0.00729 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=2.978 | 4660.3 samples/s | 72.8 steps/s
[Step=26050 Epoch=127.7] | Loss=0.00676 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.532 | FP-Norm(final)=2.979 | 1648.6 samples/s | 25.8 steps/s
[Step=26100 Epoch=128.0] | Loss=0.00639 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.980 | 3754.0 samples/s | 58.7 steps/s
[Step=26150 Epoch=128.2] | Loss=0.00604 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.982 | 3771.8 samples/s | 58.9 steps/s
[Step=26200 Epoch=128.5] | Loss=0.00575 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.983 | 4535.6 samples/s | 70.9 steps/s
[Step=26250 Epoch=128.7] | Loss=0.00546 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.984 | 1651.1 samples/s | 25.8 steps/s
[Step=26300 Epoch=129.0] | Loss=0.00521 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.985 | 3771.3 samples/s | 58.9 steps/s
[Step=26350 Epoch=129.2] | Loss=0.00503 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.986 | 3780.3 samples/s | 59.1 steps/s
[Step=26400 Epoch=129.5] | Loss=0.00496 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=2.987 | 4378.9 samples/s | 68.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step26400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=242.6] | Loss=0.07749 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.974 | 3650.8 samples/s | 57.0 steps/s
[Step=25650 Epoch=243.1] | Loss=0.00867 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.636 | FP-Norm(final)=2.972 | 3241.1 samples/s | 50.6 steps/s
[Step=25700 Epoch=243.5] | Loss=0.00464 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.663 | FP-Norm(final)=2.972 | 4636.5 samples/s | 72.4 steps/s
[Step=25750 Epoch=244.0] | Loss=0.00311 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.656 | FP-Norm(final)=2.972 | 1546.6 samples/s | 24.2 steps/s
[Step=25800 Epoch=244.5] | Loss=0.00234 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.643 | FP-Norm(final)=2.972 | 4337.3 samples/s | 67.8 steps/s
[Step=25850 Epoch=245.0] | Loss=0.00188 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.630 | FP-Norm(final)=2.972 | 1586.2 samples/s | 24.8 steps/s
[Step=25900 Epoch=245.4] | Loss=0.00157 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.618 | FP-Norm(final)=2.973 | 4049.9 samples/s | 63.3 steps/s
[Step=25950 Epoch=245.9] | Loss=0.00135 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.606 | FP-Norm(final)=2.973 | 1629.2 samples/s | 25.5 steps/s
[Step=26000 Epoch=246.4] | Loss=0.00118 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.973 | 3860.3 samples/s | 60.3 steps/s
[Step=26050 Epoch=246.8] | Loss=0.00105 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.586 | FP-Norm(final)=2.973 | 1670.4 samples/s | 26.1 steps/s
[Step=26100 Epoch=247.3] | Loss=0.00095 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.973 | 3594.7 samples/s | 56.2 steps/s
[Step=26150 Epoch=247.8] | Loss=0.00087 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=2.973 | 1710.5 samples/s | 26.7 steps/s
[Step=26200 Epoch=248.3] | Loss=0.00080 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.973 | 3558.4 samples/s | 55.6 steps/s
[Step=26250 Epoch=248.7] | Loss=0.00074 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.973 | 1710.4 samples/s | 26.7 steps/s
[Step=26300 Epoch=249.2] | Loss=0.00068 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.974 | 3582.3 samples/s | 56.0 steps/s
[Step=26350 Epoch=249.7] | Loss=0.00064 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.974 | 1725.1 samples/s | 27.0 steps/s
[Step=26400 Epoch=250.2] | Loss=0.00060 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.974 | 3470.7 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step26400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=243.5] | Loss=0.09860 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.974 | 3581.2 samples/s | 56.0 steps/s
[Step=25650 Epoch=244.0] | Loss=0.00398 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=2.977 | 3306.7 samples/s | 51.7 steps/s
[Step=25700 Epoch=244.5] | Loss=0.00203 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.593 | FP-Norm(final)=2.978 | 4668.3 samples/s | 72.9 steps/s
[Step=25750 Epoch=244.9] | Loss=0.00136 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.588 | FP-Norm(final)=2.979 | 1545.7 samples/s | 24.2 steps/s
[Step=25800 Epoch=245.4] | Loss=0.00102 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=2.979 | 4368.7 samples/s | 68.3 steps/s
[Step=25850 Epoch=245.9] | Loss=0.00082 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.979 | 1600.2 samples/s | 25.0 steps/s
[Step=25900 Epoch=246.4] | Loss=0.00069 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=2.979 | 4031.7 samples/s | 63.0 steps/s
[Step=25950 Epoch=246.8] | Loss=0.00059 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=2.979 | 1632.9 samples/s | 25.5 steps/s
[Step=26000 Epoch=247.3] | Loss=0.00052 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.979 | 3858.7 samples/s | 60.3 steps/s
[Step=26050 Epoch=247.8] | Loss=0.00046 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=2.979 | 1672.7 samples/s | 26.1 steps/s
[Step=26100 Epoch=248.3] | Loss=0.00042 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=2.979 | 3651.7 samples/s | 57.1 steps/s
[Step=26150 Epoch=248.8] | Loss=0.00038 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.979 | 1706.4 samples/s | 26.7 steps/s
[Step=26200 Epoch=249.2] | Loss=0.00035 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=2.979 | 3566.0 samples/s | 55.7 steps/s
[Step=26250 Epoch=249.7] | Loss=0.00033 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=2.979 | 1708.6 samples/s | 26.7 steps/s
[Step=26300 Epoch=250.2] | Loss=0.00030 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.979 | 3590.4 samples/s | 56.1 steps/s
[Step=26350 Epoch=250.7] | Loss=0.00028 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.488 | FP-Norm(final)=2.980 | 1722.7 samples/s | 26.9 steps/s
[Step=26400 Epoch=251.1] | Loss=0.00027 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.482 | FP-Norm(final)=2.980 | 3550.2 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step26400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=244.5] | Loss=0.09524 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.974 | 3399.1 samples/s | 53.1 steps/s
[Step=25650 Epoch=244.9] | Loss=0.00479 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.974 | 3652.5 samples/s | 57.1 steps/s
[Step=25700 Epoch=245.4] | Loss=0.00247 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.590 | FP-Norm(final)=2.975 | 4735.4 samples/s | 74.0 steps/s
[Step=25750 Epoch=245.9] | Loss=0.00166 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=2.975 | 1545.5 samples/s | 24.1 steps/s
[Step=25800 Epoch=246.4] | Loss=0.00125 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=2.975 | 4355.6 samples/s | 68.1 steps/s
[Step=25850 Epoch=246.9] | Loss=0.00100 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.567 | FP-Norm(final)=2.976 | 1567.0 samples/s | 24.5 steps/s
[Step=25900 Epoch=247.3] | Loss=0.00084 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.976 | 4198.3 samples/s | 65.6 steps/s
[Step=25950 Epoch=247.8] | Loss=0.00072 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=2.976 | 1599.6 samples/s | 25.0 steps/s
[Step=26000 Epoch=248.3] | Loss=0.00064 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=2.976 | 3963.6 samples/s | 61.9 steps/s
[Step=26050 Epoch=248.8] | Loss=0.00057 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.976 | 1632.2 samples/s | 25.5 steps/s
[Step=26100 Epoch=249.2] | Loss=0.00051 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=2.977 | 3805.0 samples/s | 59.5 steps/s
[Step=26150 Epoch=249.7] | Loss=0.00047 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=2.977 | 1657.9 samples/s | 25.9 steps/s
[Step=26200 Epoch=250.2] | Loss=0.00043 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=2.977 | 3640.9 samples/s | 56.9 steps/s
[Step=26250 Epoch=250.7] | Loss=0.00040 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=2.977 | 1689.9 samples/s | 26.4 steps/s
[Step=26300 Epoch=251.1] | Loss=0.00037 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=2.977 | 3584.6 samples/s | 56.0 steps/s
[Step=26350 Epoch=251.6] | Loss=0.00035 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.977 | 1710.7 samples/s | 26.7 steps/s
[Step=26400 Epoch=252.1] | Loss=0.00033 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.488 | FP-Norm(final)=2.977 | 3606.8 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step26400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=241.2] | Loss=0.02684 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.974 | 3608.7 samples/s | 56.4 steps/s
[Step=25650 Epoch=241.7] | Loss=0.00644 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.612 | FP-Norm(final)=2.974 | 3244.7 samples/s | 50.7 steps/s
[Step=25700 Epoch=242.2] | Loss=0.00353 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.646 | FP-Norm(final)=2.974 | 4634.3 samples/s | 72.4 steps/s
[Step=25750 Epoch=242.6] | Loss=0.00237 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.637 | FP-Norm(final)=2.974 | 1552.9 samples/s | 24.3 steps/s
[Step=25800 Epoch=243.1] | Loss=0.00178 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.623 | FP-Norm(final)=2.974 | 4275.1 samples/s | 66.8 steps/s
[Step=25850 Epoch=243.6] | Loss=0.00143 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=2.974 | 1590.1 samples/s | 24.8 steps/s
[Step=25900 Epoch=244.1] | Loss=0.00119 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=2.975 | 3993.3 samples/s | 62.4 steps/s
[Step=25950 Epoch=244.5] | Loss=0.00102 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=2.975 | 1643.7 samples/s | 25.7 steps/s
[Step=26000 Epoch=245.0] | Loss=0.00090 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=2.975 | 3701.5 samples/s | 57.8 steps/s
[Step=26050 Epoch=245.5] | Loss=0.00080 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=2.975 | 1698.5 samples/s | 26.5 steps/s
[Step=26100 Epoch=245.9] | Loss=0.00072 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.553 | FP-Norm(final)=2.975 | 3531.4 samples/s | 55.2 steps/s
[Step=26150 Epoch=246.4] | Loss=0.00066 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=2.975 | 1723.1 samples/s | 26.9 steps/s
[Step=26200 Epoch=246.9] | Loss=0.00060 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.975 | 3581.4 samples/s | 56.0 steps/s
[Step=26250 Epoch=247.3] | Loss=0.00056 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=2.975 | 1737.5 samples/s | 27.1 steps/s
[Step=26300 Epoch=247.8] | Loss=0.00052 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.522 | FP-Norm(final)=2.975 | 3558.4 samples/s | 55.6 steps/s
[Step=26350 Epoch=248.3] | Loss=0.00049 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=2.975 | 1845.3 samples/s | 28.8 steps/s
[Step=26400 Epoch=248.8] | Loss=0.00046 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.975 | 3204.4 samples/s | 50.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step26400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=244.0] | Loss=0.05383 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=2.974 | 3555.2 samples/s | 55.6 steps/s
[Step=25650 Epoch=244.5] | Loss=0.00558 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.618 | FP-Norm(final)=2.975 | 3370.3 samples/s | 52.7 steps/s
[Step=25700 Epoch=244.9] | Loss=0.00293 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.642 | FP-Norm(final)=2.975 | 4619.8 samples/s | 72.2 steps/s
[Step=25750 Epoch=245.4] | Loss=0.00197 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.637 | FP-Norm(final)=2.976 | 1551.8 samples/s | 24.2 steps/s
[Step=25800 Epoch=245.9] | Loss=0.00149 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.623 | FP-Norm(final)=2.976 | 4430.2 samples/s | 69.2 steps/s
[Step=25850 Epoch=246.4] | Loss=0.00119 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=2.976 | 1576.0 samples/s | 24.6 steps/s
[Step=25900 Epoch=246.9] | Loss=0.00100 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.596 | FP-Norm(final)=2.977 | 4166.1 samples/s | 65.1 steps/s
[Step=25950 Epoch=247.3] | Loss=0.00086 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.584 | FP-Norm(final)=2.977 | 1601.1 samples/s | 25.0 steps/s
[Step=26000 Epoch=247.8] | Loss=0.00075 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=2.977 | 3993.7 samples/s | 62.4 steps/s
[Step=26050 Epoch=248.3] | Loss=0.00067 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=2.977 | 1649.4 samples/s | 25.8 steps/s
[Step=26100 Epoch=248.8] | Loss=0.00061 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=2.977 | 3760.1 samples/s | 58.8 steps/s
[Step=26150 Epoch=249.2] | Loss=0.00055 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.977 | 1675.6 samples/s | 26.2 steps/s
[Step=26200 Epoch=249.7] | Loss=0.00051 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=2.977 | 3627.4 samples/s | 56.7 steps/s
[Step=26250 Epoch=250.2] | Loss=0.00047 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=2.977 | 1685.7 samples/s | 26.3 steps/s
[Step=26300 Epoch=250.7] | Loss=0.00044 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=2.978 | 3564.2 samples/s | 55.7 steps/s
[Step=26350 Epoch=251.1] | Loss=0.00041 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=2.978 | 1708.2 samples/s | 26.7 steps/s
[Step=26400 Epoch=251.6] | Loss=0.00039 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=2.978 | 3609.6 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19933 | acc=0.8905 | tpr=0.8494 | fpr=0.0201 | 3634.9 samples/s | 14.2 steps/s
Avg test loss: 0.20173, Avg test acc: 0.89074, Avg tpr: 0.85079, Avg fpr: 0.02141, total FA: 167

Testing server on iccad2012
[Step=  50] | Loss=0.52677 | acc=0.8511 | tpr=0.9735 | fpr=0.1511 | 3619.7 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.54761 | acc=0.8478 | tpr=0.9765 | fpr=0.1546 | 6997.1 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.55924 | acc=0.8447 | tpr=0.9726 | fpr=0.1576 | 6819.6 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.55924 | acc=0.8456 | tpr=0.9760 | fpr=0.1568 | 6683.2 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.55666 | acc=0.8453 | tpr=0.9703 | fpr=0.1570 | 7019.2 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.56105 | acc=0.8450 | tpr=0.9695 | fpr=0.1573 | 6784.6 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.56145 | acc=0.8453 | tpr=0.9699 | fpr=0.1570 | 6861.0 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.56210 | acc=0.8451 | tpr=0.9699 | fpr=0.1572 | 6859.2 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.56621 | acc=0.8449 | tpr=0.9698 | fpr=0.1574 | 6555.9 samples/s | 25.6 steps/s
[Step= 500] | Loss=0.56670 | acc=0.8446 | tpr=0.9705 | fpr=0.1576 | 6955.0 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.56607 | acc=0.8448 | tpr=0.9706 | fpr=0.1575 | 12236.1 samples/s | 47.8 steps/s
Avg test loss: 0.56599, Avg test acc: 0.84479, Avg tpr: 0.97068, Avg fpr: 0.15750, total FA: 21869

server round 33/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.7] | Loss=0.04152 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.993 | 3555.7 samples/s | 55.6 steps/s
[Step=26450 Epoch=129.0] | Loss=0.01715 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=2.994 | 3738.8 samples/s | 58.4 steps/s
[Step=26500 Epoch=129.2] | Loss=0.01415 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=2.994 | 3774.0 samples/s | 59.0 steps/s
[Step=26550 Epoch=129.5] | Loss=0.01214 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.484 | FP-Norm(final)=2.994 | 3718.4 samples/s | 58.1 steps/s
[Step=26600 Epoch=129.7] | Loss=0.01077 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.497 | FP-Norm(final)=2.995 | 4850.3 samples/s | 75.8 steps/s
[Step=26650 Epoch=130.0] | Loss=0.00917 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=2.996 | 1631.6 samples/s | 25.5 steps/s
[Step=26700 Epoch=130.2] | Loss=0.00844 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=2.997 | 3779.2 samples/s | 59.0 steps/s
[Step=26750 Epoch=130.4] | Loss=0.00772 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.998 | 3740.6 samples/s | 58.4 steps/s
[Step=26800 Epoch=130.7] | Loss=0.00740 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=2.999 | 4565.1 samples/s | 71.3 steps/s
[Step=26850 Epoch=130.9] | Loss=0.00694 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.509 | FP-Norm(final)=3.000 | 1665.4 samples/s | 26.0 steps/s
[Step=26900 Epoch=131.2] | Loss=0.00656 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.002 | 3748.1 samples/s | 58.6 steps/s
[Step=26950 Epoch=131.4] | Loss=0.00632 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.003 | 3771.2 samples/s | 58.9 steps/s
[Step=27000 Epoch=131.7] | Loss=0.00605 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=3.004 | 4298.2 samples/s | 67.2 steps/s
[Step=27050 Epoch=131.9] | Loss=0.00592 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=3.005 | 1704.0 samples/s | 26.6 steps/s
[Step=27100 Epoch=132.1] | Loss=0.00569 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.006 | 3787.5 samples/s | 59.2 steps/s
[Step=27150 Epoch=132.4] | Loss=0.00551 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.006 | 3777.0 samples/s | 59.0 steps/s
[Step=27200 Epoch=132.6] | Loss=0.00535 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.007 | 4075.5 samples/s | 63.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step27200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.8] | Loss=0.10399 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.992 | 3582.8 samples/s | 56.0 steps/s
[Step=26450 Epoch=129.1] | Loss=0.02155 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.991 | 3693.4 samples/s | 57.7 steps/s
[Step=26500 Epoch=129.3] | Loss=0.01426 | Reg=0.00031 | acc=0.9844 | FP-Norm=0.539 | FP-Norm(final)=2.991 | 3761.4 samples/s | 58.8 steps/s
[Step=26550 Epoch=129.6] | Loss=0.01209 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=2.992 | 3773.5 samples/s | 59.0 steps/s
[Step=26600 Epoch=129.8] | Loss=0.01045 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.993 | 4876.7 samples/s | 76.2 steps/s
[Step=26650 Epoch=130.0] | Loss=0.00944 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.994 | 1623.0 samples/s | 25.4 steps/s
[Step=26700 Epoch=130.3] | Loss=0.00859 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.995 | 3777.1 samples/s | 59.0 steps/s
[Step=26750 Epoch=130.5] | Loss=0.00775 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=2.996 | 3783.0 samples/s | 59.1 steps/s
[Step=26800 Epoch=130.8] | Loss=0.00721 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.553 | FP-Norm(final)=2.997 | 4617.3 samples/s | 72.1 steps/s
[Step=26850 Epoch=131.0] | Loss=0.00671 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.549 | FP-Norm(final)=2.998 | 1647.3 samples/s | 25.7 steps/s
[Step=26900 Epoch=131.3] | Loss=0.00634 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=2.999 | 3749.2 samples/s | 58.6 steps/s
[Step=26950 Epoch=131.5] | Loss=0.00622 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.544 | FP-Norm(final)=3.000 | 3793.5 samples/s | 59.3 steps/s
[Step=27000 Epoch=131.7] | Loss=0.00586 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=3.001 | 4383.9 samples/s | 68.5 steps/s
[Step=27050 Epoch=132.0] | Loss=0.00574 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=3.002 | 1692.3 samples/s | 26.4 steps/s
[Step=27100 Epoch=132.2] | Loss=0.00548 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=3.003 | 3788.2 samples/s | 59.2 steps/s
[Step=27150 Epoch=132.5] | Loss=0.00533 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=3.004 | 3790.0 samples/s | 59.2 steps/s
[Step=27200 Epoch=132.7] | Loss=0.00527 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=3.004 | 4186.3 samples/s | 65.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step27200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.6] | Loss=0.07540 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=2.992 | 3655.0 samples/s | 57.1 steps/s
[Step=26450 Epoch=128.9] | Loss=0.01939 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=2.991 | 3628.2 samples/s | 56.7 steps/s
[Step=26500 Epoch=129.1] | Loss=0.01462 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.992 | 3765.4 samples/s | 58.8 steps/s
[Step=26550 Epoch=129.4] | Loss=0.01185 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=2.993 | 3784.9 samples/s | 59.1 steps/s
[Step=26600 Epoch=129.6] | Loss=0.01051 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=2.994 | 4821.1 samples/s | 75.3 steps/s
[Step=26650 Epoch=129.9] | Loss=0.00912 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=2.995 | 1625.6 samples/s | 25.4 steps/s
[Step=26700 Epoch=130.1] | Loss=0.00828 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.520 | FP-Norm(final)=2.997 | 3784.1 samples/s | 59.1 steps/s
[Step=26750 Epoch=130.3] | Loss=0.00774 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=2.998 | 3801.5 samples/s | 59.4 steps/s
[Step=26800 Epoch=130.6] | Loss=0.00719 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=3.000 | 4527.4 samples/s | 70.7 steps/s
[Step=26850 Epoch=130.8] | Loss=0.00674 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=3.001 | 1673.9 samples/s | 26.2 steps/s
[Step=26900 Epoch=131.1] | Loss=0.00635 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=3.003 | 3760.7 samples/s | 58.8 steps/s
[Step=26950 Epoch=131.3] | Loss=0.00605 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=3.005 | 3784.8 samples/s | 59.1 steps/s
[Step=27000 Epoch=131.6] | Loss=0.00578 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=3.006 | 4279.6 samples/s | 66.9 steps/s
[Step=27050 Epoch=131.8] | Loss=0.00554 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.513 | FP-Norm(final)=3.008 | 1685.0 samples/s | 26.3 steps/s
[Step=27100 Epoch=132.0] | Loss=0.00530 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=3.009 | 3798.6 samples/s | 59.4 steps/s
[Step=27150 Epoch=132.3] | Loss=0.00512 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=3.010 | 3779.8 samples/s | 59.1 steps/s
[Step=27200 Epoch=132.5] | Loss=0.00497 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=3.012 | 4060.1 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step27200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.7] | Loss=0.09041 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.992 | 3619.9 samples/s | 56.6 steps/s
[Step=26450 Epoch=129.0] | Loss=0.01475 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=2.995 | 3670.0 samples/s | 57.3 steps/s
[Step=26500 Epoch=129.2] | Loss=0.01178 | Reg=0.00023 | acc=0.9688 | FP-Norm=0.465 | FP-Norm(final)=2.996 | 3789.7 samples/s | 59.2 steps/s
[Step=26550 Epoch=129.5] | Loss=0.00999 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=2.997 | 3775.8 samples/s | 59.0 steps/s
[Step=26600 Epoch=129.7] | Loss=0.00909 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=2.998 | 4855.5 samples/s | 75.9 steps/s
[Step=26650 Epoch=130.0] | Loss=0.00765 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=2.999 | 1624.1 samples/s | 25.4 steps/s
[Step=26700 Epoch=130.2] | Loss=0.00713 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.001 | 3765.8 samples/s | 58.8 steps/s
[Step=26750 Epoch=130.4] | Loss=0.00662 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=3.002 | 3809.1 samples/s | 59.5 steps/s
[Step=26800 Epoch=130.7] | Loss=0.00626 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=3.004 | 4577.4 samples/s | 71.5 steps/s
[Step=26850 Epoch=130.9] | Loss=0.00585 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=3.005 | 1674.1 samples/s | 26.2 steps/s
[Step=26900 Epoch=131.2] | Loss=0.00541 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=3.006 | 3779.0 samples/s | 59.0 steps/s
[Step=26950 Epoch=131.4] | Loss=0.00512 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.007 | 3800.3 samples/s | 59.4 steps/s
[Step=27000 Epoch=131.7] | Loss=0.00502 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.510 | FP-Norm(final)=3.009 | 4284.4 samples/s | 66.9 steps/s
[Step=27050 Epoch=131.9] | Loss=0.00476 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.010 | 1703.6 samples/s | 26.6 steps/s
[Step=27100 Epoch=132.2] | Loss=0.00455 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=3.011 | 3746.5 samples/s | 58.5 steps/s
[Step=27150 Epoch=132.4] | Loss=0.00443 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.012 | 3802.9 samples/s | 59.4 steps/s
[Step=27200 Epoch=132.6] | Loss=0.00440 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.013 | 4045.5 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step27200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=129.5] | Loss=0.13699 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=2.992 | 3702.7 samples/s | 57.9 steps/s
[Step=26450 Epoch=129.7] | Loss=0.01886 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=2.991 | 3569.4 samples/s | 55.8 steps/s
[Step=26500 Epoch=130.0] | Loss=0.01426 | Reg=0.00023 | acc=0.9688 | FP-Norm=0.463 | FP-Norm(final)=2.991 | 3800.7 samples/s | 59.4 steps/s
[Step=26550 Epoch=130.2] | Loss=0.01173 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.482 | FP-Norm(final)=2.992 | 3782.2 samples/s | 59.1 steps/s
[Step=26600 Epoch=130.4] | Loss=0.01034 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.993 | 4913.0 samples/s | 76.8 steps/s
[Step=26650 Epoch=130.7] | Loss=0.00879 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.496 | FP-Norm(final)=2.994 | 1604.9 samples/s | 25.1 steps/s
[Step=26700 Epoch=130.9] | Loss=0.00792 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=2.995 | 3788.6 samples/s | 59.2 steps/s
[Step=26750 Epoch=131.2] | Loss=0.00746 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=2.997 | 3765.1 samples/s | 58.8 steps/s
[Step=26800 Epoch=131.4] | Loss=0.00688 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=2.998 | 4721.8 samples/s | 73.8 steps/s
[Step=26850 Epoch=131.7] | Loss=0.00638 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.497 | FP-Norm(final)=2.999 | 1640.4 samples/s | 25.6 steps/s
[Step=26900 Epoch=131.9] | Loss=0.00604 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.497 | FP-Norm(final)=3.000 | 3775.1 samples/s | 59.0 steps/s
[Step=26950 Epoch=132.2] | Loss=0.00569 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=3.001 | 3803.6 samples/s | 59.4 steps/s
[Step=27000 Epoch=132.4] | Loss=0.00544 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=3.002 | 4540.2 samples/s | 70.9 steps/s
[Step=27050 Epoch=132.6] | Loss=0.00520 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=3.003 | 1642.2 samples/s | 25.7 steps/s
[Step=27100 Epoch=132.9] | Loss=0.00504 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=3.004 | 3780.1 samples/s | 59.1 steps/s
[Step=27150 Epoch=133.1] | Loss=0.00486 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.494 | FP-Norm(final)=3.005 | 3787.3 samples/s | 59.2 steps/s
[Step=27200 Epoch=133.4] | Loss=0.00469 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=3.007 | 4340.2 samples/s | 67.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step27200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=250.2] | Loss=0.06774 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.992 | 3533.9 samples/s | 55.2 steps/s
[Step=26450 Epoch=250.6] | Loss=0.00474 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=2.994 | 3312.5 samples/s | 51.8 steps/s
[Step=26500 Epoch=251.1] | Loss=0.00248 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.994 | 4647.3 samples/s | 72.6 steps/s
[Step=26550 Epoch=251.6] | Loss=0.00168 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=2.995 | 1550.3 samples/s | 24.2 steps/s
[Step=26600 Epoch=252.1] | Loss=0.00127 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=2.995 | 4303.1 samples/s | 67.2 steps/s
[Step=26650 Epoch=252.5] | Loss=0.00102 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=2.995 | 1587.6 samples/s | 24.8 steps/s
[Step=26700 Epoch=253.0] | Loss=0.00086 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=2.996 | 4083.3 samples/s | 63.8 steps/s
[Step=26750 Epoch=253.5] | Loss=0.00074 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=2.996 | 1621.6 samples/s | 25.3 steps/s
[Step=26800 Epoch=254.0] | Loss=0.00065 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=2.996 | 3840.5 samples/s | 60.0 steps/s
[Step=26850 Epoch=254.4] | Loss=0.00058 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.474 | FP-Norm(final)=2.996 | 1673.2 samples/s | 26.1 steps/s
[Step=26900 Epoch=254.9] | Loss=0.00052 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.467 | FP-Norm(final)=2.996 | 3633.0 samples/s | 56.8 steps/s
[Step=26950 Epoch=255.4] | Loss=0.00048 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=2.996 | 1696.8 samples/s | 26.5 steps/s
[Step=27000 Epoch=255.8] | Loss=0.00044 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=2.997 | 3614.4 samples/s | 56.5 steps/s
[Step=27050 Epoch=256.3] | Loss=0.00041 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=2.997 | 1705.2 samples/s | 26.6 steps/s
[Step=27100 Epoch=256.8] | Loss=0.00038 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.997 | 3636.7 samples/s | 56.8 steps/s
[Step=27150 Epoch=257.3] | Loss=0.00036 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=2.997 | 1734.8 samples/s | 27.1 steps/s
[Step=27200 Epoch=257.7] | Loss=0.00033 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.436 | FP-Norm(final)=2.997 | 3522.1 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step27200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=251.1] | Loss=0.09110 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=2.992 | 3616.0 samples/s | 56.5 steps/s
[Step=26450 Epoch=251.6] | Loss=0.00435 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=2.992 | 3309.7 samples/s | 51.7 steps/s
[Step=26500 Epoch=252.1] | Loss=0.00220 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.574 | FP-Norm(final)=2.993 | 4634.1 samples/s | 72.4 steps/s
[Step=26550 Epoch=252.6] | Loss=0.00147 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=2.993 | 1553.2 samples/s | 24.3 steps/s
[Step=26600 Epoch=253.0] | Loss=0.00111 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.553 | FP-Norm(final)=2.993 | 4359.9 samples/s | 68.1 steps/s
[Step=26650 Epoch=253.5] | Loss=0.00089 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=2.993 | 1584.1 samples/s | 24.8 steps/s
[Step=26700 Epoch=254.0] | Loss=0.00075 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=2.993 | 4096.9 samples/s | 64.0 steps/s
[Step=26750 Epoch=254.5] | Loss=0.00064 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.521 | FP-Norm(final)=2.993 | 1633.3 samples/s | 25.5 steps/s
[Step=26800 Epoch=254.9] | Loss=0.00056 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=2.994 | 3842.9 samples/s | 60.0 steps/s
[Step=26850 Epoch=255.4] | Loss=0.00050 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=2.994 | 1681.7 samples/s | 26.3 steps/s
[Step=26900 Epoch=255.9] | Loss=0.00045 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=2.994 | 3602.0 samples/s | 56.3 steps/s
[Step=26950 Epoch=256.4] | Loss=0.00041 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=2.994 | 1703.8 samples/s | 26.6 steps/s
[Step=27000 Epoch=256.8] | Loss=0.00038 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.483 | FP-Norm(final)=2.994 | 3591.8 samples/s | 56.1 steps/s
[Step=27050 Epoch=257.3] | Loss=0.00035 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.477 | FP-Norm(final)=2.994 | 1700.3 samples/s | 26.6 steps/s
[Step=27100 Epoch=257.8] | Loss=0.00033 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.472 | FP-Norm(final)=2.994 | 3611.4 samples/s | 56.4 steps/s
[Step=27150 Epoch=258.3] | Loss=0.00031 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.466 | FP-Norm(final)=2.994 | 1737.8 samples/s | 27.2 steps/s
[Step=27200 Epoch=258.7] | Loss=0.00029 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=2.994 | 3527.5 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step27200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=252.1] | Loss=0.20693 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=2.992 | 3551.4 samples/s | 55.5 steps/s
[Step=26450 Epoch=252.6] | Loss=0.00962 | Reg=0.00052 | acc=1.0000 | FP-Norm=0.690 | FP-Norm(final)=2.992 | 3342.9 samples/s | 52.2 steps/s
[Step=26500 Epoch=253.1] | Loss=0.00484 | Reg=0.00053 | acc=1.0000 | FP-Norm=0.714 | FP-Norm(final)=2.992 | 4727.5 samples/s | 73.9 steps/s
[Step=26550 Epoch=253.5] | Loss=0.00325 | Reg=0.00051 | acc=1.0000 | FP-Norm=0.707 | FP-Norm(final)=2.992 | 1546.1 samples/s | 24.2 steps/s
[Step=26600 Epoch=254.0] | Loss=0.00245 | Reg=0.00050 | acc=1.0000 | FP-Norm=0.696 | FP-Norm(final)=2.992 | 4424.7 samples/s | 69.1 steps/s
[Step=26650 Epoch=254.5] | Loss=0.00197 | Reg=0.00048 | acc=1.0000 | FP-Norm=0.683 | FP-Norm(final)=2.992 | 1568.0 samples/s | 24.5 steps/s
[Step=26700 Epoch=255.0] | Loss=0.00164 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.671 | FP-Norm(final)=2.992 | 4210.9 samples/s | 65.8 steps/s
[Step=26750 Epoch=255.4] | Loss=0.00141 | Reg=0.00044 | acc=1.0000 | FP-Norm=0.660 | FP-Norm(final)=2.992 | 1603.5 samples/s | 25.1 steps/s
[Step=26800 Epoch=255.9] | Loss=0.00124 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.650 | FP-Norm(final)=2.992 | 3990.1 samples/s | 62.3 steps/s
[Step=26850 Epoch=256.4] | Loss=0.00110 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.640 | FP-Norm(final)=2.992 | 1644.3 samples/s | 25.7 steps/s
[Step=26900 Epoch=256.9] | Loss=0.00099 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.631 | FP-Norm(final)=2.992 | 3807.1 samples/s | 59.5 steps/s
[Step=26950 Epoch=257.4] | Loss=0.00091 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.623 | FP-Norm(final)=2.993 | 1659.0 samples/s | 25.9 steps/s
[Step=27000 Epoch=257.8] | Loss=0.00083 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.615 | FP-Norm(final)=2.993 | 3624.2 samples/s | 56.6 steps/s
[Step=27050 Epoch=258.3] | Loss=0.00077 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.608 | FP-Norm(final)=2.993 | 1699.3 samples/s | 26.6 steps/s
[Step=27100 Epoch=258.8] | Loss=0.00072 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.601 | FP-Norm(final)=2.993 | 3567.5 samples/s | 55.7 steps/s
[Step=27150 Epoch=259.3] | Loss=0.00067 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=2.993 | 1714.1 samples/s | 26.8 steps/s
[Step=27200 Epoch=259.7] | Loss=0.00063 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.588 | FP-Norm(final)=2.993 | 3604.2 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step27200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=248.8] | Loss=0.08937 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=2.992 | 3562.5 samples/s | 55.7 steps/s
[Step=26450 Epoch=249.2] | Loss=0.00621 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=2.992 | 3347.2 samples/s | 52.3 steps/s
[Step=26500 Epoch=249.7] | Loss=0.00319 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=2.992 | 4641.0 samples/s | 72.5 steps/s
[Step=26550 Epoch=250.2] | Loss=0.00214 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=2.992 | 1553.3 samples/s | 24.3 steps/s
[Step=26600 Epoch=250.6] | Loss=0.00161 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=2.992 | 4245.6 samples/s | 66.3 steps/s
[Step=26650 Epoch=251.1] | Loss=0.00129 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=2.993 | 1599.7 samples/s | 25.0 steps/s
[Step=26700 Epoch=251.6] | Loss=0.00108 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=2.993 | 3980.9 samples/s | 62.2 steps/s
[Step=26750 Epoch=252.1] | Loss=0.00093 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=2.993 | 1639.2 samples/s | 25.6 steps/s
[Step=26800 Epoch=252.5] | Loss=0.00082 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=2.993 | 3696.9 samples/s | 57.8 steps/s
[Step=26850 Epoch=253.0] | Loss=0.00073 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=2.993 | 1698.9 samples/s | 26.5 steps/s
[Step=26900 Epoch=253.5] | Loss=0.00066 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.479 | FP-Norm(final)=2.993 | 3568.1 samples/s | 55.8 steps/s
[Step=26950 Epoch=253.9] | Loss=0.00060 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.473 | FP-Norm(final)=2.994 | 1719.5 samples/s | 26.9 steps/s
[Step=27000 Epoch=254.4] | Loss=0.00055 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.467 | FP-Norm(final)=2.994 | 3640.7 samples/s | 56.9 steps/s
[Step=27050 Epoch=254.9] | Loss=0.00051 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.462 | FP-Norm(final)=2.994 | 1698.4 samples/s | 26.5 steps/s
[Step=27100 Epoch=255.4] | Loss=0.00047 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=2.994 | 3559.1 samples/s | 55.6 steps/s
[Step=27150 Epoch=255.8] | Loss=0.00044 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=2.994 | 1818.5 samples/s | 28.4 steps/s
[Step=27200 Epoch=256.3] | Loss=0.00042 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.448 | FP-Norm(final)=2.994 | 3231.5 samples/s | 50.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step27200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=251.6] | Loss=0.05800 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=2.992 | 3557.3 samples/s | 55.6 steps/s
[Step=26450 Epoch=252.1] | Loss=0.00345 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.994 | 3326.2 samples/s | 52.0 steps/s
[Step=26500 Epoch=252.6] | Loss=0.00175 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=2.995 | 4679.5 samples/s | 73.1 steps/s
[Step=26550 Epoch=253.0] | Loss=0.00118 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=2.995 | 1533.3 samples/s | 24.0 steps/s
[Step=26600 Epoch=253.5] | Loss=0.00089 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=2.995 | 4388.6 samples/s | 68.6 steps/s
[Step=26650 Epoch=254.0] | Loss=0.00072 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=2.996 | 1562.8 samples/s | 24.4 steps/s
[Step=26700 Epoch=254.5] | Loss=0.00060 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=2.996 | 4181.3 samples/s | 65.3 steps/s
[Step=26750 Epoch=255.0] | Loss=0.00052 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=2.996 | 1612.9 samples/s | 25.2 steps/s
[Step=26800 Epoch=255.4] | Loss=0.00046 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.484 | FP-Norm(final)=2.996 | 3925.5 samples/s | 61.3 steps/s
[Step=26850 Epoch=255.9] | Loss=0.00041 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.477 | FP-Norm(final)=2.997 | 1622.4 samples/s | 25.3 steps/s
[Step=26900 Epoch=256.4] | Loss=0.00037 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=2.997 | 3736.6 samples/s | 58.4 steps/s
[Step=26950 Epoch=256.9] | Loss=0.00034 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=2.997 | 1657.9 samples/s | 25.9 steps/s
[Step=27000 Epoch=257.3] | Loss=0.00031 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.460 | FP-Norm(final)=2.997 | 3618.5 samples/s | 56.5 steps/s
[Step=27050 Epoch=257.8] | Loss=0.00029 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.455 | FP-Norm(final)=2.997 | 1702.9 samples/s | 26.6 steps/s
[Step=27100 Epoch=258.3] | Loss=0.00027 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=2.997 | 3541.8 samples/s | 55.3 steps/s
[Step=27150 Epoch=258.8] | Loss=0.00025 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=2.997 | 1719.8 samples/s | 26.9 steps/s
[Step=27200 Epoch=259.2] | Loss=0.00024 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=2.998 | 3612.4 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19945 | acc=0.8922 | tpr=0.8512 | fpr=0.0188 | 3630.5 samples/s | 14.2 steps/s
Avg test loss: 0.20190, Avg test acc: 0.89226, Avg tpr: 0.85254, Avg fpr: 0.02038, total FA: 159

Testing server on iccad2012
[Step=  50] | Loss=0.52169 | acc=0.8530 | tpr=0.9690 | fpr=0.1491 | 3660.8 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.54327 | acc=0.8504 | tpr=0.9723 | fpr=0.1519 | 6877.8 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.55509 | acc=0.8476 | tpr=0.9683 | fpr=0.1546 | 6737.3 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.55524 | acc=0.8487 | tpr=0.9716 | fpr=0.1536 | 6938.5 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.55248 | acc=0.8485 | tpr=0.9651 | fpr=0.1536 | 6933.1 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.55682 | acc=0.8484 | tpr=0.9651 | fpr=0.1537 | 6803.0 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.55744 | acc=0.8487 | tpr=0.9662 | fpr=0.1534 | 6830.1 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.55816 | acc=0.8485 | tpr=0.9666 | fpr=0.1537 | 6823.0 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.56259 | acc=0.8483 | tpr=0.9664 | fpr=0.1539 | 6718.0 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.56306 | acc=0.8480 | tpr=0.9674 | fpr=0.1541 | 6697.2 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.56242 | acc=0.8482 | tpr=0.9678 | fpr=0.1540 | 13059.1 samples/s | 51.0 steps/s
Avg test loss: 0.56233, Avg test acc: 0.84820, Avg tpr: 0.96791, Avg fpr: 0.15397, total FA: 21379

server round 34/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.6] | Loss=0.13766 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.010 | 3784.4 samples/s | 59.1 steps/s
[Step=27250 Epoch=132.9] | Loss=0.02165 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.479 | FP-Norm(final)=3.011 | 3532.3 samples/s | 55.2 steps/s
[Step=27300 Epoch=133.1] | Loss=0.01505 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=3.011 | 3762.9 samples/s | 58.8 steps/s
[Step=27350 Epoch=133.4] | Loss=0.01263 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=3.011 | 3799.8 samples/s | 59.4 steps/s
[Step=27400 Epoch=133.6] | Loss=0.01030 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=3.012 | 4841.4 samples/s | 75.6 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00911 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=3.013 | 1628.5 samples/s | 25.4 steps/s
[Step=27500 Epoch=134.1] | Loss=0.00813 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=3.015 | 3779.9 samples/s | 59.1 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00769 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=3.016 | 3767.1 samples/s | 58.9 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00731 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.530 | FP-Norm(final)=3.017 | 4578.2 samples/s | 71.5 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00671 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=3.018 | 1674.4 samples/s | 26.2 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00628 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.526 | FP-Norm(final)=3.019 | 3807.1 samples/s | 59.5 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00609 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=3.020 | 3752.6 samples/s | 58.6 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00599 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=3.021 | 4318.3 samples/s | 67.5 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00584 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.522 | FP-Norm(final)=3.022 | 1697.1 samples/s | 26.5 steps/s
[Step=27900 Epoch=136.0] | Loss=0.00571 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.521 | FP-Norm(final)=3.023 | 3736.4 samples/s | 58.4 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00551 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.520 | FP-Norm(final)=3.023 | 3770.9 samples/s | 58.9 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00537 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=3.024 | 4091.2 samples/s | 63.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step28000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.7] | Loss=0.08693 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.010 | 3743.4 samples/s | 58.5 steps/s
[Step=27250 Epoch=133.0] | Loss=0.02235 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.008 | 3589.9 samples/s | 56.1 steps/s
[Step=27300 Epoch=133.2] | Loss=0.01541 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=3.007 | 3764.1 samples/s | 58.8 steps/s
[Step=27350 Epoch=133.5] | Loss=0.01212 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=3.008 | 3790.1 samples/s | 59.2 steps/s
[Step=27400 Epoch=133.7] | Loss=0.01059 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=3.009 | 4852.3 samples/s | 75.8 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00946 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=3.010 | 1626.9 samples/s | 25.4 steps/s
[Step=27500 Epoch=134.2] | Loss=0.00858 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=3.011 | 3777.6 samples/s | 59.0 steps/s
[Step=27550 Epoch=134.4] | Loss=0.00772 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=3.012 | 3773.9 samples/s | 59.0 steps/s
[Step=27600 Epoch=134.7] | Loss=0.00712 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=3.014 | 4624.7 samples/s | 72.3 steps/s
[Step=27650 Epoch=134.9] | Loss=0.00672 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=3.015 | 1648.1 samples/s | 25.8 steps/s
[Step=27700 Epoch=135.2] | Loss=0.00643 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=3.016 | 3778.6 samples/s | 59.0 steps/s
[Step=27750 Epoch=135.4] | Loss=0.00616 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=3.017 | 3794.9 samples/s | 59.3 steps/s
[Step=27800 Epoch=135.7] | Loss=0.00583 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.540 | FP-Norm(final)=3.018 | 4387.5 samples/s | 68.6 steps/s
[Step=27850 Epoch=135.9] | Loss=0.00562 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.538 | FP-Norm(final)=3.019 | 1691.4 samples/s | 26.4 steps/s
[Step=27900 Epoch=136.1] | Loss=0.00533 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=3.020 | 3816.4 samples/s | 59.6 steps/s
[Step=27950 Epoch=136.4] | Loss=0.00517 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=3.021 | 3754.8 samples/s | 58.7 steps/s
[Step=28000 Epoch=136.6] | Loss=0.00515 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=3.021 | 4180.0 samples/s | 65.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step28000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.5] | Loss=0.01134 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.010 | 3821.6 samples/s | 59.7 steps/s
[Step=27250 Epoch=132.8] | Loss=0.01557 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.390 | FP-Norm(final)=3.013 | 3465.7 samples/s | 54.2 steps/s
[Step=27300 Epoch=133.0] | Loss=0.01191 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.445 | FP-Norm(final)=3.013 | 3769.6 samples/s | 58.9 steps/s
[Step=27350 Epoch=133.3] | Loss=0.01047 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.470 | FP-Norm(final)=3.015 | 3777.7 samples/s | 59.0 steps/s
[Step=27400 Epoch=133.5] | Loss=0.00933 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.486 | FP-Norm(final)=3.016 | 4810.2 samples/s | 75.2 steps/s
[Step=27450 Epoch=133.7] | Loss=0.00791 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=3.018 | 1636.0 samples/s | 25.6 steps/s
[Step=27500 Epoch=134.0] | Loss=0.00729 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=3.019 | 3771.0 samples/s | 58.9 steps/s
[Step=27550 Epoch=134.2] | Loss=0.00685 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.021 | 3768.8 samples/s | 58.9 steps/s
[Step=27600 Epoch=134.5] | Loss=0.00635 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.022 | 4535.6 samples/s | 70.9 steps/s
[Step=27650 Epoch=134.7] | Loss=0.00589 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.023 | 1670.8 samples/s | 26.1 steps/s
[Step=27700 Epoch=135.0] | Loss=0.00548 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.025 | 3770.9 samples/s | 58.9 steps/s
[Step=27750 Epoch=135.2] | Loss=0.00526 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.026 | 3802.1 samples/s | 59.4 steps/s
[Step=27800 Epoch=135.5] | Loss=0.00514 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.028 | 4287.8 samples/s | 67.0 steps/s
[Step=27850 Epoch=135.7] | Loss=0.00505 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.029 | 1708.1 samples/s | 26.7 steps/s
[Step=27900 Epoch=135.9] | Loss=0.00490 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.501 | FP-Norm(final)=3.030 | 3809.5 samples/s | 59.5 steps/s
[Step=27950 Epoch=136.2] | Loss=0.00473 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.031 | 3800.4 samples/s | 59.4 steps/s
[Step=28000 Epoch=136.4] | Loss=0.00460 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.033 | 4039.4 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step28000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.6] | Loss=0.12021 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.010 | 3786.6 samples/s | 59.2 steps/s
[Step=27250 Epoch=132.9] | Loss=0.01897 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.430 | FP-Norm(final)=3.010 | 3508.5 samples/s | 54.8 steps/s
[Step=27300 Epoch=133.1] | Loss=0.01304 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=3.010 | 3773.7 samples/s | 59.0 steps/s
[Step=27350 Epoch=133.4] | Loss=0.01105 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.011 | 3756.3 samples/s | 58.7 steps/s
[Step=27400 Epoch=133.6] | Loss=0.00916 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=3.012 | 4812.3 samples/s | 75.2 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00797 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=3.014 | 1619.6 samples/s | 25.3 steps/s
[Step=27500 Epoch=134.1] | Loss=0.00738 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.516 | FP-Norm(final)=3.015 | 3786.4 samples/s | 59.2 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00682 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=3.017 | 3754.4 samples/s | 58.7 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00639 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=3.018 | 4546.5 samples/s | 71.0 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00600 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=3.019 | 1665.9 samples/s | 26.0 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00559 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=3.020 | 3731.5 samples/s | 58.3 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00534 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.021 | 3773.5 samples/s | 59.0 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00513 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=3.023 | 4278.8 samples/s | 66.9 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00494 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=3.024 | 1687.2 samples/s | 26.4 steps/s
[Step=27900 Epoch=136.1] | Loss=0.00481 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.507 | FP-Norm(final)=3.025 | 3760.2 samples/s | 58.8 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00460 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.026 | 3767.1 samples/s | 58.9 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00443 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.027 | 4080.9 samples/s | 63.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step28000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=133.4] | Loss=0.07224 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.010 | 3621.3 samples/s | 56.6 steps/s
[Step=27250 Epoch=133.6] | Loss=0.02111 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=3.008 | 3619.9 samples/s | 56.6 steps/s
[Step=27300 Epoch=133.9] | Loss=0.01428 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.478 | FP-Norm(final)=3.008 | 3813.7 samples/s | 59.6 steps/s
[Step=27350 Epoch=134.1] | Loss=0.01228 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.497 | FP-Norm(final)=3.009 | 3734.3 samples/s | 58.3 steps/s
[Step=27400 Epoch=134.4] | Loss=0.01082 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.009 | 4897.3 samples/s | 76.5 steps/s
[Step=27450 Epoch=134.6] | Loss=0.00924 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.011 | 1619.6 samples/s | 25.3 steps/s
[Step=27500 Epoch=134.9] | Loss=0.00808 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.012 | 3776.2 samples/s | 59.0 steps/s
[Step=27550 Epoch=135.1] | Loss=0.00756 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.014 | 3786.0 samples/s | 59.2 steps/s
[Step=27600 Epoch=135.3] | Loss=0.00705 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.504 | FP-Norm(final)=3.015 | 4697.6 samples/s | 73.4 steps/s
[Step=27650 Epoch=135.6] | Loss=0.00656 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.503 | FP-Norm(final)=3.016 | 1639.3 samples/s | 25.6 steps/s
[Step=27700 Epoch=135.8] | Loss=0.00612 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.017 | 3743.3 samples/s | 58.5 steps/s
[Step=27750 Epoch=136.1] | Loss=0.00572 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.019 | 3765.0 samples/s | 58.8 steps/s
[Step=27800 Epoch=136.3] | Loss=0.00548 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.020 | 4511.6 samples/s | 70.5 steps/s
[Step=27850 Epoch=136.6] | Loss=0.00523 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.021 | 1666.6 samples/s | 26.0 steps/s
[Step=27900 Epoch=136.8] | Loss=0.00505 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.022 | 3787.2 samples/s | 59.2 steps/s
[Step=27950 Epoch=137.1] | Loss=0.00492 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.023 | 3775.9 samples/s | 59.0 steps/s
[Step=28000 Epoch=137.3] | Loss=0.00482 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.024 | 4366.2 samples/s | 68.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step28000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=257.8] | Loss=0.02898 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.010 | 3799.4 samples/s | 59.4 steps/s
[Step=27250 Epoch=258.2] | Loss=0.00359 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=3.013 | 3264.6 samples/s | 51.0 steps/s
[Step=27300 Epoch=258.7] | Loss=0.00183 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.590 | FP-Norm(final)=3.014 | 4692.9 samples/s | 73.3 steps/s
[Step=27350 Epoch=259.2] | Loss=0.00134 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.588 | FP-Norm(final)=3.015 | 1537.6 samples/s | 24.0 steps/s
[Step=27400 Epoch=259.6] | Loss=0.00101 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=3.015 | 4358.7 samples/s | 68.1 steps/s
[Step=27450 Epoch=260.1] | Loss=0.00082 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=3.015 | 1585.2 samples/s | 24.8 steps/s
[Step=27500 Epoch=260.6] | Loss=0.00068 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=3.015 | 4064.9 samples/s | 63.5 steps/s
[Step=27550 Epoch=261.1] | Loss=0.00059 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=3.015 | 1621.0 samples/s | 25.3 steps/s
[Step=27600 Epoch=261.5] | Loss=0.00052 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=3.015 | 3846.0 samples/s | 60.1 steps/s
[Step=27650 Epoch=262.0] | Loss=0.00046 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=3.015 | 1678.2 samples/s | 26.2 steps/s
[Step=27700 Epoch=262.5] | Loss=0.00042 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=3.015 | 3622.5 samples/s | 56.6 steps/s
[Step=27750 Epoch=263.0] | Loss=0.00038 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.015 | 1675.5 samples/s | 26.2 steps/s
[Step=27800 Epoch=263.4] | Loss=0.00035 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.015 | 3616.9 samples/s | 56.5 steps/s
[Step=27850 Epoch=263.9] | Loss=0.00032 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=3.015 | 1709.4 samples/s | 26.7 steps/s
[Step=27900 Epoch=264.4] | Loss=0.00030 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.492 | FP-Norm(final)=3.015 | 3581.7 samples/s | 56.0 steps/s
[Step=27950 Epoch=264.9] | Loss=0.00028 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=3.016 | 1740.5 samples/s | 27.2 steps/s
[Step=28000 Epoch=265.3] | Loss=0.00026 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.480 | FP-Norm(final)=3.016 | 3493.2 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step28000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=258.7] | Loss=0.02123 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.010 | 3503.0 samples/s | 54.7 steps/s
[Step=27250 Epoch=259.2] | Loss=0.00349 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.482 | FP-Norm(final)=3.011 | 3352.9 samples/s | 52.4 steps/s
[Step=27300 Epoch=259.7] | Loss=0.00179 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.011 | 4667.7 samples/s | 72.9 steps/s
[Step=27350 Epoch=260.2] | Loss=0.00122 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.012 | 1539.4 samples/s | 24.1 steps/s
[Step=27400 Epoch=260.6] | Loss=0.00092 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=3.012 | 4307.7 samples/s | 67.3 steps/s
[Step=27450 Epoch=261.1] | Loss=0.00074 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.483 | FP-Norm(final)=3.013 | 1581.3 samples/s | 24.7 steps/s
[Step=27500 Epoch=261.6] | Loss=0.00062 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.474 | FP-Norm(final)=3.013 | 4086.9 samples/s | 63.9 steps/s
[Step=27550 Epoch=262.1] | Loss=0.00053 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=3.013 | 1614.2 samples/s | 25.2 steps/s
[Step=27600 Epoch=262.5] | Loss=0.00047 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=3.013 | 3865.5 samples/s | 60.4 steps/s
[Step=27650 Epoch=263.0] | Loss=0.00042 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=3.013 | 1649.7 samples/s | 25.8 steps/s
[Step=27700 Epoch=263.5] | Loss=0.00038 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.444 | FP-Norm(final)=3.014 | 3649.5 samples/s | 57.0 steps/s
[Step=27750 Epoch=264.0] | Loss=0.00035 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=3.014 | 1680.1 samples/s | 26.3 steps/s
[Step=27800 Epoch=264.4] | Loss=0.00032 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=3.014 | 3616.0 samples/s | 56.5 steps/s
[Step=27850 Epoch=264.9] | Loss=0.00030 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=3.014 | 1712.1 samples/s | 26.8 steps/s
[Step=27900 Epoch=265.4] | Loss=0.00028 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=3.014 | 3592.2 samples/s | 56.1 steps/s
[Step=27950 Epoch=265.9] | Loss=0.00026 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.014 | 1704.8 samples/s | 26.6 steps/s
[Step=28000 Epoch=266.3] | Loss=0.00024 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=3.014 | 3581.8 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step28000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=259.8] | Loss=0.12570 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.010 | 3406.3 samples/s | 53.2 steps/s
[Step=27250 Epoch=260.2] | Loss=0.00714 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=3.010 | 3473.2 samples/s | 54.3 steps/s
[Step=27300 Epoch=260.7] | Loss=0.00361 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=3.011 | 4610.4 samples/s | 72.0 steps/s
[Step=27350 Epoch=261.2] | Loss=0.00242 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=3.011 | 1577.3 samples/s | 24.6 steps/s
[Step=27400 Epoch=261.7] | Loss=0.00182 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=3.011 | 4415.9 samples/s | 69.0 steps/s
[Step=27450 Epoch=262.1] | Loss=0.00146 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=3.011 | 1567.6 samples/s | 24.5 steps/s
[Step=27500 Epoch=262.6] | Loss=0.00122 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=3.011 | 4214.0 samples/s | 65.8 steps/s
[Step=27550 Epoch=263.1] | Loss=0.00105 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.532 | FP-Norm(final)=3.011 | 1604.3 samples/s | 25.1 steps/s
[Step=27600 Epoch=263.6] | Loss=0.00092 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=3.012 | 3981.5 samples/s | 62.2 steps/s
[Step=27650 Epoch=264.0] | Loss=0.00082 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=3.012 | 1629.3 samples/s | 25.5 steps/s
[Step=27700 Epoch=264.5] | Loss=0.00074 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.012 | 3814.5 samples/s | 59.6 steps/s
[Step=27750 Epoch=265.0] | Loss=0.00068 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.012 | 1668.0 samples/s | 26.1 steps/s
[Step=27800 Epoch=265.5] | Loss=0.00062 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=3.012 | 3633.4 samples/s | 56.8 steps/s
[Step=27850 Epoch=266.0] | Loss=0.00058 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=3.012 | 1702.8 samples/s | 26.6 steps/s
[Step=27900 Epoch=266.4] | Loss=0.00054 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=3.012 | 3570.5 samples/s | 55.8 steps/s
[Step=27950 Epoch=266.9] | Loss=0.00050 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.479 | FP-Norm(final)=3.012 | 1716.2 samples/s | 26.8 steps/s
[Step=28000 Epoch=267.4] | Loss=0.00047 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.474 | FP-Norm(final)=3.012 | 3573.8 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step28000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=256.3] | Loss=0.11398 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.010 | 3492.7 samples/s | 54.6 steps/s
[Step=27250 Epoch=256.8] | Loss=0.00424 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.590 | FP-Norm(final)=3.014 | 3393.2 samples/s | 53.0 steps/s
[Step=27300 Epoch=257.2] | Loss=0.00213 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.606 | FP-Norm(final)=3.014 | 4617.4 samples/s | 72.1 steps/s
[Step=27350 Epoch=257.7] | Loss=0.00143 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=3.014 | 1558.9 samples/s | 24.4 steps/s
[Step=27400 Epoch=258.2] | Loss=0.00107 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=3.014 | 4247.3 samples/s | 66.4 steps/s
[Step=27450 Epoch=258.7] | Loss=0.00087 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=3.014 | 1597.6 samples/s | 25.0 steps/s
[Step=27500 Epoch=259.1] | Loss=0.00072 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=3.015 | 3967.5 samples/s | 62.0 steps/s
[Step=27550 Epoch=259.6] | Loss=0.00062 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=3.015 | 1656.6 samples/s | 25.9 steps/s
[Step=27600 Epoch=260.1] | Loss=0.00055 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=3.015 | 3698.8 samples/s | 57.8 steps/s
[Step=27650 Epoch=260.5] | Loss=0.00049 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=3.015 | 1690.6 samples/s | 26.4 steps/s
[Step=27700 Epoch=261.0] | Loss=0.00044 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.015 | 3615.8 samples/s | 56.5 steps/s
[Step=27750 Epoch=261.5] | Loss=0.00040 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.015 | 1708.6 samples/s | 26.7 steps/s
[Step=27800 Epoch=262.0] | Loss=0.00037 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=3.015 | 3624.5 samples/s | 56.6 steps/s
[Step=27850 Epoch=262.4] | Loss=0.00034 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=3.015 | 1745.4 samples/s | 27.3 steps/s
[Step=27900 Epoch=262.9] | Loss=0.00032 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.480 | FP-Norm(final)=3.015 | 3584.4 samples/s | 56.0 steps/s
[Step=27950 Epoch=263.4] | Loss=0.00030 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.474 | FP-Norm(final)=3.015 | 1893.4 samples/s | 29.6 steps/s
[Step=28000 Epoch=263.8] | Loss=0.00028 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.468 | FP-Norm(final)=3.015 | 3030.5 samples/s | 47.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step28000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=259.3] | Loss=0.08361 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.010 | 3798.7 samples/s | 59.4 steps/s
[Step=27250 Epoch=259.7] | Loss=0.00562 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=3.008 | 3155.0 samples/s | 49.3 steps/s
[Step=27300 Epoch=260.2] | Loss=0.00298 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.644 | FP-Norm(final)=3.008 | 4707.8 samples/s | 73.6 steps/s
[Step=27350 Epoch=260.7] | Loss=0.00200 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.641 | FP-Norm(final)=3.009 | 1555.0 samples/s | 24.3 steps/s
[Step=27400 Epoch=261.1] | Loss=0.00150 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.629 | FP-Norm(final)=3.009 | 4406.4 samples/s | 68.9 steps/s
[Step=27450 Epoch=261.6] | Loss=0.00121 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.617 | FP-Norm(final)=3.009 | 1568.7 samples/s | 24.5 steps/s
[Step=27500 Epoch=262.1] | Loss=0.00101 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=3.009 | 4203.2 samples/s | 65.7 steps/s
[Step=27550 Epoch=262.6] | Loss=0.00087 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.594 | FP-Norm(final)=3.009 | 1596.9 samples/s | 25.0 steps/s
[Step=27600 Epoch=263.1] | Loss=0.00076 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=3.010 | 3992.9 samples/s | 62.4 steps/s
[Step=27650 Epoch=263.5] | Loss=0.00068 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.574 | FP-Norm(final)=3.010 | 1646.7 samples/s | 25.7 steps/s
[Step=27700 Epoch=264.0] | Loss=0.00061 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=3.010 | 3767.8 samples/s | 58.9 steps/s
[Step=27750 Epoch=264.5] | Loss=0.00056 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=3.010 | 1657.8 samples/s | 25.9 steps/s
[Step=27800 Epoch=265.0] | Loss=0.00051 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.549 | FP-Norm(final)=3.010 | 3638.8 samples/s | 56.9 steps/s
[Step=27850 Epoch=265.4] | Loss=0.00048 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=3.010 | 1697.8 samples/s | 26.5 steps/s
[Step=27900 Epoch=265.9] | Loss=0.00044 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=3.010 | 3614.1 samples/s | 56.5 steps/s
[Step=27950 Epoch=266.4] | Loss=0.00041 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=3.011 | 1704.5 samples/s | 26.6 steps/s
[Step=28000 Epoch=266.9] | Loss=0.00039 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=3.011 | 3613.9 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19248 | acc=0.9002 | tpr=0.8625 | fpr=0.0178 | 3652.8 samples/s | 14.3 steps/s
Avg test loss: 0.19496, Avg test acc: 0.89915, Avg tpr: 0.86221, Avg fpr: 0.01961, total FA: 153

Testing server on iccad2012
[Step=  50] | Loss=0.55870 | acc=0.8458 | tpr=0.9690 | fpr=0.1564 | 3631.7 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.58103 | acc=0.8430 | tpr=0.9744 | fpr=0.1595 | 6947.5 samples/s | 27.1 steps/s
[Step= 150] | Loss=0.59363 | acc=0.8401 | tpr=0.9697 | fpr=0.1623 | 6785.3 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.59345 | acc=0.8412 | tpr=0.9727 | fpr=0.1612 | 6975.8 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.59070 | acc=0.8412 | tpr=0.9668 | fpr=0.1611 | 7017.5 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.59502 | acc=0.8409 | tpr=0.9665 | fpr=0.1614 | 6648.8 samples/s | 26.0 steps/s
[Step= 350] | Loss=0.59554 | acc=0.8412 | tpr=0.9674 | fpr=0.1611 | 6896.8 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.59615 | acc=0.8408 | tpr=0.9683 | fpr=0.1615 | 6677.3 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.60066 | acc=0.8406 | tpr=0.9684 | fpr=0.1617 | 6821.4 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.60125 | acc=0.8403 | tpr=0.9687 | fpr=0.1621 | 6723.3 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.60064 | acc=0.8404 | tpr=0.9690 | fpr=0.1619 | 12801.6 samples/s | 50.0 steps/s
Avg test loss: 0.60056, Avg test acc: 0.84045, Avg tpr: 0.96910, Avg fpr: 0.16189, total FA: 22478

server round 35/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.5] | Loss=0.02795 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.027 | 3574.6 samples/s | 55.9 steps/s
[Step=28050 Epoch=136.8] | Loss=0.01924 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=3.026 | 3745.0 samples/s | 58.5 steps/s
[Step=28100 Epoch=137.0] | Loss=0.01293 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.470 | FP-Norm(final)=3.026 | 3790.0 samples/s | 59.2 steps/s
[Step=28150 Epoch=137.3] | Loss=0.01162 | Reg=0.00024 | acc=0.9688 | FP-Norm=0.484 | FP-Norm(final)=3.027 | 3774.3 samples/s | 59.0 steps/s
[Step=28200 Epoch=137.5] | Loss=0.01001 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.494 | FP-Norm(final)=3.028 | 4834.8 samples/s | 75.5 steps/s
[Step=28250 Epoch=137.8] | Loss=0.00866 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.029 | 1625.5 samples/s | 25.4 steps/s
[Step=28300 Epoch=138.0] | Loss=0.00773 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.031 | 3769.1 samples/s | 58.9 steps/s
[Step=28350 Epoch=138.2] | Loss=0.00735 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.032 | 3753.5 samples/s | 58.6 steps/s
[Step=28400 Epoch=138.5] | Loss=0.00703 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.033 | 4531.8 samples/s | 70.8 steps/s
[Step=28450 Epoch=138.7] | Loss=0.00679 | Reg=0.00026 | acc=0.9688 | FP-Norm=0.503 | FP-Norm(final)=3.034 | 1660.8 samples/s | 26.0 steps/s
[Step=28500 Epoch=139.0] | Loss=0.00641 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.035 | 3749.7 samples/s | 58.6 steps/s
[Step=28550 Epoch=139.2] | Loss=0.00627 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.035 | 3797.2 samples/s | 59.3 steps/s
[Step=28600 Epoch=139.5] | Loss=0.00595 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.036 | 4302.2 samples/s | 67.2 steps/s
[Step=28650 Epoch=139.7] | Loss=0.00571 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.037 | 1698.4 samples/s | 26.5 steps/s
[Step=28700 Epoch=139.9] | Loss=0.00549 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.038 | 3779.9 samples/s | 59.1 steps/s
[Step=28750 Epoch=140.2] | Loss=0.00534 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=3.038 | 3771.9 samples/s | 58.9 steps/s
[Step=28800 Epoch=140.4] | Loss=0.00526 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=3.039 | 4052.3 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step28800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.6] | Loss=0.07941 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.027 | 3506.1 samples/s | 54.8 steps/s
[Step=28050 Epoch=136.9] | Loss=0.01822 | Reg=0.00020 | acc=0.9688 | FP-Norm=0.419 | FP-Norm(final)=3.026 | 3768.4 samples/s | 58.9 steps/s
[Step=28100 Epoch=137.1] | Loss=0.01317 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=3.026 | 3787.4 samples/s | 59.2 steps/s
[Step=28150 Epoch=137.4] | Loss=0.01095 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.491 | FP-Norm(final)=3.027 | 3769.1 samples/s | 58.9 steps/s
[Step=28200 Epoch=137.6] | Loss=0.00981 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.501 | FP-Norm(final)=3.028 | 4875.6 samples/s | 76.2 steps/s
[Step=28250 Epoch=137.8] | Loss=0.00862 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.029 | 1626.8 samples/s | 25.4 steps/s
[Step=28300 Epoch=138.1] | Loss=0.00761 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.030 | 3783.1 samples/s | 59.1 steps/s
[Step=28350 Epoch=138.3] | Loss=0.00705 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.032 | 3780.9 samples/s | 59.1 steps/s
[Step=28400 Epoch=138.6] | Loss=0.00678 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.033 | 4623.4 samples/s | 72.2 steps/s
[Step=28450 Epoch=138.8] | Loss=0.00634 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.034 | 1648.9 samples/s | 25.8 steps/s
[Step=28500 Epoch=139.1] | Loss=0.00591 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=3.035 | 3757.3 samples/s | 58.7 steps/s
[Step=28550 Epoch=139.3] | Loss=0.00575 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=3.036 | 3808.7 samples/s | 59.5 steps/s
[Step=28600 Epoch=139.6] | Loss=0.00547 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=3.037 | 4373.1 samples/s | 68.3 steps/s
[Step=28650 Epoch=139.8] | Loss=0.00524 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=3.038 | 1684.7 samples/s | 26.3 steps/s
[Step=28700 Epoch=140.0] | Loss=0.00515 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=3.039 | 3774.9 samples/s | 59.0 steps/s
[Step=28750 Epoch=140.3] | Loss=0.00509 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.492 | FP-Norm(final)=3.039 | 3775.8 samples/s | 59.0 steps/s
[Step=28800 Epoch=140.5] | Loss=0.00499 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=3.040 | 4191.0 samples/s | 65.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step28800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.4] | Loss=0.11374 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.027 | 3748.4 samples/s | 58.6 steps/s
[Step=28050 Epoch=136.7] | Loss=0.01963 | Reg=0.00021 | acc=0.9688 | FP-Norm=0.439 | FP-Norm(final)=3.026 | 3552.7 samples/s | 55.5 steps/s
[Step=28100 Epoch=136.9] | Loss=0.01393 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.478 | FP-Norm(final)=3.026 | 3775.9 samples/s | 59.0 steps/s
[Step=28150 Epoch=137.2] | Loss=0.01101 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.492 | FP-Norm(final)=3.027 | 3778.7 samples/s | 59.0 steps/s
[Step=28200 Epoch=137.4] | Loss=0.00999 | Reg=0.00026 | acc=0.9688 | FP-Norm=0.500 | FP-Norm(final)=3.028 | 4842.8 samples/s | 75.7 steps/s
[Step=28250 Epoch=137.6] | Loss=0.00870 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.030 | 1617.0 samples/s | 25.3 steps/s
[Step=28300 Epoch=137.9] | Loss=0.00789 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.031 | 3793.4 samples/s | 59.3 steps/s
[Step=28350 Epoch=138.1] | Loss=0.00728 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.032 | 3766.2 samples/s | 58.8 steps/s
[Step=28400 Epoch=138.4] | Loss=0.00673 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.034 | 4539.5 samples/s | 70.9 steps/s
[Step=28450 Epoch=138.6] | Loss=0.00627 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.508 | FP-Norm(final)=3.035 | 1651.1 samples/s | 25.8 steps/s
[Step=28500 Epoch=138.9] | Loss=0.00589 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.037 | 3791.1 samples/s | 59.2 steps/s
[Step=28550 Epoch=139.1] | Loss=0.00556 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.038 | 3769.8 samples/s | 58.9 steps/s
[Step=28600 Epoch=139.4] | Loss=0.00528 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.039 | 4294.9 samples/s | 67.1 steps/s
[Step=28650 Epoch=139.6] | Loss=0.00512 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.041 | 1700.0 samples/s | 26.6 steps/s
[Step=28700 Epoch=139.8] | Loss=0.00495 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.042 | 3767.1 samples/s | 58.9 steps/s
[Step=28750 Epoch=140.1] | Loss=0.00481 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.043 | 3801.4 samples/s | 59.4 steps/s
[Step=28800 Epoch=140.3] | Loss=0.00471 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.044 | 4075.4 samples/s | 63.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step28800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.5] | Loss=0.08136 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.027 | 3706.0 samples/s | 57.9 steps/s
[Step=28050 Epoch=136.8] | Loss=0.01620 | Reg=0.00021 | acc=0.9688 | FP-Norm=0.435 | FP-Norm(final)=3.028 | 3582.2 samples/s | 56.0 steps/s
[Step=28100 Epoch=137.0] | Loss=0.01221 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.479 | FP-Norm(final)=3.029 | 3769.2 samples/s | 58.9 steps/s
[Step=28150 Epoch=137.3] | Loss=0.00994 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=3.029 | 3776.8 samples/s | 59.0 steps/s
[Step=28200 Epoch=137.5] | Loss=0.00940 | Reg=0.00026 | acc=0.9531 | FP-Norm=0.505 | FP-Norm(final)=3.030 | 4825.0 samples/s | 75.4 steps/s
[Step=28250 Epoch=137.8] | Loss=0.00819 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=3.031 | 1637.5 samples/s | 25.6 steps/s
[Step=28300 Epoch=138.0] | Loss=0.00743 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=3.032 | 3779.6 samples/s | 59.1 steps/s
[Step=28350 Epoch=138.3] | Loss=0.00688 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.514 | FP-Norm(final)=3.033 | 3783.7 samples/s | 59.1 steps/s
[Step=28400 Epoch=138.5] | Loss=0.00645 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=3.034 | 4559.9 samples/s | 71.2 steps/s
[Step=28450 Epoch=138.7] | Loss=0.00622 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.035 | 1674.2 samples/s | 26.2 steps/s
[Step=28500 Epoch=139.0] | Loss=0.00585 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=3.036 | 3772.3 samples/s | 58.9 steps/s
[Step=28550 Epoch=139.2] | Loss=0.00549 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.037 | 3788.8 samples/s | 59.2 steps/s
[Step=28600 Epoch=139.5] | Loss=0.00522 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.038 | 4299.4 samples/s | 67.2 steps/s
[Step=28650 Epoch=139.7] | Loss=0.00501 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.039 | 1705.1 samples/s | 26.6 steps/s
[Step=28700 Epoch=140.0] | Loss=0.00494 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.040 | 3749.6 samples/s | 58.6 steps/s
[Step=28750 Epoch=140.2] | Loss=0.00473 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.502 | FP-Norm(final)=3.041 | 3786.0 samples/s | 59.2 steps/s
[Step=28800 Epoch=140.4] | Loss=0.00468 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.041 | 4065.2 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step28800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=137.3] | Loss=0.04316 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.027 | 3878.6 samples/s | 60.6 steps/s
[Step=28050 Epoch=137.6] | Loss=0.01254 | Reg=0.00017 | acc=0.9844 | FP-Norm=0.390 | FP-Norm(final)=3.029 | 3451.7 samples/s | 53.9 steps/s
[Step=28100 Epoch=137.8] | Loss=0.01049 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=3.029 | 3795.8 samples/s | 59.3 steps/s
[Step=28150 Epoch=138.0] | Loss=0.00991 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.458 | FP-Norm(final)=3.030 | 3761.0 samples/s | 58.8 steps/s
[Step=28200 Epoch=138.3] | Loss=0.00901 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.473 | FP-Norm(final)=3.030 | 4892.6 samples/s | 76.4 steps/s
[Step=28250 Epoch=138.5] | Loss=0.00807 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=3.031 | 1546.2 samples/s | 24.2 steps/s
[Step=28300 Epoch=138.8] | Loss=0.00715 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=3.032 | 3665.4 samples/s | 57.3 steps/s
[Step=28350 Epoch=139.0] | Loss=0.00661 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.487 | FP-Norm(final)=3.033 | 3775.4 samples/s | 59.0 steps/s
[Step=28400 Epoch=139.3] | Loss=0.00611 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.488 | FP-Norm(final)=3.034 | 4714.7 samples/s | 73.7 steps/s
[Step=28450 Epoch=139.5] | Loss=0.00566 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=3.036 | 1644.7 samples/s | 25.7 steps/s
[Step=28500 Epoch=139.8] | Loss=0.00537 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.489 | FP-Norm(final)=3.037 | 3801.8 samples/s | 59.4 steps/s
[Step=28550 Epoch=140.0] | Loss=0.00516 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=3.038 | 3773.9 samples/s | 59.0 steps/s
[Step=28600 Epoch=140.2] | Loss=0.00496 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=3.039 | 4521.6 samples/s | 70.6 steps/s
[Step=28650 Epoch=140.5] | Loss=0.00471 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=3.040 | 1673.2 samples/s | 26.1 steps/s
[Step=28700 Epoch=140.7] | Loss=0.00452 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=3.041 | 3761.8 samples/s | 58.8 steps/s
[Step=28750 Epoch=141.0] | Loss=0.00431 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=3.042 | 3764.3 samples/s | 58.8 steps/s
[Step=28800 Epoch=141.2] | Loss=0.00428 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=3.043 | 4356.9 samples/s | 68.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step28800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=265.3] | Loss=0.05505 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.027 | 3512.0 samples/s | 54.9 steps/s
[Step=28050 Epoch=265.8] | Loss=0.00523 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.615 | FP-Norm(final)=3.027 | 3358.0 samples/s | 52.5 steps/s
[Step=28100 Epoch=266.3] | Loss=0.00293 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.641 | FP-Norm(final)=3.027 | 4622.2 samples/s | 72.2 steps/s
[Step=28150 Epoch=266.7] | Loss=0.00197 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.634 | FP-Norm(final)=3.027 | 1557.2 samples/s | 24.3 steps/s
[Step=28200 Epoch=267.2] | Loss=0.00148 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.621 | FP-Norm(final)=3.027 | 4304.2 samples/s | 67.3 steps/s
[Step=28250 Epoch=267.7] | Loss=0.00119 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=3.027 | 1578.8 samples/s | 24.7 steps/s
[Step=28300 Epoch=268.2] | Loss=0.00099 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.597 | FP-Norm(final)=3.027 | 4092.2 samples/s | 63.9 steps/s
[Step=28350 Epoch=268.6] | Loss=0.00085 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.586 | FP-Norm(final)=3.028 | 1610.3 samples/s | 25.2 steps/s
[Step=28400 Epoch=269.1] | Loss=0.00075 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=3.028 | 3814.3 samples/s | 59.6 steps/s
[Step=28450 Epoch=269.6] | Loss=0.00067 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.567 | FP-Norm(final)=3.028 | 1663.0 samples/s | 26.0 steps/s
[Step=28500 Epoch=270.1] | Loss=0.00060 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=3.028 | 3641.5 samples/s | 56.9 steps/s
[Step=28550 Epoch=270.5] | Loss=0.00055 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=3.028 | 1700.3 samples/s | 26.6 steps/s
[Step=28600 Epoch=271.0] | Loss=0.00050 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=3.028 | 3566.4 samples/s | 55.7 steps/s
[Step=28650 Epoch=271.5] | Loss=0.00047 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=3.028 | 1723.6 samples/s | 26.9 steps/s
[Step=28700 Epoch=272.0] | Loss=0.00044 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=3.028 | 3564.9 samples/s | 55.7 steps/s
[Step=28750 Epoch=272.4] | Loss=0.00041 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.523 | FP-Norm(final)=3.028 | 1726.7 samples/s | 27.0 steps/s
[Step=28800 Epoch=272.9] | Loss=0.00038 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=3.028 | 3518.7 samples/s | 55.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step28800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=266.4] | Loss=0.00858 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=3.027 | 3783.6 samples/s | 59.1 steps/s
[Step=28050 Epoch=266.8] | Loss=0.00429 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.602 | FP-Norm(final)=3.030 | 3238.1 samples/s | 50.6 steps/s
[Step=28100 Epoch=267.3] | Loss=0.00216 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.619 | FP-Norm(final)=3.030 | 4703.1 samples/s | 73.5 steps/s
[Step=28150 Epoch=267.8] | Loss=0.00145 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=3.030 | 1558.5 samples/s | 24.4 steps/s
[Step=28200 Epoch=268.3] | Loss=0.00109 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=3.030 | 4325.2 samples/s | 67.6 steps/s
[Step=28250 Epoch=268.7] | Loss=0.00088 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.582 | FP-Norm(final)=3.030 | 1590.9 samples/s | 24.9 steps/s
[Step=28300 Epoch=269.2] | Loss=0.00073 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=3.030 | 4120.2 samples/s | 64.4 steps/s
[Step=28350 Epoch=269.7] | Loss=0.00063 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=3.030 | 1611.2 samples/s | 25.2 steps/s
[Step=28400 Epoch=270.2] | Loss=0.00055 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.550 | FP-Norm(final)=3.030 | 3876.3 samples/s | 60.6 steps/s
[Step=28450 Epoch=270.6] | Loss=0.00049 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=3.030 | 1685.9 samples/s | 26.3 steps/s
[Step=28500 Epoch=271.1] | Loss=0.00045 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=3.030 | 3599.2 samples/s | 56.2 steps/s
[Step=28550 Epoch=271.6] | Loss=0.00041 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=3.030 | 1709.9 samples/s | 26.7 steps/s
[Step=28600 Epoch=272.1] | Loss=0.00037 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=3.030 | 3576.9 samples/s | 55.9 steps/s
[Step=28650 Epoch=272.5] | Loss=0.00035 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.030 | 1724.9 samples/s | 27.0 steps/s
[Step=28700 Epoch=273.0] | Loss=0.00032 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.030 | 3552.8 samples/s | 55.5 steps/s
[Step=28750 Epoch=273.5] | Loss=0.00030 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=3.030 | 1733.4 samples/s | 27.1 steps/s
[Step=28800 Epoch=274.0] | Loss=0.00028 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=3.030 | 3568.9 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step28800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=267.4] | Loss=0.01691 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.027 | 3698.6 samples/s | 57.8 steps/s
[Step=28050 Epoch=267.9] | Loss=0.00676 | Reg=0.00036 | acc=0.9844 | FP-Norm=0.567 | FP-Norm(final)=3.028 | 3186.5 samples/s | 49.8 steps/s
[Step=28100 Epoch=268.3] | Loss=0.00341 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.611 | FP-Norm(final)=3.029 | 4696.0 samples/s | 73.4 steps/s
[Step=28150 Epoch=268.8] | Loss=0.00228 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.610 | FP-Norm(final)=3.029 | 1540.9 samples/s | 24.1 steps/s
[Step=28200 Epoch=269.3] | Loss=0.00172 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.602 | FP-Norm(final)=3.029 | 4452.1 samples/s | 69.6 steps/s
[Step=28250 Epoch=269.8] | Loss=0.00138 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=3.029 | 1561.1 samples/s | 24.4 steps/s
[Step=28300 Epoch=270.2] | Loss=0.00115 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=3.029 | 4207.0 samples/s | 65.7 steps/s
[Step=28350 Epoch=270.7] | Loss=0.00099 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=3.029 | 1606.1 samples/s | 25.1 steps/s
[Step=28400 Epoch=271.2] | Loss=0.00087 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=3.029 | 3993.0 samples/s | 62.4 steps/s
[Step=28450 Epoch=271.7] | Loss=0.00078 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=3.029 | 1631.0 samples/s | 25.5 steps/s
[Step=28500 Epoch=272.2] | Loss=0.00070 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.552 | FP-Norm(final)=3.029 | 3815.3 samples/s | 59.6 steps/s
[Step=28550 Epoch=272.6] | Loss=0.00064 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=3.029 | 1678.4 samples/s | 26.2 steps/s
[Step=28600 Epoch=273.1] | Loss=0.00059 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=3.029 | 3629.6 samples/s | 56.7 steps/s
[Step=28650 Epoch=273.6] | Loss=0.00054 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=3.029 | 1708.4 samples/s | 26.7 steps/s
[Step=28700 Epoch=274.1] | Loss=0.00050 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=3.029 | 3572.9 samples/s | 55.8 steps/s
[Step=28750 Epoch=274.5] | Loss=0.00047 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.522 | FP-Norm(final)=3.029 | 1702.6 samples/s | 26.6 steps/s
[Step=28800 Epoch=275.0] | Loss=0.00044 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=3.029 | 3608.5 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step28800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=263.8] | Loss=0.01302 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.027 | 3468.6 samples/s | 54.2 steps/s
[Step=28050 Epoch=264.3] | Loss=0.00521 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=3.028 | 3384.3 samples/s | 52.9 steps/s
[Step=28100 Epoch=264.8] | Loss=0.00277 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=3.028 | 4595.1 samples/s | 71.8 steps/s
[Step=28150 Epoch=265.3] | Loss=0.00186 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.613 | FP-Norm(final)=3.028 | 1558.3 samples/s | 24.3 steps/s
[Step=28200 Epoch=265.7] | Loss=0.00140 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.607 | FP-Norm(final)=3.028 | 4265.8 samples/s | 66.7 steps/s
[Step=28250 Epoch=266.2] | Loss=0.00112 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.598 | FP-Norm(final)=3.028 | 1591.2 samples/s | 24.9 steps/s
[Step=28300 Epoch=266.7] | Loss=0.00094 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.590 | FP-Norm(final)=3.028 | 3964.8 samples/s | 62.0 steps/s
[Step=28350 Epoch=267.1] | Loss=0.00080 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=3.028 | 1646.2 samples/s | 25.7 steps/s
[Step=28400 Epoch=267.6] | Loss=0.00071 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=3.028 | 3721.7 samples/s | 58.2 steps/s
[Step=28450 Epoch=268.1] | Loss=0.00063 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=3.028 | 1684.7 samples/s | 26.3 steps/s
[Step=28500 Epoch=268.6] | Loss=0.00057 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=3.028 | 3554.2 samples/s | 55.5 steps/s
[Step=28550 Epoch=269.0] | Loss=0.00052 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=3.029 | 1706.9 samples/s | 26.7 steps/s
[Step=28600 Epoch=269.5] | Loss=0.00048 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=3.029 | 3610.4 samples/s | 56.4 steps/s
[Step=28650 Epoch=270.0] | Loss=0.00044 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=3.029 | 1741.5 samples/s | 27.2 steps/s
[Step=28700 Epoch=270.4] | Loss=0.00041 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=3.029 | 3540.4 samples/s | 55.3 steps/s
[Step=28750 Epoch=270.9] | Loss=0.00038 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=3.029 | 1797.9 samples/s | 28.1 steps/s
[Step=28800 Epoch=271.4] | Loss=0.00036 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.522 | FP-Norm(final)=3.029 | 3295.7 samples/s | 51.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step28800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=266.9] | Loss=0.09143 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.027 | 3635.6 samples/s | 56.8 steps/s
[Step=28050 Epoch=267.3] | Loss=0.00560 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.612 | FP-Norm(final)=3.027 | 3268.6 samples/s | 51.1 steps/s
[Step=28100 Epoch=267.8] | Loss=0.00285 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.637 | FP-Norm(final)=3.027 | 4700.3 samples/s | 73.4 steps/s
[Step=28150 Epoch=268.3] | Loss=0.00191 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.630 | FP-Norm(final)=3.027 | 1548.6 samples/s | 24.2 steps/s
[Step=28200 Epoch=268.8] | Loss=0.00144 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.618 | FP-Norm(final)=3.027 | 4382.6 samples/s | 68.5 steps/s
[Step=28250 Epoch=269.2] | Loss=0.00116 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.605 | FP-Norm(final)=3.027 | 1572.9 samples/s | 24.6 steps/s
[Step=28300 Epoch=269.7] | Loss=0.00097 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.593 | FP-Norm(final)=3.027 | 4122.9 samples/s | 64.4 steps/s
[Step=28350 Epoch=270.2] | Loss=0.00083 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.582 | FP-Norm(final)=3.027 | 1604.9 samples/s | 25.1 steps/s
[Step=28400 Epoch=270.7] | Loss=0.00073 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.573 | FP-Norm(final)=3.027 | 3964.7 samples/s | 61.9 steps/s
[Step=28450 Epoch=271.2] | Loss=0.00065 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.564 | FP-Norm(final)=3.027 | 1628.6 samples/s | 25.4 steps/s
[Step=28500 Epoch=271.6] | Loss=0.00059 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=3.028 | 3787.3 samples/s | 59.2 steps/s
[Step=28550 Epoch=272.1] | Loss=0.00054 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=3.028 | 1671.6 samples/s | 26.1 steps/s
[Step=28600 Epoch=272.6] | Loss=0.00049 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=3.028 | 3630.8 samples/s | 56.7 steps/s
[Step=28650 Epoch=273.1] | Loss=0.00046 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=3.028 | 1703.6 samples/s | 26.6 steps/s
[Step=28700 Epoch=273.5] | Loss=0.00042 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=3.028 | 3587.3 samples/s | 56.1 steps/s
[Step=28750 Epoch=274.0] | Loss=0.00040 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.521 | FP-Norm(final)=3.028 | 1701.3 samples/s | 26.6 steps/s
[Step=28800 Epoch=274.5] | Loss=0.00037 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=3.028 | 3586.0 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19929 | acc=0.8950 | tpr=0.8553 | fpr=0.0188 | 3637.5 samples/s | 14.2 steps/s
Avg test loss: 0.20184, Avg test acc: 0.89466, Avg tpr: 0.85598, Avg fpr: 0.02025, total FA: 158

Testing server on iccad2012
[Step=  50] | Loss=0.53570 | acc=0.8563 | tpr=0.9690 | fpr=0.1457 | 3657.4 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.55760 | acc=0.8536 | tpr=0.9744 | fpr=0.1487 | 6744.7 samples/s | 26.3 steps/s
[Step= 150] | Loss=0.57011 | acc=0.8505 | tpr=0.9712 | fpr=0.1517 | 6933.8 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.57040 | acc=0.8512 | tpr=0.9749 | fpr=0.1511 | 6878.2 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.56763 | acc=0.8510 | tpr=0.9694 | fpr=0.1512 | 6757.3 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.57226 | acc=0.8510 | tpr=0.9687 | fpr=0.1511 | 6898.5 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.57297 | acc=0.8513 | tpr=0.9693 | fpr=0.1508 | 6856.1 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.57358 | acc=0.8511 | tpr=0.9699 | fpr=0.1511 | 6844.8 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.57815 | acc=0.8509 | tpr=0.9698 | fpr=0.1513 | 6787.5 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.57858 | acc=0.8506 | tpr=0.9700 | fpr=0.1516 | 6769.4 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.57798 | acc=0.8506 | tpr=0.9702 | fpr=0.1516 | 12697.9 samples/s | 49.6 steps/s
Avg test loss: 0.57789, Avg test acc: 0.85064, Avg tpr: 0.97029, Avg fpr: 0.15153, total FA: 21040

server round 36/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.4] | Loss=0.06781 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.042 | 3749.8 samples/s | 58.6 steps/s
[Step=28850 Epoch=140.7] | Loss=0.01978 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.040 | 3556.7 samples/s | 55.6 steps/s
[Step=28900 Epoch=140.9] | Loss=0.01381 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=3.040 | 3777.7 samples/s | 59.0 steps/s
[Step=28950 Epoch=141.2] | Loss=0.01149 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.460 | FP-Norm(final)=3.041 | 3772.3 samples/s | 58.9 steps/s
[Step=29000 Epoch=141.4] | Loss=0.01009 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.474 | FP-Norm(final)=3.042 | 4838.3 samples/s | 75.6 steps/s
[Step=29050 Epoch=141.7] | Loss=0.00869 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.482 | FP-Norm(final)=3.043 | 1636.6 samples/s | 25.6 steps/s
[Step=29100 Epoch=141.9] | Loss=0.00787 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.486 | FP-Norm(final)=3.044 | 3807.4 samples/s | 59.5 steps/s
[Step=29150 Epoch=142.1] | Loss=0.00737 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.488 | FP-Norm(final)=3.046 | 3800.0 samples/s | 59.4 steps/s
[Step=29200 Epoch=142.4] | Loss=0.00710 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.489 | FP-Norm(final)=3.047 | 4550.5 samples/s | 71.1 steps/s
[Step=29250 Epoch=142.6] | Loss=0.00664 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=3.047 | 1662.5 samples/s | 26.0 steps/s
[Step=29300 Epoch=142.9] | Loss=0.00640 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=3.048 | 3766.9 samples/s | 58.9 steps/s
[Step=29350 Epoch=143.1] | Loss=0.00616 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=3.049 | 3784.5 samples/s | 59.1 steps/s
[Step=29400 Epoch=143.4] | Loss=0.00591 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=3.050 | 4289.3 samples/s | 67.0 steps/s
[Step=29450 Epoch=143.6] | Loss=0.00572 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=3.051 | 1699.1 samples/s | 26.5 steps/s
[Step=29500 Epoch=143.8] | Loss=0.00553 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=3.052 | 3788.4 samples/s | 59.2 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00533 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=3.052 | 3785.3 samples/s | 59.1 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00521 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=3.053 | 4087.6 samples/s | 63.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step29600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.5] | Loss=0.13239 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.042 | 3712.7 samples/s | 58.0 steps/s
[Step=28850 Epoch=140.8] | Loss=0.01941 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.496 | FP-Norm(final)=3.041 | 3560.2 samples/s | 55.6 steps/s
[Step=28900 Epoch=141.0] | Loss=0.01271 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=3.041 | 3776.5 samples/s | 59.0 steps/s
[Step=28950 Epoch=141.3] | Loss=0.01057 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.532 | FP-Norm(final)=3.042 | 3790.6 samples/s | 59.2 steps/s
[Step=29000 Epoch=141.5] | Loss=0.00995 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.536 | FP-Norm(final)=3.044 | 4894.3 samples/s | 76.5 steps/s
[Step=29050 Epoch=141.8] | Loss=0.00868 | Reg=0.00029 | acc=0.9844 | FP-Norm=0.537 | FP-Norm(final)=3.044 | 1612.1 samples/s | 25.2 steps/s
[Step=29100 Epoch=142.0] | Loss=0.00789 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=3.045 | 3769.3 samples/s | 58.9 steps/s
[Step=29150 Epoch=142.2] | Loss=0.00754 | Reg=0.00029 | acc=0.9688 | FP-Norm=0.532 | FP-Norm(final)=3.046 | 3790.5 samples/s | 59.2 steps/s
[Step=29200 Epoch=142.5] | Loss=0.00690 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=3.047 | 4606.1 samples/s | 72.0 steps/s
[Step=29250 Epoch=142.7] | Loss=0.00651 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=3.047 | 1649.0 samples/s | 25.8 steps/s
[Step=29300 Epoch=143.0] | Loss=0.00605 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=3.048 | 3791.0 samples/s | 59.2 steps/s
[Step=29350 Epoch=143.2] | Loss=0.00590 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.521 | FP-Norm(final)=3.049 | 3743.0 samples/s | 58.5 steps/s
[Step=29400 Epoch=143.5] | Loss=0.00566 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=3.050 | 4409.2 samples/s | 68.9 steps/s
[Step=29450 Epoch=143.7] | Loss=0.00554 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=3.050 | 1676.5 samples/s | 26.2 steps/s
[Step=29500 Epoch=143.9] | Loss=0.00542 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=3.051 | 3785.0 samples/s | 59.1 steps/s
[Step=29550 Epoch=144.2] | Loss=0.00523 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=3.051 | 3794.2 samples/s | 59.3 steps/s
[Step=29600 Epoch=144.4] | Loss=0.00508 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=3.052 | 4191.2 samples/s | 65.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step29600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.3] | Loss=0.07413 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.042 | 3776.2 samples/s | 59.0 steps/s
[Step=28850 Epoch=140.6] | Loss=0.01673 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=3.042 | 3522.0 samples/s | 55.0 steps/s
[Step=28900 Epoch=140.8] | Loss=0.01254 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.467 | FP-Norm(final)=3.042 | 3772.8 samples/s | 59.0 steps/s
[Step=28950 Epoch=141.1] | Loss=0.01121 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.487 | FP-Norm(final)=3.043 | 3785.8 samples/s | 59.2 steps/s
[Step=29000 Epoch=141.3] | Loss=0.01022 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.044 | 4758.4 samples/s | 74.3 steps/s
[Step=29050 Epoch=141.5] | Loss=0.00897 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=3.045 | 1606.3 samples/s | 25.1 steps/s
[Step=29100 Epoch=141.8] | Loss=0.00814 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.046 | 3768.2 samples/s | 58.9 steps/s
[Step=29150 Epoch=142.0] | Loss=0.00746 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.048 | 3753.9 samples/s | 58.7 steps/s
[Step=29200 Epoch=142.3] | Loss=0.00686 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=3.049 | 4550.3 samples/s | 71.1 steps/s
[Step=29250 Epoch=142.5] | Loss=0.00635 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.050 | 1658.6 samples/s | 25.9 steps/s
[Step=29300 Epoch=142.8] | Loss=0.00595 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=3.051 | 3782.1 samples/s | 59.1 steps/s
[Step=29350 Epoch=143.0] | Loss=0.00560 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=3.053 | 3745.7 samples/s | 58.5 steps/s
[Step=29400 Epoch=143.3] | Loss=0.00544 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.054 | 4306.1 samples/s | 67.3 steps/s
[Step=29450 Epoch=143.5] | Loss=0.00525 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.055 | 1697.8 samples/s | 26.5 steps/s
[Step=29500 Epoch=143.7] | Loss=0.00514 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=3.056 | 3791.5 samples/s | 59.2 steps/s
[Step=29550 Epoch=144.0] | Loss=0.00495 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.057 | 3759.6 samples/s | 58.7 steps/s
[Step=29600 Epoch=144.2] | Loss=0.00479 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.058 | 4072.5 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step29600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.4] | Loss=0.18636 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.042 | 3579.4 samples/s | 55.9 steps/s
[Step=28850 Epoch=140.7] | Loss=0.01909 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=3.039 | 3719.1 samples/s | 58.1 steps/s
[Step=28900 Epoch=140.9] | Loss=0.01269 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=3.039 | 3790.6 samples/s | 59.2 steps/s
[Step=28950 Epoch=141.2] | Loss=0.01086 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.040 | 3757.5 samples/s | 58.7 steps/s
[Step=29000 Epoch=141.4] | Loss=0.00909 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=3.041 | 4854.7 samples/s | 75.9 steps/s
[Step=29050 Epoch=141.7] | Loss=0.00784 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.042 | 1627.7 samples/s | 25.4 steps/s
[Step=29100 Epoch=141.9] | Loss=0.00707 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.043 | 3826.3 samples/s | 59.8 steps/s
[Step=29150 Epoch=142.2] | Loss=0.00664 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.045 | 3769.7 samples/s | 58.9 steps/s
[Step=29200 Epoch=142.4] | Loss=0.00614 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=3.046 | 4566.4 samples/s | 71.3 steps/s
[Step=29250 Epoch=142.6] | Loss=0.00575 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=3.047 | 1671.9 samples/s | 26.1 steps/s
[Step=29300 Epoch=142.9] | Loss=0.00545 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.048 | 3776.2 samples/s | 59.0 steps/s
[Step=29350 Epoch=143.1] | Loss=0.00518 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.505 | FP-Norm(final)=3.049 | 3812.1 samples/s | 59.6 steps/s
[Step=29400 Epoch=143.4] | Loss=0.00504 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.050 | 4281.0 samples/s | 66.9 steps/s
[Step=29450 Epoch=143.6] | Loss=0.00476 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.051 | 1695.8 samples/s | 26.5 steps/s
[Step=29500 Epoch=143.9] | Loss=0.00455 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=3.052 | 3769.7 samples/s | 58.9 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00432 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=3.054 | 3800.5 samples/s | 59.4 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00435 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.497 | FP-Norm(final)=3.055 | 4071.6 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step29600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=141.2] | Loss=0.03587 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.042 | 3546.6 samples/s | 55.4 steps/s
[Step=28850 Epoch=141.5] | Loss=0.01668 | Reg=0.00019 | acc=0.9844 | FP-Norm=0.416 | FP-Norm(final)=3.043 | 3733.2 samples/s | 58.3 steps/s
[Step=28900 Epoch=141.7] | Loss=0.01212 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=3.043 | 3781.7 samples/s | 59.1 steps/s
[Step=28950 Epoch=142.0] | Loss=0.01033 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.478 | FP-Norm(final)=3.044 | 3815.8 samples/s | 59.6 steps/s
[Step=29000 Epoch=142.2] | Loss=0.00903 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.484 | FP-Norm(final)=3.045 | 4901.7 samples/s | 76.6 steps/s
[Step=29050 Epoch=142.5] | Loss=0.00821 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.487 | FP-Norm(final)=3.046 | 1618.0 samples/s | 25.3 steps/s
[Step=29100 Epoch=142.7] | Loss=0.00741 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.487 | FP-Norm(final)=3.047 | 3789.9 samples/s | 59.2 steps/s
[Step=29150 Epoch=142.9] | Loss=0.00676 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.487 | FP-Norm(final)=3.048 | 3801.1 samples/s | 59.4 steps/s
[Step=29200 Epoch=143.2] | Loss=0.00623 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=3.049 | 4715.7 samples/s | 73.7 steps/s
[Step=29250 Epoch=143.4] | Loss=0.00584 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=3.050 | 1638.5 samples/s | 25.6 steps/s
[Step=29300 Epoch=143.7] | Loss=0.00551 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.484 | FP-Norm(final)=3.051 | 3785.9 samples/s | 59.2 steps/s
[Step=29350 Epoch=143.9] | Loss=0.00521 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.484 | FP-Norm(final)=3.052 | 3831.9 samples/s | 59.9 steps/s
[Step=29400 Epoch=144.2] | Loss=0.00508 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.483 | FP-Norm(final)=3.053 | 4506.7 samples/s | 70.4 steps/s
[Step=29450 Epoch=144.4] | Loss=0.00480 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.482 | FP-Norm(final)=3.054 | 1664.1 samples/s | 26.0 steps/s
[Step=29500 Epoch=144.7] | Loss=0.00459 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=3.055 | 3759.4 samples/s | 58.7 steps/s
[Step=29550 Epoch=144.9] | Loss=0.00446 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.480 | FP-Norm(final)=3.056 | 3768.5 samples/s | 58.9 steps/s
[Step=29600 Epoch=145.2] | Loss=0.00434 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.480 | FP-Norm(final)=3.057 | 4342.7 samples/s | 67.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step29600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=272.9] | Loss=0.09803 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.042 | 3599.3 samples/s | 56.2 steps/s
[Step=28850 Epoch=273.4] | Loss=0.00525 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=3.040 | 3310.1 samples/s | 51.7 steps/s
[Step=28900 Epoch=273.9] | Loss=0.00276 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=3.039 | 4642.7 samples/s | 72.5 steps/s
[Step=28950 Epoch=274.3] | Loss=0.00185 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.532 | FP-Norm(final)=3.040 | 1532.7 samples/s | 23.9 steps/s
[Step=29000 Epoch=274.8] | Loss=0.00140 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=3.040 | 4332.9 samples/s | 67.7 steps/s
[Step=29050 Epoch=275.3] | Loss=0.00112 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.520 | FP-Norm(final)=3.040 | 1581.9 samples/s | 24.7 steps/s
[Step=29100 Epoch=275.7] | Loss=0.00094 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=3.040 | 4043.0 samples/s | 63.2 steps/s
[Step=29150 Epoch=276.2] | Loss=0.00081 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.041 | 1628.1 samples/s | 25.4 steps/s
[Step=29200 Epoch=276.7] | Loss=0.00071 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=3.041 | 3832.0 samples/s | 59.9 steps/s
[Step=29250 Epoch=277.2] | Loss=0.00063 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.492 | FP-Norm(final)=3.041 | 1659.1 samples/s | 25.9 steps/s
[Step=29300 Epoch=277.6] | Loss=0.00057 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=3.041 | 3601.9 samples/s | 56.3 steps/s
[Step=29350 Epoch=278.1] | Loss=0.00052 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=3.041 | 1723.6 samples/s | 26.9 steps/s
[Step=29400 Epoch=278.6] | Loss=0.00048 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.475 | FP-Norm(final)=3.041 | 3606.2 samples/s | 56.3 steps/s
[Step=29450 Epoch=279.1] | Loss=0.00044 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.470 | FP-Norm(final)=3.042 | 1716.2 samples/s | 26.8 steps/s
[Step=29500 Epoch=279.5] | Loss=0.00041 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=3.042 | 3539.3 samples/s | 55.3 steps/s
[Step=29550 Epoch=280.0] | Loss=0.00039 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.460 | FP-Norm(final)=3.042 | 1726.4 samples/s | 27.0 steps/s
[Step=29600 Epoch=280.5] | Loss=0.00036 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=3.042 | 3527.0 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step29600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=274.0] | Loss=0.03508 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.042 | 3737.8 samples/s | 58.4 steps/s
[Step=28850 Epoch=274.4] | Loss=0.00400 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=3.043 | 3310.7 samples/s | 51.7 steps/s
[Step=28900 Epoch=274.9] | Loss=0.00218 | Reg=0.00035 | acc=0.9844 | FP-Norm=0.580 | FP-Norm(final)=3.043 | 4665.5 samples/s | 72.9 steps/s
[Step=28950 Epoch=275.4] | Loss=0.00146 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.590 | FP-Norm(final)=3.044 | 1540.6 samples/s | 24.1 steps/s
[Step=29000 Epoch=275.9] | Loss=0.00110 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=3.044 | 4349.1 samples/s | 68.0 steps/s
[Step=29050 Epoch=276.3] | Loss=0.00088 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=3.044 | 1596.7 samples/s | 24.9 steps/s
[Step=29100 Epoch=276.8] | Loss=0.00074 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=3.044 | 4050.9 samples/s | 63.3 steps/s
[Step=29150 Epoch=277.3] | Loss=0.00064 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=3.045 | 1604.1 samples/s | 25.1 steps/s
[Step=29200 Epoch=277.8] | Loss=0.00056 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.553 | FP-Norm(final)=3.045 | 3854.5 samples/s | 60.2 steps/s
[Step=29250 Epoch=278.2] | Loss=0.00050 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.545 | FP-Norm(final)=3.045 | 1662.5 samples/s | 26.0 steps/s
[Step=29300 Epoch=278.7] | Loss=0.00045 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=3.045 | 3643.8 samples/s | 56.9 steps/s
[Step=29350 Epoch=279.2] | Loss=0.00041 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=3.045 | 1676.2 samples/s | 26.2 steps/s
[Step=29400 Epoch=279.7] | Loss=0.00038 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=3.045 | 3557.8 samples/s | 55.6 steps/s
[Step=29450 Epoch=280.1] | Loss=0.00035 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=3.045 | 1727.4 samples/s | 27.0 steps/s
[Step=29500 Epoch=280.6] | Loss=0.00032 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=3.045 | 3450.5 samples/s | 53.9 steps/s
[Step=29550 Epoch=281.1] | Loss=0.00030 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.045 | 1718.9 samples/s | 26.9 steps/s
[Step=29600 Epoch=281.6] | Loss=0.00028 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.045 | 3538.8 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step29600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=275.0] | Loss=0.09275 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.042 | 3562.9 samples/s | 55.7 steps/s
[Step=28850 Epoch=275.5] | Loss=0.00537 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.520 | FP-Norm(final)=3.043 | 3307.5 samples/s | 51.7 steps/s
[Step=28900 Epoch=276.0] | Loss=0.00275 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.549 | FP-Norm(final)=3.043 | 4690.5 samples/s | 73.3 steps/s
[Step=28950 Epoch=276.5] | Loss=0.00184 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=3.044 | 1518.5 samples/s | 23.7 steps/s
[Step=29000 Epoch=276.9] | Loss=0.00141 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=3.044 | 4418.4 samples/s | 69.0 steps/s
[Step=29050 Epoch=277.4] | Loss=0.00113 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.535 | FP-Norm(final)=3.044 | 1570.8 samples/s | 24.5 steps/s
[Step=29100 Epoch=277.9] | Loss=0.00094 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=3.044 | 4133.1 samples/s | 64.6 steps/s
[Step=29150 Epoch=278.4] | Loss=0.00081 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=3.045 | 1593.8 samples/s | 24.9 steps/s
[Step=29200 Epoch=278.8] | Loss=0.00071 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.045 | 3958.5 samples/s | 61.9 steps/s
[Step=29250 Epoch=279.3] | Loss=0.00063 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.045 | 1635.7 samples/s | 25.6 steps/s
[Step=29300 Epoch=279.8] | Loss=0.00057 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=3.045 | 3808.3 samples/s | 59.5 steps/s
[Step=29350 Epoch=280.3] | Loss=0.00052 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=3.045 | 1182.3 samples/s | 18.5 steps/s
[Step=29400 Epoch=280.8] | Loss=0.00048 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=3.045 | 3507.1 samples/s | 54.8 steps/s
[Step=29450 Epoch=281.2] | Loss=0.00044 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.480 | FP-Norm(final)=3.045 | 1670.9 samples/s | 26.1 steps/s
[Step=29500 Epoch=281.7] | Loss=0.00041 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.475 | FP-Norm(final)=3.045 | 3608.5 samples/s | 56.4 steps/s
[Step=29550 Epoch=282.2] | Loss=0.00039 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.470 | FP-Norm(final)=3.045 | 1726.5 samples/s | 27.0 steps/s
[Step=29600 Epoch=282.7] | Loss=0.00036 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=3.045 | 3593.3 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step29600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=271.4] | Loss=0.00118 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=3.042 | 3657.0 samples/s | 57.1 steps/s
[Step=28850 Epoch=271.8] | Loss=0.00470 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=3.042 | 3285.6 samples/s | 51.3 steps/s
[Step=28900 Epoch=272.3] | Loss=0.00239 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=3.042 | 4630.9 samples/s | 72.4 steps/s
[Step=28950 Epoch=272.8] | Loss=0.00173 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.580 | FP-Norm(final)=3.042 | 1550.6 samples/s | 24.2 steps/s
[Step=29000 Epoch=273.3] | Loss=0.00131 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=3.042 | 4243.8 samples/s | 66.3 steps/s
[Step=29050 Epoch=273.7] | Loss=0.00105 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=3.042 | 1614.5 samples/s | 25.2 steps/s
[Step=29100 Epoch=274.2] | Loss=0.00088 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.564 | FP-Norm(final)=3.043 | 3953.0 samples/s | 61.8 steps/s
[Step=29150 Epoch=274.7] | Loss=0.00076 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=3.043 | 1635.0 samples/s | 25.5 steps/s
[Step=29200 Epoch=275.1] | Loss=0.00066 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=3.043 | 3674.2 samples/s | 57.4 steps/s
[Step=29250 Epoch=275.6] | Loss=0.00059 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=3.043 | 1689.6 samples/s | 26.4 steps/s
[Step=29300 Epoch=276.1] | Loss=0.00053 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=3.043 | 3600.2 samples/s | 56.3 steps/s
[Step=29350 Epoch=276.6] | Loss=0.00049 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=3.043 | 1707.6 samples/s | 26.7 steps/s
[Step=29400 Epoch=277.0] | Loss=0.00045 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=3.043 | 3615.2 samples/s | 56.5 steps/s
[Step=29450 Epoch=277.5] | Loss=0.00041 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=3.043 | 1720.1 samples/s | 26.9 steps/s
[Step=29500 Epoch=278.0] | Loss=0.00039 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.043 | 3538.6 samples/s | 55.3 steps/s
[Step=29550 Epoch=278.4] | Loss=0.00036 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=3.043 | 1790.3 samples/s | 28.0 steps/s
[Step=29600 Epoch=278.9] | Loss=0.00034 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=3.043 | 3336.2 samples/s | 52.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step29600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=274.5] | Loss=0.06418 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.042 | 3632.6 samples/s | 56.8 steps/s
[Step=28850 Epoch=275.0] | Loss=0.00428 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=3.042 | 3258.3 samples/s | 50.9 steps/s
[Step=28900 Epoch=275.4] | Loss=0.00221 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=3.043 | 4665.4 samples/s | 72.9 steps/s
[Step=28950 Epoch=275.9] | Loss=0.00149 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.548 | FP-Norm(final)=3.043 | 1534.3 samples/s | 24.0 steps/s
[Step=29000 Epoch=276.4] | Loss=0.00112 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=3.043 | 4422.0 samples/s | 69.1 steps/s
[Step=29050 Epoch=276.9] | Loss=0.00090 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=3.044 | 1573.4 samples/s | 24.6 steps/s
[Step=29100 Epoch=277.3] | Loss=0.00076 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=3.044 | 4193.6 samples/s | 65.5 steps/s
[Step=29150 Epoch=277.8] | Loss=0.00065 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.044 | 1603.7 samples/s | 25.1 steps/s
[Step=29200 Epoch=278.3] | Loss=0.00057 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=3.044 | 4007.1 samples/s | 62.6 steps/s
[Step=29250 Epoch=278.8] | Loss=0.00051 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=3.044 | 1637.7 samples/s | 25.6 steps/s
[Step=29300 Epoch=279.3] | Loss=0.00046 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.478 | FP-Norm(final)=3.044 | 3785.3 samples/s | 59.1 steps/s
[Step=29350 Epoch=279.7] | Loss=0.00042 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=3.044 | 1659.6 samples/s | 25.9 steps/s
[Step=29400 Epoch=280.2] | Loss=0.00039 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=3.045 | 3627.5 samples/s | 56.7 steps/s
[Step=29450 Epoch=280.7] | Loss=0.00036 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.458 | FP-Norm(final)=3.045 | 1733.2 samples/s | 27.1 steps/s
[Step=29500 Epoch=281.2] | Loss=0.00033 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=3.045 | 3559.0 samples/s | 55.6 steps/s
[Step=29550 Epoch=281.6] | Loss=0.00031 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.447 | FP-Norm(final)=3.045 | 1713.0 samples/s | 26.8 steps/s
[Step=29600 Epoch=282.1] | Loss=0.00029 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=3.045 | 3615.4 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19419 | acc=0.9002 | tpr=0.8633 | fpr=0.0198 | 3632.0 samples/s | 14.2 steps/s
Avg test loss: 0.19689, Avg test acc: 0.89891, Avg tpr: 0.86245, Avg fpr: 0.02089, total FA: 163

Testing server on iccad2012
[Step=  50] | Loss=0.55137 | acc=0.8516 | tpr=0.9690 | fpr=0.1505 | 3671.1 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.57308 | acc=0.8495 | tpr=0.9744 | fpr=0.1529 | 6783.0 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.58617 | acc=0.8463 | tpr=0.9712 | fpr=0.1560 | 6706.4 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.58633 | acc=0.8473 | tpr=0.9738 | fpr=0.1550 | 7005.4 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.58379 | acc=0.8469 | tpr=0.9686 | fpr=0.1553 | 6773.7 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.58855 | acc=0.8468 | tpr=0.9673 | fpr=0.1554 | 6854.5 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.58896 | acc=0.8472 | tpr=0.9681 | fpr=0.1550 | 6978.2 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.58954 | acc=0.8470 | tpr=0.9688 | fpr=0.1552 | 6628.7 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.59399 | acc=0.8469 | tpr=0.9684 | fpr=0.1553 | 6810.1 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.59433 | acc=0.8466 | tpr=0.9687 | fpr=0.1556 | 6875.6 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.59367 | acc=0.8468 | tpr=0.9690 | fpr=0.1555 | 12790.3 samples/s | 50.0 steps/s
Avg test loss: 0.59359, Avg test acc: 0.84680, Avg tpr: 0.96910, Avg fpr: 0.15542, total FA: 21580

server round 37/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.3] | Loss=0.17247 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.056 | 3693.4 samples/s | 57.7 steps/s
[Step=29650 Epoch=144.6] | Loss=0.02076 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=3.054 | 3703.0 samples/s | 57.9 steps/s
[Step=29700 Epoch=144.8] | Loss=0.01484 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.053 | 3744.0 samples/s | 58.5 steps/s
[Step=29750 Epoch=145.1] | Loss=0.01191 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=3.054 | 3759.6 samples/s | 58.7 steps/s
[Step=29800 Epoch=145.3] | Loss=0.01038 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.516 | FP-Norm(final)=3.055 | 4849.3 samples/s | 75.8 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00905 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=3.056 | 1618.5 samples/s | 25.3 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00805 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=3.057 | 3747.7 samples/s | 58.6 steps/s
[Step=29950 Epoch=146.0] | Loss=0.00751 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=3.058 | 3796.8 samples/s | 59.3 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00714 | Reg=0.00026 | acc=0.9688 | FP-Norm=0.508 | FP-Norm(final)=3.059 | 4498.7 samples/s | 70.3 steps/s
[Step=30050 Epoch=146.5] | Loss=0.00667 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.060 | 1666.4 samples/s | 26.0 steps/s
[Step=30100 Epoch=146.8] | Loss=0.00624 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.061 | 3745.7 samples/s | 58.5 steps/s
[Step=30150 Epoch=147.0] | Loss=0.00602 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.503 | FP-Norm(final)=3.062 | 3783.0 samples/s | 59.1 steps/s
[Step=30200 Epoch=147.3] | Loss=0.00586 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.501 | FP-Norm(final)=3.063 | 4291.4 samples/s | 67.1 steps/s
[Step=30250 Epoch=147.5] | Loss=0.00561 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=3.064 | 1700.3 samples/s | 26.6 steps/s
[Step=30300 Epoch=147.7] | Loss=0.00551 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=3.064 | 3770.3 samples/s | 58.9 steps/s
[Step=30350 Epoch=148.0] | Loss=0.00534 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=3.065 | 3767.4 samples/s | 58.9 steps/s
[Step=30400 Epoch=148.2] | Loss=0.00522 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=3.066 | 4075.1 samples/s | 63.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step30400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.4] | Loss=0.13121 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.056 | 3862.0 samples/s | 60.3 steps/s
[Step=29650 Epoch=144.7] | Loss=0.01748 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.056 | 3559.5 samples/s | 55.6 steps/s
[Step=29700 Epoch=144.9] | Loss=0.01280 | Reg=0.00022 | acc=0.9844 | FP-Norm=0.454 | FP-Norm(final)=3.056 | 3802.4 samples/s | 59.4 steps/s
[Step=29750 Epoch=145.2] | Loss=0.01093 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.480 | FP-Norm(final)=3.056 | 3730.1 samples/s | 58.3 steps/s
[Step=29800 Epoch=145.4] | Loss=0.01019 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.492 | FP-Norm(final)=3.057 | 4839.9 samples/s | 75.6 steps/s
[Step=29850 Epoch=145.7] | Loss=0.00900 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.057 | 1618.6 samples/s | 25.3 steps/s
[Step=29900 Epoch=145.9] | Loss=0.00809 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.059 | 3796.6 samples/s | 59.3 steps/s
[Step=29950 Epoch=146.1] | Loss=0.00736 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.060 | 3763.7 samples/s | 58.8 steps/s
[Step=30000 Epoch=146.4] | Loss=0.00708 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.061 | 4619.8 samples/s | 72.2 steps/s
[Step=30050 Epoch=146.6] | Loss=0.00667 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.062 | 1648.0 samples/s | 25.7 steps/s
[Step=30100 Epoch=146.9] | Loss=0.00633 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.062 | 3769.4 samples/s | 58.9 steps/s
[Step=30150 Epoch=147.1] | Loss=0.00605 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.063 | 3756.4 samples/s | 58.7 steps/s
[Step=30200 Epoch=147.4] | Loss=0.00586 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.064 | 4391.6 samples/s | 68.6 steps/s
[Step=30250 Epoch=147.6] | Loss=0.00567 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.065 | 1658.5 samples/s | 25.9 steps/s
[Step=30300 Epoch=147.8] | Loss=0.00546 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.065 | 3810.2 samples/s | 59.5 steps/s
[Step=30350 Epoch=148.1] | Loss=0.00522 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.066 | 3753.3 samples/s | 58.6 steps/s
[Step=30400 Epoch=148.3] | Loss=0.00521 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.067 | 4209.0 samples/s | 65.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step30400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.2] | Loss=0.06548 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.056 | 3672.3 samples/s | 57.4 steps/s
[Step=29650 Epoch=144.5] | Loss=0.01834 | Reg=0.00020 | acc=0.9844 | FP-Norm=0.421 | FP-Norm(final)=3.056 | 3652.9 samples/s | 57.1 steps/s
[Step=29700 Epoch=144.7] | Loss=0.01434 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.468 | FP-Norm(final)=3.057 | 3772.5 samples/s | 58.9 steps/s
[Step=29750 Epoch=145.0] | Loss=0.01175 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.486 | FP-Norm(final)=3.057 | 3782.9 samples/s | 59.1 steps/s
[Step=29800 Epoch=145.2] | Loss=0.01015 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=3.057 | 4823.5 samples/s | 75.4 steps/s
[Step=29850 Epoch=145.4] | Loss=0.00949 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.498 | FP-Norm(final)=3.058 | 1612.0 samples/s | 25.2 steps/s
[Step=29900 Epoch=145.7] | Loss=0.00852 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.500 | FP-Norm(final)=3.059 | 3766.3 samples/s | 58.8 steps/s
[Step=29950 Epoch=145.9] | Loss=0.00775 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.060 | 3777.3 samples/s | 59.0 steps/s
[Step=30000 Epoch=146.2] | Loss=0.00715 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.061 | 4520.1 samples/s | 70.6 steps/s
[Step=30050 Epoch=146.4] | Loss=0.00668 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=3.062 | 1676.6 samples/s | 26.2 steps/s
[Step=30100 Epoch=146.7] | Loss=0.00622 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=3.063 | 3773.6 samples/s | 59.0 steps/s
[Step=30150 Epoch=146.9] | Loss=0.00590 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=3.065 | 3773.2 samples/s | 59.0 steps/s
[Step=30200 Epoch=147.1] | Loss=0.00558 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=3.066 | 4262.4 samples/s | 66.6 steps/s
[Step=30250 Epoch=147.4] | Loss=0.00536 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=3.067 | 1706.1 samples/s | 26.7 steps/s
[Step=30300 Epoch=147.6] | Loss=0.00508 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=3.068 | 3763.8 samples/s | 58.8 steps/s
[Step=30350 Epoch=147.9] | Loss=0.00496 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=3.069 | 3762.5 samples/s | 58.8 steps/s
[Step=30400 Epoch=148.1] | Loss=0.00482 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=3.070 | 4057.8 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step30400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.4] | Loss=0.10201 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.056 | 3634.2 samples/s | 56.8 steps/s
[Step=29650 Epoch=144.6] | Loss=0.01310 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.431 | FP-Norm(final)=3.059 | 3663.9 samples/s | 57.2 steps/s
[Step=29700 Epoch=144.8] | Loss=0.00983 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.468 | FP-Norm(final)=3.061 | 3784.1 samples/s | 59.1 steps/s
[Step=29750 Epoch=145.1] | Loss=0.00907 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=3.061 | 3770.4 samples/s | 58.9 steps/s
[Step=29800 Epoch=145.3] | Loss=0.00834 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.062 | 4870.1 samples/s | 76.1 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00727 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.063 | 1621.1 samples/s | 25.3 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00659 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.064 | 3782.3 samples/s | 59.1 steps/s
[Step=29950 Epoch=146.1] | Loss=0.00626 | Reg=0.00026 | acc=0.9688 | FP-Norm=0.502 | FP-Norm(final)=3.065 | 3767.2 samples/s | 58.9 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00578 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.066 | 4535.3 samples/s | 70.9 steps/s
[Step=30050 Epoch=146.5] | Loss=0.00548 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=3.067 | 1646.2 samples/s | 25.7 steps/s
[Step=30100 Epoch=146.8] | Loss=0.00526 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=3.068 | 3796.2 samples/s | 59.3 steps/s
[Step=30150 Epoch=147.0] | Loss=0.00504 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=3.069 | 3767.7 samples/s | 58.9 steps/s
[Step=30200 Epoch=147.3] | Loss=0.00472 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=3.069 | 4308.7 samples/s | 67.3 steps/s
[Step=30250 Epoch=147.5] | Loss=0.00455 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=3.070 | 1703.5 samples/s | 26.6 steps/s
[Step=30300 Epoch=147.8] | Loss=0.00435 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.492 | FP-Norm(final)=3.071 | 3795.1 samples/s | 59.3 steps/s
[Step=30350 Epoch=148.0] | Loss=0.00430 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.492 | FP-Norm(final)=3.072 | 3735.3 samples/s | 58.4 steps/s
[Step=30400 Epoch=148.2] | Loss=0.00413 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=3.073 | 4041.8 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step30400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=145.2] | Loss=0.05201 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.056 | 3804.6 samples/s | 59.4 steps/s
[Step=29650 Epoch=145.4] | Loss=0.01674 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=3.056 | 3451.5 samples/s | 53.9 steps/s
[Step=29700 Epoch=145.6] | Loss=0.01188 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.477 | FP-Norm(final)=3.056 | 3765.4 samples/s | 58.8 steps/s
[Step=29750 Epoch=145.9] | Loss=0.01038 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.495 | FP-Norm(final)=3.057 | 3809.1 samples/s | 59.5 steps/s
[Step=29800 Epoch=146.1] | Loss=0.00935 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.058 | 4876.1 samples/s | 76.2 steps/s
[Step=29850 Epoch=146.4] | Loss=0.00811 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.510 | FP-Norm(final)=3.059 | 1609.2 samples/s | 25.1 steps/s
[Step=29900 Epoch=146.6] | Loss=0.00756 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.510 | FP-Norm(final)=3.060 | 3761.7 samples/s | 58.8 steps/s
[Step=29950 Epoch=146.9] | Loss=0.00687 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=3.061 | 3770.5 samples/s | 58.9 steps/s
[Step=30000 Epoch=147.1] | Loss=0.00641 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.061 | 4707.8 samples/s | 73.6 steps/s
[Step=30050 Epoch=147.4] | Loss=0.00588 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.062 | 1619.9 samples/s | 25.3 steps/s
[Step=30100 Epoch=147.6] | Loss=0.00548 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.063 | 3737.3 samples/s | 58.4 steps/s
[Step=30150 Epoch=147.9] | Loss=0.00518 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.065 | 3758.5 samples/s | 58.7 steps/s
[Step=30200 Epoch=148.1] | Loss=0.00505 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.066 | 4519.1 samples/s | 70.6 steps/s
[Step=30250 Epoch=148.3] | Loss=0.00485 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.066 | 1666.1 samples/s | 26.0 steps/s
[Step=30300 Epoch=148.6] | Loss=0.00466 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.067 | 3755.5 samples/s | 58.7 steps/s
[Step=30350 Epoch=148.8] | Loss=0.00449 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.068 | 3765.7 samples/s | 58.8 steps/s
[Step=30400 Epoch=149.1] | Loss=0.00435 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=3.069 | 4336.2 samples/s | 67.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step30400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=280.5] | Loss=0.01077 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.056 | 3788.1 samples/s | 59.2 steps/s
[Step=29650 Epoch=281.0] | Loss=0.00354 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.582 | FP-Norm(final)=3.060 | 3124.5 samples/s | 48.8 steps/s
[Step=29700 Epoch=281.4] | Loss=0.00181 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.619 | FP-Norm(final)=3.060 | 4626.3 samples/s | 72.3 steps/s
[Step=29750 Epoch=281.9] | Loss=0.00124 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.617 | FP-Norm(final)=3.060 | 1539.7 samples/s | 24.1 steps/s
[Step=29800 Epoch=282.4] | Loss=0.00093 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.609 | FP-Norm(final)=3.060 | 4318.2 samples/s | 67.5 steps/s
[Step=29850 Epoch=282.9] | Loss=0.00075 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.598 | FP-Norm(final)=3.060 | 1588.4 samples/s | 24.8 steps/s
[Step=29900 Epoch=283.3] | Loss=0.00062 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=3.060 | 4064.3 samples/s | 63.5 steps/s
[Step=29950 Epoch=283.8] | Loss=0.00054 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.576 | FP-Norm(final)=3.060 | 1616.7 samples/s | 25.3 steps/s
[Step=30000 Epoch=284.3] | Loss=0.00047 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=3.060 | 3819.0 samples/s | 59.7 steps/s
[Step=30050 Epoch=284.7] | Loss=0.00042 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=3.060 | 1655.3 samples/s | 25.9 steps/s
[Step=30100 Epoch=285.2] | Loss=0.00038 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=3.060 | 3620.5 samples/s | 56.6 steps/s
[Step=30150 Epoch=285.7] | Loss=0.00035 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=3.060 | 1681.6 samples/s | 26.3 steps/s
[Step=30200 Epoch=286.2] | Loss=0.00032 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.531 | FP-Norm(final)=3.060 | 3561.1 samples/s | 55.6 steps/s
[Step=30250 Epoch=286.6] | Loss=0.00029 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=3.060 | 1744.9 samples/s | 27.3 steps/s
[Step=30300 Epoch=287.1] | Loss=0.00027 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=3.060 | 3630.1 samples/s | 56.7 steps/s
[Step=30350 Epoch=287.6] | Loss=0.00026 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.060 | 1727.8 samples/s | 27.0 steps/s
[Step=30400 Epoch=288.1] | Loss=0.00024 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.060 | 3499.5 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step30400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=281.6] | Loss=0.09832 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.056 | 3649.0 samples/s | 57.0 steps/s
[Step=29650 Epoch=282.0] | Loss=0.00381 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=3.056 | 3382.3 samples/s | 52.8 steps/s
[Step=29700 Epoch=282.5] | Loss=0.00194 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.521 | FP-Norm(final)=3.056 | 4646.8 samples/s | 72.6 steps/s
[Step=29750 Epoch=283.0] | Loss=0.00130 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=3.057 | 1547.1 samples/s | 24.2 steps/s
[Step=29800 Epoch=283.5] | Loss=0.00098 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.057 | 4333.1 samples/s | 67.7 steps/s
[Step=29850 Epoch=283.9] | Loss=0.00079 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=3.057 | 1564.9 samples/s | 24.5 steps/s
[Step=29900 Epoch=284.4] | Loss=0.00066 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=3.057 | 4057.9 samples/s | 63.4 steps/s
[Step=29950 Epoch=284.9] | Loss=0.00057 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.472 | FP-Norm(final)=3.058 | 1620.9 samples/s | 25.3 steps/s
[Step=30000 Epoch=285.4] | Loss=0.00050 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.464 | FP-Norm(final)=3.058 | 3807.1 samples/s | 59.5 steps/s
[Step=30050 Epoch=285.9] | Loss=0.00044 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.457 | FP-Norm(final)=3.058 | 1654.2 samples/s | 25.8 steps/s
[Step=30100 Epoch=286.3] | Loss=0.00040 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=3.058 | 3605.3 samples/s | 56.3 steps/s
[Step=30150 Epoch=286.8] | Loss=0.00037 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.444 | FP-Norm(final)=3.058 | 1703.5 samples/s | 26.6 steps/s
[Step=30200 Epoch=287.3] | Loss=0.00034 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=3.058 | 3591.2 samples/s | 56.1 steps/s
[Step=30250 Epoch=287.8] | Loss=0.00031 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=3.058 | 1705.7 samples/s | 26.7 steps/s
[Step=30300 Epoch=288.2] | Loss=0.00029 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=3.059 | 3586.1 samples/s | 56.0 steps/s
[Step=30350 Epoch=288.7] | Loss=0.00027 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=3.059 | 1730.3 samples/s | 27.0 steps/s
[Step=30400 Epoch=289.2] | Loss=0.00026 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=3.059 | 3553.0 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step30400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=282.7] | Loss=0.11818 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.056 | 3429.2 samples/s | 53.6 steps/s
[Step=29650 Epoch=283.1] | Loss=0.00566 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=3.056 | 3391.6 samples/s | 53.0 steps/s
[Step=29700 Epoch=283.6] | Loss=0.00289 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.590 | FP-Norm(final)=3.056 | 4654.8 samples/s | 72.7 steps/s
[Step=29750 Epoch=284.1] | Loss=0.00193 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=3.057 | 1536.4 samples/s | 24.0 steps/s
[Step=29800 Epoch=284.6] | Loss=0.00146 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=3.057 | 4457.0 samples/s | 69.6 steps/s
[Step=29850 Epoch=285.0] | Loss=0.00118 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=3.057 | 1560.4 samples/s | 24.4 steps/s
[Step=29900 Epoch=285.5] | Loss=0.00098 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=3.057 | 4159.2 samples/s | 65.0 steps/s
[Step=29950 Epoch=286.0] | Loss=0.00085 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=3.057 | 1597.4 samples/s | 25.0 steps/s
[Step=30000 Epoch=286.5] | Loss=0.00074 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=3.058 | 3962.7 samples/s | 61.9 steps/s
[Step=30050 Epoch=287.0] | Loss=0.00066 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=3.058 | 1640.4 samples/s | 25.6 steps/s
[Step=30100 Epoch=287.4] | Loss=0.00060 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=3.058 | 3730.1 samples/s | 58.3 steps/s
[Step=30150 Epoch=287.9] | Loss=0.00055 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=3.058 | 1671.5 samples/s | 26.1 steps/s
[Step=30200 Epoch=288.4] | Loss=0.00050 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.058 | 3646.9 samples/s | 57.0 steps/s
[Step=30250 Epoch=288.9] | Loss=0.00046 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=3.058 | 1694.6 samples/s | 26.5 steps/s
[Step=30300 Epoch=289.3] | Loss=0.00043 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.492 | FP-Norm(final)=3.058 | 3590.8 samples/s | 56.1 steps/s
[Step=30350 Epoch=289.8] | Loss=0.00040 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.487 | FP-Norm(final)=3.058 | 1705.9 samples/s | 26.7 steps/s
[Step=30400 Epoch=290.3] | Loss=0.00038 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.482 | FP-Norm(final)=3.058 | 3590.1 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step30400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=278.9] | Loss=0.03445 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.056 | 3399.7 samples/s | 53.1 steps/s
[Step=29650 Epoch=279.4] | Loss=0.00356 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=3.057 | 3354.2 samples/s | 52.4 steps/s
[Step=29700 Epoch=279.9] | Loss=0.00184 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.583 | FP-Norm(final)=3.057 | 4610.3 samples/s | 72.0 steps/s
[Step=29750 Epoch=280.3] | Loss=0.00123 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=3.058 | 1552.3 samples/s | 24.3 steps/s
[Step=29800 Epoch=280.8] | Loss=0.00093 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.567 | FP-Norm(final)=3.058 | 4283.2 samples/s | 66.9 steps/s
[Step=29850 Epoch=281.3] | Loss=0.00075 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.555 | FP-Norm(final)=3.058 | 1584.2 samples/s | 24.8 steps/s
[Step=29900 Epoch=281.7] | Loss=0.00062 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.544 | FP-Norm(final)=3.058 | 3861.0 samples/s | 60.3 steps/s
[Step=29950 Epoch=282.2] | Loss=0.00054 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.534 | FP-Norm(final)=3.058 | 1635.3 samples/s | 25.6 steps/s
[Step=30000 Epoch=282.7] | Loss=0.00047 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.525 | FP-Norm(final)=3.058 | 3712.0 samples/s | 58.0 steps/s
[Step=30050 Epoch=283.2] | Loss=0.00042 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=3.058 | 1676.6 samples/s | 26.2 steps/s
[Step=30100 Epoch=283.6] | Loss=0.00038 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.058 | 3573.2 samples/s | 55.8 steps/s
[Step=30150 Epoch=284.1] | Loss=0.00035 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.058 | 1718.3 samples/s | 26.8 steps/s
[Step=30200 Epoch=284.6] | Loss=0.00032 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=3.058 | 3597.3 samples/s | 56.2 steps/s
[Step=30250 Epoch=285.0] | Loss=0.00029 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.488 | FP-Norm(final)=3.058 | 1692.5 samples/s | 26.4 steps/s
[Step=30300 Epoch=285.5] | Loss=0.00027 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.482 | FP-Norm(final)=3.058 | 3590.4 samples/s | 56.1 steps/s
[Step=30350 Epoch=286.0] | Loss=0.00026 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=3.058 | 1785.9 samples/s | 27.9 steps/s
[Step=30400 Epoch=286.5] | Loss=0.00024 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=3.058 | 3349.8 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step30400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=282.1] | Loss=0.16155 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.056 | 3969.0 samples/s | 62.0 steps/s
[Step=29650 Epoch=282.6] | Loss=0.00781 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.575 | FP-Norm(final)=3.053 | 3253.8 samples/s | 50.8 steps/s
[Step=29700 Epoch=283.1] | Loss=0.00394 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.603 | FP-Norm(final)=3.053 | 4663.4 samples/s | 72.9 steps/s
[Step=29750 Epoch=283.5] | Loss=0.00265 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.599 | FP-Norm(final)=3.053 | 1524.8 samples/s | 23.8 steps/s
[Step=29800 Epoch=284.0] | Loss=0.00200 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.590 | FP-Norm(final)=3.053 | 4369.3 samples/s | 68.3 steps/s
[Step=29850 Epoch=284.5] | Loss=0.00160 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.580 | FP-Norm(final)=3.054 | 1553.8 samples/s | 24.3 steps/s
[Step=29900 Epoch=285.0] | Loss=0.00134 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=3.054 | 4153.4 samples/s | 64.9 steps/s
[Step=29950 Epoch=285.5] | Loss=0.00115 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=3.054 | 1591.1 samples/s | 24.9 steps/s
[Step=30000 Epoch=285.9] | Loss=0.00101 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=3.054 | 3963.3 samples/s | 61.9 steps/s
[Step=30050 Epoch=286.4] | Loss=0.00090 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=3.054 | 1639.1 samples/s | 25.6 steps/s
[Step=30100 Epoch=286.9] | Loss=0.00081 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=3.055 | 3751.8 samples/s | 58.6 steps/s
[Step=30150 Epoch=287.4] | Loss=0.00074 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=3.055 | 1669.2 samples/s | 26.1 steps/s
[Step=30200 Epoch=287.8] | Loss=0.00068 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=3.055 | 3610.7 samples/s | 56.4 steps/s
[Step=30250 Epoch=288.3] | Loss=0.00063 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.521 | FP-Norm(final)=3.055 | 1689.3 samples/s | 26.4 steps/s
[Step=30300 Epoch=288.8] | Loss=0.00059 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=3.055 | 3531.9 samples/s | 55.2 steps/s
[Step=30350 Epoch=289.3] | Loss=0.00055 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.055 | 1715.6 samples/s | 26.8 steps/s
[Step=30400 Epoch=289.7] | Loss=0.00052 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.055 | 3582.5 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19405 | acc=0.8991 | tpr=0.8616 | fpr=0.0193 | 3621.1 samples/s | 14.1 steps/s
Avg test loss: 0.19630, Avg test acc: 0.89811, Avg tpr: 0.86128, Avg fpr: 0.02089, total FA: 163

Testing server on iccad2012
[Step=  50] | Loss=0.53416 | acc=0.8591 | tpr=0.9690 | fpr=0.1428 | 3602.2 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.55648 | acc=0.8554 | tpr=0.9744 | fpr=0.1468 | 6814.7 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.56980 | acc=0.8521 | tpr=0.9712 | fpr=0.1501 | 6850.5 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.56988 | acc=0.8529 | tpr=0.9738 | fpr=0.1492 | 6877.5 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.56730 | acc=0.8525 | tpr=0.9677 | fpr=0.1496 | 6847.4 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.57220 | acc=0.8523 | tpr=0.9665 | fpr=0.1498 | 6744.0 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.57269 | acc=0.8528 | tpr=0.9674 | fpr=0.1492 | 6833.6 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.57333 | acc=0.8525 | tpr=0.9677 | fpr=0.1496 | 6633.7 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.57798 | acc=0.8523 | tpr=0.9674 | fpr=0.1497 | 6913.4 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.57825 | acc=0.8520 | tpr=0.9678 | fpr=0.1501 | 6730.1 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.57765 | acc=0.8522 | tpr=0.9682 | fpr=0.1499 | 12156.1 samples/s | 47.5 steps/s
Avg test loss: 0.57747, Avg test acc: 0.85221, Avg tpr: 0.96830, Avg fpr: 0.14990, total FA: 20814

server round 38/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.2] | Loss=0.08154 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.070 | 3506.5 samples/s | 54.8 steps/s
[Step=30450 Epoch=148.5] | Loss=0.01626 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=3.072 | 3791.1 samples/s | 59.2 steps/s
[Step=30500 Epoch=148.7] | Loss=0.01289 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.477 | FP-Norm(final)=3.072 | 3777.0 samples/s | 59.0 steps/s
[Step=30550 Epoch=149.0] | Loss=0.01091 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=3.072 | 3751.8 samples/s | 58.6 steps/s
[Step=30600 Epoch=149.2] | Loss=0.00987 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=3.072 | 4844.2 samples/s | 75.7 steps/s
[Step=30650 Epoch=149.5] | Loss=0.00934 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.505 | FP-Norm(final)=3.073 | 1626.6 samples/s | 25.4 steps/s
[Step=30700 Epoch=149.7] | Loss=0.00826 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.073 | 3771.3 samples/s | 58.9 steps/s
[Step=30750 Epoch=149.9] | Loss=0.00764 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.074 | 3752.9 samples/s | 58.6 steps/s
[Step=30800 Epoch=150.2] | Loss=0.00704 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.075 | 4536.4 samples/s | 70.9 steps/s
[Step=30850 Epoch=150.4] | Loss=0.00673 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.076 | 1647.7 samples/s | 25.7 steps/s
[Step=30900 Epoch=150.7] | Loss=0.00634 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.077 | 3747.7 samples/s | 58.6 steps/s
[Step=30950 Epoch=150.9] | Loss=0.00618 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.078 | 3761.4 samples/s | 58.8 steps/s
[Step=31000 Epoch=151.2] | Loss=0.00626 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=3.079 | 4288.5 samples/s | 67.0 steps/s
[Step=31050 Epoch=151.4] | Loss=0.00610 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.079 | 1692.4 samples/s | 26.4 steps/s
[Step=31100 Epoch=151.6] | Loss=0.00594 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=3.080 | 3779.2 samples/s | 59.1 steps/s
[Step=31150 Epoch=151.9] | Loss=0.00572 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=3.080 | 3751.9 samples/s | 58.6 steps/s
[Step=31200 Epoch=152.1] | Loss=0.00560 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=3.081 | 4059.7 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step31200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.3] | Loss=0.12347 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.070 | 3699.6 samples/s | 57.8 steps/s
[Step=30450 Epoch=148.6] | Loss=0.01833 | Reg=0.00030 | acc=0.9844 | FP-Norm=0.519 | FP-Norm(final)=3.070 | 3594.9 samples/s | 56.2 steps/s
[Step=30500 Epoch=148.8] | Loss=0.01268 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.562 | FP-Norm(final)=3.070 | 3778.2 samples/s | 59.0 steps/s
[Step=30550 Epoch=149.1] | Loss=0.01063 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.571 | FP-Norm(final)=3.071 | 3773.8 samples/s | 59.0 steps/s
[Step=30600 Epoch=149.3] | Loss=0.00944 | Reg=0.00033 | acc=0.9688 | FP-Norm=0.570 | FP-Norm(final)=3.072 | 4827.5 samples/s | 75.4 steps/s
[Step=30650 Epoch=149.6] | Loss=0.00823 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=3.073 | 1622.8 samples/s | 25.4 steps/s
[Step=30700 Epoch=149.8] | Loss=0.00745 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.563 | FP-Norm(final)=3.074 | 3757.4 samples/s | 58.7 steps/s
[Step=30750 Epoch=150.0] | Loss=0.00688 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=3.074 | 3750.5 samples/s | 58.6 steps/s
[Step=30800 Epoch=150.3] | Loss=0.00648 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=3.075 | 4585.8 samples/s | 71.7 steps/s
[Step=30850 Epoch=150.5] | Loss=0.00637 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=3.076 | 1642.3 samples/s | 25.7 steps/s
[Step=30900 Epoch=150.8] | Loss=0.00606 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=3.077 | 3756.5 samples/s | 58.7 steps/s
[Step=30950 Epoch=151.0] | Loss=0.00572 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=3.077 | 3781.1 samples/s | 59.1 steps/s
[Step=31000 Epoch=151.3] | Loss=0.00557 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.539 | FP-Norm(final)=3.078 | 4371.7 samples/s | 68.3 steps/s
[Step=31050 Epoch=151.5] | Loss=0.00535 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=3.079 | 1680.0 samples/s | 26.2 steps/s
[Step=31100 Epoch=151.8] | Loss=0.00516 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.532 | FP-Norm(final)=3.079 | 3754.5 samples/s | 58.7 steps/s
[Step=31150 Epoch=152.0] | Loss=0.00505 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.530 | FP-Norm(final)=3.080 | 3759.3 samples/s | 58.7 steps/s
[Step=31200 Epoch=152.2] | Loss=0.00485 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=3.080 | 4188.2 samples/s | 65.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step31200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.1] | Loss=0.04649 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.070 | 3573.5 samples/s | 55.8 steps/s
[Step=30450 Epoch=148.4] | Loss=0.01981 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=3.069 | 3739.8 samples/s | 58.4 steps/s
[Step=30500 Epoch=148.6] | Loss=0.01454 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=3.069 | 3761.6 samples/s | 58.8 steps/s
[Step=30550 Epoch=148.9] | Loss=0.01152 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.070 | 3788.8 samples/s | 59.2 steps/s
[Step=30600 Epoch=149.1] | Loss=0.01051 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=3.071 | 4858.7 samples/s | 75.9 steps/s
[Step=30650 Epoch=149.3] | Loss=0.00923 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=3.072 | 1612.7 samples/s | 25.2 steps/s
[Step=30700 Epoch=149.6] | Loss=0.00821 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=3.073 | 3748.7 samples/s | 58.6 steps/s
[Step=30750 Epoch=149.8] | Loss=0.00761 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=3.075 | 3767.1 samples/s | 58.9 steps/s
[Step=30800 Epoch=150.1] | Loss=0.00693 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=3.076 | 4513.9 samples/s | 70.5 steps/s
[Step=30850 Epoch=150.3] | Loss=0.00642 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.514 | FP-Norm(final)=3.077 | 1663.2 samples/s | 26.0 steps/s
[Step=30900 Epoch=150.6] | Loss=0.00608 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=3.078 | 3753.3 samples/s | 58.6 steps/s
[Step=30950 Epoch=150.8] | Loss=0.00574 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.080 | 3772.1 samples/s | 58.9 steps/s
[Step=31000 Epoch=151.0] | Loss=0.00551 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=3.081 | 4298.7 samples/s | 67.2 steps/s
[Step=31050 Epoch=151.3] | Loss=0.00524 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.082 | 1704.4 samples/s | 26.6 steps/s
[Step=31100 Epoch=151.5] | Loss=0.00501 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.083 | 3708.6 samples/s | 57.9 steps/s
[Step=31150 Epoch=151.8] | Loss=0.00486 | Reg=0.00026 | acc=0.9531 | FP-Norm=0.508 | FP-Norm(final)=3.084 | 3766.9 samples/s | 58.9 steps/s
[Step=31200 Epoch=152.0] | Loss=0.00474 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.085 | 4040.1 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step31200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.3] | Loss=0.12134 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.070 | 3619.9 samples/s | 56.6 steps/s
[Step=30450 Epoch=148.5] | Loss=0.01719 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.448 | FP-Norm(final)=3.069 | 3636.0 samples/s | 56.8 steps/s
[Step=30500 Epoch=148.7] | Loss=0.01453 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=3.069 | 3757.2 samples/s | 58.7 steps/s
[Step=30550 Epoch=149.0] | Loss=0.01196 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=3.068 | 3760.8 samples/s | 58.8 steps/s
[Step=30600 Epoch=149.2] | Loss=0.00992 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.526 | FP-Norm(final)=3.069 | 4820.3 samples/s | 75.3 steps/s
[Step=30650 Epoch=149.5] | Loss=0.00886 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=3.070 | 1619.3 samples/s | 25.3 steps/s
[Step=30700 Epoch=149.7] | Loss=0.00781 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.528 | FP-Norm(final)=3.071 | 3783.3 samples/s | 59.1 steps/s
[Step=30750 Epoch=150.0] | Loss=0.00708 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.526 | FP-Norm(final)=3.072 | 3757.1 samples/s | 58.7 steps/s
[Step=30800 Epoch=150.2] | Loss=0.00662 | Reg=0.00028 | acc=0.9844 | FP-Norm=0.523 | FP-Norm(final)=3.073 | 4538.5 samples/s | 70.9 steps/s
[Step=30850 Epoch=150.4] | Loss=0.00606 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.520 | FP-Norm(final)=3.074 | 1650.1 samples/s | 25.8 steps/s
[Step=30900 Epoch=150.7] | Loss=0.00576 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=3.075 | 3767.8 samples/s | 58.9 steps/s
[Step=30950 Epoch=150.9] | Loss=0.00538 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.514 | FP-Norm(final)=3.076 | 3786.9 samples/s | 59.2 steps/s
[Step=31000 Epoch=151.2] | Loss=0.00512 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=3.077 | 4262.6 samples/s | 66.6 steps/s
[Step=31050 Epoch=151.4] | Loss=0.00491 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.078 | 1705.4 samples/s | 26.6 steps/s
[Step=31100 Epoch=151.7] | Loss=0.00470 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.079 | 3766.9 samples/s | 58.9 steps/s
[Step=31150 Epoch=151.9] | Loss=0.00449 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.080 | 3776.8 samples/s | 59.0 steps/s
[Step=31200 Epoch=152.1] | Loss=0.00440 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.081 | 4055.2 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step31200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=149.1] | Loss=0.04114 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.070 | 3615.8 samples/s | 56.5 steps/s
[Step=30450 Epoch=149.3] | Loss=0.01722 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=3.069 | 3618.5 samples/s | 56.5 steps/s
[Step=30500 Epoch=149.6] | Loss=0.01208 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=3.069 | 3744.1 samples/s | 58.5 steps/s
[Step=30550 Epoch=149.8] | Loss=0.01040 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=3.070 | 3788.3 samples/s | 59.2 steps/s
[Step=30600 Epoch=150.1] | Loss=0.00919 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.487 | FP-Norm(final)=3.071 | 4920.6 samples/s | 76.9 steps/s
[Step=30650 Epoch=150.3] | Loss=0.00811 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=3.072 | 1611.2 samples/s | 25.2 steps/s
[Step=30700 Epoch=150.5] | Loss=0.00723 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=3.074 | 3776.0 samples/s | 59.0 steps/s
[Step=30750 Epoch=150.8] | Loss=0.00663 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=3.075 | 3767.6 samples/s | 58.9 steps/s
[Step=30800 Epoch=151.0] | Loss=0.00630 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=3.076 | 4732.4 samples/s | 73.9 steps/s
[Step=30850 Epoch=151.3] | Loss=0.00585 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=3.077 | 1621.7 samples/s | 25.3 steps/s
[Step=30900 Epoch=151.5] | Loss=0.00550 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.492 | FP-Norm(final)=3.078 | 3763.3 samples/s | 58.8 steps/s
[Step=30950 Epoch=151.8] | Loss=0.00512 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=3.079 | 3793.4 samples/s | 59.3 steps/s
[Step=31000 Epoch=152.0] | Loss=0.00490 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=3.080 | 4491.9 samples/s | 70.2 steps/s
[Step=31050 Epoch=152.3] | Loss=0.00477 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=3.081 | 1661.7 samples/s | 26.0 steps/s
[Step=31100 Epoch=152.5] | Loss=0.00458 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=3.082 | 3749.9 samples/s | 58.6 steps/s
[Step=31150 Epoch=152.8] | Loss=0.00443 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.488 | FP-Norm(final)=3.083 | 3759.7 samples/s | 58.7 steps/s
[Step=31200 Epoch=153.0] | Loss=0.00427 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.488 | FP-Norm(final)=3.084 | 4315.5 samples/s | 67.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step31200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=288.1] | Loss=0.20458 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.070 | 3502.6 samples/s | 54.7 steps/s
[Step=30450 Epoch=288.5] | Loss=0.00683 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.620 | FP-Norm(final)=3.070 | 3378.9 samples/s | 52.8 steps/s
[Step=30500 Epoch=289.0] | Loss=0.00351 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.643 | FP-Norm(final)=3.069 | 4605.8 samples/s | 72.0 steps/s
[Step=30550 Epoch=289.5] | Loss=0.00235 | Reg=0.00042 | acc=1.0000 | FP-Norm=0.636 | FP-Norm(final)=3.070 | 1540.0 samples/s | 24.1 steps/s
[Step=30600 Epoch=290.0] | Loss=0.00177 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=3.070 | 4294.6 samples/s | 67.1 steps/s
[Step=30650 Epoch=290.4] | Loss=0.00142 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.611 | FP-Norm(final)=3.070 | 1572.6 samples/s | 24.6 steps/s
[Step=30700 Epoch=290.9] | Loss=0.00118 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.599 | FP-Norm(final)=3.070 | 4057.0 samples/s | 63.4 steps/s
[Step=30750 Epoch=291.4] | Loss=0.00102 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.589 | FP-Norm(final)=3.070 | 1625.9 samples/s | 25.4 steps/s
[Step=30800 Epoch=291.9] | Loss=0.00089 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=3.070 | 3809.8 samples/s | 59.5 steps/s
[Step=30850 Epoch=292.3] | Loss=0.00079 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.570 | FP-Norm(final)=3.070 | 1648.1 samples/s | 25.8 steps/s
[Step=30900 Epoch=292.8] | Loss=0.00072 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.561 | FP-Norm(final)=3.070 | 3629.9 samples/s | 56.7 steps/s
[Step=30950 Epoch=293.3] | Loss=0.00065 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.554 | FP-Norm(final)=3.070 | 1682.3 samples/s | 26.3 steps/s
[Step=31000 Epoch=293.8] | Loss=0.00060 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=3.070 | 3539.4 samples/s | 55.3 steps/s
[Step=31050 Epoch=294.2] | Loss=0.00055 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.540 | FP-Norm(final)=3.070 | 1716.7 samples/s | 26.8 steps/s
[Step=31100 Epoch=294.7] | Loss=0.00052 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=3.070 | 3566.7 samples/s | 55.7 steps/s
[Step=31150 Epoch=295.2] | Loss=0.00048 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.527 | FP-Norm(final)=3.070 | 1724.6 samples/s | 26.9 steps/s
[Step=31200 Epoch=295.6] | Loss=0.00045 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.522 | FP-Norm(final)=3.070 | 3549.9 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step31200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=289.2] | Loss=0.00526 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=3.070 | 3563.0 samples/s | 55.7 steps/s
[Step=30450 Epoch=289.7] | Loss=0.00587 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.581 | FP-Norm(final)=3.070 | 3316.0 samples/s | 51.8 steps/s
[Step=30500 Epoch=290.1] | Loss=0.00297 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.616 | FP-Norm(final)=3.069 | 4596.4 samples/s | 71.8 steps/s
[Step=30550 Epoch=290.6] | Loss=0.00199 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.611 | FP-Norm(final)=3.070 | 1545.4 samples/s | 24.1 steps/s
[Step=30600 Epoch=291.1] | Loss=0.00149 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.601 | FP-Norm(final)=3.070 | 4330.5 samples/s | 67.7 steps/s
[Step=30650 Epoch=291.6] | Loss=0.00120 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.589 | FP-Norm(final)=3.070 | 1551.5 samples/s | 24.2 steps/s
[Step=30700 Epoch=292.0] | Loss=0.00100 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=3.070 | 3976.1 samples/s | 62.1 steps/s
[Step=30750 Epoch=292.5] | Loss=0.00086 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.567 | FP-Norm(final)=3.070 | 1507.2 samples/s | 23.5 steps/s
[Step=30800 Epoch=293.0] | Loss=0.00075 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.558 | FP-Norm(final)=3.070 | 3785.1 samples/s | 59.1 steps/s
[Step=30850 Epoch=293.5] | Loss=0.00067 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.549 | FP-Norm(final)=3.070 | 1630.0 samples/s | 25.5 steps/s
[Step=30900 Epoch=293.9] | Loss=0.00060 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.541 | FP-Norm(final)=3.070 | 3549.3 samples/s | 55.5 steps/s
[Step=30950 Epoch=294.4] | Loss=0.00055 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=3.070 | 1680.9 samples/s | 26.3 steps/s
[Step=31000 Epoch=294.9] | Loss=0.00051 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.526 | FP-Norm(final)=3.070 | 3512.1 samples/s | 54.9 steps/s
[Step=31050 Epoch=295.4] | Loss=0.00047 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.519 | FP-Norm(final)=3.070 | 1699.8 samples/s | 26.6 steps/s
[Step=31100 Epoch=295.8] | Loss=0.00043 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.513 | FP-Norm(final)=3.070 | 3499.2 samples/s | 54.7 steps/s
[Step=31150 Epoch=296.3] | Loss=0.00041 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.070 | 1709.3 samples/s | 26.7 steps/s
[Step=31200 Epoch=296.8] | Loss=0.00038 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.070 | 3493.5 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step31200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=290.3] | Loss=0.08101 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.070 | 3569.6 samples/s | 55.8 steps/s
[Step=30450 Epoch=290.8] | Loss=0.00535 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.557 | FP-Norm(final)=3.070 | 3470.0 samples/s | 54.2 steps/s
[Step=30500 Epoch=291.3] | Loss=0.00282 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.586 | FP-Norm(final)=3.071 | 4652.4 samples/s | 72.7 steps/s
[Step=30550 Epoch=291.7] | Loss=0.00189 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.592 | FP-Norm(final)=3.071 | 1522.6 samples/s | 23.8 steps/s
[Step=30600 Epoch=292.2] | Loss=0.00142 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=3.072 | 4261.0 samples/s | 66.6 steps/s
[Step=30650 Epoch=292.7] | Loss=0.00114 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.578 | FP-Norm(final)=3.072 | 1617.4 samples/s | 25.3 steps/s
[Step=30700 Epoch=293.2] | Loss=0.00095 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.569 | FP-Norm(final)=3.072 | 4292.3 samples/s | 67.1 steps/s
[Step=30750 Epoch=293.6] | Loss=0.00082 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.560 | FP-Norm(final)=3.072 | 1587.0 samples/s | 24.8 steps/s
[Step=30800 Epoch=294.1] | Loss=0.00072 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.551 | FP-Norm(final)=3.072 | 3826.1 samples/s | 59.8 steps/s
[Step=30850 Epoch=294.6] | Loss=0.00064 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.543 | FP-Norm(final)=3.072 | 1577.9 samples/s | 24.7 steps/s
[Step=30900 Epoch=295.1] | Loss=0.00058 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=3.072 | 3794.2 samples/s | 59.3 steps/s
[Step=30950 Epoch=295.6] | Loss=0.00053 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=3.072 | 1669.9 samples/s | 26.1 steps/s
[Step=31000 Epoch=296.0] | Loss=0.00048 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.522 | FP-Norm(final)=3.072 | 3635.8 samples/s | 56.8 steps/s
[Step=31050 Epoch=296.5] | Loss=0.00045 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=3.072 | 1686.9 samples/s | 26.4 steps/s
[Step=31100 Epoch=297.0] | Loss=0.00042 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=3.072 | 3593.7 samples/s | 56.2 steps/s
[Step=31150 Epoch=297.5] | Loss=0.00039 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.072 | 1730.3 samples/s | 27.0 steps/s
[Step=31200 Epoch=297.9] | Loss=0.00037 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=3.073 | 3552.5 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step31200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=286.5] | Loss=0.08575 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.070 | 3623.8 samples/s | 56.6 steps/s
[Step=30450 Epoch=286.9] | Loss=0.00627 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.614 | FP-Norm(final)=3.070 | 3282.9 samples/s | 51.3 steps/s
[Step=30500 Epoch=287.4] | Loss=0.00315 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.629 | FP-Norm(final)=3.070 | 4608.4 samples/s | 72.0 steps/s
[Step=30550 Epoch=287.9] | Loss=0.00210 | Reg=0.00039 | acc=1.0000 | FP-Norm=0.617 | FP-Norm(final)=3.070 | 1553.3 samples/s | 24.3 steps/s
[Step=30600 Epoch=288.3] | Loss=0.00158 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.603 | FP-Norm(final)=3.070 | 4283.4 samples/s | 66.9 steps/s
[Step=30650 Epoch=288.8] | Loss=0.00127 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.589 | FP-Norm(final)=3.070 | 1600.5 samples/s | 25.0 steps/s
[Step=30700 Epoch=289.3] | Loss=0.00106 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.577 | FP-Norm(final)=3.070 | 3967.6 samples/s | 62.0 steps/s
[Step=30750 Epoch=289.8] | Loss=0.00091 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.566 | FP-Norm(final)=3.070 | 1647.2 samples/s | 25.7 steps/s
[Step=30800 Epoch=290.2] | Loss=0.00080 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.556 | FP-Norm(final)=3.070 | 3687.0 samples/s | 57.6 steps/s
[Step=30850 Epoch=290.7] | Loss=0.00071 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.546 | FP-Norm(final)=3.070 | 1695.1 samples/s | 26.5 steps/s
[Step=30900 Epoch=291.2] | Loss=0.00064 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.538 | FP-Norm(final)=3.070 | 3600.9 samples/s | 56.3 steps/s
[Step=30950 Epoch=291.6] | Loss=0.00058 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=3.070 | 1710.0 samples/s | 26.7 steps/s
[Step=31000 Epoch=292.1] | Loss=0.00054 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.522 | FP-Norm(final)=3.070 | 3634.2 samples/s | 56.8 steps/s
[Step=31050 Epoch=292.6] | Loss=0.00050 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=3.070 | 1714.6 samples/s | 26.8 steps/s
[Step=31100 Epoch=293.1] | Loss=0.00046 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.070 | 3546.5 samples/s | 55.4 steps/s
[Step=31150 Epoch=293.5] | Loss=0.00043 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.070 | 1825.5 samples/s | 28.5 steps/s
[Step=31200 Epoch=294.0] | Loss=0.00040 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=3.070 | 3172.9 samples/s | 49.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step31200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=289.7] | Loss=0.20610 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.070 | 3615.2 samples/s | 56.5 steps/s
[Step=30450 Epoch=290.2] | Loss=0.00619 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=3.070 | 3298.9 samples/s | 51.5 steps/s
[Step=30500 Epoch=290.7] | Loss=0.00315 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=3.070 | 4687.8 samples/s | 73.2 steps/s
[Step=30550 Epoch=291.2] | Loss=0.00211 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.530 | FP-Norm(final)=3.070 | 1534.9 samples/s | 24.0 steps/s
[Step=30600 Epoch=291.6] | Loss=0.00159 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.520 | FP-Norm(final)=3.070 | 4455.0 samples/s | 69.6 steps/s
[Step=30650 Epoch=292.1] | Loss=0.00127 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.510 | FP-Norm(final)=3.070 | 1572.6 samples/s | 24.6 steps/s
[Step=30700 Epoch=292.6] | Loss=0.00106 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.070 | 4201.6 samples/s | 65.7 steps/s
[Step=30750 Epoch=293.1] | Loss=0.00092 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=3.070 | 1613.8 samples/s | 25.2 steps/s
[Step=30800 Epoch=293.6] | Loss=0.00080 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=3.071 | 3970.1 samples/s | 62.0 steps/s
[Step=30850 Epoch=294.0] | Loss=0.00072 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.478 | FP-Norm(final)=3.071 | 1633.8 samples/s | 25.5 steps/s
[Step=30900 Epoch=294.5] | Loss=0.00065 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=3.071 | 3826.9 samples/s | 59.8 steps/s
[Step=30950 Epoch=295.0] | Loss=0.00059 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=3.071 | 1670.6 samples/s | 26.1 steps/s
[Step=31000 Epoch=295.5] | Loss=0.00054 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=3.071 | 3643.1 samples/s | 56.9 steps/s
[Step=31050 Epoch=295.9] | Loss=0.00050 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=3.071 | 1699.1 samples/s | 26.5 steps/s
[Step=31100 Epoch=296.4] | Loss=0.00047 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.449 | FP-Norm(final)=3.071 | 3590.7 samples/s | 56.1 steps/s
[Step=31150 Epoch=296.9] | Loss=0.00044 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.444 | FP-Norm(final)=3.071 | 1718.3 samples/s | 26.8 steps/s
[Step=31200 Epoch=297.4] | Loss=0.00041 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=3.071 | 3577.2 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19617 | acc=0.8987 | tpr=0.8609 | fpr=0.0193 | 3685.3 samples/s | 14.4 steps/s
Avg test loss: 0.19933, Avg test acc: 0.89683, Avg tpr: 0.85959, Avg fpr: 0.02128, total FA: 166

Testing server on iccad2012
[Step=  50] | Loss=0.51865 | acc=0.8628 | tpr=0.9735 | fpr=0.1392 | 3640.8 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.54057 | acc=0.8595 | tpr=0.9765 | fpr=0.1427 | 6955.7 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.55334 | acc=0.8558 | tpr=0.9712 | fpr=0.1463 | 6843.8 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.55355 | acc=0.8568 | tpr=0.9738 | fpr=0.1454 | 7068.7 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.55092 | acc=0.8563 | tpr=0.9677 | fpr=0.1457 | 6576.7 samples/s | 25.7 steps/s
[Step= 300] | Loss=0.55567 | acc=0.8560 | tpr=0.9673 | fpr=0.1460 | 7181.0 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.55649 | acc=0.8564 | tpr=0.9681 | fpr=0.1457 | 6719.4 samples/s | 26.2 steps/s
[Step= 400] | Loss=0.55725 | acc=0.8562 | tpr=0.9683 | fpr=0.1459 | 6662.3 samples/s | 26.0 steps/s
[Step= 450] | Loss=0.56184 | acc=0.8560 | tpr=0.9679 | fpr=0.1461 | 6820.9 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.56180 | acc=0.8558 | tpr=0.9683 | fpr=0.1462 | 6841.2 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.56131 | acc=0.8560 | tpr=0.9686 | fpr=0.1461 | 12467.2 samples/s | 48.7 steps/s
Avg test loss: 0.56117, Avg test acc: 0.85597, Avg tpr: 0.96870, Avg fpr: 0.14608, total FA: 20283

server round 39/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.1] | Loss=0.11123 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.083 | 3754.9 samples/s | 58.7 steps/s
[Step=31250 Epoch=152.4] | Loss=0.01924 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.433 | FP-Norm(final)=3.082 | 3592.8 samples/s | 56.1 steps/s
[Step=31300 Epoch=152.6] | Loss=0.01261 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.466 | FP-Norm(final)=3.082 | 3779.5 samples/s | 59.1 steps/s
[Step=31350 Epoch=152.9] | Loss=0.01109 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.475 | FP-Norm(final)=3.083 | 3761.6 samples/s | 58.8 steps/s
[Step=31400 Epoch=153.1] | Loss=0.00977 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.479 | FP-Norm(final)=3.083 | 4864.1 samples/s | 76.0 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00840 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.483 | FP-Norm(final)=3.084 | 1630.7 samples/s | 25.5 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00769 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.483 | FP-Norm(final)=3.085 | 3792.3 samples/s | 59.3 steps/s
[Step=31550 Epoch=153.8] | Loss=0.00731 | Reg=0.00024 | acc=0.9844 | FP-Norm=0.484 | FP-Norm(final)=3.087 | 3767.1 samples/s | 58.9 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00680 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.483 | FP-Norm(final)=3.087 | 4577.9 samples/s | 71.5 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00632 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.483 | FP-Norm(final)=3.088 | 1668.7 samples/s | 26.1 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00601 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.482 | FP-Norm(final)=3.089 | 3769.1 samples/s | 58.9 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00568 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.481 | FP-Norm(final)=3.090 | 3795.2 samples/s | 59.3 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00559 | Reg=0.00023 | acc=0.9844 | FP-Norm=0.480 | FP-Norm(final)=3.091 | 4295.7 samples/s | 67.1 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00544 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.479 | FP-Norm(final)=3.092 | 1707.9 samples/s | 26.7 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00533 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.479 | FP-Norm(final)=3.093 | 3767.6 samples/s | 58.9 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00523 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.479 | FP-Norm(final)=3.094 | 3816.2 samples/s | 59.6 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00507 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.478 | FP-Norm(final)=3.094 | 4048.5 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.2] | Loss=0.03661 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.083 | 3928.3 samples/s | 61.4 steps/s
[Step=31250 Epoch=152.5] | Loss=0.01867 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.431 | FP-Norm(final)=3.083 | 3447.3 samples/s | 53.9 steps/s
[Step=31300 Epoch=152.7] | Loss=0.01235 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.482 | FP-Norm(final)=3.083 | 3765.4 samples/s | 58.8 steps/s
[Step=31350 Epoch=153.0] | Loss=0.01045 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.495 | FP-Norm(final)=3.084 | 3815.0 samples/s | 59.6 steps/s
[Step=31400 Epoch=153.2] | Loss=0.00952 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.500 | FP-Norm(final)=3.085 | 4853.4 samples/s | 75.8 steps/s
[Step=31450 Epoch=153.5] | Loss=0.00857 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.086 | 1618.4 samples/s | 25.3 steps/s
[Step=31500 Epoch=153.7] | Loss=0.00790 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.508 | FP-Norm(final)=3.087 | 3780.2 samples/s | 59.1 steps/s
[Step=31550 Epoch=153.9] | Loss=0.00733 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.507 | FP-Norm(final)=3.088 | 3782.3 samples/s | 59.1 steps/s
[Step=31600 Epoch=154.2] | Loss=0.00680 | Reg=0.00026 | acc=0.9844 | FP-Norm=0.505 | FP-Norm(final)=3.088 | 4595.4 samples/s | 71.8 steps/s
[Step=31650 Epoch=154.4] | Loss=0.00632 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.089 | 1665.6 samples/s | 26.0 steps/s
[Step=31700 Epoch=154.7] | Loss=0.00605 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.090 | 3775.7 samples/s | 59.0 steps/s
[Step=31750 Epoch=154.9] | Loss=0.00587 | Reg=0.00025 | acc=0.9844 | FP-Norm=0.500 | FP-Norm(final)=3.091 | 3777.2 samples/s | 59.0 steps/s
[Step=31800 Epoch=155.2] | Loss=0.00565 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=3.091 | 4385.0 samples/s | 68.5 steps/s
[Step=31850 Epoch=155.4] | Loss=0.00546 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=3.092 | 1691.5 samples/s | 26.4 steps/s
[Step=31900 Epoch=155.7] | Loss=0.00520 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=3.092 | 3771.6 samples/s | 58.9 steps/s
[Step=31950 Epoch=155.9] | Loss=0.00502 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.494 | FP-Norm(final)=3.093 | 3756.2 samples/s | 58.7 steps/s
[Step=32000 Epoch=156.1] | Loss=0.00488 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=3.094 | 4187.5 samples/s | 65.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step32000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.0] | Loss=0.08178 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.083 | 3632.5 samples/s | 56.8 steps/s
[Step=31250 Epoch=152.3] | Loss=0.01688 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=3.084 | 3663.8 samples/s | 57.2 steps/s
[Step=31300 Epoch=152.5] | Loss=0.01354 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=3.084 | 3781.1 samples/s | 59.1 steps/s
[Step=31350 Epoch=152.8] | Loss=0.01134 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.085 | 3788.7 samples/s | 59.2 steps/s
[Step=31400 Epoch=153.0] | Loss=0.00975 | Reg=0.00027 | acc=0.9844 | FP-Norm=0.516 | FP-Norm(final)=3.086 | 4825.3 samples/s | 75.4 steps/s
[Step=31450 Epoch=153.2] | Loss=0.00849 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.518 | FP-Norm(final)=3.087 | 1614.3 samples/s | 25.2 steps/s
[Step=31500 Epoch=153.5] | Loss=0.00776 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.517 | FP-Norm(final)=3.088 | 3776.1 samples/s | 59.0 steps/s
[Step=31550 Epoch=153.7] | Loss=0.00714 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.516 | FP-Norm(final)=3.089 | 3792.6 samples/s | 59.3 steps/s
[Step=31600 Epoch=154.0] | Loss=0.00660 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=3.090 | 4574.9 samples/s | 71.5 steps/s
[Step=31650 Epoch=154.2] | Loss=0.00612 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.511 | FP-Norm(final)=3.091 | 1675.7 samples/s | 26.2 steps/s
[Step=31700 Epoch=154.5] | Loss=0.00571 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.093 | 3738.4 samples/s | 58.4 steps/s
[Step=31750 Epoch=154.7] | Loss=0.00548 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.508 | FP-Norm(final)=3.094 | 3778.7 samples/s | 59.0 steps/s
[Step=31800 Epoch=154.9] | Loss=0.00533 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.507 | FP-Norm(final)=3.095 | 4254.1 samples/s | 66.5 steps/s
[Step=31850 Epoch=155.2] | Loss=0.00512 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.096 | 1684.9 samples/s | 26.3 steps/s
[Step=31900 Epoch=155.4] | Loss=0.00495 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.097 | 3816.3 samples/s | 59.6 steps/s
[Step=31950 Epoch=155.7] | Loss=0.00477 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.098 | 3791.3 samples/s | 59.2 steps/s
[Step=32000 Epoch=155.9] | Loss=0.00463 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.502 | FP-Norm(final)=3.099 | 4073.8 samples/s | 63.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step32000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.2] | Loss=0.15934 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.083 | 3867.5 samples/s | 60.4 steps/s
[Step=31250 Epoch=152.4] | Loss=0.01351 | Reg=0.00021 | acc=0.9844 | FP-Norm=0.440 | FP-Norm(final)=3.084 | 3601.3 samples/s | 56.3 steps/s
[Step=31300 Epoch=152.6] | Loss=0.01076 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=3.085 | 3758.8 samples/s | 58.7 steps/s
[Step=31350 Epoch=152.9] | Loss=0.00943 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=3.086 | 3785.6 samples/s | 59.2 steps/s
[Step=31400 Epoch=153.1] | Loss=0.00819 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.087 | 4876.8 samples/s | 76.2 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00694 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.088 | 1626.3 samples/s | 25.4 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00623 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.090 | 3782.3 samples/s | 59.1 steps/s
[Step=31550 Epoch=153.9] | Loss=0.00599 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.091 | 3793.5 samples/s | 59.3 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00555 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.092 | 4584.3 samples/s | 71.6 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00531 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.503 | FP-Norm(final)=3.093 | 1648.8 samples/s | 25.8 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00507 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.501 | FP-Norm(final)=3.094 | 3772.1 samples/s | 58.9 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00471 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.499 | FP-Norm(final)=3.095 | 3777.0 samples/s | 59.0 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00452 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=3.096 | 4292.4 samples/s | 67.1 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00439 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=3.097 | 1678.3 samples/s | 26.2 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00424 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.493 | FP-Norm(final)=3.098 | 3786.7 samples/s | 59.2 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00409 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.492 | FP-Norm(final)=3.099 | 3794.9 samples/s | 59.3 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00389 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.490 | FP-Norm(final)=3.100 | 4042.9 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step32000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=153.0] | Loss=0.15397 | Reg=0.00000 | acc=0.8750 | FP-Norm=0.000 | FP-Norm(final)=3.083 | 3621.9 samples/s | 56.6 steps/s
[Step=31250 Epoch=153.2] | Loss=0.01438 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=3.082 | 3758.3 samples/s | 58.7 steps/s
[Step=31300 Epoch=153.5] | Loss=0.01101 | Reg=0.00022 | acc=0.9688 | FP-Norm=0.462 | FP-Norm(final)=3.082 | 3761.9 samples/s | 58.8 steps/s
[Step=31350 Epoch=153.7] | Loss=0.00950 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.470 | FP-Norm(final)=3.083 | 3794.3 samples/s | 59.3 steps/s
[Step=31400 Epoch=154.0] | Loss=0.00872 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=3.084 | 4906.0 samples/s | 76.7 steps/s
[Step=31450 Epoch=154.2] | Loss=0.00775 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.477 | FP-Norm(final)=3.085 | 1624.6 samples/s | 25.4 steps/s
[Step=31500 Epoch=154.5] | Loss=0.00697 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.477 | FP-Norm(final)=3.086 | 3787.3 samples/s | 59.2 steps/s
[Step=31550 Epoch=154.7] | Loss=0.00663 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=3.087 | 3782.5 samples/s | 59.1 steps/s
[Step=31600 Epoch=155.0] | Loss=0.00617 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=3.087 | 4705.9 samples/s | 73.5 steps/s
[Step=31650 Epoch=155.2] | Loss=0.00572 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=3.088 | 1641.9 samples/s | 25.7 steps/s
[Step=31700 Epoch=155.5] | Loss=0.00546 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.475 | FP-Norm(final)=3.089 | 3817.4 samples/s | 59.6 steps/s
[Step=31750 Epoch=155.7] | Loss=0.00523 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.474 | FP-Norm(final)=3.090 | 3778.0 samples/s | 59.0 steps/s
[Step=31800 Epoch=155.9] | Loss=0.00500 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.474 | FP-Norm(final)=3.091 | 4512.5 samples/s | 70.5 steps/s
[Step=31850 Epoch=156.2] | Loss=0.00474 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.473 | FP-Norm(final)=3.092 | 1665.9 samples/s | 26.0 steps/s
[Step=31900 Epoch=156.4] | Loss=0.00457 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.472 | FP-Norm(final)=3.093 | 3763.8 samples/s | 58.8 steps/s
[Step=31950 Epoch=156.7] | Loss=0.00444 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=3.094 | 3766.2 samples/s | 58.8 steps/s
[Step=32000 Epoch=156.9] | Loss=0.00429 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=3.095 | 4364.3 samples/s | 68.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step32000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=295.7] | Loss=0.18663 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.083 | 3483.8 samples/s | 54.4 steps/s
[Step=31250 Epoch=296.1] | Loss=0.00482 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=3.084 | 3385.1 samples/s | 52.9 steps/s
[Step=31300 Epoch=296.6] | Loss=0.00247 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.084 | 4650.7 samples/s | 72.7 steps/s
[Step=31350 Epoch=297.1] | Loss=0.00167 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.505 | FP-Norm(final)=3.085 | 1546.3 samples/s | 24.2 steps/s
[Step=31400 Epoch=297.5] | Loss=0.00125 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.497 | FP-Norm(final)=3.085 | 4338.3 samples/s | 67.8 steps/s
[Step=31450 Epoch=298.0] | Loss=0.00101 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.487 | FP-Norm(final)=3.085 | 1587.4 samples/s | 24.8 steps/s
[Step=31500 Epoch=298.5] | Loss=0.00084 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.478 | FP-Norm(final)=3.085 | 4087.5 samples/s | 63.9 steps/s
[Step=31550 Epoch=299.0] | Loss=0.00072 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.470 | FP-Norm(final)=3.085 | 1630.6 samples/s | 25.5 steps/s
[Step=31600 Epoch=299.4] | Loss=0.00064 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.463 | FP-Norm(final)=3.085 | 3804.2 samples/s | 59.4 steps/s
[Step=31650 Epoch=299.9] | Loss=0.00057 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=3.085 | 1659.3 samples/s | 25.9 steps/s
[Step=31700 Epoch=300.4] | Loss=0.00051 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=3.085 | 3645.2 samples/s | 57.0 steps/s
[Step=31750 Epoch=300.9] | Loss=0.00047 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.444 | FP-Norm(final)=3.086 | 1698.1 samples/s | 26.5 steps/s
[Step=31800 Epoch=301.3] | Loss=0.00043 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=3.086 | 3558.5 samples/s | 55.6 steps/s
[Step=31850 Epoch=301.8] | Loss=0.00040 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=3.086 | 1715.3 samples/s | 26.8 steps/s
[Step=31900 Epoch=302.3] | Loss=0.00037 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=3.086 | 3574.2 samples/s | 55.8 steps/s
[Step=31950 Epoch=302.8] | Loss=0.00035 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=3.086 | 1719.2 samples/s | 26.9 steps/s
[Step=32000 Epoch=303.2] | Loss=0.00033 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=3.086 | 3544.2 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step32000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=296.8] | Loss=0.05498 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.083 | 3621.8 samples/s | 56.6 steps/s
[Step=31250 Epoch=297.3] | Loss=0.00758 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.642 | FP-Norm(final)=3.080 | 3382.3 samples/s | 52.8 steps/s
[Step=31300 Epoch=297.7] | Loss=0.00384 | Reg=0.00046 | acc=1.0000 | FP-Norm=0.662 | FP-Norm(final)=3.079 | 4675.6 samples/s | 73.1 steps/s
[Step=31350 Epoch=298.2] | Loss=0.00260 | Reg=0.00045 | acc=1.0000 | FP-Norm=0.657 | FP-Norm(final)=3.080 | 1554.2 samples/s | 24.3 steps/s
[Step=31400 Epoch=298.7] | Loss=0.00195 | Reg=0.00043 | acc=1.0000 | FP-Norm=0.647 | FP-Norm(final)=3.080 | 4347.3 samples/s | 67.9 steps/s
[Step=31450 Epoch=299.2] | Loss=0.00157 | Reg=0.00041 | acc=1.0000 | FP-Norm=0.635 | FP-Norm(final)=3.080 | 1582.0 samples/s | 24.7 steps/s
[Step=31500 Epoch=299.6] | Loss=0.00131 | Reg=0.00040 | acc=1.0000 | FP-Norm=0.624 | FP-Norm(final)=3.080 | 4049.0 samples/s | 63.3 steps/s
[Step=31550 Epoch=300.1] | Loss=0.00112 | Reg=0.00038 | acc=1.0000 | FP-Norm=0.614 | FP-Norm(final)=3.080 | 1623.9 samples/s | 25.4 steps/s
[Step=31600 Epoch=300.6] | Loss=0.00098 | Reg=0.00037 | acc=1.0000 | FP-Norm=0.604 | FP-Norm(final)=3.080 | 3840.3 samples/s | 60.0 steps/s
[Step=31650 Epoch=301.1] | Loss=0.00088 | Reg=0.00036 | acc=1.0000 | FP-Norm=0.595 | FP-Norm(final)=3.080 | 1653.4 samples/s | 25.8 steps/s
[Step=31700 Epoch=301.5] | Loss=0.00079 | Reg=0.00035 | acc=1.0000 | FP-Norm=0.587 | FP-Norm(final)=3.080 | 3646.3 samples/s | 57.0 steps/s
[Step=31750 Epoch=302.0] | Loss=0.00072 | Reg=0.00034 | acc=1.0000 | FP-Norm=0.579 | FP-Norm(final)=3.080 | 1700.2 samples/s | 26.6 steps/s
[Step=31800 Epoch=302.5] | Loss=0.00066 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.572 | FP-Norm(final)=3.080 | 3606.0 samples/s | 56.3 steps/s
[Step=31850 Epoch=303.0] | Loss=0.00061 | Reg=0.00033 | acc=1.0000 | FP-Norm=0.565 | FP-Norm(final)=3.081 | 1745.3 samples/s | 27.3 steps/s
[Step=31900 Epoch=303.4] | Loss=0.00057 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.559 | FP-Norm(final)=3.081 | 3606.4 samples/s | 56.3 steps/s
[Step=31950 Epoch=303.9] | Loss=0.00053 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.553 | FP-Norm(final)=3.081 | 1732.3 samples/s | 27.1 steps/s
[Step=32000 Epoch=304.4] | Loss=0.00050 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.547 | FP-Norm(final)=3.081 | 3554.2 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step32000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=298.0] | Loss=0.08980 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.083 | 3594.2 samples/s | 56.2 steps/s
[Step=31250 Epoch=298.4] | Loss=0.00472 | Reg=0.00031 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=3.082 | 3268.3 samples/s | 51.1 steps/s
[Step=31300 Epoch=298.9] | Loss=0.00239 | Reg=0.00032 | acc=1.0000 | FP-Norm=0.549 | FP-Norm(final)=3.082 | 4687.0 samples/s | 73.2 steps/s
[Step=31350 Epoch=299.4] | Loss=0.00161 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.542 | FP-Norm(final)=3.083 | 1544.3 samples/s | 24.1 steps/s
[Step=31400 Epoch=299.9] | Loss=0.00122 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.533 | FP-Norm(final)=3.083 | 4440.8 samples/s | 69.4 steps/s
[Step=31450 Epoch=300.3] | Loss=0.00097 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.524 | FP-Norm(final)=3.083 | 1571.8 samples/s | 24.6 steps/s
[Step=31500 Epoch=300.8] | Loss=0.00081 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.515 | FP-Norm(final)=3.083 | 4191.6 samples/s | 65.5 steps/s
[Step=31550 Epoch=301.3] | Loss=0.00070 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.506 | FP-Norm(final)=3.083 | 1594.1 samples/s | 24.9 steps/s
[Step=31600 Epoch=301.8] | Loss=0.00061 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.498 | FP-Norm(final)=3.083 | 3956.5 samples/s | 61.8 steps/s
[Step=31650 Epoch=302.2] | Loss=0.00055 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.491 | FP-Norm(final)=3.083 | 1640.5 samples/s | 25.6 steps/s
[Step=31700 Epoch=302.7] | Loss=0.00049 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.484 | FP-Norm(final)=3.083 | 3781.5 samples/s | 59.1 steps/s
[Step=31750 Epoch=303.2] | Loss=0.00045 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.478 | FP-Norm(final)=3.083 | 1684.1 samples/s | 26.3 steps/s
[Step=31800 Epoch=303.7] | Loss=0.00041 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.472 | FP-Norm(final)=3.083 | 3595.8 samples/s | 56.2 steps/s
[Step=31850 Epoch=304.1] | Loss=0.00038 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.466 | FP-Norm(final)=3.084 | 1705.9 samples/s | 26.7 steps/s
[Step=31900 Epoch=304.6] | Loss=0.00036 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=3.084 | 3565.4 samples/s | 55.7 steps/s
[Step=31950 Epoch=305.1] | Loss=0.00033 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=3.084 | 1717.8 samples/s | 26.8 steps/s
[Step=32000 Epoch=305.6] | Loss=0.00031 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.451 | FP-Norm(final)=3.084 | 3575.2 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step32000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=294.0] | Loss=0.06288 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.083 | 3649.4 samples/s | 57.0 steps/s
[Step=31250 Epoch=294.5] | Loss=0.00269 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.509 | FP-Norm(final)=3.084 | 3282.4 samples/s | 51.3 steps/s
[Step=31300 Epoch=294.9] | Loss=0.00142 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.536 | FP-Norm(final)=3.084 | 4576.0 samples/s | 71.5 steps/s
[Step=31350 Epoch=295.4] | Loss=0.00097 | Reg=0.00030 | acc=1.0000 | FP-Norm=0.537 | FP-Norm(final)=3.084 | 1551.9 samples/s | 24.2 steps/s
[Step=31400 Epoch=295.9] | Loss=0.00074 | Reg=0.00029 | acc=1.0000 | FP-Norm=0.529 | FP-Norm(final)=3.084 | 4280.8 samples/s | 66.9 steps/s
[Step=31450 Epoch=296.3] | Loss=0.00059 | Reg=0.00028 | acc=1.0000 | FP-Norm=0.521 | FP-Norm(final)=3.084 | 1597.3 samples/s | 25.0 steps/s
[Step=31500 Epoch=296.8] | Loss=0.00049 | Reg=0.00027 | acc=1.0000 | FP-Norm=0.512 | FP-Norm(final)=3.085 | 3957.4 samples/s | 61.8 steps/s
[Step=31550 Epoch=297.3] | Loss=0.00043 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.504 | FP-Norm(final)=3.085 | 1652.1 samples/s | 25.8 steps/s
[Step=31600 Epoch=297.8] | Loss=0.00037 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.496 | FP-Norm(final)=3.085 | 3673.4 samples/s | 57.4 steps/s
[Step=31650 Epoch=298.2] | Loss=0.00033 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.489 | FP-Norm(final)=3.085 | 1703.7 samples/s | 26.6 steps/s
[Step=31700 Epoch=298.7] | Loss=0.00030 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.482 | FP-Norm(final)=3.085 | 3485.0 samples/s | 54.5 steps/s
[Step=31750 Epoch=299.2] | Loss=0.00028 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=3.085 | 1723.2 samples/s | 26.9 steps/s
[Step=31800 Epoch=299.6] | Loss=0.00025 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.470 | FP-Norm(final)=3.085 | 3562.8 samples/s | 55.7 steps/s
[Step=31850 Epoch=300.1] | Loss=0.00023 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=3.085 | 1704.6 samples/s | 26.6 steps/s
[Step=31900 Epoch=300.6] | Loss=0.00022 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.460 | FP-Norm(final)=3.085 | 3598.9 samples/s | 56.2 steps/s
[Step=31950 Epoch=301.1] | Loss=0.00020 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.455 | FP-Norm(final)=3.085 | 1839.2 samples/s | 28.7 steps/s
[Step=32000 Epoch=301.5] | Loss=0.00019 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=3.085 | 3172.2 samples/s | 49.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step32000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=297.4] | Loss=0.07422 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.083 | 3490.7 samples/s | 54.5 steps/s
[Step=31250 Epoch=297.8] | Loss=0.00287 | Reg=0.00025 | acc=1.0000 | FP-Norm=0.477 | FP-Norm(final)=3.087 | 3363.8 samples/s | 52.6 steps/s
[Step=31300 Epoch=298.3] | Loss=0.00145 | Reg=0.00026 | acc=1.0000 | FP-Norm=0.495 | FP-Norm(final)=3.087 | 4677.9 samples/s | 73.1 steps/s
[Step=31350 Epoch=298.8] | Loss=0.00097 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.485 | FP-Norm(final)=3.087 | 1536.2 samples/s | 24.0 steps/s
[Step=31400 Epoch=299.3] | Loss=0.00074 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.472 | FP-Norm(final)=3.088 | 4428.5 samples/s | 69.2 steps/s
[Step=31450 Epoch=299.7] | Loss=0.00059 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=3.088 | 1577.4 samples/s | 24.6 steps/s
[Step=31500 Epoch=300.2] | Loss=0.00050 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=3.088 | 4194.0 samples/s | 65.5 steps/s
[Step=31550 Epoch=300.7] | Loss=0.00043 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=3.088 | 1610.8 samples/s | 25.2 steps/s
[Step=31600 Epoch=301.2] | Loss=0.00038 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=3.088 | 3917.5 samples/s | 61.2 steps/s
[Step=31650 Epoch=301.7] | Loss=0.00034 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=3.088 | 1638.8 samples/s | 25.6 steps/s
[Step=31700 Epoch=302.1] | Loss=0.00030 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=3.088 | 3814.4 samples/s | 59.6 steps/s
[Step=31750 Epoch=302.6] | Loss=0.00028 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=3.088 | 1685.7 samples/s | 26.3 steps/s
[Step=31800 Epoch=303.1] | Loss=0.00026 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.088 | 3596.6 samples/s | 56.2 steps/s
[Step=31850 Epoch=303.6] | Loss=0.00024 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=3.088 | 1701.2 samples/s | 26.6 steps/s
[Step=31900 Epoch=304.0] | Loss=0.00022 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=3.088 | 3572.4 samples/s | 55.8 steps/s
[Step=31950 Epoch=304.5] | Loss=0.00021 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=3.088 | 1698.9 samples/s | 26.5 steps/s
[Step=32000 Epoch=305.0] | Loss=0.00020 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.088 | 3533.3 samples/s | 55.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18550 | acc=0.9053 | tpr=0.8713 | fpr=0.0208 | 3688.0 samples/s | 14.4 steps/s
Avg test loss: 0.18793, Avg test acc: 0.90416, Avg tpr: 0.87072, Avg fpr: 0.02230, total FA: 174

Testing server on iccad2012
[Step=  50] | Loss=0.54616 | acc=0.8569 | tpr=0.9779 | fpr=0.1453 | 3641.7 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.56828 | acc=0.8536 | tpr=0.9787 | fpr=0.1487 | 6871.9 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.58122 | acc=0.8501 | tpr=0.9726 | fpr=0.1522 | 6806.3 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.58140 | acc=0.8512 | tpr=0.9738 | fpr=0.1510 | 6764.6 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.57875 | acc=0.8509 | tpr=0.9677 | fpr=0.1512 | 6793.6 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.58375 | acc=0.8505 | tpr=0.9680 | fpr=0.1516 | 6936.4 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.58434 | acc=0.8510 | tpr=0.9687 | fpr=0.1511 | 6890.5 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.58509 | acc=0.8508 | tpr=0.9677 | fpr=0.1514 | 6497.8 samples/s | 25.4 steps/s
[Step= 450] | Loss=0.58985 | acc=0.8504 | tpr=0.9679 | fpr=0.1517 | 6793.0 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.58979 | acc=0.8501 | tpr=0.9683 | fpr=0.1521 | 6897.7 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.58908 | acc=0.8502 | tpr=0.9686 | fpr=0.1519 | 12879.5 samples/s | 50.3 steps/s
Avg test loss: 0.58898, Avg test acc: 0.85027, Avg tpr: 0.96870, Avg fpr: 0.15188, total FA: 21088

server round 40/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.0] | Loss=0.14358 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.097 | 3788.1 samples/s | 59.2 steps/s
[Step=32050 Epoch=156.3] | Loss=0.02183 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.313 | FP-Norm(final)=3.097 | 3559.2 samples/s | 55.6 steps/s
[Step=32100 Epoch=156.5] | Loss=0.01476 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.352 | FP-Norm(final)=3.098 | 3764.2 samples/s | 58.8 steps/s
[Step=32150 Epoch=156.8] | Loss=0.01155 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=3.098 | 3805.7 samples/s | 59.5 steps/s
[Step=32200 Epoch=157.0] | Loss=0.01005 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.374 | FP-Norm(final)=3.099 | 4826.4 samples/s | 75.4 steps/s
[Step=32250 Epoch=157.3] | Loss=0.00861 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.100 | 1628.4 samples/s | 25.4 steps/s
[Step=32300 Epoch=157.5] | Loss=0.00778 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.101 | 3753.1 samples/s | 58.6 steps/s
[Step=32350 Epoch=157.7] | Loss=0.00728 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.102 | 3781.3 samples/s | 59.1 steps/s
[Step=32400 Epoch=158.0] | Loss=0.00678 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.102 | 4539.6 samples/s | 70.9 steps/s
[Step=32450 Epoch=158.2] | Loss=0.00635 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.103 | 1655.8 samples/s | 25.9 steps/s
[Step=32500 Epoch=158.5] | Loss=0.00607 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.104 | 3757.0 samples/s | 58.7 steps/s
[Step=32550 Epoch=158.7] | Loss=0.00576 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.105 | 3781.4 samples/s | 59.1 steps/s
[Step=32600 Epoch=159.0] | Loss=0.00552 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.382 | FP-Norm(final)=3.106 | 4314.4 samples/s | 67.4 steps/s
[Step=32650 Epoch=159.2] | Loss=0.00521 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.106 | 1690.0 samples/s | 26.4 steps/s
[Step=32700 Epoch=159.5] | Loss=0.00508 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.107 | 3770.1 samples/s | 58.9 steps/s
[Step=32750 Epoch=159.7] | Loss=0.00493 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.108 | 3784.4 samples/s | 59.1 steps/s
[Step=32800 Epoch=159.9] | Loss=0.00477 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.109 | 4081.9 samples/s | 63.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step32800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.2] | Loss=0.10444 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.097 | 3611.8 samples/s | 56.4 steps/s
[Step=32050 Epoch=156.4] | Loss=0.01956 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.312 | FP-Norm(final)=3.097 | 3703.1 samples/s | 57.9 steps/s
[Step=32100 Epoch=156.6] | Loss=0.01247 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.098 | 3749.4 samples/s | 58.6 steps/s
[Step=32150 Epoch=156.9] | Loss=0.01042 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.099 | 3782.4 samples/s | 59.1 steps/s
[Step=32200 Epoch=157.1] | Loss=0.00925 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.099 | 4844.0 samples/s | 75.7 steps/s
[Step=32250 Epoch=157.4] | Loss=0.00806 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.100 | 1615.1 samples/s | 25.2 steps/s
[Step=32300 Epoch=157.6] | Loss=0.00725 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.101 | 3765.7 samples/s | 58.8 steps/s
[Step=32350 Epoch=157.9] | Loss=0.00676 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.102 | 3784.9 samples/s | 59.1 steps/s
[Step=32400 Epoch=158.1] | Loss=0.00612 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.103 | 4610.9 samples/s | 72.0 steps/s
[Step=32450 Epoch=158.3] | Loss=0.00568 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.373 | FP-Norm(final)=3.104 | 1647.8 samples/s | 25.7 steps/s
[Step=32500 Epoch=158.6] | Loss=0.00529 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.104 | 3776.1 samples/s | 59.0 steps/s
[Step=32550 Epoch=158.8] | Loss=0.00499 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.105 | 3767.8 samples/s | 58.9 steps/s
[Step=32600 Epoch=159.1] | Loss=0.00495 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.106 | 4423.4 samples/s | 69.1 steps/s
[Step=32650 Epoch=159.3] | Loss=0.00476 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.107 | 1684.3 samples/s | 26.3 steps/s
[Step=32700 Epoch=159.6] | Loss=0.00458 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.107 | 3782.0 samples/s | 59.1 steps/s
[Step=32750 Epoch=159.8] | Loss=0.00446 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.108 | 3771.0 samples/s | 58.9 steps/s
[Step=32800 Epoch=160.0] | Loss=0.00435 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.109 | 4183.3 samples/s | 65.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step32800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=155.9] | Loss=0.11001 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.097 | 3616.7 samples/s | 56.5 steps/s
[Step=32050 Epoch=156.2] | Loss=0.02154 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.303 | FP-Norm(final)=3.097 | 3678.0 samples/s | 57.5 steps/s
[Step=32100 Epoch=156.4] | Loss=0.01347 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=3.097 | 3820.0 samples/s | 59.7 steps/s
[Step=32150 Epoch=156.7] | Loss=0.01100 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=3.098 | 3798.8 samples/s | 59.4 steps/s
[Step=32200 Epoch=156.9] | Loss=0.00976 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.099 | 4829.4 samples/s | 75.5 steps/s
[Step=32250 Epoch=157.1] | Loss=0.00855 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.100 | 1629.3 samples/s | 25.5 steps/s
[Step=32300 Epoch=157.4] | Loss=0.00755 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.101 | 3755.9 samples/s | 58.7 steps/s
[Step=32350 Epoch=157.6] | Loss=0.00691 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=3.102 | 3779.9 samples/s | 59.1 steps/s
[Step=32400 Epoch=157.9] | Loss=0.00643 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.103 | 4566.8 samples/s | 71.4 steps/s
[Step=32450 Epoch=158.1] | Loss=0.00594 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.104 | 1664.1 samples/s | 26.0 steps/s
[Step=32500 Epoch=158.4] | Loss=0.00556 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.105 | 3730.6 samples/s | 58.3 steps/s
[Step=32550 Epoch=158.6] | Loss=0.00531 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.106 | 3799.6 samples/s | 59.4 steps/s
[Step=32600 Epoch=158.8] | Loss=0.00511 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.107 | 4307.9 samples/s | 67.3 steps/s
[Step=32650 Epoch=159.1] | Loss=0.00487 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.108 | 1708.6 samples/s | 26.7 steps/s
[Step=32700 Epoch=159.3] | Loss=0.00464 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.109 | 3794.7 samples/s | 59.3 steps/s
[Step=32750 Epoch=159.6] | Loss=0.00453 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.110 | 3790.4 samples/s | 59.2 steps/s
[Step=32800 Epoch=159.8] | Loss=0.00437 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.111 | 4069.3 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step32800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.1] | Loss=0.06809 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.097 | 4140.0 samples/s | 64.7 steps/s
[Step=32050 Epoch=156.3] | Loss=0.01706 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.297 | FP-Norm(final)=3.099 | 3295.4 samples/s | 51.5 steps/s
[Step=32100 Epoch=156.5] | Loss=0.01146 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.099 | 3797.5 samples/s | 59.3 steps/s
[Step=32150 Epoch=156.8] | Loss=0.00932 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.360 | FP-Norm(final)=3.100 | 3771.9 samples/s | 58.9 steps/s
[Step=32200 Epoch=157.0] | Loss=0.00823 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.369 | FP-Norm(final)=3.101 | 4879.1 samples/s | 76.2 steps/s
[Step=32250 Epoch=157.3] | Loss=0.00704 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.102 | 1615.6 samples/s | 25.2 steps/s
[Step=32300 Epoch=157.5] | Loss=0.00619 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.103 | 3772.4 samples/s | 58.9 steps/s
[Step=32350 Epoch=157.8] | Loss=0.00583 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.380 | FP-Norm(final)=3.103 | 3791.4 samples/s | 59.2 steps/s
[Step=32400 Epoch=158.0] | Loss=0.00551 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.104 | 4560.3 samples/s | 71.3 steps/s
[Step=32450 Epoch=158.2] | Loss=0.00512 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.105 | 1667.6 samples/s | 26.1 steps/s
[Step=32500 Epoch=158.5] | Loss=0.00484 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.106 | 3777.1 samples/s | 59.0 steps/s
[Step=32550 Epoch=158.7] | Loss=0.00457 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.107 | 3781.6 samples/s | 59.1 steps/s
[Step=32600 Epoch=159.0] | Loss=0.00439 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.108 | 4314.4 samples/s | 67.4 steps/s
[Step=32650 Epoch=159.2] | Loss=0.00414 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.382 | FP-Norm(final)=3.108 | 1699.7 samples/s | 26.6 steps/s
[Step=32700 Epoch=159.5] | Loss=0.00394 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.109 | 3804.3 samples/s | 59.4 steps/s
[Step=32750 Epoch=159.7] | Loss=0.00382 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.110 | 3759.2 samples/s | 58.7 steps/s
[Step=32800 Epoch=160.0] | Loss=0.00375 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.111 | 4085.5 samples/s | 63.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step32800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.9] | Loss=0.07806 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.097 | 3662.8 samples/s | 57.2 steps/s
[Step=32050 Epoch=157.2] | Loss=0.01883 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.322 | FP-Norm(final)=3.098 | 3719.0 samples/s | 58.1 steps/s
[Step=32100 Epoch=157.4] | Loss=0.01269 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.345 | FP-Norm(final)=3.098 | 3762.1 samples/s | 58.8 steps/s
[Step=32150 Epoch=157.7] | Loss=0.01015 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.099 | 3795.5 samples/s | 59.3 steps/s
[Step=32200 Epoch=157.9] | Loss=0.00889 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.100 | 4875.2 samples/s | 76.2 steps/s
[Step=32250 Epoch=158.1] | Loss=0.00776 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.101 | 1625.3 samples/s | 25.4 steps/s
[Step=32300 Epoch=158.4] | Loss=0.00691 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.101 | 3763.2 samples/s | 58.8 steps/s
[Step=32350 Epoch=158.6] | Loss=0.00630 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.102 | 3761.1 samples/s | 58.8 steps/s
[Step=32400 Epoch=158.9] | Loss=0.00587 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.363 | FP-Norm(final)=3.103 | 4704.6 samples/s | 73.5 steps/s
[Step=32450 Epoch=159.1] | Loss=0.00540 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.104 | 1633.7 samples/s | 25.5 steps/s
[Step=32500 Epoch=159.4] | Loss=0.00504 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.105 | 3767.1 samples/s | 58.9 steps/s
[Step=32550 Epoch=159.6] | Loss=0.00483 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.106 | 3789.9 samples/s | 59.2 steps/s
[Step=32600 Epoch=159.9] | Loss=0.00464 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.106 | 4534.2 samples/s | 70.8 steps/s
[Step=32650 Epoch=160.1] | Loss=0.00447 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.107 | 1661.4 samples/s | 26.0 steps/s
[Step=32700 Epoch=160.4] | Loss=0.00428 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.108 | 3784.0 samples/s | 59.1 steps/s
[Step=32750 Epoch=160.6] | Loss=0.00410 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.109 | 3782.6 samples/s | 59.1 steps/s
[Step=32800 Epoch=160.8] | Loss=0.00400 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.109 | 4371.4 samples/s | 68.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step32800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=303.2] | Loss=0.00336 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=3.097 | 3514.1 samples/s | 54.9 steps/s
[Step=32050 Epoch=303.7] | Loss=0.00625 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.099 | 3372.5 samples/s | 52.7 steps/s
[Step=32100 Epoch=304.2] | Loss=0.00321 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.431 | FP-Norm(final)=3.100 | 4652.1 samples/s | 72.7 steps/s
[Step=32150 Epoch=304.6] | Loss=0.00215 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=3.100 | 1545.2 samples/s | 24.1 steps/s
[Step=32200 Epoch=305.1] | Loss=0.00162 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=3.100 | 4343.3 samples/s | 67.9 steps/s
[Step=32250 Epoch=305.6] | Loss=0.00130 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=3.101 | 1572.0 samples/s | 24.6 steps/s
[Step=32300 Epoch=306.1] | Loss=0.00109 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=3.101 | 4033.5 samples/s | 63.0 steps/s
[Step=32350 Epoch=306.5] | Loss=0.00094 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=3.101 | 1629.4 samples/s | 25.5 steps/s
[Step=32400 Epoch=307.0] | Loss=0.00082 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=3.101 | 3846.4 samples/s | 60.1 steps/s
[Step=32450 Epoch=307.5] | Loss=0.00073 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=3.101 | 1677.2 samples/s | 26.2 steps/s
[Step=32500 Epoch=308.0] | Loss=0.00066 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.101 | 3592.6 samples/s | 56.1 steps/s
[Step=32550 Epoch=308.4] | Loss=0.00061 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=3.101 | 1700.5 samples/s | 26.6 steps/s
[Step=32600 Epoch=308.9] | Loss=0.00056 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=3.101 | 3525.4 samples/s | 55.1 steps/s
[Step=32650 Epoch=309.4] | Loss=0.00051 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=3.101 | 1726.3 samples/s | 27.0 steps/s
[Step=32700 Epoch=309.9] | Loss=0.00048 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.101 | 3571.5 samples/s | 55.8 steps/s
[Step=32750 Epoch=310.3] | Loss=0.00045 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.101 | 1708.2 samples/s | 26.7 steps/s
[Step=32800 Epoch=310.8] | Loss=0.00042 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.101 | 3577.7 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step32800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=304.4] | Loss=0.12069 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.097 | 3535.6 samples/s | 55.2 steps/s
[Step=32050 Epoch=304.9] | Loss=0.00798 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=3.097 | 3343.2 samples/s | 52.2 steps/s
[Step=32100 Epoch=305.4] | Loss=0.00402 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=3.097 | 4673.6 samples/s | 73.0 steps/s
[Step=32150 Epoch=305.8] | Loss=0.00269 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=3.097 | 1547.0 samples/s | 24.2 steps/s
[Step=32200 Epoch=306.3] | Loss=0.00203 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.097 | 4343.0 samples/s | 67.9 steps/s
[Step=32250 Epoch=306.8] | Loss=0.00163 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.097 | 1597.4 samples/s | 25.0 steps/s
[Step=32300 Epoch=307.3] | Loss=0.00136 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=3.097 | 4111.9 samples/s | 64.2 steps/s
[Step=32350 Epoch=307.7] | Loss=0.00117 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=3.097 | 1616.6 samples/s | 25.3 steps/s
[Step=32400 Epoch=308.2] | Loss=0.00103 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=3.097 | 3839.0 samples/s | 60.0 steps/s
[Step=32450 Epoch=308.7] | Loss=0.00092 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.097 | 1663.2 samples/s | 26.0 steps/s
[Step=32500 Epoch=309.2] | Loss=0.00083 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.098 | 3634.8 samples/s | 56.8 steps/s
[Step=32550 Epoch=309.6] | Loss=0.00075 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.098 | 1709.3 samples/s | 26.7 steps/s
[Step=32600 Epoch=310.1] | Loss=0.00069 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.098 | 3557.0 samples/s | 55.6 steps/s
[Step=32650 Epoch=310.6] | Loss=0.00064 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=3.098 | 1691.6 samples/s | 26.4 steps/s
[Step=32700 Epoch=311.1] | Loss=0.00060 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.098 | 3651.0 samples/s | 57.0 steps/s
[Step=32750 Epoch=311.5] | Loss=0.00056 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.098 | 1729.1 samples/s | 27.0 steps/s
[Step=32800 Epoch=312.0] | Loss=0.00052 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.098 | 3553.2 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step32800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=305.6] | Loss=0.13250 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.097 | 3705.8 samples/s | 57.9 steps/s
[Step=32050 Epoch=306.1] | Loss=0.00928 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.438 | FP-Norm(final)=3.097 | 3207.7 samples/s | 50.1 steps/s
[Step=32100 Epoch=306.5] | Loss=0.00470 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.470 | FP-Norm(final)=3.098 | 4693.0 samples/s | 73.3 steps/s
[Step=32150 Epoch=307.0] | Loss=0.00315 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.472 | FP-Norm(final)=3.098 | 1542.0 samples/s | 24.1 steps/s
[Step=32200 Epoch=307.5] | Loss=0.00237 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.467 | FP-Norm(final)=3.098 | 4429.5 samples/s | 69.2 steps/s
[Step=32250 Epoch=308.0] | Loss=0.00191 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=3.098 | 1565.0 samples/s | 24.5 steps/s
[Step=32300 Epoch=308.4] | Loss=0.00159 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.454 | FP-Norm(final)=3.098 | 4201.3 samples/s | 65.6 steps/s
[Step=32350 Epoch=308.9] | Loss=0.00137 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.448 | FP-Norm(final)=3.098 | 1617.7 samples/s | 25.3 steps/s
[Step=32400 Epoch=309.4] | Loss=0.00120 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=3.098 | 3933.8 samples/s | 61.5 steps/s
[Step=32450 Epoch=309.9] | Loss=0.00107 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=3.098 | 1633.8 samples/s | 25.5 steps/s
[Step=32500 Epoch=310.4] | Loss=0.00097 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.431 | FP-Norm(final)=3.099 | 3692.2 samples/s | 57.7 steps/s
[Step=32550 Epoch=310.8] | Loss=0.00088 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=3.099 | 1649.8 samples/s | 25.8 steps/s
[Step=32600 Epoch=311.3] | Loss=0.00081 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=3.099 | 3289.5 samples/s | 51.4 steps/s
[Step=32650 Epoch=311.8] | Loss=0.00075 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.099 | 1709.5 samples/s | 26.7 steps/s
[Step=32700 Epoch=312.3] | Loss=0.00070 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=3.099 | 3570.7 samples/s | 55.8 steps/s
[Step=32750 Epoch=312.7] | Loss=0.00065 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.099 | 1700.9 samples/s | 26.6 steps/s
[Step=32800 Epoch=313.2] | Loss=0.00061 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.099 | 3606.3 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step32800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=301.5] | Loss=0.06446 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.097 | 3627.0 samples/s | 56.7 steps/s
[Step=32050 Epoch=302.0] | Loss=0.00888 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=3.097 | 3263.6 samples/s | 51.0 steps/s
[Step=32100 Epoch=302.5] | Loss=0.00447 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=3.097 | 4597.9 samples/s | 71.8 steps/s
[Step=32150 Epoch=302.9] | Loss=0.00299 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.476 | FP-Norm(final)=3.097 | 1551.7 samples/s | 24.2 steps/s
[Step=32200 Epoch=303.4] | Loss=0.00225 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.470 | FP-Norm(final)=3.097 | 4207.5 samples/s | 65.7 steps/s
[Step=32250 Epoch=303.9] | Loss=0.00181 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.463 | FP-Norm(final)=3.097 | 1596.9 samples/s | 25.0 steps/s
[Step=32300 Epoch=304.4] | Loss=0.00151 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.456 | FP-Norm(final)=3.097 | 3940.6 samples/s | 61.6 steps/s
[Step=32350 Epoch=304.8] | Loss=0.00130 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.450 | FP-Norm(final)=3.097 | 1640.5 samples/s | 25.6 steps/s
[Step=32400 Epoch=305.3] | Loss=0.00114 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.443 | FP-Norm(final)=3.097 | 3695.0 samples/s | 57.7 steps/s
[Step=32450 Epoch=305.8] | Loss=0.00102 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.437 | FP-Norm(final)=3.097 | 1683.4 samples/s | 26.3 steps/s
[Step=32500 Epoch=306.2] | Loss=0.00092 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=3.097 | 3566.6 samples/s | 55.7 steps/s
[Step=32550 Epoch=306.7] | Loss=0.00083 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=3.097 | 1727.6 samples/s | 27.0 steps/s
[Step=32600 Epoch=307.2] | Loss=0.00077 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=3.097 | 3589.5 samples/s | 56.1 steps/s
[Step=32650 Epoch=307.7] | Loss=0.00071 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.098 | 1737.6 samples/s | 27.2 steps/s
[Step=32700 Epoch=308.1] | Loss=0.00066 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=3.098 | 3557.3 samples/s | 55.6 steps/s
[Step=32750 Epoch=308.6] | Loss=0.00062 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.098 | 1830.5 samples/s | 28.6 steps/s
[Step=32800 Epoch=309.1] | Loss=0.00058 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.098 | 3147.8 samples/s | 49.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step32800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=305.0] | Loss=0.16927 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.097 | 3577.9 samples/s | 55.9 steps/s
[Step=32050 Epoch=305.5] | Loss=0.00695 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.099 | 3348.0 samples/s | 52.3 steps/s
[Step=32100 Epoch=305.9] | Loss=0.00350 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=3.099 | 4650.0 samples/s | 72.7 steps/s
[Step=32150 Epoch=306.4] | Loss=0.00235 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.441 | FP-Norm(final)=3.099 | 1538.8 samples/s | 24.0 steps/s
[Step=32200 Epoch=306.9] | Loss=0.00177 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.436 | FP-Norm(final)=3.100 | 4430.5 samples/s | 69.2 steps/s
[Step=32250 Epoch=307.4] | Loss=0.00142 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=3.100 | 1568.1 samples/s | 24.5 steps/s
[Step=32300 Epoch=307.8] | Loss=0.00119 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=3.100 | 4195.8 samples/s | 65.6 steps/s
[Step=32350 Epoch=308.3] | Loss=0.00102 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.100 | 1594.4 samples/s | 24.9 steps/s
[Step=32400 Epoch=308.8] | Loss=0.00090 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=3.100 | 3996.2 samples/s | 62.4 steps/s
[Step=32450 Epoch=309.3] | Loss=0.00080 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.100 | 1630.6 samples/s | 25.5 steps/s
[Step=32500 Epoch=309.8] | Loss=0.00072 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=3.100 | 3795.0 samples/s | 59.3 steps/s
[Step=32550 Epoch=310.2] | Loss=0.00066 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=3.100 | 1682.2 samples/s | 26.3 steps/s
[Step=32600 Epoch=310.7] | Loss=0.00061 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=3.100 | 3573.7 samples/s | 55.8 steps/s
[Step=32650 Epoch=311.2] | Loss=0.00056 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=3.100 | 1681.3 samples/s | 26.3 steps/s
[Step=32700 Epoch=311.7] | Loss=0.00052 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.100 | 3598.6 samples/s | 56.2 steps/s
[Step=32750 Epoch=312.1] | Loss=0.00049 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.100 | 1718.6 samples/s | 26.9 steps/s
[Step=32800 Epoch=312.6] | Loss=0.00046 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.100 | 3619.6 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18694 | acc=0.9073 | tpr=0.8739 | fpr=0.0201 | 3630.7 samples/s | 14.2 steps/s
Avg test loss: 0.18881, Avg test acc: 0.90620, Avg tpr: 0.87340, Avg fpr: 0.02166, total FA: 169

Testing server on iccad2012
[Step=  50] | Loss=0.53968 | acc=0.8584 | tpr=0.9690 | fpr=0.1436 | 3688.3 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.56193 | acc=0.8555 | tpr=0.9744 | fpr=0.1468 | 6770.3 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.57507 | acc=0.8520 | tpr=0.9697 | fpr=0.1501 | 6762.2 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.57516 | acc=0.8531 | tpr=0.9705 | fpr=0.1490 | 6948.6 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.57223 | acc=0.8532 | tpr=0.9659 | fpr=0.1489 | 6774.5 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.57730 | acc=0.8526 | tpr=0.9658 | fpr=0.1495 | 6997.0 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.57806 | acc=0.8529 | tpr=0.9668 | fpr=0.1491 | 6859.0 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.57884 | acc=0.8526 | tpr=0.9661 | fpr=0.1495 | 6830.2 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.58376 | acc=0.8522 | tpr=0.9664 | fpr=0.1498 | 6610.0 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.58373 | acc=0.8520 | tpr=0.9670 | fpr=0.1501 | 6845.6 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.58298 | acc=0.8522 | tpr=0.9678 | fpr=0.1499 | 12494.7 samples/s | 48.8 steps/s
Avg test loss: 0.58283, Avg test acc: 0.85230, Avg tpr: 0.96791, Avg fpr: 0.14980, total FA: 20800

server round 41/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=159.9] | Loss=0.13092 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.110 | 3642.7 samples/s | 56.9 steps/s
[Step=32850 Epoch=160.2] | Loss=0.01885 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.309 | FP-Norm(final)=3.110 | 3701.8 samples/s | 57.8 steps/s
[Step=32900 Epoch=160.4] | Loss=0.01356 | Reg=0.00012 | acc=0.9688 | FP-Norm=0.342 | FP-Norm(final)=3.111 | 3772.5 samples/s | 58.9 steps/s
[Step=32950 Epoch=160.7] | Loss=0.01081 | Reg=0.00014 | acc=0.9688 | FP-Norm=0.362 | FP-Norm(final)=3.112 | 3804.1 samples/s | 59.4 steps/s
[Step=33000 Epoch=160.9] | Loss=0.00931 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.113 | 4867.0 samples/s | 76.0 steps/s
[Step=33050 Epoch=161.2] | Loss=0.00814 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.114 | 1618.8 samples/s | 25.3 steps/s
[Step=33100 Epoch=161.4] | Loss=0.00745 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.114 | 3767.0 samples/s | 58.9 steps/s
[Step=33150 Epoch=161.6] | Loss=0.00682 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.115 | 3771.0 samples/s | 58.9 steps/s
[Step=33200 Epoch=161.9] | Loss=0.00638 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.116 | 4552.1 samples/s | 71.1 steps/s
[Step=33250 Epoch=162.1] | Loss=0.00597 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.117 | 1664.6 samples/s | 26.0 steps/s
[Step=33300 Epoch=162.4] | Loss=0.00559 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.118 | 3777.3 samples/s | 59.0 steps/s
[Step=33350 Epoch=162.6] | Loss=0.00531 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.118 | 3810.4 samples/s | 59.5 steps/s
[Step=33400 Epoch=162.9] | Loss=0.00519 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.379 | FP-Norm(final)=3.119 | 4254.7 samples/s | 66.5 steps/s
[Step=33450 Epoch=163.1] | Loss=0.00497 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.120 | 1697.2 samples/s | 26.5 steps/s
[Step=33500 Epoch=163.4] | Loss=0.00478 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.121 | 3804.6 samples/s | 59.4 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00464 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.121 | 3787.3 samples/s | 59.2 steps/s
[Step=33600 Epoch=163.8] | Loss=0.00452 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.122 | 4031.6 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step33600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=160.1] | Loss=0.05905 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.110 | 3735.0 samples/s | 58.4 steps/s
[Step=32850 Epoch=160.3] | Loss=0.01842 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.309 | FP-Norm(final)=3.111 | 3496.1 samples/s | 54.6 steps/s
[Step=32900 Epoch=160.5] | Loss=0.01220 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.112 | 3764.0 samples/s | 58.8 steps/s
[Step=32950 Epoch=160.8] | Loss=0.01055 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.112 | 3778.1 samples/s | 59.0 steps/s
[Step=33000 Epoch=161.0] | Loss=0.00893 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.113 | 4864.3 samples/s | 76.0 steps/s
[Step=33050 Epoch=161.3] | Loss=0.00782 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=3.114 | 1608.9 samples/s | 25.1 steps/s
[Step=33100 Epoch=161.5] | Loss=0.00698 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=3.114 | 3788.9 samples/s | 59.2 steps/s
[Step=33150 Epoch=161.8] | Loss=0.00655 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.115 | 3783.7 samples/s | 59.1 steps/s
[Step=33200 Epoch=162.0] | Loss=0.00595 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.116 | 4625.2 samples/s | 72.3 steps/s
[Step=33250 Epoch=162.2] | Loss=0.00552 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.117 | 1646.0 samples/s | 25.7 steps/s
[Step=33300 Epoch=162.5] | Loss=0.00528 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.117 | 3767.3 samples/s | 58.9 steps/s
[Step=33350 Epoch=162.7] | Loss=0.00500 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.118 | 3754.6 samples/s | 58.7 steps/s
[Step=33400 Epoch=163.0] | Loss=0.00486 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.369 | FP-Norm(final)=3.119 | 4376.0 samples/s | 68.4 steps/s
[Step=33450 Epoch=163.2] | Loss=0.00465 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.119 | 1673.0 samples/s | 26.1 steps/s
[Step=33500 Epoch=163.5] | Loss=0.00455 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.120 | 3715.7 samples/s | 58.1 steps/s
[Step=33550 Epoch=163.7] | Loss=0.00437 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.368 | FP-Norm(final)=3.121 | 3785.9 samples/s | 59.2 steps/s
[Step=33600 Epoch=164.0] | Loss=0.00428 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=3.121 | 4167.6 samples/s | 65.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step33600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=159.8] | Loss=0.08225 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.110 | 3642.0 samples/s | 56.9 steps/s
[Step=32850 Epoch=160.1] | Loss=0.02068 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.320 | FP-Norm(final)=3.110 | 3629.9 samples/s | 56.7 steps/s
[Step=32900 Epoch=160.3] | Loss=0.01336 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.111 | 3767.0 samples/s | 58.9 steps/s
[Step=32950 Epoch=160.5] | Loss=0.01092 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.111 | 3774.9 samples/s | 59.0 steps/s
[Step=33000 Epoch=160.8] | Loss=0.00944 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.369 | FP-Norm(final)=3.112 | 4828.2 samples/s | 75.4 steps/s
[Step=33050 Epoch=161.0] | Loss=0.00830 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.113 | 1627.4 samples/s | 25.4 steps/s
[Step=33100 Epoch=161.3] | Loss=0.00745 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.114 | 3771.7 samples/s | 58.9 steps/s
[Step=33150 Epoch=161.5] | Loss=0.00683 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.114 | 3787.2 samples/s | 59.2 steps/s
[Step=33200 Epoch=161.8] | Loss=0.00626 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.115 | 4541.5 samples/s | 71.0 steps/s
[Step=33250 Epoch=162.0] | Loss=0.00581 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.116 | 1667.1 samples/s | 26.0 steps/s
[Step=33300 Epoch=162.3] | Loss=0.00551 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.376 | FP-Norm(final)=3.117 | 3774.9 samples/s | 59.0 steps/s
[Step=33350 Epoch=162.5] | Loss=0.00521 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.118 | 3795.0 samples/s | 59.3 steps/s
[Step=33400 Epoch=162.7] | Loss=0.00500 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.119 | 4275.9 samples/s | 66.8 steps/s
[Step=33450 Epoch=163.0] | Loss=0.00472 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.120 | 1703.7 samples/s | 26.6 steps/s
[Step=33500 Epoch=163.2] | Loss=0.00456 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.121 | 3778.7 samples/s | 59.0 steps/s
[Step=33550 Epoch=163.5] | Loss=0.00439 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.121 | 3795.0 samples/s | 59.3 steps/s
[Step=33600 Epoch=163.7] | Loss=0.00425 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.122 | 4044.6 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step33600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=160.0] | Loss=0.06781 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.110 | 3763.2 samples/s | 58.8 steps/s
[Step=32850 Epoch=160.2] | Loss=0.01590 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.305 | FP-Norm(final)=3.111 | 3562.0 samples/s | 55.7 steps/s
[Step=32900 Epoch=160.4] | Loss=0.01144 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=3.112 | 3763.8 samples/s | 58.8 steps/s
[Step=32950 Epoch=160.7] | Loss=0.00923 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.113 | 3804.9 samples/s | 59.5 steps/s
[Step=33000 Epoch=160.9] | Loss=0.00804 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=3.113 | 4852.0 samples/s | 75.8 steps/s
[Step=33050 Epoch=161.2] | Loss=0.00690 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.371 | FP-Norm(final)=3.114 | 1620.3 samples/s | 25.3 steps/s
[Step=33100 Epoch=161.4] | Loss=0.00620 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.115 | 3791.2 samples/s | 59.2 steps/s
[Step=33150 Epoch=161.7] | Loss=0.00567 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.116 | 3788.9 samples/s | 59.2 steps/s
[Step=33200 Epoch=161.9] | Loss=0.00529 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.117 | 4569.5 samples/s | 71.4 steps/s
[Step=33250 Epoch=162.1] | Loss=0.00498 | Reg=0.00014 | acc=0.9688 | FP-Norm=0.374 | FP-Norm(final)=3.118 | 1668.2 samples/s | 26.1 steps/s
[Step=33300 Epoch=162.4] | Loss=0.00465 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.118 | 3753.4 samples/s | 58.6 steps/s
[Step=33350 Epoch=162.6] | Loss=0.00448 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.119 | 3749.2 samples/s | 58.6 steps/s
[Step=33400 Epoch=162.9] | Loss=0.00426 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.120 | 4297.1 samples/s | 67.1 steps/s
[Step=33450 Epoch=163.1] | Loss=0.00406 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.121 | 1677.7 samples/s | 26.2 steps/s
[Step=33500 Epoch=163.4] | Loss=0.00396 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.122 | 3729.3 samples/s | 58.3 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00382 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.122 | 3771.6 samples/s | 58.9 steps/s
[Step=33600 Epoch=163.9] | Loss=0.00373 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.123 | 4062.8 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step33600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=160.9] | Loss=0.10848 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=3.110 | 3637.2 samples/s | 56.8 steps/s
[Step=32850 Epoch=161.1] | Loss=0.01251 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.292 | FP-Norm(final)=3.112 | 3685.1 samples/s | 57.6 steps/s
[Step=32900 Epoch=161.3] | Loss=0.01056 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.326 | FP-Norm(final)=3.113 | 3776.0 samples/s | 59.0 steps/s
[Step=32950 Epoch=161.6] | Loss=0.00910 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=3.113 | 3759.9 samples/s | 58.7 steps/s
[Step=33000 Epoch=161.8] | Loss=0.00790 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=3.114 | 4922.3 samples/s | 76.9 steps/s
[Step=33050 Epoch=162.1] | Loss=0.00701 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.115 | 1607.0 samples/s | 25.1 steps/s
[Step=33100 Epoch=162.3] | Loss=0.00650 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.116 | 3772.9 samples/s | 59.0 steps/s
[Step=33150 Epoch=162.6] | Loss=0.00587 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.117 | 3772.4 samples/s | 58.9 steps/s
[Step=33200 Epoch=162.8] | Loss=0.00543 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.117 | 4634.2 samples/s | 72.4 steps/s
[Step=33250 Epoch=163.1] | Loss=0.00506 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.118 | 1531.2 samples/s | 23.9 steps/s
[Step=33300 Epoch=163.3] | Loss=0.00484 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.119 | 3494.6 samples/s | 54.6 steps/s
[Step=33350 Epoch=163.5] | Loss=0.00460 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.120 | 3459.5 samples/s | 54.1 steps/s
[Step=33400 Epoch=163.8] | Loss=0.00436 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.120 | 4289.6 samples/s | 67.0 steps/s
[Step=33450 Epoch=164.0] | Loss=0.00424 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.121 | 1558.0 samples/s | 24.3 steps/s
[Step=33500 Epoch=164.3] | Loss=0.00405 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.122 | 3432.2 samples/s | 53.6 steps/s
[Step=33550 Epoch=164.5] | Loss=0.00392 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.123 | 3585.1 samples/s | 56.0 steps/s
[Step=33600 Epoch=164.8] | Loss=0.00381 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.123 | 3950.6 samples/s | 61.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step33600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=310.8] | Loss=0.03952 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.110 | 3256.0 samples/s | 50.9 steps/s
[Step=32850 Epoch=311.3] | Loss=0.00807 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=3.111 | 2993.4 samples/s | 46.8 steps/s
[Step=32900 Epoch=311.8] | Loss=0.00406 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.469 | FP-Norm(final)=3.111 | 4314.2 samples/s | 67.4 steps/s
[Step=32950 Epoch=312.2] | Loss=0.00274 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.467 | FP-Norm(final)=3.111 | 1544.8 samples/s | 24.1 steps/s
[Step=33000 Epoch=312.7] | Loss=0.00206 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.461 | FP-Norm(final)=3.111 | 4336.6 samples/s | 67.8 steps/s
[Step=33050 Epoch=313.2] | Loss=0.00165 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.453 | FP-Norm(final)=3.112 | 1584.1 samples/s | 24.8 steps/s
[Step=33100 Epoch=313.7] | Loss=0.00138 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.446 | FP-Norm(final)=3.112 | 4049.1 samples/s | 63.3 steps/s
[Step=33150 Epoch=314.1] | Loss=0.00119 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=3.112 | 1623.8 samples/s | 25.4 steps/s
[Step=33200 Epoch=314.6] | Loss=0.00104 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=3.112 | 3774.3 samples/s | 59.0 steps/s
[Step=33250 Epoch=315.1] | Loss=0.00093 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=3.112 | 1651.6 samples/s | 25.8 steps/s
[Step=33300 Epoch=315.5] | Loss=0.00084 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=3.112 | 3648.3 samples/s | 57.0 steps/s
[Step=33350 Epoch=316.0] | Loss=0.00076 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.112 | 1694.3 samples/s | 26.5 steps/s
[Step=33400 Epoch=316.5] | Loss=0.00070 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=3.112 | 3585.3 samples/s | 56.0 steps/s
[Step=33450 Epoch=317.0] | Loss=0.00065 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.112 | 1718.0 samples/s | 26.8 steps/s
[Step=33500 Epoch=317.4] | Loss=0.00061 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=3.112 | 3581.7 samples/s | 56.0 steps/s
[Step=33550 Epoch=317.9] | Loss=0.00057 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=3.112 | 1704.9 samples/s | 26.6 steps/s
[Step=33600 Epoch=318.4] | Loss=0.00053 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=3.112 | 3572.3 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step33600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=312.0] | Loss=0.10120 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.110 | 3702.2 samples/s | 57.8 steps/s
[Step=32850 Epoch=312.5] | Loss=0.00761 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.110 | 3169.1 samples/s | 49.5 steps/s
[Step=32900 Epoch=313.0] | Loss=0.00383 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=3.111 | 4703.1 samples/s | 73.5 steps/s
[Step=32950 Epoch=313.4] | Loss=0.00257 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.111 | 1545.2 samples/s | 24.1 steps/s
[Step=33000 Epoch=313.9] | Loss=0.00193 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=3.111 | 4357.1 samples/s | 68.1 steps/s
[Step=33050 Epoch=314.4] | Loss=0.00155 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=3.111 | 1571.9 samples/s | 24.6 steps/s
[Step=33100 Epoch=314.9] | Loss=0.00130 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=3.111 | 4080.1 samples/s | 63.8 steps/s
[Step=33150 Epoch=315.3] | Loss=0.00112 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=3.111 | 1628.0 samples/s | 25.4 steps/s
[Step=33200 Epoch=315.8] | Loss=0.00098 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=3.111 | 3865.9 samples/s | 60.4 steps/s
[Step=33250 Epoch=316.3] | Loss=0.00087 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.112 | 1672.5 samples/s | 26.1 steps/s
[Step=33300 Epoch=316.8] | Loss=0.00079 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.112 | 3626.9 samples/s | 56.7 steps/s
[Step=33350 Epoch=317.2] | Loss=0.00072 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.112 | 1703.3 samples/s | 26.6 steps/s
[Step=33400 Epoch=317.7] | Loss=0.00066 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.112 | 3543.8 samples/s | 55.4 steps/s
[Step=33450 Epoch=318.2] | Loss=0.00061 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.112 | 1718.0 samples/s | 26.8 steps/s
[Step=33500 Epoch=318.7] | Loss=0.00057 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.112 | 3591.9 samples/s | 56.1 steps/s
[Step=33550 Epoch=319.1] | Loss=0.00053 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.112 | 1710.7 samples/s | 26.7 steps/s
[Step=33600 Epoch=319.6] | Loss=0.00050 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.112 | 3660.1 samples/s | 57.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step33600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=313.2] | Loss=0.02461 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.110 | 3493.4 samples/s | 54.6 steps/s
[Step=32850 Epoch=313.7] | Loss=0.00605 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.111 | 3465.4 samples/s | 54.1 steps/s
[Step=32900 Epoch=314.2] | Loss=0.00305 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=3.112 | 4693.5 samples/s | 73.3 steps/s
[Step=32950 Epoch=314.7] | Loss=0.00205 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.435 | FP-Norm(final)=3.112 | 1535.8 samples/s | 24.0 steps/s
[Step=33000 Epoch=315.1] | Loss=0.00154 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.431 | FP-Norm(final)=3.112 | 4404.5 samples/s | 68.8 steps/s
[Step=33050 Epoch=315.6] | Loss=0.00124 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=3.112 | 1567.7 samples/s | 24.5 steps/s
[Step=33100 Epoch=316.1] | Loss=0.00104 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.420 | FP-Norm(final)=3.112 | 4181.3 samples/s | 65.3 steps/s
[Step=33150 Epoch=316.6] | Loss=0.00089 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=3.112 | 1612.0 samples/s | 25.2 steps/s
[Step=33200 Epoch=317.0] | Loss=0.00078 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.112 | 3937.1 samples/s | 61.5 steps/s
[Step=33250 Epoch=317.5] | Loss=0.00070 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.112 | 1628.3 samples/s | 25.4 steps/s
[Step=33300 Epoch=318.0] | Loss=0.00063 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=3.112 | 3803.8 samples/s | 59.4 steps/s
[Step=33350 Epoch=318.5] | Loss=0.00058 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=3.112 | 1671.3 samples/s | 26.1 steps/s
[Step=33400 Epoch=318.9] | Loss=0.00053 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=3.112 | 3575.5 samples/s | 55.9 steps/s
[Step=33450 Epoch=319.4] | Loss=0.00049 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=3.112 | 1701.4 samples/s | 26.6 steps/s
[Step=33500 Epoch=319.9] | Loss=0.00046 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.112 | 3558.5 samples/s | 55.6 steps/s
[Step=33550 Epoch=320.4] | Loss=0.00043 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.112 | 1744.2 samples/s | 27.3 steps/s
[Step=33600 Epoch=320.9] | Loss=0.00040 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.112 | 3570.9 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step33600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=309.1] | Loss=0.10285 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.110 | 3698.6 samples/s | 57.8 steps/s
[Step=32850 Epoch=309.5] | Loss=0.00637 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=3.111 | 3245.7 samples/s | 50.7 steps/s
[Step=32900 Epoch=310.0] | Loss=0.00321 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=3.111 | 4551.6 samples/s | 71.1 steps/s
[Step=32950 Epoch=310.5] | Loss=0.00215 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=3.112 | 1533.2 samples/s | 24.0 steps/s
[Step=33000 Epoch=311.0] | Loss=0.00162 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=3.112 | 4256.9 samples/s | 66.5 steps/s
[Step=33050 Epoch=311.4] | Loss=0.00130 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=3.112 | 1590.4 samples/s | 24.9 steps/s
[Step=33100 Epoch=311.9] | Loss=0.00109 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=3.112 | 3913.5 samples/s | 61.1 steps/s
[Step=33150 Epoch=312.4] | Loss=0.00093 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.112 | 1657.5 samples/s | 25.9 steps/s
[Step=33200 Epoch=312.8] | Loss=0.00082 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=3.112 | 3661.0 samples/s | 57.2 steps/s
[Step=33250 Epoch=313.3] | Loss=0.00073 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=3.112 | 1698.3 samples/s | 26.5 steps/s
[Step=33300 Epoch=313.8] | Loss=0.00066 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=3.112 | 3575.5 samples/s | 55.9 steps/s
[Step=33350 Epoch=314.3] | Loss=0.00060 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.112 | 1728.4 samples/s | 27.0 steps/s
[Step=33400 Epoch=314.7] | Loss=0.00055 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.112 | 3579.8 samples/s | 55.9 steps/s
[Step=33450 Epoch=315.2] | Loss=0.00051 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.112 | 1732.0 samples/s | 27.1 steps/s
[Step=33500 Epoch=315.7] | Loss=0.00048 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.112 | 3500.0 samples/s | 54.7 steps/s
[Step=33550 Epoch=316.1] | Loss=0.00045 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.112 | 1817.3 samples/s | 28.4 steps/s
[Step=33600 Epoch=316.6] | Loss=0.00042 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.112 | 3215.9 samples/s | 50.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step33600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=312.6] | Loss=0.10057 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.110 | 3641.0 samples/s | 56.9 steps/s
[Step=32850 Epoch=313.1] | Loss=0.00567 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.111 | 3220.8 samples/s | 50.3 steps/s
[Step=32900 Epoch=313.6] | Loss=0.00287 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.112 | 4693.3 samples/s | 73.3 steps/s
[Step=32950 Epoch=314.0] | Loss=0.00193 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.112 | 1547.9 samples/s | 24.2 steps/s
[Step=33000 Epoch=314.5] | Loss=0.00146 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.112 | 4398.7 samples/s | 68.7 steps/s
[Step=33050 Epoch=315.0] | Loss=0.00117 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.112 | 1572.9 samples/s | 24.6 steps/s
[Step=33100 Epoch=315.5] | Loss=0.00098 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.112 | 4185.7 samples/s | 65.4 steps/s
[Step=33150 Epoch=315.9] | Loss=0.00085 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.112 | 1603.6 samples/s | 25.1 steps/s
[Step=33200 Epoch=316.4] | Loss=0.00074 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=3.112 | 3955.8 samples/s | 61.8 steps/s
[Step=33250 Epoch=316.9] | Loss=0.00067 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.113 | 1622.2 samples/s | 25.3 steps/s
[Step=33300 Epoch=317.4] | Loss=0.00060 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.113 | 3820.4 samples/s | 59.7 steps/s
[Step=33350 Epoch=317.9] | Loss=0.00055 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.113 | 1668.7 samples/s | 26.1 steps/s
[Step=33400 Epoch=318.3] | Loss=0.00051 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.113 | 3578.6 samples/s | 55.9 steps/s
[Step=33450 Epoch=318.8] | Loss=0.00047 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.113 | 1696.2 samples/s | 26.5 steps/s
[Step=33500 Epoch=319.3] | Loss=0.00044 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.113 | 3556.0 samples/s | 55.6 steps/s
[Step=33550 Epoch=319.8] | Loss=0.00041 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=3.113 | 1728.6 samples/s | 27.0 steps/s
[Step=33600 Epoch=320.2] | Loss=0.00038 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=3.113 | 3553.4 samples/s | 55.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19133 | acc=0.9063 | tpr=0.8719 | fpr=0.0188 | 3639.6 samples/s | 14.2 steps/s
Avg test loss: 0.19334, Avg test acc: 0.90496, Avg tpr: 0.87119, Avg fpr: 0.02077, total FA: 162

Testing server on iccad2012
[Step=  50] | Loss=0.53856 | acc=0.8613 | tpr=0.9646 | fpr=0.1405 | 3633.8 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.56091 | acc=0.8584 | tpr=0.9723 | fpr=0.1437 | 4806.5 samples/s | 18.8 steps/s
[Step= 150] | Loss=0.57427 | acc=0.8548 | tpr=0.9683 | fpr=0.1472 | 6861.3 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.57425 | acc=0.8562 | tpr=0.9694 | fpr=0.1458 | 6760.2 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.57117 | acc=0.8562 | tpr=0.9642 | fpr=0.1458 | 6753.2 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.57622 | acc=0.8557 | tpr=0.9644 | fpr=0.1463 | 5844.2 samples/s | 22.8 steps/s
[Step= 350] | Loss=0.57696 | acc=0.8562 | tpr=0.9656 | fpr=0.1457 | 6761.7 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.57768 | acc=0.8560 | tpr=0.9655 | fpr=0.1460 | 6712.9 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.58273 | acc=0.8556 | tpr=0.9649 | fpr=0.1463 | 6988.0 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.58268 | acc=0.8553 | tpr=0.9656 | fpr=0.1467 | 6666.7 samples/s | 26.0 steps/s
[Step= 550] | Loss=0.58202 | acc=0.8555 | tpr=0.9666 | fpr=0.1465 | 12783.8 samples/s | 49.9 steps/s
Avg test loss: 0.58187, Avg test acc: 0.85556, Avg tpr: 0.96672, Avg fpr: 0.14646, total FA: 20336

server round 42/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=163.8] | Loss=0.08467 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.123 | 3719.9 samples/s | 58.1 steps/s
[Step=33650 Epoch=164.1] | Loss=0.01825 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.312 | FP-Norm(final)=3.124 | 3584.6 samples/s | 56.0 steps/s
[Step=33700 Epoch=164.3] | Loss=0.01315 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=3.124 | 3786.8 samples/s | 59.2 steps/s
[Step=33750 Epoch=164.6] | Loss=0.01072 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.125 | 3784.1 samples/s | 59.1 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00907 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.126 | 4865.7 samples/s | 76.0 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00787 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.127 | 1623.4 samples/s | 25.4 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00695 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=3.128 | 3800.5 samples/s | 59.4 steps/s
[Step=33950 Epoch=165.5] | Loss=0.00657 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.128 | 3753.5 samples/s | 58.6 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00617 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.129 | 4562.5 samples/s | 71.3 steps/s
[Step=34050 Epoch=166.0] | Loss=0.00583 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.130 | 1651.3 samples/s | 25.8 steps/s
[Step=34100 Epoch=166.3] | Loss=0.00556 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.372 | FP-Norm(final)=3.131 | 3760.6 samples/s | 58.8 steps/s
[Step=34150 Epoch=166.5] | Loss=0.00525 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.131 | 3771.2 samples/s | 58.9 steps/s
[Step=34200 Epoch=166.8] | Loss=0.00506 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.371 | FP-Norm(final)=3.132 | 4289.1 samples/s | 67.0 steps/s
[Step=34250 Epoch=167.0] | Loss=0.00480 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.133 | 1689.7 samples/s | 26.4 steps/s
[Step=34300 Epoch=167.3] | Loss=0.00464 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.134 | 3785.0 samples/s | 59.1 steps/s
[Step=34350 Epoch=167.5] | Loss=0.00456 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.134 | 3782.7 samples/s | 59.1 steps/s
[Step=34400 Epoch=167.7] | Loss=0.00444 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.135 | 4075.1 samples/s | 63.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step34400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=164.0] | Loss=0.05363 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.123 | 3520.1 samples/s | 55.0 steps/s
[Step=33650 Epoch=164.2] | Loss=0.01684 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.312 | FP-Norm(final)=3.123 | 3817.0 samples/s | 59.6 steps/s
[Step=33700 Epoch=164.4] | Loss=0.01228 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=3.123 | 3804.0 samples/s | 59.4 steps/s
[Step=33750 Epoch=164.7] | Loss=0.00982 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.124 | 3764.5 samples/s | 58.8 steps/s
[Step=33800 Epoch=164.9] | Loss=0.00884 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.371 | FP-Norm(final)=3.125 | 4850.5 samples/s | 75.8 steps/s
[Step=33850 Epoch=165.2] | Loss=0.00772 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.125 | 1624.2 samples/s | 25.4 steps/s
[Step=33900 Epoch=165.4] | Loss=0.00677 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.126 | 3790.1 samples/s | 59.2 steps/s
[Step=33950 Epoch=165.7] | Loss=0.00616 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.127 | 3765.4 samples/s | 58.8 steps/s
[Step=34000 Epoch=165.9] | Loss=0.00573 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.128 | 4622.3 samples/s | 72.2 steps/s
[Step=34050 Epoch=166.1] | Loss=0.00543 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.128 | 1651.9 samples/s | 25.8 steps/s
[Step=34100 Epoch=166.4] | Loss=0.00510 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.129 | 3782.3 samples/s | 59.1 steps/s
[Step=34150 Epoch=166.6] | Loss=0.00478 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.130 | 3772.1 samples/s | 58.9 steps/s
[Step=34200 Epoch=166.9] | Loss=0.00470 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.131 | 4394.8 samples/s | 68.7 steps/s
[Step=34250 Epoch=167.1] | Loss=0.00459 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.375 | FP-Norm(final)=3.131 | 1677.7 samples/s | 26.2 steps/s
[Step=34300 Epoch=167.4] | Loss=0.00446 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.132 | 3775.8 samples/s | 59.0 steps/s
[Step=34350 Epoch=167.6] | Loss=0.00431 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.133 | 3775.7 samples/s | 59.0 steps/s
[Step=34400 Epoch=167.9] | Loss=0.00415 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.133 | 4197.3 samples/s | 65.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step34400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=163.7] | Loss=0.06160 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.123 | 3746.6 samples/s | 58.5 steps/s
[Step=33650 Epoch=164.0] | Loss=0.01780 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.287 | FP-Norm(final)=3.123 | 3600.7 samples/s | 56.3 steps/s
[Step=33700 Epoch=164.2] | Loss=0.01384 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.320 | FP-Norm(final)=3.124 | 3806.9 samples/s | 59.5 steps/s
[Step=33750 Epoch=164.4] | Loss=0.01103 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.337 | FP-Norm(final)=3.124 | 3776.1 samples/s | 59.0 steps/s
[Step=33800 Epoch=164.7] | Loss=0.00924 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.125 | 4853.3 samples/s | 75.8 steps/s
[Step=33850 Epoch=164.9] | Loss=0.00811 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.126 | 1619.6 samples/s | 25.3 steps/s
[Step=33900 Epoch=165.2] | Loss=0.00710 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.127 | 3773.9 samples/s | 59.0 steps/s
[Step=33950 Epoch=165.4] | Loss=0.00641 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.128 | 3770.2 samples/s | 58.9 steps/s
[Step=34000 Epoch=165.7] | Loss=0.00604 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.360 | FP-Norm(final)=3.129 | 4556.3 samples/s | 71.2 steps/s
[Step=34050 Epoch=165.9] | Loss=0.00561 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.130 | 1654.4 samples/s | 25.9 steps/s
[Step=34100 Epoch=166.2] | Loss=0.00525 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.131 | 3779.6 samples/s | 59.1 steps/s
[Step=34150 Epoch=166.4] | Loss=0.00504 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.131 | 3782.9 samples/s | 59.1 steps/s
[Step=34200 Epoch=166.6] | Loss=0.00483 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.132 | 4302.3 samples/s | 67.2 steps/s
[Step=34250 Epoch=166.9] | Loss=0.00459 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.133 | 1709.4 samples/s | 26.7 steps/s
[Step=34300 Epoch=167.1] | Loss=0.00440 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.134 | 3761.0 samples/s | 58.8 steps/s
[Step=34350 Epoch=167.4] | Loss=0.00427 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.135 | 3766.9 samples/s | 58.9 steps/s
[Step=34400 Epoch=167.6] | Loss=0.00416 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.136 | 4032.9 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step34400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=163.9] | Loss=0.08948 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.123 | 3723.9 samples/s | 58.2 steps/s
[Step=33650 Epoch=164.1] | Loss=0.01746 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.323 | FP-Norm(final)=3.123 | 3605.6 samples/s | 56.3 steps/s
[Step=33700 Epoch=164.3] | Loss=0.01112 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.347 | FP-Norm(final)=3.124 | 3744.7 samples/s | 58.5 steps/s
[Step=33750 Epoch=164.6] | Loss=0.00891 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.125 | 3765.6 samples/s | 58.8 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00780 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.126 | 4863.2 samples/s | 76.0 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00676 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.127 | 1621.5 samples/s | 25.3 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00603 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.127 | 3792.8 samples/s | 59.3 steps/s
[Step=33950 Epoch=165.6] | Loss=0.00553 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.128 | 3774.7 samples/s | 59.0 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00515 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.129 | 4556.1 samples/s | 71.2 steps/s
[Step=34050 Epoch=166.0] | Loss=0.00482 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.130 | 1651.7 samples/s | 25.8 steps/s
[Step=34100 Epoch=166.3] | Loss=0.00461 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.131 | 3769.5 samples/s | 58.9 steps/s
[Step=34150 Epoch=166.5] | Loss=0.00436 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.131 | 3763.0 samples/s | 58.8 steps/s
[Step=34200 Epoch=166.8] | Loss=0.00415 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.132 | 4290.4 samples/s | 67.0 steps/s
[Step=34250 Epoch=167.0] | Loss=0.00393 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.133 | 1705.7 samples/s | 26.7 steps/s
[Step=34300 Epoch=167.3] | Loss=0.00377 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.133 | 3783.3 samples/s | 59.1 steps/s
[Step=34350 Epoch=167.5] | Loss=0.00360 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.134 | 3798.5 samples/s | 59.4 steps/s
[Step=34400 Epoch=167.8] | Loss=0.00352 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.135 | 4063.6 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step34400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=164.8] | Loss=0.01127 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=3.123 | 3669.5 samples/s | 57.3 steps/s
[Step=33650 Epoch=165.0] | Loss=0.01775 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.317 | FP-Norm(final)=3.124 | 3638.8 samples/s | 56.9 steps/s
[Step=33700 Epoch=165.3] | Loss=0.01268 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.348 | FP-Norm(final)=3.124 | 3783.6 samples/s | 59.1 steps/s
[Step=33750 Epoch=165.5] | Loss=0.01020 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.125 | 3828.9 samples/s | 59.8 steps/s
[Step=33800 Epoch=165.7] | Loss=0.00866 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.126 | 4879.6 samples/s | 76.2 steps/s
[Step=33850 Epoch=166.0] | Loss=0.00755 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.126 | 1125.3 samples/s | 17.6 steps/s
[Step=33900 Epoch=166.2] | Loss=0.00673 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.127 | 3518.3 samples/s | 55.0 steps/s
[Step=33950 Epoch=166.5] | Loss=0.00608 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.128 | 3771.0 samples/s | 58.9 steps/s
[Step=34000 Epoch=166.7] | Loss=0.00568 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.364 | FP-Norm(final)=3.129 | 4723.5 samples/s | 73.8 steps/s
[Step=34050 Epoch=167.0] | Loss=0.00531 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.130 | 1604.9 samples/s | 25.1 steps/s
[Step=34100 Epoch=167.2] | Loss=0.00497 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.130 | 3756.1 samples/s | 58.7 steps/s
[Step=34150 Epoch=167.5] | Loss=0.00476 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.362 | FP-Norm(final)=3.131 | 3764.3 samples/s | 58.8 steps/s
[Step=34200 Epoch=167.7] | Loss=0.00451 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.132 | 4505.7 samples/s | 70.4 steps/s
[Step=34250 Epoch=168.0] | Loss=0.00429 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.133 | 1665.7 samples/s | 26.0 steps/s
[Step=34300 Epoch=168.2] | Loss=0.00415 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.133 | 3754.2 samples/s | 58.7 steps/s
[Step=34350 Epoch=168.4] | Loss=0.00396 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.134 | 3765.1 samples/s | 58.8 steps/s
[Step=34400 Epoch=168.7] | Loss=0.00390 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.135 | 4354.7 samples/s | 68.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step34400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=318.4] | Loss=0.01561 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.123 | 3706.9 samples/s | 57.9 steps/s
[Step=33650 Epoch=318.9] | Loss=0.00654 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=3.123 | 3220.7 samples/s | 50.3 steps/s
[Step=33700 Epoch=319.3] | Loss=0.00333 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=3.123 | 4622.8 samples/s | 72.2 steps/s
[Step=33750 Epoch=319.8] | Loss=0.00224 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.124 | 1538.1 samples/s | 24.0 steps/s
[Step=33800 Epoch=320.3] | Loss=0.00169 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=3.124 | 4335.0 samples/s | 67.7 steps/s
[Step=33850 Epoch=320.8] | Loss=0.00136 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.124 | 1578.5 samples/s | 24.7 steps/s
[Step=33900 Epoch=321.2] | Loss=0.00114 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=3.124 | 4055.1 samples/s | 63.4 steps/s
[Step=33950 Epoch=321.7] | Loss=0.00098 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=3.124 | 1622.9 samples/s | 25.4 steps/s
[Step=34000 Epoch=322.2] | Loss=0.00086 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.124 | 3852.4 samples/s | 60.2 steps/s
[Step=34050 Epoch=322.7] | Loss=0.00077 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.124 | 1676.3 samples/s | 26.2 steps/s
[Step=34100 Epoch=323.1] | Loss=0.00070 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.124 | 3585.1 samples/s | 56.0 steps/s
[Step=34150 Epoch=323.6] | Loss=0.00064 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.125 | 1703.0 samples/s | 26.6 steps/s
[Step=34200 Epoch=324.1] | Loss=0.00058 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.125 | 3574.9 samples/s | 55.9 steps/s
[Step=34250 Epoch=324.5] | Loss=0.00054 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.125 | 1710.6 samples/s | 26.7 steps/s
[Step=34300 Epoch=325.0] | Loss=0.00050 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.125 | 3573.5 samples/s | 55.8 steps/s
[Step=34350 Epoch=325.5] | Loss=0.00047 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.125 | 1726.0 samples/s | 27.0 steps/s
[Step=34400 Epoch=326.0] | Loss=0.00044 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.125 | 3556.0 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step34400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=319.6] | Loss=0.09011 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.123 | 3411.0 samples/s | 53.3 steps/s
[Step=33650 Epoch=320.1] | Loss=0.00691 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=3.123 | 3460.2 samples/s | 54.1 steps/s
[Step=33700 Epoch=320.6] | Loss=0.00348 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=3.123 | 4652.5 samples/s | 72.7 steps/s
[Step=33750 Epoch=321.0] | Loss=0.00233 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=3.123 | 1549.0 samples/s | 24.2 steps/s
[Step=33800 Epoch=321.5] | Loss=0.00175 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.413 | FP-Norm(final)=3.124 | 4368.6 samples/s | 68.3 steps/s
[Step=33850 Epoch=322.0] | Loss=0.00141 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.124 | 1573.4 samples/s | 24.6 steps/s
[Step=33900 Epoch=322.5] | Loss=0.00118 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=3.124 | 4064.2 samples/s | 63.5 steps/s
[Step=33950 Epoch=322.9] | Loss=0.00101 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=3.124 | 1622.0 samples/s | 25.3 steps/s
[Step=34000 Epoch=323.4] | Loss=0.00089 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=3.124 | 3864.7 samples/s | 60.4 steps/s
[Step=34050 Epoch=323.9] | Loss=0.00079 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.124 | 1654.7 samples/s | 25.9 steps/s
[Step=34100 Epoch=324.4] | Loss=0.00072 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.124 | 3665.0 samples/s | 57.3 steps/s
[Step=34150 Epoch=324.9] | Loss=0.00065 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.124 | 1700.2 samples/s | 26.6 steps/s
[Step=34200 Epoch=325.3] | Loss=0.00060 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.124 | 3588.1 samples/s | 56.1 steps/s
[Step=34250 Epoch=325.8] | Loss=0.00055 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.124 | 1710.1 samples/s | 26.7 steps/s
[Step=34300 Epoch=326.3] | Loss=0.00051 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.124 | 3486.0 samples/s | 54.5 steps/s
[Step=34350 Epoch=326.8] | Loss=0.00048 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.124 | 1722.8 samples/s | 26.9 steps/s
[Step=34400 Epoch=327.2] | Loss=0.00045 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.124 | 3545.8 samples/s | 55.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step34400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=320.9] | Loss=0.11122 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.123 | 3541.0 samples/s | 55.3 steps/s
[Step=33650 Epoch=321.3] | Loss=0.00861 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=3.122 | 3328.3 samples/s | 52.0 steps/s
[Step=33700 Epoch=321.8] | Loss=0.00433 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=3.123 | 4709.1 samples/s | 73.6 steps/s
[Step=33750 Epoch=322.3] | Loss=0.00290 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.419 | FP-Norm(final)=3.123 | 1541.6 samples/s | 24.1 steps/s
[Step=33800 Epoch=322.8] | Loss=0.00218 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=3.123 | 4380.9 samples/s | 68.5 steps/s
[Step=33850 Epoch=323.2] | Loss=0.00175 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.123 | 1551.6 samples/s | 24.2 steps/s
[Step=33900 Epoch=323.7] | Loss=0.00146 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=3.123 | 4182.2 samples/s | 65.3 steps/s
[Step=33950 Epoch=324.2] | Loss=0.00126 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=3.123 | 1599.9 samples/s | 25.0 steps/s
[Step=34000 Epoch=324.7] | Loss=0.00110 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=3.123 | 3979.3 samples/s | 62.2 steps/s
[Step=34050 Epoch=325.2] | Loss=0.00098 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=3.123 | 1647.4 samples/s | 25.7 steps/s
[Step=34100 Epoch=325.6] | Loss=0.00089 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.123 | 3780.7 samples/s | 59.1 steps/s
[Step=34150 Epoch=326.1] | Loss=0.00081 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.123 | 1655.0 samples/s | 25.9 steps/s
[Step=34200 Epoch=326.6] | Loss=0.00074 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.123 | 3639.0 samples/s | 56.9 steps/s
[Step=34250 Epoch=327.1] | Loss=0.00069 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.123 | 1687.8 samples/s | 26.4 steps/s
[Step=34300 Epoch=327.5] | Loss=0.00064 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=3.123 | 3591.3 samples/s | 56.1 steps/s
[Step=34350 Epoch=328.0] | Loss=0.00060 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.123 | 1715.0 samples/s | 26.8 steps/s
[Step=34400 Epoch=328.5] | Loss=0.00056 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.123 | 3601.7 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step34400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=316.6] | Loss=0.01052 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.123 | 3472.9 samples/s | 54.3 steps/s
[Step=33650 Epoch=317.1] | Loss=0.00601 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.124 | 3413.1 samples/s | 53.3 steps/s
[Step=33700 Epoch=317.6] | Loss=0.00313 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.124 | 4621.9 samples/s | 72.2 steps/s
[Step=33750 Epoch=318.0] | Loss=0.00210 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.125 | 1556.2 samples/s | 24.3 steps/s
[Step=33800 Epoch=318.5] | Loss=0.00158 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.125 | 4236.3 samples/s | 66.2 steps/s
[Step=33850 Epoch=319.0] | Loss=0.00127 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.125 | 1598.0 samples/s | 25.0 steps/s
[Step=33900 Epoch=319.4] | Loss=0.00107 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.125 | 3943.2 samples/s | 61.6 steps/s
[Step=33950 Epoch=319.9] | Loss=0.00092 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.125 | 1646.0 samples/s | 25.7 steps/s
[Step=34000 Epoch=320.4] | Loss=0.00081 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.125 | 3644.5 samples/s | 56.9 steps/s
[Step=34050 Epoch=320.8] | Loss=0.00072 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.125 | 1675.8 samples/s | 26.2 steps/s
[Step=34100 Epoch=321.3] | Loss=0.00065 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.125 | 3598.7 samples/s | 56.2 steps/s
[Step=34150 Epoch=321.8] | Loss=0.00059 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.125 | 1693.4 samples/s | 26.5 steps/s
[Step=34200 Epoch=322.3] | Loss=0.00055 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=3.125 | 3574.4 samples/s | 55.8 steps/s
[Step=34250 Epoch=322.7] | Loss=0.00050 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.125 | 1730.7 samples/s | 27.0 steps/s
[Step=34300 Epoch=323.2] | Loss=0.00047 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.125 | 3539.4 samples/s | 55.3 steps/s
[Step=34350 Epoch=323.7] | Loss=0.00044 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=3.125 | 1757.4 samples/s | 27.5 steps/s
[Step=34400 Epoch=324.1] | Loss=0.00041 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=3.126 | 3372.8 samples/s | 52.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step34400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=320.2] | Loss=0.01596 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.123 | 3689.5 samples/s | 57.6 steps/s
[Step=33650 Epoch=320.7] | Loss=0.00563 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.124 | 3199.1 samples/s | 50.0 steps/s
[Step=33700 Epoch=321.2] | Loss=0.00284 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=3.124 | 4641.5 samples/s | 72.5 steps/s
[Step=33750 Epoch=321.7] | Loss=0.00191 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=3.124 | 1530.3 samples/s | 23.9 steps/s
[Step=33800 Epoch=322.1] | Loss=0.00144 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.436 | FP-Norm(final)=3.124 | 4414.2 samples/s | 69.0 steps/s
[Step=33850 Epoch=322.6] | Loss=0.00116 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=3.125 | 1576.8 samples/s | 24.6 steps/s
[Step=33900 Epoch=323.1] | Loss=0.00097 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=3.125 | 4169.8 samples/s | 65.2 steps/s
[Step=33950 Epoch=323.6] | Loss=0.00083 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=3.125 | 1601.7 samples/s | 25.0 steps/s
[Step=34000 Epoch=324.1] | Loss=0.00073 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=3.125 | 3927.9 samples/s | 61.4 steps/s
[Step=34050 Epoch=324.5] | Loss=0.00065 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.125 | 1635.5 samples/s | 25.6 steps/s
[Step=34100 Epoch=325.0] | Loss=0.00059 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=3.125 | 3785.0 samples/s | 59.1 steps/s
[Step=34150 Epoch=325.5] | Loss=0.00054 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=3.125 | 1674.2 samples/s | 26.2 steps/s
[Step=34200 Epoch=326.0] | Loss=0.00050 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.125 | 3629.1 samples/s | 56.7 steps/s
[Step=34250 Epoch=326.4] | Loss=0.00046 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.125 | 1682.5 samples/s | 26.3 steps/s
[Step=34300 Epoch=326.9] | Loss=0.00043 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.125 | 3610.1 samples/s | 56.4 steps/s
[Step=34350 Epoch=327.4] | Loss=0.00040 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.125 | 1696.6 samples/s | 26.5 steps/s
[Step=34400 Epoch=327.9] | Loss=0.00038 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.125 | 3616.9 samples/s | 56.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19241 | acc=0.9062 | tpr=0.8721 | fpr=0.0198 | 3615.3 samples/s | 14.1 steps/s
Avg test loss: 0.19427, Avg test acc: 0.90520, Avg tpr: 0.87195, Avg fpr: 0.02166, total FA: 169

Testing server on iccad2012
[Step=  50] | Loss=0.54123 | acc=0.8630 | tpr=0.9690 | fpr=0.1389 | 3616.0 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.56365 | acc=0.8604 | tpr=0.9744 | fpr=0.1417 | 6911.3 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.57688 | acc=0.8564 | tpr=0.9697 | fpr=0.1457 | 6829.8 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.57701 | acc=0.8578 | tpr=0.9705 | fpr=0.1442 | 6775.5 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.57387 | acc=0.8577 | tpr=0.9651 | fpr=0.1442 | 6814.8 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.57905 | acc=0.8573 | tpr=0.9651 | fpr=0.1447 | 6793.9 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.57982 | acc=0.8576 | tpr=0.9656 | fpr=0.1443 | 6999.7 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.58061 | acc=0.8574 | tpr=0.9655 | fpr=0.1446 | 6676.5 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.58570 | acc=0.8570 | tpr=0.9654 | fpr=0.1450 | 6791.2 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.58568 | acc=0.8567 | tpr=0.9661 | fpr=0.1453 | 6619.0 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.58501 | acc=0.8570 | tpr=0.9670 | fpr=0.1450 | 12804.3 samples/s | 50.0 steps/s
Avg test loss: 0.58481, Avg test acc: 0.85701, Avg tpr: 0.96712, Avg fpr: 0.14499, total FA: 20132

server round 43/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.7] | Loss=0.02151 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.135 | 3655.3 samples/s | 57.1 steps/s
[Step=34450 Epoch=168.0] | Loss=0.01790 | Reg=0.00010 | acc=0.9688 | FP-Norm=0.298 | FP-Norm(final)=3.136 | 3617.8 samples/s | 56.5 steps/s
[Step=34500 Epoch=168.2] | Loss=0.01179 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.137 | 3761.9 samples/s | 58.8 steps/s
[Step=34550 Epoch=168.5] | Loss=0.01007 | Reg=0.00013 | acc=0.9688 | FP-Norm=0.357 | FP-Norm(final)=3.137 | 3788.8 samples/s | 59.2 steps/s
[Step=34600 Epoch=168.7] | Loss=0.00887 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.138 | 4816.6 samples/s | 75.3 steps/s
[Step=34650 Epoch=169.0] | Loss=0.00782 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.138 | 1626.7 samples/s | 25.4 steps/s
[Step=34700 Epoch=169.2] | Loss=0.00700 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.369 | FP-Norm(final)=3.139 | 3735.9 samples/s | 58.4 steps/s
[Step=34750 Epoch=169.4] | Loss=0.00649 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.140 | 3678.4 samples/s | 57.5 steps/s
[Step=34800 Epoch=169.7] | Loss=0.00613 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.140 | 4386.5 samples/s | 68.5 steps/s
[Step=34850 Epoch=169.9] | Loss=0.00571 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.141 | 1580.5 samples/s | 24.7 steps/s
[Step=34900 Epoch=170.2] | Loss=0.00539 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.141 | 3387.1 samples/s | 52.9 steps/s
[Step=34950 Epoch=170.4] | Loss=0.00509 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.142 | 3648.2 samples/s | 57.0 steps/s
[Step=35000 Epoch=170.7] | Loss=0.00499 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.143 | 4191.6 samples/s | 65.5 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00478 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.143 | 1663.1 samples/s | 26.0 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00456 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.144 | 3654.4 samples/s | 57.1 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00446 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.145 | 3671.7 samples/s | 57.4 steps/s
[Step=35200 Epoch=171.6] | Loss=0.00433 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.145 | 3983.1 samples/s | 62.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step35200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.9] | Loss=0.03142 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.135 | 3728.3 samples/s | 58.3 steps/s
[Step=34450 Epoch=168.1] | Loss=0.02168 | Reg=0.00013 | acc=0.9688 | FP-Norm=0.340 | FP-Norm(final)=3.135 | 3504.6 samples/s | 54.8 steps/s
[Step=34500 Epoch=168.3] | Loss=0.01331 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.135 | 3677.4 samples/s | 57.5 steps/s
[Step=34550 Epoch=168.6] | Loss=0.01012 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.136 | 3656.0 samples/s | 57.1 steps/s
[Step=34600 Epoch=168.8] | Loss=0.00913 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.137 | 4748.0 samples/s | 74.2 steps/s
[Step=34650 Epoch=169.1] | Loss=0.00794 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.137 | 1604.9 samples/s | 25.1 steps/s
[Step=34700 Epoch=169.3] | Loss=0.00707 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.138 | 3771.9 samples/s | 58.9 steps/s
[Step=34750 Epoch=169.6] | Loss=0.00655 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.139 | 3703.6 samples/s | 57.9 steps/s
[Step=34800 Epoch=169.8] | Loss=0.00608 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.139 | 4581.8 samples/s | 71.6 steps/s
[Step=34850 Epoch=170.1] | Loss=0.00561 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.140 | 1629.2 samples/s | 25.5 steps/s
[Step=34900 Epoch=170.3] | Loss=0.00532 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.141 | 3823.1 samples/s | 59.7 steps/s
[Step=34950 Epoch=170.5] | Loss=0.00509 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.141 | 3870.1 samples/s | 60.5 steps/s
[Step=35000 Epoch=170.8] | Loss=0.00495 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.142 | 4511.3 samples/s | 70.5 steps/s
[Step=35050 Epoch=171.0] | Loss=0.00474 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.143 | 1693.7 samples/s | 26.5 steps/s
[Step=35100 Epoch=171.3] | Loss=0.00456 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.373 | FP-Norm(final)=3.143 | 3638.0 samples/s | 56.8 steps/s
[Step=35150 Epoch=171.5] | Loss=0.00441 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.144 | 3640.9 samples/s | 56.9 steps/s
[Step=35200 Epoch=171.8] | Loss=0.00430 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.144 | 4084.5 samples/s | 63.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step35200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.6] | Loss=0.01889 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.135 | 3746.9 samples/s | 58.5 steps/s
[Step=34450 Epoch=167.9] | Loss=0.01980 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.304 | FP-Norm(final)=3.135 | 3502.7 samples/s | 54.7 steps/s
[Step=34500 Epoch=168.1] | Loss=0.01359 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=3.135 | 3776.5 samples/s | 59.0 steps/s
[Step=34550 Epoch=168.3] | Loss=0.01084 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.135 | 3758.7 samples/s | 58.7 steps/s
[Step=34600 Epoch=168.6] | Loss=0.00941 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.136 | 4842.2 samples/s | 75.7 steps/s
[Step=34650 Epoch=168.8] | Loss=0.00839 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.357 | FP-Norm(final)=3.137 | 1623.7 samples/s | 25.4 steps/s
[Step=34700 Epoch=169.1] | Loss=0.00754 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.138 | 3745.0 samples/s | 58.5 steps/s
[Step=34750 Epoch=169.3] | Loss=0.00690 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.138 | 3757.9 samples/s | 58.7 steps/s
[Step=34800 Epoch=169.6] | Loss=0.00634 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.139 | 4540.2 samples/s | 70.9 steps/s
[Step=34850 Epoch=169.8] | Loss=0.00585 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.140 | 1664.9 samples/s | 26.0 steps/s
[Step=34900 Epoch=170.0] | Loss=0.00548 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.141 | 3776.7 samples/s | 59.0 steps/s
[Step=34950 Epoch=170.3] | Loss=0.00521 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.142 | 3785.0 samples/s | 59.1 steps/s
[Step=35000 Epoch=170.5] | Loss=0.00497 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.142 | 4316.8 samples/s | 67.5 steps/s
[Step=35050 Epoch=170.8] | Loss=0.00474 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.143 | 1691.7 samples/s | 26.4 steps/s
[Step=35100 Epoch=171.0] | Loss=0.00457 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.144 | 3754.3 samples/s | 58.7 steps/s
[Step=35150 Epoch=171.3] | Loss=0.00445 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.145 | 3784.2 samples/s | 59.1 steps/s
[Step=35200 Epoch=171.5] | Loss=0.00427 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.146 | 4025.5 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step35200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.8] | Loss=0.03975 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.135 | 4021.6 samples/s | 62.8 steps/s
[Step=34450 Epoch=168.0] | Loss=0.01715 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=3.136 | 3383.7 samples/s | 52.9 steps/s
[Step=34500 Epoch=168.2] | Loss=0.01162 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.136 | 3777.1 samples/s | 59.0 steps/s
[Step=34550 Epoch=168.5] | Loss=0.00952 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.137 | 3792.7 samples/s | 59.3 steps/s
[Step=34600 Epoch=168.7] | Loss=0.00814 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.137 | 4835.8 samples/s | 75.6 steps/s
[Step=34650 Epoch=169.0] | Loss=0.00702 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.138 | 1621.3 samples/s | 25.3 steps/s
[Step=34700 Epoch=169.2] | Loss=0.00623 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.139 | 3746.4 samples/s | 58.5 steps/s
[Step=34750 Epoch=169.5] | Loss=0.00580 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.140 | 3770.2 samples/s | 58.9 steps/s
[Step=34800 Epoch=169.7] | Loss=0.00530 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.140 | 4576.8 samples/s | 71.5 steps/s
[Step=34850 Epoch=169.9] | Loss=0.00491 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.141 | 1663.7 samples/s | 26.0 steps/s
[Step=34900 Epoch=170.2] | Loss=0.00455 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.142 | 3764.9 samples/s | 58.8 steps/s
[Step=34950 Epoch=170.4] | Loss=0.00440 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.143 | 3764.4 samples/s | 58.8 steps/s
[Step=35000 Epoch=170.7] | Loss=0.00423 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.143 | 4315.1 samples/s | 67.4 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00402 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.144 | 1685.4 samples/s | 26.3 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00388 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.144 | 3777.7 samples/s | 59.0 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00377 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.145 | 3758.2 samples/s | 58.7 steps/s
[Step=35200 Epoch=171.7] | Loss=0.00365 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.146 | 4065.2 samples/s | 63.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step35200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=168.7] | Loss=0.13070 | Reg=0.00000 | acc=0.8906 | FP-Norm=0.000 | FP-Norm(final)=3.135 | 3681.5 samples/s | 57.5 steps/s
[Step=34450 Epoch=168.9] | Loss=0.01743 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.312 | FP-Norm(final)=3.136 | 3649.6 samples/s | 57.0 steps/s
[Step=34500 Epoch=169.2] | Loss=0.01183 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.334 | FP-Norm(final)=3.136 | 3753.4 samples/s | 58.6 steps/s
[Step=34550 Epoch=169.4] | Loss=0.00993 | Reg=0.00012 | acc=0.9688 | FP-Norm=0.345 | FP-Norm(final)=3.137 | 3779.2 samples/s | 59.0 steps/s
[Step=34600 Epoch=169.7] | Loss=0.00815 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.138 | 4891.4 samples/s | 76.4 steps/s
[Step=34650 Epoch=169.9] | Loss=0.00700 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.138 | 1617.0 samples/s | 25.3 steps/s
[Step=34700 Epoch=170.2] | Loss=0.00629 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=3.139 | 3789.5 samples/s | 59.2 steps/s
[Step=34750 Epoch=170.4] | Loss=0.00580 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=3.140 | 3745.3 samples/s | 58.5 steps/s
[Step=34800 Epoch=170.7] | Loss=0.00542 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.141 | 4683.3 samples/s | 73.2 steps/s
[Step=34850 Epoch=170.9] | Loss=0.00506 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.348 | FP-Norm(final)=3.141 | 1634.1 samples/s | 25.5 steps/s
[Step=34900 Epoch=171.1] | Loss=0.00481 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.142 | 3777.2 samples/s | 59.0 steps/s
[Step=34950 Epoch=171.4] | Loss=0.00451 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.143 | 3771.6 samples/s | 58.9 steps/s
[Step=35000 Epoch=171.6] | Loss=0.00435 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.143 | 4506.9 samples/s | 70.4 steps/s
[Step=35050 Epoch=171.9] | Loss=0.00416 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.144 | 1656.7 samples/s | 25.9 steps/s
[Step=35100 Epoch=172.1] | Loss=0.00399 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.145 | 3770.7 samples/s | 58.9 steps/s
[Step=35150 Epoch=172.4] | Loss=0.00383 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.145 | 3762.6 samples/s | 58.8 steps/s
[Step=35200 Epoch=172.6] | Loss=0.00377 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.346 | FP-Norm(final)=3.146 | 4343.9 samples/s | 67.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step35200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=326.0] | Loss=0.03866 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.135 | 3648.1 samples/s | 57.0 steps/s
[Step=34450 Epoch=326.4] | Loss=0.00491 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.137 | 3380.1 samples/s | 52.8 steps/s
[Step=34500 Epoch=326.9] | Loss=0.00254 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.137 | 4708.4 samples/s | 73.6 steps/s
[Step=34550 Epoch=327.4] | Loss=0.00171 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=3.138 | 1549.9 samples/s | 24.2 steps/s
[Step=34600 Epoch=327.9] | Loss=0.00129 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.138 | 4318.9 samples/s | 67.5 steps/s
[Step=34650 Epoch=328.3] | Loss=0.00104 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.138 | 1595.5 samples/s | 24.9 steps/s
[Step=34700 Epoch=328.8] | Loss=0.00087 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=3.138 | 4010.9 samples/s | 62.7 steps/s
[Step=34750 Epoch=329.3] | Loss=0.00075 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=3.138 | 1611.7 samples/s | 25.2 steps/s
[Step=34800 Epoch=329.8] | Loss=0.00066 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=3.138 | 3849.6 samples/s | 60.1 steps/s
[Step=34850 Epoch=330.2] | Loss=0.00059 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.138 | 1659.5 samples/s | 25.9 steps/s
[Step=34900 Epoch=330.7] | Loss=0.00053 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.138 | 3615.3 samples/s | 56.5 steps/s
[Step=34950 Epoch=331.2] | Loss=0.00049 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.138 | 1689.7 samples/s | 26.4 steps/s
[Step=35000 Epoch=331.7] | Loss=0.00045 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.138 | 3569.7 samples/s | 55.8 steps/s
[Step=35050 Epoch=332.1] | Loss=0.00041 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=3.138 | 1706.0 samples/s | 26.7 steps/s
[Step=35100 Epoch=332.6] | Loss=0.00039 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.139 | 3573.9 samples/s | 55.8 steps/s
[Step=35150 Epoch=333.1] | Loss=0.00036 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.139 | 1730.1 samples/s | 27.0 steps/s
[Step=35200 Epoch=333.6] | Loss=0.00034 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.139 | 3557.2 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step35200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=327.2] | Loss=0.02941 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.135 | 3545.2 samples/s | 55.4 steps/s
[Step=34450 Epoch=327.7] | Loss=0.00478 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=3.135 | 3318.8 samples/s | 51.9 steps/s
[Step=34500 Epoch=328.2] | Loss=0.00242 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.136 | 4665.3 samples/s | 72.9 steps/s
[Step=34550 Epoch=328.7] | Loss=0.00162 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.136 | 1549.7 samples/s | 24.2 steps/s
[Step=34600 Epoch=329.1] | Loss=0.00122 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=3.136 | 4376.0 samples/s | 68.4 steps/s
[Step=34650 Epoch=329.6] | Loss=0.00098 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.136 | 1587.9 samples/s | 24.8 steps/s
[Step=34700 Epoch=330.1] | Loss=0.00082 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.136 | 4083.4 samples/s | 63.8 steps/s
[Step=34750 Epoch=330.6] | Loss=0.00071 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.136 | 1624.7 samples/s | 25.4 steps/s
[Step=34800 Epoch=331.0] | Loss=0.00062 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.136 | 3849.3 samples/s | 60.1 steps/s
[Step=34850 Epoch=331.5] | Loss=0.00055 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.136 | 1663.5 samples/s | 26.0 steps/s
[Step=34900 Epoch=332.0] | Loss=0.00050 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=3.136 | 3636.8 samples/s | 56.8 steps/s
[Step=34950 Epoch=332.5] | Loss=0.00046 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=3.136 | 1699.4 samples/s | 26.6 steps/s
[Step=35000 Epoch=332.9] | Loss=0.00042 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=3.136 | 3599.6 samples/s | 56.2 steps/s
[Step=35050 Epoch=333.4] | Loss=0.00039 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.328 | FP-Norm(final)=3.136 | 1713.7 samples/s | 26.8 steps/s
[Step=35100 Epoch=333.9] | Loss=0.00036 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.325 | FP-Norm(final)=3.137 | 3583.2 samples/s | 56.0 steps/s
[Step=35150 Epoch=334.4] | Loss=0.00034 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.322 | FP-Norm(final)=3.137 | 1748.9 samples/s | 27.3 steps/s
[Step=35200 Epoch=334.8] | Loss=0.00032 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.320 | FP-Norm(final)=3.137 | 3607.5 samples/s | 56.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step35200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=328.5] | Loss=0.12229 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.135 | 3779.2 samples/s | 59.0 steps/s
[Step=34450 Epoch=329.0] | Loss=0.00733 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.135 | 3130.7 samples/s | 48.9 steps/s
[Step=34500 Epoch=329.5] | Loss=0.00370 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=3.135 | 4705.6 samples/s | 73.5 steps/s
[Step=34550 Epoch=329.9] | Loss=0.00248 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=3.135 | 1524.8 samples/s | 23.8 steps/s
[Step=34600 Epoch=330.4] | Loss=0.00186 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.135 | 4422.3 samples/s | 69.1 steps/s
[Step=34650 Epoch=330.9] | Loss=0.00150 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=3.136 | 1572.4 samples/s | 24.6 steps/s
[Step=34700 Epoch=331.4] | Loss=0.00125 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.136 | 4170.9 samples/s | 65.2 steps/s
[Step=34750 Epoch=331.8] | Loss=0.00108 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=3.136 | 1600.1 samples/s | 25.0 steps/s
[Step=34800 Epoch=332.3] | Loss=0.00094 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=3.136 | 3961.7 samples/s | 61.9 steps/s
[Step=34850 Epoch=332.8] | Loss=0.00084 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=3.136 | 1659.7 samples/s | 25.9 steps/s
[Step=34900 Epoch=333.3] | Loss=0.00076 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.136 | 3806.3 samples/s | 59.5 steps/s
[Step=34950 Epoch=333.8] | Loss=0.00069 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.136 | 1664.3 samples/s | 26.0 steps/s
[Step=35000 Epoch=334.2] | Loss=0.00064 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.136 | 3626.8 samples/s | 56.7 steps/s
[Step=35050 Epoch=334.7] | Loss=0.00059 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.136 | 1694.4 samples/s | 26.5 steps/s
[Step=35100 Epoch=335.2] | Loss=0.00055 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.136 | 3556.4 samples/s | 55.6 steps/s
[Step=35150 Epoch=335.7] | Loss=0.00051 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=3.136 | 1688.3 samples/s | 26.4 steps/s
[Step=35200 Epoch=336.1] | Loss=0.00048 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.136 | 3585.8 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step35200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=324.2] | Loss=0.11670 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.135 | 3896.5 samples/s | 60.9 steps/s
[Step=34450 Epoch=324.6] | Loss=0.00633 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.135 | 3164.9 samples/s | 49.5 steps/s
[Step=34500 Epoch=325.1] | Loss=0.00320 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.135 | 4618.0 samples/s | 72.2 steps/s
[Step=34550 Epoch=325.6] | Loss=0.00214 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.135 | 1558.4 samples/s | 24.4 steps/s
[Step=34600 Epoch=326.0] | Loss=0.00161 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.135 | 4239.3 samples/s | 66.2 steps/s
[Step=34650 Epoch=326.5] | Loss=0.00130 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.135 | 1584.2 samples/s | 24.8 steps/s
[Step=34700 Epoch=327.0] | Loss=0.00109 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.135 | 3963.2 samples/s | 61.9 steps/s
[Step=34750 Epoch=327.4] | Loss=0.00093 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.135 | 1642.7 samples/s | 25.7 steps/s
[Step=34800 Epoch=327.9] | Loss=0.00082 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.135 | 3687.0 samples/s | 57.6 steps/s
[Step=34850 Epoch=328.4] | Loss=0.00073 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=3.135 | 1667.5 samples/s | 26.1 steps/s
[Step=34900 Epoch=328.9] | Loss=0.00066 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.135 | 3603.9 samples/s | 56.3 steps/s
[Step=34950 Epoch=329.3] | Loss=0.00060 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.136 | 1710.0 samples/s | 26.7 steps/s
[Step=35000 Epoch=329.8] | Loss=0.00055 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=3.136 | 3559.4 samples/s | 55.6 steps/s
[Step=35050 Epoch=330.3] | Loss=0.00051 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=3.136 | 1716.8 samples/s | 26.8 steps/s
[Step=35100 Epoch=330.7] | Loss=0.00048 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=3.136 | 3559.4 samples/s | 55.6 steps/s
[Step=35150 Epoch=331.2] | Loss=0.00045 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.331 | FP-Norm(final)=3.136 | 1845.4 samples/s | 28.8 steps/s
[Step=35200 Epoch=331.7] | Loss=0.00042 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.329 | FP-Norm(final)=3.136 | 3166.5 samples/s | 49.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step35200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=327.9] | Loss=0.11297 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.135 | 3906.5 samples/s | 61.0 steps/s
[Step=34450 Epoch=328.3] | Loss=0.00761 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.135 | 3137.4 samples/s | 49.0 steps/s
[Step=34500 Epoch=328.8] | Loss=0.00383 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.135 | 4693.8 samples/s | 73.3 steps/s
[Step=34550 Epoch=329.3] | Loss=0.00257 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.135 | 1540.4 samples/s | 24.1 steps/s
[Step=34600 Epoch=329.8] | Loss=0.00193 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=3.135 | 4414.7 samples/s | 69.0 steps/s
[Step=34650 Epoch=330.2] | Loss=0.00155 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=3.135 | 1556.3 samples/s | 24.3 steps/s
[Step=34700 Epoch=330.7] | Loss=0.00130 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=3.136 | 4185.3 samples/s | 65.4 steps/s
[Step=34750 Epoch=331.2] | Loss=0.00112 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=3.136 | 1592.1 samples/s | 24.9 steps/s
[Step=34800 Epoch=331.7] | Loss=0.00098 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.136 | 3965.8 samples/s | 62.0 steps/s
[Step=34850 Epoch=332.2] | Loss=0.00087 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.136 | 1625.1 samples/s | 25.4 steps/s
[Step=34900 Epoch=332.6] | Loss=0.00079 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.136 | 3810.9 samples/s | 59.5 steps/s
[Step=34950 Epoch=333.1] | Loss=0.00072 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.136 | 1655.3 samples/s | 25.9 steps/s
[Step=35000 Epoch=333.6] | Loss=0.00066 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.136 | 3604.3 samples/s | 56.3 steps/s
[Step=35050 Epoch=334.1] | Loss=0.00061 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.136 | 1696.4 samples/s | 26.5 steps/s
[Step=35100 Epoch=334.5] | Loss=0.00057 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.136 | 3570.8 samples/s | 55.8 steps/s
[Step=35150 Epoch=335.0] | Loss=0.00053 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.136 | 1716.4 samples/s | 26.8 steps/s
[Step=35200 Epoch=335.5] | Loss=0.00050 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.136 | 3578.7 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19019 | acc=0.9086 | tpr=0.8756 | fpr=0.0198 | 3655.8 samples/s | 14.3 steps/s
Avg test loss: 0.19219, Avg test acc: 0.90720, Avg tpr: 0.87475, Avg fpr: 0.02141, total FA: 167

Testing server on iccad2012
[Step=  50] | Loss=0.55514 | acc=0.8603 | tpr=0.9690 | fpr=0.1416 | 3623.6 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.57712 | acc=0.8580 | tpr=0.9744 | fpr=0.1442 | 6841.2 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.59068 | acc=0.8542 | tpr=0.9697 | fpr=0.1479 | 6932.7 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.59075 | acc=0.8557 | tpr=0.9705 | fpr=0.1464 | 6784.1 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.58750 | acc=0.8557 | tpr=0.9651 | fpr=0.1463 | 6887.4 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.59277 | acc=0.8552 | tpr=0.9651 | fpr=0.1468 | 6649.1 samples/s | 26.0 steps/s
[Step= 350] | Loss=0.59358 | acc=0.8556 | tpr=0.9656 | fpr=0.1464 | 6832.5 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.59431 | acc=0.8554 | tpr=0.9655 | fpr=0.1466 | 6936.9 samples/s | 27.1 steps/s
[Step= 450] | Loss=0.59959 | acc=0.8550 | tpr=0.9654 | fpr=0.1470 | 6605.9 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.59959 | acc=0.8547 | tpr=0.9661 | fpr=0.1473 | 7004.7 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.59889 | acc=0.8550 | tpr=0.9670 | fpr=0.1470 | 12204.1 samples/s | 47.7 steps/s
Avg test loss: 0.59869, Avg test acc: 0.85503, Avg tpr: 0.96712, Avg fpr: 0.14700, total FA: 20411

server round 44/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.6] | Loss=0.03212 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.146 | 3626.6 samples/s | 56.7 steps/s
[Step=35250 Epoch=171.9] | Loss=0.01378 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.273 | FP-Norm(final)=3.148 | 3639.7 samples/s | 56.9 steps/s
[Step=35300 Epoch=172.1] | Loss=0.01096 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.316 | FP-Norm(final)=3.148 | 3775.2 samples/s | 59.0 steps/s
[Step=35350 Epoch=172.4] | Loss=0.00935 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=3.149 | 3765.9 samples/s | 58.8 steps/s
[Step=35400 Epoch=172.6] | Loss=0.00821 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.149 | 4866.1 samples/s | 76.0 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00733 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.150 | 1630.5 samples/s | 25.5 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00664 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=3.151 | 3759.2 samples/s | 58.7 steps/s
[Step=35550 Epoch=173.3] | Loss=0.00612 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.151 | 3758.2 samples/s | 58.7 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00578 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.152 | 4555.5 samples/s | 71.2 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00548 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.153 | 1658.6 samples/s | 25.9 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00511 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.154 | 3783.8 samples/s | 59.1 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00494 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.154 | 3764.4 samples/s | 58.8 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00478 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.155 | 4300.6 samples/s | 67.2 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00458 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.155 | 1684.1 samples/s | 26.3 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00444 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.355 | FP-Norm(final)=3.156 | 3753.5 samples/s | 58.6 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00429 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.157 | 3762.8 samples/s | 58.8 steps/s
[Step=36000 Epoch=175.5] | Loss=0.00418 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.157 | 4058.1 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.8] | Loss=0.08406 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.146 | 3971.8 samples/s | 62.1 steps/s
[Step=35250 Epoch=172.0] | Loss=0.01811 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.319 | FP-Norm(final)=3.147 | 3380.3 samples/s | 52.8 steps/s
[Step=35300 Epoch=172.2] | Loss=0.01211 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.147 | 3749.2 samples/s | 58.6 steps/s
[Step=35350 Epoch=172.5] | Loss=0.00961 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.353 | FP-Norm(final)=3.148 | 3729.4 samples/s | 58.3 steps/s
[Step=35400 Epoch=172.7] | Loss=0.00824 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.149 | 4829.3 samples/s | 75.5 steps/s
[Step=35450 Epoch=173.0] | Loss=0.00715 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.362 | FP-Norm(final)=3.149 | 1620.6 samples/s | 25.3 steps/s
[Step=35500 Epoch=173.2] | Loss=0.00635 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.150 | 3765.0 samples/s | 58.8 steps/s
[Step=35550 Epoch=173.5] | Loss=0.00587 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.151 | 3771.6 samples/s | 58.9 steps/s
[Step=35600 Epoch=173.7] | Loss=0.00550 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.151 | 4602.3 samples/s | 71.9 steps/s
[Step=35650 Epoch=174.0] | Loss=0.00516 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.152 | 1637.4 samples/s | 25.6 steps/s
[Step=35700 Epoch=174.2] | Loss=0.00485 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.153 | 3739.3 samples/s | 58.4 steps/s
[Step=35750 Epoch=174.4] | Loss=0.00465 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.360 | FP-Norm(final)=3.153 | 3752.3 samples/s | 58.6 steps/s
[Step=35800 Epoch=174.7] | Loss=0.00459 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.154 | 4383.8 samples/s | 68.5 steps/s
[Step=35850 Epoch=174.9] | Loss=0.00442 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.154 | 1670.6 samples/s | 26.1 steps/s
[Step=35900 Epoch=175.2] | Loss=0.00424 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.155 | 3771.7 samples/s | 58.9 steps/s
[Step=35950 Epoch=175.4] | Loss=0.00411 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.155 | 3769.1 samples/s | 58.9 steps/s
[Step=36000 Epoch=175.7] | Loss=0.00401 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.156 | 4149.8 samples/s | 64.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step36000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.5] | Loss=0.09654 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.146 | 3711.3 samples/s | 58.0 steps/s
[Step=35250 Epoch=171.8] | Loss=0.01428 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.298 | FP-Norm(final)=3.148 | 3577.2 samples/s | 55.9 steps/s
[Step=35300 Epoch=172.0] | Loss=0.01168 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=3.148 | 3710.3 samples/s | 58.0 steps/s
[Step=35350 Epoch=172.2] | Loss=0.00973 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.149 | 3773.0 samples/s | 59.0 steps/s
[Step=35400 Epoch=172.5] | Loss=0.00814 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.350 | FP-Norm(final)=3.149 | 4817.5 samples/s | 75.3 steps/s
[Step=35450 Epoch=172.7] | Loss=0.00706 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.150 | 1616.2 samples/s | 25.3 steps/s
[Step=35500 Epoch=173.0] | Loss=0.00633 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.151 | 3791.4 samples/s | 59.2 steps/s
[Step=35550 Epoch=173.2] | Loss=0.00583 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.352 | FP-Norm(final)=3.152 | 3765.6 samples/s | 58.8 steps/s
[Step=35600 Epoch=173.5] | Loss=0.00542 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.153 | 4538.9 samples/s | 70.9 steps/s
[Step=35650 Epoch=173.7] | Loss=0.00515 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.153 | 1657.2 samples/s | 25.9 steps/s
[Step=35700 Epoch=173.9] | Loss=0.00483 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.154 | 3769.0 samples/s | 58.9 steps/s
[Step=35750 Epoch=174.2] | Loss=0.00457 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.155 | 3756.7 samples/s | 58.7 steps/s
[Step=35800 Epoch=174.4] | Loss=0.00443 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.156 | 4272.6 samples/s | 66.8 steps/s
[Step=35850 Epoch=174.7] | Loss=0.00419 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.157 | 1701.3 samples/s | 26.6 steps/s
[Step=35900 Epoch=174.9] | Loss=0.00409 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.157 | 3785.3 samples/s | 59.1 steps/s
[Step=35950 Epoch=175.2] | Loss=0.00394 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.158 | 3757.3 samples/s | 58.7 steps/s
[Step=36000 Epoch=175.4] | Loss=0.00382 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.159 | 4041.7 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step36000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.7] | Loss=0.05737 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.146 | 3616.8 samples/s | 56.5 steps/s
[Step=35250 Epoch=171.9] | Loss=0.01570 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.338 | FP-Norm(final)=3.147 | 3593.9 samples/s | 56.2 steps/s
[Step=35300 Epoch=172.1] | Loss=0.01125 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.367 | FP-Norm(final)=3.147 | 3770.4 samples/s | 58.9 steps/s
[Step=35350 Epoch=172.4] | Loss=0.00924 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.379 | FP-Norm(final)=3.148 | 3743.7 samples/s | 58.5 steps/s
[Step=35400 Epoch=172.6] | Loss=0.00788 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=3.149 | 4854.9 samples/s | 75.9 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00673 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=3.149 | 1623.8 samples/s | 25.4 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00606 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=3.150 | 3710.8 samples/s | 58.0 steps/s
[Step=35550 Epoch=173.4] | Loss=0.00551 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.151 | 3763.7 samples/s | 58.8 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00517 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.151 | 4555.8 samples/s | 71.2 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00484 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.383 | FP-Norm(final)=3.152 | 1642.6 samples/s | 25.7 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00454 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.153 | 3744.5 samples/s | 58.5 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00429 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.154 | 3787.7 samples/s | 59.2 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00418 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.154 | 4275.6 samples/s | 66.8 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00399 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.155 | 1689.0 samples/s | 26.4 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00381 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.155 | 3748.6 samples/s | 58.6 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00367 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.156 | 3770.5 samples/s | 58.9 steps/s
[Step=36000 Epoch=175.6] | Loss=0.00358 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.157 | 4046.7 samples/s | 63.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step36000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=172.6] | Loss=0.10845 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.146 | 3738.7 samples/s | 58.4 steps/s
[Step=35250 Epoch=172.9] | Loss=0.01367 | Reg=0.00008 | acc=1.0000 | FP-Norm=0.272 | FP-Norm(final)=3.147 | 3696.7 samples/s | 57.8 steps/s
[Step=35300 Epoch=173.1] | Loss=0.01037 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.301 | FP-Norm(final)=3.148 | 3779.4 samples/s | 59.1 steps/s
[Step=35350 Epoch=173.4] | Loss=0.00848 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.313 | FP-Norm(final)=3.149 | 3775.1 samples/s | 59.0 steps/s
[Step=35400 Epoch=173.6] | Loss=0.00758 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.325 | FP-Norm(final)=3.150 | 4897.7 samples/s | 76.5 steps/s
[Step=35450 Epoch=173.8] | Loss=0.00654 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.328 | FP-Norm(final)=3.150 | 1613.4 samples/s | 25.2 steps/s
[Step=35500 Epoch=174.1] | Loss=0.00591 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.331 | FP-Norm(final)=3.151 | 3740.6 samples/s | 58.4 steps/s
[Step=35550 Epoch=174.3] | Loss=0.00543 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=3.152 | 3763.5 samples/s | 58.8 steps/s
[Step=35600 Epoch=174.6] | Loss=0.00507 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=3.153 | 4699.5 samples/s | 73.4 steps/s
[Step=35650 Epoch=174.8] | Loss=0.00469 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=3.153 | 1640.0 samples/s | 25.6 steps/s
[Step=35700 Epoch=175.1] | Loss=0.00443 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=3.154 | 3762.9 samples/s | 58.8 steps/s
[Step=35750 Epoch=175.3] | Loss=0.00422 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=3.155 | 3754.5 samples/s | 58.7 steps/s
[Step=35800 Epoch=175.6] | Loss=0.00410 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=3.155 | 4514.5 samples/s | 70.5 steps/s
[Step=35850 Epoch=175.8] | Loss=0.00390 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=3.156 | 1655.6 samples/s | 25.9 steps/s
[Step=35900 Epoch=176.0] | Loss=0.00381 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=3.157 | 3772.3 samples/s | 58.9 steps/s
[Step=35950 Epoch=176.3] | Loss=0.00367 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=3.157 | 3758.2 samples/s | 58.7 steps/s
[Step=36000 Epoch=176.5] | Loss=0.00357 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=3.158 | 4331.3 samples/s | 67.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step36000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=333.6] | Loss=0.05057 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.146 | 3398.8 samples/s | 53.1 steps/s
[Step=35250 Epoch=334.0] | Loss=0.00903 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=3.146 | 3457.3 samples/s | 54.0 steps/s
[Step=35300 Epoch=334.5] | Loss=0.00455 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=3.146 | 4606.5 samples/s | 72.0 steps/s
[Step=35350 Epoch=335.0] | Loss=0.00305 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.471 | FP-Norm(final)=3.146 | 1537.3 samples/s | 24.0 steps/s
[Step=35400 Epoch=335.4] | Loss=0.00230 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.465 | FP-Norm(final)=3.146 | 4312.8 samples/s | 67.4 steps/s
[Step=35450 Epoch=335.9] | Loss=0.00185 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.459 | FP-Norm(final)=3.146 | 1577.7 samples/s | 24.7 steps/s
[Step=35500 Epoch=336.4] | Loss=0.00154 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.452 | FP-Norm(final)=3.146 | 4064.4 samples/s | 63.5 steps/s
[Step=35550 Epoch=336.9] | Loss=0.00133 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.445 | FP-Norm(final)=3.146 | 1603.8 samples/s | 25.1 steps/s
[Step=35600 Epoch=337.3] | Loss=0.00116 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=3.146 | 3842.8 samples/s | 60.0 steps/s
[Step=35650 Epoch=337.8] | Loss=0.00104 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.433 | FP-Norm(final)=3.146 | 1665.0 samples/s | 26.0 steps/s
[Step=35700 Epoch=338.3] | Loss=0.00094 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=3.146 | 3587.2 samples/s | 56.0 steps/s
[Step=35750 Epoch=338.8] | Loss=0.00085 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=3.146 | 1708.2 samples/s | 26.7 steps/s
[Step=35800 Epoch=339.2] | Loss=0.00078 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=3.146 | 3588.9 samples/s | 56.1 steps/s
[Step=35850 Epoch=339.7] | Loss=0.00073 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=3.147 | 1719.8 samples/s | 26.9 steps/s
[Step=35900 Epoch=340.2] | Loss=0.00067 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=3.147 | 3580.1 samples/s | 55.9 steps/s
[Step=35950 Epoch=340.7] | Loss=0.00063 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=3.147 | 1703.8 samples/s | 26.6 steps/s
[Step=36000 Epoch=341.1] | Loss=0.00059 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=3.147 | 3541.3 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step36000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=334.8] | Loss=0.13995 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.146 | 3457.9 samples/s | 54.0 steps/s
[Step=35250 Epoch=335.3] | Loss=0.00908 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=3.146 | 3433.3 samples/s | 53.6 steps/s
[Step=35300 Epoch=335.8] | Loss=0.00457 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=3.146 | 4604.1 samples/s | 71.9 steps/s
[Step=35350 Epoch=336.3] | Loss=0.00306 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=3.146 | 1547.6 samples/s | 24.2 steps/s
[Step=35400 Epoch=336.7] | Loss=0.00230 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.146 | 4338.8 samples/s | 67.8 steps/s
[Step=35450 Epoch=337.2] | Loss=0.00184 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=3.146 | 1587.9 samples/s | 24.8 steps/s
[Step=35500 Epoch=337.7] | Loss=0.00154 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=3.146 | 4022.7 samples/s | 62.9 steps/s
[Step=35550 Epoch=338.2] | Loss=0.00132 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=3.146 | 1624.6 samples/s | 25.4 steps/s
[Step=35600 Epoch=338.6] | Loss=0.00116 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=3.146 | 3847.9 samples/s | 60.1 steps/s
[Step=35650 Epoch=339.1] | Loss=0.00103 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.146 | 1657.8 samples/s | 25.9 steps/s
[Step=35700 Epoch=339.6] | Loss=0.00093 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.146 | 3602.7 samples/s | 56.3 steps/s
[Step=35750 Epoch=340.1] | Loss=0.00085 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.146 | 1700.1 samples/s | 26.6 steps/s
[Step=35800 Epoch=340.5] | Loss=0.00078 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.146 | 3582.7 samples/s | 56.0 steps/s
[Step=35850 Epoch=341.0] | Loss=0.00072 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=3.146 | 1717.6 samples/s | 26.8 steps/s
[Step=35900 Epoch=341.5] | Loss=0.00067 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.146 | 3546.9 samples/s | 55.4 steps/s
[Step=35950 Epoch=342.0] | Loss=0.00062 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.146 | 1715.3 samples/s | 26.8 steps/s
[Step=36000 Epoch=342.4] | Loss=0.00059 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.146 | 3537.8 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step36000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=336.1] | Loss=0.08592 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.146 | 3557.5 samples/s | 55.6 steps/s
[Step=35250 Epoch=336.6] | Loss=0.00681 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=3.147 | 3305.7 samples/s | 51.7 steps/s
[Step=35300 Epoch=337.1] | Loss=0.00344 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.434 | FP-Norm(final)=3.147 | 4671.8 samples/s | 73.0 steps/s
[Step=35350 Epoch=337.6] | Loss=0.00231 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.434 | FP-Norm(final)=3.148 | 1537.2 samples/s | 24.0 steps/s
[Step=35400 Epoch=338.0] | Loss=0.00174 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.430 | FP-Norm(final)=3.148 | 4425.7 samples/s | 69.2 steps/s
[Step=35450 Epoch=338.5] | Loss=0.00139 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.424 | FP-Norm(final)=3.148 | 1573.8 samples/s | 24.6 steps/s
[Step=35500 Epoch=339.0] | Loss=0.00117 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=3.148 | 4155.0 samples/s | 64.9 steps/s
[Step=35550 Epoch=339.5] | Loss=0.00100 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.412 | FP-Norm(final)=3.148 | 1591.3 samples/s | 24.9 steps/s
[Step=35600 Epoch=340.0] | Loss=0.00088 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.148 | 3990.9 samples/s | 62.4 steps/s
[Step=35650 Epoch=340.4] | Loss=0.00078 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=3.148 | 1631.7 samples/s | 25.5 steps/s
[Step=35700 Epoch=340.9] | Loss=0.00071 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=3.148 | 3804.0 samples/s | 59.4 steps/s
[Step=35750 Epoch=341.4] | Loss=0.00065 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=3.148 | 1669.4 samples/s | 26.1 steps/s
[Step=35800 Epoch=341.9] | Loss=0.00059 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=3.148 | 3643.1 samples/s | 56.9 steps/s
[Step=35850 Epoch=342.3] | Loss=0.00055 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.148 | 1694.1 samples/s | 26.5 steps/s
[Step=35900 Epoch=342.8] | Loss=0.00051 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.148 | 3584.5 samples/s | 56.0 steps/s
[Step=35950 Epoch=343.3] | Loss=0.00048 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.148 | 1702.6 samples/s | 26.6 steps/s
[Step=36000 Epoch=343.8] | Loss=0.00045 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.148 | 3604.3 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step36000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=331.7] | Loss=0.03066 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.146 | 3564.3 samples/s | 55.7 steps/s
[Step=35250 Epoch=332.2] | Loss=0.00373 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.148 | 3450.0 samples/s | 53.9 steps/s
[Step=35300 Epoch=332.6] | Loss=0.00188 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.148 | 4565.5 samples/s | 71.3 steps/s
[Step=35350 Epoch=333.1] | Loss=0.00126 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.148 | 1547.5 samples/s | 24.2 steps/s
[Step=35400 Epoch=333.6] | Loss=0.00095 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=3.148 | 4235.1 samples/s | 66.2 steps/s
[Step=35450 Epoch=334.0] | Loss=0.00077 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=3.148 | 1575.2 samples/s | 24.6 steps/s
[Step=35500 Epoch=334.5] | Loss=0.00064 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=3.148 | 3937.7 samples/s | 61.5 steps/s
[Step=35550 Epoch=335.0] | Loss=0.00055 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.148 | 1631.0 samples/s | 25.5 steps/s
[Step=35600 Epoch=335.5] | Loss=0.00048 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.149 | 3705.8 samples/s | 57.9 steps/s
[Step=35650 Epoch=335.9] | Loss=0.00043 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.149 | 1697.1 samples/s | 26.5 steps/s
[Step=35700 Epoch=336.4] | Loss=0.00039 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.149 | 3564.1 samples/s | 55.7 steps/s
[Step=35750 Epoch=336.9] | Loss=0.00036 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.149 | 1713.7 samples/s | 26.8 steps/s
[Step=35800 Epoch=337.3] | Loss=0.00033 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.149 | 3585.2 samples/s | 56.0 steps/s
[Step=35850 Epoch=337.8] | Loss=0.00030 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.149 | 1695.9 samples/s | 26.5 steps/s
[Step=35900 Epoch=338.3] | Loss=0.00028 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.149 | 3547.4 samples/s | 55.4 steps/s
[Step=35950 Epoch=338.8] | Loss=0.00026 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.149 | 1834.3 samples/s | 28.7 steps/s
[Step=36000 Epoch=339.2] | Loss=0.00025 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=3.149 | 3139.7 samples/s | 49.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step36000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=335.5] | Loss=0.05877 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.146 | 3452.2 samples/s | 53.9 steps/s
[Step=35250 Epoch=336.0] | Loss=0.00491 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=3.148 | 3409.3 samples/s | 53.3 steps/s
[Step=35300 Epoch=336.4] | Loss=0.00248 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.427 | FP-Norm(final)=3.148 | 4660.7 samples/s | 72.8 steps/s
[Step=35350 Epoch=336.9] | Loss=0.00166 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=3.148 | 1525.2 samples/s | 23.8 steps/s
[Step=35400 Epoch=337.4] | Loss=0.00125 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=3.148 | 4429.4 samples/s | 69.2 steps/s
[Step=35450 Epoch=337.9] | Loss=0.00101 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=3.148 | 1565.7 samples/s | 24.5 steps/s
[Step=35500 Epoch=338.3] | Loss=0.00084 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.149 | 4162.6 samples/s | 65.0 steps/s
[Step=35550 Epoch=338.8] | Loss=0.00072 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=3.149 | 1590.9 samples/s | 24.9 steps/s
[Step=35600 Epoch=339.3] | Loss=0.00064 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=3.149 | 3950.6 samples/s | 61.7 steps/s
[Step=35650 Epoch=339.8] | Loss=0.00057 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.149 | 1638.1 samples/s | 25.6 steps/s
[Step=35700 Epoch=340.3] | Loss=0.00051 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.149 | 3771.7 samples/s | 58.9 steps/s
[Step=35750 Epoch=340.7] | Loss=0.00047 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.149 | 1670.6 samples/s | 26.1 steps/s
[Step=35800 Epoch=341.2] | Loss=0.00043 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.149 | 3607.9 samples/s | 56.4 steps/s
[Step=35850 Epoch=341.7] | Loss=0.00040 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=3.149 | 1695.6 samples/s | 26.5 steps/s
[Step=35900 Epoch=342.2] | Loss=0.00037 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.149 | 3585.0 samples/s | 56.0 steps/s
[Step=35950 Epoch=342.6] | Loss=0.00035 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.149 | 1696.8 samples/s | 26.5 steps/s
[Step=36000 Epoch=343.1] | Loss=0.00033 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.149 | 3573.7 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20097 | acc=0.9041 | tpr=0.8688 | fpr=0.0191 | 3626.0 samples/s | 14.2 steps/s
Avg test loss: 0.20321, Avg test acc: 0.90316, Avg tpr: 0.86839, Avg fpr: 0.02038, total FA: 159

Testing server on iccad2012
[Step=  50] | Loss=0.53260 | acc=0.8696 | tpr=0.9646 | fpr=0.1321 | 3618.7 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.55495 | acc=0.8669 | tpr=0.9723 | fpr=0.1351 | 6922.1 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.56779 | acc=0.8634 | tpr=0.9683 | fpr=0.1385 | 6911.8 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.56804 | acc=0.8646 | tpr=0.9683 | fpr=0.1373 | 6710.4 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.56460 | acc=0.8644 | tpr=0.9633 | fpr=0.1374 | 6816.6 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.56959 | acc=0.8638 | tpr=0.9629 | fpr=0.1380 | 6792.1 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.57056 | acc=0.8642 | tpr=0.9631 | fpr=0.1376 | 7191.7 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.57143 | acc=0.8641 | tpr=0.9633 | fpr=0.1377 | 6465.7 samples/s | 25.3 steps/s
[Step= 450] | Loss=0.57674 | acc=0.8637 | tpr=0.9635 | fpr=0.1381 | 6876.9 samples/s | 26.9 steps/s
[Step= 500] | Loss=0.57667 | acc=0.8635 | tpr=0.9643 | fpr=0.1384 | 6637.7 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.57597 | acc=0.8637 | tpr=0.9654 | fpr=0.1381 | 12623.7 samples/s | 49.3 steps/s
Avg test loss: 0.57577, Avg test acc: 0.86377, Avg tpr: 0.96553, Avg fpr: 0.13808, total FA: 19172

server round 45/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.5] | Loss=0.06374 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.157 | 3826.9 samples/s | 59.8 steps/s
[Step=36050 Epoch=175.8] | Loss=0.01739 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=3.158 | 3527.7 samples/s | 55.1 steps/s
[Step=36100 Epoch=176.0] | Loss=0.01220 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.158 | 3758.6 samples/s | 58.7 steps/s
[Step=36150 Epoch=176.3] | Loss=0.01010 | Reg=0.00016 | acc=0.9688 | FP-Norm=0.386 | FP-Norm(final)=3.159 | 3774.6 samples/s | 59.0 steps/s
[Step=36200 Epoch=176.5] | Loss=0.00867 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=3.159 | 4849.9 samples/s | 75.8 steps/s
[Step=36250 Epoch=176.8] | Loss=0.00763 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=3.160 | 1626.1 samples/s | 25.4 steps/s
[Step=36300 Epoch=177.0] | Loss=0.00682 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=3.161 | 3782.8 samples/s | 59.1 steps/s
[Step=36350 Epoch=177.2] | Loss=0.00617 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=3.161 | 3778.5 samples/s | 59.0 steps/s
[Step=36400 Epoch=177.5] | Loss=0.00585 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=3.162 | 4520.2 samples/s | 70.6 steps/s
[Step=36450 Epoch=177.7] | Loss=0.00553 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=3.163 | 1656.9 samples/s | 25.9 steps/s
[Step=36500 Epoch=178.0] | Loss=0.00527 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=3.163 | 3717.3 samples/s | 58.1 steps/s
[Step=36550 Epoch=178.2] | Loss=0.00502 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.164 | 3772.0 samples/s | 58.9 steps/s
[Step=36600 Epoch=178.5] | Loss=0.00484 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.388 | FP-Norm(final)=3.165 | 4270.7 samples/s | 66.7 steps/s
[Step=36650 Epoch=178.7] | Loss=0.00464 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=3.165 | 1688.5 samples/s | 26.4 steps/s
[Step=36700 Epoch=179.0] | Loss=0.00452 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.166 | 3799.4 samples/s | 59.4 steps/s
[Step=36750 Epoch=179.2] | Loss=0.00438 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.167 | 3750.6 samples/s | 58.6 steps/s
[Step=36800 Epoch=179.4] | Loss=0.00427 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.384 | FP-Norm(final)=3.167 | 4058.7 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step36800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.7] | Loss=0.04033 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.157 | 3857.7 samples/s | 60.3 steps/s
[Step=36050 Epoch=175.9] | Loss=0.01791 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.320 | FP-Norm(final)=3.157 | 3519.3 samples/s | 55.0 steps/s
[Step=36100 Epoch=176.2] | Loss=0.01156 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.158 | 3761.4 samples/s | 58.8 steps/s
[Step=36150 Epoch=176.4] | Loss=0.00941 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.158 | 3770.7 samples/s | 58.9 steps/s
[Step=36200 Epoch=176.6] | Loss=0.00843 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.159 | 4874.4 samples/s | 76.2 steps/s
[Step=36250 Epoch=176.9] | Loss=0.00746 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.160 | 1600.2 samples/s | 25.0 steps/s
[Step=36300 Epoch=177.1] | Loss=0.00671 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.160 | 3794.7 samples/s | 59.3 steps/s
[Step=36350 Epoch=177.4] | Loss=0.00612 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.161 | 3773.3 samples/s | 59.0 steps/s
[Step=36400 Epoch=177.6] | Loss=0.00574 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.161 | 4596.6 samples/s | 71.8 steps/s
[Step=36450 Epoch=177.9] | Loss=0.00540 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.162 | 1629.4 samples/s | 25.5 steps/s
[Step=36500 Epoch=178.1] | Loss=0.00517 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.163 | 3781.0 samples/s | 59.1 steps/s
[Step=36550 Epoch=178.3] | Loss=0.00490 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=3.163 | 3765.3 samples/s | 58.8 steps/s
[Step=36600 Epoch=178.6] | Loss=0.00468 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.164 | 4366.2 samples/s | 68.2 steps/s
[Step=36650 Epoch=178.8] | Loss=0.00448 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.164 | 1683.7 samples/s | 26.3 steps/s
[Step=36700 Epoch=179.1] | Loss=0.00433 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.165 | 3740.9 samples/s | 58.5 steps/s
[Step=36750 Epoch=179.3] | Loss=0.00424 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.165 | 3761.4 samples/s | 58.8 steps/s
[Step=36800 Epoch=179.6] | Loss=0.00412 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.166 | 4151.6 samples/s | 64.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step36800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.4] | Loss=0.04935 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.157 | 3689.4 samples/s | 57.6 steps/s
[Step=36050 Epoch=175.7] | Loss=0.02285 | Reg=0.00010 | acc=0.9531 | FP-Norm=0.297 | FP-Norm(final)=3.157 | 3622.9 samples/s | 56.6 steps/s
[Step=36100 Epoch=175.9] | Loss=0.01519 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.330 | FP-Norm(final)=3.156 | 3802.6 samples/s | 59.4 steps/s
[Step=36150 Epoch=176.1] | Loss=0.01157 | Reg=0.00013 | acc=0.9688 | FP-Norm=0.348 | FP-Norm(final)=3.157 | 3776.0 samples/s | 59.0 steps/s
[Step=36200 Epoch=176.4] | Loss=0.00962 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.158 | 4821.3 samples/s | 75.3 steps/s
[Step=36250 Epoch=176.6] | Loss=0.00841 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.158 | 1632.0 samples/s | 25.5 steps/s
[Step=36300 Epoch=176.9] | Loss=0.00723 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.159 | 3759.3 samples/s | 58.7 steps/s
[Step=36350 Epoch=177.1] | Loss=0.00661 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.160 | 3790.6 samples/s | 59.2 steps/s
[Step=36400 Epoch=177.4] | Loss=0.00618 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.161 | 4544.3 samples/s | 71.0 steps/s
[Step=36450 Epoch=177.6] | Loss=0.00567 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.162 | 1651.1 samples/s | 25.8 steps/s
[Step=36500 Epoch=177.8] | Loss=0.00534 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.162 | 3755.4 samples/s | 58.7 steps/s
[Step=36550 Epoch=178.1] | Loss=0.00510 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.163 | 3764.2 samples/s | 58.8 steps/s
[Step=36600 Epoch=178.3] | Loss=0.00486 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.164 | 4288.3 samples/s | 67.0 steps/s
[Step=36650 Epoch=178.6] | Loss=0.00461 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.165 | 1704.0 samples/s | 26.6 steps/s
[Step=36700 Epoch=178.8] | Loss=0.00442 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.166 | 3778.8 samples/s | 59.0 steps/s
[Step=36750 Epoch=179.1] | Loss=0.00428 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.166 | 3777.4 samples/s | 59.0 steps/s
[Step=36800 Epoch=179.3] | Loss=0.00416 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.167 | 4068.8 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step36800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.6] | Loss=0.04947 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.157 | 3801.3 samples/s | 59.4 steps/s
[Step=36050 Epoch=175.8] | Loss=0.01123 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.280 | FP-Norm(final)=3.159 | 3634.3 samples/s | 56.8 steps/s
[Step=36100 Epoch=176.0] | Loss=0.00785 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.322 | FP-Norm(final)=3.160 | 3771.6 samples/s | 58.9 steps/s
[Step=36150 Epoch=176.3] | Loss=0.00696 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=3.161 | 3783.2 samples/s | 59.1 steps/s
[Step=36200 Epoch=176.5] | Loss=0.00642 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.162 | 4798.0 samples/s | 75.0 steps/s
[Step=36250 Epoch=176.8] | Loss=0.00564 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.162 | 1629.0 samples/s | 25.5 steps/s
[Step=36300 Epoch=177.0] | Loss=0.00501 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.163 | 3725.1 samples/s | 58.2 steps/s
[Step=36350 Epoch=177.3] | Loss=0.00462 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.164 | 3763.0 samples/s | 58.8 steps/s
[Step=36400 Epoch=177.5] | Loss=0.00447 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.165 | 4512.6 samples/s | 70.5 steps/s
[Step=36450 Epoch=177.8] | Loss=0.00421 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.357 | FP-Norm(final)=3.166 | 1666.5 samples/s | 26.0 steps/s
[Step=36500 Epoch=178.0] | Loss=0.00395 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.166 | 3706.7 samples/s | 57.9 steps/s
[Step=36550 Epoch=178.2] | Loss=0.00380 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.167 | 3753.3 samples/s | 58.6 steps/s
[Step=36600 Epoch=178.5] | Loss=0.00365 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.357 | FP-Norm(final)=3.168 | 4293.4 samples/s | 67.1 steps/s
[Step=36650 Epoch=178.7] | Loss=0.00354 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.168 | 1698.6 samples/s | 26.5 steps/s
[Step=36700 Epoch=179.0] | Loss=0.00342 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.357 | FP-Norm(final)=3.169 | 3797.9 samples/s | 59.3 steps/s
[Step=36750 Epoch=179.2] | Loss=0.00334 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.357 | FP-Norm(final)=3.169 | 3743.0 samples/s | 58.5 steps/s
[Step=36800 Epoch=179.5] | Loss=0.00325 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.170 | 4056.6 samples/s | 63.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step36800.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=176.5] | Loss=0.07443 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.157 | 3822.0 samples/s | 59.7 steps/s
[Step=36050 Epoch=176.8] | Loss=0.01553 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.306 | FP-Norm(final)=3.158 | 3510.0 samples/s | 54.8 steps/s
[Step=36100 Epoch=177.0] | Loss=0.01034 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.326 | FP-Norm(final)=3.158 | 3761.9 samples/s | 58.8 steps/s
[Step=36150 Epoch=177.3] | Loss=0.00853 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.333 | FP-Norm(final)=3.159 | 3797.6 samples/s | 59.3 steps/s
[Step=36200 Epoch=177.5] | Loss=0.00804 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=3.160 | 4891.4 samples/s | 76.4 steps/s
[Step=36250 Epoch=177.8] | Loss=0.00702 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.160 | 1610.8 samples/s | 25.2 steps/s
[Step=36300 Epoch=178.0] | Loss=0.00614 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.161 | 3754.5 samples/s | 58.7 steps/s
[Step=36350 Epoch=178.3] | Loss=0.00564 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.162 | 3767.8 samples/s | 58.9 steps/s
[Step=36400 Epoch=178.5] | Loss=0.00531 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.163 | 4671.5 samples/s | 73.0 steps/s
[Step=36450 Epoch=178.7] | Loss=0.00489 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.163 | 1625.7 samples/s | 25.4 steps/s
[Step=36500 Epoch=179.0] | Loss=0.00468 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.164 | 3752.2 samples/s | 58.6 steps/s
[Step=36550 Epoch=179.2] | Loss=0.00444 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.165 | 3775.9 samples/s | 59.0 steps/s
[Step=36600 Epoch=179.5] | Loss=0.00419 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.165 | 4494.0 samples/s | 70.2 steps/s
[Step=36650 Epoch=179.7] | Loss=0.00404 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.166 | 1659.5 samples/s | 25.9 steps/s
[Step=36700 Epoch=180.0] | Loss=0.00385 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.167 | 3762.3 samples/s | 58.8 steps/s
[Step=36750 Epoch=180.2] | Loss=0.00375 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.167 | 3749.4 samples/s | 58.6 steps/s
[Step=36800 Epoch=180.5] | Loss=0.00359 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.168 | 4334.4 samples/s | 67.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step36800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=341.1] | Loss=0.05783 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.157 | 3647.7 samples/s | 57.0 steps/s
[Step=36050 Epoch=341.6] | Loss=0.00695 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=3.157 | 3375.9 samples/s | 52.7 steps/s
[Step=36100 Epoch=342.1] | Loss=0.00351 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=3.157 | 4652.0 samples/s | 72.7 steps/s
[Step=36150 Epoch=342.6] | Loss=0.00235 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=3.157 | 1551.6 samples/s | 24.2 steps/s
[Step=36200 Epoch=343.0] | Loss=0.00177 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=3.157 | 4325.2 samples/s | 67.6 steps/s
[Step=36250 Epoch=343.5] | Loss=0.00142 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.410 | FP-Norm(final)=3.158 | 1580.3 samples/s | 24.7 steps/s
[Step=36300 Epoch=344.0] | Loss=0.00119 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.158 | 4071.1 samples/s | 63.6 steps/s
[Step=36350 Epoch=344.4] | Loss=0.00102 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=3.158 | 1620.5 samples/s | 25.3 steps/s
[Step=36400 Epoch=344.9] | Loss=0.00090 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=3.158 | 3815.2 samples/s | 59.6 steps/s
[Step=36450 Epoch=345.4] | Loss=0.00080 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=3.158 | 1657.8 samples/s | 25.9 steps/s
[Step=36500 Epoch=345.9] | Loss=0.00072 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.158 | 3591.7 samples/s | 56.1 steps/s
[Step=36550 Epoch=346.3] | Loss=0.00066 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.158 | 1713.7 samples/s | 26.8 steps/s
[Step=36600 Epoch=346.8] | Loss=0.00061 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.158 | 3563.8 samples/s | 55.7 steps/s
[Step=36650 Epoch=347.3] | Loss=0.00056 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.158 | 1715.1 samples/s | 26.8 steps/s
[Step=36700 Epoch=347.8] | Loss=0.00052 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=3.158 | 3520.1 samples/s | 55.0 steps/s
[Step=36750 Epoch=348.2] | Loss=0.00049 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.158 | 1712.2 samples/s | 26.8 steps/s
[Step=36800 Epoch=348.7] | Loss=0.00046 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.158 | 3541.6 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step36800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=342.5] | Loss=0.08875 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.157 | 3794.8 samples/s | 59.3 steps/s
[Step=36050 Epoch=342.9] | Loss=0.00614 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=3.158 | 3105.1 samples/s | 48.5 steps/s
[Step=36100 Epoch=343.4] | Loss=0.00309 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.158 | 4607.5 samples/s | 72.0 steps/s
[Step=36150 Epoch=343.9] | Loss=0.00206 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=3.158 | 1544.9 samples/s | 24.1 steps/s
[Step=36200 Epoch=344.4] | Loss=0.00155 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.159 | 4347.1 samples/s | 67.9 steps/s
[Step=36250 Epoch=344.8] | Loss=0.00124 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=3.159 | 1583.5 samples/s | 24.7 steps/s
[Step=36300 Epoch=345.3] | Loss=0.00104 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=3.159 | 4076.0 samples/s | 63.7 steps/s
[Step=36350 Epoch=345.8] | Loss=0.00089 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.159 | 1625.0 samples/s | 25.4 steps/s
[Step=36400 Epoch=346.3] | Loss=0.00078 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.159 | 3857.4 samples/s | 60.3 steps/s
[Step=36450 Epoch=346.7] | Loss=0.00070 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.159 | 1641.0 samples/s | 25.6 steps/s
[Step=36500 Epoch=347.2] | Loss=0.00063 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.159 | 3651.9 samples/s | 57.1 steps/s
[Step=36550 Epoch=347.7] | Loss=0.00057 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.159 | 1701.1 samples/s | 26.6 steps/s
[Step=36600 Epoch=348.2] | Loss=0.00052 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.159 | 3549.9 samples/s | 55.5 steps/s
[Step=36650 Epoch=348.6] | Loss=0.00048 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.159 | 1711.1 samples/s | 26.7 steps/s
[Step=36700 Epoch=349.1] | Loss=0.00045 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=3.159 | 3533.8 samples/s | 55.2 steps/s
[Step=36750 Epoch=349.6] | Loss=0.00042 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.159 | 1718.1 samples/s | 26.8 steps/s
[Step=36800 Epoch=350.1] | Loss=0.00040 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.159 | 3537.9 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step36800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=343.8] | Loss=0.10687 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.157 | 3489.0 samples/s | 54.5 steps/s
[Step=36050 Epoch=344.3] | Loss=0.00705 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.157 | 3370.3 samples/s | 52.7 steps/s
[Step=36100 Epoch=344.7] | Loss=0.00356 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=3.157 | 4686.2 samples/s | 73.2 steps/s
[Step=36150 Epoch=345.2] | Loss=0.00238 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.157 | 1531.5 samples/s | 23.9 steps/s
[Step=36200 Epoch=345.7] | Loss=0.00179 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=3.158 | 4426.3 samples/s | 69.2 steps/s
[Step=36250 Epoch=346.2] | Loss=0.00144 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=3.158 | 1576.6 samples/s | 24.6 steps/s
[Step=36300 Epoch=346.6] | Loss=0.00120 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=3.158 | 4137.2 samples/s | 64.6 steps/s
[Step=36350 Epoch=347.1] | Loss=0.00103 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.158 | 1587.4 samples/s | 24.8 steps/s
[Step=36400 Epoch=347.6] | Loss=0.00091 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.158 | 3941.2 samples/s | 61.6 steps/s
[Step=36450 Epoch=348.1] | Loss=0.00081 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.158 | 1636.7 samples/s | 25.6 steps/s
[Step=36500 Epoch=348.6] | Loss=0.00073 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.158 | 3763.2 samples/s | 58.8 steps/s
[Step=36550 Epoch=349.0] | Loss=0.00067 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.158 | 1660.2 samples/s | 25.9 steps/s
[Step=36600 Epoch=349.5] | Loss=0.00061 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.158 | 3618.0 samples/s | 56.5 steps/s
[Step=36650 Epoch=350.0] | Loss=0.00057 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.158 | 1674.0 samples/s | 26.2 steps/s
[Step=36700 Epoch=350.5] | Loss=0.00053 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.158 | 3576.9 samples/s | 55.9 steps/s
[Step=36750 Epoch=350.9] | Loss=0.00049 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.158 | 1710.3 samples/s | 26.7 steps/s
[Step=36800 Epoch=351.4] | Loss=0.00046 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.158 | 3597.1 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step36800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=339.2] | Loss=0.08027 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.157 | 3775.9 samples/s | 59.0 steps/s
[Step=36050 Epoch=339.7] | Loss=0.00424 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=3.158 | 3141.0 samples/s | 49.1 steps/s
[Step=36100 Epoch=340.2] | Loss=0.00214 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.418 | FP-Norm(final)=3.158 | 4621.6 samples/s | 72.2 steps/s
[Step=36150 Epoch=340.6] | Loss=0.00143 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.414 | FP-Norm(final)=3.158 | 1552.7 samples/s | 24.3 steps/s
[Step=36200 Epoch=341.1] | Loss=0.00108 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.158 | 4256.9 samples/s | 66.5 steps/s
[Step=36250 Epoch=341.6] | Loss=0.00087 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=3.158 | 1603.7 samples/s | 25.1 steps/s
[Step=36300 Epoch=342.0] | Loss=0.00072 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=3.158 | 3935.3 samples/s | 61.5 steps/s
[Step=36350 Epoch=342.5] | Loss=0.00062 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.158 | 1607.9 samples/s | 25.1 steps/s
[Step=36400 Epoch=343.0] | Loss=0.00055 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.159 | 3690.1 samples/s | 57.7 steps/s
[Step=36450 Epoch=343.5] | Loss=0.00049 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.159 | 1696.3 samples/s | 26.5 steps/s
[Step=36500 Epoch=343.9] | Loss=0.00044 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.159 | 3589.1 samples/s | 56.1 steps/s
[Step=36550 Epoch=344.4] | Loss=0.00040 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.159 | 1718.1 samples/s | 26.8 steps/s
[Step=36600 Epoch=344.9] | Loss=0.00037 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.159 | 3643.6 samples/s | 56.9 steps/s
[Step=36650 Epoch=345.3] | Loss=0.00034 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.159 | 1732.4 samples/s | 27.1 steps/s
[Step=36700 Epoch=345.8] | Loss=0.00032 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=3.159 | 3544.4 samples/s | 55.4 steps/s
[Step=36750 Epoch=346.3] | Loss=0.00030 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.159 | 1847.8 samples/s | 28.9 steps/s
[Step=36800 Epoch=346.8] | Loss=0.00028 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.159 | 3158.8 samples/s | 49.4 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step36800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=343.1] | Loss=0.05834 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.157 | 3389.5 samples/s | 53.0 steps/s
[Step=36050 Epoch=343.6] | Loss=0.00442 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.158 | 3478.8 samples/s | 54.4 steps/s
[Step=36100 Epoch=344.1] | Loss=0.00224 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.158 | 4659.2 samples/s | 72.8 steps/s
[Step=36150 Epoch=344.5] | Loss=0.00150 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.158 | 1527.7 samples/s | 23.9 steps/s
[Step=36200 Epoch=345.0] | Loss=0.00113 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.158 | 4379.5 samples/s | 68.4 steps/s
[Step=36250 Epoch=345.5] | Loss=0.00091 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.158 | 1554.3 samples/s | 24.3 steps/s
[Step=36300 Epoch=346.0] | Loss=0.00076 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.158 | 4166.5 samples/s | 65.1 steps/s
[Step=36350 Epoch=346.4] | Loss=0.00066 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.158 | 1594.1 samples/s | 24.9 steps/s
[Step=36400 Epoch=346.9] | Loss=0.00058 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.158 | 3959.9 samples/s | 61.9 steps/s
[Step=36450 Epoch=347.4] | Loss=0.00051 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.158 | 1629.9 samples/s | 25.5 steps/s
[Step=36500 Epoch=347.9] | Loss=0.00047 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.158 | 3790.4 samples/s | 59.2 steps/s
[Step=36550 Epoch=348.4] | Loss=0.00042 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.158 | 1648.6 samples/s | 25.8 steps/s
[Step=36600 Epoch=348.8] | Loss=0.00039 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=3.158 | 3609.6 samples/s | 56.4 steps/s
[Step=36650 Epoch=349.3] | Loss=0.00036 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=3.158 | 1702.2 samples/s | 26.6 steps/s
[Step=36700 Epoch=349.8] | Loss=0.00034 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=3.158 | 3571.1 samples/s | 55.8 steps/s
[Step=36750 Epoch=350.3] | Loss=0.00032 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.329 | FP-Norm(final)=3.158 | 1715.5 samples/s | 26.8 steps/s
[Step=36800 Epoch=350.7] | Loss=0.00030 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.326 | FP-Norm(final)=3.158 | 3600.9 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19947 | acc=0.9054 | tpr=0.8708 | fpr=0.0196 | 3625.5 samples/s | 14.2 steps/s
Avg test loss: 0.20144, Avg test acc: 0.90444, Avg tpr: 0.87043, Avg fpr: 0.02077, total FA: 162

Testing server on iccad2012
[Step=  50] | Loss=0.54138 | acc=0.8693 | tpr=0.9690 | fpr=0.1325 | 3656.8 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.56387 | acc=0.8665 | tpr=0.9744 | fpr=0.1355 | 6793.3 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.57684 | acc=0.8627 | tpr=0.9697 | fpr=0.1393 | 6876.9 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.57689 | acc=0.8638 | tpr=0.9694 | fpr=0.1382 | 6776.7 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.57325 | acc=0.8638 | tpr=0.9651 | fpr=0.1380 | 6791.7 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.57839 | acc=0.8632 | tpr=0.9644 | fpr=0.1386 | 6248.6 samples/s | 24.4 steps/s
[Step= 350] | Loss=0.57935 | acc=0.8637 | tpr=0.9656 | fpr=0.1382 | 6313.4 samples/s | 24.7 steps/s
[Step= 400] | Loss=0.58024 | acc=0.8635 | tpr=0.9661 | fpr=0.1383 | 6708.0 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.58571 | acc=0.8631 | tpr=0.9659 | fpr=0.1388 | 6543.7 samples/s | 25.6 steps/s
[Step= 500] | Loss=0.58562 | acc=0.8628 | tpr=0.9665 | fpr=0.1390 | 6811.8 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.58485 | acc=0.8631 | tpr=0.9674 | fpr=0.1388 | 12861.2 samples/s | 50.2 steps/s
Avg test loss: 0.58463, Avg test acc: 0.86311, Avg tpr: 0.96751, Avg fpr: 0.13879, total FA: 19271

server round 46/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.4] | Loss=0.03417 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.168 | 3541.3 samples/s | 55.3 steps/s
[Step=36850 Epoch=179.7] | Loss=0.01872 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.327 | FP-Norm(final)=3.168 | 3749.8 samples/s | 58.6 steps/s
[Step=36900 Epoch=179.9] | Loss=0.01266 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.169 | 3761.7 samples/s | 58.8 steps/s
[Step=36950 Epoch=180.2] | Loss=0.01023 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.376 | FP-Norm(final)=3.169 | 3782.6 samples/s | 59.1 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00915 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.169 | 4825.1 samples/s | 75.4 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00800 | Reg=0.00015 | acc=0.9844 | FP-Norm=0.385 | FP-Norm(final)=3.170 | 1629.7 samples/s | 25.5 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00723 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.170 | 3763.5 samples/s | 58.8 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00657 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.171 | 3763.9 samples/s | 58.8 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00607 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.172 | 4537.1 samples/s | 70.9 steps/s
[Step=37250 Epoch=181.6] | Loss=0.00567 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.172 | 1649.0 samples/s | 25.8 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00535 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.377 | FP-Norm(final)=3.173 | 3752.6 samples/s | 58.6 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00516 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.173 | 3755.1 samples/s | 58.7 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00498 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.174 | 4300.7 samples/s | 67.2 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00479 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.174 | 1706.5 samples/s | 26.7 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00468 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.175 | 3778.9 samples/s | 59.0 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00451 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.374 | FP-Norm(final)=3.176 | 3753.9 samples/s | 58.7 steps/s
[Step=37600 Epoch=183.3] | Loss=0.00439 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.373 | FP-Norm(final)=3.176 | 4052.3 samples/s | 63.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step37600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.6] | Loss=0.11977 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.168 | 3721.1 samples/s | 58.1 steps/s
[Step=36850 Epoch=179.8] | Loss=0.01804 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.314 | FP-Norm(final)=3.168 | 3563.5 samples/s | 55.7 steps/s
[Step=36900 Epoch=180.1] | Loss=0.01174 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=3.168 | 3771.0 samples/s | 58.9 steps/s
[Step=36950 Epoch=180.3] | Loss=0.00939 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.169 | 3773.9 samples/s | 59.0 steps/s
[Step=37000 Epoch=180.5] | Loss=0.00837 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=3.169 | 4868.3 samples/s | 76.1 steps/s
[Step=37050 Epoch=180.8] | Loss=0.00715 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.170 | 1608.7 samples/s | 25.1 steps/s
[Step=37100 Epoch=181.0] | Loss=0.00652 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.171 | 3781.4 samples/s | 59.1 steps/s
[Step=37150 Epoch=181.3] | Loss=0.00603 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.171 | 3762.1 samples/s | 58.8 steps/s
[Step=37200 Epoch=181.5] | Loss=0.00559 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.172 | 4620.1 samples/s | 72.2 steps/s
[Step=37250 Epoch=181.8] | Loss=0.00522 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.172 | 1644.4 samples/s | 25.7 steps/s
[Step=37300 Epoch=182.0] | Loss=0.00492 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.353 | FP-Norm(final)=3.173 | 3754.4 samples/s | 58.7 steps/s
[Step=37350 Epoch=182.3] | Loss=0.00475 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.174 | 3765.8 samples/s | 58.8 steps/s
[Step=37400 Epoch=182.5] | Loss=0.00455 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.174 | 4389.9 samples/s | 68.6 steps/s
[Step=37450 Epoch=182.7] | Loss=0.00439 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.175 | 1676.9 samples/s | 26.2 steps/s
[Step=37500 Epoch=183.0] | Loss=0.00423 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.175 | 3754.4 samples/s | 58.7 steps/s
[Step=37550 Epoch=183.2] | Loss=0.00404 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=3.176 | 3775.9 samples/s | 59.0 steps/s
[Step=37600 Epoch=183.5] | Loss=0.00398 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.176 | 4172.6 samples/s | 65.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step37600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.3] | Loss=0.16755 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.168 | 3712.1 samples/s | 58.0 steps/s
[Step=36850 Epoch=179.6] | Loss=0.01847 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.297 | FP-Norm(final)=3.168 | 3613.3 samples/s | 56.5 steps/s
[Step=36900 Epoch=179.8] | Loss=0.01245 | Reg=0.00011 | acc=0.9688 | FP-Norm=0.321 | FP-Norm(final)=3.168 | 3764.8 samples/s | 58.8 steps/s
[Step=36950 Epoch=180.0] | Loss=0.01046 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=3.169 | 3778.9 samples/s | 59.0 steps/s
[Step=37000 Epoch=180.3] | Loss=0.00902 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.169 | 4839.4 samples/s | 75.6 steps/s
[Step=37050 Epoch=180.5] | Loss=0.00773 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=3.170 | 1629.0 samples/s | 25.5 steps/s
[Step=37100 Epoch=180.8] | Loss=0.00690 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=3.171 | 3775.9 samples/s | 59.0 steps/s
[Step=37150 Epoch=181.0] | Loss=0.00635 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.172 | 3778.2 samples/s | 59.0 steps/s
[Step=37200 Epoch=181.3] | Loss=0.00584 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.172 | 4547.0 samples/s | 71.0 steps/s
[Step=37250 Epoch=181.5] | Loss=0.00541 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.173 | 1652.8 samples/s | 25.8 steps/s
[Step=37300 Epoch=181.7] | Loss=0.00513 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.174 | 3772.5 samples/s | 58.9 steps/s
[Step=37350 Epoch=182.0] | Loss=0.00485 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.175 | 3789.8 samples/s | 59.2 steps/s
[Step=37400 Epoch=182.2] | Loss=0.00462 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.175 | 4296.3 samples/s | 67.1 steps/s
[Step=37450 Epoch=182.5] | Loss=0.00435 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.176 | 1680.0 samples/s | 26.2 steps/s
[Step=37500 Epoch=182.7] | Loss=0.00415 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.177 | 3798.4 samples/s | 59.4 steps/s
[Step=37550 Epoch=183.0] | Loss=0.00401 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.178 | 3784.3 samples/s | 59.1 steps/s
[Step=37600 Epoch=183.2] | Loss=0.00393 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.353 | FP-Norm(final)=3.178 | 4070.4 samples/s | 63.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step37600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.5] | Loss=0.09074 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.168 | 3584.7 samples/s | 56.0 steps/s
[Step=36850 Epoch=179.7] | Loss=0.01588 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.325 | FP-Norm(final)=3.168 | 3661.0 samples/s | 57.2 steps/s
[Step=36900 Epoch=179.9] | Loss=0.01047 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=3.169 | 3748.0 samples/s | 58.6 steps/s
[Step=36950 Epoch=180.2] | Loss=0.00854 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.169 | 3780.3 samples/s | 59.1 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00763 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.170 | 4778.2 samples/s | 74.7 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00655 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.171 | 1601.1 samples/s | 25.0 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00576 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.172 | 3766.6 samples/s | 58.9 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00547 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.376 | FP-Norm(final)=3.173 | 3768.0 samples/s | 58.9 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00499 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.173 | 4554.5 samples/s | 71.2 steps/s
[Step=37250 Epoch=181.7] | Loss=0.00461 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.174 | 1655.8 samples/s | 25.9 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00433 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.374 | FP-Norm(final)=3.175 | 3721.7 samples/s | 58.2 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00417 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.175 | 3773.7 samples/s | 59.0 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00401 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.176 | 4289.9 samples/s | 67.0 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00382 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.177 | 1690.1 samples/s | 26.4 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00377 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.177 | 3750.6 samples/s | 58.6 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00361 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.178 | 3788.4 samples/s | 59.2 steps/s
[Step=37600 Epoch=183.4] | Loss=0.00350 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.178 | 4030.4 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step37600.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=180.5] | Loss=0.07256 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.168 | 3775.8 samples/s | 59.0 steps/s
[Step=36850 Epoch=180.7] | Loss=0.01572 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.302 | FP-Norm(final)=3.169 | 3545.2 samples/s | 55.4 steps/s
[Step=36900 Epoch=181.0] | Loss=0.01043 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.329 | FP-Norm(final)=3.169 | 3777.9 samples/s | 59.0 steps/s
[Step=36950 Epoch=181.2] | Loss=0.00829 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=3.170 | 3777.5 samples/s | 59.0 steps/s
[Step=37000 Epoch=181.4] | Loss=0.00766 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.171 | 4903.9 samples/s | 76.6 steps/s
[Step=37050 Epoch=181.7] | Loss=0.00646 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.172 | 1610.2 samples/s | 25.2 steps/s
[Step=37100 Epoch=181.9] | Loss=0.00574 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.172 | 3743.6 samples/s | 58.5 steps/s
[Step=37150 Epoch=182.2] | Loss=0.00536 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.173 | 3769.7 samples/s | 58.9 steps/s
[Step=37200 Epoch=182.4] | Loss=0.00501 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.174 | 4675.7 samples/s | 73.1 steps/s
[Step=37250 Epoch=182.7] | Loss=0.00467 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.174 | 1637.2 samples/s | 25.6 steps/s
[Step=37300 Epoch=182.9] | Loss=0.00439 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.175 | 3771.0 samples/s | 58.9 steps/s
[Step=37350 Epoch=183.2] | Loss=0.00415 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.176 | 3743.8 samples/s | 58.5 steps/s
[Step=37400 Epoch=183.4] | Loss=0.00400 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.176 | 4512.6 samples/s | 70.5 steps/s
[Step=37450 Epoch=183.6] | Loss=0.00382 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.177 | 1652.7 samples/s | 25.8 steps/s
[Step=37500 Epoch=183.9] | Loss=0.00368 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.178 | 3770.3 samples/s | 58.9 steps/s
[Step=37550 Epoch=184.1] | Loss=0.00361 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.178 | 3762.0 samples/s | 58.8 steps/s
[Step=37600 Epoch=184.4] | Loss=0.00348 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.179 | 4333.3 samples/s | 67.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step37600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=348.7] | Loss=0.08866 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.168 | 3578.6 samples/s | 55.9 steps/s
[Step=36850 Epoch=349.2] | Loss=0.00867 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.391 | FP-Norm(final)=3.167 | 3441.5 samples/s | 53.8 steps/s
[Step=36900 Epoch=349.7] | Loss=0.00438 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=3.167 | 4647.5 samples/s | 72.6 steps/s
[Step=36950 Epoch=350.1] | Loss=0.00293 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=3.167 | 1534.7 samples/s | 24.0 steps/s
[Step=37000 Epoch=350.6] | Loss=0.00221 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.167 | 4331.6 samples/s | 67.7 steps/s
[Step=37050 Epoch=351.1] | Loss=0.00177 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=3.167 | 1571.4 samples/s | 24.6 steps/s
[Step=37100 Epoch=351.6] | Loss=0.00148 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=3.167 | 4049.7 samples/s | 63.3 steps/s
[Step=37150 Epoch=352.0] | Loss=0.00128 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.399 | FP-Norm(final)=3.167 | 1614.8 samples/s | 25.2 steps/s
[Step=37200 Epoch=352.5] | Loss=0.00112 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=3.167 | 3791.1 samples/s | 59.2 steps/s
[Step=37250 Epoch=353.0] | Loss=0.00100 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=3.167 | 1650.3 samples/s | 25.8 steps/s
[Step=37300 Epoch=353.4] | Loss=0.00090 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.168 | 3657.2 samples/s | 57.1 steps/s
[Step=37350 Epoch=353.9] | Loss=0.00082 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.168 | 1701.1 samples/s | 26.6 steps/s
[Step=37400 Epoch=354.4] | Loss=0.00075 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.168 | 3561.8 samples/s | 55.7 steps/s
[Step=37450 Epoch=354.9] | Loss=0.00070 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.168 | 1711.8 samples/s | 26.7 steps/s
[Step=37500 Epoch=355.3] | Loss=0.00065 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=3.168 | 3580.6 samples/s | 55.9 steps/s
[Step=37550 Epoch=355.8] | Loss=0.00061 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.168 | 1717.3 samples/s | 26.8 steps/s
[Step=37600 Epoch=356.3] | Loss=0.00057 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.168 | 3488.4 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step37600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=350.1] | Loss=0.02600 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.168 | 3487.0 samples/s | 54.5 steps/s
[Step=36850 Epoch=350.5] | Loss=0.00385 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.312 | FP-Norm(final)=3.169 | 3368.2 samples/s | 52.6 steps/s
[Step=36900 Epoch=351.0] | Loss=0.00199 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.170 | 4636.1 samples/s | 72.4 steps/s
[Step=36950 Epoch=351.5] | Loss=0.00133 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.170 | 1558.1 samples/s | 24.3 steps/s
[Step=37000 Epoch=352.0] | Loss=0.00101 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.170 | 4279.9 samples/s | 66.9 steps/s
[Step=37050 Epoch=352.4] | Loss=0.00081 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=3.170 | 1612.3 samples/s | 25.2 steps/s
[Step=37100 Epoch=352.9] | Loss=0.00068 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=3.170 | 4083.5 samples/s | 63.8 steps/s
[Step=37150 Epoch=353.4] | Loss=0.00058 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=3.170 | 1627.3 samples/s | 25.4 steps/s
[Step=37200 Epoch=353.9] | Loss=0.00051 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.323 | FP-Norm(final)=3.170 | 3843.9 samples/s | 60.1 steps/s
[Step=37250 Epoch=354.3] | Loss=0.00046 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.319 | FP-Norm(final)=3.170 | 1668.0 samples/s | 26.1 steps/s
[Step=37300 Epoch=354.8] | Loss=0.00041 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.315 | FP-Norm(final)=3.170 | 3576.5 samples/s | 55.9 steps/s
[Step=37350 Epoch=355.3] | Loss=0.00038 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.311 | FP-Norm(final)=3.171 | 1693.0 samples/s | 26.5 steps/s
[Step=37400 Epoch=355.8] | Loss=0.00035 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.308 | FP-Norm(final)=3.171 | 3549.7 samples/s | 55.5 steps/s
[Step=37450 Epoch=356.2] | Loss=0.00032 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.304 | FP-Norm(final)=3.171 | 1725.2 samples/s | 27.0 steps/s
[Step=37500 Epoch=356.7] | Loss=0.00030 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.301 | FP-Norm(final)=3.171 | 3519.7 samples/s | 55.0 steps/s
[Step=37550 Epoch=357.2] | Loss=0.00028 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.299 | FP-Norm(final)=3.171 | 1723.0 samples/s | 26.9 steps/s
[Step=37600 Epoch=357.7] | Loss=0.00026 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.296 | FP-Norm(final)=3.171 | 3567.7 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step37600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=351.4] | Loss=0.03356 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.168 | 3429.5 samples/s | 53.6 steps/s
[Step=36850 Epoch=351.9] | Loss=0.00529 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.169 | 3443.2 samples/s | 53.8 steps/s
[Step=36900 Epoch=352.4] | Loss=0.00268 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.169 | 4679.9 samples/s | 73.1 steps/s
[Step=36950 Epoch=352.8] | Loss=0.00180 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.169 | 1543.4 samples/s | 24.1 steps/s
[Step=37000 Epoch=353.3] | Loss=0.00136 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.169 | 4398.7 samples/s | 68.7 steps/s
[Step=37050 Epoch=353.8] | Loss=0.00109 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.169 | 1565.9 samples/s | 24.5 steps/s
[Step=37100 Epoch=354.3] | Loss=0.00091 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.169 | 4193.4 samples/s | 65.5 steps/s
[Step=37150 Epoch=354.8] | Loss=0.00079 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.170 | 1601.6 samples/s | 25.0 steps/s
[Step=37200 Epoch=355.2] | Loss=0.00069 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.170 | 3996.2 samples/s | 62.4 steps/s
[Step=37250 Epoch=355.7] | Loss=0.00062 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=3.170 | 1635.0 samples/s | 25.5 steps/s
[Step=37300 Epoch=356.2] | Loss=0.00056 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.170 | 3791.2 samples/s | 59.2 steps/s
[Step=37350 Epoch=356.7] | Loss=0.00051 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.170 | 1661.4 samples/s | 26.0 steps/s
[Step=37400 Epoch=357.1] | Loss=0.00047 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=3.170 | 3604.8 samples/s | 56.3 steps/s
[Step=37450 Epoch=357.6] | Loss=0.00043 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=3.170 | 1703.8 samples/s | 26.6 steps/s
[Step=37500 Epoch=358.1] | Loss=0.00040 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=3.170 | 3554.2 samples/s | 55.5 steps/s
[Step=37550 Epoch=358.6] | Loss=0.00038 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.332 | FP-Norm(final)=3.170 | 1702.5 samples/s | 26.6 steps/s
[Step=37600 Epoch=359.1] | Loss=0.00036 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.329 | FP-Norm(final)=3.170 | 3597.0 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step37600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=346.8] | Loss=0.07901 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.168 | 3512.0 samples/s | 54.9 steps/s
[Step=36850 Epoch=347.2] | Loss=0.00539 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=3.168 | 3323.8 samples/s | 51.9 steps/s
[Step=36900 Epoch=347.7] | Loss=0.00271 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.426 | FP-Norm(final)=3.168 | 4596.8 samples/s | 71.8 steps/s
[Step=36950 Epoch=348.2] | Loss=0.00182 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.423 | FP-Norm(final)=3.168 | 1555.8 samples/s | 24.3 steps/s
[Step=37000 Epoch=348.6] | Loss=0.00137 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=3.168 | 4233.3 samples/s | 66.1 steps/s
[Step=37050 Epoch=349.1] | Loss=0.00110 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.168 | 1597.5 samples/s | 25.0 steps/s
[Step=37100 Epoch=349.6] | Loss=0.00092 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=3.169 | 3958.6 samples/s | 61.9 steps/s
[Step=37150 Epoch=350.1] | Loss=0.00079 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=3.169 | 1624.4 samples/s | 25.4 steps/s
[Step=37200 Epoch=350.5] | Loss=0.00069 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.169 | 3661.8 samples/s | 57.2 steps/s
[Step=37250 Epoch=351.0] | Loss=0.00062 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.169 | 1678.7 samples/s | 26.2 steps/s
[Step=37300 Epoch=351.5] | Loss=0.00056 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.169 | 3563.9 samples/s | 55.7 steps/s
[Step=37350 Epoch=351.9] | Loss=0.00051 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.169 | 1723.9 samples/s | 26.9 steps/s
[Step=37400 Epoch=352.4] | Loss=0.00047 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.169 | 3523.4 samples/s | 55.1 steps/s
[Step=37450 Epoch=352.9] | Loss=0.00043 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.169 | 1722.0 samples/s | 26.9 steps/s
[Step=37500 Epoch=353.4] | Loss=0.00040 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.169 | 3512.9 samples/s | 54.9 steps/s
[Step=37550 Epoch=353.8] | Loss=0.00037 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.169 | 1824.9 samples/s | 28.5 steps/s
[Step=37600 Epoch=354.3] | Loss=0.00035 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.169 | 3156.3 samples/s | 49.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step37600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=350.7] | Loss=0.04803 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.168 | 3516.7 samples/s | 54.9 steps/s
[Step=36850 Epoch=351.2] | Loss=0.00537 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.167 | 3336.0 samples/s | 52.1 steps/s
[Step=36900 Epoch=351.7] | Loss=0.00272 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=3.167 | 4686.1 samples/s | 73.2 steps/s
[Step=36950 Epoch=352.2] | Loss=0.00182 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=3.168 | 1538.2 samples/s | 24.0 steps/s
[Step=37000 Epoch=352.6] | Loss=0.00137 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=3.168 | 4379.2 samples/s | 68.4 steps/s
[Step=37050 Epoch=353.1] | Loss=0.00110 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=3.168 | 1567.5 samples/s | 24.5 steps/s
[Step=37100 Epoch=353.6] | Loss=0.00092 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.168 | 4191.6 samples/s | 65.5 steps/s
[Step=37150 Epoch=354.1] | Loss=0.00080 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.168 | 1581.0 samples/s | 24.7 steps/s
[Step=37200 Epoch=354.5] | Loss=0.00070 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.168 | 3981.3 samples/s | 62.2 steps/s
[Step=37250 Epoch=355.0] | Loss=0.00062 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.168 | 1618.8 samples/s | 25.3 steps/s
[Step=37300 Epoch=355.5] | Loss=0.00056 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.168 | 3780.5 samples/s | 59.1 steps/s
[Step=37350 Epoch=356.0] | Loss=0.00051 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.168 | 1663.7 samples/s | 26.0 steps/s
[Step=37400 Epoch=356.5] | Loss=0.00047 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.168 | 3619.7 samples/s | 56.6 steps/s
[Step=37450 Epoch=356.9] | Loss=0.00044 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.168 | 1691.8 samples/s | 26.4 steps/s
[Step=37500 Epoch=357.4] | Loss=0.00041 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.168 | 3592.4 samples/s | 56.1 steps/s
[Step=37550 Epoch=357.9] | Loss=0.00038 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=3.169 | 1694.5 samples/s | 26.5 steps/s
[Step=37600 Epoch=358.4] | Loss=0.00036 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=3.169 | 3578.8 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19201 | acc=0.9108 | tpr=0.8788 | fpr=0.0198 | 3623.8 samples/s | 14.2 steps/s
Avg test loss: 0.19374, Avg test acc: 0.90921, Avg tpr: 0.87737, Avg fpr: 0.02077, total FA: 162

Testing server on iccad2012
[Step=  50] | Loss=0.55676 | acc=0.8645 | tpr=0.9690 | fpr=0.1373 | 3652.2 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.57913 | acc=0.8621 | tpr=0.9744 | fpr=0.1400 | 6735.4 samples/s | 26.3 steps/s
[Step= 150] | Loss=0.59250 | acc=0.8580 | tpr=0.9697 | fpr=0.1440 | 6855.9 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.59249 | acc=0.8594 | tpr=0.9683 | fpr=0.1426 | 6962.2 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.58885 | acc=0.8595 | tpr=0.9642 | fpr=0.1424 | 6551.7 samples/s | 25.6 steps/s
[Step= 300] | Loss=0.59393 | acc=0.8589 | tpr=0.9636 | fpr=0.1430 | 6894.2 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.59469 | acc=0.8594 | tpr=0.9637 | fpr=0.1425 | 6779.4 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.59544 | acc=0.8591 | tpr=0.9633 | fpr=0.1428 | 6661.1 samples/s | 26.0 steps/s
[Step= 450] | Loss=0.60091 | acc=0.8586 | tpr=0.9635 | fpr=0.1433 | 7128.3 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.60084 | acc=0.8584 | tpr=0.9643 | fpr=0.1435 | 6453.4 samples/s | 25.2 steps/s
[Step= 550] | Loss=0.60013 | acc=0.8586 | tpr=0.9650 | fpr=0.1433 | 12535.9 samples/s | 49.0 steps/s
Avg test loss: 0.59989, Avg test acc: 0.85866, Avg tpr: 0.96513, Avg fpr: 0.14328, total FA: 19894

server round 47/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.3] | Loss=0.13288 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.178 | 3638.2 samples/s | 56.8 steps/s
[Step=37650 Epoch=183.6] | Loss=0.01525 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.305 | FP-Norm(final)=3.179 | 3678.1 samples/s | 57.5 steps/s
[Step=37700 Epoch=183.8] | Loss=0.01119 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.324 | FP-Norm(final)=3.179 | 3724.2 samples/s | 58.2 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00950 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=3.180 | 3773.5 samples/s | 59.0 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00857 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=3.180 | 4847.6 samples/s | 75.7 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00744 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.181 | 1614.7 samples/s | 25.2 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00676 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.181 | 3760.6 samples/s | 58.8 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00605 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.182 | 3754.7 samples/s | 58.7 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00593 | Reg=0.00013 | acc=0.9688 | FP-Norm=0.353 | FP-Norm(final)=3.183 | 4564.2 samples/s | 71.3 steps/s
[Step=38050 Epoch=185.5] | Loss=0.00552 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.183 | 1668.9 samples/s | 26.1 steps/s
[Step=38100 Epoch=185.8] | Loss=0.00527 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.184 | 3762.8 samples/s | 58.8 steps/s
[Step=38150 Epoch=186.0] | Loss=0.00504 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.184 | 3765.9 samples/s | 58.8 steps/s
[Step=38200 Epoch=186.3] | Loss=0.00490 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.185 | 4296.9 samples/s | 67.1 steps/s
[Step=38250 Epoch=186.5] | Loss=0.00465 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.186 | 1698.8 samples/s | 26.5 steps/s
[Step=38300 Epoch=186.8] | Loss=0.00448 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.186 | 3766.9 samples/s | 58.9 steps/s
[Step=38350 Epoch=187.0] | Loss=0.00430 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.187 | 3618.5 samples/s | 56.5 steps/s
[Step=38400 Epoch=187.2] | Loss=0.00422 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.187 | 4027.8 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step38400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.5] | Loss=0.04863 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.178 | 3646.4 samples/s | 57.0 steps/s
[Step=37650 Epoch=183.7] | Loss=0.01755 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.315 | FP-Norm(final)=3.178 | 3638.5 samples/s | 56.9 steps/s
[Step=37700 Epoch=184.0] | Loss=0.01202 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=3.179 | 3759.5 samples/s | 58.7 steps/s
[Step=37750 Epoch=184.2] | Loss=0.00978 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.179 | 3800.2 samples/s | 59.4 steps/s
[Step=37800 Epoch=184.4] | Loss=0.00833 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.180 | 4826.4 samples/s | 75.4 steps/s
[Step=37850 Epoch=184.7] | Loss=0.00720 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.181 | 1616.5 samples/s | 25.3 steps/s
[Step=37900 Epoch=184.9] | Loss=0.00637 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.181 | 3758.7 samples/s | 58.7 steps/s
[Step=37950 Epoch=185.2] | Loss=0.00591 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.182 | 3761.9 samples/s | 58.8 steps/s
[Step=38000 Epoch=185.4] | Loss=0.00563 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.363 | FP-Norm(final)=3.182 | 4622.7 samples/s | 72.2 steps/s
[Step=38050 Epoch=185.7] | Loss=0.00520 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.183 | 1645.0 samples/s | 25.7 steps/s
[Step=38100 Epoch=185.9] | Loss=0.00494 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.184 | 3604.4 samples/s | 56.3 steps/s
[Step=38150 Epoch=186.2] | Loss=0.00470 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.184 | 3623.3 samples/s | 56.6 steps/s
[Step=38200 Epoch=186.4] | Loss=0.00447 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.185 | 4274.6 samples/s | 66.8 steps/s
[Step=38250 Epoch=186.6] | Loss=0.00440 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.185 | 1590.8 samples/s | 24.9 steps/s
[Step=38300 Epoch=186.9] | Loss=0.00425 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.186 | 3625.8 samples/s | 56.7 steps/s
[Step=38350 Epoch=187.1] | Loss=0.00409 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.186 | 3591.6 samples/s | 56.1 steps/s
[Step=38400 Epoch=187.4] | Loss=0.00404 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.187 | 4035.5 samples/s | 63.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step38400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.2] | Loss=0.15258 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.178 | 3437.4 samples/s | 53.7 steps/s
[Step=37650 Epoch=183.4] | Loss=0.01621 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.274 | FP-Norm(final)=3.179 | 3531.3 samples/s | 55.2 steps/s
[Step=37700 Epoch=183.7] | Loss=0.01103 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.300 | FP-Norm(final)=3.180 | 3610.5 samples/s | 56.4 steps/s
[Step=37750 Epoch=183.9] | Loss=0.00922 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.315 | FP-Norm(final)=3.180 | 3639.9 samples/s | 56.9 steps/s
[Step=37800 Epoch=184.2] | Loss=0.00810 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.326 | FP-Norm(final)=3.181 | 4656.5 samples/s | 72.8 steps/s
[Step=37850 Epoch=184.4] | Loss=0.00778 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=3.182 | 1514.7 samples/s | 23.7 steps/s
[Step=37900 Epoch=184.7] | Loss=0.00691 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=3.182 | 3638.9 samples/s | 56.9 steps/s
[Step=37950 Epoch=184.9] | Loss=0.00631 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=3.183 | 3757.5 samples/s | 58.7 steps/s
[Step=38000 Epoch=185.2] | Loss=0.00595 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.183 | 4442.6 samples/s | 69.4 steps/s
[Step=38050 Epoch=185.4] | Loss=0.00544 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.184 | 1641.4 samples/s | 25.6 steps/s
[Step=38100 Epoch=185.6] | Loss=0.00520 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.185 | 3688.0 samples/s | 57.6 steps/s
[Step=38150 Epoch=185.9] | Loss=0.00490 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.185 | 3724.7 samples/s | 58.2 steps/s
[Step=38200 Epoch=186.1] | Loss=0.00473 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.186 | 4305.2 samples/s | 67.3 steps/s
[Step=38250 Epoch=186.4] | Loss=0.00447 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.186 | 1670.2 samples/s | 26.1 steps/s
[Step=38300 Epoch=186.6] | Loss=0.00423 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.187 | 3620.2 samples/s | 56.6 steps/s
[Step=38350 Epoch=186.9] | Loss=0.00413 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.188 | 3376.3 samples/s | 52.8 steps/s
[Step=38400 Epoch=187.1] | Loss=0.00397 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.188 | 3589.7 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step38400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.4] | Loss=0.08623 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.178 | 3670.8 samples/s | 57.4 steps/s
[Step=37650 Epoch=183.6] | Loss=0.01608 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.330 | FP-Norm(final)=3.179 | 3509.6 samples/s | 54.8 steps/s
[Step=37700 Epoch=183.8] | Loss=0.01052 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.179 | 3738.8 samples/s | 58.4 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00813 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.180 | 3692.3 samples/s | 57.7 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00726 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.181 | 4766.7 samples/s | 74.5 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00625 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.181 | 1573.7 samples/s | 24.6 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00562 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.372 | FP-Norm(final)=3.182 | 3745.6 samples/s | 58.5 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00505 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.183 | 3766.3 samples/s | 58.8 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00484 | Reg=0.00014 | acc=0.9531 | FP-Norm=0.372 | FP-Norm(final)=3.183 | 4526.0 samples/s | 70.7 steps/s
[Step=38050 Epoch=185.6] | Loss=0.00454 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.184 | 1625.7 samples/s | 25.4 steps/s
[Step=38100 Epoch=185.8] | Loss=0.00431 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.185 | 3564.6 samples/s | 55.7 steps/s
[Step=38150 Epoch=186.0] | Loss=0.00405 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.185 | 3566.8 samples/s | 55.7 steps/s
[Step=38200 Epoch=186.3] | Loss=0.00383 | Reg=0.00014 | acc=0.9844 | FP-Norm=0.367 | FP-Norm(final)=3.186 | 4110.1 samples/s | 64.2 steps/s
[Step=38250 Epoch=186.5] | Loss=0.00372 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=3.186 | 1617.5 samples/s | 25.3 steps/s
[Step=38300 Epoch=186.8] | Loss=0.00354 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.187 | 3699.6 samples/s | 57.8 steps/s
[Step=38350 Epoch=187.0] | Loss=0.00341 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.188 | 3711.8 samples/s | 58.0 steps/s
[Step=38400 Epoch=187.3] | Loss=0.00331 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.188 | 3951.0 samples/s | 61.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step38400.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=184.4] | Loss=0.08192 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.178 | 3678.6 samples/s | 57.5 steps/s
[Step=37650 Epoch=184.6] | Loss=0.01393 | Reg=0.00008 | acc=0.9688 | FP-Norm=0.263 | FP-Norm(final)=3.179 | 3494.6 samples/s | 54.6 steps/s
[Step=37700 Epoch=184.9] | Loss=0.00939 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.287 | FP-Norm(final)=3.179 | 3730.5 samples/s | 58.3 steps/s
[Step=37750 Epoch=185.1] | Loss=0.00761 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.300 | FP-Norm(final)=3.180 | 3715.5 samples/s | 58.1 steps/s
[Step=37800 Epoch=185.4] | Loss=0.00713 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.309 | FP-Norm(final)=3.181 | 4858.4 samples/s | 75.9 steps/s
[Step=37850 Epoch=185.6] | Loss=0.00609 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.316 | FP-Norm(final)=3.182 | 1574.3 samples/s | 24.6 steps/s
[Step=37900 Epoch=185.9] | Loss=0.00547 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.316 | FP-Norm(final)=3.182 | 3716.7 samples/s | 58.1 steps/s
[Step=37950 Epoch=186.1] | Loss=0.00511 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.317 | FP-Norm(final)=3.183 | 3689.7 samples/s | 57.7 steps/s
[Step=38000 Epoch=186.3] | Loss=0.00485 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.318 | FP-Norm(final)=3.184 | 4606.0 samples/s | 72.0 steps/s
[Step=38050 Epoch=186.6] | Loss=0.00451 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.318 | FP-Norm(final)=3.184 | 1604.0 samples/s | 25.1 steps/s
[Step=38100 Epoch=186.8] | Loss=0.00433 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.318 | FP-Norm(final)=3.185 | 3753.1 samples/s | 58.6 steps/s
[Step=38150 Epoch=187.1] | Loss=0.00413 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.319 | FP-Norm(final)=3.186 | 3717.1 samples/s | 58.1 steps/s
[Step=38200 Epoch=187.3] | Loss=0.00399 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.319 | FP-Norm(final)=3.186 | 4471.3 samples/s | 69.9 steps/s
[Step=38250 Epoch=187.6] | Loss=0.00382 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.319 | FP-Norm(final)=3.187 | 1642.7 samples/s | 25.7 steps/s
[Step=38300 Epoch=187.8] | Loss=0.00365 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.320 | FP-Norm(final)=3.188 | 3672.0 samples/s | 57.4 steps/s
[Step=38350 Epoch=188.1] | Loss=0.00359 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.320 | FP-Norm(final)=3.188 | 3706.8 samples/s | 57.9 steps/s
[Step=38400 Epoch=188.3] | Loss=0.00345 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.320 | FP-Norm(final)=3.189 | 4304.3 samples/s | 67.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step38400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=356.3] | Loss=0.11501 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.178 | 3666.7 samples/s | 57.3 steps/s
[Step=37650 Epoch=356.8] | Loss=0.00529 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.179 | 3081.5 samples/s | 48.1 steps/s
[Step=37700 Epoch=357.2] | Loss=0.00270 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=3.180 | 4580.8 samples/s | 71.6 steps/s
[Step=37750 Epoch=357.7] | Loss=0.00181 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.180 | 1505.1 samples/s | 23.5 steps/s
[Step=37800 Epoch=358.2] | Loss=0.00136 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.180 | 4288.9 samples/s | 67.0 steps/s
[Step=37850 Epoch=358.7] | Loss=0.00110 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.180 | 1564.4 samples/s | 24.4 steps/s
[Step=37900 Epoch=359.1] | Loss=0.00092 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.180 | 4000.0 samples/s | 62.5 steps/s
[Step=37950 Epoch=359.6] | Loss=0.00079 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.180 | 1605.0 samples/s | 25.1 steps/s
[Step=38000 Epoch=360.1] | Loss=0.00070 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.180 | 3737.7 samples/s | 58.4 steps/s
[Step=38050 Epoch=360.6] | Loss=0.00062 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.180 | 1609.4 samples/s | 25.1 steps/s
[Step=38100 Epoch=361.0] | Loss=0.00056 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.180 | 3515.8 samples/s | 54.9 steps/s
[Step=38150 Epoch=361.5] | Loss=0.00051 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.180 | 1667.3 samples/s | 26.1 steps/s
[Step=38200 Epoch=362.0] | Loss=0.00047 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.180 | 3533.2 samples/s | 55.2 steps/s
[Step=38250 Epoch=362.5] | Loss=0.00044 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.180 | 1668.6 samples/s | 26.1 steps/s
[Step=38300 Epoch=362.9] | Loss=0.00041 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=3.180 | 3514.9 samples/s | 54.9 steps/s
[Step=38350 Epoch=363.4] | Loss=0.00038 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=3.180 | 1701.9 samples/s | 26.6 steps/s
[Step=38400 Epoch=363.9] | Loss=0.00036 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=3.181 | 3491.4 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step38400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=357.7] | Loss=0.15166 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.178 | 3484.3 samples/s | 54.4 steps/s
[Step=37650 Epoch=358.1] | Loss=0.00767 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.178 | 3274.4 samples/s | 51.2 steps/s
[Step=37700 Epoch=358.6] | Loss=0.00386 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.179 | 4605.9 samples/s | 72.0 steps/s
[Step=37750 Epoch=359.1] | Loss=0.00259 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=3.179 | 1498.8 samples/s | 23.4 steps/s
[Step=37800 Epoch=359.6] | Loss=0.00194 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=3.179 | 4308.2 samples/s | 67.3 steps/s
[Step=37850 Epoch=360.0] | Loss=0.00156 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.179 | 1553.0 samples/s | 24.3 steps/s
[Step=37900 Epoch=360.5] | Loss=0.00130 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.179 | 4052.6 samples/s | 63.3 steps/s
[Step=37950 Epoch=361.0] | Loss=0.00112 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.179 | 1589.7 samples/s | 24.8 steps/s
[Step=38000 Epoch=361.5] | Loss=0.00098 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.179 | 3752.9 samples/s | 58.6 steps/s
[Step=38050 Epoch=362.0] | Loss=0.00087 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.179 | 1635.5 samples/s | 25.6 steps/s
[Step=38100 Epoch=362.4] | Loss=0.00079 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.179 | 3580.0 samples/s | 55.9 steps/s
[Step=38150 Epoch=362.9] | Loss=0.00072 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.179 | 1698.3 samples/s | 26.5 steps/s
[Step=38200 Epoch=363.4] | Loss=0.00066 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.179 | 3521.3 samples/s | 55.0 steps/s
[Step=38250 Epoch=363.9] | Loss=0.00061 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.179 | 1680.5 samples/s | 26.3 steps/s
[Step=38300 Epoch=364.3] | Loss=0.00057 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.179 | 3480.3 samples/s | 54.4 steps/s
[Step=38350 Epoch=364.8] | Loss=0.00053 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=3.179 | 1727.4 samples/s | 27.0 steps/s
[Step=38400 Epoch=365.3] | Loss=0.00050 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=3.179 | 3422.7 samples/s | 53.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step38400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=359.1] | Loss=0.14747 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.178 | 3494.7 samples/s | 54.6 steps/s
[Step=37650 Epoch=359.5] | Loss=0.00886 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.178 | 3364.9 samples/s | 52.6 steps/s
[Step=37700 Epoch=360.0] | Loss=0.00446 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.401 | FP-Norm(final)=3.178 | 4620.7 samples/s | 72.2 steps/s
[Step=37750 Epoch=360.5] | Loss=0.00298 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=3.178 | 1529.0 samples/s | 23.9 steps/s
[Step=37800 Epoch=361.0] | Loss=0.00225 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=3.178 | 4390.6 samples/s | 68.6 steps/s
[Step=37850 Epoch=361.4] | Loss=0.00180 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.178 | 1547.8 samples/s | 24.2 steps/s
[Step=37900 Epoch=361.9] | Loss=0.00151 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.178 | 4111.6 samples/s | 64.2 steps/s
[Step=37950 Epoch=362.4] | Loss=0.00130 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.178 | 1565.7 samples/s | 24.5 steps/s
[Step=38000 Epoch=362.9] | Loss=0.00114 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.178 | 3928.2 samples/s | 61.4 steps/s
[Step=38050 Epoch=363.4] | Loss=0.00101 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.178 | 1575.5 samples/s | 24.6 steps/s
[Step=38100 Epoch=363.8] | Loss=0.00091 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.178 | 3673.2 samples/s | 57.4 steps/s
[Step=38150 Epoch=364.3] | Loss=0.00083 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.178 | 1632.3 samples/s | 25.5 steps/s
[Step=38200 Epoch=364.8] | Loss=0.00076 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.178 | 3552.1 samples/s | 55.5 steps/s
[Step=38250 Epoch=365.3] | Loss=0.00071 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.178 | 1668.4 samples/s | 26.1 steps/s
[Step=38300 Epoch=365.7] | Loss=0.00066 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.178 | 3557.2 samples/s | 55.6 steps/s
[Step=38350 Epoch=366.2] | Loss=0.00061 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.178 | 1688.0 samples/s | 26.4 steps/s
[Step=38400 Epoch=366.7] | Loss=0.00058 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.178 | 3537.4 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step38400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=354.3] | Loss=0.09584 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.178 | 3687.3 samples/s | 57.6 steps/s
[Step=37650 Epoch=354.8] | Loss=0.00539 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.178 | 3174.4 samples/s | 49.6 steps/s
[Step=37700 Epoch=355.2] | Loss=0.00271 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.406 | FP-Norm(final)=3.178 | 4478.6 samples/s | 70.0 steps/s
[Step=37750 Epoch=355.7] | Loss=0.00182 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.179 | 1533.2 samples/s | 24.0 steps/s
[Step=37800 Epoch=356.2] | Loss=0.00137 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=3.179 | 4235.8 samples/s | 66.2 steps/s
[Step=37850 Epoch=356.7] | Loss=0.00110 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=3.179 | 1569.3 samples/s | 24.5 steps/s
[Step=37900 Epoch=357.1] | Loss=0.00092 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.179 | 3872.9 samples/s | 60.5 steps/s
[Step=37950 Epoch=357.6] | Loss=0.00079 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.179 | 1620.1 samples/s | 25.3 steps/s
[Step=38000 Epoch=358.1] | Loss=0.00069 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.179 | 3659.0 samples/s | 57.2 steps/s
[Step=38050 Epoch=358.5] | Loss=0.00062 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.370 | FP-Norm(final)=3.179 | 1655.9 samples/s | 25.9 steps/s
[Step=38100 Epoch=359.0] | Loss=0.00056 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=3.179 | 3539.5 samples/s | 55.3 steps/s
[Step=38150 Epoch=359.5] | Loss=0.00051 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.179 | 1701.3 samples/s | 26.6 steps/s
[Step=38200 Epoch=360.0] | Loss=0.00047 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.179 | 3479.0 samples/s | 54.4 steps/s
[Step=38250 Epoch=360.4] | Loss=0.00043 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.179 | 1695.5 samples/s | 26.5 steps/s
[Step=38300 Epoch=360.9] | Loss=0.00040 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.179 | 3509.5 samples/s | 54.8 steps/s
[Step=38350 Epoch=361.4] | Loss=0.00038 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.179 | 1877.8 samples/s | 29.3 steps/s
[Step=38400 Epoch=361.8] | Loss=0.00035 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.179 | 3018.8 samples/s | 47.2 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step38400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=358.4] | Loss=0.08793 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.178 | 3231.6 samples/s | 50.5 steps/s
[Step=37650 Epoch=358.8] | Loss=0.00306 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=3.180 | 3538.9 samples/s | 55.3 steps/s
[Step=37700 Epoch=359.3] | Loss=0.00155 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.180 | 4608.4 samples/s | 72.0 steps/s
[Step=37750 Epoch=359.8] | Loss=0.00105 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.180 | 1482.8 samples/s | 23.2 steps/s
[Step=37800 Epoch=360.3] | Loss=0.00079 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.180 | 4282.9 samples/s | 66.9 steps/s
[Step=37850 Epoch=360.7] | Loss=0.00064 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.180 | 1555.2 samples/s | 24.3 steps/s
[Step=37900 Epoch=361.2] | Loss=0.00053 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=3.180 | 4155.1 samples/s | 64.9 steps/s
[Step=37950 Epoch=361.7] | Loss=0.00046 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.181 | 1091.4 samples/s | 17.1 steps/s
[Step=38000 Epoch=362.2] | Loss=0.00041 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=3.181 | 3815.0 samples/s | 59.6 steps/s
[Step=38050 Epoch=362.7] | Loss=0.00036 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=3.181 | 1593.2 samples/s | 24.9 steps/s
[Step=38100 Epoch=363.1] | Loss=0.00033 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.330 | FP-Norm(final)=3.181 | 3712.0 samples/s | 58.0 steps/s
[Step=38150 Epoch=363.6] | Loss=0.00030 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.326 | FP-Norm(final)=3.181 | 1633.9 samples/s | 25.5 steps/s
[Step=38200 Epoch=364.1] | Loss=0.00028 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.322 | FP-Norm(final)=3.181 | 3562.4 samples/s | 55.7 steps/s
[Step=38250 Epoch=364.6] | Loss=0.00026 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.319 | FP-Norm(final)=3.181 | 1673.6 samples/s | 26.1 steps/s
[Step=38300 Epoch=365.0] | Loss=0.00024 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.316 | FP-Norm(final)=3.181 | 3547.9 samples/s | 55.4 steps/s
[Step=38350 Epoch=365.5] | Loss=0.00022 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.312 | FP-Norm(final)=3.181 | 1693.6 samples/s | 26.5 steps/s
[Step=38400 Epoch=366.0] | Loss=0.00021 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.309 | FP-Norm(final)=3.181 | 3447.3 samples/s | 53.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19295 | acc=0.9106 | tpr=0.8788 | fpr=0.0203 | 3498.3 samples/s | 13.7 steps/s
Avg test loss: 0.19459, Avg test acc: 0.90917, Avg tpr: 0.87766, Avg fpr: 0.02154, total FA: 168

Testing server on iccad2012
[Step=  50] | Loss=0.54515 | acc=0.8695 | tpr=0.9735 | fpr=0.1323 | 3555.1 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.56781 | acc=0.8666 | tpr=0.9765 | fpr=0.1354 | 6494.1 samples/s | 25.4 steps/s
[Step= 150] | Loss=0.58107 | acc=0.8628 | tpr=0.9712 | fpr=0.1392 | 6334.5 samples/s | 24.7 steps/s
[Step= 200] | Loss=0.58119 | acc=0.8637 | tpr=0.9705 | fpr=0.1382 | 6700.6 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.57772 | acc=0.8639 | tpr=0.9659 | fpr=0.1380 | 6621.8 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.58296 | acc=0.8633 | tpr=0.9651 | fpr=0.1386 | 6544.5 samples/s | 25.6 steps/s
[Step= 350] | Loss=0.58389 | acc=0.8637 | tpr=0.9649 | fpr=0.1382 | 6694.3 samples/s | 26.1 steps/s
[Step= 400] | Loss=0.58471 | acc=0.8635 | tpr=0.9639 | fpr=0.1383 | 6247.5 samples/s | 24.4 steps/s
[Step= 450] | Loss=0.59025 | acc=0.8632 | tpr=0.9640 | fpr=0.1387 | 6478.2 samples/s | 25.3 steps/s
[Step= 500] | Loss=0.59016 | acc=0.8629 | tpr=0.9648 | fpr=0.1390 | 6560.2 samples/s | 25.6 steps/s
[Step= 550] | Loss=0.58936 | acc=0.8631 | tpr=0.9650 | fpr=0.1387 | 12009.5 samples/s | 46.9 steps/s
Avg test loss: 0.58913, Avg test acc: 0.86316, Avg tpr: 0.96513, Avg fpr: 0.13869, total FA: 19257

server round 48/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.3] | Loss=0.06732 | Reg=0.00000 | acc=0.9375 | FP-Norm=0.000 | FP-Norm(final)=3.188 | 3561.6 samples/s | 55.6 steps/s
[Step=38450 Epoch=187.5] | Loss=0.01547 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.299 | FP-Norm(final)=3.189 | 3667.3 samples/s | 57.3 steps/s
[Step=38500 Epoch=187.7] | Loss=0.01061 | Reg=0.00012 | acc=0.9688 | FP-Norm=0.329 | FP-Norm(final)=3.189 | 3725.8 samples/s | 58.2 steps/s
[Step=38550 Epoch=188.0] | Loss=0.00929 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.337 | FP-Norm(final)=3.189 | 3690.3 samples/s | 57.7 steps/s
[Step=38600 Epoch=188.2] | Loss=0.00799 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.190 | 4746.4 samples/s | 74.2 steps/s
[Step=38650 Epoch=188.5] | Loss=0.00687 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.345 | FP-Norm(final)=3.190 | 1605.0 samples/s | 25.1 steps/s
[Step=38700 Epoch=188.7] | Loss=0.00630 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.191 | 3730.9 samples/s | 58.3 steps/s
[Step=38750 Epoch=189.0] | Loss=0.00590 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.192 | 3727.6 samples/s | 58.2 steps/s
[Step=38800 Epoch=189.2] | Loss=0.00554 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.192 | 4521.5 samples/s | 70.6 steps/s
[Step=38850 Epoch=189.4] | Loss=0.00530 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.193 | 1653.0 samples/s | 25.8 steps/s
[Step=38900 Epoch=189.7] | Loss=0.00489 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.193 | 3737.1 samples/s | 58.4 steps/s
[Step=38950 Epoch=189.9] | Loss=0.00469 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.194 | 3721.4 samples/s | 58.1 steps/s
[Step=39000 Epoch=190.2] | Loss=0.00465 | Reg=0.00012 | acc=0.9688 | FP-Norm=0.347 | FP-Norm(final)=3.195 | 4214.4 samples/s | 65.9 steps/s
[Step=39050 Epoch=190.4] | Loss=0.00445 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.195 | 1667.7 samples/s | 26.1 steps/s
[Step=39100 Epoch=190.7] | Loss=0.00437 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.196 | 3739.5 samples/s | 58.4 steps/s
[Step=39150 Epoch=190.9] | Loss=0.00423 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.196 | 3717.5 samples/s | 58.1 steps/s
[Step=39200 Epoch=191.1] | Loss=0.00405 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.197 | 4012.1 samples/s | 62.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step39200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.4] | Loss=0.05768 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.188 | 3710.5 samples/s | 58.0 steps/s
[Step=38450 Epoch=187.6] | Loss=0.01529 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.313 | FP-Norm(final)=3.189 | 3448.3 samples/s | 53.9 steps/s
[Step=38500 Epoch=187.9] | Loss=0.01187 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.189 | 3693.6 samples/s | 57.7 steps/s
[Step=38550 Epoch=188.1] | Loss=0.00918 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.190 | 3706.3 samples/s | 57.9 steps/s
[Step=38600 Epoch=188.4] | Loss=0.00813 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.190 | 4778.0 samples/s | 74.7 steps/s
[Step=38650 Epoch=188.6] | Loss=0.00697 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.191 | 1584.6 samples/s | 24.8 steps/s
[Step=38700 Epoch=188.8] | Loss=0.00611 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.191 | 3745.5 samples/s | 58.5 steps/s
[Step=38750 Epoch=189.1] | Loss=0.00576 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.192 | 3735.3 samples/s | 58.4 steps/s
[Step=38800 Epoch=189.3] | Loss=0.00539 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.192 | 4550.0 samples/s | 71.1 steps/s
[Step=38850 Epoch=189.6] | Loss=0.00505 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.193 | 1623.6 samples/s | 25.4 steps/s
[Step=38900 Epoch=189.8] | Loss=0.00482 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.193 | 3706.5 samples/s | 57.9 steps/s
[Step=38950 Epoch=190.1] | Loss=0.00458 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.360 | FP-Norm(final)=3.194 | 3679.4 samples/s | 57.5 steps/s
[Step=39000 Epoch=190.3] | Loss=0.00441 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.195 | 4298.0 samples/s | 67.2 steps/s
[Step=39050 Epoch=190.5] | Loss=0.00427 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.195 | 1642.7 samples/s | 25.7 steps/s
[Step=39100 Epoch=190.8] | Loss=0.00418 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.196 | 3737.0 samples/s | 58.4 steps/s
[Step=39150 Epoch=191.0] | Loss=0.00401 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.196 | 3720.0 samples/s | 58.1 steps/s
[Step=39200 Epoch=191.3] | Loss=0.00387 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.197 | 4137.2 samples/s | 64.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step39200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.1] | Loss=0.07733 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.188 | 3792.0 samples/s | 59.2 steps/s
[Step=38450 Epoch=187.3] | Loss=0.01625 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.297 | FP-Norm(final)=3.189 | 3440.3 samples/s | 53.8 steps/s
[Step=38500 Epoch=187.6] | Loss=0.01181 | Reg=0.00011 | acc=0.9688 | FP-Norm=0.325 | FP-Norm(final)=3.189 | 3677.8 samples/s | 57.5 steps/s
[Step=38550 Epoch=187.8] | Loss=0.00969 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=3.190 | 3707.5 samples/s | 57.9 steps/s
[Step=38600 Epoch=188.1] | Loss=0.00813 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.190 | 4778.3 samples/s | 74.7 steps/s
[Step=38650 Epoch=188.3] | Loss=0.00703 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=3.191 | 1588.0 samples/s | 24.8 steps/s
[Step=38700 Epoch=188.6] | Loss=0.00634 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.350 | FP-Norm(final)=3.192 | 3683.6 samples/s | 57.6 steps/s
[Step=38750 Epoch=188.8] | Loss=0.00577 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.350 | FP-Norm(final)=3.193 | 3696.1 samples/s | 57.8 steps/s
[Step=38800 Epoch=189.1] | Loss=0.00537 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.193 | 4423.6 samples/s | 69.1 steps/s
[Step=38850 Epoch=189.3] | Loss=0.00506 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=3.194 | 1610.9 samples/s | 25.2 steps/s
[Step=38900 Epoch=189.5] | Loss=0.00483 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=3.195 | 3690.8 samples/s | 57.7 steps/s
[Step=38950 Epoch=189.8] | Loss=0.00461 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=3.195 | 3738.9 samples/s | 58.4 steps/s
[Step=39000 Epoch=190.0] | Loss=0.00437 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.196 | 4256.3 samples/s | 66.5 steps/s
[Step=39050 Epoch=190.3] | Loss=0.00418 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.197 | 1655.2 samples/s | 25.9 steps/s
[Step=39100 Epoch=190.5] | Loss=0.00407 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.197 | 3703.5 samples/s | 57.9 steps/s
[Step=39150 Epoch=190.8] | Loss=0.00390 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.198 | 3763.1 samples/s | 58.8 steps/s
[Step=39200 Epoch=191.0] | Loss=0.00380 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.347 | FP-Norm(final)=3.198 | 3960.5 samples/s | 61.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step39200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.3] | Loss=0.04534 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.188 | 3749.1 samples/s | 58.6 steps/s
[Step=38450 Epoch=187.5] | Loss=0.01391 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.308 | FP-Norm(final)=3.189 | 3517.2 samples/s | 55.0 steps/s
[Step=38500 Epoch=187.7] | Loss=0.00912 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=3.190 | 3728.6 samples/s | 58.3 steps/s
[Step=38550 Epoch=188.0] | Loss=0.00730 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.190 | 3735.6 samples/s | 58.4 steps/s
[Step=38600 Epoch=188.2] | Loss=0.00637 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.354 | FP-Norm(final)=3.191 | 4808.0 samples/s | 75.1 steps/s
[Step=38650 Epoch=188.5] | Loss=0.00554 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.192 | 1592.7 samples/s | 24.9 steps/s
[Step=38700 Epoch=188.7] | Loss=0.00493 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.193 | 3751.3 samples/s | 58.6 steps/s
[Step=38750 Epoch=189.0] | Loss=0.00466 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.359 | FP-Norm(final)=3.193 | 3735.9 samples/s | 58.4 steps/s
[Step=38800 Epoch=189.2] | Loss=0.00443 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.194 | 4501.2 samples/s | 70.3 steps/s
[Step=38850 Epoch=189.5] | Loss=0.00413 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.195 | 1641.9 samples/s | 25.7 steps/s
[Step=38900 Epoch=189.7] | Loss=0.00391 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.195 | 3704.2 samples/s | 57.9 steps/s
[Step=38950 Epoch=189.9] | Loss=0.00375 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.196 | 3731.2 samples/s | 58.3 steps/s
[Step=39000 Epoch=190.2] | Loss=0.00360 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.197 | 4239.3 samples/s | 66.2 steps/s
[Step=39050 Epoch=190.4] | Loss=0.00346 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.197 | 1645.8 samples/s | 25.7 steps/s
[Step=39100 Epoch=190.7] | Loss=0.00338 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.198 | 3669.0 samples/s | 57.3 steps/s
[Step=39150 Epoch=190.9] | Loss=0.00326 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.198 | 3693.8 samples/s | 57.7 steps/s
[Step=39200 Epoch=191.2] | Loss=0.00320 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.199 | 3933.3 samples/s | 61.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step39200.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=188.3] | Loss=0.05218 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.188 | 3520.7 samples/s | 55.0 steps/s
[Step=38450 Epoch=188.6] | Loss=0.01277 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.288 | FP-Norm(final)=3.189 | 3553.9 samples/s | 55.5 steps/s
[Step=38500 Epoch=188.8] | Loss=0.00853 | Reg=0.00011 | acc=0.9844 | FP-Norm=0.327 | FP-Norm(final)=3.190 | 3713.2 samples/s | 58.0 steps/s
[Step=38550 Epoch=189.0] | Loss=0.00730 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=3.190 | 3663.0 samples/s | 57.2 steps/s
[Step=38600 Epoch=189.3] | Loss=0.00656 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.191 | 4818.4 samples/s | 75.3 steps/s
[Step=38650 Epoch=189.5] | Loss=0.00567 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.192 | 1555.8 samples/s | 24.3 steps/s
[Step=38700 Epoch=189.8] | Loss=0.00511 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.193 | 3733.4 samples/s | 58.3 steps/s
[Step=38750 Epoch=190.0] | Loss=0.00477 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.193 | 3710.7 samples/s | 58.0 steps/s
[Step=38800 Epoch=190.3] | Loss=0.00450 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.341 | FP-Norm(final)=3.194 | 4597.4 samples/s | 71.8 steps/s
[Step=38850 Epoch=190.5] | Loss=0.00424 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=3.195 | 1583.4 samples/s | 24.7 steps/s
[Step=38900 Epoch=190.8] | Loss=0.00397 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=3.195 | 3692.5 samples/s | 57.7 steps/s
[Step=38950 Epoch=191.0] | Loss=0.00375 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=3.196 | 3702.3 samples/s | 57.8 steps/s
[Step=39000 Epoch=191.2] | Loss=0.00365 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=3.197 | 4399.7 samples/s | 68.7 steps/s
[Step=39050 Epoch=191.5] | Loss=0.00351 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=3.197 | 1641.1 samples/s | 25.6 steps/s
[Step=39100 Epoch=191.7] | Loss=0.00337 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=3.198 | 3721.3 samples/s | 58.1 steps/s
[Step=39150 Epoch=192.0] | Loss=0.00331 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=3.198 | 3698.9 samples/s | 57.8 steps/s
[Step=39200 Epoch=192.2] | Loss=0.00327 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=3.199 | 4259.2 samples/s | 66.6 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step39200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=363.9] | Loss=0.02781 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.188 | 3673.0 samples/s | 57.4 steps/s
[Step=38450 Epoch=364.3] | Loss=0.00523 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.189 | 3144.1 samples/s | 49.1 steps/s
[Step=38500 Epoch=364.8] | Loss=0.00269 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.383 | FP-Norm(final)=3.189 | 4548.4 samples/s | 71.1 steps/s
[Step=38550 Epoch=365.3] | Loss=0.00181 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.189 | 1491.6 samples/s | 23.3 steps/s
[Step=38600 Epoch=365.8] | Loss=0.00137 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.190 | 4234.5 samples/s | 66.2 steps/s
[Step=38650 Epoch=366.2] | Loss=0.00110 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.190 | 1557.6 samples/s | 24.3 steps/s
[Step=38700 Epoch=366.7] | Loss=0.00092 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.190 | 4022.0 samples/s | 62.8 steps/s
[Step=38750 Epoch=367.2] | Loss=0.00079 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.366 | FP-Norm(final)=3.190 | 1579.9 samples/s | 24.7 steps/s
[Step=38800 Epoch=367.7] | Loss=0.00070 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.190 | 3698.9 samples/s | 57.8 steps/s
[Step=38850 Epoch=368.1] | Loss=0.00062 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.190 | 1611.8 samples/s | 25.2 steps/s
[Step=38900 Epoch=368.6] | Loss=0.00056 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.190 | 3613.3 samples/s | 56.5 steps/s
[Step=38950 Epoch=369.1] | Loss=0.00051 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.348 | FP-Norm(final)=3.190 | 1685.7 samples/s | 26.3 steps/s
[Step=39000 Epoch=369.6] | Loss=0.00047 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.190 | 3508.1 samples/s | 54.8 steps/s
[Step=39050 Epoch=370.0] | Loss=0.00044 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=3.190 | 1693.3 samples/s | 26.5 steps/s
[Step=39100 Epoch=370.5] | Loss=0.00041 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=3.190 | 3526.2 samples/s | 55.1 steps/s
[Step=39150 Epoch=371.0] | Loss=0.00038 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.334 | FP-Norm(final)=3.190 | 1682.1 samples/s | 26.3 steps/s
[Step=39200 Epoch=371.5] | Loss=0.00036 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.331 | FP-Norm(final)=3.190 | 3472.9 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step39200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=365.3] | Loss=0.01510 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.188 | 3449.3 samples/s | 53.9 steps/s
[Step=38450 Epoch=365.8] | Loss=0.00382 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=3.191 | 3332.0 samples/s | 52.1 steps/s
[Step=38500 Epoch=366.2] | Loss=0.00194 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=3.191 | 4618.7 samples/s | 72.2 steps/s
[Step=38550 Epoch=366.7] | Loss=0.00130 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=3.192 | 1516.5 samples/s | 23.7 steps/s
[Step=38600 Epoch=367.2] | Loss=0.00098 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.192 | 4333.5 samples/s | 67.7 steps/s
[Step=38650 Epoch=367.7] | Loss=0.00079 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.192 | 1515.5 samples/s | 23.7 steps/s
[Step=38700 Epoch=368.1] | Loss=0.00066 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.374 | FP-Norm(final)=3.192 | 3964.0 samples/s | 61.9 steps/s
[Step=38750 Epoch=368.6] | Loss=0.00056 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=3.192 | 1599.3 samples/s | 25.0 steps/s
[Step=38800 Epoch=369.1] | Loss=0.00050 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.192 | 3784.8 samples/s | 59.1 steps/s
[Step=38850 Epoch=369.6] | Loss=0.00044 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.192 | 1637.7 samples/s | 25.6 steps/s
[Step=38900 Epoch=370.0] | Loss=0.00040 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.192 | 3587.5 samples/s | 56.1 steps/s
[Step=38950 Epoch=370.5] | Loss=0.00036 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.192 | 1659.1 samples/s | 25.9 steps/s
[Step=39000 Epoch=371.0] | Loss=0.00033 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=3.192 | 3471.1 samples/s | 54.2 steps/s
[Step=39050 Epoch=371.5] | Loss=0.00031 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=3.192 | 1714.4 samples/s | 26.8 steps/s
[Step=39100 Epoch=371.9] | Loss=0.00029 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.331 | FP-Norm(final)=3.192 | 3496.7 samples/s | 54.6 steps/s
[Step=39150 Epoch=372.4] | Loss=0.00027 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=3.192 | 1709.6 samples/s | 26.7 steps/s
[Step=39200 Epoch=372.9] | Loss=0.00025 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.323 | FP-Norm(final)=3.192 | 3392.2 samples/s | 53.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step39200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=366.7] | Loss=0.05384 | Reg=0.00000 | acc=0.9844 | FP-Norm=0.000 | FP-Norm(final)=3.188 | 3478.1 samples/s | 54.3 steps/s
[Step=38450 Epoch=367.2] | Loss=0.00764 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.365 | FP-Norm(final)=3.188 | 3300.7 samples/s | 51.6 steps/s
[Step=38500 Epoch=367.7] | Loss=0.00384 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=3.188 | 4628.2 samples/s | 72.3 steps/s
[Step=38550 Epoch=368.1] | Loss=0.00257 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=3.188 | 1514.4 samples/s | 23.7 steps/s
[Step=38600 Epoch=368.6] | Loss=0.00193 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.387 | FP-Norm(final)=3.188 | 4351.9 samples/s | 68.0 steps/s
[Step=38650 Epoch=369.1] | Loss=0.00155 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.382 | FP-Norm(final)=3.188 | 1536.3 samples/s | 24.0 steps/s
[Step=38700 Epoch=369.6] | Loss=0.00130 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.377 | FP-Norm(final)=3.189 | 4138.3 samples/s | 64.7 steps/s
[Step=38750 Epoch=370.0] | Loss=0.00111 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.189 | 1559.6 samples/s | 24.4 steps/s
[Step=38800 Epoch=370.5] | Loss=0.00098 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=3.189 | 3852.4 samples/s | 60.2 steps/s
[Step=38850 Epoch=371.0] | Loss=0.00087 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.362 | FP-Norm(final)=3.189 | 1617.6 samples/s | 25.3 steps/s
[Step=38900 Epoch=371.5] | Loss=0.00078 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.189 | 3721.8 samples/s | 58.2 steps/s
[Step=38950 Epoch=371.9] | Loss=0.00071 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.189 | 1651.3 samples/s | 25.8 steps/s
[Step=39000 Epoch=372.4] | Loss=0.00066 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.189 | 3557.7 samples/s | 55.6 steps/s
[Step=39050 Epoch=372.9] | Loss=0.00061 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.189 | 1648.4 samples/s | 25.8 steps/s
[Step=39100 Epoch=373.4] | Loss=0.00056 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.189 | 3548.3 samples/s | 55.4 steps/s
[Step=39150 Epoch=373.9] | Loss=0.00053 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=3.189 | 1688.0 samples/s | 26.4 steps/s
[Step=39200 Epoch=374.3] | Loss=0.00050 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=3.189 | 3515.6 samples/s | 54.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step39200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=361.8] | Loss=0.05127 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.188 | 3816.8 samples/s | 59.6 steps/s
[Step=38450 Epoch=362.3] | Loss=0.00451 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.369 | FP-Norm(final)=3.189 | 3045.0 samples/s | 47.6 steps/s
[Step=38500 Epoch=362.8] | Loss=0.00227 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=3.189 | 4491.2 samples/s | 70.2 steps/s
[Step=38550 Epoch=363.3] | Loss=0.00152 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.395 | FP-Norm(final)=3.189 | 1509.1 samples/s | 23.6 steps/s
[Step=38600 Epoch=363.7] | Loss=0.00114 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=3.189 | 4208.6 samples/s | 65.8 steps/s
[Step=38650 Epoch=364.2] | Loss=0.00092 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.189 | 1558.5 samples/s | 24.4 steps/s
[Step=38700 Epoch=364.7] | Loss=0.00077 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.189 | 3766.7 samples/s | 58.9 steps/s
[Step=38750 Epoch=365.1] | Loss=0.00066 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.373 | FP-Norm(final)=3.189 | 1601.7 samples/s | 25.0 steps/s
[Step=38800 Epoch=365.6] | Loss=0.00058 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=3.189 | 3599.8 samples/s | 56.2 steps/s
[Step=38850 Epoch=366.1] | Loss=0.00052 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.189 | 1626.4 samples/s | 25.4 steps/s
[Step=38900 Epoch=366.5] | Loss=0.00047 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.189 | 3461.3 samples/s | 54.1 steps/s
[Step=38950 Epoch=367.0] | Loss=0.00042 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.189 | 1668.5 samples/s | 26.1 steps/s
[Step=39000 Epoch=367.5] | Loss=0.00039 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.189 | 3565.3 samples/s | 55.7 steps/s
[Step=39050 Epoch=368.0] | Loss=0.00036 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.189 | 1694.3 samples/s | 26.5 steps/s
[Step=39100 Epoch=368.4] | Loss=0.00034 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.189 | 3472.4 samples/s | 54.3 steps/s
[Step=39150 Epoch=368.9] | Loss=0.00031 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.339 | FP-Norm(final)=3.189 | 1769.7 samples/s | 27.7 steps/s
[Step=39200 Epoch=369.4] | Loss=0.00030 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=3.189 | 3198.4 samples/s | 50.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step39200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=366.0] | Loss=0.00214 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=3.188 | 3486.5 samples/s | 54.5 steps/s
[Step=38450 Epoch=366.5] | Loss=0.00305 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.311 | FP-Norm(final)=3.189 | 3308.6 samples/s | 51.7 steps/s
[Step=38500 Epoch=366.9] | Loss=0.00154 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.190 | 4597.3 samples/s | 71.8 steps/s
[Step=38550 Epoch=367.4] | Loss=0.00104 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.190 | 1528.0 samples/s | 23.9 steps/s
[Step=38600 Epoch=367.9] | Loss=0.00078 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=3.190 | 4332.4 samples/s | 67.7 steps/s
[Step=38650 Epoch=368.4] | Loss=0.00063 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.335 | FP-Norm(final)=3.190 | 1546.4 samples/s | 24.2 steps/s
[Step=38700 Epoch=368.8] | Loss=0.00053 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.330 | FP-Norm(final)=3.190 | 4040.2 samples/s | 63.1 steps/s
[Step=38750 Epoch=369.3] | Loss=0.00046 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.326 | FP-Norm(final)=3.190 | 1563.6 samples/s | 24.4 steps/s
[Step=38800 Epoch=369.8] | Loss=0.00040 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.321 | FP-Norm(final)=3.190 | 3891.8 samples/s | 60.8 steps/s
[Step=38850 Epoch=370.3] | Loss=0.00036 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.317 | FP-Norm(final)=3.190 | 1599.5 samples/s | 25.0 steps/s
[Step=38900 Epoch=370.8] | Loss=0.00033 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.313 | FP-Norm(final)=3.190 | 3717.6 samples/s | 58.1 steps/s
[Step=38950 Epoch=371.2] | Loss=0.00030 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.309 | FP-Norm(final)=3.190 | 1631.2 samples/s | 25.5 steps/s
[Step=39000 Epoch=371.7] | Loss=0.00027 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.306 | FP-Norm(final)=3.190 | 3482.2 samples/s | 54.4 steps/s
[Step=39050 Epoch=372.2] | Loss=0.00025 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.302 | FP-Norm(final)=3.191 | 1676.1 samples/s | 26.2 steps/s
[Step=39100 Epoch=372.7] | Loss=0.00024 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.299 | FP-Norm(final)=3.191 | 3560.9 samples/s | 55.6 steps/s
[Step=39150 Epoch=373.1] | Loss=0.00022 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.296 | FP-Norm(final)=3.191 | 1666.1 samples/s | 26.0 steps/s
[Step=39200 Epoch=373.6] | Loss=0.00021 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.294 | FP-Norm(final)=3.191 | 3541.0 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18908 | acc=0.9137 | tpr=0.8836 | fpr=0.0208 | 3476.3 samples/s | 13.6 steps/s
Avg test loss: 0.19045, Avg test acc: 0.91233, Avg tpr: 0.88221, Avg fpr: 0.02141, total FA: 167

Testing server on iccad2012
[Step=  50] | Loss=0.56473 | acc=0.8664 | tpr=0.9735 | fpr=0.1355 | 3533.7 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.58748 | acc=0.8634 | tpr=0.9765 | fpr=0.1387 | 6420.8 samples/s | 25.1 steps/s
[Step= 150] | Loss=0.60124 | acc=0.8597 | tpr=0.9712 | fpr=0.1424 | 6433.8 samples/s | 25.1 steps/s
[Step= 200] | Loss=0.60113 | acc=0.8608 | tpr=0.9705 | fpr=0.1412 | 6788.3 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.59745 | acc=0.8610 | tpr=0.9659 | fpr=0.1409 | 6360.8 samples/s | 24.8 steps/s
[Step= 300] | Loss=0.60292 | acc=0.8604 | tpr=0.9651 | fpr=0.1415 | 6711.0 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.60393 | acc=0.8609 | tpr=0.9649 | fpr=0.1410 | 6560.0 samples/s | 25.6 steps/s
[Step= 400] | Loss=0.60472 | acc=0.8607 | tpr=0.9644 | fpr=0.1412 | 6391.7 samples/s | 25.0 steps/s
[Step= 450] | Loss=0.61043 | acc=0.8601 | tpr=0.9640 | fpr=0.1417 | 6607.3 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.61030 | acc=0.8598 | tpr=0.9652 | fpr=0.1421 | 6266.0 samples/s | 24.5 steps/s
[Step= 550] | Loss=0.60947 | acc=0.8600 | tpr=0.9658 | fpr=0.1419 | 12336.5 samples/s | 48.2 steps/s
Avg test loss: 0.60923, Avg test acc: 0.86008, Avg tpr: 0.96593, Avg fpr: 0.14185, total FA: 19695

server round 49/50

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.2] | Loss=0.04048 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.198 | 3625.6 samples/s | 56.6 steps/s
[Step=39250 Epoch=191.4] | Loss=0.01429 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.311 | FP-Norm(final)=3.199 | 3511.0 samples/s | 54.9 steps/s
[Step=39300 Epoch=191.6] | Loss=0.01129 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.340 | FP-Norm(final)=3.200 | 3744.6 samples/s | 58.5 steps/s
[Step=39350 Epoch=191.9] | Loss=0.00894 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.352 | FP-Norm(final)=3.200 | 3648.8 samples/s | 57.0 steps/s
[Step=39400 Epoch=192.1] | Loss=0.00793 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.200 | 4760.3 samples/s | 74.4 steps/s
[Step=39450 Epoch=192.4] | Loss=0.00689 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.201 | 1608.9 samples/s | 25.1 steps/s
[Step=39500 Epoch=192.6] | Loss=0.00629 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.201 | 3754.4 samples/s | 58.7 steps/s
[Step=39550 Epoch=192.9] | Loss=0.00593 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.358 | FP-Norm(final)=3.202 | 3721.3 samples/s | 58.1 steps/s
[Step=39600 Epoch=193.1] | Loss=0.00546 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.202 | 4530.0 samples/s | 70.8 steps/s
[Step=39650 Epoch=193.3] | Loss=0.00512 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.203 | 1625.4 samples/s | 25.4 steps/s
[Step=39700 Epoch=193.6] | Loss=0.00488 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.356 | FP-Norm(final)=3.204 | 3688.9 samples/s | 57.6 steps/s
[Step=39750 Epoch=193.8] | Loss=0.00470 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.204 | 3685.9 samples/s | 57.6 steps/s
[Step=39800 Epoch=194.1] | Loss=0.00456 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.205 | 4255.9 samples/s | 66.5 steps/s
[Step=39850 Epoch=194.3] | Loss=0.00441 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.205 | 1654.6 samples/s | 25.9 steps/s
[Step=39900 Epoch=194.6] | Loss=0.00425 | Reg=0.00013 | acc=0.9844 | FP-Norm=0.354 | FP-Norm(final)=3.206 | 3784.5 samples/s | 59.1 steps/s
[Step=39950 Epoch=194.8] | Loss=0.00413 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.206 | 3711.2 samples/s | 58.0 steps/s
[Step=40000 Epoch=195.0] | Loss=0.00398 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.206 | 3961.8 samples/s | 61.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.3] | Loss=0.08327 | Reg=0.00000 | acc=0.9219 | FP-Norm=0.000 | FP-Norm(final)=3.198 | 3705.4 samples/s | 57.9 steps/s
[Step=39250 Epoch=191.5] | Loss=0.01803 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.286 | FP-Norm(final)=3.198 | 3512.5 samples/s | 54.9 steps/s
[Step=39300 Epoch=191.8] | Loss=0.01205 | Reg=0.00010 | acc=1.0000 | FP-Norm=0.311 | FP-Norm(final)=3.198 | 3735.2 samples/s | 58.4 steps/s
[Step=39350 Epoch=192.0] | Loss=0.00983 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=3.199 | 3701.9 samples/s | 57.8 steps/s
[Step=39400 Epoch=192.3] | Loss=0.00859 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=3.199 | 4753.4 samples/s | 74.3 steps/s
[Step=39450 Epoch=192.5] | Loss=0.00748 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=3.200 | 1597.7 samples/s | 25.0 steps/s
[Step=39500 Epoch=192.7] | Loss=0.00651 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.201 | 3752.1 samples/s | 58.6 steps/s
[Step=39550 Epoch=193.0] | Loss=0.00597 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.201 | 3735.9 samples/s | 58.4 steps/s
[Step=39600 Epoch=193.2] | Loss=0.00559 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.202 | 4583.9 samples/s | 71.6 steps/s
[Step=39650 Epoch=193.5] | Loss=0.00523 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=3.202 | 1608.8 samples/s | 25.1 steps/s
[Step=39700 Epoch=193.7] | Loss=0.00496 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=3.203 | 3737.4 samples/s | 58.4 steps/s
[Step=39750 Epoch=194.0] | Loss=0.00465 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.340 | FP-Norm(final)=3.204 | 3759.9 samples/s | 58.7 steps/s
[Step=39800 Epoch=194.2] | Loss=0.00447 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.339 | FP-Norm(final)=3.204 | 4336.1 samples/s | 67.8 steps/s
[Step=39850 Epoch=194.4] | Loss=0.00430 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.338 | FP-Norm(final)=3.205 | 1636.9 samples/s | 25.6 steps/s
[Step=39900 Epoch=194.7] | Loss=0.00415 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=3.205 | 3677.6 samples/s | 57.5 steps/s
[Step=39950 Epoch=194.9] | Loss=0.00404 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=3.206 | 3707.9 samples/s | 57.9 steps/s
[Step=40000 Epoch=195.2] | Loss=0.00395 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.336 | FP-Norm(final)=3.206 | 4167.3 samples/s | 65.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_1/client_state-step40000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.0] | Loss=0.04354 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.198 | 3521.0 samples/s | 55.0 steps/s
[Step=39250 Epoch=191.2] | Loss=0.01833 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.293 | FP-Norm(final)=3.198 | 3691.8 samples/s | 57.7 steps/s
[Step=39300 Epoch=191.5] | Loss=0.01207 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.321 | FP-Norm(final)=3.198 | 3751.4 samples/s | 58.6 steps/s
[Step=39350 Epoch=191.7] | Loss=0.01009 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.337 | FP-Norm(final)=3.198 | 3747.7 samples/s | 58.6 steps/s
[Step=39400 Epoch=192.0] | Loss=0.00844 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.199 | 4794.5 samples/s | 74.9 steps/s
[Step=39450 Epoch=192.2] | Loss=0.00735 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.200 | 1593.6 samples/s | 24.9 steps/s
[Step=39500 Epoch=192.5] | Loss=0.00646 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.200 | 3681.0 samples/s | 57.5 steps/s
[Step=39550 Epoch=192.7] | Loss=0.00593 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.201 | 3692.8 samples/s | 57.7 steps/s
[Step=39600 Epoch=193.0] | Loss=0.00547 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.202 | 4470.0 samples/s | 69.8 steps/s
[Step=39650 Epoch=193.2] | Loss=0.00509 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.345 | FP-Norm(final)=3.202 | 1650.0 samples/s | 25.8 steps/s
[Step=39700 Epoch=193.4] | Loss=0.00474 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.344 | FP-Norm(final)=3.203 | 3766.7 samples/s | 58.9 steps/s
[Step=39750 Epoch=193.7] | Loss=0.00448 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.343 | FP-Norm(final)=3.204 | 3728.4 samples/s | 58.3 steps/s
[Step=39800 Epoch=193.9] | Loss=0.00428 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.342 | FP-Norm(final)=3.204 | 4262.5 samples/s | 66.6 steps/s
[Step=39850 Epoch=194.2] | Loss=0.00414 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.205 | 1690.3 samples/s | 26.4 steps/s
[Step=39900 Epoch=194.4] | Loss=0.00403 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.342 | FP-Norm(final)=3.206 | 3717.7 samples/s | 58.1 steps/s
[Step=39950 Epoch=194.7] | Loss=0.00387 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=3.206 | 3757.0 samples/s | 58.7 steps/s
[Step=40000 Epoch=194.9] | Loss=0.00379 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.341 | FP-Norm(final)=3.207 | 4024.6 samples/s | 62.9 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_2/client_state-step40000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.2] | Loss=0.05558 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.198 | 3556.4 samples/s | 55.6 steps/s
[Step=39250 Epoch=191.4] | Loss=0.01632 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.304 | FP-Norm(final)=3.198 | 3731.2 samples/s | 58.3 steps/s
[Step=39300 Epoch=191.6] | Loss=0.01058 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.333 | FP-Norm(final)=3.199 | 3743.0 samples/s | 58.5 steps/s
[Step=39350 Epoch=191.9] | Loss=0.00862 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.346 | FP-Norm(final)=3.199 | 3774.3 samples/s | 59.0 steps/s
[Step=39400 Epoch=192.1] | Loss=0.00704 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.200 | 4803.3 samples/s | 75.1 steps/s
[Step=39450 Epoch=192.4] | Loss=0.00602 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.201 | 1582.2 samples/s | 24.7 steps/s
[Step=39500 Epoch=192.6] | Loss=0.00534 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.355 | FP-Norm(final)=3.201 | 3747.5 samples/s | 58.6 steps/s
[Step=39550 Epoch=192.9] | Loss=0.00483 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.354 | FP-Norm(final)=3.202 | 3710.0 samples/s | 58.0 steps/s
[Step=39600 Epoch=193.1] | Loss=0.00470 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.203 | 4448.3 samples/s | 69.5 steps/s
[Step=39650 Epoch=193.4] | Loss=0.00440 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.203 | 1617.0 samples/s | 25.3 steps/s
[Step=39700 Epoch=193.6] | Loss=0.00411 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.204 | 3758.9 samples/s | 58.7 steps/s
[Step=39750 Epoch=193.8] | Loss=0.00400 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.352 | FP-Norm(final)=3.204 | 3738.6 samples/s | 58.4 steps/s
[Step=39800 Epoch=194.1] | Loss=0.00381 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.351 | FP-Norm(final)=3.205 | 4263.7 samples/s | 66.6 steps/s
[Step=39850 Epoch=194.3] | Loss=0.00368 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.206 | 1662.9 samples/s | 26.0 steps/s
[Step=39900 Epoch=194.6] | Loss=0.00355 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.206 | 3783.4 samples/s | 59.1 steps/s
[Step=39950 Epoch=194.8] | Loss=0.00345 | Reg=0.00012 | acc=1.0000 | FP-Norm=0.349 | FP-Norm(final)=3.207 | 3723.6 samples/s | 58.2 steps/s
[Step=40000 Epoch=195.1] | Loss=0.00335 | Reg=0.00012 | acc=0.9844 | FP-Norm=0.349 | FP-Norm(final)=3.207 | 4032.1 samples/s | 63.0 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_3/client_state-step40000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=192.2] | Loss=0.19511 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.198 | 3459.2 samples/s | 54.1 steps/s
[Step=39250 Epoch=192.5] | Loss=0.01505 | Reg=0.00009 | acc=1.0000 | FP-Norm=0.291 | FP-Norm(final)=3.198 | 3760.1 samples/s | 58.8 steps/s
[Step=39300 Epoch=192.7] | Loss=0.01069 | Reg=0.00010 | acc=0.9844 | FP-Norm=0.314 | FP-Norm(final)=3.199 | 3752.9 samples/s | 58.6 steps/s
[Step=39350 Epoch=193.0] | Loss=0.00885 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.321 | FP-Norm(final)=3.199 | 3729.8 samples/s | 58.3 steps/s
[Step=39400 Epoch=193.2] | Loss=0.00774 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.325 | FP-Norm(final)=3.200 | 4893.3 samples/s | 76.5 steps/s
[Step=39450 Epoch=193.5] | Loss=0.00667 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.328 | FP-Norm(final)=3.200 | 1572.2 samples/s | 24.6 steps/s
[Step=39500 Epoch=193.7] | Loss=0.00602 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.328 | FP-Norm(final)=3.201 | 3683.6 samples/s | 57.6 steps/s
[Step=39550 Epoch=193.9] | Loss=0.00537 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.328 | FP-Norm(final)=3.201 | 3681.4 samples/s | 57.5 steps/s
[Step=39600 Epoch=194.2] | Loss=0.00510 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.328 | FP-Norm(final)=3.202 | 4613.2 samples/s | 72.1 steps/s
[Step=39650 Epoch=194.4] | Loss=0.00480 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.328 | FP-Norm(final)=3.203 | 1607.3 samples/s | 25.1 steps/s
[Step=39700 Epoch=194.7] | Loss=0.00450 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.327 | FP-Norm(final)=3.203 | 3746.1 samples/s | 58.5 steps/s
[Step=39750 Epoch=194.9] | Loss=0.00430 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.326 | FP-Norm(final)=3.204 | 3745.2 samples/s | 58.5 steps/s
[Step=39800 Epoch=195.2] | Loss=0.00408 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.325 | FP-Norm(final)=3.204 | 4504.7 samples/s | 70.4 steps/s
[Step=39850 Epoch=195.4] | Loss=0.00390 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.325 | FP-Norm(final)=3.205 | 1620.4 samples/s | 25.3 steps/s
[Step=39900 Epoch=195.7] | Loss=0.00373 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.324 | FP-Norm(final)=3.206 | 3678.0 samples/s | 57.5 steps/s
[Step=39950 Epoch=195.9] | Loss=0.00362 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.324 | FP-Norm(final)=3.206 | 3686.6 samples/s | 57.6 steps/s
[Step=40000 Epoch=196.2] | Loss=0.00350 | Reg=0.00011 | acc=1.0000 | FP-Norm=0.323 | FP-Norm(final)=3.207 | 4323.1 samples/s | 67.5 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_asml1_4/client_state-step40000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=371.5] | Loss=0.16164 | Reg=0.00000 | acc=0.9531 | FP-Norm=0.000 | FP-Norm(final)=3.198 | 3512.4 samples/s | 54.9 steps/s
[Step=39250 Epoch=371.9] | Loss=0.00773 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.378 | FP-Norm(final)=3.198 | 3278.0 samples/s | 51.2 steps/s
[Step=39300 Epoch=372.4] | Loss=0.00390 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.198 | 4604.0 samples/s | 71.9 steps/s
[Step=39350 Epoch=372.9] | Loss=0.00261 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.198 | 1516.4 samples/s | 23.7 steps/s
[Step=39400 Epoch=373.3] | Loss=0.00197 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=3.198 | 4188.8 samples/s | 65.5 steps/s
[Step=39450 Epoch=373.8] | Loss=0.00158 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.397 | FP-Norm(final)=3.198 | 1531.7 samples/s | 23.9 steps/s
[Step=39500 Epoch=374.3] | Loss=0.00132 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.392 | FP-Norm(final)=3.198 | 3977.5 samples/s | 62.1 steps/s
[Step=39550 Epoch=374.8] | Loss=0.00113 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.386 | FP-Norm(final)=3.198 | 1578.3 samples/s | 24.7 steps/s
[Step=39600 Epoch=375.2] | Loss=0.00099 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.198 | 3767.1 samples/s | 58.9 steps/s
[Step=39650 Epoch=375.7] | Loss=0.00089 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.199 | 1650.7 samples/s | 25.8 steps/s
[Step=39700 Epoch=376.2] | Loss=0.00080 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.199 | 3550.4 samples/s | 55.5 steps/s
[Step=39750 Epoch=376.7] | Loss=0.00073 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.199 | 1631.1 samples/s | 25.5 steps/s
[Step=39800 Epoch=377.1] | Loss=0.00067 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.199 | 3435.0 samples/s | 53.7 steps/s
[Step=39850 Epoch=377.6] | Loss=0.00062 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.360 | FP-Norm(final)=3.199 | 1673.3 samples/s | 26.1 steps/s
[Step=39900 Epoch=378.1] | Loss=0.00058 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.357 | FP-Norm(final)=3.199 | 3461.1 samples/s | 54.1 steps/s
[Step=39950 Epoch=378.6] | Loss=0.00054 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.353 | FP-Norm(final)=3.199 | 1702.1 samples/s | 26.6 steps/s
[Step=40000 Epoch=379.0] | Loss=0.00051 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.350 | FP-Norm(final)=3.199 | 3499.6 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_0/client_state-step40000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=372.9] | Loss=0.18752 | Reg=0.00000 | acc=0.9062 | FP-Norm=0.000 | FP-Norm(final)=3.198 | 3665.4 samples/s | 57.3 steps/s
[Step=39250 Epoch=373.4] | Loss=0.00754 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.199 | 3132.0 samples/s | 48.9 steps/s
[Step=39300 Epoch=373.8] | Loss=0.00379 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.432 | FP-Norm(final)=3.199 | 4590.8 samples/s | 71.7 steps/s
[Step=39350 Epoch=374.3] | Loss=0.00254 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.429 | FP-Norm(final)=3.199 | 1520.7 samples/s | 23.8 steps/s
[Step=39400 Epoch=374.8] | Loss=0.00191 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=3.199 | 4235.4 samples/s | 66.2 steps/s
[Step=39450 Epoch=375.3] | Loss=0.00153 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.199 | 1556.4 samples/s | 24.3 steps/s
[Step=39500 Epoch=375.7] | Loss=0.00127 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.408 | FP-Norm(final)=3.199 | 3977.6 samples/s | 62.2 steps/s
[Step=39550 Epoch=376.2] | Loss=0.00109 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.402 | FP-Norm(final)=3.199 | 1590.9 samples/s | 24.9 steps/s
[Step=39600 Epoch=376.7] | Loss=0.00096 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.396 | FP-Norm(final)=3.199 | 3801.2 samples/s | 59.4 steps/s
[Step=39650 Epoch=377.2] | Loss=0.00086 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.390 | FP-Norm(final)=3.199 | 1628.9 samples/s | 25.5 steps/s
[Step=39700 Epoch=377.6] | Loss=0.00077 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.385 | FP-Norm(final)=3.199 | 3628.1 samples/s | 56.7 steps/s
[Step=39750 Epoch=378.1] | Loss=0.00070 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.381 | FP-Norm(final)=3.199 | 1661.2 samples/s | 26.0 steps/s
[Step=39800 Epoch=378.6] | Loss=0.00064 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.199 | 3511.2 samples/s | 54.9 steps/s
[Step=39850 Epoch=379.1] | Loss=0.00060 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.199 | 1706.9 samples/s | 26.7 steps/s
[Step=39900 Epoch=379.5] | Loss=0.00055 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.368 | FP-Norm(final)=3.199 | 3524.5 samples/s | 55.1 steps/s
[Step=39950 Epoch=380.0] | Loss=0.00052 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.364 | FP-Norm(final)=3.199 | 1706.1 samples/s | 26.7 steps/s
[Step=40000 Epoch=380.5] | Loss=0.00049 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.361 | FP-Norm(final)=3.199 | 3498.0 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_1/client_state-step40000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=374.3] | Loss=0.06174 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.198 | 3554.6 samples/s | 55.5 steps/s
[Step=39250 Epoch=374.8] | Loss=0.00592 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.388 | FP-Norm(final)=3.199 | 3236.1 samples/s | 50.6 steps/s
[Step=39300 Epoch=375.3] | Loss=0.00298 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=3.199 | 4545.5 samples/s | 71.0 steps/s
[Step=39350 Epoch=375.8] | Loss=0.00200 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.422 | FP-Norm(final)=3.200 | 1515.5 samples/s | 23.7 steps/s
[Step=39400 Epoch=376.2] | Loss=0.00150 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.417 | FP-Norm(final)=3.200 | 4388.6 samples/s | 68.6 steps/s
[Step=39450 Epoch=376.7] | Loss=0.00120 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=3.200 | 1539.6 samples/s | 24.1 steps/s
[Step=39500 Epoch=377.2] | Loss=0.00101 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.405 | FP-Norm(final)=3.200 | 4146.2 samples/s | 64.8 steps/s
[Step=39550 Epoch=377.7] | Loss=0.00086 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.400 | FP-Norm(final)=3.200 | 1587.4 samples/s | 24.8 steps/s
[Step=39600 Epoch=378.2] | Loss=0.00076 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.394 | FP-Norm(final)=3.200 | 3922.0 samples/s | 61.3 steps/s
[Step=39650 Epoch=378.6] | Loss=0.00068 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.200 | 1614.5 samples/s | 25.2 steps/s
[Step=39700 Epoch=379.1] | Loss=0.00061 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.200 | 3767.1 samples/s | 58.9 steps/s
[Step=39750 Epoch=379.6] | Loss=0.00055 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.379 | FP-Norm(final)=3.200 | 1664.8 samples/s | 26.0 steps/s
[Step=39800 Epoch=380.1] | Loss=0.00051 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.375 | FP-Norm(final)=3.200 | 3527.6 samples/s | 55.1 steps/s
[Step=39850 Epoch=380.5] | Loss=0.00047 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.371 | FP-Norm(final)=3.200 | 1668.3 samples/s | 26.1 steps/s
[Step=39900 Epoch=381.0] | Loss=0.00044 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.367 | FP-Norm(final)=3.200 | 3517.1 samples/s | 55.0 steps/s
[Step=39950 Epoch=381.5] | Loss=0.00041 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.363 | FP-Norm(final)=3.200 | 1690.4 samples/s | 26.4 steps/s
[Step=40000 Epoch=382.0] | Loss=0.00038 | Reg=0.00013 | acc=1.0000 | FP-Norm=0.359 | FP-Norm(final)=3.200 | 3566.6 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_2/client_state-step40000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=369.4] | Loss=0.00146 | Reg=0.00000 | acc=1.0000 | FP-Norm=0.000 | FP-Norm(final)=3.198 | 3652.2 samples/s | 57.1 steps/s
[Step=39250 Epoch=369.8] | Loss=0.00718 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.199 | 3278.5 samples/s | 51.2 steps/s
[Step=39300 Epoch=370.3] | Loss=0.00360 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.440 | FP-Norm(final)=3.199 | 4610.8 samples/s | 72.0 steps/s
[Step=39350 Epoch=370.8] | Loss=0.00240 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.439 | FP-Norm(final)=3.199 | 1532.8 samples/s | 23.9 steps/s
[Step=39400 Epoch=371.3] | Loss=0.00181 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.434 | FP-Norm(final)=3.199 | 4202.1 samples/s | 65.7 steps/s
[Step=39450 Epoch=371.7] | Loss=0.00145 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.428 | FP-Norm(final)=3.199 | 1547.9 samples/s | 24.2 steps/s
[Step=39500 Epoch=372.2] | Loss=0.00121 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=3.199 | 3902.9 samples/s | 61.0 steps/s
[Step=39550 Epoch=372.7] | Loss=0.00103 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.415 | FP-Norm(final)=3.199 | 1603.6 samples/s | 25.1 steps/s
[Step=39600 Epoch=373.1] | Loss=0.00091 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.409 | FP-Norm(final)=3.199 | 3589.4 samples/s | 56.1 steps/s
[Step=39650 Epoch=373.6] | Loss=0.00081 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.404 | FP-Norm(final)=3.199 | 1641.4 samples/s | 25.6 steps/s
[Step=39700 Epoch=374.1] | Loss=0.00073 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.398 | FP-Norm(final)=3.199 | 3487.8 samples/s | 54.5 steps/s
[Step=39750 Epoch=374.6] | Loss=0.00066 | Reg=0.00016 | acc=1.0000 | FP-Norm=0.393 | FP-Norm(final)=3.199 | 1687.8 samples/s | 26.4 steps/s
[Step=39800 Epoch=375.0] | Loss=0.00061 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.389 | FP-Norm(final)=3.199 | 3510.4 samples/s | 54.8 steps/s
[Step=39850 Epoch=375.5] | Loss=0.00056 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.384 | FP-Norm(final)=3.199 | 1697.7 samples/s | 26.5 steps/s
[Step=39900 Epoch=376.0] | Loss=0.00052 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.380 | FP-Norm(final)=3.199 | 3506.2 samples/s | 54.8 steps/s
[Step=39950 Epoch=376.4] | Loss=0.00049 | Reg=0.00015 | acc=1.0000 | FP-Norm=0.376 | FP-Norm(final)=3.199 | 1824.0 samples/s | 28.5 steps/s
[Step=40000 Epoch=376.9] | Loss=0.00046 | Reg=0.00014 | acc=1.0000 | FP-Norm=0.372 | FP-Norm(final)=3.199 | 3114.3 samples/s | 48.7 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_3/client_state-step40000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=373.6] | Loss=0.06267 | Reg=0.00000 | acc=0.9688 | FP-Norm=0.000 | FP-Norm(final)=3.198 | 3665.3 samples/s | 57.3 steps/s
[Step=39250 Epoch=374.1] | Loss=0.00751 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.444 | FP-Norm(final)=3.199 | 3187.3 samples/s | 49.8 steps/s
[Step=39300 Epoch=374.6] | Loss=0.00379 | Reg=0.00024 | acc=1.0000 | FP-Norm=0.475 | FP-Norm(final)=3.199 | 4587.0 samples/s | 71.7 steps/s
[Step=39350 Epoch=375.0] | Loss=0.00254 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.475 | FP-Norm(final)=3.199 | 1506.3 samples/s | 23.5 steps/s
[Step=39400 Epoch=375.5] | Loss=0.00192 | Reg=0.00023 | acc=1.0000 | FP-Norm=0.469 | FP-Norm(final)=3.199 | 4344.2 samples/s | 67.9 steps/s
[Step=39450 Epoch=376.0] | Loss=0.00154 | Reg=0.00022 | acc=1.0000 | FP-Norm=0.462 | FP-Norm(final)=3.199 | 1534.0 samples/s | 24.0 steps/s
[Step=39500 Epoch=376.5] | Loss=0.00129 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.455 | FP-Norm(final)=3.199 | 4050.5 samples/s | 63.3 steps/s
[Step=39550 Epoch=376.9] | Loss=0.00111 | Reg=0.00021 | acc=1.0000 | FP-Norm=0.448 | FP-Norm(final)=3.200 | 1574.7 samples/s | 24.6 steps/s
[Step=39600 Epoch=377.4] | Loss=0.00097 | Reg=0.00020 | acc=1.0000 | FP-Norm=0.442 | FP-Norm(final)=3.200 | 3862.4 samples/s | 60.4 steps/s
[Step=39650 Epoch=377.9] | Loss=0.00087 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.436 | FP-Norm(final)=3.200 | 1610.4 samples/s | 25.2 steps/s
[Step=39700 Epoch=378.4] | Loss=0.00078 | Reg=0.00019 | acc=1.0000 | FP-Norm=0.431 | FP-Norm(final)=3.200 | 3650.2 samples/s | 57.0 steps/s
[Step=39750 Epoch=378.9] | Loss=0.00071 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.425 | FP-Norm(final)=3.200 | 1634.2 samples/s | 25.5 steps/s
[Step=39800 Epoch=379.3] | Loss=0.00065 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.421 | FP-Norm(final)=3.200 | 3533.3 samples/s | 55.2 steps/s
[Step=39850 Epoch=379.8] | Loss=0.00060 | Reg=0.00018 | acc=1.0000 | FP-Norm=0.416 | FP-Norm(final)=3.200 | 1690.9 samples/s | 26.4 steps/s
[Step=39900 Epoch=380.3] | Loss=0.00056 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.411 | FP-Norm(final)=3.200 | 3523.2 samples/s | 55.0 steps/s
[Step=39950 Epoch=380.8] | Loss=0.00053 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.407 | FP-Norm(final)=3.200 | 1674.1 samples/s | 26.2 steps/s
[Step=40000 Epoch=381.2] | Loss=0.00049 | Reg=0.00017 | acc=1.0000 | FP-Norm=0.403 | FP-Norm(final)=3.200 | 3464.7 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a5i5-sel1.0-l2fp1e-3/client_iccad2012_4/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21342 | acc=0.9018 | tpr=0.8652 | fpr=0.0188 | 3550.3 samples/s | 13.9 steps/s
Avg test loss: 0.21557, Avg test acc: 0.89979, Avg tpr: 0.86344, Avg fpr: 0.02025, total FA: 158

Testing server on iccad2012
[Step=  50] | Loss=0.51438 | acc=0.8809 | tpr=0.9690 | fpr=0.1207 | 3573.5 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.53657 | acc=0.8779 | tpr=0.9744 | fpr=0.1239 | 6508.3 samples/s | 25.4 steps/s
[Step= 150] | Loss=0.54911 | acc=0.8744 | tpr=0.9697 | fpr=0.1274 | 6586.5 samples/s | 25.7 steps/s
[Step= 200] | Loss=0.54951 | acc=0.8750 | tpr=0.9683 | fpr=0.1267 | 6521.9 samples/s | 25.5 steps/s
[Step= 250] | Loss=0.54581 | acc=0.8751 | tpr=0.9633 | fpr=0.1265 | 6605.1 samples/s | 25.8 steps/s
[Step= 300] | Loss=0.55094 | acc=0.8746 | tpr=0.9629 | fpr=0.1270 | 6539.2 samples/s | 25.5 steps/s
[Step= 350] | Loss=0.55215 | acc=0.8749 | tpr=0.9631 | fpr=0.1267 | 6678.4 samples/s | 26.1 steps/s
[Step= 400] | Loss=0.55295 | acc=0.8748 | tpr=0.9623 | fpr=0.1268 | 6426.4 samples/s | 25.1 steps/s
[Step= 450] | Loss=0.55841 | acc=0.8745 | tpr=0.9620 | fpr=0.1271 | 6381.9 samples/s | 24.9 steps/s
[Step= 500] | Loss=0.55828 | acc=0.8742 | tpr=0.9634 | fpr=0.1274 | 6518.3 samples/s | 25.5 steps/s
[Step= 550] | Loss=0.55762 | acc=0.8745 | tpr=0.9634 | fpr=0.1271 | 12739.3 samples/s | 49.8 steps/s
Avg test loss: 0.55737, Avg test acc: 0.87452, Avg tpr: 0.96355, Avg fpr: 0.12710, total FA: 17648
