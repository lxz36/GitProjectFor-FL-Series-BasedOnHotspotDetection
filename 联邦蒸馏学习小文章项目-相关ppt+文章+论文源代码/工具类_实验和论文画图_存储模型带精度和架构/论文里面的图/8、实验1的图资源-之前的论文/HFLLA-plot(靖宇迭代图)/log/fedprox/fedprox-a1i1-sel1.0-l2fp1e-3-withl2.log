#clients of iccad2012: 1
#clients of asml1: 1
select ratio: 1.0
Total num clients: 2
client model path: ['models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0', 'models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (49916, 144, 32)
Resampled dataset to size (65551, 144, 32)
Using transform option: train
#pos = 34281, #neg = 31270
loading data into the main memory...
Allocated dataset with size (18300, 144, 32)
Resampled dataset to size (33952, 144, 32)
Using transform option: train
#pos = 16856, #neg = 17096
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34678 | Reg=0.00357 | FP-Reg=0.000 | acc=0.4375 | L2-Norm=18.896 | L2-Norm(final)=1.913 | 2795.7 samples/s | 43.7 steps/s
[Step=  50 Epoch= 0.0] | Loss=0.29932 | Reg=0.00356 | FP-Reg=0.002 | acc=0.8438 | L2-Norm=18.879 | L2-Norm(final)=1.914 | 3560.3 samples/s | 55.6 steps/s
[Step= 100 Epoch= 0.1] | Loss=0.25273 | Reg=0.00358 | FP-Reg=0.004 | acc=0.8906 | L2-Norm=18.928 | L2-Norm(final)=1.930 | 3496.8 samples/s | 54.6 steps/s
[Step= 150 Epoch= 0.1] | Loss=0.22715 | Reg=0.00360 | FP-Reg=0.006 | acc=0.8438 | L2-Norm=18.962 | L2-Norm(final)=1.942 | 3502.2 samples/s | 54.7 steps/s
[Step= 200 Epoch= 0.2] | Loss=0.20777 | Reg=0.00361 | FP-Reg=0.007 | acc=0.9062 | L2-Norm=18.992 | L2-Norm(final)=1.952 | 3496.4 samples/s | 54.6 steps/s
[Step= 250 Epoch= 0.2] | Loss=0.19534 | Reg=0.00362 | FP-Reg=0.008 | acc=0.8594 | L2-Norm=19.019 | L2-Norm(final)=1.961 | 3498.6 samples/s | 54.7 steps/s
[Step= 300 Epoch= 0.3] | Loss=0.18526 | Reg=0.00363 | FP-Reg=0.009 | acc=0.8594 | L2-Norm=19.040 | L2-Norm(final)=1.969 | 3484.3 samples/s | 54.4 steps/s
[Step= 350 Epoch= 0.3] | Loss=0.17706 | Reg=0.00363 | FP-Reg=0.010 | acc=0.8906 | L2-Norm=19.061 | L2-Norm(final)=1.977 | 3456.6 samples/s | 54.0 steps/s
[Step= 400 Epoch= 0.4] | Loss=0.16932 | Reg=0.00364 | FP-Reg=0.010 | acc=0.9375 | L2-Norm=19.079 | L2-Norm(final)=1.984 | 3466.7 samples/s | 54.2 steps/s
[Step= 450 Epoch= 0.4] | Loss=0.16253 | Reg=0.00365 | FP-Reg=0.011 | acc=0.8594 | L2-Norm=19.095 | L2-Norm(final)=1.991 | 3482.4 samples/s | 54.4 steps/s
[Step= 500 Epoch= 0.5] | Loss=0.15785 | Reg=0.00365 | FP-Reg=0.011 | acc=0.9062 | L2-Norm=19.111 | L2-Norm(final)=1.997 | 3489.1 samples/s | 54.5 steps/s
[Step= 550 Epoch= 0.5] | Loss=0.15284 | Reg=0.00366 | FP-Reg=0.012 | acc=0.9844 | L2-Norm=19.127 | L2-Norm(final)=2.003 | 3476.9 samples/s | 54.3 steps/s
[Step= 600 Epoch= 0.6] | Loss=0.14758 | Reg=0.00366 | FP-Reg=0.013 | acc=0.9219 | L2-Norm=19.142 | L2-Norm(final)=2.009 | 3480.7 samples/s | 54.4 steps/s
[Step= 650 Epoch= 0.6] | Loss=0.14355 | Reg=0.00367 | FP-Reg=0.013 | acc=0.9375 | L2-Norm=19.155 | L2-Norm(final)=2.013 | 3473.6 samples/s | 54.3 steps/s
[Step= 700 Epoch= 0.7] | Loss=0.13985 | Reg=0.00367 | FP-Reg=0.014 | acc=0.9062 | L2-Norm=19.168 | L2-Norm(final)=2.019 | 3472.5 samples/s | 54.3 steps/s
[Step= 750 Epoch= 0.7] | Loss=0.13644 | Reg=0.00368 | FP-Reg=0.014 | acc=0.9531 | L2-Norm=19.181 | L2-Norm(final)=2.024 | 3476.2 samples/s | 54.3 steps/s
[Step= 800 Epoch= 0.8] | Loss=0.13312 | Reg=0.00368 | FP-Reg=0.015 | acc=0.9062 | L2-Norm=19.193 | L2-Norm(final)=2.029 | 3486.8 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36067 | Reg=0.00357 | FP-Reg=0.000 | acc=0.3906 | L2-Norm=18.896 | L2-Norm(final)=1.913 | 3984.3 samples/s | 62.3 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.14509 | Reg=0.00359 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=18.934 | L2-Norm(final)=1.947 | 2984.2 samples/s | 46.6 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.09436 | Reg=0.00360 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=18.961 | L2-Norm(final)=1.963 | 3304.9 samples/s | 51.6 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.07188 | Reg=0.00360 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=18.972 | L2-Norm(final)=1.974 | 3331.8 samples/s | 52.1 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.06064 | Reg=0.00360 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=18.978 | L2-Norm(final)=1.981 | 3317.6 samples/s | 51.8 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.05168 | Reg=0.00360 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=18.981 | L2-Norm(final)=1.986 | 3302.3 samples/s | 51.6 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.04479 | Reg=0.00360 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=18.984 | L2-Norm(final)=1.993 | 3319.5 samples/s | 51.9 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.04080 | Reg=0.00360 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=18.986 | L2-Norm(final)=2.000 | 3307.1 samples/s | 51.7 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.03661 | Reg=0.00361 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=18.990 | L2-Norm(final)=2.006 | 3322.5 samples/s | 51.9 steps/s
[Step= 450 Epoch= 0.8] | Loss=0.03348 | Reg=0.00361 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=18.992 | L2-Norm(final)=2.012 | 3323.8 samples/s | 51.9 steps/s
[Step= 500 Epoch= 0.9] | Loss=0.03067 | Reg=0.00361 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=18.994 | L2-Norm(final)=2.018 | 3340.3 samples/s | 52.2 steps/s
[Step= 550 Epoch= 1.0] | Loss=0.02857 | Reg=0.00361 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=18.995 | L2-Norm(final)=2.023 | 1716.0 samples/s | 26.8 steps/s
[Step= 600 Epoch= 1.1] | Loss=0.02644 | Reg=0.00361 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=18.996 | L2-Norm(final)=2.029 | 3331.0 samples/s | 52.0 steps/s
[Step= 650 Epoch= 1.2] | Loss=0.02485 | Reg=0.00361 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=18.996 | L2-Norm(final)=2.034 | 3291.9 samples/s | 51.4 steps/s
[Step= 700 Epoch= 1.3] | Loss=0.02342 | Reg=0.00361 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=18.997 | L2-Norm(final)=2.039 | 3295.7 samples/s | 51.5 steps/s
[Step= 750 Epoch= 1.4] | Loss=0.02204 | Reg=0.00361 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=18.997 | L2-Norm(final)=2.044 | 3302.2 samples/s | 51.6 steps/s
[Step= 800 Epoch= 1.5] | Loss=0.02086 | Reg=0.00361 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=18.997 | L2-Norm(final)=2.049 | 3298.5 samples/s | 51.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25622 | acc=0.7416 | tpr=0.8485 | fpr=0.4906 | 3727.6 samples/s | 14.6 steps/s
Avg test loss: 0.25702, Avg test acc: 0.73796, Avg tpr: 0.84525, Avg fpr: 0.49801, total FA: 3885

Testing server on iccad2012
[Step=  50] | Loss=0.42417 | acc=0.5595 | tpr=0.9912 | fpr=0.4482 | 3753.9 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.42457 | acc=0.5576 | tpr=0.9872 | fpr=0.4504 | 6727.7 samples/s | 26.3 steps/s
[Step= 150] | Loss=0.42526 | acc=0.5551 | tpr=0.9914 | fpr=0.4529 | 6912.4 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.42535 | acc=0.5560 | tpr=0.9913 | fpr=0.4519 | 6921.7 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.42651 | acc=0.5545 | tpr=0.9904 | fpr=0.4534 | 6927.1 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.42664 | acc=0.5548 | tpr=0.9920 | fpr=0.4532 | 6692.9 samples/s | 26.1 steps/s
[Step= 350] | Loss=0.42664 | acc=0.5553 | tpr=0.9912 | fpr=0.4526 | 6898.6 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.42657 | acc=0.5547 | tpr=0.9896 | fpr=0.4532 | 6879.8 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.42684 | acc=0.5544 | tpr=0.9888 | fpr=0.4534 | 6577.7 samples/s | 25.7 steps/s
[Step= 500] | Loss=0.42726 | acc=0.5537 | tpr=0.9890 | fpr=0.4542 | 6843.3 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.42712 | acc=0.5537 | tpr=0.9893 | fpr=0.4542 | 12521.0 samples/s | 48.9 steps/s
Avg test loss: 0.42715, Avg test acc: 0.55375, Avg tpr: 0.98891, Avg fpr: 0.45416, total FA: 63059

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 0.8] | Loss=0.28727 | Reg=0.00361 | FP-Reg=0.000 | acc=0.6562 | L2-Norm=19.007 | L2-Norm(final)=2.100 | 3716.7 samples/s | 58.1 steps/s
[Step= 850 Epoch= 0.8] | Loss=0.15025 | Reg=0.00364 | FP-Reg=0.004 | acc=0.8594 | L2-Norm=19.078 | L2-Norm(final)=2.093 | 3273.3 samples/s | 51.1 steps/s
[Step= 900 Epoch= 0.9] | Loss=0.13397 | Reg=0.00365 | FP-Reg=0.004 | acc=0.9062 | L2-Norm=19.100 | L2-Norm(final)=2.103 | 3457.7 samples/s | 54.0 steps/s
[Step= 950 Epoch= 0.9] | Loss=0.12266 | Reg=0.00366 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.119 | L2-Norm(final)=2.111 | 3474.4 samples/s | 54.3 steps/s
[Step=1000 Epoch= 1.0] | Loss=0.11542 | Reg=0.00366 | FP-Reg=0.005 | acc=0.8750 | L2-Norm=19.137 | L2-Norm(final)=2.119 | 3478.5 samples/s | 54.4 steps/s
[Step=1050 Epoch= 1.0] | Loss=0.11373 | Reg=0.00367 | FP-Reg=0.005 | acc=0.8906 | L2-Norm=19.156 | L2-Norm(final)=2.126 | 3480.7 samples/s | 54.4 steps/s
[Step=1100 Epoch= 1.1] | Loss=0.10937 | Reg=0.00368 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.175 | L2-Norm(final)=2.132 | 3490.8 samples/s | 54.5 steps/s
[Step=1150 Epoch= 1.1] | Loss=0.10557 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.137 | 3479.8 samples/s | 54.4 steps/s
[Step=1200 Epoch= 1.2] | Loss=0.10345 | Reg=0.00369 | FP-Reg=0.006 | acc=0.8750 | L2-Norm=19.208 | L2-Norm(final)=2.142 | 3467.8 samples/s | 54.2 steps/s
[Step=1250 Epoch= 1.2] | Loss=0.10074 | Reg=0.00370 | FP-Reg=0.007 | acc=0.9531 | L2-Norm=19.223 | L2-Norm(final)=2.146 | 3472.5 samples/s | 54.3 steps/s
[Step=1300 Epoch= 1.3] | Loss=0.09919 | Reg=0.00370 | FP-Reg=0.007 | acc=0.9531 | L2-Norm=19.237 | L2-Norm(final)=2.149 | 3472.4 samples/s | 54.3 steps/s
[Step=1350 Epoch= 1.3] | Loss=0.09726 | Reg=0.00371 | FP-Reg=0.007 | acc=0.9219 | L2-Norm=19.249 | L2-Norm(final)=2.152 | 3475.5 samples/s | 54.3 steps/s
[Step=1400 Epoch= 1.4] | Loss=0.09567 | Reg=0.00371 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.261 | L2-Norm(final)=2.155 | 3473.0 samples/s | 54.3 steps/s
[Step=1450 Epoch= 1.4] | Loss=0.09400 | Reg=0.00371 | FP-Reg=0.008 | acc=0.9219 | L2-Norm=19.272 | L2-Norm(final)=2.158 | 3474.1 samples/s | 54.3 steps/s
[Step=1500 Epoch= 1.5] | Loss=0.09230 | Reg=0.00372 | FP-Reg=0.008 | acc=0.9375 | L2-Norm=19.283 | L2-Norm(final)=2.160 | 3478.0 samples/s | 54.3 steps/s
[Step=1550 Epoch= 1.5] | Loss=0.09062 | Reg=0.00372 | FP-Reg=0.009 | acc=0.9531 | L2-Norm=19.293 | L2-Norm(final)=2.163 | 3471.7 samples/s | 54.2 steps/s
[Step=1600 Epoch= 1.6] | Loss=0.08902 | Reg=0.00373 | FP-Reg=0.009 | acc=0.9688 | L2-Norm=19.302 | L2-Norm(final)=2.165 | 3462.0 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step1600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 1.5] | Loss=0.14340 | Reg=0.00361 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.007 | L2-Norm(final)=2.101 | 3783.9 samples/s | 59.1 steps/s
[Step= 850 Epoch= 1.6] | Loss=0.03450 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.086 | L2-Norm(final)=2.113 | 3234.3 samples/s | 50.5 steps/s
[Step= 900 Epoch= 1.7] | Loss=0.03587 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.102 | L2-Norm(final)=2.110 | 3276.4 samples/s | 51.2 steps/s
[Step= 950 Epoch= 1.8] | Loss=0.02848 | Reg=0.00365 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.112 | L2-Norm(final)=2.109 | 3312.7 samples/s | 51.8 steps/s
[Step=1000 Epoch= 1.9] | Loss=0.02308 | Reg=0.00365 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.112 | L2-Norm(final)=2.111 | 3292.6 samples/s | 51.4 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.01983 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.109 | L2-Norm(final)=2.114 | 3305.9 samples/s | 51.7 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.01701 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.106 | L2-Norm(final)=2.119 | 3320.0 samples/s | 51.9 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.01588 | Reg=0.00365 | FP-Reg=0.006 | acc=0.9375 | L2-Norm=19.103 | L2-Norm(final)=2.123 | 3320.6 samples/s | 51.9 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.01533 | Reg=0.00365 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.102 | L2-Norm(final)=2.126 | 3335.3 samples/s | 52.1 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.01407 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.101 | L2-Norm(final)=2.130 | 3331.5 samples/s | 52.1 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.01295 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.100 | L2-Norm(final)=2.134 | 3332.1 samples/s | 52.1 steps/s
[Step=1350 Epoch= 2.5] | Loss=0.01196 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.098 | L2-Norm(final)=2.138 | 1696.8 samples/s | 26.5 steps/s
[Step=1400 Epoch= 2.6] | Loss=0.01104 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.096 | L2-Norm(final)=2.141 | 3319.8 samples/s | 51.9 steps/s
[Step=1450 Epoch= 2.7] | Loss=0.01024 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.093 | L2-Norm(final)=2.145 | 3308.3 samples/s | 51.7 steps/s
[Step=1500 Epoch= 2.8] | Loss=0.00956 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.090 | L2-Norm(final)=2.149 | 3305.7 samples/s | 51.7 steps/s
[Step=1550 Epoch= 2.9] | Loss=0.00902 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.086 | L2-Norm(final)=2.153 | 3315.5 samples/s | 51.8 steps/s
[Step=1600 Epoch= 3.0] | Loss=0.00888 | Reg=0.00364 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.084 | L2-Norm(final)=2.156 | 3310.0 samples/s | 51.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26881 | acc=0.7277 | tpr=0.6230 | fpr=0.0448 | 3705.2 samples/s | 14.5 steps/s
Avg test loss: 0.27151, Avg test acc: 0.72398, Avg tpr: 0.61951, Avg fpr: 0.04628, total FA: 361

Testing server on iccad2012
[Step=  50] | Loss=0.21469 | acc=0.8186 | tpr=0.9248 | fpr=0.1833 | 3717.2 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.21532 | acc=0.8209 | tpr=0.8955 | fpr=0.1805 | 6765.4 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.21664 | acc=0.8199 | tpr=0.8948 | fpr=0.1814 | 6839.0 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.21784 | acc=0.8193 | tpr=0.8929 | fpr=0.1820 | 7138.7 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.21822 | acc=0.8193 | tpr=0.8908 | fpr=0.1820 | 6765.1 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.21843 | acc=0.8194 | tpr=0.8902 | fpr=0.1819 | 6842.6 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.21839 | acc=0.8200 | tpr=0.8904 | fpr=0.1813 | 6765.4 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.21843 | acc=0.8204 | tpr=0.8889 | fpr=0.1809 | 6766.5 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.21866 | acc=0.8201 | tpr=0.8870 | fpr=0.1811 | 6974.4 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.21899 | acc=0.8196 | tpr=0.8877 | fpr=0.1817 | 6777.6 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.21855 | acc=0.8197 | tpr=0.8894 | fpr=0.1816 | 12594.6 samples/s | 49.2 steps/s
Avg test loss: 0.21862, Avg test acc: 0.81969, Avg tpr: 0.88946, Avg fpr: 0.18158, total FA: 25212

server round 2/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 1.6] | Loss=0.19019 | Reg=0.00366 | FP-Reg=0.000 | acc=0.7812 | L2-Norm=19.133 | L2-Norm(final)=2.193 | 3862.6 samples/s | 60.4 steps/s
[Step=1650 Epoch= 1.6] | Loss=0.10553 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.174 | L2-Norm(final)=2.180 | 3219.8 samples/s | 50.3 steps/s
[Step=1700 Epoch= 1.7] | Loss=0.09178 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9062 | L2-Norm=19.188 | L2-Norm(final)=2.192 | 3459.6 samples/s | 54.1 steps/s
[Step=1750 Epoch= 1.7] | Loss=0.08809 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.200 | L2-Norm(final)=2.198 | 3450.5 samples/s | 53.9 steps/s
[Step=1800 Epoch= 1.8] | Loss=0.08267 | Reg=0.00369 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.214 | L2-Norm(final)=2.204 | 3457.2 samples/s | 54.0 steps/s
[Step=1850 Epoch= 1.8] | Loss=0.08004 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.228 | L2-Norm(final)=2.210 | 3463.0 samples/s | 54.1 steps/s
[Step=1900 Epoch= 1.9] | Loss=0.07786 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.242 | L2-Norm(final)=2.215 | 3485.0 samples/s | 54.5 steps/s
[Step=1950 Epoch= 1.9] | Loss=0.07558 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.257 | L2-Norm(final)=2.220 | 3475.5 samples/s | 54.3 steps/s
[Step=2000 Epoch= 2.0] | Loss=0.07486 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9062 | L2-Norm=19.270 | L2-Norm(final)=2.224 | 3472.3 samples/s | 54.3 steps/s
[Step=2050 Epoch= 2.0] | Loss=0.07386 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.283 | L2-Norm(final)=2.227 | 3493.5 samples/s | 54.6 steps/s
[Step=2100 Epoch= 2.1] | Loss=0.07199 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.296 | L2-Norm(final)=2.231 | 3488.7 samples/s | 54.5 steps/s
[Step=2150 Epoch= 2.1] | Loss=0.07206 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.309 | L2-Norm(final)=2.233 | 3464.6 samples/s | 54.1 steps/s
[Step=2200 Epoch= 2.1] | Loss=0.07143 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.320 | L2-Norm(final)=2.235 | 3472.4 samples/s | 54.3 steps/s
[Step=2250 Epoch= 2.2] | Loss=0.07072 | Reg=0.00374 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.331 | L2-Norm(final)=2.237 | 3478.8 samples/s | 54.4 steps/s
[Step=2300 Epoch= 2.2] | Loss=0.07021 | Reg=0.00374 | FP-Reg=0.006 | acc=0.9219 | L2-Norm=19.342 | L2-Norm(final)=2.239 | 3485.0 samples/s | 54.5 steps/s
[Step=2350 Epoch= 2.3] | Loss=0.06975 | Reg=0.00374 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.351 | L2-Norm(final)=2.240 | 3477.4 samples/s | 54.3 steps/s
[Step=2400 Epoch= 2.3] | Loss=0.06886 | Reg=0.00375 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.361 | L2-Norm(final)=2.242 | 3477.1 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step2400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 3.0] | Loss=0.19201 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.133 | L2-Norm(final)=2.193 | 4003.4 samples/s | 62.6 steps/s
[Step=1650 Epoch= 3.1] | Loss=0.03831 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.193 | L2-Norm(final)=2.176 | 2887.6 samples/s | 45.1 steps/s
[Step=1700 Epoch= 3.2] | Loss=0.02286 | Reg=0.00369 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.202 | L2-Norm(final)=2.177 | 3304.5 samples/s | 51.6 steps/s
[Step=1750 Epoch= 3.3] | Loss=0.01742 | Reg=0.00369 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.197 | L2-Norm(final)=2.181 | 3330.6 samples/s | 52.0 steps/s
[Step=1800 Epoch= 3.4] | Loss=0.01391 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.188 | 3305.3 samples/s | 51.6 steps/s
[Step=1850 Epoch= 3.5] | Loss=0.01178 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.188 | L2-Norm(final)=2.195 | 3323.2 samples/s | 51.9 steps/s
[Step=1900 Epoch= 3.6] | Loss=0.00993 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.183 | L2-Norm(final)=2.201 | 3310.8 samples/s | 51.7 steps/s
[Step=1950 Epoch= 3.7] | Loss=0.00876 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.179 | L2-Norm(final)=2.207 | 3294.8 samples/s | 51.5 steps/s
[Step=2000 Epoch= 3.8] | Loss=0.00808 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.176 | L2-Norm(final)=2.212 | 3294.9 samples/s | 51.5 steps/s
[Step=2050 Epoch= 3.9] | Loss=0.00748 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.174 | L2-Norm(final)=2.216 | 3316.2 samples/s | 51.8 steps/s
[Step=2100 Epoch= 4.0] | Loss=0.00697 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.172 | L2-Norm(final)=2.221 | 3350.6 samples/s | 52.4 steps/s
[Step=2150 Epoch= 4.1] | Loss=0.00647 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.171 | L2-Norm(final)=2.225 | 1679.4 samples/s | 26.2 steps/s
[Step=2200 Epoch= 4.1] | Loss=0.00604 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.170 | L2-Norm(final)=2.229 | 3326.9 samples/s | 52.0 steps/s
[Step=2250 Epoch= 4.2] | Loss=0.00561 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.168 | L2-Norm(final)=2.233 | 3289.0 samples/s | 51.4 steps/s
[Step=2300 Epoch= 4.3] | Loss=0.00522 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.165 | L2-Norm(final)=2.236 | 3302.5 samples/s | 51.6 steps/s
[Step=2350 Epoch= 4.4] | Loss=0.00490 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.163 | L2-Norm(final)=2.240 | 3293.1 samples/s | 51.5 steps/s
[Step=2400 Epoch= 4.5] | Loss=0.00465 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.160 | L2-Norm(final)=2.243 | 3318.8 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18020 | acc=0.8388 | tpr=0.8001 | fpr=0.0771 | 3749.0 samples/s | 14.6 steps/s
Avg test loss: 0.18076, Avg test acc: 0.83673, Avg tpr: 0.79921, Avg fpr: 0.08076, total FA: 630

Testing server on iccad2012
[Step=  50] | Loss=0.36280 | acc=0.7091 | tpr=0.9823 | fpr=0.2958 | 3694.8 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.36211 | acc=0.7097 | tpr=0.9808 | fpr=0.2953 | 6983.2 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.36337 | acc=0.7084 | tpr=0.9755 | fpr=0.2965 | 7040.8 samples/s | 27.5 steps/s
[Step= 200] | Loss=0.36510 | acc=0.7085 | tpr=0.9738 | fpr=0.2964 | 6703.5 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.36529 | acc=0.7084 | tpr=0.9721 | fpr=0.2964 | 6789.0 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.36547 | acc=0.7083 | tpr=0.9724 | fpr=0.2965 | 7020.9 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.36558 | acc=0.7093 | tpr=0.9724 | fpr=0.2954 | 6867.8 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.36556 | acc=0.7093 | tpr=0.9726 | fpr=0.2955 | 6873.5 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.36591 | acc=0.7094 | tpr=0.9732 | fpr=0.2954 | 6844.9 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.36642 | acc=0.7088 | tpr=0.9714 | fpr=0.2960 | 6700.5 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.36576 | acc=0.7089 | tpr=0.9721 | fpr=0.2959 | 12140.2 samples/s | 47.4 steps/s
Avg test loss: 0.36597, Avg test acc: 0.70885, Avg tpr: 0.97187, Avg fpr: 0.29594, total FA: 41090

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 2.3] | Loss=0.12955 | Reg=0.00370 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.232 | L2-Norm(final)=2.271 | 4201.2 samples/s | 65.6 steps/s
[Step=2450 Epoch= 2.4] | Loss=0.07449 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.247 | L2-Norm(final)=2.267 | 3141.2 samples/s | 49.1 steps/s
[Step=2500 Epoch= 2.4] | Loss=0.07068 | Reg=0.00371 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.261 | L2-Norm(final)=2.272 | 3449.9 samples/s | 53.9 steps/s
[Step=2550 Epoch= 2.5] | Loss=0.06797 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.274 | L2-Norm(final)=2.277 | 3463.6 samples/s | 54.1 steps/s
[Step=2600 Epoch= 2.5] | Loss=0.06798 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.288 | L2-Norm(final)=2.282 | 3467.9 samples/s | 54.2 steps/s
[Step=2650 Epoch= 2.6] | Loss=0.06817 | Reg=0.00373 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.304 | L2-Norm(final)=2.286 | 3475.1 samples/s | 54.3 steps/s
[Step=2700 Epoch= 2.6] | Loss=0.06859 | Reg=0.00373 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.321 | L2-Norm(final)=2.288 | 3484.0 samples/s | 54.4 steps/s
[Step=2750 Epoch= 2.7] | Loss=0.06686 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.335 | L2-Norm(final)=2.290 | 3219.8 samples/s | 50.3 steps/s
[Step=2800 Epoch= 2.7] | Loss=0.06580 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9062 | L2-Norm=19.348 | L2-Norm(final)=2.292 | 3171.5 samples/s | 49.6 steps/s
[Step=2850 Epoch= 2.8] | Loss=0.06464 | Reg=0.00375 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.360 | L2-Norm(final)=2.293 | 3189.1 samples/s | 49.8 steps/s
[Step=2900 Epoch= 2.8] | Loss=0.06347 | Reg=0.00375 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.373 | L2-Norm(final)=2.295 | 3195.5 samples/s | 49.9 steps/s
[Step=2950 Epoch= 2.9] | Loss=0.06296 | Reg=0.00376 | FP-Reg=0.004 | acc=0.9062 | L2-Norm=19.385 | L2-Norm(final)=2.297 | 3189.7 samples/s | 49.8 steps/s
[Step=3000 Epoch= 2.9] | Loss=0.06289 | Reg=0.00376 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.396 | L2-Norm(final)=2.298 | 3178.1 samples/s | 49.7 steps/s
[Step=3050 Epoch= 3.0] | Loss=0.06219 | Reg=0.00377 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.408 | L2-Norm(final)=2.299 | 3194.5 samples/s | 49.9 steps/s
[Step=3100 Epoch= 3.0] | Loss=0.06149 | Reg=0.00377 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.419 | L2-Norm(final)=2.300 | 3200.0 samples/s | 50.0 steps/s
[Step=3150 Epoch= 3.1] | Loss=0.06114 | Reg=0.00378 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.429 | L2-Norm(final)=2.300 | 3157.8 samples/s | 49.3 steps/s
[Step=3200 Epoch= 3.1] | Loss=0.06045 | Reg=0.00378 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.439 | L2-Norm(final)=2.301 | 3181.4 samples/s | 49.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step3200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 4.5] | Loss=0.15829 | Reg=0.00370 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.232 | L2-Norm(final)=2.271 | 3932.2 samples/s | 61.4 steps/s
[Step=2450 Epoch= 4.6] | Loss=0.01868 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.285 | L2-Norm(final)=2.268 | 2966.1 samples/s | 46.3 steps/s
[Step=2500 Epoch= 4.7] | Loss=0.01474 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.286 | L2-Norm(final)=2.268 | 3275.4 samples/s | 51.2 steps/s
[Step=2550 Epoch= 4.8] | Loss=0.01364 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.291 | L2-Norm(final)=2.263 | 3300.4 samples/s | 51.6 steps/s
[Step=2600 Epoch= 4.9] | Loss=0.01202 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.295 | L2-Norm(final)=2.261 | 3296.2 samples/s | 51.5 steps/s
[Step=2650 Epoch= 5.0] | Loss=0.01067 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.299 | L2-Norm(final)=2.262 | 3301.7 samples/s | 51.6 steps/s
[Step=2700 Epoch= 5.1] | Loss=0.00956 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.299 | L2-Norm(final)=2.263 | 3318.7 samples/s | 51.9 steps/s
[Step=2750 Epoch= 5.2] | Loss=0.00895 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.299 | L2-Norm(final)=2.265 | 3332.3 samples/s | 52.1 steps/s
[Step=2800 Epoch= 5.3] | Loss=0.00826 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.299 | L2-Norm(final)=2.266 | 3315.5 samples/s | 51.8 steps/s
[Step=2850 Epoch= 5.4] | Loss=0.00753 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.298 | L2-Norm(final)=2.269 | 3303.7 samples/s | 51.6 steps/s
[Step=2900 Epoch= 5.5] | Loss=0.00706 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.297 | L2-Norm(final)=2.271 | 3328.3 samples/s | 52.0 steps/s
[Step=2950 Epoch= 5.6] | Loss=0.00683 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.296 | L2-Norm(final)=2.273 | 1700.3 samples/s | 26.6 steps/s
[Step=3000 Epoch= 5.7] | Loss=0.00631 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.295 | L2-Norm(final)=2.275 | 3340.1 samples/s | 52.2 steps/s
[Step=3050 Epoch= 5.7] | Loss=0.00586 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.293 | L2-Norm(final)=2.277 | 3317.7 samples/s | 51.8 steps/s
[Step=3100 Epoch= 5.8] | Loss=0.00548 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.291 | L2-Norm(final)=2.279 | 3325.5 samples/s | 52.0 steps/s
[Step=3150 Epoch= 5.9] | Loss=0.00514 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.288 | L2-Norm(final)=2.282 | 3075.8 samples/s | 48.1 steps/s
[Step=3200 Epoch= 6.0] | Loss=0.00482 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.285 | L2-Norm(final)=2.284 | 2969.1 samples/s | 46.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20677 | acc=0.8206 | tpr=0.7605 | fpr=0.0488 | 3262.0 samples/s | 12.7 steps/s
Avg test loss: 0.20763, Avg test acc: 0.81858, Avg tpr: 0.75917, Avg fpr: 0.05076, total FA: 396

Testing server on iccad2012
[Step=  50] | Loss=0.32970 | acc=0.7546 | tpr=0.9602 | fpr=0.2491 | 3695.5 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.32974 | acc=0.7573 | tpr=0.9616 | fpr=0.2465 | 6745.7 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.33067 | acc=0.7555 | tpr=0.9597 | fpr=0.2482 | 6773.8 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.33308 | acc=0.7550 | tpr=0.9596 | fpr=0.2487 | 6761.2 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.33385 | acc=0.7545 | tpr=0.9590 | fpr=0.2492 | 6825.1 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.33417 | acc=0.7544 | tpr=0.9615 | fpr=0.2493 | 6963.3 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.33433 | acc=0.7545 | tpr=0.9599 | fpr=0.2492 | 6965.3 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.33464 | acc=0.7546 | tpr=0.9623 | fpr=0.2492 | 6631.8 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.33568 | acc=0.7540 | tpr=0.9620 | fpr=0.2498 | 6789.6 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.33639 | acc=0.7532 | tpr=0.9608 | fpr=0.2505 | 6706.0 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.33575 | acc=0.7533 | tpr=0.9618 | fpr=0.2505 | 10627.5 samples/s | 41.5 steps/s
Avg test loss: 0.33589, Avg test acc: 0.75335, Avg tpr: 0.96157, Avg fpr: 0.25044, total FA: 34773

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch= 3.1] | Loss=0.13841 | Reg=0.00374 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.328 | L2-Norm(final)=2.308 | 3930.1 samples/s | 61.4 steps/s
[Step=3250 Epoch= 3.2] | Loss=0.06317 | Reg=0.00374 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.339 | L2-Norm(final)=2.309 | 3029.0 samples/s | 47.3 steps/s
[Step=3300 Epoch= 3.2] | Loss=0.06345 | Reg=0.00374 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.346 | L2-Norm(final)=2.311 | 3373.4 samples/s | 52.7 steps/s
[Step=3350 Epoch= 3.3] | Loss=0.06261 | Reg=0.00375 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.354 | L2-Norm(final)=2.311 | 3418.4 samples/s | 53.4 steps/s
[Step=3400 Epoch= 3.3] | Loss=0.05889 | Reg=0.00375 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.365 | L2-Norm(final)=2.312 | 3431.2 samples/s | 53.6 steps/s
[Step=3450 Epoch= 3.4] | Loss=0.05870 | Reg=0.00375 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.377 | L2-Norm(final)=2.314 | 3233.9 samples/s | 50.5 steps/s
[Step=3500 Epoch= 3.4] | Loss=0.05960 | Reg=0.00376 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.389 | L2-Norm(final)=2.315 | 3436.2 samples/s | 53.7 steps/s
[Step=3550 Epoch= 3.5] | Loss=0.05859 | Reg=0.00376 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.401 | L2-Norm(final)=2.316 | 3447.8 samples/s | 53.9 steps/s
[Step=3600 Epoch= 3.5] | Loss=0.05761 | Reg=0.00377 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.413 | L2-Norm(final)=2.317 | 3467.7 samples/s | 54.2 steps/s
[Step=3650 Epoch= 3.6] | Loss=0.05633 | Reg=0.00377 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.425 | L2-Norm(final)=2.318 | 3469.9 samples/s | 54.2 steps/s
[Step=3700 Epoch= 3.6] | Loss=0.05610 | Reg=0.00378 | FP-Reg=0.004 | acc=0.9062 | L2-Norm=19.435 | L2-Norm(final)=2.319 | 3485.7 samples/s | 54.5 steps/s
[Step=3750 Epoch= 3.7] | Loss=0.05625 | Reg=0.00378 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.445 | L2-Norm(final)=2.320 | 3455.2 samples/s | 54.0 steps/s
[Step=3800 Epoch= 3.7] | Loss=0.05501 | Reg=0.00379 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.455 | L2-Norm(final)=2.320 | 3465.1 samples/s | 54.1 steps/s
[Step=3850 Epoch= 3.8] | Loss=0.05437 | Reg=0.00379 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.465 | L2-Norm(final)=2.321 | 3473.2 samples/s | 54.3 steps/s
[Step=3900 Epoch= 3.8] | Loss=0.05413 | Reg=0.00379 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.474 | L2-Norm(final)=2.321 | 3467.3 samples/s | 54.2 steps/s
[Step=3950 Epoch= 3.9] | Loss=0.05364 | Reg=0.00380 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.484 | L2-Norm(final)=2.321 | 3468.0 samples/s | 54.2 steps/s
[Step=4000 Epoch= 3.9] | Loss=0.05381 | Reg=0.00380 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.492 | L2-Norm(final)=2.321 | 3476.8 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step4000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch= 6.0] | Loss=0.18418 | Reg=0.00374 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.328 | L2-Norm(final)=2.308 | 3962.4 samples/s | 61.9 steps/s
[Step=3250 Epoch= 6.1] | Loss=0.01831 | Reg=0.00375 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.372 | L2-Norm(final)=2.294 | 2878.2 samples/s | 45.0 steps/s
[Step=3300 Epoch= 6.2] | Loss=0.01319 | Reg=0.00375 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.367 | L2-Norm(final)=2.293 | 3313.5 samples/s | 51.8 steps/s
[Step=3350 Epoch= 6.3] | Loss=0.00991 | Reg=0.00375 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.360 | L2-Norm(final)=2.296 | 3298.1 samples/s | 51.5 steps/s
[Step=3400 Epoch= 6.4] | Loss=0.00830 | Reg=0.00375 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.352 | L2-Norm(final)=2.298 | 3311.2 samples/s | 51.7 steps/s
[Step=3450 Epoch= 6.5] | Loss=0.00723 | Reg=0.00374 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.346 | L2-Norm(final)=2.301 | 3304.6 samples/s | 51.6 steps/s
[Step=3500 Epoch= 6.6] | Loss=0.00634 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.342 | L2-Norm(final)=2.304 | 3313.5 samples/s | 51.8 steps/s
[Step=3550 Epoch= 6.7] | Loss=0.00566 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.339 | L2-Norm(final)=2.307 | 3301.6 samples/s | 51.6 steps/s
[Step=3600 Epoch= 6.8] | Loss=0.00516 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.337 | L2-Norm(final)=2.311 | 3327.4 samples/s | 52.0 steps/s
[Step=3650 Epoch= 6.9] | Loss=0.00478 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.335 | L2-Norm(final)=2.315 | 3305.9 samples/s | 51.7 steps/s
[Step=3700 Epoch= 7.0] | Loss=0.00452 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.334 | L2-Norm(final)=2.318 | 3347.0 samples/s | 52.3 steps/s
[Step=3750 Epoch= 7.1] | Loss=0.00428 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.333 | L2-Norm(final)=2.321 | 1697.8 samples/s | 26.5 steps/s
[Step=3800 Epoch= 7.2] | Loss=0.00416 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.333 | L2-Norm(final)=2.324 | 3295.1 samples/s | 51.5 steps/s
[Step=3850 Epoch= 7.3] | Loss=0.00402 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.334 | L2-Norm(final)=2.326 | 3292.3 samples/s | 51.4 steps/s
[Step=3900 Epoch= 7.4] | Loss=0.00413 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.335 | L2-Norm(final)=2.328 | 3298.7 samples/s | 51.5 steps/s
[Step=3950 Epoch= 7.4] | Loss=0.00417 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.340 | L2-Norm(final)=2.328 | 3295.1 samples/s | 51.5 steps/s
[Step=4000 Epoch= 7.5] | Loss=0.00404 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.344 | L2-Norm(final)=2.329 | 3313.9 samples/s | 51.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30001 | acc=0.7347 | tpr=0.6425 | fpr=0.0652 | 3742.4 samples/s | 14.6 steps/s
Avg test loss: 0.29943, Avg test acc: 0.73135, Avg tpr: 0.63956, Avg fpr: 0.06679, total FA: 521

Testing server on iccad2012
[Step=  50] | Loss=0.22215 | acc=0.8353 | tpr=0.9867 | fpr=0.1674 | 3748.2 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.22332 | acc=0.8363 | tpr=0.9829 | fpr=0.1664 | 6640.3 samples/s | 25.9 steps/s
[Step= 150] | Loss=0.22555 | acc=0.8344 | tpr=0.9784 | fpr=0.1682 | 6835.4 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.22598 | acc=0.8344 | tpr=0.9814 | fpr=0.1683 | 6777.6 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.22782 | acc=0.8334 | tpr=0.9825 | fpr=0.1693 | 6783.8 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.22867 | acc=0.8335 | tpr=0.9825 | fpr=0.1693 | 6934.3 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.22926 | acc=0.8333 | tpr=0.9812 | fpr=0.1693 | 6786.4 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.22917 | acc=0.8334 | tpr=0.9819 | fpr=0.1693 | 6918.8 samples/s | 27.0 steps/s
[Step= 450] | Loss=0.23003 | acc=0.8330 | tpr=0.9820 | fpr=0.1697 | 6634.9 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.23026 | acc=0.8331 | tpr=0.9802 | fpr=0.1696 | 6896.5 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.22963 | acc=0.8331 | tpr=0.9801 | fpr=0.1696 | 12746.0 samples/s | 49.8 steps/s
Avg test loss: 0.22963, Avg test acc: 0.83313, Avg tpr: 0.97979, Avg fpr: 0.16954, total FA: 23540

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch= 3.9] | Loss=0.26530 | Reg=0.00377 | FP-Reg=0.000 | acc=0.7656 | L2-Norm=19.421 | L2-Norm(final)=2.319 | 3586.3 samples/s | 56.0 steps/s
[Step=4050 Epoch= 4.0] | Loss=0.07059 | Reg=0.00378 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.448 | L2-Norm(final)=2.308 | 3458.5 samples/s | 54.0 steps/s
[Step=4100 Epoch= 4.0] | Loss=0.06482 | Reg=0.00379 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.458 | L2-Norm(final)=2.315 | 3455.3 samples/s | 54.0 steps/s
[Step=4150 Epoch= 4.1] | Loss=0.05899 | Reg=0.00379 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.465 | L2-Norm(final)=2.320 | 3451.6 samples/s | 53.9 steps/s
[Step=4200 Epoch= 4.1] | Loss=0.05801 | Reg=0.00379 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.474 | L2-Norm(final)=2.323 | 3456.6 samples/s | 54.0 steps/s
[Step=4250 Epoch= 4.1] | Loss=0.05789 | Reg=0.00380 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.486 | L2-Norm(final)=2.325 | 3464.2 samples/s | 54.1 steps/s
[Step=4300 Epoch= 4.2] | Loss=0.05784 | Reg=0.00380 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.497 | L2-Norm(final)=2.325 | 3472.8 samples/s | 54.3 steps/s
[Step=4350 Epoch= 4.2] | Loss=0.05683 | Reg=0.00381 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.507 | L2-Norm(final)=2.324 | 3465.1 samples/s | 54.1 steps/s
[Step=4400 Epoch= 4.3] | Loss=0.05568 | Reg=0.00381 | FP-Reg=0.004 | acc=0.9062 | L2-Norm=19.517 | L2-Norm(final)=2.325 | 3482.8 samples/s | 54.4 steps/s
[Step=4450 Epoch= 4.3] | Loss=0.05536 | Reg=0.00381 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.527 | L2-Norm(final)=2.324 | 3483.7 samples/s | 54.4 steps/s
[Step=4500 Epoch= 4.4] | Loss=0.05464 | Reg=0.00382 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.535 | L2-Norm(final)=2.324 | 3493.5 samples/s | 54.6 steps/s
[Step=4550 Epoch= 4.4] | Loss=0.05453 | Reg=0.00382 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.544 | L2-Norm(final)=2.324 | 3488.6 samples/s | 54.5 steps/s
[Step=4600 Epoch= 4.5] | Loss=0.05332 | Reg=0.00382 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.553 | L2-Norm(final)=2.324 | 3486.0 samples/s | 54.5 steps/s
[Step=4650 Epoch= 4.5] | Loss=0.05278 | Reg=0.00383 | FP-Reg=0.005 | acc=0.9062 | L2-Norm=19.561 | L2-Norm(final)=2.324 | 3457.3 samples/s | 54.0 steps/s
[Step=4700 Epoch= 4.6] | Loss=0.05259 | Reg=0.00383 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.568 | L2-Norm(final)=2.323 | 3469.5 samples/s | 54.2 steps/s
[Step=4750 Epoch= 4.6] | Loss=0.05245 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.576 | L2-Norm(final)=2.322 | 3457.9 samples/s | 54.0 steps/s
[Step=4800 Epoch= 4.7] | Loss=0.05188 | Reg=0.00383 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.583 | L2-Norm(final)=2.322 | 3457.9 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step4800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch= 7.5] | Loss=0.06151 | Reg=0.00377 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.421 | L2-Norm(final)=2.322 | 3980.3 samples/s | 62.2 steps/s
[Step=4050 Epoch= 7.6] | Loss=0.01459 | Reg=0.00377 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.421 | L2-Norm(final)=2.321 | 3015.5 samples/s | 47.1 steps/s
[Step=4100 Epoch= 7.7] | Loss=0.00935 | Reg=0.00377 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.417 | L2-Norm(final)=2.322 | 3278.4 samples/s | 51.2 steps/s
[Step=4150 Epoch= 7.8] | Loss=0.00729 | Reg=0.00377 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.415 | L2-Norm(final)=2.327 | 3299.7 samples/s | 51.6 steps/s
[Step=4200 Epoch= 7.9] | Loss=0.00622 | Reg=0.00377 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.415 | L2-Norm(final)=2.331 | 3306.0 samples/s | 51.7 steps/s
[Step=4250 Epoch= 8.0] | Loss=0.00505 | Reg=0.00377 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.414 | L2-Norm(final)=2.335 | 3312.4 samples/s | 51.8 steps/s
[Step=4300 Epoch= 8.1] | Loss=0.00456 | Reg=0.00377 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.412 | L2-Norm(final)=2.338 | 3334.2 samples/s | 52.1 steps/s
[Step=4350 Epoch= 8.2] | Loss=0.00407 | Reg=0.00377 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.409 | L2-Norm(final)=2.341 | 3329.2 samples/s | 52.0 steps/s
[Step=4400 Epoch= 8.3] | Loss=0.00360 | Reg=0.00377 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.407 | L2-Norm(final)=2.344 | 3337.5 samples/s | 52.1 steps/s
[Step=4450 Epoch= 8.4] | Loss=0.00324 | Reg=0.00377 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.405 | L2-Norm(final)=2.347 | 3327.9 samples/s | 52.0 steps/s
[Step=4500 Epoch= 8.5] | Loss=0.00294 | Reg=0.00376 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.402 | L2-Norm(final)=2.350 | 3348.6 samples/s | 52.3 steps/s
[Step=4550 Epoch= 8.6] | Loss=0.00269 | Reg=0.00376 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.399 | L2-Norm(final)=2.353 | 1717.9 samples/s | 26.8 steps/s
[Step=4600 Epoch= 8.7] | Loss=0.00247 | Reg=0.00376 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.396 | L2-Norm(final)=2.356 | 3341.6 samples/s | 52.2 steps/s
[Step=4650 Epoch= 8.8] | Loss=0.00228 | Reg=0.00376 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.393 | L2-Norm(final)=2.358 | 3314.3 samples/s | 51.8 steps/s
[Step=4700 Epoch= 8.9] | Loss=0.00213 | Reg=0.00376 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.389 | L2-Norm(final)=2.360 | 3310.1 samples/s | 51.7 steps/s
[Step=4750 Epoch= 9.0] | Loss=0.00199 | Reg=0.00376 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.386 | L2-Norm(final)=2.362 | 3306.9 samples/s | 51.7 steps/s
[Step=4800 Epoch= 9.0] | Loss=0.00187 | Reg=0.00376 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.383 | L2-Norm(final)=2.363 | 3325.8 samples/s | 52.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20054 | acc=0.8307 | tpr=0.7652 | fpr=0.0270 | 3734.3 samples/s | 14.6 steps/s
Avg test loss: 0.20134, Avg test acc: 0.82931, Avg tpr: 0.76511, Avg fpr: 0.02948, total FA: 230

Testing server on iccad2012
[Step=  50] | Loss=0.33746 | acc=0.7554 | tpr=0.9735 | fpr=0.2485 | 3742.4 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.33635 | acc=0.7557 | tpr=0.9616 | fpr=0.2481 | 6871.6 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.33828 | acc=0.7548 | tpr=0.9597 | fpr=0.2490 | 6786.7 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.33821 | acc=0.7557 | tpr=0.9628 | fpr=0.2481 | 6837.5 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.34046 | acc=0.7545 | tpr=0.9651 | fpr=0.2493 | 7002.1 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.34200 | acc=0.7545 | tpr=0.9658 | fpr=0.2494 | 6763.5 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.34204 | acc=0.7550 | tpr=0.9643 | fpr=0.2488 | 6565.5 samples/s | 25.6 steps/s
[Step= 400] | Loss=0.34194 | acc=0.7552 | tpr=0.9650 | fpr=0.2486 | 5837.5 samples/s | 22.8 steps/s
[Step= 450] | Loss=0.34294 | acc=0.7553 | tpr=0.9659 | fpr=0.2485 | 5813.2 samples/s | 22.7 steps/s
[Step= 500] | Loss=0.34320 | acc=0.7552 | tpr=0.9643 | fpr=0.2485 | 6459.9 samples/s | 25.2 steps/s
[Step= 550] | Loss=0.34283 | acc=0.7553 | tpr=0.9650 | fpr=0.2485 | 12526.0 samples/s | 48.9 steps/s
Avg test loss: 0.34308, Avg test acc: 0.75535, Avg tpr: 0.96513, Avg fpr: 0.24846, total FA: 34498

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch= 4.7] | Loss=0.07418 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.460 | L2-Norm(final)=2.345 | 3732.3 samples/s | 58.3 steps/s
[Step=4850 Epoch= 4.7] | Loss=0.05675 | Reg=0.00379 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.463 | L2-Norm(final)=2.347 | 3280.2 samples/s | 51.3 steps/s
[Step=4900 Epoch= 4.8] | Loss=0.05190 | Reg=0.00379 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.476 | L2-Norm(final)=2.348 | 3485.3 samples/s | 54.5 steps/s
[Step=4950 Epoch= 4.8] | Loss=0.04703 | Reg=0.00380 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.488 | L2-Norm(final)=2.351 | 3479.5 samples/s | 54.4 steps/s
[Step=5000 Epoch= 4.9] | Loss=0.04618 | Reg=0.00380 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.499 | L2-Norm(final)=2.352 | 3491.6 samples/s | 54.6 steps/s
[Step=5050 Epoch= 4.9] | Loss=0.04492 | Reg=0.00381 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.511 | L2-Norm(final)=2.353 | 3468.6 samples/s | 54.2 steps/s
[Step=5100 Epoch= 5.0] | Loss=0.04549 | Reg=0.00381 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.519 | L2-Norm(final)=2.353 | 3465.3 samples/s | 54.1 steps/s
[Step=5150 Epoch= 5.0] | Loss=0.04613 | Reg=0.00381 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.525 | L2-Norm(final)=2.352 | 3475.5 samples/s | 54.3 steps/s
[Step=5200 Epoch= 5.1] | Loss=0.04730 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.533 | L2-Norm(final)=2.349 | 3479.3 samples/s | 54.4 steps/s
[Step=5250 Epoch= 5.1] | Loss=0.04652 | Reg=0.00382 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.542 | L2-Norm(final)=2.348 | 3476.7 samples/s | 54.3 steps/s
[Step=5300 Epoch= 5.2] | Loss=0.04717 | Reg=0.00382 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.551 | L2-Norm(final)=2.347 | 3472.0 samples/s | 54.2 steps/s
[Step=5350 Epoch= 5.2] | Loss=0.04701 | Reg=0.00383 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.560 | L2-Norm(final)=2.345 | 3468.3 samples/s | 54.2 steps/s
[Step=5400 Epoch= 5.3] | Loss=0.04644 | Reg=0.00383 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.568 | L2-Norm(final)=2.344 | 3472.8 samples/s | 54.3 steps/s
[Step=5450 Epoch= 5.3] | Loss=0.04626 | Reg=0.00383 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.577 | L2-Norm(final)=2.343 | 3491.5 samples/s | 54.6 steps/s
[Step=5500 Epoch= 5.4] | Loss=0.04590 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.586 | L2-Norm(final)=2.342 | 3474.5 samples/s | 54.3 steps/s
[Step=5550 Epoch= 5.4] | Loss=0.04596 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.595 | L2-Norm(final)=2.341 | 3479.6 samples/s | 54.4 steps/s
[Step=5600 Epoch= 5.5] | Loss=0.04550 | Reg=0.00384 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.603 | L2-Norm(final)=2.341 | 3479.2 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step5600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch= 9.0] | Loss=0.11264 | Reg=0.00379 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.460 | L2-Norm(final)=2.345 | 3862.6 samples/s | 60.4 steps/s
[Step=4850 Epoch= 9.1] | Loss=0.02201 | Reg=0.00381 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.506 | L2-Norm(final)=2.341 | 3128.7 samples/s | 48.9 steps/s
[Step=4900 Epoch= 9.2] | Loss=0.01436 | Reg=0.00381 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.525 | L2-Norm(final)=2.326 | 3304.5 samples/s | 51.6 steps/s
[Step=4950 Epoch= 9.3] | Loss=0.01113 | Reg=0.00381 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.526 | L2-Norm(final)=2.326 | 3311.5 samples/s | 51.7 steps/s
[Step=5000 Epoch= 9.4] | Loss=0.00885 | Reg=0.00381 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.529 | L2-Norm(final)=2.328 | 3318.8 samples/s | 51.9 steps/s
[Step=5050 Epoch= 9.5] | Loss=0.00794 | Reg=0.00381 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.528 | L2-Norm(final)=2.331 | 3311.8 samples/s | 51.7 steps/s
[Step=5100 Epoch= 9.6] | Loss=0.00761 | Reg=0.00381 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.529 | L2-Norm(final)=2.333 | 3314.2 samples/s | 51.8 steps/s
[Step=5150 Epoch= 9.7] | Loss=0.00696 | Reg=0.00382 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.533 | L2-Norm(final)=2.334 | 3299.4 samples/s | 51.6 steps/s
[Step=5200 Epoch= 9.8] | Loss=0.00646 | Reg=0.00382 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.535 | L2-Norm(final)=2.335 | 3317.7 samples/s | 51.8 steps/s
[Step=5250 Epoch= 9.9] | Loss=0.00607 | Reg=0.00382 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.536 | L2-Norm(final)=2.338 | 3304.5 samples/s | 51.6 steps/s
[Step=5300 Epoch=10.0] | Loss=0.00661 | Reg=0.00382 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.540 | L2-Norm(final)=2.336 | 3344.6 samples/s | 52.3 steps/s
[Step=5350 Epoch=10.1] | Loss=0.00641 | Reg=0.00382 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.544 | L2-Norm(final)=2.334 | 1702.5 samples/s | 26.6 steps/s
[Step=5400 Epoch=10.2] | Loss=0.00603 | Reg=0.00382 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.546 | L2-Norm(final)=2.332 | 3353.2 samples/s | 52.4 steps/s
[Step=5450 Epoch=10.3] | Loss=0.00565 | Reg=0.00382 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.547 | L2-Norm(final)=2.331 | 3318.9 samples/s | 51.9 steps/s
[Step=5500 Epoch=10.4] | Loss=0.00527 | Reg=0.00382 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.547 | L2-Norm(final)=2.331 | 3297.5 samples/s | 51.5 steps/s
[Step=5550 Epoch=10.5] | Loss=0.00493 | Reg=0.00382 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.545 | L2-Norm(final)=2.332 | 3290.0 samples/s | 51.4 steps/s
[Step=5600 Epoch=10.6] | Loss=0.00465 | Reg=0.00382 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.543 | L2-Norm(final)=2.333 | 3298.3 samples/s | 51.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30395 | acc=0.7543 | tpr=0.6573 | fpr=0.0352 | 3728.4 samples/s | 14.6 steps/s
Avg test loss: 0.30315, Avg test acc: 0.75222, Avg tpr: 0.65600, Avg fpr: 0.03615, total FA: 282

Testing server on iccad2012
[Step=  50] | Loss=0.23564 | acc=0.8449 | tpr=0.9867 | fpr=0.1576 | 3698.8 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.23799 | acc=0.8429 | tpr=0.9787 | fpr=0.1596 | 7025.8 samples/s | 27.4 steps/s
[Step= 150] | Loss=0.24034 | acc=0.8416 | tpr=0.9798 | fpr=0.1610 | 6707.9 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.24177 | acc=0.8416 | tpr=0.9803 | fpr=0.1609 | 6926.9 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.24334 | acc=0.8405 | tpr=0.9808 | fpr=0.1620 | 6911.6 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.24471 | acc=0.8404 | tpr=0.9804 | fpr=0.1621 | 6756.9 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.24530 | acc=0.8403 | tpr=0.9806 | fpr=0.1623 | 6862.4 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.24559 | acc=0.8400 | tpr=0.9809 | fpr=0.1625 | 6909.0 samples/s | 27.0 steps/s
[Step= 450] | Loss=0.24716 | acc=0.8398 | tpr=0.9815 | fpr=0.1627 | 6634.9 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.24742 | acc=0.8394 | tpr=0.9806 | fpr=0.1631 | 6631.5 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.24686 | acc=0.8400 | tpr=0.9805 | fpr=0.1625 | 12672.3 samples/s | 49.5 steps/s
Avg test loss: 0.24703, Avg test acc: 0.84007, Avg tpr: 0.98059, Avg fpr: 0.16248, total FA: 22560

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch= 5.5] | Loss=0.27645 | Reg=0.00382 | FP-Reg=0.000 | acc=0.7812 | L2-Norm=19.543 | L2-Norm(final)=2.339 | 4107.6 samples/s | 64.2 steps/s
[Step=5650 Epoch= 5.5] | Loss=0.06147 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.565 | L2-Norm(final)=2.321 | 3188.6 samples/s | 49.8 steps/s
[Step=5700 Epoch= 5.6] | Loss=0.05421 | Reg=0.00383 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.569 | L2-Norm(final)=2.321 | 3435.6 samples/s | 53.7 steps/s
[Step=5750 Epoch= 5.6] | Loss=0.05107 | Reg=0.00383 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.574 | L2-Norm(final)=2.323 | 3449.6 samples/s | 53.9 steps/s
[Step=5800 Epoch= 5.7] | Loss=0.04906 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.577 | L2-Norm(final)=2.322 | 3460.5 samples/s | 54.1 steps/s
[Step=5850 Epoch= 5.7] | Loss=0.04928 | Reg=0.00384 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.584 | L2-Norm(final)=2.324 | 3460.0 samples/s | 54.1 steps/s
[Step=5900 Epoch= 5.8] | Loss=0.04745 | Reg=0.00384 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.593 | L2-Norm(final)=2.327 | 3456.2 samples/s | 54.0 steps/s
[Step=5950 Epoch= 5.8] | Loss=0.04768 | Reg=0.00384 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.603 | L2-Norm(final)=2.328 | 3450.7 samples/s | 53.9 steps/s
[Step=6000 Epoch= 5.9] | Loss=0.04749 | Reg=0.00385 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.612 | L2-Norm(final)=2.329 | 3458.3 samples/s | 54.0 steps/s
[Step=6050 Epoch= 5.9] | Loss=0.04683 | Reg=0.00385 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.622 | L2-Norm(final)=2.329 | 3461.7 samples/s | 54.1 steps/s
[Step=6100 Epoch= 6.0] | Loss=0.04594 | Reg=0.00385 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.631 | L2-Norm(final)=2.331 | 3451.0 samples/s | 53.9 steps/s
[Step=6150 Epoch= 6.0] | Loss=0.04612 | Reg=0.00386 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.640 | L2-Norm(final)=2.331 | 3446.3 samples/s | 53.8 steps/s
[Step=6200 Epoch= 6.1] | Loss=0.04604 | Reg=0.00386 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.649 | L2-Norm(final)=2.330 | 3446.1 samples/s | 53.8 steps/s
[Step=6250 Epoch= 6.1] | Loss=0.04527 | Reg=0.00386 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.657 | L2-Norm(final)=2.330 | 3456.4 samples/s | 54.0 steps/s
[Step=6300 Epoch= 6.2] | Loss=0.04514 | Reg=0.00387 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.665 | L2-Norm(final)=2.329 | 3462.0 samples/s | 54.1 steps/s
[Step=6350 Epoch= 6.2] | Loss=0.04485 | Reg=0.00387 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.673 | L2-Norm(final)=2.327 | 3456.2 samples/s | 54.0 steps/s
[Step=6400 Epoch= 6.2] | Loss=0.04478 | Reg=0.00387 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.680 | L2-Norm(final)=2.326 | 3467.5 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step6400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=10.6] | Loss=0.02404 | Reg=0.00382 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.543 | L2-Norm(final)=2.342 | 3703.7 samples/s | 57.9 steps/s
[Step=5650 Epoch=10.7] | Loss=0.01124 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.540 | L2-Norm(final)=2.352 | 3163.1 samples/s | 49.4 steps/s
[Step=5700 Epoch=10.7] | Loss=0.00912 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.549 | L2-Norm(final)=2.354 | 3300.9 samples/s | 51.6 steps/s
[Step=5750 Epoch=10.8] | Loss=0.00671 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.552 | L2-Norm(final)=2.354 | 3318.4 samples/s | 51.9 steps/s
[Step=5800 Epoch=10.9] | Loss=0.00540 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.551 | L2-Norm(final)=2.356 | 3300.3 samples/s | 51.6 steps/s
[Step=5850 Epoch=11.0] | Loss=0.00441 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.548 | L2-Norm(final)=2.359 | 3305.5 samples/s | 51.6 steps/s
[Step=5900 Epoch=11.1] | Loss=0.00372 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.543 | L2-Norm(final)=2.362 | 3326.8 samples/s | 52.0 steps/s
[Step=5950 Epoch=11.2] | Loss=0.00321 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.538 | L2-Norm(final)=2.364 | 3318.2 samples/s | 51.8 steps/s
[Step=6000 Epoch=11.3] | Loss=0.00283 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.532 | L2-Norm(final)=2.367 | 3325.5 samples/s | 52.0 steps/s
[Step=6050 Epoch=11.4] | Loss=0.00254 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.527 | L2-Norm(final)=2.369 | 3305.7 samples/s | 51.7 steps/s
[Step=6100 Epoch=11.5] | Loss=0.00240 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.523 | L2-Norm(final)=2.371 | 3352.8 samples/s | 52.4 steps/s
[Step=6150 Epoch=11.6] | Loss=0.00220 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.521 | L2-Norm(final)=2.373 | 1703.0 samples/s | 26.6 steps/s
[Step=6200 Epoch=11.7] | Loss=0.00204 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.518 | L2-Norm(final)=2.375 | 3310.3 samples/s | 51.7 steps/s
[Step=6250 Epoch=11.8] | Loss=0.00188 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.515 | L2-Norm(final)=2.377 | 3309.3 samples/s | 51.7 steps/s
[Step=6300 Epoch=11.9] | Loss=0.00176 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.512 | L2-Norm(final)=2.379 | 3318.0 samples/s | 51.8 steps/s
[Step=6350 Epoch=12.0] | Loss=0.00164 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.508 | L2-Norm(final)=2.380 | 3321.9 samples/s | 51.9 steps/s
[Step=6400 Epoch=12.1] | Loss=0.00154 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.505 | L2-Norm(final)=2.381 | 3330.8 samples/s | 52.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.16781 | acc=0.8641 | tpr=0.8123 | fpr=0.0235 | 3686.6 samples/s | 14.4 steps/s
Avg test loss: 0.16718, Avg test acc: 0.86429, Avg tpr: 0.81314, Avg fpr: 0.02320, total FA: 181

Testing server on iccad2012
[Step=  50] | Loss=0.42501 | acc=0.7152 | tpr=0.9735 | fpr=0.2895 | 3703.2 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.42432 | acc=0.7161 | tpr=0.9531 | fpr=0.2883 | 6828.2 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.42501 | acc=0.7163 | tpr=0.9568 | fpr=0.2881 | 6945.4 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.42582 | acc=0.7159 | tpr=0.9574 | fpr=0.2885 | 6892.2 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.42692 | acc=0.7146 | tpr=0.9572 | fpr=0.2898 | 6769.3 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.42801 | acc=0.7143 | tpr=0.9527 | fpr=0.2901 | 6847.9 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.42763 | acc=0.7145 | tpr=0.9524 | fpr=0.2898 | 7396.6 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.42806 | acc=0.7141 | tpr=0.9530 | fpr=0.2902 | 6375.9 samples/s | 24.9 steps/s
[Step= 450] | Loss=0.42938 | acc=0.7137 | tpr=0.9537 | fpr=0.2907 | 6689.7 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.42994 | acc=0.7135 | tpr=0.9529 | fpr=0.2908 | 6883.3 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.42955 | acc=0.7137 | tpr=0.9534 | fpr=0.2907 | 12411.2 samples/s | 48.5 steps/s
Avg test loss: 0.42990, Avg test acc: 0.71372, Avg tpr: 0.95325, Avg fpr: 0.29063, total FA: 40354

server round 8/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch= 6.2] | Loss=0.06890 | Reg=0.00383 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.571 | L2-Norm(final)=2.345 | 4023.0 samples/s | 62.9 steps/s
[Step=6450 Epoch= 6.3] | Loss=0.03846 | Reg=0.00383 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.564 | L2-Norm(final)=2.349 | 3240.9 samples/s | 50.6 steps/s
[Step=6500 Epoch= 6.3] | Loss=0.03891 | Reg=0.00383 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.565 | L2-Norm(final)=2.347 | 3457.4 samples/s | 54.0 steps/s
[Step=6550 Epoch= 6.4] | Loss=0.04092 | Reg=0.00383 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.570 | L2-Norm(final)=2.345 | 3462.3 samples/s | 54.1 steps/s
[Step=6600 Epoch= 6.4] | Loss=0.04163 | Reg=0.00383 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.577 | L2-Norm(final)=2.344 | 3473.6 samples/s | 54.3 steps/s
[Step=6650 Epoch= 6.5] | Loss=0.04110 | Reg=0.00384 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.587 | L2-Norm(final)=2.343 | 3463.0 samples/s | 54.1 steps/s
[Step=6700 Epoch= 6.5] | Loss=0.04080 | Reg=0.00384 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.597 | L2-Norm(final)=2.344 | 3470.8 samples/s | 54.2 steps/s
[Step=6750 Epoch= 6.6] | Loss=0.04140 | Reg=0.00384 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.608 | L2-Norm(final)=2.343 | 3472.4 samples/s | 54.3 steps/s
[Step=6800 Epoch= 6.6] | Loss=0.04067 | Reg=0.00385 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.617 | L2-Norm(final)=2.342 | 3480.0 samples/s | 54.4 steps/s
[Step=6850 Epoch= 6.7] | Loss=0.04021 | Reg=0.00385 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.627 | L2-Norm(final)=2.343 | 3490.5 samples/s | 54.5 steps/s
[Step=6900 Epoch= 6.7] | Loss=0.03993 | Reg=0.00386 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.636 | L2-Norm(final)=2.343 | 3454.1 samples/s | 54.0 steps/s
[Step=6950 Epoch= 6.8] | Loss=0.04005 | Reg=0.00386 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.644 | L2-Norm(final)=2.344 | 3475.0 samples/s | 54.3 steps/s
[Step=7000 Epoch= 6.8] | Loss=0.04000 | Reg=0.00386 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.653 | L2-Norm(final)=2.343 | 3466.7 samples/s | 54.2 steps/s
[Step=7050 Epoch= 6.9] | Loss=0.04001 | Reg=0.00387 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.660 | L2-Norm(final)=2.343 | 3469.0 samples/s | 54.2 steps/s
[Step=7100 Epoch= 6.9] | Loss=0.04008 | Reg=0.00387 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.668 | L2-Norm(final)=2.342 | 3478.5 samples/s | 54.4 steps/s
[Step=7150 Epoch= 7.0] | Loss=0.03957 | Reg=0.00387 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.676 | L2-Norm(final)=2.341 | 3460.9 samples/s | 54.1 steps/s
[Step=7200 Epoch= 7.0] | Loss=0.03959 | Reg=0.00387 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.683 | L2-Norm(final)=2.341 | 3474.5 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step7200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=12.1] | Loss=0.22276 | Reg=0.00383 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.571 | L2-Norm(final)=2.343 | 3758.7 samples/s | 58.7 steps/s
[Step=6450 Epoch=12.2] | Loss=0.02572 | Reg=0.00387 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.676 | L2-Norm(final)=2.322 | 3105.1 samples/s | 48.5 steps/s
[Step=6500 Epoch=12.3] | Loss=0.01710 | Reg=0.00388 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.694 | L2-Norm(final)=2.300 | 3320.1 samples/s | 51.9 steps/s
[Step=6550 Epoch=12.3] | Loss=0.01277 | Reg=0.00388 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.685 | L2-Norm(final)=2.294 | 3313.5 samples/s | 51.8 steps/s
[Step=6600 Epoch=12.4] | Loss=0.00994 | Reg=0.00387 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.676 | L2-Norm(final)=2.295 | 3342.5 samples/s | 52.2 steps/s
[Step=6650 Epoch=12.5] | Loss=0.00852 | Reg=0.00387 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.667 | L2-Norm(final)=2.300 | 3326.1 samples/s | 52.0 steps/s
[Step=6700 Epoch=12.6] | Loss=0.00752 | Reg=0.00387 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.660 | L2-Norm(final)=2.304 | 3327.9 samples/s | 52.0 steps/s
[Step=6750 Epoch=12.7] | Loss=0.00662 | Reg=0.00386 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.654 | L2-Norm(final)=2.307 | 3324.7 samples/s | 51.9 steps/s
[Step=6800 Epoch=12.8] | Loss=0.00584 | Reg=0.00386 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.647 | L2-Norm(final)=2.310 | 3275.0 samples/s | 51.2 steps/s
[Step=6850 Epoch=12.9] | Loss=0.00523 | Reg=0.00386 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.641 | L2-Norm(final)=2.313 | 3309.6 samples/s | 51.7 steps/s
[Step=6900 Epoch=13.0] | Loss=0.00474 | Reg=0.00386 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.634 | L2-Norm(final)=2.317 | 3323.5 samples/s | 51.9 steps/s
[Step=6950 Epoch=13.1] | Loss=0.00445 | Reg=0.00385 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.628 | L2-Norm(final)=2.320 | 1700.6 samples/s | 26.6 steps/s
[Step=7000 Epoch=13.2] | Loss=0.00412 | Reg=0.00385 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.623 | L2-Norm(final)=2.323 | 3334.1 samples/s | 52.1 steps/s
[Step=7050 Epoch=13.3] | Loss=0.00382 | Reg=0.00385 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.618 | L2-Norm(final)=2.326 | 3294.7 samples/s | 51.5 steps/s
[Step=7100 Epoch=13.4] | Loss=0.00355 | Reg=0.00385 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.613 | L2-Norm(final)=2.330 | 3305.2 samples/s | 51.6 steps/s
[Step=7150 Epoch=13.5] | Loss=0.00333 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.608 | L2-Norm(final)=2.332 | 3324.0 samples/s | 51.9 steps/s
[Step=7200 Epoch=13.6] | Loss=0.00313 | Reg=0.00384 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.603 | L2-Norm(final)=2.335 | 3305.3 samples/s | 51.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21844 | acc=0.8307 | tpr=0.7630 | fpr=0.0223 | 3724.2 samples/s | 14.5 steps/s
Avg test loss: 0.21963, Avg test acc: 0.82611, Avg tpr: 0.75806, Avg fpr: 0.02423, total FA: 189

Testing server on iccad2012
[Step=  50] | Loss=0.30567 | acc=0.7944 | tpr=0.9867 | fpr=0.2091 | 3726.0 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.30547 | acc=0.7950 | tpr=0.9701 | fpr=0.2082 | 6976.7 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.30865 | acc=0.7933 | tpr=0.9726 | fpr=0.2100 | 6884.9 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.30974 | acc=0.7924 | tpr=0.9749 | fpr=0.2109 | 6726.5 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.31001 | acc=0.7925 | tpr=0.9755 | fpr=0.2108 | 6992.9 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.31075 | acc=0.7927 | tpr=0.9724 | fpr=0.2106 | 6727.9 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.31011 | acc=0.7936 | tpr=0.9724 | fpr=0.2097 | 6774.5 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.31132 | acc=0.7926 | tpr=0.9710 | fpr=0.2107 | 6851.2 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.31219 | acc=0.7928 | tpr=0.9718 | fpr=0.2105 | 6856.6 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.31295 | acc=0.7922 | tpr=0.9714 | fpr=0.2110 | 6686.5 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.31236 | acc=0.7926 | tpr=0.9717 | fpr=0.2107 | 12844.5 samples/s | 50.2 steps/s
Avg test loss: 0.31262, Avg test acc: 0.79263, Avg tpr: 0.97187, Avg fpr: 0.21063, total FA: 29245

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch= 7.0] | Loss=0.12364 | Reg=0.00384 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.600 | L2-Norm(final)=2.344 | 3883.7 samples/s | 60.7 steps/s
[Step=7250 Epoch= 7.1] | Loss=0.05244 | Reg=0.00385 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.611 | L2-Norm(final)=2.337 | 3157.8 samples/s | 49.3 steps/s
[Step=7300 Epoch= 7.1] | Loss=0.04230 | Reg=0.00385 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.614 | L2-Norm(final)=2.341 | 3459.8 samples/s | 54.1 steps/s
[Step=7350 Epoch= 7.2] | Loss=0.04078 | Reg=0.00385 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.617 | L2-Norm(final)=2.344 | 3466.7 samples/s | 54.2 steps/s
[Step=7400 Epoch= 7.2] | Loss=0.03976 | Reg=0.00385 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.623 | L2-Norm(final)=2.346 | 3461.8 samples/s | 54.1 steps/s
[Step=7450 Epoch= 7.3] | Loss=0.03959 | Reg=0.00385 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.629 | L2-Norm(final)=2.346 | 3460.3 samples/s | 54.1 steps/s
[Step=7500 Epoch= 7.3] | Loss=0.03954 | Reg=0.00386 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.637 | L2-Norm(final)=2.347 | 3466.7 samples/s | 54.2 steps/s
[Step=7550 Epoch= 7.4] | Loss=0.03945 | Reg=0.00386 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.646 | L2-Norm(final)=2.345 | 3455.3 samples/s | 54.0 steps/s
[Step=7600 Epoch= 7.4] | Loss=0.03968 | Reg=0.00386 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.656 | L2-Norm(final)=2.343 | 3451.6 samples/s | 53.9 steps/s
[Step=7650 Epoch= 7.5] | Loss=0.03928 | Reg=0.00387 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.665 | L2-Norm(final)=2.342 | 3448.7 samples/s | 53.9 steps/s
[Step=7700 Epoch= 7.5] | Loss=0.03969 | Reg=0.00387 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.674 | L2-Norm(final)=2.340 | 3451.0 samples/s | 53.9 steps/s
[Step=7750 Epoch= 7.6] | Loss=0.03945 | Reg=0.00387 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.683 | L2-Norm(final)=2.339 | 3449.3 samples/s | 53.9 steps/s
[Step=7800 Epoch= 7.6] | Loss=0.03995 | Reg=0.00388 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.692 | L2-Norm(final)=2.337 | 3460.9 samples/s | 54.1 steps/s
[Step=7850 Epoch= 7.7] | Loss=0.03970 | Reg=0.00388 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.700 | L2-Norm(final)=2.336 | 3468.6 samples/s | 54.2 steps/s
[Step=7900 Epoch= 7.7] | Loss=0.03984 | Reg=0.00388 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.708 | L2-Norm(final)=2.333 | 3449.3 samples/s | 53.9 steps/s
[Step=7950 Epoch= 7.8] | Loss=0.03979 | Reg=0.00389 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.716 | L2-Norm(final)=2.331 | 3436.8 samples/s | 53.7 steps/s
[Step=8000 Epoch= 7.8] | Loss=0.03968 | Reg=0.00389 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.723 | L2-Norm(final)=2.330 | 3464.0 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step8000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=13.6] | Loss=0.13700 | Reg=0.00384 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.600 | L2-Norm(final)=2.345 | 3893.8 samples/s | 60.8 steps/s
[Step=7250 Epoch=13.7] | Loss=0.01264 | Reg=0.00385 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.620 | L2-Norm(final)=2.341 | 3054.6 samples/s | 47.7 steps/s
[Step=7300 Epoch=13.8] | Loss=0.00897 | Reg=0.00386 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.643 | L2-Norm(final)=2.331 | 3322.9 samples/s | 51.9 steps/s
[Step=7350 Epoch=13.9] | Loss=0.00777 | Reg=0.00386 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.646 | L2-Norm(final)=2.331 | 3331.1 samples/s | 52.0 steps/s
[Step=7400 Epoch=13.9] | Loss=0.00790 | Reg=0.00386 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.654 | L2-Norm(final)=2.328 | 3318.0 samples/s | 51.8 steps/s
[Step=7450 Epoch=14.0] | Loss=0.00672 | Reg=0.00387 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.662 | L2-Norm(final)=2.326 | 3306.8 samples/s | 51.7 steps/s
[Step=7500 Epoch=14.1] | Loss=0.00574 | Reg=0.00387 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.664 | L2-Norm(final)=2.327 | 3325.4 samples/s | 52.0 steps/s
[Step=7550 Epoch=14.2] | Loss=0.00528 | Reg=0.00387 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.664 | L2-Norm(final)=2.327 | 3326.0 samples/s | 52.0 steps/s
[Step=7600 Epoch=14.3] | Loss=0.00471 | Reg=0.00387 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.662 | L2-Norm(final)=2.328 | 3300.8 samples/s | 51.6 steps/s
[Step=7650 Epoch=14.4] | Loss=0.00424 | Reg=0.00387 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.660 | L2-Norm(final)=2.330 | 3300.1 samples/s | 51.6 steps/s
[Step=7700 Epoch=14.5] | Loss=0.00383 | Reg=0.00386 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.656 | L2-Norm(final)=2.332 | 3346.8 samples/s | 52.3 steps/s
[Step=7750 Epoch=14.6] | Loss=0.00357 | Reg=0.00386 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.653 | L2-Norm(final)=2.334 | 1705.0 samples/s | 26.6 steps/s
[Step=7800 Epoch=14.7] | Loss=0.00328 | Reg=0.00386 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.649 | L2-Norm(final)=2.336 | 3324.9 samples/s | 52.0 steps/s
[Step=7850 Epoch=14.8] | Loss=0.00304 | Reg=0.00386 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.645 | L2-Norm(final)=2.338 | 3315.0 samples/s | 51.8 steps/s
[Step=7900 Epoch=14.9] | Loss=0.00283 | Reg=0.00386 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.640 | L2-Norm(final)=2.340 | 3309.9 samples/s | 51.7 steps/s
[Step=7950 Epoch=15.0] | Loss=0.00265 | Reg=0.00386 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.636 | L2-Norm(final)=2.342 | 3310.8 samples/s | 51.7 steps/s
[Step=8000 Epoch=15.1] | Loss=0.00249 | Reg=0.00385 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.631 | L2-Norm(final)=2.344 | 3324.7 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39426 | acc=0.7088 | tpr=0.5795 | fpr=0.0104 | 3701.2 samples/s | 14.5 steps/s
Avg test loss: 0.39919, Avg test acc: 0.70330, Avg tpr: 0.57277, Avg fpr: 0.00961, total FA: 75

Testing server on iccad2012
[Step=  50] | Loss=0.20378 | acc=0.8664 | tpr=0.9912 | fpr=0.1358 | 3729.4 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.20330 | acc=0.8670 | tpr=0.9723 | fpr=0.1350 | 6726.5 samples/s | 26.3 steps/s
[Step= 150] | Loss=0.20635 | acc=0.8659 | tpr=0.9755 | fpr=0.1362 | 7106.0 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.20844 | acc=0.8661 | tpr=0.9781 | fpr=0.1359 | 6667.9 samples/s | 26.0 steps/s
[Step= 250] | Loss=0.20859 | acc=0.8661 | tpr=0.9773 | fpr=0.1359 | 6827.5 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.20983 | acc=0.8656 | tpr=0.9753 | fpr=0.1364 | 6812.0 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.20980 | acc=0.8660 | tpr=0.9743 | fpr=0.1360 | 6886.2 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.21076 | acc=0.8657 | tpr=0.9737 | fpr=0.1362 | 6772.2 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.21215 | acc=0.8656 | tpr=0.9737 | fpr=0.1363 | 6691.9 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.21200 | acc=0.8655 | tpr=0.9727 | fpr=0.1364 | 6798.2 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.21123 | acc=0.8660 | tpr=0.9721 | fpr=0.1360 | 12703.1 samples/s | 49.6 steps/s
Avg test loss: 0.21145, Avg test acc: 0.86599, Avg tpr: 0.97227, Avg fpr: 0.13594, total FA: 18875

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch= 7.8] | Loss=0.37335 | Reg=0.00386 | FP-Reg=0.000 | acc=0.7812 | L2-Norm=19.636 | L2-Norm(final)=2.333 | 3724.1 samples/s | 58.2 steps/s
[Step=8050 Epoch= 7.9] | Loss=0.04812 | Reg=0.00386 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.636 | L2-Norm(final)=2.322 | 3357.8 samples/s | 52.5 steps/s
[Step=8100 Epoch= 7.9] | Loss=0.03476 | Reg=0.00385 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.631 | L2-Norm(final)=2.330 | 3452.1 samples/s | 53.9 steps/s
[Step=8150 Epoch= 8.0] | Loss=0.03213 | Reg=0.00385 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.630 | L2-Norm(final)=2.336 | 3457.8 samples/s | 54.0 steps/s
[Step=8200 Epoch= 8.0] | Loss=0.03092 | Reg=0.00385 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.628 | L2-Norm(final)=2.338 | 3461.3 samples/s | 54.1 steps/s
[Step=8250 Epoch= 8.1] | Loss=0.02974 | Reg=0.00385 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.628 | L2-Norm(final)=2.340 | 3463.7 samples/s | 54.1 steps/s
[Step=8300 Epoch= 8.1] | Loss=0.02917 | Reg=0.00385 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.628 | L2-Norm(final)=2.341 | 3469.1 samples/s | 54.2 steps/s
[Step=8350 Epoch= 8.2] | Loss=0.02837 | Reg=0.00385 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.628 | L2-Norm(final)=2.343 | 3470.0 samples/s | 54.2 steps/s
[Step=8400 Epoch= 8.2] | Loss=0.02856 | Reg=0.00385 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.628 | L2-Norm(final)=2.344 | 3444.9 samples/s | 53.8 steps/s
[Step=8450 Epoch= 8.3] | Loss=0.02798 | Reg=0.00385 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.629 | L2-Norm(final)=2.346 | 3456.7 samples/s | 54.0 steps/s
[Step=8500 Epoch= 8.3] | Loss=0.02805 | Reg=0.00385 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.630 | L2-Norm(final)=2.347 | 3467.8 samples/s | 54.2 steps/s
[Step=8550 Epoch= 8.3] | Loss=0.02769 | Reg=0.00385 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.631 | L2-Norm(final)=2.349 | 3465.4 samples/s | 54.1 steps/s
[Step=8600 Epoch= 8.4] | Loss=0.02779 | Reg=0.00385 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.632 | L2-Norm(final)=2.350 | 3467.6 samples/s | 54.2 steps/s
[Step=8650 Epoch= 8.4] | Loss=0.02748 | Reg=0.00385 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.634 | L2-Norm(final)=2.352 | 3478.0 samples/s | 54.3 steps/s
[Step=8700 Epoch= 8.5] | Loss=0.02725 | Reg=0.00386 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.635 | L2-Norm(final)=2.353 | 3463.3 samples/s | 54.1 steps/s
[Step=8750 Epoch= 8.5] | Loss=0.02729 | Reg=0.00386 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.637 | L2-Norm(final)=2.355 | 3453.7 samples/s | 54.0 steps/s
[Step=8800 Epoch= 8.6] | Loss=0.02719 | Reg=0.00386 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.638 | L2-Norm(final)=2.356 | 3470.5 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step8800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=15.1] | Loss=0.09825 | Reg=0.00386 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.636 | L2-Norm(final)=2.334 | 3761.2 samples/s | 58.8 steps/s
[Step=8050 Epoch=15.2] | Loss=0.00633 | Reg=0.00384 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.600 | L2-Norm(final)=2.338 | 3052.1 samples/s | 47.7 steps/s
[Step=8100 Epoch=15.3] | Loss=0.00405 | Reg=0.00384 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.588 | L2-Norm(final)=2.342 | 3263.8 samples/s | 51.0 steps/s
[Step=8150 Epoch=15.4] | Loss=0.00327 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.580 | L2-Norm(final)=2.344 | 3292.3 samples/s | 51.4 steps/s
[Step=8200 Epoch=15.5] | Loss=0.00258 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.575 | L2-Norm(final)=2.346 | 3286.6 samples/s | 51.4 steps/s
[Step=8250 Epoch=15.6] | Loss=0.00210 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.571 | L2-Norm(final)=2.348 | 3306.2 samples/s | 51.7 steps/s
[Step=8300 Epoch=15.6] | Loss=0.00178 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.567 | L2-Norm(final)=2.350 | 3301.6 samples/s | 51.6 steps/s
[Step=8350 Epoch=15.7] | Loss=0.00155 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.564 | L2-Norm(final)=2.351 | 3288.1 samples/s | 51.4 steps/s
[Step=8400 Epoch=15.8] | Loss=0.00137 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.561 | L2-Norm(final)=2.353 | 3309.2 samples/s | 51.7 steps/s
[Step=8450 Epoch=15.9] | Loss=0.00125 | Reg=0.00383 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.558 | L2-Norm(final)=2.354 | 3266.9 samples/s | 51.0 steps/s
[Step=8500 Epoch=16.0] | Loss=0.00114 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.556 | L2-Norm(final)=2.356 | 3237.0 samples/s | 50.6 steps/s
[Step=8550 Epoch=16.1] | Loss=0.00104 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.553 | L2-Norm(final)=2.357 | 1703.3 samples/s | 26.6 steps/s
[Step=8600 Epoch=16.2] | Loss=0.00096 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.551 | L2-Norm(final)=2.358 | 3324.0 samples/s | 51.9 steps/s
[Step=8650 Epoch=16.3] | Loss=0.00089 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.549 | L2-Norm(final)=2.359 | 3319.9 samples/s | 51.9 steps/s
[Step=8700 Epoch=16.4] | Loss=0.00083 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.547 | L2-Norm(final)=2.360 | 3323.4 samples/s | 51.9 steps/s
[Step=8750 Epoch=16.5] | Loss=0.00078 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.545 | L2-Norm(final)=2.361 | 3311.1 samples/s | 51.7 steps/s
[Step=8800 Epoch=16.6] | Loss=0.00073 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.543 | L2-Norm(final)=2.362 | 3296.1 samples/s | 51.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.15968 | acc=0.8782 | tpr=0.8355 | fpr=0.0290 | 3792.4 samples/s | 14.8 steps/s
Avg test loss: 0.15914, Avg test acc: 0.87675, Avg tpr: 0.83488, Avg fpr: 0.03115, total FA: 243

Testing server on iccad2012
[Step=  50] | Loss=0.49745 | acc=0.7207 | tpr=0.9912 | fpr=0.2842 | 3702.5 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.49427 | acc=0.7238 | tpr=0.9808 | fpr=0.2810 | 6864.0 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.49825 | acc=0.7214 | tpr=0.9856 | fpr=0.2835 | 7035.5 samples/s | 27.5 steps/s
[Step= 200] | Loss=0.50142 | acc=0.7202 | tpr=0.9880 | fpr=0.2847 | 6720.1 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.50233 | acc=0.7195 | tpr=0.9878 | fpr=0.2853 | 6736.4 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.50391 | acc=0.7205 | tpr=0.9862 | fpr=0.2844 | 6152.1 samples/s | 24.0 steps/s
[Step= 350] | Loss=0.50351 | acc=0.7204 | tpr=0.9856 | fpr=0.2844 | 5883.8 samples/s | 23.0 steps/s
[Step= 400] | Loss=0.50533 | acc=0.7199 | tpr=0.9858 | fpr=0.2850 | 6053.8 samples/s | 23.6 steps/s
[Step= 450] | Loss=0.50710 | acc=0.7197 | tpr=0.9859 | fpr=0.2851 | 6464.6 samples/s | 25.3 steps/s
[Step= 500] | Loss=0.50689 | acc=0.7196 | tpr=0.9846 | fpr=0.2852 | 6477.6 samples/s | 25.3 steps/s
[Step= 550] | Loss=0.50580 | acc=0.7200 | tpr=0.9845 | fpr=0.2848 | 12303.5 samples/s | 48.1 steps/s
Avg test loss: 0.50636, Avg test acc: 0.71996, Avg tpr: 0.98455, Avg fpr: 0.28485, total FA: 39551

server round 11/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch= 8.6] | Loss=0.09719 | Reg=0.00383 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.567 | L2-Norm(final)=2.370 | 3899.7 samples/s | 60.9 steps/s
[Step=8850 Epoch= 8.6] | Loss=0.03343 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.539 | L2-Norm(final)=2.366 | 3329.1 samples/s | 52.0 steps/s
[Step=8900 Epoch= 8.7] | Loss=0.02658 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.531 | L2-Norm(final)=2.371 | 3407.2 samples/s | 53.2 steps/s
[Step=8950 Epoch= 8.7] | Loss=0.02516 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.530 | L2-Norm(final)=2.376 | 3419.3 samples/s | 53.4 steps/s
[Step=9000 Epoch= 8.8] | Loss=0.02537 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.530 | L2-Norm(final)=2.378 | 3432.5 samples/s | 53.6 steps/s
[Step=9050 Epoch= 8.8] | Loss=0.02470 | Reg=0.00381 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.531 | L2-Norm(final)=2.381 | 3432.6 samples/s | 53.6 steps/s
[Step=9100 Epoch= 8.9] | Loss=0.02442 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.533 | L2-Norm(final)=2.383 | 3455.7 samples/s | 54.0 steps/s
[Step=9150 Epoch= 8.9] | Loss=0.02435 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.535 | L2-Norm(final)=2.385 | 3446.9 samples/s | 53.9 steps/s
[Step=9200 Epoch= 9.0] | Loss=0.02416 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.537 | L2-Norm(final)=2.386 | 3455.0 samples/s | 54.0 steps/s
[Step=9250 Epoch= 9.0] | Loss=0.02414 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.539 | L2-Norm(final)=2.388 | 3442.9 samples/s | 53.8 steps/s
[Step=9300 Epoch= 9.1] | Loss=0.02397 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.541 | L2-Norm(final)=2.388 | 3443.0 samples/s | 53.8 steps/s
[Step=9350 Epoch= 9.1] | Loss=0.02417 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.542 | L2-Norm(final)=2.389 | 3460.2 samples/s | 54.1 steps/s
[Step=9400 Epoch= 9.2] | Loss=0.02402 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.544 | L2-Norm(final)=2.390 | 3473.2 samples/s | 54.3 steps/s
[Step=9450 Epoch= 9.2] | Loss=0.02421 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.546 | L2-Norm(final)=2.391 | 3467.3 samples/s | 54.2 steps/s
[Step=9500 Epoch= 9.3] | Loss=0.02437 | Reg=0.00382 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.548 | L2-Norm(final)=2.391 | 3471.6 samples/s | 54.2 steps/s
[Step=9550 Epoch= 9.3] | Loss=0.02431 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.550 | L2-Norm(final)=2.392 | 3450.6 samples/s | 53.9 steps/s
[Step=9600 Epoch= 9.4] | Loss=0.02475 | Reg=0.00382 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.552 | L2-Norm(final)=2.392 | 3474.6 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step9600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=16.6] | Loss=0.28667 | Reg=0.00383 | FP-Reg=0.000 | acc=0.7656 | L2-Norm=19.567 | L2-Norm(final)=2.369 | 4001.7 samples/s | 62.5 steps/s
[Step=8850 Epoch=16.7] | Loss=0.01469 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.568 | L2-Norm(final)=2.365 | 3036.4 samples/s | 47.4 steps/s
[Step=8900 Epoch=16.8] | Loss=0.00784 | Reg=0.00383 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.562 | L2-Norm(final)=2.364 | 3261.8 samples/s | 51.0 steps/s
[Step=8950 Epoch=16.9] | Loss=0.00549 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.554 | L2-Norm(final)=2.366 | 2916.7 samples/s | 45.6 steps/s
[Step=9000 Epoch=17.0] | Loss=0.00414 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.547 | L2-Norm(final)=2.368 | 3098.3 samples/s | 48.4 steps/s
[Step=9050 Epoch=17.1] | Loss=0.00333 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.540 | L2-Norm(final)=2.369 | 3205.6 samples/s | 50.1 steps/s
[Step=9100 Epoch=17.2] | Loss=0.00280 | Reg=0.00382 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.534 | L2-Norm(final)=2.371 | 3244.3 samples/s | 50.7 steps/s
[Step=9150 Epoch=17.2] | Loss=0.00241 | Reg=0.00381 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.528 | L2-Norm(final)=2.372 | 3289.5 samples/s | 51.4 steps/s
[Step=9200 Epoch=17.3] | Loss=0.00212 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.523 | L2-Norm(final)=2.373 | 3284.5 samples/s | 51.3 steps/s
[Step=9250 Epoch=17.4] | Loss=0.00190 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.519 | L2-Norm(final)=2.374 | 3314.1 samples/s | 51.8 steps/s
[Step=9300 Epoch=17.5] | Loss=0.00172 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.515 | L2-Norm(final)=2.375 | 3348.1 samples/s | 52.3 steps/s
[Step=9350 Epoch=17.6] | Loss=0.00157 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.511 | L2-Norm(final)=2.376 | 1713.4 samples/s | 26.8 steps/s
[Step=9400 Epoch=17.7] | Loss=0.00144 | Reg=0.00381 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.507 | L2-Norm(final)=2.377 | 3324.7 samples/s | 51.9 steps/s
[Step=9450 Epoch=17.8] | Loss=0.00133 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.504 | L2-Norm(final)=2.378 | 3315.1 samples/s | 51.8 steps/s
[Step=9500 Epoch=17.9] | Loss=0.00124 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.501 | L2-Norm(final)=2.378 | 3307.7 samples/s | 51.7 steps/s
[Step=9550 Epoch=18.0] | Loss=0.00116 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.498 | L2-Norm(final)=2.379 | 3321.4 samples/s | 51.9 steps/s
[Step=9600 Epoch=18.1] | Loss=0.00109 | Reg=0.00380 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.495 | L2-Norm(final)=2.380 | 3309.3 samples/s | 51.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26422 | acc=0.8016 | tpr=0.7198 | fpr=0.0206 | 3685.8 samples/s | 14.4 steps/s
Avg test loss: 0.26475, Avg test acc: 0.79938, Avg tpr: 0.71802, Avg fpr: 0.02166, total FA: 169

Testing server on iccad2012
[Step=  50] | Loss=0.29311 | acc=0.8327 | tpr=0.9912 | fpr=0.1701 | 3745.8 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.29193 | acc=0.8351 | tpr=0.9872 | fpr=0.1677 | 6910.1 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.29577 | acc=0.8335 | tpr=0.9899 | fpr=0.1693 | 6806.4 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.29786 | acc=0.8327 | tpr=0.9923 | fpr=0.1702 | 6813.8 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.29844 | acc=0.8317 | tpr=0.9921 | fpr=0.1712 | 6688.9 samples/s | 26.1 steps/s
[Step= 300] | Loss=0.30000 | acc=0.8311 | tpr=0.9898 | fpr=0.1717 | 7041.3 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.30031 | acc=0.8311 | tpr=0.9894 | fpr=0.1718 | 6961.5 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.30133 | acc=0.8303 | tpr=0.9880 | fpr=0.1726 | 6748.3 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.30346 | acc=0.8297 | tpr=0.9873 | fpr=0.1732 | 6707.7 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.30322 | acc=0.8297 | tpr=0.9863 | fpr=0.1731 | 6712.5 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.30198 | acc=0.8301 | tpr=0.9853 | fpr=0.1727 | 12524.9 samples/s | 48.9 steps/s
Avg test loss: 0.30227, Avg test acc: 0.83018, Avg tpr: 0.98534, Avg fpr: 0.17264, total FA: 23971

server round 12/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch= 9.4] | Loss=0.11636 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.495 | L2-Norm(final)=2.387 | 4049.4 samples/s | 63.3 steps/s
[Step=9650 Epoch= 9.4] | Loss=0.03231 | Reg=0.00380 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.481 | L2-Norm(final)=2.386 | 3210.1 samples/s | 50.2 steps/s
[Step=9700 Epoch= 9.5] | Loss=0.02639 | Reg=0.00379 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.478 | L2-Norm(final)=2.392 | 3445.1 samples/s | 53.8 steps/s
[Step=9750 Epoch= 9.5] | Loss=0.02616 | Reg=0.00379 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.476 | L2-Norm(final)=2.395 | 3462.8 samples/s | 54.1 steps/s
[Step=9800 Epoch= 9.6] | Loss=0.02497 | Reg=0.00379 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.475 | L2-Norm(final)=2.399 | 3467.6 samples/s | 54.2 steps/s
[Step=9850 Epoch= 9.6] | Loss=0.02445 | Reg=0.00379 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.474 | L2-Norm(final)=2.401 | 3476.1 samples/s | 54.3 steps/s
[Step=9900 Epoch= 9.7] | Loss=0.02402 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.475 | L2-Norm(final)=2.403 | 3449.8 samples/s | 53.9 steps/s
[Step=9950 Epoch= 9.7] | Loss=0.02396 | Reg=0.00379 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.476 | L2-Norm(final)=2.406 | 3462.6 samples/s | 54.1 steps/s
[Step=10000 Epoch= 9.8] | Loss=0.02483 | Reg=0.00379 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=19.478 | L2-Norm(final)=2.407 | 3457.3 samples/s | 54.0 steps/s
[Step=10050 Epoch= 9.8] | Loss=0.02469 | Reg=0.00379 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.480 | L2-Norm(final)=2.408 | 3474.7 samples/s | 54.3 steps/s
[Step=10100 Epoch= 9.9] | Loss=0.02483 | Reg=0.00380 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.482 | L2-Norm(final)=2.409 | 3473.0 samples/s | 54.3 steps/s
[Step=10150 Epoch= 9.9] | Loss=0.02490 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.484 | L2-Norm(final)=2.410 | 3474.0 samples/s | 54.3 steps/s
[Step=10200 Epoch=10.0] | Loss=0.02455 | Reg=0.00380 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.486 | L2-Norm(final)=2.411 | 3474.5 samples/s | 54.3 steps/s
[Step=10250 Epoch=10.0] | Loss=0.02480 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.489 | L2-Norm(final)=2.412 | 3482.6 samples/s | 54.4 steps/s
[Step=10300 Epoch=10.1] | Loss=0.02454 | Reg=0.00380 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.491 | L2-Norm(final)=2.413 | 3477.0 samples/s | 54.3 steps/s
[Step=10350 Epoch=10.1] | Loss=0.02444 | Reg=0.00380 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.493 | L2-Norm(final)=2.414 | 3464.6 samples/s | 54.1 steps/s
[Step=10400 Epoch=10.2] | Loss=0.02443 | Reg=0.00380 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.495 | L2-Norm(final)=2.415 | 3473.1 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step10400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=18.1] | Loss=0.11528 | Reg=0.00380 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.495 | L2-Norm(final)=2.387 | 3930.7 samples/s | 61.4 steps/s
[Step=9650 Epoch=18.2] | Loss=0.00988 | Reg=0.00379 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.463 | L2-Norm(final)=2.386 | 3082.2 samples/s | 48.2 steps/s
[Step=9700 Epoch=18.3] | Loss=0.00619 | Reg=0.00379 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.463 | L2-Norm(final)=2.386 | 3313.5 samples/s | 51.8 steps/s
[Step=9750 Epoch=18.4] | Loss=0.00425 | Reg=0.00379 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.460 | L2-Norm(final)=2.387 | 3314.3 samples/s | 51.8 steps/s
[Step=9800 Epoch=18.5] | Loss=0.00327 | Reg=0.00379 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.456 | L2-Norm(final)=2.389 | 3306.0 samples/s | 51.7 steps/s
[Step=9850 Epoch=18.6] | Loss=0.00265 | Reg=0.00378 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.452 | L2-Norm(final)=2.391 | 3323.3 samples/s | 51.9 steps/s
[Step=9900 Epoch=18.7] | Loss=0.00223 | Reg=0.00378 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.448 | L2-Norm(final)=2.393 | 3293.7 samples/s | 51.5 steps/s
[Step=9950 Epoch=18.8] | Loss=0.00198 | Reg=0.00378 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.444 | L2-Norm(final)=2.394 | 3299.6 samples/s | 51.6 steps/s
[Step=10000 Epoch=18.9] | Loss=0.00175 | Reg=0.00378 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.442 | L2-Norm(final)=2.396 | 3302.3 samples/s | 51.6 steps/s
[Step=10050 Epoch=18.9] | Loss=0.00157 | Reg=0.00378 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.439 | L2-Norm(final)=2.397 | 3309.1 samples/s | 51.7 steps/s
[Step=10100 Epoch=19.0] | Loss=0.00142 | Reg=0.00378 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.436 | L2-Norm(final)=2.399 | 3335.3 samples/s | 52.1 steps/s
[Step=10150 Epoch=19.1] | Loss=0.00129 | Reg=0.00378 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.433 | L2-Norm(final)=2.400 | 1710.1 samples/s | 26.7 steps/s
[Step=10200 Epoch=19.2] | Loss=0.00119 | Reg=0.00378 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.430 | L2-Norm(final)=2.401 | 3331.5 samples/s | 52.1 steps/s
[Step=10250 Epoch=19.3] | Loss=0.00110 | Reg=0.00377 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.427 | L2-Norm(final)=2.402 | 3302.7 samples/s | 51.6 steps/s
[Step=10300 Epoch=19.4] | Loss=0.00102 | Reg=0.00377 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.425 | L2-Norm(final)=2.402 | 3307.0 samples/s | 51.7 steps/s
[Step=10350 Epoch=19.5] | Loss=0.00096 | Reg=0.00377 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.422 | L2-Norm(final)=2.403 | 3301.7 samples/s | 51.6 steps/s
[Step=10400 Epoch=19.6] | Loss=0.00090 | Reg=0.00377 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.420 | L2-Norm(final)=2.404 | 3320.5 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19694 | acc=0.8570 | tpr=0.8007 | fpr=0.0208 | 3719.9 samples/s | 14.5 steps/s
Avg test loss: 0.19801, Avg test acc: 0.85359, Avg tpr: 0.79816, Avg fpr: 0.02448, total FA: 191

Testing server on iccad2012
[Step=  50] | Loss=0.42960 | acc=0.7691 | tpr=0.9956 | fpr=0.2349 | 3760.9 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.42905 | acc=0.7727 | tpr=0.9915 | fpr=0.2313 | 6694.1 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.43248 | acc=0.7716 | tpr=0.9942 | fpr=0.2325 | 6911.3 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.43502 | acc=0.7711 | tpr=0.9945 | fpr=0.2330 | 6639.6 samples/s | 25.9 steps/s
[Step= 250] | Loss=0.43519 | acc=0.7704 | tpr=0.9939 | fpr=0.2336 | 6834.3 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.43674 | acc=0.7707 | tpr=0.9913 | fpr=0.2333 | 7028.3 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.43703 | acc=0.7706 | tpr=0.9900 | fpr=0.2334 | 6703.5 samples/s | 26.2 steps/s
[Step= 400] | Loss=0.43815 | acc=0.7698 | tpr=0.9885 | fpr=0.2341 | 6889.3 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.44054 | acc=0.7696 | tpr=0.9883 | fpr=0.2344 | 6617.1 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.44029 | acc=0.7693 | tpr=0.9877 | fpr=0.2346 | 6786.4 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.43909 | acc=0.7697 | tpr=0.9873 | fpr=0.2342 | 12939.3 samples/s | 50.5 steps/s
Avg test loss: 0.43945, Avg test acc: 0.76973, Avg tpr: 0.98732, Avg fpr: 0.23423, total FA: 32522

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=10.2] | Loss=0.07545 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.435 | L2-Norm(final)=2.418 | 4141.7 samples/s | 64.7 steps/s
[Step=10450 Epoch=10.2] | Loss=0.02453 | Reg=0.00377 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.417 | L2-Norm(final)=2.417 | 3246.2 samples/s | 50.7 steps/s
[Step=10500 Epoch=10.3] | Loss=0.02178 | Reg=0.00377 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.412 | L2-Norm(final)=2.423 | 3461.4 samples/s | 54.1 steps/s
[Step=10550 Epoch=10.3] | Loss=0.02145 | Reg=0.00377 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.409 | L2-Norm(final)=2.426 | 3459.3 samples/s | 54.1 steps/s
[Step=10600 Epoch=10.3] | Loss=0.02137 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.408 | L2-Norm(final)=2.427 | 3449.8 samples/s | 53.9 steps/s
[Step=10650 Epoch=10.4] | Loss=0.02144 | Reg=0.00377 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.409 | L2-Norm(final)=2.430 | 3455.4 samples/s | 54.0 steps/s
[Step=10700 Epoch=10.4] | Loss=0.02145 | Reg=0.00377 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.410 | L2-Norm(final)=2.432 | 3458.6 samples/s | 54.0 steps/s
[Step=10750 Epoch=10.5] | Loss=0.02163 | Reg=0.00377 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.412 | L2-Norm(final)=2.434 | 3463.0 samples/s | 54.1 steps/s
[Step=10800 Epoch=10.5] | Loss=0.02214 | Reg=0.00377 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.414 | L2-Norm(final)=2.436 | 3467.1 samples/s | 54.2 steps/s
[Step=10850 Epoch=10.6] | Loss=0.02244 | Reg=0.00377 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.416 | L2-Norm(final)=2.437 | 3460.1 samples/s | 54.1 steps/s
[Step=10900 Epoch=10.6] | Loss=0.02236 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.418 | L2-Norm(final)=2.438 | 3462.7 samples/s | 54.1 steps/s
[Step=10950 Epoch=10.7] | Loss=0.02254 | Reg=0.00377 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.420 | L2-Norm(final)=2.439 | 3442.7 samples/s | 53.8 steps/s
[Step=11000 Epoch=10.7] | Loss=0.02240 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.423 | L2-Norm(final)=2.440 | 3472.9 samples/s | 54.3 steps/s
[Step=11050 Epoch=10.8] | Loss=0.02294 | Reg=0.00377 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.425 | L2-Norm(final)=2.441 | 3448.0 samples/s | 53.9 steps/s
[Step=11100 Epoch=10.8] | Loss=0.02292 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.427 | L2-Norm(final)=2.441 | 3464.2 samples/s | 54.1 steps/s
[Step=11150 Epoch=10.9] | Loss=0.02265 | Reg=0.00377 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.429 | L2-Norm(final)=2.441 | 3393.7 samples/s | 53.0 steps/s
[Step=11200 Epoch=10.9] | Loss=0.02273 | Reg=0.00378 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.431 | L2-Norm(final)=2.442 | 3484.5 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step11200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=19.6] | Loss=0.10981 | Reg=0.00378 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.435 | L2-Norm(final)=2.418 | 3751.6 samples/s | 58.6 steps/s
[Step=10450 Epoch=19.7] | Loss=0.01555 | Reg=0.00378 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.435 | L2-Norm(final)=2.410 | 3170.4 samples/s | 49.5 steps/s
[Step=10500 Epoch=19.8] | Loss=0.00870 | Reg=0.00378 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.435 | L2-Norm(final)=2.410 | 3251.2 samples/s | 50.8 steps/s
[Step=10550 Epoch=19.9] | Loss=0.00613 | Reg=0.00378 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.430 | L2-Norm(final)=2.413 | 2919.9 samples/s | 45.6 steps/s
[Step=10600 Epoch=20.0] | Loss=0.00512 | Reg=0.00377 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.426 | L2-Norm(final)=2.414 | 2894.8 samples/s | 45.2 steps/s
[Step=10650 Epoch=20.1] | Loss=0.00413 | Reg=0.00377 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.421 | L2-Norm(final)=2.415 | 3135.1 samples/s | 49.0 steps/s
[Step=10700 Epoch=20.2] | Loss=0.00347 | Reg=0.00377 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.416 | L2-Norm(final)=2.416 | 3203.1 samples/s | 50.0 steps/s
[Step=10750 Epoch=20.3] | Loss=0.00299 | Reg=0.00377 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.412 | L2-Norm(final)=2.417 | 3267.1 samples/s | 51.0 steps/s
[Step=10800 Epoch=20.4] | Loss=0.00263 | Reg=0.00377 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.407 | L2-Norm(final)=2.419 | 3303.5 samples/s | 51.6 steps/s
[Step=10850 Epoch=20.5] | Loss=0.00236 | Reg=0.00376 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.403 | L2-Norm(final)=2.420 | 3287.8 samples/s | 51.4 steps/s
[Step=10900 Epoch=20.5] | Loss=0.00213 | Reg=0.00376 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.399 | L2-Norm(final)=2.421 | 3047.2 samples/s | 47.6 steps/s
[Step=10950 Epoch=20.6] | Loss=0.00194 | Reg=0.00376 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.395 | L2-Norm(final)=2.422 | 1603.1 samples/s | 25.0 steps/s
[Step=11000 Epoch=20.7] | Loss=0.00178 | Reg=0.00376 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.392 | L2-Norm(final)=2.423 | 3261.4 samples/s | 51.0 steps/s
[Step=11050 Epoch=20.8] | Loss=0.00164 | Reg=0.00376 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.388 | L2-Norm(final)=2.424 | 3232.0 samples/s | 50.5 steps/s
[Step=11100 Epoch=20.9] | Loss=0.00153 | Reg=0.00376 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.385 | L2-Norm(final)=2.425 | 3276.0 samples/s | 51.2 steps/s
[Step=11150 Epoch=21.0] | Loss=0.00143 | Reg=0.00376 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.382 | L2-Norm(final)=2.426 | 3020.8 samples/s | 47.2 steps/s
[Step=11200 Epoch=21.1] | Loss=0.00134 | Reg=0.00376 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.379 | L2-Norm(final)=2.426 | 2953.3 samples/s | 46.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22668 | acc=0.8355 | tpr=0.7688 | fpr=0.0198 | 3701.6 samples/s | 14.5 steps/s
Avg test loss: 0.22757, Avg test acc: 0.83300, Avg tpr: 0.76663, Avg fpr: 0.02102, total FA: 164

Testing server on iccad2012
[Step=  50] | Loss=0.37882 | acc=0.7973 | tpr=0.9956 | fpr=0.2063 | 3727.8 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.38026 | acc=0.7997 | tpr=0.9872 | fpr=0.2038 | 6894.1 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.38447 | acc=0.7999 | tpr=0.9885 | fpr=0.2036 | 6743.0 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.38679 | acc=0.7999 | tpr=0.9902 | fpr=0.2035 | 6665.6 samples/s | 26.0 steps/s
[Step= 250] | Loss=0.38729 | acc=0.7992 | tpr=0.9904 | fpr=0.2043 | 6952.5 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.38815 | acc=0.7990 | tpr=0.9876 | fpr=0.2044 | 6895.7 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.38865 | acc=0.7993 | tpr=0.9862 | fpr=0.2041 | 6891.4 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.39017 | acc=0.7986 | tpr=0.9858 | fpr=0.2048 | 6669.1 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.39277 | acc=0.7982 | tpr=0.9859 | fpr=0.2052 | 6805.6 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.39226 | acc=0.7981 | tpr=0.9855 | fpr=0.2053 | 6804.0 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.39124 | acc=0.7984 | tpr=0.9849 | fpr=0.2049 | 12748.9 samples/s | 49.8 steps/s
Avg test loss: 0.39141, Avg test acc: 0.79850, Avg tpr: 0.98494, Avg fpr: 0.20489, total FA: 28449

server round 14/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=10.9] | Loss=0.17074 | Reg=0.00376 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.379 | L2-Norm(final)=2.440 | 3890.0 samples/s | 60.8 steps/s
[Step=11250 Epoch=11.0] | Loss=0.03014 | Reg=0.00375 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.367 | L2-Norm(final)=2.437 | 3182.3 samples/s | 49.7 steps/s
[Step=11300 Epoch=11.0] | Loss=0.02609 | Reg=0.00375 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.364 | L2-Norm(final)=2.442 | 3466.5 samples/s | 54.2 steps/s
[Step=11350 Epoch=11.1] | Loss=0.02523 | Reg=0.00375 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.361 | L2-Norm(final)=2.444 | 3463.0 samples/s | 54.1 steps/s
[Step=11400 Epoch=11.1] | Loss=0.02341 | Reg=0.00375 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.361 | L2-Norm(final)=2.447 | 3473.7 samples/s | 54.3 steps/s
[Step=11450 Epoch=11.2] | Loss=0.02324 | Reg=0.00375 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.361 | L2-Norm(final)=2.450 | 3462.1 samples/s | 54.1 steps/s
[Step=11500 Epoch=11.2] | Loss=0.02262 | Reg=0.00375 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.362 | L2-Norm(final)=2.452 | 3480.3 samples/s | 54.4 steps/s
[Step=11550 Epoch=11.3] | Loss=0.02296 | Reg=0.00375 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.363 | L2-Norm(final)=2.453 | 3458.4 samples/s | 54.0 steps/s
[Step=11600 Epoch=11.3] | Loss=0.02304 | Reg=0.00375 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.364 | L2-Norm(final)=2.455 | 3496.5 samples/s | 54.6 steps/s
[Step=11650 Epoch=11.4] | Loss=0.02328 | Reg=0.00375 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.366 | L2-Norm(final)=2.456 | 3506.3 samples/s | 54.8 steps/s
[Step=11700 Epoch=11.4] | Loss=0.02300 | Reg=0.00375 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.368 | L2-Norm(final)=2.456 | 3510.7 samples/s | 54.9 steps/s
[Step=11750 Epoch=11.5] | Loss=0.02301 | Reg=0.00375 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.370 | L2-Norm(final)=2.457 | 3496.6 samples/s | 54.6 steps/s
[Step=11800 Epoch=11.5] | Loss=0.02308 | Reg=0.00375 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.373 | L2-Norm(final)=2.458 | 3497.8 samples/s | 54.7 steps/s
[Step=11850 Epoch=11.6] | Loss=0.02323 | Reg=0.00375 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.375 | L2-Norm(final)=2.459 | 3479.8 samples/s | 54.4 steps/s
[Step=11900 Epoch=11.6] | Loss=0.02319 | Reg=0.00375 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.377 | L2-Norm(final)=2.460 | 3476.8 samples/s | 54.3 steps/s
[Step=11950 Epoch=11.7] | Loss=0.02329 | Reg=0.00376 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.380 | L2-Norm(final)=2.461 | 3479.6 samples/s | 54.4 steps/s
[Step=12000 Epoch=11.7] | Loss=0.02323 | Reg=0.00376 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.382 | L2-Norm(final)=2.462 | 3484.2 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step12000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=21.1] | Loss=0.02634 | Reg=0.00376 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.379 | L2-Norm(final)=2.442 | 3574.2 samples/s | 55.8 steps/s
[Step=11250 Epoch=21.2] | Loss=0.00255 | Reg=0.00374 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.332 | L2-Norm(final)=2.449 | 3215.1 samples/s | 50.2 steps/s
[Step=11300 Epoch=21.3] | Loss=0.00151 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.321 | L2-Norm(final)=2.451 | 3308.4 samples/s | 51.7 steps/s
[Step=11350 Epoch=21.4] | Loss=0.00116 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.314 | L2-Norm(final)=2.454 | 3321.0 samples/s | 51.9 steps/s
[Step=11400 Epoch=21.5] | Loss=0.00099 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.311 | L2-Norm(final)=2.456 | 3334.5 samples/s | 52.1 steps/s
[Step=11450 Epoch=21.6] | Loss=0.00101 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.308 | L2-Norm(final)=2.458 | 3325.3 samples/s | 52.0 steps/s
[Step=11500 Epoch=21.7] | Loss=0.00100 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.307 | L2-Norm(final)=2.459 | 3326.0 samples/s | 52.0 steps/s
[Step=11550 Epoch=21.8] | Loss=0.00105 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.307 | L2-Norm(final)=2.460 | 3335.1 samples/s | 52.1 steps/s
[Step=11600 Epoch=21.9] | Loss=0.00093 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.306 | L2-Norm(final)=2.461 | 3322.4 samples/s | 51.9 steps/s
[Step=11650 Epoch=22.0] | Loss=0.00084 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.305 | L2-Norm(final)=2.462 | 3286.8 samples/s | 51.4 steps/s
[Step=11700 Epoch=22.1] | Loss=0.00077 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.304 | L2-Norm(final)=2.463 | 3351.7 samples/s | 52.4 steps/s
[Step=11750 Epoch=22.1] | Loss=0.00072 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.302 | L2-Norm(final)=2.464 | 1708.6 samples/s | 26.7 steps/s
[Step=11800 Epoch=22.2] | Loss=0.00066 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.301 | L2-Norm(final)=2.465 | 3326.1 samples/s | 52.0 steps/s
[Step=11850 Epoch=22.3] | Loss=0.00061 | Reg=0.00372 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.299 | L2-Norm(final)=2.465 | 3312.3 samples/s | 51.8 steps/s
[Step=11900 Epoch=22.4] | Loss=0.00057 | Reg=0.00372 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.298 | L2-Norm(final)=2.466 | 3315.4 samples/s | 51.8 steps/s
[Step=11950 Epoch=22.5] | Loss=0.00054 | Reg=0.00372 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.296 | L2-Norm(final)=2.467 | 3328.0 samples/s | 52.0 steps/s
[Step=12000 Epoch=22.6] | Loss=0.00050 | Reg=0.00372 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.294 | L2-Norm(final)=2.467 | 3292.4 samples/s | 51.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24072 | acc=0.8287 | tpr=0.7558 | fpr=0.0129 | 3725.5 samples/s | 14.6 steps/s
Avg test loss: 0.24246, Avg test acc: 0.82783, Avg tpr: 0.75555, Avg fpr: 0.01320, total FA: 103

Testing server on iccad2012
[Step=  50] | Loss=0.42711 | acc=0.7801 | tpr=0.9912 | fpr=0.2237 | 3737.9 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.42718 | acc=0.7805 | tpr=0.9808 | fpr=0.2233 | 6852.6 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.43165 | acc=0.7791 | tpr=0.9841 | fpr=0.2247 | 6696.4 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.43383 | acc=0.7784 | tpr=0.9880 | fpr=0.2254 | 6819.4 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.43392 | acc=0.7775 | tpr=0.9869 | fpr=0.2263 | 6788.1 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.43559 | acc=0.7776 | tpr=0.9840 | fpr=0.2262 | 6616.2 samples/s | 25.8 steps/s
[Step= 350] | Loss=0.43574 | acc=0.7775 | tpr=0.9825 | fpr=0.2262 | 6837.3 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.43735 | acc=0.7769 | tpr=0.9819 | fpr=0.2268 | 6627.2 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.43975 | acc=0.7765 | tpr=0.9830 | fpr=0.2272 | 6112.7 samples/s | 23.9 steps/s
[Step= 500] | Loss=0.43920 | acc=0.7764 | tpr=0.9824 | fpr=0.2273 | 6575.1 samples/s | 25.7 steps/s
[Step= 550] | Loss=0.43820 | acc=0.7767 | tpr=0.9821 | fpr=0.2270 | 12477.9 samples/s | 48.7 steps/s
Avg test loss: 0.43819, Avg test acc: 0.77679, Avg tpr: 0.98217, Avg fpr: 0.22694, total FA: 31510

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=11.7] | Loss=0.12987 | Reg=0.00373 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.324 | L2-Norm(final)=2.474 | 3710.4 samples/s | 58.0 steps/s
[Step=12050 Epoch=11.8] | Loss=0.02809 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.316 | L2-Norm(final)=2.470 | 3430.6 samples/s | 53.6 steps/s
[Step=12100 Epoch=11.8] | Loss=0.02299 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.312 | L2-Norm(final)=2.472 | 3461.2 samples/s | 54.1 steps/s
[Step=12150 Epoch=11.9] | Loss=0.02217 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.310 | L2-Norm(final)=2.476 | 3487.3 samples/s | 54.5 steps/s
[Step=12200 Epoch=11.9] | Loss=0.02126 | Reg=0.00373 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.310 | L2-Norm(final)=2.479 | 3477.9 samples/s | 54.3 steps/s
[Step=12250 Epoch=12.0] | Loss=0.02131 | Reg=0.00373 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.310 | L2-Norm(final)=2.481 | 3496.0 samples/s | 54.6 steps/s
[Step=12300 Epoch=12.0] | Loss=0.02194 | Reg=0.00373 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.310 | L2-Norm(final)=2.481 | 3502.5 samples/s | 54.7 steps/s
[Step=12350 Epoch=12.1] | Loss=0.02207 | Reg=0.00373 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.310 | L2-Norm(final)=2.481 | 3506.9 samples/s | 54.8 steps/s
[Step=12400 Epoch=12.1] | Loss=0.02209 | Reg=0.00373 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.311 | L2-Norm(final)=2.482 | 3496.1 samples/s | 54.6 steps/s
[Step=12450 Epoch=12.2] | Loss=0.02180 | Reg=0.00373 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.313 | L2-Norm(final)=2.483 | 3495.0 samples/s | 54.6 steps/s
[Step=12500 Epoch=12.2] | Loss=0.02139 | Reg=0.00373 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.314 | L2-Norm(final)=2.484 | 3487.8 samples/s | 54.5 steps/s
[Step=12550 Epoch=12.3] | Loss=0.02138 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.316 | L2-Norm(final)=2.485 | 3503.5 samples/s | 54.7 steps/s
[Step=12600 Epoch=12.3] | Loss=0.02122 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.318 | L2-Norm(final)=2.486 | 3501.1 samples/s | 54.7 steps/s
[Step=12650 Epoch=12.4] | Loss=0.02068 | Reg=0.00373 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.320 | L2-Norm(final)=2.488 | 3471.1 samples/s | 54.2 steps/s
[Step=12700 Epoch=12.4] | Loss=0.02105 | Reg=0.00373 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.322 | L2-Norm(final)=2.489 | 3482.9 samples/s | 54.4 steps/s
[Step=12750 Epoch=12.4] | Loss=0.02108 | Reg=0.00373 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.324 | L2-Norm(final)=2.490 | 3494.8 samples/s | 54.6 steps/s
[Step=12800 Epoch=12.5] | Loss=0.02130 | Reg=0.00373 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.326 | L2-Norm(final)=2.491 | 3488.1 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step12800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=22.6] | Loss=0.29267 | Reg=0.00373 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.324 | L2-Norm(final)=2.472 | 3599.9 samples/s | 56.2 steps/s
[Step=12050 Epoch=22.7] | Loss=0.01164 | Reg=0.00372 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.300 | L2-Norm(final)=2.463 | 3296.0 samples/s | 51.5 steps/s
[Step=12100 Epoch=22.8] | Loss=0.00676 | Reg=0.00372 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.300 | L2-Norm(final)=2.465 | 3280.7 samples/s | 51.3 steps/s
[Step=12150 Epoch=22.9] | Loss=0.00488 | Reg=0.00372 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.300 | L2-Norm(final)=2.467 | 3251.9 samples/s | 50.8 steps/s
[Step=12200 Epoch=23.0] | Loss=0.00370 | Reg=0.00372 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.297 | L2-Norm(final)=2.470 | 3308.9 samples/s | 51.7 steps/s
[Step=12250 Epoch=23.1] | Loss=0.00299 | Reg=0.00372 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.294 | L2-Norm(final)=2.473 | 3316.3 samples/s | 51.8 steps/s
[Step=12300 Epoch=23.2] | Loss=0.00254 | Reg=0.00372 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.290 | L2-Norm(final)=2.475 | 3306.0 samples/s | 51.7 steps/s
[Step=12350 Epoch=23.3] | Loss=0.00224 | Reg=0.00372 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.286 | L2-Norm(final)=2.477 | 3318.5 samples/s | 51.9 steps/s
[Step=12400 Epoch=23.4] | Loss=0.00197 | Reg=0.00372 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.283 | L2-Norm(final)=2.479 | 3296.3 samples/s | 51.5 steps/s
[Step=12450 Epoch=23.5] | Loss=0.00177 | Reg=0.00372 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.280 | L2-Norm(final)=2.480 | 3289.6 samples/s | 51.4 steps/s
[Step=12500 Epoch=23.6] | Loss=0.00159 | Reg=0.00372 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.276 | L2-Norm(final)=2.482 | 3320.8 samples/s | 51.9 steps/s
[Step=12550 Epoch=23.7] | Loss=0.00145 | Reg=0.00371 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.273 | L2-Norm(final)=2.483 | 1733.3 samples/s | 27.1 steps/s
[Step=12600 Epoch=23.8] | Loss=0.00133 | Reg=0.00371 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.270 | L2-Norm(final)=2.484 | 3333.1 samples/s | 52.1 steps/s
[Step=12650 Epoch=23.8] | Loss=0.00123 | Reg=0.00371 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.267 | L2-Norm(final)=2.485 | 3295.1 samples/s | 51.5 steps/s
[Step=12700 Epoch=23.9] | Loss=0.00115 | Reg=0.00371 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.264 | L2-Norm(final)=2.485 | 3306.6 samples/s | 51.7 steps/s
[Step=12750 Epoch=24.0] | Loss=0.00108 | Reg=0.00371 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.486 | 3324.9 samples/s | 52.0 steps/s
[Step=12800 Epoch=24.1] | Loss=0.00101 | Reg=0.00371 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.258 | L2-Norm(final)=2.487 | 3284.7 samples/s | 51.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20994 | acc=0.8527 | tpr=0.7959 | fpr=0.0240 | 3717.9 samples/s | 14.5 steps/s
Avg test loss: 0.20928, Avg test acc: 0.85059, Avg tpr: 0.79466, Avg fpr: 0.02641, total FA: 206

Testing server on iccad2012
[Step=  50] | Loss=0.43369 | acc=0.7791 | tpr=0.9956 | fpr=0.2248 | 3735.5 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.43360 | acc=0.7804 | tpr=0.9936 | fpr=0.2235 | 6783.8 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.43880 | acc=0.7795 | tpr=0.9928 | fpr=0.2245 | 6739.5 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.44193 | acc=0.7792 | tpr=0.9945 | fpr=0.2248 | 6870.5 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.44249 | acc=0.7781 | tpr=0.9913 | fpr=0.2258 | 6775.3 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.44437 | acc=0.7785 | tpr=0.9884 | fpr=0.2253 | 6841.4 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.44453 | acc=0.7785 | tpr=0.9881 | fpr=0.2253 | 6812.0 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.44561 | acc=0.7779 | tpr=0.9880 | fpr=0.2259 | 6843.4 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.44854 | acc=0.7775 | tpr=0.9883 | fpr=0.2263 | 6848.5 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.44800 | acc=0.7773 | tpr=0.9877 | fpr=0.2265 | 6600.9 samples/s | 25.8 steps/s
[Step= 550] | Loss=0.44684 | acc=0.7776 | tpr=0.9865 | fpr=0.2262 | 12777.8 samples/s | 49.9 steps/s
Avg test loss: 0.44682, Avg test acc: 0.77762, Avg tpr: 0.98653, Avg fpr: 0.22618, total FA: 31404

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=12.5] | Loss=0.21175 | Reg=0.00371 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.267 | L2-Norm(final)=2.496 | 3943.5 samples/s | 61.6 steps/s
[Step=12850 Epoch=12.5] | Loss=0.02452 | Reg=0.00371 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.250 | L2-Norm(final)=2.497 | 3289.7 samples/s | 51.4 steps/s
[Step=12900 Epoch=12.6] | Loss=0.02245 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.247 | L2-Norm(final)=2.501 | 3464.2 samples/s | 54.1 steps/s
[Step=12950 Epoch=12.6] | Loss=0.02220 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.246 | L2-Norm(final)=2.502 | 3460.5 samples/s | 54.1 steps/s
[Step=13000 Epoch=12.7] | Loss=0.02250 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.246 | L2-Norm(final)=2.503 | 3464.9 samples/s | 54.1 steps/s
[Step=13050 Epoch=12.7] | Loss=0.02238 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.246 | L2-Norm(final)=2.504 | 3471.6 samples/s | 54.2 steps/s
[Step=13100 Epoch=12.8] | Loss=0.02196 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.247 | L2-Norm(final)=2.505 | 3470.0 samples/s | 54.2 steps/s
[Step=13150 Epoch=12.8] | Loss=0.02152 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.248 | L2-Norm(final)=2.506 | 3461.6 samples/s | 54.1 steps/s
[Step=13200 Epoch=12.9] | Loss=0.02099 | Reg=0.00371 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.249 | L2-Norm(final)=2.507 | 3475.4 samples/s | 54.3 steps/s
[Step=13250 Epoch=12.9] | Loss=0.02120 | Reg=0.00371 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.251 | L2-Norm(final)=2.508 | 3448.0 samples/s | 53.9 steps/s
[Step=13300 Epoch=13.0] | Loss=0.02110 | Reg=0.00371 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.253 | L2-Norm(final)=2.509 | 3474.9 samples/s | 54.3 steps/s
[Step=13350 Epoch=13.0] | Loss=0.02117 | Reg=0.00371 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.256 | L2-Norm(final)=2.510 | 3471.6 samples/s | 54.2 steps/s
[Step=13400 Epoch=13.1] | Loss=0.02091 | Reg=0.00371 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.258 | L2-Norm(final)=2.511 | 3471.6 samples/s | 54.2 steps/s
[Step=13450 Epoch=13.1] | Loss=0.02091 | Reg=0.00371 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.260 | L2-Norm(final)=2.513 | 3488.9 samples/s | 54.5 steps/s
[Step=13500 Epoch=13.2] | Loss=0.02092 | Reg=0.00371 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.262 | L2-Norm(final)=2.514 | 3479.4 samples/s | 54.4 steps/s
[Step=13550 Epoch=13.2] | Loss=0.02066 | Reg=0.00371 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.264 | L2-Norm(final)=2.515 | 3451.1 samples/s | 53.9 steps/s
[Step=13600 Epoch=13.3] | Loss=0.02084 | Reg=0.00371 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.266 | L2-Norm(final)=2.516 | 3478.1 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step13600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=24.1] | Loss=0.17202 | Reg=0.00371 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.267 | L2-Norm(final)=2.497 | 3888.6 samples/s | 60.8 steps/s
[Step=12850 Epoch=24.2] | Loss=0.01386 | Reg=0.00371 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.259 | L2-Norm(final)=2.488 | 2976.2 samples/s | 46.5 steps/s
[Step=12900 Epoch=24.3] | Loss=0.01142 | Reg=0.00371 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.265 | L2-Norm(final)=2.480 | 3282.7 samples/s | 51.3 steps/s
[Step=12950 Epoch=24.4] | Loss=0.00841 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.268 | L2-Norm(final)=2.474 | 3257.4 samples/s | 50.9 steps/s
[Step=13000 Epoch=24.5] | Loss=0.00641 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.267 | L2-Norm(final)=2.473 | 3279.1 samples/s | 51.2 steps/s
[Step=13050 Epoch=24.6] | Loss=0.00518 | Reg=0.00371 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.264 | L2-Norm(final)=2.473 | 3288.5 samples/s | 51.4 steps/s
[Step=13100 Epoch=24.7] | Loss=0.00435 | Reg=0.00371 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.474 | 3295.9 samples/s | 51.5 steps/s
[Step=13150 Epoch=24.8] | Loss=0.00374 | Reg=0.00371 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.257 | L2-Norm(final)=2.475 | 3249.7 samples/s | 50.8 steps/s
[Step=13200 Epoch=24.9] | Loss=0.00329 | Reg=0.00371 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.253 | L2-Norm(final)=2.477 | 2977.0 samples/s | 46.5 steps/s
[Step=13250 Epoch=25.0] | Loss=0.00293 | Reg=0.00371 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.249 | L2-Norm(final)=2.478 | 2903.8 samples/s | 45.4 steps/s
[Step=13300 Epoch=25.1] | Loss=0.00264 | Reg=0.00370 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.246 | L2-Norm(final)=2.479 | 3165.1 samples/s | 49.5 steps/s
[Step=13350 Epoch=25.2] | Loss=0.00241 | Reg=0.00370 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.242 | L2-Norm(final)=2.480 | 1674.7 samples/s | 26.2 steps/s
[Step=13400 Epoch=25.3] | Loss=0.00221 | Reg=0.00370 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.239 | L2-Norm(final)=2.482 | 3319.0 samples/s | 51.9 steps/s
[Step=13450 Epoch=25.4] | Loss=0.00204 | Reg=0.00370 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=2.483 | 3323.0 samples/s | 51.9 steps/s
[Step=13500 Epoch=25.4] | Loss=0.00190 | Reg=0.00370 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.232 | L2-Norm(final)=2.484 | 3332.2 samples/s | 52.1 steps/s
[Step=13550 Epoch=25.5] | Loss=0.00178 | Reg=0.00370 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.485 | 3326.2 samples/s | 52.0 steps/s
[Step=13600 Epoch=25.6] | Loss=0.00167 | Reg=0.00370 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.226 | L2-Norm(final)=2.486 | 3342.1 samples/s | 52.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22705 | acc=0.8371 | tpr=0.7738 | fpr=0.0255 | 3785.4 samples/s | 14.8 steps/s
Avg test loss: 0.22770, Avg test acc: 0.83488, Avg tpr: 0.77181, Avg fpr: 0.02641, total FA: 206

Testing server on iccad2012
[Step=  50] | Loss=0.38230 | acc=0.8108 | tpr=1.0000 | fpr=0.1926 | 3758.5 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.38329 | acc=0.8110 | tpr=0.9915 | fpr=0.1924 | 6814.0 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.38815 | acc=0.8104 | tpr=0.9928 | fpr=0.1930 | 7105.7 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.39141 | acc=0.8095 | tpr=0.9945 | fpr=0.1939 | 6552.0 samples/s | 25.6 steps/s
[Step= 250] | Loss=0.39294 | acc=0.8082 | tpr=0.9921 | fpr=0.1951 | 7158.7 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.39498 | acc=0.8079 | tpr=0.9876 | fpr=0.1954 | 6726.2 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.39514 | acc=0.8080 | tpr=0.9875 | fpr=0.1953 | 7004.6 samples/s | 27.4 steps/s
[Step= 400] | Loss=0.39584 | acc=0.8074 | tpr=0.9874 | fpr=0.1959 | 6840.8 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.39902 | acc=0.8067 | tpr=0.9873 | fpr=0.1966 | 6794.2 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.39900 | acc=0.8062 | tpr=0.9868 | fpr=0.1971 | 6800.5 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.39773 | acc=0.8064 | tpr=0.9861 | fpr=0.1968 | 12871.8 samples/s | 50.3 steps/s
Avg test loss: 0.39785, Avg test acc: 0.80643, Avg tpr: 0.98613, Avg fpr: 0.19684, total FA: 27331

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=13.3] | Loss=0.19754 | Reg=0.00369 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.215 | L2-Norm(final)=2.511 | 4239.7 samples/s | 66.2 steps/s
[Step=13650 Epoch=13.3] | Loss=0.02987 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.205 | L2-Norm(final)=2.504 | 3135.9 samples/s | 49.0 steps/s
[Step=13700 Epoch=13.4] | Loss=0.02428 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.201 | L2-Norm(final)=2.509 | 3490.6 samples/s | 54.5 steps/s
[Step=13750 Epoch=13.4] | Loss=0.02230 | Reg=0.00369 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.200 | L2-Norm(final)=2.514 | 3501.1 samples/s | 54.7 steps/s
[Step=13800 Epoch=13.5] | Loss=0.02291 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.200 | L2-Norm(final)=2.516 | 3502.1 samples/s | 54.7 steps/s
[Step=13850 Epoch=13.5] | Loss=0.02185 | Reg=0.00369 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.201 | L2-Norm(final)=2.518 | 3500.7 samples/s | 54.7 steps/s
[Step=13900 Epoch=13.6] | Loss=0.02224 | Reg=0.00369 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.202 | L2-Norm(final)=2.520 | 3518.6 samples/s | 55.0 steps/s
[Step=13950 Epoch=13.6] | Loss=0.02161 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.204 | L2-Norm(final)=2.521 | 3516.1 samples/s | 54.9 steps/s
[Step=14000 Epoch=13.7] | Loss=0.02131 | Reg=0.00369 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.205 | L2-Norm(final)=2.522 | 3514.6 samples/s | 54.9 steps/s
[Step=14050 Epoch=13.7] | Loss=0.02159 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.207 | L2-Norm(final)=2.523 | 3518.7 samples/s | 55.0 steps/s
[Step=14100 Epoch=13.8] | Loss=0.02153 | Reg=0.00369 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.209 | L2-Norm(final)=2.524 | 3521.2 samples/s | 55.0 steps/s
[Step=14150 Epoch=13.8] | Loss=0.02178 | Reg=0.00369 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.212 | L2-Norm(final)=2.525 | 3526.0 samples/s | 55.1 steps/s
[Step=14200 Epoch=13.9] | Loss=0.02171 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.214 | L2-Norm(final)=2.526 | 3521.6 samples/s | 55.0 steps/s
[Step=14250 Epoch=13.9] | Loss=0.02195 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.216 | L2-Norm(final)=2.526 | 3520.8 samples/s | 55.0 steps/s
[Step=14300 Epoch=14.0] | Loss=0.02193 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.218 | L2-Norm(final)=2.526 | 3522.1 samples/s | 55.0 steps/s
[Step=14350 Epoch=14.0] | Loss=0.02162 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.527 | 3511.1 samples/s | 54.9 steps/s
[Step=14400 Epoch=14.1] | Loss=0.02142 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.222 | L2-Norm(final)=2.527 | 3527.0 samples/s | 55.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step14400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=25.6] | Loss=0.08472 | Reg=0.00369 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.215 | L2-Norm(final)=2.512 | 3846.8 samples/s | 60.1 steps/s
[Step=13650 Epoch=25.7] | Loss=0.00471 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.182 | L2-Norm(final)=2.514 | 3106.1 samples/s | 48.5 steps/s
[Step=13700 Epoch=25.8] | Loss=0.00262 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.174 | L2-Norm(final)=2.517 | 3328.0 samples/s | 52.0 steps/s
[Step=13750 Epoch=25.9] | Loss=0.00177 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.167 | L2-Norm(final)=2.519 | 3347.2 samples/s | 52.3 steps/s
[Step=13800 Epoch=26.0] | Loss=0.00134 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.161 | L2-Norm(final)=2.521 | 3307.1 samples/s | 51.7 steps/s
[Step=13850 Epoch=26.1] | Loss=0.00108 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.156 | L2-Norm(final)=2.522 | 3341.7 samples/s | 52.2 steps/s
[Step=13900 Epoch=26.2] | Loss=0.00091 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.152 | L2-Norm(final)=2.523 | 3342.3 samples/s | 52.2 steps/s
[Step=13950 Epoch=26.3] | Loss=0.00079 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.524 | 3329.5 samples/s | 52.0 steps/s
[Step=14000 Epoch=26.4] | Loss=0.00070 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.525 | 3358.9 samples/s | 52.5 steps/s
[Step=14050 Epoch=26.5] | Loss=0.00062 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.141 | L2-Norm(final)=2.526 | 3345.2 samples/s | 52.3 steps/s
[Step=14100 Epoch=26.6] | Loss=0.00057 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.138 | L2-Norm(final)=2.527 | 3384.4 samples/s | 52.9 steps/s
[Step=14150 Epoch=26.7] | Loss=0.00052 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.135 | L2-Norm(final)=2.527 | 1705.1 samples/s | 26.6 steps/s
[Step=14200 Epoch=26.8] | Loss=0.00048 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.132 | L2-Norm(final)=2.528 | 3358.0 samples/s | 52.5 steps/s
[Step=14250 Epoch=26.9] | Loss=0.00044 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=2.528 | 3338.2 samples/s | 52.2 steps/s
[Step=14300 Epoch=27.0] | Loss=0.00041 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.127 | L2-Norm(final)=2.529 | 3349.8 samples/s | 52.3 steps/s
[Step=14350 Epoch=27.0] | Loss=0.00039 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.125 | L2-Norm(final)=2.529 | 3318.7 samples/s | 51.9 steps/s
[Step=14400 Epoch=27.1] | Loss=0.00037 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.122 | L2-Norm(final)=2.529 | 3347.1 samples/s | 52.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18492 | acc=0.8714 | tpr=0.8220 | fpr=0.0213 | 3721.8 samples/s | 14.5 steps/s
Avg test loss: 0.18513, Avg test acc: 0.86970, Avg tpr: 0.82060, Avg fpr: 0.02230, total FA: 174

Testing server on iccad2012
[Step=  50] | Loss=0.45696 | acc=0.7698 | tpr=1.0000 | fpr=0.2343 | 3858.6 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.45683 | acc=0.7715 | tpr=0.9893 | fpr=0.2326 | 6495.1 samples/s | 25.4 steps/s
[Step= 150] | Loss=0.46148 | acc=0.7710 | tpr=0.9928 | fpr=0.2331 | 6896.3 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.46486 | acc=0.7696 | tpr=0.9934 | fpr=0.2344 | 6734.0 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.46576 | acc=0.7689 | tpr=0.9904 | fpr=0.2352 | 7160.5 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.46740 | acc=0.7688 | tpr=0.9876 | fpr=0.2352 | 6746.7 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.46723 | acc=0.7689 | tpr=0.9875 | fpr=0.2351 | 6846.3 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.46832 | acc=0.7683 | tpr=0.9874 | fpr=0.2356 | 6841.7 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.47166 | acc=0.7678 | tpr=0.9878 | fpr=0.2362 | 6470.6 samples/s | 25.3 steps/s
[Step= 500] | Loss=0.47136 | acc=0.7675 | tpr=0.9872 | fpr=0.2364 | 5968.1 samples/s | 23.3 steps/s
[Step= 550] | Loss=0.47021 | acc=0.7677 | tpr=0.9869 | fpr=0.2363 | 12935.3 samples/s | 50.5 steps/s
Avg test loss: 0.47033, Avg test acc: 0.76768, Avg tpr: 0.98693, Avg fpr: 0.23631, total FA: 32811

server round 18/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=14.1] | Loss=0.11251 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.153 | L2-Norm(final)=2.534 | 3798.0 samples/s | 59.3 steps/s
[Step=14450 Epoch=14.1] | Loss=0.02956 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.133 | L2-Norm(final)=2.522 | 3213.5 samples/s | 50.2 steps/s
[Step=14500 Epoch=14.2] | Loss=0.02326 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.130 | L2-Norm(final)=2.524 | 3419.3 samples/s | 53.4 steps/s
[Step=14550 Epoch=14.2] | Loss=0.02142 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.129 | L2-Norm(final)=2.528 | 3416.5 samples/s | 53.4 steps/s
[Step=14600 Epoch=14.3] | Loss=0.02051 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.129 | L2-Norm(final)=2.532 | 3396.5 samples/s | 53.1 steps/s
[Step=14650 Epoch=14.3] | Loss=0.02062 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=2.536 | 3435.0 samples/s | 53.7 steps/s
[Step=14700 Epoch=14.4] | Loss=0.02057 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.131 | L2-Norm(final)=2.537 | 3363.1 samples/s | 52.5 steps/s
[Step=14750 Epoch=14.4] | Loss=0.02034 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.132 | L2-Norm(final)=2.539 | 3053.0 samples/s | 47.7 steps/s
[Step=14800 Epoch=14.4] | Loss=0.02029 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.134 | L2-Norm(final)=2.541 | 3114.9 samples/s | 48.7 steps/s
[Step=14850 Epoch=14.5] | Loss=0.02023 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=19.136 | L2-Norm(final)=2.542 | 3017.4 samples/s | 47.1 steps/s
[Step=14900 Epoch=14.5] | Loss=0.02011 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.543 | 3179.0 samples/s | 49.7 steps/s
[Step=14950 Epoch=14.6] | Loss=0.01975 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.139 | L2-Norm(final)=2.543 | 3399.7 samples/s | 53.1 steps/s
[Step=15000 Epoch=14.6] | Loss=0.02007 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.140 | L2-Norm(final)=2.544 | 3392.7 samples/s | 53.0 steps/s
[Step=15050 Epoch=14.7] | Loss=0.02010 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.142 | L2-Norm(final)=2.544 | 3404.8 samples/s | 53.2 steps/s
[Step=15100 Epoch=14.7] | Loss=0.02019 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.144 | L2-Norm(final)=2.545 | 3278.6 samples/s | 51.2 steps/s
[Step=15150 Epoch=14.8] | Loss=0.02043 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.146 | L2-Norm(final)=2.546 | 3480.2 samples/s | 54.4 steps/s
[Step=15200 Epoch=14.8] | Loss=0.02038 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.546 | 3501.9 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step15200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=27.1] | Loss=0.06931 | Reg=0.00367 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.153 | L2-Norm(final)=2.535 | 3510.8 samples/s | 54.9 steps/s
[Step=14450 Epoch=27.2] | Loss=0.01315 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.527 | 3271.2 samples/s | 51.1 steps/s
[Step=14500 Epoch=27.3] | Loss=0.00912 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.167 | L2-Norm(final)=2.522 | 3312.8 samples/s | 51.8 steps/s
[Step=14550 Epoch=27.4] | Loss=0.00680 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.167 | L2-Norm(final)=2.522 | 3318.5 samples/s | 51.9 steps/s
[Step=14600 Epoch=27.5] | Loss=0.00524 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.165 | L2-Norm(final)=2.522 | 3325.7 samples/s | 52.0 steps/s
[Step=14650 Epoch=27.6] | Loss=0.00425 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.161 | L2-Norm(final)=2.524 | 3342.7 samples/s | 52.2 steps/s
[Step=14700 Epoch=27.7] | Loss=0.00358 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.526 | 3335.6 samples/s | 52.1 steps/s
[Step=14750 Epoch=27.8] | Loss=0.00313 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.153 | L2-Norm(final)=2.528 | 3342.9 samples/s | 52.2 steps/s
[Step=14800 Epoch=27.9] | Loss=0.00276 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.150 | L2-Norm(final)=2.529 | 3331.5 samples/s | 52.1 steps/s
[Step=14850 Epoch=28.0] | Loss=0.00246 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.146 | L2-Norm(final)=2.531 | 3348.1 samples/s | 52.3 steps/s
[Step=14900 Epoch=28.1] | Loss=0.00225 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.142 | L2-Norm(final)=2.533 | 3355.3 samples/s | 52.4 steps/s
[Step=14950 Epoch=28.2] | Loss=0.00205 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.139 | L2-Norm(final)=2.534 | 1695.6 samples/s | 26.5 steps/s
[Step=15000 Epoch=28.3] | Loss=0.00188 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.136 | L2-Norm(final)=2.535 | 3308.3 samples/s | 51.7 steps/s
[Step=15050 Epoch=28.4] | Loss=0.00174 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.132 | L2-Norm(final)=2.537 | 3284.2 samples/s | 51.3 steps/s
[Step=15100 Epoch=28.5] | Loss=0.00162 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=2.538 | 3300.2 samples/s | 51.6 steps/s
[Step=15150 Epoch=28.6] | Loss=0.00151 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.126 | L2-Norm(final)=2.539 | 3215.6 samples/s | 50.2 steps/s
[Step=15200 Epoch=28.7] | Loss=0.00142 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.123 | L2-Norm(final)=2.540 | 2957.7 samples/s | 46.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21156 | acc=0.8505 | tpr=0.7910 | fpr=0.0203 | 3663.2 samples/s | 14.3 steps/s
Avg test loss: 0.21154, Avg test acc: 0.84919, Avg tpr: 0.79029, Avg fpr: 0.02128, total FA: 166

Testing server on iccad2012
[Step=  50] | Loss=0.41585 | acc=0.7930 | tpr=0.9912 | fpr=0.2105 | 3753.1 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.41728 | acc=0.7938 | tpr=0.9872 | fpr=0.2098 | 6761.8 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.42159 | acc=0.7934 | tpr=0.9899 | fpr=0.2103 | 7145.2 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.42457 | acc=0.7929 | tpr=0.9923 | fpr=0.2107 | 6778.8 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.42609 | acc=0.7920 | tpr=0.9904 | fpr=0.2116 | 6941.6 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.42762 | acc=0.7925 | tpr=0.9876 | fpr=0.2111 | 6804.6 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.42767 | acc=0.7932 | tpr=0.9850 | fpr=0.2103 | 6999.5 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.42857 | acc=0.7929 | tpr=0.9847 | fpr=0.2105 | 6692.3 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.43175 | acc=0.7926 | tpr=0.9849 | fpr=0.2109 | 6642.5 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.43119 | acc=0.7924 | tpr=0.9846 | fpr=0.2111 | 6884.6 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.43007 | acc=0.7927 | tpr=0.9841 | fpr=0.2108 | 12613.3 samples/s | 49.3 steps/s
Avg test loss: 0.43027, Avg test acc: 0.79269, Avg tpr: 0.98415, Avg fpr: 0.21079, total FA: 29268

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=14.8] | Loss=0.09457 | Reg=0.00365 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.105 | L2-Norm(final)=2.550 | 3932.5 samples/s | 61.4 steps/s
[Step=15250 Epoch=14.9] | Loss=0.02670 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.081 | L2-Norm(final)=2.546 | 3355.6 samples/s | 52.4 steps/s
[Step=15300 Epoch=14.9] | Loss=0.02265 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.079 | L2-Norm(final)=2.551 | 3486.0 samples/s | 54.5 steps/s
[Step=15350 Epoch=15.0] | Loss=0.02064 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.079 | L2-Norm(final)=2.555 | 3507.1 samples/s | 54.8 steps/s
[Step=15400 Epoch=15.0] | Loss=0.02052 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.081 | L2-Norm(final)=2.559 | 3497.8 samples/s | 54.7 steps/s
[Step=15450 Epoch=15.1] | Loss=0.02001 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.083 | L2-Norm(final)=2.562 | 3493.6 samples/s | 54.6 steps/s
[Step=15500 Epoch=15.1] | Loss=0.02024 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.085 | L2-Norm(final)=2.564 | 3518.9 samples/s | 55.0 steps/s
[Step=15550 Epoch=15.2] | Loss=0.02019 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.086 | L2-Norm(final)=2.564 | 3516.0 samples/s | 54.9 steps/s
[Step=15600 Epoch=15.2] | Loss=0.02043 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.088 | L2-Norm(final)=2.565 | 3518.1 samples/s | 55.0 steps/s
[Step=15650 Epoch=15.3] | Loss=0.02066 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.090 | L2-Norm(final)=2.565 | 3483.3 samples/s | 54.4 steps/s
[Step=15700 Epoch=15.3] | Loss=0.02065 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.093 | L2-Norm(final)=2.565 | 3370.7 samples/s | 52.7 steps/s
[Step=15750 Epoch=15.4] | Loss=0.02034 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.095 | L2-Norm(final)=2.566 | 3450.5 samples/s | 53.9 steps/s
[Step=15800 Epoch=15.4] | Loss=0.02018 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.098 | L2-Norm(final)=2.567 | 3373.4 samples/s | 52.7 steps/s
[Step=15850 Epoch=15.5] | Loss=0.02042 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.101 | L2-Norm(final)=2.567 | 3395.2 samples/s | 53.1 steps/s
[Step=15900 Epoch=15.5] | Loss=0.02089 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.103 | L2-Norm(final)=2.567 | 3442.8 samples/s | 53.8 steps/s
[Step=15950 Epoch=15.6] | Loss=0.02092 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.106 | L2-Norm(final)=2.567 | 3441.8 samples/s | 53.8 steps/s
[Step=16000 Epoch=15.6] | Loss=0.02063 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.108 | L2-Norm(final)=2.567 | 3500.7 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step16000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=28.7] | Loss=0.14671 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.105 | L2-Norm(final)=2.550 | 3936.0 samples/s | 61.5 steps/s
[Step=15250 Epoch=28.7] | Loss=0.00681 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.083 | L2-Norm(final)=2.549 | 2990.6 samples/s | 46.7 steps/s
[Step=15300 Epoch=28.8] | Loss=0.00362 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.077 | L2-Norm(final)=2.552 | 3313.7 samples/s | 51.8 steps/s
[Step=15350 Epoch=28.9] | Loss=0.00256 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.071 | L2-Norm(final)=2.554 | 3309.4 samples/s | 51.7 steps/s
[Step=15400 Epoch=29.0] | Loss=0.00197 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.066 | L2-Norm(final)=2.555 | 3310.9 samples/s | 51.7 steps/s
[Step=15450 Epoch=29.1] | Loss=0.00159 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.061 | L2-Norm(final)=2.557 | 3322.1 samples/s | 51.9 steps/s
[Step=15500 Epoch=29.2] | Loss=0.00134 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.056 | L2-Norm(final)=2.558 | 3296.2 samples/s | 51.5 steps/s
[Step=15550 Epoch=29.3] | Loss=0.00115 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.052 | L2-Norm(final)=2.559 | 3316.3 samples/s | 51.8 steps/s
[Step=15600 Epoch=29.4] | Loss=0.00101 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.048 | L2-Norm(final)=2.560 | 3319.8 samples/s | 51.9 steps/s
[Step=15650 Epoch=29.5] | Loss=0.00093 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.044 | L2-Norm(final)=2.561 | 3333.8 samples/s | 52.1 steps/s
[Step=15700 Epoch=29.6] | Loss=0.00084 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.041 | L2-Norm(final)=2.561 | 3362.2 samples/s | 52.5 steps/s
[Step=15750 Epoch=29.7] | Loss=0.00077 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.037 | L2-Norm(final)=2.562 | 1726.2 samples/s | 27.0 steps/s
[Step=15800 Epoch=29.8] | Loss=0.00071 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.034 | L2-Norm(final)=2.563 | 3318.9 samples/s | 51.9 steps/s
[Step=15850 Epoch=29.9] | Loss=0.00065 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.031 | L2-Norm(final)=2.563 | 3300.8 samples/s | 51.6 steps/s
[Step=15900 Epoch=30.0] | Loss=0.00061 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.029 | L2-Norm(final)=2.563 | 3272.9 samples/s | 51.1 steps/s
[Step=15950 Epoch=30.1] | Loss=0.00057 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.026 | L2-Norm(final)=2.564 | 3283.8 samples/s | 51.3 steps/s
[Step=16000 Epoch=30.2] | Loss=0.00054 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.024 | L2-Norm(final)=2.564 | 3307.7 samples/s | 51.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23602 | acc=0.8353 | tpr=0.7689 | fpr=0.0206 | 3766.4 samples/s | 14.7 steps/s
Avg test loss: 0.23448, Avg test acc: 0.83500, Avg tpr: 0.76977, Avg fpr: 0.02154, total FA: 168

Testing server on iccad2012
[Step=  50] | Loss=0.36028 | acc=0.8239 | tpr=0.9956 | fpr=0.1792 | 3722.1 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.36280 | acc=0.8248 | tpr=0.9915 | fpr=0.1783 | 6789.3 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.36730 | acc=0.8242 | tpr=0.9928 | fpr=0.1789 | 7091.2 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.37085 | acc=0.8219 | tpr=0.9923 | fpr=0.1812 | 6840.8 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.37182 | acc=0.8208 | tpr=0.9904 | fpr=0.1823 | 6727.2 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.37364 | acc=0.8206 | tpr=0.9876 | fpr=0.1825 | 6914.1 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.37408 | acc=0.8211 | tpr=0.9869 | fpr=0.1819 | 6791.8 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.37469 | acc=0.8207 | tpr=0.9863 | fpr=0.1823 | 6757.8 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.37774 | acc=0.8202 | tpr=0.9864 | fpr=0.1828 | 6895.1 samples/s | 26.9 steps/s
[Step= 500] | Loss=0.37703 | acc=0.8199 | tpr=0.9859 | fpr=0.1831 | 6546.7 samples/s | 25.6 steps/s
[Step= 550] | Loss=0.37577 | acc=0.8201 | tpr=0.9857 | fpr=0.1829 | 12902.2 samples/s | 50.4 steps/s
Avg test loss: 0.37596, Avg test acc: 0.82020, Avg tpr: 0.98574, Avg fpr: 0.18280, total FA: 25382

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=15.6] | Loss=0.17127 | Reg=0.00363 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.046 | L2-Norm(final)=2.568 | 4117.3 samples/s | 64.3 steps/s
[Step=16050 Epoch=15.7] | Loss=0.02654 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.029 | L2-Norm(final)=2.567 | 3046.9 samples/s | 47.6 steps/s
[Step=16100 Epoch=15.7] | Loss=0.01890 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.021 | L2-Norm(final)=2.570 | 3469.4 samples/s | 54.2 steps/s
[Step=16150 Epoch=15.8] | Loss=0.01830 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.017 | L2-Norm(final)=2.573 | 3476.1 samples/s | 54.3 steps/s
[Step=16200 Epoch=15.8] | Loss=0.01714 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.015 | L2-Norm(final)=2.575 | 3472.0 samples/s | 54.2 steps/s
[Step=16250 Epoch=15.9] | Loss=0.01632 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.013 | L2-Norm(final)=2.577 | 3488.2 samples/s | 54.5 steps/s
[Step=16300 Epoch=15.9] | Loss=0.01587 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.012 | L2-Norm(final)=2.579 | 3447.6 samples/s | 53.9 steps/s
[Step=16350 Epoch=16.0] | Loss=0.01488 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.011 | L2-Norm(final)=2.581 | 3504.9 samples/s | 54.8 steps/s
[Step=16400 Epoch=16.0] | Loss=0.01477 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.010 | L2-Norm(final)=2.582 | 3492.9 samples/s | 54.6 steps/s
[Step=16450 Epoch=16.1] | Loss=0.01469 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.010 | L2-Norm(final)=2.584 | 3494.0 samples/s | 54.6 steps/s
[Step=16500 Epoch=16.1] | Loss=0.01458 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.009 | L2-Norm(final)=2.585 | 3499.9 samples/s | 54.7 steps/s
[Step=16550 Epoch=16.2] | Loss=0.01439 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.009 | L2-Norm(final)=2.586 | 3499.7 samples/s | 54.7 steps/s
[Step=16600 Epoch=16.2] | Loss=0.01440 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.008 | L2-Norm(final)=2.587 | 3481.0 samples/s | 54.4 steps/s
[Step=16650 Epoch=16.3] | Loss=0.01412 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.008 | L2-Norm(final)=2.589 | 3489.6 samples/s | 54.5 steps/s
[Step=16700 Epoch=16.3] | Loss=0.01442 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.008 | L2-Norm(final)=2.590 | 3492.3 samples/s | 54.6 steps/s
[Step=16750 Epoch=16.4] | Loss=0.01449 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.590 | 3481.7 samples/s | 54.4 steps/s
[Step=16800 Epoch=16.4] | Loss=0.01434 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.008 | L2-Norm(final)=2.591 | 3467.4 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step16800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=30.2] | Loss=0.05950 | Reg=0.00363 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.046 | L2-Norm(final)=2.568 | 3846.0 samples/s | 60.1 steps/s
[Step=16050 Epoch=30.3] | Loss=0.00792 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.001 | L2-Norm(final)=2.563 | 3063.9 samples/s | 47.9 steps/s
[Step=16100 Epoch=30.3] | Loss=0.00407 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.992 | L2-Norm(final)=2.563 | 3287.2 samples/s | 51.4 steps/s
[Step=16150 Epoch=30.4] | Loss=0.00278 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.986 | L2-Norm(final)=2.565 | 3306.2 samples/s | 51.7 steps/s
[Step=16200 Epoch=30.5] | Loss=0.00210 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.981 | L2-Norm(final)=2.566 | 3307.0 samples/s | 51.7 steps/s
[Step=16250 Epoch=30.6] | Loss=0.00171 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.977 | L2-Norm(final)=2.567 | 3300.8 samples/s | 51.6 steps/s
[Step=16300 Epoch=30.7] | Loss=0.00144 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.974 | L2-Norm(final)=2.568 | 3328.1 samples/s | 52.0 steps/s
[Step=16350 Epoch=30.8] | Loss=0.00124 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.971 | L2-Norm(final)=2.569 | 3320.7 samples/s | 51.9 steps/s
[Step=16400 Epoch=30.9] | Loss=0.00109 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.969 | L2-Norm(final)=2.570 | 3317.3 samples/s | 51.8 steps/s
[Step=16450 Epoch=31.0] | Loss=0.00097 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.967 | L2-Norm(final)=2.570 | 3312.0 samples/s | 51.7 steps/s
[Step=16500 Epoch=31.1] | Loss=0.00088 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.964 | L2-Norm(final)=2.571 | 3335.6 samples/s | 52.1 steps/s
[Step=16550 Epoch=31.2] | Loss=0.00081 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.962 | L2-Norm(final)=2.572 | 1690.9 samples/s | 26.4 steps/s
[Step=16600 Epoch=31.3] | Loss=0.00074 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.961 | L2-Norm(final)=2.572 | 3311.1 samples/s | 51.7 steps/s
[Step=16650 Epoch=31.4] | Loss=0.00069 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.959 | L2-Norm(final)=2.573 | 3300.9 samples/s | 51.6 steps/s
[Step=16700 Epoch=31.5] | Loss=0.00064 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.957 | L2-Norm(final)=2.573 | 3295.9 samples/s | 51.5 steps/s
[Step=16750 Epoch=31.6] | Loss=0.00060 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.955 | L2-Norm(final)=2.574 | 3297.0 samples/s | 51.5 steps/s
[Step=16800 Epoch=31.7] | Loss=0.00056 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.954 | L2-Norm(final)=2.574 | 3276.1 samples/s | 51.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18506 | acc=0.8751 | tpr=0.8268 | fpr=0.0201 | 3734.0 samples/s | 14.6 steps/s
Avg test loss: 0.18466, Avg test acc: 0.87419, Avg tpr: 0.82654, Avg fpr: 0.02102, total FA: 164

Testing server on iccad2012
[Step=  50] | Loss=0.47082 | acc=0.7848 | tpr=1.0000 | fpr=0.2190 | 3752.4 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.47256 | acc=0.7854 | tpr=0.9936 | fpr=0.2185 | 6747.5 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.47882 | acc=0.7842 | tpr=0.9942 | fpr=0.2197 | 6891.9 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.48277 | acc=0.7825 | tpr=0.9956 | fpr=0.2214 | 6961.0 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.48369 | acc=0.7817 | tpr=0.9939 | fpr=0.2221 | 6686.1 samples/s | 26.1 steps/s
[Step= 300] | Loss=0.48556 | acc=0.7817 | tpr=0.9913 | fpr=0.2221 | 6998.4 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.48597 | acc=0.7818 | tpr=0.9906 | fpr=0.2220 | 6800.7 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.48740 | acc=0.7812 | tpr=0.9902 | fpr=0.2226 | 6742.8 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.49059 | acc=0.7809 | tpr=0.9893 | fpr=0.2229 | 6795.5 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.48993 | acc=0.7802 | tpr=0.9885 | fpr=0.2236 | 7084.8 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.48841 | acc=0.7804 | tpr=0.9881 | fpr=0.2234 | 11891.1 samples/s | 46.4 steps/s
Avg test loss: 0.48855, Avg test acc: 0.78044, Avg tpr: 0.98811, Avg fpr: 0.22334, total FA: 31010

server round 21/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=16.4] | Loss=0.21662 | Reg=0.00359 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.960 | L2-Norm(final)=2.593 | 3636.0 samples/s | 56.8 steps/s
[Step=16850 Epoch=16.5] | Loss=0.02204 | Reg=0.00358 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.933 | L2-Norm(final)=2.590 | 3446.2 samples/s | 53.8 steps/s
[Step=16900 Epoch=16.5] | Loss=0.01928 | Reg=0.00358 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.925 | L2-Norm(final)=2.592 | 3446.1 samples/s | 53.8 steps/s
[Step=16950 Epoch=16.5] | Loss=0.01659 | Reg=0.00358 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.922 | L2-Norm(final)=2.595 | 3455.5 samples/s | 54.0 steps/s
[Step=17000 Epoch=16.6] | Loss=0.01566 | Reg=0.00358 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.920 | L2-Norm(final)=2.598 | 3461.5 samples/s | 54.1 steps/s
[Step=17050 Epoch=16.6] | Loss=0.01504 | Reg=0.00358 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.919 | L2-Norm(final)=2.600 | 3476.4 samples/s | 54.3 steps/s
[Step=17100 Epoch=16.7] | Loss=0.01415 | Reg=0.00358 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.918 | L2-Norm(final)=2.603 | 3468.8 samples/s | 54.2 steps/s
[Step=17150 Epoch=16.7] | Loss=0.01365 | Reg=0.00358 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.918 | L2-Norm(final)=2.605 | 3491.6 samples/s | 54.6 steps/s
[Step=17200 Epoch=16.8] | Loss=0.01323 | Reg=0.00358 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.918 | L2-Norm(final)=2.607 | 3466.0 samples/s | 54.2 steps/s
[Step=17250 Epoch=16.8] | Loss=0.01336 | Reg=0.00358 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.918 | L2-Norm(final)=2.609 | 3460.2 samples/s | 54.1 steps/s
[Step=17300 Epoch=16.9] | Loss=0.01333 | Reg=0.00358 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.919 | L2-Norm(final)=2.611 | 3476.3 samples/s | 54.3 steps/s
[Step=17350 Epoch=16.9] | Loss=0.01321 | Reg=0.00358 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.919 | L2-Norm(final)=2.612 | 3481.6 samples/s | 54.4 steps/s
[Step=17400 Epoch=17.0] | Loss=0.01343 | Reg=0.00358 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.919 | L2-Norm(final)=2.614 | 3469.1 samples/s | 54.2 steps/s
[Step=17450 Epoch=17.0] | Loss=0.01343 | Reg=0.00358 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.919 | L2-Norm(final)=2.615 | 3466.6 samples/s | 54.2 steps/s
[Step=17500 Epoch=17.1] | Loss=0.01343 | Reg=0.00358 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.920 | L2-Norm(final)=2.617 | 3468.7 samples/s | 54.2 steps/s
[Step=17550 Epoch=17.1] | Loss=0.01329 | Reg=0.00358 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.920 | L2-Norm(final)=2.618 | 3443.7 samples/s | 53.8 steps/s
[Step=17600 Epoch=17.2] | Loss=0.01347 | Reg=0.00358 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.920 | L2-Norm(final)=2.619 | 3469.6 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step17600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=31.7] | Loss=0.04926 | Reg=0.00359 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.960 | L2-Norm(final)=2.594 | 3818.8 samples/s | 59.7 steps/s
[Step=16850 Epoch=31.8] | Loss=0.00743 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.917 | L2-Norm(final)=2.593 | 3006.4 samples/s | 47.0 steps/s
[Step=16900 Epoch=31.9] | Loss=0.00556 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.911 | L2-Norm(final)=2.594 | 3298.5 samples/s | 51.5 steps/s
[Step=16950 Epoch=32.0] | Loss=0.00385 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.907 | L2-Norm(final)=2.593 | 3307.6 samples/s | 51.7 steps/s
[Step=17000 Epoch=32.0] | Loss=0.00291 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.904 | L2-Norm(final)=2.594 | 3320.3 samples/s | 51.9 steps/s
[Step=17050 Epoch=32.1] | Loss=0.00236 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.901 | L2-Norm(final)=2.594 | 3310.5 samples/s | 51.7 steps/s
[Step=17100 Epoch=32.2] | Loss=0.00197 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.898 | L2-Norm(final)=2.595 | 3346.6 samples/s | 52.3 steps/s
[Step=17150 Epoch=32.3] | Loss=0.00170 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.895 | L2-Norm(final)=2.595 | 3307.7 samples/s | 51.7 steps/s
[Step=17200 Epoch=32.4] | Loss=0.00149 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.893 | L2-Norm(final)=2.596 | 3331.0 samples/s | 52.0 steps/s
[Step=17250 Epoch=32.5] | Loss=0.00133 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.891 | L2-Norm(final)=2.596 | 3300.2 samples/s | 51.6 steps/s
[Step=17300 Epoch=32.6] | Loss=0.00120 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.889 | L2-Norm(final)=2.596 | 3344.6 samples/s | 52.3 steps/s
[Step=17350 Epoch=32.7] | Loss=0.00110 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.887 | L2-Norm(final)=2.597 | 1675.6 samples/s | 26.2 steps/s
[Step=17400 Epoch=32.8] | Loss=0.00101 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.885 | L2-Norm(final)=2.597 | 3339.6 samples/s | 52.2 steps/s
[Step=17450 Epoch=32.9] | Loss=0.00093 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.883 | L2-Norm(final)=2.598 | 3294.9 samples/s | 51.5 steps/s
[Step=17500 Epoch=33.0] | Loss=0.00087 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.881 | L2-Norm(final)=2.598 | 3305.6 samples/s | 51.7 steps/s
[Step=17550 Epoch=33.1] | Loss=0.00081 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.879 | L2-Norm(final)=2.598 | 3304.4 samples/s | 51.6 steps/s
[Step=17600 Epoch=33.2] | Loss=0.00076 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.878 | L2-Norm(final)=2.599 | 3301.1 samples/s | 51.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35406 | acc=0.7803 | tpr=0.6848 | fpr=0.0124 | 3670.3 samples/s | 14.3 steps/s
Avg test loss: 0.35540, Avg test acc: 0.77650, Avg tpr: 0.68042, Avg fpr: 0.01218, total FA: 95

Testing server on iccad2012
[Step=  50] | Loss=0.28628 | acc=0.8758 | tpr=0.9956 | fpr=0.1264 | 3740.5 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.28898 | acc=0.8764 | tpr=0.9936 | fpr=0.1258 | 6792.5 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.29445 | acc=0.8762 | tpr=0.9942 | fpr=0.1259 | 6970.4 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.29695 | acc=0.8759 | tpr=0.9945 | fpr=0.1263 | 6682.2 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.29653 | acc=0.8751 | tpr=0.9913 | fpr=0.1270 | 6863.9 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.29884 | acc=0.8745 | tpr=0.9884 | fpr=0.1276 | 6690.2 samples/s | 26.1 steps/s
[Step= 350] | Loss=0.29982 | acc=0.8746 | tpr=0.9875 | fpr=0.1275 | 6844.7 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.30080 | acc=0.8742 | tpr=0.9874 | fpr=0.1279 | 6777.3 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.30428 | acc=0.8735 | tpr=0.9873 | fpr=0.1285 | 6908.0 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.30350 | acc=0.8735 | tpr=0.9868 | fpr=0.1286 | 6790.7 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.30210 | acc=0.8738 | tpr=0.9865 | fpr=0.1282 | 12251.3 samples/s | 47.9 steps/s
Avg test loss: 0.30216, Avg test acc: 0.87392, Avg tpr: 0.98653, Avg fpr: 0.12813, total FA: 17790

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=17.2] | Loss=0.23783 | Reg=0.00356 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.879 | L2-Norm(final)=2.618 | 3968.8 samples/s | 62.0 steps/s
[Step=17650 Epoch=17.2] | Loss=0.02674 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.868 | L2-Norm(final)=2.611 | 3276.5 samples/s | 51.2 steps/s
[Step=17700 Epoch=17.3] | Loss=0.01914 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.862 | L2-Norm(final)=2.613 | 3463.2 samples/s | 54.1 steps/s
[Step=17750 Epoch=17.3] | Loss=0.01608 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.858 | L2-Norm(final)=2.616 | 3455.7 samples/s | 54.0 steps/s
[Step=17800 Epoch=17.4] | Loss=0.01443 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.855 | L2-Norm(final)=2.619 | 3461.8 samples/s | 54.1 steps/s
[Step=17850 Epoch=17.4] | Loss=0.01336 | Reg=0.00355 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.854 | L2-Norm(final)=2.621 | 3479.8 samples/s | 54.4 steps/s
[Step=17900 Epoch=17.5] | Loss=0.01297 | Reg=0.00355 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.853 | L2-Norm(final)=2.624 | 3487.7 samples/s | 54.5 steps/s
[Step=17950 Epoch=17.5] | Loss=0.01291 | Reg=0.00355 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.852 | L2-Norm(final)=2.626 | 3429.7 samples/s | 53.6 steps/s
[Step=18000 Epoch=17.6] | Loss=0.01302 | Reg=0.00355 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.851 | L2-Norm(final)=2.627 | 3469.8 samples/s | 54.2 steps/s
[Step=18050 Epoch=17.6] | Loss=0.01275 | Reg=0.00355 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.850 | L2-Norm(final)=2.628 | 3452.6 samples/s | 53.9 steps/s
[Step=18100 Epoch=17.7] | Loss=0.01273 | Reg=0.00355 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.849 | L2-Norm(final)=2.630 | 3486.4 samples/s | 54.5 steps/s
[Step=18150 Epoch=17.7] | Loss=0.01278 | Reg=0.00355 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.849 | L2-Norm(final)=2.630 | 3462.8 samples/s | 54.1 steps/s
[Step=18200 Epoch=17.8] | Loss=0.01300 | Reg=0.00355 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.848 | L2-Norm(final)=2.631 | 3484.2 samples/s | 54.4 steps/s
[Step=18250 Epoch=17.8] | Loss=0.01300 | Reg=0.00355 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.848 | L2-Norm(final)=2.632 | 3493.3 samples/s | 54.6 steps/s
[Step=18300 Epoch=17.9] | Loss=0.01312 | Reg=0.00355 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.848 | L2-Norm(final)=2.633 | 3485.6 samples/s | 54.5 steps/s
[Step=18350 Epoch=17.9] | Loss=0.01322 | Reg=0.00355 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.848 | L2-Norm(final)=2.633 | 3491.1 samples/s | 54.5 steps/s
[Step=18400 Epoch=18.0] | Loss=0.01326 | Reg=0.00355 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.848 | L2-Norm(final)=2.634 | 3487.8 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step18400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=33.2] | Loss=0.04804 | Reg=0.00356 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.879 | L2-Norm(final)=2.618 | 4036.8 samples/s | 63.1 steps/s
[Step=17650 Epoch=33.3] | Loss=0.00265 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.827 | L2-Norm(final)=2.621 | 2863.8 samples/s | 44.7 steps/s
[Step=17700 Epoch=33.4] | Loss=0.00142 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.818 | L2-Norm(final)=2.622 | 3287.8 samples/s | 51.4 steps/s
[Step=17750 Epoch=33.5] | Loss=0.00097 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.812 | L2-Norm(final)=2.624 | 3323.2 samples/s | 51.9 steps/s
[Step=17800 Epoch=33.6] | Loss=0.00074 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.807 | L2-Norm(final)=2.625 | 3295.1 samples/s | 51.5 steps/s
[Step=17850 Epoch=33.6] | Loss=0.00060 | Reg=0.00354 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.804 | L2-Norm(final)=2.626 | 3304.9 samples/s | 51.6 steps/s
[Step=17900 Epoch=33.7] | Loss=0.00052 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.801 | L2-Norm(final)=2.627 | 3309.3 samples/s | 51.7 steps/s
[Step=17950 Epoch=33.8] | Loss=0.00045 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.798 | L2-Norm(final)=2.627 | 3324.4 samples/s | 51.9 steps/s
[Step=18000 Epoch=33.9] | Loss=0.00040 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.795 | L2-Norm(final)=2.628 | 3312.6 samples/s | 51.8 steps/s
[Step=18050 Epoch=34.0] | Loss=0.00036 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.793 | L2-Norm(final)=2.629 | 3316.2 samples/s | 51.8 steps/s
[Step=18100 Epoch=34.1] | Loss=0.00033 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.791 | L2-Norm(final)=2.629 | 3322.1 samples/s | 51.9 steps/s
[Step=18150 Epoch=34.2] | Loss=0.00030 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.789 | L2-Norm(final)=2.630 | 1703.0 samples/s | 26.6 steps/s
[Step=18200 Epoch=34.3] | Loss=0.00028 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.787 | L2-Norm(final)=2.630 | 3339.2 samples/s | 52.2 steps/s
[Step=18250 Epoch=34.4] | Loss=0.00026 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.785 | L2-Norm(final)=2.631 | 3288.5 samples/s | 51.4 steps/s
[Step=18300 Epoch=34.5] | Loss=0.00024 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.784 | L2-Norm(final)=2.631 | 3281.7 samples/s | 51.3 steps/s
[Step=18350 Epoch=34.6] | Loss=0.00023 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.782 | L2-Norm(final)=2.632 | 3307.9 samples/s | 51.7 steps/s
[Step=18400 Epoch=34.7] | Loss=0.00022 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.781 | L2-Norm(final)=2.632 | 3301.8 samples/s | 51.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.16524 | acc=0.8955 | tpr=0.8554 | fpr=0.0173 | 3691.4 samples/s | 14.4 steps/s
Avg test loss: 0.16486, Avg test acc: 0.89386, Avg tpr: 0.85400, Avg fpr: 0.01846, total FA: 144

Testing server on iccad2012
[Step=  50] | Loss=0.52862 | acc=0.7620 | tpr=1.0000 | fpr=0.2423 | 3724.7 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.53191 | acc=0.7643 | tpr=0.9957 | fpr=0.2400 | 6833.1 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.53743 | acc=0.7633 | tpr=0.9957 | fpr=0.2410 | 6738.8 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.54105 | acc=0.7617 | tpr=0.9956 | fpr=0.2426 | 6889.5 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.54127 | acc=0.7613 | tpr=0.9921 | fpr=0.2429 | 6725.8 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.54381 | acc=0.7606 | tpr=0.9905 | fpr=0.2436 | 6794.5 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.54431 | acc=0.7609 | tpr=0.9887 | fpr=0.2432 | 6802.2 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.54580 | acc=0.7604 | tpr=0.9880 | fpr=0.2437 | 6722.3 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.54990 | acc=0.7598 | tpr=0.9873 | fpr=0.2443 | 6671.8 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.54950 | acc=0.7594 | tpr=0.9868 | fpr=0.2448 | 6804.7 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.54797 | acc=0.7596 | tpr=0.9865 | fpr=0.2445 | 12456.5 samples/s | 48.7 steps/s
Avg test loss: 0.54815, Avg test acc: 0.75964, Avg tpr: 0.98653, Avg fpr: 0.24448, total FA: 33946

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=18.0] | Loss=0.06750 | Reg=0.00353 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.795 | L2-Norm(final)=2.640 | 3777.0 samples/s | 59.0 steps/s
[Step=18450 Epoch=18.0] | Loss=0.01973 | Reg=0.00352 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.767 | L2-Norm(final)=2.642 | 3279.6 samples/s | 51.2 steps/s
[Step=18500 Epoch=18.1] | Loss=0.01547 | Reg=0.00352 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.762 | L2-Norm(final)=2.646 | 3500.8 samples/s | 54.7 steps/s
[Step=18550 Epoch=18.1] | Loss=0.01346 | Reg=0.00352 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.759 | L2-Norm(final)=2.649 | 3463.0 samples/s | 54.1 steps/s
[Step=18600 Epoch=18.2] | Loss=0.01273 | Reg=0.00352 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.757 | L2-Norm(final)=2.652 | 3485.3 samples/s | 54.5 steps/s
[Step=18650 Epoch=18.2] | Loss=0.01242 | Reg=0.00352 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.756 | L2-Norm(final)=2.655 | 3461.3 samples/s | 54.1 steps/s
[Step=18700 Epoch=18.3] | Loss=0.01226 | Reg=0.00352 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.756 | L2-Norm(final)=2.657 | 3484.3 samples/s | 54.4 steps/s
[Step=18750 Epoch=18.3] | Loss=0.01263 | Reg=0.00352 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.755 | L2-Norm(final)=2.659 | 3478.6 samples/s | 54.4 steps/s
[Step=18800 Epoch=18.4] | Loss=0.01251 | Reg=0.00352 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.755 | L2-Norm(final)=2.660 | 3470.1 samples/s | 54.2 steps/s
[Step=18850 Epoch=18.4] | Loss=0.01228 | Reg=0.00352 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.755 | L2-Norm(final)=2.661 | 3489.0 samples/s | 54.5 steps/s
[Step=18900 Epoch=18.5] | Loss=0.01226 | Reg=0.00352 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.756 | L2-Norm(final)=2.663 | 3485.0 samples/s | 54.5 steps/s
[Step=18950 Epoch=18.5] | Loss=0.01212 | Reg=0.00352 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.756 | L2-Norm(final)=2.664 | 3445.7 samples/s | 53.8 steps/s
[Step=19000 Epoch=18.6] | Loss=0.01188 | Reg=0.00352 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.757 | L2-Norm(final)=2.665 | 3486.3 samples/s | 54.5 steps/s
[Step=19050 Epoch=18.6] | Loss=0.01182 | Reg=0.00352 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.757 | L2-Norm(final)=2.667 | 3487.6 samples/s | 54.5 steps/s
[Step=19100 Epoch=18.6] | Loss=0.01204 | Reg=0.00352 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.757 | L2-Norm(final)=2.668 | 3493.8 samples/s | 54.6 steps/s
[Step=19150 Epoch=18.7] | Loss=0.01214 | Reg=0.00352 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.758 | L2-Norm(final)=2.668 | 3478.2 samples/s | 54.3 steps/s
[Step=19200 Epoch=18.7] | Loss=0.01214 | Reg=0.00352 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.758 | L2-Norm(final)=2.669 | 3416.8 samples/s | 53.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step19200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=34.7] | Loss=0.11238 | Reg=0.00353 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.795 | L2-Norm(final)=2.640 | 4162.4 samples/s | 65.0 steps/s
[Step=18450 Epoch=34.8] | Loss=0.00759 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.765 | L2-Norm(final)=2.641 | 2869.3 samples/s | 44.8 steps/s
[Step=18500 Epoch=34.9] | Loss=0.00398 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.759 | L2-Norm(final)=2.643 | 3288.4 samples/s | 51.4 steps/s
[Step=18550 Epoch=35.0] | Loss=0.00269 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.753 | L2-Norm(final)=2.644 | 3289.3 samples/s | 51.4 steps/s
[Step=18600 Epoch=35.1] | Loss=0.00203 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.748 | L2-Norm(final)=2.644 | 3301.9 samples/s | 51.6 steps/s
[Step=18650 Epoch=35.2] | Loss=0.00165 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.744 | L2-Norm(final)=2.645 | 3315.9 samples/s | 51.8 steps/s
[Step=18700 Epoch=35.2] | Loss=0.00138 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.740 | L2-Norm(final)=2.646 | 3316.2 samples/s | 51.8 steps/s
[Step=18750 Epoch=35.3] | Loss=0.00119 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.737 | L2-Norm(final)=2.646 | 3311.2 samples/s | 51.7 steps/s
[Step=18800 Epoch=35.4] | Loss=0.00104 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.734 | L2-Norm(final)=2.646 | 3322.1 samples/s | 51.9 steps/s
[Step=18850 Epoch=35.5] | Loss=0.00094 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.731 | L2-Norm(final)=2.647 | 3310.3 samples/s | 51.7 steps/s
[Step=18900 Epoch=35.6] | Loss=0.00084 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.728 | L2-Norm(final)=2.647 | 3361.4 samples/s | 52.5 steps/s
[Step=18950 Epoch=35.7] | Loss=0.00077 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.726 | L2-Norm(final)=2.647 | 1654.5 samples/s | 25.9 steps/s
[Step=19000 Epoch=35.8] | Loss=0.00071 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.724 | L2-Norm(final)=2.648 | 3327.2 samples/s | 52.0 steps/s
[Step=19050 Epoch=35.9] | Loss=0.00065 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.722 | L2-Norm(final)=2.648 | 3294.3 samples/s | 51.5 steps/s
[Step=19100 Epoch=36.0] | Loss=0.00061 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.720 | L2-Norm(final)=2.648 | 3303.0 samples/s | 51.6 steps/s
[Step=19150 Epoch=36.1] | Loss=0.00057 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.718 | L2-Norm(final)=2.648 | 3313.2 samples/s | 51.8 steps/s
[Step=19200 Epoch=36.2] | Loss=0.00053 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.716 | L2-Norm(final)=2.648 | 3290.2 samples/s | 51.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32479 | acc=0.7970 | tpr=0.7095 | fpr=0.0129 | 3693.5 samples/s | 14.4 steps/s
Avg test loss: 0.32418, Avg test acc: 0.79618, Avg tpr: 0.70974, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.30100 | acc=0.8723 | tpr=0.9956 | fpr=0.1299 | 3707.9 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.30477 | acc=0.8727 | tpr=0.9893 | fpr=0.1295 | 6860.5 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.31085 | acc=0.8727 | tpr=0.9899 | fpr=0.1295 | 6875.9 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.31428 | acc=0.8715 | tpr=0.9902 | fpr=0.1307 | 6783.3 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.31428 | acc=0.8712 | tpr=0.9878 | fpr=0.1310 | 6798.7 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.31736 | acc=0.8706 | tpr=0.9855 | fpr=0.1315 | 6768.9 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.31842 | acc=0.8708 | tpr=0.9843 | fpr=0.1313 | 6965.9 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.31975 | acc=0.8699 | tpr=0.9841 | fpr=0.1322 | 6575.4 samples/s | 25.7 steps/s
[Step= 450] | Loss=0.32332 | acc=0.8692 | tpr=0.9839 | fpr=0.1329 | 6692.6 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.32235 | acc=0.8694 | tpr=0.9837 | fpr=0.1327 | 6871.6 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.32086 | acc=0.8698 | tpr=0.9837 | fpr=0.1322 | 12953.1 samples/s | 50.6 steps/s
Avg test loss: 0.32092, Avg test acc: 0.86991, Avg tpr: 0.98376, Avg fpr: 0.13216, total FA: 18350

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=18.7] | Loss=0.35474 | Reg=0.00350 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=18.717 | L2-Norm(final)=2.664 | 3779.2 samples/s | 59.1 steps/s
[Step=19250 Epoch=18.8] | Loss=0.02580 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.704 | L2-Norm(final)=2.661 | 3305.2 samples/s | 51.6 steps/s
[Step=19300 Epoch=18.8] | Loss=0.01851 | Reg=0.00350 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.697 | L2-Norm(final)=2.662 | 3421.6 samples/s | 53.5 steps/s
[Step=19350 Epoch=18.9] | Loss=0.01646 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.694 | L2-Norm(final)=2.664 | 3465.0 samples/s | 54.1 steps/s
[Step=19400 Epoch=18.9] | Loss=0.01626 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.692 | L2-Norm(final)=2.666 | 3472.1 samples/s | 54.3 steps/s
[Step=19450 Epoch=19.0] | Loss=0.01563 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.690 | L2-Norm(final)=2.667 | 3459.2 samples/s | 54.1 steps/s
[Step=19500 Epoch=19.0] | Loss=0.01465 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.689 | L2-Norm(final)=2.668 | 3476.0 samples/s | 54.3 steps/s
[Step=19550 Epoch=19.1] | Loss=0.01416 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.689 | L2-Norm(final)=2.670 | 3481.7 samples/s | 54.4 steps/s
[Step=19600 Epoch=19.1] | Loss=0.01401 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.688 | L2-Norm(final)=2.671 | 3479.5 samples/s | 54.4 steps/s
[Step=19650 Epoch=19.2] | Loss=0.01368 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.688 | L2-Norm(final)=2.673 | 3446.0 samples/s | 53.8 steps/s
[Step=19700 Epoch=19.2] | Loss=0.01336 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.688 | L2-Norm(final)=2.674 | 3448.6 samples/s | 53.9 steps/s
[Step=19750 Epoch=19.3] | Loss=0.01364 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.688 | L2-Norm(final)=2.675 | 3453.5 samples/s | 54.0 steps/s
[Step=19800 Epoch=19.3] | Loss=0.01367 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.688 | L2-Norm(final)=2.675 | 3431.1 samples/s | 53.6 steps/s
[Step=19850 Epoch=19.4] | Loss=0.01371 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.688 | L2-Norm(final)=2.676 | 3448.4 samples/s | 53.9 steps/s
[Step=19900 Epoch=19.4] | Loss=0.01383 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.688 | L2-Norm(final)=2.676 | 3450.9 samples/s | 53.9 steps/s
[Step=19950 Epoch=19.5] | Loss=0.01372 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.688 | L2-Norm(final)=2.676 | 3476.6 samples/s | 54.3 steps/s
[Step=20000 Epoch=19.5] | Loss=0.01369 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.688 | L2-Norm(final)=2.677 | 3468.7 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step20000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=36.2] | Loss=0.02829 | Reg=0.00350 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.717 | L2-Norm(final)=2.665 | 3905.7 samples/s | 61.0 steps/s
[Step=19250 Epoch=36.3] | Loss=0.00584 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.665 | L2-Norm(final)=2.661 | 2998.1 samples/s | 46.8 steps/s
[Step=19300 Epoch=36.4] | Loss=0.00322 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.657 | L2-Norm(final)=2.662 | 3276.7 samples/s | 51.2 steps/s
[Step=19350 Epoch=36.5] | Loss=0.00238 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.652 | L2-Norm(final)=2.663 | 3289.3 samples/s | 51.4 steps/s
[Step=19400 Epoch=36.6] | Loss=0.00194 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.648 | L2-Norm(final)=2.664 | 3292.1 samples/s | 51.4 steps/s
[Step=19450 Epoch=36.7] | Loss=0.00157 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.646 | L2-Norm(final)=2.664 | 3310.0 samples/s | 51.7 steps/s
[Step=19500 Epoch=36.8] | Loss=0.00132 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.643 | L2-Norm(final)=2.665 | 3314.7 samples/s | 51.8 steps/s
[Step=19550 Epoch=36.9] | Loss=0.00114 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.641 | L2-Norm(final)=2.666 | 3305.3 samples/s | 51.6 steps/s
[Step=19600 Epoch=36.9] | Loss=0.00101 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.639 | L2-Norm(final)=2.667 | 3298.2 samples/s | 51.5 steps/s
[Step=19650 Epoch=37.0] | Loss=0.00090 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.637 | L2-Norm(final)=2.667 | 3301.5 samples/s | 51.6 steps/s
[Step=19700 Epoch=37.1] | Loss=0.00081 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.635 | L2-Norm(final)=2.668 | 3328.4 samples/s | 52.0 steps/s
[Step=19750 Epoch=37.2] | Loss=0.00074 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.633 | L2-Norm(final)=2.668 | 1677.4 samples/s | 26.2 steps/s
[Step=19800 Epoch=37.3] | Loss=0.00068 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.632 | L2-Norm(final)=2.669 | 3345.1 samples/s | 52.3 steps/s
[Step=19850 Epoch=37.4] | Loss=0.00063 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.630 | L2-Norm(final)=2.669 | 3286.0 samples/s | 51.3 steps/s
[Step=19900 Epoch=37.5] | Loss=0.00059 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.628 | L2-Norm(final)=2.669 | 3297.4 samples/s | 51.5 steps/s
[Step=19950 Epoch=37.6] | Loss=0.00055 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.627 | L2-Norm(final)=2.670 | 3288.3 samples/s | 51.4 steps/s
[Step=20000 Epoch=37.7] | Loss=0.00052 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.625 | L2-Norm(final)=2.670 | 3308.9 samples/s | 51.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17313 | acc=0.8875 | tpr=0.8439 | fpr=0.0178 | 3706.1 samples/s | 14.5 steps/s
Avg test loss: 0.17287, Avg test acc: 0.88661, Avg tpr: 0.84385, Avg fpr: 0.01936, total FA: 151

Testing server on iccad2012
[Step=  50] | Loss=0.49219 | acc=0.7842 | tpr=0.9956 | fpr=0.2196 | 3770.2 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.49537 | acc=0.7827 | tpr=0.9915 | fpr=0.2212 | 6614.6 samples/s | 25.8 steps/s
[Step= 150] | Loss=0.50078 | acc=0.7825 | tpr=0.9928 | fpr=0.2214 | 6776.9 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.50532 | acc=0.7815 | tpr=0.9945 | fpr=0.2224 | 7121.4 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.50592 | acc=0.7809 | tpr=0.9921 | fpr=0.2229 | 6628.9 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.50776 | acc=0.7809 | tpr=0.9898 | fpr=0.2229 | 6943.5 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.50845 | acc=0.7813 | tpr=0.9881 | fpr=0.2225 | 6752.9 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.50954 | acc=0.7806 | tpr=0.9863 | fpr=0.2232 | 6961.9 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.51342 | acc=0.7803 | tpr=0.9859 | fpr=0.2235 | 6504.1 samples/s | 25.4 steps/s
[Step= 500] | Loss=0.51293 | acc=0.7799 | tpr=0.9855 | fpr=0.2238 | 6659.8 samples/s | 26.0 steps/s
[Step= 550] | Loss=0.51147 | acc=0.7800 | tpr=0.9853 | fpr=0.2237 | 12775.3 samples/s | 49.9 steps/s
Avg test loss: 0.51166, Avg test acc: 0.78014, Avg tpr: 0.98534, Avg fpr: 0.22359, total FA: 31045

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=19.5] | Loss=0.05733 | Reg=0.00347 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.636 | L2-Norm(final)=2.679 | 3695.0 samples/s | 57.7 steps/s
[Step=20050 Epoch=19.6] | Loss=0.01917 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.614 | L2-Norm(final)=2.678 | 3369.7 samples/s | 52.7 steps/s
[Step=20100 Epoch=19.6] | Loss=0.01447 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.608 | L2-Norm(final)=2.681 | 3463.9 samples/s | 54.1 steps/s
[Step=20150 Epoch=19.7] | Loss=0.01305 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.605 | L2-Norm(final)=2.683 | 3438.8 samples/s | 53.7 steps/s
[Step=20200 Epoch=19.7] | Loss=0.01190 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.603 | L2-Norm(final)=2.686 | 3366.0 samples/s | 52.6 steps/s
[Step=20250 Epoch=19.8] | Loss=0.01212 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.602 | L2-Norm(final)=2.689 | 3467.4 samples/s | 54.2 steps/s
[Step=20300 Epoch=19.8] | Loss=0.01269 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.601 | L2-Norm(final)=2.690 | 3456.6 samples/s | 54.0 steps/s
[Step=20350 Epoch=19.9] | Loss=0.01258 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.600 | L2-Norm(final)=2.690 | 3466.2 samples/s | 54.2 steps/s
[Step=20400 Epoch=19.9] | Loss=0.01283 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.599 | L2-Norm(final)=2.691 | 3458.3 samples/s | 54.0 steps/s
[Step=20450 Epoch=20.0] | Loss=0.01222 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.599 | L2-Norm(final)=2.692 | 3483.5 samples/s | 54.4 steps/s
[Step=20500 Epoch=20.0] | Loss=0.01221 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.599 | L2-Norm(final)=2.693 | 3455.2 samples/s | 54.0 steps/s
[Step=20550 Epoch=20.1] | Loss=0.01249 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.599 | L2-Norm(final)=2.694 | 3452.8 samples/s | 53.9 steps/s
[Step=20600 Epoch=20.1] | Loss=0.01270 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.599 | L2-Norm(final)=2.694 | 3459.3 samples/s | 54.1 steps/s
[Step=20650 Epoch=20.2] | Loss=0.01272 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.599 | L2-Norm(final)=2.694 | 3440.7 samples/s | 53.8 steps/s
[Step=20700 Epoch=20.2] | Loss=0.01276 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.599 | L2-Norm(final)=2.695 | 3426.7 samples/s | 53.5 steps/s
[Step=20750 Epoch=20.3] | Loss=0.01285 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.599 | L2-Norm(final)=2.695 | 3476.7 samples/s | 54.3 steps/s
[Step=20800 Epoch=20.3] | Loss=0.01287 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.599 | L2-Norm(final)=2.696 | 3474.4 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step20800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=37.7] | Loss=0.20445 | Reg=0.00347 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.636 | L2-Norm(final)=2.678 | 3867.8 samples/s | 60.4 steps/s
[Step=20050 Epoch=37.8] | Loss=0.00692 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.601 | L2-Norm(final)=2.679 | 2973.0 samples/s | 46.5 steps/s
[Step=20100 Epoch=37.9] | Loss=0.00361 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.593 | L2-Norm(final)=2.679 | 3260.2 samples/s | 50.9 steps/s
[Step=20150 Epoch=38.0] | Loss=0.00246 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.588 | L2-Norm(final)=2.680 | 3288.1 samples/s | 51.4 steps/s
[Step=20200 Epoch=38.1] | Loss=0.00185 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.583 | L2-Norm(final)=2.681 | 3274.7 samples/s | 51.2 steps/s
[Step=20250 Epoch=38.2] | Loss=0.00149 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.579 | L2-Norm(final)=2.682 | 3280.3 samples/s | 51.3 steps/s
[Step=20300 Epoch=38.3] | Loss=0.00124 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.575 | L2-Norm(final)=2.682 | 3302.7 samples/s | 51.6 steps/s
[Step=20350 Epoch=38.4] | Loss=0.00107 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.572 | L2-Norm(final)=2.682 | 3299.7 samples/s | 51.6 steps/s
[Step=20400 Epoch=38.5] | Loss=0.00094 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.569 | L2-Norm(final)=2.683 | 3286.9 samples/s | 51.4 steps/s
[Step=20450 Epoch=38.5] | Loss=0.00084 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.567 | L2-Norm(final)=2.683 | 2966.5 samples/s | 46.4 steps/s
[Step=20500 Epoch=38.6] | Loss=0.00076 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.564 | L2-Norm(final)=2.684 | 2966.2 samples/s | 46.3 steps/s
[Step=20550 Epoch=38.7] | Loss=0.00069 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.562 | L2-Norm(final)=2.684 | 1586.0 samples/s | 24.8 steps/s
[Step=20600 Epoch=38.8] | Loss=0.00063 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.560 | L2-Norm(final)=2.684 | 3027.4 samples/s | 47.3 steps/s
[Step=20650 Epoch=38.9] | Loss=0.00059 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.558 | L2-Norm(final)=2.684 | 3045.6 samples/s | 47.6 steps/s
[Step=20700 Epoch=39.0] | Loss=0.00055 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.556 | L2-Norm(final)=2.684 | 3350.2 samples/s | 52.3 steps/s
[Step=20750 Epoch=39.1] | Loss=0.00051 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.554 | L2-Norm(final)=2.685 | 3362.2 samples/s | 52.5 steps/s
[Step=20800 Epoch=39.2] | Loss=0.00048 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.553 | L2-Norm(final)=2.685 | 3225.3 samples/s | 50.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24224 | acc=0.8407 | tpr=0.7749 | fpr=0.0164 | 3655.1 samples/s | 14.3 steps/s
Avg test loss: 0.24236, Avg test acc: 0.84045, Avg tpr: 0.77566, Avg fpr: 0.01705, total FA: 133

Testing server on iccad2012
[Step=  50] | Loss=0.33178 | acc=0.8549 | tpr=0.9956 | fpr=0.1476 | 3705.6 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.33524 | acc=0.8548 | tpr=0.9936 | fpr=0.1478 | 6564.6 samples/s | 25.6 steps/s
[Step= 150] | Loss=0.34157 | acc=0.8544 | tpr=0.9942 | fpr=0.1482 | 6899.2 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.34552 | acc=0.8539 | tpr=0.9945 | fpr=0.1486 | 6857.1 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.34579 | acc=0.8528 | tpr=0.9913 | fpr=0.1497 | 6549.0 samples/s | 25.6 steps/s
[Step= 300] | Loss=0.34843 | acc=0.8525 | tpr=0.9891 | fpr=0.1500 | 6906.0 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.34959 | acc=0.8524 | tpr=0.9869 | fpr=0.1501 | 6838.3 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.35066 | acc=0.8520 | tpr=0.9852 | fpr=0.1504 | 6696.9 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.35429 | acc=0.8513 | tpr=0.9849 | fpr=0.1511 | 5947.1 samples/s | 23.2 steps/s
[Step= 500] | Loss=0.35342 | acc=0.8514 | tpr=0.9846 | fpr=0.1510 | 6647.9 samples/s | 26.0 steps/s
[Step= 550] | Loss=0.35223 | acc=0.8520 | tpr=0.9845 | fpr=0.1504 | 11800.9 samples/s | 46.1 steps/s
Avg test loss: 0.35236, Avg test acc: 0.85205, Avg tpr: 0.98455, Avg fpr: 0.15036, total FA: 20877

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=20.3] | Loss=0.06397 | Reg=0.00344 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.555 | L2-Norm(final)=2.694 | 3571.4 samples/s | 55.8 steps/s
[Step=20850 Epoch=20.4] | Loss=0.02185 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.542 | L2-Norm(final)=2.691 | 3000.4 samples/s | 46.9 steps/s
[Step=20900 Epoch=20.4] | Loss=0.01634 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.538 | L2-Norm(final)=2.693 | 3070.8 samples/s | 48.0 steps/s
[Step=20950 Epoch=20.5] | Loss=0.01533 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.535 | L2-Norm(final)=2.695 | 3146.5 samples/s | 49.2 steps/s
[Step=21000 Epoch=20.5] | Loss=0.01380 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.532 | L2-Norm(final)=2.697 | 3176.7 samples/s | 49.6 steps/s
[Step=21050 Epoch=20.6] | Loss=0.01353 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.530 | L2-Norm(final)=2.698 | 3156.9 samples/s | 49.3 steps/s
[Step=21100 Epoch=20.6] | Loss=0.01316 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.529 | L2-Norm(final)=2.699 | 3455.8 samples/s | 54.0 steps/s
[Step=21150 Epoch=20.6] | Loss=0.01292 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.528 | L2-Norm(final)=2.700 | 3486.9 samples/s | 54.5 steps/s
[Step=21200 Epoch=20.7] | Loss=0.01308 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.527 | L2-Norm(final)=2.701 | 3476.6 samples/s | 54.3 steps/s
[Step=21250 Epoch=20.7] | Loss=0.01269 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.527 | L2-Norm(final)=2.702 | 3476.4 samples/s | 54.3 steps/s
[Step=21300 Epoch=20.8] | Loss=0.01232 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.527 | L2-Norm(final)=2.704 | 3477.1 samples/s | 54.3 steps/s
[Step=21350 Epoch=20.8] | Loss=0.01245 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.526 | L2-Norm(final)=2.705 | 3483.9 samples/s | 54.4 steps/s
[Step=21400 Epoch=20.9] | Loss=0.01260 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.526 | L2-Norm(final)=2.706 | 3469.8 samples/s | 54.2 steps/s
[Step=21450 Epoch=20.9] | Loss=0.01267 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.526 | L2-Norm(final)=2.707 | 3466.0 samples/s | 54.2 steps/s
[Step=21500 Epoch=21.0] | Loss=0.01281 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.526 | L2-Norm(final)=2.708 | 3454.3 samples/s | 54.0 steps/s
[Step=21550 Epoch=21.0] | Loss=0.01268 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.526 | L2-Norm(final)=2.708 | 3461.3 samples/s | 54.1 steps/s
[Step=21600 Epoch=21.1] | Loss=0.01261 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.526 | L2-Norm(final)=2.709 | 3460.1 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step21600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=39.2] | Loss=0.10422 | Reg=0.00344 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.555 | L2-Norm(final)=2.693 | 3917.7 samples/s | 61.2 steps/s
[Step=20850 Epoch=39.3] | Loss=0.00471 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.504 | L2-Norm(final)=2.694 | 3026.7 samples/s | 47.3 steps/s
[Step=20900 Epoch=39.4] | Loss=0.00239 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.495 | L2-Norm(final)=2.696 | 3307.1 samples/s | 51.7 steps/s
[Step=20950 Epoch=39.5] | Loss=0.00161 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.490 | L2-Norm(final)=2.697 | 3313.7 samples/s | 51.8 steps/s
[Step=21000 Epoch=39.6] | Loss=0.00121 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.485 | L2-Norm(final)=2.698 | 3305.1 samples/s | 51.6 steps/s
[Step=21050 Epoch=39.7] | Loss=0.00098 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.481 | L2-Norm(final)=2.698 | 3327.6 samples/s | 52.0 steps/s
[Step=21100 Epoch=39.8] | Loss=0.00083 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.478 | L2-Norm(final)=2.699 | 3325.4 samples/s | 52.0 steps/s
[Step=21150 Epoch=39.9] | Loss=0.00071 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.476 | L2-Norm(final)=2.699 | 3313.9 samples/s | 51.8 steps/s
[Step=21200 Epoch=40.0] | Loss=0.00063 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.473 | L2-Norm(final)=2.699 | 3326.6 samples/s | 52.0 steps/s
[Step=21250 Epoch=40.1] | Loss=0.00056 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.471 | L2-Norm(final)=2.700 | 3284.5 samples/s | 51.3 steps/s
[Step=21300 Epoch=40.2] | Loss=0.00050 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.469 | L2-Norm(final)=2.700 | 3332.6 samples/s | 52.1 steps/s
[Step=21350 Epoch=40.2] | Loss=0.00047 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.467 | L2-Norm(final)=2.700 | 1667.1 samples/s | 26.0 steps/s
[Step=21400 Epoch=40.3] | Loss=0.00043 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.465 | L2-Norm(final)=2.700 | 3335.4 samples/s | 52.1 steps/s
[Step=21450 Epoch=40.4] | Loss=0.00040 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.464 | L2-Norm(final)=2.701 | 3307.8 samples/s | 51.7 steps/s
[Step=21500 Epoch=40.5] | Loss=0.00037 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.462 | L2-Norm(final)=2.701 | 3299.5 samples/s | 51.6 steps/s
[Step=21550 Epoch=40.6] | Loss=0.00035 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.460 | L2-Norm(final)=2.701 | 3310.4 samples/s | 51.7 steps/s
[Step=21600 Epoch=40.7] | Loss=0.00033 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.459 | L2-Norm(final)=2.701 | 3295.5 samples/s | 51.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.15925 | acc=0.8978 | tpr=0.8585 | fpr=0.0168 | 3751.0 samples/s | 14.7 steps/s
Avg test loss: 0.15929, Avg test acc: 0.89679, Avg tpr: 0.85860, Avg fpr: 0.01923, total FA: 150

Testing server on iccad2012
[Step=  50] | Loss=0.50729 | acc=0.7782 | tpr=0.9912 | fpr=0.2256 | 3713.3 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.50871 | acc=0.7797 | tpr=0.9893 | fpr=0.2242 | 6881.7 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.51565 | acc=0.7792 | tpr=0.9914 | fpr=0.2247 | 6776.7 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.51949 | acc=0.7783 | tpr=0.9913 | fpr=0.2256 | 6871.1 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.52027 | acc=0.7776 | tpr=0.9895 | fpr=0.2263 | 7003.1 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.52223 | acc=0.7776 | tpr=0.9884 | fpr=0.2263 | 6586.7 samples/s | 25.7 steps/s
[Step= 350] | Loss=0.52305 | acc=0.7776 | tpr=0.9862 | fpr=0.2262 | 6776.0 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.52387 | acc=0.7772 | tpr=0.9858 | fpr=0.2266 | 6745.1 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.52706 | acc=0.7770 | tpr=0.9854 | fpr=0.2268 | 6765.8 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.52633 | acc=0.7767 | tpr=0.9850 | fpr=0.2270 | 6677.9 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.52487 | acc=0.7769 | tpr=0.9849 | fpr=0.2269 | 12933.9 samples/s | 50.5 steps/s
Avg test loss: 0.52511, Avg test acc: 0.77693, Avg tpr: 0.98494, Avg fpr: 0.22685, total FA: 31498

server round 27/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=21.1] | Loss=0.05816 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.474 | L2-Norm(final)=2.712 | 4039.2 samples/s | 63.1 steps/s
[Step=21650 Epoch=21.1] | Loss=0.01312 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.452 | L2-Norm(final)=2.718 | 3230.5 samples/s | 50.5 steps/s
[Step=21700 Epoch=21.2] | Loss=0.01143 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.447 | L2-Norm(final)=2.723 | 3419.1 samples/s | 53.4 steps/s
[Step=21750 Epoch=21.2] | Loss=0.01088 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.444 | L2-Norm(final)=2.724 | 3445.8 samples/s | 53.8 steps/s
[Step=21800 Epoch=21.3] | Loss=0.01123 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.442 | L2-Norm(final)=2.726 | 3454.9 samples/s | 54.0 steps/s
[Step=21850 Epoch=21.3] | Loss=0.01101 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.441 | L2-Norm(final)=2.727 | 3439.9 samples/s | 53.7 steps/s
[Step=21900 Epoch=21.4] | Loss=0.01143 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.440 | L2-Norm(final)=2.728 | 3435.7 samples/s | 53.7 steps/s
[Step=21950 Epoch=21.4] | Loss=0.01135 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.439 | L2-Norm(final)=2.729 | 3465.1 samples/s | 54.1 steps/s
[Step=22000 Epoch=21.5] | Loss=0.01139 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.439 | L2-Norm(final)=2.730 | 3385.7 samples/s | 52.9 steps/s
[Step=22050 Epoch=21.5] | Loss=0.01141 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.439 | L2-Norm(final)=2.731 | 3116.5 samples/s | 48.7 steps/s
[Step=22100 Epoch=21.6] | Loss=0.01137 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.439 | L2-Norm(final)=2.732 | 3280.8 samples/s | 51.3 steps/s
[Step=22150 Epoch=21.6] | Loss=0.01160 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.438 | L2-Norm(final)=2.732 | 3336.2 samples/s | 52.1 steps/s
[Step=22200 Epoch=21.7] | Loss=0.01144 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.438 | L2-Norm(final)=2.733 | 3362.6 samples/s | 52.5 steps/s
[Step=22250 Epoch=21.7] | Loss=0.01148 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.438 | L2-Norm(final)=2.733 | 3345.5 samples/s | 52.3 steps/s
[Step=22300 Epoch=21.8] | Loss=0.01161 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.438 | L2-Norm(final)=2.734 | 3320.2 samples/s | 51.9 steps/s
[Step=22350 Epoch=21.8] | Loss=0.01183 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.438 | L2-Norm(final)=2.734 | 3394.3 samples/s | 53.0 steps/s
[Step=22400 Epoch=21.9] | Loss=0.01170 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.438 | L2-Norm(final)=2.735 | 3448.1 samples/s | 53.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step22400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=40.7] | Loss=0.15405 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.474 | L2-Norm(final)=2.712 | 3817.5 samples/s | 59.6 steps/s
[Step=21650 Epoch=40.8] | Loss=0.00926 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.440 | L2-Norm(final)=2.707 | 3057.2 samples/s | 47.8 steps/s
[Step=21700 Epoch=40.9] | Loss=0.00467 | Reg=0.00340 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.434 | L2-Norm(final)=2.707 | 3297.6 samples/s | 51.5 steps/s
[Step=21750 Epoch=41.0] | Loss=0.00316 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.429 | L2-Norm(final)=2.707 | 3325.1 samples/s | 52.0 steps/s
[Step=21800 Epoch=41.1] | Loss=0.00238 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.424 | L2-Norm(final)=2.708 | 3316.3 samples/s | 51.8 steps/s
[Step=21850 Epoch=41.2] | Loss=0.00193 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.420 | L2-Norm(final)=2.708 | 3319.6 samples/s | 51.9 steps/s
[Step=21900 Epoch=41.3] | Loss=0.00162 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.417 | L2-Norm(final)=2.709 | 3311.8 samples/s | 51.7 steps/s
[Step=21950 Epoch=41.4] | Loss=0.00139 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.414 | L2-Norm(final)=2.710 | 3297.0 samples/s | 51.5 steps/s
[Step=22000 Epoch=41.5] | Loss=0.00122 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.412 | L2-Norm(final)=2.710 | 3302.3 samples/s | 51.6 steps/s
[Step=22050 Epoch=41.6] | Loss=0.00109 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.409 | L2-Norm(final)=2.711 | 3318.0 samples/s | 51.8 steps/s
[Step=22100 Epoch=41.7] | Loss=0.00098 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.407 | L2-Norm(final)=2.711 | 3339.3 samples/s | 52.2 steps/s
[Step=22150 Epoch=41.8] | Loss=0.00090 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.405 | L2-Norm(final)=2.711 | 1666.3 samples/s | 26.0 steps/s
[Step=22200 Epoch=41.8] | Loss=0.00082 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.402 | L2-Norm(final)=2.712 | 3325.4 samples/s | 52.0 steps/s
[Step=22250 Epoch=41.9] | Loss=0.00076 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.401 | L2-Norm(final)=2.712 | 3316.3 samples/s | 51.8 steps/s
[Step=22300 Epoch=42.0] | Loss=0.00071 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.399 | L2-Norm(final)=2.712 | 3296.7 samples/s | 51.5 steps/s
[Step=22350 Epoch=42.1] | Loss=0.00066 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.397 | L2-Norm(final)=2.713 | 3281.3 samples/s | 51.3 steps/s
[Step=22400 Epoch=42.2] | Loss=0.00062 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.395 | L2-Norm(final)=2.713 | 3299.4 samples/s | 51.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24186 | acc=0.8458 | tpr=0.7815 | fpr=0.0146 | 3728.3 samples/s | 14.6 steps/s
Avg test loss: 0.24136, Avg test acc: 0.84302, Avg tpr: 0.77898, Avg fpr: 0.01615, total FA: 126

Testing server on iccad2012
[Step=  50] | Loss=0.35146 | acc=0.8481 | tpr=0.9956 | fpr=0.1545 | 3697.5 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.35371 | acc=0.8497 | tpr=0.9936 | fpr=0.1530 | 6773.8 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.36046 | acc=0.8492 | tpr=0.9914 | fpr=0.1534 | 6925.3 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.36363 | acc=0.8490 | tpr=0.9923 | fpr=0.1536 | 6815.1 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.36396 | acc=0.8480 | tpr=0.9904 | fpr=0.1546 | 7024.8 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.36591 | acc=0.8481 | tpr=0.9891 | fpr=0.1544 | 6906.8 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.36648 | acc=0.8482 | tpr=0.9875 | fpr=0.1543 | 6646.9 samples/s | 26.0 steps/s
[Step= 400] | Loss=0.36723 | acc=0.8479 | tpr=0.9869 | fpr=0.1546 | 6780.2 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.37009 | acc=0.8476 | tpr=0.9864 | fpr=0.1549 | 6666.5 samples/s | 26.0 steps/s
[Step= 500] | Loss=0.36904 | acc=0.8478 | tpr=0.9859 | fpr=0.1546 | 6624.9 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.36746 | acc=0.8483 | tpr=0.9857 | fpr=0.1542 | 12781.3 samples/s | 49.9 steps/s
Avg test loss: 0.36754, Avg test acc: 0.84838, Avg tpr: 0.98574, Avg fpr: 0.15412, total FA: 21399

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=21.9] | Loss=0.13249 | Reg=0.00338 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.395 | L2-Norm(final)=2.730 | 3762.0 samples/s | 58.8 steps/s
[Step=22450 Epoch=21.9] | Loss=0.02045 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.379 | L2-Norm(final)=2.728 | 3324.1 samples/s | 51.9 steps/s
[Step=22500 Epoch=22.0] | Loss=0.01538 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.375 | L2-Norm(final)=2.730 | 3472.8 samples/s | 54.3 steps/s
[Step=22550 Epoch=22.0] | Loss=0.01443 | Reg=0.00338 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.373 | L2-Norm(final)=2.733 | 3478.5 samples/s | 54.4 steps/s
[Step=22600 Epoch=22.1] | Loss=0.01292 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.371 | L2-Norm(final)=2.735 | 3484.1 samples/s | 54.4 steps/s
[Step=22650 Epoch=22.1] | Loss=0.01254 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.370 | L2-Norm(final)=2.737 | 3461.2 samples/s | 54.1 steps/s
[Step=22700 Epoch=22.2] | Loss=0.01287 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.369 | L2-Norm(final)=2.738 | 3471.0 samples/s | 54.2 steps/s
[Step=22750 Epoch=22.2] | Loss=0.01266 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.369 | L2-Norm(final)=2.739 | 3415.2 samples/s | 53.4 steps/s
[Step=22800 Epoch=22.3] | Loss=0.01258 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.368 | L2-Norm(final)=2.740 | 3471.0 samples/s | 54.2 steps/s
[Step=22850 Epoch=22.3] | Loss=0.01250 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.368 | L2-Norm(final)=2.741 | 3496.0 samples/s | 54.6 steps/s
[Step=22900 Epoch=22.4] | Loss=0.01242 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.368 | L2-Norm(final)=2.742 | 3492.6 samples/s | 54.6 steps/s
[Step=22950 Epoch=22.4] | Loss=0.01264 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.368 | L2-Norm(final)=2.743 | 3502.0 samples/s | 54.7 steps/s
[Step=23000 Epoch=22.5] | Loss=0.01249 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.368 | L2-Norm(final)=2.744 | 3494.0 samples/s | 54.6 steps/s
[Step=23050 Epoch=22.5] | Loss=0.01261 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.368 | L2-Norm(final)=2.744 | 3472.2 samples/s | 54.3 steps/s
[Step=23100 Epoch=22.6] | Loss=0.01229 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.368 | L2-Norm(final)=2.745 | 3479.4 samples/s | 54.4 steps/s
[Step=23150 Epoch=22.6] | Loss=0.01221 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.368 | L2-Norm(final)=2.746 | 3498.5 samples/s | 54.7 steps/s
[Step=23200 Epoch=22.7] | Loss=0.01208 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.369 | L2-Norm(final)=2.747 | 3495.2 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step23200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=42.2] | Loss=0.05249 | Reg=0.00338 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.395 | L2-Norm(final)=2.731 | 3680.2 samples/s | 57.5 steps/s
[Step=22450 Epoch=42.3] | Loss=0.00597 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.354 | L2-Norm(final)=2.728 | 3224.1 samples/s | 50.4 steps/s
[Step=22500 Epoch=42.4] | Loss=0.00352 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.348 | L2-Norm(final)=2.729 | 3318.0 samples/s | 51.8 steps/s
[Step=22550 Epoch=42.5] | Loss=0.00254 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.344 | L2-Norm(final)=2.729 | 3307.0 samples/s | 51.7 steps/s
[Step=22600 Epoch=42.6] | Loss=0.00193 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.340 | L2-Norm(final)=2.730 | 3320.7 samples/s | 51.9 steps/s
[Step=22650 Epoch=42.7] | Loss=0.00155 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.337 | L2-Norm(final)=2.731 | 3304.4 samples/s | 51.6 steps/s
[Step=22700 Epoch=42.8] | Loss=0.00129 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.334 | L2-Norm(final)=2.731 | 3323.1 samples/s | 51.9 steps/s
[Step=22750 Epoch=42.9] | Loss=0.00112 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.331 | L2-Norm(final)=2.732 | 3330.4 samples/s | 52.0 steps/s
[Step=22800 Epoch=43.0] | Loss=0.00098 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.329 | L2-Norm(final)=2.732 | 3319.5 samples/s | 51.9 steps/s
[Step=22850 Epoch=43.1] | Loss=0.00088 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.327 | L2-Norm(final)=2.732 | 3288.2 samples/s | 51.4 steps/s
[Step=22900 Epoch=43.2] | Loss=0.00079 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.325 | L2-Norm(final)=2.733 | 3364.1 samples/s | 52.6 steps/s
[Step=22950 Epoch=43.3] | Loss=0.00072 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.323 | L2-Norm(final)=2.733 | 1698.0 samples/s | 26.5 steps/s
[Step=23000 Epoch=43.4] | Loss=0.00066 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.321 | L2-Norm(final)=2.733 | 3338.2 samples/s | 52.2 steps/s
[Step=23050 Epoch=43.4] | Loss=0.00061 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.319 | L2-Norm(final)=2.734 | 3309.9 samples/s | 51.7 steps/s
[Step=23100 Epoch=43.5] | Loss=0.00057 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.317 | L2-Norm(final)=2.734 | 3330.0 samples/s | 52.0 steps/s
[Step=23150 Epoch=43.6] | Loss=0.00053 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.315 | L2-Norm(final)=2.734 | 3300.0 samples/s | 51.6 steps/s
[Step=23200 Epoch=43.7] | Loss=0.00050 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.314 | L2-Norm(final)=2.734 | 3320.2 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20855 | acc=0.8695 | tpr=0.8172 | fpr=0.0171 | 3761.9 samples/s | 14.7 steps/s
Avg test loss: 0.20946, Avg test acc: 0.86802, Avg tpr: 0.81640, Avg fpr: 0.01846, total FA: 144

Testing server on iccad2012
[Step=  50] | Loss=0.42508 | acc=0.8245 | tpr=0.9956 | fpr=0.1785 | 3689.6 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.42669 | acc=0.8248 | tpr=0.9957 | fpr=0.1784 | 6829.5 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.43368 | acc=0.8227 | tpr=0.9914 | fpr=0.1804 | 6829.5 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.43708 | acc=0.8221 | tpr=0.9913 | fpr=0.1809 | 6750.3 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.43709 | acc=0.8215 | tpr=0.9886 | fpr=0.1816 | 7037.2 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.43935 | acc=0.8217 | tpr=0.9876 | fpr=0.1813 | 6688.4 samples/s | 26.1 steps/s
[Step= 350] | Loss=0.44022 | acc=0.8219 | tpr=0.9856 | fpr=0.1810 | 6932.5 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.44099 | acc=0.8218 | tpr=0.9858 | fpr=0.1812 | 6671.4 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.44454 | acc=0.8212 | tpr=0.9854 | fpr=0.1818 | 6802.7 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.44333 | acc=0.8212 | tpr=0.9850 | fpr=0.1818 | 6608.7 samples/s | 25.8 steps/s
[Step= 550] | Loss=0.44136 | acc=0.8216 | tpr=0.9853 | fpr=0.1813 | 13082.8 samples/s | 51.1 steps/s
Avg test loss: 0.44145, Avg test acc: 0.82172, Avg tpr: 0.98534, Avg fpr: 0.18126, total FA: 25167

server round 29/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=22.7] | Loss=0.12727 | Reg=0.00336 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.321 | L2-Norm(final)=2.749 | 3541.0 samples/s | 55.3 steps/s
[Step=23250 Epoch=22.7] | Loss=0.01615 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.304 | L2-Norm(final)=2.749 | 3447.6 samples/s | 53.9 steps/s
[Step=23300 Epoch=22.7] | Loss=0.01416 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.301 | L2-Norm(final)=2.751 | 3457.1 samples/s | 54.0 steps/s
[Step=23350 Epoch=22.8] | Loss=0.01382 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.298 | L2-Norm(final)=2.751 | 3470.2 samples/s | 54.2 steps/s
[Step=23400 Epoch=22.8] | Loss=0.01346 | Reg=0.00335 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.297 | L2-Norm(final)=2.753 | 3445.2 samples/s | 53.8 steps/s
[Step=23450 Epoch=22.9] | Loss=0.01346 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.297 | L2-Norm(final)=2.754 | 3458.8 samples/s | 54.0 steps/s
[Step=23500 Epoch=22.9] | Loss=0.01324 | Reg=0.00335 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.296 | L2-Norm(final)=2.755 | 3456.8 samples/s | 54.0 steps/s
[Step=23550 Epoch=23.0] | Loss=0.01285 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.295 | L2-Norm(final)=2.756 | 3446.7 samples/s | 53.9 steps/s
[Step=23600 Epoch=23.0] | Loss=0.01256 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.295 | L2-Norm(final)=2.757 | 3450.6 samples/s | 53.9 steps/s
[Step=23650 Epoch=23.1] | Loss=0.01212 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.295 | L2-Norm(final)=2.758 | 3441.1 samples/s | 53.8 steps/s
[Step=23700 Epoch=23.1] | Loss=0.01205 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.295 | L2-Norm(final)=2.759 | 3448.4 samples/s | 53.9 steps/s
[Step=23750 Epoch=23.2] | Loss=0.01213 | Reg=0.00335 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.294 | L2-Norm(final)=2.760 | 3454.6 samples/s | 54.0 steps/s
[Step=23800 Epoch=23.2] | Loss=0.01202 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.294 | L2-Norm(final)=2.761 | 3451.2 samples/s | 53.9 steps/s
[Step=23850 Epoch=23.3] | Loss=0.01188 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.294 | L2-Norm(final)=2.762 | 3455.2 samples/s | 54.0 steps/s
[Step=23900 Epoch=23.3] | Loss=0.01182 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.294 | L2-Norm(final)=2.763 | 3462.3 samples/s | 54.1 steps/s
[Step=23950 Epoch=23.4] | Loss=0.01198 | Reg=0.00335 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.294 | L2-Norm(final)=2.764 | 3434.7 samples/s | 53.7 steps/s
[Step=24000 Epoch=23.4] | Loss=0.01199 | Reg=0.00335 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.294 | L2-Norm(final)=2.765 | 3466.4 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step24000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=43.7] | Loss=0.02821 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.321 | L2-Norm(final)=2.750 | 3690.2 samples/s | 57.7 steps/s
[Step=23250 Epoch=43.8] | Loss=0.00350 | Reg=0.00334 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.282 | L2-Norm(final)=2.756 | 3066.6 samples/s | 47.9 steps/s
[Step=23300 Epoch=43.9] | Loss=0.00180 | Reg=0.00334 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.275 | L2-Norm(final)=2.757 | 3285.6 samples/s | 51.3 steps/s
[Step=23350 Epoch=44.0] | Loss=0.00121 | Reg=0.00334 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.270 | L2-Norm(final)=2.758 | 3294.9 samples/s | 51.5 steps/s
[Step=23400 Epoch=44.1] | Loss=0.00093 | Reg=0.00334 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.265 | L2-Norm(final)=2.759 | 3281.5 samples/s | 51.3 steps/s
[Step=23450 Epoch=44.2] | Loss=0.00075 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.261 | L2-Norm(final)=2.759 | 3294.1 samples/s | 51.5 steps/s
[Step=23500 Epoch=44.3] | Loss=0.00063 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.258 | L2-Norm(final)=2.760 | 3294.9 samples/s | 51.5 steps/s
[Step=23550 Epoch=44.4] | Loss=0.00054 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.255 | L2-Norm(final)=2.760 | 3304.8 samples/s | 51.6 steps/s
[Step=23600 Epoch=44.5] | Loss=0.00048 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.252 | L2-Norm(final)=2.760 | 3294.1 samples/s | 51.5 steps/s
[Step=23650 Epoch=44.6] | Loss=0.00043 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.250 | L2-Norm(final)=2.760 | 3295.4 samples/s | 51.5 steps/s
[Step=23700 Epoch=44.7] | Loss=0.00039 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.247 | L2-Norm(final)=2.760 | 3277.5 samples/s | 51.2 steps/s
[Step=23750 Epoch=44.8] | Loss=0.00035 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.245 | L2-Norm(final)=2.760 | 1679.2 samples/s | 26.2 steps/s
[Step=23800 Epoch=44.9] | Loss=0.00032 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.243 | L2-Norm(final)=2.761 | 3312.2 samples/s | 51.8 steps/s
[Step=23850 Epoch=45.0] | Loss=0.00030 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.241 | L2-Norm(final)=2.761 | 3305.7 samples/s | 51.7 steps/s
[Step=23900 Epoch=45.1] | Loss=0.00028 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.239 | L2-Norm(final)=2.761 | 3274.6 samples/s | 51.2 steps/s
[Step=23950 Epoch=45.1] | Loss=0.00026 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.238 | L2-Norm(final)=2.761 | 3292.9 samples/s | 51.5 steps/s
[Step=24000 Epoch=45.2] | Loss=0.00025 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.236 | L2-Norm(final)=2.761 | 3327.1 samples/s | 52.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19755 | acc=0.8770 | tpr=0.8275 | fpr=0.0156 | 3737.3 samples/s | 14.6 steps/s
Avg test loss: 0.19798, Avg test acc: 0.87491, Avg tpr: 0.82549, Avg fpr: 0.01641, total FA: 128

Testing server on iccad2012
[Step=  50] | Loss=0.43789 | acc=0.8187 | tpr=0.9912 | fpr=0.1843 | 3737.9 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.43944 | acc=0.8190 | tpr=0.9893 | fpr=0.1842 | 6693.3 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.44528 | acc=0.8173 | tpr=0.9856 | fpr=0.1858 | 6768.9 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.44893 | acc=0.8167 | tpr=0.9869 | fpr=0.1864 | 6834.1 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.44938 | acc=0.8163 | tpr=0.9852 | fpr=0.1868 | 6824.3 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.45130 | acc=0.8164 | tpr=0.9840 | fpr=0.1866 | 6932.4 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.45182 | acc=0.8168 | tpr=0.9825 | fpr=0.1862 | 6737.7 samples/s | 26.3 steps/s
[Step= 400] | Loss=0.45272 | acc=0.8162 | tpr=0.9825 | fpr=0.1868 | 6834.7 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.45628 | acc=0.8157 | tpr=0.9825 | fpr=0.1874 | 6637.6 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.45520 | acc=0.8156 | tpr=0.9824 | fpr=0.1874 | 6884.0 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.45362 | acc=0.8160 | tpr=0.9825 | fpr=0.1870 | 12266.6 samples/s | 47.9 steps/s
Avg test loss: 0.45381, Avg test acc: 0.81610, Avg tpr: 0.98257, Avg fpr: 0.18693, total FA: 25955

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=23.4] | Loss=0.08377 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.245 | L2-Norm(final)=2.769 | 3796.6 samples/s | 59.3 steps/s
[Step=24050 Epoch=23.5] | Loss=0.02532 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.228 | L2-Norm(final)=2.765 | 3168.9 samples/s | 49.5 steps/s
[Step=24100 Epoch=23.5] | Loss=0.01685 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.221 | L2-Norm(final)=2.765 | 3442.8 samples/s | 53.8 steps/s
[Step=24150 Epoch=23.6] | Loss=0.01337 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.218 | L2-Norm(final)=2.767 | 3455.3 samples/s | 54.0 steps/s
[Step=24200 Epoch=23.6] | Loss=0.01252 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.769 | 3459.9 samples/s | 54.1 steps/s
[Step=24250 Epoch=23.7] | Loss=0.01152 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.214 | L2-Norm(final)=2.771 | 3475.7 samples/s | 54.3 steps/s
[Step=24300 Epoch=23.7] | Loss=0.01119 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=2.772 | 3448.4 samples/s | 53.9 steps/s
[Step=24350 Epoch=23.8] | Loss=0.01088 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.774 | 3460.4 samples/s | 54.1 steps/s
[Step=24400 Epoch=23.8] | Loss=0.01032 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.775 | 3470.6 samples/s | 54.2 steps/s
[Step=24450 Epoch=23.9] | Loss=0.01002 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.211 | L2-Norm(final)=2.777 | 3490.1 samples/s | 54.5 steps/s
[Step=24500 Epoch=23.9] | Loss=0.00968 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.211 | L2-Norm(final)=2.778 | 3472.1 samples/s | 54.3 steps/s
[Step=24550 Epoch=24.0] | Loss=0.00964 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.210 | L2-Norm(final)=2.779 | 3496.3 samples/s | 54.6 steps/s
[Step=24600 Epoch=24.0] | Loss=0.00964 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.210 | L2-Norm(final)=2.780 | 3479.2 samples/s | 54.4 steps/s
[Step=24650 Epoch=24.1] | Loss=0.00972 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.209 | L2-Norm(final)=2.781 | 3482.9 samples/s | 54.4 steps/s
[Step=24700 Epoch=24.1] | Loss=0.00966 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.209 | L2-Norm(final)=2.782 | 3471.0 samples/s | 54.2 steps/s
[Step=24750 Epoch=24.2] | Loss=0.00950 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.209 | L2-Norm(final)=2.783 | 3478.7 samples/s | 54.4 steps/s
[Step=24800 Epoch=24.2] | Loss=0.00945 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.208 | L2-Norm(final)=2.784 | 3479.9 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step24800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=45.2] | Loss=0.17604 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.245 | L2-Norm(final)=2.769 | 4328.7 samples/s | 67.6 steps/s
[Step=24050 Epoch=45.3] | Loss=0.01194 | Reg=0.00331 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.200 | L2-Norm(final)=2.766 | 2954.7 samples/s | 46.2 steps/s
[Step=24100 Epoch=45.4] | Loss=0.00616 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.193 | L2-Norm(final)=2.767 | 3279.3 samples/s | 51.2 steps/s
[Step=24150 Epoch=45.5] | Loss=0.00414 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.188 | L2-Norm(final)=2.767 | 3312.5 samples/s | 51.8 steps/s
[Step=24200 Epoch=45.6] | Loss=0.00312 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.185 | L2-Norm(final)=2.767 | 3283.8 samples/s | 51.3 steps/s
[Step=24250 Epoch=45.7] | Loss=0.00251 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.182 | L2-Norm(final)=2.768 | 3304.3 samples/s | 51.6 steps/s
[Step=24300 Epoch=45.8] | Loss=0.00210 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.180 | L2-Norm(final)=2.768 | 3306.0 samples/s | 51.7 steps/s
[Step=24350 Epoch=45.9] | Loss=0.00180 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=2.768 | 3319.1 samples/s | 51.9 steps/s
[Step=24400 Epoch=46.0] | Loss=0.00158 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=2.769 | 3282.1 samples/s | 51.3 steps/s
[Step=24450 Epoch=46.1] | Loss=0.00141 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=2.769 | 3299.9 samples/s | 51.6 steps/s
[Step=24500 Epoch=46.2] | Loss=0.00127 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.173 | L2-Norm(final)=2.769 | 3325.5 samples/s | 52.0 steps/s
[Step=24550 Epoch=46.3] | Loss=0.00116 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.172 | L2-Norm(final)=2.769 | 1661.4 samples/s | 26.0 steps/s
[Step=24600 Epoch=46.4] | Loss=0.00106 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.171 | L2-Norm(final)=2.769 | 3346.1 samples/s | 52.3 steps/s
[Step=24650 Epoch=46.5] | Loss=0.00098 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.170 | L2-Norm(final)=2.770 | 3279.4 samples/s | 51.2 steps/s
[Step=24700 Epoch=46.6] | Loss=0.00091 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.168 | L2-Norm(final)=2.770 | 3292.8 samples/s | 51.4 steps/s
[Step=24750 Epoch=46.7] | Loss=0.00085 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.167 | L2-Norm(final)=2.770 | 3273.9 samples/s | 51.2 steps/s
[Step=24800 Epoch=46.7] | Loss=0.00080 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.166 | L2-Norm(final)=2.770 | 3289.1 samples/s | 51.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20090 | acc=0.8726 | tpr=0.8204 | fpr=0.0141 | 3668.6 samples/s | 14.3 steps/s
Avg test loss: 0.20082, Avg test acc: 0.87054, Avg tpr: 0.81902, Avg fpr: 0.01615, total FA: 126

Testing server on iccad2012
[Step=  50] | Loss=0.41242 | acc=0.8298 | tpr=0.9912 | fpr=0.1731 | 3702.6 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.41484 | acc=0.8314 | tpr=0.9936 | fpr=0.1717 | 6841.1 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.42132 | acc=0.8304 | tpr=0.9899 | fpr=0.1726 | 6825.9 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.42461 | acc=0.8297 | tpr=0.9902 | fpr=0.1732 | 6724.8 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.42483 | acc=0.8293 | tpr=0.9878 | fpr=0.1736 | 6847.0 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.42695 | acc=0.8293 | tpr=0.9869 | fpr=0.1736 | 6870.7 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.42751 | acc=0.8296 | tpr=0.9850 | fpr=0.1732 | 6787.7 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.42836 | acc=0.8291 | tpr=0.9852 | fpr=0.1737 | 6599.2 samples/s | 25.8 steps/s
[Step= 450] | Loss=0.43182 | acc=0.8286 | tpr=0.9849 | fpr=0.1743 | 6778.3 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.43079 | acc=0.8287 | tpr=0.9846 | fpr=0.1741 | 6870.8 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.42911 | acc=0.8291 | tpr=0.9845 | fpr=0.1737 | 12496.0 samples/s | 48.8 steps/s
Avg test loss: 0.42923, Avg test acc: 0.82920, Avg tpr: 0.98455, Avg fpr: 0.17363, total FA: 24108

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=24.2] | Loss=0.16860 | Reg=0.00330 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.172 | L2-Norm(final)=2.786 | 4045.6 samples/s | 63.2 steps/s
[Step=24850 Epoch=24.3] | Loss=0.02136 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.154 | L2-Norm(final)=2.785 | 3195.8 samples/s | 49.9 steps/s
[Step=24900 Epoch=24.3] | Loss=0.01503 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.148 | L2-Norm(final)=2.787 | 3419.4 samples/s | 53.4 steps/s
[Step=24950 Epoch=24.4] | Loss=0.01317 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.145 | L2-Norm(final)=2.788 | 3470.4 samples/s | 54.2 steps/s
[Step=25000 Epoch=24.4] | Loss=0.01181 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.143 | L2-Norm(final)=2.789 | 3475.6 samples/s | 54.3 steps/s
[Step=25050 Epoch=24.5] | Loss=0.01085 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.142 | L2-Norm(final)=2.791 | 3479.3 samples/s | 54.4 steps/s
[Step=25100 Epoch=24.5] | Loss=0.01065 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.141 | L2-Norm(final)=2.793 | 3479.3 samples/s | 54.4 steps/s
[Step=25150 Epoch=24.6] | Loss=0.01025 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.140 | L2-Norm(final)=2.794 | 3484.3 samples/s | 54.4 steps/s
[Step=25200 Epoch=24.6] | Loss=0.01005 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.140 | L2-Norm(final)=2.795 | 3464.6 samples/s | 54.1 steps/s
[Step=25250 Epoch=24.7] | Loss=0.00996 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.139 | L2-Norm(final)=2.796 | 3457.4 samples/s | 54.0 steps/s
[Step=25300 Epoch=24.7] | Loss=0.00992 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.139 | L2-Norm(final)=2.797 | 3475.4 samples/s | 54.3 steps/s
[Step=25350 Epoch=24.8] | Loss=0.00971 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.138 | L2-Norm(final)=2.799 | 3441.2 samples/s | 53.8 steps/s
[Step=25400 Epoch=24.8] | Loss=0.00958 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.138 | L2-Norm(final)=2.800 | 3465.5 samples/s | 54.1 steps/s
[Step=25450 Epoch=24.8] | Loss=0.00943 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.138 | L2-Norm(final)=2.801 | 3464.4 samples/s | 54.1 steps/s
[Step=25500 Epoch=24.9] | Loss=0.00958 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.138 | L2-Norm(final)=2.802 | 3462.9 samples/s | 54.1 steps/s
[Step=25550 Epoch=24.9] | Loss=0.00952 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.138 | L2-Norm(final)=2.803 | 3482.2 samples/s | 54.4 steps/s
[Step=25600 Epoch=25.0] | Loss=0.00954 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.137 | L2-Norm(final)=2.803 | 3457.0 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step25600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=46.8] | Loss=0.14161 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.172 | L2-Norm(final)=2.786 | 3764.6 samples/s | 58.8 steps/s
[Step=24850 Epoch=46.8] | Loss=0.00713 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.128 | L2-Norm(final)=2.786 | 3138.8 samples/s | 49.0 steps/s
[Step=24900 Epoch=46.9] | Loss=0.00359 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.119 | L2-Norm(final)=2.786 | 3290.7 samples/s | 51.4 steps/s
[Step=24950 Epoch=47.0] | Loss=0.00241 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.114 | L2-Norm(final)=2.787 | 3262.9 samples/s | 51.0 steps/s
[Step=25000 Epoch=47.1] | Loss=0.00183 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.110 | L2-Norm(final)=2.787 | 3321.8 samples/s | 51.9 steps/s
[Step=25050 Epoch=47.2] | Loss=0.00148 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.107 | L2-Norm(final)=2.787 | 3320.9 samples/s | 51.9 steps/s
[Step=25100 Epoch=47.3] | Loss=0.00124 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.105 | L2-Norm(final)=2.788 | 3344.4 samples/s | 52.3 steps/s
[Step=25150 Epoch=47.4] | Loss=0.00107 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.103 | L2-Norm(final)=2.788 | 3318.6 samples/s | 51.9 steps/s
[Step=25200 Epoch=47.5] | Loss=0.00094 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.101 | L2-Norm(final)=2.788 | 3323.8 samples/s | 51.9 steps/s
[Step=25250 Epoch=47.6] | Loss=0.00084 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.100 | L2-Norm(final)=2.789 | 3302.6 samples/s | 51.6 steps/s
[Step=25300 Epoch=47.7] | Loss=0.00076 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.098 | L2-Norm(final)=2.789 | 3334.6 samples/s | 52.1 steps/s
[Step=25350 Epoch=47.8] | Loss=0.00069 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.097 | L2-Norm(final)=2.789 | 1706.7 samples/s | 26.7 steps/s
[Step=25400 Epoch=47.9] | Loss=0.00064 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.095 | L2-Norm(final)=2.789 | 3310.3 samples/s | 51.7 steps/s
[Step=25450 Epoch=48.0] | Loss=0.00059 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.094 | L2-Norm(final)=2.789 | 3299.5 samples/s | 51.6 steps/s
[Step=25500 Epoch=48.1] | Loss=0.00055 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.093 | L2-Norm(final)=2.790 | 3302.8 samples/s | 51.6 steps/s
[Step=25550 Epoch=48.2] | Loss=0.00051 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.092 | L2-Norm(final)=2.790 | 3319.0 samples/s | 51.9 steps/s
[Step=25600 Epoch=48.3] | Loss=0.00048 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.091 | L2-Norm(final)=2.790 | 3282.3 samples/s | 51.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19619 | acc=0.8754 | tpr=0.8239 | fpr=0.0129 | 3707.3 samples/s | 14.5 steps/s
Avg test loss: 0.19673, Avg test acc: 0.87471, Avg tpr: 0.82433, Avg fpr: 0.01449, total FA: 113

Testing server on iccad2012
[Step=  50] | Loss=0.41888 | acc=0.8295 | tpr=0.9912 | fpr=0.1735 | 3752.5 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.42087 | acc=0.8312 | tpr=0.9915 | fpr=0.1718 | 6732.9 samples/s | 26.3 steps/s
[Step= 150] | Loss=0.42728 | acc=0.8305 | tpr=0.9885 | fpr=0.1724 | 6839.1 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.43098 | acc=0.8304 | tpr=0.9891 | fpr=0.1724 | 6797.5 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.43124 | acc=0.8295 | tpr=0.9860 | fpr=0.1733 | 6778.2 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.43378 | acc=0.8293 | tpr=0.9847 | fpr=0.1735 | 6842.9 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.43412 | acc=0.8297 | tpr=0.9831 | fpr=0.1731 | 6903.1 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.43482 | acc=0.8292 | tpr=0.9836 | fpr=0.1736 | 6627.9 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.43845 | acc=0.8288 | tpr=0.9834 | fpr=0.1740 | 6914.7 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.43721 | acc=0.8288 | tpr=0.9833 | fpr=0.1740 | 6821.2 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.43562 | acc=0.8290 | tpr=0.9829 | fpr=0.1738 | 12813.8 samples/s | 50.1 steps/s
Avg test loss: 0.43571, Avg test acc: 0.82908, Avg tpr: 0.98296, Avg fpr: 0.17372, total FA: 24121

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=25.0] | Loss=0.11803 | Reg=0.00328 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.100 | L2-Norm(final)=2.804 | 4081.4 samples/s | 63.8 steps/s
[Step=25650 Epoch=25.0] | Loss=0.01841 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.081 | L2-Norm(final)=2.804 | 3261.4 samples/s | 51.0 steps/s
[Step=25700 Epoch=25.1] | Loss=0.01302 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.075 | L2-Norm(final)=2.805 | 3436.8 samples/s | 53.7 steps/s
[Step=25750 Epoch=25.1] | Loss=0.01116 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.072 | L2-Norm(final)=2.806 | 3447.0 samples/s | 53.9 steps/s
[Step=25800 Epoch=25.2] | Loss=0.01030 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.070 | L2-Norm(final)=2.808 | 3461.8 samples/s | 54.1 steps/s
[Step=25850 Epoch=25.2] | Loss=0.01016 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.069 | L2-Norm(final)=2.809 | 3467.0 samples/s | 54.2 steps/s
[Step=25900 Epoch=25.3] | Loss=0.00992 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.068 | L2-Norm(final)=2.810 | 3454.0 samples/s | 54.0 steps/s
[Step=25950 Epoch=25.3] | Loss=0.00961 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.067 | L2-Norm(final)=2.812 | 3476.8 samples/s | 54.3 steps/s
[Step=26000 Epoch=25.4] | Loss=0.00944 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.066 | L2-Norm(final)=2.813 | 3490.8 samples/s | 54.5 steps/s
[Step=26050 Epoch=25.4] | Loss=0.00938 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.066 | L2-Norm(final)=2.814 | 3490.8 samples/s | 54.5 steps/s
[Step=26100 Epoch=25.5] | Loss=0.00927 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.065 | L2-Norm(final)=2.815 | 3483.6 samples/s | 54.4 steps/s
[Step=26150 Epoch=25.5] | Loss=0.00909 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.065 | L2-Norm(final)=2.816 | 3477.2 samples/s | 54.3 steps/s
[Step=26200 Epoch=25.6] | Loss=0.00899 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.065 | L2-Norm(final)=2.817 | 3483.5 samples/s | 54.4 steps/s
[Step=26250 Epoch=25.6] | Loss=0.00901 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.065 | L2-Norm(final)=2.818 | 3457.1 samples/s | 54.0 steps/s
[Step=26300 Epoch=25.7] | Loss=0.00883 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.064 | L2-Norm(final)=2.819 | 3471.3 samples/s | 54.2 steps/s
[Step=26350 Epoch=25.7] | Loss=0.00886 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.064 | L2-Norm(final)=2.820 | 3495.0 samples/s | 54.6 steps/s
[Step=26400 Epoch=25.8] | Loss=0.00884 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.064 | L2-Norm(final)=2.821 | 3440.2 samples/s | 53.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step26400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=48.3] | Loss=0.13182 | Reg=0.00328 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.100 | L2-Norm(final)=2.804 | 3758.0 samples/s | 58.7 steps/s
[Step=25650 Epoch=48.4] | Loss=0.00796 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.057 | L2-Norm(final)=2.805 | 3037.6 samples/s | 47.5 steps/s
[Step=25700 Epoch=48.4] | Loss=0.00405 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.049 | L2-Norm(final)=2.805 | 3289.2 samples/s | 51.4 steps/s
[Step=25750 Epoch=48.5] | Loss=0.00272 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.045 | L2-Norm(final)=2.806 | 3316.1 samples/s | 51.8 steps/s
[Step=25800 Epoch=48.6] | Loss=0.00206 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=2.806 | 3288.9 samples/s | 51.4 steps/s
[Step=25850 Epoch=48.7] | Loss=0.00166 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.039 | L2-Norm(final)=2.806 | 3300.1 samples/s | 51.6 steps/s
[Step=25900 Epoch=48.8] | Loss=0.00139 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.037 | L2-Norm(final)=2.807 | 3312.5 samples/s | 51.8 steps/s
[Step=25950 Epoch=48.9] | Loss=0.00119 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.035 | L2-Norm(final)=2.807 | 3287.8 samples/s | 51.4 steps/s
[Step=26000 Epoch=49.0] | Loss=0.00105 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.033 | L2-Norm(final)=2.807 | 3310.9 samples/s | 51.7 steps/s
[Step=26050 Epoch=49.1] | Loss=0.00093 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.032 | L2-Norm(final)=2.807 | 3297.5 samples/s | 51.5 steps/s
[Step=26100 Epoch=49.2] | Loss=0.00084 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.030 | L2-Norm(final)=2.808 | 3322.1 samples/s | 51.9 steps/s
[Step=26150 Epoch=49.3] | Loss=0.00077 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.029 | L2-Norm(final)=2.808 | 1704.8 samples/s | 26.6 steps/s
[Step=26200 Epoch=49.4] | Loss=0.00071 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.027 | L2-Norm(final)=2.808 | 3328.0 samples/s | 52.0 steps/s
[Step=26250 Epoch=49.5] | Loss=0.00065 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.026 | L2-Norm(final)=2.808 | 3293.4 samples/s | 51.5 steps/s
[Step=26300 Epoch=49.6] | Loss=0.00061 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.025 | L2-Norm(final)=2.808 | 3289.3 samples/s | 51.4 steps/s
[Step=26350 Epoch=49.7] | Loss=0.00057 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.024 | L2-Norm(final)=2.808 | 3313.6 samples/s | 51.8 steps/s
[Step=26400 Epoch=49.8] | Loss=0.00054 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.023 | L2-Norm(final)=2.808 | 3300.7 samples/s | 51.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21561 | acc=0.8673 | tpr=0.8125 | fpr=0.0136 | 3683.6 samples/s | 14.4 steps/s
Avg test loss: 0.21613, Avg test acc: 0.86541, Avg tpr: 0.81069, Avg fpr: 0.01423, total FA: 111

Testing server on iccad2012
[Step=  50] | Loss=0.40143 | acc=0.8447 | tpr=0.9912 | fpr=0.1579 | 3748.5 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.40467 | acc=0.8460 | tpr=0.9915 | fpr=0.1567 | 6624.9 samples/s | 25.9 steps/s
[Step= 150] | Loss=0.41088 | acc=0.8454 | tpr=0.9885 | fpr=0.1572 | 6876.3 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.41488 | acc=0.8447 | tpr=0.9891 | fpr=0.1579 | 5929.0 samples/s | 23.2 steps/s
[Step= 250] | Loss=0.41454 | acc=0.8437 | tpr=0.9869 | fpr=0.1589 | 5983.0 samples/s | 23.4 steps/s
[Step= 300] | Loss=0.41753 | acc=0.8437 | tpr=0.9855 | fpr=0.1588 | 6356.8 samples/s | 24.8 steps/s
[Step= 350] | Loss=0.41821 | acc=0.8439 | tpr=0.9837 | fpr=0.1586 | 6398.7 samples/s | 25.0 steps/s
[Step= 400] | Loss=0.41894 | acc=0.8436 | tpr=0.9841 | fpr=0.1590 | 6720.7 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.42268 | acc=0.8433 | tpr=0.9839 | fpr=0.1593 | 6620.3 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.42128 | acc=0.8432 | tpr=0.9833 | fpr=0.1593 | 6611.1 samples/s | 25.8 steps/s
[Step= 550] | Loss=0.41947 | acc=0.8435 | tpr=0.9833 | fpr=0.1590 | 12408.2 samples/s | 48.5 steps/s
Avg test loss: 0.41958, Avg test acc: 0.84358, Avg tpr: 0.98336, Avg fpr: 0.15897, total FA: 22072

server round 33/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=25.8] | Loss=0.06722 | Reg=0.00325 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.030 | L2-Norm(final)=2.823 | 3764.7 samples/s | 58.8 steps/s
[Step=26450 Epoch=25.8] | Loss=0.01791 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.011 | L2-Norm(final)=2.822 | 3327.2 samples/s | 52.0 steps/s
[Step=26500 Epoch=25.9] | Loss=0.01257 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.006 | L2-Norm(final)=2.823 | 3453.7 samples/s | 54.0 steps/s
[Step=26550 Epoch=25.9] | Loss=0.01107 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.003 | L2-Norm(final)=2.825 | 3453.9 samples/s | 54.0 steps/s
[Step=26600 Epoch=26.0] | Loss=0.01053 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.002 | L2-Norm(final)=2.826 | 3366.2 samples/s | 52.6 steps/s
[Step=26650 Epoch=26.0] | Loss=0.00989 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.001 | L2-Norm(final)=2.828 | 3382.9 samples/s | 52.9 steps/s
[Step=26700 Epoch=26.1] | Loss=0.00937 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.000 | L2-Norm(final)=2.830 | 3473.6 samples/s | 54.3 steps/s
[Step=26750 Epoch=26.1] | Loss=0.00939 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.999 | L2-Norm(final)=2.831 | 3495.4 samples/s | 54.6 steps/s
[Step=26800 Epoch=26.2] | Loss=0.00903 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.999 | L2-Norm(final)=2.832 | 3482.1 samples/s | 54.4 steps/s
[Step=26850 Epoch=26.2] | Loss=0.00882 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.998 | L2-Norm(final)=2.833 | 3473.4 samples/s | 54.3 steps/s
[Step=26900 Epoch=26.3] | Loss=0.00892 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.998 | L2-Norm(final)=2.835 | 3471.1 samples/s | 54.2 steps/s
[Step=26950 Epoch=26.3] | Loss=0.00876 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.997 | L2-Norm(final)=2.836 | 3472.8 samples/s | 54.3 steps/s
[Step=27000 Epoch=26.4] | Loss=0.00861 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.997 | L2-Norm(final)=2.836 | 3477.0 samples/s | 54.3 steps/s
[Step=27050 Epoch=26.4] | Loss=0.00860 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.997 | L2-Norm(final)=2.837 | 3415.4 samples/s | 53.4 steps/s
[Step=27100 Epoch=26.5] | Loss=0.00855 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.997 | L2-Norm(final)=2.838 | 3458.4 samples/s | 54.0 steps/s
[Step=27150 Epoch=26.5] | Loss=0.00858 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.996 | L2-Norm(final)=2.839 | 3431.2 samples/s | 53.6 steps/s
[Step=27200 Epoch=26.6] | Loss=0.00868 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.996 | L2-Norm(final)=2.840 | 3190.8 samples/s | 49.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step27200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=49.8] | Loss=0.06573 | Reg=0.00325 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.030 | L2-Norm(final)=2.823 | 3487.0 samples/s | 54.5 steps/s
[Step=26450 Epoch=49.9] | Loss=0.00846 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.989 | L2-Norm(final)=2.823 | 2985.1 samples/s | 46.6 steps/s
[Step=26500 Epoch=50.0] | Loss=0.00427 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.983 | L2-Norm(final)=2.823 | 3215.6 samples/s | 50.2 steps/s
[Step=26550 Epoch=50.0] | Loss=0.00287 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.978 | L2-Norm(final)=2.824 | 3244.0 samples/s | 50.7 steps/s
[Step=26600 Epoch=50.1] | Loss=0.00217 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.975 | L2-Norm(final)=2.824 | 3284.6 samples/s | 51.3 steps/s
[Step=26650 Epoch=50.2] | Loss=0.00174 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.972 | L2-Norm(final)=2.824 | 3244.3 samples/s | 50.7 steps/s
[Step=26700 Epoch=50.3] | Loss=0.00146 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.970 | L2-Norm(final)=2.825 | 3294.1 samples/s | 51.5 steps/s
[Step=26750 Epoch=50.4] | Loss=0.00125 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.968 | L2-Norm(final)=2.825 | 3305.0 samples/s | 51.6 steps/s
[Step=26800 Epoch=50.5] | Loss=0.00110 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.966 | L2-Norm(final)=2.825 | 3289.5 samples/s | 51.4 steps/s
[Step=26850 Epoch=50.6] | Loss=0.00098 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.964 | L2-Norm(final)=2.825 | 3318.6 samples/s | 51.9 steps/s
[Step=26900 Epoch=50.7] | Loss=0.00089 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.963 | L2-Norm(final)=2.826 | 3315.2 samples/s | 51.8 steps/s
[Step=26950 Epoch=50.8] | Loss=0.00081 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=2.826 | 1651.6 samples/s | 25.8 steps/s
[Step=27000 Epoch=50.9] | Loss=0.00074 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.960 | L2-Norm(final)=2.826 | 3338.9 samples/s | 52.2 steps/s
[Step=27050 Epoch=51.0] | Loss=0.00069 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.826 | 3253.7 samples/s | 50.8 steps/s
[Step=27100 Epoch=51.1] | Loss=0.00064 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.958 | L2-Norm(final)=2.826 | 3263.2 samples/s | 51.0 steps/s
[Step=27150 Epoch=51.2] | Loss=0.00060 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.956 | L2-Norm(final)=2.826 | 3283.5 samples/s | 51.3 steps/s
[Step=27200 Epoch=51.3] | Loss=0.00056 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.955 | L2-Norm(final)=2.826 | 3282.9 samples/s | 51.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21996 | acc=0.8647 | tpr=0.8092 | fpr=0.0149 | 3697.1 samples/s | 14.4 steps/s
Avg test loss: 0.21953, Avg test acc: 0.86353, Avg tpr: 0.80882, Avg fpr: 0.01615, total FA: 126

Testing server on iccad2012
[Step=  50] | Loss=0.38274 | acc=0.8554 | tpr=0.9912 | fpr=0.1470 | 3639.2 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.38527 | acc=0.8573 | tpr=0.9915 | fpr=0.1452 | 6834.5 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.39291 | acc=0.8565 | tpr=0.9885 | fpr=0.1459 | 6803.8 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.39682 | acc=0.8560 | tpr=0.9891 | fpr=0.1464 | 7013.9 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.39695 | acc=0.8553 | tpr=0.9860 | fpr=0.1470 | 6883.8 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.40025 | acc=0.8547 | tpr=0.9847 | fpr=0.1477 | 6923.7 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.40111 | acc=0.8547 | tpr=0.9843 | fpr=0.1476 | 6789.1 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.40208 | acc=0.8544 | tpr=0.9841 | fpr=0.1480 | 6694.4 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.40597 | acc=0.8539 | tpr=0.9839 | fpr=0.1484 | 6704.2 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.40459 | acc=0.8541 | tpr=0.9833 | fpr=0.1482 | 6895.7 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.40261 | acc=0.8544 | tpr=0.9829 | fpr=0.1479 | 12296.7 samples/s | 48.0 steps/s
Avg test loss: 0.40264, Avg test acc: 0.85453, Avg tpr: 0.98296, Avg fpr: 0.14781, total FA: 20523

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=26.6] | Loss=0.13094 | Reg=0.00323 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=17.961 | L2-Norm(final)=2.840 | 4436.5 samples/s | 69.3 steps/s
[Step=27250 Epoch=26.6] | Loss=0.01853 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.944 | L2-Norm(final)=2.839 | 2996.7 samples/s | 46.8 steps/s
[Step=27300 Epoch=26.7] | Loss=0.01302 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.938 | L2-Norm(final)=2.840 | 3448.4 samples/s | 53.9 steps/s
[Step=27350 Epoch=26.7] | Loss=0.01170 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.935 | L2-Norm(final)=2.841 | 3460.5 samples/s | 54.1 steps/s
[Step=27400 Epoch=26.8] | Loss=0.01081 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.933 | L2-Norm(final)=2.843 | 3445.9 samples/s | 53.8 steps/s
[Step=27450 Epoch=26.8] | Loss=0.00999 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.932 | L2-Norm(final)=2.844 | 3428.5 samples/s | 53.6 steps/s
[Step=27500 Epoch=26.8] | Loss=0.00983 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.931 | L2-Norm(final)=2.845 | 3464.6 samples/s | 54.1 steps/s
[Step=27550 Epoch=26.9] | Loss=0.00951 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.931 | L2-Norm(final)=2.846 | 3462.2 samples/s | 54.1 steps/s
[Step=27600 Epoch=26.9] | Loss=0.00918 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.930 | L2-Norm(final)=2.847 | 3461.6 samples/s | 54.1 steps/s
[Step=27650 Epoch=27.0] | Loss=0.00897 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.930 | L2-Norm(final)=2.848 | 3471.5 samples/s | 54.2 steps/s
[Step=27700 Epoch=27.0] | Loss=0.00874 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.929 | L2-Norm(final)=2.849 | 3478.4 samples/s | 54.4 steps/s
[Step=27750 Epoch=27.1] | Loss=0.00858 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.929 | L2-Norm(final)=2.850 | 3472.7 samples/s | 54.3 steps/s
[Step=27800 Epoch=27.1] | Loss=0.00836 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.928 | L2-Norm(final)=2.851 | 3474.1 samples/s | 54.3 steps/s
[Step=27850 Epoch=27.2] | Loss=0.00840 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.928 | L2-Norm(final)=2.852 | 3472.7 samples/s | 54.3 steps/s
[Step=27900 Epoch=27.2] | Loss=0.00845 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.928 | L2-Norm(final)=2.853 | 3417.2 samples/s | 53.4 steps/s
[Step=27950 Epoch=27.3] | Loss=0.00856 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.928 | L2-Norm(final)=2.854 | 3445.8 samples/s | 53.8 steps/s
[Step=28000 Epoch=27.3] | Loss=0.00867 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.928 | L2-Norm(final)=2.855 | 3472.1 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step28000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=51.3] | Loss=0.09033 | Reg=0.00323 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.961 | L2-Norm(final)=2.840 | 3630.7 samples/s | 56.7 steps/s
[Step=27250 Epoch=51.4] | Loss=0.00499 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.918 | L2-Norm(final)=2.842 | 3189.9 samples/s | 49.8 steps/s
[Step=27300 Epoch=51.5] | Loss=0.00260 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=2.842 | 3323.7 samples/s | 51.9 steps/s
[Step=27350 Epoch=51.6] | Loss=0.00176 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.908 | L2-Norm(final)=2.843 | 3314.5 samples/s | 51.8 steps/s
[Step=27400 Epoch=51.6] | Loss=0.00138 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.905 | L2-Norm(final)=2.843 | 3336.8 samples/s | 52.1 steps/s
[Step=27450 Epoch=51.7] | Loss=0.00111 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.902 | L2-Norm(final)=2.844 | 3326.1 samples/s | 52.0 steps/s
[Step=27500 Epoch=51.8] | Loss=0.00093 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.900 | L2-Norm(final)=2.844 | 3300.6 samples/s | 51.6 steps/s
[Step=27550 Epoch=51.9] | Loss=0.00080 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.898 | L2-Norm(final)=2.844 | 3312.3 samples/s | 51.8 steps/s
[Step=27600 Epoch=52.0] | Loss=0.00071 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.896 | L2-Norm(final)=2.844 | 3309.0 samples/s | 51.7 steps/s
[Step=27650 Epoch=52.1] | Loss=0.00063 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.894 | L2-Norm(final)=2.845 | 3304.6 samples/s | 51.6 steps/s
[Step=27700 Epoch=52.2] | Loss=0.00057 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.893 | L2-Norm(final)=2.845 | 3362.5 samples/s | 52.5 steps/s
[Step=27750 Epoch=52.3] | Loss=0.00052 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.891 | L2-Norm(final)=2.845 | 1673.5 samples/s | 26.1 steps/s
[Step=27800 Epoch=52.4] | Loss=0.00048 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.890 | L2-Norm(final)=2.845 | 3329.3 samples/s | 52.0 steps/s
[Step=27850 Epoch=52.5] | Loss=0.00045 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.889 | L2-Norm(final)=2.845 | 3300.5 samples/s | 51.6 steps/s
[Step=27900 Epoch=52.6] | Loss=0.00041 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.888 | L2-Norm(final)=2.845 | 3272.2 samples/s | 51.1 steps/s
[Step=27950 Epoch=52.7] | Loss=0.00039 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.887 | L2-Norm(final)=2.845 | 3282.6 samples/s | 51.3 steps/s
[Step=28000 Epoch=52.8] | Loss=0.00037 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.885 | L2-Norm(final)=2.846 | 3307.3 samples/s | 51.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20071 | acc=0.8780 | tpr=0.8277 | fpr=0.0129 | 3690.1 samples/s | 14.4 steps/s
Avg test loss: 0.20053, Avg test acc: 0.87787, Avg tpr: 0.82858, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.39305 | acc=0.8468 | tpr=0.9867 | fpr=0.1557 | 3734.2 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.39594 | acc=0.8472 | tpr=0.9851 | fpr=0.1554 | 6746.0 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.40281 | acc=0.8465 | tpr=0.9841 | fpr=0.1560 | 6800.2 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.40650 | acc=0.8456 | tpr=0.9858 | fpr=0.1569 | 6922.6 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.40692 | acc=0.8443 | tpr=0.9817 | fpr=0.1582 | 6743.0 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.40947 | acc=0.8443 | tpr=0.9811 | fpr=0.1582 | 6741.3 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.40979 | acc=0.8445 | tpr=0.9806 | fpr=0.1579 | 6941.6 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.41091 | acc=0.8441 | tpr=0.9798 | fpr=0.1584 | 6714.4 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.41477 | acc=0.8434 | tpr=0.9805 | fpr=0.1590 | 6631.7 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.41338 | acc=0.8434 | tpr=0.9802 | fpr=0.1590 | 6921.2 samples/s | 27.0 steps/s
[Step= 550] | Loss=0.41162 | acc=0.8439 | tpr=0.9805 | fpr=0.1586 | 12231.9 samples/s | 47.8 steps/s
Avg test loss: 0.41180, Avg test acc: 0.84396, Avg tpr: 0.98059, Avg fpr: 0.15852, total FA: 22010

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=27.3] | Loss=0.07450 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.891 | L2-Norm(final)=2.856 | 4162.8 samples/s | 65.0 steps/s
[Step=28050 Epoch=27.4] | Loss=0.01632 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=2.856 | 3124.9 samples/s | 48.8 steps/s
[Step=28100 Epoch=27.4] | Loss=0.01241 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.869 | L2-Norm(final)=2.858 | 3434.3 samples/s | 53.7 steps/s
[Step=28150 Epoch=27.5] | Loss=0.01071 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.867 | L2-Norm(final)=2.859 | 3452.8 samples/s | 53.9 steps/s
[Step=28200 Epoch=27.5] | Loss=0.01004 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.865 | L2-Norm(final)=2.861 | 3447.2 samples/s | 53.9 steps/s
[Step=28250 Epoch=27.6] | Loss=0.00929 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.864 | L2-Norm(final)=2.862 | 3456.0 samples/s | 54.0 steps/s
[Step=28300 Epoch=27.6] | Loss=0.00887 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.863 | L2-Norm(final)=2.863 | 3461.7 samples/s | 54.1 steps/s
[Step=28350 Epoch=27.7] | Loss=0.00880 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.863 | L2-Norm(final)=2.864 | 3474.4 samples/s | 54.3 steps/s
[Step=28400 Epoch=27.7] | Loss=0.00866 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.862 | L2-Norm(final)=2.866 | 3483.6 samples/s | 54.4 steps/s
[Step=28450 Epoch=27.8] | Loss=0.00842 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.862 | L2-Norm(final)=2.867 | 3486.3 samples/s | 54.5 steps/s
[Step=28500 Epoch=27.8] | Loss=0.00823 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.862 | L2-Norm(final)=2.868 | 3487.4 samples/s | 54.5 steps/s
[Step=28550 Epoch=27.9] | Loss=0.00846 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.861 | L2-Norm(final)=2.869 | 3474.1 samples/s | 54.3 steps/s
[Step=28600 Epoch=27.9] | Loss=0.00845 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.861 | L2-Norm(final)=2.870 | 3474.4 samples/s | 54.3 steps/s
[Step=28650 Epoch=28.0] | Loss=0.00843 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.861 | L2-Norm(final)=2.871 | 3470.9 samples/s | 54.2 steps/s
[Step=28700 Epoch=28.0] | Loss=0.00859 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.861 | L2-Norm(final)=2.872 | 3468.3 samples/s | 54.2 steps/s
[Step=28750 Epoch=28.1] | Loss=0.00851 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.860 | L2-Norm(final)=2.873 | 3424.2 samples/s | 53.5 steps/s
[Step=28800 Epoch=28.1] | Loss=0.00843 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.860 | L2-Norm(final)=2.873 | 3467.2 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step28800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=52.8] | Loss=0.08987 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.891 | L2-Norm(final)=2.856 | 3662.7 samples/s | 57.2 steps/s
[Step=28050 Epoch=52.9] | Loss=0.00715 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.852 | L2-Norm(final)=2.856 | 3178.4 samples/s | 49.7 steps/s
[Step=28100 Epoch=53.0] | Loss=0.00361 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.846 | L2-Norm(final)=2.857 | 3297.4 samples/s | 51.5 steps/s
[Step=28150 Epoch=53.1] | Loss=0.00242 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.842 | L2-Norm(final)=2.857 | 3309.6 samples/s | 51.7 steps/s
[Step=28200 Epoch=53.2] | Loss=0.00183 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.838 | L2-Norm(final)=2.857 | 3282.1 samples/s | 51.3 steps/s
[Step=28250 Epoch=53.3] | Loss=0.00147 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.836 | L2-Norm(final)=2.858 | 3291.5 samples/s | 51.4 steps/s
[Step=28300 Epoch=53.3] | Loss=0.00123 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.833 | L2-Norm(final)=2.858 | 3323.8 samples/s | 51.9 steps/s
[Step=28350 Epoch=53.4] | Loss=0.00106 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.831 | L2-Norm(final)=2.858 | 3302.9 samples/s | 51.6 steps/s
[Step=28400 Epoch=53.5] | Loss=0.00093 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.830 | L2-Norm(final)=2.858 | 3308.1 samples/s | 51.7 steps/s
[Step=28450 Epoch=53.6] | Loss=0.00083 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=2.859 | 3316.8 samples/s | 51.8 steps/s
[Step=28500 Epoch=53.7] | Loss=0.00075 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.826 | L2-Norm(final)=2.859 | 3347.4 samples/s | 52.3 steps/s
[Step=28550 Epoch=53.8] | Loss=0.00068 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.825 | L2-Norm(final)=2.859 | 1681.3 samples/s | 26.3 steps/s
[Step=28600 Epoch=53.9] | Loss=0.00063 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.824 | L2-Norm(final)=2.859 | 3303.1 samples/s | 51.6 steps/s
[Step=28650 Epoch=54.0] | Loss=0.00058 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.822 | L2-Norm(final)=2.859 | 3281.2 samples/s | 51.3 steps/s
[Step=28700 Epoch=54.1] | Loss=0.00054 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.821 | L2-Norm(final)=2.860 | 3305.2 samples/s | 51.6 steps/s
[Step=28750 Epoch=54.2] | Loss=0.00051 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.820 | L2-Norm(final)=2.860 | 3265.7 samples/s | 51.0 steps/s
[Step=28800 Epoch=54.3] | Loss=0.00048 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.819 | L2-Norm(final)=2.860 | 3314.3 samples/s | 51.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24958 | acc=0.8506 | tpr=0.7865 | fpr=0.0102 | 3747.9 samples/s | 14.6 steps/s
Avg test loss: 0.25015, Avg test acc: 0.84999, Avg tpr: 0.78726, Avg fpr: 0.01205, total FA: 94

Testing server on iccad2012
[Step=  50] | Loss=0.36474 | acc=0.8648 | tpr=0.9867 | fpr=0.1373 | 3687.5 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.36951 | acc=0.8659 | tpr=0.9872 | fpr=0.1364 | 6972.1 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.37704 | acc=0.8653 | tpr=0.9856 | fpr=0.1369 | 6655.5 samples/s | 26.0 steps/s
[Step= 200] | Loss=0.38094 | acc=0.8645 | tpr=0.9858 | fpr=0.1377 | 6906.2 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.38057 | acc=0.8638 | tpr=0.9825 | fpr=0.1384 | 6920.5 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.38403 | acc=0.8636 | tpr=0.9818 | fpr=0.1386 | 6691.1 samples/s | 26.1 steps/s
[Step= 350] | Loss=0.38505 | acc=0.8637 | tpr=0.9818 | fpr=0.1384 | 6921.5 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.38608 | acc=0.8632 | tpr=0.9819 | fpr=0.1389 | 6686.6 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.39010 | acc=0.8626 | tpr=0.9825 | fpr=0.1396 | 6778.8 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.38840 | acc=0.8630 | tpr=0.9819 | fpr=0.1391 | 6836.8 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.38643 | acc=0.8635 | tpr=0.9817 | fpr=0.1387 | 12601.8 samples/s | 49.2 steps/s
Avg test loss: 0.38653, Avg test acc: 0.86354, Avg tpr: 0.98177, Avg fpr: 0.13861, total FA: 19246

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=28.1] | Loss=0.18015 | Reg=0.00318 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=17.824 | L2-Norm(final)=2.872 | 3831.1 samples/s | 59.9 steps/s
[Step=28850 Epoch=28.2] | Loss=0.01995 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.809 | L2-Norm(final)=2.871 | 3362.7 samples/s | 52.5 steps/s
[Step=28900 Epoch=28.2] | Loss=0.01332 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.804 | L2-Norm(final)=2.871 | 3460.0 samples/s | 54.1 steps/s
[Step=28950 Epoch=28.3] | Loss=0.01132 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.801 | L2-Norm(final)=2.873 | 3450.8 samples/s | 53.9 steps/s
[Step=29000 Epoch=28.3] | Loss=0.01015 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.799 | L2-Norm(final)=2.874 | 3476.5 samples/s | 54.3 steps/s
[Step=29050 Epoch=28.4] | Loss=0.00937 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.798 | L2-Norm(final)=2.876 | 3479.9 samples/s | 54.4 steps/s
[Step=29100 Epoch=28.4] | Loss=0.00925 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.797 | L2-Norm(final)=2.877 | 3479.9 samples/s | 54.4 steps/s
[Step=29150 Epoch=28.5] | Loss=0.00860 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=2.878 | 3471.6 samples/s | 54.2 steps/s
[Step=29200 Epoch=28.5] | Loss=0.00873 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=2.879 | 3483.8 samples/s | 54.4 steps/s
[Step=29250 Epoch=28.6] | Loss=0.00883 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.795 | L2-Norm(final)=2.880 | 3485.3 samples/s | 54.5 steps/s
[Step=29300 Epoch=28.6] | Loss=0.00858 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.795 | L2-Norm(final)=2.881 | 3492.0 samples/s | 54.6 steps/s
[Step=29350 Epoch=28.7] | Loss=0.00863 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.794 | L2-Norm(final)=2.882 | 3493.1 samples/s | 54.6 steps/s
[Step=29400 Epoch=28.7] | Loss=0.00855 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.794 | L2-Norm(final)=2.883 | 3496.8 samples/s | 54.6 steps/s
[Step=29450 Epoch=28.8] | Loss=0.00841 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.794 | L2-Norm(final)=2.883 | 3493.2 samples/s | 54.6 steps/s
[Step=29500 Epoch=28.8] | Loss=0.00841 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=2.884 | 3497.6 samples/s | 54.7 steps/s
[Step=29550 Epoch=28.9] | Loss=0.00838 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=2.885 | 3501.2 samples/s | 54.7 steps/s
[Step=29600 Epoch=28.9] | Loss=0.00845 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.793 | L2-Norm(final)=2.886 | 3491.3 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step29600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=54.3] | Loss=0.00769 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.824 | L2-Norm(final)=2.873 | 3555.7 samples/s | 55.6 steps/s
[Step=28850 Epoch=54.4] | Loss=0.00535 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.782 | L2-Norm(final)=2.873 | 3299.4 samples/s | 51.6 steps/s
[Step=28900 Epoch=54.5] | Loss=0.00273 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.775 | L2-Norm(final)=2.874 | 3333.1 samples/s | 52.1 steps/s
[Step=28950 Epoch=54.6] | Loss=0.00183 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.771 | L2-Norm(final)=2.874 | 3322.4 samples/s | 51.9 steps/s
[Step=29000 Epoch=54.7] | Loss=0.00138 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.767 | L2-Norm(final)=2.874 | 3336.5 samples/s | 52.1 steps/s
[Step=29050 Epoch=54.8] | Loss=0.00111 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.765 | L2-Norm(final)=2.875 | 3333.7 samples/s | 52.1 steps/s
[Step=29100 Epoch=54.9] | Loss=0.00093 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.763 | L2-Norm(final)=2.875 | 3339.0 samples/s | 52.2 steps/s
[Step=29150 Epoch=54.9] | Loss=0.00080 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.761 | L2-Norm(final)=2.875 | 3348.2 samples/s | 52.3 steps/s
[Step=29200 Epoch=55.0] | Loss=0.00070 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.759 | L2-Norm(final)=2.875 | 3352.1 samples/s | 52.4 steps/s
[Step=29250 Epoch=55.1] | Loss=0.00063 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.757 | L2-Norm(final)=2.875 | 3325.0 samples/s | 52.0 steps/s
[Step=29300 Epoch=55.2] | Loss=0.00057 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.756 | L2-Norm(final)=2.876 | 3358.9 samples/s | 52.5 steps/s
[Step=29350 Epoch=55.3] | Loss=0.00052 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.754 | L2-Norm(final)=2.876 | 1714.2 samples/s | 26.8 steps/s
[Step=29400 Epoch=55.4] | Loss=0.00048 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.753 | L2-Norm(final)=2.876 | 3338.4 samples/s | 52.2 steps/s
[Step=29450 Epoch=55.5] | Loss=0.00044 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.752 | L2-Norm(final)=2.876 | 3309.4 samples/s | 51.7 steps/s
[Step=29500 Epoch=55.6] | Loss=0.00041 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.750 | L2-Norm(final)=2.876 | 3324.0 samples/s | 51.9 steps/s
[Step=29550 Epoch=55.7] | Loss=0.00039 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.749 | L2-Norm(final)=2.876 | 3327.0 samples/s | 52.0 steps/s
[Step=29600 Epoch=55.8] | Loss=0.00036 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.748 | L2-Norm(final)=2.876 | 3310.5 samples/s | 51.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19656 | acc=0.8829 | tpr=0.8347 | fpr=0.0124 | 3727.3 samples/s | 14.6 steps/s
Avg test loss: 0.19692, Avg test acc: 0.88112, Avg tpr: 0.83325, Avg fpr: 0.01359, total FA: 106

Testing server on iccad2012
[Step=  50] | Loss=0.42159 | acc=0.8380 | tpr=0.9912 | fpr=0.1648 | 3707.1 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.42334 | acc=0.8399 | tpr=0.9936 | fpr=0.1630 | 6889.4 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.43114 | acc=0.8394 | tpr=0.9899 | fpr=0.1634 | 6739.5 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.43484 | acc=0.8390 | tpr=0.9891 | fpr=0.1637 | 6922.7 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.43492 | acc=0.8384 | tpr=0.9852 | fpr=0.1643 | 6933.0 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.43845 | acc=0.8383 | tpr=0.9840 | fpr=0.1643 | 6735.9 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.43900 | acc=0.8386 | tpr=0.9837 | fpr=0.1640 | 6748.8 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.43989 | acc=0.8382 | tpr=0.9830 | fpr=0.1644 | 6810.8 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.44386 | acc=0.8376 | tpr=0.9834 | fpr=0.1650 | 6683.7 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.44220 | acc=0.8378 | tpr=0.9828 | fpr=0.1648 | 6701.7 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.44025 | acc=0.8383 | tpr=0.9833 | fpr=0.1644 | 12631.8 samples/s | 49.3 steps/s
Avg test loss: 0.44039, Avg test acc: 0.83833, Avg tpr: 0.98336, Avg fpr: 0.16430, total FA: 22813

server round 37/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=28.9] | Loss=0.16523 | Reg=0.00315 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.756 | L2-Norm(final)=2.887 | 3801.3 samples/s | 59.4 steps/s
[Step=29650 Epoch=28.9] | Loss=0.02165 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.741 | L2-Norm(final)=2.885 | 3338.3 samples/s | 52.2 steps/s
[Step=29700 Epoch=29.0] | Loss=0.01358 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.737 | L2-Norm(final)=2.886 | 3461.2 samples/s | 54.1 steps/s
[Step=29750 Epoch=29.0] | Loss=0.01158 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.734 | L2-Norm(final)=2.887 | 3468.9 samples/s | 54.2 steps/s
[Step=29800 Epoch=29.1] | Loss=0.01044 | Reg=0.00314 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.733 | L2-Norm(final)=2.888 | 3492.8 samples/s | 54.6 steps/s
[Step=29850 Epoch=29.1] | Loss=0.00973 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.731 | L2-Norm(final)=2.889 | 3487.3 samples/s | 54.5 steps/s
[Step=29900 Epoch=29.2] | Loss=0.00929 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.730 | L2-Norm(final)=2.891 | 3497.3 samples/s | 54.6 steps/s
[Step=29950 Epoch=29.2] | Loss=0.00892 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.730 | L2-Norm(final)=2.892 | 3487.7 samples/s | 54.5 steps/s
[Step=30000 Epoch=29.3] | Loss=0.00902 | Reg=0.00314 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.729 | L2-Norm(final)=2.893 | 3493.6 samples/s | 54.6 steps/s
[Step=30050 Epoch=29.3] | Loss=0.00877 | Reg=0.00314 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.729 | L2-Norm(final)=2.894 | 3465.0 samples/s | 54.1 steps/s
[Step=30100 Epoch=29.4] | Loss=0.00890 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.728 | L2-Norm(final)=2.895 | 3497.6 samples/s | 54.6 steps/s
[Step=30150 Epoch=29.4] | Loss=0.00870 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.728 | L2-Norm(final)=2.896 | 3496.1 samples/s | 54.6 steps/s
[Step=30200 Epoch=29.5] | Loss=0.00854 | Reg=0.00314 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.727 | L2-Norm(final)=2.897 | 3507.3 samples/s | 54.8 steps/s
[Step=30250 Epoch=29.5] | Loss=0.00844 | Reg=0.00314 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.727 | L2-Norm(final)=2.898 | 3497.8 samples/s | 54.7 steps/s
[Step=30300 Epoch=29.6] | Loss=0.00845 | Reg=0.00314 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.727 | L2-Norm(final)=2.898 | 3492.1 samples/s | 54.6 steps/s
[Step=30350 Epoch=29.6] | Loss=0.00848 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.726 | L2-Norm(final)=2.899 | 3493.3 samples/s | 54.6 steps/s
[Step=30400 Epoch=29.7] | Loss=0.00850 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.726 | L2-Norm(final)=2.900 | 3502.3 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step30400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=55.8] | Loss=0.15120 | Reg=0.00315 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.756 | L2-Norm(final)=2.887 | 3782.4 samples/s | 59.1 steps/s
[Step=29650 Epoch=55.9] | Loss=0.00672 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.714 | L2-Norm(final)=2.887 | 3167.3 samples/s | 49.5 steps/s
[Step=29700 Epoch=56.0] | Loss=0.00339 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.707 | L2-Norm(final)=2.888 | 3288.5 samples/s | 51.4 steps/s
[Step=29750 Epoch=56.1] | Loss=0.00227 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.703 | L2-Norm(final)=2.888 | 3321.6 samples/s | 51.9 steps/s
[Step=29800 Epoch=56.2] | Loss=0.00171 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.700 | L2-Norm(final)=2.889 | 3311.5 samples/s | 51.7 steps/s
[Step=29850 Epoch=56.3] | Loss=0.00138 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.697 | L2-Norm(final)=2.889 | 3315.0 samples/s | 51.8 steps/s
[Step=29900 Epoch=56.4] | Loss=0.00115 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.695 | L2-Norm(final)=2.889 | 3329.7 samples/s | 52.0 steps/s
[Step=29950 Epoch=56.5] | Loss=0.00099 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.693 | L2-Norm(final)=2.889 | 3329.6 samples/s | 52.0 steps/s
[Step=30000 Epoch=56.6] | Loss=0.00087 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.691 | L2-Norm(final)=2.890 | 3334.5 samples/s | 52.1 steps/s
[Step=30050 Epoch=56.6] | Loss=0.00078 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.689 | L2-Norm(final)=2.890 | 3346.5 samples/s | 52.3 steps/s
[Step=30100 Epoch=56.7] | Loss=0.00070 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.688 | L2-Norm(final)=2.890 | 3345.1 samples/s | 52.3 steps/s
[Step=30150 Epoch=56.8] | Loss=0.00064 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.686 | L2-Norm(final)=2.890 | 1694.5 samples/s | 26.5 steps/s
[Step=30200 Epoch=56.9] | Loss=0.00059 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.685 | L2-Norm(final)=2.890 | 3331.1 samples/s | 52.0 steps/s
[Step=30250 Epoch=57.0] | Loss=0.00055 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.684 | L2-Norm(final)=2.890 | 3294.3 samples/s | 51.5 steps/s
[Step=30300 Epoch=57.1] | Loss=0.00051 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.682 | L2-Norm(final)=2.890 | 3306.8 samples/s | 51.7 steps/s
[Step=30350 Epoch=57.2] | Loss=0.00047 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.681 | L2-Norm(final)=2.891 | 3315.9 samples/s | 51.8 steps/s
[Step=30400 Epoch=57.3] | Loss=0.00045 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.680 | L2-Norm(final)=2.891 | 3316.5 samples/s | 51.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17186 | acc=0.8977 | tpr=0.8566 | fpr=0.0131 | 3692.1 samples/s | 14.4 steps/s
Avg test loss: 0.17217, Avg test acc: 0.89819, Avg tpr: 0.85848, Avg fpr: 0.01449, total FA: 113

Testing server on iccad2012
[Step=  50] | Loss=0.45391 | acc=0.8260 | tpr=0.9912 | fpr=0.1770 | 3733.4 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.45660 | acc=0.8273 | tpr=0.9872 | fpr=0.1756 | 6789.5 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.46340 | acc=0.8262 | tpr=0.9870 | fpr=0.1768 | 6783.0 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.46782 | acc=0.8260 | tpr=0.9869 | fpr=0.1769 | 6778.4 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.46782 | acc=0.8247 | tpr=0.9834 | fpr=0.1782 | 6782.2 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.47132 | acc=0.8251 | tpr=0.9825 | fpr=0.1778 | 6849.4 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.47187 | acc=0.8255 | tpr=0.9812 | fpr=0.1773 | 6954.8 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.47272 | acc=0.8252 | tpr=0.9809 | fpr=0.1776 | 6838.4 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.47687 | acc=0.8247 | tpr=0.9815 | fpr=0.1781 | 6748.8 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.47524 | acc=0.8249 | tpr=0.9811 | fpr=0.1779 | 6918.3 samples/s | 27.0 steps/s
[Step= 550] | Loss=0.47353 | acc=0.8252 | tpr=0.9809 | fpr=0.1776 | 11885.4 samples/s | 46.4 steps/s
Avg test loss: 0.47374, Avg test acc: 0.82528, Avg tpr: 0.98098, Avg fpr: 0.17755, total FA: 24653

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=29.7] | Loss=0.10219 | Reg=0.00313 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.688 | L2-Norm(final)=2.901 | 3780.0 samples/s | 59.1 steps/s
[Step=30450 Epoch=29.7] | Loss=0.01353 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.669 | L2-Norm(final)=2.900 | 3281.7 samples/s | 51.3 steps/s
[Step=30500 Epoch=29.8] | Loss=0.00972 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.664 | L2-Norm(final)=2.901 | 3463.1 samples/s | 54.1 steps/s
[Step=30550 Epoch=29.8] | Loss=0.00916 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.662 | L2-Norm(final)=2.903 | 3472.5 samples/s | 54.3 steps/s
[Step=30600 Epoch=29.9] | Loss=0.00885 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.660 | L2-Norm(final)=2.904 | 3482.6 samples/s | 54.4 steps/s
[Step=30650 Epoch=29.9] | Loss=0.00913 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.659 | L2-Norm(final)=2.905 | 3483.1 samples/s | 54.4 steps/s
[Step=30700 Epoch=30.0] | Loss=0.00870 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.658 | L2-Norm(final)=2.906 | 3490.6 samples/s | 54.5 steps/s
[Step=30750 Epoch=30.0] | Loss=0.00834 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.657 | L2-Norm(final)=2.907 | 3490.9 samples/s | 54.5 steps/s
[Step=30800 Epoch=30.1] | Loss=0.00832 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.657 | L2-Norm(final)=2.908 | 3491.6 samples/s | 54.6 steps/s
[Step=30850 Epoch=30.1] | Loss=0.00826 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.656 | L2-Norm(final)=2.909 | 3487.4 samples/s | 54.5 steps/s
[Step=30900 Epoch=30.2] | Loss=0.00806 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.656 | L2-Norm(final)=2.910 | 3461.4 samples/s | 54.1 steps/s
[Step=30950 Epoch=30.2] | Loss=0.00815 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.656 | L2-Norm(final)=2.911 | 3480.7 samples/s | 54.4 steps/s
[Step=31000 Epoch=30.3] | Loss=0.00792 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.656 | L2-Norm(final)=2.912 | 3492.9 samples/s | 54.6 steps/s
[Step=31050 Epoch=30.3] | Loss=0.00775 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.656 | L2-Norm(final)=2.913 | 3496.8 samples/s | 54.6 steps/s
[Step=31100 Epoch=30.4] | Loss=0.00768 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.656 | L2-Norm(final)=2.914 | 3492.6 samples/s | 54.6 steps/s
[Step=31150 Epoch=30.4] | Loss=0.00798 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.656 | L2-Norm(final)=2.915 | 3483.1 samples/s | 54.4 steps/s
[Step=31200 Epoch=30.5] | Loss=0.00793 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.656 | L2-Norm(final)=2.916 | 3499.1 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step31200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=57.3] | Loss=0.08012 | Reg=0.00313 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.688 | L2-Norm(final)=2.901 | 3813.2 samples/s | 59.6 steps/s
[Step=30450 Epoch=57.4] | Loss=0.00609 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.648 | L2-Norm(final)=2.903 | 3037.4 samples/s | 47.5 steps/s
[Step=30500 Epoch=57.5] | Loss=0.00310 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.641 | L2-Norm(final)=2.903 | 3293.6 samples/s | 51.5 steps/s
[Step=30550 Epoch=57.6] | Loss=0.00210 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.637 | L2-Norm(final)=2.904 | 3323.3 samples/s | 51.9 steps/s
[Step=30600 Epoch=57.7] | Loss=0.00158 | Reg=0.00311 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.634 | L2-Norm(final)=2.904 | 3312.6 samples/s | 51.8 steps/s
[Step=30650 Epoch=57.8] | Loss=0.00127 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.632 | L2-Norm(final)=2.905 | 3331.9 samples/s | 52.1 steps/s
[Step=30700 Epoch=57.9] | Loss=0.00107 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.630 | L2-Norm(final)=2.905 | 3315.2 samples/s | 51.8 steps/s
[Step=30750 Epoch=58.0] | Loss=0.00092 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=2.905 | 3321.1 samples/s | 51.9 steps/s
[Step=30800 Epoch=58.1] | Loss=0.00081 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.626 | L2-Norm(final)=2.905 | 3317.7 samples/s | 51.8 steps/s
[Step=30850 Epoch=58.2] | Loss=0.00072 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.624 | L2-Norm(final)=2.906 | 3314.2 samples/s | 51.8 steps/s
[Step=30900 Epoch=58.2] | Loss=0.00065 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.623 | L2-Norm(final)=2.906 | 3354.7 samples/s | 52.4 steps/s
[Step=30950 Epoch=58.3] | Loss=0.00059 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.622 | L2-Norm(final)=2.906 | 1742.2 samples/s | 27.2 steps/s
[Step=31000 Epoch=58.4] | Loss=0.00054 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.620 | L2-Norm(final)=2.906 | 3345.2 samples/s | 52.3 steps/s
[Step=31050 Epoch=58.5] | Loss=0.00050 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.619 | L2-Norm(final)=2.906 | 3321.3 samples/s | 51.9 steps/s
[Step=31100 Epoch=58.6] | Loss=0.00047 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.618 | L2-Norm(final)=2.906 | 3319.4 samples/s | 51.9 steps/s
[Step=31150 Epoch=58.7] | Loss=0.00044 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.617 | L2-Norm(final)=2.906 | 3326.0 samples/s | 52.0 steps/s
[Step=31200 Epoch=58.8] | Loss=0.00041 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.616 | L2-Norm(final)=2.906 | 3314.9 samples/s | 51.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22214 | acc=0.8682 | tpr=0.8125 | fpr=0.0109 | 3739.7 samples/s | 14.6 steps/s
Avg test loss: 0.22342, Avg test acc: 0.86706, Avg tpr: 0.81203, Avg fpr: 0.01192, total FA: 93

Testing server on iccad2012
[Step=  50] | Loss=0.36520 | acc=0.8611 | tpr=0.9912 | fpr=0.1412 | 3768.8 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.36975 | acc=0.8616 | tpr=0.9872 | fpr=0.1408 | 6791.1 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.37750 | acc=0.8612 | tpr=0.9870 | fpr=0.1411 | 6846.5 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.38142 | acc=0.8613 | tpr=0.9880 | fpr=0.1410 | 6897.3 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.38124 | acc=0.8607 | tpr=0.9843 | fpr=0.1415 | 6899.7 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.38428 | acc=0.8608 | tpr=0.9833 | fpr=0.1415 | 6879.8 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.38524 | acc=0.8609 | tpr=0.9818 | fpr=0.1413 | 7331.8 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.38606 | acc=0.8605 | tpr=0.9803 | fpr=0.1417 | 6232.8 samples/s | 24.3 steps/s
[Step= 450] | Loss=0.38999 | acc=0.8599 | tpr=0.9805 | fpr=0.1422 | 6680.6 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.38835 | acc=0.8602 | tpr=0.9802 | fpr=0.1419 | 7083.7 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.38657 | acc=0.8605 | tpr=0.9801 | fpr=0.1416 | 11922.2 samples/s | 46.6 steps/s
Avg test loss: 0.38671, Avg test acc: 0.86059, Avg tpr: 0.98019, Avg fpr: 0.14158, total FA: 19658

server round 39/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=30.5] | Loss=0.09532 | Reg=0.00311 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.621 | L2-Norm(final)=2.918 | 3814.0 samples/s | 59.6 steps/s
[Step=31250 Epoch=30.5] | Loss=0.01909 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.610 | L2-Norm(final)=2.917 | 3264.6 samples/s | 51.0 steps/s
[Step=31300 Epoch=30.6] | Loss=0.01306 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.605 | L2-Norm(final)=2.918 | 3470.7 samples/s | 54.2 steps/s
[Step=31350 Epoch=30.6] | Loss=0.01072 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.603 | L2-Norm(final)=2.919 | 3459.5 samples/s | 54.1 steps/s
[Step=31400 Epoch=30.7] | Loss=0.00961 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.601 | L2-Norm(final)=2.921 | 3479.8 samples/s | 54.4 steps/s
[Step=31450 Epoch=30.7] | Loss=0.00946 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.600 | L2-Norm(final)=2.922 | 3487.0 samples/s | 54.5 steps/s
[Step=31500 Epoch=30.8] | Loss=0.00916 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.600 | L2-Norm(final)=2.924 | 3493.9 samples/s | 54.6 steps/s
[Step=31550 Epoch=30.8] | Loss=0.00860 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.599 | L2-Norm(final)=2.925 | 3467.9 samples/s | 54.2 steps/s
[Step=31600 Epoch=30.9] | Loss=0.00837 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.599 | L2-Norm(final)=2.926 | 3495.2 samples/s | 54.6 steps/s
[Step=31650 Epoch=30.9] | Loss=0.00822 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.598 | L2-Norm(final)=2.927 | 3489.0 samples/s | 54.5 steps/s
[Step=31700 Epoch=30.9] | Loss=0.00827 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.598 | L2-Norm(final)=2.928 | 3498.6 samples/s | 54.7 steps/s
[Step=31750 Epoch=31.0] | Loss=0.00828 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.598 | L2-Norm(final)=2.929 | 3497.3 samples/s | 54.6 steps/s
[Step=31800 Epoch=31.0] | Loss=0.00830 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.597 | L2-Norm(final)=2.930 | 3489.2 samples/s | 54.5 steps/s
[Step=31850 Epoch=31.1] | Loss=0.00821 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.597 | L2-Norm(final)=2.930 | 3437.7 samples/s | 53.7 steps/s
[Step=31900 Epoch=31.1] | Loss=0.00810 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.597 | L2-Norm(final)=2.931 | 3496.9 samples/s | 54.6 steps/s
[Step=31950 Epoch=31.2] | Loss=0.00807 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.596 | L2-Norm(final)=2.932 | 3500.9 samples/s | 54.7 steps/s
[Step=32000 Epoch=31.2] | Loss=0.00809 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.596 | L2-Norm(final)=2.933 | 3496.1 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step32000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=58.8] | Loss=0.04232 | Reg=0.00311 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.621 | L2-Norm(final)=2.918 | 4961.4 samples/s | 77.5 steps/s
[Step=31250 Epoch=58.9] | Loss=0.00464 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.580 | L2-Norm(final)=2.919 | 2614.9 samples/s | 40.9 steps/s
[Step=31300 Epoch=59.0] | Loss=0.00235 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.573 | L2-Norm(final)=2.920 | 3303.8 samples/s | 51.6 steps/s
[Step=31350 Epoch=59.1] | Loss=0.00158 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.569 | L2-Norm(final)=2.920 | 3297.7 samples/s | 51.5 steps/s
[Step=31400 Epoch=59.2] | Loss=0.00119 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.566 | L2-Norm(final)=2.920 | 3307.6 samples/s | 51.7 steps/s
[Step=31450 Epoch=59.3] | Loss=0.00096 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.563 | L2-Norm(final)=2.921 | 3245.0 samples/s | 50.7 steps/s
[Step=31500 Epoch=59.4] | Loss=0.00081 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.561 | L2-Norm(final)=2.921 | 3326.4 samples/s | 52.0 steps/s
[Step=31550 Epoch=59.5] | Loss=0.00070 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.559 | L2-Norm(final)=2.921 | 3307.4 samples/s | 51.7 steps/s
[Step=31600 Epoch=59.6] | Loss=0.00061 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.557 | L2-Norm(final)=2.921 | 3316.9 samples/s | 51.8 steps/s
[Step=31650 Epoch=59.7] | Loss=0.00055 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.556 | L2-Norm(final)=2.921 | 3327.0 samples/s | 52.0 steps/s
[Step=31700 Epoch=59.8] | Loss=0.00049 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.554 | L2-Norm(final)=2.922 | 3344.2 samples/s | 52.3 steps/s
[Step=31750 Epoch=59.8] | Loss=0.00045 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.553 | L2-Norm(final)=2.922 | 1684.5 samples/s | 26.3 steps/s
[Step=31800 Epoch=59.9] | Loss=0.00042 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.551 | L2-Norm(final)=2.922 | 3311.2 samples/s | 51.7 steps/s
[Step=31850 Epoch=60.0] | Loss=0.00038 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.550 | L2-Norm(final)=2.922 | 3295.2 samples/s | 51.5 steps/s
[Step=31900 Epoch=60.1] | Loss=0.00036 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.549 | L2-Norm(final)=2.922 | 3313.1 samples/s | 51.8 steps/s
[Step=31950 Epoch=60.2] | Loss=0.00034 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.548 | L2-Norm(final)=2.922 | 3305.5 samples/s | 51.6 steps/s
[Step=32000 Epoch=60.3] | Loss=0.00032 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.547 | L2-Norm(final)=2.922 | 3318.7 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.16969 | acc=0.9009 | tpr=0.8617 | fpr=0.0141 | 3720.8 samples/s | 14.5 steps/s
Avg test loss: 0.17068, Avg test acc: 0.89951, Avg tpr: 0.86087, Avg fpr: 0.01551, total FA: 121

Testing server on iccad2012
[Step=  50] | Loss=0.45046 | acc=0.8305 | tpr=0.9912 | fpr=0.1723 | 3726.6 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.45304 | acc=0.8321 | tpr=0.9893 | fpr=0.1708 | 6965.1 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.46105 | acc=0.8315 | tpr=0.9885 | fpr=0.1714 | 6806.7 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.46554 | acc=0.8314 | tpr=0.9891 | fpr=0.1715 | 6902.0 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.46551 | acc=0.8307 | tpr=0.9843 | fpr=0.1721 | 6855.0 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.46843 | acc=0.8310 | tpr=0.9833 | fpr=0.1718 | 6929.9 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.46931 | acc=0.8314 | tpr=0.9825 | fpr=0.1714 | 6746.9 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.47020 | acc=0.8311 | tpr=0.9814 | fpr=0.1717 | 6953.1 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.47410 | acc=0.8305 | tpr=0.9820 | fpr=0.1722 | 6738.5 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.47234 | acc=0.8307 | tpr=0.9815 | fpr=0.1721 | 6717.9 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.47055 | acc=0.8310 | tpr=0.9809 | fpr=0.1718 | 12655.1 samples/s | 49.4 steps/s
Avg test loss: 0.47075, Avg test acc: 0.83102, Avg tpr: 0.98098, Avg fpr: 0.17171, total FA: 23841

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=31.2] | Loss=0.14089 | Reg=0.00308 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=17.557 | L2-Norm(final)=2.934 | 4180.7 samples/s | 65.3 steps/s
[Step=32050 Epoch=31.3] | Loss=0.01763 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.542 | L2-Norm(final)=2.934 | 3161.6 samples/s | 49.4 steps/s
[Step=32100 Epoch=31.3] | Loss=0.01233 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.537 | L2-Norm(final)=2.935 | 3460.7 samples/s | 54.1 steps/s
[Step=32150 Epoch=31.4] | Loss=0.01049 | Reg=0.00307 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.534 | L2-Norm(final)=2.936 | 3463.5 samples/s | 54.1 steps/s
[Step=32200 Epoch=31.4] | Loss=0.01009 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.532 | L2-Norm(final)=2.936 | 3419.0 samples/s | 53.4 steps/s
[Step=32250 Epoch=31.5] | Loss=0.00911 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.530 | L2-Norm(final)=2.937 | 3138.0 samples/s | 49.0 steps/s
[Step=32300 Epoch=31.5] | Loss=0.00871 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.529 | L2-Norm(final)=2.938 | 3129.2 samples/s | 48.9 steps/s
[Step=32350 Epoch=31.6] | Loss=0.00830 | Reg=0.00307 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.528 | L2-Norm(final)=2.938 | 3072.7 samples/s | 48.0 steps/s
[Step=32400 Epoch=31.6] | Loss=0.00796 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.528 | L2-Norm(final)=2.939 | 3103.9 samples/s | 48.5 steps/s
[Step=32450 Epoch=31.7] | Loss=0.00782 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.527 | L2-Norm(final)=2.940 | 3290.5 samples/s | 51.4 steps/s
[Step=32500 Epoch=31.7] | Loss=0.00761 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.527 | L2-Norm(final)=2.941 | 3374.7 samples/s | 52.7 steps/s
[Step=32550 Epoch=31.8] | Loss=0.00754 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.526 | L2-Norm(final)=2.942 | 3385.5 samples/s | 52.9 steps/s
[Step=32600 Epoch=31.8] | Loss=0.00756 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.526 | L2-Norm(final)=2.942 | 3406.1 samples/s | 53.2 steps/s
[Step=32650 Epoch=31.9] | Loss=0.00751 | Reg=0.00307 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.526 | L2-Norm(final)=2.943 | 3447.0 samples/s | 53.9 steps/s
[Step=32700 Epoch=31.9] | Loss=0.00746 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.526 | L2-Norm(final)=2.944 | 3450.0 samples/s | 53.9 steps/s
[Step=32750 Epoch=32.0] | Loss=0.00748 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.526 | L2-Norm(final)=2.945 | 3461.1 samples/s | 54.1 steps/s
[Step=32800 Epoch=32.0] | Loss=0.00736 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.525 | L2-Norm(final)=2.945 | 3469.2 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step32800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=60.3] | Loss=0.22708 | Reg=0.00308 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.557 | L2-Norm(final)=2.933 | 3871.2 samples/s | 60.5 steps/s
[Step=32050 Epoch=60.4] | Loss=0.00951 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.520 | L2-Norm(final)=2.934 | 3006.0 samples/s | 47.0 steps/s
[Step=32100 Epoch=60.5] | Loss=0.00479 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.512 | L2-Norm(final)=2.934 | 3270.0 samples/s | 51.1 steps/s
[Step=32150 Epoch=60.6] | Loss=0.00321 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.508 | L2-Norm(final)=2.934 | 3297.1 samples/s | 51.5 steps/s
[Step=32200 Epoch=60.7] | Loss=0.00242 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.505 | L2-Norm(final)=2.934 | 3298.9 samples/s | 51.5 steps/s
[Step=32250 Epoch=60.8] | Loss=0.00194 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.503 | L2-Norm(final)=2.935 | 3266.8 samples/s | 51.0 steps/s
[Step=32300 Epoch=60.9] | Loss=0.00162 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.501 | L2-Norm(final)=2.935 | 3298.4 samples/s | 51.5 steps/s
[Step=32350 Epoch=61.0] | Loss=0.00140 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.499 | L2-Norm(final)=2.935 | 3287.6 samples/s | 51.4 steps/s
[Step=32400 Epoch=61.1] | Loss=0.00123 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.498 | L2-Norm(final)=2.935 | 3293.4 samples/s | 51.5 steps/s
[Step=32450 Epoch=61.2] | Loss=0.00109 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.497 | L2-Norm(final)=2.935 | 3301.0 samples/s | 51.6 steps/s
[Step=32500 Epoch=61.3] | Loss=0.00099 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.496 | L2-Norm(final)=2.935 | 3332.9 samples/s | 52.1 steps/s
[Step=32550 Epoch=61.4] | Loss=0.00090 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.494 | L2-Norm(final)=2.935 | 1710.1 samples/s | 26.7 steps/s
[Step=32600 Epoch=61.5] | Loss=0.00083 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.493 | L2-Norm(final)=2.935 | 3354.3 samples/s | 52.4 steps/s
[Step=32650 Epoch=61.5] | Loss=0.00076 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.492 | L2-Norm(final)=2.935 | 3294.1 samples/s | 51.5 steps/s
[Step=32700 Epoch=61.6] | Loss=0.00071 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.491 | L2-Norm(final)=2.935 | 3232.8 samples/s | 50.5 steps/s
[Step=32750 Epoch=61.7] | Loss=0.00067 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.491 | L2-Norm(final)=2.936 | 2928.8 samples/s | 45.8 steps/s
[Step=32800 Epoch=61.8] | Loss=0.00063 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.490 | L2-Norm(final)=2.936 | 3147.0 samples/s | 49.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19469 | acc=0.8879 | tpr=0.8416 | fpr=0.0116 | 3692.1 samples/s | 14.4 steps/s
Avg test loss: 0.19604, Avg test acc: 0.88789, Avg tpr: 0.84275, Avg fpr: 0.01282, total FA: 100

Testing server on iccad2012
[Step=  50] | Loss=0.40897 | acc=0.8498 | tpr=0.9912 | fpr=0.1528 | 3743.7 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.41153 | acc=0.8511 | tpr=0.9872 | fpr=0.1514 | 6725.9 samples/s | 26.3 steps/s
[Step= 150] | Loss=0.41965 | acc=0.8504 | tpr=0.9856 | fpr=0.1520 | 6889.7 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.42422 | acc=0.8500 | tpr=0.9869 | fpr=0.1525 | 6801.6 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.42412 | acc=0.8492 | tpr=0.9825 | fpr=0.1532 | 7109.7 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.42740 | acc=0.8493 | tpr=0.9818 | fpr=0.1531 | 6626.8 samples/s | 25.9 steps/s
[Step= 350] | Loss=0.42851 | acc=0.8496 | tpr=0.9812 | fpr=0.1528 | 7032.0 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.42929 | acc=0.8493 | tpr=0.9809 | fpr=0.1531 | 6576.6 samples/s | 25.7 steps/s
[Step= 450] | Loss=0.43314 | acc=0.8489 | tpr=0.9815 | fpr=0.1536 | 6633.8 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.43115 | acc=0.8490 | tpr=0.9811 | fpr=0.1534 | 6745.8 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.42933 | acc=0.8494 | tpr=0.9801 | fpr=0.1530 | 12933.8 samples/s | 50.5 steps/s
Avg test loss: 0.42953, Avg test acc: 0.84950, Avg tpr: 0.98019, Avg fpr: 0.15287, total FA: 21226

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=32.0] | Loss=0.16203 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.497 | L2-Norm(final)=2.946 | 3937.7 samples/s | 61.5 steps/s
[Step=32850 Epoch=32.1] | Loss=0.02099 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.485 | L2-Norm(final)=2.945 | 3353.1 samples/s | 52.4 steps/s
[Step=32900 Epoch=32.1] | Loss=0.01441 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.479 | L2-Norm(final)=2.945 | 3443.1 samples/s | 53.8 steps/s
[Step=32950 Epoch=32.2] | Loss=0.01172 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.476 | L2-Norm(final)=2.946 | 3449.5 samples/s | 53.9 steps/s
[Step=33000 Epoch=32.2] | Loss=0.01024 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.473 | L2-Norm(final)=2.947 | 3453.6 samples/s | 54.0 steps/s
[Step=33050 Epoch=32.3] | Loss=0.00933 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.472 | L2-Norm(final)=2.947 | 3458.1 samples/s | 54.0 steps/s
[Step=33100 Epoch=32.3] | Loss=0.00866 | Reg=0.00305 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.471 | L2-Norm(final)=2.948 | 3492.8 samples/s | 54.6 steps/s
[Step=33150 Epoch=32.4] | Loss=0.00858 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.470 | L2-Norm(final)=2.949 | 3482.8 samples/s | 54.4 steps/s
[Step=33200 Epoch=32.4] | Loss=0.00811 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.470 | L2-Norm(final)=2.950 | 3497.1 samples/s | 54.6 steps/s
[Step=33250 Epoch=32.5] | Loss=0.00812 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.469 | L2-Norm(final)=2.951 | 3494.7 samples/s | 54.6 steps/s
[Step=33300 Epoch=32.5] | Loss=0.00780 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.469 | L2-Norm(final)=2.951 | 3494.5 samples/s | 54.6 steps/s
[Step=33350 Epoch=32.6] | Loss=0.00753 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.468 | L2-Norm(final)=2.952 | 3487.2 samples/s | 54.5 steps/s
[Step=33400 Epoch=32.6] | Loss=0.00729 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.468 | L2-Norm(final)=2.953 | 3482.1 samples/s | 54.4 steps/s
[Step=33450 Epoch=32.7] | Loss=0.00717 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=2.954 | 3470.9 samples/s | 54.2 steps/s
[Step=33500 Epoch=32.7] | Loss=0.00717 | Reg=0.00305 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.467 | L2-Norm(final)=2.954 | 3440.3 samples/s | 53.8 steps/s
[Step=33550 Epoch=32.8] | Loss=0.00705 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=2.955 | 3481.4 samples/s | 54.4 steps/s
[Step=33600 Epoch=32.8] | Loss=0.00699 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=2.956 | 3479.4 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step33600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=61.8] | Loss=0.12462 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.497 | L2-Norm(final)=2.946 | 4117.4 samples/s | 64.3 steps/s
[Step=32850 Epoch=61.9] | Loss=0.00777 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.462 | L2-Norm(final)=2.947 | 3001.0 samples/s | 46.9 steps/s
[Step=32900 Epoch=62.0] | Loss=0.00391 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.455 | L2-Norm(final)=2.946 | 3284.4 samples/s | 51.3 steps/s
[Step=32950 Epoch=62.1] | Loss=0.00263 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.451 | L2-Norm(final)=2.947 | 3296.9 samples/s | 51.5 steps/s
[Step=33000 Epoch=62.2] | Loss=0.00199 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.448 | L2-Norm(final)=2.947 | 3293.0 samples/s | 51.5 steps/s
[Step=33050 Epoch=62.3] | Loss=0.00160 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.446 | L2-Norm(final)=2.947 | 3303.6 samples/s | 51.6 steps/s
[Step=33100 Epoch=62.4] | Loss=0.00134 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.444 | L2-Norm(final)=2.947 | 3271.1 samples/s | 51.1 steps/s
[Step=33150 Epoch=62.5] | Loss=0.00115 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.442 | L2-Norm(final)=2.947 | 3313.4 samples/s | 51.8 steps/s
[Step=33200 Epoch=62.6] | Loss=0.00101 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.441 | L2-Norm(final)=2.947 | 3302.1 samples/s | 51.6 steps/s
[Step=33250 Epoch=62.7] | Loss=0.00090 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.439 | L2-Norm(final)=2.947 | 3292.7 samples/s | 51.4 steps/s
[Step=33300 Epoch=62.8] | Loss=0.00081 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.438 | L2-Norm(final)=2.948 | 3334.1 samples/s | 52.1 steps/s
[Step=33350 Epoch=62.9] | Loss=0.00074 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.437 | L2-Norm(final)=2.948 | 1687.6 samples/s | 26.4 steps/s
[Step=33400 Epoch=63.0] | Loss=0.00068 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.436 | L2-Norm(final)=2.948 | 3328.4 samples/s | 52.0 steps/s
[Step=33450 Epoch=63.1] | Loss=0.00063 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.435 | L2-Norm(final)=2.948 | 3306.8 samples/s | 51.7 steps/s
[Step=33500 Epoch=63.1] | Loss=0.00059 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.434 | L2-Norm(final)=2.948 | 3281.7 samples/s | 51.3 steps/s
[Step=33550 Epoch=63.2] | Loss=0.00055 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.433 | L2-Norm(final)=2.948 | 3299.4 samples/s | 51.6 steps/s
[Step=33600 Epoch=63.3] | Loss=0.00052 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.433 | L2-Norm(final)=2.948 | 3322.5 samples/s | 51.9 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19202 | acc=0.8912 | tpr=0.8462 | fpr=0.0109 | 3752.7 samples/s | 14.7 steps/s
Avg test loss: 0.19310, Avg test acc: 0.89102, Avg tpr: 0.84688, Avg fpr: 0.01192, total FA: 93

Testing server on iccad2012
[Step=  50] | Loss=0.41191 | acc=0.8516 | tpr=0.9912 | fpr=0.1509 | 3689.8 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.41477 | acc=0.8534 | tpr=0.9893 | fpr=0.1491 | 6885.5 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.42288 | acc=0.8528 | tpr=0.9885 | fpr=0.1497 | 6924.3 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.42770 | acc=0.8524 | tpr=0.9880 | fpr=0.1501 | 6678.0 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.42767 | acc=0.8517 | tpr=0.9834 | fpr=0.1507 | 6634.8 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.43120 | acc=0.8517 | tpr=0.9825 | fpr=0.1507 | 6892.7 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.43188 | acc=0.8520 | tpr=0.9825 | fpr=0.1504 | 6669.9 samples/s | 26.1 steps/s
[Step= 400] | Loss=0.43272 | acc=0.8518 | tpr=0.9809 | fpr=0.1505 | 6787.7 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.43682 | acc=0.8514 | tpr=0.9815 | fpr=0.1510 | 6929.4 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.43475 | acc=0.8516 | tpr=0.9811 | fpr=0.1507 | 6545.8 samples/s | 25.6 steps/s
[Step= 550] | Loss=0.43293 | acc=0.8519 | tpr=0.9813 | fpr=0.1504 | 12708.5 samples/s | 49.6 steps/s
Avg test loss: 0.43309, Avg test acc: 0.85198, Avg tpr: 0.98138, Avg fpr: 0.15037, total FA: 20879

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=32.8] | Loss=0.13178 | Reg=0.00304 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.439 | L2-Norm(final)=2.958 | 3924.3 samples/s | 61.3 steps/s
[Step=33650 Epoch=32.9] | Loss=0.01990 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.427 | L2-Norm(final)=2.958 | 3246.5 samples/s | 50.7 steps/s
[Step=33700 Epoch=32.9] | Loss=0.01337 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.422 | L2-Norm(final)=2.958 | 3455.3 samples/s | 54.0 steps/s
[Step=33750 Epoch=33.0] | Loss=0.01079 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.419 | L2-Norm(final)=2.959 | 3463.3 samples/s | 54.1 steps/s
[Step=33800 Epoch=33.0] | Loss=0.00955 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.417 | L2-Norm(final)=2.960 | 3461.1 samples/s | 54.1 steps/s
[Step=33850 Epoch=33.0] | Loss=0.00874 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.416 | L2-Norm(final)=2.961 | 3474.4 samples/s | 54.3 steps/s
[Step=33900 Epoch=33.1] | Loss=0.00861 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.415 | L2-Norm(final)=2.962 | 3434.8 samples/s | 53.7 steps/s
[Step=33950 Epoch=33.1] | Loss=0.00807 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.414 | L2-Norm(final)=2.963 | 3491.4 samples/s | 54.6 steps/s
[Step=34000 Epoch=33.2] | Loss=0.00765 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.414 | L2-Norm(final)=2.963 | 3478.1 samples/s | 54.3 steps/s
[Step=34050 Epoch=33.2] | Loss=0.00741 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.413 | L2-Norm(final)=2.964 | 3474.8 samples/s | 54.3 steps/s
[Step=34100 Epoch=33.3] | Loss=0.00734 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.413 | L2-Norm(final)=2.965 | 3463.0 samples/s | 54.1 steps/s
[Step=34150 Epoch=33.3] | Loss=0.00730 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.412 | L2-Norm(final)=2.966 | 3481.6 samples/s | 54.4 steps/s
[Step=34200 Epoch=33.4] | Loss=0.00718 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.412 | L2-Norm(final)=2.966 | 3482.4 samples/s | 54.4 steps/s
[Step=34250 Epoch=33.4] | Loss=0.00702 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.411 | L2-Norm(final)=2.967 | 3473.1 samples/s | 54.3 steps/s
[Step=34300 Epoch=33.5] | Loss=0.00697 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.411 | L2-Norm(final)=2.967 | 3480.8 samples/s | 54.4 steps/s
[Step=34350 Epoch=33.5] | Loss=0.00685 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.411 | L2-Norm(final)=2.968 | 3477.8 samples/s | 54.3 steps/s
[Step=34400 Epoch=33.6] | Loss=0.00696 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.410 | L2-Norm(final)=2.969 | 3470.3 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step34400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=63.3] | Loss=0.05405 | Reg=0.00304 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.439 | L2-Norm(final)=2.958 | 4005.4 samples/s | 62.6 steps/s
[Step=33650 Epoch=63.4] | Loss=0.00419 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.404 | L2-Norm(final)=2.960 | 3001.5 samples/s | 46.9 steps/s
[Step=33700 Epoch=63.5] | Loss=0.00212 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.397 | L2-Norm(final)=2.960 | 3318.1 samples/s | 51.8 steps/s
[Step=33750 Epoch=63.6] | Loss=0.00143 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.394 | L2-Norm(final)=2.960 | 3282.9 samples/s | 51.3 steps/s
[Step=33800 Epoch=63.7] | Loss=0.00109 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.391 | L2-Norm(final)=2.961 | 3321.4 samples/s | 51.9 steps/s
[Step=33850 Epoch=63.8] | Loss=0.00088 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.389 | L2-Norm(final)=2.961 | 3308.4 samples/s | 51.7 steps/s
[Step=33900 Epoch=63.9] | Loss=0.00074 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.387 | L2-Norm(final)=2.961 | 3308.7 samples/s | 51.7 steps/s
[Step=33950 Epoch=64.0] | Loss=0.00064 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.385 | L2-Norm(final)=2.961 | 3322.4 samples/s | 51.9 steps/s
[Step=34000 Epoch=64.1] | Loss=0.00057 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.384 | L2-Norm(final)=2.961 | 3241.1 samples/s | 50.6 steps/s
[Step=34050 Epoch=64.2] | Loss=0.00051 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.383 | L2-Norm(final)=2.961 | 3311.3 samples/s | 51.7 steps/s
[Step=34100 Epoch=64.3] | Loss=0.00046 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.381 | L2-Norm(final)=2.961 | 3351.0 samples/s | 52.4 steps/s
[Step=34150 Epoch=64.4] | Loss=0.00042 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.380 | L2-Norm(final)=2.961 | 1661.9 samples/s | 26.0 steps/s
[Step=34200 Epoch=64.5] | Loss=0.00039 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.379 | L2-Norm(final)=2.961 | 3333.0 samples/s | 52.1 steps/s
[Step=34250 Epoch=64.6] | Loss=0.00036 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.378 | L2-Norm(final)=2.962 | 3306.6 samples/s | 51.7 steps/s
[Step=34300 Epoch=64.7] | Loss=0.00034 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.377 | L2-Norm(final)=2.962 | 3293.1 samples/s | 51.5 steps/s
[Step=34350 Epoch=64.8] | Loss=0.00031 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.376 | L2-Norm(final)=2.962 | 3290.9 samples/s | 51.4 steps/s
[Step=34400 Epoch=64.8] | Loss=0.00030 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.376 | L2-Norm(final)=2.962 | 3292.6 samples/s | 51.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19130 | acc=0.8940 | tpr=0.8503 | fpr=0.0111 | 3684.5 samples/s | 14.4 steps/s
Avg test loss: 0.19208, Avg test acc: 0.89390, Avg tpr: 0.85126, Avg fpr: 0.01231, total FA: 96

Testing server on iccad2012
[Step=  50] | Loss=0.41012 | acc=0.8553 | tpr=0.9912 | fpr=0.1471 | 3723.3 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.41280 | acc=0.8560 | tpr=0.9851 | fpr=0.1464 | 6880.4 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.42070 | acc=0.8547 | tpr=0.9841 | fpr=0.1477 | 6745.9 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.42574 | acc=0.8543 | tpr=0.9847 | fpr=0.1480 | 6711.6 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.42590 | acc=0.8537 | tpr=0.9808 | fpr=0.1486 | 6869.5 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.42968 | acc=0.8538 | tpr=0.9804 | fpr=0.1485 | 6907.3 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.43055 | acc=0.8540 | tpr=0.9793 | fpr=0.1483 | 6775.6 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.43133 | acc=0.8538 | tpr=0.9781 | fpr=0.1485 | 6687.3 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.43550 | acc=0.8531 | tpr=0.9791 | fpr=0.1492 | 6727.2 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.43339 | acc=0.8535 | tpr=0.9789 | fpr=0.1488 | 6833.6 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.43167 | acc=0.8538 | tpr=0.9789 | fpr=0.1485 | 12401.6 samples/s | 48.4 steps/s
Avg test loss: 0.43187, Avg test acc: 0.85387, Avg tpr: 0.97900, Avg fpr: 0.14840, total FA: 20605

server round 43/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=33.6] | Loss=0.09849 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.381 | L2-Norm(final)=2.970 | 3883.2 samples/s | 60.7 steps/s
[Step=34450 Epoch=33.6] | Loss=0.01659 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.369 | L2-Norm(final)=2.970 | 3241.9 samples/s | 50.7 steps/s
[Step=34500 Epoch=33.7] | Loss=0.01134 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.363 | L2-Norm(final)=2.970 | 3454.1 samples/s | 54.0 steps/s
[Step=34550 Epoch=33.7] | Loss=0.00960 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.361 | L2-Norm(final)=2.971 | 3448.7 samples/s | 53.9 steps/s
[Step=34600 Epoch=33.8] | Loss=0.00853 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.359 | L2-Norm(final)=2.972 | 3438.7 samples/s | 53.7 steps/s
[Step=34650 Epoch=33.8] | Loss=0.00813 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.357 | L2-Norm(final)=2.973 | 3465.6 samples/s | 54.1 steps/s
[Step=34700 Epoch=33.9] | Loss=0.00761 | Reg=0.00301 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.356 | L2-Norm(final)=2.973 | 3454.2 samples/s | 54.0 steps/s
[Step=34750 Epoch=33.9] | Loss=0.00715 | Reg=0.00301 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.356 | L2-Norm(final)=2.974 | 3450.0 samples/s | 53.9 steps/s
[Step=34800 Epoch=34.0] | Loss=0.00708 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.355 | L2-Norm(final)=2.975 | 3475.8 samples/s | 54.3 steps/s
[Step=34850 Epoch=34.0] | Loss=0.00698 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.354 | L2-Norm(final)=2.976 | 3464.7 samples/s | 54.1 steps/s
[Step=34900 Epoch=34.1] | Loss=0.00690 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.354 | L2-Norm(final)=2.976 | 3467.9 samples/s | 54.2 steps/s
[Step=34950 Epoch=34.1] | Loss=0.00686 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.353 | L2-Norm(final)=2.977 | 3460.6 samples/s | 54.1 steps/s
[Step=35000 Epoch=34.2] | Loss=0.00674 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.353 | L2-Norm(final)=2.978 | 3444.7 samples/s | 53.8 steps/s
[Step=35050 Epoch=34.2] | Loss=0.00671 | Reg=0.00301 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.353 | L2-Norm(final)=2.978 | 3458.3 samples/s | 54.0 steps/s
[Step=35100 Epoch=34.3] | Loss=0.00676 | Reg=0.00301 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.352 | L2-Norm(final)=2.979 | 3461.8 samples/s | 54.1 steps/s
[Step=35150 Epoch=34.3] | Loss=0.00668 | Reg=0.00301 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.352 | L2-Norm(final)=2.980 | 3453.7 samples/s | 54.0 steps/s
[Step=35200 Epoch=34.4] | Loss=0.00665 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.352 | L2-Norm(final)=2.980 | 3415.4 samples/s | 53.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step35200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=64.8] | Loss=0.04616 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.381 | L2-Norm(final)=2.970 | 4062.6 samples/s | 63.5 steps/s
[Step=34450 Epoch=64.9] | Loss=0.00671 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.348 | L2-Norm(final)=2.971 | 3022.3 samples/s | 47.2 steps/s
[Step=34500 Epoch=65.0] | Loss=0.00337 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.341 | L2-Norm(final)=2.972 | 3312.6 samples/s | 51.8 steps/s
[Step=34550 Epoch=65.1] | Loss=0.00225 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.338 | L2-Norm(final)=2.972 | 3319.6 samples/s | 51.9 steps/s
[Step=34600 Epoch=65.2] | Loss=0.00169 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.335 | L2-Norm(final)=2.972 | 3315.2 samples/s | 51.8 steps/s
[Step=34650 Epoch=65.3] | Loss=0.00136 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.333 | L2-Norm(final)=2.972 | 3331.8 samples/s | 52.1 steps/s
[Step=34700 Epoch=65.4] | Loss=0.00113 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.331 | L2-Norm(final)=2.972 | 3330.5 samples/s | 52.0 steps/s
[Step=34750 Epoch=65.5] | Loss=0.00097 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.330 | L2-Norm(final)=2.972 | 3325.2 samples/s | 52.0 steps/s
[Step=34800 Epoch=65.6] | Loss=0.00085 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.328 | L2-Norm(final)=2.972 | 3331.0 samples/s | 52.0 steps/s
[Step=34850 Epoch=65.7] | Loss=0.00076 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.327 | L2-Norm(final)=2.972 | 3251.0 samples/s | 50.8 steps/s
[Step=34900 Epoch=65.8] | Loss=0.00069 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.326 | L2-Norm(final)=2.972 | 3319.7 samples/s | 51.9 steps/s
[Step=34950 Epoch=65.9] | Loss=0.00062 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.325 | L2-Norm(final)=2.972 | 1713.5 samples/s | 26.8 steps/s
[Step=35000 Epoch=66.0] | Loss=0.00057 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.324 | L2-Norm(final)=2.972 | 3262.8 samples/s | 51.0 steps/s
[Step=35050 Epoch=66.1] | Loss=0.00053 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.323 | L2-Norm(final)=2.972 | 3215.1 samples/s | 50.2 steps/s
[Step=35100 Epoch=66.2] | Loss=0.00049 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.322 | L2-Norm(final)=2.972 | 3217.9 samples/s | 50.3 steps/s
[Step=35150 Epoch=66.3] | Loss=0.00046 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.321 | L2-Norm(final)=2.973 | 3208.5 samples/s | 50.1 steps/s
[Step=35200 Epoch=66.4] | Loss=0.00043 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.320 | L2-Norm(final)=2.973 | 3209.2 samples/s | 50.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22281 | acc=0.8762 | tpr=0.8241 | fpr=0.0104 | 3708.3 samples/s | 14.5 steps/s
Avg test loss: 0.22435, Avg test acc: 0.87579, Avg tpr: 0.82421, Avg fpr: 0.01077, total FA: 84

Testing server on iccad2012
[Step=  50] | Loss=0.35641 | acc=0.8766 | tpr=0.9823 | fpr=0.1253 | 3731.9 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.36020 | acc=0.8779 | tpr=0.9787 | fpr=0.1240 | 6718.3 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.36851 | acc=0.8774 | tpr=0.9798 | fpr=0.1245 | 6816.4 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.37327 | acc=0.8768 | tpr=0.9825 | fpr=0.1251 | 6744.5 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.37334 | acc=0.8764 | tpr=0.9790 | fpr=0.1254 | 6920.2 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.37732 | acc=0.8762 | tpr=0.9789 | fpr=0.1257 | 6751.9 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.37830 | acc=0.8764 | tpr=0.9787 | fpr=0.1255 | 6774.0 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.37896 | acc=0.8761 | tpr=0.9776 | fpr=0.1258 | 6856.3 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.38310 | acc=0.8754 | tpr=0.9781 | fpr=0.1264 | 6614.8 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.38107 | acc=0.8756 | tpr=0.9780 | fpr=0.1263 | 6793.5 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.37932 | acc=0.8759 | tpr=0.9777 | fpr=0.1260 | 12429.0 samples/s | 48.6 steps/s
Avg test loss: 0.37950, Avg test acc: 0.87592, Avg tpr: 0.97781, Avg fpr: 0.12594, total FA: 17486

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=34.4] | Loss=0.14475 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.325 | L2-Norm(final)=2.981 | 4263.0 samples/s | 66.6 steps/s
[Step=35250 Epoch=34.4] | Loss=0.01986 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.314 | L2-Norm(final)=2.980 | 3059.2 samples/s | 47.8 steps/s
[Step=35300 Epoch=34.5] | Loss=0.01279 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.309 | L2-Norm(final)=2.980 | 3478.1 samples/s | 54.3 steps/s
[Step=35350 Epoch=34.5] | Loss=0.01040 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.306 | L2-Norm(final)=2.981 | 3470.4 samples/s | 54.2 steps/s
[Step=35400 Epoch=34.6] | Loss=0.00938 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.305 | L2-Norm(final)=2.982 | 3434.7 samples/s | 53.7 steps/s
[Step=35450 Epoch=34.6] | Loss=0.00895 | Reg=0.00299 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.303 | L2-Norm(final)=2.983 | 3452.1 samples/s | 53.9 steps/s
[Step=35500 Epoch=34.7] | Loss=0.00839 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.302 | L2-Norm(final)=2.983 | 3457.5 samples/s | 54.0 steps/s
[Step=35550 Epoch=34.7] | Loss=0.00797 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.302 | L2-Norm(final)=2.984 | 3465.8 samples/s | 54.2 steps/s
[Step=35600 Epoch=34.8] | Loss=0.00776 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.301 | L2-Norm(final)=2.984 | 3452.0 samples/s | 53.9 steps/s
[Step=35650 Epoch=34.8] | Loss=0.00763 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.300 | L2-Norm(final)=2.985 | 3467.8 samples/s | 54.2 steps/s
[Step=35700 Epoch=34.9] | Loss=0.00755 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.300 | L2-Norm(final)=2.986 | 3474.3 samples/s | 54.3 steps/s
[Step=35750 Epoch=34.9] | Loss=0.00735 | Reg=0.00299 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.299 | L2-Norm(final)=2.986 | 3451.8 samples/s | 53.9 steps/s
[Step=35800 Epoch=35.0] | Loss=0.00726 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.299 | L2-Norm(final)=2.987 | 3475.9 samples/s | 54.3 steps/s
[Step=35850 Epoch=35.0] | Loss=0.00719 | Reg=0.00299 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.299 | L2-Norm(final)=2.988 | 3463.0 samples/s | 54.1 steps/s
[Step=35900 Epoch=35.1] | Loss=0.00703 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.298 | L2-Norm(final)=2.988 | 3462.9 samples/s | 54.1 steps/s
[Step=35950 Epoch=35.1] | Loss=0.00687 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.298 | L2-Norm(final)=2.989 | 3476.9 samples/s | 54.3 steps/s
[Step=36000 Epoch=35.1] | Loss=0.00682 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.298 | L2-Norm(final)=2.989 | 3456.8 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step36000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=66.4] | Loss=0.08946 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.325 | L2-Norm(final)=2.981 | 3907.3 samples/s | 61.1 steps/s
[Step=35250 Epoch=66.4] | Loss=0.00684 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.292 | L2-Norm(final)=2.981 | 2919.0 samples/s | 45.6 steps/s
[Step=35300 Epoch=66.5] | Loss=0.00345 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.285 | L2-Norm(final)=2.981 | 3189.4 samples/s | 49.8 steps/s
[Step=35350 Epoch=66.6] | Loss=0.00231 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.281 | L2-Norm(final)=2.981 | 3184.5 samples/s | 49.8 steps/s
[Step=35400 Epoch=66.7] | Loss=0.00174 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.279 | L2-Norm(final)=2.981 | 3214.0 samples/s | 50.2 steps/s
[Step=35450 Epoch=66.8] | Loss=0.00140 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.277 | L2-Norm(final)=2.981 | 3204.8 samples/s | 50.1 steps/s
[Step=35500 Epoch=66.9] | Loss=0.00117 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.275 | L2-Norm(final)=2.981 | 3193.5 samples/s | 49.9 steps/s
[Step=35550 Epoch=67.0] | Loss=0.00100 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.273 | L2-Norm(final)=2.981 | 3195.3 samples/s | 49.9 steps/s
[Step=35600 Epoch=67.1] | Loss=0.00088 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.272 | L2-Norm(final)=2.981 | 3250.4 samples/s | 50.8 steps/s
[Step=35650 Epoch=67.2] | Loss=0.00079 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.271 | L2-Norm(final)=2.981 | 3274.7 samples/s | 51.2 steps/s
[Step=35700 Epoch=67.3] | Loss=0.00071 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.269 | L2-Norm(final)=2.981 | 3313.9 samples/s | 51.8 steps/s
[Step=35750 Epoch=67.4] | Loss=0.00065 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.268 | L2-Norm(final)=2.981 | 1695.6 samples/s | 26.5 steps/s
[Step=35800 Epoch=67.5] | Loss=0.00059 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.267 | L2-Norm(final)=2.981 | 3313.2 samples/s | 51.8 steps/s
[Step=35850 Epoch=67.6] | Loss=0.00055 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.266 | L2-Norm(final)=2.981 | 3303.9 samples/s | 51.6 steps/s
[Step=35900 Epoch=67.7] | Loss=0.00051 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.265 | L2-Norm(final)=2.981 | 3295.2 samples/s | 51.5 steps/s
[Step=35950 Epoch=67.8] | Loss=0.00048 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.265 | L2-Norm(final)=2.981 | 3301.3 samples/s | 51.6 steps/s
[Step=36000 Epoch=67.9] | Loss=0.00045 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.264 | L2-Norm(final)=2.982 | 3295.4 samples/s | 51.5 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20613 | acc=0.8886 | tpr=0.8420 | fpr=0.0102 | 3747.5 samples/s | 14.6 steps/s
Avg test loss: 0.20666, Avg test acc: 0.88793, Avg tpr: 0.84234, Avg fpr: 0.01179, total FA: 92

Testing server on iccad2012
[Step=  50] | Loss=0.38453 | acc=0.8638 | tpr=0.9867 | fpr=0.1384 | 3790.1 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.38732 | acc=0.8660 | tpr=0.9808 | fpr=0.1362 | 6579.1 samples/s | 25.7 steps/s
[Step= 150] | Loss=0.39546 | acc=0.8651 | tpr=0.9813 | fpr=0.1371 | 6930.9 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.40041 | acc=0.8646 | tpr=0.9825 | fpr=0.1376 | 6789.1 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.40026 | acc=0.8641 | tpr=0.9790 | fpr=0.1380 | 6857.0 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.40412 | acc=0.8641 | tpr=0.9789 | fpr=0.1380 | 6835.5 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.40486 | acc=0.8642 | tpr=0.9775 | fpr=0.1379 | 6821.9 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.40550 | acc=0.8637 | tpr=0.9759 | fpr=0.1383 | 6676.0 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.40960 | acc=0.8631 | tpr=0.9766 | fpr=0.1390 | 6963.6 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.40757 | acc=0.8632 | tpr=0.9767 | fpr=0.1388 | 6582.3 samples/s | 25.7 steps/s
[Step= 550] | Loss=0.40583 | acc=0.8635 | tpr=0.9761 | fpr=0.1385 | 12362.2 samples/s | 48.3 steps/s
Avg test loss: 0.40597, Avg test acc: 0.86359, Avg tpr: 0.97623, Avg fpr: 0.13845, total FA: 19224

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=35.1] | Loss=0.08197 | Reg=0.00298 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.269 | L2-Norm(final)=2.990 | 3802.3 samples/s | 59.4 steps/s
[Step=36050 Epoch=35.2] | Loss=0.01745 | Reg=0.00298 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.258 | L2-Norm(final)=2.990 | 3302.2 samples/s | 51.6 steps/s
[Step=36100 Epoch=35.2] | Loss=0.01239 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.254 | L2-Norm(final)=2.991 | 3473.6 samples/s | 54.3 steps/s
[Step=36150 Epoch=35.3] | Loss=0.01008 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.251 | L2-Norm(final)=2.991 | 3480.7 samples/s | 54.4 steps/s
[Step=36200 Epoch=35.3] | Loss=0.00919 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.249 | L2-Norm(final)=2.992 | 3468.6 samples/s | 54.2 steps/s
[Step=36250 Epoch=35.4] | Loss=0.00888 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.248 | L2-Norm(final)=2.992 | 3478.0 samples/s | 54.3 steps/s
[Step=36300 Epoch=35.4] | Loss=0.00836 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.247 | L2-Norm(final)=2.993 | 3498.9 samples/s | 54.7 steps/s
[Step=36350 Epoch=35.5] | Loss=0.00793 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.246 | L2-Norm(final)=2.994 | 3492.6 samples/s | 54.6 steps/s
[Step=36400 Epoch=35.5] | Loss=0.00779 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.246 | L2-Norm(final)=2.994 | 3463.0 samples/s | 54.1 steps/s
[Step=36450 Epoch=35.6] | Loss=0.00758 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.245 | L2-Norm(final)=2.995 | 3486.1 samples/s | 54.5 steps/s
[Step=36500 Epoch=35.6] | Loss=0.00724 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.245 | L2-Norm(final)=2.996 | 3434.4 samples/s | 53.7 steps/s
[Step=36550 Epoch=35.7] | Loss=0.00712 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.244 | L2-Norm(final)=2.996 | 3485.6 samples/s | 54.5 steps/s
[Step=36600 Epoch=35.7] | Loss=0.00694 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.244 | L2-Norm(final)=2.997 | 3498.3 samples/s | 54.7 steps/s
[Step=36650 Epoch=35.8] | Loss=0.00682 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.244 | L2-Norm(final)=2.998 | 3503.5 samples/s | 54.7 steps/s
[Step=36700 Epoch=35.8] | Loss=0.00669 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.243 | L2-Norm(final)=2.998 | 3490.9 samples/s | 54.5 steps/s
[Step=36750 Epoch=35.9] | Loss=0.00665 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.243 | L2-Norm(final)=2.999 | 3485.2 samples/s | 54.5 steps/s
[Step=36800 Epoch=35.9] | Loss=0.00656 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.243 | L2-Norm(final)=3.000 | 3482.1 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step36800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=67.9] | Loss=0.06930 | Reg=0.00298 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.269 | L2-Norm(final)=2.991 | 3871.4 samples/s | 60.5 steps/s
[Step=36050 Epoch=68.0] | Loss=0.00644 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.236 | L2-Norm(final)=2.991 | 3046.1 samples/s | 47.6 steps/s
[Step=36100 Epoch=68.0] | Loss=0.00324 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.229 | L2-Norm(final)=2.991 | 3283.1 samples/s | 51.3 steps/s
[Step=36150 Epoch=68.1] | Loss=0.00217 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.225 | L2-Norm(final)=2.991 | 3291.5 samples/s | 51.4 steps/s
[Step=36200 Epoch=68.2] | Loss=0.00163 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.223 | L2-Norm(final)=2.991 | 3305.1 samples/s | 51.6 steps/s
[Step=36250 Epoch=68.3] | Loss=0.00131 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.220 | L2-Norm(final)=2.991 | 3308.9 samples/s | 51.7 steps/s
[Step=36300 Epoch=68.4] | Loss=0.00110 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.219 | L2-Norm(final)=2.991 | 3316.8 samples/s | 51.8 steps/s
[Step=36350 Epoch=68.5] | Loss=0.00095 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.217 | L2-Norm(final)=2.991 | 3304.7 samples/s | 51.6 steps/s
[Step=36400 Epoch=68.6] | Loss=0.00083 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.216 | L2-Norm(final)=2.991 | 3298.7 samples/s | 51.5 steps/s
[Step=36450 Epoch=68.7] | Loss=0.00074 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.215 | L2-Norm(final)=2.991 | 3305.2 samples/s | 51.6 steps/s
[Step=36500 Epoch=68.8] | Loss=0.00067 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.213 | L2-Norm(final)=2.991 | 3367.6 samples/s | 52.6 steps/s
[Step=36550 Epoch=68.9] | Loss=0.00061 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.212 | L2-Norm(final)=2.991 | 1702.5 samples/s | 26.6 steps/s
[Step=36600 Epoch=69.0] | Loss=0.00056 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.211 | L2-Norm(final)=2.991 | 3312.3 samples/s | 51.8 steps/s
[Step=36650 Epoch=69.1] | Loss=0.00052 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.210 | L2-Norm(final)=2.991 | 3310.9 samples/s | 51.7 steps/s
[Step=36700 Epoch=69.2] | Loss=0.00048 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.210 | L2-Norm(final)=2.992 | 3315.8 samples/s | 51.8 steps/s
[Step=36750 Epoch=69.3] | Loss=0.00045 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.209 | L2-Norm(final)=2.992 | 3307.7 samples/s | 51.7 steps/s
[Step=36800 Epoch=69.4] | Loss=0.00042 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.208 | L2-Norm(final)=2.992 | 3333.6 samples/s | 52.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21634 | acc=0.8833 | tpr=0.8347 | fpr=0.0111 | 3754.6 samples/s | 14.7 steps/s
Avg test loss: 0.21908, Avg test acc: 0.88128, Avg tpr: 0.83255, Avg fpr: 0.01154, total FA: 90

Testing server on iccad2012
[Step=  50] | Loss=0.37550 | acc=0.8692 | tpr=0.9823 | fpr=0.1328 | 3696.5 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.37902 | acc=0.8709 | tpr=0.9787 | fpr=0.1311 | 6856.0 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.38785 | acc=0.8699 | tpr=0.9798 | fpr=0.1322 | 6916.3 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.39288 | acc=0.8694 | tpr=0.9825 | fpr=0.1326 | 6721.1 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.39269 | acc=0.8691 | tpr=0.9790 | fpr=0.1329 | 6823.6 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.39657 | acc=0.8688 | tpr=0.9789 | fpr=0.1332 | 6862.1 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.39736 | acc=0.8688 | tpr=0.9781 | fpr=0.1332 | 6532.1 samples/s | 25.5 steps/s
[Step= 400] | Loss=0.39818 | acc=0.8685 | tpr=0.9770 | fpr=0.1335 | 6721.3 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.40227 | acc=0.8680 | tpr=0.9781 | fpr=0.1340 | 6800.0 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.40030 | acc=0.8680 | tpr=0.9780 | fpr=0.1340 | 5009.8 samples/s | 19.6 steps/s
[Step= 550] | Loss=0.39857 | acc=0.8683 | tpr=0.9773 | fpr=0.1336 | 9390.4 samples/s | 36.7 steps/s
Avg test loss: 0.39873, Avg test acc: 0.86837, Avg tpr: 0.97742, Avg fpr: 0.13361, total FA: 18552

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=35.9] | Loss=0.09123 | Reg=0.00296 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.214 | L2-Norm(final)=3.000 | 4009.4 samples/s | 62.6 steps/s
[Step=36850 Epoch=36.0] | Loss=0.02081 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.203 | L2-Norm(final)=3.000 | 3188.0 samples/s | 49.8 steps/s
[Step=36900 Epoch=36.0] | Loss=0.01324 | Reg=0.00296 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.199 | L2-Norm(final)=3.001 | 3438.8 samples/s | 53.7 steps/s
[Step=36950 Epoch=36.1] | Loss=0.01083 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.196 | L2-Norm(final)=3.001 | 3366.9 samples/s | 52.6 steps/s
[Step=37000 Epoch=36.1] | Loss=0.00951 | Reg=0.00296 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.194 | L2-Norm(final)=3.002 | 3425.9 samples/s | 53.5 steps/s
[Step=37050 Epoch=36.2] | Loss=0.00901 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.192 | L2-Norm(final)=3.002 | 3462.9 samples/s | 54.1 steps/s
[Step=37100 Epoch=36.2] | Loss=0.00845 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.191 | L2-Norm(final)=3.003 | 3123.8 samples/s | 48.8 steps/s
[Step=37150 Epoch=36.3] | Loss=0.00804 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.191 | L2-Norm(final)=3.003 | 3094.0 samples/s | 48.3 steps/s
[Step=37200 Epoch=36.3] | Loss=0.00777 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.190 | L2-Norm(final)=3.004 | 3093.8 samples/s | 48.3 steps/s
[Step=37250 Epoch=36.4] | Loss=0.00769 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.189 | L2-Norm(final)=3.005 | 3114.4 samples/s | 48.7 steps/s
[Step=37300 Epoch=36.4] | Loss=0.00763 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.189 | L2-Norm(final)=3.005 | 3439.2 samples/s | 53.7 steps/s
[Step=37350 Epoch=36.5] | Loss=0.00736 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.188 | L2-Norm(final)=3.006 | 3470.0 samples/s | 54.2 steps/s
[Step=37400 Epoch=36.5] | Loss=0.00712 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.188 | L2-Norm(final)=3.006 | 3474.7 samples/s | 54.3 steps/s
[Step=37450 Epoch=36.6] | Loss=0.00698 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.187 | L2-Norm(final)=3.007 | 3452.7 samples/s | 53.9 steps/s
[Step=37500 Epoch=36.6] | Loss=0.00697 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.187 | L2-Norm(final)=3.007 | 3454.5 samples/s | 54.0 steps/s
[Step=37550 Epoch=36.7] | Loss=0.00686 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.187 | L2-Norm(final)=3.008 | 3467.9 samples/s | 54.2 steps/s
[Step=37600 Epoch=36.7] | Loss=0.00685 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.186 | L2-Norm(final)=3.008 | 3475.4 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step37600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=69.4] | Loss=0.09976 | Reg=0.00296 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.214 | L2-Norm(final)=3.000 | 4167.2 samples/s | 65.1 steps/s
[Step=36850 Epoch=69.5] | Loss=0.00631 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.182 | L2-Norm(final)=3.000 | 2912.4 samples/s | 45.5 steps/s
[Step=36900 Epoch=69.6] | Loss=0.00317 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.176 | L2-Norm(final)=3.000 | 3250.3 samples/s | 50.8 steps/s
[Step=36950 Epoch=69.7] | Loss=0.00213 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.172 | L2-Norm(final)=3.000 | 3315.1 samples/s | 51.8 steps/s
[Step=37000 Epoch=69.7] | Loss=0.00161 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.169 | L2-Norm(final)=3.000 | 3325.4 samples/s | 52.0 steps/s
[Step=37050 Epoch=69.8] | Loss=0.00129 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.167 | L2-Norm(final)=3.000 | 3331.9 samples/s | 52.1 steps/s
[Step=37100 Epoch=69.9] | Loss=0.00108 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.165 | L2-Norm(final)=3.000 | 3333.3 samples/s | 52.1 steps/s
[Step=37150 Epoch=70.0] | Loss=0.00093 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.163 | L2-Norm(final)=3.000 | 3315.2 samples/s | 51.8 steps/s
[Step=37200 Epoch=70.1] | Loss=0.00082 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.162 | L2-Norm(final)=3.001 | 3302.7 samples/s | 51.6 steps/s
[Step=37250 Epoch=70.2] | Loss=0.00073 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.161 | L2-Norm(final)=3.001 | 3323.3 samples/s | 51.9 steps/s
[Step=37300 Epoch=70.3] | Loss=0.00066 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.160 | L2-Norm(final)=3.001 | 3320.7 samples/s | 51.9 steps/s
[Step=37350 Epoch=70.4] | Loss=0.00060 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.158 | L2-Norm(final)=3.001 | 1682.0 samples/s | 26.3 steps/s
[Step=37400 Epoch=70.5] | Loss=0.00055 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.157 | L2-Norm(final)=3.001 | 3347.2 samples/s | 52.3 steps/s
[Step=37450 Epoch=70.6] | Loss=0.00051 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.156 | L2-Norm(final)=3.001 | 3283.1 samples/s | 51.3 steps/s
[Step=37500 Epoch=70.7] | Loss=0.00048 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.156 | L2-Norm(final)=3.001 | 3316.9 samples/s | 51.8 steps/s
[Step=37550 Epoch=70.8] | Loss=0.00045 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.155 | L2-Norm(final)=3.001 | 3306.0 samples/s | 51.7 steps/s
[Step=37600 Epoch=70.9] | Loss=0.00042 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.154 | L2-Norm(final)=3.001 | 3271.9 samples/s | 51.1 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20210 | acc=0.8888 | tpr=0.8428 | fpr=0.0111 | 3708.9 samples/s | 14.5 steps/s
Avg test loss: 0.20429, Avg test acc: 0.88797, Avg tpr: 0.84263, Avg fpr: 0.01231, total FA: 96

Testing server on iccad2012
[Step=  50] | Loss=0.38077 | acc=0.8675 | tpr=0.9823 | fpr=0.1346 | 3701.8 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.38369 | acc=0.8707 | tpr=0.9765 | fpr=0.1313 | 7053.6 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.39145 | acc=0.8701 | tpr=0.9784 | fpr=0.1319 | 6593.8 samples/s | 25.8 steps/s
[Step= 200] | Loss=0.39683 | acc=0.8697 | tpr=0.9814 | fpr=0.1323 | 7044.4 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.39675 | acc=0.8694 | tpr=0.9782 | fpr=0.1326 | 6579.2 samples/s | 25.7 steps/s
[Step= 300] | Loss=0.40088 | acc=0.8689 | tpr=0.9775 | fpr=0.1331 | 6970.7 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.40170 | acc=0.8689 | tpr=0.9762 | fpr=0.1330 | 6557.3 samples/s | 25.6 steps/s
[Step= 400] | Loss=0.40251 | acc=0.8686 | tpr=0.9748 | fpr=0.1333 | 6735.3 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.40678 | acc=0.8682 | tpr=0.9761 | fpr=0.1338 | 4447.1 samples/s | 17.4 steps/s
[Step= 500] | Loss=0.40454 | acc=0.8684 | tpr=0.9762 | fpr=0.1336 | 6654.2 samples/s | 26.0 steps/s
[Step= 550] | Loss=0.40289 | acc=0.8687 | tpr=0.9753 | fpr=0.1332 | 12831.3 samples/s | 50.1 steps/s
Avg test loss: 0.40305, Avg test acc: 0.86876, Avg tpr: 0.97544, Avg fpr: 0.13318, total FA: 18492

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=36.7] | Loss=0.08438 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.158 | L2-Norm(final)=3.009 | 3810.9 samples/s | 59.5 steps/s
[Step=37650 Epoch=36.8] | Loss=0.01644 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.148 | L2-Norm(final)=3.009 | 3312.2 samples/s | 51.8 steps/s
[Step=37700 Epoch=36.8] | Loss=0.01111 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.144 | L2-Norm(final)=3.010 | 3465.5 samples/s | 54.1 steps/s
[Step=37750 Epoch=36.9] | Loss=0.00983 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.141 | L2-Norm(final)=3.011 | 3477.7 samples/s | 54.3 steps/s
[Step=37800 Epoch=36.9] | Loss=0.00857 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.139 | L2-Norm(final)=3.011 | 3479.6 samples/s | 54.4 steps/s
[Step=37850 Epoch=37.0] | Loss=0.00770 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.138 | L2-Norm(final)=3.012 | 3470.9 samples/s | 54.2 steps/s
[Step=37900 Epoch=37.0] | Loss=0.00720 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.137 | L2-Norm(final)=3.013 | 3495.9 samples/s | 54.6 steps/s
[Step=37950 Epoch=37.1] | Loss=0.00705 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.136 | L2-Norm(final)=3.014 | 3500.4 samples/s | 54.7 steps/s
[Step=38000 Epoch=37.1] | Loss=0.00678 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.136 | L2-Norm(final)=3.014 | 3500.9 samples/s | 54.7 steps/s
[Step=38050 Epoch=37.1] | Loss=0.00675 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.135 | L2-Norm(final)=3.015 | 3473.6 samples/s | 54.3 steps/s
[Step=38100 Epoch=37.2] | Loss=0.00660 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.135 | L2-Norm(final)=3.016 | 3488.5 samples/s | 54.5 steps/s
[Step=38150 Epoch=37.2] | Loss=0.00675 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.134 | L2-Norm(final)=3.016 | 3484.8 samples/s | 54.5 steps/s
[Step=38200 Epoch=37.3] | Loss=0.00660 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.134 | L2-Norm(final)=3.016 | 3485.0 samples/s | 54.5 steps/s
[Step=38250 Epoch=37.3] | Loss=0.00650 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.133 | L2-Norm(final)=3.017 | 3487.2 samples/s | 54.5 steps/s
[Step=38300 Epoch=37.4] | Loss=0.00656 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.133 | L2-Norm(final)=3.017 | 3483.0 samples/s | 54.4 steps/s
[Step=38350 Epoch=37.4] | Loss=0.00649 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.133 | L2-Norm(final)=3.018 | 3475.8 samples/s | 54.3 steps/s
[Step=38400 Epoch=37.5] | Loss=0.00648 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.133 | L2-Norm(final)=3.019 | 3471.9 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step38400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=70.9] | Loss=0.00658 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.158 | L2-Norm(final)=3.009 | 3878.3 samples/s | 60.6 steps/s
[Step=37650 Epoch=71.0] | Loss=0.00569 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.128 | L2-Norm(final)=3.009 | 2991.4 samples/s | 46.7 steps/s
[Step=37700 Epoch=71.1] | Loss=0.00287 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.121 | L2-Norm(final)=3.010 | 3296.3 samples/s | 51.5 steps/s
[Step=37750 Epoch=71.2] | Loss=0.00193 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.118 | L2-Norm(final)=3.010 | 3310.6 samples/s | 51.7 steps/s
[Step=37800 Epoch=71.3] | Loss=0.00145 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.115 | L2-Norm(final)=3.010 | 3125.3 samples/s | 48.8 steps/s
[Step=37850 Epoch=71.3] | Loss=0.00117 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.113 | L2-Norm(final)=3.010 | 2873.2 samples/s | 44.9 steps/s
[Step=37900 Epoch=71.4] | Loss=0.00098 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.111 | L2-Norm(final)=3.010 | 2898.3 samples/s | 45.3 steps/s
[Step=37950 Epoch=71.5] | Loss=0.00084 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.110 | L2-Norm(final)=3.010 | 2917.3 samples/s | 45.6 steps/s
[Step=38000 Epoch=71.6] | Loss=0.00074 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.108 | L2-Norm(final)=3.010 | 2975.6 samples/s | 46.5 steps/s
[Step=38050 Epoch=71.7] | Loss=0.00066 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.107 | L2-Norm(final)=3.010 | 3181.5 samples/s | 49.7 steps/s
[Step=38100 Epoch=71.8] | Loss=0.00060 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.106 | L2-Norm(final)=3.010 | 3260.8 samples/s | 51.0 steps/s
[Step=38150 Epoch=71.9] | Loss=0.00054 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.105 | L2-Norm(final)=3.010 | 1657.4 samples/s | 25.9 steps/s
[Step=38200 Epoch=72.0] | Loss=0.00050 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.104 | L2-Norm(final)=3.010 | 3315.1 samples/s | 51.8 steps/s
[Step=38250 Epoch=72.1] | Loss=0.00046 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.103 | L2-Norm(final)=3.010 | 3210.2 samples/s | 50.2 steps/s
[Step=38300 Epoch=72.2] | Loss=0.00043 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.102 | L2-Norm(final)=3.011 | 3260.7 samples/s | 50.9 steps/s
[Step=38350 Epoch=72.3] | Loss=0.00040 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.101 | L2-Norm(final)=3.011 | 3227.4 samples/s | 50.4 steps/s
[Step=38400 Epoch=72.4] | Loss=0.00038 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.100 | L2-Norm(final)=3.011 | 3249.4 samples/s | 50.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19944 | acc=0.8923 | tpr=0.8480 | fpr=0.0114 | 3698.2 samples/s | 14.4 steps/s
Avg test loss: 0.20164, Avg test acc: 0.89006, Avg tpr: 0.84566, Avg fpr: 0.01231, total FA: 96

Testing server on iccad2012
[Step=  50] | Loss=0.38091 | acc=0.8678 | tpr=0.9867 | fpr=0.1343 | 3759.3 samples/s | 14.7 steps/s
[Step= 100] | Loss=0.38378 | acc=0.8709 | tpr=0.9787 | fpr=0.1311 | 6691.0 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.39188 | acc=0.8705 | tpr=0.9798 | fpr=0.1315 | 6599.4 samples/s | 25.8 steps/s
[Step= 200] | Loss=0.39732 | acc=0.8701 | tpr=0.9814 | fpr=0.1319 | 6104.8 samples/s | 23.8 steps/s
[Step= 250] | Loss=0.39737 | acc=0.8698 | tpr=0.9782 | fpr=0.1322 | 5999.3 samples/s | 23.4 steps/s
[Step= 300] | Loss=0.40152 | acc=0.8693 | tpr=0.9782 | fpr=0.1327 | 6640.5 samples/s | 25.9 steps/s
[Step= 350] | Loss=0.40223 | acc=0.8695 | tpr=0.9768 | fpr=0.1324 | 4548.9 samples/s | 17.8 steps/s
[Step= 400] | Loss=0.40318 | acc=0.8692 | tpr=0.9754 | fpr=0.1327 | 6773.9 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.40749 | acc=0.8689 | tpr=0.9766 | fpr=0.1331 | 6674.9 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.40524 | acc=0.8690 | tpr=0.9767 | fpr=0.1329 | 6740.7 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.40354 | acc=0.8694 | tpr=0.9757 | fpr=0.1326 | 12440.5 samples/s | 48.6 steps/s
Avg test loss: 0.40366, Avg test acc: 0.86940, Avg tpr: 0.97583, Avg fpr: 0.13253, total FA: 18402

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=37.5] | Loss=0.09159 | Reg=0.00293 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.105 | L2-Norm(final)=3.019 | 3984.8 samples/s | 62.3 steps/s
[Step=38450 Epoch=37.5] | Loss=0.01826 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.094 | L2-Norm(final)=3.019 | 3286.0 samples/s | 51.3 steps/s
[Step=38500 Epoch=37.6] | Loss=0.01222 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.089 | L2-Norm(final)=3.019 | 3472.3 samples/s | 54.3 steps/s
[Step=38550 Epoch=37.6] | Loss=0.00970 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.087 | L2-Norm(final)=3.020 | 3469.3 samples/s | 54.2 steps/s
[Step=38600 Epoch=37.7] | Loss=0.00859 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.085 | L2-Norm(final)=3.021 | 3475.8 samples/s | 54.3 steps/s
[Step=38650 Epoch=37.7] | Loss=0.00806 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.084 | L2-Norm(final)=3.021 | 3485.0 samples/s | 54.5 steps/s
[Step=38700 Epoch=37.8] | Loss=0.00756 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.083 | L2-Norm(final)=3.022 | 3489.7 samples/s | 54.5 steps/s
[Step=38750 Epoch=37.8] | Loss=0.00751 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.082 | L2-Norm(final)=3.023 | 3486.7 samples/s | 54.5 steps/s
[Step=38800 Epoch=37.9] | Loss=0.00734 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.082 | L2-Norm(final)=3.023 | 3442.2 samples/s | 53.8 steps/s
[Step=38850 Epoch=37.9] | Loss=0.00703 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.081 | L2-Norm(final)=3.024 | 3467.6 samples/s | 54.2 steps/s
[Step=38900 Epoch=38.0] | Loss=0.00684 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.081 | L2-Norm(final)=3.025 | 3487.6 samples/s | 54.5 steps/s
[Step=38950 Epoch=38.0] | Loss=0.00674 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.080 | L2-Norm(final)=3.025 | 3480.9 samples/s | 54.4 steps/s
[Step=39000 Epoch=38.1] | Loss=0.00665 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.080 | L2-Norm(final)=3.026 | 3495.0 samples/s | 54.6 steps/s
[Step=39050 Epoch=38.1] | Loss=0.00666 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.080 | L2-Norm(final)=3.027 | 3490.1 samples/s | 54.5 steps/s
[Step=39100 Epoch=38.2] | Loss=0.00657 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.079 | L2-Norm(final)=3.027 | 3473.7 samples/s | 54.3 steps/s
[Step=39150 Epoch=38.2] | Loss=0.00642 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.079 | L2-Norm(final)=3.028 | 3494.5 samples/s | 54.6 steps/s
[Step=39200 Epoch=38.3] | Loss=0.00640 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.079 | L2-Norm(final)=3.028 | 3496.2 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step39200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=72.4] | Loss=0.04599 | Reg=0.00293 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.105 | L2-Norm(final)=3.019 | 3584.1 samples/s | 56.0 steps/s
[Step=38450 Epoch=72.5] | Loss=0.00507 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.073 | L2-Norm(final)=3.020 | 3189.9 samples/s | 49.8 steps/s
[Step=38500 Epoch=72.6] | Loss=0.00255 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.067 | L2-Norm(final)=3.020 | 3310.3 samples/s | 51.7 steps/s
[Step=38550 Epoch=72.7] | Loss=0.00171 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.063 | L2-Norm(final)=3.020 | 3293.6 samples/s | 51.5 steps/s
[Step=38600 Epoch=72.8] | Loss=0.00128 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.060 | L2-Norm(final)=3.020 | 3285.1 samples/s | 51.3 steps/s
[Step=38650 Epoch=72.9] | Loss=0.00103 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.058 | L2-Norm(final)=3.020 | 3302.6 samples/s | 51.6 steps/s
[Step=38700 Epoch=73.0] | Loss=0.00086 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.057 | L2-Norm(final)=3.020 | 3315.9 samples/s | 51.8 steps/s
[Step=38750 Epoch=73.0] | Loss=0.00074 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.055 | L2-Norm(final)=3.020 | 3305.7 samples/s | 51.7 steps/s
[Step=38800 Epoch=73.1] | Loss=0.00065 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.054 | L2-Norm(final)=3.020 | 3332.8 samples/s | 52.1 steps/s
[Step=38850 Epoch=73.2] | Loss=0.00058 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.052 | L2-Norm(final)=3.020 | 3298.3 samples/s | 51.5 steps/s
[Step=38900 Epoch=73.3] | Loss=0.00052 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.051 | L2-Norm(final)=3.020 | 3309.8 samples/s | 51.7 steps/s
[Step=38950 Epoch=73.4] | Loss=0.00048 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.050 | L2-Norm(final)=3.020 | 1697.2 samples/s | 26.5 steps/s
[Step=39000 Epoch=73.5] | Loss=0.00044 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.049 | L2-Norm(final)=3.020 | 3324.5 samples/s | 51.9 steps/s
[Step=39050 Epoch=73.6] | Loss=0.00041 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.048 | L2-Norm(final)=3.020 | 3314.0 samples/s | 51.8 steps/s
[Step=39100 Epoch=73.7] | Loss=0.00038 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.047 | L2-Norm(final)=3.021 | 3289.1 samples/s | 51.4 steps/s
[Step=39150 Epoch=73.8] | Loss=0.00035 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.047 | L2-Norm(final)=3.021 | 3291.1 samples/s | 51.4 steps/s
[Step=39200 Epoch=73.9] | Loss=0.00033 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.046 | L2-Norm(final)=3.021 | 3310.4 samples/s | 51.7 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19711 | acc=0.8928 | tpr=0.8490 | fpr=0.0121 | 3690.1 samples/s | 14.4 steps/s
Avg test loss: 0.19900, Avg test acc: 0.89154, Avg tpr: 0.84834, Avg fpr: 0.01346, total FA: 105

Testing server on iccad2012
[Step=  50] | Loss=0.37586 | acc=0.8724 | tpr=0.9823 | fpr=0.1296 | 3687.4 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.37761 | acc=0.8746 | tpr=0.9829 | fpr=0.1274 | 5311.1 samples/s | 20.7 steps/s
[Step= 150] | Loss=0.38545 | acc=0.8737 | tpr=0.9827 | fpr=0.1283 | 6714.9 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.39077 | acc=0.8730 | tpr=0.9836 | fpr=0.1290 | 6880.9 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.39076 | acc=0.8728 | tpr=0.9799 | fpr=0.1292 | 6627.4 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.39469 | acc=0.8726 | tpr=0.9796 | fpr=0.1293 | 5435.7 samples/s | 21.2 steps/s
[Step= 350] | Loss=0.39550 | acc=0.8726 | tpr=0.9781 | fpr=0.1293 | 6842.5 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.39646 | acc=0.8723 | tpr=0.9765 | fpr=0.1296 | 7157.9 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.40087 | acc=0.8718 | tpr=0.9776 | fpr=0.1301 | 6382.9 samples/s | 24.9 steps/s
[Step= 500] | Loss=0.39857 | acc=0.8722 | tpr=0.9775 | fpr=0.1297 | 6677.8 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.39683 | acc=0.8725 | tpr=0.9769 | fpr=0.1294 | 12746.4 samples/s | 49.8 steps/s
Avg test loss: 0.39696, Avg test acc: 0.87258, Avg tpr: 0.97702, Avg fpr: 0.12931, total FA: 17955

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=38.3] | Loss=0.06719 | Reg=0.00291 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.052 | L2-Norm(final)=3.029 | 3679.4 samples/s | 57.5 steps/s
[Step=39250 Epoch=38.3] | Loss=0.01434 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.042 | L2-Norm(final)=3.030 | 3264.4 samples/s | 51.0 steps/s
[Step=39300 Epoch=38.4] | Loss=0.01040 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.039 | L2-Norm(final)=3.031 | 3361.3 samples/s | 52.5 steps/s
[Step=39350 Epoch=38.4] | Loss=0.00936 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.037 | L2-Norm(final)=3.032 | 3337.1 samples/s | 52.1 steps/s
[Step=39400 Epoch=38.5] | Loss=0.00857 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.035 | L2-Norm(final)=3.032 | 3400.2 samples/s | 53.1 steps/s
[Step=39450 Epoch=38.5] | Loss=0.00800 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.034 | L2-Norm(final)=3.033 | 3365.5 samples/s | 52.6 steps/s
[Step=39500 Epoch=38.6] | Loss=0.00757 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.034 | L2-Norm(final)=3.034 | 3365.2 samples/s | 52.6 steps/s
[Step=39550 Epoch=38.6] | Loss=0.00727 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.033 | L2-Norm(final)=3.034 | 3407.7 samples/s | 53.2 steps/s
[Step=39600 Epoch=38.7] | Loss=0.00728 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.032 | L2-Norm(final)=3.035 | 3421.8 samples/s | 53.5 steps/s
[Step=39650 Epoch=38.7] | Loss=0.00715 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.031 | L2-Norm(final)=3.035 | 3451.5 samples/s | 53.9 steps/s
[Step=39700 Epoch=38.8] | Loss=0.00716 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.031 | L2-Norm(final)=3.036 | 3477.1 samples/s | 54.3 steps/s
[Step=39750 Epoch=38.8] | Loss=0.00707 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.030 | L2-Norm(final)=3.036 | 3467.1 samples/s | 54.2 steps/s
[Step=39800 Epoch=38.9] | Loss=0.00709 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.030 | L2-Norm(final)=3.037 | 3448.3 samples/s | 53.9 steps/s
[Step=39850 Epoch=38.9] | Loss=0.00696 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.029 | L2-Norm(final)=3.037 | 3449.1 samples/s | 53.9 steps/s
[Step=39900 Epoch=39.0] | Loss=0.00676 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.029 | L2-Norm(final)=3.038 | 3456.2 samples/s | 54.0 steps/s
[Step=39950 Epoch=39.0] | Loss=0.00653 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.029 | L2-Norm(final)=3.038 | 3456.1 samples/s | 54.0 steps/s
[Step=40000 Epoch=39.1] | Loss=0.00660 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.028 | L2-Norm(final)=3.039 | 3442.1 samples/s | 53.8 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step40000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=73.9] | Loss=0.06098 | Reg=0.00291 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.052 | L2-Norm(final)=3.029 | 3716.2 samples/s | 58.1 steps/s
[Step=39250 Epoch=74.0] | Loss=0.00640 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.020 | L2-Norm(final)=3.028 | 3215.1 samples/s | 50.2 steps/s
[Step=39300 Epoch=74.1] | Loss=0.00321 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.014 | L2-Norm(final)=3.028 | 3287.6 samples/s | 51.4 steps/s
[Step=39350 Epoch=74.2] | Loss=0.00214 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.010 | L2-Norm(final)=3.028 | 3310.9 samples/s | 51.7 steps/s
[Step=39400 Epoch=74.3] | Loss=0.00161 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.008 | L2-Norm(final)=3.028 | 3302.7 samples/s | 51.6 steps/s
[Step=39450 Epoch=74.4] | Loss=0.00129 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.006 | L2-Norm(final)=3.028 | 3304.1 samples/s | 51.6 steps/s
[Step=39500 Epoch=74.5] | Loss=0.00108 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.004 | L2-Norm(final)=3.028 | 3320.7 samples/s | 51.9 steps/s
[Step=39550 Epoch=74.6] | Loss=0.00093 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.002 | L2-Norm(final)=3.028 | 3328.6 samples/s | 52.0 steps/s
[Step=39600 Epoch=74.6] | Loss=0.00081 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.001 | L2-Norm(final)=3.028 | 3257.0 samples/s | 50.9 steps/s
[Step=39650 Epoch=74.7] | Loss=0.00072 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.000 | L2-Norm(final)=3.028 | 3306.2 samples/s | 51.7 steps/s
[Step=39700 Epoch=74.8] | Loss=0.00065 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.999 | L2-Norm(final)=3.028 | 3313.1 samples/s | 51.8 steps/s
[Step=39750 Epoch=74.9] | Loss=0.00060 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.997 | L2-Norm(final)=3.028 | 1680.2 samples/s | 26.3 steps/s
[Step=39800 Epoch=75.0] | Loss=0.00055 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.997 | L2-Norm(final)=3.028 | 3348.2 samples/s | 52.3 steps/s
[Step=39850 Epoch=75.1] | Loss=0.00051 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.996 | L2-Norm(final)=3.028 | 3308.3 samples/s | 51.7 steps/s
[Step=39900 Epoch=75.2] | Loss=0.00047 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.995 | L2-Norm(final)=3.028 | 3318.0 samples/s | 51.8 steps/s
[Step=39950 Epoch=75.3] | Loss=0.00044 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.994 | L2-Norm(final)=3.028 | 3275.7 samples/s | 51.2 steps/s
[Step=40000 Epoch=75.4] | Loss=0.00041 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.993 | L2-Norm(final)=3.029 | 3301.2 samples/s | 51.6 steps/s
Client model saved at models/model-fedprox-a1i1-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18675 | acc=0.8972 | tpr=0.8558 | fpr=0.0129 | 3723.0 samples/s | 14.5 steps/s
Avg test loss: 0.18849, Avg test acc: 0.89534, Avg tpr: 0.85400, Avg fpr: 0.01372, total FA: 107

Testing server on iccad2012
[Step=  50] | Loss=0.38815 | acc=0.8670 | tpr=0.9823 | fpr=0.1350 | 3677.3 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.39022 | acc=0.8693 | tpr=0.9808 | fpr=0.1328 | 6874.6 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.39813 | acc=0.8692 | tpr=0.9813 | fpr=0.1328 | 6764.2 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.40337 | acc=0.8681 | tpr=0.9825 | fpr=0.1340 | 4245.3 samples/s | 16.6 steps/s
[Step= 250] | Loss=0.40336 | acc=0.8677 | tpr=0.9790 | fpr=0.1344 | 6851.0 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.40733 | acc=0.8676 | tpr=0.9782 | fpr=0.1345 | 6890.3 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.40795 | acc=0.8678 | tpr=0.9768 | fpr=0.1342 | 6567.3 samples/s | 25.7 steps/s
[Step= 400] | Loss=0.40910 | acc=0.8676 | tpr=0.9759 | fpr=0.1343 | 6788.4 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.41339 | acc=0.8673 | tpr=0.9771 | fpr=0.1347 | 6814.6 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.41119 | acc=0.8673 | tpr=0.9771 | fpr=0.1346 | 6597.0 samples/s | 25.8 steps/s
[Step= 550] | Loss=0.40947 | acc=0.8676 | tpr=0.9769 | fpr=0.1344 | 12832.8 samples/s | 50.1 steps/s
Avg test loss: 0.40957, Avg test acc: 0.86768, Avg tpr: 0.97702, Avg fpr: 0.13431, total FA: 18649
