#clients of iccad2012: 2
#clients of asml1: 2
select ratio: 0.5
Total num clients: 4
client model path: ['models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0', 'models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1', 'models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0', 'models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32814, 144, 32)
Using transform option: train
#pos = 17102, #neg = 15712
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32737, 144, 32)
Using transform option: train
#pos = 17179, #neg = 15558
loading data into the main memory...
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16703, 144, 32)
Using transform option: train
#pos = 8134, #neg = 8569
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16626, 144, 32)
Using transform option: train
#pos = 8099, #neg = 8527
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.39952 | Reg=0.00359 | FP-Reg=0.000 | acc=0.4688 | L2-Norm=18.944 | L2-Norm(final)=1.986 | 2710.8 samples/s | 42.4 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.20029 | Reg=0.00359 | FP-Reg=0.003 | acc=0.9062 | L2-Norm=18.942 | L2-Norm(final)=1.989 | 3612.0 samples/s | 56.4 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.12399 | Reg=0.00360 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=18.982 | L2-Norm(final)=2.008 | 3577.8 samples/s | 55.9 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.09383 | Reg=0.00361 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.004 | L2-Norm(final)=2.021 | 3557.3 samples/s | 55.6 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.07325 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.021 | L2-Norm(final)=2.032 | 3553.3 samples/s | 55.5 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.06057 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.030 | L2-Norm(final)=2.042 | 4283.3 samples/s | 66.9 steps/s
[Step= 300 Epoch= 1.1] | Loss=0.05416 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.039 | L2-Norm(final)=2.049 | 1658.4 samples/s | 25.9 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.04746 | Reg=0.00363 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.049 | L2-Norm(final)=2.056 | 3549.9 samples/s | 55.5 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.04192 | Reg=0.00363 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.055 | L2-Norm(final)=2.062 | 3545.8 samples/s | 55.4 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.03759 | Reg=0.00363 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.057 | L2-Norm(final)=2.068 | 3548.7 samples/s | 55.4 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.03425 | Reg=0.00363 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.059 | L2-Norm(final)=2.074 | 3844.0 samples/s | 60.1 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.03141 | Reg=0.00363 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.060 | L2-Norm(final)=2.080 | 1702.7 samples/s | 26.6 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.02888 | Reg=0.00363 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.059 | L2-Norm(final)=2.085 | 3565.7 samples/s | 55.7 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.02676 | Reg=0.00363 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.058 | L2-Norm(final)=2.090 | 3546.8 samples/s | 55.4 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.02490 | Reg=0.00363 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.056 | L2-Norm(final)=2.095 | 3547.6 samples/s | 55.4 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.02333 | Reg=0.00363 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.054 | L2-Norm(final)=2.100 | 3537.2 samples/s | 55.3 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.02208 | Reg=0.00363 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.052 | L2-Norm(final)=2.104 | 1746.8 samples/s | 27.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.39740 | Reg=0.00359 | FP-Reg=0.000 | acc=0.4062 | L2-Norm=18.944 | L2-Norm(final)=1.985 | 3991.8 samples/s | 62.4 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.18960 | Reg=0.00359 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=18.953 | L2-Norm(final)=1.992 | 3163.2 samples/s | 49.4 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.12017 | Reg=0.00360 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=18.987 | L2-Norm(final)=2.008 | 3551.4 samples/s | 55.5 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.08849 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.004 | L2-Norm(final)=2.020 | 3538.5 samples/s | 55.3 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.07112 | Reg=0.00362 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.015 | L2-Norm(final)=2.030 | 3550.6 samples/s | 55.5 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.06037 | Reg=0.00362 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.025 | L2-Norm(final)=2.038 | 4292.9 samples/s | 67.1 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.05111 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.032 | L2-Norm(final)=2.046 | 1609.7 samples/s | 25.2 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.04415 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.035 | L2-Norm(final)=2.053 | 3511.3 samples/s | 54.9 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.03906 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.036 | L2-Norm(final)=2.060 | 3511.4 samples/s | 54.9 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.03520 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.036 | L2-Norm(final)=2.066 | 3555.1 samples/s | 55.5 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.03231 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.038 | L2-Norm(final)=2.073 | 3905.0 samples/s | 61.0 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.02963 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.039 | L2-Norm(final)=2.078 | 1654.5 samples/s | 25.9 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.02733 | Reg=0.00363 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.039 | L2-Norm(final)=2.084 | 3501.7 samples/s | 54.7 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.02530 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.039 | L2-Norm(final)=2.089 | 3567.8 samples/s | 55.7 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.02361 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.037 | L2-Norm(final)=2.094 | 3563.4 samples/s | 55.7 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.02292 | Reg=0.00362 | FP-Reg=0.007 | acc=0.9688 | L2-Norm=19.037 | L2-Norm(final)=2.098 | 3596.2 samples/s | 56.2 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.02197 | Reg=0.00363 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.041 | L2-Norm(final)=2.102 | 1710.1 samples/s | 26.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.47076 | acc=0.3860 | tpr=0.4495 | fpr=0.7517 | 3864.2 samples/s | 15.1 steps/s
Avg test loss: 0.46805, Avg test acc: 0.38937, Avg tpr: 0.45258, Avg fpr: 0.74965, total FA: 5848

Testing server on iccad2012
[Step=  50] | Loss=0.23996 | acc=0.8045 | tpr=0.9956 | fpr=0.1990 | 3876.6 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.24018 | acc=0.8058 | tpr=0.9979 | fpr=0.1978 | 7322.4 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.24049 | acc=0.8041 | tpr=0.9971 | fpr=0.1994 | 7490.1 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.24083 | acc=0.8045 | tpr=0.9967 | fpr=0.1990 | 7199.7 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.24069 | acc=0.8044 | tpr=0.9956 | fpr=0.1991 | 7422.5 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.24080 | acc=0.8045 | tpr=0.9964 | fpr=0.1990 | 7437.8 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.24124 | acc=0.8035 | tpr=0.9956 | fpr=0.2000 | 7334.4 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.24131 | acc=0.8033 | tpr=0.9951 | fpr=0.2002 | 7483.1 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.24168 | acc=0.8029 | tpr=0.9932 | fpr=0.2005 | 7207.9 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.24191 | acc=0.8025 | tpr=0.9930 | fpr=0.2009 | 7176.7 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.24157 | acc=0.8028 | tpr=0.9932 | fpr=0.2006 | 14020.0 samples/s | 54.8 steps/s
Avg test loss: 0.24155, Avg test acc: 0.80290, Avg tpr: 0.99326, Avg fpr: 0.20056, total FA: 27848

server round 1/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.50285 | Reg=0.00359 | FP-Reg=0.000 | acc=0.3906 | L2-Norm=18.936 | L2-Norm(final)=2.063 | 3719.2 samples/s | 58.1 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.30997 | Reg=0.00358 | FP-Reg=0.003 | acc=0.7344 | L2-Norm=18.921 | L2-Norm(final)=2.039 | 3474.0 samples/s | 54.3 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.26715 | Reg=0.00359 | FP-Reg=0.004 | acc=0.7969 | L2-Norm=18.945 | L2-Norm(final)=2.046 | 3775.3 samples/s | 59.0 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.23405 | Reg=0.00360 | FP-Reg=0.005 | acc=0.8125 | L2-Norm=18.971 | L2-Norm(final)=2.055 | 3740.8 samples/s | 58.4 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.21190 | Reg=0.00361 | FP-Reg=0.006 | acc=0.8438 | L2-Norm=18.992 | L2-Norm(final)=2.065 | 3783.8 samples/s | 59.1 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.19716 | Reg=0.00361 | FP-Reg=0.007 | acc=0.8906 | L2-Norm=19.013 | L2-Norm(final)=2.074 | 3786.7 samples/s | 59.2 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.18491 | Reg=0.00362 | FP-Reg=0.007 | acc=0.9062 | L2-Norm=19.032 | L2-Norm(final)=2.083 | 3787.0 samples/s | 59.2 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.17582 | Reg=0.00363 | FP-Reg=0.008 | acc=0.9219 | L2-Norm=19.051 | L2-Norm(final)=2.093 | 3775.0 samples/s | 59.0 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.16844 | Reg=0.00364 | FP-Reg=0.009 | acc=0.9062 | L2-Norm=19.069 | L2-Norm(final)=2.101 | 3757.8 samples/s | 58.7 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.16186 | Reg=0.00364 | FP-Reg=0.009 | acc=0.8906 | L2-Norm=19.085 | L2-Norm(final)=2.108 | 3787.0 samples/s | 59.2 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.15567 | Reg=0.00365 | FP-Reg=0.010 | acc=0.9531 | L2-Norm=19.100 | L2-Norm(final)=2.115 | 4242.1 samples/s | 66.3 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.14916 | Reg=0.00365 | FP-Reg=0.010 | acc=0.9219 | L2-Norm=19.116 | L2-Norm(final)=2.122 | 1485.0 samples/s | 23.2 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.14303 | Reg=0.00366 | FP-Reg=0.011 | acc=0.9688 | L2-Norm=19.131 | L2-Norm(final)=2.130 | 3161.3 samples/s | 49.4 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.13800 | Reg=0.00367 | FP-Reg=0.011 | acc=0.9531 | L2-Norm=19.145 | L2-Norm(final)=2.137 | 3191.2 samples/s | 49.9 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.13385 | Reg=0.00367 | FP-Reg=0.012 | acc=0.9844 | L2-Norm=19.159 | L2-Norm(final)=2.143 | 3253.0 samples/s | 50.8 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.12980 | Reg=0.00368 | FP-Reg=0.012 | acc=0.9844 | L2-Norm=19.171 | L2-Norm(final)=2.150 | 3236.7 samples/s | 50.6 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.12694 | Reg=0.00368 | FP-Reg=0.013 | acc=0.9844 | L2-Norm=19.184 | L2-Norm(final)=2.156 | 3567.5 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.1] | Loss=0.12868 | Reg=0.00359 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.936 | L2-Norm(final)=2.069 | 3727.1 samples/s | 58.2 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.05495 | Reg=0.00361 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.008 | L2-Norm(final)=2.086 | 3274.6 samples/s | 51.2 steps/s
[Step= 900 Epoch= 3.4] | Loss=0.03573 | Reg=0.00362 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.034 | L2-Norm(final)=2.094 | 3525.7 samples/s | 55.1 steps/s
[Step= 950 Epoch= 3.6] | Loss=0.02778 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.099 | 3567.0 samples/s | 55.7 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02177 | Reg=0.00363 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.104 | 3549.6 samples/s | 55.5 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.01778 | Reg=0.00362 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.037 | L2-Norm(final)=2.109 | 4302.7 samples/s | 67.2 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01498 | Reg=0.00362 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.032 | L2-Norm(final)=2.114 | 1616.9 samples/s | 25.3 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01299 | Reg=0.00362 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.027 | L2-Norm(final)=2.118 | 3538.5 samples/s | 55.3 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01150 | Reg=0.00362 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.021 | L2-Norm(final)=2.122 | 3585.7 samples/s | 56.0 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01042 | Reg=0.00362 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.016 | L2-Norm(final)=2.126 | 3528.5 samples/s | 55.1 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00952 | Reg=0.00361 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.012 | L2-Norm(final)=2.130 | 3860.8 samples/s | 60.3 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00874 | Reg=0.00361 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.133 | 1669.2 samples/s | 26.1 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00805 | Reg=0.00361 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.004 | L2-Norm(final)=2.137 | 3557.2 samples/s | 55.6 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00745 | Reg=0.00361 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.000 | L2-Norm(final)=2.140 | 3544.4 samples/s | 55.4 steps/s
[Step=1500 Epoch= 5.7] | Loss=0.00694 | Reg=0.00361 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.996 | L2-Norm(final)=2.143 | 3564.8 samples/s | 55.7 steps/s
[Step=1550 Epoch= 5.9] | Loss=0.00650 | Reg=0.00361 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.991 | L2-Norm(final)=2.146 | 3559.0 samples/s | 55.6 steps/s
[Step=1600 Epoch= 6.1] | Loss=0.00612 | Reg=0.00361 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.987 | L2-Norm(final)=2.149 | 1724.3 samples/s | 26.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41419 | acc=0.4730 | tpr=0.4420 | fpr=0.4599 | 3850.3 samples/s | 15.0 steps/s
Avg test loss: 0.41288, Avg test acc: 0.47420, Avg tpr: 0.44227, Avg fpr: 0.45558, total FA: 3554

Testing server on iccad2012
[Step=  50] | Loss=0.19385 | acc=0.8541 | tpr=0.9956 | fpr=0.1484 | 3851.3 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.19456 | acc=0.8539 | tpr=0.9979 | fpr=0.1488 | 7425.9 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.19530 | acc=0.8515 | tpr=0.9971 | fpr=0.1511 | 7426.0 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.19565 | acc=0.8518 | tpr=0.9967 | fpr=0.1508 | 7294.8 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.19542 | acc=0.8519 | tpr=0.9939 | fpr=0.1507 | 7405.2 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.19536 | acc=0.8522 | tpr=0.9942 | fpr=0.1503 | 7321.9 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.19585 | acc=0.8515 | tpr=0.9931 | fpr=0.1511 | 7554.0 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.19586 | acc=0.8515 | tpr=0.9929 | fpr=0.1511 | 7176.2 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.19642 | acc=0.8511 | tpr=0.9917 | fpr=0.1514 | 7371.4 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.19656 | acc=0.8508 | tpr=0.9912 | fpr=0.1517 | 7150.7 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.19616 | acc=0.8513 | tpr=0.9916 | fpr=0.1513 | 13666.7 samples/s | 53.4 steps/s
Avg test loss: 0.19611, Avg test acc: 0.85134, Avg tpr: 0.99168, Avg fpr: 0.15122, total FA: 20996

server round 2/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.42229 | Reg=0.00359 | FP-Reg=0.000 | acc=0.4375 | L2-Norm=18.945 | L2-Norm(final)=2.126 | 3858.2 samples/s | 60.3 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.22232 | Reg=0.00359 | FP-Reg=0.002 | acc=0.8750 | L2-Norm=18.953 | L2-Norm(final)=2.124 | 3491.5 samples/s | 54.6 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.19107 | Reg=0.00360 | FP-Reg=0.003 | acc=0.8594 | L2-Norm=18.975 | L2-Norm(final)=2.133 | 3763.6 samples/s | 58.8 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.16710 | Reg=0.00361 | FP-Reg=0.004 | acc=0.8594 | L2-Norm=18.997 | L2-Norm(final)=2.147 | 3767.3 samples/s | 58.9 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.15320 | Reg=0.00362 | FP-Reg=0.004 | acc=0.9219 | L2-Norm=19.015 | L2-Norm(final)=2.158 | 3758.5 samples/s | 58.7 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.14415 | Reg=0.00362 | FP-Reg=0.005 | acc=0.9062 | L2-Norm=19.033 | L2-Norm(final)=2.168 | 3781.3 samples/s | 59.1 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.13723 | Reg=0.00363 | FP-Reg=0.005 | acc=0.9219 | L2-Norm=19.049 | L2-Norm(final)=2.176 | 3783.8 samples/s | 59.1 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.13114 | Reg=0.00363 | FP-Reg=0.006 | acc=0.8750 | L2-Norm=19.064 | L2-Norm(final)=2.182 | 3787.5 samples/s | 59.2 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.12488 | Reg=0.00364 | FP-Reg=0.006 | acc=0.9062 | L2-Norm=19.079 | L2-Norm(final)=2.189 | 3766.9 samples/s | 58.9 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.12168 | Reg=0.00365 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.093 | L2-Norm(final)=2.196 | 3776.2 samples/s | 59.0 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.11850 | Reg=0.00365 | FP-Reg=0.007 | acc=0.9219 | L2-Norm=19.107 | L2-Norm(final)=2.201 | 4427.3 samples/s | 69.2 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.11399 | Reg=0.00366 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.121 | L2-Norm(final)=2.206 | 1662.1 samples/s | 26.0 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.11008 | Reg=0.00366 | FP-Reg=0.008 | acc=0.9375 | L2-Norm=19.135 | L2-Norm(final)=2.213 | 3734.8 samples/s | 58.4 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.10685 | Reg=0.00367 | FP-Reg=0.008 | acc=0.9531 | L2-Norm=19.148 | L2-Norm(final)=2.219 | 3715.3 samples/s | 58.1 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.10374 | Reg=0.00367 | FP-Reg=0.009 | acc=0.9219 | L2-Norm=19.161 | L2-Norm(final)=2.224 | 3749.4 samples/s | 58.6 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.10139 | Reg=0.00368 | FP-Reg=0.009 | acc=0.9688 | L2-Norm=19.174 | L2-Norm(final)=2.229 | 3759.6 samples/s | 58.7 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.09915 | Reg=0.00368 | FP-Reg=0.009 | acc=0.9375 | L2-Norm=19.186 | L2-Norm(final)=2.235 | 3735.7 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 6.1] | Loss=0.07386 | Reg=0.00359 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.945 | L2-Norm(final)=2.132 | 3676.8 samples/s | 57.5 steps/s
[Step=1650 Epoch= 6.3] | Loss=0.03819 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.999 | L2-Norm(final)=2.146 | 1503.2 samples/s | 23.5 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.03021 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.043 | L2-Norm(final)=2.139 | 3524.7 samples/s | 55.1 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.02262 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.054 | L2-Norm(final)=2.137 | 3519.5 samples/s | 55.0 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.01798 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.055 | L2-Norm(final)=2.140 | 3535.8 samples/s | 55.2 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.01491 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.053 | L2-Norm(final)=2.145 | 4251.4 samples/s | 66.4 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.01305 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.050 | L2-Norm(final)=2.149 | 1610.0 samples/s | 25.2 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.01129 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.046 | L2-Norm(final)=2.154 | 3488.0 samples/s | 54.5 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00991 | Reg=0.00363 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.041 | L2-Norm(final)=2.158 | 3533.2 samples/s | 55.2 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.00884 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.035 | L2-Norm(final)=2.162 | 3516.4 samples/s | 54.9 steps/s
[Step=2100 Epoch= 8.0] | Loss=0.00799 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.029 | L2-Norm(final)=2.166 | 3849.8 samples/s | 60.2 steps/s
[Step=2150 Epoch= 8.2] | Loss=0.00729 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.023 | L2-Norm(final)=2.169 | 1680.2 samples/s | 26.3 steps/s
[Step=2200 Epoch= 8.4] | Loss=0.00670 | Reg=0.00362 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.016 | L2-Norm(final)=2.173 | 3506.1 samples/s | 54.8 steps/s
[Step=2250 Epoch= 8.6] | Loss=0.00620 | Reg=0.00361 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.010 | L2-Norm(final)=2.176 | 3539.8 samples/s | 55.3 steps/s
[Step=2300 Epoch= 8.8] | Loss=0.00581 | Reg=0.00361 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.005 | L2-Norm(final)=2.179 | 3531.0 samples/s | 55.2 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.00545 | Reg=0.00361 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.000 | L2-Norm(final)=2.182 | 3545.4 samples/s | 55.4 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.00512 | Reg=0.00361 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.995 | L2-Norm(final)=2.185 | 1742.6 samples/s | 27.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32878 | acc=0.6267 | tpr=0.4973 | fpr=0.0922 | 3808.0 samples/s | 14.9 steps/s
Avg test loss: 0.32896, Avg test acc: 0.62838, Avg tpr: 0.50020, Avg fpr: 0.08973, total FA: 700

Testing server on iccad2012
[Step=  50] | Loss=0.18597 | acc=0.8673 | tpr=0.9912 | fpr=0.1350 | 3798.3 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.18679 | acc=0.8662 | tpr=0.9893 | fpr=0.1361 | 7276.9 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.18804 | acc=0.8661 | tpr=0.9885 | fpr=0.1362 | 7282.8 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.18826 | acc=0.8662 | tpr=0.9891 | fpr=0.1360 | 7367.7 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.18765 | acc=0.8668 | tpr=0.9869 | fpr=0.1354 | 7070.8 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.18752 | acc=0.8669 | tpr=0.9869 | fpr=0.1353 | 7237.1 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.18834 | acc=0.8661 | tpr=0.9843 | fpr=0.1360 | 7350.9 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.18838 | acc=0.8661 | tpr=0.9858 | fpr=0.1360 | 7337.9 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.18926 | acc=0.8658 | tpr=0.9854 | fpr=0.1363 | 6907.7 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.18947 | acc=0.8651 | tpr=0.9850 | fpr=0.1371 | 7386.9 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.18891 | acc=0.8657 | tpr=0.9849 | fpr=0.1365 | 12490.6 samples/s | 48.8 steps/s
Avg test loss: 0.18885, Avg test acc: 0.86574, Avg tpr: 0.98494, Avg fpr: 0.13642, total FA: 18942

server round 3/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 1.6] | Loss=0.33454 | Reg=0.00363 | FP-Reg=0.000 | acc=0.6406 | L2-Norm=19.040 | L2-Norm(final)=2.223 | 3842.8 samples/s | 60.0 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.13061 | Reg=0.00363 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.064 | L2-Norm(final)=2.225 | 3480.8 samples/s | 54.4 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.11619 | Reg=0.00364 | FP-Reg=0.003 | acc=0.9062 | L2-Norm=19.074 | L2-Norm(final)=2.231 | 3733.4 samples/s | 58.3 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.10766 | Reg=0.00364 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.092 | L2-Norm(final)=2.241 | 3720.9 samples/s | 58.1 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.10037 | Reg=0.00365 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.110 | L2-Norm(final)=2.251 | 3711.1 samples/s | 58.0 steps/s
[Step=1050 Epoch= 2.1] | Loss=0.09822 | Reg=0.00366 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.125 | L2-Norm(final)=2.257 | 3728.7 samples/s | 58.3 steps/s
[Step=1100 Epoch= 2.2] | Loss=0.09539 | Reg=0.00366 | FP-Reg=0.004 | acc=0.8594 | L2-Norm=19.141 | L2-Norm(final)=2.262 | 3732.7 samples/s | 58.3 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.09304 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9062 | L2-Norm=19.156 | L2-Norm(final)=2.267 | 3727.7 samples/s | 58.2 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.09076 | Reg=0.00368 | FP-Reg=0.005 | acc=0.8906 | L2-Norm=19.171 | L2-Norm(final)=2.270 | 3723.1 samples/s | 58.2 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.08814 | Reg=0.00368 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.184 | L2-Norm(final)=2.274 | 3733.1 samples/s | 58.3 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.08618 | Reg=0.00369 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.197 | L2-Norm(final)=2.278 | 4402.1 samples/s | 68.8 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.08304 | Reg=0.00369 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.208 | L2-Norm(final)=2.282 | 1659.1 samples/s | 25.9 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.08015 | Reg=0.00369 | FP-Reg=0.006 | acc=0.9062 | L2-Norm=19.220 | L2-Norm(final)=2.286 | 3730.7 samples/s | 58.3 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.07802 | Reg=0.00370 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.231 | L2-Norm(final)=2.290 | 3747.5 samples/s | 58.6 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.07641 | Reg=0.00370 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.242 | L2-Norm(final)=2.294 | 3722.9 samples/s | 58.2 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.07542 | Reg=0.00371 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.252 | L2-Norm(final)=2.297 | 3738.2 samples/s | 58.4 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.07443 | Reg=0.00371 | FP-Reg=0.007 | acc=0.9688 | L2-Norm=19.264 | L2-Norm(final)=2.299 | 3758.3 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step1600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 9.2] | Loss=0.08934 | Reg=0.00363 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.040 | L2-Norm(final)=2.224 | 3709.3 samples/s | 58.0 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.03565 | Reg=0.00365 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.103 | L2-Norm(final)=2.219 | 3373.2 samples/s | 52.7 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.02405 | Reg=0.00366 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.124 | L2-Norm(final)=2.217 | 3512.4 samples/s | 54.9 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.01708 | Reg=0.00366 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.125 | L2-Norm(final)=2.222 | 3540.2 samples/s | 55.3 steps/s
[Step=2600 Epoch=10.0] | Loss=0.01587 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.125 | L2-Norm(final)=2.225 | 3551.4 samples/s | 55.5 steps/s
[Step=2650 Epoch=10.2] | Loss=0.01351 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.227 | 4239.9 samples/s | 66.2 steps/s
[Step=2700 Epoch=10.3] | Loss=0.01137 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.136 | L2-Norm(final)=2.230 | 1613.7 samples/s | 25.2 steps/s
[Step=2750 Epoch=10.5] | Loss=0.00983 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.234 | 3538.8 samples/s | 55.3 steps/s
[Step=2800 Epoch=10.7] | Loss=0.00866 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=2.238 | 3511.0 samples/s | 54.9 steps/s
[Step=2850 Epoch=10.9] | Loss=0.00776 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.124 | L2-Norm(final)=2.241 | 3523.3 samples/s | 55.1 steps/s
[Step=2900 Epoch=11.1] | Loss=0.00701 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.119 | L2-Norm(final)=2.245 | 3835.8 samples/s | 59.9 steps/s
[Step=2950 Epoch=11.3] | Loss=0.00639 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.113 | L2-Norm(final)=2.249 | 1679.3 samples/s | 26.2 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00587 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.107 | L2-Norm(final)=2.252 | 3524.9 samples/s | 55.1 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00547 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.102 | L2-Norm(final)=2.255 | 3536.8 samples/s | 55.3 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00509 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.096 | L2-Norm(final)=2.258 | 3538.2 samples/s | 55.3 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00476 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.091 | L2-Norm(final)=2.261 | 3526.5 samples/s | 55.1 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00448 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.085 | L2-Norm(final)=2.264 | 1731.1 samples/s | 27.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28948 | acc=0.6901 | tpr=0.5822 | fpr=0.0756 | 3775.6 samples/s | 14.7 steps/s
Avg test loss: 0.29000, Avg test acc: 0.68908, Avg tpr: 0.58204, Avg fpr: 0.07550, total FA: 589

Testing server on iccad2012
[Step=  50] | Loss=0.19500 | acc=0.8606 | tpr=0.9912 | fpr=0.1417 | 3793.0 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.19612 | acc=0.8594 | tpr=0.9872 | fpr=0.1430 | 7367.5 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.19805 | acc=0.8582 | tpr=0.9856 | fpr=0.1442 | 7380.9 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.19869 | acc=0.8585 | tpr=0.9869 | fpr=0.1438 | 7121.6 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.19792 | acc=0.8586 | tpr=0.9834 | fpr=0.1436 | 7400.9 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.19768 | acc=0.8589 | tpr=0.9847 | fpr=0.1434 | 7217.5 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.19885 | acc=0.8579 | tpr=0.9818 | fpr=0.1443 | 7021.9 samples/s | 27.4 steps/s
[Step= 400] | Loss=0.19885 | acc=0.8580 | tpr=0.9819 | fpr=0.1442 | 7363.8 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.19986 | acc=0.8574 | tpr=0.9825 | fpr=0.1448 | 7280.1 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.20000 | acc=0.8567 | tpr=0.9819 | fpr=0.1456 | 6963.6 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.19944 | acc=0.8570 | tpr=0.9809 | fpr=0.1452 | 13442.2 samples/s | 52.5 steps/s
Avg test loss: 0.19935, Avg test acc: 0.85712, Avg tpr: 0.98098, Avg fpr: 0.14513, total FA: 20151

server round 4/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 1.6] | Loss=0.30178 | Reg=0.00364 | FP-Reg=0.000 | acc=0.5938 | L2-Norm=19.078 | L2-Norm(final)=2.246 | 3413.5 samples/s | 53.3 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.12258 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.102 | L2-Norm(final)=2.246 | 3691.0 samples/s | 57.7 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.10292 | Reg=0.00366 | FP-Reg=0.002 | acc=0.8750 | L2-Norm=19.122 | L2-Norm(final)=2.255 | 3733.6 samples/s | 58.3 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.09655 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.140 | L2-Norm(final)=2.262 | 3747.2 samples/s | 58.5 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.09198 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.157 | L2-Norm(final)=2.270 | 3751.6 samples/s | 58.6 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.08915 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.173 | L2-Norm(final)=2.275 | 3733.7 samples/s | 58.3 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.08692 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9062 | L2-Norm=19.188 | L2-Norm(final)=2.280 | 3759.3 samples/s | 58.7 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.08477 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.201 | L2-Norm(final)=2.284 | 3746.0 samples/s | 58.5 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.08307 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9062 | L2-Norm=19.214 | L2-Norm(final)=2.289 | 3756.8 samples/s | 58.7 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.08127 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.229 | L2-Norm(final)=2.292 | 3748.1 samples/s | 58.6 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.07981 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.242 | L2-Norm(final)=2.295 | 4370.4 samples/s | 68.3 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.07734 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.254 | L2-Norm(final)=2.298 | 1637.4 samples/s | 25.6 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.07486 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.266 | L2-Norm(final)=2.302 | 3705.5 samples/s | 57.9 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.07309 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.277 | L2-Norm(final)=2.307 | 3742.5 samples/s | 58.5 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.07199 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9219 | L2-Norm=19.287 | L2-Norm(final)=2.310 | 3743.8 samples/s | 58.5 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.07065 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.296 | L2-Norm(final)=2.314 | 3726.3 samples/s | 58.2 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.07008 | Reg=0.00373 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.306 | L2-Norm(final)=2.317 | 3740.4 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step1600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=12.3] | Loss=0.07230 | Reg=0.00364 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.078 | L2-Norm(final)=2.247 | 4002.2 samples/s | 62.5 steps/s
[Step=3250 Epoch=12.5] | Loss=0.03223 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.149 | L2-Norm(final)=2.239 | 3173.9 samples/s | 49.6 steps/s
[Step=3300 Epoch=12.6] | Loss=0.02103 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.173 | L2-Norm(final)=2.234 | 3506.4 samples/s | 54.8 steps/s
[Step=3350 Epoch=12.8] | Loss=0.01513 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.176 | L2-Norm(final)=2.237 | 3516.1 samples/s | 54.9 steps/s
[Step=3400 Epoch=13.0] | Loss=0.01170 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.170 | L2-Norm(final)=2.241 | 3517.5 samples/s | 55.0 steps/s
[Step=3450 Epoch=13.2] | Loss=0.00973 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.163 | L2-Norm(final)=2.247 | 4242.4 samples/s | 66.3 steps/s
[Step=3500 Epoch=13.4] | Loss=0.00818 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.156 | L2-Norm(final)=2.252 | 1610.9 samples/s | 25.2 steps/s
[Step=3550 Epoch=13.6] | Loss=0.00704 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.257 | 3538.1 samples/s | 55.3 steps/s
[Step=3600 Epoch=13.8] | Loss=0.00618 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.140 | L2-Norm(final)=2.261 | 3536.7 samples/s | 55.3 steps/s
[Step=3650 Epoch=14.0] | Loss=0.00551 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.132 | L2-Norm(final)=2.265 | 3542.5 samples/s | 55.4 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00498 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.124 | L2-Norm(final)=2.269 | 3832.1 samples/s | 59.9 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00455 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.117 | L2-Norm(final)=2.272 | 1685.4 samples/s | 26.3 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00418 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.110 | L2-Norm(final)=2.275 | 3528.8 samples/s | 55.1 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00387 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.104 | L2-Norm(final)=2.278 | 3502.8 samples/s | 54.7 steps/s
[Step=3900 Epoch=14.9] | Loss=0.00361 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.098 | L2-Norm(final)=2.281 | 3544.7 samples/s | 55.4 steps/s
[Step=3950 Epoch=15.1] | Loss=0.00338 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.092 | L2-Norm(final)=2.284 | 3510.2 samples/s | 54.8 steps/s
[Step=4000 Epoch=15.3] | Loss=0.00319 | Reg=0.00364 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.087 | L2-Norm(final)=2.287 | 1741.9 samples/s | 27.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27475 | acc=0.7215 | tpr=0.6308 | fpr=0.0815 | 3854.3 samples/s | 15.1 steps/s
Avg test loss: 0.27521, Avg test acc: 0.72029, Avg tpr: 0.62907, Avg fpr: 0.07909, total FA: 617

Testing server on iccad2012
[Step=  50] | Loss=0.22620 | acc=0.8427 | tpr=0.9956 | fpr=0.1601 | 3809.6 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.22782 | acc=0.8424 | tpr=0.9915 | fpr=0.1604 | 7345.3 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.22973 | acc=0.8414 | tpr=0.9885 | fpr=0.1614 | 7139.0 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.23063 | acc=0.8412 | tpr=0.9891 | fpr=0.1615 | 7290.7 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.22940 | acc=0.8414 | tpr=0.9886 | fpr=0.1613 | 7304.0 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.22945 | acc=0.8418 | tpr=0.9884 | fpr=0.1609 | 7234.4 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.23091 | acc=0.8407 | tpr=0.9856 | fpr=0.1619 | 7265.6 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.23086 | acc=0.8408 | tpr=0.9863 | fpr=0.1619 | 7464.1 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.23212 | acc=0.8402 | tpr=0.9869 | fpr=0.1625 | 7174.8 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.23224 | acc=0.8396 | tpr=0.9863 | fpr=0.1630 | 7083.9 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.23159 | acc=0.8400 | tpr=0.9865 | fpr=0.1627 | 13024.1 samples/s | 50.9 steps/s
Avg test loss: 0.23145, Avg test acc: 0.84008, Avg tpr: 0.98653, Avg fpr: 0.16258, total FA: 22574

server round 5/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=15.3] | Loss=0.06627 | Reg=0.00365 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.101 | L2-Norm(final)=2.281 | 3735.9 samples/s | 58.4 steps/s
[Step=4050 Epoch=15.5] | Loss=0.02825 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.176 | L2-Norm(final)=2.266 | 3290.3 samples/s | 51.4 steps/s
[Step=4100 Epoch=15.7] | Loss=0.01965 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.216 | L2-Norm(final)=2.255 | 3554.4 samples/s | 55.5 steps/s
[Step=4150 Epoch=15.9] | Loss=0.01499 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.219 | L2-Norm(final)=2.253 | 3518.2 samples/s | 55.0 steps/s
[Step=4200 Epoch=16.1] | Loss=0.01235 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.217 | L2-Norm(final)=2.253 | 3531.4 samples/s | 55.2 steps/s
[Step=4250 Epoch=16.3] | Loss=0.01089 | Reg=0.00369 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.213 | L2-Norm(final)=2.257 | 4242.5 samples/s | 66.3 steps/s
[Step=4300 Epoch=16.5] | Loss=0.01005 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.216 | L2-Norm(final)=2.258 | 1615.3 samples/s | 25.2 steps/s
[Step=4350 Epoch=16.7] | Loss=0.00892 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.217 | L2-Norm(final)=2.260 | 3550.1 samples/s | 55.5 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00794 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.216 | L2-Norm(final)=2.262 | 3527.7 samples/s | 55.1 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00714 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.213 | L2-Norm(final)=2.266 | 3534.1 samples/s | 55.2 steps/s
[Step=4500 Epoch=17.2] | Loss=0.00644 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.208 | L2-Norm(final)=2.269 | 3832.7 samples/s | 59.9 steps/s
[Step=4550 Epoch=17.4] | Loss=0.00588 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.201 | L2-Norm(final)=2.272 | 1678.3 samples/s | 26.2 steps/s
[Step=4600 Epoch=17.6] | Loss=0.00541 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.195 | L2-Norm(final)=2.276 | 3554.7 samples/s | 55.5 steps/s
[Step=4650 Epoch=17.8] | Loss=0.00501 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.188 | L2-Norm(final)=2.279 | 3512.6 samples/s | 54.9 steps/s
[Step=4700 Epoch=18.0] | Loss=0.00465 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.182 | L2-Norm(final)=2.282 | 3552.4 samples/s | 55.5 steps/s
[Step=4750 Epoch=18.2] | Loss=0.00435 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.175 | L2-Norm(final)=2.285 | 3546.5 samples/s | 55.4 steps/s
[Step=4800 Epoch=18.4] | Loss=0.00408 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.168 | L2-Norm(final)=2.288 | 1727.6 samples/s | 27.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step4800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.1] | Loss=0.05136 | Reg=0.00365 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=19.101 | L2-Norm(final)=2.280 | 3681.4 samples/s | 57.5 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.02173 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.107 | L2-Norm(final)=2.281 | 3384.8 samples/s | 52.9 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.01727 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.119 | L2-Norm(final)=2.274 | 3547.8 samples/s | 55.4 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.01252 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.122 | L2-Norm(final)=2.276 | 3520.9 samples/s | 55.0 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.00986 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.121 | L2-Norm(final)=2.280 | 3543.6 samples/s | 55.4 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.00809 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.118 | L2-Norm(final)=2.284 | 4314.1 samples/s | 67.4 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.00676 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.114 | L2-Norm(final)=2.288 | 1609.3 samples/s | 25.1 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.00586 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.109 | L2-Norm(final)=2.292 | 3490.2 samples/s | 54.5 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.00518 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.104 | L2-Norm(final)=2.295 | 3553.2 samples/s | 55.5 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.00464 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.100 | L2-Norm(final)=2.298 | 3495.2 samples/s | 54.6 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00427 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.096 | L2-Norm(final)=2.300 | 3907.7 samples/s | 61.1 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00389 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.093 | L2-Norm(final)=2.302 | 1677.7 samples/s | 26.2 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00358 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.089 | L2-Norm(final)=2.305 | 3520.9 samples/s | 55.0 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00331 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.085 | L2-Norm(final)=2.307 | 3525.5 samples/s | 55.1 steps/s
[Step=1500 Epoch= 5.8] | Loss=0.00309 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.081 | L2-Norm(final)=2.309 | 3523.9 samples/s | 55.1 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.00289 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.077 | L2-Norm(final)=2.311 | 3585.1 samples/s | 56.0 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.00271 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.074 | L2-Norm(final)=2.312 | 1733.1 samples/s | 27.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17702 | acc=0.8457 | tpr=0.8051 | fpr=0.0662 | 3837.1 samples/s | 15.0 steps/s
Avg test loss: 0.17798, Avg test acc: 0.84662, Avg tpr: 0.80638, Avg fpr: 0.06486, total FA: 506

Testing server on iccad2012
[Step=  50] | Loss=0.38034 | acc=0.7362 | tpr=0.9912 | fpr=0.2683 | 3796.1 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.38175 | acc=0.7375 | tpr=0.9872 | fpr=0.2672 | 7258.7 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.38327 | acc=0.7373 | tpr=0.9885 | fpr=0.2673 | 7210.9 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.38415 | acc=0.7378 | tpr=0.9847 | fpr=0.2667 | 7280.5 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.38225 | acc=0.7388 | tpr=0.9834 | fpr=0.2656 | 7388.3 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.38176 | acc=0.7393 | tpr=0.9855 | fpr=0.2651 | 7401.8 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.38371 | acc=0.7381 | tpr=0.9837 | fpr=0.2664 | 7208.4 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.38373 | acc=0.7380 | tpr=0.9852 | fpr=0.2665 | 7209.0 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.38565 | acc=0.7372 | tpr=0.9864 | fpr=0.2674 | 7290.0 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.38576 | acc=0.7368 | tpr=0.9859 | fpr=0.2677 | 7100.0 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.38498 | acc=0.7372 | tpr=0.9857 | fpr=0.2673 | 13070.2 samples/s | 51.1 steps/s
Avg test loss: 0.38488, Avg test acc: 0.73725, Avg tpr: 0.98574, Avg fpr: 0.26727, total FA: 37110

server round 6/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 3.1] | Loss=0.16118 | Reg=0.00367 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.165 | L2-Norm(final)=2.335 | 3697.3 samples/s | 57.8 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.08005 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9062 | L2-Norm=19.167 | L2-Norm(final)=2.334 | 3529.9 samples/s | 55.2 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.07474 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.181 | L2-Norm(final)=2.336 | 3718.0 samples/s | 58.1 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.07086 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.197 | L2-Norm(final)=2.342 | 3714.9 samples/s | 58.0 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.06717 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.212 | L2-Norm(final)=2.346 | 3736.6 samples/s | 58.4 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.06655 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.225 | L2-Norm(final)=2.349 | 3728.4 samples/s | 58.3 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.06462 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.238 | L2-Norm(final)=2.352 | 3745.9 samples/s | 58.5 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.06372 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.251 | L2-Norm(final)=2.356 | 3736.7 samples/s | 58.4 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.06317 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.263 | L2-Norm(final)=2.359 | 3736.1 samples/s | 58.4 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.06296 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9219 | L2-Norm=19.275 | L2-Norm(final)=2.361 | 3742.6 samples/s | 58.5 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.06212 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.287 | L2-Norm(final)=2.363 | 4343.6 samples/s | 67.9 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.06044 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.297 | L2-Norm(final)=2.364 | 1616.4 samples/s | 25.3 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.05904 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.308 | L2-Norm(final)=2.367 | 3738.3 samples/s | 58.4 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.05782 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.318 | L2-Norm(final)=2.370 | 3720.7 samples/s | 58.1 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.05687 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.327 | L2-Norm(final)=2.372 | 3740.2 samples/s | 58.4 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.05643 | Reg=0.00374 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.336 | L2-Norm(final)=2.374 | 3744.4 samples/s | 58.5 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.05561 | Reg=0.00374 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.344 | L2-Norm(final)=2.375 | 3758.5 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step2400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 6.2] | Loss=0.16045 | Reg=0.00367 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.165 | L2-Norm(final)=2.333 | 3638.9 samples/s | 56.9 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.02815 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.216 | L2-Norm(final)=2.298 | 3412.4 samples/s | 53.3 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.01694 | Reg=0.00369 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.219 | L2-Norm(final)=2.296 | 3532.2 samples/s | 55.2 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.01181 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.212 | L2-Norm(final)=2.303 | 3545.1 samples/s | 55.4 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.01118 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.207 | L2-Norm(final)=2.307 | 3543.5 samples/s | 55.4 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00940 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.206 | L2-Norm(final)=2.309 | 4282.8 samples/s | 66.9 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00802 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.205 | L2-Norm(final)=2.313 | 1605.7 samples/s | 25.1 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00690 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.201 | L2-Norm(final)=2.318 | 3544.4 samples/s | 55.4 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00607 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.197 | L2-Norm(final)=2.322 | 3534.2 samples/s | 55.2 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.00542 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.326 | 3536.3 samples/s | 55.3 steps/s
[Step=2100 Epoch= 8.1] | Loss=0.00489 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.186 | L2-Norm(final)=2.330 | 3907.1 samples/s | 61.0 steps/s
[Step=2150 Epoch= 8.3] | Loss=0.00445 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.181 | L2-Norm(final)=2.333 | 1676.9 samples/s | 26.2 steps/s
[Step=2200 Epoch= 8.5] | Loss=0.00408 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.176 | L2-Norm(final)=2.337 | 3546.0 samples/s | 55.4 steps/s
[Step=2250 Epoch= 8.7] | Loss=0.00378 | Reg=0.00368 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.171 | L2-Norm(final)=2.339 | 3530.7 samples/s | 55.2 steps/s
[Step=2300 Epoch= 8.9] | Loss=0.00351 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.166 | L2-Norm(final)=2.342 | 3525.6 samples/s | 55.1 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.00329 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.161 | L2-Norm(final)=2.345 | 3593.0 samples/s | 56.1 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.00309 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.156 | L2-Norm(final)=2.347 | 1720.9 samples/s | 26.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19494 | acc=0.8334 | tpr=0.7776 | fpr=0.0453 | 3824.6 samples/s | 14.9 steps/s
Avg test loss: 0.19674, Avg test acc: 0.83236, Avg tpr: 0.77595, Avg fpr: 0.04358, total FA: 340

Testing server on iccad2012
[Step=  50] | Loss=0.35002 | acc=0.7659 | tpr=0.9867 | fpr=0.2380 | 3786.2 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.35200 | acc=0.7672 | tpr=0.9765 | fpr=0.2367 | 7450.0 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.35408 | acc=0.7656 | tpr=0.9798 | fpr=0.2383 | 7059.1 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.35454 | acc=0.7657 | tpr=0.9770 | fpr=0.2382 | 7318.7 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.35236 | acc=0.7663 | tpr=0.9747 | fpr=0.2375 | 7406.5 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.35164 | acc=0.7667 | tpr=0.9753 | fpr=0.2371 | 7179.5 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.35334 | acc=0.7659 | tpr=0.9731 | fpr=0.2379 | 7480.0 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.35335 | acc=0.7661 | tpr=0.9754 | fpr=0.2377 | 7170.4 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.35548 | acc=0.7652 | tpr=0.9776 | fpr=0.2387 | 7103.4 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.35548 | acc=0.7649 | tpr=0.9771 | fpr=0.2389 | 7151.6 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.35466 | acc=0.7652 | tpr=0.9773 | fpr=0.2386 | 13514.4 samples/s | 52.8 steps/s
Avg test loss: 0.35455, Avg test acc: 0.76532, Avg tpr: 0.97742, Avg fpr: 0.23853, total FA: 33120

server round 7/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 3.1] | Loss=0.14314 | Reg=0.00368 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.181 | L2-Norm(final)=2.357 | 3825.6 samples/s | 59.8 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.07223 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.176 | L2-Norm(final)=2.360 | 3503.3 samples/s | 54.7 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.06610 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.186 | L2-Norm(final)=2.366 | 3727.7 samples/s | 58.2 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.06223 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.199 | L2-Norm(final)=2.371 | 3747.5 samples/s | 58.6 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.06064 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.211 | L2-Norm(final)=2.375 | 3745.8 samples/s | 58.5 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.06065 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.223 | L2-Norm(final)=2.377 | 3738.3 samples/s | 58.4 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.05998 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.235 | L2-Norm(final)=2.378 | 3750.6 samples/s | 58.6 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.06022 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.247 | L2-Norm(final)=2.379 | 3742.7 samples/s | 58.5 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.05942 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.260 | L2-Norm(final)=2.380 | 3753.2 samples/s | 58.6 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.05866 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.272 | L2-Norm(final)=2.382 | 3747.6 samples/s | 58.6 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.05792 | Reg=0.00372 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.284 | L2-Norm(final)=2.383 | 4393.5 samples/s | 68.6 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.05615 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.295 | L2-Norm(final)=2.385 | 1664.3 samples/s | 26.0 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.05514 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.307 | L2-Norm(final)=2.386 | 3728.0 samples/s | 58.2 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.05395 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9062 | L2-Norm=19.317 | L2-Norm(final)=2.388 | 3735.0 samples/s | 58.4 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.05292 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.327 | L2-Norm(final)=2.390 | 3731.4 samples/s | 58.3 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.05238 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.336 | L2-Norm(final)=2.392 | 3738.4 samples/s | 58.4 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.05183 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.345 | L2-Norm(final)=2.393 | 3744.0 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step2400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=18.4] | Loss=0.08651 | Reg=0.00368 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.181 | L2-Norm(final)=2.356 | 3800.7 samples/s | 59.4 steps/s
[Step=4850 Epoch=18.6] | Loss=0.01803 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.332 | 3246.3 samples/s | 50.7 steps/s
[Step=4900 Epoch=18.8] | Loss=0.01142 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.240 | L2-Norm(final)=2.336 | 3542.7 samples/s | 55.4 steps/s
[Step=4950 Epoch=19.0] | Loss=0.01173 | Reg=0.00370 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.246 | L2-Norm(final)=2.336 | 3525.8 samples/s | 55.1 steps/s
[Step=5000 Epoch=19.2] | Loss=0.01014 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.256 | L2-Norm(final)=2.332 | 3537.0 samples/s | 55.3 steps/s
[Step=5050 Epoch=19.3] | Loss=0.00860 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.260 | L2-Norm(final)=2.332 | 4248.4 samples/s | 66.4 steps/s
[Step=5100 Epoch=19.5] | Loss=0.00737 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.262 | L2-Norm(final)=2.334 | 1617.5 samples/s | 25.3 steps/s
[Step=5150 Epoch=19.7] | Loss=0.00638 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.338 | 3515.0 samples/s | 54.9 steps/s
[Step=5200 Epoch=19.9] | Loss=0.00561 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.257 | L2-Norm(final)=2.341 | 3526.1 samples/s | 55.1 steps/s
[Step=5250 Epoch=20.1] | Loss=0.00499 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.252 | L2-Norm(final)=2.345 | 3522.5 samples/s | 55.0 steps/s
[Step=5300 Epoch=20.3] | Loss=0.00452 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.245 | L2-Norm(final)=2.348 | 3840.6 samples/s | 60.0 steps/s
[Step=5350 Epoch=20.5] | Loss=0.00413 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.239 | L2-Norm(final)=2.351 | 1684.5 samples/s | 26.3 steps/s
[Step=5400 Epoch=20.7] | Loss=0.00378 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.233 | L2-Norm(final)=2.354 | 3531.6 samples/s | 55.2 steps/s
[Step=5450 Epoch=20.9] | Loss=0.00350 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.227 | L2-Norm(final)=2.357 | 3517.2 samples/s | 55.0 steps/s
[Step=5500 Epoch=21.1] | Loss=0.00325 | Reg=0.00369 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.359 | 3532.5 samples/s | 55.2 steps/s
[Step=5550 Epoch=21.3] | Loss=0.00304 | Reg=0.00369 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.214 | L2-Norm(final)=2.361 | 3544.6 samples/s | 55.4 steps/s
[Step=5600 Epoch=21.5] | Loss=0.00286 | Reg=0.00369 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.209 | L2-Norm(final)=2.364 | 1729.4 samples/s | 27.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.16856 | acc=0.8614 | tpr=0.8166 | fpr=0.0414 | 3899.3 samples/s | 15.2 steps/s
Avg test loss: 0.17044, Avg test acc: 0.86097, Avg tpr: 0.81675, Avg fpr: 0.04179, total FA: 326

Testing server on iccad2012
[Step=  50] | Loss=0.42340 | acc=0.7345 | tpr=0.9867 | fpr=0.2700 | 3830.0 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.42660 | acc=0.7362 | tpr=0.9829 | fpr=0.2684 | 7205.6 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.42893 | acc=0.7358 | tpr=0.9841 | fpr=0.2688 | 7176.6 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.42833 | acc=0.7362 | tpr=0.9803 | fpr=0.2683 | 7427.6 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.42551 | acc=0.7369 | tpr=0.9799 | fpr=0.2675 | 7211.9 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.42433 | acc=0.7374 | tpr=0.9804 | fpr=0.2670 | 7552.2 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.42560 | acc=0.7364 | tpr=0.9787 | fpr=0.2680 | 7062.5 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.42554 | acc=0.7364 | tpr=0.9798 | fpr=0.2680 | 7241.3 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.42772 | acc=0.7351 | tpr=0.9815 | fpr=0.2693 | 7061.3 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.42785 | acc=0.7349 | tpr=0.9815 | fpr=0.2696 | 6998.1 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.42677 | acc=0.7351 | tpr=0.9813 | fpr=0.2694 | 13435.6 samples/s | 52.5 steps/s
Avg test loss: 0.42665, Avg test acc: 0.73522, Avg tpr: 0.98138, Avg fpr: 0.26925, total FA: 37385

server round 8/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 4.7] | Loss=0.07897 | Reg=0.00369 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.210 | L2-Norm(final)=2.397 | 3568.3 samples/s | 55.8 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.06066 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.203 | L2-Norm(final)=2.402 | 3590.0 samples/s | 56.1 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.05928 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.208 | L2-Norm(final)=2.403 | 3738.9 samples/s | 58.4 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.05876 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.217 | L2-Norm(final)=2.400 | 3730.8 samples/s | 58.3 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.05588 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.229 | L2-Norm(final)=2.402 | 3739.5 samples/s | 58.4 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.05510 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.242 | L2-Norm(final)=2.404 | 3751.1 samples/s | 58.6 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.05524 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.255 | L2-Norm(final)=2.406 | 3748.4 samples/s | 58.6 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.05369 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.268 | L2-Norm(final)=2.408 | 3724.6 samples/s | 58.2 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.05336 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.281 | L2-Norm(final)=2.409 | 3760.9 samples/s | 58.8 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.05300 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.292 | L2-Norm(final)=2.408 | 3762.5 samples/s | 58.8 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.05288 | Reg=0.00373 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.303 | L2-Norm(final)=2.407 | 4354.7 samples/s | 68.0 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.05195 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.313 | L2-Norm(final)=2.406 | 1604.2 samples/s | 25.1 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.05094 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.322 | L2-Norm(final)=2.406 | 3743.4 samples/s | 58.5 steps/s
[Step=3050 Epoch= 5.9] | Loss=0.04981 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.331 | L2-Norm(final)=2.406 | 3711.7 samples/s | 58.0 steps/s
[Step=3100 Epoch= 6.0] | Loss=0.04931 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.340 | L2-Norm(final)=2.407 | 3745.0 samples/s | 58.5 steps/s
[Step=3150 Epoch= 6.1] | Loss=0.04853 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.349 | L2-Norm(final)=2.407 | 3716.8 samples/s | 58.1 steps/s
[Step=3200 Epoch= 6.2] | Loss=0.04793 | Reg=0.00375 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.358 | L2-Norm(final)=2.409 | 3772.6 samples/s | 58.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step3200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 9.2] | Loss=0.20150 | Reg=0.00369 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.210 | L2-Norm(final)=2.395 | 3833.3 samples/s | 59.9 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.01972 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.285 | L2-Norm(final)=2.365 | 3244.2 samples/s | 50.7 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.01663 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.298 | L2-Norm(final)=2.351 | 3542.2 samples/s | 55.3 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.01281 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.297 | L2-Norm(final)=2.346 | 3517.2 samples/s | 55.0 steps/s
[Step=2600 Epoch=10.0] | Loss=0.00988 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.291 | L2-Norm(final)=2.347 | 3536.0 samples/s | 55.2 steps/s
[Step=2650 Epoch=10.2] | Loss=0.00805 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.283 | L2-Norm(final)=2.351 | 4269.3 samples/s | 66.7 steps/s
[Step=2700 Epoch=10.4] | Loss=0.00709 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.276 | L2-Norm(final)=2.355 | 1609.4 samples/s | 25.1 steps/s
[Step=2750 Epoch=10.6] | Loss=0.00672 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.272 | L2-Norm(final)=2.358 | 3548.3 samples/s | 55.4 steps/s
[Step=2800 Epoch=10.8] | Loss=0.00595 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.268 | L2-Norm(final)=2.359 | 3523.2 samples/s | 55.0 steps/s
[Step=2850 Epoch=11.0] | Loss=0.00569 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.264 | L2-Norm(final)=2.361 | 3541.1 samples/s | 55.3 steps/s
[Step=2900 Epoch=11.2] | Loss=0.00556 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.263 | L2-Norm(final)=2.361 | 3936.7 samples/s | 61.5 steps/s
[Step=2950 Epoch=11.4] | Loss=0.00510 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.262 | L2-Norm(final)=2.362 | 1663.7 samples/s | 26.0 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00468 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.260 | L2-Norm(final)=2.363 | 3522.1 samples/s | 55.0 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00433 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.257 | L2-Norm(final)=2.365 | 3526.3 samples/s | 55.1 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00402 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.253 | L2-Norm(final)=2.367 | 3539.4 samples/s | 55.3 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00376 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.249 | L2-Norm(final)=2.369 | 3577.8 samples/s | 55.9 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00355 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.244 | L2-Norm(final)=2.371 | 1715.7 samples/s | 26.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22194 | acc=0.8177 | tpr=0.7493 | fpr=0.0339 | 3781.1 samples/s | 14.8 steps/s
Avg test loss: 0.22291, Avg test acc: 0.81825, Avg tpr: 0.75130, Avg fpr: 0.03448, total FA: 269

Testing server on iccad2012
[Step=  50] | Loss=0.32946 | acc=0.8004 | tpr=0.9956 | fpr=0.2031 | 3890.5 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.33492 | acc=0.8015 | tpr=0.9872 | fpr=0.2019 | 6979.2 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.33816 | acc=0.7996 | tpr=0.9870 | fpr=0.2038 | 7876.5 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.33835 | acc=0.7995 | tpr=0.9814 | fpr=0.2038 | 6971.8 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.33586 | acc=0.8007 | tpr=0.9808 | fpr=0.2025 | 7117.3 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.33489 | acc=0.8014 | tpr=0.9818 | fpr=0.2018 | 7238.0 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.33589 | acc=0.8007 | tpr=0.9793 | fpr=0.2025 | 7358.5 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.33590 | acc=0.8008 | tpr=0.9803 | fpr=0.2024 | 7108.3 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.33780 | acc=0.7999 | tpr=0.9820 | fpr=0.2034 | 7130.0 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.33789 | acc=0.7996 | tpr=0.9819 | fpr=0.2037 | 7516.6 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.33693 | acc=0.7999 | tpr=0.9817 | fpr=0.2034 | 12512.5 samples/s | 48.9 steps/s
Avg test loss: 0.33678, Avg test acc: 0.79997, Avg tpr: 0.98177, Avg fpr: 0.20334, total FA: 28233

server round 9/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch= 6.2] | Loss=0.27285 | Reg=0.00370 | FP-Reg=0.000 | acc=0.7656 | L2-Norm=19.234 | L2-Norm(final)=2.409 | 3365.8 samples/s | 52.6 steps/s
[Step=3250 Epoch= 6.3] | Loss=0.07104 | Reg=0.00370 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=2.396 | 3707.0 samples/s | 57.9 steps/s
[Step=3300 Epoch= 6.4] | Loss=0.06059 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.244 | L2-Norm(final)=2.398 | 3730.6 samples/s | 58.3 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.05591 | Reg=0.00371 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.252 | L2-Norm(final)=2.401 | 3726.0 samples/s | 58.2 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.05607 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.263 | L2-Norm(final)=2.403 | 3740.6 samples/s | 58.4 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.05340 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.274 | L2-Norm(final)=2.405 | 3755.4 samples/s | 58.7 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.05180 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.286 | L2-Norm(final)=2.408 | 3743.5 samples/s | 58.5 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.05168 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.297 | L2-Norm(final)=2.408 | 3744.4 samples/s | 58.5 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.05156 | Reg=0.00373 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.308 | L2-Norm(final)=2.409 | 3748.5 samples/s | 58.6 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.05105 | Reg=0.00373 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.317 | L2-Norm(final)=2.408 | 3737.1 samples/s | 58.4 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.05058 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.327 | L2-Norm(final)=2.407 | 4362.1 samples/s | 68.2 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.04908 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.336 | L2-Norm(final)=2.407 | 1620.0 samples/s | 25.3 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.04831 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.344 | L2-Norm(final)=2.408 | 3723.5 samples/s | 58.2 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.04767 | Reg=0.00375 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.354 | L2-Norm(final)=2.409 | 3736.9 samples/s | 58.4 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.04690 | Reg=0.00375 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.362 | L2-Norm(final)=2.409 | 3718.4 samples/s | 58.1 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.04635 | Reg=0.00375 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.370 | L2-Norm(final)=2.411 | 3736.7 samples/s | 58.4 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.04599 | Reg=0.00376 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.378 | L2-Norm(final)=2.412 | 3737.1 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step4000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=12.3] | Loss=0.10411 | Reg=0.00370 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.234 | L2-Norm(final)=2.409 | 3815.6 samples/s | 59.6 steps/s
[Step=3250 Epoch=12.5] | Loss=0.02795 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.258 | L2-Norm(final)=2.385 | 3285.5 samples/s | 51.3 steps/s
[Step=3300 Epoch=12.7] | Loss=0.01866 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.295 | L2-Norm(final)=2.368 | 3523.2 samples/s | 55.0 steps/s
[Step=3350 Epoch=12.9] | Loss=0.01349 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.302 | L2-Norm(final)=2.363 | 3529.2 samples/s | 55.1 steps/s
[Step=3400 Epoch=13.1] | Loss=0.01028 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.299 | L2-Norm(final)=2.366 | 3542.1 samples/s | 55.3 steps/s
[Step=3450 Epoch=13.3] | Loss=0.00839 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.294 | L2-Norm(final)=2.370 | 4288.9 samples/s | 67.0 steps/s
[Step=3500 Epoch=13.5] | Loss=0.00702 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.288 | L2-Norm(final)=2.375 | 1611.4 samples/s | 25.2 steps/s
[Step=3550 Epoch=13.7] | Loss=0.00603 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.281 | L2-Norm(final)=2.379 | 3523.6 samples/s | 55.1 steps/s
[Step=3600 Epoch=13.9] | Loss=0.00529 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.273 | L2-Norm(final)=2.383 | 3532.3 samples/s | 55.2 steps/s
[Step=3650 Epoch=14.1] | Loss=0.00471 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.266 | L2-Norm(final)=2.387 | 3547.4 samples/s | 55.4 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00424 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.259 | L2-Norm(final)=2.390 | 3907.5 samples/s | 61.1 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00386 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.252 | L2-Norm(final)=2.393 | 1671.5 samples/s | 26.1 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00355 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.246 | L2-Norm(final)=2.395 | 3541.5 samples/s | 55.3 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00328 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.240 | L2-Norm(final)=2.398 | 3512.0 samples/s | 54.9 steps/s
[Step=3900 Epoch=15.0] | Loss=0.00305 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.234 | L2-Norm(final)=2.400 | 3552.0 samples/s | 55.5 steps/s
[Step=3950 Epoch=15.2] | Loss=0.00285 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.228 | L2-Norm(final)=2.402 | 3594.2 samples/s | 56.2 steps/s
[Step=4000 Epoch=15.4] | Loss=0.00268 | Reg=0.00370 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.223 | L2-Norm(final)=2.405 | 1727.6 samples/s | 27.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18146 | acc=0.8510 | tpr=0.7980 | fpr=0.0339 | 3800.1 samples/s | 14.8 steps/s
Avg test loss: 0.18142, Avg test acc: 0.85183, Avg tpr: 0.80061, Avg fpr: 0.03551, total FA: 277

Testing server on iccad2012
[Step=  50] | Loss=0.38521 | acc=0.7662 | tpr=0.9867 | fpr=0.2377 | 3816.2 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.39061 | acc=0.7666 | tpr=0.9808 | fpr=0.2374 | 7139.4 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.39394 | acc=0.7650 | tpr=0.9827 | fpr=0.2390 | 7411.0 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.39355 | acc=0.7651 | tpr=0.9792 | fpr=0.2388 | 7342.0 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.39112 | acc=0.7657 | tpr=0.9808 | fpr=0.2382 | 7406.3 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.39029 | acc=0.7663 | tpr=0.9825 | fpr=0.2377 | 6951.2 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.39123 | acc=0.7655 | tpr=0.9818 | fpr=0.2384 | 7237.6 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.39106 | acc=0.7657 | tpr=0.9819 | fpr=0.2382 | 7523.7 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.39314 | acc=0.7645 | tpr=0.9830 | fpr=0.2395 | 7056.2 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.39336 | acc=0.7642 | tpr=0.9828 | fpr=0.2397 | 7115.6 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.39263 | acc=0.7648 | tpr=0.9821 | fpr=0.2392 | 13250.0 samples/s | 51.8 steps/s
Avg test loss: 0.39251, Avg test acc: 0.76487, Avg tpr: 0.98217, Avg fpr: 0.23908, total FA: 33196

server round 10/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=2401 Epoch= 4.7] | Loss=0.16355 | Reg=0.00370 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.234 | L2-Norm(final)=2.417 | 3794.1 samples/s | 59.3 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.05637 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.218 | L2-Norm(final)=2.418 | 3547.3 samples/s | 55.4 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.04901 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.214 | L2-Norm(final)=2.422 | 3741.0 samples/s | 58.5 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.04585 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.216 | L2-Norm(final)=2.427 | 3751.5 samples/s | 58.6 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.04338 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.219 | L2-Norm(final)=2.431 | 3754.9 samples/s | 58.7 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.04071 | Reg=0.00369 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.222 | L2-Norm(final)=2.435 | 3756.9 samples/s | 58.7 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.03983 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.225 | L2-Norm(final)=2.439 | 3755.5 samples/s | 58.7 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.04004 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.228 | L2-Norm(final)=2.441 | 3764.5 samples/s | 58.8 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.03915 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.231 | L2-Norm(final)=2.444 | 3756.8 samples/s | 58.7 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.03843 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.233 | L2-Norm(final)=2.446 | 3743.6 samples/s | 58.5 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.03765 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.236 | L2-Norm(final)=2.448 | 4422.3 samples/s | 69.1 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.03651 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.239 | L2-Norm(final)=2.451 | 1661.3 samples/s | 26.0 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.03546 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.242 | L2-Norm(final)=2.454 | 3700.0 samples/s | 57.8 steps/s
[Step=3050 Epoch= 6.0] | Loss=0.03481 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.245 | L2-Norm(final)=2.457 | 3753.3 samples/s | 58.6 steps/s
[Step=3100 Epoch= 6.1] | Loss=0.03425 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.248 | L2-Norm(final)=2.459 | 3751.3 samples/s | 58.6 steps/s
[Step=3150 Epoch= 6.2] | Loss=0.03358 | Reg=0.00371 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.252 | L2-Norm(final)=2.462 | 3740.4 samples/s | 58.4 steps/s
[Step=3200 Epoch= 6.3] | Loss=0.03325 | Reg=0.00371 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.255 | L2-Norm(final)=2.465 | 3736.4 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step3200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch=15.4] | Loss=0.06817 | Reg=0.00370 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.234 | L2-Norm(final)=2.417 | 3595.3 samples/s | 56.2 steps/s
[Step=4050 Epoch=15.6] | Loss=0.01539 | Reg=0.00370 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.234 | L2-Norm(final)=2.403 | 3455.1 samples/s | 54.0 steps/s
[Step=4100 Epoch=15.8] | Loss=0.00907 | Reg=0.00370 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.225 | L2-Norm(final)=2.406 | 3534.4 samples/s | 55.2 steps/s
[Step=4150 Epoch=16.0] | Loss=0.00674 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.217 | L2-Norm(final)=2.410 | 3550.0 samples/s | 55.5 steps/s
[Step=4200 Epoch=16.2] | Loss=0.00551 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.212 | L2-Norm(final)=2.413 | 3537.1 samples/s | 55.3 steps/s
[Step=4250 Epoch=16.4] | Loss=0.00456 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.208 | L2-Norm(final)=2.416 | 4295.5 samples/s | 67.1 steps/s
[Step=4300 Epoch=16.6] | Loss=0.00382 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.419 | 1615.2 samples/s | 25.2 steps/s
[Step=4350 Epoch=16.7] | Loss=0.00329 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.198 | L2-Norm(final)=2.421 | 3523.1 samples/s | 55.0 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00289 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.194 | L2-Norm(final)=2.423 | 3542.4 samples/s | 55.3 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00258 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.189 | L2-Norm(final)=2.424 | 3536.5 samples/s | 55.3 steps/s
[Step=4500 Epoch=17.3] | Loss=0.00233 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.185 | L2-Norm(final)=2.426 | 3911.8 samples/s | 61.1 steps/s
[Step=4550 Epoch=17.5] | Loss=0.00213 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.181 | L2-Norm(final)=2.428 | 1682.9 samples/s | 26.3 steps/s
[Step=4600 Epoch=17.7] | Loss=0.00195 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.178 | L2-Norm(final)=2.429 | 3525.0 samples/s | 55.1 steps/s
[Step=4650 Epoch=17.9] | Loss=0.00181 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.175 | L2-Norm(final)=2.430 | 3546.6 samples/s | 55.4 steps/s
[Step=4700 Epoch=18.1] | Loss=0.00168 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.171 | L2-Norm(final)=2.431 | 3550.5 samples/s | 55.5 steps/s
[Step=4750 Epoch=18.3] | Loss=0.00157 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.169 | L2-Norm(final)=2.433 | 3570.6 samples/s | 55.8 steps/s
[Step=4800 Epoch=18.5] | Loss=0.00148 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.166 | L2-Norm(final)=2.434 | 1700.4 samples/s | 26.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20644 | acc=0.8381 | tpr=0.7766 | fpr=0.0282 | 3808.2 samples/s | 14.9 steps/s
Avg test loss: 0.20746, Avg test acc: 0.83717, Avg tpr: 0.77694, Avg fpr: 0.03038, total FA: 237

Testing server on iccad2012
[Step=  50] | Loss=0.38907 | acc=0.7861 | tpr=0.9867 | fpr=0.2175 | 3798.9 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.39501 | acc=0.7873 | tpr=0.9829 | fpr=0.2163 | 7149.8 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.39854 | acc=0.7862 | tpr=0.9841 | fpr=0.2174 | 7288.7 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.39823 | acc=0.7863 | tpr=0.9836 | fpr=0.2173 | 7465.1 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.39581 | acc=0.7870 | tpr=0.9834 | fpr=0.2166 | 7213.8 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.39494 | acc=0.7878 | tpr=0.9840 | fpr=0.2158 | 7168.9 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.39582 | acc=0.7873 | tpr=0.9818 | fpr=0.2163 | 7286.1 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.39580 | acc=0.7879 | tpr=0.9825 | fpr=0.2156 | 7279.8 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.39799 | acc=0.7870 | tpr=0.9839 | fpr=0.2166 | 7199.1 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.39829 | acc=0.7865 | tpr=0.9837 | fpr=0.2170 | 7272.0 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.39738 | acc=0.7870 | tpr=0.9829 | fpr=0.2166 | 12765.8 samples/s | 49.9 steps/s
Avg test loss: 0.39724, Avg test acc: 0.78707, Avg tpr: 0.98296, Avg fpr: 0.21650, total FA: 30060

server round 11/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=3201 Epoch= 6.3] | Loss=0.13182 | Reg=0.00369 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.200 | L2-Norm(final)=2.442 | 3885.8 samples/s | 60.7 steps/s
[Step=3250 Epoch= 6.4] | Loss=0.04990 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.181 | L2-Norm(final)=2.440 | 3457.0 samples/s | 54.0 steps/s
[Step=3300 Epoch= 6.5] | Loss=0.04035 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.177 | L2-Norm(final)=2.446 | 3739.1 samples/s | 58.4 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.04055 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.176 | L2-Norm(final)=2.450 | 3727.0 samples/s | 58.2 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.04056 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.177 | L2-Norm(final)=2.453 | 3745.0 samples/s | 58.5 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.04031 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.180 | L2-Norm(final)=2.455 | 3716.8 samples/s | 58.1 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.03982 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=19.183 | L2-Norm(final)=2.457 | 3746.6 samples/s | 58.5 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.03914 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.186 | L2-Norm(final)=2.459 | 3759.0 samples/s | 58.7 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.03867 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.189 | L2-Norm(final)=2.461 | 3739.4 samples/s | 58.4 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.03811 | Reg=0.00368 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.463 | 3735.4 samples/s | 58.4 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.03746 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.196 | L2-Norm(final)=2.465 | 4399.9 samples/s | 68.7 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.03690 | Reg=0.00369 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.199 | L2-Norm(final)=2.468 | 1668.9 samples/s | 26.1 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.03561 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.203 | L2-Norm(final)=2.471 | 3720.7 samples/s | 58.1 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.03480 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.207 | L2-Norm(final)=2.474 | 3732.9 samples/s | 58.3 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.03396 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.211 | L2-Norm(final)=2.477 | 3758.4 samples/s | 58.7 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.03326 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.215 | L2-Norm(final)=2.480 | 3718.6 samples/s | 58.1 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.03280 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.219 | L2-Norm(final)=2.483 | 3746.2 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step4000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch=18.5] | Loss=0.16903 | Reg=0.00369 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.200 | L2-Norm(final)=2.441 | 3674.3 samples/s | 57.4 steps/s
[Step=4850 Epoch=18.7] | Loss=0.02282 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.186 | L2-Norm(final)=2.419 | 3424.6 samples/s | 53.5 steps/s
[Step=4900 Epoch=18.9] | Loss=0.01465 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.186 | L2-Norm(final)=2.401 | 3511.1 samples/s | 54.9 steps/s
[Step=4950 Epoch=19.1] | Loss=0.01046 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.181 | L2-Norm(final)=2.399 | 3515.3 samples/s | 54.9 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00806 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.175 | L2-Norm(final)=2.402 | 3515.6 samples/s | 54.9 steps/s
[Step=5050 Epoch=19.4] | Loss=0.00655 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.171 | L2-Norm(final)=2.405 | 4287.0 samples/s | 67.0 steps/s
[Step=5100 Epoch=19.6] | Loss=0.00550 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.166 | L2-Norm(final)=2.409 | 1614.6 samples/s | 25.2 steps/s
[Step=5150 Epoch=19.8] | Loss=0.00473 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.162 | L2-Norm(final)=2.412 | 3541.3 samples/s | 55.3 steps/s
[Step=5200 Epoch=20.0] | Loss=0.00415 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.415 | 3552.0 samples/s | 55.5 steps/s
[Step=5250 Epoch=20.2] | Loss=0.00370 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.153 | L2-Norm(final)=2.417 | 3502.7 samples/s | 54.7 steps/s
[Step=5300 Epoch=20.4] | Loss=0.00334 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.150 | L2-Norm(final)=2.420 | 3906.0 samples/s | 61.0 steps/s
[Step=5350 Epoch=20.6] | Loss=0.00304 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.146 | L2-Norm(final)=2.422 | 1677.9 samples/s | 26.2 steps/s
[Step=5400 Epoch=20.8] | Loss=0.00279 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.143 | L2-Norm(final)=2.424 | 3529.3 samples/s | 55.1 steps/s
[Step=5450 Epoch=21.0] | Loss=0.00258 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.139 | L2-Norm(final)=2.426 | 3532.1 samples/s | 55.2 steps/s
[Step=5500 Epoch=21.2] | Loss=0.00240 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.136 | L2-Norm(final)=2.428 | 3542.7 samples/s | 55.4 steps/s
[Step=5550 Epoch=21.4] | Loss=0.00224 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.429 | 3559.3 samples/s | 55.6 steps/s
[Step=5600 Epoch=21.6] | Loss=0.00211 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.131 | L2-Norm(final)=2.431 | 1735.2 samples/s | 27.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18371 | acc=0.8547 | tpr=0.8039 | fpr=0.0349 | 3807.5 samples/s | 14.9 steps/s
Avg test loss: 0.18460, Avg test acc: 0.85480, Avg tpr: 0.80439, Avg fpr: 0.03435, total FA: 268

Testing server on iccad2012
[Step=  50] | Loss=0.39824 | acc=0.7827 | tpr=0.9867 | fpr=0.2209 | 3839.1 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.40477 | acc=0.7840 | tpr=0.9829 | fpr=0.2197 | 7099.8 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.40911 | acc=0.7825 | tpr=0.9856 | fpr=0.2212 | 7809.8 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.40915 | acc=0.7826 | tpr=0.9858 | fpr=0.2211 | 7116.1 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.40656 | acc=0.7836 | tpr=0.9843 | fpr=0.2201 | 7025.0 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.40578 | acc=0.7842 | tpr=0.9855 | fpr=0.2194 | 7215.3 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.40693 | acc=0.7836 | tpr=0.9843 | fpr=0.2201 | 7198.1 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.40701 | acc=0.7841 | tpr=0.9847 | fpr=0.2195 | 7350.7 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.40967 | acc=0.7830 | tpr=0.9859 | fpr=0.2207 | 7206.4 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.40972 | acc=0.7828 | tpr=0.9859 | fpr=0.2209 | 7234.1 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.40888 | acc=0.7833 | tpr=0.9861 | fpr=0.2204 | 12840.8 samples/s | 50.2 steps/s
Avg test loss: 0.40874, Avg test acc: 0.78337, Avg tpr: 0.98613, Avg fpr: 0.22031, total FA: 30590

server round 12/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch= 7.8] | Loss=0.17383 | Reg=0.00368 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.186 | L2-Norm(final)=2.448 | 3467.5 samples/s | 54.2 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.04552 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.165 | L2-Norm(final)=2.448 | 3626.6 samples/s | 56.7 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.03931 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.162 | L2-Norm(final)=2.457 | 3724.2 samples/s | 58.2 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.03603 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.162 | L2-Norm(final)=2.464 | 3735.6 samples/s | 58.4 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.03552 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.164 | L2-Norm(final)=2.469 | 3748.9 samples/s | 58.6 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.03569 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.168 | L2-Norm(final)=2.473 | 3767.8 samples/s | 58.9 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.03483 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.171 | L2-Norm(final)=2.477 | 3754.0 samples/s | 58.7 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.03417 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.174 | L2-Norm(final)=2.480 | 3745.5 samples/s | 58.5 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.03425 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.177 | L2-Norm(final)=2.483 | 3746.2 samples/s | 58.5 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.03462 | Reg=0.00368 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.180 | L2-Norm(final)=2.485 | 3767.2 samples/s | 58.9 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.03408 | Reg=0.00368 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.184 | L2-Norm(final)=2.488 | 4375.0 samples/s | 68.4 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.03317 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.187 | L2-Norm(final)=2.490 | 1623.8 samples/s | 25.4 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.03212 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.190 | L2-Norm(final)=2.494 | 3711.7 samples/s | 58.0 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.03130 | Reg=0.00368 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.194 | L2-Norm(final)=2.497 | 3726.5 samples/s | 58.2 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.03082 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.197 | L2-Norm(final)=2.501 | 3735.1 samples/s | 58.4 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.03023 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.201 | L2-Norm(final)=2.505 | 3727.2 samples/s | 58.2 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.03008 | Reg=0.00369 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.205 | L2-Norm(final)=2.508 | 3758.9 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step4800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=21.6] | Loss=0.09729 | Reg=0.00368 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.186 | L2-Norm(final)=2.448 | 3484.6 samples/s | 54.4 steps/s
[Step=5650 Epoch=21.7] | Loss=0.01795 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.183 | L2-Norm(final)=2.433 | 3465.6 samples/s | 54.1 steps/s
[Step=5700 Epoch=21.9] | Loss=0.01139 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.181 | L2-Norm(final)=2.423 | 3547.0 samples/s | 55.4 steps/s
[Step=5750 Epoch=22.1] | Loss=0.00865 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.176 | L2-Norm(final)=2.421 | 3572.9 samples/s | 55.8 steps/s
[Step=5800 Epoch=22.3] | Loss=0.00679 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.171 | L2-Norm(final)=2.423 | 3521.8 samples/s | 55.0 steps/s
[Step=5850 Epoch=22.5] | Loss=0.00549 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.166 | L2-Norm(final)=2.425 | 4289.4 samples/s | 67.0 steps/s
[Step=5900 Epoch=22.7] | Loss=0.00463 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.161 | L2-Norm(final)=2.428 | 1613.2 samples/s | 25.2 steps/s
[Step=5950 Epoch=22.9] | Loss=0.00398 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.431 | 3532.5 samples/s | 55.2 steps/s
[Step=6000 Epoch=23.1] | Loss=0.00349 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.152 | L2-Norm(final)=2.433 | 3537.6 samples/s | 55.3 steps/s
[Step=6050 Epoch=23.3] | Loss=0.00312 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.436 | 3526.4 samples/s | 55.1 steps/s
[Step=6100 Epoch=23.5] | Loss=0.00281 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.143 | L2-Norm(final)=2.438 | 3904.6 samples/s | 61.0 steps/s
[Step=6150 Epoch=23.7] | Loss=0.00256 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.139 | L2-Norm(final)=2.440 | 1680.9 samples/s | 26.3 steps/s
[Step=6200 Epoch=23.9] | Loss=0.00235 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.136 | L2-Norm(final)=2.441 | 3525.0 samples/s | 55.1 steps/s
[Step=6250 Epoch=24.1] | Loss=0.00217 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.132 | L2-Norm(final)=2.443 | 3523.8 samples/s | 55.1 steps/s
[Step=6300 Epoch=24.3] | Loss=0.00202 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=2.445 | 3513.1 samples/s | 54.9 steps/s
[Step=6350 Epoch=24.4] | Loss=0.00189 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.125 | L2-Norm(final)=2.446 | 3591.7 samples/s | 56.1 steps/s
[Step=6400 Epoch=24.6] | Loss=0.00178 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.122 | L2-Norm(final)=2.447 | 1727.4 samples/s | 27.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19167 | acc=0.8504 | tpr=0.7996 | fpr=0.0394 | 3793.9 samples/s | 14.8 steps/s
Avg test loss: 0.19206, Avg test acc: 0.85063, Avg tpr: 0.80072, Avg fpr: 0.03961, total FA: 309

Testing server on iccad2012
[Step=  50] | Loss=0.42970 | acc=0.7788 | tpr=0.9912 | fpr=0.2250 | 3822.7 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.43600 | acc=0.7791 | tpr=0.9893 | fpr=0.2248 | 7444.6 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.44109 | acc=0.7783 | tpr=0.9899 | fpr=0.2256 | 7188.9 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.44148 | acc=0.7785 | tpr=0.9891 | fpr=0.2254 | 7425.9 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.43842 | acc=0.7793 | tpr=0.9878 | fpr=0.2245 | 7012.6 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.43740 | acc=0.7802 | tpr=0.9884 | fpr=0.2236 | 7203.0 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.43849 | acc=0.7798 | tpr=0.9869 | fpr=0.2240 | 7333.4 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.43873 | acc=0.7800 | tpr=0.9874 | fpr=0.2238 | 7262.7 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.44188 | acc=0.7788 | tpr=0.9883 | fpr=0.2250 | 7164.0 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.44210 | acc=0.7784 | tpr=0.9877 | fpr=0.2254 | 7126.0 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.44107 | acc=0.7787 | tpr=0.9881 | fpr=0.2251 | 13259.9 samples/s | 51.8 steps/s
Avg test loss: 0.44098, Avg test acc: 0.77878, Avg tpr: 0.98811, Avg fpr: 0.22503, total FA: 31245

server round 13/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4001 Epoch= 7.8] | Loss=0.13865 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.135 | L2-Norm(final)=2.486 | 3596.3 samples/s | 56.2 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.05204 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.116 | L2-Norm(final)=2.480 | 3706.6 samples/s | 57.9 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.04372 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.113 | L2-Norm(final)=2.485 | 3738.8 samples/s | 58.4 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.04096 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.113 | L2-Norm(final)=2.489 | 3752.8 samples/s | 58.6 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.03948 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.117 | L2-Norm(final)=2.494 | 3739.4 samples/s | 58.4 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.03746 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.122 | L2-Norm(final)=2.500 | 3758.1 samples/s | 58.7 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.03755 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.126 | L2-Norm(final)=2.505 | 3770.0 samples/s | 58.9 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.03709 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=2.507 | 3770.3 samples/s | 58.9 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.03682 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.133 | L2-Norm(final)=2.510 | 3757.7 samples/s | 58.7 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.03623 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.136 | L2-Norm(final)=2.513 | 3738.6 samples/s | 58.4 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.03595 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.140 | L2-Norm(final)=2.515 | 4415.8 samples/s | 69.0 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.03489 | Reg=0.00366 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.517 | 1658.5 samples/s | 25.9 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.03392 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.148 | L2-Norm(final)=2.520 | 3724.3 samples/s | 58.2 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.03305 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.151 | L2-Norm(final)=2.524 | 3748.3 samples/s | 58.6 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.03219 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.155 | L2-Norm(final)=2.527 | 3744.8 samples/s | 58.5 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.03196 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.158 | L2-Norm(final)=2.530 | 3720.7 samples/s | 58.1 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.03153 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.162 | L2-Norm(final)=2.533 | 3754.9 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step4800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=21.5] | Loss=0.05482 | Reg=0.00366 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.135 | L2-Norm(final)=2.486 | 3804.9 samples/s | 59.5 steps/s
[Step=5650 Epoch=21.6] | Loss=0.01025 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.131 | L2-Norm(final)=2.477 | 3271.5 samples/s | 51.1 steps/s
[Step=5700 Epoch=21.8] | Loss=0.00707 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.122 | L2-Norm(final)=2.472 | 3526.3 samples/s | 55.1 steps/s
[Step=5750 Epoch=22.0] | Loss=0.00534 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.115 | L2-Norm(final)=2.472 | 3524.3 samples/s | 55.1 steps/s
[Step=5800 Epoch=22.2] | Loss=0.00408 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.109 | L2-Norm(final)=2.474 | 3534.0 samples/s | 55.2 steps/s
[Step=5850 Epoch=22.4] | Loss=0.00342 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.103 | L2-Norm(final)=2.476 | 4250.0 samples/s | 66.4 steps/s
[Step=5900 Epoch=22.6] | Loss=0.00286 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.097 | L2-Norm(final)=2.478 | 1614.2 samples/s | 25.2 steps/s
[Step=5950 Epoch=22.8] | Loss=0.00247 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.092 | L2-Norm(final)=2.479 | 3522.9 samples/s | 55.0 steps/s
[Step=6000 Epoch=23.0] | Loss=0.00217 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.087 | L2-Norm(final)=2.481 | 3553.0 samples/s | 55.5 steps/s
[Step=6050 Epoch=23.2] | Loss=0.00193 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.083 | L2-Norm(final)=2.483 | 3548.5 samples/s | 55.4 steps/s
[Step=6100 Epoch=23.4] | Loss=0.00174 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.079 | L2-Norm(final)=2.484 | 3834.6 samples/s | 59.9 steps/s
[Step=6150 Epoch=23.6] | Loss=0.00159 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.075 | L2-Norm(final)=2.485 | 1669.3 samples/s | 26.1 steps/s
[Step=6200 Epoch=23.8] | Loss=0.00146 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.072 | L2-Norm(final)=2.486 | 3499.3 samples/s | 54.7 steps/s
[Step=6250 Epoch=23.9] | Loss=0.00135 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.069 | L2-Norm(final)=2.488 | 3524.1 samples/s | 55.1 steps/s
[Step=6300 Epoch=24.1] | Loss=0.00126 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.066 | L2-Norm(final)=2.489 | 3526.4 samples/s | 55.1 steps/s
[Step=6350 Epoch=24.3] | Loss=0.00118 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.063 | L2-Norm(final)=2.490 | 3513.2 samples/s | 54.9 steps/s
[Step=6400 Epoch=24.5] | Loss=0.00111 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.060 | L2-Norm(final)=2.491 | 1753.7 samples/s | 27.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20227 | acc=0.8461 | tpr=0.7907 | fpr=0.0337 | 3829.1 samples/s | 15.0 steps/s
Avg test loss: 0.20334, Avg test acc: 0.84706, Avg tpr: 0.79338, Avg fpr: 0.03487, total FA: 272

Testing server on iccad2012
[Step=  50] | Loss=0.43974 | acc=0.7834 | tpr=0.9912 | fpr=0.2204 | 3830.5 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.44708 | acc=0.7853 | tpr=0.9915 | fpr=0.2185 | 7187.8 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.45309 | acc=0.7840 | tpr=0.9914 | fpr=0.2199 | 7230.9 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.45406 | acc=0.7845 | tpr=0.9891 | fpr=0.2193 | 7330.1 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.45127 | acc=0.7844 | tpr=0.9869 | fpr=0.2193 | 7251.3 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.45025 | acc=0.7851 | tpr=0.9869 | fpr=0.2186 | 7395.1 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.45129 | acc=0.7844 | tpr=0.9862 | fpr=0.2193 | 7151.1 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.45140 | acc=0.7845 | tpr=0.9869 | fpr=0.2192 | 7371.7 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.45455 | acc=0.7835 | tpr=0.9883 | fpr=0.2202 | 7030.1 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.45491 | acc=0.7833 | tpr=0.9881 | fpr=0.2204 | 7368.7 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.45393 | acc=0.7837 | tpr=0.9885 | fpr=0.2200 | 13040.6 samples/s | 50.9 steps/s
Avg test loss: 0.45380, Avg test acc: 0.78381, Avg tpr: 0.98851, Avg fpr: 0.21991, total FA: 30534

server round 14/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch= 9.4] | Loss=0.14658 | Reg=0.00365 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.114 | L2-Norm(final)=2.526 | 3613.5 samples/s | 56.5 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.03997 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.090 | L2-Norm(final)=2.523 | 3396.5 samples/s | 53.1 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.03670 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.086 | L2-Norm(final)=2.530 | 3745.5 samples/s | 58.5 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.03431 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.085 | L2-Norm(final)=2.533 | 3734.9 samples/s | 58.4 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.03433 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.085 | L2-Norm(final)=2.536 | 3741.3 samples/s | 58.5 steps/s
[Step=5050 Epoch= 9.8] | Loss=0.03344 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.087 | L2-Norm(final)=2.539 | 3765.8 samples/s | 58.8 steps/s
[Step=5100 Epoch= 9.9] | Loss=0.03401 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=19.089 | L2-Norm(final)=2.540 | 3736.1 samples/s | 58.4 steps/s
[Step=5150 Epoch=10.0] | Loss=0.03374 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.092 | L2-Norm(final)=2.541 | 3758.1 samples/s | 58.7 steps/s
[Step=5200 Epoch=10.1] | Loss=0.03266 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.096 | L2-Norm(final)=2.544 | 3755.8 samples/s | 58.7 steps/s
[Step=5250 Epoch=10.2] | Loss=0.03243 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.100 | L2-Norm(final)=2.547 | 3734.8 samples/s | 58.4 steps/s
[Step=5300 Epoch=10.3] | Loss=0.03209 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.104 | L2-Norm(final)=2.550 | 4342.1 samples/s | 67.8 steps/s
[Step=5350 Epoch=10.4] | Loss=0.03143 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.108 | L2-Norm(final)=2.552 | 1636.3 samples/s | 25.6 steps/s
[Step=5400 Epoch=10.5] | Loss=0.03041 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.111 | L2-Norm(final)=2.554 | 3713.4 samples/s | 58.0 steps/s
[Step=5450 Epoch=10.6] | Loss=0.03014 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.114 | L2-Norm(final)=2.557 | 3716.4 samples/s | 58.1 steps/s
[Step=5500 Epoch=10.7] | Loss=0.02957 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.118 | L2-Norm(final)=2.559 | 3707.0 samples/s | 57.9 steps/s
[Step=5550 Epoch=10.8] | Loss=0.02890 | Reg=0.00366 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.122 | L2-Norm(final)=2.562 | 3711.8 samples/s | 58.0 steps/s
[Step=5600 Epoch=10.9] | Loss=0.02858 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.126 | L2-Norm(final)=2.565 | 3750.1 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step5600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=24.5] | Loss=0.17277 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.114 | L2-Norm(final)=2.525 | 3577.8 samples/s | 55.9 steps/s
[Step=6450 Epoch=24.7] | Loss=0.01573 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.122 | L2-Norm(final)=2.504 | 3454.7 samples/s | 54.0 steps/s
[Step=6500 Epoch=24.9] | Loss=0.01060 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.118 | L2-Norm(final)=2.498 | 3524.5 samples/s | 55.1 steps/s
[Step=6550 Epoch=25.1] | Loss=0.00871 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.115 | L2-Norm(final)=2.497 | 3519.1 samples/s | 55.0 steps/s
[Step=6600 Epoch=25.3] | Loss=0.00685 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.114 | L2-Norm(final)=2.497 | 3519.7 samples/s | 55.0 steps/s
[Step=6650 Epoch=25.5] | Loss=0.00571 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.110 | L2-Norm(final)=2.498 | 4260.2 samples/s | 66.6 steps/s
[Step=6700 Epoch=25.7] | Loss=0.00477 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.106 | L2-Norm(final)=2.500 | 1616.7 samples/s | 25.3 steps/s
[Step=6750 Epoch=25.9] | Loss=0.00410 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.102 | L2-Norm(final)=2.501 | 3513.3 samples/s | 54.9 steps/s
[Step=6800 Epoch=26.1] | Loss=0.00359 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.098 | L2-Norm(final)=2.503 | 3528.8 samples/s | 55.1 steps/s
[Step=6850 Epoch=26.2] | Loss=0.00320 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.093 | L2-Norm(final)=2.504 | 3536.1 samples/s | 55.3 steps/s
[Step=6900 Epoch=26.4] | Loss=0.00289 | Reg=0.00364 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.089 | L2-Norm(final)=2.506 | 3828.9 samples/s | 59.8 steps/s
[Step=6950 Epoch=26.6] | Loss=0.00263 | Reg=0.00364 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.085 | L2-Norm(final)=2.507 | 1693.7 samples/s | 26.5 steps/s
[Step=7000 Epoch=26.8] | Loss=0.00241 | Reg=0.00364 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.081 | L2-Norm(final)=2.509 | 3565.8 samples/s | 55.7 steps/s
[Step=7050 Epoch=27.0] | Loss=0.00223 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.078 | L2-Norm(final)=2.510 | 3544.6 samples/s | 55.4 steps/s
[Step=7100 Epoch=27.2] | Loss=0.00207 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.074 | L2-Norm(final)=2.511 | 3508.3 samples/s | 54.8 steps/s
[Step=7150 Epoch=27.4] | Loss=0.00194 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.071 | L2-Norm(final)=2.513 | 3517.5 samples/s | 55.0 steps/s
[Step=7200 Epoch=27.6] | Loss=0.00182 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.068 | L2-Norm(final)=2.514 | 1733.2 samples/s | 27.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21115 | acc=0.8380 | tpr=0.7794 | fpr=0.0347 | 3858.8 samples/s | 15.1 steps/s
Avg test loss: 0.21279, Avg test acc: 0.83893, Avg tpr: 0.78190, Avg fpr: 0.03564, total FA: 278

Testing server on iccad2012
[Step=  50] | Loss=0.41806 | acc=0.7977 | tpr=0.9912 | fpr=0.2057 | 3811.9 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.42725 | acc=0.7979 | tpr=0.9872 | fpr=0.2056 | 7361.6 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.43305 | acc=0.7965 | tpr=0.9885 | fpr=0.2070 | 7317.1 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.43420 | acc=0.7969 | tpr=0.9869 | fpr=0.2066 | 7231.2 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.43127 | acc=0.7970 | tpr=0.9852 | fpr=0.2064 | 7202.3 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.43090 | acc=0.7980 | tpr=0.9855 | fpr=0.2054 | 7305.2 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.43198 | acc=0.7978 | tpr=0.9850 | fpr=0.2055 | 7073.9 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.43229 | acc=0.7977 | tpr=0.9863 | fpr=0.2057 | 7735.2 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.43523 | acc=0.7968 | tpr=0.9878 | fpr=0.2067 | 6764.6 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.43570 | acc=0.7966 | tpr=0.9877 | fpr=0.2069 | 7304.4 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.43482 | acc=0.7970 | tpr=0.9877 | fpr=0.2065 | 13490.6 samples/s | 52.7 steps/s
Avg test loss: 0.43464, Avg test acc: 0.79705, Avg tpr: 0.98772, Avg fpr: 0.20641, total FA: 28660

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=10.9] | Loss=0.20338 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.090 | L2-Norm(final)=2.544 | 3622.0 samples/s | 56.6 steps/s
[Step=5650 Epoch=11.0] | Loss=0.04849 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.067 | L2-Norm(final)=2.532 | 3575.9 samples/s | 55.9 steps/s
[Step=5700 Epoch=11.1] | Loss=0.03996 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.065 | L2-Norm(final)=2.537 | 3706.6 samples/s | 57.9 steps/s
[Step=5750 Epoch=11.2] | Loss=0.03554 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.066 | L2-Norm(final)=2.542 | 3725.3 samples/s | 58.2 steps/s
[Step=5800 Epoch=11.3] | Loss=0.03511 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.069 | L2-Norm(final)=2.548 | 3716.6 samples/s | 58.1 steps/s
[Step=5850 Epoch=11.4] | Loss=0.03358 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.071 | L2-Norm(final)=2.552 | 3730.8 samples/s | 58.3 steps/s
[Step=5900 Epoch=11.5] | Loss=0.03218 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.075 | L2-Norm(final)=2.557 | 3743.6 samples/s | 58.5 steps/s
[Step=5950 Epoch=11.6] | Loss=0.03179 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.078 | L2-Norm(final)=2.560 | 3738.6 samples/s | 58.4 steps/s
[Step=6000 Epoch=11.7] | Loss=0.03274 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.081 | L2-Norm(final)=2.562 | 3757.5 samples/s | 58.7 steps/s
[Step=6050 Epoch=11.8] | Loss=0.03230 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.084 | L2-Norm(final)=2.563 | 3747.2 samples/s | 58.5 steps/s
[Step=6100 Epoch=11.9] | Loss=0.03180 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.087 | L2-Norm(final)=2.565 | 4336.8 samples/s | 67.8 steps/s
[Step=6150 Epoch=12.0] | Loss=0.03104 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.090 | L2-Norm(final)=2.566 | 1625.2 samples/s | 25.4 steps/s
[Step=6200 Epoch=12.1] | Loss=0.03027 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.093 | L2-Norm(final)=2.568 | 3736.3 samples/s | 58.4 steps/s
[Step=6250 Epoch=12.2] | Loss=0.02947 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.096 | L2-Norm(final)=2.571 | 3734.2 samples/s | 58.3 steps/s
[Step=6300 Epoch=12.3] | Loss=0.02873 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.099 | L2-Norm(final)=2.573 | 3726.9 samples/s | 58.2 steps/s
[Step=6350 Epoch=12.4] | Loss=0.02844 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.102 | L2-Norm(final)=2.576 | 3738.1 samples/s | 58.4 steps/s
[Step=6400 Epoch=12.5] | Loss=0.02799 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.104 | L2-Norm(final)=2.578 | 3756.1 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step6400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=4801 Epoch= 9.4] | Loss=0.09168 | Reg=0.00364 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.090 | L2-Norm(final)=2.545 | 3867.1 samples/s | 60.4 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.05226 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.072 | L2-Norm(final)=2.538 | 3465.3 samples/s | 54.1 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.04248 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.070 | L2-Norm(final)=2.539 | 3741.7 samples/s | 58.5 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.03889 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.071 | L2-Norm(final)=2.542 | 3730.1 samples/s | 58.3 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.03628 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=19.074 | L2-Norm(final)=2.545 | 3759.8 samples/s | 58.7 steps/s
[Step=5050 Epoch= 9.9] | Loss=0.03472 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.077 | L2-Norm(final)=2.548 | 3734.2 samples/s | 58.3 steps/s
[Step=5100 Epoch=10.0] | Loss=0.03455 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.081 | L2-Norm(final)=2.551 | 3758.7 samples/s | 58.7 steps/s
[Step=5150 Epoch=10.1] | Loss=0.03431 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.085 | L2-Norm(final)=2.554 | 3755.1 samples/s | 58.7 steps/s
[Step=5200 Epoch=10.2] | Loss=0.03362 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.088 | L2-Norm(final)=2.557 | 3757.2 samples/s | 58.7 steps/s
[Step=5250 Epoch=10.3] | Loss=0.03277 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.091 | L2-Norm(final)=2.559 | 3743.3 samples/s | 58.5 steps/s
[Step=5300 Epoch=10.4] | Loss=0.03245 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.095 | L2-Norm(final)=2.561 | 4400.2 samples/s | 68.8 steps/s
[Step=5350 Epoch=10.5] | Loss=0.03151 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.098 | L2-Norm(final)=2.564 | 1671.4 samples/s | 26.1 steps/s
[Step=5400 Epoch=10.6] | Loss=0.03038 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.103 | L2-Norm(final)=2.567 | 3674.0 samples/s | 57.4 steps/s
[Step=5450 Epoch=10.7] | Loss=0.02955 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.107 | L2-Norm(final)=2.570 | 3739.2 samples/s | 58.4 steps/s
[Step=5500 Epoch=10.8] | Loss=0.02931 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.110 | L2-Norm(final)=2.572 | 3742.9 samples/s | 58.5 steps/s
[Step=5550 Epoch=10.9] | Loss=0.02892 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.113 | L2-Norm(final)=2.575 | 3730.6 samples/s | 58.3 steps/s
[Step=5600 Epoch=10.9] | Loss=0.02874 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.116 | L2-Norm(final)=2.577 | 3770.3 samples/s | 58.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22137 | acc=0.8300 | tpr=0.7643 | fpr=0.0273 | 3815.3 samples/s | 14.9 steps/s
Avg test loss: 0.22295, Avg test acc: 0.83064, Avg tpr: 0.76727, Avg fpr: 0.03000, total FA: 234

Testing server on iccad2012
[Step=  50] | Loss=0.40386 | acc=0.8056 | tpr=0.9912 | fpr=0.1977 | 3890.4 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.41235 | acc=0.8054 | tpr=0.9893 | fpr=0.1980 | 7063.9 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.41787 | acc=0.8037 | tpr=0.9914 | fpr=0.1998 | 7197.0 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.41886 | acc=0.8038 | tpr=0.9913 | fpr=0.1996 | 7320.4 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.41550 | acc=0.8041 | tpr=0.9895 | fpr=0.1992 | 7125.5 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.41518 | acc=0.8049 | tpr=0.9891 | fpr=0.1985 | 7255.3 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.41579 | acc=0.8045 | tpr=0.9881 | fpr=0.1988 | 7394.9 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.41591 | acc=0.8044 | tpr=0.9891 | fpr=0.1990 | 7230.6 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.41861 | acc=0.8035 | tpr=0.9898 | fpr=0.1999 | 7161.7 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.41899 | acc=0.8031 | tpr=0.9894 | fpr=0.2002 | 7256.1 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.41805 | acc=0.8036 | tpr=0.9893 | fpr=0.1998 | 13344.8 samples/s | 52.1 steps/s
Avg test loss: 0.41784, Avg test acc: 0.80365, Avg tpr: 0.98930, Avg fpr: 0.19973, total FA: 27732

server round 16/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=12.5] | Loss=0.12522 | Reg=0.00363 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.065 | L2-Norm(final)=2.554 | 3547.7 samples/s | 55.4 steps/s
[Step=6450 Epoch=12.6] | Loss=0.04273 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9219 | L2-Norm=19.041 | L2-Norm(final)=2.552 | 3568.3 samples/s | 55.8 steps/s
[Step=6500 Epoch=12.7] | Loss=0.03761 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.039 | L2-Norm(final)=2.559 | 3728.6 samples/s | 58.3 steps/s
[Step=6550 Epoch=12.8] | Loss=0.03609 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.040 | L2-Norm(final)=2.564 | 3737.4 samples/s | 58.4 steps/s
[Step=6600 Epoch=12.9] | Loss=0.03429 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.043 | L2-Norm(final)=2.567 | 3732.2 samples/s | 58.3 steps/s
[Step=6650 Epoch=13.0] | Loss=0.03343 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.046 | L2-Norm(final)=2.572 | 3735.1 samples/s | 58.4 steps/s
[Step=6700 Epoch=13.1] | Loss=0.03247 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.049 | L2-Norm(final)=2.575 | 3728.8 samples/s | 58.3 steps/s
[Step=6750 Epoch=13.2] | Loss=0.03192 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.051 | L2-Norm(final)=2.576 | 3742.4 samples/s | 58.5 steps/s
[Step=6800 Epoch=13.3] | Loss=0.03179 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.054 | L2-Norm(final)=2.577 | 3745.3 samples/s | 58.5 steps/s
[Step=6850 Epoch=13.4] | Loss=0.03153 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.057 | L2-Norm(final)=2.579 | 3742.0 samples/s | 58.5 steps/s
[Step=6900 Epoch=13.5] | Loss=0.03076 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.061 | L2-Norm(final)=2.581 | 4348.5 samples/s | 67.9 steps/s
[Step=6950 Epoch=13.6] | Loss=0.02988 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.064 | L2-Norm(final)=2.583 | 1637.3 samples/s | 25.6 steps/s
[Step=7000 Epoch=13.7] | Loss=0.02915 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.067 | L2-Norm(final)=2.586 | 3737.7 samples/s | 58.4 steps/s
[Step=7050 Epoch=13.8] | Loss=0.02874 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.071 | L2-Norm(final)=2.588 | 3745.2 samples/s | 58.5 steps/s
[Step=7100 Epoch=13.8] | Loss=0.02849 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.074 | L2-Norm(final)=2.591 | 3743.8 samples/s | 58.5 steps/s
[Step=7150 Epoch=13.9] | Loss=0.02807 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.077 | L2-Norm(final)=2.593 | 3730.9 samples/s | 58.3 steps/s
[Step=7200 Epoch=14.0] | Loss=0.02783 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.080 | L2-Norm(final)=2.595 | 3759.0 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step7200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=6401 Epoch=24.6] | Loss=0.09761 | Reg=0.00363 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.065 | L2-Norm(final)=2.554 | 3762.1 samples/s | 58.8 steps/s
[Step=6450 Epoch=24.8] | Loss=0.01751 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.058 | L2-Norm(final)=2.528 | 3331.7 samples/s | 52.1 steps/s
[Step=6500 Epoch=25.0] | Loss=0.01119 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.060 | L2-Norm(final)=2.519 | 3549.8 samples/s | 55.5 steps/s
[Step=6550 Epoch=25.2] | Loss=0.00753 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.056 | L2-Norm(final)=2.520 | 3538.7 samples/s | 55.3 steps/s
[Step=6600 Epoch=25.4] | Loss=0.00573 | Reg=0.00363 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.049 | L2-Norm(final)=2.522 | 3539.4 samples/s | 55.3 steps/s
[Step=6650 Epoch=25.6] | Loss=0.00466 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.043 | L2-Norm(final)=2.525 | 4290.4 samples/s | 67.0 steps/s
[Step=6700 Epoch=25.8] | Loss=0.00390 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.037 | L2-Norm(final)=2.528 | 1610.1 samples/s | 25.2 steps/s
[Step=6750 Epoch=26.0] | Loss=0.00335 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.032 | L2-Norm(final)=2.531 | 3533.5 samples/s | 55.2 steps/s
[Step=6800 Epoch=26.2] | Loss=0.00294 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.027 | L2-Norm(final)=2.533 | 3506.8 samples/s | 54.8 steps/s
[Step=6850 Epoch=26.4] | Loss=0.00262 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.023 | L2-Norm(final)=2.535 | 3546.9 samples/s | 55.4 steps/s
[Step=6900 Epoch=26.6] | Loss=0.00236 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.019 | L2-Norm(final)=2.537 | 3934.1 samples/s | 61.5 steps/s
[Step=6950 Epoch=26.8] | Loss=0.00215 | Reg=0.00362 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.015 | L2-Norm(final)=2.539 | 1678.6 samples/s | 26.2 steps/s
[Step=7000 Epoch=26.9] | Loss=0.00198 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.012 | L2-Norm(final)=2.541 | 3514.2 samples/s | 54.9 steps/s
[Step=7050 Epoch=27.1] | Loss=0.00183 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.543 | 3546.9 samples/s | 55.4 steps/s
[Step=7100 Epoch=27.3] | Loss=0.00170 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.005 | L2-Norm(final)=2.544 | 3526.6 samples/s | 55.1 steps/s
[Step=7150 Epoch=27.5] | Loss=0.00159 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.002 | L2-Norm(final)=2.546 | 3588.1 samples/s | 56.1 steps/s
[Step=7200 Epoch=27.7] | Loss=0.00149 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.999 | L2-Norm(final)=2.547 | 1716.3 samples/s | 26.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22477 | acc=0.8263 | tpr=0.7572 | fpr=0.0238 | 3775.1 samples/s | 14.7 steps/s
Avg test loss: 0.22638, Avg test acc: 0.82659, Avg tpr: 0.75946, Avg fpr: 0.02577, total FA: 201

Testing server on iccad2012
[Step=  50] | Loss=0.39160 | acc=0.8081 | tpr=0.9867 | fpr=0.1951 | 3834.9 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.40131 | acc=0.8080 | tpr=0.9851 | fpr=0.1953 | 7187.1 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.40629 | acc=0.8074 | tpr=0.9870 | fpr=0.1959 | 7240.7 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.40688 | acc=0.8075 | tpr=0.9880 | fpr=0.1958 | 7210.7 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.40375 | acc=0.8080 | tpr=0.9860 | fpr=0.1952 | 7291.9 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.40342 | acc=0.8087 | tpr=0.9862 | fpr=0.1946 | 7261.4 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.40405 | acc=0.8084 | tpr=0.9856 | fpr=0.1948 | 7282.4 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.40403 | acc=0.8083 | tpr=0.9863 | fpr=0.1949 | 7198.5 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.40683 | acc=0.8077 | tpr=0.9869 | fpr=0.1955 | 7208.6 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.40706 | acc=0.8072 | tpr=0.9868 | fpr=0.1960 | 7039.7 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.40614 | acc=0.8075 | tpr=0.9865 | fpr=0.1957 | 13317.1 samples/s | 52.0 steps/s
Avg test loss: 0.40596, Avg test acc: 0.80755, Avg tpr: 0.98653, Avg fpr: 0.19570, total FA: 27173

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=14.0] | Loss=0.14856 | Reg=0.00362 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.035 | L2-Norm(final)=2.582 | 3442.4 samples/s | 53.8 steps/s
[Step=7250 Epoch=14.1] | Loss=0.04077 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.013 | L2-Norm(final)=2.581 | 3547.6 samples/s | 55.4 steps/s
[Step=7300 Epoch=14.2] | Loss=0.03614 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=19.009 | L2-Norm(final)=2.585 | 3720.4 samples/s | 58.1 steps/s
[Step=7350 Epoch=14.3] | Loss=0.03179 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.008 | L2-Norm(final)=2.589 | 3739.7 samples/s | 58.4 steps/s
[Step=7400 Epoch=14.4] | Loss=0.03037 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.010 | L2-Norm(final)=2.594 | 3747.6 samples/s | 58.6 steps/s
[Step=7450 Epoch=14.5] | Loss=0.03102 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.012 | L2-Norm(final)=2.597 | 3718.5 samples/s | 58.1 steps/s
[Step=7500 Epoch=14.6] | Loss=0.03000 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.017 | L2-Norm(final)=2.601 | 3727.4 samples/s | 58.2 steps/s
[Step=7550 Epoch=14.7] | Loss=0.02922 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9219 | L2-Norm=19.021 | L2-Norm(final)=2.604 | 3742.0 samples/s | 58.5 steps/s
[Step=7600 Epoch=14.8] | Loss=0.02872 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.025 | L2-Norm(final)=2.607 | 3754.2 samples/s | 58.7 steps/s
[Step=7650 Epoch=14.9] | Loss=0.02893 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.029 | L2-Norm(final)=2.610 | 3736.6 samples/s | 58.4 steps/s
[Step=7700 Epoch=15.0] | Loss=0.02896 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.032 | L2-Norm(final)=2.612 | 4345.6 samples/s | 67.9 steps/s
[Step=7750 Epoch=15.1] | Loss=0.02836 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.035 | L2-Norm(final)=2.613 | 1651.6 samples/s | 25.8 steps/s
[Step=7800 Epoch=15.2] | Loss=0.02799 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.038 | L2-Norm(final)=2.615 | 3728.9 samples/s | 58.3 steps/s
[Step=7850 Epoch=15.3] | Loss=0.02750 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.616 | 3718.0 samples/s | 58.1 steps/s
[Step=7900 Epoch=15.4] | Loss=0.02710 | Reg=0.00363 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.043 | L2-Norm(final)=2.618 | 3747.4 samples/s | 58.6 steps/s
[Step=7950 Epoch=15.5] | Loss=0.02662 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.046 | L2-Norm(final)=2.620 | 3735.4 samples/s | 58.4 steps/s
[Step=8000 Epoch=15.6] | Loss=0.02613 | Reg=0.00363 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.048 | L2-Norm(final)=2.622 | 3737.7 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=5601 Epoch=10.9] | Loss=0.14740 | Reg=0.00362 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.035 | L2-Norm(final)=2.582 | 3639.1 samples/s | 56.9 steps/s
[Step=5650 Epoch=11.0] | Loss=0.03953 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.012 | L2-Norm(final)=2.579 | 3664.9 samples/s | 57.3 steps/s
[Step=5700 Epoch=11.1] | Loss=0.03325 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.582 | 3729.1 samples/s | 58.3 steps/s
[Step=5750 Epoch=11.2] | Loss=0.03269 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.009 | L2-Norm(final)=2.588 | 3730.9 samples/s | 58.3 steps/s
[Step=5800 Epoch=11.3] | Loss=0.03202 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.011 | L2-Norm(final)=2.590 | 3742.5 samples/s | 58.5 steps/s
[Step=5850 Epoch=11.4] | Loss=0.03011 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.014 | L2-Norm(final)=2.593 | 3736.4 samples/s | 58.4 steps/s
[Step=5900 Epoch=11.5] | Loss=0.02985 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.017 | L2-Norm(final)=2.596 | 3734.8 samples/s | 58.4 steps/s
[Step=5950 Epoch=11.6] | Loss=0.02957 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.020 | L2-Norm(final)=2.598 | 3757.1 samples/s | 58.7 steps/s
[Step=6000 Epoch=11.7] | Loss=0.02928 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.023 | L2-Norm(final)=2.601 | 3722.4 samples/s | 58.2 steps/s
[Step=6050 Epoch=11.8] | Loss=0.02963 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.026 | L2-Norm(final)=2.603 | 3744.9 samples/s | 58.5 steps/s
[Step=6100 Epoch=11.9] | Loss=0.02945 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.029 | L2-Norm(final)=2.604 | 4391.0 samples/s | 68.6 steps/s
[Step=6150 Epoch=12.0] | Loss=0.02873 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.032 | L2-Norm(final)=2.605 | 1671.3 samples/s | 26.1 steps/s
[Step=6200 Epoch=12.1] | Loss=0.02820 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.036 | L2-Norm(final)=2.607 | 3731.0 samples/s | 58.3 steps/s
[Step=6250 Epoch=12.2] | Loss=0.02784 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.039 | L2-Norm(final)=2.608 | 3729.9 samples/s | 58.3 steps/s
[Step=6300 Epoch=12.3] | Loss=0.02738 | Reg=0.00363 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.042 | L2-Norm(final)=2.610 | 3729.7 samples/s | 58.3 steps/s
[Step=6350 Epoch=12.4] | Loss=0.02697 | Reg=0.00363 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.045 | L2-Norm(final)=2.612 | 3741.0 samples/s | 58.5 steps/s
[Step=6400 Epoch=12.5] | Loss=0.02680 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.047 | L2-Norm(final)=2.613 | 3755.2 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23323 | acc=0.8258 | tpr=0.7567 | fpr=0.0243 | 3782.4 samples/s | 14.8 steps/s
Avg test loss: 0.23497, Avg test acc: 0.82551, Avg tpr: 0.75800, Avg fpr: 0.02602, total FA: 203

Testing server on iccad2012
[Step=  50] | Loss=0.37880 | acc=0.8270 | tpr=0.9823 | fpr=0.1758 | 3889.8 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.39006 | acc=0.8254 | tpr=0.9851 | fpr=0.1776 | 7191.9 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.39538 | acc=0.8235 | tpr=0.9870 | fpr=0.1795 | 6951.3 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.39668 | acc=0.8233 | tpr=0.9858 | fpr=0.1796 | 7429.7 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.39353 | acc=0.8245 | tpr=0.9834 | fpr=0.1784 | 7225.8 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.39333 | acc=0.8249 | tpr=0.9833 | fpr=0.1780 | 7169.3 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.39392 | acc=0.8246 | tpr=0.9831 | fpr=0.1783 | 7217.3 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.39390 | acc=0.8247 | tpr=0.9847 | fpr=0.1782 | 7347.1 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.39686 | acc=0.8238 | tpr=0.9854 | fpr=0.1791 | 7073.9 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.39705 | acc=0.8235 | tpr=0.9855 | fpr=0.1794 | 7415.7 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.39604 | acc=0.8238 | tpr=0.9853 | fpr=0.1791 | 12637.7 samples/s | 49.4 steps/s
Avg test loss: 0.39593, Avg test acc: 0.82383, Avg tpr: 0.98534, Avg fpr: 0.17911, total FA: 24869

server round 18/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=27.6] | Loss=0.01956 | Reg=0.00361 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=19.007 | L2-Norm(final)=2.598 | 3633.2 samples/s | 56.8 steps/s
[Step=7250 Epoch=27.8] | Loss=0.00853 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.995 | L2-Norm(final)=2.595 | 3332.2 samples/s | 52.1 steps/s
[Step=7300 Epoch=28.0] | Loss=0.00572 | Reg=0.00361 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=18.991 | L2-Norm(final)=2.594 | 3533.2 samples/s | 55.2 steps/s
[Step=7350 Epoch=28.2] | Loss=0.00435 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.985 | L2-Norm(final)=2.594 | 3518.7 samples/s | 55.0 steps/s
[Step=7400 Epoch=28.4] | Loss=0.00334 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.980 | L2-Norm(final)=2.594 | 3539.3 samples/s | 55.3 steps/s
[Step=7450 Epoch=28.5] | Loss=0.00271 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.974 | L2-Norm(final)=2.596 | 4241.6 samples/s | 66.3 steps/s
[Step=7500 Epoch=28.7] | Loss=0.00227 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.969 | L2-Norm(final)=2.597 | 1608.5 samples/s | 25.1 steps/s
[Step=7550 Epoch=28.9] | Loss=0.00195 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.965 | L2-Norm(final)=2.599 | 3507.1 samples/s | 54.8 steps/s
[Step=7600 Epoch=29.1] | Loss=0.00171 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.960 | L2-Norm(final)=2.600 | 3273.7 samples/s | 51.2 steps/s
[Step=7650 Epoch=29.3] | Loss=0.00153 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.956 | L2-Norm(final)=2.602 | 3128.6 samples/s | 48.9 steps/s
[Step=7700 Epoch=29.5] | Loss=0.00138 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.952 | L2-Norm(final)=2.603 | 3749.6 samples/s | 58.6 steps/s
[Step=7750 Epoch=29.7] | Loss=0.00126 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.949 | L2-Norm(final)=2.604 | 1464.7 samples/s | 22.9 steps/s
[Step=7800 Epoch=29.9] | Loss=0.00115 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.945 | L2-Norm(final)=2.605 | 2920.7 samples/s | 45.6 steps/s
[Step=7850 Epoch=30.1] | Loss=0.00107 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.942 | L2-Norm(final)=2.606 | 2907.2 samples/s | 45.4 steps/s
[Step=7900 Epoch=30.3] | Loss=0.00099 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.939 | L2-Norm(final)=2.607 | 3273.6 samples/s | 51.1 steps/s
[Step=7950 Epoch=30.5] | Loss=0.00093 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.936 | L2-Norm(final)=2.607 | 3513.5 samples/s | 54.9 steps/s
[Step=8000 Epoch=30.7] | Loss=0.00087 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.933 | L2-Norm(final)=2.608 | 1736.7 samples/s | 27.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step8000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=7201 Epoch=27.7] | Loss=0.07975 | Reg=0.00361 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.007 | L2-Norm(final)=2.597 | 3604.1 samples/s | 56.3 steps/s
[Step=7250 Epoch=27.9] | Loss=0.01030 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.003 | L2-Norm(final)=2.589 | 3372.1 samples/s | 52.7 steps/s
[Step=7300 Epoch=28.1] | Loss=0.00578 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.002 | L2-Norm(final)=2.590 | 3544.5 samples/s | 55.4 steps/s
[Step=7350 Epoch=28.3] | Loss=0.00521 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.998 | L2-Norm(final)=2.592 | 3548.0 samples/s | 55.4 steps/s
[Step=7400 Epoch=28.5] | Loss=0.00553 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.999 | L2-Norm(final)=2.588 | 3516.8 samples/s | 54.9 steps/s
[Step=7450 Epoch=28.7] | Loss=0.00456 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.998 | L2-Norm(final)=2.587 | 4289.7 samples/s | 67.0 steps/s
[Step=7500 Epoch=28.9] | Loss=0.00393 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.996 | L2-Norm(final)=2.587 | 1603.3 samples/s | 25.1 steps/s
[Step=7550 Epoch=29.1] | Loss=0.00339 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.994 | L2-Norm(final)=2.587 | 3521.7 samples/s | 55.0 steps/s
[Step=7600 Epoch=29.3] | Loss=0.00300 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.991 | L2-Norm(final)=2.588 | 3507.2 samples/s | 54.8 steps/s
[Step=7650 Epoch=29.4] | Loss=0.00267 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.987 | L2-Norm(final)=2.590 | 3535.2 samples/s | 55.2 steps/s
[Step=7700 Epoch=29.6] | Loss=0.00241 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.984 | L2-Norm(final)=2.591 | 3901.0 samples/s | 61.0 steps/s
[Step=7750 Epoch=29.8] | Loss=0.00219 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.981 | L2-Norm(final)=2.592 | 1649.6 samples/s | 25.8 steps/s
[Step=7800 Epoch=30.0] | Loss=0.00201 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.977 | L2-Norm(final)=2.593 | 3509.9 samples/s | 54.8 steps/s
[Step=7850 Epoch=30.2] | Loss=0.00186 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.974 | L2-Norm(final)=2.594 | 3512.1 samples/s | 54.9 steps/s
[Step=7900 Epoch=30.4] | Loss=0.00173 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.971 | L2-Norm(final)=2.595 | 3517.6 samples/s | 55.0 steps/s
[Step=7950 Epoch=30.6] | Loss=0.00162 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.968 | L2-Norm(final)=2.596 | 3577.9 samples/s | 55.9 steps/s
[Step=8000 Epoch=30.8] | Loss=0.00152 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.965 | L2-Norm(final)=2.597 | 1711.1 samples/s | 26.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20487 | acc=0.8533 | tpr=0.7971 | fpr=0.0248 | 3817.4 samples/s | 14.9 steps/s
Avg test loss: 0.20668, Avg test acc: 0.85163, Avg tpr: 0.79635, Avg fpr: 0.02679, total FA: 209

Testing server on iccad2012
[Step=  50] | Loss=0.43519 | acc=0.8031 | tpr=0.9779 | fpr=0.2000 | 3872.7 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.44655 | acc=0.8011 | tpr=0.9808 | fpr=0.2022 | 7237.6 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.45273 | acc=0.7990 | tpr=0.9827 | fpr=0.2044 | 6997.5 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.45393 | acc=0.7991 | tpr=0.9803 | fpr=0.2042 | 7297.4 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.45027 | acc=0.7999 | tpr=0.9799 | fpr=0.2034 | 7355.8 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.44908 | acc=0.8005 | tpr=0.9796 | fpr=0.2028 | 7352.5 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.44955 | acc=0.8004 | tpr=0.9800 | fpr=0.2028 | 7183.8 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.44942 | acc=0.8006 | tpr=0.9819 | fpr=0.2027 | 7201.3 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.45267 | acc=0.7997 | tpr=0.9825 | fpr=0.2036 | 7129.1 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.45288 | acc=0.7993 | tpr=0.9828 | fpr=0.2040 | 7174.0 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.45153 | acc=0.7999 | tpr=0.9825 | fpr=0.2034 | 13399.7 samples/s | 52.3 steps/s
Avg test loss: 0.45147, Avg test acc: 0.79995, Avg tpr: 0.98257, Avg fpr: 0.20337, total FA: 28237

server round 19/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=30.7] | Loss=0.13388 | Reg=0.00360 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.972 | L2-Norm(final)=2.629 | 3571.2 samples/s | 55.8 steps/s
[Step=8050 Epoch=30.8] | Loss=0.00788 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.952 | L2-Norm(final)=2.617 | 3504.3 samples/s | 54.8 steps/s
[Step=8100 Epoch=31.0] | Loss=0.00616 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.951 | L2-Norm(final)=2.613 | 3549.2 samples/s | 55.5 steps/s
[Step=8150 Epoch=31.2] | Loss=0.00553 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.953 | L2-Norm(final)=2.612 | 3533.0 samples/s | 55.2 steps/s
[Step=8200 Epoch=31.4] | Loss=0.00426 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.953 | L2-Norm(final)=2.612 | 3533.1 samples/s | 55.2 steps/s
[Step=8250 Epoch=31.6] | Loss=0.00344 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.950 | L2-Norm(final)=2.614 | 4218.6 samples/s | 65.9 steps/s
[Step=8300 Epoch=31.8] | Loss=0.00287 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.947 | L2-Norm(final)=2.615 | 1614.0 samples/s | 25.2 steps/s
[Step=8350 Epoch=32.0] | Loss=0.00246 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.942 | L2-Norm(final)=2.617 | 3533.5 samples/s | 55.2 steps/s
[Step=8400 Epoch=32.2] | Loss=0.00216 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.938 | L2-Norm(final)=2.618 | 3553.7 samples/s | 55.5 steps/s
[Step=8450 Epoch=32.4] | Loss=0.00193 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.934 | L2-Norm(final)=2.619 | 3559.2 samples/s | 55.6 steps/s
[Step=8500 Epoch=32.6] | Loss=0.00174 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.930 | L2-Norm(final)=2.621 | 3814.9 samples/s | 59.6 steps/s
[Step=8550 Epoch=32.8] | Loss=0.00159 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.927 | L2-Norm(final)=2.622 | 1674.5 samples/s | 26.2 steps/s
[Step=8600 Epoch=33.0] | Loss=0.00146 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.923 | L2-Norm(final)=2.623 | 3512.8 samples/s | 54.9 steps/s
[Step=8650 Epoch=33.1] | Loss=0.00135 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.920 | L2-Norm(final)=2.624 | 3514.2 samples/s | 54.9 steps/s
[Step=8700 Epoch=33.3] | Loss=0.00125 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.916 | L2-Norm(final)=2.625 | 3499.3 samples/s | 54.7 steps/s
[Step=8750 Epoch=33.5] | Loss=0.00117 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.913 | L2-Norm(final)=2.626 | 3519.3 samples/s | 55.0 steps/s
[Step=8800 Epoch=33.7] | Loss=0.00110 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.910 | L2-Norm(final)=2.627 | 1742.0 samples/s | 27.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step8800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=30.8] | Loss=0.21241 | Reg=0.00360 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.972 | L2-Norm(final)=2.629 | 3607.0 samples/s | 56.4 steps/s
[Step=8050 Epoch=31.0] | Loss=0.01375 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.965 | L2-Norm(final)=2.608 | 3374.3 samples/s | 52.7 steps/s
[Step=8100 Epoch=31.2] | Loss=0.00750 | Reg=0.00360 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.964 | L2-Norm(final)=2.606 | 3511.7 samples/s | 54.9 steps/s
[Step=8150 Epoch=31.4] | Loss=0.00514 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.956 | L2-Norm(final)=2.609 | 3511.6 samples/s | 54.9 steps/s
[Step=8200 Epoch=31.6] | Loss=0.00388 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.948 | L2-Norm(final)=2.612 | 3508.9 samples/s | 54.8 steps/s
[Step=8250 Epoch=31.8] | Loss=0.00318 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.941 | L2-Norm(final)=2.615 | 4302.3 samples/s | 67.2 steps/s
[Step=8300 Epoch=31.9] | Loss=0.00269 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.936 | L2-Norm(final)=2.618 | 1613.8 samples/s | 25.2 steps/s
[Step=8350 Epoch=32.1] | Loss=0.00231 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.931 | L2-Norm(final)=2.621 | 3519.0 samples/s | 55.0 steps/s
[Step=8400 Epoch=32.3] | Loss=0.00203 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.926 | L2-Norm(final)=2.623 | 3526.5 samples/s | 55.1 steps/s
[Step=8450 Epoch=32.5] | Loss=0.00181 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.922 | L2-Norm(final)=2.625 | 3529.0 samples/s | 55.1 steps/s
[Step=8500 Epoch=32.7] | Loss=0.00172 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.918 | L2-Norm(final)=2.627 | 3923.6 samples/s | 61.3 steps/s
[Step=8550 Epoch=32.9] | Loss=0.00161 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.916 | L2-Norm(final)=2.628 | 1675.2 samples/s | 26.2 steps/s
[Step=8600 Epoch=33.1] | Loss=0.00148 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.914 | L2-Norm(final)=2.630 | 3521.4 samples/s | 55.0 steps/s
[Step=8650 Epoch=33.3] | Loss=0.00137 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.912 | L2-Norm(final)=2.631 | 3533.9 samples/s | 55.2 steps/s
[Step=8700 Epoch=33.5] | Loss=0.00128 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.910 | L2-Norm(final)=2.632 | 3559.5 samples/s | 55.6 steps/s
[Step=8750 Epoch=33.7] | Loss=0.00119 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.907 | L2-Norm(final)=2.634 | 3594.9 samples/s | 56.2 steps/s
[Step=8800 Epoch=33.9] | Loss=0.00112 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.905 | L2-Norm(final)=2.635 | 1732.7 samples/s | 27.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20157 | acc=0.8555 | tpr=0.8009 | fpr=0.0260 | 3782.0 samples/s | 14.8 steps/s
Avg test loss: 0.20399, Avg test acc: 0.85367, Avg tpr: 0.79950, Avg fpr: 0.02718, total FA: 212

Testing server on iccad2012
[Step=  50] | Loss=0.44852 | acc=0.8003 | tpr=0.9823 | fpr=0.2030 | 3853.1 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.46076 | acc=0.7988 | tpr=0.9851 | fpr=0.2047 | 7088.4 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.46710 | acc=0.7970 | tpr=0.9856 | fpr=0.2065 | 7305.3 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.46854 | acc=0.7976 | tpr=0.9858 | fpr=0.2058 | 7253.5 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.46496 | acc=0.7982 | tpr=0.9852 | fpr=0.2052 | 7296.5 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.46355 | acc=0.7989 | tpr=0.9855 | fpr=0.2045 | 7191.0 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.46417 | acc=0.7985 | tpr=0.9843 | fpr=0.2048 | 7280.9 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.46410 | acc=0.7988 | tpr=0.9858 | fpr=0.2046 | 7424.4 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.46726 | acc=0.7982 | tpr=0.9864 | fpr=0.2053 | 7025.7 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.46728 | acc=0.7982 | tpr=0.9863 | fpr=0.2052 | 7213.0 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.46591 | acc=0.7989 | tpr=0.9861 | fpr=0.2045 | 13037.1 samples/s | 50.9 steps/s
Avg test loss: 0.46575, Avg test acc: 0.79893, Avg tpr: 0.98613, Avg fpr: 0.20447, total FA: 28390

server round 20/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=33.7] | Loss=0.10010 | Reg=0.00359 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.954 | L2-Norm(final)=2.646 | 3576.1 samples/s | 55.9 steps/s
[Step=8850 Epoch=33.9] | Loss=0.00659 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.923 | L2-Norm(final)=2.645 | 3489.5 samples/s | 54.5 steps/s
[Step=8900 Epoch=34.1] | Loss=0.00408 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.911 | L2-Norm(final)=2.646 | 3541.1 samples/s | 55.3 steps/s
[Step=8950 Epoch=34.3] | Loss=0.00286 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.903 | L2-Norm(final)=2.647 | 3541.3 samples/s | 55.3 steps/s
[Step=9000 Epoch=34.5] | Loss=0.00235 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.897 | L2-Norm(final)=2.649 | 3535.2 samples/s | 55.2 steps/s
[Step=9050 Epoch=34.7] | Loss=0.00199 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.893 | L2-Norm(final)=2.650 | 4244.1 samples/s | 66.3 steps/s
[Step=9100 Epoch=34.9] | Loss=0.00167 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.889 | L2-Norm(final)=2.651 | 1622.1 samples/s | 25.3 steps/s
[Step=9150 Epoch=35.1] | Loss=0.00144 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.886 | L2-Norm(final)=2.652 | 3533.1 samples/s | 55.2 steps/s
[Step=9200 Epoch=35.3] | Loss=0.00129 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.883 | L2-Norm(final)=2.653 | 3506.2 samples/s | 54.8 steps/s
[Step=9250 Epoch=35.4] | Loss=0.00115 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.880 | L2-Norm(final)=2.654 | 3541.2 samples/s | 55.3 steps/s
[Step=9300 Epoch=35.6] | Loss=0.00104 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.877 | L2-Norm(final)=2.654 | 3832.3 samples/s | 59.9 steps/s
[Step=9350 Epoch=35.8] | Loss=0.00095 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.875 | L2-Norm(final)=2.655 | 1661.7 samples/s | 26.0 steps/s
[Step=9400 Epoch=36.0] | Loss=0.00087 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.873 | L2-Norm(final)=2.655 | 3543.8 samples/s | 55.4 steps/s
[Step=9450 Epoch=36.2] | Loss=0.00081 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.870 | L2-Norm(final)=2.656 | 3510.9 samples/s | 54.9 steps/s
[Step=9500 Epoch=36.4] | Loss=0.00075 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.868 | L2-Norm(final)=2.656 | 3525.5 samples/s | 55.1 steps/s
[Step=9550 Epoch=36.6] | Loss=0.00070 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.866 | L2-Norm(final)=2.657 | 3529.1 samples/s | 55.1 steps/s
[Step=9600 Epoch=36.8] | Loss=0.00066 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.865 | L2-Norm(final)=2.657 | 1736.7 samples/s | 27.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step9600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=33.9] | Loss=0.04888 | Reg=0.00359 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.954 | L2-Norm(final)=2.646 | 3657.5 samples/s | 57.1 steps/s
[Step=8850 Epoch=34.1] | Loss=0.01335 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.927 | L2-Norm(final)=2.633 | 3394.1 samples/s | 53.0 steps/s
[Step=8900 Epoch=34.3] | Loss=0.00702 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.915 | L2-Norm(final)=2.632 | 3540.7 samples/s | 55.3 steps/s
[Step=8950 Epoch=34.5] | Loss=0.00493 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.908 | L2-Norm(final)=2.634 | 3521.2 samples/s | 55.0 steps/s
[Step=9000 Epoch=34.6] | Loss=0.00380 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.902 | L2-Norm(final)=2.636 | 3537.8 samples/s | 55.3 steps/s
[Step=9050 Epoch=34.8] | Loss=0.00310 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.897 | L2-Norm(final)=2.638 | 4274.1 samples/s | 66.8 steps/s
[Step=9100 Epoch=35.0] | Loss=0.00260 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.893 | L2-Norm(final)=2.640 | 1614.8 samples/s | 25.2 steps/s
[Step=9150 Epoch=35.2] | Loss=0.00224 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.890 | L2-Norm(final)=2.641 | 3526.0 samples/s | 55.1 steps/s
[Step=9200 Epoch=35.4] | Loss=0.00197 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.886 | L2-Norm(final)=2.642 | 3513.7 samples/s | 54.9 steps/s
[Step=9250 Epoch=35.6] | Loss=0.00176 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.883 | L2-Norm(final)=2.643 | 3521.9 samples/s | 55.0 steps/s
[Step=9300 Epoch=35.8] | Loss=0.00158 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.881 | L2-Norm(final)=2.644 | 3921.4 samples/s | 61.3 steps/s
[Step=9350 Epoch=36.0] | Loss=0.00144 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.878 | L2-Norm(final)=2.645 | 1640.4 samples/s | 25.6 steps/s
[Step=9400 Epoch=36.2] | Loss=0.00133 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.876 | L2-Norm(final)=2.646 | 3524.1 samples/s | 55.1 steps/s
[Step=9450 Epoch=36.4] | Loss=0.00123 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.873 | L2-Norm(final)=2.647 | 3504.0 samples/s | 54.8 steps/s
[Step=9500 Epoch=36.6] | Loss=0.00114 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.871 | L2-Norm(final)=2.648 | 3501.5 samples/s | 54.7 steps/s
[Step=9550 Epoch=36.8] | Loss=0.00107 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.869 | L2-Norm(final)=2.648 | 3581.1 samples/s | 56.0 steps/s
[Step=9600 Epoch=37.0] | Loss=0.00101 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.868 | L2-Norm(final)=2.649 | 1717.2 samples/s | 26.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19644 | acc=0.8613 | tpr=0.8091 | fpr=0.0253 | 3846.9 samples/s | 15.0 steps/s
Avg test loss: 0.19927, Avg test acc: 0.86025, Avg tpr: 0.80853, Avg fpr: 0.02602, total FA: 203

Testing server on iccad2012
[Step=  50] | Loss=0.46196 | acc=0.7910 | tpr=0.9735 | fpr=0.2123 | 3823.2 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.47384 | acc=0.7904 | tpr=0.9765 | fpr=0.2131 | 7134.2 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.47999 | acc=0.7881 | tpr=0.9798 | fpr=0.2154 | 7323.2 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.48091 | acc=0.7884 | tpr=0.9792 | fpr=0.2151 | 7398.9 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.47756 | acc=0.7895 | tpr=0.9790 | fpr=0.2140 | 7125.1 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.47585 | acc=0.7897 | tpr=0.9789 | fpr=0.2138 | 7275.0 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.47608 | acc=0.7893 | tpr=0.9793 | fpr=0.2141 | 7254.1 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.47538 | acc=0.7896 | tpr=0.9809 | fpr=0.2139 | 7389.8 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.47872 | acc=0.7887 | tpr=0.9815 | fpr=0.2148 | 6991.2 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.47889 | acc=0.7885 | tpr=0.9824 | fpr=0.2150 | 7133.0 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.47744 | acc=0.7892 | tpr=0.9821 | fpr=0.2143 | 13421.3 samples/s | 52.4 steps/s
Avg test loss: 0.47733, Avg test acc: 0.78922, Avg tpr: 0.98217, Avg fpr: 0.21428, total FA: 29753

server round 21/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=15.6] | Loss=0.06540 | Reg=0.00359 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.947 | L2-Norm(final)=2.654 | 3568.8 samples/s | 55.8 steps/s
[Step=8050 Epoch=15.7] | Loss=0.03180 | Reg=0.00358 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.918 | L2-Norm(final)=2.653 | 3494.4 samples/s | 54.6 steps/s
[Step=8100 Epoch=15.8] | Loss=0.02826 | Reg=0.00358 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.909 | L2-Norm(final)=2.654 | 3717.4 samples/s | 58.1 steps/s
[Step=8150 Epoch=15.9] | Loss=0.02450 | Reg=0.00357 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.905 | L2-Norm(final)=2.656 | 3711.1 samples/s | 58.0 steps/s
[Step=8200 Epoch=16.0] | Loss=0.02352 | Reg=0.00357 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.903 | L2-Norm(final)=2.658 | 3732.6 samples/s | 58.3 steps/s
[Step=8250 Epoch=16.1] | Loss=0.02230 | Reg=0.00357 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.902 | L2-Norm(final)=2.661 | 3732.5 samples/s | 58.3 steps/s
[Step=8300 Epoch=16.2] | Loss=0.02197 | Reg=0.00357 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.901 | L2-Norm(final)=2.663 | 3745.5 samples/s | 58.5 steps/s
[Step=8350 Epoch=16.3] | Loss=0.02115 | Reg=0.00357 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.901 | L2-Norm(final)=2.665 | 3737.2 samples/s | 58.4 steps/s
[Step=8400 Epoch=16.4] | Loss=0.02153 | Reg=0.00357 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.900 | L2-Norm(final)=2.667 | 3747.0 samples/s | 58.5 steps/s
[Step=8450 Epoch=16.5] | Loss=0.02097 | Reg=0.00357 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.900 | L2-Norm(final)=2.669 | 3734.5 samples/s | 58.4 steps/s
[Step=8500 Epoch=16.6] | Loss=0.02050 | Reg=0.00357 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.901 | L2-Norm(final)=2.671 | 4350.8 samples/s | 68.0 steps/s
[Step=8550 Epoch=16.7] | Loss=0.01992 | Reg=0.00357 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.901 | L2-Norm(final)=2.673 | 1646.8 samples/s | 25.7 steps/s
[Step=8600 Epoch=16.8] | Loss=0.01898 | Reg=0.00357 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.902 | L2-Norm(final)=2.675 | 3722.4 samples/s | 58.2 steps/s
[Step=8650 Epoch=16.9] | Loss=0.01866 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.903 | L2-Norm(final)=2.678 | 3733.1 samples/s | 58.3 steps/s
[Step=8700 Epoch=17.0] | Loss=0.01818 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.904 | L2-Norm(final)=2.681 | 3730.5 samples/s | 58.3 steps/s
[Step=8750 Epoch=17.1] | Loss=0.01791 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.905 | L2-Norm(final)=2.683 | 3758.6 samples/s | 58.7 steps/s
[Step=8800 Epoch=17.2] | Loss=0.01768 | Reg=0.00357 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.906 | L2-Norm(final)=2.686 | 3737.1 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step8800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=37.0] | Loss=0.20168 | Reg=0.00359 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.947 | L2-Norm(final)=2.653 | 3667.7 samples/s | 57.3 steps/s
[Step=9650 Epoch=37.1] | Loss=0.01112 | Reg=0.00358 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.914 | L2-Norm(final)=2.649 | 3372.8 samples/s | 52.7 steps/s
[Step=9700 Epoch=37.3] | Loss=0.00652 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.905 | L2-Norm(final)=2.648 | 3526.0 samples/s | 55.1 steps/s
[Step=9750 Epoch=37.5] | Loss=0.00460 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.898 | L2-Norm(final)=2.649 | 3530.5 samples/s | 55.2 steps/s
[Step=9800 Epoch=37.7] | Loss=0.00350 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.892 | L2-Norm(final)=2.651 | 3510.6 samples/s | 54.9 steps/s
[Step=9850 Epoch=37.9] | Loss=0.00283 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.887 | L2-Norm(final)=2.652 | 4310.9 samples/s | 67.4 steps/s
[Step=9900 Epoch=38.1] | Loss=0.00238 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.883 | L2-Norm(final)=2.653 | 1615.6 samples/s | 25.2 steps/s
[Step=9950 Epoch=38.3] | Loss=0.00205 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.879 | L2-Norm(final)=2.655 | 3546.2 samples/s | 55.4 steps/s
[Step=10000 Epoch=38.5] | Loss=0.00180 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.876 | L2-Norm(final)=2.656 | 3503.4 samples/s | 54.7 steps/s
[Step=10050 Epoch=38.7] | Loss=0.00161 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.873 | L2-Norm(final)=2.656 | 3546.6 samples/s | 55.4 steps/s
[Step=10100 Epoch=38.9] | Loss=0.00145 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.871 | L2-Norm(final)=2.657 | 3918.3 samples/s | 61.2 steps/s
[Step=10150 Epoch=39.1] | Loss=0.00132 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.868 | L2-Norm(final)=2.658 | 1679.2 samples/s | 26.2 steps/s
[Step=10200 Epoch=39.3] | Loss=0.00122 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.866 | L2-Norm(final)=2.659 | 3524.1 samples/s | 55.1 steps/s
[Step=10250 Epoch=39.5] | Loss=0.00113 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.864 | L2-Norm(final)=2.659 | 3521.6 samples/s | 55.0 steps/s
[Step=10300 Epoch=39.6] | Loss=0.00105 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.862 | L2-Norm(final)=2.660 | 3546.5 samples/s | 55.4 steps/s
[Step=10350 Epoch=39.8] | Loss=0.00098 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.860 | L2-Norm(final)=2.661 | 3574.7 samples/s | 55.9 steps/s
[Step=10400 Epoch=40.0] | Loss=0.00092 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.858 | L2-Norm(final)=2.661 | 1736.5 samples/s | 27.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21934 | acc=0.8502 | tpr=0.7902 | fpr=0.0193 | 3817.0 samples/s | 14.9 steps/s
Avg test loss: 0.22288, Avg test acc: 0.84839, Avg tpr: 0.78883, Avg fpr: 0.02064, total FA: 161

Testing server on iccad2012
[Step=  50] | Loss=0.46613 | acc=0.8001 | tpr=0.9779 | fpr=0.2031 | 3826.4 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.47807 | acc=0.7997 | tpr=0.9787 | fpr=0.2037 | 7360.2 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.48496 | acc=0.7974 | tpr=0.9813 | fpr=0.2060 | 7250.5 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.48597 | acc=0.7981 | tpr=0.9803 | fpr=0.2052 | 7221.3 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.48249 | acc=0.7990 | tpr=0.9808 | fpr=0.2043 | 7226.2 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.48121 | acc=0.7998 | tpr=0.9811 | fpr=0.2035 | 7165.5 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.48175 | acc=0.7993 | tpr=0.9806 | fpr=0.2039 | 7279.6 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.48094 | acc=0.7996 | tpr=0.9819 | fpr=0.2037 | 7261.5 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.48437 | acc=0.7986 | tpr=0.9825 | fpr=0.2047 | 7183.0 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.48452 | acc=0.7986 | tpr=0.9824 | fpr=0.2047 | 7632.0 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.48313 | acc=0.7991 | tpr=0.9821 | fpr=0.2043 | 12150.4 samples/s | 47.5 steps/s
Avg test loss: 0.48293, Avg test acc: 0.79910, Avg tpr: 0.98217, Avg fpr: 0.20422, total FA: 28356

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=17.2] | Loss=0.16741 | Reg=0.00357 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.906 | L2-Norm(final)=2.674 | 3494.1 samples/s | 54.6 steps/s
[Step=8850 Epoch=17.3] | Loss=0.03817 | Reg=0.00356 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.881 | L2-Norm(final)=2.668 | 3571.0 samples/s | 55.8 steps/s
[Step=8900 Epoch=17.4] | Loss=0.02936 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.872 | L2-Norm(final)=2.668 | 3718.7 samples/s | 58.1 steps/s
[Step=8950 Epoch=17.5] | Loss=0.02657 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.869 | L2-Norm(final)=2.671 | 3728.0 samples/s | 58.2 steps/s
[Step=9000 Epoch=17.6] | Loss=0.02443 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.867 | L2-Norm(final)=2.674 | 3710.7 samples/s | 58.0 steps/s
[Step=9050 Epoch=17.7] | Loss=0.02360 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.866 | L2-Norm(final)=2.677 | 3744.2 samples/s | 58.5 steps/s
[Step=9100 Epoch=17.7] | Loss=0.02286 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.866 | L2-Norm(final)=2.680 | 3735.0 samples/s | 58.4 steps/s
[Step=9150 Epoch=17.8] | Loss=0.02212 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.866 | L2-Norm(final)=2.682 | 3746.4 samples/s | 58.5 steps/s
[Step=9200 Epoch=17.9] | Loss=0.02137 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.866 | L2-Norm(final)=2.685 | 3729.9 samples/s | 58.3 steps/s
[Step=9250 Epoch=18.0] | Loss=0.02115 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.867 | L2-Norm(final)=2.688 | 3753.5 samples/s | 58.6 steps/s
[Step=9300 Epoch=18.1] | Loss=0.02097 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.868 | L2-Norm(final)=2.690 | 4363.2 samples/s | 68.2 steps/s
[Step=9350 Epoch=18.2] | Loss=0.02045 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.869 | L2-Norm(final)=2.693 | 1636.0 samples/s | 25.6 steps/s
[Step=9400 Epoch=18.3] | Loss=0.01994 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.870 | L2-Norm(final)=2.695 | 3720.4 samples/s | 58.1 steps/s
[Step=9450 Epoch=18.4] | Loss=0.01935 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.871 | L2-Norm(final)=2.698 | 3711.3 samples/s | 58.0 steps/s
[Step=9500 Epoch=18.5] | Loss=0.01869 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.872 | L2-Norm(final)=2.701 | 3736.1 samples/s | 58.4 steps/s
[Step=9550 Epoch=18.6] | Loss=0.01815 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.872 | L2-Norm(final)=2.703 | 3749.7 samples/s | 58.6 steps/s
[Step=9600 Epoch=18.7] | Loss=0.01812 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.873 | L2-Norm(final)=2.705 | 3743.5 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step9600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=6401 Epoch=12.5] | Loss=0.12731 | Reg=0.00357 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.906 | L2-Norm(final)=2.674 | 3909.6 samples/s | 61.1 steps/s
[Step=6450 Epoch=12.6] | Loss=0.03674 | Reg=0.00356 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.880 | L2-Norm(final)=2.667 | 3420.7 samples/s | 53.4 steps/s
[Step=6500 Epoch=12.7] | Loss=0.02809 | Reg=0.00356 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.871 | L2-Norm(final)=2.669 | 3738.1 samples/s | 58.4 steps/s
[Step=6550 Epoch=12.8] | Loss=0.02486 | Reg=0.00356 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.867 | L2-Norm(final)=2.672 | 3768.2 samples/s | 58.9 steps/s
[Step=6600 Epoch=12.9] | Loss=0.02358 | Reg=0.00356 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.865 | L2-Norm(final)=2.675 | 3736.7 samples/s | 58.4 steps/s
[Step=6650 Epoch=13.0] | Loss=0.02186 | Reg=0.00356 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.864 | L2-Norm(final)=2.677 | 3759.9 samples/s | 58.7 steps/s
[Step=6700 Epoch=13.1] | Loss=0.02087 | Reg=0.00356 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.864 | L2-Norm(final)=2.680 | 3767.4 samples/s | 58.9 steps/s
[Step=6750 Epoch=13.2] | Loss=0.02042 | Reg=0.00356 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.864 | L2-Norm(final)=2.683 | 3758.0 samples/s | 58.7 steps/s
[Step=6800 Epoch=13.3] | Loss=0.01957 | Reg=0.00356 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.864 | L2-Norm(final)=2.686 | 3774.0 samples/s | 59.0 steps/s
[Step=6850 Epoch=13.4] | Loss=0.01915 | Reg=0.00356 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.865 | L2-Norm(final)=2.688 | 3770.2 samples/s | 58.9 steps/s
[Step=6900 Epoch=13.5] | Loss=0.01899 | Reg=0.00356 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.865 | L2-Norm(final)=2.691 | 4414.1 samples/s | 69.0 steps/s
[Step=6950 Epoch=13.6] | Loss=0.01872 | Reg=0.00356 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.866 | L2-Norm(final)=2.693 | 1664.2 samples/s | 26.0 steps/s
[Step=7000 Epoch=13.7] | Loss=0.01817 | Reg=0.00356 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.867 | L2-Norm(final)=2.695 | 3738.9 samples/s | 58.4 steps/s
[Step=7050 Epoch=13.8] | Loss=0.01767 | Reg=0.00356 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.868 | L2-Norm(final)=2.697 | 3742.4 samples/s | 58.5 steps/s
[Step=7100 Epoch=13.9] | Loss=0.01743 | Reg=0.00356 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.869 | L2-Norm(final)=2.699 | 3730.0 samples/s | 58.3 steps/s
[Step=7150 Epoch=14.0] | Loss=0.01720 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.869 | L2-Norm(final)=2.701 | 3741.6 samples/s | 58.5 steps/s
[Step=7200 Epoch=14.1] | Loss=0.01709 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.870 | L2-Norm(final)=2.703 | 3747.2 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20412 | acc=0.8600 | tpr=0.8045 | fpr=0.0196 | 3790.8 samples/s | 14.8 steps/s
Avg test loss: 0.20801, Avg test acc: 0.85784, Avg tpr: 0.80276, Avg fpr: 0.02102, total FA: 164

Testing server on iccad2012
[Step=  50] | Loss=0.49499 | acc=0.7961 | tpr=0.9823 | fpr=0.2073 | 3817.4 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.50712 | acc=0.7939 | tpr=0.9851 | fpr=0.2097 | 7236.9 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.51442 | acc=0.7908 | tpr=0.9841 | fpr=0.2127 | 7234.1 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.51530 | acc=0.7914 | tpr=0.9847 | fpr=0.2121 | 7382.1 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.51138 | acc=0.7922 | tpr=0.9843 | fpr=0.2113 | 7211.7 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.50978 | acc=0.7928 | tpr=0.9840 | fpr=0.2107 | 7222.5 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.51033 | acc=0.7923 | tpr=0.9831 | fpr=0.2112 | 7271.9 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.50960 | acc=0.7929 | tpr=0.9841 | fpr=0.2106 | 7429.6 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.51302 | acc=0.7918 | tpr=0.9844 | fpr=0.2117 | 6840.5 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.51319 | acc=0.7917 | tpr=0.9846 | fpr=0.2118 | 7304.2 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.51169 | acc=0.7923 | tpr=0.9845 | fpr=0.2112 | 13266.8 samples/s | 51.8 steps/s
Avg test loss: 0.51142, Avg test acc: 0.79234, Avg tpr: 0.98455, Avg fpr: 0.21115, total FA: 29318

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=18.7] | Loss=0.14574 | Reg=0.00355 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.846 | L2-Norm(final)=2.700 | 3633.7 samples/s | 56.8 steps/s
[Step=9650 Epoch=18.8] | Loss=0.02736 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.816 | L2-Norm(final)=2.698 | 3582.3 samples/s | 56.0 steps/s
[Step=9700 Epoch=18.9] | Loss=0.02270 | Reg=0.00354 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.809 | L2-Norm(final)=2.701 | 3732.1 samples/s | 58.3 steps/s
[Step=9750 Epoch=19.0] | Loss=0.02238 | Reg=0.00354 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.806 | L2-Norm(final)=2.704 | 3724.8 samples/s | 58.2 steps/s
[Step=9800 Epoch=19.1] | Loss=0.02144 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.805 | L2-Norm(final)=2.707 | 3746.1 samples/s | 58.5 steps/s
[Step=9850 Epoch=19.2] | Loss=0.02118 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.805 | L2-Norm(final)=2.709 | 3738.5 samples/s | 58.4 steps/s
[Step=9900 Epoch=19.3] | Loss=0.02085 | Reg=0.00354 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.804 | L2-Norm(final)=2.711 | 3733.1 samples/s | 58.3 steps/s
[Step=9950 Epoch=19.4] | Loss=0.02130 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.804 | L2-Norm(final)=2.713 | 3743.2 samples/s | 58.5 steps/s
[Step=10000 Epoch=19.5] | Loss=0.02111 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.805 | L2-Norm(final)=2.714 | 3746.2 samples/s | 58.5 steps/s
[Step=10050 Epoch=19.6] | Loss=0.02058 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.805 | L2-Norm(final)=2.716 | 3730.3 samples/s | 58.3 steps/s
[Step=10100 Epoch=19.7] | Loss=0.01977 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.806 | L2-Norm(final)=2.718 | 4364.2 samples/s | 68.2 steps/s
[Step=10150 Epoch=19.8] | Loss=0.01924 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.806 | L2-Norm(final)=2.720 | 1594.3 samples/s | 24.9 steps/s
[Step=10200 Epoch=19.9] | Loss=0.01863 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.807 | L2-Norm(final)=2.722 | 3735.7 samples/s | 58.4 steps/s
[Step=10250 Epoch=20.0] | Loss=0.01847 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.808 | L2-Norm(final)=2.725 | 3739.8 samples/s | 58.4 steps/s
[Step=10300 Epoch=20.1] | Loss=0.01779 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.810 | L2-Norm(final)=2.727 | 3751.5 samples/s | 58.6 steps/s
[Step=10350 Epoch=20.2] | Loss=0.01733 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.811 | L2-Norm(final)=2.730 | 3742.1 samples/s | 58.5 steps/s
[Step=10400 Epoch=20.3] | Loss=0.01712 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.812 | L2-Norm(final)=2.732 | 3760.8 samples/s | 58.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step10400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=7201 Epoch=14.1] | Loss=0.15538 | Reg=0.00355 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.846 | L2-Norm(final)=2.700 | 3752.8 samples/s | 58.6 steps/s
[Step=7250 Epoch=14.2] | Loss=0.03004 | Reg=0.00354 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.817 | L2-Norm(final)=2.697 | 3590.2 samples/s | 56.1 steps/s
[Step=7300 Epoch=14.3] | Loss=0.02431 | Reg=0.00354 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.809 | L2-Norm(final)=2.700 | 3727.7 samples/s | 58.2 steps/s
[Step=7350 Epoch=14.4] | Loss=0.02181 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.806 | L2-Norm(final)=2.703 | 3746.8 samples/s | 58.5 steps/s
[Step=7400 Epoch=14.5] | Loss=0.02021 | Reg=0.00354 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.805 | L2-Norm(final)=2.707 | 3748.6 samples/s | 58.6 steps/s
[Step=7450 Epoch=14.6] | Loss=0.02054 | Reg=0.00354 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.805 | L2-Norm(final)=2.709 | 3767.4 samples/s | 58.9 steps/s
[Step=7500 Epoch=14.7] | Loss=0.02028 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.805 | L2-Norm(final)=2.712 | 3715.0 samples/s | 58.0 steps/s
[Step=7550 Epoch=14.8] | Loss=0.01999 | Reg=0.00354 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.805 | L2-Norm(final)=2.713 | 3764.8 samples/s | 58.8 steps/s
[Step=7600 Epoch=14.9] | Loss=0.02016 | Reg=0.00354 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.806 | L2-Norm(final)=2.715 | 3761.3 samples/s | 58.8 steps/s
[Step=7650 Epoch=15.0] | Loss=0.01972 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.807 | L2-Norm(final)=2.717 | 3737.9 samples/s | 58.4 steps/s
[Step=7700 Epoch=15.1] | Loss=0.01926 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.807 | L2-Norm(final)=2.719 | 4406.0 samples/s | 68.8 steps/s
[Step=7750 Epoch=15.2] | Loss=0.01874 | Reg=0.00354 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.808 | L2-Norm(final)=2.721 | 1663.0 samples/s | 26.0 steps/s
[Step=7800 Epoch=15.2] | Loss=0.01829 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.810 | L2-Norm(final)=2.724 | 3720.6 samples/s | 58.1 steps/s
[Step=7850 Epoch=15.3] | Loss=0.01803 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.811 | L2-Norm(final)=2.726 | 3716.9 samples/s | 58.1 steps/s
[Step=7900 Epoch=15.4] | Loss=0.01768 | Reg=0.00354 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.812 | L2-Norm(final)=2.729 | 3740.7 samples/s | 58.4 steps/s
[Step=7950 Epoch=15.5] | Loss=0.01726 | Reg=0.00354 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.813 | L2-Norm(final)=2.731 | 3751.2 samples/s | 58.6 steps/s
[Step=8000 Epoch=15.6] | Loss=0.01697 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.814 | L2-Norm(final)=2.733 | 3769.3 samples/s | 58.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21305 | acc=0.8580 | tpr=0.8015 | fpr=0.0193 | 3803.2 samples/s | 14.9 steps/s
Avg test loss: 0.21704, Avg test acc: 0.85496, Avg tpr: 0.79880, Avg fpr: 0.02154, total FA: 168

Testing server on iccad2012
[Step=  50] | Loss=0.49488 | acc=0.8023 | tpr=0.9823 | fpr=0.2009 | 3849.3 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.50875 | acc=0.8016 | tpr=0.9851 | fpr=0.2018 | 7259.4 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.51643 | acc=0.7988 | tpr=0.9870 | fpr=0.2046 | 7142.1 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.51788 | acc=0.7990 | tpr=0.9869 | fpr=0.2044 | 7181.2 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.51358 | acc=0.7995 | tpr=0.9860 | fpr=0.2039 | 7406.7 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.51225 | acc=0.8001 | tpr=0.9855 | fpr=0.2033 | 7116.0 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.51292 | acc=0.7997 | tpr=0.9843 | fpr=0.2037 | 7222.2 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.51232 | acc=0.8003 | tpr=0.9852 | fpr=0.2031 | 7250.5 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.51585 | acc=0.7993 | tpr=0.9859 | fpr=0.2041 | 7275.4 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.51627 | acc=0.7991 | tpr=0.9859 | fpr=0.2043 | 7124.7 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.51473 | acc=0.7996 | tpr=0.9857 | fpr=0.2038 | 13090.4 samples/s | 51.1 steps/s
Avg test loss: 0.51446, Avg test acc: 0.79967, Avg tpr: 0.98574, Avg fpr: 0.20371, total FA: 28285

server round 24/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8001 Epoch=15.6] | Loss=0.21446 | Reg=0.00354 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.819 | L2-Norm(final)=2.717 | 3852.0 samples/s | 60.2 steps/s
[Step=8050 Epoch=15.7] | Loss=0.03192 | Reg=0.00353 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.791 | L2-Norm(final)=2.712 | 3457.2 samples/s | 54.0 steps/s
[Step=8100 Epoch=15.8] | Loss=0.02456 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.784 | L2-Norm(final)=2.715 | 3747.7 samples/s | 58.6 steps/s
[Step=8150 Epoch=15.9] | Loss=0.02104 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.782 | L2-Norm(final)=2.720 | 3716.2 samples/s | 58.1 steps/s
[Step=8200 Epoch=16.0] | Loss=0.02065 | Reg=0.00353 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.782 | L2-Norm(final)=2.724 | 3724.8 samples/s | 58.2 steps/s
[Step=8250 Epoch=16.1] | Loss=0.01990 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.782 | L2-Norm(final)=2.728 | 3724.0 samples/s | 58.2 steps/s
[Step=8300 Epoch=16.2] | Loss=0.01951 | Reg=0.00353 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.783 | L2-Norm(final)=2.731 | 3711.3 samples/s | 58.0 steps/s
[Step=8350 Epoch=16.3] | Loss=0.01931 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.783 | L2-Norm(final)=2.733 | 3718.1 samples/s | 58.1 steps/s
[Step=8400 Epoch=16.4] | Loss=0.01880 | Reg=0.00353 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.784 | L2-Norm(final)=2.735 | 3727.4 samples/s | 58.2 steps/s
[Step=8450 Epoch=16.5] | Loss=0.01881 | Reg=0.00353 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.784 | L2-Norm(final)=2.738 | 3738.0 samples/s | 58.4 steps/s
[Step=8500 Epoch=16.6] | Loss=0.01870 | Reg=0.00353 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.785 | L2-Norm(final)=2.740 | 4378.8 samples/s | 68.4 steps/s
[Step=8550 Epoch=16.7] | Loss=0.01817 | Reg=0.00353 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.786 | L2-Norm(final)=2.742 | 1666.4 samples/s | 26.0 steps/s
[Step=8600 Epoch=16.8] | Loss=0.01776 | Reg=0.00353 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.787 | L2-Norm(final)=2.744 | 3727.8 samples/s | 58.2 steps/s
[Step=8650 Epoch=16.9] | Loss=0.01723 | Reg=0.00353 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.788 | L2-Norm(final)=2.746 | 3743.2 samples/s | 58.5 steps/s
[Step=8700 Epoch=17.0] | Loss=0.01683 | Reg=0.00353 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.789 | L2-Norm(final)=2.748 | 3742.6 samples/s | 58.5 steps/s
[Step=8750 Epoch=17.1] | Loss=0.01663 | Reg=0.00353 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.790 | L2-Norm(final)=2.750 | 3747.7 samples/s | 58.6 steps/s
[Step=8800 Epoch=17.2] | Loss=0.01652 | Reg=0.00353 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.791 | L2-Norm(final)=2.752 | 3720.9 samples/s | 58.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step8800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=40.0] | Loss=0.07537 | Reg=0.00354 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.819 | L2-Norm(final)=2.717 | 3773.1 samples/s | 59.0 steps/s
[Step=10450 Epoch=40.2] | Loss=0.00953 | Reg=0.00353 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.786 | L2-Norm(final)=2.711 | 3401.6 samples/s | 53.1 steps/s
[Step=10500 Epoch=40.4] | Loss=0.00500 | Reg=0.00353 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.779 | L2-Norm(final)=2.712 | 3526.9 samples/s | 55.1 steps/s
[Step=10550 Epoch=40.6] | Loss=0.00351 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.772 | L2-Norm(final)=2.714 | 3532.0 samples/s | 55.2 steps/s
[Step=10600 Epoch=40.8] | Loss=0.00274 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.767 | L2-Norm(final)=2.716 | 3535.2 samples/s | 55.2 steps/s
[Step=10650 Epoch=41.0] | Loss=0.00223 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.762 | L2-Norm(final)=2.718 | 4258.4 samples/s | 66.5 steps/s
[Step=10700 Epoch=41.2] | Loss=0.00187 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.758 | L2-Norm(final)=2.719 | 1609.2 samples/s | 25.1 steps/s
[Step=10750 Epoch=41.4] | Loss=0.00160 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.755 | L2-Norm(final)=2.720 | 3506.0 samples/s | 54.8 steps/s
[Step=10800 Epoch=41.6] | Loss=0.00141 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.752 | L2-Norm(final)=2.721 | 3502.9 samples/s | 54.7 steps/s
[Step=10850 Epoch=41.8] | Loss=0.00126 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.749 | L2-Norm(final)=2.722 | 3529.3 samples/s | 55.1 steps/s
[Step=10900 Epoch=42.0] | Loss=0.00114 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.746 | L2-Norm(final)=2.723 | 3918.6 samples/s | 61.2 steps/s
[Step=10950 Epoch=42.2] | Loss=0.00104 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.743 | L2-Norm(final)=2.723 | 1684.3 samples/s | 26.3 steps/s
[Step=11000 Epoch=42.3] | Loss=0.00095 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.741 | L2-Norm(final)=2.724 | 3536.6 samples/s | 55.3 steps/s
[Step=11050 Epoch=42.5] | Loss=0.00088 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.739 | L2-Norm(final)=2.724 | 3512.4 samples/s | 54.9 steps/s
[Step=11100 Epoch=42.7] | Loss=0.00082 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.737 | L2-Norm(final)=2.725 | 3548.7 samples/s | 55.4 steps/s
[Step=11150 Epoch=42.9] | Loss=0.00077 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.735 | L2-Norm(final)=2.725 | 3564.4 samples/s | 55.7 steps/s
[Step=11200 Epoch=43.1] | Loss=0.00072 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.733 | L2-Norm(final)=2.725 | 1740.5 samples/s | 27.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21728 | acc=0.8527 | tpr=0.7944 | fpr=0.0208 | 3818.1 samples/s | 14.9 steps/s
Avg test loss: 0.22126, Avg test acc: 0.85159, Avg tpr: 0.79402, Avg fpr: 0.02179, total FA: 170

Testing server on iccad2012
[Step=  50] | Loss=0.47436 | acc=0.8120 | tpr=0.9823 | fpr=0.1910 | 3827.9 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.48795 | acc=0.8108 | tpr=0.9851 | fpr=0.1924 | 7312.4 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.49580 | acc=0.8086 | tpr=0.9856 | fpr=0.1946 | 7333.8 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.49756 | acc=0.8085 | tpr=0.9858 | fpr=0.1947 | 7312.1 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.49348 | acc=0.8089 | tpr=0.9852 | fpr=0.1943 | 7234.7 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.49225 | acc=0.8097 | tpr=0.9847 | fpr=0.1935 | 7116.9 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.49284 | acc=0.8092 | tpr=0.9837 | fpr=0.1940 | 7346.1 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.49239 | acc=0.8095 | tpr=0.9847 | fpr=0.1937 | 7658.4 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.49574 | acc=0.8088 | tpr=0.9854 | fpr=0.1944 | 6744.9 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.49596 | acc=0.8086 | tpr=0.9855 | fpr=0.1946 | 7647.9 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.49428 | acc=0.8093 | tpr=0.9853 | fpr=0.1939 | 12065.2 samples/s | 47.1 steps/s
Avg test loss: 0.49400, Avg test acc: 0.80935, Avg tpr: 0.98534, Avg fpr: 0.19385, total FA: 26915

server round 25/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=8801 Epoch=17.2] | Loss=0.08610 | Reg=0.00353 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.782 | L2-Norm(final)=2.735 | 3837.9 samples/s | 60.0 steps/s
[Step=8850 Epoch=17.3] | Loss=0.03422 | Reg=0.00352 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.750 | L2-Norm(final)=2.729 | 3509.5 samples/s | 54.8 steps/s
[Step=8900 Epoch=17.4] | Loss=0.02403 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.743 | L2-Norm(final)=2.731 | 3729.9 samples/s | 58.3 steps/s
[Step=8950 Epoch=17.5] | Loss=0.02003 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.740 | L2-Norm(final)=2.735 | 3731.2 samples/s | 58.3 steps/s
[Step=9000 Epoch=17.6] | Loss=0.01930 | Reg=0.00351 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.740 | L2-Norm(final)=2.739 | 3747.8 samples/s | 58.6 steps/s
[Step=9050 Epoch=17.7] | Loss=0.01898 | Reg=0.00351 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.741 | L2-Norm(final)=2.743 | 3749.9 samples/s | 58.6 steps/s
[Step=9100 Epoch=17.8] | Loss=0.01881 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.741 | L2-Norm(final)=2.746 | 3754.5 samples/s | 58.7 steps/s
[Step=9150 Epoch=17.9] | Loss=0.01927 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.742 | L2-Norm(final)=2.748 | 3741.0 samples/s | 58.5 steps/s
[Step=9200 Epoch=18.0] | Loss=0.01857 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.743 | L2-Norm(final)=2.750 | 3748.9 samples/s | 58.6 steps/s
[Step=9250 Epoch=18.1] | Loss=0.01807 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.744 | L2-Norm(final)=2.752 | 3735.8 samples/s | 58.4 steps/s
[Step=9300 Epoch=18.2] | Loss=0.01808 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.745 | L2-Norm(final)=2.755 | 4389.6 samples/s | 68.6 steps/s
[Step=9350 Epoch=18.3] | Loss=0.01798 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.746 | L2-Norm(final)=2.757 | 1666.3 samples/s | 26.0 steps/s
[Step=9400 Epoch=18.4] | Loss=0.01741 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.747 | L2-Norm(final)=2.759 | 3724.9 samples/s | 58.2 steps/s
[Step=9450 Epoch=18.5] | Loss=0.01708 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.748 | L2-Norm(final)=2.761 | 3733.8 samples/s | 58.3 steps/s
[Step=9500 Epoch=18.6] | Loss=0.01679 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.749 | L2-Norm(final)=2.763 | 3726.1 samples/s | 58.2 steps/s
[Step=9550 Epoch=18.7] | Loss=0.01678 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.750 | L2-Norm(final)=2.765 | 3743.4 samples/s | 58.5 steps/s
[Step=9600 Epoch=18.8] | Loss=0.01646 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.751 | L2-Norm(final)=2.767 | 3726.0 samples/s | 58.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step9600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=36.8] | Loss=0.15234 | Reg=0.00353 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.782 | L2-Norm(final)=2.735 | 3535.3 samples/s | 55.2 steps/s
[Step=9650 Epoch=37.0] | Loss=0.00709 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.743 | L2-Norm(final)=2.727 | 3494.9 samples/s | 54.6 steps/s
[Step=9700 Epoch=37.2] | Loss=0.00370 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.732 | L2-Norm(final)=2.728 | 3526.8 samples/s | 55.1 steps/s
[Step=9750 Epoch=37.4] | Loss=0.00267 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.725 | L2-Norm(final)=2.729 | 3564.0 samples/s | 55.7 steps/s
[Step=9800 Epoch=37.6] | Loss=0.00211 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.720 | L2-Norm(final)=2.731 | 3527.8 samples/s | 55.1 steps/s
[Step=9850 Epoch=37.7] | Loss=0.00169 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.716 | L2-Norm(final)=2.732 | 4263.9 samples/s | 66.6 steps/s
[Step=9900 Epoch=37.9] | Loss=0.00142 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.712 | L2-Norm(final)=2.733 | 1618.9 samples/s | 25.3 steps/s
[Step=9950 Epoch=38.1] | Loss=0.00122 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.709 | L2-Norm(final)=2.734 | 3531.5 samples/s | 55.2 steps/s
[Step=10000 Epoch=38.3] | Loss=0.00108 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.706 | L2-Norm(final)=2.735 | 3529.0 samples/s | 55.1 steps/s
[Step=10050 Epoch=38.5] | Loss=0.00096 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.703 | L2-Norm(final)=2.736 | 3548.7 samples/s | 55.4 steps/s
[Step=10100 Epoch=38.7] | Loss=0.00087 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.700 | L2-Norm(final)=2.736 | 3822.5 samples/s | 59.7 steps/s
[Step=10150 Epoch=38.9] | Loss=0.00079 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.698 | L2-Norm(final)=2.737 | 1681.1 samples/s | 26.3 steps/s
[Step=10200 Epoch=39.1] | Loss=0.00073 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.696 | L2-Norm(final)=2.737 | 3546.8 samples/s | 55.4 steps/s
[Step=10250 Epoch=39.3] | Loss=0.00067 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.694 | L2-Norm(final)=2.738 | 3507.3 samples/s | 54.8 steps/s
[Step=10300 Epoch=39.5] | Loss=0.00063 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.692 | L2-Norm(final)=2.738 | 3547.9 samples/s | 55.4 steps/s
[Step=10350 Epoch=39.7] | Loss=0.00059 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.690 | L2-Norm(final)=2.739 | 3512.6 samples/s | 54.9 steps/s
[Step=10400 Epoch=39.8] | Loss=0.00055 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.688 | L2-Norm(final)=2.739 | 1746.4 samples/s | 27.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18471 | acc=0.8723 | tpr=0.8230 | fpr=0.0208 | 3831.2 samples/s | 15.0 steps/s
Avg test loss: 0.18878, Avg test acc: 0.87122, Avg tpr: 0.82310, Avg fpr: 0.02295, total FA: 179

Testing server on iccad2012
[Step=  50] | Loss=0.53367 | acc=0.7886 | tpr=0.9823 | fpr=0.2149 | 3853.1 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.54781 | acc=0.7876 | tpr=0.9851 | fpr=0.2161 | 7057.0 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.55593 | acc=0.7851 | tpr=0.9870 | fpr=0.2186 | 7302.4 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.55787 | acc=0.7854 | tpr=0.9880 | fpr=0.2183 | 7291.6 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.55384 | acc=0.7861 | tpr=0.9869 | fpr=0.2176 | 7218.6 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.55208 | acc=0.7865 | tpr=0.9869 | fpr=0.2171 | 7257.1 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.55261 | acc=0.7860 | tpr=0.9862 | fpr=0.2176 | 7308.9 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.55238 | acc=0.7862 | tpr=0.9874 | fpr=0.2175 | 7434.4 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.55588 | acc=0.7852 | tpr=0.9883 | fpr=0.2185 | 7035.9 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.55619 | acc=0.7851 | tpr=0.9885 | fpr=0.2186 | 7094.9 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.55451 | acc=0.7855 | tpr=0.9885 | fpr=0.2182 | 13239.9 samples/s | 51.7 steps/s
Avg test loss: 0.55417, Avg test acc: 0.78554, Avg tpr: 0.98851, Avg fpr: 0.21815, total FA: 30290

server round 26/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=9601 Epoch=18.8] | Loss=0.05516 | Reg=0.00351 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.731 | L2-Norm(final)=2.761 | 3642.1 samples/s | 56.9 steps/s
[Step=9650 Epoch=18.9] | Loss=0.02735 | Reg=0.00350 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.702 | L2-Norm(final)=2.763 | 3694.6 samples/s | 57.7 steps/s
[Step=9700 Epoch=19.0] | Loss=0.02041 | Reg=0.00350 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.696 | L2-Norm(final)=2.766 | 3713.9 samples/s | 58.0 steps/s
[Step=9750 Epoch=19.1] | Loss=0.02014 | Reg=0.00349 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.694 | L2-Norm(final)=2.769 | 3724.9 samples/s | 58.2 steps/s
[Step=9800 Epoch=19.2] | Loss=0.01901 | Reg=0.00349 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.692 | L2-Norm(final)=2.771 | 3714.4 samples/s | 58.0 steps/s
[Step=9850 Epoch=19.3] | Loss=0.01868 | Reg=0.00349 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.692 | L2-Norm(final)=2.774 | 3744.6 samples/s | 58.5 steps/s
[Step=9900 Epoch=19.4] | Loss=0.01843 | Reg=0.00349 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.692 | L2-Norm(final)=2.776 | 3744.6 samples/s | 58.5 steps/s
[Step=9950 Epoch=19.5] | Loss=0.01814 | Reg=0.00349 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.693 | L2-Norm(final)=2.779 | 3735.3 samples/s | 58.4 steps/s
[Step=10000 Epoch=19.5] | Loss=0.01776 | Reg=0.00349 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.694 | L2-Norm(final)=2.781 | 3735.1 samples/s | 58.4 steps/s
[Step=10050 Epoch=19.6] | Loss=0.01718 | Reg=0.00349 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.695 | L2-Norm(final)=2.783 | 3731.9 samples/s | 58.3 steps/s
[Step=10100 Epoch=19.7] | Loss=0.01714 | Reg=0.00350 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.696 | L2-Norm(final)=2.785 | 4402.7 samples/s | 68.8 steps/s
[Step=10150 Epoch=19.8] | Loss=0.01651 | Reg=0.00350 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.697 | L2-Norm(final)=2.788 | 1668.7 samples/s | 26.1 steps/s
[Step=10200 Epoch=19.9] | Loss=0.01599 | Reg=0.00350 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.698 | L2-Norm(final)=2.790 | 3730.2 samples/s | 58.3 steps/s
[Step=10250 Epoch=20.0] | Loss=0.01576 | Reg=0.00350 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.699 | L2-Norm(final)=2.792 | 3726.8 samples/s | 58.2 steps/s
[Step=10300 Epoch=20.1] | Loss=0.01559 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.700 | L2-Norm(final)=2.794 | 3729.8 samples/s | 58.3 steps/s
[Step=10350 Epoch=20.2] | Loss=0.01516 | Reg=0.00350 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.700 | L2-Norm(final)=2.796 | 3736.1 samples/s | 58.4 steps/s
[Step=10400 Epoch=20.3] | Loss=0.01507 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.701 | L2-Norm(final)=2.798 | 3727.6 samples/s | 58.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step10400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=43.1] | Loss=0.18773 | Reg=0.00351 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.731 | L2-Norm(final)=2.761 | 3595.0 samples/s | 56.2 steps/s
[Step=11250 Epoch=43.3] | Loss=0.00962 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.696 | L2-Norm(final)=2.755 | 3462.1 samples/s | 54.1 steps/s
[Step=11300 Epoch=43.5] | Loss=0.00516 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.687 | L2-Norm(final)=2.755 | 3517.0 samples/s | 55.0 steps/s
[Step=11350 Epoch=43.7] | Loss=0.00348 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.680 | L2-Norm(final)=2.756 | 3549.3 samples/s | 55.5 steps/s
[Step=11400 Epoch=43.9] | Loss=0.00280 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.675 | L2-Norm(final)=2.757 | 3552.1 samples/s | 55.5 steps/s
[Step=11450 Epoch=44.1] | Loss=0.00227 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.671 | L2-Norm(final)=2.758 | 4301.2 samples/s | 67.2 steps/s
[Step=11500 Epoch=44.3] | Loss=0.00191 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.667 | L2-Norm(final)=2.759 | 1615.7 samples/s | 25.2 steps/s
[Step=11550 Epoch=44.5] | Loss=0.00164 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.664 | L2-Norm(final)=2.760 | 3537.2 samples/s | 55.3 steps/s
[Step=11600 Epoch=44.7] | Loss=0.00144 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.661 | L2-Norm(final)=2.761 | 3525.7 samples/s | 55.1 steps/s
[Step=11650 Epoch=44.8] | Loss=0.00128 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.658 | L2-Norm(final)=2.761 | 3543.2 samples/s | 55.4 steps/s
[Step=11700 Epoch=45.0] | Loss=0.00116 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.655 | L2-Norm(final)=2.762 | 3894.3 samples/s | 60.8 steps/s
[Step=11750 Epoch=45.2] | Loss=0.00105 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.653 | L2-Norm(final)=2.762 | 1674.1 samples/s | 26.2 steps/s
[Step=11800 Epoch=45.4] | Loss=0.00097 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.650 | L2-Norm(final)=2.763 | 3546.4 samples/s | 55.4 steps/s
[Step=11850 Epoch=45.6] | Loss=0.00090 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.648 | L2-Norm(final)=2.763 | 3517.8 samples/s | 55.0 steps/s
[Step=11900 Epoch=45.8] | Loss=0.00084 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.646 | L2-Norm(final)=2.764 | 3547.8 samples/s | 55.4 steps/s
[Step=11950 Epoch=46.0] | Loss=0.00078 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.644 | L2-Norm(final)=2.764 | 3579.2 samples/s | 55.9 steps/s
[Step=12000 Epoch=46.2] | Loss=0.00073 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.642 | L2-Norm(final)=2.765 | 1735.5 samples/s | 27.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17369 | acc=0.8845 | tpr=0.8417 | fpr=0.0228 | 3822.5 samples/s | 14.9 steps/s
Avg test loss: 0.17666, Avg test acc: 0.88320, Avg tpr: 0.84164, Avg fpr: 0.02538, total FA: 198

Testing server on iccad2012
[Step=  50] | Loss=0.56082 | acc=0.7836 | tpr=0.9867 | fpr=0.2201 | 3804.2 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.57511 | acc=0.7836 | tpr=0.9872 | fpr=0.2202 | 7363.6 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.58410 | acc=0.7805 | tpr=0.9885 | fpr=0.2233 | 7293.2 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.58620 | acc=0.7806 | tpr=0.9880 | fpr=0.2231 | 7446.7 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.58147 | acc=0.7816 | tpr=0.9869 | fpr=0.2221 | 7187.2 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.57969 | acc=0.7820 | tpr=0.9876 | fpr=0.2217 | 7128.4 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.57997 | acc=0.7816 | tpr=0.9869 | fpr=0.2221 | 7358.1 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.57942 | acc=0.7818 | tpr=0.9880 | fpr=0.2219 | 7313.9 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.58298 | acc=0.7810 | tpr=0.9888 | fpr=0.2227 | 7074.5 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.58362 | acc=0.7809 | tpr=0.9890 | fpr=0.2229 | 4300.7 samples/s | 16.8 steps/s
[Step= 550] | Loss=0.58187 | acc=0.7814 | tpr=0.9893 | fpr=0.2223 | 13358.2 samples/s | 52.2 steps/s
Avg test loss: 0.58155, Avg test acc: 0.78148, Avg tpr: 0.98930, Avg fpr: 0.22229, total FA: 30865

server round 27/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=20.3] | Loss=0.11431 | Reg=0.00350 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.695 | L2-Norm(final)=2.779 | 3645.9 samples/s | 57.0 steps/s
[Step=10450 Epoch=20.4] | Loss=0.02664 | Reg=0.00349 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.668 | L2-Norm(final)=2.778 | 3583.0 samples/s | 56.0 steps/s
[Step=10500 Epoch=20.5] | Loss=0.02243 | Reg=0.00348 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.663 | L2-Norm(final)=2.781 | 3725.4 samples/s | 58.2 steps/s
[Step=10550 Epoch=20.6] | Loss=0.02114 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.659 | L2-Norm(final)=2.783 | 3748.8 samples/s | 58.6 steps/s
[Step=10600 Epoch=20.7] | Loss=0.02008 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.657 | L2-Norm(final)=2.784 | 3755.8 samples/s | 58.7 steps/s
[Step=10650 Epoch=20.8] | Loss=0.01897 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.655 | L2-Norm(final)=2.785 | 3747.9 samples/s | 58.6 steps/s
[Step=10700 Epoch=20.9] | Loss=0.01946 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.655 | L2-Norm(final)=2.786 | 3743.4 samples/s | 58.5 steps/s
[Step=10750 Epoch=21.0] | Loss=0.01877 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.654 | L2-Norm(final)=2.788 | 3763.7 samples/s | 58.8 steps/s
[Step=10800 Epoch=21.1] | Loss=0.01903 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.654 | L2-Norm(final)=2.789 | 3750.4 samples/s | 58.6 steps/s
[Step=10850 Epoch=21.2] | Loss=0.01821 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.655 | L2-Norm(final)=2.790 | 3757.0 samples/s | 58.7 steps/s
[Step=10900 Epoch=21.3] | Loss=0.01815 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9375 | L2-Norm=18.655 | L2-Norm(final)=2.792 | 4353.7 samples/s | 68.0 steps/s
[Step=10950 Epoch=21.4] | Loss=0.01743 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.655 | L2-Norm(final)=2.793 | 1633.0 samples/s | 25.5 steps/s
[Step=11000 Epoch=21.5] | Loss=0.01664 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.656 | L2-Norm(final)=2.795 | 3724.5 samples/s | 58.2 steps/s
[Step=11050 Epoch=21.6] | Loss=0.01628 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.657 | L2-Norm(final)=2.797 | 3739.9 samples/s | 58.4 steps/s
[Step=11100 Epoch=21.6] | Loss=0.01599 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.658 | L2-Norm(final)=2.800 | 3724.9 samples/s | 58.2 steps/s
[Step=11150 Epoch=21.7] | Loss=0.01595 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.659 | L2-Norm(final)=2.802 | 3736.8 samples/s | 58.4 steps/s
[Step=11200 Epoch=21.8] | Loss=0.01568 | Reg=0.00348 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.659 | L2-Norm(final)=2.804 | 3738.7 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step11200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=39.9] | Loss=0.19231 | Reg=0.00350 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.695 | L2-Norm(final)=2.778 | 3515.2 samples/s | 54.9 steps/s
[Step=10450 Epoch=40.0] | Loss=0.01429 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.676 | L2-Norm(final)=2.768 | 3463.9 samples/s | 54.1 steps/s
[Step=10500 Epoch=40.2] | Loss=0.00786 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.670 | L2-Norm(final)=2.768 | 3498.5 samples/s | 54.7 steps/s
[Step=10550 Epoch=40.4] | Loss=0.00537 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.664 | L2-Norm(final)=2.768 | 3524.8 samples/s | 55.1 steps/s
[Step=10600 Epoch=40.6] | Loss=0.00407 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.658 | L2-Norm(final)=2.769 | 3533.9 samples/s | 55.2 steps/s
[Step=10650 Epoch=40.8] | Loss=0.00328 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.653 | L2-Norm(final)=2.770 | 4243.6 samples/s | 66.3 steps/s
[Step=10700 Epoch=41.0] | Loss=0.00274 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.649 | L2-Norm(final)=2.771 | 1615.2 samples/s | 25.2 steps/s
[Step=10750 Epoch=41.2] | Loss=0.00236 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.645 | L2-Norm(final)=2.772 | 3536.3 samples/s | 55.3 steps/s
[Step=10800 Epoch=41.4] | Loss=0.00207 | Reg=0.00348 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.641 | L2-Norm(final)=2.772 | 3532.4 samples/s | 55.2 steps/s
[Step=10850 Epoch=41.6] | Loss=0.00184 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.638 | L2-Norm(final)=2.773 | 3569.6 samples/s | 55.8 steps/s
[Step=10900 Epoch=41.8] | Loss=0.00166 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.635 | L2-Norm(final)=2.774 | 3826.0 samples/s | 59.8 steps/s
[Step=10950 Epoch=42.0] | Loss=0.00151 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.632 | L2-Norm(final)=2.774 | 1677.9 samples/s | 26.2 steps/s
[Step=11000 Epoch=42.1] | Loss=0.00139 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.630 | L2-Norm(final)=2.775 | 3517.1 samples/s | 55.0 steps/s
[Step=11050 Epoch=42.3] | Loss=0.00129 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.627 | L2-Norm(final)=2.775 | 3492.2 samples/s | 54.6 steps/s
[Step=11100 Epoch=42.5] | Loss=0.00120 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.625 | L2-Norm(final)=2.775 | 3505.3 samples/s | 54.8 steps/s
[Step=11150 Epoch=42.7] | Loss=0.00112 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.623 | L2-Norm(final)=2.776 | 3514.9 samples/s | 54.9 steps/s
[Step=11200 Epoch=42.9] | Loss=0.00105 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.621 | L2-Norm(final)=2.776 | 1714.7 samples/s | 26.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23847 | acc=0.8404 | tpr=0.7752 | fpr=0.0181 | 3828.9 samples/s | 15.0 steps/s
Avg test loss: 0.24070, Avg test acc: 0.84005, Avg tpr: 0.77630, Avg fpr: 0.01974, total FA: 154

Testing server on iccad2012
[Step=  50] | Loss=0.44824 | acc=0.8334 | tpr=0.9912 | fpr=0.1695 | 3852.1 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.46037 | acc=0.8306 | tpr=0.9893 | fpr=0.1724 | 7235.6 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.46952 | acc=0.8281 | tpr=0.9899 | fpr=0.1749 | 7244.7 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.47238 | acc=0.8277 | tpr=0.9880 | fpr=0.1752 | 6242.6 samples/s | 24.4 steps/s
[Step= 250] | Loss=0.46758 | acc=0.8282 | tpr=0.9869 | fpr=0.1747 | 7284.1 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.46654 | acc=0.8291 | tpr=0.9869 | fpr=0.1737 | 7265.1 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.46710 | acc=0.8289 | tpr=0.9862 | fpr=0.1740 | 6248.4 samples/s | 24.4 steps/s
[Step= 400] | Loss=0.46671 | acc=0.8291 | tpr=0.9869 | fpr=0.1737 | 5586.2 samples/s | 21.8 steps/s
[Step= 450] | Loss=0.47004 | acc=0.8283 | tpr=0.9873 | fpr=0.1746 | 7212.2 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.47030 | acc=0.8280 | tpr=0.9872 | fpr=0.1748 | 7110.1 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.46862 | acc=0.8283 | tpr=0.9873 | fpr=0.1746 | 13284.6 samples/s | 51.9 steps/s
Avg test loss: 0.46834, Avg test acc: 0.82831, Avg tpr: 0.98732, Avg fpr: 0.17458, total FA: 24240

server round 28/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=10401 Epoch=20.3] | Loss=0.08980 | Reg=0.00347 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.635 | L2-Norm(final)=2.804 | 3902.7 samples/s | 61.0 steps/s
[Step=10450 Epoch=20.4] | Loss=0.02555 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.604 | L2-Norm(final)=2.803 | 3445.5 samples/s | 53.8 steps/s
[Step=10500 Epoch=20.5] | Loss=0.01877 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.598 | L2-Norm(final)=2.806 | 3734.6 samples/s | 58.4 steps/s
[Step=10550 Epoch=20.6] | Loss=0.01761 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.596 | L2-Norm(final)=2.810 | 3738.7 samples/s | 58.4 steps/s
[Step=10600 Epoch=20.7] | Loss=0.01818 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.596 | L2-Norm(final)=2.813 | 3720.9 samples/s | 58.1 steps/s
[Step=10650 Epoch=20.8] | Loss=0.01757 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.596 | L2-Norm(final)=2.815 | 3734.4 samples/s | 58.3 steps/s
[Step=10700 Epoch=20.9] | Loss=0.01739 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.596 | L2-Norm(final)=2.817 | 3754.2 samples/s | 58.7 steps/s
[Step=10750 Epoch=21.0] | Loss=0.01757 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.597 | L2-Norm(final)=2.819 | 3760.2 samples/s | 58.8 steps/s
[Step=10800 Epoch=21.1] | Loss=0.01742 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.597 | L2-Norm(final)=2.820 | 3772.5 samples/s | 58.9 steps/s
[Step=10850 Epoch=21.2] | Loss=0.01735 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.598 | L2-Norm(final)=2.822 | 3765.6 samples/s | 58.8 steps/s
[Step=10900 Epoch=21.3] | Loss=0.01699 | Reg=0.00346 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.598 | L2-Norm(final)=2.823 | 4357.6 samples/s | 68.1 steps/s
[Step=10950 Epoch=21.4] | Loss=0.01657 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.599 | L2-Norm(final)=2.825 | 1669.6 samples/s | 26.1 steps/s
[Step=11000 Epoch=21.5] | Loss=0.01627 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.600 | L2-Norm(final)=2.827 | 3717.3 samples/s | 58.1 steps/s
[Step=11050 Epoch=21.6] | Loss=0.01580 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.600 | L2-Norm(final)=2.828 | 3730.9 samples/s | 58.3 steps/s
[Step=11100 Epoch=21.7] | Loss=0.01553 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.601 | L2-Norm(final)=2.830 | 3724.1 samples/s | 58.2 steps/s
[Step=11150 Epoch=21.8] | Loss=0.01527 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.602 | L2-Norm(final)=2.832 | 3751.8 samples/s | 58.6 steps/s
[Step=11200 Epoch=21.9] | Loss=0.01523 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.603 | L2-Norm(final)=2.834 | 3753.9 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step11200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=12001 Epoch=46.2] | Loss=0.12484 | Reg=0.00347 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.635 | L2-Norm(final)=2.803 | 3672.5 samples/s | 57.4 steps/s
[Step=12050 Epoch=46.4] | Loss=0.00784 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.597 | L2-Norm(final)=2.798 | 3384.1 samples/s | 52.9 steps/s
[Step=12100 Epoch=46.6] | Loss=0.00401 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.589 | L2-Norm(final)=2.798 | 3541.9 samples/s | 55.3 steps/s
[Step=12150 Epoch=46.8] | Loss=0.00278 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.583 | L2-Norm(final)=2.799 | 3525.7 samples/s | 55.1 steps/s
[Step=12200 Epoch=47.0] | Loss=0.00210 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.578 | L2-Norm(final)=2.801 | 3549.4 samples/s | 55.5 steps/s
[Step=12250 Epoch=47.2] | Loss=0.00170 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.573 | L2-Norm(final)=2.802 | 4271.0 samples/s | 66.7 steps/s
[Step=12300 Epoch=47.3] | Loss=0.00142 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.569 | L2-Norm(final)=2.803 | 1595.6 samples/s | 24.9 steps/s
[Step=12350 Epoch=47.5] | Loss=0.00122 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.566 | L2-Norm(final)=2.804 | 3517.4 samples/s | 55.0 steps/s
[Step=12400 Epoch=47.7] | Loss=0.00107 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.563 | L2-Norm(final)=2.804 | 3542.7 samples/s | 55.4 steps/s
[Step=12450 Epoch=47.9] | Loss=0.00096 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.560 | L2-Norm(final)=2.805 | 3521.4 samples/s | 55.0 steps/s
[Step=12500 Epoch=48.1] | Loss=0.00087 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.557 | L2-Norm(final)=2.806 | 3890.7 samples/s | 60.8 steps/s
[Step=12550 Epoch=48.3] | Loss=0.00079 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.555 | L2-Norm(final)=2.806 | 1655.4 samples/s | 25.9 steps/s
[Step=12600 Epoch=48.5] | Loss=0.00073 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.553 | L2-Norm(final)=2.807 | 3532.5 samples/s | 55.2 steps/s
[Step=12650 Epoch=48.7] | Loss=0.00067 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.551 | L2-Norm(final)=2.807 | 3545.5 samples/s | 55.4 steps/s
[Step=12700 Epoch=48.9] | Loss=0.00063 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.549 | L2-Norm(final)=2.808 | 3503.8 samples/s | 54.7 steps/s
[Step=12750 Epoch=49.1] | Loss=0.00059 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.547 | L2-Norm(final)=2.808 | 3562.5 samples/s | 55.7 steps/s
[Step=12800 Epoch=49.3] | Loss=0.00055 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.545 | L2-Norm(final)=2.809 | 1710.6 samples/s | 26.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22709 | acc=0.8485 | tpr=0.7865 | fpr=0.0168 | 3748.2 samples/s | 14.6 steps/s
Avg test loss: 0.23013, Avg test acc: 0.84754, Avg tpr: 0.78703, Avg fpr: 0.01936, total FA: 151

Testing server on iccad2012
[Step=  50] | Loss=0.47438 | acc=0.8232 | tpr=0.9912 | fpr=0.1798 | 3573.1 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.48677 | acc=0.8221 | tpr=0.9893 | fpr=0.1810 | 7120.2 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.49596 | acc=0.8195 | tpr=0.9885 | fpr=0.1836 | 7274.0 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.49908 | acc=0.8194 | tpr=0.9880 | fpr=0.1837 | 7102.4 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.49393 | acc=0.8199 | tpr=0.9869 | fpr=0.1832 | 5025.0 samples/s | 19.6 steps/s
[Step= 300] | Loss=0.49303 | acc=0.8206 | tpr=0.9884 | fpr=0.1824 | 7126.6 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.49388 | acc=0.8202 | tpr=0.9875 | fpr=0.1828 | 7299.2 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.49347 | acc=0.8204 | tpr=0.9885 | fpr=0.1827 | 7330.1 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.49694 | acc=0.8197 | tpr=0.9888 | fpr=0.1834 | 7011.9 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.49705 | acc=0.8194 | tpr=0.9890 | fpr=0.1837 | 7230.2 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.49536 | acc=0.8199 | tpr=0.9893 | fpr=0.1832 | 12978.2 samples/s | 50.7 steps/s
Avg test loss: 0.49509, Avg test acc: 0.81991, Avg tpr: 0.98930, Avg fpr: 0.18317, total FA: 25433

server round 29/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=21.9] | Loss=0.15671 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.588 | L2-Norm(final)=2.823 | 3640.4 samples/s | 56.9 steps/s
[Step=11250 Epoch=22.0] | Loss=0.02973 | Reg=0.00345 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.562 | L2-Norm(final)=2.819 | 3707.0 samples/s | 57.9 steps/s
[Step=11300 Epoch=22.1] | Loss=0.02129 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.557 | L2-Norm(final)=2.822 | 3744.8 samples/s | 58.5 steps/s
[Step=11350 Epoch=22.2] | Loss=0.02014 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.556 | L2-Norm(final)=2.826 | 3759.4 samples/s | 58.7 steps/s
[Step=11400 Epoch=22.3] | Loss=0.01856 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.555 | L2-Norm(final)=2.829 | 3726.1 samples/s | 58.2 steps/s
[Step=11450 Epoch=22.4] | Loss=0.01809 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.555 | L2-Norm(final)=2.832 | 3746.6 samples/s | 58.5 steps/s
[Step=11500 Epoch=22.5] | Loss=0.01783 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.555 | L2-Norm(final)=2.835 | 3758.6 samples/s | 58.7 steps/s
[Step=11550 Epoch=22.6] | Loss=0.01723 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.555 | L2-Norm(final)=2.837 | 3756.6 samples/s | 58.7 steps/s
[Step=11600 Epoch=22.7] | Loss=0.01738 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.555 | L2-Norm(final)=2.839 | 3770.7 samples/s | 58.9 steps/s
[Step=11650 Epoch=22.8] | Loss=0.01698 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.555 | L2-Norm(final)=2.840 | 3739.8 samples/s | 58.4 steps/s
[Step=11700 Epoch=22.9] | Loss=0.01669 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.555 | L2-Norm(final)=2.841 | 4403.6 samples/s | 68.8 steps/s
[Step=11750 Epoch=23.0] | Loss=0.01629 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.556 | L2-Norm(final)=2.842 | 1672.9 samples/s | 26.1 steps/s
[Step=11800 Epoch=23.1] | Loss=0.01598 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.556 | L2-Norm(final)=2.844 | 3727.7 samples/s | 58.2 steps/s
[Step=11850 Epoch=23.2] | Loss=0.01581 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.556 | L2-Norm(final)=2.845 | 3740.2 samples/s | 58.4 steps/s
[Step=11900 Epoch=23.3] | Loss=0.01550 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.557 | L2-Norm(final)=2.847 | 3743.5 samples/s | 58.5 steps/s
[Step=11950 Epoch=23.4] | Loss=0.01527 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.557 | L2-Norm(final)=2.848 | 3730.7 samples/s | 58.3 steps/s
[Step=12000 Epoch=23.5] | Loss=0.01503 | Reg=0.00344 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.558 | L2-Norm(final)=2.850 | 3763.2 samples/s | 58.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step12000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=11201 Epoch=42.9] | Loss=0.14251 | Reg=0.00346 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.588 | L2-Norm(final)=2.823 | 3725.6 samples/s | 58.2 steps/s
[Step=11250 Epoch=43.1] | Loss=0.01039 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.556 | L2-Norm(final)=2.814 | 3383.2 samples/s | 52.9 steps/s
[Step=11300 Epoch=43.3] | Loss=0.00534 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.547 | L2-Norm(final)=2.814 | 3543.1 samples/s | 55.4 steps/s
[Step=11350 Epoch=43.5] | Loss=0.00364 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.540 | L2-Norm(final)=2.815 | 3519.4 samples/s | 55.0 steps/s
[Step=11400 Epoch=43.7] | Loss=0.00276 | Reg=0.00344 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.535 | L2-Norm(final)=2.816 | 3552.6 samples/s | 55.5 steps/s
[Step=11450 Epoch=43.9] | Loss=0.00222 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.530 | L2-Norm(final)=2.817 | 4266.1 samples/s | 66.7 steps/s
[Step=11500 Epoch=44.1] | Loss=0.00186 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.526 | L2-Norm(final)=2.818 | 1626.7 samples/s | 25.4 steps/s
[Step=11550 Epoch=44.3] | Loss=0.00160 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.522 | L2-Norm(final)=2.818 | 3519.0 samples/s | 55.0 steps/s
[Step=11600 Epoch=44.4] | Loss=0.00140 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.519 | L2-Norm(final)=2.819 | 3532.0 samples/s | 55.2 steps/s
[Step=11650 Epoch=44.6] | Loss=0.00125 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.516 | L2-Norm(final)=2.820 | 3533.6 samples/s | 55.2 steps/s
[Step=11700 Epoch=44.8] | Loss=0.00113 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.513 | L2-Norm(final)=2.820 | 3834.7 samples/s | 59.9 steps/s
[Step=11750 Epoch=45.0] | Loss=0.00103 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.511 | L2-Norm(final)=2.821 | 1672.4 samples/s | 26.1 steps/s
[Step=11800 Epoch=45.2] | Loss=0.00095 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.509 | L2-Norm(final)=2.821 | 3545.2 samples/s | 55.4 steps/s
[Step=11850 Epoch=45.4] | Loss=0.00088 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.507 | L2-Norm(final)=2.822 | 3523.5 samples/s | 55.1 steps/s
[Step=11900 Epoch=45.6] | Loss=0.00081 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.505 | L2-Norm(final)=2.822 | 3527.3 samples/s | 55.1 steps/s
[Step=11950 Epoch=45.8] | Loss=0.00076 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.503 | L2-Norm(final)=2.823 | 3520.9 samples/s | 55.0 steps/s
[Step=12000 Epoch=46.0] | Loss=0.00072 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.501 | L2-Norm(final)=2.823 | 1721.6 samples/s | 26.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20616 | acc=0.8635 | tpr=0.8089 | fpr=0.0178 | 3810.7 samples/s | 14.9 steps/s
Avg test loss: 0.20892, Avg test acc: 0.86305, Avg tpr: 0.80941, Avg fpr: 0.01897, total FA: 148

Testing server on iccad2012
[Step=  50] | Loss=0.50792 | acc=0.8082 | tpr=0.9867 | fpr=0.1950 | 3793.3 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.52090 | acc=0.8079 | tpr=0.9872 | fpr=0.1955 | 5048.2 samples/s | 19.7 steps/s
[Step= 150] | Loss=0.52963 | acc=0.8043 | tpr=0.9870 | fpr=0.1990 | 6294.3 samples/s | 24.6 steps/s
[Step= 200] | Loss=0.53234 | acc=0.8047 | tpr=0.9880 | fpr=0.1986 | 7109.0 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.52737 | acc=0.8052 | tpr=0.9852 | fpr=0.1981 | 7203.9 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.52602 | acc=0.8061 | tpr=0.9862 | fpr=0.1971 | 7482.2 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.52657 | acc=0.8057 | tpr=0.9856 | fpr=0.1975 | 7283.5 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.52605 | acc=0.8058 | tpr=0.9869 | fpr=0.1975 | 7001.5 samples/s | 27.3 steps/s
[Step= 450] | Loss=0.52982 | acc=0.8051 | tpr=0.9873 | fpr=0.1982 | 7209.2 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.53001 | acc=0.8048 | tpr=0.9877 | fpr=0.1985 | 7351.2 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.52826 | acc=0.8055 | tpr=0.9881 | fpr=0.1978 | 13417.2 samples/s | 52.4 steps/s
Avg test loss: 0.52798, Avg test acc: 0.80556, Avg tpr: 0.98811, Avg fpr: 0.19776, total FA: 27459

server round 30/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=11201 Epoch=21.8] | Loss=0.05633 | Reg=0.00344 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.547 | L2-Norm(final)=2.838 | 3495.0 samples/s | 54.6 steps/s
[Step=11250 Epoch=21.9] | Loss=0.02921 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.523 | L2-Norm(final)=2.838 | 3608.2 samples/s | 56.4 steps/s
[Step=11300 Epoch=22.0] | Loss=0.02174 | Reg=0.00343 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.515 | L2-Norm(final)=2.839 | 3732.1 samples/s | 58.3 steps/s
[Step=11350 Epoch=22.1] | Loss=0.01840 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.511 | L2-Norm(final)=2.841 | 3755.4 samples/s | 58.7 steps/s
[Step=11400 Epoch=22.2] | Loss=0.01712 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.509 | L2-Norm(final)=2.843 | 3760.0 samples/s | 58.7 steps/s
[Step=11450 Epoch=22.3] | Loss=0.01626 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.507 | L2-Norm(final)=2.845 | 3752.6 samples/s | 58.6 steps/s
[Step=11500 Epoch=22.4] | Loss=0.01644 | Reg=0.00342 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.506 | L2-Norm(final)=2.847 | 3781.4 samples/s | 59.1 steps/s
[Step=11550 Epoch=22.5] | Loss=0.01585 | Reg=0.00342 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.505 | L2-Norm(final)=2.848 | 3729.4 samples/s | 58.3 steps/s
[Step=11600 Epoch=22.6] | Loss=0.01531 | Reg=0.00342 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.505 | L2-Norm(final)=2.849 | 3766.1 samples/s | 58.8 steps/s
[Step=11650 Epoch=22.7] | Loss=0.01475 | Reg=0.00342 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.504 | L2-Norm(final)=2.851 | 3744.6 samples/s | 58.5 steps/s
[Step=11700 Epoch=22.8] | Loss=0.01417 | Reg=0.00342 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.504 | L2-Norm(final)=2.852 | 4375.7 samples/s | 68.4 steps/s
[Step=11750 Epoch=22.9] | Loss=0.01369 | Reg=0.00342 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.504 | L2-Norm(final)=2.854 | 1595.9 samples/s | 24.9 steps/s
[Step=11800 Epoch=23.0] | Loss=0.01318 | Reg=0.00342 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.504 | L2-Norm(final)=2.856 | 3707.2 samples/s | 57.9 steps/s
[Step=11850 Epoch=23.1] | Loss=0.01297 | Reg=0.00342 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.504 | L2-Norm(final)=2.858 | 3705.2 samples/s | 57.9 steps/s
[Step=11900 Epoch=23.2] | Loss=0.01278 | Reg=0.00342 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.504 | L2-Norm(final)=2.859 | 3714.6 samples/s | 58.0 steps/s
[Step=11950 Epoch=23.3] | Loss=0.01252 | Reg=0.00342 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.504 | L2-Norm(final)=2.861 | 3744.6 samples/s | 58.5 steps/s
[Step=12000 Epoch=23.4] | Loss=0.01221 | Reg=0.00342 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.504 | L2-Norm(final)=2.863 | 3757.8 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step12000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=46.0] | Loss=0.19288 | Reg=0.00344 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.547 | L2-Norm(final)=2.837 | 3863.8 samples/s | 60.4 steps/s
[Step=12050 Epoch=46.2] | Loss=0.01032 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.511 | L2-Norm(final)=2.833 | 3275.5 samples/s | 51.2 steps/s
[Step=12100 Epoch=46.4] | Loss=0.00533 | Reg=0.00342 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.501 | L2-Norm(final)=2.834 | 3516.4 samples/s | 54.9 steps/s
[Step=12150 Epoch=46.6] | Loss=0.00363 | Reg=0.00342 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.495 | L2-Norm(final)=2.835 | 3531.9 samples/s | 55.2 steps/s
[Step=12200 Epoch=46.7] | Loss=0.00274 | Reg=0.00342 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.490 | L2-Norm(final)=2.836 | 3526.5 samples/s | 55.1 steps/s
[Step=12250 Epoch=46.9] | Loss=0.00223 | Reg=0.00342 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.486 | L2-Norm(final)=2.836 | 4242.7 samples/s | 66.3 steps/s
[Step=12300 Epoch=47.1] | Loss=0.00187 | Reg=0.00342 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.483 | L2-Norm(final)=2.837 | 1628.9 samples/s | 25.5 steps/s
[Step=12350 Epoch=47.3] | Loss=0.00161 | Reg=0.00342 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.480 | L2-Norm(final)=2.837 | 3540.8 samples/s | 55.3 steps/s
[Step=12400 Epoch=47.5] | Loss=0.00141 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.477 | L2-Norm(final)=2.838 | 3517.6 samples/s | 55.0 steps/s
[Step=12450 Epoch=47.7] | Loss=0.00126 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.475 | L2-Norm(final)=2.838 | 3537.5 samples/s | 55.3 steps/s
[Step=12500 Epoch=47.9] | Loss=0.00114 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.473 | L2-Norm(final)=2.839 | 3835.0 samples/s | 59.9 steps/s
[Step=12550 Epoch=48.1] | Loss=0.00104 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.471 | L2-Norm(final)=2.839 | 1692.8 samples/s | 26.4 steps/s
[Step=12600 Epoch=48.3] | Loss=0.00096 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.469 | L2-Norm(final)=2.839 | 3519.0 samples/s | 55.0 steps/s
[Step=12650 Epoch=48.5] | Loss=0.00089 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.467 | L2-Norm(final)=2.840 | 3517.1 samples/s | 55.0 steps/s
[Step=12700 Epoch=48.7] | Loss=0.00082 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.465 | L2-Norm(final)=2.840 | 3531.7 samples/s | 55.2 steps/s
[Step=12750 Epoch=48.9] | Loss=0.00077 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.464 | L2-Norm(final)=2.840 | 3536.2 samples/s | 55.3 steps/s
[Step=12800 Epoch=49.0] | Loss=0.00073 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.462 | L2-Norm(final)=2.841 | 1744.8 samples/s | 27.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18900 | acc=0.8766 | tpr=0.8276 | fpr=0.0168 | 2890.3 samples/s | 11.3 steps/s
Avg test loss: 0.19253, Avg test acc: 0.87647, Avg tpr: 0.82858, Avg fpr: 0.01820, total FA: 142

Testing server on iccad2012
[Step=  50] | Loss=0.57015 | acc=0.7873 | tpr=0.9823 | fpr=0.2162 | 3816.4 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.58301 | acc=0.7872 | tpr=0.9851 | fpr=0.2165 | 7368.7 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.59251 | acc=0.7843 | tpr=0.9856 | fpr=0.2194 | 7375.7 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.59499 | acc=0.7850 | tpr=0.9869 | fpr=0.2187 | 7403.0 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.58955 | acc=0.7859 | tpr=0.9852 | fpr=0.2178 | 6957.4 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.58796 | acc=0.7866 | tpr=0.9869 | fpr=0.2170 | 7371.5 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.58867 | acc=0.7861 | tpr=0.9862 | fpr=0.2175 | 7364.6 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.58822 | acc=0.7863 | tpr=0.9874 | fpr=0.2174 | 7382.4 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.59206 | acc=0.7855 | tpr=0.9878 | fpr=0.2182 | 6859.1 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.59238 | acc=0.7853 | tpr=0.9881 | fpr=0.2183 | 7275.9 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.59052 | acc=0.7858 | tpr=0.9885 | fpr=0.2179 | 13178.6 samples/s | 51.5 steps/s
Avg test loss: 0.59020, Avg test acc: 0.78585, Avg tpr: 0.98851, Avg fpr: 0.21784, total FA: 30246

server round 31/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=23.4] | Loss=0.09074 | Reg=0.00342 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.500 | L2-Norm(final)=2.856 | 3422.7 samples/s | 53.5 steps/s
[Step=12050 Epoch=23.5] | Loss=0.02776 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.474 | L2-Norm(final)=2.854 | 3639.3 samples/s | 56.9 steps/s
[Step=12100 Epoch=23.6] | Loss=0.02081 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.466 | L2-Norm(final)=2.856 | 3723.8 samples/s | 58.2 steps/s
[Step=12150 Epoch=23.7] | Loss=0.01877 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.463 | L2-Norm(final)=2.858 | 3725.0 samples/s | 58.2 steps/s
[Step=12200 Epoch=23.8] | Loss=0.01778 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.461 | L2-Norm(final)=2.859 | 3721.4 samples/s | 58.1 steps/s
[Step=12250 Epoch=23.9] | Loss=0.01668 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.459 | L2-Norm(final)=2.861 | 3712.2 samples/s | 58.0 steps/s
[Step=12300 Epoch=24.0] | Loss=0.01594 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.458 | L2-Norm(final)=2.863 | 3740.8 samples/s | 58.5 steps/s
[Step=12350 Epoch=24.1] | Loss=0.01489 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.458 | L2-Norm(final)=2.865 | 3747.2 samples/s | 58.5 steps/s
[Step=12400 Epoch=24.2] | Loss=0.01455 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.457 | L2-Norm(final)=2.867 | 3737.9 samples/s | 58.4 steps/s
[Step=12450 Epoch=24.3] | Loss=0.01462 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.457 | L2-Norm(final)=2.868 | 3740.7 samples/s | 58.4 steps/s
[Step=12500 Epoch=24.4] | Loss=0.01414 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.457 | L2-Norm(final)=2.870 | 4357.9 samples/s | 68.1 steps/s
[Step=12550 Epoch=24.5] | Loss=0.01364 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.456 | L2-Norm(final)=2.872 | 1628.0 samples/s | 25.4 steps/s
[Step=12600 Epoch=24.6] | Loss=0.01335 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.456 | L2-Norm(final)=2.873 | 3720.3 samples/s | 58.1 steps/s
[Step=12650 Epoch=24.7] | Loss=0.01302 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.456 | L2-Norm(final)=2.875 | 3731.3 samples/s | 58.3 steps/s
[Step=12700 Epoch=24.8] | Loss=0.01275 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.456 | L2-Norm(final)=2.877 | 3726.3 samples/s | 58.2 steps/s
[Step=12750 Epoch=24.9] | Loss=0.01253 | Reg=0.00341 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.456 | L2-Norm(final)=2.878 | 3736.4 samples/s | 58.4 steps/s
[Step=12800 Epoch=25.0] | Loss=0.01236 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.456 | L2-Norm(final)=2.880 | 3750.2 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step12800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=49.3] | Loss=0.16734 | Reg=0.00342 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.500 | L2-Norm(final)=2.856 | 3663.6 samples/s | 57.2 steps/s
[Step=12850 Epoch=49.5] | Loss=0.00825 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.467 | L2-Norm(final)=2.855 | 3379.4 samples/s | 52.8 steps/s
[Step=12900 Epoch=49.7] | Loss=0.00427 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.458 | L2-Norm(final)=2.855 | 3544.6 samples/s | 55.4 steps/s
[Step=12950 Epoch=49.8] | Loss=0.00288 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.451 | L2-Norm(final)=2.856 | 3525.0 samples/s | 55.1 steps/s
[Step=13000 Epoch=50.0] | Loss=0.00221 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.446 | L2-Norm(final)=2.857 | 3530.0 samples/s | 55.2 steps/s
[Step=13050 Epoch=50.2] | Loss=0.00180 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.442 | L2-Norm(final)=2.857 | 4291.3 samples/s | 67.1 steps/s
[Step=13100 Epoch=50.4] | Loss=0.00151 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.439 | L2-Norm(final)=2.858 | 1616.5 samples/s | 25.3 steps/s
[Step=13150 Epoch=50.6] | Loss=0.00130 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.435 | L2-Norm(final)=2.859 | 3563.3 samples/s | 55.7 steps/s
[Step=13200 Epoch=50.8] | Loss=0.00114 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.433 | L2-Norm(final)=2.859 | 3546.8 samples/s | 55.4 steps/s
[Step=13250 Epoch=51.0] | Loss=0.00102 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.430 | L2-Norm(final)=2.859 | 3530.7 samples/s | 55.2 steps/s
[Step=13300 Epoch=51.2] | Loss=0.00092 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.428 | L2-Norm(final)=2.860 | 3897.1 samples/s | 60.9 steps/s
[Step=13350 Epoch=51.4] | Loss=0.00084 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.426 | L2-Norm(final)=2.860 | 1678.7 samples/s | 26.2 steps/s
[Step=13400 Epoch=51.6] | Loss=0.00078 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.424 | L2-Norm(final)=2.861 | 3528.2 samples/s | 55.1 steps/s
[Step=13450 Epoch=51.8] | Loss=0.00072 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.422 | L2-Norm(final)=2.861 | 3515.5 samples/s | 54.9 steps/s
[Step=13500 Epoch=52.0] | Loss=0.00067 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.420 | L2-Norm(final)=2.861 | 3552.7 samples/s | 55.5 steps/s
[Step=13550 Epoch=52.2] | Loss=0.00063 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.419 | L2-Norm(final)=2.861 | 3588.3 samples/s | 56.1 steps/s
[Step=13600 Epoch=52.4] | Loss=0.00059 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.417 | L2-Norm(final)=2.862 | 1718.2 samples/s | 26.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22183 | acc=0.8585 | tpr=0.7999 | fpr=0.0141 | 3842.1 samples/s | 15.0 steps/s
Avg test loss: 0.22589, Avg test acc: 0.85672, Avg tpr: 0.79915, Avg fpr: 0.01666, total FA: 130

Testing server on iccad2012
[Step=  50] | Loss=0.49883 | acc=0.8163 | tpr=0.9823 | fpr=0.1867 | 3830.1 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.51149 | acc=0.8151 | tpr=0.9851 | fpr=0.1881 | 7326.1 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.52055 | acc=0.8123 | tpr=0.9856 | fpr=0.1909 | 7028.2 samples/s | 27.5 steps/s
[Step= 200] | Loss=0.52361 | acc=0.8123 | tpr=0.9847 | fpr=0.1908 | 7354.3 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.51839 | acc=0.8135 | tpr=0.9834 | fpr=0.1896 | 7346.9 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.51699 | acc=0.8142 | tpr=0.9847 | fpr=0.1889 | 7170.9 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.51747 | acc=0.8139 | tpr=0.9843 | fpr=0.1892 | 7436.1 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.51684 | acc=0.8141 | tpr=0.9858 | fpr=0.1890 | 7172.8 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.52060 | acc=0.8134 | tpr=0.9864 | fpr=0.1898 | 7301.9 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.52078 | acc=0.8132 | tpr=0.9868 | fpr=0.1899 | 7194.2 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.51906 | acc=0.8136 | tpr=0.9873 | fpr=0.1896 | 12583.8 samples/s | 49.2 steps/s
Avg test loss: 0.51879, Avg test acc: 0.81362, Avg tpr: 0.98732, Avg fpr: 0.18954, total FA: 26317

server round 32/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=25.0] | Loss=0.05511 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.457 | L2-Norm(final)=2.872 | 3403.6 samples/s | 53.2 steps/s
[Step=12850 Epoch=25.1] | Loss=0.02969 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.430 | L2-Norm(final)=2.868 | 3620.1 samples/s | 56.6 steps/s
[Step=12900 Epoch=25.2] | Loss=0.02130 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.423 | L2-Norm(final)=2.870 | 3742.2 samples/s | 58.5 steps/s
[Step=12950 Epoch=25.3] | Loss=0.01800 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.420 | L2-Norm(final)=2.872 | 3746.2 samples/s | 58.5 steps/s
[Step=13000 Epoch=25.4] | Loss=0.01652 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.418 | L2-Norm(final)=2.874 | 3737.3 samples/s | 58.4 steps/s
[Step=13050 Epoch=25.5] | Loss=0.01530 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.416 | L2-Norm(final)=2.876 | 3747.6 samples/s | 58.6 steps/s
[Step=13100 Epoch=25.6] | Loss=0.01492 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.416 | L2-Norm(final)=2.879 | 3747.6 samples/s | 58.6 steps/s
[Step=13150 Epoch=25.6] | Loss=0.01461 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.415 | L2-Norm(final)=2.881 | 3762.3 samples/s | 58.8 steps/s
[Step=13200 Epoch=25.7] | Loss=0.01432 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.415 | L2-Norm(final)=2.883 | 3751.6 samples/s | 58.6 steps/s
[Step=13250 Epoch=25.8] | Loss=0.01393 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.415 | L2-Norm(final)=2.884 | 3738.7 samples/s | 58.4 steps/s
[Step=13300 Epoch=25.9] | Loss=0.01393 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.414 | L2-Norm(final)=2.886 | 4362.4 samples/s | 68.2 steps/s
[Step=13350 Epoch=26.0] | Loss=0.01340 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.414 | L2-Norm(final)=2.887 | 1630.2 samples/s | 25.5 steps/s
[Step=13400 Epoch=26.1] | Loss=0.01308 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.414 | L2-Norm(final)=2.889 | 3729.3 samples/s | 58.3 steps/s
[Step=13450 Epoch=26.2] | Loss=0.01258 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.414 | L2-Norm(final)=2.891 | 3724.8 samples/s | 58.2 steps/s
[Step=13500 Epoch=26.3] | Loss=0.01243 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.415 | L2-Norm(final)=2.893 | 3741.2 samples/s | 58.5 steps/s
[Step=13550 Epoch=26.4] | Loss=0.01236 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.415 | L2-Norm(final)=2.894 | 3736.9 samples/s | 58.4 steps/s
[Step=13600 Epoch=26.5] | Loss=0.01211 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.415 | L2-Norm(final)=2.896 | 3737.6 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step13600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=52.4] | Loss=0.04750 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.457 | L2-Norm(final)=2.872 | 3539.6 samples/s | 55.3 steps/s
[Step=13650 Epoch=52.5] | Loss=0.01460 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.422 | L2-Norm(final)=2.865 | 3551.2 samples/s | 55.5 steps/s
[Step=13700 Epoch=52.7] | Loss=0.00765 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.415 | L2-Norm(final)=2.864 | 3529.5 samples/s | 55.1 steps/s
[Step=13750 Epoch=52.9] | Loss=0.00516 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.409 | L2-Norm(final)=2.864 | 3553.0 samples/s | 55.5 steps/s
[Step=13800 Epoch=53.1] | Loss=0.00390 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.405 | L2-Norm(final)=2.864 | 3565.5 samples/s | 55.7 steps/s
[Step=13850 Epoch=53.3] | Loss=0.00314 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.401 | L2-Norm(final)=2.865 | 4301.2 samples/s | 67.2 steps/s
[Step=13900 Epoch=53.5] | Loss=0.00263 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.398 | L2-Norm(final)=2.865 | 1618.4 samples/s | 25.3 steps/s
[Step=13950 Epoch=53.7] | Loss=0.00226 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.395 | L2-Norm(final)=2.865 | 3532.9 samples/s | 55.2 steps/s
[Step=14000 Epoch=53.9] | Loss=0.00198 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.393 | L2-Norm(final)=2.866 | 3532.7 samples/s | 55.2 steps/s
[Step=14050 Epoch=54.1] | Loss=0.00177 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.391 | L2-Norm(final)=2.866 | 3535.5 samples/s | 55.2 steps/s
[Step=14100 Epoch=54.3] | Loss=0.00160 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.389 | L2-Norm(final)=2.867 | 3915.8 samples/s | 61.2 steps/s
[Step=14150 Epoch=54.5] | Loss=0.00146 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.387 | L2-Norm(final)=2.867 | 1667.9 samples/s | 26.1 steps/s
[Step=14200 Epoch=54.7] | Loss=0.00134 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.385 | L2-Norm(final)=2.867 | 3528.5 samples/s | 55.1 steps/s
[Step=14250 Epoch=54.9] | Loss=0.00124 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.383 | L2-Norm(final)=2.868 | 3533.9 samples/s | 55.2 steps/s
[Step=14300 Epoch=55.0] | Loss=0.00115 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.382 | L2-Norm(final)=2.868 | 3528.5 samples/s | 55.1 steps/s
[Step=14350 Epoch=55.2] | Loss=0.00108 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.380 | L2-Norm(final)=2.868 | 3572.9 samples/s | 55.8 steps/s
[Step=14400 Epoch=55.4] | Loss=0.00101 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.379 | L2-Norm(final)=2.868 | 1747.9 samples/s | 27.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21322 | acc=0.8637 | tpr=0.8075 | fpr=0.0144 | 3827.0 samples/s | 14.9 steps/s
Avg test loss: 0.21676, Avg test acc: 0.86261, Avg tpr: 0.80702, Avg fpr: 0.01513, total FA: 118

Testing server on iccad2012
[Step=  50] | Loss=0.49405 | acc=0.8178 | tpr=0.9823 | fpr=0.1851 | 3841.9 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.50772 | acc=0.8161 | tpr=0.9851 | fpr=0.1871 | 7209.8 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.51654 | acc=0.8129 | tpr=0.9856 | fpr=0.1903 | 7228.0 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.51939 | acc=0.8131 | tpr=0.9847 | fpr=0.1901 | 7064.5 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.51437 | acc=0.8139 | tpr=0.9843 | fpr=0.1892 | 7386.0 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.51290 | acc=0.8144 | tpr=0.9855 | fpr=0.1887 | 7237.1 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.51342 | acc=0.8139 | tpr=0.9850 | fpr=0.1892 | 7372.9 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.51276 | acc=0.8141 | tpr=0.9863 | fpr=0.1890 | 7126.6 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.51647 | acc=0.8133 | tpr=0.9869 | fpr=0.1899 | 7194.9 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.51656 | acc=0.8132 | tpr=0.9872 | fpr=0.1900 | 7211.4 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.51471 | acc=0.8135 | tpr=0.9877 | fpr=0.1896 | 13208.3 samples/s | 51.6 steps/s
Avg test loss: 0.51440, Avg test acc: 0.81356, Avg tpr: 0.98772, Avg fpr: 0.18960, total FA: 26326

server round 33/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=49.0] | Loss=0.33772 | Reg=0.00340 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.438 | L2-Norm(final)=2.878 | 3641.8 samples/s | 56.9 steps/s
[Step=12850 Epoch=49.2] | Loss=0.01239 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.405 | L2-Norm(final)=2.875 | 3423.2 samples/s | 53.5 steps/s
[Step=12900 Epoch=49.4] | Loss=0.00628 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.395 | L2-Norm(final)=2.875 | 3543.0 samples/s | 55.4 steps/s
[Step=12950 Epoch=49.6] | Loss=0.00422 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.389 | L2-Norm(final)=2.875 | 3520.3 samples/s | 55.0 steps/s
[Step=13000 Epoch=49.8] | Loss=0.00319 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.385 | L2-Norm(final)=2.876 | 3522.7 samples/s | 55.0 steps/s
[Step=13050 Epoch=50.0] | Loss=0.00258 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.381 | L2-Norm(final)=2.876 | 4231.4 samples/s | 66.1 steps/s
[Step=13100 Epoch=50.2] | Loss=0.00216 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.377 | L2-Norm(final)=2.876 | 1604.6 samples/s | 25.1 steps/s
[Step=13150 Epoch=50.4] | Loss=0.00186 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.374 | L2-Norm(final)=2.877 | 3502.0 samples/s | 54.7 steps/s
[Step=13200 Epoch=50.6] | Loss=0.00163 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.372 | L2-Norm(final)=2.877 | 3509.3 samples/s | 54.8 steps/s
[Step=13250 Epoch=50.8] | Loss=0.00146 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.369 | L2-Norm(final)=2.877 | 3499.9 samples/s | 54.7 steps/s
[Step=13300 Epoch=51.0] | Loss=0.00131 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=2.878 | 3844.6 samples/s | 60.1 steps/s
[Step=13350 Epoch=51.2] | Loss=0.00120 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.365 | L2-Norm(final)=2.878 | 1650.6 samples/s | 25.8 steps/s
[Step=13400 Epoch=51.3] | Loss=0.00110 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.363 | L2-Norm(final)=2.878 | 3524.8 samples/s | 55.1 steps/s
[Step=13450 Epoch=51.5] | Loss=0.00102 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.361 | L2-Norm(final)=2.878 | 3520.4 samples/s | 55.0 steps/s
[Step=13500 Epoch=51.7] | Loss=0.00095 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.360 | L2-Norm(final)=2.879 | 3513.5 samples/s | 54.9 steps/s
[Step=13550 Epoch=51.9] | Loss=0.00089 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.358 | L2-Norm(final)=2.879 | 3516.1 samples/s | 54.9 steps/s
[Step=13600 Epoch=52.1] | Loss=0.00084 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.357 | L2-Norm(final)=2.879 | 1728.9 samples/s | 27.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step13600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=55.4] | Loss=0.06365 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.438 | L2-Norm(final)=2.878 | 3625.9 samples/s | 56.7 steps/s
[Step=14450 Epoch=55.6] | Loss=0.00781 | Reg=0.00339 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.403 | L2-Norm(final)=2.877 | 3394.5 samples/s | 53.0 steps/s
[Step=14500 Epoch=55.8] | Loss=0.00415 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.395 | L2-Norm(final)=2.878 | 3525.6 samples/s | 55.1 steps/s
[Step=14550 Epoch=56.0] | Loss=0.00280 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.389 | L2-Norm(final)=2.879 | 3524.0 samples/s | 55.1 steps/s
[Step=14600 Epoch=56.2] | Loss=0.00213 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.385 | L2-Norm(final)=2.880 | 3526.8 samples/s | 55.1 steps/s
[Step=14650 Epoch=56.4] | Loss=0.00171 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.381 | L2-Norm(final)=2.880 | 4266.8 samples/s | 66.7 steps/s
[Step=14700 Epoch=56.6] | Loss=0.00144 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.377 | L2-Norm(final)=2.881 | 1613.8 samples/s | 25.2 steps/s
[Step=14750 Epoch=56.8] | Loss=0.00124 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.374 | L2-Norm(final)=2.881 | 3542.0 samples/s | 55.3 steps/s
[Step=14800 Epoch=57.0] | Loss=0.00109 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.372 | L2-Norm(final)=2.881 | 3545.4 samples/s | 55.4 steps/s
[Step=14850 Epoch=57.2] | Loss=0.00097 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.369 | L2-Norm(final)=2.882 | 3524.4 samples/s | 55.1 steps/s
[Step=14900 Epoch=57.4] | Loss=0.00088 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=2.882 | 3913.3 samples/s | 61.1 steps/s
[Step=14950 Epoch=57.5] | Loss=0.00080 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.365 | L2-Norm(final)=2.882 | 1674.9 samples/s | 26.2 steps/s
[Step=15000 Epoch=57.7] | Loss=0.00074 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.363 | L2-Norm(final)=2.883 | 3508.6 samples/s | 54.8 steps/s
[Step=15050 Epoch=57.9] | Loss=0.00069 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.361 | L2-Norm(final)=2.883 | 3533.2 samples/s | 55.2 steps/s
[Step=15100 Epoch=58.1] | Loss=0.00064 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.360 | L2-Norm(final)=2.883 | 3537.1 samples/s | 55.3 steps/s
[Step=15150 Epoch=58.3] | Loss=0.00060 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.358 | L2-Norm(final)=2.883 | 3581.4 samples/s | 56.0 steps/s
[Step=15200 Epoch=58.5] | Loss=0.00057 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.357 | L2-Norm(final)=2.884 | 1713.0 samples/s | 26.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21028 | acc=0.8662 | tpr=0.8113 | fpr=0.0146 | 3863.6 samples/s | 15.1 steps/s
Avg test loss: 0.21389, Avg test acc: 0.86517, Avg tpr: 0.81133, Avg fpr: 0.01641, total FA: 128

Testing server on iccad2012
[Step=  50] | Loss=0.50921 | acc=0.8157 | tpr=0.9823 | fpr=0.1873 | 3839.6 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.52257 | acc=0.8142 | tpr=0.9851 | fpr=0.1890 | 7226.6 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.53159 | acc=0.8113 | tpr=0.9856 | fpr=0.1919 | 7124.6 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.53455 | acc=0.8109 | tpr=0.9847 | fpr=0.1923 | 7326.9 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.52959 | acc=0.8115 | tpr=0.9834 | fpr=0.1916 | 7364.8 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.52803 | acc=0.8123 | tpr=0.9847 | fpr=0.1909 | 7201.7 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.52843 | acc=0.8121 | tpr=0.9831 | fpr=0.1911 | 7181.4 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.52769 | acc=0.8122 | tpr=0.9847 | fpr=0.1910 | 7249.9 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.53147 | acc=0.8112 | tpr=0.9854 | fpr=0.1919 | 7084.2 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.53145 | acc=0.8111 | tpr=0.9855 | fpr=0.1920 | 7350.9 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.52942 | acc=0.8115 | tpr=0.9861 | fpr=0.1917 | 13249.7 samples/s | 51.8 steps/s
Avg test loss: 0.52910, Avg test acc: 0.81156, Avg tpr: 0.98613, Avg fpr: 0.19161, total FA: 26605

server round 34/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=26.5] | Loss=0.19625 | Reg=0.00339 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.406 | L2-Norm(final)=2.891 | 3748.8 samples/s | 58.6 steps/s
[Step=13650 Epoch=26.6] | Loss=0.02722 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.381 | L2-Norm(final)=2.889 | 3525.3 samples/s | 55.1 steps/s
[Step=13700 Epoch=26.7] | Loss=0.02013 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.375 | L2-Norm(final)=2.890 | 3733.9 samples/s | 58.3 steps/s
[Step=13750 Epoch=26.8] | Loss=0.01766 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.372 | L2-Norm(final)=2.892 | 3746.9 samples/s | 58.5 steps/s
[Step=13800 Epoch=26.9] | Loss=0.01682 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.369 | L2-Norm(final)=2.894 | 3758.6 samples/s | 58.7 steps/s
[Step=13850 Epoch=27.0] | Loss=0.01565 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.368 | L2-Norm(final)=2.895 | 3723.9 samples/s | 58.2 steps/s
[Step=13900 Epoch=27.1] | Loss=0.01491 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=2.897 | 3762.7 samples/s | 58.8 steps/s
[Step=13950 Epoch=27.2] | Loss=0.01465 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.367 | L2-Norm(final)=2.899 | 3735.9 samples/s | 58.4 steps/s
[Step=14000 Epoch=27.3] | Loss=0.01438 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.366 | L2-Norm(final)=2.900 | 3761.2 samples/s | 58.8 steps/s
[Step=14050 Epoch=27.4] | Loss=0.01404 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.366 | L2-Norm(final)=2.902 | 3755.1 samples/s | 58.7 steps/s
[Step=14100 Epoch=27.5] | Loss=0.01379 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.366 | L2-Norm(final)=2.903 | 4370.9 samples/s | 68.3 steps/s
[Step=14150 Epoch=27.6] | Loss=0.01325 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.366 | L2-Norm(final)=2.905 | 1636.1 samples/s | 25.6 steps/s
[Step=14200 Epoch=27.7] | Loss=0.01291 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.366 | L2-Norm(final)=2.907 | 3704.7 samples/s | 57.9 steps/s
[Step=14250 Epoch=27.8] | Loss=0.01259 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.366 | L2-Norm(final)=2.908 | 3718.5 samples/s | 58.1 steps/s
[Step=14300 Epoch=27.9] | Loss=0.01226 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.366 | L2-Norm(final)=2.910 | 3749.9 samples/s | 58.6 steps/s
[Step=14350 Epoch=28.0] | Loss=0.01217 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.366 | L2-Norm(final)=2.911 | 3740.2 samples/s | 58.4 steps/s
[Step=14400 Epoch=28.1] | Loss=0.01193 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.366 | L2-Norm(final)=2.913 | 3749.9 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step14400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=58.5] | Loss=0.12974 | Reg=0.00339 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.406 | L2-Norm(final)=2.891 | 3819.6 samples/s | 59.7 steps/s
[Step=15250 Epoch=58.7] | Loss=0.01185 | Reg=0.00338 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.375 | L2-Norm(final)=2.888 | 3286.4 samples/s | 51.4 steps/s
[Step=15300 Epoch=58.9] | Loss=0.00613 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.368 | L2-Norm(final)=2.888 | 3519.9 samples/s | 55.0 steps/s
[Step=15350 Epoch=59.1] | Loss=0.00414 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.362 | L2-Norm(final)=2.889 | 3533.4 samples/s | 55.2 steps/s
[Step=15400 Epoch=59.3] | Loss=0.00314 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.358 | L2-Norm(final)=2.889 | 3522.7 samples/s | 55.0 steps/s
[Step=15450 Epoch=59.5] | Loss=0.00253 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.354 | L2-Norm(final)=2.890 | 4292.3 samples/s | 67.1 steps/s
[Step=15500 Epoch=59.7] | Loss=0.00212 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.351 | L2-Norm(final)=2.890 | 1614.7 samples/s | 25.2 steps/s
[Step=15550 Epoch=59.9] | Loss=0.00183 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.348 | L2-Norm(final)=2.891 | 3529.8 samples/s | 55.2 steps/s
[Step=15600 Epoch=60.1] | Loss=0.00160 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.345 | L2-Norm(final)=2.891 | 3547.4 samples/s | 55.4 steps/s
[Step=15650 Epoch=60.2] | Loss=0.00143 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.343 | L2-Norm(final)=2.892 | 3550.4 samples/s | 55.5 steps/s
[Step=15700 Epoch=60.4] | Loss=0.00129 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.341 | L2-Norm(final)=2.892 | 3888.8 samples/s | 60.8 steps/s
[Step=15750 Epoch=60.6] | Loss=0.00118 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.339 | L2-Norm(final)=2.892 | 1667.0 samples/s | 26.0 steps/s
[Step=15800 Epoch=60.8] | Loss=0.00108 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.337 | L2-Norm(final)=2.893 | 3492.5 samples/s | 54.6 steps/s
[Step=15850 Epoch=61.0] | Loss=0.00100 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.335 | L2-Norm(final)=2.893 | 3520.3 samples/s | 55.0 steps/s
[Step=15900 Epoch=61.2] | Loss=0.00094 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.333 | L2-Norm(final)=2.893 | 3520.6 samples/s | 55.0 steps/s
[Step=15950 Epoch=61.4] | Loss=0.00088 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.332 | L2-Norm(final)=2.893 | 3588.7 samples/s | 56.1 steps/s
[Step=16000 Epoch=61.6] | Loss=0.00082 | Reg=0.00336 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.330 | L2-Norm(final)=2.894 | 1717.4 samples/s | 26.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20835 | acc=0.8661 | tpr=0.8110 | fpr=0.0144 | 3866.1 samples/s | 15.1 steps/s
Avg test loss: 0.21216, Avg test acc: 0.86585, Avg tpr: 0.81209, Avg fpr: 0.01590, total FA: 124

Testing server on iccad2012
[Step=  50] | Loss=0.50838 | acc=0.8125 | tpr=0.9823 | fpr=0.1906 | 3869.9 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.52278 | acc=0.8109 | tpr=0.9829 | fpr=0.1923 | 7234.5 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.53183 | acc=0.8082 | tpr=0.9841 | fpr=0.1950 | 7140.0 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.53484 | acc=0.8080 | tpr=0.9836 | fpr=0.1952 | 7297.3 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.52993 | acc=0.8087 | tpr=0.9834 | fpr=0.1945 | 7173.2 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.52824 | acc=0.8095 | tpr=0.9847 | fpr=0.1937 | 7178.0 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.52859 | acc=0.8095 | tpr=0.9843 | fpr=0.1937 | 7222.4 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.52775 | acc=0.8097 | tpr=0.9858 | fpr=0.1935 | 7735.3 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.53151 | acc=0.8089 | tpr=0.9864 | fpr=0.1944 | 7068.5 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.53136 | acc=0.8089 | tpr=0.9863 | fpr=0.1943 | 6997.3 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.52931 | acc=0.8091 | tpr=0.9869 | fpr=0.1941 | 12699.3 samples/s | 49.6 steps/s
Avg test loss: 0.52906, Avg test acc: 0.80919, Avg tpr: 0.98693, Avg fpr: 0.19404, total FA: 26942

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=28.1] | Loss=0.08801 | Reg=0.00338 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.387 | L2-Norm(final)=2.898 | 3574.7 samples/s | 55.9 steps/s
[Step=14450 Epoch=28.2] | Loss=0.02436 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.362 | L2-Norm(final)=2.897 | 3601.0 samples/s | 56.3 steps/s
[Step=14500 Epoch=28.3] | Loss=0.01733 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.355 | L2-Norm(final)=2.899 | 3745.0 samples/s | 58.5 steps/s
[Step=14550 Epoch=28.4] | Loss=0.01592 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.352 | L2-Norm(final)=2.901 | 3743.0 samples/s | 58.5 steps/s
[Step=14600 Epoch=28.5] | Loss=0.01511 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.350 | L2-Norm(final)=2.903 | 3741.7 samples/s | 58.5 steps/s
[Step=14650 Epoch=28.6] | Loss=0.01442 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.349 | L2-Norm(final)=2.905 | 3751.9 samples/s | 58.6 steps/s
[Step=14700 Epoch=28.7] | Loss=0.01412 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.349 | L2-Norm(final)=2.907 | 3731.3 samples/s | 58.3 steps/s
[Step=14750 Epoch=28.8] | Loss=0.01384 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.348 | L2-Norm(final)=2.909 | 3733.8 samples/s | 58.3 steps/s
[Step=14800 Epoch=28.9] | Loss=0.01354 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.348 | L2-Norm(final)=2.910 | 3739.2 samples/s | 58.4 steps/s
[Step=14850 Epoch=29.0] | Loss=0.01336 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.347 | L2-Norm(final)=2.912 | 3760.6 samples/s | 58.8 steps/s
[Step=14900 Epoch=29.1] | Loss=0.01327 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.347 | L2-Norm(final)=2.913 | 4370.3 samples/s | 68.3 steps/s
[Step=14950 Epoch=29.2] | Loss=0.01280 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.347 | L2-Norm(final)=2.915 | 1633.6 samples/s | 25.5 steps/s
[Step=15000 Epoch=29.3] | Loss=0.01235 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.347 | L2-Norm(final)=2.917 | 3724.1 samples/s | 58.2 steps/s
[Step=15050 Epoch=29.4] | Loss=0.01217 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.347 | L2-Norm(final)=2.918 | 3723.4 samples/s | 58.2 steps/s
[Step=15100 Epoch=29.5] | Loss=0.01215 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.347 | L2-Norm(final)=2.920 | 3726.3 samples/s | 58.2 steps/s
[Step=15150 Epoch=29.5] | Loss=0.01194 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.347 | L2-Norm(final)=2.921 | 3737.6 samples/s | 58.4 steps/s
[Step=15200 Epoch=29.6] | Loss=0.01164 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.347 | L2-Norm(final)=2.923 | 3735.5 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step15200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12001 Epoch=23.5] | Loss=0.14534 | Reg=0.00338 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.387 | L2-Norm(final)=2.898 | 3612.4 samples/s | 56.4 steps/s
[Step=12050 Epoch=23.6] | Loss=0.02546 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.363 | L2-Norm(final)=2.896 | 3717.5 samples/s | 58.1 steps/s
[Step=12100 Epoch=23.7] | Loss=0.01921 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.356 | L2-Norm(final)=2.898 | 3721.7 samples/s | 58.2 steps/s
[Step=12150 Epoch=23.8] | Loss=0.01628 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.352 | L2-Norm(final)=2.900 | 3735.0 samples/s | 58.4 steps/s
[Step=12200 Epoch=23.9] | Loss=0.01540 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.350 | L2-Norm(final)=2.901 | 3739.1 samples/s | 58.4 steps/s
[Step=12250 Epoch=23.9] | Loss=0.01436 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.349 | L2-Norm(final)=2.903 | 3744.2 samples/s | 58.5 steps/s
[Step=12300 Epoch=24.0] | Loss=0.01365 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.348 | L2-Norm(final)=2.905 | 3737.3 samples/s | 58.4 steps/s
[Step=12350 Epoch=24.1] | Loss=0.01337 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.347 | L2-Norm(final)=2.907 | 3759.4 samples/s | 58.7 steps/s
[Step=12400 Epoch=24.2] | Loss=0.01304 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.347 | L2-Norm(final)=2.909 | 3762.3 samples/s | 58.8 steps/s
[Step=12450 Epoch=24.3] | Loss=0.01242 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.347 | L2-Norm(final)=2.910 | 3736.7 samples/s | 58.4 steps/s
[Step=12500 Epoch=24.4] | Loss=0.01203 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.347 | L2-Norm(final)=2.912 | 4410.6 samples/s | 68.9 steps/s
[Step=12550 Epoch=24.5] | Loss=0.01141 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.347 | L2-Norm(final)=2.914 | 1675.9 samples/s | 26.2 steps/s
[Step=12600 Epoch=24.6] | Loss=0.01125 | Reg=0.00337 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.347 | L2-Norm(final)=2.916 | 3723.1 samples/s | 58.2 steps/s
[Step=12650 Epoch=24.7] | Loss=0.01096 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.347 | L2-Norm(final)=2.917 | 3732.8 samples/s | 58.3 steps/s
[Step=12700 Epoch=24.8] | Loss=0.01066 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.347 | L2-Norm(final)=2.919 | 3727.8 samples/s | 58.2 steps/s
[Step=12750 Epoch=24.9] | Loss=0.01051 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.347 | L2-Norm(final)=2.921 | 3737.7 samples/s | 58.4 steps/s
[Step=12800 Epoch=25.0] | Loss=0.01041 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.347 | L2-Norm(final)=2.922 | 3729.1 samples/s | 58.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23219 | acc=0.8572 | tpr=0.7974 | fpr=0.0129 | 3829.4 samples/s | 15.0 steps/s
Avg test loss: 0.23561, Avg test acc: 0.85612, Avg tpr: 0.79746, Avg fpr: 0.01487, total FA: 116

Testing server on iccad2012
[Step=  50] | Loss=0.48110 | acc=0.8322 | tpr=0.9823 | fpr=0.1705 | 3837.8 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.49541 | acc=0.8298 | tpr=0.9851 | fpr=0.1731 | 7126.3 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.50507 | acc=0.8272 | tpr=0.9856 | fpr=0.1757 | 7361.4 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.50839 | acc=0.8266 | tpr=0.9847 | fpr=0.1763 | 7201.8 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.50346 | acc=0.8270 | tpr=0.9834 | fpr=0.1758 | 7506.3 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.50227 | acc=0.8276 | tpr=0.9847 | fpr=0.1753 | 7044.6 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.50271 | acc=0.8276 | tpr=0.9843 | fpr=0.1752 | 7150.0 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.50211 | acc=0.8279 | tpr=0.9858 | fpr=0.1750 | 7494.4 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.50593 | acc=0.8272 | tpr=0.9859 | fpr=0.1757 | 7147.1 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.50572 | acc=0.8272 | tpr=0.9859 | fpr=0.1757 | 6997.7 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.50365 | acc=0.8273 | tpr=0.9861 | fpr=0.1755 | 13450.1 samples/s | 52.5 steps/s
Avg test loss: 0.50339, Avg test acc: 0.82737, Avg tpr: 0.98613, Avg fpr: 0.17552, total FA: 24370

server round 36/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=29.6] | Loss=0.06293 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.329 | L2-Norm(final)=2.918 | 3345.9 samples/s | 52.3 steps/s
[Step=15250 Epoch=29.7] | Loss=0.02859 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.305 | L2-Norm(final)=2.916 | 3713.2 samples/s | 58.0 steps/s
[Step=15300 Epoch=29.8] | Loss=0.02080 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.298 | L2-Norm(final)=2.918 | 3722.5 samples/s | 58.2 steps/s
[Step=15350 Epoch=29.9] | Loss=0.01712 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.296 | L2-Norm(final)=2.920 | 3721.7 samples/s | 58.2 steps/s
[Step=15400 Epoch=30.0] | Loss=0.01545 | Reg=0.00335 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.294 | L2-Norm(final)=2.922 | 3722.7 samples/s | 58.2 steps/s
[Step=15450 Epoch=30.1] | Loss=0.01470 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.293 | L2-Norm(final)=2.924 | 3738.5 samples/s | 58.4 steps/s
[Step=15500 Epoch=30.2] | Loss=0.01407 | Reg=0.00335 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.292 | L2-Norm(final)=2.926 | 3739.1 samples/s | 58.4 steps/s
[Step=15550 Epoch=30.3] | Loss=0.01402 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.291 | L2-Norm(final)=2.928 | 3743.3 samples/s | 58.5 steps/s
[Step=15600 Epoch=30.4] | Loss=0.01361 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.290 | L2-Norm(final)=2.929 | 3722.4 samples/s | 58.2 steps/s
[Step=15650 Epoch=30.5] | Loss=0.01323 | Reg=0.00335 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.290 | L2-Norm(final)=2.931 | 3733.7 samples/s | 58.3 steps/s
[Step=15700 Epoch=30.6] | Loss=0.01301 | Reg=0.00335 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.289 | L2-Norm(final)=2.932 | 4347.4 samples/s | 67.9 steps/s
[Step=15750 Epoch=30.7] | Loss=0.01266 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.289 | L2-Norm(final)=2.934 | 1628.5 samples/s | 25.4 steps/s
[Step=15800 Epoch=30.8] | Loss=0.01229 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.289 | L2-Norm(final)=2.935 | 3709.6 samples/s | 58.0 steps/s
[Step=15850 Epoch=30.9] | Loss=0.01202 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.289 | L2-Norm(final)=2.937 | 3751.5 samples/s | 58.6 steps/s
[Step=15900 Epoch=31.0] | Loss=0.01180 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.289 | L2-Norm(final)=2.938 | 3748.2 samples/s | 58.6 steps/s
[Step=15950 Epoch=31.1] | Loss=0.01170 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.289 | L2-Norm(final)=2.940 | 3764.0 samples/s | 58.8 steps/s
[Step=16000 Epoch=31.2] | Loss=0.01154 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.289 | L2-Norm(final)=2.941 | 3751.4 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step16000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=52.1] | Loss=0.13098 | Reg=0.00336 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.329 | L2-Norm(final)=2.918 | 3861.9 samples/s | 60.3 steps/s
[Step=13650 Epoch=52.3] | Loss=0.01187 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.294 | L2-Norm(final)=2.915 | 3248.4 samples/s | 50.8 steps/s
[Step=13700 Epoch=52.5] | Loss=0.00618 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.285 | L2-Norm(final)=2.915 | 3532.4 samples/s | 55.2 steps/s
[Step=13750 Epoch=52.7] | Loss=0.00417 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.280 | L2-Norm(final)=2.915 | 3561.3 samples/s | 55.6 steps/s
[Step=13800 Epoch=52.9] | Loss=0.00316 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.276 | L2-Norm(final)=2.916 | 3520.6 samples/s | 55.0 steps/s
[Step=13850 Epoch=53.1] | Loss=0.00254 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.272 | L2-Norm(final)=2.916 | 4234.8 samples/s | 66.2 steps/s
[Step=13900 Epoch=53.3] | Loss=0.00212 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.269 | L2-Norm(final)=2.917 | 1620.0 samples/s | 25.3 steps/s
[Step=13950 Epoch=53.5] | Loss=0.00183 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.266 | L2-Norm(final)=2.917 | 3524.3 samples/s | 55.1 steps/s
[Step=14000 Epoch=53.6] | Loss=0.00160 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.263 | L2-Norm(final)=2.917 | 3524.5 samples/s | 55.1 steps/s
[Step=14050 Epoch=53.8] | Loss=0.00143 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.261 | L2-Norm(final)=2.917 | 3545.5 samples/s | 55.4 steps/s
[Step=14100 Epoch=54.0] | Loss=0.00129 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.259 | L2-Norm(final)=2.918 | 3841.5 samples/s | 60.0 steps/s
[Step=14150 Epoch=54.2] | Loss=0.00118 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.257 | L2-Norm(final)=2.918 | 1695.0 samples/s | 26.5 steps/s
[Step=14200 Epoch=54.4] | Loss=0.00108 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.255 | L2-Norm(final)=2.918 | 3540.7 samples/s | 55.3 steps/s
[Step=14250 Epoch=54.6] | Loss=0.00100 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.253 | L2-Norm(final)=2.918 | 3549.7 samples/s | 55.5 steps/s
[Step=14300 Epoch=54.8] | Loss=0.00093 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.252 | L2-Norm(final)=2.919 | 3532.5 samples/s | 55.2 steps/s
[Step=14350 Epoch=55.0] | Loss=0.00087 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.250 | L2-Norm(final)=2.919 | 3532.3 samples/s | 55.2 steps/s
[Step=14400 Epoch=55.2] | Loss=0.00082 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.249 | L2-Norm(final)=2.919 | 1742.5 samples/s | 27.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24242 | acc=0.8528 | tpr=0.7899 | fpr=0.0107 | 3769.3 samples/s | 14.7 steps/s
Avg test loss: 0.24653, Avg test acc: 0.85091, Avg tpr: 0.78901, Avg fpr: 0.01295, total FA: 101

Testing server on iccad2012
[Step=  50] | Loss=0.46622 | acc=0.8384 | tpr=0.9823 | fpr=0.1642 | 3810.2 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.47927 | acc=0.8359 | tpr=0.9851 | fpr=0.1669 | 7340.3 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.48845 | acc=0.8339 | tpr=0.9856 | fpr=0.1689 | 7254.6 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.49200 | acc=0.8334 | tpr=0.9858 | fpr=0.1694 | 7226.3 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.48699 | acc=0.8340 | tpr=0.9834 | fpr=0.1688 | 7275.4 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.48592 | acc=0.8347 | tpr=0.9847 | fpr=0.1680 | 7258.8 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.48623 | acc=0.8352 | tpr=0.9843 | fpr=0.1676 | 7283.5 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.48564 | acc=0.8355 | tpr=0.9858 | fpr=0.1673 | 7443.9 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.48928 | acc=0.8348 | tpr=0.9864 | fpr=0.1680 | 7113.2 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.48921 | acc=0.8347 | tpr=0.9863 | fpr=0.1681 | 7129.1 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.48719 | acc=0.8349 | tpr=0.9865 | fpr=0.1679 | 13245.6 samples/s | 51.7 steps/s
Avg test loss: 0.48694, Avg test acc: 0.83493, Avg tpr: 0.98653, Avg fpr: 0.16782, total FA: 23302

server round 37/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=31.2] | Loss=0.14691 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.287 | L2-Norm(final)=2.931 | 3440.3 samples/s | 53.8 steps/s
[Step=16050 Epoch=31.3] | Loss=0.02881 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.262 | L2-Norm(final)=2.929 | 3571.6 samples/s | 55.8 steps/s
[Step=16100 Epoch=31.4] | Loss=0.02013 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.256 | L2-Norm(final)=2.930 | 3730.8 samples/s | 58.3 steps/s
[Step=16150 Epoch=31.5] | Loss=0.01753 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.253 | L2-Norm(final)=2.932 | 3729.3 samples/s | 58.3 steps/s
[Step=16200 Epoch=31.6] | Loss=0.01633 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.251 | L2-Norm(final)=2.934 | 3734.8 samples/s | 58.4 steps/s
[Step=16250 Epoch=31.7] | Loss=0.01565 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.250 | L2-Norm(final)=2.935 | 3736.7 samples/s | 58.4 steps/s
[Step=16300 Epoch=31.8] | Loss=0.01498 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.249 | L2-Norm(final)=2.937 | 3734.9 samples/s | 58.4 steps/s
[Step=16350 Epoch=31.9] | Loss=0.01398 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.248 | L2-Norm(final)=2.938 | 3744.5 samples/s | 58.5 steps/s
[Step=16400 Epoch=32.0] | Loss=0.01334 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.248 | L2-Norm(final)=2.940 | 3728.9 samples/s | 58.3 steps/s
[Step=16450 Epoch=32.1] | Loss=0.01323 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.247 | L2-Norm(final)=2.942 | 3714.1 samples/s | 58.0 steps/s
[Step=16500 Epoch=32.2] | Loss=0.01305 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.247 | L2-Norm(final)=2.943 | 4359.0 samples/s | 68.1 steps/s
[Step=16550 Epoch=32.3] | Loss=0.01259 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.247 | L2-Norm(final)=2.944 | 1605.8 samples/s | 25.1 steps/s
[Step=16600 Epoch=32.4] | Loss=0.01217 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.247 | L2-Norm(final)=2.946 | 3749.0 samples/s | 58.6 steps/s
[Step=16650 Epoch=32.5] | Loss=0.01178 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.247 | L2-Norm(final)=2.947 | 3753.8 samples/s | 58.7 steps/s
[Step=16700 Epoch=32.6] | Loss=0.01156 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.247 | L2-Norm(final)=2.949 | 3733.9 samples/s | 58.3 steps/s
[Step=16750 Epoch=32.7] | Loss=0.01146 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.247 | L2-Norm(final)=2.950 | 3738.1 samples/s | 58.4 steps/s
[Step=16800 Epoch=32.8] | Loss=0.01131 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.247 | L2-Norm(final)=2.952 | 3762.0 samples/s | 58.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step16800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=14401 Epoch=55.2] | Loss=0.05604 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.287 | L2-Norm(final)=2.932 | 3700.2 samples/s | 57.8 steps/s
[Step=14450 Epoch=55.4] | Loss=0.01069 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.254 | L2-Norm(final)=2.930 | 3368.4 samples/s | 52.6 steps/s
[Step=14500 Epoch=55.6] | Loss=0.00546 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.247 | L2-Norm(final)=2.929 | 3560.7 samples/s | 55.6 steps/s
[Step=14550 Epoch=55.8] | Loss=0.00367 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.241 | L2-Norm(final)=2.930 | 3533.2 samples/s | 55.2 steps/s
[Step=14600 Epoch=55.9] | Loss=0.00279 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.237 | L2-Norm(final)=2.930 | 3548.3 samples/s | 55.4 steps/s
[Step=14650 Epoch=56.1] | Loss=0.00226 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.233 | L2-Norm(final)=2.930 | 4257.8 samples/s | 66.5 steps/s
[Step=14700 Epoch=56.3] | Loss=0.00191 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.230 | L2-Norm(final)=2.931 | 1621.4 samples/s | 25.3 steps/s
[Step=14750 Epoch=56.5] | Loss=0.00165 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.228 | L2-Norm(final)=2.931 | 3540.2 samples/s | 55.3 steps/s
[Step=14800 Epoch=56.7] | Loss=0.00144 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.225 | L2-Norm(final)=2.931 | 3550.3 samples/s | 55.5 steps/s
[Step=14850 Epoch=56.9] | Loss=0.00129 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.223 | L2-Norm(final)=2.932 | 3511.3 samples/s | 54.9 steps/s
[Step=14900 Epoch=57.1] | Loss=0.00116 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.221 | L2-Norm(final)=2.932 | 3819.8 samples/s | 59.7 steps/s
[Step=14950 Epoch=57.3] | Loss=0.00106 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.219 | L2-Norm(final)=2.932 | 1679.7 samples/s | 26.2 steps/s
[Step=15000 Epoch=57.5] | Loss=0.00097 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.217 | L2-Norm(final)=2.933 | 3537.0 samples/s | 55.3 steps/s
[Step=15050 Epoch=57.7] | Loss=0.00090 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.215 | L2-Norm(final)=2.933 | 3545.3 samples/s | 55.4 steps/s
[Step=15100 Epoch=57.9] | Loss=0.00084 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=2.933 | 3531.9 samples/s | 55.2 steps/s
[Step=15150 Epoch=58.0] | Loss=0.00079 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.933 | 3518.2 samples/s | 55.0 steps/s
[Step=15200 Epoch=58.2] | Loss=0.00074 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.210 | L2-Norm(final)=2.933 | 1741.5 samples/s | 27.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21814 | acc=0.8647 | tpr=0.8088 | fpr=0.0139 | 3813.9 samples/s | 14.9 steps/s
Avg test loss: 0.22180, Avg test acc: 0.86461, Avg tpr: 0.80987, Avg fpr: 0.01500, total FA: 117

Testing server on iccad2012
[Step=  50] | Loss=0.50756 | acc=0.8233 | tpr=0.9823 | fpr=0.1796 | 3837.9 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.52213 | acc=0.8205 | tpr=0.9851 | fpr=0.1826 | 7306.1 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.53177 | acc=0.8187 | tpr=0.9856 | fpr=0.1843 | 7297.5 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.53487 | acc=0.8190 | tpr=0.9858 | fpr=0.1841 | 7098.4 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.52981 | acc=0.8196 | tpr=0.9843 | fpr=0.1834 | 7911.3 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.52852 | acc=0.8204 | tpr=0.9855 | fpr=0.1826 | 6940.0 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.52878 | acc=0.8206 | tpr=0.9850 | fpr=0.1824 | 7166.5 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.52806 | acc=0.8209 | tpr=0.9863 | fpr=0.1821 | 7245.9 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.53200 | acc=0.8203 | tpr=0.9869 | fpr=0.1827 | 7112.4 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.53174 | acc=0.8202 | tpr=0.9868 | fpr=0.1828 | 7180.6 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.52963 | acc=0.8204 | tpr=0.9873 | fpr=0.1826 | 13332.8 samples/s | 52.1 steps/s
Avg test loss: 0.52938, Avg test acc: 0.82049, Avg tpr: 0.98732, Avg fpr: 0.18254, total FA: 25346

server round 38/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=12801 Epoch=25.0] | Loss=0.09737 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.267 | L2-Norm(final)=2.938 | 3626.2 samples/s | 56.7 steps/s
[Step=12850 Epoch=25.1] | Loss=0.02174 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.244 | L2-Norm(final)=2.939 | 3426.9 samples/s | 53.5 steps/s
[Step=12900 Epoch=25.2] | Loss=0.01696 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.238 | L2-Norm(final)=2.941 | 3722.8 samples/s | 58.2 steps/s
[Step=12950 Epoch=25.3] | Loss=0.01461 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.234 | L2-Norm(final)=2.943 | 3169.8 samples/s | 49.5 steps/s
[Step=13000 Epoch=25.4] | Loss=0.01365 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.232 | L2-Norm(final)=2.945 | 3462.5 samples/s | 54.1 steps/s
[Step=13050 Epoch=25.5] | Loss=0.01277 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.231 | L2-Norm(final)=2.947 | 3708.9 samples/s | 58.0 steps/s
[Step=13100 Epoch=25.6] | Loss=0.01221 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.230 | L2-Norm(final)=2.949 | 3180.4 samples/s | 49.7 steps/s
[Step=13150 Epoch=25.7] | Loss=0.01191 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.229 | L2-Norm(final)=2.950 | 3105.6 samples/s | 48.5 steps/s
[Step=13200 Epoch=25.8] | Loss=0.01177 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.229 | L2-Norm(final)=2.952 | 3079.2 samples/s | 48.1 steps/s
[Step=13250 Epoch=25.9] | Loss=0.01146 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.228 | L2-Norm(final)=2.954 | 3072.7 samples/s | 48.0 steps/s
[Step=13300 Epoch=26.0] | Loss=0.01116 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.228 | L2-Norm(final)=2.955 | 3943.7 samples/s | 61.6 steps/s
[Step=13350 Epoch=26.1] | Loss=0.01091 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.228 | L2-Norm(final)=2.957 | 1655.4 samples/s | 25.9 steps/s
[Step=13400 Epoch=26.2] | Loss=0.01057 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.228 | L2-Norm(final)=2.958 | 3722.6 samples/s | 58.2 steps/s
[Step=13450 Epoch=26.3] | Loss=0.01051 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.228 | L2-Norm(final)=2.960 | 3736.5 samples/s | 58.4 steps/s
[Step=13500 Epoch=26.4] | Loss=0.01031 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.228 | L2-Norm(final)=2.961 | 3732.0 samples/s | 58.3 steps/s
[Step=13550 Epoch=26.5] | Loss=0.01017 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.228 | L2-Norm(final)=2.962 | 3729.9 samples/s | 58.3 steps/s
[Step=13600 Epoch=26.6] | Loss=0.00999 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.228 | L2-Norm(final)=2.964 | 3742.1 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step13600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=16001 Epoch=61.6] | Loss=0.06014 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.267 | L2-Norm(final)=2.938 | 3611.9 samples/s | 56.4 steps/s
[Step=16050 Epoch=61.8] | Loss=0.00886 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.233 | L2-Norm(final)=2.938 | 3474.9 samples/s | 54.3 steps/s
[Step=16100 Epoch=62.0] | Loss=0.00455 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.225 | L2-Norm(final)=2.938 | 3539.9 samples/s | 55.3 steps/s
[Step=16150 Epoch=62.2] | Loss=0.00308 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.220 | L2-Norm(final)=2.939 | 3538.6 samples/s | 55.3 steps/s
[Step=16200 Epoch=62.4] | Loss=0.00234 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.215 | L2-Norm(final)=2.939 | 3534.1 samples/s | 55.2 steps/s
[Step=16250 Epoch=62.6] | Loss=0.00189 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.211 | L2-Norm(final)=2.940 | 4296.0 samples/s | 67.1 steps/s
[Step=16300 Epoch=62.7] | Loss=0.00159 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.208 | L2-Norm(final)=2.940 | 1608.7 samples/s | 25.1 steps/s
[Step=16350 Epoch=62.9] | Loss=0.00137 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.205 | L2-Norm(final)=2.941 | 3541.2 samples/s | 55.3 steps/s
[Step=16400 Epoch=63.1] | Loss=0.00120 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.202 | L2-Norm(final)=2.941 | 3535.5 samples/s | 55.2 steps/s
[Step=16450 Epoch=63.3] | Loss=0.00107 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.200 | L2-Norm(final)=2.941 | 3527.5 samples/s | 55.1 steps/s
[Step=16500 Epoch=63.5] | Loss=0.00097 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.198 | L2-Norm(final)=2.942 | 3912.2 samples/s | 61.1 steps/s
[Step=16550 Epoch=63.7] | Loss=0.00088 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.196 | L2-Norm(final)=2.942 | 1670.1 samples/s | 26.1 steps/s
[Step=16600 Epoch=63.9] | Loss=0.00081 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.194 | L2-Norm(final)=2.942 | 3522.5 samples/s | 55.0 steps/s
[Step=16650 Epoch=64.1] | Loss=0.00075 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.192 | L2-Norm(final)=2.942 | 3517.3 samples/s | 55.0 steps/s
[Step=16700 Epoch=64.3] | Loss=0.00070 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.190 | L2-Norm(final)=2.943 | 3517.4 samples/s | 55.0 steps/s
[Step=16750 Epoch=64.5] | Loss=0.00066 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.189 | L2-Norm(final)=2.943 | 3584.2 samples/s | 56.0 steps/s
[Step=16800 Epoch=64.7] | Loss=0.00062 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.187 | L2-Norm(final)=2.943 | 1708.8 samples/s | 26.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25857 | acc=0.8455 | tpr=0.7796 | fpr=0.0111 | 3786.9 samples/s | 14.8 steps/s
Avg test loss: 0.26330, Avg test acc: 0.84430, Avg tpr: 0.77916, Avg fpr: 0.01243, total FA: 97

Testing server on iccad2012
[Step=  50] | Loss=0.46000 | acc=0.8447 | tpr=0.9823 | fpr=0.1578 | 3801.9 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.47284 | acc=0.8428 | tpr=0.9829 | fpr=0.1598 | 7420.5 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.48197 | acc=0.8410 | tpr=0.9827 | fpr=0.1616 | 7348.1 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.48561 | acc=0.8407 | tpr=0.9836 | fpr=0.1619 | 7259.9 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.48072 | acc=0.8413 | tpr=0.9825 | fpr=0.1613 | 7114.0 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.47962 | acc=0.8422 | tpr=0.9833 | fpr=0.1604 | 7313.7 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.47974 | acc=0.8425 | tpr=0.9825 | fpr=0.1601 | 7135.1 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.47918 | acc=0.8427 | tpr=0.9841 | fpr=0.1598 | 7318.2 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.48305 | acc=0.8421 | tpr=0.9849 | fpr=0.1605 | 7189.5 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.48271 | acc=0.8421 | tpr=0.9850 | fpr=0.1605 | 7002.3 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.48053 | acc=0.8423 | tpr=0.9853 | fpr=0.1603 | 13265.4 samples/s | 51.8 steps/s
Avg test loss: 0.48030, Avg test acc: 0.84237, Avg tpr: 0.98534, Avg fpr: 0.16023, total FA: 22248

server round 39/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=13601 Epoch=26.6] | Loss=0.05034 | Reg=0.00331 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.201 | L2-Norm(final)=2.960 | 3637.9 samples/s | 56.8 steps/s
[Step=13650 Epoch=26.7] | Loss=0.02818 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=2.957 | 3665.8 samples/s | 57.3 steps/s
[Step=13700 Epoch=26.8] | Loss=0.01856 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.171 | L2-Norm(final)=2.957 | 3722.3 samples/s | 58.2 steps/s
[Step=13750 Epoch=26.9] | Loss=0.01615 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.167 | L2-Norm(final)=2.959 | 3731.0 samples/s | 58.3 steps/s
[Step=13800 Epoch=27.0] | Loss=0.01492 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.166 | L2-Norm(final)=2.961 | 3754.2 samples/s | 58.7 steps/s
[Step=13850 Epoch=27.1] | Loss=0.01388 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.164 | L2-Norm(final)=2.963 | 3748.2 samples/s | 58.6 steps/s
[Step=13900 Epoch=27.2] | Loss=0.01274 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.163 | L2-Norm(final)=2.965 | 3740.3 samples/s | 58.4 steps/s
[Step=13950 Epoch=27.3] | Loss=0.01234 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.163 | L2-Norm(final)=2.966 | 3738.5 samples/s | 58.4 steps/s
[Step=14000 Epoch=27.4] | Loss=0.01201 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.162 | L2-Norm(final)=2.968 | 3751.6 samples/s | 58.6 steps/s
[Step=14050 Epoch=27.5] | Loss=0.01174 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.162 | L2-Norm(final)=2.970 | 3754.6 samples/s | 58.7 steps/s
[Step=14100 Epoch=27.6] | Loss=0.01165 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.162 | L2-Norm(final)=2.971 | 4393.0 samples/s | 68.6 steps/s
[Step=14150 Epoch=27.7] | Loss=0.01131 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.162 | L2-Norm(final)=2.973 | 1668.5 samples/s | 26.1 steps/s
[Step=14200 Epoch=27.8] | Loss=0.01098 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.162 | L2-Norm(final)=2.974 | 3701.0 samples/s | 57.8 steps/s
[Step=14250 Epoch=27.9] | Loss=0.01079 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.162 | L2-Norm(final)=2.976 | 3732.6 samples/s | 58.3 steps/s
[Step=14300 Epoch=28.0] | Loss=0.01065 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.162 | L2-Norm(final)=2.977 | 3706.7 samples/s | 57.9 steps/s
[Step=14350 Epoch=28.1] | Loss=0.01057 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.162 | L2-Norm(final)=2.978 | 3744.7 samples/s | 58.5 steps/s
[Step=14400 Epoch=28.2] | Loss=0.01033 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.162 | L2-Norm(final)=2.980 | 3750.9 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step14400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=15201 Epoch=58.2] | Loss=0.11238 | Reg=0.00331 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.201 | L2-Norm(final)=2.960 | 3577.6 samples/s | 55.9 steps/s
[Step=15250 Epoch=58.4] | Loss=0.00656 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.168 | L2-Norm(final)=2.960 | 3415.7 samples/s | 53.4 steps/s
[Step=15300 Epoch=58.6] | Loss=0.00332 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.160 | L2-Norm(final)=2.960 | 3526.8 samples/s | 55.1 steps/s
[Step=15350 Epoch=58.8] | Loss=0.00223 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.154 | L2-Norm(final)=2.960 | 3563.2 samples/s | 55.7 steps/s
[Step=15400 Epoch=59.0] | Loss=0.00170 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.150 | L2-Norm(final)=2.960 | 3554.1 samples/s | 55.5 steps/s
[Step=15450 Epoch=59.2] | Loss=0.00138 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.146 | L2-Norm(final)=2.960 | 4241.9 samples/s | 66.3 steps/s
[Step=15500 Epoch=59.4] | Loss=0.00115 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.143 | L2-Norm(final)=2.961 | 1610.6 samples/s | 25.2 steps/s
[Step=15550 Epoch=59.6] | Loss=0.00099 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.140 | L2-Norm(final)=2.961 | 3521.6 samples/s | 55.0 steps/s
[Step=15600 Epoch=59.8] | Loss=0.00087 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.137 | L2-Norm(final)=2.961 | 3540.0 samples/s | 55.3 steps/s
[Step=15650 Epoch=60.0] | Loss=0.00078 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.135 | L2-Norm(final)=2.961 | 3532.5 samples/s | 55.2 steps/s
[Step=15700 Epoch=60.2] | Loss=0.00070 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.133 | L2-Norm(final)=2.962 | 3817.3 samples/s | 59.6 steps/s
[Step=15750 Epoch=60.3] | Loss=0.00064 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.131 | L2-Norm(final)=2.962 | 1683.1 samples/s | 26.3 steps/s
[Step=15800 Epoch=60.5] | Loss=0.00059 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.129 | L2-Norm(final)=2.962 | 3561.1 samples/s | 55.6 steps/s
[Step=15850 Epoch=60.7] | Loss=0.00055 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.127 | L2-Norm(final)=2.962 | 3523.7 samples/s | 55.1 steps/s
[Step=15900 Epoch=60.9] | Loss=0.00051 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=2.962 | 3534.1 samples/s | 55.2 steps/s
[Step=15950 Epoch=61.1] | Loss=0.00048 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.124 | L2-Norm(final)=2.963 | 3528.8 samples/s | 55.1 steps/s
[Step=16000 Epoch=61.3] | Loss=0.00045 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.122 | L2-Norm(final)=2.963 | 1737.9 samples/s | 27.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25118 | acc=0.8502 | tpr=0.7863 | fpr=0.0109 | 3800.4 samples/s | 14.8 steps/s
Avg test loss: 0.25583, Avg test acc: 0.84963, Avg tpr: 0.78679, Avg fpr: 0.01218, total FA: 95

Testing server on iccad2012
[Step=  50] | Loss=0.46785 | acc=0.8431 | tpr=0.9823 | fpr=0.1594 | 3801.3 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.48124 | acc=0.8403 | tpr=0.9829 | fpr=0.1624 | 7390.0 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.49053 | acc=0.8382 | tpr=0.9827 | fpr=0.1645 | 7237.7 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.49429 | acc=0.8380 | tpr=0.9825 | fpr=0.1646 | 7213.4 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.48969 | acc=0.8386 | tpr=0.9817 | fpr=0.1640 | 7197.1 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.48849 | acc=0.8395 | tpr=0.9833 | fpr=0.1631 | 7331.5 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.48871 | acc=0.8397 | tpr=0.9831 | fpr=0.1629 | 7049.6 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.48822 | acc=0.8399 | tpr=0.9847 | fpr=0.1628 | 7529.7 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.49219 | acc=0.8392 | tpr=0.9854 | fpr=0.1635 | 7027.2 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.49184 | acc=0.8391 | tpr=0.9855 | fpr=0.1635 | 7119.7 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.48959 | acc=0.8393 | tpr=0.9861 | fpr=0.1634 | 13534.9 samples/s | 52.9 steps/s
Avg test loss: 0.48932, Avg test acc: 0.83935, Avg tpr: 0.98613, Avg fpr: 0.16332, total FA: 22677

server round 40/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=32.8] | Loss=0.18780 | Reg=0.00330 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.163 | L2-Norm(final)=2.971 | 3381.8 samples/s | 52.8 steps/s
[Step=16850 Epoch=32.9] | Loss=0.03107 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.144 | L2-Norm(final)=2.970 | 3692.3 samples/s | 57.7 steps/s
[Step=16900 Epoch=33.0] | Loss=0.02000 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.138 | L2-Norm(final)=2.971 | 3722.2 samples/s | 58.2 steps/s
[Step=16950 Epoch=33.1] | Loss=0.01721 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=2.972 | 3731.9 samples/s | 58.3 steps/s
[Step=17000 Epoch=33.2] | Loss=0.01577 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.132 | L2-Norm(final)=2.973 | 3742.8 samples/s | 58.5 steps/s
[Step=17050 Epoch=33.3] | Loss=0.01439 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.130 | L2-Norm(final)=2.974 | 3733.9 samples/s | 58.3 steps/s
[Step=17100 Epoch=33.4] | Loss=0.01364 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.129 | L2-Norm(final)=2.975 | 3724.7 samples/s | 58.2 steps/s
[Step=17150 Epoch=33.4] | Loss=0.01272 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.128 | L2-Norm(final)=2.976 | 3739.4 samples/s | 58.4 steps/s
[Step=17200 Epoch=33.5] | Loss=0.01248 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.127 | L2-Norm(final)=2.977 | 3736.4 samples/s | 58.4 steps/s
[Step=17250 Epoch=33.6] | Loss=0.01199 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.126 | L2-Norm(final)=2.978 | 3745.5 samples/s | 58.5 steps/s
[Step=17300 Epoch=33.7] | Loss=0.01192 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.126 | L2-Norm(final)=2.979 | 4327.9 samples/s | 67.6 steps/s
[Step=17350 Epoch=33.8] | Loss=0.01167 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.126 | L2-Norm(final)=2.980 | 1633.3 samples/s | 25.5 steps/s
[Step=17400 Epoch=33.9] | Loss=0.01128 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=2.981 | 3702.6 samples/s | 57.9 steps/s
[Step=17450 Epoch=34.0] | Loss=0.01097 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=2.982 | 3728.6 samples/s | 58.3 steps/s
[Step=17500 Epoch=34.1] | Loss=0.01077 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=2.983 | 3721.8 samples/s | 58.2 steps/s
[Step=17550 Epoch=34.2] | Loss=0.01066 | Reg=0.00328 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.124 | L2-Norm(final)=2.984 | 3724.4 samples/s | 58.2 steps/s
[Step=17600 Epoch=34.3] | Loss=0.01031 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.124 | L2-Norm(final)=2.985 | 3744.4 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step17600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=61.3] | Loss=0.07323 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.163 | L2-Norm(final)=2.971 | 3600.3 samples/s | 56.3 steps/s
[Step=16050 Epoch=61.5] | Loss=0.00920 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.129 | L2-Norm(final)=2.972 | 3412.2 samples/s | 53.3 steps/s
[Step=16100 Epoch=61.7] | Loss=0.00468 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.121 | L2-Norm(final)=2.972 | 3489.6 samples/s | 54.5 steps/s
[Step=16150 Epoch=61.9] | Loss=0.00316 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.116 | L2-Norm(final)=2.972 | 3525.7 samples/s | 55.1 steps/s
[Step=16200 Epoch=62.1] | Loss=0.00241 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.112 | L2-Norm(final)=2.973 | 3505.2 samples/s | 54.8 steps/s
[Step=16250 Epoch=62.3] | Loss=0.00194 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.109 | L2-Norm(final)=2.973 | 4233.9 samples/s | 66.2 steps/s
[Step=16300 Epoch=62.5] | Loss=0.00163 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.107 | L2-Norm(final)=2.973 | 1608.4 samples/s | 25.1 steps/s
[Step=16350 Epoch=62.6] | Loss=0.00140 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.104 | L2-Norm(final)=2.973 | 3507.3 samples/s | 54.8 steps/s
[Step=16400 Epoch=62.8] | Loss=0.00123 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.102 | L2-Norm(final)=2.974 | 3528.2 samples/s | 55.1 steps/s
[Step=16450 Epoch=63.0] | Loss=0.00110 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.100 | L2-Norm(final)=2.974 | 3511.6 samples/s | 54.9 steps/s
[Step=16500 Epoch=63.2] | Loss=0.00099 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.099 | L2-Norm(final)=2.974 | 3837.6 samples/s | 60.0 steps/s
[Step=16550 Epoch=63.4] | Loss=0.00091 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.097 | L2-Norm(final)=2.974 | 1669.0 samples/s | 26.1 steps/s
[Step=16600 Epoch=63.6] | Loss=0.00084 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.096 | L2-Norm(final)=2.974 | 3517.9 samples/s | 55.0 steps/s
[Step=16650 Epoch=63.8] | Loss=0.00078 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.094 | L2-Norm(final)=2.974 | 3515.4 samples/s | 54.9 steps/s
[Step=16700 Epoch=64.0] | Loss=0.00072 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.093 | L2-Norm(final)=2.974 | 3500.1 samples/s | 54.7 steps/s
[Step=16750 Epoch=64.2] | Loss=0.00068 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.092 | L2-Norm(final)=2.975 | 3513.5 samples/s | 54.9 steps/s
[Step=16800 Epoch=64.4] | Loss=0.00064 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.090 | L2-Norm(final)=2.975 | 1738.3 samples/s | 27.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25166 | acc=0.8522 | tpr=0.7888 | fpr=0.0102 | 3828.1 samples/s | 15.0 steps/s
Avg test loss: 0.25643, Avg test acc: 0.85115, Avg tpr: 0.78866, Avg fpr: 0.01141, total FA: 89

Testing server on iccad2012
[Step=  50] | Loss=0.46900 | acc=0.8430 | tpr=0.9823 | fpr=0.1595 | 3855.6 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.48208 | acc=0.8420 | tpr=0.9829 | fpr=0.1606 | 7035.6 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.49133 | acc=0.8402 | tpr=0.9827 | fpr=0.1624 | 7407.4 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.49532 | acc=0.8400 | tpr=0.9825 | fpr=0.1626 | 7255.3 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.49068 | acc=0.8406 | tpr=0.9817 | fpr=0.1620 | 7370.9 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.48953 | acc=0.8414 | tpr=0.9833 | fpr=0.1612 | 7358.3 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.48961 | acc=0.8414 | tpr=0.9831 | fpr=0.1612 | 7126.5 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.48911 | acc=0.8416 | tpr=0.9847 | fpr=0.1610 | 7305.8 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.49294 | acc=0.8409 | tpr=0.9854 | fpr=0.1617 | 7003.3 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.49267 | acc=0.8410 | tpr=0.9855 | fpr=0.1616 | 7306.8 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.49042 | acc=0.8412 | tpr=0.9857 | fpr=0.1614 | 12899.2 samples/s | 50.4 steps/s
Avg test loss: 0.49017, Avg test acc: 0.84123, Avg tpr: 0.98574, Avg fpr: 0.16140, total FA: 22410

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=34.3] | Loss=0.18367 | Reg=0.00329 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.125 | L2-Norm(final)=2.981 | 3377.8 samples/s | 52.8 steps/s
[Step=17650 Epoch=34.4] | Loss=0.03490 | Reg=0.00328 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.106 | L2-Norm(final)=2.979 | 3757.7 samples/s | 58.7 steps/s
[Step=17700 Epoch=34.5] | Loss=0.02426 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.100 | L2-Norm(final)=2.979 | 3721.0 samples/s | 58.1 steps/s
[Step=17750 Epoch=34.6] | Loss=0.02004 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.096 | L2-Norm(final)=2.980 | 3738.4 samples/s | 58.4 steps/s
[Step=17800 Epoch=34.7] | Loss=0.01798 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.093 | L2-Norm(final)=2.981 | 3735.6 samples/s | 58.4 steps/s
[Step=17850 Epoch=34.8] | Loss=0.01654 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.092 | L2-Norm(final)=2.981 | 3755.9 samples/s | 58.7 steps/s
[Step=17900 Epoch=34.9] | Loss=0.01537 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.090 | L2-Norm(final)=2.982 | 3715.3 samples/s | 58.1 steps/s
[Step=17950 Epoch=35.0] | Loss=0.01427 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.089 | L2-Norm(final)=2.983 | 3750.2 samples/s | 58.6 steps/s
[Step=18000 Epoch=35.1] | Loss=0.01352 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.089 | L2-Norm(final)=2.984 | 3727.8 samples/s | 58.2 steps/s
[Step=18050 Epoch=35.2] | Loss=0.01310 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.088 | L2-Norm(final)=2.985 | 3762.9 samples/s | 58.8 steps/s
[Step=18100 Epoch=35.3] | Loss=0.01238 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.088 | L2-Norm(final)=2.986 | 4370.6 samples/s | 68.3 steps/s
[Step=18150 Epoch=35.4] | Loss=0.01184 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.087 | L2-Norm(final)=2.988 | 1622.8 samples/s | 25.4 steps/s
[Step=18200 Epoch=35.5] | Loss=0.01158 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.087 | L2-Norm(final)=2.989 | 3706.9 samples/s | 57.9 steps/s
[Step=18250 Epoch=35.6] | Loss=0.01111 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.087 | L2-Norm(final)=2.990 | 3724.9 samples/s | 58.2 steps/s
[Step=18300 Epoch=35.7] | Loss=0.01081 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.086 | L2-Norm(final)=2.991 | 3715.6 samples/s | 58.1 steps/s
[Step=18350 Epoch=35.8] | Loss=0.01067 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.086 | L2-Norm(final)=2.992 | 3752.8 samples/s | 58.6 steps/s
[Step=18400 Epoch=35.9] | Loss=0.01042 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.086 | L2-Norm(final)=2.993 | 3756.3 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step18400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=14401 Epoch=28.2] | Loss=0.11721 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.125 | L2-Norm(final)=2.981 | 3879.3 samples/s | 60.6 steps/s
[Step=14450 Epoch=28.2] | Loss=0.03051 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.107 | L2-Norm(final)=2.979 | 3449.3 samples/s | 53.9 steps/s
[Step=14500 Epoch=28.3] | Loss=0.02026 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.101 | L2-Norm(final)=2.980 | 3750.0 samples/s | 58.6 steps/s
[Step=14550 Epoch=28.4] | Loss=0.01643 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.097 | L2-Norm(final)=2.981 | 3713.5 samples/s | 58.0 steps/s
[Step=14600 Epoch=28.5] | Loss=0.01494 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.095 | L2-Norm(final)=2.982 | 3735.1 samples/s | 58.4 steps/s
[Step=14650 Epoch=28.6] | Loss=0.01341 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.093 | L2-Norm(final)=2.983 | 3747.1 samples/s | 58.5 steps/s
[Step=14700 Epoch=28.7] | Loss=0.01270 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.091 | L2-Norm(final)=2.984 | 3745.0 samples/s | 58.5 steps/s
[Step=14750 Epoch=28.8] | Loss=0.01196 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.090 | L2-Norm(final)=2.985 | 3760.0 samples/s | 58.7 steps/s
[Step=14800 Epoch=28.9] | Loss=0.01141 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.089 | L2-Norm(final)=2.987 | 3751.6 samples/s | 58.6 steps/s
[Step=14850 Epoch=29.0] | Loss=0.01100 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.089 | L2-Norm(final)=2.988 | 3759.6 samples/s | 58.7 steps/s
[Step=14900 Epoch=29.1] | Loss=0.01059 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.088 | L2-Norm(final)=2.989 | 4408.3 samples/s | 68.9 steps/s
[Step=14950 Epoch=29.2] | Loss=0.01002 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.088 | L2-Norm(final)=2.990 | 1673.0 samples/s | 26.1 steps/s
[Step=15000 Epoch=29.3] | Loss=0.00968 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.087 | L2-Norm(final)=2.991 | 3717.7 samples/s | 58.1 steps/s
[Step=15050 Epoch=29.4] | Loss=0.00932 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.087 | L2-Norm(final)=2.992 | 3736.5 samples/s | 58.4 steps/s
[Step=15100 Epoch=29.5] | Loss=0.00919 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.087 | L2-Norm(final)=2.993 | 3731.0 samples/s | 58.3 steps/s
[Step=15150 Epoch=29.6] | Loss=0.00893 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.087 | L2-Norm(final)=2.995 | 3735.9 samples/s | 58.4 steps/s
[Step=15200 Epoch=29.7] | Loss=0.00888 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.086 | L2-Norm(final)=2.996 | 3739.1 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24913 | acc=0.8537 | tpr=0.7914 | fpr=0.0111 | 3779.3 samples/s | 14.8 steps/s
Avg test loss: 0.25359, Avg test acc: 0.85307, Avg tpr: 0.79204, Avg fpr: 0.01269, total FA: 99

Testing server on iccad2012
[Step=  50] | Loss=0.46746 | acc=0.8463 | tpr=0.9823 | fpr=0.1561 | 3798.1 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.48064 | acc=0.8458 | tpr=0.9829 | fpr=0.1568 | 7471.9 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.48995 | acc=0.8443 | tpr=0.9827 | fpr=0.1583 | 7234.4 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.49415 | acc=0.8443 | tpr=0.9836 | fpr=0.1582 | 7287.9 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.48930 | acc=0.8448 | tpr=0.9825 | fpr=0.1577 | 7161.4 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.48839 | acc=0.8457 | tpr=0.9840 | fpr=0.1568 | 7224.3 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.48843 | acc=0.8458 | tpr=0.9831 | fpr=0.1567 | 7325.8 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.48802 | acc=0.8459 | tpr=0.9847 | fpr=0.1566 | 7555.0 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.49187 | acc=0.8452 | tpr=0.9854 | fpr=0.1574 | 6959.6 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.49164 | acc=0.8453 | tpr=0.9855 | fpr=0.1573 | 7051.9 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.48937 | acc=0.8455 | tpr=0.9857 | fpr=0.1571 | 13590.0 samples/s | 53.1 steps/s
Avg test loss: 0.48911, Avg test acc: 0.84549, Avg tpr: 0.98574, Avg fpr: 0.15706, total FA: 21808

server round 42/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=15201 Epoch=29.7] | Loss=0.21092 | Reg=0.00327 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.097 | L2-Norm(final)=2.986 | 3799.7 samples/s | 59.4 steps/s
[Step=15250 Epoch=29.8] | Loss=0.02518 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.078 | L2-Norm(final)=2.986 | 3525.5 samples/s | 55.1 steps/s
[Step=15300 Epoch=29.9] | Loss=0.01786 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.071 | L2-Norm(final)=2.987 | 3728.9 samples/s | 58.3 steps/s
[Step=15350 Epoch=30.0] | Loss=0.01450 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.068 | L2-Norm(final)=2.988 | 3742.2 samples/s | 58.5 steps/s
[Step=15400 Epoch=30.1] | Loss=0.01308 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.066 | L2-Norm(final)=2.990 | 3748.3 samples/s | 58.6 steps/s
[Step=15450 Epoch=30.2] | Loss=0.01187 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.064 | L2-Norm(final)=2.991 | 3749.2 samples/s | 58.6 steps/s
[Step=15500 Epoch=30.3] | Loss=0.01153 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.063 | L2-Norm(final)=2.992 | 3738.0 samples/s | 58.4 steps/s
[Step=15550 Epoch=30.4] | Loss=0.01123 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.062 | L2-Norm(final)=2.993 | 3753.9 samples/s | 58.7 steps/s
[Step=15600 Epoch=30.5] | Loss=0.01063 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.062 | L2-Norm(final)=2.995 | 3739.7 samples/s | 58.4 steps/s
[Step=15650 Epoch=30.6] | Loss=0.01041 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.061 | L2-Norm(final)=2.996 | 3754.1 samples/s | 58.7 steps/s
[Step=15700 Epoch=30.7] | Loss=0.01028 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.060 | L2-Norm(final)=2.997 | 4414.4 samples/s | 69.0 steps/s
[Step=15750 Epoch=30.8] | Loss=0.00992 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.060 | L2-Norm(final)=2.998 | 1679.9 samples/s | 26.2 steps/s
[Step=15800 Epoch=30.9] | Loss=0.00972 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.060 | L2-Norm(final)=2.999 | 3725.8 samples/s | 58.2 steps/s
[Step=15850 Epoch=31.0] | Loss=0.00947 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.059 | L2-Norm(final)=3.000 | 3745.7 samples/s | 58.5 steps/s
[Step=15900 Epoch=31.1] | Loss=0.00923 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.059 | L2-Norm(final)=3.001 | 3739.5 samples/s | 58.4 steps/s
[Step=15950 Epoch=31.2] | Loss=0.00904 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.059 | L2-Norm(final)=3.002 | 3752.8 samples/s | 58.6 steps/s
[Step=16000 Epoch=31.3] | Loss=0.00886 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.059 | L2-Norm(final)=3.004 | 3744.9 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step16000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=64.4] | Loss=0.09308 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.097 | L2-Norm(final)=2.986 | 3560.0 samples/s | 55.6 steps/s
[Step=16850 Epoch=64.6] | Loss=0.00728 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.065 | L2-Norm(final)=2.988 | 3478.6 samples/s | 54.4 steps/s
[Step=16900 Epoch=64.8] | Loss=0.00373 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.057 | L2-Norm(final)=2.989 | 3531.6 samples/s | 55.2 steps/s
[Step=16950 Epoch=64.9] | Loss=0.00251 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.052 | L2-Norm(final)=2.989 | 3544.0 samples/s | 55.4 steps/s
[Step=17000 Epoch=65.1] | Loss=0.00189 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.049 | L2-Norm(final)=2.989 | 3521.1 samples/s | 55.0 steps/s
[Step=17050 Epoch=65.3] | Loss=0.00152 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.045 | L2-Norm(final)=2.989 | 4264.9 samples/s | 66.6 steps/s
[Step=17100 Epoch=65.5] | Loss=0.00128 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=2.989 | 1615.1 samples/s | 25.2 steps/s
[Step=17150 Epoch=65.7] | Loss=0.00110 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.040 | L2-Norm(final)=2.990 | 3541.9 samples/s | 55.3 steps/s
[Step=17200 Epoch=65.9] | Loss=0.00097 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.038 | L2-Norm(final)=2.990 | 3541.5 samples/s | 55.3 steps/s
[Step=17250 Epoch=66.1] | Loss=0.00087 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.036 | L2-Norm(final)=2.990 | 3537.0 samples/s | 55.3 steps/s
[Step=17300 Epoch=66.3] | Loss=0.00078 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.034 | L2-Norm(final)=2.990 | 3837.7 samples/s | 60.0 steps/s
[Step=17350 Epoch=66.5] | Loss=0.00072 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.033 | L2-Norm(final)=2.990 | 1664.0 samples/s | 26.0 steps/s
[Step=17400 Epoch=66.7] | Loss=0.00066 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.031 | L2-Norm(final)=2.990 | 3503.6 samples/s | 54.7 steps/s
[Step=17450 Epoch=66.9] | Loss=0.00061 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.029 | L2-Norm(final)=2.990 | 3528.3 samples/s | 55.1 steps/s
[Step=17500 Epoch=67.1] | Loss=0.00057 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.028 | L2-Norm(final)=2.990 | 3501.2 samples/s | 54.7 steps/s
[Step=17550 Epoch=67.2] | Loss=0.00053 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.027 | L2-Norm(final)=2.990 | 3524.3 samples/s | 55.1 steps/s
[Step=17600 Epoch=67.4] | Loss=0.00050 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.025 | L2-Norm(final)=2.991 | 1728.7 samples/s | 27.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25568 | acc=0.8525 | tpr=0.7896 | fpr=0.0109 | 3810.1 samples/s | 14.9 steps/s
Avg test loss: 0.26000, Avg test acc: 0.85131, Avg tpr: 0.78942, Avg fpr: 0.01256, total FA: 98

Testing server on iccad2012
[Step=  50] | Loss=0.47056 | acc=0.8480 | tpr=0.9823 | fpr=0.1544 | 3840.7 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.48428 | acc=0.8469 | tpr=0.9829 | fpr=0.1556 | 7182.0 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.49359 | acc=0.8454 | tpr=0.9827 | fpr=0.1571 | 7290.6 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.49752 | acc=0.8453 | tpr=0.9814 | fpr=0.1572 | 7222.6 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.49249 | acc=0.8456 | tpr=0.9808 | fpr=0.1568 | 7361.6 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.49162 | acc=0.8465 | tpr=0.9818 | fpr=0.1560 | 7126.4 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.49161 | acc=0.8466 | tpr=0.9812 | fpr=0.1558 | 7257.5 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.49120 | acc=0.8468 | tpr=0.9830 | fpr=0.1557 | 7288.5 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.49509 | acc=0.8462 | tpr=0.9839 | fpr=0.1563 | 7039.4 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.49485 | acc=0.8462 | tpr=0.9841 | fpr=0.1563 | 7125.9 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.49251 | acc=0.8464 | tpr=0.9845 | fpr=0.1561 | 13802.0 samples/s | 53.9 steps/s
Avg test loss: 0.49225, Avg test acc: 0.84641, Avg tpr: 0.98455, Avg fpr: 0.15610, total FA: 21674

server round 43/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=67.4] | Loss=0.16769 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.074 | L2-Norm(final)=2.992 | 3609.4 samples/s | 56.4 steps/s
[Step=17650 Epoch=67.6] | Loss=0.00997 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.039 | L2-Norm(final)=2.991 | 3352.1 samples/s | 52.4 steps/s
[Step=17700 Epoch=67.8] | Loss=0.00511 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.031 | L2-Norm(final)=2.991 | 3510.6 samples/s | 54.9 steps/s
[Step=17750 Epoch=68.0] | Loss=0.00344 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.026 | L2-Norm(final)=2.991 | 3519.7 samples/s | 55.0 steps/s
[Step=17800 Epoch=68.2] | Loss=0.00260 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.022 | L2-Norm(final)=2.991 | 3503.8 samples/s | 54.7 steps/s
[Step=17850 Epoch=68.4] | Loss=0.00210 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.019 | L2-Norm(final)=2.992 | 4258.3 samples/s | 66.5 steps/s
[Step=17900 Epoch=68.6] | Loss=0.00176 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.017 | L2-Norm(final)=2.992 | 1606.8 samples/s | 25.1 steps/s
[Step=17950 Epoch=68.8] | Loss=0.00152 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.015 | L2-Norm(final)=2.992 | 3470.7 samples/s | 54.2 steps/s
[Step=18000 Epoch=69.0] | Loss=0.00133 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.013 | L2-Norm(final)=2.992 | 3501.3 samples/s | 54.7 steps/s
[Step=18050 Epoch=69.2] | Loss=0.00119 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.011 | L2-Norm(final)=2.993 | 3508.7 samples/s | 54.8 steps/s
[Step=18100 Epoch=69.4] | Loss=0.00108 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.009 | L2-Norm(final)=2.993 | 3827.0 samples/s | 59.8 steps/s
[Step=18150 Epoch=69.5] | Loss=0.00098 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.008 | L2-Norm(final)=2.993 | 1659.9 samples/s | 25.9 steps/s
[Step=18200 Epoch=69.7] | Loss=0.00090 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.006 | L2-Norm(final)=2.993 | 3527.4 samples/s | 55.1 steps/s
[Step=18250 Epoch=69.9] | Loss=0.00084 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.005 | L2-Norm(final)=2.993 | 3499.7 samples/s | 54.7 steps/s
[Step=18300 Epoch=70.1] | Loss=0.00078 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.003 | L2-Norm(final)=2.993 | 3528.1 samples/s | 55.1 steps/s
[Step=18350 Epoch=70.3] | Loss=0.00073 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.002 | L2-Norm(final)=2.994 | 3487.0 samples/s | 54.5 steps/s
[Step=18400 Epoch=70.5] | Loss=0.00069 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.001 | L2-Norm(final)=2.994 | 1716.7 samples/s | 26.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step18400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=64.7] | Loss=0.15498 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.074 | L2-Norm(final)=2.992 | 3677.7 samples/s | 57.5 steps/s
[Step=16850 Epoch=64.9] | Loss=0.01069 | Reg=0.00326 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=2.992 | 3359.0 samples/s | 52.5 steps/s
[Step=16900 Epoch=65.1] | Loss=0.00547 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.035 | L2-Norm(final)=2.992 | 3514.4 samples/s | 54.9 steps/s
[Step=16950 Epoch=65.2] | Loss=0.00370 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.030 | L2-Norm(final)=2.992 | 3511.8 samples/s | 54.9 steps/s
[Step=17000 Epoch=65.4] | Loss=0.00280 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.026 | L2-Norm(final)=2.992 | 3520.8 samples/s | 55.0 steps/s
[Step=17050 Epoch=65.6] | Loss=0.00225 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.023 | L2-Norm(final)=2.992 | 4239.4 samples/s | 66.2 steps/s
[Step=17100 Epoch=65.8] | Loss=0.00189 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.020 | L2-Norm(final)=2.992 | 1603.2 samples/s | 25.1 steps/s
[Step=17150 Epoch=66.0] | Loss=0.00162 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=2.993 | 3537.9 samples/s | 55.3 steps/s
[Step=17200 Epoch=66.2] | Loss=0.00142 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.016 | L2-Norm(final)=2.993 | 3501.2 samples/s | 54.7 steps/s
[Step=17250 Epoch=66.4] | Loss=0.00127 | Reg=0.00325 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.014 | L2-Norm(final)=2.993 | 3522.7 samples/s | 55.0 steps/s
[Step=17300 Epoch=66.6] | Loss=0.00115 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=2.993 | 3894.8 samples/s | 60.9 steps/s
[Step=17350 Epoch=66.8] | Loss=0.00105 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.011 | L2-Norm(final)=2.993 | 1651.6 samples/s | 25.8 steps/s
[Step=17400 Epoch=67.0] | Loss=0.00096 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.009 | L2-Norm(final)=2.993 | 3532.7 samples/s | 55.2 steps/s
[Step=17450 Epoch=67.2] | Loss=0.00089 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.008 | L2-Norm(final)=2.993 | 3523.5 samples/s | 55.1 steps/s
[Step=17500 Epoch=67.4] | Loss=0.00083 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.007 | L2-Norm(final)=2.994 | 3519.1 samples/s | 55.0 steps/s
[Step=17550 Epoch=67.6] | Loss=0.00078 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.005 | L2-Norm(final)=2.994 | 3572.6 samples/s | 55.8 steps/s
[Step=17600 Epoch=67.7] | Loss=0.00073 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.004 | L2-Norm(final)=2.994 | 1708.2 samples/s | 26.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22359 | acc=0.8715 | tpr=0.8170 | fpr=0.0102 | 3855.9 samples/s | 15.1 steps/s
Avg test loss: 0.22804, Avg test acc: 0.87002, Avg tpr: 0.81640, Avg fpr: 0.01205, total FA: 94

Testing server on iccad2012
[Step=  50] | Loss=0.53211 | acc=0.8228 | tpr=0.9823 | fpr=0.1801 | 3869.9 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.54592 | acc=0.8215 | tpr=0.9829 | fpr=0.1815 | 7042.6 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.55479 | acc=0.8194 | tpr=0.9827 | fpr=0.1836 | 7216.3 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.55782 | acc=0.8198 | tpr=0.9814 | fpr=0.1832 | 7248.2 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.55304 | acc=0.8205 | tpr=0.9808 | fpr=0.1825 | 7306.1 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.55152 | acc=0.8212 | tpr=0.9818 | fpr=0.1817 | 7197.6 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.55137 | acc=0.8208 | tpr=0.9812 | fpr=0.1821 | 7418.0 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.55068 | acc=0.8209 | tpr=0.9830 | fpr=0.1820 | 7176.6 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.55468 | acc=0.8203 | tpr=0.9839 | fpr=0.1826 | 7093.7 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.55447 | acc=0.8203 | tpr=0.9841 | fpr=0.1827 | 7134.8 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.55215 | acc=0.8206 | tpr=0.9845 | fpr=0.1823 | 13717.8 samples/s | 53.6 steps/s
Avg test loss: 0.55192, Avg test acc: 0.82066, Avg tpr: 0.98455, Avg fpr: 0.18231, total FA: 25314

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=35.9] | Loss=0.06131 | Reg=0.00325 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.024 | L2-Norm(final)=3.006 | 3343.8 samples/s | 52.2 steps/s
[Step=18450 Epoch=36.0] | Loss=0.02348 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.006 | L2-Norm(final)=3.006 | 3674.7 samples/s | 57.4 steps/s
[Step=18500 Epoch=36.1] | Loss=0.01742 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.000 | L2-Norm(final)=3.006 | 3720.7 samples/s | 58.1 steps/s
[Step=18550 Epoch=36.2] | Loss=0.01509 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.996 | L2-Norm(final)=3.007 | 3725.1 samples/s | 58.2 steps/s
[Step=18600 Epoch=36.3] | Loss=0.01396 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.994 | L2-Norm(final)=3.008 | 3747.7 samples/s | 58.6 steps/s
[Step=18650 Epoch=36.4] | Loss=0.01323 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.992 | L2-Norm(final)=3.009 | 3737.9 samples/s | 58.4 steps/s
[Step=18700 Epoch=36.5] | Loss=0.01275 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.991 | L2-Norm(final)=3.010 | 3756.8 samples/s | 58.7 steps/s
[Step=18750 Epoch=36.6] | Loss=0.01223 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.990 | L2-Norm(final)=3.011 | 3748.5 samples/s | 58.6 steps/s
[Step=18800 Epoch=36.7] | Loss=0.01173 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.989 | L2-Norm(final)=3.012 | 3747.9 samples/s | 58.6 steps/s
[Step=18850 Epoch=36.8] | Loss=0.01144 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.989 | L2-Norm(final)=3.013 | 3732.8 samples/s | 58.3 steps/s
[Step=18900 Epoch=36.9] | Loss=0.01098 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.988 | L2-Norm(final)=3.014 | 4354.0 samples/s | 68.0 steps/s
[Step=18950 Epoch=37.0] | Loss=0.01072 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.988 | L2-Norm(final)=3.015 | 1626.3 samples/s | 25.4 steps/s
[Step=19000 Epoch=37.1] | Loss=0.01038 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=3.016 | 3721.8 samples/s | 58.2 steps/s
[Step=19050 Epoch=37.2] | Loss=0.01015 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.987 | L2-Norm(final)=3.017 | 3735.1 samples/s | 58.4 steps/s
[Step=19100 Epoch=37.3] | Loss=0.00985 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=3.017 | 3720.9 samples/s | 58.1 steps/s
[Step=19150 Epoch=37.3] | Loss=0.00954 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=3.018 | 3719.5 samples/s | 58.1 steps/s
[Step=19200 Epoch=37.4] | Loss=0.00936 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.987 | L2-Norm(final)=3.019 | 3752.0 samples/s | 58.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step19200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16001 Epoch=31.3] | Loss=0.13236 | Reg=0.00325 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.024 | L2-Norm(final)=3.005 | 3681.2 samples/s | 57.5 steps/s
[Step=16050 Epoch=31.4] | Loss=0.02166 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.005 | L2-Norm(final)=3.005 | 3642.1 samples/s | 56.9 steps/s
[Step=16100 Epoch=31.5] | Loss=0.01518 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.998 | L2-Norm(final)=3.006 | 3748.2 samples/s | 58.6 steps/s
[Step=16150 Epoch=31.6] | Loss=0.01298 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.995 | L2-Norm(final)=3.008 | 3750.4 samples/s | 58.6 steps/s
[Step=16200 Epoch=31.7] | Loss=0.01162 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.993 | L2-Norm(final)=3.009 | 3732.7 samples/s | 58.3 steps/s
[Step=16250 Epoch=31.8] | Loss=0.01108 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.991 | L2-Norm(final)=3.011 | 3755.1 samples/s | 58.7 steps/s
[Step=16300 Epoch=31.9] | Loss=0.01062 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.990 | L2-Norm(final)=3.012 | 3744.2 samples/s | 58.5 steps/s
[Step=16350 Epoch=32.0] | Loss=0.01018 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.989 | L2-Norm(final)=3.013 | 3755.1 samples/s | 58.7 steps/s
[Step=16400 Epoch=32.1] | Loss=0.00988 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.989 | L2-Norm(final)=3.014 | 3754.5 samples/s | 58.7 steps/s
[Step=16450 Epoch=32.2] | Loss=0.00984 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.988 | L2-Norm(final)=3.015 | 3742.7 samples/s | 58.5 steps/s
[Step=16500 Epoch=32.3] | Loss=0.00950 | Reg=0.00324 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.988 | L2-Norm(final)=3.016 | 4405.5 samples/s | 68.8 steps/s
[Step=16550 Epoch=32.4] | Loss=0.00915 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=3.017 | 1671.4 samples/s | 26.1 steps/s
[Step=16600 Epoch=32.5] | Loss=0.00894 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=3.018 | 3729.3 samples/s | 58.3 steps/s
[Step=16650 Epoch=32.6] | Loss=0.00867 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=3.019 | 3727.6 samples/s | 58.2 steps/s
[Step=16700 Epoch=32.6] | Loss=0.00840 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.986 | L2-Norm(final)=3.020 | 3720.3 samples/s | 58.1 steps/s
[Step=16750 Epoch=32.7] | Loss=0.00835 | Reg=0.00324 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.986 | L2-Norm(final)=3.021 | 3736.1 samples/s | 58.4 steps/s
[Step=16800 Epoch=32.8] | Loss=0.00829 | Reg=0.00323 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.986 | L2-Norm(final)=3.022 | 3753.9 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24084 | acc=0.8654 | tpr=0.8076 | fpr=0.0092 | 3826.6 samples/s | 14.9 steps/s
Avg test loss: 0.24537, Avg test acc: 0.86357, Avg tpr: 0.80655, Avg fpr: 0.01102, total FA: 86

Testing server on iccad2012
[Step=  50] | Loss=0.51318 | acc=0.8339 | tpr=0.9823 | fpr=0.1688 | 3856.3 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.52748 | acc=0.8319 | tpr=0.9829 | fpr=0.1709 | 7207.6 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.53616 | acc=0.8298 | tpr=0.9827 | fpr=0.1730 | 7128.2 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.53933 | acc=0.8300 | tpr=0.9814 | fpr=0.1728 | 7275.7 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.53468 | acc=0.8303 | tpr=0.9808 | fpr=0.1725 | 7273.8 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.53334 | acc=0.8308 | tpr=0.9818 | fpr=0.1720 | 7226.1 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.53321 | acc=0.8303 | tpr=0.9806 | fpr=0.1724 | 7494.1 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.53255 | acc=0.8306 | tpr=0.9825 | fpr=0.1721 | 7013.6 samples/s | 27.4 steps/s
[Step= 450] | Loss=0.53660 | acc=0.8299 | tpr=0.9834 | fpr=0.1729 | 7196.3 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.53642 | acc=0.8297 | tpr=0.9837 | fpr=0.1730 | 7219.5 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.53420 | acc=0.8300 | tpr=0.9833 | fpr=0.1728 | 13229.9 samples/s | 51.7 steps/s
Avg test loss: 0.53398, Avg test acc: 0.83003, Avg tpr: 0.98336, Avg fpr: 0.17276, total FA: 23987

server round 45/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=37.4] | Loss=0.15218 | Reg=0.00323 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.980 | L2-Norm(final)=3.016 | 3526.2 samples/s | 55.1 steps/s
[Step=19250 Epoch=37.5] | Loss=0.02790 | Reg=0.00323 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.963 | L2-Norm(final)=3.015 | 3667.5 samples/s | 57.3 steps/s
[Step=19300 Epoch=37.6] | Loss=0.01980 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.957 | L2-Norm(final)=3.015 | 3739.3 samples/s | 58.4 steps/s
[Step=19350 Epoch=37.7] | Loss=0.01635 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.954 | L2-Norm(final)=3.016 | 3746.0 samples/s | 58.5 steps/s
[Step=19400 Epoch=37.8] | Loss=0.01403 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=3.017 | 3743.2 samples/s | 58.5 steps/s
[Step=19450 Epoch=37.9] | Loss=0.01304 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.950 | L2-Norm(final)=3.018 | 3761.8 samples/s | 58.8 steps/s
[Step=19500 Epoch=38.0] | Loss=0.01228 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.949 | L2-Norm(final)=3.019 | 3749.9 samples/s | 58.6 steps/s
[Step=19550 Epoch=38.1] | Loss=0.01184 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.948 | L2-Norm(final)=3.020 | 3766.3 samples/s | 58.8 steps/s
[Step=19600 Epoch=38.2] | Loss=0.01168 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.947 | L2-Norm(final)=3.021 | 3755.5 samples/s | 58.7 steps/s
[Step=19650 Epoch=38.3] | Loss=0.01144 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.946 | L2-Norm(final)=3.022 | 3772.4 samples/s | 58.9 steps/s
[Step=19700 Epoch=38.4] | Loss=0.01118 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.946 | L2-Norm(final)=3.023 | 4359.8 samples/s | 68.1 steps/s
[Step=19750 Epoch=38.5] | Loss=0.01083 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.945 | L2-Norm(final)=3.023 | 1609.1 samples/s | 25.1 steps/s
[Step=19800 Epoch=38.6] | Loss=0.01053 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.945 | L2-Norm(final)=3.024 | 3724.1 samples/s | 58.2 steps/s
[Step=19850 Epoch=38.7] | Loss=0.01032 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.945 | L2-Norm(final)=3.025 | 3742.7 samples/s | 58.5 steps/s
[Step=19900 Epoch=38.8] | Loss=0.00988 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.944 | L2-Norm(final)=3.026 | 3743.9 samples/s | 58.5 steps/s
[Step=19950 Epoch=38.9] | Loss=0.00975 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.944 | L2-Norm(final)=3.027 | 3744.6 samples/s | 58.5 steps/s
[Step=20000 Epoch=39.0] | Loss=0.00964 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.944 | L2-Norm(final)=3.028 | 3687.7 samples/s | 57.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step20000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=18401 Epoch=70.5] | Loss=0.18162 | Reg=0.00323 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.980 | L2-Norm(final)=3.016 | 3524.1 samples/s | 55.1 steps/s
[Step=18450 Epoch=70.7] | Loss=0.01010 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.947 | L2-Norm(final)=3.017 | 3515.4 samples/s | 54.9 steps/s
[Step=18500 Epoch=70.9] | Loss=0.00510 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.940 | L2-Norm(final)=3.017 | 3538.7 samples/s | 55.3 steps/s
[Step=18550 Epoch=71.1] | Loss=0.00344 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.935 | L2-Norm(final)=3.017 | 3524.2 samples/s | 55.1 steps/s
[Step=18600 Epoch=71.3] | Loss=0.00261 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.931 | L2-Norm(final)=3.017 | 3537.3 samples/s | 55.3 steps/s
[Step=18650 Epoch=71.5] | Loss=0.00209 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.928 | L2-Norm(final)=3.017 | 4238.0 samples/s | 66.2 steps/s
[Step=18700 Epoch=71.7] | Loss=0.00175 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.926 | L2-Norm(final)=3.018 | 1610.3 samples/s | 25.2 steps/s
[Step=18750 Epoch=71.8] | Loss=0.00151 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.923 | L2-Norm(final)=3.018 | 3507.9 samples/s | 54.8 steps/s
[Step=18800 Epoch=72.0] | Loss=0.00132 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.921 | L2-Norm(final)=3.018 | 3547.3 samples/s | 55.4 steps/s
[Step=18850 Epoch=72.2] | Loss=0.00118 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.920 | L2-Norm(final)=3.018 | 3507.6 samples/s | 54.8 steps/s
[Step=18900 Epoch=72.4] | Loss=0.00107 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.918 | L2-Norm(final)=3.018 | 3866.2 samples/s | 60.4 steps/s
[Step=18950 Epoch=72.6] | Loss=0.00097 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.916 | L2-Norm(final)=3.018 | 1691.6 samples/s | 26.4 steps/s
[Step=19000 Epoch=72.8] | Loss=0.00090 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.915 | L2-Norm(final)=3.018 | 3516.4 samples/s | 54.9 steps/s
[Step=19050 Epoch=73.0] | Loss=0.00083 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=3.018 | 3524.7 samples/s | 55.1 steps/s
[Step=19100 Epoch=73.2] | Loss=0.00077 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=3.019 | 3531.5 samples/s | 55.2 steps/s
[Step=19150 Epoch=73.4] | Loss=0.00072 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=3.019 | 3525.0 samples/s | 55.1 steps/s
[Step=19200 Epoch=73.6] | Loss=0.00068 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.910 | L2-Norm(final)=3.019 | 1734.1 samples/s | 27.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24506 | acc=0.8624 | tpr=0.8033 | fpr=0.0092 | 3833.4 samples/s | 15.0 steps/s
Avg test loss: 0.24967, Avg test acc: 0.86073, Avg tpr: 0.80247, Avg fpr: 0.01115, total FA: 87

Testing server on iccad2012
[Step=  50] | Loss=0.50425 | acc=0.8378 | tpr=0.9823 | fpr=0.1648 | 3845.4 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.51847 | acc=0.8363 | tpr=0.9829 | fpr=0.1664 | 7051.4 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.52699 | acc=0.8342 | tpr=0.9827 | fpr=0.1685 | 7422.6 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.53038 | acc=0.8341 | tpr=0.9814 | fpr=0.1686 | 7447.1 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.52577 | acc=0.8345 | tpr=0.9799 | fpr=0.1682 | 6973.9 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.52433 | acc=0.8351 | tpr=0.9811 | fpr=0.1676 | 7306.1 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.52415 | acc=0.8347 | tpr=0.9793 | fpr=0.1679 | 7181.9 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.52348 | acc=0.8349 | tpr=0.9814 | fpr=0.1677 | 7263.9 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.52740 | acc=0.8342 | tpr=0.9825 | fpr=0.1685 | 7099.3 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.52722 | acc=0.8341 | tpr=0.9828 | fpr=0.1686 | 7029.7 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.52502 | acc=0.8345 | tpr=0.9821 | fpr=0.1682 | 13593.2 samples/s | 53.1 steps/s
Avg test loss: 0.52481, Avg test acc: 0.83452, Avg tpr: 0.98217, Avg fpr: 0.16816, total FA: 23349

server round 46/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=39.0] | Loss=0.10235 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.947 | L2-Norm(final)=3.024 | 3785.6 samples/s | 59.2 steps/s
[Step=20050 Epoch=39.1] | Loss=0.02934 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.929 | L2-Norm(final)=3.023 | 3337.7 samples/s | 52.2 steps/s
[Step=20100 Epoch=39.2] | Loss=0.01997 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.923 | L2-Norm(final)=3.023 | 3730.0 samples/s | 58.3 steps/s
[Step=20150 Epoch=39.3] | Loss=0.01653 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.920 | L2-Norm(final)=3.024 | 3724.6 samples/s | 58.2 steps/s
[Step=20200 Epoch=39.4] | Loss=0.01492 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.918 | L2-Norm(final)=3.025 | 3751.3 samples/s | 58.6 steps/s
[Step=20250 Epoch=39.5] | Loss=0.01397 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.916 | L2-Norm(final)=3.025 | 3695.5 samples/s | 57.7 steps/s
[Step=20300 Epoch=39.6] | Loss=0.01299 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.915 | L2-Norm(final)=3.026 | 3759.5 samples/s | 58.7 steps/s
[Step=20350 Epoch=39.7] | Loss=0.01247 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.914 | L2-Norm(final)=3.027 | 3747.3 samples/s | 58.6 steps/s
[Step=20400 Epoch=39.8] | Loss=0.01193 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=3.028 | 3753.6 samples/s | 58.6 steps/s
[Step=20450 Epoch=39.9] | Loss=0.01149 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=3.028 | 3760.3 samples/s | 58.8 steps/s
[Step=20500 Epoch=40.0] | Loss=0.01113 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=3.029 | 4340.4 samples/s | 67.8 steps/s
[Step=20550 Epoch=40.1] | Loss=0.01088 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=3.030 | 1615.0 samples/s | 25.2 steps/s
[Step=20600 Epoch=40.2] | Loss=0.01060 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=3.031 | 3708.5 samples/s | 57.9 steps/s
[Step=20650 Epoch=40.3] | Loss=0.01024 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=3.032 | 3743.0 samples/s | 58.5 steps/s
[Step=20700 Epoch=40.4] | Loss=0.01005 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.911 | L2-Norm(final)=3.033 | 3732.7 samples/s | 58.3 steps/s
[Step=20750 Epoch=40.5] | Loss=0.00989 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=3.034 | 3747.2 samples/s | 58.5 steps/s
[Step=20800 Epoch=40.6] | Loss=0.00972 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.910 | L2-Norm(final)=3.035 | 3744.6 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step20800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=17601 Epoch=67.8] | Loss=0.14555 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.947 | L2-Norm(final)=3.024 | 3624.0 samples/s | 56.6 steps/s
[Step=17650 Epoch=67.9] | Loss=0.00898 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.914 | L2-Norm(final)=3.024 | 3489.3 samples/s | 54.5 steps/s
[Step=17700 Epoch=68.1] | Loss=0.00454 | Reg=0.00321 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.906 | L2-Norm(final)=3.024 | 3519.0 samples/s | 55.0 steps/s
[Step=17750 Epoch=68.3] | Loss=0.00309 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.901 | L2-Norm(final)=3.024 | 3537.2 samples/s | 55.3 steps/s
[Step=17800 Epoch=68.5] | Loss=0.00234 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.897 | L2-Norm(final)=3.024 | 3535.7 samples/s | 55.2 steps/s
[Step=17850 Epoch=68.7] | Loss=0.00194 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.895 | L2-Norm(final)=3.025 | 4281.2 samples/s | 66.9 steps/s
[Step=17900 Epoch=68.9] | Loss=0.00162 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.892 | L2-Norm(final)=3.025 | 1611.5 samples/s | 25.2 steps/s
[Step=17950 Epoch=69.1] | Loss=0.00139 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.890 | L2-Norm(final)=3.025 | 3518.9 samples/s | 55.0 steps/s
[Step=18000 Epoch=69.3] | Loss=0.00123 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.888 | L2-Norm(final)=3.025 | 3531.6 samples/s | 55.2 steps/s
[Step=18050 Epoch=69.5] | Loss=0.00109 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.886 | L2-Norm(final)=3.025 | 3537.9 samples/s | 55.3 steps/s
[Step=18100 Epoch=69.7] | Loss=0.00099 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.884 | L2-Norm(final)=3.026 | 3907.9 samples/s | 61.1 steps/s
[Step=18150 Epoch=69.9] | Loss=0.00090 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.883 | L2-Norm(final)=3.026 | 1642.0 samples/s | 25.7 steps/s
[Step=18200 Epoch=70.1] | Loss=0.00083 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=3.026 | 3507.8 samples/s | 54.8 steps/s
[Step=18250 Epoch=70.3] | Loss=0.00077 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.880 | L2-Norm(final)=3.026 | 3482.9 samples/s | 54.4 steps/s
[Step=18300 Epoch=70.4] | Loss=0.00072 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.879 | L2-Norm(final)=3.026 | 3520.0 samples/s | 55.0 steps/s
[Step=18350 Epoch=70.6] | Loss=0.00067 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.878 | L2-Norm(final)=3.026 | 3584.6 samples/s | 56.0 steps/s
[Step=18400 Epoch=70.8] | Loss=0.00063 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.876 | L2-Norm(final)=3.026 | 1705.9 samples/s | 26.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_1/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24372 | acc=0.8643 | tpr=0.8060 | fpr=0.0092 | 3811.0 samples/s | 14.9 steps/s
Avg test loss: 0.24841, Avg test acc: 0.86237, Avg tpr: 0.80509, Avg fpr: 0.01167, total FA: 91

Testing server on iccad2012
[Step=  50] | Loss=0.50845 | acc=0.8378 | tpr=0.9823 | fpr=0.1648 | 3869.5 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.52304 | acc=0.8363 | tpr=0.9829 | fpr=0.1664 | 7240.8 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.53163 | acc=0.8343 | tpr=0.9827 | fpr=0.1685 | 7150.4 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.53510 | acc=0.8344 | tpr=0.9814 | fpr=0.1683 | 7282.6 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.53042 | acc=0.8347 | tpr=0.9799 | fpr=0.1679 | 7123.6 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.52896 | acc=0.8355 | tpr=0.9818 | fpr=0.1672 | 7441.0 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.52874 | acc=0.8353 | tpr=0.9800 | fpr=0.1673 | 7045.5 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.52808 | acc=0.8355 | tpr=0.9819 | fpr=0.1672 | 7258.5 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.53214 | acc=0.8347 | tpr=0.9830 | fpr=0.1680 | 7155.3 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.53191 | acc=0.8345 | tpr=0.9833 | fpr=0.1682 | 7274.1 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.52966 | acc=0.8350 | tpr=0.9829 | fpr=0.1677 | 13729.4 samples/s | 53.6 steps/s
Avg test loss: 0.52946, Avg test acc: 0.83500, Avg tpr: 0.98296, Avg fpr: 0.16769, total FA: 23284

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20801 Epoch=40.6] | Loss=0.16976 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.906 | L2-Norm(final)=3.033 | 3470.1 samples/s | 54.2 steps/s
[Step=20850 Epoch=40.7] | Loss=0.02986 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.890 | L2-Norm(final)=3.032 | 3585.4 samples/s | 56.0 steps/s
[Step=20900 Epoch=40.8] | Loss=0.02040 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.884 | L2-Norm(final)=3.032 | 3733.7 samples/s | 58.3 steps/s
[Step=20950 Epoch=40.9] | Loss=0.01654 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=3.033 | 3733.8 samples/s | 58.3 steps/s
[Step=21000 Epoch=41.0] | Loss=0.01472 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.879 | L2-Norm(final)=3.034 | 3748.2 samples/s | 58.6 steps/s
[Step=21050 Epoch=41.1] | Loss=0.01380 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.877 | L2-Norm(final)=3.034 | 3736.0 samples/s | 58.4 steps/s
[Step=21100 Epoch=41.2] | Loss=0.01304 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.876 | L2-Norm(final)=3.035 | 3763.2 samples/s | 58.8 steps/s
[Step=21150 Epoch=41.3] | Loss=0.01216 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.875 | L2-Norm(final)=3.036 | 3761.6 samples/s | 58.8 steps/s
[Step=21200 Epoch=41.3] | Loss=0.01147 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.037 | 3736.5 samples/s | 58.4 steps/s
[Step=21250 Epoch=41.4] | Loss=0.01123 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.874 | L2-Norm(final)=3.038 | 3772.5 samples/s | 58.9 steps/s
[Step=21300 Epoch=41.5] | Loss=0.01089 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.873 | L2-Norm(final)=3.039 | 4365.7 samples/s | 68.2 steps/s
[Step=21350 Epoch=41.6] | Loss=0.01045 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.873 | L2-Norm(final)=3.040 | 1649.7 samples/s | 25.8 steps/s
[Step=21400 Epoch=41.7] | Loss=0.00999 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.872 | L2-Norm(final)=3.041 | 3720.4 samples/s | 58.1 steps/s
[Step=21450 Epoch=41.8] | Loss=0.00990 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.872 | L2-Norm(final)=3.042 | 3736.9 samples/s | 58.4 steps/s
[Step=21500 Epoch=41.9] | Loss=0.00964 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.872 | L2-Norm(final)=3.043 | 3747.1 samples/s | 58.5 steps/s
[Step=21550 Epoch=42.0] | Loss=0.00949 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.872 | L2-Norm(final)=3.044 | 3749.8 samples/s | 58.6 steps/s
[Step=21600 Epoch=42.1] | Loss=0.00946 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.871 | L2-Norm(final)=3.044 | 3763.0 samples/s | 58.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step21600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=16801 Epoch=32.8] | Loss=0.14646 | Reg=0.00321 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.906 | L2-Norm(final)=3.033 | 3758.7 samples/s | 58.7 steps/s
[Step=16850 Epoch=32.9] | Loss=0.02238 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.890 | L2-Norm(final)=3.033 | 3607.6 samples/s | 56.4 steps/s
[Step=16900 Epoch=33.0] | Loss=0.01525 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.884 | L2-Norm(final)=3.034 | 3715.9 samples/s | 58.1 steps/s
[Step=16950 Epoch=33.1] | Loss=0.01384 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=3.035 | 3757.4 samples/s | 58.7 steps/s
[Step=17000 Epoch=33.2] | Loss=0.01218 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.878 | L2-Norm(final)=3.036 | 3764.7 samples/s | 58.8 steps/s
[Step=17050 Epoch=33.3] | Loss=0.01145 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.877 | L2-Norm(final)=3.037 | 3725.8 samples/s | 58.2 steps/s
[Step=17100 Epoch=33.4] | Loss=0.01111 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.876 | L2-Norm(final)=3.038 | 3745.5 samples/s | 58.5 steps/s
[Step=17150 Epoch=33.5] | Loss=0.01046 | Reg=0.00320 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.875 | L2-Norm(final)=3.039 | 3673.0 samples/s | 57.4 steps/s
[Step=17200 Epoch=33.6] | Loss=0.01001 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.874 | L2-Norm(final)=3.040 | 3750.4 samples/s | 58.6 steps/s
[Step=17250 Epoch=33.7] | Loss=0.00970 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.873 | L2-Norm(final)=3.041 | 3748.8 samples/s | 58.6 steps/s
[Step=17300 Epoch=33.8] | Loss=0.00931 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.873 | L2-Norm(final)=3.042 | 4413.1 samples/s | 69.0 steps/s
[Step=17350 Epoch=33.9] | Loss=0.00914 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.872 | L2-Norm(final)=3.043 | 1660.0 samples/s | 25.9 steps/s
[Step=17400 Epoch=34.0] | Loss=0.00886 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.872 | L2-Norm(final)=3.044 | 3733.6 samples/s | 58.3 steps/s
[Step=17450 Epoch=34.1] | Loss=0.00874 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.872 | L2-Norm(final)=3.045 | 3748.3 samples/s | 58.6 steps/s
[Step=17500 Epoch=34.2] | Loss=0.00860 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.871 | L2-Norm(final)=3.046 | 3729.2 samples/s | 58.3 steps/s
[Step=17550 Epoch=34.3] | Loss=0.00831 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.871 | L2-Norm(final)=3.047 | 3755.1 samples/s | 58.7 steps/s
[Step=17600 Epoch=34.4] | Loss=0.00811 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.871 | L2-Norm(final)=3.048 | 3746.3 samples/s | 58.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_1/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25739 | acc=0.8584 | tpr=0.7969 | fpr=0.0082 | 3787.4 samples/s | 14.8 steps/s
Avg test loss: 0.26241, Avg test acc: 0.85700, Avg tpr: 0.79682, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.49159 | acc=0.8458 | tpr=0.9823 | fpr=0.1567 | 3819.6 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.50659 | acc=0.8445 | tpr=0.9829 | fpr=0.1581 | 7276.3 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.51500 | acc=0.8428 | tpr=0.9827 | fpr=0.1598 | 7218.4 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.51878 | acc=0.8428 | tpr=0.9814 | fpr=0.1597 | 7358.7 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.51418 | acc=0.8432 | tpr=0.9790 | fpr=0.1593 | 7461.5 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.51283 | acc=0.8439 | tpr=0.9811 | fpr=0.1586 | 6976.2 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.51257 | acc=0.8440 | tpr=0.9793 | fpr=0.1584 | 7293.1 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.51190 | acc=0.8442 | tpr=0.9814 | fpr=0.1583 | 7331.2 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.51591 | acc=0.8434 | tpr=0.9820 | fpr=0.1591 | 7354.1 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.51569 | acc=0.8432 | tpr=0.9819 | fpr=0.1593 | 7088.5 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.51349 | acc=0.8436 | tpr=0.9817 | fpr=0.1589 | 13025.0 samples/s | 50.9 steps/s
Avg test loss: 0.51326, Avg test acc: 0.84365, Avg tpr: 0.98177, Avg fpr: 0.15886, total FA: 22058

server round 48/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=21601 Epoch=42.1] | Loss=0.06818 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.868 | L2-Norm(final)=3.042 | 3938.5 samples/s | 61.5 steps/s
[Step=21650 Epoch=42.2] | Loss=0.02687 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.852 | L2-Norm(final)=3.042 | 3285.0 samples/s | 51.3 steps/s
[Step=21700 Epoch=42.3] | Loss=0.01865 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.847 | L2-Norm(final)=3.042 | 3733.7 samples/s | 58.3 steps/s
[Step=21750 Epoch=42.4] | Loss=0.01618 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.843 | L2-Norm(final)=3.043 | 3698.2 samples/s | 57.8 steps/s
[Step=21800 Epoch=42.5] | Loss=0.01420 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.841 | L2-Norm(final)=3.044 | 3738.1 samples/s | 58.4 steps/s
[Step=21850 Epoch=42.6] | Loss=0.01324 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.840 | L2-Norm(final)=3.044 | 3723.1 samples/s | 58.2 steps/s
[Step=21900 Epoch=42.7] | Loss=0.01231 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.838 | L2-Norm(final)=3.045 | 3750.6 samples/s | 58.6 steps/s
[Step=21950 Epoch=42.8] | Loss=0.01178 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.837 | L2-Norm(final)=3.046 | 3714.9 samples/s | 58.0 steps/s
[Step=22000 Epoch=42.9] | Loss=0.01134 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.836 | L2-Norm(final)=3.047 | 3738.7 samples/s | 58.4 steps/s
[Step=22050 Epoch=43.0] | Loss=0.01101 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.836 | L2-Norm(final)=3.048 | 3736.5 samples/s | 58.4 steps/s
[Step=22100 Epoch=43.1] | Loss=0.01068 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.835 | L2-Norm(final)=3.049 | 4339.3 samples/s | 67.8 steps/s
[Step=22150 Epoch=43.2] | Loss=0.01020 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.835 | L2-Norm(final)=3.050 | 1630.6 samples/s | 25.5 steps/s
[Step=22200 Epoch=43.3] | Loss=0.00992 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.834 | L2-Norm(final)=3.050 | 3699.6 samples/s | 57.8 steps/s
[Step=22250 Epoch=43.4] | Loss=0.00964 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.834 | L2-Norm(final)=3.051 | 3721.8 samples/s | 58.2 steps/s
[Step=22300 Epoch=43.5] | Loss=0.00943 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.834 | L2-Norm(final)=3.052 | 3734.3 samples/s | 58.3 steps/s
[Step=22350 Epoch=43.6] | Loss=0.00926 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.833 | L2-Norm(final)=3.053 | 3725.8 samples/s | 58.2 steps/s
[Step=22400 Epoch=43.7] | Loss=0.00906 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.833 | L2-Norm(final)=3.054 | 3737.6 samples/s | 58.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step22400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=19201 Epoch=73.6] | Loss=0.04325 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.868 | L2-Norm(final)=3.043 | 3969.1 samples/s | 62.0 steps/s
[Step=19250 Epoch=73.8] | Loss=0.01050 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.839 | L2-Norm(final)=3.044 | 3174.8 samples/s | 49.6 steps/s
[Step=19300 Epoch=74.0] | Loss=0.00530 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.831 | L2-Norm(final)=3.044 | 3541.1 samples/s | 55.3 steps/s
[Step=19350 Epoch=74.1] | Loss=0.00355 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.044 | 3531.0 samples/s | 55.2 steps/s
[Step=19400 Epoch=74.3] | Loss=0.00268 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.823 | L2-Norm(final)=3.044 | 3550.4 samples/s | 55.5 steps/s
[Step=19450 Epoch=74.5] | Loss=0.00216 | Reg=0.00318 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.820 | L2-Norm(final)=3.044 | 4240.9 samples/s | 66.3 steps/s
[Step=19500 Epoch=74.7] | Loss=0.00180 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.818 | L2-Norm(final)=3.045 | 1602.5 samples/s | 25.0 steps/s
[Step=19550 Epoch=74.9] | Loss=0.00155 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.815 | L2-Norm(final)=3.045 | 3520.6 samples/s | 55.0 steps/s
[Step=19600 Epoch=75.1] | Loss=0.00136 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.813 | L2-Norm(final)=3.045 | 3503.2 samples/s | 54.7 steps/s
[Step=19650 Epoch=75.3] | Loss=0.00121 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.812 | L2-Norm(final)=3.045 | 3502.8 samples/s | 54.7 steps/s
[Step=19700 Epoch=75.5] | Loss=0.00109 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.810 | L2-Norm(final)=3.045 | 3814.7 samples/s | 59.6 steps/s
[Step=19750 Epoch=75.7] | Loss=0.00100 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.808 | L2-Norm(final)=3.045 | 1674.0 samples/s | 26.2 steps/s
[Step=19800 Epoch=75.9] | Loss=0.00092 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.807 | L2-Norm(final)=3.045 | 3508.8 samples/s | 54.8 steps/s
[Step=19850 Epoch=76.1] | Loss=0.00085 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.805 | L2-Norm(final)=3.045 | 3523.8 samples/s | 55.1 steps/s
[Step=19900 Epoch=76.2] | Loss=0.00079 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.804 | L2-Norm(final)=3.045 | 3494.8 samples/s | 54.6 steps/s
[Step=19950 Epoch=76.4] | Loss=0.00074 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.803 | L2-Norm(final)=3.045 | 3518.2 samples/s | 55.0 steps/s
[Step=20000 Epoch=76.6] | Loss=0.00070 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.801 | L2-Norm(final)=3.045 | 1709.3 samples/s | 26.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27752 | acc=0.8494 | tpr=0.7831 | fpr=0.0067 | 3829.9 samples/s | 15.0 steps/s
Avg test loss: 0.28316, Avg test acc: 0.84823, Avg tpr: 0.78330, Avg fpr: 0.00897, total FA: 70

Testing server on iccad2012
[Step=  50] | Loss=0.48164 | acc=0.8517 | tpr=0.9823 | fpr=0.1506 | 3821.0 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.49678 | acc=0.8502 | tpr=0.9829 | fpr=0.1522 | 7331.3 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.50544 | acc=0.8485 | tpr=0.9827 | fpr=0.1539 | 7235.3 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.50946 | acc=0.8484 | tpr=0.9814 | fpr=0.1540 | 7279.4 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.50483 | acc=0.8488 | tpr=0.9782 | fpr=0.1535 | 7363.6 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.50377 | acc=0.8496 | tpr=0.9804 | fpr=0.1528 | 7206.7 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.50360 | acc=0.8497 | tpr=0.9787 | fpr=0.1526 | 7139.6 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.50295 | acc=0.8498 | tpr=0.9809 | fpr=0.1525 | 7243.8 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.50696 | acc=0.8489 | tpr=0.9820 | fpr=0.1535 | 7205.9 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.50667 | acc=0.8487 | tpr=0.9815 | fpr=0.1537 | 7170.1 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.50442 | acc=0.8491 | tpr=0.9813 | fpr=0.1533 | 13513.9 samples/s | 52.8 steps/s
Avg test loss: 0.50415, Avg test acc: 0.84911, Avg tpr: 0.98138, Avg fpr: 0.15329, total FA: 21284

server round 49/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=22401 Epoch=43.7] | Loss=0.17829 | Reg=0.00318 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=17.832 | L2-Norm(final)=3.051 | 3458.6 samples/s | 54.0 steps/s
[Step=22450 Epoch=43.8] | Loss=0.02923 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.816 | L2-Norm(final)=3.050 | 3611.1 samples/s | 56.4 steps/s
[Step=22500 Epoch=43.9] | Loss=0.01862 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.810 | L2-Norm(final)=3.050 | 3744.6 samples/s | 58.5 steps/s
[Step=22550 Epoch=44.0] | Loss=0.01540 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.807 | L2-Norm(final)=3.051 | 3756.3 samples/s | 58.7 steps/s
[Step=22600 Epoch=44.1] | Loss=0.01361 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.805 | L2-Norm(final)=3.052 | 3753.5 samples/s | 58.6 steps/s
[Step=22650 Epoch=44.2] | Loss=0.01233 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.803 | L2-Norm(final)=3.053 | 3749.1 samples/s | 58.6 steps/s
[Step=22700 Epoch=44.3] | Loss=0.01178 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.802 | L2-Norm(final)=3.054 | 3755.9 samples/s | 58.7 steps/s
[Step=22750 Epoch=44.4] | Loss=0.01135 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.801 | L2-Norm(final)=3.055 | 3743.2 samples/s | 58.5 steps/s
[Step=22800 Epoch=44.5] | Loss=0.01101 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.801 | L2-Norm(final)=3.056 | 3759.0 samples/s | 58.7 steps/s
[Step=22850 Epoch=44.6] | Loss=0.01082 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.800 | L2-Norm(final)=3.057 | 3742.0 samples/s | 58.5 steps/s
[Step=22900 Epoch=44.7] | Loss=0.01060 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.800 | L2-Norm(final)=3.057 | 4359.4 samples/s | 68.1 steps/s
[Step=22950 Epoch=44.8] | Loss=0.01010 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.799 | L2-Norm(final)=3.058 | 1628.9 samples/s | 25.5 steps/s
[Step=23000 Epoch=44.9] | Loss=0.00979 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.799 | L2-Norm(final)=3.059 | 3742.1 samples/s | 58.5 steps/s
[Step=23050 Epoch=45.0] | Loss=0.00951 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.799 | L2-Norm(final)=3.060 | 3745.5 samples/s | 58.5 steps/s
[Step=23100 Epoch=45.1] | Loss=0.00940 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.799 | L2-Norm(final)=3.061 | 3732.9 samples/s | 58.3 steps/s
[Step=23150 Epoch=45.2] | Loss=0.00914 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.798 | L2-Norm(final)=3.062 | 3742.7 samples/s | 58.5 steps/s
[Step=23200 Epoch=45.2] | Loss=0.00894 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.798 | L2-Norm(final)=3.063 | 3753.7 samples/s | 58.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_asml1_0/client_state-step23200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=20001 Epoch=76.6] | Loss=0.17152 | Reg=0.00318 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.832 | L2-Norm(final)=3.051 | 3627.8 samples/s | 56.7 steps/s
[Step=20050 Epoch=76.8] | Loss=0.00898 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.801 | L2-Norm(final)=3.052 | 3413.4 samples/s | 53.3 steps/s
[Step=20100 Epoch=77.0] | Loss=0.00458 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.794 | L2-Norm(final)=3.052 | 3522.2 samples/s | 55.0 steps/s
[Step=20150 Epoch=77.2] | Loss=0.00308 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.789 | L2-Norm(final)=3.052 | 3522.3 samples/s | 55.0 steps/s
[Step=20200 Epoch=77.4] | Loss=0.00233 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.786 | L2-Norm(final)=3.052 | 3519.5 samples/s | 55.0 steps/s
[Step=20250 Epoch=77.6] | Loss=0.00187 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.783 | L2-Norm(final)=3.052 | 4228.1 samples/s | 66.1 steps/s
[Step=20300 Epoch=77.8] | Loss=0.00157 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.780 | L2-Norm(final)=3.052 | 1618.2 samples/s | 25.3 steps/s
[Step=20350 Epoch=78.0] | Loss=0.00135 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.778 | L2-Norm(final)=3.052 | 3522.7 samples/s | 55.0 steps/s
[Step=20400 Epoch=78.2] | Loss=0.00118 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.776 | L2-Norm(final)=3.053 | 3543.3 samples/s | 55.4 steps/s
[Step=20450 Epoch=78.4] | Loss=0.00106 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.774 | L2-Norm(final)=3.053 | 3528.5 samples/s | 55.1 steps/s
[Step=20500 Epoch=78.5] | Loss=0.00095 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.773 | L2-Norm(final)=3.053 | 3837.6 samples/s | 60.0 steps/s
[Step=20550 Epoch=78.7] | Loss=0.00087 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.771 | L2-Norm(final)=3.053 | 1690.5 samples/s | 26.4 steps/s
[Step=20600 Epoch=78.9] | Loss=0.00080 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.770 | L2-Norm(final)=3.053 | 3552.6 samples/s | 55.5 steps/s
[Step=20650 Epoch=79.1] | Loss=0.00074 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.768 | L2-Norm(final)=3.053 | 3519.6 samples/s | 55.0 steps/s
[Step=20700 Epoch=79.3] | Loss=0.00069 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.767 | L2-Norm(final)=3.053 | 3523.4 samples/s | 55.1 steps/s
[Step=20750 Epoch=79.5] | Loss=0.00064 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.766 | L2-Norm(final)=3.053 | 3543.1 samples/s | 55.4 steps/s
[Step=20800 Epoch=79.7] | Loss=0.00061 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.765 | L2-Norm(final)=3.053 | 1735.3 samples/s | 27.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel0.5-l2fp1e-3-withl2/client_iccad2012_0/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26478 | acc=0.8552 | tpr=0.7920 | fpr=0.0074 | 3815.1 samples/s | 14.9 steps/s
Avg test loss: 0.27076, Avg test acc: 0.85432, Avg tpr: 0.79250, Avg fpr: 0.00974, total FA: 76

Testing server on iccad2012
[Step=  50] | Loss=0.49968 | acc=0.8470 | tpr=0.9823 | fpr=0.1554 | 3808.6 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.51563 | acc=0.8452 | tpr=0.9829 | fpr=0.1574 | 7224.8 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.52480 | acc=0.8436 | tpr=0.9827 | fpr=0.1589 | 7268.0 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.52867 | acc=0.8437 | tpr=0.9814 | fpr=0.1588 | 7911.3 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.52385 | acc=0.8442 | tpr=0.9790 | fpr=0.1582 | 6953.8 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.52274 | acc=0.8449 | tpr=0.9811 | fpr=0.1575 | 7178.6 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.52254 | acc=0.8451 | tpr=0.9800 | fpr=0.1574 | 7517.1 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.52187 | acc=0.8452 | tpr=0.9819 | fpr=0.1573 | 7050.2 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.52614 | acc=0.8443 | tpr=0.9825 | fpr=0.1582 | 7091.3 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.52585 | acc=0.8440 | tpr=0.9824 | fpr=0.1585 | 7337.9 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.52358 | acc=0.8444 | tpr=0.9825 | fpr=0.1581 | 12651.6 samples/s | 49.4 steps/s
Avg test loss: 0.52333, Avg test acc: 0.84442, Avg tpr: 0.98257, Avg fpr: 0.15809, total FA: 21951
