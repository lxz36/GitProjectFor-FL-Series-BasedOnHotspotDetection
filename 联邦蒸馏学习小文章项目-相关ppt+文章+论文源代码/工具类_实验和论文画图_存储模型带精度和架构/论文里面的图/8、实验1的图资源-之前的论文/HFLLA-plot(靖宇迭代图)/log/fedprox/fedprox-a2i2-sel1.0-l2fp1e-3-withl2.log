#clients of iccad2012: 2
#clients of asml1: 2
select ratio: 1.0
Total num clients: 4
client model path: ['models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0', 'models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1', 'models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0', 'models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32814, 144, 32)
Using transform option: train
#pos = 17102, #neg = 15712
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32737, 144, 32)
Using transform option: train
#pos = 17179, #neg = 15558
loading data into the main memory...
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16703, 144, 32)
Using transform option: train
#pos = 8134, #neg = 8569
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16626, 144, 32)
Using transform option: train
#pos = 8099, #neg = 8527
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.41446 | Reg=0.00358 | FP-Reg=0.000 | acc=0.4375 | L2-Norm=18.915 | L2-Norm(final)=1.935 | 2652.3 samples/s | 41.4 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.30241 | Reg=0.00357 | FP-Reg=0.002 | acc=0.8281 | L2-Norm=18.905 | L2-Norm(final)=1.927 | 3562.0 samples/s | 55.7 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.24768 | Reg=0.00359 | FP-Reg=0.004 | acc=0.8594 | L2-Norm=18.936 | L2-Norm(final)=1.940 | 3495.4 samples/s | 54.6 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.22035 | Reg=0.00360 | FP-Reg=0.005 | acc=0.8281 | L2-Norm=18.961 | L2-Norm(final)=1.951 | 3481.1 samples/s | 54.4 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.20279 | Reg=0.00360 | FP-Reg=0.006 | acc=0.8906 | L2-Norm=18.985 | L2-Norm(final)=1.961 | 3484.9 samples/s | 54.5 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.19086 | Reg=0.00361 | FP-Reg=0.007 | acc=0.8906 | L2-Norm=19.005 | L2-Norm(final)=1.969 | 3452.1 samples/s | 53.9 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.18099 | Reg=0.00362 | FP-Reg=0.007 | acc=0.9062 | L2-Norm=19.023 | L2-Norm(final)=1.976 | 3494.6 samples/s | 54.6 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.17306 | Reg=0.00363 | FP-Reg=0.008 | acc=0.9531 | L2-Norm=19.040 | L2-Norm(final)=1.982 | 3478.3 samples/s | 54.3 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.16559 | Reg=0.00363 | FP-Reg=0.009 | acc=0.9375 | L2-Norm=19.056 | L2-Norm(final)=1.989 | 3466.1 samples/s | 54.2 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.15958 | Reg=0.00364 | FP-Reg=0.009 | acc=0.8750 | L2-Norm=19.072 | L2-Norm(final)=1.996 | 3478.9 samples/s | 54.4 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.15496 | Reg=0.00364 | FP-Reg=0.010 | acc=0.9375 | L2-Norm=19.086 | L2-Norm(final)=2.002 | 4041.2 samples/s | 63.1 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.14903 | Reg=0.00365 | FP-Reg=0.011 | acc=0.9531 | L2-Norm=19.101 | L2-Norm(final)=2.009 | 1615.4 samples/s | 25.2 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.14350 | Reg=0.00365 | FP-Reg=0.011 | acc=0.9531 | L2-Norm=19.116 | L2-Norm(final)=2.016 | 3448.7 samples/s | 53.9 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.13899 | Reg=0.00366 | FP-Reg=0.012 | acc=0.9531 | L2-Norm=19.130 | L2-Norm(final)=2.024 | 3467.4 samples/s | 54.2 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.13500 | Reg=0.00366 | FP-Reg=0.012 | acc=0.9375 | L2-Norm=19.143 | L2-Norm(final)=2.031 | 3468.0 samples/s | 54.2 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.13108 | Reg=0.00367 | FP-Reg=0.013 | acc=0.9531 | L2-Norm=19.156 | L2-Norm(final)=2.037 | 3475.0 samples/s | 54.3 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.12788 | Reg=0.00367 | FP-Reg=0.013 | acc=0.9531 | L2-Norm=19.170 | L2-Norm(final)=2.044 | 3478.1 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.40833 | Reg=0.00358 | FP-Reg=0.000 | acc=0.4219 | L2-Norm=18.915 | L2-Norm(final)=1.935 | 3930.2 samples/s | 61.4 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.29163 | Reg=0.00358 | FP-Reg=0.002 | acc=0.8594 | L2-Norm=18.908 | L2-Norm(final)=1.935 | 3204.2 samples/s | 50.1 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.24063 | Reg=0.00359 | FP-Reg=0.004 | acc=0.9219 | L2-Norm=18.945 | L2-Norm(final)=1.952 | 3460.9 samples/s | 54.1 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.21539 | Reg=0.00360 | FP-Reg=0.005 | acc=0.9062 | L2-Norm=18.973 | L2-Norm(final)=1.966 | 3475.8 samples/s | 54.3 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.20098 | Reg=0.00361 | FP-Reg=0.006 | acc=0.8594 | L2-Norm=18.997 | L2-Norm(final)=1.977 | 3495.2 samples/s | 54.6 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.18802 | Reg=0.00362 | FP-Reg=0.007 | acc=0.9062 | L2-Norm=19.019 | L2-Norm(final)=1.986 | 3498.2 samples/s | 54.7 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.17861 | Reg=0.00362 | FP-Reg=0.008 | acc=0.8594 | L2-Norm=19.038 | L2-Norm(final)=1.995 | 3482.5 samples/s | 54.4 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.17032 | Reg=0.00363 | FP-Reg=0.008 | acc=0.8906 | L2-Norm=19.057 | L2-Norm(final)=2.004 | 3498.9 samples/s | 54.7 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.16256 | Reg=0.00364 | FP-Reg=0.009 | acc=0.9062 | L2-Norm=19.076 | L2-Norm(final)=2.013 | 3488.1 samples/s | 54.5 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.15558 | Reg=0.00365 | FP-Reg=0.010 | acc=0.9531 | L2-Norm=19.093 | L2-Norm(final)=2.022 | 3470.3 samples/s | 54.2 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.15133 | Reg=0.00365 | FP-Reg=0.010 | acc=0.9219 | L2-Norm=19.110 | L2-Norm(final)=2.028 | 4089.1 samples/s | 63.9 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.14403 | Reg=0.00366 | FP-Reg=0.011 | acc=0.9844 | L2-Norm=19.126 | L2-Norm(final)=2.036 | 1600.2 samples/s | 25.0 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.13920 | Reg=0.00366 | FP-Reg=0.011 | acc=0.9531 | L2-Norm=19.141 | L2-Norm(final)=2.044 | 3435.7 samples/s | 53.7 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.13407 | Reg=0.00367 | FP-Reg=0.012 | acc=0.9375 | L2-Norm=19.156 | L2-Norm(final)=2.052 | 3463.9 samples/s | 54.1 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.13047 | Reg=0.00368 | FP-Reg=0.012 | acc=0.9375 | L2-Norm=19.170 | L2-Norm(final)=2.059 | 3458.1 samples/s | 54.0 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.12721 | Reg=0.00368 | FP-Reg=0.013 | acc=0.9062 | L2-Norm=19.184 | L2-Norm(final)=2.066 | 3416.2 samples/s | 53.4 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.12406 | Reg=0.00369 | FP-Reg=0.013 | acc=0.9219 | L2-Norm=19.196 | L2-Norm(final)=2.072 | 3473.3 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.50115 | Reg=0.00358 | FP-Reg=0.000 | acc=0.4844 | L2-Norm=18.915 | L2-Norm(final)=1.934 | 3596.0 samples/s | 56.2 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.18402 | Reg=0.00359 | FP-Reg=0.003 | acc=0.9062 | L2-Norm=18.954 | L2-Norm(final)=1.950 | 3199.2 samples/s | 50.0 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.11548 | Reg=0.00361 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=18.994 | L2-Norm(final)=1.968 | 3331.1 samples/s | 52.0 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.08339 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.015 | L2-Norm(final)=1.985 | 3343.8 samples/s | 52.2 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.06538 | Reg=0.00362 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.027 | L2-Norm(final)=1.999 | 3343.2 samples/s | 52.2 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.05330 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.034 | L2-Norm(final)=2.010 | 3988.3 samples/s | 62.3 steps/s
[Step= 300 Epoch= 1.1] | Loss=0.04519 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.037 | L2-Norm(final)=2.021 | 1555.6 samples/s | 24.3 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.03929 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.038 | L2-Norm(final)=2.030 | 3326.0 samples/s | 52.0 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.03480 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.038 | L2-Norm(final)=2.038 | 3327.6 samples/s | 52.0 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.03133 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.038 | L2-Norm(final)=2.045 | 3308.4 samples/s | 51.7 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.02878 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.038 | L2-Norm(final)=2.052 | 3585.2 samples/s | 56.0 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.02625 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.038 | L2-Norm(final)=2.058 | 1613.8 samples/s | 25.2 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.02411 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.036 | L2-Norm(final)=2.064 | 3336.0 samples/s | 52.1 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.02234 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.033 | L2-Norm(final)=2.070 | 3307.1 samples/s | 51.7 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.02082 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.030 | L2-Norm(final)=2.076 | 3296.9 samples/s | 51.5 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.01949 | Reg=0.00362 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.027 | L2-Norm(final)=2.081 | 3314.2 samples/s | 51.8 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.01981 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.028 | L2-Norm(final)=2.085 | 1653.6 samples/s | 25.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.46437 | Reg=0.00358 | FP-Reg=0.000 | acc=0.5312 | L2-Norm=18.915 | L2-Norm(final)=1.933 | 3878.2 samples/s | 60.6 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.15452 | Reg=0.00359 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=18.958 | L2-Norm(final)=1.959 | 3009.7 samples/s | 47.0 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.09826 | Reg=0.00361 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=18.999 | L2-Norm(final)=1.980 | 3337.3 samples/s | 52.1 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.07131 | Reg=0.00362 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.019 | L2-Norm(final)=1.996 | 3307.1 samples/s | 51.7 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.05665 | Reg=0.00362 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.029 | L2-Norm(final)=2.008 | 3299.0 samples/s | 51.5 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.04763 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.036 | L2-Norm(final)=2.017 | 4054.8 samples/s | 63.4 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.04060 | Reg=0.00363 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.041 | L2-Norm(final)=2.025 | 1549.8 samples/s | 24.2 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.03508 | Reg=0.00363 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.042 | L2-Norm(final)=2.033 | 3323.5 samples/s | 51.9 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.03122 | Reg=0.00363 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.042 | L2-Norm(final)=2.041 | 3317.4 samples/s | 51.8 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.02807 | Reg=0.00363 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.042 | L2-Norm(final)=2.049 | 3311.7 samples/s | 51.7 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.02550 | Reg=0.00363 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.041 | L2-Norm(final)=2.056 | 3669.6 samples/s | 57.3 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.02333 | Reg=0.00363 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.040 | L2-Norm(final)=2.063 | 1591.7 samples/s | 24.9 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.02147 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.038 | L2-Norm(final)=2.070 | 3309.7 samples/s | 51.7 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.01990 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.036 | L2-Norm(final)=2.076 | 3293.3 samples/s | 51.5 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.01856 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.033 | L2-Norm(final)=2.082 | 3309.1 samples/s | 51.7 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.01750 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.031 | L2-Norm(final)=2.088 | 3329.5 samples/s | 52.0 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.01668 | Reg=0.00362 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.030 | L2-Norm(final)=2.094 | 1667.3 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30097 | acc=0.6736 | tpr=0.6925 | fpr=0.3674 | 3629.6 samples/s | 14.2 steps/s
Avg test loss: 0.29996, Avg test acc: 0.67489, Avg tpr: 0.69097, Avg fpr: 0.36047, total FA: 2812

Testing server on iccad2012
[Step=  50] | Loss=0.30098 | acc=0.7317 | tpr=0.9690 | fpr=0.2725 | 3642.4 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.29988 | acc=0.7357 | tpr=0.9765 | fpr=0.2688 | 6918.9 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.30060 | acc=0.7334 | tpr=0.9640 | fpr=0.2709 | 6756.5 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.30042 | acc=0.7337 | tpr=0.9683 | fpr=0.2705 | 6838.3 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.30020 | acc=0.7339 | tpr=0.9686 | fpr=0.2704 | 6857.6 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.30033 | acc=0.7337 | tpr=0.9673 | fpr=0.2705 | 6805.2 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.30014 | acc=0.7336 | tpr=0.9668 | fpr=0.2706 | 7043.4 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.30048 | acc=0.7328 | tpr=0.9639 | fpr=0.2714 | 6765.3 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.30080 | acc=0.7320 | tpr=0.9659 | fpr=0.2722 | 6472.6 samples/s | 25.3 steps/s
[Step= 500] | Loss=0.30080 | acc=0.7316 | tpr=0.9670 | fpr=0.2726 | 6835.7 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.30055 | acc=0.7319 | tpr=0.9670 | fpr=0.2724 | 12720.6 samples/s | 49.7 steps/s
Avg test loss: 0.30052, Avg test acc: 0.73192, Avg tpr: 0.96712, Avg fpr: 0.27236, total FA: 37816

server round 1/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 1.6] | Loss=0.32051 | Reg=0.00361 | FP-Reg=0.000 | acc=0.7031 | L2-Norm=19.000 | L2-Norm(final)=2.129 | 3512.8 samples/s | 54.9 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.16687 | Reg=0.00363 | FP-Reg=0.004 | acc=0.8906 | L2-Norm=19.052 | L2-Norm(final)=2.126 | 3330.5 samples/s | 52.0 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.14210 | Reg=0.00364 | FP-Reg=0.004 | acc=0.8594 | L2-Norm=19.066 | L2-Norm(final)=2.137 | 3415.8 samples/s | 53.4 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.13237 | Reg=0.00364 | FP-Reg=0.005 | acc=0.9219 | L2-Norm=19.080 | L2-Norm(final)=2.146 | 3488.3 samples/s | 54.5 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.12676 | Reg=0.00365 | FP-Reg=0.005 | acc=0.9062 | L2-Norm=19.096 | L2-Norm(final)=2.153 | 3487.9 samples/s | 54.5 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.12119 | Reg=0.00365 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.113 | L2-Norm(final)=2.160 | 3488.6 samples/s | 54.5 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.11497 | Reg=0.00366 | FP-Reg=0.006 | acc=0.8906 | L2-Norm=19.128 | L2-Norm(final)=2.166 | 3483.9 samples/s | 54.4 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.11079 | Reg=0.00366 | FP-Reg=0.006 | acc=0.9062 | L2-Norm=19.143 | L2-Norm(final)=2.173 | 3492.0 samples/s | 54.6 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.10683 | Reg=0.00367 | FP-Reg=0.006 | acc=0.9062 | L2-Norm=19.156 | L2-Norm(final)=2.179 | 3454.7 samples/s | 54.0 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.10375 | Reg=0.00367 | FP-Reg=0.007 | acc=0.8594 | L2-Norm=19.169 | L2-Norm(final)=2.185 | 3487.1 samples/s | 54.5 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.10134 | Reg=0.00368 | FP-Reg=0.007 | acc=0.9688 | L2-Norm=19.182 | L2-Norm(final)=2.190 | 4068.1 samples/s | 63.6 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.09776 | Reg=0.00368 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.193 | L2-Norm(final)=2.195 | 1583.1 samples/s | 24.7 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.09449 | Reg=0.00369 | FP-Reg=0.008 | acc=0.9219 | L2-Norm=19.206 | L2-Norm(final)=2.201 | 3454.3 samples/s | 54.0 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.09252 | Reg=0.00369 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.219 | L2-Norm(final)=2.207 | 3461.3 samples/s | 54.1 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.08980 | Reg=0.00370 | FP-Reg=0.008 | acc=0.9531 | L2-Norm=19.232 | L2-Norm(final)=2.212 | 3445.6 samples/s | 53.8 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.08820 | Reg=0.00370 | FP-Reg=0.009 | acc=0.9062 | L2-Norm=19.243 | L2-Norm(final)=2.217 | 3462.2 samples/s | 54.1 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.08681 | Reg=0.00371 | FP-Reg=0.009 | acc=0.9531 | L2-Norm=19.254 | L2-Norm(final)=2.222 | 3468.1 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step1600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 1.6] | Loss=0.32313 | Reg=0.00361 | FP-Reg=0.000 | acc=0.5625 | L2-Norm=19.000 | L2-Norm(final)=2.130 | 3731.1 samples/s | 58.3 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.16285 | Reg=0.00363 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.041 | L2-Norm(final)=2.141 | 3356.9 samples/s | 52.5 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.14378 | Reg=0.00363 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.059 | L2-Norm(final)=2.146 | 3480.6 samples/s | 54.4 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.13505 | Reg=0.00364 | FP-Reg=0.004 | acc=0.8125 | L2-Norm=19.076 | L2-Norm(final)=2.153 | 3491.4 samples/s | 54.6 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.12741 | Reg=0.00365 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.094 | L2-Norm(final)=2.158 | 3488.4 samples/s | 54.5 steps/s
[Step=1050 Epoch= 2.1] | Loss=0.12009 | Reg=0.00365 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.111 | L2-Norm(final)=2.164 | 3484.8 samples/s | 54.5 steps/s
[Step=1100 Epoch= 2.2] | Loss=0.11517 | Reg=0.00366 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.126 | L2-Norm(final)=2.169 | 3496.6 samples/s | 54.6 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.11001 | Reg=0.00366 | FP-Reg=0.006 | acc=0.8906 | L2-Norm=19.140 | L2-Norm(final)=2.175 | 3498.3 samples/s | 54.7 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.10559 | Reg=0.00367 | FP-Reg=0.006 | acc=0.9375 | L2-Norm=19.153 | L2-Norm(final)=2.180 | 3488.3 samples/s | 54.5 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.10300 | Reg=0.00367 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.166 | L2-Norm(final)=2.184 | 3493.7 samples/s | 54.6 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.10069 | Reg=0.00368 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.179 | L2-Norm(final)=2.188 | 4084.9 samples/s | 63.8 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.09690 | Reg=0.00368 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.190 | L2-Norm(final)=2.192 | 1590.4 samples/s | 24.8 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.09371 | Reg=0.00369 | FP-Reg=0.007 | acc=0.9688 | L2-Norm=19.203 | L2-Norm(final)=2.198 | 3461.1 samples/s | 54.1 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.09122 | Reg=0.00369 | FP-Reg=0.008 | acc=0.9688 | L2-Norm=19.215 | L2-Norm(final)=2.203 | 3466.1 samples/s | 54.2 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.08844 | Reg=0.00370 | FP-Reg=0.008 | acc=0.9219 | L2-Norm=19.226 | L2-Norm(final)=2.209 | 3474.5 samples/s | 54.3 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.08644 | Reg=0.00370 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.237 | L2-Norm(final)=2.214 | 3476.7 samples/s | 54.3 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.08476 | Reg=0.00370 | FP-Reg=0.008 | acc=0.9531 | L2-Norm=19.247 | L2-Norm(final)=2.218 | 3487.1 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step1600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.1] | Loss=0.18470 | Reg=0.00361 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.000 | L2-Norm(final)=2.130 | 3720.5 samples/s | 58.1 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.07318 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.123 | L2-Norm(final)=2.132 | 2990.1 samples/s | 46.7 steps/s
[Step= 900 Epoch= 3.4] | Loss=0.04311 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.159 | L2-Norm(final)=2.134 | 3290.2 samples/s | 51.4 steps/s
[Step= 950 Epoch= 3.6] | Loss=0.03079 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.159 | L2-Norm(final)=2.141 | 3299.8 samples/s | 51.6 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02480 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.153 | L2-Norm(final)=2.147 | 3301.0 samples/s | 51.6 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.02075 | Reg=0.00367 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.153 | 3968.1 samples/s | 62.0 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01759 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.142 | L2-Norm(final)=2.159 | 1561.6 samples/s | 24.4 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01519 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.135 | L2-Norm(final)=2.165 | 3313.1 samples/s | 51.8 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01338 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.128 | L2-Norm(final)=2.171 | 3330.6 samples/s | 52.0 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01201 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.121 | L2-Norm(final)=2.176 | 3332.7 samples/s | 52.1 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.01091 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.115 | L2-Norm(final)=2.181 | 3581.6 samples/s | 56.0 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00996 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.109 | L2-Norm(final)=2.186 | 1597.6 samples/s | 25.0 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00916 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.103 | L2-Norm(final)=2.190 | 3327.2 samples/s | 52.0 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00847 | Reg=0.00365 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.097 | L2-Norm(final)=2.195 | 3323.5 samples/s | 51.9 steps/s
[Step=1500 Epoch= 5.7] | Loss=0.00789 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.091 | L2-Norm(final)=2.198 | 3299.4 samples/s | 51.6 steps/s
[Step=1550 Epoch= 5.9] | Loss=0.00740 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.085 | L2-Norm(final)=2.202 | 3302.6 samples/s | 51.6 steps/s
[Step=1600 Epoch= 6.1] | Loss=0.00698 | Reg=0.00364 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.080 | L2-Norm(final)=2.206 | 1650.8 samples/s | 25.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step1600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.1] | Loss=0.17840 | Reg=0.00361 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.000 | L2-Norm(final)=2.131 | 3834.9 samples/s | 59.9 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.07807 | Reg=0.00366 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.137 | L2-Norm(final)=2.138 | 3038.5 samples/s | 47.5 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.04634 | Reg=0.00369 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.212 | L2-Norm(final)=2.138 | 3314.9 samples/s | 51.8 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.03251 | Reg=0.00369 | FP-Reg=0.008 | acc=0.9844 | L2-Norm=19.217 | L2-Norm(final)=2.145 | 3256.4 samples/s | 50.9 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02502 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.210 | L2-Norm(final)=2.154 | 3316.9 samples/s | 51.8 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.02080 | Reg=0.00369 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.200 | L2-Norm(final)=2.162 | 4036.8 samples/s | 63.1 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01750 | Reg=0.00368 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.188 | L2-Norm(final)=2.168 | 1562.3 samples/s | 24.4 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01510 | Reg=0.00368 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.176 | L2-Norm(final)=2.173 | 3307.8 samples/s | 51.7 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01341 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.166 | L2-Norm(final)=2.178 | 3257.7 samples/s | 50.9 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01199 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.156 | L2-Norm(final)=2.183 | 3231.5 samples/s | 50.5 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.01106 | Reg=0.00367 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.188 | 3621.6 samples/s | 56.6 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.01011 | Reg=0.00366 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.141 | L2-Norm(final)=2.192 | 1621.8 samples/s | 25.3 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00931 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.196 | 3325.2 samples/s | 52.0 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00862 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.127 | L2-Norm(final)=2.200 | 3302.1 samples/s | 51.6 steps/s
[Step=1500 Epoch= 5.8] | Loss=0.00803 | Reg=0.00366 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.120 | L2-Norm(final)=2.203 | 3304.2 samples/s | 51.6 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.00753 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.114 | L2-Norm(final)=2.207 | 3374.7 samples/s | 52.7 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.00708 | Reg=0.00365 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.108 | L2-Norm(final)=2.211 | 1655.0 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22352 | acc=0.7905 | tpr=0.7621 | fpr=0.1479 | 3692.8 samples/s | 14.4 steps/s
Avg test loss: 0.22488, Avg test acc: 0.78921, Avg tpr: 0.76033, Avg fpr: 0.14729, total FA: 1149

Testing server on iccad2012
[Step=  50] | Loss=0.36277 | acc=0.7027 | tpr=0.9646 | fpr=0.3020 | 3599.2 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.36003 | acc=0.7037 | tpr=0.9744 | fpr=0.3013 | 6822.6 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.36111 | acc=0.7014 | tpr=0.9726 | fpr=0.3036 | 7171.5 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.36077 | acc=0.7024 | tpr=0.9738 | fpr=0.3025 | 6639.9 samples/s | 25.9 steps/s
[Step= 250] | Loss=0.36171 | acc=0.7012 | tpr=0.9712 | fpr=0.3037 | 6877.4 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.36250 | acc=0.7001 | tpr=0.9680 | fpr=0.3048 | 6797.7 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.36149 | acc=0.7008 | tpr=0.9687 | fpr=0.3040 | 6850.5 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.36223 | acc=0.7000 | tpr=0.9655 | fpr=0.3048 | 6772.5 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.36308 | acc=0.6996 | tpr=0.9674 | fpr=0.3053 | 6740.7 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.36336 | acc=0.6991 | tpr=0.9687 | fpr=0.3058 | 6707.5 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.36267 | acc=0.6997 | tpr=0.9694 | fpr=0.3052 | 11526.2 samples/s | 45.0 steps/s
Avg test loss: 0.36253, Avg test acc: 0.69974, Avg tpr: 0.96949, Avg fpr: 0.30517, total FA: 42372

server round 2/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 3.1] | Loss=0.18847 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.072 | L2-Norm(final)=2.259 | 3376.0 samples/s | 52.7 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.09983 | Reg=0.00365 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.092 | L2-Norm(final)=2.258 | 3446.3 samples/s | 53.8 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.09695 | Reg=0.00365 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.108 | L2-Norm(final)=2.262 | 3484.7 samples/s | 54.4 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.09342 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.122 | L2-Norm(final)=2.268 | 3482.1 samples/s | 54.4 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.08836 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.136 | L2-Norm(final)=2.274 | 3463.0 samples/s | 54.1 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.08547 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.151 | L2-Norm(final)=2.280 | 3475.5 samples/s | 54.3 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.08311 | Reg=0.00367 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.163 | L2-Norm(final)=2.284 | 3478.4 samples/s | 54.4 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.08151 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.176 | L2-Norm(final)=2.287 | 3448.6 samples/s | 53.9 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.08170 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.189 | L2-Norm(final)=2.289 | 3481.1 samples/s | 54.4 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.07962 | Reg=0.00369 | FP-Reg=0.005 | acc=0.9219 | L2-Norm=19.202 | L2-Norm(final)=2.291 | 3490.9 samples/s | 54.5 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.07807 | Reg=0.00369 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.214 | L2-Norm(final)=2.293 | 4068.4 samples/s | 63.6 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.07556 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.227 | L2-Norm(final)=2.295 | 1590.8 samples/s | 24.9 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.07301 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.240 | L2-Norm(final)=2.298 | 3465.3 samples/s | 54.1 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.07134 | Reg=0.00371 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.252 | L2-Norm(final)=2.301 | 3468.2 samples/s | 54.2 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.06991 | Reg=0.00371 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.264 | L2-Norm(final)=2.304 | 3477.9 samples/s | 54.3 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.06859 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.276 | L2-Norm(final)=2.307 | 3455.7 samples/s | 54.0 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.06743 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.286 | L2-Norm(final)=2.310 | 3454.9 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step2400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 3.1] | Loss=0.19371 | Reg=0.00364 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.072 | L2-Norm(final)=2.259 | 3710.8 samples/s | 58.0 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.10674 | Reg=0.00364 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.086 | L2-Norm(final)=2.248 | 3353.3 samples/s | 52.4 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.09306 | Reg=0.00365 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.099 | L2-Norm(final)=2.258 | 3483.1 samples/s | 54.4 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.08618 | Reg=0.00365 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.114 | L2-Norm(final)=2.265 | 3465.1 samples/s | 54.1 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.08628 | Reg=0.00366 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.129 | L2-Norm(final)=2.271 | 3478.6 samples/s | 54.4 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.08367 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.147 | L2-Norm(final)=2.276 | 3469.0 samples/s | 54.2 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.08126 | Reg=0.00367 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.163 | L2-Norm(final)=2.281 | 3465.5 samples/s | 54.1 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.07935 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.178 | L2-Norm(final)=2.285 | 3453.0 samples/s | 54.0 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.07795 | Reg=0.00368 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.193 | L2-Norm(final)=2.290 | 3488.3 samples/s | 54.5 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.07687 | Reg=0.00369 | FP-Reg=0.005 | acc=0.9062 | L2-Norm=19.207 | L2-Norm(final)=2.294 | 3476.0 samples/s | 54.3 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.07521 | Reg=0.00369 | FP-Reg=0.005 | acc=0.9375 | L2-Norm=19.220 | L2-Norm(final)=2.298 | 4095.3 samples/s | 64.0 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.07267 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.232 | L2-Norm(final)=2.301 | 1604.3 samples/s | 25.1 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.07050 | Reg=0.00370 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.244 | L2-Norm(final)=2.306 | 3439.4 samples/s | 53.7 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.06863 | Reg=0.00371 | FP-Reg=0.006 | acc=0.9375 | L2-Norm=19.255 | L2-Norm(final)=2.310 | 3442.6 samples/s | 53.8 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.06706 | Reg=0.00371 | FP-Reg=0.006 | acc=0.9531 | L2-Norm=19.266 | L2-Norm(final)=2.315 | 3453.6 samples/s | 54.0 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.06614 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.278 | L2-Norm(final)=2.319 | 3457.5 samples/s | 54.0 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.06519 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.289 | L2-Norm(final)=2.322 | 3430.5 samples/s | 53.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step2400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 6.1] | Loss=0.16281 | Reg=0.00364 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=19.072 | L2-Norm(final)=2.259 | 3652.1 samples/s | 57.1 steps/s
[Step=1650 Epoch= 6.3] | Loss=0.03640 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.133 | L2-Norm(final)=2.243 | 3174.8 samples/s | 49.6 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.02255 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.141 | L2-Norm(final)=2.240 | 3329.0 samples/s | 52.0 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.01617 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.247 | 3326.1 samples/s | 52.0 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.01393 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.135 | L2-Norm(final)=2.252 | 3315.6 samples/s | 51.8 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.01183 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.257 | 3965.7 samples/s | 62.0 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00999 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.132 | L2-Norm(final)=2.262 | 1545.6 samples/s | 24.1 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00860 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.128 | L2-Norm(final)=2.267 | 3335.5 samples/s | 52.1 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00756 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.123 | L2-Norm(final)=2.272 | 3142.4 samples/s | 49.1 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.00675 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.117 | L2-Norm(final)=2.276 | 2897.4 samples/s | 45.3 steps/s
[Step=2100 Epoch= 8.0] | Loss=0.00610 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.280 | 3188.9 samples/s | 49.8 steps/s
[Step=2150 Epoch= 8.2] | Loss=0.00556 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.107 | L2-Norm(final)=2.284 | 1495.1 samples/s | 23.4 steps/s
[Step=2200 Epoch= 8.4] | Loss=0.00511 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.102 | L2-Norm(final)=2.287 | 3212.8 samples/s | 50.2 steps/s
[Step=2250 Epoch= 8.6] | Loss=0.00473 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.096 | L2-Norm(final)=2.290 | 3245.7 samples/s | 50.7 steps/s
[Step=2300 Epoch= 8.8] | Loss=0.00440 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.092 | L2-Norm(final)=2.293 | 3259.4 samples/s | 50.9 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.00412 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.087 | L2-Norm(final)=2.296 | 3282.0 samples/s | 51.3 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.00388 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.083 | L2-Norm(final)=2.299 | 1649.3 samples/s | 25.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step2400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 6.2] | Loss=0.14909 | Reg=0.00364 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.072 | L2-Norm(final)=2.259 | 3820.7 samples/s | 59.7 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.03224 | Reg=0.00366 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.136 | L2-Norm(final)=2.244 | 2983.5 samples/s | 46.6 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.02210 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.247 | 3294.9 samples/s | 51.5 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.01610 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.252 | 3303.2 samples/s | 51.6 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.01293 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.142 | L2-Norm(final)=2.258 | 3304.1 samples/s | 51.6 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.01073 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.139 | L2-Norm(final)=2.264 | 3988.5 samples/s | 62.3 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00913 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.269 | 1527.6 samples/s | 23.9 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00786 | Reg=0.00366 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=2.275 | 3295.2 samples/s | 51.5 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00691 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.123 | L2-Norm(final)=2.279 | 3293.1 samples/s | 51.5 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.00616 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.117 | L2-Norm(final)=2.283 | 3297.1 samples/s | 51.5 steps/s
[Step=2100 Epoch= 8.1] | Loss=0.00564 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.112 | L2-Norm(final)=2.287 | 3621.1 samples/s | 56.6 steps/s
[Step=2150 Epoch= 8.3] | Loss=0.00515 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.107 | L2-Norm(final)=2.291 | 1612.9 samples/s | 25.2 steps/s
[Step=2200 Epoch= 8.5] | Loss=0.00474 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.102 | L2-Norm(final)=2.294 | 3262.0 samples/s | 51.0 steps/s
[Step=2250 Epoch= 8.7] | Loss=0.00438 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.097 | L2-Norm(final)=2.297 | 3296.4 samples/s | 51.5 steps/s
[Step=2300 Epoch= 8.9] | Loss=0.00408 | Reg=0.00365 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.092 | L2-Norm(final)=2.300 | 3033.9 samples/s | 47.4 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.00382 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.088 | L2-Norm(final)=2.303 | 3069.7 samples/s | 48.0 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.00359 | Reg=0.00364 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.084 | L2-Norm(final)=2.306 | 1637.0 samples/s | 25.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.13972 | acc=0.8824 | tpr=0.8943 | fpr=0.1435 | 3618.0 samples/s | 14.1 steps/s
Avg test loss: 0.14080, Avg test acc: 0.88228, Avg tpr: 0.89410, Avg fpr: 0.14370, total FA: 1121

Testing server on iccad2012
[Step=  50] | Loss=0.59166 | acc=0.5633 | tpr=0.9823 | fpr=0.4443 | 3666.8 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.58982 | acc=0.5658 | tpr=0.9872 | fpr=0.4421 | 6713.7 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.59186 | acc=0.5640 | tpr=0.9885 | fpr=0.4439 | 6879.3 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.59188 | acc=0.5621 | tpr=0.9902 | fpr=0.4457 | 6848.8 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.59332 | acc=0.5603 | tpr=0.9886 | fpr=0.4475 | 6798.0 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.59352 | acc=0.5607 | tpr=0.9862 | fpr=0.4470 | 7053.8 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.59231 | acc=0.5616 | tpr=0.9850 | fpr=0.4461 | 6665.0 samples/s | 26.0 steps/s
[Step= 400] | Loss=0.59368 | acc=0.5605 | tpr=0.9819 | fpr=0.4472 | 6771.3 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.59510 | acc=0.5601 | tpr=0.9820 | fpr=0.4475 | 6900.5 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.59587 | acc=0.5590 | tpr=0.9833 | fpr=0.4486 | 6742.5 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.59453 | acc=0.5594 | tpr=0.9841 | fpr=0.4483 | 12278.9 samples/s | 48.0 steps/s
Avg test loss: 0.59438, Avg test acc: 0.55936, Avg tpr: 0.98415, Avg fpr: 0.44836, total FA: 62254

server round 3/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 4.7] | Loss=0.08629 | Reg=0.00366 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.129 | L2-Norm(final)=2.349 | 3351.5 samples/s | 52.4 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.07985 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.131 | L2-Norm(final)=2.341 | 3460.2 samples/s | 54.1 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.07133 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.143 | L2-Norm(final)=2.347 | 3444.2 samples/s | 53.8 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.07217 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.154 | L2-Norm(final)=2.348 | 3435.8 samples/s | 53.7 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.07075 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.168 | L2-Norm(final)=2.349 | 3469.1 samples/s | 54.2 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.06970 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.181 | L2-Norm(final)=2.351 | 3479.4 samples/s | 54.4 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.06914 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.193 | L2-Norm(final)=2.351 | 3448.6 samples/s | 53.9 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.06837 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.205 | L2-Norm(final)=2.351 | 3485.9 samples/s | 54.5 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.06699 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.217 | L2-Norm(final)=2.352 | 3487.5 samples/s | 54.5 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.06533 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.230 | L2-Norm(final)=2.354 | 3479.7 samples/s | 54.4 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.06440 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.242 | L2-Norm(final)=2.356 | 4042.1 samples/s | 63.2 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.06266 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.253 | L2-Norm(final)=2.358 | 1573.9 samples/s | 24.6 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.06109 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.264 | L2-Norm(final)=2.360 | 3453.5 samples/s | 54.0 steps/s
[Step=3050 Epoch= 5.9] | Loss=0.05950 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.274 | L2-Norm(final)=2.362 | 3479.6 samples/s | 54.4 steps/s
[Step=3100 Epoch= 6.0] | Loss=0.05855 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.284 | L2-Norm(final)=2.364 | 3465.2 samples/s | 54.1 steps/s
[Step=3150 Epoch= 6.1] | Loss=0.05795 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.293 | L2-Norm(final)=2.365 | 3479.3 samples/s | 54.4 steps/s
[Step=3200 Epoch= 6.2] | Loss=0.05676 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.303 | L2-Norm(final)=2.367 | 3472.6 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step3200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 4.7] | Loss=0.15225 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.129 | L2-Norm(final)=2.348 | 3723.0 samples/s | 58.2 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.07269 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.129 | L2-Norm(final)=2.345 | 3353.9 samples/s | 52.4 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.06839 | Reg=0.00366 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.138 | L2-Norm(final)=2.347 | 3477.6 samples/s | 54.3 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.06658 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.153 | L2-Norm(final)=2.355 | 3471.8 samples/s | 54.2 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.06556 | Reg=0.00367 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.166 | L2-Norm(final)=2.359 | 3450.4 samples/s | 53.9 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.06472 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.179 | L2-Norm(final)=2.363 | 3475.9 samples/s | 54.3 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.06397 | Reg=0.00368 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.192 | L2-Norm(final)=2.367 | 3490.5 samples/s | 54.5 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.06386 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.206 | L2-Norm(final)=2.369 | 3471.3 samples/s | 54.2 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.06363 | Reg=0.00369 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.220 | L2-Norm(final)=2.371 | 3470.7 samples/s | 54.2 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.06217 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.231 | L2-Norm(final)=2.373 | 3479.0 samples/s | 54.4 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.06217 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9062 | L2-Norm=19.242 | L2-Norm(final)=2.374 | 4081.5 samples/s | 63.8 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.06061 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.253 | L2-Norm(final)=2.375 | 1599.4 samples/s | 25.0 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.05916 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.264 | L2-Norm(final)=2.378 | 3547.8 samples/s | 55.4 steps/s
[Step=3050 Epoch= 6.0] | Loss=0.05759 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.275 | L2-Norm(final)=2.381 | 3484.8 samples/s | 54.4 steps/s
[Step=3100 Epoch= 6.1] | Loss=0.05664 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.286 | L2-Norm(final)=2.383 | 3482.9 samples/s | 54.4 steps/s
[Step=3150 Epoch= 6.2] | Loss=0.05584 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.296 | L2-Norm(final)=2.385 | 3495.1 samples/s | 54.6 steps/s
[Step=3200 Epoch= 6.3] | Loss=0.05515 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.305 | L2-Norm(final)=2.387 | 3492.4 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step3200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 9.2] | Loss=0.31484 | Reg=0.00366 | FP-Reg=0.000 | acc=0.7812 | L2-Norm=19.129 | L2-Norm(final)=2.347 | 3702.5 samples/s | 57.9 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.03079 | Reg=0.00369 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.215 | L2-Norm(final)=2.314 | 3115.7 samples/s | 48.7 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.02069 | Reg=0.00370 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.224 | L2-Norm(final)=2.310 | 3119.9 samples/s | 48.7 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.01609 | Reg=0.00370 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.224 | L2-Norm(final)=2.311 | 3064.4 samples/s | 47.9 steps/s
[Step=2600 Epoch=10.0] | Loss=0.01291 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.313 | 3096.2 samples/s | 48.4 steps/s
[Step=2650 Epoch=10.2] | Loss=0.01067 | Reg=0.00369 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.214 | L2-Norm(final)=2.318 | 3755.2 samples/s | 58.7 steps/s
[Step=2700 Epoch=10.3] | Loss=0.00897 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.207 | L2-Norm(final)=2.322 | 1541.2 samples/s | 24.1 steps/s
[Step=2750 Epoch=10.5] | Loss=0.00771 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.199 | L2-Norm(final)=2.327 | 3295.8 samples/s | 51.5 steps/s
[Step=2800 Epoch=10.7] | Loss=0.00676 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.331 | 3311.7 samples/s | 51.7 steps/s
[Step=2850 Epoch=10.9] | Loss=0.00607 | Reg=0.00368 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.184 | L2-Norm(final)=2.335 | 3298.9 samples/s | 51.5 steps/s
[Step=2900 Epoch=11.1] | Loss=0.00552 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.177 | L2-Norm(final)=2.339 | 3585.7 samples/s | 56.0 steps/s
[Step=2950 Epoch=11.3] | Loss=0.00503 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.171 | L2-Norm(final)=2.343 | 1599.2 samples/s | 25.0 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00462 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.165 | L2-Norm(final)=2.347 | 3320.2 samples/s | 51.9 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00427 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.159 | L2-Norm(final)=2.350 | 3303.2 samples/s | 51.6 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00398 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.153 | L2-Norm(final)=2.353 | 3302.1 samples/s | 51.6 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00372 | Reg=0.00367 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.356 | 3317.5 samples/s | 51.8 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00350 | Reg=0.00366 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.143 | L2-Norm(final)=2.359 | 1675.5 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step3200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch= 9.2] | Loss=0.26040 | Reg=0.00366 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=19.129 | L2-Norm(final)=2.347 | 3707.8 samples/s | 57.9 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.03059 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.214 | L2-Norm(final)=2.317 | 3219.8 samples/s | 50.3 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.01920 | Reg=0.00370 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.231 | L2-Norm(final)=2.317 | 3333.4 samples/s | 52.1 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.01419 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.320 | 3318.4 samples/s | 51.9 steps/s
[Step=2600 Epoch=10.0] | Loss=0.01135 | Reg=0.00369 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.222 | L2-Norm(final)=2.324 | 3318.7 samples/s | 51.9 steps/s
[Step=2650 Epoch=10.2] | Loss=0.00965 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.216 | L2-Norm(final)=2.327 | 4034.8 samples/s | 63.0 steps/s
[Step=2700 Epoch=10.4] | Loss=0.00879 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.213 | L2-Norm(final)=2.330 | 1540.7 samples/s | 24.1 steps/s
[Step=2750 Epoch=10.6] | Loss=0.00792 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.212 | L2-Norm(final)=2.333 | 3318.7 samples/s | 51.9 steps/s
[Step=2800 Epoch=10.8] | Loss=0.00703 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.210 | L2-Norm(final)=2.336 | 3311.4 samples/s | 51.7 steps/s
[Step=2850 Epoch=11.0] | Loss=0.00632 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.206 | L2-Norm(final)=2.340 | 3274.4 samples/s | 51.2 steps/s
[Step=2900 Epoch=11.2] | Loss=0.00577 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.202 | L2-Norm(final)=2.343 | 3679.4 samples/s | 57.5 steps/s
[Step=2950 Epoch=11.4] | Loss=0.00527 | Reg=0.00369 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.198 | L2-Norm(final)=2.346 | 1589.8 samples/s | 24.8 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00485 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.193 | L2-Norm(final)=2.350 | 3326.2 samples/s | 52.0 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00448 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.189 | L2-Norm(final)=2.353 | 3310.5 samples/s | 51.7 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00417 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.184 | L2-Norm(final)=2.355 | 3304.3 samples/s | 51.6 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00390 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.178 | L2-Norm(final)=2.358 | 3354.3 samples/s | 52.4 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00366 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.173 | L2-Norm(final)=2.360 | 1656.1 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.14449 | acc=0.8795 | tpr=0.8589 | fpr=0.0756 | 3673.6 samples/s | 14.4 steps/s
Avg test loss: 0.14711, Avg test acc: 0.87775, Avg tpr: 0.85831, Avg fpr: 0.07948, total FA: 620

Testing server on iccad2012
[Step=  50] | Loss=0.51255 | acc=0.6493 | tpr=0.9823 | fpr=0.3567 | 3635.5 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.51223 | acc=0.6523 | tpr=0.9872 | fpr=0.3540 | 6717.8 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.51657 | acc=0.6505 | tpr=0.9885 | fpr=0.3557 | 6860.2 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.51679 | acc=0.6491 | tpr=0.9891 | fpr=0.3571 | 6905.4 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.51819 | acc=0.6477 | tpr=0.9869 | fpr=0.3585 | 6938.3 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.51814 | acc=0.6476 | tpr=0.9840 | fpr=0.3585 | 6854.3 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.51702 | acc=0.6483 | tpr=0.9831 | fpr=0.3578 | 6776.1 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.51850 | acc=0.6474 | tpr=0.9809 | fpr=0.3586 | 6799.1 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.51950 | acc=0.6474 | tpr=0.9820 | fpr=0.3587 | 6797.2 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.52025 | acc=0.6465 | tpr=0.9828 | fpr=0.3596 | 6782.0 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.51898 | acc=0.6470 | tpr=0.9833 | fpr=0.3591 | 12806.1 samples/s | 50.0 steps/s
Avg test loss: 0.51883, Avg test acc: 0.64696, Avg tpr: 0.98336, Avg fpr: 0.35916, total FA: 49868

server round 4/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch= 6.2] | Loss=0.07936 | Reg=0.00368 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.170 | L2-Norm(final)=2.398 | 3428.3 samples/s | 53.6 steps/s
[Step=3250 Epoch= 6.3] | Loss=0.06081 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.161 | L2-Norm(final)=2.395 | 3413.2 samples/s | 53.3 steps/s
[Step=3300 Epoch= 6.4] | Loss=0.05856 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.174 | L2-Norm(final)=2.403 | 3457.3 samples/s | 54.0 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.05712 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.186 | L2-Norm(final)=2.402 | 3474.0 samples/s | 54.3 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.05732 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.197 | L2-Norm(final)=2.402 | 3461.3 samples/s | 54.1 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.05668 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.208 | L2-Norm(final)=2.402 | 3452.4 samples/s | 53.9 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.05734 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.220 | L2-Norm(final)=2.401 | 3465.4 samples/s | 54.1 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.05763 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.233 | L2-Norm(final)=2.399 | 3492.6 samples/s | 54.6 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.05720 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.244 | L2-Norm(final)=2.398 | 3488.5 samples/s | 54.5 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.05647 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.255 | L2-Norm(final)=2.397 | 3491.7 samples/s | 54.6 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.05536 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.264 | L2-Norm(final)=2.396 | 4061.2 samples/s | 63.5 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.05430 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.274 | L2-Norm(final)=2.397 | 1591.4 samples/s | 24.9 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.05246 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.284 | L2-Norm(final)=2.398 | 3466.3 samples/s | 54.2 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.05161 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.294 | L2-Norm(final)=2.399 | 3457.1 samples/s | 54.0 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.05069 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.303 | L2-Norm(final)=2.400 | 3450.4 samples/s | 53.9 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.05012 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.311 | L2-Norm(final)=2.401 | 3468.5 samples/s | 54.2 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.04969 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.319 | L2-Norm(final)=2.402 | 3479.6 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch= 6.3] | Loss=0.11728 | Reg=0.00368 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.170 | L2-Norm(final)=2.397 | 3808.9 samples/s | 59.5 steps/s
[Step=3250 Epoch= 6.4] | Loss=0.06521 | Reg=0.00367 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.170 | L2-Norm(final)=2.387 | 3336.6 samples/s | 52.1 steps/s
[Step=3300 Epoch= 6.5] | Loss=0.06313 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.178 | L2-Norm(final)=2.390 | 3482.7 samples/s | 54.4 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.05896 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9062 | L2-Norm=19.188 | L2-Norm(final)=2.394 | 3473.4 samples/s | 54.3 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.05906 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.199 | L2-Norm(final)=2.396 | 3476.2 samples/s | 54.3 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.05785 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.213 | L2-Norm(final)=2.398 | 3469.7 samples/s | 54.2 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.05685 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.227 | L2-Norm(final)=2.400 | 3476.4 samples/s | 54.3 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.05683 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.239 | L2-Norm(final)=2.401 | 3506.0 samples/s | 54.8 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.05760 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.251 | L2-Norm(final)=2.402 | 3503.5 samples/s | 54.7 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.05580 | Reg=0.00371 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.262 | L2-Norm(final)=2.403 | 3453.1 samples/s | 54.0 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.05538 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.272 | L2-Norm(final)=2.405 | 4099.8 samples/s | 64.1 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.05395 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.281 | L2-Norm(final)=2.404 | 1618.6 samples/s | 25.3 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.05296 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.291 | L2-Norm(final)=2.405 | 3478.4 samples/s | 54.3 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.05218 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.300 | L2-Norm(final)=2.406 | 3459.6 samples/s | 54.1 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.05160 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.308 | L2-Norm(final)=2.407 | 3454.0 samples/s | 54.0 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.05078 | Reg=0.00373 | FP-Reg=0.005 | acc=0.9531 | L2-Norm=19.317 | L2-Norm(final)=2.408 | 3480.6 samples/s | 54.4 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.04992 | Reg=0.00374 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.326 | L2-Norm(final)=2.409 | 3466.5 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step4000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=12.3] | Loss=0.16062 | Reg=0.00368 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.170 | L2-Norm(final)=2.398 | 3549.4 samples/s | 55.5 steps/s
[Step=3250 Epoch=12.5] | Loss=0.03299 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.280 | L2-Norm(final)=2.350 | 3270.0 samples/s | 51.1 steps/s
[Step=3300 Epoch=12.6] | Loss=0.02021 | Reg=0.00372 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.285 | L2-Norm(final)=2.345 | 3330.0 samples/s | 52.0 steps/s
[Step=3350 Epoch=12.8] | Loss=0.01447 | Reg=0.00372 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.278 | L2-Norm(final)=2.348 | 3314.7 samples/s | 51.8 steps/s
[Step=3400 Epoch=13.0] | Loss=0.01121 | Reg=0.00371 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.269 | L2-Norm(final)=2.354 | 3325.1 samples/s | 52.0 steps/s
[Step=3450 Epoch=13.2] | Loss=0.00957 | Reg=0.00371 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.259 | L2-Norm(final)=2.360 | 3970.3 samples/s | 62.0 steps/s
[Step=3500 Epoch=13.4] | Loss=0.00825 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.252 | L2-Norm(final)=2.364 | 1562.6 samples/s | 24.4 steps/s
[Step=3550 Epoch=13.6] | Loss=0.00718 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.246 | L2-Norm(final)=2.369 | 3327.6 samples/s | 52.0 steps/s
[Step=3600 Epoch=13.8] | Loss=0.00632 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.239 | L2-Norm(final)=2.374 | 3265.7 samples/s | 51.0 steps/s
[Step=3650 Epoch=14.0] | Loss=0.00567 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.232 | L2-Norm(final)=2.379 | 3304.2 samples/s | 51.6 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00515 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.225 | L2-Norm(final)=2.383 | 3604.3 samples/s | 56.3 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00469 | Reg=0.00369 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.219 | L2-Norm(final)=2.387 | 1621.0 samples/s | 25.3 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00430 | Reg=0.00369 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.212 | L2-Norm(final)=2.391 | 3341.7 samples/s | 52.2 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00397 | Reg=0.00369 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.206 | L2-Norm(final)=2.394 | 3319.1 samples/s | 51.9 steps/s
[Step=3900 Epoch=14.9] | Loss=0.00370 | Reg=0.00369 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.200 | L2-Norm(final)=2.397 | 3329.2 samples/s | 52.0 steps/s
[Step=3950 Epoch=15.1] | Loss=0.00346 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.194 | L2-Norm(final)=2.400 | 3335.5 samples/s | 52.1 steps/s
[Step=4000 Epoch=15.3] | Loss=0.00324 | Reg=0.00368 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.188 | L2-Norm(final)=2.403 | 1665.5 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step4000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=12.3] | Loss=0.15120 | Reg=0.00368 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.170 | L2-Norm(final)=2.397 | 3802.2 samples/s | 59.4 steps/s
[Step=3250 Epoch=12.5] | Loss=0.03701 | Reg=0.00371 | FP-Reg=0.006 | acc=0.9688 | L2-Norm=19.254 | L2-Norm(final)=2.352 | 3078.6 samples/s | 48.1 steps/s
[Step=3300 Epoch=12.7] | Loss=0.02222 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.265 | L2-Norm(final)=2.348 | 3303.5 samples/s | 51.6 steps/s
[Step=3350 Epoch=12.9] | Loss=0.01558 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.262 | L2-Norm(final)=2.354 | 3297.1 samples/s | 51.5 steps/s
[Step=3400 Epoch=13.1] | Loss=0.01368 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.260 | L2-Norm(final)=2.360 | 3328.5 samples/s | 52.0 steps/s
[Step=3450 Epoch=13.3] | Loss=0.01219 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.260 | L2-Norm(final)=2.364 | 4007.0 samples/s | 62.6 steps/s
[Step=3500 Epoch=13.5] | Loss=0.01101 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.262 | L2-Norm(final)=2.366 | 1561.9 samples/s | 24.4 steps/s
[Step=3550 Epoch=13.7] | Loss=0.00973 | Reg=0.00371 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.264 | L2-Norm(final)=2.370 | 3323.6 samples/s | 51.9 steps/s
[Step=3600 Epoch=13.9] | Loss=0.00857 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.264 | L2-Norm(final)=2.373 | 3331.4 samples/s | 52.1 steps/s
[Step=3650 Epoch=14.1] | Loss=0.00771 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.377 | 3328.3 samples/s | 52.0 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00710 | Reg=0.00371 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.257 | L2-Norm(final)=2.380 | 3644.5 samples/s | 56.9 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00648 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.254 | L2-Norm(final)=2.383 | 1610.6 samples/s | 25.2 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00595 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.249 | L2-Norm(final)=2.386 | 3313.3 samples/s | 51.8 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00550 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.244 | L2-Norm(final)=2.389 | 3334.5 samples/s | 52.1 steps/s
[Step=3900 Epoch=15.0] | Loss=0.00512 | Reg=0.00370 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.239 | L2-Norm(final)=2.392 | 3282.4 samples/s | 51.3 steps/s
[Step=3950 Epoch=15.2] | Loss=0.00478 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.234 | L2-Norm(final)=2.395 | 3365.8 samples/s | 52.6 steps/s
[Step=4000 Epoch=15.4] | Loss=0.00449 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.397 | 1672.9 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.16026 | acc=0.8673 | tpr=0.8302 | fpr=0.0523 | 3569.8 samples/s | 13.9 steps/s
Avg test loss: 0.16206, Avg test acc: 0.86597, Avg tpr: 0.83010, Avg fpr: 0.05512, total FA: 430

Testing server on iccad2012
[Step=  50] | Loss=0.36995 | acc=0.7416 | tpr=0.9602 | fpr=0.2623 | 3664.2 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.37027 | acc=0.7420 | tpr=0.9765 | fpr=0.2624 | 6746.2 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.37345 | acc=0.7409 | tpr=0.9769 | fpr=0.2634 | 6928.0 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.37414 | acc=0.7408 | tpr=0.9792 | fpr=0.2635 | 7018.9 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.37511 | acc=0.7395 | tpr=0.9782 | fpr=0.2649 | 6873.6 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.37561 | acc=0.7396 | tpr=0.9753 | fpr=0.2647 | 6756.0 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.37532 | acc=0.7402 | tpr=0.9743 | fpr=0.2640 | 6913.6 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.37660 | acc=0.7399 | tpr=0.9716 | fpr=0.2643 | 6669.2 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.37761 | acc=0.7399 | tpr=0.9732 | fpr=0.2644 | 7077.9 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.37810 | acc=0.7390 | tpr=0.9744 | fpr=0.2653 | 6588.2 samples/s | 25.7 steps/s
[Step= 550] | Loss=0.37698 | acc=0.7396 | tpr=0.9753 | fpr=0.2647 | 12451.0 samples/s | 48.6 steps/s
Avg test loss: 0.37686, Avg test acc: 0.73962, Avg tpr: 0.97544, Avg fpr: 0.26466, total FA: 36748

server round 5/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.07251 | Reg=0.00369 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.199 | L2-Norm(final)=2.427 | 3600.5 samples/s | 56.3 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.05070 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.193 | L2-Norm(final)=2.426 | 3270.8 samples/s | 51.1 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.05367 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.193 | L2-Norm(final)=2.424 | 3479.5 samples/s | 54.4 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.05281 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.198 | L2-Norm(final)=2.420 | 3473.8 samples/s | 54.3 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.05452 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.207 | L2-Norm(final)=2.419 | 3455.3 samples/s | 54.0 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.05351 | Reg=0.00369 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.218 | L2-Norm(final)=2.417 | 3474.7 samples/s | 54.3 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.05404 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.229 | L2-Norm(final)=2.417 | 3471.0 samples/s | 54.2 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.05316 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.240 | L2-Norm(final)=2.416 | 3475.1 samples/s | 54.3 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.05241 | Reg=0.00371 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.251 | L2-Norm(final)=2.415 | 3479.0 samples/s | 54.4 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.05126 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.263 | L2-Norm(final)=2.416 | 3481.5 samples/s | 54.4 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.05056 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.274 | L2-Norm(final)=2.417 | 4047.0 samples/s | 63.2 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.04966 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.285 | L2-Norm(final)=2.417 | 1572.6 samples/s | 24.6 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.04853 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.295 | L2-Norm(final)=2.418 | 3438.9 samples/s | 53.7 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.04787 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.304 | L2-Norm(final)=2.419 | 3458.1 samples/s | 54.0 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.04714 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.314 | L2-Norm(final)=2.420 | 3463.4 samples/s | 54.1 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.04676 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.322 | L2-Norm(final)=2.419 | 3472.3 samples/s | 54.3 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.04637 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.331 | L2-Norm(final)=2.419 | 3477.0 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step4800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.09940 | Reg=0.00369 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.199 | L2-Norm(final)=2.426 | 3716.7 samples/s | 58.1 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.05927 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.190 | L2-Norm(final)=2.417 | 3322.0 samples/s | 51.9 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.05274 | Reg=0.00368 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.193 | L2-Norm(final)=2.417 | 3465.0 samples/s | 54.1 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.05167 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.202 | L2-Norm(final)=2.423 | 3473.5 samples/s | 54.3 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.05092 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.215 | L2-Norm(final)=2.424 | 3441.5 samples/s | 53.8 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.05059 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.227 | L2-Norm(final)=2.426 | 3402.7 samples/s | 53.2 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.05057 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.240 | L2-Norm(final)=2.429 | 3482.1 samples/s | 54.4 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.04959 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.253 | L2-Norm(final)=2.431 | 3496.7 samples/s | 54.6 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.04936 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9062 | L2-Norm=19.265 | L2-Norm(final)=2.433 | 3485.8 samples/s | 54.5 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.04953 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.276 | L2-Norm(final)=2.434 | 3464.5 samples/s | 54.1 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.04892 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9375 | L2-Norm=19.286 | L2-Norm(final)=2.434 | 4059.4 samples/s | 63.4 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.04771 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.296 | L2-Norm(final)=2.435 | 1615.2 samples/s | 25.2 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.04704 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9062 | L2-Norm=19.306 | L2-Norm(final)=2.437 | 3453.4 samples/s | 54.0 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.04622 | Reg=0.00373 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.316 | L2-Norm(final)=2.438 | 3452.9 samples/s | 54.0 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.04635 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.325 | L2-Norm(final)=2.439 | 3453.1 samples/s | 54.0 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.04591 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.336 | L2-Norm(final)=2.440 | 3472.4 samples/s | 54.3 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.04565 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.346 | L2-Norm(final)=2.442 | 3483.2 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step4800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=15.3] | Loss=0.15514 | Reg=0.00369 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.199 | L2-Norm(final)=2.427 | 3579.1 samples/s | 55.9 steps/s
[Step=4050 Epoch=15.5] | Loss=0.03211 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.269 | L2-Norm(final)=2.396 | 3204.4 samples/s | 50.1 steps/s
[Step=4100 Epoch=15.7] | Loss=0.02009 | Reg=0.00372 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.300 | L2-Norm(final)=2.380 | 3308.4 samples/s | 51.7 steps/s
[Step=4150 Epoch=15.9] | Loss=0.01417 | Reg=0.00373 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.303 | L2-Norm(final)=2.378 | 3330.5 samples/s | 52.0 steps/s
[Step=4200 Epoch=16.1] | Loss=0.01192 | Reg=0.00373 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.303 | L2-Norm(final)=2.380 | 3320.2 samples/s | 51.9 steps/s
[Step=4250 Epoch=16.3] | Loss=0.01094 | Reg=0.00373 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.306 | L2-Norm(final)=2.380 | 3983.3 samples/s | 62.2 steps/s
[Step=4300 Epoch=16.5] | Loss=0.00924 | Reg=0.00373 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.306 | L2-Norm(final)=2.382 | 1570.9 samples/s | 24.5 steps/s
[Step=4350 Epoch=16.7] | Loss=0.00794 | Reg=0.00373 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.303 | L2-Norm(final)=2.386 | 3320.3 samples/s | 51.9 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00698 | Reg=0.00372 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.298 | L2-Norm(final)=2.390 | 3324.7 samples/s | 51.9 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00625 | Reg=0.00372 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.292 | L2-Norm(final)=2.394 | 3320.9 samples/s | 51.9 steps/s
[Step=4500 Epoch=17.2] | Loss=0.00564 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.285 | L2-Norm(final)=2.398 | 3583.4 samples/s | 56.0 steps/s
[Step=4550 Epoch=17.4] | Loss=0.00513 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.279 | L2-Norm(final)=2.401 | 1622.6 samples/s | 25.4 steps/s
[Step=4600 Epoch=17.6] | Loss=0.00471 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.272 | L2-Norm(final)=2.405 | 3267.6 samples/s | 51.1 steps/s
[Step=4650 Epoch=17.8] | Loss=0.00435 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.265 | L2-Norm(final)=2.408 | 3307.7 samples/s | 51.7 steps/s
[Step=4700 Epoch=18.0] | Loss=0.00405 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.258 | L2-Norm(final)=2.411 | 3315.8 samples/s | 51.8 steps/s
[Step=4750 Epoch=18.2] | Loss=0.00378 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.252 | L2-Norm(final)=2.414 | 3299.1 samples/s | 51.5 steps/s
[Step=4800 Epoch=18.4] | Loss=0.00355 | Reg=0.00370 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.246 | L2-Norm(final)=2.417 | 1678.9 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step4800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=15.4] | Loss=0.09463 | Reg=0.00369 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.199 | L2-Norm(final)=2.427 | 3671.8 samples/s | 57.4 steps/s
[Step=4050 Epoch=15.6] | Loss=0.01911 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.230 | L2-Norm(final)=2.408 | 3139.7 samples/s | 49.1 steps/s
[Step=4100 Epoch=15.8] | Loss=0.01317 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.231 | L2-Norm(final)=2.407 | 3314.8 samples/s | 51.8 steps/s
[Step=4150 Epoch=16.0] | Loss=0.01033 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.232 | L2-Norm(final)=2.407 | 3267.1 samples/s | 51.0 steps/s
[Step=4200 Epoch=16.2] | Loss=0.00804 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.230 | L2-Norm(final)=2.409 | 3326.2 samples/s | 52.0 steps/s
[Step=4250 Epoch=16.4] | Loss=0.00670 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.227 | L2-Norm(final)=2.414 | 3998.3 samples/s | 62.5 steps/s
[Step=4300 Epoch=16.6] | Loss=0.00570 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.223 | L2-Norm(final)=2.419 | 1546.1 samples/s | 24.2 steps/s
[Step=4350 Epoch=16.7] | Loss=0.00491 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.219 | L2-Norm(final)=2.424 | 3277.8 samples/s | 51.2 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00430 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.214 | L2-Norm(final)=2.428 | 3288.6 samples/s | 51.4 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00384 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.208 | L2-Norm(final)=2.432 | 3316.4 samples/s | 51.8 steps/s
[Step=4500 Epoch=17.3] | Loss=0.00347 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.435 | 3660.3 samples/s | 57.2 steps/s
[Step=4550 Epoch=17.5] | Loss=0.00316 | Reg=0.00369 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.197 | L2-Norm(final)=2.438 | 1588.8 samples/s | 24.8 steps/s
[Step=4600 Epoch=17.7] | Loss=0.00290 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.441 | 3324.8 samples/s | 51.9 steps/s
[Step=4650 Epoch=17.9] | Loss=0.00268 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.187 | L2-Norm(final)=2.443 | 3326.5 samples/s | 52.0 steps/s
[Step=4700 Epoch=18.1] | Loss=0.00250 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.182 | L2-Norm(final)=2.446 | 3305.7 samples/s | 51.7 steps/s
[Step=4750 Epoch=18.3] | Loss=0.00234 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.178 | L2-Norm(final)=2.448 | 3374.4 samples/s | 52.7 steps/s
[Step=4800 Epoch=18.5] | Loss=0.00219 | Reg=0.00368 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.173 | L2-Norm(final)=2.450 | 1663.1 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.13035 | acc=0.8947 | tpr=0.8690 | fpr=0.0496 | 3635.7 samples/s | 14.2 steps/s
Avg test loss: 0.13377, Avg test acc: 0.89358, Avg tpr: 0.86897, Avg fpr: 0.05230, total FA: 408

Testing server on iccad2012
[Step=  50] | Loss=0.47845 | acc=0.6959 | tpr=0.9690 | fpr=0.3090 | 3639.4 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.47925 | acc=0.6952 | tpr=0.9787 | fpr=0.3101 | 6772.5 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.48296 | acc=0.6935 | tpr=0.9784 | fpr=0.3118 | 6868.1 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.48517 | acc=0.6926 | tpr=0.9781 | fpr=0.3126 | 7015.4 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.48672 | acc=0.6916 | tpr=0.9764 | fpr=0.3136 | 6728.3 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.48644 | acc=0.6920 | tpr=0.9724 | fpr=0.3131 | 6799.1 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.48610 | acc=0.6930 | tpr=0.9724 | fpr=0.3121 | 6902.1 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.48762 | acc=0.6925 | tpr=0.9705 | fpr=0.3125 | 6753.7 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.48912 | acc=0.6925 | tpr=0.9718 | fpr=0.3126 | 6797.0 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.48967 | acc=0.6917 | tpr=0.9727 | fpr=0.3134 | 6811.4 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.48813 | acc=0.6926 | tpr=0.9729 | fpr=0.3125 | 12651.7 samples/s | 49.4 steps/s
Avg test loss: 0.48803, Avg test acc: 0.69260, Avg tpr: 0.97306, Avg fpr: 0.31250, total FA: 43390

server round 6/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch= 9.4] | Loss=0.14655 | Reg=0.00369 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.221 | L2-Norm(final)=2.444 | 3510.6 samples/s | 54.9 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.05917 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.205 | L2-Norm(final)=2.422 | 3425.1 samples/s | 53.5 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.05337 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.210 | L2-Norm(final)=2.428 | 3435.7 samples/s | 53.7 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.04922 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.219 | L2-Norm(final)=2.431 | 3467.5 samples/s | 54.2 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.04905 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.229 | L2-Norm(final)=2.431 | 3470.8 samples/s | 54.2 steps/s
[Step=5050 Epoch= 9.8] | Loss=0.04879 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9375 | L2-Norm=19.238 | L2-Norm(final)=2.430 | 3480.4 samples/s | 54.4 steps/s
[Step=5100 Epoch= 9.9] | Loss=0.04735 | Reg=0.00370 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.247 | L2-Norm(final)=2.430 | 3465.2 samples/s | 54.1 steps/s
[Step=5150 Epoch=10.0] | Loss=0.04659 | Reg=0.00371 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.257 | L2-Norm(final)=2.432 | 3486.5 samples/s | 54.5 steps/s
[Step=5200 Epoch=10.1] | Loss=0.04641 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.268 | L2-Norm(final)=2.433 | 3485.8 samples/s | 54.5 steps/s
[Step=5250 Epoch=10.2] | Loss=0.04680 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.278 | L2-Norm(final)=2.432 | 3436.0 samples/s | 53.7 steps/s
[Step=5300 Epoch=10.3] | Loss=0.04692 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.286 | L2-Norm(final)=2.430 | 4011.1 samples/s | 62.7 steps/s
[Step=5350 Epoch=10.4] | Loss=0.04595 | Reg=0.00372 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.296 | L2-Norm(final)=2.429 | 1569.5 samples/s | 24.5 steps/s
[Step=5400 Epoch=10.5] | Loss=0.04487 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.306 | L2-Norm(final)=2.429 | 3442.1 samples/s | 53.8 steps/s
[Step=5450 Epoch=10.6] | Loss=0.04408 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.315 | L2-Norm(final)=2.429 | 3464.5 samples/s | 54.1 steps/s
[Step=5500 Epoch=10.7] | Loss=0.04305 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.324 | L2-Norm(final)=2.430 | 3472.4 samples/s | 54.3 steps/s
[Step=5550 Epoch=10.8] | Loss=0.04270 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.333 | L2-Norm(final)=2.431 | 3456.0 samples/s | 54.0 steps/s
[Step=5600 Epoch=10.9] | Loss=0.04272 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.341 | L2-Norm(final)=2.431 | 3467.5 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step5600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch= 9.4] | Loss=0.13767 | Reg=0.00369 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.221 | L2-Norm(final)=2.445 | 3728.2 samples/s | 58.3 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.04759 | Reg=0.00369 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.205 | L2-Norm(final)=2.439 | 3336.5 samples/s | 52.1 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.04903 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9062 | L2-Norm=19.209 | L2-Norm(final)=2.439 | 3455.1 samples/s | 54.0 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.04627 | Reg=0.00369 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.220 | L2-Norm(final)=2.437 | 3467.0 samples/s | 54.2 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.04598 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.233 | L2-Norm(final)=2.439 | 3471.3 samples/s | 54.2 steps/s
[Step=5050 Epoch= 9.9] | Loss=0.04646 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.244 | L2-Norm(final)=2.439 | 3466.5 samples/s | 54.2 steps/s
[Step=5100 Epoch=10.0] | Loss=0.04591 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.255 | L2-Norm(final)=2.440 | 3476.0 samples/s | 54.3 steps/s
[Step=5150 Epoch=10.1] | Loss=0.04506 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.265 | L2-Norm(final)=2.440 | 3486.9 samples/s | 54.5 steps/s
[Step=5200 Epoch=10.2] | Loss=0.04562 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.276 | L2-Norm(final)=2.439 | 3483.4 samples/s | 54.4 steps/s
[Step=5250 Epoch=10.3] | Loss=0.04539 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.286 | L2-Norm(final)=2.438 | 3477.0 samples/s | 54.3 steps/s
[Step=5300 Epoch=10.4] | Loss=0.04489 | Reg=0.00372 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.295 | L2-Norm(final)=2.437 | 4090.1 samples/s | 63.9 steps/s
[Step=5350 Epoch=10.5] | Loss=0.04358 | Reg=0.00373 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.304 | L2-Norm(final)=2.437 | 1589.2 samples/s | 24.8 steps/s
[Step=5400 Epoch=10.6] | Loss=0.04279 | Reg=0.00373 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.313 | L2-Norm(final)=2.437 | 3458.6 samples/s | 54.0 steps/s
[Step=5450 Epoch=10.7] | Loss=0.04182 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.321 | L2-Norm(final)=2.437 | 3479.9 samples/s | 54.4 steps/s
[Step=5500 Epoch=10.8] | Loss=0.04084 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.328 | L2-Norm(final)=2.439 | 3483.1 samples/s | 54.4 steps/s
[Step=5550 Epoch=10.9] | Loss=0.04070 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.336 | L2-Norm(final)=2.440 | 3487.6 samples/s | 54.5 steps/s
[Step=5600 Epoch=10.9] | Loss=0.04033 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.345 | L2-Norm(final)=2.441 | 3487.6 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step5600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=18.4] | Loss=0.18465 | Reg=0.00369 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.221 | L2-Norm(final)=2.445 | 3592.7 samples/s | 56.1 steps/s
[Step=4850 Epoch=18.6] | Loss=0.01593 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.259 | L2-Norm(final)=2.429 | 3241.6 samples/s | 50.6 steps/s
[Step=4900 Epoch=18.8] | Loss=0.01380 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.267 | L2-Norm(final)=2.418 | 3308.5 samples/s | 51.7 steps/s
[Step=4950 Epoch=19.0] | Loss=0.01158 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.282 | L2-Norm(final)=2.407 | 3311.1 samples/s | 51.7 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00892 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.285 | L2-Norm(final)=2.406 | 3317.0 samples/s | 51.8 steps/s
[Step=5050 Epoch=19.3] | Loss=0.00735 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.283 | L2-Norm(final)=2.408 | 3970.9 samples/s | 62.0 steps/s
[Step=5100 Epoch=19.5] | Loss=0.00659 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.280 | L2-Norm(final)=2.412 | 1552.8 samples/s | 24.3 steps/s
[Step=5150 Epoch=19.7] | Loss=0.00587 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.279 | L2-Norm(final)=2.415 | 3279.7 samples/s | 51.2 steps/s
[Step=5200 Epoch=19.9] | Loss=0.00517 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.276 | L2-Norm(final)=2.418 | 3292.6 samples/s | 51.4 steps/s
[Step=5250 Epoch=20.1] | Loss=0.00461 | Reg=0.00371 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.271 | L2-Norm(final)=2.422 | 3305.0 samples/s | 51.6 steps/s
[Step=5300 Epoch=20.3] | Loss=0.00422 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.266 | L2-Norm(final)=2.425 | 3569.4 samples/s | 55.8 steps/s
[Step=5350 Epoch=20.5] | Loss=0.00431 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.264 | L2-Norm(final)=2.427 | 1609.6 samples/s | 25.2 steps/s
[Step=5400 Epoch=20.7] | Loss=0.00408 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.263 | L2-Norm(final)=2.428 | 3312.2 samples/s | 51.8 steps/s
[Step=5450 Epoch=20.9] | Loss=0.00378 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.430 | 3313.5 samples/s | 51.8 steps/s
[Step=5500 Epoch=21.1] | Loss=0.00352 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.259 | L2-Norm(final)=2.432 | 3283.8 samples/s | 51.3 steps/s
[Step=5550 Epoch=21.3] | Loss=0.00329 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.255 | L2-Norm(final)=2.434 | 3297.1 samples/s | 51.5 steps/s
[Step=5600 Epoch=21.5] | Loss=0.00309 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.251 | L2-Norm(final)=2.436 | 1685.9 samples/s | 26.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step5600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=18.5] | Loss=0.29853 | Reg=0.00369 | FP-Reg=0.000 | acc=0.7812 | L2-Norm=19.221 | L2-Norm(final)=2.445 | 3756.8 samples/s | 58.7 steps/s
[Step=4850 Epoch=18.7] | Loss=0.03127 | Reg=0.00374 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.346 | L2-Norm(final)=2.394 | 3111.2 samples/s | 48.6 steps/s
[Step=4900 Epoch=18.9] | Loss=0.01814 | Reg=0.00375 | FP-Reg=0.009 | acc=1.0000 | L2-Norm=19.360 | L2-Norm(final)=2.386 | 3312.4 samples/s | 51.8 steps/s
[Step=4950 Epoch=19.1] | Loss=0.01329 | Reg=0.00374 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.351 | L2-Norm(final)=2.389 | 3299.1 samples/s | 51.5 steps/s
[Step=5000 Epoch=19.2] | Loss=0.01059 | Reg=0.00374 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.342 | L2-Norm(final)=2.394 | 3331.8 samples/s | 52.1 steps/s
[Step=5050 Epoch=19.4] | Loss=0.00892 | Reg=0.00374 | FP-Reg=0.008 | acc=1.0000 | L2-Norm=19.334 | L2-Norm(final)=2.399 | 4021.5 samples/s | 62.8 steps/s
[Step=5100 Epoch=19.6] | Loss=0.00764 | Reg=0.00374 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.327 | L2-Norm(final)=2.404 | 1549.7 samples/s | 24.2 steps/s
[Step=5150 Epoch=19.8] | Loss=0.00712 | Reg=0.00373 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.320 | L2-Norm(final)=2.408 | 3311.0 samples/s | 51.7 steps/s
[Step=5200 Epoch=20.0] | Loss=0.00629 | Reg=0.00373 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.316 | L2-Norm(final)=2.413 | 3288.6 samples/s | 51.4 steps/s
[Step=5250 Epoch=20.2] | Loss=0.00561 | Reg=0.00373 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.310 | L2-Norm(final)=2.417 | 3279.0 samples/s | 51.2 steps/s
[Step=5300 Epoch=20.4] | Loss=0.00506 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.304 | L2-Norm(final)=2.422 | 3671.6 samples/s | 57.4 steps/s
[Step=5350 Epoch=20.6] | Loss=0.00461 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.297 | L2-Norm(final)=2.425 | 1611.0 samples/s | 25.2 steps/s
[Step=5400 Epoch=20.8] | Loss=0.00423 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.290 | L2-Norm(final)=2.429 | 3320.9 samples/s | 51.9 steps/s
[Step=5450 Epoch=21.0] | Loss=0.00391 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.283 | L2-Norm(final)=2.432 | 3328.0 samples/s | 52.0 steps/s
[Step=5500 Epoch=21.2] | Loss=0.00364 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.276 | L2-Norm(final)=2.435 | 3301.3 samples/s | 51.6 steps/s
[Step=5550 Epoch=21.4] | Loss=0.00340 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.269 | L2-Norm(final)=2.437 | 3373.5 samples/s | 52.7 steps/s
[Step=5600 Epoch=21.6] | Loss=0.00319 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.263 | L2-Norm(final)=2.440 | 1626.2 samples/s | 25.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22151 | acc=0.8215 | tpr=0.7539 | fpr=0.0317 | 3716.8 samples/s | 14.5 steps/s
Avg test loss: 0.22443, Avg test acc: 0.81922, Avg tpr: 0.75281, Avg fpr: 0.03474, total FA: 271

Testing server on iccad2012
[Step=  50] | Loss=0.30714 | acc=0.7987 | tpr=0.9690 | fpr=0.2043 | 3518.7 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.30814 | acc=0.8001 | tpr=0.9829 | fpr=0.2033 | 5820.6 samples/s | 22.7 steps/s
[Step= 150] | Loss=0.31137 | acc=0.7986 | tpr=0.9856 | fpr=0.2048 | 5843.2 samples/s | 22.8 steps/s
[Step= 200] | Loss=0.31215 | acc=0.7994 | tpr=0.9858 | fpr=0.2040 | 6135.7 samples/s | 24.0 steps/s
[Step= 250] | Loss=0.31216 | acc=0.7990 | tpr=0.9834 | fpr=0.2044 | 6646.4 samples/s | 26.0 steps/s
[Step= 300] | Loss=0.31240 | acc=0.7993 | tpr=0.9818 | fpr=0.2040 | 6706.9 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.31244 | acc=0.7993 | tpr=0.9806 | fpr=0.2040 | 6619.3 samples/s | 25.9 steps/s
[Step= 400] | Loss=0.31320 | acc=0.7990 | tpr=0.9787 | fpr=0.2043 | 6682.2 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.31418 | acc=0.7989 | tpr=0.9796 | fpr=0.2043 | 6776.4 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.31450 | acc=0.7987 | tpr=0.9793 | fpr=0.2046 | 6563.8 samples/s | 25.6 steps/s
[Step= 550] | Loss=0.31312 | acc=0.7994 | tpr=0.9789 | fpr=0.2039 | 12404.2 samples/s | 48.5 steps/s
Avg test loss: 0.31285, Avg test acc: 0.79953, Avg tpr: 0.97900, Avg fpr: 0.20373, total FA: 28288

server round 7/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=10.9] | Loss=0.15212 | Reg=0.00370 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.236 | L2-Norm(final)=2.452 | 3537.4 samples/s | 55.3 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05583 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.252 | L2-Norm(final)=2.425 | 3335.4 samples/s | 52.1 steps/s
[Step=5700 Epoch=11.1] | Loss=0.04873 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.255 | L2-Norm(final)=2.426 | 3464.2 samples/s | 54.1 steps/s
[Step=5750 Epoch=11.2] | Loss=0.04807 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.259 | L2-Norm(final)=2.428 | 3464.5 samples/s | 54.1 steps/s
[Step=5800 Epoch=11.3] | Loss=0.04802 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.266 | L2-Norm(final)=2.429 | 3474.3 samples/s | 54.3 steps/s
[Step=5850 Epoch=11.4] | Loss=0.04856 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.273 | L2-Norm(final)=2.426 | 3470.9 samples/s | 54.2 steps/s
[Step=5900 Epoch=11.5] | Loss=0.04784 | Reg=0.00372 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.280 | L2-Norm(final)=2.423 | 3491.6 samples/s | 54.6 steps/s
[Step=5950 Epoch=11.6] | Loss=0.04716 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.287 | L2-Norm(final)=2.422 | 3392.5 samples/s | 53.0 steps/s
[Step=6000 Epoch=11.7] | Loss=0.04607 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.296 | L2-Norm(final)=2.422 | 3473.2 samples/s | 54.3 steps/s
[Step=6050 Epoch=11.8] | Loss=0.04593 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.306 | L2-Norm(final)=2.422 | 3435.1 samples/s | 53.7 steps/s
[Step=6100 Epoch=11.9] | Loss=0.04583 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.315 | L2-Norm(final)=2.421 | 3670.1 samples/s | 57.3 steps/s
[Step=6150 Epoch=12.0] | Loss=0.04438 | Reg=0.00373 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.324 | L2-Norm(final)=2.421 | 1487.3 samples/s | 23.2 steps/s
[Step=6200 Epoch=12.1] | Loss=0.04302 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.333 | L2-Norm(final)=2.422 | 3367.7 samples/s | 52.6 steps/s
[Step=6250 Epoch=12.2] | Loss=0.04189 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.341 | L2-Norm(final)=2.423 | 3369.4 samples/s | 52.6 steps/s
[Step=6300 Epoch=12.3] | Loss=0.04128 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.348 | L2-Norm(final)=2.424 | 3440.4 samples/s | 53.8 steps/s
[Step=6350 Epoch=12.4] | Loss=0.04095 | Reg=0.00375 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.355 | L2-Norm(final)=2.425 | 3446.2 samples/s | 53.8 steps/s
[Step=6400 Epoch=12.5] | Loss=0.04084 | Reg=0.00375 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.362 | L2-Norm(final)=2.425 | 3470.1 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step6400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=10.9] | Loss=0.15092 | Reg=0.00370 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.236 | L2-Norm(final)=2.451 | 3785.1 samples/s | 59.1 steps/s
[Step=5650 Epoch=11.0] | Loss=0.04282 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.247 | L2-Norm(final)=2.447 | 3334.2 samples/s | 52.1 steps/s
[Step=5700 Epoch=11.1] | Loss=0.04330 | Reg=0.00370 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.246 | L2-Norm(final)=2.449 | 3466.0 samples/s | 54.2 steps/s
[Step=5750 Epoch=11.2] | Loss=0.04174 | Reg=0.00371 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.251 | L2-Norm(final)=2.449 | 3462.0 samples/s | 54.1 steps/s
[Step=5800 Epoch=11.3] | Loss=0.04322 | Reg=0.00371 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.258 | L2-Norm(final)=2.449 | 3467.9 samples/s | 54.2 steps/s
[Step=5850 Epoch=11.4] | Loss=0.04435 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.267 | L2-Norm(final)=2.448 | 3450.6 samples/s | 53.9 steps/s
[Step=5900 Epoch=11.5] | Loss=0.04316 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.275 | L2-Norm(final)=2.446 | 3459.1 samples/s | 54.0 steps/s
[Step=5950 Epoch=11.6] | Loss=0.04384 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.285 | L2-Norm(final)=2.445 | 3450.5 samples/s | 53.9 steps/s
[Step=6000 Epoch=11.7] | Loss=0.04358 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.295 | L2-Norm(final)=2.444 | 3468.8 samples/s | 54.2 steps/s
[Step=6050 Epoch=11.8] | Loss=0.04324 | Reg=0.00373 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.305 | L2-Norm(final)=2.443 | 3484.0 samples/s | 54.4 steps/s
[Step=6100 Epoch=11.9] | Loss=0.04348 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.314 | L2-Norm(final)=2.441 | 4102.2 samples/s | 64.1 steps/s
[Step=6150 Epoch=12.0] | Loss=0.04175 | Reg=0.00373 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.323 | L2-Norm(final)=2.441 | 1604.8 samples/s | 25.1 steps/s
[Step=6200 Epoch=12.1] | Loss=0.04120 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.332 | L2-Norm(final)=2.441 | 3431.1 samples/s | 53.6 steps/s
[Step=6250 Epoch=12.2] | Loss=0.04044 | Reg=0.00374 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.341 | L2-Norm(final)=2.441 | 3395.7 samples/s | 53.1 steps/s
[Step=6300 Epoch=12.3] | Loss=0.04045 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.349 | L2-Norm(final)=2.441 | 3438.6 samples/s | 53.7 steps/s
[Step=6350 Epoch=12.4] | Loss=0.03976 | Reg=0.00375 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.358 | L2-Norm(final)=2.441 | 3440.8 samples/s | 53.8 steps/s
[Step=6400 Epoch=12.5] | Loss=0.03931 | Reg=0.00375 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.366 | L2-Norm(final)=2.441 | 3478.1 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step6400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=21.5] | Loss=0.14485 | Reg=0.00370 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.236 | L2-Norm(final)=2.453 | 3553.6 samples/s | 55.5 steps/s
[Step=5650 Epoch=21.6] | Loss=0.02338 | Reg=0.00371 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.270 | L2-Norm(final)=2.423 | 3199.6 samples/s | 50.0 steps/s
[Step=5700 Epoch=21.8] | Loss=0.01512 | Reg=0.00372 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.289 | L2-Norm(final)=2.415 | 3331.5 samples/s | 52.1 steps/s
[Step=5750 Epoch=22.0] | Loss=0.01147 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.294 | L2-Norm(final)=2.417 | 3302.2 samples/s | 51.6 steps/s
[Step=5800 Epoch=22.2] | Loss=0.00882 | Reg=0.00372 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.294 | L2-Norm(final)=2.422 | 3315.6 samples/s | 51.8 steps/s
[Step=5850 Epoch=22.4] | Loss=0.00712 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.290 | L2-Norm(final)=2.428 | 3956.9 samples/s | 61.8 steps/s
[Step=5900 Epoch=22.6] | Loss=0.00599 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.284 | L2-Norm(final)=2.433 | 1548.0 samples/s | 24.2 steps/s
[Step=5950 Epoch=22.8] | Loss=0.00516 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.277 | L2-Norm(final)=2.438 | 3326.7 samples/s | 52.0 steps/s
[Step=6000 Epoch=23.0] | Loss=0.00453 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.270 | L2-Norm(final)=2.442 | 3301.6 samples/s | 51.6 steps/s
[Step=6050 Epoch=23.2] | Loss=0.00408 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.263 | L2-Norm(final)=2.446 | 3321.5 samples/s | 51.9 steps/s
[Step=6100 Epoch=23.4] | Loss=0.00368 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.256 | L2-Norm(final)=2.450 | 3585.7 samples/s | 56.0 steps/s
[Step=6150 Epoch=23.6] | Loss=0.00336 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.250 | L2-Norm(final)=2.453 | 1635.9 samples/s | 25.6 steps/s
[Step=6200 Epoch=23.8] | Loss=0.00308 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.245 | L2-Norm(final)=2.456 | 3301.4 samples/s | 51.6 steps/s
[Step=6250 Epoch=23.9] | Loss=0.00285 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.239 | L2-Norm(final)=2.459 | 3301.5 samples/s | 51.6 steps/s
[Step=6300 Epoch=24.1] | Loss=0.00265 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.234 | L2-Norm(final)=2.462 | 3286.6 samples/s | 51.4 steps/s
[Step=6350 Epoch=24.3] | Loss=0.00248 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.464 | 3304.5 samples/s | 51.6 steps/s
[Step=6400 Epoch=24.5] | Loss=0.00232 | Reg=0.00370 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.224 | L2-Norm(final)=2.466 | 1685.1 samples/s | 26.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step6400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=21.6] | Loss=0.11587 | Reg=0.00370 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.236 | L2-Norm(final)=2.454 | 3430.7 samples/s | 53.6 steps/s
[Step=5650 Epoch=21.7] | Loss=0.02598 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.279 | L2-Norm(final)=2.422 | 3308.2 samples/s | 51.7 steps/s
[Step=5700 Epoch=21.9] | Loss=0.01687 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.308 | L2-Norm(final)=2.407 | 3310.9 samples/s | 51.7 steps/s
[Step=5750 Epoch=22.1] | Loss=0.01271 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.310 | L2-Norm(final)=2.408 | 3328.0 samples/s | 52.0 steps/s
[Step=5800 Epoch=22.3] | Loss=0.01011 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.312 | L2-Norm(final)=2.410 | 3230.3 samples/s | 50.5 steps/s
[Step=5850 Epoch=22.5] | Loss=0.00833 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.312 | L2-Norm(final)=2.414 | 3980.3 samples/s | 62.2 steps/s
[Step=5900 Epoch=22.7] | Loss=0.00701 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.309 | L2-Norm(final)=2.419 | 1549.3 samples/s | 24.2 steps/s
[Step=5950 Epoch=22.9] | Loss=0.00604 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.304 | L2-Norm(final)=2.423 | 3287.5 samples/s | 51.4 steps/s
[Step=6000 Epoch=23.1] | Loss=0.00532 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.297 | L2-Norm(final)=2.427 | 3291.8 samples/s | 51.4 steps/s
[Step=6050 Epoch=23.3] | Loss=0.00493 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.292 | L2-Norm(final)=2.431 | 3306.0 samples/s | 51.7 steps/s
[Step=6100 Epoch=23.5] | Loss=0.00464 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.289 | L2-Norm(final)=2.433 | 3661.4 samples/s | 57.2 steps/s
[Step=6150 Epoch=23.7] | Loss=0.00431 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9844 | L2-Norm=19.286 | L2-Norm(final)=2.436 | 1593.8 samples/s | 24.9 steps/s
[Step=6200 Epoch=23.9] | Loss=0.00398 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.284 | L2-Norm(final)=2.438 | 3293.7 samples/s | 51.5 steps/s
[Step=6250 Epoch=24.1] | Loss=0.00368 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.280 | L2-Norm(final)=2.441 | 3325.0 samples/s | 52.0 steps/s
[Step=6300 Epoch=24.3] | Loss=0.00343 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.277 | L2-Norm(final)=2.443 | 3319.1 samples/s | 51.9 steps/s
[Step=6350 Epoch=24.4] | Loss=0.00323 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.273 | L2-Norm(final)=2.446 | 3379.7 samples/s | 52.8 steps/s
[Step=6400 Epoch=24.6] | Loss=0.00303 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.269 | L2-Norm(final)=2.448 | 1667.8 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.16367 | acc=0.8736 | tpr=0.8288 | fpr=0.0292 | 3624.1 samples/s | 14.2 steps/s
Avg test loss: 0.16604, Avg test acc: 0.87070, Avg tpr: 0.82666, Avg fpr: 0.03243, total FA: 253

Testing server on iccad2012
[Step=  50] | Loss=0.40451 | acc=0.7500 | tpr=0.9779 | fpr=0.2541 | 3643.6 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.40663 | acc=0.7505 | tpr=0.9808 | fpr=0.2538 | 6800.7 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.41021 | acc=0.7493 | tpr=0.9813 | fpr=0.2549 | 6888.6 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.41083 | acc=0.7492 | tpr=0.9847 | fpr=0.2550 | 6747.4 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.41024 | acc=0.7487 | tpr=0.9799 | fpr=0.2556 | 6742.9 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.40957 | acc=0.7496 | tpr=0.9782 | fpr=0.2546 | 6765.1 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.41012 | acc=0.7498 | tpr=0.9775 | fpr=0.2543 | 6818.7 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.41147 | acc=0.7492 | tpr=0.9759 | fpr=0.2549 | 6941.8 samples/s | 27.1 steps/s
[Step= 450] | Loss=0.41289 | acc=0.7490 | tpr=0.9766 | fpr=0.2551 | 6496.3 samples/s | 25.4 steps/s
[Step= 500] | Loss=0.41337 | acc=0.7482 | tpr=0.9780 | fpr=0.2559 | 6914.2 samples/s | 27.0 steps/s
[Step= 550] | Loss=0.41186 | acc=0.7488 | tpr=0.9781 | fpr=0.2554 | 12348.4 samples/s | 48.2 steps/s
Avg test loss: 0.41157, Avg test acc: 0.74889, Avg tpr: 0.97821, Avg fpr: 0.25528, total FA: 35445

server round 8/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=12.5] | Loss=0.12246 | Reg=0.00370 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=19.248 | L2-Norm(final)=2.456 | 3951.3 samples/s | 61.7 steps/s
[Step=6450 Epoch=12.6] | Loss=0.04533 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.232 | L2-Norm(final)=2.440 | 3047.2 samples/s | 47.6 steps/s
[Step=6500 Epoch=12.7] | Loss=0.04025 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.232 | L2-Norm(final)=2.441 | 3435.8 samples/s | 53.7 steps/s
[Step=6550 Epoch=12.8] | Loss=0.04194 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.241 | L2-Norm(final)=2.441 | 3458.6 samples/s | 54.0 steps/s
[Step=6600 Epoch=12.9] | Loss=0.04207 | Reg=0.00371 | FP-Reg=0.002 | acc=0.9219 | L2-Norm=19.250 | L2-Norm(final)=2.439 | 3445.3 samples/s | 53.8 steps/s
[Step=6650 Epoch=13.0] | Loss=0.04385 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.259 | L2-Norm(final)=2.436 | 3485.9 samples/s | 54.5 steps/s
[Step=6700 Epoch=13.1] | Loss=0.04319 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.268 | L2-Norm(final)=2.433 | 3482.0 samples/s | 54.4 steps/s
[Step=6750 Epoch=13.2] | Loss=0.04319 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.277 | L2-Norm(final)=2.431 | 3457.7 samples/s | 54.0 steps/s
[Step=6800 Epoch=13.3] | Loss=0.04206 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.286 | L2-Norm(final)=2.430 | 3462.7 samples/s | 54.1 steps/s
[Step=6850 Epoch=13.4] | Loss=0.04168 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.296 | L2-Norm(final)=2.430 | 3470.3 samples/s | 54.2 steps/s
[Step=6900 Epoch=13.5] | Loss=0.04217 | Reg=0.00373 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.306 | L2-Norm(final)=2.428 | 4038.0 samples/s | 63.1 steps/s
[Step=6950 Epoch=13.6] | Loss=0.04130 | Reg=0.00373 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.317 | L2-Norm(final)=2.428 | 1556.3 samples/s | 24.3 steps/s
[Step=7000 Epoch=13.7] | Loss=0.03995 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.328 | L2-Norm(final)=2.428 | 3448.7 samples/s | 53.9 steps/s
[Step=7050 Epoch=13.8] | Loss=0.03949 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.338 | L2-Norm(final)=2.429 | 3452.8 samples/s | 54.0 steps/s
[Step=7100 Epoch=13.8] | Loss=0.03945 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.347 | L2-Norm(final)=2.428 | 3458.1 samples/s | 54.0 steps/s
[Step=7150 Epoch=13.9] | Loss=0.03908 | Reg=0.00375 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.356 | L2-Norm(final)=2.428 | 3480.8 samples/s | 54.4 steps/s
[Step=7200 Epoch=14.0] | Loss=0.03837 | Reg=0.00375 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.365 | L2-Norm(final)=2.427 | 3495.9 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step7200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=12.5] | Loss=0.08888 | Reg=0.00370 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.248 | L2-Norm(final)=2.456 | 3858.9 samples/s | 60.3 steps/s
[Step=6450 Epoch=12.6] | Loss=0.03743 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.235 | L2-Norm(final)=2.453 | 3298.9 samples/s | 51.5 steps/s
[Step=6500 Epoch=12.7] | Loss=0.03825 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.236 | L2-Norm(final)=2.455 | 3271.4 samples/s | 51.1 steps/s
[Step=6550 Epoch=12.8] | Loss=0.03895 | Reg=0.00370 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.243 | L2-Norm(final)=2.454 | 3324.5 samples/s | 51.9 steps/s
[Step=6600 Epoch=12.9] | Loss=0.03804 | Reg=0.00371 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.252 | L2-Norm(final)=2.455 | 3387.3 samples/s | 52.9 steps/s
[Step=6650 Epoch=13.0] | Loss=0.03939 | Reg=0.00371 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.261 | L2-Norm(final)=2.453 | 3380.5 samples/s | 52.8 steps/s
[Step=6700 Epoch=13.1] | Loss=0.03929 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.271 | L2-Norm(final)=2.452 | 3382.1 samples/s | 52.8 steps/s
[Step=6750 Epoch=13.2] | Loss=0.03880 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.282 | L2-Norm(final)=2.452 | 3366.1 samples/s | 52.6 steps/s
[Step=6800 Epoch=13.3] | Loss=0.03890 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.292 | L2-Norm(final)=2.451 | 3383.2 samples/s | 52.9 steps/s
[Step=6850 Epoch=13.4] | Loss=0.03884 | Reg=0.00373 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.303 | L2-Norm(final)=2.451 | 3377.3 samples/s | 52.8 steps/s
[Step=6900 Epoch=13.5] | Loss=0.03877 | Reg=0.00373 | FP-Reg=0.003 | acc=0.9219 | L2-Norm=19.314 | L2-Norm(final)=2.452 | 4075.3 samples/s | 63.7 steps/s
[Step=6950 Epoch=13.6] | Loss=0.03815 | Reg=0.00373 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.325 | L2-Norm(final)=2.452 | 1596.9 samples/s | 25.0 steps/s
[Step=7000 Epoch=13.7] | Loss=0.03766 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.335 | L2-Norm(final)=2.453 | 3457.9 samples/s | 54.0 steps/s
[Step=7050 Epoch=13.8] | Loss=0.03762 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.345 | L2-Norm(final)=2.453 | 3464.8 samples/s | 54.1 steps/s
[Step=7100 Epoch=13.9] | Loss=0.03715 | Reg=0.00375 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.353 | L2-Norm(final)=2.453 | 3449.9 samples/s | 53.9 steps/s
[Step=7150 Epoch=14.0] | Loss=0.03671 | Reg=0.00375 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.362 | L2-Norm(final)=2.453 | 3446.8 samples/s | 53.9 steps/s
[Step=7200 Epoch=14.1] | Loss=0.03689 | Reg=0.00375 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.370 | L2-Norm(final)=2.452 | 3469.4 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step7200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=24.5] | Loss=0.17698 | Reg=0.00370 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.248 | L2-Norm(final)=2.456 | 3559.0 samples/s | 55.6 steps/s
[Step=6450 Epoch=24.7] | Loss=0.02028 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.326 | L2-Norm(final)=2.431 | 3207.8 samples/s | 50.1 steps/s
[Step=6500 Epoch=24.9] | Loss=0.01232 | Reg=0.00374 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.342 | L2-Norm(final)=2.424 | 3315.8 samples/s | 51.8 steps/s
[Step=6550 Epoch=25.1] | Loss=0.00989 | Reg=0.00374 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.340 | L2-Norm(final)=2.423 | 3267.5 samples/s | 51.1 steps/s
[Step=6600 Epoch=25.3] | Loss=0.00802 | Reg=0.00374 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.333 | L2-Norm(final)=2.424 | 3324.4 samples/s | 51.9 steps/s
[Step=6650 Epoch=25.5] | Loss=0.00663 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.326 | L2-Norm(final)=2.427 | 3966.1 samples/s | 62.0 steps/s
[Step=6700 Epoch=25.7] | Loss=0.00555 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.318 | L2-Norm(final)=2.431 | 1554.6 samples/s | 24.3 steps/s
[Step=6750 Epoch=25.9] | Loss=0.00483 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.310 | L2-Norm(final)=2.435 | 3294.2 samples/s | 51.5 steps/s
[Step=6800 Epoch=26.1] | Loss=0.00423 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.303 | L2-Norm(final)=2.439 | 3302.8 samples/s | 51.6 steps/s
[Step=6850 Epoch=26.2] | Loss=0.00378 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.295 | L2-Norm(final)=2.442 | 3319.7 samples/s | 51.9 steps/s
[Step=6900 Epoch=26.4] | Loss=0.00340 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.287 | L2-Norm(final)=2.446 | 3567.6 samples/s | 55.7 steps/s
[Step=6950 Epoch=26.6] | Loss=0.00310 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.280 | L2-Norm(final)=2.448 | 1608.3 samples/s | 25.1 steps/s
[Step=7000 Epoch=26.8] | Loss=0.00285 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.273 | L2-Norm(final)=2.451 | 3309.4 samples/s | 51.7 steps/s
[Step=7050 Epoch=27.0] | Loss=0.00264 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.266 | L2-Norm(final)=2.453 | 3317.0 samples/s | 51.8 steps/s
[Step=7100 Epoch=27.2] | Loss=0.00245 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.260 | L2-Norm(final)=2.456 | 3308.2 samples/s | 51.7 steps/s
[Step=7150 Epoch=27.4] | Loss=0.00229 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.254 | L2-Norm(final)=2.458 | 3327.2 samples/s | 52.0 steps/s
[Step=7200 Epoch=27.6] | Loss=0.00215 | Reg=0.00370 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.248 | L2-Norm(final)=2.460 | 1672.9 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step7200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=24.6] | Loss=0.18317 | Reg=0.00370 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.248 | L2-Norm(final)=2.455 | 3641.8 samples/s | 56.9 steps/s
[Step=6450 Epoch=24.8] | Loss=0.01625 | Reg=0.00370 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.246 | L2-Norm(final)=2.444 | 3148.0 samples/s | 49.2 steps/s
[Step=6500 Epoch=25.0] | Loss=0.01014 | Reg=0.00371 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.270 | L2-Norm(final)=2.433 | 3306.1 samples/s | 51.7 steps/s
[Step=6550 Epoch=25.2] | Loss=0.00878 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.280 | L2-Norm(final)=2.430 | 3318.5 samples/s | 51.9 steps/s
[Step=6600 Epoch=25.4] | Loss=0.00705 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.286 | L2-Norm(final)=2.432 | 3317.8 samples/s | 51.8 steps/s
[Step=6650 Epoch=25.6] | Loss=0.00627 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.292 | L2-Norm(final)=2.435 | 4007.0 samples/s | 62.6 steps/s
[Step=6700 Epoch=25.8] | Loss=0.00538 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.297 | L2-Norm(final)=2.439 | 1538.1 samples/s | 24.0 steps/s
[Step=6750 Epoch=26.0] | Loss=0.00462 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.297 | L2-Norm(final)=2.443 | 3333.6 samples/s | 52.1 steps/s
[Step=6800 Epoch=26.2] | Loss=0.00411 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.295 | L2-Norm(final)=2.447 | 3311.1 samples/s | 51.7 steps/s
[Step=6850 Epoch=26.4] | Loss=0.00373 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.292 | L2-Norm(final)=2.450 | 3363.7 samples/s | 52.6 steps/s
[Step=6900 Epoch=26.6] | Loss=0.00338 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.289 | L2-Norm(final)=2.454 | 3635.1 samples/s | 56.8 steps/s
[Step=6950 Epoch=26.8] | Loss=0.00308 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.285 | L2-Norm(final)=2.457 | 1595.3 samples/s | 24.9 steps/s
[Step=7000 Epoch=26.9] | Loss=0.00283 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.281 | L2-Norm(final)=2.460 | 3288.1 samples/s | 51.4 steps/s
[Step=7050 Epoch=27.1] | Loss=0.00261 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.276 | L2-Norm(final)=2.463 | 3295.3 samples/s | 51.5 steps/s
[Step=7100 Epoch=27.3] | Loss=0.00243 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.271 | L2-Norm(final)=2.465 | 3322.2 samples/s | 51.9 steps/s
[Step=7150 Epoch=27.5] | Loss=0.00227 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.266 | L2-Norm(final)=2.467 | 3353.3 samples/s | 52.4 steps/s
[Step=7200 Epoch=27.7] | Loss=0.00213 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.469 | 1653.4 samples/s | 25.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19206 | acc=0.8512 | tpr=0.7924 | fpr=0.0213 | 3650.6 samples/s | 14.3 steps/s
Avg test loss: 0.19408, Avg test acc: 0.84923, Avg tpr: 0.79128, Avg fpr: 0.02333, total FA: 182

Testing server on iccad2012
[Step=  50] | Loss=0.33511 | acc=0.7928 | tpr=0.9735 | fpr=0.2104 | 3612.4 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.33722 | acc=0.7919 | tpr=0.9787 | fpr=0.2116 | 6723.5 samples/s | 26.3 steps/s
[Step= 150] | Loss=0.34064 | acc=0.7915 | tpr=0.9769 | fpr=0.2119 | 6970.7 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.34107 | acc=0.7916 | tpr=0.9770 | fpr=0.2118 | 6883.4 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.34125 | acc=0.7905 | tpr=0.9721 | fpr=0.2128 | 6793.8 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.34155 | acc=0.7909 | tpr=0.9716 | fpr=0.2124 | 6799.6 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.34213 | acc=0.7907 | tpr=0.9706 | fpr=0.2126 | 6948.2 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.34327 | acc=0.7904 | tpr=0.9677 | fpr=0.2129 | 6798.7 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.34443 | acc=0.7902 | tpr=0.9693 | fpr=0.2131 | 6716.8 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.34465 | acc=0.7896 | tpr=0.9700 | fpr=0.2136 | 6777.7 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.34315 | acc=0.7905 | tpr=0.9702 | fpr=0.2128 | 11964.9 samples/s | 46.7 steps/s
Avg test loss: 0.34293, Avg test acc: 0.79060, Avg tpr: 0.96989, Avg fpr: 0.21266, total FA: 29527

server round 9/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=14.0] | Loss=0.12534 | Reg=0.00371 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.259 | L2-Norm(final)=2.459 | 3529.7 samples/s | 55.2 steps/s
[Step=7250 Epoch=14.1] | Loss=0.03932 | Reg=0.00371 | FP-Reg=0.002 | acc=0.9844 | L2-Norm=19.253 | L2-Norm(final)=2.454 | 3328.5 samples/s | 52.0 steps/s
[Step=7300 Epoch=14.2] | Loss=0.03821 | Reg=0.00371 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.256 | L2-Norm(final)=2.459 | 3463.8 samples/s | 54.1 steps/s
[Step=7350 Epoch=14.3] | Loss=0.03885 | Reg=0.00371 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.261 | L2-Norm(final)=2.461 | 3442.9 samples/s | 53.8 steps/s
[Step=7400 Epoch=14.4] | Loss=0.03837 | Reg=0.00371 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.269 | L2-Norm(final)=2.462 | 3450.7 samples/s | 53.9 steps/s
[Step=7450 Epoch=14.5] | Loss=0.03805 | Reg=0.00372 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.276 | L2-Norm(final)=2.462 | 3463.3 samples/s | 54.1 steps/s
[Step=7500 Epoch=14.6] | Loss=0.03938 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.284 | L2-Norm(final)=2.458 | 3454.8 samples/s | 54.0 steps/s
[Step=7550 Epoch=14.7] | Loss=0.03885 | Reg=0.00372 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.291 | L2-Norm(final)=2.456 | 3421.5 samples/s | 53.5 steps/s
[Step=7600 Epoch=14.8] | Loss=0.03834 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.299 | L2-Norm(final)=2.453 | 3453.7 samples/s | 54.0 steps/s
[Step=7650 Epoch=14.9] | Loss=0.03807 | Reg=0.00373 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.307 | L2-Norm(final)=2.452 | 3473.3 samples/s | 54.3 steps/s
[Step=7700 Epoch=15.0] | Loss=0.03786 | Reg=0.00373 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.315 | L2-Norm(final)=2.449 | 4053.8 samples/s | 63.3 steps/s
[Step=7750 Epoch=15.1] | Loss=0.03697 | Reg=0.00373 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.323 | L2-Norm(final)=2.448 | 1569.6 samples/s | 24.5 steps/s
[Step=7800 Epoch=15.2] | Loss=0.03662 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.330 | L2-Norm(final)=2.447 | 3451.8 samples/s | 53.9 steps/s
[Step=7850 Epoch=15.3] | Loss=0.03604 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.337 | L2-Norm(final)=2.447 | 3458.3 samples/s | 54.0 steps/s
[Step=7900 Epoch=15.4] | Loss=0.03568 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.345 | L2-Norm(final)=2.447 | 3455.7 samples/s | 54.0 steps/s
[Step=7950 Epoch=15.5] | Loss=0.03550 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.352 | L2-Norm(final)=2.446 | 3456.8 samples/s | 54.0 steps/s
[Step=8000 Epoch=15.6] | Loss=0.03518 | Reg=0.00375 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.359 | L2-Norm(final)=2.446 | 3395.6 samples/s | 53.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=14.1] | Loss=0.12766 | Reg=0.00371 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.259 | L2-Norm(final)=2.459 | 4191.0 samples/s | 65.5 steps/s
[Step=7250 Epoch=14.2] | Loss=0.03977 | Reg=0.00371 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.449 | 3126.5 samples/s | 48.9 steps/s
[Step=7300 Epoch=14.3] | Loss=0.03965 | Reg=0.00371 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=19.258 | L2-Norm(final)=2.444 | 3471.2 samples/s | 54.2 steps/s
[Step=7350 Epoch=14.4] | Loss=0.03990 | Reg=0.00371 | FP-Reg=0.002 | acc=0.9531 | L2-Norm=19.256 | L2-Norm(final)=2.438 | 3484.9 samples/s | 54.5 steps/s
[Step=7400 Epoch=14.5] | Loss=0.03854 | Reg=0.00371 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.436 | 3486.9 samples/s | 54.5 steps/s
[Step=7450 Epoch=14.6] | Loss=0.03829 | Reg=0.00371 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.267 | L2-Norm(final)=2.436 | 3495.5 samples/s | 54.6 steps/s
[Step=7500 Epoch=14.7] | Loss=0.03841 | Reg=0.00371 | FP-Reg=0.003 | acc=0.9531 | L2-Norm=19.274 | L2-Norm(final)=2.435 | 3489.8 samples/s | 54.5 steps/s
[Step=7550 Epoch=14.8] | Loss=0.03744 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.282 | L2-Norm(final)=2.436 | 3494.6 samples/s | 54.6 steps/s
[Step=7600 Epoch=14.9] | Loss=0.03752 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.291 | L2-Norm(final)=2.437 | 3427.3 samples/s | 53.6 steps/s
[Step=7650 Epoch=15.0] | Loss=0.03746 | Reg=0.00372 | FP-Reg=0.003 | acc=0.9844 | L2-Norm=19.300 | L2-Norm(final)=2.436 | 3478.0 samples/s | 54.3 steps/s
[Step=7700 Epoch=15.1] | Loss=0.03653 | Reg=0.00373 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.309 | L2-Norm(final)=2.438 | 4083.4 samples/s | 63.8 steps/s
[Step=7750 Epoch=15.2] | Loss=0.03560 | Reg=0.00373 | FP-Reg=0.003 | acc=0.9375 | L2-Norm=19.319 | L2-Norm(final)=2.440 | 1593.8 samples/s | 24.9 steps/s
[Step=7800 Epoch=15.2] | Loss=0.03492 | Reg=0.00374 | FP-Reg=0.003 | acc=0.9688 | L2-Norm=19.328 | L2-Norm(final)=2.442 | 3447.4 samples/s | 53.9 steps/s
[Step=7850 Epoch=15.3] | Loss=0.03429 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.337 | L2-Norm(final)=2.443 | 3401.6 samples/s | 53.1 steps/s
[Step=7900 Epoch=15.4] | Loss=0.03382 | Reg=0.00374 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=19.345 | L2-Norm(final)=2.444 | 3388.9 samples/s | 53.0 steps/s
[Step=7950 Epoch=15.5] | Loss=0.03386 | Reg=0.00375 | FP-Reg=0.004 | acc=0.9531 | L2-Norm=19.353 | L2-Norm(final)=2.444 | 3148.1 samples/s | 49.2 steps/s
[Step=8000 Epoch=15.6] | Loss=0.03384 | Reg=0.00375 | FP-Reg=0.004 | acc=0.9688 | L2-Norm=19.362 | L2-Norm(final)=2.444 | 3273.8 samples/s | 51.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step8000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=27.6] | Loss=0.09707 | Reg=0.00371 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.259 | L2-Norm(final)=2.460 | 3513.5 samples/s | 54.9 steps/s
[Step=7250 Epoch=27.8] | Loss=0.01454 | Reg=0.00372 | FP-Reg=0.005 | acc=0.9688 | L2-Norm=19.288 | L2-Norm(final)=2.452 | 2694.7 samples/s | 42.1 steps/s
[Step=7300 Epoch=28.0] | Loss=0.01192 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.313 | L2-Norm(final)=2.435 | 2899.5 samples/s | 45.3 steps/s
[Step=7350 Epoch=28.2] | Loss=0.01032 | Reg=0.00374 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.332 | L2-Norm(final)=2.432 | 2946.8 samples/s | 46.0 steps/s
[Step=7400 Epoch=28.4] | Loss=0.00900 | Reg=0.00374 | FP-Reg=0.007 | acc=0.9688 | L2-Norm=19.347 | L2-Norm(final)=2.430 | 3118.4 samples/s | 48.7 steps/s
[Step=7450 Epoch=28.5] | Loss=0.00838 | Reg=0.00375 | FP-Reg=0.007 | acc=0.9844 | L2-Norm=19.359 | L2-Norm(final)=2.425 | 3950.3 samples/s | 61.7 steps/s
[Step=7500 Epoch=28.7] | Loss=0.00720 | Reg=0.00375 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.365 | L2-Norm(final)=2.422 | 1530.8 samples/s | 23.9 steps/s
[Step=7550 Epoch=28.9] | Loss=0.00621 | Reg=0.00375 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.366 | L2-Norm(final)=2.422 | 3302.9 samples/s | 51.6 steps/s
[Step=7600 Epoch=29.1] | Loss=0.00550 | Reg=0.00375 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.364 | L2-Norm(final)=2.424 | 3291.6 samples/s | 51.4 steps/s
[Step=7650 Epoch=29.3] | Loss=0.00490 | Reg=0.00375 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.360 | L2-Norm(final)=2.427 | 3323.5 samples/s | 51.9 steps/s
[Step=7700 Epoch=29.5] | Loss=0.00442 | Reg=0.00375 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.355 | L2-Norm(final)=2.429 | 3591.5 samples/s | 56.1 steps/s
[Step=7750 Epoch=29.7] | Loss=0.00402 | Reg=0.00374 | FP-Reg=0.007 | acc=1.0000 | L2-Norm=19.349 | L2-Norm(final)=2.432 | 1623.5 samples/s | 25.4 steps/s
[Step=7800 Epoch=29.9] | Loss=0.00369 | Reg=0.00374 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.343 | L2-Norm(final)=2.434 | 3313.7 samples/s | 51.8 steps/s
[Step=7850 Epoch=30.1] | Loss=0.00340 | Reg=0.00374 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.336 | L2-Norm(final)=2.436 | 3299.6 samples/s | 51.6 steps/s
[Step=7900 Epoch=30.3] | Loss=0.00316 | Reg=0.00374 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.330 | L2-Norm(final)=2.438 | 3295.6 samples/s | 51.5 steps/s
[Step=7950 Epoch=30.5] | Loss=0.00295 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.323 | L2-Norm(final)=2.440 | 3268.5 samples/s | 51.1 steps/s
[Step=8000 Epoch=30.7] | Loss=0.00277 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.317 | L2-Norm(final)=2.442 | 1680.8 samples/s | 26.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step8000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=27.7] | Loss=0.09911 | Reg=0.00371 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.259 | L2-Norm(final)=2.459 | 3552.4 samples/s | 55.5 steps/s
[Step=7250 Epoch=27.9] | Loss=0.01530 | Reg=0.00373 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.324 | L2-Norm(final)=2.437 | 3181.1 samples/s | 49.7 steps/s
[Step=7300 Epoch=28.1] | Loss=0.01191 | Reg=0.00374 | FP-Reg=0.006 | acc=0.9844 | L2-Norm=19.340 | L2-Norm(final)=2.430 | 3319.6 samples/s | 51.9 steps/s
[Step=7350 Epoch=28.3] | Loss=0.00955 | Reg=0.00374 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.342 | L2-Norm(final)=2.426 | 3310.3 samples/s | 51.7 steps/s
[Step=7400 Epoch=28.5] | Loss=0.00770 | Reg=0.00374 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.340 | L2-Norm(final)=2.429 | 3307.9 samples/s | 51.7 steps/s
[Step=7450 Epoch=28.7] | Loss=0.00643 | Reg=0.00374 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.336 | L2-Norm(final)=2.434 | 4016.0 samples/s | 62.8 steps/s
[Step=7500 Epoch=28.9] | Loss=0.00539 | Reg=0.00374 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.331 | L2-Norm(final)=2.439 | 1521.6 samples/s | 23.8 steps/s
[Step=7550 Epoch=29.1] | Loss=0.00464 | Reg=0.00373 | FP-Reg=0.006 | acc=1.0000 | L2-Norm=19.324 | L2-Norm(final)=2.443 | 3291.1 samples/s | 51.4 steps/s
[Step=7600 Epoch=29.3] | Loss=0.00407 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.316 | L2-Norm(final)=2.447 | 3306.7 samples/s | 51.7 steps/s
[Step=7650 Epoch=29.4] | Loss=0.00362 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.308 | L2-Norm(final)=2.451 | 3332.7 samples/s | 52.1 steps/s
[Step=7700 Epoch=29.6] | Loss=0.00326 | Reg=0.00373 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.301 | L2-Norm(final)=2.454 | 3615.0 samples/s | 56.5 steps/s
[Step=7750 Epoch=29.8] | Loss=0.00297 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.293 | L2-Norm(final)=2.457 | 1610.1 samples/s | 25.2 steps/s
[Step=7800 Epoch=30.0] | Loss=0.00273 | Reg=0.00372 | FP-Reg=0.005 | acc=1.0000 | L2-Norm=19.286 | L2-Norm(final)=2.459 | 3312.1 samples/s | 51.8 steps/s
[Step=7850 Epoch=30.2] | Loss=0.00252 | Reg=0.00372 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.279 | L2-Norm(final)=2.462 | 3287.4 samples/s | 51.4 steps/s
[Step=7900 Epoch=30.4] | Loss=0.00234 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.273 | L2-Norm(final)=2.464 | 3287.4 samples/s | 51.4 steps/s
[Step=7950 Epoch=30.6] | Loss=0.00219 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.267 | L2-Norm(final)=2.466 | 3358.6 samples/s | 52.5 steps/s
[Step=8000 Epoch=30.8] | Loss=0.00206 | Reg=0.00371 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=19.261 | L2-Norm(final)=2.468 | 1672.0 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.16555 | acc=0.8710 | tpr=0.8257 | fpr=0.0305 | 3663.1 samples/s | 14.3 steps/s
Avg test loss: 0.16681, Avg test acc: 0.87102, Avg tpr: 0.82695, Avg fpr: 0.03205, total FA: 250

Testing server on iccad2012
[Step=  50] | Loss=0.42655 | acc=0.7467 | tpr=0.9779 | fpr=0.2574 | 3636.4 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.42595 | acc=0.7467 | tpr=0.9851 | fpr=0.2578 | 6914.5 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.42817 | acc=0.7469 | tpr=0.9856 | fpr=0.2575 | 6714.4 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.42889 | acc=0.7465 | tpr=0.9847 | fpr=0.2578 | 6899.3 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.42916 | acc=0.7453 | tpr=0.9817 | fpr=0.2590 | 6873.9 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.42845 | acc=0.7464 | tpr=0.9804 | fpr=0.2579 | 6729.6 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.42909 | acc=0.7469 | tpr=0.9787 | fpr=0.2573 | 6834.2 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.43068 | acc=0.7465 | tpr=0.9770 | fpr=0.2576 | 6699.7 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.43206 | acc=0.7461 | tpr=0.9781 | fpr=0.2581 | 6688.9 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.43292 | acc=0.7457 | tpr=0.9784 | fpr=0.2585 | 6682.5 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.43100 | acc=0.7463 | tpr=0.9777 | fpr=0.2579 | 12824.3 samples/s | 50.1 steps/s
Avg test loss: 0.43076, Avg test acc: 0.74639, Avg tpr: 0.97742, Avg fpr: 0.25781, total FA: 35796

server round 10/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=15.6] | Loss=0.15224 | Reg=0.00371 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.260 | L2-Norm(final)=2.454 | 3408.1 samples/s | 53.3 steps/s
[Step=8050 Epoch=15.7] | Loss=0.03864 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.236 | L2-Norm(final)=2.451 | 3436.7 samples/s | 53.7 steps/s
[Step=8100 Epoch=15.8] | Loss=0.03289 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.226 | L2-Norm(final)=2.454 | 3456.8 samples/s | 54.0 steps/s
[Step=8150 Epoch=15.9] | Loss=0.02972 | Reg=0.00369 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.222 | L2-Norm(final)=2.457 | 3438.6 samples/s | 53.7 steps/s
[Step=8200 Epoch=16.0] | Loss=0.02851 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.221 | L2-Norm(final)=2.461 | 3450.4 samples/s | 53.9 steps/s
[Step=8250 Epoch=16.1] | Loss=0.02729 | Reg=0.00369 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.463 | 3461.9 samples/s | 54.1 steps/s
[Step=8300 Epoch=16.2] | Loss=0.02719 | Reg=0.00369 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.465 | 3464.9 samples/s | 54.1 steps/s
[Step=8350 Epoch=16.3] | Loss=0.02650 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.221 | L2-Norm(final)=2.468 | 3465.3 samples/s | 54.1 steps/s
[Step=8400 Epoch=16.4] | Loss=0.02613 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.223 | L2-Norm(final)=2.470 | 3473.3 samples/s | 54.3 steps/s
[Step=8450 Epoch=16.5] | Loss=0.02595 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.224 | L2-Norm(final)=2.473 | 3449.1 samples/s | 53.9 steps/s
[Step=8500 Epoch=16.6] | Loss=0.02533 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.226 | L2-Norm(final)=2.475 | 4035.6 samples/s | 63.1 steps/s
[Step=8550 Epoch=16.7] | Loss=0.02453 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.228 | L2-Norm(final)=2.477 | 1569.6 samples/s | 24.5 steps/s
[Step=8600 Epoch=16.8] | Loss=0.02422 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.230 | L2-Norm(final)=2.480 | 3399.2 samples/s | 53.1 steps/s
[Step=8650 Epoch=16.9] | Loss=0.02348 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.232 | L2-Norm(final)=2.482 | 3438.2 samples/s | 53.7 steps/s
[Step=8700 Epoch=17.0] | Loss=0.02285 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.234 | L2-Norm(final)=2.485 | 3481.1 samples/s | 54.4 steps/s
[Step=8750 Epoch=17.1] | Loss=0.02254 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.236 | L2-Norm(final)=2.487 | 3482.4 samples/s | 54.4 steps/s
[Step=8800 Epoch=17.2] | Loss=0.02236 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.238 | L2-Norm(final)=2.490 | 3485.4 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step8800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=15.6] | Loss=0.06900 | Reg=0.00371 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.260 | L2-Norm(final)=2.455 | 3710.6 samples/s | 58.0 steps/s
[Step=8050 Epoch=15.7] | Loss=0.02916 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.235 | L2-Norm(final)=2.455 | 3354.3 samples/s | 52.4 steps/s
[Step=8100 Epoch=15.8] | Loss=0.02531 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.229 | L2-Norm(final)=2.462 | 3465.9 samples/s | 54.2 steps/s
[Step=8150 Epoch=15.9] | Loss=0.02620 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.227 | L2-Norm(final)=2.468 | 3428.7 samples/s | 53.6 steps/s
[Step=8200 Epoch=16.0] | Loss=0.02472 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.224 | L2-Norm(final)=2.469 | 3439.3 samples/s | 53.7 steps/s
[Step=8250 Epoch=16.1] | Loss=0.02397 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.222 | L2-Norm(final)=2.471 | 3461.2 samples/s | 54.1 steps/s
[Step=8300 Epoch=16.2] | Loss=0.02410 | Reg=0.00369 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.222 | L2-Norm(final)=2.474 | 3467.5 samples/s | 54.2 steps/s
[Step=8350 Epoch=16.3] | Loss=0.02412 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.223 | L2-Norm(final)=2.476 | 3477.3 samples/s | 54.3 steps/s
[Step=8400 Epoch=16.4] | Loss=0.02415 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.224 | L2-Norm(final)=2.479 | 3462.5 samples/s | 54.1 steps/s
[Step=8450 Epoch=16.5] | Loss=0.02400 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.226 | L2-Norm(final)=2.480 | 3489.3 samples/s | 54.5 steps/s
[Step=8500 Epoch=16.6] | Loss=0.02396 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.228 | L2-Norm(final)=2.482 | 4074.0 samples/s | 63.7 steps/s
[Step=8550 Epoch=16.7] | Loss=0.02335 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.230 | L2-Norm(final)=2.484 | 1614.8 samples/s | 25.2 steps/s
[Step=8600 Epoch=16.8] | Loss=0.02296 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.232 | L2-Norm(final)=2.486 | 3419.4 samples/s | 53.4 steps/s
[Step=8650 Epoch=16.9] | Loss=0.02261 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.234 | L2-Norm(final)=2.487 | 3454.7 samples/s | 54.0 steps/s
[Step=8700 Epoch=17.0] | Loss=0.02251 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=2.489 | 3478.9 samples/s | 54.4 steps/s
[Step=8750 Epoch=17.1] | Loss=0.02208 | Reg=0.00370 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.237 | L2-Norm(final)=2.491 | 3454.5 samples/s | 54.0 steps/s
[Step=8800 Epoch=17.2] | Loss=0.02167 | Reg=0.00370 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.240 | L2-Norm(final)=2.494 | 3486.2 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step8800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=30.7] | Loss=0.21546 | Reg=0.00371 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.260 | L2-Norm(final)=2.454 | 3737.2 samples/s | 58.4 steps/s
[Step=8050 Epoch=30.8] | Loss=0.01174 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.218 | L2-Norm(final)=2.449 | 3090.8 samples/s | 48.3 steps/s
[Step=8100 Epoch=31.0] | Loss=0.00642 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.209 | L2-Norm(final)=2.450 | 3295.7 samples/s | 51.5 steps/s
[Step=8150 Epoch=31.2] | Loss=0.00465 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.453 | 3314.4 samples/s | 51.8 steps/s
[Step=8200 Epoch=31.4] | Loss=0.00357 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.198 | L2-Norm(final)=2.457 | 3309.7 samples/s | 51.7 steps/s
[Step=8250 Epoch=31.6] | Loss=0.00290 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.194 | L2-Norm(final)=2.460 | 3980.7 samples/s | 62.2 steps/s
[Step=8300 Epoch=31.8] | Loss=0.00243 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.191 | L2-Norm(final)=2.463 | 1541.5 samples/s | 24.1 steps/s
[Step=8350 Epoch=32.0] | Loss=0.00210 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.187 | L2-Norm(final)=2.466 | 3334.7 samples/s | 52.1 steps/s
[Step=8400 Epoch=32.2] | Loss=0.00184 | Reg=0.00368 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.184 | L2-Norm(final)=2.468 | 3317.7 samples/s | 51.8 steps/s
[Step=8450 Epoch=32.4] | Loss=0.00164 | Reg=0.00368 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.181 | L2-Norm(final)=2.470 | 3318.2 samples/s | 51.8 steps/s
[Step=8500 Epoch=32.6] | Loss=0.00149 | Reg=0.00368 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.178 | L2-Norm(final)=2.471 | 3586.6 samples/s | 56.0 steps/s
[Step=8550 Epoch=32.8] | Loss=0.00136 | Reg=0.00368 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.175 | L2-Norm(final)=2.473 | 1617.4 samples/s | 25.3 steps/s
[Step=8600 Epoch=33.0] | Loss=0.00125 | Reg=0.00368 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.173 | L2-Norm(final)=2.474 | 3316.6 samples/s | 51.8 steps/s
[Step=8650 Epoch=33.1] | Loss=0.00116 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.170 | L2-Norm(final)=2.475 | 3292.8 samples/s | 51.5 steps/s
[Step=8700 Epoch=33.3] | Loss=0.00108 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.168 | L2-Norm(final)=2.476 | 3314.3 samples/s | 51.8 steps/s
[Step=8750 Epoch=33.5] | Loss=0.00101 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.166 | L2-Norm(final)=2.478 | 3306.1 samples/s | 51.7 steps/s
[Step=8800 Epoch=33.7] | Loss=0.00095 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.164 | L2-Norm(final)=2.479 | 1678.1 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step8800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=30.8] | Loss=0.07889 | Reg=0.00371 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.260 | L2-Norm(final)=2.455 | 3624.2 samples/s | 56.6 steps/s
[Step=8050 Epoch=31.0] | Loss=0.00959 | Reg=0.00370 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=2.457 | 3149.3 samples/s | 49.2 steps/s
[Step=8100 Epoch=31.2] | Loss=0.00558 | Reg=0.00370 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.231 | L2-Norm(final)=2.462 | 3286.4 samples/s | 51.3 steps/s
[Step=8150 Epoch=31.4] | Loss=0.00383 | Reg=0.00370 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.225 | L2-Norm(final)=2.466 | 3334.3 samples/s | 52.1 steps/s
[Step=8200 Epoch=31.6] | Loss=0.00311 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.469 | 3307.3 samples/s | 51.7 steps/s
[Step=8250 Epoch=31.8] | Loss=0.00254 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.216 | L2-Norm(final)=2.472 | 4013.8 samples/s | 62.7 steps/s
[Step=8300 Epoch=31.9] | Loss=0.00226 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.212 | L2-Norm(final)=2.475 | 1535.0 samples/s | 24.0 steps/s
[Step=8350 Epoch=32.1] | Loss=0.00196 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.209 | L2-Norm(final)=2.477 | 3264.1 samples/s | 51.0 steps/s
[Step=8400 Epoch=32.3] | Loss=0.00173 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.206 | L2-Norm(final)=2.479 | 3301.6 samples/s | 51.6 steps/s
[Step=8450 Epoch=32.5] | Loss=0.00154 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.480 | 3280.4 samples/s | 51.3 steps/s
[Step=8500 Epoch=32.7] | Loss=0.00140 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.200 | L2-Norm(final)=2.482 | 3635.1 samples/s | 56.8 steps/s
[Step=8550 Epoch=32.9] | Loss=0.00127 | Reg=0.00369 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.197 | L2-Norm(final)=2.483 | 1592.0 samples/s | 24.9 steps/s
[Step=8600 Epoch=33.1] | Loss=0.00117 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.193 | L2-Norm(final)=2.484 | 3331.9 samples/s | 52.1 steps/s
[Step=8650 Epoch=33.3] | Loss=0.00108 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.191 | L2-Norm(final)=2.485 | 3301.3 samples/s | 51.6 steps/s
[Step=8700 Epoch=33.5] | Loss=0.00101 | Reg=0.00368 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.188 | L2-Norm(final)=2.486 | 3300.6 samples/s | 51.6 steps/s
[Step=8750 Epoch=33.7] | Loss=0.00095 | Reg=0.00368 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.185 | L2-Norm(final)=2.487 | 3329.2 samples/s | 52.0 steps/s
[Step=8800 Epoch=33.9] | Loss=0.00089 | Reg=0.00368 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.183 | L2-Norm(final)=2.488 | 1636.8 samples/s | 25.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17647 | acc=0.8705 | tpr=0.8234 | fpr=0.0273 | 3687.9 samples/s | 14.4 steps/s
Avg test loss: 0.17876, Avg test acc: 0.86822, Avg tpr: 0.82229, Avg fpr: 0.03077, total FA: 240

Testing server on iccad2012
[Step=  50] | Loss=0.48656 | acc=0.7537 | tpr=0.9779 | fpr=0.2504 | 3648.4 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.48667 | acc=0.7520 | tpr=0.9872 | fpr=0.2524 | 6784.5 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.48908 | acc=0.7505 | tpr=0.9885 | fpr=0.2538 | 6737.8 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.49031 | acc=0.7506 | tpr=0.9902 | fpr=0.2537 | 6826.0 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.49103 | acc=0.7493 | tpr=0.9869 | fpr=0.2550 | 6820.6 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.49131 | acc=0.7503 | tpr=0.9862 | fpr=0.2540 | 6980.3 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.49247 | acc=0.7503 | tpr=0.9843 | fpr=0.2539 | 6617.9 samples/s | 25.9 steps/s
[Step= 400] | Loss=0.49410 | acc=0.7502 | tpr=0.9814 | fpr=0.2540 | 6969.5 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.49566 | acc=0.7500 | tpr=0.9820 | fpr=0.2542 | 6821.4 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.49666 | acc=0.7495 | tpr=0.9824 | fpr=0.2547 | 6471.1 samples/s | 25.3 steps/s
[Step= 550] | Loss=0.49438 | acc=0.7502 | tpr=0.9817 | fpr=0.2540 | 12582.8 samples/s | 49.2 steps/s
Avg test loss: 0.49406, Avg test acc: 0.75033, Avg tpr: 0.98138, Avg fpr: 0.25387, total FA: 35249

server round 11/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=17.2] | Loss=0.08847 | Reg=0.00368 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=19.182 | L2-Norm(final)=2.510 | 3655.3 samples/s | 57.1 steps/s
[Step=8850 Epoch=17.3] | Loss=0.02665 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.157 | L2-Norm(final)=2.508 | 3204.9 samples/s | 50.1 steps/s
[Step=8900 Epoch=17.4] | Loss=0.02360 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.150 | L2-Norm(final)=2.512 | 3458.5 samples/s | 54.0 steps/s
[Step=8950 Epoch=17.5] | Loss=0.02590 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.515 | 3450.3 samples/s | 53.9 steps/s
[Step=9000 Epoch=17.6] | Loss=0.02565 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.146 | L2-Norm(final)=2.514 | 3448.3 samples/s | 53.9 steps/s
[Step=9050 Epoch=17.7] | Loss=0.02465 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.146 | L2-Norm(final)=2.515 | 3472.8 samples/s | 54.3 steps/s
[Step=9100 Epoch=17.7] | Loss=0.02425 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.148 | L2-Norm(final)=2.517 | 3473.1 samples/s | 54.3 steps/s
[Step=9150 Epoch=17.8] | Loss=0.02426 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.519 | 3478.3 samples/s | 54.3 steps/s
[Step=9200 Epoch=17.9] | Loss=0.02435 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.150 | L2-Norm(final)=2.521 | 3516.9 samples/s | 55.0 steps/s
[Step=9250 Epoch=18.0] | Loss=0.02411 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.152 | L2-Norm(final)=2.523 | 3464.2 samples/s | 54.1 steps/s
[Step=9300 Epoch=18.1] | Loss=0.02412 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.155 | L2-Norm(final)=2.525 | 4064.9 samples/s | 63.5 steps/s
[Step=9350 Epoch=18.2] | Loss=0.02354 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.157 | L2-Norm(final)=2.527 | 1549.1 samples/s | 24.2 steps/s
[Step=9400 Epoch=18.3] | Loss=0.02291 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.160 | L2-Norm(final)=2.529 | 3449.6 samples/s | 53.9 steps/s
[Step=9450 Epoch=18.4] | Loss=0.02245 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.163 | L2-Norm(final)=2.532 | 3466.6 samples/s | 54.2 steps/s
[Step=9500 Epoch=18.5] | Loss=0.02217 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.166 | L2-Norm(final)=2.534 | 3467.9 samples/s | 54.2 steps/s
[Step=9550 Epoch=18.6] | Loss=0.02185 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.168 | L2-Norm(final)=2.537 | 3473.5 samples/s | 54.3 steps/s
[Step=9600 Epoch=18.7] | Loss=0.02154 | Reg=0.00368 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.171 | L2-Norm(final)=2.539 | 3486.1 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step9600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=17.2] | Loss=0.03922 | Reg=0.00368 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=19.182 | L2-Norm(final)=2.511 | 3672.6 samples/s | 57.4 steps/s
[Step=8850 Epoch=17.3] | Loss=0.02584 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.158 | L2-Norm(final)=2.504 | 3148.1 samples/s | 49.2 steps/s
[Step=8900 Epoch=17.4] | Loss=0.02142 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.152 | L2-Norm(final)=2.512 | 3077.9 samples/s | 48.1 steps/s
[Step=8950 Epoch=17.5] | Loss=0.02295 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.150 | L2-Norm(final)=2.517 | 3081.3 samples/s | 48.1 steps/s
[Step=9000 Epoch=17.6] | Loss=0.02272 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.518 | 2990.2 samples/s | 46.7 steps/s
[Step=9050 Epoch=17.7] | Loss=0.02233 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.148 | L2-Norm(final)=2.520 | 3125.5 samples/s | 48.8 steps/s
[Step=9100 Epoch=17.8] | Loss=0.02203 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.148 | L2-Norm(final)=2.522 | 3368.9 samples/s | 52.6 steps/s
[Step=9150 Epoch=17.9] | Loss=0.02198 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.149 | L2-Norm(final)=2.524 | 3364.7 samples/s | 52.6 steps/s
[Step=9200 Epoch=18.0] | Loss=0.02229 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.151 | L2-Norm(final)=2.527 | 3366.3 samples/s | 52.6 steps/s
[Step=9250 Epoch=18.1] | Loss=0.02231 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.153 | L2-Norm(final)=2.529 | 3381.8 samples/s | 52.8 steps/s
[Step=9300 Epoch=18.2] | Loss=0.02222 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.155 | L2-Norm(final)=2.531 | 4033.7 samples/s | 63.0 steps/s
[Step=9350 Epoch=18.3] | Loss=0.02172 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.157 | L2-Norm(final)=2.532 | 1592.2 samples/s | 24.9 steps/s
[Step=9400 Epoch=18.4] | Loss=0.02136 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.159 | L2-Norm(final)=2.534 | 3399.1 samples/s | 53.1 steps/s
[Step=9450 Epoch=18.5] | Loss=0.02100 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.162 | L2-Norm(final)=2.536 | 3438.9 samples/s | 53.7 steps/s
[Step=9500 Epoch=18.6] | Loss=0.02111 | Reg=0.00367 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.164 | L2-Norm(final)=2.538 | 3438.7 samples/s | 53.7 steps/s
[Step=9550 Epoch=18.7] | Loss=0.02088 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.166 | L2-Norm(final)=2.539 | 3463.6 samples/s | 54.1 steps/s
[Step=9600 Epoch=18.8] | Loss=0.02085 | Reg=0.00367 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.168 | L2-Norm(final)=2.540 | 3474.1 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step9600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=33.7] | Loss=0.10474 | Reg=0.00368 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.182 | L2-Norm(final)=2.511 | 3802.7 samples/s | 59.4 steps/s
[Step=8850 Epoch=33.9] | Loss=0.01151 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.160 | L2-Norm(final)=2.495 | 3262.1 samples/s | 51.0 steps/s
[Step=8900 Epoch=34.1] | Loss=0.00736 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.158 | L2-Norm(final)=2.494 | 3334.9 samples/s | 52.1 steps/s
[Step=8950 Epoch=34.3] | Loss=0.00552 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.157 | L2-Norm(final)=2.496 | 3316.7 samples/s | 51.8 steps/s
[Step=9000 Epoch=34.5] | Loss=0.00438 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.155 | L2-Norm(final)=2.498 | 3324.1 samples/s | 51.9 steps/s
[Step=9050 Epoch=34.7] | Loss=0.00372 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.152 | L2-Norm(final)=2.500 | 4010.6 samples/s | 62.7 steps/s
[Step=9100 Epoch=34.9] | Loss=0.00324 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.150 | L2-Norm(final)=2.502 | 1560.1 samples/s | 24.4 steps/s
[Step=9150 Epoch=35.1] | Loss=0.00279 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.147 | L2-Norm(final)=2.505 | 3329.7 samples/s | 52.0 steps/s
[Step=9200 Epoch=35.3] | Loss=0.00245 | Reg=0.00366 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.507 | 3318.6 samples/s | 51.9 steps/s
[Step=9250 Epoch=35.4] | Loss=0.00219 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.140 | L2-Norm(final)=2.509 | 3318.9 samples/s | 51.9 steps/s
[Step=9300 Epoch=35.6] | Loss=0.00197 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.510 | 3305.5 samples/s | 51.6 steps/s
[Step=9350 Epoch=35.8] | Loss=0.00180 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.512 | 1540.6 samples/s | 24.1 steps/s
[Step=9400 Epoch=36.0] | Loss=0.00165 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.131 | L2-Norm(final)=2.513 | 3256.4 samples/s | 50.9 steps/s
[Step=9450 Epoch=36.2] | Loss=0.00153 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.128 | L2-Norm(final)=2.514 | 3254.9 samples/s | 50.9 steps/s
[Step=9500 Epoch=36.4] | Loss=0.00142 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.125 | L2-Norm(final)=2.516 | 3276.9 samples/s | 51.2 steps/s
[Step=9550 Epoch=36.6] | Loss=0.00133 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.122 | L2-Norm(final)=2.517 | 3332.7 samples/s | 52.1 steps/s
[Step=9600 Epoch=36.8] | Loss=0.00125 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.119 | L2-Norm(final)=2.518 | 1695.5 samples/s | 26.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step9600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=33.9] | Loss=0.15983 | Reg=0.00368 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=19.182 | L2-Norm(final)=2.510 | 3697.9 samples/s | 57.8 steps/s
[Step=8850 Epoch=34.1] | Loss=0.01283 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.164 | L2-Norm(final)=2.495 | 3143.7 samples/s | 49.1 steps/s
[Step=8900 Epoch=34.3] | Loss=0.00780 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.165 | L2-Norm(final)=2.492 | 3306.4 samples/s | 51.7 steps/s
[Step=8950 Epoch=34.5] | Loss=0.00547 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.162 | L2-Norm(final)=2.495 | 3296.4 samples/s | 51.5 steps/s
[Step=9000 Epoch=34.6] | Loss=0.00420 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.159 | L2-Norm(final)=2.499 | 3300.7 samples/s | 51.6 steps/s
[Step=9050 Epoch=34.8] | Loss=0.00340 | Reg=0.00367 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.155 | L2-Norm(final)=2.503 | 4000.8 samples/s | 62.5 steps/s
[Step=9100 Epoch=35.0] | Loss=0.00285 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.150 | L2-Norm(final)=2.506 | 1545.1 samples/s | 24.1 steps/s
[Step=9150 Epoch=35.2] | Loss=0.00245 | Reg=0.00367 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.146 | L2-Norm(final)=2.509 | 3270.7 samples/s | 51.1 steps/s
[Step=9200 Epoch=35.4] | Loss=0.00215 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.142 | L2-Norm(final)=2.511 | 3301.2 samples/s | 51.6 steps/s
[Step=9250 Epoch=35.6] | Loss=0.00192 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.513 | 3301.5 samples/s | 51.6 steps/s
[Step=9300 Epoch=35.8] | Loss=0.00173 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.133 | L2-Norm(final)=2.515 | 3650.0 samples/s | 57.0 steps/s
[Step=9350 Epoch=36.0] | Loss=0.00158 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.130 | L2-Norm(final)=2.516 | 1605.7 samples/s | 25.1 steps/s
[Step=9400 Epoch=36.2] | Loss=0.00145 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.126 | L2-Norm(final)=2.518 | 3293.6 samples/s | 51.5 steps/s
[Step=9450 Epoch=36.4] | Loss=0.00134 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.123 | L2-Norm(final)=2.519 | 3316.7 samples/s | 51.8 steps/s
[Step=9500 Epoch=36.6] | Loss=0.00125 | Reg=0.00366 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.120 | L2-Norm(final)=2.520 | 3321.4 samples/s | 51.9 steps/s
[Step=9550 Epoch=36.8] | Loss=0.00117 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.117 | L2-Norm(final)=2.522 | 3362.3 samples/s | 52.5 steps/s
[Step=9600 Epoch=37.0] | Loss=0.00110 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.114 | L2-Norm(final)=2.523 | 1659.8 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.15500 | acc=0.8864 | tpr=0.8487 | fpr=0.0317 | 3701.8 samples/s | 14.5 steps/s
Avg test loss: 0.15724, Avg test acc: 0.88417, Avg tpr: 0.84846, Avg fpr: 0.03730, total FA: 291

Testing server on iccad2012
[Step=  50] | Loss=0.47646 | acc=0.7577 | tpr=0.9867 | fpr=0.2465 | 3667.2 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.47712 | acc=0.7568 | tpr=0.9915 | fpr=0.2475 | 6639.9 samples/s | 25.9 steps/s
[Step= 150] | Loss=0.47880 | acc=0.7562 | tpr=0.9942 | fpr=0.2482 | 6721.2 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.47984 | acc=0.7564 | tpr=0.9923 | fpr=0.2479 | 6763.6 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.48098 | acc=0.7544 | tpr=0.9895 | fpr=0.2499 | 6879.6 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.48163 | acc=0.7549 | tpr=0.9891 | fpr=0.2494 | 6931.0 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.48284 | acc=0.7551 | tpr=0.9875 | fpr=0.2491 | 6703.5 samples/s | 26.2 steps/s
[Step= 400] | Loss=0.48429 | acc=0.7550 | tpr=0.9847 | fpr=0.2491 | 6701.6 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.48570 | acc=0.7550 | tpr=0.9849 | fpr=0.2491 | 6759.3 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.48626 | acc=0.7544 | tpr=0.9850 | fpr=0.2498 | 6872.4 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.48419 | acc=0.7550 | tpr=0.9841 | fpr=0.2491 | 12363.1 samples/s | 48.3 steps/s
Avg test loss: 0.48389, Avg test acc: 0.75515, Avg tpr: 0.98376, Avg fpr: 0.24901, total FA: 34574

server round 12/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=18.7] | Loss=0.13773 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=19.110 | L2-Norm(final)=2.549 | 3440.5 samples/s | 53.8 steps/s
[Step=9650 Epoch=18.8] | Loss=0.02858 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.090 | L2-Norm(final)=2.549 | 3427.9 samples/s | 53.6 steps/s
[Step=9700 Epoch=18.9] | Loss=0.02543 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.084 | L2-Norm(final)=2.555 | 3480.2 samples/s | 54.4 steps/s
[Step=9750 Epoch=19.0] | Loss=0.02383 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.081 | L2-Norm(final)=2.558 | 3478.5 samples/s | 54.4 steps/s
[Step=9800 Epoch=19.1] | Loss=0.02371 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.080 | L2-Norm(final)=2.560 | 3482.6 samples/s | 54.4 steps/s
[Step=9850 Epoch=19.2] | Loss=0.02426 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.079 | L2-Norm(final)=2.560 | 3469.3 samples/s | 54.2 steps/s
[Step=9900 Epoch=19.3] | Loss=0.02379 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.080 | L2-Norm(final)=2.561 | 3450.4 samples/s | 53.9 steps/s
[Step=9950 Epoch=19.4] | Loss=0.02320 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.081 | L2-Norm(final)=2.562 | 3500.7 samples/s | 54.7 steps/s
[Step=10000 Epoch=19.5] | Loss=0.02358 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.083 | L2-Norm(final)=2.564 | 3476.6 samples/s | 54.3 steps/s
[Step=10050 Epoch=19.6] | Loss=0.02309 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.085 | L2-Norm(final)=2.566 | 3486.3 samples/s | 54.5 steps/s
[Step=10100 Epoch=19.7] | Loss=0.02305 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.087 | L2-Norm(final)=2.567 | 4042.6 samples/s | 63.2 steps/s
[Step=10150 Epoch=19.8] | Loss=0.02227 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.090 | L2-Norm(final)=2.569 | 1533.1 samples/s | 24.0 steps/s
[Step=10200 Epoch=19.9] | Loss=0.02165 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.092 | L2-Norm(final)=2.571 | 3461.9 samples/s | 54.1 steps/s
[Step=10250 Epoch=20.0] | Loss=0.02123 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.094 | L2-Norm(final)=2.573 | 3457.1 samples/s | 54.0 steps/s
[Step=10300 Epoch=20.1] | Loss=0.02098 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.096 | L2-Norm(final)=2.575 | 3450.0 samples/s | 53.9 steps/s
[Step=10350 Epoch=20.2] | Loss=0.02065 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.098 | L2-Norm(final)=2.577 | 3444.5 samples/s | 53.8 steps/s
[Step=10400 Epoch=20.3] | Loss=0.02052 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.100 | L2-Norm(final)=2.579 | 3475.1 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step10400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=18.8] | Loss=0.17298 | Reg=0.00365 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=19.110 | L2-Norm(final)=2.548 | 3758.0 samples/s | 58.7 steps/s
[Step=9650 Epoch=18.9] | Loss=0.03032 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.081 | L2-Norm(final)=2.540 | 3340.0 samples/s | 52.2 steps/s
[Step=9700 Epoch=19.0] | Loss=0.02613 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.075 | L2-Norm(final)=2.543 | 3459.8 samples/s | 54.1 steps/s
[Step=9750 Epoch=19.1] | Loss=0.02333 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.073 | L2-Norm(final)=2.545 | 3467.6 samples/s | 54.2 steps/s
[Step=9800 Epoch=19.2] | Loss=0.02249 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.073 | L2-Norm(final)=2.548 | 3445.4 samples/s | 53.8 steps/s
[Step=9850 Epoch=19.3] | Loss=0.02363 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.073 | L2-Norm(final)=2.550 | 3445.3 samples/s | 53.8 steps/s
[Step=9900 Epoch=19.4] | Loss=0.02341 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.074 | L2-Norm(final)=2.552 | 3469.9 samples/s | 54.2 steps/s
[Step=9950 Epoch=19.5] | Loss=0.02301 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.076 | L2-Norm(final)=2.553 | 3457.6 samples/s | 54.0 steps/s
[Step=10000 Epoch=19.5] | Loss=0.02251 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.079 | L2-Norm(final)=2.556 | 3468.9 samples/s | 54.2 steps/s
[Step=10050 Epoch=19.6] | Loss=0.02234 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.081 | L2-Norm(final)=2.557 | 3455.1 samples/s | 54.0 steps/s
[Step=10100 Epoch=19.7] | Loss=0.02186 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.083 | L2-Norm(final)=2.559 | 4081.7 samples/s | 63.8 steps/s
[Step=10150 Epoch=19.8] | Loss=0.02108 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.086 | L2-Norm(final)=2.561 | 1601.9 samples/s | 25.0 steps/s
[Step=10200 Epoch=19.9] | Loss=0.02072 | Reg=0.00364 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.088 | L2-Norm(final)=2.563 | 3441.8 samples/s | 53.8 steps/s
[Step=10250 Epoch=20.0] | Loss=0.02055 | Reg=0.00364 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.091 | L2-Norm(final)=2.565 | 3459.0 samples/s | 54.0 steps/s
[Step=10300 Epoch=20.1] | Loss=0.02013 | Reg=0.00365 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.093 | L2-Norm(final)=2.566 | 3468.0 samples/s | 54.2 steps/s
[Step=10350 Epoch=20.2] | Loss=0.01980 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.095 | L2-Norm(final)=2.568 | 3381.9 samples/s | 52.8 steps/s
[Step=10400 Epoch=20.3] | Loss=0.01972 | Reg=0.00365 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.097 | L2-Norm(final)=2.569 | 3465.9 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step10400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=36.8] | Loss=0.14758 | Reg=0.00365 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=19.110 | L2-Norm(final)=2.549 | 3897.3 samples/s | 60.9 steps/s
[Step=9650 Epoch=37.0] | Loss=0.01494 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.096 | L2-Norm(final)=2.531 | 2916.2 samples/s | 45.6 steps/s
[Step=9700 Epoch=37.2] | Loss=0.00825 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.097 | L2-Norm(final)=2.530 | 3246.1 samples/s | 50.7 steps/s
[Step=9750 Epoch=37.4] | Loss=0.00567 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.092 | L2-Norm(final)=2.533 | 3273.0 samples/s | 51.1 steps/s
[Step=9800 Epoch=37.6] | Loss=0.00431 | Reg=0.00364 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.087 | L2-Norm(final)=2.537 | 3271.6 samples/s | 51.1 steps/s
[Step=9850 Epoch=37.7] | Loss=0.00346 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.081 | L2-Norm(final)=2.540 | 3996.1 samples/s | 62.4 steps/s
[Step=9900 Epoch=37.9] | Loss=0.00289 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.076 | L2-Norm(final)=2.543 | 1451.4 samples/s | 22.7 steps/s
[Step=9950 Epoch=38.1] | Loss=0.00249 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.071 | L2-Norm(final)=2.545 | 3122.0 samples/s | 48.8 steps/s
[Step=10000 Epoch=38.3] | Loss=0.00218 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.067 | L2-Norm(final)=2.547 | 3226.6 samples/s | 50.4 steps/s
[Step=10050 Epoch=38.5] | Loss=0.00195 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.063 | L2-Norm(final)=2.549 | 3226.7 samples/s | 50.4 steps/s
[Step=10100 Epoch=38.7] | Loss=0.00176 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.059 | L2-Norm(final)=2.551 | 3496.8 samples/s | 54.6 steps/s
[Step=10150 Epoch=38.9] | Loss=0.00160 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.055 | L2-Norm(final)=2.552 | 1608.6 samples/s | 25.1 steps/s
[Step=10200 Epoch=39.1] | Loss=0.00147 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.052 | L2-Norm(final)=2.553 | 3274.2 samples/s | 51.2 steps/s
[Step=10250 Epoch=39.3] | Loss=0.00136 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.048 | L2-Norm(final)=2.554 | 3297.8 samples/s | 51.5 steps/s
[Step=10300 Epoch=39.5] | Loss=0.00127 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.045 | L2-Norm(final)=2.556 | 3282.0 samples/s | 51.3 steps/s
[Step=10350 Epoch=39.7] | Loss=0.00119 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.042 | L2-Norm(final)=2.557 | 3287.0 samples/s | 51.4 steps/s
[Step=10400 Epoch=39.8] | Loss=0.00111 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.039 | L2-Norm(final)=2.558 | 1663.5 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step10400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=37.0] | Loss=0.08524 | Reg=0.00365 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.110 | L2-Norm(final)=2.550 | 3597.7 samples/s | 56.2 steps/s
[Step=9650 Epoch=37.1] | Loss=0.01493 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.103 | L2-Norm(final)=2.540 | 3229.7 samples/s | 50.5 steps/s
[Step=9700 Epoch=37.3] | Loss=0.00784 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.106 | L2-Norm(final)=2.538 | 3318.5 samples/s | 51.9 steps/s
[Step=9750 Epoch=37.5] | Loss=0.00533 | Reg=0.00365 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.099 | L2-Norm(final)=2.540 | 3328.2 samples/s | 52.0 steps/s
[Step=9800 Epoch=37.7] | Loss=0.00406 | Reg=0.00365 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.093 | L2-Norm(final)=2.544 | 3288.4 samples/s | 51.4 steps/s
[Step=9850 Epoch=37.9] | Loss=0.00329 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.086 | L2-Norm(final)=2.546 | 4004.4 samples/s | 62.6 steps/s
[Step=9900 Epoch=38.1] | Loss=0.00276 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.081 | L2-Norm(final)=2.549 | 1551.6 samples/s | 24.2 steps/s
[Step=9950 Epoch=38.3] | Loss=0.00238 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.076 | L2-Norm(final)=2.552 | 3289.0 samples/s | 51.4 steps/s
[Step=10000 Epoch=38.5] | Loss=0.00209 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.071 | L2-Norm(final)=2.554 | 3307.8 samples/s | 51.7 steps/s
[Step=10050 Epoch=38.7] | Loss=0.00186 | Reg=0.00364 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.066 | L2-Norm(final)=2.555 | 3317.5 samples/s | 51.8 steps/s
[Step=10100 Epoch=38.9] | Loss=0.00168 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.062 | L2-Norm(final)=2.557 | 3656.1 samples/s | 57.1 steps/s
[Step=10150 Epoch=39.1] | Loss=0.00153 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.058 | L2-Norm(final)=2.558 | 1599.1 samples/s | 25.0 steps/s
[Step=10200 Epoch=39.3] | Loss=0.00141 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.055 | L2-Norm(final)=2.559 | 3292.8 samples/s | 51.5 steps/s
[Step=10250 Epoch=39.5] | Loss=0.00130 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.051 | L2-Norm(final)=2.560 | 3302.2 samples/s | 51.6 steps/s
[Step=10300 Epoch=39.6] | Loss=0.00121 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.048 | L2-Norm(final)=2.561 | 3294.1 samples/s | 51.5 steps/s
[Step=10350 Epoch=39.8] | Loss=0.00113 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.045 | L2-Norm(final)=2.562 | 3364.1 samples/s | 52.6 steps/s
[Step=10400 Epoch=40.0] | Loss=0.00106 | Reg=0.00363 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.042 | L2-Norm(final)=2.563 | 1661.0 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.14898 | acc=0.8920 | tpr=0.8543 | fpr=0.0263 | 3609.2 samples/s | 14.1 steps/s
Avg test loss: 0.15158, Avg test acc: 0.88901, Avg tpr: 0.85196, Avg fpr: 0.02948, total FA: 230

Testing server on iccad2012
[Step=  50] | Loss=0.51035 | acc=0.7423 | tpr=0.9779 | fpr=0.2620 | 3639.7 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.51290 | acc=0.7407 | tpr=0.9851 | fpr=0.2638 | 6787.2 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.51452 | acc=0.7398 | tpr=0.9885 | fpr=0.2648 | 6955.4 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.51537 | acc=0.7395 | tpr=0.9902 | fpr=0.2651 | 6775.5 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.51701 | acc=0.7375 | tpr=0.9869 | fpr=0.2670 | 6909.9 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.51713 | acc=0.7385 | tpr=0.9862 | fpr=0.2660 | 6866.3 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.51837 | acc=0.7391 | tpr=0.9850 | fpr=0.2654 | 6932.0 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.52003 | acc=0.7388 | tpr=0.9825 | fpr=0.2657 | 6638.0 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.52124 | acc=0.7386 | tpr=0.9830 | fpr=0.2658 | 6617.2 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.52228 | acc=0.7381 | tpr=0.9833 | fpr=0.2663 | 6792.5 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.51999 | acc=0.7387 | tpr=0.9829 | fpr=0.2657 | 13132.2 samples/s | 51.3 steps/s
Avg test loss: 0.51963, Avg test acc: 0.73879, Avg tpr: 0.98257, Avg fpr: 0.26564, total FA: 36884

server round 13/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=20.3] | Loss=0.09288 | Reg=0.00362 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=19.037 | L2-Norm(final)=2.584 | 3523.6 samples/s | 55.1 steps/s
[Step=10450 Epoch=20.4] | Loss=0.02514 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.009 | L2-Norm(final)=2.584 | 3250.9 samples/s | 50.8 steps/s
[Step=10500 Epoch=20.5] | Loss=0.02445 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.005 | L2-Norm(final)=2.586 | 3347.2 samples/s | 52.3 steps/s
[Step=10550 Epoch=20.6] | Loss=0.02376 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.004 | L2-Norm(final)=2.588 | 3447.4 samples/s | 53.9 steps/s
[Step=10600 Epoch=20.7] | Loss=0.02260 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=19.003 | L2-Norm(final)=2.591 | 3455.8 samples/s | 54.0 steps/s
[Step=10650 Epoch=20.8] | Loss=0.02235 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.004 | L2-Norm(final)=2.593 | 3472.6 samples/s | 54.3 steps/s
[Step=10700 Epoch=20.9] | Loss=0.02266 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.007 | L2-Norm(final)=2.595 | 3463.4 samples/s | 54.1 steps/s
[Step=10750 Epoch=21.0] | Loss=0.02207 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.010 | L2-Norm(final)=2.598 | 3448.3 samples/s | 53.9 steps/s
[Step=10800 Epoch=21.1] | Loss=0.02255 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9062 | L2-Norm=19.013 | L2-Norm(final)=2.599 | 3467.0 samples/s | 54.2 steps/s
[Step=10850 Epoch=21.2] | Loss=0.02259 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.016 | L2-Norm(final)=2.600 | 3463.6 samples/s | 54.1 steps/s
[Step=10900 Epoch=21.3] | Loss=0.02293 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.019 | L2-Norm(final)=2.602 | 4047.4 samples/s | 63.2 steps/s
[Step=10950 Epoch=21.4] | Loss=0.02202 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.022 | L2-Norm(final)=2.603 | 1555.4 samples/s | 24.3 steps/s
[Step=11000 Epoch=21.5] | Loss=0.02160 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.025 | L2-Norm(final)=2.604 | 3468.4 samples/s | 54.2 steps/s
[Step=11050 Epoch=21.6] | Loss=0.02141 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.028 | L2-Norm(final)=2.605 | 3442.2 samples/s | 53.8 steps/s
[Step=11100 Epoch=21.6] | Loss=0.02094 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.030 | L2-Norm(final)=2.606 | 3468.5 samples/s | 54.2 steps/s
[Step=11150 Epoch=21.7] | Loss=0.02054 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.032 | L2-Norm(final)=2.608 | 3465.2 samples/s | 54.1 steps/s
[Step=11200 Epoch=21.8] | Loss=0.02016 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.035 | L2-Norm(final)=2.609 | 3447.3 samples/s | 53.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step11200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=20.3] | Loss=0.06458 | Reg=0.00362 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=19.037 | L2-Norm(final)=2.584 | 3883.1 samples/s | 60.7 steps/s
[Step=10450 Epoch=20.4] | Loss=0.02191 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.003 | L2-Norm(final)=2.584 | 3228.4 samples/s | 50.4 steps/s
[Step=10500 Epoch=20.5] | Loss=0.02013 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.000 | L2-Norm(final)=2.591 | 3469.0 samples/s | 54.2 steps/s
[Step=10550 Epoch=20.6] | Loss=0.02123 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.001 | L2-Norm(final)=2.596 | 3445.0 samples/s | 53.8 steps/s
[Step=10600 Epoch=20.7] | Loss=0.02210 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.003 | L2-Norm(final)=2.600 | 3457.6 samples/s | 54.0 steps/s
[Step=10650 Epoch=20.8] | Loss=0.02160 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.006 | L2-Norm(final)=2.604 | 3493.6 samples/s | 54.6 steps/s
[Step=10700 Epoch=20.9] | Loss=0.02144 | Reg=0.00361 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.010 | L2-Norm(final)=2.607 | 3457.5 samples/s | 54.0 steps/s
[Step=10750 Epoch=21.0] | Loss=0.02078 | Reg=0.00361 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.013 | L2-Norm(final)=2.610 | 3477.6 samples/s | 54.3 steps/s
[Step=10800 Epoch=21.1] | Loss=0.02036 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.016 | L2-Norm(final)=2.613 | 3476.6 samples/s | 54.3 steps/s
[Step=10850 Epoch=21.2] | Loss=0.02090 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.019 | L2-Norm(final)=2.614 | 3448.4 samples/s | 53.9 steps/s
[Step=10900 Epoch=21.3] | Loss=0.02110 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.021 | L2-Norm(final)=2.615 | 4089.9 samples/s | 63.9 steps/s
[Step=10950 Epoch=21.4] | Loss=0.02074 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.024 | L2-Norm(final)=2.615 | 1608.9 samples/s | 25.1 steps/s
[Step=11000 Epoch=21.5] | Loss=0.02063 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.026 | L2-Norm(final)=2.616 | 3442.2 samples/s | 53.8 steps/s
[Step=11050 Epoch=21.6] | Loss=0.02026 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=19.028 | L2-Norm(final)=2.616 | 3438.9 samples/s | 53.7 steps/s
[Step=11100 Epoch=21.7] | Loss=0.01976 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.030 | L2-Norm(final)=2.617 | 3466.0 samples/s | 54.2 steps/s
[Step=11150 Epoch=21.8] | Loss=0.01948 | Reg=0.00362 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=19.031 | L2-Norm(final)=2.618 | 3444.8 samples/s | 53.8 steps/s
[Step=11200 Epoch=21.9] | Loss=0.01939 | Reg=0.00362 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=19.033 | L2-Norm(final)=2.619 | 3464.0 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step11200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=39.9] | Loss=0.14623 | Reg=0.00362 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=19.037 | L2-Norm(final)=2.584 | 3847.0 samples/s | 60.1 steps/s
[Step=10450 Epoch=40.0] | Loss=0.01556 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.026 | L2-Norm(final)=2.574 | 3114.1 samples/s | 48.7 steps/s
[Step=10500 Epoch=40.2] | Loss=0.00828 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.029 | L2-Norm(final)=2.574 | 3328.0 samples/s | 52.0 steps/s
[Step=10550 Epoch=40.4] | Loss=0.00598 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.024 | L2-Norm(final)=2.576 | 3297.1 samples/s | 51.5 steps/s
[Step=10600 Epoch=40.6] | Loss=0.00457 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.019 | L2-Norm(final)=2.579 | 3331.1 samples/s | 52.0 steps/s
[Step=10650 Epoch=40.8] | Loss=0.00369 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.013 | L2-Norm(final)=2.581 | 3984.3 samples/s | 62.3 steps/s
[Step=10700 Epoch=41.0] | Loss=0.00308 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.009 | L2-Norm(final)=2.584 | 1542.0 samples/s | 24.1 steps/s
[Step=10750 Epoch=41.2] | Loss=0.00265 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=19.004 | L2-Norm(final)=2.586 | 3316.4 samples/s | 51.8 steps/s
[Step=10800 Epoch=41.4] | Loss=0.00232 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.999 | L2-Norm(final)=2.587 | 3311.2 samples/s | 51.7 steps/s
[Step=10850 Epoch=41.6] | Loss=0.00207 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.995 | L2-Norm(final)=2.589 | 3313.0 samples/s | 51.8 steps/s
[Step=10900 Epoch=41.8] | Loss=0.00187 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.991 | L2-Norm(final)=2.590 | 3599.6 samples/s | 56.2 steps/s
[Step=10950 Epoch=42.0] | Loss=0.00170 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.987 | L2-Norm(final)=2.591 | 1629.4 samples/s | 25.5 steps/s
[Step=11000 Epoch=42.1] | Loss=0.00156 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.983 | L2-Norm(final)=2.593 | 3290.3 samples/s | 51.4 steps/s
[Step=11050 Epoch=42.3] | Loss=0.00144 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.980 | L2-Norm(final)=2.594 | 3301.0 samples/s | 51.6 steps/s
[Step=11100 Epoch=42.5] | Loss=0.00134 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.977 | L2-Norm(final)=2.594 | 3318.0 samples/s | 51.8 steps/s
[Step=11150 Epoch=42.7] | Loss=0.00126 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.973 | L2-Norm(final)=2.595 | 3287.6 samples/s | 51.4 steps/s
[Step=11200 Epoch=42.9] | Loss=0.00118 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.971 | L2-Norm(final)=2.596 | 1668.7 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step11200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=40.0] | Loss=0.40913 | Reg=0.00362 | FP-Reg=0.000 | acc=0.8125 | L2-Norm=19.037 | L2-Norm(final)=2.583 | 3671.7 samples/s | 57.4 steps/s
[Step=10450 Epoch=40.2] | Loss=0.01430 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.026 | L2-Norm(final)=2.572 | 3055.4 samples/s | 47.7 steps/s
[Step=10500 Epoch=40.4] | Loss=0.00905 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.024 | L2-Norm(final)=2.573 | 3283.7 samples/s | 51.3 steps/s
[Step=10550 Epoch=40.6] | Loss=0.00628 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.022 | L2-Norm(final)=2.571 | 3296.3 samples/s | 51.5 steps/s
[Step=10600 Epoch=40.8] | Loss=0.00481 | Reg=0.00362 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.018 | L2-Norm(final)=2.572 | 3304.3 samples/s | 51.6 steps/s
[Step=10650 Epoch=41.0] | Loss=0.00387 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.013 | L2-Norm(final)=2.574 | 3979.3 samples/s | 62.2 steps/s
[Step=10700 Epoch=41.2] | Loss=0.00324 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.575 | 1552.9 samples/s | 24.3 steps/s
[Step=10750 Epoch=41.4] | Loss=0.00278 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=19.003 | L2-Norm(final)=2.577 | 3280.6 samples/s | 51.3 steps/s
[Step=10800 Epoch=41.6] | Loss=0.00244 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.998 | L2-Norm(final)=2.578 | 3304.3 samples/s | 51.6 steps/s
[Step=10850 Epoch=41.8] | Loss=0.00218 | Reg=0.00361 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.994 | L2-Norm(final)=2.579 | 3317.2 samples/s | 51.8 steps/s
[Step=10900 Epoch=42.0] | Loss=0.00197 | Reg=0.00361 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.990 | L2-Norm(final)=2.580 | 3658.1 samples/s | 57.2 steps/s
[Step=10950 Epoch=42.2] | Loss=0.00179 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.986 | L2-Norm(final)=2.581 | 1597.0 samples/s | 25.0 steps/s
[Step=11000 Epoch=42.3] | Loss=0.00165 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.982 | L2-Norm(final)=2.582 | 3316.2 samples/s | 51.8 steps/s
[Step=11050 Epoch=42.5] | Loss=0.00152 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.979 | L2-Norm(final)=2.583 | 3323.1 samples/s | 51.9 steps/s
[Step=11100 Epoch=42.7] | Loss=0.00142 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.976 | L2-Norm(final)=2.584 | 3316.9 samples/s | 51.8 steps/s
[Step=11150 Epoch=42.9] | Loss=0.00133 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.973 | L2-Norm(final)=2.585 | 3347.8 samples/s | 52.3 steps/s
[Step=11200 Epoch=43.1] | Loss=0.00124 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.970 | L2-Norm(final)=2.585 | 1650.5 samples/s | 25.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21109 | acc=0.8509 | tpr=0.7931 | fpr=0.0238 | 3634.1 samples/s | 14.2 steps/s
Avg test loss: 0.21365, Avg test acc: 0.84594, Avg tpr: 0.78784, Avg fpr: 0.02628, total FA: 205

Testing server on iccad2012
[Step=  50] | Loss=0.38475 | acc=0.8091 | tpr=0.9867 | fpr=0.1941 | 3645.3 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.38760 | acc=0.8087 | tpr=0.9915 | fpr=0.1947 | 6681.4 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.38946 | acc=0.8081 | tpr=0.9928 | fpr=0.1953 | 6787.5 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.39002 | acc=0.8091 | tpr=0.9934 | fpr=0.1943 | 6828.7 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.39134 | acc=0.8079 | tpr=0.9895 | fpr=0.1954 | 6939.2 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.39227 | acc=0.8081 | tpr=0.9891 | fpr=0.1952 | 6765.3 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.39409 | acc=0.8078 | tpr=0.9869 | fpr=0.1954 | 6674.2 samples/s | 26.1 steps/s
[Step= 400] | Loss=0.39560 | acc=0.8074 | tpr=0.9836 | fpr=0.1958 | 6650.9 samples/s | 26.0 steps/s
[Step= 450] | Loss=0.39711 | acc=0.8072 | tpr=0.9839 | fpr=0.1960 | 6980.8 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.39774 | acc=0.8066 | tpr=0.9837 | fpr=0.1966 | 6595.8 samples/s | 25.8 steps/s
[Step= 550] | Loss=0.39578 | acc=0.8072 | tpr=0.9837 | fpr=0.1960 | 12675.7 samples/s | 49.5 steps/s
Avg test loss: 0.39544, Avg test acc: 0.80727, Avg tpr: 0.98336, Avg fpr: 0.19593, total FA: 27204

server round 14/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=21.8] | Loss=0.15524 | Reg=0.00360 | FP-Reg=0.000 | acc=0.8438 | L2-Norm=18.970 | L2-Norm(final)=2.618 | 3364.1 samples/s | 52.6 steps/s
[Step=11250 Epoch=21.9] | Loss=0.03021 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.960 | L2-Norm(final)=2.611 | 3437.4 samples/s | 53.7 steps/s
[Step=11300 Epoch=22.0] | Loss=0.02503 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.954 | L2-Norm(final)=2.615 | 3462.9 samples/s | 54.1 steps/s
[Step=11350 Epoch=22.1] | Loss=0.02281 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.949 | L2-Norm(final)=2.618 | 3455.3 samples/s | 54.0 steps/s
[Step=11400 Epoch=22.2] | Loss=0.02216 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.947 | L2-Norm(final)=2.620 | 3468.1 samples/s | 54.2 steps/s
[Step=11450 Epoch=22.3] | Loss=0.02279 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.946 | L2-Norm(final)=2.620 | 3451.8 samples/s | 53.9 steps/s
[Step=11500 Epoch=22.4] | Loss=0.02188 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.947 | L2-Norm(final)=2.622 | 3458.1 samples/s | 54.0 steps/s
[Step=11550 Epoch=22.5] | Loss=0.02244 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.949 | L2-Norm(final)=2.623 | 3427.9 samples/s | 53.6 steps/s
[Step=11600 Epoch=22.6] | Loss=0.02207 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.951 | L2-Norm(final)=2.625 | 3404.2 samples/s | 53.2 steps/s
[Step=11650 Epoch=22.7] | Loss=0.02243 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.953 | L2-Norm(final)=2.625 | 3378.7 samples/s | 52.8 steps/s
[Step=11700 Epoch=22.8] | Loss=0.02238 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.955 | L2-Norm(final)=2.626 | 3958.7 samples/s | 61.9 steps/s
[Step=11750 Epoch=22.9] | Loss=0.02175 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.957 | L2-Norm(final)=2.626 | 1548.6 samples/s | 24.2 steps/s
[Step=11800 Epoch=23.0] | Loss=0.02124 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.959 | L2-Norm(final)=2.628 | 3451.1 samples/s | 53.9 steps/s
[Step=11850 Epoch=23.1] | Loss=0.02089 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.961 | L2-Norm(final)=2.629 | 3456.9 samples/s | 54.0 steps/s
[Step=11900 Epoch=23.2] | Loss=0.02061 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.964 | L2-Norm(final)=2.630 | 3441.4 samples/s | 53.8 steps/s
[Step=11950 Epoch=23.3] | Loss=0.02054 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.966 | L2-Norm(final)=2.631 | 3460.6 samples/s | 54.1 steps/s
[Step=12000 Epoch=23.4] | Loss=0.02032 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.969 | L2-Norm(final)=2.633 | 3457.2 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=21.9] | Loss=0.14017 | Reg=0.00360 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.970 | L2-Norm(final)=2.618 | 3563.6 samples/s | 55.7 steps/s
[Step=11250 Epoch=22.0] | Loss=0.02651 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.953 | L2-Norm(final)=2.618 | 3389.9 samples/s | 53.0 steps/s
[Step=11300 Epoch=22.1] | Loss=0.02578 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.948 | L2-Norm(final)=2.621 | 3468.5 samples/s | 54.2 steps/s
[Step=11350 Epoch=22.2] | Loss=0.02329 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.947 | L2-Norm(final)=2.624 | 3476.1 samples/s | 54.3 steps/s
[Step=11400 Epoch=22.3] | Loss=0.02162 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.947 | L2-Norm(final)=2.627 | 3467.3 samples/s | 54.2 steps/s
[Step=11450 Epoch=22.4] | Loss=0.02094 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.948 | L2-Norm(final)=2.631 | 3475.1 samples/s | 54.3 steps/s
[Step=11500 Epoch=22.5] | Loss=0.02159 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.949 | L2-Norm(final)=2.633 | 3483.7 samples/s | 54.4 steps/s
[Step=11550 Epoch=22.6] | Loss=0.02094 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.950 | L2-Norm(final)=2.634 | 3480.3 samples/s | 54.4 steps/s
[Step=11600 Epoch=22.7] | Loss=0.02096 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.952 | L2-Norm(final)=2.636 | 3469.8 samples/s | 54.2 steps/s
[Step=11650 Epoch=22.8] | Loss=0.02102 | Reg=0.00359 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.955 | L2-Norm(final)=2.638 | 3486.4 samples/s | 54.5 steps/s
[Step=11700 Epoch=22.9] | Loss=0.02084 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.957 | L2-Norm(final)=2.640 | 4109.5 samples/s | 64.2 steps/s
[Step=11750 Epoch=23.0] | Loss=0.02076 | Reg=0.00359 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.959 | L2-Norm(final)=2.640 | 1614.4 samples/s | 25.2 steps/s
[Step=11800 Epoch=23.1] | Loss=0.02055 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.961 | L2-Norm(final)=2.641 | 3468.4 samples/s | 54.2 steps/s
[Step=11850 Epoch=23.2] | Loss=0.02027 | Reg=0.00360 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.963 | L2-Norm(final)=2.642 | 3469.6 samples/s | 54.2 steps/s
[Step=11900 Epoch=23.3] | Loss=0.01973 | Reg=0.00360 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.966 | L2-Norm(final)=2.643 | 3481.7 samples/s | 54.4 steps/s
[Step=11950 Epoch=23.4] | Loss=0.01939 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.968 | L2-Norm(final)=2.645 | 3472.8 samples/s | 54.3 steps/s
[Step=12000 Epoch=23.5] | Loss=0.01910 | Reg=0.00360 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.971 | L2-Norm(final)=2.647 | 3454.0 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step12000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=42.9] | Loss=0.07145 | Reg=0.00360 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.970 | L2-Norm(final)=2.620 | 3569.5 samples/s | 55.8 steps/s
[Step=11250 Epoch=43.1] | Loss=0.00700 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.936 | L2-Norm(final)=2.617 | 3202.9 samples/s | 50.0 steps/s
[Step=11300 Epoch=43.3] | Loss=0.00411 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.932 | L2-Norm(final)=2.619 | 3300.5 samples/s | 51.6 steps/s
[Step=11350 Epoch=43.5] | Loss=0.00282 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.927 | L2-Norm(final)=2.622 | 3309.2 samples/s | 51.7 steps/s
[Step=11400 Epoch=43.7] | Loss=0.00213 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.922 | L2-Norm(final)=2.625 | 3319.2 samples/s | 51.9 steps/s
[Step=11450 Epoch=43.9] | Loss=0.00179 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.917 | L2-Norm(final)=2.627 | 3960.2 samples/s | 61.9 steps/s
[Step=11500 Epoch=44.1] | Loss=0.00151 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.914 | L2-Norm(final)=2.629 | 1542.5 samples/s | 24.1 steps/s
[Step=11550 Epoch=44.3] | Loss=0.00130 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.910 | L2-Norm(final)=2.630 | 3251.5 samples/s | 50.8 steps/s
[Step=11600 Epoch=44.4] | Loss=0.00115 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.907 | L2-Norm(final)=2.632 | 3319.1 samples/s | 51.9 steps/s
[Step=11650 Epoch=44.6] | Loss=0.00102 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.904 | L2-Norm(final)=2.633 | 3293.6 samples/s | 51.5 steps/s
[Step=11700 Epoch=44.8] | Loss=0.00093 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.901 | L2-Norm(final)=2.634 | 3580.5 samples/s | 55.9 steps/s
[Step=11750 Epoch=45.0] | Loss=0.00084 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.898 | L2-Norm(final)=2.635 | 1618.0 samples/s | 25.3 steps/s
[Step=11800 Epoch=45.2] | Loss=0.00078 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.895 | L2-Norm(final)=2.636 | 3334.9 samples/s | 52.1 steps/s
[Step=11850 Epoch=45.4] | Loss=0.00072 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.892 | L2-Norm(final)=2.636 | 3306.6 samples/s | 51.7 steps/s
[Step=11900 Epoch=45.6] | Loss=0.00067 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.890 | L2-Norm(final)=2.637 | 3326.1 samples/s | 52.0 steps/s
[Step=11950 Epoch=45.8] | Loss=0.00063 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.887 | L2-Norm(final)=2.638 | 3309.4 samples/s | 51.7 steps/s
[Step=12000 Epoch=46.0] | Loss=0.00059 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.885 | L2-Norm(final)=2.638 | 1665.1 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step12000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=43.1] | Loss=0.21813 | Reg=0.00360 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.970 | L2-Norm(final)=2.619 | 3751.4 samples/s | 58.6 steps/s
[Step=11250 Epoch=43.3] | Loss=0.01472 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.940 | L2-Norm(final)=2.605 | 3142.2 samples/s | 49.1 steps/s
[Step=11300 Epoch=43.5] | Loss=0.00797 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.939 | L2-Norm(final)=2.602 | 3303.7 samples/s | 51.6 steps/s
[Step=11350 Epoch=43.7] | Loss=0.00546 | Reg=0.00359 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.934 | L2-Norm(final)=2.604 | 3298.0 samples/s | 51.5 steps/s
[Step=11400 Epoch=43.9] | Loss=0.00412 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.930 | L2-Norm(final)=2.606 | 3287.8 samples/s | 51.4 steps/s
[Step=11450 Epoch=44.1] | Loss=0.00333 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.925 | L2-Norm(final)=2.608 | 3993.6 samples/s | 62.4 steps/s
[Step=11500 Epoch=44.3] | Loss=0.00279 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.921 | L2-Norm(final)=2.611 | 1564.3 samples/s | 24.4 steps/s
[Step=11550 Epoch=44.5] | Loss=0.00239 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.917 | L2-Norm(final)=2.612 | 3321.8 samples/s | 51.9 steps/s
[Step=11600 Epoch=44.7] | Loss=0.00210 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.913 | L2-Norm(final)=2.614 | 3313.1 samples/s | 51.8 steps/s
[Step=11650 Epoch=44.8] | Loss=0.00187 | Reg=0.00358 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.909 | L2-Norm(final)=2.615 | 3302.8 samples/s | 51.6 steps/s
[Step=11700 Epoch=45.0] | Loss=0.00170 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.906 | L2-Norm(final)=2.617 | 3640.0 samples/s | 56.9 steps/s
[Step=11750 Epoch=45.2] | Loss=0.00155 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.903 | L2-Norm(final)=2.618 | 1601.9 samples/s | 25.0 steps/s
[Step=11800 Epoch=45.4] | Loss=0.00142 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.900 | L2-Norm(final)=2.619 | 3298.7 samples/s | 51.5 steps/s
[Step=11850 Epoch=45.6] | Loss=0.00131 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.897 | L2-Norm(final)=2.620 | 3328.7 samples/s | 52.0 steps/s
[Step=11900 Epoch=45.8] | Loss=0.00122 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.894 | L2-Norm(final)=2.621 | 3306.3 samples/s | 51.7 steps/s
[Step=11950 Epoch=46.0] | Loss=0.00114 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.892 | L2-Norm(final)=2.622 | 3350.6 samples/s | 52.4 steps/s
[Step=12000 Epoch=46.2] | Loss=0.00107 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.889 | L2-Norm(final)=2.623 | 1662.2 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.14539 | acc=0.8962 | tpr=0.8631 | fpr=0.0317 | 3675.7 samples/s | 14.4 steps/s
Avg test loss: 0.14781, Avg test acc: 0.89298, Avg tpr: 0.86023, Avg fpr: 0.03500, total FA: 273

Testing server on iccad2012
[Step=  50] | Loss=0.53019 | acc=0.7388 | tpr=0.9912 | fpr=0.2658 | 3586.6 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.53398 | acc=0.7374 | tpr=0.9936 | fpr=0.2674 | 6916.8 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.53675 | acc=0.7368 | tpr=0.9942 | fpr=0.2679 | 6660.6 samples/s | 26.0 steps/s
[Step= 200] | Loss=0.53686 | acc=0.7370 | tpr=0.9945 | fpr=0.2677 | 6730.3 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.53874 | acc=0.7352 | tpr=0.9913 | fpr=0.2694 | 7117.0 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.53960 | acc=0.7356 | tpr=0.9905 | fpr=0.2690 | 6757.1 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.54104 | acc=0.7362 | tpr=0.9887 | fpr=0.2684 | 6758.1 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.54262 | acc=0.7355 | tpr=0.9863 | fpr=0.2690 | 6795.3 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.54361 | acc=0.7355 | tpr=0.9864 | fpr=0.2690 | 6637.6 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.54445 | acc=0.7350 | tpr=0.9863 | fpr=0.2696 | 6718.1 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.54211 | acc=0.7357 | tpr=0.9861 | fpr=0.2688 | 12985.7 samples/s | 50.7 steps/s
Avg test loss: 0.54172, Avg test acc: 0.73585, Avg tpr: 0.98613, Avg fpr: 0.26870, total FA: 37309

server round 15/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=23.4] | Loss=0.12652 | Reg=0.00357 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.903 | L2-Norm(final)=2.651 | 3482.6 samples/s | 54.4 steps/s
[Step=12050 Epoch=23.5] | Loss=0.02355 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.876 | L2-Norm(final)=2.647 | 3320.6 samples/s | 51.9 steps/s
[Step=12100 Epoch=23.6] | Loss=0.02110 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.871 | L2-Norm(final)=2.654 | 3489.2 samples/s | 54.5 steps/s
[Step=12150 Epoch=23.7] | Loss=0.02187 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.869 | L2-Norm(final)=2.654 | 3503.1 samples/s | 54.7 steps/s
[Step=12200 Epoch=23.8] | Loss=0.02090 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.867 | L2-Norm(final)=2.653 | 3487.6 samples/s | 54.5 steps/s
[Step=12250 Epoch=23.9] | Loss=0.02196 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.868 | L2-Norm(final)=2.654 | 3483.9 samples/s | 54.4 steps/s
[Step=12300 Epoch=24.0] | Loss=0.02140 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.869 | L2-Norm(final)=2.654 | 3485.5 samples/s | 54.5 steps/s
[Step=12350 Epoch=24.1] | Loss=0.02090 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.870 | L2-Norm(final)=2.654 | 3505.1 samples/s | 54.8 steps/s
[Step=12400 Epoch=24.2] | Loss=0.02087 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.871 | L2-Norm(final)=2.655 | 3502.4 samples/s | 54.7 steps/s
[Step=12450 Epoch=24.3] | Loss=0.02050 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.873 | L2-Norm(final)=2.655 | 3500.4 samples/s | 54.7 steps/s
[Step=12500 Epoch=24.4] | Loss=0.01984 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.875 | L2-Norm(final)=2.657 | 4045.1 samples/s | 63.2 steps/s
[Step=12550 Epoch=24.5] | Loss=0.01990 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.878 | L2-Norm(final)=2.659 | 1566.5 samples/s | 24.5 steps/s
[Step=12600 Epoch=24.6] | Loss=0.01961 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.881 | L2-Norm(final)=2.660 | 3451.5 samples/s | 53.9 steps/s
[Step=12650 Epoch=24.7] | Loss=0.01929 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.883 | L2-Norm(final)=2.662 | 3473.5 samples/s | 54.3 steps/s
[Step=12700 Epoch=24.8] | Loss=0.01929 | Reg=0.00357 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.886 | L2-Norm(final)=2.663 | 3444.0 samples/s | 53.8 steps/s
[Step=12750 Epoch=24.9] | Loss=0.01880 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.889 | L2-Norm(final)=2.664 | 3444.6 samples/s | 53.8 steps/s
[Step=12800 Epoch=25.0] | Loss=0.01870 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.891 | L2-Norm(final)=2.665 | 3474.0 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step12800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=23.5] | Loss=0.01424 | Reg=0.00357 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.903 | L2-Norm(final)=2.652 | 3846.4 samples/s | 60.1 steps/s
[Step=12050 Epoch=23.6] | Loss=0.02204 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.876 | L2-Norm(final)=2.653 | 3241.6 samples/s | 50.7 steps/s
[Step=12100 Epoch=23.7] | Loss=0.01807 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.873 | L2-Norm(final)=2.661 | 3445.2 samples/s | 53.8 steps/s
[Step=12150 Epoch=23.8] | Loss=0.01800 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.872 | L2-Norm(final)=2.666 | 3475.5 samples/s | 54.3 steps/s
[Step=12200 Epoch=23.9] | Loss=0.01889 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.872 | L2-Norm(final)=2.668 | 3467.9 samples/s | 54.2 steps/s
[Step=12250 Epoch=23.9] | Loss=0.01938 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.872 | L2-Norm(final)=2.668 | 3440.3 samples/s | 53.8 steps/s
[Step=12300 Epoch=24.0] | Loss=0.01978 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.873 | L2-Norm(final)=2.667 | 3454.9 samples/s | 54.0 steps/s
[Step=12350 Epoch=24.1] | Loss=0.02038 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.874 | L2-Norm(final)=2.667 | 3453.8 samples/s | 54.0 steps/s
[Step=12400 Epoch=24.2] | Loss=0.02015 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.876 | L2-Norm(final)=2.667 | 3471.8 samples/s | 54.2 steps/s
[Step=12450 Epoch=24.3] | Loss=0.01975 | Reg=0.00356 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.878 | L2-Norm(final)=2.669 | 3458.6 samples/s | 54.0 steps/s
[Step=12500 Epoch=24.4] | Loss=0.01975 | Reg=0.00356 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.881 | L2-Norm(final)=2.670 | 4090.5 samples/s | 63.9 steps/s
[Step=12550 Epoch=24.5] | Loss=0.01949 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.883 | L2-Norm(final)=2.671 | 1611.3 samples/s | 25.2 steps/s
[Step=12600 Epoch=24.6] | Loss=0.01900 | Reg=0.00357 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.885 | L2-Norm(final)=2.672 | 3449.7 samples/s | 53.9 steps/s
[Step=12650 Epoch=24.7] | Loss=0.01873 | Reg=0.00357 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.887 | L2-Norm(final)=2.673 | 3454.1 samples/s | 54.0 steps/s
[Step=12700 Epoch=24.8] | Loss=0.01836 | Reg=0.00357 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.889 | L2-Norm(final)=2.674 | 3464.1 samples/s | 54.1 steps/s
[Step=12750 Epoch=24.9] | Loss=0.01848 | Reg=0.00357 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.891 | L2-Norm(final)=2.675 | 3547.7 samples/s | 55.4 steps/s
[Step=12800 Epoch=25.0] | Loss=0.01843 | Reg=0.00357 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.893 | L2-Norm(final)=2.676 | 3494.1 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step12800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=46.0] | Loss=0.25337 | Reg=0.00357 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.903 | L2-Norm(final)=2.650 | 3924.3 samples/s | 61.3 steps/s
[Step=12050 Epoch=46.2] | Loss=0.01199 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.906 | L2-Norm(final)=2.643 | 2941.6 samples/s | 46.0 steps/s
[Step=12100 Epoch=46.4] | Loss=0.00697 | Reg=0.00357 | FP-Reg=0.004 | acc=0.9844 | L2-Norm=18.907 | L2-Norm(final)=2.644 | 3286.8 samples/s | 51.4 steps/s
[Step=12150 Epoch=46.6] | Loss=0.00497 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.905 | L2-Norm(final)=2.645 | 3305.6 samples/s | 51.6 steps/s
[Step=12200 Epoch=46.7] | Loss=0.00384 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.901 | L2-Norm(final)=2.648 | 3303.2 samples/s | 51.6 steps/s
[Step=12250 Epoch=46.9] | Loss=0.00309 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.897 | L2-Norm(final)=2.651 | 3961.3 samples/s | 61.9 steps/s
[Step=12300 Epoch=47.1] | Loss=0.00260 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.892 | L2-Norm(final)=2.653 | 1531.5 samples/s | 23.9 steps/s
[Step=12350 Epoch=47.3] | Loss=0.00223 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.887 | L2-Norm(final)=2.655 | 3306.2 samples/s | 51.7 steps/s
[Step=12400 Epoch=47.5] | Loss=0.00196 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.882 | L2-Norm(final)=2.657 | 3291.8 samples/s | 51.4 steps/s
[Step=12450 Epoch=47.7] | Loss=0.00175 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.877 | L2-Norm(final)=2.658 | 3300.8 samples/s | 51.6 steps/s
[Step=12500 Epoch=47.9] | Loss=0.00159 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.873 | L2-Norm(final)=2.659 | 3573.4 samples/s | 55.8 steps/s
[Step=12550 Epoch=48.1] | Loss=0.00144 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.869 | L2-Norm(final)=2.660 | 1620.9 samples/s | 25.3 steps/s
[Step=12600 Epoch=48.3] | Loss=0.00133 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.865 | L2-Norm(final)=2.661 | 3309.3 samples/s | 51.7 steps/s
[Step=12650 Epoch=48.5] | Loss=0.00123 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.861 | L2-Norm(final)=2.662 | 3299.9 samples/s | 51.6 steps/s
[Step=12700 Epoch=48.7] | Loss=0.00114 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.857 | L2-Norm(final)=2.662 | 3099.1 samples/s | 48.4 steps/s
[Step=12750 Epoch=48.9] | Loss=0.00107 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.854 | L2-Norm(final)=2.663 | 2974.8 samples/s | 46.5 steps/s
[Step=12800 Epoch=49.0] | Loss=0.00100 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.851 | L2-Norm(final)=2.663 | 1522.9 samples/s | 23.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step12800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=46.2] | Loss=0.17616 | Reg=0.00357 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.903 | L2-Norm(final)=2.652 | 3645.3 samples/s | 57.0 steps/s
[Step=12050 Epoch=46.4] | Loss=0.01187 | Reg=0.00357 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.884 | L2-Norm(final)=2.647 | 3014.6 samples/s | 47.1 steps/s
[Step=12100 Epoch=46.6] | Loss=0.00714 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.886 | L2-Norm(final)=2.644 | 3228.1 samples/s | 50.4 steps/s
[Step=12150 Epoch=46.8] | Loss=0.00491 | Reg=0.00357 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.883 | L2-Norm(final)=2.644 | 3307.6 samples/s | 51.7 steps/s
[Step=12200 Epoch=47.0] | Loss=0.00381 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.879 | L2-Norm(final)=2.646 | 3225.2 samples/s | 50.4 steps/s
[Step=12250 Epoch=47.2] | Loss=0.00318 | Reg=0.00356 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.876 | L2-Norm(final)=2.648 | 3924.6 samples/s | 61.3 steps/s
[Step=12300 Epoch=47.3] | Loss=0.00271 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.872 | L2-Norm(final)=2.650 | 1533.7 samples/s | 24.0 steps/s
[Step=12350 Epoch=47.5] | Loss=0.00241 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.868 | L2-Norm(final)=2.652 | 3251.7 samples/s | 50.8 steps/s
[Step=12400 Epoch=47.7] | Loss=0.00214 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.865 | L2-Norm(final)=2.653 | 3299.2 samples/s | 51.5 steps/s
[Step=12450 Epoch=47.9] | Loss=0.00194 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.862 | L2-Norm(final)=2.655 | 3315.1 samples/s | 51.8 steps/s
[Step=12500 Epoch=48.1] | Loss=0.00175 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.860 | L2-Norm(final)=2.656 | 3638.4 samples/s | 56.8 steps/s
[Step=12550 Epoch=48.3] | Loss=0.00159 | Reg=0.00356 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.857 | L2-Norm(final)=2.657 | 1577.2 samples/s | 24.6 steps/s
[Step=12600 Epoch=48.5] | Loss=0.00146 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.854 | L2-Norm(final)=2.658 | 3315.6 samples/s | 51.8 steps/s
[Step=12650 Epoch=48.7] | Loss=0.00135 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.851 | L2-Norm(final)=2.659 | 3303.2 samples/s | 51.6 steps/s
[Step=12700 Epoch=48.9] | Loss=0.00126 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.848 | L2-Norm(final)=2.660 | 3310.7 samples/s | 51.7 steps/s
[Step=12750 Epoch=49.1] | Loss=0.00118 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.845 | L2-Norm(final)=2.661 | 3355.8 samples/s | 52.4 steps/s
[Step=12800 Epoch=49.3] | Loss=0.00111 | Reg=0.00355 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.843 | L2-Norm(final)=2.661 | 1650.2 samples/s | 25.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22652 | acc=0.8387 | tpr=0.7740 | fpr=0.0206 | 3506.6 samples/s | 13.7 steps/s
Avg test loss: 0.22899, Avg test acc: 0.83524, Avg tpr: 0.77036, Avg fpr: 0.02205, total FA: 172

Testing server on iccad2012
[Step=  50] | Loss=0.36416 | acc=0.8180 | tpr=0.9779 | fpr=0.1849 | 3596.0 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.36646 | acc=0.8194 | tpr=0.9872 | fpr=0.1837 | 7078.3 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.36824 | acc=0.8192 | tpr=0.9841 | fpr=0.1838 | 6686.4 samples/s | 26.1 steps/s
[Step= 200] | Loss=0.36865 | acc=0.8203 | tpr=0.9825 | fpr=0.1827 | 7053.6 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.37016 | acc=0.8183 | tpr=0.9782 | fpr=0.1846 | 6697.8 samples/s | 26.2 steps/s
[Step= 300] | Loss=0.37114 | acc=0.8181 | tpr=0.9789 | fpr=0.1848 | 7035.4 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.37257 | acc=0.8179 | tpr=0.9781 | fpr=0.1851 | 6613.5 samples/s | 25.8 steps/s
[Step= 400] | Loss=0.37404 | acc=0.8171 | tpr=0.9759 | fpr=0.1858 | 4200.7 samples/s | 16.4 steps/s
[Step= 450] | Loss=0.37522 | acc=0.8170 | tpr=0.9766 | fpr=0.1859 | 6766.9 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.37578 | acc=0.8165 | tpr=0.9775 | fpr=0.1864 | 6797.3 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.37369 | acc=0.8173 | tpr=0.9773 | fpr=0.1856 | 12738.4 samples/s | 49.8 steps/s
Avg test loss: 0.37333, Avg test acc: 0.81739, Avg tpr: 0.97702, Avg fpr: 0.18551, total FA: 25758

server round 16/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=25.0] | Loss=0.19255 | Reg=0.00355 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.835 | L2-Norm(final)=2.675 | 3416.2 samples/s | 53.4 steps/s
[Step=12850 Epoch=25.1] | Loss=0.02733 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.818 | L2-Norm(final)=2.670 | 3370.5 samples/s | 52.7 steps/s
[Step=12900 Epoch=25.2] | Loss=0.01941 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.816 | L2-Norm(final)=2.678 | 3457.5 samples/s | 54.0 steps/s
[Step=12950 Epoch=25.3] | Loss=0.01864 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.814 | L2-Norm(final)=2.683 | 3475.0 samples/s | 54.3 steps/s
[Step=13000 Epoch=25.4] | Loss=0.01965 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.813 | L2-Norm(final)=2.686 | 3490.6 samples/s | 54.5 steps/s
[Step=13050 Epoch=25.5] | Loss=0.01939 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.814 | L2-Norm(final)=2.687 | 3489.9 samples/s | 54.5 steps/s
[Step=13100 Epoch=25.6] | Loss=0.01925 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.815 | L2-Norm(final)=2.688 | 3474.2 samples/s | 54.3 steps/s
[Step=13150 Epoch=25.6] | Loss=0.01903 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.816 | L2-Norm(final)=2.689 | 3451.6 samples/s | 53.9 steps/s
[Step=13200 Epoch=25.7] | Loss=0.01994 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.817 | L2-Norm(final)=2.689 | 3446.5 samples/s | 53.9 steps/s
[Step=13250 Epoch=25.8] | Loss=0.02020 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.818 | L2-Norm(final)=2.688 | 3449.3 samples/s | 53.9 steps/s
[Step=13300 Epoch=25.9] | Loss=0.02044 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.819 | L2-Norm(final)=2.687 | 4048.0 samples/s | 63.3 steps/s
[Step=13350 Epoch=26.0] | Loss=0.02014 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.820 | L2-Norm(final)=2.686 | 1571.6 samples/s | 24.6 steps/s
[Step=13400 Epoch=26.1] | Loss=0.01992 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.822 | L2-Norm(final)=2.686 | 3458.4 samples/s | 54.0 steps/s
[Step=13450 Epoch=26.2] | Loss=0.01953 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.824 | L2-Norm(final)=2.686 | 3469.5 samples/s | 54.2 steps/s
[Step=13500 Epoch=26.3] | Loss=0.01937 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.825 | L2-Norm(final)=2.686 | 3467.4 samples/s | 54.2 steps/s
[Step=13550 Epoch=26.4] | Loss=0.01917 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.827 | L2-Norm(final)=2.687 | 3469.9 samples/s | 54.2 steps/s
[Step=13600 Epoch=26.5] | Loss=0.01910 | Reg=0.00355 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.829 | L2-Norm(final)=2.688 | 3460.6 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step13600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=25.0] | Loss=0.24583 | Reg=0.00355 | FP-Reg=0.000 | acc=0.7969 | L2-Norm=18.835 | L2-Norm(final)=2.675 | 3628.7 samples/s | 56.7 steps/s
[Step=12850 Epoch=25.1] | Loss=0.03043 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.819 | L2-Norm(final)=2.669 | 3437.6 samples/s | 53.7 steps/s
[Step=12900 Epoch=25.2] | Loss=0.02325 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.813 | L2-Norm(final)=2.670 | 3471.1 samples/s | 54.2 steps/s
[Step=12950 Epoch=25.3] | Loss=0.02329 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.809 | L2-Norm(final)=2.671 | 3472.3 samples/s | 54.3 steps/s
[Step=13000 Epoch=25.4] | Loss=0.02152 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.807 | L2-Norm(final)=2.671 | 3481.9 samples/s | 54.4 steps/s
[Step=13050 Epoch=25.5] | Loss=0.02065 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.808 | L2-Norm(final)=2.674 | 3481.6 samples/s | 54.4 steps/s
[Step=13100 Epoch=25.6] | Loss=0.02019 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.809 | L2-Norm(final)=2.676 | 3475.6 samples/s | 54.3 steps/s
[Step=13150 Epoch=25.7] | Loss=0.02031 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.811 | L2-Norm(final)=2.679 | 3489.5 samples/s | 54.5 steps/s
[Step=13200 Epoch=25.8] | Loss=0.02003 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.812 | L2-Norm(final)=2.680 | 3479.0 samples/s | 54.4 steps/s
[Step=13250 Epoch=25.9] | Loss=0.02008 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.814 | L2-Norm(final)=2.682 | 3483.7 samples/s | 54.4 steps/s
[Step=13300 Epoch=26.0] | Loss=0.01972 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.816 | L2-Norm(final)=2.683 | 4078.4 samples/s | 63.7 steps/s
[Step=13350 Epoch=26.1] | Loss=0.01896 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.818 | L2-Norm(final)=2.685 | 1601.5 samples/s | 25.0 steps/s
[Step=13400 Epoch=26.2] | Loss=0.01854 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.820 | L2-Norm(final)=2.687 | 3450.6 samples/s | 53.9 steps/s
[Step=13450 Epoch=26.3] | Loss=0.01837 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.822 | L2-Norm(final)=2.689 | 3469.6 samples/s | 54.2 steps/s
[Step=13500 Epoch=26.4] | Loss=0.01848 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.823 | L2-Norm(final)=2.690 | 3456.3 samples/s | 54.0 steps/s
[Step=13550 Epoch=26.5] | Loss=0.01832 | Reg=0.00354 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.825 | L2-Norm(final)=2.690 | 3483.3 samples/s | 54.4 steps/s
[Step=13600 Epoch=26.6] | Loss=0.01825 | Reg=0.00354 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.826 | L2-Norm(final)=2.691 | 3488.8 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step13600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=49.0] | Loss=0.04982 | Reg=0.00355 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.835 | L2-Norm(final)=2.676 | 3740.6 samples/s | 58.4 steps/s
[Step=12850 Epoch=49.2] | Loss=0.01134 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.813 | L2-Norm(final)=2.665 | 3085.2 samples/s | 48.2 steps/s
[Step=12900 Epoch=49.4] | Loss=0.00632 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.814 | L2-Norm(final)=2.668 | 3321.4 samples/s | 51.9 steps/s
[Step=12950 Epoch=49.6] | Loss=0.00467 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.814 | L2-Norm(final)=2.672 | 3315.9 samples/s | 51.8 steps/s
[Step=13000 Epoch=49.8] | Loss=0.00359 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.813 | L2-Norm(final)=2.675 | 3304.1 samples/s | 51.6 steps/s
[Step=13050 Epoch=50.0] | Loss=0.00288 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.810 | L2-Norm(final)=2.678 | 3988.5 samples/s | 62.3 steps/s
[Step=13100 Epoch=50.2] | Loss=0.00241 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.806 | L2-Norm(final)=2.681 | 1560.6 samples/s | 24.4 steps/s
[Step=13150 Epoch=50.4] | Loss=0.00207 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.802 | L2-Norm(final)=2.683 | 3341.5 samples/s | 52.2 steps/s
[Step=13200 Epoch=50.6] | Loss=0.00182 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.798 | L2-Norm(final)=2.684 | 3314.2 samples/s | 51.8 steps/s
[Step=13250 Epoch=50.8] | Loss=0.00162 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.794 | L2-Norm(final)=2.685 | 3318.3 samples/s | 51.8 steps/s
[Step=13300 Epoch=51.0] | Loss=0.00146 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.790 | L2-Norm(final)=2.687 | 3619.3 samples/s | 56.6 steps/s
[Step=13350 Epoch=51.2] | Loss=0.00133 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.787 | L2-Norm(final)=2.687 | 1605.1 samples/s | 25.1 steps/s
[Step=13400 Epoch=51.3] | Loss=0.00122 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.783 | L2-Norm(final)=2.688 | 3326.0 samples/s | 52.0 steps/s
[Step=13450 Epoch=51.5] | Loss=0.00113 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.780 | L2-Norm(final)=2.689 | 3323.0 samples/s | 51.9 steps/s
[Step=13500 Epoch=51.7] | Loss=0.00105 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.777 | L2-Norm(final)=2.690 | 3317.1 samples/s | 51.8 steps/s
[Step=13550 Epoch=51.9] | Loss=0.00098 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.774 | L2-Norm(final)=2.690 | 3272.7 samples/s | 51.1 steps/s
[Step=13600 Epoch=52.1] | Loss=0.00092 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.771 | L2-Norm(final)=2.691 | 1656.4 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step13600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=49.3] | Loss=0.05591 | Reg=0.00355 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.835 | L2-Norm(final)=2.676 | 3606.1 samples/s | 56.3 steps/s
[Step=12850 Epoch=49.5] | Loss=0.00781 | Reg=0.00353 | FP-Reg=0.002 | acc=0.9688 | L2-Norm=18.797 | L2-Norm(final)=2.679 | 3184.5 samples/s | 49.8 steps/s
[Step=12900 Epoch=49.7] | Loss=0.00539 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.804 | L2-Norm(final)=2.675 | 3330.8 samples/s | 52.0 steps/s
[Step=12950 Epoch=49.8] | Loss=0.00371 | Reg=0.00354 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.803 | L2-Norm(final)=2.675 | 3324.9 samples/s | 52.0 steps/s
[Step=13000 Epoch=50.0] | Loss=0.00306 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.801 | L2-Norm(final)=2.677 | 3342.6 samples/s | 52.2 steps/s
[Step=13050 Epoch=50.2] | Loss=0.00247 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.800 | L2-Norm(final)=2.678 | 4041.8 samples/s | 63.2 steps/s
[Step=13100 Epoch=50.4] | Loss=0.00207 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.797 | L2-Norm(final)=2.680 | 1520.7 samples/s | 23.8 steps/s
[Step=13150 Epoch=50.6] | Loss=0.00178 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.794 | L2-Norm(final)=2.681 | 3096.1 samples/s | 48.4 steps/s
[Step=13200 Epoch=50.8] | Loss=0.00156 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.790 | L2-Norm(final)=2.682 | 3064.1 samples/s | 47.9 steps/s
[Step=13250 Epoch=51.0] | Loss=0.00139 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.787 | L2-Norm(final)=2.683 | 3066.8 samples/s | 47.9 steps/s
[Step=13300 Epoch=51.2] | Loss=0.00125 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.784 | L2-Norm(final)=2.684 | 3552.3 samples/s | 55.5 steps/s
[Step=13350 Epoch=51.4] | Loss=0.00114 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.780 | L2-Norm(final)=2.685 | 1592.6 samples/s | 24.9 steps/s
[Step=13400 Epoch=51.6] | Loss=0.00105 | Reg=0.00353 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.777 | L2-Norm(final)=2.685 | 3326.5 samples/s | 52.0 steps/s
[Step=13450 Epoch=51.8] | Loss=0.00097 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.774 | L2-Norm(final)=2.686 | 3323.9 samples/s | 51.9 steps/s
[Step=13500 Epoch=52.0] | Loss=0.00090 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.772 | L2-Norm(final)=2.686 | 3319.6 samples/s | 51.9 steps/s
[Step=13550 Epoch=52.2] | Loss=0.00084 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.769 | L2-Norm(final)=2.687 | 3325.5 samples/s | 52.0 steps/s
[Step=13600 Epoch=52.4] | Loss=0.00079 | Reg=0.00352 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.766 | L2-Norm(final)=2.687 | 1671.3 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.15811 | acc=0.8898 | tpr=0.8484 | fpr=0.0201 | 3608.2 samples/s | 14.1 steps/s
Avg test loss: 0.16122, Avg test acc: 0.88737, Avg tpr: 0.84694, Avg fpr: 0.02371, total FA: 185

Testing server on iccad2012
[Step=  50] | Loss=0.51469 | acc=0.7473 | tpr=0.9823 | fpr=0.2569 | 3641.7 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.51579 | acc=0.7470 | tpr=0.9893 | fpr=0.2576 | 6764.4 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.51789 | acc=0.7457 | tpr=0.9914 | fpr=0.2588 | 6955.1 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.51809 | acc=0.7466 | tpr=0.9891 | fpr=0.2578 | 4266.9 samples/s | 16.7 steps/s
[Step= 250] | Loss=0.51993 | acc=0.7455 | tpr=0.9860 | fpr=0.2589 | 7129.9 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.51966 | acc=0.7462 | tpr=0.9855 | fpr=0.2581 | 6603.5 samples/s | 25.8 steps/s
[Step= 350] | Loss=0.52113 | acc=0.7468 | tpr=0.9837 | fpr=0.2575 | 6951.3 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.52286 | acc=0.7464 | tpr=0.9825 | fpr=0.2579 | 6856.4 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.52420 | acc=0.7460 | tpr=0.9830 | fpr=0.2583 | 6787.7 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.52506 | acc=0.7453 | tpr=0.9828 | fpr=0.2590 | 6477.0 samples/s | 25.3 steps/s
[Step= 550] | Loss=0.52235 | acc=0.7463 | tpr=0.9825 | fpr=0.2580 | 12734.4 samples/s | 49.7 steps/s
Avg test loss: 0.52195, Avg test acc: 0.74641, Avg tpr: 0.98217, Avg fpr: 0.25787, total FA: 35805

server round 17/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=26.5] | Loss=0.06877 | Reg=0.00352 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.763 | L2-Norm(final)=2.697 | 3471.0 samples/s | 54.2 steps/s
[Step=13650 Epoch=26.6] | Loss=0.02666 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.734 | L2-Norm(final)=2.689 | 3388.3 samples/s | 52.9 steps/s
[Step=13700 Epoch=26.7] | Loss=0.02258 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.730 | L2-Norm(final)=2.691 | 3481.9 samples/s | 54.4 steps/s
[Step=13750 Epoch=26.8] | Loss=0.02080 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.729 | L2-Norm(final)=2.693 | 3494.8 samples/s | 54.6 steps/s
[Step=13800 Epoch=26.9] | Loss=0.02068 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.729 | L2-Norm(final)=2.697 | 3483.2 samples/s | 54.4 steps/s
[Step=13850 Epoch=27.0] | Loss=0.02050 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.731 | L2-Norm(final)=2.699 | 3483.1 samples/s | 54.4 steps/s
[Step=13900 Epoch=27.1] | Loss=0.02067 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.732 | L2-Norm(final)=2.700 | 3475.8 samples/s | 54.3 steps/s
[Step=13950 Epoch=27.2] | Loss=0.01987 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.734 | L2-Norm(final)=2.701 | 3479.3 samples/s | 54.4 steps/s
[Step=14000 Epoch=27.3] | Loss=0.01941 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.737 | L2-Norm(final)=2.703 | 3484.5 samples/s | 54.4 steps/s
[Step=14050 Epoch=27.4] | Loss=0.01884 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.740 | L2-Norm(final)=2.706 | 3503.1 samples/s | 54.7 steps/s
[Step=14100 Epoch=27.5] | Loss=0.01910 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.742 | L2-Norm(final)=2.708 | 4073.8 samples/s | 63.7 steps/s
[Step=14150 Epoch=27.6] | Loss=0.01875 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.745 | L2-Norm(final)=2.710 | 1559.1 samples/s | 24.4 steps/s
[Step=14200 Epoch=27.7] | Loss=0.01844 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.748 | L2-Norm(final)=2.712 | 3447.4 samples/s | 53.9 steps/s
[Step=14250 Epoch=27.8] | Loss=0.01817 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.750 | L2-Norm(final)=2.713 | 3460.4 samples/s | 54.1 steps/s
[Step=14300 Epoch=27.9] | Loss=0.01788 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.752 | L2-Norm(final)=2.715 | 3413.0 samples/s | 53.3 steps/s
[Step=14350 Epoch=28.0] | Loss=0.01772 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.754 | L2-Norm(final)=2.716 | 3441.0 samples/s | 53.8 steps/s
[Step=14400 Epoch=28.1] | Loss=0.01765 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.756 | L2-Norm(final)=2.717 | 3407.0 samples/s | 53.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step14400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=26.6] | Loss=0.00853 | Reg=0.00352 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.763 | L2-Norm(final)=2.697 | 3891.1 samples/s | 60.8 steps/s
[Step=13650 Epoch=26.7] | Loss=0.02463 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.737 | L2-Norm(final)=2.700 | 3266.4 samples/s | 51.0 steps/s
[Step=13700 Epoch=26.8] | Loss=0.02101 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.732 | L2-Norm(final)=2.703 | 3459.0 samples/s | 54.0 steps/s
[Step=13750 Epoch=26.9] | Loss=0.01994 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.730 | L2-Norm(final)=2.706 | 3460.0 samples/s | 54.1 steps/s
[Step=13800 Epoch=27.0] | Loss=0.01872 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.730 | L2-Norm(final)=2.709 | 3452.7 samples/s | 53.9 steps/s
[Step=13850 Epoch=27.1] | Loss=0.01829 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.732 | L2-Norm(final)=2.712 | 3465.3 samples/s | 54.1 steps/s
[Step=13900 Epoch=27.2] | Loss=0.01848 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.734 | L2-Norm(final)=2.714 | 3450.5 samples/s | 53.9 steps/s
[Step=13950 Epoch=27.3] | Loss=0.01879 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.738 | L2-Norm(final)=2.716 | 3486.0 samples/s | 54.5 steps/s
[Step=14000 Epoch=27.4] | Loss=0.01867 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.741 | L2-Norm(final)=2.716 | 3497.3 samples/s | 54.6 steps/s
[Step=14050 Epoch=27.5] | Loss=0.01943 | Reg=0.00351 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.745 | L2-Norm(final)=2.717 | 3496.5 samples/s | 54.6 steps/s
[Step=14100 Epoch=27.6] | Loss=0.01917 | Reg=0.00351 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.748 | L2-Norm(final)=2.717 | 4106.4 samples/s | 64.2 steps/s
[Step=14150 Epoch=27.7] | Loss=0.01863 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.751 | L2-Norm(final)=2.719 | 1613.2 samples/s | 25.2 steps/s
[Step=14200 Epoch=27.8] | Loss=0.01799 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.754 | L2-Norm(final)=2.721 | 3449.9 samples/s | 53.9 steps/s
[Step=14250 Epoch=27.9] | Loss=0.01787 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.757 | L2-Norm(final)=2.723 | 3442.7 samples/s | 53.8 steps/s
[Step=14300 Epoch=28.0] | Loss=0.01813 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.760 | L2-Norm(final)=2.725 | 3434.9 samples/s | 53.7 steps/s
[Step=14350 Epoch=28.1] | Loss=0.01812 | Reg=0.00352 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.763 | L2-Norm(final)=2.726 | 3433.7 samples/s | 53.7 steps/s
[Step=14400 Epoch=28.2] | Loss=0.01799 | Reg=0.00352 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.765 | L2-Norm(final)=2.727 | 3475.7 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step14400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=52.1] | Loss=0.25665 | Reg=0.00352 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.763 | L2-Norm(final)=2.697 | 3831.4 samples/s | 59.9 steps/s
[Step=13650 Epoch=52.3] | Loss=0.01497 | Reg=0.00352 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.754 | L2-Norm(final)=2.685 | 3073.3 samples/s | 48.0 steps/s
[Step=13700 Epoch=52.5] | Loss=0.01030 | Reg=0.00352 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.762 | L2-Norm(final)=2.674 | 3319.6 samples/s | 51.9 steps/s
[Step=13750 Epoch=52.7] | Loss=0.00776 | Reg=0.00352 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.765 | L2-Norm(final)=2.669 | 3328.4 samples/s | 52.0 steps/s
[Step=13800 Epoch=52.9] | Loss=0.00589 | Reg=0.00352 | FP-Reg=0.004 | acc=1.0000 | L2-Norm=18.763 | L2-Norm(final)=2.667 | 3314.0 samples/s | 51.8 steps/s
[Step=13850 Epoch=53.1] | Loss=0.00473 | Reg=0.00352 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.759 | L2-Norm(final)=2.667 | 4000.1 samples/s | 62.5 steps/s
[Step=13900 Epoch=53.3] | Loss=0.00395 | Reg=0.00352 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.754 | L2-Norm(final)=2.668 | 1524.7 samples/s | 23.8 steps/s
[Step=13950 Epoch=53.5] | Loss=0.00339 | Reg=0.00352 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.750 | L2-Norm(final)=2.669 | 3306.1 samples/s | 51.7 steps/s
[Step=14000 Epoch=53.6] | Loss=0.00297 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.745 | L2-Norm(final)=2.670 | 3330.5 samples/s | 52.0 steps/s
[Step=14050 Epoch=53.8] | Loss=0.00264 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.741 | L2-Norm(final)=2.671 | 3324.6 samples/s | 51.9 steps/s
[Step=14100 Epoch=54.0] | Loss=0.00238 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.737 | L2-Norm(final)=2.672 | 3571.4 samples/s | 55.8 steps/s
[Step=14150 Epoch=54.2] | Loss=0.00217 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.733 | L2-Norm(final)=2.673 | 1630.0 samples/s | 25.5 steps/s
[Step=14200 Epoch=54.4] | Loss=0.00199 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.729 | L2-Norm(final)=2.674 | 3310.3 samples/s | 51.7 steps/s
[Step=14250 Epoch=54.6] | Loss=0.00184 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.726 | L2-Norm(final)=2.675 | 3298.9 samples/s | 51.5 steps/s
[Step=14300 Epoch=54.8] | Loss=0.00171 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.722 | L2-Norm(final)=2.676 | 3293.5 samples/s | 51.5 steps/s
[Step=14350 Epoch=55.0] | Loss=0.00160 | Reg=0.00350 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.719 | L2-Norm(final)=2.678 | 3285.9 samples/s | 51.3 steps/s
[Step=14400 Epoch=55.2] | Loss=0.00150 | Reg=0.00350 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.716 | L2-Norm(final)=2.679 | 1677.2 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step14400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=52.4] | Loss=0.19384 | Reg=0.00352 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.763 | L2-Norm(final)=2.697 | 3704.4 samples/s | 57.9 steps/s
[Step=13650 Epoch=52.5] | Loss=0.00652 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.739 | L2-Norm(final)=2.699 | 3157.4 samples/s | 49.3 steps/s
[Step=13700 Epoch=52.7] | Loss=0.00348 | Reg=0.00351 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.733 | L2-Norm(final)=2.700 | 3316.5 samples/s | 51.8 steps/s
[Step=13750 Epoch=52.9] | Loss=0.00260 | Reg=0.00351 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.726 | L2-Norm(final)=2.702 | 3334.7 samples/s | 52.1 steps/s
[Step=13800 Epoch=53.1] | Loss=0.00205 | Reg=0.00350 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.720 | L2-Norm(final)=2.703 | 3333.2 samples/s | 52.1 steps/s
[Step=13850 Epoch=53.3] | Loss=0.00166 | Reg=0.00350 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.716 | L2-Norm(final)=2.704 | 3985.6 samples/s | 62.3 steps/s
[Step=13900 Epoch=53.5] | Loss=0.00139 | Reg=0.00350 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.711 | L2-Norm(final)=2.705 | 1554.7 samples/s | 24.3 steps/s
[Step=13950 Epoch=53.7] | Loss=0.00119 | Reg=0.00350 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.707 | L2-Norm(final)=2.705 | 3302.1 samples/s | 51.6 steps/s
[Step=14000 Epoch=53.9] | Loss=0.00105 | Reg=0.00350 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.703 | L2-Norm(final)=2.706 | 3324.6 samples/s | 51.9 steps/s
[Step=14050 Epoch=54.1] | Loss=0.00094 | Reg=0.00350 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.699 | L2-Norm(final)=2.706 | 3323.4 samples/s | 51.9 steps/s
[Step=14100 Epoch=54.3] | Loss=0.00085 | Reg=0.00350 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.696 | L2-Norm(final)=2.707 | 3627.4 samples/s | 56.7 steps/s
[Step=14150 Epoch=54.5] | Loss=0.00077 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.692 | L2-Norm(final)=2.707 | 1266.8 samples/s | 19.8 steps/s
[Step=14200 Epoch=54.7] | Loss=0.00071 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.689 | L2-Norm(final)=2.708 | 3124.8 samples/s | 48.8 steps/s
[Step=14250 Epoch=54.9] | Loss=0.00066 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.686 | L2-Norm(final)=2.708 | 3300.1 samples/s | 51.6 steps/s
[Step=14300 Epoch=55.0] | Loss=0.00061 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.684 | L2-Norm(final)=2.708 | 3284.5 samples/s | 51.3 steps/s
[Step=14350 Epoch=55.2] | Loss=0.00057 | Reg=0.00349 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.681 | L2-Norm(final)=2.708 | 3373.8 samples/s | 52.7 steps/s
[Step=14400 Epoch=55.4] | Loss=0.00054 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.678 | L2-Norm(final)=2.709 | 1647.5 samples/s | 25.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18676 | acc=0.8684 | tpr=0.8185 | fpr=0.0233 | 3607.8 samples/s | 14.1 steps/s
Avg test loss: 0.18802, Avg test acc: 0.86662, Avg tpr: 0.81722, Avg fpr: 0.02474, total FA: 193

Testing server on iccad2012
[Step=  50] | Loss=0.44189 | acc=0.7886 | tpr=0.9867 | fpr=0.2150 | 3669.6 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.44492 | acc=0.7895 | tpr=0.9915 | fpr=0.2142 | 6753.5 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.44802 | acc=0.7889 | tpr=0.9928 | fpr=0.2148 | 6814.9 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.44919 | acc=0.7898 | tpr=0.9913 | fpr=0.2139 | 6702.9 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.45077 | acc=0.7877 | tpr=0.9878 | fpr=0.2159 | 7015.1 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.45158 | acc=0.7878 | tpr=0.9869 | fpr=0.2158 | 6830.6 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.45322 | acc=0.7878 | tpr=0.9856 | fpr=0.2158 | 6704.3 samples/s | 26.2 steps/s
[Step= 400] | Loss=0.45470 | acc=0.7873 | tpr=0.9841 | fpr=0.2162 | 7068.0 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.45644 | acc=0.7869 | tpr=0.9849 | fpr=0.2167 | 6623.8 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.45721 | acc=0.7861 | tpr=0.9846 | fpr=0.2175 | 7029.0 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.45482 | acc=0.7870 | tpr=0.9841 | fpr=0.2166 | 12086.7 samples/s | 47.2 steps/s
Avg test loss: 0.45445, Avg test acc: 0.78711, Avg tpr: 0.98376, Avg fpr: 0.21647, total FA: 30056

server round 18/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=28.1] | Loss=0.14590 | Reg=0.00350 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.697 | L2-Norm(final)=2.718 | 3362.9 samples/s | 52.5 steps/s
[Step=14450 Epoch=28.2] | Loss=0.02706 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.682 | L2-Norm(final)=2.713 | 3468.1 samples/s | 54.2 steps/s
[Step=14500 Epoch=28.3] | Loss=0.02078 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.680 | L2-Norm(final)=2.716 | 3459.6 samples/s | 54.1 steps/s
[Step=14550 Epoch=28.4] | Loss=0.02022 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.678 | L2-Norm(final)=2.719 | 3447.3 samples/s | 53.9 steps/s
[Step=14600 Epoch=28.5] | Loss=0.01995 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.677 | L2-Norm(final)=2.722 | 3479.9 samples/s | 54.4 steps/s
[Step=14650 Epoch=28.6] | Loss=0.01962 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.678 | L2-Norm(final)=2.723 | 3480.6 samples/s | 54.4 steps/s
[Step=14700 Epoch=28.7] | Loss=0.01971 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.678 | L2-Norm(final)=2.725 | 3479.5 samples/s | 54.4 steps/s
[Step=14750 Epoch=28.8] | Loss=0.01932 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.679 | L2-Norm(final)=2.725 | 3490.0 samples/s | 54.5 steps/s
[Step=14800 Epoch=28.9] | Loss=0.01960 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.680 | L2-Norm(final)=2.725 | 3491.5 samples/s | 54.6 steps/s
[Step=14850 Epoch=29.0] | Loss=0.01970 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.682 | L2-Norm(final)=2.726 | 3487.8 samples/s | 54.5 steps/s
[Step=14900 Epoch=29.1] | Loss=0.01952 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.683 | L2-Norm(final)=2.726 | 4062.8 samples/s | 63.5 steps/s
[Step=14950 Epoch=29.2] | Loss=0.01938 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.684 | L2-Norm(final)=2.726 | 1570.1 samples/s | 24.5 steps/s
[Step=15000 Epoch=29.3] | Loss=0.01872 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.686 | L2-Norm(final)=2.727 | 3481.8 samples/s | 54.4 steps/s
[Step=15050 Epoch=29.4] | Loss=0.01836 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.688 | L2-Norm(final)=2.729 | 3459.8 samples/s | 54.1 steps/s
[Step=15100 Epoch=29.5] | Loss=0.01813 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.690 | L2-Norm(final)=2.731 | 3470.2 samples/s | 54.2 steps/s
[Step=15150 Epoch=29.5] | Loss=0.01785 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.692 | L2-Norm(final)=2.732 | 3493.6 samples/s | 54.6 steps/s
[Step=15200 Epoch=29.6] | Loss=0.01770 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.694 | L2-Norm(final)=2.734 | 3496.1 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step15200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=28.2] | Loss=0.11499 | Reg=0.00350 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.697 | L2-Norm(final)=2.718 | 3658.0 samples/s | 57.2 steps/s
[Step=14450 Epoch=28.2] | Loss=0.02052 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.675 | L2-Norm(final)=2.719 | 3408.3 samples/s | 53.3 steps/s
[Step=14500 Epoch=28.3] | Loss=0.01805 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.673 | L2-Norm(final)=2.726 | 3484.6 samples/s | 54.4 steps/s
[Step=14550 Epoch=28.4] | Loss=0.01864 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.672 | L2-Norm(final)=2.729 | 3446.7 samples/s | 53.9 steps/s
[Step=14600 Epoch=28.5] | Loss=0.01841 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.672 | L2-Norm(final)=2.730 | 3458.4 samples/s | 54.0 steps/s
[Step=14650 Epoch=28.6] | Loss=0.01914 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.674 | L2-Norm(final)=2.732 | 3469.3 samples/s | 54.2 steps/s
[Step=14700 Epoch=28.7] | Loss=0.01932 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.676 | L2-Norm(final)=2.733 | 3475.3 samples/s | 54.3 steps/s
[Step=14750 Epoch=28.8] | Loss=0.01902 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.678 | L2-Norm(final)=2.734 | 3487.8 samples/s | 54.5 steps/s
[Step=14800 Epoch=28.9] | Loss=0.01879 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.680 | L2-Norm(final)=2.735 | 3491.9 samples/s | 54.6 steps/s
[Step=14850 Epoch=29.0] | Loss=0.01886 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.682 | L2-Norm(final)=2.736 | 3503.8 samples/s | 54.7 steps/s
[Step=14900 Epoch=29.1] | Loss=0.01893 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.684 | L2-Norm(final)=2.737 | 4076.8 samples/s | 63.7 steps/s
[Step=14950 Epoch=29.2] | Loss=0.01844 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.687 | L2-Norm(final)=2.738 | 1609.1 samples/s | 25.1 steps/s
[Step=15000 Epoch=29.3] | Loss=0.01825 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.689 | L2-Norm(final)=2.740 | 3414.0 samples/s | 53.3 steps/s
[Step=15050 Epoch=29.4] | Loss=0.01767 | Reg=0.00349 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.691 | L2-Norm(final)=2.741 | 3453.2 samples/s | 54.0 steps/s
[Step=15100 Epoch=29.5] | Loss=0.01721 | Reg=0.00349 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.693 | L2-Norm(final)=2.743 | 3479.6 samples/s | 54.4 steps/s
[Step=15150 Epoch=29.6] | Loss=0.01713 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.695 | L2-Norm(final)=2.745 | 3485.8 samples/s | 54.5 steps/s
[Step=15200 Epoch=29.7] | Loss=0.01709 | Reg=0.00350 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.697 | L2-Norm(final)=2.746 | 3489.3 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step15200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=55.2] | Loss=0.13715 | Reg=0.00350 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.697 | L2-Norm(final)=2.718 | 3721.5 samples/s | 58.1 steps/s
[Step=14450 Epoch=55.4] | Loss=0.01181 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.668 | L2-Norm(final)=2.707 | 3092.0 samples/s | 48.3 steps/s
[Step=14500 Epoch=55.6] | Loss=0.00646 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.665 | L2-Norm(final)=2.708 | 3281.3 samples/s | 51.3 steps/s
[Step=14550 Epoch=55.8] | Loss=0.00462 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.661 | L2-Norm(final)=2.709 | 3290.4 samples/s | 51.4 steps/s
[Step=14600 Epoch=55.9] | Loss=0.00366 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.657 | L2-Norm(final)=2.711 | 3296.1 samples/s | 51.5 steps/s
[Step=14650 Epoch=56.1] | Loss=0.00295 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.654 | L2-Norm(final)=2.713 | 3969.1 samples/s | 62.0 steps/s
[Step=14700 Epoch=56.3] | Loss=0.00247 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.650 | L2-Norm(final)=2.715 | 1545.7 samples/s | 24.2 steps/s
[Step=14750 Epoch=56.5] | Loss=0.00212 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.646 | L2-Norm(final)=2.716 | 3292.1 samples/s | 51.4 steps/s
[Step=14800 Epoch=56.7] | Loss=0.00186 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.643 | L2-Norm(final)=2.717 | 3302.7 samples/s | 51.6 steps/s
[Step=14850 Epoch=56.9] | Loss=0.00166 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.639 | L2-Norm(final)=2.718 | 3310.2 samples/s | 51.7 steps/s
[Step=14900 Epoch=57.1] | Loss=0.00150 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.636 | L2-Norm(final)=2.719 | 3591.0 samples/s | 56.1 steps/s
[Step=14950 Epoch=57.3] | Loss=0.00137 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.633 | L2-Norm(final)=2.720 | 1604.5 samples/s | 25.1 steps/s
[Step=15000 Epoch=57.5] | Loss=0.00126 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.630 | L2-Norm(final)=2.721 | 3302.0 samples/s | 51.6 steps/s
[Step=15050 Epoch=57.7] | Loss=0.00116 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.627 | L2-Norm(final)=2.722 | 3287.1 samples/s | 51.4 steps/s
[Step=15100 Epoch=57.9] | Loss=0.00108 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.625 | L2-Norm(final)=2.722 | 3296.9 samples/s | 51.5 steps/s
[Step=15150 Epoch=58.0] | Loss=0.00101 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.622 | L2-Norm(final)=2.723 | 3296.5 samples/s | 51.5 steps/s
[Step=15200 Epoch=58.2] | Loss=0.00095 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.620 | L2-Norm(final)=2.723 | 1673.2 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step15200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=55.4] | Loss=0.12073 | Reg=0.00350 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.697 | L2-Norm(final)=2.719 | 3618.6 samples/s | 56.5 steps/s
[Step=14450 Epoch=55.6] | Loss=0.00897 | Reg=0.00349 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.678 | L2-Norm(final)=2.710 | 3222.0 samples/s | 50.3 steps/s
[Step=14500 Epoch=55.8] | Loss=0.00675 | Reg=0.00349 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.683 | L2-Norm(final)=2.703 | 3303.6 samples/s | 51.6 steps/s
[Step=14550 Epoch=56.0] | Loss=0.00620 | Reg=0.00349 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.686 | L2-Norm(final)=2.697 | 3320.3 samples/s | 51.9 steps/s
[Step=14600 Epoch=56.2] | Loss=0.00495 | Reg=0.00349 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.686 | L2-Norm(final)=2.694 | 3306.9 samples/s | 51.7 steps/s
[Step=14650 Epoch=56.4] | Loss=0.00403 | Reg=0.00349 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.685 | L2-Norm(final)=2.694 | 4001.7 samples/s | 62.5 steps/s
[Step=14700 Epoch=56.6] | Loss=0.00337 | Reg=0.00349 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.682 | L2-Norm(final)=2.695 | 1533.1 samples/s | 24.0 steps/s
[Step=14750 Epoch=56.8] | Loss=0.00289 | Reg=0.00349 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.679 | L2-Norm(final)=2.696 | 3295.9 samples/s | 51.5 steps/s
[Step=14800 Epoch=57.0] | Loss=0.00253 | Reg=0.00349 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.675 | L2-Norm(final)=2.697 | 3311.5 samples/s | 51.7 steps/s
[Step=14850 Epoch=57.2] | Loss=0.00226 | Reg=0.00349 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.671 | L2-Norm(final)=2.698 | 3307.4 samples/s | 51.7 steps/s
[Step=14900 Epoch=57.4] | Loss=0.00203 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.668 | L2-Norm(final)=2.699 | 3731.1 samples/s | 58.3 steps/s
[Step=14950 Epoch=57.5] | Loss=0.00185 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.664 | L2-Norm(final)=2.700 | 1607.1 samples/s | 25.1 steps/s
[Step=15000 Epoch=57.7] | Loss=0.00170 | Reg=0.00348 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.661 | L2-Norm(final)=2.701 | 3332.1 samples/s | 52.1 steps/s
[Step=15050 Epoch=57.9] | Loss=0.00157 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.658 | L2-Norm(final)=2.702 | 3327.2 samples/s | 52.0 steps/s
[Step=15100 Epoch=58.1] | Loss=0.00146 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.654 | L2-Norm(final)=2.703 | 3321.6 samples/s | 51.9 steps/s
[Step=15150 Epoch=58.3] | Loss=0.00137 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.651 | L2-Norm(final)=2.704 | 3364.5 samples/s | 52.6 steps/s
[Step=15200 Epoch=58.5] | Loss=0.00128 | Reg=0.00348 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.648 | L2-Norm(final)=2.705 | 1677.8 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17447 | acc=0.8736 | tpr=0.8290 | fpr=0.0295 | 3642.5 samples/s | 14.2 steps/s
Avg test loss: 0.17645, Avg test acc: 0.87198, Avg tpr: 0.82899, Avg fpr: 0.03346, total FA: 261

Testing server on iccad2012
[Step=  50] | Loss=0.44631 | acc=0.7870 | tpr=0.9823 | fpr=0.2165 | 3659.7 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.44940 | acc=0.7859 | tpr=0.9915 | fpr=0.2179 | 6857.8 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.45278 | acc=0.7849 | tpr=0.9914 | fpr=0.2189 | 6762.2 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.45298 | acc=0.7858 | tpr=0.9913 | fpr=0.2179 | 6806.5 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.45421 | acc=0.7845 | tpr=0.9878 | fpr=0.2192 | 6797.9 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.45556 | acc=0.7845 | tpr=0.9876 | fpr=0.2192 | 6867.4 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.45721 | acc=0.7846 | tpr=0.9856 | fpr=0.2190 | 7008.4 samples/s | 27.4 steps/s
[Step= 400] | Loss=0.45887 | acc=0.7843 | tpr=0.9836 | fpr=0.2193 | 6805.9 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.46053 | acc=0.7842 | tpr=0.9844 | fpr=0.2194 | 6941.4 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.46102 | acc=0.7837 | tpr=0.9846 | fpr=0.2200 | 6764.5 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.45865 | acc=0.7845 | tpr=0.9845 | fpr=0.2191 | 12026.7 samples/s | 47.0 steps/s
Avg test loss: 0.45832, Avg test acc: 0.78453, Avg tpr: 0.98455, Avg fpr: 0.21911, total FA: 30423

server round 19/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=29.6] | Loss=0.14957 | Reg=0.00347 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.630 | L2-Norm(final)=2.738 | 3579.1 samples/s | 55.9 steps/s
[Step=15250 Epoch=29.7] | Loss=0.02574 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.607 | L2-Norm(final)=2.729 | 3248.8 samples/s | 50.8 steps/s
[Step=15300 Epoch=29.8] | Loss=0.02097 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.605 | L2-Norm(final)=2.738 | 3455.2 samples/s | 54.0 steps/s
[Step=15350 Epoch=29.9] | Loss=0.02102 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.604 | L2-Norm(final)=2.744 | 3487.5 samples/s | 54.5 steps/s
[Step=15400 Epoch=30.0] | Loss=0.02014 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.604 | L2-Norm(final)=2.745 | 3495.2 samples/s | 54.6 steps/s
[Step=15450 Epoch=30.1] | Loss=0.02009 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.604 | L2-Norm(final)=2.746 | 3488.4 samples/s | 54.5 steps/s
[Step=15500 Epoch=30.2] | Loss=0.01983 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.604 | L2-Norm(final)=2.747 | 3497.1 samples/s | 54.6 steps/s
[Step=15550 Epoch=30.3] | Loss=0.01950 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.605 | L2-Norm(final)=2.748 | 3466.9 samples/s | 54.2 steps/s
[Step=15600 Epoch=30.4] | Loss=0.01905 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.607 | L2-Norm(final)=2.748 | 3475.8 samples/s | 54.3 steps/s
[Step=15650 Epoch=30.5] | Loss=0.01862 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.609 | L2-Norm(final)=2.750 | 3455.7 samples/s | 54.0 steps/s
[Step=15700 Epoch=30.6] | Loss=0.01837 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.610 | L2-Norm(final)=2.751 | 4027.5 samples/s | 62.9 steps/s
[Step=15750 Epoch=30.7] | Loss=0.01788 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.612 | L2-Norm(final)=2.752 | 1567.9 samples/s | 24.5 steps/s
[Step=15800 Epoch=30.8] | Loss=0.01772 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.614 | L2-Norm(final)=2.753 | 3472.6 samples/s | 54.3 steps/s
[Step=15850 Epoch=30.9] | Loss=0.01739 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.616 | L2-Norm(final)=2.754 | 3475.6 samples/s | 54.3 steps/s
[Step=15900 Epoch=31.0] | Loss=0.01741 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.618 | L2-Norm(final)=2.755 | 3480.4 samples/s | 54.4 steps/s
[Step=15950 Epoch=31.1] | Loss=0.01729 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.620 | L2-Norm(final)=2.755 | 3481.0 samples/s | 54.4 steps/s
[Step=16000 Epoch=31.2] | Loss=0.01724 | Reg=0.00347 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.623 | L2-Norm(final)=2.756 | 3468.0 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=29.7] | Loss=0.11867 | Reg=0.00347 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.630 | L2-Norm(final)=2.739 | 3949.6 samples/s | 61.7 steps/s
[Step=15250 Epoch=29.8] | Loss=0.02710 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.612 | L2-Norm(final)=2.738 | 3195.8 samples/s | 49.9 steps/s
[Step=15300 Epoch=29.9] | Loss=0.02206 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.609 | L2-Norm(final)=2.739 | 3418.1 samples/s | 53.4 steps/s
[Step=15350 Epoch=30.0] | Loss=0.01964 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.609 | L2-Norm(final)=2.744 | 3440.3 samples/s | 53.8 steps/s
[Step=15400 Epoch=30.1] | Loss=0.01833 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.748 | 3472.9 samples/s | 54.3 steps/s
[Step=15450 Epoch=30.2] | Loss=0.01781 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.611 | L2-Norm(final)=2.752 | 3483.5 samples/s | 54.4 steps/s
[Step=15500 Epoch=30.3] | Loss=0.01719 | Reg=0.00346 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.612 | L2-Norm(final)=2.755 | 3485.8 samples/s | 54.5 steps/s
[Step=15550 Epoch=30.4] | Loss=0.01699 | Reg=0.00346 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.613 | L2-Norm(final)=2.757 | 3493.7 samples/s | 54.6 steps/s
[Step=15600 Epoch=30.5] | Loss=0.01747 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.615 | L2-Norm(final)=2.758 | 3489.9 samples/s | 54.5 steps/s
[Step=15650 Epoch=30.6] | Loss=0.01762 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.617 | L2-Norm(final)=2.760 | 3483.0 samples/s | 54.4 steps/s
[Step=15700 Epoch=30.7] | Loss=0.01781 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.619 | L2-Norm(final)=2.761 | 4095.9 samples/s | 64.0 steps/s
[Step=15750 Epoch=30.8] | Loss=0.01782 | Reg=0.00347 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.621 | L2-Norm(final)=2.761 | 1599.6 samples/s | 25.0 steps/s
[Step=15800 Epoch=30.9] | Loss=0.01738 | Reg=0.00347 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.623 | L2-Norm(final)=2.762 | 3462.8 samples/s | 54.1 steps/s
[Step=15850 Epoch=31.0] | Loss=0.01712 | Reg=0.00347 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.625 | L2-Norm(final)=2.763 | 3478.6 samples/s | 54.4 steps/s
[Step=15900 Epoch=31.1] | Loss=0.01713 | Reg=0.00347 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.627 | L2-Norm(final)=2.764 | 3463.5 samples/s | 54.1 steps/s
[Step=15950 Epoch=31.2] | Loss=0.01691 | Reg=0.00347 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.630 | L2-Norm(final)=2.765 | 3462.1 samples/s | 54.1 steps/s
[Step=16000 Epoch=31.3] | Loss=0.01708 | Reg=0.00347 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.632 | L2-Norm(final)=2.766 | 3458.9 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step16000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=58.2] | Loss=0.16454 | Reg=0.00347 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.630 | L2-Norm(final)=2.740 | 3681.1 samples/s | 57.5 steps/s
[Step=15250 Epoch=58.4] | Loss=0.00897 | Reg=0.00347 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.620 | L2-Norm(final)=2.736 | 3112.0 samples/s | 48.6 steps/s
[Step=15300 Epoch=58.6] | Loss=0.00489 | Reg=0.00347 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.618 | L2-Norm(final)=2.736 | 3205.5 samples/s | 50.1 steps/s
[Step=15350 Epoch=58.8] | Loss=0.00334 | Reg=0.00346 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.612 | L2-Norm(final)=2.737 | 3314.7 samples/s | 51.8 steps/s
[Step=15400 Epoch=59.0] | Loss=0.00258 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.605 | L2-Norm(final)=2.739 | 3306.9 samples/s | 51.7 steps/s
[Step=15450 Epoch=59.2] | Loss=0.00210 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.600 | L2-Norm(final)=2.741 | 3982.6 samples/s | 62.2 steps/s
[Step=15500 Epoch=59.4] | Loss=0.00177 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.595 | L2-Norm(final)=2.743 | 1558.2 samples/s | 24.3 steps/s
[Step=15550 Epoch=59.6] | Loss=0.00152 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.591 | L2-Norm(final)=2.745 | 3315.4 samples/s | 51.8 steps/s
[Step=15600 Epoch=59.8] | Loss=0.00133 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.587 | L2-Norm(final)=2.746 | 3298.0 samples/s | 51.5 steps/s
[Step=15650 Epoch=60.0] | Loss=0.00119 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.583 | L2-Norm(final)=2.747 | 3292.6 samples/s | 51.4 steps/s
[Step=15700 Epoch=60.2] | Loss=0.00107 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.579 | L2-Norm(final)=2.748 | 3555.3 samples/s | 55.6 steps/s
[Step=15750 Epoch=60.3] | Loss=0.00098 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.575 | L2-Norm(final)=2.749 | 1609.5 samples/s | 25.1 steps/s
[Step=15800 Epoch=60.5] | Loss=0.00090 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.572 | L2-Norm(final)=2.749 | 3329.9 samples/s | 52.0 steps/s
[Step=15850 Epoch=60.7] | Loss=0.00083 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.568 | L2-Norm(final)=2.750 | 3303.2 samples/s | 51.6 steps/s
[Step=15900 Epoch=60.9] | Loss=0.00077 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.565 | L2-Norm(final)=2.750 | 3325.6 samples/s | 52.0 steps/s
[Step=15950 Epoch=61.1] | Loss=0.00072 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.562 | L2-Norm(final)=2.751 | 3315.4 samples/s | 51.8 steps/s
[Step=16000 Epoch=61.3] | Loss=0.00068 | Reg=0.00344 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.559 | L2-Norm(final)=2.751 | 1675.8 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step16000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=58.5] | Loss=0.11451 | Reg=0.00347 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.630 | L2-Norm(final)=2.739 | 3863.4 samples/s | 60.4 steps/s
[Step=15250 Epoch=58.7] | Loss=0.00967 | Reg=0.00347 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.621 | L2-Norm(final)=2.728 | 2942.0 samples/s | 46.0 steps/s
[Step=15300 Epoch=58.9] | Loss=0.00510 | Reg=0.00347 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.621 | L2-Norm(final)=2.726 | 3203.7 samples/s | 50.1 steps/s
[Step=15350 Epoch=59.1] | Loss=0.00362 | Reg=0.00347 | FP-Reg=0.003 | acc=1.0000 | L2-Norm=18.616 | L2-Norm(final)=2.728 | 3197.4 samples/s | 50.0 steps/s
[Step=15400 Epoch=59.3] | Loss=0.00278 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.730 | 3207.4 samples/s | 50.1 steps/s
[Step=15450 Epoch=59.5] | Loss=0.00224 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.605 | L2-Norm(final)=2.732 | 3886.5 samples/s | 60.7 steps/s
[Step=15500 Epoch=59.7] | Loss=0.00187 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.600 | L2-Norm(final)=2.733 | 1529.5 samples/s | 23.9 steps/s
[Step=15550 Epoch=59.9] | Loss=0.00161 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.595 | L2-Norm(final)=2.735 | 3267.9 samples/s | 51.1 steps/s
[Step=15600 Epoch=60.1] | Loss=0.00141 | Reg=0.00346 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.590 | L2-Norm(final)=2.736 | 3288.0 samples/s | 51.4 steps/s
[Step=15650 Epoch=60.2] | Loss=0.00126 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.586 | L2-Norm(final)=2.737 | 3301.6 samples/s | 51.6 steps/s
[Step=15700 Epoch=60.4] | Loss=0.00114 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.581 | L2-Norm(final)=2.738 | 3666.0 samples/s | 57.3 steps/s
[Step=15750 Epoch=60.6] | Loss=0.00103 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.578 | L2-Norm(final)=2.739 | 1599.2 samples/s | 25.0 steps/s
[Step=15800 Epoch=60.8] | Loss=0.00095 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.574 | L2-Norm(final)=2.740 | 3336.4 samples/s | 52.1 steps/s
[Step=15850 Epoch=61.0] | Loss=0.00088 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.570 | L2-Norm(final)=2.740 | 3324.5 samples/s | 51.9 steps/s
[Step=15900 Epoch=61.2] | Loss=0.00082 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.567 | L2-Norm(final)=2.741 | 3317.2 samples/s | 51.8 steps/s
[Step=15950 Epoch=61.4] | Loss=0.00077 | Reg=0.00345 | FP-Reg=0.002 | acc=1.0000 | L2-Norm=18.564 | L2-Norm(final)=2.742 | 3381.5 samples/s | 52.8 steps/s
[Step=16000 Epoch=61.6] | Loss=0.00072 | Reg=0.00345 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.561 | L2-Norm(final)=2.742 | 1657.4 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18049 | acc=0.8734 | tpr=0.8270 | fpr=0.0260 | 3655.9 samples/s | 14.3 steps/s
Avg test loss: 0.18149, Avg test acc: 0.87030, Avg tpr: 0.82555, Avg fpr: 0.03128, total FA: 244

Testing server on iccad2012
[Step=  50] | Loss=0.40899 | acc=0.8073 | tpr=0.9867 | fpr=0.1959 | 3172.9 samples/s | 12.4 steps/s
[Step= 100] | Loss=0.41347 | acc=0.8073 | tpr=0.9936 | fpr=0.1962 | 5996.9 samples/s | 23.4 steps/s
[Step= 150] | Loss=0.41600 | acc=0.8073 | tpr=0.9942 | fpr=0.1961 | 6727.4 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.41680 | acc=0.8080 | tpr=0.9923 | fpr=0.1954 | 6603.3 samples/s | 25.8 steps/s
[Step= 250] | Loss=0.41798 | acc=0.8068 | tpr=0.9886 | fpr=0.1965 | 6292.7 samples/s | 24.6 steps/s
[Step= 300] | Loss=0.41928 | acc=0.8067 | tpr=0.9884 | fpr=0.1966 | 6633.1 samples/s | 25.9 steps/s
[Step= 350] | Loss=0.42111 | acc=0.8063 | tpr=0.9869 | fpr=0.1970 | 6789.0 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.42259 | acc=0.8058 | tpr=0.9836 | fpr=0.1974 | 6772.6 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.42447 | acc=0.8054 | tpr=0.9839 | fpr=0.1978 | 6623.7 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.42486 | acc=0.8051 | tpr=0.9841 | fpr=0.1982 | 6676.1 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.42250 | acc=0.8057 | tpr=0.9849 | fpr=0.1975 | 12668.9 samples/s | 49.5 steps/s
Avg test loss: 0.42211, Avg test acc: 0.80582, Avg tpr: 0.98494, Avg fpr: 0.19744, total FA: 27414

server round 20/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=31.2] | Loss=0.07322 | Reg=0.00345 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.564 | L2-Norm(final)=2.763 | 3628.3 samples/s | 56.7 steps/s
[Step=16050 Epoch=31.3] | Loss=0.02292 | Reg=0.00344 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.538 | L2-Norm(final)=2.762 | 3213.1 samples/s | 50.2 steps/s
[Step=16100 Epoch=31.4] | Loss=0.01868 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.530 | L2-Norm(final)=2.767 | 3472.3 samples/s | 54.3 steps/s
[Step=16150 Epoch=31.5] | Loss=0.01626 | Reg=0.00343 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.527 | L2-Norm(final)=2.771 | 3465.7 samples/s | 54.2 steps/s
[Step=16200 Epoch=31.6] | Loss=0.01468 | Reg=0.00343 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.525 | L2-Norm(final)=2.774 | 3462.5 samples/s | 54.1 steps/s
[Step=16250 Epoch=31.7] | Loss=0.01306 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.524 | L2-Norm(final)=2.778 | 3209.3 samples/s | 50.1 steps/s
[Step=16300 Epoch=31.8] | Loss=0.01325 | Reg=0.00343 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.523 | L2-Norm(final)=2.782 | 3112.2 samples/s | 48.6 steps/s
[Step=16350 Epoch=31.9] | Loss=0.01312 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.522 | L2-Norm(final)=2.784 | 3319.2 samples/s | 51.9 steps/s
[Step=16400 Epoch=32.0] | Loss=0.01298 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.522 | L2-Norm(final)=2.786 | 3366.7 samples/s | 52.6 steps/s
[Step=16450 Epoch=32.1] | Loss=0.01308 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.522 | L2-Norm(final)=2.788 | 3379.4 samples/s | 52.8 steps/s
[Step=16500 Epoch=32.2] | Loss=0.01309 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.521 | L2-Norm(final)=2.789 | 3988.3 samples/s | 62.3 steps/s
[Step=16550 Epoch=32.3] | Loss=0.01287 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9531 | L2-Norm=18.521 | L2-Norm(final)=2.790 | 1582.4 samples/s | 24.7 steps/s
[Step=16600 Epoch=32.4] | Loss=0.01274 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.521 | L2-Norm(final)=2.792 | 3460.3 samples/s | 54.1 steps/s
[Step=16650 Epoch=32.5] | Loss=0.01252 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.521 | L2-Norm(final)=2.793 | 3464.8 samples/s | 54.1 steps/s
[Step=16700 Epoch=32.6] | Loss=0.01230 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.521 | L2-Norm(final)=2.794 | 3454.5 samples/s | 54.0 steps/s
[Step=16750 Epoch=32.7] | Loss=0.01235 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.521 | L2-Norm(final)=2.796 | 3483.0 samples/s | 54.4 steps/s
[Step=16800 Epoch=32.8] | Loss=0.01211 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.521 | L2-Norm(final)=2.797 | 3505.3 samples/s | 54.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step16800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=31.3] | Loss=0.18900 | Reg=0.00345 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.564 | L2-Norm(final)=2.763 | 3841.1 samples/s | 60.0 steps/s
[Step=16050 Epoch=31.4] | Loss=0.02204 | Reg=0.00344 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.535 | L2-Norm(final)=2.763 | 3270.0 samples/s | 51.1 steps/s
[Step=16100 Epoch=31.5] | Loss=0.01723 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.528 | L2-Norm(final)=2.769 | 3474.1 samples/s | 54.3 steps/s
[Step=16150 Epoch=31.6] | Loss=0.01629 | Reg=0.00343 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.524 | L2-Norm(final)=2.774 | 3451.7 samples/s | 53.9 steps/s
[Step=16200 Epoch=31.7] | Loss=0.01485 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.523 | L2-Norm(final)=2.777 | 3469.9 samples/s | 54.2 steps/s
[Step=16250 Epoch=31.8] | Loss=0.01390 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.521 | L2-Norm(final)=2.780 | 3472.8 samples/s | 54.3 steps/s
[Step=16300 Epoch=31.9] | Loss=0.01342 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.520 | L2-Norm(final)=2.783 | 3411.8 samples/s | 53.3 steps/s
[Step=16350 Epoch=32.0] | Loss=0.01277 | Reg=0.00343 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.519 | L2-Norm(final)=2.785 | 3476.1 samples/s | 54.3 steps/s
[Step=16400 Epoch=32.1] | Loss=0.01225 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.519 | L2-Norm(final)=2.788 | 3482.2 samples/s | 54.4 steps/s
[Step=16450 Epoch=32.2] | Loss=0.01222 | Reg=0.00343 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.519 | L2-Norm(final)=2.790 | 3489.2 samples/s | 54.5 steps/s
[Step=16500 Epoch=32.3] | Loss=0.01231 | Reg=0.00343 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.518 | L2-Norm(final)=2.792 | 4096.2 samples/s | 64.0 steps/s
[Step=16550 Epoch=32.4] | Loss=0.01189 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.518 | L2-Norm(final)=2.793 | 1604.6 samples/s | 25.1 steps/s
[Step=16600 Epoch=32.5] | Loss=0.01165 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.518 | L2-Norm(final)=2.795 | 3432.5 samples/s | 53.6 steps/s
[Step=16650 Epoch=32.6] | Loss=0.01138 | Reg=0.00343 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.519 | L2-Norm(final)=2.797 | 3456.8 samples/s | 54.0 steps/s
[Step=16700 Epoch=32.6] | Loss=0.01144 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.519 | L2-Norm(final)=2.799 | 3444.1 samples/s | 53.8 steps/s
[Step=16750 Epoch=32.7] | Loss=0.01118 | Reg=0.00343 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.519 | L2-Norm(final)=2.800 | 3455.8 samples/s | 54.0 steps/s
[Step=16800 Epoch=32.8] | Loss=0.01108 | Reg=0.00343 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.519 | L2-Norm(final)=2.802 | 3471.7 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step16800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=61.3] | Loss=0.17512 | Reg=0.00345 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.564 | L2-Norm(final)=2.764 | 3482.2 samples/s | 54.4 steps/s
[Step=16050 Epoch=61.5] | Loss=0.00670 | Reg=0.00343 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.514 | L2-Norm(final)=2.767 | 3295.7 samples/s | 51.5 steps/s
[Step=16100 Epoch=61.7] | Loss=0.00350 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.506 | L2-Norm(final)=2.769 | 3333.6 samples/s | 52.1 steps/s
[Step=16150 Epoch=61.9] | Loss=0.00241 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.501 | L2-Norm(final)=2.770 | 3330.0 samples/s | 52.0 steps/s
[Step=16200 Epoch=62.1] | Loss=0.00185 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.497 | L2-Norm(final)=2.772 | 3321.0 samples/s | 51.9 steps/s
[Step=16250 Epoch=62.3] | Loss=0.00152 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.493 | L2-Norm(final)=2.773 | 3978.9 samples/s | 62.2 steps/s
[Step=16300 Epoch=62.5] | Loss=0.00127 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.491 | L2-Norm(final)=2.774 | 1549.3 samples/s | 24.2 steps/s
[Step=16350 Epoch=62.6] | Loss=0.00110 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.488 | L2-Norm(final)=2.775 | 3306.1 samples/s | 51.7 steps/s
[Step=16400 Epoch=62.8] | Loss=0.00096 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.486 | L2-Norm(final)=2.775 | 3327.9 samples/s | 52.0 steps/s
[Step=16450 Epoch=63.0] | Loss=0.00086 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.483 | L2-Norm(final)=2.776 | 3318.3 samples/s | 51.8 steps/s
[Step=16500 Epoch=63.2] | Loss=0.00078 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.481 | L2-Norm(final)=2.776 | 3586.5 samples/s | 56.0 steps/s
[Step=16550 Epoch=63.4] | Loss=0.00071 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.479 | L2-Norm(final)=2.776 | 1625.8 samples/s | 25.4 steps/s
[Step=16600 Epoch=63.6] | Loss=0.00065 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.478 | L2-Norm(final)=2.777 | 3342.4 samples/s | 52.2 steps/s
[Step=16650 Epoch=63.8] | Loss=0.00060 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.476 | L2-Norm(final)=2.777 | 3320.4 samples/s | 51.9 steps/s
[Step=16700 Epoch=64.0] | Loss=0.00056 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.474 | L2-Norm(final)=2.777 | 3353.7 samples/s | 52.4 steps/s
[Step=16750 Epoch=64.2] | Loss=0.00053 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.472 | L2-Norm(final)=2.777 | 3289.4 samples/s | 51.4 steps/s
[Step=16800 Epoch=64.4] | Loss=0.00050 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.471 | L2-Norm(final)=2.778 | 1684.8 samples/s | 26.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step16800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=61.6] | Loss=0.03141 | Reg=0.00345 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.564 | L2-Norm(final)=2.764 | 3543.9 samples/s | 55.4 steps/s
[Step=16050 Epoch=61.8] | Loss=0.00482 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.516 | L2-Norm(final)=2.768 | 3233.5 samples/s | 50.5 steps/s
[Step=16100 Epoch=62.0] | Loss=0.00254 | Reg=0.00343 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.509 | L2-Norm(final)=2.770 | 3333.9 samples/s | 52.1 steps/s
[Step=16150 Epoch=62.2] | Loss=0.00173 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.504 | L2-Norm(final)=2.772 | 3299.6 samples/s | 51.6 steps/s
[Step=16200 Epoch=62.4] | Loss=0.00134 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.499 | L2-Norm(final)=2.773 | 3291.2 samples/s | 51.4 steps/s
[Step=16250 Epoch=62.6] | Loss=0.00112 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.496 | L2-Norm(final)=2.774 | 3928.3 samples/s | 61.4 steps/s
[Step=16300 Epoch=62.7] | Loss=0.00094 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.493 | L2-Norm(final)=2.775 | 1550.5 samples/s | 24.2 steps/s
[Step=16350 Epoch=62.9] | Loss=0.00081 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.490 | L2-Norm(final)=2.776 | 3327.8 samples/s | 52.0 steps/s
[Step=16400 Epoch=63.1] | Loss=0.00071 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.488 | L2-Norm(final)=2.776 | 3320.2 samples/s | 51.9 steps/s
[Step=16450 Epoch=63.3] | Loss=0.00063 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.486 | L2-Norm(final)=2.777 | 3341.6 samples/s | 52.2 steps/s
[Step=16500 Epoch=63.5] | Loss=0.00057 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.483 | L2-Norm(final)=2.777 | 3660.4 samples/s | 57.2 steps/s
[Step=16550 Epoch=63.7] | Loss=0.00052 | Reg=0.00342 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.481 | L2-Norm(final)=2.777 | 1598.2 samples/s | 25.0 steps/s
[Step=16600 Epoch=63.9] | Loss=0.00048 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.479 | L2-Norm(final)=2.778 | 3347.4 samples/s | 52.3 steps/s
[Step=16650 Epoch=64.1] | Loss=0.00045 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.478 | L2-Norm(final)=2.778 | 3312.5 samples/s | 51.8 steps/s
[Step=16700 Epoch=64.3] | Loss=0.00042 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.476 | L2-Norm(final)=2.778 | 3319.2 samples/s | 51.9 steps/s
[Step=16750 Epoch=64.5] | Loss=0.00039 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.474 | L2-Norm(final)=2.779 | 3386.7 samples/s | 52.9 steps/s
[Step=16800 Epoch=64.7] | Loss=0.00037 | Reg=0.00341 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.473 | L2-Norm(final)=2.779 | 1656.3 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17485 | acc=0.8838 | tpr=0.8428 | fpr=0.0273 | 3644.4 samples/s | 14.2 steps/s
Avg test loss: 0.17695, Avg test acc: 0.88144, Avg tpr: 0.84141, Avg fpr: 0.03051, total FA: 238

Testing server on iccad2012
[Step=  50] | Loss=0.47294 | acc=0.8013 | tpr=0.9867 | fpr=0.2020 | 3602.7 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.47784 | acc=0.7993 | tpr=0.9936 | fpr=0.2043 | 5884.7 samples/s | 23.0 steps/s
[Step= 150] | Loss=0.48069 | acc=0.7983 | tpr=0.9942 | fpr=0.2053 | 6445.1 samples/s | 25.2 steps/s
[Step= 200] | Loss=0.48131 | acc=0.7990 | tpr=0.9923 | fpr=0.2045 | 6533.8 samples/s | 25.5 steps/s
[Step= 250] | Loss=0.48231 | acc=0.7974 | tpr=0.9878 | fpr=0.2060 | 6886.4 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.48332 | acc=0.7974 | tpr=0.9876 | fpr=0.2061 | 7001.9 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.48536 | acc=0.7970 | tpr=0.9856 | fpr=0.2065 | 6832.1 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.48722 | acc=0.7965 | tpr=0.9830 | fpr=0.2069 | 6782.7 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.48910 | acc=0.7964 | tpr=0.9839 | fpr=0.2070 | 6676.3 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.48942 | acc=0.7958 | tpr=0.9841 | fpr=0.2076 | 7028.5 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.48656 | acc=0.7967 | tpr=0.9841 | fpr=0.2067 | 12306.8 samples/s | 48.1 steps/s
Avg test loss: 0.48612, Avg test acc: 0.79678, Avg tpr: 0.98376, Avg fpr: 0.20662, total FA: 28689

server round 21/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=32.8] | Loss=0.05414 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.476 | L2-Norm(final)=2.802 | 3739.2 samples/s | 58.4 steps/s
[Step=16850 Epoch=32.9] | Loss=0.01692 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.449 | L2-Norm(final)=2.803 | 3255.2 samples/s | 50.9 steps/s
[Step=16900 Epoch=33.0] | Loss=0.01461 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.441 | L2-Norm(final)=2.806 | 3462.6 samples/s | 54.1 steps/s
[Step=16950 Epoch=33.1] | Loss=0.01353 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.437 | L2-Norm(final)=2.808 | 3465.1 samples/s | 54.1 steps/s
[Step=17000 Epoch=33.2] | Loss=0.01318 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.435 | L2-Norm(final)=2.809 | 3471.5 samples/s | 54.2 steps/s
[Step=17050 Epoch=33.3] | Loss=0.01252 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.434 | L2-Norm(final)=2.812 | 3461.2 samples/s | 54.1 steps/s
[Step=17100 Epoch=33.4] | Loss=0.01255 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.433 | L2-Norm(final)=2.814 | 3489.7 samples/s | 54.5 steps/s
[Step=17150 Epoch=33.4] | Loss=0.01236 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.433 | L2-Norm(final)=2.817 | 3477.9 samples/s | 54.3 steps/s
[Step=17200 Epoch=33.5] | Loss=0.01208 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.432 | L2-Norm(final)=2.819 | 3465.7 samples/s | 54.2 steps/s
[Step=17250 Epoch=33.6] | Loss=0.01214 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.432 | L2-Norm(final)=2.821 | 3474.0 samples/s | 54.3 steps/s
[Step=17300 Epoch=33.7] | Loss=0.01202 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.432 | L2-Norm(final)=2.823 | 4030.9 samples/s | 63.0 steps/s
[Step=17350 Epoch=33.8] | Loss=0.01196 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.432 | L2-Norm(final)=2.825 | 1592.7 samples/s | 24.9 steps/s
[Step=17400 Epoch=33.9] | Loss=0.01183 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.433 | L2-Norm(final)=2.826 | 3479.1 samples/s | 54.4 steps/s
[Step=17450 Epoch=34.0] | Loss=0.01175 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.433 | L2-Norm(final)=2.828 | 3487.6 samples/s | 54.5 steps/s
[Step=17500 Epoch=34.1] | Loss=0.01152 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.433 | L2-Norm(final)=2.830 | 3501.1 samples/s | 54.7 steps/s
[Step=17550 Epoch=34.2] | Loss=0.01150 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.434 | L2-Norm(final)=2.832 | 3501.1 samples/s | 54.7 steps/s
[Step=17600 Epoch=34.3] | Loss=0.01147 | Reg=0.00340 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.434 | L2-Norm(final)=2.833 | 3506.7 samples/s | 54.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step17600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=32.8] | Loss=0.08243 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.476 | L2-Norm(final)=2.802 | 3759.2 samples/s | 58.7 steps/s
[Step=16850 Epoch=32.9] | Loss=0.01719 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.446 | L2-Norm(final)=2.801 | 3332.2 samples/s | 52.1 steps/s
[Step=16900 Epoch=33.0] | Loss=0.01337 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.439 | L2-Norm(final)=2.805 | 3408.2 samples/s | 53.3 steps/s
[Step=16950 Epoch=33.1] | Loss=0.01188 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.436 | L2-Norm(final)=2.810 | 3525.2 samples/s | 55.1 steps/s
[Step=17000 Epoch=33.2] | Loss=0.01163 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.434 | L2-Norm(final)=2.815 | 3599.3 samples/s | 56.2 steps/s
[Step=17050 Epoch=33.3] | Loss=0.01160 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.434 | L2-Norm(final)=2.818 | 3532.7 samples/s | 55.2 steps/s
[Step=17100 Epoch=33.4] | Loss=0.01130 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.433 | L2-Norm(final)=2.821 | 3481.5 samples/s | 54.4 steps/s
[Step=17150 Epoch=33.5] | Loss=0.01181 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.433 | L2-Norm(final)=2.823 | 3480.0 samples/s | 54.4 steps/s
[Step=17200 Epoch=33.6] | Loss=0.01179 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.432 | L2-Norm(final)=2.824 | 3483.9 samples/s | 54.4 steps/s
[Step=17250 Epoch=33.7] | Loss=0.01187 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.432 | L2-Norm(final)=2.825 | 3470.8 samples/s | 54.2 steps/s
[Step=17300 Epoch=33.8] | Loss=0.01166 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.431 | L2-Norm(final)=2.826 | 4107.9 samples/s | 64.2 steps/s
[Step=17350 Epoch=33.9] | Loss=0.01190 | Reg=0.00340 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.431 | L2-Norm(final)=2.828 | 1607.6 samples/s | 25.1 steps/s
[Step=17400 Epoch=34.0] | Loss=0.01172 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.431 | L2-Norm(final)=2.828 | 3467.1 samples/s | 54.2 steps/s
[Step=17450 Epoch=34.1] | Loss=0.01131 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.431 | L2-Norm(final)=2.830 | 3500.3 samples/s | 54.7 steps/s
[Step=17500 Epoch=34.2] | Loss=0.01113 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.431 | L2-Norm(final)=2.831 | 3491.8 samples/s | 54.6 steps/s
[Step=17550 Epoch=34.3] | Loss=0.01087 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.432 | L2-Norm(final)=2.833 | 3576.2 samples/s | 55.9 steps/s
[Step=17600 Epoch=34.4] | Loss=0.01076 | Reg=0.00340 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.432 | L2-Norm(final)=2.834 | 3446.5 samples/s | 53.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step17600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=64.4] | Loss=0.16984 | Reg=0.00341 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.476 | L2-Norm(final)=2.801 | 3732.8 samples/s | 58.3 steps/s
[Step=16850 Epoch=64.6] | Loss=0.01445 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.436 | L2-Norm(final)=2.791 | 3011.7 samples/s | 47.1 steps/s
[Step=16900 Epoch=64.8] | Loss=0.00801 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.433 | L2-Norm(final)=2.789 | 2990.1 samples/s | 46.7 steps/s
[Step=16950 Epoch=64.9] | Loss=0.00543 | Reg=0.00340 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.428 | L2-Norm(final)=2.789 | 3116.4 samples/s | 48.7 steps/s
[Step=17000 Epoch=65.1] | Loss=0.00410 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.425 | L2-Norm(final)=2.790 | 2999.3 samples/s | 46.9 steps/s
[Step=17050 Epoch=65.3] | Loss=0.00330 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.421 | L2-Norm(final)=2.791 | 3720.9 samples/s | 58.1 steps/s
[Step=17100 Epoch=65.5] | Loss=0.00276 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.418 | L2-Norm(final)=2.791 | 1474.1 samples/s | 23.0 steps/s
[Step=17150 Epoch=65.7] | Loss=0.00237 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.415 | L2-Norm(final)=2.792 | 3310.0 samples/s | 51.7 steps/s
[Step=17200 Epoch=65.9] | Loss=0.00208 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.412 | L2-Norm(final)=2.793 | 3340.5 samples/s | 52.2 steps/s
[Step=17250 Epoch=66.1] | Loss=0.00186 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.410 | L2-Norm(final)=2.794 | 3298.7 samples/s | 51.5 steps/s
[Step=17300 Epoch=66.3] | Loss=0.00168 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.408 | L2-Norm(final)=2.795 | 3592.8 samples/s | 56.1 steps/s
[Step=17350 Epoch=66.5] | Loss=0.00153 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.406 | L2-Norm(final)=2.795 | 1615.0 samples/s | 25.2 steps/s
[Step=17400 Epoch=66.7] | Loss=0.00140 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=2.796 | 3335.3 samples/s | 52.1 steps/s
[Step=17450 Epoch=66.9] | Loss=0.00130 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.402 | L2-Norm(final)=2.796 | 3338.6 samples/s | 52.2 steps/s
[Step=17500 Epoch=67.1] | Loss=0.00121 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.400 | L2-Norm(final)=2.797 | 3302.4 samples/s | 51.6 steps/s
[Step=17550 Epoch=67.2] | Loss=0.00113 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.398 | L2-Norm(final)=2.798 | 3319.9 samples/s | 51.9 steps/s
[Step=17600 Epoch=67.4] | Loss=0.00106 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.397 | L2-Norm(final)=2.798 | 1676.8 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step17600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=64.7] | Loss=0.13804 | Reg=0.00341 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.476 | L2-Norm(final)=2.802 | 3545.2 samples/s | 55.4 steps/s
[Step=16850 Epoch=64.9] | Loss=0.00798 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.419 | L2-Norm(final)=2.796 | 3261.2 samples/s | 51.0 steps/s
[Step=16900 Epoch=65.1] | Loss=0.00420 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.411 | L2-Norm(final)=2.797 | 3330.2 samples/s | 52.0 steps/s
[Step=16950 Epoch=65.2] | Loss=0.00287 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.406 | L2-Norm(final)=2.799 | 3311.0 samples/s | 51.7 steps/s
[Step=17000 Epoch=65.4] | Loss=0.00217 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.402 | L2-Norm(final)=2.800 | 3316.9 samples/s | 51.8 steps/s
[Step=17050 Epoch=65.6] | Loss=0.00182 | Reg=0.00339 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.399 | L2-Norm(final)=2.801 | 3994.5 samples/s | 62.4 steps/s
[Step=17100 Epoch=65.8] | Loss=0.00153 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.397 | L2-Norm(final)=2.802 | 1541.3 samples/s | 24.1 steps/s
[Step=17150 Epoch=66.0] | Loss=0.00131 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.395 | L2-Norm(final)=2.803 | 3313.3 samples/s | 51.8 steps/s
[Step=17200 Epoch=66.2] | Loss=0.00116 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.393 | L2-Norm(final)=2.803 | 3326.1 samples/s | 52.0 steps/s
[Step=17250 Epoch=66.4] | Loss=0.00103 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.391 | L2-Norm(final)=2.804 | 3325.7 samples/s | 52.0 steps/s
[Step=17300 Epoch=66.6] | Loss=0.00093 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.389 | L2-Norm(final)=2.805 | 3666.7 samples/s | 57.3 steps/s
[Step=17350 Epoch=66.8] | Loss=0.00085 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.387 | L2-Norm(final)=2.805 | 1612.9 samples/s | 25.2 steps/s
[Step=17400 Epoch=67.0] | Loss=0.00078 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.385 | L2-Norm(final)=2.805 | 3324.4 samples/s | 51.9 steps/s
[Step=17450 Epoch=67.2] | Loss=0.00072 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.384 | L2-Norm(final)=2.806 | 3375.7 samples/s | 52.7 steps/s
[Step=17500 Epoch=67.4] | Loss=0.00067 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.382 | L2-Norm(final)=2.806 | 3322.6 samples/s | 51.9 steps/s
[Step=17550 Epoch=67.6] | Loss=0.00063 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.381 | L2-Norm(final)=2.806 | 3358.7 samples/s | 52.5 steps/s
[Step=17600 Epoch=67.7] | Loss=0.00059 | Reg=0.00338 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.379 | L2-Norm(final)=2.807 | 1669.0 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18483 | acc=0.8788 | tpr=0.8343 | fpr=0.0245 | 3650.3 samples/s | 14.3 steps/s
Avg test loss: 0.18699, Avg test acc: 0.87555, Avg tpr: 0.83109, Avg fpr: 0.02666, total FA: 208

Testing server on iccad2012
[Step=  50] | Loss=0.43448 | acc=0.8166 | tpr=0.9823 | fpr=0.1864 | 3651.8 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.43972 | acc=0.8149 | tpr=0.9915 | fpr=0.1884 | 6777.7 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.44185 | acc=0.8141 | tpr=0.9928 | fpr=0.1892 | 6991.5 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.44286 | acc=0.8150 | tpr=0.9913 | fpr=0.1882 | 6750.9 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.44374 | acc=0.8139 | tpr=0.9878 | fpr=0.1893 | 6938.9 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.44479 | acc=0.8136 | tpr=0.9876 | fpr=0.1895 | 7008.7 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.44696 | acc=0.8130 | tpr=0.9856 | fpr=0.1901 | 6763.2 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.44867 | acc=0.8125 | tpr=0.9830 | fpr=0.1906 | 6807.1 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.45076 | acc=0.8124 | tpr=0.9839 | fpr=0.1907 | 6747.6 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.45121 | acc=0.8121 | tpr=0.9841 | fpr=0.1910 | 6733.5 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.44849 | acc=0.8129 | tpr=0.9845 | fpr=0.1902 | 12705.9 samples/s | 49.6 steps/s
Avg test loss: 0.44802, Avg test acc: 0.81298, Avg tpr: 0.98415, Avg fpr: 0.19013, total FA: 26399

server round 22/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=34.3] | Loss=0.19124 | Reg=0.00338 | FP-Reg=0.000 | acc=0.8281 | L2-Norm=18.390 | L2-Norm(final)=2.831 | 3428.2 samples/s | 53.6 steps/s
[Step=17650 Epoch=34.4] | Loss=0.01642 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.365 | L2-Norm(final)=2.832 | 3359.4 samples/s | 52.5 steps/s
[Step=17700 Epoch=34.5] | Loss=0.01358 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.359 | L2-Norm(final)=2.837 | 3479.9 samples/s | 54.4 steps/s
[Step=17750 Epoch=34.6] | Loss=0.01382 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.355 | L2-Norm(final)=2.840 | 3481.8 samples/s | 54.4 steps/s
[Step=17800 Epoch=34.7] | Loss=0.01271 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.353 | L2-Norm(final)=2.841 | 3435.9 samples/s | 53.7 steps/s
[Step=17850 Epoch=34.8] | Loss=0.01236 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.351 | L2-Norm(final)=2.843 | 3445.6 samples/s | 53.8 steps/s
[Step=17900 Epoch=34.9] | Loss=0.01175 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.350 | L2-Norm(final)=2.844 | 3459.0 samples/s | 54.0 steps/s
[Step=17950 Epoch=35.0] | Loss=0.01145 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.349 | L2-Norm(final)=2.847 | 3473.4 samples/s | 54.3 steps/s
[Step=18000 Epoch=35.1] | Loss=0.01170 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.349 | L2-Norm(final)=2.849 | 3460.4 samples/s | 54.1 steps/s
[Step=18050 Epoch=35.2] | Loss=0.01230 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.349 | L2-Norm(final)=2.850 | 3466.2 samples/s | 54.2 steps/s
[Step=18100 Epoch=35.3] | Loss=0.01229 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.349 | L2-Norm(final)=2.850 | 4035.6 samples/s | 63.1 steps/s
[Step=18150 Epoch=35.4] | Loss=0.01224 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.348 | L2-Norm(final)=2.851 | 1577.6 samples/s | 24.6 steps/s
[Step=18200 Epoch=35.5] | Loss=0.01183 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.348 | L2-Norm(final)=2.852 | 3444.0 samples/s | 53.8 steps/s
[Step=18250 Epoch=35.6] | Loss=0.01149 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.348 | L2-Norm(final)=2.853 | 3467.8 samples/s | 54.2 steps/s
[Step=18300 Epoch=35.7] | Loss=0.01144 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.349 | L2-Norm(final)=2.854 | 3478.8 samples/s | 54.4 steps/s
[Step=18350 Epoch=35.8] | Loss=0.01143 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.349 | L2-Norm(final)=2.855 | 3456.6 samples/s | 54.0 steps/s
[Step=18400 Epoch=35.9] | Loss=0.01151 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.349 | L2-Norm(final)=2.856 | 3459.5 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step18400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=34.4] | Loss=0.02793 | Reg=0.00338 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.390 | L2-Norm(final)=2.831 | 3899.3 samples/s | 60.9 steps/s
[Step=17650 Epoch=34.5] | Loss=0.01815 | Reg=0.00337 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.365 | L2-Norm(final)=2.835 | 3207.2 samples/s | 50.1 steps/s
[Step=17700 Epoch=34.6] | Loss=0.01645 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.359 | L2-Norm(final)=2.839 | 3460.7 samples/s | 54.1 steps/s
[Step=17750 Epoch=34.7] | Loss=0.01489 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.357 | L2-Norm(final)=2.842 | 3456.5 samples/s | 54.0 steps/s
[Step=17800 Epoch=34.8] | Loss=0.01377 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.355 | L2-Norm(final)=2.845 | 3469.6 samples/s | 54.2 steps/s
[Step=17850 Epoch=34.9] | Loss=0.01338 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.354 | L2-Norm(final)=2.847 | 3429.3 samples/s | 53.6 steps/s
[Step=17900 Epoch=35.0] | Loss=0.01258 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.353 | L2-Norm(final)=2.850 | 3492.8 samples/s | 54.6 steps/s
[Step=17950 Epoch=35.1] | Loss=0.01255 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.353 | L2-Norm(final)=2.852 | 3493.2 samples/s | 54.6 steps/s
[Step=18000 Epoch=35.2] | Loss=0.01218 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.352 | L2-Norm(final)=2.853 | 3478.3 samples/s | 54.3 steps/s
[Step=18050 Epoch=35.3] | Loss=0.01220 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.352 | L2-Norm(final)=2.855 | 3487.8 samples/s | 54.5 steps/s
[Step=18100 Epoch=35.4] | Loss=0.01218 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.351 | L2-Norm(final)=2.856 | 4093.0 samples/s | 64.0 steps/s
[Step=18150 Epoch=35.5] | Loss=0.01184 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.351 | L2-Norm(final)=2.856 | 1595.3 samples/s | 24.9 steps/s
[Step=18200 Epoch=35.6] | Loss=0.01151 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.351 | L2-Norm(final)=2.858 | 3427.9 samples/s | 53.6 steps/s
[Step=18250 Epoch=35.7] | Loss=0.01114 | Reg=0.00337 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.351 | L2-Norm(final)=2.859 | 3430.5 samples/s | 53.6 steps/s
[Step=18300 Epoch=35.8] | Loss=0.01087 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.351 | L2-Norm(final)=2.861 | 3430.7 samples/s | 53.6 steps/s
[Step=18350 Epoch=35.9] | Loss=0.01096 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.352 | L2-Norm(final)=2.862 | 3442.8 samples/s | 53.8 steps/s
[Step=18400 Epoch=36.0] | Loss=0.01117 | Reg=0.00337 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.351 | L2-Norm(final)=2.863 | 3467.1 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step18400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=67.4] | Loss=0.06500 | Reg=0.00338 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.390 | L2-Norm(final)=2.831 | 3592.8 samples/s | 56.1 steps/s
[Step=17650 Epoch=67.6] | Loss=0.00644 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.337 | L2-Norm(final)=2.833 | 3206.2 samples/s | 50.1 steps/s
[Step=17700 Epoch=67.8] | Loss=0.00345 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.330 | L2-Norm(final)=2.834 | 3329.6 samples/s | 52.0 steps/s
[Step=17750 Epoch=68.0] | Loss=0.00232 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.326 | L2-Norm(final)=2.836 | 3333.5 samples/s | 52.1 steps/s
[Step=17800 Epoch=68.2] | Loss=0.00176 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.322 | L2-Norm(final)=2.836 | 3327.3 samples/s | 52.0 steps/s
[Step=17850 Epoch=68.4] | Loss=0.00141 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.319 | L2-Norm(final)=2.837 | 3953.0 samples/s | 61.8 steps/s
[Step=17900 Epoch=68.6] | Loss=0.00118 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.316 | L2-Norm(final)=2.838 | 1543.2 samples/s | 24.1 steps/s
[Step=17950 Epoch=68.8] | Loss=0.00102 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.313 | L2-Norm(final)=2.838 | 3320.6 samples/s | 51.9 steps/s
[Step=18000 Epoch=69.0] | Loss=0.00090 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.311 | L2-Norm(final)=2.839 | 3318.2 samples/s | 51.8 steps/s
[Step=18050 Epoch=69.2] | Loss=0.00080 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.309 | L2-Norm(final)=2.839 | 3318.0 samples/s | 51.8 steps/s
[Step=18100 Epoch=69.4] | Loss=0.00072 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.307 | L2-Norm(final)=2.840 | 3593.2 samples/s | 56.1 steps/s
[Step=18150 Epoch=69.5] | Loss=0.00066 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.305 | L2-Norm(final)=2.840 | 1597.6 samples/s | 25.0 steps/s
[Step=18200 Epoch=69.7] | Loss=0.00061 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.304 | L2-Norm(final)=2.840 | 3332.1 samples/s | 52.1 steps/s
[Step=18250 Epoch=69.9] | Loss=0.00056 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.302 | L2-Norm(final)=2.841 | 3282.6 samples/s | 51.3 steps/s
[Step=18300 Epoch=70.1] | Loss=0.00053 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.300 | L2-Norm(final)=2.841 | 3321.1 samples/s | 51.9 steps/s
[Step=18350 Epoch=70.3] | Loss=0.00049 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.299 | L2-Norm(final)=2.841 | 3307.5 samples/s | 51.7 steps/s
[Step=18400 Epoch=70.5] | Loss=0.00046 | Reg=0.00335 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.297 | L2-Norm(final)=2.842 | 1660.9 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step18400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=67.8] | Loss=0.20229 | Reg=0.00338 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=18.390 | L2-Norm(final)=2.831 | 3593.5 samples/s | 56.1 steps/s
[Step=17650 Epoch=67.9] | Loss=0.00786 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.341 | L2-Norm(final)=2.832 | 3217.3 samples/s | 50.3 steps/s
[Step=17700 Epoch=68.1] | Loss=0.00399 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.336 | L2-Norm(final)=2.834 | 3310.3 samples/s | 51.7 steps/s
[Step=17750 Epoch=68.3] | Loss=0.00269 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.332 | L2-Norm(final)=2.834 | 3293.4 samples/s | 51.5 steps/s
[Step=17800 Epoch=68.5] | Loss=0.00204 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.328 | L2-Norm(final)=2.835 | 3302.0 samples/s | 51.6 steps/s
[Step=17850 Epoch=68.7] | Loss=0.00164 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.325 | L2-Norm(final)=2.835 | 4022.6 samples/s | 62.9 steps/s
[Step=17900 Epoch=68.9] | Loss=0.00137 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.322 | L2-Norm(final)=2.836 | 1546.3 samples/s | 24.2 steps/s
[Step=17950 Epoch=69.1] | Loss=0.00118 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.319 | L2-Norm(final)=2.836 | 3299.2 samples/s | 51.6 steps/s
[Step=18000 Epoch=69.3] | Loss=0.00103 | Reg=0.00336 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.317 | L2-Norm(final)=2.836 | 3293.2 samples/s | 51.5 steps/s
[Step=18050 Epoch=69.5] | Loss=0.00092 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.315 | L2-Norm(final)=2.836 | 3334.1 samples/s | 52.1 steps/s
[Step=18100 Epoch=69.7] | Loss=0.00083 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.312 | L2-Norm(final)=2.837 | 3682.7 samples/s | 57.5 steps/s
[Step=18150 Epoch=69.9] | Loss=0.00076 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.310 | L2-Norm(final)=2.837 | 1602.7 samples/s | 25.0 steps/s
[Step=18200 Epoch=70.1] | Loss=0.00070 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.308 | L2-Norm(final)=2.837 | 3303.7 samples/s | 51.6 steps/s
[Step=18250 Epoch=70.3] | Loss=0.00065 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.307 | L2-Norm(final)=2.837 | 3330.3 samples/s | 52.0 steps/s
[Step=18300 Epoch=70.4] | Loss=0.00060 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.305 | L2-Norm(final)=2.837 | 3336.7 samples/s | 52.1 steps/s
[Step=18350 Epoch=70.6] | Loss=0.00056 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.303 | L2-Norm(final)=2.837 | 3379.6 samples/s | 52.8 steps/s
[Step=18400 Epoch=70.8] | Loss=0.00053 | Reg=0.00335 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.301 | L2-Norm(final)=2.838 | 1658.3 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.16978 | acc=0.8872 | tpr=0.8486 | fpr=0.0290 | 3604.5 samples/s | 14.1 steps/s
Avg test loss: 0.17154, Avg test acc: 0.88525, Avg tpr: 0.84718, Avg fpr: 0.03102, total FA: 242

Testing server on iccad2012
[Step=  50] | Loss=0.45885 | acc=0.8095 | tpr=0.9823 | fpr=0.1937 | 3642.2 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.46453 | acc=0.8067 | tpr=0.9872 | fpr=0.1967 | 6688.3 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.46686 | acc=0.8061 | tpr=0.9899 | fpr=0.1973 | 6930.0 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.46733 | acc=0.8067 | tpr=0.9891 | fpr=0.1967 | 6977.0 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.46793 | acc=0.8056 | tpr=0.9860 | fpr=0.1977 | 6654.5 samples/s | 26.0 steps/s
[Step= 300] | Loss=0.46917 | acc=0.8050 | tpr=0.9862 | fpr=0.1983 | 6906.6 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.47163 | acc=0.8045 | tpr=0.9843 | fpr=0.1988 | 6623.4 samples/s | 25.9 steps/s
[Step= 400] | Loss=0.47342 | acc=0.8041 | tpr=0.9819 | fpr=0.1991 | 6813.6 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.47548 | acc=0.8040 | tpr=0.9830 | fpr=0.1993 | 6795.3 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.47583 | acc=0.8036 | tpr=0.9828 | fpr=0.1997 | 6816.4 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.47321 | acc=0.8045 | tpr=0.9825 | fpr=0.1987 | 12511.7 samples/s | 48.9 steps/s
Avg test loss: 0.47276, Avg test acc: 0.80459, Avg tpr: 0.98217, Avg fpr: 0.19864, total FA: 27581

server round 23/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=35.9] | Loss=0.10523 | Reg=0.00335 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.303 | L2-Norm(final)=2.858 | 3500.7 samples/s | 54.7 steps/s
[Step=18450 Epoch=36.0] | Loss=0.01963 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.274 | L2-Norm(final)=2.857 | 3296.9 samples/s | 51.5 steps/s
[Step=18500 Epoch=36.1] | Loss=0.01549 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.268 | L2-Norm(final)=2.860 | 3458.6 samples/s | 54.0 steps/s
[Step=18550 Epoch=36.2] | Loss=0.01458 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.264 | L2-Norm(final)=2.862 | 3464.7 samples/s | 54.1 steps/s
[Step=18600 Epoch=36.3] | Loss=0.01441 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.261 | L2-Norm(final)=2.863 | 3477.2 samples/s | 54.3 steps/s
[Step=18650 Epoch=36.4] | Loss=0.01402 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.260 | L2-Norm(final)=2.864 | 3479.0 samples/s | 54.4 steps/s
[Step=18700 Epoch=36.5] | Loss=0.01356 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.259 | L2-Norm(final)=2.865 | 3503.6 samples/s | 54.7 steps/s
[Step=18750 Epoch=36.6] | Loss=0.01292 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.259 | L2-Norm(final)=2.867 | 3479.5 samples/s | 54.4 steps/s
[Step=18800 Epoch=36.7] | Loss=0.01243 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.259 | L2-Norm(final)=2.868 | 3486.8 samples/s | 54.5 steps/s
[Step=18850 Epoch=36.8] | Loss=0.01219 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.259 | L2-Norm(final)=2.870 | 3461.9 samples/s | 54.1 steps/s
[Step=18900 Epoch=36.9] | Loss=0.01201 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.259 | L2-Norm(final)=2.872 | 4057.6 samples/s | 63.4 steps/s
[Step=18950 Epoch=37.0] | Loss=0.01195 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.259 | L2-Norm(final)=2.874 | 1545.6 samples/s | 24.2 steps/s
[Step=19000 Epoch=37.1] | Loss=0.01192 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.260 | L2-Norm(final)=2.875 | 3465.8 samples/s | 54.2 steps/s
[Step=19050 Epoch=37.2] | Loss=0.01176 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.260 | L2-Norm(final)=2.877 | 3371.4 samples/s | 52.7 steps/s
[Step=19100 Epoch=37.3] | Loss=0.01147 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.260 | L2-Norm(final)=2.878 | 3460.9 samples/s | 54.1 steps/s
[Step=19150 Epoch=37.3] | Loss=0.01136 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.261 | L2-Norm(final)=2.879 | 3458.9 samples/s | 54.0 steps/s
[Step=19200 Epoch=37.4] | Loss=0.01116 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.261 | L2-Norm(final)=2.881 | 3452.2 samples/s | 53.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step19200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=36.0] | Loss=0.15295 | Reg=0.00335 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.303 | L2-Norm(final)=2.857 | 3720.3 samples/s | 58.1 steps/s
[Step=18450 Epoch=36.1] | Loss=0.01781 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.274 | L2-Norm(final)=2.858 | 3399.9 samples/s | 53.1 steps/s
[Step=18500 Epoch=36.2] | Loss=0.01431 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.267 | L2-Norm(final)=2.862 | 3459.9 samples/s | 54.1 steps/s
[Step=18550 Epoch=36.3] | Loss=0.01287 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.264 | L2-Norm(final)=2.866 | 3476.0 samples/s | 54.3 steps/s
[Step=18600 Epoch=36.4] | Loss=0.01190 | Reg=0.00334 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.262 | L2-Norm(final)=2.870 | 3481.8 samples/s | 54.4 steps/s
[Step=18650 Epoch=36.5] | Loss=0.01155 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.262 | L2-Norm(final)=2.873 | 3478.5 samples/s | 54.4 steps/s
[Step=18700 Epoch=36.6] | Loss=0.01159 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.261 | L2-Norm(final)=2.876 | 3464.8 samples/s | 54.1 steps/s
[Step=18750 Epoch=36.7] | Loss=0.01195 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.261 | L2-Norm(final)=2.878 | 3466.6 samples/s | 54.2 steps/s
[Step=18800 Epoch=36.8] | Loss=0.01206 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.261 | L2-Norm(final)=2.879 | 3470.3 samples/s | 54.2 steps/s
[Step=18850 Epoch=36.9] | Loss=0.01202 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.261 | L2-Norm(final)=2.880 | 3474.6 samples/s | 54.3 steps/s
[Step=18900 Epoch=36.9] | Loss=0.01163 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.261 | L2-Norm(final)=2.881 | 4021.9 samples/s | 62.8 steps/s
[Step=18950 Epoch=37.0] | Loss=0.01118 | Reg=0.00333 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.262 | L2-Norm(final)=2.883 | 1620.1 samples/s | 25.3 steps/s
[Step=19000 Epoch=37.1] | Loss=0.01088 | Reg=0.00333 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.262 | L2-Norm(final)=2.884 | 3448.0 samples/s | 53.9 steps/s
[Step=19050 Epoch=37.2] | Loss=0.01049 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.262 | L2-Norm(final)=2.886 | 3464.9 samples/s | 54.1 steps/s
[Step=19100 Epoch=37.3] | Loss=0.01041 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.262 | L2-Norm(final)=2.887 | 3467.4 samples/s | 54.2 steps/s
[Step=19150 Epoch=37.4] | Loss=0.01040 | Reg=0.00334 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.263 | L2-Norm(final)=2.889 | 3477.6 samples/s | 54.3 steps/s
[Step=19200 Epoch=37.5] | Loss=0.01027 | Reg=0.00334 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.263 | L2-Norm(final)=2.890 | 3470.8 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step19200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=70.5] | Loss=0.14582 | Reg=0.00335 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=18.303 | L2-Norm(final)=2.858 | 3781.3 samples/s | 59.1 steps/s
[Step=18450 Epoch=70.7] | Loss=0.00437 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.252 | L2-Norm(final)=2.862 | 3036.7 samples/s | 47.4 steps/s
[Step=18500 Epoch=70.9] | Loss=0.00238 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.246 | L2-Norm(final)=2.864 | 3293.7 samples/s | 51.5 steps/s
[Step=18550 Epoch=71.1] | Loss=0.00162 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.241 | L2-Norm(final)=2.866 | 3306.1 samples/s | 51.7 steps/s
[Step=18600 Epoch=71.3] | Loss=0.00124 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.237 | L2-Norm(final)=2.866 | 3314.9 samples/s | 51.8 steps/s
[Step=18650 Epoch=71.5] | Loss=0.00100 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.234 | L2-Norm(final)=2.867 | 3974.4 samples/s | 62.1 steps/s
[Step=18700 Epoch=71.7] | Loss=0.00084 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.231 | L2-Norm(final)=2.868 | 1552.3 samples/s | 24.3 steps/s
[Step=18750 Epoch=71.8] | Loss=0.00072 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.228 | L2-Norm(final)=2.868 | 3304.5 samples/s | 51.6 steps/s
[Step=18800 Epoch=72.0] | Loss=0.00064 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.226 | L2-Norm(final)=2.868 | 3292.6 samples/s | 51.4 steps/s
[Step=18850 Epoch=72.2] | Loss=0.00057 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.223 | L2-Norm(final)=2.868 | 3286.3 samples/s | 51.3 steps/s
[Step=18900 Epoch=72.4] | Loss=0.00051 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.221 | L2-Norm(final)=2.869 | 3589.1 samples/s | 56.1 steps/s
[Step=18950 Epoch=72.6] | Loss=0.00047 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.219 | L2-Norm(final)=2.869 | 1611.4 samples/s | 25.2 steps/s
[Step=19000 Epoch=72.8] | Loss=0.00043 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.217 | L2-Norm(final)=2.869 | 3298.3 samples/s | 51.5 steps/s
[Step=19050 Epoch=73.0] | Loss=0.00040 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.869 | 3305.7 samples/s | 51.7 steps/s
[Step=19100 Epoch=73.2] | Loss=0.00037 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.214 | L2-Norm(final)=2.869 | 3304.6 samples/s | 51.6 steps/s
[Step=19150 Epoch=73.4] | Loss=0.00035 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.869 | 3320.8 samples/s | 51.9 steps/s
[Step=19200 Epoch=73.6] | Loss=0.00033 | Reg=0.00332 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.211 | L2-Norm(final)=2.869 | 1669.0 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step19200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=70.8] | Loss=0.09978 | Reg=0.00335 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.303 | L2-Norm(final)=2.858 | 3580.1 samples/s | 55.9 steps/s
[Step=18450 Epoch=71.0] | Loss=0.00823 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.256 | L2-Norm(final)=2.856 | 3209.2 samples/s | 50.1 steps/s
[Step=18500 Epoch=71.2] | Loss=0.00416 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.249 | L2-Norm(final)=2.857 | 3304.3 samples/s | 51.6 steps/s
[Step=18550 Epoch=71.4] | Loss=0.00279 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.243 | L2-Norm(final)=2.857 | 3316.9 samples/s | 51.8 steps/s
[Step=18600 Epoch=71.6] | Loss=0.00212 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.239 | L2-Norm(final)=2.858 | 3325.0 samples/s | 52.0 steps/s
[Step=18650 Epoch=71.8] | Loss=0.00176 | Reg=0.00333 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.235 | L2-Norm(final)=2.858 | 4021.3 samples/s | 62.8 steps/s
[Step=18700 Epoch=72.0] | Loss=0.00147 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.232 | L2-Norm(final)=2.859 | 1552.4 samples/s | 24.3 steps/s
[Step=18750 Epoch=72.2] | Loss=0.00127 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.230 | L2-Norm(final)=2.859 | 3249.3 samples/s | 50.8 steps/s
[Step=18800 Epoch=72.4] | Loss=0.00111 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.227 | L2-Norm(final)=2.860 | 3325.4 samples/s | 52.0 steps/s
[Step=18850 Epoch=72.6] | Loss=0.00099 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.225 | L2-Norm(final)=2.860 | 3324.7 samples/s | 51.9 steps/s
[Step=18900 Epoch=72.8] | Loss=0.00089 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.223 | L2-Norm(final)=2.861 | 3675.8 samples/s | 57.4 steps/s
[Step=18950 Epoch=72.9] | Loss=0.00081 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.221 | L2-Norm(final)=2.861 | 1624.7 samples/s | 25.4 steps/s
[Step=19000 Epoch=73.1] | Loss=0.00075 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.219 | L2-Norm(final)=2.861 | 3297.4 samples/s | 51.5 steps/s
[Step=19050 Epoch=73.3] | Loss=0.00069 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.217 | L2-Norm(final)=2.861 | 3333.9 samples/s | 52.1 steps/s
[Step=19100 Epoch=73.5] | Loss=0.00064 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=2.862 | 3308.3 samples/s | 51.7 steps/s
[Step=19150 Epoch=73.7] | Loss=0.00060 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.214 | L2-Norm(final)=2.862 | 3331.6 samples/s | 52.1 steps/s
[Step=19200 Epoch=73.9] | Loss=0.00057 | Reg=0.00332 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=2.862 | 1670.1 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19832 | acc=0.8733 | tpr=0.8253 | fpr=0.0225 | 3606.4 samples/s | 14.1 steps/s
Avg test loss: 0.20009, Avg test acc: 0.87062, Avg tpr: 0.82264, Avg fpr: 0.02384, total FA: 186

Testing server on iccad2012
[Step=  50] | Loss=0.40456 | acc=0.8324 | tpr=0.9823 | fpr=0.1703 | 3626.3 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.41034 | acc=0.8333 | tpr=0.9851 | fpr=0.1695 | 7101.5 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.41334 | acc=0.8322 | tpr=0.9856 | fpr=0.1706 | 6591.6 samples/s | 25.7 steps/s
[Step= 200] | Loss=0.41366 | acc=0.8336 | tpr=0.9847 | fpr=0.1692 | 6881.2 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.41382 | acc=0.8326 | tpr=0.9825 | fpr=0.1701 | 6788.2 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.41521 | acc=0.8325 | tpr=0.9825 | fpr=0.1703 | 6724.8 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.41778 | acc=0.8318 | tpr=0.9812 | fpr=0.1709 | 6974.8 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.41920 | acc=0.8314 | tpr=0.9787 | fpr=0.1713 | 6690.2 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.42135 | acc=0.8314 | tpr=0.9800 | fpr=0.1713 | 6721.3 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.42139 | acc=0.8310 | tpr=0.9797 | fpr=0.1716 | 6801.5 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.41885 | acc=0.8317 | tpr=0.9801 | fpr=0.1710 | 12680.7 samples/s | 49.5 steps/s
Avg test loss: 0.41844, Avg test acc: 0.83173, Avg tpr: 0.97979, Avg fpr: 0.17096, total FA: 23737

server round 24/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=37.4] | Loss=0.08546 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.217 | L2-Norm(final)=2.886 | 3437.5 samples/s | 53.7 steps/s
[Step=19250 Epoch=37.5] | Loss=0.01618 | Reg=0.00331 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.188 | L2-Norm(final)=2.889 | 3393.3 samples/s | 53.0 steps/s
[Step=19300 Epoch=37.6] | Loss=0.01377 | Reg=0.00331 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.183 | L2-Norm(final)=2.893 | 3457.0 samples/s | 54.0 steps/s
[Step=19350 Epoch=37.7] | Loss=0.01227 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.179 | L2-Norm(final)=2.895 | 3432.5 samples/s | 53.6 steps/s
[Step=19400 Epoch=37.8] | Loss=0.01105 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=2.899 | 3451.6 samples/s | 53.9 steps/s
[Step=19450 Epoch=37.9] | Loss=0.01110 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.177 | L2-Norm(final)=2.902 | 3465.1 samples/s | 54.1 steps/s
[Step=19500 Epoch=38.0] | Loss=0.01127 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.176 | L2-Norm(final)=2.904 | 3484.1 samples/s | 54.4 steps/s
[Step=19550 Epoch=38.1] | Loss=0.01169 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.176 | L2-Norm(final)=2.905 | 3468.0 samples/s | 54.2 steps/s
[Step=19600 Epoch=38.2] | Loss=0.01147 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.175 | L2-Norm(final)=2.906 | 3473.4 samples/s | 54.3 steps/s
[Step=19650 Epoch=38.3] | Loss=0.01150 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=2.907 | 3475.4 samples/s | 54.3 steps/s
[Step=19700 Epoch=38.4] | Loss=0.01153 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=2.908 | 4029.6 samples/s | 63.0 steps/s
[Step=19750 Epoch=38.5] | Loss=0.01157 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=2.909 | 1569.5 samples/s | 24.5 steps/s
[Step=19800 Epoch=38.6] | Loss=0.01129 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=2.910 | 3449.9 samples/s | 53.9 steps/s
[Step=19850 Epoch=38.7] | Loss=0.01101 | Reg=0.00330 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=2.911 | 3462.3 samples/s | 54.1 steps/s
[Step=19900 Epoch=38.8] | Loss=0.01084 | Reg=0.00330 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.176 | L2-Norm(final)=2.912 | 3481.0 samples/s | 54.4 steps/s
[Step=19950 Epoch=38.9] | Loss=0.01072 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.176 | L2-Norm(final)=2.914 | 3477.6 samples/s | 54.3 steps/s
[Step=20000 Epoch=39.0] | Loss=0.01075 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.176 | L2-Norm(final)=2.915 | 3473.8 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=37.5] | Loss=0.12262 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.217 | L2-Norm(final)=2.886 | 3659.3 samples/s | 57.2 steps/s
[Step=19250 Epoch=37.6] | Loss=0.02171 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.197 | L2-Norm(final)=2.884 | 2858.5 samples/s | 44.7 steps/s
[Step=19300 Epoch=37.7] | Loss=0.01584 | Reg=0.00331 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.192 | L2-Norm(final)=2.887 | 3107.7 samples/s | 48.6 steps/s
[Step=19350 Epoch=37.8] | Loss=0.01441 | Reg=0.00331 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.188 | L2-Norm(final)=2.889 | 3144.3 samples/s | 49.1 steps/s
[Step=19400 Epoch=37.9] | Loss=0.01437 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.185 | L2-Norm(final)=2.891 | 3215.5 samples/s | 50.2 steps/s
[Step=19450 Epoch=38.0] | Loss=0.01334 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.184 | L2-Norm(final)=2.892 | 3158.8 samples/s | 49.4 steps/s
[Step=19500 Epoch=38.1] | Loss=0.01336 | Reg=0.00331 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.183 | L2-Norm(final)=2.894 | 3477.7 samples/s | 54.3 steps/s
[Step=19550 Epoch=38.2] | Loss=0.01284 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.183 | L2-Norm(final)=2.895 | 3412.2 samples/s | 53.3 steps/s
[Step=19600 Epoch=38.3] | Loss=0.01262 | Reg=0.00331 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.182 | L2-Norm(final)=2.897 | 3369.4 samples/s | 52.6 steps/s
[Step=19650 Epoch=38.4] | Loss=0.01242 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.182 | L2-Norm(final)=2.899 | 3408.4 samples/s | 53.3 steps/s
[Step=19700 Epoch=38.5] | Loss=0.01215 | Reg=0.00331 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.182 | L2-Norm(final)=2.901 | 3948.2 samples/s | 61.7 steps/s
[Step=19750 Epoch=38.6] | Loss=0.01166 | Reg=0.00331 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.182 | L2-Norm(final)=2.903 | 1571.3 samples/s | 24.6 steps/s
[Step=19800 Epoch=38.7] | Loss=0.01125 | Reg=0.00331 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.182 | L2-Norm(final)=2.905 | 3439.1 samples/s | 53.7 steps/s
[Step=19850 Epoch=38.8] | Loss=0.01121 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.183 | L2-Norm(final)=2.907 | 3540.9 samples/s | 55.3 steps/s
[Step=19900 Epoch=38.9] | Loss=0.01083 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.183 | L2-Norm(final)=2.909 | 3446.2 samples/s | 53.8 steps/s
[Step=19950 Epoch=39.0] | Loss=0.01082 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.184 | L2-Norm(final)=2.910 | 3479.7 samples/s | 54.4 steps/s
[Step=20000 Epoch=39.1] | Loss=0.01064 | Reg=0.00331 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.184 | L2-Norm(final)=2.912 | 3462.8 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step20000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=73.6] | Loss=0.06932 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.217 | L2-Norm(final)=2.886 | 3432.2 samples/s | 53.6 steps/s
[Step=19250 Epoch=73.8] | Loss=0.00654 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.173 | L2-Norm(final)=2.887 | 3263.0 samples/s | 51.0 steps/s
[Step=19300 Epoch=74.0] | Loss=0.00334 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.167 | L2-Norm(final)=2.887 | 3299.4 samples/s | 51.6 steps/s
[Step=19350 Epoch=74.1] | Loss=0.00229 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.163 | L2-Norm(final)=2.887 | 3318.5 samples/s | 51.9 steps/s
[Step=19400 Epoch=74.3] | Loss=0.00174 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.159 | L2-Norm(final)=2.888 | 3248.1 samples/s | 50.8 steps/s
[Step=19450 Epoch=74.5] | Loss=0.00141 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.155 | L2-Norm(final)=2.888 | 3881.6 samples/s | 60.7 steps/s
[Step=19500 Epoch=74.7] | Loss=0.00118 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.152 | L2-Norm(final)=2.889 | 1539.0 samples/s | 24.0 steps/s
[Step=19550 Epoch=74.9] | Loss=0.00101 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.150 | L2-Norm(final)=2.889 | 3319.9 samples/s | 51.9 steps/s
[Step=19600 Epoch=75.1] | Loss=0.00089 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.147 | L2-Norm(final)=2.890 | 3306.1 samples/s | 51.7 steps/s
[Step=19650 Epoch=75.3] | Loss=0.00079 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.145 | L2-Norm(final)=2.890 | 3313.7 samples/s | 51.8 steps/s
[Step=19700 Epoch=75.5] | Loss=0.00072 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.143 | L2-Norm(final)=2.890 | 3528.5 samples/s | 55.1 steps/s
[Step=19750 Epoch=75.7] | Loss=0.00065 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.140 | L2-Norm(final)=2.891 | 1579.1 samples/s | 24.7 steps/s
[Step=19800 Epoch=75.9] | Loss=0.00060 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.139 | L2-Norm(final)=2.891 | 3292.2 samples/s | 51.4 steps/s
[Step=19850 Epoch=76.1] | Loss=0.00056 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.137 | L2-Norm(final)=2.891 | 3261.4 samples/s | 51.0 steps/s
[Step=19900 Epoch=76.2] | Loss=0.00052 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.135 | L2-Norm(final)=2.891 | 2920.8 samples/s | 45.6 steps/s
[Step=19950 Epoch=76.4] | Loss=0.00048 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.133 | L2-Norm(final)=2.892 | 3118.2 samples/s | 48.7 steps/s
[Step=20000 Epoch=76.6] | Loss=0.00045 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.131 | L2-Norm(final)=2.892 | 1636.8 samples/s | 25.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step20000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=73.9] | Loss=0.03808 | Reg=0.00332 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.217 | L2-Norm(final)=2.886 | 3775.9 samples/s | 59.0 steps/s
[Step=19250 Epoch=74.1] | Loss=0.00503 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=2.890 | 3056.7 samples/s | 47.8 steps/s
[Step=19300 Epoch=74.3] | Loss=0.00270 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.171 | L2-Norm(final)=2.891 | 3307.8 samples/s | 51.7 steps/s
[Step=19350 Epoch=74.5] | Loss=0.00185 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.167 | L2-Norm(final)=2.893 | 3311.1 samples/s | 51.7 steps/s
[Step=19400 Epoch=74.7] | Loss=0.00140 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.163 | L2-Norm(final)=2.894 | 3317.7 samples/s | 51.8 steps/s
[Step=19450 Epoch=74.9] | Loss=0.00113 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.159 | L2-Norm(final)=2.895 | 3999.2 samples/s | 62.5 steps/s
[Step=19500 Epoch=75.1] | Loss=0.00095 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.156 | L2-Norm(final)=2.895 | 1540.8 samples/s | 24.1 steps/s
[Step=19550 Epoch=75.3] | Loss=0.00082 | Reg=0.00330 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.153 | L2-Norm(final)=2.896 | 3310.8 samples/s | 51.7 steps/s
[Step=19600 Epoch=75.4] | Loss=0.00072 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.150 | L2-Norm(final)=2.896 | 3300.3 samples/s | 51.6 steps/s
[Step=19650 Epoch=75.6] | Loss=0.00064 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.147 | L2-Norm(final)=2.896 | 3303.3 samples/s | 51.6 steps/s
[Step=19700 Epoch=75.8] | Loss=0.00058 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.145 | L2-Norm(final)=2.896 | 3652.1 samples/s | 57.1 steps/s
[Step=19750 Epoch=76.0] | Loss=0.00053 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.143 | L2-Norm(final)=2.897 | 1602.6 samples/s | 25.0 steps/s
[Step=19800 Epoch=76.2] | Loss=0.00049 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.141 | L2-Norm(final)=2.897 | 3347.6 samples/s | 52.3 steps/s
[Step=19850 Epoch=76.4] | Loss=0.00045 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.139 | L2-Norm(final)=2.897 | 3300.0 samples/s | 51.6 steps/s
[Step=19900 Epoch=76.6] | Loss=0.00042 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.137 | L2-Norm(final)=2.897 | 3321.9 samples/s | 51.9 steps/s
[Step=19950 Epoch=76.8] | Loss=0.00039 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.135 | L2-Norm(final)=2.897 | 3379.5 samples/s | 52.8 steps/s
[Step=20000 Epoch=77.0] | Loss=0.00037 | Reg=0.00329 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.133 | L2-Norm(final)=2.897 | 1656.9 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17249 | acc=0.8881 | tpr=0.8486 | fpr=0.0260 | 3639.2 samples/s | 14.2 steps/s
Avg test loss: 0.17475, Avg test acc: 0.88573, Avg tpr: 0.84700, Avg fpr: 0.02910, total FA: 227

Testing server on iccad2012
[Step=  50] | Loss=0.46517 | acc=0.8152 | tpr=0.9823 | fpr=0.1878 | 3661.6 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.47023 | acc=0.8152 | tpr=0.9872 | fpr=0.1880 | 6838.9 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.47341 | acc=0.8145 | tpr=0.9899 | fpr=0.1888 | 7027.6 samples/s | 27.5 steps/s
[Step= 200] | Loss=0.47320 | acc=0.8154 | tpr=0.9902 | fpr=0.1878 | 6703.1 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.47366 | acc=0.8141 | tpr=0.9860 | fpr=0.1891 | 6802.4 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.47472 | acc=0.8140 | tpr=0.9862 | fpr=0.1891 | 7000.3 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.47714 | acc=0.8134 | tpr=0.9843 | fpr=0.1897 | 6889.5 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.47875 | acc=0.8128 | tpr=0.9814 | fpr=0.1902 | 6770.2 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.48157 | acc=0.8128 | tpr=0.9825 | fpr=0.1903 | 6898.0 samples/s | 26.9 steps/s
[Step= 500] | Loss=0.48191 | acc=0.8123 | tpr=0.9824 | fpr=0.1908 | 6721.2 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.47899 | acc=0.8129 | tpr=0.9825 | fpr=0.1902 | 12639.9 samples/s | 49.4 steps/s
Avg test loss: 0.47855, Avg test acc: 0.81298, Avg tpr: 0.98217, Avg fpr: 0.19009, total FA: 26394

server round 25/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=39.0] | Loss=0.12493 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.134 | L2-Norm(final)=2.914 | 3357.8 samples/s | 52.5 steps/s
[Step=20050 Epoch=39.1] | Loss=0.01858 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.112 | L2-Norm(final)=2.912 | 3433.5 samples/s | 53.6 steps/s
[Step=20100 Epoch=39.2] | Loss=0.01480 | Reg=0.00328 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.107 | L2-Norm(final)=2.915 | 3478.5 samples/s | 54.4 steps/s
[Step=20150 Epoch=39.3] | Loss=0.01274 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.103 | L2-Norm(final)=2.917 | 3491.7 samples/s | 54.6 steps/s
[Step=20200 Epoch=39.4] | Loss=0.01188 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.101 | L2-Norm(final)=2.920 | 3477.9 samples/s | 54.3 steps/s
[Step=20250 Epoch=39.5] | Loss=0.01237 | Reg=0.00328 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.101 | L2-Norm(final)=2.923 | 3498.3 samples/s | 54.7 steps/s
[Step=20300 Epoch=39.6] | Loss=0.01236 | Reg=0.00328 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.100 | L2-Norm(final)=2.924 | 3508.0 samples/s | 54.8 steps/s
[Step=20350 Epoch=39.7] | Loss=0.01183 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.099 | L2-Norm(final)=2.925 | 3511.8 samples/s | 54.9 steps/s
[Step=20400 Epoch=39.8] | Loss=0.01179 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.099 | L2-Norm(final)=2.926 | 3488.8 samples/s | 54.5 steps/s
[Step=20450 Epoch=39.9] | Loss=0.01188 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.098 | L2-Norm(final)=2.928 | 3486.6 samples/s | 54.5 steps/s
[Step=20500 Epoch=40.0] | Loss=0.01179 | Reg=0.00328 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.098 | L2-Norm(final)=2.929 | 4076.5 samples/s | 63.7 steps/s
[Step=20550 Epoch=40.1] | Loss=0.01169 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.098 | L2-Norm(final)=2.930 | 1563.2 samples/s | 24.4 steps/s
[Step=20600 Epoch=40.2] | Loss=0.01160 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.099 | L2-Norm(final)=2.931 | 3453.0 samples/s | 54.0 steps/s
[Step=20650 Epoch=40.3] | Loss=0.01143 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.099 | L2-Norm(final)=2.932 | 3492.3 samples/s | 54.6 steps/s
[Step=20700 Epoch=40.4] | Loss=0.01146 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.099 | L2-Norm(final)=2.933 | 3473.8 samples/s | 54.3 steps/s
[Step=20750 Epoch=40.5] | Loss=0.01137 | Reg=0.00328 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.099 | L2-Norm(final)=2.934 | 3493.0 samples/s | 54.6 steps/s
[Step=20800 Epoch=40.6] | Loss=0.01116 | Reg=0.00328 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.099 | L2-Norm(final)=2.934 | 3492.1 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step20800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=39.1] | Loss=0.05519 | Reg=0.00329 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.134 | L2-Norm(final)=2.915 | 3591.3 samples/s | 56.1 steps/s
[Step=20050 Epoch=39.2] | Loss=0.01950 | Reg=0.00328 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.106 | L2-Norm(final)=2.911 | 3479.0 samples/s | 54.4 steps/s
[Step=20100 Epoch=39.3] | Loss=0.01516 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.100 | L2-Norm(final)=2.913 | 3479.9 samples/s | 54.4 steps/s
[Step=20150 Epoch=39.4] | Loss=0.01289 | Reg=0.00328 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.097 | L2-Norm(final)=2.916 | 3487.6 samples/s | 54.5 steps/s
[Step=20200 Epoch=39.5] | Loss=0.01165 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.096 | L2-Norm(final)=2.920 | 3470.0 samples/s | 54.2 steps/s
[Step=20250 Epoch=39.6] | Loss=0.01125 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.095 | L2-Norm(final)=2.923 | 3438.7 samples/s | 53.7 steps/s
[Step=20300 Epoch=39.7] | Loss=0.01115 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.095 | L2-Norm(final)=2.926 | 3484.8 samples/s | 54.5 steps/s
[Step=20350 Epoch=39.8] | Loss=0.01102 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.094 | L2-Norm(final)=2.928 | 3490.9 samples/s | 54.5 steps/s
[Step=20400 Epoch=39.9] | Loss=0.01107 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.094 | L2-Norm(final)=2.930 | 3497.3 samples/s | 54.6 steps/s
[Step=20450 Epoch=40.0] | Loss=0.01159 | Reg=0.00327 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=18.094 | L2-Norm(final)=2.931 | 3482.3 samples/s | 54.4 steps/s
[Step=20500 Epoch=40.1] | Loss=0.01147 | Reg=0.00327 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.095 | L2-Norm(final)=2.932 | 4077.0 samples/s | 63.7 steps/s
[Step=20550 Epoch=40.2] | Loss=0.01140 | Reg=0.00327 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.095 | L2-Norm(final)=2.933 | 1623.9 samples/s | 25.4 steps/s
[Step=20600 Epoch=40.3] | Loss=0.01138 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.095 | L2-Norm(final)=2.935 | 3466.7 samples/s | 54.2 steps/s
[Step=20650 Epoch=40.4] | Loss=0.01104 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.096 | L2-Norm(final)=2.936 | 3463.6 samples/s | 54.1 steps/s
[Step=20700 Epoch=40.5] | Loss=0.01108 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.096 | L2-Norm(final)=2.936 | 3488.9 samples/s | 54.5 steps/s
[Step=20750 Epoch=40.6] | Loss=0.01091 | Reg=0.00327 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.096 | L2-Norm(final)=2.937 | 3466.6 samples/s | 54.2 steps/s
[Step=20800 Epoch=40.7] | Loss=0.01072 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.097 | L2-Norm(final)=2.938 | 3486.3 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step20800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=76.6] | Loss=0.18243 | Reg=0.00329 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=18.134 | L2-Norm(final)=2.914 | 3909.9 samples/s | 61.1 steps/s
[Step=20050 Epoch=76.8] | Loss=0.00890 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.089 | L2-Norm(final)=2.910 | 3015.0 samples/s | 47.1 steps/s
[Step=20100 Epoch=77.0] | Loss=0.00458 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.084 | L2-Norm(final)=2.909 | 3317.8 samples/s | 51.8 steps/s
[Step=20150 Epoch=77.2] | Loss=0.00308 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.079 | L2-Norm(final)=2.909 | 3311.7 samples/s | 51.7 steps/s
[Step=20200 Epoch=77.4] | Loss=0.00238 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.076 | L2-Norm(final)=2.910 | 3314.0 samples/s | 51.8 steps/s
[Step=20250 Epoch=77.6] | Loss=0.00191 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.072 | L2-Norm(final)=2.910 | 3953.5 samples/s | 61.8 steps/s
[Step=20300 Epoch=77.8] | Loss=0.00160 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.070 | L2-Norm(final)=2.911 | 1564.5 samples/s | 24.4 steps/s
[Step=20350 Epoch=78.0] | Loss=0.00137 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.067 | L2-Norm(final)=2.911 | 3308.1 samples/s | 51.7 steps/s
[Step=20400 Epoch=78.2] | Loss=0.00121 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.065 | L2-Norm(final)=2.912 | 3316.3 samples/s | 51.8 steps/s
[Step=20450 Epoch=78.4] | Loss=0.00107 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.063 | L2-Norm(final)=2.912 | 3307.0 samples/s | 51.7 steps/s
[Step=20500 Epoch=78.5] | Loss=0.00097 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.061 | L2-Norm(final)=2.913 | 3590.8 samples/s | 56.1 steps/s
[Step=20550 Epoch=78.7] | Loss=0.00088 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.059 | L2-Norm(final)=2.913 | 1599.4 samples/s | 25.0 steps/s
[Step=20600 Epoch=78.9] | Loss=0.00081 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.057 | L2-Norm(final)=2.914 | 3325.2 samples/s | 52.0 steps/s
[Step=20650 Epoch=79.1] | Loss=0.00075 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.055 | L2-Norm(final)=2.914 | 3264.4 samples/s | 51.0 steps/s
[Step=20700 Epoch=79.3] | Loss=0.00070 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.053 | L2-Norm(final)=2.914 | 3332.7 samples/s | 52.1 steps/s
[Step=20750 Epoch=79.5] | Loss=0.00065 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.052 | L2-Norm(final)=2.915 | 3310.1 samples/s | 51.7 steps/s
[Step=20800 Epoch=79.7] | Loss=0.00061 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.050 | L2-Norm(final)=2.915 | 1688.4 samples/s | 26.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step20800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=77.0] | Loss=0.01398 | Reg=0.00329 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=18.134 | L2-Norm(final)=2.915 | 3614.6 samples/s | 56.5 steps/s
[Step=20050 Epoch=77.2] | Loss=0.00385 | Reg=0.00327 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.093 | L2-Norm(final)=2.923 | 3231.1 samples/s | 50.5 steps/s
[Step=20100 Epoch=77.4] | Loss=0.00204 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.089 | L2-Norm(final)=2.924 | 3316.9 samples/s | 51.8 steps/s
[Step=20150 Epoch=77.6] | Loss=0.00138 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.084 | L2-Norm(final)=2.925 | 3325.2 samples/s | 52.0 steps/s
[Step=20200 Epoch=77.8] | Loss=0.00104 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.080 | L2-Norm(final)=2.926 | 3315.5 samples/s | 51.8 steps/s
[Step=20250 Epoch=78.0] | Loss=0.00084 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.076 | L2-Norm(final)=2.926 | 4023.0 samples/s | 62.9 steps/s
[Step=20300 Epoch=78.1] | Loss=0.00071 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.073 | L2-Norm(final)=2.926 | 1532.9 samples/s | 24.0 steps/s
[Step=20350 Epoch=78.3] | Loss=0.00061 | Reg=0.00327 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.070 | L2-Norm(final)=2.927 | 3314.9 samples/s | 51.8 steps/s
[Step=20400 Epoch=78.5] | Loss=0.00053 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.067 | L2-Norm(final)=2.927 | 3316.4 samples/s | 51.8 steps/s
[Step=20450 Epoch=78.7] | Loss=0.00048 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.065 | L2-Norm(final)=2.927 | 3340.9 samples/s | 52.2 steps/s
[Step=20500 Epoch=78.9] | Loss=0.00043 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.062 | L2-Norm(final)=2.927 | 3666.3 samples/s | 57.3 steps/s
[Step=20550 Epoch=79.1] | Loss=0.00039 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.060 | L2-Norm(final)=2.927 | 1573.4 samples/s | 24.6 steps/s
[Step=20600 Epoch=79.3] | Loss=0.00036 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.058 | L2-Norm(final)=2.927 | 3299.6 samples/s | 51.6 steps/s
[Step=20650 Epoch=79.5] | Loss=0.00034 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.056 | L2-Norm(final)=2.927 | 3312.6 samples/s | 51.8 steps/s
[Step=20700 Epoch=79.7] | Loss=0.00031 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.054 | L2-Norm(final)=2.927 | 3318.8 samples/s | 51.9 steps/s
[Step=20750 Epoch=79.9] | Loss=0.00029 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.052 | L2-Norm(final)=2.927 | 3353.2 samples/s | 52.4 steps/s
[Step=20800 Epoch=80.1] | Loss=0.00028 | Reg=0.00326 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.050 | L2-Norm(final)=2.928 | 1658.8 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20458 | acc=0.8720 | tpr=0.8244 | fpr=0.0245 | 3664.8 samples/s | 14.3 steps/s
Avg test loss: 0.20776, Avg test acc: 0.86846, Avg tpr: 0.82031, Avg fpr: 0.02564, total FA: 200

Testing server on iccad2012
[Step=  50] | Loss=0.40466 | acc=0.8380 | tpr=0.9823 | fpr=0.1646 | 3693.0 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.41064 | acc=0.8387 | tpr=0.9851 | fpr=0.1641 | 6903.4 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.41355 | acc=0.8382 | tpr=0.9870 | fpr=0.1645 | 6751.2 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.41340 | acc=0.8397 | tpr=0.9858 | fpr=0.1629 | 7034.4 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.41329 | acc=0.8387 | tpr=0.9825 | fpr=0.1639 | 6531.5 samples/s | 25.5 steps/s
[Step= 300] | Loss=0.41440 | acc=0.8386 | tpr=0.9825 | fpr=0.1640 | 6860.9 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.41680 | acc=0.8381 | tpr=0.9812 | fpr=0.1645 | 6896.4 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.41828 | acc=0.8375 | tpr=0.9787 | fpr=0.1650 | 6854.9 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.42095 | acc=0.8373 | tpr=0.9800 | fpr=0.1653 | 6551.8 samples/s | 25.6 steps/s
[Step= 500] | Loss=0.42091 | acc=0.8367 | tpr=0.9802 | fpr=0.1658 | 6824.2 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.41821 | acc=0.8376 | tpr=0.9809 | fpr=0.1650 | 12889.3 samples/s | 50.3 steps/s
Avg test loss: 0.41783, Avg test acc: 0.83766, Avg tpr: 0.98059, Avg fpr: 0.16494, total FA: 22902

server round 26/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=40.6] | Loss=0.10423 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=18.052 | L2-Norm(final)=2.936 | 3686.4 samples/s | 57.6 steps/s
[Step=20850 Epoch=40.7] | Loss=0.02121 | Reg=0.00325 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=18.024 | L2-Norm(final)=2.932 | 3205.6 samples/s | 50.1 steps/s
[Step=20900 Epoch=40.8] | Loss=0.01490 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=2.935 | 3489.9 samples/s | 54.5 steps/s
[Step=20950 Epoch=40.9] | Loss=0.01408 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.015 | L2-Norm(final)=2.937 | 3495.8 samples/s | 54.6 steps/s
[Step=21000 Epoch=41.0] | Loss=0.01389 | Reg=0.00324 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.014 | L2-Norm(final)=2.939 | 3468.5 samples/s | 54.2 steps/s
[Step=21050 Epoch=41.1] | Loss=0.01289 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.013 | L2-Norm(final)=2.940 | 3482.9 samples/s | 54.4 steps/s
[Step=21100 Epoch=41.2] | Loss=0.01279 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=2.941 | 3482.3 samples/s | 54.4 steps/s
[Step=21150 Epoch=41.3] | Loss=0.01228 | Reg=0.00324 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.012 | L2-Norm(final)=2.943 | 3511.7 samples/s | 54.9 steps/s
[Step=21200 Epoch=41.3] | Loss=0.01204 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.011 | L2-Norm(final)=2.944 | 3498.4 samples/s | 54.7 steps/s
[Step=21250 Epoch=41.4] | Loss=0.01178 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=2.946 | 3512.1 samples/s | 54.9 steps/s
[Step=21300 Epoch=41.5] | Loss=0.01152 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=2.948 | 4078.4 samples/s | 63.7 steps/s
[Step=21350 Epoch=41.6] | Loss=0.01113 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=2.949 | 1544.7 samples/s | 24.1 steps/s
[Step=21400 Epoch=41.7] | Loss=0.01077 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.013 | L2-Norm(final)=2.951 | 3485.7 samples/s | 54.5 steps/s
[Step=21450 Epoch=41.8] | Loss=0.01055 | Reg=0.00324 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.013 | L2-Norm(final)=2.953 | 3475.3 samples/s | 54.3 steps/s
[Step=21500 Epoch=41.9] | Loss=0.01059 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.014 | L2-Norm(final)=2.955 | 3474.9 samples/s | 54.3 steps/s
[Step=21550 Epoch=42.0] | Loss=0.01047 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.014 | L2-Norm(final)=2.957 | 3470.2 samples/s | 54.2 steps/s
[Step=21600 Epoch=42.1] | Loss=0.01041 | Reg=0.00325 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.014 | L2-Norm(final)=2.958 | 3481.0 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step21600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=40.7] | Loss=0.09684 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=18.052 | L2-Norm(final)=2.936 | 3805.3 samples/s | 59.5 steps/s
[Step=20850 Epoch=40.8] | Loss=0.02227 | Reg=0.00325 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.030 | L2-Norm(final)=2.929 | 3260.4 samples/s | 50.9 steps/s
[Step=20900 Epoch=40.9] | Loss=0.01505 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.025 | L2-Norm(final)=2.932 | 3477.4 samples/s | 54.3 steps/s
[Step=20950 Epoch=41.0] | Loss=0.01333 | Reg=0.00325 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.022 | L2-Norm(final)=2.936 | 3473.4 samples/s | 54.3 steps/s
[Step=21000 Epoch=41.1] | Loss=0.01299 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.021 | L2-Norm(final)=2.939 | 3476.7 samples/s | 54.3 steps/s
[Step=21050 Epoch=41.2] | Loss=0.01173 | Reg=0.00325 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.019 | L2-Norm(final)=2.941 | 3466.3 samples/s | 54.2 steps/s
[Step=21100 Epoch=41.2] | Loss=0.01145 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=2.943 | 3486.2 samples/s | 54.5 steps/s
[Step=21150 Epoch=41.3] | Loss=0.01153 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=2.946 | 3498.6 samples/s | 54.7 steps/s
[Step=21200 Epoch=41.4] | Loss=0.01117 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=2.948 | 3496.4 samples/s | 54.6 steps/s
[Step=21250 Epoch=41.5] | Loss=0.01124 | Reg=0.00325 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=18.018 | L2-Norm(final)=2.950 | 3487.2 samples/s | 54.5 steps/s
[Step=21300 Epoch=41.6] | Loss=0.01117 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=2.951 | 4088.2 samples/s | 63.9 steps/s
[Step=21350 Epoch=41.7] | Loss=0.01093 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=2.953 | 1606.5 samples/s | 25.1 steps/s
[Step=21400 Epoch=41.8] | Loss=0.01053 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.019 | L2-Norm(final)=2.955 | 3462.3 samples/s | 54.1 steps/s
[Step=21450 Epoch=41.9] | Loss=0.01022 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.019 | L2-Norm(final)=2.957 | 3483.9 samples/s | 54.4 steps/s
[Step=21500 Epoch=42.0] | Loss=0.01030 | Reg=0.00325 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=18.020 | L2-Norm(final)=2.959 | 3457.9 samples/s | 54.0 steps/s
[Step=21550 Epoch=42.1] | Loss=0.01024 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.020 | L2-Norm(final)=2.960 | 3471.0 samples/s | 54.2 steps/s
[Step=21600 Epoch=42.2] | Loss=0.01019 | Reg=0.00325 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.020 | L2-Norm(final)=2.961 | 3482.3 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step21600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=79.7] | Loss=0.12895 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=18.052 | L2-Norm(final)=2.936 | 3628.5 samples/s | 56.7 steps/s
[Step=20850 Epoch=79.9] | Loss=0.00538 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.006 | L2-Norm(final)=2.940 | 3159.3 samples/s | 49.4 steps/s
[Step=20900 Epoch=80.1] | Loss=0.00283 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.002 | L2-Norm(final)=2.941 | 3272.0 samples/s | 51.1 steps/s
[Step=20950 Epoch=80.3] | Loss=0.00199 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.998 | L2-Norm(final)=2.942 | 3313.5 samples/s | 51.8 steps/s
[Step=21000 Epoch=80.5] | Loss=0.00150 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.994 | L2-Norm(final)=2.943 | 3329.7 samples/s | 52.0 steps/s
[Step=21050 Epoch=80.7] | Loss=0.00121 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.991 | L2-Norm(final)=2.943 | 3972.7 samples/s | 62.1 steps/s
[Step=21100 Epoch=80.8] | Loss=0.00101 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.988 | L2-Norm(final)=2.943 | 1555.6 samples/s | 24.3 steps/s
[Step=21150 Epoch=81.0] | Loss=0.00087 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.985 | L2-Norm(final)=2.944 | 3310.5 samples/s | 51.7 steps/s
[Step=21200 Epoch=81.2] | Loss=0.00076 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.982 | L2-Norm(final)=2.944 | 3319.2 samples/s | 51.9 steps/s
[Step=21250 Epoch=81.4] | Loss=0.00068 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.980 | L2-Norm(final)=2.944 | 3297.5 samples/s | 51.5 steps/s
[Step=21300 Epoch=81.6] | Loss=0.00061 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.977 | L2-Norm(final)=2.944 | 3558.6 samples/s | 55.6 steps/s
[Step=21350 Epoch=81.8] | Loss=0.00056 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.975 | L2-Norm(final)=2.944 | 1611.8 samples/s | 25.2 steps/s
[Step=21400 Epoch=82.0] | Loss=0.00051 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.973 | L2-Norm(final)=2.944 | 3323.2 samples/s | 51.9 steps/s
[Step=21450 Epoch=82.2] | Loss=0.00048 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.971 | L2-Norm(final)=2.945 | 3331.4 samples/s | 52.1 steps/s
[Step=21500 Epoch=82.4] | Loss=0.00044 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.970 | L2-Norm(final)=2.945 | 3326.4 samples/s | 52.0 steps/s
[Step=21550 Epoch=82.6] | Loss=0.00042 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.968 | L2-Norm(final)=2.945 | 3328.0 samples/s | 52.0 steps/s
[Step=21600 Epoch=82.8] | Loss=0.00039 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.966 | L2-Norm(final)=2.945 | 1673.7 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step21600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=80.1] | Loss=0.07417 | Reg=0.00326 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=18.052 | L2-Norm(final)=2.936 | 3478.9 samples/s | 54.4 steps/s
[Step=20850 Epoch=80.3] | Loss=0.00513 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.011 | L2-Norm(final)=2.935 | 3321.1 samples/s | 51.9 steps/s
[Step=20900 Epoch=80.5] | Loss=0.00300 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.009 | L2-Norm(final)=2.936 | 3339.4 samples/s | 52.2 steps/s
[Step=20950 Epoch=80.6] | Loss=0.00201 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.005 | L2-Norm(final)=2.937 | 3330.9 samples/s | 52.0 steps/s
[Step=21000 Epoch=80.8] | Loss=0.00151 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=18.001 | L2-Norm(final)=2.938 | 3329.1 samples/s | 52.0 steps/s
[Step=21050 Epoch=81.0] | Loss=0.00121 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.998 | L2-Norm(final)=2.938 | 4023.0 samples/s | 62.9 steps/s
[Step=21100 Epoch=81.2] | Loss=0.00101 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.994 | L2-Norm(final)=2.939 | 1554.6 samples/s | 24.3 steps/s
[Step=21150 Epoch=81.4] | Loss=0.00087 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.991 | L2-Norm(final)=2.939 | 3304.7 samples/s | 51.6 steps/s
[Step=21200 Epoch=81.6] | Loss=0.00076 | Reg=0.00324 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.988 | L2-Norm(final)=2.939 | 3352.6 samples/s | 52.4 steps/s
[Step=21250 Epoch=81.8] | Loss=0.00068 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.986 | L2-Norm(final)=2.940 | 3343.3 samples/s | 52.2 steps/s
[Step=21300 Epoch=82.0] | Loss=0.00062 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.983 | L2-Norm(final)=2.940 | 3676.9 samples/s | 57.5 steps/s
[Step=21350 Epoch=82.2] | Loss=0.00056 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.981 | L2-Norm(final)=2.940 | 1612.5 samples/s | 25.2 steps/s
[Step=21400 Epoch=82.4] | Loss=0.00052 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.979 | L2-Norm(final)=2.940 | 3326.9 samples/s | 52.0 steps/s
[Step=21450 Epoch=82.6] | Loss=0.00048 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.977 | L2-Norm(final)=2.940 | 3301.2 samples/s | 51.6 steps/s
[Step=21500 Epoch=82.8] | Loss=0.00044 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.975 | L2-Norm(final)=2.941 | 3302.7 samples/s | 51.6 steps/s
[Step=21550 Epoch=83.0] | Loss=0.00042 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.973 | L2-Norm(final)=2.941 | 3385.6 samples/s | 52.9 steps/s
[Step=21600 Epoch=83.1] | Loss=0.00039 | Reg=0.00323 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.971 | L2-Norm(final)=2.941 | 1666.5 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17548 | acc=0.8913 | tpr=0.8527 | fpr=0.0248 | 3678.4 samples/s | 14.4 steps/s
Avg test loss: 0.17802, Avg test acc: 0.88833, Avg tpr: 0.85032, Avg fpr: 0.02807, total FA: 219

Testing server on iccad2012
[Step=  50] | Loss=0.44308 | acc=0.8251 | tpr=0.9823 | fpr=0.1777 | 3718.7 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.44922 | acc=0.8238 | tpr=0.9851 | fpr=0.1792 | 6786.9 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.45225 | acc=0.8233 | tpr=0.9870 | fpr=0.1798 | 6846.3 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.45233 | acc=0.8245 | tpr=0.9869 | fpr=0.1785 | 6899.5 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.45251 | acc=0.8228 | tpr=0.9825 | fpr=0.1801 | 6838.6 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.45373 | acc=0.8226 | tpr=0.9833 | fpr=0.1803 | 7112.9 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.45669 | acc=0.8221 | tpr=0.9818 | fpr=0.1808 | 6780.0 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.45837 | acc=0.8214 | tpr=0.9798 | fpr=0.1815 | 6768.4 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.46088 | acc=0.8212 | tpr=0.9805 | fpr=0.1817 | 6732.1 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.46088 | acc=0.8207 | tpr=0.9806 | fpr=0.1822 | 6839.7 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.45827 | acc=0.8215 | tpr=0.9805 | fpr=0.1814 | 12561.9 samples/s | 49.1 steps/s
Avg test loss: 0.45782, Avg test acc: 0.82157, Avg tpr: 0.98019, Avg fpr: 0.18131, total FA: 25175

server round 27/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=42.1] | Loss=0.09325 | Reg=0.00323 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.971 | L2-Norm(final)=2.962 | 3409.2 samples/s | 53.3 steps/s
[Step=21650 Epoch=42.2] | Loss=0.01551 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.946 | L2-Norm(final)=2.962 | 3591.0 samples/s | 56.1 steps/s
[Step=21700 Epoch=42.3] | Loss=0.01283 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.940 | L2-Norm(final)=2.963 | 3485.8 samples/s | 54.5 steps/s
[Step=21750 Epoch=42.4] | Loss=0.01187 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.936 | L2-Norm(final)=2.965 | 3469.6 samples/s | 54.2 steps/s
[Step=21800 Epoch=42.5] | Loss=0.01057 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.934 | L2-Norm(final)=2.968 | 3485.7 samples/s | 54.5 steps/s
[Step=21850 Epoch=42.6] | Loss=0.01105 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.933 | L2-Norm(final)=2.970 | 3481.9 samples/s | 54.4 steps/s
[Step=21900 Epoch=42.7] | Loss=0.01105 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.932 | L2-Norm(final)=2.972 | 3494.1 samples/s | 54.6 steps/s
[Step=21950 Epoch=42.8] | Loss=0.01106 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.932 | L2-Norm(final)=2.973 | 3487.9 samples/s | 54.5 steps/s
[Step=22000 Epoch=42.9] | Loss=0.01107 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.931 | L2-Norm(final)=2.974 | 3491.7 samples/s | 54.6 steps/s
[Step=22050 Epoch=43.0] | Loss=0.01078 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.931 | L2-Norm(final)=2.976 | 3504.6 samples/s | 54.8 steps/s
[Step=22100 Epoch=43.1] | Loss=0.01108 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.931 | L2-Norm(final)=2.977 | 4047.1 samples/s | 63.2 steps/s
[Step=22150 Epoch=43.2] | Loss=0.01103 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.931 | L2-Norm(final)=2.978 | 1544.9 samples/s | 24.1 steps/s
[Step=22200 Epoch=43.3] | Loss=0.01067 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.931 | L2-Norm(final)=2.979 | 3463.1 samples/s | 54.1 steps/s
[Step=22250 Epoch=43.4] | Loss=0.01045 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.931 | L2-Norm(final)=2.980 | 3468.0 samples/s | 54.2 steps/s
[Step=22300 Epoch=43.5] | Loss=0.01019 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.932 | L2-Norm(final)=2.981 | 3441.6 samples/s | 53.8 steps/s
[Step=22350 Epoch=43.6] | Loss=0.01012 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.932 | L2-Norm(final)=2.983 | 3442.3 samples/s | 53.8 steps/s
[Step=22400 Epoch=43.7] | Loss=0.01008 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.932 | L2-Norm(final)=2.984 | 3473.8 samples/s | 54.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step22400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=42.2] | Loss=0.12208 | Reg=0.00323 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.971 | L2-Norm(final)=2.962 | 3837.7 samples/s | 60.0 steps/s
[Step=21650 Epoch=42.3] | Loss=0.01688 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.945 | L2-Norm(final)=2.964 | 3322.5 samples/s | 51.9 steps/s
[Step=21700 Epoch=42.4] | Loss=0.01303 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.940 | L2-Norm(final)=2.967 | 3486.9 samples/s | 54.5 steps/s
[Step=21750 Epoch=42.5] | Loss=0.01185 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.937 | L2-Norm(final)=2.969 | 3489.3 samples/s | 54.5 steps/s
[Step=21800 Epoch=42.6] | Loss=0.01132 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.935 | L2-Norm(final)=2.971 | 3493.6 samples/s | 54.6 steps/s
[Step=21850 Epoch=42.7] | Loss=0.01089 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.934 | L2-Norm(final)=2.973 | 3503.6 samples/s | 54.7 steps/s
[Step=21900 Epoch=42.8] | Loss=0.01081 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.934 | L2-Norm(final)=2.976 | 3506.6 samples/s | 54.8 steps/s
[Step=21950 Epoch=42.9] | Loss=0.01075 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.934 | L2-Norm(final)=2.977 | 3463.3 samples/s | 54.1 steps/s
[Step=22000 Epoch=43.0] | Loss=0.01059 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.934 | L2-Norm(final)=2.979 | 3510.4 samples/s | 54.9 steps/s
[Step=22050 Epoch=43.1] | Loss=0.01074 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.934 | L2-Norm(final)=2.980 | 3506.6 samples/s | 54.8 steps/s
[Step=22100 Epoch=43.2] | Loss=0.01102 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.934 | L2-Norm(final)=2.981 | 4094.4 samples/s | 64.0 steps/s
[Step=22150 Epoch=43.3] | Loss=0.01105 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.934 | L2-Norm(final)=2.982 | 1602.4 samples/s | 25.0 steps/s
[Step=22200 Epoch=43.4] | Loss=0.01080 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.934 | L2-Norm(final)=2.983 | 3480.4 samples/s | 54.4 steps/s
[Step=22250 Epoch=43.5] | Loss=0.01047 | Reg=0.00322 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.934 | L2-Norm(final)=2.984 | 3479.3 samples/s | 54.4 steps/s
[Step=22300 Epoch=43.6] | Loss=0.01017 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.935 | L2-Norm(final)=2.986 | 3486.3 samples/s | 54.5 steps/s
[Step=22350 Epoch=43.7] | Loss=0.01014 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.935 | L2-Norm(final)=2.987 | 3491.9 samples/s | 54.6 steps/s
[Step=22400 Epoch=43.8] | Loss=0.00998 | Reg=0.00322 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.936 | L2-Norm(final)=2.989 | 3467.7 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step22400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=82.8] | Loss=0.09748 | Reg=0.00323 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.971 | L2-Norm(final)=2.962 | 3548.3 samples/s | 55.4 steps/s
[Step=21650 Epoch=83.0] | Loss=0.00832 | Reg=0.00321 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.927 | L2-Norm(final)=2.957 | 3233.9 samples/s | 50.5 steps/s
[Step=21700 Epoch=83.1] | Loss=0.00437 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.923 | L2-Norm(final)=2.956 | 3338.9 samples/s | 52.2 steps/s
[Step=21750 Epoch=83.3] | Loss=0.00305 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.920 | L2-Norm(final)=2.957 | 3329.6 samples/s | 52.0 steps/s
[Step=21800 Epoch=83.5] | Loss=0.00231 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.917 | L2-Norm(final)=2.957 | 3313.4 samples/s | 51.8 steps/s
[Step=21850 Epoch=83.7] | Loss=0.00185 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.914 | L2-Norm(final)=2.958 | 3974.3 samples/s | 62.1 steps/s
[Step=21900 Epoch=83.9] | Loss=0.00155 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=2.959 | 1546.6 samples/s | 24.2 steps/s
[Step=21950 Epoch=84.1] | Loss=0.00133 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.909 | L2-Norm(final)=2.959 | 3312.5 samples/s | 51.8 steps/s
[Step=22000 Epoch=84.3] | Loss=0.00117 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.907 | L2-Norm(final)=2.960 | 3304.3 samples/s | 51.6 steps/s
[Step=22050 Epoch=84.5] | Loss=0.00104 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.904 | L2-Norm(final)=2.960 | 3305.7 samples/s | 51.7 steps/s
[Step=22100 Epoch=84.7] | Loss=0.00094 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.902 | L2-Norm(final)=2.961 | 3579.9 samples/s | 55.9 steps/s
[Step=22150 Epoch=84.9] | Loss=0.00085 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.900 | L2-Norm(final)=2.961 | 1627.9 samples/s | 25.4 steps/s
[Step=22200 Epoch=85.1] | Loss=0.00078 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.898 | L2-Norm(final)=2.961 | 3349.5 samples/s | 52.3 steps/s
[Step=22250 Epoch=85.3] | Loss=0.00073 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.896 | L2-Norm(final)=2.962 | 3307.4 samples/s | 51.7 steps/s
[Step=22300 Epoch=85.4] | Loss=0.00067 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.895 | L2-Norm(final)=2.962 | 3326.0 samples/s | 52.0 steps/s
[Step=22350 Epoch=85.6] | Loss=0.00063 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.893 | L2-Norm(final)=2.962 | 3309.0 samples/s | 51.7 steps/s
[Step=22400 Epoch=85.8] | Loss=0.00059 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.891 | L2-Norm(final)=2.963 | 1686.5 samples/s | 26.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step22400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=83.2] | Loss=0.03720 | Reg=0.00323 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.971 | L2-Norm(final)=2.963 | 3522.1 samples/s | 55.0 steps/s
[Step=21650 Epoch=83.3] | Loss=0.00591 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.937 | L2-Norm(final)=2.966 | 3260.9 samples/s | 51.0 steps/s
[Step=21700 Epoch=83.5] | Loss=0.00326 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.936 | L2-Norm(final)=2.968 | 3333.2 samples/s | 52.1 steps/s
[Step=21750 Epoch=83.7] | Loss=0.00234 | Reg=0.00322 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.933 | L2-Norm(final)=2.969 | 3303.4 samples/s | 51.6 steps/s
[Step=21800 Epoch=83.9] | Loss=0.00177 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.930 | L2-Norm(final)=2.969 | 3314.5 samples/s | 51.8 steps/s
[Step=21850 Epoch=84.1] | Loss=0.00144 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.927 | L2-Norm(final)=2.970 | 3963.6 samples/s | 61.9 steps/s
[Step=21900 Epoch=84.3] | Loss=0.00120 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.924 | L2-Norm(final)=2.970 | 1552.3 samples/s | 24.3 steps/s
[Step=21950 Epoch=84.5] | Loss=0.00103 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.921 | L2-Norm(final)=2.971 | 3308.0 samples/s | 51.7 steps/s
[Step=22000 Epoch=84.7] | Loss=0.00091 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.918 | L2-Norm(final)=2.971 | 3306.3 samples/s | 51.7 steps/s
[Step=22050 Epoch=84.9] | Loss=0.00081 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.916 | L2-Norm(final)=2.971 | 3303.1 samples/s | 51.6 steps/s
[Step=22100 Epoch=85.1] | Loss=0.00073 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=2.971 | 3668.2 samples/s | 57.3 steps/s
[Step=22150 Epoch=85.3] | Loss=0.00066 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=2.972 | 1621.7 samples/s | 25.3 steps/s
[Step=22200 Epoch=85.5] | Loss=0.00061 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.909 | L2-Norm(final)=2.972 | 3322.0 samples/s | 51.9 steps/s
[Step=22250 Epoch=85.6] | Loss=0.00057 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.907 | L2-Norm(final)=2.972 | 3371.4 samples/s | 52.7 steps/s
[Step=22300 Epoch=85.8] | Loss=0.00053 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.905 | L2-Norm(final)=2.972 | 3315.4 samples/s | 51.8 steps/s
[Step=22350 Epoch=86.0] | Loss=0.00049 | Reg=0.00321 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.903 | L2-Norm(final)=2.972 | 3379.6 samples/s | 52.8 steps/s
[Step=22400 Epoch=86.2] | Loss=0.00046 | Reg=0.00320 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.901 | L2-Norm(final)=2.972 | 1673.1 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17564 | acc=0.8896 | tpr=0.8524 | fpr=0.0295 | 3653.0 samples/s | 14.3 steps/s
Avg test loss: 0.17857, Avg test acc: 0.88653, Avg tpr: 0.84945, Avg fpr: 0.03192, total FA: 249

Testing server on iccad2012
[Step=  50] | Loss=0.43229 | acc=0.8272 | tpr=0.9823 | fpr=0.1756 | 3679.0 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.43755 | acc=0.8279 | tpr=0.9829 | fpr=0.1750 | 6803.8 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.44153 | acc=0.8272 | tpr=0.9870 | fpr=0.1757 | 6936.5 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.44171 | acc=0.8283 | tpr=0.9869 | fpr=0.1746 | 6771.3 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.44164 | acc=0.8268 | tpr=0.9843 | fpr=0.1761 | 6888.3 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.44306 | acc=0.8271 | tpr=0.9840 | fpr=0.1758 | 7108.5 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.44597 | acc=0.8265 | tpr=0.9825 | fpr=0.1763 | 6805.7 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.44750 | acc=0.8259 | tpr=0.9803 | fpr=0.1769 | 6688.7 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.45019 | acc=0.8256 | tpr=0.9815 | fpr=0.1772 | 6793.2 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.45050 | acc=0.8250 | tpr=0.9819 | fpr=0.1778 | 6841.4 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.44797 | acc=0.8256 | tpr=0.9825 | fpr=0.1772 | 12612.7 samples/s | 49.3 steps/s
Avg test loss: 0.44753, Avg test acc: 0.82568, Avg tpr: 0.98217, Avg fpr: 0.17716, total FA: 24599

server round 28/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=43.7] | Loss=0.15361 | Reg=0.00320 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=17.894 | L2-Norm(final)=2.989 | 3536.5 samples/s | 55.3 steps/s
[Step=22450 Epoch=43.8] | Loss=0.01615 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.869 | L2-Norm(final)=2.990 | 3424.9 samples/s | 53.5 steps/s
[Step=22500 Epoch=43.9] | Loss=0.01275 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.864 | L2-Norm(final)=2.993 | 3482.5 samples/s | 54.4 steps/s
[Step=22550 Epoch=44.0] | Loss=0.01172 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.861 | L2-Norm(final)=2.995 | 3498.9 samples/s | 54.7 steps/s
[Step=22600 Epoch=44.1] | Loss=0.01090 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.860 | L2-Norm(final)=2.997 | 3450.6 samples/s | 53.9 steps/s
[Step=22650 Epoch=44.2] | Loss=0.01085 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.860 | L2-Norm(final)=3.000 | 3472.7 samples/s | 54.3 steps/s
[Step=22700 Epoch=44.3] | Loss=0.01055 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.859 | L2-Norm(final)=3.003 | 3503.0 samples/s | 54.7 steps/s
[Step=22750 Epoch=44.4] | Loss=0.01075 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.860 | L2-Norm(final)=3.005 | 3505.7 samples/s | 54.8 steps/s
[Step=22800 Epoch=44.5] | Loss=0.01080 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.860 | L2-Norm(final)=3.006 | 3509.3 samples/s | 54.8 steps/s
[Step=22850 Epoch=44.6] | Loss=0.01104 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.860 | L2-Norm(final)=3.007 | 3493.9 samples/s | 54.6 steps/s
[Step=22900 Epoch=44.7] | Loss=0.01149 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.860 | L2-Norm(final)=3.008 | 4064.5 samples/s | 63.5 steps/s
[Step=22950 Epoch=44.8] | Loss=0.01133 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.860 | L2-Norm(final)=3.009 | 1571.3 samples/s | 24.6 steps/s
[Step=23000 Epoch=44.9] | Loss=0.01096 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.860 | L2-Norm(final)=3.010 | 3473.2 samples/s | 54.3 steps/s
[Step=23050 Epoch=45.0] | Loss=0.01087 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.861 | L2-Norm(final)=3.011 | 3478.4 samples/s | 54.4 steps/s
[Step=23100 Epoch=45.1] | Loss=0.01059 | Reg=0.00319 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.861 | L2-Norm(final)=3.013 | 3493.0 samples/s | 54.6 steps/s
[Step=23150 Epoch=45.2] | Loss=0.01039 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.861 | L2-Norm(final)=3.014 | 3484.1 samples/s | 54.4 steps/s
[Step=23200 Epoch=45.2] | Loss=0.01018 | Reg=0.00319 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.862 | L2-Norm(final)=3.015 | 3502.2 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step23200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=43.8] | Loss=0.09100 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.894 | L2-Norm(final)=2.989 | 3735.7 samples/s | 58.4 steps/s
[Step=22450 Epoch=43.9] | Loss=0.02011 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.867 | L2-Norm(final)=2.985 | 3372.8 samples/s | 52.7 steps/s
[Step=22500 Epoch=44.0] | Loss=0.01416 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.862 | L2-Norm(final)=2.988 | 3487.3 samples/s | 54.5 steps/s
[Step=22550 Epoch=44.1] | Loss=0.01312 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.859 | L2-Norm(final)=2.992 | 3482.1 samples/s | 54.4 steps/s
[Step=22600 Epoch=44.2] | Loss=0.01215 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.858 | L2-Norm(final)=2.995 | 3483.1 samples/s | 54.4 steps/s
[Step=22650 Epoch=44.3] | Loss=0.01165 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.857 | L2-Norm(final)=2.997 | 3475.7 samples/s | 54.3 steps/s
[Step=22700 Epoch=44.4] | Loss=0.01104 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.857 | L2-Norm(final)=2.999 | 3479.0 samples/s | 54.4 steps/s
[Step=22750 Epoch=44.5] | Loss=0.01069 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.857 | L2-Norm(final)=3.002 | 3498.4 samples/s | 54.7 steps/s
[Step=22800 Epoch=44.6] | Loss=0.01053 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.857 | L2-Norm(final)=3.004 | 3495.5 samples/s | 54.6 steps/s
[Step=22850 Epoch=44.7] | Loss=0.01063 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.857 | L2-Norm(final)=3.005 | 3491.6 samples/s | 54.6 steps/s
[Step=22900 Epoch=44.8] | Loss=0.01075 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.857 | L2-Norm(final)=3.007 | 4109.1 samples/s | 64.2 steps/s
[Step=22950 Epoch=44.9] | Loss=0.01035 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.858 | L2-Norm(final)=3.008 | 1614.7 samples/s | 25.2 steps/s
[Step=23000 Epoch=45.0] | Loss=0.01015 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.858 | L2-Norm(final)=3.010 | 3474.8 samples/s | 54.3 steps/s
[Step=23050 Epoch=45.1] | Loss=0.01001 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.858 | L2-Norm(final)=3.011 | 3487.0 samples/s | 54.5 steps/s
[Step=23100 Epoch=45.2] | Loss=0.00998 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.859 | L2-Norm(final)=3.013 | 3456.6 samples/s | 54.0 steps/s
[Step=23150 Epoch=45.3] | Loss=0.01007 | Reg=0.00319 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.859 | L2-Norm(final)=3.014 | 3491.3 samples/s | 54.6 steps/s
[Step=23200 Epoch=45.4] | Loss=0.01004 | Reg=0.00319 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.859 | L2-Norm(final)=3.015 | 3502.3 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step23200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=85.8] | Loss=0.16948 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.894 | L2-Norm(final)=2.988 | 3862.8 samples/s | 60.4 steps/s
[Step=22450 Epoch=86.0] | Loss=0.00529 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.847 | L2-Norm(final)=2.987 | 3006.5 samples/s | 47.0 steps/s
[Step=22500 Epoch=86.2] | Loss=0.00276 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.840 | L2-Norm(final)=2.988 | 3334.2 samples/s | 52.1 steps/s
[Step=22550 Epoch=86.4] | Loss=0.00185 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.835 | L2-Norm(final)=2.989 | 3343.6 samples/s | 52.2 steps/s
[Step=22600 Epoch=86.6] | Loss=0.00140 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.830 | L2-Norm(final)=2.990 | 3334.9 samples/s | 52.1 steps/s
[Step=22650 Epoch=86.8] | Loss=0.00113 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=2.991 | 4002.2 samples/s | 62.5 steps/s
[Step=22700 Epoch=87.0] | Loss=0.00094 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.824 | L2-Norm(final)=2.991 | 1543.0 samples/s | 24.1 steps/s
[Step=22750 Epoch=87.2] | Loss=0.00081 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.821 | L2-Norm(final)=2.992 | 3327.2 samples/s | 52.0 steps/s
[Step=22800 Epoch=87.4] | Loss=0.00071 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.818 | L2-Norm(final)=2.992 | 3331.0 samples/s | 52.0 steps/s
[Step=22850 Epoch=87.6] | Loss=0.00064 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.816 | L2-Norm(final)=2.993 | 3344.1 samples/s | 52.3 steps/s
[Step=22900 Epoch=87.7] | Loss=0.00057 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.814 | L2-Norm(final)=2.993 | 3624.5 samples/s | 56.6 steps/s
[Step=22950 Epoch=87.9] | Loss=0.00052 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.812 | L2-Norm(final)=2.993 | 1631.7 samples/s | 25.5 steps/s
[Step=23000 Epoch=88.1] | Loss=0.00048 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.810 | L2-Norm(final)=2.993 | 3294.9 samples/s | 51.5 steps/s
[Step=23050 Epoch=88.3] | Loss=0.00045 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.808 | L2-Norm(final)=2.994 | 3287.9 samples/s | 51.4 steps/s
[Step=23100 Epoch=88.5] | Loss=0.00042 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.807 | L2-Norm(final)=2.994 | 3325.2 samples/s | 52.0 steps/s
[Step=23150 Epoch=88.7] | Loss=0.00039 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.805 | L2-Norm(final)=2.994 | 3331.1 samples/s | 52.0 steps/s
[Step=23200 Epoch=88.9] | Loss=0.00037 | Reg=0.00317 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.804 | L2-Norm(final)=2.994 | 1683.0 samples/s | 26.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step23200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=86.2] | Loss=0.01498 | Reg=0.00320 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.894 | L2-Norm(final)=2.989 | 3655.4 samples/s | 57.1 steps/s
[Step=22450 Epoch=86.4] | Loss=0.00589 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.849 | L2-Norm(final)=2.988 | 3165.2 samples/s | 49.5 steps/s
[Step=22500 Epoch=86.6] | Loss=0.00303 | Reg=0.00319 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.847 | L2-Norm(final)=2.987 | 3306.5 samples/s | 51.7 steps/s
[Step=22550 Epoch=86.8] | Loss=0.00204 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.843 | L2-Norm(final)=2.987 | 3302.5 samples/s | 51.6 steps/s
[Step=22600 Epoch=87.0] | Loss=0.00156 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.840 | L2-Norm(final)=2.987 | 3312.7 samples/s | 51.8 steps/s
[Step=22650 Epoch=87.2] | Loss=0.00126 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.837 | L2-Norm(final)=2.988 | 4035.4 samples/s | 63.1 steps/s
[Step=22700 Epoch=87.4] | Loss=0.00105 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.834 | L2-Norm(final)=2.988 | 1555.5 samples/s | 24.3 steps/s
[Step=22750 Epoch=87.6] | Loss=0.00090 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.831 | L2-Norm(final)=2.989 | 3273.4 samples/s | 51.1 steps/s
[Step=22800 Epoch=87.8] | Loss=0.00079 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.829 | L2-Norm(final)=2.989 | 2953.4 samples/s | 46.1 steps/s
[Step=22850 Epoch=88.0] | Loss=0.00071 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=2.989 | 2912.0 samples/s | 45.5 steps/s
[Step=22900 Epoch=88.2] | Loss=0.00064 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.824 | L2-Norm(final)=2.990 | 3234.5 samples/s | 50.5 steps/s
[Step=22950 Epoch=88.3] | Loss=0.00058 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.822 | L2-Norm(final)=2.990 | 1540.5 samples/s | 24.1 steps/s
[Step=23000 Epoch=88.5] | Loss=0.00053 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.820 | L2-Norm(final)=2.990 | 3227.2 samples/s | 50.4 steps/s
[Step=23050 Epoch=88.7] | Loss=0.00049 | Reg=0.00318 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.819 | L2-Norm(final)=2.991 | 3261.0 samples/s | 51.0 steps/s
[Step=23100 Epoch=88.9] | Loss=0.00046 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.817 | L2-Norm(final)=2.991 | 3268.7 samples/s | 51.1 steps/s
[Step=23150 Epoch=89.1] | Loss=0.00043 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.815 | L2-Norm(final)=2.991 | 3347.0 samples/s | 52.3 steps/s
[Step=23200 Epoch=89.3] | Loss=0.00040 | Reg=0.00317 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.813 | L2-Norm(final)=2.991 | 1659.3 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17441 | acc=0.8905 | tpr=0.8518 | fpr=0.0253 | 3664.6 samples/s | 14.3 steps/s
Avg test loss: 0.17588, Avg test acc: 0.88905, Avg tpr: 0.85114, Avg fpr: 0.02756, total FA: 215

Testing server on iccad2012
[Step=  50] | Loss=0.44560 | acc=0.8271 | tpr=0.9912 | fpr=0.1758 | 3645.0 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.45060 | acc=0.8270 | tpr=0.9872 | fpr=0.1760 | 6740.7 samples/s | 26.3 steps/s
[Step= 150] | Loss=0.45472 | acc=0.8263 | tpr=0.9899 | fpr=0.1767 | 6874.3 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.45469 | acc=0.8270 | tpr=0.9880 | fpr=0.1759 | 6736.7 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.45489 | acc=0.8253 | tpr=0.9843 | fpr=0.1776 | 6552.8 samples/s | 25.6 steps/s
[Step= 300] | Loss=0.45645 | acc=0.8249 | tpr=0.9847 | fpr=0.1780 | 6178.5 samples/s | 24.1 steps/s
[Step= 350] | Loss=0.45944 | acc=0.8245 | tpr=0.9831 | fpr=0.1784 | 6697.3 samples/s | 26.2 steps/s
[Step= 400] | Loss=0.46089 | acc=0.8241 | tpr=0.9809 | fpr=0.1787 | 6677.5 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.46366 | acc=0.8240 | tpr=0.9820 | fpr=0.1789 | 6927.7 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.46371 | acc=0.8234 | tpr=0.9819 | fpr=0.1794 | 6748.6 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.46097 | acc=0.8242 | tpr=0.9825 | fpr=0.1787 | 12410.5 samples/s | 48.5 steps/s
Avg test loss: 0.46053, Avg test acc: 0.82424, Avg tpr: 0.98217, Avg fpr: 0.17863, total FA: 24803

server round 29/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=45.3] | Loss=0.03615 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.815 | L2-Norm(final)=3.014 | 3631.4 samples/s | 56.7 steps/s
[Step=23250 Epoch=45.3] | Loss=0.01574 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.790 | L2-Norm(final)=3.014 | 3145.0 samples/s | 49.1 steps/s
[Step=23300 Epoch=45.4] | Loss=0.01294 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.784 | L2-Norm(final)=3.016 | 3475.1 samples/s | 54.3 steps/s
[Step=23350 Epoch=45.5] | Loss=0.01192 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.781 | L2-Norm(final)=3.017 | 3463.2 samples/s | 54.1 steps/s
[Step=23400 Epoch=45.6] | Loss=0.01061 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.780 | L2-Norm(final)=3.020 | 3469.0 samples/s | 54.2 steps/s
[Step=23450 Epoch=45.7] | Loss=0.01051 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.779 | L2-Norm(final)=3.022 | 3495.6 samples/s | 54.6 steps/s
[Step=23500 Epoch=45.8] | Loss=0.01052 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.779 | L2-Norm(final)=3.024 | 3510.1 samples/s | 54.8 steps/s
[Step=23550 Epoch=45.9] | Loss=0.01069 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.779 | L2-Norm(final)=3.026 | 3496.0 samples/s | 54.6 steps/s
[Step=23600 Epoch=46.0] | Loss=0.01069 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.779 | L2-Norm(final)=3.028 | 3492.5 samples/s | 54.6 steps/s
[Step=23650 Epoch=46.1] | Loss=0.01057 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.779 | L2-Norm(final)=3.029 | 3505.3 samples/s | 54.8 steps/s
[Step=23700 Epoch=46.2] | Loss=0.01048 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.779 | L2-Norm(final)=3.031 | 4010.4 samples/s | 62.7 steps/s
[Step=23750 Epoch=46.3] | Loss=0.01035 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.779 | L2-Norm(final)=3.032 | 1555.3 samples/s | 24.3 steps/s
[Step=23800 Epoch=46.4] | Loss=0.01011 | Reg=0.00316 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.779 | L2-Norm(final)=3.033 | 3475.8 samples/s | 54.3 steps/s
[Step=23850 Epoch=46.5] | Loss=0.00992 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.779 | L2-Norm(final)=3.034 | 3470.6 samples/s | 54.2 steps/s
[Step=23900 Epoch=46.6] | Loss=0.00990 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.779 | L2-Norm(final)=3.036 | 3486.2 samples/s | 54.5 steps/s
[Step=23950 Epoch=46.7] | Loss=0.00991 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.779 | L2-Norm(final)=3.037 | 3477.8 samples/s | 54.3 steps/s
[Step=24000 Epoch=46.8] | Loss=0.01002 | Reg=0.00316 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.779 | L2-Norm(final)=3.037 | 3497.2 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=45.4] | Loss=0.07869 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.815 | L2-Norm(final)=3.014 | 3780.8 samples/s | 59.1 steps/s
[Step=23250 Epoch=45.5] | Loss=0.01862 | Reg=0.00317 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.792 | L2-Norm(final)=3.011 | 3297.6 samples/s | 51.5 steps/s
[Step=23300 Epoch=45.6] | Loss=0.01322 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=3.015 | 3474.8 samples/s | 54.3 steps/s
[Step=23350 Epoch=45.6] | Loss=0.01165 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.786 | L2-Norm(final)=3.019 | 3473.6 samples/s | 54.3 steps/s
[Step=23400 Epoch=45.7] | Loss=0.01116 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.784 | L2-Norm(final)=3.022 | 3473.1 samples/s | 54.3 steps/s
[Step=23450 Epoch=45.8] | Loss=0.01103 | Reg=0.00316 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.783 | L2-Norm(final)=3.024 | 3472.0 samples/s | 54.3 steps/s
[Step=23500 Epoch=45.9] | Loss=0.01120 | Reg=0.00316 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.782 | L2-Norm(final)=3.026 | 3488.1 samples/s | 54.5 steps/s
[Step=23550 Epoch=46.0] | Loss=0.01093 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.781 | L2-Norm(final)=3.027 | 3482.9 samples/s | 54.4 steps/s
[Step=23600 Epoch=46.1] | Loss=0.01050 | Reg=0.00316 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.781 | L2-Norm(final)=3.029 | 3467.8 samples/s | 54.2 steps/s
[Step=23650 Epoch=46.2] | Loss=0.01053 | Reg=0.00316 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.780 | L2-Norm(final)=3.030 | 3475.3 samples/s | 54.3 steps/s
[Step=23700 Epoch=46.3] | Loss=0.01053 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.780 | L2-Norm(final)=3.031 | 4056.5 samples/s | 63.4 steps/s
[Step=23750 Epoch=46.4] | Loss=0.01052 | Reg=0.00316 | FP-Reg=0.001 | acc=0.9688 | L2-Norm=17.780 | L2-Norm(final)=3.031 | 1598.7 samples/s | 25.0 steps/s
[Step=23800 Epoch=46.5] | Loss=0.01026 | Reg=0.00316 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.780 | L2-Norm(final)=3.032 | 3463.7 samples/s | 54.1 steps/s
[Step=23850 Epoch=46.6] | Loss=0.01001 | Reg=0.00316 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.780 | L2-Norm(final)=3.033 | 3456.8 samples/s | 54.0 steps/s
[Step=23900 Epoch=46.7] | Loss=0.00995 | Reg=0.00316 | FP-Reg=0.001 | acc=0.9844 | L2-Norm=17.780 | L2-Norm(final)=3.035 | 3456.9 samples/s | 54.0 steps/s
[Step=23950 Epoch=46.8] | Loss=0.00995 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.780 | L2-Norm(final)=3.036 | 3464.9 samples/s | 54.1 steps/s
[Step=24000 Epoch=46.9] | Loss=0.00981 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.780 | L2-Norm(final)=3.037 | 3479.5 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step24000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=88.9] | Loss=0.16939 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.815 | L2-Norm(final)=3.014 | 3660.9 samples/s | 57.2 steps/s
[Step=23250 Epoch=89.1] | Loss=0.00655 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.769 | L2-Norm(final)=3.013 | 3134.2 samples/s | 49.0 steps/s
[Step=23300 Epoch=89.3] | Loss=0.00333 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.763 | L2-Norm(final)=3.015 | 3311.3 samples/s | 51.7 steps/s
[Step=23350 Epoch=89.5] | Loss=0.00235 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.758 | L2-Norm(final)=3.016 | 3304.4 samples/s | 51.6 steps/s
[Step=23400 Epoch=89.7] | Loss=0.00177 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.754 | L2-Norm(final)=3.017 | 3327.9 samples/s | 52.0 steps/s
[Step=23450 Epoch=89.9] | Loss=0.00142 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.751 | L2-Norm(final)=3.018 | 3992.4 samples/s | 62.4 steps/s
[Step=23500 Epoch=90.0] | Loss=0.00119 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.748 | L2-Norm(final)=3.018 | 1560.7 samples/s | 24.4 steps/s
[Step=23550 Epoch=90.2] | Loss=0.00102 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.745 | L2-Norm(final)=3.018 | 3317.8 samples/s | 51.8 steps/s
[Step=23600 Epoch=90.4] | Loss=0.00089 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.743 | L2-Norm(final)=3.019 | 3341.0 samples/s | 52.2 steps/s
[Step=23650 Epoch=90.6] | Loss=0.00080 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.741 | L2-Norm(final)=3.019 | 3314.6 samples/s | 51.8 steps/s
[Step=23700 Epoch=90.8] | Loss=0.00072 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.739 | L2-Norm(final)=3.019 | 3554.2 samples/s | 55.5 steps/s
[Step=23750 Epoch=91.0] | Loss=0.00065 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.736 | L2-Norm(final)=3.019 | 1620.4 samples/s | 25.3 steps/s
[Step=23800 Epoch=91.2] | Loss=0.00060 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.735 | L2-Norm(final)=3.019 | 3301.9 samples/s | 51.6 steps/s
[Step=23850 Epoch=91.4] | Loss=0.00056 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.733 | L2-Norm(final)=3.019 | 3299.1 samples/s | 51.5 steps/s
[Step=23900 Epoch=91.6] | Loss=0.00052 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.731 | L2-Norm(final)=3.019 | 3324.1 samples/s | 51.9 steps/s
[Step=23950 Epoch=91.8] | Loss=0.00048 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.729 | L2-Norm(final)=3.020 | 3334.2 samples/s | 52.1 steps/s
[Step=24000 Epoch=92.0] | Loss=0.00046 | Reg=0.00314 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.728 | L2-Norm(final)=3.020 | 1673.2 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step24000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=89.3] | Loss=0.08475 | Reg=0.00317 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.815 | L2-Norm(final)=3.014 | 3811.3 samples/s | 59.6 steps/s
[Step=23250 Epoch=89.5] | Loss=0.00279 | Reg=0.00316 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.766 | L2-Norm(final)=3.015 | 3020.6 samples/s | 47.2 steps/s
[Step=23300 Epoch=89.7] | Loss=0.00142 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.759 | L2-Norm(final)=3.016 | 3300.5 samples/s | 51.6 steps/s
[Step=23350 Epoch=89.9] | Loss=0.00099 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.754 | L2-Norm(final)=3.017 | 3328.6 samples/s | 52.0 steps/s
[Step=23400 Epoch=90.1] | Loss=0.00075 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.750 | L2-Norm(final)=3.018 | 3334.5 samples/s | 52.1 steps/s
[Step=23450 Epoch=90.3] | Loss=0.00062 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.747 | L2-Norm(final)=3.019 | 4036.7 samples/s | 63.1 steps/s
[Step=23500 Epoch=90.5] | Loss=0.00052 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.744 | L2-Norm(final)=3.019 | 1555.9 samples/s | 24.3 steps/s
[Step=23550 Epoch=90.7] | Loss=0.00044 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.741 | L2-Norm(final)=3.020 | 3318.0 samples/s | 51.8 steps/s
[Step=23600 Epoch=90.8] | Loss=0.00039 | Reg=0.00315 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.739 | L2-Norm(final)=3.020 | 3296.0 samples/s | 51.5 steps/s
[Step=23650 Epoch=91.0] | Loss=0.00035 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.737 | L2-Norm(final)=3.020 | 3293.0 samples/s | 51.5 steps/s
[Step=23700 Epoch=91.2] | Loss=0.00032 | Reg=0.00315 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.734 | L2-Norm(final)=3.021 | 3691.1 samples/s | 57.7 steps/s
[Step=23750 Epoch=91.4] | Loss=0.00029 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.732 | L2-Norm(final)=3.021 | 1594.4 samples/s | 24.9 steps/s
[Step=23800 Epoch=91.6] | Loss=0.00027 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.731 | L2-Norm(final)=3.021 | 3336.1 samples/s | 52.1 steps/s
[Step=23850 Epoch=91.8] | Loss=0.00025 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.729 | L2-Norm(final)=3.021 | 3301.5 samples/s | 51.6 steps/s
[Step=23900 Epoch=92.0] | Loss=0.00023 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.727 | L2-Norm(final)=3.021 | 3326.3 samples/s | 52.0 steps/s
[Step=23950 Epoch=92.2] | Loss=0.00022 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.725 | L2-Norm(final)=3.022 | 3367.8 samples/s | 52.6 steps/s
[Step=24000 Epoch=92.4] | Loss=0.00020 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.724 | L2-Norm(final)=3.022 | 1655.9 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.15587 | acc=0.9062 | tpr=0.8736 | fpr=0.0230 | 3626.1 samples/s | 14.2 steps/s
Avg test loss: 0.15856, Avg test acc: 0.90460, Avg tpr: 0.87282, Avg fpr: 0.02551, total FA: 199

Testing server on iccad2012
[Step=  50] | Loss=0.49943 | acc=0.8083 | tpr=0.9867 | fpr=0.1949 | 3659.6 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.50486 | acc=0.8077 | tpr=0.9872 | fpr=0.1957 | 6739.7 samples/s | 26.3 steps/s
[Step= 150] | Loss=0.50898 | acc=0.8070 | tpr=0.9899 | fpr=0.1964 | 6981.4 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.50856 | acc=0.8077 | tpr=0.9869 | fpr=0.1956 | 6872.4 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.50892 | acc=0.8062 | tpr=0.9843 | fpr=0.1970 | 6695.6 samples/s | 26.2 steps/s
[Step= 300] | Loss=0.51035 | acc=0.8060 | tpr=0.9840 | fpr=0.1972 | 7102.0 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.51387 | acc=0.8055 | tpr=0.9825 | fpr=0.1978 | 6517.0 samples/s | 25.5 steps/s
[Step= 400] | Loss=0.51553 | acc=0.8050 | tpr=0.9803 | fpr=0.1981 | 6753.9 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.51868 | acc=0.8049 | tpr=0.9815 | fpr=0.1983 | 6696.7 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.51880 | acc=0.8045 | tpr=0.9815 | fpr=0.1987 | 6858.3 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.51573 | acc=0.8054 | tpr=0.9817 | fpr=0.1978 | 12921.8 samples/s | 50.5 steps/s
Avg test loss: 0.51530, Avg test acc: 0.80547, Avg tpr: 0.98138, Avg fpr: 0.19773, total FA: 27454

server round 30/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=46.8] | Loss=0.04052 | Reg=0.00314 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.731 | L2-Norm(final)=3.036 | 3601.1 samples/s | 56.3 steps/s
[Step=24050 Epoch=46.9] | Loss=0.02311 | Reg=0.00314 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.709 | L2-Norm(final)=3.031 | 3340.7 samples/s | 52.2 steps/s
[Step=24100 Epoch=47.0] | Loss=0.01579 | Reg=0.00313 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.702 | L2-Norm(final)=3.032 | 3447.8 samples/s | 53.9 steps/s
[Step=24150 Epoch=47.1] | Loss=0.01351 | Reg=0.00313 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.698 | L2-Norm(final)=3.033 | 3387.8 samples/s | 52.9 steps/s
[Step=24200 Epoch=47.2] | Loss=0.01177 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.696 | L2-Norm(final)=3.035 | 3382.4 samples/s | 52.8 steps/s
[Step=24250 Epoch=47.3] | Loss=0.01048 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.695 | L2-Norm(final)=3.037 | 3394.8 samples/s | 53.0 steps/s
[Step=24300 Epoch=47.4] | Loss=0.01006 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.694 | L2-Norm(final)=3.040 | 3464.5 samples/s | 54.1 steps/s
[Step=24350 Epoch=47.5] | Loss=0.00955 | Reg=0.00313 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.693 | L2-Norm(final)=3.041 | 3445.1 samples/s | 53.8 steps/s
[Step=24400 Epoch=47.6] | Loss=0.00940 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.692 | L2-Norm(final)=3.043 | 3458.2 samples/s | 54.0 steps/s
[Step=24450 Epoch=47.7] | Loss=0.00905 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.692 | L2-Norm(final)=3.044 | 3475.5 samples/s | 54.3 steps/s
[Step=24500 Epoch=47.8] | Loss=0.00873 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.691 | L2-Norm(final)=3.046 | 4061.5 samples/s | 63.5 steps/s
[Step=24550 Epoch=47.9] | Loss=0.00861 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.691 | L2-Norm(final)=3.047 | 1555.5 samples/s | 24.3 steps/s
[Step=24600 Epoch=48.0] | Loss=0.00840 | Reg=0.00313 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.690 | L2-Norm(final)=3.049 | 3443.7 samples/s | 53.8 steps/s
[Step=24650 Epoch=48.1] | Loss=0.00817 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.690 | L2-Norm(final)=3.050 | 3474.9 samples/s | 54.3 steps/s
[Step=24700 Epoch=48.2] | Loss=0.00800 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.689 | L2-Norm(final)=3.051 | 3474.1 samples/s | 54.3 steps/s
[Step=24750 Epoch=48.3] | Loss=0.00781 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.689 | L2-Norm(final)=3.053 | 3421.2 samples/s | 53.5 steps/s
[Step=24800 Epoch=48.4] | Loss=0.00760 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.689 | L2-Norm(final)=3.054 | 3486.6 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step24800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=46.9] | Loss=0.07691 | Reg=0.00314 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.731 | L2-Norm(final)=3.036 | 3719.1 samples/s | 58.1 steps/s
[Step=24050 Epoch=47.0] | Loss=0.01772 | Reg=0.00314 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.708 | L2-Norm(final)=3.035 | 3351.9 samples/s | 52.4 steps/s
[Step=24100 Epoch=47.1] | Loss=0.01330 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.701 | L2-Norm(final)=3.037 | 3487.2 samples/s | 54.5 steps/s
[Step=24150 Epoch=47.2] | Loss=0.01130 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.697 | L2-Norm(final)=3.039 | 3476.2 samples/s | 54.3 steps/s
[Step=24200 Epoch=47.3] | Loss=0.00996 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.695 | L2-Norm(final)=3.041 | 3474.8 samples/s | 54.3 steps/s
[Step=24250 Epoch=47.4] | Loss=0.00918 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.693 | L2-Norm(final)=3.043 | 3463.1 samples/s | 54.1 steps/s
[Step=24300 Epoch=47.5] | Loss=0.00899 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.692 | L2-Norm(final)=3.045 | 3490.9 samples/s | 54.5 steps/s
[Step=24350 Epoch=47.6] | Loss=0.00895 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.691 | L2-Norm(final)=3.046 | 3483.6 samples/s | 54.4 steps/s
[Step=24400 Epoch=47.7] | Loss=0.00867 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.691 | L2-Norm(final)=3.048 | 3510.4 samples/s | 54.8 steps/s
[Step=24450 Epoch=47.8] | Loss=0.00876 | Reg=0.00313 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.690 | L2-Norm(final)=3.049 | 3501.2 samples/s | 54.7 steps/s
[Step=24500 Epoch=47.9] | Loss=0.00841 | Reg=0.00313 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.690 | L2-Norm(final)=3.050 | 4056.5 samples/s | 63.4 steps/s
[Step=24550 Epoch=48.0] | Loss=0.00803 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.689 | L2-Norm(final)=3.052 | 1608.6 samples/s | 25.1 steps/s
[Step=24600 Epoch=48.1] | Loss=0.00778 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.689 | L2-Norm(final)=3.053 | 3482.8 samples/s | 54.4 steps/s
[Step=24650 Epoch=48.2] | Loss=0.00770 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.689 | L2-Norm(final)=3.054 | 3481.5 samples/s | 54.4 steps/s
[Step=24700 Epoch=48.3] | Loss=0.00756 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.688 | L2-Norm(final)=3.056 | 3473.0 samples/s | 54.3 steps/s
[Step=24750 Epoch=48.4] | Loss=0.00745 | Reg=0.00313 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.688 | L2-Norm(final)=3.057 | 3450.7 samples/s | 53.9 steps/s
[Step=24800 Epoch=48.5] | Loss=0.00740 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.688 | L2-Norm(final)=3.058 | 3468.4 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step24800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=92.0] | Loss=0.08649 | Reg=0.00314 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.731 | L2-Norm(final)=3.036 | 3907.6 samples/s | 61.1 steps/s
[Step=24050 Epoch=92.2] | Loss=0.00722 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.687 | L2-Norm(final)=3.037 | 3101.3 samples/s | 48.5 steps/s
[Step=24100 Epoch=92.3] | Loss=0.00364 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.680 | L2-Norm(final)=3.037 | 3292.1 samples/s | 51.4 steps/s
[Step=24150 Epoch=92.5] | Loss=0.00245 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.676 | L2-Norm(final)=3.038 | 3322.3 samples/s | 51.9 steps/s
[Step=24200 Epoch=92.7] | Loss=0.00184 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.672 | L2-Norm(final)=3.038 | 3332.0 samples/s | 52.1 steps/s
[Step=24250 Epoch=92.9] | Loss=0.00149 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.670 | L2-Norm(final)=3.038 | 3989.8 samples/s | 62.3 steps/s
[Step=24300 Epoch=93.1] | Loss=0.00124 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.667 | L2-Norm(final)=3.038 | 1561.2 samples/s | 24.4 steps/s
[Step=24350 Epoch=93.3] | Loss=0.00107 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.665 | L2-Norm(final)=3.039 | 3320.5 samples/s | 51.9 steps/s
[Step=24400 Epoch=93.5] | Loss=0.00094 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.663 | L2-Norm(final)=3.039 | 3348.5 samples/s | 52.3 steps/s
[Step=24450 Epoch=93.7] | Loss=0.00084 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.661 | L2-Norm(final)=3.039 | 3421.8 samples/s | 53.5 steps/s
[Step=24500 Epoch=93.9] | Loss=0.00076 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.660 | L2-Norm(final)=3.039 | 3801.3 samples/s | 59.4 steps/s
[Step=24550 Epoch=94.1] | Loss=0.00069 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.658 | L2-Norm(final)=3.039 | 1628.1 samples/s | 25.4 steps/s
[Step=24600 Epoch=94.3] | Loss=0.00063 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.657 | L2-Norm(final)=3.040 | 3339.7 samples/s | 52.2 steps/s
[Step=24650 Epoch=94.5] | Loss=0.00059 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.655 | L2-Norm(final)=3.040 | 3318.3 samples/s | 51.8 steps/s
[Step=24700 Epoch=94.6] | Loss=0.00055 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.654 | L2-Norm(final)=3.040 | 3311.8 samples/s | 51.7 steps/s
[Step=24750 Epoch=94.8] | Loss=0.00051 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.653 | L2-Norm(final)=3.040 | 3322.3 samples/s | 51.9 steps/s
[Step=24800 Epoch=95.0] | Loss=0.00048 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.652 | L2-Norm(final)=3.040 | 1674.1 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step24800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=92.4] | Loss=0.07670 | Reg=0.00314 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.731 | L2-Norm(final)=3.036 | 3497.7 samples/s | 54.7 steps/s
[Step=24050 Epoch=92.6] | Loss=0.00579 | Reg=0.00313 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.680 | L2-Norm(final)=3.036 | 3306.9 samples/s | 51.7 steps/s
[Step=24100 Epoch=92.8] | Loss=0.00294 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.673 | L2-Norm(final)=3.036 | 3317.3 samples/s | 51.8 steps/s
[Step=24150 Epoch=93.0] | Loss=0.00197 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.668 | L2-Norm(final)=3.036 | 3266.2 samples/s | 51.0 steps/s
[Step=24200 Epoch=93.2] | Loss=0.00149 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.665 | L2-Norm(final)=3.037 | 3329.0 samples/s | 52.0 steps/s
[Step=24250 Epoch=93.3] | Loss=0.00120 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.662 | L2-Norm(final)=3.037 | 4024.4 samples/s | 62.9 steps/s
[Step=24300 Epoch=93.5] | Loss=0.00101 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.660 | L2-Norm(final)=3.037 | 1551.3 samples/s | 24.2 steps/s
[Step=24350 Epoch=93.7] | Loss=0.00087 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.658 | L2-Norm(final)=3.038 | 3318.7 samples/s | 51.9 steps/s
[Step=24400 Epoch=93.9] | Loss=0.00076 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.656 | L2-Norm(final)=3.038 | 3296.9 samples/s | 51.5 steps/s
[Step=24450 Epoch=94.1] | Loss=0.00068 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.654 | L2-Norm(final)=3.038 | 3269.6 samples/s | 51.1 steps/s
[Step=24500 Epoch=94.3] | Loss=0.00062 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.653 | L2-Norm(final)=3.038 | 3652.6 samples/s | 57.1 steps/s
[Step=24550 Epoch=94.5] | Loss=0.00056 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.651 | L2-Norm(final)=3.038 | 1603.1 samples/s | 25.0 steps/s
[Step=24600 Epoch=94.7] | Loss=0.00052 | Reg=0.00312 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.650 | L2-Norm(final)=3.039 | 3315.5 samples/s | 51.8 steps/s
[Step=24650 Epoch=94.9] | Loss=0.00048 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.649 | L2-Norm(final)=3.039 | 3331.7 samples/s | 52.1 steps/s
[Step=24700 Epoch=95.1] | Loss=0.00044 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.647 | L2-Norm(final)=3.039 | 3335.6 samples/s | 52.1 steps/s
[Step=24750 Epoch=95.3] | Loss=0.00042 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.646 | L2-Norm(final)=3.039 | 3381.1 samples/s | 52.8 steps/s
[Step=24800 Epoch=95.5] | Loss=0.00039 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.645 | L2-Norm(final)=3.039 | 1656.0 samples/s | 25.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18059 | acc=0.8923 | tpr=0.8516 | fpr=0.0193 | 3623.5 samples/s | 14.2 steps/s
Avg test loss: 0.18322, Avg test acc: 0.89034, Avg tpr: 0.85038, Avg fpr: 0.02179, total FA: 170

Testing server on iccad2012
[Step=  50] | Loss=0.42603 | acc=0.8360 | tpr=0.9867 | fpr=0.1667 | 3636.9 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.43138 | acc=0.8363 | tpr=0.9808 | fpr=0.1664 | 6780.2 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.43576 | acc=0.8366 | tpr=0.9813 | fpr=0.1661 | 6821.1 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.43598 | acc=0.8374 | tpr=0.9814 | fpr=0.1652 | 6872.8 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.43575 | acc=0.8364 | tpr=0.9782 | fpr=0.1662 | 6938.4 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.43705 | acc=0.8362 | tpr=0.9789 | fpr=0.1664 | 6865.3 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.44030 | acc=0.8358 | tpr=0.9781 | fpr=0.1668 | 6809.4 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.44172 | acc=0.8353 | tpr=0.9754 | fpr=0.1672 | 6688.9 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.44473 | acc=0.8353 | tpr=0.9766 | fpr=0.1673 | 6846.6 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.44454 | acc=0.8350 | tpr=0.9771 | fpr=0.1675 | 6620.2 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.44165 | acc=0.8359 | tpr=0.9769 | fpr=0.1667 | 12463.2 samples/s | 48.7 steps/s
Avg test loss: 0.44125, Avg test acc: 0.83596, Avg tpr: 0.97662, Avg fpr: 0.16660, total FA: 23132

server round 31/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=48.4] | Loss=0.03383 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.653 | L2-Norm(final)=3.059 | 3774.2 samples/s | 59.0 steps/s
[Step=24850 Epoch=48.5] | Loss=0.01789 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.630 | L2-Norm(final)=3.058 | 3202.3 samples/s | 50.0 steps/s
[Step=24900 Epoch=48.6] | Loss=0.01247 | Reg=0.00311 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.624 | L2-Norm(final)=3.060 | 3473.4 samples/s | 54.3 steps/s
[Step=24950 Epoch=48.7] | Loss=0.01110 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.621 | L2-Norm(final)=3.062 | 3465.7 samples/s | 54.2 steps/s
[Step=25000 Epoch=48.8] | Loss=0.01057 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.619 | L2-Norm(final)=3.064 | 3439.4 samples/s | 53.7 steps/s
[Step=25050 Epoch=48.9] | Loss=0.00992 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.617 | L2-Norm(final)=3.065 | 3475.8 samples/s | 54.3 steps/s
[Step=25100 Epoch=49.0] | Loss=0.00952 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.616 | L2-Norm(final)=3.067 | 3477.0 samples/s | 54.3 steps/s
[Step=25150 Epoch=49.1] | Loss=0.00888 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.615 | L2-Norm(final)=3.068 | 3449.5 samples/s | 53.9 steps/s
[Step=25200 Epoch=49.1] | Loss=0.00861 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.614 | L2-Norm(final)=3.070 | 3463.2 samples/s | 54.1 steps/s
[Step=25250 Epoch=49.2] | Loss=0.00835 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.614 | L2-Norm(final)=3.072 | 3393.9 samples/s | 53.0 steps/s
[Step=25300 Epoch=49.3] | Loss=0.00832 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.613 | L2-Norm(final)=3.073 | 3987.6 samples/s | 62.3 steps/s
[Step=25350 Epoch=49.4] | Loss=0.00814 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.613 | L2-Norm(final)=3.074 | 1567.2 samples/s | 24.5 steps/s
[Step=25400 Epoch=49.5] | Loss=0.00793 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.612 | L2-Norm(final)=3.075 | 3464.0 samples/s | 54.1 steps/s
[Step=25450 Epoch=49.6] | Loss=0.00771 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.612 | L2-Norm(final)=3.077 | 3451.9 samples/s | 53.9 steps/s
[Step=25500 Epoch=49.7] | Loss=0.00757 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.612 | L2-Norm(final)=3.078 | 3467.7 samples/s | 54.2 steps/s
[Step=25550 Epoch=49.8] | Loss=0.00752 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.612 | L2-Norm(final)=3.080 | 3465.3 samples/s | 54.1 steps/s
[Step=25600 Epoch=49.9] | Loss=0.00738 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.612 | L2-Norm(final)=3.081 | 3470.1 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step25600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=48.5] | Loss=0.03523 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.653 | L2-Norm(final)=3.060 | 3602.2 samples/s | 56.3 steps/s
[Step=24850 Epoch=48.6] | Loss=0.01549 | Reg=0.00311 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.629 | L2-Norm(final)=3.060 | 3377.7 samples/s | 52.8 steps/s
[Step=24900 Epoch=48.7] | Loss=0.01133 | Reg=0.00311 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.622 | L2-Norm(final)=3.063 | 3484.1 samples/s | 54.4 steps/s
[Step=24950 Epoch=48.8] | Loss=0.01019 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.619 | L2-Norm(final)=3.065 | 3479.2 samples/s | 54.4 steps/s
[Step=25000 Epoch=48.9] | Loss=0.00990 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.617 | L2-Norm(final)=3.066 | 3473.2 samples/s | 54.3 steps/s
[Step=25050 Epoch=49.0] | Loss=0.00942 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.615 | L2-Norm(final)=3.068 | 3483.7 samples/s | 54.4 steps/s
[Step=25100 Epoch=49.1] | Loss=0.00900 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.614 | L2-Norm(final)=3.069 | 3480.4 samples/s | 54.4 steps/s
[Step=25150 Epoch=49.2] | Loss=0.00851 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.613 | L2-Norm(final)=3.071 | 3471.7 samples/s | 54.2 steps/s
[Step=25200 Epoch=49.3] | Loss=0.00827 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.613 | L2-Norm(final)=3.073 | 3472.6 samples/s | 54.3 steps/s
[Step=25250 Epoch=49.4] | Loss=0.00812 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.612 | L2-Norm(final)=3.074 | 3434.5 samples/s | 53.7 steps/s
[Step=25300 Epoch=49.5] | Loss=0.00813 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.612 | L2-Norm(final)=3.076 | 4060.6 samples/s | 63.4 steps/s
[Step=25350 Epoch=49.6] | Loss=0.00796 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.612 | L2-Norm(final)=3.077 | 1617.0 samples/s | 25.3 steps/s
[Step=25400 Epoch=49.7] | Loss=0.00779 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.611 | L2-Norm(final)=3.078 | 3468.6 samples/s | 54.2 steps/s
[Step=25450 Epoch=49.8] | Loss=0.00751 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.611 | L2-Norm(final)=3.079 | 3433.8 samples/s | 53.7 steps/s
[Step=25500 Epoch=49.9] | Loss=0.00740 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.611 | L2-Norm(final)=3.081 | 3492.5 samples/s | 54.6 steps/s
[Step=25550 Epoch=49.9] | Loss=0.00727 | Reg=0.00310 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.611 | L2-Norm(final)=3.082 | 3477.3 samples/s | 54.3 steps/s
[Step=25600 Epoch=50.0] | Loss=0.00705 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.611 | L2-Norm(final)=3.083 | 3486.8 samples/s | 54.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step25600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=95.0] | Loss=0.05493 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.653 | L2-Norm(final)=3.060 | 3559.2 samples/s | 55.6 steps/s
[Step=24850 Epoch=95.2] | Loss=0.00341 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.606 | L2-Norm(final)=3.064 | 3164.8 samples/s | 49.4 steps/s
[Step=24900 Epoch=95.4] | Loss=0.00174 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.599 | L2-Norm(final)=3.065 | 3270.8 samples/s | 51.1 steps/s
[Step=24950 Epoch=95.6] | Loss=0.00117 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.595 | L2-Norm(final)=3.066 | 3302.9 samples/s | 51.6 steps/s
[Step=25000 Epoch=95.8] | Loss=0.00089 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.591 | L2-Norm(final)=3.066 | 3307.6 samples/s | 51.7 steps/s
[Step=25050 Epoch=96.0] | Loss=0.00072 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.588 | L2-Norm(final)=3.066 | 3967.7 samples/s | 62.0 steps/s
[Step=25100 Epoch=96.2] | Loss=0.00060 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.586 | L2-Norm(final)=3.066 | 1548.1 samples/s | 24.2 steps/s
[Step=25150 Epoch=96.4] | Loss=0.00052 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.584 | L2-Norm(final)=3.067 | 3317.8 samples/s | 51.8 steps/s
[Step=25200 Epoch=96.6] | Loss=0.00046 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.582 | L2-Norm(final)=3.067 | 3307.1 samples/s | 51.7 steps/s
[Step=25250 Epoch=96.7] | Loss=0.00041 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.580 | L2-Norm(final)=3.067 | 3277.1 samples/s | 51.2 steps/s
[Step=25300 Epoch=96.9] | Loss=0.00037 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.578 | L2-Norm(final)=3.067 | 3602.3 samples/s | 56.3 steps/s
[Step=25350 Epoch=97.1] | Loss=0.00034 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.577 | L2-Norm(final)=3.067 | 1615.0 samples/s | 25.2 steps/s
[Step=25400 Epoch=97.3] | Loss=0.00031 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.575 | L2-Norm(final)=3.067 | 3336.5 samples/s | 52.1 steps/s
[Step=25450 Epoch=97.5] | Loss=0.00029 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.574 | L2-Norm(final)=3.067 | 3275.4 samples/s | 51.2 steps/s
[Step=25500 Epoch=97.7] | Loss=0.00027 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.572 | L2-Norm(final)=3.067 | 3285.5 samples/s | 51.3 steps/s
[Step=25550 Epoch=97.9] | Loss=0.00025 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.571 | L2-Norm(final)=3.067 | 3298.5 samples/s | 51.5 steps/s
[Step=25600 Epoch=98.1] | Loss=0.00024 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.570 | L2-Norm(final)=3.067 | 1661.1 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step25600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=95.5] | Loss=0.10757 | Reg=0.00312 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.653 | L2-Norm(final)=3.059 | 3572.2 samples/s | 55.8 steps/s
[Step=24850 Epoch=95.7] | Loss=0.00406 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.603 | L2-Norm(final)=3.061 | 3247.3 samples/s | 50.7 steps/s
[Step=24900 Epoch=95.8] | Loss=0.00205 | Reg=0.00310 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.595 | L2-Norm(final)=3.061 | 3317.9 samples/s | 51.8 steps/s
[Step=24950 Epoch=96.0] | Loss=0.00137 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.590 | L2-Norm(final)=3.062 | 3310.9 samples/s | 51.7 steps/s
[Step=25000 Epoch=96.2] | Loss=0.00104 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.587 | L2-Norm(final)=3.062 | 3296.7 samples/s | 51.5 steps/s
[Step=25050 Epoch=96.4] | Loss=0.00085 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.584 | L2-Norm(final)=3.062 | 3997.3 samples/s | 62.5 steps/s
[Step=25100 Epoch=96.6] | Loss=0.00071 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.581 | L2-Norm(final)=3.062 | 1536.8 samples/s | 24.0 steps/s
[Step=25150 Epoch=96.8] | Loss=0.00061 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.579 | L2-Norm(final)=3.062 | 3297.2 samples/s | 51.5 steps/s
[Step=25200 Epoch=97.0] | Loss=0.00054 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.577 | L2-Norm(final)=3.063 | 3283.2 samples/s | 51.3 steps/s
[Step=25250 Epoch=97.2] | Loss=0.00048 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.576 | L2-Norm(final)=3.063 | 3282.0 samples/s | 51.3 steps/s
[Step=25300 Epoch=97.4] | Loss=0.00044 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.574 | L2-Norm(final)=3.063 | 3647.3 samples/s | 57.0 steps/s
[Step=25350 Epoch=97.6] | Loss=0.00040 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.573 | L2-Norm(final)=3.063 | 1596.1 samples/s | 24.9 steps/s
[Step=25400 Epoch=97.8] | Loss=0.00037 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.571 | L2-Norm(final)=3.063 | 3327.4 samples/s | 52.0 steps/s
[Step=25450 Epoch=98.0] | Loss=0.00034 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.570 | L2-Norm(final)=3.063 | 3315.3 samples/s | 51.8 steps/s
[Step=25500 Epoch=98.2] | Loss=0.00032 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.569 | L2-Norm(final)=3.063 | 3301.8 samples/s | 51.6 steps/s
[Step=25550 Epoch=98.4] | Loss=0.00030 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.568 | L2-Norm(final)=3.064 | 3389.4 samples/s | 53.0 steps/s
[Step=25600 Epoch=98.5] | Loss=0.00028 | Reg=0.00309 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.566 | L2-Norm(final)=3.064 | 1672.4 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18251 | acc=0.8941 | tpr=0.8529 | fpr=0.0166 | 3635.7 samples/s | 14.2 steps/s
Avg test loss: 0.18593, Avg test acc: 0.89202, Avg tpr: 0.85172, Avg fpr: 0.01936, total FA: 151

Testing server on iccad2012
[Step=  50] | Loss=0.44462 | acc=0.8320 | tpr=0.9779 | fpr=0.1706 | 3628.3 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.44993 | acc=0.8319 | tpr=0.9765 | fpr=0.1708 | 6833.4 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.45451 | acc=0.8322 | tpr=0.9784 | fpr=0.1705 | 6736.2 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.45430 | acc=0.8330 | tpr=0.9781 | fpr=0.1696 | 6732.3 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.45420 | acc=0.8322 | tpr=0.9755 | fpr=0.1704 | 6953.3 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.45522 | acc=0.8321 | tpr=0.9767 | fpr=0.1705 | 6984.4 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.45842 | acc=0.8316 | tpr=0.9762 | fpr=0.1711 | 6785.5 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.45967 | acc=0.8314 | tpr=0.9743 | fpr=0.1712 | 7032.3 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.46254 | acc=0.8313 | tpr=0.9761 | fpr=0.1713 | 6579.6 samples/s | 25.7 steps/s
[Step= 500] | Loss=0.46229 | acc=0.8311 | tpr=0.9771 | fpr=0.1716 | 6634.2 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.45922 | acc=0.8317 | tpr=0.9761 | fpr=0.1709 | 12446.0 samples/s | 48.6 steps/s
Avg test loss: 0.45881, Avg test acc: 0.83178, Avg tpr: 0.97583, Avg fpr: 0.17083, total FA: 23720

server round 32/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=49.9] | Loss=0.14180 | Reg=0.00309 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=17.575 | L2-Norm(final)=3.084 | 3433.4 samples/s | 53.6 steps/s
[Step=25650 Epoch=50.0] | Loss=0.01687 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.553 | L2-Norm(final)=3.084 | 3471.3 samples/s | 54.2 steps/s
[Step=25700 Epoch=50.1] | Loss=0.01219 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.547 | L2-Norm(final)=3.086 | 3497.3 samples/s | 54.6 steps/s
[Step=25750 Epoch=50.2] | Loss=0.01052 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=3.087 | 3495.8 samples/s | 54.6 steps/s
[Step=25800 Epoch=50.3] | Loss=0.00975 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.541 | L2-Norm(final)=3.089 | 3475.8 samples/s | 54.3 steps/s
[Step=25850 Epoch=50.4] | Loss=0.00938 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.539 | L2-Norm(final)=3.090 | 3462.3 samples/s | 54.1 steps/s
[Step=25900 Epoch=50.5] | Loss=0.00885 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.538 | L2-Norm(final)=3.091 | 3498.7 samples/s | 54.7 steps/s
[Step=25950 Epoch=50.6] | Loss=0.00878 | Reg=0.00308 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.537 | L2-Norm(final)=3.092 | 3506.7 samples/s | 54.8 steps/s
[Step=26000 Epoch=50.7] | Loss=0.00839 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.536 | L2-Norm(final)=3.093 | 3494.3 samples/s | 54.6 steps/s
[Step=26050 Epoch=50.8] | Loss=0.00821 | Reg=0.00307 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.535 | L2-Norm(final)=3.094 | 3498.1 samples/s | 54.7 steps/s
[Step=26100 Epoch=50.9] | Loss=0.00810 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.535 | L2-Norm(final)=3.095 | 4076.8 samples/s | 63.7 steps/s
[Step=26150 Epoch=51.0] | Loss=0.00786 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.534 | L2-Norm(final)=3.097 | 1577.7 samples/s | 24.7 steps/s
[Step=26200 Epoch=51.1] | Loss=0.00769 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.534 | L2-Norm(final)=3.098 | 3463.0 samples/s | 54.1 steps/s
[Step=26250 Epoch=51.2] | Loss=0.00744 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.534 | L2-Norm(final)=3.099 | 3465.8 samples/s | 54.2 steps/s
[Step=26300 Epoch=51.3] | Loss=0.00725 | Reg=0.00307 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.534 | L2-Norm(final)=3.100 | 3437.4 samples/s | 53.7 steps/s
[Step=26350 Epoch=51.4] | Loss=0.00725 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.533 | L2-Norm(final)=3.101 | 3467.3 samples/s | 54.2 steps/s
[Step=26400 Epoch=51.5] | Loss=0.00713 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.533 | L2-Norm(final)=3.102 | 3480.9 samples/s | 54.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step26400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=50.0] | Loss=0.09412 | Reg=0.00309 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.575 | L2-Norm(final)=3.084 | 4093.5 samples/s | 64.0 steps/s
[Step=25650 Epoch=50.1] | Loss=0.01343 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.551 | L2-Norm(final)=3.085 | 3079.4 samples/s | 48.1 steps/s
[Step=25700 Epoch=50.2] | Loss=0.01054 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.545 | L2-Norm(final)=3.087 | 3436.1 samples/s | 53.7 steps/s
[Step=25750 Epoch=50.3] | Loss=0.00883 | Reg=0.00308 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.541 | L2-Norm(final)=3.089 | 3490.4 samples/s | 54.5 steps/s
[Step=25800 Epoch=50.4] | Loss=0.00839 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.539 | L2-Norm(final)=3.091 | 3485.1 samples/s | 54.5 steps/s
[Step=25850 Epoch=50.5] | Loss=0.00771 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.538 | L2-Norm(final)=3.093 | 3466.3 samples/s | 54.2 steps/s
[Step=25900 Epoch=50.6] | Loss=0.00755 | Reg=0.00308 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.537 | L2-Norm(final)=3.095 | 3452.8 samples/s | 54.0 steps/s
[Step=25950 Epoch=50.7] | Loss=0.00733 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.537 | L2-Norm(final)=3.097 | 3472.6 samples/s | 54.3 steps/s
[Step=26000 Epoch=50.8] | Loss=0.00744 | Reg=0.00308 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.536 | L2-Norm(final)=3.098 | 3482.5 samples/s | 54.4 steps/s
[Step=26050 Epoch=50.9] | Loss=0.00742 | Reg=0.00308 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.536 | L2-Norm(final)=3.100 | 3484.5 samples/s | 54.4 steps/s
[Step=26100 Epoch=51.0] | Loss=0.00728 | Reg=0.00308 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.536 | L2-Norm(final)=3.101 | 4090.7 samples/s | 63.9 steps/s
[Step=26150 Epoch=51.1] | Loss=0.00714 | Reg=0.00307 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.536 | L2-Norm(final)=3.103 | 1605.3 samples/s | 25.1 steps/s
[Step=26200 Epoch=51.2] | Loss=0.00694 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.536 | L2-Norm(final)=3.104 | 3459.8 samples/s | 54.1 steps/s
[Step=26250 Epoch=51.3] | Loss=0.00671 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.535 | L2-Norm(final)=3.106 | 3424.7 samples/s | 53.5 steps/s
[Step=26300 Epoch=51.4] | Loss=0.00668 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.535 | L2-Norm(final)=3.107 | 3441.3 samples/s | 53.8 steps/s
[Step=26350 Epoch=51.5] | Loss=0.00665 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.535 | L2-Norm(final)=3.108 | 3490.2 samples/s | 54.5 steps/s
[Step=26400 Epoch=51.6] | Loss=0.00664 | Reg=0.00307 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.535 | L2-Norm(final)=3.110 | 3498.8 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step26400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=98.1] | Loss=0.10889 | Reg=0.00309 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.575 | L2-Norm(final)=3.084 | 3730.7 samples/s | 58.3 steps/s
[Step=25650 Epoch=98.3] | Loss=0.00677 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.530 | L2-Norm(final)=3.086 | 3080.4 samples/s | 48.1 steps/s
[Step=25700 Epoch=98.5] | Loss=0.00344 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.523 | L2-Norm(final)=3.086 | 3294.6 samples/s | 51.5 steps/s
[Step=25750 Epoch=98.7] | Loss=0.00230 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.519 | L2-Norm(final)=3.086 | 3326.6 samples/s | 52.0 steps/s
[Step=25800 Epoch=98.9] | Loss=0.00174 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.516 | L2-Norm(final)=3.086 | 3305.1 samples/s | 51.6 steps/s
[Step=25850 Epoch=99.0] | Loss=0.00140 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.513 | L2-Norm(final)=3.086 | 3962.4 samples/s | 61.9 steps/s
[Step=25900 Epoch=99.2] | Loss=0.00117 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.510 | L2-Norm(final)=3.087 | 1554.2 samples/s | 24.3 steps/s
[Step=25950 Epoch=99.4] | Loss=0.00100 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.508 | L2-Norm(final)=3.087 | 3305.5 samples/s | 51.6 steps/s
[Step=26000 Epoch=99.6] | Loss=0.00088 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.506 | L2-Norm(final)=3.087 | 3327.1 samples/s | 52.0 steps/s
[Step=26050 Epoch=99.8] | Loss=0.00078 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.504 | L2-Norm(final)=3.087 | 3336.3 samples/s | 52.1 steps/s
[Step=26100 Epoch=100.0] | Loss=0.00071 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.503 | L2-Norm(final)=3.087 | 3594.9 samples/s | 56.2 steps/s
[Step=26150 Epoch=100.2] | Loss=0.00064 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.501 | L2-Norm(final)=3.087 | 1628.9 samples/s | 25.5 steps/s
[Step=26200 Epoch=100.4] | Loss=0.00059 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.500 | L2-Norm(final)=3.087 | 3312.0 samples/s | 51.8 steps/s
[Step=26250 Epoch=100.6] | Loss=0.00055 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.498 | L2-Norm(final)=3.087 | 3314.6 samples/s | 51.8 steps/s
[Step=26300 Epoch=100.8] | Loss=0.00051 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.497 | L2-Norm(final)=3.087 | 3289.9 samples/s | 51.4 steps/s
[Step=26350 Epoch=101.0] | Loss=0.00048 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.496 | L2-Norm(final)=3.087 | 3293.7 samples/s | 51.5 steps/s
[Step=26400 Epoch=101.2] | Loss=0.00045 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.495 | L2-Norm(final)=3.087 | 1666.4 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step26400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=98.5] | Loss=0.08745 | Reg=0.00309 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.575 | L2-Norm(final)=3.084 | 3777.2 samples/s | 59.0 steps/s
[Step=25650 Epoch=98.7] | Loss=0.00498 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.528 | L2-Norm(final)=3.087 | 3060.6 samples/s | 47.8 steps/s
[Step=25700 Epoch=98.9] | Loss=0.00250 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.521 | L2-Norm(final)=3.088 | 3292.8 samples/s | 51.5 steps/s
[Step=25750 Epoch=99.1] | Loss=0.00167 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.517 | L2-Norm(final)=3.088 | 3288.0 samples/s | 51.4 steps/s
[Step=25800 Epoch=99.3] | Loss=0.00126 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.513 | L2-Norm(final)=3.088 | 3311.6 samples/s | 51.7 steps/s
[Step=25850 Epoch=99.5] | Loss=0.00101 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.510 | L2-Norm(final)=3.088 | 4013.9 samples/s | 62.7 steps/s
[Step=25900 Epoch=99.7] | Loss=0.00084 | Reg=0.00307 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.508 | L2-Norm(final)=3.088 | 1540.6 samples/s | 24.1 steps/s
[Step=25950 Epoch=99.9] | Loss=0.00072 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.505 | L2-Norm(final)=3.088 | 3281.6 samples/s | 51.3 steps/s
[Step=26000 Epoch=100.1] | Loss=0.00064 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.503 | L2-Norm(final)=3.088 | 3307.9 samples/s | 51.7 steps/s
[Step=26050 Epoch=100.3] | Loss=0.00057 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.502 | L2-Norm(final)=3.088 | 3320.1 samples/s | 51.9 steps/s
[Step=26100 Epoch=100.5] | Loss=0.00051 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.500 | L2-Norm(final)=3.088 | 3628.1 samples/s | 56.7 steps/s
[Step=26150 Epoch=100.7] | Loss=0.00047 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.498 | L2-Norm(final)=3.088 | 1606.4 samples/s | 25.1 steps/s
[Step=26200 Epoch=100.9] | Loss=0.00043 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.497 | L2-Norm(final)=3.088 | 3340.3 samples/s | 52.2 steps/s
[Step=26250 Epoch=101.0] | Loss=0.00040 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.495 | L2-Norm(final)=3.088 | 3288.0 samples/s | 51.4 steps/s
[Step=26300 Epoch=101.2] | Loss=0.00037 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.494 | L2-Norm(final)=3.088 | 3317.6 samples/s | 51.8 steps/s
[Step=26350 Epoch=101.4] | Loss=0.00035 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.493 | L2-Norm(final)=3.088 | 3367.5 samples/s | 52.6 steps/s
[Step=26400 Epoch=101.6] | Loss=0.00032 | Reg=0.00306 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.491 | L2-Norm(final)=3.088 | 1660.9 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20444 | acc=0.8827 | tpr=0.8366 | fpr=0.0173 | 3642.6 samples/s | 14.2 steps/s
Avg test loss: 0.20700, Avg test acc: 0.88016, Avg tpr: 0.83459, Avg fpr: 0.01961, total FA: 153

Testing server on iccad2012
[Step=  50] | Loss=0.39868 | acc=0.8555 | tpr=0.9779 | fpr=0.1467 | 3637.7 samples/s | 14.2 steps/s
[Step= 100] | Loss=0.40424 | acc=0.8567 | tpr=0.9787 | fpr=0.1456 | 6812.0 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.40936 | acc=0.8569 | tpr=0.9798 | fpr=0.1454 | 6855.0 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.40952 | acc=0.8577 | tpr=0.9792 | fpr=0.1445 | 6864.3 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.40925 | acc=0.8565 | tpr=0.9764 | fpr=0.1456 | 6637.9 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.41098 | acc=0.8567 | tpr=0.9775 | fpr=0.1455 | 7071.0 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.41418 | acc=0.8561 | tpr=0.9768 | fpr=0.1461 | 6687.4 samples/s | 26.1 steps/s
[Step= 400] | Loss=0.41527 | acc=0.8555 | tpr=0.9743 | fpr=0.1467 | 7267.6 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.41844 | acc=0.8553 | tpr=0.9761 | fpr=0.1469 | 6219.5 samples/s | 24.3 steps/s
[Step= 500] | Loss=0.41792 | acc=0.8549 | tpr=0.9767 | fpr=0.1473 | 6628.9 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.41513 | acc=0.8555 | tpr=0.9761 | fpr=0.1467 | 13035.7 samples/s | 50.9 steps/s
Avg test loss: 0.41470, Avg test acc: 0.85552, Avg tpr: 0.97583, Avg fpr: 0.14666, total FA: 20364

server round 33/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=51.5] | Loss=0.04585 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.498 | L2-Norm(final)=3.106 | 3438.4 samples/s | 53.7 steps/s
[Step=26450 Epoch=51.6] | Loss=0.01693 | Reg=0.00305 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.478 | L2-Norm(final)=3.106 | 3346.6 samples/s | 52.3 steps/s
[Step=26500 Epoch=51.7] | Loss=0.01345 | Reg=0.00305 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.472 | L2-Norm(final)=3.108 | 3069.2 samples/s | 48.0 steps/s
[Step=26550 Epoch=51.8] | Loss=0.01175 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.469 | L2-Norm(final)=3.109 | 3039.3 samples/s | 47.5 steps/s
[Step=26600 Epoch=51.9] | Loss=0.01020 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.466 | L2-Norm(final)=3.110 | 3182.1 samples/s | 49.7 steps/s
[Step=26650 Epoch=52.0] | Loss=0.00944 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.465 | L2-Norm(final)=3.112 | 3449.8 samples/s | 53.9 steps/s
[Step=26700 Epoch=52.1] | Loss=0.00869 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.464 | L2-Norm(final)=3.113 | 3366.3 samples/s | 52.6 steps/s
[Step=26750 Epoch=52.2] | Loss=0.00805 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.463 | L2-Norm(final)=3.115 | 3377.3 samples/s | 52.8 steps/s
[Step=26800 Epoch=52.3] | Loss=0.00792 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.462 | L2-Norm(final)=3.117 | 3369.6 samples/s | 52.7 steps/s
[Step=26850 Epoch=52.4] | Loss=0.00793 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.462 | L2-Norm(final)=3.118 | 3459.7 samples/s | 54.1 steps/s
[Step=26900 Epoch=52.5] | Loss=0.00767 | Reg=0.00305 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.462 | L2-Norm(final)=3.119 | 4007.7 samples/s | 62.6 steps/s
[Step=26950 Epoch=52.6] | Loss=0.00765 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.461 | L2-Norm(final)=3.121 | 1569.7 samples/s | 24.5 steps/s
[Step=27000 Epoch=52.7] | Loss=0.00744 | Reg=0.00305 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.461 | L2-Norm(final)=3.122 | 3441.3 samples/s | 53.8 steps/s
[Step=27050 Epoch=52.8] | Loss=0.00742 | Reg=0.00305 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.461 | L2-Norm(final)=3.123 | 3379.3 samples/s | 52.8 steps/s
[Step=27100 Epoch=52.9] | Loss=0.00719 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.460 | L2-Norm(final)=3.124 | 3447.1 samples/s | 53.9 steps/s
[Step=27150 Epoch=53.0] | Loss=0.00706 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.460 | L2-Norm(final)=3.125 | 3466.4 samples/s | 54.2 steps/s
[Step=27200 Epoch=53.1] | Loss=0.00700 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.460 | L2-Norm(final)=3.126 | 3460.2 samples/s | 54.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step27200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=51.6] | Loss=0.06236 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.498 | L2-Norm(final)=3.106 | 3731.8 samples/s | 58.3 steps/s
[Step=26450 Epoch=51.7] | Loss=0.01745 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.478 | L2-Norm(final)=3.104 | 3296.5 samples/s | 51.5 steps/s
[Step=26500 Epoch=51.8] | Loss=0.01232 | Reg=0.00305 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.472 | L2-Norm(final)=3.105 | 3430.5 samples/s | 53.6 steps/s
[Step=26550 Epoch=51.9] | Loss=0.01073 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.468 | L2-Norm(final)=3.107 | 3517.0 samples/s | 55.0 steps/s
[Step=26600 Epoch=52.0] | Loss=0.00977 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.466 | L2-Norm(final)=3.108 | 3476.2 samples/s | 54.3 steps/s
[Step=26650 Epoch=52.1] | Loss=0.00925 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.465 | L2-Norm(final)=3.110 | 3480.1 samples/s | 54.4 steps/s
[Step=26700 Epoch=52.2] | Loss=0.00891 | Reg=0.00305 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.464 | L2-Norm(final)=3.111 | 3486.5 samples/s | 54.5 steps/s
[Step=26750 Epoch=52.3] | Loss=0.00873 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.463 | L2-Norm(final)=3.113 | 3474.6 samples/s | 54.3 steps/s
[Step=26800 Epoch=52.4] | Loss=0.00836 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.462 | L2-Norm(final)=3.114 | 3476.7 samples/s | 54.3 steps/s
[Step=26850 Epoch=52.5] | Loss=0.00812 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.462 | L2-Norm(final)=3.115 | 3470.9 samples/s | 54.2 steps/s
[Step=26900 Epoch=52.6] | Loss=0.00795 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.462 | L2-Norm(final)=3.117 | 4092.7 samples/s | 63.9 steps/s
[Step=26950 Epoch=52.7] | Loss=0.00765 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.462 | L2-Norm(final)=3.118 | 1523.5 samples/s | 23.8 steps/s
[Step=27000 Epoch=52.8] | Loss=0.00745 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.462 | L2-Norm(final)=3.120 | 3208.6 samples/s | 50.1 steps/s
[Step=27050 Epoch=52.9] | Loss=0.00731 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.462 | L2-Norm(final)=3.121 | 3336.8 samples/s | 52.1 steps/s
[Step=27100 Epoch=53.0] | Loss=0.00720 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.461 | L2-Norm(final)=3.122 | 3378.1 samples/s | 52.8 steps/s
[Step=27150 Epoch=53.1] | Loss=0.00714 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.461 | L2-Norm(final)=3.123 | 3412.8 samples/s | 53.3 steps/s
[Step=27200 Epoch=53.2] | Loss=0.00705 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.461 | L2-Norm(final)=3.124 | 3451.8 samples/s | 53.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step27200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=101.2] | Loss=0.06204 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.498 | L2-Norm(final)=3.106 | 3457.9 samples/s | 54.0 steps/s
[Step=26450 Epoch=101.3] | Loss=0.00476 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.449 | L2-Norm(final)=3.107 | 3305.7 samples/s | 51.7 steps/s
[Step=26500 Epoch=101.5] | Loss=0.00244 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.442 | L2-Norm(final)=3.107 | 3302.5 samples/s | 51.6 steps/s
[Step=26550 Epoch=101.7] | Loss=0.00164 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.438 | L2-Norm(final)=3.107 | 3293.6 samples/s | 51.5 steps/s
[Step=26600 Epoch=101.9] | Loss=0.00124 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.435 | L2-Norm(final)=3.108 | 3290.6 samples/s | 51.4 steps/s
[Step=26650 Epoch=102.1] | Loss=0.00101 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.433 | L2-Norm(final)=3.108 | 3933.9 samples/s | 61.5 steps/s
[Step=26700 Epoch=102.3] | Loss=0.00084 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.430 | L2-Norm(final)=3.108 | 1451.9 samples/s | 22.7 steps/s
[Step=26750 Epoch=102.5] | Loss=0.00073 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.429 | L2-Norm(final)=3.109 | 3087.5 samples/s | 48.2 steps/s
[Step=26800 Epoch=102.7] | Loss=0.00064 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.427 | L2-Norm(final)=3.109 | 2982.7 samples/s | 46.6 steps/s
[Step=26850 Epoch=102.9] | Loss=0.00057 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.425 | L2-Norm(final)=3.109 | 3282.9 samples/s | 51.3 steps/s
[Step=26900 Epoch=103.1] | Loss=0.00052 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.424 | L2-Norm(final)=3.109 | 3583.3 samples/s | 56.0 steps/s
[Step=26950 Epoch=103.3] | Loss=0.00047 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.422 | L2-Norm(final)=3.109 | 1582.6 samples/s | 24.7 steps/s
[Step=27000 Epoch=103.5] | Loss=0.00043 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.421 | L2-Norm(final)=3.109 | 3302.3 samples/s | 51.6 steps/s
[Step=27050 Epoch=103.6] | Loss=0.00040 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.420 | L2-Norm(final)=3.110 | 3330.8 samples/s | 52.0 steps/s
[Step=27100 Epoch=103.8] | Loss=0.00037 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.419 | L2-Norm(final)=3.110 | 3323.8 samples/s | 51.9 steps/s
[Step=27150 Epoch=104.0] | Loss=0.00035 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.418 | L2-Norm(final)=3.110 | 3314.1 samples/s | 51.8 steps/s
[Step=27200 Epoch=104.2] | Loss=0.00033 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.417 | L2-Norm(final)=3.110 | 1679.5 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step27200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=101.6] | Loss=0.11122 | Reg=0.00306 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.498 | L2-Norm(final)=3.106 | 3768.9 samples/s | 58.9 steps/s
[Step=26450 Epoch=101.8] | Loss=0.00623 | Reg=0.00305 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.455 | L2-Norm(final)=3.107 | 2994.8 samples/s | 46.8 steps/s
[Step=26500 Epoch=102.0] | Loss=0.00313 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.448 | L2-Norm(final)=3.107 | 3295.0 samples/s | 51.5 steps/s
[Step=26550 Epoch=102.2] | Loss=0.00210 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.444 | L2-Norm(final)=3.107 | 3299.2 samples/s | 51.5 steps/s
[Step=26600 Epoch=102.4] | Loss=0.00158 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.440 | L2-Norm(final)=3.107 | 3299.0 samples/s | 51.5 steps/s
[Step=26650 Epoch=102.6] | Loss=0.00127 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.437 | L2-Norm(final)=3.107 | 3982.3 samples/s | 62.2 steps/s
[Step=26700 Epoch=102.8] | Loss=0.00106 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.435 | L2-Norm(final)=3.107 | 1544.1 samples/s | 24.1 steps/s
[Step=26750 Epoch=103.0] | Loss=0.00091 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.433 | L2-Norm(final)=3.107 | 3312.5 samples/s | 51.8 steps/s
[Step=26800 Epoch=103.2] | Loss=0.00080 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.431 | L2-Norm(final)=3.107 | 3297.3 samples/s | 51.5 steps/s
[Step=26850 Epoch=103.4] | Loss=0.00072 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.429 | L2-Norm(final)=3.108 | 3329.3 samples/s | 52.0 steps/s
[Step=26900 Epoch=103.5] | Loss=0.00065 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.428 | L2-Norm(final)=3.108 | 3678.3 samples/s | 57.5 steps/s
[Step=26950 Epoch=103.7] | Loss=0.00059 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.426 | L2-Norm(final)=3.108 | 1601.9 samples/s | 25.0 steps/s
[Step=27000 Epoch=103.9] | Loss=0.00054 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.425 | L2-Norm(final)=3.108 | 3293.0 samples/s | 51.5 steps/s
[Step=27050 Epoch=104.1] | Loss=0.00050 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.423 | L2-Norm(final)=3.108 | 3316.2 samples/s | 51.8 steps/s
[Step=27100 Epoch=104.3] | Loss=0.00047 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.422 | L2-Norm(final)=3.108 | 3322.1 samples/s | 51.9 steps/s
[Step=27150 Epoch=104.5] | Loss=0.00044 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.421 | L2-Norm(final)=3.108 | 3387.5 samples/s | 52.9 steps/s
[Step=27200 Epoch=104.7] | Loss=0.00041 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.419 | L2-Norm(final)=3.108 | 1675.1 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17989 | acc=0.8962 | tpr=0.8566 | fpr=0.0178 | 3690.6 samples/s | 14.4 steps/s
Avg test loss: 0.18222, Avg test acc: 0.89386, Avg tpr: 0.85481, Avg fpr: 0.02025, total FA: 158

Testing server on iccad2012
[Step=  50] | Loss=0.43318 | acc=0.8427 | tpr=0.9823 | fpr=0.1598 | 3680.6 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.43904 | acc=0.8427 | tpr=0.9787 | fpr=0.1599 | 6759.1 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.44393 | acc=0.8424 | tpr=0.9798 | fpr=0.1601 | 6891.4 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.44412 | acc=0.8436 | tpr=0.9792 | fpr=0.1589 | 6812.5 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.44394 | acc=0.8418 | tpr=0.9773 | fpr=0.1607 | 6881.2 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.44556 | acc=0.8416 | tpr=0.9782 | fpr=0.1609 | 6790.7 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.44892 | acc=0.8412 | tpr=0.9775 | fpr=0.1613 | 6879.3 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.45011 | acc=0.8408 | tpr=0.9748 | fpr=0.1616 | 6978.5 samples/s | 27.3 steps/s
[Step= 450] | Loss=0.45338 | acc=0.8410 | tpr=0.9766 | fpr=0.1615 | 6696.5 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.45284 | acc=0.8407 | tpr=0.9771 | fpr=0.1618 | 6565.6 samples/s | 25.6 steps/s
[Step= 550] | Loss=0.44991 | acc=0.8414 | tpr=0.9765 | fpr=0.1611 | 12564.5 samples/s | 49.1 steps/s
Avg test loss: 0.44947, Avg test acc: 0.84147, Avg tpr: 0.97623, Avg fpr: 0.16097, total FA: 22351

server round 34/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=53.1] | Loss=0.12683 | Reg=0.00304 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.424 | L2-Norm(final)=3.126 | 3304.4 samples/s | 51.6 steps/s
[Step=27250 Epoch=53.1] | Loss=0.01855 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.404 | L2-Norm(final)=3.124 | 3425.6 samples/s | 53.5 steps/s
[Step=27300 Epoch=53.2] | Loss=0.01256 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.399 | L2-Norm(final)=3.125 | 3490.7 samples/s | 54.5 steps/s
[Step=27350 Epoch=53.3] | Loss=0.01084 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.396 | L2-Norm(final)=3.126 | 3477.1 samples/s | 54.3 steps/s
[Step=27400 Epoch=53.4] | Loss=0.00977 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.393 | L2-Norm(final)=3.127 | 3480.8 samples/s | 54.4 steps/s
[Step=27450 Epoch=53.5] | Loss=0.00929 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.392 | L2-Norm(final)=3.129 | 3493.8 samples/s | 54.6 steps/s
[Step=27500 Epoch=53.6] | Loss=0.00891 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.390 | L2-Norm(final)=3.130 | 3499.0 samples/s | 54.7 steps/s
[Step=27550 Epoch=53.7] | Loss=0.00848 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.389 | L2-Norm(final)=3.131 | 3436.0 samples/s | 53.7 steps/s
[Step=27600 Epoch=53.8] | Loss=0.00812 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.389 | L2-Norm(final)=3.132 | 3449.6 samples/s | 53.9 steps/s
[Step=27650 Epoch=53.9] | Loss=0.00807 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.388 | L2-Norm(final)=3.133 | 3476.9 samples/s | 54.3 steps/s
[Step=27700 Epoch=54.0] | Loss=0.00809 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.387 | L2-Norm(final)=3.134 | 4064.5 samples/s | 63.5 steps/s
[Step=27750 Epoch=54.1] | Loss=0.00788 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.387 | L2-Norm(final)=3.135 | 1491.7 samples/s | 23.3 steps/s
[Step=27800 Epoch=54.2] | Loss=0.00766 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.387 | L2-Norm(final)=3.137 | 3184.4 samples/s | 49.8 steps/s
[Step=27850 Epoch=54.3] | Loss=0.00755 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.386 | L2-Norm(final)=3.138 | 3223.7 samples/s | 50.4 steps/s
[Step=27900 Epoch=54.4] | Loss=0.00742 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.386 | L2-Norm(final)=3.139 | 3185.8 samples/s | 49.8 steps/s
[Step=27950 Epoch=54.5] | Loss=0.00743 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.386 | L2-Norm(final)=3.140 | 3262.7 samples/s | 51.0 steps/s
[Step=28000 Epoch=54.6] | Loss=0.00732 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.386 | L2-Norm(final)=3.141 | 3387.5 samples/s | 52.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step28000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=53.2] | Loss=0.14986 | Reg=0.00304 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=17.424 | L2-Norm(final)=3.126 | 3730.7 samples/s | 58.3 steps/s
[Step=27250 Epoch=53.3] | Loss=0.01866 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.404 | L2-Norm(final)=3.126 | 3254.3 samples/s | 50.8 steps/s
[Step=27300 Epoch=53.4] | Loss=0.01261 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.399 | L2-Norm(final)=3.127 | 3471.9 samples/s | 54.2 steps/s
[Step=27350 Epoch=53.5] | Loss=0.01119 | Reg=0.00303 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.395 | L2-Norm(final)=3.129 | 3485.0 samples/s | 54.5 steps/s
[Step=27400 Epoch=53.6] | Loss=0.01057 | Reg=0.00303 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.393 | L2-Norm(final)=3.130 | 3493.4 samples/s | 54.6 steps/s
[Step=27450 Epoch=53.7] | Loss=0.00962 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.392 | L2-Norm(final)=3.131 | 3494.3 samples/s | 54.6 steps/s
[Step=27500 Epoch=53.8] | Loss=0.00919 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.391 | L2-Norm(final)=3.132 | 3491.1 samples/s | 54.5 steps/s
[Step=27550 Epoch=53.9] | Loss=0.00873 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.390 | L2-Norm(final)=3.133 | 3456.6 samples/s | 54.0 steps/s
[Step=27600 Epoch=54.0] | Loss=0.00868 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.389 | L2-Norm(final)=3.135 | 3501.0 samples/s | 54.7 steps/s
[Step=27650 Epoch=54.1] | Loss=0.00819 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.389 | L2-Norm(final)=3.136 | 3495.5 samples/s | 54.6 steps/s
[Step=27700 Epoch=54.2] | Loss=0.00803 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.389 | L2-Norm(final)=3.137 | 4062.5 samples/s | 63.5 steps/s
[Step=27750 Epoch=54.3] | Loss=0.00776 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.388 | L2-Norm(final)=3.138 | 1610.8 samples/s | 25.2 steps/s
[Step=27800 Epoch=54.3] | Loss=0.00750 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.388 | L2-Norm(final)=3.139 | 3475.0 samples/s | 54.3 steps/s
[Step=27850 Epoch=54.4] | Loss=0.00723 | Reg=0.00302 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.388 | L2-Norm(final)=3.140 | 3478.3 samples/s | 54.3 steps/s
[Step=27900 Epoch=54.5] | Loss=0.00711 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.388 | L2-Norm(final)=3.142 | 3463.5 samples/s | 54.1 steps/s
[Step=27950 Epoch=54.6] | Loss=0.00700 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.387 | L2-Norm(final)=3.143 | 3491.1 samples/s | 54.5 steps/s
[Step=28000 Epoch=54.7] | Loss=0.00694 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.387 | L2-Norm(final)=3.144 | 3469.0 samples/s | 54.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step28000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=104.2] | Loss=0.07473 | Reg=0.00304 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.424 | L2-Norm(final)=3.126 | 3684.8 samples/s | 57.6 steps/s
[Step=27250 Epoch=104.4] | Loss=0.00534 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.383 | L2-Norm(final)=3.129 | 3107.3 samples/s | 48.6 steps/s
[Step=27300 Epoch=104.6] | Loss=0.00269 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.377 | L2-Norm(final)=3.129 | 3311.2 samples/s | 51.7 steps/s
[Step=27350 Epoch=104.8] | Loss=0.00181 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.372 | L2-Norm(final)=3.130 | 3296.1 samples/s | 51.5 steps/s
[Step=27400 Epoch=105.0] | Loss=0.00136 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.368 | L2-Norm(final)=3.130 | 3328.1 samples/s | 52.0 steps/s
[Step=27450 Epoch=105.2] | Loss=0.00110 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.365 | L2-Norm(final)=3.130 | 3971.9 samples/s | 62.1 steps/s
[Step=27500 Epoch=105.4] | Loss=0.00092 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.363 | L2-Norm(final)=3.130 | 1564.2 samples/s | 24.4 steps/s
[Step=27550 Epoch=105.6] | Loss=0.00079 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.360 | L2-Norm(final)=3.130 | 3294.9 samples/s | 51.5 steps/s
[Step=27600 Epoch=105.8] | Loss=0.00070 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.358 | L2-Norm(final)=3.130 | 3315.1 samples/s | 51.8 steps/s
[Step=27650 Epoch=105.9] | Loss=0.00062 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.357 | L2-Norm(final)=3.130 | 3303.3 samples/s | 51.6 steps/s
[Step=27700 Epoch=106.1] | Loss=0.00056 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.355 | L2-Norm(final)=3.130 | 3566.3 samples/s | 55.7 steps/s
[Step=27750 Epoch=106.3] | Loss=0.00051 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.353 | L2-Norm(final)=3.130 | 1626.1 samples/s | 25.4 steps/s
[Step=27800 Epoch=106.5] | Loss=0.00047 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.352 | L2-Norm(final)=3.130 | 3302.4 samples/s | 51.6 steps/s
[Step=27850 Epoch=106.7] | Loss=0.00043 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.350 | L2-Norm(final)=3.130 | 3313.4 samples/s | 51.8 steps/s
[Step=27900 Epoch=106.9] | Loss=0.00040 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.349 | L2-Norm(final)=3.130 | 3295.9 samples/s | 51.5 steps/s
[Step=27950 Epoch=107.1] | Loss=0.00038 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.348 | L2-Norm(final)=3.130 | 3279.2 samples/s | 51.2 steps/s
[Step=28000 Epoch=107.3] | Loss=0.00036 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.346 | L2-Norm(final)=3.130 | 1677.5 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step28000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=104.7] | Loss=0.01299 | Reg=0.00304 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.424 | L2-Norm(final)=3.126 | 3749.2 samples/s | 58.6 steps/s
[Step=27250 Epoch=104.9] | Loss=0.00464 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.376 | L2-Norm(final)=3.127 | 3090.1 samples/s | 48.3 steps/s
[Step=27300 Epoch=105.1] | Loss=0.00234 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.368 | L2-Norm(final)=3.128 | 3327.8 samples/s | 52.0 steps/s
[Step=27350 Epoch=105.3] | Loss=0.00157 | Reg=0.00302 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.364 | L2-Norm(final)=3.128 | 3297.9 samples/s | 51.5 steps/s
[Step=27400 Epoch=105.5] | Loss=0.00119 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.361 | L2-Norm(final)=3.128 | 3299.1 samples/s | 51.5 steps/s
[Step=27450 Epoch=105.7] | Loss=0.00095 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.358 | L2-Norm(final)=3.129 | 4029.5 samples/s | 63.0 steps/s
[Step=27500 Epoch=105.9] | Loss=0.00080 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.356 | L2-Norm(final)=3.129 | 1534.5 samples/s | 24.0 steps/s
[Step=27550 Epoch=106.1] | Loss=0.00069 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.353 | L2-Norm(final)=3.129 | 3303.3 samples/s | 51.6 steps/s
[Step=27600 Epoch=106.2] | Loss=0.00060 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.352 | L2-Norm(final)=3.129 | 3309.3 samples/s | 51.7 steps/s
[Step=27650 Epoch=106.4] | Loss=0.00054 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.350 | L2-Norm(final)=3.129 | 3305.4 samples/s | 51.6 steps/s
[Step=27700 Epoch=106.6] | Loss=0.00049 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.348 | L2-Norm(final)=3.129 | 3667.9 samples/s | 57.3 steps/s
[Step=27750 Epoch=106.8] | Loss=0.00044 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.347 | L2-Norm(final)=3.129 | 1612.7 samples/s | 25.2 steps/s
[Step=27800 Epoch=107.0] | Loss=0.00041 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.345 | L2-Norm(final)=3.130 | 3314.2 samples/s | 51.8 steps/s
[Step=27850 Epoch=107.2] | Loss=0.00038 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.344 | L2-Norm(final)=3.130 | 3298.0 samples/s | 51.5 steps/s
[Step=27900 Epoch=107.4] | Loss=0.00035 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.343 | L2-Norm(final)=3.130 | 3305.5 samples/s | 51.6 steps/s
[Step=27950 Epoch=107.6] | Loss=0.00033 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.342 | L2-Norm(final)=3.130 | 3366.6 samples/s | 52.6 steps/s
[Step=28000 Epoch=107.8] | Loss=0.00031 | Reg=0.00301 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.341 | L2-Norm(final)=3.130 | 1663.7 samples/s | 26.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18392 | acc=0.8946 | tpr=0.8541 | fpr=0.0173 | 3656.1 samples/s | 14.3 steps/s
Avg test loss: 0.18567, Avg test acc: 0.89214, Avg tpr: 0.85219, Avg fpr: 0.02000, total FA: 156

Testing server on iccad2012
[Step=  50] | Loss=0.42530 | acc=0.8486 | tpr=0.9779 | fpr=0.1537 | 3668.0 samples/s | 14.3 steps/s
[Step= 100] | Loss=0.43125 | acc=0.8496 | tpr=0.9765 | fpr=0.1528 | 6752.9 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.43593 | acc=0.8493 | tpr=0.9798 | fpr=0.1531 | 6796.2 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.43642 | acc=0.8503 | tpr=0.9803 | fpr=0.1520 | 6684.0 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.43598 | acc=0.8488 | tpr=0.9773 | fpr=0.1536 | 6863.9 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.43776 | acc=0.8487 | tpr=0.9782 | fpr=0.1537 | 7039.2 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.44118 | acc=0.8479 | tpr=0.9775 | fpr=0.1544 | 6894.0 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.44243 | acc=0.8475 | tpr=0.9748 | fpr=0.1549 | 6568.8 samples/s | 25.7 steps/s
[Step= 450] | Loss=0.44579 | acc=0.8474 | tpr=0.9766 | fpr=0.1549 | 6754.0 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.44529 | acc=0.8472 | tpr=0.9771 | fpr=0.1551 | 6726.4 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.44248 | acc=0.8479 | tpr=0.9765 | fpr=0.1545 | 12553.9 samples/s | 49.0 steps/s
Avg test loss: 0.44206, Avg test acc: 0.84790, Avg tpr: 0.97623, Avg fpr: 0.15444, total FA: 21443

server round 35/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=54.6] | Loss=0.02437 | Reg=0.00301 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.349 | L2-Norm(final)=3.144 | 3619.9 samples/s | 56.6 steps/s
[Step=28050 Epoch=54.7] | Loss=0.01256 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.325 | L2-Norm(final)=3.146 | 3234.1 samples/s | 50.5 steps/s
[Step=28100 Epoch=54.8] | Loss=0.00956 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.320 | L2-Norm(final)=3.148 | 3460.1 samples/s | 54.1 steps/s
[Step=28150 Epoch=54.9] | Loss=0.00884 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.318 | L2-Norm(final)=3.150 | 3429.6 samples/s | 53.6 steps/s
[Step=28200 Epoch=55.0] | Loss=0.00828 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.316 | L2-Norm(final)=3.152 | 3459.6 samples/s | 54.1 steps/s
[Step=28250 Epoch=55.1] | Loss=0.00827 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.315 | L2-Norm(final)=3.154 | 3494.8 samples/s | 54.6 steps/s
[Step=28300 Epoch=55.2] | Loss=0.00838 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.314 | L2-Norm(final)=3.155 | 3497.3 samples/s | 54.6 steps/s
[Step=28350 Epoch=55.3] | Loss=0.00800 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.313 | L2-Norm(final)=3.156 | 3460.7 samples/s | 54.1 steps/s
[Step=28400 Epoch=55.4] | Loss=0.00762 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.313 | L2-Norm(final)=3.157 | 3470.8 samples/s | 54.2 steps/s
[Step=28450 Epoch=55.5] | Loss=0.00749 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.312 | L2-Norm(final)=3.158 | 3464.6 samples/s | 54.1 steps/s
[Step=28500 Epoch=55.6] | Loss=0.00748 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.312 | L2-Norm(final)=3.159 | 4036.6 samples/s | 63.1 steps/s
[Step=28550 Epoch=55.7] | Loss=0.00735 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.312 | L2-Norm(final)=3.160 | 1585.1 samples/s | 24.8 steps/s
[Step=28600 Epoch=55.8] | Loss=0.00709 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.311 | L2-Norm(final)=3.161 | 3461.7 samples/s | 54.1 steps/s
[Step=28650 Epoch=55.9] | Loss=0.00696 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.311 | L2-Norm(final)=3.162 | 3474.0 samples/s | 54.3 steps/s
[Step=28700 Epoch=56.0] | Loss=0.00692 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.311 | L2-Norm(final)=3.163 | 3485.0 samples/s | 54.5 steps/s
[Step=28750 Epoch=56.1] | Loss=0.00675 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.311 | L2-Norm(final)=3.164 | 3486.0 samples/s | 54.5 steps/s
[Step=28800 Epoch=56.2] | Loss=0.00661 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.311 | L2-Norm(final)=3.165 | 3496.4 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step28800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=54.7] | Loss=0.01080 | Reg=0.00301 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.349 | L2-Norm(final)=3.144 | 3681.0 samples/s | 57.5 steps/s
[Step=28050 Epoch=54.8] | Loss=0.01545 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.329 | L2-Norm(final)=3.144 | 3382.1 samples/s | 52.8 steps/s
[Step=28100 Epoch=54.9] | Loss=0.01073 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.323 | L2-Norm(final)=3.146 | 3465.3 samples/s | 54.1 steps/s
[Step=28150 Epoch=55.0] | Loss=0.00895 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.320 | L2-Norm(final)=3.147 | 3456.9 samples/s | 54.0 steps/s
[Step=28200 Epoch=55.1] | Loss=0.00818 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.319 | L2-Norm(final)=3.149 | 3408.6 samples/s | 53.3 steps/s
[Step=28250 Epoch=55.2] | Loss=0.00769 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.317 | L2-Norm(final)=3.151 | 3475.3 samples/s | 54.3 steps/s
[Step=28300 Epoch=55.3] | Loss=0.00750 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.317 | L2-Norm(final)=3.153 | 3481.2 samples/s | 54.4 steps/s
[Step=28350 Epoch=55.4] | Loss=0.00764 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.316 | L2-Norm(final)=3.154 | 3494.3 samples/s | 54.6 steps/s
[Step=28400 Epoch=55.5] | Loss=0.00738 | Reg=0.00300 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.316 | L2-Norm(final)=3.155 | 3487.0 samples/s | 54.5 steps/s
[Step=28450 Epoch=55.6] | Loss=0.00729 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.315 | L2-Norm(final)=3.157 | 3475.2 samples/s | 54.3 steps/s
[Step=28500 Epoch=55.7] | Loss=0.00732 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.315 | L2-Norm(final)=3.158 | 4083.5 samples/s | 63.8 steps/s
[Step=28550 Epoch=55.8] | Loss=0.00703 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.314 | L2-Norm(final)=3.159 | 1605.8 samples/s | 25.1 steps/s
[Step=28600 Epoch=55.9] | Loss=0.00677 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.314 | L2-Norm(final)=3.160 | 3445.0 samples/s | 53.8 steps/s
[Step=28650 Epoch=56.0] | Loss=0.00682 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.314 | L2-Norm(final)=3.161 | 3510.3 samples/s | 54.8 steps/s
[Step=28700 Epoch=56.1] | Loss=0.00662 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.313 | L2-Norm(final)=3.162 | 3484.4 samples/s | 54.4 steps/s
[Step=28750 Epoch=56.2] | Loss=0.00653 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.313 | L2-Norm(final)=3.163 | 3488.0 samples/s | 54.5 steps/s
[Step=28800 Epoch=56.3] | Loss=0.00642 | Reg=0.00300 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.313 | L2-Norm(final)=3.164 | 3493.9 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step28800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=107.3] | Loss=0.01491 | Reg=0.00301 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.349 | L2-Norm(final)=3.144 | 3697.1 samples/s | 57.8 steps/s
[Step=28050 Epoch=107.5] | Loss=0.00494 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.301 | L2-Norm(final)=3.143 | 3146.3 samples/s | 49.2 steps/s
[Step=28100 Epoch=107.7] | Loss=0.00251 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.294 | L2-Norm(final)=3.143 | 3296.3 samples/s | 51.5 steps/s
[Step=28150 Epoch=107.9] | Loss=0.00171 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.290 | L2-Norm(final)=3.143 | 3301.8 samples/s | 51.6 steps/s
[Step=28200 Epoch=108.1] | Loss=0.00129 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.287 | L2-Norm(final)=3.144 | 3301.2 samples/s | 51.6 steps/s
[Step=28250 Epoch=108.2] | Loss=0.00104 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.285 | L2-Norm(final)=3.144 | 4006.5 samples/s | 62.6 steps/s
[Step=28300 Epoch=108.4] | Loss=0.00087 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.282 | L2-Norm(final)=3.144 | 1552.9 samples/s | 24.3 steps/s
[Step=28350 Epoch=108.6] | Loss=0.00075 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.281 | L2-Norm(final)=3.145 | 3311.3 samples/s | 51.7 steps/s
[Step=28400 Epoch=108.8] | Loss=0.00066 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.279 | L2-Norm(final)=3.145 | 3307.7 samples/s | 51.7 steps/s
[Step=28450 Epoch=109.0] | Loss=0.00059 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.277 | L2-Norm(final)=3.145 | 3309.7 samples/s | 51.7 steps/s
[Step=28500 Epoch=109.2] | Loss=0.00053 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.276 | L2-Norm(final)=3.145 | 3559.0 samples/s | 55.6 steps/s
[Step=28550 Epoch=109.4] | Loss=0.00048 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.275 | L2-Norm(final)=3.146 | 1606.7 samples/s | 25.1 steps/s
[Step=28600 Epoch=109.6] | Loss=0.00045 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.274 | L2-Norm(final)=3.146 | 3288.9 samples/s | 51.4 steps/s
[Step=28650 Epoch=109.8] | Loss=0.00041 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.272 | L2-Norm(final)=3.146 | 3323.7 samples/s | 51.9 steps/s
[Step=28700 Epoch=110.0] | Loss=0.00038 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.271 | L2-Norm(final)=3.146 | 3323.0 samples/s | 51.9 steps/s
[Step=28750 Epoch=110.2] | Loss=0.00036 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.270 | L2-Norm(final)=3.146 | 3322.6 samples/s | 51.9 steps/s
[Step=28800 Epoch=110.4] | Loss=0.00034 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.269 | L2-Norm(final)=3.146 | 1674.5 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step28800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=107.8] | Loss=0.09088 | Reg=0.00301 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.349 | L2-Norm(final)=3.144 | 3499.5 samples/s | 54.7 steps/s
[Step=28050 Epoch=108.0] | Loss=0.00452 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.302 | L2-Norm(final)=3.144 | 3257.7 samples/s | 50.9 steps/s
[Step=28100 Epoch=108.2] | Loss=0.00230 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.296 | L2-Norm(final)=3.145 | 3286.4 samples/s | 51.4 steps/s
[Step=28150 Epoch=108.4] | Loss=0.00154 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.292 | L2-Norm(final)=3.145 | 3333.8 samples/s | 52.1 steps/s
[Step=28200 Epoch=108.6] | Loss=0.00116 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.289 | L2-Norm(final)=3.145 | 3318.6 samples/s | 51.9 steps/s
[Step=28250 Epoch=108.7] | Loss=0.00094 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.286 | L2-Norm(final)=3.145 | 4033.8 samples/s | 63.0 steps/s
[Step=28300 Epoch=108.9] | Loss=0.00078 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.284 | L2-Norm(final)=3.145 | 1547.4 samples/s | 24.2 steps/s
[Step=28350 Epoch=109.1] | Loss=0.00067 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.282 | L2-Norm(final)=3.146 | 3309.6 samples/s | 51.7 steps/s
[Step=28400 Epoch=109.3] | Loss=0.00059 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.280 | L2-Norm(final)=3.146 | 3316.6 samples/s | 51.8 steps/s
[Step=28450 Epoch=109.5] | Loss=0.00053 | Reg=0.00299 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.278 | L2-Norm(final)=3.146 | 3322.3 samples/s | 51.9 steps/s
[Step=28500 Epoch=109.7] | Loss=0.00048 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.277 | L2-Norm(final)=3.146 | 3653.7 samples/s | 57.1 steps/s
[Step=28550 Epoch=109.9] | Loss=0.00044 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.275 | L2-Norm(final)=3.146 | 1611.2 samples/s | 25.2 steps/s
[Step=28600 Epoch=110.1] | Loss=0.00040 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.274 | L2-Norm(final)=3.146 | 3328.1 samples/s | 52.0 steps/s
[Step=28650 Epoch=110.3] | Loss=0.00037 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.273 | L2-Norm(final)=3.146 | 3333.8 samples/s | 52.1 steps/s
[Step=28700 Epoch=110.5] | Loss=0.00035 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.271 | L2-Norm(final)=3.146 | 3333.7 samples/s | 52.1 steps/s
[Step=28750 Epoch=110.7] | Loss=0.00032 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.270 | L2-Norm(final)=3.147 | 3392.1 samples/s | 53.0 steps/s
[Step=28800 Epoch=110.9] | Loss=0.00030 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.269 | L2-Norm(final)=3.147 | 1677.5 samples/s | 26.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17136 | acc=0.9028 | tpr=0.8670 | fpr=0.0193 | 3635.5 samples/s | 14.2 steps/s
Avg test loss: 0.17409, Avg test acc: 0.90059, Avg tpr: 0.86524, Avg fpr: 0.02166, total FA: 169

Testing server on iccad2012
[Step=  50] | Loss=0.45475 | acc=0.8400 | tpr=0.9779 | fpr=0.1625 | 3682.8 samples/s | 14.4 steps/s
[Step= 100] | Loss=0.46181 | acc=0.8407 | tpr=0.9765 | fpr=0.1618 | 6802.3 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.46657 | acc=0.8401 | tpr=0.9798 | fpr=0.1625 | 6656.3 samples/s | 26.0 steps/s
[Step= 200] | Loss=0.46719 | acc=0.8406 | tpr=0.9803 | fpr=0.1620 | 6995.1 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.46726 | acc=0.8391 | tpr=0.9773 | fpr=0.1634 | 6867.2 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.46918 | acc=0.8387 | tpr=0.9782 | fpr=0.1638 | 6856.6 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.47268 | acc=0.8381 | tpr=0.9775 | fpr=0.1644 | 6768.6 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.47415 | acc=0.8378 | tpr=0.9748 | fpr=0.1646 | 6677.8 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.47745 | acc=0.8378 | tpr=0.9766 | fpr=0.1647 | 6952.0 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.47691 | acc=0.8374 | tpr=0.9771 | fpr=0.1651 | 6650.5 samples/s | 26.0 steps/s
[Step= 550] | Loss=0.47399 | acc=0.8381 | tpr=0.9765 | fpr=0.1644 | 13019.1 samples/s | 50.9 steps/s
Avg test loss: 0.47358, Avg test acc: 0.83816, Avg tpr: 0.97623, Avg fpr: 0.16435, total FA: 22820

server round 36/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=56.2] | Loss=0.06656 | Reg=0.00298 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.276 | L2-Norm(final)=3.164 | 3502.0 samples/s | 54.7 steps/s
[Step=28850 Epoch=56.3] | Loss=0.01214 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.253 | L2-Norm(final)=3.164 | 3434.4 samples/s | 53.7 steps/s
[Step=28900 Epoch=56.4] | Loss=0.01099 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.248 | L2-Norm(final)=3.166 | 3560.5 samples/s | 55.6 steps/s
[Step=28950 Epoch=56.5] | Loss=0.00913 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.244 | L2-Norm(final)=3.167 | 3486.4 samples/s | 54.5 steps/s
[Step=29000 Epoch=56.6] | Loss=0.00864 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.243 | L2-Norm(final)=3.168 | 3480.1 samples/s | 54.4 steps/s
[Step=29050 Epoch=56.7] | Loss=0.00831 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.241 | L2-Norm(final)=3.169 | 3493.8 samples/s | 54.6 steps/s
[Step=29100 Epoch=56.8] | Loss=0.00822 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.240 | L2-Norm(final)=3.170 | 3491.6 samples/s | 54.6 steps/s
[Step=29150 Epoch=56.9] | Loss=0.00834 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.239 | L2-Norm(final)=3.171 | 3496.4 samples/s | 54.6 steps/s
[Step=29200 Epoch=57.0] | Loss=0.00801 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.239 | L2-Norm(final)=3.172 | 3499.1 samples/s | 54.7 steps/s
[Step=29250 Epoch=57.0] | Loss=0.00787 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.238 | L2-Norm(final)=3.173 | 3504.5 samples/s | 54.8 steps/s
[Step=29300 Epoch=57.1] | Loss=0.00755 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.238 | L2-Norm(final)=3.175 | 4067.1 samples/s | 63.5 steps/s
[Step=29350 Epoch=57.2] | Loss=0.00744 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.237 | L2-Norm(final)=3.176 | 1583.6 samples/s | 24.7 steps/s
[Step=29400 Epoch=57.3] | Loss=0.00722 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.237 | L2-Norm(final)=3.177 | 3483.6 samples/s | 54.4 steps/s
[Step=29450 Epoch=57.4] | Loss=0.00713 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.237 | L2-Norm(final)=3.178 | 3470.1 samples/s | 54.2 steps/s
[Step=29500 Epoch=57.5] | Loss=0.00690 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.237 | L2-Norm(final)=3.180 | 3487.6 samples/s | 54.5 steps/s
[Step=29550 Epoch=57.6] | Loss=0.00683 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.237 | L2-Norm(final)=3.181 | 3493.0 samples/s | 54.6 steps/s
[Step=29600 Epoch=57.7] | Loss=0.00683 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.237 | L2-Norm(final)=3.182 | 3503.7 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step29600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=56.3] | Loss=0.09749 | Reg=0.00298 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.276 | L2-Norm(final)=3.164 | 3892.1 samples/s | 60.8 steps/s
[Step=28850 Epoch=56.4] | Loss=0.01345 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.257 | L2-Norm(final)=3.165 | 3224.5 samples/s | 50.4 steps/s
[Step=28900 Epoch=56.5] | Loss=0.00994 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.252 | L2-Norm(final)=3.167 | 3473.4 samples/s | 54.3 steps/s
[Step=28950 Epoch=56.6] | Loss=0.00846 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.250 | L2-Norm(final)=3.169 | 3464.4 samples/s | 54.1 steps/s
[Step=29000 Epoch=56.7] | Loss=0.00797 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.248 | L2-Norm(final)=3.171 | 3488.8 samples/s | 54.5 steps/s
[Step=29050 Epoch=56.8] | Loss=0.00852 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.247 | L2-Norm(final)=3.173 | 3498.6 samples/s | 54.7 steps/s
[Step=29100 Epoch=56.9] | Loss=0.00799 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.245 | L2-Norm(final)=3.174 | 3501.0 samples/s | 54.7 steps/s
[Step=29150 Epoch=57.0] | Loss=0.00774 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.245 | L2-Norm(final)=3.175 | 3489.7 samples/s | 54.5 steps/s
[Step=29200 Epoch=57.1] | Loss=0.00764 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.244 | L2-Norm(final)=3.176 | 3497.8 samples/s | 54.7 steps/s
[Step=29250 Epoch=57.2] | Loss=0.00740 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.243 | L2-Norm(final)=3.177 | 3503.4 samples/s | 54.7 steps/s
[Step=29300 Epoch=57.3] | Loss=0.00716 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.243 | L2-Norm(final)=3.178 | 4106.2 samples/s | 64.2 steps/s
[Step=29350 Epoch=57.4] | Loss=0.00693 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.243 | L2-Norm(final)=3.180 | 1604.4 samples/s | 25.1 steps/s
[Step=29400 Epoch=57.5] | Loss=0.00678 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.242 | L2-Norm(final)=3.181 | 3486.3 samples/s | 54.5 steps/s
[Step=29450 Epoch=57.6] | Loss=0.00673 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.242 | L2-Norm(final)=3.182 | 3484.4 samples/s | 54.4 steps/s
[Step=29500 Epoch=57.7] | Loss=0.00664 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.242 | L2-Norm(final)=3.183 | 3497.1 samples/s | 54.6 steps/s
[Step=29550 Epoch=57.8] | Loss=0.00643 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.242 | L2-Norm(final)=3.184 | 3498.2 samples/s | 54.7 steps/s
[Step=29600 Epoch=57.9] | Loss=0.00647 | Reg=0.00297 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.242 | L2-Norm(final)=3.185 | 3502.7 samples/s | 54.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step29600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=110.4] | Loss=0.06281 | Reg=0.00298 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.276 | L2-Norm(final)=3.164 | 3519.0 samples/s | 55.0 steps/s
[Step=28850 Epoch=110.5] | Loss=0.00513 | Reg=0.00297 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.240 | L2-Norm(final)=3.165 | 3218.4 samples/s | 50.3 steps/s
[Step=28900 Epoch=110.7] | Loss=0.00259 | Reg=0.00297 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.234 | L2-Norm(final)=3.165 | 3345.0 samples/s | 52.3 steps/s
[Step=28950 Epoch=110.9] | Loss=0.00174 | Reg=0.00297 | FP-Reg=0.001 | acc=1.0000 | L2-Norm=17.230 | L2-Norm(final)=3.165 | 3307.3 samples/s | 51.7 steps/s
[Step=29000 Epoch=111.1] | Loss=0.00131 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.227 | L2-Norm(final)=3.165 | 3313.6 samples/s | 51.8 steps/s
[Step=29050 Epoch=111.3] | Loss=0.00105 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.224 | L2-Norm(final)=3.165 | 3986.1 samples/s | 62.3 steps/s
[Step=29100 Epoch=111.5] | Loss=0.00088 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.221 | L2-Norm(final)=3.166 | 1550.0 samples/s | 24.2 steps/s
[Step=29150 Epoch=111.7] | Loss=0.00076 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.219 | L2-Norm(final)=3.166 | 3326.2 samples/s | 52.0 steps/s
[Step=29200 Epoch=111.9] | Loss=0.00066 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.217 | L2-Norm(final)=3.166 | 3327.4 samples/s | 52.0 steps/s
[Step=29250 Epoch=112.1] | Loss=0.00059 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.215 | L2-Norm(final)=3.166 | 3307.9 samples/s | 51.7 steps/s
[Step=29300 Epoch=112.3] | Loss=0.00053 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.213 | L2-Norm(final)=3.166 | 3609.3 samples/s | 56.4 steps/s
[Step=29350 Epoch=112.5] | Loss=0.00049 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.212 | L2-Norm(final)=3.166 | 1615.2 samples/s | 25.2 steps/s
[Step=29400 Epoch=112.7] | Loss=0.00045 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.210 | L2-Norm(final)=3.166 | 3351.9 samples/s | 52.4 steps/s
[Step=29450 Epoch=112.8] | Loss=0.00041 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.209 | L2-Norm(final)=3.166 | 3320.7 samples/s | 51.9 steps/s
[Step=29500 Epoch=113.0] | Loss=0.00039 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.207 | L2-Norm(final)=3.166 | 3328.2 samples/s | 52.0 steps/s
[Step=29550 Epoch=113.2] | Loss=0.00036 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.206 | L2-Norm(final)=3.166 | 3329.2 samples/s | 52.0 steps/s
[Step=29600 Epoch=113.4] | Loss=0.00034 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.205 | L2-Norm(final)=3.166 | 1682.3 samples/s | 26.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step29600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=110.9] | Loss=0.00440 | Reg=0.00298 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.276 | L2-Norm(final)=3.164 | 3643.4 samples/s | 56.9 steps/s
[Step=28850 Epoch=111.1] | Loss=0.00337 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.228 | L2-Norm(final)=3.167 | 3153.5 samples/s | 49.3 steps/s
[Step=28900 Epoch=111.2] | Loss=0.00170 | Reg=0.00297 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.221 | L2-Norm(final)=3.167 | 3327.5 samples/s | 52.0 steps/s
[Step=28950 Epoch=111.4] | Loss=0.00114 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.217 | L2-Norm(final)=3.168 | 3318.3 samples/s | 51.8 steps/s
[Step=29000 Epoch=111.6] | Loss=0.00086 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.214 | L2-Norm(final)=3.168 | 3340.8 samples/s | 52.2 steps/s
[Step=29050 Epoch=111.8] | Loss=0.00069 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.211 | L2-Norm(final)=3.168 | 4037.9 samples/s | 63.1 steps/s
[Step=29100 Epoch=112.0] | Loss=0.00058 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.209 | L2-Norm(final)=3.168 | 1546.2 samples/s | 24.2 steps/s
[Step=29150 Epoch=112.2] | Loss=0.00050 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.207 | L2-Norm(final)=3.168 | 3311.8 samples/s | 51.7 steps/s
[Step=29200 Epoch=112.4] | Loss=0.00044 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.205 | L2-Norm(final)=3.168 | 3311.0 samples/s | 51.7 steps/s
[Step=29250 Epoch=112.6] | Loss=0.00039 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.203 | L2-Norm(final)=3.168 | 3286.2 samples/s | 51.3 steps/s
[Step=29300 Epoch=112.8] | Loss=0.00035 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.202 | L2-Norm(final)=3.168 | 3666.6 samples/s | 57.3 steps/s
[Step=29350 Epoch=113.0] | Loss=0.00032 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.200 | L2-Norm(final)=3.168 | 1612.4 samples/s | 25.2 steps/s
[Step=29400 Epoch=113.2] | Loss=0.00029 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.199 | L2-Norm(final)=3.168 | 3317.9 samples/s | 51.8 steps/s
[Step=29450 Epoch=113.4] | Loss=0.00027 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.198 | L2-Norm(final)=3.168 | 3332.5 samples/s | 52.1 steps/s
[Step=29500 Epoch=113.6] | Loss=0.00025 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.197 | L2-Norm(final)=3.168 | 3334.9 samples/s | 52.1 steps/s
[Step=29550 Epoch=113.7] | Loss=0.00024 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.195 | L2-Norm(final)=3.168 | 3398.2 samples/s | 53.1 steps/s
[Step=29600 Epoch=113.9] | Loss=0.00022 | Reg=0.00296 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.194 | L2-Norm(final)=3.168 | 1654.2 samples/s | 25.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18905 | acc=0.8945 | tpr=0.8542 | fpr=0.0181 | 3673.2 samples/s | 14.3 steps/s
Avg test loss: 0.19216, Avg test acc: 0.89262, Avg tpr: 0.85324, Avg fpr: 0.02077, total FA: 162

Testing server on iccad2012
[Step=  50] | Loss=0.42312 | acc=0.8534 | tpr=0.9823 | fpr=0.1490 | 3718.7 samples/s | 14.5 steps/s
[Step= 100] | Loss=0.43070 | acc=0.8541 | tpr=0.9808 | fpr=0.1483 | 6833.4 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.43557 | acc=0.8540 | tpr=0.9827 | fpr=0.1484 | 6678.8 samples/s | 26.1 steps/s
[Step= 200] | Loss=0.43633 | acc=0.8543 | tpr=0.9825 | fpr=0.1480 | 7173.0 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.43555 | acc=0.8532 | tpr=0.9790 | fpr=0.1491 | 6723.2 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.43717 | acc=0.8532 | tpr=0.9796 | fpr=0.1492 | 6726.5 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.44074 | acc=0.8529 | tpr=0.9793 | fpr=0.1494 | 6822.0 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.44220 | acc=0.8524 | tpr=0.9765 | fpr=0.1498 | 6895.1 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.44585 | acc=0.8525 | tpr=0.9776 | fpr=0.1498 | 6630.6 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.44524 | acc=0.8522 | tpr=0.9780 | fpr=0.1501 | 6768.5 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.44255 | acc=0.8528 | tpr=0.9773 | fpr=0.1495 | 12950.9 samples/s | 50.6 steps/s
Avg test loss: 0.44214, Avg test acc: 0.85283, Avg tpr: 0.97702, Avg fpr: 0.14943, total FA: 20748

server round 37/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=57.7] | Loss=0.09929 | Reg=0.00296 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.204 | L2-Norm(final)=3.183 | 3726.3 samples/s | 58.2 steps/s
[Step=29650 Epoch=57.8] | Loss=0.01537 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.184 | L2-Norm(final)=3.184 | 3198.8 samples/s | 50.0 steps/s
[Step=29700 Epoch=57.9] | Loss=0.01143 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.178 | L2-Norm(final)=3.185 | 3463.5 samples/s | 54.1 steps/s
[Step=29750 Epoch=58.0] | Loss=0.00918 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.175 | L2-Norm(final)=3.187 | 3475.1 samples/s | 54.3 steps/s
[Step=29800 Epoch=58.1] | Loss=0.00839 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.174 | L2-Norm(final)=3.188 | 3476.9 samples/s | 54.3 steps/s
[Step=29850 Epoch=58.2] | Loss=0.00762 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.173 | L2-Norm(final)=3.190 | 3496.1 samples/s | 54.6 steps/s
[Step=29900 Epoch=58.3] | Loss=0.00751 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.172 | L2-Norm(final)=3.192 | 3499.8 samples/s | 54.7 steps/s
[Step=29950 Epoch=58.4] | Loss=0.00761 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.171 | L2-Norm(final)=3.193 | 3502.7 samples/s | 54.7 steps/s
[Step=30000 Epoch=58.5] | Loss=0.00721 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.170 | L2-Norm(final)=3.194 | 3461.9 samples/s | 54.1 steps/s
[Step=30050 Epoch=58.6] | Loss=0.00713 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.170 | L2-Norm(final)=3.195 | 3499.1 samples/s | 54.7 steps/s
[Step=30100 Epoch=58.7] | Loss=0.00727 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.169 | L2-Norm(final)=3.196 | 4057.2 samples/s | 63.4 steps/s
[Step=30150 Epoch=58.8] | Loss=0.00717 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.169 | L2-Norm(final)=3.197 | 1565.6 samples/s | 24.5 steps/s
[Step=30200 Epoch=58.9] | Loss=0.00703 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.168 | L2-Norm(final)=3.198 | 3473.9 samples/s | 54.3 steps/s
[Step=30250 Epoch=59.0] | Loss=0.00691 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.168 | L2-Norm(final)=3.198 | 3478.1 samples/s | 54.3 steps/s
[Step=30300 Epoch=59.1] | Loss=0.00689 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.168 | L2-Norm(final)=3.199 | 3479.7 samples/s | 54.4 steps/s
[Step=30350 Epoch=59.2] | Loss=0.00700 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.167 | L2-Norm(final)=3.200 | 3469.7 samples/s | 54.2 steps/s
[Step=30400 Epoch=59.3] | Loss=0.00686 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.167 | L2-Norm(final)=3.201 | 3458.7 samples/s | 54.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step30400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=57.9] | Loss=0.04658 | Reg=0.00296 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.204 | L2-Norm(final)=3.184 | 4025.7 samples/s | 62.9 steps/s
[Step=29650 Epoch=58.0] | Loss=0.01573 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.184 | L2-Norm(final)=3.183 | 3176.6 samples/s | 49.6 steps/s
[Step=29700 Epoch=58.1] | Loss=0.01023 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.179 | L2-Norm(final)=3.184 | 3477.7 samples/s | 54.3 steps/s
[Step=29750 Epoch=58.2] | Loss=0.00909 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.176 | L2-Norm(final)=3.186 | 3467.0 samples/s | 54.2 steps/s
[Step=29800 Epoch=58.3] | Loss=0.00819 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.174 | L2-Norm(final)=3.188 | 3479.3 samples/s | 54.4 steps/s
[Step=29850 Epoch=58.4] | Loss=0.00765 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.173 | L2-Norm(final)=3.190 | 3482.3 samples/s | 54.4 steps/s
[Step=29900 Epoch=58.5] | Loss=0.00743 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.172 | L2-Norm(final)=3.191 | 3494.2 samples/s | 54.6 steps/s
[Step=29950 Epoch=58.6] | Loss=0.00769 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.172 | L2-Norm(final)=3.193 | 3490.2 samples/s | 54.5 steps/s
[Step=30000 Epoch=58.6] | Loss=0.00757 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.171 | L2-Norm(final)=3.194 | 3470.0 samples/s | 54.2 steps/s
[Step=30050 Epoch=58.7] | Loss=0.00750 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.171 | L2-Norm(final)=3.195 | 3533.4 samples/s | 55.2 steps/s
[Step=30100 Epoch=58.8] | Loss=0.00733 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.171 | L2-Norm(final)=3.196 | 4098.8 samples/s | 64.0 steps/s
[Step=30150 Epoch=58.9] | Loss=0.00700 | Reg=0.00295 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.170 | L2-Norm(final)=3.197 | 1602.3 samples/s | 25.0 steps/s
[Step=30200 Epoch=59.0] | Loss=0.00695 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.170 | L2-Norm(final)=3.198 | 3464.2 samples/s | 54.1 steps/s
[Step=30250 Epoch=59.1] | Loss=0.00684 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.170 | L2-Norm(final)=3.198 | 3480.7 samples/s | 54.4 steps/s
[Step=30300 Epoch=59.2] | Loss=0.00676 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.169 | L2-Norm(final)=3.199 | 3481.9 samples/s | 54.4 steps/s
[Step=30350 Epoch=59.3] | Loss=0.00660 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.169 | L2-Norm(final)=3.200 | 3483.6 samples/s | 54.4 steps/s
[Step=30400 Epoch=59.4] | Loss=0.00650 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.169 | L2-Norm(final)=3.201 | 3491.6 samples/s | 54.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step30400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=113.4] | Loss=0.03180 | Reg=0.00296 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.204 | L2-Norm(final)=3.183 | 3648.9 samples/s | 57.0 steps/s
[Step=29650 Epoch=113.6] | Loss=0.00369 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.164 | L2-Norm(final)=3.186 | 3191.2 samples/s | 49.9 steps/s
[Step=29700 Epoch=113.8] | Loss=0.00186 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.158 | L2-Norm(final)=3.187 | 3329.2 samples/s | 52.0 steps/s
[Step=29750 Epoch=114.0] | Loss=0.00124 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.153 | L2-Norm(final)=3.187 | 3325.9 samples/s | 52.0 steps/s
[Step=29800 Epoch=114.2] | Loss=0.00095 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.150 | L2-Norm(final)=3.187 | 3307.7 samples/s | 51.7 steps/s
[Step=29850 Epoch=114.4] | Loss=0.00076 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.147 | L2-Norm(final)=3.187 | 3976.2 samples/s | 62.1 steps/s
[Step=29900 Epoch=114.6] | Loss=0.00064 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.145 | L2-Norm(final)=3.187 | 1414.5 samples/s | 22.1 steps/s
[Step=29950 Epoch=114.8] | Loss=0.00055 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.142 | L2-Norm(final)=3.187 | 2968.2 samples/s | 46.4 steps/s
[Step=30000 Epoch=114.9] | Loss=0.00048 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.140 | L2-Norm(final)=3.187 | 3021.5 samples/s | 47.2 steps/s
[Step=30050 Epoch=115.1] | Loss=0.00043 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.139 | L2-Norm(final)=3.187 | 3012.9 samples/s | 47.1 steps/s
[Step=30100 Epoch=115.3] | Loss=0.00039 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.137 | L2-Norm(final)=3.187 | 3343.8 samples/s | 52.2 steps/s
[Step=30150 Epoch=115.5] | Loss=0.00035 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.135 | L2-Norm(final)=3.187 | 1659.6 samples/s | 25.9 steps/s
[Step=30200 Epoch=115.7] | Loss=0.00033 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.134 | L2-Norm(final)=3.187 | 3480.5 samples/s | 54.4 steps/s
[Step=30250 Epoch=115.9] | Loss=0.00030 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.132 | L2-Norm(final)=3.187 | 3482.2 samples/s | 54.4 steps/s
[Step=30300 Epoch=116.1] | Loss=0.00028 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.131 | L2-Norm(final)=3.187 | 3412.2 samples/s | 53.3 steps/s
[Step=30350 Epoch=116.3] | Loss=0.00026 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.130 | L2-Norm(final)=3.187 | 3402.7 samples/s | 53.2 steps/s
[Step=30400 Epoch=116.5] | Loss=0.00025 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.129 | L2-Norm(final)=3.187 | 1719.4 samples/s | 26.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step30400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=113.9] | Loss=0.07246 | Reg=0.00296 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.204 | L2-Norm(final)=3.183 | 4013.4 samples/s | 62.7 steps/s
[Step=29650 Epoch=114.1] | Loss=0.00514 | Reg=0.00295 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.163 | L2-Norm(final)=3.183 | 3137.8 samples/s | 49.0 steps/s
[Step=29700 Epoch=114.3] | Loss=0.00259 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.157 | L2-Norm(final)=3.182 | 3501.3 samples/s | 54.7 steps/s
[Step=29750 Epoch=114.5] | Loss=0.00174 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.153 | L2-Norm(final)=3.183 | 3491.7 samples/s | 54.6 steps/s
[Step=29800 Epoch=114.7] | Loss=0.00131 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.150 | L2-Norm(final)=3.183 | 3475.8 samples/s | 54.3 steps/s
[Step=29850 Epoch=114.9] | Loss=0.00105 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.147 | L2-Norm(final)=3.183 | 4211.1 samples/s | 65.8 steps/s
[Step=29900 Epoch=115.1] | Loss=0.00088 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.145 | L2-Norm(final)=3.183 | 1618.0 samples/s | 25.3 steps/s
[Step=29950 Epoch=115.3] | Loss=0.00076 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.143 | L2-Norm(final)=3.183 | 3439.7 samples/s | 53.7 steps/s
[Step=30000 Epoch=115.5] | Loss=0.00066 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.141 | L2-Norm(final)=3.184 | 3470.5 samples/s | 54.2 steps/s
[Step=30050 Epoch=115.7] | Loss=0.00059 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.140 | L2-Norm(final)=3.184 | 3488.4 samples/s | 54.5 steps/s
[Step=30100 Epoch=115.9] | Loss=0.00054 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.138 | L2-Norm(final)=3.184 | 3781.8 samples/s | 59.1 steps/s
[Step=30150 Epoch=116.1] | Loss=0.00049 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.137 | L2-Norm(final)=3.184 | 1628.8 samples/s | 25.4 steps/s
[Step=30200 Epoch=116.3] | Loss=0.00045 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.135 | L2-Norm(final)=3.184 | 3444.3 samples/s | 53.8 steps/s
[Step=30250 Epoch=116.4] | Loss=0.00042 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.134 | L2-Norm(final)=3.184 | 3386.0 samples/s | 52.9 steps/s
[Step=30300 Epoch=116.6] | Loss=0.00039 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.133 | L2-Norm(final)=3.184 | 3375.1 samples/s | 52.7 steps/s
[Step=30350 Epoch=116.8] | Loss=0.00036 | Reg=0.00294 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.132 | L2-Norm(final)=3.184 | 3463.8 samples/s | 54.1 steps/s
[Step=30400 Epoch=117.0] | Loss=0.00034 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.131 | L2-Norm(final)=3.185 | 1726.1 samples/s | 27.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18662 | acc=0.8963 | tpr=0.8565 | fpr=0.0171 | 3819.6 samples/s | 14.9 steps/s
Avg test loss: 0.18919, Avg test acc: 0.89374, Avg tpr: 0.85417, Avg fpr: 0.01923, total FA: 150

Testing server on iccad2012
[Step=  50] | Loss=0.41897 | acc=0.8517 | tpr=0.9735 | fpr=0.1505 | 3845.6 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.42669 | acc=0.8537 | tpr=0.9765 | fpr=0.1486 | 7057.4 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.43207 | acc=0.8533 | tpr=0.9784 | fpr=0.1490 | 7011.0 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.43284 | acc=0.8542 | tpr=0.9781 | fpr=0.1481 | 6977.2 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.43214 | acc=0.8532 | tpr=0.9755 | fpr=0.1491 | 7199.5 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.43376 | acc=0.8532 | tpr=0.9753 | fpr=0.1490 | 7034.6 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.43697 | acc=0.8530 | tpr=0.9750 | fpr=0.1492 | 7369.4 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.43844 | acc=0.8527 | tpr=0.9726 | fpr=0.1495 | 6976.3 samples/s | 27.3 steps/s
[Step= 450] | Loss=0.44202 | acc=0.8526 | tpr=0.9747 | fpr=0.1496 | 6989.3 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.44136 | acc=0.8524 | tpr=0.9753 | fpr=0.1498 | 7162.9 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.43872 | acc=0.8531 | tpr=0.9749 | fpr=0.1491 | 13136.1 samples/s | 51.3 steps/s
Avg test loss: 0.43832, Avg test acc: 0.85312, Avg tpr: 0.97464, Avg fpr: 0.14909, total FA: 20701

server round 38/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=59.3] | Loss=0.02213 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.134 | L2-Norm(final)=3.201 | 3611.2 samples/s | 56.4 steps/s
[Step=30450 Epoch=59.4] | Loss=0.01601 | Reg=0.00293 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.116 | L2-Norm(final)=3.200 | 3347.0 samples/s | 52.3 steps/s
[Step=30500 Epoch=59.5] | Loss=0.01188 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.111 | L2-Norm(final)=3.201 | 3543.1 samples/s | 55.4 steps/s
[Step=30550 Epoch=59.6] | Loss=0.01027 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.108 | L2-Norm(final)=3.202 | 3568.2 samples/s | 55.8 steps/s
[Step=30600 Epoch=59.7] | Loss=0.00912 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.106 | L2-Norm(final)=3.204 | 3555.6 samples/s | 55.6 steps/s
[Step=30650 Epoch=59.8] | Loss=0.00832 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.104 | L2-Norm(final)=3.205 | 3565.9 samples/s | 55.7 steps/s
[Step=30700 Epoch=59.9] | Loss=0.00790 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.103 | L2-Norm(final)=3.206 | 3542.1 samples/s | 55.3 steps/s
[Step=30750 Epoch=60.0] | Loss=0.00795 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.102 | L2-Norm(final)=3.207 | 3581.8 samples/s | 56.0 steps/s
[Step=30800 Epoch=60.1] | Loss=0.00769 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.101 | L2-Norm(final)=3.208 | 3584.9 samples/s | 56.0 steps/s
[Step=30850 Epoch=60.2] | Loss=0.00776 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.101 | L2-Norm(final)=3.209 | 3654.6 samples/s | 57.1 steps/s
[Step=30900 Epoch=60.3] | Loss=0.00775 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.100 | L2-Norm(final)=3.210 | 4281.4 samples/s | 66.9 steps/s
[Step=30950 Epoch=60.4] | Loss=0.00757 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.100 | L2-Norm(final)=3.211 | 1624.2 samples/s | 25.4 steps/s
[Step=31000 Epoch=60.5] | Loss=0.00736 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.099 | L2-Norm(final)=3.212 | 3570.0 samples/s | 55.8 steps/s
[Step=31050 Epoch=60.6] | Loss=0.00705 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.099 | L2-Norm(final)=3.213 | 3647.2 samples/s | 57.0 steps/s
[Step=31100 Epoch=60.7] | Loss=0.00680 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.099 | L2-Norm(final)=3.214 | 3641.2 samples/s | 56.9 steps/s
[Step=31150 Epoch=60.8] | Loss=0.00666 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.099 | L2-Norm(final)=3.215 | 3692.9 samples/s | 57.7 steps/s
[Step=31200 Epoch=60.9] | Loss=0.00674 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.098 | L2-Norm(final)=3.216 | 3695.2 samples/s | 57.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step31200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=59.4] | Loss=0.10695 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=17.134 | L2-Norm(final)=3.201 | 3835.5 samples/s | 59.9 steps/s
[Step=30450 Epoch=59.5] | Loss=0.01944 | Reg=0.00293 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.114 | L2-Norm(final)=3.198 | 3602.3 samples/s | 56.3 steps/s
[Step=30500 Epoch=59.6] | Loss=0.01318 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.109 | L2-Norm(final)=3.199 | 3582.0 samples/s | 56.0 steps/s
[Step=30550 Epoch=59.7] | Loss=0.01071 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.106 | L2-Norm(final)=3.200 | 3589.0 samples/s | 56.1 steps/s
[Step=30600 Epoch=59.8] | Loss=0.00945 | Reg=0.00293 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.105 | L2-Norm(final)=3.202 | 3570.5 samples/s | 55.8 steps/s
[Step=30650 Epoch=59.9] | Loss=0.00890 | Reg=0.00293 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.104 | L2-Norm(final)=3.204 | 3573.3 samples/s | 55.8 steps/s
[Step=30700 Epoch=60.0] | Loss=0.00836 | Reg=0.00293 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.103 | L2-Norm(final)=3.205 | 3591.0 samples/s | 56.1 steps/s
[Step=30750 Epoch=60.1] | Loss=0.00803 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.102 | L2-Norm(final)=3.207 | 3509.9 samples/s | 54.8 steps/s
[Step=30800 Epoch=60.2] | Loss=0.00779 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.102 | L2-Norm(final)=3.208 | 3562.5 samples/s | 55.7 steps/s
[Step=30850 Epoch=60.3] | Loss=0.00759 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.101 | L2-Norm(final)=3.210 | 3590.5 samples/s | 56.1 steps/s
[Step=30900 Epoch=60.4] | Loss=0.00746 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.100 | L2-Norm(final)=3.211 | 4228.4 samples/s | 66.1 steps/s
[Step=30950 Epoch=60.5] | Loss=0.00721 | Reg=0.00292 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.100 | L2-Norm(final)=3.212 | 1693.6 samples/s | 26.5 steps/s
[Step=31000 Epoch=60.6] | Loss=0.00704 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.100 | L2-Norm(final)=3.213 | 3667.1 samples/s | 57.3 steps/s
[Step=31050 Epoch=60.7] | Loss=0.00704 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.100 | L2-Norm(final)=3.214 | 3664.1 samples/s | 57.3 steps/s
[Step=31100 Epoch=60.8] | Loss=0.00697 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.099 | L2-Norm(final)=3.215 | 3668.1 samples/s | 57.3 steps/s
[Step=31150 Epoch=60.9] | Loss=0.00691 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.099 | L2-Norm(final)=3.216 | 3671.4 samples/s | 57.4 steps/s
[Step=31200 Epoch=61.0] | Loss=0.00676 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.099 | L2-Norm(final)=3.217 | 3557.3 samples/s | 55.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step31200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=116.5] | Loss=0.08434 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.134 | L2-Norm(final)=3.201 | 3796.7 samples/s | 59.3 steps/s
[Step=30450 Epoch=116.7] | Loss=0.00496 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.092 | L2-Norm(final)=3.201 | 3238.1 samples/s | 50.6 steps/s
[Step=30500 Epoch=116.9] | Loss=0.00260 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.087 | L2-Norm(final)=3.201 | 3374.5 samples/s | 52.7 steps/s
[Step=30550 Epoch=117.1] | Loss=0.00177 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.083 | L2-Norm(final)=3.201 | 3380.7 samples/s | 52.8 steps/s
[Step=30600 Epoch=117.2] | Loss=0.00133 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.080 | L2-Norm(final)=3.201 | 3145.7 samples/s | 49.2 steps/s
[Step=30650 Epoch=117.4] | Loss=0.00108 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.077 | L2-Norm(final)=3.201 | 3874.7 samples/s | 60.5 steps/s
[Step=30700 Epoch=117.6] | Loss=0.00090 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.075 | L2-Norm(final)=3.201 | 1556.8 samples/s | 24.3 steps/s
[Step=30750 Epoch=117.8] | Loss=0.00077 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.073 | L2-Norm(final)=3.202 | 3363.0 samples/s | 52.5 steps/s
[Step=30800 Epoch=118.0] | Loss=0.00068 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.071 | L2-Norm(final)=3.202 | 3374.0 samples/s | 52.7 steps/s
[Step=30850 Epoch=118.2] | Loss=0.00060 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.069 | L2-Norm(final)=3.202 | 3477.2 samples/s | 54.3 steps/s
[Step=30900 Epoch=118.4] | Loss=0.00055 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.068 | L2-Norm(final)=3.202 | 3775.2 samples/s | 59.0 steps/s
[Step=30950 Epoch=118.6] | Loss=0.00050 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.066 | L2-Norm(final)=3.202 | 1675.6 samples/s | 26.2 steps/s
[Step=31000 Epoch=118.8] | Loss=0.00046 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.065 | L2-Norm(final)=3.202 | 3390.1 samples/s | 53.0 steps/s
[Step=31050 Epoch=119.0] | Loss=0.00042 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.064 | L2-Norm(final)=3.202 | 3377.2 samples/s | 52.8 steps/s
[Step=31100 Epoch=119.2] | Loss=0.00039 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.062 | L2-Norm(final)=3.202 | 3393.1 samples/s | 53.0 steps/s
[Step=31150 Epoch=119.4] | Loss=0.00037 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.061 | L2-Norm(final)=3.202 | 3371.1 samples/s | 52.7 steps/s
[Step=31200 Epoch=119.5] | Loss=0.00035 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.060 | L2-Norm(final)=3.202 | 1740.1 samples/s | 27.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step31200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=117.0] | Loss=0.13019 | Reg=0.00294 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.134 | L2-Norm(final)=3.201 | 3699.9 samples/s | 57.8 steps/s
[Step=30450 Epoch=117.2] | Loss=0.00660 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.089 | L2-Norm(final)=3.199 | 3353.5 samples/s | 52.4 steps/s
[Step=30500 Epoch=117.4] | Loss=0.00331 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.083 | L2-Norm(final)=3.199 | 3466.0 samples/s | 54.2 steps/s
[Step=30550 Epoch=117.6] | Loss=0.00222 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.080 | L2-Norm(final)=3.199 | 3473.7 samples/s | 54.3 steps/s
[Step=30600 Epoch=117.8] | Loss=0.00167 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.077 | L2-Norm(final)=3.199 | 3463.4 samples/s | 54.1 steps/s
[Step=30650 Epoch=118.0] | Loss=0.00134 | Reg=0.00292 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.074 | L2-Norm(final)=3.200 | 4151.8 samples/s | 64.9 steps/s
[Step=30700 Epoch=118.2] | Loss=0.00112 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.072 | L2-Norm(final)=3.200 | 1594.1 samples/s | 24.9 steps/s
[Step=30750 Epoch=118.4] | Loss=0.00096 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.070 | L2-Norm(final)=3.200 | 3398.1 samples/s | 53.1 steps/s
[Step=30800 Epoch=118.6] | Loss=0.00084 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.068 | L2-Norm(final)=3.200 | 3407.4 samples/s | 53.2 steps/s
[Step=30850 Epoch=118.8] | Loss=0.00075 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.067 | L2-Norm(final)=3.200 | 3411.2 samples/s | 53.3 steps/s
[Step=30900 Epoch=118.9] | Loss=0.00068 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.065 | L2-Norm(final)=3.200 | 3755.4 samples/s | 58.7 steps/s
[Step=30950 Epoch=119.1] | Loss=0.00062 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.064 | L2-Norm(final)=3.200 | 1660.8 samples/s | 25.9 steps/s
[Step=31000 Epoch=119.3] | Loss=0.00057 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.063 | L2-Norm(final)=3.200 | 3375.7 samples/s | 52.7 steps/s
[Step=31050 Epoch=119.5] | Loss=0.00052 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.061 | L2-Norm(final)=3.200 | 3393.7 samples/s | 53.0 steps/s
[Step=31100 Epoch=119.7] | Loss=0.00049 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.060 | L2-Norm(final)=3.200 | 3414.4 samples/s | 53.3 steps/s
[Step=31150 Epoch=119.9] | Loss=0.00045 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.059 | L2-Norm(final)=3.200 | 3445.3 samples/s | 53.8 steps/s
[Step=31200 Epoch=120.1] | Loss=0.00043 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.058 | L2-Norm(final)=3.200 | 1717.7 samples/s | 26.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19519 | acc=0.8923 | tpr=0.8504 | fpr=0.0166 | 3811.9 samples/s | 14.9 steps/s
Avg test loss: 0.19823, Avg test acc: 0.88961, Avg tpr: 0.84793, Avg fpr: 0.01872, total FA: 146

Testing server on iccad2012
[Step=  50] | Loss=0.40562 | acc=0.8610 | tpr=0.9823 | fpr=0.1412 | 3808.9 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.41377 | acc=0.8616 | tpr=0.9808 | fpr=0.1407 | 7472.8 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.41952 | acc=0.8608 | tpr=0.9827 | fpr=0.1414 | 6999.5 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.42044 | acc=0.8616 | tpr=0.9814 | fpr=0.1406 | 7066.0 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.41983 | acc=0.8607 | tpr=0.9782 | fpr=0.1414 | 7210.6 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.42169 | acc=0.8606 | tpr=0.9775 | fpr=0.1415 | 7267.9 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.42522 | acc=0.8603 | tpr=0.9768 | fpr=0.1418 | 7112.1 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.42637 | acc=0.8598 | tpr=0.9743 | fpr=0.1422 | 7110.7 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.42984 | acc=0.8598 | tpr=0.9761 | fpr=0.1423 | 4654.7 samples/s | 18.2 steps/s
[Step= 500] | Loss=0.42904 | acc=0.8596 | tpr=0.9767 | fpr=0.1426 | 7343.8 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.42638 | acc=0.8601 | tpr=0.9757 | fpr=0.1420 | 13037.3 samples/s | 50.9 steps/s
Avg test loss: 0.42599, Avg test acc: 0.86017, Avg tpr: 0.97544, Avg fpr: 0.14192, total FA: 19706

server round 39/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=60.9] | Loss=0.05781 | Reg=0.00291 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=17.063 | L2-Norm(final)=3.217 | 3524.0 samples/s | 55.1 steps/s
[Step=31250 Epoch=60.9] | Loss=0.01645 | Reg=0.00291 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.049 | L2-Norm(final)=3.215 | 3517.6 samples/s | 55.0 steps/s
[Step=31300 Epoch=61.0] | Loss=0.01204 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.044 | L2-Norm(final)=3.216 | 3686.0 samples/s | 57.6 steps/s
[Step=31350 Epoch=61.1] | Loss=0.01023 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.041 | L2-Norm(final)=3.217 | 3673.8 samples/s | 57.4 steps/s
[Step=31400 Epoch=61.2] | Loss=0.00924 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.039 | L2-Norm(final)=3.218 | 3580.4 samples/s | 55.9 steps/s
[Step=31450 Epoch=61.3] | Loss=0.00897 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.037 | L2-Norm(final)=3.219 | 3582.6 samples/s | 56.0 steps/s
[Step=31500 Epoch=61.4] | Loss=0.00855 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.036 | L2-Norm(final)=3.220 | 3572.9 samples/s | 55.8 steps/s
[Step=31550 Epoch=61.5] | Loss=0.00831 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.035 | L2-Norm(final)=3.222 | 3604.4 samples/s | 56.3 steps/s
[Step=31600 Epoch=61.6] | Loss=0.00778 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.034 | L2-Norm(final)=3.223 | 3574.7 samples/s | 55.9 steps/s
[Step=31650 Epoch=61.7] | Loss=0.00786 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.034 | L2-Norm(final)=3.224 | 3632.8 samples/s | 56.8 steps/s
[Step=31700 Epoch=61.8] | Loss=0.00781 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.033 | L2-Norm(final)=3.225 | 4304.2 samples/s | 67.3 steps/s
[Step=31750 Epoch=61.9] | Loss=0.00763 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.033 | L2-Norm(final)=3.225 | 1626.8 samples/s | 25.4 steps/s
[Step=31800 Epoch=62.0] | Loss=0.00744 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.032 | L2-Norm(final)=3.226 | 3550.7 samples/s | 55.5 steps/s
[Step=31850 Epoch=62.1] | Loss=0.00727 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.032 | L2-Norm(final)=3.227 | 3534.8 samples/s | 55.2 steps/s
[Step=31900 Epoch=62.2] | Loss=0.00707 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.031 | L2-Norm(final)=3.228 | 3587.0 samples/s | 56.0 steps/s
[Step=31950 Epoch=62.3] | Loss=0.00689 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.031 | L2-Norm(final)=3.229 | 3586.4 samples/s | 56.0 steps/s
[Step=32000 Epoch=62.4] | Loss=0.00688 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.031 | L2-Norm(final)=3.230 | 3590.3 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=61.0] | Loss=0.07946 | Reg=0.00291 | FP-Reg=0.000 | acc=0.9219 | L2-Norm=17.063 | L2-Norm(final)=3.217 | 3963.8 samples/s | 61.9 steps/s
[Step=31250 Epoch=61.1] | Loss=0.01624 | Reg=0.00291 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.047 | L2-Norm(final)=3.216 | 3527.2 samples/s | 55.1 steps/s
[Step=31300 Epoch=61.2] | Loss=0.01198 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.042 | L2-Norm(final)=3.217 | 3695.3 samples/s | 57.7 steps/s
[Step=31350 Epoch=61.3] | Loss=0.00991 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.039 | L2-Norm(final)=3.218 | 3676.4 samples/s | 57.4 steps/s
[Step=31400 Epoch=61.4] | Loss=0.00885 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.037 | L2-Norm(final)=3.220 | 3683.5 samples/s | 57.6 steps/s
[Step=31450 Epoch=61.5] | Loss=0.00820 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.036 | L2-Norm(final)=3.221 | 3659.2 samples/s | 57.2 steps/s
[Step=31500 Epoch=61.6] | Loss=0.00774 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.036 | L2-Norm(final)=3.222 | 3667.8 samples/s | 57.3 steps/s
[Step=31550 Epoch=61.7] | Loss=0.00755 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.035 | L2-Norm(final)=3.224 | 3686.7 samples/s | 57.6 steps/s
[Step=31600 Epoch=61.8] | Loss=0.00769 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.034 | L2-Norm(final)=3.225 | 3669.4 samples/s | 57.3 steps/s
[Step=31650 Epoch=61.9] | Loss=0.00765 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.033 | L2-Norm(final)=3.226 | 3683.0 samples/s | 57.5 steps/s
[Step=31700 Epoch=62.0] | Loss=0.00732 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.033 | L2-Norm(final)=3.227 | 4287.2 samples/s | 67.0 steps/s
[Step=31750 Epoch=62.1] | Loss=0.00706 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.033 | L2-Norm(final)=3.228 | 1673.3 samples/s | 26.1 steps/s
[Step=31800 Epoch=62.2] | Loss=0.00694 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.032 | L2-Norm(final)=3.229 | 3641.3 samples/s | 56.9 steps/s
[Step=31850 Epoch=62.3] | Loss=0.00689 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.032 | L2-Norm(final)=3.230 | 3590.0 samples/s | 56.1 steps/s
[Step=31900 Epoch=62.4] | Loss=0.00676 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.032 | L2-Norm(final)=3.231 | 3562.9 samples/s | 55.7 steps/s
[Step=31950 Epoch=62.5] | Loss=0.00665 | Reg=0.00290 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=17.032 | L2-Norm(final)=3.232 | 3558.4 samples/s | 55.6 steps/s
[Step=32000 Epoch=62.6] | Loss=0.00656 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.031 | L2-Norm(final)=3.233 | 3697.2 samples/s | 57.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step32000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=119.6] | Loss=0.09895 | Reg=0.00291 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=17.063 | L2-Norm(final)=3.217 | 3797.5 samples/s | 59.3 steps/s
[Step=31250 Epoch=119.7] | Loss=0.00584 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.023 | L2-Norm(final)=3.215 | 3227.8 samples/s | 50.4 steps/s
[Step=31300 Epoch=119.9] | Loss=0.00295 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.017 | L2-Norm(final)=3.215 | 3405.6 samples/s | 53.2 steps/s
[Step=31350 Epoch=120.1] | Loss=0.00208 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.013 | L2-Norm(final)=3.216 | 3406.3 samples/s | 53.2 steps/s
[Step=31400 Epoch=120.3] | Loss=0.00157 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.010 | L2-Norm(final)=3.216 | 3395.8 samples/s | 53.1 steps/s
[Step=31450 Epoch=120.5] | Loss=0.00126 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.007 | L2-Norm(final)=3.216 | 4026.2 samples/s | 62.9 steps/s
[Step=31500 Epoch=120.7] | Loss=0.00105 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.005 | L2-Norm(final)=3.216 | 1602.9 samples/s | 25.0 steps/s
[Step=31550 Epoch=120.9] | Loss=0.00090 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.003 | L2-Norm(final)=3.216 | 3422.9 samples/s | 53.5 steps/s
[Step=31600 Epoch=121.1] | Loss=0.00079 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.001 | L2-Norm(final)=3.217 | 3484.5 samples/s | 54.4 steps/s
[Step=31650 Epoch=121.3] | Loss=0.00071 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.000 | L2-Norm(final)=3.217 | 3497.1 samples/s | 54.6 steps/s
[Step=31700 Epoch=121.5] | Loss=0.00064 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.998 | L2-Norm(final)=3.217 | 3790.9 samples/s | 59.2 steps/s
[Step=31750 Epoch=121.7] | Loss=0.00058 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.997 | L2-Norm(final)=3.217 | 1647.5 samples/s | 25.7 steps/s
[Step=31800 Epoch=121.8] | Loss=0.00053 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.995 | L2-Norm(final)=3.217 | 3408.2 samples/s | 53.3 steps/s
[Step=31850 Epoch=122.0] | Loss=0.00049 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.994 | L2-Norm(final)=3.217 | 3456.2 samples/s | 54.0 steps/s
[Step=31900 Epoch=122.2] | Loss=0.00046 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.993 | L2-Norm(final)=3.217 | 3399.3 samples/s | 53.1 steps/s
[Step=31950 Epoch=122.4] | Loss=0.00043 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.992 | L2-Norm(final)=3.217 | 3371.8 samples/s | 52.7 steps/s
[Step=32000 Epoch=122.6] | Loss=0.00040 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.990 | L2-Norm(final)=3.218 | 1728.4 samples/s | 27.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step32000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=120.1] | Loss=0.06494 | Reg=0.00291 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=17.063 | L2-Norm(final)=3.217 | 3759.4 samples/s | 58.7 steps/s
[Step=31250 Epoch=120.3] | Loss=0.00805 | Reg=0.00290 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.020 | L2-Norm(final)=3.214 | 3136.6 samples/s | 49.0 steps/s
[Step=31300 Epoch=120.5] | Loss=0.00405 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.014 | L2-Norm(final)=3.213 | 3330.5 samples/s | 52.0 steps/s
[Step=31350 Epoch=120.7] | Loss=0.00271 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.010 | L2-Norm(final)=3.213 | 3330.3 samples/s | 52.0 steps/s
[Step=31400 Epoch=120.9] | Loss=0.00205 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.007 | L2-Norm(final)=3.213 | 3341.5 samples/s | 52.2 steps/s
[Step=31450 Epoch=121.1] | Loss=0.00165 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.005 | L2-Norm(final)=3.213 | 4057.8 samples/s | 63.4 steps/s
[Step=31500 Epoch=121.3] | Loss=0.00138 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.003 | L2-Norm(final)=3.213 | 1622.4 samples/s | 25.3 steps/s
[Step=31550 Epoch=121.4] | Loss=0.00118 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=17.001 | L2-Norm(final)=3.213 | 3436.4 samples/s | 53.7 steps/s
[Step=31600 Epoch=121.6] | Loss=0.00104 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.999 | L2-Norm(final)=3.213 | 3424.0 samples/s | 53.5 steps/s
[Step=31650 Epoch=121.8] | Loss=0.00092 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.998 | L2-Norm(final)=3.213 | 3379.6 samples/s | 52.8 steps/s
[Step=31700 Epoch=122.0] | Loss=0.00083 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.997 | L2-Norm(final)=3.213 | 3759.4 samples/s | 58.7 steps/s
[Step=31750 Epoch=122.2] | Loss=0.00076 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.995 | L2-Norm(final)=3.213 | 1687.9 samples/s | 26.4 steps/s
[Step=31800 Epoch=122.4] | Loss=0.00070 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.994 | L2-Norm(final)=3.214 | 3440.1 samples/s | 53.8 steps/s
[Step=31850 Epoch=122.6] | Loss=0.00064 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.993 | L2-Norm(final)=3.214 | 3373.6 samples/s | 52.7 steps/s
[Step=31900 Epoch=122.8] | Loss=0.00060 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.992 | L2-Norm(final)=3.214 | 3395.6 samples/s | 53.1 steps/s
[Step=31950 Epoch=123.0] | Loss=0.00056 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.991 | L2-Norm(final)=3.214 | 3441.6 samples/s | 53.8 steps/s
[Step=32000 Epoch=123.2] | Loss=0.00053 | Reg=0.00289 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.990 | L2-Norm(final)=3.214 | 1735.1 samples/s | 27.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20201 | acc=0.8867 | tpr=0.8417 | fpr=0.0156 | 3831.1 samples/s | 15.0 steps/s
Avg test loss: 0.20549, Avg test acc: 0.88457, Avg tpr: 0.84053, Avg fpr: 0.01859, total FA: 145

Testing server on iccad2012
[Step=  50] | Loss=0.37979 | acc=0.8705 | tpr=0.9779 | fpr=0.1314 | 3828.3 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.38763 | acc=0.8716 | tpr=0.9765 | fpr=0.1303 | 7132.5 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.39322 | acc=0.8704 | tpr=0.9784 | fpr=0.1316 | 7176.2 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.39446 | acc=0.8711 | tpr=0.9792 | fpr=0.1308 | 4891.1 samples/s | 19.1 steps/s
[Step= 250] | Loss=0.39369 | acc=0.8704 | tpr=0.9773 | fpr=0.1315 | 6626.8 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.39571 | acc=0.8703 | tpr=0.9782 | fpr=0.1316 | 7126.9 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.39929 | acc=0.8699 | tpr=0.9781 | fpr=0.1321 | 7650.5 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.40043 | acc=0.8696 | tpr=0.9754 | fpr=0.1323 | 6140.6 samples/s | 24.0 steps/s
[Step= 450] | Loss=0.40379 | acc=0.8694 | tpr=0.9771 | fpr=0.1325 | 6998.6 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.40295 | acc=0.8693 | tpr=0.9775 | fpr=0.1327 | 7213.2 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.40059 | acc=0.8697 | tpr=0.9769 | fpr=0.1322 | 13211.1 samples/s | 51.6 steps/s
Avg test loss: 0.40020, Avg test acc: 0.86977, Avg tpr: 0.97662, Avg fpr: 0.13217, total FA: 18352

server round 40/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=62.4] | Loss=0.07144 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.995 | L2-Norm(final)=3.231 | 3525.3 samples/s | 55.1 steps/s
[Step=32050 Epoch=62.5] | Loss=0.02217 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.980 | L2-Norm(final)=3.232 | 3487.9 samples/s | 54.5 steps/s
[Step=32100 Epoch=62.6] | Loss=0.01466 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.975 | L2-Norm(final)=3.232 | 3524.5 samples/s | 55.1 steps/s
[Step=32150 Epoch=62.7] | Loss=0.01201 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.972 | L2-Norm(final)=3.233 | 3559.4 samples/s | 55.6 steps/s
[Step=32200 Epoch=62.8] | Loss=0.01057 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.969 | L2-Norm(final)=3.234 | 3548.6 samples/s | 55.4 steps/s
[Step=32250 Epoch=62.9] | Loss=0.00969 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.968 | L2-Norm(final)=3.234 | 3581.6 samples/s | 56.0 steps/s
[Step=32300 Epoch=63.0] | Loss=0.00899 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.967 | L2-Norm(final)=3.235 | 3604.3 samples/s | 56.3 steps/s
[Step=32350 Epoch=63.1] | Loss=0.00843 | Reg=0.00288 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.966 | L2-Norm(final)=3.236 | 3688.4 samples/s | 57.6 steps/s
[Step=32400 Epoch=63.2] | Loss=0.00791 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.965 | L2-Norm(final)=3.237 | 3693.3 samples/s | 57.7 steps/s
[Step=32450 Epoch=63.3] | Loss=0.00750 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.964 | L2-Norm(final)=3.238 | 3647.2 samples/s | 57.0 steps/s
[Step=32500 Epoch=63.4] | Loss=0.00713 | Reg=0.00288 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.963 | L2-Norm(final)=3.238 | 4164.8 samples/s | 65.1 steps/s
[Step=32550 Epoch=63.5] | Loss=0.00688 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.963 | L2-Norm(final)=3.239 | 1621.9 samples/s | 25.3 steps/s
[Step=32600 Epoch=63.6] | Loss=0.00685 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.962 | L2-Norm(final)=3.240 | 3660.4 samples/s | 57.2 steps/s
[Step=32650 Epoch=63.7] | Loss=0.00668 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.962 | L2-Norm(final)=3.241 | 3639.4 samples/s | 56.9 steps/s
[Step=32700 Epoch=63.8] | Loss=0.00639 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.962 | L2-Norm(final)=3.241 | 3586.3 samples/s | 56.0 steps/s
[Step=32750 Epoch=63.9] | Loss=0.00621 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.961 | L2-Norm(final)=3.242 | 3580.3 samples/s | 55.9 steps/s
[Step=32800 Epoch=64.0] | Loss=0.00612 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.961 | L2-Norm(final)=3.243 | 3588.7 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step32800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=62.6] | Loss=0.21015 | Reg=0.00289 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=16.995 | L2-Norm(final)=3.231 | 3747.0 samples/s | 58.5 steps/s
[Step=32050 Epoch=62.7] | Loss=0.01834 | Reg=0.00288 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.980 | L2-Norm(final)=3.232 | 3649.9 samples/s | 57.0 steps/s
[Step=32100 Epoch=62.8] | Loss=0.01194 | Reg=0.00288 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.974 | L2-Norm(final)=3.233 | 3647.9 samples/s | 57.0 steps/s
[Step=32150 Epoch=62.9] | Loss=0.01001 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.971 | L2-Norm(final)=3.234 | 3618.2 samples/s | 56.5 steps/s
[Step=32200 Epoch=63.0] | Loss=0.00854 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.969 | L2-Norm(final)=3.235 | 3552.6 samples/s | 55.5 steps/s
[Step=32250 Epoch=63.0] | Loss=0.00820 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.967 | L2-Norm(final)=3.236 | 3592.3 samples/s | 56.1 steps/s
[Step=32300 Epoch=63.1] | Loss=0.00769 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.966 | L2-Norm(final)=3.237 | 3591.0 samples/s | 56.1 steps/s
[Step=32350 Epoch=63.2] | Loss=0.00727 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.965 | L2-Norm(final)=3.238 | 3591.1 samples/s | 56.1 steps/s
[Step=32400 Epoch=63.3] | Loss=0.00703 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.965 | L2-Norm(final)=3.239 | 3582.5 samples/s | 56.0 steps/s
[Step=32450 Epoch=63.4] | Loss=0.00691 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.964 | L2-Norm(final)=3.240 | 3671.4 samples/s | 57.4 steps/s
[Step=32500 Epoch=63.5] | Loss=0.00678 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.964 | L2-Norm(final)=3.241 | 4337.4 samples/s | 67.8 steps/s
[Step=32550 Epoch=63.6] | Loss=0.00667 | Reg=0.00288 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.963 | L2-Norm(final)=3.242 | 1666.9 samples/s | 26.0 steps/s
[Step=32600 Epoch=63.7] | Loss=0.00636 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.963 | L2-Norm(final)=3.243 | 3524.5 samples/s | 55.1 steps/s
[Step=32650 Epoch=63.8] | Loss=0.00615 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.963 | L2-Norm(final)=3.243 | 3564.0 samples/s | 55.7 steps/s
[Step=32700 Epoch=63.9] | Loss=0.00600 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.962 | L2-Norm(final)=3.244 | 3616.0 samples/s | 56.5 steps/s
[Step=32750 Epoch=64.0] | Loss=0.00587 | Reg=0.00288 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.962 | L2-Norm(final)=3.245 | 3592.6 samples/s | 56.1 steps/s
[Step=32800 Epoch=64.1] | Loss=0.00584 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.962 | L2-Norm(final)=3.246 | 3592.7 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step32800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=122.6] | Loss=0.06455 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=16.995 | L2-Norm(final)=3.231 | 3901.3 samples/s | 61.0 steps/s
[Step=32050 Epoch=122.8] | Loss=0.00654 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.957 | L2-Norm(final)=3.232 | 3201.5 samples/s | 50.0 steps/s
[Step=32100 Epoch=123.0] | Loss=0.00330 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.949 | L2-Norm(final)=3.232 | 3431.6 samples/s | 53.6 steps/s
[Step=32150 Epoch=123.2] | Loss=0.00222 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.945 | L2-Norm(final)=3.232 | 3486.2 samples/s | 54.5 steps/s
[Step=32200 Epoch=123.4] | Loss=0.00167 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.942 | L2-Norm(final)=3.232 | 3469.2 samples/s | 54.2 steps/s
[Step=32250 Epoch=123.6] | Loss=0.00135 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.940 | L2-Norm(final)=3.232 | 4110.8 samples/s | 64.2 steps/s
[Step=32300 Epoch=123.8] | Loss=0.00113 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.938 | L2-Norm(final)=3.232 | 1617.2 samples/s | 25.3 steps/s
[Step=32350 Epoch=124.0] | Loss=0.00097 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.936 | L2-Norm(final)=3.232 | 3386.5 samples/s | 52.9 steps/s
[Step=32400 Epoch=124.1] | Loss=0.00085 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.935 | L2-Norm(final)=3.232 | 3446.2 samples/s | 53.8 steps/s
[Step=32450 Epoch=124.3] | Loss=0.00076 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.934 | L2-Norm(final)=3.232 | 3501.4 samples/s | 54.7 steps/s
[Step=32500 Epoch=124.5] | Loss=0.00069 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.932 | L2-Norm(final)=3.233 | 3779.9 samples/s | 59.1 steps/s
[Step=32550 Epoch=124.7] | Loss=0.00063 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.931 | L2-Norm(final)=3.233 | 1678.9 samples/s | 26.2 steps/s
[Step=32600 Epoch=124.9] | Loss=0.00058 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.930 | L2-Norm(final)=3.233 | 3373.5 samples/s | 52.7 steps/s
[Step=32650 Epoch=125.1] | Loss=0.00054 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.929 | L2-Norm(final)=3.233 | 3362.0 samples/s | 52.5 steps/s
[Step=32700 Epoch=125.3] | Loss=0.00050 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.928 | L2-Norm(final)=3.233 | 3384.3 samples/s | 52.9 steps/s
[Step=32750 Epoch=125.5] | Loss=0.00047 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.927 | L2-Norm(final)=3.233 | 3379.3 samples/s | 52.8 steps/s
[Step=32800 Epoch=125.7] | Loss=0.00044 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.927 | L2-Norm(final)=3.233 | 1760.5 samples/s | 27.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step32800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=123.2] | Loss=0.08142 | Reg=0.00289 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.995 | L2-Norm(final)=3.231 | 3608.4 samples/s | 56.4 steps/s
[Step=32050 Epoch=123.4] | Loss=0.00580 | Reg=0.00288 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.958 | L2-Norm(final)=3.232 | 3463.8 samples/s | 54.1 steps/s
[Step=32100 Epoch=123.6] | Loss=0.00294 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.951 | L2-Norm(final)=3.233 | 3467.7 samples/s | 54.2 steps/s
[Step=32150 Epoch=123.8] | Loss=0.00200 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.947 | L2-Norm(final)=3.233 | 3388.9 samples/s | 53.0 steps/s
[Step=32200 Epoch=124.0] | Loss=0.00151 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.944 | L2-Norm(final)=3.233 | 3406.7 samples/s | 53.2 steps/s
[Step=32250 Epoch=124.1] | Loss=0.00122 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.942 | L2-Norm(final)=3.233 | 4136.3 samples/s | 64.6 steps/s
[Step=32300 Epoch=124.3] | Loss=0.00102 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.940 | L2-Norm(final)=3.233 | 1625.3 samples/s | 25.4 steps/s
[Step=32350 Epoch=124.5] | Loss=0.00088 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.938 | L2-Norm(final)=3.233 | 3477.6 samples/s | 54.3 steps/s
[Step=32400 Epoch=124.7] | Loss=0.00077 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.937 | L2-Norm(final)=3.233 | 3478.2 samples/s | 54.3 steps/s
[Step=32450 Epoch=124.9] | Loss=0.00069 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.935 | L2-Norm(final)=3.233 | 3470.0 samples/s | 54.2 steps/s
[Step=32500 Epoch=125.1] | Loss=0.00062 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.934 | L2-Norm(final)=3.234 | 3851.8 samples/s | 60.2 steps/s
[Step=32550 Epoch=125.3] | Loss=0.00057 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.933 | L2-Norm(final)=3.234 | 1658.8 samples/s | 25.9 steps/s
[Step=32600 Epoch=125.5] | Loss=0.00053 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.932 | L2-Norm(final)=3.234 | 3484.9 samples/s | 54.5 steps/s
[Step=32650 Epoch=125.7] | Loss=0.00049 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.931 | L2-Norm(final)=3.234 | 3474.8 samples/s | 54.3 steps/s
[Step=32700 Epoch=125.9] | Loss=0.00045 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.930 | L2-Norm(final)=3.234 | 3510.7 samples/s | 54.9 steps/s
[Step=32750 Epoch=126.1] | Loss=0.00043 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.929 | L2-Norm(final)=3.234 | 3526.5 samples/s | 55.1 steps/s
[Step=32800 Epoch=126.3] | Loss=0.00040 | Reg=0.00287 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.928 | L2-Norm(final)=3.234 | 1744.7 samples/s | 27.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17892 | acc=0.9026 | tpr=0.8650 | fpr=0.0159 | 3801.1 samples/s | 14.8 steps/s
Avg test loss: 0.18227, Avg test acc: 0.90007, Avg tpr: 0.86303, Avg fpr: 0.01846, total FA: 144

Testing server on iccad2012
[Step=  50] | Loss=0.41819 | acc=0.8537 | tpr=0.9779 | fpr=0.1486 | 3816.7 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.42562 | acc=0.8543 | tpr=0.9744 | fpr=0.1479 | 7129.8 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.43127 | acc=0.8539 | tpr=0.9769 | fpr=0.1484 | 7065.8 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.43215 | acc=0.8547 | tpr=0.9770 | fpr=0.1476 | 4459.8 samples/s | 17.4 steps/s
[Step= 250] | Loss=0.43155 | acc=0.8538 | tpr=0.9747 | fpr=0.1484 | 7178.6 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.43326 | acc=0.8536 | tpr=0.9738 | fpr=0.1485 | 7193.4 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.43692 | acc=0.8533 | tpr=0.9743 | fpr=0.1489 | 7118.6 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.43808 | acc=0.8530 | tpr=0.9726 | fpr=0.1491 | 6901.4 samples/s | 27.0 steps/s
[Step= 450] | Loss=0.44144 | acc=0.8529 | tpr=0.9747 | fpr=0.1493 | 7240.5 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.44075 | acc=0.8527 | tpr=0.9753 | fpr=0.1495 | 6894.0 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.43812 | acc=0.8532 | tpr=0.9741 | fpr=0.1490 | 13431.3 samples/s | 52.5 steps/s
Avg test loss: 0.43769, Avg test acc: 0.85327, Avg tpr: 0.97385, Avg fpr: 0.14893, total FA: 20678

server round 41/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=64.0] | Loss=0.05004 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.933 | L2-Norm(final)=3.245 | 3389.1 samples/s | 53.0 steps/s
[Step=32850 Epoch=64.1] | Loss=0.01386 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.917 | L2-Norm(final)=3.246 | 3564.2 samples/s | 55.7 steps/s
[Step=32900 Epoch=64.2] | Loss=0.00982 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.912 | L2-Norm(final)=3.247 | 3574.3 samples/s | 55.8 steps/s
[Step=32950 Epoch=64.3] | Loss=0.00851 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.909 | L2-Norm(final)=3.248 | 3574.9 samples/s | 55.9 steps/s
[Step=33000 Epoch=64.4] | Loss=0.00779 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.907 | L2-Norm(final)=3.249 | 3592.8 samples/s | 56.1 steps/s
[Step=33050 Epoch=64.5] | Loss=0.00752 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.905 | L2-Norm(final)=3.249 | 3592.8 samples/s | 56.1 steps/s
[Step=33100 Epoch=64.6] | Loss=0.00716 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.904 | L2-Norm(final)=3.250 | 3573.7 samples/s | 55.8 steps/s
[Step=33150 Epoch=64.7] | Loss=0.00691 | Reg=0.00286 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.903 | L2-Norm(final)=3.251 | 3572.8 samples/s | 55.8 steps/s
[Step=33200 Epoch=64.8] | Loss=0.00666 | Reg=0.00286 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.902 | L2-Norm(final)=3.252 | 3550.9 samples/s | 55.5 steps/s
[Step=33250 Epoch=64.9] | Loss=0.00661 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.901 | L2-Norm(final)=3.253 | 3633.3 samples/s | 56.8 steps/s
[Step=33300 Epoch=64.9] | Loss=0.00645 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.901 | L2-Norm(final)=3.254 | 4175.9 samples/s | 65.2 steps/s
[Step=33350 Epoch=65.0] | Loss=0.00630 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.900 | L2-Norm(final)=3.254 | 1636.0 samples/s | 25.6 steps/s
[Step=33400 Epoch=65.1] | Loss=0.00617 | Reg=0.00286 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.900 | L2-Norm(final)=3.255 | 3654.6 samples/s | 57.1 steps/s
[Step=33450 Epoch=65.2] | Loss=0.00602 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.900 | L2-Norm(final)=3.256 | 3688.7 samples/s | 57.6 steps/s
[Step=33500 Epoch=65.3] | Loss=0.00583 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.899 | L2-Norm(final)=3.257 | 3694.4 samples/s | 57.7 steps/s
[Step=33550 Epoch=65.4] | Loss=0.00581 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.899 | L2-Norm(final)=3.258 | 3698.6 samples/s | 57.8 steps/s
[Step=33600 Epoch=65.5] | Loss=0.00570 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.899 | L2-Norm(final)=3.258 | 3691.2 samples/s | 57.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step33600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=64.1] | Loss=0.04298 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.933 | L2-Norm(final)=3.245 | 4240.4 samples/s | 66.3 steps/s
[Step=32850 Epoch=64.2] | Loss=0.01466 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.918 | L2-Norm(final)=3.247 | 3178.3 samples/s | 49.7 steps/s
[Step=32900 Epoch=64.3] | Loss=0.01097 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.912 | L2-Norm(final)=3.248 | 3685.2 samples/s | 57.6 steps/s
[Step=32950 Epoch=64.4] | Loss=0.00914 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.909 | L2-Norm(final)=3.248 | 3713.2 samples/s | 58.0 steps/s
[Step=33000 Epoch=64.5] | Loss=0.00831 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.907 | L2-Norm(final)=3.249 | 3690.6 samples/s | 57.7 steps/s
[Step=33050 Epoch=64.6] | Loss=0.00805 | Reg=0.00286 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.905 | L2-Norm(final)=3.250 | 3688.4 samples/s | 57.6 steps/s
[Step=33100 Epoch=64.7] | Loss=0.00765 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.904 | L2-Norm(final)=3.251 | 3628.5 samples/s | 56.7 steps/s
[Step=33150 Epoch=64.8] | Loss=0.00709 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.904 | L2-Norm(final)=3.252 | 3593.4 samples/s | 56.1 steps/s
[Step=33200 Epoch=64.9] | Loss=0.00675 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.903 | L2-Norm(final)=3.253 | 3583.4 samples/s | 56.0 steps/s
[Step=33250 Epoch=65.0] | Loss=0.00641 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.902 | L2-Norm(final)=3.254 | 3600.5 samples/s | 56.3 steps/s
[Step=33300 Epoch=65.1] | Loss=0.00630 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.902 | L2-Norm(final)=3.255 | 4146.7 samples/s | 64.8 steps/s
[Step=33350 Epoch=65.2] | Loss=0.00611 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.902 | L2-Norm(final)=3.256 | 1669.9 samples/s | 26.1 steps/s
[Step=33400 Epoch=65.3] | Loss=0.00588 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.901 | L2-Norm(final)=3.257 | 3574.6 samples/s | 55.9 steps/s
[Step=33450 Epoch=65.4] | Loss=0.00575 | Reg=0.00286 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.901 | L2-Norm(final)=3.257 | 3569.4 samples/s | 55.8 steps/s
[Step=33500 Epoch=65.5] | Loss=0.00548 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.901 | L2-Norm(final)=3.258 | 3591.4 samples/s | 56.1 steps/s
[Step=33550 Epoch=65.6] | Loss=0.00537 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.901 | L2-Norm(final)=3.259 | 3597.2 samples/s | 56.2 steps/s
[Step=33600 Epoch=65.7] | Loss=0.00522 | Reg=0.00286 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.900 | L2-Norm(final)=3.260 | 3602.6 samples/s | 56.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step33600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=125.7] | Loss=0.08171 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.933 | L2-Norm(final)=3.245 | 3626.7 samples/s | 56.7 steps/s
[Step=32850 Epoch=125.9] | Loss=0.00599 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.895 | L2-Norm(final)=3.247 | 3369.5 samples/s | 52.6 steps/s
[Step=32900 Epoch=126.1] | Loss=0.00303 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.889 | L2-Norm(final)=3.247 | 3430.6 samples/s | 53.6 steps/s
[Step=32950 Epoch=126.3] | Loss=0.00203 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.885 | L2-Norm(final)=3.247 | 3501.5 samples/s | 54.7 steps/s
[Step=33000 Epoch=126.4] | Loss=0.00154 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.882 | L2-Norm(final)=3.247 | 3528.4 samples/s | 55.1 steps/s
[Step=33050 Epoch=126.6] | Loss=0.00124 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.880 | L2-Norm(final)=3.248 | 4235.1 samples/s | 66.2 steps/s
[Step=33100 Epoch=126.8] | Loss=0.00104 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.878 | L2-Norm(final)=3.248 | 1633.7 samples/s | 25.5 steps/s
[Step=33150 Epoch=127.0] | Loss=0.00089 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.877 | L2-Norm(final)=3.248 | 3498.2 samples/s | 54.7 steps/s
[Step=33200 Epoch=127.2] | Loss=0.00078 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.875 | L2-Norm(final)=3.248 | 3495.8 samples/s | 54.6 steps/s
[Step=33250 Epoch=127.4] | Loss=0.00070 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.874 | L2-Norm(final)=3.248 | 3503.2 samples/s | 54.7 steps/s
[Step=33300 Epoch=127.6] | Loss=0.00063 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.873 | L2-Norm(final)=3.248 | 3758.2 samples/s | 58.7 steps/s
[Step=33350 Epoch=127.8] | Loss=0.00058 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.872 | L2-Norm(final)=3.248 | 1696.4 samples/s | 26.5 steps/s
[Step=33400 Epoch=128.0] | Loss=0.00053 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.871 | L2-Norm(final)=3.248 | 3524.6 samples/s | 55.1 steps/s
[Step=33450 Epoch=128.2] | Loss=0.00049 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.870 | L2-Norm(final)=3.248 | 3471.5 samples/s | 54.2 steps/s
[Step=33500 Epoch=128.4] | Loss=0.00046 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.869 | L2-Norm(final)=3.248 | 3411.0 samples/s | 53.3 steps/s
[Step=33550 Epoch=128.6] | Loss=0.00043 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.868 | L2-Norm(final)=3.248 | 3504.5 samples/s | 54.8 steps/s
[Step=33600 Epoch=128.7] | Loss=0.00040 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.867 | L2-Norm(final)=3.248 | 1731.5 samples/s | 27.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step33600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=126.3] | Loss=0.04595 | Reg=0.00287 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.933 | L2-Norm(final)=3.245 | 3688.1 samples/s | 57.6 steps/s
[Step=32850 Epoch=126.5] | Loss=0.00627 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.894 | L2-Norm(final)=3.246 | 3382.2 samples/s | 52.8 steps/s
[Step=32900 Epoch=126.6] | Loss=0.00317 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.887 | L2-Norm(final)=3.247 | 3393.7 samples/s | 53.0 steps/s
[Step=32950 Epoch=126.8] | Loss=0.00213 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.883 | L2-Norm(final)=3.247 | 3396.9 samples/s | 53.1 steps/s
[Step=33000 Epoch=127.0] | Loss=0.00161 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.880 | L2-Norm(final)=3.247 | 3412.5 samples/s | 53.3 steps/s
[Step=33050 Epoch=127.2] | Loss=0.00129 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.878 | L2-Norm(final)=3.247 | 4119.2 samples/s | 64.4 steps/s
[Step=33100 Epoch=127.4] | Loss=0.00108 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.876 | L2-Norm(final)=3.247 | 1598.6 samples/s | 25.0 steps/s
[Step=33150 Epoch=127.6] | Loss=0.00093 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.875 | L2-Norm(final)=3.247 | 3405.9 samples/s | 53.2 steps/s
[Step=33200 Epoch=127.8] | Loss=0.00082 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.873 | L2-Norm(final)=3.247 | 3393.5 samples/s | 53.0 steps/s
[Step=33250 Epoch=128.0] | Loss=0.00073 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.872 | L2-Norm(final)=3.247 | 3419.1 samples/s | 53.4 steps/s
[Step=33300 Epoch=128.2] | Loss=0.00066 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.871 | L2-Norm(final)=3.248 | 3783.9 samples/s | 59.1 steps/s
[Step=33350 Epoch=128.4] | Loss=0.00060 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.870 | L2-Norm(final)=3.248 | 1164.4 samples/s | 18.2 steps/s
[Step=33400 Epoch=128.6] | Loss=0.00055 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.869 | L2-Norm(final)=3.248 | 3498.9 samples/s | 54.7 steps/s
[Step=33450 Epoch=128.8] | Loss=0.00051 | Reg=0.00285 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.868 | L2-Norm(final)=3.248 | 3292.1 samples/s | 51.4 steps/s
[Step=33500 Epoch=129.0] | Loss=0.00048 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.867 | L2-Norm(final)=3.248 | 3497.3 samples/s | 54.6 steps/s
[Step=33550 Epoch=129.1] | Loss=0.00045 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.866 | L2-Norm(final)=3.248 | 3228.5 samples/s | 50.4 steps/s
[Step=33600 Epoch=129.3] | Loss=0.00042 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.865 | L2-Norm(final)=3.248 | 1712.2 samples/s | 26.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19258 | acc=0.8964 | tpr=0.8552 | fpr=0.0141 | 3819.0 samples/s | 14.9 steps/s
Avg test loss: 0.19620, Avg test acc: 0.89426, Avg tpr: 0.85382, Avg fpr: 0.01679, total FA: 131

Testing server on iccad2012
[Step=  50] | Loss=0.39412 | acc=0.8625 | tpr=0.9779 | fpr=0.1396 | 3823.2 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.40129 | acc=0.8636 | tpr=0.9701 | fpr=0.1384 | 7248.3 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.40690 | acc=0.8628 | tpr=0.9712 | fpr=0.1392 | 7351.1 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.40776 | acc=0.8635 | tpr=0.9727 | fpr=0.1385 | 7231.2 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.40709 | acc=0.8631 | tpr=0.9712 | fpr=0.1389 | 7153.1 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.40861 | acc=0.8628 | tpr=0.9709 | fpr=0.1392 | 7272.6 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.41235 | acc=0.8622 | tpr=0.9712 | fpr=0.1397 | 7269.0 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.41359 | acc=0.8619 | tpr=0.9699 | fpr=0.1401 | 7039.1 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.41704 | acc=0.8618 | tpr=0.9722 | fpr=0.1402 | 7203.0 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.41632 | acc=0.8616 | tpr=0.9731 | fpr=0.1404 | 7112.9 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.41375 | acc=0.8622 | tpr=0.9721 | fpr=0.1398 | 13280.3 samples/s | 51.9 steps/s
Avg test loss: 0.41335, Avg test acc: 0.86229, Avg tpr: 0.97187, Avg fpr: 0.13971, total FA: 19398

server round 42/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=65.5] | Loss=0.05908 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.871 | L2-Norm(final)=3.260 | 3794.4 samples/s | 59.3 steps/s
[Step=33650 Epoch=65.6] | Loss=0.01765 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.857 | L2-Norm(final)=3.260 | 3505.8 samples/s | 54.8 steps/s
[Step=33700 Epoch=65.7] | Loss=0.01217 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.852 | L2-Norm(final)=3.261 | 3590.4 samples/s | 56.1 steps/s
[Step=33750 Epoch=65.8] | Loss=0.01040 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.849 | L2-Norm(final)=3.261 | 3598.4 samples/s | 56.2 steps/s
[Step=33800 Epoch=65.9] | Loss=0.00884 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.847 | L2-Norm(final)=3.262 | 3588.7 samples/s | 56.1 steps/s
[Step=33850 Epoch=66.0] | Loss=0.00807 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.845 | L2-Norm(final)=3.263 | 3567.2 samples/s | 55.7 steps/s
[Step=33900 Epoch=66.1] | Loss=0.00761 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.844 | L2-Norm(final)=3.264 | 3684.1 samples/s | 57.6 steps/s
[Step=33950 Epoch=66.2] | Loss=0.00726 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.843 | L2-Norm(final)=3.265 | 3625.2 samples/s | 56.6 steps/s
[Step=34000 Epoch=66.3] | Loss=0.00711 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.842 | L2-Norm(final)=3.265 | 3565.9 samples/s | 55.7 steps/s
[Step=34050 Epoch=66.4] | Loss=0.00682 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.842 | L2-Norm(final)=3.266 | 3564.7 samples/s | 55.7 steps/s
[Step=34100 Epoch=66.5] | Loss=0.00653 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.841 | L2-Norm(final)=3.267 | 4170.1 samples/s | 65.2 steps/s
[Step=34150 Epoch=66.6] | Loss=0.00622 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.840 | L2-Norm(final)=3.268 | 1632.2 samples/s | 25.5 steps/s
[Step=34200 Epoch=66.7] | Loss=0.00606 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.840 | L2-Norm(final)=3.268 | 3577.1 samples/s | 55.9 steps/s
[Step=34250 Epoch=66.8] | Loss=0.00588 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.840 | L2-Norm(final)=3.269 | 3591.8 samples/s | 56.1 steps/s
[Step=34300 Epoch=66.9] | Loss=0.00587 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.839 | L2-Norm(final)=3.270 | 3575.6 samples/s | 55.9 steps/s
[Step=34350 Epoch=67.0] | Loss=0.00583 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.839 | L2-Norm(final)=3.271 | 3587.6 samples/s | 56.1 steps/s
[Step=34400 Epoch=67.1] | Loss=0.00573 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.839 | L2-Norm(final)=3.271 | 3592.7 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step34400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=65.7] | Loss=0.06836 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.871 | L2-Norm(final)=3.260 | 4090.4 samples/s | 63.9 steps/s
[Step=33650 Epoch=65.8] | Loss=0.01287 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.856 | L2-Norm(final)=3.262 | 3346.0 samples/s | 52.3 steps/s
[Step=33700 Epoch=65.9] | Loss=0.00944 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.851 | L2-Norm(final)=3.263 | 3676.3 samples/s | 57.4 steps/s
[Step=33750 Epoch=66.0] | Loss=0.00846 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.848 | L2-Norm(final)=3.264 | 3697.8 samples/s | 57.8 steps/s
[Step=33800 Epoch=66.1] | Loss=0.00750 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.846 | L2-Norm(final)=3.265 | 3682.8 samples/s | 57.5 steps/s
[Step=33850 Epoch=66.2] | Loss=0.00691 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.845 | L2-Norm(final)=3.266 | 3661.8 samples/s | 57.2 steps/s
[Step=33900 Epoch=66.3] | Loss=0.00660 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.844 | L2-Norm(final)=3.267 | 3596.0 samples/s | 56.2 steps/s
[Step=33950 Epoch=66.4] | Loss=0.00629 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.843 | L2-Norm(final)=3.267 | 3584.8 samples/s | 56.0 steps/s
[Step=34000 Epoch=66.5] | Loss=0.00615 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.843 | L2-Norm(final)=3.268 | 3596.0 samples/s | 56.2 steps/s
[Step=34050 Epoch=66.6] | Loss=0.00607 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.842 | L2-Norm(final)=3.269 | 3558.4 samples/s | 55.6 steps/s
[Step=34100 Epoch=66.7] | Loss=0.00605 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.841 | L2-Norm(final)=3.270 | 4183.6 samples/s | 65.4 steps/s
[Step=34150 Epoch=66.8] | Loss=0.00584 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.841 | L2-Norm(final)=3.270 | 1700.4 samples/s | 26.6 steps/s
[Step=34200 Epoch=66.9] | Loss=0.00567 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.841 | L2-Norm(final)=3.271 | 3666.2 samples/s | 57.3 steps/s
[Step=34250 Epoch=67.0] | Loss=0.00564 | Reg=0.00284 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.840 | L2-Norm(final)=3.272 | 3572.0 samples/s | 55.8 steps/s
[Step=34300 Epoch=67.1] | Loss=0.00550 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.840 | L2-Norm(final)=3.273 | 3580.8 samples/s | 56.0 steps/s
[Step=34350 Epoch=67.2] | Loss=0.00535 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.840 | L2-Norm(final)=3.273 | 3595.9 samples/s | 56.2 steps/s
[Step=34400 Epoch=67.3] | Loss=0.00526 | Reg=0.00284 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.839 | L2-Norm(final)=3.274 | 3564.6 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step34400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=128.7] | Loss=0.02086 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.871 | L2-Norm(final)=3.260 | 3966.8 samples/s | 62.0 steps/s
[Step=33650 Epoch=128.9] | Loss=0.00423 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.835 | L2-Norm(final)=3.262 | 3130.1 samples/s | 48.9 steps/s
[Step=33700 Epoch=129.1] | Loss=0.00216 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.828 | L2-Norm(final)=3.262 | 3415.3 samples/s | 53.4 steps/s
[Step=33750 Epoch=129.3] | Loss=0.00147 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.825 | L2-Norm(final)=3.262 | 3438.6 samples/s | 53.7 steps/s
[Step=33800 Epoch=129.5] | Loss=0.00111 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.822 | L2-Norm(final)=3.262 | 3402.8 samples/s | 53.2 steps/s
[Step=33850 Epoch=129.7] | Loss=0.00090 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.819 | L2-Norm(final)=3.263 | 4094.9 samples/s | 64.0 steps/s
[Step=33900 Epoch=129.9] | Loss=0.00075 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.817 | L2-Norm(final)=3.263 | 1628.5 samples/s | 25.4 steps/s
[Step=33950 Epoch=130.1] | Loss=0.00065 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.816 | L2-Norm(final)=3.263 | 3462.3 samples/s | 54.1 steps/s
[Step=34000 Epoch=130.3] | Loss=0.00057 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.814 | L2-Norm(final)=3.263 | 3465.1 samples/s | 54.1 steps/s
[Step=34050 Epoch=130.5] | Loss=0.00051 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.813 | L2-Norm(final)=3.263 | 3454.8 samples/s | 54.0 steps/s
[Step=34100 Epoch=130.7] | Loss=0.00046 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.812 | L2-Norm(final)=3.263 | 3786.6 samples/s | 59.2 steps/s
[Step=34150 Epoch=130.9] | Loss=0.00042 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.810 | L2-Norm(final)=3.263 | 1687.1 samples/s | 26.4 steps/s
[Step=34200 Epoch=131.0] | Loss=0.00039 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.809 | L2-Norm(final)=3.263 | 3476.9 samples/s | 54.3 steps/s
[Step=34250 Epoch=131.2] | Loss=0.00036 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.808 | L2-Norm(final)=3.263 | 3495.6 samples/s | 54.6 steps/s
[Step=34300 Epoch=131.4] | Loss=0.00034 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.807 | L2-Norm(final)=3.263 | 3513.1 samples/s | 54.9 steps/s
[Step=34350 Epoch=131.6] | Loss=0.00032 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.806 | L2-Norm(final)=3.263 | 3507.0 samples/s | 54.8 steps/s
[Step=34400 Epoch=131.8] | Loss=0.00030 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.805 | L2-Norm(final)=3.263 | 1754.0 samples/s | 27.4 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step34400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=129.3] | Loss=0.01859 | Reg=0.00285 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.871 | L2-Norm(final)=3.260 | 3676.5 samples/s | 57.4 steps/s
[Step=33650 Epoch=129.5] | Loss=0.00703 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.835 | L2-Norm(final)=3.261 | 3363.8 samples/s | 52.6 steps/s
[Step=33700 Epoch=129.7] | Loss=0.00355 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.828 | L2-Norm(final)=3.261 | 3488.0 samples/s | 54.5 steps/s
[Step=33750 Epoch=129.9] | Loss=0.00238 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.824 | L2-Norm(final)=3.261 | 3483.6 samples/s | 54.4 steps/s
[Step=33800 Epoch=130.1] | Loss=0.00179 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.821 | L2-Norm(final)=3.261 | 3507.4 samples/s | 54.8 steps/s
[Step=33850 Epoch=130.3] | Loss=0.00144 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.819 | L2-Norm(final)=3.261 | 4274.5 samples/s | 66.8 steps/s
[Step=33900 Epoch=130.5] | Loss=0.00121 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.817 | L2-Norm(final)=3.261 | 1634.5 samples/s | 25.5 steps/s
[Step=33950 Epoch=130.7] | Loss=0.00104 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.815 | L2-Norm(final)=3.261 | 3445.5 samples/s | 53.8 steps/s
[Step=34000 Epoch=130.9] | Loss=0.00091 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.814 | L2-Norm(final)=3.261 | 3380.9 samples/s | 52.8 steps/s
[Step=34050 Epoch=131.1] | Loss=0.00081 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.812 | L2-Norm(final)=3.262 | 3416.8 samples/s | 53.4 steps/s
[Step=34100 Epoch=131.3] | Loss=0.00073 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.811 | L2-Norm(final)=3.262 | 3759.1 samples/s | 58.7 steps/s
[Step=34150 Epoch=131.5] | Loss=0.00067 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.810 | L2-Norm(final)=3.262 | 1674.0 samples/s | 26.2 steps/s
[Step=34200 Epoch=131.6] | Loss=0.00061 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.809 | L2-Norm(final)=3.262 | 3474.4 samples/s | 54.3 steps/s
[Step=34250 Epoch=131.8] | Loss=0.00057 | Reg=0.00283 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.808 | L2-Norm(final)=3.262 | 3456.3 samples/s | 54.0 steps/s
[Step=34300 Epoch=132.0] | Loss=0.00053 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.807 | L2-Norm(final)=3.262 | 3399.4 samples/s | 53.1 steps/s
[Step=34350 Epoch=132.2] | Loss=0.00050 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.806 | L2-Norm(final)=3.262 | 3431.7 samples/s | 53.6 steps/s
[Step=34400 Epoch=132.4] | Loss=0.00047 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.805 | L2-Norm(final)=3.262 | 1670.2 samples/s | 26.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17881 | acc=0.9059 | tpr=0.8697 | fpr=0.0156 | 3798.3 samples/s | 14.8 steps/s
Avg test loss: 0.18233, Avg test acc: 0.90396, Avg tpr: 0.86868, Avg fpr: 0.01846, total FA: 144

Testing server on iccad2012
[Step=  50] | Loss=0.42480 | acc=0.8560 | tpr=0.9779 | fpr=0.1462 | 3814.4 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.43141 | acc=0.8567 | tpr=0.9701 | fpr=0.1454 | 6997.3 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.43741 | acc=0.8558 | tpr=0.9741 | fpr=0.1464 | 7242.6 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.43845 | acc=0.8562 | tpr=0.9749 | fpr=0.1459 | 7365.3 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.43766 | acc=0.8555 | tpr=0.9729 | fpr=0.1467 | 7169.4 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.43908 | acc=0.8556 | tpr=0.9724 | fpr=0.1465 | 7105.5 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.44292 | acc=0.8552 | tpr=0.9724 | fpr=0.1469 | 7404.0 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.44409 | acc=0.8550 | tpr=0.9710 | fpr=0.1472 | 7155.9 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.44771 | acc=0.8548 | tpr=0.9732 | fpr=0.1473 | 7051.1 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.44697 | acc=0.8547 | tpr=0.9740 | fpr=0.1474 | 7442.7 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.44427 | acc=0.8553 | tpr=0.9729 | fpr=0.1468 | 12194.4 samples/s | 47.6 steps/s
Avg test loss: 0.44388, Avg test acc: 0.85536, Avg tpr: 0.97266, Avg fpr: 0.14677, total FA: 20379

server round 43/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=67.1] | Loss=0.07650 | Reg=0.00283 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.810 | L2-Norm(final)=3.273 | 3437.4 samples/s | 53.7 steps/s
[Step=34450 Epoch=67.2] | Loss=0.01457 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.796 | L2-Norm(final)=3.274 | 3667.5 samples/s | 57.3 steps/s
[Step=34500 Epoch=67.3] | Loss=0.00994 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.791 | L2-Norm(final)=3.275 | 3698.6 samples/s | 57.8 steps/s
[Step=34550 Epoch=67.4] | Loss=0.00834 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.788 | L2-Norm(final)=3.276 | 3696.0 samples/s | 57.8 steps/s
[Step=34600 Epoch=67.5] | Loss=0.00793 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.786 | L2-Norm(final)=3.277 | 3692.1 samples/s | 57.7 steps/s
[Step=34650 Epoch=67.6] | Loss=0.00750 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.784 | L2-Norm(final)=3.278 | 3717.1 samples/s | 58.1 steps/s
[Step=34700 Epoch=67.7] | Loss=0.00693 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.783 | L2-Norm(final)=3.279 | 3724.9 samples/s | 58.2 steps/s
[Step=34750 Epoch=67.8] | Loss=0.00659 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.783 | L2-Norm(final)=3.279 | 3621.1 samples/s | 56.6 steps/s
[Step=34800 Epoch=67.9] | Loss=0.00645 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.782 | L2-Norm(final)=3.280 | 3534.5 samples/s | 55.2 steps/s
[Step=34850 Epoch=68.0] | Loss=0.00630 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.781 | L2-Norm(final)=3.281 | 3538.7 samples/s | 55.3 steps/s
[Step=34900 Epoch=68.1] | Loss=0.00624 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.781 | L2-Norm(final)=3.282 | 4096.5 samples/s | 64.0 steps/s
[Step=34950 Epoch=68.2] | Loss=0.00610 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.780 | L2-Norm(final)=3.282 | 1566.6 samples/s | 24.5 steps/s
[Step=35000 Epoch=68.3] | Loss=0.00591 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.780 | L2-Norm(final)=3.283 | 3504.7 samples/s | 54.8 steps/s
[Step=35050 Epoch=68.4] | Loss=0.00584 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.779 | L2-Norm(final)=3.283 | 3506.2 samples/s | 54.8 steps/s
[Step=35100 Epoch=68.5] | Loss=0.00570 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.779 | L2-Norm(final)=3.284 | 3486.8 samples/s | 54.5 steps/s
[Step=35150 Epoch=68.6] | Loss=0.00571 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.779 | L2-Norm(final)=3.285 | 3494.2 samples/s | 54.6 steps/s
[Step=35200 Epoch=68.7] | Loss=0.00559 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.778 | L2-Norm(final)=3.285 | 3562.5 samples/s | 55.7 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step35200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=67.3] | Loss=0.13647 | Reg=0.00283 | FP-Reg=0.000 | acc=0.8594 | L2-Norm=16.810 | L2-Norm(final)=3.273 | 4148.4 samples/s | 64.8 steps/s
[Step=34450 Epoch=67.3] | Loss=0.01641 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.798 | L2-Norm(final)=3.274 | 3232.5 samples/s | 50.5 steps/s
[Step=34500 Epoch=67.4] | Loss=0.01085 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.792 | L2-Norm(final)=3.274 | 3574.7 samples/s | 55.9 steps/s
[Step=34550 Epoch=67.5] | Loss=0.00868 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.789 | L2-Norm(final)=3.275 | 3599.0 samples/s | 56.2 steps/s
[Step=34600 Epoch=67.6] | Loss=0.00764 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.787 | L2-Norm(final)=3.276 | 3578.1 samples/s | 55.9 steps/s
[Step=34650 Epoch=67.7] | Loss=0.00700 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.786 | L2-Norm(final)=3.277 | 3599.7 samples/s | 56.2 steps/s
[Step=34700 Epoch=67.8] | Loss=0.00700 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.785 | L2-Norm(final)=3.278 | 3606.7 samples/s | 56.4 steps/s
[Step=34750 Epoch=67.9] | Loss=0.00674 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.784 | L2-Norm(final)=3.278 | 3571.5 samples/s | 55.8 steps/s
[Step=34800 Epoch=68.0] | Loss=0.00663 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.783 | L2-Norm(final)=3.279 | 3573.9 samples/s | 55.8 steps/s
[Step=34850 Epoch=68.1] | Loss=0.00645 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.782 | L2-Norm(final)=3.279 | 3578.7 samples/s | 55.9 steps/s
[Step=34900 Epoch=68.2] | Loss=0.00631 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.782 | L2-Norm(final)=3.280 | 4209.2 samples/s | 65.8 steps/s
[Step=34950 Epoch=68.3] | Loss=0.00609 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.781 | L2-Norm(final)=3.281 | 1678.6 samples/s | 26.2 steps/s
[Step=35000 Epoch=68.4] | Loss=0.00603 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.781 | L2-Norm(final)=3.282 | 3603.7 samples/s | 56.3 steps/s
[Step=35050 Epoch=68.5] | Loss=0.00583 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.781 | L2-Norm(final)=3.282 | 3578.5 samples/s | 55.9 steps/s
[Step=35100 Epoch=68.6] | Loss=0.00572 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.780 | L2-Norm(final)=3.283 | 3619.7 samples/s | 56.6 steps/s
[Step=35150 Epoch=68.7] | Loss=0.00560 | Reg=0.00282 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.780 | L2-Norm(final)=3.284 | 3576.3 samples/s | 55.9 steps/s
[Step=35200 Epoch=68.8] | Loss=0.00555 | Reg=0.00282 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.780 | L2-Norm(final)=3.284 | 3598.1 samples/s | 56.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step35200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=131.8] | Loss=0.06189 | Reg=0.00283 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.810 | L2-Norm(final)=3.273 | 4018.9 samples/s | 62.8 steps/s
[Step=34450 Epoch=132.0] | Loss=0.00359 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.775 | L2-Norm(final)=3.276 | 3065.9 samples/s | 47.9 steps/s
[Step=34500 Epoch=132.2] | Loss=0.00183 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.769 | L2-Norm(final)=3.276 | 3429.2 samples/s | 53.6 steps/s
[Step=34550 Epoch=132.4] | Loss=0.00125 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.765 | L2-Norm(final)=3.276 | 3417.2 samples/s | 53.4 steps/s
[Step=34600 Epoch=132.6] | Loss=0.00095 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.762 | L2-Norm(final)=3.276 | 3409.3 samples/s | 53.3 steps/s
[Step=34650 Epoch=132.8] | Loss=0.00077 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.760 | L2-Norm(final)=3.277 | 4084.9 samples/s | 63.8 steps/s
[Step=34700 Epoch=133.0] | Loss=0.00065 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.758 | L2-Norm(final)=3.277 | 1617.4 samples/s | 25.3 steps/s
[Step=34750 Epoch=133.1] | Loss=0.00056 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.757 | L2-Norm(final)=3.277 | 3381.6 samples/s | 52.8 steps/s
[Step=34800 Epoch=133.3] | Loss=0.00049 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.755 | L2-Norm(final)=3.277 | 3411.4 samples/s | 53.3 steps/s
[Step=34850 Epoch=133.5] | Loss=0.00044 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.754 | L2-Norm(final)=3.277 | 3399.9 samples/s | 53.1 steps/s
[Step=34900 Epoch=133.7] | Loss=0.00040 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.753 | L2-Norm(final)=3.277 | 3739.0 samples/s | 58.4 steps/s
[Step=34950 Epoch=133.9] | Loss=0.00036 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.752 | L2-Norm(final)=3.277 | 1696.9 samples/s | 26.5 steps/s
[Step=35000 Epoch=134.1] | Loss=0.00034 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.750 | L2-Norm(final)=3.277 | 3493.0 samples/s | 54.6 steps/s
[Step=35050 Epoch=134.3] | Loss=0.00031 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.749 | L2-Norm(final)=3.277 | 3501.9 samples/s | 54.7 steps/s
[Step=35100 Epoch=134.5] | Loss=0.00029 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.748 | L2-Norm(final)=3.277 | 3528.0 samples/s | 55.1 steps/s
[Step=35150 Epoch=134.7] | Loss=0.00027 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.747 | L2-Norm(final)=3.277 | 3500.2 samples/s | 54.7 steps/s
[Step=35200 Epoch=134.9] | Loss=0.00026 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.747 | L2-Norm(final)=3.277 | 1749.1 samples/s | 27.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step35200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=132.4] | Loss=0.09073 | Reg=0.00283 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.810 | L2-Norm(final)=3.273 | 3657.2 samples/s | 57.1 steps/s
[Step=34450 Epoch=132.6] | Loss=0.00801 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.773 | L2-Norm(final)=3.274 | 3413.3 samples/s | 53.3 steps/s
[Step=34500 Epoch=132.8] | Loss=0.00402 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.766 | L2-Norm(final)=3.274 | 3506.3 samples/s | 54.8 steps/s
[Step=34550 Epoch=133.0] | Loss=0.00269 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.762 | L2-Norm(final)=3.274 | 3408.2 samples/s | 53.3 steps/s
[Step=34600 Epoch=133.2] | Loss=0.00202 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.759 | L2-Norm(final)=3.274 | 3416.9 samples/s | 53.4 steps/s
[Step=34650 Epoch=133.4] | Loss=0.00162 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.757 | L2-Norm(final)=3.274 | 4128.2 samples/s | 64.5 steps/s
[Step=34700 Epoch=133.6] | Loss=0.00136 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.755 | L2-Norm(final)=3.274 | 1623.1 samples/s | 25.4 steps/s
[Step=34750 Epoch=133.8] | Loss=0.00117 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.754 | L2-Norm(final)=3.274 | 3431.7 samples/s | 53.6 steps/s
[Step=34800 Epoch=134.0] | Loss=0.00102 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.752 | L2-Norm(final)=3.274 | 3435.8 samples/s | 53.7 steps/s
[Step=34850 Epoch=134.2] | Loss=0.00091 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.751 | L2-Norm(final)=3.274 | 3511.7 samples/s | 54.9 steps/s
[Step=34900 Epoch=134.3] | Loss=0.00082 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.750 | L2-Norm(final)=3.274 | 3886.3 samples/s | 60.7 steps/s
[Step=34950 Epoch=134.5] | Loss=0.00075 | Reg=0.00281 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.748 | L2-Norm(final)=3.274 | 1676.8 samples/s | 26.2 steps/s
[Step=35000 Epoch=134.7] | Loss=0.00069 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.747 | L2-Norm(final)=3.274 | 3499.2 samples/s | 54.7 steps/s
[Step=35050 Epoch=134.9] | Loss=0.00064 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.746 | L2-Norm(final)=3.274 | 3514.5 samples/s | 54.9 steps/s
[Step=35100 Epoch=135.1] | Loss=0.00059 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.746 | L2-Norm(final)=3.274 | 3517.5 samples/s | 55.0 steps/s
[Step=35150 Epoch=135.3] | Loss=0.00055 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.745 | L2-Norm(final)=3.274 | 3552.9 samples/s | 55.5 steps/s
[Step=35200 Epoch=135.5] | Loss=0.00052 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.744 | L2-Norm(final)=3.274 | 1742.3 samples/s | 27.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18656 | acc=0.9019 | tpr=0.8640 | fpr=0.0159 | 3820.7 samples/s | 14.9 steps/s
Avg test loss: 0.18969, Avg test acc: 0.90051, Avg tpr: 0.86350, Avg fpr: 0.01807, total FA: 141

Testing server on iccad2012
[Step=  50] | Loss=0.40959 | acc=0.8627 | tpr=0.9779 | fpr=0.1393 | 3794.9 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.41637 | acc=0.8643 | tpr=0.9701 | fpr=0.1377 | 7180.1 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.42198 | acc=0.8637 | tpr=0.9741 | fpr=0.1383 | 7251.2 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.42323 | acc=0.8642 | tpr=0.9738 | fpr=0.1378 | 7364.5 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.42235 | acc=0.8638 | tpr=0.9721 | fpr=0.1382 | 7207.1 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.42385 | acc=0.8636 | tpr=0.9716 | fpr=0.1384 | 7090.0 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.42760 | acc=0.8631 | tpr=0.9724 | fpr=0.1389 | 7149.1 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.42881 | acc=0.8628 | tpr=0.9710 | fpr=0.1391 | 7068.8 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.43249 | acc=0.8628 | tpr=0.9727 | fpr=0.1392 | 6905.5 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.43177 | acc=0.8625 | tpr=0.9736 | fpr=0.1395 | 7181.4 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.42909 | acc=0.8631 | tpr=0.9721 | fpr=0.1389 | 12769.1 samples/s | 49.9 steps/s
Avg test loss: 0.42870, Avg test acc: 0.86314, Avg tpr: 0.97187, Avg fpr: 0.13884, total FA: 19277

server round 44/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=68.7] | Loss=0.19466 | Reg=0.00281 | FP-Reg=0.000 | acc=0.8750 | L2-Norm=16.750 | L2-Norm(final)=3.285 | 3850.8 samples/s | 60.2 steps/s
[Step=35250 Epoch=68.8] | Loss=0.01923 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.738 | L2-Norm(final)=3.285 | 3358.2 samples/s | 52.5 steps/s
[Step=35300 Epoch=68.8] | Loss=0.01174 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.733 | L2-Norm(final)=3.286 | 3675.7 samples/s | 57.4 steps/s
[Step=35350 Epoch=68.9] | Loss=0.00978 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.730 | L2-Norm(final)=3.287 | 3657.4 samples/s | 57.1 steps/s
[Step=35400 Epoch=69.0] | Loss=0.00862 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.728 | L2-Norm(final)=3.287 | 3592.7 samples/s | 56.1 steps/s
[Step=35450 Epoch=69.1] | Loss=0.00823 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.726 | L2-Norm(final)=3.288 | 3559.9 samples/s | 55.6 steps/s
[Step=35500 Epoch=69.2] | Loss=0.00786 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.725 | L2-Norm(final)=3.289 | 3575.3 samples/s | 55.9 steps/s
[Step=35550 Epoch=69.3] | Loss=0.00720 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.724 | L2-Norm(final)=3.289 | 3555.7 samples/s | 55.6 steps/s
[Step=35600 Epoch=69.4] | Loss=0.00676 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.723 | L2-Norm(final)=3.290 | 3608.6 samples/s | 56.4 steps/s
[Step=35650 Epoch=69.5] | Loss=0.00670 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.723 | L2-Norm(final)=3.291 | 3590.1 samples/s | 56.1 steps/s
[Step=35700 Epoch=69.6] | Loss=0.00645 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.722 | L2-Norm(final)=3.291 | 4199.3 samples/s | 65.6 steps/s
[Step=35750 Epoch=69.7] | Loss=0.00632 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.721 | L2-Norm(final)=3.292 | 1615.8 samples/s | 25.2 steps/s
[Step=35800 Epoch=69.8] | Loss=0.00621 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.721 | L2-Norm(final)=3.293 | 3548.7 samples/s | 55.4 steps/s
[Step=35850 Epoch=69.9] | Loss=0.00608 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.721 | L2-Norm(final)=3.293 | 3646.5 samples/s | 57.0 steps/s
[Step=35900 Epoch=70.0] | Loss=0.00602 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.720 | L2-Norm(final)=3.294 | 3644.5 samples/s | 56.9 steps/s
[Step=35950 Epoch=70.1] | Loss=0.00585 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.720 | L2-Norm(final)=3.294 | 3642.5 samples/s | 56.9 steps/s
[Step=36000 Epoch=70.2] | Loss=0.00581 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.720 | L2-Norm(final)=3.295 | 3620.6 samples/s | 56.6 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=68.8] | Loss=0.06364 | Reg=0.00281 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.750 | L2-Norm(final)=3.285 | 3964.9 samples/s | 62.0 steps/s
[Step=35250 Epoch=68.9] | Loss=0.01283 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.737 | L2-Norm(final)=3.287 | 3459.0 samples/s | 54.0 steps/s
[Step=35300 Epoch=69.0] | Loss=0.00902 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.732 | L2-Norm(final)=3.288 | 3670.6 samples/s | 57.4 steps/s
[Step=35350 Epoch=69.1] | Loss=0.00772 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.729 | L2-Norm(final)=3.289 | 3706.7 samples/s | 57.9 steps/s
[Step=35400 Epoch=69.2] | Loss=0.00717 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.727 | L2-Norm(final)=3.290 | 3701.3 samples/s | 57.8 steps/s
[Step=35450 Epoch=69.3] | Loss=0.00679 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.726 | L2-Norm(final)=3.291 | 3553.1 samples/s | 55.5 steps/s
[Step=35500 Epoch=69.4] | Loss=0.00651 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.725 | L2-Norm(final)=3.291 | 3573.0 samples/s | 55.8 steps/s
[Step=35550 Epoch=69.5] | Loss=0.00632 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.724 | L2-Norm(final)=3.292 | 3563.5 samples/s | 55.7 steps/s
[Step=35600 Epoch=69.6] | Loss=0.00622 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.723 | L2-Norm(final)=3.293 | 3586.7 samples/s | 56.0 steps/s
[Step=35650 Epoch=69.7] | Loss=0.00602 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.723 | L2-Norm(final)=3.294 | 3595.0 samples/s | 56.2 steps/s
[Step=35700 Epoch=69.8] | Loss=0.00597 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.722 | L2-Norm(final)=3.294 | 4208.2 samples/s | 65.8 steps/s
[Step=35750 Epoch=69.9] | Loss=0.00587 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.722 | L2-Norm(final)=3.295 | 1684.7 samples/s | 26.3 steps/s
[Step=35800 Epoch=70.0] | Loss=0.00567 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.721 | L2-Norm(final)=3.295 | 3656.1 samples/s | 57.1 steps/s
[Step=35850 Epoch=70.1] | Loss=0.00550 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.721 | L2-Norm(final)=3.296 | 3651.7 samples/s | 57.1 steps/s
[Step=35900 Epoch=70.2] | Loss=0.00541 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.721 | L2-Norm(final)=3.297 | 3596.3 samples/s | 56.2 steps/s
[Step=35950 Epoch=70.3] | Loss=0.00534 | Reg=0.00280 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.720 | L2-Norm(final)=3.298 | 3588.1 samples/s | 56.1 steps/s
[Step=36000 Epoch=70.4] | Loss=0.00528 | Reg=0.00280 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.720 | L2-Norm(final)=3.298 | 3576.9 samples/s | 55.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step36000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=134.9] | Loss=0.06727 | Reg=0.00281 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.750 | L2-Norm(final)=3.285 | 3561.2 samples/s | 55.6 steps/s
[Step=35250 Epoch=135.1] | Loss=0.00583 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.715 | L2-Norm(final)=3.286 | 3521.7 samples/s | 55.0 steps/s
[Step=35300 Epoch=135.3] | Loss=0.00294 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.708 | L2-Norm(final)=3.286 | 3486.4 samples/s | 54.5 steps/s
[Step=35350 Epoch=135.4] | Loss=0.00198 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.705 | L2-Norm(final)=3.286 | 3489.1 samples/s | 54.5 steps/s
[Step=35400 Epoch=135.6] | Loss=0.00149 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.702 | L2-Norm(final)=3.286 | 3485.2 samples/s | 54.5 steps/s
[Step=35450 Epoch=135.8] | Loss=0.00121 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.700 | L2-Norm(final)=3.286 | 4086.6 samples/s | 63.9 steps/s
[Step=35500 Epoch=136.0] | Loss=0.00101 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.698 | L2-Norm(final)=3.287 | 1599.3 samples/s | 25.0 steps/s
[Step=35550 Epoch=136.2] | Loss=0.00087 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.696 | L2-Norm(final)=3.287 | 3457.9 samples/s | 54.0 steps/s
[Step=35600 Epoch=136.4] | Loss=0.00077 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.695 | L2-Norm(final)=3.287 | 3389.1 samples/s | 53.0 steps/s
[Step=35650 Epoch=136.6] | Loss=0.00068 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.694 | L2-Norm(final)=3.287 | 3405.5 samples/s | 53.2 steps/s
[Step=35700 Epoch=136.8] | Loss=0.00062 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.692 | L2-Norm(final)=3.287 | 3684.4 samples/s | 57.6 steps/s
[Step=35750 Epoch=137.0] | Loss=0.00056 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.691 | L2-Norm(final)=3.287 | 1655.4 samples/s | 25.9 steps/s
[Step=35800 Epoch=137.2] | Loss=0.00052 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.690 | L2-Norm(final)=3.287 | 3493.0 samples/s | 54.6 steps/s
[Step=35850 Epoch=137.4] | Loss=0.00048 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.689 | L2-Norm(final)=3.287 | 3409.4 samples/s | 53.3 steps/s
[Step=35900 Epoch=137.6] | Loss=0.00045 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.688 | L2-Norm(final)=3.287 | 3389.3 samples/s | 53.0 steps/s
[Step=35950 Epoch=137.7] | Loss=0.00042 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.687 | L2-Norm(final)=3.287 | 3411.6 samples/s | 53.3 steps/s
[Step=36000 Epoch=137.9] | Loss=0.00039 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.687 | L2-Norm(final)=3.287 | 1748.9 samples/s | 27.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step36000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=135.5] | Loss=0.04448 | Reg=0.00281 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.750 | L2-Norm(final)=3.285 | 3695.3 samples/s | 57.7 steps/s
[Step=35250 Epoch=135.7] | Loss=0.00567 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.717 | L2-Norm(final)=3.287 | 3377.0 samples/s | 52.8 steps/s
[Step=35300 Epoch=135.9] | Loss=0.00286 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.710 | L2-Norm(final)=3.287 | 3493.2 samples/s | 54.6 steps/s
[Step=35350 Epoch=136.1] | Loss=0.00192 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.706 | L2-Norm(final)=3.287 | 3515.0 samples/s | 54.9 steps/s
[Step=35400 Epoch=136.3] | Loss=0.00144 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.704 | L2-Norm(final)=3.287 | 3495.7 samples/s | 54.6 steps/s
[Step=35450 Epoch=136.5] | Loss=0.00116 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.701 | L2-Norm(final)=3.287 | 4242.5 samples/s | 66.3 steps/s
[Step=35500 Epoch=136.7] | Loss=0.00097 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.700 | L2-Norm(final)=3.287 | 1619.2 samples/s | 25.3 steps/s
[Step=35550 Epoch=136.8] | Loss=0.00083 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.698 | L2-Norm(final)=3.287 | 3501.4 samples/s | 54.7 steps/s
[Step=35600 Epoch=137.0] | Loss=0.00073 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.696 | L2-Norm(final)=3.287 | 3488.2 samples/s | 54.5 steps/s
[Step=35650 Epoch=137.2] | Loss=0.00065 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.695 | L2-Norm(final)=3.287 | 3507.2 samples/s | 54.8 steps/s
[Step=35700 Epoch=137.4] | Loss=0.00059 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.694 | L2-Norm(final)=3.287 | 3893.2 samples/s | 60.8 steps/s
[Step=35750 Epoch=137.6] | Loss=0.00053 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.693 | L2-Norm(final)=3.287 | 1675.9 samples/s | 26.2 steps/s
[Step=35800 Epoch=137.8] | Loss=0.00049 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.691 | L2-Norm(final)=3.287 | 3436.6 samples/s | 53.7 steps/s
[Step=35850 Epoch=138.0] | Loss=0.00045 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.690 | L2-Norm(final)=3.287 | 3411.0 samples/s | 53.3 steps/s
[Step=35900 Epoch=138.2] | Loss=0.00042 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.689 | L2-Norm(final)=3.287 | 3449.9 samples/s | 53.9 steps/s
[Step=35950 Epoch=138.4] | Loss=0.00040 | Reg=0.00279 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.689 | L2-Norm(final)=3.287 | 3494.8 samples/s | 54.6 steps/s
[Step=36000 Epoch=138.6] | Loss=0.00037 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.688 | L2-Norm(final)=3.287 | 1734.1 samples/s | 27.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19674 | acc=0.8962 | tpr=0.8554 | fpr=0.0151 | 3791.3 samples/s | 14.8 steps/s
Avg test loss: 0.20002, Avg test acc: 0.89490, Avg tpr: 0.85528, Avg fpr: 0.01795, total FA: 140

Testing server on iccad2012
[Step=  50] | Loss=0.38454 | acc=0.8755 | tpr=0.9779 | fpr=0.1263 | 3829.9 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.39174 | acc=0.8763 | tpr=0.9701 | fpr=0.1255 | 7289.5 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.39699 | acc=0.8752 | tpr=0.9741 | fpr=0.1267 | 7493.6 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.39855 | acc=0.8756 | tpr=0.9738 | fpr=0.1261 | 7069.5 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.39757 | acc=0.8752 | tpr=0.9721 | fpr=0.1266 | 7114.1 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.39923 | acc=0.8751 | tpr=0.9716 | fpr=0.1266 | 7083.5 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.40305 | acc=0.8744 | tpr=0.9718 | fpr=0.1273 | 7245.4 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.40421 | acc=0.8741 | tpr=0.9705 | fpr=0.1276 | 7367.7 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.40792 | acc=0.8739 | tpr=0.9722 | fpr=0.1279 | 7226.9 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.40697 | acc=0.8737 | tpr=0.9731 | fpr=0.1281 | 6974.8 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.40445 | acc=0.8742 | tpr=0.9721 | fpr=0.1276 | 13362.2 samples/s | 52.2 steps/s
Avg test loss: 0.40408, Avg test acc: 0.87424, Avg tpr: 0.97187, Avg fpr: 0.12754, total FA: 17708

server round 45/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=70.2] | Loss=0.14568 | Reg=0.00279 | FP-Reg=0.000 | acc=0.8906 | L2-Norm=16.691 | L2-Norm(final)=3.297 | 3692.6 samples/s | 57.7 steps/s
[Step=36050 Epoch=70.3] | Loss=0.01760 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.679 | L2-Norm(final)=3.298 | 3556.1 samples/s | 55.6 steps/s
[Step=36100 Epoch=70.4] | Loss=0.01175 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.674 | L2-Norm(final)=3.298 | 3707.6 samples/s | 57.9 steps/s
[Step=36150 Epoch=70.5] | Loss=0.01022 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.671 | L2-Norm(final)=3.298 | 3577.7 samples/s | 55.9 steps/s
[Step=36200 Epoch=70.6] | Loss=0.00877 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.669 | L2-Norm(final)=3.299 | 3600.9 samples/s | 56.3 steps/s
[Step=36250 Epoch=70.7] | Loss=0.00796 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.668 | L2-Norm(final)=3.300 | 3571.1 samples/s | 55.8 steps/s
[Step=36300 Epoch=70.8] | Loss=0.00761 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.667 | L2-Norm(final)=3.300 | 3581.6 samples/s | 56.0 steps/s
[Step=36350 Epoch=70.9] | Loss=0.00724 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.666 | L2-Norm(final)=3.301 | 3573.8 samples/s | 55.8 steps/s
[Step=36400 Epoch=71.0] | Loss=0.00671 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.665 | L2-Norm(final)=3.302 | 3636.9 samples/s | 56.8 steps/s
[Step=36450 Epoch=71.1] | Loss=0.00652 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.665 | L2-Norm(final)=3.302 | 3587.0 samples/s | 56.0 steps/s
[Step=36500 Epoch=71.2] | Loss=0.00635 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.664 | L2-Norm(final)=3.303 | 4193.9 samples/s | 65.5 steps/s
[Step=36550 Epoch=71.3] | Loss=0.00606 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.663 | L2-Norm(final)=3.303 | 1623.7 samples/s | 25.4 steps/s
[Step=36600 Epoch=71.4] | Loss=0.00591 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.663 | L2-Norm(final)=3.304 | 3688.9 samples/s | 57.6 steps/s
[Step=36650 Epoch=71.5] | Loss=0.00572 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.662 | L2-Norm(final)=3.305 | 3661.9 samples/s | 57.2 steps/s
[Step=36700 Epoch=71.6] | Loss=0.00569 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.662 | L2-Norm(final)=3.305 | 3688.7 samples/s | 57.6 steps/s
[Step=36750 Epoch=71.7] | Loss=0.00554 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.662 | L2-Norm(final)=3.306 | 3730.4 samples/s | 58.3 steps/s
[Step=36800 Epoch=71.8] | Loss=0.00545 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.661 | L2-Norm(final)=3.307 | 3669.6 samples/s | 57.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step36800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=70.4] | Loss=0.05533 | Reg=0.00279 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.691 | L2-Norm(final)=3.297 | 3605.2 samples/s | 56.3 steps/s
[Step=36050 Epoch=70.5] | Loss=0.01822 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.680 | L2-Norm(final)=3.297 | 3726.6 samples/s | 58.2 steps/s
[Step=36100 Epoch=70.6] | Loss=0.01128 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.675 | L2-Norm(final)=3.297 | 3590.2 samples/s | 56.1 steps/s
[Step=36150 Epoch=70.7] | Loss=0.00938 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.672 | L2-Norm(final)=3.298 | 3594.6 samples/s | 56.2 steps/s
[Step=36200 Epoch=70.8] | Loss=0.00812 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.670 | L2-Norm(final)=3.299 | 3577.0 samples/s | 55.9 steps/s
[Step=36250 Epoch=70.9] | Loss=0.00773 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.669 | L2-Norm(final)=3.300 | 3592.8 samples/s | 56.1 steps/s
[Step=36300 Epoch=71.0] | Loss=0.00724 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.668 | L2-Norm(final)=3.301 | 3611.7 samples/s | 56.4 steps/s
[Step=36350 Epoch=71.1] | Loss=0.00699 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.667 | L2-Norm(final)=3.301 | 3601.3 samples/s | 56.3 steps/s
[Step=36400 Epoch=71.2] | Loss=0.00665 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.666 | L2-Norm(final)=3.302 | 3547.6 samples/s | 55.4 steps/s
[Step=36450 Epoch=71.3] | Loss=0.00642 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.665 | L2-Norm(final)=3.303 | 3610.6 samples/s | 56.4 steps/s
[Step=36500 Epoch=71.4] | Loss=0.00618 | Reg=0.00278 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.665 | L2-Norm(final)=3.304 | 4204.7 samples/s | 65.7 steps/s
[Step=36550 Epoch=71.5] | Loss=0.00596 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.664 | L2-Norm(final)=3.304 | 1665.3 samples/s | 26.0 steps/s
[Step=36600 Epoch=71.6] | Loss=0.00573 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.664 | L2-Norm(final)=3.305 | 3567.5 samples/s | 55.7 steps/s
[Step=36650 Epoch=71.6] | Loss=0.00550 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.664 | L2-Norm(final)=3.306 | 3590.6 samples/s | 56.1 steps/s
[Step=36700 Epoch=71.7] | Loss=0.00540 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.663 | L2-Norm(final)=3.306 | 3591.1 samples/s | 56.1 steps/s
[Step=36750 Epoch=71.8] | Loss=0.00527 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.663 | L2-Norm(final)=3.307 | 3583.6 samples/s | 56.0 steps/s
[Step=36800 Epoch=71.9] | Loss=0.00525 | Reg=0.00278 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.663 | L2-Norm(final)=3.308 | 3592.1 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step36800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=137.9] | Loss=0.04291 | Reg=0.00279 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.691 | L2-Norm(final)=3.297 | 3643.4 samples/s | 56.9 steps/s
[Step=36050 Epoch=138.1] | Loss=0.00370 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.656 | L2-Norm(final)=3.298 | 3475.5 samples/s | 54.3 steps/s
[Step=36100 Epoch=138.3] | Loss=0.00187 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.649 | L2-Norm(final)=3.298 | 3509.0 samples/s | 54.8 steps/s
[Step=36150 Epoch=138.5] | Loss=0.00126 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.646 | L2-Norm(final)=3.299 | 3499.9 samples/s | 54.7 steps/s
[Step=36200 Epoch=138.7] | Loss=0.00095 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.643 | L2-Norm(final)=3.299 | 3506.8 samples/s | 54.8 steps/s
[Step=36250 Epoch=138.9] | Loss=0.00077 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.640 | L2-Norm(final)=3.299 | 4219.9 samples/s | 65.9 steps/s
[Step=36300 Epoch=139.1] | Loss=0.00064 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.639 | L2-Norm(final)=3.299 | 1611.4 samples/s | 25.2 steps/s
[Step=36350 Epoch=139.3] | Loss=0.00055 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.637 | L2-Norm(final)=3.299 | 3410.9 samples/s | 53.3 steps/s
[Step=36400 Epoch=139.5] | Loss=0.00049 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.635 | L2-Norm(final)=3.299 | 3415.5 samples/s | 53.4 steps/s
[Step=36450 Epoch=139.7] | Loss=0.00044 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.634 | L2-Norm(final)=3.299 | 3401.8 samples/s | 53.2 steps/s
[Step=36500 Epoch=139.9] | Loss=0.00039 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.633 | L2-Norm(final)=3.299 | 3744.7 samples/s | 58.5 steps/s
[Step=36550 Epoch=140.0] | Loss=0.00036 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.632 | L2-Norm(final)=3.299 | 1698.8 samples/s | 26.5 steps/s
[Step=36600 Epoch=140.2] | Loss=0.00033 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.631 | L2-Norm(final)=3.299 | 3439.6 samples/s | 53.7 steps/s
[Step=36650 Epoch=140.4] | Loss=0.00031 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.630 | L2-Norm(final)=3.299 | 3412.1 samples/s | 53.3 steps/s
[Step=36700 Epoch=140.6] | Loss=0.00029 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.629 | L2-Norm(final)=3.299 | 3415.5 samples/s | 53.4 steps/s
[Step=36750 Epoch=140.8] | Loss=0.00027 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.628 | L2-Norm(final)=3.299 | 3421.7 samples/s | 53.5 steps/s
[Step=36800 Epoch=141.0] | Loss=0.00025 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.627 | L2-Norm(final)=3.300 | 1746.0 samples/s | 27.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step36800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=138.6] | Loss=0.04728 | Reg=0.00279 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.691 | L2-Norm(final)=3.297 | 3710.8 samples/s | 58.0 steps/s
[Step=36050 Epoch=138.8] | Loss=0.00386 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.657 | L2-Norm(final)=3.299 | 3397.9 samples/s | 53.1 steps/s
[Step=36100 Epoch=139.0] | Loss=0.00195 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.651 | L2-Norm(final)=3.299 | 3507.0 samples/s | 54.8 steps/s
[Step=36150 Epoch=139.2] | Loss=0.00130 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.647 | L2-Norm(final)=3.299 | 3507.8 samples/s | 54.8 steps/s
[Step=36200 Epoch=139.3] | Loss=0.00098 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.644 | L2-Norm(final)=3.299 | 3496.1 samples/s | 54.6 steps/s
[Step=36250 Epoch=139.5] | Loss=0.00079 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.642 | L2-Norm(final)=3.299 | 4258.0 samples/s | 66.5 steps/s
[Step=36300 Epoch=139.7] | Loss=0.00066 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.640 | L2-Norm(final)=3.299 | 1621.7 samples/s | 25.3 steps/s
[Step=36350 Epoch=139.9] | Loss=0.00057 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.639 | L2-Norm(final)=3.299 | 3469.7 samples/s | 54.2 steps/s
[Step=36400 Epoch=140.1] | Loss=0.00050 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.637 | L2-Norm(final)=3.299 | 3469.3 samples/s | 54.2 steps/s
[Step=36450 Epoch=140.3] | Loss=0.00045 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.636 | L2-Norm(final)=3.300 | 3426.8 samples/s | 53.5 steps/s
[Step=36500 Epoch=140.5] | Loss=0.00040 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.635 | L2-Norm(final)=3.300 | 3776.4 samples/s | 59.0 steps/s
[Step=36550 Epoch=140.7] | Loss=0.00037 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.634 | L2-Norm(final)=3.300 | 1648.3 samples/s | 25.8 steps/s
[Step=36600 Epoch=140.9] | Loss=0.00034 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.633 | L2-Norm(final)=3.300 | 3427.3 samples/s | 53.6 steps/s
[Step=36650 Epoch=141.1] | Loss=0.00031 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.632 | L2-Norm(final)=3.300 | 3372.2 samples/s | 52.7 steps/s
[Step=36700 Epoch=141.3] | Loss=0.00029 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.631 | L2-Norm(final)=3.300 | 3324.6 samples/s | 51.9 steps/s
[Step=36750 Epoch=141.5] | Loss=0.00027 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.630 | L2-Norm(final)=3.300 | 3169.7 samples/s | 49.5 steps/s
[Step=36800 Epoch=141.7] | Loss=0.00026 | Reg=0.00277 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.629 | L2-Norm(final)=3.300 | 1595.1 samples/s | 24.9 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18024 | acc=0.9065 | tpr=0.8704 | fpr=0.0151 | 3250.2 samples/s | 12.7 steps/s
Avg test loss: 0.18383, Avg test acc: 0.90536, Avg tpr: 0.87055, Avg fpr: 0.01807, total FA: 141

Testing server on iccad2012
[Step=  50] | Loss=0.41533 | acc=0.8647 | tpr=0.9779 | fpr=0.1373 | 3557.3 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.42215 | acc=0.8657 | tpr=0.9765 | fpr=0.1363 | 7056.1 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.42746 | acc=0.8652 | tpr=0.9784 | fpr=0.1368 | 7240.3 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.42884 | acc=0.8657 | tpr=0.9781 | fpr=0.1363 | 7260.6 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.42808 | acc=0.8652 | tpr=0.9755 | fpr=0.1368 | 7172.8 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.42966 | acc=0.8652 | tpr=0.9753 | fpr=0.1368 | 7080.1 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.43364 | acc=0.8644 | tpr=0.9750 | fpr=0.1376 | 7119.2 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.43489 | acc=0.8641 | tpr=0.9737 | fpr=0.1379 | 7125.0 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.43877 | acc=0.8639 | tpr=0.9752 | fpr=0.1381 | 7116.9 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.43781 | acc=0.8639 | tpr=0.9762 | fpr=0.1381 | 7144.1 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.43512 | acc=0.8644 | tpr=0.9753 | fpr=0.1376 | 13413.8 samples/s | 52.4 steps/s
Avg test loss: 0.43474, Avg test acc: 0.86449, Avg tpr: 0.97504, Avg fpr: 0.13752, total FA: 19094

server round 46/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=71.8] | Loss=0.05282 | Reg=0.00277 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.633 | L2-Norm(final)=3.309 | 3605.5 samples/s | 56.3 steps/s
[Step=36850 Epoch=71.9] | Loss=0.01675 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.620 | L2-Norm(final)=3.309 | 3435.3 samples/s | 53.7 steps/s
[Step=36900 Epoch=72.0] | Loss=0.01096 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.616 | L2-Norm(final)=3.309 | 3571.3 samples/s | 55.8 steps/s
[Step=36950 Epoch=72.1] | Loss=0.00868 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.613 | L2-Norm(final)=3.310 | 3592.5 samples/s | 56.1 steps/s
[Step=37000 Epoch=72.2] | Loss=0.00783 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.611 | L2-Norm(final)=3.310 | 3678.3 samples/s | 57.5 steps/s
[Step=37050 Epoch=72.3] | Loss=0.00740 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.609 | L2-Norm(final)=3.311 | 3682.1 samples/s | 57.5 steps/s
[Step=37100 Epoch=72.4] | Loss=0.00694 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.608 | L2-Norm(final)=3.312 | 3683.4 samples/s | 57.6 steps/s
[Step=37150 Epoch=72.5] | Loss=0.00691 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.607 | L2-Norm(final)=3.312 | 3694.4 samples/s | 57.7 steps/s
[Step=37200 Epoch=72.6] | Loss=0.00664 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.606 | L2-Norm(final)=3.313 | 3706.6 samples/s | 57.9 steps/s
[Step=37250 Epoch=72.7] | Loss=0.00652 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.606 | L2-Norm(final)=3.313 | 3701.7 samples/s | 57.8 steps/s
[Step=37300 Epoch=72.7] | Loss=0.00638 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.605 | L2-Norm(final)=3.314 | 4314.8 samples/s | 67.4 steps/s
[Step=37350 Epoch=72.8] | Loss=0.00616 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.605 | L2-Norm(final)=3.315 | 1656.6 samples/s | 25.9 steps/s
[Step=37400 Epoch=72.9] | Loss=0.00598 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.604 | L2-Norm(final)=3.315 | 3695.2 samples/s | 57.7 steps/s
[Step=37450 Epoch=73.0] | Loss=0.00584 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.604 | L2-Norm(final)=3.316 | 3697.7 samples/s | 57.8 steps/s
[Step=37500 Epoch=73.1] | Loss=0.00571 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.603 | L2-Norm(final)=3.317 | 3684.6 samples/s | 57.6 steps/s
[Step=37550 Epoch=73.2] | Loss=0.00557 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.603 | L2-Norm(final)=3.317 | 3570.6 samples/s | 55.8 steps/s
[Step=37600 Epoch=73.3] | Loss=0.00548 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.603 | L2-Norm(final)=3.318 | 3586.5 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step37600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=71.9] | Loss=0.01304 | Reg=0.00277 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.633 | L2-Norm(final)=3.309 | 3781.4 samples/s | 59.1 steps/s
[Step=36850 Epoch=72.0] | Loss=0.01251 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.620 | L2-Norm(final)=3.310 | 3568.7 samples/s | 55.8 steps/s
[Step=36900 Epoch=72.1] | Loss=0.00865 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.615 | L2-Norm(final)=3.311 | 3630.0 samples/s | 56.7 steps/s
[Step=36950 Epoch=72.2] | Loss=0.00756 | Reg=0.00276 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.613 | L2-Norm(final)=3.312 | 3700.1 samples/s | 57.8 steps/s
[Step=37000 Epoch=72.3] | Loss=0.00692 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.611 | L2-Norm(final)=3.312 | 3711.5 samples/s | 58.0 steps/s
[Step=37050 Epoch=72.4] | Loss=0.00664 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.610 | L2-Norm(final)=3.313 | 3642.2 samples/s | 56.9 steps/s
[Step=37100 Epoch=72.5] | Loss=0.00626 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.609 | L2-Norm(final)=3.314 | 3611.5 samples/s | 56.4 steps/s
[Step=37150 Epoch=72.6] | Loss=0.00607 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.608 | L2-Norm(final)=3.315 | 3547.1 samples/s | 55.4 steps/s
[Step=37200 Epoch=72.7] | Loss=0.00594 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.607 | L2-Norm(final)=3.316 | 3639.8 samples/s | 56.9 steps/s
[Step=37250 Epoch=72.8] | Loss=0.00574 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.607 | L2-Norm(final)=3.316 | 3690.6 samples/s | 57.7 steps/s
[Step=37300 Epoch=72.9] | Loss=0.00563 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.606 | L2-Norm(final)=3.317 | 4346.4 samples/s | 67.9 steps/s
[Step=37350 Epoch=73.0] | Loss=0.00547 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.606 | L2-Norm(final)=3.318 | 1688.9 samples/s | 26.4 steps/s
[Step=37400 Epoch=73.1] | Loss=0.00526 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.605 | L2-Norm(final)=3.318 | 3674.8 samples/s | 57.4 steps/s
[Step=37450 Epoch=73.2] | Loss=0.00516 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.605 | L2-Norm(final)=3.319 | 3585.2 samples/s | 56.0 steps/s
[Step=37500 Epoch=73.3] | Loss=0.00512 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.605 | L2-Norm(final)=3.320 | 3591.1 samples/s | 56.1 steps/s
[Step=37550 Epoch=73.4] | Loss=0.00504 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.604 | L2-Norm(final)=3.320 | 3579.6 samples/s | 55.9 steps/s
[Step=37600 Epoch=73.5] | Loss=0.00493 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.604 | L2-Norm(final)=3.321 | 3537.6 samples/s | 55.3 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step37600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=141.0] | Loss=0.05752 | Reg=0.00277 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.633 | L2-Norm(final)=3.309 | 3726.4 samples/s | 58.2 steps/s
[Step=36850 Epoch=141.2] | Loss=0.00522 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.598 | L2-Norm(final)=3.308 | 3335.2 samples/s | 52.1 steps/s
[Step=36900 Epoch=141.4] | Loss=0.00263 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.592 | L2-Norm(final)=3.308 | 3389.7 samples/s | 53.0 steps/s
[Step=36950 Epoch=141.6] | Loss=0.00176 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.588 | L2-Norm(final)=3.309 | 3393.8 samples/s | 53.0 steps/s
[Step=37000 Epoch=141.8] | Loss=0.00133 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.586 | L2-Norm(final)=3.309 | 3420.7 samples/s | 53.4 steps/s
[Step=37050 Epoch=142.0] | Loss=0.00106 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.584 | L2-Norm(final)=3.309 | 4135.2 samples/s | 64.6 steps/s
[Step=37100 Epoch=142.2] | Loss=0.00089 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.582 | L2-Norm(final)=3.309 | 1632.8 samples/s | 25.5 steps/s
[Step=37150 Epoch=142.3] | Loss=0.00077 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.580 | L2-Norm(final)=3.309 | 3480.3 samples/s | 54.4 steps/s
[Step=37200 Epoch=142.5] | Loss=0.00067 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.579 | L2-Norm(final)=3.309 | 3525.7 samples/s | 55.1 steps/s
[Step=37250 Epoch=142.7] | Loss=0.00060 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.577 | L2-Norm(final)=3.309 | 3427.7 samples/s | 53.6 steps/s
[Step=37300 Epoch=142.9] | Loss=0.00054 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.576 | L2-Norm(final)=3.309 | 3705.2 samples/s | 57.9 steps/s
[Step=37350 Epoch=143.1] | Loss=0.00050 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.575 | L2-Norm(final)=3.309 | 1666.6 samples/s | 26.0 steps/s
[Step=37400 Epoch=143.3] | Loss=0.00046 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.574 | L2-Norm(final)=3.309 | 3422.0 samples/s | 53.5 steps/s
[Step=37450 Epoch=143.5] | Loss=0.00042 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.573 | L2-Norm(final)=3.309 | 3470.0 samples/s | 54.2 steps/s
[Step=37500 Epoch=143.7] | Loss=0.00039 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.572 | L2-Norm(final)=3.309 | 3412.7 samples/s | 53.3 steps/s
[Step=37550 Epoch=143.9] | Loss=0.00037 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.571 | L2-Norm(final)=3.309 | 3379.7 samples/s | 52.8 steps/s
[Step=37600 Epoch=144.1] | Loss=0.00035 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.570 | L2-Norm(final)=3.309 | 1738.6 samples/s | 27.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step37600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=141.7] | Loss=0.08439 | Reg=0.00277 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.633 | L2-Norm(final)=3.309 | 3695.7 samples/s | 57.7 steps/s
[Step=36850 Epoch=141.9] | Loss=0.00457 | Reg=0.00276 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.598 | L2-Norm(final)=3.309 | 3372.3 samples/s | 52.7 steps/s
[Step=36900 Epoch=142.0] | Loss=0.00233 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.592 | L2-Norm(final)=3.309 | 3511.7 samples/s | 54.9 steps/s
[Step=36950 Epoch=142.2] | Loss=0.00157 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.588 | L2-Norm(final)=3.309 | 3434.6 samples/s | 53.7 steps/s
[Step=37000 Epoch=142.4] | Loss=0.00119 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.586 | L2-Norm(final)=3.309 | 3388.0 samples/s | 52.9 steps/s
[Step=37050 Epoch=142.6] | Loss=0.00096 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.583 | L2-Norm(final)=3.309 | 4189.9 samples/s | 65.5 steps/s
[Step=37100 Epoch=142.8] | Loss=0.00081 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.582 | L2-Norm(final)=3.310 | 1622.3 samples/s | 25.3 steps/s
[Step=37150 Epoch=143.0] | Loss=0.00069 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.580 | L2-Norm(final)=3.310 | 3488.2 samples/s | 54.5 steps/s
[Step=37200 Epoch=143.2] | Loss=0.00061 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.579 | L2-Norm(final)=3.310 | 3490.3 samples/s | 54.5 steps/s
[Step=37250 Epoch=143.4] | Loss=0.00054 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.577 | L2-Norm(final)=3.310 | 3397.2 samples/s | 53.1 steps/s
[Step=37300 Epoch=143.6] | Loss=0.00049 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.576 | L2-Norm(final)=3.310 | 3743.8 samples/s | 58.5 steps/s
[Step=37350 Epoch=143.8] | Loss=0.00045 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.575 | L2-Norm(final)=3.310 | 1657.3 samples/s | 25.9 steps/s
[Step=37400 Epoch=144.0] | Loss=0.00041 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.574 | L2-Norm(final)=3.310 | 3383.5 samples/s | 52.9 steps/s
[Step=37450 Epoch=144.2] | Loss=0.00038 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.573 | L2-Norm(final)=3.310 | 3385.3 samples/s | 52.9 steps/s
[Step=37500 Epoch=144.4] | Loss=0.00036 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.572 | L2-Norm(final)=3.310 | 3516.7 samples/s | 54.9 steps/s
[Step=37550 Epoch=144.5] | Loss=0.00034 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.571 | L2-Norm(final)=3.310 | 3556.6 samples/s | 55.6 steps/s
[Step=37600 Epoch=144.7] | Loss=0.00032 | Reg=0.00275 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.570 | L2-Norm(final)=3.310 | 1740.8 samples/s | 27.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19202 | acc=0.9020 | tpr=0.8633 | fpr=0.0141 | 3814.8 samples/s | 14.9 steps/s
Avg test loss: 0.19603, Avg test acc: 0.89987, Avg tpr: 0.86192, Avg fpr: 0.01666, total FA: 130

Testing server on iccad2012
[Step=  50] | Loss=0.40005 | acc=0.8708 | tpr=0.9779 | fpr=0.1311 | 3781.5 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.40739 | acc=0.8723 | tpr=0.9723 | fpr=0.1296 | 7372.1 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.41325 | acc=0.8714 | tpr=0.9755 | fpr=0.1306 | 7380.5 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.41488 | acc=0.8721 | tpr=0.9760 | fpr=0.1298 | 6907.3 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.41391 | acc=0.8718 | tpr=0.9738 | fpr=0.1301 | 7450.7 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.41559 | acc=0.8719 | tpr=0.9738 | fpr=0.1300 | 7310.5 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.41963 | acc=0.8712 | tpr=0.9743 | fpr=0.1306 | 7046.3 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.42097 | acc=0.8709 | tpr=0.9726 | fpr=0.1310 | 7235.9 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.42485 | acc=0.8707 | tpr=0.9737 | fpr=0.1312 | 6924.3 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.42385 | acc=0.8705 | tpr=0.9740 | fpr=0.1314 | 7162.2 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.42118 | acc=0.8710 | tpr=0.9729 | fpr=0.1309 | 13131.3 samples/s | 51.3 steps/s
Avg test loss: 0.42081, Avg test acc: 0.87106, Avg tpr: 0.97266, Avg fpr: 0.13078, total FA: 18159

server round 47/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=73.3] | Loss=0.13012 | Reg=0.00275 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.575 | L2-Norm(final)=3.320 | 3595.4 samples/s | 56.2 steps/s
[Step=37650 Epoch=73.4] | Loss=0.01531 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.562 | L2-Norm(final)=3.320 | 3490.8 samples/s | 54.5 steps/s
[Step=37700 Epoch=73.5] | Loss=0.01015 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.557 | L2-Norm(final)=3.321 | 3602.0 samples/s | 56.3 steps/s
[Step=37750 Epoch=73.6] | Loss=0.00837 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.554 | L2-Norm(final)=3.321 | 3669.6 samples/s | 57.3 steps/s
[Step=37800 Epoch=73.7] | Loss=0.00761 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.552 | L2-Norm(final)=3.322 | 3661.9 samples/s | 57.2 steps/s
[Step=37850 Epoch=73.8] | Loss=0.00712 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.551 | L2-Norm(final)=3.322 | 3610.6 samples/s | 56.4 steps/s
[Step=37900 Epoch=73.9] | Loss=0.00709 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.550 | L2-Norm(final)=3.323 | 3696.2 samples/s | 57.8 steps/s
[Step=37950 Epoch=74.0] | Loss=0.00711 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.549 | L2-Norm(final)=3.324 | 3699.1 samples/s | 57.8 steps/s
[Step=38000 Epoch=74.1] | Loss=0.00678 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.548 | L2-Norm(final)=3.324 | 3671.1 samples/s | 57.4 steps/s
[Step=38050 Epoch=74.2] | Loss=0.00653 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.547 | L2-Norm(final)=3.325 | 3714.5 samples/s | 58.0 steps/s
[Step=38100 Epoch=74.3] | Loss=0.00629 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.547 | L2-Norm(final)=3.325 | 4266.3 samples/s | 66.7 steps/s
[Step=38150 Epoch=74.4] | Loss=0.00612 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.546 | L2-Norm(final)=3.326 | 1611.6 samples/s | 25.2 steps/s
[Step=38200 Epoch=74.5] | Loss=0.00609 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.546 | L2-Norm(final)=3.327 | 3698.9 samples/s | 57.8 steps/s
[Step=38250 Epoch=74.6] | Loss=0.00587 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.546 | L2-Norm(final)=3.327 | 3548.2 samples/s | 55.4 steps/s
[Step=38300 Epoch=74.7] | Loss=0.00577 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.545 | L2-Norm(final)=3.328 | 3568.7 samples/s | 55.8 steps/s
[Step=38350 Epoch=74.8] | Loss=0.00567 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.545 | L2-Norm(final)=3.328 | 3565.3 samples/s | 55.7 steps/s
[Step=38400 Epoch=74.9] | Loss=0.00559 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.545 | L2-Norm(final)=3.329 | 3583.9 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step38400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=73.5] | Loss=0.03967 | Reg=0.00275 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.575 | L2-Norm(final)=3.320 | 3749.2 samples/s | 58.6 steps/s
[Step=37650 Epoch=73.6] | Loss=0.01183 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.563 | L2-Norm(final)=3.321 | 3492.1 samples/s | 54.6 steps/s
[Step=37700 Epoch=73.7] | Loss=0.00893 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.558 | L2-Norm(final)=3.321 | 3577.3 samples/s | 55.9 steps/s
[Step=37750 Epoch=73.8] | Loss=0.00751 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.555 | L2-Norm(final)=3.322 | 3637.9 samples/s | 56.8 steps/s
[Step=37800 Epoch=73.9] | Loss=0.00669 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.554 | L2-Norm(final)=3.323 | 3668.2 samples/s | 57.3 steps/s
[Step=37850 Epoch=74.0] | Loss=0.00610 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.552 | L2-Norm(final)=3.324 | 3606.5 samples/s | 56.4 steps/s
[Step=37900 Epoch=74.1] | Loss=0.00579 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.551 | L2-Norm(final)=3.325 | 3615.5 samples/s | 56.5 steps/s
[Step=37950 Epoch=74.2] | Loss=0.00576 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.551 | L2-Norm(final)=3.326 | 3585.2 samples/s | 56.0 steps/s
[Step=38000 Epoch=74.3] | Loss=0.00577 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.550 | L2-Norm(final)=3.326 | 3575.3 samples/s | 55.9 steps/s
[Step=38050 Epoch=74.4] | Loss=0.00564 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.549 | L2-Norm(final)=3.327 | 3669.9 samples/s | 57.3 steps/s
[Step=38100 Epoch=74.5] | Loss=0.00556 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.549 | L2-Norm(final)=3.328 | 4364.6 samples/s | 68.2 steps/s
[Step=38150 Epoch=74.6] | Loss=0.00529 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.548 | L2-Norm(final)=3.329 | 1678.4 samples/s | 26.2 steps/s
[Step=38200 Epoch=74.7] | Loss=0.00520 | Reg=0.00274 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.548 | L2-Norm(final)=3.329 | 3674.7 samples/s | 57.4 steps/s
[Step=38250 Epoch=74.8] | Loss=0.00509 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.548 | L2-Norm(final)=3.330 | 3686.8 samples/s | 57.6 steps/s
[Step=38300 Epoch=74.9] | Loss=0.00513 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.547 | L2-Norm(final)=3.331 | 3587.5 samples/s | 56.1 steps/s
[Step=38350 Epoch=75.0] | Loss=0.00509 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.547 | L2-Norm(final)=3.331 | 3589.6 samples/s | 56.1 steps/s
[Step=38400 Epoch=75.1] | Loss=0.00506 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.547 | L2-Norm(final)=3.332 | 3568.3 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step38400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=144.1] | Loss=0.03605 | Reg=0.00275 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.575 | L2-Norm(final)=3.320 | 3965.2 samples/s | 62.0 steps/s
[Step=37650 Epoch=144.3] | Loss=0.00461 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.539 | L2-Norm(final)=3.320 | 3259.3 samples/s | 50.9 steps/s
[Step=37700 Epoch=144.5] | Loss=0.00233 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.533 | L2-Norm(final)=3.320 | 3496.9 samples/s | 54.6 steps/s
[Step=37750 Epoch=144.6] | Loss=0.00157 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.529 | L2-Norm(final)=3.320 | 3504.4 samples/s | 54.8 steps/s
[Step=37800 Epoch=144.8] | Loss=0.00118 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.527 | L2-Norm(final)=3.320 | 3488.0 samples/s | 54.5 steps/s
[Step=37850 Epoch=145.0] | Loss=0.00096 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.524 | L2-Norm(final)=3.321 | 4176.0 samples/s | 65.3 steps/s
[Step=37900 Epoch=145.2] | Loss=0.00080 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.523 | L2-Norm(final)=3.321 | 1597.9 samples/s | 25.0 steps/s
[Step=37950 Epoch=145.4] | Loss=0.00069 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.521 | L2-Norm(final)=3.321 | 3398.2 samples/s | 53.1 steps/s
[Step=38000 Epoch=145.6] | Loss=0.00061 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.520 | L2-Norm(final)=3.321 | 3421.8 samples/s | 53.5 steps/s
[Step=38050 Epoch=145.8] | Loss=0.00054 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.518 | L2-Norm(final)=3.321 | 3418.2 samples/s | 53.4 steps/s
[Step=38100 Epoch=146.0] | Loss=0.00049 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.517 | L2-Norm(final)=3.321 | 3660.8 samples/s | 57.2 steps/s
[Step=38150 Epoch=146.2] | Loss=0.00045 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.516 | L2-Norm(final)=3.321 | 1697.8 samples/s | 26.5 steps/s
[Step=38200 Epoch=146.4] | Loss=0.00041 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.515 | L2-Norm(final)=3.321 | 3484.1 samples/s | 54.4 steps/s
[Step=38250 Epoch=146.6] | Loss=0.00038 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.514 | L2-Norm(final)=3.321 | 3459.3 samples/s | 54.1 steps/s
[Step=38300 Epoch=146.8] | Loss=0.00036 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.513 | L2-Norm(final)=3.321 | 3467.1 samples/s | 54.2 steps/s
[Step=38350 Epoch=146.9] | Loss=0.00033 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.512 | L2-Norm(final)=3.321 | 3489.4 samples/s | 54.5 steps/s
[Step=38400 Epoch=147.1] | Loss=0.00031 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.511 | L2-Norm(final)=3.321 | 1759.7 samples/s | 27.5 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step38400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=144.7] | Loss=0.07106 | Reg=0.00275 | FP-Reg=0.000 | acc=0.9531 | L2-Norm=16.575 | L2-Norm(final)=3.320 | 3740.4 samples/s | 58.4 steps/s
[Step=37650 Epoch=144.9] | Loss=0.00400 | Reg=0.00274 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.540 | L2-Norm(final)=3.321 | 3372.4 samples/s | 52.7 steps/s
[Step=37700 Epoch=145.1] | Loss=0.00203 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.534 | L2-Norm(final)=3.321 | 3509.5 samples/s | 54.8 steps/s
[Step=37750 Epoch=145.3] | Loss=0.00136 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.530 | L2-Norm(final)=3.321 | 3492.4 samples/s | 54.6 steps/s
[Step=37800 Epoch=145.5] | Loss=0.00103 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.527 | L2-Norm(final)=3.321 | 3486.8 samples/s | 54.5 steps/s
[Step=37850 Epoch=145.7] | Loss=0.00083 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.525 | L2-Norm(final)=3.321 | 4132.8 samples/s | 64.6 steps/s
[Step=37900 Epoch=145.9] | Loss=0.00069 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.523 | L2-Norm(final)=3.321 | 1620.1 samples/s | 25.3 steps/s
[Step=37950 Epoch=146.1] | Loss=0.00060 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.522 | L2-Norm(final)=3.322 | 3418.5 samples/s | 53.4 steps/s
[Step=38000 Epoch=146.3] | Loss=0.00053 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.520 | L2-Norm(final)=3.322 | 3436.7 samples/s | 53.7 steps/s
[Step=38050 Epoch=146.5] | Loss=0.00047 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.519 | L2-Norm(final)=3.322 | 3384.5 samples/s | 52.9 steps/s
[Step=38100 Epoch=146.7] | Loss=0.00043 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.518 | L2-Norm(final)=3.322 | 3705.6 samples/s | 57.9 steps/s
[Step=38150 Epoch=146.9] | Loss=0.00039 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.517 | L2-Norm(final)=3.322 | 1614.5 samples/s | 25.2 steps/s
[Step=38200 Epoch=147.0] | Loss=0.00036 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.516 | L2-Norm(final)=3.322 | 3347.7 samples/s | 52.3 steps/s
[Step=38250 Epoch=147.2] | Loss=0.00033 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.515 | L2-Norm(final)=3.322 | 3402.6 samples/s | 53.2 steps/s
[Step=38300 Epoch=147.4] | Loss=0.00031 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.514 | L2-Norm(final)=3.322 | 3422.0 samples/s | 53.5 steps/s
[Step=38350 Epoch=147.6] | Loss=0.00029 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.513 | L2-Norm(final)=3.322 | 3465.9 samples/s | 54.2 steps/s
[Step=38400 Epoch=147.8] | Loss=0.00027 | Reg=0.00273 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.512 | L2-Norm(final)=3.322 | 1728.8 samples/s | 27.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18976 | acc=0.9032 | tpr=0.8650 | fpr=0.0139 | 3806.2 samples/s | 14.9 steps/s
Avg test loss: 0.19334, Avg test acc: 0.90099, Avg tpr: 0.86338, Avg fpr: 0.01628, total FA: 127

Testing server on iccad2012
[Step=  50] | Loss=0.39632 | acc=0.8712 | tpr=0.9735 | fpr=0.1307 | 3833.6 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.40346 | acc=0.8726 | tpr=0.9701 | fpr=0.1292 | 7108.0 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.40874 | acc=0.8717 | tpr=0.9741 | fpr=0.1301 | 7188.6 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.41012 | acc=0.8725 | tpr=0.9749 | fpr=0.1294 | 7050.4 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.40920 | acc=0.8720 | tpr=0.9729 | fpr=0.1299 | 7269.0 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.41084 | acc=0.8720 | tpr=0.9724 | fpr=0.1298 | 7253.0 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.41471 | acc=0.8714 | tpr=0.9731 | fpr=0.1304 | 7116.0 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.41599 | acc=0.8711 | tpr=0.9716 | fpr=0.1307 | 7119.7 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.41986 | acc=0.8709 | tpr=0.9732 | fpr=0.1310 | 7106.9 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.41897 | acc=0.8706 | tpr=0.9736 | fpr=0.1312 | 7232.5 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.41631 | acc=0.8711 | tpr=0.9717 | fpr=0.1308 | 13187.7 samples/s | 51.5 steps/s
Avg test loss: 0.41593, Avg test acc: 0.87111, Avg tpr: 0.97147, Avg fpr: 0.13071, total FA: 18149

server round 48/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=74.9] | Loss=0.11078 | Reg=0.00273 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.517 | L2-Norm(final)=3.331 | 4072.4 samples/s | 63.6 steps/s
[Step=38450 Epoch=75.0] | Loss=0.01456 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.507 | L2-Norm(final)=3.332 | 3272.9 samples/s | 51.1 steps/s
[Step=38500 Epoch=75.1] | Loss=0.00981 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.502 | L2-Norm(final)=3.332 | 3624.7 samples/s | 56.6 steps/s
[Step=38550 Epoch=75.2] | Loss=0.00862 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.500 | L2-Norm(final)=3.333 | 3580.2 samples/s | 55.9 steps/s
[Step=38600 Epoch=75.3] | Loss=0.00771 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.498 | L2-Norm(final)=3.334 | 3623.9 samples/s | 56.6 steps/s
[Step=38650 Epoch=75.4] | Loss=0.00705 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.496 | L2-Norm(final)=3.334 | 3629.5 samples/s | 56.7 steps/s
[Step=38700 Epoch=75.5] | Loss=0.00677 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.495 | L2-Norm(final)=3.335 | 3595.1 samples/s | 56.2 steps/s
[Step=38750 Epoch=75.6] | Loss=0.00669 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.494 | L2-Norm(final)=3.336 | 3587.5 samples/s | 56.1 steps/s
[Step=38800 Epoch=75.7] | Loss=0.00643 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.493 | L2-Norm(final)=3.336 | 3572.4 samples/s | 55.8 steps/s
[Step=38850 Epoch=75.8] | Loss=0.00618 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.493 | L2-Norm(final)=3.337 | 3590.8 samples/s | 56.1 steps/s
[Step=38900 Epoch=75.9] | Loss=0.00608 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.492 | L2-Norm(final)=3.338 | 4163.9 samples/s | 65.1 steps/s
[Step=38950 Epoch=76.0] | Loss=0.00584 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.492 | L2-Norm(final)=3.338 | 1629.7 samples/s | 25.5 steps/s
[Step=39000 Epoch=76.1] | Loss=0.00561 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.491 | L2-Norm(final)=3.339 | 3544.8 samples/s | 55.4 steps/s
[Step=39050 Epoch=76.2] | Loss=0.00552 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.491 | L2-Norm(final)=3.340 | 3537.5 samples/s | 55.3 steps/s
[Step=39100 Epoch=76.3] | Loss=0.00548 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.490 | L2-Norm(final)=3.340 | 3559.2 samples/s | 55.6 steps/s
[Step=39150 Epoch=76.4] | Loss=0.00558 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.490 | L2-Norm(final)=3.341 | 3577.2 samples/s | 55.9 steps/s
[Step=39200 Epoch=76.5] | Loss=0.00550 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.490 | L2-Norm(final)=3.341 | 3587.8 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step39200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=75.1] | Loss=0.07533 | Reg=0.00273 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.517 | L2-Norm(final)=3.331 | 3687.0 samples/s | 57.6 steps/s
[Step=38450 Epoch=75.2] | Loss=0.01448 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.505 | L2-Norm(final)=3.331 | 3524.6 samples/s | 55.1 steps/s
[Step=38500 Epoch=75.3] | Loss=0.00987 | Reg=0.00272 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.501 | L2-Norm(final)=3.332 | 3636.3 samples/s | 56.8 steps/s
[Step=38550 Epoch=75.4] | Loss=0.00823 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.498 | L2-Norm(final)=3.333 | 3588.1 samples/s | 56.1 steps/s
[Step=38600 Epoch=75.5] | Loss=0.00741 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.496 | L2-Norm(final)=3.334 | 3529.9 samples/s | 55.2 steps/s
[Step=38650 Epoch=75.6] | Loss=0.00695 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.494 | L2-Norm(final)=3.334 | 3584.5 samples/s | 56.0 steps/s
[Step=38700 Epoch=75.7] | Loss=0.00626 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.493 | L2-Norm(final)=3.335 | 3579.7 samples/s | 55.9 steps/s
[Step=38750 Epoch=75.8] | Loss=0.00595 | Reg=0.00272 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.493 | L2-Norm(final)=3.336 | 3605.1 samples/s | 56.3 steps/s
[Step=38800 Epoch=75.9] | Loss=0.00585 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.492 | L2-Norm(final)=3.337 | 3650.7 samples/s | 57.0 steps/s
[Step=38850 Epoch=76.0] | Loss=0.00571 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.491 | L2-Norm(final)=3.338 | 3553.0 samples/s | 55.5 steps/s
[Step=38900 Epoch=76.0] | Loss=0.00583 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.491 | L2-Norm(final)=3.338 | 4205.7 samples/s | 65.7 steps/s
[Step=38950 Epoch=76.1] | Loss=0.00568 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.490 | L2-Norm(final)=3.339 | 1676.9 samples/s | 26.2 steps/s
[Step=39000 Epoch=76.2] | Loss=0.00559 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.490 | L2-Norm(final)=3.339 | 3621.3 samples/s | 56.6 steps/s
[Step=39050 Epoch=76.3] | Loss=0.00553 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.490 | L2-Norm(final)=3.340 | 3632.2 samples/s | 56.8 steps/s
[Step=39100 Epoch=76.4] | Loss=0.00546 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.490 | L2-Norm(final)=3.341 | 3576.7 samples/s | 55.9 steps/s
[Step=39150 Epoch=76.5] | Loss=0.00541 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.489 | L2-Norm(final)=3.341 | 3584.6 samples/s | 56.0 steps/s
[Step=39200 Epoch=76.6] | Loss=0.00529 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.489 | L2-Norm(final)=3.342 | 3591.5 samples/s | 56.1 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step39200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=147.1] | Loss=0.15832 | Reg=0.00273 | FP-Reg=0.000 | acc=0.9062 | L2-Norm=16.517 | L2-Norm(final)=3.331 | 3632.2 samples/s | 56.8 steps/s
[Step=38450 Epoch=147.3] | Loss=0.00667 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.482 | L2-Norm(final)=3.331 | 3419.1 samples/s | 53.4 steps/s
[Step=38500 Epoch=147.5] | Loss=0.00336 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.475 | L2-Norm(final)=3.331 | 3502.3 samples/s | 54.7 steps/s
[Step=38550 Epoch=147.7] | Loss=0.00225 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.472 | L2-Norm(final)=3.331 | 3511.4 samples/s | 54.9 steps/s
[Step=38600 Epoch=147.9] | Loss=0.00170 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.469 | L2-Norm(final)=3.332 | 3500.3 samples/s | 54.7 steps/s
[Step=38650 Epoch=148.1] | Loss=0.00136 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.467 | L2-Norm(final)=3.332 | 4081.5 samples/s | 63.8 steps/s
[Step=38700 Epoch=148.3] | Loss=0.00114 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.465 | L2-Norm(final)=3.332 | 1623.6 samples/s | 25.4 steps/s
[Step=38750 Epoch=148.5] | Loss=0.00098 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.464 | L2-Norm(final)=3.332 | 3506.6 samples/s | 54.8 steps/s
[Step=38800 Epoch=148.7] | Loss=0.00086 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.462 | L2-Norm(final)=3.332 | 3485.9 samples/s | 54.5 steps/s
[Step=38850 Epoch=148.9] | Loss=0.00077 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.461 | L2-Norm(final)=3.332 | 3511.5 samples/s | 54.9 steps/s
[Step=38900 Epoch=149.1] | Loss=0.00069 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.460 | L2-Norm(final)=3.332 | 3805.2 samples/s | 59.5 steps/s
[Step=38950 Epoch=149.2] | Loss=0.00063 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.459 | L2-Norm(final)=3.332 | 1689.0 samples/s | 26.4 steps/s
[Step=39000 Epoch=149.4] | Loss=0.00058 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.458 | L2-Norm(final)=3.332 | 3463.0 samples/s | 54.1 steps/s
[Step=39050 Epoch=149.6] | Loss=0.00054 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.457 | L2-Norm(final)=3.332 | 3413.1 samples/s | 53.3 steps/s
[Step=39100 Epoch=149.8] | Loss=0.00050 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.456 | L2-Norm(final)=3.332 | 3434.0 samples/s | 53.7 steps/s
[Step=39150 Epoch=150.0] | Loss=0.00047 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.455 | L2-Norm(final)=3.332 | 3493.1 samples/s | 54.6 steps/s
[Step=39200 Epoch=150.2] | Loss=0.00044 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.454 | L2-Norm(final)=3.332 | 1741.7 samples/s | 27.2 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step39200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=147.8] | Loss=0.01333 | Reg=0.00273 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.517 | L2-Norm(final)=3.331 | 3644.1 samples/s | 56.9 steps/s
[Step=38450 Epoch=148.0] | Loss=0.00495 | Reg=0.00272 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.482 | L2-Norm(final)=3.331 | 3443.9 samples/s | 53.8 steps/s
[Step=38500 Epoch=148.2] | Loss=0.00250 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.475 | L2-Norm(final)=3.331 | 3494.9 samples/s | 54.6 steps/s
[Step=38550 Epoch=148.4] | Loss=0.00167 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.472 | L2-Norm(final)=3.331 | 3470.6 samples/s | 54.2 steps/s
[Step=38600 Epoch=148.6] | Loss=0.00126 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.469 | L2-Norm(final)=3.331 | 3410.7 samples/s | 53.3 steps/s
[Step=38650 Epoch=148.8] | Loss=0.00101 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.467 | L2-Norm(final)=3.331 | 4231.3 samples/s | 66.1 steps/s
[Step=38700 Epoch=149.0] | Loss=0.00085 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.465 | L2-Norm(final)=3.331 | 1639.4 samples/s | 25.6 steps/s
[Step=38750 Epoch=149.2] | Loss=0.00073 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.464 | L2-Norm(final)=3.331 | 3489.1 samples/s | 54.5 steps/s
[Step=38800 Epoch=149.4] | Loss=0.00064 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.462 | L2-Norm(final)=3.331 | 3486.9 samples/s | 54.5 steps/s
[Step=38850 Epoch=149.5] | Loss=0.00057 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.461 | L2-Norm(final)=3.331 | 3501.4 samples/s | 54.7 steps/s
[Step=38900 Epoch=149.7] | Loss=0.00052 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.460 | L2-Norm(final)=3.331 | 3797.4 samples/s | 59.3 steps/s
[Step=38950 Epoch=149.9] | Loss=0.00047 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.458 | L2-Norm(final)=3.331 | 1673.3 samples/s | 26.1 steps/s
[Step=39000 Epoch=150.1] | Loss=0.00043 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.457 | L2-Norm(final)=3.331 | 3452.6 samples/s | 53.9 steps/s
[Step=39050 Epoch=150.3] | Loss=0.00040 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.456 | L2-Norm(final)=3.331 | 3502.4 samples/s | 54.7 steps/s
[Step=39100 Epoch=150.5] | Loss=0.00037 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.455 | L2-Norm(final)=3.331 | 3503.3 samples/s | 54.7 steps/s
[Step=39150 Epoch=150.7] | Loss=0.00035 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.455 | L2-Norm(final)=3.331 | 3549.9 samples/s | 55.5 steps/s
[Step=39200 Epoch=150.9] | Loss=0.00033 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.454 | L2-Norm(final)=3.332 | 1726.9 samples/s | 27.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18379 | acc=0.9066 | tpr=0.8702 | fpr=0.0144 | 3747.1 samples/s | 14.6 steps/s
Avg test loss: 0.18709, Avg test acc: 0.90456, Avg tpr: 0.86892, Avg fpr: 0.01705, total FA: 133

Testing server on iccad2012
[Step=  50] | Loss=0.40442 | acc=0.8703 | tpr=0.9779 | fpr=0.1316 | 3896.9 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.41186 | acc=0.8711 | tpr=0.9723 | fpr=0.1308 | 7057.9 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.41765 | acc=0.8700 | tpr=0.9741 | fpr=0.1319 | 7002.0 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.41906 | acc=0.8705 | tpr=0.9727 | fpr=0.1313 | 7328.7 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.41808 | acc=0.8701 | tpr=0.9712 | fpr=0.1318 | 7422.4 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.41983 | acc=0.8701 | tpr=0.9709 | fpr=0.1317 | 7104.8 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.42376 | acc=0.8696 | tpr=0.9718 | fpr=0.1322 | 7212.2 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.42488 | acc=0.8693 | tpr=0.9705 | fpr=0.1325 | 7072.1 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.42883 | acc=0.8690 | tpr=0.9722 | fpr=0.1329 | 6998.2 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.42789 | acc=0.8689 | tpr=0.9731 | fpr=0.1330 | 7184.3 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.42513 | acc=0.8693 | tpr=0.9717 | fpr=0.1326 | 12952.4 samples/s | 50.6 steps/s
Avg test loss: 0.42473, Avg test acc: 0.86932, Avg tpr: 0.97147, Avg fpr: 0.13253, total FA: 18402

server round 49/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=76.5] | Loss=0.01043 | Reg=0.00271 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.460 | L2-Norm(final)=3.341 | 3509.7 samples/s | 54.8 steps/s
[Step=39250 Epoch=76.6] | Loss=0.01399 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.447 | L2-Norm(final)=3.342 | 3625.5 samples/s | 56.6 steps/s
[Step=39300 Epoch=76.7] | Loss=0.01002 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.443 | L2-Norm(final)=3.343 | 3529.0 samples/s | 55.1 steps/s
[Step=39350 Epoch=76.7] | Loss=0.00925 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.440 | L2-Norm(final)=3.343 | 3588.0 samples/s | 56.1 steps/s
[Step=39400 Epoch=76.8] | Loss=0.00824 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.439 | L2-Norm(final)=3.344 | 3573.0 samples/s | 55.8 steps/s
[Step=39450 Epoch=76.9] | Loss=0.00749 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.437 | L2-Norm(final)=3.345 | 3575.4 samples/s | 55.9 steps/s
[Step=39500 Epoch=77.0] | Loss=0.00727 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.436 | L2-Norm(final)=3.346 | 3587.2 samples/s | 56.0 steps/s
[Step=39550 Epoch=77.1] | Loss=0.00674 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.436 | L2-Norm(final)=3.346 | 3565.7 samples/s | 55.7 steps/s
[Step=39600 Epoch=77.2] | Loss=0.00639 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.435 | L2-Norm(final)=3.347 | 3584.5 samples/s | 56.0 steps/s
[Step=39650 Epoch=77.3] | Loss=0.00608 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.434 | L2-Norm(final)=3.348 | 3557.9 samples/s | 55.6 steps/s
[Step=39700 Epoch=77.4] | Loss=0.00608 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.434 | L2-Norm(final)=3.348 | 4212.9 samples/s | 65.8 steps/s
[Step=39750 Epoch=77.5] | Loss=0.00579 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.433 | L2-Norm(final)=3.349 | 1577.8 samples/s | 24.7 steps/s
[Step=39800 Epoch=77.6] | Loss=0.00556 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.433 | L2-Norm(final)=3.350 | 3546.3 samples/s | 55.4 steps/s
[Step=39850 Epoch=77.7] | Loss=0.00560 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.432 | L2-Norm(final)=3.350 | 3569.3 samples/s | 55.8 steps/s
[Step=39900 Epoch=77.8] | Loss=0.00559 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.432 | L2-Norm(final)=3.351 | 3573.9 samples/s | 55.8 steps/s
[Step=39950 Epoch=77.9] | Loss=0.00552 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.432 | L2-Norm(final)=3.351 | 3569.5 samples/s | 55.8 steps/s
[Step=40000 Epoch=78.0] | Loss=0.00539 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.431 | L2-Norm(final)=3.352 | 3574.1 samples/s | 55.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=76.6] | Loss=0.06035 | Reg=0.00271 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.460 | L2-Norm(final)=3.341 | 3737.2 samples/s | 58.4 steps/s
[Step=39250 Epoch=76.7] | Loss=0.01403 | Reg=0.00271 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.449 | L2-Norm(final)=3.342 | 3591.0 samples/s | 56.1 steps/s
[Step=39300 Epoch=76.8] | Loss=0.01038 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.445 | L2-Norm(final)=3.343 | 3618.7 samples/s | 56.5 steps/s
[Step=39350 Epoch=76.9] | Loss=0.00831 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.442 | L2-Norm(final)=3.344 | 3566.9 samples/s | 55.7 steps/s
[Step=39400 Epoch=77.0] | Loss=0.00730 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.440 | L2-Norm(final)=3.345 | 3562.4 samples/s | 55.7 steps/s
[Step=39450 Epoch=77.1] | Loss=0.00693 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.439 | L2-Norm(final)=3.345 | 3569.5 samples/s | 55.8 steps/s
[Step=39500 Epoch=77.2] | Loss=0.00645 | Reg=0.00270 | FP-Reg=0.000 | acc=0.9844 | L2-Norm=16.438 | L2-Norm(final)=3.346 | 3598.3 samples/s | 56.2 steps/s
[Step=39550 Epoch=77.3] | Loss=0.00610 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.437 | L2-Norm(final)=3.347 | 3584.0 samples/s | 56.0 steps/s
[Step=39600 Epoch=77.4] | Loss=0.00599 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.436 | L2-Norm(final)=3.348 | 3586.8 samples/s | 56.0 steps/s
[Step=39650 Epoch=77.5] | Loss=0.00606 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.436 | L2-Norm(final)=3.348 | 3553.4 samples/s | 55.5 steps/s
[Step=39700 Epoch=77.6] | Loss=0.00587 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.435 | L2-Norm(final)=3.349 | 4218.3 samples/s | 65.9 steps/s
[Step=39750 Epoch=77.7] | Loss=0.00576 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.435 | L2-Norm(final)=3.350 | 1655.3 samples/s | 25.9 steps/s
[Step=39800 Epoch=77.8] | Loss=0.00557 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.434 | L2-Norm(final)=3.350 | 3584.3 samples/s | 56.0 steps/s
[Step=39850 Epoch=77.9] | Loss=0.00550 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.434 | L2-Norm(final)=3.351 | 3575.9 samples/s | 55.9 steps/s
[Step=39900 Epoch=78.0] | Loss=0.00539 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.434 | L2-Norm(final)=3.352 | 3582.0 samples/s | 56.0 steps/s
[Step=39950 Epoch=78.1] | Loss=0.00519 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.434 | L2-Norm(final)=3.352 | 3581.8 samples/s | 56.0 steps/s
[Step=40000 Epoch=78.2] | Loss=0.00510 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.433 | L2-Norm(final)=3.353 | 3581.3 samples/s | 56.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_asml1_1/client_state-step40000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=150.2] | Loss=0.07657 | Reg=0.00271 | FP-Reg=0.000 | acc=0.9375 | L2-Norm=16.460 | L2-Norm(final)=3.341 | 3999.3 samples/s | 62.5 steps/s
[Step=39250 Epoch=150.4] | Loss=0.00583 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.429 | L2-Norm(final)=3.343 | 3181.2 samples/s | 49.7 steps/s
[Step=39300 Epoch=150.6] | Loss=0.00293 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.423 | L2-Norm(final)=3.343 | 3494.6 samples/s | 54.6 steps/s
[Step=39350 Epoch=150.8] | Loss=0.00196 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.419 | L2-Norm(final)=3.343 | 3466.4 samples/s | 54.2 steps/s
[Step=39400 Epoch=151.0] | Loss=0.00148 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.417 | L2-Norm(final)=3.343 | 3409.2 samples/s | 53.3 steps/s
[Step=39450 Epoch=151.2] | Loss=0.00119 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.414 | L2-Norm(final)=3.343 | 4176.1 samples/s | 65.3 steps/s
[Step=39500 Epoch=151.4] | Loss=0.00099 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.343 | 1613.1 samples/s | 25.2 steps/s
[Step=39550 Epoch=151.5] | Loss=0.00085 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.411 | L2-Norm(final)=3.343 | 3397.6 samples/s | 53.1 steps/s
[Step=39600 Epoch=151.7] | Loss=0.00075 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.410 | L2-Norm(final)=3.343 | 3425.3 samples/s | 53.5 steps/s
[Step=39650 Epoch=151.9] | Loss=0.00067 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.408 | L2-Norm(final)=3.343 | 3497.0 samples/s | 54.6 steps/s
[Step=39700 Epoch=152.1] | Loss=0.00060 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.407 | L2-Norm(final)=3.343 | 3718.2 samples/s | 58.1 steps/s
[Step=39750 Epoch=152.3] | Loss=0.00055 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.406 | L2-Norm(final)=3.343 | 1669.1 samples/s | 26.1 steps/s
[Step=39800 Epoch=152.5] | Loss=0.00050 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.405 | L2-Norm(final)=3.343 | 3393.8 samples/s | 53.0 steps/s
[Step=39850 Epoch=152.7] | Loss=0.00047 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.404 | L2-Norm(final)=3.343 | 3386.2 samples/s | 52.9 steps/s
[Step=39900 Epoch=152.9] | Loss=0.00043 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.403 | L2-Norm(final)=3.343 | 3413.8 samples/s | 53.3 steps/s
[Step=39950 Epoch=153.1] | Loss=0.00041 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.402 | L2-Norm(final)=3.343 | 3422.4 samples/s | 53.5 steps/s
[Step=40000 Epoch=153.3] | Loss=0.00038 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.401 | L2-Norm(final)=3.343 | 1713.4 samples/s | 26.8 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_0/client_state-step40000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=150.9] | Loss=0.03712 | Reg=0.00271 | FP-Reg=0.000 | acc=0.9688 | L2-Norm=16.460 | L2-Norm(final)=3.341 | 3677.9 samples/s | 57.5 steps/s
[Step=39250 Epoch=151.1] | Loss=0.00369 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.428 | L2-Norm(final)=3.343 | 3438.9 samples/s | 53.7 steps/s
[Step=39300 Epoch=151.3] | Loss=0.00186 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.422 | L2-Norm(final)=3.343 | 3507.1 samples/s | 54.8 steps/s
[Step=39350 Epoch=151.5] | Loss=0.00124 | Reg=0.00270 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.418 | L2-Norm(final)=3.343 | 3507.7 samples/s | 54.8 steps/s
[Step=39400 Epoch=151.7] | Loss=0.00094 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.415 | L2-Norm(final)=3.343 | 3513.4 samples/s | 54.9 steps/s
[Step=39450 Epoch=151.9] | Loss=0.00075 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.343 | 4268.0 samples/s | 66.7 steps/s
[Step=39500 Epoch=152.1] | Loss=0.00063 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.412 | L2-Norm(final)=3.343 | 1626.2 samples/s | 25.4 steps/s
[Step=39550 Epoch=152.2] | Loss=0.00054 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.410 | L2-Norm(final)=3.343 | 3476.7 samples/s | 54.3 steps/s
[Step=39600 Epoch=152.4] | Loss=0.00047 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.408 | L2-Norm(final)=3.343 | 3491.4 samples/s | 54.6 steps/s
[Step=39650 Epoch=152.6] | Loss=0.00042 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.407 | L2-Norm(final)=3.343 | 3438.3 samples/s | 53.7 steps/s
[Step=39700 Epoch=152.8] | Loss=0.00038 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.406 | L2-Norm(final)=3.343 | 3783.0 samples/s | 59.1 steps/s
[Step=39750 Epoch=153.0] | Loss=0.00035 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.405 | L2-Norm(final)=3.343 | 1664.6 samples/s | 26.0 steps/s
[Step=39800 Epoch=153.2] | Loss=0.00032 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.404 | L2-Norm(final)=3.343 | 3488.3 samples/s | 54.5 steps/s
[Step=39850 Epoch=153.4] | Loss=0.00030 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.403 | L2-Norm(final)=3.343 | 3471.4 samples/s | 54.2 steps/s
[Step=39900 Epoch=153.6] | Loss=0.00028 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.402 | L2-Norm(final)=3.343 | 3434.8 samples/s | 53.7 steps/s
[Step=39950 Epoch=153.8] | Loss=0.00026 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.401 | L2-Norm(final)=3.343 | 3455.9 samples/s | 54.0 steps/s
[Step=40000 Epoch=154.0] | Loss=0.00024 | Reg=0.00269 | FP-Reg=0.000 | acc=1.0000 | L2-Norm=16.400 | L2-Norm(final)=3.343 | 1729.9 samples/s | 27.0 steps/s
Client model saved at models/model-fedprox-a2i2-sel1.0-l2fp1e-3-withl2/client_iccad2012_1/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19749 | acc=0.8999 | tpr=0.8600 | fpr=0.0134 | 3766.0 samples/s | 14.7 steps/s
Avg test loss: 0.20134, Avg test acc: 0.89771, Avg tpr: 0.85872, Avg fpr: 0.01654, total FA: 129

Testing server on iccad2012
[Step=  50] | Loss=0.38161 | acc=0.8818 | tpr=0.9779 | fpr=0.1199 | 3786.0 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.38956 | acc=0.8825 | tpr=0.9744 | fpr=0.1192 | 6978.6 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.39550 | acc=0.8817 | tpr=0.9769 | fpr=0.1201 | 7133.7 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.39716 | acc=0.8823 | tpr=0.9760 | fpr=0.1194 | 7164.4 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.39594 | acc=0.8818 | tpr=0.9738 | fpr=0.1199 | 6865.4 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.39795 | acc=0.8817 | tpr=0.9738 | fpr=0.1200 | 6799.4 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.40182 | acc=0.8810 | tpr=0.9743 | fpr=0.1207 | 7111.8 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.40298 | acc=0.8807 | tpr=0.9726 | fpr=0.1210 | 7326.7 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.40685 | acc=0.8804 | tpr=0.9742 | fpr=0.1213 | 7267.4 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.40581 | acc=0.8801 | tpr=0.9744 | fpr=0.1216 | 7017.7 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.40323 | acc=0.8805 | tpr=0.9729 | fpr=0.1212 | 12487.7 samples/s | 48.8 steps/s
Avg test loss: 0.40290, Avg test acc: 0.88050, Avg tpr: 0.97266, Avg fpr: 0.12118, total FA: 16825
