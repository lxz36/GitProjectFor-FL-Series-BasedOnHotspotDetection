#clients of iccad2012: 5
#clients of asml1: 5
select ratio: 0.5
Total num clients: 10
client model path: ['/research/byu2/rchen/proj/wwy/jp/model/client_asml1_0', '/research/byu2/rchen/proj/wwy/jp/model/client_asml1_1', '/research/byu2/rchen/proj/wwy/jp/model/client_asml1_2', '/research/byu2/rchen/proj/wwy/jp/model/client_asml1_3', '/research/byu2/rchen/proj/wwy/jp/model/client_asml1_4', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4']
client benchmark path: {'asml1': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml1_train', 'asml2': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml2_train', 'asml3': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml3_train', 'asml4': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml4_train', 'iccad2012': '/research/byu2/rchen/proj/wwy/jp/benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13125, 144, 32)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13116, 144, 32)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13135, 144, 32)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13124, 144, 32)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 32)
Resampled dataset to size (13051, 144, 32)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6754, 144, 32)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6728, 144, 32)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6702, 144, 32)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6792, 144, 32)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6715, 144, 32)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 2 4 6 7]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35123 | Reg=0.00357 | L2-Norm=18.893 | L2-Norm(final)=1.960 | acc=0.4844 | 1454.0 samples/s | 22.7 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.30277 | Reg=0.00347 | L2-Norm=18.637 | L2-Norm(final)=1.951 | acc=0.6406 | 3978.7 samples/s | 62.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24972 | Reg=0.00344 | L2-Norm=18.541 | L2-Norm(final)=1.965 | acc=0.9219 | 3949.2 samples/s | 61.7 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.21814 | Reg=0.00341 | L2-Norm=18.478 | L2-Norm(final)=1.976 | acc=0.9219 | 3945.4 samples/s | 61.6 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20027 | Reg=0.00340 | L2-Norm=18.430 | L2-Norm(final)=1.983 | acc=0.8125 | 4900.0 samples/s | 76.6 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18060 | Reg=0.00338 | L2-Norm=18.396 | L2-Norm(final)=1.991 | acc=0.9062 | 1595.9 samples/s | 24.9 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.16539 | Reg=0.00338 | L2-Norm=18.372 | L2-Norm(final)=2.000 | acc=0.9375 | 4221.3 samples/s | 66.0 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.15511 | Reg=0.00337 | L2-Norm=18.351 | L2-Norm(final)=2.008 | acc=0.9531 | 4359.6 samples/s | 68.1 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.14560 | Reg=0.00336 | L2-Norm=18.333 | L2-Norm(final)=2.016 | acc=0.9531 | 4893.5 samples/s | 76.5 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.13590 | Reg=0.00336 | L2-Norm=18.316 | L2-Norm(final)=2.024 | acc=0.9375 | 1564.6 samples/s | 24.4 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.12791 | Reg=0.00335 | L2-Norm=18.302 | L2-Norm(final)=2.032 | acc=0.9844 | 4113.2 samples/s | 64.3 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12058 | Reg=0.00335 | L2-Norm=18.290 | L2-Norm(final)=2.040 | acc=0.9844 | 4280.3 samples/s | 66.9 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.11493 | Reg=0.00334 | L2-Norm=18.278 | L2-Norm(final)=2.048 | acc=0.9688 | 4766.8 samples/s | 74.5 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11199 | Reg=0.00334 | L2-Norm=18.270 | L2-Norm(final)=2.055 | acc=0.9688 | 1585.7 samples/s | 24.8 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.10778 | Reg=0.00334 | L2-Norm=18.267 | L2-Norm(final)=2.059 | acc=0.9375 | 4193.8 samples/s | 65.5 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10358 | Reg=0.00334 | L2-Norm=18.263 | L2-Norm(final)=2.064 | acc=1.0000 | 4130.4 samples/s | 64.5 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10000 | Reg=0.00333 | L2-Norm=18.259 | L2-Norm(final)=2.068 | acc=0.9531 | 4422.0 samples/s | 69.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step800.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35636 | Reg=0.00357 | L2-Norm=18.893 | L2-Norm(final)=1.961 | acc=0.4531 | 3854.5 samples/s | 60.2 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.31149 | Reg=0.00348 | L2-Norm=18.648 | L2-Norm(final)=1.953 | acc=0.8438 | 4050.5 samples/s | 63.3 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.25928 | Reg=0.00344 | L2-Norm=18.545 | L2-Norm(final)=1.966 | acc=0.8281 | 4452.4 samples/s | 69.6 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.23158 | Reg=0.00341 | L2-Norm=18.470 | L2-Norm(final)=1.975 | acc=0.8125 | 4239.2 samples/s | 66.2 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.21090 | Reg=0.00339 | L2-Norm=18.412 | L2-Norm(final)=1.982 | acc=0.9531 | 4931.3 samples/s | 77.1 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.19115 | Reg=0.00337 | L2-Norm=18.368 | L2-Norm(final)=1.991 | acc=0.9062 | 1537.5 samples/s | 24.0 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17555 | Reg=0.00336 | L2-Norm=18.335 | L2-Norm(final)=2.002 | acc=0.9219 | 4364.5 samples/s | 68.2 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16411 | Reg=0.00335 | L2-Norm=18.310 | L2-Norm(final)=2.013 | acc=0.9375 | 4345.6 samples/s | 67.9 steps/s
[Step= 400 Epoch= 1.9] | Loss=0.15530 | Reg=0.00335 | L2-Norm=18.290 | L2-Norm(final)=2.022 | acc=0.9219 | 4721.1 samples/s | 73.8 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14522 | Reg=0.00334 | L2-Norm=18.276 | L2-Norm(final)=2.032 | acc=1.0000 | 1554.2 samples/s | 24.3 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13682 | Reg=0.00334 | L2-Norm=18.265 | L2-Norm(final)=2.042 | acc=0.9062 | 4370.2 samples/s | 68.3 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.13039 | Reg=0.00333 | L2-Norm=18.258 | L2-Norm(final)=2.052 | acc=0.9688 | 4323.1 samples/s | 67.5 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12467 | Reg=0.00333 | L2-Norm=18.254 | L2-Norm(final)=2.060 | acc=0.9531 | 4620.0 samples/s | 72.2 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11841 | Reg=0.00333 | L2-Norm=18.251 | L2-Norm(final)=2.069 | acc=0.9531 | 1562.9 samples/s | 24.4 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11297 | Reg=0.00333 | L2-Norm=18.249 | L2-Norm(final)=2.077 | acc=0.9688 | 4284.4 samples/s | 66.9 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10864 | Reg=0.00333 | L2-Norm=18.247 | L2-Norm(final)=2.084 | acc=0.9375 | 4357.2 samples/s | 68.1 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10481 | Reg=0.00333 | L2-Norm=18.245 | L2-Norm(final)=2.091 | acc=0.9688 | 4647.1 samples/s | 72.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step800.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35397 | Reg=0.00357 | L2-Norm=18.893 | L2-Norm(final)=1.961 | acc=0.5000 | 3788.2 samples/s | 59.2 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.29420 | Reg=0.00346 | L2-Norm=18.587 | L2-Norm(final)=1.953 | acc=0.7656 | 4135.4 samples/s | 64.6 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24803 | Reg=0.00341 | L2-Norm=18.459 | L2-Norm(final)=1.964 | acc=0.8125 | 4236.8 samples/s | 66.2 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.21952 | Reg=0.00337 | L2-Norm=18.366 | L2-Norm(final)=1.971 | acc=0.8750 | 4396.5 samples/s | 68.7 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.19817 | Reg=0.00335 | L2-Norm=18.289 | L2-Norm(final)=1.977 | acc=0.9062 | 5149.8 samples/s | 80.5 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.17877 | Reg=0.00332 | L2-Norm=18.227 | L2-Norm(final)=1.985 | acc=0.8906 | 1540.7 samples/s | 24.1 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.16586 | Reg=0.00331 | L2-Norm=18.179 | L2-Norm(final)=1.992 | acc=0.9531 | 4132.3 samples/s | 64.6 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.15467 | Reg=0.00329 | L2-Norm=18.137 | L2-Norm(final)=2.000 | acc=0.9531 | 4319.5 samples/s | 67.5 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.14679 | Reg=0.00328 | L2-Norm=18.102 | L2-Norm(final)=2.007 | acc=0.9688 | 4985.7 samples/s | 77.9 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.13694 | Reg=0.00327 | L2-Norm=18.073 | L2-Norm(final)=2.014 | acc=0.9531 | 1550.6 samples/s | 24.2 steps/s
[Step= 500 Epoch= 2.5] | Loss=0.12866 | Reg=0.00326 | L2-Norm=18.049 | L2-Norm(final)=2.022 | acc=0.9844 | 4323.6 samples/s | 67.6 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12325 | Reg=0.00325 | L2-Norm=18.028 | L2-Norm(final)=2.029 | acc=0.9688 | 4262.7 samples/s | 66.6 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.11754 | Reg=0.00324 | L2-Norm=18.011 | L2-Norm(final)=2.036 | acc=0.9688 | 4547.6 samples/s | 71.1 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11109 | Reg=0.00324 | L2-Norm=17.997 | L2-Norm(final)=2.044 | acc=1.0000 | 1569.7 samples/s | 24.5 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.10665 | Reg=0.00324 | L2-Norm=17.986 | L2-Norm(final)=2.051 | acc=0.9688 | 4455.9 samples/s | 69.6 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10210 | Reg=0.00323 | L2-Norm=17.977 | L2-Norm(final)=2.058 | acc=0.9688 | 4358.9 samples/s | 68.1 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.09812 | Reg=0.00323 | L2-Norm=17.969 | L2-Norm(final)=2.065 | acc=0.9844 | 4826.5 samples/s | 75.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.38682 | Reg=0.00357 | L2-Norm=18.893 | L2-Norm(final)=1.961 | acc=0.5000 | 3387.1 samples/s | 52.9 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.16531 | Reg=0.00349 | L2-Norm=18.685 | L2-Norm(final)=1.988 | acc=0.9844 | 3757.3 samples/s | 58.7 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.10312 | Reg=0.00347 | L2-Norm=18.626 | L2-Norm(final)=2.006 | acc=0.9844 | 4984.1 samples/s | 77.9 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.07036 | Reg=0.00345 | L2-Norm=18.566 | L2-Norm(final)=2.020 | acc=1.0000 | 1520.3 samples/s | 23.8 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.05327 | Reg=0.00342 | L2-Norm=18.505 | L2-Norm(final)=2.031 | acc=1.0000 | 4494.2 samples/s | 70.2 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.04272 | Reg=0.00340 | L2-Norm=18.445 | L2-Norm(final)=2.040 | acc=1.0000 | 1497.4 samples/s | 23.4 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.03564 | Reg=0.00338 | L2-Norm=18.384 | L2-Norm(final)=2.047 | acc=1.0000 | 4466.9 samples/s | 69.8 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.03056 | Reg=0.00336 | L2-Norm=18.322 | L2-Norm(final)=2.053 | acc=1.0000 | 1546.8 samples/s | 24.2 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02675 | Reg=0.00333 | L2-Norm=18.259 | L2-Norm(final)=2.057 | acc=1.0000 | 4347.9 samples/s | 67.9 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02379 | Reg=0.00331 | L2-Norm=18.197 | L2-Norm(final)=2.061 | acc=1.0000 | 1572.3 samples/s | 24.6 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.02141 | Reg=0.00329 | L2-Norm=18.135 | L2-Norm(final)=2.065 | acc=1.0000 | 4237.1 samples/s | 66.2 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01947 | Reg=0.00327 | L2-Norm=18.073 | L2-Norm(final)=2.068 | acc=1.0000 | 1548.4 samples/s | 24.2 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01785 | Reg=0.00325 | L2-Norm=18.013 | L2-Norm(final)=2.071 | acc=1.0000 | 4186.4 samples/s | 65.4 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01648 | Reg=0.00322 | L2-Norm=17.952 | L2-Norm(final)=2.073 | acc=1.0000 | 1688.5 samples/s | 26.4 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01530 | Reg=0.00320 | L2-Norm=17.893 | L2-Norm(final)=2.075 | acc=1.0000 | 4188.4 samples/s | 65.4 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01428 | Reg=0.00318 | L2-Norm=17.834 | L2-Norm(final)=2.078 | acc=1.0000 | 1559.9 samples/s | 24.4 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01339 | Reg=0.00316 | L2-Norm=17.775 | L2-Norm(final)=2.080 | acc=1.0000 | 4009.2 samples/s | 62.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.38986 | Reg=0.00357 | L2-Norm=18.893 | L2-Norm(final)=1.962 | acc=0.3750 | 3956.3 samples/s | 61.8 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.15634 | Reg=0.00350 | L2-Norm=18.713 | L2-Norm(final)=1.987 | acc=1.0000 | 3534.1 samples/s | 55.2 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.08516 | Reg=0.00348 | L2-Norm=18.660 | L2-Norm(final)=2.014 | acc=1.0000 | 4799.8 samples/s | 75.0 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.05826 | Reg=0.00346 | L2-Norm=18.592 | L2-Norm(final)=2.029 | acc=1.0000 | 1462.8 samples/s | 22.9 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04400 | Reg=0.00343 | L2-Norm=18.521 | L2-Norm(final)=2.040 | acc=1.0000 | 4759.7 samples/s | 74.4 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03556 | Reg=0.00341 | L2-Norm=18.455 | L2-Norm(final)=2.049 | acc=1.0000 | 1483.9 samples/s | 23.2 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.02973 | Reg=0.00338 | L2-Norm=18.392 | L2-Norm(final)=2.056 | acc=1.0000 | 4430.4 samples/s | 69.2 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02551 | Reg=0.00336 | L2-Norm=18.330 | L2-Norm(final)=2.062 | acc=1.0000 | 1519.3 samples/s | 23.7 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02233 | Reg=0.00334 | L2-Norm=18.268 | L2-Norm(final)=2.067 | acc=1.0000 | 4508.3 samples/s | 70.4 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.01985 | Reg=0.00332 | L2-Norm=18.205 | L2-Norm(final)=2.071 | acc=1.0000 | 1541.2 samples/s | 24.1 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01787 | Reg=0.00329 | L2-Norm=18.141 | L2-Norm(final)=2.075 | acc=1.0000 | 4358.4 samples/s | 68.1 steps/s
[Step= 550 Epoch= 5.3] | Loss=0.01625 | Reg=0.00327 | L2-Norm=18.078 | L2-Norm(final)=2.078 | acc=1.0000 | 1520.3 samples/s | 23.8 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01489 | Reg=0.00325 | L2-Norm=18.014 | L2-Norm(final)=2.080 | acc=1.0000 | 3810.9 samples/s | 59.5 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01375 | Reg=0.00322 | L2-Norm=17.951 | L2-Norm(final)=2.083 | acc=1.0000 | 1544.5 samples/s | 24.1 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01277 | Reg=0.00320 | L2-Norm=17.888 | L2-Norm(final)=2.085 | acc=1.0000 | 4098.0 samples/s | 64.0 steps/s
[Step= 750 Epoch= 7.2] | Loss=0.01192 | Reg=0.00318 | L2-Norm=17.825 | L2-Norm(final)=2.087 | acc=1.0000 | 1571.2 samples/s | 24.6 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01117 | Reg=0.00316 | L2-Norm=17.762 | L2-Norm(final)=2.088 | acc=1.0000 | 4089.4 samples/s | 63.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26962 | acc=0.7727 | tpr=0.8067 | fpr=0.3013 | 4290.8 samples/s | 16.8 steps/s
Avg test loss: 0.27021, Avg test acc: 0.77182, Avg tpr: 0.80305, Avg fpr: 0.29689, total FA: 2316

Testing server on iccad2012
[Step=  50] | Loss=0.39070 | acc=0.4186 | tpr=0.8761 | fpr=0.5896 | 4102.4 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.39139 | acc=0.4122 | tpr=0.9019 | fpr=0.5970 | 9070.2 samples/s | 35.4 steps/s
[Step= 150] | Loss=0.39195 | acc=0.4116 | tpr=0.9135 | fpr=0.5977 | 7389.4 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.39216 | acc=0.4109 | tpr=0.9148 | fpr=0.5983 | 8228.1 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.39257 | acc=0.4110 | tpr=0.9179 | fpr=0.5982 | 8295.3 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.39251 | acc=0.4109 | tpr=0.9193 | fpr=0.5984 | 7740.1 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.39271 | acc=0.4102 | tpr=0.9180 | fpr=0.5990 | 7988.0 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.39303 | acc=0.4099 | tpr=0.9190 | fpr=0.5993 | 7912.0 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.39297 | acc=0.4106 | tpr=0.9197 | fpr=0.5987 | 7921.2 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.39305 | acc=0.4105 | tpr=0.9185 | fpr=0.5987 | 8100.5 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.39298 | acc=0.4107 | tpr=0.9208 | fpr=0.5985 | 15108.1 samples/s | 59.0 steps/s
Avg test loss: 0.39299, Avg test acc: 0.41065, Avg tpr: 0.92076, Avg fpr: 0.59863, total FA: 83118

server round 1/50

clients selected: [0 1 4 7 8]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.26391 | Reg=0.00305 | L2-Norm=17.467 | L2-Norm(final)=2.036 | acc=0.7969 | 3693.6 samples/s | 57.7 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.19999 | Reg=0.00308 | L2-Norm=17.548 | L2-Norm(final)=2.048 | acc=0.8125 | 4049.3 samples/s | 63.3 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.17240 | Reg=0.00309 | L2-Norm=17.567 | L2-Norm(final)=2.058 | acc=0.8594 | 4213.8 samples/s | 65.8 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.15537 | Reg=0.00309 | L2-Norm=17.565 | L2-Norm(final)=2.065 | acc=0.9062 | 4381.4 samples/s | 68.5 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.14329 | Reg=0.00308 | L2-Norm=17.559 | L2-Norm(final)=2.071 | acc=0.9531 | 5054.1 samples/s | 79.0 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.13737 | Reg=0.00308 | L2-Norm=17.560 | L2-Norm(final)=2.074 | acc=0.9531 | 1524.6 samples/s | 23.8 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.12638 | Reg=0.00309 | L2-Norm=17.566 | L2-Norm(final)=2.080 | acc=0.9844 | 4060.7 samples/s | 63.4 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.11833 | Reg=0.00309 | L2-Norm=17.570 | L2-Norm(final)=2.086 | acc=0.9531 | 4138.4 samples/s | 64.7 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.11192 | Reg=0.00309 | L2-Norm=17.573 | L2-Norm(final)=2.093 | acc=0.9844 | 4832.1 samples/s | 75.5 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.10506 | Reg=0.00309 | L2-Norm=17.577 | L2-Norm(final)=2.099 | acc=0.9688 | 1534.4 samples/s | 24.0 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.09907 | Reg=0.00309 | L2-Norm=17.581 | L2-Norm(final)=2.107 | acc=0.9844 | 3818.9 samples/s | 59.7 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.09461 | Reg=0.00309 | L2-Norm=17.585 | L2-Norm(final)=2.114 | acc=0.9688 | 3778.4 samples/s | 59.0 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.09069 | Reg=0.00309 | L2-Norm=17.590 | L2-Norm(final)=2.121 | acc=0.9375 | 4326.3 samples/s | 67.6 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.08625 | Reg=0.00310 | L2-Norm=17.595 | L2-Norm(final)=2.128 | acc=0.9844 | 1566.6 samples/s | 24.5 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.08229 | Reg=0.00310 | L2-Norm=17.599 | L2-Norm(final)=2.135 | acc=0.9688 | 4239.6 samples/s | 66.2 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07907 | Reg=0.00310 | L2-Norm=17.604 | L2-Norm(final)=2.142 | acc=0.9844 | 4279.7 samples/s | 66.9 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.07603 | Reg=0.00310 | L2-Norm=17.608 | L2-Norm(final)=2.149 | acc=1.0000 | 4332.1 samples/s | 67.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step1600.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.25446 | Reg=0.00305 | L2-Norm=17.467 | L2-Norm(final)=2.039 | acc=0.7812 | 3848.5 samples/s | 60.1 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.19835 | Reg=0.00304 | L2-Norm=17.425 | L2-Norm(final)=2.055 | acc=0.8438 | 4155.3 samples/s | 64.9 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.17904 | Reg=0.00303 | L2-Norm=17.400 | L2-Norm(final)=2.060 | acc=0.8750 | 4363.9 samples/s | 68.2 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.16148 | Reg=0.00302 | L2-Norm=17.378 | L2-Norm(final)=2.066 | acc=0.8750 | 4416.7 samples/s | 69.0 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.15220 | Reg=0.00301 | L2-Norm=17.363 | L2-Norm(final)=2.072 | acc=0.9531 | 5048.2 samples/s | 78.9 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.13696 | Reg=0.00301 | L2-Norm=17.355 | L2-Norm(final)=2.080 | acc=0.9531 | 1520.4 samples/s | 23.8 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.13000 | Reg=0.00301 | L2-Norm=17.351 | L2-Norm(final)=2.087 | acc=0.9688 | 4265.8 samples/s | 66.7 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.12306 | Reg=0.00301 | L2-Norm=17.353 | L2-Norm(final)=2.095 | acc=0.9219 | 4360.4 samples/s | 68.1 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.11594 | Reg=0.00301 | L2-Norm=17.356 | L2-Norm(final)=2.103 | acc=0.9844 | 4968.7 samples/s | 77.6 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.10833 | Reg=0.00301 | L2-Norm=17.359 | L2-Norm(final)=2.111 | acc=0.9531 | 1562.4 samples/s | 24.4 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.10206 | Reg=0.00301 | L2-Norm=17.362 | L2-Norm(final)=2.120 | acc=0.9844 | 4250.1 samples/s | 66.4 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.09707 | Reg=0.00302 | L2-Norm=17.366 | L2-Norm(final)=2.129 | acc=1.0000 | 4380.6 samples/s | 68.4 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.09366 | Reg=0.00302 | L2-Norm=17.371 | L2-Norm(final)=2.136 | acc=0.9844 | 4834.7 samples/s | 75.5 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.08928 | Reg=0.00302 | L2-Norm=17.377 | L2-Norm(final)=2.143 | acc=1.0000 | 1569.4 samples/s | 24.5 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.08523 | Reg=0.00302 | L2-Norm=17.383 | L2-Norm(final)=2.150 | acc=0.9844 | 4112.6 samples/s | 64.3 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.08202 | Reg=0.00302 | L2-Norm=17.389 | L2-Norm(final)=2.156 | acc=0.9688 | 4188.2 samples/s | 65.4 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.07933 | Reg=0.00303 | L2-Norm=17.393 | L2-Norm(final)=2.162 | acc=0.9688 | 4611.1 samples/s | 72.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step800.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.23839 | Reg=0.00305 | L2-Norm=17.467 | L2-Norm(final)=2.036 | acc=0.8281 | 3409.5 samples/s | 53.3 steps/s
[Step= 850 Epoch= 4.2] | Loss=0.19611 | Reg=0.00308 | L2-Norm=17.562 | L2-Norm(final)=2.047 | acc=0.8281 | 3888.3 samples/s | 60.8 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.17491 | Reg=0.00310 | L2-Norm=17.598 | L2-Norm(final)=2.050 | acc=0.9219 | 4135.0 samples/s | 64.6 steps/s
[Step= 950 Epoch= 4.7] | Loss=0.15831 | Reg=0.00310 | L2-Norm=17.609 | L2-Norm(final)=2.057 | acc=0.9062 | 4237.4 samples/s | 66.2 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.14461 | Reg=0.00310 | L2-Norm=17.612 | L2-Norm(final)=2.066 | acc=0.9375 | 5133.5 samples/s | 80.2 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.13033 | Reg=0.00310 | L2-Norm=17.616 | L2-Norm(final)=2.077 | acc=0.9531 | 1492.8 samples/s | 23.3 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.12000 | Reg=0.00311 | L2-Norm=17.622 | L2-Norm(final)=2.087 | acc=0.9844 | 3849.1 samples/s | 60.1 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.11371 | Reg=0.00311 | L2-Norm=17.626 | L2-Norm(final)=2.096 | acc=0.9375 | 3887.4 samples/s | 60.7 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.10768 | Reg=0.00311 | L2-Norm=17.633 | L2-Norm(final)=2.105 | acc=0.8750 | 4683.6 samples/s | 73.2 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.10198 | Reg=0.00311 | L2-Norm=17.641 | L2-Norm(final)=2.113 | acc=0.9688 | 1569.9 samples/s | 24.5 steps/s
[Step=1300 Epoch= 6.4] | Loss=0.09599 | Reg=0.00312 | L2-Norm=17.651 | L2-Norm(final)=2.122 | acc=0.9219 | 4391.5 samples/s | 68.6 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.09118 | Reg=0.00312 | L2-Norm=17.660 | L2-Norm(final)=2.131 | acc=0.9375 | 4307.9 samples/s | 67.3 steps/s
[Step=1400 Epoch= 6.9] | Loss=0.08689 | Reg=0.00312 | L2-Norm=17.669 | L2-Norm(final)=2.140 | acc=1.0000 | 4863.7 samples/s | 76.0 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.08337 | Reg=0.00312 | L2-Norm=17.676 | L2-Norm(final)=2.147 | acc=0.9844 | 1516.2 samples/s | 23.7 steps/s
[Step=1500 Epoch= 7.4] | Loss=0.07966 | Reg=0.00313 | L2-Norm=17.683 | L2-Norm(final)=2.154 | acc=0.9844 | 3912.3 samples/s | 61.1 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07672 | Reg=0.00313 | L2-Norm=17.690 | L2-Norm(final)=2.161 | acc=0.9688 | 3940.1 samples/s | 61.6 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.07381 | Reg=0.00313 | L2-Norm=17.697 | L2-Norm(final)=2.167 | acc=0.9688 | 4367.4 samples/s | 68.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step1600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.29240 | Reg=0.00305 | L2-Norm=17.467 | L2-Norm(final)=2.035 | acc=0.7031 | 3237.2 samples/s | 50.6 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.07759 | Reg=0.00316 | L2-Norm=17.787 | L2-Norm(final)=2.038 | acc=0.9844 | 3927.0 samples/s | 61.4 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.04139 | Reg=0.00319 | L2-Norm=17.857 | L2-Norm(final)=2.041 | acc=1.0000 | 5085.8 samples/s | 79.5 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.02839 | Reg=0.00319 | L2-Norm=17.846 | L2-Norm(final)=2.047 | acc=1.0000 | 1506.8 samples/s | 23.5 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.02144 | Reg=0.00317 | L2-Norm=17.812 | L2-Norm(final)=2.052 | acc=1.0000 | 4727.0 samples/s | 73.9 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01717 | Reg=0.00316 | L2-Norm=17.768 | L2-Norm(final)=2.056 | acc=1.0000 | 1494.5 samples/s | 23.4 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01432 | Reg=0.00314 | L2-Norm=17.719 | L2-Norm(final)=2.059 | acc=1.0000 | 4763.9 samples/s | 74.4 steps/s
[Step=1150 Epoch=11.0] | Loss=0.01228 | Reg=0.00312 | L2-Norm=17.668 | L2-Norm(final)=2.062 | acc=1.0000 | 1531.8 samples/s | 23.9 steps/s
[Step=1200 Epoch=11.5] | Loss=0.01075 | Reg=0.00310 | L2-Norm=17.616 | L2-Norm(final)=2.064 | acc=1.0000 | 4348.4 samples/s | 67.9 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00956 | Reg=0.00309 | L2-Norm=17.564 | L2-Norm(final)=2.066 | acc=1.0000 | 1531.3 samples/s | 23.9 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00861 | Reg=0.00307 | L2-Norm=17.511 | L2-Norm(final)=2.067 | acc=1.0000 | 4442.1 samples/s | 69.4 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00782 | Reg=0.00305 | L2-Norm=17.459 | L2-Norm(final)=2.068 | acc=1.0000 | 1515.5 samples/s | 23.7 steps/s
[Step=1400 Epoch=13.4] | Loss=0.00717 | Reg=0.00303 | L2-Norm=17.407 | L2-Norm(final)=2.070 | acc=1.0000 | 3820.3 samples/s | 59.7 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00662 | Reg=0.00301 | L2-Norm=17.356 | L2-Norm(final)=2.071 | acc=1.0000 | 1591.4 samples/s | 24.9 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00615 | Reg=0.00300 | L2-Norm=17.304 | L2-Norm(final)=2.072 | acc=1.0000 | 4194.9 samples/s | 65.5 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00574 | Reg=0.00298 | L2-Norm=17.253 | L2-Norm(final)=2.073 | acc=1.0000 | 1581.5 samples/s | 24.7 steps/s
[Step=1600 Epoch=15.3] | Loss=0.00538 | Reg=0.00296 | L2-Norm=17.203 | L2-Norm(final)=2.073 | acc=1.0000 | 4290.2 samples/s | 67.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step1600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.28308 | Reg=0.00305 | L2-Norm=17.467 | L2-Norm(final)=2.039 | acc=0.7344 | 4045.1 samples/s | 63.2 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.06923 | Reg=0.00306 | L2-Norm=17.487 | L2-Norm(final)=2.081 | acc=0.9531 | 3827.2 samples/s | 59.8 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.04179 | Reg=0.00305 | L2-Norm=17.478 | L2-Norm(final)=2.096 | acc=1.0000 | 4872.7 samples/s | 76.1 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.02841 | Reg=0.00305 | L2-Norm=17.458 | L2-Norm(final)=2.110 | acc=1.0000 | 1452.8 samples/s | 22.7 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.02215 | Reg=0.00304 | L2-Norm=17.427 | L2-Norm(final)=2.120 | acc=1.0000 | 4386.2 samples/s | 68.5 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.01792 | Reg=0.00303 | L2-Norm=17.399 | L2-Norm(final)=2.128 | acc=1.0000 | 1536.7 samples/s | 24.0 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.01496 | Reg=0.00302 | L2-Norm=17.367 | L2-Norm(final)=2.135 | acc=1.0000 | 4607.7 samples/s | 72.0 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.01287 | Reg=0.00300 | L2-Norm=17.330 | L2-Norm(final)=2.141 | acc=1.0000 | 1553.7 samples/s | 24.3 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.01127 | Reg=0.00299 | L2-Norm=17.291 | L2-Norm(final)=2.146 | acc=1.0000 | 4402.6 samples/s | 68.8 steps/s
[Step= 450 Epoch= 4.2] | Loss=0.01002 | Reg=0.00298 | L2-Norm=17.249 | L2-Norm(final)=2.150 | acc=1.0000 | 1566.9 samples/s | 24.5 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.00903 | Reg=0.00296 | L2-Norm=17.205 | L2-Norm(final)=2.154 | acc=1.0000 | 4025.9 samples/s | 62.9 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.00821 | Reg=0.00295 | L2-Norm=17.161 | L2-Norm(final)=2.157 | acc=1.0000 | 1546.0 samples/s | 24.2 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.00753 | Reg=0.00293 | L2-Norm=17.115 | L2-Norm(final)=2.160 | acc=1.0000 | 4114.9 samples/s | 64.3 steps/s
[Step= 650 Epoch= 6.1] | Loss=0.00695 | Reg=0.00291 | L2-Norm=17.069 | L2-Norm(final)=2.163 | acc=1.0000 | 1600.7 samples/s | 25.0 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.00645 | Reg=0.00290 | L2-Norm=17.023 | L2-Norm(final)=2.165 | acc=1.0000 | 3974.5 samples/s | 62.1 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00603 | Reg=0.00288 | L2-Norm=16.976 | L2-Norm(final)=2.168 | acc=1.0000 | 1694.9 samples/s | 26.5 steps/s
[Step= 800 Epoch= 7.5] | Loss=0.00565 | Reg=0.00287 | L2-Norm=16.929 | L2-Norm(final)=2.171 | acc=1.0000 | 3578.1 samples/s | 55.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21872 | acc=0.8119 | tpr=0.8201 | fpr=0.2059 | 4233.5 samples/s | 16.5 steps/s
Avg test loss: 0.21964, Avg test acc: 0.81060, Avg tpr: 0.81815, Avg fpr: 0.20600, total FA: 1607

Testing server on iccad2012
[Step=  50] | Loss=0.39512 | acc=0.5784 | tpr=0.9690 | fpr=0.4286 | 4214.4 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.39705 | acc=0.5748 | tpr=0.9765 | fpr=0.4327 | 8169.5 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.39920 | acc=0.5732 | tpr=0.9769 | fpr=0.4342 | 7972.6 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.39931 | acc=0.5727 | tpr=0.9749 | fpr=0.4347 | 8186.3 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.39974 | acc=0.5727 | tpr=0.9764 | fpr=0.4347 | 8518.3 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.40013 | acc=0.5730 | tpr=0.9760 | fpr=0.4344 | 8209.7 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.40047 | acc=0.5726 | tpr=0.9743 | fpr=0.4347 | 8403.7 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.40091 | acc=0.5720 | tpr=0.9759 | fpr=0.4354 | 8015.3 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.40098 | acc=0.5720 | tpr=0.9766 | fpr=0.4353 | 8201.1 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.40096 | acc=0.5721 | tpr=0.9771 | fpr=0.4352 | 8259.1 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.40093 | acc=0.5721 | tpr=0.9777 | fpr=0.4353 | 14843.3 samples/s | 58.0 steps/s
Avg test loss: 0.40088, Avg test acc: 0.57217, Avg tpr: 0.97742, Avg fpr: 0.43520, total FA: 60426

server round 2/50

clients selected: [0 1 2 5 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.20254 | Reg=0.00284 | L2-Norm=16.860 | L2-Norm(final)=2.105 | acc=0.8125 | 3669.7 samples/s | 57.3 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.14349 | Reg=0.00288 | L2-Norm=16.980 | L2-Norm(final)=2.121 | acc=0.9375 | 4365.3 samples/s | 68.2 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.12500 | Reg=0.00290 | L2-Norm=17.033 | L2-Norm(final)=2.134 | acc=0.9062 | 4278.4 samples/s | 66.9 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.11704 | Reg=0.00291 | L2-Norm=17.053 | L2-Norm(final)=2.140 | acc=0.9688 | 4192.0 samples/s | 65.5 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.10838 | Reg=0.00291 | L2-Norm=17.069 | L2-Norm(final)=2.147 | acc=0.9219 | 4974.8 samples/s | 77.7 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.09876 | Reg=0.00292 | L2-Norm=17.088 | L2-Norm(final)=2.157 | acc=0.9531 | 1551.8 samples/s | 24.2 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.09111 | Reg=0.00293 | L2-Norm=17.108 | L2-Norm(final)=2.167 | acc=0.9531 | 4324.7 samples/s | 67.6 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.08678 | Reg=0.00293 | L2-Norm=17.123 | L2-Norm(final)=2.174 | acc=0.9844 | 4386.1 samples/s | 68.5 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.08328 | Reg=0.00294 | L2-Norm=17.136 | L2-Norm(final)=2.181 | acc=0.9531 | 5076.1 samples/s | 79.3 steps/s
[Step=2050 Epoch=10.0] | Loss=0.07800 | Reg=0.00294 | L2-Norm=17.148 | L2-Norm(final)=2.189 | acc=1.0000 | 1563.0 samples/s | 24.4 steps/s
[Step=2100 Epoch=10.2] | Loss=0.07395 | Reg=0.00294 | L2-Norm=17.160 | L2-Norm(final)=2.196 | acc=0.9844 | 4378.4 samples/s | 68.4 steps/s
[Step=2150 Epoch=10.5] | Loss=0.07079 | Reg=0.00295 | L2-Norm=17.171 | L2-Norm(final)=2.203 | acc=0.9844 | 4093.1 samples/s | 64.0 steps/s
[Step=2200 Epoch=10.7] | Loss=0.06773 | Reg=0.00295 | L2-Norm=17.180 | L2-Norm(final)=2.209 | acc=0.9688 | 4370.1 samples/s | 68.3 steps/s
[Step=2250 Epoch=11.0] | Loss=0.06507 | Reg=0.00295 | L2-Norm=17.189 | L2-Norm(final)=2.214 | acc=1.0000 | 1535.7 samples/s | 24.0 steps/s
[Step=2300 Epoch=11.2] | Loss=0.06254 | Reg=0.00296 | L2-Norm=17.197 | L2-Norm(final)=2.219 | acc=0.9688 | 3810.1 samples/s | 59.5 steps/s
[Step=2350 Epoch=11.5] | Loss=0.06008 | Reg=0.00296 | L2-Norm=17.204 | L2-Norm(final)=2.225 | acc=0.9844 | 3946.3 samples/s | 61.7 steps/s
[Step=2400 Epoch=11.7] | Loss=0.05817 | Reg=0.00296 | L2-Norm=17.210 | L2-Norm(final)=2.229 | acc=0.9844 | 4184.3 samples/s | 65.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step2400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.23007 | Reg=0.00284 | L2-Norm=16.860 | L2-Norm(final)=2.105 | acc=0.7500 | 3555.2 samples/s | 55.5 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.15401 | Reg=0.00288 | L2-Norm=16.966 | L2-Norm(final)=2.120 | acc=0.9375 | 4229.1 samples/s | 66.1 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.13787 | Reg=0.00289 | L2-Norm=17.000 | L2-Norm(final)=2.126 | acc=0.9375 | 4148.8 samples/s | 64.8 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.12509 | Reg=0.00289 | L2-Norm=17.011 | L2-Norm(final)=2.133 | acc=0.9062 | 4122.6 samples/s | 64.4 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.11856 | Reg=0.00290 | L2-Norm=17.019 | L2-Norm(final)=2.140 | acc=0.9688 | 5081.8 samples/s | 79.4 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.10677 | Reg=0.00290 | L2-Norm=17.025 | L2-Norm(final)=2.147 | acc=0.9375 | 1478.5 samples/s | 23.1 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.09918 | Reg=0.00290 | L2-Norm=17.032 | L2-Norm(final)=2.156 | acc=0.9375 | 3868.8 samples/s | 60.5 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09346 | Reg=0.00290 | L2-Norm=17.040 | L2-Norm(final)=2.164 | acc=0.9375 | 3782.0 samples/s | 59.1 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.08918 | Reg=0.00291 | L2-Norm=17.047 | L2-Norm(final)=2.172 | acc=0.9375 | 4656.6 samples/s | 72.8 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08430 | Reg=0.00291 | L2-Norm=17.056 | L2-Norm(final)=2.180 | acc=0.9844 | 1585.4 samples/s | 24.8 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.08025 | Reg=0.00291 | L2-Norm=17.066 | L2-Norm(final)=2.189 | acc=0.9531 | 4398.4 samples/s | 68.7 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.07629 | Reg=0.00292 | L2-Norm=17.077 | L2-Norm(final)=2.197 | acc=1.0000 | 4258.8 samples/s | 66.5 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.07314 | Reg=0.00292 | L2-Norm=17.088 | L2-Norm(final)=2.205 | acc=1.0000 | 4628.0 samples/s | 72.3 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.06960 | Reg=0.00292 | L2-Norm=17.097 | L2-Norm(final)=2.212 | acc=0.9844 | 1568.6 samples/s | 24.5 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.06601 | Reg=0.00293 | L2-Norm=17.107 | L2-Norm(final)=2.220 | acc=0.9844 | 4436.3 samples/s | 69.3 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06336 | Reg=0.00293 | L2-Norm=17.115 | L2-Norm(final)=2.228 | acc=1.0000 | 4313.4 samples/s | 67.4 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06154 | Reg=0.00293 | L2-Norm=17.124 | L2-Norm(final)=2.235 | acc=0.9531 | 4506.6 samples/s | 70.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step1600.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.17289 | Reg=0.00284 | L2-Norm=16.860 | L2-Norm(final)=2.105 | acc=0.8438 | 3445.4 samples/s | 53.8 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.15420 | Reg=0.00289 | L2-Norm=17.007 | L2-Norm(final)=2.125 | acc=0.9375 | 4066.3 samples/s | 63.5 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.13425 | Reg=0.00291 | L2-Norm=17.064 | L2-Norm(final)=2.133 | acc=0.8906 | 4349.4 samples/s | 68.0 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.12190 | Reg=0.00292 | L2-Norm=17.087 | L2-Norm(final)=2.140 | acc=0.9219 | 4462.6 samples/s | 69.7 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.11612 | Reg=0.00292 | L2-Norm=17.100 | L2-Norm(final)=2.144 | acc=0.9531 | 5173.2 samples/s | 80.8 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.10601 | Reg=0.00293 | L2-Norm=17.116 | L2-Norm(final)=2.151 | acc=0.9219 | 1485.5 samples/s | 23.2 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.09808 | Reg=0.00294 | L2-Norm=17.135 | L2-Norm(final)=2.161 | acc=1.0000 | 3859.1 samples/s | 60.3 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09252 | Reg=0.00294 | L2-Norm=17.154 | L2-Norm(final)=2.169 | acc=0.9688 | 3916.8 samples/s | 61.2 steps/s
[Step=1200 Epoch= 5.8] | Loss=0.08768 | Reg=0.00295 | L2-Norm=17.173 | L2-Norm(final)=2.177 | acc=0.9531 | 4659.5 samples/s | 72.8 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08238 | Reg=0.00295 | L2-Norm=17.189 | L2-Norm(final)=2.184 | acc=1.0000 | 1535.1 samples/s | 24.0 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.07832 | Reg=0.00296 | L2-Norm=17.204 | L2-Norm(final)=2.191 | acc=0.9531 | 4309.0 samples/s | 67.3 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.07492 | Reg=0.00297 | L2-Norm=17.220 | L2-Norm(final)=2.198 | acc=0.9688 | 4341.6 samples/s | 67.8 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.07244 | Reg=0.00297 | L2-Norm=17.235 | L2-Norm(final)=2.204 | acc=0.9844 | 4832.3 samples/s | 75.5 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.06940 | Reg=0.00298 | L2-Norm=17.249 | L2-Norm(final)=2.209 | acc=0.9844 | 1576.1 samples/s | 24.6 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.06616 | Reg=0.00298 | L2-Norm=17.263 | L2-Norm(final)=2.215 | acc=0.9688 | 4092.0 samples/s | 63.9 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06364 | Reg=0.00298 | L2-Norm=17.276 | L2-Norm(final)=2.220 | acc=0.9688 | 4212.5 samples/s | 65.8 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06166 | Reg=0.00299 | L2-Norm=17.290 | L2-Norm(final)=2.226 | acc=0.9844 | 4220.0 samples/s | 65.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step1600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.17450 | Reg=0.00284 | L2-Norm=16.860 | L2-Norm(final)=2.107 | acc=0.8125 | 3434.6 samples/s | 53.7 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.04823 | Reg=0.00285 | L2-Norm=16.876 | L2-Norm(final)=2.131 | acc=0.9688 | 3702.1 samples/s | 57.8 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.02953 | Reg=0.00285 | L2-Norm=16.875 | L2-Norm(final)=2.145 | acc=1.0000 | 4724.6 samples/s | 73.8 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.02037 | Reg=0.00284 | L2-Norm=16.859 | L2-Norm(final)=2.155 | acc=1.0000 | 1486.3 samples/s | 23.2 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.01543 | Reg=0.00283 | L2-Norm=16.834 | L2-Norm(final)=2.162 | acc=1.0000 | 4890.0 samples/s | 76.4 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.01277 | Reg=0.00283 | L2-Norm=16.808 | L2-Norm(final)=2.169 | acc=1.0000 | 1521.1 samples/s | 23.8 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.01072 | Reg=0.00282 | L2-Norm=16.781 | L2-Norm(final)=2.175 | acc=1.0000 | 4452.6 samples/s | 69.6 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.00921 | Reg=0.00281 | L2-Norm=16.752 | L2-Norm(final)=2.181 | acc=1.0000 | 1540.5 samples/s | 24.1 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.00807 | Reg=0.00280 | L2-Norm=16.720 | L2-Norm(final)=2.185 | acc=1.0000 | 4364.2 samples/s | 68.2 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.00718 | Reg=0.00278 | L2-Norm=16.685 | L2-Norm(final)=2.190 | acc=1.0000 | 1514.0 samples/s | 23.7 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.00646 | Reg=0.00277 | L2-Norm=16.648 | L2-Norm(final)=2.193 | acc=1.0000 | 3847.8 samples/s | 60.1 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.00588 | Reg=0.00276 | L2-Norm=16.610 | L2-Norm(final)=2.196 | acc=1.0000 | 1567.8 samples/s | 24.5 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.00539 | Reg=0.00275 | L2-Norm=16.570 | L2-Norm(final)=2.199 | acc=1.0000 | 4124.6 samples/s | 64.4 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.00497 | Reg=0.00273 | L2-Norm=16.529 | L2-Norm(final)=2.201 | acc=1.0000 | 1568.8 samples/s | 24.5 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.00462 | Reg=0.00272 | L2-Norm=16.487 | L2-Norm(final)=2.203 | acc=1.0000 | 4060.5 samples/s | 63.4 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00431 | Reg=0.00271 | L2-Norm=16.445 | L2-Norm(final)=2.205 | acc=1.0000 | 1620.4 samples/s | 25.3 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00404 | Reg=0.00269 | L2-Norm=16.401 | L2-Norm(final)=2.207 | acc=1.0000 | 3926.9 samples/s | 61.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.18249 | Reg=0.00284 | L2-Norm=16.860 | L2-Norm(final)=2.107 | acc=0.8438 | 3785.7 samples/s | 59.2 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.05034 | Reg=0.00285 | L2-Norm=16.889 | L2-Norm(final)=2.129 | acc=0.9688 | 3648.8 samples/s | 57.0 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.02871 | Reg=0.00285 | L2-Norm=16.890 | L2-Norm(final)=2.143 | acc=1.0000 | 4994.0 samples/s | 78.0 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.01956 | Reg=0.00285 | L2-Norm=16.873 | L2-Norm(final)=2.154 | acc=1.0000 | 1485.2 samples/s | 23.2 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.01474 | Reg=0.00284 | L2-Norm=16.846 | L2-Norm(final)=2.163 | acc=1.0000 | 4750.6 samples/s | 74.2 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.01183 | Reg=0.00283 | L2-Norm=16.812 | L2-Norm(final)=2.170 | acc=1.0000 | 1525.8 samples/s | 23.8 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.00987 | Reg=0.00281 | L2-Norm=16.773 | L2-Norm(final)=2.176 | acc=1.0000 | 4576.4 samples/s | 71.5 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.00847 | Reg=0.00280 | L2-Norm=16.731 | L2-Norm(final)=2.181 | acc=1.0000 | 1525.6 samples/s | 23.8 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.00742 | Reg=0.00278 | L2-Norm=16.687 | L2-Norm(final)=2.185 | acc=1.0000 | 4318.8 samples/s | 67.5 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.00660 | Reg=0.00277 | L2-Norm=16.641 | L2-Norm(final)=2.189 | acc=1.0000 | 1534.6 samples/s | 24.0 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.00594 | Reg=0.00275 | L2-Norm=16.594 | L2-Norm(final)=2.193 | acc=1.0000 | 4367.5 samples/s | 68.2 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.00541 | Reg=0.00274 | L2-Norm=16.546 | L2-Norm(final)=2.197 | acc=1.0000 | 1545.5 samples/s | 24.1 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.00496 | Reg=0.00272 | L2-Norm=16.498 | L2-Norm(final)=2.201 | acc=1.0000 | 4322.8 samples/s | 67.5 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.00458 | Reg=0.00271 | L2-Norm=16.449 | L2-Norm(final)=2.205 | acc=1.0000 | 1606.7 samples/s | 25.1 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.00425 | Reg=0.00269 | L2-Norm=16.399 | L2-Norm(final)=2.208 | acc=1.0000 | 3981.9 samples/s | 62.2 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00397 | Reg=0.00267 | L2-Norm=16.348 | L2-Norm(final)=2.212 | acc=1.0000 | 1564.6 samples/s | 24.4 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00372 | Reg=0.00266 | L2-Norm=16.297 | L2-Norm(final)=2.216 | acc=1.0000 | 4277.0 samples/s | 66.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36835 | acc=0.6412 | tpr=0.5185 | fpr=0.0924 | 4020.4 samples/s | 15.7 steps/s
Avg test loss: 0.36944, Avg test acc: 0.64048, Avg tpr: 0.51769, Avg fpr: 0.08948, total FA: 698

Testing server on iccad2012
[Step=  50] | Loss=0.24079 | acc=0.8305 | tpr=0.9735 | fpr=0.1721 | 4230.7 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.24294 | acc=0.8277 | tpr=0.9851 | fpr=0.1752 | 8233.6 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.24555 | acc=0.8252 | tpr=0.9841 | fpr=0.1778 | 8938.2 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.24608 | acc=0.8261 | tpr=0.9825 | fpr=0.1767 | 8154.1 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.24647 | acc=0.8263 | tpr=0.9817 | fpr=0.1766 | 8258.2 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.24722 | acc=0.8261 | tpr=0.9804 | fpr=0.1767 | 7953.9 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.24741 | acc=0.8259 | tpr=0.9775 | fpr=0.1769 | 8213.7 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.24817 | acc=0.8257 | tpr=0.9776 | fpr=0.1771 | 7901.5 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.24881 | acc=0.8255 | tpr=0.9766 | fpr=0.1772 | 8044.3 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.24870 | acc=0.8254 | tpr=0.9767 | fpr=0.1774 | 7996.4 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.24851 | acc=0.8255 | tpr=0.9773 | fpr=0.1773 | 14555.8 samples/s | 56.9 steps/s
Avg test loss: 0.24834, Avg test acc: 0.82562, Avg tpr: 0.97742, Avg fpr: 0.17714, total FA: 24595

server round 3/50

clients selected: [0 2 6 7 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.26143 | Reg=0.00262 | L2-Norm=16.179 | L2-Norm(final)=2.186 | acc=0.7969 | 3776.3 samples/s | 59.0 steps/s
[Step=2450 Epoch=11.9] | Loss=0.12679 | Reg=0.00267 | L2-Norm=16.355 | L2-Norm(final)=2.169 | acc=0.9688 | 4175.8 samples/s | 65.2 steps/s
[Step=2500 Epoch=12.2] | Loss=0.11445 | Reg=0.00269 | L2-Norm=16.409 | L2-Norm(final)=2.175 | acc=0.9375 | 4334.3 samples/s | 67.7 steps/s
[Step=2550 Epoch=12.4] | Loss=0.10353 | Reg=0.00270 | L2-Norm=16.444 | L2-Norm(final)=2.182 | acc=0.9219 | 4252.4 samples/s | 66.4 steps/s
[Step=2600 Epoch=12.7] | Loss=0.09847 | Reg=0.00271 | L2-Norm=16.470 | L2-Norm(final)=2.188 | acc=0.9844 | 5092.6 samples/s | 79.6 steps/s
[Step=2650 Epoch=12.9] | Loss=0.09056 | Reg=0.00272 | L2-Norm=16.499 | L2-Norm(final)=2.195 | acc=0.9219 | 1492.0 samples/s | 23.3 steps/s
[Step=2700 Epoch=13.2] | Loss=0.08427 | Reg=0.00273 | L2-Norm=16.525 | L2-Norm(final)=2.203 | acc=0.9688 | 3894.5 samples/s | 60.9 steps/s
[Step=2750 Epoch=13.4] | Loss=0.08022 | Reg=0.00274 | L2-Norm=16.546 | L2-Norm(final)=2.210 | acc=0.9375 | 3940.7 samples/s | 61.6 steps/s
[Step=2800 Epoch=13.7] | Loss=0.07520 | Reg=0.00274 | L2-Norm=16.565 | L2-Norm(final)=2.216 | acc=1.0000 | 4550.9 samples/s | 71.1 steps/s
[Step=2850 Epoch=13.9] | Loss=0.07467 | Reg=0.00275 | L2-Norm=16.586 | L2-Norm(final)=2.220 | acc=0.9531 | 1550.8 samples/s | 24.2 steps/s
[Step=2900 Epoch=14.1] | Loss=0.07306 | Reg=0.00276 | L2-Norm=16.611 | L2-Norm(final)=2.223 | acc=0.9688 | 4122.1 samples/s | 64.4 steps/s
[Step=2950 Epoch=14.4] | Loss=0.07065 | Reg=0.00277 | L2-Norm=16.635 | L2-Norm(final)=2.225 | acc=0.9219 | 4276.4 samples/s | 66.8 steps/s
[Step=3000 Epoch=14.6] | Loss=0.06775 | Reg=0.00277 | L2-Norm=16.655 | L2-Norm(final)=2.228 | acc=0.9844 | 4684.1 samples/s | 73.2 steps/s
[Step=3050 Epoch=14.9] | Loss=0.06475 | Reg=0.00278 | L2-Norm=16.673 | L2-Norm(final)=2.232 | acc=0.9844 | 1571.1 samples/s | 24.5 steps/s
[Step=3100 Epoch=15.1] | Loss=0.06209 | Reg=0.00279 | L2-Norm=16.689 | L2-Norm(final)=2.235 | acc=0.9844 | 4201.5 samples/s | 65.6 steps/s
[Step=3150 Epoch=15.4] | Loss=0.05968 | Reg=0.00279 | L2-Norm=16.703 | L2-Norm(final)=2.238 | acc=0.9844 | 4127.6 samples/s | 64.5 steps/s
[Step=3200 Epoch=15.6] | Loss=0.05791 | Reg=0.00279 | L2-Norm=16.715 | L2-Norm(final)=2.242 | acc=0.9688 | 4524.3 samples/s | 70.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step3200.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.32352 | Reg=0.00262 | L2-Norm=16.179 | L2-Norm(final)=2.187 | acc=0.6875 | 3677.9 samples/s | 57.5 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.13626 | Reg=0.00267 | L2-Norm=16.327 | L2-Norm(final)=2.172 | acc=0.9062 | 4155.3 samples/s | 64.9 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.11631 | Reg=0.00269 | L2-Norm=16.395 | L2-Norm(final)=2.180 | acc=0.9531 | 4164.9 samples/s | 65.1 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.10643 | Reg=0.00270 | L2-Norm=16.435 | L2-Norm(final)=2.188 | acc=0.9219 | 4148.3 samples/s | 64.8 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09943 | Reg=0.00271 | L2-Norm=16.466 | L2-Norm(final)=2.195 | acc=0.8906 | 4986.4 samples/s | 77.9 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08937 | Reg=0.00272 | L2-Norm=16.495 | L2-Norm(final)=2.206 | acc=0.9844 | 1493.9 samples/s | 23.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.08299 | Reg=0.00273 | L2-Norm=16.526 | L2-Norm(final)=2.218 | acc=0.9688 | 3865.5 samples/s | 60.4 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07876 | Reg=0.00274 | L2-Norm=16.554 | L2-Norm(final)=2.227 | acc=0.9375 | 3816.3 samples/s | 59.6 steps/s
[Step=2000 Epoch= 9.7] | Loss=0.07473 | Reg=0.00275 | L2-Norm=16.580 | L2-Norm(final)=2.237 | acc=0.9688 | 4464.0 samples/s | 69.8 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06992 | Reg=0.00276 | L2-Norm=16.602 | L2-Norm(final)=2.245 | acc=0.9844 | 1520.7 samples/s | 23.8 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06552 | Reg=0.00276 | L2-Norm=16.623 | L2-Norm(final)=2.254 | acc=0.9531 | 3880.3 samples/s | 60.6 steps/s
[Step=2150 Epoch=10.5] | Loss=0.06301 | Reg=0.00277 | L2-Norm=16.641 | L2-Norm(final)=2.261 | acc=0.9375 | 3837.4 samples/s | 60.0 steps/s
[Step=2200 Epoch=10.7] | Loss=0.06132 | Reg=0.00278 | L2-Norm=16.658 | L2-Norm(final)=2.267 | acc=0.9844 | 4311.0 samples/s | 67.4 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05837 | Reg=0.00278 | L2-Norm=16.676 | L2-Norm(final)=2.273 | acc=0.9844 | 1567.8 samples/s | 24.5 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05649 | Reg=0.00279 | L2-Norm=16.693 | L2-Norm(final)=2.279 | acc=1.0000 | 4369.0 samples/s | 68.3 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05469 | Reg=0.00279 | L2-Norm=16.709 | L2-Norm(final)=2.285 | acc=0.9688 | 4274.6 samples/s | 66.8 steps/s
[Step=2400 Epoch=11.7] | Loss=0.05349 | Reg=0.00280 | L2-Norm=16.725 | L2-Norm(final)=2.290 | acc=0.9688 | 4638.9 samples/s | 72.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step2400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.06213 | Reg=0.00262 | L2-Norm=16.179 | L2-Norm(final)=2.189 | acc=0.9688 | 3614.1 samples/s | 56.5 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.03610 | Reg=0.00269 | L2-Norm=16.403 | L2-Norm(final)=2.178 | acc=1.0000 | 3886.9 samples/s | 60.7 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.01965 | Reg=0.00273 | L2-Norm=16.510 | L2-Norm(final)=2.180 | acc=1.0000 | 4926.6 samples/s | 77.0 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01322 | Reg=0.00273 | L2-Norm=16.532 | L2-Norm(final)=2.185 | acc=1.0000 | 1479.9 samples/s | 23.1 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.00994 | Reg=0.00273 | L2-Norm=16.525 | L2-Norm(final)=2.189 | acc=1.0000 | 4652.5 samples/s | 72.7 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00796 | Reg=0.00272 | L2-Norm=16.505 | L2-Norm(final)=2.191 | acc=1.0000 | 1453.3 samples/s | 22.7 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00664 | Reg=0.00272 | L2-Norm=16.479 | L2-Norm(final)=2.193 | acc=1.0000 | 4227.4 samples/s | 66.1 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00569 | Reg=0.00271 | L2-Norm=16.450 | L2-Norm(final)=2.195 | acc=1.0000 | 1532.5 samples/s | 23.9 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00498 | Reg=0.00270 | L2-Norm=16.418 | L2-Norm(final)=2.196 | acc=1.0000 | 4138.6 samples/s | 64.7 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00443 | Reg=0.00269 | L2-Norm=16.386 | L2-Norm(final)=2.197 | acc=1.0000 | 1563.0 samples/s | 24.4 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00399 | Reg=0.00267 | L2-Norm=16.353 | L2-Norm(final)=2.198 | acc=1.0000 | 4158.3 samples/s | 65.0 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00363 | Reg=0.00266 | L2-Norm=16.319 | L2-Norm(final)=2.199 | acc=1.0000 | 1532.8 samples/s | 24.0 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00333 | Reg=0.00265 | L2-Norm=16.286 | L2-Norm(final)=2.200 | acc=1.0000 | 4179.5 samples/s | 65.3 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00307 | Reg=0.00264 | L2-Norm=16.252 | L2-Norm(final)=2.201 | acc=1.0000 | 1563.3 samples/s | 24.4 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00285 | Reg=0.00263 | L2-Norm=16.217 | L2-Norm(final)=2.201 | acc=1.0000 | 3762.3 samples/s | 58.8 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00266 | Reg=0.00262 | L2-Norm=16.183 | L2-Norm(final)=2.202 | acc=1.0000 | 1566.4 samples/s | 24.5 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00250 | Reg=0.00261 | L2-Norm=16.149 | L2-Norm(final)=2.203 | acc=1.0000 | 4041.2 samples/s | 63.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step1600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch=15.3] | Loss=0.06154 | Reg=0.00262 | L2-Norm=16.179 | L2-Norm(final)=2.188 | acc=0.9531 | 3781.6 samples/s | 59.1 steps/s
[Step=1650 Epoch=15.8] | Loss=0.04117 | Reg=0.00272 | L2-Norm=16.491 | L2-Norm(final)=2.165 | acc=0.9688 | 3772.4 samples/s | 58.9 steps/s
[Step=1700 Epoch=16.2] | Loss=0.02268 | Reg=0.00275 | L2-Norm=16.589 | L2-Norm(final)=2.169 | acc=1.0000 | 4885.0 samples/s | 76.3 steps/s
[Step=1750 Epoch=16.7] | Loss=0.01521 | Reg=0.00276 | L2-Norm=16.601 | L2-Norm(final)=2.175 | acc=1.0000 | 1489.8 samples/s | 23.3 steps/s
[Step=1800 Epoch=17.2] | Loss=0.01142 | Reg=0.00275 | L2-Norm=16.586 | L2-Norm(final)=2.179 | acc=1.0000 | 4765.2 samples/s | 74.5 steps/s
[Step=1850 Epoch=17.7] | Loss=0.00914 | Reg=0.00274 | L2-Norm=16.560 | L2-Norm(final)=2.182 | acc=1.0000 | 1505.9 samples/s | 23.5 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00763 | Reg=0.00273 | L2-Norm=16.528 | L2-Norm(final)=2.184 | acc=1.0000 | 4433.6 samples/s | 69.3 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00654 | Reg=0.00272 | L2-Norm=16.493 | L2-Norm(final)=2.186 | acc=1.0000 | 1529.6 samples/s | 23.9 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00573 | Reg=0.00271 | L2-Norm=16.456 | L2-Norm(final)=2.187 | acc=1.0000 | 4437.2 samples/s | 69.3 steps/s
[Step=2050 Epoch=19.6] | Loss=0.00509 | Reg=0.00270 | L2-Norm=16.419 | L2-Norm(final)=2.189 | acc=1.0000 | 1633.2 samples/s | 25.5 steps/s
[Step=2100 Epoch=20.1] | Loss=0.00458 | Reg=0.00268 | L2-Norm=16.381 | L2-Norm(final)=2.190 | acc=1.0000 | 4412.4 samples/s | 68.9 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00417 | Reg=0.00267 | L2-Norm=16.343 | L2-Norm(final)=2.191 | acc=1.0000 | 1700.2 samples/s | 26.6 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00382 | Reg=0.00266 | L2-Norm=16.305 | L2-Norm(final)=2.192 | acc=1.0000 | 4362.1 samples/s | 68.2 steps/s
[Step=2250 Epoch=21.5] | Loss=0.00353 | Reg=0.00265 | L2-Norm=16.266 | L2-Norm(final)=2.193 | acc=1.0000 | 1539.9 samples/s | 24.1 steps/s
[Step=2300 Epoch=22.0] | Loss=0.00328 | Reg=0.00263 | L2-Norm=16.228 | L2-Norm(final)=2.194 | acc=1.0000 | 3813.8 samples/s | 59.6 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00306 | Reg=0.00262 | L2-Norm=16.189 | L2-Norm(final)=2.195 | acc=1.0000 | 1587.6 samples/s | 24.8 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00287 | Reg=0.00261 | L2-Norm=16.151 | L2-Norm(final)=2.197 | acc=1.0000 | 4287.3 samples/s | 67.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step2400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.13700 | Reg=0.00262 | L2-Norm=16.179 | L2-Norm(final)=2.187 | acc=0.8750 | 4010.9 samples/s | 62.7 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.04164 | Reg=0.00271 | L2-Norm=16.475 | L2-Norm(final)=2.159 | acc=1.0000 | 3655.1 samples/s | 57.1 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.02309 | Reg=0.00275 | L2-Norm=16.568 | L2-Norm(final)=2.166 | acc=0.9844 | 5018.7 samples/s | 78.4 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.01554 | Reg=0.00275 | L2-Norm=16.584 | L2-Norm(final)=2.176 | acc=1.0000 | 1482.1 samples/s | 23.2 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01170 | Reg=0.00275 | L2-Norm=16.569 | L2-Norm(final)=2.184 | acc=1.0000 | 4583.3 samples/s | 71.6 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00937 | Reg=0.00274 | L2-Norm=16.539 | L2-Norm(final)=2.189 | acc=1.0000 | 1540.2 samples/s | 24.1 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00781 | Reg=0.00272 | L2-Norm=16.502 | L2-Norm(final)=2.193 | acc=1.0000 | 4823.9 samples/s | 75.4 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00670 | Reg=0.00271 | L2-Norm=16.462 | L2-Norm(final)=2.197 | acc=1.0000 | 1534.1 samples/s | 24.0 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00586 | Reg=0.00270 | L2-Norm=16.419 | L2-Norm(final)=2.199 | acc=1.0000 | 4468.5 samples/s | 69.8 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00521 | Reg=0.00268 | L2-Norm=16.375 | L2-Norm(final)=2.201 | acc=1.0000 | 1539.2 samples/s | 24.0 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00469 | Reg=0.00267 | L2-Norm=16.331 | L2-Norm(final)=2.203 | acc=1.0000 | 4301.9 samples/s | 67.2 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00427 | Reg=0.00265 | L2-Norm=16.285 | L2-Norm(final)=2.205 | acc=1.0000 | 1547.3 samples/s | 24.2 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00391 | Reg=0.00264 | L2-Norm=16.240 | L2-Norm(final)=2.207 | acc=1.0000 | 4029.7 samples/s | 63.0 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00361 | Reg=0.00262 | L2-Norm=16.194 | L2-Norm(final)=2.208 | acc=1.0000 | 1562.6 samples/s | 24.4 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00336 | Reg=0.00261 | L2-Norm=16.149 | L2-Norm(final)=2.209 | acc=1.0000 | 4265.8 samples/s | 66.7 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00313 | Reg=0.00259 | L2-Norm=16.103 | L2-Norm(final)=2.211 | acc=1.0000 | 1568.0 samples/s | 24.5 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00294 | Reg=0.00258 | L2-Norm=16.057 | L2-Norm(final)=2.212 | acc=1.0000 | 4013.4 samples/s | 62.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42587 | acc=0.6041 | tpr=0.4471 | fpr=0.0548 | 4186.4 samples/s | 16.4 steps/s
Avg test loss: 0.42852, Avg test acc: 0.60357, Avg tpr: 0.44769, Avg fpr: 0.05358, total FA: 418

Testing server on iccad2012
[Step=  50] | Loss=0.19047 | acc=0.8717 | tpr=0.9690 | fpr=0.1300 | 4222.9 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.19229 | acc=0.8710 | tpr=0.9787 | fpr=0.1310 | 7919.8 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.19462 | acc=0.8689 | tpr=0.9784 | fpr=0.1332 | 7890.4 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.19533 | acc=0.8695 | tpr=0.9781 | fpr=0.1325 | 8289.9 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.19512 | acc=0.8697 | tpr=0.9764 | fpr=0.1322 | 8066.5 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.19596 | acc=0.8693 | tpr=0.9760 | fpr=0.1326 | 8257.6 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.19635 | acc=0.8694 | tpr=0.9750 | fpr=0.1325 | 8127.6 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.19704 | acc=0.8692 | tpr=0.9737 | fpr=0.1327 | 7861.5 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.19801 | acc=0.8692 | tpr=0.9713 | fpr=0.1327 | 7772.4 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.19804 | acc=0.8686 | tpr=0.9718 | fpr=0.1333 | 8138.3 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.19787 | acc=0.8686 | tpr=0.9713 | fpr=0.1332 | 16052.1 samples/s | 62.7 steps/s
Avg test loss: 0.19770, Avg test acc: 0.86874, Avg tpr: 0.97108, Avg fpr: 0.13312, total FA: 18484

server round 4/50

clients selected: [1 4 6 7 8]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.30037 | Reg=0.00252 | L2-Norm=15.882 | L2-Norm(final)=2.213 | acc=0.6875 | 3837.1 samples/s | 60.0 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.13223 | Reg=0.00258 | L2-Norm=16.066 | L2-Norm(final)=2.200 | acc=0.9062 | 3941.6 samples/s | 61.6 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.11346 | Reg=0.00260 | L2-Norm=16.121 | L2-Norm(final)=2.208 | acc=0.9688 | 4356.7 samples/s | 68.1 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.10277 | Reg=0.00261 | L2-Norm=16.149 | L2-Norm(final)=2.214 | acc=0.9219 | 4193.9 samples/s | 65.5 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09420 | Reg=0.00262 | L2-Norm=16.172 | L2-Norm(final)=2.221 | acc=0.9531 | 5131.3 samples/s | 80.2 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08371 | Reg=0.00262 | L2-Norm=16.195 | L2-Norm(final)=2.231 | acc=0.9688 | 1522.7 samples/s | 23.8 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07648 | Reg=0.00263 | L2-Norm=16.219 | L2-Norm(final)=2.243 | acc=1.0000 | 4203.3 samples/s | 65.7 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07179 | Reg=0.00264 | L2-Norm=16.236 | L2-Norm(final)=2.251 | acc=1.0000 | 4292.6 samples/s | 67.1 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06861 | Reg=0.00264 | L2-Norm=16.251 | L2-Norm(final)=2.257 | acc=0.9375 | 4985.2 samples/s | 77.9 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06457 | Reg=0.00265 | L2-Norm=16.266 | L2-Norm(final)=2.264 | acc=0.9688 | 1516.7 samples/s | 23.7 steps/s
[Step=2100 Epoch=10.2] | Loss=0.06096 | Reg=0.00265 | L2-Norm=16.279 | L2-Norm(final)=2.270 | acc=0.9844 | 3847.7 samples/s | 60.1 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05823 | Reg=0.00265 | L2-Norm=16.291 | L2-Norm(final)=2.276 | acc=1.0000 | 3844.3 samples/s | 60.1 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05633 | Reg=0.00266 | L2-Norm=16.303 | L2-Norm(final)=2.282 | acc=1.0000 | 4455.1 samples/s | 69.6 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05450 | Reg=0.00266 | L2-Norm=16.314 | L2-Norm(final)=2.286 | acc=1.0000 | 1524.6 samples/s | 23.8 steps/s
[Step=2300 Epoch=11.2] | Loss=0.05234 | Reg=0.00267 | L2-Norm=16.326 | L2-Norm(final)=2.290 | acc=0.9844 | 3873.3 samples/s | 60.5 steps/s
[Step=2350 Epoch=11.5] | Loss=0.05055 | Reg=0.00267 | L2-Norm=16.338 | L2-Norm(final)=2.294 | acc=0.9844 | 3807.1 samples/s | 59.5 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04919 | Reg=0.00267 | L2-Norm=16.349 | L2-Norm(final)=2.298 | acc=0.9844 | 4235.0 samples/s | 66.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step2400.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 7.9] | Loss=0.40457 | Reg=0.00252 | L2-Norm=15.882 | L2-Norm(final)=2.212 | acc=0.6094 | 3456.9 samples/s | 54.0 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.12431 | Reg=0.00258 | L2-Norm=16.060 | L2-Norm(final)=2.200 | acc=0.8750 | 4248.1 samples/s | 66.4 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.10418 | Reg=0.00260 | L2-Norm=16.124 | L2-Norm(final)=2.206 | acc=0.9062 | 4311.2 samples/s | 67.4 steps/s
[Step=1750 Epoch= 8.6] | Loss=0.09727 | Reg=0.00261 | L2-Norm=16.162 | L2-Norm(final)=2.213 | acc=0.9062 | 4223.2 samples/s | 66.0 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.09064 | Reg=0.00262 | L2-Norm=16.192 | L2-Norm(final)=2.218 | acc=0.9844 | 4925.3 samples/s | 77.0 steps/s
[Step=1850 Epoch= 9.1] | Loss=0.08012 | Reg=0.00263 | L2-Norm=16.218 | L2-Norm(final)=2.226 | acc=1.0000 | 1533.8 samples/s | 24.0 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07495 | Reg=0.00264 | L2-Norm=16.242 | L2-Norm(final)=2.235 | acc=0.9531 | 4265.0 samples/s | 66.6 steps/s
[Step=1950 Epoch= 9.6] | Loss=0.07056 | Reg=0.00265 | L2-Norm=16.265 | L2-Norm(final)=2.243 | acc=0.9688 | 4402.5 samples/s | 68.8 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06704 | Reg=0.00265 | L2-Norm=16.289 | L2-Norm(final)=2.250 | acc=0.9375 | 5060.2 samples/s | 79.1 steps/s
[Step=2050 Epoch=10.1] | Loss=0.06262 | Reg=0.00266 | L2-Norm=16.313 | L2-Norm(final)=2.257 | acc=1.0000 | 1506.9 samples/s | 23.5 steps/s
[Step=2100 Epoch=10.3] | Loss=0.05990 | Reg=0.00267 | L2-Norm=16.334 | L2-Norm(final)=2.264 | acc=1.0000 | 4388.1 samples/s | 68.6 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05708 | Reg=0.00267 | L2-Norm=16.353 | L2-Norm(final)=2.270 | acc=0.9844 | 4375.4 samples/s | 68.4 steps/s
[Step=2200 Epoch=10.8] | Loss=0.05537 | Reg=0.00268 | L2-Norm=16.372 | L2-Norm(final)=2.276 | acc=0.9375 | 4986.4 samples/s | 77.9 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05278 | Reg=0.00269 | L2-Norm=16.390 | L2-Norm(final)=2.281 | acc=0.9844 | 1550.4 samples/s | 24.2 steps/s
[Step=2300 Epoch=11.3] | Loss=0.05059 | Reg=0.00269 | L2-Norm=16.407 | L2-Norm(final)=2.286 | acc=1.0000 | 4329.6 samples/s | 67.6 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04853 | Reg=0.00270 | L2-Norm=16.422 | L2-Norm(final)=2.291 | acc=0.9844 | 4088.7 samples/s | 63.9 steps/s
[Step=2400 Epoch=11.8] | Loss=0.04729 | Reg=0.00270 | L2-Norm=16.437 | L2-Norm(final)=2.296 | acc=0.9844 | 4365.3 samples/s | 68.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step2400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.05963 | Reg=0.00252 | L2-Norm=15.882 | L2-Norm(final)=2.215 | acc=0.9688 | 3389.3 samples/s | 53.0 steps/s
[Step=1650 Epoch=15.7] | Loss=0.03792 | Reg=0.00259 | L2-Norm=16.085 | L2-Norm(final)=2.199 | acc=1.0000 | 3729.2 samples/s | 58.3 steps/s
[Step=1700 Epoch=16.2] | Loss=0.02267 | Reg=0.00263 | L2-Norm=16.203 | L2-Norm(final)=2.188 | acc=0.9844 | 5055.8 samples/s | 79.0 steps/s
[Step=1750 Epoch=16.6] | Loss=0.01524 | Reg=0.00264 | L2-Norm=16.236 | L2-Norm(final)=2.188 | acc=1.0000 | 1497.8 samples/s | 23.4 steps/s
[Step=1800 Epoch=17.1] | Loss=0.01145 | Reg=0.00264 | L2-Norm=16.233 | L2-Norm(final)=2.189 | acc=1.0000 | 4700.1 samples/s | 73.4 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00917 | Reg=0.00263 | L2-Norm=16.216 | L2-Norm(final)=2.190 | acc=1.0000 | 1489.6 samples/s | 23.3 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00765 | Reg=0.00262 | L2-Norm=16.192 | L2-Norm(final)=2.191 | acc=1.0000 | 4431.4 samples/s | 69.2 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00656 | Reg=0.00261 | L2-Norm=16.163 | L2-Norm(final)=2.192 | acc=1.0000 | 1557.8 samples/s | 24.3 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00574 | Reg=0.00260 | L2-Norm=16.133 | L2-Norm(final)=2.193 | acc=1.0000 | 4337.4 samples/s | 67.8 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00511 | Reg=0.00259 | L2-Norm=16.102 | L2-Norm(final)=2.194 | acc=1.0000 | 1559.5 samples/s | 24.4 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00460 | Reg=0.00258 | L2-Norm=16.069 | L2-Norm(final)=2.195 | acc=1.0000 | 4263.8 samples/s | 66.6 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00418 | Reg=0.00257 | L2-Norm=16.036 | L2-Norm(final)=2.196 | acc=1.0000 | 1567.4 samples/s | 24.5 steps/s
[Step=2200 Epoch=20.9] | Loss=0.00383 | Reg=0.00256 | L2-Norm=16.003 | L2-Norm(final)=2.197 | acc=1.0000 | 4137.3 samples/s | 64.6 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00354 | Reg=0.00255 | L2-Norm=15.969 | L2-Norm(final)=2.198 | acc=1.0000 | 1591.3 samples/s | 24.9 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00329 | Reg=0.00254 | L2-Norm=15.935 | L2-Norm(final)=2.198 | acc=1.0000 | 4068.3 samples/s | 63.6 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00307 | Reg=0.00253 | L2-Norm=15.901 | L2-Norm(final)=2.199 | acc=1.0000 | 1589.6 samples/s | 24.8 steps/s
[Step=2400 Epoch=22.8] | Loss=0.00288 | Reg=0.00252 | L2-Norm=15.867 | L2-Norm(final)=2.200 | acc=1.0000 | 3717.8 samples/s | 58.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step2400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch=22.9] | Loss=0.08806 | Reg=0.00252 | L2-Norm=15.882 | L2-Norm(final)=2.215 | acc=0.9375 | 3350.0 samples/s | 52.3 steps/s
[Step=2450 Epoch=23.4] | Loss=0.03395 | Reg=0.00260 | L2-Norm=16.122 | L2-Norm(final)=2.204 | acc=0.9688 | 4166.4 samples/s | 65.1 steps/s
[Step=2500 Epoch=23.9] | Loss=0.01996 | Reg=0.00264 | L2-Norm=16.262 | L2-Norm(final)=2.195 | acc=1.0000 | 5048.1 samples/s | 78.9 steps/s
[Step=2550 Epoch=24.4] | Loss=0.01342 | Reg=0.00266 | L2-Norm=16.311 | L2-Norm(final)=2.197 | acc=1.0000 | 1494.8 samples/s | 23.4 steps/s
[Step=2600 Epoch=24.8] | Loss=0.01014 | Reg=0.00266 | L2-Norm=16.317 | L2-Norm(final)=2.200 | acc=1.0000 | 4796.5 samples/s | 74.9 steps/s
[Step=2650 Epoch=25.3] | Loss=0.00820 | Reg=0.00266 | L2-Norm=16.306 | L2-Norm(final)=2.202 | acc=1.0000 | 1500.7 samples/s | 23.4 steps/s
[Step=2700 Epoch=25.8] | Loss=0.00685 | Reg=0.00265 | L2-Norm=16.287 | L2-Norm(final)=2.205 | acc=1.0000 | 4645.2 samples/s | 72.6 steps/s
[Step=2750 Epoch=26.3] | Loss=0.00587 | Reg=0.00264 | L2-Norm=16.262 | L2-Norm(final)=2.207 | acc=1.0000 | 1515.1 samples/s | 23.7 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00514 | Reg=0.00264 | L2-Norm=16.233 | L2-Norm(final)=2.208 | acc=1.0000 | 4412.9 samples/s | 69.0 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00457 | Reg=0.00263 | L2-Norm=16.201 | L2-Norm(final)=2.209 | acc=1.0000 | 1543.4 samples/s | 24.1 steps/s
[Step=2900 Epoch=27.7] | Loss=0.00411 | Reg=0.00261 | L2-Norm=16.169 | L2-Norm(final)=2.210 | acc=1.0000 | 4238.4 samples/s | 66.2 steps/s
[Step=2950 Epoch=28.2] | Loss=0.00374 | Reg=0.00260 | L2-Norm=16.135 | L2-Norm(final)=2.211 | acc=1.0000 | 1572.8 samples/s | 24.6 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00343 | Reg=0.00259 | L2-Norm=16.100 | L2-Norm(final)=2.212 | acc=1.0000 | 4167.9 samples/s | 65.1 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00316 | Reg=0.00258 | L2-Norm=16.065 | L2-Norm(final)=2.213 | acc=1.0000 | 1554.7 samples/s | 24.3 steps/s
[Step=3100 Epoch=29.6] | Loss=0.00294 | Reg=0.00257 | L2-Norm=16.030 | L2-Norm(final)=2.214 | acc=1.0000 | 3737.8 samples/s | 58.4 steps/s
[Step=3150 Epoch=30.1] | Loss=0.00274 | Reg=0.00256 | L2-Norm=15.994 | L2-Norm(final)=2.215 | acc=1.0000 | 1579.7 samples/s | 24.7 steps/s
[Step=3200 Epoch=30.6] | Loss=0.00257 | Reg=0.00255 | L2-Norm=15.958 | L2-Norm(final)=2.216 | acc=1.0000 | 4109.3 samples/s | 64.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step3200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 7.5] | Loss=0.09840 | Reg=0.00252 | L2-Norm=15.882 | L2-Norm(final)=2.215 | acc=0.9375 | 3784.7 samples/s | 59.1 steps/s
[Step= 850 Epoch= 8.0] | Loss=0.03930 | Reg=0.00259 | L2-Norm=16.098 | L2-Norm(final)=2.201 | acc=0.9844 | 3903.0 samples/s | 61.0 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.02196 | Reg=0.00263 | L2-Norm=16.205 | L2-Norm(final)=2.197 | acc=1.0000 | 4850.5 samples/s | 75.8 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01475 | Reg=0.00263 | L2-Norm=16.227 | L2-Norm(final)=2.200 | acc=1.0000 | 1507.0 samples/s | 23.5 steps/s
[Step=1000 Epoch= 9.4] | Loss=0.01110 | Reg=0.00263 | L2-Norm=16.220 | L2-Norm(final)=2.203 | acc=1.0000 | 4615.7 samples/s | 72.1 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.00890 | Reg=0.00262 | L2-Norm=16.201 | L2-Norm(final)=2.206 | acc=1.0000 | 1543.4 samples/s | 24.1 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00742 | Reg=0.00262 | L2-Norm=16.176 | L2-Norm(final)=2.208 | acc=1.0000 | 4518.8 samples/s | 70.6 steps/s
[Step=1150 Epoch=10.8] | Loss=0.00637 | Reg=0.00261 | L2-Norm=16.147 | L2-Norm(final)=2.210 | acc=1.0000 | 1553.0 samples/s | 24.3 steps/s
[Step=1200 Epoch=11.3] | Loss=0.00558 | Reg=0.00260 | L2-Norm=16.116 | L2-Norm(final)=2.212 | acc=1.0000 | 4233.3 samples/s | 66.1 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00496 | Reg=0.00259 | L2-Norm=16.084 | L2-Norm(final)=2.213 | acc=1.0000 | 1561.9 samples/s | 24.4 steps/s
[Step=1300 Epoch=12.2] | Loss=0.00447 | Reg=0.00258 | L2-Norm=16.051 | L2-Norm(final)=2.215 | acc=1.0000 | 4079.3 samples/s | 63.7 steps/s
[Step=1350 Epoch=12.7] | Loss=0.00406 | Reg=0.00257 | L2-Norm=16.017 | L2-Norm(final)=2.216 | acc=1.0000 | 1665.6 samples/s | 26.0 steps/s
[Step=1400 Epoch=13.2] | Loss=0.00372 | Reg=0.00256 | L2-Norm=15.983 | L2-Norm(final)=2.217 | acc=1.0000 | 4127.9 samples/s | 64.5 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00344 | Reg=0.00254 | L2-Norm=15.949 | L2-Norm(final)=2.218 | acc=1.0000 | 1598.0 samples/s | 25.0 steps/s
[Step=1500 Epoch=14.1] | Loss=0.00319 | Reg=0.00253 | L2-Norm=15.914 | L2-Norm(final)=2.219 | acc=1.0000 | 4106.6 samples/s | 64.2 steps/s
[Step=1550 Epoch=14.6] | Loss=0.00298 | Reg=0.00252 | L2-Norm=15.879 | L2-Norm(final)=2.221 | acc=1.0000 | 1629.2 samples/s | 25.5 steps/s
[Step=1600 Epoch=15.1] | Loss=0.00280 | Reg=0.00251 | L2-Norm=15.844 | L2-Norm(final)=2.221 | acc=1.0000 | 3976.8 samples/s | 62.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38579 | acc=0.6375 | tpr=0.4979 | fpr=0.0595 | 4411.0 samples/s | 17.2 steps/s
Avg test loss: 0.38720, Avg test acc: 0.63771, Avg tpr: 0.49910, Avg fpr: 0.05743, total FA: 448

Testing server on iccad2012
[Step=  50] | Loss=0.21127 | acc=0.8667 | tpr=0.9690 | fpr=0.1351 | 4358.6 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.21437 | acc=0.8648 | tpr=0.9808 | fpr=0.1373 | 8491.3 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.21769 | acc=0.8618 | tpr=0.9813 | fpr=0.1403 | 7607.7 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.21896 | acc=0.8623 | tpr=0.9803 | fpr=0.1398 | 8269.6 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.21848 | acc=0.8625 | tpr=0.9799 | fpr=0.1397 | 7672.6 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.21959 | acc=0.8619 | tpr=0.9775 | fpr=0.1402 | 7961.7 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.22003 | acc=0.8619 | tpr=0.9768 | fpr=0.1402 | 8687.4 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.22079 | acc=0.8620 | tpr=0.9765 | fpr=0.1401 | 7950.7 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.22223 | acc=0.8618 | tpr=0.9757 | fpr=0.1403 | 7581.0 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.22249 | acc=0.8612 | tpr=0.9762 | fpr=0.1409 | 8220.4 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.22239 | acc=0.8612 | tpr=0.9753 | fpr=0.1409 | 14590.5 samples/s | 57.0 steps/s
Avg test loss: 0.22221, Avg test acc: 0.86128, Avg tpr: 0.97544, Avg fpr: 0.14079, total FA: 19549

server round 5/50

clients selected: [2 3 4 5 8]

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.24957 | Reg=0.00242 | L2-Norm=15.570 | L2-Norm(final)=2.230 | acc=0.7812 | 3709.7 samples/s | 58.0 steps/s
[Step=2450 Epoch=11.9] | Loss=0.11221 | Reg=0.00246 | L2-Norm=15.683 | L2-Norm(final)=2.228 | acc=0.9531 | 4005.9 samples/s | 62.6 steps/s
[Step=2500 Epoch=12.2] | Loss=0.09617 | Reg=0.00248 | L2-Norm=15.739 | L2-Norm(final)=2.238 | acc=0.8906 | 4441.5 samples/s | 69.4 steps/s
[Step=2550 Epoch=12.4] | Loss=0.08735 | Reg=0.00249 | L2-Norm=15.776 | L2-Norm(final)=2.246 | acc=0.9531 | 4338.8 samples/s | 67.8 steps/s
[Step=2600 Epoch=12.7] | Loss=0.08202 | Reg=0.00250 | L2-Norm=15.810 | L2-Norm(final)=2.255 | acc=0.9844 | 5199.1 samples/s | 81.2 steps/s
[Step=2650 Epoch=12.9] | Loss=0.07415 | Reg=0.00251 | L2-Norm=15.843 | L2-Norm(final)=2.266 | acc=0.9688 | 1525.9 samples/s | 23.8 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06821 | Reg=0.00252 | L2-Norm=15.875 | L2-Norm(final)=2.277 | acc=1.0000 | 4554.3 samples/s | 71.2 steps/s
[Step=2750 Epoch=13.4] | Loss=0.06334 | Reg=0.00253 | L2-Norm=15.903 | L2-Norm(final)=2.288 | acc=1.0000 | 4399.1 samples/s | 68.7 steps/s
[Step=2800 Epoch=13.6] | Loss=0.06124 | Reg=0.00254 | L2-Norm=15.929 | L2-Norm(final)=2.297 | acc=0.9844 | 4811.4 samples/s | 75.2 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05796 | Reg=0.00255 | L2-Norm=15.952 | L2-Norm(final)=2.304 | acc=1.0000 | 1568.0 samples/s | 24.5 steps/s
[Step=2900 Epoch=14.1] | Loss=0.05513 | Reg=0.00255 | L2-Norm=15.976 | L2-Norm(final)=2.311 | acc=1.0000 | 4492.5 samples/s | 70.2 steps/s
[Step=2950 Epoch=14.4] | Loss=0.05308 | Reg=0.00256 | L2-Norm=15.997 | L2-Norm(final)=2.318 | acc=0.9688 | 4326.9 samples/s | 67.6 steps/s
[Step=3000 Epoch=14.6] | Loss=0.05138 | Reg=0.00257 | L2-Norm=16.017 | L2-Norm(final)=2.325 | acc=0.9844 | 4828.3 samples/s | 75.4 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04957 | Reg=0.00257 | L2-Norm=16.038 | L2-Norm(final)=2.330 | acc=0.9688 | 1580.2 samples/s | 24.7 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04781 | Reg=0.00258 | L2-Norm=16.057 | L2-Norm(final)=2.336 | acc=0.9688 | 4384.2 samples/s | 68.5 steps/s
[Step=3150 Epoch=15.3] | Loss=0.04637 | Reg=0.00258 | L2-Norm=16.075 | L2-Norm(final)=2.341 | acc=0.9531 | 4385.2 samples/s | 68.5 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04478 | Reg=0.00259 | L2-Norm=16.091 | L2-Norm(final)=2.346 | acc=1.0000 | 4524.8 samples/s | 70.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step3200.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.44062 | Reg=0.00242 | L2-Norm=15.570 | L2-Norm(final)=2.231 | acc=0.6250 | 4252.3 samples/s | 66.4 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.12691 | Reg=0.00242 | L2-Norm=15.542 | L2-Norm(final)=2.231 | acc=0.9375 | 3929.7 samples/s | 61.4 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.10820 | Reg=0.00242 | L2-Norm=15.555 | L2-Norm(final)=2.238 | acc=0.9219 | 4386.3 samples/s | 68.5 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.10200 | Reg=0.00243 | L2-Norm=15.577 | L2-Norm(final)=2.240 | acc=0.9062 | 4509.0 samples/s | 70.5 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.09379 | Reg=0.00243 | L2-Norm=15.601 | L2-Norm(final)=2.247 | acc=0.9375 | 5342.5 samples/s | 83.5 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.08417 | Reg=0.00244 | L2-Norm=15.629 | L2-Norm(final)=2.256 | acc=0.9688 | 1548.3 samples/s | 24.2 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.07731 | Reg=0.00245 | L2-Norm=15.657 | L2-Norm(final)=2.268 | acc=0.9688 | 4269.6 samples/s | 66.7 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.07296 | Reg=0.00246 | L2-Norm=15.686 | L2-Norm(final)=2.279 | acc=1.0000 | 4448.0 samples/s | 69.5 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.07038 | Reg=0.00247 | L2-Norm=15.714 | L2-Norm(final)=2.288 | acc=0.9375 | 5100.9 samples/s | 79.7 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.06650 | Reg=0.00248 | L2-Norm=15.741 | L2-Norm(final)=2.295 | acc=1.0000 | 1551.9 samples/s | 24.2 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.06321 | Reg=0.00249 | L2-Norm=15.767 | L2-Norm(final)=2.301 | acc=0.9531 | 4344.3 samples/s | 67.9 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.06069 | Reg=0.00249 | L2-Norm=15.792 | L2-Norm(final)=2.308 | acc=1.0000 | 4415.5 samples/s | 69.0 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.05859 | Reg=0.00250 | L2-Norm=15.814 | L2-Norm(final)=2.314 | acc=0.9844 | 4999.6 samples/s | 78.1 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.05597 | Reg=0.00251 | L2-Norm=15.835 | L2-Norm(final)=2.319 | acc=0.9688 | 1589.1 samples/s | 24.8 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.05356 | Reg=0.00251 | L2-Norm=15.855 | L2-Norm(final)=2.325 | acc=1.0000 | 4407.6 samples/s | 68.9 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.05227 | Reg=0.00252 | L2-Norm=15.875 | L2-Norm(final)=2.330 | acc=0.9844 | 4195.5 samples/s | 65.6 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.05123 | Reg=0.00253 | L2-Norm=15.895 | L2-Norm(final)=2.334 | acc=1.0000 | 4645.5 samples/s | 72.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step800.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch=11.8] | Loss=0.34947 | Reg=0.00242 | L2-Norm=15.570 | L2-Norm(final)=2.229 | acc=0.6562 | 3725.3 samples/s | 58.2 steps/s
[Step=2450 Epoch=12.0] | Loss=0.11971 | Reg=0.00247 | L2-Norm=15.726 | L2-Norm(final)=2.225 | acc=0.9375 | 4257.6 samples/s | 66.5 steps/s
[Step=2500 Epoch=12.3] | Loss=0.10453 | Reg=0.00250 | L2-Norm=15.800 | L2-Norm(final)=2.227 | acc=0.9219 | 4523.0 samples/s | 70.7 steps/s
[Step=2550 Epoch=12.5] | Loss=0.09316 | Reg=0.00251 | L2-Norm=15.848 | L2-Norm(final)=2.234 | acc=0.9688 | 4259.4 samples/s | 66.6 steps/s
[Step=2600 Epoch=12.7] | Loss=0.08579 | Reg=0.00252 | L2-Norm=15.886 | L2-Norm(final)=2.241 | acc=1.0000 | 5134.8 samples/s | 80.2 steps/s
[Step=2650 Epoch=13.0] | Loss=0.07764 | Reg=0.00253 | L2-Norm=15.919 | L2-Norm(final)=2.246 | acc=0.9688 | 1548.6 samples/s | 24.2 steps/s
[Step=2700 Epoch=13.2] | Loss=0.07054 | Reg=0.00254 | L2-Norm=15.949 | L2-Norm(final)=2.255 | acc=0.9375 | 4442.2 samples/s | 69.4 steps/s
[Step=2750 Epoch=13.5] | Loss=0.06688 | Reg=0.00255 | L2-Norm=15.975 | L2-Norm(final)=2.262 | acc=0.9219 | 4365.4 samples/s | 68.2 steps/s
[Step=2800 Epoch=13.7] | Loss=0.06424 | Reg=0.00256 | L2-Norm=16.000 | L2-Norm(final)=2.267 | acc=0.9688 | 4830.0 samples/s | 75.5 steps/s
[Step=2850 Epoch=14.0] | Loss=0.06033 | Reg=0.00257 | L2-Norm=16.025 | L2-Norm(final)=2.273 | acc=1.0000 | 1547.2 samples/s | 24.2 steps/s
[Step=2900 Epoch=14.2] | Loss=0.05718 | Reg=0.00258 | L2-Norm=16.048 | L2-Norm(final)=2.279 | acc=0.9844 | 4232.6 samples/s | 66.1 steps/s
[Step=2950 Epoch=14.5] | Loss=0.05495 | Reg=0.00258 | L2-Norm=16.069 | L2-Norm(final)=2.284 | acc=1.0000 | 4320.5 samples/s | 67.5 steps/s
[Step=3000 Epoch=14.7] | Loss=0.05322 | Reg=0.00259 | L2-Norm=16.089 | L2-Norm(final)=2.289 | acc=0.9688 | 4815.5 samples/s | 75.2 steps/s
[Step=3050 Epoch=15.0] | Loss=0.05083 | Reg=0.00259 | L2-Norm=16.107 | L2-Norm(final)=2.294 | acc=1.0000 | 1578.8 samples/s | 24.7 steps/s
[Step=3100 Epoch=15.2] | Loss=0.04862 | Reg=0.00260 | L2-Norm=16.126 | L2-Norm(final)=2.299 | acc=1.0000 | 4257.7 samples/s | 66.5 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04669 | Reg=0.00261 | L2-Norm=16.142 | L2-Norm(final)=2.305 | acc=0.9844 | 4439.0 samples/s | 69.4 steps/s
[Step=3200 Epoch=15.7] | Loss=0.04507 | Reg=0.00261 | L2-Norm=16.157 | L2-Norm(final)=2.310 | acc=0.9844 | 4798.8 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step3200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.07311 | Reg=0.00242 | L2-Norm=15.570 | L2-Norm(final)=2.232 | acc=0.9531 | 3508.8 samples/s | 54.8 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.02462 | Reg=0.00248 | L2-Norm=15.741 | L2-Norm(final)=2.231 | acc=1.0000 | 3891.3 samples/s | 60.8 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.01952 | Reg=0.00251 | L2-Norm=15.854 | L2-Norm(final)=2.224 | acc=0.9844 | 5126.0 samples/s | 80.1 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01423 | Reg=0.00253 | L2-Norm=15.904 | L2-Norm(final)=2.224 | acc=1.0000 | 1611.8 samples/s | 25.2 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01088 | Reg=0.00253 | L2-Norm=15.920 | L2-Norm(final)=2.228 | acc=1.0000 | 4895.9 samples/s | 76.5 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.00872 | Reg=0.00253 | L2-Norm=15.918 | L2-Norm(final)=2.232 | acc=1.0000 | 1523.0 samples/s | 23.8 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00727 | Reg=0.00253 | L2-Norm=15.904 | L2-Norm(final)=2.235 | acc=1.0000 | 4418.5 samples/s | 69.0 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00624 | Reg=0.00252 | L2-Norm=15.882 | L2-Norm(final)=2.237 | acc=1.0000 | 1546.8 samples/s | 24.2 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00546 | Reg=0.00251 | L2-Norm=15.857 | L2-Norm(final)=2.239 | acc=1.0000 | 4424.1 samples/s | 69.1 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00485 | Reg=0.00251 | L2-Norm=15.828 | L2-Norm(final)=2.241 | acc=1.0000 | 1529.6 samples/s | 23.9 steps/s
[Step=1300 Epoch=12.3] | Loss=0.00437 | Reg=0.00250 | L2-Norm=15.798 | L2-Norm(final)=2.242 | acc=1.0000 | 4297.8 samples/s | 67.2 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00397 | Reg=0.00249 | L2-Norm=15.767 | L2-Norm(final)=2.244 | acc=1.0000 | 1680.6 samples/s | 26.3 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00364 | Reg=0.00248 | L2-Norm=15.734 | L2-Norm(final)=2.245 | acc=1.0000 | 4236.8 samples/s | 66.2 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00336 | Reg=0.00247 | L2-Norm=15.700 | L2-Norm(final)=2.246 | acc=1.0000 | 1569.2 samples/s | 24.5 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00312 | Reg=0.00245 | L2-Norm=15.666 | L2-Norm(final)=2.247 | acc=1.0000 | 3775.8 samples/s | 59.0 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00292 | Reg=0.00244 | L2-Norm=15.631 | L2-Norm(final)=2.248 | acc=1.0000 | 1579.5 samples/s | 24.7 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00273 | Reg=0.00243 | L2-Norm=15.596 | L2-Norm(final)=2.249 | acc=1.0000 | 3748.2 samples/s | 58.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step1600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch=15.1] | Loss=0.08834 | Reg=0.00242 | L2-Norm=15.570 | L2-Norm(final)=2.231 | acc=0.9219 | 3688.0 samples/s | 57.6 steps/s
[Step=1650 Epoch=15.5] | Loss=0.04090 | Reg=0.00248 | L2-Norm=15.734 | L2-Norm(final)=2.228 | acc=0.9531 | 4102.4 samples/s | 64.1 steps/s
[Step=1700 Epoch=16.0] | Loss=0.02590 | Reg=0.00253 | L2-Norm=15.891 | L2-Norm(final)=2.210 | acc=0.9844 | 4958.9 samples/s | 77.5 steps/s
[Step=1750 Epoch=16.5] | Loss=0.01765 | Reg=0.00254 | L2-Norm=15.947 | L2-Norm(final)=2.211 | acc=1.0000 | 1516.7 samples/s | 23.7 steps/s
[Step=1800 Epoch=17.0] | Loss=0.01337 | Reg=0.00255 | L2-Norm=15.959 | L2-Norm(final)=2.215 | acc=1.0000 | 4800.6 samples/s | 75.0 steps/s
[Step=1850 Epoch=17.4] | Loss=0.01075 | Reg=0.00254 | L2-Norm=15.951 | L2-Norm(final)=2.220 | acc=1.0000 | 1536.4 samples/s | 24.0 steps/s
[Step=1900 Epoch=17.9] | Loss=0.00897 | Reg=0.00254 | L2-Norm=15.932 | L2-Norm(final)=2.223 | acc=1.0000 | 4488.0 samples/s | 70.1 steps/s
[Step=1950 Epoch=18.4] | Loss=0.00769 | Reg=0.00253 | L2-Norm=15.908 | L2-Norm(final)=2.226 | acc=1.0000 | 1533.4 samples/s | 24.0 steps/s
[Step=2000 Epoch=18.8] | Loss=0.00673 | Reg=0.00252 | L2-Norm=15.879 | L2-Norm(final)=2.229 | acc=1.0000 | 4244.9 samples/s | 66.3 steps/s
[Step=2050 Epoch=19.3] | Loss=0.00599 | Reg=0.00251 | L2-Norm=15.848 | L2-Norm(final)=2.231 | acc=1.0000 | 1688.2 samples/s | 26.4 steps/s
[Step=2100 Epoch=19.8] | Loss=0.00539 | Reg=0.00250 | L2-Norm=15.815 | L2-Norm(final)=2.233 | acc=1.0000 | 4039.7 samples/s | 63.1 steps/s
[Step=2150 Epoch=20.3] | Loss=0.00490 | Reg=0.00249 | L2-Norm=15.782 | L2-Norm(final)=2.235 | acc=1.0000 | 1597.8 samples/s | 25.0 steps/s
[Step=2200 Epoch=20.7] | Loss=0.00450 | Reg=0.00248 | L2-Norm=15.747 | L2-Norm(final)=2.237 | acc=1.0000 | 4096.2 samples/s | 64.0 steps/s
[Step=2250 Epoch=21.2] | Loss=0.00415 | Reg=0.00247 | L2-Norm=15.712 | L2-Norm(final)=2.238 | acc=1.0000 | 1604.3 samples/s | 25.1 steps/s
[Step=2300 Epoch=21.7] | Loss=0.00386 | Reg=0.00246 | L2-Norm=15.677 | L2-Norm(final)=2.239 | acc=1.0000 | 4045.7 samples/s | 63.2 steps/s
[Step=2350 Epoch=22.1] | Loss=0.00360 | Reg=0.00245 | L2-Norm=15.641 | L2-Norm(final)=2.241 | acc=1.0000 | 1663.2 samples/s | 26.0 steps/s
[Step=2400 Epoch=22.6] | Loss=0.00338 | Reg=0.00244 | L2-Norm=15.605 | L2-Norm(final)=2.242 | acc=1.0000 | 3577.6 samples/s | 55.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35638 | acc=0.6929 | tpr=0.5763 | fpr=0.0540 | 4334.5 samples/s | 16.9 steps/s
Avg test loss: 0.35718, Avg test acc: 0.69264, Avg tpr: 0.57714, Avg fpr: 0.05333, total FA: 416

Testing server on iccad2012
[Step=  50] | Loss=0.26826 | acc=0.8530 | tpr=0.9602 | fpr=0.1489 | 4313.6 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.27229 | acc=0.8521 | tpr=0.9701 | fpr=0.1501 | 8387.4 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.27722 | acc=0.8492 | tpr=0.9712 | fpr=0.1531 | 8154.5 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.27921 | acc=0.8487 | tpr=0.9683 | fpr=0.1535 | 8706.9 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.27856 | acc=0.8481 | tpr=0.9694 | fpr=0.1541 | 8354.0 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.28016 | acc=0.8473 | tpr=0.9658 | fpr=0.1549 | 8566.2 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.27977 | acc=0.8477 | tpr=0.9662 | fpr=0.1544 | 8249.7 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.28049 | acc=0.8478 | tpr=0.9661 | fpr=0.1544 | 8936.7 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.28285 | acc=0.8474 | tpr=0.9664 | fpr=0.1547 | 7775.7 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.28296 | acc=0.8469 | tpr=0.9678 | fpr=0.1553 | 8010.4 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.28291 | acc=0.8468 | tpr=0.9670 | fpr=0.1554 | 15176.0 samples/s | 59.3 steps/s
Avg test loss: 0.28269, Avg test acc: 0.84685, Avg tpr: 0.96672, Avg fpr: 0.15533, total FA: 21567

server round 6/50

clients selected: [2 3 4 6 8]

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.29466 | Reg=0.00233 | L2-Norm=15.272 | L2-Norm(final)=2.290 | acc=0.7500 | 3735.5 samples/s | 58.4 steps/s
[Step=3250 Epoch=15.8] | Loss=0.09258 | Reg=0.00237 | L2-Norm=15.381 | L2-Norm(final)=2.285 | acc=0.9688 | 4113.2 samples/s | 64.3 steps/s
[Step=3300 Epoch=16.1] | Loss=0.08267 | Reg=0.00238 | L2-Norm=15.436 | L2-Norm(final)=2.292 | acc=0.8750 | 4407.0 samples/s | 68.9 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07573 | Reg=0.00240 | L2-Norm=15.479 | L2-Norm(final)=2.301 | acc=0.9219 | 4396.2 samples/s | 68.7 steps/s
[Step=3400 Epoch=16.6] | Loss=0.07488 | Reg=0.00241 | L2-Norm=15.514 | L2-Norm(final)=2.304 | acc=0.9844 | 5014.9 samples/s | 78.4 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06784 | Reg=0.00242 | L2-Norm=15.557 | L2-Norm(final)=2.312 | acc=1.0000 | 1511.7 samples/s | 23.6 steps/s
[Step=3500 Epoch=17.1] | Loss=0.06241 | Reg=0.00243 | L2-Norm=15.597 | L2-Norm(final)=2.322 | acc=0.9844 | 3940.6 samples/s | 61.6 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05946 | Reg=0.00244 | L2-Norm=15.632 | L2-Norm(final)=2.330 | acc=0.9531 | 3876.3 samples/s | 60.6 steps/s
[Step=3600 Epoch=17.5] | Loss=0.05674 | Reg=0.00245 | L2-Norm=15.666 | L2-Norm(final)=2.337 | acc=1.0000 | 4675.6 samples/s | 73.1 steps/s
[Step=3650 Epoch=17.8] | Loss=0.05348 | Reg=0.00246 | L2-Norm=15.698 | L2-Norm(final)=2.344 | acc=1.0000 | 1577.7 samples/s | 24.7 steps/s
[Step=3700 Epoch=18.0] | Loss=0.05068 | Reg=0.00247 | L2-Norm=15.729 | L2-Norm(final)=2.352 | acc=0.9844 | 4479.1 samples/s | 70.0 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04894 | Reg=0.00248 | L2-Norm=15.755 | L2-Norm(final)=2.357 | acc=0.9844 | 4432.7 samples/s | 69.3 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04756 | Reg=0.00249 | L2-Norm=15.779 | L2-Norm(final)=2.362 | acc=0.9844 | 4672.3 samples/s | 73.0 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04617 | Reg=0.00250 | L2-Norm=15.803 | L2-Norm(final)=2.367 | acc=1.0000 | 1535.2 samples/s | 24.0 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04440 | Reg=0.00251 | L2-Norm=15.827 | L2-Norm(final)=2.372 | acc=1.0000 | 3966.4 samples/s | 62.0 steps/s
[Step=3950 Epoch=19.2] | Loss=0.04263 | Reg=0.00251 | L2-Norm=15.849 | L2-Norm(final)=2.376 | acc=0.9844 | 3906.7 samples/s | 61.0 steps/s
[Step=4000 Epoch=19.5] | Loss=0.04128 | Reg=0.00252 | L2-Norm=15.869 | L2-Norm(final)=2.381 | acc=0.9844 | 4134.7 samples/s | 64.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step4000.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.24017 | Reg=0.00233 | L2-Norm=15.272 | L2-Norm(final)=2.291 | acc=0.7812 | 3682.3 samples/s | 57.5 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.11011 | Reg=0.00236 | L2-Norm=15.369 | L2-Norm(final)=2.273 | acc=0.9062 | 4031.2 samples/s | 63.0 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.09818 | Reg=0.00238 | L2-Norm=15.417 | L2-Norm(final)=2.273 | acc=0.9375 | 4534.9 samples/s | 70.9 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.08759 | Reg=0.00238 | L2-Norm=15.442 | L2-Norm(final)=2.271 | acc=0.9219 | 4487.1 samples/s | 70.1 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.08152 | Reg=0.00239 | L2-Norm=15.470 | L2-Norm(final)=2.275 | acc=0.9688 | 5193.5 samples/s | 81.1 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.07376 | Reg=0.00240 | L2-Norm=15.503 | L2-Norm(final)=2.282 | acc=0.9375 | 1545.5 samples/s | 24.1 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.06821 | Reg=0.00241 | L2-Norm=15.536 | L2-Norm(final)=2.291 | acc=0.9688 | 4378.9 samples/s | 68.4 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.06395 | Reg=0.00242 | L2-Norm=15.568 | L2-Norm(final)=2.300 | acc=1.0000 | 4390.7 samples/s | 68.6 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.06061 | Reg=0.00243 | L2-Norm=15.596 | L2-Norm(final)=2.309 | acc=1.0000 | 4990.2 samples/s | 78.0 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.05871 | Reg=0.00244 | L2-Norm=15.627 | L2-Norm(final)=2.317 | acc=0.9688 | 1553.1 samples/s | 24.3 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.05565 | Reg=0.00245 | L2-Norm=15.661 | L2-Norm(final)=2.324 | acc=0.9844 | 4238.8 samples/s | 66.2 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.05322 | Reg=0.00246 | L2-Norm=15.693 | L2-Norm(final)=2.332 | acc=1.0000 | 4321.6 samples/s | 67.5 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.05182 | Reg=0.00247 | L2-Norm=15.721 | L2-Norm(final)=2.337 | acc=1.0000 | 4823.6 samples/s | 75.4 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.05053 | Reg=0.00248 | L2-Norm=15.750 | L2-Norm(final)=2.343 | acc=0.9844 | 1586.5 samples/s | 24.8 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.04848 | Reg=0.00249 | L2-Norm=15.779 | L2-Norm(final)=2.348 | acc=0.9844 | 4366.6 samples/s | 68.2 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.04673 | Reg=0.00250 | L2-Norm=15.806 | L2-Norm(final)=2.354 | acc=0.9844 | 4262.2 samples/s | 66.6 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.04518 | Reg=0.00251 | L2-Norm=15.832 | L2-Norm(final)=2.361 | acc=1.0000 | 4608.7 samples/s | 72.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step1600.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch=15.7] | Loss=0.40179 | Reg=0.00233 | L2-Norm=15.272 | L2-Norm(final)=2.289 | acc=0.6250 | 3290.8 samples/s | 51.4 steps/s
[Step=3250 Epoch=15.9] | Loss=0.10011 | Reg=0.00237 | L2-Norm=15.398 | L2-Norm(final)=2.280 | acc=0.9844 | 4471.4 samples/s | 69.9 steps/s
[Step=3300 Epoch=16.2] | Loss=0.08872 | Reg=0.00239 | L2-Norm=15.462 | L2-Norm(final)=2.287 | acc=0.9219 | 4318.9 samples/s | 67.5 steps/s
[Step=3350 Epoch=16.4] | Loss=0.07984 | Reg=0.00240 | L2-Norm=15.502 | L2-Norm(final)=2.289 | acc=0.9531 | 4458.4 samples/s | 69.7 steps/s
[Step=3400 Epoch=16.7] | Loss=0.07898 | Reg=0.00241 | L2-Norm=15.534 | L2-Norm(final)=2.288 | acc=0.9219 | 5335.9 samples/s | 83.4 steps/s
[Step=3450 Epoch=16.9] | Loss=0.07003 | Reg=0.00242 | L2-Norm=15.570 | L2-Norm(final)=2.292 | acc=0.9844 | 1568.5 samples/s | 24.5 steps/s
[Step=3500 Epoch=17.2] | Loss=0.06430 | Reg=0.00244 | L2-Norm=15.606 | L2-Norm(final)=2.299 | acc=0.9844 | 4432.4 samples/s | 69.3 steps/s
[Step=3550 Epoch=17.4] | Loss=0.06064 | Reg=0.00245 | L2-Norm=15.640 | L2-Norm(final)=2.305 | acc=0.9844 | 4398.4 samples/s | 68.7 steps/s
[Step=3600 Epoch=17.7] | Loss=0.05819 | Reg=0.00246 | L2-Norm=15.670 | L2-Norm(final)=2.311 | acc=0.9844 | 5102.1 samples/s | 79.7 steps/s
[Step=3650 Epoch=17.9] | Loss=0.05432 | Reg=0.00246 | L2-Norm=15.698 | L2-Norm(final)=2.317 | acc=0.9844 | 1507.0 samples/s | 23.5 steps/s
[Step=3700 Epoch=18.1] | Loss=0.05156 | Reg=0.00247 | L2-Norm=15.723 | L2-Norm(final)=2.322 | acc=0.9688 | 3988.5 samples/s | 62.3 steps/s
[Step=3750 Epoch=18.4] | Loss=0.04917 | Reg=0.00248 | L2-Norm=15.747 | L2-Norm(final)=2.328 | acc=0.9844 | 3927.5 samples/s | 61.4 steps/s
[Step=3800 Epoch=18.6] | Loss=0.04772 | Reg=0.00249 | L2-Norm=15.768 | L2-Norm(final)=2.333 | acc=1.0000 | 4552.7 samples/s | 71.1 steps/s
[Step=3850 Epoch=18.9] | Loss=0.04577 | Reg=0.00249 | L2-Norm=15.789 | L2-Norm(final)=2.337 | acc=1.0000 | 1566.3 samples/s | 24.5 steps/s
[Step=3900 Epoch=19.1] | Loss=0.04383 | Reg=0.00250 | L2-Norm=15.810 | L2-Norm(final)=2.342 | acc=0.9844 | 4485.3 samples/s | 70.1 steps/s
[Step=3950 Epoch=19.4] | Loss=0.04274 | Reg=0.00251 | L2-Norm=15.828 | L2-Norm(final)=2.345 | acc=0.9844 | 4298.0 samples/s | 67.2 steps/s
[Step=4000 Epoch=19.6] | Loss=0.04160 | Reg=0.00251 | L2-Norm=15.846 | L2-Norm(final)=2.348 | acc=1.0000 | 4713.0 samples/s | 73.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.12104 | Reg=0.00233 | L2-Norm=15.272 | L2-Norm(final)=2.289 | acc=0.9219 | 3410.8 samples/s | 53.3 steps/s
[Step=2450 Epoch=23.3] | Loss=0.01235 | Reg=0.00239 | L2-Norm=15.459 | L2-Norm(final)=2.284 | acc=1.0000 | 3872.3 samples/s | 60.5 steps/s
[Step=2500 Epoch=23.8] | Loss=0.01085 | Reg=0.00241 | L2-Norm=15.535 | L2-Norm(final)=2.277 | acc=1.0000 | 5303.1 samples/s | 82.9 steps/s
[Step=2550 Epoch=24.3] | Loss=0.00747 | Reg=0.00243 | L2-Norm=15.574 | L2-Norm(final)=2.274 | acc=1.0000 | 1528.8 samples/s | 23.9 steps/s
[Step=2600 Epoch=24.7] | Loss=0.00563 | Reg=0.00243 | L2-Norm=15.582 | L2-Norm(final)=2.274 | acc=1.0000 | 4929.7 samples/s | 77.0 steps/s
[Step=2650 Epoch=25.2] | Loss=0.00470 | Reg=0.00243 | L2-Norm=15.576 | L2-Norm(final)=2.276 | acc=1.0000 | 1481.7 samples/s | 23.2 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00393 | Reg=0.00242 | L2-Norm=15.564 | L2-Norm(final)=2.277 | acc=1.0000 | 4173.5 samples/s | 65.2 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00337 | Reg=0.00242 | L2-Norm=15.545 | L2-Norm(final)=2.279 | acc=1.0000 | 1532.9 samples/s | 24.0 steps/s
[Step=2800 Epoch=26.6] | Loss=0.00295 | Reg=0.00241 | L2-Norm=15.523 | L2-Norm(final)=2.280 | acc=1.0000 | 4314.0 samples/s | 67.4 steps/s
[Step=2850 Epoch=27.1] | Loss=0.00262 | Reg=0.00240 | L2-Norm=15.498 | L2-Norm(final)=2.281 | acc=1.0000 | 1566.5 samples/s | 24.5 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00236 | Reg=0.00239 | L2-Norm=15.472 | L2-Norm(final)=2.282 | acc=1.0000 | 4348.5 samples/s | 67.9 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00215 | Reg=0.00239 | L2-Norm=15.444 | L2-Norm(final)=2.283 | acc=1.0000 | 1556.2 samples/s | 24.3 steps/s
[Step=3000 Epoch=28.5] | Loss=0.00197 | Reg=0.00238 | L2-Norm=15.415 | L2-Norm(final)=2.284 | acc=1.0000 | 3725.6 samples/s | 58.2 steps/s
[Step=3050 Epoch=29.0] | Loss=0.00182 | Reg=0.00237 | L2-Norm=15.386 | L2-Norm(final)=2.285 | acc=1.0000 | 1591.9 samples/s | 24.9 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00169 | Reg=0.00236 | L2-Norm=15.356 | L2-Norm(final)=2.285 | acc=1.0000 | 4110.5 samples/s | 64.2 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00158 | Reg=0.00235 | L2-Norm=15.326 | L2-Norm(final)=2.286 | acc=1.0000 | 1620.2 samples/s | 25.3 steps/s
[Step=3200 Epoch=30.4] | Loss=0.00148 | Reg=0.00234 | L2-Norm=15.295 | L2-Norm(final)=2.287 | acc=1.0000 | 4051.4 samples/s | 63.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step3200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch=22.6] | Loss=0.13801 | Reg=0.00233 | L2-Norm=15.272 | L2-Norm(final)=2.290 | acc=0.9062 | 3644.1 samples/s | 56.9 steps/s
[Step=2450 Epoch=23.1] | Loss=0.02847 | Reg=0.00241 | L2-Norm=15.512 | L2-Norm(final)=2.263 | acc=1.0000 | 4136.9 samples/s | 64.6 steps/s
[Step=2500 Epoch=23.6] | Loss=0.01781 | Reg=0.00244 | L2-Norm=15.619 | L2-Norm(final)=2.262 | acc=1.0000 | 5043.9 samples/s | 78.8 steps/s
[Step=2550 Epoch=24.0] | Loss=0.01201 | Reg=0.00245 | L2-Norm=15.649 | L2-Norm(final)=2.266 | acc=1.0000 | 1524.1 samples/s | 23.8 steps/s
[Step=2600 Epoch=24.5] | Loss=0.00915 | Reg=0.00245 | L2-Norm=15.651 | L2-Norm(final)=2.272 | acc=1.0000 | 4744.0 samples/s | 74.1 steps/s
[Step=2650 Epoch=25.0] | Loss=0.00733 | Reg=0.00245 | L2-Norm=15.639 | L2-Norm(final)=2.277 | acc=1.0000 | 1520.2 samples/s | 23.8 steps/s
[Step=2700 Epoch=25.4] | Loss=0.00611 | Reg=0.00244 | L2-Norm=15.618 | L2-Norm(final)=2.281 | acc=1.0000 | 4428.8 samples/s | 69.2 steps/s
[Step=2750 Epoch=25.9] | Loss=0.00524 | Reg=0.00243 | L2-Norm=15.591 | L2-Norm(final)=2.284 | acc=1.0000 | 1573.5 samples/s | 24.6 steps/s
[Step=2800 Epoch=26.4] | Loss=0.00459 | Reg=0.00242 | L2-Norm=15.560 | L2-Norm(final)=2.286 | acc=1.0000 | 4383.0 samples/s | 68.5 steps/s
[Step=2850 Epoch=26.9] | Loss=0.00408 | Reg=0.00241 | L2-Norm=15.528 | L2-Norm(final)=2.289 | acc=1.0000 | 1557.6 samples/s | 24.3 steps/s
[Step=2900 Epoch=27.3] | Loss=0.00367 | Reg=0.00240 | L2-Norm=15.494 | L2-Norm(final)=2.290 | acc=1.0000 | 3811.0 samples/s | 59.5 steps/s
[Step=2950 Epoch=27.8] | Loss=0.00334 | Reg=0.00239 | L2-Norm=15.459 | L2-Norm(final)=2.292 | acc=1.0000 | 1594.9 samples/s | 24.9 steps/s
[Step=3000 Epoch=28.3] | Loss=0.00306 | Reg=0.00238 | L2-Norm=15.423 | L2-Norm(final)=2.293 | acc=1.0000 | 4124.4 samples/s | 64.4 steps/s
[Step=3050 Epoch=28.7] | Loss=0.00283 | Reg=0.00237 | L2-Norm=15.387 | L2-Norm(final)=2.295 | acc=1.0000 | 1607.6 samples/s | 25.1 steps/s
[Step=3100 Epoch=29.2] | Loss=0.00263 | Reg=0.00236 | L2-Norm=15.350 | L2-Norm(final)=2.296 | acc=1.0000 | 4244.2 samples/s | 66.3 steps/s
[Step=3150 Epoch=29.7] | Loss=0.00245 | Reg=0.00235 | L2-Norm=15.314 | L2-Norm(final)=2.297 | acc=1.0000 | 1651.9 samples/s | 25.8 steps/s
[Step=3200 Epoch=30.2] | Loss=0.00230 | Reg=0.00233 | L2-Norm=15.277 | L2-Norm(final)=2.298 | acc=1.0000 | 4084.8 samples/s | 63.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37194 | acc=0.6878 | tpr=0.5607 | fpr=0.0362 | 4334.6 samples/s | 16.9 steps/s
Avg test loss: 0.37449, Avg test acc: 0.68864, Avg tpr: 0.56304, Avg fpr: 0.03512, total FA: 274

Testing server on iccad2012
[Step=  50] | Loss=0.25927 | acc=0.8615 | tpr=0.9646 | fpr=0.1404 | 4306.6 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.26313 | acc=0.8602 | tpr=0.9680 | fpr=0.1418 | 8958.5 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.26682 | acc=0.8580 | tpr=0.9712 | fpr=0.1441 | 8731.3 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.26898 | acc=0.8577 | tpr=0.9661 | fpr=0.1443 | 8746.1 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.26843 | acc=0.8570 | tpr=0.9668 | fpr=0.1450 | 8799.2 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.27035 | acc=0.8563 | tpr=0.9644 | fpr=0.1457 | 5982.5 samples/s | 23.4 steps/s
[Step= 350] | Loss=0.27048 | acc=0.8562 | tpr=0.9649 | fpr=0.1458 | 8501.6 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.27120 | acc=0.8566 | tpr=0.9644 | fpr=0.1454 | 8613.5 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.27350 | acc=0.8563 | tpr=0.9654 | fpr=0.1457 | 8829.5 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.27359 | acc=0.8557 | tpr=0.9661 | fpr=0.1463 | 7817.0 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.27343 | acc=0.8558 | tpr=0.9658 | fpr=0.1462 | 16510.6 samples/s | 64.5 steps/s
Avg test loss: 0.27324, Avg test acc: 0.85587, Avg tpr: 0.96513, Avg fpr: 0.14612, total FA: 20288

server round 7/50

clients selected: [0 3 4 5 8]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.33859 | Reg=0.00229 | L2-Norm=15.129 | L2-Norm(final)=2.314 | acc=0.7188 | 4173.7 samples/s | 65.2 steps/s
[Step=3250 Epoch=15.8] | Loss=0.09708 | Reg=0.00232 | L2-Norm=15.232 | L2-Norm(final)=2.306 | acc=0.9062 | 4166.1 samples/s | 65.1 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07925 | Reg=0.00234 | L2-Norm=15.288 | L2-Norm(final)=2.313 | acc=0.9844 | 4462.3 samples/s | 69.7 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07182 | Reg=0.00235 | L2-Norm=15.326 | L2-Norm(final)=2.319 | acc=0.9531 | 4475.1 samples/s | 69.9 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06762 | Reg=0.00236 | L2-Norm=15.354 | L2-Norm(final)=2.321 | acc=0.9688 | 5231.7 samples/s | 81.7 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05968 | Reg=0.00237 | L2-Norm=15.379 | L2-Norm(final)=2.325 | acc=1.0000 | 1574.3 samples/s | 24.6 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05455 | Reg=0.00237 | L2-Norm=15.404 | L2-Norm(final)=2.331 | acc=0.9844 | 4387.8 samples/s | 68.6 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05119 | Reg=0.00238 | L2-Norm=15.425 | L2-Norm(final)=2.336 | acc=1.0000 | 4539.5 samples/s | 70.9 steps/s
[Step=3600 Epoch=17.6] | Loss=0.04971 | Reg=0.00239 | L2-Norm=15.444 | L2-Norm(final)=2.341 | acc=0.9375 | 5005.5 samples/s | 78.2 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04662 | Reg=0.00239 | L2-Norm=15.462 | L2-Norm(final)=2.344 | acc=1.0000 | 1590.6 samples/s | 24.9 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04402 | Reg=0.00240 | L2-Norm=15.480 | L2-Norm(final)=2.349 | acc=0.9844 | 4386.6 samples/s | 68.5 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04240 | Reg=0.00240 | L2-Norm=15.496 | L2-Norm(final)=2.354 | acc=0.9531 | 3971.8 samples/s | 62.1 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04065 | Reg=0.00241 | L2-Norm=15.514 | L2-Norm(final)=2.358 | acc=1.0000 | 4380.6 samples/s | 68.4 steps/s
[Step=3850 Epoch=18.8] | Loss=0.03907 | Reg=0.00241 | L2-Norm=15.531 | L2-Norm(final)=2.363 | acc=0.9688 | 1583.8 samples/s | 24.7 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03798 | Reg=0.00242 | L2-Norm=15.548 | L2-Norm(final)=2.368 | acc=0.9844 | 4437.4 samples/s | 69.3 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03678 | Reg=0.00242 | L2-Norm=15.563 | L2-Norm(final)=2.372 | acc=1.0000 | 4457.7 samples/s | 69.7 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03612 | Reg=0.00243 | L2-Norm=15.578 | L2-Norm(final)=2.376 | acc=0.9844 | 4689.9 samples/s | 73.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4000.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.24889 | Reg=0.00229 | L2-Norm=15.129 | L2-Norm(final)=2.314 | acc=0.8125 | 3903.1 samples/s | 61.0 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.09914 | Reg=0.00232 | L2-Norm=15.217 | L2-Norm(final)=2.298 | acc=0.9531 | 4405.2 samples/s | 68.8 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08719 | Reg=0.00233 | L2-Norm=15.269 | L2-Norm(final)=2.307 | acc=0.9375 | 4327.9 samples/s | 67.6 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.07996 | Reg=0.00234 | L2-Norm=15.308 | L2-Norm(final)=2.316 | acc=1.0000 | 4346.6 samples/s | 67.9 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.07491 | Reg=0.00236 | L2-Norm=15.348 | L2-Norm(final)=2.319 | acc=0.9844 | 5210.5 samples/s | 81.4 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.06762 | Reg=0.00237 | L2-Norm=15.387 | L2-Norm(final)=2.327 | acc=0.9844 | 1545.2 samples/s | 24.1 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.06176 | Reg=0.00238 | L2-Norm=15.420 | L2-Norm(final)=2.335 | acc=0.9688 | 4488.0 samples/s | 70.1 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.05724 | Reg=0.00239 | L2-Norm=15.451 | L2-Norm(final)=2.344 | acc=1.0000 | 4502.3 samples/s | 70.3 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.05510 | Reg=0.00240 | L2-Norm=15.479 | L2-Norm(final)=2.351 | acc=0.9375 | 5020.4 samples/s | 78.4 steps/s
[Step=2050 Epoch=10.0] | Loss=0.05330 | Reg=0.00240 | L2-Norm=15.506 | L2-Norm(final)=2.356 | acc=0.9375 | 1582.1 samples/s | 24.7 steps/s
[Step=2100 Epoch=10.2] | Loss=0.05083 | Reg=0.00241 | L2-Norm=15.534 | L2-Norm(final)=2.361 | acc=1.0000 | 4458.5 samples/s | 69.7 steps/s
[Step=2150 Epoch=10.5] | Loss=0.04786 | Reg=0.00242 | L2-Norm=15.559 | L2-Norm(final)=2.367 | acc=1.0000 | 4338.4 samples/s | 67.8 steps/s
[Step=2200 Epoch=10.7] | Loss=0.04629 | Reg=0.00243 | L2-Norm=15.584 | L2-Norm(final)=2.373 | acc=0.9688 | 4929.5 samples/s | 77.0 steps/s
[Step=2250 Epoch=11.0] | Loss=0.04812 | Reg=0.00244 | L2-Norm=15.610 | L2-Norm(final)=2.375 | acc=0.9375 | 1585.7 samples/s | 24.8 steps/s
[Step=2300 Epoch=11.2] | Loss=0.04759 | Reg=0.00245 | L2-Norm=15.643 | L2-Norm(final)=2.377 | acc=0.9844 | 4430.8 samples/s | 69.2 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04658 | Reg=0.00246 | L2-Norm=15.674 | L2-Norm(final)=2.378 | acc=0.9844 | 4378.1 samples/s | 68.4 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04565 | Reg=0.00247 | L2-Norm=15.703 | L2-Norm(final)=2.380 | acc=0.9844 | 4792.4 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step2400.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch=19.6] | Loss=0.29433 | Reg=0.00229 | L2-Norm=15.129 | L2-Norm(final)=2.313 | acc=0.7812 | 3912.8 samples/s | 61.1 steps/s
[Step=4050 Epoch=19.9] | Loss=0.09760 | Reg=0.00233 | L2-Norm=15.252 | L2-Norm(final)=2.304 | acc=0.9219 | 4426.5 samples/s | 69.2 steps/s
[Step=4100 Epoch=20.1] | Loss=0.08587 | Reg=0.00235 | L2-Norm=15.320 | L2-Norm(final)=2.305 | acc=0.9531 | 4397.8 samples/s | 68.7 steps/s
[Step=4150 Epoch=20.4] | Loss=0.07749 | Reg=0.00236 | L2-Norm=15.367 | L2-Norm(final)=2.307 | acc=0.9219 | 4483.9 samples/s | 70.1 steps/s
[Step=4200 Epoch=20.6] | Loss=0.07184 | Reg=0.00237 | L2-Norm=15.406 | L2-Norm(final)=2.310 | acc=0.9844 | 5284.2 samples/s | 82.6 steps/s
[Step=4250 Epoch=20.8] | Loss=0.06371 | Reg=0.00238 | L2-Norm=15.442 | L2-Norm(final)=2.314 | acc=0.9688 | 1575.2 samples/s | 24.6 steps/s
[Step=4300 Epoch=21.1] | Loss=0.05944 | Reg=0.00239 | L2-Norm=15.474 | L2-Norm(final)=2.321 | acc=0.9219 | 4443.7 samples/s | 69.4 steps/s
[Step=4350 Epoch=21.3] | Loss=0.05507 | Reg=0.00240 | L2-Norm=15.503 | L2-Norm(final)=2.327 | acc=1.0000 | 4388.7 samples/s | 68.6 steps/s
[Step=4400 Epoch=21.6] | Loss=0.05266 | Reg=0.00241 | L2-Norm=15.531 | L2-Norm(final)=2.334 | acc=1.0000 | 5143.7 samples/s | 80.4 steps/s
[Step=4450 Epoch=21.8] | Loss=0.04908 | Reg=0.00242 | L2-Norm=15.559 | L2-Norm(final)=2.341 | acc=1.0000 | 1579.5 samples/s | 24.7 steps/s
[Step=4500 Epoch=22.1] | Loss=0.04707 | Reg=0.00243 | L2-Norm=15.584 | L2-Norm(final)=2.347 | acc=1.0000 | 4520.7 samples/s | 70.6 steps/s
[Step=4550 Epoch=22.3] | Loss=0.04521 | Reg=0.00244 | L2-Norm=15.608 | L2-Norm(final)=2.353 | acc=1.0000 | 4524.5 samples/s | 70.7 steps/s
[Step=4600 Epoch=22.6] | Loss=0.04360 | Reg=0.00244 | L2-Norm=15.630 | L2-Norm(final)=2.358 | acc=0.9844 | 4729.0 samples/s | 73.9 steps/s
[Step=4650 Epoch=22.8] | Loss=0.04186 | Reg=0.00245 | L2-Norm=15.651 | L2-Norm(final)=2.363 | acc=0.9688 | 1522.5 samples/s | 23.8 steps/s
[Step=4700 Epoch=23.0] | Loss=0.04035 | Reg=0.00246 | L2-Norm=15.673 | L2-Norm(final)=2.368 | acc=1.0000 | 3919.5 samples/s | 61.2 steps/s
[Step=4750 Epoch=23.3] | Loss=0.03889 | Reg=0.00246 | L2-Norm=15.694 | L2-Norm(final)=2.372 | acc=1.0000 | 3886.0 samples/s | 60.7 steps/s
[Step=4800 Epoch=23.5] | Loss=0.03833 | Reg=0.00247 | L2-Norm=15.713 | L2-Norm(final)=2.376 | acc=0.9688 | 4414.6 samples/s | 69.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step4800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.06648 | Reg=0.00229 | L2-Norm=15.129 | L2-Norm(final)=2.314 | acc=0.9531 | 3258.7 samples/s | 50.9 steps/s
[Step=1650 Epoch=15.6] | Loss=0.01665 | Reg=0.00233 | L2-Norm=15.277 | L2-Norm(final)=2.325 | acc=0.9688 | 4175.7 samples/s | 65.2 steps/s
[Step=1700 Epoch=16.1] | Loss=0.01263 | Reg=0.00237 | L2-Norm=15.390 | L2-Norm(final)=2.307 | acc=1.0000 | 5095.0 samples/s | 79.6 steps/s
[Step=1750 Epoch=16.6] | Loss=0.00911 | Reg=0.00239 | L2-Norm=15.456 | L2-Norm(final)=2.302 | acc=1.0000 | 1494.0 samples/s | 23.3 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00799 | Reg=0.00240 | L2-Norm=15.490 | L2-Norm(final)=2.300 | acc=1.0000 | 4810.1 samples/s | 75.2 steps/s
[Step=1850 Epoch=17.5] | Loss=0.00643 | Reg=0.00241 | L2-Norm=15.511 | L2-Norm(final)=2.297 | acc=1.0000 | 1523.2 samples/s | 23.8 steps/s
[Step=1900 Epoch=18.0] | Loss=0.00537 | Reg=0.00241 | L2-Norm=15.515 | L2-Norm(final)=2.297 | acc=1.0000 | 4634.0 samples/s | 72.4 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00460 | Reg=0.00241 | L2-Norm=15.508 | L2-Norm(final)=2.296 | acc=1.0000 | 1534.4 samples/s | 24.0 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00403 | Reg=0.00240 | L2-Norm=15.493 | L2-Norm(final)=2.296 | acc=1.0000 | 4431.8 samples/s | 69.2 steps/s
[Step=2050 Epoch=19.4] | Loss=0.00358 | Reg=0.00239 | L2-Norm=15.474 | L2-Norm(final)=2.297 | acc=1.0000 | 1531.7 samples/s | 23.9 steps/s
[Step=2100 Epoch=19.9] | Loss=0.00323 | Reg=0.00239 | L2-Norm=15.451 | L2-Norm(final)=2.297 | acc=1.0000 | 4209.6 samples/s | 65.8 steps/s
[Step=2150 Epoch=20.4] | Loss=0.00293 | Reg=0.00238 | L2-Norm=15.426 | L2-Norm(final)=2.297 | acc=1.0000 | 1730.2 samples/s | 27.0 steps/s
[Step=2200 Epoch=20.8] | Loss=0.00269 | Reg=0.00237 | L2-Norm=15.398 | L2-Norm(final)=2.298 | acc=1.0000 | 4280.3 samples/s | 66.9 steps/s
[Step=2250 Epoch=21.3] | Loss=0.00248 | Reg=0.00236 | L2-Norm=15.370 | L2-Norm(final)=2.298 | acc=1.0000 | 1587.4 samples/s | 24.8 steps/s
[Step=2300 Epoch=21.8] | Loss=0.00231 | Reg=0.00235 | L2-Norm=15.340 | L2-Norm(final)=2.298 | acc=1.0000 | 4355.5 samples/s | 68.1 steps/s
[Step=2350 Epoch=22.3] | Loss=0.00215 | Reg=0.00234 | L2-Norm=15.309 | L2-Norm(final)=2.299 | acc=1.0000 | 1577.0 samples/s | 24.6 steps/s
[Step=2400 Epoch=22.7] | Loss=0.00202 | Reg=0.00233 | L2-Norm=15.278 | L2-Norm(final)=2.299 | acc=1.0000 | 4240.5 samples/s | 66.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step2400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch=30.2] | Loss=0.04812 | Reg=0.00229 | L2-Norm=15.129 | L2-Norm(final)=2.315 | acc=0.9688 | 3810.3 samples/s | 59.5 steps/s
[Step=3250 Epoch=30.6] | Loss=0.02443 | Reg=0.00234 | L2-Norm=15.295 | L2-Norm(final)=2.308 | acc=0.9531 | 3979.8 samples/s | 62.2 steps/s
[Step=3300 Epoch=31.1] | Loss=0.01712 | Reg=0.00239 | L2-Norm=15.462 | L2-Norm(final)=2.287 | acc=1.0000 | 5116.2 samples/s | 79.9 steps/s
[Step=3350 Epoch=31.6] | Loss=0.01177 | Reg=0.00241 | L2-Norm=15.530 | L2-Norm(final)=2.277 | acc=1.0000 | 1504.2 samples/s | 23.5 steps/s
[Step=3400 Epoch=32.0] | Loss=0.00889 | Reg=0.00242 | L2-Norm=15.549 | L2-Norm(final)=2.276 | acc=1.0000 | 4725.3 samples/s | 73.8 steps/s
[Step=3450 Epoch=32.5] | Loss=0.00819 | Reg=0.00242 | L2-Norm=15.558 | L2-Norm(final)=2.278 | acc=1.0000 | 1523.1 samples/s | 23.8 steps/s
[Step=3500 Epoch=33.0] | Loss=0.00782 | Reg=0.00243 | L2-Norm=15.583 | L2-Norm(final)=2.275 | acc=1.0000 | 4511.5 samples/s | 70.5 steps/s
[Step=3550 Epoch=33.5] | Loss=0.00673 | Reg=0.00243 | L2-Norm=15.600 | L2-Norm(final)=2.272 | acc=1.0000 | 1546.0 samples/s | 24.2 steps/s
[Step=3600 Epoch=33.9] | Loss=0.00589 | Reg=0.00244 | L2-Norm=15.605 | L2-Norm(final)=2.271 | acc=1.0000 | 4286.4 samples/s | 67.0 steps/s
[Step=3650 Epoch=34.4] | Loss=0.00527 | Reg=0.00243 | L2-Norm=15.601 | L2-Norm(final)=2.271 | acc=1.0000 | 1538.2 samples/s | 24.0 steps/s
[Step=3700 Epoch=34.9] | Loss=0.00474 | Reg=0.00243 | L2-Norm=15.591 | L2-Norm(final)=2.271 | acc=1.0000 | 3802.4 samples/s | 59.4 steps/s
[Step=3750 Epoch=35.3] | Loss=0.00433 | Reg=0.00243 | L2-Norm=15.576 | L2-Norm(final)=2.271 | acc=1.0000 | 1579.6 samples/s | 24.7 steps/s
[Step=3800 Epoch=35.8] | Loss=0.00410 | Reg=0.00242 | L2-Norm=15.560 | L2-Norm(final)=2.271 | acc=1.0000 | 4266.7 samples/s | 66.7 steps/s
[Step=3850 Epoch=36.3] | Loss=0.00381 | Reg=0.00242 | L2-Norm=15.544 | L2-Norm(final)=2.271 | acc=0.9844 | 1593.7 samples/s | 24.9 steps/s
[Step=3900 Epoch=36.7] | Loss=0.00354 | Reg=0.00241 | L2-Norm=15.525 | L2-Norm(final)=2.272 | acc=1.0000 | 4211.8 samples/s | 65.8 steps/s
[Step=3950 Epoch=37.2] | Loss=0.00331 | Reg=0.00240 | L2-Norm=15.504 | L2-Norm(final)=2.272 | acc=1.0000 | 1642.1 samples/s | 25.7 steps/s
[Step=4000 Epoch=37.7] | Loss=0.00310 | Reg=0.00240 | L2-Norm=15.481 | L2-Norm(final)=2.273 | acc=1.0000 | 3918.5 samples/s | 61.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38689 | acc=0.6737 | tpr=0.5388 | fpr=0.0332 | 3299.8 samples/s | 12.9 steps/s
Avg test loss: 0.38985, Avg test acc: 0.67501, Avg tpr: 0.54159, Avg fpr: 0.03153, total FA: 246

Testing server on iccad2012
[Step=  50] | Loss=0.24914 | acc=0.8659 | tpr=0.9646 | fpr=0.1358 | 3320.2 samples/s | 13.0 steps/s
[Step= 100] | Loss=0.25334 | acc=0.8635 | tpr=0.9680 | fpr=0.1385 | 8551.8 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.25738 | acc=0.8613 | tpr=0.9726 | fpr=0.1408 | 8996.8 samples/s | 35.1 steps/s
[Step= 200] | Loss=0.25954 | acc=0.8612 | tpr=0.9705 | fpr=0.1408 | 8515.9 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.25917 | acc=0.8606 | tpr=0.9703 | fpr=0.1414 | 8758.7 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.26104 | acc=0.8596 | tpr=0.9680 | fpr=0.1424 | 8850.0 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.26144 | acc=0.8594 | tpr=0.9681 | fpr=0.1426 | 8793.9 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.26212 | acc=0.8598 | tpr=0.9677 | fpr=0.1422 | 8496.8 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.26456 | acc=0.8592 | tpr=0.9688 | fpr=0.1427 | 8694.6 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.26469 | acc=0.8587 | tpr=0.9687 | fpr=0.1433 | 8892.7 samples/s | 34.7 steps/s
[Step= 550] | Loss=0.26455 | acc=0.8587 | tpr=0.9686 | fpr=0.1433 | 16079.9 samples/s | 62.8 steps/s
Avg test loss: 0.26435, Avg test acc: 0.85873, Avg tpr: 0.96791, Avg fpr: 0.14326, total FA: 19891

server round 8/50

clients selected: [0 1 3 5 6]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.33845 | Reg=0.00224 | L2-Norm=14.976 | L2-Norm(final)=2.327 | acc=0.7188 | 3481.4 samples/s | 54.4 steps/s
[Step=4050 Epoch=19.7] | Loss=0.09619 | Reg=0.00227 | L2-Norm=15.081 | L2-Norm(final)=2.317 | acc=0.9219 | 2212.3 samples/s | 34.6 steps/s
[Step=4100 Epoch=20.0] | Loss=0.08001 | Reg=0.00229 | L2-Norm=15.137 | L2-Norm(final)=2.321 | acc=0.9062 | 4444.1 samples/s | 69.4 steps/s
[Step=4150 Epoch=20.2] | Loss=0.07444 | Reg=0.00230 | L2-Norm=15.169 | L2-Norm(final)=2.320 | acc=0.9375 | 4455.1 samples/s | 69.6 steps/s
[Step=4200 Epoch=20.5] | Loss=0.06707 | Reg=0.00231 | L2-Norm=15.202 | L2-Norm(final)=2.324 | acc=0.9844 | 5191.5 samples/s | 81.1 steps/s
[Step=4250 Epoch=20.7] | Loss=0.06020 | Reg=0.00232 | L2-Norm=15.237 | L2-Norm(final)=2.333 | acc=0.9844 | 1563.1 samples/s | 24.4 steps/s
[Step=4300 Epoch=21.0] | Loss=0.05601 | Reg=0.00233 | L2-Norm=15.271 | L2-Norm(final)=2.342 | acc=0.9844 | 4491.4 samples/s | 70.2 steps/s
[Step=4350 Epoch=21.2] | Loss=0.05284 | Reg=0.00234 | L2-Norm=15.298 | L2-Norm(final)=2.348 | acc=0.9844 | 4485.5 samples/s | 70.1 steps/s
[Step=4400 Epoch=21.5] | Loss=0.04912 | Reg=0.00235 | L2-Norm=15.323 | L2-Norm(final)=2.356 | acc=1.0000 | 5008.6 samples/s | 78.3 steps/s
[Step=4450 Epoch=21.7] | Loss=0.04682 | Reg=0.00236 | L2-Norm=15.347 | L2-Norm(final)=2.363 | acc=1.0000 | 1568.1 samples/s | 24.5 steps/s
[Step=4500 Epoch=21.9] | Loss=0.04518 | Reg=0.00236 | L2-Norm=15.372 | L2-Norm(final)=2.370 | acc=0.9688 | 4356.7 samples/s | 68.1 steps/s
[Step=4550 Epoch=22.2] | Loss=0.04342 | Reg=0.00237 | L2-Norm=15.395 | L2-Norm(final)=2.376 | acc=0.9844 | 4364.0 samples/s | 68.2 steps/s
[Step=4600 Epoch=22.4] | Loss=0.04220 | Reg=0.00238 | L2-Norm=15.417 | L2-Norm(final)=2.381 | acc=0.9688 | 4744.6 samples/s | 74.1 steps/s
[Step=4650 Epoch=22.7] | Loss=0.04069 | Reg=0.00238 | L2-Norm=15.438 | L2-Norm(final)=2.385 | acc=0.9688 | 1573.3 samples/s | 24.6 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03920 | Reg=0.00239 | L2-Norm=15.460 | L2-Norm(final)=2.389 | acc=0.9844 | 4489.5 samples/s | 70.1 steps/s
[Step=4750 Epoch=23.2] | Loss=0.03818 | Reg=0.00240 | L2-Norm=15.480 | L2-Norm(final)=2.393 | acc=0.9844 | 4343.4 samples/s | 67.9 steps/s
[Step=4800 Epoch=23.4] | Loss=0.03754 | Reg=0.00240 | L2-Norm=15.499 | L2-Norm(final)=2.397 | acc=0.9688 | 4277.3 samples/s | 66.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.31554 | Reg=0.00224 | L2-Norm=14.976 | L2-Norm(final)=2.327 | acc=0.7500 | 3491.1 samples/s | 54.5 steps/s
[Step=2450 Epoch=12.0] | Loss=0.08904 | Reg=0.00227 | L2-Norm=15.057 | L2-Norm(final)=2.317 | acc=0.9844 | 4143.9 samples/s | 64.7 steps/s
[Step=2500 Epoch=12.2] | Loss=0.07962 | Reg=0.00228 | L2-Norm=15.114 | L2-Norm(final)=2.320 | acc=0.9531 | 4418.3 samples/s | 69.0 steps/s
[Step=2550 Epoch=12.4] | Loss=0.07282 | Reg=0.00230 | L2-Norm=15.152 | L2-Norm(final)=2.321 | acc=0.9688 | 4417.5 samples/s | 69.0 steps/s
[Step=2600 Epoch=12.7] | Loss=0.06784 | Reg=0.00231 | L2-Norm=15.187 | L2-Norm(final)=2.323 | acc=0.9062 | 5443.7 samples/s | 85.1 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06140 | Reg=0.00232 | L2-Norm=15.216 | L2-Norm(final)=2.327 | acc=0.9844 | 1558.3 samples/s | 24.3 steps/s
[Step=2700 Epoch=13.2] | Loss=0.05676 | Reg=0.00232 | L2-Norm=15.242 | L2-Norm(final)=2.332 | acc=0.9531 | 4414.2 samples/s | 69.0 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05332 | Reg=0.00233 | L2-Norm=15.266 | L2-Norm(final)=2.337 | acc=0.9844 | 4506.4 samples/s | 70.4 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05086 | Reg=0.00234 | L2-Norm=15.289 | L2-Norm(final)=2.340 | acc=1.0000 | 4986.7 samples/s | 77.9 steps/s
[Step=2850 Epoch=13.9] | Loss=0.04788 | Reg=0.00234 | L2-Norm=15.313 | L2-Norm(final)=2.344 | acc=0.9844 | 1556.8 samples/s | 24.3 steps/s
[Step=2900 Epoch=14.2] | Loss=0.04522 | Reg=0.00235 | L2-Norm=15.337 | L2-Norm(final)=2.350 | acc=0.9531 | 4496.7 samples/s | 70.3 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04398 | Reg=0.00236 | L2-Norm=15.359 | L2-Norm(final)=2.355 | acc=0.9844 | 4413.0 samples/s | 69.0 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04272 | Reg=0.00237 | L2-Norm=15.382 | L2-Norm(final)=2.359 | acc=0.9844 | 4885.0 samples/s | 76.3 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04126 | Reg=0.00237 | L2-Norm=15.406 | L2-Norm(final)=2.363 | acc=0.9688 | 1581.3 samples/s | 24.7 steps/s
[Step=3100 Epoch=15.1] | Loss=0.03953 | Reg=0.00238 | L2-Norm=15.429 | L2-Norm(final)=2.368 | acc=1.0000 | 4385.1 samples/s | 68.5 steps/s
[Step=3150 Epoch=15.4] | Loss=0.03853 | Reg=0.00239 | L2-Norm=15.450 | L2-Norm(final)=2.372 | acc=0.9531 | 4447.9 samples/s | 69.5 steps/s
[Step=3200 Epoch=15.6] | Loss=0.03787 | Reg=0.00239 | L2-Norm=15.468 | L2-Norm(final)=2.375 | acc=0.9531 | 4785.8 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step3200.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.29735 | Reg=0.00224 | L2-Norm=14.976 | L2-Norm(final)=2.326 | acc=0.7969 | 3776.6 samples/s | 59.0 steps/s
[Step=2450 Epoch=11.9] | Loss=0.09073 | Reg=0.00228 | L2-Norm=15.089 | L2-Norm(final)=2.320 | acc=0.8906 | 4317.8 samples/s | 67.5 steps/s
[Step=2500 Epoch=12.2] | Loss=0.07740 | Reg=0.00230 | L2-Norm=15.151 | L2-Norm(final)=2.331 | acc=0.9844 | 4356.0 samples/s | 68.1 steps/s
[Step=2550 Epoch=12.4] | Loss=0.06897 | Reg=0.00231 | L2-Norm=15.197 | L2-Norm(final)=2.339 | acc=0.9375 | 4445.1 samples/s | 69.5 steps/s
[Step=2600 Epoch=12.7] | Loss=0.06619 | Reg=0.00232 | L2-Norm=15.235 | L2-Norm(final)=2.346 | acc=0.9531 | 4923.0 samples/s | 76.9 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06164 | Reg=0.00233 | L2-Norm=15.274 | L2-Norm(final)=2.352 | acc=0.9375 | 1544.3 samples/s | 24.1 steps/s
[Step=2700 Epoch=13.2] | Loss=0.05759 | Reg=0.00234 | L2-Norm=15.312 | L2-Norm(final)=2.358 | acc=0.9688 | 4448.7 samples/s | 69.5 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05489 | Reg=0.00235 | L2-Norm=15.344 | L2-Norm(final)=2.364 | acc=0.9531 | 4476.3 samples/s | 69.9 steps/s
[Step=2800 Epoch=13.7] | Loss=0.05226 | Reg=0.00236 | L2-Norm=15.375 | L2-Norm(final)=2.369 | acc=0.9844 | 5020.5 samples/s | 78.4 steps/s
[Step=2850 Epoch=13.9] | Loss=0.05044 | Reg=0.00237 | L2-Norm=15.410 | L2-Norm(final)=2.375 | acc=0.9688 | 1584.4 samples/s | 24.8 steps/s
[Step=2900 Epoch=14.1] | Loss=0.04810 | Reg=0.00239 | L2-Norm=15.443 | L2-Norm(final)=2.380 | acc=0.9844 | 4515.8 samples/s | 70.6 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04642 | Reg=0.00239 | L2-Norm=15.474 | L2-Norm(final)=2.385 | acc=0.9688 | 4339.3 samples/s | 67.8 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04424 | Reg=0.00240 | L2-Norm=15.504 | L2-Norm(final)=2.390 | acc=0.9688 | 4862.5 samples/s | 76.0 steps/s
[Step=3050 Epoch=14.9] | Loss=0.04237 | Reg=0.00241 | L2-Norm=15.531 | L2-Norm(final)=2.396 | acc=1.0000 | 1598.7 samples/s | 25.0 steps/s
[Step=3100 Epoch=15.1] | Loss=0.04063 | Reg=0.00242 | L2-Norm=15.556 | L2-Norm(final)=2.401 | acc=0.9688 | 4468.4 samples/s | 69.8 steps/s
[Step=3150 Epoch=15.4] | Loss=0.03913 | Reg=0.00243 | L2-Norm=15.578 | L2-Norm(final)=2.406 | acc=0.9844 | 4452.7 samples/s | 69.6 steps/s
[Step=3200 Epoch=15.6] | Loss=0.03772 | Reg=0.00243 | L2-Norm=15.599 | L2-Norm(final)=2.411 | acc=0.9531 | 4759.4 samples/s | 74.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step3200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.05979 | Reg=0.00224 | L2-Norm=14.976 | L2-Norm(final)=2.329 | acc=0.9688 | 3733.5 samples/s | 58.3 steps/s
[Step=2450 Epoch=23.2] | Loss=0.01384 | Reg=0.00230 | L2-Norm=15.152 | L2-Norm(final)=2.331 | acc=1.0000 | 4051.9 samples/s | 63.3 steps/s
[Step=2500 Epoch=23.7] | Loss=0.01262 | Reg=0.00232 | L2-Norm=15.246 | L2-Norm(final)=2.317 | acc=1.0000 | 5101.2 samples/s | 79.7 steps/s
[Step=2550 Epoch=24.2] | Loss=0.00888 | Reg=0.00233 | L2-Norm=15.278 | L2-Norm(final)=2.311 | acc=1.0000 | 1496.5 samples/s | 23.4 steps/s
[Step=2600 Epoch=24.6] | Loss=0.00669 | Reg=0.00234 | L2-Norm=15.282 | L2-Norm(final)=2.310 | acc=1.0000 | 4741.4 samples/s | 74.1 steps/s
[Step=2650 Epoch=25.1] | Loss=0.00536 | Reg=0.00233 | L2-Norm=15.269 | L2-Norm(final)=2.311 | acc=1.0000 | 1524.7 samples/s | 23.8 steps/s
[Step=2700 Epoch=25.6] | Loss=0.00447 | Reg=0.00232 | L2-Norm=15.247 | L2-Norm(final)=2.312 | acc=1.0000 | 4613.3 samples/s | 72.1 steps/s
[Step=2750 Epoch=26.1] | Loss=0.00384 | Reg=0.00232 | L2-Norm=15.219 | L2-Norm(final)=2.313 | acc=1.0000 | 1530.8 samples/s | 23.9 steps/s
[Step=2800 Epoch=26.5] | Loss=0.00336 | Reg=0.00231 | L2-Norm=15.189 | L2-Norm(final)=2.314 | acc=1.0000 | 4441.5 samples/s | 69.4 steps/s
[Step=2850 Epoch=27.0] | Loss=0.00299 | Reg=0.00230 | L2-Norm=15.157 | L2-Norm(final)=2.316 | acc=1.0000 | 1569.7 samples/s | 24.5 steps/s
[Step=2900 Epoch=27.5] | Loss=0.00269 | Reg=0.00229 | L2-Norm=15.123 | L2-Norm(final)=2.317 | acc=1.0000 | 4345.7 samples/s | 67.9 steps/s
[Step=2950 Epoch=28.0] | Loss=0.00245 | Reg=0.00228 | L2-Norm=15.088 | L2-Norm(final)=2.318 | acc=1.0000 | 1561.4 samples/s | 24.4 steps/s
[Step=3000 Epoch=28.4] | Loss=0.00224 | Reg=0.00227 | L2-Norm=15.053 | L2-Norm(final)=2.319 | acc=1.0000 | 4211.5 samples/s | 65.8 steps/s
[Step=3050 Epoch=28.9] | Loss=0.00207 | Reg=0.00226 | L2-Norm=15.017 | L2-Norm(final)=2.319 | acc=1.0000 | 1573.5 samples/s | 24.6 steps/s
[Step=3100 Epoch=29.4] | Loss=0.00192 | Reg=0.00224 | L2-Norm=14.980 | L2-Norm(final)=2.320 | acc=1.0000 | 4359.3 samples/s | 68.1 steps/s
[Step=3150 Epoch=29.8] | Loss=0.00180 | Reg=0.00223 | L2-Norm=14.944 | L2-Norm(final)=2.321 | acc=1.0000 | 1595.4 samples/s | 24.9 steps/s
[Step=3200 Epoch=30.3] | Loss=0.00168 | Reg=0.00222 | L2-Norm=14.907 | L2-Norm(final)=2.322 | acc=1.0000 | 4154.3 samples/s | 64.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step3200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch=30.4] | Loss=0.05407 | Reg=0.00224 | L2-Norm=14.976 | L2-Norm(final)=2.329 | acc=0.9688 | 3700.3 samples/s | 57.8 steps/s
[Step=3250 Epoch=30.9] | Loss=0.01271 | Reg=0.00229 | L2-Norm=15.129 | L2-Norm(final)=2.327 | acc=0.9688 | 4134.5 samples/s | 64.6 steps/s
[Step=3300 Epoch=31.4] | Loss=0.00732 | Reg=0.00231 | L2-Norm=15.206 | L2-Norm(final)=2.326 | acc=1.0000 | 4989.8 samples/s | 78.0 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00551 | Reg=0.00232 | L2-Norm=15.232 | L2-Norm(final)=2.326 | acc=1.0000 | 1524.8 samples/s | 23.8 steps/s
[Step=3400 Epoch=32.3] | Loss=0.00417 | Reg=0.00232 | L2-Norm=15.233 | L2-Norm(final)=2.327 | acc=1.0000 | 4853.7 samples/s | 75.8 steps/s
[Step=3450 Epoch=32.8] | Loss=0.00334 | Reg=0.00232 | L2-Norm=15.221 | L2-Norm(final)=2.328 | acc=1.0000 | 1522.0 samples/s | 23.8 steps/s
[Step=3500 Epoch=33.3] | Loss=0.00279 | Reg=0.00231 | L2-Norm=15.200 | L2-Norm(final)=2.329 | acc=1.0000 | 4583.5 samples/s | 71.6 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00239 | Reg=0.00230 | L2-Norm=15.176 | L2-Norm(final)=2.330 | acc=1.0000 | 1540.9 samples/s | 24.1 steps/s
[Step=3600 Epoch=34.2] | Loss=0.00209 | Reg=0.00229 | L2-Norm=15.148 | L2-Norm(final)=2.331 | acc=1.0000 | 4418.2 samples/s | 69.0 steps/s
[Step=3650 Epoch=34.7] | Loss=0.00186 | Reg=0.00229 | L2-Norm=15.119 | L2-Norm(final)=2.332 | acc=1.0000 | 1570.9 samples/s | 24.5 steps/s
[Step=3700 Epoch=35.2] | Loss=0.00167 | Reg=0.00228 | L2-Norm=15.089 | L2-Norm(final)=2.333 | acc=1.0000 | 4340.1 samples/s | 67.8 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00152 | Reg=0.00227 | L2-Norm=15.058 | L2-Norm(final)=2.333 | acc=1.0000 | 1572.0 samples/s | 24.6 steps/s
[Step=3800 Epoch=36.1] | Loss=0.00140 | Reg=0.00226 | L2-Norm=15.026 | L2-Norm(final)=2.334 | acc=1.0000 | 4202.0 samples/s | 65.7 steps/s
[Step=3850 Epoch=36.6] | Loss=0.00129 | Reg=0.00225 | L2-Norm=14.994 | L2-Norm(final)=2.335 | acc=1.0000 | 1576.6 samples/s | 24.6 steps/s
[Step=3900 Epoch=37.1] | Loss=0.00120 | Reg=0.00224 | L2-Norm=14.961 | L2-Norm(final)=2.335 | acc=1.0000 | 4306.7 samples/s | 67.3 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00112 | Reg=0.00223 | L2-Norm=14.928 | L2-Norm(final)=2.336 | acc=1.0000 | 1616.3 samples/s | 25.3 steps/s
[Step=4000 Epoch=38.0] | Loss=0.00105 | Reg=0.00222 | L2-Norm=14.895 | L2-Norm(final)=2.336 | acc=1.0000 | 4247.7 samples/s | 66.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41023 | acc=0.6634 | tpr=0.5209 | fpr=0.0273 | 4358.8 samples/s | 17.0 steps/s
Avg test loss: 0.41221, Avg test acc: 0.66504, Avg tpr: 0.52457, Avg fpr: 0.02602, total FA: 203

Testing server on iccad2012
[Step=  50] | Loss=0.24422 | acc=0.8739 | tpr=0.9646 | fpr=0.1277 | 4406.3 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.24906 | acc=0.8714 | tpr=0.9701 | fpr=0.1304 | 9305.7 samples/s | 36.4 steps/s
[Step= 150] | Loss=0.25360 | acc=0.8696 | tpr=0.9726 | fpr=0.1323 | 8916.1 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.25575 | acc=0.8694 | tpr=0.9705 | fpr=0.1325 | 8245.7 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.25502 | acc=0.8691 | tpr=0.9703 | fpr=0.1327 | 8805.0 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.25691 | acc=0.8685 | tpr=0.9702 | fpr=0.1334 | 8806.8 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.25739 | acc=0.8680 | tpr=0.9706 | fpr=0.1338 | 8777.1 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.25815 | acc=0.8683 | tpr=0.9699 | fpr=0.1336 | 8611.4 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.26081 | acc=0.8678 | tpr=0.9708 | fpr=0.1341 | 8809.9 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.26076 | acc=0.8673 | tpr=0.9709 | fpr=0.1345 | 8708.4 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.26047 | acc=0.8673 | tpr=0.9706 | fpr=0.1346 | 16454.3 samples/s | 64.3 steps/s
Avg test loss: 0.26028, Avg test acc: 0.86734, Avg tpr: 0.96989, Avg fpr: 0.13452, total FA: 18678

server round 9/50

clients selected: [0 3 5 6 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.20655 | Reg=0.00219 | L2-Norm=14.808 | L2-Norm(final)=2.351 | acc=0.8281 | 3749.6 samples/s | 58.6 steps/s
[Step=4850 Epoch=23.6] | Loss=0.08281 | Reg=0.00223 | L2-Norm=14.922 | L2-Norm(final)=2.345 | acc=0.9375 | 4517.7 samples/s | 70.6 steps/s
[Step=4900 Epoch=23.9] | Loss=0.07105 | Reg=0.00225 | L2-Norm=14.993 | L2-Norm(final)=2.351 | acc=0.9531 | 4467.4 samples/s | 69.8 steps/s
[Step=4950 Epoch=24.1] | Loss=0.06536 | Reg=0.00226 | L2-Norm=15.038 | L2-Norm(final)=2.353 | acc=0.9062 | 4378.9 samples/s | 68.4 steps/s
[Step=5000 Epoch=24.4] | Loss=0.06128 | Reg=0.00227 | L2-Norm=15.079 | L2-Norm(final)=2.359 | acc=0.9688 | 5398.7 samples/s | 84.4 steps/s
[Step=5050 Epoch=24.6] | Loss=0.05546 | Reg=0.00229 | L2-Norm=15.118 | L2-Norm(final)=2.366 | acc=0.9688 | 1555.8 samples/s | 24.3 steps/s
[Step=5100 Epoch=24.9] | Loss=0.05109 | Reg=0.00230 | L2-Norm=15.156 | L2-Norm(final)=2.375 | acc=1.0000 | 4350.6 samples/s | 68.0 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04906 | Reg=0.00231 | L2-Norm=15.190 | L2-Norm(final)=2.383 | acc=1.0000 | 3829.5 samples/s | 59.8 steps/s
[Step=5200 Epoch=25.4] | Loss=0.04717 | Reg=0.00232 | L2-Norm=15.222 | L2-Norm(final)=2.389 | acc=1.0000 | 4636.1 samples/s | 72.4 steps/s
[Step=5250 Epoch=25.6] | Loss=0.04378 | Reg=0.00233 | L2-Norm=15.252 | L2-Norm(final)=2.397 | acc=1.0000 | 1560.5 samples/s | 24.4 steps/s
[Step=5300 Epoch=25.8] | Loss=0.04200 | Reg=0.00234 | L2-Norm=15.281 | L2-Norm(final)=2.405 | acc=0.9688 | 4383.4 samples/s | 68.5 steps/s
[Step=5350 Epoch=26.1] | Loss=0.04085 | Reg=0.00234 | L2-Norm=15.307 | L2-Norm(final)=2.410 | acc=0.9531 | 4418.3 samples/s | 69.0 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03905 | Reg=0.00235 | L2-Norm=15.332 | L2-Norm(final)=2.414 | acc=0.9844 | 4800.1 samples/s | 75.0 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03800 | Reg=0.00236 | L2-Norm=15.354 | L2-Norm(final)=2.418 | acc=1.0000 | 1593.3 samples/s | 24.9 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03653 | Reg=0.00236 | L2-Norm=15.375 | L2-Norm(final)=2.422 | acc=0.9844 | 4416.9 samples/s | 69.0 steps/s
[Step=5550 Epoch=27.1] | Loss=0.03514 | Reg=0.00237 | L2-Norm=15.395 | L2-Norm(final)=2.426 | acc=1.0000 | 4410.6 samples/s | 68.9 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03415 | Reg=0.00238 | L2-Norm=15.415 | L2-Norm(final)=2.430 | acc=0.9844 | 4703.5 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step5600.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.38198 | Reg=0.00219 | L2-Norm=14.808 | L2-Norm(final)=2.349 | acc=0.7188 | 3556.9 samples/s | 55.6 steps/s
[Step=3250 Epoch=15.8] | Loss=0.10040 | Reg=0.00223 | L2-Norm=14.949 | L2-Norm(final)=2.328 | acc=0.8906 | 4740.9 samples/s | 74.1 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07959 | Reg=0.00226 | L2-Norm=15.039 | L2-Norm(final)=2.341 | acc=0.9688 | 4440.4 samples/s | 69.4 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07162 | Reg=0.00228 | L2-Norm=15.094 | L2-Norm(final)=2.352 | acc=0.9219 | 4423.5 samples/s | 69.1 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06773 | Reg=0.00229 | L2-Norm=15.138 | L2-Norm(final)=2.356 | acc=0.9219 | 5192.2 samples/s | 81.1 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05898 | Reg=0.00230 | L2-Norm=15.181 | L2-Norm(final)=2.365 | acc=0.9688 | 1553.6 samples/s | 24.3 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05438 | Reg=0.00232 | L2-Norm=15.217 | L2-Norm(final)=2.375 | acc=1.0000 | 4459.8 samples/s | 69.7 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05164 | Reg=0.00233 | L2-Norm=15.249 | L2-Norm(final)=2.385 | acc=0.9688 | 4444.1 samples/s | 69.4 steps/s
[Step=3600 Epoch=17.6] | Loss=0.04922 | Reg=0.00234 | L2-Norm=15.280 | L2-Norm(final)=2.393 | acc=0.9688 | 5052.1 samples/s | 78.9 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04654 | Reg=0.00234 | L2-Norm=15.310 | L2-Norm(final)=2.402 | acc=0.9844 | 1581.3 samples/s | 24.7 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04484 | Reg=0.00235 | L2-Norm=15.338 | L2-Norm(final)=2.408 | acc=0.9844 | 4480.5 samples/s | 70.0 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04321 | Reg=0.00236 | L2-Norm=15.365 | L2-Norm(final)=2.415 | acc=0.9531 | 4345.2 samples/s | 67.9 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04167 | Reg=0.00237 | L2-Norm=15.391 | L2-Norm(final)=2.421 | acc=0.9844 | 4829.8 samples/s | 75.5 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04014 | Reg=0.00238 | L2-Norm=15.417 | L2-Norm(final)=2.426 | acc=1.0000 | 1577.3 samples/s | 24.6 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03866 | Reg=0.00239 | L2-Norm=15.442 | L2-Norm(final)=2.431 | acc=0.9844 | 4591.1 samples/s | 71.7 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03768 | Reg=0.00239 | L2-Norm=15.467 | L2-Norm(final)=2.436 | acc=0.9688 | 4458.9 samples/s | 69.7 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03696 | Reg=0.00240 | L2-Norm=15.492 | L2-Norm(final)=2.440 | acc=0.9531 | 4690.5 samples/s | 73.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step4000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch=30.3] | Loss=0.07326 | Reg=0.00219 | L2-Norm=14.808 | L2-Norm(final)=2.352 | acc=0.9531 | 3832.0 samples/s | 59.9 steps/s
[Step=3250 Epoch=30.8] | Loss=0.01124 | Reg=0.00225 | L2-Norm=14.986 | L2-Norm(final)=2.372 | acc=1.0000 | 4051.2 samples/s | 63.3 steps/s
[Step=3300 Epoch=31.3] | Loss=0.01058 | Reg=0.00228 | L2-Norm=15.085 | L2-Norm(final)=2.356 | acc=1.0000 | 5059.2 samples/s | 79.0 steps/s
[Step=3350 Epoch=31.7] | Loss=0.00825 | Reg=0.00229 | L2-Norm=15.140 | L2-Norm(final)=2.343 | acc=1.0000 | 1503.3 samples/s | 23.5 steps/s
[Step=3400 Epoch=32.2] | Loss=0.00632 | Reg=0.00230 | L2-Norm=15.160 | L2-Norm(final)=2.341 | acc=1.0000 | 4784.7 samples/s | 74.8 steps/s
[Step=3450 Epoch=32.7] | Loss=0.00507 | Reg=0.00230 | L2-Norm=15.158 | L2-Norm(final)=2.341 | acc=1.0000 | 1513.3 samples/s | 23.6 steps/s
[Step=3500 Epoch=33.2] | Loss=0.00423 | Reg=0.00229 | L2-Norm=15.140 | L2-Norm(final)=2.342 | acc=1.0000 | 4561.8 samples/s | 71.3 steps/s
[Step=3550 Epoch=33.6] | Loss=0.00362 | Reg=0.00228 | L2-Norm=15.115 | L2-Norm(final)=2.343 | acc=1.0000 | 1543.8 samples/s | 24.1 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00317 | Reg=0.00228 | L2-Norm=15.084 | L2-Norm(final)=2.344 | acc=1.0000 | 4566.1 samples/s | 71.3 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00282 | Reg=0.00227 | L2-Norm=15.051 | L2-Norm(final)=2.345 | acc=1.0000 | 1568.8 samples/s | 24.5 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00254 | Reg=0.00225 | L2-Norm=15.015 | L2-Norm(final)=2.346 | acc=1.0000 | 4378.5 samples/s | 68.4 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00231 | Reg=0.00224 | L2-Norm=14.978 | L2-Norm(final)=2.347 | acc=1.0000 | 1572.5 samples/s | 24.6 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00212 | Reg=0.00223 | L2-Norm=14.940 | L2-Norm(final)=2.347 | acc=1.0000 | 4271.7 samples/s | 66.7 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00195 | Reg=0.00222 | L2-Norm=14.902 | L2-Norm(final)=2.348 | acc=1.0000 | 1620.1 samples/s | 25.3 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00182 | Reg=0.00221 | L2-Norm=14.863 | L2-Norm(final)=2.349 | acc=1.0000 | 4215.6 samples/s | 65.9 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00169 | Reg=0.00220 | L2-Norm=14.823 | L2-Norm(final)=2.349 | acc=1.0000 | 1591.5 samples/s | 24.9 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00159 | Reg=0.00219 | L2-Norm=14.783 | L2-Norm(final)=2.350 | acc=1.0000 | 4248.8 samples/s | 66.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.05069 | Reg=0.00219 | L2-Norm=14.808 | L2-Norm(final)=2.353 | acc=0.9688 | 3701.7 samples/s | 57.8 steps/s
[Step=4050 Epoch=38.5] | Loss=0.02283 | Reg=0.00226 | L2-Norm=15.039 | L2-Norm(final)=2.343 | acc=0.9688 | 4091.4 samples/s | 63.9 steps/s
[Step=4100 Epoch=39.0] | Loss=0.01318 | Reg=0.00232 | L2-Norm=15.231 | L2-Norm(final)=2.315 | acc=1.0000 | 5093.3 samples/s | 79.6 steps/s
[Step=4150 Epoch=39.5] | Loss=0.00954 | Reg=0.00235 | L2-Norm=15.313 | L2-Norm(final)=2.313 | acc=1.0000 | 1481.4 samples/s | 23.1 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00805 | Reg=0.00236 | L2-Norm=15.356 | L2-Norm(final)=2.306 | acc=1.0000 | 4784.5 samples/s | 74.8 steps/s
[Step=4250 Epoch=40.4] | Loss=0.00685 | Reg=0.00237 | L2-Norm=15.389 | L2-Norm(final)=2.301 | acc=1.0000 | 1523.9 samples/s | 23.8 steps/s
[Step=4300 Epoch=40.9] | Loss=0.00572 | Reg=0.00237 | L2-Norm=15.405 | L2-Norm(final)=2.298 | acc=1.0000 | 4671.6 samples/s | 73.0 steps/s
[Step=4350 Epoch=41.4] | Loss=0.00491 | Reg=0.00237 | L2-Norm=15.406 | L2-Norm(final)=2.296 | acc=1.0000 | 1531.1 samples/s | 23.9 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00429 | Reg=0.00237 | L2-Norm=15.398 | L2-Norm(final)=2.295 | acc=1.0000 | 4250.9 samples/s | 66.4 steps/s
[Step=4450 Epoch=42.3] | Loss=0.00382 | Reg=0.00237 | L2-Norm=15.384 | L2-Norm(final)=2.294 | acc=1.0000 | 1560.4 samples/s | 24.4 steps/s
[Step=4500 Epoch=42.8] | Loss=0.00344 | Reg=0.00236 | L2-Norm=15.365 | L2-Norm(final)=2.294 | acc=1.0000 | 4254.2 samples/s | 66.5 steps/s
[Step=4550 Epoch=43.3] | Loss=0.00312 | Reg=0.00235 | L2-Norm=15.343 | L2-Norm(final)=2.293 | acc=1.0000 | 1576.0 samples/s | 24.6 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00286 | Reg=0.00235 | L2-Norm=15.319 | L2-Norm(final)=2.293 | acc=1.0000 | 4219.5 samples/s | 65.9 steps/s
[Step=4650 Epoch=44.2] | Loss=0.00264 | Reg=0.00234 | L2-Norm=15.293 | L2-Norm(final)=2.293 | acc=1.0000 | 1594.9 samples/s | 24.9 steps/s
[Step=4700 Epoch=44.7] | Loss=0.00246 | Reg=0.00233 | L2-Norm=15.266 | L2-Norm(final)=2.293 | acc=1.0000 | 4314.7 samples/s | 67.4 steps/s
[Step=4750 Epoch=45.2] | Loss=0.00229 | Reg=0.00232 | L2-Norm=15.238 | L2-Norm(final)=2.293 | acc=1.0000 | 1592.5 samples/s | 24.9 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00215 | Reg=0.00231 | L2-Norm=15.209 | L2-Norm(final)=2.293 | acc=1.0000 | 4152.0 samples/s | 64.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step4800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch=15.3] | Loss=0.08970 | Reg=0.00219 | L2-Norm=14.808 | L2-Norm(final)=2.352 | acc=0.9375 | 3918.8 samples/s | 61.2 steps/s
[Step=1650 Epoch=15.7] | Loss=0.02057 | Reg=0.00224 | L2-Norm=14.970 | L2-Norm(final)=2.338 | acc=1.0000 | 3527.0 samples/s | 55.1 steps/s
[Step=1700 Epoch=16.2] | Loss=0.01352 | Reg=0.00228 | L2-Norm=15.096 | L2-Norm(final)=2.320 | acc=1.0000 | 5122.4 samples/s | 80.0 steps/s
[Step=1750 Epoch=16.7] | Loss=0.00911 | Reg=0.00230 | L2-Norm=15.159 | L2-Norm(final)=2.320 | acc=1.0000 | 1502.6 samples/s | 23.5 steps/s
[Step=1800 Epoch=17.2] | Loss=0.00685 | Reg=0.00230 | L2-Norm=15.179 | L2-Norm(final)=2.322 | acc=1.0000 | 4917.9 samples/s | 76.8 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00548 | Reg=0.00230 | L2-Norm=15.179 | L2-Norm(final)=2.324 | acc=1.0000 | 1529.9 samples/s | 23.9 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00457 | Reg=0.00230 | L2-Norm=15.168 | L2-Norm(final)=2.326 | acc=1.0000 | 4661.0 samples/s | 72.8 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00392 | Reg=0.00230 | L2-Norm=15.151 | L2-Norm(final)=2.328 | acc=1.0000 | 1538.9 samples/s | 24.0 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00343 | Reg=0.00229 | L2-Norm=15.130 | L2-Norm(final)=2.329 | acc=1.0000 | 4565.6 samples/s | 71.3 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00305 | Reg=0.00228 | L2-Norm=15.107 | L2-Norm(final)=2.330 | acc=1.0000 | 1703.3 samples/s | 26.6 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00275 | Reg=0.00227 | L2-Norm=15.082 | L2-Norm(final)=2.331 | acc=1.0000 | 4591.4 samples/s | 71.7 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00250 | Reg=0.00227 | L2-Norm=15.055 | L2-Norm(final)=2.332 | acc=1.0000 | 1570.5 samples/s | 24.5 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00229 | Reg=0.00226 | L2-Norm=15.028 | L2-Norm(final)=2.333 | acc=1.0000 | 4314.4 samples/s | 67.4 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00212 | Reg=0.00225 | L2-Norm=15.000 | L2-Norm(final)=2.334 | acc=1.0000 | 1578.6 samples/s | 24.7 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00197 | Reg=0.00224 | L2-Norm=14.971 | L2-Norm(final)=2.335 | acc=1.0000 | 4271.3 samples/s | 66.7 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00184 | Reg=0.00223 | L2-Norm=14.942 | L2-Norm(final)=2.336 | acc=1.0000 | 1603.9 samples/s | 25.1 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00172 | Reg=0.00222 | L2-Norm=14.912 | L2-Norm(final)=2.337 | acc=1.0000 | 4402.9 samples/s | 68.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46891 | acc=0.6503 | tpr=0.4991 | fpr=0.0213 | 4365.9 samples/s | 17.1 steps/s
Avg test loss: 0.47195, Avg test acc: 0.65113, Avg tpr: 0.50184, Avg fpr: 0.02051, total FA: 160

Testing server on iccad2012
[Step=  50] | Loss=0.22269 | acc=0.8912 | tpr=0.9646 | fpr=0.1101 | 4394.0 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.22635 | acc=0.8884 | tpr=0.9701 | fpr=0.1131 | 9044.8 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.23041 | acc=0.8867 | tpr=0.9726 | fpr=0.1149 | 8534.4 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.23242 | acc=0.8865 | tpr=0.9694 | fpr=0.1150 | 8682.3 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.23134 | acc=0.8865 | tpr=0.9694 | fpr=0.1150 | 9047.5 samples/s | 35.3 steps/s
[Step= 300] | Loss=0.23294 | acc=0.8860 | tpr=0.9680 | fpr=0.1155 | 8508.2 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.23355 | acc=0.8854 | tpr=0.9693 | fpr=0.1161 | 8898.1 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.23448 | acc=0.8856 | tpr=0.9688 | fpr=0.1159 | 8801.5 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.23721 | acc=0.8851 | tpr=0.9693 | fpr=0.1164 | 8345.9 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.23726 | acc=0.8845 | tpr=0.9692 | fpr=0.1170 | 8886.3 samples/s | 34.7 steps/s
[Step= 550] | Loss=0.23691 | acc=0.8844 | tpr=0.9686 | fpr=0.1171 | 16103.6 samples/s | 62.9 steps/s
Avg test loss: 0.23667, Avg test acc: 0.88448, Avg tpr: 0.96830, Avg fpr: 0.11705, total FA: 16252

server round 10/50

clients selected: [1 2 5 7 9]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=3201 Epoch=15.6] | Loss=0.36351 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=2.367 | acc=0.7500 | 3741.9 samples/s | 58.5 steps/s
[Step=3250 Epoch=15.9] | Loss=0.09734 | Reg=0.00218 | L2-Norm=14.762 | L2-Norm(final)=2.350 | acc=0.9844 | 4458.8 samples/s | 69.7 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07432 | Reg=0.00219 | L2-Norm=14.793 | L2-Norm(final)=2.360 | acc=0.9531 | 4236.3 samples/s | 66.2 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06337 | Reg=0.00219 | L2-Norm=14.814 | L2-Norm(final)=2.369 | acc=0.9844 | 3876.2 samples/s | 60.6 steps/s
[Step=3400 Epoch=16.6] | Loss=0.05653 | Reg=0.00220 | L2-Norm=14.830 | L2-Norm(final)=2.375 | acc=1.0000 | 4852.5 samples/s | 75.8 steps/s
[Step=3450 Epoch=16.8] | Loss=0.04948 | Reg=0.00220 | L2-Norm=14.844 | L2-Norm(final)=2.383 | acc=1.0000 | 1547.1 samples/s | 24.2 steps/s
[Step=3500 Epoch=17.1] | Loss=0.04444 | Reg=0.00221 | L2-Norm=14.859 | L2-Norm(final)=2.391 | acc=1.0000 | 4387.8 samples/s | 68.6 steps/s
[Step=3550 Epoch=17.3] | Loss=0.04074 | Reg=0.00221 | L2-Norm=14.871 | L2-Norm(final)=2.399 | acc=1.0000 | 4382.3 samples/s | 68.5 steps/s
[Step=3600 Epoch=17.6] | Loss=0.03823 | Reg=0.00222 | L2-Norm=14.883 | L2-Norm(final)=2.407 | acc=1.0000 | 5083.8 samples/s | 79.4 steps/s
[Step=3650 Epoch=17.8] | Loss=0.03570 | Reg=0.00222 | L2-Norm=14.893 | L2-Norm(final)=2.414 | acc=1.0000 | 1569.9 samples/s | 24.5 steps/s
[Step=3700 Epoch=18.1] | Loss=0.03337 | Reg=0.00222 | L2-Norm=14.901 | L2-Norm(final)=2.420 | acc=1.0000 | 4417.2 samples/s | 69.0 steps/s
[Step=3750 Epoch=18.3] | Loss=0.03154 | Reg=0.00222 | L2-Norm=14.910 | L2-Norm(final)=2.426 | acc=1.0000 | 4411.1 samples/s | 68.9 steps/s
[Step=3800 Epoch=18.5] | Loss=0.02989 | Reg=0.00223 | L2-Norm=14.918 | L2-Norm(final)=2.433 | acc=0.9688 | 4917.8 samples/s | 76.8 steps/s
[Step=3850 Epoch=18.8] | Loss=0.02857 | Reg=0.00223 | L2-Norm=14.926 | L2-Norm(final)=2.439 | acc=1.0000 | 1584.1 samples/s | 24.8 steps/s
[Step=3900 Epoch=19.0] | Loss=0.02711 | Reg=0.00223 | L2-Norm=14.933 | L2-Norm(final)=2.445 | acc=1.0000 | 4454.5 samples/s | 69.6 steps/s
[Step=3950 Epoch=19.3] | Loss=0.02610 | Reg=0.00223 | L2-Norm=14.940 | L2-Norm(final)=2.451 | acc=0.9688 | 4485.2 samples/s | 70.1 steps/s
[Step=4000 Epoch=19.5] | Loss=0.02515 | Reg=0.00223 | L2-Norm=14.946 | L2-Norm(final)=2.456 | acc=1.0000 | 4831.7 samples/s | 75.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step4000.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00050, len=1
[Step=4001 Epoch=19.5] | Loss=0.30824 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=2.367 | acc=0.7656 | 3957.7 samples/s | 61.8 steps/s
[Step=4050 Epoch=19.7] | Loss=0.08973 | Reg=0.00218 | L2-Norm=14.768 | L2-Norm(final)=2.352 | acc=0.9844 | 4478.0 samples/s | 70.0 steps/s
[Step=4100 Epoch=20.0] | Loss=0.07212 | Reg=0.00219 | L2-Norm=14.799 | L2-Norm(final)=2.363 | acc=0.9688 | 4282.4 samples/s | 66.9 steps/s
[Step=4150 Epoch=20.2] | Loss=0.06316 | Reg=0.00220 | L2-Norm=14.819 | L2-Norm(final)=2.371 | acc=0.9531 | 3890.1 samples/s | 60.8 steps/s
[Step=4200 Epoch=20.5] | Loss=0.05579 | Reg=0.00220 | L2-Norm=14.837 | L2-Norm(final)=2.379 | acc=0.9844 | 4796.9 samples/s | 75.0 steps/s
[Step=4250 Epoch=20.7] | Loss=0.04984 | Reg=0.00221 | L2-Norm=14.855 | L2-Norm(final)=2.389 | acc=1.0000 | 1557.2 samples/s | 24.3 steps/s
[Step=4300 Epoch=21.0] | Loss=0.04511 | Reg=0.00221 | L2-Norm=14.872 | L2-Norm(final)=2.398 | acc=0.9844 | 4362.9 samples/s | 68.2 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04158 | Reg=0.00222 | L2-Norm=14.888 | L2-Norm(final)=2.407 | acc=0.9844 | 4390.3 samples/s | 68.6 steps/s
[Step=4400 Epoch=21.4] | Loss=0.03837 | Reg=0.00222 | L2-Norm=14.902 | L2-Norm(final)=2.416 | acc=1.0000 | 5011.0 samples/s | 78.3 steps/s
[Step=4450 Epoch=21.7] | Loss=0.03584 | Reg=0.00222 | L2-Norm=14.915 | L2-Norm(final)=2.424 | acc=0.9844 | 1508.8 samples/s | 23.6 steps/s
[Step=4500 Epoch=21.9] | Loss=0.03376 | Reg=0.00223 | L2-Norm=14.927 | L2-Norm(final)=2.432 | acc=1.0000 | 3847.6 samples/s | 60.1 steps/s
[Step=4550 Epoch=22.2] | Loss=0.03183 | Reg=0.00223 | L2-Norm=14.938 | L2-Norm(final)=2.439 | acc=1.0000 | 3879.9 samples/s | 60.6 steps/s
[Step=4600 Epoch=22.4] | Loss=0.03019 | Reg=0.00223 | L2-Norm=14.948 | L2-Norm(final)=2.446 | acc=1.0000 | 4427.8 samples/s | 69.2 steps/s
[Step=4650 Epoch=22.7] | Loss=0.02880 | Reg=0.00224 | L2-Norm=14.958 | L2-Norm(final)=2.453 | acc=0.9688 | 1586.5 samples/s | 24.8 steps/s
[Step=4700 Epoch=22.9] | Loss=0.02761 | Reg=0.00224 | L2-Norm=14.966 | L2-Norm(final)=2.459 | acc=0.9844 | 4443.3 samples/s | 69.4 steps/s
[Step=4750 Epoch=23.1] | Loss=0.02639 | Reg=0.00224 | L2-Norm=14.975 | L2-Norm(final)=2.465 | acc=1.0000 | 4444.1 samples/s | 69.4 steps/s
[Step=4800 Epoch=23.4] | Loss=0.02546 | Reg=0.00225 | L2-Norm=14.983 | L2-Norm(final)=2.471 | acc=1.0000 | 4635.5 samples/s | 72.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step4800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=4001 Epoch=37.9] | Loss=0.04840 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=2.368 | acc=0.9688 | 3811.4 samples/s | 59.6 steps/s
[Step=4050 Epoch=38.4] | Loss=0.01088 | Reg=0.00219 | L2-Norm=14.787 | L2-Norm(final)=2.379 | acc=1.0000 | 4158.9 samples/s | 65.0 steps/s
[Step=4100 Epoch=38.9] | Loss=0.00604 | Reg=0.00219 | L2-Norm=14.810 | L2-Norm(final)=2.384 | acc=1.0000 | 5067.5 samples/s | 79.2 steps/s
[Step=4150 Epoch=39.3] | Loss=0.00411 | Reg=0.00219 | L2-Norm=14.806 | L2-Norm(final)=2.392 | acc=1.0000 | 1500.8 samples/s | 23.4 steps/s
[Step=4200 Epoch=39.8] | Loss=0.00309 | Reg=0.00219 | L2-Norm=14.791 | L2-Norm(final)=2.398 | acc=1.0000 | 4935.9 samples/s | 77.1 steps/s
[Step=4250 Epoch=40.3] | Loss=0.00248 | Reg=0.00218 | L2-Norm=14.771 | L2-Norm(final)=2.401 | acc=1.0000 | 1672.0 samples/s | 26.1 steps/s
[Step=4300 Epoch=40.7] | Loss=0.00207 | Reg=0.00218 | L2-Norm=14.748 | L2-Norm(final)=2.404 | acc=1.0000 | 4640.8 samples/s | 72.5 steps/s
[Step=4350 Epoch=41.2] | Loss=0.00178 | Reg=0.00217 | L2-Norm=14.724 | L2-Norm(final)=2.406 | acc=1.0000 | 1538.2 samples/s | 24.0 steps/s
[Step=4400 Epoch=41.7] | Loss=0.00156 | Reg=0.00216 | L2-Norm=14.700 | L2-Norm(final)=2.408 | acc=1.0000 | 4558.2 samples/s | 71.2 steps/s
[Step=4450 Epoch=42.2] | Loss=0.00139 | Reg=0.00215 | L2-Norm=14.674 | L2-Norm(final)=2.410 | acc=1.0000 | 1551.4 samples/s | 24.2 steps/s
[Step=4500 Epoch=42.6] | Loss=0.00125 | Reg=0.00215 | L2-Norm=14.648 | L2-Norm(final)=2.412 | acc=1.0000 | 4289.4 samples/s | 67.0 steps/s
[Step=4550 Epoch=43.1] | Loss=0.00114 | Reg=0.00214 | L2-Norm=14.622 | L2-Norm(final)=2.413 | acc=1.0000 | 1591.3 samples/s | 24.9 steps/s
[Step=4600 Epoch=43.6] | Loss=0.00104 | Reg=0.00213 | L2-Norm=14.596 | L2-Norm(final)=2.414 | acc=1.0000 | 4297.5 samples/s | 67.1 steps/s
[Step=4650 Epoch=44.1] | Loss=0.00096 | Reg=0.00212 | L2-Norm=14.570 | L2-Norm(final)=2.415 | acc=1.0000 | 1574.9 samples/s | 24.6 steps/s
[Step=4700 Epoch=44.5] | Loss=0.00089 | Reg=0.00212 | L2-Norm=14.543 | L2-Norm(final)=2.417 | acc=1.0000 | 4302.6 samples/s | 67.2 steps/s
[Step=4750 Epoch=45.0] | Loss=0.00084 | Reg=0.00211 | L2-Norm=14.517 | L2-Norm(final)=2.418 | acc=1.0000 | 1599.2 samples/s | 25.0 steps/s
[Step=4800 Epoch=45.5] | Loss=0.00078 | Reg=0.00210 | L2-Norm=14.490 | L2-Norm(final)=2.419 | acc=1.0000 | 4165.8 samples/s | 65.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00050, len=1
[Step=3201 Epoch=30.6] | Loss=0.01401 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=2.369 | acc=1.0000 | 3637.3 samples/s | 56.8 steps/s
[Step=3250 Epoch=31.0] | Loss=0.00675 | Reg=0.00218 | L2-Norm=14.757 | L2-Norm(final)=2.376 | acc=1.0000 | 4257.3 samples/s | 66.5 steps/s
[Step=3300 Epoch=31.5] | Loss=0.00385 | Reg=0.00218 | L2-Norm=14.773 | L2-Norm(final)=2.382 | acc=1.0000 | 4991.2 samples/s | 78.0 steps/s
[Step=3350 Epoch=32.0] | Loss=0.00259 | Reg=0.00218 | L2-Norm=14.772 | L2-Norm(final)=2.385 | acc=1.0000 | 1513.0 samples/s | 23.6 steps/s
[Step=3400 Epoch=32.5] | Loss=0.00195 | Reg=0.00218 | L2-Norm=14.765 | L2-Norm(final)=2.387 | acc=1.0000 | 4838.6 samples/s | 75.6 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00156 | Reg=0.00218 | L2-Norm=14.756 | L2-Norm(final)=2.389 | acc=1.0000 | 1518.7 samples/s | 23.7 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00131 | Reg=0.00217 | L2-Norm=14.744 | L2-Norm(final)=2.390 | acc=1.0000 | 4763.8 samples/s | 74.4 steps/s
[Step=3550 Epoch=33.9] | Loss=0.00112 | Reg=0.00217 | L2-Norm=14.732 | L2-Norm(final)=2.392 | acc=1.0000 | 1547.6 samples/s | 24.2 steps/s
[Step=3600 Epoch=34.4] | Loss=0.00098 | Reg=0.00217 | L2-Norm=14.719 | L2-Norm(final)=2.392 | acc=1.0000 | 4592.6 samples/s | 71.8 steps/s
[Step=3650 Epoch=34.9] | Loss=0.00088 | Reg=0.00216 | L2-Norm=14.705 | L2-Norm(final)=2.393 | acc=1.0000 | 1543.1 samples/s | 24.1 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00079 | Reg=0.00216 | L2-Norm=14.691 | L2-Norm(final)=2.394 | acc=1.0000 | 4410.1 samples/s | 68.9 steps/s
[Step=3750 Epoch=35.8] | Loss=0.00072 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=2.395 | acc=1.0000 | 1554.0 samples/s | 24.3 steps/s
[Step=3800 Epoch=36.3] | Loss=0.00066 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.396 | acc=1.0000 | 4365.5 samples/s | 68.2 steps/s
[Step=3850 Epoch=36.8] | Loss=0.00061 | Reg=0.00215 | L2-Norm=14.648 | L2-Norm(final)=2.396 | acc=1.0000 | 1570.6 samples/s | 24.5 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00057 | Reg=0.00214 | L2-Norm=14.633 | L2-Norm(final)=2.397 | acc=1.0000 | 4274.2 samples/s | 66.8 steps/s
[Step=3950 Epoch=37.7] | Loss=0.00053 | Reg=0.00214 | L2-Norm=14.618 | L2-Norm(final)=2.397 | acc=1.0000 | 1589.4 samples/s | 24.8 steps/s
[Step=4000 Epoch=38.2] | Loss=0.00050 | Reg=0.00213 | L2-Norm=14.603 | L2-Norm(final)=2.398 | acc=1.0000 | 4305.2 samples/s | 67.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step4000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00050, len=1
[Step=2401 Epoch=22.9] | Loss=0.01227 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=2.369 | acc=1.0000 | 3778.8 samples/s | 59.0 steps/s
[Step=2450 Epoch=23.4] | Loss=0.00886 | Reg=0.00218 | L2-Norm=14.761 | L2-Norm(final)=2.376 | acc=1.0000 | 3986.4 samples/s | 62.3 steps/s
[Step=2500 Epoch=23.8] | Loss=0.00490 | Reg=0.00218 | L2-Norm=14.777 | L2-Norm(final)=2.387 | acc=1.0000 | 5135.3 samples/s | 80.2 steps/s
[Step=2550 Epoch=24.3] | Loss=0.00330 | Reg=0.00218 | L2-Norm=14.779 | L2-Norm(final)=2.396 | acc=1.0000 | 1444.0 samples/s | 22.6 steps/s
[Step=2600 Epoch=24.8] | Loss=0.00249 | Reg=0.00218 | L2-Norm=14.771 | L2-Norm(final)=2.401 | acc=1.0000 | 4876.1 samples/s | 76.2 steps/s
[Step=2650 Epoch=25.3] | Loss=0.00200 | Reg=0.00218 | L2-Norm=14.758 | L2-Norm(final)=2.404 | acc=1.0000 | 1514.5 samples/s | 23.7 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00167 | Reg=0.00217 | L2-Norm=14.743 | L2-Norm(final)=2.407 | acc=1.0000 | 4775.2 samples/s | 74.6 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00143 | Reg=0.00217 | L2-Norm=14.726 | L2-Norm(final)=2.409 | acc=1.0000 | 1677.2 samples/s | 26.2 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00126 | Reg=0.00216 | L2-Norm=14.708 | L2-Norm(final)=2.411 | acc=1.0000 | 4614.8 samples/s | 72.1 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00112 | Reg=0.00216 | L2-Norm=14.690 | L2-Norm(final)=2.413 | acc=1.0000 | 1553.7 samples/s | 24.3 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00101 | Reg=0.00215 | L2-Norm=14.671 | L2-Norm(final)=2.414 | acc=1.0000 | 4418.8 samples/s | 69.0 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00092 | Reg=0.00215 | L2-Norm=14.652 | L2-Norm(final)=2.416 | acc=1.0000 | 1545.3 samples/s | 24.1 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00084 | Reg=0.00214 | L2-Norm=14.632 | L2-Norm(final)=2.417 | acc=1.0000 | 4294.5 samples/s | 67.1 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00078 | Reg=0.00214 | L2-Norm=14.612 | L2-Norm(final)=2.418 | acc=1.0000 | 1573.4 samples/s | 24.6 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00072 | Reg=0.00213 | L2-Norm=14.592 | L2-Norm(final)=2.419 | acc=1.0000 | 4189.4 samples/s | 65.5 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00068 | Reg=0.00212 | L2-Norm=14.571 | L2-Norm(final)=2.420 | acc=1.0000 | 1596.9 samples/s | 25.0 steps/s
[Step=3200 Epoch=30.5] | Loss=0.00063 | Reg=0.00212 | L2-Norm=14.551 | L2-Norm(final)=2.421 | acc=1.0000 | 4365.9 samples/s | 68.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44021 | acc=0.6962 | tpr=0.5652 | fpr=0.0193 | 4314.1 samples/s | 16.9 steps/s
Avg test loss: 0.44387, Avg test acc: 0.69641, Avg tpr: 0.56694, Avg fpr: 0.01884, total FA: 147

Testing server on iccad2012
[Step=  50] | Loss=0.28388 | acc=0.8702 | tpr=0.9646 | fpr=0.1315 | 4401.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.28829 | acc=0.8686 | tpr=0.9680 | fpr=0.1333 | 8849.7 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.29339 | acc=0.8670 | tpr=0.9697 | fpr=0.1349 | 8967.7 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.29537 | acc=0.8672 | tpr=0.9683 | fpr=0.1347 | 8500.2 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.29415 | acc=0.8676 | tpr=0.9694 | fpr=0.1342 | 9014.8 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.29597 | acc=0.8672 | tpr=0.9687 | fpr=0.1347 | 8584.0 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.29664 | acc=0.8670 | tpr=0.9687 | fpr=0.1348 | 9045.4 samples/s | 35.3 steps/s
[Step= 400] | Loss=0.29771 | acc=0.8675 | tpr=0.9688 | fpr=0.1343 | 8432.7 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.30098 | acc=0.8671 | tpr=0.9688 | fpr=0.1348 | 9222.8 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.30120 | acc=0.8662 | tpr=0.9687 | fpr=0.1356 | 8588.6 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.30084 | acc=0.8662 | tpr=0.9682 | fpr=0.1356 | 16357.0 samples/s | 63.9 steps/s
Avg test loss: 0.30065, Avg test acc: 0.86626, Avg tpr: 0.96791, Avg fpr: 0.13559, total FA: 18826

server round 11/50

clients selected: [1 4 5 6 9]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=4001 Epoch=19.5] | Loss=0.20908 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.430 | acc=0.7969 | 3628.4 samples/s | 56.7 steps/s
[Step=4050 Epoch=19.8] | Loss=0.07928 | Reg=0.00216 | L2-Norm=14.684 | L2-Norm(final)=2.408 | acc=0.9688 | 4417.6 samples/s | 69.0 steps/s
[Step=4100 Epoch=20.0] | Loss=0.06173 | Reg=0.00216 | L2-Norm=14.710 | L2-Norm(final)=2.414 | acc=0.9531 | 4300.4 samples/s | 67.2 steps/s
[Step=4150 Epoch=20.3] | Loss=0.05668 | Reg=0.00217 | L2-Norm=14.729 | L2-Norm(final)=2.418 | acc=0.9844 | 4731.5 samples/s | 73.9 steps/s
[Step=4200 Epoch=20.5] | Loss=0.05183 | Reg=0.00217 | L2-Norm=14.744 | L2-Norm(final)=2.421 | acc=0.9844 | 5058.4 samples/s | 79.0 steps/s
[Step=4250 Epoch=20.7] | Loss=0.04596 | Reg=0.00218 | L2-Norm=14.759 | L2-Norm(final)=2.426 | acc=1.0000 | 1494.3 samples/s | 23.3 steps/s
[Step=4300 Epoch=21.0] | Loss=0.04180 | Reg=0.00218 | L2-Norm=14.773 | L2-Norm(final)=2.432 | acc=0.9688 | 4324.1 samples/s | 67.6 steps/s
[Step=4350 Epoch=21.2] | Loss=0.03857 | Reg=0.00219 | L2-Norm=14.786 | L2-Norm(final)=2.438 | acc=0.9844 | 4357.9 samples/s | 68.1 steps/s
[Step=4400 Epoch=21.5] | Loss=0.03633 | Reg=0.00219 | L2-Norm=14.797 | L2-Norm(final)=2.444 | acc=1.0000 | 5075.7 samples/s | 79.3 steps/s
[Step=4450 Epoch=21.7] | Loss=0.03348 | Reg=0.00219 | L2-Norm=14.808 | L2-Norm(final)=2.450 | acc=0.9844 | 1561.5 samples/s | 24.4 steps/s
[Step=4500 Epoch=22.0] | Loss=0.03149 | Reg=0.00220 | L2-Norm=14.818 | L2-Norm(final)=2.456 | acc=0.9844 | 4407.8 samples/s | 68.9 steps/s
[Step=4550 Epoch=22.2] | Loss=0.02977 | Reg=0.00220 | L2-Norm=14.827 | L2-Norm(final)=2.462 | acc=1.0000 | 4419.4 samples/s | 69.1 steps/s
[Step=4600 Epoch=22.4] | Loss=0.02853 | Reg=0.00220 | L2-Norm=14.836 | L2-Norm(final)=2.468 | acc=1.0000 | 4940.1 samples/s | 77.2 steps/s
[Step=4650 Epoch=22.7] | Loss=0.02690 | Reg=0.00220 | L2-Norm=14.844 | L2-Norm(final)=2.473 | acc=1.0000 | 1568.4 samples/s | 24.5 steps/s
[Step=4700 Epoch=22.9] | Loss=0.02583 | Reg=0.00221 | L2-Norm=14.852 | L2-Norm(final)=2.479 | acc=1.0000 | 4387.4 samples/s | 68.6 steps/s
[Step=4750 Epoch=23.2] | Loss=0.02506 | Reg=0.00221 | L2-Norm=14.859 | L2-Norm(final)=2.484 | acc=1.0000 | 4352.8 samples/s | 68.0 steps/s
[Step=4800 Epoch=23.4] | Loss=0.02416 | Reg=0.00221 | L2-Norm=14.864 | L2-Norm(final)=2.488 | acc=0.9844 | 4843.4 samples/s | 75.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step4800.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00050, len=1
[Step=4801 Epoch=23.5] | Loss=0.13256 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.430 | acc=0.8281 | 3802.8 samples/s | 59.4 steps/s
[Step=4850 Epoch=23.8] | Loss=0.06678 | Reg=0.00216 | L2-Norm=14.694 | L2-Norm(final)=2.416 | acc=0.9531 | 4305.3 samples/s | 67.3 steps/s
[Step=4900 Epoch=24.0] | Loss=0.05454 | Reg=0.00217 | L2-Norm=14.717 | L2-Norm(final)=2.419 | acc=0.9844 | 4410.4 samples/s | 68.9 steps/s
[Step=4950 Epoch=24.3] | Loss=0.05156 | Reg=0.00217 | L2-Norm=14.730 | L2-Norm(final)=2.422 | acc=1.0000 | 4427.5 samples/s | 69.2 steps/s
[Step=5000 Epoch=24.5] | Loss=0.04728 | Reg=0.00217 | L2-Norm=14.744 | L2-Norm(final)=2.425 | acc=0.9844 | 5341.7 samples/s | 83.5 steps/s
[Step=5050 Epoch=24.8] | Loss=0.04176 | Reg=0.00218 | L2-Norm=14.757 | L2-Norm(final)=2.431 | acc=1.0000 | 1572.8 samples/s | 24.6 steps/s
[Step=5100 Epoch=25.0] | Loss=0.03805 | Reg=0.00218 | L2-Norm=14.771 | L2-Norm(final)=2.438 | acc=0.9844 | 4349.4 samples/s | 68.0 steps/s
[Step=5150 Epoch=25.3] | Loss=0.03527 | Reg=0.00219 | L2-Norm=14.782 | L2-Norm(final)=2.444 | acc=1.0000 | 4436.4 samples/s | 69.3 steps/s
[Step=5200 Epoch=25.5] | Loss=0.03298 | Reg=0.00219 | L2-Norm=14.794 | L2-Norm(final)=2.451 | acc=0.9688 | 5172.8 samples/s | 80.8 steps/s
[Step=5250 Epoch=25.7] | Loss=0.03048 | Reg=0.00219 | L2-Norm=14.804 | L2-Norm(final)=2.457 | acc=1.0000 | 1547.1 samples/s | 24.2 steps/s
[Step=5300 Epoch=26.0] | Loss=0.02867 | Reg=0.00219 | L2-Norm=14.814 | L2-Norm(final)=2.464 | acc=1.0000 | 4398.5 samples/s | 68.7 steps/s
[Step=5350 Epoch=26.2] | Loss=0.02722 | Reg=0.00220 | L2-Norm=14.824 | L2-Norm(final)=2.470 | acc=1.0000 | 4397.4 samples/s | 68.7 steps/s
[Step=5400 Epoch=26.5] | Loss=0.02615 | Reg=0.00220 | L2-Norm=14.832 | L2-Norm(final)=2.476 | acc=1.0000 | 4648.2 samples/s | 72.6 steps/s
[Step=5450 Epoch=26.7] | Loss=0.02480 | Reg=0.00220 | L2-Norm=14.840 | L2-Norm(final)=2.481 | acc=1.0000 | 1510.8 samples/s | 23.6 steps/s
[Step=5500 Epoch=27.0] | Loss=0.02370 | Reg=0.00220 | L2-Norm=14.847 | L2-Norm(final)=2.487 | acc=1.0000 | 3838.7 samples/s | 60.0 steps/s
[Step=5550 Epoch=27.2] | Loss=0.02270 | Reg=0.00221 | L2-Norm=14.854 | L2-Norm(final)=2.492 | acc=1.0000 | 3913.9 samples/s | 61.2 steps/s
[Step=5600 Epoch=27.5] | Loss=0.02188 | Reg=0.00221 | L2-Norm=14.861 | L2-Norm(final)=2.497 | acc=1.0000 | 4372.0 samples/s | 68.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step5600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=4801 Epoch=45.5] | Loss=0.02275 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.431 | acc=0.9688 | 3695.7 samples/s | 57.7 steps/s
[Step=4850 Epoch=46.0] | Loss=0.01052 | Reg=0.00217 | L2-Norm=14.737 | L2-Norm(final)=2.427 | acc=1.0000 | 3565.3 samples/s | 55.7 steps/s
[Step=4900 Epoch=46.4] | Loss=0.00726 | Reg=0.00218 | L2-Norm=14.763 | L2-Norm(final)=2.424 | acc=1.0000 | 5013.7 samples/s | 78.3 steps/s
[Step=4950 Epoch=46.9] | Loss=0.00529 | Reg=0.00218 | L2-Norm=14.766 | L2-Norm(final)=2.423 | acc=1.0000 | 1485.2 samples/s | 23.2 steps/s
[Step=5000 Epoch=47.4] | Loss=0.00398 | Reg=0.00218 | L2-Norm=14.758 | L2-Norm(final)=2.426 | acc=1.0000 | 4956.5 samples/s | 77.4 steps/s
[Step=5050 Epoch=47.9] | Loss=0.00319 | Reg=0.00217 | L2-Norm=14.742 | L2-Norm(final)=2.427 | acc=1.0000 | 1526.3 samples/s | 23.8 steps/s
[Step=5100 Epoch=48.3] | Loss=0.00266 | Reg=0.00217 | L2-Norm=14.721 | L2-Norm(final)=2.429 | acc=1.0000 | 4793.6 samples/s | 74.9 steps/s
[Step=5150 Epoch=48.8] | Loss=0.00228 | Reg=0.00216 | L2-Norm=14.699 | L2-Norm(final)=2.430 | acc=1.0000 | 1553.9 samples/s | 24.3 steps/s
[Step=5200 Epoch=49.3] | Loss=0.00200 | Reg=0.00215 | L2-Norm=14.675 | L2-Norm(final)=2.431 | acc=1.0000 | 4385.2 samples/s | 68.5 steps/s
[Step=5250 Epoch=49.7] | Loss=0.00178 | Reg=0.00215 | L2-Norm=14.649 | L2-Norm(final)=2.432 | acc=1.0000 | 1569.6 samples/s | 24.5 steps/s
[Step=5300 Epoch=50.2] | Loss=0.00160 | Reg=0.00214 | L2-Norm=14.624 | L2-Norm(final)=2.433 | acc=1.0000 | 4292.1 samples/s | 67.1 steps/s
[Step=5350 Epoch=50.7] | Loss=0.00145 | Reg=0.00213 | L2-Norm=14.598 | L2-Norm(final)=2.434 | acc=1.0000 | 1565.9 samples/s | 24.5 steps/s
[Step=5400 Epoch=51.2] | Loss=0.00133 | Reg=0.00212 | L2-Norm=14.571 | L2-Norm(final)=2.435 | acc=1.0000 | 4346.4 samples/s | 67.9 steps/s
[Step=5450 Epoch=51.6] | Loss=0.00123 | Reg=0.00212 | L2-Norm=14.544 | L2-Norm(final)=2.435 | acc=1.0000 | 1599.8 samples/s | 25.0 steps/s
[Step=5500 Epoch=52.1] | Loss=0.00114 | Reg=0.00211 | L2-Norm=14.517 | L2-Norm(final)=2.436 | acc=1.0000 | 4347.5 samples/s | 67.9 steps/s
[Step=5550 Epoch=52.6] | Loss=0.00107 | Reg=0.00210 | L2-Norm=14.490 | L2-Norm(final)=2.437 | acc=1.0000 | 1614.5 samples/s | 25.2 steps/s
[Step=5600 Epoch=53.1] | Loss=0.00100 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=2.437 | acc=1.0000 | 4239.2 samples/s | 66.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step5600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=4801 Epoch=45.7] | Loss=0.08290 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.429 | acc=0.9688 | 3759.2 samples/s | 58.7 steps/s
[Step=4850 Epoch=46.1] | Loss=0.01134 | Reg=0.00217 | L2-Norm=14.720 | L2-Norm(final)=2.415 | acc=1.0000 | 3963.2 samples/s | 61.9 steps/s
[Step=4900 Epoch=46.6] | Loss=0.00587 | Reg=0.00217 | L2-Norm=14.745 | L2-Norm(final)=2.422 | acc=1.0000 | 5053.2 samples/s | 79.0 steps/s
[Step=4950 Epoch=47.1] | Loss=0.00394 | Reg=0.00217 | L2-Norm=14.744 | L2-Norm(final)=2.428 | acc=1.0000 | 1505.4 samples/s | 23.5 steps/s
[Step=5000 Epoch=47.6] | Loss=0.00297 | Reg=0.00217 | L2-Norm=14.734 | L2-Norm(final)=2.431 | acc=1.0000 | 4838.9 samples/s | 75.6 steps/s
[Step=5050 Epoch=48.0] | Loss=0.00238 | Reg=0.00217 | L2-Norm=14.721 | L2-Norm(final)=2.434 | acc=1.0000 | 1529.6 samples/s | 23.9 steps/s
[Step=5100 Epoch=48.5] | Loss=0.00199 | Reg=0.00216 | L2-Norm=14.705 | L2-Norm(final)=2.436 | acc=1.0000 | 4577.2 samples/s | 71.5 steps/s
[Step=5150 Epoch=49.0] | Loss=0.00171 | Reg=0.00216 | L2-Norm=14.689 | L2-Norm(final)=2.438 | acc=1.0000 | 1550.4 samples/s | 24.2 steps/s
[Step=5200 Epoch=49.5] | Loss=0.00150 | Reg=0.00215 | L2-Norm=14.671 | L2-Norm(final)=2.439 | acc=1.0000 | 4510.9 samples/s | 70.5 steps/s
[Step=5250 Epoch=49.9] | Loss=0.00133 | Reg=0.00215 | L2-Norm=14.653 | L2-Norm(final)=2.441 | acc=1.0000 | 1556.5 samples/s | 24.3 steps/s
[Step=5300 Epoch=50.4] | Loss=0.00120 | Reg=0.00214 | L2-Norm=14.635 | L2-Norm(final)=2.442 | acc=1.0000 | 4223.5 samples/s | 66.0 steps/s
[Step=5350 Epoch=50.9] | Loss=0.00109 | Reg=0.00214 | L2-Norm=14.616 | L2-Norm(final)=2.443 | acc=1.0000 | 1585.6 samples/s | 24.8 steps/s
[Step=5400 Epoch=51.4] | Loss=0.00100 | Reg=0.00213 | L2-Norm=14.597 | L2-Norm(final)=2.444 | acc=1.0000 | 4336.0 samples/s | 67.7 steps/s
[Step=5450 Epoch=51.8] | Loss=0.00093 | Reg=0.00213 | L2-Norm=14.578 | L2-Norm(final)=2.445 | acc=1.0000 | 1586.7 samples/s | 24.8 steps/s
[Step=5500 Epoch=52.3] | Loss=0.00086 | Reg=0.00212 | L2-Norm=14.558 | L2-Norm(final)=2.446 | acc=1.0000 | 4161.2 samples/s | 65.0 steps/s
[Step=5550 Epoch=52.8] | Loss=0.00080 | Reg=0.00211 | L2-Norm=14.539 | L2-Norm(final)=2.447 | acc=1.0000 | 1614.6 samples/s | 25.2 steps/s
[Step=5600 Epoch=53.3] | Loss=0.00075 | Reg=0.00211 | L2-Norm=14.519 | L2-Norm(final)=2.448 | acc=1.0000 | 4146.6 samples/s | 64.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step5600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00050, len=1
[Step=3201 Epoch=30.5] | Loss=0.06249 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.429 | acc=0.9375 | 3675.6 samples/s | 57.4 steps/s
[Step=3250 Epoch=31.0] | Loss=0.01289 | Reg=0.00217 | L2-Norm=14.734 | L2-Norm(final)=2.429 | acc=1.0000 | 4136.7 samples/s | 64.6 steps/s
[Step=3300 Epoch=31.5] | Loss=0.00847 | Reg=0.00219 | L2-Norm=14.783 | L2-Norm(final)=2.422 | acc=1.0000 | 4946.8 samples/s | 77.3 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00572 | Reg=0.00219 | L2-Norm=14.796 | L2-Norm(final)=2.424 | acc=1.0000 | 1490.0 samples/s | 23.3 steps/s
[Step=3400 Epoch=32.4] | Loss=0.00430 | Reg=0.00219 | L2-Norm=14.793 | L2-Norm(final)=2.427 | acc=1.0000 | 4903.3 samples/s | 76.6 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00344 | Reg=0.00219 | L2-Norm=14.783 | L2-Norm(final)=2.429 | acc=1.0000 | 1541.1 samples/s | 24.1 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00287 | Reg=0.00218 | L2-Norm=14.769 | L2-Norm(final)=2.431 | acc=1.0000 | 4693.6 samples/s | 73.3 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00247 | Reg=0.00218 | L2-Norm=14.753 | L2-Norm(final)=2.432 | acc=1.0000 | 1541.7 samples/s | 24.1 steps/s
[Step=3600 Epoch=34.3] | Loss=0.00216 | Reg=0.00217 | L2-Norm=14.736 | L2-Norm(final)=2.434 | acc=1.0000 | 4520.1 samples/s | 70.6 steps/s
[Step=3650 Epoch=34.8] | Loss=0.00192 | Reg=0.00217 | L2-Norm=14.717 | L2-Norm(final)=2.435 | acc=1.0000 | 1506.9 samples/s | 23.5 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00173 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=2.436 | acc=1.0000 | 3875.3 samples/s | 60.6 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00157 | Reg=0.00215 | L2-Norm=14.678 | L2-Norm(final)=2.437 | acc=1.0000 | 1571.2 samples/s | 24.5 steps/s
[Step=3800 Epoch=36.2] | Loss=0.00144 | Reg=0.00215 | L2-Norm=14.657 | L2-Norm(final)=2.438 | acc=1.0000 | 4290.4 samples/s | 67.0 steps/s
[Step=3850 Epoch=36.7] | Loss=0.00133 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.439 | acc=1.0000 | 1589.5 samples/s | 24.8 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00124 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=2.440 | acc=1.0000 | 4244.7 samples/s | 66.3 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00116 | Reg=0.00213 | L2-Norm=14.594 | L2-Norm(final)=2.441 | acc=1.0000 | 1583.6 samples/s | 24.7 steps/s
[Step=4000 Epoch=38.1] | Loss=0.00108 | Reg=0.00212 | L2-Norm=14.573 | L2-Norm(final)=2.441 | acc=1.0000 | 4325.2 samples/s | 67.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.48985 | acc=0.6785 | tpr=0.5371 | fpr=0.0144 | 4509.1 samples/s | 17.6 steps/s
Avg test loss: 0.49307, Avg test acc: 0.67914, Avg tpr: 0.53984, Avg fpr: 0.01449, total FA: 113

Testing server on iccad2012
[Step=  50] | Loss=0.26183 | acc=0.8893 | tpr=0.9602 | fpr=0.1120 | 4366.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.26570 | acc=0.8883 | tpr=0.9638 | fpr=0.1131 | 8674.0 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.27000 | acc=0.8870 | tpr=0.9654 | fpr=0.1145 | 8794.9 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.27150 | acc=0.8871 | tpr=0.9672 | fpr=0.1144 | 8827.7 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.27061 | acc=0.8870 | tpr=0.9677 | fpr=0.1144 | 9626.0 samples/s | 37.6 steps/s
[Step= 300] | Loss=0.27275 | acc=0.8865 | tpr=0.9665 | fpr=0.1150 | 8418.5 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.27349 | acc=0.8861 | tpr=0.9668 | fpr=0.1153 | 8712.9 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.27467 | acc=0.8864 | tpr=0.9683 | fpr=0.1151 | 8513.4 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.27797 | acc=0.8858 | tpr=0.9679 | fpr=0.1157 | 8575.1 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.27792 | acc=0.8852 | tpr=0.9683 | fpr=0.1163 | 8537.0 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.27752 | acc=0.8850 | tpr=0.9678 | fpr=0.1165 | 16477.1 samples/s | 64.4 steps/s
Avg test loss: 0.27725, Avg test acc: 0.88511, Avg tpr: 0.96751, Avg fpr: 0.11639, total FA: 16160

server round 12/50

clients selected: [0 1 2 3 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.33958 | Reg=0.00211 | L2-Norm=14.539 | L2-Norm(final)=2.467 | acc=0.7969 | 3722.5 samples/s | 58.2 steps/s
[Step=5650 Epoch=27.6] | Loss=0.07135 | Reg=0.00213 | L2-Norm=14.605 | L2-Norm(final)=2.451 | acc=0.9531 | 4555.9 samples/s | 71.2 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05596 | Reg=0.00214 | L2-Norm=14.633 | L2-Norm(final)=2.454 | acc=0.9844 | 4436.5 samples/s | 69.3 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04808 | Reg=0.00215 | L2-Norm=14.652 | L2-Norm(final)=2.461 | acc=0.9844 | 4433.6 samples/s | 69.3 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04419 | Reg=0.00215 | L2-Norm=14.668 | L2-Norm(final)=2.468 | acc=0.9531 | 5153.2 samples/s | 80.5 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03944 | Reg=0.00216 | L2-Norm=14.683 | L2-Norm(final)=2.475 | acc=1.0000 | 1543.0 samples/s | 24.1 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03553 | Reg=0.00216 | L2-Norm=14.699 | L2-Norm(final)=2.484 | acc=1.0000 | 4484.0 samples/s | 70.1 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03289 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=2.492 | acc=0.9688 | 4380.9 samples/s | 68.5 steps/s
[Step=6000 Epoch=29.3] | Loss=0.03113 | Reg=0.00217 | L2-Norm=14.725 | L2-Norm(final)=2.500 | acc=1.0000 | 4917.7 samples/s | 76.8 steps/s
[Step=6050 Epoch=29.5] | Loss=0.02891 | Reg=0.00217 | L2-Norm=14.735 | L2-Norm(final)=2.506 | acc=1.0000 | 1602.4 samples/s | 25.0 steps/s
[Step=6100 Epoch=29.7] | Loss=0.02719 | Reg=0.00217 | L2-Norm=14.745 | L2-Norm(final)=2.513 | acc=0.9844 | 4518.4 samples/s | 70.6 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02558 | Reg=0.00218 | L2-Norm=14.753 | L2-Norm(final)=2.520 | acc=0.9844 | 4435.2 samples/s | 69.3 steps/s
[Step=6200 Epoch=30.2] | Loss=0.02464 | Reg=0.00218 | L2-Norm=14.762 | L2-Norm(final)=2.526 | acc=0.9688 | 4779.5 samples/s | 74.7 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02353 | Reg=0.00218 | L2-Norm=14.770 | L2-Norm(final)=2.532 | acc=1.0000 | 1587.5 samples/s | 24.8 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02264 | Reg=0.00218 | L2-Norm=14.777 | L2-Norm(final)=2.537 | acc=1.0000 | 4461.2 samples/s | 69.7 steps/s
[Step=6350 Epoch=31.0] | Loss=0.02152 | Reg=0.00219 | L2-Norm=14.783 | L2-Norm(final)=2.543 | acc=1.0000 | 4480.2 samples/s | 70.0 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02076 | Reg=0.00219 | L2-Norm=14.790 | L2-Norm(final)=2.549 | acc=1.0000 | 4660.7 samples/s | 72.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step6400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.25863 | Reg=0.00211 | L2-Norm=14.539 | L2-Norm(final)=2.468 | acc=0.7969 | 3954.8 samples/s | 61.8 steps/s
[Step=4850 Epoch=23.7] | Loss=0.08243 | Reg=0.00213 | L2-Norm=14.600 | L2-Norm(final)=2.438 | acc=0.9375 | 4192.3 samples/s | 65.5 steps/s
[Step=4900 Epoch=23.9] | Loss=0.06475 | Reg=0.00214 | L2-Norm=14.634 | L2-Norm(final)=2.442 | acc=0.9531 | 4476.1 samples/s | 69.9 steps/s
[Step=4950 Epoch=24.2] | Loss=0.05556 | Reg=0.00215 | L2-Norm=14.661 | L2-Norm(final)=2.451 | acc=0.9844 | 4369.2 samples/s | 68.3 steps/s
[Step=5000 Epoch=24.4] | Loss=0.05102 | Reg=0.00216 | L2-Norm=14.680 | L2-Norm(final)=2.456 | acc=1.0000 | 5180.9 samples/s | 81.0 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04499 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=2.461 | acc=0.9844 | 1458.6 samples/s | 22.8 steps/s
[Step=5100 Epoch=24.9] | Loss=0.04034 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.469 | acc=1.0000 | 4086.6 samples/s | 63.9 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03721 | Reg=0.00217 | L2-Norm=14.729 | L2-Norm(final)=2.476 | acc=1.0000 | 4440.9 samples/s | 69.4 steps/s
[Step=5200 Epoch=25.4] | Loss=0.03514 | Reg=0.00217 | L2-Norm=14.742 | L2-Norm(final)=2.482 | acc=1.0000 | 5036.6 samples/s | 78.7 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03279 | Reg=0.00218 | L2-Norm=14.754 | L2-Norm(final)=2.488 | acc=0.9844 | 1543.2 samples/s | 24.1 steps/s
[Step=5300 Epoch=25.9] | Loss=0.03032 | Reg=0.00218 | L2-Norm=14.765 | L2-Norm(final)=2.494 | acc=1.0000 | 4413.2 samples/s | 69.0 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02869 | Reg=0.00218 | L2-Norm=14.776 | L2-Norm(final)=2.501 | acc=0.9844 | 4370.6 samples/s | 68.3 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02731 | Reg=0.00219 | L2-Norm=14.785 | L2-Norm(final)=2.507 | acc=0.9844 | 4916.1 samples/s | 76.8 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02658 | Reg=0.00219 | L2-Norm=14.793 | L2-Norm(final)=2.512 | acc=0.9844 | 1593.3 samples/s | 24.9 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02519 | Reg=0.00219 | L2-Norm=14.801 | L2-Norm(final)=2.517 | acc=1.0000 | 4485.5 samples/s | 70.1 steps/s
[Step=5550 Epoch=27.1] | Loss=0.02417 | Reg=0.00219 | L2-Norm=14.807 | L2-Norm(final)=2.521 | acc=1.0000 | 4400.6 samples/s | 68.8 steps/s
[Step=5600 Epoch=27.3] | Loss=0.02333 | Reg=0.00219 | L2-Norm=14.813 | L2-Norm(final)=2.526 | acc=1.0000 | 4800.9 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step5600.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.41934 | Reg=0.00211 | L2-Norm=14.539 | L2-Norm(final)=2.467 | acc=0.7031 | 3345.1 samples/s | 52.3 steps/s
[Step=4850 Epoch=23.6] | Loss=0.07182 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=2.448 | acc=0.9531 | 3908.9 samples/s | 61.1 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05998 | Reg=0.00213 | L2-Norm=14.611 | L2-Norm(final)=2.451 | acc=0.9688 | 3923.7 samples/s | 61.3 steps/s
[Step=4950 Epoch=24.1] | Loss=0.05301 | Reg=0.00214 | L2-Norm=14.630 | L2-Norm(final)=2.457 | acc=1.0000 | 3888.7 samples/s | 60.8 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04860 | Reg=0.00215 | L2-Norm=14.649 | L2-Norm(final)=2.463 | acc=0.9375 | 4869.6 samples/s | 76.1 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04277 | Reg=0.00215 | L2-Norm=14.665 | L2-Norm(final)=2.471 | acc=0.9688 | 1557.3 samples/s | 24.3 steps/s
[Step=5100 Epoch=24.8] | Loss=0.03830 | Reg=0.00216 | L2-Norm=14.682 | L2-Norm(final)=2.480 | acc=1.0000 | 4534.9 samples/s | 70.9 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03595 | Reg=0.00216 | L2-Norm=14.697 | L2-Norm(final)=2.488 | acc=0.9844 | 4509.2 samples/s | 70.5 steps/s
[Step=5200 Epoch=25.3] | Loss=0.03398 | Reg=0.00216 | L2-Norm=14.711 | L2-Norm(final)=2.495 | acc=1.0000 | 5027.7 samples/s | 78.6 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03145 | Reg=0.00217 | L2-Norm=14.724 | L2-Norm(final)=2.502 | acc=0.9844 | 1577.5 samples/s | 24.6 steps/s
[Step=5300 Epoch=25.8] | Loss=0.02958 | Reg=0.00217 | L2-Norm=14.737 | L2-Norm(final)=2.509 | acc=0.9844 | 4373.6 samples/s | 68.3 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02819 | Reg=0.00218 | L2-Norm=14.748 | L2-Norm(final)=2.516 | acc=0.9844 | 4427.7 samples/s | 69.2 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02694 | Reg=0.00218 | L2-Norm=14.760 | L2-Norm(final)=2.523 | acc=0.9844 | 4810.1 samples/s | 75.2 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02574 | Reg=0.00218 | L2-Norm=14.771 | L2-Norm(final)=2.529 | acc=1.0000 | 1575.9 samples/s | 24.6 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02473 | Reg=0.00218 | L2-Norm=14.781 | L2-Norm(final)=2.534 | acc=1.0000 | 4430.4 samples/s | 69.2 steps/s
[Step=5550 Epoch=27.0] | Loss=0.02383 | Reg=0.00219 | L2-Norm=14.790 | L2-Norm(final)=2.540 | acc=1.0000 | 4385.3 samples/s | 68.5 steps/s
[Step=5600 Epoch=27.3] | Loss=0.02297 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.545 | acc=1.0000 | 4612.6 samples/s | 72.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step5600.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00050, len=1
[Step=4001 Epoch=19.5] | Loss=0.32362 | Reg=0.00211 | L2-Norm=14.539 | L2-Norm(final)=2.467 | acc=0.7812 | 3985.1 samples/s | 62.3 steps/s
[Step=4050 Epoch=19.8] | Loss=0.07474 | Reg=0.00213 | L2-Norm=14.594 | L2-Norm(final)=2.449 | acc=0.9844 | 4211.1 samples/s | 65.8 steps/s
[Step=4100 Epoch=20.0] | Loss=0.05855 | Reg=0.00214 | L2-Norm=14.621 | L2-Norm(final)=2.453 | acc=0.9531 | 4409.2 samples/s | 68.9 steps/s
[Step=4150 Epoch=20.2] | Loss=0.05076 | Reg=0.00214 | L2-Norm=14.636 | L2-Norm(final)=2.458 | acc=0.9844 | 4442.3 samples/s | 69.4 steps/s
[Step=4200 Epoch=20.5] | Loss=0.04547 | Reg=0.00215 | L2-Norm=14.651 | L2-Norm(final)=2.466 | acc=0.9688 | 5187.7 samples/s | 81.1 steps/s
[Step=4250 Epoch=20.7] | Loss=0.03962 | Reg=0.00215 | L2-Norm=14.665 | L2-Norm(final)=2.475 | acc=1.0000 | 1546.4 samples/s | 24.2 steps/s
[Step=4300 Epoch=21.0] | Loss=0.03602 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=2.483 | acc=0.9688 | 4410.9 samples/s | 68.9 steps/s
[Step=4350 Epoch=21.2] | Loss=0.03322 | Reg=0.00216 | L2-Norm=14.688 | L2-Norm(final)=2.491 | acc=1.0000 | 4447.6 samples/s | 69.5 steps/s
[Step=4400 Epoch=21.5] | Loss=0.03091 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=2.499 | acc=0.9844 | 4986.5 samples/s | 77.9 steps/s
[Step=4450 Epoch=21.7] | Loss=0.02902 | Reg=0.00216 | L2-Norm=14.708 | L2-Norm(final)=2.506 | acc=1.0000 | 1513.8 samples/s | 23.7 steps/s
[Step=4500 Epoch=21.9] | Loss=0.02730 | Reg=0.00217 | L2-Norm=14.718 | L2-Norm(final)=2.514 | acc=0.9688 | 3794.2 samples/s | 59.3 steps/s
[Step=4550 Epoch=22.2] | Loss=0.02564 | Reg=0.00217 | L2-Norm=14.727 | L2-Norm(final)=2.521 | acc=1.0000 | 3892.8 samples/s | 60.8 steps/s
[Step=4600 Epoch=22.4] | Loss=0.02438 | Reg=0.00217 | L2-Norm=14.735 | L2-Norm(final)=2.529 | acc=1.0000 | 4303.0 samples/s | 67.2 steps/s
[Step=4650 Epoch=22.7] | Loss=0.02364 | Reg=0.00217 | L2-Norm=14.743 | L2-Norm(final)=2.535 | acc=0.9844 | 1594.2 samples/s | 24.9 steps/s
[Step=4700 Epoch=22.9] | Loss=0.02241 | Reg=0.00218 | L2-Norm=14.750 | L2-Norm(final)=2.541 | acc=1.0000 | 4431.3 samples/s | 69.2 steps/s
[Step=4750 Epoch=23.2] | Loss=0.02143 | Reg=0.00218 | L2-Norm=14.757 | L2-Norm(final)=2.548 | acc=0.9844 | 4346.6 samples/s | 67.9 steps/s
[Step=4800 Epoch=23.4] | Loss=0.02074 | Reg=0.00218 | L2-Norm=14.764 | L2-Norm(final)=2.554 | acc=1.0000 | 4163.4 samples/s | 65.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step4800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00050, len=1
[Step=4001 Epoch=38.1] | Loss=0.07215 | Reg=0.00211 | L2-Norm=14.539 | L2-Norm(final)=2.468 | acc=0.9688 | 3581.3 samples/s | 56.0 steps/s
[Step=4050 Epoch=38.6] | Loss=0.01134 | Reg=0.00214 | L2-Norm=14.628 | L2-Norm(final)=2.452 | acc=1.0000 | 4030.5 samples/s | 63.0 steps/s
[Step=4100 Epoch=39.1] | Loss=0.00837 | Reg=0.00215 | L2-Norm=14.664 | L2-Norm(final)=2.453 | acc=1.0000 | 5178.1 samples/s | 80.9 steps/s
[Step=4150 Epoch=39.6] | Loss=0.00568 | Reg=0.00215 | L2-Norm=14.679 | L2-Norm(final)=2.457 | acc=1.0000 | 1507.4 samples/s | 23.6 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00428 | Reg=0.00215 | L2-Norm=14.678 | L2-Norm(final)=2.461 | acc=1.0000 | 4874.4 samples/s | 76.2 steps/s
[Step=4250 Epoch=40.5] | Loss=0.00343 | Reg=0.00215 | L2-Norm=14.668 | L2-Norm(final)=2.464 | acc=1.0000 | 1515.7 samples/s | 23.7 steps/s
[Step=4300 Epoch=41.0] | Loss=0.00286 | Reg=0.00215 | L2-Norm=14.654 | L2-Norm(final)=2.466 | acc=1.0000 | 4676.6 samples/s | 73.1 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00246 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.468 | acc=1.0000 | 1536.3 samples/s | 24.0 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00215 | Reg=0.00214 | L2-Norm=14.619 | L2-Norm(final)=2.470 | acc=1.0000 | 4566.7 samples/s | 71.4 steps/s
[Step=4450 Epoch=42.4] | Loss=0.00192 | Reg=0.00213 | L2-Norm=14.599 | L2-Norm(final)=2.471 | acc=1.0000 | 1546.6 samples/s | 24.2 steps/s
[Step=4500 Epoch=42.9] | Loss=0.00173 | Reg=0.00213 | L2-Norm=14.579 | L2-Norm(final)=2.473 | acc=1.0000 | 4459.9 samples/s | 69.7 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00157 | Reg=0.00212 | L2-Norm=14.559 | L2-Norm(final)=2.474 | acc=1.0000 | 1699.1 samples/s | 26.5 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00144 | Reg=0.00211 | L2-Norm=14.537 | L2-Norm(final)=2.475 | acc=1.0000 | 4344.5 samples/s | 67.9 steps/s
[Step=4650 Epoch=44.3] | Loss=0.00133 | Reg=0.00211 | L2-Norm=14.516 | L2-Norm(final)=2.476 | acc=1.0000 | 1576.4 samples/s | 24.6 steps/s
[Step=4700 Epoch=44.8] | Loss=0.00124 | Reg=0.00210 | L2-Norm=14.494 | L2-Norm(final)=2.477 | acc=1.0000 | 4323.0 samples/s | 67.5 steps/s
[Step=4750 Epoch=45.3] | Loss=0.00115 | Reg=0.00209 | L2-Norm=14.472 | L2-Norm(final)=2.478 | acc=1.0000 | 1585.8 samples/s | 24.8 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00108 | Reg=0.00209 | L2-Norm=14.450 | L2-Norm(final)=2.479 | acc=1.0000 | 4276.5 samples/s | 66.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.49120 | acc=0.6811 | tpr=0.5416 | fpr=0.0161 | 4392.3 samples/s | 17.2 steps/s
Avg test loss: 0.49494, Avg test acc: 0.68034, Avg tpr: 0.54246, Avg fpr: 0.01641, total FA: 128

Testing server on iccad2012
[Step=  50] | Loss=0.29344 | acc=0.8840 | tpr=0.9602 | fpr=0.1174 | 4337.8 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.29897 | acc=0.8830 | tpr=0.9701 | fpr=0.1187 | 8788.7 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.30485 | acc=0.8815 | tpr=0.9741 | fpr=0.1202 | 8699.4 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.30627 | acc=0.8813 | tpr=0.9749 | fpr=0.1204 | 9146.4 samples/s | 35.7 steps/s
[Step= 250] | Loss=0.30563 | acc=0.8814 | tpr=0.9747 | fpr=0.1203 | 8523.9 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.30781 | acc=0.8810 | tpr=0.9745 | fpr=0.1208 | 8956.7 samples/s | 35.0 steps/s
[Step= 350] | Loss=0.30847 | acc=0.8809 | tpr=0.9743 | fpr=0.1208 | 9308.5 samples/s | 36.4 steps/s
[Step= 400] | Loss=0.30995 | acc=0.8810 | tpr=0.9748 | fpr=0.1207 | 7973.9 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.31376 | acc=0.8804 | tpr=0.9742 | fpr=0.1213 | 8546.9 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.31367 | acc=0.8795 | tpr=0.9744 | fpr=0.1222 | 9097.0 samples/s | 35.5 steps/s
[Step= 550] | Loss=0.31326 | acc=0.8794 | tpr=0.9741 | fpr=0.1223 | 15101.2 samples/s | 59.0 steps/s
Avg test loss: 0.31299, Avg test acc: 0.87944, Avg tpr: 0.97385, Avg fpr: 0.12228, total FA: 16978

server round 13/50

clients selected: [0 3 5 7 8]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=6401 Epoch=31.2] | Loss=0.19186 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=2.511 | acc=0.7812 | 3698.3 samples/s | 57.8 steps/s
[Step=6450 Epoch=31.5] | Loss=0.06615 | Reg=0.00209 | L2-Norm=14.443 | L2-Norm(final)=2.493 | acc=0.9844 | 4519.7 samples/s | 70.6 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05753 | Reg=0.00210 | L2-Norm=14.475 | L2-Norm(final)=2.497 | acc=0.9531 | 4363.5 samples/s | 68.2 steps/s
[Step=6550 Epoch=31.9] | Loss=0.05165 | Reg=0.00210 | L2-Norm=14.499 | L2-Norm(final)=2.502 | acc=0.9844 | 4395.8 samples/s | 68.7 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04462 | Reg=0.00211 | L2-Norm=14.517 | L2-Norm(final)=2.506 | acc=0.9531 | 5300.4 samples/s | 82.8 steps/s
[Step=6650 Epoch=32.4] | Loss=0.03952 | Reg=0.00211 | L2-Norm=14.537 | L2-Norm(final)=2.514 | acc=1.0000 | 1568.5 samples/s | 24.5 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03558 | Reg=0.00212 | L2-Norm=14.554 | L2-Norm(final)=2.523 | acc=0.9844 | 4506.2 samples/s | 70.4 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03295 | Reg=0.00212 | L2-Norm=14.570 | L2-Norm(final)=2.531 | acc=0.9688 | 4433.3 samples/s | 69.3 steps/s
[Step=6800 Epoch=33.2] | Loss=0.03134 | Reg=0.00213 | L2-Norm=14.583 | L2-Norm(final)=2.538 | acc=0.9844 | 4966.5 samples/s | 77.6 steps/s
[Step=6850 Epoch=33.4] | Loss=0.02905 | Reg=0.00213 | L2-Norm=14.595 | L2-Norm(final)=2.545 | acc=1.0000 | 1546.1 samples/s | 24.2 steps/s
[Step=6900 Epoch=33.6] | Loss=0.02726 | Reg=0.00213 | L2-Norm=14.607 | L2-Norm(final)=2.553 | acc=0.9844 | 4398.2 samples/s | 68.7 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02620 | Reg=0.00214 | L2-Norm=14.617 | L2-Norm(final)=2.559 | acc=0.9844 | 4422.9 samples/s | 69.1 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02502 | Reg=0.00214 | L2-Norm=14.626 | L2-Norm(final)=2.565 | acc=1.0000 | 4319.6 samples/s | 67.5 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02381 | Reg=0.00214 | L2-Norm=14.635 | L2-Norm(final)=2.571 | acc=1.0000 | 1543.3 samples/s | 24.1 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02271 | Reg=0.00214 | L2-Norm=14.643 | L2-Norm(final)=2.578 | acc=1.0000 | 3868.7 samples/s | 60.4 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02192 | Reg=0.00215 | L2-Norm=14.651 | L2-Norm(final)=2.584 | acc=0.9844 | 3898.9 samples/s | 60.9 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02128 | Reg=0.00215 | L2-Norm=14.658 | L2-Norm(final)=2.590 | acc=0.9844 | 4166.6 samples/s | 65.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step7200.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00050, len=1
[Step=4801 Epoch=23.4] | Loss=0.34930 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=2.511 | acc=0.7031 | 3473.2 samples/s | 54.3 steps/s
[Step=4850 Epoch=23.7] | Loss=0.08075 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=2.484 | acc=0.9688 | 4193.6 samples/s | 65.5 steps/s
[Step=4900 Epoch=23.9] | Loss=0.06077 | Reg=0.00210 | L2-Norm=14.504 | L2-Norm(final)=2.493 | acc=0.9688 | 4417.1 samples/s | 69.0 steps/s
[Step=4950 Epoch=24.1] | Loss=0.05169 | Reg=0.00211 | L2-Norm=14.530 | L2-Norm(final)=2.503 | acc=0.9531 | 4311.4 samples/s | 67.4 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04707 | Reg=0.00212 | L2-Norm=14.551 | L2-Norm(final)=2.512 | acc=0.9844 | 5312.9 samples/s | 83.0 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04128 | Reg=0.00212 | L2-Norm=14.570 | L2-Norm(final)=2.521 | acc=0.9688 | 1562.7 samples/s | 24.4 steps/s
[Step=5100 Epoch=24.9] | Loss=0.03703 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=2.531 | acc=0.9844 | 4411.0 samples/s | 68.9 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03399 | Reg=0.00213 | L2-Norm=14.604 | L2-Norm(final)=2.541 | acc=1.0000 | 4439.9 samples/s | 69.4 steps/s
[Step=5200 Epoch=25.4] | Loss=0.03182 | Reg=0.00214 | L2-Norm=14.621 | L2-Norm(final)=2.551 | acc=0.9844 | 4923.8 samples/s | 76.9 steps/s
[Step=5250 Epoch=25.6] | Loss=0.02991 | Reg=0.00214 | L2-Norm=14.634 | L2-Norm(final)=2.558 | acc=1.0000 | 1514.5 samples/s | 23.7 steps/s
[Step=5300 Epoch=25.8] | Loss=0.02829 | Reg=0.00214 | L2-Norm=14.645 | L2-Norm(final)=2.565 | acc=0.9844 | 3878.4 samples/s | 60.6 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02667 | Reg=0.00215 | L2-Norm=14.656 | L2-Norm(final)=2.572 | acc=0.9688 | 3878.3 samples/s | 60.6 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02547 | Reg=0.00215 | L2-Norm=14.666 | L2-Norm(final)=2.579 | acc=1.0000 | 4418.0 samples/s | 69.0 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02438 | Reg=0.00215 | L2-Norm=14.675 | L2-Norm(final)=2.585 | acc=0.9844 | 1557.5 samples/s | 24.3 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02346 | Reg=0.00216 | L2-Norm=14.684 | L2-Norm(final)=2.591 | acc=0.9844 | 4378.6 samples/s | 68.4 steps/s
[Step=5550 Epoch=27.1] | Loss=0.02250 | Reg=0.00216 | L2-Norm=14.692 | L2-Norm(final)=2.596 | acc=1.0000 | 4337.5 samples/s | 67.8 steps/s
[Step=5600 Epoch=27.3] | Loss=0.02176 | Reg=0.00216 | L2-Norm=14.699 | L2-Norm(final)=2.602 | acc=0.9844 | 4666.9 samples/s | 72.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step5600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=5601 Epoch=53.1] | Loss=0.02403 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=2.512 | acc=0.9688 | 3936.4 samples/s | 61.5 steps/s
[Step=5650 Epoch=53.5] | Loss=0.01007 | Reg=0.00210 | L2-Norm=14.476 | L2-Norm(final)=2.505 | acc=1.0000 | 3875.8 samples/s | 60.6 steps/s
[Step=5700 Epoch=54.0] | Loss=0.00759 | Reg=0.00211 | L2-Norm=14.518 | L2-Norm(final)=2.493 | acc=1.0000 | 5035.4 samples/s | 78.7 steps/s
[Step=5750 Epoch=54.5] | Loss=0.00516 | Reg=0.00211 | L2-Norm=14.534 | L2-Norm(final)=2.491 | acc=1.0000 | 1439.7 samples/s | 22.5 steps/s
[Step=5800 Epoch=55.0] | Loss=0.00389 | Reg=0.00211 | L2-Norm=14.532 | L2-Norm(final)=2.493 | acc=1.0000 | 4415.6 samples/s | 69.0 steps/s
[Step=5850 Epoch=55.4] | Loss=0.00312 | Reg=0.00211 | L2-Norm=14.522 | L2-Norm(final)=2.496 | acc=1.0000 | 1530.1 samples/s | 23.9 steps/s
[Step=5900 Epoch=55.9] | Loss=0.00260 | Reg=0.00210 | L2-Norm=14.506 | L2-Norm(final)=2.497 | acc=1.0000 | 4653.7 samples/s | 72.7 steps/s
[Step=5950 Epoch=56.4] | Loss=0.00223 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=2.499 | acc=1.0000 | 1545.9 samples/s | 24.2 steps/s
[Step=6000 Epoch=56.9] | Loss=0.00196 | Reg=0.00209 | L2-Norm=14.468 | L2-Norm(final)=2.501 | acc=1.0000 | 4494.2 samples/s | 70.2 steps/s
[Step=6050 Epoch=57.3] | Loss=0.00174 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=2.502 | acc=1.0000 | 1572.4 samples/s | 24.6 steps/s
[Step=6100 Epoch=57.8] | Loss=0.00157 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=2.503 | acc=1.0000 | 4355.6 samples/s | 68.1 steps/s
[Step=6150 Epoch=58.3] | Loss=0.00143 | Reg=0.00207 | L2-Norm=14.403 | L2-Norm(final)=2.504 | acc=1.0000 | 1574.9 samples/s | 24.6 steps/s
[Step=6200 Epoch=58.8] | Loss=0.00131 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=2.505 | acc=1.0000 | 4316.3 samples/s | 67.4 steps/s
[Step=6250 Epoch=59.2] | Loss=0.00121 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=2.506 | acc=1.0000 | 1590.4 samples/s | 24.8 steps/s
[Step=6300 Epoch=59.7] | Loss=0.00112 | Reg=0.00205 | L2-Norm=14.334 | L2-Norm(final)=2.507 | acc=1.0000 | 4297.3 samples/s | 67.1 steps/s
[Step=6350 Epoch=60.2] | Loss=0.00105 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=2.508 | acc=1.0000 | 1603.4 samples/s | 25.1 steps/s
[Step=6400 Epoch=60.6] | Loss=0.00098 | Reg=0.00204 | L2-Norm=14.287 | L2-Norm(final)=2.509 | acc=1.0000 | 4271.0 samples/s | 66.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step6400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00050, len=1
[Step=4001 Epoch=38.2] | Loss=0.07447 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=2.511 | acc=0.9844 | 4040.9 samples/s | 63.1 steps/s
[Step=4050 Epoch=38.7] | Loss=0.00489 | Reg=0.00208 | L2-Norm=14.418 | L2-Norm(final)=2.513 | acc=1.0000 | 3782.0 samples/s | 59.1 steps/s
[Step=4100 Epoch=39.2] | Loss=0.00341 | Reg=0.00208 | L2-Norm=14.429 | L2-Norm(final)=2.513 | acc=1.0000 | 5017.7 samples/s | 78.4 steps/s
[Step=4150 Epoch=39.6] | Loss=0.00229 | Reg=0.00208 | L2-Norm=14.428 | L2-Norm(final)=2.515 | acc=1.0000 | 1510.3 samples/s | 23.6 steps/s
[Step=4200 Epoch=40.1] | Loss=0.00173 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=2.516 | acc=1.0000 | 4966.9 samples/s | 77.6 steps/s
[Step=4250 Epoch=40.6] | Loss=0.00138 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=2.517 | acc=1.0000 | 1516.6 samples/s | 23.7 steps/s
[Step=4300 Epoch=41.1] | Loss=0.00116 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=2.518 | acc=1.0000 | 4810.6 samples/s | 75.2 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00099 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=2.519 | acc=1.0000 | 1517.3 samples/s | 23.7 steps/s
[Step=4400 Epoch=42.0] | Loss=0.00087 | Reg=0.00206 | L2-Norm=14.367 | L2-Norm(final)=2.519 | acc=1.0000 | 4566.4 samples/s | 71.3 steps/s
[Step=4450 Epoch=42.5] | Loss=0.00077 | Reg=0.00206 | L2-Norm=14.352 | L2-Norm(final)=2.520 | acc=1.0000 | 1546.2 samples/s | 24.2 steps/s
[Step=4500 Epoch=43.0] | Loss=0.00070 | Reg=0.00206 | L2-Norm=14.336 | L2-Norm(final)=2.520 | acc=1.0000 | 4367.1 samples/s | 68.2 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00063 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=2.521 | acc=1.0000 | 1548.8 samples/s | 24.2 steps/s
[Step=4600 Epoch=43.9] | Loss=0.00058 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=2.521 | acc=1.0000 | 4282.1 samples/s | 66.9 steps/s
[Step=4650 Epoch=44.4] | Loss=0.00054 | Reg=0.00204 | L2-Norm=14.288 | L2-Norm(final)=2.521 | acc=1.0000 | 1572.2 samples/s | 24.6 steps/s
[Step=4700 Epoch=44.9] | Loss=0.00050 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=2.522 | acc=1.0000 | 4218.9 samples/s | 65.9 steps/s
[Step=4750 Epoch=45.4] | Loss=0.00047 | Reg=0.00203 | L2-Norm=14.254 | L2-Norm(final)=2.522 | acc=1.0000 | 1568.2 samples/s | 24.5 steps/s
[Step=4800 Epoch=45.8] | Loss=0.00044 | Reg=0.00203 | L2-Norm=14.237 | L2-Norm(final)=2.523 | acc=1.0000 | 4234.4 samples/s | 66.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step4800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00050, len=1
[Step=4001 Epoch=37.7] | Loss=0.06705 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=2.511 | acc=0.9688 | 3776.5 samples/s | 59.0 steps/s
[Step=4050 Epoch=38.2] | Loss=0.00578 | Reg=0.00209 | L2-Norm=14.448 | L2-Norm(final)=2.510 | acc=1.0000 | 4026.3 samples/s | 62.9 steps/s
[Step=4100 Epoch=38.6] | Loss=0.00373 | Reg=0.00209 | L2-Norm=14.464 | L2-Norm(final)=2.514 | acc=1.0000 | 5050.7 samples/s | 78.9 steps/s
[Step=4150 Epoch=39.1] | Loss=0.00251 | Reg=0.00209 | L2-Norm=14.465 | L2-Norm(final)=2.518 | acc=1.0000 | 1506.8 samples/s | 23.5 steps/s
[Step=4200 Epoch=39.6] | Loss=0.00189 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=2.521 | acc=1.0000 | 4827.6 samples/s | 75.4 steps/s
[Step=4250 Epoch=40.0] | Loss=0.00152 | Reg=0.00209 | L2-Norm=14.448 | L2-Norm(final)=2.523 | acc=1.0000 | 1551.4 samples/s | 24.2 steps/s
[Step=4300 Epoch=40.5] | Loss=0.00127 | Reg=0.00208 | L2-Norm=14.436 | L2-Norm(final)=2.525 | acc=1.0000 | 4618.6 samples/s | 72.2 steps/s
[Step=4350 Epoch=41.0] | Loss=0.00109 | Reg=0.00208 | L2-Norm=14.422 | L2-Norm(final)=2.526 | acc=1.0000 | 1551.5 samples/s | 24.2 steps/s
[Step=4400 Epoch=41.5] | Loss=0.00096 | Reg=0.00208 | L2-Norm=14.408 | L2-Norm(final)=2.527 | acc=1.0000 | 4458.1 samples/s | 69.7 steps/s
[Step=4450 Epoch=41.9] | Loss=0.00085 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=2.528 | acc=1.0000 | 1562.2 samples/s | 24.4 steps/s
[Step=4500 Epoch=42.4] | Loss=0.00077 | Reg=0.00207 | L2-Norm=14.379 | L2-Norm(final)=2.529 | acc=1.0000 | 4288.0 samples/s | 67.0 steps/s
[Step=4550 Epoch=42.9] | Loss=0.00070 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=2.530 | acc=1.0000 | 1597.5 samples/s | 25.0 steps/s
[Step=4600 Epoch=43.3] | Loss=0.00064 | Reg=0.00206 | L2-Norm=14.348 | L2-Norm(final)=2.531 | acc=1.0000 | 4253.9 samples/s | 66.5 steps/s
[Step=4650 Epoch=43.8] | Loss=0.00060 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=2.532 | acc=1.0000 | 1600.0 samples/s | 25.0 steps/s
[Step=4700 Epoch=44.3] | Loss=0.00055 | Reg=0.00205 | L2-Norm=14.316 | L2-Norm(final)=2.532 | acc=1.0000 | 4236.4 samples/s | 66.2 steps/s
[Step=4750 Epoch=44.8] | Loss=0.00052 | Reg=0.00205 | L2-Norm=14.300 | L2-Norm(final)=2.533 | acc=1.0000 | 1630.5 samples/s | 25.5 steps/s
[Step=4800 Epoch=45.2] | Loss=0.00049 | Reg=0.00204 | L2-Norm=14.283 | L2-Norm(final)=2.534 | acc=1.0000 | 3978.5 samples/s | 62.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42661 | acc=0.7208 | tpr=0.5981 | fpr=0.0129 | 4386.6 samples/s | 17.1 steps/s
Avg test loss: 0.43118, Avg test acc: 0.72149, Avg tpr: 0.60121, Avg fpr: 0.01397, total FA: 109

Testing server on iccad2012
[Step=  50] | Loss=0.31414 | acc=0.8759 | tpr=0.9602 | fpr=0.1256 | 4386.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.32024 | acc=0.8752 | tpr=0.9680 | fpr=0.1265 | 8984.0 samples/s | 35.1 steps/s
[Step= 150] | Loss=0.32628 | acc=0.8737 | tpr=0.9726 | fpr=0.1281 | 8732.6 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.32805 | acc=0.8732 | tpr=0.9727 | fpr=0.1286 | 9266.8 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.32744 | acc=0.8730 | tpr=0.9712 | fpr=0.1288 | 8286.4 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.33010 | acc=0.8723 | tpr=0.9716 | fpr=0.1295 | 8748.8 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.33081 | acc=0.8722 | tpr=0.9718 | fpr=0.1296 | 8770.9 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.33245 | acc=0.8722 | tpr=0.9721 | fpr=0.1296 | 8645.0 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.33637 | acc=0.8717 | tpr=0.9718 | fpr=0.1301 | 8833.3 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.33646 | acc=0.8709 | tpr=0.9727 | fpr=0.1309 | 8809.4 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.33613 | acc=0.8707 | tpr=0.9721 | fpr=0.1312 | 16265.1 samples/s | 63.5 steps/s
Avg test loss: 0.33590, Avg test acc: 0.87067, Avg tpr: 0.97147, Avg fpr: 0.13116, total FA: 18211

server round 14/50

clients selected: [1 3 6 7 9]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.22928 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=2.567 | acc=0.8281 | 3695.6 samples/s | 57.7 steps/s
[Step=5650 Epoch=27.6] | Loss=0.07445 | Reg=0.00206 | L2-Norm=14.336 | L2-Norm(final)=2.533 | acc=1.0000 | 4554.3 samples/s | 71.2 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05718 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=2.536 | acc=0.9531 | 4538.8 samples/s | 70.9 steps/s
[Step=5750 Epoch=28.1] | Loss=0.05053 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=2.539 | acc=0.9531 | 4415.7 samples/s | 69.0 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04488 | Reg=0.00208 | L2-Norm=14.416 | L2-Norm(final)=2.545 | acc=1.0000 | 5230.1 samples/s | 81.7 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03968 | Reg=0.00208 | L2-Norm=14.433 | L2-Norm(final)=2.550 | acc=0.9844 | 1543.8 samples/s | 24.1 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03632 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=2.556 | acc=1.0000 | 4474.7 samples/s | 69.9 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03337 | Reg=0.00209 | L2-Norm=14.459 | L2-Norm(final)=2.562 | acc=1.0000 | 4466.4 samples/s | 69.8 steps/s
[Step=6000 Epoch=29.3] | Loss=0.03179 | Reg=0.00209 | L2-Norm=14.471 | L2-Norm(final)=2.568 | acc=1.0000 | 5061.8 samples/s | 79.1 steps/s
[Step=6050 Epoch=29.5] | Loss=0.02989 | Reg=0.00210 | L2-Norm=14.483 | L2-Norm(final)=2.573 | acc=1.0000 | 1578.0 samples/s | 24.7 steps/s
[Step=6100 Epoch=29.8] | Loss=0.02783 | Reg=0.00210 | L2-Norm=14.494 | L2-Norm(final)=2.579 | acc=0.9844 | 4444.4 samples/s | 69.4 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02656 | Reg=0.00210 | L2-Norm=14.503 | L2-Norm(final)=2.584 | acc=1.0000 | 3970.8 samples/s | 62.0 steps/s
[Step=6200 Epoch=30.3] | Loss=0.02529 | Reg=0.00211 | L2-Norm=14.511 | L2-Norm(final)=2.589 | acc=1.0000 | 4382.3 samples/s | 68.5 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02418 | Reg=0.00211 | L2-Norm=14.518 | L2-Norm(final)=2.593 | acc=1.0000 | 1624.5 samples/s | 25.4 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02310 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=2.597 | acc=1.0000 | 4505.0 samples/s | 70.4 steps/s
[Step=6350 Epoch=31.0] | Loss=0.02215 | Reg=0.00211 | L2-Norm=14.531 | L2-Norm(final)=2.602 | acc=1.0000 | 4510.3 samples/s | 70.5 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02131 | Reg=0.00211 | L2-Norm=14.537 | L2-Norm(final)=2.606 | acc=1.0000 | 4773.7 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step6400.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.45030 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=2.565 | acc=0.8125 | 3871.3 samples/s | 60.5 steps/s
[Step=5650 Epoch=27.6] | Loss=0.06165 | Reg=0.00205 | L2-Norm=14.314 | L2-Norm(final)=2.538 | acc=0.9844 | 4303.0 samples/s | 67.2 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05006 | Reg=0.00206 | L2-Norm=14.344 | L2-Norm(final)=2.544 | acc=0.9219 | 4425.9 samples/s | 69.2 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04591 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=2.549 | acc=0.9844 | 4432.3 samples/s | 69.3 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04099 | Reg=0.00207 | L2-Norm=14.384 | L2-Norm(final)=2.556 | acc=0.9688 | 5218.1 samples/s | 81.5 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03556 | Reg=0.00207 | L2-Norm=14.404 | L2-Norm(final)=2.564 | acc=0.9844 | 1533.3 samples/s | 24.0 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03201 | Reg=0.00208 | L2-Norm=14.421 | L2-Norm(final)=2.573 | acc=1.0000 | 4456.5 samples/s | 69.6 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03019 | Reg=0.00208 | L2-Norm=14.437 | L2-Norm(final)=2.581 | acc=0.9688 | 4491.1 samples/s | 70.2 steps/s
[Step=6000 Epoch=29.3] | Loss=0.02812 | Reg=0.00209 | L2-Norm=14.451 | L2-Norm(final)=2.588 | acc=1.0000 | 4966.4 samples/s | 77.6 steps/s
[Step=6050 Epoch=29.5] | Loss=0.02718 | Reg=0.00209 | L2-Norm=14.465 | L2-Norm(final)=2.596 | acc=1.0000 | 1568.7 samples/s | 24.5 steps/s
[Step=6100 Epoch=29.7] | Loss=0.02581 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=2.604 | acc=0.9844 | 4398.6 samples/s | 68.7 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02486 | Reg=0.00210 | L2-Norm=14.496 | L2-Norm(final)=2.611 | acc=0.9844 | 4494.8 samples/s | 70.2 steps/s
[Step=6200 Epoch=30.2] | Loss=0.02446 | Reg=0.00211 | L2-Norm=14.509 | L2-Norm(final)=2.617 | acc=0.9844 | 4808.7 samples/s | 75.1 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02348 | Reg=0.00211 | L2-Norm=14.523 | L2-Norm(final)=2.623 | acc=0.9844 | 1582.3 samples/s | 24.7 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02262 | Reg=0.00211 | L2-Norm=14.535 | L2-Norm(final)=2.628 | acc=1.0000 | 4331.8 samples/s | 67.7 steps/s
[Step=6350 Epoch=31.0] | Loss=0.02185 | Reg=0.00212 | L2-Norm=14.546 | L2-Norm(final)=2.633 | acc=1.0000 | 4442.7 samples/s | 69.4 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02113 | Reg=0.00212 | L2-Norm=14.556 | L2-Norm(final)=2.638 | acc=0.9844 | 4587.6 samples/s | 71.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step6400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=5601 Epoch=53.3] | Loss=0.05626 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=2.568 | acc=0.9688 | 3804.2 samples/s | 59.4 steps/s
[Step=5650 Epoch=53.7] | Loss=0.01304 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=2.558 | acc=0.9844 | 4026.7 samples/s | 62.9 steps/s
[Step=5700 Epoch=54.2] | Loss=0.00774 | Reg=0.00208 | L2-Norm=14.429 | L2-Norm(final)=2.549 | acc=1.0000 | 5096.8 samples/s | 79.6 steps/s
[Step=5750 Epoch=54.7] | Loss=0.00520 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=2.550 | acc=1.0000 | 1531.5 samples/s | 23.9 steps/s
[Step=5800 Epoch=55.2] | Loss=0.00391 | Reg=0.00209 | L2-Norm=14.448 | L2-Norm(final)=2.553 | acc=1.0000 | 4848.4 samples/s | 75.8 steps/s
[Step=5850 Epoch=55.6] | Loss=0.00314 | Reg=0.00209 | L2-Norm=14.442 | L2-Norm(final)=2.555 | acc=1.0000 | 1534.7 samples/s | 24.0 steps/s
[Step=5900 Epoch=56.1] | Loss=0.00262 | Reg=0.00208 | L2-Norm=14.433 | L2-Norm(final)=2.557 | acc=1.0000 | 4612.7 samples/s | 72.1 steps/s
[Step=5950 Epoch=56.6] | Loss=0.00225 | Reg=0.00208 | L2-Norm=14.421 | L2-Norm(final)=2.559 | acc=1.0000 | 1499.7 samples/s | 23.4 steps/s
[Step=6000 Epoch=57.1] | Loss=0.00198 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=2.560 | acc=1.0000 | 4471.8 samples/s | 69.9 steps/s
[Step=6050 Epoch=57.6] | Loss=0.00176 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=2.562 | acc=1.0000 | 1558.8 samples/s | 24.4 steps/s
[Step=6100 Epoch=58.0] | Loss=0.00158 | Reg=0.00207 | L2-Norm=14.378 | L2-Norm(final)=2.563 | acc=1.0000 | 4424.3 samples/s | 69.1 steps/s
[Step=6150 Epoch=58.5] | Loss=0.00144 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=2.565 | acc=1.0000 | 1578.0 samples/s | 24.7 steps/s
[Step=6200 Epoch=59.0] | Loss=0.00132 | Reg=0.00206 | L2-Norm=14.346 | L2-Norm(final)=2.566 | acc=1.0000 | 4313.6 samples/s | 67.4 steps/s
[Step=6250 Epoch=59.5] | Loss=0.00122 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=2.567 | acc=1.0000 | 1600.6 samples/s | 25.0 steps/s
[Step=6300 Epoch=59.9] | Loss=0.00114 | Reg=0.00205 | L2-Norm=14.312 | L2-Norm(final)=2.568 | acc=1.0000 | 4199.4 samples/s | 65.6 steps/s
[Step=6350 Epoch=60.4] | Loss=0.00106 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=2.569 | acc=1.0000 | 1588.2 samples/s | 24.8 steps/s
[Step=6400 Epoch=60.9] | Loss=0.00100 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=2.570 | acc=1.0000 | 3658.8 samples/s | 57.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step6400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00050, len=1
[Step=4801 Epoch=45.8] | Loss=0.05945 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=2.567 | acc=0.9531 | 3355.4 samples/s | 52.4 steps/s
[Step=4850 Epoch=46.3] | Loss=0.02096 | Reg=0.00208 | L2-Norm=14.408 | L2-Norm(final)=2.527 | acc=1.0000 | 4012.4 samples/s | 62.7 steps/s
[Step=4900 Epoch=46.8] | Loss=0.01088 | Reg=0.00209 | L2-Norm=14.464 | L2-Norm(final)=2.527 | acc=1.0000 | 5143.8 samples/s | 80.4 steps/s
[Step=4950 Epoch=47.3] | Loss=0.00730 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=2.530 | acc=1.0000 | 1488.6 samples/s | 23.3 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00548 | Reg=0.00210 | L2-Norm=14.476 | L2-Norm(final)=2.532 | acc=1.0000 | 4812.9 samples/s | 75.2 steps/s
[Step=5050 Epoch=48.2] | Loss=0.00439 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=2.534 | acc=1.0000 | 1465.4 samples/s | 22.9 steps/s
[Step=5100 Epoch=48.7] | Loss=0.00366 | Reg=0.00209 | L2-Norm=14.459 | L2-Norm(final)=2.535 | acc=1.0000 | 4288.0 samples/s | 67.0 steps/s
[Step=5150 Epoch=49.2] | Loss=0.00314 | Reg=0.00209 | L2-Norm=14.448 | L2-Norm(final)=2.537 | acc=1.0000 | 1522.1 samples/s | 23.8 steps/s
[Step=5200 Epoch=49.7] | Loss=0.00275 | Reg=0.00208 | L2-Norm=14.435 | L2-Norm(final)=2.538 | acc=1.0000 | 4394.3 samples/s | 68.7 steps/s
[Step=5250 Epoch=50.1] | Loss=0.00245 | Reg=0.00208 | L2-Norm=14.421 | L2-Norm(final)=2.539 | acc=1.0000 | 1519.5 samples/s | 23.7 steps/s
[Step=5300 Epoch=50.6] | Loss=0.00220 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=2.540 | acc=1.0000 | 4455.6 samples/s | 69.6 steps/s
[Step=5350 Epoch=51.1] | Loss=0.00201 | Reg=0.00207 | L2-Norm=14.392 | L2-Norm(final)=2.540 | acc=1.0000 | 1556.3 samples/s | 24.3 steps/s
[Step=5400 Epoch=51.6] | Loss=0.00184 | Reg=0.00207 | L2-Norm=14.377 | L2-Norm(final)=2.541 | acc=1.0000 | 4363.4 samples/s | 68.2 steps/s
[Step=5450 Epoch=52.0] | Loss=0.00170 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=2.542 | acc=1.0000 | 1723.0 samples/s | 26.9 steps/s
[Step=5500 Epoch=52.5] | Loss=0.00158 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=2.543 | acc=1.0000 | 4249.3 samples/s | 66.4 steps/s
[Step=5550 Epoch=53.0] | Loss=0.00147 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=2.543 | acc=1.0000 | 1580.6 samples/s | 24.7 steps/s
[Step=5600 Epoch=53.5] | Loss=0.00138 | Reg=0.00205 | L2-Norm=14.312 | L2-Norm(final)=2.544 | acc=1.0000 | 4359.4 samples/s | 68.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step5600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00050, len=1
[Step=4801 Epoch=45.8] | Loss=0.02446 | Reg=0.00204 | L2-Norm=14.267 | L2-Norm(final)=2.569 | acc=0.9844 | 3731.0 samples/s | 58.3 steps/s
[Step=4850 Epoch=46.2] | Loss=0.02021 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=2.541 | acc=0.9844 | 4074.7 samples/s | 63.7 steps/s
[Step=4900 Epoch=46.7] | Loss=0.01097 | Reg=0.00209 | L2-Norm=14.456 | L2-Norm(final)=2.525 | acc=1.0000 | 5064.0 samples/s | 79.1 steps/s
[Step=4950 Epoch=47.2] | Loss=0.00744 | Reg=0.00210 | L2-Norm=14.483 | L2-Norm(final)=2.524 | acc=1.0000 | 1427.1 samples/s | 22.3 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00560 | Reg=0.00210 | L2-Norm=14.490 | L2-Norm(final)=2.526 | acc=1.0000 | 4478.3 samples/s | 70.0 steps/s
[Step=5050 Epoch=48.1] | Loss=0.00450 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=2.528 | acc=1.0000 | 1516.1 samples/s | 23.7 steps/s
[Step=5100 Epoch=48.6] | Loss=0.00375 | Reg=0.00210 | L2-Norm=14.479 | L2-Norm(final)=2.530 | acc=1.0000 | 4762.6 samples/s | 74.4 steps/s
[Step=5150 Epoch=49.1] | Loss=0.00322 | Reg=0.00209 | L2-Norm=14.468 | L2-Norm(final)=2.532 | acc=1.0000 | 1524.7 samples/s | 23.8 steps/s
[Step=5200 Epoch=49.6] | Loss=0.00282 | Reg=0.00209 | L2-Norm=14.455 | L2-Norm(final)=2.534 | acc=1.0000 | 4518.6 samples/s | 70.6 steps/s
[Step=5250 Epoch=50.0] | Loss=0.00251 | Reg=0.00209 | L2-Norm=14.440 | L2-Norm(final)=2.535 | acc=1.0000 | 1601.5 samples/s | 25.0 steps/s
[Step=5300 Epoch=50.5] | Loss=0.00226 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=2.536 | acc=1.0000 | 4577.5 samples/s | 71.5 steps/s
[Step=5350 Epoch=51.0] | Loss=0.00206 | Reg=0.00208 | L2-Norm=14.408 | L2-Norm(final)=2.537 | acc=1.0000 | 1559.2 samples/s | 24.4 steps/s
[Step=5400 Epoch=51.5] | Loss=0.00189 | Reg=0.00207 | L2-Norm=14.391 | L2-Norm(final)=2.539 | acc=1.0000 | 4394.7 samples/s | 68.7 steps/s
[Step=5450 Epoch=51.9] | Loss=0.00174 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=2.540 | acc=1.0000 | 1598.4 samples/s | 25.0 steps/s
[Step=5500 Epoch=52.4] | Loss=0.00162 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=2.541 | acc=1.0000 | 4195.8 samples/s | 65.6 steps/s
[Step=5550 Epoch=52.9] | Loss=0.00151 | Reg=0.00206 | L2-Norm=14.338 | L2-Norm(final)=2.542 | acc=1.0000 | 1583.9 samples/s | 24.7 steps/s
[Step=5600 Epoch=53.4] | Loss=0.00142 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=2.543 | acc=1.0000 | 4356.1 samples/s | 68.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.50821 | acc=0.6787 | tpr=0.5348 | fpr=0.0087 | 4343.9 samples/s | 17.0 steps/s
Avg test loss: 0.51400, Avg test acc: 0.67842, Avg tpr: 0.53652, Avg fpr: 0.00949, total FA: 74

Testing server on iccad2012
[Step=  50] | Loss=0.26622 | acc=0.9002 | tpr=0.9558 | fpr=0.1008 | 4526.5 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.27145 | acc=0.8988 | tpr=0.9616 | fpr=0.1024 | 9534.4 samples/s | 37.2 steps/s
[Step= 150] | Loss=0.27552 | acc=0.8970 | tpr=0.9683 | fpr=0.1043 | 9051.8 samples/s | 35.4 steps/s
[Step= 200] | Loss=0.27782 | acc=0.8967 | tpr=0.9694 | fpr=0.1046 | 9290.1 samples/s | 36.3 steps/s
[Step= 250] | Loss=0.27717 | acc=0.8965 | tpr=0.9686 | fpr=0.1048 | 8943.8 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.27942 | acc=0.8959 | tpr=0.9680 | fpr=0.1054 | 9301.7 samples/s | 36.3 steps/s
[Step= 350] | Loss=0.28016 | acc=0.8960 | tpr=0.9687 | fpr=0.1053 | 8842.8 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.28170 | acc=0.8959 | tpr=0.9688 | fpr=0.1054 | 9457.1 samples/s | 36.9 steps/s
[Step= 450] | Loss=0.28533 | acc=0.8953 | tpr=0.9688 | fpr=0.1060 | 9012.5 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.28546 | acc=0.8946 | tpr=0.9692 | fpr=0.1067 | 9023.9 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.28493 | acc=0.8944 | tpr=0.9678 | fpr=0.1069 | 16971.9 samples/s | 66.3 steps/s
Avg test loss: 0.28470, Avg test acc: 0.89442, Avg tpr: 0.96672, Avg fpr: 0.10689, total FA: 14842

server round 15/50

clients selected: [1 6 7 8 9]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=6401 Epoch=31.2] | Loss=0.26321 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=2.599 | acc=0.8281 | 4034.0 samples/s | 63.0 steps/s
[Step=6450 Epoch=31.5] | Loss=0.07264 | Reg=0.00203 | L2-Norm=14.258 | L2-Norm(final)=2.563 | acc=0.9375 | 4367.0 samples/s | 68.2 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05655 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=2.566 | acc=0.9531 | 4640.8 samples/s | 72.5 steps/s
[Step=6550 Epoch=32.0] | Loss=0.04745 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=2.571 | acc=0.9844 | 4550.0 samples/s | 71.1 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04585 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=2.572 | acc=1.0000 | 5075.1 samples/s | 79.3 steps/s
[Step=6650 Epoch=32.4] | Loss=0.04037 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=2.574 | acc=0.9844 | 1575.7 samples/s | 24.6 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03640 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=2.579 | acc=1.0000 | 4761.3 samples/s | 74.4 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03366 | Reg=0.00207 | L2-Norm=14.388 | L2-Norm(final)=2.584 | acc=1.0000 | 4812.2 samples/s | 75.2 steps/s
[Step=6800 Epoch=33.2] | Loss=0.03173 | Reg=0.00207 | L2-Norm=14.402 | L2-Norm(final)=2.590 | acc=1.0000 | 5416.2 samples/s | 84.6 steps/s
[Step=6850 Epoch=33.4] | Loss=0.02984 | Reg=0.00208 | L2-Norm=14.413 | L2-Norm(final)=2.595 | acc=1.0000 | 1586.9 samples/s | 24.8 steps/s
[Step=6900 Epoch=33.7] | Loss=0.02795 | Reg=0.00208 | L2-Norm=14.424 | L2-Norm(final)=2.600 | acc=1.0000 | 4539.5 samples/s | 70.9 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02655 | Reg=0.00208 | L2-Norm=14.433 | L2-Norm(final)=2.605 | acc=0.9844 | 4098.4 samples/s | 64.0 steps/s
[Step=7000 Epoch=34.2] | Loss=0.02525 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=2.609 | acc=1.0000 | 4504.9 samples/s | 70.4 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02415 | Reg=0.00209 | L2-Norm=14.449 | L2-Norm(final)=2.614 | acc=1.0000 | 1589.5 samples/s | 24.8 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02295 | Reg=0.00209 | L2-Norm=14.456 | L2-Norm(final)=2.618 | acc=1.0000 | 4628.0 samples/s | 72.3 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02202 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=2.623 | acc=0.9844 | 4638.7 samples/s | 72.5 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02118 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=2.628 | acc=0.9844 | 4993.9 samples/s | 78.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step7200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=6401 Epoch=60.9] | Loss=0.04326 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=2.600 | acc=0.9844 | 3344.4 samples/s | 52.3 steps/s
[Step=6450 Epoch=61.4] | Loss=0.00551 | Reg=0.00203 | L2-Norm=14.263 | L2-Norm(final)=2.603 | acc=1.0000 | 4186.0 samples/s | 65.4 steps/s
[Step=6500 Epoch=61.8] | Loss=0.00284 | Reg=0.00204 | L2-Norm=14.282 | L2-Norm(final)=2.613 | acc=1.0000 | 5276.9 samples/s | 82.5 steps/s
[Step=6550 Epoch=62.3] | Loss=0.00194 | Reg=0.00204 | L2-Norm=14.278 | L2-Norm(final)=2.620 | acc=1.0000 | 1574.3 samples/s | 24.6 steps/s
[Step=6600 Epoch=62.8] | Loss=0.00146 | Reg=0.00203 | L2-Norm=14.265 | L2-Norm(final)=2.624 | acc=1.0000 | 4983.0 samples/s | 77.9 steps/s
[Step=6650 Epoch=63.3] | Loss=0.00118 | Reg=0.00203 | L2-Norm=14.250 | L2-Norm(final)=2.627 | acc=1.0000 | 1552.8 samples/s | 24.3 steps/s
[Step=6700 Epoch=63.7] | Loss=0.00098 | Reg=0.00203 | L2-Norm=14.232 | L2-Norm(final)=2.630 | acc=1.0000 | 4812.3 samples/s | 75.2 steps/s
[Step=6750 Epoch=64.2] | Loss=0.00084 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=2.632 | acc=1.0000 | 1568.4 samples/s | 24.5 steps/s
[Step=6800 Epoch=64.7] | Loss=0.00074 | Reg=0.00201 | L2-Norm=14.194 | L2-Norm(final)=2.634 | acc=1.0000 | 4792.6 samples/s | 74.9 steps/s
[Step=6850 Epoch=65.2] | Loss=0.00066 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=2.636 | acc=1.0000 | 1779.6 samples/s | 27.8 steps/s
[Step=6900 Epoch=65.6] | Loss=0.00059 | Reg=0.00200 | L2-Norm=14.153 | L2-Norm(final)=2.637 | acc=1.0000 | 4528.5 samples/s | 70.8 steps/s
[Step=6950 Epoch=66.1] | Loss=0.00054 | Reg=0.00200 | L2-Norm=14.132 | L2-Norm(final)=2.639 | acc=1.0000 | 1601.1 samples/s | 25.0 steps/s
[Step=7000 Epoch=66.6] | Loss=0.00050 | Reg=0.00199 | L2-Norm=14.111 | L2-Norm(final)=2.640 | acc=1.0000 | 4465.8 samples/s | 69.8 steps/s
[Step=7050 Epoch=67.1] | Loss=0.00046 | Reg=0.00199 | L2-Norm=14.090 | L2-Norm(final)=2.641 | acc=1.0000 | 1647.7 samples/s | 25.7 steps/s
[Step=7100 Epoch=67.5] | Loss=0.00043 | Reg=0.00198 | L2-Norm=14.068 | L2-Norm(final)=2.642 | acc=1.0000 | 4449.1 samples/s | 69.5 steps/s
[Step=7150 Epoch=68.0] | Loss=0.00040 | Reg=0.00197 | L2-Norm=14.047 | L2-Norm(final)=2.643 | acc=1.0000 | 1625.5 samples/s | 25.4 steps/s
[Step=7200 Epoch=68.5] | Loss=0.00037 | Reg=0.00197 | L2-Norm=14.025 | L2-Norm(final)=2.644 | acc=1.0000 | 4471.8 samples/s | 69.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step7200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00050, len=1
[Step=5601 Epoch=53.5] | Loss=0.00920 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=2.601 | acc=1.0000 | 4074.3 samples/s | 63.7 steps/s
[Step=5650 Epoch=54.0] | Loss=0.01325 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=2.587 | acc=1.0000 | 4022.2 samples/s | 62.8 steps/s
[Step=5700 Epoch=54.4] | Loss=0.00737 | Reg=0.00206 | L2-Norm=14.346 | L2-Norm(final)=2.583 | acc=1.0000 | 5292.2 samples/s | 82.7 steps/s
[Step=5750 Epoch=54.9] | Loss=0.00496 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=2.584 | acc=1.0000 | 1522.9 samples/s | 23.8 steps/s
[Step=5800 Epoch=55.4] | Loss=0.00374 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=2.585 | acc=1.0000 | 5181.1 samples/s | 81.0 steps/s
[Step=5850 Epoch=55.9] | Loss=0.00300 | Reg=0.00206 | L2-Norm=14.347 | L2-Norm(final)=2.587 | acc=1.0000 | 1550.8 samples/s | 24.2 steps/s
[Step=5900 Epoch=56.3] | Loss=0.00250 | Reg=0.00206 | L2-Norm=14.336 | L2-Norm(final)=2.588 | acc=1.0000 | 4830.0 samples/s | 75.5 steps/s
[Step=5950 Epoch=56.8] | Loss=0.00215 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=2.589 | acc=1.0000 | 1564.0 samples/s | 24.4 steps/s
[Step=6000 Epoch=57.3] | Loss=0.00188 | Reg=0.00205 | L2-Norm=14.309 | L2-Norm(final)=2.590 | acc=1.0000 | 4678.9 samples/s | 73.1 steps/s
[Step=6050 Epoch=57.8] | Loss=0.00167 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=2.591 | acc=1.0000 | 1565.4 samples/s | 24.5 steps/s
[Step=6100 Epoch=58.3] | Loss=0.00151 | Reg=0.00204 | L2-Norm=14.278 | L2-Norm(final)=2.592 | acc=1.0000 | 4676.4 samples/s | 73.1 steps/s
[Step=6150 Epoch=58.7] | Loss=0.00137 | Reg=0.00203 | L2-Norm=14.262 | L2-Norm(final)=2.593 | acc=1.0000 | 1562.2 samples/s | 24.4 steps/s
[Step=6200 Epoch=59.2] | Loss=0.00126 | Reg=0.00203 | L2-Norm=14.246 | L2-Norm(final)=2.594 | acc=1.0000 | 4598.6 samples/s | 71.9 steps/s
[Step=6250 Epoch=59.7] | Loss=0.00116 | Reg=0.00202 | L2-Norm=14.229 | L2-Norm(final)=2.594 | acc=1.0000 | 1586.0 samples/s | 24.8 steps/s
[Step=6300 Epoch=60.2] | Loss=0.00108 | Reg=0.00202 | L2-Norm=14.212 | L2-Norm(final)=2.595 | acc=1.0000 | 4539.0 samples/s | 70.9 steps/s
[Step=6350 Epoch=60.6] | Loss=0.00101 | Reg=0.00202 | L2-Norm=14.195 | L2-Norm(final)=2.596 | acc=1.0000 | 1624.8 samples/s | 25.4 steps/s
[Step=6400 Epoch=61.1] | Loss=0.00095 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=2.596 | acc=1.0000 | 4447.1 samples/s | 69.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step6400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00050, len=1
[Step=4801 Epoch=45.2] | Loss=0.04077 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=2.600 | acc=0.9688 | 3889.3 samples/s | 60.8 steps/s
[Step=4850 Epoch=45.7] | Loss=0.00525 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=2.602 | acc=1.0000 | 4370.0 samples/s | 68.3 steps/s
[Step=4900 Epoch=46.2] | Loss=0.00349 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=2.609 | acc=1.0000 | 5301.7 samples/s | 82.8 steps/s
[Step=4950 Epoch=46.6] | Loss=0.00253 | Reg=0.00204 | L2-Norm=14.287 | L2-Norm(final)=2.613 | acc=1.0000 | 1522.6 samples/s | 23.8 steps/s
[Step=5000 Epoch=47.1] | Loss=0.00203 | Reg=0.00204 | L2-Norm=14.286 | L2-Norm(final)=2.616 | acc=1.0000 | 5081.6 samples/s | 79.4 steps/s
[Step=5050 Epoch=47.6] | Loss=0.00163 | Reg=0.00204 | L2-Norm=14.280 | L2-Norm(final)=2.618 | acc=1.0000 | 1566.4 samples/s | 24.5 steps/s
[Step=5100 Epoch=48.1] | Loss=0.00136 | Reg=0.00204 | L2-Norm=14.270 | L2-Norm(final)=2.621 | acc=1.0000 | 4791.0 samples/s | 74.9 steps/s
[Step=5150 Epoch=48.5] | Loss=0.00117 | Reg=0.00203 | L2-Norm=14.259 | L2-Norm(final)=2.622 | acc=1.0000 | 1558.8 samples/s | 24.4 steps/s
[Step=5200 Epoch=49.0] | Loss=0.00103 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=2.624 | acc=1.0000 | 4519.9 samples/s | 70.6 steps/s
[Step=5250 Epoch=49.5] | Loss=0.00091 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=2.625 | acc=1.0000 | 1611.7 samples/s | 25.2 steps/s
[Step=5300 Epoch=49.9] | Loss=0.00082 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=2.626 | acc=1.0000 | 4471.9 samples/s | 69.9 steps/s
[Step=5350 Epoch=50.4] | Loss=0.00075 | Reg=0.00202 | L2-Norm=14.199 | L2-Norm(final)=2.627 | acc=1.0000 | 1617.8 samples/s | 25.3 steps/s
[Step=5400 Epoch=50.9] | Loss=0.00069 | Reg=0.00201 | L2-Norm=14.183 | L2-Norm(final)=2.628 | acc=1.0000 | 4589.2 samples/s | 71.7 steps/s
[Step=5450 Epoch=51.4] | Loss=0.00063 | Reg=0.00201 | L2-Norm=14.166 | L2-Norm(final)=2.629 | acc=1.0000 | 1627.2 samples/s | 25.4 steps/s
[Step=5500 Epoch=51.8] | Loss=0.00059 | Reg=0.00200 | L2-Norm=14.149 | L2-Norm(final)=2.630 | acc=1.0000 | 4440.5 samples/s | 69.4 steps/s
[Step=5550 Epoch=52.3] | Loss=0.00055 | Reg=0.00200 | L2-Norm=14.132 | L2-Norm(final)=2.631 | acc=1.0000 | 1704.5 samples/s | 26.6 steps/s
[Step=5600 Epoch=52.8] | Loss=0.00052 | Reg=0.00199 | L2-Norm=14.114 | L2-Norm(final)=2.631 | acc=1.0000 | 4113.4 samples/s | 64.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step5600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00050, len=1
[Step=5601 Epoch=53.4] | Loss=0.02335 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=2.600 | acc=0.9844 | 3917.8 samples/s | 61.2 steps/s
[Step=5650 Epoch=53.8] | Loss=0.00706 | Reg=0.00203 | L2-Norm=14.264 | L2-Norm(final)=2.595 | acc=1.0000 | 4256.2 samples/s | 66.5 steps/s
[Step=5700 Epoch=54.3] | Loss=0.00392 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=2.604 | acc=1.0000 | 5304.8 samples/s | 82.9 steps/s
[Step=5750 Epoch=54.8] | Loss=0.00264 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=2.612 | acc=1.0000 | 1522.7 samples/s | 23.8 steps/s
[Step=5800 Epoch=55.3] | Loss=0.00199 | Reg=0.00204 | L2-Norm=14.287 | L2-Norm(final)=2.617 | acc=1.0000 | 5050.1 samples/s | 78.9 steps/s
[Step=5850 Epoch=55.8] | Loss=0.00159 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=2.620 | acc=1.0000 | 1552.9 samples/s | 24.3 steps/s
[Step=5900 Epoch=56.2] | Loss=0.00133 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=2.622 | acc=1.0000 | 4924.3 samples/s | 76.9 steps/s
[Step=5950 Epoch=56.7] | Loss=0.00114 | Reg=0.00203 | L2-Norm=14.236 | L2-Norm(final)=2.624 | acc=1.0000 | 1740.3 samples/s | 27.2 steps/s
[Step=6000 Epoch=57.2] | Loss=0.00100 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=2.626 | acc=1.0000 | 4799.6 samples/s | 75.0 steps/s
[Step=6050 Epoch=57.7] | Loss=0.00089 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=2.627 | acc=1.0000 | 1570.0 samples/s | 24.5 steps/s
[Step=6100 Epoch=58.1] | Loss=0.00080 | Reg=0.00201 | L2-Norm=14.176 | L2-Norm(final)=2.628 | acc=1.0000 | 4654.4 samples/s | 72.7 steps/s
[Step=6150 Epoch=58.6] | Loss=0.00073 | Reg=0.00200 | L2-Norm=14.155 | L2-Norm(final)=2.629 | acc=1.0000 | 1605.7 samples/s | 25.1 steps/s
[Step=6200 Epoch=59.1] | Loss=0.00067 | Reg=0.00200 | L2-Norm=14.134 | L2-Norm(final)=2.631 | acc=1.0000 | 4486.8 samples/s | 70.1 steps/s
[Step=6250 Epoch=59.6] | Loss=0.00062 | Reg=0.00199 | L2-Norm=14.112 | L2-Norm(final)=2.631 | acc=1.0000 | 1665.1 samples/s | 26.0 steps/s
[Step=6300 Epoch=60.0] | Loss=0.00057 | Reg=0.00199 | L2-Norm=14.090 | L2-Norm(final)=2.632 | acc=1.0000 | 4459.5 samples/s | 69.7 steps/s
[Step=6350 Epoch=60.5] | Loss=0.00054 | Reg=0.00198 | L2-Norm=14.069 | L2-Norm(final)=2.633 | acc=1.0000 | 1605.1 samples/s | 25.1 steps/s
[Step=6400 Epoch=61.0] | Loss=0.00050 | Reg=0.00197 | L2-Norm=14.047 | L2-Norm(final)=2.634 | acc=1.0000 | 4668.8 samples/s | 73.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41128 | acc=0.7372 | tpr=0.6219 | fpr=0.0124 | 4520.1 samples/s | 17.7 steps/s
Avg test loss: 0.41684, Avg test acc: 0.73636, Avg tpr: 0.62225, Avg fpr: 0.01269, total FA: 99

Testing server on iccad2012
[Step=  50] | Loss=0.33167 | acc=0.8704 | tpr=0.9558 | fpr=0.1311 | 4555.1 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.33681 | acc=0.8705 | tpr=0.9680 | fpr=0.1313 | 9301.1 samples/s | 36.3 steps/s
[Step= 150] | Loss=0.34321 | acc=0.8687 | tpr=0.9726 | fpr=0.1332 | 9364.7 samples/s | 36.6 steps/s
[Step= 200] | Loss=0.34575 | acc=0.8682 | tpr=0.9727 | fpr=0.1337 | 9009.7 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.34480 | acc=0.8681 | tpr=0.9712 | fpr=0.1338 | 9185.1 samples/s | 35.9 steps/s
[Step= 300] | Loss=0.34778 | acc=0.8676 | tpr=0.9716 | fpr=0.1343 | 9388.6 samples/s | 36.7 steps/s
[Step= 350] | Loss=0.34843 | acc=0.8675 | tpr=0.9718 | fpr=0.1344 | 9118.2 samples/s | 35.6 steps/s
[Step= 400] | Loss=0.35001 | acc=0.8676 | tpr=0.9721 | fpr=0.1343 | 9350.5 samples/s | 36.5 steps/s
[Step= 450] | Loss=0.35385 | acc=0.8672 | tpr=0.9718 | fpr=0.1347 | 8890.6 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.35401 | acc=0.8665 | tpr=0.9718 | fpr=0.1354 | 9175.8 samples/s | 35.8 steps/s
[Step= 550] | Loss=0.35375 | acc=0.8664 | tpr=0.9706 | fpr=0.1355 | 16845.5 samples/s | 65.8 steps/s
Avg test loss: 0.35352, Avg test acc: 0.86642, Avg tpr: 0.96989, Avg fpr: 0.13546, total FA: 18808

server round 16/50

clients selected: [0 1 3 7 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=7201 Epoch=35.1] | Loss=0.28663 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=2.633 | acc=0.7812 | 4150.8 samples/s | 64.9 steps/s
[Step=7250 Epoch=35.4] | Loss=0.05896 | Reg=0.00200 | L2-Norm=14.155 | L2-Norm(final)=2.608 | acc=0.9062 | 4451.2 samples/s | 69.5 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04738 | Reg=0.00201 | L2-Norm=14.189 | L2-Norm(final)=2.609 | acc=0.9844 | 4609.9 samples/s | 72.0 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04098 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=2.614 | acc=0.9688 | 4604.5 samples/s | 71.9 steps/s
[Step=7400 Epoch=36.1] | Loss=0.03846 | Reg=0.00203 | L2-Norm=14.233 | L2-Norm(final)=2.618 | acc=1.0000 | 5429.3 samples/s | 84.8 steps/s
[Step=7450 Epoch=36.3] | Loss=0.03483 | Reg=0.00203 | L2-Norm=14.251 | L2-Norm(final)=2.622 | acc=0.9531 | 1593.8 samples/s | 24.9 steps/s
[Step=7500 Epoch=36.6] | Loss=0.03121 | Reg=0.00204 | L2-Norm=14.269 | L2-Norm(final)=2.630 | acc=0.9844 | 4585.2 samples/s | 71.6 steps/s
[Step=7550 Epoch=36.8] | Loss=0.02917 | Reg=0.00204 | L2-Norm=14.285 | L2-Norm(final)=2.638 | acc=0.9688 | 4629.2 samples/s | 72.3 steps/s
[Step=7600 Epoch=37.1] | Loss=0.02753 | Reg=0.00204 | L2-Norm=14.298 | L2-Norm(final)=2.643 | acc=0.9688 | 5232.6 samples/s | 81.8 steps/s
[Step=7650 Epoch=37.3] | Loss=0.02545 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=2.649 | acc=1.0000 | 1618.7 samples/s | 25.3 steps/s
[Step=7700 Epoch=37.5] | Loss=0.02372 | Reg=0.00205 | L2-Norm=14.321 | L2-Norm(final)=2.655 | acc=1.0000 | 4504.5 samples/s | 70.4 steps/s
[Step=7750 Epoch=37.8] | Loss=0.02269 | Reg=0.00205 | L2-Norm=14.331 | L2-Norm(final)=2.661 | acc=1.0000 | 4718.9 samples/s | 73.7 steps/s
[Step=7800 Epoch=38.0] | Loss=0.02210 | Reg=0.00206 | L2-Norm=14.341 | L2-Norm(final)=2.667 | acc=1.0000 | 5114.1 samples/s | 79.9 steps/s
[Step=7850 Epoch=38.3] | Loss=0.02113 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=2.671 | acc=1.0000 | 1612.5 samples/s | 25.2 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02036 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=2.676 | acc=1.0000 | 4477.7 samples/s | 70.0 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01960 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=2.681 | acc=0.9844 | 4694.5 samples/s | 73.4 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01941 | Reg=0.00207 | L2-Norm=14.370 | L2-Norm(final)=2.684 | acc=1.0000 | 4838.2 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=7201 Epoch=35.1] | Loss=0.22455 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=2.634 | acc=0.8438 | 3944.3 samples/s | 61.6 steps/s
[Step=7250 Epoch=35.4] | Loss=0.06564 | Reg=0.00201 | L2-Norm=14.190 | L2-Norm(final)=2.601 | acc=0.9844 | 4653.6 samples/s | 72.7 steps/s
[Step=7300 Epoch=35.6] | Loss=0.05561 | Reg=0.00203 | L2-Norm=14.233 | L2-Norm(final)=2.602 | acc=0.9688 | 4677.0 samples/s | 73.1 steps/s
[Step=7350 Epoch=35.9] | Loss=0.04924 | Reg=0.00203 | L2-Norm=14.257 | L2-Norm(final)=2.603 | acc=1.0000 | 4605.6 samples/s | 72.0 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04387 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=2.608 | acc=1.0000 | 5387.2 samples/s | 84.2 steps/s
[Step=7450 Epoch=36.4] | Loss=0.03925 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=2.614 | acc=1.0000 | 1590.2 samples/s | 24.8 steps/s
[Step=7500 Epoch=36.6] | Loss=0.03501 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=2.621 | acc=1.0000 | 4619.2 samples/s | 72.2 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03255 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=2.629 | acc=0.9844 | 4644.2 samples/s | 72.6 steps/s
[Step=7600 Epoch=37.1] | Loss=0.03095 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=2.636 | acc=1.0000 | 5178.1 samples/s | 80.9 steps/s
[Step=7650 Epoch=37.3] | Loss=0.02862 | Reg=0.00206 | L2-Norm=14.351 | L2-Norm(final)=2.642 | acc=1.0000 | 1511.2 samples/s | 23.6 steps/s
[Step=7700 Epoch=37.6] | Loss=0.02660 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=2.649 | acc=0.9844 | 3993.4 samples/s | 62.4 steps/s
[Step=7750 Epoch=37.8] | Loss=0.02525 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=2.656 | acc=0.9844 | 3952.9 samples/s | 61.8 steps/s
[Step=7800 Epoch=38.1] | Loss=0.02433 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=2.661 | acc=0.9688 | 4560.2 samples/s | 71.3 steps/s
[Step=7850 Epoch=38.3] | Loss=0.02312 | Reg=0.00207 | L2-Norm=14.390 | L2-Norm(final)=2.667 | acc=1.0000 | 1607.9 samples/s | 25.1 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02204 | Reg=0.00207 | L2-Norm=14.398 | L2-Norm(final)=2.673 | acc=0.9844 | 4636.6 samples/s | 72.4 steps/s
[Step=7950 Epoch=38.8] | Loss=0.02133 | Reg=0.00208 | L2-Norm=14.405 | L2-Norm(final)=2.678 | acc=1.0000 | 4640.2 samples/s | 72.5 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02070 | Reg=0.00208 | L2-Norm=14.411 | L2-Norm(final)=2.682 | acc=1.0000 | 4743.6 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00050, len=1
[Step=6401 Epoch=31.2] | Loss=0.17847 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=2.634 | acc=0.8594 | 3402.8 samples/s | 53.2 steps/s
[Step=6450 Epoch=31.5] | Loss=0.06195 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=2.605 | acc=0.9844 | 4503.0 samples/s | 70.4 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05128 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=2.602 | acc=1.0000 | 4753.4 samples/s | 74.3 steps/s
[Step=6550 Epoch=31.9] | Loss=0.04392 | Reg=0.00202 | L2-Norm=14.225 | L2-Norm(final)=2.603 | acc=1.0000 | 4623.3 samples/s | 72.2 steps/s
[Step=6600 Epoch=32.2] | Loss=0.03922 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=2.610 | acc=0.9688 | 5410.1 samples/s | 84.5 steps/s
[Step=6650 Epoch=32.4] | Loss=0.03407 | Reg=0.00203 | L2-Norm=14.263 | L2-Norm(final)=2.620 | acc=0.9844 | 1582.8 samples/s | 24.7 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03089 | Reg=0.00204 | L2-Norm=14.280 | L2-Norm(final)=2.630 | acc=1.0000 | 4621.3 samples/s | 72.2 steps/s
[Step=6750 Epoch=32.9] | Loss=0.02845 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=2.640 | acc=0.9844 | 4610.8 samples/s | 72.0 steps/s
[Step=6800 Epoch=33.2] | Loss=0.02683 | Reg=0.00205 | L2-Norm=14.308 | L2-Norm(final)=2.647 | acc=0.9844 | 5353.1 samples/s | 83.6 steps/s
[Step=6850 Epoch=33.4] | Loss=0.02503 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=2.654 | acc=0.9844 | 1597.5 samples/s | 25.0 steps/s
[Step=6900 Epoch=33.6] | Loss=0.02371 | Reg=0.00205 | L2-Norm=14.328 | L2-Norm(final)=2.660 | acc=1.0000 | 4675.2 samples/s | 73.0 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02279 | Reg=0.00206 | L2-Norm=14.337 | L2-Norm(final)=2.665 | acc=1.0000 | 4723.5 samples/s | 73.8 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02204 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=2.670 | acc=1.0000 | 5039.2 samples/s | 78.7 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02091 | Reg=0.00206 | L2-Norm=14.353 | L2-Norm(final)=2.676 | acc=1.0000 | 1642.0 samples/s | 25.7 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02009 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=2.682 | acc=0.9844 | 4625.5 samples/s | 72.3 steps/s
[Step=7150 Epoch=34.9] | Loss=0.01951 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=2.687 | acc=1.0000 | 4577.7 samples/s | 71.5 steps/s
[Step=7200 Epoch=35.1] | Loss=0.01890 | Reg=0.00207 | L2-Norm=14.376 | L2-Norm(final)=2.692 | acc=1.0000 | 4539.5 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step7200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00050, len=1
[Step=6401 Epoch=61.1] | Loss=0.09888 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=2.633 | acc=0.9531 | 3642.5 samples/s | 56.9 steps/s
[Step=6450 Epoch=61.6] | Loss=0.01661 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=2.593 | acc=1.0000 | 3799.6 samples/s | 59.4 steps/s
[Step=6500 Epoch=62.1] | Loss=0.00924 | Reg=0.00205 | L2-Norm=14.302 | L2-Norm(final)=2.590 | acc=1.0000 | 5277.9 samples/s | 82.5 steps/s
[Step=6550 Epoch=62.5] | Loss=0.00619 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=2.594 | acc=1.0000 | 1443.5 samples/s | 22.6 steps/s
[Step=6600 Epoch=63.0] | Loss=0.00465 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=2.597 | acc=1.0000 | 4565.2 samples/s | 71.3 steps/s
[Step=6650 Epoch=63.5] | Loss=0.00373 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=2.599 | acc=1.0000 | 1528.8 samples/s | 23.9 steps/s
[Step=6700 Epoch=64.0] | Loss=0.00311 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=2.601 | acc=1.0000 | 4966.8 samples/s | 77.6 steps/s
[Step=6750 Epoch=64.5] | Loss=0.00267 | Reg=0.00204 | L2-Norm=14.290 | L2-Norm(final)=2.602 | acc=1.0000 | 1550.4 samples/s | 24.2 steps/s
[Step=6800 Epoch=64.9] | Loss=0.00234 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=2.604 | acc=1.0000 | 4749.7 samples/s | 74.2 steps/s
[Step=6850 Epoch=65.4] | Loss=0.00208 | Reg=0.00203 | L2-Norm=14.262 | L2-Norm(final)=2.605 | acc=1.0000 | 1559.1 samples/s | 24.4 steps/s
[Step=6900 Epoch=65.9] | Loss=0.00187 | Reg=0.00203 | L2-Norm=14.247 | L2-Norm(final)=2.606 | acc=1.0000 | 4636.8 samples/s | 72.4 steps/s
[Step=6950 Epoch=66.4] | Loss=0.00170 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=2.607 | acc=1.0000 | 1568.1 samples/s | 24.5 steps/s
[Step=7000 Epoch=66.8] | Loss=0.00156 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=2.608 | acc=1.0000 | 4494.3 samples/s | 70.2 steps/s
[Step=7050 Epoch=67.3] | Loss=0.00144 | Reg=0.00202 | L2-Norm=14.198 | L2-Norm(final)=2.609 | acc=1.0000 | 1594.5 samples/s | 24.9 steps/s
[Step=7100 Epoch=67.8] | Loss=0.00134 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=2.610 | acc=1.0000 | 4442.7 samples/s | 69.4 steps/s
[Step=7150 Epoch=68.3] | Loss=0.00125 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=2.611 | acc=1.0000 | 1617.6 samples/s | 25.3 steps/s
[Step=7200 Epoch=68.8] | Loss=0.00117 | Reg=0.00200 | L2-Norm=14.147 | L2-Norm(final)=2.612 | acc=1.0000 | 4509.0 samples/s | 70.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step7200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00050, len=1
[Step=6401 Epoch=61.0] | Loss=0.05173 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=2.633 | acc=0.9844 | 3862.8 samples/s | 60.4 steps/s
[Step=6450 Epoch=61.5] | Loss=0.01341 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=2.613 | acc=1.0000 | 4224.3 samples/s | 66.0 steps/s
[Step=6500 Epoch=62.0] | Loss=0.00772 | Reg=0.00203 | L2-Norm=14.264 | L2-Norm(final)=2.603 | acc=1.0000 | 5319.0 samples/s | 83.1 steps/s
[Step=6550 Epoch=62.4] | Loss=0.00519 | Reg=0.00204 | L2-Norm=14.280 | L2-Norm(final)=2.604 | acc=1.0000 | 1451.9 samples/s | 22.7 steps/s
[Step=6600 Epoch=62.9] | Loss=0.00392 | Reg=0.00204 | L2-Norm=14.279 | L2-Norm(final)=2.606 | acc=1.0000 | 4551.3 samples/s | 71.1 steps/s
[Step=6650 Epoch=63.4] | Loss=0.00315 | Reg=0.00204 | L2-Norm=14.270 | L2-Norm(final)=2.608 | acc=1.0000 | 1546.0 samples/s | 24.2 steps/s
[Step=6700 Epoch=63.9] | Loss=0.00262 | Reg=0.00203 | L2-Norm=14.258 | L2-Norm(final)=2.610 | acc=1.0000 | 4931.9 samples/s | 77.1 steps/s
[Step=6750 Epoch=64.3] | Loss=0.00225 | Reg=0.00203 | L2-Norm=14.243 | L2-Norm(final)=2.611 | acc=1.0000 | 1601.0 samples/s | 25.0 steps/s
[Step=6800 Epoch=64.8] | Loss=0.00197 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=2.612 | acc=1.0000 | 4906.2 samples/s | 76.7 steps/s
[Step=6850 Epoch=65.3] | Loss=0.00175 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=2.614 | acc=1.0000 | 1573.0 samples/s | 24.6 steps/s
[Step=6900 Epoch=65.8] | Loss=0.00158 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=2.615 | acc=1.0000 | 4627.4 samples/s | 72.3 steps/s
[Step=6950 Epoch=66.2] | Loss=0.00144 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=2.616 | acc=1.0000 | 1595.1 samples/s | 24.9 steps/s
[Step=7000 Epoch=66.7] | Loss=0.00132 | Reg=0.00200 | L2-Norm=14.153 | L2-Norm(final)=2.617 | acc=1.0000 | 4605.3 samples/s | 72.0 steps/s
[Step=7050 Epoch=67.2] | Loss=0.00122 | Reg=0.00200 | L2-Norm=14.134 | L2-Norm(final)=2.618 | acc=1.0000 | 1603.1 samples/s | 25.0 steps/s
[Step=7100 Epoch=67.7] | Loss=0.00113 | Reg=0.00199 | L2-Norm=14.114 | L2-Norm(final)=2.619 | acc=1.0000 | 4503.4 samples/s | 70.4 steps/s
[Step=7150 Epoch=68.1] | Loss=0.00106 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=2.620 | acc=1.0000 | 1622.9 samples/s | 25.4 steps/s
[Step=7200 Epoch=68.6] | Loss=0.00099 | Reg=0.00198 | L2-Norm=14.075 | L2-Norm(final)=2.621 | acc=1.0000 | 4422.6 samples/s | 69.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37965 | acc=0.7490 | tpr=0.6400 | fpr=0.0144 | 4559.5 samples/s | 17.8 steps/s
Avg test loss: 0.38253, Avg test acc: 0.74830, Avg tpr: 0.64061, Avg fpr: 0.01487, total FA: 116

Testing server on iccad2012
[Step=  50] | Loss=0.32128 | acc=0.8720 | tpr=0.9602 | fpr=0.1296 | 4577.0 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.32618 | acc=0.8722 | tpr=0.9723 | fpr=0.1296 | 9680.1 samples/s | 37.8 steps/s
[Step= 150] | Loss=0.33245 | acc=0.8711 | tpr=0.9741 | fpr=0.1308 | 8952.0 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.33506 | acc=0.8710 | tpr=0.9749 | fpr=0.1309 | 9221.5 samples/s | 36.0 steps/s
[Step= 250] | Loss=0.33373 | acc=0.8709 | tpr=0.9729 | fpr=0.1310 | 9068.8 samples/s | 35.4 steps/s
[Step= 300] | Loss=0.33676 | acc=0.8702 | tpr=0.9731 | fpr=0.1317 | 9432.5 samples/s | 36.8 steps/s
[Step= 350] | Loss=0.33746 | acc=0.8702 | tpr=0.9737 | fpr=0.1317 | 9022.9 samples/s | 35.2 steps/s
[Step= 400] | Loss=0.33902 | acc=0.8705 | tpr=0.9737 | fpr=0.1314 | 9336.5 samples/s | 36.5 steps/s
[Step= 450] | Loss=0.34283 | acc=0.8699 | tpr=0.9727 | fpr=0.1320 | 9377.2 samples/s | 36.6 steps/s
[Step= 500] | Loss=0.34271 | acc=0.8691 | tpr=0.9736 | fpr=0.1328 | 8824.6 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.34242 | acc=0.8688 | tpr=0.9733 | fpr=0.1331 | 17192.8 samples/s | 67.2 steps/s
Avg test loss: 0.34219, Avg test acc: 0.86881, Avg tpr: 0.97266, Avg fpr: 0.13307, total FA: 18477

server round 17/50

clients selected: [2 4 5 7 9]

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00050, len=1
[Step=5601 Epoch=27.3] | Loss=0.33718 | Reg=0.00197 | L2-Norm=14.025 | L2-Norm(final)=2.648 | acc=0.8438 | 3776.6 samples/s | 59.0 steps/s
[Step=5650 Epoch=27.5] | Loss=0.06368 | Reg=0.00198 | L2-Norm=14.057 | L2-Norm(final)=2.622 | acc=0.9844 | 4816.0 samples/s | 75.2 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04684 | Reg=0.00198 | L2-Norm=14.084 | L2-Norm(final)=2.626 | acc=0.9844 | 4610.1 samples/s | 72.0 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04120 | Reg=0.00199 | L2-Norm=14.107 | L2-Norm(final)=2.632 | acc=1.0000 | 4518.7 samples/s | 70.6 steps/s
[Step=5800 Epoch=28.3] | Loss=0.03841 | Reg=0.00200 | L2-Norm=14.130 | L2-Norm(final)=2.638 | acc=0.9844 | 5457.8 samples/s | 85.3 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03475 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=2.644 | acc=0.9844 | 1589.6 samples/s | 24.8 steps/s
[Step=5900 Epoch=28.7] | Loss=0.03178 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=2.651 | acc=0.9688 | 4677.0 samples/s | 73.1 steps/s
[Step=5950 Epoch=29.0] | Loss=0.02947 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=2.657 | acc=1.0000 | 4585.9 samples/s | 71.7 steps/s
[Step=6000 Epoch=29.2] | Loss=0.02735 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=2.664 | acc=1.0000 | 5145.2 samples/s | 80.4 steps/s
[Step=6050 Epoch=29.5] | Loss=0.02577 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=2.669 | acc=1.0000 | 1576.9 samples/s | 24.6 steps/s
[Step=6100 Epoch=29.7] | Loss=0.02472 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=2.674 | acc=1.0000 | 4639.4 samples/s | 72.5 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02345 | Reg=0.00203 | L2-Norm=14.237 | L2-Norm(final)=2.678 | acc=0.9844 | 4536.2 samples/s | 70.9 steps/s
[Step=6200 Epoch=30.2] | Loss=0.02248 | Reg=0.00203 | L2-Norm=14.248 | L2-Norm(final)=2.683 | acc=0.9844 | 5107.6 samples/s | 79.8 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02132 | Reg=0.00203 | L2-Norm=14.257 | L2-Norm(final)=2.688 | acc=1.0000 | 1575.0 samples/s | 24.6 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02048 | Reg=0.00204 | L2-Norm=14.266 | L2-Norm(final)=2.692 | acc=1.0000 | 4501.9 samples/s | 70.3 steps/s
[Step=6350 Epoch=30.9] | Loss=0.01979 | Reg=0.00204 | L2-Norm=14.274 | L2-Norm(final)=2.696 | acc=1.0000 | 4285.9 samples/s | 67.0 steps/s
[Step=6400 Epoch=31.2] | Loss=0.01908 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=2.701 | acc=1.0000 | 4215.6 samples/s | 65.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step6400.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00050, len=1
[Step=5601 Epoch=27.5] | Loss=0.38671 | Reg=0.00197 | L2-Norm=14.025 | L2-Norm(final)=2.648 | acc=0.7500 | 3328.4 samples/s | 52.0 steps/s
[Step=5650 Epoch=27.7] | Loss=0.06768 | Reg=0.00198 | L2-Norm=14.079 | L2-Norm(final)=2.622 | acc=0.9688 | 4396.9 samples/s | 68.7 steps/s
[Step=5700 Epoch=28.0] | Loss=0.05282 | Reg=0.00199 | L2-Norm=14.106 | L2-Norm(final)=2.623 | acc=0.9844 | 4424.7 samples/s | 69.1 steps/s
[Step=5750 Epoch=28.2] | Loss=0.04440 | Reg=0.00200 | L2-Norm=14.127 | L2-Norm(final)=2.629 | acc=0.9688 | 4440.2 samples/s | 69.4 steps/s
[Step=5800 Epoch=28.4] | Loss=0.04065 | Reg=0.00200 | L2-Norm=14.142 | L2-Norm(final)=2.632 | acc=1.0000 | 5308.0 samples/s | 82.9 steps/s
[Step=5850 Epoch=28.7] | Loss=0.03582 | Reg=0.00200 | L2-Norm=14.156 | L2-Norm(final)=2.636 | acc=0.9844 | 1548.0 samples/s | 24.2 steps/s
[Step=5900 Epoch=28.9] | Loss=0.03242 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=2.641 | acc=1.0000 | 4443.0 samples/s | 69.4 steps/s
[Step=5950 Epoch=29.2] | Loss=0.02970 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=2.647 | acc=1.0000 | 4513.4 samples/s | 70.5 steps/s
[Step=6000 Epoch=29.4] | Loss=0.02776 | Reg=0.00201 | L2-Norm=14.193 | L2-Norm(final)=2.653 | acc=1.0000 | 5201.5 samples/s | 81.3 steps/s
[Step=6050 Epoch=29.7] | Loss=0.02597 | Reg=0.00202 | L2-Norm=14.204 | L2-Norm(final)=2.658 | acc=1.0000 | 1565.1 samples/s | 24.5 steps/s
[Step=6100 Epoch=29.9] | Loss=0.02452 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=2.663 | acc=1.0000 | 4380.7 samples/s | 68.4 steps/s
[Step=6150 Epoch=30.2] | Loss=0.02330 | Reg=0.00202 | L2-Norm=14.224 | L2-Norm(final)=2.667 | acc=0.9531 | 4512.5 samples/s | 70.5 steps/s
[Step=6200 Epoch=30.4] | Loss=0.02207 | Reg=0.00203 | L2-Norm=14.233 | L2-Norm(final)=2.672 | acc=1.0000 | 5179.0 samples/s | 80.9 steps/s
[Step=6250 Epoch=30.6] | Loss=0.02121 | Reg=0.00203 | L2-Norm=14.241 | L2-Norm(final)=2.676 | acc=1.0000 | 1591.9 samples/s | 24.9 steps/s
[Step=6300 Epoch=30.9] | Loss=0.02039 | Reg=0.00203 | L2-Norm=14.248 | L2-Norm(final)=2.680 | acc=1.0000 | 4473.0 samples/s | 69.9 steps/s
[Step=6350 Epoch=31.1] | Loss=0.01952 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=2.684 | acc=1.0000 | 4357.5 samples/s | 68.1 steps/s
[Step=6400 Epoch=31.4] | Loss=0.01903 | Reg=0.00203 | L2-Norm=14.261 | L2-Norm(final)=2.688 | acc=1.0000 | 5034.4 samples/s | 78.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step6400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=6401 Epoch=60.7] | Loss=0.03312 | Reg=0.00197 | L2-Norm=14.025 | L2-Norm(final)=2.649 | acc=0.9688 | 3846.9 samples/s | 60.1 steps/s
[Step=6450 Epoch=61.1] | Loss=0.00691 | Reg=0.00199 | L2-Norm=14.124 | L2-Norm(final)=2.657 | acc=1.0000 | 4063.1 samples/s | 63.5 steps/s
[Step=6500 Epoch=61.6] | Loss=0.00833 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=2.643 | acc=1.0000 | 5233.8 samples/s | 81.8 steps/s
[Step=6550 Epoch=62.1] | Loss=0.00590 | Reg=0.00202 | L2-Norm=14.195 | L2-Norm(final)=2.630 | acc=1.0000 | 1657.2 samples/s | 25.9 steps/s
[Step=6600 Epoch=62.5] | Loss=0.00447 | Reg=0.00202 | L2-Norm=14.208 | L2-Norm(final)=2.628 | acc=1.0000 | 4851.6 samples/s | 75.8 steps/s
[Step=6650 Epoch=63.0] | Loss=0.00358 | Reg=0.00202 | L2-Norm=14.208 | L2-Norm(final)=2.628 | acc=1.0000 | 1530.9 samples/s | 23.9 steps/s
[Step=6700 Epoch=63.5] | Loss=0.00299 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=2.628 | acc=1.0000 | 4630.7 samples/s | 72.4 steps/s
[Step=6750 Epoch=64.0] | Loss=0.00257 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=2.629 | acc=1.0000 | 1596.5 samples/s | 24.9 steps/s
[Step=6800 Epoch=64.4] | Loss=0.00225 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=2.630 | acc=1.0000 | 4438.4 samples/s | 69.4 steps/s
[Step=6850 Epoch=64.9] | Loss=0.00200 | Reg=0.00201 | L2-Norm=14.163 | L2-Norm(final)=2.631 | acc=1.0000 | 1574.4 samples/s | 24.6 steps/s
[Step=6900 Epoch=65.4] | Loss=0.00180 | Reg=0.00200 | L2-Norm=14.147 | L2-Norm(final)=2.632 | acc=1.0000 | 4359.1 samples/s | 68.1 steps/s
[Step=6950 Epoch=65.9] | Loss=0.00164 | Reg=0.00200 | L2-Norm=14.130 | L2-Norm(final)=2.633 | acc=1.0000 | 1601.5 samples/s | 25.0 steps/s
[Step=7000 Epoch=66.3] | Loss=0.00150 | Reg=0.00199 | L2-Norm=14.113 | L2-Norm(final)=2.634 | acc=1.0000 | 4419.5 samples/s | 69.1 steps/s
[Step=7050 Epoch=66.8] | Loss=0.00139 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=2.634 | acc=1.0000 | 1600.0 samples/s | 25.0 steps/s
[Step=7100 Epoch=67.3] | Loss=0.00129 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=2.635 | acc=1.0000 | 4279.5 samples/s | 66.9 steps/s
[Step=7150 Epoch=67.8] | Loss=0.00120 | Reg=0.00198 | L2-Norm=14.058 | L2-Norm(final)=2.636 | acc=1.0000 | 1606.1 samples/s | 25.1 steps/s
[Step=7200 Epoch=68.2] | Loss=0.00113 | Reg=0.00197 | L2-Norm=14.039 | L2-Norm(final)=2.637 | acc=1.0000 | 4212.6 samples/s | 65.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step7200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00050, len=1
[Step=7201 Epoch=68.8] | Loss=0.03250 | Reg=0.00197 | L2-Norm=14.025 | L2-Norm(final)=2.650 | acc=0.9688 | 3687.6 samples/s | 57.6 steps/s
[Step=7250 Epoch=69.2] | Loss=0.00852 | Reg=0.00200 | L2-Norm=14.153 | L2-Norm(final)=2.644 | acc=1.0000 | 4162.4 samples/s | 65.0 steps/s
[Step=7300 Epoch=69.7] | Loss=0.00447 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=2.648 | acc=1.0000 | 5165.4 samples/s | 80.7 steps/s
[Step=7350 Epoch=70.2] | Loss=0.00300 | Reg=0.00202 | L2-Norm=14.196 | L2-Norm(final)=2.653 | acc=1.0000 | 1517.1 samples/s | 23.7 steps/s
[Step=7400 Epoch=70.7] | Loss=0.00226 | Reg=0.00201 | L2-Norm=14.190 | L2-Norm(final)=2.656 | acc=1.0000 | 4947.3 samples/s | 77.3 steps/s
[Step=7450 Epoch=71.1] | Loss=0.00181 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=2.658 | acc=1.0000 | 1515.9 samples/s | 23.7 steps/s
[Step=7500 Epoch=71.6] | Loss=0.00151 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=2.660 | acc=1.0000 | 4815.3 samples/s | 75.2 steps/s
[Step=7550 Epoch=72.1] | Loss=0.00130 | Reg=0.00200 | L2-Norm=14.148 | L2-Norm(final)=2.661 | acc=1.0000 | 1490.8 samples/s | 23.3 steps/s
[Step=7600 Epoch=72.6] | Loss=0.00114 | Reg=0.00200 | L2-Norm=14.132 | L2-Norm(final)=2.663 | acc=1.0000 | 4135.3 samples/s | 64.6 steps/s
[Step=7650 Epoch=73.1] | Loss=0.00101 | Reg=0.00199 | L2-Norm=14.115 | L2-Norm(final)=2.664 | acc=1.0000 | 1570.6 samples/s | 24.5 steps/s
[Step=7700 Epoch=73.5] | Loss=0.00091 | Reg=0.00199 | L2-Norm=14.097 | L2-Norm(final)=2.665 | acc=1.0000 | 4368.8 samples/s | 68.3 steps/s
[Step=7750 Epoch=74.0] | Loss=0.00083 | Reg=0.00198 | L2-Norm=14.080 | L2-Norm(final)=2.666 | acc=1.0000 | 1559.2 samples/s | 24.4 steps/s
[Step=7800 Epoch=74.5] | Loss=0.00076 | Reg=0.00198 | L2-Norm=14.061 | L2-Norm(final)=2.667 | acc=1.0000 | 4260.7 samples/s | 66.6 steps/s
[Step=7850 Epoch=75.0] | Loss=0.00070 | Reg=0.00197 | L2-Norm=14.043 | L2-Norm(final)=2.668 | acc=1.0000 | 1548.8 samples/s | 24.2 steps/s
[Step=7900 Epoch=75.4] | Loss=0.00065 | Reg=0.00197 | L2-Norm=14.024 | L2-Norm(final)=2.668 | acc=1.0000 | 3770.7 samples/s | 58.9 steps/s
[Step=7950 Epoch=75.9] | Loss=0.00061 | Reg=0.00196 | L2-Norm=14.005 | L2-Norm(final)=2.669 | acc=1.0000 | 1593.9 samples/s | 24.9 steps/s
[Step=8000 Epoch=76.4] | Loss=0.00057 | Reg=0.00196 | L2-Norm=13.986 | L2-Norm(final)=2.670 | acc=1.0000 | 4350.3 samples/s | 68.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step8000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00050, len=1
[Step=7201 Epoch=68.6] | Loss=0.06689 | Reg=0.00197 | L2-Norm=14.025 | L2-Norm(final)=2.648 | acc=0.9688 | 3711.4 samples/s | 58.0 steps/s
[Step=7250 Epoch=69.1] | Loss=0.00705 | Reg=0.00199 | L2-Norm=14.114 | L2-Norm(final)=2.636 | acc=1.0000 | 4332.3 samples/s | 67.7 steps/s
[Step=7300 Epoch=69.6] | Loss=0.00410 | Reg=0.00200 | L2-Norm=14.149 | L2-Norm(final)=2.642 | acc=0.9844 | 5147.5 samples/s | 80.4 steps/s
[Step=7350 Epoch=70.1] | Loss=0.00299 | Reg=0.00200 | L2-Norm=14.158 | L2-Norm(final)=2.648 | acc=1.0000 | 1527.3 samples/s | 23.9 steps/s
[Step=7400 Epoch=70.5] | Loss=0.00230 | Reg=0.00200 | L2-Norm=14.158 | L2-Norm(final)=2.652 | acc=1.0000 | 4957.4 samples/s | 77.5 steps/s
[Step=7450 Epoch=71.0] | Loss=0.00184 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=2.656 | acc=1.0000 | 1666.6 samples/s | 26.0 steps/s
[Step=7500 Epoch=71.5] | Loss=0.00154 | Reg=0.00200 | L2-Norm=14.137 | L2-Norm(final)=2.659 | acc=1.0000 | 4641.8 samples/s | 72.5 steps/s
[Step=7550 Epoch=72.0] | Loss=0.00132 | Reg=0.00199 | L2-Norm=14.122 | L2-Norm(final)=2.662 | acc=1.0000 | 1552.7 samples/s | 24.3 steps/s
[Step=7600 Epoch=72.4] | Loss=0.00116 | Reg=0.00199 | L2-Norm=14.105 | L2-Norm(final)=2.664 | acc=1.0000 | 4683.5 samples/s | 73.2 steps/s
[Step=7650 Epoch=72.9] | Loss=0.00103 | Reg=0.00198 | L2-Norm=14.087 | L2-Norm(final)=2.666 | acc=1.0000 | 1551.5 samples/s | 24.2 steps/s
[Step=7700 Epoch=73.4] | Loss=0.00093 | Reg=0.00198 | L2-Norm=14.067 | L2-Norm(final)=2.667 | acc=1.0000 | 4526.7 samples/s | 70.7 steps/s
[Step=7750 Epoch=73.9] | Loss=0.00084 | Reg=0.00197 | L2-Norm=14.048 | L2-Norm(final)=2.668 | acc=1.0000 | 1560.1 samples/s | 24.4 steps/s
[Step=7800 Epoch=74.3] | Loss=0.00077 | Reg=0.00197 | L2-Norm=14.028 | L2-Norm(final)=2.670 | acc=1.0000 | 4341.0 samples/s | 67.8 steps/s
[Step=7850 Epoch=74.8] | Loss=0.00071 | Reg=0.00196 | L2-Norm=14.007 | L2-Norm(final)=2.671 | acc=1.0000 | 1625.8 samples/s | 25.4 steps/s
[Step=7900 Epoch=75.3] | Loss=0.00066 | Reg=0.00196 | L2-Norm=13.986 | L2-Norm(final)=2.672 | acc=1.0000 | 4214.8 samples/s | 65.9 steps/s
[Step=7950 Epoch=75.8] | Loss=0.00062 | Reg=0.00195 | L2-Norm=13.965 | L2-Norm(final)=2.673 | acc=1.0000 | 1600.8 samples/s | 25.0 steps/s
[Step=8000 Epoch=76.2] | Loss=0.00058 | Reg=0.00194 | L2-Norm=13.944 | L2-Norm(final)=2.674 | acc=1.0000 | 4307.2 samples/s | 67.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43696 | acc=0.7234 | tpr=0.6001 | fpr=0.0089 | 4467.1 samples/s | 17.4 steps/s
Avg test loss: 0.43913, Avg test acc: 0.72482, Avg tpr: 0.60418, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.31523 | acc=0.8850 | tpr=0.9602 | fpr=0.1164 | 4289.0 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.32031 | acc=0.8846 | tpr=0.9744 | fpr=0.1171 | 7926.9 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.32506 | acc=0.8837 | tpr=0.9755 | fpr=0.1180 | 5569.1 samples/s | 21.8 steps/s
[Step= 200] | Loss=0.32761 | acc=0.8836 | tpr=0.9749 | fpr=0.1181 | 7888.8 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.32658 | acc=0.8833 | tpr=0.9721 | fpr=0.1183 | 8834.5 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.32978 | acc=0.8825 | tpr=0.9724 | fpr=0.1191 | 8714.5 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.33070 | acc=0.8823 | tpr=0.9724 | fpr=0.1193 | 8856.0 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.33216 | acc=0.8824 | tpr=0.9721 | fpr=0.1193 | 8285.4 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.33634 | acc=0.8817 | tpr=0.9718 | fpr=0.1199 | 9389.7 samples/s | 36.7 steps/s
[Step= 500] | Loss=0.33601 | acc=0.8811 | tpr=0.9727 | fpr=0.1205 | 8256.0 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.33548 | acc=0.8809 | tpr=0.9717 | fpr=0.1208 | 15780.1 samples/s | 61.6 steps/s
Avg test loss: 0.33521, Avg test acc: 0.88094, Avg tpr: 0.97108, Avg fpr: 0.12070, total FA: 16759

server round 18/50

clients selected: [1 2 4 7 8]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.41176 | Reg=0.00193 | L2-Norm=13.885 | L2-Norm(final)=2.702 | acc=0.7344 | 3938.2 samples/s | 61.5 steps/s
[Step=8050 Epoch=39.3] | Loss=0.06297 | Reg=0.00195 | L2-Norm=13.956 | L2-Norm(final)=2.671 | acc=0.9062 | 4283.5 samples/s | 66.9 steps/s
[Step=8100 Epoch=39.5] | Loss=0.04798 | Reg=0.00196 | L2-Norm=13.998 | L2-Norm(final)=2.675 | acc=0.9688 | 4492.3 samples/s | 70.2 steps/s
[Step=8150 Epoch=39.8] | Loss=0.04367 | Reg=0.00197 | L2-Norm=14.024 | L2-Norm(final)=2.678 | acc=0.9531 | 4387.6 samples/s | 68.6 steps/s
[Step=8200 Epoch=40.0] | Loss=0.04004 | Reg=0.00197 | L2-Norm=14.043 | L2-Norm(final)=2.680 | acc=1.0000 | 5233.2 samples/s | 81.8 steps/s
[Step=8250 Epoch=40.3] | Loss=0.03560 | Reg=0.00198 | L2-Norm=14.061 | L2-Norm(final)=2.684 | acc=1.0000 | 1498.3 samples/s | 23.4 steps/s
[Step=8300 Epoch=40.5] | Loss=0.03182 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=2.689 | acc=1.0000 | 3822.6 samples/s | 59.7 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02886 | Reg=0.00199 | L2-Norm=14.091 | L2-Norm(final)=2.696 | acc=1.0000 | 3960.0 samples/s | 61.9 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02754 | Reg=0.00199 | L2-Norm=14.104 | L2-Norm(final)=2.702 | acc=1.0000 | 4686.4 samples/s | 73.2 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02559 | Reg=0.00199 | L2-Norm=14.115 | L2-Norm(final)=2.707 | acc=1.0000 | 1578.3 samples/s | 24.7 steps/s
[Step=8500 Epoch=41.5] | Loss=0.02461 | Reg=0.00200 | L2-Norm=14.125 | L2-Norm(final)=2.711 | acc=1.0000 | 4487.0 samples/s | 70.1 steps/s
[Step=8550 Epoch=41.7] | Loss=0.02329 | Reg=0.00200 | L2-Norm=14.133 | L2-Norm(final)=2.715 | acc=0.9688 | 4449.9 samples/s | 69.5 steps/s
[Step=8600 Epoch=42.0] | Loss=0.02215 | Reg=0.00200 | L2-Norm=14.141 | L2-Norm(final)=2.720 | acc=1.0000 | 4887.9 samples/s | 76.4 steps/s
[Step=8650 Epoch=42.2] | Loss=0.02119 | Reg=0.00200 | L2-Norm=14.148 | L2-Norm(final)=2.724 | acc=1.0000 | 1593.6 samples/s | 24.9 steps/s
[Step=8700 Epoch=42.5] | Loss=0.02036 | Reg=0.00200 | L2-Norm=14.156 | L2-Norm(final)=2.728 | acc=1.0000 | 4484.2 samples/s | 70.1 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01968 | Reg=0.00201 | L2-Norm=14.162 | L2-Norm(final)=2.732 | acc=1.0000 | 4469.0 samples/s | 69.8 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01905 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=2.736 | acc=1.0000 | 4767.0 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step8800.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00050, len=1
[Step=6401 Epoch=31.2] | Loss=0.27809 | Reg=0.00193 | L2-Norm=13.885 | L2-Norm(final)=2.704 | acc=0.7969 | 3307.2 samples/s | 51.7 steps/s
[Step=6450 Epoch=31.4] | Loss=0.07041 | Reg=0.00195 | L2-Norm=13.958 | L2-Norm(final)=2.670 | acc=0.9844 | 4345.7 samples/s | 67.9 steps/s
[Step=6500 Epoch=31.7] | Loss=0.04992 | Reg=0.00196 | L2-Norm=14.001 | L2-Norm(final)=2.677 | acc=0.9688 | 4514.1 samples/s | 70.5 steps/s
[Step=6550 Epoch=31.9] | Loss=0.04316 | Reg=0.00197 | L2-Norm=14.026 | L2-Norm(final)=2.682 | acc=0.9688 | 4460.6 samples/s | 69.7 steps/s
[Step=6600 Epoch=32.2] | Loss=0.03944 | Reg=0.00197 | L2-Norm=14.045 | L2-Norm(final)=2.687 | acc=1.0000 | 5265.8 samples/s | 82.3 steps/s
[Step=6650 Epoch=32.4] | Loss=0.03578 | Reg=0.00198 | L2-Norm=14.063 | L2-Norm(final)=2.690 | acc=1.0000 | 1546.9 samples/s | 24.2 steps/s
[Step=6700 Epoch=32.6] | Loss=0.03226 | Reg=0.00198 | L2-Norm=14.080 | L2-Norm(final)=2.695 | acc=1.0000 | 4545.7 samples/s | 71.0 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03010 | Reg=0.00199 | L2-Norm=14.094 | L2-Norm(final)=2.700 | acc=1.0000 | 4432.9 samples/s | 69.3 steps/s
[Step=6800 Epoch=33.1] | Loss=0.02820 | Reg=0.00199 | L2-Norm=14.108 | L2-Norm(final)=2.705 | acc=1.0000 | 4996.4 samples/s | 78.1 steps/s
[Step=6850 Epoch=33.4] | Loss=0.02649 | Reg=0.00199 | L2-Norm=14.120 | L2-Norm(final)=2.709 | acc=0.9844 | 1587.1 samples/s | 24.8 steps/s
[Step=6900 Epoch=33.6] | Loss=0.02483 | Reg=0.00200 | L2-Norm=14.131 | L2-Norm(final)=2.714 | acc=1.0000 | 4474.8 samples/s | 69.9 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02381 | Reg=0.00200 | L2-Norm=14.140 | L2-Norm(final)=2.718 | acc=0.9844 | 4512.9 samples/s | 70.5 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02298 | Reg=0.00200 | L2-Norm=14.149 | L2-Norm(final)=2.722 | acc=0.9844 | 5209.5 samples/s | 81.4 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02199 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=2.726 | acc=0.9844 | 1578.0 samples/s | 24.7 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02134 | Reg=0.00201 | L2-Norm=14.165 | L2-Norm(final)=2.730 | acc=1.0000 | 4467.2 samples/s | 69.8 steps/s
[Step=7150 Epoch=34.8] | Loss=0.02052 | Reg=0.00201 | L2-Norm=14.173 | L2-Norm(final)=2.733 | acc=1.0000 | 4541.6 samples/s | 71.0 steps/s
[Step=7200 Epoch=35.1] | Loss=0.01978 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=2.737 | acc=0.9844 | 4680.9 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step7200.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00050, len=1
[Step=6401 Epoch=31.4] | Loss=0.30047 | Reg=0.00193 | L2-Norm=13.885 | L2-Norm(final)=2.703 | acc=0.7656 | 3910.8 samples/s | 61.1 steps/s
[Step=6450 Epoch=31.6] | Loss=0.05940 | Reg=0.00195 | L2-Norm=13.957 | L2-Norm(final)=2.675 | acc=0.9688 | 4378.3 samples/s | 68.4 steps/s
[Step=6500 Epoch=31.9] | Loss=0.04882 | Reg=0.00196 | L2-Norm=13.986 | L2-Norm(final)=2.673 | acc=0.9688 | 4511.6 samples/s | 70.5 steps/s
[Step=6550 Epoch=32.1] | Loss=0.04448 | Reg=0.00196 | L2-Norm=14.009 | L2-Norm(final)=2.675 | acc=0.9844 | 4547.2 samples/s | 71.0 steps/s
[Step=6600 Epoch=32.4] | Loss=0.04053 | Reg=0.00197 | L2-Norm=14.029 | L2-Norm(final)=2.677 | acc=0.9688 | 5286.5 samples/s | 82.6 steps/s
[Step=6650 Epoch=32.6] | Loss=0.03554 | Reg=0.00197 | L2-Norm=14.047 | L2-Norm(final)=2.680 | acc=0.9688 | 1144.3 samples/s | 17.9 steps/s
[Step=6700 Epoch=32.9] | Loss=0.03203 | Reg=0.00198 | L2-Norm=14.062 | L2-Norm(final)=2.684 | acc=0.9844 | 4476.2 samples/s | 69.9 steps/s
[Step=6750 Epoch=33.1] | Loss=0.02944 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=2.690 | acc=0.9844 | 4468.4 samples/s | 69.8 steps/s
[Step=6800 Epoch=33.3] | Loss=0.02770 | Reg=0.00198 | L2-Norm=14.088 | L2-Norm(final)=2.695 | acc=0.9688 | 5128.6 samples/s | 80.1 steps/s
[Step=6850 Epoch=33.6] | Loss=0.02545 | Reg=0.00199 | L2-Norm=14.099 | L2-Norm(final)=2.699 | acc=1.0000 | 1563.7 samples/s | 24.4 steps/s
[Step=6900 Epoch=33.8] | Loss=0.02431 | Reg=0.00199 | L2-Norm=14.109 | L2-Norm(final)=2.704 | acc=1.0000 | 4539.5 samples/s | 70.9 steps/s
[Step=6950 Epoch=34.1] | Loss=0.02293 | Reg=0.00199 | L2-Norm=14.118 | L2-Norm(final)=2.708 | acc=1.0000 | 4397.3 samples/s | 68.7 steps/s
[Step=7000 Epoch=34.3] | Loss=0.02249 | Reg=0.00200 | L2-Norm=14.128 | L2-Norm(final)=2.712 | acc=0.9844 | 5041.1 samples/s | 78.8 steps/s
[Step=7050 Epoch=34.6] | Loss=0.02151 | Reg=0.00200 | L2-Norm=14.137 | L2-Norm(final)=2.716 | acc=1.0000 | 1583.6 samples/s | 24.7 steps/s
[Step=7100 Epoch=34.8] | Loss=0.02055 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=2.720 | acc=1.0000 | 4469.1 samples/s | 69.8 steps/s
[Step=7150 Epoch=35.1] | Loss=0.01963 | Reg=0.00200 | L2-Norm=14.153 | L2-Norm(final)=2.723 | acc=1.0000 | 4491.2 samples/s | 70.2 steps/s
[Step=7200 Epoch=35.3] | Loss=0.01905 | Reg=0.00201 | L2-Norm=14.160 | L2-Norm(final)=2.727 | acc=1.0000 | 4935.7 samples/s | 77.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step7200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=76.4] | Loss=0.07088 | Reg=0.00193 | L2-Norm=13.885 | L2-Norm(final)=2.704 | acc=0.9531 | 3534.7 samples/s | 55.2 steps/s
[Step=8050 Epoch=76.9] | Loss=0.00613 | Reg=0.00196 | L2-Norm=13.985 | L2-Norm(final)=2.697 | acc=0.9844 | 4414.6 samples/s | 69.0 steps/s
[Step=8100 Epoch=77.4] | Loss=0.00492 | Reg=0.00197 | L2-Norm=14.021 | L2-Norm(final)=2.700 | acc=1.0000 | 5185.5 samples/s | 81.0 steps/s
[Step=8150 Epoch=77.8] | Loss=0.00331 | Reg=0.00197 | L2-Norm=14.039 | L2-Norm(final)=2.700 | acc=1.0000 | 1500.4 samples/s | 23.4 steps/s
[Step=8200 Epoch=78.3] | Loss=0.00253 | Reg=0.00197 | L2-Norm=14.040 | L2-Norm(final)=2.701 | acc=1.0000 | 4954.9 samples/s | 77.4 steps/s
[Step=8250 Epoch=78.8] | Loss=0.00203 | Reg=0.00197 | L2-Norm=14.035 | L2-Norm(final)=2.703 | acc=1.0000 | 1538.1 samples/s | 24.0 steps/s
[Step=8300 Epoch=79.3] | Loss=0.00169 | Reg=0.00197 | L2-Norm=14.025 | L2-Norm(final)=2.704 | acc=1.0000 | 4834.2 samples/s | 75.5 steps/s
[Step=8350 Epoch=79.7] | Loss=0.00145 | Reg=0.00196 | L2-Norm=14.012 | L2-Norm(final)=2.706 | acc=1.0000 | 1533.1 samples/s | 24.0 steps/s
[Step=8400 Epoch=80.2] | Loss=0.00127 | Reg=0.00196 | L2-Norm=13.998 | L2-Norm(final)=2.707 | acc=1.0000 | 4705.5 samples/s | 73.5 steps/s
[Step=8450 Epoch=80.7] | Loss=0.00113 | Reg=0.00196 | L2-Norm=13.982 | L2-Norm(final)=2.708 | acc=1.0000 | 1560.2 samples/s | 24.4 steps/s
[Step=8500 Epoch=81.2] | Loss=0.00102 | Reg=0.00195 | L2-Norm=13.966 | L2-Norm(final)=2.709 | acc=1.0000 | 4550.1 samples/s | 71.1 steps/s
[Step=8550 Epoch=81.6] | Loss=0.00093 | Reg=0.00195 | L2-Norm=13.949 | L2-Norm(final)=2.710 | acc=1.0000 | 1538.8 samples/s | 24.0 steps/s
[Step=8600 Epoch=82.1] | Loss=0.00085 | Reg=0.00194 | L2-Norm=13.932 | L2-Norm(final)=2.711 | acc=1.0000 | 3800.1 samples/s | 59.4 steps/s
[Step=8650 Epoch=82.6] | Loss=0.00078 | Reg=0.00194 | L2-Norm=13.914 | L2-Norm(final)=2.712 | acc=1.0000 | 1610.5 samples/s | 25.2 steps/s
[Step=8700 Epoch=83.1] | Loss=0.00073 | Reg=0.00193 | L2-Norm=13.896 | L2-Norm(final)=2.713 | acc=1.0000 | 4370.4 samples/s | 68.3 steps/s
[Step=8750 Epoch=83.6] | Loss=0.00068 | Reg=0.00193 | L2-Norm=13.878 | L2-Norm(final)=2.713 | acc=1.0000 | 1756.5 samples/s | 27.4 steps/s
[Step=8800 Epoch=84.0] | Loss=0.00064 | Reg=0.00192 | L2-Norm=13.860 | L2-Norm(final)=2.714 | acc=1.0000 | 4290.6 samples/s | 67.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step8800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00050, len=1
[Step=5601 Epoch=52.8] | Loss=0.00739 | Reg=0.00193 | L2-Norm=13.885 | L2-Norm(final)=2.705 | acc=1.0000 | 3801.0 samples/s | 59.4 steps/s
[Step=5650 Epoch=53.2] | Loss=0.00411 | Reg=0.00195 | L2-Norm=13.980 | L2-Norm(final)=2.721 | acc=1.0000 | 4211.4 samples/s | 65.8 steps/s
[Step=5700 Epoch=53.7] | Loss=0.00677 | Reg=0.00197 | L2-Norm=14.023 | L2-Norm(final)=2.716 | acc=1.0000 | 5073.4 samples/s | 79.3 steps/s
[Step=5750 Epoch=54.2] | Loss=0.00529 | Reg=0.00198 | L2-Norm=14.065 | L2-Norm(final)=2.703 | acc=1.0000 | 1514.8 samples/s | 23.7 steps/s
[Step=5800 Epoch=54.7] | Loss=0.00425 | Reg=0.00199 | L2-Norm=14.091 | L2-Norm(final)=2.697 | acc=1.0000 | 4807.2 samples/s | 75.1 steps/s
[Step=5850 Epoch=55.1] | Loss=0.00341 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=2.696 | acc=1.0000 | 1533.1 samples/s | 24.0 steps/s
[Step=5900 Epoch=55.6] | Loss=0.00285 | Reg=0.00199 | L2-Norm=14.107 | L2-Norm(final)=2.695 | acc=1.0000 | 4478.4 samples/s | 70.0 steps/s
[Step=5950 Epoch=56.1] | Loss=0.00245 | Reg=0.00199 | L2-Norm=14.105 | L2-Norm(final)=2.695 | acc=1.0000 | 1545.5 samples/s | 24.1 steps/s
[Step=6000 Epoch=56.5] | Loss=0.00214 | Reg=0.00199 | L2-Norm=14.100 | L2-Norm(final)=2.696 | acc=1.0000 | 4346.6 samples/s | 67.9 steps/s
[Step=6050 Epoch=57.0] | Loss=0.00191 | Reg=0.00199 | L2-Norm=14.093 | L2-Norm(final)=2.696 | acc=1.0000 | 1591.3 samples/s | 24.9 steps/s
[Step=6100 Epoch=57.5] | Loss=0.00172 | Reg=0.00198 | L2-Norm=14.084 | L2-Norm(final)=2.697 | acc=1.0000 | 4350.2 samples/s | 68.0 steps/s
[Step=6150 Epoch=58.0] | Loss=0.00156 | Reg=0.00198 | L2-Norm=14.074 | L2-Norm(final)=2.697 | acc=1.0000 | 1612.6 samples/s | 25.2 steps/s
[Step=6200 Epoch=58.4] | Loss=0.00143 | Reg=0.00198 | L2-Norm=14.062 | L2-Norm(final)=2.698 | acc=1.0000 | 4313.5 samples/s | 67.4 steps/s
[Step=6250 Epoch=58.9] | Loss=0.00132 | Reg=0.00197 | L2-Norm=14.050 | L2-Norm(final)=2.698 | acc=1.0000 | 1595.1 samples/s | 24.9 steps/s
[Step=6300 Epoch=59.4] | Loss=0.00123 | Reg=0.00197 | L2-Norm=14.038 | L2-Norm(final)=2.699 | acc=1.0000 | 3727.6 samples/s | 58.2 steps/s
[Step=6350 Epoch=59.8] | Loss=0.00115 | Reg=0.00197 | L2-Norm=14.025 | L2-Norm(final)=2.700 | acc=1.0000 | 1641.0 samples/s | 25.6 steps/s
[Step=6400 Epoch=60.3] | Loss=0.00108 | Reg=0.00196 | L2-Norm=14.012 | L2-Norm(final)=2.700 | acc=1.0000 | 3907.6 samples/s | 61.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41361 | acc=0.7346 | tpr=0.6170 | fpr=0.0099 | 4385.6 samples/s | 17.1 steps/s
Avg test loss: 0.41482, Avg test acc: 0.73544, Avg tpr: 0.61963, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.31269 | acc=0.8823 | tpr=0.9558 | fpr=0.1191 | 4580.0 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.31605 | acc=0.8830 | tpr=0.9680 | fpr=0.1185 | 9129.4 samples/s | 35.7 steps/s
[Step= 150] | Loss=0.32050 | acc=0.8819 | tpr=0.9712 | fpr=0.1198 | 9152.0 samples/s | 35.7 steps/s
[Step= 200] | Loss=0.32336 | acc=0.8815 | tpr=0.9727 | fpr=0.1201 | 9675.8 samples/s | 37.8 steps/s
[Step= 250] | Loss=0.32190 | acc=0.8817 | tpr=0.9712 | fpr=0.1199 | 8759.4 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.32511 | acc=0.8810 | tpr=0.9724 | fpr=0.1207 | 9292.1 samples/s | 36.3 steps/s
[Step= 350] | Loss=0.32596 | acc=0.8809 | tpr=0.9724 | fpr=0.1207 | 8708.2 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.32737 | acc=0.8811 | tpr=0.9721 | fpr=0.1206 | 8535.5 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.33135 | acc=0.8803 | tpr=0.9713 | fpr=0.1213 | 8502.1 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.33081 | acc=0.8799 | tpr=0.9722 | fpr=0.1218 | 8462.2 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.33024 | acc=0.8797 | tpr=0.9713 | fpr=0.1219 | 16178.0 samples/s | 63.2 steps/s
Avg test loss: 0.33004, Avg test acc: 0.87979, Avg tpr: 0.97068, Avg fpr: 0.12187, total FA: 16921

server round 19/50

clients selected: [0 1 4 5 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.14282 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=2.727 | acc=0.8750 | 4149.9 samples/s | 64.8 steps/s
[Step=8050 Epoch=39.3] | Loss=0.05795 | Reg=0.00193 | L2-Norm=13.883 | L2-Norm(final)=2.705 | acc=0.9844 | 3987.5 samples/s | 62.3 steps/s
[Step=8100 Epoch=39.5] | Loss=0.04218 | Reg=0.00194 | L2-Norm=13.923 | L2-Norm(final)=2.711 | acc=0.9844 | 4417.7 samples/s | 69.0 steps/s
[Step=8150 Epoch=39.7] | Loss=0.03722 | Reg=0.00195 | L2-Norm=13.949 | L2-Norm(final)=2.716 | acc=0.9844 | 4453.8 samples/s | 69.6 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03601 | Reg=0.00195 | L2-Norm=13.968 | L2-Norm(final)=2.718 | acc=0.9219 | 5190.6 samples/s | 81.1 steps/s
[Step=8250 Epoch=40.2] | Loss=0.03128 | Reg=0.00196 | L2-Norm=13.985 | L2-Norm(final)=2.723 | acc=0.9844 | 1500.2 samples/s | 23.4 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02876 | Reg=0.00196 | L2-Norm=14.000 | L2-Norm(final)=2.729 | acc=0.9844 | 3831.2 samples/s | 59.9 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02688 | Reg=0.00196 | L2-Norm=14.014 | L2-Norm(final)=2.734 | acc=0.9844 | 3903.6 samples/s | 61.0 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02491 | Reg=0.00197 | L2-Norm=14.027 | L2-Norm(final)=2.740 | acc=0.9688 | 4633.4 samples/s | 72.4 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02335 | Reg=0.00197 | L2-Norm=14.040 | L2-Norm(final)=2.747 | acc=1.0000 | 1585.1 samples/s | 24.8 steps/s
[Step=8500 Epoch=41.4] | Loss=0.02204 | Reg=0.00197 | L2-Norm=14.051 | L2-Norm(final)=2.753 | acc=1.0000 | 4485.3 samples/s | 70.1 steps/s
[Step=8550 Epoch=41.7] | Loss=0.02147 | Reg=0.00198 | L2-Norm=14.060 | L2-Norm(final)=2.757 | acc=1.0000 | 4431.1 samples/s | 69.2 steps/s
[Step=8600 Epoch=41.9] | Loss=0.02052 | Reg=0.00198 | L2-Norm=14.069 | L2-Norm(final)=2.762 | acc=0.9844 | 4377.4 samples/s | 68.4 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01954 | Reg=0.00198 | L2-Norm=14.078 | L2-Norm(final)=2.767 | acc=1.0000 | 1553.3 samples/s | 24.3 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01891 | Reg=0.00198 | L2-Norm=14.085 | L2-Norm(final)=2.772 | acc=1.0000 | 3955.2 samples/s | 61.8 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01818 | Reg=0.00199 | L2-Norm=14.093 | L2-Norm(final)=2.776 | acc=0.9844 | 3889.6 samples/s | 60.8 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01760 | Reg=0.00199 | L2-Norm=14.100 | L2-Norm(final)=2.781 | acc=1.0000 | 4187.7 samples/s | 65.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.28411 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=2.726 | acc=0.8438 | 3255.0 samples/s | 50.9 steps/s
[Step=8850 Epoch=43.2] | Loss=0.06796 | Reg=0.00193 | L2-Norm=13.887 | L2-Norm(final)=2.688 | acc=0.9688 | 4068.1 samples/s | 63.6 steps/s
[Step=8900 Epoch=43.4] | Loss=0.05067 | Reg=0.00194 | L2-Norm=13.927 | L2-Norm(final)=2.690 | acc=0.9375 | 3894.8 samples/s | 60.9 steps/s
[Step=8950 Epoch=43.7] | Loss=0.04454 | Reg=0.00195 | L2-Norm=13.952 | L2-Norm(final)=2.692 | acc=0.9844 | 3916.3 samples/s | 61.2 steps/s
[Step=9000 Epoch=43.9] | Loss=0.04030 | Reg=0.00195 | L2-Norm=13.971 | L2-Norm(final)=2.693 | acc=0.9844 | 4851.5 samples/s | 75.8 steps/s
[Step=9050 Epoch=44.2] | Loss=0.03485 | Reg=0.00196 | L2-Norm=13.987 | L2-Norm(final)=2.696 | acc=1.0000 | 1565.6 samples/s | 24.5 steps/s
[Step=9100 Epoch=44.4] | Loss=0.03124 | Reg=0.00196 | L2-Norm=14.002 | L2-Norm(final)=2.702 | acc=1.0000 | 4369.8 samples/s | 68.3 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02940 | Reg=0.00196 | L2-Norm=14.014 | L2-Norm(final)=2.706 | acc=0.9844 | 4428.8 samples/s | 69.2 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02788 | Reg=0.00197 | L2-Norm=14.026 | L2-Norm(final)=2.711 | acc=1.0000 | 5071.3 samples/s | 79.2 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02622 | Reg=0.00197 | L2-Norm=14.037 | L2-Norm(final)=2.715 | acc=0.9844 | 1548.8 samples/s | 24.2 steps/s
[Step=9300 Epoch=45.4] | Loss=0.02458 | Reg=0.00197 | L2-Norm=14.048 | L2-Norm(final)=2.721 | acc=1.0000 | 4511.4 samples/s | 70.5 steps/s
[Step=9350 Epoch=45.6] | Loss=0.02347 | Reg=0.00198 | L2-Norm=14.058 | L2-Norm(final)=2.726 | acc=1.0000 | 4356.9 samples/s | 68.1 steps/s
[Step=9400 Epoch=45.9] | Loss=0.02223 | Reg=0.00198 | L2-Norm=14.067 | L2-Norm(final)=2.731 | acc=0.9844 | 4977.0 samples/s | 77.8 steps/s
[Step=9450 Epoch=46.1] | Loss=0.02121 | Reg=0.00198 | L2-Norm=14.075 | L2-Norm(final)=2.737 | acc=1.0000 | 1586.2 samples/s | 24.8 steps/s
[Step=9500 Epoch=46.4] | Loss=0.02028 | Reg=0.00198 | L2-Norm=14.082 | L2-Norm(final)=2.742 | acc=1.0000 | 4534.8 samples/s | 70.9 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01944 | Reg=0.00199 | L2-Norm=14.090 | L2-Norm(final)=2.747 | acc=1.0000 | 4504.5 samples/s | 70.4 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01904 | Reg=0.00199 | L2-Norm=14.096 | L2-Norm(final)=2.752 | acc=1.0000 | 4785.3 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step9600.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00050, len=1
[Step=7201 Epoch=35.3] | Loss=0.27382 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=2.726 | acc=0.7812 | 3803.6 samples/s | 59.4 steps/s
[Step=7250 Epoch=35.6] | Loss=0.06222 | Reg=0.00193 | L2-Norm=13.893 | L2-Norm(final)=2.699 | acc=0.9219 | 4292.0 samples/s | 67.1 steps/s
[Step=7300 Epoch=35.8] | Loss=0.04886 | Reg=0.00194 | L2-Norm=13.929 | L2-Norm(final)=2.699 | acc=0.9688 | 4077.3 samples/s | 63.7 steps/s
[Step=7350 Epoch=36.0] | Loss=0.04283 | Reg=0.00195 | L2-Norm=13.952 | L2-Norm(final)=2.700 | acc=1.0000 | 3930.2 samples/s | 61.4 steps/s
[Step=7400 Epoch=36.3] | Loss=0.03836 | Reg=0.00195 | L2-Norm=13.971 | L2-Norm(final)=2.704 | acc=1.0000 | 4888.9 samples/s | 76.4 steps/s
[Step=7450 Epoch=36.5] | Loss=0.03317 | Reg=0.00196 | L2-Norm=13.989 | L2-Norm(final)=2.710 | acc=1.0000 | 1592.2 samples/s | 24.9 steps/s
[Step=7500 Epoch=36.8] | Loss=0.02979 | Reg=0.00196 | L2-Norm=14.006 | L2-Norm(final)=2.717 | acc=1.0000 | 4432.5 samples/s | 69.3 steps/s
[Step=7550 Epoch=37.0] | Loss=0.02811 | Reg=0.00197 | L2-Norm=14.019 | L2-Norm(final)=2.722 | acc=1.0000 | 4453.3 samples/s | 69.6 steps/s
[Step=7600 Epoch=37.3] | Loss=0.02625 | Reg=0.00197 | L2-Norm=14.030 | L2-Norm(final)=2.727 | acc=0.9844 | 5167.1 samples/s | 80.7 steps/s
[Step=7650 Epoch=37.5] | Loss=0.02462 | Reg=0.00197 | L2-Norm=14.041 | L2-Norm(final)=2.732 | acc=0.9531 | 1562.3 samples/s | 24.4 steps/s
[Step=7700 Epoch=37.8] | Loss=0.02293 | Reg=0.00197 | L2-Norm=14.051 | L2-Norm(final)=2.737 | acc=0.9844 | 4515.5 samples/s | 70.6 steps/s
[Step=7750 Epoch=38.0] | Loss=0.02189 | Reg=0.00198 | L2-Norm=14.060 | L2-Norm(final)=2.742 | acc=0.9844 | 4499.8 samples/s | 70.3 steps/s
[Step=7800 Epoch=38.2] | Loss=0.02089 | Reg=0.00198 | L2-Norm=14.069 | L2-Norm(final)=2.746 | acc=1.0000 | 5113.8 samples/s | 79.9 steps/s
[Step=7850 Epoch=38.5] | Loss=0.02004 | Reg=0.00198 | L2-Norm=14.077 | L2-Norm(final)=2.751 | acc=1.0000 | 1576.8 samples/s | 24.6 steps/s
[Step=7900 Epoch=38.7] | Loss=0.01897 | Reg=0.00198 | L2-Norm=14.084 | L2-Norm(final)=2.755 | acc=1.0000 | 4451.5 samples/s | 69.6 steps/s
[Step=7950 Epoch=39.0] | Loss=0.01832 | Reg=0.00199 | L2-Norm=14.091 | L2-Norm(final)=2.759 | acc=1.0000 | 4469.1 samples/s | 69.8 steps/s
[Step=8000 Epoch=39.2] | Loss=0.01767 | Reg=0.00199 | L2-Norm=14.097 | L2-Norm(final)=2.763 | acc=1.0000 | 4895.2 samples/s | 76.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step8000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=7201 Epoch=68.2] | Loss=0.02599 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=2.728 | acc=0.9688 | 3296.9 samples/s | 51.5 steps/s
[Step=7250 Epoch=68.7] | Loss=0.00512 | Reg=0.00193 | L2-Norm=13.889 | L2-Norm(final)=2.735 | acc=1.0000 | 4120.7 samples/s | 64.4 steps/s
[Step=7300 Epoch=69.2] | Loss=0.00274 | Reg=0.00194 | L2-Norm=13.919 | L2-Norm(final)=2.746 | acc=1.0000 | 5121.3 samples/s | 80.0 steps/s
[Step=7350 Epoch=69.6] | Loss=0.00185 | Reg=0.00194 | L2-Norm=13.920 | L2-Norm(final)=2.753 | acc=1.0000 | 1517.7 samples/s | 23.7 steps/s
[Step=7400 Epoch=70.1] | Loss=0.00139 | Reg=0.00194 | L2-Norm=13.911 | L2-Norm(final)=2.757 | acc=1.0000 | 4841.6 samples/s | 75.7 steps/s
[Step=7450 Epoch=70.6] | Loss=0.00112 | Reg=0.00193 | L2-Norm=13.896 | L2-Norm(final)=2.760 | acc=1.0000 | 1525.8 samples/s | 23.8 steps/s
[Step=7500 Epoch=71.1] | Loss=0.00093 | Reg=0.00193 | L2-Norm=13.880 | L2-Norm(final)=2.763 | acc=1.0000 | 4701.9 samples/s | 73.5 steps/s
[Step=7550 Epoch=71.5] | Loss=0.00080 | Reg=0.00192 | L2-Norm=13.862 | L2-Norm(final)=2.765 | acc=1.0000 | 1562.1 samples/s | 24.4 steps/s
[Step=7600 Epoch=72.0] | Loss=0.00070 | Reg=0.00192 | L2-Norm=13.843 | L2-Norm(final)=2.767 | acc=1.0000 | 4586.8 samples/s | 71.7 steps/s
[Step=7650 Epoch=72.5] | Loss=0.00062 | Reg=0.00191 | L2-Norm=13.824 | L2-Norm(final)=2.768 | acc=1.0000 | 1578.3 samples/s | 24.7 steps/s
[Step=7700 Epoch=73.0] | Loss=0.00056 | Reg=0.00191 | L2-Norm=13.805 | L2-Norm(final)=2.770 | acc=1.0000 | 4254.8 samples/s | 66.5 steps/s
[Step=7750 Epoch=73.4] | Loss=0.00051 | Reg=0.00190 | L2-Norm=13.785 | L2-Norm(final)=2.771 | acc=1.0000 | 1596.6 samples/s | 24.9 steps/s
[Step=7800 Epoch=73.9] | Loss=0.00047 | Reg=0.00189 | L2-Norm=13.765 | L2-Norm(final)=2.772 | acc=1.0000 | 4277.8 samples/s | 66.8 steps/s
[Step=7850 Epoch=74.4] | Loss=0.00043 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=2.773 | acc=1.0000 | 1600.5 samples/s | 25.0 steps/s
[Step=7900 Epoch=74.9] | Loss=0.00040 | Reg=0.00188 | L2-Norm=13.724 | L2-Norm(final)=2.774 | acc=1.0000 | 4292.3 samples/s | 67.1 steps/s
[Step=7950 Epoch=75.3] | Loss=0.00038 | Reg=0.00188 | L2-Norm=13.704 | L2-Norm(final)=2.775 | acc=1.0000 | 1631.2 samples/s | 25.5 steps/s
[Step=8000 Epoch=75.8] | Loss=0.00035 | Reg=0.00187 | L2-Norm=13.683 | L2-Norm(final)=2.776 | acc=1.0000 | 4203.2 samples/s | 65.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=76.3] | Loss=0.10835 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=2.726 | acc=0.9375 | 3882.5 samples/s | 60.7 steps/s
[Step=8050 Epoch=76.7] | Loss=0.00956 | Reg=0.00194 | L2-Norm=13.927 | L2-Norm(final)=2.708 | acc=1.0000 | 3999.6 samples/s | 62.5 steps/s
[Step=8100 Epoch=77.2] | Loss=0.00586 | Reg=0.00195 | L2-Norm=13.974 | L2-Norm(final)=2.707 | acc=1.0000 | 5117.0 samples/s | 80.0 steps/s
[Step=8150 Epoch=77.7] | Loss=0.00397 | Reg=0.00196 | L2-Norm=13.994 | L2-Norm(final)=2.713 | acc=1.0000 | 1498.4 samples/s | 23.4 steps/s
[Step=8200 Epoch=78.2] | Loss=0.00299 | Reg=0.00196 | L2-Norm=13.995 | L2-Norm(final)=2.717 | acc=1.0000 | 4933.8 samples/s | 77.1 steps/s
[Step=8250 Epoch=78.6] | Loss=0.00239 | Reg=0.00196 | L2-Norm=13.989 | L2-Norm(final)=2.721 | acc=1.0000 | 1692.1 samples/s | 26.4 steps/s
[Step=8300 Epoch=79.1] | Loss=0.00200 | Reg=0.00195 | L2-Norm=13.978 | L2-Norm(final)=2.724 | acc=1.0000 | 4704.7 samples/s | 73.5 steps/s
[Step=8350 Epoch=79.6] | Loss=0.00172 | Reg=0.00195 | L2-Norm=13.964 | L2-Norm(final)=2.727 | acc=1.0000 | 1536.2 samples/s | 24.0 steps/s
[Step=8400 Epoch=80.1] | Loss=0.00150 | Reg=0.00195 | L2-Norm=13.949 | L2-Norm(final)=2.729 | acc=1.0000 | 4579.5 samples/s | 71.6 steps/s
[Step=8450 Epoch=80.5] | Loss=0.00134 | Reg=0.00194 | L2-Norm=13.932 | L2-Norm(final)=2.730 | acc=1.0000 | 1559.3 samples/s | 24.4 steps/s
[Step=8500 Epoch=81.0] | Loss=0.00120 | Reg=0.00194 | L2-Norm=13.915 | L2-Norm(final)=2.732 | acc=1.0000 | 4490.9 samples/s | 70.2 steps/s
[Step=8550 Epoch=81.5] | Loss=0.00110 | Reg=0.00193 | L2-Norm=13.897 | L2-Norm(final)=2.734 | acc=1.0000 | 1587.2 samples/s | 24.8 steps/s
[Step=8600 Epoch=82.0] | Loss=0.00101 | Reg=0.00193 | L2-Norm=13.879 | L2-Norm(final)=2.735 | acc=1.0000 | 4404.4 samples/s | 68.8 steps/s
[Step=8650 Epoch=82.4] | Loss=0.00093 | Reg=0.00192 | L2-Norm=13.861 | L2-Norm(final)=2.736 | acc=1.0000 | 1755.5 samples/s | 27.4 steps/s
[Step=8700 Epoch=82.9] | Loss=0.00086 | Reg=0.00192 | L2-Norm=13.842 | L2-Norm(final)=2.738 | acc=1.0000 | 4287.1 samples/s | 67.0 steps/s
[Step=8750 Epoch=83.4] | Loss=0.00081 | Reg=0.00191 | L2-Norm=13.823 | L2-Norm(final)=2.739 | acc=1.0000 | 1597.3 samples/s | 25.0 steps/s
[Step=8800 Epoch=83.9] | Loss=0.00076 | Reg=0.00191 | L2-Norm=13.804 | L2-Norm(final)=2.740 | acc=1.0000 | 4234.2 samples/s | 66.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36205 | acc=0.7672 | tpr=0.6647 | fpr=0.0102 | 4360.9 samples/s | 17.0 steps/s
Avg test loss: 0.36357, Avg test acc: 0.76805, Avg tpr: 0.66725, Avg fpr: 0.01026, total FA: 80

Testing server on iccad2012
[Step=  50] | Loss=0.34114 | acc=0.8725 | tpr=0.9646 | fpr=0.1292 | 4378.3 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.34486 | acc=0.8718 | tpr=0.9723 | fpr=0.1301 | 9035.6 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.34969 | acc=0.8708 | tpr=0.9741 | fpr=0.1311 | 8615.9 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.35277 | acc=0.8700 | tpr=0.9738 | fpr=0.1318 | 8739.8 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.35106 | acc=0.8698 | tpr=0.9712 | fpr=0.1320 | 9121.7 samples/s | 35.6 steps/s
[Step= 300] | Loss=0.35454 | acc=0.8685 | tpr=0.9724 | fpr=0.1334 | 8660.3 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.35538 | acc=0.8684 | tpr=0.9718 | fpr=0.1334 | 8652.4 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.35665 | acc=0.8687 | tpr=0.9721 | fpr=0.1332 | 9038.1 samples/s | 35.3 steps/s
[Step= 450] | Loss=0.36062 | acc=0.8682 | tpr=0.9718 | fpr=0.1337 | 8876.8 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.36011 | acc=0.8678 | tpr=0.9727 | fpr=0.1341 | 8530.5 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.35952 | acc=0.8678 | tpr=0.9713 | fpr=0.1341 | 16091.5 samples/s | 62.9 steps/s
Avg test loss: 0.35937, Avg test acc: 0.86778, Avg tpr: 0.97029, Avg fpr: 0.13408, total FA: 18617

server round 20/50

clients selected: [0 2 3 5 6]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=8801 Epoch=42.9] | Loss=0.19064 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=2.766 | acc=0.8906 | 4109.2 samples/s | 64.2 steps/s
[Step=8850 Epoch=43.2] | Loss=0.04786 | Reg=0.00189 | L2-Norm=13.752 | L2-Norm(final)=2.757 | acc=0.9688 | 4201.6 samples/s | 65.6 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03735 | Reg=0.00189 | L2-Norm=13.762 | L2-Norm(final)=2.756 | acc=1.0000 | 4463.4 samples/s | 69.7 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03205 | Reg=0.00190 | L2-Norm=13.771 | L2-Norm(final)=2.760 | acc=1.0000 | 4398.3 samples/s | 68.7 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02839 | Reg=0.00190 | L2-Norm=13.781 | L2-Norm(final)=2.766 | acc=0.9844 | 5216.6 samples/s | 81.5 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02633 | Reg=0.00190 | L2-Norm=13.790 | L2-Norm(final)=2.771 | acc=1.0000 | 1532.8 samples/s | 23.9 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02388 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=2.777 | acc=1.0000 | 4469.0 samples/s | 69.8 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02251 | Reg=0.00191 | L2-Norm=13.806 | L2-Norm(final)=2.782 | acc=0.9844 | 4537.4 samples/s | 70.9 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02093 | Reg=0.00191 | L2-Norm=13.813 | L2-Norm(final)=2.787 | acc=1.0000 | 5108.1 samples/s | 79.8 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01935 | Reg=0.00191 | L2-Norm=13.820 | L2-Norm(final)=2.793 | acc=0.9844 | 1578.2 samples/s | 24.7 steps/s
[Step=9300 Epoch=45.3] | Loss=0.01803 | Reg=0.00191 | L2-Norm=13.827 | L2-Norm(final)=2.799 | acc=0.9844 | 4477.5 samples/s | 70.0 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01710 | Reg=0.00191 | L2-Norm=13.833 | L2-Norm(final)=2.804 | acc=0.9844 | 4502.1 samples/s | 70.3 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01617 | Reg=0.00191 | L2-Norm=13.838 | L2-Norm(final)=2.810 | acc=1.0000 | 4816.9 samples/s | 75.3 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01547 | Reg=0.00192 | L2-Norm=13.843 | L2-Norm(final)=2.815 | acc=0.9844 | 1601.7 samples/s | 25.0 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01481 | Reg=0.00192 | L2-Norm=13.848 | L2-Norm(final)=2.820 | acc=1.0000 | 4470.0 samples/s | 69.8 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01423 | Reg=0.00192 | L2-Norm=13.852 | L2-Norm(final)=2.825 | acc=1.0000 | 4457.5 samples/s | 69.6 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01378 | Reg=0.00192 | L2-Norm=13.856 | L2-Norm(final)=2.829 | acc=1.0000 | 4675.8 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step9600.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00025, len=1
[Step=7201 Epoch=35.1] | Loss=0.23250 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=2.766 | acc=0.8438 | 3942.2 samples/s | 61.6 steps/s
[Step=7250 Epoch=35.3] | Loss=0.05174 | Reg=0.00189 | L2-Norm=13.751 | L2-Norm(final)=2.755 | acc=0.9688 | 4408.6 samples/s | 68.9 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04047 | Reg=0.00189 | L2-Norm=13.764 | L2-Norm(final)=2.755 | acc=0.9531 | 4413.0 samples/s | 69.0 steps/s
[Step=7350 Epoch=35.8] | Loss=0.03484 | Reg=0.00190 | L2-Norm=13.773 | L2-Norm(final)=2.757 | acc=1.0000 | 4338.0 samples/s | 67.8 steps/s
[Step=7400 Epoch=36.1] | Loss=0.03020 | Reg=0.00190 | L2-Norm=13.782 | L2-Norm(final)=2.761 | acc=0.9844 | 4980.5 samples/s | 77.8 steps/s
[Step=7450 Epoch=36.3] | Loss=0.02614 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=2.768 | acc=1.0000 | 1500.1 samples/s | 23.4 steps/s
[Step=7500 Epoch=36.5] | Loss=0.02363 | Reg=0.00190 | L2-Norm=13.800 | L2-Norm(final)=2.775 | acc=1.0000 | 3921.4 samples/s | 61.3 steps/s
[Step=7550 Epoch=36.8] | Loss=0.02151 | Reg=0.00191 | L2-Norm=13.809 | L2-Norm(final)=2.782 | acc=0.9844 | 3950.7 samples/s | 61.7 steps/s
[Step=7600 Epoch=37.0] | Loss=0.02002 | Reg=0.00191 | L2-Norm=13.817 | L2-Norm(final)=2.788 | acc=0.9844 | 4674.4 samples/s | 73.0 steps/s
[Step=7650 Epoch=37.3] | Loss=0.01891 | Reg=0.00191 | L2-Norm=13.825 | L2-Norm(final)=2.795 | acc=0.9844 | 1574.8 samples/s | 24.6 steps/s
[Step=7700 Epoch=37.5] | Loss=0.01770 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=2.800 | acc=1.0000 | 4317.8 samples/s | 67.5 steps/s
[Step=7750 Epoch=37.8] | Loss=0.01680 | Reg=0.00191 | L2-Norm=13.838 | L2-Norm(final)=2.806 | acc=1.0000 | 3928.7 samples/s | 61.4 steps/s
[Step=7800 Epoch=38.0] | Loss=0.01598 | Reg=0.00192 | L2-Norm=13.844 | L2-Norm(final)=2.811 | acc=1.0000 | 4416.8 samples/s | 69.0 steps/s
[Step=7850 Epoch=38.2] | Loss=0.01509 | Reg=0.00192 | L2-Norm=13.850 | L2-Norm(final)=2.817 | acc=1.0000 | 1597.3 samples/s | 25.0 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01441 | Reg=0.00192 | L2-Norm=13.855 | L2-Norm(final)=2.822 | acc=1.0000 | 4470.2 samples/s | 69.8 steps/s
[Step=7950 Epoch=38.7] | Loss=0.01398 | Reg=0.00192 | L2-Norm=13.860 | L2-Norm(final)=2.827 | acc=1.0000 | 4413.4 samples/s | 69.0 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01352 | Reg=0.00192 | L2-Norm=13.865 | L2-Norm(final)=2.832 | acc=1.0000 | 4721.1 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00025, len=1
[Step=7201 Epoch=35.1] | Loss=0.22368 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=2.766 | acc=0.8281 | 3993.7 samples/s | 62.4 steps/s
[Step=7250 Epoch=35.4] | Loss=0.05327 | Reg=0.00189 | L2-Norm=13.754 | L2-Norm(final)=2.751 | acc=0.9844 | 4296.9 samples/s | 67.1 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04090 | Reg=0.00189 | L2-Norm=13.766 | L2-Norm(final)=2.751 | acc=0.9844 | 4464.9 samples/s | 69.8 steps/s
[Step=7350 Epoch=35.8] | Loss=0.03409 | Reg=0.00190 | L2-Norm=13.774 | L2-Norm(final)=2.754 | acc=1.0000 | 4415.5 samples/s | 69.0 steps/s
[Step=7400 Epoch=36.1] | Loss=0.03017 | Reg=0.00190 | L2-Norm=13.782 | L2-Norm(final)=2.759 | acc=1.0000 | 5364.8 samples/s | 83.8 steps/s
[Step=7450 Epoch=36.3] | Loss=0.02667 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=2.765 | acc=1.0000 | 1553.1 samples/s | 24.3 steps/s
[Step=7500 Epoch=36.6] | Loss=0.02371 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=2.770 | acc=1.0000 | 4451.3 samples/s | 69.6 steps/s
[Step=7550 Epoch=36.8] | Loss=0.02165 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=2.776 | acc=0.9688 | 4338.5 samples/s | 67.8 steps/s
[Step=7600 Epoch=37.1] | Loss=0.01996 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=2.782 | acc=0.9844 | 4819.2 samples/s | 75.3 steps/s
[Step=7650 Epoch=37.3] | Loss=0.01857 | Reg=0.00191 | L2-Norm=13.820 | L2-Norm(final)=2.788 | acc=0.9844 | 1572.3 samples/s | 24.6 steps/s
[Step=7700 Epoch=37.5] | Loss=0.01741 | Reg=0.00191 | L2-Norm=13.826 | L2-Norm(final)=2.794 | acc=1.0000 | 4484.2 samples/s | 70.1 steps/s
[Step=7750 Epoch=37.8] | Loss=0.01639 | Reg=0.00191 | L2-Norm=13.832 | L2-Norm(final)=2.799 | acc=0.9844 | 4334.6 samples/s | 67.7 steps/s
[Step=7800 Epoch=38.0] | Loss=0.01563 | Reg=0.00191 | L2-Norm=13.838 | L2-Norm(final)=2.805 | acc=1.0000 | 4913.8 samples/s | 76.8 steps/s
[Step=7850 Epoch=38.3] | Loss=0.01483 | Reg=0.00192 | L2-Norm=13.843 | L2-Norm(final)=2.810 | acc=0.9844 | 1648.2 samples/s | 25.8 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01415 | Reg=0.00192 | L2-Norm=13.848 | L2-Norm(final)=2.815 | acc=0.9844 | 4581.6 samples/s | 71.6 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01364 | Reg=0.00192 | L2-Norm=13.853 | L2-Norm(final)=2.820 | acc=1.0000 | 4516.6 samples/s | 70.6 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01323 | Reg=0.00192 | L2-Norm=13.857 | L2-Norm(final)=2.825 | acc=0.9844 | 4742.8 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step8000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=8001 Epoch=75.8] | Loss=0.11532 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=2.766 | acc=0.9219 | 3973.2 samples/s | 62.1 steps/s
[Step=8050 Epoch=76.3] | Loss=0.00854 | Reg=0.00190 | L2-Norm=13.779 | L2-Norm(final)=2.754 | acc=1.0000 | 3819.8 samples/s | 59.7 steps/s
[Step=8100 Epoch=76.8] | Loss=0.00445 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=2.757 | acc=1.0000 | 5192.7 samples/s | 81.1 steps/s
[Step=8150 Epoch=77.2] | Loss=0.00300 | Reg=0.00190 | L2-Norm=13.793 | L2-Norm(final)=2.760 | acc=1.0000 | 1524.4 samples/s | 23.8 steps/s
[Step=8200 Epoch=77.7] | Loss=0.00226 | Reg=0.00190 | L2-Norm=13.789 | L2-Norm(final)=2.762 | acc=1.0000 | 4895.9 samples/s | 76.5 steps/s
[Step=8250 Epoch=78.2] | Loss=0.00182 | Reg=0.00190 | L2-Norm=13.784 | L2-Norm(final)=2.764 | acc=1.0000 | 1536.8 samples/s | 24.0 steps/s
[Step=8300 Epoch=78.6] | Loss=0.00152 | Reg=0.00190 | L2-Norm=13.777 | L2-Norm(final)=2.766 | acc=1.0000 | 4630.9 samples/s | 72.4 steps/s
[Step=8350 Epoch=79.1] | Loss=0.00131 | Reg=0.00190 | L2-Norm=13.770 | L2-Norm(final)=2.767 | acc=1.0000 | 1619.8 samples/s | 25.3 steps/s
[Step=8400 Epoch=79.6] | Loss=0.00115 | Reg=0.00189 | L2-Norm=13.763 | L2-Norm(final)=2.768 | acc=1.0000 | 4562.8 samples/s | 71.3 steps/s
[Step=8450 Epoch=80.1] | Loss=0.00102 | Reg=0.00189 | L2-Norm=13.755 | L2-Norm(final)=2.770 | acc=1.0000 | 1794.5 samples/s | 28.0 steps/s
[Step=8500 Epoch=80.5] | Loss=0.00092 | Reg=0.00189 | L2-Norm=13.747 | L2-Norm(final)=2.771 | acc=1.0000 | 4374.2 samples/s | 68.3 steps/s
[Step=8550 Epoch=81.0] | Loss=0.00084 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=2.772 | acc=1.0000 | 1578.8 samples/s | 24.7 steps/s
[Step=8600 Epoch=81.5] | Loss=0.00077 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=2.773 | acc=1.0000 | 4302.4 samples/s | 67.2 steps/s
[Step=8650 Epoch=82.0] | Loss=0.00071 | Reg=0.00188 | L2-Norm=13.722 | L2-Norm(final)=2.774 | acc=1.0000 | 1588.3 samples/s | 24.8 steps/s
[Step=8700 Epoch=82.4] | Loss=0.00066 | Reg=0.00188 | L2-Norm=13.713 | L2-Norm(final)=2.774 | acc=1.0000 | 4277.6 samples/s | 66.8 steps/s
[Step=8750 Epoch=82.9] | Loss=0.00062 | Reg=0.00188 | L2-Norm=13.705 | L2-Norm(final)=2.775 | acc=1.0000 | 1598.3 samples/s | 25.0 steps/s
[Step=8800 Epoch=83.4] | Loss=0.00058 | Reg=0.00188 | L2-Norm=13.696 | L2-Norm(final)=2.776 | acc=1.0000 | 4311.1 samples/s | 67.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=7201 Epoch=68.5] | Loss=0.01020 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=2.767 | acc=1.0000 | 3923.9 samples/s | 61.3 steps/s
[Step=7250 Epoch=69.0] | Loss=0.01110 | Reg=0.00190 | L2-Norm=13.785 | L2-Norm(final)=2.749 | acc=1.0000 | 3972.7 samples/s | 62.1 steps/s
[Step=7300 Epoch=69.4] | Loss=0.00595 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=2.750 | acc=1.0000 | 5131.5 samples/s | 80.2 steps/s
[Step=7350 Epoch=69.9] | Loss=0.00400 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=2.752 | acc=1.0000 | 1499.5 samples/s | 23.4 steps/s
[Step=7400 Epoch=70.4] | Loss=0.00302 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=2.755 | acc=1.0000 | 4845.1 samples/s | 75.7 steps/s
[Step=7450 Epoch=70.9] | Loss=0.00242 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=2.756 | acc=1.0000 | 1533.7 samples/s | 24.0 steps/s
[Step=7500 Epoch=71.3] | Loss=0.00203 | Reg=0.00190 | L2-Norm=13.798 | L2-Norm(final)=2.758 | acc=1.0000 | 4643.6 samples/s | 72.6 steps/s
[Step=7550 Epoch=71.8] | Loss=0.00174 | Reg=0.00190 | L2-Norm=13.793 | L2-Norm(final)=2.759 | acc=1.0000 | 1498.4 samples/s | 23.4 steps/s
[Step=7600 Epoch=72.3] | Loss=0.00153 | Reg=0.00190 | L2-Norm=13.787 | L2-Norm(final)=2.761 | acc=1.0000 | 4028.9 samples/s | 63.0 steps/s
[Step=7650 Epoch=72.8] | Loss=0.00136 | Reg=0.00190 | L2-Norm=13.780 | L2-Norm(final)=2.762 | acc=1.0000 | 1568.9 samples/s | 24.5 steps/s
[Step=7700 Epoch=73.2] | Loss=0.00123 | Reg=0.00190 | L2-Norm=13.773 | L2-Norm(final)=2.763 | acc=1.0000 | 4357.5 samples/s | 68.1 steps/s
[Step=7750 Epoch=73.7] | Loss=0.00112 | Reg=0.00190 | L2-Norm=13.766 | L2-Norm(final)=2.764 | acc=1.0000 | 1589.7 samples/s | 24.8 steps/s
[Step=7800 Epoch=74.2] | Loss=0.00103 | Reg=0.00189 | L2-Norm=13.759 | L2-Norm(final)=2.765 | acc=1.0000 | 4199.5 samples/s | 65.6 steps/s
[Step=7850 Epoch=74.7] | Loss=0.00095 | Reg=0.00189 | L2-Norm=13.751 | L2-Norm(final)=2.766 | acc=1.0000 | 1605.6 samples/s | 25.1 steps/s
[Step=7900 Epoch=75.1] | Loss=0.00088 | Reg=0.00189 | L2-Norm=13.744 | L2-Norm(final)=2.767 | acc=1.0000 | 4358.3 samples/s | 68.1 steps/s
[Step=7950 Epoch=75.6] | Loss=0.00083 | Reg=0.00189 | L2-Norm=13.736 | L2-Norm(final)=2.767 | acc=1.0000 | 1605.1 samples/s | 25.1 steps/s
[Step=8000 Epoch=76.1] | Loss=0.00078 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=2.768 | acc=1.0000 | 4111.5 samples/s | 64.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44230 | acc=0.7295 | tpr=0.6094 | fpr=0.0099 | 4400.5 samples/s | 17.2 steps/s
Avg test loss: 0.44249, Avg test acc: 0.73151, Avg tpr: 0.61369, Avg fpr: 0.00936, total FA: 73

Testing server on iccad2012
[Step=  50] | Loss=0.31208 | acc=0.8934 | tpr=0.9646 | fpr=0.1078 | 4427.3 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.31566 | acc=0.8933 | tpr=0.9744 | fpr=0.1082 | 8771.9 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.31940 | acc=0.8925 | tpr=0.9769 | fpr=0.1091 | 8889.9 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.32237 | acc=0.8919 | tpr=0.9760 | fpr=0.1096 | 8965.8 samples/s | 35.0 steps/s
[Step= 250] | Loss=0.32066 | acc=0.8919 | tpr=0.9729 | fpr=0.1096 | 8646.8 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.32386 | acc=0.8905 | tpr=0.9724 | fpr=0.1110 | 9033.5 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.32488 | acc=0.8901 | tpr=0.9718 | fpr=0.1114 | 8679.6 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.32616 | acc=0.8903 | tpr=0.9716 | fpr=0.1112 | 9113.9 samples/s | 35.6 steps/s
[Step= 450] | Loss=0.33022 | acc=0.8898 | tpr=0.9713 | fpr=0.1117 | 8732.1 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.32950 | acc=0.8895 | tpr=0.9727 | fpr=0.1120 | 8312.9 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.32872 | acc=0.8896 | tpr=0.9713 | fpr=0.1119 | 16991.3 samples/s | 66.4 steps/s
Avg test loss: 0.32854, Avg test acc: 0.88960, Avg tpr: 0.97068, Avg fpr: 0.11187, total FA: 15533

server round 21/50

clients selected: [2 4 5 8 9]

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00025, len=1
[Step=8001 Epoch=39.0] | Loss=0.23161 | Reg=0.00187 | L2-Norm=13.667 | L2-Norm(final)=2.807 | acc=0.8438 | 3875.5 samples/s | 60.6 steps/s
[Step=8050 Epoch=39.2] | Loss=0.05947 | Reg=0.00188 | L2-Norm=13.702 | L2-Norm(final)=2.787 | acc=0.9688 | 4439.3 samples/s | 69.4 steps/s
[Step=8100 Epoch=39.5] | Loss=0.04552 | Reg=0.00188 | L2-Norm=13.718 | L2-Norm(final)=2.785 | acc=1.0000 | 4506.6 samples/s | 70.4 steps/s
[Step=8150 Epoch=39.7] | Loss=0.03890 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=2.788 | acc=0.9688 | 4515.8 samples/s | 70.6 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03394 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=2.793 | acc=1.0000 | 5266.5 samples/s | 82.3 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02923 | Reg=0.00189 | L2-Norm=13.750 | L2-Norm(final)=2.799 | acc=1.0000 | 1584.9 samples/s | 24.8 steps/s
[Step=8300 Epoch=40.4] | Loss=0.02621 | Reg=0.00189 | L2-Norm=13.759 | L2-Norm(final)=2.806 | acc=0.9844 | 4536.4 samples/s | 70.9 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02393 | Reg=0.00190 | L2-Norm=13.767 | L2-Norm(final)=2.812 | acc=0.9844 | 4537.9 samples/s | 70.9 steps/s
[Step=8400 Epoch=40.9] | Loss=0.02237 | Reg=0.00190 | L2-Norm=13.775 | L2-Norm(final)=2.818 | acc=0.9844 | 5068.0 samples/s | 79.2 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02074 | Reg=0.00190 | L2-Norm=13.782 | L2-Norm(final)=2.824 | acc=1.0000 | 1567.9 samples/s | 24.5 steps/s
[Step=8500 Epoch=41.4] | Loss=0.01944 | Reg=0.00190 | L2-Norm=13.789 | L2-Norm(final)=2.830 | acc=0.9844 | 4456.8 samples/s | 69.6 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01841 | Reg=0.00190 | L2-Norm=13.795 | L2-Norm(final)=2.836 | acc=1.0000 | 4442.7 samples/s | 69.4 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01754 | Reg=0.00190 | L2-Norm=13.800 | L2-Norm(final)=2.841 | acc=0.9844 | 4880.2 samples/s | 76.3 steps/s
[Step=8650 Epoch=42.1] | Loss=0.01681 | Reg=0.00191 | L2-Norm=13.805 | L2-Norm(final)=2.846 | acc=1.0000 | 1592.4 samples/s | 24.9 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01601 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=2.851 | acc=1.0000 | 4386.2 samples/s | 68.5 steps/s
[Step=8750 Epoch=42.6] | Loss=0.01535 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=2.855 | acc=1.0000 | 4550.8 samples/s | 71.1 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01469 | Reg=0.00191 | L2-Norm=13.820 | L2-Norm(final)=2.860 | acc=1.0000 | 4748.8 samples/s | 74.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step8800.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00025, len=1
[Step=8001 Epoch=39.2] | Loss=0.37746 | Reg=0.00187 | L2-Norm=13.667 | L2-Norm(final)=2.807 | acc=0.7969 | 3385.2 samples/s | 52.9 steps/s
[Step=8050 Epoch=39.5] | Loss=0.06141 | Reg=0.00187 | L2-Norm=13.688 | L2-Norm(final)=2.783 | acc=1.0000 | 4309.0 samples/s | 67.3 steps/s
[Step=8100 Epoch=39.7] | Loss=0.04552 | Reg=0.00188 | L2-Norm=13.700 | L2-Norm(final)=2.782 | acc=0.9688 | 4430.3 samples/s | 69.2 steps/s
[Step=8150 Epoch=40.0] | Loss=0.03710 | Reg=0.00188 | L2-Norm=13.710 | L2-Norm(final)=2.786 | acc=1.0000 | 4476.9 samples/s | 70.0 steps/s
[Step=8200 Epoch=40.2] | Loss=0.03223 | Reg=0.00188 | L2-Norm=13.719 | L2-Norm(final)=2.792 | acc=1.0000 | 5355.6 samples/s | 83.7 steps/s
[Step=8250 Epoch=40.5] | Loss=0.02802 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=2.798 | acc=0.9844 | 1537.3 samples/s | 24.0 steps/s
[Step=8300 Epoch=40.7] | Loss=0.02489 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=2.804 | acc=0.9844 | 4450.3 samples/s | 69.5 steps/s
[Step=8350 Epoch=40.9] | Loss=0.02245 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=2.810 | acc=1.0000 | 4397.2 samples/s | 68.7 steps/s
[Step=8400 Epoch=41.2] | Loss=0.02055 | Reg=0.00189 | L2-Norm=13.752 | L2-Norm(final)=2.817 | acc=0.9844 | 5234.0 samples/s | 81.8 steps/s
[Step=8450 Epoch=41.4] | Loss=0.01932 | Reg=0.00189 | L2-Norm=13.758 | L2-Norm(final)=2.823 | acc=1.0000 | 1528.0 samples/s | 23.9 steps/s
[Step=8500 Epoch=41.7] | Loss=0.01810 | Reg=0.00189 | L2-Norm=13.764 | L2-Norm(final)=2.828 | acc=1.0000 | 4212.2 samples/s | 65.8 steps/s
[Step=8550 Epoch=41.9] | Loss=0.01699 | Reg=0.00190 | L2-Norm=13.769 | L2-Norm(final)=2.833 | acc=1.0000 | 4337.0 samples/s | 67.8 steps/s
[Step=8600 Epoch=42.2] | Loss=0.01602 | Reg=0.00190 | L2-Norm=13.774 | L2-Norm(final)=2.838 | acc=1.0000 | 4647.1 samples/s | 72.6 steps/s
[Step=8650 Epoch=42.4] | Loss=0.01524 | Reg=0.00190 | L2-Norm=13.779 | L2-Norm(final)=2.842 | acc=1.0000 | 1519.4 samples/s | 23.7 steps/s
[Step=8700 Epoch=42.7] | Loss=0.01449 | Reg=0.00190 | L2-Norm=13.784 | L2-Norm(final)=2.847 | acc=1.0000 | 3917.7 samples/s | 61.2 steps/s
[Step=8750 Epoch=42.9] | Loss=0.01378 | Reg=0.00190 | L2-Norm=13.788 | L2-Norm(final)=2.851 | acc=1.0000 | 3909.5 samples/s | 61.1 steps/s
[Step=8800 Epoch=43.2] | Loss=0.01329 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=2.855 | acc=1.0000 | 4509.4 samples/s | 70.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step8800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=8801 Epoch=83.4] | Loss=0.00737 | Reg=0.00187 | L2-Norm=13.667 | L2-Norm(final)=2.808 | acc=1.0000 | 3231.6 samples/s | 50.5 steps/s
[Step=8850 Epoch=83.9] | Loss=0.00297 | Reg=0.00188 | L2-Norm=13.707 | L2-Norm(final)=2.820 | acc=1.0000 | 4171.4 samples/s | 65.2 steps/s
[Step=8900 Epoch=84.3] | Loss=0.00182 | Reg=0.00188 | L2-Norm=13.711 | L2-Norm(final)=2.825 | acc=1.0000 | 5029.4 samples/s | 78.6 steps/s
[Step=8950 Epoch=84.8] | Loss=0.00126 | Reg=0.00188 | L2-Norm=13.711 | L2-Norm(final)=2.829 | acc=1.0000 | 1465.7 samples/s | 22.9 steps/s
[Step=9000 Epoch=85.3] | Loss=0.00095 | Reg=0.00188 | L2-Norm=13.706 | L2-Norm(final)=2.833 | acc=1.0000 | 4470.1 samples/s | 69.8 steps/s
[Step=9050 Epoch=85.8] | Loss=0.00077 | Reg=0.00188 | L2-Norm=13.698 | L2-Norm(final)=2.835 | acc=1.0000 | 1534.3 samples/s | 24.0 steps/s
[Step=9100 Epoch=86.2] | Loss=0.00064 | Reg=0.00187 | L2-Norm=13.690 | L2-Norm(final)=2.837 | acc=1.0000 | 4681.3 samples/s | 73.1 steps/s
[Step=9150 Epoch=86.7] | Loss=0.00055 | Reg=0.00187 | L2-Norm=13.681 | L2-Norm(final)=2.838 | acc=1.0000 | 1550.8 samples/s | 24.2 steps/s
[Step=9200 Epoch=87.2] | Loss=0.00048 | Reg=0.00187 | L2-Norm=13.672 | L2-Norm(final)=2.840 | acc=1.0000 | 4549.9 samples/s | 71.1 steps/s
[Step=9250 Epoch=87.7] | Loss=0.00043 | Reg=0.00187 | L2-Norm=13.662 | L2-Norm(final)=2.841 | acc=1.0000 | 1570.5 samples/s | 24.5 steps/s
[Step=9300 Epoch=88.1] | Loss=0.00039 | Reg=0.00186 | L2-Norm=13.652 | L2-Norm(final)=2.842 | acc=1.0000 | 4383.1 samples/s | 68.5 steps/s
[Step=9350 Epoch=88.6] | Loss=0.00036 | Reg=0.00186 | L2-Norm=13.642 | L2-Norm(final)=2.843 | acc=1.0000 | 1584.8 samples/s | 24.8 steps/s
[Step=9400 Epoch=89.1] | Loss=0.00033 | Reg=0.00186 | L2-Norm=13.632 | L2-Norm(final)=2.844 | acc=1.0000 | 4318.2 samples/s | 67.5 steps/s
[Step=9450 Epoch=89.5] | Loss=0.00030 | Reg=0.00186 | L2-Norm=13.621 | L2-Norm(final)=2.845 | acc=1.0000 | 1578.1 samples/s | 24.7 steps/s
[Step=9500 Epoch=90.0] | Loss=0.00028 | Reg=0.00185 | L2-Norm=13.610 | L2-Norm(final)=2.846 | acc=1.0000 | 4421.2 samples/s | 69.1 steps/s
[Step=9550 Epoch=90.5] | Loss=0.00026 | Reg=0.00185 | L2-Norm=13.600 | L2-Norm(final)=2.846 | acc=1.0000 | 1774.2 samples/s | 27.7 steps/s
[Step=9600 Epoch=91.0] | Loss=0.00025 | Reg=0.00185 | L2-Norm=13.589 | L2-Norm(final)=2.847 | acc=1.0000 | 4195.9 samples/s | 65.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step9600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00025, len=1
[Step=6401 Epoch=60.3] | Loss=0.03074 | Reg=0.00187 | L2-Norm=13.667 | L2-Norm(final)=2.808 | acc=0.9688 | 3944.3 samples/s | 61.6 steps/s
[Step=6450 Epoch=60.8] | Loss=0.00334 | Reg=0.00188 | L2-Norm=13.716 | L2-Norm(final)=2.812 | acc=1.0000 | 3896.0 samples/s | 60.9 steps/s
[Step=6500 Epoch=61.2] | Loss=0.00180 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=2.815 | acc=1.0000 | 5134.4 samples/s | 80.2 steps/s
[Step=6550 Epoch=61.7] | Loss=0.00123 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=2.818 | acc=1.0000 | 1528.9 samples/s | 23.9 steps/s
[Step=6600 Epoch=62.2] | Loss=0.00094 | Reg=0.00188 | L2-Norm=13.723 | L2-Norm(final)=2.821 | acc=1.0000 | 4838.0 samples/s | 75.6 steps/s
[Step=6650 Epoch=62.7] | Loss=0.00076 | Reg=0.00188 | L2-Norm=13.718 | L2-Norm(final)=2.822 | acc=1.0000 | 1543.4 samples/s | 24.1 steps/s
[Step=6700 Epoch=63.1] | Loss=0.00063 | Reg=0.00188 | L2-Norm=13.712 | L2-Norm(final)=2.824 | acc=1.0000 | 4676.4 samples/s | 73.1 steps/s
[Step=6750 Epoch=63.6] | Loss=0.00055 | Reg=0.00188 | L2-Norm=13.706 | L2-Norm(final)=2.825 | acc=1.0000 | 1561.6 samples/s | 24.4 steps/s
[Step=6800 Epoch=64.1] | Loss=0.00048 | Reg=0.00188 | L2-Norm=13.700 | L2-Norm(final)=2.826 | acc=1.0000 | 4371.2 samples/s | 68.3 steps/s
[Step=6850 Epoch=64.5] | Loss=0.00043 | Reg=0.00187 | L2-Norm=13.693 | L2-Norm(final)=2.827 | acc=1.0000 | 1577.0 samples/s | 24.6 steps/s
[Step=6900 Epoch=65.0] | Loss=0.00039 | Reg=0.00187 | L2-Norm=13.686 | L2-Norm(final)=2.828 | acc=1.0000 | 4312.6 samples/s | 67.4 steps/s
[Step=6950 Epoch=65.5] | Loss=0.00036 | Reg=0.00187 | L2-Norm=13.678 | L2-Norm(final)=2.829 | acc=1.0000 | 1615.3 samples/s | 25.2 steps/s
[Step=7000 Epoch=66.0] | Loss=0.00033 | Reg=0.00187 | L2-Norm=13.671 | L2-Norm(final)=2.830 | acc=1.0000 | 4362.3 samples/s | 68.2 steps/s
[Step=7050 Epoch=66.4] | Loss=0.00030 | Reg=0.00187 | L2-Norm=13.663 | L2-Norm(final)=2.831 | acc=1.0000 | 1629.2 samples/s | 25.5 steps/s
[Step=7100 Epoch=66.9] | Loss=0.00028 | Reg=0.00186 | L2-Norm=13.655 | L2-Norm(final)=2.831 | acc=1.0000 | 4268.8 samples/s | 66.7 steps/s
[Step=7150 Epoch=67.4] | Loss=0.00026 | Reg=0.00186 | L2-Norm=13.647 | L2-Norm(final)=2.832 | acc=1.0000 | 1655.0 samples/s | 25.9 steps/s
[Step=7200 Epoch=67.8] | Loss=0.00025 | Reg=0.00186 | L2-Norm=13.639 | L2-Norm(final)=2.833 | acc=1.0000 | 3953.8 samples/s | 61.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step7200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00025, len=1
[Step=8801 Epoch=83.9] | Loss=0.06067 | Reg=0.00187 | L2-Norm=13.667 | L2-Norm(final)=2.807 | acc=0.9844 | 3875.7 samples/s | 60.6 steps/s
[Step=8850 Epoch=84.3] | Loss=0.00534 | Reg=0.00188 | L2-Norm=13.708 | L2-Norm(final)=2.809 | acc=1.0000 | 3920.2 samples/s | 61.3 steps/s
[Step=8900 Epoch=84.8] | Loss=0.00279 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=2.812 | acc=1.0000 | 5118.3 samples/s | 80.0 steps/s
[Step=8950 Epoch=85.3] | Loss=0.00188 | Reg=0.00188 | L2-Norm=13.719 | L2-Norm(final)=2.815 | acc=1.0000 | 1443.5 samples/s | 22.6 steps/s
[Step=9000 Epoch=85.8] | Loss=0.00144 | Reg=0.00188 | L2-Norm=13.715 | L2-Norm(final)=2.818 | acc=1.0000 | 4487.1 samples/s | 70.1 steps/s
[Step=9050 Epoch=86.3] | Loss=0.00116 | Reg=0.00188 | L2-Norm=13.709 | L2-Norm(final)=2.821 | acc=1.0000 | 1543.8 samples/s | 24.1 steps/s
[Step=9100 Epoch=86.7] | Loss=0.00097 | Reg=0.00188 | L2-Norm=13.701 | L2-Norm(final)=2.823 | acc=1.0000 | 4824.0 samples/s | 75.4 steps/s
[Step=9150 Epoch=87.2] | Loss=0.00084 | Reg=0.00187 | L2-Norm=13.693 | L2-Norm(final)=2.825 | acc=1.0000 | 1507.7 samples/s | 23.6 steps/s
[Step=9200 Epoch=87.7] | Loss=0.00073 | Reg=0.00187 | L2-Norm=13.684 | L2-Norm(final)=2.827 | acc=1.0000 | 4171.9 samples/s | 65.2 steps/s
[Step=9250 Epoch=88.2] | Loss=0.00065 | Reg=0.00187 | L2-Norm=13.675 | L2-Norm(final)=2.828 | acc=1.0000 | 1569.5 samples/s | 24.5 steps/s
[Step=9300 Epoch=88.6] | Loss=0.00059 | Reg=0.00187 | L2-Norm=13.666 | L2-Norm(final)=2.829 | acc=1.0000 | 4481.9 samples/s | 70.0 steps/s
[Step=9350 Epoch=89.1] | Loss=0.00054 | Reg=0.00186 | L2-Norm=13.656 | L2-Norm(final)=2.831 | acc=1.0000 | 1571.8 samples/s | 24.6 steps/s
[Step=9400 Epoch=89.6] | Loss=0.00049 | Reg=0.00186 | L2-Norm=13.646 | L2-Norm(final)=2.832 | acc=1.0000 | 4423.4 samples/s | 69.1 steps/s
[Step=9450 Epoch=90.1] | Loss=0.00046 | Reg=0.00186 | L2-Norm=13.636 | L2-Norm(final)=2.833 | acc=1.0000 | 1603.2 samples/s | 25.1 steps/s
[Step=9500 Epoch=90.5] | Loss=0.00043 | Reg=0.00186 | L2-Norm=13.626 | L2-Norm(final)=2.834 | acc=1.0000 | 4258.1 samples/s | 66.5 steps/s
[Step=9550 Epoch=91.0] | Loss=0.00040 | Reg=0.00185 | L2-Norm=13.616 | L2-Norm(final)=2.835 | acc=1.0000 | 1610.3 samples/s | 25.2 steps/s
[Step=9600 Epoch=91.5] | Loss=0.00037 | Reg=0.00185 | L2-Norm=13.605 | L2-Norm(final)=2.836 | acc=1.0000 | 4408.5 samples/s | 68.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42207 | acc=0.7526 | tpr=0.6427 | fpr=0.0089 | 4325.2 samples/s | 16.9 steps/s
Avg test loss: 0.42469, Avg test acc: 0.75274, Avg tpr: 0.64434, Avg fpr: 0.00885, total FA: 69

Testing server on iccad2012
[Step=  50] | Loss=0.34384 | acc=0.8848 | tpr=0.9602 | fpr=0.1165 | 4416.6 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.34811 | acc=0.8834 | tpr=0.9659 | fpr=0.1182 | 8660.6 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.35273 | acc=0.8831 | tpr=0.9697 | fpr=0.1185 | 8954.6 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.35583 | acc=0.8826 | tpr=0.9716 | fpr=0.1190 | 8576.5 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.35400 | acc=0.8829 | tpr=0.9694 | fpr=0.1187 | 8877.4 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.35767 | acc=0.8816 | tpr=0.9702 | fpr=0.1200 | 9024.6 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.35826 | acc=0.8814 | tpr=0.9699 | fpr=0.1202 | 8630.2 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.35966 | acc=0.8818 | tpr=0.9699 | fpr=0.1198 | 8714.9 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.36415 | acc=0.8812 | tpr=0.9698 | fpr=0.1204 | 8647.6 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.36335 | acc=0.8809 | tpr=0.9709 | fpr=0.1207 | 8733.5 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.36270 | acc=0.8809 | tpr=0.9694 | fpr=0.1207 | 16728.2 samples/s | 65.3 steps/s
Avg test loss: 0.36254, Avg test acc: 0.88089, Avg tpr: 0.96830, Avg fpr: 0.12070, total FA: 16759

server round 22/50

clients selected: [0 1 3 6 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=9601 Epoch=46.8] | Loss=0.19228 | Reg=0.00186 | L2-Norm=13.628 | L2-Norm(final)=2.851 | acc=0.8281 | 3785.1 samples/s | 59.1 steps/s
[Step=9650 Epoch=47.1] | Loss=0.05600 | Reg=0.00187 | L2-Norm=13.673 | L2-Norm(final)=2.827 | acc=0.9844 | 4385.0 samples/s | 68.5 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03998 | Reg=0.00187 | L2-Norm=13.689 | L2-Norm(final)=2.826 | acc=1.0000 | 4504.5 samples/s | 70.4 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03235 | Reg=0.00188 | L2-Norm=13.700 | L2-Norm(final)=2.830 | acc=1.0000 | 4347.4 samples/s | 67.9 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02941 | Reg=0.00188 | L2-Norm=13.709 | L2-Norm(final)=2.834 | acc=0.9531 | 5225.6 samples/s | 81.7 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02638 | Reg=0.00188 | L2-Norm=13.717 | L2-Norm(final)=2.839 | acc=0.9844 | 1543.7 samples/s | 24.1 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02363 | Reg=0.00188 | L2-Norm=13.724 | L2-Norm(final)=2.845 | acc=1.0000 | 4558.9 samples/s | 71.2 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02161 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=2.850 | acc=0.9844 | 4489.8 samples/s | 70.2 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01969 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=2.856 | acc=1.0000 | 4865.5 samples/s | 76.0 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01826 | Reg=0.00189 | L2-Norm=13.744 | L2-Norm(final)=2.862 | acc=0.9844 | 1571.1 samples/s | 24.5 steps/s
[Step=10100 Epoch=49.2] | Loss=0.01712 | Reg=0.00189 | L2-Norm=13.750 | L2-Norm(final)=2.867 | acc=1.0000 | 4508.0 samples/s | 70.4 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01622 | Reg=0.00189 | L2-Norm=13.755 | L2-Norm(final)=2.873 | acc=1.0000 | 4469.8 samples/s | 69.8 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01555 | Reg=0.00189 | L2-Norm=13.759 | L2-Norm(final)=2.878 | acc=0.9844 | 4947.5 samples/s | 77.3 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01477 | Reg=0.00189 | L2-Norm=13.764 | L2-Norm(final)=2.882 | acc=1.0000 | 1597.6 samples/s | 25.0 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01418 | Reg=0.00190 | L2-Norm=13.768 | L2-Norm(final)=2.887 | acc=0.9844 | 4478.3 samples/s | 70.0 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01371 | Reg=0.00190 | L2-Norm=13.771 | L2-Norm(final)=2.891 | acc=1.0000 | 3983.5 samples/s | 62.2 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01315 | Reg=0.00190 | L2-Norm=13.774 | L2-Norm(final)=2.895 | acc=1.0000 | 4221.8 samples/s | 66.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step10400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=9601 Epoch=46.8] | Loss=0.41463 | Reg=0.00186 | L2-Norm=13.628 | L2-Norm(final)=2.851 | acc=0.7500 | 3480.7 samples/s | 54.4 steps/s
[Step=9650 Epoch=47.1] | Loss=0.04984 | Reg=0.00187 | L2-Norm=13.672 | L2-Norm(final)=2.829 | acc=1.0000 | 4176.2 samples/s | 65.3 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03739 | Reg=0.00187 | L2-Norm=13.687 | L2-Norm(final)=2.827 | acc=1.0000 | 4614.8 samples/s | 72.1 steps/s
[Step=9750 Epoch=47.6] | Loss=0.03136 | Reg=0.00188 | L2-Norm=13.697 | L2-Norm(final)=2.830 | acc=0.9844 | 4478.9 samples/s | 70.0 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02804 | Reg=0.00188 | L2-Norm=13.705 | L2-Norm(final)=2.834 | acc=1.0000 | 5276.6 samples/s | 82.4 steps/s
[Step=9850 Epoch=48.1] | Loss=0.02397 | Reg=0.00188 | L2-Norm=13.713 | L2-Norm(final)=2.840 | acc=1.0000 | 1562.1 samples/s | 24.4 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02128 | Reg=0.00188 | L2-Norm=13.721 | L2-Norm(final)=2.846 | acc=1.0000 | 4523.8 samples/s | 70.7 steps/s
[Step=9950 Epoch=48.6] | Loss=0.01949 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=2.852 | acc=0.9844 | 4480.1 samples/s | 70.0 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01818 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=2.857 | acc=0.9844 | 4749.2 samples/s | 74.2 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01694 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=2.863 | acc=0.9844 | 1574.0 samples/s | 24.6 steps/s
[Step=10100 Epoch=49.3] | Loss=0.01601 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=2.868 | acc=0.9844 | 4500.7 samples/s | 70.3 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01524 | Reg=0.00189 | L2-Norm=13.750 | L2-Norm(final)=2.872 | acc=1.0000 | 4408.3 samples/s | 68.9 steps/s
[Step=10200 Epoch=49.8] | Loss=0.01461 | Reg=0.00189 | L2-Norm=13.754 | L2-Norm(final)=2.877 | acc=1.0000 | 4905.7 samples/s | 76.7 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01391 | Reg=0.00189 | L2-Norm=13.758 | L2-Norm(final)=2.881 | acc=1.0000 | 1535.3 samples/s | 24.0 steps/s
[Step=10300 Epoch=50.3] | Loss=0.01319 | Reg=0.00189 | L2-Norm=13.761 | L2-Norm(final)=2.885 | acc=0.9844 | 3937.3 samples/s | 61.5 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01270 | Reg=0.00189 | L2-Norm=13.765 | L2-Norm(final)=2.889 | acc=1.0000 | 3944.6 samples/s | 61.6 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01250 | Reg=0.00190 | L2-Norm=13.768 | L2-Norm(final)=2.893 | acc=1.0000 | 4289.1 samples/s | 67.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step10400.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00025, len=1
[Step=8001 Epoch=39.0] | Loss=0.40208 | Reg=0.00186 | L2-Norm=13.628 | L2-Norm(final)=2.851 | acc=0.7969 | 3450.0 samples/s | 53.9 steps/s
[Step=8050 Epoch=39.3] | Loss=0.05004 | Reg=0.00187 | L2-Norm=13.662 | L2-Norm(final)=2.836 | acc=0.9688 | 4337.4 samples/s | 67.8 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03708 | Reg=0.00187 | L2-Norm=13.678 | L2-Norm(final)=2.837 | acc=0.9688 | 4542.4 samples/s | 71.0 steps/s
[Step=8150 Epoch=39.7] | Loss=0.03279 | Reg=0.00187 | L2-Norm=13.687 | L2-Norm(final)=2.839 | acc=1.0000 | 4388.7 samples/s | 68.6 steps/s
[Step=8200 Epoch=40.0] | Loss=0.02913 | Reg=0.00188 | L2-Norm=13.695 | L2-Norm(final)=2.842 | acc=0.9844 | 5183.1 samples/s | 81.0 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02561 | Reg=0.00188 | L2-Norm=13.703 | L2-Norm(final)=2.846 | acc=1.0000 | 1582.3 samples/s | 24.7 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02243 | Reg=0.00188 | L2-Norm=13.711 | L2-Norm(final)=2.852 | acc=1.0000 | 4430.0 samples/s | 69.2 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02064 | Reg=0.00188 | L2-Norm=13.717 | L2-Norm(final)=2.857 | acc=1.0000 | 4554.8 samples/s | 71.2 steps/s
[Step=8400 Epoch=41.0] | Loss=0.01899 | Reg=0.00188 | L2-Norm=13.724 | L2-Norm(final)=2.863 | acc=0.9844 | 5030.1 samples/s | 78.6 steps/s
[Step=8450 Epoch=41.2] | Loss=0.01780 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=2.868 | acc=1.0000 | 1580.1 samples/s | 24.7 steps/s
[Step=8500 Epoch=41.5] | Loss=0.01648 | Reg=0.00189 | L2-Norm=13.735 | L2-Norm(final)=2.873 | acc=1.0000 | 4435.0 samples/s | 69.3 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01553 | Reg=0.00189 | L2-Norm=13.741 | L2-Norm(final)=2.879 | acc=1.0000 | 4457.3 samples/s | 69.6 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01482 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=2.884 | acc=1.0000 | 4817.7 samples/s | 75.3 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01410 | Reg=0.00189 | L2-Norm=13.750 | L2-Norm(final)=2.888 | acc=1.0000 | 1545.5 samples/s | 24.1 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01347 | Reg=0.00189 | L2-Norm=13.754 | L2-Norm(final)=2.893 | acc=1.0000 | 3895.6 samples/s | 60.9 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01282 | Reg=0.00189 | L2-Norm=13.758 | L2-Norm(final)=2.897 | acc=0.9844 | 3929.7 samples/s | 61.4 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01239 | Reg=0.00189 | L2-Norm=13.762 | L2-Norm(final)=2.902 | acc=0.9844 | 4192.3 samples/s | 65.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step8800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=8001 Epoch=76.1] | Loss=0.01133 | Reg=0.00186 | L2-Norm=13.628 | L2-Norm(final)=2.852 | acc=1.0000 | 3356.3 samples/s | 52.4 steps/s
[Step=8050 Epoch=76.6] | Loss=0.00514 | Reg=0.00187 | L2-Norm=13.678 | L2-Norm(final)=2.848 | acc=1.0000 | 3975.7 samples/s | 62.1 steps/s
[Step=8100 Epoch=77.1] | Loss=0.00270 | Reg=0.00187 | L2-Norm=13.686 | L2-Norm(final)=2.850 | acc=1.0000 | 5161.7 samples/s | 80.7 steps/s
[Step=8150 Epoch=77.5] | Loss=0.00183 | Reg=0.00187 | L2-Norm=13.686 | L2-Norm(final)=2.852 | acc=1.0000 | 1494.6 samples/s | 23.4 steps/s
[Step=8200 Epoch=78.0] | Loss=0.00138 | Reg=0.00187 | L2-Norm=13.681 | L2-Norm(final)=2.854 | acc=1.0000 | 4905.1 samples/s | 76.6 steps/s
[Step=8250 Epoch=78.5] | Loss=0.00111 | Reg=0.00187 | L2-Norm=13.675 | L2-Norm(final)=2.855 | acc=1.0000 | 1529.8 samples/s | 23.9 steps/s
[Step=8300 Epoch=79.0] | Loss=0.00093 | Reg=0.00187 | L2-Norm=13.668 | L2-Norm(final)=2.856 | acc=1.0000 | 4642.5 samples/s | 72.5 steps/s
[Step=8350 Epoch=79.4] | Loss=0.00080 | Reg=0.00187 | L2-Norm=13.661 | L2-Norm(final)=2.857 | acc=1.0000 | 1542.0 samples/s | 24.1 steps/s
[Step=8400 Epoch=79.9] | Loss=0.00070 | Reg=0.00186 | L2-Norm=13.653 | L2-Norm(final)=2.858 | acc=1.0000 | 4583.9 samples/s | 71.6 steps/s
[Step=8450 Epoch=80.4] | Loss=0.00062 | Reg=0.00186 | L2-Norm=13.645 | L2-Norm(final)=2.859 | acc=1.0000 | 1554.1 samples/s | 24.3 steps/s
[Step=8500 Epoch=80.9] | Loss=0.00056 | Reg=0.00186 | L2-Norm=13.636 | L2-Norm(final)=2.860 | acc=1.0000 | 4369.2 samples/s | 68.3 steps/s
[Step=8550 Epoch=81.3] | Loss=0.00051 | Reg=0.00186 | L2-Norm=13.628 | L2-Norm(final)=2.861 | acc=1.0000 | 1587.7 samples/s | 24.8 steps/s
[Step=8600 Epoch=81.8] | Loss=0.00047 | Reg=0.00185 | L2-Norm=13.619 | L2-Norm(final)=2.861 | acc=1.0000 | 4216.0 samples/s | 65.9 steps/s
[Step=8650 Epoch=82.3] | Loss=0.00043 | Reg=0.00185 | L2-Norm=13.610 | L2-Norm(final)=2.862 | acc=1.0000 | 1598.9 samples/s | 25.0 steps/s
[Step=8700 Epoch=82.8] | Loss=0.00040 | Reg=0.00185 | L2-Norm=13.600 | L2-Norm(final)=2.863 | acc=1.0000 | 4271.6 samples/s | 66.7 steps/s
[Step=8750 Epoch=83.2] | Loss=0.00038 | Reg=0.00185 | L2-Norm=13.591 | L2-Norm(final)=2.863 | acc=1.0000 | 1589.3 samples/s | 24.8 steps/s
[Step=8800 Epoch=83.7] | Loss=0.00036 | Reg=0.00184 | L2-Norm=13.582 | L2-Norm(final)=2.864 | acc=1.0000 | 4175.1 samples/s | 65.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step8800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00025, len=1
[Step=9601 Epoch=91.5] | Loss=0.01154 | Reg=0.00186 | L2-Norm=13.628 | L2-Norm(final)=2.852 | acc=0.9844 | 3902.9 samples/s | 61.0 steps/s
[Step=9650 Epoch=92.0] | Loss=0.00678 | Reg=0.00188 | L2-Norm=13.694 | L2-Norm(final)=2.843 | acc=1.0000 | 3989.2 samples/s | 62.3 steps/s
[Step=9700 Epoch=92.4] | Loss=0.00359 | Reg=0.00188 | L2-Norm=13.713 | L2-Norm(final)=2.844 | acc=1.0000 | 5092.9 samples/s | 79.6 steps/s
[Step=9750 Epoch=92.9] | Loss=0.00241 | Reg=0.00188 | L2-Norm=13.716 | L2-Norm(final)=2.847 | acc=1.0000 | 1494.3 samples/s | 23.3 steps/s
[Step=9800 Epoch=93.4] | Loss=0.00181 | Reg=0.00188 | L2-Norm=13.713 | L2-Norm(final)=2.848 | acc=1.0000 | 4947.0 samples/s | 77.3 steps/s
[Step=9850 Epoch=93.9] | Loss=0.00146 | Reg=0.00188 | L2-Norm=13.708 | L2-Norm(final)=2.850 | acc=1.0000 | 1566.3 samples/s | 24.5 steps/s
[Step=9900 Epoch=94.4] | Loss=0.00122 | Reg=0.00188 | L2-Norm=13.701 | L2-Norm(final)=2.851 | acc=1.0000 | 4758.8 samples/s | 74.4 steps/s
[Step=9950 Epoch=94.8] | Loss=0.00105 | Reg=0.00188 | L2-Norm=13.694 | L2-Norm(final)=2.852 | acc=1.0000 | 1521.3 samples/s | 23.8 steps/s
[Step=10000 Epoch=95.3] | Loss=0.00092 | Reg=0.00187 | L2-Norm=13.686 | L2-Norm(final)=2.853 | acc=1.0000 | 4526.2 samples/s | 70.7 steps/s
[Step=10050 Epoch=95.8] | Loss=0.00082 | Reg=0.00187 | L2-Norm=13.677 | L2-Norm(final)=2.854 | acc=1.0000 | 1538.4 samples/s | 24.0 steps/s
[Step=10100 Epoch=96.3] | Loss=0.00074 | Reg=0.00187 | L2-Norm=13.669 | L2-Norm(final)=2.855 | acc=1.0000 | 4513.7 samples/s | 70.5 steps/s
[Step=10150 Epoch=96.7] | Loss=0.00067 | Reg=0.00187 | L2-Norm=13.660 | L2-Norm(final)=2.856 | acc=1.0000 | 1557.4 samples/s | 24.3 steps/s
[Step=10200 Epoch=97.2] | Loss=0.00062 | Reg=0.00186 | L2-Norm=13.651 | L2-Norm(final)=2.857 | acc=1.0000 | 4281.6 samples/s | 66.9 steps/s
[Step=10250 Epoch=97.7] | Loss=0.00057 | Reg=0.00186 | L2-Norm=13.642 | L2-Norm(final)=2.858 | acc=1.0000 | 1674.0 samples/s | 26.2 steps/s
[Step=10300 Epoch=98.2] | Loss=0.00053 | Reg=0.00186 | L2-Norm=13.633 | L2-Norm(final)=2.859 | acc=1.0000 | 4229.1 samples/s | 66.1 steps/s
[Step=10350 Epoch=98.6] | Loss=0.00050 | Reg=0.00186 | L2-Norm=13.623 | L2-Norm(final)=2.859 | acc=1.0000 | 1569.5 samples/s | 24.5 steps/s
[Step=10400 Epoch=99.1] | Loss=0.00047 | Reg=0.00185 | L2-Norm=13.613 | L2-Norm(final)=2.860 | acc=1.0000 | 4212.7 samples/s | 65.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39240 | acc=0.7726 | tpr=0.6723 | fpr=0.0097 | 4379.8 samples/s | 17.1 steps/s
Avg test loss: 0.39509, Avg test acc: 0.77286, Avg tpr: 0.67407, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.37530 | acc=0.8788 | tpr=0.9646 | fpr=0.1228 | 4369.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.37898 | acc=0.8777 | tpr=0.9723 | fpr=0.1240 | 8720.4 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.38428 | acc=0.8776 | tpr=0.9741 | fpr=0.1242 | 8880.0 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.38765 | acc=0.8771 | tpr=0.9749 | fpr=0.1246 | 8831.3 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.38563 | acc=0.8775 | tpr=0.9729 | fpr=0.1243 | 8728.7 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.38950 | acc=0.8762 | tpr=0.9745 | fpr=0.1256 | 8564.9 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.39014 | acc=0.8762 | tpr=0.9737 | fpr=0.1256 | 9058.8 samples/s | 35.4 steps/s
[Step= 400] | Loss=0.39173 | acc=0.8764 | tpr=0.9732 | fpr=0.1253 | 8648.3 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.39643 | acc=0.8760 | tpr=0.9727 | fpr=0.1258 | 8710.6 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.39560 | acc=0.8757 | tpr=0.9744 | fpr=0.1261 | 8701.5 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.39484 | acc=0.8756 | tpr=0.9729 | fpr=0.1262 | 16317.4 samples/s | 63.7 steps/s
Avg test loss: 0.39471, Avg test acc: 0.87563, Avg tpr: 0.97227, Avg fpr: 0.12613, total FA: 17513

server round 23/50

clients selected: [0 2 5 6 7]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=10401 Epoch=50.7] | Loss=0.41226 | Reg=0.00184 | L2-Norm=13.570 | L2-Norm(final)=2.888 | acc=0.8125 | 3924.7 samples/s | 61.3 steps/s
[Step=10450 Epoch=51.0] | Loss=0.04648 | Reg=0.00185 | L2-Norm=13.614 | L2-Norm(final)=2.875 | acc=0.9844 | 4323.4 samples/s | 67.6 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03463 | Reg=0.00186 | L2-Norm=13.628 | L2-Norm(final)=2.873 | acc=1.0000 | 4429.8 samples/s | 69.2 steps/s
[Step=10550 Epoch=51.4] | Loss=0.03010 | Reg=0.00186 | L2-Norm=13.636 | L2-Norm(final)=2.875 | acc=0.9844 | 4545.4 samples/s | 71.0 steps/s
[Step=10600 Epoch=51.7] | Loss=0.02754 | Reg=0.00186 | L2-Norm=13.644 | L2-Norm(final)=2.879 | acc=1.0000 | 5211.2 samples/s | 81.4 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02670 | Reg=0.00186 | L2-Norm=13.652 | L2-Norm(final)=2.881 | acc=1.0000 | 1557.9 samples/s | 24.3 steps/s
[Step=10700 Epoch=52.2] | Loss=0.02432 | Reg=0.00187 | L2-Norm=13.661 | L2-Norm(final)=2.884 | acc=0.9844 | 4457.1 samples/s | 69.6 steps/s
[Step=10750 Epoch=52.4] | Loss=0.02278 | Reg=0.00187 | L2-Norm=13.670 | L2-Norm(final)=2.888 | acc=1.0000 | 4410.3 samples/s | 68.9 steps/s
[Step=10800 Epoch=52.7] | Loss=0.02144 | Reg=0.00187 | L2-Norm=13.677 | L2-Norm(final)=2.892 | acc=1.0000 | 5042.5 samples/s | 78.8 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01968 | Reg=0.00187 | L2-Norm=13.684 | L2-Norm(final)=2.896 | acc=1.0000 | 1545.0 samples/s | 24.1 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01828 | Reg=0.00187 | L2-Norm=13.690 | L2-Norm(final)=2.900 | acc=1.0000 | 4401.5 samples/s | 68.8 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01734 | Reg=0.00188 | L2-Norm=13.696 | L2-Norm(final)=2.905 | acc=1.0000 | 4456.5 samples/s | 69.6 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01653 | Reg=0.00188 | L2-Norm=13.701 | L2-Norm(final)=2.909 | acc=1.0000 | 4853.6 samples/s | 75.8 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01563 | Reg=0.00188 | L2-Norm=13.706 | L2-Norm(final)=2.913 | acc=1.0000 | 1586.2 samples/s | 24.8 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01496 | Reg=0.00188 | L2-Norm=13.711 | L2-Norm(final)=2.918 | acc=0.9844 | 4450.4 samples/s | 69.5 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01440 | Reg=0.00188 | L2-Norm=13.715 | L2-Norm(final)=2.922 | acc=1.0000 | 4222.4 samples/s | 66.0 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01372 | Reg=0.00188 | L2-Norm=13.719 | L2-Norm(final)=2.926 | acc=1.0000 | 4084.6 samples/s | 63.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step11200.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00025, len=1
[Step=8801 Epoch=42.9] | Loss=0.21409 | Reg=0.00184 | L2-Norm=13.570 | L2-Norm(final)=2.888 | acc=0.8750 | 3444.1 samples/s | 53.8 steps/s
[Step=8850 Epoch=43.1] | Loss=0.04821 | Reg=0.00185 | L2-Norm=13.605 | L2-Norm(final)=2.869 | acc=0.9688 | 4177.7 samples/s | 65.3 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03886 | Reg=0.00185 | L2-Norm=13.620 | L2-Norm(final)=2.868 | acc=1.0000 | 4361.6 samples/s | 68.1 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03271 | Reg=0.00186 | L2-Norm=13.632 | L2-Norm(final)=2.871 | acc=0.9844 | 4410.2 samples/s | 68.9 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02976 | Reg=0.00186 | L2-Norm=13.641 | L2-Norm(final)=2.876 | acc=1.0000 | 5235.5 samples/s | 81.8 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02594 | Reg=0.00186 | L2-Norm=13.650 | L2-Norm(final)=2.881 | acc=1.0000 | 1546.4 samples/s | 24.2 steps/s
[Step=9100 Epoch=44.3] | Loss=0.02299 | Reg=0.00187 | L2-Norm=13.659 | L2-Norm(final)=2.887 | acc=1.0000 | 4294.3 samples/s | 67.1 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02130 | Reg=0.00187 | L2-Norm=13.666 | L2-Norm(final)=2.892 | acc=1.0000 | 4165.1 samples/s | 65.1 steps/s
[Step=9200 Epoch=44.8] | Loss=0.01966 | Reg=0.00187 | L2-Norm=13.673 | L2-Norm(final)=2.898 | acc=0.9531 | 4545.7 samples/s | 71.0 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01833 | Reg=0.00187 | L2-Norm=13.679 | L2-Norm(final)=2.903 | acc=1.0000 | 1587.7 samples/s | 24.8 steps/s
[Step=9300 Epoch=45.3] | Loss=0.01723 | Reg=0.00187 | L2-Norm=13.684 | L2-Norm(final)=2.908 | acc=0.9844 | 4474.9 samples/s | 69.9 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01633 | Reg=0.00187 | L2-Norm=13.689 | L2-Norm(final)=2.913 | acc=1.0000 | 4245.0 samples/s | 66.3 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01555 | Reg=0.00188 | L2-Norm=13.694 | L2-Norm(final)=2.917 | acc=1.0000 | 4730.1 samples/s | 73.9 steps/s
[Step=9450 Epoch=46.0] | Loss=0.01501 | Reg=0.00188 | L2-Norm=13.698 | L2-Norm(final)=2.922 | acc=1.0000 | 1554.6 samples/s | 24.3 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01436 | Reg=0.00188 | L2-Norm=13.703 | L2-Norm(final)=2.926 | acc=1.0000 | 4432.7 samples/s | 69.3 steps/s
[Step=9550 Epoch=46.5] | Loss=0.01383 | Reg=0.00188 | L2-Norm=13.707 | L2-Norm(final)=2.930 | acc=0.9844 | 4369.8 samples/s | 68.3 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01331 | Reg=0.00188 | L2-Norm=13.711 | L2-Norm(final)=2.934 | acc=1.0000 | 4706.1 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step9600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=9601 Epoch=91.0] | Loss=0.10596 | Reg=0.00184 | L2-Norm=13.570 | L2-Norm(final)=2.888 | acc=0.9531 | 3707.6 samples/s | 57.9 steps/s
[Step=9650 Epoch=91.4] | Loss=0.00565 | Reg=0.00186 | L2-Norm=13.638 | L2-Norm(final)=2.885 | acc=1.0000 | 3966.2 samples/s | 62.0 steps/s
[Step=9700 Epoch=91.9] | Loss=0.00323 | Reg=0.00187 | L2-Norm=13.657 | L2-Norm(final)=2.890 | acc=1.0000 | 4995.1 samples/s | 78.0 steps/s
[Step=9750 Epoch=92.4] | Loss=0.00218 | Reg=0.00187 | L2-Norm=13.662 | L2-Norm(final)=2.894 | acc=1.0000 | 1511.8 samples/s | 23.6 steps/s
[Step=9800 Epoch=92.9] | Loss=0.00164 | Reg=0.00187 | L2-Norm=13.660 | L2-Norm(final)=2.897 | acc=1.0000 | 4779.9 samples/s | 74.7 steps/s
[Step=9850 Epoch=93.3] | Loss=0.00132 | Reg=0.00186 | L2-Norm=13.655 | L2-Norm(final)=2.899 | acc=1.0000 | 1515.2 samples/s | 23.7 steps/s
[Step=9900 Epoch=93.8] | Loss=0.00110 | Reg=0.00186 | L2-Norm=13.648 | L2-Norm(final)=2.900 | acc=1.0000 | 4697.6 samples/s | 73.4 steps/s
[Step=9950 Epoch=94.3] | Loss=0.00095 | Reg=0.00186 | L2-Norm=13.640 | L2-Norm(final)=2.901 | acc=1.0000 | 1537.0 samples/s | 24.0 steps/s
[Step=10000 Epoch=94.8] | Loss=0.00083 | Reg=0.00186 | L2-Norm=13.632 | L2-Norm(final)=2.902 | acc=1.0000 | 4557.8 samples/s | 71.2 steps/s
[Step=10050 Epoch=95.2] | Loss=0.00074 | Reg=0.00186 | L2-Norm=13.623 | L2-Norm(final)=2.903 | acc=1.0000 | 1588.4 samples/s | 24.8 steps/s
[Step=10100 Epoch=95.7] | Loss=0.00067 | Reg=0.00185 | L2-Norm=13.614 | L2-Norm(final)=2.904 | acc=1.0000 | 4497.1 samples/s | 70.3 steps/s
[Step=10150 Epoch=96.2] | Loss=0.00061 | Reg=0.00185 | L2-Norm=13.605 | L2-Norm(final)=2.905 | acc=1.0000 | 1570.9 samples/s | 24.5 steps/s
[Step=10200 Epoch=96.7] | Loss=0.00056 | Reg=0.00185 | L2-Norm=13.596 | L2-Norm(final)=2.906 | acc=1.0000 | 4370.9 samples/s | 68.3 steps/s
[Step=10250 Epoch=97.1] | Loss=0.00051 | Reg=0.00185 | L2-Norm=13.586 | L2-Norm(final)=2.907 | acc=1.0000 | 1587.0 samples/s | 24.8 steps/s
[Step=10300 Epoch=97.6] | Loss=0.00048 | Reg=0.00184 | L2-Norm=13.576 | L2-Norm(final)=2.907 | acc=1.0000 | 4369.0 samples/s | 68.3 steps/s
[Step=10350 Epoch=98.1] | Loss=0.00045 | Reg=0.00184 | L2-Norm=13.566 | L2-Norm(final)=2.908 | acc=1.0000 | 1582.6 samples/s | 24.7 steps/s
[Step=10400 Epoch=98.5] | Loss=0.00042 | Reg=0.00184 | L2-Norm=13.556 | L2-Norm(final)=2.909 | acc=1.0000 | 4178.5 samples/s | 65.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step10400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=8801 Epoch=83.7] | Loss=0.04078 | Reg=0.00184 | L2-Norm=13.570 | L2-Norm(final)=2.889 | acc=0.9688 | 3759.0 samples/s | 58.7 steps/s
[Step=8850 Epoch=84.2] | Loss=0.00482 | Reg=0.00186 | L2-Norm=13.642 | L2-Norm(final)=2.885 | acc=1.0000 | 4150.5 samples/s | 64.9 steps/s
[Step=8900 Epoch=84.7] | Loss=0.00273 | Reg=0.00187 | L2-Norm=13.659 | L2-Norm(final)=2.888 | acc=1.0000 | 5079.8 samples/s | 79.4 steps/s
[Step=8950 Epoch=85.1] | Loss=0.00184 | Reg=0.00187 | L2-Norm=13.663 | L2-Norm(final)=2.891 | acc=1.0000 | 1530.5 samples/s | 23.9 steps/s
[Step=9000 Epoch=85.6] | Loss=0.00139 | Reg=0.00187 | L2-Norm=13.661 | L2-Norm(final)=2.893 | acc=1.0000 | 4831.5 samples/s | 75.5 steps/s
[Step=9050 Epoch=86.1] | Loss=0.00112 | Reg=0.00187 | L2-Norm=13.657 | L2-Norm(final)=2.895 | acc=1.0000 | 1508.3 samples/s | 23.6 steps/s
[Step=9100 Epoch=86.6] | Loss=0.00093 | Reg=0.00186 | L2-Norm=13.651 | L2-Norm(final)=2.896 | acc=1.0000 | 4641.4 samples/s | 72.5 steps/s
[Step=9150 Epoch=87.0] | Loss=0.00080 | Reg=0.00186 | L2-Norm=13.645 | L2-Norm(final)=2.897 | acc=1.0000 | 1532.5 samples/s | 23.9 steps/s
[Step=9200 Epoch=87.5] | Loss=0.00071 | Reg=0.00186 | L2-Norm=13.638 | L2-Norm(final)=2.898 | acc=1.0000 | 4459.1 samples/s | 69.7 steps/s
[Step=9250 Epoch=88.0] | Loss=0.00063 | Reg=0.00186 | L2-Norm=13.631 | L2-Norm(final)=2.899 | acc=1.0000 | 1518.9 samples/s | 23.7 steps/s
[Step=9300 Epoch=88.5] | Loss=0.00057 | Reg=0.00186 | L2-Norm=13.623 | L2-Norm(final)=2.900 | acc=1.0000 | 3829.2 samples/s | 59.8 steps/s
[Step=9350 Epoch=88.9] | Loss=0.00052 | Reg=0.00185 | L2-Norm=13.615 | L2-Norm(final)=2.901 | acc=1.0000 | 1587.3 samples/s | 24.8 steps/s
[Step=9400 Epoch=89.4] | Loss=0.00048 | Reg=0.00185 | L2-Norm=13.607 | L2-Norm(final)=2.902 | acc=1.0000 | 4138.3 samples/s | 64.7 steps/s
[Step=9450 Epoch=89.9] | Loss=0.00044 | Reg=0.00185 | L2-Norm=13.599 | L2-Norm(final)=2.903 | acc=1.0000 | 1625.0 samples/s | 25.4 steps/s
[Step=9500 Epoch=90.4] | Loss=0.00041 | Reg=0.00185 | L2-Norm=13.590 | L2-Norm(final)=2.903 | acc=1.0000 | 4265.7 samples/s | 66.7 steps/s
[Step=9550 Epoch=90.8] | Loss=0.00038 | Reg=0.00184 | L2-Norm=13.582 | L2-Norm(final)=2.904 | acc=1.0000 | 1586.4 samples/s | 24.8 steps/s
[Step=9600 Epoch=91.3] | Loss=0.00036 | Reg=0.00184 | L2-Norm=13.573 | L2-Norm(final)=2.905 | acc=1.0000 | 4297.1 samples/s | 67.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step9600.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00025, len=1
[Step=8801 Epoch=84.0] | Loss=0.04301 | Reg=0.00184 | L2-Norm=13.570 | L2-Norm(final)=2.888 | acc=0.9844 | 3741.3 samples/s | 58.5 steps/s
[Step=8850 Epoch=84.5] | Loss=0.00628 | Reg=0.00185 | L2-Norm=13.614 | L2-Norm(final)=2.880 | acc=1.0000 | 4065.9 samples/s | 63.5 steps/s
[Step=8900 Epoch=85.0] | Loss=0.00331 | Reg=0.00186 | L2-Norm=13.629 | L2-Norm(final)=2.882 | acc=1.0000 | 5114.8 samples/s | 79.9 steps/s
[Step=8950 Epoch=85.5] | Loss=0.00222 | Reg=0.00186 | L2-Norm=13.632 | L2-Norm(final)=2.884 | acc=1.0000 | 1528.3 samples/s | 23.9 steps/s
[Step=9000 Epoch=85.9] | Loss=0.00167 | Reg=0.00186 | L2-Norm=13.629 | L2-Norm(final)=2.885 | acc=1.0000 | 4951.6 samples/s | 77.4 steps/s
[Step=9050 Epoch=86.4] | Loss=0.00134 | Reg=0.00186 | L2-Norm=13.625 | L2-Norm(final)=2.886 | acc=1.0000 | 1526.1 samples/s | 23.8 steps/s
[Step=9100 Epoch=86.9] | Loss=0.00112 | Reg=0.00185 | L2-Norm=13.619 | L2-Norm(final)=2.887 | acc=1.0000 | 4706.4 samples/s | 73.5 steps/s
[Step=9150 Epoch=87.4] | Loss=0.00096 | Reg=0.00185 | L2-Norm=13.613 | L2-Norm(final)=2.888 | acc=1.0000 | 1538.2 samples/s | 24.0 steps/s
[Step=9200 Epoch=87.9] | Loss=0.00084 | Reg=0.00185 | L2-Norm=13.607 | L2-Norm(final)=2.888 | acc=1.0000 | 4597.4 samples/s | 71.8 steps/s
[Step=9250 Epoch=88.3] | Loss=0.00075 | Reg=0.00185 | L2-Norm=13.600 | L2-Norm(final)=2.889 | acc=1.0000 | 1539.7 samples/s | 24.1 steps/s
[Step=9300 Epoch=88.8] | Loss=0.00068 | Reg=0.00185 | L2-Norm=13.593 | L2-Norm(final)=2.889 | acc=1.0000 | 4450.8 samples/s | 69.5 steps/s
[Step=9350 Epoch=89.3] | Loss=0.00062 | Reg=0.00185 | L2-Norm=13.586 | L2-Norm(final)=2.890 | acc=1.0000 | 1567.4 samples/s | 24.5 steps/s
[Step=9400 Epoch=89.8] | Loss=0.00057 | Reg=0.00184 | L2-Norm=13.579 | L2-Norm(final)=2.891 | acc=1.0000 | 4367.0 samples/s | 68.2 steps/s
[Step=9450 Epoch=90.2] | Loss=0.00052 | Reg=0.00184 | L2-Norm=13.571 | L2-Norm(final)=2.891 | acc=1.0000 | 1591.2 samples/s | 24.9 steps/s
[Step=9500 Epoch=90.7] | Loss=0.00049 | Reg=0.00184 | L2-Norm=13.564 | L2-Norm(final)=2.892 | acc=1.0000 | 4158.6 samples/s | 65.0 steps/s
[Step=9550 Epoch=91.2] | Loss=0.00045 | Reg=0.00184 | L2-Norm=13.556 | L2-Norm(final)=2.892 | acc=1.0000 | 1574.7 samples/s | 24.6 steps/s
[Step=9600 Epoch=91.7] | Loss=0.00043 | Reg=0.00184 | L2-Norm=13.548 | L2-Norm(final)=2.892 | acc=1.0000 | 4288.6 samples/s | 67.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39983 | acc=0.7692 | tpr=0.6675 | fpr=0.0099 | 4309.4 samples/s | 16.8 steps/s
Avg test loss: 0.40210, Avg test acc: 0.77025, Avg tpr: 0.67028, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.37197 | acc=0.8805 | tpr=0.9602 | fpr=0.1210 | 4363.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.37634 | acc=0.8803 | tpr=0.9680 | fpr=0.1214 | 8788.1 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.38245 | acc=0.8793 | tpr=0.9712 | fpr=0.1224 | 8786.2 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.38604 | acc=0.8788 | tpr=0.9738 | fpr=0.1229 | 8768.4 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.38439 | acc=0.8790 | tpr=0.9721 | fpr=0.1227 | 8524.2 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.38866 | acc=0.8777 | tpr=0.9738 | fpr=0.1240 | 8697.5 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.38932 | acc=0.8776 | tpr=0.9731 | fpr=0.1242 | 8896.5 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.39099 | acc=0.8781 | tpr=0.9721 | fpr=0.1236 | 9149.7 samples/s | 35.7 steps/s
[Step= 450] | Loss=0.39570 | acc=0.8777 | tpr=0.9713 | fpr=0.1240 | 8173.6 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.39487 | acc=0.8774 | tpr=0.9727 | fpr=0.1243 | 8826.1 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.39406 | acc=0.8773 | tpr=0.9713 | fpr=0.1244 | 16124.1 samples/s | 63.0 steps/s
Avg test loss: 0.39390, Avg test acc: 0.87729, Avg tpr: 0.97068, Avg fpr: 0.12441, total FA: 17274

server round 24/50

clients selected: [1 3 4 6 9]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=10401 Epoch=50.8] | Loss=0.38722 | Reg=0.00183 | L2-Norm=13.545 | L2-Norm(final)=2.925 | acc=0.7812 | 3739.3 samples/s | 58.4 steps/s
[Step=10450 Epoch=51.0] | Loss=0.04099 | Reg=0.00184 | L2-Norm=13.571 | L2-Norm(final)=2.909 | acc=0.9844 | 4381.6 samples/s | 68.5 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03277 | Reg=0.00184 | L2-Norm=13.582 | L2-Norm(final)=2.907 | acc=0.9531 | 4396.8 samples/s | 68.7 steps/s
[Step=10550 Epoch=51.5] | Loss=0.02883 | Reg=0.00185 | L2-Norm=13.590 | L2-Norm(final)=2.908 | acc=1.0000 | 4383.7 samples/s | 68.5 steps/s
[Step=10600 Epoch=51.7] | Loss=0.02568 | Reg=0.00185 | L2-Norm=13.597 | L2-Norm(final)=2.911 | acc=0.9844 | 5197.1 samples/s | 81.2 steps/s
[Step=10650 Epoch=52.0] | Loss=0.02222 | Reg=0.00185 | L2-Norm=13.604 | L2-Norm(final)=2.914 | acc=1.0000 | 1472.7 samples/s | 23.0 steps/s
[Step=10700 Epoch=52.2] | Loss=0.02008 | Reg=0.00185 | L2-Norm=13.610 | L2-Norm(final)=2.919 | acc=0.9844 | 3901.0 samples/s | 61.0 steps/s
[Step=10750 Epoch=52.5] | Loss=0.01820 | Reg=0.00185 | L2-Norm=13.616 | L2-Norm(final)=2.924 | acc=1.0000 | 3846.5 samples/s | 60.1 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01682 | Reg=0.00186 | L2-Norm=13.621 | L2-Norm(final)=2.929 | acc=1.0000 | 4653.9 samples/s | 72.7 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01579 | Reg=0.00186 | L2-Norm=13.626 | L2-Norm(final)=2.934 | acc=0.9844 | 1551.3 samples/s | 24.2 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01493 | Reg=0.00186 | L2-Norm=13.631 | L2-Norm(final)=2.938 | acc=1.0000 | 4448.9 samples/s | 69.5 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01410 | Reg=0.00186 | L2-Norm=13.635 | L2-Norm(final)=2.943 | acc=1.0000 | 4409.0 samples/s | 68.9 steps/s
[Step=11000 Epoch=53.7] | Loss=0.01353 | Reg=0.00186 | L2-Norm=13.639 | L2-Norm(final)=2.947 | acc=1.0000 | 4965.6 samples/s | 77.6 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01280 | Reg=0.00186 | L2-Norm=13.642 | L2-Norm(final)=2.951 | acc=1.0000 | 1573.3 samples/s | 24.6 steps/s
[Step=11100 Epoch=54.2] | Loss=0.01236 | Reg=0.00186 | L2-Norm=13.646 | L2-Norm(final)=2.956 | acc=1.0000 | 4444.3 samples/s | 69.4 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01194 | Reg=0.00186 | L2-Norm=13.649 | L2-Norm(final)=2.960 | acc=1.0000 | 4392.9 samples/s | 68.6 steps/s
[Step=11200 Epoch=54.7] | Loss=0.01155 | Reg=0.00186 | L2-Norm=13.652 | L2-Norm(final)=2.963 | acc=1.0000 | 4791.3 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step11200.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00025, len=1
[Step=8801 Epoch=42.9] | Loss=0.14497 | Reg=0.00183 | L2-Norm=13.545 | L2-Norm(final)=2.926 | acc=0.9062 | 3991.5 samples/s | 62.4 steps/s
[Step=8850 Epoch=43.2] | Loss=0.05744 | Reg=0.00184 | L2-Norm=13.578 | L2-Norm(final)=2.901 | acc=1.0000 | 4377.3 samples/s | 68.4 steps/s
[Step=8900 Epoch=43.4] | Loss=0.04223 | Reg=0.00185 | L2-Norm=13.594 | L2-Norm(final)=2.898 | acc=0.9688 | 4395.0 samples/s | 68.7 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03512 | Reg=0.00185 | L2-Norm=13.604 | L2-Norm(final)=2.899 | acc=0.9688 | 4325.0 samples/s | 67.6 steps/s
[Step=9000 Epoch=43.9] | Loss=0.03033 | Reg=0.00185 | L2-Norm=13.614 | L2-Norm(final)=2.903 | acc=1.0000 | 5208.1 samples/s | 81.4 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02626 | Reg=0.00186 | L2-Norm=13.622 | L2-Norm(final)=2.908 | acc=1.0000 | 1547.3 samples/s | 24.2 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02316 | Reg=0.00186 | L2-Norm=13.630 | L2-Norm(final)=2.913 | acc=1.0000 | 4426.0 samples/s | 69.2 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02074 | Reg=0.00186 | L2-Norm=13.637 | L2-Norm(final)=2.919 | acc=1.0000 | 4468.7 samples/s | 69.8 steps/s
[Step=9200 Epoch=44.9] | Loss=0.01945 | Reg=0.00186 | L2-Norm=13.644 | L2-Norm(final)=2.924 | acc=1.0000 | 4925.1 samples/s | 77.0 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01821 | Reg=0.00186 | L2-Norm=13.650 | L2-Norm(final)=2.929 | acc=1.0000 | 1576.5 samples/s | 24.6 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01685 | Reg=0.00186 | L2-Norm=13.655 | L2-Norm(final)=2.934 | acc=0.9844 | 4391.3 samples/s | 68.6 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01595 | Reg=0.00187 | L2-Norm=13.660 | L2-Norm(final)=2.938 | acc=0.9844 | 4374.4 samples/s | 68.3 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01509 | Reg=0.00187 | L2-Norm=13.665 | L2-Norm(final)=2.943 | acc=1.0000 | 4911.2 samples/s | 76.7 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01427 | Reg=0.00187 | L2-Norm=13.669 | L2-Norm(final)=2.948 | acc=1.0000 | 1584.7 samples/s | 24.8 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01359 | Reg=0.00187 | L2-Norm=13.674 | L2-Norm(final)=2.952 | acc=1.0000 | 4338.2 samples/s | 67.8 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01296 | Reg=0.00187 | L2-Norm=13.678 | L2-Norm(final)=2.957 | acc=1.0000 | 4381.1 samples/s | 68.5 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01256 | Reg=0.00187 | L2-Norm=13.682 | L2-Norm(final)=2.961 | acc=1.0000 | 4730.7 samples/s | 73.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step9600.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00025, len=1
[Step=8801 Epoch=43.2] | Loss=0.14613 | Reg=0.00183 | L2-Norm=13.545 | L2-Norm(final)=2.926 | acc=0.8906 | 3955.0 samples/s | 61.8 steps/s
[Step=8850 Epoch=43.4] | Loss=0.05548 | Reg=0.00184 | L2-Norm=13.582 | L2-Norm(final)=2.905 | acc=1.0000 | 4127.7 samples/s | 64.5 steps/s
[Step=8900 Epoch=43.6] | Loss=0.03910 | Reg=0.00185 | L2-Norm=13.596 | L2-Norm(final)=2.900 | acc=0.9844 | 4456.3 samples/s | 69.6 steps/s
[Step=8950 Epoch=43.9] | Loss=0.03276 | Reg=0.00185 | L2-Norm=13.604 | L2-Norm(final)=2.901 | acc=0.9688 | 4381.9 samples/s | 68.5 steps/s
[Step=9000 Epoch=44.1] | Loss=0.02908 | Reg=0.00185 | L2-Norm=13.612 | L2-Norm(final)=2.903 | acc=0.9844 | 5297.3 samples/s | 82.8 steps/s
[Step=9050 Epoch=44.4] | Loss=0.02518 | Reg=0.00185 | L2-Norm=13.618 | L2-Norm(final)=2.906 | acc=1.0000 | 1554.7 samples/s | 24.3 steps/s
[Step=9100 Epoch=44.6] | Loss=0.02209 | Reg=0.00186 | L2-Norm=13.625 | L2-Norm(final)=2.911 | acc=1.0000 | 4362.9 samples/s | 68.2 steps/s
[Step=9150 Epoch=44.9] | Loss=0.01992 | Reg=0.00186 | L2-Norm=13.631 | L2-Norm(final)=2.916 | acc=1.0000 | 4429.7 samples/s | 69.2 steps/s
[Step=9200 Epoch=45.1] | Loss=0.01864 | Reg=0.00186 | L2-Norm=13.636 | L2-Norm(final)=2.921 | acc=1.0000 | 5215.8 samples/s | 81.5 steps/s
[Step=9250 Epoch=45.4] | Loss=0.01735 | Reg=0.00186 | L2-Norm=13.642 | L2-Norm(final)=2.925 | acc=1.0000 | 1574.4 samples/s | 24.6 steps/s
[Step=9300 Epoch=45.6] | Loss=0.01606 | Reg=0.00186 | L2-Norm=13.647 | L2-Norm(final)=2.930 | acc=1.0000 | 4415.5 samples/s | 69.0 steps/s
[Step=9350 Epoch=45.9] | Loss=0.01510 | Reg=0.00186 | L2-Norm=13.652 | L2-Norm(final)=2.935 | acc=0.9688 | 4143.6 samples/s | 64.7 steps/s
[Step=9400 Epoch=46.1] | Loss=0.01433 | Reg=0.00186 | L2-Norm=13.656 | L2-Norm(final)=2.939 | acc=0.9844 | 4575.9 samples/s | 71.5 steps/s
[Step=9450 Epoch=46.3] | Loss=0.01364 | Reg=0.00187 | L2-Norm=13.660 | L2-Norm(final)=2.943 | acc=1.0000 | 1563.4 samples/s | 24.4 steps/s
[Step=9500 Epoch=46.6] | Loss=0.01294 | Reg=0.00187 | L2-Norm=13.664 | L2-Norm(final)=2.947 | acc=1.0000 | 4440.1 samples/s | 69.4 steps/s
[Step=9550 Epoch=46.8] | Loss=0.01259 | Reg=0.00187 | L2-Norm=13.668 | L2-Norm(final)=2.951 | acc=1.0000 | 4388.4 samples/s | 68.6 steps/s
[Step=9600 Epoch=47.1] | Loss=0.01215 | Reg=0.00187 | L2-Norm=13.671 | L2-Norm(final)=2.955 | acc=1.0000 | 4906.1 samples/s | 76.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step9600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=9601 Epoch=91.3] | Loss=0.08603 | Reg=0.00183 | L2-Norm=13.545 | L2-Norm(final)=2.926 | acc=0.9375 | 4215.3 samples/s | 65.9 steps/s
[Step=9650 Epoch=91.8] | Loss=0.00570 | Reg=0.00185 | L2-Norm=13.599 | L2-Norm(final)=2.913 | acc=1.0000 | 4089.4 samples/s | 63.9 steps/s
[Step=9700 Epoch=92.3] | Loss=0.00306 | Reg=0.00185 | L2-Norm=13.609 | L2-Norm(final)=2.915 | acc=1.0000 | 5026.0 samples/s | 78.5 steps/s
[Step=9750 Epoch=92.7] | Loss=0.00206 | Reg=0.00185 | L2-Norm=13.609 | L2-Norm(final)=2.918 | acc=1.0000 | 1509.5 samples/s | 23.6 steps/s
[Step=9800 Epoch=93.2] | Loss=0.00155 | Reg=0.00185 | L2-Norm=13.606 | L2-Norm(final)=2.919 | acc=1.0000 | 4908.2 samples/s | 76.7 steps/s
[Step=9850 Epoch=93.7] | Loss=0.00125 | Reg=0.00185 | L2-Norm=13.600 | L2-Norm(final)=2.921 | acc=1.0000 | 1470.6 samples/s | 23.0 steps/s
[Step=9900 Epoch=94.2] | Loss=0.00104 | Reg=0.00185 | L2-Norm=13.594 | L2-Norm(final)=2.922 | acc=1.0000 | 4147.7 samples/s | 64.8 steps/s
[Step=9950 Epoch=94.6] | Loss=0.00090 | Reg=0.00185 | L2-Norm=13.587 | L2-Norm(final)=2.923 | acc=1.0000 | 1480.5 samples/s | 23.1 steps/s
[Step=10000 Epoch=95.1] | Loss=0.00079 | Reg=0.00184 | L2-Norm=13.579 | L2-Norm(final)=2.924 | acc=1.0000 | 4019.6 samples/s | 62.8 steps/s
[Step=10050 Epoch=95.6] | Loss=0.00070 | Reg=0.00184 | L2-Norm=13.572 | L2-Norm(final)=2.925 | acc=1.0000 | 1564.5 samples/s | 24.4 steps/s
[Step=10100 Epoch=96.1] | Loss=0.00063 | Reg=0.00184 | L2-Norm=13.564 | L2-Norm(final)=2.926 | acc=1.0000 | 4514.0 samples/s | 70.5 steps/s
[Step=10150 Epoch=96.6] | Loss=0.00058 | Reg=0.00184 | L2-Norm=13.555 | L2-Norm(final)=2.927 | acc=1.0000 | 1704.3 samples/s | 26.6 steps/s
[Step=10200 Epoch=97.0] | Loss=0.00053 | Reg=0.00184 | L2-Norm=13.547 | L2-Norm(final)=2.927 | acc=1.0000 | 4349.1 samples/s | 68.0 steps/s
[Step=10250 Epoch=97.5] | Loss=0.00049 | Reg=0.00183 | L2-Norm=13.539 | L2-Norm(final)=2.928 | acc=1.0000 | 1594.2 samples/s | 24.9 steps/s
[Step=10300 Epoch=98.0] | Loss=0.00046 | Reg=0.00183 | L2-Norm=13.530 | L2-Norm(final)=2.929 | acc=1.0000 | 4280.7 samples/s | 66.9 steps/s
[Step=10350 Epoch=98.5] | Loss=0.00043 | Reg=0.00183 | L2-Norm=13.521 | L2-Norm(final)=2.930 | acc=1.0000 | 1586.0 samples/s | 24.8 steps/s
[Step=10400 Epoch=98.9] | Loss=0.00040 | Reg=0.00183 | L2-Norm=13.512 | L2-Norm(final)=2.930 | acc=1.0000 | 4226.2 samples/s | 66.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step10400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00025, len=1
[Step=10401 Epoch=99.1] | Loss=0.06111 | Reg=0.00183 | L2-Norm=13.545 | L2-Norm(final)=2.925 | acc=0.9688 | 3620.2 samples/s | 56.6 steps/s
[Step=10450 Epoch=99.6] | Loss=0.00515 | Reg=0.00185 | L2-Norm=13.613 | L2-Norm(final)=2.922 | acc=1.0000 | 4238.4 samples/s | 66.2 steps/s
[Step=10500 Epoch=100.1] | Loss=0.00266 | Reg=0.00186 | L2-Norm=13.629 | L2-Norm(final)=2.926 | acc=1.0000 | 5062.5 samples/s | 79.1 steps/s
[Step=10550 Epoch=100.6] | Loss=0.00178 | Reg=0.00186 | L2-Norm=13.630 | L2-Norm(final)=2.930 | acc=1.0000 | 1638.3 samples/s | 25.6 steps/s
[Step=10600 Epoch=101.0] | Loss=0.00135 | Reg=0.00186 | L2-Norm=13.626 | L2-Norm(final)=2.932 | acc=1.0000 | 4867.4 samples/s | 76.1 steps/s
[Step=10650 Epoch=101.5] | Loss=0.00108 | Reg=0.00185 | L2-Norm=13.620 | L2-Norm(final)=2.933 | acc=1.0000 | 1528.7 samples/s | 23.9 steps/s
[Step=10700 Epoch=102.0] | Loss=0.00090 | Reg=0.00185 | L2-Norm=13.613 | L2-Norm(final)=2.935 | acc=1.0000 | 4787.8 samples/s | 74.8 steps/s
[Step=10750 Epoch=102.5] | Loss=0.00078 | Reg=0.00185 | L2-Norm=13.605 | L2-Norm(final)=2.936 | acc=1.0000 | 1588.2 samples/s | 24.8 steps/s
[Step=10800 Epoch=102.9] | Loss=0.00068 | Reg=0.00185 | L2-Norm=13.597 | L2-Norm(final)=2.937 | acc=1.0000 | 4508.6 samples/s | 70.4 steps/s
[Step=10850 Epoch=103.4] | Loss=0.00061 | Reg=0.00185 | L2-Norm=13.588 | L2-Norm(final)=2.938 | acc=1.0000 | 1557.7 samples/s | 24.3 steps/s
[Step=10900 Epoch=103.9] | Loss=0.00055 | Reg=0.00184 | L2-Norm=13.579 | L2-Norm(final)=2.939 | acc=1.0000 | 4205.1 samples/s | 65.7 steps/s
[Step=10950 Epoch=104.4] | Loss=0.00050 | Reg=0.00184 | L2-Norm=13.570 | L2-Norm(final)=2.940 | acc=1.0000 | 1519.8 samples/s | 23.7 steps/s
[Step=11000 Epoch=104.8] | Loss=0.00046 | Reg=0.00184 | L2-Norm=13.561 | L2-Norm(final)=2.941 | acc=1.0000 | 3810.4 samples/s | 59.5 steps/s
[Step=11050 Epoch=105.3] | Loss=0.00042 | Reg=0.00184 | L2-Norm=13.552 | L2-Norm(final)=2.941 | acc=1.0000 | 1562.0 samples/s | 24.4 steps/s
[Step=11100 Epoch=105.8] | Loss=0.00039 | Reg=0.00183 | L2-Norm=13.542 | L2-Norm(final)=2.942 | acc=1.0000 | 4274.4 samples/s | 66.8 steps/s
[Step=11150 Epoch=106.3] | Loss=0.00037 | Reg=0.00183 | L2-Norm=13.533 | L2-Norm(final)=2.943 | acc=1.0000 | 1588.7 samples/s | 24.8 steps/s
[Step=11200 Epoch=106.7] | Loss=0.00035 | Reg=0.00183 | L2-Norm=13.523 | L2-Norm(final)=2.944 | acc=1.0000 | 4275.5 samples/s | 66.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42755 | acc=0.7564 | tpr=0.6479 | fpr=0.0079 | 4429.5 samples/s | 17.3 steps/s
Avg test loss: 0.43039, Avg test acc: 0.75799, Avg tpr: 0.65192, Avg fpr: 0.00872, total FA: 68

Testing server on iccad2012
[Step=  50] | Loss=0.35243 | acc=0.8879 | tpr=0.9602 | fpr=0.1134 | 4375.7 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.35843 | acc=0.8875 | tpr=0.9659 | fpr=0.1140 | 8292.8 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.36514 | acc=0.8867 | tpr=0.9697 | fpr=0.1148 | 8116.8 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.36844 | acc=0.8863 | tpr=0.9727 | fpr=0.1152 | 9038.1 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.36688 | acc=0.8862 | tpr=0.9712 | fpr=0.1153 | 8456.1 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.37112 | acc=0.8852 | tpr=0.9724 | fpr=0.1163 | 8840.4 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.37191 | acc=0.8849 | tpr=0.9718 | fpr=0.1167 | 8552.6 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.37355 | acc=0.8853 | tpr=0.9710 | fpr=0.1163 | 8931.0 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.37810 | acc=0.8847 | tpr=0.9698 | fpr=0.1168 | 8280.0 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.37714 | acc=0.8844 | tpr=0.9709 | fpr=0.1172 | 8864.8 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.37629 | acc=0.8843 | tpr=0.9702 | fpr=0.1172 | 15984.0 samples/s | 62.4 steps/s
Avg test loss: 0.37611, Avg test acc: 0.88435, Avg tpr: 0.96949, Avg fpr: 0.11719, total FA: 16272

server round 25/50

clients selected: [0 2 4 5 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=11201 Epoch=54.6] | Loss=0.19247 | Reg=0.00182 | L2-Norm=13.499 | L2-Norm(final)=2.958 | acc=0.8594 | 4009.4 samples/s | 62.6 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04377 | Reg=0.00183 | L2-Norm=13.533 | L2-Norm(final)=2.941 | acc=0.9844 | 4081.2 samples/s | 63.8 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03341 | Reg=0.00184 | L2-Norm=13.547 | L2-Norm(final)=2.940 | acc=0.9688 | 4369.9 samples/s | 68.3 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02844 | Reg=0.00184 | L2-Norm=13.554 | L2-Norm(final)=2.942 | acc=0.9844 | 4379.7 samples/s | 68.4 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02572 | Reg=0.00184 | L2-Norm=13.561 | L2-Norm(final)=2.944 | acc=0.9844 | 5078.4 samples/s | 79.4 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02230 | Reg=0.00184 | L2-Norm=13.568 | L2-Norm(final)=2.948 | acc=1.0000 | 1548.0 samples/s | 24.2 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01982 | Reg=0.00184 | L2-Norm=13.575 | L2-Norm(final)=2.953 | acc=1.0000 | 4458.4 samples/s | 69.7 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01816 | Reg=0.00184 | L2-Norm=13.581 | L2-Norm(final)=2.959 | acc=0.9844 | 4544.1 samples/s | 71.0 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01720 | Reg=0.00185 | L2-Norm=13.587 | L2-Norm(final)=2.964 | acc=0.9844 | 5083.4 samples/s | 79.4 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01596 | Reg=0.00185 | L2-Norm=13.591 | L2-Norm(final)=2.969 | acc=1.0000 | 1560.0 samples/s | 24.4 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01495 | Reg=0.00185 | L2-Norm=13.596 | L2-Norm(final)=2.973 | acc=1.0000 | 4438.0 samples/s | 69.3 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01403 | Reg=0.00185 | L2-Norm=13.600 | L2-Norm(final)=2.978 | acc=1.0000 | 4430.6 samples/s | 69.2 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01344 | Reg=0.00185 | L2-Norm=13.604 | L2-Norm(final)=2.983 | acc=1.0000 | 4825.2 samples/s | 75.4 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01289 | Reg=0.00185 | L2-Norm=13.607 | L2-Norm(final)=2.987 | acc=0.9688 | 1585.1 samples/s | 24.8 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01225 | Reg=0.00185 | L2-Norm=13.610 | L2-Norm(final)=2.991 | acc=1.0000 | 4363.2 samples/s | 68.2 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01198 | Reg=0.00185 | L2-Norm=13.613 | L2-Norm(final)=2.995 | acc=0.9688 | 4480.9 samples/s | 70.0 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01157 | Reg=0.00185 | L2-Norm=13.616 | L2-Norm(final)=2.999 | acc=1.0000 | 4650.3 samples/s | 72.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12000.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00025, len=1
[Step=9601 Epoch=46.8] | Loss=0.17621 | Reg=0.00182 | L2-Norm=13.499 | L2-Norm(final)=2.958 | acc=0.8750 | 3859.3 samples/s | 60.3 steps/s
[Step=9650 Epoch=47.0] | Loss=0.04610 | Reg=0.00183 | L2-Norm=13.539 | L2-Norm(final)=2.939 | acc=1.0000 | 4170.5 samples/s | 65.2 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03373 | Reg=0.00184 | L2-Norm=13.556 | L2-Norm(final)=2.939 | acc=0.9844 | 4435.9 samples/s | 69.3 steps/s
[Step=9750 Epoch=47.5] | Loss=0.02954 | Reg=0.00184 | L2-Norm=13.567 | L2-Norm(final)=2.941 | acc=1.0000 | 4395.4 samples/s | 68.7 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02642 | Reg=0.00184 | L2-Norm=13.575 | L2-Norm(final)=2.943 | acc=1.0000 | 5204.0 samples/s | 81.3 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02376 | Reg=0.00185 | L2-Norm=13.583 | L2-Norm(final)=2.947 | acc=0.9844 | 1556.9 samples/s | 24.3 steps/s
[Step=9900 Epoch=48.2] | Loss=0.02101 | Reg=0.00185 | L2-Norm=13.591 | L2-Norm(final)=2.951 | acc=1.0000 | 4465.0 samples/s | 69.8 steps/s
[Step=9950 Epoch=48.5] | Loss=0.01986 | Reg=0.00185 | L2-Norm=13.598 | L2-Norm(final)=2.956 | acc=1.0000 | 4424.9 samples/s | 69.1 steps/s
[Step=10000 Epoch=48.7] | Loss=0.01855 | Reg=0.00185 | L2-Norm=13.604 | L2-Norm(final)=2.960 | acc=1.0000 | 5002.4 samples/s | 78.2 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01739 | Reg=0.00185 | L2-Norm=13.610 | L2-Norm(final)=2.964 | acc=0.9844 | 1588.2 samples/s | 24.8 steps/s
[Step=10100 Epoch=49.2] | Loss=0.01629 | Reg=0.00185 | L2-Norm=13.615 | L2-Norm(final)=2.968 | acc=0.9844 | 4351.7 samples/s | 68.0 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01529 | Reg=0.00186 | L2-Norm=13.620 | L2-Norm(final)=2.973 | acc=0.9844 | 4444.1 samples/s | 69.4 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01457 | Reg=0.00186 | L2-Norm=13.625 | L2-Norm(final)=2.977 | acc=1.0000 | 4879.5 samples/s | 76.2 steps/s
[Step=10250 Epoch=49.9] | Loss=0.01386 | Reg=0.00186 | L2-Norm=13.629 | L2-Norm(final)=2.982 | acc=1.0000 | 1548.5 samples/s | 24.2 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01322 | Reg=0.00186 | L2-Norm=13.633 | L2-Norm(final)=2.986 | acc=1.0000 | 3916.4 samples/s | 61.2 steps/s
[Step=10350 Epoch=50.4] | Loss=0.01272 | Reg=0.00186 | L2-Norm=13.637 | L2-Norm(final)=2.990 | acc=0.9844 | 3888.8 samples/s | 60.8 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01231 | Reg=0.00186 | L2-Norm=13.641 | L2-Norm(final)=2.994 | acc=1.0000 | 4148.0 samples/s | 64.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step10400.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00025, len=1
[Step=9601 Epoch=47.1] | Loss=0.24872 | Reg=0.00182 | L2-Norm=13.499 | L2-Norm(final)=2.957 | acc=0.8594 | 3431.5 samples/s | 53.6 steps/s
[Step=9650 Epoch=47.3] | Loss=0.04544 | Reg=0.00183 | L2-Norm=13.532 | L2-Norm(final)=2.938 | acc=1.0000 | 4353.6 samples/s | 68.0 steps/s
[Step=9700 Epoch=47.6] | Loss=0.03277 | Reg=0.00183 | L2-Norm=13.546 | L2-Norm(final)=2.938 | acc=0.9688 | 4560.3 samples/s | 71.3 steps/s
[Step=9750 Epoch=47.8] | Loss=0.02945 | Reg=0.00184 | L2-Norm=13.554 | L2-Norm(final)=2.938 | acc=0.9844 | 4496.5 samples/s | 70.3 steps/s
[Step=9800 Epoch=48.1] | Loss=0.02607 | Reg=0.00184 | L2-Norm=13.562 | L2-Norm(final)=2.941 | acc=1.0000 | 5249.1 samples/s | 82.0 steps/s
[Step=9850 Epoch=48.3] | Loss=0.02273 | Reg=0.00184 | L2-Norm=13.570 | L2-Norm(final)=2.945 | acc=0.9844 | 1545.2 samples/s | 24.1 steps/s
[Step=9900 Epoch=48.5] | Loss=0.02032 | Reg=0.00184 | L2-Norm=13.578 | L2-Norm(final)=2.949 | acc=0.9844 | 4363.7 samples/s | 68.2 steps/s
[Step=9950 Epoch=48.8] | Loss=0.01845 | Reg=0.00185 | L2-Norm=13.584 | L2-Norm(final)=2.953 | acc=0.9844 | 4416.0 samples/s | 69.0 steps/s
[Step=10000 Epoch=49.0] | Loss=0.01714 | Reg=0.00185 | L2-Norm=13.590 | L2-Norm(final)=2.958 | acc=0.9844 | 5064.4 samples/s | 79.1 steps/s
[Step=10050 Epoch=49.3] | Loss=0.01600 | Reg=0.00185 | L2-Norm=13.595 | L2-Norm(final)=2.962 | acc=0.9844 | 1546.6 samples/s | 24.2 steps/s
[Step=10100 Epoch=49.5] | Loss=0.01505 | Reg=0.00185 | L2-Norm=13.600 | L2-Norm(final)=2.966 | acc=0.9844 | 4447.2 samples/s | 69.5 steps/s
[Step=10150 Epoch=49.8] | Loss=0.01420 | Reg=0.00185 | L2-Norm=13.605 | L2-Norm(final)=2.971 | acc=0.9844 | 4374.7 samples/s | 68.4 steps/s
[Step=10200 Epoch=50.0] | Loss=0.01343 | Reg=0.00185 | L2-Norm=13.609 | L2-Norm(final)=2.975 | acc=1.0000 | 5027.8 samples/s | 78.6 steps/s
[Step=10250 Epoch=50.3] | Loss=0.01274 | Reg=0.00185 | L2-Norm=13.613 | L2-Norm(final)=2.979 | acc=0.9844 | 1502.6 samples/s | 23.5 steps/s
[Step=10300 Epoch=50.5] | Loss=0.01212 | Reg=0.00185 | L2-Norm=13.617 | L2-Norm(final)=2.983 | acc=1.0000 | 3879.7 samples/s | 60.6 steps/s
[Step=10350 Epoch=50.8] | Loss=0.01158 | Reg=0.00186 | L2-Norm=13.620 | L2-Norm(final)=2.987 | acc=0.9844 | 3901.9 samples/s | 61.0 steps/s
[Step=10400 Epoch=51.0] | Loss=0.01131 | Reg=0.00186 | L2-Norm=13.624 | L2-Norm(final)=2.991 | acc=1.0000 | 4384.2 samples/s | 68.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step10400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=10401 Epoch=98.6] | Loss=0.01791 | Reg=0.00182 | L2-Norm=13.499 | L2-Norm(final)=2.959 | acc=0.9844 | 3305.0 samples/s | 51.6 steps/s
[Step=10450 Epoch=99.0] | Loss=0.00403 | Reg=0.00184 | L2-Norm=13.565 | L2-Norm(final)=2.964 | acc=1.0000 | 3993.5 samples/s | 62.4 steps/s
[Step=10500 Epoch=99.5] | Loss=0.00235 | Reg=0.00185 | L2-Norm=13.584 | L2-Norm(final)=2.965 | acc=1.0000 | 4960.8 samples/s | 77.5 steps/s
[Step=10550 Epoch=100.0] | Loss=0.00159 | Reg=0.00185 | L2-Norm=13.588 | L2-Norm(final)=2.967 | acc=1.0000 | 1497.4 samples/s | 23.4 steps/s
[Step=10600 Epoch=100.4] | Loss=0.00120 | Reg=0.00185 | L2-Norm=13.586 | L2-Norm(final)=2.969 | acc=1.0000 | 4563.1 samples/s | 71.3 steps/s
[Step=10650 Epoch=100.9] | Loss=0.00097 | Reg=0.00184 | L2-Norm=13.581 | L2-Norm(final)=2.970 | acc=1.0000 | 1516.7 samples/s | 23.7 steps/s
[Step=10700 Epoch=101.4] | Loss=0.00081 | Reg=0.00184 | L2-Norm=13.575 | L2-Norm(final)=2.971 | acc=1.0000 | 4702.7 samples/s | 73.5 steps/s
[Step=10750 Epoch=101.9] | Loss=0.00069 | Reg=0.00184 | L2-Norm=13.567 | L2-Norm(final)=2.972 | acc=1.0000 | 1701.0 samples/s | 26.6 steps/s
[Step=10800 Epoch=102.3] | Loss=0.00061 | Reg=0.00184 | L2-Norm=13.560 | L2-Norm(final)=2.973 | acc=1.0000 | 4370.9 samples/s | 68.3 steps/s
[Step=10850 Epoch=102.8] | Loss=0.00054 | Reg=0.00184 | L2-Norm=13.552 | L2-Norm(final)=2.974 | acc=1.0000 | 1577.4 samples/s | 24.6 steps/s
[Step=10900 Epoch=103.3] | Loss=0.00049 | Reg=0.00183 | L2-Norm=13.543 | L2-Norm(final)=2.975 | acc=1.0000 | 4317.4 samples/s | 67.5 steps/s
[Step=10950 Epoch=103.8] | Loss=0.00044 | Reg=0.00183 | L2-Norm=13.535 | L2-Norm(final)=2.975 | acc=1.0000 | 1567.2 samples/s | 24.5 steps/s
[Step=11000 Epoch=104.2] | Loss=0.00041 | Reg=0.00183 | L2-Norm=13.526 | L2-Norm(final)=2.976 | acc=1.0000 | 4251.0 samples/s | 66.4 steps/s
[Step=11050 Epoch=104.7] | Loss=0.00038 | Reg=0.00183 | L2-Norm=13.517 | L2-Norm(final)=2.976 | acc=1.0000 | 1563.4 samples/s | 24.4 steps/s
[Step=11100 Epoch=105.2] | Loss=0.00035 | Reg=0.00182 | L2-Norm=13.508 | L2-Norm(final)=2.977 | acc=1.0000 | 3743.4 samples/s | 58.5 steps/s
[Step=11150 Epoch=105.7] | Loss=0.00033 | Reg=0.00182 | L2-Norm=13.499 | L2-Norm(final)=2.978 | acc=1.0000 | 1592.6 samples/s | 24.9 steps/s
[Step=11200 Epoch=106.1] | Loss=0.00031 | Reg=0.00182 | L2-Norm=13.489 | L2-Norm(final)=2.978 | acc=1.0000 | 4217.2 samples/s | 65.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step11200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00025, len=1
[Step=11201 Epoch=106.8] | Loss=0.05576 | Reg=0.00182 | L2-Norm=13.499 | L2-Norm(final)=2.959 | acc=0.9219 | 3835.6 samples/s | 59.9 steps/s
[Step=11250 Epoch=107.2] | Loss=0.00388 | Reg=0.00184 | L2-Norm=13.562 | L2-Norm(final)=2.960 | acc=1.0000 | 3967.9 samples/s | 62.0 steps/s
[Step=11300 Epoch=107.7] | Loss=0.00212 | Reg=0.00184 | L2-Norm=13.579 | L2-Norm(final)=2.961 | acc=1.0000 | 5167.3 samples/s | 80.7 steps/s
[Step=11350 Epoch=108.2] | Loss=0.00143 | Reg=0.00184 | L2-Norm=13.581 | L2-Norm(final)=2.963 | acc=1.0000 | 1643.1 samples/s | 25.7 steps/s
[Step=11400 Epoch=108.7] | Loss=0.00107 | Reg=0.00184 | L2-Norm=13.577 | L2-Norm(final)=2.964 | acc=1.0000 | 4797.0 samples/s | 75.0 steps/s
[Step=11450 Epoch=109.1] | Loss=0.00086 | Reg=0.00184 | L2-Norm=13.572 | L2-Norm(final)=2.965 | acc=1.0000 | 1515.1 samples/s | 23.7 steps/s
[Step=11500 Epoch=109.6] | Loss=0.00072 | Reg=0.00184 | L2-Norm=13.565 | L2-Norm(final)=2.966 | acc=1.0000 | 4679.1 samples/s | 73.1 steps/s
[Step=11550 Epoch=110.1] | Loss=0.00062 | Reg=0.00184 | L2-Norm=13.557 | L2-Norm(final)=2.967 | acc=1.0000 | 1553.5 samples/s | 24.3 steps/s
[Step=11600 Epoch=110.6] | Loss=0.00054 | Reg=0.00184 | L2-Norm=13.550 | L2-Norm(final)=2.968 | acc=1.0000 | 4652.3 samples/s | 72.7 steps/s
[Step=11650 Epoch=111.0] | Loss=0.00048 | Reg=0.00183 | L2-Norm=13.542 | L2-Norm(final)=2.969 | acc=1.0000 | 1556.2 samples/s | 24.3 steps/s
[Step=11700 Epoch=111.5] | Loss=0.00044 | Reg=0.00183 | L2-Norm=13.533 | L2-Norm(final)=2.969 | acc=1.0000 | 4453.5 samples/s | 69.6 steps/s
[Step=11750 Epoch=112.0] | Loss=0.00040 | Reg=0.00183 | L2-Norm=13.525 | L2-Norm(final)=2.970 | acc=1.0000 | 1528.2 samples/s | 23.9 steps/s
[Step=11800 Epoch=112.5] | Loss=0.00037 | Reg=0.00183 | L2-Norm=13.516 | L2-Norm(final)=2.970 | acc=1.0000 | 3804.3 samples/s | 59.4 steps/s
[Step=11850 Epoch=112.9] | Loss=0.00034 | Reg=0.00182 | L2-Norm=13.507 | L2-Norm(final)=2.971 | acc=1.0000 | 1576.5 samples/s | 24.6 steps/s
[Step=11900 Epoch=113.4] | Loss=0.00032 | Reg=0.00182 | L2-Norm=13.498 | L2-Norm(final)=2.972 | acc=1.0000 | 4346.2 samples/s | 67.9 steps/s
[Step=11950 Epoch=113.9] | Loss=0.00029 | Reg=0.00182 | L2-Norm=13.488 | L2-Norm(final)=2.972 | acc=1.0000 | 1555.0 samples/s | 24.3 steps/s
[Step=12000 Epoch=114.4] | Loss=0.00028 | Reg=0.00182 | L2-Norm=13.479 | L2-Norm(final)=2.973 | acc=1.0000 | 4306.8 samples/s | 67.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40327 | acc=0.7715 | tpr=0.6697 | fpr=0.0074 | 4327.4 samples/s | 16.9 steps/s
Avg test loss: 0.40758, Avg test acc: 0.77069, Avg tpr: 0.67034, Avg fpr: 0.00859, total FA: 67

Testing server on iccad2012
[Step=  50] | Loss=0.38136 | acc=0.8831 | tpr=0.9646 | fpr=0.1183 | 4340.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.38768 | acc=0.8816 | tpr=0.9680 | fpr=0.1200 | 8676.8 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.39457 | acc=0.8807 | tpr=0.9712 | fpr=0.1210 | 9186.8 samples/s | 35.9 steps/s
[Step= 200] | Loss=0.39822 | acc=0.8798 | tpr=0.9738 | fpr=0.1219 | 8423.6 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.39693 | acc=0.8796 | tpr=0.9721 | fpr=0.1221 | 8637.2 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.40154 | acc=0.8784 | tpr=0.9724 | fpr=0.1233 | 8928.0 samples/s | 34.9 steps/s
[Step= 350] | Loss=0.40250 | acc=0.8780 | tpr=0.9718 | fpr=0.1237 | 8934.1 samples/s | 34.9 steps/s
[Step= 400] | Loss=0.40427 | acc=0.8785 | tpr=0.9721 | fpr=0.1232 | 8379.3 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.40900 | acc=0.8780 | tpr=0.9713 | fpr=0.1237 | 9307.1 samples/s | 36.4 steps/s
[Step= 500] | Loss=0.40808 | acc=0.8777 | tpr=0.9727 | fpr=0.1240 | 8390.0 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.40721 | acc=0.8776 | tpr=0.9721 | fpr=0.1241 | 15570.4 samples/s | 60.8 steps/s
Avg test loss: 0.40704, Avg test acc: 0.87765, Avg tpr: 0.97147, Avg fpr: 0.12406, total FA: 17225

server round 26/50

clients selected: [0 2 5 6 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=12001 Epoch=58.5] | Loss=0.20896 | Reg=0.00181 | L2-Norm=13.469 | L2-Norm(final)=2.984 | acc=0.8281 | 3760.1 samples/s | 58.8 steps/s
[Step=12050 Epoch=58.8] | Loss=0.04696 | Reg=0.00182 | L2-Norm=13.508 | L2-Norm(final)=2.965 | acc=0.9844 | 4393.3 samples/s | 68.6 steps/s
[Step=12100 Epoch=59.0] | Loss=0.03363 | Reg=0.00183 | L2-Norm=13.524 | L2-Norm(final)=2.965 | acc=1.0000 | 4346.5 samples/s | 67.9 steps/s
[Step=12150 Epoch=59.2] | Loss=0.02832 | Reg=0.00183 | L2-Norm=13.534 | L2-Norm(final)=2.968 | acc=1.0000 | 4410.4 samples/s | 68.9 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02542 | Reg=0.00183 | L2-Norm=13.542 | L2-Norm(final)=2.971 | acc=1.0000 | 5176.8 samples/s | 80.9 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02276 | Reg=0.00184 | L2-Norm=13.549 | L2-Norm(final)=2.975 | acc=1.0000 | 1539.3 samples/s | 24.1 steps/s
[Step=12300 Epoch=60.0] | Loss=0.02025 | Reg=0.00184 | L2-Norm=13.556 | L2-Norm(final)=2.979 | acc=1.0000 | 4372.8 samples/s | 68.3 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01869 | Reg=0.00184 | L2-Norm=13.562 | L2-Norm(final)=2.984 | acc=1.0000 | 4376.3 samples/s | 68.4 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01756 | Reg=0.00184 | L2-Norm=13.567 | L2-Norm(final)=2.988 | acc=0.9844 | 5056.1 samples/s | 79.0 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01636 | Reg=0.00184 | L2-Norm=13.572 | L2-Norm(final)=2.993 | acc=1.0000 | 1562.0 samples/s | 24.4 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01542 | Reg=0.00184 | L2-Norm=13.577 | L2-Norm(final)=2.997 | acc=1.0000 | 4433.3 samples/s | 69.3 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01466 | Reg=0.00184 | L2-Norm=13.581 | L2-Norm(final)=3.001 | acc=1.0000 | 4399.7 samples/s | 68.7 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01394 | Reg=0.00185 | L2-Norm=13.585 | L2-Norm(final)=3.005 | acc=1.0000 | 4922.1 samples/s | 76.9 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01328 | Reg=0.00185 | L2-Norm=13.588 | L2-Norm(final)=3.009 | acc=1.0000 | 1533.8 samples/s | 24.0 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01266 | Reg=0.00185 | L2-Norm=13.591 | L2-Norm(final)=3.013 | acc=1.0000 | 3842.3 samples/s | 60.0 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01229 | Reg=0.00185 | L2-Norm=13.594 | L2-Norm(final)=3.016 | acc=1.0000 | 3880.6 samples/s | 60.6 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01203 | Reg=0.00185 | L2-Norm=13.597 | L2-Norm(final)=3.020 | acc=1.0000 | 4192.0 samples/s | 65.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12800.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00025, len=1
[Step=10401 Epoch=50.7] | Loss=0.30092 | Reg=0.00181 | L2-Norm=13.469 | L2-Norm(final)=2.983 | acc=0.7969 | 3334.6 samples/s | 52.1 steps/s
[Step=10450 Epoch=50.9] | Loss=0.04410 | Reg=0.00182 | L2-Norm=13.502 | L2-Norm(final)=2.968 | acc=1.0000 | 4365.3 samples/s | 68.2 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03408 | Reg=0.00183 | L2-Norm=13.514 | L2-Norm(final)=2.962 | acc=1.0000 | 4437.4 samples/s | 69.3 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02937 | Reg=0.00183 | L2-Norm=13.523 | L2-Norm(final)=2.962 | acc=0.9844 | 4401.9 samples/s | 68.8 steps/s
[Step=10600 Epoch=51.6] | Loss=0.02650 | Reg=0.00183 | L2-Norm=13.530 | L2-Norm(final)=2.964 | acc=1.0000 | 5143.4 samples/s | 80.4 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02254 | Reg=0.00183 | L2-Norm=13.538 | L2-Norm(final)=2.968 | acc=1.0000 | 1568.6 samples/s | 24.5 steps/s
[Step=10700 Epoch=52.1] | Loss=0.02014 | Reg=0.00183 | L2-Norm=13.545 | L2-Norm(final)=2.974 | acc=0.9844 | 4372.0 samples/s | 68.3 steps/s
[Step=10750 Epoch=52.4] | Loss=0.01870 | Reg=0.00184 | L2-Norm=13.551 | L2-Norm(final)=2.980 | acc=1.0000 | 4407.0 samples/s | 68.9 steps/s
[Step=10800 Epoch=52.6] | Loss=0.01768 | Reg=0.00184 | L2-Norm=13.557 | L2-Norm(final)=2.984 | acc=1.0000 | 4968.7 samples/s | 77.6 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01663 | Reg=0.00184 | L2-Norm=13.562 | L2-Norm(final)=2.989 | acc=0.9688 | 1516.5 samples/s | 23.7 steps/s
[Step=10900 Epoch=53.1] | Loss=0.01536 | Reg=0.00184 | L2-Norm=13.567 | L2-Norm(final)=2.993 | acc=1.0000 | 3865.0 samples/s | 60.4 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01459 | Reg=0.00184 | L2-Norm=13.572 | L2-Norm(final)=2.998 | acc=1.0000 | 3897.8 samples/s | 60.9 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01397 | Reg=0.00184 | L2-Norm=13.576 | L2-Norm(final)=3.003 | acc=0.9844 | 4317.3 samples/s | 67.5 steps/s
[Step=11050 Epoch=53.8] | Loss=0.01321 | Reg=0.00184 | L2-Norm=13.580 | L2-Norm(final)=3.007 | acc=1.0000 | 1572.3 samples/s | 24.6 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01256 | Reg=0.00185 | L2-Norm=13.584 | L2-Norm(final)=3.012 | acc=1.0000 | 4410.2 samples/s | 68.9 steps/s
[Step=11150 Epoch=54.3] | Loss=0.01217 | Reg=0.00185 | L2-Norm=13.588 | L2-Norm(final)=3.016 | acc=0.9844 | 4088.9 samples/s | 63.9 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01174 | Reg=0.00185 | L2-Norm=13.592 | L2-Norm(final)=3.020 | acc=1.0000 | 4120.8 samples/s | 64.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step11200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=11201 Epoch=106.1] | Loss=0.02092 | Reg=0.00181 | L2-Norm=13.469 | L2-Norm(final)=2.984 | acc=0.9844 | 3285.5 samples/s | 51.3 steps/s
[Step=11250 Epoch=106.6] | Loss=0.00284 | Reg=0.00183 | L2-Norm=13.522 | L2-Norm(final)=2.988 | acc=1.0000 | 4010.4 samples/s | 62.7 steps/s
[Step=11300 Epoch=107.1] | Loss=0.00241 | Reg=0.00183 | L2-Norm=13.534 | L2-Norm(final)=2.991 | acc=1.0000 | 5095.5 samples/s | 79.6 steps/s
[Step=11350 Epoch=107.6] | Loss=0.00166 | Reg=0.00183 | L2-Norm=13.535 | L2-Norm(final)=2.992 | acc=1.0000 | 1521.1 samples/s | 23.8 steps/s
[Step=11400 Epoch=108.0] | Loss=0.00125 | Reg=0.00183 | L2-Norm=13.532 | L2-Norm(final)=2.992 | acc=1.0000 | 4830.2 samples/s | 75.5 steps/s
[Step=11450 Epoch=108.5] | Loss=0.00101 | Reg=0.00183 | L2-Norm=13.526 | L2-Norm(final)=2.993 | acc=1.0000 | 1519.9 samples/s | 23.7 steps/s
[Step=11500 Epoch=109.0] | Loss=0.00084 | Reg=0.00183 | L2-Norm=13.519 | L2-Norm(final)=2.993 | acc=1.0000 | 4686.6 samples/s | 73.2 steps/s
[Step=11550 Epoch=109.4] | Loss=0.00072 | Reg=0.00183 | L2-Norm=13.512 | L2-Norm(final)=2.994 | acc=1.0000 | 1546.9 samples/s | 24.2 steps/s
[Step=11600 Epoch=109.9] | Loss=0.00063 | Reg=0.00182 | L2-Norm=13.503 | L2-Norm(final)=2.995 | acc=1.0000 | 4436.2 samples/s | 69.3 steps/s
[Step=11650 Epoch=110.4] | Loss=0.00056 | Reg=0.00182 | L2-Norm=13.495 | L2-Norm(final)=2.995 | acc=1.0000 | 1566.1 samples/s | 24.5 steps/s
[Step=11700 Epoch=110.9] | Loss=0.00051 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=2.996 | acc=1.0000 | 4478.0 samples/s | 70.0 steps/s
[Step=11750 Epoch=111.3] | Loss=0.00046 | Reg=0.00182 | L2-Norm=13.477 | L2-Norm(final)=2.996 | acc=1.0000 | 1537.5 samples/s | 24.0 steps/s
[Step=11800 Epoch=111.8] | Loss=0.00042 | Reg=0.00181 | L2-Norm=13.468 | L2-Norm(final)=2.997 | acc=1.0000 | 3774.3 samples/s | 59.0 steps/s
[Step=11850 Epoch=112.3] | Loss=0.00039 | Reg=0.00181 | L2-Norm=13.458 | L2-Norm(final)=2.997 | acc=1.0000 | 1578.6 samples/s | 24.7 steps/s
[Step=11900 Epoch=112.8] | Loss=0.00036 | Reg=0.00181 | L2-Norm=13.448 | L2-Norm(final)=2.998 | acc=1.0000 | 4348.1 samples/s | 67.9 steps/s
[Step=11950 Epoch=113.2] | Loss=0.00034 | Reg=0.00181 | L2-Norm=13.439 | L2-Norm(final)=2.998 | acc=1.0000 | 1598.8 samples/s | 25.0 steps/s
[Step=12000 Epoch=113.7] | Loss=0.00032 | Reg=0.00180 | L2-Norm=13.429 | L2-Norm(final)=2.999 | acc=1.0000 | 4186.5 samples/s | 65.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=10401 Epoch=98.9] | Loss=0.06497 | Reg=0.00181 | L2-Norm=13.469 | L2-Norm(final)=2.983 | acc=0.9844 | 3933.5 samples/s | 61.5 steps/s
[Step=10450 Epoch=99.4] | Loss=0.01229 | Reg=0.00183 | L2-Norm=13.527 | L2-Norm(final)=2.965 | acc=1.0000 | 4006.0 samples/s | 62.6 steps/s
[Step=10500 Epoch=99.9] | Loss=0.00663 | Reg=0.00184 | L2-Norm=13.556 | L2-Norm(final)=2.957 | acc=1.0000 | 5031.4 samples/s | 78.6 steps/s
[Step=10550 Epoch=100.4] | Loss=0.00453 | Reg=0.00184 | L2-Norm=13.566 | L2-Norm(final)=2.958 | acc=1.0000 | 1483.5 samples/s | 23.2 steps/s
[Step=10600 Epoch=100.8] | Loss=0.00341 | Reg=0.00184 | L2-Norm=13.569 | L2-Norm(final)=2.959 | acc=1.0000 | 4874.8 samples/s | 76.2 steps/s
[Step=10650 Epoch=101.3] | Loss=0.00273 | Reg=0.00184 | L2-Norm=13.568 | L2-Norm(final)=2.960 | acc=1.0000 | 1523.6 samples/s | 23.8 steps/s
[Step=10700 Epoch=101.8] | Loss=0.00228 | Reg=0.00184 | L2-Norm=13.564 | L2-Norm(final)=2.961 | acc=1.0000 | 4632.8 samples/s | 72.4 steps/s
[Step=10750 Epoch=102.3] | Loss=0.00196 | Reg=0.00184 | L2-Norm=13.560 | L2-Norm(final)=2.962 | acc=1.0000 | 1548.7 samples/s | 24.2 steps/s
[Step=10800 Epoch=102.7] | Loss=0.00172 | Reg=0.00184 | L2-Norm=13.555 | L2-Norm(final)=2.963 | acc=1.0000 | 4443.0 samples/s | 69.4 steps/s
[Step=10850 Epoch=103.2] | Loss=0.00153 | Reg=0.00184 | L2-Norm=13.550 | L2-Norm(final)=2.964 | acc=1.0000 | 1562.5 samples/s | 24.4 steps/s
[Step=10900 Epoch=103.7] | Loss=0.00138 | Reg=0.00183 | L2-Norm=13.544 | L2-Norm(final)=2.965 | acc=1.0000 | 4317.9 samples/s | 67.5 steps/s
[Step=10950 Epoch=104.2] | Loss=0.00125 | Reg=0.00183 | L2-Norm=13.538 | L2-Norm(final)=2.966 | acc=1.0000 | 1729.2 samples/s | 27.0 steps/s
[Step=11000 Epoch=104.6] | Loss=0.00115 | Reg=0.00183 | L2-Norm=13.531 | L2-Norm(final)=2.967 | acc=1.0000 | 4298.9 samples/s | 67.2 steps/s
[Step=11050 Epoch=105.1] | Loss=0.00106 | Reg=0.00183 | L2-Norm=13.525 | L2-Norm(final)=2.968 | acc=1.0000 | 1583.3 samples/s | 24.7 steps/s
[Step=11100 Epoch=105.6] | Loss=0.00099 | Reg=0.00183 | L2-Norm=13.518 | L2-Norm(final)=2.968 | acc=1.0000 | 4322.7 samples/s | 67.5 steps/s
[Step=11150 Epoch=106.1] | Loss=0.00092 | Reg=0.00183 | L2-Norm=13.511 | L2-Norm(final)=2.969 | acc=1.0000 | 1583.4 samples/s | 24.7 steps/s
[Step=11200 Epoch=106.5] | Loss=0.00087 | Reg=0.00182 | L2-Norm=13.504 | L2-Norm(final)=2.970 | acc=1.0000 | 3672.0 samples/s | 57.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step11200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00025, len=1
[Step=12001 Epoch=114.4] | Loss=0.02424 | Reg=0.00181 | L2-Norm=13.469 | L2-Norm(final)=2.984 | acc=0.9844 | 3427.3 samples/s | 53.6 steps/s
[Step=12050 Epoch=114.8] | Loss=0.00381 | Reg=0.00183 | L2-Norm=13.520 | L2-Norm(final)=2.989 | acc=1.0000 | 3839.0 samples/s | 60.0 steps/s
[Step=12100 Epoch=115.3] | Loss=0.00207 | Reg=0.00183 | L2-Norm=13.534 | L2-Norm(final)=2.991 | acc=1.0000 | 5057.6 samples/s | 79.0 steps/s
[Step=12150 Epoch=115.8] | Loss=0.00140 | Reg=0.00183 | L2-Norm=13.535 | L2-Norm(final)=2.995 | acc=1.0000 | 1493.1 samples/s | 23.3 steps/s
[Step=12200 Epoch=116.3] | Loss=0.00106 | Reg=0.00183 | L2-Norm=13.532 | L2-Norm(final)=2.997 | acc=1.0000 | 4943.1 samples/s | 77.2 steps/s
[Step=12250 Epoch=116.8] | Loss=0.00085 | Reg=0.00183 | L2-Norm=13.526 | L2-Norm(final)=2.999 | acc=1.0000 | 1505.3 samples/s | 23.5 steps/s
[Step=12300 Epoch=117.2] | Loss=0.00071 | Reg=0.00183 | L2-Norm=13.519 | L2-Norm(final)=3.000 | acc=1.0000 | 4717.2 samples/s | 73.7 steps/s
[Step=12350 Epoch=117.7] | Loss=0.00061 | Reg=0.00183 | L2-Norm=13.511 | L2-Norm(final)=3.002 | acc=1.0000 | 1528.5 samples/s | 23.9 steps/s
[Step=12400 Epoch=118.2] | Loss=0.00054 | Reg=0.00182 | L2-Norm=13.503 | L2-Norm(final)=3.003 | acc=1.0000 | 4476.1 samples/s | 69.9 steps/s
[Step=12450 Epoch=118.7] | Loss=0.00048 | Reg=0.00182 | L2-Norm=13.494 | L2-Norm(final)=3.004 | acc=1.0000 | 1507.4 samples/s | 23.6 steps/s
[Step=12500 Epoch=119.1] | Loss=0.00043 | Reg=0.00182 | L2-Norm=13.485 | L2-Norm(final)=3.005 | acc=1.0000 | 3984.7 samples/s | 62.3 steps/s
[Step=12550 Epoch=119.6] | Loss=0.00039 | Reg=0.00182 | L2-Norm=13.476 | L2-Norm(final)=3.006 | acc=1.0000 | 1522.1 samples/s | 23.8 steps/s
[Step=12600 Epoch=120.1] | Loss=0.00036 | Reg=0.00181 | L2-Norm=13.467 | L2-Norm(final)=3.006 | acc=1.0000 | 3805.3 samples/s | 59.5 steps/s
[Step=12650 Epoch=120.6] | Loss=0.00033 | Reg=0.00181 | L2-Norm=13.457 | L2-Norm(final)=3.007 | acc=1.0000 | 1575.8 samples/s | 24.6 steps/s
[Step=12700 Epoch=121.0] | Loss=0.00031 | Reg=0.00181 | L2-Norm=13.447 | L2-Norm(final)=3.008 | acc=1.0000 | 4269.0 samples/s | 66.7 steps/s
[Step=12750 Epoch=121.5] | Loss=0.00029 | Reg=0.00181 | L2-Norm=13.438 | L2-Norm(final)=3.009 | acc=1.0000 | 1574.6 samples/s | 24.6 steps/s
[Step=12800 Epoch=122.0] | Loss=0.00027 | Reg=0.00180 | L2-Norm=13.428 | L2-Norm(final)=3.010 | acc=1.0000 | 4374.3 samples/s | 68.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41277 | acc=0.7626 | tpr=0.6569 | fpr=0.0079 | 4370.2 samples/s | 17.1 steps/s
Avg test loss: 0.41619, Avg test acc: 0.76356, Avg tpr: 0.65991, Avg fpr: 0.00846, total FA: 66

Testing server on iccad2012
[Step=  50] | Loss=0.36971 | acc=0.8855 | tpr=0.9646 | fpr=0.1160 | 4305.6 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.37591 | acc=0.8839 | tpr=0.9680 | fpr=0.1176 | 8815.8 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.38254 | acc=0.8831 | tpr=0.9712 | fpr=0.1185 | 8902.8 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.38621 | acc=0.8827 | tpr=0.9727 | fpr=0.1189 | 8796.2 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.38489 | acc=0.8827 | tpr=0.9712 | fpr=0.1189 | 8610.5 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.38948 | acc=0.8816 | tpr=0.9716 | fpr=0.1200 | 8635.2 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.39033 | acc=0.8814 | tpr=0.9718 | fpr=0.1203 | 8695.1 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.39205 | acc=0.8818 | tpr=0.9716 | fpr=0.1199 | 8624.1 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.39685 | acc=0.8813 | tpr=0.9708 | fpr=0.1203 | 8743.8 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.39603 | acc=0.8810 | tpr=0.9714 | fpr=0.1206 | 8728.0 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.39524 | acc=0.8811 | tpr=0.9698 | fpr=0.1205 | 15770.5 samples/s | 61.6 steps/s
Avg test loss: 0.39506, Avg test acc: 0.88109, Avg tpr: 0.96910, Avg fpr: 0.12051, total FA: 16733

server round 27/50

clients selected: [0 3 5 6 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=12801 Epoch=62.4] | Loss=0.22377 | Reg=0.00181 | L2-Norm=13.446 | L2-Norm(final)=2.997 | acc=0.8281 | 3845.2 samples/s | 60.1 steps/s
[Step=12850 Epoch=62.7] | Loss=0.04833 | Reg=0.00182 | L2-Norm=13.484 | L2-Norm(final)=2.978 | acc=0.9844 | 4493.0 samples/s | 70.2 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03363 | Reg=0.00182 | L2-Norm=13.496 | L2-Norm(final)=2.973 | acc=0.9688 | 4414.2 samples/s | 69.0 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02971 | Reg=0.00182 | L2-Norm=13.505 | L2-Norm(final)=2.975 | acc=1.0000 | 4475.0 samples/s | 69.9 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02626 | Reg=0.00183 | L2-Norm=13.511 | L2-Norm(final)=2.978 | acc=0.9844 | 5231.4 samples/s | 81.7 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02225 | Reg=0.00183 | L2-Norm=13.517 | L2-Norm(final)=2.982 | acc=1.0000 | 1494.5 samples/s | 23.4 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01971 | Reg=0.00183 | L2-Norm=13.523 | L2-Norm(final)=2.988 | acc=0.9844 | 4361.6 samples/s | 68.2 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01826 | Reg=0.00183 | L2-Norm=13.528 | L2-Norm(final)=2.993 | acc=0.9844 | 4366.8 samples/s | 68.2 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01727 | Reg=0.00183 | L2-Norm=13.533 | L2-Norm(final)=2.998 | acc=1.0000 | 5018.0 samples/s | 78.4 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01687 | Reg=0.00183 | L2-Norm=13.538 | L2-Norm(final)=3.002 | acc=0.9688 | 1499.2 samples/s | 23.4 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01630 | Reg=0.00183 | L2-Norm=13.543 | L2-Norm(final)=3.006 | acc=1.0000 | 3916.0 samples/s | 61.2 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01539 | Reg=0.00184 | L2-Norm=13.549 | L2-Norm(final)=3.010 | acc=1.0000 | 3825.2 samples/s | 59.8 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01464 | Reg=0.00184 | L2-Norm=13.554 | L2-Norm(final)=3.015 | acc=1.0000 | 4327.9 samples/s | 67.6 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01397 | Reg=0.00184 | L2-Norm=13.559 | L2-Norm(final)=3.019 | acc=1.0000 | 1590.7 samples/s | 24.9 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01345 | Reg=0.00184 | L2-Norm=13.564 | L2-Norm(final)=3.024 | acc=1.0000 | 4387.7 samples/s | 68.6 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01291 | Reg=0.00184 | L2-Norm=13.568 | L2-Norm(final)=3.028 | acc=1.0000 | 4458.2 samples/s | 69.7 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01242 | Reg=0.00184 | L2-Norm=13.572 | L2-Norm(final)=3.033 | acc=1.0000 | 4606.6 samples/s | 72.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step13600.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00025, len=1
[Step=9601 Epoch=46.8] | Loss=0.23093 | Reg=0.00181 | L2-Norm=13.446 | L2-Norm(final)=2.997 | acc=0.8438 | 3310.5 samples/s | 51.7 steps/s
[Step=9650 Epoch=47.1] | Loss=0.05080 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=2.975 | acc=1.0000 | 4442.3 samples/s | 69.4 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03758 | Reg=0.00182 | L2-Norm=13.502 | L2-Norm(final)=2.974 | acc=1.0000 | 4391.4 samples/s | 68.6 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03078 | Reg=0.00183 | L2-Norm=13.511 | L2-Norm(final)=2.976 | acc=1.0000 | 4477.0 samples/s | 70.0 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02637 | Reg=0.00183 | L2-Norm=13.520 | L2-Norm(final)=2.980 | acc=0.9844 | 5278.7 samples/s | 82.5 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02236 | Reg=0.00183 | L2-Norm=13.529 | L2-Norm(final)=2.985 | acc=1.0000 | 1537.9 samples/s | 24.0 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02060 | Reg=0.00183 | L2-Norm=13.536 | L2-Norm(final)=2.990 | acc=0.9688 | 4541.2 samples/s | 71.0 steps/s
[Step=9950 Epoch=48.5] | Loss=0.01850 | Reg=0.00183 | L2-Norm=13.542 | L2-Norm(final)=2.995 | acc=1.0000 | 4496.6 samples/s | 70.3 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01740 | Reg=0.00184 | L2-Norm=13.547 | L2-Norm(final)=3.000 | acc=0.9844 | 4918.2 samples/s | 76.8 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01621 | Reg=0.00184 | L2-Norm=13.552 | L2-Norm(final)=3.005 | acc=1.0000 | 1555.1 samples/s | 24.3 steps/s
[Step=10100 Epoch=49.3] | Loss=0.01522 | Reg=0.00184 | L2-Norm=13.558 | L2-Norm(final)=3.010 | acc=1.0000 | 4320.0 samples/s | 67.5 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01453 | Reg=0.00184 | L2-Norm=13.562 | L2-Norm(final)=3.015 | acc=1.0000 | 4404.5 samples/s | 68.8 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01379 | Reg=0.00184 | L2-Norm=13.567 | L2-Norm(final)=3.019 | acc=1.0000 | 4726.9 samples/s | 73.9 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01307 | Reg=0.00184 | L2-Norm=13.571 | L2-Norm(final)=3.024 | acc=1.0000 | 1578.5 samples/s | 24.7 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01247 | Reg=0.00184 | L2-Norm=13.575 | L2-Norm(final)=3.028 | acc=1.0000 | 4403.7 samples/s | 68.8 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01216 | Reg=0.00184 | L2-Norm=13.579 | L2-Norm(final)=3.032 | acc=1.0000 | 4348.3 samples/s | 67.9 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01172 | Reg=0.00184 | L2-Norm=13.582 | L2-Norm(final)=3.036 | acc=1.0000 | 4668.6 samples/s | 72.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step10400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=12001 Epoch=113.7] | Loss=0.07097 | Reg=0.00181 | L2-Norm=13.446 | L2-Norm(final)=2.997 | acc=0.9688 | 3879.9 samples/s | 60.6 steps/s
[Step=12050 Epoch=114.2] | Loss=0.00253 | Reg=0.00182 | L2-Norm=13.485 | L2-Norm(final)=2.999 | acc=1.0000 | 3908.0 samples/s | 61.1 steps/s
[Step=12100 Epoch=114.7] | Loss=0.00164 | Reg=0.00182 | L2-Norm=13.489 | L2-Norm(final)=3.004 | acc=0.9844 | 5070.1 samples/s | 79.2 steps/s
[Step=12150 Epoch=115.1] | Loss=0.00115 | Reg=0.00182 | L2-Norm=13.488 | L2-Norm(final)=3.008 | acc=1.0000 | 1497.9 samples/s | 23.4 steps/s
[Step=12200 Epoch=115.6] | Loss=0.00087 | Reg=0.00182 | L2-Norm=13.485 | L2-Norm(final)=3.012 | acc=1.0000 | 4806.5 samples/s | 75.1 steps/s
[Step=12250 Epoch=116.1] | Loss=0.00071 | Reg=0.00182 | L2-Norm=13.480 | L2-Norm(final)=3.015 | acc=1.0000 | 1471.2 samples/s | 23.0 steps/s
[Step=12300 Epoch=116.6] | Loss=0.00060 | Reg=0.00182 | L2-Norm=13.473 | L2-Norm(final)=3.017 | acc=1.0000 | 4170.3 samples/s | 65.2 steps/s
[Step=12350 Epoch=117.0] | Loss=0.00051 | Reg=0.00181 | L2-Norm=13.465 | L2-Norm(final)=3.019 | acc=1.0000 | 1532.8 samples/s | 23.9 steps/s
[Step=12400 Epoch=117.5] | Loss=0.00045 | Reg=0.00181 | L2-Norm=13.457 | L2-Norm(final)=3.021 | acc=1.0000 | 4394.0 samples/s | 68.7 steps/s
[Step=12450 Epoch=118.0] | Loss=0.00040 | Reg=0.00181 | L2-Norm=13.448 | L2-Norm(final)=3.023 | acc=1.0000 | 1566.7 samples/s | 24.5 steps/s
[Step=12500 Epoch=118.4] | Loss=0.00036 | Reg=0.00181 | L2-Norm=13.438 | L2-Norm(final)=3.024 | acc=1.0000 | 4328.0 samples/s | 67.6 steps/s
[Step=12550 Epoch=118.9] | Loss=0.00033 | Reg=0.00180 | L2-Norm=13.428 | L2-Norm(final)=3.025 | acc=1.0000 | 1571.0 samples/s | 24.5 steps/s
[Step=12600 Epoch=119.4] | Loss=0.00030 | Reg=0.00180 | L2-Norm=13.418 | L2-Norm(final)=3.026 | acc=1.0000 | 4247.7 samples/s | 66.4 steps/s
[Step=12650 Epoch=119.9] | Loss=0.00028 | Reg=0.00180 | L2-Norm=13.408 | L2-Norm(final)=3.027 | acc=1.0000 | 1586.7 samples/s | 24.8 steps/s
[Step=12700 Epoch=120.3] | Loss=0.00026 | Reg=0.00179 | L2-Norm=13.397 | L2-Norm(final)=3.028 | acc=1.0000 | 4245.8 samples/s | 66.3 steps/s
[Step=12750 Epoch=120.8] | Loss=0.00024 | Reg=0.00179 | L2-Norm=13.387 | L2-Norm(final)=3.029 | acc=1.0000 | 1589.0 samples/s | 24.8 steps/s
[Step=12800 Epoch=121.3] | Loss=0.00023 | Reg=0.00179 | L2-Norm=13.376 | L2-Norm(final)=3.030 | acc=1.0000 | 4227.2 samples/s | 66.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=11201 Epoch=106.5] | Loss=0.04505 | Reg=0.00181 | L2-Norm=13.446 | L2-Norm(final)=2.997 | acc=0.9844 | 3926.7 samples/s | 61.4 steps/s
[Step=11250 Epoch=107.0] | Loss=0.00408 | Reg=0.00182 | L2-Norm=13.502 | L2-Norm(final)=2.996 | acc=1.0000 | 3999.7 samples/s | 62.5 steps/s
[Step=11300 Epoch=107.5] | Loss=0.00221 | Reg=0.00183 | L2-Norm=13.516 | L2-Norm(final)=3.000 | acc=1.0000 | 5181.9 samples/s | 81.0 steps/s
[Step=11350 Epoch=108.0] | Loss=0.00149 | Reg=0.00183 | L2-Norm=13.518 | L2-Norm(final)=3.003 | acc=1.0000 | 1500.3 samples/s | 23.4 steps/s
[Step=11400 Epoch=108.4] | Loss=0.00112 | Reg=0.00183 | L2-Norm=13.515 | L2-Norm(final)=3.005 | acc=1.0000 | 4809.4 samples/s | 75.1 steps/s
[Step=11450 Epoch=108.9] | Loss=0.00090 | Reg=0.00183 | L2-Norm=13.509 | L2-Norm(final)=3.007 | acc=1.0000 | 1507.5 samples/s | 23.6 steps/s
[Step=11500 Epoch=109.4] | Loss=0.00075 | Reg=0.00182 | L2-Norm=13.503 | L2-Norm(final)=3.008 | acc=1.0000 | 4625.8 samples/s | 72.3 steps/s
[Step=11550 Epoch=109.9] | Loss=0.00065 | Reg=0.00182 | L2-Norm=13.497 | L2-Norm(final)=3.009 | acc=1.0000 | 1556.8 samples/s | 24.3 steps/s
[Step=11600 Epoch=110.3] | Loss=0.00057 | Reg=0.00182 | L2-Norm=13.490 | L2-Norm(final)=3.010 | acc=1.0000 | 4500.2 samples/s | 70.3 steps/s
[Step=11650 Epoch=110.8] | Loss=0.00051 | Reg=0.00182 | L2-Norm=13.482 | L2-Norm(final)=3.011 | acc=1.0000 | 1545.9 samples/s | 24.2 steps/s
[Step=11700 Epoch=111.3] | Loss=0.00046 | Reg=0.00182 | L2-Norm=13.475 | L2-Norm(final)=3.012 | acc=1.0000 | 4292.4 samples/s | 67.1 steps/s
[Step=11750 Epoch=111.8] | Loss=0.00042 | Reg=0.00181 | L2-Norm=13.467 | L2-Norm(final)=3.012 | acc=1.0000 | 1571.9 samples/s | 24.6 steps/s
[Step=11800 Epoch=112.2] | Loss=0.00038 | Reg=0.00181 | L2-Norm=13.459 | L2-Norm(final)=3.013 | acc=1.0000 | 4292.9 samples/s | 67.1 steps/s
[Step=11850 Epoch=112.7] | Loss=0.00035 | Reg=0.00181 | L2-Norm=13.451 | L2-Norm(final)=3.014 | acc=1.0000 | 1577.3 samples/s | 24.6 steps/s
[Step=11900 Epoch=113.2] | Loss=0.00033 | Reg=0.00181 | L2-Norm=13.442 | L2-Norm(final)=3.015 | acc=1.0000 | 4236.1 samples/s | 66.2 steps/s
[Step=11950 Epoch=113.7] | Loss=0.00031 | Reg=0.00180 | L2-Norm=13.434 | L2-Norm(final)=3.015 | acc=1.0000 | 1606.7 samples/s | 25.1 steps/s
[Step=12000 Epoch=114.1] | Loss=0.00029 | Reg=0.00180 | L2-Norm=13.425 | L2-Norm(final)=3.016 | acc=1.0000 | 4145.6 samples/s | 64.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step12000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00025, len=1
[Step=12801 Epoch=122.0] | Loss=0.08011 | Reg=0.00181 | L2-Norm=13.446 | L2-Norm(final)=2.997 | acc=0.9531 | 3972.3 samples/s | 62.1 steps/s
[Step=12850 Epoch=122.5] | Loss=0.00525 | Reg=0.00183 | L2-Norm=13.510 | L2-Norm(final)=2.994 | acc=1.0000 | 3822.7 samples/s | 59.7 steps/s
[Step=12900 Epoch=122.9] | Loss=0.00272 | Reg=0.00183 | L2-Norm=13.534 | L2-Norm(final)=2.997 | acc=1.0000 | 5042.1 samples/s | 78.8 steps/s
[Step=12950 Epoch=123.4] | Loss=0.00186 | Reg=0.00183 | L2-Norm=13.539 | L2-Norm(final)=3.000 | acc=1.0000 | 1492.1 samples/s | 23.3 steps/s
[Step=13000 Epoch=123.9] | Loss=0.00140 | Reg=0.00183 | L2-Norm=13.537 | L2-Norm(final)=3.003 | acc=1.0000 | 4883.6 samples/s | 76.3 steps/s
[Step=13050 Epoch=124.4] | Loss=0.00112 | Reg=0.00183 | L2-Norm=13.533 | L2-Norm(final)=3.004 | acc=1.0000 | 1538.2 samples/s | 24.0 steps/s
[Step=13100 Epoch=124.9] | Loss=0.00094 | Reg=0.00183 | L2-Norm=13.526 | L2-Norm(final)=3.006 | acc=1.0000 | 4706.3 samples/s | 73.5 steps/s
[Step=13150 Epoch=125.3] | Loss=0.00081 | Reg=0.00183 | L2-Norm=13.519 | L2-Norm(final)=3.007 | acc=1.0000 | 1521.3 samples/s | 23.8 steps/s
[Step=13200 Epoch=125.8] | Loss=0.00071 | Reg=0.00183 | L2-Norm=13.512 | L2-Norm(final)=3.008 | acc=1.0000 | 4570.9 samples/s | 71.4 steps/s
[Step=13250 Epoch=126.3] | Loss=0.00063 | Reg=0.00182 | L2-Norm=13.504 | L2-Norm(final)=3.009 | acc=1.0000 | 1559.5 samples/s | 24.4 steps/s
[Step=13300 Epoch=126.8] | Loss=0.00057 | Reg=0.00182 | L2-Norm=13.495 | L2-Norm(final)=3.010 | acc=1.0000 | 4456.5 samples/s | 69.6 steps/s
[Step=13350 Epoch=127.2] | Loss=0.00052 | Reg=0.00182 | L2-Norm=13.487 | L2-Norm(final)=3.011 | acc=1.0000 | 1562.0 samples/s | 24.4 steps/s
[Step=13400 Epoch=127.7] | Loss=0.00048 | Reg=0.00182 | L2-Norm=13.478 | L2-Norm(final)=3.012 | acc=1.0000 | 4390.4 samples/s | 68.6 steps/s
[Step=13450 Epoch=128.2] | Loss=0.00044 | Reg=0.00181 | L2-Norm=13.469 | L2-Norm(final)=3.013 | acc=1.0000 | 1555.9 samples/s | 24.3 steps/s
[Step=13500 Epoch=128.7] | Loss=0.00041 | Reg=0.00181 | L2-Norm=13.460 | L2-Norm(final)=3.014 | acc=1.0000 | 4218.9 samples/s | 65.9 steps/s
[Step=13550 Epoch=129.1] | Loss=0.00038 | Reg=0.00181 | L2-Norm=13.450 | L2-Norm(final)=3.015 | acc=1.0000 | 1565.4 samples/s | 24.5 steps/s
[Step=13600 Epoch=129.6] | Loss=0.00036 | Reg=0.00181 | L2-Norm=13.441 | L2-Norm(final)=3.015 | acc=1.0000 | 4267.1 samples/s | 66.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39573 | acc=0.7718 | tpr=0.6708 | fpr=0.0089 | 4323.9 samples/s | 16.9 steps/s
Avg test loss: 0.40004, Avg test acc: 0.77258, Avg tpr: 0.67325, Avg fpr: 0.00897, total FA: 70

Testing server on iccad2012
[Step=  50] | Loss=0.38018 | acc=0.8834 | tpr=0.9646 | fpr=0.1181 | 4350.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.38682 | acc=0.8825 | tpr=0.9680 | fpr=0.1191 | 8903.7 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.39358 | acc=0.8813 | tpr=0.9712 | fpr=0.1204 | 8780.0 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.39738 | acc=0.8808 | tpr=0.9738 | fpr=0.1209 | 8781.9 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.39597 | acc=0.8808 | tpr=0.9721 | fpr=0.1209 | 9277.3 samples/s | 36.2 steps/s
[Step= 300] | Loss=0.40047 | acc=0.8800 | tpr=0.9724 | fpr=0.1217 | 6854.6 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.40122 | acc=0.8798 | tpr=0.9724 | fpr=0.1219 | 8707.0 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.40304 | acc=0.8801 | tpr=0.9721 | fpr=0.1216 | 8782.6 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.40789 | acc=0.8796 | tpr=0.9713 | fpr=0.1221 | 8627.6 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.40697 | acc=0.8792 | tpr=0.9718 | fpr=0.1225 | 5898.8 samples/s | 23.0 steps/s
[Step= 550] | Loss=0.40624 | acc=0.8790 | tpr=0.9706 | fpr=0.1226 | 16723.1 samples/s | 65.3 steps/s
Avg test loss: 0.40612, Avg test acc: 0.87905, Avg tpr: 0.96989, Avg fpr: 0.12260, total FA: 17023

server round 28/50

clients selected: [0 1 6 8 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=13601 Epoch=66.3] | Loss=0.26515 | Reg=0.00180 | L2-Norm=13.424 | L2-Norm(final)=3.016 | acc=0.8438 | 3743.7 samples/s | 58.5 steps/s
[Step=13650 Epoch=66.6] | Loss=0.04396 | Reg=0.00181 | L2-Norm=13.462 | L2-Norm(final)=3.000 | acc=0.9688 | 4522.3 samples/s | 70.7 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02928 | Reg=0.00182 | L2-Norm=13.474 | L2-Norm(final)=2.998 | acc=0.9844 | 4383.1 samples/s | 68.5 steps/s
[Step=13750 Epoch=67.0] | Loss=0.02598 | Reg=0.00182 | L2-Norm=13.484 | L2-Norm(final)=3.001 | acc=0.9219 | 4452.5 samples/s | 69.6 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02401 | Reg=0.00182 | L2-Norm=13.491 | L2-Norm(final)=3.003 | acc=1.0000 | 5116.2 samples/s | 79.9 steps/s
[Step=13850 Epoch=67.5] | Loss=0.02154 | Reg=0.00182 | L2-Norm=13.497 | L2-Norm(final)=3.006 | acc=0.9844 | 1542.6 samples/s | 24.1 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01937 | Reg=0.00182 | L2-Norm=13.503 | L2-Norm(final)=3.010 | acc=1.0000 | 4416.3 samples/s | 69.0 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01783 | Reg=0.00182 | L2-Norm=13.509 | L2-Norm(final)=3.014 | acc=1.0000 | 4399.3 samples/s | 68.7 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01656 | Reg=0.00183 | L2-Norm=13.514 | L2-Norm(final)=3.019 | acc=0.9844 | 5011.4 samples/s | 78.3 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01542 | Reg=0.00183 | L2-Norm=13.519 | L2-Norm(final)=3.024 | acc=1.0000 | 1514.0 samples/s | 23.7 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01459 | Reg=0.00183 | L2-Norm=13.524 | L2-Norm(final)=3.028 | acc=1.0000 | 3862.5 samples/s | 60.4 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01391 | Reg=0.00183 | L2-Norm=13.528 | L2-Norm(final)=3.033 | acc=0.9844 | 3848.9 samples/s | 60.1 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01330 | Reg=0.00183 | L2-Norm=13.531 | L2-Norm(final)=3.037 | acc=1.0000 | 4334.8 samples/s | 67.7 steps/s
[Step=14250 Epoch=69.5] | Loss=0.01266 | Reg=0.00183 | L2-Norm=13.535 | L2-Norm(final)=3.041 | acc=0.9844 | 1621.3 samples/s | 25.3 steps/s
[Step=14300 Epoch=69.7] | Loss=0.01217 | Reg=0.00183 | L2-Norm=13.538 | L2-Norm(final)=3.045 | acc=1.0000 | 4593.3 samples/s | 71.8 steps/s
[Step=14350 Epoch=70.0] | Loss=0.01181 | Reg=0.00183 | L2-Norm=13.541 | L2-Norm(final)=3.049 | acc=1.0000 | 4464.8 samples/s | 69.8 steps/s
[Step=14400 Epoch=70.2] | Loss=0.01138 | Reg=0.00183 | L2-Norm=13.544 | L2-Norm(final)=3.052 | acc=1.0000 | 4522.0 samples/s | 70.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step14400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=11201 Epoch=54.7] | Loss=0.33583 | Reg=0.00180 | L2-Norm=13.424 | L2-Norm(final)=3.015 | acc=0.8594 | 3879.0 samples/s | 60.6 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04324 | Reg=0.00181 | L2-Norm=13.459 | L2-Norm(final)=2.995 | acc=0.9531 | 4326.1 samples/s | 67.6 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03285 | Reg=0.00181 | L2-Norm=13.470 | L2-Norm(final)=2.991 | acc=0.9844 | 4460.7 samples/s | 69.7 steps/s
[Step=11350 Epoch=55.4] | Loss=0.02850 | Reg=0.00182 | L2-Norm=13.480 | L2-Norm(final)=2.992 | acc=1.0000 | 4440.4 samples/s | 69.4 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02531 | Reg=0.00182 | L2-Norm=13.487 | L2-Norm(final)=2.994 | acc=1.0000 | 5068.0 samples/s | 79.2 steps/s
[Step=11450 Epoch=55.9] | Loss=0.02154 | Reg=0.00182 | L2-Norm=13.494 | L2-Norm(final)=2.997 | acc=1.0000 | 1553.1 samples/s | 24.3 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01914 | Reg=0.00182 | L2-Norm=13.501 | L2-Norm(final)=3.002 | acc=0.9688 | 4393.6 samples/s | 68.6 steps/s
[Step=11550 Epoch=56.4] | Loss=0.01744 | Reg=0.00182 | L2-Norm=13.507 | L2-Norm(final)=3.008 | acc=1.0000 | 4405.5 samples/s | 68.8 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01611 | Reg=0.00183 | L2-Norm=13.513 | L2-Norm(final)=3.013 | acc=0.9844 | 5085.2 samples/s | 79.5 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01514 | Reg=0.00183 | L2-Norm=13.518 | L2-Norm(final)=3.018 | acc=0.9688 | 1564.1 samples/s | 24.4 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01425 | Reg=0.00183 | L2-Norm=13.522 | L2-Norm(final)=3.023 | acc=0.9844 | 4452.6 samples/s | 69.6 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01346 | Reg=0.00183 | L2-Norm=13.526 | L2-Norm(final)=3.027 | acc=1.0000 | 4423.0 samples/s | 69.1 steps/s
[Step=11800 Epoch=57.6] | Loss=0.01277 | Reg=0.00183 | L2-Norm=13.530 | L2-Norm(final)=3.032 | acc=1.0000 | 4786.6 samples/s | 74.8 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01225 | Reg=0.00183 | L2-Norm=13.534 | L2-Norm(final)=3.036 | acc=1.0000 | 1572.0 samples/s | 24.6 steps/s
[Step=11900 Epoch=58.1] | Loss=0.01167 | Reg=0.00183 | L2-Norm=13.537 | L2-Norm(final)=3.040 | acc=1.0000 | 4442.1 samples/s | 69.4 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01138 | Reg=0.00183 | L2-Norm=13.540 | L2-Norm(final)=3.044 | acc=0.9844 | 4458.7 samples/s | 69.7 steps/s
[Step=12000 Epoch=58.6] | Loss=0.01096 | Reg=0.00183 | L2-Norm=13.543 | L2-Norm(final)=3.048 | acc=1.0000 | 4802.5 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step12000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=12001 Epoch=114.2] | Loss=0.07016 | Reg=0.00180 | L2-Norm=13.424 | L2-Norm(final)=3.015 | acc=0.9531 | 3716.6 samples/s | 58.1 steps/s
[Step=12050 Epoch=114.6] | Loss=0.00439 | Reg=0.00182 | L2-Norm=13.475 | L2-Norm(final)=3.009 | acc=1.0000 | 4046.8 samples/s | 63.2 steps/s
[Step=12100 Epoch=115.1] | Loss=0.00264 | Reg=0.00182 | L2-Norm=13.484 | L2-Norm(final)=3.011 | acc=1.0000 | 5074.9 samples/s | 79.3 steps/s
[Step=12150 Epoch=115.6] | Loss=0.00177 | Reg=0.00182 | L2-Norm=13.483 | L2-Norm(final)=3.013 | acc=1.0000 | 1502.8 samples/s | 23.5 steps/s
[Step=12200 Epoch=116.1] | Loss=0.00134 | Reg=0.00182 | L2-Norm=13.479 | L2-Norm(final)=3.014 | acc=1.0000 | 4920.0 samples/s | 76.9 steps/s
[Step=12250 Epoch=116.5] | Loss=0.00107 | Reg=0.00182 | L2-Norm=13.473 | L2-Norm(final)=3.015 | acc=1.0000 | 1509.8 samples/s | 23.6 steps/s
[Step=12300 Epoch=117.0] | Loss=0.00090 | Reg=0.00181 | L2-Norm=13.467 | L2-Norm(final)=3.017 | acc=1.0000 | 4655.2 samples/s | 72.7 steps/s
[Step=12350 Epoch=117.5] | Loss=0.00077 | Reg=0.00181 | L2-Norm=13.460 | L2-Norm(final)=3.018 | acc=1.0000 | 1543.9 samples/s | 24.1 steps/s
[Step=12400 Epoch=118.0] | Loss=0.00068 | Reg=0.00181 | L2-Norm=13.453 | L2-Norm(final)=3.019 | acc=1.0000 | 4418.4 samples/s | 69.0 steps/s
[Step=12450 Epoch=118.4] | Loss=0.00060 | Reg=0.00181 | L2-Norm=13.445 | L2-Norm(final)=3.019 | acc=1.0000 | 1575.5 samples/s | 24.6 steps/s
[Step=12500 Epoch=118.9] | Loss=0.00054 | Reg=0.00181 | L2-Norm=13.437 | L2-Norm(final)=3.020 | acc=1.0000 | 4285.1 samples/s | 67.0 steps/s
[Step=12550 Epoch=119.4] | Loss=0.00049 | Reg=0.00180 | L2-Norm=13.429 | L2-Norm(final)=3.021 | acc=1.0000 | 1577.4 samples/s | 24.6 steps/s
[Step=12600 Epoch=119.9] | Loss=0.00045 | Reg=0.00180 | L2-Norm=13.421 | L2-Norm(final)=3.022 | acc=1.0000 | 4331.3 samples/s | 67.7 steps/s
[Step=12650 Epoch=120.3] | Loss=0.00042 | Reg=0.00180 | L2-Norm=13.413 | L2-Norm(final)=3.022 | acc=1.0000 | 1610.8 samples/s | 25.2 steps/s
[Step=12700 Epoch=120.8] | Loss=0.00039 | Reg=0.00180 | L2-Norm=13.404 | L2-Norm(final)=3.023 | acc=1.0000 | 4265.7 samples/s | 66.7 steps/s
[Step=12750 Epoch=121.3] | Loss=0.00037 | Reg=0.00179 | L2-Norm=13.396 | L2-Norm(final)=3.024 | acc=1.0000 | 1596.0 samples/s | 24.9 steps/s
[Step=12800 Epoch=121.8] | Loss=0.00034 | Reg=0.00179 | L2-Norm=13.387 | L2-Norm(final)=3.024 | acc=1.0000 | 4222.1 samples/s | 66.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step12800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00025, len=1
[Step=7201 Epoch=67.9] | Loss=0.01092 | Reg=0.00180 | L2-Norm=13.424 | L2-Norm(final)=3.016 | acc=0.9844 | 3623.5 samples/s | 56.6 steps/s
[Step=7250 Epoch=68.3] | Loss=0.00448 | Reg=0.00181 | L2-Norm=13.467 | L2-Norm(final)=3.010 | acc=1.0000 | 4253.8 samples/s | 66.5 steps/s
[Step=7300 Epoch=68.8] | Loss=0.00319 | Reg=0.00182 | L2-Norm=13.484 | L2-Norm(final)=3.011 | acc=1.0000 | 4987.4 samples/s | 77.9 steps/s
[Step=7350 Epoch=69.3] | Loss=0.00218 | Reg=0.00182 | L2-Norm=13.491 | L2-Norm(final)=3.012 | acc=1.0000 | 1517.6 samples/s | 23.7 steps/s
[Step=7400 Epoch=69.7] | Loss=0.00165 | Reg=0.00182 | L2-Norm=13.492 | L2-Norm(final)=3.013 | acc=1.0000 | 4720.6 samples/s | 73.8 steps/s
[Step=7450 Epoch=70.2] | Loss=0.00132 | Reg=0.00182 | L2-Norm=13.491 | L2-Norm(final)=3.015 | acc=1.0000 | 1480.7 samples/s | 23.1 steps/s
[Step=7500 Epoch=70.7] | Loss=0.00111 | Reg=0.00182 | L2-Norm=13.488 | L2-Norm(final)=3.016 | acc=1.0000 | 4074.2 samples/s | 63.7 steps/s
[Step=7550 Epoch=71.1] | Loss=0.00095 | Reg=0.00182 | L2-Norm=13.483 | L2-Norm(final)=3.017 | acc=1.0000 | 1551.4 samples/s | 24.2 steps/s
[Step=7600 Epoch=71.6] | Loss=0.00083 | Reg=0.00182 | L2-Norm=13.478 | L2-Norm(final)=3.017 | acc=1.0000 | 4366.5 samples/s | 68.2 steps/s
[Step=7650 Epoch=72.1] | Loss=0.00074 | Reg=0.00182 | L2-Norm=13.473 | L2-Norm(final)=3.018 | acc=1.0000 | 1576.1 samples/s | 24.6 steps/s
[Step=7700 Epoch=72.6] | Loss=0.00067 | Reg=0.00181 | L2-Norm=13.467 | L2-Norm(final)=3.019 | acc=1.0000 | 4288.9 samples/s | 67.0 steps/s
[Step=7750 Epoch=73.0] | Loss=0.00061 | Reg=0.00181 | L2-Norm=13.461 | L2-Norm(final)=3.019 | acc=1.0000 | 1737.3 samples/s | 27.1 steps/s
[Step=7800 Epoch=73.5] | Loss=0.00056 | Reg=0.00181 | L2-Norm=13.454 | L2-Norm(final)=3.020 | acc=1.0000 | 4336.3 samples/s | 67.8 steps/s
[Step=7850 Epoch=74.0] | Loss=0.00052 | Reg=0.00181 | L2-Norm=13.447 | L2-Norm(final)=3.021 | acc=1.0000 | 1599.4 samples/s | 25.0 steps/s
[Step=7900 Epoch=74.4] | Loss=0.00048 | Reg=0.00181 | L2-Norm=13.441 | L2-Norm(final)=3.021 | acc=1.0000 | 4196.1 samples/s | 65.6 steps/s
[Step=7950 Epoch=74.9] | Loss=0.00045 | Reg=0.00180 | L2-Norm=13.434 | L2-Norm(final)=3.022 | acc=1.0000 | 1639.0 samples/s | 25.6 steps/s
[Step=8000 Epoch=75.4] | Loss=0.00042 | Reg=0.00180 | L2-Norm=13.427 | L2-Norm(final)=3.022 | acc=1.0000 | 4047.8 samples/s | 63.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step8000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00025, len=1
[Step=13601 Epoch=129.6] | Loss=0.00882 | Reg=0.00180 | L2-Norm=13.424 | L2-Norm(final)=3.017 | acc=1.0000 | 3693.3 samples/s | 57.7 steps/s
[Step=13650 Epoch=130.1] | Loss=0.00381 | Reg=0.00182 | L2-Norm=13.488 | L2-Norm(final)=3.012 | acc=1.0000 | 4267.8 samples/s | 66.7 steps/s
[Step=13700 Epoch=130.6] | Loss=0.00223 | Reg=0.00182 | L2-Norm=13.503 | L2-Norm(final)=3.015 | acc=1.0000 | 4970.6 samples/s | 77.7 steps/s
[Step=13750 Epoch=131.0] | Loss=0.00152 | Reg=0.00182 | L2-Norm=13.507 | L2-Norm(final)=3.018 | acc=1.0000 | 1518.6 samples/s | 23.7 steps/s
[Step=13800 Epoch=131.5] | Loss=0.00115 | Reg=0.00182 | L2-Norm=13.505 | L2-Norm(final)=3.020 | acc=1.0000 | 4896.1 samples/s | 76.5 steps/s
[Step=13850 Epoch=132.0] | Loss=0.00092 | Reg=0.00182 | L2-Norm=13.500 | L2-Norm(final)=3.022 | acc=1.0000 | 1523.4 samples/s | 23.8 steps/s
[Step=13900 Epoch=132.5] | Loss=0.00077 | Reg=0.00182 | L2-Norm=13.493 | L2-Norm(final)=3.023 | acc=1.0000 | 4716.7 samples/s | 73.7 steps/s
[Step=13950 Epoch=133.0] | Loss=0.00066 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=3.025 | acc=1.0000 | 1506.4 samples/s | 23.5 steps/s
[Step=14000 Epoch=133.4] | Loss=0.00058 | Reg=0.00182 | L2-Norm=13.478 | L2-Norm(final)=3.026 | acc=1.0000 | 4587.0 samples/s | 71.7 steps/s
[Step=14050 Epoch=133.9] | Loss=0.00052 | Reg=0.00181 | L2-Norm=13.470 | L2-Norm(final)=3.026 | acc=1.0000 | 1546.3 samples/s | 24.2 steps/s
[Step=14100 Epoch=134.4] | Loss=0.00046 | Reg=0.00181 | L2-Norm=13.461 | L2-Norm(final)=3.027 | acc=1.0000 | 4487.8 samples/s | 70.1 steps/s
[Step=14150 Epoch=134.9] | Loss=0.00042 | Reg=0.00181 | L2-Norm=13.452 | L2-Norm(final)=3.028 | acc=1.0000 | 1571.8 samples/s | 24.6 steps/s
[Step=14200 Epoch=135.3] | Loss=0.00039 | Reg=0.00181 | L2-Norm=13.443 | L2-Norm(final)=3.029 | acc=1.0000 | 4255.6 samples/s | 66.5 steps/s
[Step=14250 Epoch=135.8] | Loss=0.00036 | Reg=0.00180 | L2-Norm=13.434 | L2-Norm(final)=3.030 | acc=1.0000 | 1180.5 samples/s | 18.4 steps/s
[Step=14300 Epoch=136.3] | Loss=0.00033 | Reg=0.00180 | L2-Norm=13.425 | L2-Norm(final)=3.030 | acc=1.0000 | 4362.7 samples/s | 68.2 steps/s
[Step=14350 Epoch=136.8] | Loss=0.00031 | Reg=0.00180 | L2-Norm=13.415 | L2-Norm(final)=3.031 | acc=1.0000 | 1585.7 samples/s | 24.8 steps/s
[Step=14400 Epoch=137.2] | Loss=0.00029 | Reg=0.00180 | L2-Norm=13.406 | L2-Norm(final)=3.032 | acc=1.0000 | 4304.2 samples/s | 67.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38900 | acc=0.7783 | tpr=0.6799 | fpr=0.0082 | 4532.9 samples/s | 17.7 steps/s
Avg test loss: 0.39334, Avg test acc: 0.77907, Avg tpr: 0.68246, Avg fpr: 0.00846, total FA: 66

Testing server on iccad2012
[Step=  50] | Loss=0.37925 | acc=0.8809 | tpr=0.9646 | fpr=0.1206 | 4326.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.38518 | acc=0.8800 | tpr=0.9680 | fpr=0.1216 | 8888.2 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.39177 | acc=0.8797 | tpr=0.9712 | fpr=0.1220 | 8635.6 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.39552 | acc=0.8791 | tpr=0.9738 | fpr=0.1226 | 9070.3 samples/s | 35.4 steps/s
[Step= 250] | Loss=0.39405 | acc=0.8790 | tpr=0.9721 | fpr=0.1227 | 8459.7 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.39886 | acc=0.8779 | tpr=0.9731 | fpr=0.1238 | 8931.0 samples/s | 34.9 steps/s
[Step= 350] | Loss=0.39974 | acc=0.8778 | tpr=0.9731 | fpr=0.1240 | 9236.8 samples/s | 36.1 steps/s
[Step= 400] | Loss=0.40146 | acc=0.8779 | tpr=0.9737 | fpr=0.1238 | 8449.1 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.40605 | acc=0.8775 | tpr=0.9727 | fpr=0.1242 | 8894.6 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.40501 | acc=0.8772 | tpr=0.9740 | fpr=0.1246 | 8056.6 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.40415 | acc=0.8773 | tpr=0.9733 | fpr=0.1244 | 15501.6 samples/s | 60.6 steps/s
Avg test loss: 0.40405, Avg test acc: 0.87730, Avg tpr: 0.97266, Avg fpr: 0.12443, total FA: 17277

server round 29/50

clients selected: [0 2 3 5 8]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=14401 Epoch=70.2] | Loss=0.24764 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=3.046 | acc=0.8906 | 3905.3 samples/s | 61.0 steps/s
[Step=14450 Epoch=70.5] | Loss=0.04066 | Reg=0.00180 | L2-Norm=13.419 | L2-Norm(final)=3.030 | acc=1.0000 | 4241.1 samples/s | 66.3 steps/s
[Step=14500 Epoch=70.7] | Loss=0.03074 | Reg=0.00180 | L2-Norm=13.431 | L2-Norm(final)=3.028 | acc=1.0000 | 4353.0 samples/s | 68.0 steps/s
[Step=14550 Epoch=70.9] | Loss=0.02656 | Reg=0.00181 | L2-Norm=13.440 | L2-Norm(final)=3.031 | acc=1.0000 | 4438.7 samples/s | 69.4 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02497 | Reg=0.00181 | L2-Norm=13.448 | L2-Norm(final)=3.033 | acc=1.0000 | 5231.1 samples/s | 81.7 steps/s
[Step=14650 Epoch=71.4] | Loss=0.02122 | Reg=0.00181 | L2-Norm=13.456 | L2-Norm(final)=3.037 | acc=1.0000 | 1564.5 samples/s | 24.4 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01902 | Reg=0.00181 | L2-Norm=13.463 | L2-Norm(final)=3.043 | acc=0.9844 | 4435.7 samples/s | 69.3 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01766 | Reg=0.00181 | L2-Norm=13.469 | L2-Norm(final)=3.049 | acc=0.9844 | 4481.7 samples/s | 70.0 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01677 | Reg=0.00182 | L2-Norm=13.475 | L2-Norm(final)=3.053 | acc=0.9844 | 4942.6 samples/s | 77.2 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01589 | Reg=0.00182 | L2-Norm=13.480 | L2-Norm(final)=3.058 | acc=0.9844 | 1555.2 samples/s | 24.3 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01484 | Reg=0.00182 | L2-Norm=13.485 | L2-Norm(final)=3.062 | acc=1.0000 | 4383.4 samples/s | 68.5 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01405 | Reg=0.00182 | L2-Norm=13.489 | L2-Norm(final)=3.066 | acc=1.0000 | 4470.1 samples/s | 69.8 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01350 | Reg=0.00182 | L2-Norm=13.493 | L2-Norm(final)=3.070 | acc=1.0000 | 4917.9 samples/s | 76.8 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01285 | Reg=0.00182 | L2-Norm=13.497 | L2-Norm(final)=3.074 | acc=1.0000 | 1578.1 samples/s | 24.7 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01230 | Reg=0.00182 | L2-Norm=13.500 | L2-Norm(final)=3.078 | acc=1.0000 | 4424.2 samples/s | 69.1 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01185 | Reg=0.00182 | L2-Norm=13.504 | L2-Norm(final)=3.082 | acc=1.0000 | 4386.0 samples/s | 68.5 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01156 | Reg=0.00182 | L2-Norm=13.507 | L2-Norm(final)=3.086 | acc=1.0000 | 4556.3 samples/s | 71.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step15200.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00025, len=1
[Step=11201 Epoch=54.6] | Loss=0.34598 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=3.046 | acc=0.7969 | 3338.5 samples/s | 52.2 steps/s
[Step=11250 Epoch=54.8] | Loss=0.04736 | Reg=0.00180 | L2-Norm=13.410 | L2-Norm(final)=3.025 | acc=0.9688 | 4493.3 samples/s | 70.2 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03499 | Reg=0.00180 | L2-Norm=13.421 | L2-Norm(final)=3.021 | acc=0.9844 | 4303.8 samples/s | 67.2 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02835 | Reg=0.00180 | L2-Norm=13.432 | L2-Norm(final)=3.024 | acc=0.9688 | 4311.5 samples/s | 67.4 steps/s
[Step=11400 Epoch=55.5] | Loss=0.02467 | Reg=0.00181 | L2-Norm=13.442 | L2-Norm(final)=3.030 | acc=0.9844 | 5188.4 samples/s | 81.1 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02189 | Reg=0.00181 | L2-Norm=13.452 | L2-Norm(final)=3.035 | acc=0.9844 | 1538.5 samples/s | 24.0 steps/s
[Step=11500 Epoch=56.0] | Loss=0.01965 | Reg=0.00181 | L2-Norm=13.460 | L2-Norm(final)=3.041 | acc=1.0000 | 4387.9 samples/s | 68.6 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01815 | Reg=0.00181 | L2-Norm=13.467 | L2-Norm(final)=3.047 | acc=0.9844 | 4463.0 samples/s | 69.7 steps/s
[Step=11600 Epoch=56.5] | Loss=0.01685 | Reg=0.00182 | L2-Norm=13.473 | L2-Norm(final)=3.052 | acc=1.0000 | 5025.6 samples/s | 78.5 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01579 | Reg=0.00182 | L2-Norm=13.479 | L2-Norm(final)=3.057 | acc=1.0000 | 1582.4 samples/s | 24.7 steps/s
[Step=11700 Epoch=57.0] | Loss=0.01500 | Reg=0.00182 | L2-Norm=13.484 | L2-Norm(final)=3.062 | acc=1.0000 | 4354.7 samples/s | 68.0 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01450 | Reg=0.00182 | L2-Norm=13.490 | L2-Norm(final)=3.066 | acc=1.0000 | 4455.2 samples/s | 69.6 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01386 | Reg=0.00182 | L2-Norm=13.494 | L2-Norm(final)=3.070 | acc=1.0000 | 4517.3 samples/s | 70.6 steps/s
[Step=11850 Epoch=57.7] | Loss=0.01310 | Reg=0.00182 | L2-Norm=13.499 | L2-Norm(final)=3.075 | acc=1.0000 | 1601.1 samples/s | 25.0 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01260 | Reg=0.00182 | L2-Norm=13.503 | L2-Norm(final)=3.079 | acc=0.9844 | 4379.9 samples/s | 68.4 steps/s
[Step=11950 Epoch=58.2] | Loss=0.01211 | Reg=0.00182 | L2-Norm=13.507 | L2-Norm(final)=3.083 | acc=1.0000 | 4432.4 samples/s | 69.3 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01170 | Reg=0.00183 | L2-Norm=13.511 | L2-Norm(final)=3.087 | acc=1.0000 | 4765.8 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step12000.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00025, len=1
[Step=10401 Epoch=50.7] | Loss=0.50047 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=3.046 | acc=0.7344 | 3895.8 samples/s | 60.9 steps/s
[Step=10450 Epoch=51.0] | Loss=0.04086 | Reg=0.00180 | L2-Norm=13.419 | L2-Norm(final)=3.031 | acc=0.9844 | 4083.7 samples/s | 63.8 steps/s
[Step=10500 Epoch=51.2] | Loss=0.03107 | Reg=0.00180 | L2-Norm=13.432 | L2-Norm(final)=3.030 | acc=1.0000 | 4423.3 samples/s | 69.1 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02607 | Reg=0.00181 | L2-Norm=13.439 | L2-Norm(final)=3.031 | acc=0.9844 | 4446.6 samples/s | 69.5 steps/s
[Step=10600 Epoch=51.7] | Loss=0.02404 | Reg=0.00181 | L2-Norm=13.447 | L2-Norm(final)=3.033 | acc=0.9844 | 5209.2 samples/s | 81.4 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02132 | Reg=0.00181 | L2-Norm=13.454 | L2-Norm(final)=3.036 | acc=1.0000 | 1560.5 samples/s | 24.4 steps/s
[Step=10700 Epoch=52.2] | Loss=0.01881 | Reg=0.00181 | L2-Norm=13.460 | L2-Norm(final)=3.040 | acc=1.0000 | 4468.6 samples/s | 69.8 steps/s
[Step=10750 Epoch=52.4] | Loss=0.01734 | Reg=0.00181 | L2-Norm=13.466 | L2-Norm(final)=3.044 | acc=0.9844 | 4363.4 samples/s | 68.2 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01611 | Reg=0.00181 | L2-Norm=13.472 | L2-Norm(final)=3.049 | acc=1.0000 | 5023.6 samples/s | 78.5 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01477 | Reg=0.00182 | L2-Norm=13.477 | L2-Norm(final)=3.053 | acc=1.0000 | 1510.7 samples/s | 23.6 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01380 | Reg=0.00182 | L2-Norm=13.482 | L2-Norm(final)=3.058 | acc=1.0000 | 3851.0 samples/s | 60.2 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01308 | Reg=0.00182 | L2-Norm=13.487 | L2-Norm(final)=3.062 | acc=1.0000 | 3853.3 samples/s | 60.2 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01252 | Reg=0.00182 | L2-Norm=13.491 | L2-Norm(final)=3.066 | acc=0.9688 | 4365.2 samples/s | 68.2 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01214 | Reg=0.00182 | L2-Norm=13.495 | L2-Norm(final)=3.070 | acc=1.0000 | 1591.9 samples/s | 24.9 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01151 | Reg=0.00182 | L2-Norm=13.498 | L2-Norm(final)=3.073 | acc=1.0000 | 4373.5 samples/s | 68.3 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01108 | Reg=0.00182 | L2-Norm=13.502 | L2-Norm(final)=3.077 | acc=1.0000 | 4545.2 samples/s | 71.0 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01067 | Reg=0.00182 | L2-Norm=13.505 | L2-Norm(final)=3.081 | acc=1.0000 | 4654.2 samples/s | 72.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step11200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=12801 Epoch=121.3] | Loss=0.00209 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=3.047 | acc=1.0000 | 3689.4 samples/s | 57.6 steps/s
[Step=12850 Epoch=121.8] | Loss=0.00367 | Reg=0.00180 | L2-Norm=13.431 | L2-Norm(final)=3.042 | acc=1.0000 | 4119.2 samples/s | 64.4 steps/s
[Step=12900 Epoch=122.2] | Loss=0.00209 | Reg=0.00181 | L2-Norm=13.441 | L2-Norm(final)=3.046 | acc=1.0000 | 5032.3 samples/s | 78.6 steps/s
[Step=12950 Epoch=122.7] | Loss=0.00140 | Reg=0.00181 | L2-Norm=13.441 | L2-Norm(final)=3.051 | acc=1.0000 | 1494.6 samples/s | 23.4 steps/s
[Step=13000 Epoch=123.2] | Loss=0.00106 | Reg=0.00181 | L2-Norm=13.436 | L2-Norm(final)=3.053 | acc=1.0000 | 4863.6 samples/s | 76.0 steps/s
[Step=13050 Epoch=123.7] | Loss=0.00085 | Reg=0.00180 | L2-Norm=13.429 | L2-Norm(final)=3.055 | acc=1.0000 | 1512.9 samples/s | 23.6 steps/s
[Step=13100 Epoch=124.1] | Loss=0.00071 | Reg=0.00180 | L2-Norm=13.421 | L2-Norm(final)=3.057 | acc=1.0000 | 4594.7 samples/s | 71.8 steps/s
[Step=13150 Epoch=124.6] | Loss=0.00061 | Reg=0.00180 | L2-Norm=13.412 | L2-Norm(final)=3.058 | acc=1.0000 | 1502.1 samples/s | 23.5 steps/s
[Step=13200 Epoch=125.1] | Loss=0.00053 | Reg=0.00180 | L2-Norm=13.402 | L2-Norm(final)=3.059 | acc=1.0000 | 3967.2 samples/s | 62.0 steps/s
[Step=13250 Epoch=125.6] | Loss=0.00047 | Reg=0.00179 | L2-Norm=13.393 | L2-Norm(final)=3.060 | acc=1.0000 | 1559.0 samples/s | 24.4 steps/s
[Step=13300 Epoch=126.0] | Loss=0.00043 | Reg=0.00179 | L2-Norm=13.383 | L2-Norm(final)=3.061 | acc=1.0000 | 4312.0 samples/s | 67.4 steps/s
[Step=13350 Epoch=126.5] | Loss=0.00039 | Reg=0.00179 | L2-Norm=13.372 | L2-Norm(final)=3.061 | acc=1.0000 | 1569.1 samples/s | 24.5 steps/s
[Step=13400 Epoch=127.0] | Loss=0.00036 | Reg=0.00179 | L2-Norm=13.362 | L2-Norm(final)=3.062 | acc=1.0000 | 4330.0 samples/s | 67.7 steps/s
[Step=13450 Epoch=127.5] | Loss=0.00033 | Reg=0.00178 | L2-Norm=13.351 | L2-Norm(final)=3.063 | acc=1.0000 | 1571.4 samples/s | 24.6 steps/s
[Step=13500 Epoch=127.9] | Loss=0.00031 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.063 | acc=1.0000 | 4360.1 samples/s | 68.1 steps/s
[Step=13550 Epoch=128.4] | Loss=0.00029 | Reg=0.00178 | L2-Norm=13.330 | L2-Norm(final)=3.064 | acc=1.0000 | 1585.2 samples/s | 24.8 steps/s
[Step=13600 Epoch=128.9] | Loss=0.00027 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=3.064 | acc=1.0000 | 4255.9 samples/s | 66.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step13600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00025, len=1
[Step=8001 Epoch=75.4] | Loss=0.02382 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=3.047 | acc=0.9844 | 3954.6 samples/s | 61.8 steps/s
[Step=8050 Epoch=75.9] | Loss=0.00454 | Reg=0.00180 | L2-Norm=13.433 | L2-Norm(final)=3.042 | acc=1.0000 | 3870.2 samples/s | 60.5 steps/s
[Step=8100 Epoch=76.3] | Loss=0.00248 | Reg=0.00181 | L2-Norm=13.450 | L2-Norm(final)=3.045 | acc=1.0000 | 4986.6 samples/s | 77.9 steps/s
[Step=8150 Epoch=76.8] | Loss=0.00174 | Reg=0.00181 | L2-Norm=13.453 | L2-Norm(final)=3.047 | acc=1.0000 | 1514.5 samples/s | 23.7 steps/s
[Step=8200 Epoch=77.3] | Loss=0.00132 | Reg=0.00181 | L2-Norm=13.453 | L2-Norm(final)=3.050 | acc=1.0000 | 4732.4 samples/s | 73.9 steps/s
[Step=8250 Epoch=77.7] | Loss=0.00106 | Reg=0.00181 | L2-Norm=13.451 | L2-Norm(final)=3.051 | acc=1.0000 | 1541.3 samples/s | 24.1 steps/s
[Step=8300 Epoch=78.2] | Loss=0.00089 | Reg=0.00181 | L2-Norm=13.447 | L2-Norm(final)=3.053 | acc=1.0000 | 4539.8 samples/s | 70.9 steps/s
[Step=8350 Epoch=78.7] | Loss=0.00077 | Reg=0.00181 | L2-Norm=13.442 | L2-Norm(final)=3.054 | acc=1.0000 | 1535.5 samples/s | 24.0 steps/s
[Step=8400 Epoch=79.2] | Loss=0.00067 | Reg=0.00181 | L2-Norm=13.436 | L2-Norm(final)=3.055 | acc=1.0000 | 4372.6 samples/s | 68.3 steps/s
[Step=8450 Epoch=79.6] | Loss=0.00060 | Reg=0.00180 | L2-Norm=13.430 | L2-Norm(final)=3.056 | acc=1.0000 | 1580.7 samples/s | 24.7 steps/s
[Step=8500 Epoch=80.1] | Loss=0.00054 | Reg=0.00180 | L2-Norm=13.424 | L2-Norm(final)=3.057 | acc=1.0000 | 4315.0 samples/s | 67.4 steps/s
[Step=8550 Epoch=80.6] | Loss=0.00049 | Reg=0.00180 | L2-Norm=13.417 | L2-Norm(final)=3.058 | acc=1.0000 | 1563.8 samples/s | 24.4 steps/s
[Step=8600 Epoch=81.0] | Loss=0.00045 | Reg=0.00180 | L2-Norm=13.410 | L2-Norm(final)=3.059 | acc=1.0000 | 3724.3 samples/s | 58.2 steps/s
[Step=8650 Epoch=81.5] | Loss=0.00042 | Reg=0.00180 | L2-Norm=13.403 | L2-Norm(final)=3.059 | acc=1.0000 | 1610.1 samples/s | 25.2 steps/s
[Step=8700 Epoch=82.0] | Loss=0.00039 | Reg=0.00179 | L2-Norm=13.396 | L2-Norm(final)=3.060 | acc=1.0000 | 4205.2 samples/s | 65.7 steps/s
[Step=8750 Epoch=82.4] | Loss=0.00036 | Reg=0.00179 | L2-Norm=13.388 | L2-Norm(final)=3.061 | acc=1.0000 | 1643.0 samples/s | 25.7 steps/s
[Step=8800 Epoch=82.9] | Loss=0.00034 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.061 | acc=1.0000 | 3871.7 samples/s | 60.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43380 | acc=0.7585 | tpr=0.6510 | fpr=0.0079 | 4430.1 samples/s | 17.3 steps/s
Avg test loss: 0.43775, Avg test acc: 0.75968, Avg tpr: 0.65408, Avg fpr: 0.00808, total FA: 63

Testing server on iccad2012
[Step=  50] | Loss=0.34481 | acc=0.8952 | tpr=0.9602 | fpr=0.1059 | 4382.0 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.35171 | acc=0.8951 | tpr=0.9659 | fpr=0.1062 | 8815.3 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.35777 | acc=0.8945 | tpr=0.9697 | fpr=0.1069 | 8012.1 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.36119 | acc=0.8938 | tpr=0.9727 | fpr=0.1076 | 8870.8 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.36010 | acc=0.8934 | tpr=0.9703 | fpr=0.1080 | 8623.9 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.36450 | acc=0.8923 | tpr=0.9709 | fpr=0.1091 | 8777.6 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.36549 | acc=0.8922 | tpr=0.9706 | fpr=0.1092 | 9147.3 samples/s | 35.7 steps/s
[Step= 400] | Loss=0.36731 | acc=0.8923 | tpr=0.9716 | fpr=0.1092 | 8414.9 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.37168 | acc=0.8917 | tpr=0.9708 | fpr=0.1098 | 8716.6 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.37063 | acc=0.8914 | tpr=0.9718 | fpr=0.1100 | 8726.0 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.36957 | acc=0.8915 | tpr=0.9713 | fpr=0.1100 | 16234.1 samples/s | 63.4 steps/s
Avg test loss: 0.36940, Avg test acc: 0.89151, Avg tpr: 0.97068, Avg fpr: 0.10993, total FA: 15263

server round 30/50

clients selected: [2 4 5 7 8]

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00013, len=1
[Step=12001 Epoch=58.5] | Loss=0.25662 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.067 | acc=0.8594 | 3769.0 samples/s | 58.9 steps/s
[Step=12050 Epoch=58.7] | Loss=0.04703 | Reg=0.00179 | L2-Norm=13.365 | L2-Norm(final)=3.057 | acc=0.9844 | 4450.3 samples/s | 69.5 steps/s
[Step=12100 Epoch=59.0] | Loss=0.03321 | Reg=0.00179 | L2-Norm=13.371 | L2-Norm(final)=3.056 | acc=0.9844 | 4543.5 samples/s | 71.0 steps/s
[Step=12150 Epoch=59.2] | Loss=0.02826 | Reg=0.00179 | L2-Norm=13.375 | L2-Norm(final)=3.057 | acc=1.0000 | 4431.0 samples/s | 69.2 steps/s
[Step=12200 Epoch=59.4] | Loss=0.02444 | Reg=0.00179 | L2-Norm=13.379 | L2-Norm(final)=3.059 | acc=0.9688 | 5323.2 samples/s | 83.2 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02146 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=3.062 | acc=0.9844 | 1567.7 samples/s | 24.5 steps/s
[Step=12300 Epoch=59.9] | Loss=0.01886 | Reg=0.00179 | L2-Norm=13.386 | L2-Norm(final)=3.066 | acc=1.0000 | 4534.4 samples/s | 70.8 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01710 | Reg=0.00179 | L2-Norm=13.390 | L2-Norm(final)=3.070 | acc=1.0000 | 4657.2 samples/s | 72.8 steps/s
[Step=12400 Epoch=60.4] | Loss=0.01574 | Reg=0.00179 | L2-Norm=13.393 | L2-Norm(final)=3.074 | acc=1.0000 | 5258.9 samples/s | 82.2 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01462 | Reg=0.00179 | L2-Norm=13.397 | L2-Norm(final)=3.078 | acc=1.0000 | 1603.7 samples/s | 25.1 steps/s
[Step=12500 Epoch=60.9] | Loss=0.01370 | Reg=0.00180 | L2-Norm=13.401 | L2-Norm(final)=3.082 | acc=1.0000 | 4524.3 samples/s | 70.7 steps/s
[Step=12550 Epoch=61.1] | Loss=0.01293 | Reg=0.00180 | L2-Norm=13.404 | L2-Norm(final)=3.086 | acc=1.0000 | 4530.8 samples/s | 70.8 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01223 | Reg=0.00180 | L2-Norm=13.408 | L2-Norm(final)=3.091 | acc=1.0000 | 5101.6 samples/s | 79.7 steps/s
[Step=12650 Epoch=61.6] | Loss=0.01165 | Reg=0.00180 | L2-Norm=13.411 | L2-Norm(final)=3.095 | acc=0.9844 | 1626.2 samples/s | 25.4 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01105 | Reg=0.00180 | L2-Norm=13.414 | L2-Norm(final)=3.099 | acc=1.0000 | 4627.2 samples/s | 72.3 steps/s
[Step=12750 Epoch=62.1] | Loss=0.01068 | Reg=0.00180 | L2-Norm=13.417 | L2-Norm(final)=3.103 | acc=1.0000 | 4655.0 samples/s | 72.7 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01028 | Reg=0.00180 | L2-Norm=13.419 | L2-Norm(final)=3.107 | acc=0.9844 | 4794.6 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step12800.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00013, len=1
[Step=10401 Epoch=51.0] | Loss=0.34701 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.067 | acc=0.7969 | 4331.9 samples/s | 67.7 steps/s
[Step=10450 Epoch=51.2] | Loss=0.05074 | Reg=0.00179 | L2-Norm=13.362 | L2-Norm(final)=3.057 | acc=0.9844 | 4112.2 samples/s | 64.3 steps/s
[Step=10500 Epoch=51.5] | Loss=0.03554 | Reg=0.00179 | L2-Norm=13.367 | L2-Norm(final)=3.055 | acc=1.0000 | 4653.9 samples/s | 72.7 steps/s
[Step=10550 Epoch=51.7] | Loss=0.02790 | Reg=0.00179 | L2-Norm=13.370 | L2-Norm(final)=3.056 | acc=0.9688 | 4296.9 samples/s | 67.1 steps/s
[Step=10600 Epoch=52.0] | Loss=0.02404 | Reg=0.00179 | L2-Norm=13.374 | L2-Norm(final)=3.058 | acc=1.0000 | 4930.2 samples/s | 77.0 steps/s
[Step=10650 Epoch=52.2] | Loss=0.02035 | Reg=0.00179 | L2-Norm=13.378 | L2-Norm(final)=3.061 | acc=1.0000 | 1512.1 samples/s | 23.6 steps/s
[Step=10700 Epoch=52.5] | Loss=0.01817 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=3.064 | acc=1.0000 | 4656.2 samples/s | 72.8 steps/s
[Step=10750 Epoch=52.7] | Loss=0.01651 | Reg=0.00179 | L2-Norm=13.384 | L2-Norm(final)=3.067 | acc=1.0000 | 4557.8 samples/s | 71.2 steps/s
[Step=10800 Epoch=53.0] | Loss=0.01507 | Reg=0.00179 | L2-Norm=13.387 | L2-Norm(final)=3.070 | acc=1.0000 | 5290.4 samples/s | 82.7 steps/s
[Step=10850 Epoch=53.2] | Loss=0.01375 | Reg=0.00179 | L2-Norm=13.390 | L2-Norm(final)=3.074 | acc=1.0000 | 1506.7 samples/s | 23.5 steps/s
[Step=10900 Epoch=53.5] | Loss=0.01288 | Reg=0.00179 | L2-Norm=13.393 | L2-Norm(final)=3.077 | acc=1.0000 | 3885.8 samples/s | 60.7 steps/s
[Step=10950 Epoch=53.7] | Loss=0.01219 | Reg=0.00179 | L2-Norm=13.396 | L2-Norm(final)=3.081 | acc=1.0000 | 3948.7 samples/s | 61.7 steps/s
[Step=11000 Epoch=53.9] | Loss=0.01144 | Reg=0.00180 | L2-Norm=13.399 | L2-Norm(final)=3.084 | acc=1.0000 | 4512.1 samples/s | 70.5 steps/s
[Step=11050 Epoch=54.2] | Loss=0.01080 | Reg=0.00180 | L2-Norm=13.402 | L2-Norm(final)=3.088 | acc=1.0000 | 1591.9 samples/s | 24.9 steps/s
[Step=11100 Epoch=54.4] | Loss=0.01027 | Reg=0.00180 | L2-Norm=13.404 | L2-Norm(final)=3.091 | acc=1.0000 | 4725.2 samples/s | 73.8 steps/s
[Step=11150 Epoch=54.7] | Loss=0.00980 | Reg=0.00180 | L2-Norm=13.407 | L2-Norm(final)=3.094 | acc=0.9844 | 4668.4 samples/s | 72.9 steps/s
[Step=11200 Epoch=54.9] | Loss=0.00947 | Reg=0.00180 | L2-Norm=13.409 | L2-Norm(final)=3.098 | acc=0.9844 | 5152.0 samples/s | 80.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step11200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=13601 Epoch=128.9] | Loss=0.03259 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.068 | acc=0.9688 | 3976.6 samples/s | 62.1 steps/s
[Step=13650 Epoch=129.3] | Loss=0.00293 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=3.074 | acc=1.0000 | 4146.4 samples/s | 64.8 steps/s
[Step=13700 Epoch=129.8] | Loss=0.00161 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=3.077 | acc=1.0000 | 5269.2 samples/s | 82.3 steps/s
[Step=13750 Epoch=130.3] | Loss=0.00109 | Reg=0.00179 | L2-Norm=13.376 | L2-Norm(final)=3.079 | acc=1.0000 | 1556.3 samples/s | 24.3 steps/s
[Step=13800 Epoch=130.8] | Loss=0.00082 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=3.080 | acc=1.0000 | 5074.4 samples/s | 79.3 steps/s
[Step=13850 Epoch=131.2] | Loss=0.00067 | Reg=0.00179 | L2-Norm=13.370 | L2-Norm(final)=3.082 | acc=1.0000 | 1562.4 samples/s | 24.4 steps/s
[Step=13900 Epoch=131.7] | Loss=0.00056 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=3.083 | acc=1.0000 | 4845.3 samples/s | 75.7 steps/s
[Step=13950 Epoch=132.2] | Loss=0.00048 | Reg=0.00179 | L2-Norm=13.362 | L2-Norm(final)=3.084 | acc=1.0000 | 1580.6 samples/s | 24.7 steps/s
[Step=14000 Epoch=132.7] | Loss=0.00042 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=3.085 | acc=1.0000 | 4627.3 samples/s | 72.3 steps/s
[Step=14050 Epoch=133.1] | Loss=0.00038 | Reg=0.00178 | L2-Norm=13.353 | L2-Norm(final)=3.085 | acc=1.0000 | 1592.8 samples/s | 24.9 steps/s
[Step=14100 Epoch=133.6] | Loss=0.00034 | Reg=0.00178 | L2-Norm=13.348 | L2-Norm(final)=3.086 | acc=1.0000 | 4597.9 samples/s | 71.8 steps/s
[Step=14150 Epoch=134.1] | Loss=0.00031 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=3.087 | acc=1.0000 | 1548.1 samples/s | 24.2 steps/s
[Step=14200 Epoch=134.6] | Loss=0.00029 | Reg=0.00178 | L2-Norm=13.338 | L2-Norm(final)=3.087 | acc=1.0000 | 3820.3 samples/s | 59.7 steps/s
[Step=14250 Epoch=135.0] | Loss=0.00027 | Reg=0.00178 | L2-Norm=13.333 | L2-Norm(final)=3.088 | acc=1.0000 | 1591.4 samples/s | 24.9 steps/s
[Step=14300 Epoch=135.5] | Loss=0.00025 | Reg=0.00178 | L2-Norm=13.328 | L2-Norm(final)=3.089 | acc=1.0000 | 4553.8 samples/s | 71.2 steps/s
[Step=14350 Epoch=136.0] | Loss=0.00023 | Reg=0.00177 | L2-Norm=13.322 | L2-Norm(final)=3.089 | acc=1.0000 | 1599.6 samples/s | 25.0 steps/s
[Step=14400 Epoch=136.5] | Loss=0.00022 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=3.090 | acc=1.0000 | 4383.8 samples/s | 68.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step14400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00013, len=1
[Step=9601 Epoch=91.7] | Loss=0.03138 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.068 | acc=0.9844 | 3992.2 samples/s | 62.4 steps/s
[Step=9650 Epoch=92.2] | Loss=0.00456 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=3.065 | acc=1.0000 | 4027.4 samples/s | 62.9 steps/s
[Step=9700 Epoch=92.6] | Loss=0.00239 | Reg=0.00179 | L2-Norm=13.369 | L2-Norm(final)=3.066 | acc=1.0000 | 5265.4 samples/s | 82.3 steps/s
[Step=9750 Epoch=93.1] | Loss=0.00162 | Reg=0.00179 | L2-Norm=13.369 | L2-Norm(final)=3.067 | acc=1.0000 | 1522.2 samples/s | 23.8 steps/s
[Step=9800 Epoch=93.6] | Loss=0.00123 | Reg=0.00179 | L2-Norm=13.367 | L2-Norm(final)=3.068 | acc=1.0000 | 5145.5 samples/s | 80.4 steps/s
[Step=9850 Epoch=94.1] | Loss=0.00099 | Reg=0.00179 | L2-Norm=13.365 | L2-Norm(final)=3.069 | acc=1.0000 | 1548.5 samples/s | 24.2 steps/s
[Step=9900 Epoch=94.5] | Loss=0.00083 | Reg=0.00179 | L2-Norm=13.362 | L2-Norm(final)=3.069 | acc=1.0000 | 4907.8 samples/s | 76.7 steps/s
[Step=9950 Epoch=95.0] | Loss=0.00071 | Reg=0.00178 | L2-Norm=13.359 | L2-Norm(final)=3.070 | acc=1.0000 | 1566.1 samples/s | 24.5 steps/s
[Step=10000 Epoch=95.5] | Loss=0.00063 | Reg=0.00178 | L2-Norm=13.356 | L2-Norm(final)=3.071 | acc=1.0000 | 4782.4 samples/s | 74.7 steps/s
[Step=10050 Epoch=96.0] | Loss=0.00056 | Reg=0.00178 | L2-Norm=13.352 | L2-Norm(final)=3.071 | acc=1.0000 | 1561.9 samples/s | 24.4 steps/s
[Step=10100 Epoch=96.4] | Loss=0.00051 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.072 | acc=1.0000 | 4491.8 samples/s | 70.2 steps/s
[Step=10150 Epoch=96.9] | Loss=0.00046 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.072 | acc=1.0000 | 1585.5 samples/s | 24.8 steps/s
[Step=10200 Epoch=97.4] | Loss=0.00043 | Reg=0.00178 | L2-Norm=13.342 | L2-Norm(final)=3.073 | acc=1.0000 | 4477.8 samples/s | 70.0 steps/s
[Step=10250 Epoch=97.9] | Loss=0.00039 | Reg=0.00178 | L2-Norm=13.338 | L2-Norm(final)=3.073 | acc=1.0000 | 1607.9 samples/s | 25.1 steps/s
[Step=10300 Epoch=98.4] | Loss=0.00037 | Reg=0.00178 | L2-Norm=13.334 | L2-Norm(final)=3.074 | acc=1.0000 | 4498.2 samples/s | 70.3 steps/s
[Step=10350 Epoch=98.8] | Loss=0.00034 | Reg=0.00178 | L2-Norm=13.330 | L2-Norm(final)=3.074 | acc=1.0000 | 1599.4 samples/s | 25.0 steps/s
[Step=10400 Epoch=99.3] | Loss=0.00032 | Reg=0.00178 | L2-Norm=13.326 | L2-Norm(final)=3.075 | acc=1.0000 | 4569.2 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step10400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00013, len=1
[Step=8801 Epoch=82.9] | Loss=0.01611 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.068 | acc=0.9844 | 3900.3 samples/s | 60.9 steps/s
[Step=8850 Epoch=83.4] | Loss=0.00289 | Reg=0.00179 | L2-Norm=13.375 | L2-Norm(final)=3.071 | acc=1.0000 | 4179.3 samples/s | 65.3 steps/s
[Step=8900 Epoch=83.9] | Loss=0.00162 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.073 | acc=1.0000 | 5267.2 samples/s | 82.3 steps/s
[Step=8950 Epoch=84.3] | Loss=0.00110 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=3.075 | acc=1.0000 | 1530.2 samples/s | 23.9 steps/s
[Step=9000 Epoch=84.8] | Loss=0.00083 | Reg=0.00179 | L2-Norm=13.379 | L2-Norm(final)=3.077 | acc=1.0000 | 4971.5 samples/s | 77.7 steps/s
[Step=9050 Epoch=85.3] | Loss=0.00067 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=3.078 | acc=1.0000 | 1569.2 samples/s | 24.5 steps/s
[Step=9100 Epoch=85.7] | Loss=0.00057 | Reg=0.00179 | L2-Norm=13.374 | L2-Norm(final)=3.079 | acc=1.0000 | 4680.6 samples/s | 73.1 steps/s
[Step=9150 Epoch=86.2] | Loss=0.00049 | Reg=0.00179 | L2-Norm=13.371 | L2-Norm(final)=3.080 | acc=1.0000 | 1527.4 samples/s | 23.9 steps/s
[Step=9200 Epoch=86.7] | Loss=0.00043 | Reg=0.00179 | L2-Norm=13.367 | L2-Norm(final)=3.080 | acc=1.0000 | 3950.1 samples/s | 61.7 steps/s
[Step=9250 Epoch=87.2] | Loss=0.00039 | Reg=0.00179 | L2-Norm=13.364 | L2-Norm(final)=3.081 | acc=1.0000 | 1607.1 samples/s | 25.1 steps/s
[Step=9300 Epoch=87.6] | Loss=0.00035 | Reg=0.00179 | L2-Norm=13.360 | L2-Norm(final)=3.082 | acc=1.0000 | 4430.4 samples/s | 69.2 steps/s
[Step=9350 Epoch=88.1] | Loss=0.00032 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=3.082 | acc=1.0000 | 1620.5 samples/s | 25.3 steps/s
[Step=9400 Epoch=88.6] | Loss=0.00029 | Reg=0.00178 | L2-Norm=13.353 | L2-Norm(final)=3.083 | acc=1.0000 | 4418.3 samples/s | 69.0 steps/s
[Step=9450 Epoch=89.0] | Loss=0.00027 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.084 | acc=1.0000 | 1620.7 samples/s | 25.3 steps/s
[Step=9500 Epoch=89.5] | Loss=0.00025 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.084 | acc=1.0000 | 4424.9 samples/s | 69.1 steps/s
[Step=9550 Epoch=90.0] | Loss=0.00024 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.085 | acc=1.0000 | 1729.3 samples/s | 27.0 steps/s
[Step=9600 Epoch=90.5] | Loss=0.00022 | Reg=0.00178 | L2-Norm=13.337 | L2-Norm(final)=3.085 | acc=1.0000 | 3708.7 samples/s | 57.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36083 | acc=0.8036 | tpr=0.7163 | fpr=0.0069 | 4538.0 samples/s | 17.7 steps/s
Avg test loss: 0.36643, Avg test acc: 0.80179, Avg tpr: 0.71539, Avg fpr: 0.00820, total FA: 64

Testing server on iccad2012
[Step=  50] | Loss=0.40361 | acc=0.8727 | tpr=0.9602 | fpr=0.1289 | 4532.6 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.41044 | acc=0.8733 | tpr=0.9659 | fpr=0.1284 | 9368.3 samples/s | 36.6 steps/s
[Step= 150] | Loss=0.41655 | acc=0.8738 | tpr=0.9697 | fpr=0.1280 | 9044.0 samples/s | 35.3 steps/s
[Step= 200] | Loss=0.41994 | acc=0.8736 | tpr=0.9716 | fpr=0.1281 | 9115.3 samples/s | 35.6 steps/s
[Step= 250] | Loss=0.41886 | acc=0.8739 | tpr=0.9694 | fpr=0.1278 | 9528.1 samples/s | 37.2 steps/s
[Step= 300] | Loss=0.42380 | acc=0.8726 | tpr=0.9709 | fpr=0.1292 | 9086.0 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.42484 | acc=0.8726 | tpr=0.9706 | fpr=0.1292 | 9431.9 samples/s | 36.8 steps/s
[Step= 400] | Loss=0.42682 | acc=0.8727 | tpr=0.9699 | fpr=0.1290 | 9305.8 samples/s | 36.4 steps/s
[Step= 450] | Loss=0.43132 | acc=0.8723 | tpr=0.9693 | fpr=0.1294 | 8906.2 samples/s | 34.8 steps/s
[Step= 500] | Loss=0.43038 | acc=0.8720 | tpr=0.9700 | fpr=0.1297 | 9017.6 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.42944 | acc=0.8720 | tpr=0.9690 | fpr=0.1298 | 17369.5 samples/s | 67.8 steps/s
Avg test loss: 0.42940, Avg test acc: 0.87199, Avg tpr: 0.96830, Avg fpr: 0.12976, total FA: 18017

server round 31/50

clients selected: [1 2 4 6 8]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=12001 Epoch=58.6] | Loss=0.11047 | Reg=0.00178 | L2-Norm=13.335 | L2-Norm(final)=3.104 | acc=0.9219 | 4074.0 samples/s | 63.7 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03317 | Reg=0.00178 | L2-Norm=13.354 | L2-Norm(final)=3.100 | acc=0.9531 | 4433.9 samples/s | 69.3 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02715 | Reg=0.00179 | L2-Norm=13.361 | L2-Norm(final)=3.098 | acc=1.0000 | 4687.9 samples/s | 73.2 steps/s
[Step=12150 Epoch=59.3] | Loss=0.02299 | Reg=0.00179 | L2-Norm=13.364 | L2-Norm(final)=3.098 | acc=0.9844 | 4539.5 samples/s | 70.9 steps/s
[Step=12200 Epoch=59.5] | Loss=0.01984 | Reg=0.00179 | L2-Norm=13.367 | L2-Norm(final)=3.099 | acc=1.0000 | 5452.6 samples/s | 85.2 steps/s
[Step=12250 Epoch=59.8] | Loss=0.01706 | Reg=0.00179 | L2-Norm=13.370 | L2-Norm(final)=3.102 | acc=1.0000 | 1578.1 samples/s | 24.7 steps/s
[Step=12300 Epoch=60.0] | Loss=0.01504 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=3.105 | acc=1.0000 | 4609.9 samples/s | 72.0 steps/s
[Step=12350 Epoch=60.3] | Loss=0.01378 | Reg=0.00179 | L2-Norm=13.376 | L2-Norm(final)=3.109 | acc=1.0000 | 4698.2 samples/s | 73.4 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01299 | Reg=0.00179 | L2-Norm=13.379 | L2-Norm(final)=3.112 | acc=1.0000 | 5372.4 samples/s | 83.9 steps/s
[Step=12450 Epoch=60.8] | Loss=0.01187 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=3.116 | acc=1.0000 | 1612.4 samples/s | 25.2 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01100 | Reg=0.00179 | L2-Norm=13.385 | L2-Norm(final)=3.119 | acc=1.0000 | 4626.7 samples/s | 72.3 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01051 | Reg=0.00179 | L2-Norm=13.388 | L2-Norm(final)=3.123 | acc=1.0000 | 4612.0 samples/s | 72.1 steps/s
[Step=12600 Epoch=61.5] | Loss=0.01003 | Reg=0.00179 | L2-Norm=13.390 | L2-Norm(final)=3.126 | acc=1.0000 | 5136.7 samples/s | 80.3 steps/s
[Step=12650 Epoch=61.7] | Loss=0.00964 | Reg=0.00179 | L2-Norm=13.393 | L2-Norm(final)=3.129 | acc=1.0000 | 1598.8 samples/s | 25.0 steps/s
[Step=12700 Epoch=62.0] | Loss=0.00925 | Reg=0.00179 | L2-Norm=13.395 | L2-Norm(final)=3.132 | acc=1.0000 | 4689.8 samples/s | 73.3 steps/s
[Step=12750 Epoch=62.2] | Loss=0.00879 | Reg=0.00179 | L2-Norm=13.397 | L2-Norm(final)=3.136 | acc=1.0000 | 4561.1 samples/s | 71.3 steps/s
[Step=12800 Epoch=62.5] | Loss=0.00852 | Reg=0.00180 | L2-Norm=13.399 | L2-Norm(final)=3.139 | acc=1.0000 | 5036.8 samples/s | 78.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step12800.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00013, len=1
[Step=12801 Epoch=62.4] | Loss=0.24948 | Reg=0.00178 | L2-Norm=13.335 | L2-Norm(final)=3.103 | acc=0.8125 | 4090.8 samples/s | 63.9 steps/s
[Step=12850 Epoch=62.6] | Loss=0.04427 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=3.093 | acc=0.9844 | 4406.5 samples/s | 68.9 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03018 | Reg=0.00178 | L2-Norm=13.353 | L2-Norm(final)=3.093 | acc=1.0000 | 4546.4 samples/s | 71.0 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02608 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=3.095 | acc=0.9688 | 4175.1 samples/s | 65.2 steps/s
[Step=13000 Epoch=63.3] | Loss=0.02268 | Reg=0.00179 | L2-Norm=13.361 | L2-Norm(final)=3.097 | acc=1.0000 | 4945.1 samples/s | 77.3 steps/s
[Step=13050 Epoch=63.6] | Loss=0.01925 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=3.100 | acc=1.0000 | 1575.7 samples/s | 24.6 steps/s
[Step=13100 Epoch=63.8] | Loss=0.01724 | Reg=0.00179 | L2-Norm=13.370 | L2-Norm(final)=3.104 | acc=1.0000 | 4528.2 samples/s | 70.8 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01589 | Reg=0.00179 | L2-Norm=13.374 | L2-Norm(final)=3.108 | acc=1.0000 | 4638.6 samples/s | 72.5 steps/s
[Step=13200 Epoch=64.3] | Loss=0.01477 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=3.112 | acc=1.0000 | 5335.4 samples/s | 83.4 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01369 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=3.117 | acc=1.0000 | 1589.4 samples/s | 24.8 steps/s
[Step=13300 Epoch=64.8] | Loss=0.01302 | Reg=0.00179 | L2-Norm=13.385 | L2-Norm(final)=3.121 | acc=1.0000 | 4485.3 samples/s | 70.1 steps/s
[Step=13350 Epoch=65.0] | Loss=0.01221 | Reg=0.00179 | L2-Norm=13.388 | L2-Norm(final)=3.124 | acc=1.0000 | 4603.8 samples/s | 71.9 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01147 | Reg=0.00179 | L2-Norm=13.391 | L2-Norm(final)=3.128 | acc=1.0000 | 5028.5 samples/s | 78.6 steps/s
[Step=13450 Epoch=65.5] | Loss=0.01103 | Reg=0.00179 | L2-Norm=13.394 | L2-Norm(final)=3.132 | acc=1.0000 | 1574.6 samples/s | 24.6 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01055 | Reg=0.00179 | L2-Norm=13.397 | L2-Norm(final)=3.136 | acc=0.9844 | 4422.8 samples/s | 69.1 steps/s
[Step=13550 Epoch=66.0] | Loss=0.01010 | Reg=0.00180 | L2-Norm=13.399 | L2-Norm(final)=3.139 | acc=1.0000 | 4413.0 samples/s | 69.0 steps/s
[Step=13600 Epoch=66.3] | Loss=0.00971 | Reg=0.00180 | L2-Norm=13.402 | L2-Norm(final)=3.143 | acc=1.0000 | 4392.1 samples/s | 68.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step13600.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00013, len=1
[Step=11201 Epoch=54.9] | Loss=0.12384 | Reg=0.00178 | L2-Norm=13.335 | L2-Norm(final)=3.104 | acc=0.9219 | 3733.6 samples/s | 58.3 steps/s
[Step=11250 Epoch=55.2] | Loss=0.03330 | Reg=0.00178 | L2-Norm=13.353 | L2-Norm(final)=3.100 | acc=0.9531 | 4565.3 samples/s | 71.3 steps/s
[Step=11300 Epoch=55.4] | Loss=0.02672 | Reg=0.00179 | L2-Norm=13.361 | L2-Norm(final)=3.099 | acc=1.0000 | 4151.2 samples/s | 64.9 steps/s
[Step=11350 Epoch=55.7] | Loss=0.02215 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=3.101 | acc=1.0000 | 4596.1 samples/s | 71.8 steps/s
[Step=11400 Epoch=55.9] | Loss=0.01960 | Reg=0.00179 | L2-Norm=13.370 | L2-Norm(final)=3.103 | acc=0.9844 | 5493.3 samples/s | 85.8 steps/s
[Step=11450 Epoch=56.1] | Loss=0.01700 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=3.106 | acc=1.0000 | 1486.3 samples/s | 23.2 steps/s
[Step=11500 Epoch=56.4] | Loss=0.01522 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=3.109 | acc=1.0000 | 3953.1 samples/s | 61.8 steps/s
[Step=11550 Epoch=56.6] | Loss=0.01396 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.113 | acc=0.9844 | 3927.1 samples/s | 61.4 steps/s
[Step=11600 Epoch=56.9] | Loss=0.01302 | Reg=0.00179 | L2-Norm=13.383 | L2-Norm(final)=3.116 | acc=1.0000 | 4815.5 samples/s | 75.2 steps/s
[Step=11650 Epoch=57.1] | Loss=0.01195 | Reg=0.00179 | L2-Norm=13.386 | L2-Norm(final)=3.119 | acc=1.0000 | 1587.6 samples/s | 24.8 steps/s
[Step=11700 Epoch=57.4] | Loss=0.01126 | Reg=0.00179 | L2-Norm=13.389 | L2-Norm(final)=3.123 | acc=1.0000 | 4662.7 samples/s | 72.9 steps/s
[Step=11750 Epoch=57.6] | Loss=0.01065 | Reg=0.00179 | L2-Norm=13.392 | L2-Norm(final)=3.126 | acc=1.0000 | 4670.5 samples/s | 73.0 steps/s
[Step=11800 Epoch=57.9] | Loss=0.01004 | Reg=0.00179 | L2-Norm=13.394 | L2-Norm(final)=3.129 | acc=0.9844 | 5184.7 samples/s | 81.0 steps/s
[Step=11850 Epoch=58.1] | Loss=0.00953 | Reg=0.00179 | L2-Norm=13.397 | L2-Norm(final)=3.132 | acc=1.0000 | 1611.8 samples/s | 25.2 steps/s
[Step=11900 Epoch=58.4] | Loss=0.00916 | Reg=0.00180 | L2-Norm=13.399 | L2-Norm(final)=3.135 | acc=1.0000 | 4576.2 samples/s | 71.5 steps/s
[Step=11950 Epoch=58.6] | Loss=0.00877 | Reg=0.00180 | L2-Norm=13.401 | L2-Norm(final)=3.138 | acc=0.9844 | 4629.4 samples/s | 72.3 steps/s
[Step=12000 Epoch=58.8] | Loss=0.00847 | Reg=0.00180 | L2-Norm=13.403 | L2-Norm(final)=3.141 | acc=1.0000 | 5103.5 samples/s | 79.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step12000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=12801 Epoch=121.8] | Loss=0.07902 | Reg=0.00178 | L2-Norm=13.335 | L2-Norm(final)=3.103 | acc=0.9844 | 3980.0 samples/s | 62.2 steps/s
[Step=12850 Epoch=122.2] | Loss=0.00741 | Reg=0.00178 | L2-Norm=13.359 | L2-Norm(final)=3.095 | acc=1.0000 | 3937.4 samples/s | 61.5 steps/s
[Step=12900 Epoch=122.7] | Loss=0.00380 | Reg=0.00179 | L2-Norm=13.365 | L2-Norm(final)=3.095 | acc=1.0000 | 5381.5 samples/s | 84.1 steps/s
[Step=12950 Epoch=123.2] | Loss=0.00256 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=3.095 | acc=1.0000 | 1539.0 samples/s | 24.0 steps/s
[Step=13000 Epoch=123.7] | Loss=0.00193 | Reg=0.00179 | L2-Norm=13.365 | L2-Norm(final)=3.096 | acc=1.0000 | 5002.2 samples/s | 78.2 steps/s
[Step=13050 Epoch=124.1] | Loss=0.00155 | Reg=0.00179 | L2-Norm=13.362 | L2-Norm(final)=3.097 | acc=1.0000 | 1537.1 samples/s | 24.0 steps/s
[Step=13100 Epoch=124.6] | Loss=0.00130 | Reg=0.00178 | L2-Norm=13.360 | L2-Norm(final)=3.097 | acc=1.0000 | 4838.1 samples/s | 75.6 steps/s
[Step=13150 Epoch=125.1] | Loss=0.00112 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=3.098 | acc=1.0000 | 1594.3 samples/s | 24.9 steps/s
[Step=13200 Epoch=125.6] | Loss=0.00098 | Reg=0.00178 | L2-Norm=13.354 | L2-Norm(final)=3.098 | acc=1.0000 | 4683.5 samples/s | 73.2 steps/s
[Step=13250 Epoch=126.0] | Loss=0.00087 | Reg=0.00178 | L2-Norm=13.351 | L2-Norm(final)=3.099 | acc=1.0000 | 1535.9 samples/s | 24.0 steps/s
[Step=13300 Epoch=126.5] | Loss=0.00079 | Reg=0.00178 | L2-Norm=13.348 | L2-Norm(final)=3.100 | acc=1.0000 | 3844.9 samples/s | 60.1 steps/s
[Step=13350 Epoch=127.0] | Loss=0.00072 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.100 | acc=1.0000 | 1623.0 samples/s | 25.4 steps/s
[Step=13400 Epoch=127.5] | Loss=0.00066 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.101 | acc=1.0000 | 4514.0 samples/s | 70.5 steps/s
[Step=13450 Epoch=127.9] | Loss=0.00061 | Reg=0.00178 | L2-Norm=13.338 | L2-Norm(final)=3.101 | acc=1.0000 | 1622.1 samples/s | 25.3 steps/s
[Step=13500 Epoch=128.4] | Loss=0.00057 | Reg=0.00178 | L2-Norm=13.334 | L2-Norm(final)=3.102 | acc=1.0000 | 4522.9 samples/s | 70.7 steps/s
[Step=13550 Epoch=128.9] | Loss=0.00053 | Reg=0.00178 | L2-Norm=13.330 | L2-Norm(final)=3.102 | acc=1.0000 | 1619.5 samples/s | 25.3 steps/s
[Step=13600 Epoch=129.4] | Loss=0.00050 | Reg=0.00178 | L2-Norm=13.327 | L2-Norm(final)=3.102 | acc=1.0000 | 4341.9 samples/s | 67.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step13600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00013, len=1
[Step=9601 Epoch=90.5] | Loss=0.05357 | Reg=0.00178 | L2-Norm=13.335 | L2-Norm(final)=3.103 | acc=0.9688 | 3856.8 samples/s | 60.3 steps/s
[Step=9650 Epoch=90.9] | Loss=0.00609 | Reg=0.00178 | L2-Norm=13.352 | L2-Norm(final)=3.098 | acc=1.0000 | 4197.9 samples/s | 65.6 steps/s
[Step=9700 Epoch=91.4] | Loss=0.00311 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=3.099 | acc=1.0000 | 5287.3 samples/s | 82.6 steps/s
[Step=9750 Epoch=91.9] | Loss=0.00209 | Reg=0.00178 | L2-Norm=13.354 | L2-Norm(final)=3.100 | acc=1.0000 | 1556.0 samples/s | 24.3 steps/s
[Step=9800 Epoch=92.3] | Loss=0.00158 | Reg=0.00178 | L2-Norm=13.352 | L2-Norm(final)=3.101 | acc=1.0000 | 5100.6 samples/s | 79.7 steps/s
[Step=9850 Epoch=92.8] | Loss=0.00127 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.102 | acc=1.0000 | 1587.7 samples/s | 24.8 steps/s
[Step=9900 Epoch=93.3] | Loss=0.00106 | Reg=0.00178 | L2-Norm=13.346 | L2-Norm(final)=3.103 | acc=1.0000 | 4827.4 samples/s | 75.4 steps/s
[Step=9950 Epoch=93.8] | Loss=0.00091 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=3.104 | acc=1.0000 | 1589.1 samples/s | 24.8 steps/s
[Step=10000 Epoch=94.2] | Loss=0.00080 | Reg=0.00178 | L2-Norm=13.340 | L2-Norm(final)=3.104 | acc=1.0000 | 4564.6 samples/s | 71.3 steps/s
[Step=10050 Epoch=94.7] | Loss=0.00072 | Reg=0.00178 | L2-Norm=13.336 | L2-Norm(final)=3.105 | acc=1.0000 | 1588.7 samples/s | 24.8 steps/s
[Step=10100 Epoch=95.2] | Loss=0.00065 | Reg=0.00178 | L2-Norm=13.333 | L2-Norm(final)=3.105 | acc=1.0000 | 4425.9 samples/s | 69.2 steps/s
[Step=10150 Epoch=95.6] | Loss=0.00059 | Reg=0.00178 | L2-Norm=13.329 | L2-Norm(final)=3.106 | acc=1.0000 | 1625.7 samples/s | 25.4 steps/s
[Step=10200 Epoch=96.1] | Loss=0.00054 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=3.107 | acc=1.0000 | 4478.6 samples/s | 70.0 steps/s
[Step=10250 Epoch=96.6] | Loss=0.00050 | Reg=0.00177 | L2-Norm=13.321 | L2-Norm(final)=3.107 | acc=1.0000 | 1638.2 samples/s | 25.6 steps/s
[Step=10300 Epoch=97.1] | Loss=0.00047 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=3.107 | acc=1.0000 | 4411.8 samples/s | 68.9 steps/s
[Step=10350 Epoch=97.5] | Loss=0.00044 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.108 | acc=1.0000 | 1627.9 samples/s | 25.4 steps/s
[Step=10400 Epoch=98.0] | Loss=0.00041 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=3.108 | acc=1.0000 | 4319.0 samples/s | 67.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37889 | acc=0.7973 | tpr=0.7070 | fpr=0.0064 | 4540.7 samples/s | 17.7 steps/s
Avg test loss: 0.38451, Avg test acc: 0.79494, Avg tpr: 0.70513, Avg fpr: 0.00756, total FA: 59

Testing server on iccad2012
[Step=  50] | Loss=0.40101 | acc=0.8784 | tpr=0.9602 | fpr=0.1231 | 4574.0 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.40813 | acc=0.8785 | tpr=0.9659 | fpr=0.1232 | 9432.1 samples/s | 36.8 steps/s
[Step= 150] | Loss=0.41435 | acc=0.8782 | tpr=0.9697 | fpr=0.1235 | 9269.1 samples/s | 36.2 steps/s
[Step= 200] | Loss=0.41769 | acc=0.8776 | tpr=0.9716 | fpr=0.1241 | 9188.5 samples/s | 35.9 steps/s
[Step= 250] | Loss=0.41678 | acc=0.8778 | tpr=0.9694 | fpr=0.1239 | 8870.6 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.42163 | acc=0.8766 | tpr=0.9702 | fpr=0.1251 | 9702.3 samples/s | 37.9 steps/s
[Step= 350] | Loss=0.42270 | acc=0.8765 | tpr=0.9706 | fpr=0.1252 | 9183.4 samples/s | 35.9 steps/s
[Step= 400] | Loss=0.42477 | acc=0.8766 | tpr=0.9705 | fpr=0.1251 | 8979.9 samples/s | 35.1 steps/s
[Step= 450] | Loss=0.42931 | acc=0.8763 | tpr=0.9698 | fpr=0.1254 | 9213.5 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.42822 | acc=0.8760 | tpr=0.9709 | fpr=0.1257 | 9105.2 samples/s | 35.6 steps/s
[Step= 550] | Loss=0.42717 | acc=0.8761 | tpr=0.9686 | fpr=0.1256 | 17101.3 samples/s | 66.8 steps/s
Avg test loss: 0.42707, Avg test acc: 0.87613, Avg tpr: 0.96791, Avg fpr: 0.12554, total FA: 17431

server round 32/50

clients selected: [4 5 6 7 9]

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00013, len=1
[Step=12001 Epoch=58.9] | Loss=0.28286 | Reg=0.00177 | L2-Norm=13.323 | L2-Norm(final)=3.129 | acc=0.8438 | 3904.9 samples/s | 61.0 steps/s
[Step=12050 Epoch=59.1] | Loss=0.04193 | Reg=0.00178 | L2-Norm=13.340 | L2-Norm(final)=3.119 | acc=1.0000 | 4625.0 samples/s | 72.3 steps/s
[Step=12100 Epoch=59.3] | Loss=0.03134 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=3.116 | acc=0.9688 | 4654.2 samples/s | 72.7 steps/s
[Step=12150 Epoch=59.6] | Loss=0.02601 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=3.116 | acc=1.0000 | 4691.6 samples/s | 73.3 steps/s
[Step=12200 Epoch=59.8] | Loss=0.02213 | Reg=0.00178 | L2-Norm=13.350 | L2-Norm(final)=3.117 | acc=1.0000 | 5459.9 samples/s | 85.3 steps/s
[Step=12250 Epoch=60.1] | Loss=0.01917 | Reg=0.00178 | L2-Norm=13.353 | L2-Norm(final)=3.120 | acc=0.9844 | 1577.1 samples/s | 24.6 steps/s
[Step=12300 Epoch=60.3] | Loss=0.01678 | Reg=0.00178 | L2-Norm=13.356 | L2-Norm(final)=3.123 | acc=0.9688 | 4601.5 samples/s | 71.9 steps/s
[Step=12350 Epoch=60.6] | Loss=0.01515 | Reg=0.00178 | L2-Norm=13.359 | L2-Norm(final)=3.126 | acc=1.0000 | 4715.9 samples/s | 73.7 steps/s
[Step=12400 Epoch=60.8] | Loss=0.01391 | Reg=0.00179 | L2-Norm=13.363 | L2-Norm(final)=3.130 | acc=1.0000 | 5375.1 samples/s | 84.0 steps/s
[Step=12450 Epoch=61.1] | Loss=0.01291 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=3.133 | acc=1.0000 | 1592.8 samples/s | 24.9 steps/s
[Step=12500 Epoch=61.3] | Loss=0.01207 | Reg=0.00179 | L2-Norm=13.369 | L2-Norm(final)=3.137 | acc=1.0000 | 4595.6 samples/s | 71.8 steps/s
[Step=12550 Epoch=61.5] | Loss=0.01131 | Reg=0.00179 | L2-Norm=13.371 | L2-Norm(final)=3.140 | acc=1.0000 | 4554.2 samples/s | 71.2 steps/s
[Step=12600 Epoch=61.8] | Loss=0.01067 | Reg=0.00179 | L2-Norm=13.374 | L2-Norm(final)=3.144 | acc=1.0000 | 5188.8 samples/s | 81.1 steps/s
[Step=12650 Epoch=62.0] | Loss=0.01008 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=3.147 | acc=1.0000 | 1601.8 samples/s | 25.0 steps/s
[Step=12700 Epoch=62.3] | Loss=0.00961 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.151 | acc=1.0000 | 4671.8 samples/s | 73.0 steps/s
[Step=12750 Epoch=62.5] | Loss=0.00916 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=3.154 | acc=1.0000 | 4606.9 samples/s | 72.0 steps/s
[Step=12800 Epoch=62.8] | Loss=0.00888 | Reg=0.00179 | L2-Norm=13.384 | L2-Norm(final)=3.157 | acc=1.0000 | 5112.8 samples/s | 79.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step12800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=14401 Epoch=136.5] | Loss=0.05072 | Reg=0.00177 | L2-Norm=13.323 | L2-Norm(final)=3.129 | acc=0.9531 | 3511.6 samples/s | 54.9 steps/s
[Step=14450 Epoch=136.9] | Loss=0.00319 | Reg=0.00178 | L2-Norm=13.360 | L2-Norm(final)=3.132 | acc=1.0000 | 4056.9 samples/s | 63.4 steps/s
[Step=14500 Epoch=137.4] | Loss=0.00169 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=3.133 | acc=1.0000 | 5183.7 samples/s | 81.0 steps/s
[Step=14550 Epoch=137.9] | Loss=0.00114 | Reg=0.00179 | L2-Norm=13.367 | L2-Norm(final)=3.135 | acc=1.0000 | 1537.8 samples/s | 24.0 steps/s
[Step=14600 Epoch=138.3] | Loss=0.00086 | Reg=0.00179 | L2-Norm=13.365 | L2-Norm(final)=3.136 | acc=1.0000 | 4928.8 samples/s | 77.0 steps/s
[Step=14650 Epoch=138.8] | Loss=0.00070 | Reg=0.00179 | L2-Norm=13.363 | L2-Norm(final)=3.137 | acc=1.0000 | 1579.1 samples/s | 24.7 steps/s
[Step=14700 Epoch=139.3] | Loss=0.00058 | Reg=0.00178 | L2-Norm=13.360 | L2-Norm(final)=3.138 | acc=1.0000 | 4989.4 samples/s | 78.0 steps/s
[Step=14750 Epoch=139.8] | Loss=0.00050 | Reg=0.00178 | L2-Norm=13.356 | L2-Norm(final)=3.139 | acc=1.0000 | 1544.1 samples/s | 24.1 steps/s
[Step=14800 Epoch=140.2] | Loss=0.00044 | Reg=0.00178 | L2-Norm=13.353 | L2-Norm(final)=3.139 | acc=1.0000 | 4606.5 samples/s | 72.0 steps/s
[Step=14850 Epoch=140.7] | Loss=0.00040 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.140 | acc=1.0000 | 1621.5 samples/s | 25.3 steps/s
[Step=14900 Epoch=141.2] | Loss=0.00036 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.141 | acc=1.0000 | 4495.8 samples/s | 70.2 steps/s
[Step=14950 Epoch=141.7] | Loss=0.00033 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.141 | acc=1.0000 | 1655.3 samples/s | 25.9 steps/s
[Step=15000 Epoch=142.1] | Loss=0.00030 | Reg=0.00178 | L2-Norm=13.336 | L2-Norm(final)=3.142 | acc=1.0000 | 4504.7 samples/s | 70.4 steps/s
[Step=15050 Epoch=142.6] | Loss=0.00028 | Reg=0.00178 | L2-Norm=13.332 | L2-Norm(final)=3.142 | acc=1.0000 | 1624.3 samples/s | 25.4 steps/s
[Step=15100 Epoch=143.1] | Loss=0.00026 | Reg=0.00178 | L2-Norm=13.327 | L2-Norm(final)=3.143 | acc=1.0000 | 4460.2 samples/s | 69.7 steps/s
[Step=15150 Epoch=143.6] | Loss=0.00024 | Reg=0.00178 | L2-Norm=13.323 | L2-Norm(final)=3.143 | acc=1.0000 | 1640.0 samples/s | 25.6 steps/s
[Step=15200 Epoch=144.0] | Loss=0.00023 | Reg=0.00177 | L2-Norm=13.318 | L2-Norm(final)=3.144 | acc=1.0000 | 4394.4 samples/s | 68.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step15200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=13601 Epoch=129.4] | Loss=0.13667 | Reg=0.00177 | L2-Norm=13.323 | L2-Norm(final)=3.128 | acc=0.9531 | 4051.8 samples/s | 63.3 steps/s
[Step=13650 Epoch=129.8] | Loss=0.00528 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.128 | acc=1.0000 | 4117.8 samples/s | 64.3 steps/s
[Step=13700 Epoch=130.3] | Loss=0.00272 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.130 | acc=1.0000 | 5165.0 samples/s | 80.7 steps/s
[Step=13750 Epoch=130.8] | Loss=0.00183 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.131 | acc=1.0000 | 1539.8 samples/s | 24.1 steps/s
[Step=13800 Epoch=131.3] | Loss=0.00138 | Reg=0.00178 | L2-Norm=13.342 | L2-Norm(final)=3.132 | acc=1.0000 | 5017.7 samples/s | 78.4 steps/s
[Step=13850 Epoch=131.7] | Loss=0.00111 | Reg=0.00178 | L2-Norm=13.340 | L2-Norm(final)=3.133 | acc=1.0000 | 1734.3 samples/s | 27.1 steps/s
[Step=13900 Epoch=132.2] | Loss=0.00093 | Reg=0.00178 | L2-Norm=13.337 | L2-Norm(final)=3.134 | acc=1.0000 | 4888.9 samples/s | 76.4 steps/s
[Step=13950 Epoch=132.7] | Loss=0.00080 | Reg=0.00178 | L2-Norm=13.334 | L2-Norm(final)=3.135 | acc=1.0000 | 1578.4 samples/s | 24.7 steps/s
[Step=14000 Epoch=133.2] | Loss=0.00070 | Reg=0.00178 | L2-Norm=13.330 | L2-Norm(final)=3.135 | acc=1.0000 | 4738.9 samples/s | 74.0 steps/s
[Step=14050 Epoch=133.7] | Loss=0.00063 | Reg=0.00178 | L2-Norm=13.327 | L2-Norm(final)=3.136 | acc=1.0000 | 1591.3 samples/s | 24.9 steps/s
[Step=14100 Epoch=134.1] | Loss=0.00056 | Reg=0.00178 | L2-Norm=13.323 | L2-Norm(final)=3.137 | acc=1.0000 | 4552.0 samples/s | 71.1 steps/s
[Step=14150 Epoch=134.6] | Loss=0.00052 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=3.137 | acc=1.0000 | 1684.9 samples/s | 26.3 steps/s
[Step=14200 Epoch=135.1] | Loss=0.00047 | Reg=0.00177 | L2-Norm=13.315 | L2-Norm(final)=3.138 | acc=1.0000 | 4548.4 samples/s | 71.1 steps/s
[Step=14250 Epoch=135.6] | Loss=0.00044 | Reg=0.00177 | L2-Norm=13.312 | L2-Norm(final)=3.138 | acc=1.0000 | 1608.5 samples/s | 25.1 steps/s
[Step=14300 Epoch=136.0] | Loss=0.00041 | Reg=0.00177 | L2-Norm=13.308 | L2-Norm(final)=3.139 | acc=1.0000 | 4463.0 samples/s | 69.7 steps/s
[Step=14350 Epoch=136.5] | Loss=0.00038 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.139 | acc=1.0000 | 1620.5 samples/s | 25.3 steps/s
[Step=14400 Epoch=137.0] | Loss=0.00036 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.140 | acc=1.0000 | 4299.9 samples/s | 67.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step14400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00013, len=1
[Step=10401 Epoch=99.3] | Loss=0.01965 | Reg=0.00177 | L2-Norm=13.323 | L2-Norm(final)=3.129 | acc=0.9844 | 3851.5 samples/s | 60.2 steps/s
[Step=10450 Epoch=99.8] | Loss=0.00332 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=3.128 | acc=1.0000 | 3954.7 samples/s | 61.8 steps/s
[Step=10500 Epoch=100.3] | Loss=0.00195 | Reg=0.00179 | L2-Norm=13.362 | L2-Norm(final)=3.129 | acc=1.0000 | 5316.2 samples/s | 83.1 steps/s
[Step=10550 Epoch=100.7] | Loss=0.00131 | Reg=0.00179 | L2-Norm=13.362 | L2-Norm(final)=3.130 | acc=1.0000 | 1449.4 samples/s | 22.6 steps/s
[Step=10600 Epoch=101.2] | Loss=0.00099 | Reg=0.00179 | L2-Norm=13.360 | L2-Norm(final)=3.131 | acc=1.0000 | 4400.6 samples/s | 68.8 steps/s
[Step=10650 Epoch=101.7] | Loss=0.00080 | Reg=0.00178 | L2-Norm=13.358 | L2-Norm(final)=3.131 | acc=1.0000 | 1545.0 samples/s | 24.1 steps/s
[Step=10700 Epoch=102.2] | Loss=0.00067 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=3.132 | acc=1.0000 | 4985.0 samples/s | 77.9 steps/s
[Step=10750 Epoch=102.7] | Loss=0.00058 | Reg=0.00178 | L2-Norm=13.352 | L2-Norm(final)=3.132 | acc=1.0000 | 1561.7 samples/s | 24.4 steps/s
[Step=10800 Epoch=103.1] | Loss=0.00051 | Reg=0.00178 | L2-Norm=13.348 | L2-Norm(final)=3.133 | acc=1.0000 | 4809.6 samples/s | 75.1 steps/s
[Step=10850 Epoch=103.6] | Loss=0.00045 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.133 | acc=1.0000 | 1588.8 samples/s | 24.8 steps/s
[Step=10900 Epoch=104.1] | Loss=0.00041 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.134 | acc=1.0000 | 4674.2 samples/s | 73.0 steps/s
[Step=10950 Epoch=104.6] | Loss=0.00037 | Reg=0.00178 | L2-Norm=13.337 | L2-Norm(final)=3.134 | acc=1.0000 | 1570.3 samples/s | 24.5 steps/s
[Step=11000 Epoch=105.0] | Loss=0.00034 | Reg=0.00178 | L2-Norm=13.333 | L2-Norm(final)=3.135 | acc=1.0000 | 4543.7 samples/s | 71.0 steps/s
[Step=11050 Epoch=105.5] | Loss=0.00032 | Reg=0.00178 | L2-Norm=13.329 | L2-Norm(final)=3.135 | acc=1.0000 | 1598.9 samples/s | 25.0 steps/s
[Step=11100 Epoch=106.0] | Loss=0.00029 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=3.135 | acc=1.0000 | 4542.5 samples/s | 71.0 steps/s
[Step=11150 Epoch=106.5] | Loss=0.00028 | Reg=0.00177 | L2-Norm=13.321 | L2-Norm(final)=3.136 | acc=1.0000 | 1794.3 samples/s | 28.0 steps/s
[Step=11200 Epoch=107.0] | Loss=0.00026 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=3.136 | acc=1.0000 | 4515.9 samples/s | 70.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step11200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00013, len=1
[Step=14401 Epoch=137.3] | Loss=0.04570 | Reg=0.00177 | L2-Norm=13.323 | L2-Norm(final)=3.129 | acc=0.9844 | 3832.0 samples/s | 59.9 steps/s
[Step=14450 Epoch=137.7] | Loss=0.00436 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=3.128 | acc=1.0000 | 4254.7 samples/s | 66.5 steps/s
[Step=14500 Epoch=138.2] | Loss=0.00225 | Reg=0.00178 | L2-Norm=13.360 | L2-Norm(final)=3.129 | acc=1.0000 | 5347.9 samples/s | 83.6 steps/s
[Step=14550 Epoch=138.7] | Loss=0.00152 | Reg=0.00178 | L2-Norm=13.360 | L2-Norm(final)=3.130 | acc=1.0000 | 1450.1 samples/s | 22.7 steps/s
[Step=14600 Epoch=139.2] | Loss=0.00115 | Reg=0.00178 | L2-Norm=13.358 | L2-Norm(final)=3.131 | acc=1.0000 | 4516.1 samples/s | 70.6 steps/s
[Step=14650 Epoch=139.6] | Loss=0.00092 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=3.132 | acc=1.0000 | 1542.5 samples/s | 24.1 steps/s
[Step=14700 Epoch=140.1] | Loss=0.00077 | Reg=0.00178 | L2-Norm=13.352 | L2-Norm(final)=3.133 | acc=1.0000 | 5037.9 samples/s | 78.7 steps/s
[Step=14750 Epoch=140.6] | Loss=0.00067 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.134 | acc=1.0000 | 1564.3 samples/s | 24.4 steps/s
[Step=14800 Epoch=141.1] | Loss=0.00059 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.134 | acc=1.0000 | 4704.2 samples/s | 73.5 steps/s
[Step=14850 Epoch=141.5] | Loss=0.00052 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.135 | acc=1.0000 | 1629.7 samples/s | 25.5 steps/s
[Step=14900 Epoch=142.0] | Loss=0.00047 | Reg=0.00178 | L2-Norm=13.337 | L2-Norm(final)=3.135 | acc=1.0000 | 4696.5 samples/s | 73.4 steps/s
[Step=14950 Epoch=142.5] | Loss=0.00043 | Reg=0.00178 | L2-Norm=13.333 | L2-Norm(final)=3.136 | acc=1.0000 | 1560.3 samples/s | 24.4 steps/s
[Step=15000 Epoch=143.0] | Loss=0.00040 | Reg=0.00178 | L2-Norm=13.329 | L2-Norm(final)=3.137 | acc=1.0000 | 4551.1 samples/s | 71.1 steps/s
[Step=15050 Epoch=143.4] | Loss=0.00037 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=3.137 | acc=1.0000 | 1595.4 samples/s | 24.9 steps/s
[Step=15100 Epoch=143.9] | Loss=0.00034 | Reg=0.00177 | L2-Norm=13.320 | L2-Norm(final)=3.138 | acc=1.0000 | 4483.5 samples/s | 70.1 steps/s
[Step=15150 Epoch=144.4] | Loss=0.00032 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.138 | acc=1.0000 | 1566.0 samples/s | 24.5 steps/s
[Step=15200 Epoch=144.9] | Loss=0.00030 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.139 | acc=1.0000 | 3858.3 samples/s | 60.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36392 | acc=0.8066 | tpr=0.7204 | fpr=0.0062 | 4603.9 samples/s | 18.0 steps/s
Avg test loss: 0.36982, Avg test acc: 0.80587, Avg tpr: 0.72116, Avg fpr: 0.00782, total FA: 61

Testing server on iccad2012
[Step=  50] | Loss=0.38966 | acc=0.8805 | tpr=0.9558 | fpr=0.1208 | 4587.6 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.39635 | acc=0.8811 | tpr=0.9638 | fpr=0.1204 | 9190.8 samples/s | 35.9 steps/s
[Step= 150] | Loss=0.40203 | acc=0.8811 | tpr=0.9683 | fpr=0.1205 | 9247.9 samples/s | 36.1 steps/s
[Step= 200] | Loss=0.40534 | acc=0.8808 | tpr=0.9694 | fpr=0.1208 | 8936.2 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.40418 | acc=0.8808 | tpr=0.9668 | fpr=0.1208 | 9537.2 samples/s | 37.3 steps/s
[Step= 300] | Loss=0.40863 | acc=0.8798 | tpr=0.9680 | fpr=0.1218 | 9110.2 samples/s | 35.6 steps/s
[Step= 350] | Loss=0.40980 | acc=0.8797 | tpr=0.9687 | fpr=0.1219 | 9198.5 samples/s | 35.9 steps/s
[Step= 400] | Loss=0.41173 | acc=0.8799 | tpr=0.9688 | fpr=0.1218 | 9161.0 samples/s | 35.8 steps/s
[Step= 450] | Loss=0.41636 | acc=0.8794 | tpr=0.9684 | fpr=0.1222 | 8964.7 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.41519 | acc=0.8790 | tpr=0.9687 | fpr=0.1226 | 9098.5 samples/s | 35.5 steps/s
[Step= 550] | Loss=0.41410 | acc=0.8791 | tpr=0.9666 | fpr=0.1225 | 17662.7 samples/s | 69.0 steps/s
Avg test loss: 0.41407, Avg test acc: 0.87908, Avg tpr: 0.96593, Avg fpr: 0.12249, total FA: 17008

server round 33/50

clients selected: [0 1 3 4 6]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=15201 Epoch=74.1] | Loss=0.42080 | Reg=0.00177 | L2-Norm=13.320 | L2-Norm(final)=3.156 | acc=0.8281 | 4027.3 samples/s | 62.9 steps/s
[Step=15250 Epoch=74.4] | Loss=0.04783 | Reg=0.00178 | L2-Norm=13.338 | L2-Norm(final)=3.142 | acc=0.9844 | 4441.9 samples/s | 69.4 steps/s
[Step=15300 Epoch=74.6] | Loss=0.02987 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=3.140 | acc=1.0000 | 4720.2 samples/s | 73.8 steps/s
[Step=15350 Epoch=74.8] | Loss=0.02384 | Reg=0.00178 | L2-Norm=13.348 | L2-Norm(final)=3.142 | acc=0.9688 | 4658.4 samples/s | 72.8 steps/s
[Step=15400 Epoch=75.1] | Loss=0.02044 | Reg=0.00178 | L2-Norm=13.351 | L2-Norm(final)=3.144 | acc=1.0000 | 5353.7 samples/s | 83.7 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01740 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=3.147 | acc=1.0000 | 1577.8 samples/s | 24.7 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01547 | Reg=0.00178 | L2-Norm=13.358 | L2-Norm(final)=3.150 | acc=0.9844 | 4658.4 samples/s | 72.8 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01407 | Reg=0.00179 | L2-Norm=13.361 | L2-Norm(final)=3.154 | acc=0.9844 | 4691.1 samples/s | 73.3 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01301 | Reg=0.00179 | L2-Norm=13.364 | L2-Norm(final)=3.157 | acc=1.0000 | 5179.5 samples/s | 80.9 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01191 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=3.160 | acc=1.0000 | 1577.3 samples/s | 24.6 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01099 | Reg=0.00179 | L2-Norm=13.369 | L2-Norm(final)=3.164 | acc=1.0000 | 4557.8 samples/s | 71.2 steps/s
[Step=15750 Epoch=76.8] | Loss=0.01046 | Reg=0.00179 | L2-Norm=13.371 | L2-Norm(final)=3.167 | acc=1.0000 | 4678.2 samples/s | 73.1 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01009 | Reg=0.00179 | L2-Norm=13.374 | L2-Norm(final)=3.170 | acc=1.0000 | 5012.1 samples/s | 78.3 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00961 | Reg=0.00179 | L2-Norm=13.376 | L2-Norm(final)=3.173 | acc=1.0000 | 1607.9 samples/s | 25.1 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00916 | Reg=0.00179 | L2-Norm=13.378 | L2-Norm(final)=3.176 | acc=1.0000 | 4554.9 samples/s | 71.2 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00887 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.179 | acc=1.0000 | 4713.6 samples/s | 73.7 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00861 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=3.182 | acc=0.9688 | 4809.2 samples/s | 75.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=12801 Epoch=62.5] | Loss=0.26725 | Reg=0.00177 | L2-Norm=13.320 | L2-Norm(final)=3.156 | acc=0.8438 | 3946.1 samples/s | 61.7 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03721 | Reg=0.00178 | L2-Norm=13.339 | L2-Norm(final)=3.148 | acc=0.9844 | 4535.4 samples/s | 70.9 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02763 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=3.145 | acc=1.0000 | 4692.3 samples/s | 73.3 steps/s
[Step=12950 Epoch=63.2] | Loss=0.02301 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=3.145 | acc=1.0000 | 4652.4 samples/s | 72.7 steps/s
[Step=13000 Epoch=63.4] | Loss=0.01998 | Reg=0.00178 | L2-Norm=13.350 | L2-Norm(final)=3.146 | acc=1.0000 | 5443.3 samples/s | 85.1 steps/s
[Step=13050 Epoch=63.7] | Loss=0.01689 | Reg=0.00178 | L2-Norm=13.353 | L2-Norm(final)=3.149 | acc=1.0000 | 1498.6 samples/s | 23.4 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01521 | Reg=0.00178 | L2-Norm=13.356 | L2-Norm(final)=3.151 | acc=0.9844 | 3940.7 samples/s | 61.6 steps/s
[Step=13150 Epoch=64.2] | Loss=0.01372 | Reg=0.00178 | L2-Norm=13.359 | L2-Norm(final)=3.154 | acc=1.0000 | 3990.1 samples/s | 62.3 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01266 | Reg=0.00179 | L2-Norm=13.362 | L2-Norm(final)=3.158 | acc=1.0000 | 4683.5 samples/s | 73.2 steps/s
[Step=13250 Epoch=64.7] | Loss=0.01161 | Reg=0.00179 | L2-Norm=13.364 | L2-Norm(final)=3.161 | acc=1.0000 | 1604.7 samples/s | 25.1 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01079 | Reg=0.00179 | L2-Norm=13.367 | L2-Norm(final)=3.164 | acc=1.0000 | 4647.8 samples/s | 72.6 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01031 | Reg=0.00179 | L2-Norm=13.369 | L2-Norm(final)=3.167 | acc=0.9844 | 4521.0 samples/s | 70.6 steps/s
[Step=13400 Epoch=65.4] | Loss=0.00977 | Reg=0.00179 | L2-Norm=13.372 | L2-Norm(final)=3.170 | acc=1.0000 | 5214.8 samples/s | 81.5 steps/s
[Step=13450 Epoch=65.6] | Loss=0.00934 | Reg=0.00179 | L2-Norm=13.374 | L2-Norm(final)=3.174 | acc=1.0000 | 1742.8 samples/s | 27.2 steps/s
[Step=13500 Epoch=65.9] | Loss=0.00892 | Reg=0.00179 | L2-Norm=13.376 | L2-Norm(final)=3.177 | acc=1.0000 | 4669.1 samples/s | 73.0 steps/s
[Step=13550 Epoch=66.1] | Loss=0.00860 | Reg=0.00179 | L2-Norm=13.378 | L2-Norm(final)=3.180 | acc=1.0000 | 4589.9 samples/s | 71.7 steps/s
[Step=13600 Epoch=66.4] | Loss=0.00832 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.183 | acc=1.0000 | 5011.2 samples/s | 78.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step13600.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00013, len=1
[Step=11201 Epoch=54.6] | Loss=0.30612 | Reg=0.00177 | L2-Norm=13.320 | L2-Norm(final)=3.156 | acc=0.8594 | 4003.0 samples/s | 62.5 steps/s
[Step=11250 Epoch=54.9] | Loss=0.03493 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.150 | acc=1.0000 | 4471.8 samples/s | 69.9 steps/s
[Step=11300 Epoch=55.1] | Loss=0.02457 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=3.150 | acc=1.0000 | 4739.1 samples/s | 74.0 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02101 | Reg=0.00178 | L2-Norm=13.351 | L2-Norm(final)=3.151 | acc=1.0000 | 4522.1 samples/s | 70.7 steps/s
[Step=11400 Epoch=55.6] | Loss=0.01907 | Reg=0.00178 | L2-Norm=13.354 | L2-Norm(final)=3.152 | acc=1.0000 | 5280.5 samples/s | 82.5 steps/s
[Step=11450 Epoch=55.8] | Loss=0.01602 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=3.154 | acc=1.0000 | 1495.5 samples/s | 23.4 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01460 | Reg=0.00178 | L2-Norm=13.360 | L2-Norm(final)=3.156 | acc=1.0000 | 3978.0 samples/s | 62.2 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01328 | Reg=0.00179 | L2-Norm=13.362 | L2-Norm(final)=3.159 | acc=1.0000 | 3966.6 samples/s | 62.0 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01225 | Reg=0.00179 | L2-Norm=13.365 | L2-Norm(final)=3.161 | acc=1.0000 | 4676.8 samples/s | 73.1 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01137 | Reg=0.00179 | L2-Norm=13.368 | L2-Norm(final)=3.164 | acc=1.0000 | 1618.0 samples/s | 25.3 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01055 | Reg=0.00179 | L2-Norm=13.370 | L2-Norm(final)=3.168 | acc=1.0000 | 4563.9 samples/s | 71.3 steps/s
[Step=11750 Epoch=57.3] | Loss=0.00996 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=3.171 | acc=0.9844 | 4495.8 samples/s | 70.2 steps/s
[Step=11800 Epoch=57.5] | Loss=0.00954 | Reg=0.00179 | L2-Norm=13.375 | L2-Norm(final)=3.174 | acc=1.0000 | 5119.2 samples/s | 80.0 steps/s
[Step=11850 Epoch=57.8] | Loss=0.00909 | Reg=0.00179 | L2-Norm=13.378 | L2-Norm(final)=3.177 | acc=1.0000 | 1616.1 samples/s | 25.3 steps/s
[Step=11900 Epoch=58.0] | Loss=0.00865 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.180 | acc=1.0000 | 4469.7 samples/s | 69.8 steps/s
[Step=11950 Epoch=58.3] | Loss=0.00831 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=3.183 | acc=1.0000 | 4551.2 samples/s | 71.1 steps/s
[Step=12000 Epoch=58.5] | Loss=0.00811 | Reg=0.00179 | L2-Norm=13.384 | L2-Norm(final)=3.185 | acc=1.0000 | 4931.5 samples/s | 77.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step12000.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00013, len=1
[Step=12801 Epoch=62.8] | Loss=0.25538 | Reg=0.00177 | L2-Norm=13.320 | L2-Norm(final)=3.157 | acc=0.8281 | 3333.2 samples/s | 52.1 steps/s
[Step=12850 Epoch=63.0] | Loss=0.03631 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.150 | acc=0.9375 | 4483.4 samples/s | 70.1 steps/s
[Step=12900 Epoch=63.3] | Loss=0.02750 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.147 | acc=0.9688 | 4579.6 samples/s | 71.6 steps/s
[Step=12950 Epoch=63.5] | Loss=0.02371 | Reg=0.00178 | L2-Norm=13.348 | L2-Norm(final)=3.147 | acc=0.9531 | 4645.8 samples/s | 72.6 steps/s
[Step=13000 Epoch=63.7] | Loss=0.02115 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.147 | acc=0.9688 | 5444.0 samples/s | 85.1 steps/s
[Step=13050 Epoch=64.0] | Loss=0.01818 | Reg=0.00178 | L2-Norm=13.352 | L2-Norm(final)=3.149 | acc=1.0000 | 1572.2 samples/s | 24.6 steps/s
[Step=13100 Epoch=64.2] | Loss=0.01588 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=3.151 | acc=1.0000 | 4648.4 samples/s | 72.6 steps/s
[Step=13150 Epoch=64.5] | Loss=0.01444 | Reg=0.00178 | L2-Norm=13.358 | L2-Norm(final)=3.154 | acc=1.0000 | 4571.4 samples/s | 71.4 steps/s
[Step=13200 Epoch=64.7] | Loss=0.01340 | Reg=0.00179 | L2-Norm=13.361 | L2-Norm(final)=3.157 | acc=1.0000 | 5364.0 samples/s | 83.8 steps/s
[Step=13250 Epoch=65.0] | Loss=0.01235 | Reg=0.00179 | L2-Norm=13.363 | L2-Norm(final)=3.160 | acc=1.0000 | 1596.1 samples/s | 24.9 steps/s
[Step=13300 Epoch=65.2] | Loss=0.01153 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=3.163 | acc=1.0000 | 4584.3 samples/s | 71.6 steps/s
[Step=13350 Epoch=65.5] | Loss=0.01086 | Reg=0.00179 | L2-Norm=13.368 | L2-Norm(final)=3.166 | acc=1.0000 | 4529.2 samples/s | 70.8 steps/s
[Step=13400 Epoch=65.7] | Loss=0.01030 | Reg=0.00179 | L2-Norm=13.371 | L2-Norm(final)=3.169 | acc=1.0000 | 5033.5 samples/s | 78.6 steps/s
[Step=13450 Epoch=66.0] | Loss=0.00969 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=3.172 | acc=1.0000 | 1515.4 samples/s | 23.7 steps/s
[Step=13500 Epoch=66.2] | Loss=0.00921 | Reg=0.00179 | L2-Norm=13.375 | L2-Norm(final)=3.175 | acc=1.0000 | 3899.5 samples/s | 60.9 steps/s
[Step=13550 Epoch=66.4] | Loss=0.00882 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=3.178 | acc=1.0000 | 3998.2 samples/s | 62.5 steps/s
[Step=13600 Epoch=66.7] | Loss=0.00858 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.181 | acc=0.9844 | 4484.9 samples/s | 70.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step13600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=14401 Epoch=137.0] | Loss=0.00663 | Reg=0.00177 | L2-Norm=13.320 | L2-Norm(final)=3.157 | acc=1.0000 | 3436.4 samples/s | 53.7 steps/s
[Step=14450 Epoch=137.5] | Loss=0.00383 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=3.161 | acc=1.0000 | 4186.3 samples/s | 65.4 steps/s
[Step=14500 Epoch=137.9] | Loss=0.00206 | Reg=0.00179 | L2-Norm=13.362 | L2-Norm(final)=3.163 | acc=1.0000 | 5309.3 samples/s | 83.0 steps/s
[Step=14550 Epoch=138.4] | Loss=0.00140 | Reg=0.00179 | L2-Norm=13.364 | L2-Norm(final)=3.164 | acc=1.0000 | 1539.0 samples/s | 24.0 steps/s
[Step=14600 Epoch=138.9] | Loss=0.00106 | Reg=0.00179 | L2-Norm=13.363 | L2-Norm(final)=3.166 | acc=1.0000 | 5035.3 samples/s | 78.7 steps/s
[Step=14650 Epoch=139.4] | Loss=0.00086 | Reg=0.00179 | L2-Norm=13.361 | L2-Norm(final)=3.167 | acc=1.0000 | 1541.5 samples/s | 24.1 steps/s
[Step=14700 Epoch=139.8] | Loss=0.00072 | Reg=0.00178 | L2-Norm=13.359 | L2-Norm(final)=3.167 | acc=1.0000 | 4813.2 samples/s | 75.2 steps/s
[Step=14750 Epoch=140.3] | Loss=0.00062 | Reg=0.00178 | L2-Norm=13.356 | L2-Norm(final)=3.168 | acc=1.0000 | 1562.5 samples/s | 24.4 steps/s
[Step=14800 Epoch=140.8] | Loss=0.00054 | Reg=0.00178 | L2-Norm=13.354 | L2-Norm(final)=3.169 | acc=1.0000 | 4694.9 samples/s | 73.4 steps/s
[Step=14850 Epoch=141.3] | Loss=0.00048 | Reg=0.00178 | L2-Norm=13.351 | L2-Norm(final)=3.169 | acc=1.0000 | 1586.0 samples/s | 24.8 steps/s
[Step=14900 Epoch=141.7] | Loss=0.00044 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=3.170 | acc=1.0000 | 4620.6 samples/s | 72.2 steps/s
[Step=14950 Epoch=142.2] | Loss=0.00040 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=3.170 | acc=1.0000 | 1617.5 samples/s | 25.3 steps/s
[Step=15000 Epoch=142.7] | Loss=0.00037 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.171 | acc=1.0000 | 4570.2 samples/s | 71.4 steps/s
[Step=15050 Epoch=143.2] | Loss=0.00034 | Reg=0.00178 | L2-Norm=13.337 | L2-Norm(final)=3.171 | acc=1.0000 | 1623.6 samples/s | 25.4 steps/s
[Step=15100 Epoch=143.6] | Loss=0.00032 | Reg=0.00178 | L2-Norm=13.334 | L2-Norm(final)=3.171 | acc=1.0000 | 4484.3 samples/s | 70.1 steps/s
[Step=15150 Epoch=144.1] | Loss=0.00030 | Reg=0.00178 | L2-Norm=13.330 | L2-Norm(final)=3.172 | acc=1.0000 | 1750.6 samples/s | 27.4 steps/s
[Step=15200 Epoch=144.6] | Loss=0.00028 | Reg=0.00178 | L2-Norm=13.326 | L2-Norm(final)=3.172 | acc=1.0000 | 3820.8 samples/s | 59.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37488 | acc=0.8021 | tpr=0.7139 | fpr=0.0064 | 4552.2 samples/s | 17.8 steps/s
Avg test loss: 0.38139, Avg test acc: 0.80087, Avg tpr: 0.71394, Avg fpr: 0.00795, total FA: 62

Testing server on iccad2012
[Step=  50] | Loss=0.38107 | acc=0.8879 | tpr=0.9602 | fpr=0.1134 | 4529.2 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.38846 | acc=0.8889 | tpr=0.9659 | fpr=0.1126 | 9312.8 samples/s | 36.4 steps/s
[Step= 150] | Loss=0.39425 | acc=0.8891 | tpr=0.9697 | fpr=0.1124 | 9431.6 samples/s | 36.8 steps/s
[Step= 200] | Loss=0.39743 | acc=0.8887 | tpr=0.9705 | fpr=0.1128 | 8828.3 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.39611 | acc=0.8885 | tpr=0.9677 | fpr=0.1130 | 9379.5 samples/s | 36.6 steps/s
[Step= 300] | Loss=0.40052 | acc=0.8872 | tpr=0.9695 | fpr=0.1143 | 9451.9 samples/s | 36.9 steps/s
[Step= 350] | Loss=0.40184 | acc=0.8871 | tpr=0.9699 | fpr=0.1144 | 8842.7 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.40386 | acc=0.8871 | tpr=0.9699 | fpr=0.1144 | 9165.8 samples/s | 35.8 steps/s
[Step= 450] | Loss=0.40859 | acc=0.8864 | tpr=0.9693 | fpr=0.1151 | 9291.8 samples/s | 36.3 steps/s
[Step= 500] | Loss=0.40732 | acc=0.8861 | tpr=0.9705 | fpr=0.1154 | 8915.4 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.40616 | acc=0.8862 | tpr=0.9690 | fpr=0.1153 | 17702.7 samples/s | 69.2 steps/s
Avg test loss: 0.40609, Avg test acc: 0.88623, Avg tpr: 0.96830, Avg fpr: 0.11526, total FA: 16004

server round 34/50

clients selected: [0 1 4 6 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=16001 Epoch=78.0] | Loss=0.11277 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.183 | acc=0.9219 | 3873.2 samples/s | 60.5 steps/s
[Step=16050 Epoch=78.3] | Loss=0.03428 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=3.179 | acc=0.9844 | 4651.5 samples/s | 72.7 steps/s
[Step=16100 Epoch=78.5] | Loss=0.02413 | Reg=0.00178 | L2-Norm=13.324 | L2-Norm(final)=3.178 | acc=0.9688 | 4720.3 samples/s | 73.8 steps/s
[Step=16150 Epoch=78.8] | Loss=0.02014 | Reg=0.00178 | L2-Norm=13.328 | L2-Norm(final)=3.179 | acc=0.9688 | 4583.4 samples/s | 71.6 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01705 | Reg=0.00178 | L2-Norm=13.331 | L2-Norm(final)=3.182 | acc=0.9844 | 5408.1 samples/s | 84.5 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01460 | Reg=0.00178 | L2-Norm=13.335 | L2-Norm(final)=3.186 | acc=1.0000 | 1603.6 samples/s | 25.1 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01292 | Reg=0.00178 | L2-Norm=13.338 | L2-Norm(final)=3.189 | acc=1.0000 | 4611.0 samples/s | 72.0 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01191 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.193 | acc=0.9844 | 4709.1 samples/s | 73.6 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01139 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=3.196 | acc=0.9844 | 5276.1 samples/s | 82.4 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01084 | Reg=0.00178 | L2-Norm=13.346 | L2-Norm(final)=3.199 | acc=1.0000 | 1527.5 samples/s | 23.9 steps/s
[Step=16500 Epoch=80.5] | Loss=0.01021 | Reg=0.00178 | L2-Norm=13.348 | L2-Norm(final)=3.202 | acc=1.0000 | 3947.4 samples/s | 61.7 steps/s
[Step=16550 Epoch=80.7] | Loss=0.00979 | Reg=0.00178 | L2-Norm=13.351 | L2-Norm(final)=3.205 | acc=1.0000 | 3911.8 samples/s | 61.1 steps/s
[Step=16600 Epoch=80.9] | Loss=0.00931 | Reg=0.00178 | L2-Norm=13.353 | L2-Norm(final)=3.208 | acc=1.0000 | 4455.1 samples/s | 69.6 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00897 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=3.211 | acc=1.0000 | 1603.6 samples/s | 25.1 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00864 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=3.213 | acc=1.0000 | 4688.8 samples/s | 73.3 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00830 | Reg=0.00178 | L2-Norm=13.359 | L2-Norm(final)=3.216 | acc=1.0000 | 4749.1 samples/s | 74.2 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00801 | Reg=0.00178 | L2-Norm=13.360 | L2-Norm(final)=3.219 | acc=1.0000 | 5009.7 samples/s | 78.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=13601 Epoch=66.4] | Loss=0.23780 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.183 | acc=0.8281 | 4133.5 samples/s | 64.6 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03876 | Reg=0.00177 | L2-Norm=13.312 | L2-Norm(final)=3.171 | acc=1.0000 | 4354.8 samples/s | 68.0 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02821 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.169 | acc=0.9844 | 4529.3 samples/s | 70.8 steps/s
[Step=13750 Epoch=67.1] | Loss=0.02288 | Reg=0.00177 | L2-Norm=13.320 | L2-Norm(final)=3.170 | acc=0.9844 | 4602.8 samples/s | 71.9 steps/s
[Step=13800 Epoch=67.3] | Loss=0.02021 | Reg=0.00178 | L2-Norm=13.323 | L2-Norm(final)=3.172 | acc=0.9844 | 5499.8 samples/s | 85.9 steps/s
[Step=13850 Epoch=67.6] | Loss=0.01739 | Reg=0.00178 | L2-Norm=13.327 | L2-Norm(final)=3.175 | acc=0.9844 | 1560.5 samples/s | 24.4 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01547 | Reg=0.00178 | L2-Norm=13.330 | L2-Norm(final)=3.178 | acc=1.0000 | 4611.0 samples/s | 72.0 steps/s
[Step=13950 Epoch=68.1] | Loss=0.01406 | Reg=0.00178 | L2-Norm=13.333 | L2-Norm(final)=3.181 | acc=1.0000 | 4650.8 samples/s | 72.7 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01282 | Reg=0.00178 | L2-Norm=13.336 | L2-Norm(final)=3.184 | acc=0.9688 | 5199.8 samples/s | 81.2 steps/s
[Step=14050 Epoch=68.6] | Loss=0.01194 | Reg=0.00178 | L2-Norm=13.339 | L2-Norm(final)=3.187 | acc=1.0000 | 1577.4 samples/s | 24.6 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01121 | Reg=0.00178 | L2-Norm=13.342 | L2-Norm(final)=3.191 | acc=1.0000 | 4588.8 samples/s | 71.7 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01058 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=3.194 | acc=1.0000 | 4712.4 samples/s | 73.6 steps/s
[Step=14200 Epoch=69.3] | Loss=0.00996 | Reg=0.00178 | L2-Norm=13.346 | L2-Norm(final)=3.197 | acc=0.9844 | 5150.8 samples/s | 80.5 steps/s
[Step=14250 Epoch=69.5] | Loss=0.00951 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.200 | acc=1.0000 | 1605.9 samples/s | 25.1 steps/s
[Step=14300 Epoch=69.8] | Loss=0.00904 | Reg=0.00178 | L2-Norm=13.351 | L2-Norm(final)=3.203 | acc=1.0000 | 4702.5 samples/s | 73.5 steps/s
[Step=14350 Epoch=70.0] | Loss=0.00869 | Reg=0.00178 | L2-Norm=13.353 | L2-Norm(final)=3.206 | acc=1.0000 | 4608.6 samples/s | 72.0 steps/s
[Step=14400 Epoch=70.3] | Loss=0.00853 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=3.208 | acc=1.0000 | 4923.8 samples/s | 76.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step14400.h5

Train client 4: client_asml1_4
Restoring client from server.
LR=0.00013, len=1
[Step=13601 Epoch=66.7] | Loss=0.26545 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.183 | acc=0.8594 | 3232.6 samples/s | 50.5 steps/s
[Step=13650 Epoch=66.9] | Loss=0.03689 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.175 | acc=1.0000 | 4696.4 samples/s | 73.4 steps/s
[Step=13700 Epoch=67.2] | Loss=0.02584 | Reg=0.00177 | L2-Norm=13.312 | L2-Norm(final)=3.175 | acc=0.9844 | 4623.2 samples/s | 72.2 steps/s
[Step=13750 Epoch=67.4] | Loss=0.02140 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.176 | acc=1.0000 | 4557.0 samples/s | 71.2 steps/s
[Step=13800 Epoch=67.7] | Loss=0.01930 | Reg=0.00177 | L2-Norm=13.320 | L2-Norm(final)=3.178 | acc=1.0000 | 5344.3 samples/s | 83.5 steps/s
[Step=13850 Epoch=67.9] | Loss=0.01660 | Reg=0.00178 | L2-Norm=13.323 | L2-Norm(final)=3.181 | acc=1.0000 | 1554.0 samples/s | 24.3 steps/s
[Step=13900 Epoch=68.2] | Loss=0.01467 | Reg=0.00178 | L2-Norm=13.327 | L2-Norm(final)=3.184 | acc=0.9844 | 4663.4 samples/s | 72.9 steps/s
[Step=13950 Epoch=68.4] | Loss=0.01360 | Reg=0.00178 | L2-Norm=13.330 | L2-Norm(final)=3.187 | acc=0.9844 | 4648.5 samples/s | 72.6 steps/s
[Step=14000 Epoch=68.7] | Loss=0.01251 | Reg=0.00178 | L2-Norm=13.333 | L2-Norm(final)=3.190 | acc=1.0000 | 5204.5 samples/s | 81.3 steps/s
[Step=14050 Epoch=68.9] | Loss=0.01156 | Reg=0.00178 | L2-Norm=13.336 | L2-Norm(final)=3.193 | acc=1.0000 | 1580.8 samples/s | 24.7 steps/s
[Step=14100 Epoch=69.1] | Loss=0.01088 | Reg=0.00178 | L2-Norm=13.338 | L2-Norm(final)=3.197 | acc=1.0000 | 4689.0 samples/s | 73.3 steps/s
[Step=14150 Epoch=69.4] | Loss=0.01026 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.200 | acc=1.0000 | 4632.6 samples/s | 72.4 steps/s
[Step=14200 Epoch=69.6] | Loss=0.00975 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=3.203 | acc=1.0000 | 5313.9 samples/s | 83.0 steps/s
[Step=14250 Epoch=69.9] | Loss=0.00923 | Reg=0.00178 | L2-Norm=13.346 | L2-Norm(final)=3.206 | acc=1.0000 | 1600.3 samples/s | 25.0 steps/s
[Step=14300 Epoch=70.1] | Loss=0.00879 | Reg=0.00178 | L2-Norm=13.348 | L2-Norm(final)=3.209 | acc=1.0000 | 4636.6 samples/s | 72.4 steps/s
[Step=14350 Epoch=70.4] | Loss=0.00851 | Reg=0.00178 | L2-Norm=13.350 | L2-Norm(final)=3.211 | acc=0.9844 | 4680.4 samples/s | 73.1 steps/s
[Step=14400 Epoch=70.6] | Loss=0.00818 | Reg=0.00178 | L2-Norm=13.352 | L2-Norm(final)=3.214 | acc=1.0000 | 5028.2 samples/s | 78.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_4/client_state-step14400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=15201 Epoch=144.6] | Loss=0.00223 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.183 | acc=1.0000 | 3325.1 samples/s | 52.0 steps/s
[Step=15250 Epoch=145.1] | Loss=0.00771 | Reg=0.00177 | L2-Norm=13.322 | L2-Norm(final)=3.179 | acc=1.0000 | 4309.5 samples/s | 67.3 steps/s
[Step=15300 Epoch=145.5] | Loss=0.00392 | Reg=0.00178 | L2-Norm=13.330 | L2-Norm(final)=3.179 | acc=1.0000 | 5270.7 samples/s | 82.4 steps/s
[Step=15350 Epoch=146.0] | Loss=0.00263 | Reg=0.00178 | L2-Norm=13.332 | L2-Norm(final)=3.180 | acc=1.0000 | 1535.8 samples/s | 24.0 steps/s
[Step=15400 Epoch=146.5] | Loss=0.00198 | Reg=0.00178 | L2-Norm=13.332 | L2-Norm(final)=3.180 | acc=1.0000 | 5023.1 samples/s | 78.5 steps/s
[Step=15450 Epoch=147.0] | Loss=0.00160 | Reg=0.00178 | L2-Norm=13.331 | L2-Norm(final)=3.181 | acc=1.0000 | 1538.4 samples/s | 24.0 steps/s
[Step=15500 Epoch=147.4] | Loss=0.00133 | Reg=0.00178 | L2-Norm=13.329 | L2-Norm(final)=3.181 | acc=1.0000 | 4885.0 samples/s | 76.3 steps/s
[Step=15550 Epoch=147.9] | Loss=0.00115 | Reg=0.00178 | L2-Norm=13.327 | L2-Norm(final)=3.182 | acc=1.0000 | 1561.2 samples/s | 24.4 steps/s
[Step=15600 Epoch=148.4] | Loss=0.00101 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=3.182 | acc=1.0000 | 4745.5 samples/s | 74.1 steps/s
[Step=15650 Epoch=148.9] | Loss=0.00090 | Reg=0.00178 | L2-Norm=13.323 | L2-Norm(final)=3.183 | acc=1.0000 | 1537.3 samples/s | 24.0 steps/s
[Step=15700 Epoch=149.3] | Loss=0.00081 | Reg=0.00177 | L2-Norm=13.321 | L2-Norm(final)=3.183 | acc=1.0000 | 3876.1 samples/s | 60.6 steps/s
[Step=15750 Epoch=149.8] | Loss=0.00074 | Reg=0.00177 | L2-Norm=13.318 | L2-Norm(final)=3.183 | acc=1.0000 | 1613.7 samples/s | 25.2 steps/s
[Step=15800 Epoch=150.3] | Loss=0.00068 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.184 | acc=1.0000 | 4412.2 samples/s | 68.9 steps/s
[Step=15850 Epoch=150.8] | Loss=0.00063 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.184 | acc=1.0000 | 1620.0 samples/s | 25.3 steps/s
[Step=15900 Epoch=151.2] | Loss=0.00058 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.185 | acc=1.0000 | 4503.9 samples/s | 70.4 steps/s
[Step=15950 Epoch=151.7] | Loss=0.00054 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.185 | acc=1.0000 | 1633.5 samples/s | 25.5 steps/s
[Step=16000 Epoch=152.2] | Loss=0.00051 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.185 | acc=1.0000 | 4297.2 samples/s | 67.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step16000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00013, len=1
[Step=15201 Epoch=144.9] | Loss=0.01073 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.183 | acc=1.0000 | 4051.6 samples/s | 63.3 steps/s
[Step=15250 Epoch=145.3] | Loss=0.00296 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=3.187 | acc=1.0000 | 4125.7 samples/s | 64.5 steps/s
[Step=15300 Epoch=145.8] | Loss=0.00152 | Reg=0.00178 | L2-Norm=13.329 | L2-Norm(final)=3.188 | acc=1.0000 | 5313.9 samples/s | 83.0 steps/s
[Step=15350 Epoch=146.3] | Loss=0.00102 | Reg=0.00178 | L2-Norm=13.327 | L2-Norm(final)=3.189 | acc=1.0000 | 1518.1 samples/s | 23.7 steps/s
[Step=15400 Epoch=146.8] | Loss=0.00077 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=3.190 | acc=1.0000 | 5085.6 samples/s | 79.5 steps/s
[Step=15450 Epoch=147.3] | Loss=0.00062 | Reg=0.00177 | L2-Norm=13.321 | L2-Norm(final)=3.191 | acc=1.0000 | 1545.4 samples/s | 24.1 steps/s
[Step=15500 Epoch=147.7] | Loss=0.00052 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=3.191 | acc=1.0000 | 4959.7 samples/s | 77.5 steps/s
[Step=15550 Epoch=148.2] | Loss=0.00045 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.192 | acc=1.0000 | 1578.0 samples/s | 24.7 steps/s
[Step=15600 Epoch=148.7] | Loss=0.00040 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=3.193 | acc=1.0000 | 4860.4 samples/s | 75.9 steps/s
[Step=15650 Epoch=149.2] | Loss=0.00035 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=3.193 | acc=1.0000 | 1508.9 samples/s | 23.6 steps/s
[Step=15700 Epoch=149.6] | Loss=0.00032 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.194 | acc=1.0000 | 4009.0 samples/s | 62.6 steps/s
[Step=15750 Epoch=150.1] | Loss=0.00029 | Reg=0.00177 | L2-Norm=13.295 | L2-Norm(final)=3.194 | acc=1.0000 | 1608.6 samples/s | 25.1 steps/s
[Step=15800 Epoch=150.6] | Loss=0.00027 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.195 | acc=1.0000 | 4637.8 samples/s | 72.5 steps/s
[Step=15850 Epoch=151.1] | Loss=0.00025 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.195 | acc=1.0000 | 1588.8 samples/s | 24.8 steps/s
[Step=15900 Epoch=151.5] | Loss=0.00023 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.196 | acc=1.0000 | 4540.1 samples/s | 70.9 steps/s
[Step=15950 Epoch=152.0] | Loss=0.00022 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.196 | acc=1.0000 | 1682.1 samples/s | 26.3 steps/s
[Step=16000 Epoch=152.5] | Loss=0.00020 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.197 | acc=1.0000 | 4468.1 samples/s | 69.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38211 | acc=0.8002 | tpr=0.7112 | fpr=0.0064 | 4518.5 samples/s | 17.7 steps/s
Avg test loss: 0.38863, Avg test acc: 0.79874, Avg tpr: 0.71079, Avg fpr: 0.00782, total FA: 61

Testing server on iccad2012
[Step=  50] | Loss=0.37289 | acc=0.8923 | tpr=0.9602 | fpr=0.1090 | 4636.7 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.38025 | acc=0.8932 | tpr=0.9659 | fpr=0.1081 | 8807.9 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.38609 | acc=0.8931 | tpr=0.9697 | fpr=0.1083 | 9462.4 samples/s | 37.0 steps/s
[Step= 200] | Loss=0.38915 | acc=0.8929 | tpr=0.9705 | fpr=0.1086 | 9220.7 samples/s | 36.0 steps/s
[Step= 250] | Loss=0.38790 | acc=0.8927 | tpr=0.9677 | fpr=0.1087 | 9185.5 samples/s | 35.9 steps/s
[Step= 300] | Loss=0.39233 | acc=0.8914 | tpr=0.9687 | fpr=0.1100 | 9239.7 samples/s | 36.1 steps/s
[Step= 350] | Loss=0.39376 | acc=0.8916 | tpr=0.9693 | fpr=0.1098 | 9320.1 samples/s | 36.4 steps/s
[Step= 400] | Loss=0.39594 | acc=0.8914 | tpr=0.9699 | fpr=0.1100 | 9120.3 samples/s | 35.6 steps/s
[Step= 450] | Loss=0.40067 | acc=0.8909 | tpr=0.9693 | fpr=0.1105 | 8245.8 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.39943 | acc=0.8905 | tpr=0.9705 | fpr=0.1109 | 8274.9 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.39821 | acc=0.8906 | tpr=0.9682 | fpr=0.1108 | 16937.6 samples/s | 66.2 steps/s
Avg test loss: 0.39813, Avg test acc: 0.89063, Avg tpr: 0.96751, Avg fpr: 0.11077, total FA: 15380

server round 35/50

clients selected: [1 2 5 7 8]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=14401 Epoch=70.3] | Loss=0.28684 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.198 | acc=0.8594 | 3947.8 samples/s | 61.7 steps/s
[Step=14450 Epoch=70.5] | Loss=0.03215 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=3.194 | acc=1.0000 | 4589.5 samples/s | 71.7 steps/s
[Step=14500 Epoch=70.8] | Loss=0.02402 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=3.192 | acc=0.9844 | 4613.9 samples/s | 72.1 steps/s
[Step=14550 Epoch=71.0] | Loss=0.02027 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=3.193 | acc=0.9844 | 4496.5 samples/s | 70.3 steps/s
[Step=14600 Epoch=71.2] | Loss=0.01816 | Reg=0.00177 | L2-Norm=13.312 | L2-Norm(final)=3.195 | acc=1.0000 | 5512.2 samples/s | 86.1 steps/s
[Step=14650 Epoch=71.5] | Loss=0.01563 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.197 | acc=0.9844 | 1566.5 samples/s | 24.5 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01396 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=3.200 | acc=1.0000 | 4729.2 samples/s | 73.9 steps/s
[Step=14750 Epoch=72.0] | Loss=0.01274 | Reg=0.00177 | L2-Norm=13.322 | L2-Norm(final)=3.203 | acc=1.0000 | 4616.5 samples/s | 72.1 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01187 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=3.207 | acc=1.0000 | 5224.4 samples/s | 81.6 steps/s
[Step=14850 Epoch=72.5] | Loss=0.01103 | Reg=0.00178 | L2-Norm=13.328 | L2-Norm(final)=3.210 | acc=1.0000 | 1576.6 samples/s | 24.6 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01023 | Reg=0.00178 | L2-Norm=13.330 | L2-Norm(final)=3.213 | acc=1.0000 | 4746.0 samples/s | 74.2 steps/s
[Step=14950 Epoch=72.9] | Loss=0.00971 | Reg=0.00178 | L2-Norm=13.333 | L2-Norm(final)=3.216 | acc=1.0000 | 4595.2 samples/s | 71.8 steps/s
[Step=15000 Epoch=73.2] | Loss=0.00931 | Reg=0.00178 | L2-Norm=13.335 | L2-Norm(final)=3.219 | acc=1.0000 | 5111.9 samples/s | 79.9 steps/s
[Step=15050 Epoch=73.4] | Loss=0.00891 | Reg=0.00178 | L2-Norm=13.337 | L2-Norm(final)=3.222 | acc=1.0000 | 1585.0 samples/s | 24.8 steps/s
[Step=15100 Epoch=73.7] | Loss=0.00853 | Reg=0.00178 | L2-Norm=13.339 | L2-Norm(final)=3.225 | acc=1.0000 | 4677.6 samples/s | 73.1 steps/s
[Step=15150 Epoch=73.9] | Loss=0.00819 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.228 | acc=1.0000 | 4547.3 samples/s | 71.1 steps/s
[Step=15200 Epoch=74.2] | Loss=0.00795 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=3.231 | acc=1.0000 | 4463.1 samples/s | 69.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step15200.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00013, len=1
[Step=13601 Epoch=66.3] | Loss=0.33189 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.198 | acc=0.8438 | 3490.5 samples/s | 54.5 steps/s
[Step=13650 Epoch=66.5] | Loss=0.04007 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.189 | acc=0.9688 | 4046.3 samples/s | 63.2 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02896 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.186 | acc=1.0000 | 4520.8 samples/s | 70.6 steps/s
[Step=13750 Epoch=67.0] | Loss=0.02362 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.186 | acc=1.0000 | 4711.6 samples/s | 73.6 steps/s
[Step=13800 Epoch=67.2] | Loss=0.02032 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.188 | acc=0.9844 | 5458.6 samples/s | 85.3 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01783 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.191 | acc=1.0000 | 1575.7 samples/s | 24.6 steps/s
[Step=13900 Epoch=67.7] | Loss=0.01583 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.194 | acc=1.0000 | 4704.9 samples/s | 73.5 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01436 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=3.197 | acc=1.0000 | 4670.2 samples/s | 73.0 steps/s
[Step=14000 Epoch=68.2] | Loss=0.01331 | Reg=0.00177 | L2-Norm=13.322 | L2-Norm(final)=3.201 | acc=1.0000 | 5255.5 samples/s | 82.1 steps/s
[Step=14050 Epoch=68.5] | Loss=0.01228 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=3.204 | acc=1.0000 | 1596.6 samples/s | 24.9 steps/s
[Step=14100 Epoch=68.7] | Loss=0.01163 | Reg=0.00178 | L2-Norm=13.328 | L2-Norm(final)=3.207 | acc=1.0000 | 4499.3 samples/s | 70.3 steps/s
[Step=14150 Epoch=68.9] | Loss=0.01095 | Reg=0.00178 | L2-Norm=13.331 | L2-Norm(final)=3.211 | acc=1.0000 | 4655.3 samples/s | 72.7 steps/s
[Step=14200 Epoch=69.2] | Loss=0.01065 | Reg=0.00178 | L2-Norm=13.333 | L2-Norm(final)=3.214 | acc=1.0000 | 4992.6 samples/s | 78.0 steps/s
[Step=14250 Epoch=69.4] | Loss=0.01007 | Reg=0.00178 | L2-Norm=13.336 | L2-Norm(final)=3.217 | acc=1.0000 | 1630.4 samples/s | 25.5 steps/s
[Step=14300 Epoch=69.7] | Loss=0.00971 | Reg=0.00178 | L2-Norm=13.338 | L2-Norm(final)=3.220 | acc=1.0000 | 4614.6 samples/s | 72.1 steps/s
[Step=14350 Epoch=69.9] | Loss=0.00929 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.224 | acc=1.0000 | 4735.0 samples/s | 74.0 steps/s
[Step=14400 Epoch=70.2] | Loss=0.00895 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=3.227 | acc=1.0000 | 4723.4 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step14400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=15201 Epoch=144.0] | Loss=0.14579 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.199 | acc=0.9531 | 3460.1 samples/s | 54.1 steps/s
[Step=15250 Epoch=144.5] | Loss=0.00463 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=3.198 | acc=1.0000 | 3827.6 samples/s | 59.8 steps/s
[Step=15300 Epoch=145.0] | Loss=0.00241 | Reg=0.00177 | L2-Norm=13.314 | L2-Norm(final)=3.199 | acc=1.0000 | 5145.6 samples/s | 80.4 steps/s
[Step=15350 Epoch=145.5] | Loss=0.00162 | Reg=0.00177 | L2-Norm=13.314 | L2-Norm(final)=3.200 | acc=1.0000 | 1546.7 samples/s | 24.2 steps/s
[Step=15400 Epoch=145.9] | Loss=0.00122 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.201 | acc=1.0000 | 4973.3 samples/s | 77.7 steps/s
[Step=15450 Epoch=146.4] | Loss=0.00098 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.202 | acc=1.0000 | 1538.3 samples/s | 24.0 steps/s
[Step=15500 Epoch=146.9] | Loss=0.00082 | Reg=0.00177 | L2-Norm=13.308 | L2-Norm(final)=3.202 | acc=1.0000 | 4903.7 samples/s | 76.6 steps/s
[Step=15550 Epoch=147.3] | Loss=0.00071 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=3.203 | acc=1.0000 | 1559.2 samples/s | 24.4 steps/s
[Step=15600 Epoch=147.8] | Loss=0.00062 | Reg=0.00177 | L2-Norm=13.302 | L2-Norm(final)=3.204 | acc=1.0000 | 4566.0 samples/s | 71.3 steps/s
[Step=15650 Epoch=148.3] | Loss=0.00055 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.204 | acc=1.0000 | 1590.2 samples/s | 24.8 steps/s
[Step=15700 Epoch=148.8] | Loss=0.00050 | Reg=0.00177 | L2-Norm=13.295 | L2-Norm(final)=3.205 | acc=1.0000 | 4560.8 samples/s | 71.3 steps/s
[Step=15750 Epoch=149.2] | Loss=0.00046 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.205 | acc=1.0000 | 1589.3 samples/s | 24.8 steps/s
[Step=15800 Epoch=149.7] | Loss=0.00042 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.206 | acc=1.0000 | 4438.6 samples/s | 69.4 steps/s
[Step=15850 Epoch=150.2] | Loss=0.00039 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.206 | acc=1.0000 | 1601.3 samples/s | 25.0 steps/s
[Step=15900 Epoch=150.7] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.207 | acc=1.0000 | 4558.7 samples/s | 71.2 steps/s
[Step=15950 Epoch=151.1] | Loss=0.00034 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.207 | acc=1.0000 | 1631.6 samples/s | 25.5 steps/s
[Step=16000 Epoch=151.6] | Loss=0.00032 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.208 | acc=1.0000 | 4398.5 samples/s | 68.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00013, len=1
[Step=11201 Epoch=107.0] | Loss=0.00934 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.199 | acc=1.0000 | 3872.8 samples/s | 60.5 steps/s
[Step=11250 Epoch=107.4] | Loss=0.00512 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.195 | acc=1.0000 | 4284.6 samples/s | 66.9 steps/s
[Step=11300 Epoch=107.9] | Loss=0.00270 | Reg=0.00177 | L2-Norm=13.321 | L2-Norm(final)=3.196 | acc=1.0000 | 5284.1 samples/s | 82.6 steps/s
[Step=11350 Epoch=108.4] | Loss=0.00182 | Reg=0.00177 | L2-Norm=13.323 | L2-Norm(final)=3.198 | acc=1.0000 | 1525.0 samples/s | 23.8 steps/s
[Step=11400 Epoch=108.9] | Loss=0.00137 | Reg=0.00177 | L2-Norm=13.322 | L2-Norm(final)=3.199 | acc=1.0000 | 5088.0 samples/s | 79.5 steps/s
[Step=11450 Epoch=109.3] | Loss=0.00110 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=3.199 | acc=1.0000 | 1565.1 samples/s | 24.5 steps/s
[Step=11500 Epoch=109.8] | Loss=0.00092 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=3.200 | acc=1.0000 | 4906.6 samples/s | 76.7 steps/s
[Step=11550 Epoch=110.3] | Loss=0.00079 | Reg=0.00177 | L2-Norm=13.314 | L2-Norm(final)=3.201 | acc=1.0000 | 1497.0 samples/s | 23.4 steps/s
[Step=11600 Epoch=110.8] | Loss=0.00070 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.201 | acc=1.0000 | 4099.8 samples/s | 64.1 steps/s
[Step=11650 Epoch=111.3] | Loss=0.00062 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.202 | acc=1.0000 | 1568.2 samples/s | 24.5 steps/s
[Step=11700 Epoch=111.7] | Loss=0.00056 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.203 | acc=1.0000 | 4648.7 samples/s | 72.6 steps/s
[Step=11750 Epoch=112.2] | Loss=0.00051 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.203 | acc=1.0000 | 1581.6 samples/s | 24.7 steps/s
[Step=11800 Epoch=112.7] | Loss=0.00047 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.204 | acc=1.0000 | 4575.5 samples/s | 71.5 steps/s
[Step=11850 Epoch=113.2] | Loss=0.00044 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.204 | acc=1.0000 | 1602.3 samples/s | 25.0 steps/s
[Step=11900 Epoch=113.6] | Loss=0.00041 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.204 | acc=1.0000 | 4473.7 samples/s | 69.9 steps/s
[Step=11950 Epoch=114.1] | Loss=0.00038 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.205 | acc=1.0000 | 1610.3 samples/s | 25.2 steps/s
[Step=12000 Epoch=114.6] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.205 | acc=1.0000 | 4540.8 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step12000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00013, len=1
[Step=10401 Epoch=98.0] | Loss=0.03430 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.199 | acc=0.9688 | 3713.6 samples/s | 58.0 steps/s
[Step=10450 Epoch=98.5] | Loss=0.00403 | Reg=0.00177 | L2-Norm=13.321 | L2-Norm(final)=3.200 | acc=1.0000 | 4337.2 samples/s | 67.8 steps/s
[Step=10500 Epoch=98.9] | Loss=0.00206 | Reg=0.00178 | L2-Norm=13.327 | L2-Norm(final)=3.200 | acc=1.0000 | 5202.0 samples/s | 81.3 steps/s
[Step=10550 Epoch=99.4] | Loss=0.00140 | Reg=0.00178 | L2-Norm=13.328 | L2-Norm(final)=3.201 | acc=1.0000 | 1563.4 samples/s | 24.4 steps/s
[Step=10600 Epoch=99.9] | Loss=0.00106 | Reg=0.00178 | L2-Norm=13.326 | L2-Norm(final)=3.201 | acc=1.0000 | 4986.3 samples/s | 77.9 steps/s
[Step=10650 Epoch=100.4] | Loss=0.00085 | Reg=0.00178 | L2-Norm=13.324 | L2-Norm(final)=3.202 | acc=1.0000 | 1585.2 samples/s | 24.8 steps/s
[Step=10700 Epoch=100.8] | Loss=0.00071 | Reg=0.00177 | L2-Norm=13.322 | L2-Norm(final)=3.202 | acc=1.0000 | 4752.5 samples/s | 74.3 steps/s
[Step=10750 Epoch=101.3] | Loss=0.00061 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=3.203 | acc=1.0000 | 1569.2 samples/s | 24.5 steps/s
[Step=10800 Epoch=101.8] | Loss=0.00054 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.203 | acc=1.0000 | 4560.4 samples/s | 71.3 steps/s
[Step=10850 Epoch=102.2] | Loss=0.00048 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.204 | acc=1.0000 | 1587.3 samples/s | 24.8 steps/s
[Step=10900 Epoch=102.7] | Loss=0.00044 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.204 | acc=1.0000 | 4604.0 samples/s | 71.9 steps/s
[Step=10950 Epoch=103.2] | Loss=0.00040 | Reg=0.00177 | L2-Norm=13.306 | L2-Norm(final)=3.205 | acc=1.0000 | 1629.1 samples/s | 25.5 steps/s
[Step=11000 Epoch=103.7] | Loss=0.00036 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.205 | acc=1.0000 | 4568.5 samples/s | 71.4 steps/s
[Step=11050 Epoch=104.1] | Loss=0.00034 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.205 | acc=1.0000 | 1622.9 samples/s | 25.4 steps/s
[Step=11100 Epoch=104.6] | Loss=0.00031 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.206 | acc=1.0000 | 4405.7 samples/s | 68.8 steps/s
[Step=11150 Epoch=105.1] | Loss=0.00029 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.206 | acc=1.0000 | 1728.4 samples/s | 27.0 steps/s
[Step=11200 Epoch=105.5] | Loss=0.00028 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.206 | acc=1.0000 | 4017.1 samples/s | 62.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37176 | acc=0.8061 | tpr=0.7200 | fpr=0.0069 | 4484.4 samples/s | 17.5 steps/s
Avg test loss: 0.37806, Avg test acc: 0.80403, Avg tpr: 0.71854, Avg fpr: 0.00795, total FA: 62

Testing server on iccad2012
[Step=  50] | Loss=0.37929 | acc=0.8906 | tpr=0.9602 | fpr=0.1106 | 4606.1 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.38728 | acc=0.8917 | tpr=0.9701 | fpr=0.1098 | 9034.9 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.39333 | acc=0.8915 | tpr=0.9726 | fpr=0.1100 | 9120.9 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.39625 | acc=0.8911 | tpr=0.9738 | fpr=0.1104 | 9626.3 samples/s | 37.6 steps/s
[Step= 250] | Loss=0.39510 | acc=0.8908 | tpr=0.9703 | fpr=0.1106 | 8723.8 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.39968 | acc=0.8896 | tpr=0.9709 | fpr=0.1119 | 9329.9 samples/s | 36.4 steps/s
[Step= 350] | Loss=0.40106 | acc=0.8896 | tpr=0.9712 | fpr=0.1118 | 9220.0 samples/s | 36.0 steps/s
[Step= 400] | Loss=0.40323 | acc=0.8897 | tpr=0.9710 | fpr=0.1118 | 9079.7 samples/s | 35.5 steps/s
[Step= 450] | Loss=0.40803 | acc=0.8892 | tpr=0.9703 | fpr=0.1122 | 9219.5 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.40683 | acc=0.8888 | tpr=0.9709 | fpr=0.1127 | 9281.0 samples/s | 36.3 steps/s
[Step= 550] | Loss=0.40558 | acc=0.8889 | tpr=0.9698 | fpr=0.1125 | 16807.0 samples/s | 65.7 steps/s
Avg test loss: 0.40547, Avg test acc: 0.88897, Avg tpr: 0.96910, Avg fpr: 0.11249, total FA: 15619

server round 36/50

clients selected: [0 3 5 6 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=16801 Epoch=81.9] | Loss=0.30271 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.232 | acc=0.8594 | 4155.7 samples/s | 64.9 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03832 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.224 | acc=1.0000 | 4384.3 samples/s | 68.5 steps/s
[Step=16900 Epoch=82.4] | Loss=0.02461 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.222 | acc=1.0000 | 4621.8 samples/s | 72.2 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01982 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.223 | acc=1.0000 | 4715.8 samples/s | 73.7 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01793 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=3.226 | acc=0.9688 | 5374.8 samples/s | 84.0 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01524 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.228 | acc=1.0000 | 1556.5 samples/s | 24.3 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01376 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.231 | acc=1.0000 | 4529.3 samples/s | 70.8 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01261 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.234 | acc=1.0000 | 4596.4 samples/s | 71.8 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01156 | Reg=0.00177 | L2-Norm=13.312 | L2-Norm(final)=3.237 | acc=1.0000 | 5277.7 samples/s | 82.5 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01160 | Reg=0.00177 | L2-Norm=13.315 | L2-Norm(final)=3.240 | acc=1.0000 | 1597.7 samples/s | 25.0 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01126 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=3.243 | acc=1.0000 | 4682.3 samples/s | 73.2 steps/s
[Step=17350 Epoch=84.6] | Loss=0.01074 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=3.245 | acc=1.0000 | 4706.0 samples/s | 73.5 steps/s
[Step=17400 Epoch=84.8] | Loss=0.01048 | Reg=0.00177 | L2-Norm=13.321 | L2-Norm(final)=3.247 | acc=1.0000 | 5028.8 samples/s | 78.6 steps/s
[Step=17450 Epoch=85.1] | Loss=0.01010 | Reg=0.00178 | L2-Norm=13.323 | L2-Norm(final)=3.249 | acc=1.0000 | 1600.1 samples/s | 25.0 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00964 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=3.251 | acc=1.0000 | 4754.2 samples/s | 74.3 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00929 | Reg=0.00178 | L2-Norm=13.326 | L2-Norm(final)=3.253 | acc=0.9844 | 4645.8 samples/s | 72.6 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00897 | Reg=0.00178 | L2-Norm=13.328 | L2-Norm(final)=3.256 | acc=1.0000 | 4770.0 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step17600.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00013, len=1
[Step=12001 Epoch=58.5] | Loss=0.21154 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.232 | acc=0.8750 | 4026.4 samples/s | 62.9 steps/s
[Step=12050 Epoch=58.8] | Loss=0.03488 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.225 | acc=0.9688 | 4373.5 samples/s | 68.3 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02382 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.224 | acc=1.0000 | 4394.3 samples/s | 68.7 steps/s
[Step=12150 Epoch=59.3] | Loss=0.02006 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.225 | acc=1.0000 | 4106.7 samples/s | 64.2 steps/s
[Step=12200 Epoch=59.5] | Loss=0.01708 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.227 | acc=1.0000 | 4890.3 samples/s | 76.4 steps/s
[Step=12250 Epoch=59.7] | Loss=0.01491 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.229 | acc=1.0000 | 1564.6 samples/s | 24.4 steps/s
[Step=12300 Epoch=60.0] | Loss=0.01327 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.232 | acc=1.0000 | 4605.4 samples/s | 72.0 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01240 | Reg=0.00177 | L2-Norm=13.306 | L2-Norm(final)=3.235 | acc=1.0000 | 4687.8 samples/s | 73.2 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01134 | Reg=0.00177 | L2-Norm=13.308 | L2-Norm(final)=3.238 | acc=1.0000 | 5218.0 samples/s | 81.5 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01066 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.241 | acc=1.0000 | 1590.4 samples/s | 24.8 steps/s
[Step=12500 Epoch=61.0] | Loss=0.00992 | Reg=0.00177 | L2-Norm=13.314 | L2-Norm(final)=3.244 | acc=0.9844 | 4709.1 samples/s | 73.6 steps/s
[Step=12550 Epoch=61.2] | Loss=0.00954 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=3.247 | acc=1.0000 | 4661.0 samples/s | 72.8 steps/s
[Step=12600 Epoch=61.4] | Loss=0.00900 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=3.250 | acc=1.0000 | 5115.4 samples/s | 79.9 steps/s
[Step=12650 Epoch=61.7] | Loss=0.00861 | Reg=0.00177 | L2-Norm=13.321 | L2-Norm(final)=3.252 | acc=1.0000 | 1605.5 samples/s | 25.1 steps/s
[Step=12700 Epoch=61.9] | Loss=0.00825 | Reg=0.00178 | L2-Norm=13.323 | L2-Norm(final)=3.255 | acc=1.0000 | 4647.8 samples/s | 72.6 steps/s
[Step=12750 Epoch=62.2] | Loss=0.00786 | Reg=0.00178 | L2-Norm=13.326 | L2-Norm(final)=3.258 | acc=1.0000 | 4535.2 samples/s | 70.9 steps/s
[Step=12800 Epoch=62.4] | Loss=0.00762 | Reg=0.00178 | L2-Norm=13.328 | L2-Norm(final)=3.261 | acc=0.9844 | 4809.6 samples/s | 75.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step12800.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=16001 Epoch=151.6] | Loss=0.03666 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.232 | acc=0.9531 | 4087.4 samples/s | 63.9 steps/s
[Step=16050 Epoch=152.1] | Loss=0.00305 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.238 | acc=1.0000 | 4082.2 samples/s | 63.8 steps/s
[Step=16100 Epoch=152.6] | Loss=0.00161 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.241 | acc=1.0000 | 5256.8 samples/s | 82.1 steps/s
[Step=16150 Epoch=153.0] | Loss=0.00108 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.242 | acc=1.0000 | 1526.4 samples/s | 23.9 steps/s
[Step=16200 Epoch=153.5] | Loss=0.00081 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=3.243 | acc=1.0000 | 4957.0 samples/s | 77.5 steps/s
[Step=16250 Epoch=154.0] | Loss=0.00065 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.244 | acc=1.0000 | 1559.2 samples/s | 24.4 steps/s
[Step=16300 Epoch=154.5] | Loss=0.00055 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.244 | acc=1.0000 | 4939.7 samples/s | 77.2 steps/s
[Step=16350 Epoch=154.9] | Loss=0.00047 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.245 | acc=1.0000 | 1557.0 samples/s | 24.3 steps/s
[Step=16400 Epoch=155.4] | Loss=0.00041 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.245 | acc=1.0000 | 4654.6 samples/s | 72.7 steps/s
[Step=16450 Epoch=155.9] | Loss=0.00037 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.245 | acc=1.0000 | 1526.4 samples/s | 23.8 steps/s
[Step=16500 Epoch=156.4] | Loss=0.00033 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.246 | acc=1.0000 | 3858.1 samples/s | 60.3 steps/s
[Step=16550 Epoch=156.8] | Loss=0.00030 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.246 | acc=1.0000 | 1604.9 samples/s | 25.1 steps/s
[Step=16600 Epoch=157.3] | Loss=0.00028 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.246 | acc=1.0000 | 4495.1 samples/s | 70.2 steps/s
[Step=16650 Epoch=157.8] | Loss=0.00026 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.247 | acc=1.0000 | 1579.1 samples/s | 24.7 steps/s
[Step=16700 Epoch=158.2] | Loss=0.00024 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.247 | acc=1.0000 | 3784.5 samples/s | 59.1 steps/s
[Step=16750 Epoch=158.7] | Loss=0.00023 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.247 | acc=1.0000 | 1596.9 samples/s | 25.0 steps/s
[Step=16800 Epoch=159.2] | Loss=0.00021 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.248 | acc=1.0000 | 4463.8 samples/s | 69.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=16001 Epoch=152.2] | Loss=0.07773 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.232 | acc=0.9375 | 3909.8 samples/s | 61.1 steps/s
[Step=16050 Epoch=152.7] | Loss=0.00615 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.228 | acc=1.0000 | 4145.6 samples/s | 64.8 steps/s
[Step=16100 Epoch=153.2] | Loss=0.00317 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.229 | acc=1.0000 | 5272.1 samples/s | 82.4 steps/s
[Step=16150 Epoch=153.6] | Loss=0.00213 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.229 | acc=1.0000 | 1540.2 samples/s | 24.1 steps/s
[Step=16200 Epoch=154.1] | Loss=0.00161 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.230 | acc=1.0000 | 5004.9 samples/s | 78.2 steps/s
[Step=16250 Epoch=154.6] | Loss=0.00129 | Reg=0.00177 | L2-Norm=13.302 | L2-Norm(final)=3.231 | acc=1.0000 | 1538.3 samples/s | 24.0 steps/s
[Step=16300 Epoch=155.1] | Loss=0.00108 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=3.231 | acc=1.0000 | 5007.1 samples/s | 78.2 steps/s
[Step=16350 Epoch=155.5] | Loss=0.00093 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.232 | acc=1.0000 | 1769.3 samples/s | 27.6 steps/s
[Step=16400 Epoch=156.0] | Loss=0.00082 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.232 | acc=1.0000 | 4768.3 samples/s | 74.5 steps/s
[Step=16450 Epoch=156.5] | Loss=0.00073 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.233 | acc=1.0000 | 1599.3 samples/s | 25.0 steps/s
[Step=16500 Epoch=157.0] | Loss=0.00066 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.233 | acc=1.0000 | 4544.8 samples/s | 71.0 steps/s
[Step=16550 Epoch=157.4] | Loss=0.00060 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.234 | acc=1.0000 | 1644.1 samples/s | 25.7 steps/s
[Step=16600 Epoch=157.9] | Loss=0.00055 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.234 | acc=1.0000 | 4416.1 samples/s | 69.0 steps/s
[Step=16650 Epoch=158.4] | Loss=0.00051 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.234 | acc=1.0000 | 1613.5 samples/s | 25.2 steps/s
[Step=16700 Epoch=158.9] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.235 | acc=1.0000 | 4337.6 samples/s | 67.8 steps/s
[Step=16750 Epoch=159.3] | Loss=0.00044 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.235 | acc=1.0000 | 1631.3 samples/s | 25.5 steps/s
[Step=16800 Epoch=159.8] | Loss=0.00042 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.235 | acc=1.0000 | 4289.1 samples/s | 67.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step16800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00013, len=1
[Step=16001 Epoch=152.5] | Loss=0.01916 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.232 | acc=0.9844 | 3786.5 samples/s | 59.2 steps/s
[Step=16050 Epoch=153.0] | Loss=0.00326 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.233 | acc=1.0000 | 4187.9 samples/s | 65.4 steps/s
[Step=16100 Epoch=153.4] | Loss=0.00175 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.234 | acc=1.0000 | 5337.1 samples/s | 83.4 steps/s
[Step=16150 Epoch=153.9] | Loss=0.00119 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=3.236 | acc=1.0000 | 1439.1 samples/s | 22.5 steps/s
[Step=16200 Epoch=154.4] | Loss=0.00090 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.237 | acc=1.0000 | 4550.6 samples/s | 71.1 steps/s
[Step=16250 Epoch=154.9] | Loss=0.00072 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.238 | acc=1.0000 | 1553.1 samples/s | 24.3 steps/s
[Step=16300 Epoch=155.4] | Loss=0.00061 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.239 | acc=1.0000 | 4877.7 samples/s | 76.2 steps/s
[Step=16350 Epoch=155.8] | Loss=0.00052 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.240 | acc=1.0000 | 1556.9 samples/s | 24.3 steps/s
[Step=16400 Epoch=156.3] | Loss=0.00046 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.240 | acc=1.0000 | 4834.7 samples/s | 75.5 steps/s
[Step=16450 Epoch=156.8] | Loss=0.00041 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.241 | acc=1.0000 | 1586.0 samples/s | 24.8 steps/s
[Step=16500 Epoch=157.3] | Loss=0.00037 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.242 | acc=1.0000 | 4605.2 samples/s | 72.0 steps/s
[Step=16550 Epoch=157.7] | Loss=0.00034 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.242 | acc=1.0000 | 1600.3 samples/s | 25.0 steps/s
[Step=16600 Epoch=158.2] | Loss=0.00031 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.243 | acc=1.0000 | 4599.2 samples/s | 71.9 steps/s
[Step=16650 Epoch=158.7] | Loss=0.00029 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.243 | acc=1.0000 | 1566.8 samples/s | 24.5 steps/s
[Step=16700 Epoch=159.2] | Loss=0.00027 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.244 | acc=1.0000 | 3794.7 samples/s | 59.3 steps/s
[Step=16750 Epoch=159.6] | Loss=0.00025 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.244 | acc=1.0000 | 1595.2 samples/s | 24.9 steps/s
[Step=16800 Epoch=160.1] | Loss=0.00024 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.245 | acc=1.0000 | 4548.8 samples/s | 71.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37788 | acc=0.8045 | tpr=0.7173 | fpr=0.0062 | 4599.9 samples/s | 18.0 steps/s
Avg test loss: 0.38440, Avg test acc: 0.80307, Avg tpr: 0.71697, Avg fpr: 0.00756, total FA: 59

Testing server on iccad2012
[Step=  50] | Loss=0.37946 | acc=0.8917 | tpr=0.9602 | fpr=0.1095 | 4613.5 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.38758 | acc=0.8927 | tpr=0.9680 | fpr=0.1088 | 9028.6 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.39401 | acc=0.8922 | tpr=0.9712 | fpr=0.1093 | 9477.3 samples/s | 37.0 steps/s
[Step= 200] | Loss=0.39688 | acc=0.8916 | tpr=0.9727 | fpr=0.1098 | 9186.2 samples/s | 35.9 steps/s
[Step= 250] | Loss=0.39564 | acc=0.8917 | tpr=0.9694 | fpr=0.1097 | 9170.2 samples/s | 35.8 steps/s
[Step= 300] | Loss=0.40023 | acc=0.8905 | tpr=0.9702 | fpr=0.1110 | 9112.8 samples/s | 35.6 steps/s
[Step= 350] | Loss=0.40163 | acc=0.8905 | tpr=0.9706 | fpr=0.1110 | 9557.4 samples/s | 37.3 steps/s
[Step= 400] | Loss=0.40397 | acc=0.8905 | tpr=0.9705 | fpr=0.1109 | 8904.1 samples/s | 34.8 steps/s
[Step= 450] | Loss=0.40880 | acc=0.8900 | tpr=0.9698 | fpr=0.1114 | 9165.0 samples/s | 35.8 steps/s
[Step= 500] | Loss=0.40754 | acc=0.8897 | tpr=0.9705 | fpr=0.1118 | 9200.2 samples/s | 35.9 steps/s
[Step= 550] | Loss=0.40614 | acc=0.8899 | tpr=0.9690 | fpr=0.1115 | 16714.5 samples/s | 65.3 steps/s
Avg test loss: 0.40598, Avg test acc: 0.88994, Avg tpr: 0.96830, Avg fpr: 0.11148, total FA: 15479

server round 37/50

clients selected: [1 3 5 6 9]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=15201 Epoch=74.2] | Loss=0.52988 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.256 | acc=0.7500 | 3834.6 samples/s | 59.9 steps/s
[Step=15250 Epoch=74.4] | Loss=0.03836 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.247 | acc=1.0000 | 4646.7 samples/s | 72.6 steps/s
[Step=15300 Epoch=74.7] | Loss=0.02616 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.246 | acc=0.9844 | 4684.7 samples/s | 73.2 steps/s
[Step=15350 Epoch=74.9] | Loss=0.02171 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.247 | acc=1.0000 | 4697.2 samples/s | 73.4 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01880 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.248 | acc=1.0000 | 5540.5 samples/s | 86.6 steps/s
[Step=15450 Epoch=75.4] | Loss=0.01611 | Reg=0.00177 | L2-Norm=13.285 | L2-Norm(final)=3.250 | acc=1.0000 | 1585.4 samples/s | 24.8 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01402 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.253 | acc=1.0000 | 4586.3 samples/s | 71.7 steps/s
[Step=15550 Epoch=75.9] | Loss=0.01278 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.256 | acc=1.0000 | 4702.5 samples/s | 73.5 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01182 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.259 | acc=1.0000 | 5300.5 samples/s | 82.8 steps/s
[Step=15650 Epoch=76.4] | Loss=0.01087 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.262 | acc=1.0000 | 1584.1 samples/s | 24.8 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01024 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.265 | acc=1.0000 | 4541.5 samples/s | 71.0 steps/s
[Step=15750 Epoch=76.9] | Loss=0.00974 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=3.268 | acc=1.0000 | 4725.2 samples/s | 73.8 steps/s
[Step=15800 Epoch=77.1] | Loss=0.00928 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.270 | acc=1.0000 | 5090.7 samples/s | 79.5 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00877 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.273 | acc=1.0000 | 1534.8 samples/s | 24.0 steps/s
[Step=15900 Epoch=77.6] | Loss=0.00836 | Reg=0.00177 | L2-Norm=13.306 | L2-Norm(final)=3.276 | acc=1.0000 | 3910.0 samples/s | 61.1 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00800 | Reg=0.00177 | L2-Norm=13.308 | L2-Norm(final)=3.278 | acc=0.9844 | 3951.6 samples/s | 61.7 steps/s
[Step=16000 Epoch=78.1] | Loss=0.00776 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.281 | acc=1.0000 | 4288.9 samples/s | 67.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step16000.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00013, len=1
[Step=12801 Epoch=62.4] | Loss=0.39958 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.256 | acc=0.7812 | 3474.8 samples/s | 54.3 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03541 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.250 | acc=1.0000 | 4468.2 samples/s | 69.8 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02443 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.249 | acc=1.0000 | 4632.5 samples/s | 72.4 steps/s
[Step=12950 Epoch=63.2] | Loss=0.01982 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.251 | acc=1.0000 | 4628.2 samples/s | 72.3 steps/s
[Step=13000 Epoch=63.4] | Loss=0.01720 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.253 | acc=0.9844 | 5313.8 samples/s | 83.0 steps/s
[Step=13050 Epoch=63.6] | Loss=0.01476 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.255 | acc=0.9844 | 1611.2 samples/s | 25.2 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01315 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.258 | acc=0.9844 | 4673.3 samples/s | 73.0 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01188 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.261 | acc=1.0000 | 4662.3 samples/s | 72.8 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01130 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.264 | acc=1.0000 | 5200.2 samples/s | 81.3 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01054 | Reg=0.00177 | L2-Norm=13.302 | L2-Norm(final)=3.266 | acc=1.0000 | 1621.3 samples/s | 25.3 steps/s
[Step=13300 Epoch=64.9] | Loss=0.00983 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.269 | acc=0.9844 | 4662.0 samples/s | 72.8 steps/s
[Step=13350 Epoch=65.1] | Loss=0.00930 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.272 | acc=1.0000 | 4573.4 samples/s | 71.5 steps/s
[Step=13400 Epoch=65.3] | Loss=0.00884 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=3.275 | acc=1.0000 | 4975.3 samples/s | 77.7 steps/s
[Step=13450 Epoch=65.6] | Loss=0.00831 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.278 | acc=1.0000 | 1558.1 samples/s | 24.3 steps/s
[Step=13500 Epoch=65.8] | Loss=0.00796 | Reg=0.00177 | L2-Norm=13.314 | L2-Norm(final)=3.281 | acc=1.0000 | 3970.3 samples/s | 62.0 steps/s
[Step=13550 Epoch=66.1] | Loss=0.00766 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.284 | acc=1.0000 | 3937.9 samples/s | 61.5 steps/s
[Step=13600 Epoch=66.3] | Loss=0.00737 | Reg=0.00177 | L2-Norm=13.318 | L2-Norm(final)=3.286 | acc=1.0000 | 4249.0 samples/s | 66.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step13600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=16801 Epoch=159.2] | Loss=0.02107 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.257 | acc=0.9688 | 3459.3 samples/s | 54.1 steps/s
[Step=16850 Epoch=159.7] | Loss=0.00220 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.261 | acc=1.0000 | 4100.4 samples/s | 64.1 steps/s
[Step=16900 Epoch=160.1] | Loss=0.00131 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.264 | acc=1.0000 | 5310.6 samples/s | 83.0 steps/s
[Step=16950 Epoch=160.6] | Loss=0.00093 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.266 | acc=1.0000 | 1539.4 samples/s | 24.1 steps/s
[Step=17000 Epoch=161.1] | Loss=0.00070 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.267 | acc=1.0000 | 5027.0 samples/s | 78.5 steps/s
[Step=17050 Epoch=161.6] | Loss=0.00057 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.268 | acc=1.0000 | 1569.3 samples/s | 24.5 steps/s
[Step=17100 Epoch=162.0] | Loss=0.00048 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.268 | acc=1.0000 | 4880.6 samples/s | 76.3 steps/s
[Step=17150 Epoch=162.5] | Loss=0.00041 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.269 | acc=1.0000 | 1571.7 samples/s | 24.6 steps/s
[Step=17200 Epoch=163.0] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.270 | acc=1.0000 | 4610.0 samples/s | 72.0 steps/s
[Step=17250 Epoch=163.5] | Loss=0.00032 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.270 | acc=1.0000 | 1574.4 samples/s | 24.6 steps/s
[Step=17300 Epoch=163.9] | Loss=0.00029 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.271 | acc=1.0000 | 4469.3 samples/s | 69.8 steps/s
[Step=17350 Epoch=164.4] | Loss=0.00026 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.271 | acc=1.0000 | 1583.7 samples/s | 24.7 steps/s
[Step=17400 Epoch=164.9] | Loss=0.00024 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.271 | acc=1.0000 | 4580.4 samples/s | 71.6 steps/s
[Step=17450 Epoch=165.4] | Loss=0.00023 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.272 | acc=1.0000 | 1593.2 samples/s | 24.9 steps/s
[Step=17500 Epoch=165.8] | Loss=0.00021 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.272 | acc=1.0000 | 4327.0 samples/s | 67.6 steps/s
[Step=17550 Epoch=166.3] | Loss=0.00020 | Reg=0.00175 | L2-Norm=13.246 | L2-Norm(final)=3.273 | acc=1.0000 | 1671.8 samples/s | 26.1 steps/s
[Step=17600 Epoch=166.8] | Loss=0.00018 | Reg=0.00175 | L2-Norm=13.242 | L2-Norm(final)=3.273 | acc=1.0000 | 4437.6 samples/s | 69.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step17600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=16801 Epoch=159.8] | Loss=0.05508 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.256 | acc=0.9531 | 3629.3 samples/s | 56.7 steps/s
[Step=16850 Epoch=160.3] | Loss=0.00465 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.255 | acc=1.0000 | 4386.3 samples/s | 68.5 steps/s
[Step=16900 Epoch=160.8] | Loss=0.00268 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.255 | acc=1.0000 | 5214.7 samples/s | 81.5 steps/s
[Step=16950 Epoch=161.2] | Loss=0.00180 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.256 | acc=1.0000 | 1522.6 samples/s | 23.8 steps/s
[Step=17000 Epoch=161.7] | Loss=0.00135 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.256 | acc=1.0000 | 5097.4 samples/s | 79.6 steps/s
[Step=17050 Epoch=162.2] | Loss=0.00109 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.256 | acc=1.0000 | 1569.7 samples/s | 24.5 steps/s
[Step=17100 Epoch=162.7] | Loss=0.00091 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.257 | acc=1.0000 | 4844.6 samples/s | 75.7 steps/s
[Step=17150 Epoch=163.1] | Loss=0.00078 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.257 | acc=1.0000 | 1556.3 samples/s | 24.3 steps/s
[Step=17200 Epoch=163.6] | Loss=0.00069 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.257 | acc=1.0000 | 4655.6 samples/s | 72.7 steps/s
[Step=17250 Epoch=164.1] | Loss=0.00061 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.258 | acc=1.0000 | 1587.0 samples/s | 24.8 steps/s
[Step=17300 Epoch=164.6] | Loss=0.00055 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.258 | acc=1.0000 | 4423.2 samples/s | 69.1 steps/s
[Step=17350 Epoch=165.0] | Loss=0.00050 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.258 | acc=1.0000 | 1590.7 samples/s | 24.9 steps/s
[Step=17400 Epoch=165.5] | Loss=0.00046 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.258 | acc=1.0000 | 4357.5 samples/s | 68.1 steps/s
[Step=17450 Epoch=166.0] | Loss=0.00043 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.259 | acc=1.0000 | 1606.5 samples/s | 25.1 steps/s
[Step=17500 Epoch=166.5] | Loss=0.00040 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.259 | acc=1.0000 | 4555.9 samples/s | 71.2 steps/s
[Step=17550 Epoch=166.9] | Loss=0.00037 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.259 | acc=1.0000 | 1612.8 samples/s | 25.2 steps/s
[Step=17600 Epoch=167.4] | Loss=0.00035 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.259 | acc=1.0000 | 4438.8 samples/s | 69.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step17600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00013, len=1
[Step=16801 Epoch=160.1] | Loss=0.01372 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.256 | acc=0.9844 | 3789.6 samples/s | 59.2 steps/s
[Step=16850 Epoch=160.6] | Loss=0.00256 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.258 | acc=1.0000 | 4381.9 samples/s | 68.5 steps/s
[Step=16900 Epoch=161.1] | Loss=0.00134 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.259 | acc=1.0000 | 5241.1 samples/s | 81.9 steps/s
[Step=16950 Epoch=161.5] | Loss=0.00091 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.261 | acc=1.0000 | 1543.9 samples/s | 24.1 steps/s
[Step=17000 Epoch=162.0] | Loss=0.00069 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.262 | acc=1.0000 | 5100.7 samples/s | 79.7 steps/s
[Step=17050 Epoch=162.5] | Loss=0.00055 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.263 | acc=1.0000 | 1526.7 samples/s | 23.9 steps/s
[Step=17100 Epoch=163.0] | Loss=0.00046 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.263 | acc=1.0000 | 4992.4 samples/s | 78.0 steps/s
[Step=17150 Epoch=163.5] | Loss=0.00040 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.264 | acc=1.0000 | 1582.1 samples/s | 24.7 steps/s
[Step=17200 Epoch=163.9] | Loss=0.00035 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.265 | acc=1.0000 | 4676.8 samples/s | 73.1 steps/s
[Step=17250 Epoch=164.4] | Loss=0.00031 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.265 | acc=1.0000 | 1602.6 samples/s | 25.0 steps/s
[Step=17300 Epoch=164.9] | Loss=0.00028 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.266 | acc=1.0000 | 4641.9 samples/s | 72.5 steps/s
[Step=17350 Epoch=165.4] | Loss=0.00026 | Reg=0.00175 | L2-Norm=13.247 | L2-Norm(final)=3.267 | acc=1.0000 | 1583.0 samples/s | 24.7 steps/s
[Step=17400 Epoch=165.8] | Loss=0.00024 | Reg=0.00175 | L2-Norm=13.241 | L2-Norm(final)=3.267 | acc=1.0000 | 4466.4 samples/s | 69.8 steps/s
[Step=17450 Epoch=166.3] | Loss=0.00022 | Reg=0.00175 | L2-Norm=13.236 | L2-Norm(final)=3.268 | acc=1.0000 | 1611.6 samples/s | 25.2 steps/s
[Step=17500 Epoch=166.8] | Loss=0.00021 | Reg=0.00175 | L2-Norm=13.230 | L2-Norm(final)=3.268 | acc=1.0000 | 4434.4 samples/s | 69.3 steps/s
[Step=17550 Epoch=167.3] | Loss=0.00019 | Reg=0.00175 | L2-Norm=13.224 | L2-Norm(final)=3.269 | acc=1.0000 | 1569.8 samples/s | 24.5 steps/s
[Step=17600 Epoch=167.7] | Loss=0.00018 | Reg=0.00175 | L2-Norm=13.218 | L2-Norm(final)=3.269 | acc=1.0000 | 3815.8 samples/s | 59.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36076 | acc=0.8128 | tpr=0.7295 | fpr=0.0062 | 4242.2 samples/s | 16.6 steps/s
Avg test loss: 0.36717, Avg test acc: 0.81152, Avg tpr: 0.72915, Avg fpr: 0.00731, total FA: 57

Testing server on iccad2012
[Step=  50] | Loss=0.39378 | acc=0.8883 | tpr=0.9602 | fpr=0.1130 | 4558.5 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.40163 | acc=0.8891 | tpr=0.9680 | fpr=0.1124 | 9221.6 samples/s | 36.0 steps/s
[Step= 150] | Loss=0.40797 | acc=0.8886 | tpr=0.9712 | fpr=0.1129 | 9462.0 samples/s | 37.0 steps/s
[Step= 200] | Loss=0.41100 | acc=0.8882 | tpr=0.9727 | fpr=0.1133 | 9520.0 samples/s | 37.2 steps/s
[Step= 250] | Loss=0.40967 | acc=0.8882 | tpr=0.9694 | fpr=0.1132 | 8902.6 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.41437 | acc=0.8869 | tpr=0.9702 | fpr=0.1146 | 9197.7 samples/s | 35.9 steps/s
[Step= 350] | Loss=0.41567 | acc=0.8869 | tpr=0.9706 | fpr=0.1146 | 9196.9 samples/s | 35.9 steps/s
[Step= 400] | Loss=0.41805 | acc=0.8870 | tpr=0.9705 | fpr=0.1145 | 9171.4 samples/s | 35.8 steps/s
[Step= 450] | Loss=0.42295 | acc=0.8863 | tpr=0.9698 | fpr=0.1152 | 9069.5 samples/s | 35.4 steps/s
[Step= 500] | Loss=0.42172 | acc=0.8861 | tpr=0.9714 | fpr=0.1154 | 8981.6 samples/s | 35.1 steps/s
[Step= 550] | Loss=0.42032 | acc=0.8862 | tpr=0.9698 | fpr=0.1153 | 17222.9 samples/s | 67.3 steps/s
Avg test loss: 0.42020, Avg test acc: 0.88628, Avg tpr: 0.96910, Avg fpr: 0.11523, total FA: 15999

server round 38/50

clients selected: [0 1 2 7 8]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=17601 Epoch=85.8] | Loss=0.11649 | Reg=0.00175 | L2-Norm=13.243 | L2-Norm(final)=3.271 | acc=0.9219 | 4019.8 samples/s | 62.8 steps/s
[Step=17650 Epoch=86.1] | Loss=0.02992 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.266 | acc=0.9844 | 4437.8 samples/s | 69.3 steps/s
[Step=17700 Epoch=86.3] | Loss=0.02263 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.266 | acc=1.0000 | 4571.4 samples/s | 71.4 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01910 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.266 | acc=1.0000 | 4639.9 samples/s | 72.5 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01701 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.268 | acc=1.0000 | 5350.7 samples/s | 83.6 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01446 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.270 | acc=0.9844 | 1514.1 samples/s | 23.7 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01307 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.273 | acc=1.0000 | 3937.9 samples/s | 61.5 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01224 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.276 | acc=1.0000 | 3960.9 samples/s | 61.9 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01140 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.278 | acc=1.0000 | 4670.5 samples/s | 73.0 steps/s
[Step=18050 Epoch=88.0] | Loss=0.01075 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.281 | acc=1.0000 | 1625.8 samples/s | 25.4 steps/s
[Step=18100 Epoch=88.3] | Loss=0.01006 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.283 | acc=1.0000 | 4636.7 samples/s | 72.4 steps/s
[Step=18150 Epoch=88.5] | Loss=0.00957 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.286 | acc=1.0000 | 4706.9 samples/s | 73.5 steps/s
[Step=18200 Epoch=88.7] | Loss=0.00920 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.288 | acc=1.0000 | 5127.1 samples/s | 80.1 steps/s
[Step=18250 Epoch=89.0] | Loss=0.00873 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.291 | acc=1.0000 | 1626.4 samples/s | 25.4 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00844 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.294 | acc=1.0000 | 4721.0 samples/s | 73.8 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00809 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.296 | acc=1.0000 | 4609.5 samples/s | 72.0 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00786 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.299 | acc=1.0000 | 5072.6 samples/s | 79.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step18400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=16001 Epoch=78.1] | Loss=0.32044 | Reg=0.00175 | L2-Norm=13.243 | L2-Norm(final)=3.271 | acc=0.8438 | 4075.5 samples/s | 63.7 steps/s
[Step=16050 Epoch=78.3] | Loss=0.03468 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.265 | acc=1.0000 | 4528.4 samples/s | 70.8 steps/s
[Step=16100 Epoch=78.6] | Loss=0.02377 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.263 | acc=0.9844 | 4559.5 samples/s | 71.2 steps/s
[Step=16150 Epoch=78.8] | Loss=0.01995 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.265 | acc=1.0000 | 4714.3 samples/s | 73.7 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01712 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.266 | acc=1.0000 | 5511.1 samples/s | 86.1 steps/s
[Step=16250 Epoch=79.3] | Loss=0.01517 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.268 | acc=0.9844 | 1580.3 samples/s | 24.7 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01345 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.271 | acc=1.0000 | 4705.7 samples/s | 73.5 steps/s
[Step=16350 Epoch=79.8] | Loss=0.01202 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.274 | acc=1.0000 | 4736.5 samples/s | 74.0 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01113 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.277 | acc=1.0000 | 5253.9 samples/s | 82.1 steps/s
[Step=16450 Epoch=80.3] | Loss=0.01036 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.280 | acc=1.0000 | 1591.0 samples/s | 24.9 steps/s
[Step=16500 Epoch=80.5] | Loss=0.00969 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.283 | acc=1.0000 | 4662.0 samples/s | 72.8 steps/s
[Step=16550 Epoch=80.8] | Loss=0.00919 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.285 | acc=1.0000 | 4732.3 samples/s | 73.9 steps/s
[Step=16600 Epoch=81.0] | Loss=0.00880 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.288 | acc=1.0000 | 5163.9 samples/s | 80.7 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00839 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.291 | acc=1.0000 | 1600.2 samples/s | 25.0 steps/s
[Step=16700 Epoch=81.5] | Loss=0.00796 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.294 | acc=1.0000 | 4482.9 samples/s | 70.0 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00766 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.297 | acc=1.0000 | 4554.4 samples/s | 71.2 steps/s
[Step=16800 Epoch=82.0] | Loss=0.00751 | Reg=0.00177 | L2-Norm=13.302 | L2-Norm(final)=3.299 | acc=1.0000 | 4602.4 samples/s | 71.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step16800.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00013, len=1
[Step=14401 Epoch=70.2] | Loss=0.10573 | Reg=0.00175 | L2-Norm=13.243 | L2-Norm(final)=3.271 | acc=0.9219 | 3513.2 samples/s | 54.9 steps/s
[Step=14450 Epoch=70.4] | Loss=0.03346 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.265 | acc=0.9844 | 4261.8 samples/s | 66.6 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02421 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.264 | acc=1.0000 | 4622.5 samples/s | 72.2 steps/s
[Step=14550 Epoch=70.9] | Loss=0.01994 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.265 | acc=1.0000 | 4572.4 samples/s | 71.4 steps/s
[Step=14600 Epoch=71.1] | Loss=0.01737 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.268 | acc=1.0000 | 5362.4 samples/s | 83.8 steps/s
[Step=14650 Epoch=71.4] | Loss=0.01535 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.271 | acc=1.0000 | 1572.9 samples/s | 24.6 steps/s
[Step=14700 Epoch=71.6] | Loss=0.01389 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.274 | acc=1.0000 | 4636.3 samples/s | 72.4 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01264 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.278 | acc=0.9844 | 4695.5 samples/s | 73.4 steps/s
[Step=14800 Epoch=72.1] | Loss=0.01172 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.281 | acc=1.0000 | 5180.7 samples/s | 80.9 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01088 | Reg=0.00177 | L2-Norm=13.295 | L2-Norm(final)=3.284 | acc=1.0000 | 1583.2 samples/s | 24.7 steps/s
[Step=14900 Epoch=72.6] | Loss=0.01035 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.287 | acc=1.0000 | 4663.9 samples/s | 72.9 steps/s
[Step=14950 Epoch=72.8] | Loss=0.00981 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.290 | acc=1.0000 | 4627.7 samples/s | 72.3 steps/s
[Step=15000 Epoch=73.1] | Loss=0.00929 | Reg=0.00177 | L2-Norm=13.302 | L2-Norm(final)=3.293 | acc=0.9844 | 5070.6 samples/s | 79.2 steps/s
[Step=15050 Epoch=73.3] | Loss=0.00881 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.296 | acc=1.0000 | 1632.2 samples/s | 25.5 steps/s
[Step=15100 Epoch=73.6] | Loss=0.00838 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.299 | acc=1.0000 | 4580.6 samples/s | 71.6 steps/s
[Step=15150 Epoch=73.8] | Loss=0.00810 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=3.302 | acc=0.9844 | 4464.6 samples/s | 69.8 steps/s
[Step=15200 Epoch=74.1] | Loss=0.00782 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.305 | acc=1.0000 | 4775.0 samples/s | 74.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step15200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00013, len=1
[Step=12001 Epoch=114.6] | Loss=0.01713 | Reg=0.00175 | L2-Norm=13.243 | L2-Norm(final)=3.271 | acc=0.9844 | 3437.6 samples/s | 53.7 steps/s
[Step=12050 Epoch=115.1] | Loss=0.00408 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.268 | acc=1.0000 | 4105.1 samples/s | 64.1 steps/s
[Step=12100 Epoch=115.5] | Loss=0.00208 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.268 | acc=1.0000 | 5302.6 samples/s | 82.9 steps/s
[Step=12150 Epoch=116.0] | Loss=0.00140 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.269 | acc=1.0000 | 1532.2 samples/s | 23.9 steps/s
[Step=12200 Epoch=116.5] | Loss=0.00106 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.270 | acc=1.0000 | 5083.3 samples/s | 79.4 steps/s
[Step=12250 Epoch=117.0] | Loss=0.00085 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.270 | acc=1.0000 | 1542.9 samples/s | 24.1 steps/s
[Step=12300 Epoch=117.5] | Loss=0.00071 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.271 | acc=1.0000 | 5058.9 samples/s | 79.0 steps/s
[Step=12350 Epoch=117.9] | Loss=0.00061 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.271 | acc=1.0000 | 1732.6 samples/s | 27.1 steps/s
[Step=12400 Epoch=118.4] | Loss=0.00054 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.272 | acc=1.0000 | 4716.6 samples/s | 73.7 steps/s
[Step=12450 Epoch=118.9] | Loss=0.00048 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.272 | acc=1.0000 | 1519.6 samples/s | 23.7 steps/s
[Step=12500 Epoch=119.4] | Loss=0.00043 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.273 | acc=1.0000 | 4023.8 samples/s | 62.9 steps/s
[Step=12550 Epoch=119.8] | Loss=0.00039 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.273 | acc=1.0000 | 1600.9 samples/s | 25.0 steps/s
[Step=12600 Epoch=120.3] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.273 | acc=1.0000 | 4421.3 samples/s | 69.1 steps/s
[Step=12650 Epoch=120.8] | Loss=0.00034 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.274 | acc=1.0000 | 1594.5 samples/s | 24.9 steps/s
[Step=12700 Epoch=121.3] | Loss=0.00031 | Reg=0.00175 | L2-Norm=13.244 | L2-Norm(final)=3.274 | acc=1.0000 | 4473.1 samples/s | 69.9 steps/s
[Step=12750 Epoch=121.8] | Loss=0.00029 | Reg=0.00175 | L2-Norm=13.239 | L2-Norm(final)=3.274 | acc=1.0000 | 1608.9 samples/s | 25.1 steps/s
[Step=12800 Epoch=122.2] | Loss=0.00027 | Reg=0.00175 | L2-Norm=13.234 | L2-Norm(final)=3.275 | acc=1.0000 | 4504.7 samples/s | 70.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step12800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00013, len=1
[Step=11201 Epoch=105.5] | Loss=0.01764 | Reg=0.00175 | L2-Norm=13.243 | L2-Norm(final)=3.271 | acc=0.9844 | 4011.7 samples/s | 62.7 steps/s
[Step=11250 Epoch=106.0] | Loss=0.00505 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.269 | acc=1.0000 | 4125.3 samples/s | 64.5 steps/s
[Step=11300 Epoch=106.5] | Loss=0.00266 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.269 | acc=1.0000 | 5027.8 samples/s | 78.6 steps/s
[Step=11350 Epoch=106.9] | Loss=0.00179 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.270 | acc=1.0000 | 1535.8 samples/s | 24.0 steps/s
[Step=11400 Epoch=107.4] | Loss=0.00135 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.270 | acc=1.0000 | 4955.2 samples/s | 77.4 steps/s
[Step=11450 Epoch=107.9] | Loss=0.00108 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.270 | acc=1.0000 | 1490.1 samples/s | 23.3 steps/s
[Step=11500 Epoch=108.4] | Loss=0.00091 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.271 | acc=1.0000 | 4118.9 samples/s | 64.4 steps/s
[Step=11550 Epoch=108.8] | Loss=0.00078 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.271 | acc=1.0000 | 1600.6 samples/s | 25.0 steps/s
[Step=11600 Epoch=109.3] | Loss=0.00068 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.271 | acc=1.0000 | 4628.7 samples/s | 72.3 steps/s
[Step=11650 Epoch=109.8] | Loss=0.00061 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.272 | acc=1.0000 | 1549.3 samples/s | 24.2 steps/s
[Step=11700 Epoch=110.2] | Loss=0.00055 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.272 | acc=1.0000 | 3739.2 samples/s | 58.4 steps/s
[Step=11750 Epoch=110.7] | Loss=0.00050 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.272 | acc=1.0000 | 1601.2 samples/s | 25.0 steps/s
[Step=11800 Epoch=111.2] | Loss=0.00046 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.273 | acc=1.0000 | 4565.5 samples/s | 71.3 steps/s
[Step=11850 Epoch=111.7] | Loss=0.00043 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.273 | acc=1.0000 | 1647.4 samples/s | 25.7 steps/s
[Step=11900 Epoch=112.1] | Loss=0.00040 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.273 | acc=1.0000 | 4547.3 samples/s | 71.1 steps/s
[Step=11950 Epoch=112.6] | Loss=0.00037 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.274 | acc=1.0000 | 1714.1 samples/s | 26.8 steps/s
[Step=12000 Epoch=113.1] | Loss=0.00035 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.274 | acc=1.0000 | 3940.4 samples/s | 61.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38558 | acc=0.8030 | tpr=0.7153 | fpr=0.0064 | 4572.5 samples/s | 17.9 steps/s
Avg test loss: 0.39241, Avg test acc: 0.80179, Avg tpr: 0.71504, Avg fpr: 0.00743, total FA: 58

Testing server on iccad2012
[Step=  50] | Loss=0.39275 | acc=0.8921 | tpr=0.9602 | fpr=0.1091 | 4455.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.40090 | acc=0.8929 | tpr=0.9680 | fpr=0.1086 | 9203.0 samples/s | 35.9 steps/s
[Step= 150] | Loss=0.40744 | acc=0.8927 | tpr=0.9712 | fpr=0.1087 | 9500.8 samples/s | 37.1 steps/s
[Step= 200] | Loss=0.41048 | acc=0.8921 | tpr=0.9727 | fpr=0.1093 | 8676.9 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.40922 | acc=0.8922 | tpr=0.9703 | fpr=0.1093 | 5809.0 samples/s | 22.7 steps/s
[Step= 300] | Loss=0.41396 | acc=0.8912 | tpr=0.9709 | fpr=0.1103 | 9048.7 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.41526 | acc=0.8911 | tpr=0.9712 | fpr=0.1103 | 9271.9 samples/s | 36.2 steps/s
[Step= 400] | Loss=0.41774 | acc=0.8913 | tpr=0.9716 | fpr=0.1102 | 8838.1 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.42270 | acc=0.8907 | tpr=0.9708 | fpr=0.1108 | 9222.2 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.42146 | acc=0.8903 | tpr=0.9722 | fpr=0.1112 | 9181.5 samples/s | 35.9 steps/s
[Step= 550] | Loss=0.42002 | acc=0.8905 | tpr=0.9710 | fpr=0.1110 | 16999.0 samples/s | 66.4 steps/s
Avg test loss: 0.41983, Avg test acc: 0.89053, Avg tpr: 0.97029, Avg fpr: 0.11092, total FA: 15401

server round 39/50

clients selected: [0 1 6 8 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=18401 Epoch=89.7] | Loss=0.22292 | Reg=0.00175 | L2-Norm=13.227 | L2-Norm(final)=3.298 | acc=0.8906 | 3813.4 samples/s | 59.6 steps/s
[Step=18450 Epoch=90.0] | Loss=0.03279 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.291 | acc=1.0000 | 4580.9 samples/s | 71.6 steps/s
[Step=18500 Epoch=90.2] | Loss=0.02417 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.291 | acc=0.9844 | 4635.3 samples/s | 72.4 steps/s
[Step=18550 Epoch=90.5] | Loss=0.02007 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.292 | acc=1.0000 | 4687.7 samples/s | 73.2 steps/s
[Step=18600 Epoch=90.7] | Loss=0.01764 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.293 | acc=1.0000 | 5322.1 samples/s | 83.2 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01513 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.295 | acc=1.0000 | 1589.2 samples/s | 24.8 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01353 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.298 | acc=1.0000 | 4642.7 samples/s | 72.5 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01226 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.300 | acc=0.9844 | 4694.0 samples/s | 73.3 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01160 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.303 | acc=1.0000 | 5213.8 samples/s | 81.5 steps/s
[Step=18850 Epoch=91.9] | Loss=0.01079 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.306 | acc=1.0000 | 1506.6 samples/s | 23.5 steps/s
[Step=18900 Epoch=92.2] | Loss=0.01012 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.308 | acc=1.0000 | 3921.4 samples/s | 61.3 steps/s
[Step=18950 Epoch=92.4] | Loss=0.00966 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.311 | acc=1.0000 | 3973.2 samples/s | 62.1 steps/s
[Step=19000 Epoch=92.6] | Loss=0.00917 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.313 | acc=1.0000 | 4440.4 samples/s | 69.4 steps/s
[Step=19050 Epoch=92.9] | Loss=0.00871 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.315 | acc=1.0000 | 1615.5 samples/s | 25.2 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00838 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.318 | acc=1.0000 | 4700.2 samples/s | 73.4 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00803 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.320 | acc=1.0000 | 4674.3 samples/s | 73.0 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00784 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.323 | acc=1.0000 | 4798.3 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step19200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=16801 Epoch=82.0] | Loss=0.10269 | Reg=0.00175 | L2-Norm=13.227 | L2-Norm(final)=3.298 | acc=0.9062 | 3910.9 samples/s | 61.1 steps/s
[Step=16850 Epoch=82.2] | Loss=0.02936 | Reg=0.00175 | L2-Norm=13.244 | L2-Norm(final)=3.294 | acc=1.0000 | 4408.7 samples/s | 68.9 steps/s
[Step=16900 Epoch=82.5] | Loss=0.02263 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.294 | acc=0.9844 | 4665.5 samples/s | 72.9 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01870 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.294 | acc=0.9688 | 4386.3 samples/s | 68.5 steps/s
[Step=17000 Epoch=83.0] | Loss=0.01664 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.296 | acc=1.0000 | 4878.1 samples/s | 76.2 steps/s
[Step=17050 Epoch=83.2] | Loss=0.01441 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.298 | acc=1.0000 | 1549.0 samples/s | 24.2 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01277 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.300 | acc=0.9844 | 4490.2 samples/s | 70.2 steps/s
[Step=17150 Epoch=83.7] | Loss=0.01176 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.303 | acc=1.0000 | 4668.7 samples/s | 72.9 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01110 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.306 | acc=1.0000 | 5122.8 samples/s | 80.0 steps/s
[Step=17250 Epoch=84.2] | Loss=0.01022 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.309 | acc=1.0000 | 1530.7 samples/s | 23.9 steps/s
[Step=17300 Epoch=84.4] | Loss=0.00951 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.312 | acc=1.0000 | 3979.9 samples/s | 62.2 steps/s
[Step=17350 Epoch=84.7] | Loss=0.00906 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.315 | acc=1.0000 | 3883.6 samples/s | 60.7 steps/s
[Step=17400 Epoch=84.9] | Loss=0.00860 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.318 | acc=1.0000 | 4518.0 samples/s | 70.6 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00832 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.320 | acc=1.0000 | 1601.8 samples/s | 25.0 steps/s
[Step=17500 Epoch=85.4] | Loss=0.00798 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.323 | acc=1.0000 | 4692.8 samples/s | 73.3 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00776 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.326 | acc=1.0000 | 4599.9 samples/s | 71.9 steps/s
[Step=17600 Epoch=85.9] | Loss=0.00749 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.328 | acc=1.0000 | 5081.8 samples/s | 79.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step17600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=17601 Epoch=167.4] | Loss=0.06081 | Reg=0.00175 | L2-Norm=13.227 | L2-Norm(final)=3.298 | acc=0.9688 | 3967.3 samples/s | 62.0 steps/s
[Step=17650 Epoch=167.9] | Loss=0.00395 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.297 | acc=1.0000 | 3971.4 samples/s | 62.1 steps/s
[Step=17700 Epoch=168.4] | Loss=0.00208 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.297 | acc=1.0000 | 5321.5 samples/s | 83.1 steps/s
[Step=17750 Epoch=168.8] | Loss=0.00140 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.298 | acc=1.0000 | 1562.4 samples/s | 24.4 steps/s
[Step=17800 Epoch=169.3] | Loss=0.00106 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.299 | acc=1.0000 | 4490.3 samples/s | 70.2 steps/s
[Step=17850 Epoch=169.8] | Loss=0.00085 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.300 | acc=1.0000 | 1541.1 samples/s | 24.1 steps/s
[Step=17900 Epoch=170.3] | Loss=0.00072 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.300 | acc=1.0000 | 4991.9 samples/s | 78.0 steps/s
[Step=17950 Epoch=170.7] | Loss=0.00062 | Reg=0.00175 | L2-Norm=13.247 | L2-Norm(final)=3.301 | acc=1.0000 | 1597.7 samples/s | 25.0 steps/s
[Step=18000 Epoch=171.2] | Loss=0.00054 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.301 | acc=1.0000 | 4587.0 samples/s | 71.7 steps/s
[Step=18050 Epoch=171.7] | Loss=0.00048 | Reg=0.00175 | L2-Norm=13.242 | L2-Norm(final)=3.302 | acc=1.0000 | 1567.4 samples/s | 24.5 steps/s
[Step=18100 Epoch=172.2] | Loss=0.00044 | Reg=0.00175 | L2-Norm=13.239 | L2-Norm(final)=3.302 | acc=1.0000 | 4423.8 samples/s | 69.1 steps/s
[Step=18150 Epoch=172.7] | Loss=0.00040 | Reg=0.00175 | L2-Norm=13.236 | L2-Norm(final)=3.303 | acc=1.0000 | 1173.9 samples/s | 18.3 steps/s
[Step=18200 Epoch=173.1] | Loss=0.00037 | Reg=0.00175 | L2-Norm=13.233 | L2-Norm(final)=3.303 | acc=1.0000 | 4581.2 samples/s | 71.6 steps/s
[Step=18250 Epoch=173.6] | Loss=0.00034 | Reg=0.00175 | L2-Norm=13.230 | L2-Norm(final)=3.303 | acc=1.0000 | 1831.3 samples/s | 28.6 steps/s
[Step=18300 Epoch=174.1] | Loss=0.00032 | Reg=0.00175 | L2-Norm=13.227 | L2-Norm(final)=3.304 | acc=1.0000 | 4576.4 samples/s | 71.5 steps/s
[Step=18350 Epoch=174.6] | Loss=0.00030 | Reg=0.00175 | L2-Norm=13.223 | L2-Norm(final)=3.304 | acc=1.0000 | 1661.3 samples/s | 26.0 steps/s
[Step=18400 Epoch=175.0] | Loss=0.00028 | Reg=0.00175 | L2-Norm=13.220 | L2-Norm(final)=3.305 | acc=1.0000 | 4462.1 samples/s | 69.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step18400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00013, len=1
[Step=12001 Epoch=113.1] | Loss=0.04606 | Reg=0.00175 | L2-Norm=13.227 | L2-Norm(final)=3.298 | acc=0.9531 | 3854.6 samples/s | 60.2 steps/s
[Step=12050 Epoch=113.5] | Loss=0.00258 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.300 | acc=1.0000 | 4256.2 samples/s | 66.5 steps/s
[Step=12100 Epoch=114.0] | Loss=0.00131 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.301 | acc=1.0000 | 5089.2 samples/s | 79.5 steps/s
[Step=12150 Epoch=114.5] | Loss=0.00088 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.302 | acc=1.0000 | 1535.3 samples/s | 24.0 steps/s
[Step=12200 Epoch=115.0] | Loss=0.00066 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.302 | acc=1.0000 | 5073.9 samples/s | 79.3 steps/s
[Step=12250 Epoch=115.4] | Loss=0.00053 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.302 | acc=1.0000 | 1762.4 samples/s | 27.5 steps/s
[Step=12300 Epoch=115.9] | Loss=0.00045 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.303 | acc=1.0000 | 4816.2 samples/s | 75.3 steps/s
[Step=12350 Epoch=116.4] | Loss=0.00038 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.303 | acc=1.0000 | 1587.4 samples/s | 24.8 steps/s
[Step=12400 Epoch=116.8] | Loss=0.00034 | Reg=0.00175 | L2-Norm=13.242 | L2-Norm(final)=3.303 | acc=1.0000 | 4653.4 samples/s | 72.7 steps/s
[Step=12450 Epoch=117.3] | Loss=0.00030 | Reg=0.00175 | L2-Norm=13.239 | L2-Norm(final)=3.303 | acc=1.0000 | 1640.7 samples/s | 25.6 steps/s
[Step=12500 Epoch=117.8] | Loss=0.00027 | Reg=0.00175 | L2-Norm=13.236 | L2-Norm(final)=3.304 | acc=1.0000 | 4537.3 samples/s | 70.9 steps/s
[Step=12550 Epoch=118.3] | Loss=0.00025 | Reg=0.00175 | L2-Norm=13.232 | L2-Norm(final)=3.304 | acc=1.0000 | 1642.4 samples/s | 25.7 steps/s
[Step=12600 Epoch=118.7] | Loss=0.00023 | Reg=0.00175 | L2-Norm=13.229 | L2-Norm(final)=3.304 | acc=1.0000 | 4554.4 samples/s | 71.2 steps/s
[Step=12650 Epoch=119.2] | Loss=0.00021 | Reg=0.00175 | L2-Norm=13.225 | L2-Norm(final)=3.304 | acc=1.0000 | 1639.9 samples/s | 25.6 steps/s
[Step=12700 Epoch=119.7] | Loss=0.00020 | Reg=0.00175 | L2-Norm=13.222 | L2-Norm(final)=3.305 | acc=1.0000 | 4285.2 samples/s | 67.0 steps/s
[Step=12750 Epoch=120.1] | Loss=0.00018 | Reg=0.00175 | L2-Norm=13.218 | L2-Norm(final)=3.305 | acc=1.0000 | 1664.8 samples/s | 26.0 steps/s
[Step=12800 Epoch=120.6] | Loss=0.00017 | Reg=0.00175 | L2-Norm=13.214 | L2-Norm(final)=3.305 | acc=1.0000 | 3945.5 samples/s | 61.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step12800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00013, len=1
[Step=17601 Epoch=167.8] | Loss=0.01892 | Reg=0.00175 | L2-Norm=13.227 | L2-Norm(final)=3.299 | acc=0.9688 | 4007.2 samples/s | 62.6 steps/s
[Step=17650 Epoch=168.2] | Loss=0.00364 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.300 | acc=1.0000 | 4134.5 samples/s | 64.6 steps/s
[Step=17700 Epoch=168.7] | Loss=0.00187 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.301 | acc=1.0000 | 5259.4 samples/s | 82.2 steps/s
[Step=17750 Epoch=169.2] | Loss=0.00125 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.302 | acc=1.0000 | 1526.4 samples/s | 23.8 steps/s
[Step=17800 Epoch=169.7] | Loss=0.00095 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.303 | acc=1.0000 | 4966.5 samples/s | 77.6 steps/s
[Step=17850 Epoch=170.1] | Loss=0.00076 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.303 | acc=1.0000 | 1539.4 samples/s | 24.1 steps/s
[Step=17900 Epoch=170.6] | Loss=0.00064 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.304 | acc=1.0000 | 5059.9 samples/s | 79.1 steps/s
[Step=17950 Epoch=171.1] | Loss=0.00055 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.304 | acc=1.0000 | 1557.2 samples/s | 24.3 steps/s
[Step=18000 Epoch=171.6] | Loss=0.00048 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.305 | acc=1.0000 | 4792.9 samples/s | 74.9 steps/s
[Step=18050 Epoch=172.0] | Loss=0.00043 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.305 | acc=1.0000 | 1522.7 samples/s | 23.8 steps/s
[Step=18100 Epoch=172.5] | Loss=0.00039 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.306 | acc=1.0000 | 4064.4 samples/s | 63.5 steps/s
[Step=18150 Epoch=173.0] | Loss=0.00035 | Reg=0.00175 | L2-Norm=13.246 | L2-Norm(final)=3.306 | acc=1.0000 | 1585.9 samples/s | 24.8 steps/s
[Step=18200 Epoch=173.5] | Loss=0.00032 | Reg=0.00175 | L2-Norm=13.242 | L2-Norm(final)=3.307 | acc=1.0000 | 4661.7 samples/s | 72.8 steps/s
[Step=18250 Epoch=173.9] | Loss=0.00030 | Reg=0.00175 | L2-Norm=13.237 | L2-Norm(final)=3.307 | acc=1.0000 | 1563.9 samples/s | 24.4 steps/s
[Step=18300 Epoch=174.4] | Loss=0.00028 | Reg=0.00175 | L2-Norm=13.233 | L2-Norm(final)=3.307 | acc=1.0000 | 3815.2 samples/s | 59.6 steps/s
[Step=18350 Epoch=174.9] | Loss=0.00026 | Reg=0.00175 | L2-Norm=13.228 | L2-Norm(final)=3.308 | acc=1.0000 | 1600.7 samples/s | 25.0 steps/s
[Step=18400 Epoch=175.4] | Loss=0.00025 | Reg=0.00175 | L2-Norm=13.223 | L2-Norm(final)=3.308 | acc=1.0000 | 4423.4 samples/s | 69.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38774 | acc=0.8052 | tpr=0.7181 | fpr=0.0057 | 4560.6 samples/s | 17.8 steps/s
Avg test loss: 0.39441, Avg test acc: 0.80323, Avg tpr: 0.71697, Avg fpr: 0.00705, total FA: 55

Testing server on iccad2012
[Step=  50] | Loss=0.39344 | acc=0.8917 | tpr=0.9602 | fpr=0.1095 | 4560.4 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.40120 | acc=0.8932 | tpr=0.9680 | fpr=0.1082 | 9163.3 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.40744 | acc=0.8929 | tpr=0.9712 | fpr=0.1085 | 9756.4 samples/s | 38.1 steps/s
[Step= 200] | Loss=0.41063 | acc=0.8923 | tpr=0.9716 | fpr=0.1092 | 8718.0 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.40958 | acc=0.8923 | tpr=0.9694 | fpr=0.1091 | 9425.6 samples/s | 36.8 steps/s
[Step= 300] | Loss=0.41422 | acc=0.8911 | tpr=0.9709 | fpr=0.1104 | 9191.2 samples/s | 35.9 steps/s
[Step= 350] | Loss=0.41560 | acc=0.8909 | tpr=0.9712 | fpr=0.1105 | 9080.3 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.41802 | acc=0.8909 | tpr=0.9716 | fpr=0.1105 | 9140.5 samples/s | 35.7 steps/s
[Step= 450] | Loss=0.42286 | acc=0.8904 | tpr=0.9708 | fpr=0.1110 | 9416.1 samples/s | 36.8 steps/s
[Step= 500] | Loss=0.42159 | acc=0.8902 | tpr=0.9718 | fpr=0.1113 | 9081.8 samples/s | 35.5 steps/s
[Step= 550] | Loss=0.42007 | acc=0.8903 | tpr=0.9702 | fpr=0.1112 | 16998.3 samples/s | 66.4 steps/s
Avg test loss: 0.41988, Avg test acc: 0.89028, Avg tpr: 0.96949, Avg fpr: 0.11116, total FA: 15435

server round 40/50

clients selected: [5 6 7 8 9]

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=17601 Epoch=166.8] | Loss=0.00106 | Reg=0.00175 | L2-Norm=13.217 | L2-Norm(final)=3.315 | acc=1.0000 | 4025.9 samples/s | 62.9 steps/s
[Step=17650 Epoch=167.2] | Loss=0.00303 | Reg=0.00175 | L2-Norm=13.228 | L2-Norm(final)=3.317 | acc=1.0000 | 4357.8 samples/s | 68.1 steps/s
[Step=17700 Epoch=167.7] | Loss=0.00156 | Reg=0.00175 | L2-Norm=13.231 | L2-Norm(final)=3.319 | acc=1.0000 | 5221.7 samples/s | 81.6 steps/s
[Step=17750 Epoch=168.2] | Loss=0.00106 | Reg=0.00175 | L2-Norm=13.231 | L2-Norm(final)=3.320 | acc=1.0000 | 1531.5 samples/s | 23.9 steps/s
[Step=17800 Epoch=168.7] | Loss=0.00080 | Reg=0.00175 | L2-Norm=13.230 | L2-Norm(final)=3.320 | acc=1.0000 | 5177.0 samples/s | 80.9 steps/s
[Step=17850 Epoch=169.1] | Loss=0.00065 | Reg=0.00175 | L2-Norm=13.228 | L2-Norm(final)=3.321 | acc=1.0000 | 1577.5 samples/s | 24.6 steps/s
[Step=17900 Epoch=169.6] | Loss=0.00055 | Reg=0.00175 | L2-Norm=13.227 | L2-Norm(final)=3.322 | acc=1.0000 | 4887.5 samples/s | 76.4 steps/s
[Step=17950 Epoch=170.1] | Loss=0.00047 | Reg=0.00175 | L2-Norm=13.225 | L2-Norm(final)=3.322 | acc=1.0000 | 1517.9 samples/s | 23.7 steps/s
[Step=18000 Epoch=170.6] | Loss=0.00042 | Reg=0.00175 | L2-Norm=13.223 | L2-Norm(final)=3.323 | acc=1.0000 | 3985.1 samples/s | 62.3 steps/s
[Step=18050 Epoch=171.0] | Loss=0.00037 | Reg=0.00175 | L2-Norm=13.221 | L2-Norm(final)=3.323 | acc=1.0000 | 1538.7 samples/s | 24.0 steps/s
[Step=18100 Epoch=171.5] | Loss=0.00034 | Reg=0.00175 | L2-Norm=13.219 | L2-Norm(final)=3.323 | acc=1.0000 | 3827.5 samples/s | 59.8 steps/s
[Step=18150 Epoch=172.0] | Loss=0.00031 | Reg=0.00175 | L2-Norm=13.217 | L2-Norm(final)=3.324 | acc=1.0000 | 1593.4 samples/s | 24.9 steps/s
[Step=18200 Epoch=172.5] | Loss=0.00028 | Reg=0.00175 | L2-Norm=13.215 | L2-Norm(final)=3.324 | acc=1.0000 | 4489.9 samples/s | 70.2 steps/s
[Step=18250 Epoch=172.9] | Loss=0.00026 | Reg=0.00175 | L2-Norm=13.213 | L2-Norm(final)=3.325 | acc=1.0000 | 1625.6 samples/s | 25.4 steps/s
[Step=18300 Epoch=173.4] | Loss=0.00025 | Reg=0.00175 | L2-Norm=13.211 | L2-Norm(final)=3.325 | acc=1.0000 | 4444.5 samples/s | 69.4 steps/s
[Step=18350 Epoch=173.9] | Loss=0.00023 | Reg=0.00174 | L2-Norm=13.209 | L2-Norm(final)=3.325 | acc=1.0000 | 1634.0 samples/s | 25.5 steps/s
[Step=18400 Epoch=174.4] | Loss=0.00022 | Reg=0.00174 | L2-Norm=13.206 | L2-Norm(final)=3.326 | acc=1.0000 | 4359.6 samples/s | 68.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step18400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=18401 Epoch=175.0] | Loss=0.03564 | Reg=0.00175 | L2-Norm=13.217 | L2-Norm(final)=3.315 | acc=0.9844 | 4033.3 samples/s | 63.0 steps/s
[Step=18450 Epoch=175.5] | Loss=0.00438 | Reg=0.00175 | L2-Norm=13.233 | L2-Norm(final)=3.317 | acc=1.0000 | 4159.9 samples/s | 65.0 steps/s
[Step=18500 Epoch=176.0] | Loss=0.00222 | Reg=0.00175 | L2-Norm=13.235 | L2-Norm(final)=3.318 | acc=1.0000 | 5307.5 samples/s | 82.9 steps/s
[Step=18550 Epoch=176.5] | Loss=0.00150 | Reg=0.00175 | L2-Norm=13.235 | L2-Norm(final)=3.319 | acc=1.0000 | 1447.7 samples/s | 22.6 steps/s
[Step=18600 Epoch=176.9] | Loss=0.00114 | Reg=0.00175 | L2-Norm=13.235 | L2-Norm(final)=3.319 | acc=1.0000 | 4571.0 samples/s | 71.4 steps/s
[Step=18650 Epoch=177.4] | Loss=0.00092 | Reg=0.00175 | L2-Norm=13.234 | L2-Norm(final)=3.320 | acc=1.0000 | 1504.2 samples/s | 23.5 steps/s
[Step=18700 Epoch=177.9] | Loss=0.00077 | Reg=0.00175 | L2-Norm=13.233 | L2-Norm(final)=3.320 | acc=1.0000 | 4536.5 samples/s | 70.9 steps/s
[Step=18750 Epoch=178.4] | Loss=0.00067 | Reg=0.00175 | L2-Norm=13.232 | L2-Norm(final)=3.320 | acc=1.0000 | 1560.1 samples/s | 24.4 steps/s
[Step=18800 Epoch=178.8] | Loss=0.00059 | Reg=0.00175 | L2-Norm=13.231 | L2-Norm(final)=3.321 | acc=1.0000 | 4644.2 samples/s | 72.6 steps/s
[Step=18850 Epoch=179.3] | Loss=0.00053 | Reg=0.00175 | L2-Norm=13.230 | L2-Norm(final)=3.321 | acc=1.0000 | 1580.8 samples/s | 24.7 steps/s
[Step=18900 Epoch=179.8] | Loss=0.00048 | Reg=0.00175 | L2-Norm=13.228 | L2-Norm(final)=3.321 | acc=1.0000 | 4618.4 samples/s | 72.2 steps/s
[Step=18950 Epoch=180.3] | Loss=0.00044 | Reg=0.00175 | L2-Norm=13.227 | L2-Norm(final)=3.322 | acc=1.0000 | 1593.2 samples/s | 24.9 steps/s
[Step=19000 Epoch=180.7] | Loss=0.00040 | Reg=0.00175 | L2-Norm=13.226 | L2-Norm(final)=3.322 | acc=1.0000 | 4502.2 samples/s | 70.3 steps/s
[Step=19050 Epoch=181.2] | Loss=0.00037 | Reg=0.00175 | L2-Norm=13.224 | L2-Norm(final)=3.322 | acc=1.0000 | 1620.0 samples/s | 25.3 steps/s
[Step=19100 Epoch=181.7] | Loss=0.00035 | Reg=0.00175 | L2-Norm=13.223 | L2-Norm(final)=3.323 | acc=1.0000 | 4586.4 samples/s | 71.7 steps/s
[Step=19150 Epoch=182.2] | Loss=0.00033 | Reg=0.00175 | L2-Norm=13.221 | L2-Norm(final)=3.323 | acc=1.0000 | 1629.8 samples/s | 25.5 steps/s
[Step=19200 Epoch=182.6] | Loss=0.00031 | Reg=0.00175 | L2-Norm=13.220 | L2-Norm(final)=3.323 | acc=1.0000 | 4393.0 samples/s | 68.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step19200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00006, len=1
[Step=12801 Epoch=122.2] | Loss=0.03895 | Reg=0.00175 | L2-Norm=13.217 | L2-Norm(final)=3.315 | acc=0.9844 | 3913.1 samples/s | 61.1 steps/s
[Step=12850 Epoch=122.7] | Loss=0.00512 | Reg=0.00175 | L2-Norm=13.232 | L2-Norm(final)=3.317 | acc=1.0000 | 4343.3 samples/s | 67.9 steps/s
[Step=12900 Epoch=123.2] | Loss=0.00263 | Reg=0.00175 | L2-Norm=13.235 | L2-Norm(final)=3.318 | acc=1.0000 | 5145.6 samples/s | 80.4 steps/s
[Step=12950 Epoch=123.7] | Loss=0.00177 | Reg=0.00175 | L2-Norm=13.236 | L2-Norm(final)=3.319 | acc=1.0000 | 1522.5 samples/s | 23.8 steps/s
[Step=13000 Epoch=124.1] | Loss=0.00134 | Reg=0.00175 | L2-Norm=13.235 | L2-Norm(final)=3.320 | acc=1.0000 | 5192.6 samples/s | 81.1 steps/s
[Step=13050 Epoch=124.6] | Loss=0.00108 | Reg=0.00175 | L2-Norm=13.234 | L2-Norm(final)=3.320 | acc=1.0000 | 1538.6 samples/s | 24.0 steps/s
[Step=13100 Epoch=125.1] | Loss=0.00091 | Reg=0.00175 | L2-Norm=13.233 | L2-Norm(final)=3.321 | acc=1.0000 | 4839.2 samples/s | 75.6 steps/s
[Step=13150 Epoch=125.6] | Loss=0.00078 | Reg=0.00175 | L2-Norm=13.232 | L2-Norm(final)=3.321 | acc=1.0000 | 1566.9 samples/s | 24.5 steps/s
[Step=13200 Epoch=126.1] | Loss=0.00069 | Reg=0.00175 | L2-Norm=13.230 | L2-Norm(final)=3.322 | acc=1.0000 | 4729.4 samples/s | 73.9 steps/s
[Step=13250 Epoch=126.5] | Loss=0.00062 | Reg=0.00175 | L2-Norm=13.229 | L2-Norm(final)=3.322 | acc=1.0000 | 1607.7 samples/s | 25.1 steps/s
[Step=13300 Epoch=127.0] | Loss=0.00056 | Reg=0.00175 | L2-Norm=13.227 | L2-Norm(final)=3.323 | acc=1.0000 | 4744.8 samples/s | 74.1 steps/s
[Step=13350 Epoch=127.5] | Loss=0.00051 | Reg=0.00175 | L2-Norm=13.226 | L2-Norm(final)=3.323 | acc=1.0000 | 1577.8 samples/s | 24.7 steps/s
[Step=13400 Epoch=128.0] | Loss=0.00047 | Reg=0.00175 | L2-Norm=13.224 | L2-Norm(final)=3.323 | acc=1.0000 | 4374.1 samples/s | 68.3 steps/s
[Step=13450 Epoch=128.4] | Loss=0.00043 | Reg=0.00175 | L2-Norm=13.222 | L2-Norm(final)=3.324 | acc=1.0000 | 1587.1 samples/s | 24.8 steps/s
[Step=13500 Epoch=128.9] | Loss=0.00040 | Reg=0.00175 | L2-Norm=13.220 | L2-Norm(final)=3.324 | acc=1.0000 | 4578.0 samples/s | 71.5 steps/s
[Step=13550 Epoch=129.4] | Loss=0.00038 | Reg=0.00175 | L2-Norm=13.219 | L2-Norm(final)=3.324 | acc=1.0000 | 1608.4 samples/s | 25.1 steps/s
[Step=13600 Epoch=129.9] | Loss=0.00036 | Reg=0.00175 | L2-Norm=13.217 | L2-Norm(final)=3.324 | acc=1.0000 | 4474.2 samples/s | 69.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step13600.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00006, len=1
[Step=12801 Epoch=120.6] | Loss=0.04208 | Reg=0.00175 | L2-Norm=13.217 | L2-Norm(final)=3.315 | acc=0.9844 | 3797.1 samples/s | 59.3 steps/s
[Step=12850 Epoch=121.1] | Loss=0.00300 | Reg=0.00175 | L2-Norm=13.230 | L2-Norm(final)=3.316 | acc=1.0000 | 4575.9 samples/s | 71.5 steps/s
[Step=12900 Epoch=121.6] | Loss=0.00168 | Reg=0.00175 | L2-Norm=13.233 | L2-Norm(final)=3.317 | acc=1.0000 | 5093.3 samples/s | 79.6 steps/s
[Step=12950 Epoch=122.0] | Loss=0.00114 | Reg=0.00175 | L2-Norm=13.234 | L2-Norm(final)=3.318 | acc=1.0000 | 1523.3 samples/s | 23.8 steps/s
[Step=13000 Epoch=122.5] | Loss=0.00086 | Reg=0.00175 | L2-Norm=13.233 | L2-Norm(final)=3.319 | acc=1.0000 | 5006.4 samples/s | 78.2 steps/s
[Step=13050 Epoch=123.0] | Loss=0.00070 | Reg=0.00175 | L2-Norm=13.232 | L2-Norm(final)=3.320 | acc=1.0000 | 1551.2 samples/s | 24.2 steps/s
[Step=13100 Epoch=123.4] | Loss=0.00058 | Reg=0.00175 | L2-Norm=13.231 | L2-Norm(final)=3.320 | acc=1.0000 | 4694.3 samples/s | 73.3 steps/s
[Step=13150 Epoch=123.9] | Loss=0.00050 | Reg=0.00175 | L2-Norm=13.229 | L2-Norm(final)=3.320 | acc=1.0000 | 1590.7 samples/s | 24.9 steps/s
[Step=13200 Epoch=124.4] | Loss=0.00044 | Reg=0.00175 | L2-Norm=13.228 | L2-Norm(final)=3.321 | acc=1.0000 | 4520.4 samples/s | 70.6 steps/s
[Step=13250 Epoch=124.9] | Loss=0.00040 | Reg=0.00175 | L2-Norm=13.226 | L2-Norm(final)=3.321 | acc=1.0000 | 1552.4 samples/s | 24.3 steps/s
[Step=13300 Epoch=125.3] | Loss=0.00036 | Reg=0.00175 | L2-Norm=13.224 | L2-Norm(final)=3.321 | acc=1.0000 | 4190.8 samples/s | 65.5 steps/s
[Step=13350 Epoch=125.8] | Loss=0.00033 | Reg=0.00175 | L2-Norm=13.222 | L2-Norm(final)=3.322 | acc=1.0000 | 1616.4 samples/s | 25.3 steps/s
[Step=13400 Epoch=126.3] | Loss=0.00030 | Reg=0.00175 | L2-Norm=13.221 | L2-Norm(final)=3.322 | acc=1.0000 | 4622.0 samples/s | 72.2 steps/s
[Step=13450 Epoch=126.7] | Loss=0.00028 | Reg=0.00175 | L2-Norm=13.219 | L2-Norm(final)=3.322 | acc=1.0000 | 1639.4 samples/s | 25.6 steps/s
[Step=13500 Epoch=127.2] | Loss=0.00026 | Reg=0.00175 | L2-Norm=13.217 | L2-Norm(final)=3.323 | acc=1.0000 | 4363.0 samples/s | 68.2 steps/s
[Step=13550 Epoch=127.7] | Loss=0.00024 | Reg=0.00175 | L2-Norm=13.215 | L2-Norm(final)=3.323 | acc=1.0000 | 1883.7 samples/s | 29.4 steps/s
[Step=13600 Epoch=128.2] | Loss=0.00023 | Reg=0.00175 | L2-Norm=13.213 | L2-Norm(final)=3.323 | acc=1.0000 | 3318.7 samples/s | 51.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step13600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00006, len=1
[Step=18401 Epoch=175.4] | Loss=0.02439 | Reg=0.00175 | L2-Norm=13.217 | L2-Norm(final)=3.315 | acc=0.9844 | 4013.4 samples/s | 62.7 steps/s
[Step=18450 Epoch=175.8] | Loss=0.00608 | Reg=0.00175 | L2-Norm=13.234 | L2-Norm(final)=3.318 | acc=1.0000 | 4400.2 samples/s | 68.8 steps/s
[Step=18500 Epoch=176.3] | Loss=0.00311 | Reg=0.00175 | L2-Norm=13.238 | L2-Norm(final)=3.319 | acc=1.0000 | 5313.4 samples/s | 83.0 steps/s
[Step=18550 Epoch=176.8] | Loss=0.00210 | Reg=0.00175 | L2-Norm=13.239 | L2-Norm(final)=3.319 | acc=1.0000 | 1535.7 samples/s | 24.0 steps/s
[Step=18600 Epoch=177.3] | Loss=0.00158 | Reg=0.00175 | L2-Norm=13.238 | L2-Norm(final)=3.320 | acc=1.0000 | 5126.2 samples/s | 80.1 steps/s
[Step=18650 Epoch=177.8] | Loss=0.00128 | Reg=0.00175 | L2-Norm=13.237 | L2-Norm(final)=3.321 | acc=1.0000 | 1545.2 samples/s | 24.1 steps/s
[Step=18700 Epoch=178.2] | Loss=0.00107 | Reg=0.00175 | L2-Norm=13.236 | L2-Norm(final)=3.321 | acc=1.0000 | 4934.8 samples/s | 77.1 steps/s
[Step=18750 Epoch=178.7] | Loss=0.00092 | Reg=0.00175 | L2-Norm=13.235 | L2-Norm(final)=3.322 | acc=1.0000 | 1490.4 samples/s | 23.3 steps/s
[Step=18800 Epoch=179.2] | Loss=0.00081 | Reg=0.00175 | L2-Norm=13.233 | L2-Norm(final)=3.322 | acc=1.0000 | 4167.4 samples/s | 65.1 steps/s
[Step=18850 Epoch=179.7] | Loss=0.00072 | Reg=0.00175 | L2-Norm=13.232 | L2-Norm(final)=3.323 | acc=1.0000 | 1554.7 samples/s | 24.3 steps/s
[Step=18900 Epoch=180.1] | Loss=0.00065 | Reg=0.00175 | L2-Norm=13.230 | L2-Norm(final)=3.323 | acc=1.0000 | 4527.4 samples/s | 70.7 steps/s
[Step=18950 Epoch=180.6] | Loss=0.00060 | Reg=0.00175 | L2-Norm=13.228 | L2-Norm(final)=3.323 | acc=1.0000 | 1582.1 samples/s | 24.7 steps/s
[Step=19000 Epoch=181.1] | Loss=0.00055 | Reg=0.00175 | L2-Norm=13.227 | L2-Norm(final)=3.324 | acc=1.0000 | 4620.1 samples/s | 72.2 steps/s
[Step=19050 Epoch=181.6] | Loss=0.00051 | Reg=0.00175 | L2-Norm=13.225 | L2-Norm(final)=3.324 | acc=1.0000 | 1609.3 samples/s | 25.1 steps/s
[Step=19100 Epoch=182.0] | Loss=0.00047 | Reg=0.00175 | L2-Norm=13.223 | L2-Norm(final)=3.325 | acc=1.0000 | 4503.9 samples/s | 70.4 steps/s
[Step=19150 Epoch=182.5] | Loss=0.00044 | Reg=0.00175 | L2-Norm=13.221 | L2-Norm(final)=3.325 | acc=1.0000 | 1611.3 samples/s | 25.2 steps/s
[Step=19200 Epoch=183.0] | Loss=0.00042 | Reg=0.00175 | L2-Norm=13.219 | L2-Norm(final)=3.325 | acc=1.0000 | 4394.3 samples/s | 68.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29714 | acc=0.8451 | tpr=0.7772 | fpr=0.0074 | 4639.9 samples/s | 18.1 steps/s
Avg test loss: 0.30375, Avg test acc: 0.84462, Avg tpr: 0.77758, Avg fpr: 0.00795, total FA: 62

Testing server on iccad2012
[Step=  50] | Loss=0.47609 | acc=0.8637 | tpr=0.9602 | fpr=0.1381 | 4721.5 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.48298 | acc=0.8631 | tpr=0.9659 | fpr=0.1388 | 8956.4 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.48992 | acc=0.8624 | tpr=0.9697 | fpr=0.1396 | 9013.6 samples/s | 35.2 steps/s
[Step= 200] | Loss=0.49272 | acc=0.8625 | tpr=0.9694 | fpr=0.1394 | 9105.6 samples/s | 35.6 steps/s
[Step= 250] | Loss=0.49152 | acc=0.8624 | tpr=0.9668 | fpr=0.1395 | 9278.5 samples/s | 36.2 steps/s
[Step= 300] | Loss=0.49679 | acc=0.8611 | tpr=0.9687 | fpr=0.1408 | 9324.1 samples/s | 36.4 steps/s
[Step= 350] | Loss=0.49787 | acc=0.8614 | tpr=0.9693 | fpr=0.1406 | 8983.1 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.50023 | acc=0.8613 | tpr=0.9699 | fpr=0.1406 | 9456.1 samples/s | 36.9 steps/s
[Step= 450] | Loss=0.50510 | acc=0.8610 | tpr=0.9693 | fpr=0.1410 | 8952.9 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.50397 | acc=0.8604 | tpr=0.9700 | fpr=0.1415 | 9363.9 samples/s | 36.6 steps/s
[Step= 550] | Loss=0.50264 | acc=0.8604 | tpr=0.9686 | fpr=0.1415 | 16441.2 samples/s | 64.2 steps/s
Avg test loss: 0.50266, Avg test acc: 0.86044, Avg tpr: 0.96751, Avg fpr: 0.14151, total FA: 19648

server round 41/50

clients selected: [0 1 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=19201 Epoch=93.6] | Loss=0.32114 | Reg=0.00175 | L2-Norm=13.237 | L2-Norm(final)=3.330 | acc=0.8594 | 3800.0 samples/s | 59.4 steps/s
[Step=19250 Epoch=93.9] | Loss=0.03708 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.329 | acc=1.0000 | 4965.1 samples/s | 77.6 steps/s
[Step=19300 Epoch=94.1] | Loss=0.02341 | Reg=0.00175 | L2-Norm=13.247 | L2-Norm(final)=3.329 | acc=1.0000 | 4453.5 samples/s | 69.6 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01804 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.330 | acc=0.9844 | 4672.1 samples/s | 73.0 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01593 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.331 | acc=1.0000 | 5322.9 samples/s | 83.2 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01380 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.333 | acc=1.0000 | 1484.7 samples/s | 23.2 steps/s
[Step=19500 Epoch=95.1] | Loss=0.01240 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.334 | acc=1.0000 | 3929.9 samples/s | 61.4 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01142 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.336 | acc=1.0000 | 3938.2 samples/s | 61.5 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01052 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.338 | acc=1.0000 | 4739.2 samples/s | 74.1 steps/s
[Step=19650 Epoch=95.8] | Loss=0.00976 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.340 | acc=1.0000 | 1531.3 samples/s | 23.9 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00915 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.341 | acc=1.0000 | 3964.5 samples/s | 61.9 steps/s
[Step=19750 Epoch=96.3] | Loss=0.00878 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.343 | acc=1.0000 | 3963.7 samples/s | 61.9 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00841 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.345 | acc=1.0000 | 4439.0 samples/s | 69.4 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00798 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.347 | acc=1.0000 | 1545.9 samples/s | 24.2 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00774 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.349 | acc=1.0000 | 3934.2 samples/s | 61.5 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00742 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.350 | acc=1.0000 | 4050.7 samples/s | 63.3 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00718 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.352 | acc=1.0000 | 4147.8 samples/s | 64.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=17601 Epoch=85.9] | Loss=0.17690 | Reg=0.00175 | L2-Norm=13.237 | L2-Norm(final)=3.331 | acc=0.8438 | 3404.6 samples/s | 53.2 steps/s
[Step=17650 Epoch=86.1] | Loss=0.02796 | Reg=0.00175 | L2-Norm=13.246 | L2-Norm(final)=3.329 | acc=1.0000 | 4469.1 samples/s | 69.8 steps/s
[Step=17700 Epoch=86.4] | Loss=0.02079 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.330 | acc=1.0000 | 4660.9 samples/s | 72.8 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01721 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.331 | acc=1.0000 | 4679.3 samples/s | 73.1 steps/s
[Step=17800 Epoch=86.9] | Loss=0.01514 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.332 | acc=1.0000 | 5413.3 samples/s | 84.6 steps/s
[Step=17850 Epoch=87.1] | Loss=0.01317 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.333 | acc=1.0000 | 1622.5 samples/s | 25.4 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01172 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.335 | acc=1.0000 | 4771.2 samples/s | 74.5 steps/s
[Step=17950 Epoch=87.6] | Loss=0.01081 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.337 | acc=0.9844 | 4538.4 samples/s | 70.9 steps/s
[Step=18000 Epoch=87.8] | Loss=0.00995 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.339 | acc=1.0000 | 5181.5 samples/s | 81.0 steps/s
[Step=18050 Epoch=88.1] | Loss=0.00918 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.340 | acc=1.0000 | 1522.1 samples/s | 23.8 steps/s
[Step=18100 Epoch=88.3] | Loss=0.00862 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.342 | acc=1.0000 | 3972.7 samples/s | 62.1 steps/s
[Step=18150 Epoch=88.6] | Loss=0.00815 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.344 | acc=1.0000 | 3949.8 samples/s | 61.7 steps/s
[Step=18200 Epoch=88.8] | Loss=0.00785 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.346 | acc=1.0000 | 4566.0 samples/s | 71.3 steps/s
[Step=18250 Epoch=89.1] | Loss=0.00742 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.348 | acc=1.0000 | 1604.4 samples/s | 25.1 steps/s
[Step=18300 Epoch=89.3] | Loss=0.00705 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.350 | acc=1.0000 | 4747.5 samples/s | 74.2 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00687 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.352 | acc=1.0000 | 4574.5 samples/s | 71.5 steps/s
[Step=18400 Epoch=89.8] | Loss=0.00669 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.354 | acc=1.0000 | 5030.0 samples/s | 78.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step18400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00006, len=1
[Step=13601 Epoch=129.9] | Loss=0.10889 | Reg=0.00175 | L2-Norm=13.237 | L2-Norm(final)=3.330 | acc=0.9375 | 4132.4 samples/s | 64.6 steps/s
[Step=13650 Epoch=130.3] | Loss=0.00712 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.332 | acc=1.0000 | 4060.5 samples/s | 63.4 steps/s
[Step=13700 Epoch=130.8] | Loss=0.00364 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.333 | acc=1.0000 | 5320.2 samples/s | 83.1 steps/s
[Step=13750 Epoch=131.3] | Loss=0.00245 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.334 | acc=1.0000 | 1534.0 samples/s | 24.0 steps/s
[Step=13800 Epoch=131.8] | Loss=0.00185 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.334 | acc=1.0000 | 5178.9 samples/s | 80.9 steps/s
[Step=13850 Epoch=132.3] | Loss=0.00149 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.335 | acc=1.0000 | 1749.7 samples/s | 27.3 steps/s
[Step=13900 Epoch=132.7] | Loss=0.00125 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.335 | acc=1.0000 | 5010.5 samples/s | 78.3 steps/s
[Step=13950 Epoch=133.2] | Loss=0.00107 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.336 | acc=1.0000 | 1503.3 samples/s | 23.5 steps/s
[Step=14000 Epoch=133.7] | Loss=0.00094 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.336 | acc=1.0000 | 4032.0 samples/s | 63.0 steps/s
[Step=14050 Epoch=134.2] | Loss=0.00084 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.336 | acc=1.0000 | 1559.5 samples/s | 24.4 steps/s
[Step=14100 Epoch=134.6] | Loss=0.00076 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.336 | acc=1.0000 | 4791.4 samples/s | 74.9 steps/s
[Step=14150 Epoch=135.1] | Loss=0.00069 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.337 | acc=1.0000 | 1794.9 samples/s | 28.0 steps/s
[Step=14200 Epoch=135.6] | Loss=0.00064 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.337 | acc=1.0000 | 4561.7 samples/s | 71.3 steps/s
[Step=14250 Epoch=136.1] | Loss=0.00059 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.337 | acc=1.0000 | 1597.5 samples/s | 25.0 steps/s
[Step=14300 Epoch=136.6] | Loss=0.00055 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.338 | acc=1.0000 | 4517.6 samples/s | 70.6 steps/s
[Step=14350 Epoch=137.0] | Loss=0.00051 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.338 | acc=1.0000 | 1588.7 samples/s | 24.8 steps/s
[Step=14400 Epoch=137.5] | Loss=0.00048 | Reg=0.00175 | L2-Norm=13.247 | L2-Norm(final)=3.338 | acc=1.0000 | 4487.9 samples/s | 70.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step14400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00006, len=1
[Step=13601 Epoch=128.2] | Loss=0.04349 | Reg=0.00175 | L2-Norm=13.237 | L2-Norm(final)=3.330 | acc=0.9688 | 4127.3 samples/s | 64.5 steps/s
[Step=13650 Epoch=128.6] | Loss=0.00715 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.330 | acc=1.0000 | 4038.0 samples/s | 63.1 steps/s
[Step=13700 Epoch=129.1] | Loss=0.00361 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.330 | acc=1.0000 | 5277.2 samples/s | 82.5 steps/s
[Step=13750 Epoch=129.6] | Loss=0.00243 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.330 | acc=1.0000 | 1539.2 samples/s | 24.0 steps/s
[Step=13800 Epoch=130.0] | Loss=0.00183 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.331 | acc=1.0000 | 4918.5 samples/s | 76.9 steps/s
[Step=13850 Epoch=130.5] | Loss=0.00147 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.331 | acc=1.0000 | 1553.5 samples/s | 24.3 steps/s
[Step=13900 Epoch=131.0] | Loss=0.00123 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.331 | acc=1.0000 | 4777.3 samples/s | 74.6 steps/s
[Step=13950 Epoch=131.4] | Loss=0.00106 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.332 | acc=1.0000 | 1596.4 samples/s | 24.9 steps/s
[Step=14000 Epoch=131.9] | Loss=0.00093 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.332 | acc=1.0000 | 4703.5 samples/s | 73.5 steps/s
[Step=14050 Epoch=132.4] | Loss=0.00083 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.332 | acc=1.0000 | 1601.5 samples/s | 25.0 steps/s
[Step=14100 Epoch=132.9] | Loss=0.00075 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.332 | acc=1.0000 | 4408.7 samples/s | 68.9 steps/s
[Step=14150 Epoch=133.3] | Loss=0.00069 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.333 | acc=1.0000 | 1614.9 samples/s | 25.2 steps/s
[Step=14200 Epoch=133.8] | Loss=0.00063 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.333 | acc=1.0000 | 4554.5 samples/s | 71.2 steps/s
[Step=14250 Epoch=134.3] | Loss=0.00058 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.333 | acc=1.0000 | 1730.7 samples/s | 27.0 steps/s
[Step=14300 Epoch=134.7] | Loss=0.00054 | Reg=0.00175 | L2-Norm=13.247 | L2-Norm(final)=3.333 | acc=1.0000 | 3741.4 samples/s | 58.5 steps/s
[Step=14350 Epoch=135.2] | Loss=0.00051 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.334 | acc=1.0000 | 1625.6 samples/s | 25.4 steps/s
[Step=14400 Epoch=135.7] | Loss=0.00048 | Reg=0.00175 | L2-Norm=13.244 | L2-Norm(final)=3.334 | acc=1.0000 | 3715.0 samples/s | 58.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step14400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00006, len=1
[Step=19201 Epoch=183.0] | Loss=0.14566 | Reg=0.00175 | L2-Norm=13.237 | L2-Norm(final)=3.331 | acc=0.9219 | 4119.0 samples/s | 64.4 steps/s
[Step=19250 Epoch=183.5] | Loss=0.00650 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.334 | acc=1.0000 | 3953.3 samples/s | 61.8 steps/s
[Step=19300 Epoch=183.9] | Loss=0.00330 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.335 | acc=1.0000 | 4988.1 samples/s | 77.9 steps/s
[Step=19350 Epoch=184.4] | Loss=0.00224 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.336 | acc=1.0000 | 1475.2 samples/s | 23.1 steps/s
[Step=19400 Epoch=184.9] | Loss=0.00169 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.336 | acc=1.0000 | 4942.6 samples/s | 77.2 steps/s
[Step=19450 Epoch=185.4] | Loss=0.00136 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.337 | acc=1.0000 | 1569.5 samples/s | 24.5 steps/s
[Step=19500 Epoch=185.9] | Loss=0.00114 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.337 | acc=1.0000 | 4921.6 samples/s | 76.9 steps/s
[Step=19550 Epoch=186.3] | Loss=0.00098 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.337 | acc=1.0000 | 1577.3 samples/s | 24.6 steps/s
[Step=19600 Epoch=186.8] | Loss=0.00086 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.338 | acc=1.0000 | 4898.5 samples/s | 76.5 steps/s
[Step=19650 Epoch=187.3] | Loss=0.00077 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.338 | acc=1.0000 | 1505.0 samples/s | 23.5 steps/s
[Step=19700 Epoch=187.8] | Loss=0.00070 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.338 | acc=1.0000 | 4004.7 samples/s | 62.6 steps/s
[Step=19750 Epoch=188.2] | Loss=0.00064 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.338 | acc=1.0000 | 1532.4 samples/s | 23.9 steps/s
[Step=19800 Epoch=188.7] | Loss=0.00058 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.339 | acc=1.0000 | 3828.9 samples/s | 59.8 steps/s
[Step=19850 Epoch=189.2] | Loss=0.00054 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.339 | acc=1.0000 | 1609.8 samples/s | 25.2 steps/s
[Step=19900 Epoch=189.7] | Loss=0.00050 | Reg=0.00175 | L2-Norm=13.247 | L2-Norm(final)=3.339 | acc=1.0000 | 4362.7 samples/s | 68.2 steps/s
[Step=19950 Epoch=190.1] | Loss=0.00047 | Reg=0.00175 | L2-Norm=13.246 | L2-Norm(final)=3.340 | acc=1.0000 | 1619.0 samples/s | 25.3 steps/s
[Step=20000 Epoch=190.6] | Loss=0.00044 | Reg=0.00175 | L2-Norm=13.244 | L2-Norm(final)=3.340 | acc=1.0000 | 4563.2 samples/s | 71.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30399 | acc=0.8433 | tpr=0.7745 | fpr=0.0074 | 4786.3 samples/s | 18.7 steps/s
Avg test loss: 0.31102, Avg test acc: 0.84314, Avg tpr: 0.77549, Avg fpr: 0.00808, total FA: 63

Testing server on iccad2012
[Step=  50] | Loss=0.45184 | acc=0.8734 | tpr=0.9558 | fpr=0.1281 | 4591.8 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.45914 | acc=0.8733 | tpr=0.9638 | fpr=0.1284 | 9167.3 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.46618 | acc=0.8726 | tpr=0.9683 | fpr=0.1291 | 9257.0 samples/s | 36.2 steps/s
[Step= 200] | Loss=0.46923 | acc=0.8726 | tpr=0.9694 | fpr=0.1292 | 9405.3 samples/s | 36.7 steps/s
[Step= 250] | Loss=0.46803 | acc=0.8725 | tpr=0.9668 | fpr=0.1292 | 9513.7 samples/s | 37.2 steps/s
[Step= 300] | Loss=0.47313 | acc=0.8711 | tpr=0.9680 | fpr=0.1307 | 9211.1 samples/s | 36.0 steps/s
[Step= 350] | Loss=0.47440 | acc=0.8713 | tpr=0.9687 | fpr=0.1305 | 8709.4 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.47689 | acc=0.8712 | tpr=0.9694 | fpr=0.1306 | 9879.3 samples/s | 38.6 steps/s
[Step= 450] | Loss=0.48174 | acc=0.8708 | tpr=0.9688 | fpr=0.1310 | 8571.4 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.48057 | acc=0.8703 | tpr=0.9696 | fpr=0.1315 | 8763.1 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.47909 | acc=0.8703 | tpr=0.9682 | fpr=0.1315 | 16841.8 samples/s | 65.8 steps/s
Avg test loss: 0.47907, Avg test acc: 0.87034, Avg tpr: 0.96712, Avg fpr: 0.13142, total FA: 18247

server round 42/50

clients selected: [2 5 7 8 9]

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00006, len=1
[Step=15201 Epoch=74.1] | Loss=0.22749 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.337 | acc=0.8906 | 4038.8 samples/s | 63.1 steps/s
[Step=15250 Epoch=74.3] | Loss=0.03264 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.336 | acc=1.0000 | 4539.0 samples/s | 70.9 steps/s
[Step=15300 Epoch=74.5] | Loss=0.02175 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.336 | acc=1.0000 | 4539.4 samples/s | 70.9 steps/s
[Step=15350 Epoch=74.8] | Loss=0.01839 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.337 | acc=0.9844 | 4614.7 samples/s | 72.1 steps/s
[Step=15400 Epoch=75.0] | Loss=0.01623 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.338 | acc=1.0000 | 5461.8 samples/s | 85.3 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01404 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.339 | acc=1.0000 | 1571.4 samples/s | 24.6 steps/s
[Step=15500 Epoch=75.5] | Loss=0.01259 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.341 | acc=1.0000 | 4729.7 samples/s | 73.9 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01158 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.342 | acc=0.9844 | 4650.8 samples/s | 72.7 steps/s
[Step=15600 Epoch=76.0] | Loss=0.01081 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.344 | acc=0.9844 | 5282.4 samples/s | 82.5 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01003 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.346 | acc=1.0000 | 1588.7 samples/s | 24.8 steps/s
[Step=15700 Epoch=76.5] | Loss=0.00937 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.348 | acc=0.9844 | 4657.8 samples/s | 72.8 steps/s
[Step=15750 Epoch=76.7] | Loss=0.00893 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.350 | acc=1.0000 | 4692.9 samples/s | 73.3 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00856 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.352 | acc=1.0000 | 5138.0 samples/s | 80.3 steps/s
[Step=15850 Epoch=77.2] | Loss=0.00815 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.354 | acc=1.0000 | 1609.1 samples/s | 25.1 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00785 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.356 | acc=1.0000 | 4655.1 samples/s | 72.7 steps/s
[Step=15950 Epoch=77.7] | Loss=0.00762 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.358 | acc=1.0000 | 4609.1 samples/s | 72.0 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00736 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.360 | acc=1.0000 | 4888.9 samples/s | 76.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=18401 Epoch=174.4] | Loss=0.00239 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.338 | acc=1.0000 | 3857.2 samples/s | 60.3 steps/s
[Step=18450 Epoch=174.8] | Loss=0.00538 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.337 | acc=1.0000 | 4260.2 samples/s | 66.6 steps/s
[Step=18500 Epoch=175.3] | Loss=0.00282 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.338 | acc=1.0000 | 5227.9 samples/s | 81.7 steps/s
[Step=18550 Epoch=175.8] | Loss=0.00190 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.338 | acc=1.0000 | 1538.2 samples/s | 24.0 steps/s
[Step=18600 Epoch=176.3] | Loss=0.00144 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.339 | acc=1.0000 | 5023.4 samples/s | 78.5 steps/s
[Step=18650 Epoch=176.7] | Loss=0.00115 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.339 | acc=1.0000 | 1568.0 samples/s | 24.5 steps/s
[Step=18700 Epoch=177.2] | Loss=0.00097 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.340 | acc=1.0000 | 4815.2 samples/s | 75.2 steps/s
[Step=18750 Epoch=177.7] | Loss=0.00083 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.340 | acc=1.0000 | 1567.9 samples/s | 24.5 steps/s
[Step=18800 Epoch=178.1] | Loss=0.00073 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.340 | acc=1.0000 | 4721.8 samples/s | 73.8 steps/s
[Step=18850 Epoch=178.6] | Loss=0.00065 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.341 | acc=1.0000 | 1525.2 samples/s | 23.8 steps/s
[Step=18900 Epoch=179.1] | Loss=0.00059 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.341 | acc=1.0000 | 3876.7 samples/s | 60.6 steps/s
[Step=18950 Epoch=179.6] | Loss=0.00054 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.341 | acc=1.0000 | 1631.7 samples/s | 25.5 steps/s
[Step=19000 Epoch=180.0] | Loss=0.00049 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.342 | acc=1.0000 | 4393.1 samples/s | 68.6 steps/s
[Step=19050 Epoch=180.5] | Loss=0.00046 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.342 | acc=1.0000 | 1583.7 samples/s | 24.7 steps/s
[Step=19100 Epoch=181.0] | Loss=0.00042 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.342 | acc=1.0000 | 3794.9 samples/s | 59.3 steps/s
[Step=19150 Epoch=181.5] | Loss=0.00040 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.342 | acc=1.0000 | 1607.3 samples/s | 25.1 steps/s
[Step=19200 Epoch=181.9] | Loss=0.00037 | Reg=0.00175 | L2-Norm=13.247 | L2-Norm(final)=3.343 | acc=1.0000 | 4391.9 samples/s | 68.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step19200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00006, len=1
[Step=14401 Epoch=137.5] | Loss=0.00394 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.338 | acc=1.0000 | 4039.6 samples/s | 63.1 steps/s
[Step=14450 Epoch=138.0] | Loss=0.00396 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.343 | acc=1.0000 | 4148.9 samples/s | 64.8 steps/s
[Step=14500 Epoch=138.5] | Loss=0.00209 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.344 | acc=1.0000 | 5244.8 samples/s | 81.9 steps/s
[Step=14550 Epoch=138.9] | Loss=0.00142 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.345 | acc=1.0000 | 1535.9 samples/s | 24.0 steps/s
[Step=14600 Epoch=139.4] | Loss=0.00107 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.346 | acc=1.0000 | 5067.8 samples/s | 79.2 steps/s
[Step=14650 Epoch=139.9] | Loss=0.00087 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.347 | acc=1.0000 | 1532.2 samples/s | 23.9 steps/s
[Step=14700 Epoch=140.4] | Loss=0.00073 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.347 | acc=1.0000 | 4927.0 samples/s | 77.0 steps/s
[Step=14750 Epoch=140.9] | Loss=0.00063 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.347 | acc=1.0000 | 1556.4 samples/s | 24.3 steps/s
[Step=14800 Epoch=141.3] | Loss=0.00056 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.348 | acc=1.0000 | 4728.7 samples/s | 73.9 steps/s
[Step=14850 Epoch=141.8] | Loss=0.00050 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.348 | acc=1.0000 | 1582.8 samples/s | 24.7 steps/s
[Step=14900 Epoch=142.3] | Loss=0.00045 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.349 | acc=1.0000 | 4662.4 samples/s | 72.9 steps/s
[Step=14950 Epoch=142.8] | Loss=0.00041 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.349 | acc=1.0000 | 1580.7 samples/s | 24.7 steps/s
[Step=15000 Epoch=143.2] | Loss=0.00038 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.349 | acc=1.0000 | 4626.1 samples/s | 72.3 steps/s
[Step=15050 Epoch=143.7] | Loss=0.00035 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.349 | acc=1.0000 | 1595.3 samples/s | 24.9 steps/s
[Step=15100 Epoch=144.2] | Loss=0.00033 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.350 | acc=1.0000 | 4484.2 samples/s | 70.1 steps/s
[Step=15150 Epoch=144.7] | Loss=0.00031 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.350 | acc=1.0000 | 1586.2 samples/s | 24.8 steps/s
[Step=15200 Epoch=145.2] | Loss=0.00029 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.350 | acc=1.0000 | 3862.8 samples/s | 60.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step15200.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00006, len=1
[Step=14401 Epoch=135.7] | Loss=0.05150 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.338 | acc=0.9688 | 3355.4 samples/s | 52.4 steps/s
[Step=14450 Epoch=136.2] | Loss=0.00602 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.340 | acc=1.0000 | 4322.7 samples/s | 67.5 steps/s
[Step=14500 Epoch=136.6] | Loss=0.00307 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.341 | acc=1.0000 | 5175.0 samples/s | 80.9 steps/s
[Step=14550 Epoch=137.1] | Loss=0.00207 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.342 | acc=1.0000 | 1463.4 samples/s | 22.9 steps/s
[Step=14600 Epoch=137.6] | Loss=0.00156 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.342 | acc=1.0000 | 4363.4 samples/s | 68.2 steps/s
[Step=14650 Epoch=138.0] | Loss=0.00126 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.343 | acc=1.0000 | 1507.1 samples/s | 23.5 steps/s
[Step=14700 Epoch=138.5] | Loss=0.00105 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.343 | acc=1.0000 | 4734.3 samples/s | 74.0 steps/s
[Step=14750 Epoch=139.0] | Loss=0.00091 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.343 | acc=1.0000 | 1585.0 samples/s | 24.8 steps/s
[Step=14800 Epoch=139.5] | Loss=0.00079 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.344 | acc=1.0000 | 4655.7 samples/s | 72.7 steps/s
[Step=14850 Epoch=139.9] | Loss=0.00071 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.344 | acc=1.0000 | 1594.5 samples/s | 24.9 steps/s
[Step=14900 Epoch=140.4] | Loss=0.00064 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.344 | acc=1.0000 | 4502.6 samples/s | 70.4 steps/s
[Step=14950 Epoch=140.9] | Loss=0.00058 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.344 | acc=1.0000 | 1811.2 samples/s | 28.3 steps/s
[Step=15000 Epoch=141.3] | Loss=0.00054 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.344 | acc=1.0000 | 4404.1 samples/s | 68.8 steps/s
[Step=15050 Epoch=141.8] | Loss=0.00050 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.345 | acc=1.0000 | 1609.5 samples/s | 25.1 steps/s
[Step=15100 Epoch=142.3] | Loss=0.00046 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.345 | acc=1.0000 | 4551.0 samples/s | 71.1 steps/s
[Step=15150 Epoch=142.8] | Loss=0.00043 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.345 | acc=1.0000 | 1741.3 samples/s | 27.2 steps/s
[Step=15200 Epoch=143.2] | Loss=0.00041 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.345 | acc=1.0000 | 3651.0 samples/s | 57.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step15200.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00006, len=1
[Step=20001 Epoch=190.6] | Loss=0.04045 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.338 | acc=0.9844 | 3857.9 samples/s | 60.3 steps/s
[Step=20050 Epoch=191.1] | Loss=0.00699 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.341 | acc=1.0000 | 4254.0 samples/s | 66.5 steps/s
[Step=20100 Epoch=191.6] | Loss=0.00355 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.342 | acc=1.0000 | 5256.1 samples/s | 82.1 steps/s
[Step=20150 Epoch=192.0] | Loss=0.00239 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.342 | acc=1.0000 | 1540.7 samples/s | 24.1 steps/s
[Step=20200 Epoch=192.5] | Loss=0.00180 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.343 | acc=1.0000 | 5036.7 samples/s | 78.7 steps/s
[Step=20250 Epoch=193.0] | Loss=0.00145 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.343 | acc=1.0000 | 1562.8 samples/s | 24.4 steps/s
[Step=20300 Epoch=193.5] | Loss=0.00122 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.343 | acc=1.0000 | 4878.1 samples/s | 76.2 steps/s
[Step=20350 Epoch=194.0] | Loss=0.00105 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.344 | acc=1.0000 | 1556.5 samples/s | 24.3 steps/s
[Step=20400 Epoch=194.4] | Loss=0.00092 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.344 | acc=1.0000 | 4708.7 samples/s | 73.6 steps/s
[Step=20450 Epoch=194.9] | Loss=0.00082 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.344 | acc=1.0000 | 1580.1 samples/s | 24.7 steps/s
[Step=20500 Epoch=195.4] | Loss=0.00074 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.344 | acc=1.0000 | 4699.5 samples/s | 73.4 steps/s
[Step=20550 Epoch=195.9] | Loss=0.00068 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.345 | acc=1.0000 | 1577.7 samples/s | 24.7 steps/s
[Step=20600 Epoch=196.3] | Loss=0.00062 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.345 | acc=1.0000 | 4489.2 samples/s | 70.1 steps/s
[Step=20650 Epoch=196.8] | Loss=0.00058 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.345 | acc=1.0000 | 1561.4 samples/s | 24.4 steps/s
[Step=20700 Epoch=197.3] | Loss=0.00054 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.345 | acc=1.0000 | 3865.1 samples/s | 60.4 steps/s
[Step=20750 Epoch=197.8] | Loss=0.00050 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.346 | acc=1.0000 | 1592.5 samples/s | 24.9 steps/s
[Step=20800 Epoch=198.2] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.346 | acc=1.0000 | 4512.4 samples/s | 70.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31464 | acc=0.8391 | tpr=0.7683 | fpr=0.0072 | 4658.4 samples/s | 18.2 steps/s
Avg test loss: 0.32152, Avg test acc: 0.83857, Avg tpr: 0.76884, Avg fpr: 0.00808, total FA: 63

Testing server on iccad2012
[Step=  50] | Loss=0.44734 | acc=0.8751 | tpr=0.9602 | fpr=0.1265 | 4561.6 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.45477 | acc=0.8757 | tpr=0.9680 | fpr=0.1260 | 9428.6 samples/s | 36.8 steps/s
[Step= 150] | Loss=0.46208 | acc=0.8751 | tpr=0.9712 | fpr=0.1266 | 9687.2 samples/s | 37.8 steps/s
[Step= 200] | Loss=0.46511 | acc=0.8752 | tpr=0.9716 | fpr=0.1266 | 8625.5 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.46401 | acc=0.8749 | tpr=0.9686 | fpr=0.1268 | 9520.5 samples/s | 37.2 steps/s
[Step= 300] | Loss=0.46913 | acc=0.8734 | tpr=0.9695 | fpr=0.1284 | 9275.3 samples/s | 36.2 steps/s
[Step= 350] | Loss=0.47035 | acc=0.8735 | tpr=0.9699 | fpr=0.1282 | 9339.4 samples/s | 36.5 steps/s
[Step= 400] | Loss=0.47280 | acc=0.8736 | tpr=0.9705 | fpr=0.1282 | 8846.8 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.47767 | acc=0.8731 | tpr=0.9698 | fpr=0.1287 | 8990.0 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.47645 | acc=0.8726 | tpr=0.9705 | fpr=0.1292 | 8788.2 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.47503 | acc=0.8725 | tpr=0.9690 | fpr=0.1293 | 16922.4 samples/s | 66.1 steps/s
Avg test loss: 0.47500, Avg test acc: 0.87251, Avg tpr: 0.96791, Avg fpr: 0.12922, total FA: 17942

server round 43/50

clients selected: [1 5 7 8 9]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=18401 Epoch=89.8] | Loss=0.55576 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.346 | acc=0.7188 | 3824.1 samples/s | 59.8 steps/s
[Step=18450 Epoch=90.0] | Loss=0.03681 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.344 | acc=1.0000 | 4802.1 samples/s | 75.0 steps/s
[Step=18500 Epoch=90.3] | Loss=0.02445 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.344 | acc=1.0000 | 4607.4 samples/s | 72.0 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01982 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.344 | acc=0.9844 | 4572.3 samples/s | 71.4 steps/s
[Step=18600 Epoch=90.8] | Loss=0.01677 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.345 | acc=1.0000 | 5524.3 samples/s | 86.3 steps/s
[Step=18650 Epoch=91.0] | Loss=0.01453 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.347 | acc=1.0000 | 1605.7 samples/s | 25.1 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01278 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.348 | acc=1.0000 | 4627.1 samples/s | 72.3 steps/s
[Step=18750 Epoch=91.5] | Loss=0.01162 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.350 | acc=1.0000 | 4643.2 samples/s | 72.6 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01083 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.351 | acc=0.9844 | 5422.8 samples/s | 84.7 steps/s
[Step=18850 Epoch=92.0] | Loss=0.00997 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.353 | acc=1.0000 | 1590.1 samples/s | 24.8 steps/s
[Step=18900 Epoch=92.2] | Loss=0.00933 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.355 | acc=1.0000 | 4554.2 samples/s | 71.2 steps/s
[Step=18950 Epoch=92.5] | Loss=0.00888 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.356 | acc=1.0000 | 4621.9 samples/s | 72.2 steps/s
[Step=19000 Epoch=92.7] | Loss=0.00839 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.358 | acc=1.0000 | 5187.8 samples/s | 81.1 steps/s
[Step=19050 Epoch=93.0] | Loss=0.00802 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.360 | acc=1.0000 | 1631.4 samples/s | 25.5 steps/s
[Step=19100 Epoch=93.2] | Loss=0.00764 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.361 | acc=1.0000 | 4638.8 samples/s | 72.5 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00731 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.363 | acc=1.0000 | 4660.5 samples/s | 72.8 steps/s
[Step=19200 Epoch=93.7] | Loss=0.00710 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.365 | acc=1.0000 | 4984.8 samples/s | 77.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step19200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=19201 Epoch=181.9] | Loss=0.07026 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.346 | acc=0.9688 | 3430.9 samples/s | 53.6 steps/s
[Step=19250 Epoch=182.4] | Loss=0.00474 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.348 | acc=1.0000 | 4075.6 samples/s | 63.7 steps/s
[Step=19300 Epoch=182.9] | Loss=0.00247 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.349 | acc=1.0000 | 5148.9 samples/s | 80.5 steps/s
[Step=19350 Epoch=183.4] | Loss=0.00166 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.350 | acc=1.0000 | 1519.3 samples/s | 23.7 steps/s
[Step=19400 Epoch=183.8] | Loss=0.00126 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.350 | acc=1.0000 | 5089.1 samples/s | 79.5 steps/s
[Step=19450 Epoch=184.3] | Loss=0.00101 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.351 | acc=1.0000 | 1545.0 samples/s | 24.1 steps/s
[Step=19500 Epoch=184.8] | Loss=0.00085 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.351 | acc=1.0000 | 4750.8 samples/s | 74.2 steps/s
[Step=19550 Epoch=185.3] | Loss=0.00073 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.351 | acc=1.0000 | 1586.8 samples/s | 24.8 steps/s
[Step=19600 Epoch=185.7] | Loss=0.00064 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.352 | acc=1.0000 | 4758.5 samples/s | 74.4 steps/s
[Step=19650 Epoch=186.2] | Loss=0.00057 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.352 | acc=1.0000 | 1521.1 samples/s | 23.8 steps/s
[Step=19700 Epoch=186.7] | Loss=0.00052 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.352 | acc=1.0000 | 3917.6 samples/s | 61.2 steps/s
[Step=19750 Epoch=187.1] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.352 | acc=1.0000 | 1601.8 samples/s | 25.0 steps/s
[Step=19800 Epoch=187.6] | Loss=0.00043 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.353 | acc=1.0000 | 4377.0 samples/s | 68.4 steps/s
[Step=19850 Epoch=188.1] | Loss=0.00040 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.353 | acc=1.0000 | 1647.2 samples/s | 25.7 steps/s
[Step=19900 Epoch=188.6] | Loss=0.00037 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.353 | acc=1.0000 | 4347.4 samples/s | 67.9 steps/s
[Step=19950 Epoch=189.0] | Loss=0.00035 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.353 | acc=1.0000 | 1645.1 samples/s | 25.7 steps/s
[Step=20000 Epoch=189.5] | Loss=0.00033 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.354 | acc=1.0000 | 4496.8 samples/s | 70.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00006, len=1
[Step=15201 Epoch=145.2] | Loss=0.01932 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.346 | acc=0.9844 | 3935.9 samples/s | 61.5 steps/s
[Step=15250 Epoch=145.6] | Loss=0.00360 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.349 | acc=1.0000 | 4195.5 samples/s | 65.6 steps/s
[Step=15300 Epoch=146.1] | Loss=0.00203 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.351 | acc=1.0000 | 5346.8 samples/s | 83.5 steps/s
[Step=15350 Epoch=146.6] | Loss=0.00137 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.352 | acc=1.0000 | 1516.5 samples/s | 23.7 steps/s
[Step=15400 Epoch=147.1] | Loss=0.00104 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.353 | acc=1.0000 | 5075.2 samples/s | 79.3 steps/s
[Step=15450 Epoch=147.5] | Loss=0.00084 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.353 | acc=1.0000 | 1544.0 samples/s | 24.1 steps/s
[Step=15500 Epoch=148.0] | Loss=0.00070 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.354 | acc=1.0000 | 4873.7 samples/s | 76.2 steps/s
[Step=15550 Epoch=148.5] | Loss=0.00060 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.354 | acc=1.0000 | 1544.2 samples/s | 24.1 steps/s
[Step=15600 Epoch=149.0] | Loss=0.00053 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.354 | acc=1.0000 | 4867.7 samples/s | 76.1 steps/s
[Step=15650 Epoch=149.4] | Loss=0.00048 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.355 | acc=1.0000 | 1570.5 samples/s | 24.5 steps/s
[Step=15700 Epoch=149.9] | Loss=0.00043 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.355 | acc=1.0000 | 4575.6 samples/s | 71.5 steps/s
[Step=15750 Epoch=150.4] | Loss=0.00039 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.355 | acc=1.0000 | 1581.0 samples/s | 24.7 steps/s
[Step=15800 Epoch=150.9] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.355 | acc=1.0000 | 4654.8 samples/s | 72.7 steps/s
[Step=15850 Epoch=151.4] | Loss=0.00033 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.356 | acc=1.0000 | 1605.1 samples/s | 25.1 steps/s
[Step=15900 Epoch=151.8] | Loss=0.00031 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.356 | acc=1.0000 | 4582.8 samples/s | 71.6 steps/s
[Step=15950 Epoch=152.3] | Loss=0.00029 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.356 | acc=1.0000 | 1610.1 samples/s | 25.2 steps/s
[Step=16000 Epoch=152.8] | Loss=0.00027 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.356 | acc=1.0000 | 4493.8 samples/s | 70.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step16000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00006, len=1
[Step=15201 Epoch=143.2] | Loss=0.04305 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.346 | acc=0.9688 | 4008.6 samples/s | 62.6 steps/s
[Step=15250 Epoch=143.7] | Loss=0.00380 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.350 | acc=1.0000 | 4155.3 samples/s | 64.9 steps/s
[Step=15300 Epoch=144.2] | Loss=0.00194 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.352 | acc=1.0000 | 5212.2 samples/s | 81.4 steps/s
[Step=15350 Epoch=144.6] | Loss=0.00131 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.352 | acc=1.0000 | 1520.3 samples/s | 23.8 steps/s
[Step=15400 Epoch=145.1] | Loss=0.00099 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.353 | acc=1.0000 | 4984.1 samples/s | 77.9 steps/s
[Step=15450 Epoch=145.6] | Loss=0.00080 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.353 | acc=1.0000 | 1573.3 samples/s | 24.6 steps/s
[Step=15500 Epoch=146.1] | Loss=0.00068 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.353 | acc=1.0000 | 4718.5 samples/s | 73.7 steps/s
[Step=15550 Epoch=146.5] | Loss=0.00058 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.354 | acc=1.0000 | 1565.1 samples/s | 24.5 steps/s
[Step=15600 Epoch=147.0] | Loss=0.00051 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.354 | acc=1.0000 | 4642.4 samples/s | 72.5 steps/s
[Step=15650 Epoch=147.5] | Loss=0.00046 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.354 | acc=1.0000 | 1561.1 samples/s | 24.4 steps/s
[Step=15700 Epoch=147.9] | Loss=0.00042 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.355 | acc=1.0000 | 3812.2 samples/s | 59.6 steps/s
[Step=15750 Epoch=148.4] | Loss=0.00038 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.355 | acc=1.0000 | 1609.9 samples/s | 25.2 steps/s
[Step=15800 Epoch=148.9] | Loss=0.00035 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.355 | acc=1.0000 | 4472.7 samples/s | 69.9 steps/s
[Step=15850 Epoch=149.4] | Loss=0.00032 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.355 | acc=1.0000 | 1638.2 samples/s | 25.6 steps/s
[Step=15900 Epoch=149.8] | Loss=0.00030 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.355 | acc=1.0000 | 4367.9 samples/s | 68.2 steps/s
[Step=15950 Epoch=150.3] | Loss=0.00028 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.356 | acc=1.0000 | 1683.1 samples/s | 26.3 steps/s
[Step=16000 Epoch=150.8] | Loss=0.00027 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.356 | acc=1.0000 | 4221.1 samples/s | 66.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step16000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00006, len=1
[Step=20801 Epoch=198.3] | Loss=0.06023 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.346 | acc=0.9531 | 3860.6 samples/s | 60.3 steps/s
[Step=20850 Epoch=198.7] | Loss=0.00429 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.351 | acc=1.0000 | 4075.1 samples/s | 63.7 steps/s
[Step=20900 Epoch=199.2] | Loss=0.00219 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.352 | acc=1.0000 | 5189.4 samples/s | 81.1 steps/s
[Step=20950 Epoch=199.7] | Loss=0.00148 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.353 | acc=1.0000 | 1529.8 samples/s | 23.9 steps/s
[Step=21000 Epoch=200.1] | Loss=0.00112 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.353 | acc=1.0000 | 5057.7 samples/s | 79.0 steps/s
[Step=21050 Epoch=200.6] | Loss=0.00090 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.354 | acc=1.0000 | 1564.7 samples/s | 24.4 steps/s
[Step=21100 Epoch=201.1] | Loss=0.00076 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.354 | acc=1.0000 | 4945.9 samples/s | 77.3 steps/s
[Step=21150 Epoch=201.6] | Loss=0.00066 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.354 | acc=1.0000 | 1768.7 samples/s | 27.6 steps/s
[Step=21200 Epoch=202.1] | Loss=0.00058 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.354 | acc=1.0000 | 4697.8 samples/s | 73.4 steps/s
[Step=21250 Epoch=202.5] | Loss=0.00052 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.355 | acc=1.0000 | 1512.5 samples/s | 23.6 steps/s
[Step=21300 Epoch=203.0] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.355 | acc=1.0000 | 3931.0 samples/s | 61.4 steps/s
[Step=21350 Epoch=203.5] | Loss=0.00043 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.355 | acc=1.0000 | 1590.9 samples/s | 24.9 steps/s
[Step=21400 Epoch=204.0] | Loss=0.00039 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.355 | acc=1.0000 | 4536.4 samples/s | 70.9 steps/s
[Step=21450 Epoch=204.4] | Loss=0.00037 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.356 | acc=1.0000 | 1628.6 samples/s | 25.4 steps/s
[Step=21500 Epoch=204.9] | Loss=0.00034 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.356 | acc=1.0000 | 4358.0 samples/s | 68.1 steps/s
[Step=21550 Epoch=205.4] | Loss=0.00032 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.356 | acc=1.0000 | 1592.1 samples/s | 24.9 steps/s
[Step=21600 Epoch=205.9] | Loss=0.00030 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.356 | acc=1.0000 | 4535.3 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30010 | acc=0.8474 | tpr=0.7806 | fpr=0.0074 | 4651.3 samples/s | 18.2 steps/s
Avg test loss: 0.30678, Avg test acc: 0.84658, Avg tpr: 0.78067, Avg fpr: 0.00846, total FA: 66

Testing server on iccad2012
[Step=  50] | Loss=0.46384 | acc=0.8718 | tpr=0.9602 | fpr=0.1298 | 4558.0 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.47124 | acc=0.8718 | tpr=0.9680 | fpr=0.1300 | 9258.2 samples/s | 36.2 steps/s
[Step= 150] | Loss=0.47851 | acc=0.8710 | tpr=0.9697 | fpr=0.1308 | 9312.5 samples/s | 36.4 steps/s
[Step= 200] | Loss=0.48164 | acc=0.8709 | tpr=0.9705 | fpr=0.1309 | 9211.5 samples/s | 36.0 steps/s
[Step= 250] | Loss=0.48065 | acc=0.8707 | tpr=0.9677 | fpr=0.1310 | 9666.5 samples/s | 37.8 steps/s
[Step= 300] | Loss=0.48594 | acc=0.8694 | tpr=0.9687 | fpr=0.1324 | 8830.1 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.48719 | acc=0.8697 | tpr=0.9693 | fpr=0.1322 | 9357.1 samples/s | 36.6 steps/s
[Step= 400] | Loss=0.48957 | acc=0.8697 | tpr=0.9699 | fpr=0.1321 | 9594.2 samples/s | 37.5 steps/s
[Step= 450] | Loss=0.49442 | acc=0.8693 | tpr=0.9693 | fpr=0.1325 | 8542.5 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.49325 | acc=0.8688 | tpr=0.9700 | fpr=0.1330 | 9213.4 samples/s | 36.0 steps/s
[Step= 550] | Loss=0.49176 | acc=0.8688 | tpr=0.9686 | fpr=0.1331 | 17094.4 samples/s | 66.8 steps/s
Avg test loss: 0.49177, Avg test acc: 0.86877, Avg tpr: 0.96751, Avg fpr: 0.13302, total FA: 18470

server round 44/50

clients selected: [1 2 3 8 9]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=19201 Epoch=93.7] | Loss=0.16970 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.350 | acc=0.8750 | 3924.6 samples/s | 61.3 steps/s
[Step=19250 Epoch=93.9] | Loss=0.04011 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.347 | acc=0.9844 | 4690.0 samples/s | 73.3 steps/s
[Step=19300 Epoch=94.2] | Loss=0.02601 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.346 | acc=1.0000 | 4603.0 samples/s | 71.9 steps/s
[Step=19350 Epoch=94.4] | Loss=0.02098 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.346 | acc=1.0000 | 4752.4 samples/s | 74.3 steps/s
[Step=19400 Epoch=94.7] | Loss=0.01772 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.346 | acc=1.0000 | 5261.0 samples/s | 82.2 steps/s
[Step=19450 Epoch=94.9] | Loss=0.01528 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.348 | acc=0.9844 | 1498.1 samples/s | 23.4 steps/s
[Step=19500 Epoch=95.2] | Loss=0.01337 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.349 | acc=0.9844 | 3986.7 samples/s | 62.3 steps/s
[Step=19550 Epoch=95.4] | Loss=0.01232 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.351 | acc=1.0000 | 3930.4 samples/s | 61.4 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01147 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.352 | acc=1.0000 | 4734.1 samples/s | 74.0 steps/s
[Step=19650 Epoch=95.9] | Loss=0.01061 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.354 | acc=0.9844 | 1592.0 samples/s | 24.9 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00991 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.355 | acc=1.0000 | 4681.6 samples/s | 73.1 steps/s
[Step=19750 Epoch=96.4] | Loss=0.00934 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.357 | acc=1.0000 | 4658.0 samples/s | 72.8 steps/s
[Step=19800 Epoch=96.6] | Loss=0.00888 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.359 | acc=1.0000 | 5055.3 samples/s | 79.0 steps/s
[Step=19850 Epoch=96.9] | Loss=0.00845 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.360 | acc=1.0000 | 1548.3 samples/s | 24.2 steps/s
[Step=19900 Epoch=97.1] | Loss=0.00804 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.362 | acc=1.0000 | 3914.8 samples/s | 61.2 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00770 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.364 | acc=1.0000 | 3957.2 samples/s | 61.8 steps/s
[Step=20000 Epoch=97.6] | Loss=0.00750 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.365 | acc=1.0000 | 4365.7 samples/s | 68.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step20000.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00006, len=1
[Step=16001 Epoch=78.0] | Loss=0.14332 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.350 | acc=0.8906 | 3255.3 samples/s | 50.9 steps/s
[Step=16050 Epoch=78.2] | Loss=0.03151 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.347 | acc=1.0000 | 4679.7 samples/s | 73.1 steps/s
[Step=16100 Epoch=78.4] | Loss=0.02122 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.346 | acc=1.0000 | 4719.3 samples/s | 73.7 steps/s
[Step=16150 Epoch=78.7] | Loss=0.01866 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.346 | acc=0.9844 | 4689.4 samples/s | 73.3 steps/s
[Step=16200 Epoch=78.9] | Loss=0.01666 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.347 | acc=1.0000 | 5465.7 samples/s | 85.4 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01439 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.348 | acc=0.9844 | 1583.8 samples/s | 24.7 steps/s
[Step=16300 Epoch=79.4] | Loss=0.01277 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.349 | acc=1.0000 | 4673.6 samples/s | 73.0 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01174 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.351 | acc=1.0000 | 4651.6 samples/s | 72.7 steps/s
[Step=16400 Epoch=79.9] | Loss=0.01107 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.352 | acc=1.0000 | 5272.0 samples/s | 82.4 steps/s
[Step=16450 Epoch=80.2] | Loss=0.01036 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.354 | acc=1.0000 | 1592.5 samples/s | 24.9 steps/s
[Step=16500 Epoch=80.4] | Loss=0.00964 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.356 | acc=0.9844 | 4629.6 samples/s | 72.3 steps/s
[Step=16550 Epoch=80.6] | Loss=0.00919 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.358 | acc=1.0000 | 4539.6 samples/s | 70.9 steps/s
[Step=16600 Epoch=80.9] | Loss=0.00877 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.359 | acc=1.0000 | 5114.6 samples/s | 79.9 steps/s
[Step=16650 Epoch=81.1] | Loss=0.00839 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.361 | acc=0.9688 | 1621.4 samples/s | 25.3 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00800 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.363 | acc=1.0000 | 4713.4 samples/s | 73.6 steps/s
[Step=16750 Epoch=81.6] | Loss=0.00769 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.365 | acc=1.0000 | 4645.5 samples/s | 72.6 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00749 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.367 | acc=1.0000 | 4913.8 samples/s | 76.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step16800.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00006, len=1
[Step=13601 Epoch=66.3] | Loss=0.21332 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.350 | acc=0.8438 | 4119.9 samples/s | 64.4 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03349 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.348 | acc=1.0000 | 4520.4 samples/s | 70.6 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02080 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.348 | acc=0.9844 | 4538.0 samples/s | 70.9 steps/s
[Step=13750 Epoch=67.1] | Loss=0.01785 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.349 | acc=0.9844 | 4581.4 samples/s | 71.6 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01527 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.350 | acc=0.9844 | 5416.1 samples/s | 84.6 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01305 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.351 | acc=1.0000 | 1563.2 samples/s | 24.4 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01165 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.353 | acc=1.0000 | 4566.8 samples/s | 71.4 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01080 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.354 | acc=1.0000 | 4583.1 samples/s | 71.6 steps/s
[Step=14000 Epoch=68.3] | Loss=0.00999 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.356 | acc=0.9844 | 5189.9 samples/s | 81.1 steps/s
[Step=14050 Epoch=68.5] | Loss=0.00924 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.357 | acc=1.0000 | 1595.3 samples/s | 24.9 steps/s
[Step=14100 Epoch=68.8] | Loss=0.00878 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.359 | acc=1.0000 | 4603.9 samples/s | 71.9 steps/s
[Step=14150 Epoch=69.0] | Loss=0.00825 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.361 | acc=1.0000 | 4694.8 samples/s | 73.4 steps/s
[Step=14200 Epoch=69.2] | Loss=0.00783 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.362 | acc=1.0000 | 5045.4 samples/s | 78.8 steps/s
[Step=14250 Epoch=69.5] | Loss=0.00748 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.364 | acc=1.0000 | 1583.3 samples/s | 24.7 steps/s
[Step=14300 Epoch=69.7] | Loss=0.00714 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.365 | acc=1.0000 | 4702.1 samples/s | 73.5 steps/s
[Step=14350 Epoch=70.0] | Loss=0.00688 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.367 | acc=1.0000 | 4634.9 samples/s | 72.4 steps/s
[Step=14400 Epoch=70.2] | Loss=0.00665 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.368 | acc=0.9844 | 4857.6 samples/s | 75.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step14400.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00006, len=1
[Step=16001 Epoch=150.8] | Loss=0.12229 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.350 | acc=0.9688 | 3854.8 samples/s | 60.2 steps/s
[Step=16050 Epoch=151.2] | Loss=0.00647 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.353 | acc=1.0000 | 4238.8 samples/s | 66.2 steps/s
[Step=16100 Epoch=151.7] | Loss=0.00328 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.354 | acc=1.0000 | 5263.8 samples/s | 82.2 steps/s
[Step=16150 Epoch=152.2] | Loss=0.00219 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.355 | acc=1.0000 | 1551.2 samples/s | 24.2 steps/s
[Step=16200 Epoch=152.7] | Loss=0.00165 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.355 | acc=1.0000 | 5167.9 samples/s | 80.7 steps/s
[Step=16250 Epoch=153.1] | Loss=0.00133 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.355 | acc=1.0000 | 1560.0 samples/s | 24.4 steps/s
[Step=16300 Epoch=153.6] | Loss=0.00111 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.355 | acc=1.0000 | 4771.0 samples/s | 74.5 steps/s
[Step=16350 Epoch=154.1] | Loss=0.00095 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.356 | acc=1.0000 | 1590.4 samples/s | 24.9 steps/s
[Step=16400 Epoch=154.5] | Loss=0.00084 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.356 | acc=1.0000 | 4526.6 samples/s | 70.7 steps/s
[Step=16450 Epoch=155.0] | Loss=0.00074 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.356 | acc=1.0000 | 1609.5 samples/s | 25.1 steps/s
[Step=16500 Epoch=155.5] | Loss=0.00067 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.356 | acc=1.0000 | 4473.5 samples/s | 69.9 steps/s
[Step=16550 Epoch=155.9] | Loss=0.00061 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.356 | acc=1.0000 | 1598.5 samples/s | 25.0 steps/s
[Step=16600 Epoch=156.4] | Loss=0.00056 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.356 | acc=1.0000 | 4506.1 samples/s | 70.4 steps/s
[Step=16650 Epoch=156.9] | Loss=0.00052 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.356 | acc=1.0000 | 1643.6 samples/s | 25.7 steps/s
[Step=16700 Epoch=157.4] | Loss=0.00048 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.357 | acc=1.0000 | 4448.2 samples/s | 69.5 steps/s
[Step=16750 Epoch=157.8] | Loss=0.00045 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.357 | acc=1.0000 | 1711.5 samples/s | 26.7 steps/s
[Step=16800 Epoch=158.3] | Loss=0.00042 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.357 | acc=1.0000 | 3883.7 samples/s | 60.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step16800.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00006, len=1
[Step=21601 Epoch=205.9] | Loss=0.10639 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.350 | acc=0.9531 | 3955.8 samples/s | 61.8 steps/s
[Step=21650 Epoch=206.3] | Loss=0.00597 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.352 | acc=1.0000 | 4154.6 samples/s | 64.9 steps/s
[Step=21700 Epoch=206.8] | Loss=0.00307 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.352 | acc=1.0000 | 5271.7 samples/s | 82.4 steps/s
[Step=21750 Epoch=207.3] | Loss=0.00207 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.353 | acc=1.0000 | 1540.2 samples/s | 24.1 steps/s
[Step=21800 Epoch=207.8] | Loss=0.00156 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.354 | acc=1.0000 | 5169.0 samples/s | 80.8 steps/s
[Step=21850 Epoch=208.3] | Loss=0.00126 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.354 | acc=1.0000 | 1567.8 samples/s | 24.5 steps/s
[Step=21900 Epoch=208.7] | Loss=0.00105 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.354 | acc=1.0000 | 5014.6 samples/s | 78.4 steps/s
[Step=21950 Epoch=209.2] | Loss=0.00091 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.355 | acc=1.0000 | 1546.0 samples/s | 24.2 steps/s
[Step=22000 Epoch=209.7] | Loss=0.00080 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.355 | acc=1.0000 | 4621.8 samples/s | 72.2 steps/s
[Step=22050 Epoch=210.2] | Loss=0.00071 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.355 | acc=1.0000 | 1572.3 samples/s | 24.6 steps/s
[Step=22100 Epoch=210.6] | Loss=0.00065 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.356 | acc=1.0000 | 4614.3 samples/s | 72.1 steps/s
[Step=22150 Epoch=211.1] | Loss=0.00059 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.356 | acc=1.0000 | 1582.6 samples/s | 24.7 steps/s
[Step=22200 Epoch=211.6] | Loss=0.00054 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.356 | acc=1.0000 | 4479.0 samples/s | 70.0 steps/s
[Step=22250 Epoch=212.1] | Loss=0.00050 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.356 | acc=1.0000 | 1562.7 samples/s | 24.4 steps/s
[Step=22300 Epoch=212.5] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.357 | acc=1.0000 | 3818.0 samples/s | 59.7 steps/s
[Step=22350 Epoch=213.0] | Loss=0.00044 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.357 | acc=1.0000 | 1598.8 samples/s | 25.0 steps/s
[Step=22400 Epoch=213.5] | Loss=0.00041 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.357 | acc=1.0000 | 4443.8 samples/s | 69.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30434 | acc=0.8443 | tpr=0.7762 | fpr=0.0079 | 4585.6 samples/s | 17.9 steps/s
Avg test loss: 0.31123, Avg test acc: 0.84378, Avg tpr: 0.77665, Avg fpr: 0.00859, total FA: 67

Testing server on iccad2012
[Step=  50] | Loss=0.44878 | acc=0.8764 | tpr=0.9602 | fpr=0.1251 | 4573.2 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.45569 | acc=0.8775 | tpr=0.9680 | fpr=0.1242 | 9108.5 samples/s | 35.6 steps/s
[Step= 150] | Loss=0.46278 | acc=0.8771 | tpr=0.9697 | fpr=0.1246 | 9578.4 samples/s | 37.4 steps/s
[Step= 200] | Loss=0.46601 | acc=0.8768 | tpr=0.9705 | fpr=0.1249 | 9021.9 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.46493 | acc=0.8767 | tpr=0.9694 | fpr=0.1250 | 9255.6 samples/s | 36.2 steps/s
[Step= 300] | Loss=0.46999 | acc=0.8754 | tpr=0.9702 | fpr=0.1263 | 9239.0 samples/s | 36.1 steps/s
[Step= 350] | Loss=0.47114 | acc=0.8756 | tpr=0.9706 | fpr=0.1262 | 9482.2 samples/s | 37.0 steps/s
[Step= 400] | Loss=0.47355 | acc=0.8755 | tpr=0.9710 | fpr=0.1262 | 8896.0 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.47846 | acc=0.8751 | tpr=0.9703 | fpr=0.1267 | 9363.6 samples/s | 36.6 steps/s
[Step= 500] | Loss=0.47723 | acc=0.8746 | tpr=0.9705 | fpr=0.1271 | 9066.2 samples/s | 35.4 steps/s
[Step= 550] | Loss=0.47576 | acc=0.8746 | tpr=0.9690 | fpr=0.1271 | 16541.4 samples/s | 64.6 steps/s
Avg test loss: 0.47574, Avg test acc: 0.87459, Avg tpr: 0.96791, Avg fpr: 0.12710, total FA: 17648

server round 45/50

clients selected: [2 5 6 8 9]

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00006, len=1
[Step=16801 Epoch=81.9] | Loss=0.22996 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.357 | acc=0.8750 | 3776.5 samples/s | 59.0 steps/s
[Step=16850 Epoch=82.1] | Loss=0.03591 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.354 | acc=1.0000 | 4701.4 samples/s | 73.5 steps/s
[Step=16900 Epoch=82.3] | Loss=0.02594 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.353 | acc=1.0000 | 4680.8 samples/s | 73.1 steps/s
[Step=16950 Epoch=82.6] | Loss=0.02007 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.353 | acc=1.0000 | 4668.9 samples/s | 73.0 steps/s
[Step=17000 Epoch=82.8] | Loss=0.01728 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.354 | acc=0.9844 | 5266.4 samples/s | 82.3 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01499 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.356 | acc=1.0000 | 1588.2 samples/s | 24.8 steps/s
[Step=17100 Epoch=83.3] | Loss=0.01332 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.357 | acc=1.0000 | 4235.0 samples/s | 66.2 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01232 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.359 | acc=1.0000 | 4159.7 samples/s | 65.0 steps/s
[Step=17200 Epoch=83.8] | Loss=0.01154 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.361 | acc=1.0000 | 4904.8 samples/s | 76.6 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01074 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.362 | acc=1.0000 | 1608.0 samples/s | 25.1 steps/s
[Step=17300 Epoch=84.3] | Loss=0.01007 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.364 | acc=1.0000 | 4578.2 samples/s | 71.5 steps/s
[Step=17350 Epoch=84.5] | Loss=0.00960 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.366 | acc=1.0000 | 4687.3 samples/s | 73.2 steps/s
[Step=17400 Epoch=84.8] | Loss=0.00912 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.368 | acc=1.0000 | 4973.8 samples/s | 77.7 steps/s
[Step=17450 Epoch=85.0] | Loss=0.00871 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.369 | acc=1.0000 | 1654.3 samples/s | 25.8 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00836 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.371 | acc=1.0000 | 4615.8 samples/s | 72.1 steps/s
[Step=17550 Epoch=85.5] | Loss=0.00800 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.373 | acc=1.0000 | 4633.9 samples/s | 72.4 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00771 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.375 | acc=1.0000 | 4791.2 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step17600.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=20001 Epoch=189.5] | Loss=0.09291 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.357 | acc=0.9688 | 3922.1 samples/s | 61.3 steps/s
[Step=20050 Epoch=190.0] | Loss=0.00483 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.359 | acc=1.0000 | 4212.2 samples/s | 65.8 steps/s
[Step=20100 Epoch=190.5] | Loss=0.00245 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.360 | acc=1.0000 | 5276.7 samples/s | 82.4 steps/s
[Step=20150 Epoch=190.9] | Loss=0.00165 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.361 | acc=1.0000 | 1567.2 samples/s | 24.5 steps/s
[Step=20200 Epoch=191.4] | Loss=0.00125 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.361 | acc=1.0000 | 4998.4 samples/s | 78.1 steps/s
[Step=20250 Epoch=191.9] | Loss=0.00100 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.362 | acc=1.0000 | 1482.5 samples/s | 23.2 steps/s
[Step=20300 Epoch=192.4] | Loss=0.00084 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.362 | acc=1.0000 | 4216.4 samples/s | 65.9 steps/s
[Step=20350 Epoch=192.8] | Loss=0.00072 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.363 | acc=1.0000 | 1570.9 samples/s | 24.5 steps/s
[Step=20400 Epoch=193.3] | Loss=0.00064 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.363 | acc=1.0000 | 4723.5 samples/s | 73.8 steps/s
[Step=20450 Epoch=193.8] | Loss=0.00057 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.363 | acc=1.0000 | 1594.9 samples/s | 24.9 steps/s
[Step=20500 Epoch=194.3] | Loss=0.00051 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.363 | acc=1.0000 | 4575.6 samples/s | 71.5 steps/s
[Step=20550 Epoch=194.7] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.364 | acc=1.0000 | 1598.1 samples/s | 25.0 steps/s
[Step=20600 Epoch=195.2] | Loss=0.00043 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.364 | acc=1.0000 | 4514.2 samples/s | 70.5 steps/s
[Step=20650 Epoch=195.7] | Loss=0.00040 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.364 | acc=1.0000 | 1632.8 samples/s | 25.5 steps/s
[Step=20700 Epoch=196.2] | Loss=0.00037 | Reg=0.00175 | L2-Norm=13.247 | L2-Norm(final)=3.365 | acc=1.0000 | 4479.2 samples/s | 70.0 steps/s
[Step=20750 Epoch=196.6] | Loss=0.00035 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.365 | acc=1.0000 | 1593.6 samples/s | 24.9 steps/s
[Step=20800 Epoch=197.1] | Loss=0.00033 | Reg=0.00175 | L2-Norm=13.243 | L2-Norm(final)=3.365 | acc=1.0000 | 4552.9 samples/s | 71.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20800.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=19201 Epoch=182.6] | Loss=0.08110 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.357 | acc=0.9531 | 3709.3 samples/s | 58.0 steps/s
[Step=19250 Epoch=183.1] | Loss=0.00626 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.359 | acc=1.0000 | 4407.3 samples/s | 68.9 steps/s
[Step=19300 Epoch=183.6] | Loss=0.00317 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.359 | acc=1.0000 | 5310.7 samples/s | 83.0 steps/s
[Step=19350 Epoch=184.1] | Loss=0.00212 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.359 | acc=1.0000 | 1518.6 samples/s | 23.7 steps/s
[Step=19400 Epoch=184.5] | Loss=0.00160 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.359 | acc=1.0000 | 5147.0 samples/s | 80.4 steps/s
[Step=19450 Epoch=185.0] | Loss=0.00129 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.359 | acc=1.0000 | 1551.6 samples/s | 24.2 steps/s
[Step=19500 Epoch=185.5] | Loss=0.00108 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.360 | acc=1.0000 | 4872.6 samples/s | 76.1 steps/s
[Step=19550 Epoch=186.0] | Loss=0.00093 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.360 | acc=1.0000 | 1580.7 samples/s | 24.7 steps/s
[Step=19600 Epoch=186.4] | Loss=0.00081 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.360 | acc=1.0000 | 4539.4 samples/s | 70.9 steps/s
[Step=19650 Epoch=186.9] | Loss=0.00073 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.360 | acc=1.0000 | 1582.4 samples/s | 24.7 steps/s
[Step=19700 Epoch=187.4] | Loss=0.00066 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.360 | acc=1.0000 | 4499.2 samples/s | 70.3 steps/s
[Step=19750 Epoch=187.9] | Loss=0.00060 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.360 | acc=1.0000 | 1574.6 samples/s | 24.6 steps/s
[Step=19800 Epoch=188.3] | Loss=0.00055 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.361 | acc=1.0000 | 4574.1 samples/s | 71.5 steps/s
[Step=19850 Epoch=188.8] | Loss=0.00051 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.361 | acc=1.0000 | 1610.1 samples/s | 25.2 steps/s
[Step=19900 Epoch=189.3] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.361 | acc=1.0000 | 4401.6 samples/s | 68.8 steps/s
[Step=19950 Epoch=189.8] | Loss=0.00044 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.361 | acc=1.0000 | 1625.0 samples/s | 25.4 steps/s
[Step=20000 Epoch=190.2] | Loss=0.00042 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.361 | acc=1.0000 | 4359.0 samples/s | 68.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step20000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00006, len=1
[Step=16801 Epoch=158.3] | Loss=0.06036 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.357 | acc=0.9844 | 3942.3 samples/s | 61.6 steps/s
[Step=16850 Epoch=158.8] | Loss=0.00416 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.359 | acc=1.0000 | 4269.8 samples/s | 66.7 steps/s
[Step=16900 Epoch=159.2] | Loss=0.00211 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.360 | acc=1.0000 | 5154.8 samples/s | 80.5 steps/s
[Step=16950 Epoch=159.7] | Loss=0.00142 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.360 | acc=1.0000 | 1536.8 samples/s | 24.0 steps/s
[Step=17000 Epoch=160.2] | Loss=0.00107 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.361 | acc=1.0000 | 4982.1 samples/s | 77.8 steps/s
[Step=17050 Epoch=160.7] | Loss=0.00086 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.361 | acc=1.0000 | 1545.0 samples/s | 24.1 steps/s
[Step=17100 Epoch=161.1] | Loss=0.00072 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.361 | acc=1.0000 | 4774.6 samples/s | 74.6 steps/s
[Step=17150 Epoch=161.6] | Loss=0.00062 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.361 | acc=1.0000 | 1583.0 samples/s | 24.7 steps/s
[Step=17200 Epoch=162.1] | Loss=0.00055 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.362 | acc=1.0000 | 4541.2 samples/s | 71.0 steps/s
[Step=17250 Epoch=162.5] | Loss=0.00049 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.362 | acc=1.0000 | 1585.1 samples/s | 24.8 steps/s
[Step=17300 Epoch=163.0] | Loss=0.00044 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.362 | acc=1.0000 | 4492.2 samples/s | 70.2 steps/s
[Step=17350 Epoch=163.5] | Loss=0.00040 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.362 | acc=1.0000 | 1593.9 samples/s | 24.9 steps/s
[Step=17400 Epoch=164.0] | Loss=0.00037 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.362 | acc=1.0000 | 4469.6 samples/s | 69.8 steps/s
[Step=17450 Epoch=164.4] | Loss=0.00034 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.362 | acc=1.0000 | 1620.6 samples/s | 25.3 steps/s
[Step=17500 Epoch=164.9] | Loss=0.00032 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.363 | acc=1.0000 | 4285.6 samples/s | 67.0 steps/s
[Step=17550 Epoch=165.4] | Loss=0.00030 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.363 | acc=1.0000 | 1649.2 samples/s | 25.8 steps/s
[Step=17600 Epoch=165.8] | Loss=0.00028 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.363 | acc=1.0000 | 4000.8 samples/s | 62.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step17600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00006, len=1
[Step=22401 Epoch=213.5] | Loss=0.02287 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.358 | acc=0.9688 | 3995.1 samples/s | 62.4 steps/s
[Step=22450 Epoch=214.0] | Loss=0.00422 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.363 | acc=1.0000 | 4180.0 samples/s | 65.3 steps/s
[Step=22500 Epoch=214.4] | Loss=0.00214 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.364 | acc=1.0000 | 5377.1 samples/s | 84.0 steps/s
[Step=22550 Epoch=214.9] | Loss=0.00144 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.365 | acc=1.0000 | 1526.8 samples/s | 23.9 steps/s
[Step=22600 Epoch=215.4] | Loss=0.00109 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.365 | acc=1.0000 | 5196.9 samples/s | 81.2 steps/s
[Step=22650 Epoch=215.9] | Loss=0.00087 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.365 | acc=1.0000 | 1531.1 samples/s | 23.9 steps/s
[Step=22700 Epoch=216.4] | Loss=0.00073 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.366 | acc=1.0000 | 4795.3 samples/s | 74.9 steps/s
[Step=22750 Epoch=216.8] | Loss=0.00063 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.366 | acc=1.0000 | 1575.4 samples/s | 24.6 steps/s
[Step=22800 Epoch=217.3] | Loss=0.00055 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.366 | acc=1.0000 | 4751.2 samples/s | 74.2 steps/s
[Step=22850 Epoch=217.8] | Loss=0.00050 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.366 | acc=1.0000 | 1576.1 samples/s | 24.6 steps/s
[Step=22900 Epoch=218.3] | Loss=0.00045 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.366 | acc=1.0000 | 4651.8 samples/s | 72.7 steps/s
[Step=22950 Epoch=218.7] | Loss=0.00041 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.367 | acc=1.0000 | 1582.8 samples/s | 24.7 steps/s
[Step=23000 Epoch=219.2] | Loss=0.00038 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.367 | acc=1.0000 | 4546.9 samples/s | 71.0 steps/s
[Step=23050 Epoch=219.7] | Loss=0.00035 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.367 | acc=1.0000 | 1604.5 samples/s | 25.1 steps/s
[Step=23100 Epoch=220.2] | Loss=0.00032 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.367 | acc=1.0000 | 4627.4 samples/s | 72.3 steps/s
[Step=23150 Epoch=220.6] | Loss=0.00030 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.367 | acc=1.0000 | 1615.7 samples/s | 25.2 steps/s
[Step=23200 Epoch=221.1] | Loss=0.00029 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.368 | acc=1.0000 | 4576.6 samples/s | 71.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30661 | acc=0.8443 | tpr=0.7765 | fpr=0.0084 | 4429.9 samples/s | 17.3 steps/s
Avg test loss: 0.31333, Avg test acc: 0.84414, Avg tpr: 0.77729, Avg fpr: 0.00885, total FA: 69

Testing server on iccad2012
[Step=  50] | Loss=0.45338 | acc=0.8770 | tpr=0.9602 | fpr=0.1245 | 4577.0 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.46081 | acc=0.8779 | tpr=0.9680 | fpr=0.1238 | 9202.7 samples/s | 35.9 steps/s
[Step= 150] | Loss=0.46796 | acc=0.8776 | tpr=0.9697 | fpr=0.1241 | 9118.5 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.47119 | acc=0.8776 | tpr=0.9705 | fpr=0.1241 | 9629.6 samples/s | 37.6 steps/s
[Step= 250] | Loss=0.47021 | acc=0.8774 | tpr=0.9686 | fpr=0.1242 | 9152.8 samples/s | 35.8 steps/s
[Step= 300] | Loss=0.47525 | acc=0.8761 | tpr=0.9695 | fpr=0.1256 | 9096.3 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.47640 | acc=0.8761 | tpr=0.9699 | fpr=0.1256 | 9650.8 samples/s | 37.7 steps/s
[Step= 400] | Loss=0.47885 | acc=0.8761 | tpr=0.9705 | fpr=0.1256 | 9164.7 samples/s | 35.8 steps/s
[Step= 450] | Loss=0.48380 | acc=0.8756 | tpr=0.9698 | fpr=0.1261 | 8862.7 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.48259 | acc=0.8750 | tpr=0.9700 | fpr=0.1267 | 8858.4 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.48111 | acc=0.8750 | tpr=0.9686 | fpr=0.1267 | 17618.9 samples/s | 68.8 steps/s
Avg test loss: 0.48108, Avg test acc: 0.87496, Avg tpr: 0.96751, Avg fpr: 0.12672, total FA: 17595

server round 46/50

clients selected: [3 5 6 7 8]

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00006, len=1
[Step=14401 Epoch=70.2] | Loss=0.19114 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.364 | acc=0.9062 | 4113.0 samples/s | 64.3 steps/s
[Step=14450 Epoch=70.5] | Loss=0.03532 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.362 | acc=1.0000 | 4436.7 samples/s | 69.3 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02378 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.362 | acc=0.9844 | 4646.5 samples/s | 72.6 steps/s
[Step=14550 Epoch=71.0] | Loss=0.01915 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.362 | acc=1.0000 | 4540.2 samples/s | 70.9 steps/s
[Step=14600 Epoch=71.2] | Loss=0.01606 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.363 | acc=1.0000 | 5397.0 samples/s | 84.3 steps/s
[Step=14650 Epoch=71.4] | Loss=0.01376 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.365 | acc=1.0000 | 1505.4 samples/s | 23.5 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01226 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.366 | acc=1.0000 | 3913.2 samples/s | 61.1 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01133 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.367 | acc=1.0000 | 3962.0 samples/s | 61.9 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01043 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.369 | acc=1.0000 | 4710.1 samples/s | 73.6 steps/s
[Step=14850 Epoch=72.4] | Loss=0.00968 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.370 | acc=1.0000 | 1589.4 samples/s | 24.8 steps/s
[Step=14900 Epoch=72.7] | Loss=0.00902 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.372 | acc=1.0000 | 4621.1 samples/s | 72.2 steps/s
[Step=14950 Epoch=72.9] | Loss=0.00849 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.373 | acc=1.0000 | 4672.3 samples/s | 73.0 steps/s
[Step=15000 Epoch=73.1] | Loss=0.00813 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.375 | acc=1.0000 | 5047.9 samples/s | 78.9 steps/s
[Step=15050 Epoch=73.4] | Loss=0.00775 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.377 | acc=0.9844 | 1599.1 samples/s | 25.0 steps/s
[Step=15100 Epoch=73.6] | Loss=0.00743 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.378 | acc=1.0000 | 4635.7 samples/s | 72.4 steps/s
[Step=15150 Epoch=73.9] | Loss=0.00712 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.380 | acc=1.0000 | 4599.6 samples/s | 71.9 steps/s
[Step=15200 Epoch=74.1] | Loss=0.00687 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.381 | acc=0.9844 | 4977.9 samples/s | 77.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step15200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=20801 Epoch=197.1] | Loss=0.03622 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.365 | acc=0.9688 | 3914.8 samples/s | 61.2 steps/s
[Step=20850 Epoch=197.6] | Loss=0.00565 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.367 | acc=1.0000 | 4243.5 samples/s | 66.3 steps/s
[Step=20900 Epoch=198.0] | Loss=0.00290 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.368 | acc=1.0000 | 5334.0 samples/s | 83.3 steps/s
[Step=20950 Epoch=198.5] | Loss=0.00195 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.368 | acc=1.0000 | 1523.8 samples/s | 23.8 steps/s
[Step=21000 Epoch=199.0] | Loss=0.00147 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.369 | acc=1.0000 | 5005.4 samples/s | 78.2 steps/s
[Step=21050 Epoch=199.5] | Loss=0.00118 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.369 | acc=1.0000 | 1572.7 samples/s | 24.6 steps/s
[Step=21100 Epoch=199.9] | Loss=0.00099 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.369 | acc=1.0000 | 4831.3 samples/s | 75.5 steps/s
[Step=21150 Epoch=200.4] | Loss=0.00085 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.370 | acc=1.0000 | 1574.2 samples/s | 24.6 steps/s
[Step=21200 Epoch=200.9] | Loss=0.00075 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.370 | acc=1.0000 | 4775.5 samples/s | 74.6 steps/s
[Step=21250 Epoch=201.4] | Loss=0.00067 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.370 | acc=1.0000 | 1583.3 samples/s | 24.7 steps/s
[Step=21300 Epoch=201.8] | Loss=0.00060 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.370 | acc=1.0000 | 4633.6 samples/s | 72.4 steps/s
[Step=21350 Epoch=202.3] | Loss=0.00055 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.370 | acc=1.0000 | 1597.0 samples/s | 25.0 steps/s
[Step=21400 Epoch=202.8] | Loss=0.00051 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.371 | acc=1.0000 | 4504.1 samples/s | 70.4 steps/s
[Step=21450 Epoch=203.3] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.371 | acc=1.0000 | 1605.3 samples/s | 25.1 steps/s
[Step=21500 Epoch=203.7] | Loss=0.00044 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.371 | acc=1.0000 | 4555.1 samples/s | 71.2 steps/s
[Step=21550 Epoch=204.2] | Loss=0.00041 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.371 | acc=1.0000 | 1609.5 samples/s | 25.1 steps/s
[Step=21600 Epoch=204.7] | Loss=0.00038 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.371 | acc=1.0000 | 4404.6 samples/s | 68.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step21600.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=20001 Epoch=190.3] | Loss=0.14679 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.364 | acc=0.9531 | 3892.1 samples/s | 60.8 steps/s
[Step=20050 Epoch=190.7] | Loss=0.00659 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.366 | acc=1.0000 | 4439.6 samples/s | 69.4 steps/s
[Step=20100 Epoch=191.2] | Loss=0.00333 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.367 | acc=1.0000 | 5307.4 samples/s | 82.9 steps/s
[Step=20150 Epoch=191.7] | Loss=0.00224 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.367 | acc=1.0000 | 1539.5 samples/s | 24.1 steps/s
[Step=20200 Epoch=192.2] | Loss=0.00169 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.367 | acc=1.0000 | 5011.2 samples/s | 78.3 steps/s
[Step=20250 Epoch=192.6] | Loss=0.00137 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.368 | acc=1.0000 | 1555.6 samples/s | 24.3 steps/s
[Step=20300 Epoch=193.1] | Loss=0.00115 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.368 | acc=1.0000 | 4883.7 samples/s | 76.3 steps/s
[Step=20350 Epoch=193.6] | Loss=0.00099 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.369 | acc=1.0000 | 1575.5 samples/s | 24.6 steps/s
[Step=20400 Epoch=194.1] | Loss=0.00087 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.369 | acc=1.0000 | 4602.0 samples/s | 71.9 steps/s
[Step=20450 Epoch=194.5] | Loss=0.00077 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.369 | acc=1.0000 | 1586.3 samples/s | 24.8 steps/s
[Step=20500 Epoch=195.0] | Loss=0.00070 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.369 | acc=1.0000 | 4537.2 samples/s | 70.9 steps/s
[Step=20550 Epoch=195.5] | Loss=0.00064 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.370 | acc=1.0000 | 1598.7 samples/s | 25.0 steps/s
[Step=20600 Epoch=196.0] | Loss=0.00059 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.370 | acc=1.0000 | 4578.6 samples/s | 71.5 steps/s
[Step=20650 Epoch=196.4] | Loss=0.00054 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.370 | acc=1.0000 | 1609.1 samples/s | 25.1 steps/s
[Step=20700 Epoch=196.9] | Loss=0.00050 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.370 | acc=1.0000 | 4487.6 samples/s | 70.1 steps/s
[Step=20750 Epoch=197.4] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.371 | acc=1.0000 | 1616.6 samples/s | 25.3 steps/s
[Step=20800 Epoch=197.9] | Loss=0.00044 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.371 | acc=1.0000 | 4365.5 samples/s | 68.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step20800.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00006, len=1
[Step=16001 Epoch=152.8] | Loss=0.00494 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.365 | acc=1.0000 | 3744.0 samples/s | 58.5 steps/s
[Step=16050 Epoch=153.3] | Loss=0.00445 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.368 | acc=1.0000 | 4402.8 samples/s | 68.8 steps/s
[Step=16100 Epoch=153.7] | Loss=0.00230 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.369 | acc=1.0000 | 5438.9 samples/s | 85.0 steps/s
[Step=16150 Epoch=154.2] | Loss=0.00155 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.370 | acc=1.0000 | 1443.8 samples/s | 22.6 steps/s
[Step=16200 Epoch=154.7] | Loss=0.00117 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.370 | acc=1.0000 | 4572.2 samples/s | 71.4 steps/s
[Step=16250 Epoch=155.2] | Loss=0.00094 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.371 | acc=1.0000 | 1470.8 samples/s | 23.0 steps/s
[Step=16300 Epoch=155.7] | Loss=0.00079 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.371 | acc=1.0000 | 4424.4 samples/s | 69.1 steps/s
[Step=16350 Epoch=156.1] | Loss=0.00068 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.371 | acc=1.0000 | 1562.5 samples/s | 24.4 steps/s
[Step=16400 Epoch=156.6] | Loss=0.00060 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.372 | acc=1.0000 | 4658.6 samples/s | 72.8 steps/s
[Step=16450 Epoch=157.1] | Loss=0.00053 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.372 | acc=1.0000 | 1576.8 samples/s | 24.6 steps/s
[Step=16500 Epoch=157.6] | Loss=0.00048 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.372 | acc=1.0000 | 4593.6 samples/s | 71.8 steps/s
[Step=16550 Epoch=158.0] | Loss=0.00044 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.372 | acc=1.0000 | 1602.9 samples/s | 25.0 steps/s
[Step=16600 Epoch=158.5] | Loss=0.00040 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.373 | acc=1.0000 | 4476.6 samples/s | 69.9 steps/s
[Step=16650 Epoch=159.0] | Loss=0.00037 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.373 | acc=1.0000 | 1608.2 samples/s | 25.1 steps/s
[Step=16700 Epoch=159.5] | Loss=0.00035 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.373 | acc=1.0000 | 4537.8 samples/s | 70.9 steps/s
[Step=16750 Epoch=160.0] | Loss=0.00033 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.373 | acc=1.0000 | 1612.7 samples/s | 25.2 steps/s
[Step=16800 Epoch=160.4] | Loss=0.00031 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.373 | acc=1.0000 | 4415.0 samples/s | 69.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step16800.h5

Train client 8: client_iccad2012_3
Restoring client from server.
LR=0.00006, len=1
[Step=17601 Epoch=165.9] | Loss=0.08664 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.364 | acc=0.9688 | 3856.6 samples/s | 60.3 steps/s
[Step=17650 Epoch=166.3] | Loss=0.00525 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.366 | acc=1.0000 | 4377.8 samples/s | 68.4 steps/s
[Step=17700 Epoch=166.8] | Loss=0.00276 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.367 | acc=1.0000 | 5193.4 samples/s | 81.1 steps/s
[Step=17750 Epoch=167.3] | Loss=0.00186 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.368 | acc=1.0000 | 1536.1 samples/s | 24.0 steps/s
[Step=17800 Epoch=167.7] | Loss=0.00140 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.368 | acc=1.0000 | 4910.5 samples/s | 76.7 steps/s
[Step=17850 Epoch=168.2] | Loss=0.00112 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.369 | acc=1.0000 | 1575.5 samples/s | 24.6 steps/s
[Step=17900 Epoch=168.7] | Loss=0.00094 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.369 | acc=1.0000 | 4757.0 samples/s | 74.3 steps/s
[Step=17950 Epoch=169.1] | Loss=0.00081 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.369 | acc=1.0000 | 1577.2 samples/s | 24.6 steps/s
[Step=18000 Epoch=169.6] | Loss=0.00071 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.369 | acc=1.0000 | 4674.4 samples/s | 73.0 steps/s
[Step=18050 Epoch=170.1] | Loss=0.00064 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.370 | acc=1.0000 | 1616.2 samples/s | 25.3 steps/s
[Step=18100 Epoch=170.6] | Loss=0.00057 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.370 | acc=1.0000 | 4446.0 samples/s | 69.5 steps/s
[Step=18150 Epoch=171.0] | Loss=0.00052 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.370 | acc=1.0000 | 1599.1 samples/s | 25.0 steps/s
[Step=18200 Epoch=171.5] | Loss=0.00048 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.370 | acc=1.0000 | 4538.7 samples/s | 70.9 steps/s
[Step=18250 Epoch=172.0] | Loss=0.00045 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.370 | acc=1.0000 | 1614.0 samples/s | 25.2 steps/s
[Step=18300 Epoch=172.4] | Loss=0.00041 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.370 | acc=1.0000 | 4611.4 samples/s | 72.1 steps/s
[Step=18350 Epoch=172.9] | Loss=0.00039 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.371 | acc=1.0000 | 1699.8 samples/s | 26.6 steps/s
[Step=18400 Epoch=173.4] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.371 | acc=1.0000 | 3908.9 samples/s | 61.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_3/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31238 | acc=0.8427 | tpr=0.7740 | fpr=0.0079 | 4543.2 samples/s | 17.7 steps/s
Avg test loss: 0.31932, Avg test acc: 0.84258, Avg tpr: 0.77479, Avg fpr: 0.00833, total FA: 65

Testing server on iccad2012
[Step=  50] | Loss=0.44220 | acc=0.8805 | tpr=0.9602 | fpr=0.1209 | 4574.4 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.44957 | acc=0.8817 | tpr=0.9680 | fpr=0.1199 | 9080.9 samples/s | 35.5 steps/s
[Step= 150] | Loss=0.45646 | acc=0.8813 | tpr=0.9697 | fpr=0.1204 | 9310.2 samples/s | 36.4 steps/s
[Step= 200] | Loss=0.45992 | acc=0.8809 | tpr=0.9694 | fpr=0.1207 | 9205.7 samples/s | 36.0 steps/s
[Step= 250] | Loss=0.45881 | acc=0.8809 | tpr=0.9677 | fpr=0.1207 | 9302.6 samples/s | 36.3 steps/s
[Step= 300] | Loss=0.46363 | acc=0.8795 | tpr=0.9687 | fpr=0.1221 | 9513.6 samples/s | 37.2 steps/s
[Step= 350] | Loss=0.46485 | acc=0.8794 | tpr=0.9693 | fpr=0.1222 | 9209.1 samples/s | 36.0 steps/s
[Step= 400] | Loss=0.46732 | acc=0.8793 | tpr=0.9699 | fpr=0.1223 | 9083.4 samples/s | 35.5 steps/s
[Step= 450] | Loss=0.47231 | acc=0.8789 | tpr=0.9693 | fpr=0.1228 | 9272.8 samples/s | 36.2 steps/s
[Step= 500] | Loss=0.47100 | acc=0.8784 | tpr=0.9700 | fpr=0.1233 | 9158.8 samples/s | 35.8 steps/s
[Step= 550] | Loss=0.46948 | acc=0.8783 | tpr=0.9686 | fpr=0.1233 | 16912.0 samples/s | 66.1 steps/s
Avg test loss: 0.46944, Avg test acc: 0.87835, Avg tpr: 0.96751, Avg fpr: 0.12327, total FA: 17116

server round 47/50

clients selected: [1 3 5 6 9]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=20001 Epoch=97.6] | Loss=0.20858 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.370 | acc=0.8906 | 4091.8 samples/s | 63.9 steps/s
[Step=20050 Epoch=97.8] | Loss=0.03752 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.367 | acc=1.0000 | 4546.9 samples/s | 71.0 steps/s
[Step=20100 Epoch=98.1] | Loss=0.02466 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.366 | acc=1.0000 | 4705.0 samples/s | 73.5 steps/s
[Step=20150 Epoch=98.3] | Loss=0.01972 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.367 | acc=0.9844 | 4677.4 samples/s | 73.1 steps/s
[Step=20200 Epoch=98.6] | Loss=0.01626 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.368 | acc=1.0000 | 5307.2 samples/s | 82.9 steps/s
[Step=20250 Epoch=98.8] | Loss=0.01431 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.369 | acc=1.0000 | 1578.0 samples/s | 24.7 steps/s
[Step=20300 Epoch=99.1] | Loss=0.01264 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.370 | acc=1.0000 | 4630.5 samples/s | 72.4 steps/s
[Step=20350 Epoch=99.3] | Loss=0.01139 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.372 | acc=1.0000 | 4702.4 samples/s | 73.5 steps/s
[Step=20400 Epoch=99.5] | Loss=0.01064 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.373 | acc=1.0000 | 5295.2 samples/s | 82.7 steps/s
[Step=20450 Epoch=99.8] | Loss=0.00985 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.375 | acc=1.0000 | 1582.1 samples/s | 24.7 steps/s
[Step=20500 Epoch=100.0] | Loss=0.00925 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.376 | acc=1.0000 | 4639.7 samples/s | 72.5 steps/s
[Step=20550 Epoch=100.3] | Loss=0.00874 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.378 | acc=1.0000 | 4713.9 samples/s | 73.7 steps/s
[Step=20600 Epoch=100.5] | Loss=0.00833 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.380 | acc=1.0000 | 5159.6 samples/s | 80.6 steps/s
[Step=20650 Epoch=100.8] | Loss=0.00790 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.381 | acc=1.0000 | 1615.3 samples/s | 25.2 steps/s
[Step=20700 Epoch=101.0] | Loss=0.00758 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.383 | acc=1.0000 | 4645.5 samples/s | 72.6 steps/s
[Step=20750 Epoch=101.3] | Loss=0.00734 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.384 | acc=1.0000 | 4671.0 samples/s | 73.0 steps/s
[Step=20800 Epoch=101.5] | Loss=0.00704 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.386 | acc=1.0000 | 5001.1 samples/s | 78.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step20800.h5

Train client 3: client_asml1_3
Restoring client from server.
LR=0.00006, len=1
[Step=15201 Epoch=74.1] | Loss=0.13676 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.370 | acc=0.9219 | 3956.4 samples/s | 61.8 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02990 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.369 | acc=0.9531 | 4505.9 samples/s | 70.4 steps/s
[Step=15300 Epoch=74.6] | Loss=0.02047 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.369 | acc=1.0000 | 4684.0 samples/s | 73.2 steps/s
[Step=15350 Epoch=74.9] | Loss=0.01629 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.370 | acc=0.9844 | 4610.5 samples/s | 72.0 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01417 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.372 | acc=0.9844 | 5378.2 samples/s | 84.0 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01244 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.373 | acc=1.0000 | 1476.8 samples/s | 23.1 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01094 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.374 | acc=1.0000 | 3954.2 samples/s | 61.8 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01011 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.376 | acc=1.0000 | 3946.8 samples/s | 61.7 steps/s
[Step=15600 Epoch=76.1] | Loss=0.00940 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.377 | acc=0.9844 | 4749.0 samples/s | 74.2 steps/s
[Step=15650 Epoch=76.3] | Loss=0.00878 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.379 | acc=1.0000 | 1595.7 samples/s | 24.9 steps/s
[Step=15700 Epoch=76.6] | Loss=0.00832 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.380 | acc=1.0000 | 4643.2 samples/s | 72.5 steps/s
[Step=15750 Epoch=76.8] | Loss=0.00787 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.382 | acc=1.0000 | 4572.3 samples/s | 71.4 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00752 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.383 | acc=1.0000 | 5023.2 samples/s | 78.5 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00717 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.385 | acc=1.0000 | 1642.0 samples/s | 25.7 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00687 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.386 | acc=1.0000 | 4554.3 samples/s | 71.2 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00658 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.388 | acc=1.0000 | 4667.9 samples/s | 72.9 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00638 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.390 | acc=1.0000 | 4911.8 samples/s | 76.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_3/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=21601 Epoch=204.7] | Loss=0.04055 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.370 | acc=0.9688 | 3962.5 samples/s | 61.9 steps/s
[Step=21650 Epoch=205.2] | Loss=0.00419 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.373 | acc=1.0000 | 4120.1 samples/s | 64.4 steps/s
[Step=21700 Epoch=205.6] | Loss=0.00229 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.375 | acc=1.0000 | 5201.9 samples/s | 81.3 steps/s
[Step=21750 Epoch=206.1] | Loss=0.00155 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.375 | acc=1.0000 | 1463.1 samples/s | 22.9 steps/s
[Step=21800 Epoch=206.6] | Loss=0.00117 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.376 | acc=1.0000 | 4422.3 samples/s | 69.1 steps/s
[Step=21850 Epoch=207.0] | Loss=0.00094 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.376 | acc=1.0000 | 1548.1 samples/s | 24.2 steps/s
[Step=21900 Epoch=207.5] | Loss=0.00079 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.377 | acc=1.0000 | 4892.6 samples/s | 76.4 steps/s
[Step=21950 Epoch=208.0] | Loss=0.00068 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.377 | acc=1.0000 | 1572.7 samples/s | 24.6 steps/s
[Step=22000 Epoch=208.5] | Loss=0.00060 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.377 | acc=1.0000 | 4660.9 samples/s | 72.8 steps/s
[Step=22050 Epoch=208.9] | Loss=0.00053 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.378 | acc=1.0000 | 1596.0 samples/s | 24.9 steps/s
[Step=22100 Epoch=209.4] | Loss=0.00048 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.378 | acc=1.0000 | 4548.7 samples/s | 71.1 steps/s
[Step=22150 Epoch=209.9] | Loss=0.00044 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.378 | acc=1.0000 | 1625.5 samples/s | 25.4 steps/s
[Step=22200 Epoch=210.4] | Loss=0.00041 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.378 | acc=1.0000 | 4411.8 samples/s | 68.9 steps/s
[Step=22250 Epoch=210.8] | Loss=0.00038 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.379 | acc=1.0000 | 1633.2 samples/s | 25.5 steps/s
[Step=22300 Epoch=211.3] | Loss=0.00035 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.379 | acc=1.0000 | 4375.0 samples/s | 68.4 steps/s
[Step=22350 Epoch=211.8] | Loss=0.00033 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.379 | acc=1.0000 | 1641.6 samples/s | 25.6 steps/s
[Step=22400 Epoch=212.3] | Loss=0.00031 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.379 | acc=1.0000 | 4356.4 samples/s | 68.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step22400.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=20801 Epoch=197.9] | Loss=0.19077 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.370 | acc=0.9219 | 3993.5 samples/s | 62.4 steps/s
[Step=20850 Epoch=198.3] | Loss=0.00850 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.371 | acc=1.0000 | 4177.0 samples/s | 65.3 steps/s
[Step=20900 Epoch=198.8] | Loss=0.00432 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.371 | acc=1.0000 | 5200.3 samples/s | 81.3 steps/s
[Step=20950 Epoch=199.3] | Loss=0.00289 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.372 | acc=1.0000 | 1527.6 samples/s | 23.9 steps/s
[Step=21000 Epoch=199.8] | Loss=0.00218 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.372 | acc=1.0000 | 5045.0 samples/s | 78.8 steps/s
[Step=21050 Epoch=200.2] | Loss=0.00175 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.373 | acc=1.0000 | 1538.9 samples/s | 24.0 steps/s
[Step=21100 Epoch=200.7] | Loss=0.00147 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.373 | acc=1.0000 | 4950.2 samples/s | 77.3 steps/s
[Step=21150 Epoch=201.2] | Loss=0.00126 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.373 | acc=1.0000 | 1593.8 samples/s | 24.9 steps/s
[Step=21200 Epoch=201.7] | Loss=0.00111 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.373 | acc=1.0000 | 4725.4 samples/s | 73.8 steps/s
[Step=21250 Epoch=202.1] | Loss=0.00099 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.374 | acc=1.0000 | 1562.6 samples/s | 24.4 steps/s
[Step=21300 Epoch=202.6] | Loss=0.00089 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.374 | acc=1.0000 | 4490.8 samples/s | 70.2 steps/s
[Step=21350 Epoch=203.1] | Loss=0.00081 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.374 | acc=1.0000 | 1564.8 samples/s | 24.4 steps/s
[Step=21400 Epoch=203.6] | Loss=0.00075 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.374 | acc=1.0000 | 3780.8 samples/s | 59.1 steps/s
[Step=21450 Epoch=204.0] | Loss=0.00069 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.374 | acc=1.0000 | 1596.4 samples/s | 24.9 steps/s
[Step=21500 Epoch=204.5] | Loss=0.00064 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.375 | acc=1.0000 | 4596.8 samples/s | 71.8 steps/s
[Step=21550 Epoch=205.0] | Loss=0.00060 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.375 | acc=1.0000 | 1614.3 samples/s | 25.2 steps/s
[Step=21600 Epoch=205.5] | Loss=0.00056 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.375 | acc=1.0000 | 4363.6 samples/s | 68.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step21600.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00006, len=1
[Step=23201 Epoch=221.1] | Loss=0.01150 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.370 | acc=0.9844 | 3723.8 samples/s | 58.2 steps/s
[Step=23250 Epoch=221.6] | Loss=0.00427 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.372 | acc=1.0000 | 4499.6 samples/s | 70.3 steps/s
[Step=23300 Epoch=222.1] | Loss=0.00220 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.373 | acc=1.0000 | 5302.6 samples/s | 82.9 steps/s
[Step=23350 Epoch=222.5] | Loss=0.00148 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.374 | acc=1.0000 | 1525.5 samples/s | 23.8 steps/s
[Step=23400 Epoch=223.0] | Loss=0.00112 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.374 | acc=1.0000 | 5011.9 samples/s | 78.3 steps/s
[Step=23450 Epoch=223.5] | Loss=0.00090 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.375 | acc=1.0000 | 1544.4 samples/s | 24.1 steps/s
[Step=23500 Epoch=224.0] | Loss=0.00076 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.375 | acc=1.0000 | 5034.9 samples/s | 78.7 steps/s
[Step=23550 Epoch=224.5] | Loss=0.00065 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.375 | acc=1.0000 | 1565.7 samples/s | 24.5 steps/s
[Step=23600 Epoch=224.9] | Loss=0.00058 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.375 | acc=1.0000 | 4803.2 samples/s | 75.0 steps/s
[Step=23650 Epoch=225.4] | Loss=0.00051 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.376 | acc=1.0000 | 1582.2 samples/s | 24.7 steps/s
[Step=23700 Epoch=225.9] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.376 | acc=1.0000 | 4735.3 samples/s | 74.0 steps/s
[Step=23750 Epoch=226.4] | Loss=0.00042 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.376 | acc=1.0000 | 1568.3 samples/s | 24.5 steps/s
[Step=23800 Epoch=226.8] | Loss=0.00039 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.376 | acc=1.0000 | 4526.0 samples/s | 70.7 steps/s
[Step=23850 Epoch=227.3] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.377 | acc=1.0000 | 1601.9 samples/s | 25.0 steps/s
[Step=23900 Epoch=227.8] | Loss=0.00034 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.377 | acc=1.0000 | 4422.9 samples/s | 69.1 steps/s
[Step=23950 Epoch=228.3] | Loss=0.00032 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.377 | acc=1.0000 | 1597.7 samples/s | 25.0 steps/s
[Step=24000 Epoch=228.7] | Loss=0.00030 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.377 | acc=1.0000 | 4548.8 samples/s | 71.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30139 | acc=0.8469 | tpr=0.7801 | fpr=0.0082 | 4570.1 samples/s | 17.9 steps/s
Avg test loss: 0.30838, Avg test acc: 0.84674, Avg tpr: 0.78102, Avg fpr: 0.00872, total FA: 68

Testing server on iccad2012
[Step=  50] | Loss=0.44983 | acc=0.8786 | tpr=0.9602 | fpr=0.1229 | 4602.8 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.45707 | acc=0.8791 | tpr=0.9680 | fpr=0.1226 | 9131.9 samples/s | 35.7 steps/s
[Step= 150] | Loss=0.46422 | acc=0.8785 | tpr=0.9697 | fpr=0.1232 | 9293.7 samples/s | 36.3 steps/s
[Step= 200] | Loss=0.46756 | acc=0.8783 | tpr=0.9694 | fpr=0.1234 | 9264.0 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.46642 | acc=0.8782 | tpr=0.9686 | fpr=0.1235 | 9049.3 samples/s | 35.3 steps/s
[Step= 300] | Loss=0.47143 | acc=0.8768 | tpr=0.9687 | fpr=0.1248 | 9974.3 samples/s | 39.0 steps/s
[Step= 350] | Loss=0.47251 | acc=0.8768 | tpr=0.9693 | fpr=0.1249 | 8677.7 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.47493 | acc=0.8768 | tpr=0.9699 | fpr=0.1249 | 5318.9 samples/s | 20.8 steps/s
[Step= 450] | Loss=0.47994 | acc=0.8762 | tpr=0.9693 | fpr=0.1255 | 9746.9 samples/s | 38.1 steps/s
[Step= 500] | Loss=0.47857 | acc=0.8758 | tpr=0.9700 | fpr=0.1259 | 8344.3 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.47700 | acc=0.8757 | tpr=0.9686 | fpr=0.1259 | 17211.0 samples/s | 67.2 steps/s
Avg test loss: 0.47699, Avg test acc: 0.87575, Avg tpr: 0.96751, Avg fpr: 0.12591, total FA: 17483

server round 48/50

clients selected: [1 2 5 6 7]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=20801 Epoch=101.5] | Loss=0.06027 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.375 | acc=0.9688 | 4111.5 samples/s | 64.2 steps/s
[Step=20850 Epoch=101.7] | Loss=0.03167 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.372 | acc=0.9844 | 4511.0 samples/s | 70.5 steps/s
[Step=20900 Epoch=102.0] | Loss=0.02286 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.371 | acc=0.9844 | 4637.5 samples/s | 72.5 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01824 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.371 | acc=0.9844 | 4471.3 samples/s | 69.9 steps/s
[Step=21000 Epoch=102.5] | Loss=0.01570 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.372 | acc=0.9844 | 5289.4 samples/s | 82.6 steps/s
[Step=21050 Epoch=102.7] | Loss=0.01360 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.373 | acc=1.0000 | 1589.7 samples/s | 24.8 steps/s
[Step=21100 Epoch=103.0] | Loss=0.01226 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.375 | acc=1.0000 | 4625.1 samples/s | 72.3 steps/s
[Step=21150 Epoch=103.2] | Loss=0.01114 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.376 | acc=1.0000 | 4781.9 samples/s | 74.7 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01028 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.378 | acc=0.9844 | 5263.4 samples/s | 82.2 steps/s
[Step=21250 Epoch=103.7] | Loss=0.00955 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.380 | acc=1.0000 | 1519.7 samples/s | 23.7 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00899 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.382 | acc=0.9844 | 3936.6 samples/s | 61.5 steps/s
[Step=21350 Epoch=104.2] | Loss=0.00838 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.383 | acc=1.0000 | 3923.0 samples/s | 61.3 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00801 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.385 | acc=1.0000 | 4532.7 samples/s | 70.8 steps/s
[Step=21450 Epoch=104.7] | Loss=0.00766 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.387 | acc=1.0000 | 1515.0 samples/s | 23.7 steps/s
[Step=21500 Epoch=104.9] | Loss=0.00732 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.388 | acc=1.0000 | 3995.0 samples/s | 62.4 steps/s
[Step=21550 Epoch=105.2] | Loss=0.00707 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.390 | acc=1.0000 | 3988.6 samples/s | 62.3 steps/s
[Step=21600 Epoch=105.4] | Loss=0.00684 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.391 | acc=1.0000 | 4365.6 samples/s | 68.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step21600.h5

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00006, len=1
[Step=17601 Epoch=85.8] | Loss=0.04327 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.375 | acc=0.9531 | 3545.0 samples/s | 55.4 steps/s
[Step=17650 Epoch=86.0] | Loss=0.03183 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.374 | acc=1.0000 | 4169.3 samples/s | 65.1 steps/s
[Step=17700 Epoch=86.2] | Loss=0.02056 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.373 | acc=1.0000 | 4488.1 samples/s | 70.1 steps/s
[Step=17750 Epoch=86.5] | Loss=0.01818 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.374 | acc=0.9844 | 4611.2 samples/s | 72.1 steps/s
[Step=17800 Epoch=86.7] | Loss=0.01590 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.374 | acc=0.9844 | 5515.5 samples/s | 86.2 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01386 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.376 | acc=1.0000 | 1585.9 samples/s | 24.8 steps/s
[Step=17900 Epoch=87.2] | Loss=0.01232 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.377 | acc=1.0000 | 4708.0 samples/s | 73.6 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01123 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.378 | acc=1.0000 | 4560.6 samples/s | 71.3 steps/s
[Step=18000 Epoch=87.7] | Loss=0.01051 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.380 | acc=1.0000 | 5158.8 samples/s | 80.6 steps/s
[Step=18050 Epoch=87.9] | Loss=0.00986 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.381 | acc=1.0000 | 1588.9 samples/s | 24.8 steps/s
[Step=18100 Epoch=88.2] | Loss=0.00930 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.383 | acc=0.9844 | 4799.9 samples/s | 75.0 steps/s
[Step=18150 Epoch=88.4] | Loss=0.00884 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.385 | acc=1.0000 | 4572.3 samples/s | 71.4 steps/s
[Step=18200 Epoch=88.7] | Loss=0.00838 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.386 | acc=1.0000 | 5049.8 samples/s | 78.9 steps/s
[Step=18250 Epoch=88.9] | Loss=0.00798 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.388 | acc=1.0000 | 1614.3 samples/s | 25.2 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00773 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.390 | acc=0.9844 | 4740.8 samples/s | 74.1 steps/s
[Step=18350 Epoch=89.4] | Loss=0.00741 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.391 | acc=1.0000 | 4573.1 samples/s | 71.5 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00718 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.393 | acc=1.0000 | 4875.1 samples/s | 76.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step18400.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=22401 Epoch=212.3] | Loss=0.00312 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.375 | acc=1.0000 | 3882.9 samples/s | 60.7 steps/s
[Step=22450 Epoch=212.7] | Loss=0.00467 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.378 | acc=1.0000 | 4292.0 samples/s | 67.1 steps/s
[Step=22500 Epoch=213.2] | Loss=0.00268 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.379 | acc=1.0000 | 5234.1 samples/s | 81.8 steps/s
[Step=22550 Epoch=213.7] | Loss=0.00181 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.379 | acc=1.0000 | 1525.1 samples/s | 23.8 steps/s
[Step=22600 Epoch=214.2] | Loss=0.00137 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.380 | acc=1.0000 | 4996.1 samples/s | 78.1 steps/s
[Step=22650 Epoch=214.6] | Loss=0.00110 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.380 | acc=1.0000 | 1572.6 samples/s | 24.6 steps/s
[Step=22700 Epoch=215.1] | Loss=0.00092 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.380 | acc=1.0000 | 4757.7 samples/s | 74.3 steps/s
[Step=22750 Epoch=215.6] | Loss=0.00079 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.381 | acc=1.0000 | 1554.2 samples/s | 24.3 steps/s
[Step=22800 Epoch=216.0] | Loss=0.00070 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.381 | acc=1.0000 | 4706.1 samples/s | 73.5 steps/s
[Step=22850 Epoch=216.5] | Loss=0.00062 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.381 | acc=1.0000 | 1569.6 samples/s | 24.5 steps/s
[Step=22900 Epoch=217.0] | Loss=0.00056 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.382 | acc=1.0000 | 4664.9 samples/s | 72.9 steps/s
[Step=22950 Epoch=217.5] | Loss=0.00051 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.382 | acc=1.0000 | 1629.0 samples/s | 25.5 steps/s
[Step=23000 Epoch=217.9] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.382 | acc=1.0000 | 4541.5 samples/s | 71.0 steps/s
[Step=23050 Epoch=218.4] | Loss=0.00044 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.383 | acc=1.0000 | 1642.5 samples/s | 25.7 steps/s
[Step=23100 Epoch=218.9] | Loss=0.00041 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.383 | acc=1.0000 | 4472.9 samples/s | 69.9 steps/s
[Step=23150 Epoch=219.4] | Loss=0.00038 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.383 | acc=1.0000 | 1606.3 samples/s | 25.1 steps/s
[Step=23200 Epoch=219.8] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.383 | acc=1.0000 | 3738.2 samples/s | 58.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step23200.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=21601 Epoch=205.5] | Loss=0.11791 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.375 | acc=0.9688 | 3869.0 samples/s | 60.5 steps/s
[Step=21650 Epoch=205.9] | Loss=0.00704 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.378 | acc=1.0000 | 4335.8 samples/s | 67.7 steps/s
[Step=21700 Epoch=206.4] | Loss=0.00358 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.379 | acc=1.0000 | 5235.7 samples/s | 81.8 steps/s
[Step=21750 Epoch=206.9] | Loss=0.00240 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.379 | acc=1.0000 | 1550.2 samples/s | 24.2 steps/s
[Step=21800 Epoch=207.4] | Loss=0.00181 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.380 | acc=1.0000 | 5024.8 samples/s | 78.5 steps/s
[Step=21850 Epoch=207.8] | Loss=0.00145 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.380 | acc=1.0000 | 1553.9 samples/s | 24.3 steps/s
[Step=21900 Epoch=208.3] | Loss=0.00122 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.380 | acc=1.0000 | 4873.4 samples/s | 76.1 steps/s
[Step=21950 Epoch=208.8] | Loss=0.00105 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.381 | acc=1.0000 | 1560.1 samples/s | 24.4 steps/s
[Step=22000 Epoch=209.3] | Loss=0.00092 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.381 | acc=1.0000 | 4631.6 samples/s | 72.4 steps/s
[Step=22050 Epoch=209.8] | Loss=0.00082 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.381 | acc=1.0000 | 1590.1 samples/s | 24.8 steps/s
[Step=22100 Epoch=210.2] | Loss=0.00074 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.381 | acc=1.0000 | 4535.8 samples/s | 70.9 steps/s
[Step=22150 Epoch=210.7] | Loss=0.00067 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.381 | acc=1.0000 | 1588.1 samples/s | 24.8 steps/s
[Step=22200 Epoch=211.2] | Loss=0.00062 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.382 | acc=1.0000 | 4602.6 samples/s | 71.9 steps/s
[Step=22250 Epoch=211.7] | Loss=0.00057 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.382 | acc=1.0000 | 1620.4 samples/s | 25.3 steps/s
[Step=22300 Epoch=212.1] | Loss=0.00053 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.382 | acc=1.0000 | 4381.4 samples/s | 68.5 steps/s
[Step=22350 Epoch=212.6] | Loss=0.00050 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.382 | acc=1.0000 | 1607.5 samples/s | 25.1 steps/s
[Step=22400 Epoch=213.1] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.382 | acc=1.0000 | 4398.0 samples/s | 68.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step22400.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00006, len=1
[Step=16801 Epoch=160.4] | Loss=0.12962 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.375 | acc=0.9688 | 3616.6 samples/s | 56.5 steps/s
[Step=16850 Epoch=160.9] | Loss=0.00834 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.375 | acc=1.0000 | 2256.6 samples/s | 35.3 steps/s
[Step=16900 Epoch=161.4] | Loss=0.00421 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.376 | acc=1.0000 | 5259.0 samples/s | 82.2 steps/s
[Step=16950 Epoch=161.9] | Loss=0.00282 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.376 | acc=1.0000 | 1504.1 samples/s | 23.5 steps/s
[Step=17000 Epoch=162.3] | Loss=0.00213 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.377 | acc=1.0000 | 5092.8 samples/s | 79.6 steps/s
[Step=17050 Epoch=162.8] | Loss=0.00171 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.377 | acc=1.0000 | 1536.6 samples/s | 24.0 steps/s
[Step=17100 Epoch=163.3] | Loss=0.00143 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.377 | acc=1.0000 | 4905.4 samples/s | 76.6 steps/s
[Step=17150 Epoch=163.8] | Loss=0.00123 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.378 | acc=1.0000 | 1574.8 samples/s | 24.6 steps/s
[Step=17200 Epoch=164.2] | Loss=0.00108 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.378 | acc=1.0000 | 4942.4 samples/s | 77.2 steps/s
[Step=17250 Epoch=164.7] | Loss=0.00096 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.378 | acc=1.0000 | 1568.4 samples/s | 24.5 steps/s
[Step=17300 Epoch=165.2] | Loss=0.00087 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.378 | acc=1.0000 | 4660.5 samples/s | 72.8 steps/s
[Step=17350 Epoch=165.7] | Loss=0.00079 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.378 | acc=1.0000 | 1862.2 samples/s | 29.1 steps/s
[Step=17400 Epoch=166.2] | Loss=0.00073 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.379 | acc=1.0000 | 4528.6 samples/s | 70.8 steps/s
[Step=17450 Epoch=166.6] | Loss=0.00067 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.379 | acc=1.0000 | 1579.5 samples/s | 24.7 steps/s
[Step=17500 Epoch=167.1] | Loss=0.00063 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.379 | acc=1.0000 | 3743.1 samples/s | 58.5 steps/s
[Step=17550 Epoch=167.6] | Loss=0.00059 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.379 | acc=1.0000 | 1574.2 samples/s | 24.6 steps/s
[Step=17600 Epoch=168.1] | Loss=0.00055 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.379 | acc=1.0000 | 3847.3 samples/s | 60.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30225 | acc=0.8470 | tpr=0.7806 | fpr=0.0087 | 4313.2 samples/s | 16.8 steps/s
Avg test loss: 0.30943, Avg test acc: 0.84638, Avg tpr: 0.78067, Avg fpr: 0.00910, total FA: 71

Testing server on iccad2012
[Step=  50] | Loss=0.44641 | acc=0.8794 | tpr=0.9602 | fpr=0.1221 | 4594.8 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.45364 | acc=0.8803 | tpr=0.9680 | fpr=0.1213 | 9369.5 samples/s | 36.6 steps/s
[Step= 150] | Loss=0.46056 | acc=0.8798 | tpr=0.9697 | fpr=0.1219 | 8829.6 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.46400 | acc=0.8795 | tpr=0.9705 | fpr=0.1222 | 9550.9 samples/s | 37.3 steps/s
[Step= 250] | Loss=0.46274 | acc=0.8793 | tpr=0.9694 | fpr=0.1223 | 8992.9 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.46765 | acc=0.8779 | tpr=0.9695 | fpr=0.1238 | 9624.1 samples/s | 37.6 steps/s
[Step= 350] | Loss=0.46873 | acc=0.8780 | tpr=0.9699 | fpr=0.1237 | 8851.1 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.47112 | acc=0.8780 | tpr=0.9705 | fpr=0.1237 | 9061.6 samples/s | 35.4 steps/s
[Step= 450] | Loss=0.47614 | acc=0.8774 | tpr=0.9698 | fpr=0.1243 | 9273.9 samples/s | 36.2 steps/s
[Step= 500] | Loss=0.47480 | acc=0.8770 | tpr=0.9700 | fpr=0.1247 | 9135.5 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.47322 | acc=0.8770 | tpr=0.9686 | fpr=0.1247 | 17486.6 samples/s | 68.3 steps/s
Avg test loss: 0.47322, Avg test acc: 0.87698, Avg tpr: 0.96751, Avg fpr: 0.12466, total FA: 17309

server round 49/50

clients selected: [2 5 6 7 9]

Train client 2: client_asml1_2
Restoring client from server.
LR=0.00006, len=1
[Step=18401 Epoch=89.7] | Loss=0.18139 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.379 | acc=0.8906 | 4434.3 samples/s | 69.3 steps/s
[Step=18450 Epoch=89.9] | Loss=0.03250 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.376 | acc=1.0000 | 4515.4 samples/s | 70.6 steps/s
[Step=18500 Epoch=90.1] | Loss=0.02245 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.376 | acc=0.9844 | 4659.2 samples/s | 72.8 steps/s
[Step=18550 Epoch=90.4] | Loss=0.01841 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.376 | acc=0.9844 | 4654.5 samples/s | 72.7 steps/s
[Step=18600 Epoch=90.6] | Loss=0.01585 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.377 | acc=0.9844 | 5399.4 samples/s | 84.4 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01366 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.378 | acc=1.0000 | 1582.8 samples/s | 24.7 steps/s
[Step=18700 Epoch=91.1] | Loss=0.01253 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.379 | acc=1.0000 | 4536.7 samples/s | 70.9 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01129 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.381 | acc=1.0000 | 4739.7 samples/s | 74.1 steps/s
[Step=18800 Epoch=91.6] | Loss=0.01048 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.382 | acc=1.0000 | 5231.9 samples/s | 81.7 steps/s
[Step=18850 Epoch=91.8] | Loss=0.00972 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.384 | acc=1.0000 | 1609.3 samples/s | 25.1 steps/s
[Step=18900 Epoch=92.1] | Loss=0.00918 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.386 | acc=1.0000 | 4686.2 samples/s | 73.2 steps/s
[Step=18950 Epoch=92.3] | Loss=0.00864 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.388 | acc=1.0000 | 4668.3 samples/s | 72.9 steps/s
[Step=19000 Epoch=92.6] | Loss=0.00829 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.389 | acc=0.9844 | 4885.9 samples/s | 76.3 steps/s
[Step=19050 Epoch=92.8] | Loss=0.00794 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.391 | acc=1.0000 | 1590.3 samples/s | 24.8 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00759 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.393 | acc=1.0000 | 4516.4 samples/s | 70.6 steps/s
[Step=19150 Epoch=93.3] | Loss=0.00730 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.395 | acc=1.0000 | 4466.4 samples/s | 69.8 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00705 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.396 | acc=1.0000 | 4946.7 samples/s | 77.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_2/client_state-step19200.h5

Train client 5: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=23201 Epoch=219.8] | Loss=0.00733 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.379 | acc=0.9844 | 3518.4 samples/s | 55.0 steps/s
[Step=23250 Epoch=220.3] | Loss=0.00325 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.383 | acc=1.0000 | 4306.1 samples/s | 67.3 steps/s
[Step=23300 Epoch=220.8] | Loss=0.00170 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.385 | acc=1.0000 | 5331.9 samples/s | 83.3 steps/s
[Step=23350 Epoch=221.3] | Loss=0.00115 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.386 | acc=1.0000 | 1538.6 samples/s | 24.0 steps/s
[Step=23400 Epoch=221.7] | Loss=0.00087 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.387 | acc=1.0000 | 5076.1 samples/s | 79.3 steps/s
[Step=23450 Epoch=222.2] | Loss=0.00070 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.387 | acc=1.0000 | 1555.0 samples/s | 24.3 steps/s
[Step=23500 Epoch=222.7] | Loss=0.00059 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.388 | acc=1.0000 | 4769.2 samples/s | 74.5 steps/s
[Step=23550 Epoch=223.2] | Loss=0.00051 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.388 | acc=1.0000 | 1569.6 samples/s | 24.5 steps/s
[Step=23600 Epoch=223.6] | Loss=0.00045 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.388 | acc=1.0000 | 4816.6 samples/s | 75.3 steps/s
[Step=23650 Epoch=224.1] | Loss=0.00040 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.388 | acc=1.0000 | 1598.7 samples/s | 25.0 steps/s
[Step=23700 Epoch=224.6] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.389 | acc=1.0000 | 4588.9 samples/s | 71.7 steps/s
[Step=23750 Epoch=225.1] | Loss=0.00033 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.389 | acc=1.0000 | 1611.6 samples/s | 25.2 steps/s
[Step=23800 Epoch=225.5] | Loss=0.00030 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.389 | acc=1.0000 | 4467.8 samples/s | 69.8 steps/s
[Step=23850 Epoch=226.0] | Loss=0.00028 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.389 | acc=1.0000 | 1624.1 samples/s | 25.4 steps/s
[Step=23900 Epoch=226.5] | Loss=0.00026 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.390 | acc=1.0000 | 4453.4 samples/s | 69.6 steps/s
[Step=23950 Epoch=226.9] | Loss=0.00025 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.390 | acc=1.0000 | 1640.2 samples/s | 25.6 steps/s
[Step=24000 Epoch=227.4] | Loss=0.00023 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.390 | acc=1.0000 | 4399.3 samples/s | 68.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=22401 Epoch=213.1] | Loss=0.06672 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.379 | acc=0.9531 | 3960.7 samples/s | 61.9 steps/s
[Step=22450 Epoch=213.6] | Loss=0.00557 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.384 | acc=1.0000 | 4230.8 samples/s | 66.1 steps/s
[Step=22500 Epoch=214.0] | Loss=0.00286 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.385 | acc=1.0000 | 5309.4 samples/s | 83.0 steps/s
[Step=22550 Epoch=214.5] | Loss=0.00192 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.386 | acc=1.0000 | 1550.3 samples/s | 24.2 steps/s
[Step=22600 Epoch=215.0] | Loss=0.00145 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.386 | acc=1.0000 | 5007.9 samples/s | 78.2 steps/s
[Step=22650 Epoch=215.5] | Loss=0.00116 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.386 | acc=1.0000 | 1560.3 samples/s | 24.4 steps/s
[Step=22700 Epoch=215.9] | Loss=0.00097 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.386 | acc=1.0000 | 4778.1 samples/s | 74.7 steps/s
[Step=22750 Epoch=216.4] | Loss=0.00084 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.387 | acc=1.0000 | 1563.8 samples/s | 24.4 steps/s
[Step=22800 Epoch=216.9] | Loss=0.00074 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.387 | acc=1.0000 | 4677.6 samples/s | 73.1 steps/s
[Step=22850 Epoch=217.4] | Loss=0.00066 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.387 | acc=1.0000 | 1595.8 samples/s | 24.9 steps/s
[Step=22900 Epoch=217.8] | Loss=0.00059 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.387 | acc=1.0000 | 4562.3 samples/s | 71.3 steps/s
[Step=22950 Epoch=218.3] | Loss=0.00054 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.388 | acc=1.0000 | 1630.9 samples/s | 25.5 steps/s
[Step=23000 Epoch=218.8] | Loss=0.00050 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.388 | acc=1.0000 | 4550.0 samples/s | 71.1 steps/s
[Step=23050 Epoch=219.3] | Loss=0.00046 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.388 | acc=1.0000 | 1623.0 samples/s | 25.4 steps/s
[Step=23100 Epoch=219.7] | Loss=0.00043 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.388 | acc=1.0000 | 4422.4 samples/s | 69.1 steps/s
[Step=23150 Epoch=220.2] | Loss=0.00040 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.388 | acc=1.0000 | 1609.7 samples/s | 25.2 steps/s
[Step=23200 Epoch=220.7] | Loss=0.00038 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.388 | acc=1.0000 | 3745.1 samples/s | 58.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step23200.h5

Train client 7: client_iccad2012_2
Restoring client from server.
LR=0.00006, len=1
[Step=17601 Epoch=168.1] | Loss=0.01518 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.379 | acc=0.9844 | 3394.9 samples/s | 53.0 steps/s
[Step=17650 Epoch=168.5] | Loss=0.00525 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.382 | acc=1.0000 | 4024.6 samples/s | 62.9 steps/s
[Step=17700 Epoch=169.0] | Loss=0.00268 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.384 | acc=1.0000 | 5314.5 samples/s | 83.0 steps/s
[Step=17750 Epoch=169.5] | Loss=0.00184 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.385 | acc=1.0000 | 1451.4 samples/s | 22.7 steps/s
[Step=17800 Epoch=170.0] | Loss=0.00139 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.386 | acc=1.0000 | 4530.1 samples/s | 70.8 steps/s
[Step=17850 Epoch=170.5] | Loss=0.00112 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.387 | acc=1.0000 | 1542.1 samples/s | 24.1 steps/s
[Step=17900 Epoch=170.9] | Loss=0.00094 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.387 | acc=1.0000 | 5050.1 samples/s | 78.9 steps/s
[Step=17950 Epoch=171.4] | Loss=0.00081 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.387 | acc=1.0000 | 1552.6 samples/s | 24.3 steps/s
[Step=18000 Epoch=171.9] | Loss=0.00071 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.388 | acc=1.0000 | 4734.6 samples/s | 74.0 steps/s
[Step=18050 Epoch=172.4] | Loss=0.00063 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.388 | acc=1.0000 | 1580.5 samples/s | 24.7 steps/s
[Step=18100 Epoch=172.8] | Loss=0.00057 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.388 | acc=1.0000 | 4638.3 samples/s | 72.5 steps/s
[Step=18150 Epoch=173.3] | Loss=0.00052 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.389 | acc=1.0000 | 1592.5 samples/s | 24.9 steps/s
[Step=18200 Epoch=173.8] | Loss=0.00048 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.389 | acc=1.0000 | 4624.4 samples/s | 72.3 steps/s
[Step=18250 Epoch=174.3] | Loss=0.00044 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.389 | acc=1.0000 | 1606.5 samples/s | 25.1 steps/s
[Step=18300 Epoch=174.8] | Loss=0.00041 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.389 | acc=1.0000 | 4406.9 samples/s | 68.9 steps/s
[Step=18350 Epoch=175.2] | Loss=0.00039 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.389 | acc=1.0000 | 1600.5 samples/s | 25.0 steps/s
[Step=18400 Epoch=175.7] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.390 | acc=1.0000 | 4579.1 samples/s | 71.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_2/client_state-step18400.h5

Train client 9: client_iccad2012_4
Restoring client from server.
LR=0.00006, len=1
[Step=24001 Epoch=228.8] | Loss=0.01349 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.379 | acc=0.9844 | 3801.1 samples/s | 59.4 steps/s
[Step=24050 Epoch=229.2] | Loss=0.00300 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.383 | acc=1.0000 | 4298.1 samples/s | 67.2 steps/s
[Step=24100 Epoch=229.7] | Loss=0.00154 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.384 | acc=1.0000 | 5383.6 samples/s | 84.1 steps/s
[Step=24150 Epoch=230.2] | Loss=0.00105 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.385 | acc=1.0000 | 1520.5 samples/s | 23.8 steps/s
[Step=24200 Epoch=230.6] | Loss=0.00079 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.386 | acc=1.0000 | 5020.4 samples/s | 78.4 steps/s
[Step=24250 Epoch=231.1] | Loss=0.00064 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.386 | acc=1.0000 | 1458.6 samples/s | 22.8 steps/s
[Step=24300 Epoch=231.6] | Loss=0.00054 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.386 | acc=1.0000 | 4373.5 samples/s | 68.3 steps/s
[Step=24350 Epoch=232.1] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.387 | acc=1.0000 | 1558.1 samples/s | 24.3 steps/s
[Step=24400 Epoch=232.6] | Loss=0.00041 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.387 | acc=1.0000 | 4683.6 samples/s | 73.2 steps/s
[Step=24450 Epoch=233.0] | Loss=0.00037 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.387 | acc=1.0000 | 1574.4 samples/s | 24.6 steps/s
[Step=24500 Epoch=233.5] | Loss=0.00033 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.387 | acc=1.0000 | 4581.3 samples/s | 71.6 steps/s
[Step=24550 Epoch=234.0] | Loss=0.00030 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.388 | acc=1.0000 | 1596.5 samples/s | 24.9 steps/s
[Step=24600 Epoch=234.5] | Loss=0.00028 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.388 | acc=1.0000 | 4581.1 samples/s | 71.6 steps/s
[Step=24650 Epoch=234.9] | Loss=0.00026 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.388 | acc=1.0000 | 1588.1 samples/s | 24.8 steps/s
[Step=24700 Epoch=235.4] | Loss=0.00024 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.388 | acc=1.0000 | 4469.0 samples/s | 69.8 steps/s
[Step=24750 Epoch=235.9] | Loss=0.00023 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.389 | acc=1.0000 | 1608.2 samples/s | 25.1 steps/s
[Step=24800 Epoch=236.4] | Loss=0.00022 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.389 | acc=1.0000 | 4441.3 samples/s | 69.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_4/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29709 | acc=0.8491 | tpr=0.7835 | fpr=0.0084 | 4328.4 samples/s | 16.9 steps/s
Avg test loss: 0.30372, Avg test acc: 0.84863, Avg tpr: 0.78394, Avg fpr: 0.00910, total FA: 71

Testing server on iccad2012
[Step=  50] | Loss=0.45373 | acc=0.8772 | tpr=0.9646 | fpr=0.1244 | 4613.4 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.46084 | acc=0.8773 | tpr=0.9701 | fpr=0.1245 | 8986.9 samples/s | 35.1 steps/s
[Step= 150] | Loss=0.46811 | acc=0.8767 | tpr=0.9712 | fpr=0.1250 | 9520.3 samples/s | 37.2 steps/s
[Step= 200] | Loss=0.47154 | acc=0.8767 | tpr=0.9705 | fpr=0.1250 | 9077.5 samples/s | 35.5 steps/s
[Step= 250] | Loss=0.47024 | acc=0.8765 | tpr=0.9694 | fpr=0.1251 | 9198.6 samples/s | 35.9 steps/s
[Step= 300] | Loss=0.47532 | acc=0.8753 | tpr=0.9695 | fpr=0.1264 | 9079.3 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.47636 | acc=0.8754 | tpr=0.9699 | fpr=0.1263 | 9577.1 samples/s | 37.4 steps/s
[Step= 400] | Loss=0.47877 | acc=0.8755 | tpr=0.9705 | fpr=0.1262 | 8874.7 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.48377 | acc=0.8751 | tpr=0.9698 | fpr=0.1266 | 8968.5 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.48237 | acc=0.8747 | tpr=0.9705 | fpr=0.1270 | 7926.1 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.48073 | acc=0.8746 | tpr=0.9690 | fpr=0.1271 | 15982.3 samples/s | 62.4 steps/s
Avg test loss: 0.48072, Avg test acc: 0.87464, Avg tpr: 0.96791, Avg fpr: 0.12706, total FA: 17642
