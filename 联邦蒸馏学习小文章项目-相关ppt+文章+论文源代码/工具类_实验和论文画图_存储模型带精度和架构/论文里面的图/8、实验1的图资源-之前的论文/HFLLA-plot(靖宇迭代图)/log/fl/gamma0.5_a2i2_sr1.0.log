Total num clients: 4
client model path: ['/research/byu2/rchen/proj/wwy/jp/model/client_asml1_0', '/research/byu2/rchen/proj/wwy/jp/model/client_asml1_1', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1']
client benchmark path: {'asml1': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml1_train', 'asml2': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml2_train', 'asml3': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml3_train', 'asml4': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml4_train', 'iccad2012': '/research/byu2/rchen/proj/wwy/jp/benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32814, 144, 32)
Using transform option: train
#pos = 17102, #neg = 15712
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32737, 144, 32)
Using transform option: train
#pos = 17179, #neg = 15558
loading data into the main memory...
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16703, 144, 32)
Using transform option: train
#pos = 8134, #neg = 8569
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16626, 144, 32)
Using transform option: train
#pos = 8099, #neg = 8527
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35131 | Reg=0.00357 | L2-Norm=18.900 | L2-Norm(final)=1.960 | acc=0.5312 | 2869.9 samples/s | 44.8 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.28814 | Reg=0.00346 | L2-Norm=18.596 | L2-Norm(final)=1.956 | acc=0.7812 | 4728.3 samples/s | 73.9 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.25092 | Reg=0.00341 | L2-Norm=18.476 | L2-Norm(final)=1.963 | acc=0.8438 | 4681.9 samples/s | 73.2 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.22551 | Reg=0.00339 | L2-Norm=18.403 | L2-Norm(final)=1.972 | acc=0.8906 | 4798.8 samples/s | 75.0 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.20902 | Reg=0.00337 | L2-Norm=18.353 | L2-Norm(final)=1.980 | acc=0.8438 | 4630.0 samples/s | 72.3 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.19462 | Reg=0.00336 | L2-Norm=18.319 | L2-Norm(final)=1.987 | acc=0.9531 | 4710.8 samples/s | 73.6 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.18432 | Reg=0.00335 | L2-Norm=18.292 | L2-Norm(final)=1.993 | acc=0.9062 | 4761.0 samples/s | 74.4 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.17565 | Reg=0.00334 | L2-Norm=18.276 | L2-Norm(final)=1.999 | acc=0.9531 | 4775.7 samples/s | 74.6 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.16694 | Reg=0.00334 | L2-Norm=18.263 | L2-Norm(final)=2.004 | acc=0.8750 | 4687.0 samples/s | 73.2 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.15897 | Reg=0.00333 | L2-Norm=18.253 | L2-Norm(final)=2.010 | acc=0.8750 | 4652.2 samples/s | 72.7 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.15252 | Reg=0.00333 | L2-Norm=18.243 | L2-Norm(final)=2.015 | acc=0.9688 | 5685.9 samples/s | 88.8 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.14560 | Reg=0.00332 | L2-Norm=18.233 | L2-Norm(final)=2.020 | acc=0.9688 | 1970.8 samples/s | 30.8 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.13997 | Reg=0.00332 | L2-Norm=18.225 | L2-Norm(final)=2.025 | acc=0.9375 | 4131.9 samples/s | 64.6 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.13466 | Reg=0.00332 | L2-Norm=18.220 | L2-Norm(final)=2.029 | acc=0.9062 | 4100.2 samples/s | 64.1 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.13071 | Reg=0.00332 | L2-Norm=18.215 | L2-Norm(final)=2.034 | acc=0.9219 | 4198.7 samples/s | 65.6 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.12742 | Reg=0.00332 | L2-Norm=18.212 | L2-Norm(final)=2.038 | acc=0.9531 | 4256.7 samples/s | 66.5 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.12358 | Reg=0.00332 | L2-Norm=18.209 | L2-Norm(final)=2.041 | acc=0.9375 | 4678.6 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37617 | Reg=0.00357 | L2-Norm=18.900 | L2-Norm(final)=1.959 | acc=0.5156 | 4015.9 samples/s | 62.7 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.29042 | Reg=0.00347 | L2-Norm=18.636 | L2-Norm(final)=1.956 | acc=0.7031 | 4048.1 samples/s | 63.3 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.24476 | Reg=0.00343 | L2-Norm=18.531 | L2-Norm(final)=1.968 | acc=0.8125 | 4518.7 samples/s | 70.6 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.22266 | Reg=0.00341 | L2-Norm=18.461 | L2-Norm(final)=1.975 | acc=0.8906 | 4663.7 samples/s | 72.9 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.20350 | Reg=0.00339 | L2-Norm=18.409 | L2-Norm(final)=1.982 | acc=0.8750 | 4715.9 samples/s | 73.7 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.19100 | Reg=0.00337 | L2-Norm=18.368 | L2-Norm(final)=1.989 | acc=0.9375 | 4668.4 samples/s | 72.9 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.18073 | Reg=0.00336 | L2-Norm=18.339 | L2-Norm(final)=1.996 | acc=0.8750 | 4717.0 samples/s | 73.7 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.17139 | Reg=0.00336 | L2-Norm=18.316 | L2-Norm(final)=2.004 | acc=0.9062 | 4668.2 samples/s | 72.9 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.16454 | Reg=0.00335 | L2-Norm=18.298 | L2-Norm(final)=2.011 | acc=0.9688 | 4761.1 samples/s | 74.4 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.15691 | Reg=0.00334 | L2-Norm=18.284 | L2-Norm(final)=2.017 | acc=0.9688 | 4632.1 samples/s | 72.4 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.14982 | Reg=0.00334 | L2-Norm=18.273 | L2-Norm(final)=2.025 | acc=0.9219 | 5672.4 samples/s | 88.6 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.14305 | Reg=0.00334 | L2-Norm=18.263 | L2-Norm(final)=2.032 | acc=0.9062 | 1991.7 samples/s | 31.1 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.13782 | Reg=0.00333 | L2-Norm=18.254 | L2-Norm(final)=2.038 | acc=0.9688 | 4540.7 samples/s | 70.9 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.13316 | Reg=0.00333 | L2-Norm=18.247 | L2-Norm(final)=2.045 | acc=0.9688 | 4633.3 samples/s | 72.4 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.12880 | Reg=0.00333 | L2-Norm=18.243 | L2-Norm(final)=2.051 | acc=0.9688 | 4667.0 samples/s | 72.9 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.12529 | Reg=0.00333 | L2-Norm=18.240 | L2-Norm(final)=2.057 | acc=0.9062 | 4594.0 samples/s | 71.8 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.12188 | Reg=0.00333 | L2-Norm=18.236 | L2-Norm(final)=2.062 | acc=0.9375 | 4720.1 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37205 | Reg=0.00357 | L2-Norm=18.900 | L2-Norm(final)=1.959 | acc=0.5625 | 4029.1 samples/s | 63.0 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.16518 | Reg=0.00350 | L2-Norm=18.717 | L2-Norm(final)=1.974 | acc=1.0000 | 4175.2 samples/s | 65.2 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.10780 | Reg=0.00347 | L2-Norm=18.638 | L2-Norm(final)=1.988 | acc=0.9219 | 4405.9 samples/s | 68.8 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.07894 | Reg=0.00345 | L2-Norm=18.572 | L2-Norm(final)=1.999 | acc=0.9844 | 4363.0 samples/s | 68.2 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.06206 | Reg=0.00343 | L2-Norm=18.514 | L2-Norm(final)=2.009 | acc=1.0000 | 4447.7 samples/s | 69.5 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.05191 | Reg=0.00341 | L2-Norm=18.459 | L2-Norm(final)=2.018 | acc=1.0000 | 5618.2 samples/s | 87.8 steps/s
[Step= 300 Epoch= 1.1] | Loss=0.04637 | Reg=0.00339 | L2-Norm=18.407 | L2-Norm(final)=2.023 | acc=1.0000 | 1878.0 samples/s | 29.3 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.04003 | Reg=0.00337 | L2-Norm=18.359 | L2-Norm(final)=2.029 | acc=1.0000 | 4380.1 samples/s | 68.4 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.03544 | Reg=0.00335 | L2-Norm=18.311 | L2-Norm(final)=2.034 | acc=1.0000 | 4312.4 samples/s | 67.4 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.03175 | Reg=0.00334 | L2-Norm=18.264 | L2-Norm(final)=2.038 | acc=1.0000 | 4414.9 samples/s | 69.0 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.02871 | Reg=0.00332 | L2-Norm=18.217 | L2-Norm(final)=2.043 | acc=1.0000 | 4816.1 samples/s | 75.3 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.02621 | Reg=0.00330 | L2-Norm=18.171 | L2-Norm(final)=2.047 | acc=1.0000 | 1994.5 samples/s | 31.2 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.02407 | Reg=0.00329 | L2-Norm=18.125 | L2-Norm(final)=2.051 | acc=1.0000 | 4486.6 samples/s | 70.1 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.02224 | Reg=0.00327 | L2-Norm=18.078 | L2-Norm(final)=2.055 | acc=1.0000 | 4364.8 samples/s | 68.2 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.02065 | Reg=0.00325 | L2-Norm=18.032 | L2-Norm(final)=2.058 | acc=1.0000 | 4438.4 samples/s | 69.4 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.01928 | Reg=0.00324 | L2-Norm=17.985 | L2-Norm(final)=2.062 | acc=1.0000 | 4434.1 samples/s | 69.3 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.01808 | Reg=0.00322 | L2-Norm=17.938 | L2-Norm(final)=2.065 | acc=1.0000 | 2046.2 samples/s | 32.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.43392 | Reg=0.00357 | L2-Norm=18.900 | L2-Norm(final)=1.959 | acc=0.4375 | 3721.3 samples/s | 58.1 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.21526 | Reg=0.00349 | L2-Norm=18.678 | L2-Norm(final)=1.960 | acc=0.9688 | 4487.7 samples/s | 70.1 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.13076 | Reg=0.00347 | L2-Norm=18.618 | L2-Norm(final)=1.982 | acc=0.9688 | 4349.1 samples/s | 68.0 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.10169 | Reg=0.00344 | L2-Norm=18.554 | L2-Norm(final)=1.993 | acc=1.0000 | 4455.3 samples/s | 69.6 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.08157 | Reg=0.00342 | L2-Norm=18.497 | L2-Norm(final)=2.003 | acc=1.0000 | 4384.0 samples/s | 68.5 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.06677 | Reg=0.00340 | L2-Norm=18.442 | L2-Norm(final)=2.012 | acc=0.9844 | 5462.0 samples/s | 85.3 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.05694 | Reg=0.00338 | L2-Norm=18.386 | L2-Norm(final)=2.020 | acc=1.0000 | 1913.4 samples/s | 29.9 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.04927 | Reg=0.00336 | L2-Norm=18.329 | L2-Norm(final)=2.026 | acc=1.0000 | 4383.5 samples/s | 68.5 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.04334 | Reg=0.00334 | L2-Norm=18.273 | L2-Norm(final)=2.032 | acc=1.0000 | 4346.5 samples/s | 67.9 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.03891 | Reg=0.00332 | L2-Norm=18.218 | L2-Norm(final)=2.037 | acc=1.0000 | 4438.6 samples/s | 69.4 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.03521 | Reg=0.00330 | L2-Norm=18.164 | L2-Norm(final)=2.042 | acc=1.0000 | 5054.7 samples/s | 79.0 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.03206 | Reg=0.00328 | L2-Norm=18.112 | L2-Norm(final)=2.047 | acc=1.0000 | 1983.5 samples/s | 31.0 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.02941 | Reg=0.00326 | L2-Norm=18.059 | L2-Norm(final)=2.052 | acc=1.0000 | 4467.3 samples/s | 69.8 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.02721 | Reg=0.00324 | L2-Norm=18.008 | L2-Norm(final)=2.056 | acc=1.0000 | 4370.9 samples/s | 68.3 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.02529 | Reg=0.00323 | L2-Norm=17.957 | L2-Norm(final)=2.061 | acc=1.0000 | 4467.0 samples/s | 69.8 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.02361 | Reg=0.00321 | L2-Norm=17.906 | L2-Norm(final)=2.064 | acc=1.0000 | 4494.8 samples/s | 70.2 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.02216 | Reg=0.00319 | L2-Norm=17.855 | L2-Norm(final)=2.068 | acc=1.0000 | 2029.5 samples/s | 31.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37222 | acc=0.5877 | tpr=0.4323 | fpr=0.0751 | 4268.1 samples/s | 16.7 steps/s
Avg test loss: 0.37468, Avg test acc: 0.58402, Avg tpr: 0.42840, Avg fpr: 0.07371, total FA: 575

Testing server on iccad2012
[Step=  50] | Loss=0.22328 | acc=0.8045 | tpr=0.8761 | fpr=0.1968 | 4297.7 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.22186 | acc=0.8070 | tpr=0.8934 | fpr=0.1947 | 8421.0 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.22242 | acc=0.8061 | tpr=0.9006 | fpr=0.1956 | 8245.9 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.22233 | acc=0.8065 | tpr=0.9038 | fpr=0.1952 | 7756.9 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.22203 | acc=0.8071 | tpr=0.9066 | fpr=0.1947 | 7712.7 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.22199 | acc=0.8069 | tpr=0.9040 | fpr=0.1949 | 7639.6 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.22236 | acc=0.8056 | tpr=0.9036 | fpr=0.1962 | 7822.2 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.22232 | acc=0.8063 | tpr=0.8972 | fpr=0.1954 | 8158.2 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.22288 | acc=0.8057 | tpr=0.8968 | fpr=0.1959 | 8597.9 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.22305 | acc=0.8055 | tpr=0.8965 | fpr=0.1962 | 7949.4 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.22287 | acc=0.8058 | tpr=0.8965 | fpr=0.1958 | 14716.8 samples/s | 57.5 steps/s
Avg test loss: 0.22286, Avg test acc: 0.80582, Avg tpr: 0.89580, Avg fpr: 0.19582, total FA: 27189

server round 1/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 1.6] | Loss=0.27978 | Reg=0.00281 | L2-Norm=16.767 | L2-Norm(final)=2.099 | acc=0.7188 | 4055.1 samples/s | 63.4 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.16296 | Reg=0.00287 | L2-Norm=16.927 | L2-Norm(final)=2.094 | acc=0.8906 | 4233.3 samples/s | 66.1 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.14006 | Reg=0.00289 | L2-Norm=17.001 | L2-Norm(final)=2.099 | acc=0.9219 | 4665.5 samples/s | 72.9 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.12716 | Reg=0.00290 | L2-Norm=17.041 | L2-Norm(final)=2.108 | acc=0.9531 | 4540.3 samples/s | 70.9 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.11928 | Reg=0.00291 | L2-Norm=17.071 | L2-Norm(final)=2.115 | acc=0.8438 | 4595.8 samples/s | 71.8 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.11346 | Reg=0.00292 | L2-Norm=17.094 | L2-Norm(final)=2.120 | acc=0.9375 | 4683.2 samples/s | 73.2 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.11082 | Reg=0.00293 | L2-Norm=17.112 | L2-Norm(final)=2.123 | acc=0.9531 | 4696.2 samples/s | 73.4 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.10725 | Reg=0.00293 | L2-Norm=17.129 | L2-Norm(final)=2.126 | acc=0.8438 | 4615.4 samples/s | 72.1 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.10483 | Reg=0.00294 | L2-Norm=17.141 | L2-Norm(final)=2.128 | acc=0.9062 | 4667.2 samples/s | 72.9 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.10252 | Reg=0.00294 | L2-Norm=17.153 | L2-Norm(final)=2.130 | acc=0.8594 | 4603.0 samples/s | 71.9 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.09910 | Reg=0.00295 | L2-Norm=17.164 | L2-Norm(final)=2.132 | acc=0.9062 | 5636.4 samples/s | 88.1 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.09498 | Reg=0.00295 | L2-Norm=17.177 | L2-Norm(final)=2.135 | acc=0.9688 | 1902.7 samples/s | 29.7 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.09124 | Reg=0.00296 | L2-Norm=17.190 | L2-Norm(final)=2.139 | acc=0.9531 | 4576.9 samples/s | 71.5 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.08893 | Reg=0.00296 | L2-Norm=17.203 | L2-Norm(final)=2.143 | acc=0.9531 | 4649.9 samples/s | 72.7 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.08710 | Reg=0.00296 | L2-Norm=17.216 | L2-Norm(final)=2.146 | acc=0.9375 | 4615.3 samples/s | 72.1 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.08513 | Reg=0.00297 | L2-Norm=17.228 | L2-Norm(final)=2.149 | acc=0.9531 | 4603.0 samples/s | 71.9 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.08350 | Reg=0.00297 | L2-Norm=17.240 | L2-Norm(final)=2.152 | acc=0.9531 | 4590.8 samples/s | 71.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step1600.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 1.6] | Loss=0.26141 | Reg=0.00281 | L2-Norm=16.767 | L2-Norm(final)=2.099 | acc=0.7344 | 4164.5 samples/s | 65.1 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.16499 | Reg=0.00286 | L2-Norm=16.910 | L2-Norm(final)=2.093 | acc=0.9219 | 4375.1 samples/s | 68.4 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.14349 | Reg=0.00288 | L2-Norm=16.976 | L2-Norm(final)=2.102 | acc=0.9219 | 4630.4 samples/s | 72.4 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.13132 | Reg=0.00290 | L2-Norm=17.015 | L2-Norm(final)=2.112 | acc=0.9219 | 4640.2 samples/s | 72.5 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.12399 | Reg=0.00291 | L2-Norm=17.044 | L2-Norm(final)=2.117 | acc=0.9062 | 4632.4 samples/s | 72.4 steps/s
[Step=1050 Epoch= 2.1] | Loss=0.11757 | Reg=0.00291 | L2-Norm=17.067 | L2-Norm(final)=2.121 | acc=0.9219 | 4739.2 samples/s | 74.0 steps/s
[Step=1100 Epoch= 2.2] | Loss=0.11274 | Reg=0.00292 | L2-Norm=17.088 | L2-Norm(final)=2.126 | acc=0.9531 | 4579.2 samples/s | 71.6 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.10834 | Reg=0.00293 | L2-Norm=17.106 | L2-Norm(final)=2.131 | acc=0.9219 | 4433.4 samples/s | 69.3 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.10529 | Reg=0.00293 | L2-Norm=17.122 | L2-Norm(final)=2.135 | acc=0.9531 | 4507.0 samples/s | 70.4 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.10170 | Reg=0.00294 | L2-Norm=17.137 | L2-Norm(final)=2.140 | acc=0.9844 | 4662.0 samples/s | 72.8 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.09947 | Reg=0.00294 | L2-Norm=17.151 | L2-Norm(final)=2.144 | acc=0.9375 | 5844.9 samples/s | 91.3 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.09634 | Reg=0.00295 | L2-Norm=17.166 | L2-Norm(final)=2.148 | acc=0.9688 | 1970.0 samples/s | 30.8 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.09380 | Reg=0.00295 | L2-Norm=17.181 | L2-Norm(final)=2.152 | acc=0.9062 | 4644.5 samples/s | 72.6 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.09110 | Reg=0.00296 | L2-Norm=17.197 | L2-Norm(final)=2.157 | acc=0.9375 | 4618.4 samples/s | 72.2 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.08888 | Reg=0.00296 | L2-Norm=17.212 | L2-Norm(final)=2.160 | acc=0.9688 | 4597.5 samples/s | 71.8 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.08686 | Reg=0.00297 | L2-Norm=17.228 | L2-Norm(final)=2.164 | acc=0.9844 | 4710.7 samples/s | 73.6 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.08533 | Reg=0.00297 | L2-Norm=17.243 | L2-Norm(final)=2.167 | acc=0.9219 | 4617.7 samples/s | 72.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step1600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 3.1] | Loss=0.16999 | Reg=0.00281 | L2-Norm=16.767 | L2-Norm(final)=2.100 | acc=0.9062 | 4049.8 samples/s | 63.3 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.05470 | Reg=0.00289 | L2-Norm=16.989 | L2-Norm(final)=2.101 | acc=1.0000 | 4181.6 samples/s | 65.3 steps/s
[Step= 900 Epoch= 3.4] | Loss=0.03388 | Reg=0.00291 | L2-Norm=17.053 | L2-Norm(final)=2.106 | acc=1.0000 | 4412.9 samples/s | 69.0 steps/s
[Step= 950 Epoch= 3.6] | Loss=0.02566 | Reg=0.00291 | L2-Norm=17.064 | L2-Norm(final)=2.111 | acc=1.0000 | 4418.7 samples/s | 69.0 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02032 | Reg=0.00291 | L2-Norm=17.058 | L2-Norm(final)=2.118 | acc=1.0000 | 4343.1 samples/s | 67.9 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.01664 | Reg=0.00291 | L2-Norm=17.044 | L2-Norm(final)=2.125 | acc=1.0000 | 5428.5 samples/s | 84.8 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01394 | Reg=0.00290 | L2-Norm=17.024 | L2-Norm(final)=2.131 | acc=1.0000 | 1927.9 samples/s | 30.1 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01196 | Reg=0.00289 | L2-Norm=16.998 | L2-Norm(final)=2.137 | acc=1.0000 | 4305.9 samples/s | 67.3 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01048 | Reg=0.00288 | L2-Norm=16.969 | L2-Norm(final)=2.141 | acc=1.0000 | 4433.0 samples/s | 69.3 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.00933 | Reg=0.00287 | L2-Norm=16.937 | L2-Norm(final)=2.145 | acc=1.0000 | 4386.4 samples/s | 68.5 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00849 | Reg=0.00286 | L2-Norm=16.904 | L2-Norm(final)=2.149 | acc=1.0000 | 4825.5 samples/s | 75.4 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00794 | Reg=0.00285 | L2-Norm=16.873 | L2-Norm(final)=2.152 | acc=1.0000 | 1986.0 samples/s | 31.0 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00766 | Reg=0.00284 | L2-Norm=16.844 | L2-Norm(final)=2.154 | acc=0.9844 | 4300.2 samples/s | 67.2 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00730 | Reg=0.00283 | L2-Norm=16.820 | L2-Norm(final)=2.157 | acc=1.0000 | 4393.2 samples/s | 68.6 steps/s
[Step=1500 Epoch= 5.7] | Loss=0.00691 | Reg=0.00282 | L2-Norm=16.797 | L2-Norm(final)=2.160 | acc=1.0000 | 4410.8 samples/s | 68.9 steps/s
[Step=1550 Epoch= 5.9] | Loss=0.00664 | Reg=0.00281 | L2-Norm=16.776 | L2-Norm(final)=2.163 | acc=1.0000 | 4326.9 samples/s | 67.6 steps/s
[Step=1600 Epoch= 6.1] | Loss=0.00631 | Reg=0.00281 | L2-Norm=16.755 | L2-Norm(final)=2.165 | acc=1.0000 | 2082.6 samples/s | 32.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step1600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 3.1] | Loss=0.17478 | Reg=0.00281 | L2-Norm=16.767 | L2-Norm(final)=2.101 | acc=0.8750 | 3758.1 samples/s | 58.7 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.05560 | Reg=0.00288 | L2-Norm=16.981 | L2-Norm(final)=2.108 | acc=1.0000 | 4550.7 samples/s | 71.1 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.03485 | Reg=0.00291 | L2-Norm=17.045 | L2-Norm(final)=2.109 | acc=0.9844 | 4325.8 samples/s | 67.6 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.02515 | Reg=0.00291 | L2-Norm=17.054 | L2-Norm(final)=2.115 | acc=1.0000 | 4491.8 samples/s | 70.2 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02042 | Reg=0.00291 | L2-Norm=17.046 | L2-Norm(final)=2.121 | acc=1.0000 | 4411.0 samples/s | 68.9 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.01711 | Reg=0.00290 | L2-Norm=17.031 | L2-Norm(final)=2.126 | acc=1.0000 | 5618.1 samples/s | 87.8 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01438 | Reg=0.00289 | L2-Norm=17.010 | L2-Norm(final)=2.130 | acc=1.0000 | 1901.6 samples/s | 29.7 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01236 | Reg=0.00288 | L2-Norm=16.984 | L2-Norm(final)=2.134 | acc=1.0000 | 4409.5 samples/s | 68.9 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01084 | Reg=0.00287 | L2-Norm=16.954 | L2-Norm(final)=2.138 | acc=1.0000 | 4410.7 samples/s | 68.9 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.00971 | Reg=0.00286 | L2-Norm=16.922 | L2-Norm(final)=2.141 | acc=1.0000 | 4376.4 samples/s | 68.4 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00877 | Reg=0.00285 | L2-Norm=16.890 | L2-Norm(final)=2.144 | acc=1.0000 | 4971.3 samples/s | 77.7 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00800 | Reg=0.00284 | L2-Norm=16.856 | L2-Norm(final)=2.147 | acc=1.0000 | 1998.4 samples/s | 31.2 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00733 | Reg=0.00283 | L2-Norm=16.822 | L2-Norm(final)=2.150 | acc=1.0000 | 4438.0 samples/s | 69.3 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00678 | Reg=0.00282 | L2-Norm=16.787 | L2-Norm(final)=2.153 | acc=1.0000 | 4365.0 samples/s | 68.2 steps/s
[Step=1500 Epoch= 5.8] | Loss=0.00630 | Reg=0.00281 | L2-Norm=16.751 | L2-Norm(final)=2.155 | acc=1.0000 | 4266.3 samples/s | 66.7 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.00588 | Reg=0.00279 | L2-Norm=16.715 | L2-Norm(final)=2.158 | acc=1.0000 | 4328.5 samples/s | 67.6 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.00552 | Reg=0.00278 | L2-Norm=16.678 | L2-Norm(final)=2.160 | acc=1.0000 | 2049.5 samples/s | 32.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36715 | acc=0.6558 | tpr=0.5484 | fpr=0.1110 | 4312.0 samples/s | 16.8 steps/s
Avg test loss: 0.36605, Avg test acc: 0.65458, Avg tpr: 0.54782, Avg fpr: 0.11063, total FA: 863

Testing server on iccad2012
[Step=  50] | Loss=0.26187 | acc=0.7922 | tpr=0.9779 | fpr=0.2111 | 4314.4 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.25954 | acc=0.7942 | tpr=0.9851 | fpr=0.2094 | 8202.9 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.26247 | acc=0.7920 | tpr=0.9870 | fpr=0.2116 | 8198.2 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.26239 | acc=0.7913 | tpr=0.9891 | fpr=0.2123 | 8189.0 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.26202 | acc=0.7913 | tpr=0.9913 | fpr=0.2123 | 8310.8 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.26208 | acc=0.7920 | tpr=0.9898 | fpr=0.2117 | 8352.3 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.26341 | acc=0.7909 | tpr=0.9881 | fpr=0.2127 | 7850.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.26332 | acc=0.7914 | tpr=0.9841 | fpr=0.2121 | 8342.6 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.26482 | acc=0.7905 | tpr=0.9830 | fpr=0.2130 | 8312.1 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.26513 | acc=0.7899 | tpr=0.9819 | fpr=0.2136 | 8008.4 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.26472 | acc=0.7899 | tpr=0.9805 | fpr=0.2135 | 14695.6 samples/s | 57.4 steps/s
Avg test loss: 0.26457, Avg test acc: 0.79005, Avg tpr: 0.98059, Avg fpr: 0.21341, total FA: 29632

server round 2/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 3.1] | Loss=0.33582 | Reg=0.00263 | L2-Norm=16.208 | L2-Norm(final)=2.184 | acc=0.6719 | 4116.5 samples/s | 64.3 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.12972 | Reg=0.00267 | L2-Norm=16.333 | L2-Norm(final)=2.176 | acc=0.9062 | 4342.6 samples/s | 67.9 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.11321 | Reg=0.00269 | L2-Norm=16.394 | L2-Norm(final)=2.182 | acc=0.9062 | 4673.5 samples/s | 73.0 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.10181 | Reg=0.00270 | L2-Norm=16.435 | L2-Norm(final)=2.191 | acc=0.9688 | 4686.8 samples/s | 73.2 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.09504 | Reg=0.00271 | L2-Norm=16.468 | L2-Norm(final)=2.199 | acc=0.9531 | 4581.9 samples/s | 71.6 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.09054 | Reg=0.00272 | L2-Norm=16.492 | L2-Norm(final)=2.205 | acc=0.9375 | 4624.4 samples/s | 72.3 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.08690 | Reg=0.00273 | L2-Norm=16.515 | L2-Norm(final)=2.211 | acc=0.9375 | 4628.2 samples/s | 72.3 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.08398 | Reg=0.00273 | L2-Norm=16.534 | L2-Norm(final)=2.215 | acc=0.9688 | 4761.4 samples/s | 74.4 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.08181 | Reg=0.00274 | L2-Norm=16.550 | L2-Norm(final)=2.218 | acc=0.9375 | 4605.6 samples/s | 72.0 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.07961 | Reg=0.00274 | L2-Norm=16.567 | L2-Norm(final)=2.221 | acc=0.9844 | 4610.7 samples/s | 72.0 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.07814 | Reg=0.00275 | L2-Norm=16.582 | L2-Norm(final)=2.224 | acc=0.9531 | 5668.3 samples/s | 88.6 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.07532 | Reg=0.00275 | L2-Norm=16.596 | L2-Norm(final)=2.226 | acc=1.0000 | 1957.6 samples/s | 30.6 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.07279 | Reg=0.00276 | L2-Norm=16.609 | L2-Norm(final)=2.230 | acc=0.9531 | 4553.1 samples/s | 71.1 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.07075 | Reg=0.00276 | L2-Norm=16.624 | L2-Norm(final)=2.233 | acc=0.9844 | 4679.7 samples/s | 73.1 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.06908 | Reg=0.00277 | L2-Norm=16.638 | L2-Norm(final)=2.236 | acc=0.9375 | 4662.7 samples/s | 72.9 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.06800 | Reg=0.00277 | L2-Norm=16.650 | L2-Norm(final)=2.239 | acc=0.9844 | 4655.2 samples/s | 72.7 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.06670 | Reg=0.00278 | L2-Norm=16.663 | L2-Norm(final)=2.241 | acc=0.9219 | 4567.8 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step2400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 3.1] | Loss=0.39403 | Reg=0.00263 | L2-Norm=16.208 | L2-Norm(final)=2.183 | acc=0.6250 | 4033.3 samples/s | 63.0 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.13335 | Reg=0.00267 | L2-Norm=16.338 | L2-Norm(final)=2.165 | acc=0.9688 | 4536.6 samples/s | 70.9 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.11142 | Reg=0.00269 | L2-Norm=16.402 | L2-Norm(final)=2.176 | acc=0.9219 | 4449.5 samples/s | 69.5 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.10299 | Reg=0.00270 | L2-Norm=16.441 | L2-Norm(final)=2.187 | acc=0.9688 | 4721.0 samples/s | 73.8 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.09577 | Reg=0.00271 | L2-Norm=16.472 | L2-Norm(final)=2.195 | acc=0.9531 | 4620.4 samples/s | 72.2 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.09095 | Reg=0.00272 | L2-Norm=16.495 | L2-Norm(final)=2.199 | acc=0.9688 | 4668.7 samples/s | 72.9 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.08759 | Reg=0.00273 | L2-Norm=16.513 | L2-Norm(final)=2.203 | acc=0.9531 | 4640.8 samples/s | 72.5 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.08426 | Reg=0.00273 | L2-Norm=16.529 | L2-Norm(final)=2.208 | acc=0.9531 | 4726.3 samples/s | 73.8 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.08194 | Reg=0.00274 | L2-Norm=16.544 | L2-Norm(final)=2.211 | acc=0.9844 | 4670.4 samples/s | 73.0 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.07988 | Reg=0.00274 | L2-Norm=16.559 | L2-Norm(final)=2.215 | acc=0.9531 | 4681.7 samples/s | 73.2 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.07799 | Reg=0.00275 | L2-Norm=16.573 | L2-Norm(final)=2.219 | acc=0.9062 | 5749.0 samples/s | 89.8 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.07502 | Reg=0.00275 | L2-Norm=16.588 | L2-Norm(final)=2.223 | acc=0.9688 | 1989.3 samples/s | 31.1 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.07275 | Reg=0.00276 | L2-Norm=16.602 | L2-Norm(final)=2.228 | acc=0.9375 | 4649.5 samples/s | 72.6 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.07081 | Reg=0.00276 | L2-Norm=16.617 | L2-Norm(final)=2.232 | acc=0.9688 | 4596.3 samples/s | 71.8 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.06921 | Reg=0.00277 | L2-Norm=16.630 | L2-Norm(final)=2.236 | acc=0.9844 | 4696.2 samples/s | 73.4 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.06810 | Reg=0.00277 | L2-Norm=16.644 | L2-Norm(final)=2.240 | acc=0.9688 | 4650.7 samples/s | 72.7 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.06686 | Reg=0.00277 | L2-Norm=16.658 | L2-Norm(final)=2.243 | acc=0.9219 | 4663.8 samples/s | 72.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step2400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 6.1] | Loss=0.16140 | Reg=0.00263 | L2-Norm=16.208 | L2-Norm(final)=2.185 | acc=0.8281 | 4325.4 samples/s | 67.6 steps/s
[Step=1650 Epoch= 6.3] | Loss=0.02697 | Reg=0.00268 | L2-Norm=16.362 | L2-Norm(final)=2.191 | acc=1.0000 | 3935.0 samples/s | 61.5 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.01769 | Reg=0.00269 | L2-Norm=16.401 | L2-Norm(final)=2.198 | acc=1.0000 | 4482.9 samples/s | 70.0 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.01236 | Reg=0.00269 | L2-Norm=16.408 | L2-Norm(final)=2.207 | acc=1.0000 | 4338.7 samples/s | 67.8 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.01014 | Reg=0.00269 | L2-Norm=16.398 | L2-Norm(final)=2.214 | acc=1.0000 | 4338.9 samples/s | 67.8 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00827 | Reg=0.00268 | L2-Norm=16.380 | L2-Norm(final)=2.219 | acc=1.0000 | 5524.6 samples/s | 86.3 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00771 | Reg=0.00268 | L2-Norm=16.361 | L2-Norm(final)=2.223 | acc=1.0000 | 1912.3 samples/s | 29.9 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00708 | Reg=0.00267 | L2-Norm=16.345 | L2-Norm(final)=2.225 | acc=1.0000 | 4268.2 samples/s | 66.7 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00627 | Reg=0.00267 | L2-Norm=16.328 | L2-Norm(final)=2.228 | acc=1.0000 | 4456.7 samples/s | 69.6 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.00563 | Reg=0.00266 | L2-Norm=16.308 | L2-Norm(final)=2.231 | acc=1.0000 | 4410.4 samples/s | 68.9 steps/s
[Step=2100 Epoch= 8.0] | Loss=0.00512 | Reg=0.00265 | L2-Norm=16.287 | L2-Norm(final)=2.234 | acc=1.0000 | 4773.9 samples/s | 74.6 steps/s
[Step=2150 Epoch= 8.2] | Loss=0.00466 | Reg=0.00265 | L2-Norm=16.264 | L2-Norm(final)=2.237 | acc=1.0000 | 1997.7 samples/s | 31.2 steps/s
[Step=2200 Epoch= 8.4] | Loss=0.00428 | Reg=0.00264 | L2-Norm=16.239 | L2-Norm(final)=2.239 | acc=1.0000 | 4323.7 samples/s | 67.6 steps/s
[Step=2250 Epoch= 8.6] | Loss=0.00395 | Reg=0.00263 | L2-Norm=16.212 | L2-Norm(final)=2.241 | acc=1.0000 | 4396.6 samples/s | 68.7 steps/s
[Step=2300 Epoch= 8.8] | Loss=0.00367 | Reg=0.00262 | L2-Norm=16.185 | L2-Norm(final)=2.243 | acc=1.0000 | 4410.8 samples/s | 68.9 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.00343 | Reg=0.00261 | L2-Norm=16.156 | L2-Norm(final)=2.245 | acc=1.0000 | 4334.5 samples/s | 67.7 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.00321 | Reg=0.00260 | L2-Norm=16.126 | L2-Norm(final)=2.247 | acc=1.0000 | 2078.2 samples/s | 32.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step2400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 6.2] | Loss=0.12176 | Reg=0.00263 | L2-Norm=16.208 | L2-Norm(final)=2.186 | acc=0.8594 | 3957.6 samples/s | 61.8 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.03164 | Reg=0.00268 | L2-Norm=16.380 | L2-Norm(final)=2.184 | acc=1.0000 | 4358.9 samples/s | 68.1 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.02171 | Reg=0.00270 | L2-Norm=16.441 | L2-Norm(final)=2.184 | acc=1.0000 | 4288.8 samples/s | 67.0 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.01702 | Reg=0.00271 | L2-Norm=16.465 | L2-Norm(final)=2.187 | acc=1.0000 | 4427.0 samples/s | 69.2 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.01385 | Reg=0.00271 | L2-Norm=16.470 | L2-Norm(final)=2.190 | acc=1.0000 | 4377.3 samples/s | 68.4 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.01205 | Reg=0.00271 | L2-Norm=16.465 | L2-Norm(final)=2.193 | acc=1.0000 | 5990.1 samples/s | 93.6 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.01092 | Reg=0.00271 | L2-Norm=16.457 | L2-Norm(final)=2.195 | acc=1.0000 | 2020.7 samples/s | 31.6 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00946 | Reg=0.00271 | L2-Norm=16.450 | L2-Norm(final)=2.199 | acc=1.0000 | 4689.2 samples/s | 73.3 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00830 | Reg=0.00270 | L2-Norm=16.437 | L2-Norm(final)=2.202 | acc=1.0000 | 4766.1 samples/s | 74.5 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.00739 | Reg=0.00270 | L2-Norm=16.420 | L2-Norm(final)=2.206 | acc=1.0000 | 4787.0 samples/s | 74.8 steps/s
[Step=2100 Epoch= 8.1] | Loss=0.00667 | Reg=0.00269 | L2-Norm=16.398 | L2-Norm(final)=2.209 | acc=1.0000 | 5268.0 samples/s | 82.3 steps/s
[Step=2150 Epoch= 8.3] | Loss=0.00607 | Reg=0.00268 | L2-Norm=16.374 | L2-Norm(final)=2.212 | acc=1.0000 | 2091.4 samples/s | 32.7 steps/s
[Step=2200 Epoch= 8.5] | Loss=0.00556 | Reg=0.00267 | L2-Norm=16.347 | L2-Norm(final)=2.214 | acc=1.0000 | 4768.7 samples/s | 74.5 steps/s
[Step=2250 Epoch= 8.7] | Loss=0.00514 | Reg=0.00266 | L2-Norm=16.319 | L2-Norm(final)=2.216 | acc=1.0000 | 4707.9 samples/s | 73.6 steps/s
[Step=2300 Epoch= 8.9] | Loss=0.00477 | Reg=0.00265 | L2-Norm=16.289 | L2-Norm(final)=2.218 | acc=1.0000 | 4756.8 samples/s | 74.3 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.00446 | Reg=0.00264 | L2-Norm=16.258 | L2-Norm(final)=2.220 | acc=1.0000 | 4840.3 samples/s | 75.6 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.00418 | Reg=0.00263 | L2-Norm=16.226 | L2-Norm(final)=2.222 | acc=1.0000 | 2186.1 samples/s | 34.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32435 | acc=0.7294 | tpr=0.6403 | fpr=0.0773 | 4495.9 samples/s | 17.6 steps/s
Avg test loss: 0.32535, Avg test acc: 0.73111, Avg tpr: 0.64382, Avg fpr: 0.07691, total FA: 600

Testing server on iccad2012
[Step=  50] | Loss=0.26244 | acc=0.8225 | tpr=0.9779 | fpr=0.1803 | 4766.8 samples/s | 18.6 steps/s
[Step= 100] | Loss=0.26056 | acc=0.8264 | tpr=0.9893 | fpr=0.1766 | 8096.1 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.26491 | acc=0.8255 | tpr=0.9914 | fpr=0.1776 | 9029.1 samples/s | 35.3 steps/s
[Step= 200] | Loss=0.26540 | acc=0.8258 | tpr=0.9923 | fpr=0.1772 | 9243.8 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.26409 | acc=0.8262 | tpr=0.9939 | fpr=0.1768 | 8280.8 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.26485 | acc=0.8264 | tpr=0.9920 | fpr=0.1766 | 8959.6 samples/s | 35.0 steps/s
[Step= 350] | Loss=0.26628 | acc=0.8253 | tpr=0.9900 | fpr=0.1777 | 8775.5 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.26634 | acc=0.8262 | tpr=0.9858 | fpr=0.1767 | 8764.6 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.26858 | acc=0.8255 | tpr=0.9834 | fpr=0.1773 | 8806.0 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.26895 | acc=0.8251 | tpr=0.9824 | fpr=0.1777 | 8817.7 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.26809 | acc=0.8256 | tpr=0.9813 | fpr=0.1773 | 16012.5 samples/s | 62.5 steps/s
Avg test loss: 0.26803, Avg test acc: 0.82560, Avg tpr: 0.98138, Avg fpr: 0.17723, total FA: 24608

server round 3/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 4.7] | Loss=0.16525 | Reg=0.00250 | L2-Norm=15.799 | L2-Norm(final)=2.264 | acc=0.8594 | 4026.3 samples/s | 62.9 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.10143 | Reg=0.00254 | L2-Norm=15.930 | L2-Norm(final)=2.259 | acc=0.9219 | 4779.2 samples/s | 74.7 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.08180 | Reg=0.00256 | L2-Norm=15.992 | L2-Norm(final)=2.267 | acc=0.9375 | 4939.4 samples/s | 77.2 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.08114 | Reg=0.00257 | L2-Norm=16.022 | L2-Norm(final)=2.266 | acc=0.8906 | 5039.9 samples/s | 78.7 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.07766 | Reg=0.00258 | L2-Norm=16.047 | L2-Norm(final)=2.266 | acc=0.9531 | 4845.2 samples/s | 75.7 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.07447 | Reg=0.00258 | L2-Norm=16.069 | L2-Norm(final)=2.265 | acc=0.9688 | 5052.5 samples/s | 78.9 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.07126 | Reg=0.00259 | L2-Norm=16.089 | L2-Norm(final)=2.266 | acc=0.9531 | 5007.2 samples/s | 78.2 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.07102 | Reg=0.00259 | L2-Norm=16.108 | L2-Norm(final)=2.266 | acc=0.9688 | 5031.7 samples/s | 78.6 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.06905 | Reg=0.00260 | L2-Norm=16.125 | L2-Norm(final)=2.265 | acc=0.9844 | 5079.9 samples/s | 79.4 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.06806 | Reg=0.00261 | L2-Norm=16.142 | L2-Norm(final)=2.266 | acc=0.9844 | 4940.2 samples/s | 77.2 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.06631 | Reg=0.00261 | L2-Norm=16.159 | L2-Norm(final)=2.268 | acc=0.9531 | 6178.1 samples/s | 96.5 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.06401 | Reg=0.00262 | L2-Norm=16.177 | L2-Norm(final)=2.270 | acc=1.0000 | 2050.8 samples/s | 32.0 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.06214 | Reg=0.00262 | L2-Norm=16.194 | L2-Norm(final)=2.272 | acc=1.0000 | 4974.2 samples/s | 77.7 steps/s
[Step=3050 Epoch= 5.9] | Loss=0.06038 | Reg=0.00263 | L2-Norm=16.212 | L2-Norm(final)=2.275 | acc=0.9688 | 5007.7 samples/s | 78.2 steps/s
[Step=3100 Epoch= 6.0] | Loss=0.05929 | Reg=0.00263 | L2-Norm=16.231 | L2-Norm(final)=2.277 | acc=0.9375 | 5035.4 samples/s | 78.7 steps/s
[Step=3150 Epoch= 6.1] | Loss=0.05835 | Reg=0.00264 | L2-Norm=16.248 | L2-Norm(final)=2.279 | acc=0.9844 | 4965.2 samples/s | 77.6 steps/s
[Step=3200 Epoch= 6.2] | Loss=0.05723 | Reg=0.00265 | L2-Norm=16.264 | L2-Norm(final)=2.281 | acc=1.0000 | 5047.7 samples/s | 78.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step3200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 4.7] | Loss=0.41738 | Reg=0.00250 | L2-Norm=15.799 | L2-Norm(final)=2.263 | acc=0.7031 | 4065.4 samples/s | 63.5 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.09732 | Reg=0.00252 | L2-Norm=15.889 | L2-Norm(final)=2.262 | acc=0.9531 | 4945.1 samples/s | 77.3 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.08226 | Reg=0.00254 | L2-Norm=15.941 | L2-Norm(final)=2.271 | acc=0.9844 | 4999.7 samples/s | 78.1 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.08089 | Reg=0.00255 | L2-Norm=15.977 | L2-Norm(final)=2.273 | acc=0.8906 | 4942.4 samples/s | 77.2 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.07822 | Reg=0.00256 | L2-Norm=16.007 | L2-Norm(final)=2.274 | acc=0.8750 | 4998.8 samples/s | 78.1 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.07597 | Reg=0.00257 | L2-Norm=16.033 | L2-Norm(final)=2.275 | acc=1.0000 | 5040.5 samples/s | 78.8 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.07238 | Reg=0.00258 | L2-Norm=16.058 | L2-Norm(final)=2.277 | acc=1.0000 | 4992.3 samples/s | 78.0 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.07008 | Reg=0.00259 | L2-Norm=16.081 | L2-Norm(final)=2.279 | acc=0.9688 | 5066.0 samples/s | 79.2 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.06848 | Reg=0.00259 | L2-Norm=16.105 | L2-Norm(final)=2.281 | acc=0.9688 | 4967.4 samples/s | 77.6 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.06695 | Reg=0.00260 | L2-Norm=16.125 | L2-Norm(final)=2.282 | acc=0.9844 | 5020.1 samples/s | 78.4 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.06572 | Reg=0.00261 | L2-Norm=16.146 | L2-Norm(final)=2.283 | acc=0.9844 | 5750.4 samples/s | 89.8 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.06349 | Reg=0.00261 | L2-Norm=16.166 | L2-Norm(final)=2.286 | acc=0.9844 | 2029.7 samples/s | 31.7 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.06096 | Reg=0.00262 | L2-Norm=16.187 | L2-Norm(final)=2.288 | acc=0.9688 | 4852.1 samples/s | 75.8 steps/s
[Step=3050 Epoch= 6.0] | Loss=0.05953 | Reg=0.00263 | L2-Norm=16.207 | L2-Norm(final)=2.291 | acc=1.0000 | 5055.7 samples/s | 79.0 steps/s
[Step=3100 Epoch= 6.1] | Loss=0.05850 | Reg=0.00263 | L2-Norm=16.226 | L2-Norm(final)=2.294 | acc=0.9219 | 4930.8 samples/s | 77.0 steps/s
[Step=3150 Epoch= 6.2] | Loss=0.05731 | Reg=0.00264 | L2-Norm=16.244 | L2-Norm(final)=2.296 | acc=1.0000 | 4892.8 samples/s | 76.5 steps/s
[Step=3200 Epoch= 6.3] | Loss=0.05704 | Reg=0.00264 | L2-Norm=16.261 | L2-Norm(final)=2.298 | acc=0.9844 | 5002.1 samples/s | 78.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step3200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 9.2] | Loss=0.10374 | Reg=0.00250 | L2-Norm=15.799 | L2-Norm(final)=2.264 | acc=0.9375 | 4032.6 samples/s | 63.0 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.01777 | Reg=0.00254 | L2-Norm=15.947 | L2-Norm(final)=2.256 | acc=1.0000 | 4449.8 samples/s | 69.5 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.01201 | Reg=0.00256 | L2-Norm=15.986 | L2-Norm(final)=2.263 | acc=0.9844 | 4658.0 samples/s | 72.8 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.01221 | Reg=0.00256 | L2-Norm=15.998 | L2-Norm(final)=2.261 | acc=1.0000 | 4696.8 samples/s | 73.4 steps/s
[Step=2600 Epoch=10.0] | Loss=0.01080 | Reg=0.00257 | L2-Norm=16.023 | L2-Norm(final)=2.256 | acc=1.0000 | 4757.6 samples/s | 74.3 steps/s
[Step=2650 Epoch=10.2] | Loss=0.00972 | Reg=0.00257 | L2-Norm=16.038 | L2-Norm(final)=2.252 | acc=1.0000 | 6052.4 samples/s | 94.6 steps/s
[Step=2700 Epoch=10.3] | Loss=0.00816 | Reg=0.00257 | L2-Norm=16.042 | L2-Norm(final)=2.252 | acc=1.0000 | 2035.7 samples/s | 31.8 steps/s
[Step=2750 Epoch=10.5] | Loss=0.00703 | Reg=0.00257 | L2-Norm=16.037 | L2-Norm(final)=2.252 | acc=1.0000 | 4678.2 samples/s | 73.1 steps/s
[Step=2800 Epoch=10.7] | Loss=0.00616 | Reg=0.00257 | L2-Norm=16.025 | L2-Norm(final)=2.253 | acc=1.0000 | 4743.3 samples/s | 74.1 steps/s
[Step=2850 Epoch=10.9] | Loss=0.00548 | Reg=0.00256 | L2-Norm=16.008 | L2-Norm(final)=2.254 | acc=1.0000 | 4802.8 samples/s | 75.0 steps/s
[Step=2900 Epoch=11.1] | Loss=0.00494 | Reg=0.00256 | L2-Norm=15.987 | L2-Norm(final)=2.256 | acc=1.0000 | 5096.2 samples/s | 79.6 steps/s
[Step=2950 Epoch=11.3] | Loss=0.00449 | Reg=0.00255 | L2-Norm=15.964 | L2-Norm(final)=2.257 | acc=1.0000 | 2115.3 samples/s | 33.1 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00412 | Reg=0.00254 | L2-Norm=15.939 | L2-Norm(final)=2.258 | acc=1.0000 | 4698.8 samples/s | 73.4 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00380 | Reg=0.00253 | L2-Norm=15.912 | L2-Norm(final)=2.259 | acc=1.0000 | 4737.8 samples/s | 74.0 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00353 | Reg=0.00252 | L2-Norm=15.884 | L2-Norm(final)=2.259 | acc=1.0000 | 4688.0 samples/s | 73.3 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00330 | Reg=0.00251 | L2-Norm=15.855 | L2-Norm(final)=2.260 | acc=1.0000 | 4766.8 samples/s | 74.5 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00309 | Reg=0.00250 | L2-Norm=15.825 | L2-Norm(final)=2.261 | acc=1.0000 | 2204.4 samples/s | 34.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step3200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 9.2] | Loss=0.06156 | Reg=0.00250 | L2-Norm=15.799 | L2-Norm(final)=2.266 | acc=0.9531 | 4122.3 samples/s | 64.4 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.01724 | Reg=0.00254 | L2-Norm=15.951 | L2-Norm(final)=2.281 | acc=1.0000 | 4541.3 samples/s | 71.0 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.01347 | Reg=0.00256 | L2-Norm=16.013 | L2-Norm(final)=2.280 | acc=1.0000 | 4768.4 samples/s | 74.5 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.01033 | Reg=0.00257 | L2-Norm=16.042 | L2-Norm(final)=2.277 | acc=1.0000 | 4726.4 samples/s | 73.8 steps/s
[Step=2600 Epoch=10.0] | Loss=0.00943 | Reg=0.00258 | L2-Norm=16.057 | L2-Norm(final)=2.278 | acc=1.0000 | 4732.4 samples/s | 73.9 steps/s
[Step=2650 Epoch=10.2] | Loss=0.00806 | Reg=0.00258 | L2-Norm=16.063 | L2-Norm(final)=2.280 | acc=1.0000 | 5984.2 samples/s | 93.5 steps/s
[Step=2700 Epoch=10.4] | Loss=0.00692 | Reg=0.00258 | L2-Norm=16.063 | L2-Norm(final)=2.283 | acc=1.0000 | 2015.6 samples/s | 31.5 steps/s
[Step=2750 Epoch=10.6] | Loss=0.00602 | Reg=0.00258 | L2-Norm=16.055 | L2-Norm(final)=2.286 | acc=1.0000 | 4700.6 samples/s | 73.4 steps/s
[Step=2800 Epoch=10.8] | Loss=0.00530 | Reg=0.00257 | L2-Norm=16.041 | L2-Norm(final)=2.289 | acc=1.0000 | 4719.2 samples/s | 73.7 steps/s
[Step=2850 Epoch=11.0] | Loss=0.00472 | Reg=0.00257 | L2-Norm=16.023 | L2-Norm(final)=2.292 | acc=1.0000 | 4790.8 samples/s | 74.9 steps/s
[Step=2900 Epoch=11.2] | Loss=0.00426 | Reg=0.00256 | L2-Norm=16.001 | L2-Norm(final)=2.295 | acc=1.0000 | 5357.1 samples/s | 83.7 steps/s
[Step=2950 Epoch=11.4] | Loss=0.00388 | Reg=0.00255 | L2-Norm=15.977 | L2-Norm(final)=2.297 | acc=1.0000 | 2088.9 samples/s | 32.6 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00355 | Reg=0.00254 | L2-Norm=15.951 | L2-Norm(final)=2.299 | acc=1.0000 | 4790.5 samples/s | 74.9 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00328 | Reg=0.00254 | L2-Norm=15.923 | L2-Norm(final)=2.301 | acc=1.0000 | 4676.4 samples/s | 73.1 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00305 | Reg=0.00253 | L2-Norm=15.894 | L2-Norm(final)=2.303 | acc=1.0000 | 4730.9 samples/s | 73.9 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00285 | Reg=0.00252 | L2-Norm=15.863 | L2-Norm(final)=2.305 | acc=1.0000 | 4812.8 samples/s | 75.2 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00267 | Reg=0.00251 | L2-Norm=15.832 | L2-Norm(final)=2.306 | acc=1.0000 | 2201.5 samples/s | 34.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34740 | acc=0.7174 | tpr=0.6191 | fpr=0.0691 | 4560.2 samples/s | 17.8 steps/s
Avg test loss: 0.34696, Avg test acc: 0.72117, Avg tpr: 0.62540, Avg fpr: 0.06820, total FA: 532

Testing server on iccad2012
[Step=  50] | Loss=0.23523 | acc=0.8498 | tpr=0.9646 | fpr=0.1522 | 4592.5 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.23393 | acc=0.8522 | tpr=0.9808 | fpr=0.1502 | 8891.2 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.23740 | acc=0.8509 | tpr=0.9870 | fpr=0.1516 | 8733.2 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.23788 | acc=0.8518 | tpr=0.9880 | fpr=0.1507 | 9121.7 samples/s | 35.6 steps/s
[Step= 250] | Loss=0.23735 | acc=0.8509 | tpr=0.9904 | fpr=0.1516 | 8987.1 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.23854 | acc=0.8506 | tpr=0.9905 | fpr=0.1520 | 8553.4 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.24017 | acc=0.8500 | tpr=0.9881 | fpr=0.1525 | 9173.0 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.24055 | acc=0.8505 | tpr=0.9858 | fpr=0.1520 | 8567.8 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.24296 | acc=0.8491 | tpr=0.9844 | fpr=0.1533 | 8711.8 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.24341 | acc=0.8488 | tpr=0.9855 | fpr=0.1537 | 8890.0 samples/s | 34.7 steps/s
[Step= 550] | Loss=0.24265 | acc=0.8491 | tpr=0.9837 | fpr=0.1533 | 16618.3 samples/s | 64.9 steps/s
Avg test loss: 0.24249, Avg test acc: 0.84916, Avg tpr: 0.98376, Avg fpr: 0.15329, total FA: 21284

server round 4/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 6.2] | Loss=0.31656 | Reg=0.00239 | L2-Norm=15.472 | L2-Norm(final)=2.297 | acc=0.7500 | 4031.5 samples/s | 63.0 steps/s
[Step=3250 Epoch= 6.3] | Loss=0.08729 | Reg=0.00243 | L2-Norm=15.592 | L2-Norm(final)=2.297 | acc=0.9531 | 4630.3 samples/s | 72.3 steps/s
[Step=3300 Epoch= 6.4] | Loss=0.07413 | Reg=0.00245 | L2-Norm=15.648 | L2-Norm(final)=2.305 | acc=0.9688 | 4954.2 samples/s | 77.4 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.06916 | Reg=0.00246 | L2-Norm=15.678 | L2-Norm(final)=2.307 | acc=0.9219 | 5001.9 samples/s | 78.2 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.06524 | Reg=0.00247 | L2-Norm=15.704 | L2-Norm(final)=2.310 | acc=0.9219 | 4982.3 samples/s | 77.8 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.06451 | Reg=0.00247 | L2-Norm=15.727 | L2-Norm(final)=2.311 | acc=0.9219 | 5045.2 samples/s | 78.8 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.06249 | Reg=0.00248 | L2-Norm=15.749 | L2-Norm(final)=2.312 | acc=0.9688 | 4983.9 samples/s | 77.9 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.06143 | Reg=0.00249 | L2-Norm=15.772 | L2-Norm(final)=2.313 | acc=0.9844 | 4894.2 samples/s | 76.5 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.05995 | Reg=0.00249 | L2-Norm=15.794 | L2-Norm(final)=2.314 | acc=0.9844 | 4789.8 samples/s | 74.8 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.05857 | Reg=0.00250 | L2-Norm=15.817 | L2-Norm(final)=2.315 | acc=0.9531 | 4383.1 samples/s | 68.5 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.05782 | Reg=0.00251 | L2-Norm=15.838 | L2-Norm(final)=2.316 | acc=0.9844 | 5513.2 samples/s | 86.1 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.05667 | Reg=0.00251 | L2-Norm=15.857 | L2-Norm(final)=2.316 | acc=0.9375 | 1968.3 samples/s | 30.8 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.05477 | Reg=0.00252 | L2-Norm=15.878 | L2-Norm(final)=2.317 | acc=1.0000 | 5014.3 samples/s | 78.3 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.05331 | Reg=0.00253 | L2-Norm=15.898 | L2-Norm(final)=2.319 | acc=0.9844 | 4912.5 samples/s | 76.8 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.05225 | Reg=0.00253 | L2-Norm=15.918 | L2-Norm(final)=2.321 | acc=0.9844 | 5056.8 samples/s | 79.0 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.05130 | Reg=0.00254 | L2-Norm=15.937 | L2-Norm(final)=2.322 | acc=1.0000 | 4963.9 samples/s | 77.6 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.05087 | Reg=0.00255 | L2-Norm=15.957 | L2-Norm(final)=2.323 | acc=0.9844 | 5036.2 samples/s | 78.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 6.3] | Loss=0.24208 | Reg=0.00239 | L2-Norm=15.472 | L2-Norm(final)=2.297 | acc=0.7812 | 4373.7 samples/s | 68.3 steps/s
[Step=3250 Epoch= 6.4] | Loss=0.08625 | Reg=0.00243 | L2-Norm=15.594 | L2-Norm(final)=2.295 | acc=0.9219 | 4643.1 samples/s | 72.5 steps/s
[Step=3300 Epoch= 6.5] | Loss=0.07099 | Reg=0.00245 | L2-Norm=15.651 | L2-Norm(final)=2.308 | acc=0.9531 | 5028.4 samples/s | 78.6 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.06740 | Reg=0.00246 | L2-Norm=15.689 | L2-Norm(final)=2.312 | acc=0.9375 | 4997.2 samples/s | 78.1 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.06399 | Reg=0.00247 | L2-Norm=15.722 | L2-Norm(final)=2.316 | acc=0.9531 | 4968.6 samples/s | 77.6 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.06274 | Reg=0.00248 | L2-Norm=15.751 | L2-Norm(final)=2.321 | acc=0.9688 | 5072.8 samples/s | 79.3 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.06097 | Reg=0.00249 | L2-Norm=15.778 | L2-Norm(final)=2.324 | acc=0.9844 | 5027.6 samples/s | 78.6 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.05933 | Reg=0.00250 | L2-Norm=15.801 | L2-Norm(final)=2.326 | acc=0.9688 | 5051.8 samples/s | 78.9 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.05865 | Reg=0.00250 | L2-Norm=15.821 | L2-Norm(final)=2.326 | acc=0.9531 | 4997.7 samples/s | 78.1 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.05775 | Reg=0.00251 | L2-Norm=15.840 | L2-Norm(final)=2.326 | acc=0.9531 | 5052.2 samples/s | 78.9 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.05682 | Reg=0.00251 | L2-Norm=15.858 | L2-Norm(final)=2.327 | acc=0.9531 | 6144.3 samples/s | 96.0 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.05545 | Reg=0.00252 | L2-Norm=15.877 | L2-Norm(final)=2.327 | acc=0.9844 | 2090.2 samples/s | 32.7 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.05356 | Reg=0.00253 | L2-Norm=15.898 | L2-Norm(final)=2.330 | acc=0.9844 | 4937.6 samples/s | 77.2 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.05262 | Reg=0.00253 | L2-Norm=15.920 | L2-Norm(final)=2.332 | acc=1.0000 | 5070.2 samples/s | 79.2 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.05153 | Reg=0.00254 | L2-Norm=15.941 | L2-Norm(final)=2.335 | acc=0.9688 | 4928.7 samples/s | 77.0 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.05050 | Reg=0.00255 | L2-Norm=15.961 | L2-Norm(final)=2.337 | acc=0.9844 | 4949.0 samples/s | 77.3 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.05015 | Reg=0.00255 | L2-Norm=15.981 | L2-Norm(final)=2.339 | acc=0.9844 | 5045.7 samples/s | 78.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step4000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch=12.3] | Loss=0.07344 | Reg=0.00239 | L2-Norm=15.472 | L2-Norm(final)=2.299 | acc=0.9375 | 4027.7 samples/s | 62.9 steps/s
[Step=3250 Epoch=12.5] | Loss=0.01176 | Reg=0.00243 | L2-Norm=15.583 | L2-Norm(final)=2.300 | acc=1.0000 | 4617.8 samples/s | 72.2 steps/s
[Step=3300 Epoch=12.6] | Loss=0.01181 | Reg=0.00244 | L2-Norm=15.632 | L2-Norm(final)=2.295 | acc=1.0000 | 4793.9 samples/s | 74.9 steps/s
[Step=3350 Epoch=12.8] | Loss=0.00923 | Reg=0.00245 | L2-Norm=15.663 | L2-Norm(final)=2.292 | acc=1.0000 | 4731.3 samples/s | 73.9 steps/s
[Step=3400 Epoch=13.0] | Loss=0.00780 | Reg=0.00246 | L2-Norm=15.676 | L2-Norm(final)=2.292 | acc=1.0000 | 4783.9 samples/s | 74.7 steps/s
[Step=3450 Epoch=13.2] | Loss=0.00653 | Reg=0.00246 | L2-Norm=15.675 | L2-Norm(final)=2.293 | acc=1.0000 | 5960.6 samples/s | 93.1 steps/s
[Step=3500 Epoch=13.4] | Loss=0.00597 | Reg=0.00245 | L2-Norm=15.668 | L2-Norm(final)=2.293 | acc=1.0000 | 2031.6 samples/s | 31.7 steps/s
[Step=3550 Epoch=13.6] | Loss=0.00577 | Reg=0.00245 | L2-Norm=15.664 | L2-Norm(final)=2.294 | acc=0.9844 | 4621.5 samples/s | 72.2 steps/s
[Step=3600 Epoch=13.8] | Loss=0.00551 | Reg=0.00245 | L2-Norm=15.664 | L2-Norm(final)=2.292 | acc=1.0000 | 4872.1 samples/s | 76.1 steps/s
[Step=3650 Epoch=14.0] | Loss=0.00497 | Reg=0.00245 | L2-Norm=15.662 | L2-Norm(final)=2.291 | acc=1.0000 | 4688.6 samples/s | 73.3 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00455 | Reg=0.00245 | L2-Norm=15.657 | L2-Norm(final)=2.292 | acc=1.0000 | 5297.2 samples/s | 82.8 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00415 | Reg=0.00245 | L2-Norm=15.649 | L2-Norm(final)=2.294 | acc=1.0000 | 2108.1 samples/s | 32.9 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00381 | Reg=0.00244 | L2-Norm=15.636 | L2-Norm(final)=2.295 | acc=1.0000 | 4749.9 samples/s | 74.2 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00351 | Reg=0.00244 | L2-Norm=15.620 | L2-Norm(final)=2.296 | acc=1.0000 | 4788.7 samples/s | 74.8 steps/s
[Step=3900 Epoch=14.9] | Loss=0.00326 | Reg=0.00243 | L2-Norm=15.601 | L2-Norm(final)=2.297 | acc=1.0000 | 4737.1 samples/s | 74.0 steps/s
[Step=3950 Epoch=15.1] | Loss=0.00305 | Reg=0.00243 | L2-Norm=15.581 | L2-Norm(final)=2.299 | acc=1.0000 | 4736.4 samples/s | 74.0 steps/s
[Step=4000 Epoch=15.3] | Loss=0.00286 | Reg=0.00242 | L2-Norm=15.559 | L2-Norm(final)=2.300 | acc=1.0000 | 2185.7 samples/s | 34.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch=12.3] | Loss=0.06781 | Reg=0.00239 | L2-Norm=15.472 | L2-Norm(final)=2.299 | acc=0.9688 | 4371.8 samples/s | 68.3 steps/s
[Step=3250 Epoch=12.5] | Loss=0.01058 | Reg=0.00244 | L2-Norm=15.613 | L2-Norm(final)=2.324 | acc=0.9844 | 4412.2 samples/s | 68.9 steps/s
[Step=3300 Epoch=12.7] | Loss=0.02173 | Reg=0.00248 | L2-Norm=15.736 | L2-Norm(final)=2.301 | acc=1.0000 | 4752.7 samples/s | 74.3 steps/s
[Step=3350 Epoch=12.9] | Loss=0.01779 | Reg=0.00252 | L2-Norm=15.873 | L2-Norm(final)=2.282 | acc=1.0000 | 4767.6 samples/s | 74.5 steps/s
[Step=3400 Epoch=13.1] | Loss=0.01446 | Reg=0.00254 | L2-Norm=15.947 | L2-Norm(final)=2.275 | acc=1.0000 | 4694.7 samples/s | 73.4 steps/s
[Step=3450 Epoch=13.3] | Loss=0.01174 | Reg=0.00255 | L2-Norm=15.982 | L2-Norm(final)=2.273 | acc=1.0000 | 6036.9 samples/s | 94.3 steps/s
[Step=3500 Epoch=13.5] | Loss=0.00984 | Reg=0.00256 | L2-Norm=15.997 | L2-Norm(final)=2.273 | acc=1.0000 | 2018.4 samples/s | 31.5 steps/s
[Step=3550 Epoch=13.7] | Loss=0.00845 | Reg=0.00256 | L2-Norm=15.997 | L2-Norm(final)=2.274 | acc=1.0000 | 4762.6 samples/s | 74.4 steps/s
[Step=3600 Epoch=13.9] | Loss=0.00741 | Reg=0.00256 | L2-Norm=15.989 | L2-Norm(final)=2.276 | acc=1.0000 | 4761.9 samples/s | 74.4 steps/s
[Step=3650 Epoch=14.1] | Loss=0.00659 | Reg=0.00255 | L2-Norm=15.975 | L2-Norm(final)=2.277 | acc=1.0000 | 4714.0 samples/s | 73.7 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00593 | Reg=0.00255 | L2-Norm=15.957 | L2-Norm(final)=2.278 | acc=1.0000 | 5368.7 samples/s | 83.9 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00540 | Reg=0.00254 | L2-Norm=15.936 | L2-Norm(final)=2.280 | acc=1.0000 | 2103.0 samples/s | 32.9 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00495 | Reg=0.00253 | L2-Norm=15.912 | L2-Norm(final)=2.281 | acc=1.0000 | 4677.9 samples/s | 73.1 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00457 | Reg=0.00252 | L2-Norm=15.887 | L2-Norm(final)=2.282 | acc=1.0000 | 4782.7 samples/s | 74.7 steps/s
[Step=3900 Epoch=15.0] | Loss=0.00424 | Reg=0.00252 | L2-Norm=15.860 | L2-Norm(final)=2.284 | acc=1.0000 | 4737.9 samples/s | 74.0 steps/s
[Step=3950 Epoch=15.2] | Loss=0.00396 | Reg=0.00251 | L2-Norm=15.833 | L2-Norm(final)=2.285 | acc=1.0000 | 4902.3 samples/s | 76.6 steps/s
[Step=4000 Epoch=15.4] | Loss=0.00372 | Reg=0.00250 | L2-Norm=15.804 | L2-Norm(final)=2.286 | acc=1.0000 | 2189.5 samples/s | 34.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39191 | acc=0.6921 | tpr=0.5704 | fpr=0.0436 | 4638.3 samples/s | 18.1 steps/s
Avg test loss: 0.39323, Avg test acc: 0.69537, Avg tpr: 0.57749, Avg fpr: 0.04538, total FA: 354

Testing server on iccad2012
[Step=  50] | Loss=0.18114 | acc=0.8862 | tpr=0.9558 | fpr=0.1150 | 4715.4 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.18086 | acc=0.8887 | tpr=0.9744 | fpr=0.1129 | 8465.2 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.18398 | acc=0.8882 | tpr=0.9813 | fpr=0.1136 | 8642.5 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.18507 | acc=0.8891 | tpr=0.9825 | fpr=0.1126 | 8837.1 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.18446 | acc=0.8893 | tpr=0.9817 | fpr=0.1124 | 9636.9 samples/s | 37.6 steps/s
[Step= 300] | Loss=0.18569 | acc=0.8890 | tpr=0.9825 | fpr=0.1127 | 8352.4 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.18641 | acc=0.8889 | tpr=0.9825 | fpr=0.1128 | 8812.5 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.18681 | acc=0.8888 | tpr=0.9809 | fpr=0.1129 | 8951.2 samples/s | 35.0 steps/s
[Step= 450] | Loss=0.18888 | acc=0.8883 | tpr=0.9791 | fpr=0.1133 | 8556.6 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.18932 | acc=0.8878 | tpr=0.9793 | fpr=0.1138 | 8875.3 samples/s | 34.7 steps/s
[Step= 550] | Loss=0.18876 | acc=0.8881 | tpr=0.9785 | fpr=0.1135 | 16173.8 samples/s | 63.2 steps/s
Avg test loss: 0.18862, Avg test acc: 0.88815, Avg tpr: 0.97821, Avg fpr: 0.11348, total FA: 15757

server round 5/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.27600 | Reg=0.00233 | L2-Norm=15.280 | L2-Norm(final)=2.319 | acc=0.7969 | 4363.8 samples/s | 68.2 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.08730 | Reg=0.00237 | L2-Norm=15.382 | L2-Norm(final)=2.302 | acc=0.9531 | 4464.5 samples/s | 69.8 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.07115 | Reg=0.00238 | L2-Norm=15.440 | L2-Norm(final)=2.310 | acc=0.9531 | 4978.3 samples/s | 77.8 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.06343 | Reg=0.00240 | L2-Norm=15.480 | L2-Norm(final)=2.318 | acc=0.9375 | 4990.4 samples/s | 78.0 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.05965 | Reg=0.00241 | L2-Norm=15.510 | L2-Norm(final)=2.321 | acc=0.9375 | 5045.9 samples/s | 78.8 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.05904 | Reg=0.00241 | L2-Norm=15.536 | L2-Norm(final)=2.323 | acc=0.9844 | 4961.0 samples/s | 77.5 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.05795 | Reg=0.00242 | L2-Norm=15.562 | L2-Norm(final)=2.325 | acc=0.9531 | 5031.5 samples/s | 78.6 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.05651 | Reg=0.00243 | L2-Norm=15.585 | L2-Norm(final)=2.326 | acc=0.9688 | 4952.9 samples/s | 77.4 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.05494 | Reg=0.00244 | L2-Norm=15.608 | L2-Norm(final)=2.329 | acc=0.9531 | 5000.0 samples/s | 78.1 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.05409 | Reg=0.00244 | L2-Norm=15.631 | L2-Norm(final)=2.331 | acc=0.9375 | 4963.3 samples/s | 77.6 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.05348 | Reg=0.00245 | L2-Norm=15.653 | L2-Norm(final)=2.332 | acc=0.9844 | 6113.9 samples/s | 95.5 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.05210 | Reg=0.00246 | L2-Norm=15.674 | L2-Norm(final)=2.333 | acc=1.0000 | 2060.7 samples/s | 32.2 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.05086 | Reg=0.00246 | L2-Norm=15.695 | L2-Norm(final)=2.334 | acc=0.9844 | 4955.5 samples/s | 77.4 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.04994 | Reg=0.00247 | L2-Norm=15.715 | L2-Norm(final)=2.335 | acc=0.9844 | 4986.1 samples/s | 77.9 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.04921 | Reg=0.00248 | L2-Norm=15.736 | L2-Norm(final)=2.336 | acc=0.9688 | 4912.5 samples/s | 76.8 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.04844 | Reg=0.00248 | L2-Norm=15.756 | L2-Norm(final)=2.336 | acc=0.9844 | 5069.4 samples/s | 79.2 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.04804 | Reg=0.00249 | L2-Norm=15.775 | L2-Norm(final)=2.336 | acc=0.9844 | 4959.7 samples/s | 77.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.28004 | Reg=0.00233 | L2-Norm=15.280 | L2-Norm(final)=2.320 | acc=0.7656 | 4318.9 samples/s | 67.5 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.08566 | Reg=0.00237 | L2-Norm=15.405 | L2-Norm(final)=2.312 | acc=0.9688 | 4732.9 samples/s | 74.0 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.07158 | Reg=0.00239 | L2-Norm=15.457 | L2-Norm(final)=2.319 | acc=0.9844 | 4954.8 samples/s | 77.4 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.06465 | Reg=0.00240 | L2-Norm=15.486 | L2-Norm(final)=2.321 | acc=0.9531 | 4994.2 samples/s | 78.0 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.06215 | Reg=0.00241 | L2-Norm=15.509 | L2-Norm(final)=2.321 | acc=0.9844 | 5088.6 samples/s | 79.5 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.05988 | Reg=0.00241 | L2-Norm=15.530 | L2-Norm(final)=2.321 | acc=0.9375 | 4958.5 samples/s | 77.5 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.05639 | Reg=0.00242 | L2-Norm=15.553 | L2-Norm(final)=2.323 | acc=0.9844 | 5012.0 samples/s | 78.3 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.05530 | Reg=0.00243 | L2-Norm=15.576 | L2-Norm(final)=2.324 | acc=0.9531 | 5007.7 samples/s | 78.2 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.05439 | Reg=0.00243 | L2-Norm=15.598 | L2-Norm(final)=2.325 | acc=0.9531 | 4968.2 samples/s | 77.6 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.05293 | Reg=0.00244 | L2-Norm=15.620 | L2-Norm(final)=2.327 | acc=0.9844 | 5078.1 samples/s | 79.3 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.05191 | Reg=0.00245 | L2-Norm=15.640 | L2-Norm(final)=2.329 | acc=1.0000 | 6125.2 samples/s | 95.7 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.05049 | Reg=0.00245 | L2-Norm=15.661 | L2-Norm(final)=2.331 | acc=0.9844 | 2097.2 samples/s | 32.8 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.04913 | Reg=0.00246 | L2-Norm=15.682 | L2-Norm(final)=2.334 | acc=0.9375 | 4944.9 samples/s | 77.3 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.04753 | Reg=0.00247 | L2-Norm=15.702 | L2-Norm(final)=2.338 | acc=0.9688 | 4970.0 samples/s | 77.7 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.04661 | Reg=0.00247 | L2-Norm=15.721 | L2-Norm(final)=2.341 | acc=1.0000 | 4957.2 samples/s | 77.5 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.04593 | Reg=0.00248 | L2-Norm=15.740 | L2-Norm(final)=2.344 | acc=0.9688 | 4982.2 samples/s | 77.8 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.04568 | Reg=0.00248 | L2-Norm=15.758 | L2-Norm(final)=2.346 | acc=0.9688 | 5033.8 samples/s | 78.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step4800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch=15.3] | Loss=0.03374 | Reg=0.00233 | L2-Norm=15.280 | L2-Norm(final)=2.321 | acc=0.9844 | 4209.5 samples/s | 65.8 steps/s
[Step=4050 Epoch=15.5] | Loss=0.01429 | Reg=0.00236 | L2-Norm=15.373 | L2-Norm(final)=2.336 | acc=0.9688 | 4311.8 samples/s | 67.4 steps/s
[Step=4100 Epoch=15.7] | Loss=0.01129 | Reg=0.00240 | L2-Norm=15.506 | L2-Norm(final)=2.318 | acc=1.0000 | 4748.5 samples/s | 74.2 steps/s
[Step=4150 Epoch=15.9] | Loss=0.00897 | Reg=0.00242 | L2-Norm=15.570 | L2-Norm(final)=2.314 | acc=1.0000 | 4806.3 samples/s | 75.1 steps/s
[Step=4200 Epoch=16.1] | Loss=0.00734 | Reg=0.00243 | L2-Norm=15.593 | L2-Norm(final)=2.312 | acc=1.0000 | 4717.4 samples/s | 73.7 steps/s
[Step=4250 Epoch=16.3] | Loss=0.00591 | Reg=0.00243 | L2-Norm=15.597 | L2-Norm(final)=2.314 | acc=1.0000 | 6012.4 samples/s | 93.9 steps/s
[Step=4300 Epoch=16.5] | Loss=0.00496 | Reg=0.00243 | L2-Norm=15.590 | L2-Norm(final)=2.317 | acc=1.0000 | 2014.6 samples/s | 31.5 steps/s
[Step=4350 Epoch=16.7] | Loss=0.00426 | Reg=0.00243 | L2-Norm=15.575 | L2-Norm(final)=2.320 | acc=1.0000 | 4755.0 samples/s | 74.3 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00373 | Reg=0.00242 | L2-Norm=15.555 | L2-Norm(final)=2.323 | acc=1.0000 | 4758.1 samples/s | 74.3 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00332 | Reg=0.00241 | L2-Norm=15.532 | L2-Norm(final)=2.326 | acc=1.0000 | 4761.4 samples/s | 74.4 steps/s
[Step=4500 Epoch=17.2] | Loss=0.00299 | Reg=0.00240 | L2-Norm=15.506 | L2-Norm(final)=2.328 | acc=1.0000 | 5149.2 samples/s | 80.5 steps/s
[Step=4550 Epoch=17.4] | Loss=0.00272 | Reg=0.00240 | L2-Norm=15.479 | L2-Norm(final)=2.330 | acc=1.0000 | 2067.3 samples/s | 32.3 steps/s
[Step=4600 Epoch=17.6] | Loss=0.00249 | Reg=0.00239 | L2-Norm=15.450 | L2-Norm(final)=2.332 | acc=1.0000 | 4600.9 samples/s | 71.9 steps/s
[Step=4650 Epoch=17.8] | Loss=0.00230 | Reg=0.00238 | L2-Norm=15.420 | L2-Norm(final)=2.333 | acc=1.0000 | 4583.7 samples/s | 71.6 steps/s
[Step=4700 Epoch=18.0] | Loss=0.00214 | Reg=0.00237 | L2-Norm=15.390 | L2-Norm(final)=2.335 | acc=1.0000 | 4667.9 samples/s | 72.9 steps/s
[Step=4750 Epoch=18.2] | Loss=0.00200 | Reg=0.00236 | L2-Norm=15.359 | L2-Norm(final)=2.336 | acc=1.0000 | 4740.4 samples/s | 74.1 steps/s
[Step=4800 Epoch=18.4] | Loss=0.00187 | Reg=0.00235 | L2-Norm=15.328 | L2-Norm(final)=2.337 | acc=1.0000 | 2194.4 samples/s | 34.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch=15.4] | Loss=0.04767 | Reg=0.00233 | L2-Norm=15.280 | L2-Norm(final)=2.320 | acc=0.9688 | 4340.3 samples/s | 67.8 steps/s
[Step=4050 Epoch=15.6] | Loss=0.01120 | Reg=0.00237 | L2-Norm=15.395 | L2-Norm(final)=2.328 | acc=1.0000 | 4466.1 samples/s | 69.8 steps/s
[Step=4100 Epoch=15.8] | Loss=0.01025 | Reg=0.00239 | L2-Norm=15.463 | L2-Norm(final)=2.325 | acc=1.0000 | 4712.0 samples/s | 73.6 steps/s
[Step=4150 Epoch=16.0] | Loss=0.00859 | Reg=0.00240 | L2-Norm=15.504 | L2-Norm(final)=2.315 | acc=1.0000 | 4771.5 samples/s | 74.6 steps/s
[Step=4200 Epoch=16.2] | Loss=0.00760 | Reg=0.00241 | L2-Norm=15.524 | L2-Norm(final)=2.309 | acc=1.0000 | 4871.0 samples/s | 76.1 steps/s
[Step=4250 Epoch=16.4] | Loss=0.00634 | Reg=0.00241 | L2-Norm=15.532 | L2-Norm(final)=2.307 | acc=1.0000 | 5920.7 samples/s | 92.5 steps/s
[Step=4300 Epoch=16.6] | Loss=0.00531 | Reg=0.00241 | L2-Norm=15.529 | L2-Norm(final)=2.309 | acc=1.0000 | 2012.0 samples/s | 31.4 steps/s
[Step=4350 Epoch=16.7] | Loss=0.00456 | Reg=0.00241 | L2-Norm=15.518 | L2-Norm(final)=2.310 | acc=1.0000 | 4736.2 samples/s | 74.0 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00400 | Reg=0.00240 | L2-Norm=15.501 | L2-Norm(final)=2.312 | acc=1.0000 | 4672.1 samples/s | 73.0 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00356 | Reg=0.00240 | L2-Norm=15.481 | L2-Norm(final)=2.314 | acc=1.0000 | 4760.2 samples/s | 74.4 steps/s
[Step=4500 Epoch=17.3] | Loss=0.00321 | Reg=0.00239 | L2-Norm=15.458 | L2-Norm(final)=2.316 | acc=1.0000 | 5296.9 samples/s | 82.8 steps/s
[Step=4550 Epoch=17.5] | Loss=0.00292 | Reg=0.00238 | L2-Norm=15.432 | L2-Norm(final)=2.318 | acc=1.0000 | 2097.6 samples/s | 32.8 steps/s
[Step=4600 Epoch=17.7] | Loss=0.00268 | Reg=0.00237 | L2-Norm=15.406 | L2-Norm(final)=2.319 | acc=1.0000 | 4739.5 samples/s | 74.1 steps/s
[Step=4650 Epoch=17.9] | Loss=0.00247 | Reg=0.00237 | L2-Norm=15.378 | L2-Norm(final)=2.320 | acc=1.0000 | 4767.6 samples/s | 74.5 steps/s
[Step=4700 Epoch=18.1] | Loss=0.00230 | Reg=0.00236 | L2-Norm=15.349 | L2-Norm(final)=2.322 | acc=1.0000 | 4862.6 samples/s | 76.0 steps/s
[Step=4750 Epoch=18.3] | Loss=0.00214 | Reg=0.00235 | L2-Norm=15.320 | L2-Norm(final)=2.323 | acc=1.0000 | 4768.9 samples/s | 74.5 steps/s
[Step=4800 Epoch=18.5] | Loss=0.00201 | Reg=0.00234 | L2-Norm=15.290 | L2-Norm(final)=2.324 | acc=1.0000 | 2186.3 samples/s | 34.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27660 | acc=0.7801 | tpr=0.7032 | fpr=0.0530 | 4573.5 samples/s | 17.9 steps/s
Avg test loss: 0.27888, Avg test acc: 0.78063, Avg tpr: 0.70630, Avg fpr: 0.05589, total FA: 436

Testing server on iccad2012
[Step=  50] | Loss=0.27887 | acc=0.8412 | tpr=0.9912 | fpr=0.1615 | 4613.5 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.27870 | acc=0.8432 | tpr=0.9936 | fpr=0.1596 | 8743.4 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.28389 | acc=0.8404 | tpr=0.9928 | fpr=0.1624 | 9073.2 samples/s | 35.4 steps/s
[Step= 200] | Loss=0.28363 | acc=0.8409 | tpr=0.9923 | fpr=0.1619 | 8697.5 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.28351 | acc=0.8412 | tpr=0.9921 | fpr=0.1616 | 8877.9 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.28556 | acc=0.8403 | tpr=0.9913 | fpr=0.1624 | 8773.2 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.28580 | acc=0.8403 | tpr=0.9912 | fpr=0.1625 | 8847.2 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.28625 | acc=0.8402 | tpr=0.9891 | fpr=0.1625 | 8843.5 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.28890 | acc=0.8398 | tpr=0.9888 | fpr=0.1629 | 8879.1 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.28986 | acc=0.8395 | tpr=0.9890 | fpr=0.1632 | 9036.1 samples/s | 35.3 steps/s
[Step= 550] | Loss=0.28937 | acc=0.8394 | tpr=0.9873 | fpr=0.1633 | 14912.3 samples/s | 58.3 steps/s
Avg test loss: 0.28906, Avg test acc: 0.83947, Avg tpr: 0.98732, Avg fpr: 0.16321, total FA: 22662

server round 6/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 9.4] | Loss=0.21102 | Reg=0.00226 | L2-Norm=15.020 | L2-Norm(final)=2.342 | acc=0.8750 | 4144.9 samples/s | 64.8 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.07426 | Reg=0.00228 | L2-Norm=15.106 | L2-Norm(final)=2.338 | acc=0.9688 | 4720.2 samples/s | 73.8 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.06104 | Reg=0.00230 | L2-Norm=15.155 | L2-Norm(final)=2.342 | acc=0.9844 | 4968.6 samples/s | 77.6 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.05689 | Reg=0.00231 | L2-Norm=15.189 | L2-Norm(final)=2.343 | acc=0.9531 | 4939.0 samples/s | 77.2 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.05357 | Reg=0.00232 | L2-Norm=15.218 | L2-Norm(final)=2.343 | acc=0.9844 | 4857.1 samples/s | 75.9 steps/s
[Step=5050 Epoch= 9.8] | Loss=0.05086 | Reg=0.00232 | L2-Norm=15.243 | L2-Norm(final)=2.344 | acc=0.9688 | 5016.8 samples/s | 78.4 steps/s
[Step=5100 Epoch= 9.9] | Loss=0.05006 | Reg=0.00233 | L2-Norm=15.268 | L2-Norm(final)=2.345 | acc=1.0000 | 5042.9 samples/s | 78.8 steps/s
[Step=5150 Epoch=10.0] | Loss=0.04871 | Reg=0.00234 | L2-Norm=15.292 | L2-Norm(final)=2.346 | acc=1.0000 | 4993.0 samples/s | 78.0 steps/s
[Step=5200 Epoch=10.1] | Loss=0.04836 | Reg=0.00235 | L2-Norm=15.316 | L2-Norm(final)=2.345 | acc=0.9688 | 4946.2 samples/s | 77.3 steps/s
[Step=5250 Epoch=10.2] | Loss=0.04716 | Reg=0.00235 | L2-Norm=15.338 | L2-Norm(final)=2.344 | acc=0.9844 | 4971.9 samples/s | 77.7 steps/s
[Step=5300 Epoch=10.3] | Loss=0.04672 | Reg=0.00236 | L2-Norm=15.360 | L2-Norm(final)=2.344 | acc=0.9531 | 6049.0 samples/s | 94.5 steps/s
[Step=5350 Epoch=10.4] | Loss=0.04564 | Reg=0.00237 | L2-Norm=15.383 | L2-Norm(final)=2.344 | acc=0.9844 | 2029.0 samples/s | 31.7 steps/s
[Step=5400 Epoch=10.5] | Loss=0.04455 | Reg=0.00237 | L2-Norm=15.406 | L2-Norm(final)=2.346 | acc=0.9375 | 4978.9 samples/s | 77.8 steps/s
[Step=5450 Epoch=10.6] | Loss=0.04382 | Reg=0.00238 | L2-Norm=15.429 | L2-Norm(final)=2.345 | acc=1.0000 | 5039.9 samples/s | 78.7 steps/s
[Step=5500 Epoch=10.7] | Loss=0.04307 | Reg=0.00239 | L2-Norm=15.451 | L2-Norm(final)=2.344 | acc=0.9531 | 5017.0 samples/s | 78.4 steps/s
[Step=5550 Epoch=10.8] | Loss=0.04198 | Reg=0.00239 | L2-Norm=15.472 | L2-Norm(final)=2.345 | acc=0.9844 | 4936.0 samples/s | 77.1 steps/s
[Step=5600 Epoch=10.9] | Loss=0.04159 | Reg=0.00240 | L2-Norm=15.492 | L2-Norm(final)=2.344 | acc=0.9688 | 4993.9 samples/s | 78.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step5600.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 9.4] | Loss=0.14433 | Reg=0.00226 | L2-Norm=15.020 | L2-Norm(final)=2.343 | acc=0.8906 | 4779.4 samples/s | 74.7 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.06982 | Reg=0.00228 | L2-Norm=15.112 | L2-Norm(final)=2.341 | acc=0.9844 | 4487.6 samples/s | 70.1 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.05978 | Reg=0.00230 | L2-Norm=15.162 | L2-Norm(final)=2.347 | acc=0.9531 | 4888.7 samples/s | 76.4 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.05506 | Reg=0.00231 | L2-Norm=15.202 | L2-Norm(final)=2.352 | acc=0.9844 | 4968.1 samples/s | 77.6 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.05310 | Reg=0.00232 | L2-Norm=15.236 | L2-Norm(final)=2.357 | acc=0.9375 | 4965.6 samples/s | 77.6 steps/s
[Step=5050 Epoch= 9.9] | Loss=0.05108 | Reg=0.00233 | L2-Norm=15.264 | L2-Norm(final)=2.359 | acc=1.0000 | 4952.9 samples/s | 77.4 steps/s
[Step=5100 Epoch=10.0] | Loss=0.04918 | Reg=0.00234 | L2-Norm=15.291 | L2-Norm(final)=2.362 | acc=0.9375 | 4984.7 samples/s | 77.9 steps/s
[Step=5150 Epoch=10.1] | Loss=0.04909 | Reg=0.00235 | L2-Norm=15.316 | L2-Norm(final)=2.362 | acc=1.0000 | 4994.3 samples/s | 78.0 steps/s
[Step=5200 Epoch=10.2] | Loss=0.04793 | Reg=0.00235 | L2-Norm=15.342 | L2-Norm(final)=2.364 | acc=1.0000 | 5076.3 samples/s | 79.3 steps/s
[Step=5250 Epoch=10.3] | Loss=0.04664 | Reg=0.00236 | L2-Norm=15.368 | L2-Norm(final)=2.367 | acc=0.9531 | 4957.4 samples/s | 77.5 steps/s
[Step=5300 Epoch=10.4] | Loss=0.04631 | Reg=0.00237 | L2-Norm=15.394 | L2-Norm(final)=2.369 | acc=0.9531 | 6055.1 samples/s | 94.6 steps/s
[Step=5350 Epoch=10.5] | Loss=0.04527 | Reg=0.00238 | L2-Norm=15.420 | L2-Norm(final)=2.371 | acc=0.9531 | 2093.3 samples/s | 32.7 steps/s
[Step=5400 Epoch=10.6] | Loss=0.04439 | Reg=0.00239 | L2-Norm=15.445 | L2-Norm(final)=2.371 | acc=0.9531 | 4977.2 samples/s | 77.8 steps/s
[Step=5450 Epoch=10.7] | Loss=0.04365 | Reg=0.00239 | L2-Norm=15.469 | L2-Norm(final)=2.372 | acc=0.9844 | 5019.4 samples/s | 78.4 steps/s
[Step=5500 Epoch=10.8] | Loss=0.04294 | Reg=0.00240 | L2-Norm=15.494 | L2-Norm(final)=2.372 | acc=0.9844 | 5006.1 samples/s | 78.2 steps/s
[Step=5550 Epoch=10.9] | Loss=0.04224 | Reg=0.00241 | L2-Norm=15.519 | L2-Norm(final)=2.373 | acc=0.9844 | 5049.7 samples/s | 78.9 steps/s
[Step=5600 Epoch=10.9] | Loss=0.04190 | Reg=0.00242 | L2-Norm=15.543 | L2-Norm(final)=2.374 | acc=0.9531 | 5083.8 samples/s | 79.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step5600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch=18.4] | Loss=0.06272 | Reg=0.00226 | L2-Norm=15.020 | L2-Norm(final)=2.344 | acc=0.9531 | 4088.4 samples/s | 63.9 steps/s
[Step=4850 Epoch=18.6] | Loss=0.00927 | Reg=0.00231 | L2-Norm=15.192 | L2-Norm(final)=2.367 | acc=1.0000 | 4711.7 samples/s | 73.6 steps/s
[Step=4900 Epoch=18.8] | Loss=0.00759 | Reg=0.00233 | L2-Norm=15.263 | L2-Norm(final)=2.376 | acc=1.0000 | 4744.1 samples/s | 74.1 steps/s
[Step=4950 Epoch=19.0] | Loss=0.00726 | Reg=0.00234 | L2-Norm=15.302 | L2-Norm(final)=2.371 | acc=1.0000 | 4745.5 samples/s | 74.1 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00658 | Reg=0.00235 | L2-Norm=15.334 | L2-Norm(final)=2.362 | acc=1.0000 | 4695.5 samples/s | 73.4 steps/s
[Step=5050 Epoch=19.3] | Loss=0.00568 | Reg=0.00236 | L2-Norm=15.357 | L2-Norm(final)=2.357 | acc=1.0000 | 5931.2 samples/s | 92.7 steps/s
[Step=5100 Epoch=19.5] | Loss=0.00524 | Reg=0.00236 | L2-Norm=15.370 | L2-Norm(final)=2.352 | acc=1.0000 | 2020.9 samples/s | 31.6 steps/s
[Step=5150 Epoch=19.7] | Loss=0.00487 | Reg=0.00237 | L2-Norm=15.388 | L2-Norm(final)=2.348 | acc=1.0000 | 4770.1 samples/s | 74.5 steps/s
[Step=5200 Epoch=19.9] | Loss=0.00456 | Reg=0.00237 | L2-Norm=15.400 | L2-Norm(final)=2.343 | acc=1.0000 | 4726.8 samples/s | 73.9 steps/s
[Step=5250 Epoch=20.1] | Loss=0.00452 | Reg=0.00237 | L2-Norm=15.408 | L2-Norm(final)=2.338 | acc=1.0000 | 4802.8 samples/s | 75.0 steps/s
[Step=5300 Epoch=20.3] | Loss=0.00431 | Reg=0.00238 | L2-Norm=15.414 | L2-Norm(final)=2.334 | acc=1.0000 | 5188.3 samples/s | 81.1 steps/s
[Step=5350 Epoch=20.5] | Loss=0.00399 | Reg=0.00238 | L2-Norm=15.416 | L2-Norm(final)=2.331 | acc=1.0000 | 2123.3 samples/s | 33.2 steps/s
[Step=5400 Epoch=20.7] | Loss=0.00367 | Reg=0.00238 | L2-Norm=15.413 | L2-Norm(final)=2.329 | acc=1.0000 | 4679.4 samples/s | 73.1 steps/s
[Step=5450 Epoch=20.9] | Loss=0.00339 | Reg=0.00237 | L2-Norm=15.406 | L2-Norm(final)=2.327 | acc=1.0000 | 4682.1 samples/s | 73.2 steps/s
[Step=5500 Epoch=21.1] | Loss=0.00315 | Reg=0.00237 | L2-Norm=15.395 | L2-Norm(final)=2.326 | acc=1.0000 | 4723.6 samples/s | 73.8 steps/s
[Step=5550 Epoch=21.3] | Loss=0.00295 | Reg=0.00237 | L2-Norm=15.382 | L2-Norm(final)=2.325 | acc=1.0000 | 4721.3 samples/s | 73.8 steps/s
[Step=5600 Epoch=21.5] | Loss=0.00276 | Reg=0.00236 | L2-Norm=15.366 | L2-Norm(final)=2.325 | acc=1.0000 | 2211.2 samples/s | 34.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step5600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch=18.5] | Loss=0.06848 | Reg=0.00226 | L2-Norm=15.020 | L2-Norm(final)=2.343 | acc=0.9688 | 4170.3 samples/s | 65.2 steps/s
[Step=4850 Epoch=18.7] | Loss=0.00750 | Reg=0.00229 | L2-Norm=15.138 | L2-Norm(final)=2.368 | acc=1.0000 | 4505.3 samples/s | 70.4 steps/s
[Step=4900 Epoch=18.9] | Loss=0.00726 | Reg=0.00231 | L2-Norm=15.188 | L2-Norm(final)=2.366 | acc=0.9844 | 4772.0 samples/s | 74.6 steps/s
[Step=4950 Epoch=19.1] | Loss=0.00713 | Reg=0.00232 | L2-Norm=15.232 | L2-Norm(final)=2.356 | acc=1.0000 | 4751.0 samples/s | 74.2 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00760 | Reg=0.00233 | L2-Norm=15.265 | L2-Norm(final)=2.339 | acc=0.9844 | 4785.4 samples/s | 74.8 steps/s
[Step=5050 Epoch=19.4] | Loss=0.00728 | Reg=0.00234 | L2-Norm=15.303 | L2-Norm(final)=2.323 | acc=0.9844 | 6174.0 samples/s | 96.5 steps/s
[Step=5100 Epoch=19.6] | Loss=0.00638 | Reg=0.00235 | L2-Norm=15.334 | L2-Norm(final)=2.314 | acc=1.0000 | 2006.5 samples/s | 31.4 steps/s
[Step=5150 Epoch=19.8] | Loss=0.00572 | Reg=0.00236 | L2-Norm=15.359 | L2-Norm(final)=2.309 | acc=1.0000 | 4829.3 samples/s | 75.5 steps/s
[Step=5200 Epoch=20.0] | Loss=0.00509 | Reg=0.00236 | L2-Norm=15.373 | L2-Norm(final)=2.305 | acc=1.0000 | 4689.8 samples/s | 73.3 steps/s
[Step=5250 Epoch=20.2] | Loss=0.00454 | Reg=0.00237 | L2-Norm=15.380 | L2-Norm(final)=2.301 | acc=1.0000 | 4868.0 samples/s | 76.1 steps/s
[Step=5300 Epoch=20.4] | Loss=0.00418 | Reg=0.00237 | L2-Norm=15.378 | L2-Norm(final)=2.299 | acc=1.0000 | 5310.7 samples/s | 83.0 steps/s
[Step=5350 Epoch=20.6] | Loss=0.00420 | Reg=0.00236 | L2-Norm=15.375 | L2-Norm(final)=2.297 | acc=1.0000 | 2093.8 samples/s | 32.7 steps/s
[Step=5400 Epoch=20.8] | Loss=0.00393 | Reg=0.00236 | L2-Norm=15.374 | L2-Norm(final)=2.292 | acc=1.0000 | 4797.6 samples/s | 75.0 steps/s
[Step=5450 Epoch=21.0] | Loss=0.00363 | Reg=0.00236 | L2-Norm=15.370 | L2-Norm(final)=2.289 | acc=1.0000 | 4637.5 samples/s | 72.5 steps/s
[Step=5500 Epoch=21.2] | Loss=0.00339 | Reg=0.00236 | L2-Norm=15.363 | L2-Norm(final)=2.286 | acc=1.0000 | 4696.4 samples/s | 73.4 steps/s
[Step=5550 Epoch=21.4] | Loss=0.00317 | Reg=0.00236 | L2-Norm=15.353 | L2-Norm(final)=2.285 | acc=1.0000 | 4864.4 samples/s | 76.0 steps/s
[Step=5600 Epoch=21.6] | Loss=0.00297 | Reg=0.00235 | L2-Norm=15.341 | L2-Norm(final)=2.283 | acc=1.0000 | 2184.8 samples/s | 34.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43330 | acc=0.6706 | tpr=0.5322 | fpr=0.0287 | 4777.2 samples/s | 18.7 steps/s
Avg test loss: 0.43349, Avg test acc: 0.67193, Avg tpr: 0.53710, Avg fpr: 0.03153, total FA: 246

Testing server on iccad2012
[Step=  50] | Loss=0.18069 | acc=0.9090 | tpr=0.9558 | fpr=0.0919 | 4637.4 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.18415 | acc=0.9096 | tpr=0.9680 | fpr=0.0915 | 8603.7 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.18862 | acc=0.9072 | tpr=0.9755 | fpr=0.0941 | 8922.8 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.18917 | acc=0.9082 | tpr=0.9792 | fpr=0.0931 | 8806.6 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.18967 | acc=0.9076 | tpr=0.9817 | fpr=0.0937 | 8849.2 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.19171 | acc=0.9067 | tpr=0.9811 | fpr=0.0947 | 8645.2 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.19186 | acc=0.9065 | tpr=0.9806 | fpr=0.0948 | 9563.8 samples/s | 37.4 steps/s
[Step= 400] | Loss=0.19235 | acc=0.9064 | tpr=0.9787 | fpr=0.0949 | 8398.2 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.19482 | acc=0.9058 | tpr=0.9786 | fpr=0.0955 | 8954.7 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.19555 | acc=0.9053 | tpr=0.9789 | fpr=0.0960 | 9669.9 samples/s | 37.8 steps/s
[Step= 550] | Loss=0.19505 | acc=0.9052 | tpr=0.9769 | fpr=0.0961 | 13727.1 samples/s | 53.6 steps/s
Avg test loss: 0.19483, Avg test acc: 0.90518, Avg tpr: 0.97623, Avg fpr: 0.09611, total FA: 13345

server round 7/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch=10.9] | Loss=0.30370 | Reg=0.00223 | L2-Norm=14.936 | L2-Norm(final)=2.313 | acc=0.7812 | 4044.8 samples/s | 63.2 steps/s
[Step=5650 Epoch=11.0] | Loss=0.07795 | Reg=0.00227 | L2-Norm=15.069 | L2-Norm(final)=2.309 | acc=0.9375 | 4712.2 samples/s | 73.6 steps/s
[Step=5700 Epoch=11.1] | Loss=0.06554 | Reg=0.00229 | L2-Norm=15.129 | L2-Norm(final)=2.320 | acc=0.9844 | 4962.0 samples/s | 77.5 steps/s
[Step=5750 Epoch=11.2] | Loss=0.05881 | Reg=0.00230 | L2-Norm=15.177 | L2-Norm(final)=2.322 | acc=1.0000 | 4989.7 samples/s | 78.0 steps/s
[Step=5800 Epoch=11.3] | Loss=0.05517 | Reg=0.00231 | L2-Norm=15.212 | L2-Norm(final)=2.323 | acc=0.9688 | 4913.2 samples/s | 76.8 steps/s
[Step=5850 Epoch=11.4] | Loss=0.05456 | Reg=0.00232 | L2-Norm=15.240 | L2-Norm(final)=2.322 | acc=0.9375 | 4995.9 samples/s | 78.1 steps/s
[Step=5900 Epoch=11.5] | Loss=0.05311 | Reg=0.00233 | L2-Norm=15.265 | L2-Norm(final)=2.323 | acc=1.0000 | 4963.1 samples/s | 77.5 steps/s
[Step=5950 Epoch=11.6] | Loss=0.05133 | Reg=0.00234 | L2-Norm=15.292 | L2-Norm(final)=2.325 | acc=0.9688 | 4944.2 samples/s | 77.3 steps/s
[Step=6000 Epoch=11.7] | Loss=0.04966 | Reg=0.00235 | L2-Norm=15.320 | L2-Norm(final)=2.327 | acc=0.9844 | 4968.8 samples/s | 77.6 steps/s
[Step=6050 Epoch=11.8] | Loss=0.04842 | Reg=0.00236 | L2-Norm=15.346 | L2-Norm(final)=2.328 | acc=0.9688 | 5023.4 samples/s | 78.5 steps/s
[Step=6100 Epoch=11.9] | Loss=0.04722 | Reg=0.00236 | L2-Norm=15.372 | L2-Norm(final)=2.330 | acc=0.9062 | 6100.0 samples/s | 95.3 steps/s
[Step=6150 Epoch=12.0] | Loss=0.04556 | Reg=0.00237 | L2-Norm=15.396 | L2-Norm(final)=2.331 | acc=0.9688 | 2028.5 samples/s | 31.7 steps/s
[Step=6200 Epoch=12.1] | Loss=0.04421 | Reg=0.00238 | L2-Norm=15.419 | L2-Norm(final)=2.334 | acc=0.9844 | 4954.7 samples/s | 77.4 steps/s
[Step=6250 Epoch=12.2] | Loss=0.04314 | Reg=0.00238 | L2-Norm=15.441 | L2-Norm(final)=2.335 | acc=0.9844 | 4987.2 samples/s | 77.9 steps/s
[Step=6300 Epoch=12.3] | Loss=0.04277 | Reg=0.00239 | L2-Norm=15.462 | L2-Norm(final)=2.336 | acc=0.9531 | 5092.4 samples/s | 79.6 steps/s
[Step=6350 Epoch=12.4] | Loss=0.04194 | Reg=0.00240 | L2-Norm=15.483 | L2-Norm(final)=2.338 | acc=0.9531 | 5007.6 samples/s | 78.2 steps/s
[Step=6400 Epoch=12.5] | Loss=0.04120 | Reg=0.00240 | L2-Norm=15.502 | L2-Norm(final)=2.339 | acc=1.0000 | 5128.0 samples/s | 80.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step6400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch=10.9] | Loss=0.28153 | Reg=0.00223 | L2-Norm=14.936 | L2-Norm(final)=2.312 | acc=0.7969 | 4150.1 samples/s | 64.8 steps/s
[Step=5650 Epoch=11.0] | Loss=0.08099 | Reg=0.00227 | L2-Norm=15.064 | L2-Norm(final)=2.305 | acc=0.9375 | 4842.1 samples/s | 75.7 steps/s
[Step=5700 Epoch=11.1] | Loss=0.06255 | Reg=0.00229 | L2-Norm=15.124 | L2-Norm(final)=2.319 | acc=0.9531 | 4992.4 samples/s | 78.0 steps/s
[Step=5750 Epoch=11.2] | Loss=0.05551 | Reg=0.00230 | L2-Norm=15.166 | L2-Norm(final)=2.331 | acc=0.9375 | 5117.4 samples/s | 80.0 steps/s
[Step=5800 Epoch=11.3] | Loss=0.05387 | Reg=0.00231 | L2-Norm=15.201 | L2-Norm(final)=2.336 | acc=0.9688 | 4975.3 samples/s | 77.7 steps/s
[Step=5850 Epoch=11.4] | Loss=0.05134 | Reg=0.00232 | L2-Norm=15.232 | L2-Norm(final)=2.340 | acc=0.9219 | 5006.0 samples/s | 78.2 steps/s
[Step=5900 Epoch=11.5] | Loss=0.05002 | Reg=0.00233 | L2-Norm=15.259 | L2-Norm(final)=2.343 | acc=0.9844 | 5039.6 samples/s | 78.7 steps/s
[Step=5950 Epoch=11.6] | Loss=0.04872 | Reg=0.00234 | L2-Norm=15.283 | L2-Norm(final)=2.344 | acc=0.9844 | 5042.2 samples/s | 78.8 steps/s
[Step=6000 Epoch=11.7] | Loss=0.04810 | Reg=0.00234 | L2-Norm=15.305 | L2-Norm(final)=2.345 | acc=0.9688 | 5087.8 samples/s | 79.5 steps/s
[Step=6050 Epoch=11.8] | Loss=0.04690 | Reg=0.00235 | L2-Norm=15.327 | L2-Norm(final)=2.347 | acc=0.9531 | 4942.1 samples/s | 77.2 steps/s
[Step=6100 Epoch=11.9] | Loss=0.04603 | Reg=0.00236 | L2-Norm=15.351 | L2-Norm(final)=2.348 | acc=0.8906 | 6164.2 samples/s | 96.3 steps/s
[Step=6150 Epoch=12.0] | Loss=0.04408 | Reg=0.00236 | L2-Norm=15.376 | L2-Norm(final)=2.351 | acc=0.9688 | 2100.0 samples/s | 32.8 steps/s
[Step=6200 Epoch=12.1] | Loss=0.04277 | Reg=0.00237 | L2-Norm=15.401 | L2-Norm(final)=2.355 | acc=0.9844 | 4964.3 samples/s | 77.6 steps/s
[Step=6250 Epoch=12.2] | Loss=0.04237 | Reg=0.00238 | L2-Norm=15.425 | L2-Norm(final)=2.357 | acc=0.9844 | 5083.8 samples/s | 79.4 steps/s
[Step=6300 Epoch=12.3] | Loss=0.04142 | Reg=0.00239 | L2-Norm=15.449 | L2-Norm(final)=2.359 | acc=0.9531 | 4956.9 samples/s | 77.5 steps/s
[Step=6350 Epoch=12.4] | Loss=0.04069 | Reg=0.00239 | L2-Norm=15.472 | L2-Norm(final)=2.361 | acc=0.9688 | 5100.5 samples/s | 79.7 steps/s
[Step=6400 Epoch=12.5] | Loss=0.04011 | Reg=0.00240 | L2-Norm=15.495 | L2-Norm(final)=2.363 | acc=1.0000 | 5037.3 samples/s | 78.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step6400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch=21.5] | Loss=0.03304 | Reg=0.00223 | L2-Norm=14.936 | L2-Norm(final)=2.314 | acc=0.9688 | 4263.6 samples/s | 66.6 steps/s
[Step=5650 Epoch=21.6] | Loss=0.00706 | Reg=0.00226 | L2-Norm=15.031 | L2-Norm(final)=2.341 | acc=1.0000 | 4428.1 samples/s | 69.2 steps/s
[Step=5700 Epoch=21.8] | Loss=0.00582 | Reg=0.00227 | L2-Norm=15.071 | L2-Norm(final)=2.347 | acc=0.9844 | 4782.2 samples/s | 74.7 steps/s
[Step=5750 Epoch=22.0] | Loss=0.00434 | Reg=0.00228 | L2-Norm=15.099 | L2-Norm(final)=2.348 | acc=1.0000 | 4774.1 samples/s | 74.6 steps/s
[Step=5800 Epoch=22.2] | Loss=0.00481 | Reg=0.00229 | L2-Norm=15.122 | L2-Norm(final)=2.344 | acc=1.0000 | 4792.6 samples/s | 74.9 steps/s
[Step=5850 Epoch=22.4] | Loss=0.00555 | Reg=0.00229 | L2-Norm=15.148 | L2-Norm(final)=2.332 | acc=0.9844 | 6043.2 samples/s | 94.4 steps/s
[Step=5900 Epoch=22.6] | Loss=0.00501 | Reg=0.00230 | L2-Norm=15.179 | L2-Norm(final)=2.322 | acc=1.0000 | 2000.9 samples/s | 31.3 steps/s
[Step=5950 Epoch=22.8] | Loss=0.00431 | Reg=0.00231 | L2-Norm=15.196 | L2-Norm(final)=2.318 | acc=1.0000 | 4817.9 samples/s | 75.3 steps/s
[Step=6000 Epoch=23.0] | Loss=0.00385 | Reg=0.00231 | L2-Norm=15.203 | L2-Norm(final)=2.316 | acc=1.0000 | 4698.5 samples/s | 73.4 steps/s
[Step=6050 Epoch=23.2] | Loss=0.00342 | Reg=0.00231 | L2-Norm=15.202 | L2-Norm(final)=2.314 | acc=1.0000 | 4753.7 samples/s | 74.3 steps/s
[Step=6100 Epoch=23.4] | Loss=0.00313 | Reg=0.00231 | L2-Norm=15.195 | L2-Norm(final)=2.313 | acc=1.0000 | 5289.8 samples/s | 82.7 steps/s
[Step=6150 Epoch=23.6] | Loss=0.00286 | Reg=0.00231 | L2-Norm=15.185 | L2-Norm(final)=2.312 | acc=1.0000 | 2120.9 samples/s | 33.1 steps/s
[Step=6200 Epoch=23.8] | Loss=0.00262 | Reg=0.00230 | L2-Norm=15.171 | L2-Norm(final)=2.312 | acc=1.0000 | 4793.6 samples/s | 74.9 steps/s
[Step=6250 Epoch=23.9] | Loss=0.00242 | Reg=0.00230 | L2-Norm=15.155 | L2-Norm(final)=2.312 | acc=1.0000 | 4765.2 samples/s | 74.5 steps/s
[Step=6300 Epoch=24.1] | Loss=0.00225 | Reg=0.00229 | L2-Norm=15.137 | L2-Norm(final)=2.313 | acc=1.0000 | 4790.9 samples/s | 74.9 steps/s
[Step=6350 Epoch=24.3] | Loss=0.00210 | Reg=0.00229 | L2-Norm=15.118 | L2-Norm(final)=2.313 | acc=1.0000 | 4673.1 samples/s | 73.0 steps/s
[Step=6400 Epoch=24.5] | Loss=0.00197 | Reg=0.00228 | L2-Norm=15.097 | L2-Norm(final)=2.314 | acc=1.0000 | 2187.6 samples/s | 34.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step6400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch=21.6] | Loss=0.01658 | Reg=0.00223 | L2-Norm=14.936 | L2-Norm(final)=2.315 | acc=0.9844 | 4505.7 samples/s | 70.4 steps/s
[Step=5650 Epoch=21.7] | Loss=0.00387 | Reg=0.00225 | L2-Norm=14.985 | L2-Norm(final)=2.349 | acc=0.9844 | 4186.9 samples/s | 65.4 steps/s
[Step=5700 Epoch=21.9] | Loss=0.00327 | Reg=0.00225 | L2-Norm=15.012 | L2-Norm(final)=2.356 | acc=1.0000 | 4733.6 samples/s | 74.0 steps/s
[Step=5750 Epoch=22.1] | Loss=0.00389 | Reg=0.00226 | L2-Norm=15.022 | L2-Norm(final)=2.358 | acc=1.0000 | 4697.2 samples/s | 73.4 steps/s
[Step=5800 Epoch=22.3] | Loss=0.00471 | Reg=0.00226 | L2-Norm=15.034 | L2-Norm(final)=2.356 | acc=1.0000 | 4710.3 samples/s | 73.6 steps/s
[Step=5850 Epoch=22.5] | Loss=0.00579 | Reg=0.00227 | L2-Norm=15.070 | L2-Norm(final)=2.338 | acc=1.0000 | 6057.3 samples/s | 94.6 steps/s
[Step=5900 Epoch=22.7] | Loss=0.00509 | Reg=0.00228 | L2-Norm=15.100 | L2-Norm(final)=2.326 | acc=1.0000 | 2007.4 samples/s | 31.4 steps/s
[Step=5950 Epoch=22.9] | Loss=0.00442 | Reg=0.00228 | L2-Norm=15.115 | L2-Norm(final)=2.319 | acc=1.0000 | 4819.5 samples/s | 75.3 steps/s
[Step=6000 Epoch=23.1] | Loss=0.00394 | Reg=0.00229 | L2-Norm=15.120 | L2-Norm(final)=2.314 | acc=1.0000 | 4704.3 samples/s | 73.5 steps/s
[Step=6050 Epoch=23.3] | Loss=0.00353 | Reg=0.00229 | L2-Norm=15.119 | L2-Norm(final)=2.310 | acc=1.0000 | 4804.2 samples/s | 75.1 steps/s
[Step=6100 Epoch=23.5] | Loss=0.00326 | Reg=0.00228 | L2-Norm=15.113 | L2-Norm(final)=2.308 | acc=1.0000 | 5370.4 samples/s | 83.9 steps/s
[Step=6150 Epoch=23.7] | Loss=0.00297 | Reg=0.00228 | L2-Norm=15.103 | L2-Norm(final)=2.305 | acc=1.0000 | 2099.3 samples/s | 32.8 steps/s
[Step=6200 Epoch=23.9] | Loss=0.00272 | Reg=0.00228 | L2-Norm=15.090 | L2-Norm(final)=2.304 | acc=1.0000 | 4737.2 samples/s | 74.0 steps/s
[Step=6250 Epoch=24.1] | Loss=0.00251 | Reg=0.00227 | L2-Norm=15.073 | L2-Norm(final)=2.303 | acc=1.0000 | 4752.2 samples/s | 74.3 steps/s
[Step=6300 Epoch=24.3] | Loss=0.00233 | Reg=0.00227 | L2-Norm=15.055 | L2-Norm(final)=2.302 | acc=1.0000 | 4659.1 samples/s | 72.8 steps/s
[Step=6350 Epoch=24.4] | Loss=0.00218 | Reg=0.00226 | L2-Norm=15.036 | L2-Norm(final)=2.301 | acc=1.0000 | 4870.6 samples/s | 76.1 steps/s
[Step=6400 Epoch=24.6] | Loss=0.00204 | Reg=0.00225 | L2-Norm=15.015 | L2-Norm(final)=2.300 | acc=1.0000 | 2140.0 samples/s | 33.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33565 | acc=0.7430 | tpr=0.6356 | fpr=0.0235 | 4463.2 samples/s | 17.4 steps/s
Avg test loss: 0.33844, Avg test acc: 0.74413, Avg tpr: 0.63921, Avg fpr: 0.02512, total FA: 196

Testing server on iccad2012
[Step=  50] | Loss=0.23811 | acc=0.8793 | tpr=0.9602 | fpr=0.1222 | 4593.7 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.23900 | acc=0.8784 | tpr=0.9723 | fpr=0.1233 | 9000.0 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.24323 | acc=0.8765 | tpr=0.9784 | fpr=0.1254 | 8591.4 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.24357 | acc=0.8774 | tpr=0.9825 | fpr=0.1246 | 9042.0 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.24317 | acc=0.8770 | tpr=0.9843 | fpr=0.1250 | 8872.8 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.24665 | acc=0.8757 | tpr=0.9840 | fpr=0.1263 | 8782.6 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.24711 | acc=0.8756 | tpr=0.9825 | fpr=0.1264 | 8708.3 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.24721 | acc=0.8759 | tpr=0.9803 | fpr=0.1259 | 8824.8 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.25008 | acc=0.8753 | tpr=0.9805 | fpr=0.1266 | 9525.2 samples/s | 37.2 steps/s
[Step= 500] | Loss=0.25093 | acc=0.8750 | tpr=0.9815 | fpr=0.1269 | 8249.1 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.25071 | acc=0.8748 | tpr=0.9801 | fpr=0.1272 | 16146.2 samples/s | 63.1 steps/s
Avg test loss: 0.25054, Avg test acc: 0.87476, Avg tpr: 0.97979, Avg fpr: 0.12715, total FA: 17654

server round 8/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch=12.5] | Loss=0.29301 | Reg=0.00219 | L2-Norm=14.810 | L2-Norm(final)=2.329 | acc=0.7500 | 4052.3 samples/s | 63.3 steps/s
[Step=6450 Epoch=12.6] | Loss=0.06614 | Reg=0.00223 | L2-Norm=14.936 | L2-Norm(final)=2.319 | acc=0.9844 | 4670.7 samples/s | 73.0 steps/s
[Step=6500 Epoch=12.7] | Loss=0.05521 | Reg=0.00225 | L2-Norm=15.001 | L2-Norm(final)=2.322 | acc=0.9375 | 5032.1 samples/s | 78.6 steps/s
[Step=6550 Epoch=12.8] | Loss=0.05097 | Reg=0.00226 | L2-Norm=15.043 | L2-Norm(final)=2.324 | acc=0.9375 | 5004.2 samples/s | 78.2 steps/s
[Step=6600 Epoch=12.9] | Loss=0.04843 | Reg=0.00227 | L2-Norm=15.077 | L2-Norm(final)=2.326 | acc=0.9688 | 4940.6 samples/s | 77.2 steps/s
[Step=6650 Epoch=13.0] | Loss=0.04648 | Reg=0.00228 | L2-Norm=15.109 | L2-Norm(final)=2.326 | acc=0.9531 | 5025.5 samples/s | 78.5 steps/s
[Step=6700 Epoch=13.1] | Loss=0.04639 | Reg=0.00229 | L2-Norm=15.142 | L2-Norm(final)=2.326 | acc=1.0000 | 5051.2 samples/s | 78.9 steps/s
[Step=6750 Epoch=13.2] | Loss=0.04601 | Reg=0.00230 | L2-Norm=15.173 | L2-Norm(final)=2.323 | acc=0.9844 | 4991.7 samples/s | 78.0 steps/s
[Step=6800 Epoch=13.3] | Loss=0.04628 | Reg=0.00231 | L2-Norm=15.203 | L2-Norm(final)=2.321 | acc=0.9688 | 4996.8 samples/s | 78.1 steps/s
[Step=6850 Epoch=13.4] | Loss=0.04484 | Reg=0.00232 | L2-Norm=15.234 | L2-Norm(final)=2.322 | acc=0.9688 | 4980.9 samples/s | 77.8 steps/s
[Step=6900 Epoch=13.5] | Loss=0.04446 | Reg=0.00233 | L2-Norm=15.262 | L2-Norm(final)=2.322 | acc=0.9062 | 6158.5 samples/s | 96.2 steps/s
[Step=6950 Epoch=13.6] | Loss=0.04315 | Reg=0.00234 | L2-Norm=15.290 | L2-Norm(final)=2.322 | acc=0.9844 | 2022.8 samples/s | 31.6 steps/s
[Step=7000 Epoch=13.7] | Loss=0.04221 | Reg=0.00235 | L2-Norm=15.315 | L2-Norm(final)=2.322 | acc=0.9844 | 4995.1 samples/s | 78.0 steps/s
[Step=7050 Epoch=13.8] | Loss=0.04152 | Reg=0.00235 | L2-Norm=15.340 | L2-Norm(final)=2.323 | acc=0.9688 | 4938.5 samples/s | 77.2 steps/s
[Step=7100 Epoch=13.8] | Loss=0.04048 | Reg=0.00236 | L2-Norm=15.365 | L2-Norm(final)=2.325 | acc=0.9688 | 4946.8 samples/s | 77.3 steps/s
[Step=7150 Epoch=13.9] | Loss=0.04020 | Reg=0.00237 | L2-Norm=15.391 | L2-Norm(final)=2.326 | acc=1.0000 | 5034.0 samples/s | 78.7 steps/s
[Step=7200 Epoch=14.0] | Loss=0.03973 | Reg=0.00238 | L2-Norm=15.417 | L2-Norm(final)=2.327 | acc=0.9844 | 5003.2 samples/s | 78.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step7200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch=12.5] | Loss=0.24280 | Reg=0.00219 | L2-Norm=14.810 | L2-Norm(final)=2.329 | acc=0.7969 | 4626.7 samples/s | 72.3 steps/s
[Step=6450 Epoch=12.6] | Loss=0.07009 | Reg=0.00223 | L2-Norm=14.946 | L2-Norm(final)=2.318 | acc=0.9531 | 4657.2 samples/s | 72.8 steps/s
[Step=6500 Epoch=12.7] | Loss=0.05639 | Reg=0.00225 | L2-Norm=15.006 | L2-Norm(final)=2.321 | acc=0.9688 | 4808.7 samples/s | 75.1 steps/s
[Step=6550 Epoch=12.8] | Loss=0.05070 | Reg=0.00226 | L2-Norm=15.047 | L2-Norm(final)=2.324 | acc=0.9688 | 4979.3 samples/s | 77.8 steps/s
[Step=6600 Epoch=12.9] | Loss=0.04928 | Reg=0.00227 | L2-Norm=15.083 | L2-Norm(final)=2.327 | acc=0.9844 | 5010.6 samples/s | 78.3 steps/s
[Step=6650 Epoch=13.0] | Loss=0.04583 | Reg=0.00229 | L2-Norm=15.117 | L2-Norm(final)=2.333 | acc=1.0000 | 5016.4 samples/s | 78.4 steps/s
[Step=6700 Epoch=13.1] | Loss=0.04498 | Reg=0.00230 | L2-Norm=15.151 | L2-Norm(final)=2.337 | acc=0.9375 | 4975.8 samples/s | 77.7 steps/s
[Step=6750 Epoch=13.2] | Loss=0.04493 | Reg=0.00231 | L2-Norm=15.184 | L2-Norm(final)=2.339 | acc=0.9688 | 5072.9 samples/s | 79.3 steps/s
[Step=6800 Epoch=13.3] | Loss=0.04400 | Reg=0.00232 | L2-Norm=15.216 | L2-Norm(final)=2.337 | acc=0.9219 | 4929.2 samples/s | 77.0 steps/s
[Step=6850 Epoch=13.4] | Loss=0.04300 | Reg=0.00233 | L2-Norm=15.247 | L2-Norm(final)=2.337 | acc=0.9844 | 5023.3 samples/s | 78.5 steps/s
[Step=6900 Epoch=13.5] | Loss=0.04258 | Reg=0.00233 | L2-Norm=15.276 | L2-Norm(final)=2.337 | acc=0.9688 | 6169.4 samples/s | 96.4 steps/s
[Step=6950 Epoch=13.6] | Loss=0.04119 | Reg=0.00234 | L2-Norm=15.304 | L2-Norm(final)=2.337 | acc=0.9844 | 2084.2 samples/s | 32.6 steps/s
[Step=7000 Epoch=13.7] | Loss=0.03971 | Reg=0.00235 | L2-Norm=15.330 | L2-Norm(final)=2.339 | acc=0.9531 | 4876.9 samples/s | 76.2 steps/s
[Step=7050 Epoch=13.8] | Loss=0.03916 | Reg=0.00236 | L2-Norm=15.355 | L2-Norm(final)=2.340 | acc=0.9844 | 4898.9 samples/s | 76.5 steps/s
[Step=7100 Epoch=13.9] | Loss=0.03819 | Reg=0.00237 | L2-Norm=15.379 | L2-Norm(final)=2.342 | acc=0.9844 | 4987.9 samples/s | 77.9 steps/s
[Step=7150 Epoch=14.0] | Loss=0.03780 | Reg=0.00237 | L2-Norm=15.403 | L2-Norm(final)=2.343 | acc=0.9062 | 5038.5 samples/s | 78.7 steps/s
[Step=7200 Epoch=14.1] | Loss=0.03751 | Reg=0.00238 | L2-Norm=15.428 | L2-Norm(final)=2.345 | acc=0.9844 | 5066.9 samples/s | 79.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step7200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch=24.5] | Loss=0.07282 | Reg=0.00219 | L2-Norm=14.810 | L2-Norm(final)=2.329 | acc=0.9219 | 3998.6 samples/s | 62.5 steps/s
[Step=6450 Epoch=24.7] | Loss=0.00472 | Reg=0.00223 | L2-Norm=14.949 | L2-Norm(final)=2.349 | acc=1.0000 | 4811.1 samples/s | 75.2 steps/s
[Step=6500 Epoch=24.9] | Loss=0.00430 | Reg=0.00225 | L2-Norm=14.986 | L2-Norm(final)=2.354 | acc=0.9844 | 4768.1 samples/s | 74.5 steps/s
[Step=6550 Epoch=25.1] | Loss=0.00448 | Reg=0.00226 | L2-Norm=15.026 | L2-Norm(final)=2.345 | acc=1.0000 | 4794.7 samples/s | 74.9 steps/s
[Step=6600 Epoch=25.3] | Loss=0.00491 | Reg=0.00227 | L2-Norm=15.066 | L2-Norm(final)=2.332 | acc=1.0000 | 4695.5 samples/s | 73.4 steps/s
[Step=6650 Epoch=25.5] | Loss=0.00436 | Reg=0.00228 | L2-Norm=15.092 | L2-Norm(final)=2.324 | acc=1.0000 | 6005.7 samples/s | 93.8 steps/s
[Step=6700 Epoch=25.7] | Loss=0.00366 | Reg=0.00228 | L2-Norm=15.104 | L2-Norm(final)=2.320 | acc=1.0000 | 2040.5 samples/s | 31.9 steps/s
[Step=6750 Epoch=25.9] | Loss=0.00324 | Reg=0.00228 | L2-Norm=15.104 | L2-Norm(final)=2.319 | acc=1.0000 | 4726.5 samples/s | 73.9 steps/s
[Step=6800 Epoch=26.1] | Loss=0.00305 | Reg=0.00228 | L2-Norm=15.102 | L2-Norm(final)=2.317 | acc=1.0000 | 4798.2 samples/s | 75.0 steps/s
[Step=6850 Epoch=26.2] | Loss=0.00277 | Reg=0.00228 | L2-Norm=15.098 | L2-Norm(final)=2.316 | acc=1.0000 | 4731.6 samples/s | 73.9 steps/s
[Step=6900 Epoch=26.4] | Loss=0.00250 | Reg=0.00228 | L2-Norm=15.091 | L2-Norm(final)=2.316 | acc=1.0000 | 5221.6 samples/s | 81.6 steps/s
[Step=6950 Epoch=26.6] | Loss=0.00227 | Reg=0.00227 | L2-Norm=15.079 | L2-Norm(final)=2.317 | acc=1.0000 | 2097.6 samples/s | 32.8 steps/s
[Step=7000 Epoch=26.8] | Loss=0.00208 | Reg=0.00227 | L2-Norm=15.064 | L2-Norm(final)=2.317 | acc=1.0000 | 4721.9 samples/s | 73.8 steps/s
[Step=7050 Epoch=27.0] | Loss=0.00192 | Reg=0.00226 | L2-Norm=15.047 | L2-Norm(final)=2.318 | acc=1.0000 | 4846.4 samples/s | 75.7 steps/s
[Step=7100 Epoch=27.2] | Loss=0.00179 | Reg=0.00226 | L2-Norm=15.028 | L2-Norm(final)=2.319 | acc=1.0000 | 4719.9 samples/s | 73.7 steps/s
[Step=7150 Epoch=27.4] | Loss=0.00167 | Reg=0.00225 | L2-Norm=15.008 | L2-Norm(final)=2.319 | acc=1.0000 | 4795.9 samples/s | 74.9 steps/s
[Step=7200 Epoch=27.6] | Loss=0.00156 | Reg=0.00225 | L2-Norm=14.987 | L2-Norm(final)=2.320 | acc=1.0000 | 2205.1 samples/s | 34.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step7200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch=24.6] | Loss=0.04386 | Reg=0.00219 | L2-Norm=14.810 | L2-Norm(final)=2.331 | acc=0.9844 | 4154.0 samples/s | 64.9 steps/s
[Step=6450 Epoch=24.8] | Loss=0.00558 | Reg=0.00223 | L2-Norm=14.932 | L2-Norm(final)=2.340 | acc=1.0000 | 4493.0 samples/s | 70.2 steps/s
[Step=6500 Epoch=25.0] | Loss=0.00297 | Reg=0.00224 | L2-Norm=14.954 | L2-Norm(final)=2.352 | acc=1.0000 | 4772.4 samples/s | 74.6 steps/s
[Step=6550 Epoch=25.2] | Loss=0.00234 | Reg=0.00224 | L2-Norm=14.953 | L2-Norm(final)=2.359 | acc=1.0000 | 4821.8 samples/s | 75.3 steps/s
[Step=6600 Epoch=25.4] | Loss=0.00179 | Reg=0.00223 | L2-Norm=14.946 | L2-Norm(final)=2.366 | acc=1.0000 | 4670.3 samples/s | 73.0 steps/s
[Step=6650 Epoch=25.6] | Loss=0.00145 | Reg=0.00223 | L2-Norm=14.930 | L2-Norm(final)=2.372 | acc=1.0000 | 5996.3 samples/s | 93.7 steps/s
[Step=6700 Epoch=25.8] | Loss=0.00134 | Reg=0.00222 | L2-Norm=14.912 | L2-Norm(final)=2.378 | acc=1.0000 | 2005.3 samples/s | 31.3 steps/s
[Step=6750 Epoch=26.0] | Loss=0.00180 | Reg=0.00222 | L2-Norm=14.908 | L2-Norm(final)=2.378 | acc=1.0000 | 4623.1 samples/s | 72.2 steps/s
[Step=6800 Epoch=26.2] | Loss=0.00201 | Reg=0.00222 | L2-Norm=14.911 | L2-Norm(final)=2.376 | acc=1.0000 | 4718.5 samples/s | 73.7 steps/s
[Step=6850 Epoch=26.4] | Loss=0.00190 | Reg=0.00222 | L2-Norm=14.911 | L2-Norm(final)=2.373 | acc=1.0000 | 4737.4 samples/s | 74.0 steps/s
[Step=6900 Epoch=26.6] | Loss=0.00177 | Reg=0.00222 | L2-Norm=14.909 | L2-Norm(final)=2.371 | acc=1.0000 | 5352.2 samples/s | 83.6 steps/s
[Step=6950 Epoch=26.8] | Loss=0.00161 | Reg=0.00222 | L2-Norm=14.903 | L2-Norm(final)=2.370 | acc=1.0000 | 2107.9 samples/s | 32.9 steps/s
[Step=7000 Epoch=26.9] | Loss=0.00148 | Reg=0.00222 | L2-Norm=14.893 | L2-Norm(final)=2.370 | acc=1.0000 | 4686.0 samples/s | 73.2 steps/s
[Step=7050 Epoch=27.1] | Loss=0.00143 | Reg=0.00221 | L2-Norm=14.880 | L2-Norm(final)=2.370 | acc=1.0000 | 4861.4 samples/s | 76.0 steps/s
[Step=7100 Epoch=27.3] | Loss=0.00133 | Reg=0.00221 | L2-Norm=14.865 | L2-Norm(final)=2.370 | acc=1.0000 | 4662.0 samples/s | 72.8 steps/s
[Step=7150 Epoch=27.5] | Loss=0.00125 | Reg=0.00220 | L2-Norm=14.849 | L2-Norm(final)=2.370 | acc=1.0000 | 4869.6 samples/s | 76.1 steps/s
[Step=7200 Epoch=27.7] | Loss=0.00117 | Reg=0.00220 | L2-Norm=14.831 | L2-Norm(final)=2.370 | acc=1.0000 | 2174.4 samples/s | 34.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29554 | acc=0.7716 | tpr=0.6796 | fpr=0.0285 | 4599.4 samples/s | 18.0 steps/s
Avg test loss: 0.29895, Avg test acc: 0.77230, Avg tpr: 0.68205, Avg fpr: 0.02923, total FA: 228

Testing server on iccad2012
[Step=  50] | Loss=0.26795 | acc=0.8709 | tpr=0.9602 | fpr=0.1307 | 4609.5 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.26589 | acc=0.8708 | tpr=0.9723 | fpr=0.1311 | 8676.2 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.26850 | acc=0.8701 | tpr=0.9784 | fpr=0.1319 | 8885.2 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.26944 | acc=0.8701 | tpr=0.9781 | fpr=0.1319 | 9106.6 samples/s | 35.6 steps/s
[Step= 250] | Loss=0.26905 | acc=0.8703 | tpr=0.9790 | fpr=0.1317 | 8722.5 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.27194 | acc=0.8696 | tpr=0.9804 | fpr=0.1325 | 9099.7 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.27297 | acc=0.8692 | tpr=0.9800 | fpr=0.1328 | 8069.5 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.27364 | acc=0.8690 | tpr=0.9776 | fpr=0.1330 | 8290.0 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.27674 | acc=0.8686 | tpr=0.9786 | fpr=0.1334 | 8948.0 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.27702 | acc=0.8685 | tpr=0.9793 | fpr=0.1335 | 8614.2 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.27696 | acc=0.8680 | tpr=0.9773 | fpr=0.1340 | 16067.9 samples/s | 62.8 steps/s
Avg test loss: 0.27678, Avg test acc: 0.86800, Avg tpr: 0.97702, Avg fpr: 0.13398, total FA: 18603

server round 9/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch=14.0] | Loss=0.22210 | Reg=0.00217 | L2-Norm=14.727 | L2-Norm(final)=2.343 | acc=0.8438 | 3963.2 samples/s | 61.9 steps/s
[Step=7250 Epoch=14.1] | Loss=0.06233 | Reg=0.00221 | L2-Norm=14.858 | L2-Norm(final)=2.340 | acc=0.9844 | 4738.3 samples/s | 74.0 steps/s
[Step=7300 Epoch=14.2] | Loss=0.05115 | Reg=0.00223 | L2-Norm=14.917 | L2-Norm(final)=2.345 | acc=0.9062 | 5020.9 samples/s | 78.5 steps/s
[Step=7350 Epoch=14.3] | Loss=0.04799 | Reg=0.00224 | L2-Norm=14.960 | L2-Norm(final)=2.344 | acc=0.9844 | 4975.9 samples/s | 77.7 steps/s
[Step=7400 Epoch=14.4] | Loss=0.04454 | Reg=0.00225 | L2-Norm=14.996 | L2-Norm(final)=2.345 | acc=0.9688 | 4983.3 samples/s | 77.9 steps/s
[Step=7450 Epoch=14.5] | Loss=0.04337 | Reg=0.00226 | L2-Norm=15.030 | L2-Norm(final)=2.347 | acc=0.9375 | 4943.9 samples/s | 77.2 steps/s
[Step=7500 Epoch=14.6] | Loss=0.04254 | Reg=0.00227 | L2-Norm=15.062 | L2-Norm(final)=2.349 | acc=0.9375 | 5031.7 samples/s | 78.6 steps/s
[Step=7550 Epoch=14.7] | Loss=0.04166 | Reg=0.00228 | L2-Norm=15.091 | L2-Norm(final)=2.350 | acc=0.9688 | 5015.5 samples/s | 78.4 steps/s
[Step=7600 Epoch=14.8] | Loss=0.04120 | Reg=0.00229 | L2-Norm=15.122 | L2-Norm(final)=2.350 | acc=0.9844 | 5020.7 samples/s | 78.4 steps/s
[Step=7650 Epoch=14.9] | Loss=0.04046 | Reg=0.00230 | L2-Norm=15.153 | L2-Norm(final)=2.350 | acc=0.9531 | 4943.5 samples/s | 77.2 steps/s
[Step=7700 Epoch=15.0] | Loss=0.03969 | Reg=0.00231 | L2-Norm=15.182 | L2-Norm(final)=2.351 | acc=0.9062 | 6129.1 samples/s | 95.8 steps/s
[Step=7750 Epoch=15.1] | Loss=0.03885 | Reg=0.00231 | L2-Norm=15.212 | L2-Norm(final)=2.352 | acc=1.0000 | 2017.6 samples/s | 31.5 steps/s
[Step=7800 Epoch=15.2] | Loss=0.03810 | Reg=0.00232 | L2-Norm=15.240 | L2-Norm(final)=2.354 | acc=0.9688 | 4871.0 samples/s | 76.1 steps/s
[Step=7850 Epoch=15.3] | Loss=0.03706 | Reg=0.00233 | L2-Norm=15.269 | L2-Norm(final)=2.357 | acc=1.0000 | 4902.3 samples/s | 76.6 steps/s
[Step=7900 Epoch=15.4] | Loss=0.03662 | Reg=0.00234 | L2-Norm=15.297 | L2-Norm(final)=2.359 | acc=0.9531 | 4927.0 samples/s | 77.0 steps/s
[Step=7950 Epoch=15.5] | Loss=0.03549 | Reg=0.00235 | L2-Norm=15.325 | L2-Norm(final)=2.362 | acc=1.0000 | 4982.8 samples/s | 77.9 steps/s
[Step=8000 Epoch=15.6] | Loss=0.03513 | Reg=0.00236 | L2-Norm=15.350 | L2-Norm(final)=2.364 | acc=0.9688 | 5023.9 samples/s | 78.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch=14.1] | Loss=0.19770 | Reg=0.00217 | L2-Norm=14.727 | L2-Norm(final)=2.343 | acc=0.8750 | 4255.4 samples/s | 66.5 steps/s
[Step=7250 Epoch=14.2] | Loss=0.05443 | Reg=0.00220 | L2-Norm=14.845 | L2-Norm(final)=2.345 | acc=0.9688 | 4876.6 samples/s | 76.2 steps/s
[Step=7300 Epoch=14.3] | Loss=0.04656 | Reg=0.00222 | L2-Norm=14.899 | L2-Norm(final)=2.354 | acc=0.9844 | 4991.9 samples/s | 78.0 steps/s
[Step=7350 Epoch=14.4] | Loss=0.04505 | Reg=0.00223 | L2-Norm=14.941 | L2-Norm(final)=2.355 | acc=0.9844 | 5022.8 samples/s | 78.5 steps/s
[Step=7400 Epoch=14.5] | Loss=0.04302 | Reg=0.00224 | L2-Norm=14.980 | L2-Norm(final)=2.358 | acc=0.9688 | 4961.0 samples/s | 77.5 steps/s
[Step=7450 Epoch=14.6] | Loss=0.04285 | Reg=0.00225 | L2-Norm=15.016 | L2-Norm(final)=2.359 | acc=0.9688 | 4954.9 samples/s | 77.4 steps/s
[Step=7500 Epoch=14.7] | Loss=0.04202 | Reg=0.00227 | L2-Norm=15.051 | L2-Norm(final)=2.359 | acc=0.9375 | 4983.5 samples/s | 77.9 steps/s
[Step=7550 Epoch=14.8] | Loss=0.04110 | Reg=0.00227 | L2-Norm=15.082 | L2-Norm(final)=2.358 | acc=0.9219 | 5052.2 samples/s | 78.9 steps/s
[Step=7600 Epoch=14.9] | Loss=0.04039 | Reg=0.00228 | L2-Norm=15.112 | L2-Norm(final)=2.359 | acc=0.9531 | 4987.0 samples/s | 77.9 steps/s
[Step=7650 Epoch=15.0] | Loss=0.03960 | Reg=0.00229 | L2-Norm=15.140 | L2-Norm(final)=2.359 | acc=1.0000 | 5090.3 samples/s | 79.5 steps/s
[Step=7700 Epoch=15.1] | Loss=0.03985 | Reg=0.00230 | L2-Norm=15.167 | L2-Norm(final)=2.358 | acc=0.9688 | 6140.8 samples/s | 95.9 steps/s
[Step=7750 Epoch=15.2] | Loss=0.03869 | Reg=0.00231 | L2-Norm=15.194 | L2-Norm(final)=2.357 | acc=0.9844 | 2080.8 samples/s | 32.5 steps/s
[Step=7800 Epoch=15.2] | Loss=0.03767 | Reg=0.00232 | L2-Norm=15.220 | L2-Norm(final)=2.358 | acc=0.9688 | 4994.5 samples/s | 78.0 steps/s
[Step=7850 Epoch=15.3] | Loss=0.03666 | Reg=0.00232 | L2-Norm=15.246 | L2-Norm(final)=2.360 | acc=1.0000 | 4923.5 samples/s | 76.9 steps/s
[Step=7900 Epoch=15.4] | Loss=0.03584 | Reg=0.00233 | L2-Norm=15.270 | L2-Norm(final)=2.361 | acc=1.0000 | 5016.6 samples/s | 78.4 steps/s
[Step=7950 Epoch=15.5] | Loss=0.03497 | Reg=0.00234 | L2-Norm=15.294 | L2-Norm(final)=2.362 | acc=0.9844 | 4939.7 samples/s | 77.2 steps/s
[Step=8000 Epoch=15.6] | Loss=0.03453 | Reg=0.00235 | L2-Norm=15.318 | L2-Norm(final)=2.363 | acc=0.9688 | 5003.6 samples/s | 78.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step8000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch=27.6] | Loss=0.14354 | Reg=0.00217 | L2-Norm=14.727 | L2-Norm(final)=2.340 | acc=0.9062 | 4230.5 samples/s | 66.1 steps/s
[Step=7250 Epoch=27.8] | Loss=0.01086 | Reg=0.00223 | L2-Norm=14.930 | L2-Norm(final)=2.324 | acc=1.0000 | 4404.3 samples/s | 68.8 steps/s
[Step=7300 Epoch=28.0] | Loss=0.00740 | Reg=0.00225 | L2-Norm=14.996 | L2-Norm(final)=2.328 | acc=1.0000 | 4478.5 samples/s | 70.0 steps/s
[Step=7350 Epoch=28.2] | Loss=0.00594 | Reg=0.00226 | L2-Norm=15.029 | L2-Norm(final)=2.329 | acc=1.0000 | 4597.4 samples/s | 71.8 steps/s
[Step=7400 Epoch=28.4] | Loss=0.00478 | Reg=0.00226 | L2-Norm=15.049 | L2-Norm(final)=2.331 | acc=1.0000 | 4682.7 samples/s | 73.2 steps/s
[Step=7450 Epoch=28.5] | Loss=0.00396 | Reg=0.00227 | L2-Norm=15.059 | L2-Norm(final)=2.334 | acc=1.0000 | 5950.0 samples/s | 93.0 steps/s
[Step=7500 Epoch=28.7] | Loss=0.00336 | Reg=0.00227 | L2-Norm=15.062 | L2-Norm(final)=2.339 | acc=1.0000 | 1991.0 samples/s | 31.1 steps/s
[Step=7550 Epoch=28.9] | Loss=0.00290 | Reg=0.00227 | L2-Norm=15.056 | L2-Norm(final)=2.342 | acc=1.0000 | 4739.8 samples/s | 74.1 steps/s
[Step=7600 Epoch=29.1] | Loss=0.00256 | Reg=0.00226 | L2-Norm=15.045 | L2-Norm(final)=2.346 | acc=1.0000 | 4668.2 samples/s | 72.9 steps/s
[Step=7650 Epoch=29.3] | Loss=0.00228 | Reg=0.00226 | L2-Norm=15.030 | L2-Norm(final)=2.349 | acc=1.0000 | 4803.2 samples/s | 75.1 steps/s
[Step=7700 Epoch=29.5] | Loss=0.00205 | Reg=0.00225 | L2-Norm=15.012 | L2-Norm(final)=2.353 | acc=1.0000 | 5202.9 samples/s | 81.3 steps/s
[Step=7750 Epoch=29.7] | Loss=0.00186 | Reg=0.00225 | L2-Norm=14.992 | L2-Norm(final)=2.355 | acc=1.0000 | 2100.3 samples/s | 32.8 steps/s
[Step=7800 Epoch=29.9] | Loss=0.00171 | Reg=0.00224 | L2-Norm=14.970 | L2-Norm(final)=2.358 | acc=1.0000 | 4865.7 samples/s | 76.0 steps/s
[Step=7850 Epoch=30.1] | Loss=0.00158 | Reg=0.00223 | L2-Norm=14.948 | L2-Norm(final)=2.360 | acc=1.0000 | 4770.1 samples/s | 74.5 steps/s
[Step=7900 Epoch=30.3] | Loss=0.00147 | Reg=0.00223 | L2-Norm=14.924 | L2-Norm(final)=2.362 | acc=1.0000 | 4719.1 samples/s | 73.7 steps/s
[Step=7950 Epoch=30.5] | Loss=0.00137 | Reg=0.00222 | L2-Norm=14.899 | L2-Norm(final)=2.363 | acc=1.0000 | 4753.7 samples/s | 74.3 steps/s
[Step=8000 Epoch=30.7] | Loss=0.00128 | Reg=0.00221 | L2-Norm=14.874 | L2-Norm(final)=2.365 | acc=1.0000 | 2183.3 samples/s | 34.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch=27.7] | Loss=0.03806 | Reg=0.00217 | L2-Norm=14.727 | L2-Norm(final)=2.344 | acc=0.9844 | 4001.6 samples/s | 62.5 steps/s
[Step=7250 Epoch=27.9] | Loss=0.00725 | Reg=0.00222 | L2-Norm=14.900 | L2-Norm(final)=2.356 | acc=1.0000 | 4670.6 samples/s | 73.0 steps/s
[Step=7300 Epoch=28.1] | Loss=0.00463 | Reg=0.00223 | L2-Norm=14.946 | L2-Norm(final)=2.355 | acc=1.0000 | 4748.4 samples/s | 74.2 steps/s
[Step=7350 Epoch=28.3] | Loss=0.00328 | Reg=0.00224 | L2-Norm=14.960 | L2-Norm(final)=2.359 | acc=1.0000 | 4734.8 samples/s | 74.0 steps/s
[Step=7400 Epoch=28.5] | Loss=0.00309 | Reg=0.00224 | L2-Norm=14.956 | L2-Norm(final)=2.364 | acc=1.0000 | 4758.7 samples/s | 74.4 steps/s
[Step=7450 Epoch=28.7] | Loss=0.00264 | Reg=0.00223 | L2-Norm=14.948 | L2-Norm(final)=2.363 | acc=1.0000 | 6036.2 samples/s | 94.3 steps/s
[Step=7500 Epoch=28.9] | Loss=0.00224 | Reg=0.00223 | L2-Norm=14.939 | L2-Norm(final)=2.365 | acc=1.0000 | 1960.0 samples/s | 30.6 steps/s
[Step=7550 Epoch=29.1] | Loss=0.00192 | Reg=0.00223 | L2-Norm=14.924 | L2-Norm(final)=2.368 | acc=1.0000 | 4816.5 samples/s | 75.3 steps/s
[Step=7600 Epoch=29.3] | Loss=0.00169 | Reg=0.00222 | L2-Norm=14.905 | L2-Norm(final)=2.370 | acc=1.0000 | 4613.9 samples/s | 72.1 steps/s
[Step=7650 Epoch=29.4] | Loss=0.00150 | Reg=0.00222 | L2-Norm=14.883 | L2-Norm(final)=2.372 | acc=1.0000 | 4694.5 samples/s | 73.4 steps/s
[Step=7700 Epoch=29.6] | Loss=0.00135 | Reg=0.00221 | L2-Norm=14.859 | L2-Norm(final)=2.374 | acc=1.0000 | 5380.7 samples/s | 84.1 steps/s
[Step=7750 Epoch=29.8] | Loss=0.00123 | Reg=0.00220 | L2-Norm=14.833 | L2-Norm(final)=2.376 | acc=1.0000 | 2087.6 samples/s | 32.6 steps/s
[Step=7800 Epoch=30.0] | Loss=0.00113 | Reg=0.00219 | L2-Norm=14.806 | L2-Norm(final)=2.378 | acc=1.0000 | 4705.5 samples/s | 73.5 steps/s
[Step=7850 Epoch=30.2] | Loss=0.00104 | Reg=0.00218 | L2-Norm=14.779 | L2-Norm(final)=2.379 | acc=1.0000 | 4776.1 samples/s | 74.6 steps/s
[Step=7900 Epoch=30.4] | Loss=0.00097 | Reg=0.00218 | L2-Norm=14.751 | L2-Norm(final)=2.381 | acc=1.0000 | 4720.0 samples/s | 73.8 steps/s
[Step=7950 Epoch=30.6] | Loss=0.00090 | Reg=0.00217 | L2-Norm=14.722 | L2-Norm(final)=2.382 | acc=1.0000 | 4721.1 samples/s | 73.8 steps/s
[Step=8000 Epoch=30.8] | Loss=0.00085 | Reg=0.00216 | L2-Norm=14.693 | L2-Norm(final)=2.383 | acc=1.0000 | 2171.5 samples/s | 33.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30916 | acc=0.7869 | tpr=0.7033 | fpr=0.0317 | 4518.8 samples/s | 17.7 steps/s
Avg test loss: 0.31359, Avg test acc: 0.78620, Avg tpr: 0.70414, Avg fpr: 0.03333, total FA: 260

Testing server on iccad2012
[Step=  50] | Loss=0.24686 | acc=0.8945 | tpr=0.9646 | fpr=0.1067 | 4583.2 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.24808 | acc=0.8930 | tpr=0.9744 | fpr=0.1085 | 9044.0 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.25077 | acc=0.8923 | tpr=0.9755 | fpr=0.1093 | 8549.5 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.25229 | acc=0.8926 | tpr=0.9760 | fpr=0.1090 | 8948.1 samples/s | 35.0 steps/s
[Step= 250] | Loss=0.25145 | acc=0.8925 | tpr=0.9773 | fpr=0.1091 | 8947.9 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.25445 | acc=0.8915 | tpr=0.9789 | fpr=0.1101 | 8644.5 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.25560 | acc=0.8913 | tpr=0.9793 | fpr=0.1103 | 9224.7 samples/s | 36.0 steps/s
[Step= 400] | Loss=0.25656 | acc=0.8908 | tpr=0.9765 | fpr=0.1108 | 8536.7 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.25989 | acc=0.8900 | tpr=0.9761 | fpr=0.1115 | 9154.9 samples/s | 35.8 steps/s
[Step= 500] | Loss=0.26012 | acc=0.8900 | tpr=0.9758 | fpr=0.1116 | 8463.5 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.25962 | acc=0.8897 | tpr=0.9749 | fpr=0.1118 | 16224.0 samples/s | 63.4 steps/s
Avg test loss: 0.25943, Avg test acc: 0.88966, Avg tpr: 0.97464, Avg fpr: 0.11188, total FA: 15535

server round 10/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=15.6] | Loss=0.10687 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=2.380 | acc=0.9062 | 4223.4 samples/s | 66.0 steps/s
[Step=8050 Epoch=15.7] | Loss=0.05017 | Reg=0.00215 | L2-Norm=14.655 | L2-Norm(final)=2.372 | acc=0.9844 | 4570.3 samples/s | 71.4 steps/s
[Step=8100 Epoch=15.8] | Loss=0.04042 | Reg=0.00215 | L2-Norm=14.678 | L2-Norm(final)=2.379 | acc=1.0000 | 4987.6 samples/s | 77.9 steps/s
[Step=8150 Epoch=15.9] | Loss=0.03718 | Reg=0.00216 | L2-Norm=14.692 | L2-Norm(final)=2.384 | acc=0.9844 | 5018.8 samples/s | 78.4 steps/s
[Step=8200 Epoch=16.0] | Loss=0.03478 | Reg=0.00216 | L2-Norm=14.704 | L2-Norm(final)=2.388 | acc=1.0000 | 5035.4 samples/s | 78.7 steps/s
[Step=8250 Epoch=16.1] | Loss=0.03338 | Reg=0.00217 | L2-Norm=14.716 | L2-Norm(final)=2.391 | acc=0.9844 | 5033.2 samples/s | 78.6 steps/s
[Step=8300 Epoch=16.2] | Loss=0.03160 | Reg=0.00217 | L2-Norm=14.726 | L2-Norm(final)=2.395 | acc=0.9688 | 4975.9 samples/s | 77.7 steps/s
[Step=8350 Epoch=16.3] | Loss=0.03032 | Reg=0.00217 | L2-Norm=14.735 | L2-Norm(final)=2.399 | acc=0.9688 | 4952.0 samples/s | 77.4 steps/s
[Step=8400 Epoch=16.4] | Loss=0.02974 | Reg=0.00217 | L2-Norm=14.744 | L2-Norm(final)=2.402 | acc=0.9375 | 5039.3 samples/s | 78.7 steps/s
[Step=8450 Epoch=16.5] | Loss=0.02874 | Reg=0.00218 | L2-Norm=14.753 | L2-Norm(final)=2.406 | acc=1.0000 | 4961.8 samples/s | 77.5 steps/s
[Step=8500 Epoch=16.6] | Loss=0.02802 | Reg=0.00218 | L2-Norm=14.761 | L2-Norm(final)=2.410 | acc=1.0000 | 6113.8 samples/s | 95.5 steps/s
[Step=8550 Epoch=16.7] | Loss=0.02718 | Reg=0.00218 | L2-Norm=14.769 | L2-Norm(final)=2.413 | acc=1.0000 | 2037.7 samples/s | 31.8 steps/s
[Step=8600 Epoch=16.8] | Loss=0.02665 | Reg=0.00218 | L2-Norm=14.776 | L2-Norm(final)=2.417 | acc=1.0000 | 4888.6 samples/s | 76.4 steps/s
[Step=8650 Epoch=16.9] | Loss=0.02565 | Reg=0.00219 | L2-Norm=14.784 | L2-Norm(final)=2.422 | acc=0.9844 | 5021.7 samples/s | 78.5 steps/s
[Step=8700 Epoch=17.0] | Loss=0.02530 | Reg=0.00219 | L2-Norm=14.792 | L2-Norm(final)=2.426 | acc=1.0000 | 4934.5 samples/s | 77.1 steps/s
[Step=8750 Epoch=17.1] | Loss=0.02463 | Reg=0.00219 | L2-Norm=14.800 | L2-Norm(final)=2.430 | acc=0.9844 | 5032.1 samples/s | 78.6 steps/s
[Step=8800 Epoch=17.2] | Loss=0.02404 | Reg=0.00219 | L2-Norm=14.807 | L2-Norm(final)=2.434 | acc=0.9688 | 5062.4 samples/s | 79.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=15.6] | Loss=0.30840 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=2.379 | acc=0.7812 | 4455.8 samples/s | 69.6 steps/s
[Step=8050 Epoch=15.7] | Loss=0.05006 | Reg=0.00215 | L2-Norm=14.658 | L2-Norm(final)=2.377 | acc=0.9688 | 4540.8 samples/s | 71.0 steps/s
[Step=8100 Epoch=15.8] | Loss=0.04018 | Reg=0.00215 | L2-Norm=14.680 | L2-Norm(final)=2.382 | acc=0.9844 | 4930.9 samples/s | 77.0 steps/s
[Step=8150 Epoch=15.9] | Loss=0.03451 | Reg=0.00216 | L2-Norm=14.695 | L2-Norm(final)=2.388 | acc=0.9688 | 5032.6 samples/s | 78.6 steps/s
[Step=8200 Epoch=16.0] | Loss=0.03222 | Reg=0.00216 | L2-Norm=14.707 | L2-Norm(final)=2.393 | acc=0.9844 | 4917.2 samples/s | 76.8 steps/s
[Step=8250 Epoch=16.1] | Loss=0.03084 | Reg=0.00217 | L2-Norm=14.719 | L2-Norm(final)=2.397 | acc=0.9688 | 4971.4 samples/s | 77.7 steps/s
[Step=8300 Epoch=16.2] | Loss=0.02937 | Reg=0.00217 | L2-Norm=14.731 | L2-Norm(final)=2.401 | acc=1.0000 | 5004.7 samples/s | 78.2 steps/s
[Step=8350 Epoch=16.3] | Loss=0.02780 | Reg=0.00217 | L2-Norm=14.741 | L2-Norm(final)=2.406 | acc=0.9844 | 5004.5 samples/s | 78.2 steps/s
[Step=8400 Epoch=16.4] | Loss=0.02805 | Reg=0.00218 | L2-Norm=14.751 | L2-Norm(final)=2.410 | acc=1.0000 | 4998.3 samples/s | 78.1 steps/s
[Step=8450 Epoch=16.5] | Loss=0.02745 | Reg=0.00218 | L2-Norm=14.759 | L2-Norm(final)=2.412 | acc=0.9688 | 5073.7 samples/s | 79.3 steps/s
[Step=8500 Epoch=16.6] | Loss=0.02701 | Reg=0.00218 | L2-Norm=14.767 | L2-Norm(final)=2.414 | acc=1.0000 | 6243.1 samples/s | 97.5 steps/s
[Step=8550 Epoch=16.7] | Loss=0.02607 | Reg=0.00218 | L2-Norm=14.775 | L2-Norm(final)=2.417 | acc=1.0000 | 2086.7 samples/s | 32.6 steps/s
[Step=8600 Epoch=16.8] | Loss=0.02546 | Reg=0.00219 | L2-Norm=14.783 | L2-Norm(final)=2.421 | acc=1.0000 | 4918.0 samples/s | 76.8 steps/s
[Step=8650 Epoch=16.9] | Loss=0.02495 | Reg=0.00219 | L2-Norm=14.791 | L2-Norm(final)=2.424 | acc=1.0000 | 4985.0 samples/s | 77.9 steps/s
[Step=8700 Epoch=17.0] | Loss=0.02433 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.427 | acc=0.9844 | 4945.1 samples/s | 77.3 steps/s
[Step=8750 Epoch=17.1] | Loss=0.02381 | Reg=0.00219 | L2-Norm=14.804 | L2-Norm(final)=2.430 | acc=0.9844 | 4902.3 samples/s | 76.6 steps/s
[Step=8800 Epoch=17.2] | Loss=0.02321 | Reg=0.00219 | L2-Norm=14.811 | L2-Norm(final)=2.434 | acc=1.0000 | 4958.5 samples/s | 77.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step8800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=30.7] | Loss=0.04586 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=2.381 | acc=0.9531 | 4129.3 samples/s | 64.5 steps/s
[Step=8050 Epoch=30.8] | Loss=0.00672 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.391 | acc=0.9844 | 4524.5 samples/s | 70.7 steps/s
[Step=8100 Epoch=31.0] | Loss=0.00380 | Reg=0.00215 | L2-Norm=14.678 | L2-Norm(final)=2.398 | acc=1.0000 | 4771.4 samples/s | 74.6 steps/s
[Step=8150 Epoch=31.2] | Loss=0.00287 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=2.402 | acc=1.0000 | 4727.9 samples/s | 73.9 steps/s
[Step=8200 Epoch=31.4] | Loss=0.00223 | Reg=0.00215 | L2-Norm=14.671 | L2-Norm(final)=2.405 | acc=1.0000 | 4796.2 samples/s | 74.9 steps/s
[Step=8250 Epoch=31.6] | Loss=0.00179 | Reg=0.00215 | L2-Norm=14.662 | L2-Norm(final)=2.409 | acc=1.0000 | 5389.9 samples/s | 84.2 steps/s
[Step=8300 Epoch=31.8] | Loss=0.00150 | Reg=0.00215 | L2-Norm=14.651 | L2-Norm(final)=2.412 | acc=1.0000 | 1785.9 samples/s | 27.9 steps/s
[Step=8350 Epoch=32.0] | Loss=0.00129 | Reg=0.00214 | L2-Norm=14.638 | L2-Norm(final)=2.414 | acc=1.0000 | 4070.0 samples/s | 63.6 steps/s
[Step=8400 Epoch=32.2] | Loss=0.00113 | Reg=0.00214 | L2-Norm=14.624 | L2-Norm(final)=2.416 | acc=1.0000 | 4061.1 samples/s | 63.5 steps/s
[Step=8450 Epoch=32.4] | Loss=0.00101 | Reg=0.00213 | L2-Norm=14.610 | L2-Norm(final)=2.418 | acc=1.0000 | 4121.1 samples/s | 64.4 steps/s
[Step=8500 Epoch=32.6] | Loss=0.00091 | Reg=0.00213 | L2-Norm=14.596 | L2-Norm(final)=2.419 | acc=1.0000 | 4543.9 samples/s | 71.0 steps/s
[Step=8550 Epoch=32.8] | Loss=0.00083 | Reg=0.00213 | L2-Norm=14.581 | L2-Norm(final)=2.421 | acc=1.0000 | 1989.1 samples/s | 31.1 steps/s
[Step=8600 Epoch=33.0] | Loss=0.00076 | Reg=0.00212 | L2-Norm=14.566 | L2-Norm(final)=2.422 | acc=1.0000 | 3989.2 samples/s | 62.3 steps/s
[Step=8650 Epoch=33.1] | Loss=0.00070 | Reg=0.00212 | L2-Norm=14.551 | L2-Norm(final)=2.424 | acc=1.0000 | 4313.7 samples/s | 67.4 steps/s
[Step=8700 Epoch=33.3] | Loss=0.00066 | Reg=0.00211 | L2-Norm=14.535 | L2-Norm(final)=2.425 | acc=1.0000 | 4216.0 samples/s | 65.9 steps/s
[Step=8750 Epoch=33.5] | Loss=0.00061 | Reg=0.00211 | L2-Norm=14.520 | L2-Norm(final)=2.426 | acc=1.0000 | 4420.8 samples/s | 69.1 steps/s
[Step=8800 Epoch=33.7] | Loss=0.00057 | Reg=0.00210 | L2-Norm=14.504 | L2-Norm(final)=2.427 | acc=1.0000 | 2008.0 samples/s | 31.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=30.8] | Loss=0.04069 | Reg=0.00214 | L2-Norm=14.615 | L2-Norm(final)=2.380 | acc=0.9688 | 3941.1 samples/s | 61.6 steps/s
[Step=8050 Epoch=31.0] | Loss=0.00753 | Reg=0.00215 | L2-Norm=14.679 | L2-Norm(final)=2.379 | acc=1.0000 | 3968.4 samples/s | 62.0 steps/s
[Step=8100 Epoch=31.2] | Loss=0.00440 | Reg=0.00216 | L2-Norm=14.695 | L2-Norm(final)=2.390 | acc=1.0000 | 4367.5 samples/s | 68.2 steps/s
[Step=8150 Epoch=31.4] | Loss=0.00322 | Reg=0.00216 | L2-Norm=14.701 | L2-Norm(final)=2.398 | acc=1.0000 | 4196.0 samples/s | 65.6 steps/s
[Step=8200 Epoch=31.6] | Loss=0.00249 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=2.405 | acc=1.0000 | 4137.6 samples/s | 64.6 steps/s
[Step=8250 Epoch=31.8] | Loss=0.00205 | Reg=0.00216 | L2-Norm=14.691 | L2-Norm(final)=2.410 | acc=1.0000 | 5583.2 samples/s | 87.2 steps/s
[Step=8300 Epoch=31.9] | Loss=0.00171 | Reg=0.00216 | L2-Norm=14.682 | L2-Norm(final)=2.415 | acc=1.0000 | 1887.9 samples/s | 29.5 steps/s
[Step=8350 Epoch=32.1] | Loss=0.00147 | Reg=0.00215 | L2-Norm=14.669 | L2-Norm(final)=2.419 | acc=1.0000 | 4565.0 samples/s | 71.3 steps/s
[Step=8400 Epoch=32.3] | Loss=0.00129 | Reg=0.00215 | L2-Norm=14.656 | L2-Norm(final)=2.422 | acc=1.0000 | 4533.5 samples/s | 70.8 steps/s
[Step=8450 Epoch=32.5] | Loss=0.00115 | Reg=0.00214 | L2-Norm=14.641 | L2-Norm(final)=2.424 | acc=1.0000 | 4745.1 samples/s | 74.1 steps/s
[Step=8500 Epoch=32.7] | Loss=0.00103 | Reg=0.00214 | L2-Norm=14.626 | L2-Norm(final)=2.427 | acc=1.0000 | 5387.0 samples/s | 84.2 steps/s
[Step=8550 Epoch=32.9] | Loss=0.00094 | Reg=0.00213 | L2-Norm=14.610 | L2-Norm(final)=2.428 | acc=1.0000 | 2083.7 samples/s | 32.6 steps/s
[Step=8600 Epoch=33.1] | Loss=0.00086 | Reg=0.00213 | L2-Norm=14.594 | L2-Norm(final)=2.430 | acc=1.0000 | 4809.0 samples/s | 75.1 steps/s
[Step=8650 Epoch=33.3] | Loss=0.00080 | Reg=0.00213 | L2-Norm=14.578 | L2-Norm(final)=2.432 | acc=1.0000 | 4363.2 samples/s | 68.2 steps/s
[Step=8700 Epoch=33.5] | Loss=0.00074 | Reg=0.00212 | L2-Norm=14.561 | L2-Norm(final)=2.433 | acc=1.0000 | 4382.4 samples/s | 68.5 steps/s
[Step=8750 Epoch=33.7] | Loss=0.00069 | Reg=0.00212 | L2-Norm=14.544 | L2-Norm(final)=2.434 | acc=1.0000 | 4227.6 samples/s | 66.1 steps/s
[Step=8800 Epoch=33.9] | Loss=0.00065 | Reg=0.00211 | L2-Norm=14.527 | L2-Norm(final)=2.436 | acc=1.0000 | 2064.4 samples/s | 32.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31277 | acc=0.8028 | tpr=0.7200 | fpr=0.0173 | 4727.6 samples/s | 18.5 steps/s
Avg test loss: 0.31714, Avg test acc: 0.80367, Avg tpr: 0.72297, Avg fpr: 0.01884, total FA: 147

Testing server on iccad2012
[Step=  50] | Loss=0.26782 | acc=0.8920 | tpr=0.9558 | fpr=0.1092 | 4634.6 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.26900 | acc=0.8910 | tpr=0.9723 | fpr=0.1105 | 8706.4 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.27222 | acc=0.8903 | tpr=0.9769 | fpr=0.1113 | 9057.4 samples/s | 35.4 steps/s
[Step= 200] | Loss=0.27302 | acc=0.8911 | tpr=0.9770 | fpr=0.1105 | 8425.6 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.27247 | acc=0.8914 | tpr=0.9790 | fpr=0.1102 | 8956.0 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.27616 | acc=0.8905 | tpr=0.9804 | fpr=0.1111 | 8975.6 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.27728 | acc=0.8905 | tpr=0.9800 | fpr=0.1111 | 8834.0 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.27876 | acc=0.8902 | tpr=0.9759 | fpr=0.1114 | 9213.1 samples/s | 36.0 steps/s
[Step= 450] | Loss=0.28280 | acc=0.8895 | tpr=0.9737 | fpr=0.1120 | 8721.6 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.28327 | acc=0.8892 | tpr=0.9740 | fpr=0.1124 | 8689.5 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.28302 | acc=0.8889 | tpr=0.9737 | fpr=0.1126 | 16100.6 samples/s | 62.9 steps/s
Avg test loss: 0.28288, Avg test acc: 0.88887, Avg tpr: 0.97345, Avg fpr: 0.11266, total FA: 15643

server round 11/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch=17.2] | Loss=0.12445 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=2.468 | acc=0.9062 | 4088.6 samples/s | 63.9 steps/s
[Step=8850 Epoch=17.3] | Loss=0.04307 | Reg=0.00210 | L2-Norm=14.498 | L2-Norm(final)=2.461 | acc=0.9844 | 4636.4 samples/s | 72.4 steps/s
[Step=8900 Epoch=17.4] | Loss=0.03473 | Reg=0.00211 | L2-Norm=14.521 | L2-Norm(final)=2.465 | acc=0.9688 | 4929.1 samples/s | 77.0 steps/s
[Step=8950 Epoch=17.5] | Loss=0.03191 | Reg=0.00211 | L2-Norm=14.535 | L2-Norm(final)=2.468 | acc=0.9844 | 4964.2 samples/s | 77.6 steps/s
[Step=9000 Epoch=17.6] | Loss=0.03034 | Reg=0.00212 | L2-Norm=14.548 | L2-Norm(final)=2.471 | acc=0.9688 | 5029.6 samples/s | 78.6 steps/s
[Step=9050 Epoch=17.7] | Loss=0.02880 | Reg=0.00212 | L2-Norm=14.558 | L2-Norm(final)=2.475 | acc=0.9844 | 4997.2 samples/s | 78.1 steps/s
[Step=9100 Epoch=17.7] | Loss=0.02752 | Reg=0.00212 | L2-Norm=14.567 | L2-Norm(final)=2.478 | acc=1.0000 | 5174.3 samples/s | 80.8 steps/s
[Step=9150 Epoch=17.8] | Loss=0.02673 | Reg=0.00212 | L2-Norm=14.577 | L2-Norm(final)=2.481 | acc=1.0000 | 4934.7 samples/s | 77.1 steps/s
[Step=9200 Epoch=17.9] | Loss=0.02572 | Reg=0.00213 | L2-Norm=14.586 | L2-Norm(final)=2.484 | acc=0.9844 | 5058.0 samples/s | 79.0 steps/s
[Step=9250 Epoch=18.0] | Loss=0.02539 | Reg=0.00213 | L2-Norm=14.595 | L2-Norm(final)=2.488 | acc=0.9688 | 4914.9 samples/s | 76.8 steps/s
[Step=9300 Epoch=18.1] | Loss=0.02565 | Reg=0.00213 | L2-Norm=14.604 | L2-Norm(final)=2.491 | acc=0.9688 | 6082.3 samples/s | 95.0 steps/s
[Step=9350 Epoch=18.2] | Loss=0.02510 | Reg=0.00214 | L2-Norm=14.612 | L2-Norm(final)=2.493 | acc=1.0000 | 2028.4 samples/s | 31.7 steps/s
[Step=9400 Epoch=18.3] | Loss=0.02434 | Reg=0.00214 | L2-Norm=14.621 | L2-Norm(final)=2.496 | acc=0.9688 | 4920.8 samples/s | 76.9 steps/s
[Step=9450 Epoch=18.4] | Loss=0.02369 | Reg=0.00214 | L2-Norm=14.630 | L2-Norm(final)=2.499 | acc=0.9844 | 5035.1 samples/s | 78.7 steps/s
[Step=9500 Epoch=18.5] | Loss=0.02318 | Reg=0.00214 | L2-Norm=14.638 | L2-Norm(final)=2.503 | acc=0.9688 | 4975.5 samples/s | 77.7 steps/s
[Step=9550 Epoch=18.6] | Loss=0.02280 | Reg=0.00215 | L2-Norm=14.646 | L2-Norm(final)=2.506 | acc=0.9844 | 4961.7 samples/s | 77.5 steps/s
[Step=9600 Epoch=18.7] | Loss=0.02242 | Reg=0.00215 | L2-Norm=14.654 | L2-Norm(final)=2.510 | acc=1.0000 | 4903.2 samples/s | 76.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step9600.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch=17.2] | Loss=0.21390 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=2.467 | acc=0.8906 | 4213.1 samples/s | 65.8 steps/s
[Step=8850 Epoch=17.3] | Loss=0.04895 | Reg=0.00210 | L2-Norm=14.502 | L2-Norm(final)=2.454 | acc=0.9688 | 4885.4 samples/s | 76.3 steps/s
[Step=8900 Epoch=17.4] | Loss=0.03870 | Reg=0.00211 | L2-Norm=14.531 | L2-Norm(final)=2.456 | acc=0.9844 | 4947.0 samples/s | 77.3 steps/s
[Step=8950 Epoch=17.5] | Loss=0.03287 | Reg=0.00212 | L2-Norm=14.551 | L2-Norm(final)=2.462 | acc=0.9844 | 5018.4 samples/s | 78.4 steps/s
[Step=9000 Epoch=17.6] | Loss=0.03025 | Reg=0.00212 | L2-Norm=14.565 | L2-Norm(final)=2.468 | acc=1.0000 | 4971.2 samples/s | 77.7 steps/s
[Step=9050 Epoch=17.7] | Loss=0.02848 | Reg=0.00213 | L2-Norm=14.578 | L2-Norm(final)=2.473 | acc=0.9531 | 5100.9 samples/s | 79.7 steps/s
[Step=9100 Epoch=17.8] | Loss=0.02702 | Reg=0.00213 | L2-Norm=14.589 | L2-Norm(final)=2.477 | acc=1.0000 | 4967.6 samples/s | 77.6 steps/s
[Step=9150 Epoch=17.9] | Loss=0.02628 | Reg=0.00213 | L2-Norm=14.599 | L2-Norm(final)=2.480 | acc=0.9844 | 5022.4 samples/s | 78.5 steps/s
[Step=9200 Epoch=18.0] | Loss=0.02591 | Reg=0.00213 | L2-Norm=14.608 | L2-Norm(final)=2.482 | acc=1.0000 | 4963.4 samples/s | 77.6 steps/s
[Step=9250 Epoch=18.1] | Loss=0.02549 | Reg=0.00214 | L2-Norm=14.618 | L2-Norm(final)=2.485 | acc=0.9844 | 5006.6 samples/s | 78.2 steps/s
[Step=9300 Epoch=18.2] | Loss=0.02503 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=2.488 | acc=1.0000 | 6137.0 samples/s | 95.9 steps/s
[Step=9350 Epoch=18.3] | Loss=0.02432 | Reg=0.00214 | L2-Norm=14.636 | L2-Norm(final)=2.491 | acc=0.9844 | 2096.4 samples/s | 32.8 steps/s
[Step=9400 Epoch=18.4] | Loss=0.02370 | Reg=0.00214 | L2-Norm=14.645 | L2-Norm(final)=2.494 | acc=0.9844 | 5028.9 samples/s | 78.6 steps/s
[Step=9450 Epoch=18.5] | Loss=0.02328 | Reg=0.00215 | L2-Norm=14.653 | L2-Norm(final)=2.497 | acc=1.0000 | 4959.0 samples/s | 77.5 steps/s
[Step=9500 Epoch=18.6] | Loss=0.02299 | Reg=0.00215 | L2-Norm=14.661 | L2-Norm(final)=2.501 | acc=0.9688 | 4985.3 samples/s | 77.9 steps/s
[Step=9550 Epoch=18.7] | Loss=0.02249 | Reg=0.00215 | L2-Norm=14.669 | L2-Norm(final)=2.503 | acc=1.0000 | 4993.2 samples/s | 78.0 steps/s
[Step=9600 Epoch=18.8] | Loss=0.02239 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=2.506 | acc=0.9688 | 4987.0 samples/s | 77.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step9600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch=33.7] | Loss=0.06564 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=2.467 | acc=0.9219 | 4033.8 samples/s | 63.0 steps/s
[Step=8850 Epoch=33.9] | Loss=0.00661 | Reg=0.00212 | L2-Norm=14.561 | L2-Norm(final)=2.459 | acc=1.0000 | 4294.0 samples/s | 67.1 steps/s
[Step=8900 Epoch=34.1] | Loss=0.00487 | Reg=0.00213 | L2-Norm=14.594 | L2-Norm(final)=2.459 | acc=1.0000 | 4741.7 samples/s | 74.1 steps/s
[Step=8950 Epoch=34.3] | Loss=0.00342 | Reg=0.00213 | L2-Norm=14.603 | L2-Norm(final)=2.460 | acc=1.0000 | 4799.3 samples/s | 75.0 steps/s
[Step=9000 Epoch=34.5] | Loss=0.00259 | Reg=0.00213 | L2-Norm=14.603 | L2-Norm(final)=2.463 | acc=1.0000 | 4689.2 samples/s | 73.3 steps/s
[Step=9050 Epoch=34.7] | Loss=0.00208 | Reg=0.00213 | L2-Norm=14.596 | L2-Norm(final)=2.465 | acc=1.0000 | 6026.3 samples/s | 94.2 steps/s
[Step=9100 Epoch=34.9] | Loss=0.00174 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=2.468 | acc=1.0000 | 2027.1 samples/s | 31.7 steps/s
[Step=9150 Epoch=35.1] | Loss=0.00149 | Reg=0.00212 | L2-Norm=14.575 | L2-Norm(final)=2.470 | acc=1.0000 | 4700.4 samples/s | 73.4 steps/s
[Step=9200 Epoch=35.3] | Loss=0.00131 | Reg=0.00212 | L2-Norm=14.562 | L2-Norm(final)=2.472 | acc=1.0000 | 4722.4 samples/s | 73.8 steps/s
[Step=9250 Epoch=35.4] | Loss=0.00117 | Reg=0.00212 | L2-Norm=14.549 | L2-Norm(final)=2.473 | acc=1.0000 | 4825.7 samples/s | 75.4 steps/s
[Step=9300 Epoch=35.6] | Loss=0.00105 | Reg=0.00211 | L2-Norm=14.536 | L2-Norm(final)=2.475 | acc=1.0000 | 5275.4 samples/s | 82.4 steps/s
[Step=9350 Epoch=35.8] | Loss=0.00096 | Reg=0.00211 | L2-Norm=14.521 | L2-Norm(final)=2.476 | acc=1.0000 | 2108.4 samples/s | 32.9 steps/s
[Step=9400 Epoch=36.0] | Loss=0.00088 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=2.477 | acc=1.0000 | 4850.7 samples/s | 75.8 steps/s
[Step=9450 Epoch=36.2] | Loss=0.00081 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=2.479 | acc=1.0000 | 4682.9 samples/s | 73.2 steps/s
[Step=9500 Epoch=36.4] | Loss=0.00075 | Reg=0.00210 | L2-Norm=14.476 | L2-Norm(final)=2.480 | acc=1.0000 | 4732.8 samples/s | 73.9 steps/s
[Step=9550 Epoch=36.6] | Loss=0.00071 | Reg=0.00209 | L2-Norm=14.461 | L2-Norm(final)=2.481 | acc=1.0000 | 4815.4 samples/s | 75.2 steps/s
[Step=9600 Epoch=36.8] | Loss=0.00066 | Reg=0.00209 | L2-Norm=14.445 | L2-Norm(final)=2.482 | acc=1.0000 | 2150.2 samples/s | 33.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step9600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch=33.9] | Loss=0.01560 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=2.468 | acc=0.9844 | 3887.3 samples/s | 60.7 steps/s
[Step=8850 Epoch=34.1] | Loss=0.00499 | Reg=0.00211 | L2-Norm=14.512 | L2-Norm(final)=2.468 | acc=1.0000 | 4691.0 samples/s | 73.3 steps/s
[Step=8900 Epoch=34.3] | Loss=0.00325 | Reg=0.00211 | L2-Norm=14.534 | L2-Norm(final)=2.475 | acc=1.0000 | 4673.3 samples/s | 73.0 steps/s
[Step=8950 Epoch=34.5] | Loss=0.00232 | Reg=0.00211 | L2-Norm=14.540 | L2-Norm(final)=2.479 | acc=1.0000 | 4761.4 samples/s | 74.4 steps/s
[Step=9000 Epoch=34.6] | Loss=0.00175 | Reg=0.00211 | L2-Norm=14.537 | L2-Norm(final)=2.483 | acc=1.0000 | 4712.4 samples/s | 73.6 steps/s
[Step=9050 Epoch=34.8] | Loss=0.00153 | Reg=0.00211 | L2-Norm=14.529 | L2-Norm(final)=2.486 | acc=1.0000 | 5933.8 samples/s | 92.7 steps/s
[Step=9100 Epoch=35.0] | Loss=0.00137 | Reg=0.00211 | L2-Norm=14.522 | L2-Norm(final)=2.488 | acc=1.0000 | 1994.3 samples/s | 31.2 steps/s
[Step=9150 Epoch=35.2] | Loss=0.00118 | Reg=0.00211 | L2-Norm=14.514 | L2-Norm(final)=2.491 | acc=1.0000 | 4819.1 samples/s | 75.3 steps/s
[Step=9200 Epoch=35.4] | Loss=0.00104 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=2.494 | acc=1.0000 | 4740.6 samples/s | 74.1 steps/s
[Step=9250 Epoch=35.6] | Loss=0.00093 | Reg=0.00210 | L2-Norm=14.493 | L2-Norm(final)=2.497 | acc=1.0000 | 4779.5 samples/s | 74.7 steps/s
[Step=9300 Epoch=35.8] | Loss=0.00084 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=2.499 | acc=1.0000 | 5392.2 samples/s | 84.3 steps/s
[Step=9350 Epoch=36.0] | Loss=0.00076 | Reg=0.00209 | L2-Norm=14.467 | L2-Norm(final)=2.500 | acc=1.0000 | 2075.7 samples/s | 32.4 steps/s
[Step=9400 Epoch=36.2] | Loss=0.00070 | Reg=0.00209 | L2-Norm=14.453 | L2-Norm(final)=2.502 | acc=1.0000 | 4417.7 samples/s | 69.0 steps/s
[Step=9450 Epoch=36.4] | Loss=0.00064 | Reg=0.00208 | L2-Norm=14.438 | L2-Norm(final)=2.503 | acc=1.0000 | 4398.2 samples/s | 68.7 steps/s
[Step=9500 Epoch=36.6] | Loss=0.00060 | Reg=0.00208 | L2-Norm=14.423 | L2-Norm(final)=2.505 | acc=1.0000 | 4702.0 samples/s | 73.5 steps/s
[Step=9550 Epoch=36.8] | Loss=0.00056 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=2.506 | acc=1.0000 | 4870.5 samples/s | 76.1 steps/s
[Step=9600 Epoch=37.0] | Loss=0.00053 | Reg=0.00207 | L2-Norm=14.391 | L2-Norm(final)=2.507 | acc=1.0000 | 2182.8 samples/s | 34.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34521 | acc=0.7856 | tpr=0.6939 | fpr=0.0151 | 4502.0 samples/s | 17.6 steps/s
Avg test loss: 0.35209, Avg test acc: 0.78580, Avg tpr: 0.69575, Avg fpr: 0.01615, total FA: 126

Testing server on iccad2012
[Step=  50] | Loss=0.26474 | acc=0.9005 | tpr=0.9602 | fpr=0.1006 | 4549.3 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.26659 | acc=0.9016 | tpr=0.9744 | fpr=0.0997 | 9109.9 samples/s | 35.6 steps/s
[Step= 150] | Loss=0.27115 | acc=0.9011 | tpr=0.9813 | fpr=0.1004 | 9513.9 samples/s | 37.2 steps/s
[Step= 200] | Loss=0.27148 | acc=0.9014 | tpr=0.9803 | fpr=0.1000 | 8004.4 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.27043 | acc=0.9015 | tpr=0.9825 | fpr=0.1000 | 8660.3 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.27374 | acc=0.9009 | tpr=0.9833 | fpr=0.1006 | 9106.5 samples/s | 35.6 steps/s
[Step= 350] | Loss=0.27545 | acc=0.9007 | tpr=0.9812 | fpr=0.1008 | 8692.2 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.27657 | acc=0.9004 | tpr=0.9781 | fpr=0.1010 | 8770.8 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.28060 | acc=0.8999 | tpr=0.9761 | fpr=0.1014 | 9105.7 samples/s | 35.6 steps/s
[Step= 500] | Loss=0.28079 | acc=0.8996 | tpr=0.9767 | fpr=0.1018 | 8537.4 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.28029 | acc=0.8993 | tpr=0.9753 | fpr=0.1021 | 13898.2 samples/s | 54.3 steps/s
Avg test loss: 0.28002, Avg test acc: 0.89932, Avg tpr: 0.97504, Avg fpr: 0.10205, total FA: 14170

server round 12/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch=18.7] | Loss=0.29727 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=2.525 | acc=0.8125 | 3764.2 samples/s | 58.8 steps/s
[Step=9650 Epoch=18.8] | Loss=0.04242 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=2.520 | acc=1.0000 | 4240.7 samples/s | 66.3 steps/s
[Step=9700 Epoch=18.9] | Loss=0.03348 | Reg=0.00207 | L2-Norm=14.392 | L2-Norm(final)=2.529 | acc=1.0000 | 4638.7 samples/s | 72.5 steps/s
[Step=9750 Epoch=19.0] | Loss=0.03063 | Reg=0.00208 | L2-Norm=14.410 | L2-Norm(final)=2.536 | acc=0.9688 | 5065.1 samples/s | 79.1 steps/s
[Step=9800 Epoch=19.1] | Loss=0.02816 | Reg=0.00208 | L2-Norm=14.423 | L2-Norm(final)=2.541 | acc=1.0000 | 4833.6 samples/s | 75.5 steps/s
[Step=9850 Epoch=19.2] | Loss=0.02688 | Reg=0.00208 | L2-Norm=14.436 | L2-Norm(final)=2.546 | acc=0.9688 | 4683.8 samples/s | 73.2 steps/s
[Step=9900 Epoch=19.3] | Loss=0.02614 | Reg=0.00209 | L2-Norm=14.449 | L2-Norm(final)=2.551 | acc=0.9844 | 4661.3 samples/s | 72.8 steps/s
[Step=9950 Epoch=19.4] | Loss=0.02588 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=2.556 | acc=0.9844 | 4943.5 samples/s | 77.2 steps/s
[Step=10000 Epoch=19.5] | Loss=0.02536 | Reg=0.00209 | L2-Norm=14.473 | L2-Norm(final)=2.559 | acc=0.9844 | 5005.2 samples/s | 78.2 steps/s
[Step=10050 Epoch=19.6] | Loss=0.02481 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=2.563 | acc=0.9844 | 5087.9 samples/s | 79.5 steps/s
[Step=10100 Epoch=19.7] | Loss=0.02480 | Reg=0.00210 | L2-Norm=14.495 | L2-Norm(final)=2.566 | acc=0.9844 | 6016.2 samples/s | 94.0 steps/s
[Step=10150 Epoch=19.8] | Loss=0.02425 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=2.568 | acc=1.0000 | 2033.6 samples/s | 31.8 steps/s
[Step=10200 Epoch=19.9] | Loss=0.02365 | Reg=0.00211 | L2-Norm=14.514 | L2-Norm(final)=2.570 | acc=1.0000 | 4987.8 samples/s | 77.9 steps/s
[Step=10250 Epoch=20.0] | Loss=0.02341 | Reg=0.00211 | L2-Norm=14.523 | L2-Norm(final)=2.572 | acc=1.0000 | 5076.0 samples/s | 79.3 steps/s
[Step=10300 Epoch=20.1] | Loss=0.02303 | Reg=0.00211 | L2-Norm=14.531 | L2-Norm(final)=2.574 | acc=1.0000 | 4972.8 samples/s | 77.7 steps/s
[Step=10350 Epoch=20.2] | Loss=0.02249 | Reg=0.00211 | L2-Norm=14.540 | L2-Norm(final)=2.576 | acc=0.9688 | 4958.5 samples/s | 77.5 steps/s
[Step=10400 Epoch=20.3] | Loss=0.02198 | Reg=0.00212 | L2-Norm=14.549 | L2-Norm(final)=2.579 | acc=0.9844 | 5022.3 samples/s | 78.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step10400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch=18.8] | Loss=0.25485 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=2.526 | acc=0.8594 | 4199.0 samples/s | 65.6 steps/s
[Step=9650 Epoch=18.9] | Loss=0.04078 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=2.519 | acc=0.9688 | 4908.7 samples/s | 76.7 steps/s
[Step=9700 Epoch=19.0] | Loss=0.03131 | Reg=0.00207 | L2-Norm=14.395 | L2-Norm(final)=2.530 | acc=1.0000 | 5059.2 samples/s | 79.1 steps/s
[Step=9750 Epoch=19.1] | Loss=0.02839 | Reg=0.00208 | L2-Norm=14.413 | L2-Norm(final)=2.535 | acc=0.9844 | 4918.3 samples/s | 76.8 steps/s
[Step=9800 Epoch=19.2] | Loss=0.02693 | Reg=0.00208 | L2-Norm=14.428 | L2-Norm(final)=2.537 | acc=0.9844 | 4975.0 samples/s | 77.7 steps/s
[Step=9850 Epoch=19.3] | Loss=0.02716 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=2.538 | acc=1.0000 | 4957.0 samples/s | 77.5 steps/s
[Step=9900 Epoch=19.4] | Loss=0.02611 | Reg=0.00209 | L2-Norm=14.452 | L2-Norm(final)=2.539 | acc=0.9844 | 5020.0 samples/s | 78.4 steps/s
[Step=9950 Epoch=19.5] | Loss=0.02474 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=2.541 | acc=0.9844 | 4950.5 samples/s | 77.4 steps/s
[Step=10000 Epoch=19.5] | Loss=0.02380 | Reg=0.00209 | L2-Norm=14.472 | L2-Norm(final)=2.544 | acc=0.9688 | 5081.2 samples/s | 79.4 steps/s
[Step=10050 Epoch=19.6] | Loss=0.02384 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=2.547 | acc=0.9688 | 5033.7 samples/s | 78.7 steps/s
[Step=10100 Epoch=19.7] | Loss=0.02340 | Reg=0.00210 | L2-Norm=14.490 | L2-Norm(final)=2.550 | acc=0.9844 | 6116.3 samples/s | 95.6 steps/s
[Step=10150 Epoch=19.8] | Loss=0.02254 | Reg=0.00210 | L2-Norm=14.499 | L2-Norm(final)=2.554 | acc=1.0000 | 2054.2 samples/s | 32.1 steps/s
[Step=10200 Epoch=19.9] | Loss=0.02185 | Reg=0.00210 | L2-Norm=14.508 | L2-Norm(final)=2.557 | acc=1.0000 | 5002.3 samples/s | 78.2 steps/s
[Step=10250 Epoch=20.0] | Loss=0.02135 | Reg=0.00211 | L2-Norm=14.516 | L2-Norm(final)=2.561 | acc=0.9688 | 4912.0 samples/s | 76.8 steps/s
[Step=10300 Epoch=20.1] | Loss=0.02063 | Reg=0.00211 | L2-Norm=14.524 | L2-Norm(final)=2.564 | acc=0.9844 | 4943.7 samples/s | 77.2 steps/s
[Step=10350 Epoch=20.2] | Loss=0.02019 | Reg=0.00211 | L2-Norm=14.531 | L2-Norm(final)=2.567 | acc=0.9844 | 4979.2 samples/s | 77.8 steps/s
[Step=10400 Epoch=20.3] | Loss=0.02030 | Reg=0.00211 | L2-Norm=14.539 | L2-Norm(final)=2.570 | acc=0.9688 | 4978.1 samples/s | 77.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step10400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch=36.8] | Loss=0.06405 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=2.526 | acc=0.9375 | 3714.9 samples/s | 58.0 steps/s
[Step=9650 Epoch=37.0] | Loss=0.00397 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=2.530 | acc=1.0000 | 4204.3 samples/s | 65.7 steps/s
[Step=9700 Epoch=37.2] | Loss=0.00358 | Reg=0.00208 | L2-Norm=14.411 | L2-Norm(final)=2.531 | acc=1.0000 | 4338.7 samples/s | 67.8 steps/s
[Step=9750 Epoch=37.4] | Loss=0.00272 | Reg=0.00208 | L2-Norm=14.421 | L2-Norm(final)=2.531 | acc=1.0000 | 4452.3 samples/s | 69.6 steps/s
[Step=9800 Epoch=37.6] | Loss=0.00212 | Reg=0.00208 | L2-Norm=14.423 | L2-Norm(final)=2.533 | acc=1.0000 | 4633.0 samples/s | 72.4 steps/s
[Step=9850 Epoch=37.7] | Loss=0.00178 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=2.536 | acc=1.0000 | 6000.5 samples/s | 93.8 steps/s
[Step=9900 Epoch=37.9] | Loss=0.00150 | Reg=0.00208 | L2-Norm=14.415 | L2-Norm(final)=2.539 | acc=1.0000 | 1956.6 samples/s | 30.6 steps/s
[Step=9950 Epoch=38.1] | Loss=0.00129 | Reg=0.00208 | L2-Norm=14.406 | L2-Norm(final)=2.542 | acc=1.0000 | 4696.3 samples/s | 73.4 steps/s
[Step=10000 Epoch=38.3] | Loss=0.00113 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=2.544 | acc=1.0000 | 4365.5 samples/s | 68.2 steps/s
[Step=10050 Epoch=38.5] | Loss=0.00100 | Reg=0.00207 | L2-Norm=14.384 | L2-Norm(final)=2.546 | acc=1.0000 | 4318.9 samples/s | 67.5 steps/s
[Step=10100 Epoch=38.7] | Loss=0.00090 | Reg=0.00207 | L2-Norm=14.372 | L2-Norm(final)=2.547 | acc=1.0000 | 4677.6 samples/s | 73.1 steps/s
[Step=10150 Epoch=38.9] | Loss=0.00082 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=2.549 | acc=1.0000 | 2032.4 samples/s | 31.8 steps/s
[Step=10200 Epoch=39.1] | Loss=0.00075 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=2.550 | acc=1.0000 | 4762.2 samples/s | 74.4 steps/s
[Step=10250 Epoch=39.3] | Loss=0.00070 | Reg=0.00205 | L2-Norm=14.331 | L2-Norm(final)=2.551 | acc=1.0000 | 4742.6 samples/s | 74.1 steps/s
[Step=10300 Epoch=39.5] | Loss=0.00065 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=2.552 | acc=1.0000 | 4701.5 samples/s | 73.5 steps/s
[Step=10350 Epoch=39.7] | Loss=0.00060 | Reg=0.00205 | L2-Norm=14.302 | L2-Norm(final)=2.553 | acc=1.0000 | 4662.3 samples/s | 72.8 steps/s
[Step=10400 Epoch=39.8] | Loss=0.00057 | Reg=0.00204 | L2-Norm=14.287 | L2-Norm(final)=2.554 | acc=1.0000 | 2186.5 samples/s | 34.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step10400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch=37.0] | Loss=0.17486 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=2.523 | acc=0.9375 | 3879.0 samples/s | 60.6 steps/s
[Step=9650 Epoch=37.1] | Loss=0.00734 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=2.505 | acc=1.0000 | 4920.3 samples/s | 76.9 steps/s
[Step=9700 Epoch=37.3] | Loss=0.00454 | Reg=0.00208 | L2-Norm=14.406 | L2-Norm(final)=2.510 | acc=1.0000 | 4725.3 samples/s | 73.8 steps/s
[Step=9750 Epoch=37.5] | Loss=0.00370 | Reg=0.00208 | L2-Norm=14.424 | L2-Norm(final)=2.514 | acc=1.0000 | 4686.4 samples/s | 73.2 steps/s
[Step=9800 Epoch=37.7] | Loss=0.00289 | Reg=0.00208 | L2-Norm=14.432 | L2-Norm(final)=2.515 | acc=1.0000 | 4714.8 samples/s | 73.7 steps/s
[Step=9850 Epoch=37.9] | Loss=0.00236 | Reg=0.00208 | L2-Norm=14.434 | L2-Norm(final)=2.518 | acc=1.0000 | 6070.3 samples/s | 94.8 steps/s
[Step=9900 Epoch=38.1] | Loss=0.00198 | Reg=0.00208 | L2-Norm=14.432 | L2-Norm(final)=2.520 | acc=1.0000 | 2001.9 samples/s | 31.3 steps/s
[Step=9950 Epoch=38.3] | Loss=0.00170 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=2.523 | acc=1.0000 | 4786.5 samples/s | 74.8 steps/s
[Step=10000 Epoch=38.5] | Loss=0.00149 | Reg=0.00208 | L2-Norm=14.418 | L2-Norm(final)=2.524 | acc=1.0000 | 4731.9 samples/s | 73.9 steps/s
[Step=10050 Epoch=38.7] | Loss=0.00133 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=2.526 | acc=1.0000 | 4819.2 samples/s | 75.3 steps/s
[Step=10100 Epoch=38.9] | Loss=0.00120 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=2.528 | acc=1.0000 | 5342.4 samples/s | 83.5 steps/s
[Step=10150 Epoch=39.1] | Loss=0.00109 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=2.529 | acc=1.0000 | 2078.1 samples/s | 32.5 steps/s
[Step=10200 Epoch=39.3] | Loss=0.00100 | Reg=0.00207 | L2-Norm=14.370 | L2-Norm(final)=2.530 | acc=1.0000 | 4832.8 samples/s | 75.5 steps/s
[Step=10250 Epoch=39.5] | Loss=0.00092 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=2.531 | acc=1.0000 | 4651.6 samples/s | 72.7 steps/s
[Step=10300 Epoch=39.6] | Loss=0.00086 | Reg=0.00206 | L2-Norm=14.342 | L2-Norm(final)=2.532 | acc=1.0000 | 4694.8 samples/s | 73.4 steps/s
[Step=10350 Epoch=39.8] | Loss=0.00080 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=2.533 | acc=1.0000 | 4814.2 samples/s | 75.2 steps/s
[Step=10400 Epoch=40.0] | Loss=0.00075 | Reg=0.00205 | L2-Norm=14.312 | L2-Norm(final)=2.534 | acc=1.0000 | 2180.6 samples/s | 34.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29930 | acc=0.8200 | tpr=0.7451 | fpr=0.0173 | 4483.0 samples/s | 17.5 steps/s
Avg test loss: 0.30482, Avg test acc: 0.81878, Avg tpr: 0.74529, Avg fpr: 0.01961, total FA: 153

Testing server on iccad2012
[Step=  50] | Loss=0.33160 | acc=0.8760 | tpr=0.9646 | fpr=0.1256 | 4553.0 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.33317 | acc=0.8776 | tpr=0.9787 | fpr=0.1243 | 8891.6 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.33810 | acc=0.8771 | tpr=0.9827 | fpr=0.1249 | 8912.5 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.33858 | acc=0.8782 | tpr=0.9814 | fpr=0.1237 | 8710.9 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.33724 | acc=0.8781 | tpr=0.9834 | fpr=0.1239 | 8842.2 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.34076 | acc=0.8776 | tpr=0.9833 | fpr=0.1244 | 9021.1 samples/s | 35.2 steps/s
[Step= 350] | Loss=0.34190 | acc=0.8774 | tpr=0.9831 | fpr=0.1245 | 8791.3 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.34356 | acc=0.8770 | tpr=0.9809 | fpr=0.1249 | 8955.2 samples/s | 35.0 steps/s
[Step= 450] | Loss=0.34786 | acc=0.8767 | tpr=0.9800 | fpr=0.1252 | 8591.9 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.34851 | acc=0.8765 | tpr=0.9806 | fpr=0.1254 | 8562.5 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.34812 | acc=0.8763 | tpr=0.9793 | fpr=0.1256 | 15562.7 samples/s | 60.8 steps/s
Avg test loss: 0.34794, Avg test acc: 0.87623, Avg tpr: 0.97900, Avg fpr: 0.12564, total FA: 17445

server round 13/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=20.3] | Loss=0.10511 | Reg=0.00201 | L2-Norm=14.194 | L2-Norm(final)=2.584 | acc=0.8906 | 3933.8 samples/s | 61.5 steps/s
[Step=10450 Epoch=20.4] | Loss=0.04573 | Reg=0.00203 | L2-Norm=14.263 | L2-Norm(final)=2.565 | acc=0.9062 | 4425.4 samples/s | 69.1 steps/s
[Step=10500 Epoch=20.5] | Loss=0.03444 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=2.576 | acc=0.9688 | 4576.9 samples/s | 71.5 steps/s
[Step=10550 Epoch=20.6] | Loss=0.03002 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=2.586 | acc=1.0000 | 4634.8 samples/s | 72.4 steps/s
[Step=10600 Epoch=20.7] | Loss=0.02862 | Reg=0.00205 | L2-Norm=14.333 | L2-Norm(final)=2.591 | acc=0.9844 | 4723.7 samples/s | 73.8 steps/s
[Step=10650 Epoch=20.8] | Loss=0.02682 | Reg=0.00206 | L2-Norm=14.348 | L2-Norm(final)=2.596 | acc=0.9531 | 4784.3 samples/s | 74.8 steps/s
[Step=10700 Epoch=20.9] | Loss=0.02632 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=2.599 | acc=1.0000 | 4825.5 samples/s | 75.4 steps/s
[Step=10750 Epoch=21.0] | Loss=0.02542 | Reg=0.00207 | L2-Norm=14.372 | L2-Norm(final)=2.602 | acc=1.0000 | 4788.0 samples/s | 74.8 steps/s
[Step=10800 Epoch=21.1] | Loss=0.02497 | Reg=0.00207 | L2-Norm=14.384 | L2-Norm(final)=2.605 | acc=0.9844 | 4524.7 samples/s | 70.7 steps/s
[Step=10850 Epoch=21.2] | Loss=0.02502 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=2.607 | acc=0.9844 | 4663.0 samples/s | 72.9 steps/s
[Step=10900 Epoch=21.3] | Loss=0.02419 | Reg=0.00208 | L2-Norm=14.405 | L2-Norm(final)=2.609 | acc=1.0000 | 5280.9 samples/s | 82.5 steps/s
[Step=10950 Epoch=21.4] | Loss=0.02338 | Reg=0.00208 | L2-Norm=14.415 | L2-Norm(final)=2.612 | acc=0.9844 | 1908.8 samples/s | 29.8 steps/s
[Step=11000 Epoch=21.5] | Loss=0.02236 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=2.616 | acc=1.0000 | 4907.9 samples/s | 76.7 steps/s
[Step=11050 Epoch=21.6] | Loss=0.02211 | Reg=0.00208 | L2-Norm=14.437 | L2-Norm(final)=2.620 | acc=1.0000 | 4962.5 samples/s | 77.5 steps/s
[Step=11100 Epoch=21.6] | Loss=0.02166 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=2.623 | acc=0.9844 | 4904.3 samples/s | 76.6 steps/s
[Step=11150 Epoch=21.7] | Loss=0.02133 | Reg=0.00209 | L2-Norm=14.457 | L2-Norm(final)=2.627 | acc=1.0000 | 4941.5 samples/s | 77.2 steps/s
[Step=11200 Epoch=21.8] | Loss=0.02088 | Reg=0.00209 | L2-Norm=14.466 | L2-Norm(final)=2.630 | acc=0.9844 | 4953.0 samples/s | 77.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step11200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=20.3] | Loss=0.19012 | Reg=0.00201 | L2-Norm=14.194 | L2-Norm(final)=2.584 | acc=0.8594 | 4466.4 samples/s | 69.8 steps/s
[Step=10450 Epoch=20.4] | Loss=0.03302 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=2.582 | acc=0.9375 | 4693.8 samples/s | 73.3 steps/s
[Step=10500 Epoch=20.5] | Loss=0.02714 | Reg=0.00203 | L2-Norm=14.262 | L2-Norm(final)=2.590 | acc=0.9844 | 4924.3 samples/s | 76.9 steps/s
[Step=10550 Epoch=20.6] | Loss=0.02527 | Reg=0.00204 | L2-Norm=14.278 | L2-Norm(final)=2.595 | acc=1.0000 | 4944.3 samples/s | 77.3 steps/s
[Step=10600 Epoch=20.7] | Loss=0.02533 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=2.597 | acc=0.9844 | 4961.7 samples/s | 77.5 steps/s
[Step=10650 Epoch=20.8] | Loss=0.02445 | Reg=0.00205 | L2-Norm=14.306 | L2-Norm(final)=2.599 | acc=1.0000 | 5047.7 samples/s | 78.9 steps/s
[Step=10700 Epoch=20.9] | Loss=0.02364 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=2.603 | acc=0.9688 | 5036.9 samples/s | 78.7 steps/s
[Step=10750 Epoch=21.0] | Loss=0.02275 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=2.606 | acc=0.9844 | 5018.8 samples/s | 78.4 steps/s
[Step=10800 Epoch=21.1] | Loss=0.02240 | Reg=0.00206 | L2-Norm=14.344 | L2-Norm(final)=2.609 | acc=0.9688 | 4976.7 samples/s | 77.8 steps/s
[Step=10850 Epoch=21.2] | Loss=0.02245 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=2.611 | acc=0.9688 | 5008.9 samples/s | 78.3 steps/s
[Step=10900 Epoch=21.3] | Loss=0.02217 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=2.614 | acc=0.9688 | 6193.0 samples/s | 96.8 steps/s
[Step=10950 Epoch=21.4] | Loss=0.02171 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=2.617 | acc=0.9844 | 2078.8 samples/s | 32.5 steps/s
[Step=11000 Epoch=21.5] | Loss=0.02114 | Reg=0.00207 | L2-Norm=14.392 | L2-Norm(final)=2.620 | acc=1.0000 | 4916.8 samples/s | 76.8 steps/s
[Step=11050 Epoch=21.6] | Loss=0.02103 | Reg=0.00207 | L2-Norm=14.402 | L2-Norm(final)=2.623 | acc=1.0000 | 4991.8 samples/s | 78.0 steps/s
[Step=11100 Epoch=21.7] | Loss=0.02067 | Reg=0.00208 | L2-Norm=14.412 | L2-Norm(final)=2.626 | acc=0.9375 | 5008.2 samples/s | 78.3 steps/s
[Step=11150 Epoch=21.8] | Loss=0.02035 | Reg=0.00208 | L2-Norm=14.422 | L2-Norm(final)=2.629 | acc=1.0000 | 5032.9 samples/s | 78.6 steps/s
[Step=11200 Epoch=21.9] | Loss=0.02003 | Reg=0.00208 | L2-Norm=14.431 | L2-Norm(final)=2.633 | acc=0.9844 | 4979.5 samples/s | 77.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step11200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=39.9] | Loss=0.05368 | Reg=0.00201 | L2-Norm=14.194 | L2-Norm(final)=2.584 | acc=0.9688 | 4142.4 samples/s | 64.7 steps/s
[Step=10450 Epoch=40.0] | Loss=0.00890 | Reg=0.00205 | L2-Norm=14.305 | L2-Norm(final)=2.567 | acc=1.0000 | 4473.4 samples/s | 69.9 steps/s
[Step=10500 Epoch=40.2] | Loss=0.00628 | Reg=0.00206 | L2-Norm=14.350 | L2-Norm(final)=2.559 | acc=1.0000 | 4663.3 samples/s | 72.9 steps/s
[Step=10550 Epoch=40.4] | Loss=0.00445 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=2.558 | acc=1.0000 | 4707.1 samples/s | 73.5 steps/s
[Step=10600 Epoch=40.6] | Loss=0.00336 | Reg=0.00207 | L2-Norm=14.370 | L2-Norm(final)=2.560 | acc=1.0000 | 4788.8 samples/s | 74.8 steps/s
[Step=10650 Epoch=40.8] | Loss=0.00270 | Reg=0.00206 | L2-Norm=14.368 | L2-Norm(final)=2.563 | acc=1.0000 | 5971.5 samples/s | 93.3 steps/s
[Step=10700 Epoch=41.0] | Loss=0.00234 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=2.566 | acc=1.0000 | 2027.1 samples/s | 31.7 steps/s
[Step=10750 Epoch=41.2] | Loss=0.00201 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=2.568 | acc=1.0000 | 4790.4 samples/s | 74.8 steps/s
[Step=10800 Epoch=41.4] | Loss=0.00177 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=2.571 | acc=1.0000 | 4754.0 samples/s | 74.3 steps/s
[Step=10850 Epoch=41.6] | Loss=0.00157 | Reg=0.00206 | L2-Norm=14.340 | L2-Norm(final)=2.573 | acc=1.0000 | 4755.6 samples/s | 74.3 steps/s
[Step=10900 Epoch=41.8] | Loss=0.00142 | Reg=0.00205 | L2-Norm=14.330 | L2-Norm(final)=2.575 | acc=1.0000 | 5152.4 samples/s | 80.5 steps/s
[Step=10950 Epoch=42.0] | Loss=0.00129 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=2.577 | acc=1.0000 | 2073.3 samples/s | 32.4 steps/s
[Step=11000 Epoch=42.1] | Loss=0.00118 | Reg=0.00205 | L2-Norm=14.307 | L2-Norm(final)=2.578 | acc=1.0000 | 4778.6 samples/s | 74.7 steps/s
[Step=11050 Epoch=42.3] | Loss=0.00109 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=2.579 | acc=1.0000 | 4774.5 samples/s | 74.6 steps/s
[Step=11100 Epoch=42.5] | Loss=0.00101 | Reg=0.00204 | L2-Norm=14.282 | L2-Norm(final)=2.581 | acc=1.0000 | 4701.7 samples/s | 73.5 steps/s
[Step=11150 Epoch=42.7] | Loss=0.00095 | Reg=0.00204 | L2-Norm=14.269 | L2-Norm(final)=2.582 | acc=1.0000 | 4742.7 samples/s | 74.1 steps/s
[Step=11200 Epoch=42.9] | Loss=0.00089 | Reg=0.00203 | L2-Norm=14.255 | L2-Norm(final)=2.584 | acc=1.0000 | 2175.0 samples/s | 34.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step11200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=40.0] | Loss=0.01614 | Reg=0.00201 | L2-Norm=14.194 | L2-Norm(final)=2.585 | acc=0.9844 | 4476.4 samples/s | 69.9 steps/s
[Step=10450 Epoch=40.2] | Loss=0.00355 | Reg=0.00204 | L2-Norm=14.266 | L2-Norm(final)=2.603 | acc=1.0000 | 4512.1 samples/s | 70.5 steps/s
[Step=10500 Epoch=40.4] | Loss=0.00236 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=2.601 | acc=1.0000 | 4702.9 samples/s | 73.5 steps/s
[Step=10550 Epoch=40.6] | Loss=0.00166 | Reg=0.00204 | L2-Norm=14.300 | L2-Norm(final)=2.604 | acc=1.0000 | 4788.9 samples/s | 74.8 steps/s
[Step=10600 Epoch=40.8] | Loss=0.00148 | Reg=0.00205 | L2-Norm=14.301 | L2-Norm(final)=2.607 | acc=1.0000 | 4620.2 samples/s | 72.2 steps/s
[Step=10650 Epoch=41.0] | Loss=0.00123 | Reg=0.00205 | L2-Norm=14.305 | L2-Norm(final)=2.611 | acc=1.0000 | 6108.1 samples/s | 95.4 steps/s
[Step=10700 Epoch=41.2] | Loss=0.00103 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=2.614 | acc=1.0000 | 1993.3 samples/s | 31.1 steps/s
[Step=10750 Epoch=41.4] | Loss=0.00089 | Reg=0.00204 | L2-Norm=14.298 | L2-Norm(final)=2.617 | acc=1.0000 | 4751.6 samples/s | 74.2 steps/s
[Step=10800 Epoch=41.6] | Loss=0.00080 | Reg=0.00204 | L2-Norm=14.290 | L2-Norm(final)=2.620 | acc=1.0000 | 4733.0 samples/s | 74.0 steps/s
[Step=10850 Epoch=41.8] | Loss=0.00071 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=2.622 | acc=1.0000 | 4823.2 samples/s | 75.4 steps/s
[Step=10900 Epoch=42.0] | Loss=0.00064 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=2.624 | acc=1.0000 | 5321.4 samples/s | 83.1 steps/s
[Step=10950 Epoch=42.2] | Loss=0.00060 | Reg=0.00203 | L2-Norm=14.261 | L2-Norm(final)=2.626 | acc=1.0000 | 2096.5 samples/s | 32.8 steps/s
[Step=11000 Epoch=42.3] | Loss=0.00055 | Reg=0.00203 | L2-Norm=14.251 | L2-Norm(final)=2.628 | acc=1.0000 | 4777.9 samples/s | 74.7 steps/s
[Step=11050 Epoch=42.5] | Loss=0.00051 | Reg=0.00203 | L2-Norm=14.239 | L2-Norm(final)=2.630 | acc=1.0000 | 4675.7 samples/s | 73.1 steps/s
[Step=11100 Epoch=42.7] | Loss=0.00048 | Reg=0.00202 | L2-Norm=14.227 | L2-Norm(final)=2.631 | acc=1.0000 | 4684.0 samples/s | 73.2 steps/s
[Step=11150 Epoch=42.9] | Loss=0.00044 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=2.633 | acc=1.0000 | 4766.2 samples/s | 74.5 steps/s
[Step=11200 Epoch=43.1] | Loss=0.00042 | Reg=0.00202 | L2-Norm=14.200 | L2-Norm(final)=2.634 | acc=1.0000 | 2184.0 samples/s | 34.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33851 | acc=0.8066 | tpr=0.7230 | fpr=0.0116 | 4566.2 samples/s | 17.8 steps/s
Avg test loss: 0.34180, Avg test acc: 0.80519, Avg tpr: 0.72262, Avg fpr: 0.01320, total FA: 103

Testing server on iccad2012
[Step=  50] | Loss=0.30686 | acc=0.8931 | tpr=0.9558 | fpr=0.1080 | 4808.6 samples/s | 18.8 steps/s
[Step= 100] | Loss=0.30824 | acc=0.8936 | tpr=0.9723 | fpr=0.1079 | 7972.0 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.31397 | acc=0.8928 | tpr=0.9769 | fpr=0.1088 | 8993.0 samples/s | 35.1 steps/s
[Step= 200] | Loss=0.31500 | acc=0.8923 | tpr=0.9770 | fpr=0.1092 | 9213.3 samples/s | 36.0 steps/s
[Step= 250] | Loss=0.31370 | acc=0.8925 | tpr=0.9799 | fpr=0.1091 | 8179.2 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.31729 | acc=0.8919 | tpr=0.9804 | fpr=0.1097 | 8900.6 samples/s | 34.8 steps/s
[Step= 350] | Loss=0.31894 | acc=0.8915 | tpr=0.9781 | fpr=0.1101 | 9223.4 samples/s | 36.0 steps/s
[Step= 400] | Loss=0.32065 | acc=0.8911 | tpr=0.9759 | fpr=0.1104 | 8830.2 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.32538 | acc=0.8906 | tpr=0.9752 | fpr=0.1109 | 8369.5 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.32589 | acc=0.8904 | tpr=0.9753 | fpr=0.1111 | 9027.7 samples/s | 35.3 steps/s
[Step= 550] | Loss=0.32553 | acc=0.8900 | tpr=0.9741 | fpr=0.1115 | 15893.5 samples/s | 62.1 steps/s
Avg test loss: 0.32538, Avg test acc: 0.88999, Avg tpr: 0.97385, Avg fpr: 0.11153, total FA: 15486

server round 14/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=21.8] | Loss=0.22789 | Reg=0.00200 | L2-Norm=14.128 | L2-Norm(final)=2.654 | acc=0.8125 | 3824.9 samples/s | 59.8 steps/s
[Step=11250 Epoch=21.9] | Loss=0.04193 | Reg=0.00202 | L2-Norm=14.204 | L2-Norm(final)=2.637 | acc=1.0000 | 4978.9 samples/s | 77.8 steps/s
[Step=11300 Epoch=22.0] | Loss=0.03105 | Reg=0.00203 | L2-Norm=14.238 | L2-Norm(final)=2.643 | acc=1.0000 | 4968.4 samples/s | 77.6 steps/s
[Step=11350 Epoch=22.1] | Loss=0.02726 | Reg=0.00203 | L2-Norm=14.257 | L2-Norm(final)=2.649 | acc=1.0000 | 4949.0 samples/s | 77.3 steps/s
[Step=11400 Epoch=22.2] | Loss=0.02544 | Reg=0.00204 | L2-Norm=14.272 | L2-Norm(final)=2.654 | acc=1.0000 | 4991.7 samples/s | 78.0 steps/s
[Step=11450 Epoch=22.3] | Loss=0.02442 | Reg=0.00204 | L2-Norm=14.286 | L2-Norm(final)=2.657 | acc=1.0000 | 5032.0 samples/s | 78.6 steps/s
[Step=11500 Epoch=22.4] | Loss=0.02362 | Reg=0.00204 | L2-Norm=14.299 | L2-Norm(final)=2.660 | acc=0.9844 | 5026.5 samples/s | 78.5 steps/s
[Step=11550 Epoch=22.5] | Loss=0.02348 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=2.663 | acc=1.0000 | 4982.7 samples/s | 77.9 steps/s
[Step=11600 Epoch=22.6] | Loss=0.02331 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=2.665 | acc=0.9844 | 5113.6 samples/s | 79.9 steps/s
[Step=11650 Epoch=22.7] | Loss=0.02309 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=2.667 | acc=0.9531 | 4978.2 samples/s | 77.8 steps/s
[Step=11700 Epoch=22.8] | Loss=0.02253 | Reg=0.00206 | L2-Norm=14.341 | L2-Norm(final)=2.669 | acc=0.9844 | 6127.6 samples/s | 95.7 steps/s
[Step=11750 Epoch=22.9] | Loss=0.02212 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=2.670 | acc=0.9844 | 2010.2 samples/s | 31.4 steps/s
[Step=11800 Epoch=23.0] | Loss=0.02160 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=2.672 | acc=1.0000 | 4995.4 samples/s | 78.1 steps/s
[Step=11850 Epoch=23.1] | Loss=0.02098 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=2.675 | acc=1.0000 | 4740.6 samples/s | 74.1 steps/s
[Step=11900 Epoch=23.2] | Loss=0.02055 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=2.677 | acc=0.9844 | 4399.3 samples/s | 68.7 steps/s
[Step=11950 Epoch=23.3] | Loss=0.02008 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=2.680 | acc=0.9844 | 4245.7 samples/s | 66.3 steps/s
[Step=12000 Epoch=23.4] | Loss=0.01968 | Reg=0.00207 | L2-Norm=14.388 | L2-Norm(final)=2.683 | acc=1.0000 | 4379.2 samples/s | 68.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=21.9] | Loss=0.35520 | Reg=0.00200 | L2-Norm=14.128 | L2-Norm(final)=2.653 | acc=0.7969 | 4001.5 samples/s | 62.5 steps/s
[Step=11250 Epoch=22.0] | Loss=0.03754 | Reg=0.00201 | L2-Norm=14.195 | L2-Norm(final)=2.645 | acc=1.0000 | 4592.8 samples/s | 71.8 steps/s
[Step=11300 Epoch=22.1] | Loss=0.02791 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=2.655 | acc=1.0000 | 4593.9 samples/s | 71.8 steps/s
[Step=11350 Epoch=22.2] | Loss=0.02709 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=2.659 | acc=1.0000 | 4561.2 samples/s | 71.3 steps/s
[Step=11400 Epoch=22.3] | Loss=0.02457 | Reg=0.00203 | L2-Norm=14.262 | L2-Norm(final)=2.664 | acc=0.9688 | 4376.6 samples/s | 68.4 steps/s
[Step=11450 Epoch=22.4] | Loss=0.02312 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=2.670 | acc=0.9688 | 4575.7 samples/s | 71.5 steps/s
[Step=11500 Epoch=22.5] | Loss=0.02293 | Reg=0.00204 | L2-Norm=14.289 | L2-Norm(final)=2.675 | acc=0.9844 | 5022.4 samples/s | 78.5 steps/s
[Step=11550 Epoch=22.6] | Loss=0.02191 | Reg=0.00205 | L2-Norm=14.301 | L2-Norm(final)=2.679 | acc=0.9844 | 4958.4 samples/s | 77.5 steps/s
[Step=11600 Epoch=22.7] | Loss=0.02150 | Reg=0.00205 | L2-Norm=14.312 | L2-Norm(final)=2.682 | acc=1.0000 | 4979.3 samples/s | 77.8 steps/s
[Step=11650 Epoch=22.8] | Loss=0.02157 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=2.685 | acc=0.9844 | 4941.5 samples/s | 77.2 steps/s
[Step=11700 Epoch=22.9] | Loss=0.02165 | Reg=0.00205 | L2-Norm=14.335 | L2-Norm(final)=2.688 | acc=1.0000 | 6128.2 samples/s | 95.8 steps/s
[Step=11750 Epoch=23.0] | Loss=0.02097 | Reg=0.00206 | L2-Norm=14.346 | L2-Norm(final)=2.691 | acc=1.0000 | 2080.8 samples/s | 32.5 steps/s
[Step=11800 Epoch=23.1] | Loss=0.02045 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=2.695 | acc=1.0000 | 5055.8 samples/s | 79.0 steps/s
[Step=11850 Epoch=23.2] | Loss=0.02022 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=2.698 | acc=1.0000 | 4879.6 samples/s | 76.2 steps/s
[Step=11900 Epoch=23.3] | Loss=0.01975 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=2.701 | acc=1.0000 | 4959.5 samples/s | 77.5 steps/s
[Step=11950 Epoch=23.4] | Loss=0.01959 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=2.704 | acc=0.9531 | 4973.1 samples/s | 77.7 steps/s
[Step=12000 Epoch=23.5] | Loss=0.01934 | Reg=0.00207 | L2-Norm=14.391 | L2-Norm(final)=2.707 | acc=1.0000 | 4642.5 samples/s | 72.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step12000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=42.9] | Loss=0.01187 | Reg=0.00200 | L2-Norm=14.128 | L2-Norm(final)=2.655 | acc=0.9844 | 4155.7 samples/s | 64.9 steps/s
[Step=11250 Epoch=43.1] | Loss=0.00619 | Reg=0.00202 | L2-Norm=14.223 | L2-Norm(final)=2.650 | acc=1.0000 | 4320.5 samples/s | 67.5 steps/s
[Step=11300 Epoch=43.3] | Loss=0.00353 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=2.647 | acc=1.0000 | 4462.9 samples/s | 69.7 steps/s
[Step=11350 Epoch=43.5] | Loss=0.00240 | Reg=0.00204 | L2-Norm=14.288 | L2-Norm(final)=2.651 | acc=1.0000 | 3775.0 samples/s | 59.0 steps/s
[Step=11400 Epoch=43.7] | Loss=0.00182 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=2.655 | acc=1.0000 | 4291.2 samples/s | 67.1 steps/s
[Step=11450 Epoch=43.9] | Loss=0.00187 | Reg=0.00204 | L2-Norm=14.289 | L2-Norm(final)=2.657 | acc=1.0000 | 5796.1 samples/s | 90.6 steps/s
[Step=11500 Epoch=44.1] | Loss=0.00166 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=2.658 | acc=1.0000 | 1950.3 samples/s | 30.5 steps/s
[Step=11550 Epoch=44.3] | Loss=0.00149 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=2.661 | acc=1.0000 | 4468.8 samples/s | 69.8 steps/s
[Step=11600 Epoch=44.4] | Loss=0.00131 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=2.663 | acc=1.0000 | 4449.9 samples/s | 69.5 steps/s
[Step=11650 Epoch=44.6] | Loss=0.00119 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=2.665 | acc=1.0000 | 4426.9 samples/s | 69.2 steps/s
[Step=11700 Epoch=44.8] | Loss=0.00107 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=2.666 | acc=1.0000 | 4885.8 samples/s | 76.3 steps/s
[Step=11750 Epoch=45.0] | Loss=0.00098 | Reg=0.00204 | L2-Norm=14.285 | L2-Norm(final)=2.668 | acc=1.0000 | 2020.5 samples/s | 31.6 steps/s
[Step=11800 Epoch=45.2] | Loss=0.00090 | Reg=0.00204 | L2-Norm=14.279 | L2-Norm(final)=2.670 | acc=1.0000 | 4361.5 samples/s | 68.1 steps/s
[Step=11850 Epoch=45.4] | Loss=0.00083 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=2.671 | acc=1.0000 | 4400.8 samples/s | 68.8 steps/s
[Step=11900 Epoch=45.6] | Loss=0.00077 | Reg=0.00203 | L2-Norm=14.262 | L2-Norm(final)=2.672 | acc=1.0000 | 4467.0 samples/s | 69.8 steps/s
[Step=11950 Epoch=45.8] | Loss=0.00072 | Reg=0.00203 | L2-Norm=14.253 | L2-Norm(final)=2.674 | acc=1.0000 | 4401.7 samples/s | 68.8 steps/s
[Step=12000 Epoch=46.0] | Loss=0.00067 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=2.675 | acc=1.0000 | 2052.7 samples/s | 32.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=43.1] | Loss=0.00896 | Reg=0.00200 | L2-Norm=14.128 | L2-Norm(final)=2.656 | acc=1.0000 | 4021.6 samples/s | 62.8 steps/s
[Step=11250 Epoch=43.3] | Loss=0.00144 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=2.678 | acc=1.0000 | 4270.6 samples/s | 66.7 steps/s
[Step=11300 Epoch=43.5] | Loss=0.00097 | Reg=0.00202 | L2-Norm=14.199 | L2-Norm(final)=2.688 | acc=1.0000 | 4442.2 samples/s | 69.4 steps/s
[Step=11350 Epoch=43.7] | Loss=0.00077 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=2.694 | acc=1.0000 | 4417.5 samples/s | 69.0 steps/s
[Step=11400 Epoch=43.9] | Loss=0.00059 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=2.698 | acc=1.0000 | 4360.7 samples/s | 68.1 steps/s
[Step=11450 Epoch=44.1] | Loss=0.00048 | Reg=0.00202 | L2-Norm=14.198 | L2-Norm(final)=2.702 | acc=1.0000 | 5646.0 samples/s | 88.2 steps/s
[Step=11500 Epoch=44.3] | Loss=0.00040 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=2.704 | acc=1.0000 | 1899.5 samples/s | 29.7 steps/s
[Step=11550 Epoch=44.5] | Loss=0.00034 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=2.707 | acc=1.0000 | 4466.3 samples/s | 69.8 steps/s
[Step=11600 Epoch=44.7] | Loss=0.00045 | Reg=0.00201 | L2-Norm=14.165 | L2-Norm(final)=2.707 | acc=1.0000 | 4380.0 samples/s | 68.4 steps/s
[Step=11650 Epoch=44.8] | Loss=0.00116 | Reg=0.00201 | L2-Norm=14.163 | L2-Norm(final)=2.706 | acc=1.0000 | 4302.8 samples/s | 67.2 steps/s
[Step=11700 Epoch=45.0] | Loss=0.00178 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=2.698 | acc=0.9844 | 4548.7 samples/s | 71.1 steps/s
[Step=11750 Epoch=45.2] | Loss=0.00199 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=2.686 | acc=1.0000 | 1858.6 samples/s | 29.0 steps/s
[Step=11800 Epoch=45.4] | Loss=0.00185 | Reg=0.00201 | L2-Norm=14.192 | L2-Norm(final)=2.677 | acc=1.0000 | 4320.7 samples/s | 67.5 steps/s
[Step=11850 Epoch=45.6] | Loss=0.00171 | Reg=0.00202 | L2-Norm=14.200 | L2-Norm(final)=2.670 | acc=1.0000 | 4314.0 samples/s | 67.4 steps/s
[Step=11900 Epoch=45.8] | Loss=0.00159 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=2.663 | acc=1.0000 | 4411.5 samples/s | 68.9 steps/s
[Step=11950 Epoch=46.0] | Loss=0.00149 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=2.658 | acc=1.0000 | 4467.2 samples/s | 69.8 steps/s
[Step=12000 Epoch=46.2] | Loss=0.00140 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=2.654 | acc=1.0000 | 2077.2 samples/s | 32.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29057 | acc=0.8170 | tpr=0.7401 | fpr=0.0159 | 4245.6 samples/s | 16.6 steps/s
Avg test loss: 0.29277, Avg test acc: 0.81797, Avg tpr: 0.74308, Avg fpr: 0.01731, total FA: 135

Testing server on iccad2012
[Step=  50] | Loss=0.32492 | acc=0.8822 | tpr=0.9513 | fpr=0.1191 | 3932.6 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.32804 | acc=0.8812 | tpr=0.9701 | fpr=0.1204 | 7999.8 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.33353 | acc=0.8798 | tpr=0.9769 | fpr=0.1220 | 7675.5 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.33412 | acc=0.8808 | tpr=0.9781 | fpr=0.1210 | 7212.7 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.33246 | acc=0.8812 | tpr=0.9808 | fpr=0.1206 | 7822.5 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.33681 | acc=0.8808 | tpr=0.9811 | fpr=0.1210 | 7521.4 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.33875 | acc=0.8806 | tpr=0.9806 | fpr=0.1212 | 7610.7 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.34051 | acc=0.8803 | tpr=0.9792 | fpr=0.1215 | 7824.5 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.34517 | acc=0.8799 | tpr=0.9791 | fpr=0.1219 | 7662.6 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.34543 | acc=0.8795 | tpr=0.9797 | fpr=0.1223 | 7047.9 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.34482 | acc=0.8794 | tpr=0.9797 | fpr=0.1224 | 14154.1 samples/s | 55.3 steps/s
Avg test loss: 0.34457, Avg test acc: 0.87937, Avg tpr: 0.97940, Avg fpr: 0.12245, total FA: 17002

server round 15/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=23.4] | Loss=0.18934 | Reg=0.00199 | L2-Norm=14.120 | L2-Norm(final)=2.689 | acc=0.8750 | 3675.2 samples/s | 57.4 steps/s
[Step=12050 Epoch=23.5] | Loss=0.04046 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=2.678 | acc=1.0000 | 4130.3 samples/s | 64.5 steps/s
[Step=12100 Epoch=23.6] | Loss=0.03195 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=2.681 | acc=0.9844 | 4190.0 samples/s | 65.5 steps/s
[Step=12150 Epoch=23.7] | Loss=0.02752 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=2.689 | acc=0.9375 | 4221.6 samples/s | 66.0 steps/s
[Step=12200 Epoch=23.8] | Loss=0.02698 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=2.691 | acc=1.0000 | 4319.3 samples/s | 67.5 steps/s
[Step=12250 Epoch=23.9] | Loss=0.02574 | Reg=0.00203 | L2-Norm=14.259 | L2-Norm(final)=2.694 | acc=0.9375 | 4347.2 samples/s | 67.9 steps/s
[Step=12300 Epoch=24.0] | Loss=0.02500 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=2.696 | acc=0.9844 | 4386.5 samples/s | 68.5 steps/s
[Step=12350 Epoch=24.1] | Loss=0.02401 | Reg=0.00204 | L2-Norm=14.283 | L2-Norm(final)=2.699 | acc=1.0000 | 4475.2 samples/s | 69.9 steps/s
[Step=12400 Epoch=24.2] | Loss=0.02337 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=2.701 | acc=0.9844 | 4244.0 samples/s | 66.3 steps/s
[Step=12450 Epoch=24.3] | Loss=0.02346 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=2.702 | acc=1.0000 | 4327.4 samples/s | 67.6 steps/s
[Step=12500 Epoch=24.4] | Loss=0.02357 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=2.703 | acc=0.9531 | 5564.8 samples/s | 87.0 steps/s
[Step=12550 Epoch=24.5] | Loss=0.02307 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=2.703 | acc=0.9844 | 1831.6 samples/s | 28.6 steps/s
[Step=12600 Epoch=24.6] | Loss=0.02268 | Reg=0.00205 | L2-Norm=14.331 | L2-Norm(final)=2.704 | acc=0.9844 | 4124.3 samples/s | 64.4 steps/s
[Step=12650 Epoch=24.7] | Loss=0.02185 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=2.705 | acc=1.0000 | 4248.7 samples/s | 66.4 steps/s
[Step=12700 Epoch=24.8] | Loss=0.02112 | Reg=0.00206 | L2-Norm=14.347 | L2-Norm(final)=2.707 | acc=0.9531 | 4384.7 samples/s | 68.5 steps/s
[Step=12750 Epoch=24.9] | Loss=0.02064 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=2.710 | acc=1.0000 | 4483.3 samples/s | 70.1 steps/s
[Step=12800 Epoch=25.0] | Loss=0.02059 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=2.711 | acc=0.9688 | 4458.6 samples/s | 69.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=23.5] | Loss=0.13403 | Reg=0.00199 | L2-Norm=14.120 | L2-Norm(final)=2.688 | acc=0.8906 | 3900.3 samples/s | 60.9 steps/s
[Step=12050 Epoch=23.6] | Loss=0.04149 | Reg=0.00201 | L2-Norm=14.185 | L2-Norm(final)=2.671 | acc=0.9844 | 4556.7 samples/s | 71.2 steps/s
[Step=12100 Epoch=23.7] | Loss=0.03135 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=2.676 | acc=0.9844 | 4564.4 samples/s | 71.3 steps/s
[Step=12150 Epoch=23.8] | Loss=0.02740 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=2.682 | acc=0.9688 | 4719.3 samples/s | 73.7 steps/s
[Step=12200 Epoch=23.9] | Loss=0.02619 | Reg=0.00203 | L2-Norm=14.240 | L2-Norm(final)=2.688 | acc=0.9844 | 4531.1 samples/s | 70.8 steps/s
[Step=12250 Epoch=23.9] | Loss=0.02509 | Reg=0.00203 | L2-Norm=14.253 | L2-Norm(final)=2.692 | acc=0.9844 | 4633.7 samples/s | 72.4 steps/s
[Step=12300 Epoch=24.0] | Loss=0.02424 | Reg=0.00203 | L2-Norm=14.264 | L2-Norm(final)=2.695 | acc=0.9844 | 4608.1 samples/s | 72.0 steps/s
[Step=12350 Epoch=24.1] | Loss=0.02377 | Reg=0.00204 | L2-Norm=14.276 | L2-Norm(final)=2.699 | acc=0.9375 | 4611.0 samples/s | 72.0 steps/s
[Step=12400 Epoch=24.2] | Loss=0.02312 | Reg=0.00204 | L2-Norm=14.288 | L2-Norm(final)=2.703 | acc=1.0000 | 4652.1 samples/s | 72.7 steps/s
[Step=12450 Epoch=24.3] | Loss=0.02277 | Reg=0.00204 | L2-Norm=14.298 | L2-Norm(final)=2.706 | acc=0.9844 | 4688.7 samples/s | 73.3 steps/s
[Step=12500 Epoch=24.4] | Loss=0.02238 | Reg=0.00205 | L2-Norm=14.308 | L2-Norm(final)=2.709 | acc=1.0000 | 5703.4 samples/s | 89.1 steps/s
[Step=12550 Epoch=24.5] | Loss=0.02154 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=2.713 | acc=1.0000 | 1963.7 samples/s | 30.7 steps/s
[Step=12600 Epoch=24.6] | Loss=0.02103 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=2.717 | acc=1.0000 | 4533.8 samples/s | 70.8 steps/s
[Step=12650 Epoch=24.7] | Loss=0.02061 | Reg=0.00205 | L2-Norm=14.335 | L2-Norm(final)=2.721 | acc=0.9844 | 4660.6 samples/s | 72.8 steps/s
[Step=12700 Epoch=24.8] | Loss=0.01989 | Reg=0.00206 | L2-Norm=14.343 | L2-Norm(final)=2.725 | acc=0.9688 | 4751.0 samples/s | 74.2 steps/s
[Step=12750 Epoch=24.9] | Loss=0.01934 | Reg=0.00206 | L2-Norm=14.351 | L2-Norm(final)=2.728 | acc=0.9844 | 4599.3 samples/s | 71.9 steps/s
[Step=12800 Epoch=25.0] | Loss=0.01912 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=2.732 | acc=0.9844 | 4624.3 samples/s | 72.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step12800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=46.0] | Loss=0.00719 | Reg=0.00199 | L2-Norm=14.120 | L2-Norm(final)=2.689 | acc=1.0000 | 3900.8 samples/s | 61.0 steps/s
[Step=12050 Epoch=46.2] | Loss=0.00146 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=2.706 | acc=1.0000 | 4411.1 samples/s | 68.9 steps/s
[Step=12100 Epoch=46.4] | Loss=0.00096 | Reg=0.00201 | L2-Norm=14.179 | L2-Norm(final)=2.711 | acc=1.0000 | 4212.7 samples/s | 65.8 steps/s
[Step=12150 Epoch=46.6] | Loss=0.00066 | Reg=0.00201 | L2-Norm=14.177 | L2-Norm(final)=2.715 | acc=1.0000 | 4135.3 samples/s | 64.6 steps/s
[Step=12200 Epoch=46.7] | Loss=0.00061 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=2.717 | acc=1.0000 | 4325.8 samples/s | 67.6 steps/s
[Step=12250 Epoch=46.9] | Loss=0.00087 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=2.717 | acc=1.0000 | 5520.8 samples/s | 86.3 steps/s
[Step=12300 Epoch=47.1] | Loss=0.00074 | Reg=0.00201 | L2-Norm=14.167 | L2-Norm(final)=2.716 | acc=1.0000 | 1894.1 samples/s | 29.6 steps/s
[Step=12350 Epoch=47.3] | Loss=0.00064 | Reg=0.00201 | L2-Norm=14.163 | L2-Norm(final)=2.717 | acc=1.0000 | 4436.0 samples/s | 69.3 steps/s
[Step=12400 Epoch=47.5] | Loss=0.00058 | Reg=0.00200 | L2-Norm=14.158 | L2-Norm(final)=2.718 | acc=1.0000 | 4401.1 samples/s | 68.8 steps/s
[Step=12450 Epoch=47.7] | Loss=0.00052 | Reg=0.00200 | L2-Norm=14.151 | L2-Norm(final)=2.719 | acc=1.0000 | 4358.6 samples/s | 68.1 steps/s
[Step=12500 Epoch=47.9] | Loss=0.00047 | Reg=0.00200 | L2-Norm=14.143 | L2-Norm(final)=2.720 | acc=1.0000 | 4857.6 samples/s | 75.9 steps/s
[Step=12550 Epoch=48.1] | Loss=0.00043 | Reg=0.00200 | L2-Norm=14.134 | L2-Norm(final)=2.721 | acc=1.0000 | 1993.3 samples/s | 31.1 steps/s
[Step=12600 Epoch=48.3] | Loss=0.00039 | Reg=0.00199 | L2-Norm=14.124 | L2-Norm(final)=2.723 | acc=1.0000 | 4278.1 samples/s | 66.8 steps/s
[Step=12650 Epoch=48.5] | Loss=0.00036 | Reg=0.00199 | L2-Norm=14.114 | L2-Norm(final)=2.724 | acc=1.0000 | 4467.9 samples/s | 69.8 steps/s
[Step=12700 Epoch=48.7] | Loss=0.00034 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=2.725 | acc=1.0000 | 4373.9 samples/s | 68.3 steps/s
[Step=12750 Epoch=48.9] | Loss=0.00032 | Reg=0.00199 | L2-Norm=14.092 | L2-Norm(final)=2.726 | acc=1.0000 | 4360.2 samples/s | 68.1 steps/s
[Step=12800 Epoch=49.0] | Loss=0.00030 | Reg=0.00198 | L2-Norm=14.080 | L2-Norm(final)=2.727 | acc=1.0000 | 2063.8 samples/s | 32.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=46.2] | Loss=0.04971 | Reg=0.00199 | L2-Norm=14.120 | L2-Norm(final)=2.688 | acc=0.9688 | 4301.3 samples/s | 67.2 steps/s
[Step=12050 Epoch=46.4] | Loss=0.00436 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=2.678 | acc=1.0000 | 3902.6 samples/s | 61.0 steps/s
[Step=12100 Epoch=46.6] | Loss=0.00223 | Reg=0.00202 | L2-Norm=14.223 | L2-Norm(final)=2.680 | acc=1.0000 | 4419.5 samples/s | 69.1 steps/s
[Step=12150 Epoch=46.8] | Loss=0.00158 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=2.682 | acc=1.0000 | 4343.9 samples/s | 67.9 steps/s
[Step=12200 Epoch=47.0] | Loss=0.00121 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=2.685 | acc=1.0000 | 4483.6 samples/s | 70.1 steps/s
[Step=12250 Epoch=47.2] | Loss=0.00117 | Reg=0.00202 | L2-Norm=14.212 | L2-Norm(final)=2.686 | acc=1.0000 | 5439.4 samples/s | 85.0 steps/s
[Step=12300 Epoch=47.3] | Loss=0.00102 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=2.687 | acc=1.0000 | 1883.7 samples/s | 29.4 steps/s
[Step=12350 Epoch=47.5] | Loss=0.00092 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=2.688 | acc=1.0000 | 4315.0 samples/s | 67.4 steps/s
[Step=12400 Epoch=47.7] | Loss=0.00081 | Reg=0.00202 | L2-Norm=14.200 | L2-Norm(final)=2.689 | acc=1.0000 | 4448.9 samples/s | 69.5 steps/s
[Step=12450 Epoch=47.9] | Loss=0.00072 | Reg=0.00201 | L2-Norm=14.193 | L2-Norm(final)=2.690 | acc=1.0000 | 4351.9 samples/s | 68.0 steps/s
[Step=12500 Epoch=48.1] | Loss=0.00065 | Reg=0.00201 | L2-Norm=14.186 | L2-Norm(final)=2.691 | acc=1.0000 | 4906.7 samples/s | 76.7 steps/s
[Step=12550 Epoch=48.3] | Loss=0.00059 | Reg=0.00201 | L2-Norm=14.179 | L2-Norm(final)=2.692 | acc=1.0000 | 1985.5 samples/s | 31.0 steps/s
[Step=12600 Epoch=48.5] | Loss=0.00055 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=2.693 | acc=1.0000 | 4274.8 samples/s | 66.8 steps/s
[Step=12650 Epoch=48.7] | Loss=0.00050 | Reg=0.00201 | L2-Norm=14.161 | L2-Norm(final)=2.694 | acc=1.0000 | 4413.1 samples/s | 69.0 steps/s
[Step=12700 Epoch=48.9] | Loss=0.00047 | Reg=0.00200 | L2-Norm=14.152 | L2-Norm(final)=2.695 | acc=1.0000 | 4393.9 samples/s | 68.7 steps/s
[Step=12750 Epoch=49.1] | Loss=0.00044 | Reg=0.00200 | L2-Norm=14.143 | L2-Norm(final)=2.696 | acc=1.0000 | 4393.0 samples/s | 68.6 steps/s
[Step=12800 Epoch=49.3] | Loss=0.00041 | Reg=0.00200 | L2-Norm=14.133 | L2-Norm(final)=2.696 | acc=1.0000 | 2057.9 samples/s | 32.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27536 | acc=0.8377 | tpr=0.7696 | fpr=0.0144 | 4306.3 samples/s | 16.8 steps/s
Avg test loss: 0.27834, Avg test acc: 0.83737, Avg tpr: 0.77053, Avg fpr: 0.01564, total FA: 122

Testing server on iccad2012
[Step=  50] | Loss=0.34465 | acc=0.8852 | tpr=0.9558 | fpr=0.1161 | 4298.1 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.34706 | acc=0.8840 | tpr=0.9723 | fpr=0.1176 | 8312.9 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.35236 | acc=0.8836 | tpr=0.9784 | fpr=0.1181 | 8139.4 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.35212 | acc=0.8844 | tpr=0.9792 | fpr=0.1173 | 8381.8 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.35020 | acc=0.8846 | tpr=0.9808 | fpr=0.1171 | 8012.9 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.35499 | acc=0.8837 | tpr=0.9811 | fpr=0.1181 | 7993.6 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.35717 | acc=0.8834 | tpr=0.9800 | fpr=0.1184 | 8235.9 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.35880 | acc=0.8830 | tpr=0.9787 | fpr=0.1187 | 8140.0 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.36358 | acc=0.8829 | tpr=0.9786 | fpr=0.1188 | 5967.6 samples/s | 23.3 steps/s
[Step= 500] | Loss=0.36411 | acc=0.8827 | tpr=0.9793 | fpr=0.1190 | 6232.6 samples/s | 24.3 steps/s
[Step= 550] | Loss=0.36361 | acc=0.8827 | tpr=0.9789 | fpr=0.1190 | 13731.9 samples/s | 53.6 steps/s
Avg test loss: 0.36337, Avg test acc: 0.88269, Avg tpr: 0.97861, Avg fpr: 0.11906, total FA: 16531

server round 16/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=25.0] | Loss=0.23428 | Reg=0.00198 | L2-Norm=14.065 | L2-Norm(final)=2.740 | acc=0.9219 | 3733.4 samples/s | 58.3 steps/s
[Step=12850 Epoch=25.1] | Loss=0.03404 | Reg=0.00199 | L2-Norm=14.119 | L2-Norm(final)=2.726 | acc=0.9844 | 4651.5 samples/s | 72.7 steps/s
[Step=12900 Epoch=25.2] | Loss=0.02632 | Reg=0.00200 | L2-Norm=14.142 | L2-Norm(final)=2.733 | acc=1.0000 | 4574.8 samples/s | 71.5 steps/s
[Step=12950 Epoch=25.3] | Loss=0.02324 | Reg=0.00200 | L2-Norm=14.158 | L2-Norm(final)=2.740 | acc=1.0000 | 4607.2 samples/s | 72.0 steps/s
[Step=13000 Epoch=25.4] | Loss=0.02290 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=2.743 | acc=0.9844 | 4676.8 samples/s | 73.1 steps/s
[Step=13050 Epoch=25.5] | Loss=0.02160 | Reg=0.00201 | L2-Norm=14.182 | L2-Norm(final)=2.746 | acc=0.9844 | 4596.4 samples/s | 71.8 steps/s
[Step=13100 Epoch=25.6] | Loss=0.02129 | Reg=0.00201 | L2-Norm=14.192 | L2-Norm(final)=2.748 | acc=1.0000 | 4703.7 samples/s | 73.5 steps/s
[Step=13150 Epoch=25.6] | Loss=0.02137 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=2.750 | acc=0.9688 | 4640.7 samples/s | 72.5 steps/s
[Step=13200 Epoch=25.7] | Loss=0.02102 | Reg=0.00202 | L2-Norm=14.212 | L2-Norm(final)=2.752 | acc=0.9531 | 4646.9 samples/s | 72.6 steps/s
[Step=13250 Epoch=25.8] | Loss=0.02085 | Reg=0.00202 | L2-Norm=14.222 | L2-Norm(final)=2.754 | acc=0.9531 | 4605.8 samples/s | 72.0 steps/s
[Step=13300 Epoch=25.9] | Loss=0.02067 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=2.757 | acc=1.0000 | 5667.2 samples/s | 88.6 steps/s
[Step=13350 Epoch=26.0] | Loss=0.02025 | Reg=0.00203 | L2-Norm=14.240 | L2-Norm(final)=2.760 | acc=0.9844 | 1821.6 samples/s | 28.5 steps/s
[Step=13400 Epoch=26.1] | Loss=0.01975 | Reg=0.00203 | L2-Norm=14.248 | L2-Norm(final)=2.763 | acc=1.0000 | 4498.2 samples/s | 70.3 steps/s
[Step=13450 Epoch=26.2] | Loss=0.01929 | Reg=0.00203 | L2-Norm=14.257 | L2-Norm(final)=2.766 | acc=0.9688 | 4127.2 samples/s | 64.5 steps/s
[Step=13500 Epoch=26.3] | Loss=0.01902 | Reg=0.00203 | L2-Norm=14.265 | L2-Norm(final)=2.769 | acc=0.9844 | 4168.2 samples/s | 65.1 steps/s
[Step=13550 Epoch=26.4] | Loss=0.01877 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=2.772 | acc=1.0000 | 4164.7 samples/s | 65.1 steps/s
[Step=13600 Epoch=26.5] | Loss=0.01874 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=2.774 | acc=0.9844 | 4046.5 samples/s | 63.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step13600.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=25.0] | Loss=0.20228 | Reg=0.00198 | L2-Norm=14.065 | L2-Norm(final)=2.741 | acc=0.8594 | 4207.9 samples/s | 65.7 steps/s
[Step=12850 Epoch=25.1] | Loss=0.03119 | Reg=0.00199 | L2-Norm=14.121 | L2-Norm(final)=2.737 | acc=0.9688 | 3966.3 samples/s | 62.0 steps/s
[Step=12900 Epoch=25.2] | Loss=0.02513 | Reg=0.00200 | L2-Norm=14.147 | L2-Norm(final)=2.744 | acc=0.9688 | 4444.2 samples/s | 69.4 steps/s
[Step=12950 Epoch=25.3] | Loss=0.02240 | Reg=0.00201 | L2-Norm=14.165 | L2-Norm(final)=2.751 | acc=0.9844 | 4408.7 samples/s | 68.9 steps/s
[Step=13000 Epoch=25.4] | Loss=0.02190 | Reg=0.00201 | L2-Norm=14.179 | L2-Norm(final)=2.755 | acc=1.0000 | 4443.3 samples/s | 69.4 steps/s
[Step=13050 Epoch=25.5] | Loss=0.02216 | Reg=0.00201 | L2-Norm=14.192 | L2-Norm(final)=2.757 | acc=0.9844 | 4468.8 samples/s | 69.8 steps/s
[Step=13100 Epoch=25.6] | Loss=0.02146 | Reg=0.00202 | L2-Norm=14.203 | L2-Norm(final)=2.759 | acc=0.9531 | 4443.6 samples/s | 69.4 steps/s
[Step=13150 Epoch=25.7] | Loss=0.02061 | Reg=0.00202 | L2-Norm=14.213 | L2-Norm(final)=2.761 | acc=0.9844 | 4470.4 samples/s | 69.9 steps/s
[Step=13200 Epoch=25.8] | Loss=0.02036 | Reg=0.00202 | L2-Norm=14.224 | L2-Norm(final)=2.764 | acc=0.9844 | 4508.6 samples/s | 70.4 steps/s
[Step=13250 Epoch=25.9] | Loss=0.02044 | Reg=0.00203 | L2-Norm=14.234 | L2-Norm(final)=2.766 | acc=0.9844 | 4314.1 samples/s | 67.4 steps/s
[Step=13300 Epoch=26.0] | Loss=0.02062 | Reg=0.00203 | L2-Norm=14.243 | L2-Norm(final)=2.768 | acc=0.9844 | 5589.9 samples/s | 87.3 steps/s
[Step=13350 Epoch=26.1] | Loss=0.01997 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=2.769 | acc=0.9844 | 1854.4 samples/s | 29.0 steps/s
[Step=13400 Epoch=26.2] | Loss=0.01955 | Reg=0.00203 | L2-Norm=14.261 | L2-Norm(final)=2.772 | acc=1.0000 | 4300.5 samples/s | 67.2 steps/s
[Step=13450 Epoch=26.3] | Loss=0.01910 | Reg=0.00204 | L2-Norm=14.269 | L2-Norm(final)=2.775 | acc=0.9688 | 4319.7 samples/s | 67.5 steps/s
[Step=13500 Epoch=26.4] | Loss=0.01877 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=2.778 | acc=0.9844 | 4310.3 samples/s | 67.3 steps/s
[Step=13550 Epoch=26.5] | Loss=0.01859 | Reg=0.00204 | L2-Norm=14.285 | L2-Norm(final)=2.780 | acc=1.0000 | 4225.2 samples/s | 66.0 steps/s
[Step=13600 Epoch=26.6] | Loss=0.01846 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=2.783 | acc=0.9844 | 4219.8 samples/s | 65.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step13600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=49.0] | Loss=0.04111 | Reg=0.00198 | L2-Norm=14.065 | L2-Norm(final)=2.742 | acc=0.9688 | 3911.2 samples/s | 61.1 steps/s
[Step=12850 Epoch=49.2] | Loss=0.00344 | Reg=0.00200 | L2-Norm=14.138 | L2-Norm(final)=2.754 | acc=1.0000 | 3714.9 samples/s | 58.0 steps/s
[Step=12900 Epoch=49.4] | Loss=0.00449 | Reg=0.00201 | L2-Norm=14.186 | L2-Norm(final)=2.735 | acc=1.0000 | 4188.2 samples/s | 65.4 steps/s
[Step=12950 Epoch=49.6] | Loss=0.00406 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=2.717 | acc=1.0000 | 4060.5 samples/s | 63.4 steps/s
[Step=13000 Epoch=49.8] | Loss=0.00312 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=2.710 | acc=1.0000 | 4136.9 samples/s | 64.6 steps/s
[Step=13050 Epoch=50.0] | Loss=0.00256 | Reg=0.00202 | L2-Norm=14.229 | L2-Norm(final)=2.707 | acc=1.0000 | 5251.9 samples/s | 82.1 steps/s
[Step=13100 Epoch=50.2] | Loss=0.00214 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=2.707 | acc=1.0000 | 1842.5 samples/s | 28.8 steps/s
[Step=13150 Epoch=50.4] | Loss=0.00183 | Reg=0.00202 | L2-Norm=14.224 | L2-Norm(final)=2.708 | acc=1.0000 | 4216.7 samples/s | 65.9 steps/s
[Step=13200 Epoch=50.6] | Loss=0.00161 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=2.708 | acc=1.0000 | 4200.0 samples/s | 65.6 steps/s
[Step=13250 Epoch=50.8] | Loss=0.00143 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=2.709 | acc=1.0000 | 4336.4 samples/s | 67.8 steps/s
[Step=13300 Epoch=51.0] | Loss=0.00129 | Reg=0.00202 | L2-Norm=14.200 | L2-Norm(final)=2.709 | acc=1.0000 | 4794.5 samples/s | 74.9 steps/s
[Step=13350 Epoch=51.2] | Loss=0.00117 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=2.710 | acc=1.0000 | 1901.0 samples/s | 29.7 steps/s
[Step=13400 Epoch=51.3] | Loss=0.00107 | Reg=0.00201 | L2-Norm=14.180 | L2-Norm(final)=2.710 | acc=1.0000 | 4256.0 samples/s | 66.5 steps/s
[Step=13450 Epoch=51.5] | Loss=0.00099 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=2.711 | acc=1.0000 | 4005.9 samples/s | 62.6 steps/s
[Step=13500 Epoch=51.7] | Loss=0.00092 | Reg=0.00200 | L2-Norm=14.159 | L2-Norm(final)=2.712 | acc=1.0000 | 4227.9 samples/s | 66.1 steps/s
[Step=13550 Epoch=51.9] | Loss=0.00086 | Reg=0.00200 | L2-Norm=14.147 | L2-Norm(final)=2.712 | acc=1.0000 | 4172.1 samples/s | 65.2 steps/s
[Step=13600 Epoch=52.1] | Loss=0.00081 | Reg=0.00200 | L2-Norm=14.136 | L2-Norm(final)=2.713 | acc=1.0000 | 1996.2 samples/s | 31.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step13600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=49.3] | Loss=0.05755 | Reg=0.00198 | L2-Norm=14.065 | L2-Norm(final)=2.741 | acc=0.9688 | 3767.5 samples/s | 58.9 steps/s
[Step=12850 Epoch=49.5] | Loss=0.00610 | Reg=0.00200 | L2-Norm=14.155 | L2-Norm(final)=2.726 | acc=1.0000 | 3961.0 samples/s | 61.9 steps/s
[Step=12900 Epoch=49.7] | Loss=0.00358 | Reg=0.00201 | L2-Norm=14.187 | L2-Norm(final)=2.722 | acc=1.0000 | 3985.3 samples/s | 62.3 steps/s
[Step=12950 Epoch=49.8] | Loss=0.00255 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=2.724 | acc=1.0000 | 4154.1 samples/s | 64.9 steps/s
[Step=13000 Epoch=50.0] | Loss=0.00211 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=2.727 | acc=1.0000 | 4108.7 samples/s | 64.2 steps/s
[Step=13050 Epoch=50.2] | Loss=0.00173 | Reg=0.00202 | L2-Norm=14.204 | L2-Norm(final)=2.729 | acc=1.0000 | 5361.9 samples/s | 83.8 steps/s
[Step=13100 Epoch=50.4] | Loss=0.00145 | Reg=0.00202 | L2-Norm=14.203 | L2-Norm(final)=2.732 | acc=1.0000 | 1801.6 samples/s | 28.2 steps/s
[Step=13150 Epoch=50.6] | Loss=0.00124 | Reg=0.00202 | L2-Norm=14.200 | L2-Norm(final)=2.734 | acc=1.0000 | 3997.6 samples/s | 62.5 steps/s
[Step=13200 Epoch=50.8] | Loss=0.00110 | Reg=0.00202 | L2-Norm=14.196 | L2-Norm(final)=2.737 | acc=1.0000 | 4236.7 samples/s | 66.2 steps/s
[Step=13250 Epoch=51.0] | Loss=0.00098 | Reg=0.00201 | L2-Norm=14.190 | L2-Norm(final)=2.739 | acc=1.0000 | 4139.2 samples/s | 64.7 steps/s
[Step=13300 Epoch=51.2] | Loss=0.00089 | Reg=0.00201 | L2-Norm=14.183 | L2-Norm(final)=2.740 | acc=1.0000 | 4601.1 samples/s | 71.9 steps/s
[Step=13350 Epoch=51.4] | Loss=0.00081 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=2.742 | acc=1.0000 | 1878.8 samples/s | 29.4 steps/s
[Step=13400 Epoch=51.6] | Loss=0.00074 | Reg=0.00201 | L2-Norm=14.166 | L2-Norm(final)=2.743 | acc=1.0000 | 4386.4 samples/s | 68.5 steps/s
[Step=13450 Epoch=51.8] | Loss=0.00068 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=2.744 | acc=1.0000 | 4417.8 samples/s | 69.0 steps/s
[Step=13500 Epoch=52.0] | Loss=0.00063 | Reg=0.00200 | L2-Norm=14.148 | L2-Norm(final)=2.746 | acc=1.0000 | 4272.7 samples/s | 66.8 steps/s
[Step=13550 Epoch=52.2] | Loss=0.00059 | Reg=0.00200 | L2-Norm=14.138 | L2-Norm(final)=2.747 | acc=1.0000 | 4505.7 samples/s | 70.4 steps/s
[Step=13600 Epoch=52.4] | Loss=0.00056 | Reg=0.00200 | L2-Norm=14.128 | L2-Norm(final)=2.747 | acc=1.0000 | 1994.3 samples/s | 31.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27425 | acc=0.8306 | tpr=0.7590 | fpr=0.0139 | 4174.4 samples/s | 16.3 steps/s
Avg test loss: 0.27744, Avg test acc: 0.82919, Avg tpr: 0.75858, Avg fpr: 0.01551, total FA: 121

Testing server on iccad2012
[Step=  50] | Loss=0.32385 | acc=0.8817 | tpr=0.9646 | fpr=0.1198 | 3725.8 samples/s | 14.6 steps/s
[Step= 100] | Loss=0.32364 | acc=0.8836 | tpr=0.9765 | fpr=0.1182 | 7515.0 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.32735 | acc=0.8836 | tpr=0.9813 | fpr=0.1182 | 7882.3 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.32607 | acc=0.8852 | tpr=0.9814 | fpr=0.1165 | 7928.1 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.32526 | acc=0.8851 | tpr=0.9834 | fpr=0.1167 | 5509.7 samples/s | 21.5 steps/s
[Step= 300] | Loss=0.32926 | acc=0.8847 | tpr=0.9833 | fpr=0.1171 | 7442.5 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.33090 | acc=0.8844 | tpr=0.9818 | fpr=0.1174 | 7622.6 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.33270 | acc=0.8842 | tpr=0.9798 | fpr=0.1176 | 7671.0 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.33698 | acc=0.8840 | tpr=0.9791 | fpr=0.1177 | 7365.1 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.33750 | acc=0.8837 | tpr=0.9797 | fpr=0.1181 | 7840.2 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.33692 | acc=0.8836 | tpr=0.9789 | fpr=0.1181 | 15277.1 samples/s | 59.7 steps/s
Avg test loss: 0.33670, Avg test acc: 0.88359, Avg tpr: 0.97861, Avg fpr: 0.11814, total FA: 16403

server round 17/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=26.5] | Loss=0.16268 | Reg=0.00197 | L2-Norm=14.029 | L2-Norm(final)=2.773 | acc=0.8750 | 3011.9 samples/s | 47.1 steps/s
[Step=13650 Epoch=26.6] | Loss=0.04547 | Reg=0.00199 | L2-Norm=14.108 | L2-Norm(final)=2.751 | acc=0.9688 | 4376.9 samples/s | 68.4 steps/s
[Step=13700 Epoch=26.7] | Loss=0.03176 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=2.760 | acc=1.0000 | 4382.0 samples/s | 68.5 steps/s
[Step=13750 Epoch=26.8] | Loss=0.02900 | Reg=0.00201 | L2-Norm=14.166 | L2-Norm(final)=2.767 | acc=0.9844 | 4058.0 samples/s | 63.4 steps/s
[Step=13800 Epoch=26.9] | Loss=0.02648 | Reg=0.00201 | L2-Norm=14.179 | L2-Norm(final)=2.770 | acc=0.9844 | 4508.0 samples/s | 70.4 steps/s
[Step=13850 Epoch=27.0] | Loss=0.02464 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=2.775 | acc=1.0000 | 4435.1 samples/s | 69.3 steps/s
[Step=13900 Epoch=27.1] | Loss=0.02421 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=2.778 | acc=0.9844 | 4502.6 samples/s | 70.4 steps/s
[Step=13950 Epoch=27.2] | Loss=0.02306 | Reg=0.00202 | L2-Norm=14.211 | L2-Norm(final)=2.780 | acc=0.9688 | 4612.7 samples/s | 72.1 steps/s
[Step=14000 Epoch=27.3] | Loss=0.02173 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=2.784 | acc=0.9844 | 4442.8 samples/s | 69.4 steps/s
[Step=14050 Epoch=27.4] | Loss=0.02182 | Reg=0.00203 | L2-Norm=14.231 | L2-Norm(final)=2.788 | acc=0.9531 | 4360.0 samples/s | 68.1 steps/s
[Step=14100 Epoch=27.5] | Loss=0.02162 | Reg=0.00203 | L2-Norm=14.241 | L2-Norm(final)=2.791 | acc=0.9844 | 5597.7 samples/s | 87.5 steps/s
[Step=14150 Epoch=27.6] | Loss=0.02095 | Reg=0.00203 | L2-Norm=14.251 | L2-Norm(final)=2.794 | acc=0.9688 | 1791.4 samples/s | 28.0 steps/s
[Step=14200 Epoch=27.7] | Loss=0.02062 | Reg=0.00203 | L2-Norm=14.260 | L2-Norm(final)=2.797 | acc=0.9844 | 4386.7 samples/s | 68.5 steps/s
[Step=14250 Epoch=27.8] | Loss=0.02006 | Reg=0.00204 | L2-Norm=14.269 | L2-Norm(final)=2.800 | acc=0.9688 | 4231.2 samples/s | 66.1 steps/s
[Step=14300 Epoch=27.9] | Loss=0.01995 | Reg=0.00204 | L2-Norm=14.278 | L2-Norm(final)=2.803 | acc=0.9688 | 4090.6 samples/s | 63.9 steps/s
[Step=14350 Epoch=28.0] | Loss=0.01939 | Reg=0.00204 | L2-Norm=14.286 | L2-Norm(final)=2.807 | acc=1.0000 | 4524.1 samples/s | 70.7 steps/s
[Step=14400 Epoch=28.1] | Loss=0.01918 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=2.810 | acc=0.9688 | 4234.3 samples/s | 66.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step14400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=26.6] | Loss=0.19093 | Reg=0.00197 | L2-Norm=14.029 | L2-Norm(final)=2.773 | acc=0.8906 | 4094.6 samples/s | 64.0 steps/s
[Step=13650 Epoch=26.7] | Loss=0.03035 | Reg=0.00198 | L2-Norm=14.085 | L2-Norm(final)=2.772 | acc=1.0000 | 4220.1 samples/s | 65.9 steps/s
[Step=13700 Epoch=26.8] | Loss=0.02471 | Reg=0.00199 | L2-Norm=14.108 | L2-Norm(final)=2.779 | acc=1.0000 | 4108.9 samples/s | 64.2 steps/s
[Step=13750 Epoch=26.9] | Loss=0.02374 | Reg=0.00200 | L2-Norm=14.125 | L2-Norm(final)=2.784 | acc=0.9688 | 4485.9 samples/s | 70.1 steps/s
[Step=13800 Epoch=27.0] | Loss=0.02108 | Reg=0.00200 | L2-Norm=14.138 | L2-Norm(final)=2.787 | acc=1.0000 | 4589.6 samples/s | 71.7 steps/s
[Step=13850 Epoch=27.1] | Loss=0.01953 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=2.792 | acc=1.0000 | 4580.3 samples/s | 71.6 steps/s
[Step=13900 Epoch=27.2] | Loss=0.01963 | Reg=0.00200 | L2-Norm=14.159 | L2-Norm(final)=2.797 | acc=0.9844 | 4557.4 samples/s | 71.2 steps/s
[Step=13950 Epoch=27.3] | Loss=0.01939 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=2.800 | acc=1.0000 | 4455.8 samples/s | 69.6 steps/s
[Step=14000 Epoch=27.4] | Loss=0.01917 | Reg=0.00201 | L2-Norm=14.177 | L2-Norm(final)=2.803 | acc=0.9531 | 4260.1 samples/s | 66.6 steps/s
[Step=14050 Epoch=27.5] | Loss=0.01882 | Reg=0.00201 | L2-Norm=14.186 | L2-Norm(final)=2.807 | acc=0.9844 | 4539.6 samples/s | 70.9 steps/s
[Step=14100 Epoch=27.6] | Loss=0.01873 | Reg=0.00202 | L2-Norm=14.196 | L2-Norm(final)=2.810 | acc=0.9688 | 5534.8 samples/s | 86.5 steps/s
[Step=14150 Epoch=27.7] | Loss=0.01871 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=2.813 | acc=1.0000 | 1836.9 samples/s | 28.7 steps/s
[Step=14200 Epoch=27.8] | Loss=0.01827 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=2.816 | acc=0.9844 | 4261.1 samples/s | 66.6 steps/s
[Step=14250 Epoch=27.9] | Loss=0.01803 | Reg=0.00202 | L2-Norm=14.224 | L2-Norm(final)=2.820 | acc=1.0000 | 4178.6 samples/s | 65.3 steps/s
[Step=14300 Epoch=28.0] | Loss=0.01770 | Reg=0.00203 | L2-Norm=14.233 | L2-Norm(final)=2.823 | acc=1.0000 | 4306.6 samples/s | 67.3 steps/s
[Step=14350 Epoch=28.1] | Loss=0.01759 | Reg=0.00203 | L2-Norm=14.242 | L2-Norm(final)=2.825 | acc=1.0000 | 4312.0 samples/s | 67.4 steps/s
[Step=14400 Epoch=28.2] | Loss=0.01748 | Reg=0.00203 | L2-Norm=14.250 | L2-Norm(final)=2.828 | acc=0.9688 | 4443.3 samples/s | 69.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step14400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=52.1] | Loss=0.07750 | Reg=0.00197 | L2-Norm=14.029 | L2-Norm(final)=2.773 | acc=0.9688 | 4152.9 samples/s | 64.9 steps/s
[Step=13650 Epoch=52.3] | Loss=0.00529 | Reg=0.00199 | L2-Norm=14.109 | L2-Norm(final)=2.763 | acc=0.9844 | 3957.9 samples/s | 61.8 steps/s
[Step=13700 Epoch=52.5] | Loss=0.00294 | Reg=0.00200 | L2-Norm=14.144 | L2-Norm(final)=2.768 | acc=1.0000 | 4311.2 samples/s | 67.4 steps/s
[Step=13750 Epoch=52.7] | Loss=0.00199 | Reg=0.00200 | L2-Norm=14.154 | L2-Norm(final)=2.774 | acc=1.0000 | 4071.5 samples/s | 63.6 steps/s
[Step=13800 Epoch=52.9] | Loss=0.00155 | Reg=0.00200 | L2-Norm=14.154 | L2-Norm(final)=2.779 | acc=1.0000 | 4031.6 samples/s | 63.0 steps/s
[Step=13850 Epoch=53.1] | Loss=0.00124 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=2.782 | acc=1.0000 | 5370.3 samples/s | 83.9 steps/s
[Step=13900 Epoch=53.3] | Loss=0.00104 | Reg=0.00200 | L2-Norm=14.143 | L2-Norm(final)=2.785 | acc=1.0000 | 1811.8 samples/s | 28.3 steps/s
[Step=13950 Epoch=53.5] | Loss=0.00089 | Reg=0.00200 | L2-Norm=14.134 | L2-Norm(final)=2.787 | acc=1.0000 | 4147.6 samples/s | 64.8 steps/s
[Step=14000 Epoch=53.6] | Loss=0.00078 | Reg=0.00199 | L2-Norm=14.124 | L2-Norm(final)=2.789 | acc=1.0000 | 3929.8 samples/s | 61.4 steps/s
[Step=14050 Epoch=53.8] | Loss=0.00070 | Reg=0.00199 | L2-Norm=14.113 | L2-Norm(final)=2.791 | acc=1.0000 | 4324.7 samples/s | 67.6 steps/s
[Step=14100 Epoch=54.0] | Loss=0.00063 | Reg=0.00199 | L2-Norm=14.102 | L2-Norm(final)=2.792 | acc=1.0000 | 4766.8 samples/s | 74.5 steps/s
[Step=14150 Epoch=54.2] | Loss=0.00057 | Reg=0.00199 | L2-Norm=14.090 | L2-Norm(final)=2.793 | acc=1.0000 | 1991.6 samples/s | 31.1 steps/s
[Step=14200 Epoch=54.4] | Loss=0.00052 | Reg=0.00198 | L2-Norm=14.078 | L2-Norm(final)=2.794 | acc=1.0000 | 4102.7 samples/s | 64.1 steps/s
[Step=14250 Epoch=54.6] | Loss=0.00048 | Reg=0.00198 | L2-Norm=14.066 | L2-Norm(final)=2.795 | acc=1.0000 | 4084.1 samples/s | 63.8 steps/s
[Step=14300 Epoch=54.8] | Loss=0.00045 | Reg=0.00198 | L2-Norm=14.054 | L2-Norm(final)=2.796 | acc=1.0000 | 4149.1 samples/s | 64.8 steps/s
[Step=14350 Epoch=55.0] | Loss=0.00042 | Reg=0.00197 | L2-Norm=14.041 | L2-Norm(final)=2.797 | acc=1.0000 | 4053.1 samples/s | 63.3 steps/s
[Step=14400 Epoch=55.2] | Loss=0.00039 | Reg=0.00197 | L2-Norm=14.029 | L2-Norm(final)=2.798 | acc=1.0000 | 1991.4 samples/s | 31.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step14400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=52.4] | Loss=0.03719 | Reg=0.00197 | L2-Norm=14.029 | L2-Norm(final)=2.774 | acc=0.9844 | 4216.2 samples/s | 65.9 steps/s
[Step=13650 Epoch=52.5] | Loss=0.00209 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=2.793 | acc=1.0000 | 3748.2 samples/s | 58.6 steps/s
[Step=13700 Epoch=52.7] | Loss=0.00114 | Reg=0.00199 | L2-Norm=14.108 | L2-Norm(final)=2.805 | acc=1.0000 | 3830.6 samples/s | 59.9 steps/s
[Step=13750 Epoch=52.9] | Loss=0.00078 | Reg=0.00199 | L2-Norm=14.104 | L2-Norm(final)=2.812 | acc=1.0000 | 4175.9 samples/s | 65.2 steps/s
[Step=13800 Epoch=53.1] | Loss=0.00059 | Reg=0.00199 | L2-Norm=14.097 | L2-Norm(final)=2.817 | acc=1.0000 | 4041.4 samples/s | 63.1 steps/s
[Step=13850 Epoch=53.3] | Loss=0.00052 | Reg=0.00198 | L2-Norm=14.088 | L2-Norm(final)=2.820 | acc=1.0000 | 5223.3 samples/s | 81.6 steps/s
[Step=13900 Epoch=53.5] | Loss=0.00048 | Reg=0.00198 | L2-Norm=14.081 | L2-Norm(final)=2.823 | acc=1.0000 | 1816.4 samples/s | 28.4 steps/s
[Step=13950 Epoch=53.7] | Loss=0.00045 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=2.826 | acc=1.0000 | 4173.3 samples/s | 65.2 steps/s
[Step=14000 Epoch=53.9] | Loss=0.00040 | Reg=0.00198 | L2-Norm=14.071 | L2-Norm(final)=2.828 | acc=1.0000 | 4129.2 samples/s | 64.5 steps/s
[Step=14050 Epoch=54.1] | Loss=0.00035 | Reg=0.00198 | L2-Norm=14.063 | L2-Norm(final)=2.830 | acc=1.0000 | 4280.7 samples/s | 66.9 steps/s
[Step=14100 Epoch=54.3] | Loss=0.00032 | Reg=0.00198 | L2-Norm=14.055 | L2-Norm(final)=2.832 | acc=1.0000 | 4708.2 samples/s | 73.6 steps/s
[Step=14150 Epoch=54.5] | Loss=0.00029 | Reg=0.00197 | L2-Norm=14.046 | L2-Norm(final)=2.834 | acc=1.0000 | 1885.9 samples/s | 29.5 steps/s
[Step=14200 Epoch=54.7] | Loss=0.00027 | Reg=0.00197 | L2-Norm=14.036 | L2-Norm(final)=2.835 | acc=1.0000 | 4178.4 samples/s | 65.3 steps/s
[Step=14250 Epoch=54.9] | Loss=0.00025 | Reg=0.00197 | L2-Norm=14.026 | L2-Norm(final)=2.837 | acc=1.0000 | 4356.4 samples/s | 68.1 steps/s
[Step=14300 Epoch=55.0] | Loss=0.00023 | Reg=0.00196 | L2-Norm=14.015 | L2-Norm(final)=2.838 | acc=1.0000 | 4289.4 samples/s | 67.0 steps/s
[Step=14350 Epoch=55.2] | Loss=0.00022 | Reg=0.00196 | L2-Norm=14.004 | L2-Norm(final)=2.839 | acc=1.0000 | 4331.7 samples/s | 67.7 steps/s
[Step=14400 Epoch=55.4] | Loss=0.00020 | Reg=0.00196 | L2-Norm=13.993 | L2-Norm(final)=2.840 | acc=1.0000 | 2027.9 samples/s | 31.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26345 | acc=0.8457 | tpr=0.7808 | fpr=0.0134 | 3168.8 samples/s | 12.4 steps/s
Avg test loss: 0.26591, Avg test acc: 0.84574, Avg tpr: 0.78213, Avg fpr: 0.01436, total FA: 112

Testing server on iccad2012
[Step=  50] | Loss=0.39170 | acc=0.8632 | tpr=0.9602 | fpr=0.1385 | 3131.6 samples/s | 12.2 steps/s
[Step= 100] | Loss=0.39125 | acc=0.8657 | tpr=0.9765 | fpr=0.1364 | 7753.7 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.39630 | acc=0.8651 | tpr=0.9813 | fpr=0.1371 | 7850.4 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.39549 | acc=0.8661 | tpr=0.9814 | fpr=0.1360 | 7919.2 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.39408 | acc=0.8662 | tpr=0.9825 | fpr=0.1359 | 7699.4 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.39824 | acc=0.8655 | tpr=0.9825 | fpr=0.1366 | 7450.8 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.40048 | acc=0.8654 | tpr=0.9825 | fpr=0.1367 | 7801.3 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.40216 | acc=0.8651 | tpr=0.9814 | fpr=0.1370 | 7794.2 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.40699 | acc=0.8647 | tpr=0.9805 | fpr=0.1374 | 7862.1 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.40766 | acc=0.8646 | tpr=0.9811 | fpr=0.1375 | 8045.5 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.40707 | acc=0.8648 | tpr=0.9809 | fpr=0.1373 | 14258.7 samples/s | 55.7 steps/s
Avg test loss: 0.40686, Avg test acc: 0.86476, Avg tpr: 0.98059, Avg fpr: 0.13734, total FA: 19070

server round 18/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=28.1] | Loss=0.10418 | Reg=0.00195 | L2-Norm=13.977 | L2-Norm(final)=2.845 | acc=0.9531 | 3555.3 samples/s | 55.6 steps/s
[Step=14450 Epoch=28.2] | Loss=0.02746 | Reg=0.00197 | L2-Norm=14.039 | L2-Norm(final)=2.836 | acc=0.9844 | 2220.5 samples/s | 34.7 steps/s
[Step=14500 Epoch=28.3] | Loss=0.02319 | Reg=0.00198 | L2-Norm=14.065 | L2-Norm(final)=2.840 | acc=0.9844 | 4292.5 samples/s | 67.1 steps/s
[Step=14550 Epoch=28.4] | Loss=0.02176 | Reg=0.00198 | L2-Norm=14.080 | L2-Norm(final)=2.844 | acc=1.0000 | 4637.2 samples/s | 72.5 steps/s
[Step=14600 Epoch=28.5] | Loss=0.02122 | Reg=0.00199 | L2-Norm=14.092 | L2-Norm(final)=2.847 | acc=1.0000 | 4322.1 samples/s | 67.5 steps/s
[Step=14650 Epoch=28.6] | Loss=0.02064 | Reg=0.00199 | L2-Norm=14.102 | L2-Norm(final)=2.850 | acc=1.0000 | 4456.9 samples/s | 69.6 steps/s
[Step=14700 Epoch=28.7] | Loss=0.02030 | Reg=0.00199 | L2-Norm=14.111 | L2-Norm(final)=2.852 | acc=1.0000 | 4532.4 samples/s | 70.8 steps/s
[Step=14750 Epoch=28.8] | Loss=0.02010 | Reg=0.00199 | L2-Norm=14.120 | L2-Norm(final)=2.855 | acc=0.9688 | 4446.4 samples/s | 69.5 steps/s
[Step=14800 Epoch=28.9] | Loss=0.02004 | Reg=0.00200 | L2-Norm=14.130 | L2-Norm(final)=2.858 | acc=1.0000 | 4533.5 samples/s | 70.8 steps/s
[Step=14850 Epoch=29.0] | Loss=0.01981 | Reg=0.00200 | L2-Norm=14.140 | L2-Norm(final)=2.860 | acc=0.9844 | 4577.3 samples/s | 71.5 steps/s
[Step=14900 Epoch=29.1] | Loss=0.01984 | Reg=0.00200 | L2-Norm=14.149 | L2-Norm(final)=2.862 | acc=0.9844 | 5424.2 samples/s | 84.8 steps/s
[Step=14950 Epoch=29.2] | Loss=0.01909 | Reg=0.00200 | L2-Norm=14.159 | L2-Norm(final)=2.865 | acc=0.9688 | 1885.3 samples/s | 29.5 steps/s
[Step=15000 Epoch=29.3] | Loss=0.01857 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=2.868 | acc=0.9844 | 4466.7 samples/s | 69.8 steps/s
[Step=15050 Epoch=29.4] | Loss=0.01831 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=2.871 | acc=0.9844 | 4453.5 samples/s | 69.6 steps/s
[Step=15100 Epoch=29.5] | Loss=0.01825 | Reg=0.00201 | L2-Norm=14.186 | L2-Norm(final)=2.873 | acc=1.0000 | 4458.8 samples/s | 69.7 steps/s
[Step=15150 Epoch=29.5] | Loss=0.01780 | Reg=0.00201 | L2-Norm=14.194 | L2-Norm(final)=2.876 | acc=0.9844 | 4469.7 samples/s | 69.8 steps/s
[Step=15200 Epoch=29.6] | Loss=0.01760 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=2.879 | acc=0.9844 | 4539.4 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step15200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=28.2] | Loss=0.11952 | Reg=0.00195 | L2-Norm=13.977 | L2-Norm(final)=2.845 | acc=0.8906 | 3754.6 samples/s | 58.7 steps/s
[Step=14450 Epoch=28.2] | Loss=0.03028 | Reg=0.00197 | L2-Norm=14.049 | L2-Norm(final)=2.834 | acc=1.0000 | 4393.6 samples/s | 68.7 steps/s
[Step=14500 Epoch=28.3] | Loss=0.02406 | Reg=0.00198 | L2-Norm=14.077 | L2-Norm(final)=2.841 | acc=0.9688 | 4211.5 samples/s | 65.8 steps/s
[Step=14550 Epoch=28.4] | Loss=0.02199 | Reg=0.00199 | L2-Norm=14.092 | L2-Norm(final)=2.844 | acc=0.9844 | 4402.9 samples/s | 68.8 steps/s
[Step=14600 Epoch=28.5] | Loss=0.02013 | Reg=0.00199 | L2-Norm=14.103 | L2-Norm(final)=2.848 | acc=1.0000 | 4536.8 samples/s | 70.9 steps/s
[Step=14650 Epoch=28.6] | Loss=0.02021 | Reg=0.00199 | L2-Norm=14.113 | L2-Norm(final)=2.850 | acc=0.9844 | 4205.8 samples/s | 65.7 steps/s
[Step=14700 Epoch=28.7] | Loss=0.01899 | Reg=0.00199 | L2-Norm=14.123 | L2-Norm(final)=2.854 | acc=0.9844 | 4386.5 samples/s | 68.5 steps/s
[Step=14750 Epoch=28.8] | Loss=0.01893 | Reg=0.00200 | L2-Norm=14.131 | L2-Norm(final)=2.857 | acc=0.9844 | 4477.3 samples/s | 70.0 steps/s
[Step=14800 Epoch=28.9] | Loss=0.01881 | Reg=0.00200 | L2-Norm=14.140 | L2-Norm(final)=2.860 | acc=0.9844 | 4525.6 samples/s | 70.7 steps/s
[Step=14850 Epoch=29.0] | Loss=0.01861 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=2.862 | acc=0.9844 | 4141.5 samples/s | 64.7 steps/s
[Step=14900 Epoch=29.1] | Loss=0.01854 | Reg=0.00200 | L2-Norm=14.159 | L2-Norm(final)=2.864 | acc=1.0000 | 5618.0 samples/s | 87.8 steps/s
[Step=14950 Epoch=29.2] | Loss=0.01802 | Reg=0.00201 | L2-Norm=14.167 | L2-Norm(final)=2.867 | acc=1.0000 | 1909.0 samples/s | 29.8 steps/s
[Step=15000 Epoch=29.3] | Loss=0.01753 | Reg=0.00201 | L2-Norm=14.176 | L2-Norm(final)=2.870 | acc=1.0000 | 4508.8 samples/s | 70.5 steps/s
[Step=15050 Epoch=29.4] | Loss=0.01730 | Reg=0.00201 | L2-Norm=14.184 | L2-Norm(final)=2.873 | acc=0.9844 | 4517.8 samples/s | 70.6 steps/s
[Step=15100 Epoch=29.5] | Loss=0.01693 | Reg=0.00201 | L2-Norm=14.192 | L2-Norm(final)=2.875 | acc=0.9844 | 4485.1 samples/s | 70.1 steps/s
[Step=15150 Epoch=29.6] | Loss=0.01690 | Reg=0.00202 | L2-Norm=14.199 | L2-Norm(final)=2.878 | acc=1.0000 | 4567.2 samples/s | 71.4 steps/s
[Step=15200 Epoch=29.7] | Loss=0.01662 | Reg=0.00202 | L2-Norm=14.207 | L2-Norm(final)=2.881 | acc=1.0000 | 4615.5 samples/s | 72.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step15200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=55.2] | Loss=0.04275 | Reg=0.00195 | L2-Norm=13.977 | L2-Norm(final)=2.845 | acc=0.9844 | 3794.7 samples/s | 59.3 steps/s
[Step=14450 Epoch=55.4] | Loss=0.00635 | Reg=0.00198 | L2-Norm=14.082 | L2-Norm(final)=2.825 | acc=1.0000 | 3902.8 samples/s | 61.0 steps/s
[Step=14500 Epoch=55.6] | Loss=0.00379 | Reg=0.00200 | L2-Norm=14.128 | L2-Norm(final)=2.821 | acc=1.0000 | 4231.3 samples/s | 66.1 steps/s
[Step=14550 Epoch=55.8] | Loss=0.00261 | Reg=0.00200 | L2-Norm=14.141 | L2-Norm(final)=2.823 | acc=1.0000 | 4253.0 samples/s | 66.5 steps/s
[Step=14600 Epoch=55.9] | Loss=0.00197 | Reg=0.00200 | L2-Norm=14.142 | L2-Norm(final)=2.825 | acc=1.0000 | 4261.5 samples/s | 66.6 steps/s
[Step=14650 Epoch=56.1] | Loss=0.00158 | Reg=0.00200 | L2-Norm=14.137 | L2-Norm(final)=2.827 | acc=1.0000 | 5497.4 samples/s | 85.9 steps/s
[Step=14700 Epoch=56.3] | Loss=0.00133 | Reg=0.00200 | L2-Norm=14.130 | L2-Norm(final)=2.829 | acc=1.0000 | 1850.5 samples/s | 28.9 steps/s
[Step=14750 Epoch=56.5] | Loss=0.00114 | Reg=0.00199 | L2-Norm=14.121 | L2-Norm(final)=2.831 | acc=1.0000 | 4216.4 samples/s | 65.9 steps/s
[Step=14800 Epoch=56.7] | Loss=0.00100 | Reg=0.00199 | L2-Norm=14.112 | L2-Norm(final)=2.833 | acc=1.0000 | 4253.2 samples/s | 66.5 steps/s
[Step=14850 Epoch=56.9] | Loss=0.00089 | Reg=0.00199 | L2-Norm=14.101 | L2-Norm(final)=2.834 | acc=1.0000 | 4186.4 samples/s | 65.4 steps/s
[Step=14900 Epoch=57.1] | Loss=0.00080 | Reg=0.00199 | L2-Norm=14.090 | L2-Norm(final)=2.835 | acc=1.0000 | 4744.4 samples/s | 74.1 steps/s
[Step=14950 Epoch=57.3] | Loss=0.00073 | Reg=0.00198 | L2-Norm=14.079 | L2-Norm(final)=2.836 | acc=1.0000 | 1915.8 samples/s | 29.9 steps/s
[Step=15000 Epoch=57.5] | Loss=0.00067 | Reg=0.00198 | L2-Norm=14.067 | L2-Norm(final)=2.837 | acc=1.0000 | 4391.9 samples/s | 68.6 steps/s
[Step=15050 Epoch=57.7] | Loss=0.00062 | Reg=0.00198 | L2-Norm=14.055 | L2-Norm(final)=2.838 | acc=1.0000 | 4231.7 samples/s | 66.1 steps/s
[Step=15100 Epoch=57.9] | Loss=0.00057 | Reg=0.00197 | L2-Norm=14.043 | L2-Norm(final)=2.839 | acc=1.0000 | 4253.1 samples/s | 66.5 steps/s
[Step=15150 Epoch=58.0] | Loss=0.00053 | Reg=0.00197 | L2-Norm=14.031 | L2-Norm(final)=2.840 | acc=1.0000 | 4312.5 samples/s | 67.4 steps/s
[Step=15200 Epoch=58.2] | Loss=0.00050 | Reg=0.00197 | L2-Norm=14.018 | L2-Norm(final)=2.841 | acc=1.0000 | 1996.3 samples/s | 31.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step15200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=55.4] | Loss=0.01386 | Reg=0.00195 | L2-Norm=13.977 | L2-Norm(final)=2.846 | acc=0.9844 | 3684.6 samples/s | 57.6 steps/s
[Step=14450 Epoch=55.6] | Loss=0.00589 | Reg=0.00198 | L2-Norm=14.073 | L2-Norm(final)=2.840 | acc=1.0000 | 4142.6 samples/s | 64.7 steps/s
[Step=14500 Epoch=55.8] | Loss=0.00381 | Reg=0.00199 | L2-Norm=14.124 | L2-Norm(final)=2.839 | acc=1.0000 | 4242.6 samples/s | 66.3 steps/s
[Step=14550 Epoch=56.0] | Loss=0.00286 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=2.838 | acc=1.0000 | 4252.8 samples/s | 66.4 steps/s
[Step=14600 Epoch=56.2] | Loss=0.00285 | Reg=0.00201 | L2-Norm=14.167 | L2-Norm(final)=2.837 | acc=1.0000 | 4215.4 samples/s | 65.9 steps/s
[Step=14650 Epoch=56.4] | Loss=0.00255 | Reg=0.00201 | L2-Norm=14.184 | L2-Norm(final)=2.836 | acc=1.0000 | 5415.5 samples/s | 84.6 steps/s
[Step=14700 Epoch=56.6] | Loss=0.00214 | Reg=0.00202 | L2-Norm=14.196 | L2-Norm(final)=2.835 | acc=1.0000 | 1823.4 samples/s | 28.5 steps/s
[Step=14750 Epoch=56.8] | Loss=0.00184 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=2.835 | acc=1.0000 | 4256.7 samples/s | 66.5 steps/s
[Step=14800 Epoch=57.0] | Loss=0.00161 | Reg=0.00202 | L2-Norm=14.203 | L2-Norm(final)=2.836 | acc=1.0000 | 4346.1 samples/s | 67.9 steps/s
[Step=14850 Epoch=57.2] | Loss=0.00144 | Reg=0.00202 | L2-Norm=14.203 | L2-Norm(final)=2.837 | acc=1.0000 | 4251.9 samples/s | 66.4 steps/s
[Step=14900 Epoch=57.4] | Loss=0.00130 | Reg=0.00202 | L2-Norm=14.200 | L2-Norm(final)=2.838 | acc=1.0000 | 4864.6 samples/s | 76.0 steps/s
[Step=14950 Epoch=57.5] | Loss=0.00118 | Reg=0.00202 | L2-Norm=14.196 | L2-Norm(final)=2.839 | acc=1.0000 | 1883.4 samples/s | 29.4 steps/s
[Step=15000 Epoch=57.7] | Loss=0.00108 | Reg=0.00201 | L2-Norm=14.191 | L2-Norm(final)=2.839 | acc=1.0000 | 4149.6 samples/s | 64.8 steps/s
[Step=15050 Epoch=57.9] | Loss=0.00100 | Reg=0.00201 | L2-Norm=14.185 | L2-Norm(final)=2.840 | acc=1.0000 | 4206.5 samples/s | 65.7 steps/s
[Step=15100 Epoch=58.1] | Loss=0.00093 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=2.841 | acc=1.0000 | 4260.3 samples/s | 66.6 steps/s
[Step=15150 Epoch=58.3] | Loss=0.00087 | Reg=0.00201 | L2-Norm=14.171 | L2-Norm(final)=2.841 | acc=1.0000 | 4333.1 samples/s | 67.7 steps/s
[Step=15200 Epoch=58.5] | Loss=0.00081 | Reg=0.00201 | L2-Norm=14.163 | L2-Norm(final)=2.842 | acc=1.0000 | 2000.1 samples/s | 31.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34994 | acc=0.8023 | tpr=0.7163 | fpr=0.0109 | 4071.1 samples/s | 15.9 steps/s
Avg test loss: 0.35325, Avg test acc: 0.80375, Avg tpr: 0.71959, Avg fpr: 0.01115, total FA: 87

Testing server on iccad2012
[Step=  50] | Loss=0.31195 | acc=0.8951 | tpr=0.9690 | fpr=0.1063 | 4083.5 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.31086 | acc=0.8964 | tpr=0.9787 | fpr=0.1051 | 7656.7 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.31458 | acc=0.8968 | tpr=0.9827 | fpr=0.1048 | 7678.0 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.31462 | acc=0.8979 | tpr=0.9814 | fpr=0.1036 | 7880.4 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.31322 | acc=0.8979 | tpr=0.9817 | fpr=0.1037 | 7738.0 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.31753 | acc=0.8974 | tpr=0.9811 | fpr=0.1041 | 7558.8 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.32038 | acc=0.8967 | tpr=0.9800 | fpr=0.1048 | 7397.0 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.32190 | acc=0.8965 | tpr=0.9792 | fpr=0.1050 | 7568.7 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.32674 | acc=0.8962 | tpr=0.9791 | fpr=0.1053 | 7001.2 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.32726 | acc=0.8960 | tpr=0.9797 | fpr=0.1055 | 7843.0 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.32647 | acc=0.8961 | tpr=0.9801 | fpr=0.1055 | 13260.7 samples/s | 51.8 steps/s
Avg test loss: 0.32634, Avg test acc: 0.89601, Avg tpr: 0.97979, Avg fpr: 0.10551, total FA: 14650

server round 19/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=29.6] | Loss=0.22974 | Reg=0.00195 | L2-Norm=13.959 | L2-Norm(final)=2.888 | acc=0.8594 | 3610.9 samples/s | 56.4 steps/s
[Step=15250 Epoch=29.7] | Loss=0.03621 | Reg=0.00197 | L2-Norm=14.034 | L2-Norm(final)=2.870 | acc=0.9844 | 4316.9 samples/s | 67.5 steps/s
[Step=15300 Epoch=29.8] | Loss=0.02697 | Reg=0.00198 | L2-Norm=14.062 | L2-Norm(final)=2.875 | acc=1.0000 | 4505.2 samples/s | 70.4 steps/s
[Step=15350 Epoch=29.9] | Loss=0.02494 | Reg=0.00198 | L2-Norm=14.078 | L2-Norm(final)=2.880 | acc=0.9688 | 4486.6 samples/s | 70.1 steps/s
[Step=15400 Epoch=30.0] | Loss=0.02378 | Reg=0.00199 | L2-Norm=14.092 | L2-Norm(final)=2.885 | acc=1.0000 | 4493.9 samples/s | 70.2 steps/s
[Step=15450 Epoch=30.1] | Loss=0.02204 | Reg=0.00199 | L2-Norm=14.105 | L2-Norm(final)=2.891 | acc=0.9844 | 4402.8 samples/s | 68.8 steps/s
[Step=15500 Epoch=30.2] | Loss=0.02172 | Reg=0.00199 | L2-Norm=14.116 | L2-Norm(final)=2.895 | acc=0.9844 | 4622.6 samples/s | 72.2 steps/s
[Step=15550 Epoch=30.3] | Loss=0.02194 | Reg=0.00200 | L2-Norm=14.125 | L2-Norm(final)=2.897 | acc=1.0000 | 4566.8 samples/s | 71.4 steps/s
[Step=15600 Epoch=30.4] | Loss=0.02191 | Reg=0.00200 | L2-Norm=14.135 | L2-Norm(final)=2.898 | acc=0.9531 | 4559.3 samples/s | 71.2 steps/s
[Step=15650 Epoch=30.5] | Loss=0.02130 | Reg=0.00200 | L2-Norm=14.144 | L2-Norm(final)=2.900 | acc=0.9844 | 4564.6 samples/s | 71.3 steps/s
[Step=15700 Epoch=30.6] | Loss=0.02076 | Reg=0.00200 | L2-Norm=14.153 | L2-Norm(final)=2.902 | acc=0.9688 | 5533.5 samples/s | 86.5 steps/s
[Step=15750 Epoch=30.7] | Loss=0.02019 | Reg=0.00201 | L2-Norm=14.162 | L2-Norm(final)=2.904 | acc=1.0000 | 1832.6 samples/s | 28.6 steps/s
[Step=15800 Epoch=30.8] | Loss=0.01974 | Reg=0.00201 | L2-Norm=14.171 | L2-Norm(final)=2.906 | acc=1.0000 | 4513.4 samples/s | 70.5 steps/s
[Step=15850 Epoch=30.9] | Loss=0.01945 | Reg=0.00201 | L2-Norm=14.180 | L2-Norm(final)=2.908 | acc=0.9531 | 4554.0 samples/s | 71.2 steps/s
[Step=15900 Epoch=31.0] | Loss=0.01902 | Reg=0.00201 | L2-Norm=14.189 | L2-Norm(final)=2.911 | acc=0.9688 | 4477.8 samples/s | 70.0 steps/s
[Step=15950 Epoch=31.1] | Loss=0.01872 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=2.914 | acc=0.9844 | 4558.2 samples/s | 71.2 steps/s
[Step=16000 Epoch=31.2] | Loss=0.01846 | Reg=0.00202 | L2-Norm=14.205 | L2-Norm(final)=2.917 | acc=1.0000 | 4530.6 samples/s | 70.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=29.7] | Loss=0.21401 | Reg=0.00195 | L2-Norm=13.959 | L2-Norm(final)=2.888 | acc=0.8281 | 4084.8 samples/s | 63.8 steps/s
[Step=15250 Epoch=29.8] | Loss=0.03421 | Reg=0.00197 | L2-Norm=14.040 | L2-Norm(final)=2.874 | acc=1.0000 | 4338.4 samples/s | 67.8 steps/s
[Step=15300 Epoch=29.9] | Loss=0.02539 | Reg=0.00198 | L2-Norm=14.071 | L2-Norm(final)=2.882 | acc=1.0000 | 4585.6 samples/s | 71.7 steps/s
[Step=15350 Epoch=30.0] | Loss=0.02323 | Reg=0.00198 | L2-Norm=14.088 | L2-Norm(final)=2.889 | acc=0.9844 | 4529.3 samples/s | 70.8 steps/s
[Step=15400 Epoch=30.1] | Loss=0.02227 | Reg=0.00199 | L2-Norm=14.101 | L2-Norm(final)=2.893 | acc=0.9688 | 4497.9 samples/s | 70.3 steps/s
[Step=15450 Epoch=30.2] | Loss=0.02129 | Reg=0.00199 | L2-Norm=14.114 | L2-Norm(final)=2.897 | acc=0.9844 | 4555.3 samples/s | 71.2 steps/s
[Step=15500 Epoch=30.3] | Loss=0.02049 | Reg=0.00200 | L2-Norm=14.125 | L2-Norm(final)=2.901 | acc=0.9688 | 4502.6 samples/s | 70.4 steps/s
[Step=15550 Epoch=30.4] | Loss=0.02047 | Reg=0.00200 | L2-Norm=14.135 | L2-Norm(final)=2.905 | acc=0.9844 | 4587.3 samples/s | 71.7 steps/s
[Step=15600 Epoch=30.5] | Loss=0.02011 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=2.907 | acc=0.9844 | 4612.6 samples/s | 72.1 steps/s
[Step=15650 Epoch=30.6] | Loss=0.01998 | Reg=0.00200 | L2-Norm=14.153 | L2-Norm(final)=2.910 | acc=1.0000 | 4606.9 samples/s | 72.0 steps/s
[Step=15700 Epoch=30.7] | Loss=0.01995 | Reg=0.00201 | L2-Norm=14.161 | L2-Norm(final)=2.912 | acc=1.0000 | 5645.6 samples/s | 88.2 steps/s
[Step=15750 Epoch=30.8] | Loss=0.01928 | Reg=0.00201 | L2-Norm=14.169 | L2-Norm(final)=2.915 | acc=0.9844 | 1915.9 samples/s | 29.9 steps/s
[Step=15800 Epoch=30.9] | Loss=0.01867 | Reg=0.00201 | L2-Norm=14.178 | L2-Norm(final)=2.918 | acc=0.9844 | 4464.9 samples/s | 69.8 steps/s
[Step=15850 Epoch=31.0] | Loss=0.01843 | Reg=0.00201 | L2-Norm=14.185 | L2-Norm(final)=2.921 | acc=0.9844 | 4474.6 samples/s | 69.9 steps/s
[Step=15900 Epoch=31.1] | Loss=0.01803 | Reg=0.00201 | L2-Norm=14.193 | L2-Norm(final)=2.923 | acc=1.0000 | 4557.6 samples/s | 71.2 steps/s
[Step=15950 Epoch=31.2] | Loss=0.01771 | Reg=0.00202 | L2-Norm=14.199 | L2-Norm(final)=2.926 | acc=0.9844 | 4541.7 samples/s | 71.0 steps/s
[Step=16000 Epoch=31.3] | Loss=0.01734 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=2.929 | acc=1.0000 | 4550.0 samples/s | 71.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step16000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=58.2] | Loss=0.00471 | Reg=0.00195 | L2-Norm=13.959 | L2-Norm(final)=2.890 | acc=1.0000 | 4177.5 samples/s | 65.3 steps/s
[Step=15250 Epoch=58.4] | Loss=0.00395 | Reg=0.00198 | L2-Norm=14.088 | L2-Norm(final)=2.899 | acc=1.0000 | 3984.3 samples/s | 62.3 steps/s
[Step=15300 Epoch=58.6] | Loss=0.00366 | Reg=0.00200 | L2-Norm=14.136 | L2-Norm(final)=2.892 | acc=1.0000 | 4168.7 samples/s | 65.1 steps/s
[Step=15350 Epoch=58.8] | Loss=0.00321 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=2.881 | acc=1.0000 | 4235.1 samples/s | 66.2 steps/s
[Step=15400 Epoch=59.0] | Loss=0.00250 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=2.877 | acc=1.0000 | 4179.7 samples/s | 65.3 steps/s
[Step=15450 Epoch=59.2] | Loss=0.00200 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=2.877 | acc=1.0000 | 5270.8 samples/s | 82.4 steps/s
[Step=15500 Epoch=59.4] | Loss=0.00167 | Reg=0.00201 | L2-Norm=14.173 | L2-Norm(final)=2.878 | acc=1.0000 | 1875.9 samples/s | 29.3 steps/s
[Step=15550 Epoch=59.6] | Loss=0.00144 | Reg=0.00201 | L2-Norm=14.168 | L2-Norm(final)=2.879 | acc=1.0000 | 4232.0 samples/s | 66.1 steps/s
[Step=15600 Epoch=59.8] | Loss=0.00126 | Reg=0.00201 | L2-Norm=14.162 | L2-Norm(final)=2.880 | acc=1.0000 | 4335.6 samples/s | 67.7 steps/s
[Step=15650 Epoch=60.0] | Loss=0.00112 | Reg=0.00200 | L2-Norm=14.155 | L2-Norm(final)=2.881 | acc=1.0000 | 4167.1 samples/s | 65.1 steps/s
[Step=15700 Epoch=60.2] | Loss=0.00101 | Reg=0.00200 | L2-Norm=14.146 | L2-Norm(final)=2.881 | acc=1.0000 | 4583.3 samples/s | 71.6 steps/s
[Step=15750 Epoch=60.3] | Loss=0.00092 | Reg=0.00200 | L2-Norm=14.137 | L2-Norm(final)=2.882 | acc=1.0000 | 1945.8 samples/s | 30.4 steps/s
[Step=15800 Epoch=60.5] | Loss=0.00084 | Reg=0.00200 | L2-Norm=14.128 | L2-Norm(final)=2.883 | acc=1.0000 | 4324.2 samples/s | 67.6 steps/s
[Step=15850 Epoch=60.7] | Loss=0.00078 | Reg=0.00199 | L2-Norm=14.118 | L2-Norm(final)=2.884 | acc=1.0000 | 4251.1 samples/s | 66.4 steps/s
[Step=15900 Epoch=60.9] | Loss=0.00072 | Reg=0.00199 | L2-Norm=14.108 | L2-Norm(final)=2.885 | acc=1.0000 | 4290.0 samples/s | 67.0 steps/s
[Step=15950 Epoch=61.1] | Loss=0.00067 | Reg=0.00199 | L2-Norm=14.098 | L2-Norm(final)=2.885 | acc=1.0000 | 4165.6 samples/s | 65.1 steps/s
[Step=16000 Epoch=61.3] | Loss=0.00063 | Reg=0.00198 | L2-Norm=14.087 | L2-Norm(final)=2.886 | acc=1.0000 | 2026.4 samples/s | 31.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=58.5] | Loss=0.02544 | Reg=0.00195 | L2-Norm=13.959 | L2-Norm(final)=2.889 | acc=0.9844 | 4075.2 samples/s | 63.7 steps/s
[Step=15250 Epoch=58.7] | Loss=0.00195 | Reg=0.00197 | L2-Norm=14.025 | L2-Norm(final)=2.896 | acc=1.0000 | 4014.7 samples/s | 62.7 steps/s
[Step=15300 Epoch=58.9] | Loss=0.00115 | Reg=0.00197 | L2-Norm=14.037 | L2-Norm(final)=2.905 | acc=1.0000 | 4266.8 samples/s | 66.7 steps/s
[Step=15350 Epoch=59.1] | Loss=0.00077 | Reg=0.00197 | L2-Norm=14.037 | L2-Norm(final)=2.911 | acc=1.0000 | 4189.4 samples/s | 65.5 steps/s
[Step=15400 Epoch=59.3] | Loss=0.00059 | Reg=0.00197 | L2-Norm=14.031 | L2-Norm(final)=2.915 | acc=1.0000 | 4175.3 samples/s | 65.2 steps/s
[Step=15450 Epoch=59.5] | Loss=0.00048 | Reg=0.00197 | L2-Norm=14.023 | L2-Norm(final)=2.918 | acc=1.0000 | 5445.5 samples/s | 85.1 steps/s
[Step=15500 Epoch=59.7] | Loss=0.00040 | Reg=0.00196 | L2-Norm=14.013 | L2-Norm(final)=2.920 | acc=1.0000 | 1833.7 samples/s | 28.7 steps/s
[Step=15550 Epoch=59.9] | Loss=0.00034 | Reg=0.00196 | L2-Norm=14.003 | L2-Norm(final)=2.922 | acc=1.0000 | 4308.0 samples/s | 67.3 steps/s
[Step=15600 Epoch=60.1] | Loss=0.00030 | Reg=0.00196 | L2-Norm=13.992 | L2-Norm(final)=2.923 | acc=1.0000 | 4239.6 samples/s | 66.2 steps/s
[Step=15650 Epoch=60.2] | Loss=0.00027 | Reg=0.00195 | L2-Norm=13.981 | L2-Norm(final)=2.925 | acc=1.0000 | 4324.3 samples/s | 67.6 steps/s
[Step=15700 Epoch=60.4] | Loss=0.00024 | Reg=0.00195 | L2-Norm=13.969 | L2-Norm(final)=2.926 | acc=1.0000 | 4871.6 samples/s | 76.1 steps/s
[Step=15750 Epoch=60.6] | Loss=0.00022 | Reg=0.00195 | L2-Norm=13.958 | L2-Norm(final)=2.927 | acc=1.0000 | 1923.8 samples/s | 30.1 steps/s
[Step=15800 Epoch=60.8] | Loss=0.00020 | Reg=0.00194 | L2-Norm=13.946 | L2-Norm(final)=2.928 | acc=1.0000 | 4263.8 samples/s | 66.6 steps/s
[Step=15850 Epoch=61.0] | Loss=0.00019 | Reg=0.00194 | L2-Norm=13.934 | L2-Norm(final)=2.929 | acc=1.0000 | 4238.1 samples/s | 66.2 steps/s
[Step=15900 Epoch=61.2] | Loss=0.00017 | Reg=0.00194 | L2-Norm=13.922 | L2-Norm(final)=2.930 | acc=1.0000 | 4192.1 samples/s | 65.5 steps/s
[Step=15950 Epoch=61.4] | Loss=0.00016 | Reg=0.00194 | L2-Norm=13.910 | L2-Norm(final)=2.930 | acc=1.0000 | 3926.6 samples/s | 61.4 steps/s
[Step=16000 Epoch=61.6] | Loss=0.00015 | Reg=0.00193 | L2-Norm=13.898 | L2-Norm(final)=2.931 | acc=1.0000 | 1970.2 samples/s | 30.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34719 | acc=0.7980 | tpr=0.7094 | fpr=0.0097 | 4129.1 samples/s | 16.1 steps/s
Avg test loss: 0.34806, Avg test acc: 0.79898, Avg tpr: 0.71207, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.31450 | acc=0.9004 | tpr=0.9558 | fpr=0.1006 | 4189.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.31629 | acc=0.9006 | tpr=0.9723 | fpr=0.1008 | 7771.9 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.32063 | acc=0.9005 | tpr=0.9769 | fpr=0.1009 | 7976.2 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.32137 | acc=0.9014 | tpr=0.9770 | fpr=0.1000 | 7705.2 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.32008 | acc=0.9014 | tpr=0.9782 | fpr=0.1000 | 7586.3 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.32467 | acc=0.9011 | tpr=0.9782 | fpr=0.1003 | 7547.0 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.32734 | acc=0.9004 | tpr=0.9781 | fpr=0.1010 | 7561.7 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.32900 | acc=0.9002 | tpr=0.9770 | fpr=0.1012 | 7711.5 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.33410 | acc=0.8999 | tpr=0.9761 | fpr=0.1015 | 7961.5 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.33418 | acc=0.8997 | tpr=0.9771 | fpr=0.1017 | 8091.7 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.33350 | acc=0.8997 | tpr=0.9773 | fpr=0.1017 | 14314.1 samples/s | 55.9 steps/s
Avg test loss: 0.33324, Avg test acc: 0.89972, Avg tpr: 0.97702, Avg fpr: 0.10169, total FA: 14119

server round 20/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=31.2] | Loss=0.22961 | Reg=0.00194 | L2-Norm=13.924 | L2-Norm(final)=2.941 | acc=0.8906 | 3697.7 samples/s | 57.8 steps/s
[Step=16050 Epoch=31.3] | Loss=0.03372 | Reg=0.00195 | L2-Norm=13.962 | L2-Norm(final)=2.936 | acc=0.9844 | 4304.9 samples/s | 67.3 steps/s
[Step=16100 Epoch=31.4] | Loss=0.02415 | Reg=0.00195 | L2-Norm=13.974 | L2-Norm(final)=2.942 | acc=0.9844 | 4435.1 samples/s | 69.3 steps/s
[Step=16150 Epoch=31.5] | Loss=0.01960 | Reg=0.00195 | L2-Norm=13.981 | L2-Norm(final)=2.948 | acc=0.9844 | 4480.5 samples/s | 70.0 steps/s
[Step=16200 Epoch=31.6] | Loss=0.01800 | Reg=0.00196 | L2-Norm=13.986 | L2-Norm(final)=2.953 | acc=0.9531 | 4466.4 samples/s | 69.8 steps/s
[Step=16250 Epoch=31.7] | Loss=0.01674 | Reg=0.00196 | L2-Norm=13.990 | L2-Norm(final)=2.957 | acc=1.0000 | 4458.1 samples/s | 69.7 steps/s
[Step=16300 Epoch=31.8] | Loss=0.01662 | Reg=0.00196 | L2-Norm=13.993 | L2-Norm(final)=2.961 | acc=1.0000 | 4578.4 samples/s | 71.5 steps/s
[Step=16350 Epoch=31.9] | Loss=0.01565 | Reg=0.00196 | L2-Norm=13.995 | L2-Norm(final)=2.964 | acc=0.9844 | 4521.6 samples/s | 70.7 steps/s
[Step=16400 Epoch=32.0] | Loss=0.01521 | Reg=0.00196 | L2-Norm=13.998 | L2-Norm(final)=2.967 | acc=0.9844 | 4523.7 samples/s | 70.7 steps/s
[Step=16450 Epoch=32.1] | Loss=0.01493 | Reg=0.00196 | L2-Norm=14.001 | L2-Norm(final)=2.969 | acc=0.9844 | 4559.2 samples/s | 71.2 steps/s
[Step=16500 Epoch=32.2] | Loss=0.01489 | Reg=0.00196 | L2-Norm=14.003 | L2-Norm(final)=2.972 | acc=1.0000 | 5494.0 samples/s | 85.8 steps/s
[Step=16550 Epoch=32.3] | Loss=0.01462 | Reg=0.00196 | L2-Norm=14.006 | L2-Norm(final)=2.974 | acc=0.9844 | 1833.9 samples/s | 28.7 steps/s
[Step=16600 Epoch=32.4] | Loss=0.01391 | Reg=0.00196 | L2-Norm=14.009 | L2-Norm(final)=2.976 | acc=1.0000 | 4485.7 samples/s | 70.1 steps/s
[Step=16650 Epoch=32.5] | Loss=0.01351 | Reg=0.00196 | L2-Norm=14.012 | L2-Norm(final)=2.979 | acc=0.9844 | 4536.8 samples/s | 70.9 steps/s
[Step=16700 Epoch=32.6] | Loss=0.01330 | Reg=0.00196 | L2-Norm=14.014 | L2-Norm(final)=2.982 | acc=1.0000 | 4275.0 samples/s | 66.8 steps/s
[Step=16750 Epoch=32.7] | Loss=0.01305 | Reg=0.00196 | L2-Norm=14.016 | L2-Norm(final)=2.985 | acc=1.0000 | 4501.5 samples/s | 70.3 steps/s
[Step=16800 Epoch=32.8] | Loss=0.01281 | Reg=0.00197 | L2-Norm=14.018 | L2-Norm(final)=2.987 | acc=1.0000 | 4613.4 samples/s | 72.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=31.3] | Loss=0.47503 | Reg=0.00194 | L2-Norm=13.924 | L2-Norm(final)=2.941 | acc=0.7344 | 3933.0 samples/s | 61.5 steps/s
[Step=16050 Epoch=31.4] | Loss=0.04178 | Reg=0.00195 | L2-Norm=13.958 | L2-Norm(final)=2.930 | acc=1.0000 | 4566.6 samples/s | 71.4 steps/s
[Step=16100 Epoch=31.5] | Loss=0.02836 | Reg=0.00195 | L2-Norm=13.970 | L2-Norm(final)=2.936 | acc=0.9844 | 4435.5 samples/s | 69.3 steps/s
[Step=16150 Epoch=31.6] | Loss=0.02247 | Reg=0.00195 | L2-Norm=13.976 | L2-Norm(final)=2.941 | acc=1.0000 | 4488.8 samples/s | 70.1 steps/s
[Step=16200 Epoch=31.7] | Loss=0.02010 | Reg=0.00195 | L2-Norm=13.980 | L2-Norm(final)=2.946 | acc=0.9844 | 4435.3 samples/s | 69.3 steps/s
[Step=16250 Epoch=31.8] | Loss=0.01888 | Reg=0.00196 | L2-Norm=13.984 | L2-Norm(final)=2.950 | acc=0.9844 | 4490.3 samples/s | 70.2 steps/s
[Step=16300 Epoch=31.9] | Loss=0.01767 | Reg=0.00196 | L2-Norm=13.987 | L2-Norm(final)=2.954 | acc=1.0000 | 4515.0 samples/s | 70.5 steps/s
[Step=16350 Epoch=32.0] | Loss=0.01652 | Reg=0.00196 | L2-Norm=13.990 | L2-Norm(final)=2.958 | acc=1.0000 | 4402.6 samples/s | 68.8 steps/s
[Step=16400 Epoch=32.1] | Loss=0.01612 | Reg=0.00196 | L2-Norm=13.993 | L2-Norm(final)=2.961 | acc=0.9844 | 4432.9 samples/s | 69.3 steps/s
[Step=16450 Epoch=32.2] | Loss=0.01561 | Reg=0.00196 | L2-Norm=13.995 | L2-Norm(final)=2.963 | acc=1.0000 | 4581.1 samples/s | 71.6 steps/s
[Step=16500 Epoch=32.3] | Loss=0.01522 | Reg=0.00196 | L2-Norm=13.998 | L2-Norm(final)=2.966 | acc=0.9844 | 5651.8 samples/s | 88.3 steps/s
[Step=16550 Epoch=32.4] | Loss=0.01462 | Reg=0.00196 | L2-Norm=14.000 | L2-Norm(final)=2.968 | acc=1.0000 | 1929.8 samples/s | 30.2 steps/s
[Step=16600 Epoch=32.5] | Loss=0.01404 | Reg=0.00196 | L2-Norm=14.002 | L2-Norm(final)=2.970 | acc=0.9844 | 4593.1 samples/s | 71.8 steps/s
[Step=16650 Epoch=32.6] | Loss=0.01370 | Reg=0.00196 | L2-Norm=14.005 | L2-Norm(final)=2.973 | acc=1.0000 | 4614.2 samples/s | 72.1 steps/s
[Step=16700 Epoch=32.6] | Loss=0.01343 | Reg=0.00196 | L2-Norm=14.007 | L2-Norm(final)=2.975 | acc=1.0000 | 4431.2 samples/s | 69.2 steps/s
[Step=16750 Epoch=32.7] | Loss=0.01313 | Reg=0.00196 | L2-Norm=14.009 | L2-Norm(final)=2.978 | acc=0.9688 | 4546.8 samples/s | 71.0 steps/s
[Step=16800 Epoch=32.8] | Loss=0.01295 | Reg=0.00196 | L2-Norm=14.011 | L2-Norm(final)=2.980 | acc=0.9844 | 4520.0 samples/s | 70.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step16800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=61.3] | Loss=0.07397 | Reg=0.00194 | L2-Norm=13.924 | L2-Norm(final)=2.942 | acc=0.9531 | 4096.7 samples/s | 64.0 steps/s
[Step=16050 Epoch=61.5] | Loss=0.00474 | Reg=0.00195 | L2-Norm=13.963 | L2-Norm(final)=2.943 | acc=1.0000 | 3791.4 samples/s | 59.2 steps/s
[Step=16100 Epoch=61.7] | Loss=0.00265 | Reg=0.00195 | L2-Norm=13.973 | L2-Norm(final)=2.944 | acc=1.0000 | 4262.0 samples/s | 66.6 steps/s
[Step=16150 Epoch=61.9] | Loss=0.00183 | Reg=0.00195 | L2-Norm=13.974 | L2-Norm(final)=2.945 | acc=1.0000 | 4177.0 samples/s | 65.3 steps/s
[Step=16200 Epoch=62.1] | Loss=0.00148 | Reg=0.00195 | L2-Norm=13.974 | L2-Norm(final)=2.945 | acc=1.0000 | 4212.9 samples/s | 65.8 steps/s
[Step=16250 Epoch=62.3] | Loss=0.00120 | Reg=0.00195 | L2-Norm=13.972 | L2-Norm(final)=2.946 | acc=1.0000 | 5334.6 samples/s | 83.4 steps/s
[Step=16300 Epoch=62.5] | Loss=0.00100 | Reg=0.00195 | L2-Norm=13.969 | L2-Norm(final)=2.947 | acc=1.0000 | 1839.1 samples/s | 28.7 steps/s
[Step=16350 Epoch=62.6] | Loss=0.00086 | Reg=0.00195 | L2-Norm=13.966 | L2-Norm(final)=2.948 | acc=1.0000 | 4278.5 samples/s | 66.9 steps/s
[Step=16400 Epoch=62.8] | Loss=0.00075 | Reg=0.00195 | L2-Norm=13.962 | L2-Norm(final)=2.948 | acc=1.0000 | 3879.8 samples/s | 60.6 steps/s
[Step=16450 Epoch=63.0] | Loss=0.00067 | Reg=0.00195 | L2-Norm=13.957 | L2-Norm(final)=2.949 | acc=1.0000 | 4094.1 samples/s | 64.0 steps/s
[Step=16500 Epoch=63.2] | Loss=0.00061 | Reg=0.00195 | L2-Norm=13.953 | L2-Norm(final)=2.950 | acc=1.0000 | 4695.2 samples/s | 73.4 steps/s
[Step=16550 Epoch=63.4] | Loss=0.00056 | Reg=0.00195 | L2-Norm=13.948 | L2-Norm(final)=2.951 | acc=1.0000 | 1930.9 samples/s | 30.2 steps/s
[Step=16600 Epoch=63.6] | Loss=0.00051 | Reg=0.00194 | L2-Norm=13.944 | L2-Norm(final)=2.952 | acc=1.0000 | 4348.5 samples/s | 67.9 steps/s
[Step=16650 Epoch=63.8] | Loss=0.00048 | Reg=0.00194 | L2-Norm=13.939 | L2-Norm(final)=2.952 | acc=1.0000 | 4205.9 samples/s | 65.7 steps/s
[Step=16700 Epoch=64.0] | Loss=0.00044 | Reg=0.00194 | L2-Norm=13.934 | L2-Norm(final)=2.953 | acc=1.0000 | 4195.6 samples/s | 65.6 steps/s
[Step=16750 Epoch=64.2] | Loss=0.00041 | Reg=0.00194 | L2-Norm=13.929 | L2-Norm(final)=2.954 | acc=1.0000 | 4288.0 samples/s | 67.0 steps/s
[Step=16800 Epoch=64.4] | Loss=0.00039 | Reg=0.00194 | L2-Norm=13.924 | L2-Norm(final)=2.955 | acc=1.0000 | 2030.0 samples/s | 31.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=61.6] | Loss=0.02868 | Reg=0.00194 | L2-Norm=13.924 | L2-Norm(final)=2.942 | acc=0.9844 | 3898.1 samples/s | 60.9 steps/s
[Step=16050 Epoch=61.8] | Loss=0.00457 | Reg=0.00195 | L2-Norm=13.962 | L2-Norm(final)=2.937 | acc=1.0000 | 4111.0 samples/s | 64.2 steps/s
[Step=16100 Epoch=62.0] | Loss=0.00238 | Reg=0.00195 | L2-Norm=13.971 | L2-Norm(final)=2.939 | acc=1.0000 | 4326.4 samples/s | 67.6 steps/s
[Step=16150 Epoch=62.2] | Loss=0.00161 | Reg=0.00195 | L2-Norm=13.971 | L2-Norm(final)=2.941 | acc=1.0000 | 4447.2 samples/s | 69.5 steps/s
[Step=16200 Epoch=62.4] | Loss=0.00126 | Reg=0.00195 | L2-Norm=13.969 | L2-Norm(final)=2.944 | acc=1.0000 | 4250.8 samples/s | 66.4 steps/s
[Step=16250 Epoch=62.6] | Loss=0.00102 | Reg=0.00195 | L2-Norm=13.966 | L2-Norm(final)=2.947 | acc=1.0000 | 5442.6 samples/s | 85.0 steps/s
[Step=16300 Epoch=62.7] | Loss=0.00085 | Reg=0.00195 | L2-Norm=13.962 | L2-Norm(final)=2.949 | acc=1.0000 | 1805.5 samples/s | 28.2 steps/s
[Step=16350 Epoch=62.9] | Loss=0.00073 | Reg=0.00195 | L2-Norm=13.958 | L2-Norm(final)=2.950 | acc=1.0000 | 4120.1 samples/s | 64.4 steps/s
[Step=16400 Epoch=63.1] | Loss=0.00064 | Reg=0.00195 | L2-Norm=13.953 | L2-Norm(final)=2.952 | acc=1.0000 | 4317.4 samples/s | 67.5 steps/s
[Step=16450 Epoch=63.3] | Loss=0.00057 | Reg=0.00195 | L2-Norm=13.947 | L2-Norm(final)=2.953 | acc=1.0000 | 4138.9 samples/s | 64.7 steps/s
[Step=16500 Epoch=63.5] | Loss=0.00052 | Reg=0.00194 | L2-Norm=13.942 | L2-Norm(final)=2.954 | acc=1.0000 | 4919.5 samples/s | 76.9 steps/s
[Step=16550 Epoch=63.7] | Loss=0.00047 | Reg=0.00194 | L2-Norm=13.936 | L2-Norm(final)=2.955 | acc=1.0000 | 1915.1 samples/s | 29.9 steps/s
[Step=16600 Epoch=63.9] | Loss=0.00043 | Reg=0.00194 | L2-Norm=13.931 | L2-Norm(final)=2.956 | acc=1.0000 | 4262.6 samples/s | 66.6 steps/s
[Step=16650 Epoch=64.1] | Loss=0.00040 | Reg=0.00194 | L2-Norm=13.925 | L2-Norm(final)=2.957 | acc=1.0000 | 4173.2 samples/s | 65.2 steps/s
[Step=16700 Epoch=64.3] | Loss=0.00037 | Reg=0.00194 | L2-Norm=13.919 | L2-Norm(final)=2.958 | acc=1.0000 | 4258.9 samples/s | 66.5 steps/s
[Step=16750 Epoch=64.5] | Loss=0.00035 | Reg=0.00194 | L2-Norm=13.913 | L2-Norm(final)=2.958 | acc=1.0000 | 4283.5 samples/s | 66.9 steps/s
[Step=16800 Epoch=64.7] | Loss=0.00033 | Reg=0.00193 | L2-Norm=13.907 | L2-Norm(final)=2.959 | acc=1.0000 | 1964.8 samples/s | 30.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30339 | acc=0.8280 | tpr=0.7539 | fpr=0.0111 | 4035.2 samples/s | 15.8 steps/s
Avg test loss: 0.30670, Avg test acc: 0.82811, Avg tpr: 0.75509, Avg fpr: 0.01128, total FA: 88

Testing server on iccad2012
[Step=  50] | Loss=0.35455 | acc=0.8894 | tpr=0.9558 | fpr=0.1118 | 4134.5 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.35440 | acc=0.8910 | tpr=0.9723 | fpr=0.1105 | 7661.0 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.35759 | acc=0.8906 | tpr=0.9784 | fpr=0.1110 | 8001.0 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.35762 | acc=0.8918 | tpr=0.9781 | fpr=0.1098 | 7519.8 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.35586 | acc=0.8924 | tpr=0.9790 | fpr=0.1092 | 8146.6 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.36021 | acc=0.8919 | tpr=0.9789 | fpr=0.1097 | 7404.9 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.36338 | acc=0.8913 | tpr=0.9781 | fpr=0.1103 | 7729.2 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.36537 | acc=0.8912 | tpr=0.9770 | fpr=0.1104 | 7529.8 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.37052 | acc=0.8909 | tpr=0.9766 | fpr=0.1106 | 7690.6 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.37065 | acc=0.8907 | tpr=0.9767 | fpr=0.1109 | 7559.3 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.36990 | acc=0.8908 | tpr=0.9769 | fpr=0.1108 | 14083.2 samples/s | 55.0 steps/s
Avg test loss: 0.36973, Avg test acc: 0.89076, Avg tpr: 0.97662, Avg fpr: 0.11080, total FA: 15385

server round 21/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=32.8] | Loss=0.28746 | Reg=0.00193 | L2-Norm=13.882 | L2-Norm(final)=2.992 | acc=0.8594 | 3720.8 samples/s | 58.1 steps/s
[Step=16850 Epoch=32.9] | Loss=0.02906 | Reg=0.00193 | L2-Norm=13.910 | L2-Norm(final)=2.987 | acc=1.0000 | 4216.9 samples/s | 65.9 steps/s
[Step=16900 Epoch=33.0] | Loss=0.02174 | Reg=0.00194 | L2-Norm=13.922 | L2-Norm(final)=2.993 | acc=0.9844 | 4558.8 samples/s | 71.2 steps/s
[Step=16950 Epoch=33.1] | Loss=0.01962 | Reg=0.00194 | L2-Norm=13.927 | L2-Norm(final)=2.996 | acc=1.0000 | 4416.1 samples/s | 69.0 steps/s
[Step=17000 Epoch=33.2] | Loss=0.01733 | Reg=0.00194 | L2-Norm=13.932 | L2-Norm(final)=3.000 | acc=1.0000 | 4462.1 samples/s | 69.7 steps/s
[Step=17050 Epoch=33.3] | Loss=0.01604 | Reg=0.00194 | L2-Norm=13.936 | L2-Norm(final)=3.004 | acc=0.9844 | 4574.2 samples/s | 71.5 steps/s
[Step=17100 Epoch=33.4] | Loss=0.01502 | Reg=0.00194 | L2-Norm=13.940 | L2-Norm(final)=3.008 | acc=0.9688 | 4512.3 samples/s | 70.5 steps/s
[Step=17150 Epoch=33.4] | Loss=0.01491 | Reg=0.00194 | L2-Norm=13.944 | L2-Norm(final)=3.011 | acc=0.9844 | 4435.9 samples/s | 69.3 steps/s
[Step=17200 Epoch=33.5] | Loss=0.01450 | Reg=0.00195 | L2-Norm=13.947 | L2-Norm(final)=3.015 | acc=1.0000 | 4501.3 samples/s | 70.3 steps/s
[Step=17250 Epoch=33.6] | Loss=0.01421 | Reg=0.00195 | L2-Norm=13.951 | L2-Norm(final)=3.017 | acc=1.0000 | 4488.9 samples/s | 70.1 steps/s
[Step=17300 Epoch=33.7] | Loss=0.01380 | Reg=0.00195 | L2-Norm=13.954 | L2-Norm(final)=3.020 | acc=0.9844 | 5389.2 samples/s | 84.2 steps/s
[Step=17350 Epoch=33.8] | Loss=0.01359 | Reg=0.00195 | L2-Norm=13.957 | L2-Norm(final)=3.024 | acc=0.9844 | 1832.1 samples/s | 28.6 steps/s
[Step=17400 Epoch=33.9] | Loss=0.01340 | Reg=0.00195 | L2-Norm=13.960 | L2-Norm(final)=3.027 | acc=0.9844 | 4396.2 samples/s | 68.7 steps/s
[Step=17450 Epoch=34.0] | Loss=0.01312 | Reg=0.00195 | L2-Norm=13.963 | L2-Norm(final)=3.030 | acc=0.9844 | 4421.6 samples/s | 69.1 steps/s
[Step=17500 Epoch=34.1] | Loss=0.01299 | Reg=0.00195 | L2-Norm=13.966 | L2-Norm(final)=3.033 | acc=0.9844 | 4506.9 samples/s | 70.4 steps/s
[Step=17550 Epoch=34.2] | Loss=0.01275 | Reg=0.00195 | L2-Norm=13.968 | L2-Norm(final)=3.035 | acc=0.9844 | 4466.3 samples/s | 69.8 steps/s
[Step=17600 Epoch=34.3] | Loss=0.01255 | Reg=0.00195 | L2-Norm=13.971 | L2-Norm(final)=3.038 | acc=1.0000 | 4509.6 samples/s | 70.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step17600.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=32.8] | Loss=0.08760 | Reg=0.00193 | L2-Norm=13.882 | L2-Norm(final)=2.992 | acc=0.9219 | 3930.0 samples/s | 61.4 steps/s
[Step=16850 Epoch=32.9] | Loss=0.02725 | Reg=0.00194 | L2-Norm=13.917 | L2-Norm(final)=2.990 | acc=0.9844 | 4513.6 samples/s | 70.5 steps/s
[Step=16900 Epoch=33.0] | Loss=0.01980 | Reg=0.00194 | L2-Norm=13.927 | L2-Norm(final)=2.994 | acc=0.9844 | 4540.3 samples/s | 70.9 steps/s
[Step=16950 Epoch=33.1] | Loss=0.01737 | Reg=0.00194 | L2-Norm=13.933 | L2-Norm(final)=2.998 | acc=1.0000 | 4588.8 samples/s | 71.7 steps/s
[Step=17000 Epoch=33.2] | Loss=0.01609 | Reg=0.00194 | L2-Norm=13.937 | L2-Norm(final)=3.002 | acc=0.9844 | 4447.5 samples/s | 69.5 steps/s
[Step=17050 Epoch=33.3] | Loss=0.01559 | Reg=0.00194 | L2-Norm=13.941 | L2-Norm(final)=3.006 | acc=0.9844 | 4511.5 samples/s | 70.5 steps/s
[Step=17100 Epoch=33.4] | Loss=0.01446 | Reg=0.00194 | L2-Norm=13.944 | L2-Norm(final)=3.009 | acc=0.9844 | 4429.7 samples/s | 69.2 steps/s
[Step=17150 Epoch=33.5] | Loss=0.01385 | Reg=0.00195 | L2-Norm=13.948 | L2-Norm(final)=3.013 | acc=1.0000 | 4554.1 samples/s | 71.2 steps/s
[Step=17200 Epoch=33.6] | Loss=0.01322 | Reg=0.00195 | L2-Norm=13.951 | L2-Norm(final)=3.016 | acc=0.9844 | 4517.9 samples/s | 70.6 steps/s
[Step=17250 Epoch=33.7] | Loss=0.01307 | Reg=0.00195 | L2-Norm=13.954 | L2-Norm(final)=3.019 | acc=1.0000 | 4511.3 samples/s | 70.5 steps/s
[Step=17300 Epoch=33.8] | Loss=0.01313 | Reg=0.00195 | L2-Norm=13.957 | L2-Norm(final)=3.022 | acc=1.0000 | 5640.1 samples/s | 88.1 steps/s
[Step=17350 Epoch=33.9] | Loss=0.01270 | Reg=0.00195 | L2-Norm=13.960 | L2-Norm(final)=3.024 | acc=0.9844 | 1904.3 samples/s | 29.8 steps/s
[Step=17400 Epoch=34.0] | Loss=0.01252 | Reg=0.00195 | L2-Norm=13.962 | L2-Norm(final)=3.026 | acc=0.9688 | 4509.2 samples/s | 70.5 steps/s
[Step=17450 Epoch=34.1] | Loss=0.01211 | Reg=0.00195 | L2-Norm=13.965 | L2-Norm(final)=3.029 | acc=0.9844 | 4523.4 samples/s | 70.7 steps/s
[Step=17500 Epoch=34.2] | Loss=0.01197 | Reg=0.00195 | L2-Norm=13.967 | L2-Norm(final)=3.031 | acc=1.0000 | 4543.5 samples/s | 71.0 steps/s
[Step=17550 Epoch=34.3] | Loss=0.01176 | Reg=0.00195 | L2-Norm=13.969 | L2-Norm(final)=3.033 | acc=1.0000 | 4368.6 samples/s | 68.3 steps/s
[Step=17600 Epoch=34.4] | Loss=0.01148 | Reg=0.00195 | L2-Norm=13.971 | L2-Norm(final)=3.036 | acc=0.9844 | 4630.1 samples/s | 72.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step17600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=64.4] | Loss=0.06970 | Reg=0.00193 | L2-Norm=13.882 | L2-Norm(final)=2.991 | acc=0.9844 | 3966.4 samples/s | 62.0 steps/s
[Step=16850 Epoch=64.6] | Loss=0.00318 | Reg=0.00193 | L2-Norm=13.910 | L2-Norm(final)=2.988 | acc=1.0000 | 3959.5 samples/s | 61.9 steps/s
[Step=16900 Epoch=64.8] | Loss=0.00162 | Reg=0.00194 | L2-Norm=13.912 | L2-Norm(final)=2.990 | acc=1.0000 | 4301.1 samples/s | 67.2 steps/s
[Step=16950 Epoch=64.9] | Loss=0.00120 | Reg=0.00193 | L2-Norm=13.909 | L2-Norm(final)=2.992 | acc=1.0000 | 4181.5 samples/s | 65.3 steps/s
[Step=17000 Epoch=65.1] | Loss=0.00094 | Reg=0.00193 | L2-Norm=13.906 | L2-Norm(final)=2.994 | acc=1.0000 | 4260.5 samples/s | 66.6 steps/s
[Step=17050 Epoch=65.3] | Loss=0.00076 | Reg=0.00193 | L2-Norm=13.903 | L2-Norm(final)=2.996 | acc=1.0000 | 5353.9 samples/s | 83.7 steps/s
[Step=17100 Epoch=65.5] | Loss=0.00064 | Reg=0.00193 | L2-Norm=13.898 | L2-Norm(final)=2.998 | acc=1.0000 | 1849.4 samples/s | 28.9 steps/s
[Step=17150 Epoch=65.7] | Loss=0.00055 | Reg=0.00193 | L2-Norm=13.893 | L2-Norm(final)=2.999 | acc=1.0000 | 4305.0 samples/s | 67.3 steps/s
[Step=17200 Epoch=65.9] | Loss=0.00048 | Reg=0.00193 | L2-Norm=13.888 | L2-Norm(final)=3.000 | acc=1.0000 | 4184.1 samples/s | 65.4 steps/s
[Step=17250 Epoch=66.1] | Loss=0.00043 | Reg=0.00193 | L2-Norm=13.883 | L2-Norm(final)=3.001 | acc=1.0000 | 4218.1 samples/s | 65.9 steps/s
[Step=17300 Epoch=66.3] | Loss=0.00039 | Reg=0.00193 | L2-Norm=13.877 | L2-Norm(final)=3.002 | acc=1.0000 | 4613.5 samples/s | 72.1 steps/s
[Step=17350 Epoch=66.5] | Loss=0.00035 | Reg=0.00192 | L2-Norm=13.871 | L2-Norm(final)=3.003 | acc=1.0000 | 1921.8 samples/s | 30.0 steps/s
[Step=17400 Epoch=66.7] | Loss=0.00032 | Reg=0.00192 | L2-Norm=13.865 | L2-Norm(final)=3.004 | acc=1.0000 | 4245.9 samples/s | 66.3 steps/s
[Step=17450 Epoch=66.9] | Loss=0.00030 | Reg=0.00192 | L2-Norm=13.859 | L2-Norm(final)=3.005 | acc=1.0000 | 4212.5 samples/s | 65.8 steps/s
[Step=17500 Epoch=67.1] | Loss=0.00028 | Reg=0.00192 | L2-Norm=13.852 | L2-Norm(final)=3.005 | acc=1.0000 | 4211.6 samples/s | 65.8 steps/s
[Step=17550 Epoch=67.2] | Loss=0.00026 | Reg=0.00192 | L2-Norm=13.846 | L2-Norm(final)=3.006 | acc=1.0000 | 4348.0 samples/s | 67.9 steps/s
[Step=17600 Epoch=67.4] | Loss=0.00025 | Reg=0.00192 | L2-Norm=13.840 | L2-Norm(final)=3.007 | acc=1.0000 | 2037.9 samples/s | 31.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step17600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=64.7] | Loss=0.02239 | Reg=0.00193 | L2-Norm=13.882 | L2-Norm(final)=2.992 | acc=0.9688 | 3804.5 samples/s | 59.4 steps/s
[Step=16850 Epoch=64.9] | Loss=0.00428 | Reg=0.00194 | L2-Norm=13.932 | L2-Norm(final)=2.985 | acc=1.0000 | 4116.3 samples/s | 64.3 steps/s
[Step=16900 Epoch=65.1] | Loss=0.00279 | Reg=0.00194 | L2-Norm=13.943 | L2-Norm(final)=2.985 | acc=1.0000 | 4258.7 samples/s | 66.5 steps/s
[Step=16950 Epoch=65.2] | Loss=0.00218 | Reg=0.00195 | L2-Norm=13.948 | L2-Norm(final)=2.984 | acc=1.0000 | 4318.4 samples/s | 67.5 steps/s
[Step=17000 Epoch=65.4] | Loss=0.00167 | Reg=0.00195 | L2-Norm=13.949 | L2-Norm(final)=2.984 | acc=1.0000 | 4316.4 samples/s | 67.4 steps/s
[Step=17050 Epoch=65.6] | Loss=0.00134 | Reg=0.00195 | L2-Norm=13.947 | L2-Norm(final)=2.984 | acc=1.0000 | 5529.7 samples/s | 86.4 steps/s
[Step=17100 Epoch=65.8] | Loss=0.00112 | Reg=0.00194 | L2-Norm=13.944 | L2-Norm(final)=2.985 | acc=1.0000 | 1845.5 samples/s | 28.8 steps/s
[Step=17150 Epoch=66.0] | Loss=0.00096 | Reg=0.00194 | L2-Norm=13.940 | L2-Norm(final)=2.985 | acc=1.0000 | 4403.8 samples/s | 68.8 steps/s
[Step=17200 Epoch=66.2] | Loss=0.00084 | Reg=0.00194 | L2-Norm=13.936 | L2-Norm(final)=2.985 | acc=1.0000 | 4237.0 samples/s | 66.2 steps/s
[Step=17250 Epoch=66.4] | Loss=0.00075 | Reg=0.00194 | L2-Norm=13.931 | L2-Norm(final)=2.986 | acc=1.0000 | 4289.7 samples/s | 67.0 steps/s
[Step=17300 Epoch=66.6] | Loss=0.00068 | Reg=0.00194 | L2-Norm=13.927 | L2-Norm(final)=2.987 | acc=1.0000 | 4830.9 samples/s | 75.5 steps/s
[Step=17350 Epoch=66.8] | Loss=0.00062 | Reg=0.00194 | L2-Norm=13.921 | L2-Norm(final)=2.987 | acc=1.0000 | 1915.2 samples/s | 29.9 steps/s
[Step=17400 Epoch=67.0] | Loss=0.00057 | Reg=0.00194 | L2-Norm=13.916 | L2-Norm(final)=2.988 | acc=1.0000 | 4238.8 samples/s | 66.2 steps/s
[Step=17450 Epoch=67.2] | Loss=0.00052 | Reg=0.00194 | L2-Norm=13.911 | L2-Norm(final)=2.988 | acc=1.0000 | 4199.3 samples/s | 65.6 steps/s
[Step=17500 Epoch=67.4] | Loss=0.00049 | Reg=0.00193 | L2-Norm=13.905 | L2-Norm(final)=2.989 | acc=1.0000 | 4167.6 samples/s | 65.1 steps/s
[Step=17550 Epoch=67.6] | Loss=0.00045 | Reg=0.00193 | L2-Norm=13.900 | L2-Norm(final)=2.989 | acc=1.0000 | 4345.4 samples/s | 67.9 steps/s
[Step=17600 Epoch=67.7] | Loss=0.00043 | Reg=0.00193 | L2-Norm=13.894 | L2-Norm(final)=2.990 | acc=1.0000 | 2006.8 samples/s | 31.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29866 | acc=0.8359 | tpr=0.7653 | fpr=0.0109 | 4138.9 samples/s | 16.2 steps/s
Avg test loss: 0.30149, Avg test acc: 0.83669, Avg tpr: 0.76768, Avg fpr: 0.01154, total FA: 90

Testing server on iccad2012
[Step=  50] | Loss=0.33823 | acc=0.8990 | tpr=0.9602 | fpr=0.1021 | 4175.7 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.33931 | acc=0.9012 | tpr=0.9723 | fpr=0.1002 | 8115.7 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.34344 | acc=0.9009 | tpr=0.9769 | fpr=0.1005 | 7798.4 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.34369 | acc=0.9019 | tpr=0.9770 | fpr=0.0995 | 8051.2 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.34225 | acc=0.9016 | tpr=0.9773 | fpr=0.0998 | 7272.4 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.34650 | acc=0.9011 | tpr=0.9767 | fpr=0.1003 | 7427.2 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.34973 | acc=0.9004 | tpr=0.9762 | fpr=0.1010 | 7489.1 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.35241 | acc=0.9000 | tpr=0.9754 | fpr=0.1014 | 7780.1 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.35759 | acc=0.8995 | tpr=0.9747 | fpr=0.1018 | 7867.5 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.35760 | acc=0.8993 | tpr=0.9758 | fpr=0.1020 | 7969.1 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.35680 | acc=0.8995 | tpr=0.9761 | fpr=0.1018 | 14619.5 samples/s | 57.1 steps/s
Avg test loss: 0.35668, Avg test acc: 0.89952, Avg tpr: 0.97623, Avg fpr: 0.10187, total FA: 14145

server round 22/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=34.3] | Loss=0.09458 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.040 | acc=0.9219 | 3834.8 samples/s | 59.9 steps/s
[Step=17650 Epoch=34.4] | Loss=0.02394 | Reg=0.00192 | L2-Norm=13.869 | L2-Norm(final)=3.038 | acc=1.0000 | 4508.4 samples/s | 70.4 steps/s
[Step=17700 Epoch=34.5] | Loss=0.01856 | Reg=0.00193 | L2-Norm=13.880 | L2-Norm(final)=3.041 | acc=0.9844 | 4376.4 samples/s | 68.4 steps/s
[Step=17750 Epoch=34.6] | Loss=0.01677 | Reg=0.00193 | L2-Norm=13.887 | L2-Norm(final)=3.045 | acc=1.0000 | 4445.5 samples/s | 69.5 steps/s
[Step=17800 Epoch=34.7] | Loss=0.01519 | Reg=0.00193 | L2-Norm=13.892 | L2-Norm(final)=3.047 | acc=0.9688 | 4441.2 samples/s | 69.4 steps/s
[Step=17850 Epoch=34.8] | Loss=0.01398 | Reg=0.00193 | L2-Norm=13.896 | L2-Norm(final)=3.051 | acc=1.0000 | 4518.7 samples/s | 70.6 steps/s
[Step=17900 Epoch=34.9] | Loss=0.01398 | Reg=0.00193 | L2-Norm=13.901 | L2-Norm(final)=3.056 | acc=0.9844 | 4517.8 samples/s | 70.6 steps/s
[Step=17950 Epoch=35.0] | Loss=0.01364 | Reg=0.00193 | L2-Norm=13.904 | L2-Norm(final)=3.059 | acc=1.0000 | 4395.8 samples/s | 68.7 steps/s
[Step=18000 Epoch=35.1] | Loss=0.01351 | Reg=0.00193 | L2-Norm=13.907 | L2-Norm(final)=3.061 | acc=0.9844 | 4480.2 samples/s | 70.0 steps/s
[Step=18050 Epoch=35.2] | Loss=0.01341 | Reg=0.00193 | L2-Norm=13.910 | L2-Norm(final)=3.063 | acc=1.0000 | 4484.7 samples/s | 70.1 steps/s
[Step=18100 Epoch=35.3] | Loss=0.01314 | Reg=0.00194 | L2-Norm=13.913 | L2-Norm(final)=3.065 | acc=1.0000 | 5396.7 samples/s | 84.3 steps/s
[Step=18150 Epoch=35.4] | Loss=0.01291 | Reg=0.00194 | L2-Norm=13.916 | L2-Norm(final)=3.068 | acc=1.0000 | 1871.8 samples/s | 29.2 steps/s
[Step=18200 Epoch=35.5] | Loss=0.01261 | Reg=0.00194 | L2-Norm=13.918 | L2-Norm(final)=3.070 | acc=0.9688 | 4490.1 samples/s | 70.2 steps/s
[Step=18250 Epoch=35.6] | Loss=0.01248 | Reg=0.00194 | L2-Norm=13.921 | L2-Norm(final)=3.073 | acc=0.9688 | 4547.4 samples/s | 71.1 steps/s
[Step=18300 Epoch=35.7] | Loss=0.01241 | Reg=0.00194 | L2-Norm=13.923 | L2-Norm(final)=3.075 | acc=0.9531 | 4498.0 samples/s | 70.3 steps/s
[Step=18350 Epoch=35.8] | Loss=0.01218 | Reg=0.00194 | L2-Norm=13.925 | L2-Norm(final)=3.077 | acc=1.0000 | 4501.6 samples/s | 70.3 steps/s
[Step=18400 Epoch=35.9] | Loss=0.01199 | Reg=0.00194 | L2-Norm=13.928 | L2-Norm(final)=3.080 | acc=1.0000 | 4437.3 samples/s | 69.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step18400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=34.4] | Loss=0.19332 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.040 | acc=0.8281 | 4269.9 samples/s | 66.7 steps/s
[Step=17650 Epoch=34.5] | Loss=0.03083 | Reg=0.00192 | L2-Norm=13.872 | L2-Norm(final)=3.030 | acc=1.0000 | 4099.9 samples/s | 64.1 steps/s
[Step=17700 Epoch=34.6] | Loss=0.02094 | Reg=0.00193 | L2-Norm=13.884 | L2-Norm(final)=3.034 | acc=1.0000 | 4588.8 samples/s | 71.7 steps/s
[Step=17750 Epoch=34.7] | Loss=0.01779 | Reg=0.00193 | L2-Norm=13.891 | L2-Norm(final)=3.039 | acc=1.0000 | 4647.1 samples/s | 72.6 steps/s
[Step=17800 Epoch=34.8] | Loss=0.01655 | Reg=0.00193 | L2-Norm=13.895 | L2-Norm(final)=3.043 | acc=0.9844 | 4471.0 samples/s | 69.9 steps/s
[Step=17850 Epoch=34.9] | Loss=0.01587 | Reg=0.00193 | L2-Norm=13.900 | L2-Norm(final)=3.046 | acc=1.0000 | 4536.9 samples/s | 70.9 steps/s
[Step=17900 Epoch=35.0] | Loss=0.01449 | Reg=0.00193 | L2-Norm=13.904 | L2-Norm(final)=3.050 | acc=1.0000 | 4527.8 samples/s | 70.7 steps/s
[Step=17950 Epoch=35.1] | Loss=0.01437 | Reg=0.00193 | L2-Norm=13.907 | L2-Norm(final)=3.053 | acc=0.9844 | 4470.0 samples/s | 69.8 steps/s
[Step=18000 Epoch=35.2] | Loss=0.01376 | Reg=0.00193 | L2-Norm=13.910 | L2-Norm(final)=3.056 | acc=1.0000 | 4527.7 samples/s | 70.7 steps/s
[Step=18050 Epoch=35.3] | Loss=0.01349 | Reg=0.00194 | L2-Norm=13.912 | L2-Norm(final)=3.058 | acc=0.9844 | 4508.9 samples/s | 70.5 steps/s
[Step=18100 Epoch=35.4] | Loss=0.01308 | Reg=0.00194 | L2-Norm=13.915 | L2-Norm(final)=3.061 | acc=0.9844 | 5545.3 samples/s | 86.6 steps/s
[Step=18150 Epoch=35.5] | Loss=0.01276 | Reg=0.00194 | L2-Norm=13.917 | L2-Norm(final)=3.063 | acc=1.0000 | 1868.2 samples/s | 29.2 steps/s
[Step=18200 Epoch=35.6] | Loss=0.01227 | Reg=0.00194 | L2-Norm=13.920 | L2-Norm(final)=3.066 | acc=1.0000 | 4385.2 samples/s | 68.5 steps/s
[Step=18250 Epoch=35.7] | Loss=0.01202 | Reg=0.00194 | L2-Norm=13.923 | L2-Norm(final)=3.069 | acc=1.0000 | 4487.5 samples/s | 70.1 steps/s
[Step=18300 Epoch=35.8] | Loss=0.01187 | Reg=0.00194 | L2-Norm=13.925 | L2-Norm(final)=3.072 | acc=0.9844 | 4484.9 samples/s | 70.1 steps/s
[Step=18350 Epoch=35.9] | Loss=0.01168 | Reg=0.00194 | L2-Norm=13.927 | L2-Norm(final)=3.074 | acc=0.9844 | 4589.4 samples/s | 71.7 steps/s
[Step=18400 Epoch=36.0] | Loss=0.01137 | Reg=0.00194 | L2-Norm=13.929 | L2-Norm(final)=3.076 | acc=1.0000 | 4363.8 samples/s | 68.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step18400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=67.4] | Loss=0.03999 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.040 | acc=0.9688 | 4072.8 samples/s | 63.6 steps/s
[Step=17650 Epoch=67.6] | Loss=0.00239 | Reg=0.00193 | L2-Norm=13.883 | L2-Norm(final)=3.044 | acc=1.0000 | 3851.1 samples/s | 60.2 steps/s
[Step=17700 Epoch=67.8] | Loss=0.00123 | Reg=0.00193 | L2-Norm=13.890 | L2-Norm(final)=3.046 | acc=1.0000 | 4281.7 samples/s | 66.9 steps/s
[Step=17750 Epoch=68.0] | Loss=0.00083 | Reg=0.00193 | L2-Norm=13.889 | L2-Norm(final)=3.048 | acc=1.0000 | 4418.1 samples/s | 69.0 steps/s
[Step=17800 Epoch=68.2] | Loss=0.00064 | Reg=0.00193 | L2-Norm=13.886 | L2-Norm(final)=3.050 | acc=1.0000 | 4270.7 samples/s | 66.7 steps/s
[Step=17850 Epoch=68.4] | Loss=0.00053 | Reg=0.00193 | L2-Norm=13.882 | L2-Norm(final)=3.052 | acc=1.0000 | 5279.9 samples/s | 82.5 steps/s
[Step=17900 Epoch=68.6] | Loss=0.00045 | Reg=0.00193 | L2-Norm=13.878 | L2-Norm(final)=3.054 | acc=1.0000 | 1809.3 samples/s | 28.3 steps/s
[Step=17950 Epoch=68.8] | Loss=0.00039 | Reg=0.00192 | L2-Norm=13.874 | L2-Norm(final)=3.055 | acc=1.0000 | 4247.8 samples/s | 66.4 steps/s
[Step=18000 Epoch=69.0] | Loss=0.00034 | Reg=0.00192 | L2-Norm=13.869 | L2-Norm(final)=3.057 | acc=1.0000 | 4308.8 samples/s | 67.3 steps/s
[Step=18050 Epoch=69.2] | Loss=0.00031 | Reg=0.00192 | L2-Norm=13.863 | L2-Norm(final)=3.058 | acc=1.0000 | 4353.9 samples/s | 68.0 steps/s
[Step=18100 Epoch=69.4] | Loss=0.00028 | Reg=0.00192 | L2-Norm=13.858 | L2-Norm(final)=3.059 | acc=1.0000 | 4604.3 samples/s | 71.9 steps/s
[Step=18150 Epoch=69.5] | Loss=0.00025 | Reg=0.00192 | L2-Norm=13.852 | L2-Norm(final)=3.060 | acc=1.0000 | 1997.3 samples/s | 31.2 steps/s
[Step=18200 Epoch=69.7] | Loss=0.00023 | Reg=0.00192 | L2-Norm=13.846 | L2-Norm(final)=3.061 | acc=1.0000 | 4443.2 samples/s | 69.4 steps/s
[Step=18250 Epoch=69.9] | Loss=0.00021 | Reg=0.00192 | L2-Norm=13.840 | L2-Norm(final)=3.062 | acc=1.0000 | 4494.6 samples/s | 70.2 steps/s
[Step=18300 Epoch=70.1] | Loss=0.00020 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.063 | acc=1.0000 | 4479.7 samples/s | 70.0 steps/s
[Step=18350 Epoch=70.3] | Loss=0.00019 | Reg=0.00191 | L2-Norm=13.827 | L2-Norm(final)=3.063 | acc=1.0000 | 4429.5 samples/s | 69.2 steps/s
[Step=18400 Epoch=70.5] | Loss=0.00017 | Reg=0.00191 | L2-Norm=13.821 | L2-Norm(final)=3.064 | acc=1.0000 | 2039.8 samples/s | 31.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step18400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=67.8] | Loss=0.00720 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=3.041 | acc=1.0000 | 3854.5 samples/s | 60.2 steps/s
[Step=17650 Epoch=67.9] | Loss=0.00255 | Reg=0.00193 | L2-Norm=13.878 | L2-Norm(final)=3.054 | acc=1.0000 | 4325.8 samples/s | 67.6 steps/s
[Step=17700 Epoch=68.1] | Loss=0.00145 | Reg=0.00193 | L2-Norm=13.892 | L2-Norm(final)=3.056 | acc=1.0000 | 4480.5 samples/s | 70.0 steps/s
[Step=17750 Epoch=68.3] | Loss=0.00098 | Reg=0.00193 | L2-Norm=13.895 | L2-Norm(final)=3.058 | acc=1.0000 | 4586.8 samples/s | 71.7 steps/s
[Step=17800 Epoch=68.5] | Loss=0.00074 | Reg=0.00193 | L2-Norm=13.895 | L2-Norm(final)=3.060 | acc=1.0000 | 4341.8 samples/s | 67.8 steps/s
[Step=17850 Epoch=68.7] | Loss=0.00066 | Reg=0.00193 | L2-Norm=13.892 | L2-Norm(final)=3.061 | acc=1.0000 | 5659.4 samples/s | 88.4 steps/s
[Step=17900 Epoch=68.9] | Loss=0.00057 | Reg=0.00193 | L2-Norm=13.889 | L2-Norm(final)=3.061 | acc=1.0000 | 1892.2 samples/s | 29.6 steps/s
[Step=17950 Epoch=69.1] | Loss=0.00049 | Reg=0.00193 | L2-Norm=13.885 | L2-Norm(final)=3.062 | acc=1.0000 | 4427.8 samples/s | 69.2 steps/s
[Step=18000 Epoch=69.3] | Loss=0.00044 | Reg=0.00193 | L2-Norm=13.881 | L2-Norm(final)=3.062 | acc=1.0000 | 4461.8 samples/s | 69.7 steps/s
[Step=18050 Epoch=69.5] | Loss=0.00039 | Reg=0.00193 | L2-Norm=13.876 | L2-Norm(final)=3.063 | acc=1.0000 | 4457.3 samples/s | 69.6 steps/s
[Step=18100 Epoch=69.7] | Loss=0.00035 | Reg=0.00192 | L2-Norm=13.871 | L2-Norm(final)=3.063 | acc=1.0000 | 5035.1 samples/s | 78.7 steps/s
[Step=18150 Epoch=69.9] | Loss=0.00032 | Reg=0.00192 | L2-Norm=13.866 | L2-Norm(final)=3.063 | acc=1.0000 | 1984.1 samples/s | 31.0 steps/s
[Step=18200 Epoch=70.1] | Loss=0.00029 | Reg=0.00192 | L2-Norm=13.861 | L2-Norm(final)=3.064 | acc=1.0000 | 4496.1 samples/s | 70.3 steps/s
[Step=18250 Epoch=70.3] | Loss=0.00027 | Reg=0.00192 | L2-Norm=13.855 | L2-Norm(final)=3.064 | acc=1.0000 | 4482.8 samples/s | 70.0 steps/s
[Step=18300 Epoch=70.4] | Loss=0.00025 | Reg=0.00192 | L2-Norm=13.850 | L2-Norm(final)=3.065 | acc=1.0000 | 4474.6 samples/s | 69.9 steps/s
[Step=18350 Epoch=70.6] | Loss=0.00024 | Reg=0.00192 | L2-Norm=13.844 | L2-Norm(final)=3.065 | acc=1.0000 | 4593.4 samples/s | 71.8 steps/s
[Step=18400 Epoch=70.8] | Loss=0.00022 | Reg=0.00192 | L2-Norm=13.838 | L2-Norm(final)=3.065 | acc=1.0000 | 2056.7 samples/s | 32.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24865 | acc=0.8667 | tpr=0.8109 | fpr=0.0121 | 4339.6 samples/s | 17.0 steps/s
Avg test loss: 0.25330, Avg test acc: 0.86702, Avg tpr: 0.81220, Avg fpr: 0.01243, total FA: 97

Testing server on iccad2012
[Step=  50] | Loss=0.40388 | acc=0.8807 | tpr=0.9602 | fpr=0.1207 | 4320.6 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.40407 | acc=0.8832 | tpr=0.9744 | fpr=0.1185 | 8180.0 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.40898 | acc=0.8825 | tpr=0.9798 | fpr=0.1193 | 8216.3 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.40829 | acc=0.8837 | tpr=0.9792 | fpr=0.1180 | 8677.8 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.40683 | acc=0.8841 | tpr=0.9808 | fpr=0.1176 | 7780.5 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.41136 | acc=0.8842 | tpr=0.9804 | fpr=0.1176 | 8210.0 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.41442 | acc=0.8838 | tpr=0.9793 | fpr=0.1180 | 8204.8 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.41700 | acc=0.8836 | tpr=0.9781 | fpr=0.1181 | 8477.2 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.42212 | acc=0.8834 | tpr=0.9771 | fpr=0.1183 | 7909.0 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.42271 | acc=0.8833 | tpr=0.9780 | fpr=0.1184 | 8162.2 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.42193 | acc=0.8835 | tpr=0.9781 | fpr=0.1183 | 15147.6 samples/s | 59.2 steps/s
Avg test loss: 0.42168, Avg test acc: 0.88341, Avg tpr: 0.97821, Avg fpr: 0.11831, total FA: 16427

server round 23/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=35.9] | Loss=0.20175 | Reg=0.00190 | L2-Norm=13.795 | L2-Norm(final)=3.092 | acc=0.8750 | 4019.0 samples/s | 62.8 steps/s
[Step=18450 Epoch=36.0] | Loss=0.02106 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=3.092 | acc=1.0000 | 4386.1 samples/s | 68.5 steps/s
[Step=18500 Epoch=36.1] | Loss=0.01693 | Reg=0.00192 | L2-Norm=13.841 | L2-Norm(final)=3.095 | acc=0.9844 | 4652.8 samples/s | 72.7 steps/s
[Step=18550 Epoch=36.2] | Loss=0.01411 | Reg=0.00192 | L2-Norm=13.847 | L2-Norm(final)=3.098 | acc=0.9844 | 4659.9 samples/s | 72.8 steps/s
[Step=18600 Epoch=36.3] | Loss=0.01416 | Reg=0.00192 | L2-Norm=13.853 | L2-Norm(final)=3.101 | acc=0.9844 | 4660.7 samples/s | 72.8 steps/s
[Step=18650 Epoch=36.4] | Loss=0.01419 | Reg=0.00192 | L2-Norm=13.856 | L2-Norm(final)=3.101 | acc=1.0000 | 4744.1 samples/s | 74.1 steps/s
[Step=18700 Epoch=36.5] | Loss=0.01385 | Reg=0.00192 | L2-Norm=13.860 | L2-Norm(final)=3.102 | acc=0.9531 | 4736.6 samples/s | 74.0 steps/s
[Step=18750 Epoch=36.6] | Loss=0.01326 | Reg=0.00192 | L2-Norm=13.863 | L2-Norm(final)=3.104 | acc=0.9844 | 4747.8 samples/s | 74.2 steps/s
[Step=18800 Epoch=36.7] | Loss=0.01315 | Reg=0.00192 | L2-Norm=13.866 | L2-Norm(final)=3.106 | acc=1.0000 | 4767.5 samples/s | 74.5 steps/s
[Step=18850 Epoch=36.8] | Loss=0.01313 | Reg=0.00192 | L2-Norm=13.869 | L2-Norm(final)=3.107 | acc=0.9688 | 4633.8 samples/s | 72.4 steps/s
[Step=18900 Epoch=36.9] | Loss=0.01275 | Reg=0.00192 | L2-Norm=13.872 | L2-Norm(final)=3.109 | acc=1.0000 | 5664.1 samples/s | 88.5 steps/s
[Step=18950 Epoch=37.0] | Loss=0.01214 | Reg=0.00193 | L2-Norm=13.875 | L2-Norm(final)=3.112 | acc=1.0000 | 1927.8 samples/s | 30.1 steps/s
[Step=19000 Epoch=37.1] | Loss=0.01195 | Reg=0.00193 | L2-Norm=13.878 | L2-Norm(final)=3.115 | acc=0.9844 | 4715.2 samples/s | 73.7 steps/s
[Step=19050 Epoch=37.2] | Loss=0.01171 | Reg=0.00193 | L2-Norm=13.881 | L2-Norm(final)=3.118 | acc=0.9844 | 4709.5 samples/s | 73.6 steps/s
[Step=19100 Epoch=37.3] | Loss=0.01143 | Reg=0.00193 | L2-Norm=13.883 | L2-Norm(final)=3.121 | acc=1.0000 | 4698.8 samples/s | 73.4 steps/s
[Step=19150 Epoch=37.3] | Loss=0.01145 | Reg=0.00193 | L2-Norm=13.886 | L2-Norm(final)=3.124 | acc=0.9844 | 4673.1 samples/s | 73.0 steps/s
[Step=19200 Epoch=37.4] | Loss=0.01131 | Reg=0.00193 | L2-Norm=13.889 | L2-Norm(final)=3.126 | acc=1.0000 | 4679.1 samples/s | 73.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step19200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=36.0] | Loss=0.16939 | Reg=0.00190 | L2-Norm=13.795 | L2-Norm(final)=3.092 | acc=0.9062 | 4197.7 samples/s | 65.6 steps/s
[Step=18450 Epoch=36.1] | Loss=0.02192 | Reg=0.00191 | L2-Norm=13.820 | L2-Norm(final)=3.087 | acc=1.0000 | 4432.3 samples/s | 69.3 steps/s
[Step=18500 Epoch=36.2] | Loss=0.01762 | Reg=0.00191 | L2-Norm=13.830 | L2-Norm(final)=3.092 | acc=0.9844 | 4763.4 samples/s | 74.4 steps/s
[Step=18550 Epoch=36.3] | Loss=0.01514 | Reg=0.00191 | L2-Norm=13.837 | L2-Norm(final)=3.098 | acc=1.0000 | 4637.9 samples/s | 72.5 steps/s
[Step=18600 Epoch=36.4] | Loss=0.01379 | Reg=0.00192 | L2-Norm=13.843 | L2-Norm(final)=3.102 | acc=0.9688 | 4744.3 samples/s | 74.1 steps/s
[Step=18650 Epoch=36.5] | Loss=0.01318 | Reg=0.00192 | L2-Norm=13.847 | L2-Norm(final)=3.106 | acc=1.0000 | 4351.2 samples/s | 68.0 steps/s
[Step=18700 Epoch=36.6] | Loss=0.01332 | Reg=0.00192 | L2-Norm=13.851 | L2-Norm(final)=3.108 | acc=0.9844 | 4656.7 samples/s | 72.8 steps/s
[Step=18750 Epoch=36.7] | Loss=0.01325 | Reg=0.00192 | L2-Norm=13.854 | L2-Norm(final)=3.109 | acc=1.0000 | 4767.7 samples/s | 74.5 steps/s
[Step=18800 Epoch=36.8] | Loss=0.01300 | Reg=0.00192 | L2-Norm=13.857 | L2-Norm(final)=3.110 | acc=1.0000 | 4738.8 samples/s | 74.0 steps/s
[Step=18850 Epoch=36.9] | Loss=0.01297 | Reg=0.00192 | L2-Norm=13.859 | L2-Norm(final)=3.112 | acc=1.0000 | 4724.6 samples/s | 73.8 steps/s
[Step=18900 Epoch=36.9] | Loss=0.01277 | Reg=0.00192 | L2-Norm=13.862 | L2-Norm(final)=3.114 | acc=1.0000 | 5881.4 samples/s | 91.9 steps/s
[Step=18950 Epoch=37.0] | Loss=0.01230 | Reg=0.00192 | L2-Norm=13.865 | L2-Norm(final)=3.116 | acc=0.9844 | 1990.7 samples/s | 31.1 steps/s
[Step=19000 Epoch=37.1] | Loss=0.01180 | Reg=0.00192 | L2-Norm=13.868 | L2-Norm(final)=3.118 | acc=1.0000 | 4727.2 samples/s | 73.9 steps/s
[Step=19050 Epoch=37.2] | Loss=0.01159 | Reg=0.00192 | L2-Norm=13.870 | L2-Norm(final)=3.121 | acc=1.0000 | 4764.2 samples/s | 74.4 steps/s
[Step=19100 Epoch=37.3] | Loss=0.01138 | Reg=0.00192 | L2-Norm=13.872 | L2-Norm(final)=3.123 | acc=1.0000 | 4678.0 samples/s | 73.1 steps/s
[Step=19150 Epoch=37.4] | Loss=0.01122 | Reg=0.00193 | L2-Norm=13.874 | L2-Norm(final)=3.125 | acc=1.0000 | 4790.2 samples/s | 74.8 steps/s
[Step=19200 Epoch=37.5] | Loss=0.01111 | Reg=0.00193 | L2-Norm=13.877 | L2-Norm(final)=3.127 | acc=1.0000 | 4661.0 samples/s | 72.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step19200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=70.5] | Loss=0.04602 | Reg=0.00190 | L2-Norm=13.795 | L2-Norm(final)=3.092 | acc=0.9844 | 4101.8 samples/s | 64.1 steps/s
[Step=18450 Epoch=70.7] | Loss=0.00185 | Reg=0.00191 | L2-Norm=13.827 | L2-Norm(final)=3.090 | acc=1.0000 | 4014.8 samples/s | 62.7 steps/s
[Step=18500 Epoch=70.9] | Loss=0.00094 | Reg=0.00191 | L2-Norm=13.830 | L2-Norm(final)=3.091 | acc=1.0000 | 4494.9 samples/s | 70.2 steps/s
[Step=18550 Epoch=71.1] | Loss=0.00064 | Reg=0.00191 | L2-Norm=13.827 | L2-Norm(final)=3.092 | acc=1.0000 | 4413.0 samples/s | 69.0 steps/s
[Step=18600 Epoch=71.3] | Loss=0.00051 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=3.094 | acc=1.0000 | 4518.4 samples/s | 70.6 steps/s
[Step=18650 Epoch=71.5] | Loss=0.00041 | Reg=0.00191 | L2-Norm=13.818 | L2-Norm(final)=3.095 | acc=1.0000 | 5568.4 samples/s | 87.0 steps/s
[Step=18700 Epoch=71.7] | Loss=0.00035 | Reg=0.00191 | L2-Norm=13.813 | L2-Norm(final)=3.096 | acc=1.0000 | 1939.8 samples/s | 30.3 steps/s
[Step=18750 Epoch=71.8] | Loss=0.00030 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=3.097 | acc=1.0000 | 4394.8 samples/s | 68.7 steps/s
[Step=18800 Epoch=72.0] | Loss=0.00026 | Reg=0.00190 | L2-Norm=13.801 | L2-Norm(final)=3.098 | acc=1.0000 | 4478.1 samples/s | 70.0 steps/s
[Step=18850 Epoch=72.2] | Loss=0.00023 | Reg=0.00190 | L2-Norm=13.794 | L2-Norm(final)=3.099 | acc=1.0000 | 4458.6 samples/s | 69.7 steps/s
[Step=18900 Epoch=72.4] | Loss=0.00021 | Reg=0.00190 | L2-Norm=13.787 | L2-Norm(final)=3.099 | acc=1.0000 | 4963.5 samples/s | 77.6 steps/s
[Step=18950 Epoch=72.6] | Loss=0.00019 | Reg=0.00190 | L2-Norm=13.780 | L2-Norm(final)=3.100 | acc=1.0000 | 1976.6 samples/s | 30.9 steps/s
[Step=19000 Epoch=72.8] | Loss=0.00018 | Reg=0.00190 | L2-Norm=13.773 | L2-Norm(final)=3.100 | acc=1.0000 | 4517.0 samples/s | 70.6 steps/s
[Step=19050 Epoch=73.0] | Loss=0.00016 | Reg=0.00189 | L2-Norm=13.766 | L2-Norm(final)=3.101 | acc=1.0000 | 4547.0 samples/s | 71.0 steps/s
[Step=19100 Epoch=73.2] | Loss=0.00015 | Reg=0.00189 | L2-Norm=13.758 | L2-Norm(final)=3.101 | acc=1.0000 | 4428.9 samples/s | 69.2 steps/s
[Step=19150 Epoch=73.4] | Loss=0.00014 | Reg=0.00189 | L2-Norm=13.751 | L2-Norm(final)=3.102 | acc=1.0000 | 4464.0 samples/s | 69.7 steps/s
[Step=19200 Epoch=73.6] | Loss=0.00013 | Reg=0.00189 | L2-Norm=13.743 | L2-Norm(final)=3.102 | acc=1.0000 | 2069.1 samples/s | 32.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step19200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=70.8] | Loss=0.04682 | Reg=0.00190 | L2-Norm=13.795 | L2-Norm(final)=3.092 | acc=0.9844 | 3856.2 samples/s | 60.3 steps/s
[Step=18450 Epoch=71.0] | Loss=0.00292 | Reg=0.00192 | L2-Norm=13.839 | L2-Norm(final)=3.091 | acc=1.0000 | 4386.9 samples/s | 68.5 steps/s
[Step=18500 Epoch=71.2] | Loss=0.00154 | Reg=0.00192 | L2-Norm=13.851 | L2-Norm(final)=3.094 | acc=1.0000 | 4562.3 samples/s | 71.3 steps/s
[Step=18550 Epoch=71.4] | Loss=0.00106 | Reg=0.00192 | L2-Norm=13.853 | L2-Norm(final)=3.097 | acc=1.0000 | 4343.5 samples/s | 67.9 steps/s
[Step=18600 Epoch=71.6] | Loss=0.00081 | Reg=0.00192 | L2-Norm=13.852 | L2-Norm(final)=3.100 | acc=1.0000 | 4488.4 samples/s | 70.1 steps/s
[Step=18650 Epoch=71.8] | Loss=0.00072 | Reg=0.00192 | L2-Norm=13.850 | L2-Norm(final)=3.102 | acc=1.0000 | 5653.0 samples/s | 88.3 steps/s
[Step=18700 Epoch=72.0] | Loss=0.00060 | Reg=0.00192 | L2-Norm=13.847 | L2-Norm(final)=3.103 | acc=1.0000 | 1906.1 samples/s | 29.8 steps/s
[Step=18750 Epoch=72.2] | Loss=0.00052 | Reg=0.00192 | L2-Norm=13.844 | L2-Norm(final)=3.104 | acc=1.0000 | 4423.7 samples/s | 69.1 steps/s
[Step=18800 Epoch=72.4] | Loss=0.00046 | Reg=0.00192 | L2-Norm=13.839 | L2-Norm(final)=3.105 | acc=1.0000 | 4457.3 samples/s | 69.6 steps/s
[Step=18850 Epoch=72.6] | Loss=0.00041 | Reg=0.00191 | L2-Norm=13.835 | L2-Norm(final)=3.106 | acc=1.0000 | 4389.7 samples/s | 68.6 steps/s
[Step=18900 Epoch=72.8] | Loss=0.00037 | Reg=0.00191 | L2-Norm=13.830 | L2-Norm(final)=3.106 | acc=1.0000 | 4965.7 samples/s | 77.6 steps/s
[Step=18950 Epoch=72.9] | Loss=0.00033 | Reg=0.00191 | L2-Norm=13.825 | L2-Norm(final)=3.107 | acc=1.0000 | 1978.3 samples/s | 30.9 steps/s
[Step=19000 Epoch=73.1] | Loss=0.00031 | Reg=0.00191 | L2-Norm=13.820 | L2-Norm(final)=3.108 | acc=1.0000 | 4458.8 samples/s | 69.7 steps/s
[Step=19050 Epoch=73.3] | Loss=0.00028 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=3.108 | acc=1.0000 | 4542.5 samples/s | 71.0 steps/s
[Step=19100 Epoch=73.5] | Loss=0.00026 | Reg=0.00191 | L2-Norm=13.809 | L2-Norm(final)=3.109 | acc=1.0000 | 4400.6 samples/s | 68.8 steps/s
[Step=19150 Epoch=73.7] | Loss=0.00025 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=3.109 | acc=1.0000 | 4556.2 samples/s | 71.2 steps/s
[Step=19200 Epoch=73.9] | Loss=0.00023 | Reg=0.00190 | L2-Norm=13.797 | L2-Norm(final)=3.110 | acc=1.0000 | 2076.7 samples/s | 32.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25792 | acc=0.8619 | tpr=0.8039 | fpr=0.0121 | 4287.7 samples/s | 16.7 steps/s
Avg test loss: 0.26393, Avg test acc: 0.86261, Avg tpr: 0.80585, Avg fpr: 0.01256, total FA: 98

Testing server on iccad2012
[Step=  50] | Loss=0.39164 | acc=0.8871 | tpr=0.9690 | fpr=0.1144 | 4231.0 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.39363 | acc=0.8886 | tpr=0.9765 | fpr=0.1130 | 8247.9 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.39834 | acc=0.8887 | tpr=0.9827 | fpr=0.1130 | 8234.5 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.39799 | acc=0.8896 | tpr=0.9814 | fpr=0.1120 | 8140.6 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.39674 | acc=0.8896 | tpr=0.9817 | fpr=0.1120 | 8353.8 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.40136 | acc=0.8894 | tpr=0.9804 | fpr=0.1122 | 8084.0 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.40443 | acc=0.8890 | tpr=0.9793 | fpr=0.1127 | 8238.2 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.40693 | acc=0.8888 | tpr=0.9776 | fpr=0.1128 | 8416.8 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.41221 | acc=0.8886 | tpr=0.9766 | fpr=0.1130 | 8163.8 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.41266 | acc=0.8884 | tpr=0.9771 | fpr=0.1133 | 8271.9 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.41170 | acc=0.8885 | tpr=0.9773 | fpr=0.1131 | 15055.1 samples/s | 58.8 steps/s
Avg test loss: 0.41150, Avg test acc: 0.88844, Avg tpr: 0.97702, Avg fpr: 0.11317, total FA: 15714

server round 24/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=37.4] | Loss=0.11206 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.135 | acc=0.9375 | 3930.8 samples/s | 61.4 steps/s
[Step=19250 Epoch=37.5] | Loss=0.02245 | Reg=0.00190 | L2-Norm=13.780 | L2-Norm(final)=3.132 | acc=0.9844 | 4559.0 samples/s | 71.2 steps/s
[Step=19300 Epoch=37.6] | Loss=0.01810 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=3.133 | acc=1.0000 | 4709.3 samples/s | 73.6 steps/s
[Step=19350 Epoch=37.7] | Loss=0.01558 | Reg=0.00190 | L2-Norm=13.797 | L2-Norm(final)=3.136 | acc=0.9844 | 4698.0 samples/s | 73.4 steps/s
[Step=19400 Epoch=37.8] | Loss=0.01387 | Reg=0.00190 | L2-Norm=13.801 | L2-Norm(final)=3.139 | acc=1.0000 | 4721.2 samples/s | 73.8 steps/s
[Step=19450 Epoch=37.9] | Loss=0.01317 | Reg=0.00191 | L2-Norm=13.805 | L2-Norm(final)=3.143 | acc=1.0000 | 4649.4 samples/s | 72.6 steps/s
[Step=19500 Epoch=38.0] | Loss=0.01293 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=3.146 | acc=0.9844 | 4813.1 samples/s | 75.2 steps/s
[Step=19550 Epoch=38.1] | Loss=0.01263 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=3.149 | acc=1.0000 | 4661.5 samples/s | 72.8 steps/s
[Step=19600 Epoch=38.2] | Loss=0.01237 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=3.152 | acc=1.0000 | 4631.7 samples/s | 72.4 steps/s
[Step=19650 Epoch=38.3] | Loss=0.01225 | Reg=0.00191 | L2-Norm=13.818 | L2-Norm(final)=3.155 | acc=1.0000 | 4799.9 samples/s | 75.0 steps/s
[Step=19700 Epoch=38.4] | Loss=0.01224 | Reg=0.00191 | L2-Norm=13.821 | L2-Norm(final)=3.158 | acc=0.9844 | 5711.3 samples/s | 89.2 steps/s
[Step=19750 Epoch=38.5] | Loss=0.01160 | Reg=0.00191 | L2-Norm=13.824 | L2-Norm(final)=3.160 | acc=1.0000 | 1933.3 samples/s | 30.2 steps/s
[Step=19800 Epoch=38.6] | Loss=0.01126 | Reg=0.00191 | L2-Norm=13.827 | L2-Norm(final)=3.163 | acc=0.9844 | 4551.5 samples/s | 71.1 steps/s
[Step=19850 Epoch=38.7] | Loss=0.01111 | Reg=0.00191 | L2-Norm=13.830 | L2-Norm(final)=3.166 | acc=1.0000 | 4579.0 samples/s | 71.5 steps/s
[Step=19900 Epoch=38.8] | Loss=0.01093 | Reg=0.00191 | L2-Norm=13.832 | L2-Norm(final)=3.169 | acc=0.9844 | 4698.6 samples/s | 73.4 steps/s
[Step=19950 Epoch=38.9] | Loss=0.01082 | Reg=0.00191 | L2-Norm=13.835 | L2-Norm(final)=3.171 | acc=0.9844 | 4678.3 samples/s | 73.1 steps/s
[Step=20000 Epoch=39.0] | Loss=0.01075 | Reg=0.00191 | L2-Norm=13.837 | L2-Norm(final)=3.174 | acc=1.0000 | 4743.5 samples/s | 74.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=37.5] | Loss=0.12731 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.135 | acc=0.9375 | 4354.7 samples/s | 68.0 steps/s
[Step=19250 Epoch=37.6] | Loss=0.02412 | Reg=0.00190 | L2-Norm=13.779 | L2-Norm(final)=3.123 | acc=1.0000 | 4307.5 samples/s | 67.3 steps/s
[Step=19300 Epoch=37.7] | Loss=0.01831 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=3.128 | acc=1.0000 | 4714.1 samples/s | 73.7 steps/s
[Step=19350 Epoch=37.8] | Loss=0.01470 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=3.132 | acc=1.0000 | 4736.6 samples/s | 74.0 steps/s
[Step=19400 Epoch=37.9] | Loss=0.01402 | Reg=0.00191 | L2-Norm=13.804 | L2-Norm(final)=3.136 | acc=0.9844 | 4689.7 samples/s | 73.3 steps/s
[Step=19450 Epoch=38.0] | Loss=0.01348 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=3.140 | acc=1.0000 | 4720.9 samples/s | 73.8 steps/s
[Step=19500 Epoch=38.1] | Loss=0.01341 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=3.142 | acc=1.0000 | 4733.7 samples/s | 74.0 steps/s
[Step=19550 Epoch=38.2] | Loss=0.01312 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=3.144 | acc=0.9844 | 4687.6 samples/s | 73.2 steps/s
[Step=19600 Epoch=38.3] | Loss=0.01263 | Reg=0.00191 | L2-Norm=13.816 | L2-Norm(final)=3.147 | acc=0.9844 | 4619.5 samples/s | 72.2 steps/s
[Step=19650 Epoch=38.4] | Loss=0.01267 | Reg=0.00191 | L2-Norm=13.818 | L2-Norm(final)=3.149 | acc=1.0000 | 4767.8 samples/s | 74.5 steps/s
[Step=19700 Epoch=38.5] | Loss=0.01222 | Reg=0.00191 | L2-Norm=13.821 | L2-Norm(final)=3.151 | acc=0.9688 | 5778.1 samples/s | 90.3 steps/s
[Step=19750 Epoch=38.6] | Loss=0.01184 | Reg=0.00191 | L2-Norm=13.823 | L2-Norm(final)=3.153 | acc=1.0000 | 1982.2 samples/s | 31.0 steps/s
[Step=19800 Epoch=38.7] | Loss=0.01141 | Reg=0.00191 | L2-Norm=13.825 | L2-Norm(final)=3.156 | acc=1.0000 | 4743.6 samples/s | 74.1 steps/s
[Step=19850 Epoch=38.8] | Loss=0.01105 | Reg=0.00191 | L2-Norm=13.827 | L2-Norm(final)=3.158 | acc=1.0000 | 4565.3 samples/s | 71.3 steps/s
[Step=19900 Epoch=38.9] | Loss=0.01079 | Reg=0.00191 | L2-Norm=13.829 | L2-Norm(final)=3.161 | acc=0.9844 | 4638.8 samples/s | 72.5 steps/s
[Step=19950 Epoch=39.0] | Loss=0.01076 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=3.163 | acc=0.9844 | 4774.1 samples/s | 74.6 steps/s
[Step=20000 Epoch=39.1] | Loss=0.01061 | Reg=0.00191 | L2-Norm=13.833 | L2-Norm(final)=3.165 | acc=0.9844 | 4729.2 samples/s | 73.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step20000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=73.6] | Loss=0.05549 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.136 | acc=0.9688 | 4040.6 samples/s | 63.1 steps/s
[Step=19250 Epoch=73.8] | Loss=0.00318 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=3.139 | acc=1.0000 | 4209.3 samples/s | 65.8 steps/s
[Step=19300 Epoch=74.0] | Loss=0.00177 | Reg=0.00191 | L2-Norm=13.821 | L2-Norm(final)=3.137 | acc=1.0000 | 4359.3 samples/s | 68.1 steps/s
[Step=19350 Epoch=74.1] | Loss=0.00124 | Reg=0.00191 | L2-Norm=13.824 | L2-Norm(final)=3.137 | acc=1.0000 | 4429.5 samples/s | 69.2 steps/s
[Step=19400 Epoch=74.3] | Loss=0.00095 | Reg=0.00191 | L2-Norm=13.823 | L2-Norm(final)=3.138 | acc=1.0000 | 4514.8 samples/s | 70.5 steps/s
[Step=19450 Epoch=74.5] | Loss=0.00076 | Reg=0.00191 | L2-Norm=13.821 | L2-Norm(final)=3.140 | acc=1.0000 | 5572.9 samples/s | 87.1 steps/s
[Step=19500 Epoch=74.7] | Loss=0.00064 | Reg=0.00191 | L2-Norm=13.817 | L2-Norm(final)=3.140 | acc=1.0000 | 1918.9 samples/s | 30.0 steps/s
[Step=19550 Epoch=74.9] | Loss=0.00055 | Reg=0.00191 | L2-Norm=13.812 | L2-Norm(final)=3.141 | acc=1.0000 | 4423.8 samples/s | 69.1 steps/s
[Step=19600 Epoch=75.1] | Loss=0.00048 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=3.142 | acc=1.0000 | 4399.6 samples/s | 68.7 steps/s
[Step=19650 Epoch=75.3] | Loss=0.00043 | Reg=0.00190 | L2-Norm=13.801 | L2-Norm(final)=3.142 | acc=1.0000 | 4339.5 samples/s | 67.8 steps/s
[Step=19700 Epoch=75.5] | Loss=0.00038 | Reg=0.00190 | L2-Norm=13.796 | L2-Norm(final)=3.143 | acc=1.0000 | 4751.0 samples/s | 74.2 steps/s
[Step=19750 Epoch=75.7] | Loss=0.00035 | Reg=0.00190 | L2-Norm=13.790 | L2-Norm(final)=3.143 | acc=1.0000 | 1980.0 samples/s | 30.9 steps/s
[Step=19800 Epoch=75.9] | Loss=0.00032 | Reg=0.00190 | L2-Norm=13.784 | L2-Norm(final)=3.144 | acc=1.0000 | 4496.1 samples/s | 70.3 steps/s
[Step=19850 Epoch=76.1] | Loss=0.00030 | Reg=0.00190 | L2-Norm=13.777 | L2-Norm(final)=3.144 | acc=1.0000 | 4433.4 samples/s | 69.3 steps/s
[Step=19900 Epoch=76.2] | Loss=0.00028 | Reg=0.00190 | L2-Norm=13.771 | L2-Norm(final)=3.144 | acc=1.0000 | 4396.7 samples/s | 68.7 steps/s
[Step=19950 Epoch=76.4] | Loss=0.00026 | Reg=0.00189 | L2-Norm=13.765 | L2-Norm(final)=3.145 | acc=1.0000 | 4472.4 samples/s | 69.9 steps/s
[Step=20000 Epoch=76.6] | Loss=0.00024 | Reg=0.00189 | L2-Norm=13.758 | L2-Norm(final)=3.145 | acc=1.0000 | 2059.5 samples/s | 32.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=73.9] | Loss=0.01642 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.136 | acc=0.9844 | 4051.7 samples/s | 63.3 steps/s
[Step=19250 Epoch=74.1] | Loss=0.00435 | Reg=0.00190 | L2-Norm=13.797 | L2-Norm(final)=3.132 | acc=1.0000 | 4018.8 samples/s | 62.8 steps/s
[Step=19300 Epoch=74.3] | Loss=0.00222 | Reg=0.00191 | L2-Norm=13.818 | L2-Norm(final)=3.133 | acc=1.0000 | 4473.2 samples/s | 69.9 steps/s
[Step=19350 Epoch=74.5] | Loss=0.00150 | Reg=0.00191 | L2-Norm=13.824 | L2-Norm(final)=3.135 | acc=1.0000 | 4490.4 samples/s | 70.2 steps/s
[Step=19400 Epoch=74.7] | Loss=0.00113 | Reg=0.00191 | L2-Norm=13.824 | L2-Norm(final)=3.136 | acc=1.0000 | 4469.9 samples/s | 69.8 steps/s
[Step=19450 Epoch=74.9] | Loss=0.00091 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=3.137 | acc=1.0000 | 5803.7 samples/s | 90.7 steps/s
[Step=19500 Epoch=75.1] | Loss=0.00076 | Reg=0.00191 | L2-Norm=13.818 | L2-Norm(final)=3.137 | acc=1.0000 | 1908.8 samples/s | 29.8 steps/s
[Step=19550 Epoch=75.3] | Loss=0.00065 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=3.138 | acc=1.0000 | 4466.6 samples/s | 69.8 steps/s
[Step=19600 Epoch=75.4] | Loss=0.00057 | Reg=0.00191 | L2-Norm=13.810 | L2-Norm(final)=3.138 | acc=1.0000 | 4448.6 samples/s | 69.5 steps/s
[Step=19650 Epoch=75.6] | Loss=0.00051 | Reg=0.00191 | L2-Norm=13.805 | L2-Norm(final)=3.139 | acc=1.0000 | 4467.3 samples/s | 69.8 steps/s
[Step=19700 Epoch=75.8] | Loss=0.00046 | Reg=0.00190 | L2-Norm=13.801 | L2-Norm(final)=3.139 | acc=1.0000 | 5059.0 samples/s | 79.0 steps/s
[Step=19750 Epoch=76.0] | Loss=0.00041 | Reg=0.00190 | L2-Norm=13.796 | L2-Norm(final)=3.140 | acc=1.0000 | 1893.0 samples/s | 29.6 steps/s
[Step=19800 Epoch=76.2] | Loss=0.00038 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=3.140 | acc=1.0000 | 4545.2 samples/s | 71.0 steps/s
[Step=19850 Epoch=76.4] | Loss=0.00035 | Reg=0.00190 | L2-Norm=13.785 | L2-Norm(final)=3.141 | acc=1.0000 | 4442.8 samples/s | 69.4 steps/s
[Step=19900 Epoch=76.6] | Loss=0.00033 | Reg=0.00190 | L2-Norm=13.780 | L2-Norm(final)=3.141 | acc=1.0000 | 4548.1 samples/s | 71.1 steps/s
[Step=19950 Epoch=76.8] | Loss=0.00030 | Reg=0.00190 | L2-Norm=13.775 | L2-Norm(final)=3.141 | acc=1.0000 | 4515.8 samples/s | 70.6 steps/s
[Step=20000 Epoch=77.0] | Loss=0.00029 | Reg=0.00190 | L2-Norm=13.769 | L2-Norm(final)=3.142 | acc=1.0000 | 2065.6 samples/s | 32.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27826 | acc=0.8528 | tpr=0.7901 | fpr=0.0109 | 4316.7 samples/s | 16.9 steps/s
Avg test loss: 0.28420, Avg test acc: 0.85211, Avg tpr: 0.79023, Avg fpr: 0.01179, total FA: 92

Testing server on iccad2012
[Step=  50] | Loss=0.34876 | acc=0.9046 | tpr=0.9646 | fpr=0.0965 | 4211.8 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.35178 | acc=0.9049 | tpr=0.9744 | fpr=0.0964 | 8171.7 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.35657 | acc=0.9045 | tpr=0.9813 | fpr=0.0970 | 8362.0 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.35674 | acc=0.9052 | tpr=0.9803 | fpr=0.0962 | 8125.5 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.35558 | acc=0.9048 | tpr=0.9808 | fpr=0.0966 | 8364.8 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.36038 | acc=0.9045 | tpr=0.9796 | fpr=0.0969 | 8101.5 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.36343 | acc=0.9041 | tpr=0.9787 | fpr=0.0973 | 8154.7 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.36573 | acc=0.9039 | tpr=0.9770 | fpr=0.0974 | 8227.1 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.37081 | acc=0.9037 | tpr=0.9761 | fpr=0.0977 | 8343.6 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.37138 | acc=0.9032 | tpr=0.9762 | fpr=0.0981 | 8105.3 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.37048 | acc=0.9034 | tpr=0.9761 | fpr=0.0979 | 14772.5 samples/s | 57.7 steps/s
Avg test loss: 0.37023, Avg test acc: 0.90333, Avg tpr: 0.97583, Avg fpr: 0.09798, total FA: 13605

server round 25/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=39.0] | Loss=0.07630 | Reg=0.00188 | L2-Norm=13.708 | L2-Norm(final)=3.176 | acc=0.9219 | 4198.5 samples/s | 65.6 steps/s
[Step=20050 Epoch=39.1] | Loss=0.02384 | Reg=0.00189 | L2-Norm=13.742 | L2-Norm(final)=3.170 | acc=0.9844 | 4261.4 samples/s | 66.6 steps/s
[Step=20100 Epoch=39.2] | Loss=0.01866 | Reg=0.00189 | L2-Norm=13.754 | L2-Norm(final)=3.172 | acc=0.9688 | 4707.5 samples/s | 73.6 steps/s
[Step=20150 Epoch=39.3] | Loss=0.01589 | Reg=0.00189 | L2-Norm=13.760 | L2-Norm(final)=3.176 | acc=0.9844 | 4635.0 samples/s | 72.4 steps/s
[Step=20200 Epoch=39.4] | Loss=0.01457 | Reg=0.00189 | L2-Norm=13.765 | L2-Norm(final)=3.178 | acc=1.0000 | 4742.6 samples/s | 74.1 steps/s
[Step=20250 Epoch=39.5] | Loss=0.01416 | Reg=0.00190 | L2-Norm=13.768 | L2-Norm(final)=3.181 | acc=0.9844 | 4665.5 samples/s | 72.9 steps/s
[Step=20300 Epoch=39.6] | Loss=0.01370 | Reg=0.00190 | L2-Norm=13.772 | L2-Norm(final)=3.185 | acc=0.9844 | 4715.7 samples/s | 73.7 steps/s
[Step=20350 Epoch=39.7] | Loss=0.01338 | Reg=0.00190 | L2-Norm=13.776 | L2-Norm(final)=3.188 | acc=1.0000 | 4708.3 samples/s | 73.6 steps/s
[Step=20400 Epoch=39.8] | Loss=0.01316 | Reg=0.00190 | L2-Norm=13.779 | L2-Norm(final)=3.192 | acc=0.9844 | 4787.1 samples/s | 74.8 steps/s
[Step=20450 Epoch=39.9] | Loss=0.01297 | Reg=0.00190 | L2-Norm=13.783 | L2-Norm(final)=3.195 | acc=0.9688 | 4718.5 samples/s | 73.7 steps/s
[Step=20500 Epoch=40.0] | Loss=0.01271 | Reg=0.00190 | L2-Norm=13.786 | L2-Norm(final)=3.198 | acc=0.9844 | 5663.3 samples/s | 88.5 steps/s
[Step=20550 Epoch=40.1] | Loss=0.01249 | Reg=0.00190 | L2-Norm=13.789 | L2-Norm(final)=3.200 | acc=0.9844 | 1943.5 samples/s | 30.4 steps/s
[Step=20600 Epoch=40.2] | Loss=0.01205 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=3.203 | acc=0.9844 | 4742.5 samples/s | 74.1 steps/s
[Step=20650 Epoch=40.3] | Loss=0.01177 | Reg=0.00190 | L2-Norm=13.794 | L2-Norm(final)=3.205 | acc=0.9844 | 4670.6 samples/s | 73.0 steps/s
[Step=20700 Epoch=40.4] | Loss=0.01154 | Reg=0.00190 | L2-Norm=13.796 | L2-Norm(final)=3.208 | acc=1.0000 | 4742.4 samples/s | 74.1 steps/s
[Step=20750 Epoch=40.5] | Loss=0.01130 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=3.210 | acc=0.9844 | 4748.9 samples/s | 74.2 steps/s
[Step=20800 Epoch=40.6] | Loss=0.01125 | Reg=0.00190 | L2-Norm=13.801 | L2-Norm(final)=3.212 | acc=1.0000 | 4636.1 samples/s | 72.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=39.1] | Loss=0.18499 | Reg=0.00188 | L2-Norm=13.708 | L2-Norm(final)=3.176 | acc=0.8750 | 3793.0 samples/s | 59.3 steps/s
[Step=20050 Epoch=39.2] | Loss=0.02107 | Reg=0.00189 | L2-Norm=13.736 | L2-Norm(final)=3.169 | acc=1.0000 | 4801.2 samples/s | 75.0 steps/s
[Step=20100 Epoch=39.3] | Loss=0.01563 | Reg=0.00189 | L2-Norm=13.746 | L2-Norm(final)=3.175 | acc=0.9844 | 4791.0 samples/s | 74.9 steps/s
[Step=20150 Epoch=39.4] | Loss=0.01510 | Reg=0.00189 | L2-Norm=13.753 | L2-Norm(final)=3.178 | acc=0.9688 | 4721.7 samples/s | 73.8 steps/s
[Step=20200 Epoch=39.5] | Loss=0.01480 | Reg=0.00189 | L2-Norm=13.757 | L2-Norm(final)=3.179 | acc=1.0000 | 4764.8 samples/s | 74.5 steps/s
[Step=20250 Epoch=39.6] | Loss=0.01369 | Reg=0.00189 | L2-Norm=13.761 | L2-Norm(final)=3.181 | acc=1.0000 | 4694.5 samples/s | 73.4 steps/s
[Step=20300 Epoch=39.7] | Loss=0.01287 | Reg=0.00189 | L2-Norm=13.765 | L2-Norm(final)=3.185 | acc=1.0000 | 4750.8 samples/s | 74.2 steps/s
[Step=20350 Epoch=39.8] | Loss=0.01235 | Reg=0.00190 | L2-Norm=13.768 | L2-Norm(final)=3.188 | acc=1.0000 | 4736.3 samples/s | 74.0 steps/s
[Step=20400 Epoch=39.9] | Loss=0.01193 | Reg=0.00190 | L2-Norm=13.772 | L2-Norm(final)=3.191 | acc=0.9844 | 4729.9 samples/s | 73.9 steps/s
[Step=20450 Epoch=40.0] | Loss=0.01161 | Reg=0.00190 | L2-Norm=13.775 | L2-Norm(final)=3.195 | acc=1.0000 | 4780.9 samples/s | 74.7 steps/s
[Step=20500 Epoch=40.1] | Loss=0.01150 | Reg=0.00190 | L2-Norm=13.777 | L2-Norm(final)=3.198 | acc=0.9688 | 5828.3 samples/s | 91.1 steps/s
[Step=20550 Epoch=40.2] | Loss=0.01110 | Reg=0.00190 | L2-Norm=13.780 | L2-Norm(final)=3.201 | acc=1.0000 | 1988.6 samples/s | 31.1 steps/s
[Step=20600 Epoch=40.3] | Loss=0.01080 | Reg=0.00190 | L2-Norm=13.783 | L2-Norm(final)=3.204 | acc=0.9844 | 4691.0 samples/s | 73.3 steps/s
[Step=20650 Epoch=40.4] | Loss=0.01070 | Reg=0.00190 | L2-Norm=13.785 | L2-Norm(final)=3.207 | acc=0.9844 | 4711.2 samples/s | 73.6 steps/s
[Step=20700 Epoch=40.5] | Loss=0.01057 | Reg=0.00190 | L2-Norm=13.787 | L2-Norm(final)=3.209 | acc=1.0000 | 4725.4 samples/s | 73.8 steps/s
[Step=20750 Epoch=40.6] | Loss=0.01039 | Reg=0.00190 | L2-Norm=13.789 | L2-Norm(final)=3.212 | acc=0.9531 | 4702.9 samples/s | 73.5 steps/s
[Step=20800 Epoch=40.7] | Loss=0.01015 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=3.215 | acc=1.0000 | 4769.9 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step20800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=76.6] | Loss=0.04332 | Reg=0.00188 | L2-Norm=13.708 | L2-Norm(final)=3.176 | acc=0.9844 | 4022.6 samples/s | 62.9 steps/s
[Step=20050 Epoch=76.8] | Loss=0.00231 | Reg=0.00189 | L2-Norm=13.754 | L2-Norm(final)=3.175 | acc=1.0000 | 4362.2 samples/s | 68.2 steps/s
[Step=20100 Epoch=77.0] | Loss=0.00117 | Reg=0.00189 | L2-Norm=13.759 | L2-Norm(final)=3.176 | acc=1.0000 | 4430.0 samples/s | 69.2 steps/s
[Step=20150 Epoch=77.2] | Loss=0.00078 | Reg=0.00189 | L2-Norm=13.756 | L2-Norm(final)=3.176 | acc=1.0000 | 4494.3 samples/s | 70.2 steps/s
[Step=20200 Epoch=77.4] | Loss=0.00061 | Reg=0.00189 | L2-Norm=13.752 | L2-Norm(final)=3.177 | acc=1.0000 | 4464.9 samples/s | 69.8 steps/s
[Step=20250 Epoch=77.6] | Loss=0.00050 | Reg=0.00189 | L2-Norm=13.748 | L2-Norm(final)=3.178 | acc=1.0000 | 5600.3 samples/s | 87.5 steps/s
[Step=20300 Epoch=77.8] | Loss=0.00042 | Reg=0.00189 | L2-Norm=13.743 | L2-Norm(final)=3.180 | acc=1.0000 | 1880.0 samples/s | 29.4 steps/s
[Step=20350 Epoch=78.0] | Loss=0.00036 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.181 | acc=1.0000 | 4441.0 samples/s | 69.4 steps/s
[Step=20400 Epoch=78.2] | Loss=0.00032 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.181 | acc=1.0000 | 4508.5 samples/s | 70.4 steps/s
[Step=20450 Epoch=78.4] | Loss=0.00028 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.182 | acc=1.0000 | 4416.6 samples/s | 69.0 steps/s
[Step=20500 Epoch=78.5] | Loss=0.00025 | Reg=0.00188 | L2-Norm=13.719 | L2-Norm(final)=3.183 | acc=1.0000 | 4991.3 samples/s | 78.0 steps/s
[Step=20550 Epoch=78.7] | Loss=0.00023 | Reg=0.00188 | L2-Norm=13.713 | L2-Norm(final)=3.183 | acc=1.0000 | 1985.3 samples/s | 31.0 steps/s
[Step=20600 Epoch=78.9] | Loss=0.00021 | Reg=0.00188 | L2-Norm=13.707 | L2-Norm(final)=3.184 | acc=1.0000 | 4514.6 samples/s | 70.5 steps/s
[Step=20650 Epoch=79.1] | Loss=0.00020 | Reg=0.00188 | L2-Norm=13.700 | L2-Norm(final)=3.184 | acc=1.0000 | 4570.8 samples/s | 71.4 steps/s
[Step=20700 Epoch=79.3] | Loss=0.00018 | Reg=0.00188 | L2-Norm=13.693 | L2-Norm(final)=3.185 | acc=1.0000 | 4450.0 samples/s | 69.5 steps/s
[Step=20750 Epoch=79.5] | Loss=0.00017 | Reg=0.00187 | L2-Norm=13.686 | L2-Norm(final)=3.185 | acc=1.0000 | 4396.1 samples/s | 68.7 steps/s
[Step=20800 Epoch=79.7] | Loss=0.00016 | Reg=0.00187 | L2-Norm=13.679 | L2-Norm(final)=3.186 | acc=1.0000 | 2077.2 samples/s | 32.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=77.0] | Loss=0.06313 | Reg=0.00188 | L2-Norm=13.708 | L2-Norm(final)=3.176 | acc=0.9688 | 4253.7 samples/s | 66.5 steps/s
[Step=20050 Epoch=77.2] | Loss=0.00315 | Reg=0.00189 | L2-Norm=13.753 | L2-Norm(final)=3.175 | acc=1.0000 | 4007.6 samples/s | 62.6 steps/s
[Step=20100 Epoch=77.4] | Loss=0.00163 | Reg=0.00189 | L2-Norm=13.760 | L2-Norm(final)=3.177 | acc=1.0000 | 4392.7 samples/s | 68.6 steps/s
[Step=20150 Epoch=77.6] | Loss=0.00109 | Reg=0.00189 | L2-Norm=13.760 | L2-Norm(final)=3.178 | acc=1.0000 | 4386.8 samples/s | 68.5 steps/s
[Step=20200 Epoch=77.8] | Loss=0.00082 | Reg=0.00189 | L2-Norm=13.757 | L2-Norm(final)=3.179 | acc=1.0000 | 4398.2 samples/s | 68.7 steps/s
[Step=20250 Epoch=78.0] | Loss=0.00066 | Reg=0.00189 | L2-Norm=13.753 | L2-Norm(final)=3.180 | acc=1.0000 | 5709.6 samples/s | 89.2 steps/s
[Step=20300 Epoch=78.1] | Loss=0.00055 | Reg=0.00189 | L2-Norm=13.749 | L2-Norm(final)=3.181 | acc=1.0000 | 1898.5 samples/s | 29.7 steps/s
[Step=20350 Epoch=78.3] | Loss=0.00048 | Reg=0.00189 | L2-Norm=13.744 | L2-Norm(final)=3.182 | acc=1.0000 | 4495.6 samples/s | 70.2 steps/s
[Step=20400 Epoch=78.5] | Loss=0.00042 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.183 | acc=1.0000 | 4409.5 samples/s | 68.9 steps/s
[Step=20450 Epoch=78.7] | Loss=0.00037 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.184 | acc=1.0000 | 4393.5 samples/s | 68.6 steps/s
[Step=20500 Epoch=78.9] | Loss=0.00033 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.185 | acc=1.0000 | 5056.6 samples/s | 79.0 steps/s
[Step=20550 Epoch=79.1] | Loss=0.00030 | Reg=0.00188 | L2-Norm=13.723 | L2-Norm(final)=3.185 | acc=1.0000 | 1987.8 samples/s | 31.1 steps/s
[Step=20600 Epoch=79.3] | Loss=0.00028 | Reg=0.00188 | L2-Norm=13.718 | L2-Norm(final)=3.186 | acc=1.0000 | 4471.8 samples/s | 69.9 steps/s
[Step=20650 Epoch=79.5] | Loss=0.00026 | Reg=0.00188 | L2-Norm=13.712 | L2-Norm(final)=3.187 | acc=1.0000 | 4464.0 samples/s | 69.8 steps/s
[Step=20700 Epoch=79.7] | Loss=0.00024 | Reg=0.00188 | L2-Norm=13.707 | L2-Norm(final)=3.187 | acc=1.0000 | 4216.0 samples/s | 65.9 steps/s
[Step=20750 Epoch=79.9] | Loss=0.00022 | Reg=0.00188 | L2-Norm=13.701 | L2-Norm(final)=3.188 | acc=1.0000 | 4485.6 samples/s | 70.1 steps/s
[Step=20800 Epoch=80.1] | Loss=0.00021 | Reg=0.00188 | L2-Norm=13.695 | L2-Norm(final)=3.188 | acc=1.0000 | 2064.4 samples/s | 32.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25989 | acc=0.8634 | tpr=0.8063 | fpr=0.0126 | 4199.0 samples/s | 16.4 steps/s
Avg test loss: 0.26508, Avg test acc: 0.86281, Avg tpr: 0.80643, Avg fpr: 0.01320, total FA: 103

Testing server on iccad2012
[Step=  50] | Loss=0.39066 | acc=0.8966 | tpr=0.9558 | fpr=0.1044 | 4314.8 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.39340 | acc=0.8967 | tpr=0.9701 | fpr=0.1047 | 8694.6 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.39747 | acc=0.8962 | tpr=0.9755 | fpr=0.1053 | 8066.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.39790 | acc=0.8974 | tpr=0.9760 | fpr=0.1041 | 8138.0 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.39643 | acc=0.8978 | tpr=0.9773 | fpr=0.1037 | 8315.9 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.40094 | acc=0.8973 | tpr=0.9767 | fpr=0.1041 | 8429.3 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.40418 | acc=0.8971 | tpr=0.9768 | fpr=0.1044 | 8243.2 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.40670 | acc=0.8968 | tpr=0.9754 | fpr=0.1046 | 8511.2 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.41189 | acc=0.8965 | tpr=0.9747 | fpr=0.1049 | 8018.3 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.41262 | acc=0.8963 | tpr=0.9749 | fpr=0.1052 | 8355.9 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.41190 | acc=0.8964 | tpr=0.9753 | fpr=0.1050 | 14863.0 samples/s | 58.1 steps/s
Avg test loss: 0.41175, Avg test acc: 0.89634, Avg tpr: 0.97504, Avg fpr: 0.10509, total FA: 14592

server round 26/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=40.6] | Loss=0.13021 | Reg=0.00187 | L2-Norm=13.660 | L2-Norm(final)=3.220 | acc=0.9062 | 4085.1 samples/s | 63.8 steps/s
[Step=20850 Epoch=40.7] | Loss=0.02643 | Reg=0.00188 | L2-Norm=13.697 | L2-Norm(final)=3.210 | acc=0.9844 | 4453.1 samples/s | 69.6 steps/s
[Step=20900 Epoch=40.8] | Loss=0.01892 | Reg=0.00188 | L2-Norm=13.710 | L2-Norm(final)=3.213 | acc=0.9844 | 4641.0 samples/s | 72.5 steps/s
[Step=20950 Epoch=40.9] | Loss=0.01600 | Reg=0.00188 | L2-Norm=13.717 | L2-Norm(final)=3.218 | acc=0.9844 | 4719.6 samples/s | 73.7 steps/s
[Step=21000 Epoch=41.0] | Loss=0.01514 | Reg=0.00188 | L2-Norm=13.722 | L2-Norm(final)=3.222 | acc=0.9531 | 4628.5 samples/s | 72.3 steps/s
[Step=21050 Epoch=41.1] | Loss=0.01406 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.226 | acc=1.0000 | 4718.4 samples/s | 73.7 steps/s
[Step=21100 Epoch=41.2] | Loss=0.01316 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.230 | acc=1.0000 | 4746.4 samples/s | 74.2 steps/s
[Step=21150 Epoch=41.3] | Loss=0.01264 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.234 | acc=1.0000 | 4754.2 samples/s | 74.3 steps/s
[Step=21200 Epoch=41.3] | Loss=0.01224 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.236 | acc=1.0000 | 4729.9 samples/s | 73.9 steps/s
[Step=21250 Epoch=41.4] | Loss=0.01206 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.238 | acc=1.0000 | 4751.4 samples/s | 74.2 steps/s
[Step=21300 Epoch=41.5] | Loss=0.01192 | Reg=0.00189 | L2-Norm=13.742 | L2-Norm(final)=3.240 | acc=1.0000 | 5775.6 samples/s | 90.2 steps/s
[Step=21350 Epoch=41.6] | Loss=0.01172 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=3.243 | acc=0.9844 | 1950.7 samples/s | 30.5 steps/s
[Step=21400 Epoch=41.7] | Loss=0.01151 | Reg=0.00189 | L2-Norm=13.748 | L2-Norm(final)=3.245 | acc=0.9844 | 4707.8 samples/s | 73.6 steps/s
[Step=21450 Epoch=41.8] | Loss=0.01127 | Reg=0.00189 | L2-Norm=13.750 | L2-Norm(final)=3.247 | acc=1.0000 | 4709.4 samples/s | 73.6 steps/s
[Step=21500 Epoch=41.9] | Loss=0.01110 | Reg=0.00189 | L2-Norm=13.752 | L2-Norm(final)=3.249 | acc=1.0000 | 4662.3 samples/s | 72.8 steps/s
[Step=21550 Epoch=42.0] | Loss=0.01096 | Reg=0.00189 | L2-Norm=13.754 | L2-Norm(final)=3.251 | acc=0.9844 | 4686.7 samples/s | 73.2 steps/s
[Step=21600 Epoch=42.1] | Loss=0.01086 | Reg=0.00189 | L2-Norm=13.756 | L2-Norm(final)=3.253 | acc=1.0000 | 4724.2 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step21600.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=40.7] | Loss=0.23910 | Reg=0.00187 | L2-Norm=13.660 | L2-Norm(final)=3.220 | acc=0.8750 | 4067.3 samples/s | 63.6 steps/s
[Step=20850 Epoch=40.8] | Loss=0.03026 | Reg=0.00188 | L2-Norm=13.696 | L2-Norm(final)=3.205 | acc=1.0000 | 4610.3 samples/s | 72.0 steps/s
[Step=20900 Epoch=40.9] | Loss=0.02082 | Reg=0.00188 | L2-Norm=13.708 | L2-Norm(final)=3.207 | acc=0.9844 | 4720.9 samples/s | 73.8 steps/s
[Step=20950 Epoch=41.0] | Loss=0.01789 | Reg=0.00188 | L2-Norm=13.716 | L2-Norm(final)=3.211 | acc=1.0000 | 4664.1 samples/s | 72.9 steps/s
[Step=21000 Epoch=41.1] | Loss=0.01648 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=3.215 | acc=1.0000 | 4695.2 samples/s | 73.4 steps/s
[Step=21050 Epoch=41.2] | Loss=0.01530 | Reg=0.00188 | L2-Norm=13.724 | L2-Norm(final)=3.218 | acc=1.0000 | 4768.7 samples/s | 74.5 steps/s
[Step=21100 Epoch=41.2] | Loss=0.01443 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.221 | acc=0.9844 | 4672.3 samples/s | 73.0 steps/s
[Step=21150 Epoch=41.3] | Loss=0.01402 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.224 | acc=1.0000 | 4712.8 samples/s | 73.6 steps/s
[Step=21200 Epoch=41.4] | Loss=0.01345 | Reg=0.00189 | L2-Norm=13.733 | L2-Norm(final)=3.226 | acc=1.0000 | 4713.9 samples/s | 73.7 steps/s
[Step=21250 Epoch=41.5] | Loss=0.01289 | Reg=0.00189 | L2-Norm=13.735 | L2-Norm(final)=3.229 | acc=0.9844 | 4834.2 samples/s | 75.5 steps/s
[Step=21300 Epoch=41.6] | Loss=0.01250 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=3.231 | acc=1.0000 | 5751.8 samples/s | 89.9 steps/s
[Step=21350 Epoch=41.7] | Loss=0.01213 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.233 | acc=0.9688 | 1981.6 samples/s | 31.0 steps/s
[Step=21400 Epoch=41.8] | Loss=0.01185 | Reg=0.00189 | L2-Norm=13.742 | L2-Norm(final)=3.236 | acc=1.0000 | 4660.0 samples/s | 72.8 steps/s
[Step=21450 Epoch=41.9] | Loss=0.01160 | Reg=0.00189 | L2-Norm=13.744 | L2-Norm(final)=3.238 | acc=1.0000 | 4712.8 samples/s | 73.6 steps/s
[Step=21500 Epoch=42.0] | Loss=0.01143 | Reg=0.00189 | L2-Norm=13.747 | L2-Norm(final)=3.240 | acc=0.9844 | 4753.7 samples/s | 74.3 steps/s
[Step=21550 Epoch=42.1] | Loss=0.01126 | Reg=0.00189 | L2-Norm=13.748 | L2-Norm(final)=3.243 | acc=0.9844 | 4752.8 samples/s | 74.3 steps/s
[Step=21600 Epoch=42.2] | Loss=0.01113 | Reg=0.00189 | L2-Norm=13.750 | L2-Norm(final)=3.245 | acc=1.0000 | 4657.7 samples/s | 72.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step21600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=79.7] | Loss=0.03412 | Reg=0.00187 | L2-Norm=13.660 | L2-Norm(final)=3.221 | acc=0.9688 | 4085.6 samples/s | 63.8 steps/s
[Step=20850 Epoch=79.9] | Loss=0.00370 | Reg=0.00188 | L2-Norm=13.703 | L2-Norm(final)=3.218 | acc=1.0000 | 4065.1 samples/s | 63.5 steps/s
[Step=20900 Epoch=80.1] | Loss=0.00197 | Reg=0.00188 | L2-Norm=13.714 | L2-Norm(final)=3.218 | acc=1.0000 | 4490.7 samples/s | 70.2 steps/s
[Step=20950 Epoch=80.3] | Loss=0.00133 | Reg=0.00188 | L2-Norm=13.715 | L2-Norm(final)=3.220 | acc=1.0000 | 4469.6 samples/s | 69.8 steps/s
[Step=21000 Epoch=80.5] | Loss=0.00101 | Reg=0.00188 | L2-Norm=13.713 | L2-Norm(final)=3.222 | acc=1.0000 | 4515.3 samples/s | 70.6 steps/s
[Step=21050 Epoch=80.7] | Loss=0.00082 | Reg=0.00188 | L2-Norm=13.710 | L2-Norm(final)=3.224 | acc=1.0000 | 5454.1 samples/s | 85.2 steps/s
[Step=21100 Epoch=80.8] | Loss=0.00068 | Reg=0.00188 | L2-Norm=13.706 | L2-Norm(final)=3.226 | acc=1.0000 | 1882.8 samples/s | 29.4 steps/s
[Step=21150 Epoch=81.0] | Loss=0.00059 | Reg=0.00188 | L2-Norm=13.701 | L2-Norm(final)=3.227 | acc=1.0000 | 4407.6 samples/s | 68.9 steps/s
[Step=21200 Epoch=81.2] | Loss=0.00051 | Reg=0.00188 | L2-Norm=13.696 | L2-Norm(final)=3.228 | acc=1.0000 | 4501.3 samples/s | 70.3 steps/s
[Step=21250 Epoch=81.4] | Loss=0.00046 | Reg=0.00187 | L2-Norm=13.691 | L2-Norm(final)=3.229 | acc=1.0000 | 4460.9 samples/s | 69.7 steps/s
[Step=21300 Epoch=81.6] | Loss=0.00042 | Reg=0.00187 | L2-Norm=13.685 | L2-Norm(final)=3.230 | acc=1.0000 | 4988.6 samples/s | 77.9 steps/s
[Step=21350 Epoch=81.8] | Loss=0.00038 | Reg=0.00187 | L2-Norm=13.680 | L2-Norm(final)=3.231 | acc=1.0000 | 1969.7 samples/s | 30.8 steps/s
[Step=21400 Epoch=82.0] | Loss=0.00035 | Reg=0.00187 | L2-Norm=13.674 | L2-Norm(final)=3.232 | acc=1.0000 | 4363.5 samples/s | 68.2 steps/s
[Step=21450 Epoch=82.2] | Loss=0.00032 | Reg=0.00187 | L2-Norm=13.669 | L2-Norm(final)=3.233 | acc=1.0000 | 4453.7 samples/s | 69.6 steps/s
[Step=21500 Epoch=82.4] | Loss=0.00030 | Reg=0.00187 | L2-Norm=13.663 | L2-Norm(final)=3.234 | acc=1.0000 | 4487.0 samples/s | 70.1 steps/s
[Step=21550 Epoch=82.6] | Loss=0.00028 | Reg=0.00187 | L2-Norm=13.657 | L2-Norm(final)=3.235 | acc=1.0000 | 4485.0 samples/s | 70.1 steps/s
[Step=21600 Epoch=82.8] | Loss=0.00026 | Reg=0.00186 | L2-Norm=13.651 | L2-Norm(final)=3.235 | acc=1.0000 | 2076.7 samples/s | 32.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step21600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=80.1] | Loss=0.05512 | Reg=0.00187 | L2-Norm=13.660 | L2-Norm(final)=3.220 | acc=0.9844 | 4305.1 samples/s | 67.3 steps/s
[Step=20850 Epoch=80.3] | Loss=0.00200 | Reg=0.00188 | L2-Norm=13.694 | L2-Norm(final)=3.221 | acc=1.0000 | 3946.3 samples/s | 61.7 steps/s
[Step=20900 Epoch=80.5] | Loss=0.00104 | Reg=0.00188 | L2-Norm=13.703 | L2-Norm(final)=3.223 | acc=1.0000 | 4369.2 samples/s | 68.3 steps/s
[Step=20950 Epoch=80.6] | Loss=0.00073 | Reg=0.00188 | L2-Norm=13.703 | L2-Norm(final)=3.225 | acc=1.0000 | 4472.2 samples/s | 69.9 steps/s
[Step=21000 Epoch=80.8] | Loss=0.00056 | Reg=0.00188 | L2-Norm=13.702 | L2-Norm(final)=3.227 | acc=1.0000 | 4456.2 samples/s | 69.6 steps/s
[Step=21050 Epoch=81.0] | Loss=0.00045 | Reg=0.00188 | L2-Norm=13.699 | L2-Norm(final)=3.229 | acc=1.0000 | 5738.7 samples/s | 89.7 steps/s
[Step=21100 Epoch=81.2] | Loss=0.00037 | Reg=0.00188 | L2-Norm=13.695 | L2-Norm(final)=3.230 | acc=1.0000 | 1911.4 samples/s | 29.9 steps/s
[Step=21150 Epoch=81.4] | Loss=0.00032 | Reg=0.00187 | L2-Norm=13.690 | L2-Norm(final)=3.230 | acc=1.0000 | 4432.2 samples/s | 69.3 steps/s
[Step=21200 Epoch=81.6] | Loss=0.00028 | Reg=0.00187 | L2-Norm=13.685 | L2-Norm(final)=3.231 | acc=1.0000 | 4470.7 samples/s | 69.9 steps/s
[Step=21250 Epoch=81.8] | Loss=0.00025 | Reg=0.00187 | L2-Norm=13.679 | L2-Norm(final)=3.232 | acc=1.0000 | 4468.5 samples/s | 69.8 steps/s
[Step=21300 Epoch=82.0] | Loss=0.00022 | Reg=0.00187 | L2-Norm=13.674 | L2-Norm(final)=3.232 | acc=1.0000 | 5071.3 samples/s | 79.2 steps/s
[Step=21350 Epoch=82.2] | Loss=0.00020 | Reg=0.00187 | L2-Norm=13.668 | L2-Norm(final)=3.233 | acc=1.0000 | 1990.8 samples/s | 31.1 steps/s
[Step=21400 Epoch=82.4] | Loss=0.00019 | Reg=0.00187 | L2-Norm=13.663 | L2-Norm(final)=3.233 | acc=1.0000 | 4425.8 samples/s | 69.2 steps/s
[Step=21450 Epoch=82.6] | Loss=0.00017 | Reg=0.00187 | L2-Norm=13.657 | L2-Norm(final)=3.233 | acc=1.0000 | 4450.8 samples/s | 69.5 steps/s
[Step=21500 Epoch=82.8] | Loss=0.00016 | Reg=0.00186 | L2-Norm=13.651 | L2-Norm(final)=3.234 | acc=1.0000 | 4457.9 samples/s | 69.7 steps/s
[Step=21550 Epoch=83.0] | Loss=0.00015 | Reg=0.00186 | L2-Norm=13.645 | L2-Norm(final)=3.234 | acc=1.0000 | 4470.9 samples/s | 69.9 steps/s
[Step=21600 Epoch=83.1] | Loss=0.00014 | Reg=0.00186 | L2-Norm=13.638 | L2-Norm(final)=3.234 | acc=1.0000 | 2026.1 samples/s | 31.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26286 | acc=0.8627 | tpr=0.8042 | fpr=0.0102 | 4241.8 samples/s | 16.6 steps/s
Avg test loss: 0.26755, Avg test acc: 0.86161, Avg tpr: 0.80381, Avg fpr: 0.01128, total FA: 88

Testing server on iccad2012
[Step=  50] | Loss=0.39628 | acc=0.8905 | tpr=0.9558 | fpr=0.1107 | 4289.1 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.39610 | acc=0.8921 | tpr=0.9723 | fpr=0.1094 | 8215.5 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.40051 | acc=0.8915 | tpr=0.9769 | fpr=0.1101 | 8381.5 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.40063 | acc=0.8924 | tpr=0.9770 | fpr=0.1091 | 8050.8 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.39991 | acc=0.8923 | tpr=0.9782 | fpr=0.1092 | 8309.9 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.40489 | acc=0.8920 | tpr=0.9782 | fpr=0.1096 | 8327.6 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.40815 | acc=0.8917 | tpr=0.9775 | fpr=0.1099 | 8050.6 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.41032 | acc=0.8916 | tpr=0.9759 | fpr=0.1099 | 8178.2 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.41572 | acc=0.8911 | tpr=0.9747 | fpr=0.1104 | 8241.9 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.41634 | acc=0.8908 | tpr=0.9753 | fpr=0.1107 | 8102.8 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.41556 | acc=0.8909 | tpr=0.9749 | fpr=0.1106 | 14688.2 samples/s | 57.4 steps/s
Avg test loss: 0.41538, Avg test acc: 0.89078, Avg tpr: 0.97464, Avg fpr: 0.11074, total FA: 15376

server round 27/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=42.1] | Loss=0.15208 | Reg=0.00185 | L2-Norm=13.615 | L2-Norm(final)=3.260 | acc=0.9219 | 3712.4 samples/s | 58.0 steps/s
[Step=21650 Epoch=42.2] | Loss=0.02272 | Reg=0.00186 | L2-Norm=13.644 | L2-Norm(final)=3.251 | acc=1.0000 | 4636.5 samples/s | 72.4 steps/s
[Step=21700 Epoch=42.3] | Loss=0.01635 | Reg=0.00186 | L2-Norm=13.654 | L2-Norm(final)=3.253 | acc=1.0000 | 4691.7 samples/s | 73.3 steps/s
[Step=21750 Epoch=42.4] | Loss=0.01364 | Reg=0.00187 | L2-Norm=13.660 | L2-Norm(final)=3.258 | acc=0.9844 | 4639.3 samples/s | 72.5 steps/s
[Step=21800 Epoch=42.5] | Loss=0.01224 | Reg=0.00187 | L2-Norm=13.666 | L2-Norm(final)=3.262 | acc=1.0000 | 4639.6 samples/s | 72.5 steps/s
[Step=21850 Epoch=42.6] | Loss=0.01238 | Reg=0.00187 | L2-Norm=13.670 | L2-Norm(final)=3.266 | acc=1.0000 | 4674.4 samples/s | 73.0 steps/s
[Step=21900 Epoch=42.7] | Loss=0.01220 | Reg=0.00187 | L2-Norm=13.674 | L2-Norm(final)=3.269 | acc=1.0000 | 4751.5 samples/s | 74.2 steps/s
[Step=21950 Epoch=42.8] | Loss=0.01224 | Reg=0.00187 | L2-Norm=13.678 | L2-Norm(final)=3.272 | acc=1.0000 | 4657.1 samples/s | 72.8 steps/s
[Step=22000 Epoch=42.9] | Loss=0.01212 | Reg=0.00187 | L2-Norm=13.682 | L2-Norm(final)=3.275 | acc=1.0000 | 4716.7 samples/s | 73.7 steps/s
[Step=22050 Epoch=43.0] | Loss=0.01190 | Reg=0.00187 | L2-Norm=13.685 | L2-Norm(final)=3.277 | acc=0.9688 | 4742.9 samples/s | 74.1 steps/s
[Step=22100 Epoch=43.1] | Loss=0.01154 | Reg=0.00187 | L2-Norm=13.689 | L2-Norm(final)=3.280 | acc=1.0000 | 5594.7 samples/s | 87.4 steps/s
[Step=22150 Epoch=43.2] | Loss=0.01138 | Reg=0.00187 | L2-Norm=13.692 | L2-Norm(final)=3.283 | acc=1.0000 | 1920.6 samples/s | 30.0 steps/s
[Step=22200 Epoch=43.3] | Loss=0.01129 | Reg=0.00188 | L2-Norm=13.695 | L2-Norm(final)=3.285 | acc=0.9844 | 4677.7 samples/s | 73.1 steps/s
[Step=22250 Epoch=43.4] | Loss=0.01086 | Reg=0.00188 | L2-Norm=13.697 | L2-Norm(final)=3.288 | acc=1.0000 | 4712.6 samples/s | 73.6 steps/s
[Step=22300 Epoch=43.5] | Loss=0.01051 | Reg=0.00188 | L2-Norm=13.700 | L2-Norm(final)=3.291 | acc=1.0000 | 4730.7 samples/s | 73.9 steps/s
[Step=22350 Epoch=43.6] | Loss=0.01044 | Reg=0.00188 | L2-Norm=13.703 | L2-Norm(final)=3.294 | acc=0.9844 | 4672.5 samples/s | 73.0 steps/s
[Step=22400 Epoch=43.7] | Loss=0.01022 | Reg=0.00188 | L2-Norm=13.705 | L2-Norm(final)=3.296 | acc=1.0000 | 4761.0 samples/s | 74.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step22400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=42.2] | Loss=0.10143 | Reg=0.00185 | L2-Norm=13.615 | L2-Norm(final)=3.260 | acc=0.9375 | 4162.8 samples/s | 65.0 steps/s
[Step=21650 Epoch=42.3] | Loss=0.02351 | Reg=0.00186 | L2-Norm=13.645 | L2-Norm(final)=3.253 | acc=0.9844 | 4544.5 samples/s | 71.0 steps/s
[Step=21700 Epoch=42.4] | Loss=0.01644 | Reg=0.00186 | L2-Norm=13.654 | L2-Norm(final)=3.256 | acc=0.9844 | 4451.5 samples/s | 69.6 steps/s
[Step=21750 Epoch=42.5] | Loss=0.01344 | Reg=0.00187 | L2-Norm=13.659 | L2-Norm(final)=3.260 | acc=0.9844 | 4504.6 samples/s | 70.4 steps/s
[Step=21800 Epoch=42.6] | Loss=0.01368 | Reg=0.00187 | L2-Norm=13.664 | L2-Norm(final)=3.264 | acc=0.9531 | 4579.0 samples/s | 71.5 steps/s
[Step=21850 Epoch=42.7] | Loss=0.01265 | Reg=0.00187 | L2-Norm=13.668 | L2-Norm(final)=3.266 | acc=0.9844 | 4728.8 samples/s | 73.9 steps/s
[Step=21900 Epoch=42.8] | Loss=0.01266 | Reg=0.00187 | L2-Norm=13.672 | L2-Norm(final)=3.268 | acc=1.0000 | 4700.4 samples/s | 73.4 steps/s
[Step=21950 Epoch=42.9] | Loss=0.01272 | Reg=0.00187 | L2-Norm=13.675 | L2-Norm(final)=3.270 | acc=0.9844 | 4825.2 samples/s | 75.4 steps/s
[Step=22000 Epoch=43.0] | Loss=0.01242 | Reg=0.00187 | L2-Norm=13.678 | L2-Norm(final)=3.272 | acc=1.0000 | 4639.4 samples/s | 72.5 steps/s
[Step=22050 Epoch=43.1] | Loss=0.01224 | Reg=0.00187 | L2-Norm=13.681 | L2-Norm(final)=3.274 | acc=1.0000 | 4756.6 samples/s | 74.3 steps/s
[Step=22100 Epoch=43.2] | Loss=0.01190 | Reg=0.00187 | L2-Norm=13.684 | L2-Norm(final)=3.276 | acc=0.9844 | 5872.7 samples/s | 91.8 steps/s
[Step=22150 Epoch=43.3] | Loss=0.01150 | Reg=0.00187 | L2-Norm=13.687 | L2-Norm(final)=3.279 | acc=0.9844 | 1987.3 samples/s | 31.1 steps/s
[Step=22200 Epoch=43.4] | Loss=0.01130 | Reg=0.00187 | L2-Norm=13.690 | L2-Norm(final)=3.281 | acc=0.9844 | 4719.6 samples/s | 73.7 steps/s
[Step=22250 Epoch=43.5] | Loss=0.01097 | Reg=0.00187 | L2-Norm=13.692 | L2-Norm(final)=3.284 | acc=1.0000 | 4712.3 samples/s | 73.6 steps/s
[Step=22300 Epoch=43.6] | Loss=0.01075 | Reg=0.00188 | L2-Norm=13.695 | L2-Norm(final)=3.286 | acc=1.0000 | 4768.3 samples/s | 74.5 steps/s
[Step=22350 Epoch=43.7] | Loss=0.01072 | Reg=0.00188 | L2-Norm=13.697 | L2-Norm(final)=3.289 | acc=0.9844 | 4731.6 samples/s | 73.9 steps/s
[Step=22400 Epoch=43.8] | Loss=0.01056 | Reg=0.00188 | L2-Norm=13.699 | L2-Norm(final)=3.291 | acc=1.0000 | 4683.2 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step22400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=82.8] | Loss=0.08028 | Reg=0.00185 | L2-Norm=13.615 | L2-Norm(final)=3.260 | acc=0.9375 | 4084.8 samples/s | 63.8 steps/s
[Step=21650 Epoch=83.0] | Loss=0.00208 | Reg=0.00187 | L2-Norm=13.659 | L2-Norm(final)=3.266 | acc=1.0000 | 4085.5 samples/s | 63.8 steps/s
[Step=21700 Epoch=83.1] | Loss=0.00107 | Reg=0.00187 | L2-Norm=13.663 | L2-Norm(final)=3.267 | acc=1.0000 | 4432.6 samples/s | 69.3 steps/s
[Step=21750 Epoch=83.3] | Loss=0.00072 | Reg=0.00187 | L2-Norm=13.660 | L2-Norm(final)=3.269 | acc=1.0000 | 4480.8 samples/s | 70.0 steps/s
[Step=21800 Epoch=83.5] | Loss=0.00060 | Reg=0.00186 | L2-Norm=13.656 | L2-Norm(final)=3.270 | acc=1.0000 | 4521.5 samples/s | 70.6 steps/s
[Step=21850 Epoch=83.7] | Loss=0.00054 | Reg=0.00186 | L2-Norm=13.653 | L2-Norm(final)=3.271 | acc=1.0000 | 5633.1 samples/s | 88.0 steps/s
[Step=21900 Epoch=83.9] | Loss=0.00046 | Reg=0.00186 | L2-Norm=13.651 | L2-Norm(final)=3.273 | acc=1.0000 | 1918.0 samples/s | 30.0 steps/s
[Step=21950 Epoch=84.1] | Loss=0.00040 | Reg=0.00186 | L2-Norm=13.648 | L2-Norm(final)=3.275 | acc=1.0000 | 4427.0 samples/s | 69.2 steps/s
[Step=22000 Epoch=84.3] | Loss=0.00035 | Reg=0.00186 | L2-Norm=13.645 | L2-Norm(final)=3.276 | acc=1.0000 | 4453.1 samples/s | 69.6 steps/s
[Step=22050 Epoch=84.5] | Loss=0.00031 | Reg=0.00186 | L2-Norm=13.641 | L2-Norm(final)=3.277 | acc=1.0000 | 4513.5 samples/s | 70.5 steps/s
[Step=22100 Epoch=84.7] | Loss=0.00028 | Reg=0.00186 | L2-Norm=13.636 | L2-Norm(final)=3.278 | acc=1.0000 | 4800.8 samples/s | 75.0 steps/s
[Step=22150 Epoch=84.9] | Loss=0.00026 | Reg=0.00186 | L2-Norm=13.631 | L2-Norm(final)=3.279 | acc=1.0000 | 1985.5 samples/s | 31.0 steps/s
[Step=22200 Epoch=85.1] | Loss=0.00023 | Reg=0.00186 | L2-Norm=13.626 | L2-Norm(final)=3.279 | acc=1.0000 | 4539.8 samples/s | 70.9 steps/s
[Step=22250 Epoch=85.3] | Loss=0.00022 | Reg=0.00186 | L2-Norm=13.621 | L2-Norm(final)=3.280 | acc=1.0000 | 4424.4 samples/s | 69.1 steps/s
[Step=22300 Epoch=85.4] | Loss=0.00020 | Reg=0.00185 | L2-Norm=13.616 | L2-Norm(final)=3.280 | acc=1.0000 | 4517.3 samples/s | 70.6 steps/s
[Step=22350 Epoch=85.6] | Loss=0.00019 | Reg=0.00185 | L2-Norm=13.610 | L2-Norm(final)=3.281 | acc=1.0000 | 4371.0 samples/s | 68.3 steps/s
[Step=22400 Epoch=85.8] | Loss=0.00018 | Reg=0.00185 | L2-Norm=13.604 | L2-Norm(final)=3.281 | acc=1.0000 | 2052.4 samples/s | 32.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step22400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=83.2] | Loss=0.02739 | Reg=0.00185 | L2-Norm=13.615 | L2-Norm(final)=3.260 | acc=0.9844 | 4195.1 samples/s | 65.5 steps/s
[Step=21650 Epoch=83.3] | Loss=0.00439 | Reg=0.00187 | L2-Norm=13.659 | L2-Norm(final)=3.262 | acc=1.0000 | 4053.8 samples/s | 63.3 steps/s
[Step=21700 Epoch=83.5] | Loss=0.00225 | Reg=0.00187 | L2-Norm=13.684 | L2-Norm(final)=3.259 | acc=1.0000 | 4501.1 samples/s | 70.3 steps/s
[Step=21750 Epoch=83.7] | Loss=0.00153 | Reg=0.00187 | L2-Norm=13.691 | L2-Norm(final)=3.258 | acc=1.0000 | 4477.3 samples/s | 70.0 steps/s
[Step=21800 Epoch=83.9] | Loss=0.00115 | Reg=0.00187 | L2-Norm=13.692 | L2-Norm(final)=3.259 | acc=1.0000 | 4468.6 samples/s | 69.8 steps/s
[Step=21850 Epoch=84.1] | Loss=0.00093 | Reg=0.00187 | L2-Norm=13.692 | L2-Norm(final)=3.259 | acc=1.0000 | 5740.5 samples/s | 89.7 steps/s
[Step=21900 Epoch=84.3] | Loss=0.00078 | Reg=0.00187 | L2-Norm=13.690 | L2-Norm(final)=3.259 | acc=1.0000 | 1892.6 samples/s | 29.6 steps/s
[Step=21950 Epoch=84.5] | Loss=0.00067 | Reg=0.00187 | L2-Norm=13.687 | L2-Norm(final)=3.260 | acc=1.0000 | 4398.6 samples/s | 68.7 steps/s
[Step=22000 Epoch=84.7] | Loss=0.00058 | Reg=0.00187 | L2-Norm=13.684 | L2-Norm(final)=3.260 | acc=1.0000 | 4415.6 samples/s | 69.0 steps/s
[Step=22050 Epoch=84.9] | Loss=0.00052 | Reg=0.00187 | L2-Norm=13.680 | L2-Norm(final)=3.261 | acc=1.0000 | 4522.7 samples/s | 70.7 steps/s
[Step=22100 Epoch=85.1] | Loss=0.00047 | Reg=0.00187 | L2-Norm=13.676 | L2-Norm(final)=3.261 | acc=1.0000 | 5059.3 samples/s | 79.1 steps/s
[Step=22150 Epoch=85.3] | Loss=0.00043 | Reg=0.00187 | L2-Norm=13.672 | L2-Norm(final)=3.261 | acc=1.0000 | 1980.7 samples/s | 30.9 steps/s
[Step=22200 Epoch=85.5] | Loss=0.00039 | Reg=0.00187 | L2-Norm=13.668 | L2-Norm(final)=3.261 | acc=1.0000 | 4456.7 samples/s | 69.6 steps/s
[Step=22250 Epoch=85.6] | Loss=0.00036 | Reg=0.00187 | L2-Norm=13.664 | L2-Norm(final)=3.262 | acc=1.0000 | 4380.9 samples/s | 68.5 steps/s
[Step=22300 Epoch=85.8] | Loss=0.00034 | Reg=0.00187 | L2-Norm=13.660 | L2-Norm(final)=3.262 | acc=1.0000 | 4465.5 samples/s | 69.8 steps/s
[Step=22350 Epoch=86.0] | Loss=0.00031 | Reg=0.00186 | L2-Norm=13.655 | L2-Norm(final)=3.262 | acc=1.0000 | 4557.4 samples/s | 71.2 steps/s
[Step=22400 Epoch=86.2] | Loss=0.00029 | Reg=0.00186 | L2-Norm=13.650 | L2-Norm(final)=3.262 | acc=1.0000 | 2069.7 samples/s | 32.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29068 | acc=0.8509 | tpr=0.7873 | fpr=0.0111 | 4298.6 samples/s | 16.8 steps/s
Avg test loss: 0.29533, Avg test acc: 0.85067, Avg tpr: 0.78848, Avg fpr: 0.01256, total FA: 98

Testing server on iccad2012
[Step=  50] | Loss=0.34221 | acc=0.9123 | tpr=0.9646 | fpr=0.0887 | 4356.3 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.34498 | acc=0.9137 | tpr=0.9765 | fpr=0.0874 | 8238.4 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.35003 | acc=0.9133 | tpr=0.9798 | fpr=0.0880 | 8246.2 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.35132 | acc=0.9139 | tpr=0.9792 | fpr=0.0873 | 8188.8 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.34998 | acc=0.9138 | tpr=0.9799 | fpr=0.0874 | 8294.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.35401 | acc=0.9136 | tpr=0.9796 | fpr=0.0876 | 8294.2 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.35744 | acc=0.9130 | tpr=0.9781 | fpr=0.0882 | 8465.8 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.35938 | acc=0.9128 | tpr=0.9770 | fpr=0.0884 | 8533.4 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.36474 | acc=0.9125 | tpr=0.9757 | fpr=0.0887 | 7993.8 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.36477 | acc=0.9123 | tpr=0.9762 | fpr=0.0889 | 8413.2 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.36384 | acc=0.9123 | tpr=0.9761 | fpr=0.0889 | 13704.4 samples/s | 53.5 steps/s
Avg test loss: 0.36350, Avg test acc: 0.91220, Avg tpr: 0.97544, Avg fpr: 0.08895, total FA: 12351

server round 28/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=43.7] | Loss=0.25824 | Reg=0.00185 | L2-Norm=13.588 | L2-Norm(final)=3.302 | acc=0.8750 | 4091.9 samples/s | 63.9 steps/s
[Step=22450 Epoch=43.8] | Loss=0.02519 | Reg=0.00185 | L2-Norm=13.618 | L2-Norm(final)=3.291 | acc=1.0000 | 4177.3 samples/s | 65.3 steps/s
[Step=22500 Epoch=43.9] | Loss=0.01805 | Reg=0.00186 | L2-Norm=13.630 | L2-Norm(final)=3.293 | acc=1.0000 | 4608.2 samples/s | 72.0 steps/s
[Step=22550 Epoch=44.0] | Loss=0.01536 | Reg=0.00186 | L2-Norm=13.636 | L2-Norm(final)=3.296 | acc=0.9688 | 4624.0 samples/s | 72.2 steps/s
[Step=22600 Epoch=44.1] | Loss=0.01416 | Reg=0.00186 | L2-Norm=13.641 | L2-Norm(final)=3.299 | acc=1.0000 | 4717.8 samples/s | 73.7 steps/s
[Step=22650 Epoch=44.2] | Loss=0.01317 | Reg=0.00186 | L2-Norm=13.645 | L2-Norm(final)=3.303 | acc=1.0000 | 4770.0 samples/s | 74.5 steps/s
[Step=22700 Epoch=44.3] | Loss=0.01289 | Reg=0.00186 | L2-Norm=13.649 | L2-Norm(final)=3.306 | acc=0.9844 | 4713.4 samples/s | 73.6 steps/s
[Step=22750 Epoch=44.4] | Loss=0.01222 | Reg=0.00186 | L2-Norm=13.652 | L2-Norm(final)=3.309 | acc=0.9844 | 4724.5 samples/s | 73.8 steps/s
[Step=22800 Epoch=44.5] | Loss=0.01230 | Reg=0.00186 | L2-Norm=13.656 | L2-Norm(final)=3.312 | acc=1.0000 | 4623.8 samples/s | 72.2 steps/s
[Step=22850 Epoch=44.6] | Loss=0.01205 | Reg=0.00187 | L2-Norm=13.658 | L2-Norm(final)=3.314 | acc=1.0000 | 4744.3 samples/s | 74.1 steps/s
[Step=22900 Epoch=44.7] | Loss=0.01220 | Reg=0.00187 | L2-Norm=13.660 | L2-Norm(final)=3.315 | acc=0.9844 | 5794.9 samples/s | 90.5 steps/s
[Step=22950 Epoch=44.8] | Loss=0.01191 | Reg=0.00187 | L2-Norm=13.662 | L2-Norm(final)=3.316 | acc=1.0000 | 1923.4 samples/s | 30.1 steps/s
[Step=23000 Epoch=44.9] | Loss=0.01143 | Reg=0.00187 | L2-Norm=13.664 | L2-Norm(final)=3.318 | acc=0.9844 | 4649.4 samples/s | 72.6 steps/s
[Step=23050 Epoch=45.0] | Loss=0.01140 | Reg=0.00187 | L2-Norm=13.666 | L2-Norm(final)=3.320 | acc=0.9688 | 4675.5 samples/s | 73.1 steps/s
[Step=23100 Epoch=45.1] | Loss=0.01111 | Reg=0.00187 | L2-Norm=13.668 | L2-Norm(final)=3.321 | acc=0.9844 | 4646.2 samples/s | 72.6 steps/s
[Step=23150 Epoch=45.2] | Loss=0.01087 | Reg=0.00187 | L2-Norm=13.670 | L2-Norm(final)=3.323 | acc=1.0000 | 4642.0 samples/s | 72.5 steps/s
[Step=23200 Epoch=45.2] | Loss=0.01062 | Reg=0.00187 | L2-Norm=13.672 | L2-Norm(final)=3.326 | acc=0.9844 | 4718.8 samples/s | 73.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step23200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=43.8] | Loss=0.02902 | Reg=0.00185 | L2-Norm=13.588 | L2-Norm(final)=3.303 | acc=0.9844 | 4424.5 samples/s | 69.1 steps/s
[Step=22450 Epoch=43.9] | Loss=0.02346 | Reg=0.00186 | L2-Norm=13.622 | L2-Norm(final)=3.296 | acc=1.0000 | 4220.2 samples/s | 65.9 steps/s
[Step=22500 Epoch=44.0] | Loss=0.01648 | Reg=0.00186 | L2-Norm=13.635 | L2-Norm(final)=3.301 | acc=0.9844 | 4693.2 samples/s | 73.3 steps/s
[Step=22550 Epoch=44.1] | Loss=0.01440 | Reg=0.00186 | L2-Norm=13.642 | L2-Norm(final)=3.306 | acc=1.0000 | 4708.1 samples/s | 73.6 steps/s
[Step=22600 Epoch=44.2] | Loss=0.01346 | Reg=0.00186 | L2-Norm=13.646 | L2-Norm(final)=3.309 | acc=1.0000 | 4698.2 samples/s | 73.4 steps/s
[Step=22650 Epoch=44.3] | Loss=0.01313 | Reg=0.00186 | L2-Norm=13.649 | L2-Norm(final)=3.311 | acc=0.9844 | 4705.8 samples/s | 73.5 steps/s
[Step=22700 Epoch=44.4] | Loss=0.01269 | Reg=0.00186 | L2-Norm=13.652 | L2-Norm(final)=3.314 | acc=1.0000 | 4562.8 samples/s | 71.3 steps/s
[Step=22750 Epoch=44.5] | Loss=0.01246 | Reg=0.00186 | L2-Norm=13.655 | L2-Norm(final)=3.316 | acc=1.0000 | 4656.7 samples/s | 72.8 steps/s
[Step=22800 Epoch=44.6] | Loss=0.01227 | Reg=0.00187 | L2-Norm=13.658 | L2-Norm(final)=3.318 | acc=0.9844 | 4701.0 samples/s | 73.5 steps/s
[Step=22850 Epoch=44.7] | Loss=0.01225 | Reg=0.00187 | L2-Norm=13.660 | L2-Norm(final)=3.320 | acc=1.0000 | 4686.5 samples/s | 73.2 steps/s
[Step=22900 Epoch=44.8] | Loss=0.01218 | Reg=0.00187 | L2-Norm=13.663 | L2-Norm(final)=3.322 | acc=1.0000 | 5810.1 samples/s | 90.8 steps/s
[Step=22950 Epoch=44.9] | Loss=0.01171 | Reg=0.00187 | L2-Norm=13.665 | L2-Norm(final)=3.323 | acc=1.0000 | 1968.9 samples/s | 30.8 steps/s
[Step=23000 Epoch=45.0] | Loss=0.01119 | Reg=0.00187 | L2-Norm=13.667 | L2-Norm(final)=3.326 | acc=1.0000 | 4697.3 samples/s | 73.4 steps/s
[Step=23050 Epoch=45.1] | Loss=0.01091 | Reg=0.00187 | L2-Norm=13.670 | L2-Norm(final)=3.328 | acc=1.0000 | 4727.3 samples/s | 73.9 steps/s
[Step=23100 Epoch=45.2] | Loss=0.01063 | Reg=0.00187 | L2-Norm=13.672 | L2-Norm(final)=3.330 | acc=1.0000 | 4723.2 samples/s | 73.8 steps/s
[Step=23150 Epoch=45.3] | Loss=0.01052 | Reg=0.00187 | L2-Norm=13.674 | L2-Norm(final)=3.333 | acc=1.0000 | 4657.7 samples/s | 72.8 steps/s
[Step=23200 Epoch=45.4] | Loss=0.01039 | Reg=0.00187 | L2-Norm=13.676 | L2-Norm(final)=3.335 | acc=1.0000 | 4692.4 samples/s | 73.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step23200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=85.8] | Loss=0.10136 | Reg=0.00185 | L2-Norm=13.588 | L2-Norm(final)=3.302 | acc=0.9688 | 3968.8 samples/s | 62.0 steps/s
[Step=22450 Epoch=86.0] | Loss=0.00257 | Reg=0.00185 | L2-Norm=13.618 | L2-Norm(final)=3.304 | acc=1.0000 | 4217.2 samples/s | 65.9 steps/s
[Step=22500 Epoch=86.2] | Loss=0.00148 | Reg=0.00186 | L2-Norm=13.622 | L2-Norm(final)=3.305 | acc=1.0000 | 4464.8 samples/s | 69.8 steps/s
[Step=22550 Epoch=86.4] | Loss=0.00102 | Reg=0.00186 | L2-Norm=13.622 | L2-Norm(final)=3.307 | acc=1.0000 | 4473.7 samples/s | 69.9 steps/s
[Step=22600 Epoch=86.6] | Loss=0.00077 | Reg=0.00186 | L2-Norm=13.620 | L2-Norm(final)=3.309 | acc=1.0000 | 4502.4 samples/s | 70.4 steps/s
[Step=22650 Epoch=86.8] | Loss=0.00062 | Reg=0.00185 | L2-Norm=13.617 | L2-Norm(final)=3.310 | acc=1.0000 | 5629.9 samples/s | 88.0 steps/s
[Step=22700 Epoch=87.0] | Loss=0.00052 | Reg=0.00185 | L2-Norm=13.613 | L2-Norm(final)=3.312 | acc=1.0000 | 1907.6 samples/s | 29.8 steps/s
[Step=22750 Epoch=87.2] | Loss=0.00045 | Reg=0.00185 | L2-Norm=13.608 | L2-Norm(final)=3.313 | acc=1.0000 | 4351.1 samples/s | 68.0 steps/s
[Step=22800 Epoch=87.4] | Loss=0.00039 | Reg=0.00185 | L2-Norm=13.603 | L2-Norm(final)=3.313 | acc=1.0000 | 4517.3 samples/s | 70.6 steps/s
[Step=22850 Epoch=87.6] | Loss=0.00035 | Reg=0.00185 | L2-Norm=13.598 | L2-Norm(final)=3.314 | acc=1.0000 | 4478.4 samples/s | 70.0 steps/s
[Step=22900 Epoch=87.7] | Loss=0.00031 | Reg=0.00185 | L2-Norm=13.592 | L2-Norm(final)=3.315 | acc=1.0000 | 4986.7 samples/s | 77.9 steps/s
[Step=22950 Epoch=87.9] | Loss=0.00029 | Reg=0.00185 | L2-Norm=13.586 | L2-Norm(final)=3.315 | acc=1.0000 | 1973.4 samples/s | 30.8 steps/s
[Step=23000 Epoch=88.1] | Loss=0.00026 | Reg=0.00184 | L2-Norm=13.581 | L2-Norm(final)=3.316 | acc=1.0000 | 4469.0 samples/s | 69.8 steps/s
[Step=23050 Epoch=88.3] | Loss=0.00024 | Reg=0.00184 | L2-Norm=13.575 | L2-Norm(final)=3.317 | acc=1.0000 | 4445.0 samples/s | 69.5 steps/s
[Step=23100 Epoch=88.5] | Loss=0.00023 | Reg=0.00184 | L2-Norm=13.569 | L2-Norm(final)=3.317 | acc=1.0000 | 4533.1 samples/s | 70.8 steps/s
[Step=23150 Epoch=88.7] | Loss=0.00021 | Reg=0.00184 | L2-Norm=13.563 | L2-Norm(final)=3.318 | acc=1.0000 | 4432.8 samples/s | 69.3 steps/s
[Step=23200 Epoch=88.9] | Loss=0.00020 | Reg=0.00184 | L2-Norm=13.556 | L2-Norm(final)=3.318 | acc=1.0000 | 2077.4 samples/s | 32.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step23200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=86.2] | Loss=0.00462 | Reg=0.00185 | L2-Norm=13.588 | L2-Norm(final)=3.303 | acc=1.0000 | 4166.7 samples/s | 65.1 steps/s
[Step=22450 Epoch=86.4] | Loss=0.00173 | Reg=0.00186 | L2-Norm=13.626 | L2-Norm(final)=3.305 | acc=1.0000 | 4064.0 samples/s | 63.5 steps/s
[Step=22500 Epoch=86.6] | Loss=0.00090 | Reg=0.00186 | L2-Norm=13.632 | L2-Norm(final)=3.307 | acc=1.0000 | 4504.7 samples/s | 70.4 steps/s
[Step=22550 Epoch=86.8] | Loss=0.00061 | Reg=0.00186 | L2-Norm=13.631 | L2-Norm(final)=3.308 | acc=1.0000 | 4452.8 samples/s | 69.6 steps/s
[Step=22600 Epoch=87.0] | Loss=0.00046 | Reg=0.00186 | L2-Norm=13.628 | L2-Norm(final)=3.309 | acc=1.0000 | 4512.3 samples/s | 70.5 steps/s
[Step=22650 Epoch=87.2] | Loss=0.00037 | Reg=0.00186 | L2-Norm=13.625 | L2-Norm(final)=3.310 | acc=1.0000 | 5664.3 samples/s | 88.5 steps/s
[Step=22700 Epoch=87.4] | Loss=0.00031 | Reg=0.00186 | L2-Norm=13.621 | L2-Norm(final)=3.311 | acc=1.0000 | 1894.9 samples/s | 29.6 steps/s
[Step=22750 Epoch=87.6] | Loss=0.00027 | Reg=0.00185 | L2-Norm=13.617 | L2-Norm(final)=3.311 | acc=1.0000 | 4533.8 samples/s | 70.8 steps/s
[Step=22800 Epoch=87.8] | Loss=0.00024 | Reg=0.00185 | L2-Norm=13.612 | L2-Norm(final)=3.312 | acc=1.0000 | 4436.2 samples/s | 69.3 steps/s
[Step=22850 Epoch=88.0] | Loss=0.00021 | Reg=0.00185 | L2-Norm=13.607 | L2-Norm(final)=3.312 | acc=1.0000 | 4502.9 samples/s | 70.4 steps/s
[Step=22900 Epoch=88.2] | Loss=0.00019 | Reg=0.00185 | L2-Norm=13.603 | L2-Norm(final)=3.313 | acc=1.0000 | 4913.8 samples/s | 76.8 steps/s
[Step=22950 Epoch=88.3] | Loss=0.00017 | Reg=0.00185 | L2-Norm=13.598 | L2-Norm(final)=3.313 | acc=1.0000 | 1965.3 samples/s | 30.7 steps/s
[Step=23000 Epoch=88.5] | Loss=0.00016 | Reg=0.00185 | L2-Norm=13.593 | L2-Norm(final)=3.314 | acc=1.0000 | 4446.4 samples/s | 69.5 steps/s
[Step=23050 Epoch=88.7] | Loss=0.00015 | Reg=0.00185 | L2-Norm=13.588 | L2-Norm(final)=3.314 | acc=1.0000 | 4436.7 samples/s | 69.3 steps/s
[Step=23100 Epoch=88.9] | Loss=0.00014 | Reg=0.00184 | L2-Norm=13.582 | L2-Norm(final)=3.314 | acc=1.0000 | 4478.4 samples/s | 70.0 steps/s
[Step=23150 Epoch=89.1] | Loss=0.00013 | Reg=0.00184 | L2-Norm=13.577 | L2-Norm(final)=3.315 | acc=1.0000 | 4566.3 samples/s | 71.3 steps/s
[Step=23200 Epoch=89.3] | Loss=0.00012 | Reg=0.00184 | L2-Norm=13.572 | L2-Norm(final)=3.315 | acc=1.0000 | 2083.8 samples/s | 32.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24072 | acc=0.8734 | tpr=0.8209 | fpr=0.0126 | 4320.8 samples/s | 16.9 steps/s
Avg test loss: 0.24577, Avg test acc: 0.87335, Avg tpr: 0.82165, Avg fpr: 0.01295, total FA: 101

Testing server on iccad2012
[Step=  50] | Loss=0.41013 | acc=0.8912 | tpr=0.9690 | fpr=0.1101 | 4310.3 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.40982 | acc=0.8930 | tpr=0.9787 | fpr=0.1086 | 8238.6 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.41404 | acc=0.8925 | tpr=0.9813 | fpr=0.1091 | 8308.2 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.41570 | acc=0.8932 | tpr=0.9803 | fpr=0.1084 | 8200.0 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.41374 | acc=0.8936 | tpr=0.9817 | fpr=0.1080 | 8240.6 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.41832 | acc=0.8933 | tpr=0.9811 | fpr=0.1083 | 8225.0 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.42203 | acc=0.8927 | tpr=0.9800 | fpr=0.1089 | 8274.3 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.42388 | acc=0.8927 | tpr=0.9787 | fpr=0.1089 | 8402.7 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.42931 | acc=0.8921 | tpr=0.9776 | fpr=0.1094 | 8283.2 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.42932 | acc=0.8920 | tpr=0.9780 | fpr=0.1096 | 8110.6 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.42813 | acc=0.8923 | tpr=0.9777 | fpr=0.1093 | 15160.7 samples/s | 59.2 steps/s
Avg test loss: 0.42787, Avg test acc: 0.89216, Avg tpr: 0.97781, Avg fpr: 0.10939, total FA: 15189

server round 29/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=45.3] | Loss=0.10043 | Reg=0.00184 | L2-Norm=13.547 | L2-Norm(final)=3.345 | acc=0.9375 | 3815.1 samples/s | 59.6 steps/s
[Step=23250 Epoch=45.3] | Loss=0.02189 | Reg=0.00184 | L2-Norm=13.581 | L2-Norm(final)=3.337 | acc=1.0000 | 4491.8 samples/s | 70.2 steps/s
[Step=23300 Epoch=45.4] | Loss=0.01626 | Reg=0.00185 | L2-Norm=13.593 | L2-Norm(final)=3.342 | acc=0.9844 | 4642.2 samples/s | 72.5 steps/s
[Step=23350 Epoch=45.5] | Loss=0.01502 | Reg=0.00185 | L2-Norm=13.599 | L2-Norm(final)=3.344 | acc=1.0000 | 4709.6 samples/s | 73.6 steps/s
[Step=23400 Epoch=45.6] | Loss=0.01368 | Reg=0.00185 | L2-Norm=13.603 | L2-Norm(final)=3.347 | acc=0.9844 | 4779.6 samples/s | 74.7 steps/s
[Step=23450 Epoch=45.7] | Loss=0.01292 | Reg=0.00185 | L2-Norm=13.607 | L2-Norm(final)=3.350 | acc=0.9844 | 4694.3 samples/s | 73.3 steps/s
[Step=23500 Epoch=45.8] | Loss=0.01272 | Reg=0.00185 | L2-Norm=13.611 | L2-Norm(final)=3.352 | acc=0.9688 | 4721.3 samples/s | 73.8 steps/s
[Step=23550 Epoch=45.9] | Loss=0.01243 | Reg=0.00185 | L2-Norm=13.614 | L2-Norm(final)=3.354 | acc=1.0000 | 4777.9 samples/s | 74.7 steps/s
[Step=23600 Epoch=46.0] | Loss=0.01194 | Reg=0.00185 | L2-Norm=13.618 | L2-Norm(final)=3.357 | acc=1.0000 | 4724.2 samples/s | 73.8 steps/s
[Step=23650 Epoch=46.1] | Loss=0.01201 | Reg=0.00186 | L2-Norm=13.621 | L2-Norm(final)=3.359 | acc=1.0000 | 4764.8 samples/s | 74.4 steps/s
[Step=23700 Epoch=46.2] | Loss=0.01166 | Reg=0.00186 | L2-Norm=13.624 | L2-Norm(final)=3.361 | acc=1.0000 | 5781.9 samples/s | 90.3 steps/s
[Step=23750 Epoch=46.3] | Loss=0.01146 | Reg=0.00186 | L2-Norm=13.627 | L2-Norm(final)=3.363 | acc=0.9688 | 1941.6 samples/s | 30.3 steps/s
[Step=23800 Epoch=46.4] | Loss=0.01108 | Reg=0.00186 | L2-Norm=13.630 | L2-Norm(final)=3.365 | acc=1.0000 | 4656.3 samples/s | 72.8 steps/s
[Step=23850 Epoch=46.5] | Loss=0.01072 | Reg=0.00186 | L2-Norm=13.632 | L2-Norm(final)=3.368 | acc=0.9688 | 4766.7 samples/s | 74.5 steps/s
[Step=23900 Epoch=46.6] | Loss=0.01066 | Reg=0.00186 | L2-Norm=13.634 | L2-Norm(final)=3.370 | acc=1.0000 | 4683.0 samples/s | 73.2 steps/s
[Step=23950 Epoch=46.7] | Loss=0.01040 | Reg=0.00186 | L2-Norm=13.637 | L2-Norm(final)=3.373 | acc=0.9844 | 4720.7 samples/s | 73.8 steps/s
[Step=24000 Epoch=46.8] | Loss=0.01033 | Reg=0.00186 | L2-Norm=13.639 | L2-Norm(final)=3.375 | acc=1.0000 | 4752.4 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=45.4] | Loss=0.19121 | Reg=0.00184 | L2-Norm=13.547 | L2-Norm(final)=3.344 | acc=0.8750 | 4373.7 samples/s | 68.3 steps/s
[Step=23250 Epoch=45.5] | Loss=0.01944 | Reg=0.00184 | L2-Norm=13.576 | L2-Norm(final)=3.335 | acc=1.0000 | 4252.2 samples/s | 66.4 steps/s
[Step=23300 Epoch=45.6] | Loss=0.01500 | Reg=0.00185 | L2-Norm=13.586 | L2-Norm(final)=3.337 | acc=0.9844 | 4700.4 samples/s | 73.4 steps/s
[Step=23350 Epoch=45.6] | Loss=0.01247 | Reg=0.00185 | L2-Norm=13.591 | L2-Norm(final)=3.341 | acc=0.9844 | 4783.5 samples/s | 74.7 steps/s
[Step=23400 Epoch=45.7] | Loss=0.01185 | Reg=0.00185 | L2-Norm=13.595 | L2-Norm(final)=3.344 | acc=0.9844 | 4684.0 samples/s | 73.2 steps/s
[Step=23450 Epoch=45.8] | Loss=0.01117 | Reg=0.00185 | L2-Norm=13.598 | L2-Norm(final)=3.348 | acc=1.0000 | 4687.0 samples/s | 73.2 steps/s
[Step=23500 Epoch=45.9] | Loss=0.01115 | Reg=0.00185 | L2-Norm=13.602 | L2-Norm(final)=3.352 | acc=0.9688 | 4710.9 samples/s | 73.6 steps/s
[Step=23550 Epoch=46.0] | Loss=0.01101 | Reg=0.00185 | L2-Norm=13.605 | L2-Norm(final)=3.355 | acc=0.9844 | 4788.0 samples/s | 74.8 steps/s
[Step=23600 Epoch=46.1] | Loss=0.01082 | Reg=0.00185 | L2-Norm=13.608 | L2-Norm(final)=3.358 | acc=1.0000 | 4752.5 samples/s | 74.3 steps/s
[Step=23650 Epoch=46.2] | Loss=0.01098 | Reg=0.00185 | L2-Norm=13.611 | L2-Norm(final)=3.360 | acc=1.0000 | 4672.0 samples/s | 73.0 steps/s
[Step=23700 Epoch=46.3] | Loss=0.01108 | Reg=0.00185 | L2-Norm=13.614 | L2-Norm(final)=3.362 | acc=0.9844 | 5717.9 samples/s | 89.3 steps/s
[Step=23750 Epoch=46.4] | Loss=0.01076 | Reg=0.00185 | L2-Norm=13.617 | L2-Norm(final)=3.365 | acc=1.0000 | 1972.5 samples/s | 30.8 steps/s
[Step=23800 Epoch=46.5] | Loss=0.01047 | Reg=0.00185 | L2-Norm=13.620 | L2-Norm(final)=3.368 | acc=1.0000 | 4686.8 samples/s | 73.2 steps/s
[Step=23850 Epoch=46.6] | Loss=0.01028 | Reg=0.00186 | L2-Norm=13.622 | L2-Norm(final)=3.370 | acc=1.0000 | 4734.7 samples/s | 74.0 steps/s
[Step=23900 Epoch=46.7] | Loss=0.01011 | Reg=0.00186 | L2-Norm=13.625 | L2-Norm(final)=3.373 | acc=1.0000 | 4722.3 samples/s | 73.8 steps/s
[Step=23950 Epoch=46.8] | Loss=0.00985 | Reg=0.00186 | L2-Norm=13.628 | L2-Norm(final)=3.376 | acc=1.0000 | 4783.4 samples/s | 74.7 steps/s
[Step=24000 Epoch=46.9] | Loss=0.00973 | Reg=0.00186 | L2-Norm=13.630 | L2-Norm(final)=3.379 | acc=1.0000 | 4714.7 samples/s | 73.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step24000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=88.9] | Loss=0.00100 | Reg=0.00184 | L2-Norm=13.547 | L2-Norm(final)=3.345 | acc=1.0000 | 3927.9 samples/s | 61.4 steps/s
[Step=23250 Epoch=89.1] | Loss=0.00190 | Reg=0.00184 | L2-Norm=13.582 | L2-Norm(final)=3.348 | acc=1.0000 | 4311.1 samples/s | 67.4 steps/s
[Step=23300 Epoch=89.3] | Loss=0.00096 | Reg=0.00185 | L2-Norm=13.585 | L2-Norm(final)=3.349 | acc=1.0000 | 4376.7 samples/s | 68.4 steps/s
[Step=23350 Epoch=89.5] | Loss=0.00066 | Reg=0.00184 | L2-Norm=13.583 | L2-Norm(final)=3.351 | acc=1.0000 | 4556.4 samples/s | 71.2 steps/s
[Step=23400 Epoch=89.7] | Loss=0.00050 | Reg=0.00184 | L2-Norm=13.579 | L2-Norm(final)=3.353 | acc=1.0000 | 4400.5 samples/s | 68.8 steps/s
[Step=23450 Epoch=89.9] | Loss=0.00040 | Reg=0.00184 | L2-Norm=13.574 | L2-Norm(final)=3.354 | acc=1.0000 | 5667.4 samples/s | 88.6 steps/s
[Step=23500 Epoch=90.0] | Loss=0.00034 | Reg=0.00184 | L2-Norm=13.568 | L2-Norm(final)=3.355 | acc=1.0000 | 1909.5 samples/s | 29.8 steps/s
[Step=23550 Epoch=90.2] | Loss=0.00029 | Reg=0.00184 | L2-Norm=13.562 | L2-Norm(final)=3.356 | acc=1.0000 | 4449.7 samples/s | 69.5 steps/s
[Step=23600 Epoch=90.4] | Loss=0.00025 | Reg=0.00184 | L2-Norm=13.556 | L2-Norm(final)=3.356 | acc=1.0000 | 4369.3 samples/s | 68.3 steps/s
[Step=23650 Epoch=90.6] | Loss=0.00023 | Reg=0.00184 | L2-Norm=13.550 | L2-Norm(final)=3.357 | acc=1.0000 | 4491.4 samples/s | 70.2 steps/s
[Step=23700 Epoch=90.8] | Loss=0.00020 | Reg=0.00183 | L2-Norm=13.543 | L2-Norm(final)=3.357 | acc=1.0000 | 4974.1 samples/s | 77.7 steps/s
[Step=23750 Epoch=91.0] | Loss=0.00019 | Reg=0.00183 | L2-Norm=13.537 | L2-Norm(final)=3.358 | acc=1.0000 | 1996.7 samples/s | 31.2 steps/s
[Step=23800 Epoch=91.2] | Loss=0.00017 | Reg=0.00183 | L2-Norm=13.530 | L2-Norm(final)=3.358 | acc=1.0000 | 4489.2 samples/s | 70.1 steps/s
[Step=23850 Epoch=91.4] | Loss=0.00016 | Reg=0.00183 | L2-Norm=13.523 | L2-Norm(final)=3.359 | acc=1.0000 | 4475.1 samples/s | 69.9 steps/s
[Step=23900 Epoch=91.6] | Loss=0.00015 | Reg=0.00183 | L2-Norm=13.517 | L2-Norm(final)=3.359 | acc=1.0000 | 4409.1 samples/s | 68.9 steps/s
[Step=23950 Epoch=91.8] | Loss=0.00014 | Reg=0.00183 | L2-Norm=13.510 | L2-Norm(final)=3.360 | acc=1.0000 | 4489.2 samples/s | 70.1 steps/s
[Step=24000 Epoch=92.0] | Loss=0.00013 | Reg=0.00182 | L2-Norm=13.503 | L2-Norm(final)=3.360 | acc=1.0000 | 2079.0 samples/s | 32.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=89.3] | Loss=0.02218 | Reg=0.00184 | L2-Norm=13.547 | L2-Norm(final)=3.345 | acc=0.9688 | 3920.5 samples/s | 61.3 steps/s
[Step=23250 Epoch=89.5] | Loss=0.00260 | Reg=0.00185 | L2-Norm=13.599 | L2-Norm(final)=3.343 | acc=1.0000 | 4288.0 samples/s | 67.0 steps/s
[Step=23300 Epoch=89.7] | Loss=0.00153 | Reg=0.00185 | L2-Norm=13.613 | L2-Norm(final)=3.345 | acc=1.0000 | 4389.7 samples/s | 68.6 steps/s
[Step=23350 Epoch=89.9] | Loss=0.00109 | Reg=0.00185 | L2-Norm=13.618 | L2-Norm(final)=3.346 | acc=1.0000 | 4466.3 samples/s | 69.8 steps/s
[Step=23400 Epoch=90.1] | Loss=0.00087 | Reg=0.00185 | L2-Norm=13.620 | L2-Norm(final)=3.347 | acc=1.0000 | 4479.5 samples/s | 70.0 steps/s
[Step=23450 Epoch=90.3] | Loss=0.00070 | Reg=0.00185 | L2-Norm=13.619 | L2-Norm(final)=3.348 | acc=1.0000 | 5723.1 samples/s | 89.4 steps/s
[Step=23500 Epoch=90.5] | Loss=0.00059 | Reg=0.00185 | L2-Norm=13.617 | L2-Norm(final)=3.348 | acc=1.0000 | 1890.4 samples/s | 29.5 steps/s
[Step=23550 Epoch=90.7] | Loss=0.00050 | Reg=0.00185 | L2-Norm=13.615 | L2-Norm(final)=3.349 | acc=1.0000 | 4355.5 samples/s | 68.1 steps/s
[Step=23600 Epoch=90.8] | Loss=0.00044 | Reg=0.00185 | L2-Norm=13.611 | L2-Norm(final)=3.349 | acc=1.0000 | 4416.2 samples/s | 69.0 steps/s
[Step=23650 Epoch=91.0] | Loss=0.00039 | Reg=0.00185 | L2-Norm=13.608 | L2-Norm(final)=3.350 | acc=1.0000 | 4484.8 samples/s | 70.1 steps/s
[Step=23700 Epoch=91.2] | Loss=0.00035 | Reg=0.00185 | L2-Norm=13.604 | L2-Norm(final)=3.350 | acc=1.0000 | 5075.0 samples/s | 79.3 steps/s
[Step=23750 Epoch=91.4] | Loss=0.00032 | Reg=0.00185 | L2-Norm=13.600 | L2-Norm(final)=3.351 | acc=1.0000 | 1982.0 samples/s | 31.0 steps/s
[Step=23800 Epoch=91.6] | Loss=0.00030 | Reg=0.00185 | L2-Norm=13.596 | L2-Norm(final)=3.351 | acc=1.0000 | 4329.8 samples/s | 67.7 steps/s
[Step=23850 Epoch=91.8] | Loss=0.00027 | Reg=0.00185 | L2-Norm=13.592 | L2-Norm(final)=3.352 | acc=1.0000 | 4457.3 samples/s | 69.6 steps/s
[Step=23900 Epoch=92.0] | Loss=0.00025 | Reg=0.00185 | L2-Norm=13.588 | L2-Norm(final)=3.352 | acc=1.0000 | 4473.8 samples/s | 69.9 steps/s
[Step=23950 Epoch=92.2] | Loss=0.00024 | Reg=0.00185 | L2-Norm=13.583 | L2-Norm(final)=3.352 | acc=1.0000 | 4547.5 samples/s | 71.1 steps/s
[Step=24000 Epoch=92.4] | Loss=0.00022 | Reg=0.00184 | L2-Norm=13.579 | L2-Norm(final)=3.352 | acc=1.0000 | 2018.6 samples/s | 31.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27454 | acc=0.8610 | tpr=0.8027 | fpr=0.0124 | 4303.2 samples/s | 16.8 steps/s
Avg test loss: 0.27889, Avg test acc: 0.86013, Avg tpr: 0.80253, Avg fpr: 0.01320, total FA: 103

Testing server on iccad2012
[Step=  50] | Loss=0.37588 | acc=0.8999 | tpr=0.9513 | fpr=0.1010 | 4302.1 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.37475 | acc=0.9030 | tpr=0.9701 | fpr=0.0983 | 8409.2 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.37665 | acc=0.9023 | tpr=0.9755 | fpr=0.0990 | 8473.9 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.37915 | acc=0.9025 | tpr=0.9760 | fpr=0.0988 | 8143.1 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.37660 | acc=0.9029 | tpr=0.9773 | fpr=0.0984 | 8434.9 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.38091 | acc=0.9029 | tpr=0.9775 | fpr=0.0985 | 8095.3 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.38498 | acc=0.9023 | tpr=0.9768 | fpr=0.0991 | 8280.9 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.38735 | acc=0.9023 | tpr=0.9759 | fpr=0.0991 | 8330.1 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.39256 | acc=0.9019 | tpr=0.9747 | fpr=0.0994 | 8131.2 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.39185 | acc=0.9019 | tpr=0.9749 | fpr=0.0994 | 8182.4 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.39051 | acc=0.9022 | tpr=0.9749 | fpr=0.0991 | 14812.8 samples/s | 57.9 steps/s
Avg test loss: 0.39034, Avg test acc: 0.90212, Avg tpr: 0.97464, Avg fpr: 0.09920, total FA: 13774

server round 30/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=46.8] | Loss=0.13529 | Reg=0.00183 | L2-Norm=13.512 | L2-Norm(final)=3.390 | acc=0.9219 | 4126.5 samples/s | 64.5 steps/s
[Step=24050 Epoch=46.9] | Loss=0.02536 | Reg=0.00183 | L2-Norm=13.529 | L2-Norm(final)=3.386 | acc=1.0000 | 4283.7 samples/s | 66.9 steps/s
[Step=24100 Epoch=47.0] | Loss=0.01720 | Reg=0.00183 | L2-Norm=13.534 | L2-Norm(final)=3.387 | acc=1.0000 | 4765.3 samples/s | 74.5 steps/s
[Step=24150 Epoch=47.1] | Loss=0.01408 | Reg=0.00183 | L2-Norm=13.537 | L2-Norm(final)=3.389 | acc=0.9844 | 4678.0 samples/s | 73.1 steps/s
[Step=24200 Epoch=47.2] | Loss=0.01246 | Reg=0.00183 | L2-Norm=13.538 | L2-Norm(final)=3.391 | acc=0.9844 | 4766.7 samples/s | 74.5 steps/s
[Step=24250 Epoch=47.3] | Loss=0.01142 | Reg=0.00183 | L2-Norm=13.540 | L2-Norm(final)=3.393 | acc=0.9688 | 4770.8 samples/s | 74.5 steps/s
[Step=24300 Epoch=47.4] | Loss=0.01092 | Reg=0.00183 | L2-Norm=13.542 | L2-Norm(final)=3.395 | acc=1.0000 | 4735.6 samples/s | 74.0 steps/s
[Step=24350 Epoch=47.5] | Loss=0.01049 | Reg=0.00183 | L2-Norm=13.543 | L2-Norm(final)=3.398 | acc=0.9844 | 4621.5 samples/s | 72.2 steps/s
[Step=24400 Epoch=47.6] | Loss=0.01002 | Reg=0.00183 | L2-Norm=13.545 | L2-Norm(final)=3.400 | acc=1.0000 | 4692.3 samples/s | 73.3 steps/s
[Step=24450 Epoch=47.7] | Loss=0.00979 | Reg=0.00183 | L2-Norm=13.546 | L2-Norm(final)=3.401 | acc=1.0000 | 4779.5 samples/s | 74.7 steps/s
[Step=24500 Epoch=47.8] | Loss=0.00969 | Reg=0.00184 | L2-Norm=13.547 | L2-Norm(final)=3.403 | acc=1.0000 | 5742.7 samples/s | 89.7 steps/s
[Step=24550 Epoch=47.9] | Loss=0.00947 | Reg=0.00184 | L2-Norm=13.548 | L2-Norm(final)=3.405 | acc=1.0000 | 1894.2 samples/s | 29.6 steps/s
[Step=24600 Epoch=48.0] | Loss=0.00915 | Reg=0.00184 | L2-Norm=13.549 | L2-Norm(final)=3.407 | acc=0.9844 | 4603.4 samples/s | 71.9 steps/s
[Step=24650 Epoch=48.1] | Loss=0.00882 | Reg=0.00184 | L2-Norm=13.550 | L2-Norm(final)=3.409 | acc=1.0000 | 4669.0 samples/s | 73.0 steps/s
[Step=24700 Epoch=48.2] | Loss=0.00856 | Reg=0.00184 | L2-Norm=13.551 | L2-Norm(final)=3.411 | acc=1.0000 | 4709.0 samples/s | 73.6 steps/s
[Step=24750 Epoch=48.3] | Loss=0.00847 | Reg=0.00184 | L2-Norm=13.552 | L2-Norm(final)=3.413 | acc=1.0000 | 4720.3 samples/s | 73.8 steps/s
[Step=24800 Epoch=48.4] | Loss=0.00831 | Reg=0.00184 | L2-Norm=13.553 | L2-Norm(final)=3.415 | acc=1.0000 | 4753.0 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=46.9] | Loss=0.13674 | Reg=0.00183 | L2-Norm=13.512 | L2-Norm(final)=3.390 | acc=0.9219 | 4431.3 samples/s | 69.2 steps/s
[Step=24050 Epoch=47.0] | Loss=0.02575 | Reg=0.00183 | L2-Norm=13.527 | L2-Norm(final)=3.386 | acc=0.9844 | 4196.7 samples/s | 65.6 steps/s
[Step=24100 Epoch=47.1] | Loss=0.01847 | Reg=0.00183 | L2-Norm=13.531 | L2-Norm(final)=3.387 | acc=1.0000 | 4704.0 samples/s | 73.5 steps/s
[Step=24150 Epoch=47.2] | Loss=0.01495 | Reg=0.00183 | L2-Norm=13.534 | L2-Norm(final)=3.389 | acc=0.9844 | 4774.7 samples/s | 74.6 steps/s
[Step=24200 Epoch=47.3] | Loss=0.01362 | Reg=0.00183 | L2-Norm=13.536 | L2-Norm(final)=3.391 | acc=1.0000 | 4652.8 samples/s | 72.7 steps/s
[Step=24250 Epoch=47.4] | Loss=0.01218 | Reg=0.00183 | L2-Norm=13.537 | L2-Norm(final)=3.393 | acc=1.0000 | 4792.3 samples/s | 74.9 steps/s
[Step=24300 Epoch=47.5] | Loss=0.01114 | Reg=0.00183 | L2-Norm=13.539 | L2-Norm(final)=3.395 | acc=1.0000 | 4753.0 samples/s | 74.3 steps/s
[Step=24350 Epoch=47.6] | Loss=0.01051 | Reg=0.00183 | L2-Norm=13.540 | L2-Norm(final)=3.397 | acc=1.0000 | 4728.4 samples/s | 73.9 steps/s
[Step=24400 Epoch=47.7] | Loss=0.01002 | Reg=0.00183 | L2-Norm=13.541 | L2-Norm(final)=3.399 | acc=1.0000 | 4685.4 samples/s | 73.2 steps/s
[Step=24450 Epoch=47.8] | Loss=0.00967 | Reg=0.00183 | L2-Norm=13.542 | L2-Norm(final)=3.401 | acc=1.0000 | 4686.7 samples/s | 73.2 steps/s
[Step=24500 Epoch=47.9] | Loss=0.00925 | Reg=0.00183 | L2-Norm=13.543 | L2-Norm(final)=3.403 | acc=1.0000 | 5793.7 samples/s | 90.5 steps/s
[Step=24550 Epoch=48.0] | Loss=0.00887 | Reg=0.00183 | L2-Norm=13.544 | L2-Norm(final)=3.405 | acc=1.0000 | 1979.9 samples/s | 30.9 steps/s
[Step=24600 Epoch=48.1] | Loss=0.00868 | Reg=0.00183 | L2-Norm=13.545 | L2-Norm(final)=3.407 | acc=1.0000 | 4703.0 samples/s | 73.5 steps/s
[Step=24650 Epoch=48.2] | Loss=0.00847 | Reg=0.00184 | L2-Norm=13.546 | L2-Norm(final)=3.409 | acc=0.9844 | 4751.2 samples/s | 74.2 steps/s
[Step=24700 Epoch=48.3] | Loss=0.00827 | Reg=0.00184 | L2-Norm=13.547 | L2-Norm(final)=3.411 | acc=0.9844 | 4663.9 samples/s | 72.9 steps/s
[Step=24750 Epoch=48.4] | Loss=0.00804 | Reg=0.00184 | L2-Norm=13.548 | L2-Norm(final)=3.413 | acc=0.9688 | 4575.5 samples/s | 71.5 steps/s
[Step=24800 Epoch=48.5] | Loss=0.00789 | Reg=0.00184 | L2-Norm=13.549 | L2-Norm(final)=3.415 | acc=1.0000 | 4690.7 samples/s | 73.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step24800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=92.0] | Loss=0.00155 | Reg=0.00183 | L2-Norm=13.512 | L2-Norm(final)=3.390 | acc=1.0000 | 3619.2 samples/s | 56.5 steps/s
[Step=24050 Epoch=92.2] | Loss=0.00211 | Reg=0.00183 | L2-Norm=13.529 | L2-Norm(final)=3.397 | acc=1.0000 | 4641.5 samples/s | 72.5 steps/s
[Step=24100 Epoch=92.3] | Loss=0.00118 | Reg=0.00183 | L2-Norm=13.530 | L2-Norm(final)=3.398 | acc=1.0000 | 4492.5 samples/s | 70.2 steps/s
[Step=24150 Epoch=92.5] | Loss=0.00080 | Reg=0.00183 | L2-Norm=13.529 | L2-Norm(final)=3.399 | acc=1.0000 | 4460.8 samples/s | 69.7 steps/s
[Step=24200 Epoch=92.7] | Loss=0.00061 | Reg=0.00183 | L2-Norm=13.527 | L2-Norm(final)=3.400 | acc=1.0000 | 4489.1 samples/s | 70.1 steps/s
[Step=24250 Epoch=92.9] | Loss=0.00049 | Reg=0.00183 | L2-Norm=13.525 | L2-Norm(final)=3.401 | acc=1.0000 | 5663.5 samples/s | 88.5 steps/s
[Step=24300 Epoch=93.1] | Loss=0.00041 | Reg=0.00183 | L2-Norm=13.523 | L2-Norm(final)=3.402 | acc=1.0000 | 1922.0 samples/s | 30.0 steps/s
[Step=24350 Epoch=93.3] | Loss=0.00036 | Reg=0.00183 | L2-Norm=13.520 | L2-Norm(final)=3.402 | acc=1.0000 | 4492.3 samples/s | 70.2 steps/s
[Step=24400 Epoch=93.5] | Loss=0.00031 | Reg=0.00183 | L2-Norm=13.517 | L2-Norm(final)=3.403 | acc=1.0000 | 4412.1 samples/s | 68.9 steps/s
[Step=24450 Epoch=93.7] | Loss=0.00028 | Reg=0.00183 | L2-Norm=13.514 | L2-Norm(final)=3.404 | acc=1.0000 | 4484.0 samples/s | 70.1 steps/s
[Step=24500 Epoch=93.9] | Loss=0.00025 | Reg=0.00183 | L2-Norm=13.511 | L2-Norm(final)=3.404 | acc=1.0000 | 4952.4 samples/s | 77.4 steps/s
[Step=24550 Epoch=94.1] | Loss=0.00023 | Reg=0.00182 | L2-Norm=13.507 | L2-Norm(final)=3.405 | acc=1.0000 | 1995.4 samples/s | 31.2 steps/s
[Step=24600 Epoch=94.3] | Loss=0.00021 | Reg=0.00182 | L2-Norm=13.504 | L2-Norm(final)=3.406 | acc=1.0000 | 4512.2 samples/s | 70.5 steps/s
[Step=24650 Epoch=94.5] | Loss=0.00019 | Reg=0.00182 | L2-Norm=13.501 | L2-Norm(final)=3.406 | acc=1.0000 | 4474.0 samples/s | 69.9 steps/s
[Step=24700 Epoch=94.6] | Loss=0.00018 | Reg=0.00182 | L2-Norm=13.497 | L2-Norm(final)=3.406 | acc=1.0000 | 4505.2 samples/s | 70.4 steps/s
[Step=24750 Epoch=94.8] | Loss=0.00017 | Reg=0.00182 | L2-Norm=13.494 | L2-Norm(final)=3.407 | acc=1.0000 | 4521.3 samples/s | 70.6 steps/s
[Step=24800 Epoch=95.0] | Loss=0.00016 | Reg=0.00182 | L2-Norm=13.490 | L2-Norm(final)=3.407 | acc=1.0000 | 2078.9 samples/s | 32.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=92.4] | Loss=0.03593 | Reg=0.00183 | L2-Norm=13.512 | L2-Norm(final)=3.390 | acc=0.9844 | 3985.0 samples/s | 62.3 steps/s
[Step=24050 Epoch=92.6] | Loss=0.00320 | Reg=0.00183 | L2-Norm=13.523 | L2-Norm(final)=3.386 | acc=1.0000 | 4350.2 samples/s | 68.0 steps/s
[Step=24100 Epoch=92.8] | Loss=0.00163 | Reg=0.00183 | L2-Norm=13.524 | L2-Norm(final)=3.385 | acc=1.0000 | 4356.7 samples/s | 68.1 steps/s
[Step=24150 Epoch=93.0] | Loss=0.00111 | Reg=0.00183 | L2-Norm=13.524 | L2-Norm(final)=3.386 | acc=1.0000 | 4424.2 samples/s | 69.1 steps/s
[Step=24200 Epoch=93.2] | Loss=0.00086 | Reg=0.00183 | L2-Norm=13.523 | L2-Norm(final)=3.387 | acc=1.0000 | 4493.3 samples/s | 70.2 steps/s
[Step=24250 Epoch=93.3] | Loss=0.00069 | Reg=0.00183 | L2-Norm=13.522 | L2-Norm(final)=3.388 | acc=1.0000 | 5513.6 samples/s | 86.1 steps/s
[Step=24300 Epoch=93.5] | Loss=0.00058 | Reg=0.00183 | L2-Norm=13.520 | L2-Norm(final)=3.388 | acc=1.0000 | 1820.3 samples/s | 28.4 steps/s
[Step=24350 Epoch=93.7] | Loss=0.00050 | Reg=0.00183 | L2-Norm=13.519 | L2-Norm(final)=3.389 | acc=1.0000 | 4250.8 samples/s | 66.4 steps/s
[Step=24400 Epoch=93.9] | Loss=0.00044 | Reg=0.00183 | L2-Norm=13.517 | L2-Norm(final)=3.389 | acc=1.0000 | 4246.8 samples/s | 66.4 steps/s
[Step=24450 Epoch=94.1] | Loss=0.00039 | Reg=0.00183 | L2-Norm=13.515 | L2-Norm(final)=3.390 | acc=1.0000 | 4284.7 samples/s | 66.9 steps/s
[Step=24500 Epoch=94.3] | Loss=0.00035 | Reg=0.00183 | L2-Norm=13.513 | L2-Norm(final)=3.390 | acc=1.0000 | 4664.5 samples/s | 72.9 steps/s
[Step=24550 Epoch=94.5] | Loss=0.00032 | Reg=0.00183 | L2-Norm=13.510 | L2-Norm(final)=3.391 | acc=1.0000 | 1909.3 samples/s | 29.8 steps/s
[Step=24600 Epoch=94.7] | Loss=0.00030 | Reg=0.00182 | L2-Norm=13.508 | L2-Norm(final)=3.391 | acc=1.0000 | 3771.7 samples/s | 58.9 steps/s
[Step=24650 Epoch=94.9] | Loss=0.00027 | Reg=0.00182 | L2-Norm=13.506 | L2-Norm(final)=3.392 | acc=1.0000 | 3812.6 samples/s | 59.6 steps/s
[Step=24700 Epoch=95.1] | Loss=0.00025 | Reg=0.00182 | L2-Norm=13.503 | L2-Norm(final)=3.392 | acc=1.0000 | 3816.7 samples/s | 59.6 steps/s
[Step=24750 Epoch=95.3] | Loss=0.00024 | Reg=0.00182 | L2-Norm=13.501 | L2-Norm(final)=3.393 | acc=1.0000 | 3783.3 samples/s | 59.1 steps/s
[Step=24800 Epoch=95.5] | Loss=0.00022 | Reg=0.00182 | L2-Norm=13.498 | L2-Norm(final)=3.393 | acc=1.0000 | 1855.1 samples/s | 29.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23401 | acc=0.8805 | tpr=0.8312 | fpr=0.0124 | 3805.1 samples/s | 14.9 steps/s
Avg test loss: 0.24005, Avg test acc: 0.87984, Avg tpr: 0.83103, Avg fpr: 0.01282, total FA: 100

Testing server on iccad2012
[Step=  50] | Loss=0.43518 | acc=0.8834 | tpr=0.9513 | fpr=0.1179 | 3810.3 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.43287 | acc=0.8859 | tpr=0.9680 | fpr=0.1157 | 6898.7 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.43615 | acc=0.8854 | tpr=0.9741 | fpr=0.1163 | 7241.4 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.43795 | acc=0.8856 | tpr=0.9749 | fpr=0.1161 | 7297.8 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.43597 | acc=0.8860 | tpr=0.9773 | fpr=0.1157 | 7579.0 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.44055 | acc=0.8861 | tpr=0.9775 | fpr=0.1156 | 6982.5 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.44475 | acc=0.8857 | tpr=0.9768 | fpr=0.1159 | 7505.9 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.44681 | acc=0.8857 | tpr=0.9754 | fpr=0.1160 | 7493.0 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.45215 | acc=0.8853 | tpr=0.9747 | fpr=0.1163 | 8639.0 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.45177 | acc=0.8852 | tpr=0.9753 | fpr=0.1164 | 6734.1 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.45035 | acc=0.8854 | tpr=0.9749 | fpr=0.1162 | 13354.2 samples/s | 52.2 steps/s
Avg test loss: 0.45009, Avg test acc: 0.88538, Avg tpr: 0.97464, Avg fpr: 0.11624, total FA: 16140

server round 31/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=48.4] | Loss=0.10047 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=3.425 | acc=0.9219 | 4045.2 samples/s | 63.2 steps/s
[Step=24850 Epoch=48.5] | Loss=0.01724 | Reg=0.00182 | L2-Norm=13.500 | L2-Norm(final)=3.423 | acc=1.0000 | 4323.4 samples/s | 67.6 steps/s
[Step=24900 Epoch=48.6] | Loss=0.01427 | Reg=0.00182 | L2-Norm=13.505 | L2-Norm(final)=3.424 | acc=1.0000 | 4667.5 samples/s | 72.9 steps/s
[Step=24950 Epoch=48.7] | Loss=0.01138 | Reg=0.00182 | L2-Norm=13.507 | L2-Norm(final)=3.426 | acc=1.0000 | 4595.0 samples/s | 71.8 steps/s
[Step=25000 Epoch=48.8] | Loss=0.01053 | Reg=0.00183 | L2-Norm=13.509 | L2-Norm(final)=3.428 | acc=0.9844 | 4694.7 samples/s | 73.4 steps/s
[Step=25050 Epoch=48.9] | Loss=0.01014 | Reg=0.00183 | L2-Norm=13.511 | L2-Norm(final)=3.430 | acc=0.9844 | 4620.5 samples/s | 72.2 steps/s
[Step=25100 Epoch=49.0] | Loss=0.00982 | Reg=0.00183 | L2-Norm=13.513 | L2-Norm(final)=3.431 | acc=1.0000 | 4416.1 samples/s | 69.0 steps/s
[Step=25150 Epoch=49.1] | Loss=0.00966 | Reg=0.00183 | L2-Norm=13.514 | L2-Norm(final)=3.432 | acc=1.0000 | 4539.5 samples/s | 70.9 steps/s
[Step=25200 Epoch=49.1] | Loss=0.00920 | Reg=0.00183 | L2-Norm=13.515 | L2-Norm(final)=3.434 | acc=1.0000 | 4296.8 samples/s | 67.1 steps/s
[Step=25250 Epoch=49.2] | Loss=0.00859 | Reg=0.00183 | L2-Norm=13.517 | L2-Norm(final)=3.436 | acc=1.0000 | 4226.4 samples/s | 66.0 steps/s
[Step=25300 Epoch=49.3] | Loss=0.00848 | Reg=0.00183 | L2-Norm=13.518 | L2-Norm(final)=3.438 | acc=1.0000 | 5295.8 samples/s | 82.7 steps/s
[Step=25350 Epoch=49.4] | Loss=0.00841 | Reg=0.00183 | L2-Norm=13.519 | L2-Norm(final)=3.440 | acc=0.9844 | 1910.7 samples/s | 29.9 steps/s
[Step=25400 Epoch=49.5] | Loss=0.00826 | Reg=0.00183 | L2-Norm=13.521 | L2-Norm(final)=3.442 | acc=1.0000 | 4619.6 samples/s | 72.2 steps/s
[Step=25450 Epoch=49.6] | Loss=0.00808 | Reg=0.00183 | L2-Norm=13.522 | L2-Norm(final)=3.444 | acc=1.0000 | 4675.1 samples/s | 73.0 steps/s
[Step=25500 Epoch=49.7] | Loss=0.00791 | Reg=0.00183 | L2-Norm=13.523 | L2-Norm(final)=3.445 | acc=1.0000 | 4571.5 samples/s | 71.4 steps/s
[Step=25550 Epoch=49.8] | Loss=0.00778 | Reg=0.00183 | L2-Norm=13.524 | L2-Norm(final)=3.447 | acc=1.0000 | 4429.1 samples/s | 69.2 steps/s
[Step=25600 Epoch=49.9] | Loss=0.00770 | Reg=0.00183 | L2-Norm=13.525 | L2-Norm(final)=3.449 | acc=0.9844 | 4538.4 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step25600.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=48.5] | Loss=0.10828 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=3.425 | acc=0.9219 | 3963.9 samples/s | 61.9 steps/s
[Step=24850 Epoch=48.6] | Loss=0.01817 | Reg=0.00182 | L2-Norm=13.501 | L2-Norm(final)=3.424 | acc=1.0000 | 4086.9 samples/s | 63.9 steps/s
[Step=24900 Epoch=48.7] | Loss=0.01402 | Reg=0.00182 | L2-Norm=13.505 | L2-Norm(final)=3.426 | acc=1.0000 | 4599.5 samples/s | 71.9 steps/s
[Step=24950 Epoch=48.8] | Loss=0.01201 | Reg=0.00182 | L2-Norm=13.507 | L2-Norm(final)=3.427 | acc=0.9844 | 4603.3 samples/s | 71.9 steps/s
[Step=25000 Epoch=48.9] | Loss=0.01077 | Reg=0.00182 | L2-Norm=13.509 | L2-Norm(final)=3.429 | acc=1.0000 | 4609.5 samples/s | 72.0 steps/s
[Step=25050 Epoch=49.0] | Loss=0.00959 | Reg=0.00183 | L2-Norm=13.510 | L2-Norm(final)=3.431 | acc=1.0000 | 4669.7 samples/s | 73.0 steps/s
[Step=25100 Epoch=49.1] | Loss=0.00949 | Reg=0.00183 | L2-Norm=13.511 | L2-Norm(final)=3.433 | acc=0.9844 | 4647.9 samples/s | 72.6 steps/s
[Step=25150 Epoch=49.2] | Loss=0.00921 | Reg=0.00183 | L2-Norm=13.513 | L2-Norm(final)=3.435 | acc=0.9844 | 4695.8 samples/s | 73.4 steps/s
[Step=25200 Epoch=49.3] | Loss=0.00890 | Reg=0.00183 | L2-Norm=13.514 | L2-Norm(final)=3.436 | acc=0.9844 | 4412.4 samples/s | 68.9 steps/s
[Step=25250 Epoch=49.4] | Loss=0.00893 | Reg=0.00183 | L2-Norm=13.515 | L2-Norm(final)=3.438 | acc=0.9844 | 4471.2 samples/s | 69.9 steps/s
[Step=25300 Epoch=49.5] | Loss=0.00875 | Reg=0.00183 | L2-Norm=13.516 | L2-Norm(final)=3.439 | acc=1.0000 | 5387.3 samples/s | 84.2 steps/s
[Step=25350 Epoch=49.6] | Loss=0.00827 | Reg=0.00183 | L2-Norm=13.517 | L2-Norm(final)=3.441 | acc=1.0000 | 1852.9 samples/s | 29.0 steps/s
[Step=25400 Epoch=49.7] | Loss=0.00794 | Reg=0.00183 | L2-Norm=13.518 | L2-Norm(final)=3.442 | acc=1.0000 | 4604.6 samples/s | 71.9 steps/s
[Step=25450 Epoch=49.8] | Loss=0.00775 | Reg=0.00183 | L2-Norm=13.519 | L2-Norm(final)=3.444 | acc=1.0000 | 4646.0 samples/s | 72.6 steps/s
[Step=25500 Epoch=49.9] | Loss=0.00759 | Reg=0.00183 | L2-Norm=13.520 | L2-Norm(final)=3.446 | acc=1.0000 | 4644.2 samples/s | 72.6 steps/s
[Step=25550 Epoch=49.9] | Loss=0.00740 | Reg=0.00183 | L2-Norm=13.521 | L2-Norm(final)=3.448 | acc=1.0000 | 4713.8 samples/s | 73.7 steps/s
[Step=25600 Epoch=50.0] | Loss=0.00731 | Reg=0.00183 | L2-Norm=13.522 | L2-Norm(final)=3.449 | acc=1.0000 | 4674.2 samples/s | 73.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step25600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=95.0] | Loss=0.02829 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=3.425 | acc=0.9844 | 3642.1 samples/s | 56.9 steps/s
[Step=24850 Epoch=95.2] | Loss=0.00451 | Reg=0.00182 | L2-Norm=13.508 | L2-Norm(final)=3.422 | acc=1.0000 | 3997.7 samples/s | 62.5 steps/s
[Step=24900 Epoch=95.4] | Loss=0.00231 | Reg=0.00183 | L2-Norm=13.511 | L2-Norm(final)=3.421 | acc=1.0000 | 4040.9 samples/s | 63.1 steps/s
[Step=24950 Epoch=95.6] | Loss=0.00155 | Reg=0.00183 | L2-Norm=13.511 | L2-Norm(final)=3.421 | acc=1.0000 | 4202.8 samples/s | 65.7 steps/s
[Step=25000 Epoch=95.8] | Loss=0.00121 | Reg=0.00183 | L2-Norm=13.510 | L2-Norm(final)=3.421 | acc=1.0000 | 4434.9 samples/s | 69.3 steps/s
[Step=25050 Epoch=96.0] | Loss=0.00097 | Reg=0.00182 | L2-Norm=13.508 | L2-Norm(final)=3.422 | acc=1.0000 | 5493.8 samples/s | 85.8 steps/s
[Step=25100 Epoch=96.2] | Loss=0.00081 | Reg=0.00182 | L2-Norm=13.506 | L2-Norm(final)=3.422 | acc=1.0000 | 1861.3 samples/s | 29.1 steps/s
[Step=25150 Epoch=96.4] | Loss=0.00070 | Reg=0.00182 | L2-Norm=13.504 | L2-Norm(final)=3.423 | acc=1.0000 | 4311.4 samples/s | 67.4 steps/s
[Step=25200 Epoch=96.6] | Loss=0.00061 | Reg=0.00182 | L2-Norm=13.502 | L2-Norm(final)=3.423 | acc=1.0000 | 4321.8 samples/s | 67.5 steps/s
[Step=25250 Epoch=96.7] | Loss=0.00055 | Reg=0.00182 | L2-Norm=13.500 | L2-Norm(final)=3.423 | acc=1.0000 | 3935.9 samples/s | 61.5 steps/s
[Step=25300 Epoch=96.9] | Loss=0.00049 | Reg=0.00182 | L2-Norm=13.497 | L2-Norm(final)=3.424 | acc=1.0000 | 4349.7 samples/s | 68.0 steps/s
[Step=25350 Epoch=97.1] | Loss=0.00045 | Reg=0.00182 | L2-Norm=13.495 | L2-Norm(final)=3.424 | acc=1.0000 | 1836.5 samples/s | 28.7 steps/s
[Step=25400 Epoch=97.3] | Loss=0.00041 | Reg=0.00182 | L2-Norm=13.492 | L2-Norm(final)=3.424 | acc=1.0000 | 4074.6 samples/s | 63.7 steps/s
[Step=25450 Epoch=97.5] | Loss=0.00038 | Reg=0.00182 | L2-Norm=13.489 | L2-Norm(final)=3.425 | acc=1.0000 | 4375.6 samples/s | 68.4 steps/s
[Step=25500 Epoch=97.7] | Loss=0.00035 | Reg=0.00182 | L2-Norm=13.487 | L2-Norm(final)=3.425 | acc=1.0000 | 4418.2 samples/s | 69.0 steps/s
[Step=25550 Epoch=97.9] | Loss=0.00033 | Reg=0.00182 | L2-Norm=13.484 | L2-Norm(final)=3.425 | acc=1.0000 | 4385.8 samples/s | 68.5 steps/s
[Step=25600 Epoch=98.1] | Loss=0.00031 | Reg=0.00182 | L2-Norm=13.481 | L2-Norm(final)=3.426 | acc=1.0000 | 1993.1 samples/s | 31.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step25600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=95.5] | Loss=0.08532 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=3.424 | acc=0.9844 | 3880.8 samples/s | 60.6 steps/s
[Step=24850 Epoch=95.7] | Loss=0.00350 | Reg=0.00183 | L2-Norm=13.513 | L2-Norm(final)=3.428 | acc=1.0000 | 3719.9 samples/s | 58.1 steps/s
[Step=24900 Epoch=95.8] | Loss=0.00176 | Reg=0.00183 | L2-Norm=13.517 | L2-Norm(final)=3.428 | acc=1.0000 | 4360.4 samples/s | 68.1 steps/s
[Step=24950 Epoch=96.0] | Loss=0.00121 | Reg=0.00183 | L2-Norm=13.517 | L2-Norm(final)=3.428 | acc=1.0000 | 4532.8 samples/s | 70.8 steps/s
[Step=25000 Epoch=96.2] | Loss=0.00101 | Reg=0.00183 | L2-Norm=13.516 | L2-Norm(final)=3.429 | acc=1.0000 | 4332.7 samples/s | 67.7 steps/s
[Step=25050 Epoch=96.4] | Loss=0.00082 | Reg=0.00183 | L2-Norm=13.516 | L2-Norm(final)=3.429 | acc=1.0000 | 5512.5 samples/s | 86.1 steps/s
[Step=25100 Epoch=96.6] | Loss=0.00068 | Reg=0.00183 | L2-Norm=13.515 | L2-Norm(final)=3.430 | acc=1.0000 | 1867.6 samples/s | 29.2 steps/s
[Step=25150 Epoch=96.8] | Loss=0.00058 | Reg=0.00183 | L2-Norm=13.514 | L2-Norm(final)=3.430 | acc=1.0000 | 4294.7 samples/s | 67.1 steps/s
[Step=25200 Epoch=97.0] | Loss=0.00051 | Reg=0.00183 | L2-Norm=13.512 | L2-Norm(final)=3.431 | acc=1.0000 | 4222.7 samples/s | 66.0 steps/s
[Step=25250 Epoch=97.2] | Loss=0.00046 | Reg=0.00183 | L2-Norm=13.510 | L2-Norm(final)=3.431 | acc=1.0000 | 3970.9 samples/s | 62.0 steps/s
[Step=25300 Epoch=97.4] | Loss=0.00041 | Reg=0.00182 | L2-Norm=13.508 | L2-Norm(final)=3.431 | acc=1.0000 | 4976.1 samples/s | 77.8 steps/s
[Step=25350 Epoch=97.6] | Loss=0.00037 | Reg=0.00182 | L2-Norm=13.506 | L2-Norm(final)=3.432 | acc=1.0000 | 1959.2 samples/s | 30.6 steps/s
[Step=25400 Epoch=97.8] | Loss=0.00034 | Reg=0.00182 | L2-Norm=13.504 | L2-Norm(final)=3.432 | acc=1.0000 | 4462.7 samples/s | 69.7 steps/s
[Step=25450 Epoch=98.0] | Loss=0.00032 | Reg=0.00182 | L2-Norm=13.502 | L2-Norm(final)=3.432 | acc=1.0000 | 4426.9 samples/s | 69.2 steps/s
[Step=25500 Epoch=98.2] | Loss=0.00030 | Reg=0.00182 | L2-Norm=13.500 | L2-Norm(final)=3.432 | acc=1.0000 | 4385.5 samples/s | 68.5 steps/s
[Step=25550 Epoch=98.4] | Loss=0.00028 | Reg=0.00182 | L2-Norm=13.498 | L2-Norm(final)=3.433 | acc=1.0000 | 4255.2 samples/s | 66.5 steps/s
[Step=25600 Epoch=98.5] | Loss=0.00026 | Reg=0.00182 | L2-Norm=13.496 | L2-Norm(final)=3.433 | acc=1.0000 | 1939.7 samples/s | 30.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26274 | acc=0.8700 | tpr=0.8161 | fpr=0.0129 | 4182.0 samples/s | 16.3 steps/s
Avg test loss: 0.26794, Avg test acc: 0.86978, Avg tpr: 0.81623, Avg fpr: 0.01243, total FA: 97

Testing server on iccad2012
[Step=  50] | Loss=0.37588 | acc=0.9043 | tpr=0.9513 | fpr=0.0965 | 3823.2 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.37600 | acc=0.9057 | tpr=0.9680 | fpr=0.0954 | 8007.1 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.37939 | acc=0.9047 | tpr=0.9741 | fpr=0.0966 | 7874.6 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.38132 | acc=0.9049 | tpr=0.9749 | fpr=0.0964 | 7357.1 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.37942 | acc=0.9050 | tpr=0.9773 | fpr=0.0963 | 7813.6 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.38405 | acc=0.9049 | tpr=0.9775 | fpr=0.0964 | 7916.5 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.38792 | acc=0.9045 | tpr=0.9768 | fpr=0.0968 | 7897.4 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.39003 | acc=0.9045 | tpr=0.9759 | fpr=0.0968 | 7714.4 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.39553 | acc=0.9041 | tpr=0.9737 | fpr=0.0972 | 7192.2 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.39536 | acc=0.9039 | tpr=0.9744 | fpr=0.0973 | 8065.4 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.39416 | acc=0.9042 | tpr=0.9741 | fpr=0.0971 | 14662.9 samples/s | 57.3 steps/s
Avg test loss: 0.39384, Avg test acc: 0.90417, Avg tpr: 0.97385, Avg fpr: 0.09709, total FA: 13481

server round 32/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=49.9] | Loss=0.22278 | Reg=0.00181 | L2-Norm=13.470 | L2-Norm(final)=3.454 | acc=0.9062 | 3869.4 samples/s | 60.5 steps/s
[Step=25650 Epoch=50.0] | Loss=0.02346 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=3.448 | acc=1.0000 | 4106.8 samples/s | 64.2 steps/s
[Step=25700 Epoch=50.1] | Loss=0.01590 | Reg=0.00182 | L2-Norm=13.491 | L2-Norm(final)=3.449 | acc=1.0000 | 4347.1 samples/s | 67.9 steps/s
[Step=25750 Epoch=50.2] | Loss=0.01340 | Reg=0.00182 | L2-Norm=13.493 | L2-Norm(final)=3.450 | acc=0.9844 | 4239.8 samples/s | 66.2 steps/s
[Step=25800 Epoch=50.3] | Loss=0.01176 | Reg=0.00182 | L2-Norm=13.495 | L2-Norm(final)=3.451 | acc=0.9844 | 4550.3 samples/s | 71.1 steps/s
[Step=25850 Epoch=50.4] | Loss=0.01088 | Reg=0.00182 | L2-Norm=13.496 | L2-Norm(final)=3.453 | acc=1.0000 | 4660.1 samples/s | 72.8 steps/s
[Step=25900 Epoch=50.5] | Loss=0.01014 | Reg=0.00182 | L2-Norm=13.497 | L2-Norm(final)=3.455 | acc=1.0000 | 4640.4 samples/s | 72.5 steps/s
[Step=25950 Epoch=50.6] | Loss=0.00997 | Reg=0.00182 | L2-Norm=13.499 | L2-Norm(final)=3.457 | acc=0.9844 | 4592.3 samples/s | 71.8 steps/s
[Step=26000 Epoch=50.7] | Loss=0.00961 | Reg=0.00182 | L2-Norm=13.500 | L2-Norm(final)=3.458 | acc=1.0000 | 4538.0 samples/s | 70.9 steps/s
[Step=26050 Epoch=50.8] | Loss=0.00927 | Reg=0.00182 | L2-Norm=13.501 | L2-Norm(final)=3.460 | acc=0.9844 | 4604.2 samples/s | 71.9 steps/s
[Step=26100 Epoch=50.9] | Loss=0.00915 | Reg=0.00182 | L2-Norm=13.502 | L2-Norm(final)=3.462 | acc=0.9844 | 5576.2 samples/s | 87.1 steps/s
[Step=26150 Epoch=51.0] | Loss=0.00866 | Reg=0.00182 | L2-Norm=13.503 | L2-Norm(final)=3.464 | acc=1.0000 | 1764.3 samples/s | 27.6 steps/s
[Step=26200 Epoch=51.1] | Loss=0.00836 | Reg=0.00182 | L2-Norm=13.504 | L2-Norm(final)=3.466 | acc=1.0000 | 4580.0 samples/s | 71.6 steps/s
[Step=26250 Epoch=51.2] | Loss=0.00827 | Reg=0.00182 | L2-Norm=13.506 | L2-Norm(final)=3.468 | acc=1.0000 | 4542.2 samples/s | 71.0 steps/s
[Step=26300 Epoch=51.3] | Loss=0.00811 | Reg=0.00182 | L2-Norm=13.507 | L2-Norm(final)=3.470 | acc=0.9844 | 4383.1 samples/s | 68.5 steps/s
[Step=26350 Epoch=51.4] | Loss=0.00802 | Reg=0.00182 | L2-Norm=13.508 | L2-Norm(final)=3.472 | acc=0.9844 | 4521.2 samples/s | 70.6 steps/s
[Step=26400 Epoch=51.5] | Loss=0.00784 | Reg=0.00182 | L2-Norm=13.509 | L2-Norm(final)=3.474 | acc=1.0000 | 4729.9 samples/s | 73.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step26400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=50.0] | Loss=0.10932 | Reg=0.00181 | L2-Norm=13.470 | L2-Norm(final)=3.454 | acc=0.9062 | 4005.2 samples/s | 62.6 steps/s
[Step=25650 Epoch=50.1] | Loss=0.01902 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=3.451 | acc=0.9844 | 4233.4 samples/s | 66.1 steps/s
[Step=25700 Epoch=50.2] | Loss=0.01347 | Reg=0.00182 | L2-Norm=13.490 | L2-Norm(final)=3.453 | acc=0.9844 | 4203.1 samples/s | 65.7 steps/s
[Step=25750 Epoch=50.3] | Loss=0.01204 | Reg=0.00182 | L2-Norm=13.493 | L2-Norm(final)=3.455 | acc=1.0000 | 4152.9 samples/s | 64.9 steps/s
[Step=25800 Epoch=50.4] | Loss=0.01090 | Reg=0.00182 | L2-Norm=13.494 | L2-Norm(final)=3.457 | acc=1.0000 | 4543.3 samples/s | 71.0 steps/s
[Step=25850 Epoch=50.5] | Loss=0.00976 | Reg=0.00182 | L2-Norm=13.496 | L2-Norm(final)=3.459 | acc=1.0000 | 4634.6 samples/s | 72.4 steps/s
[Step=25900 Epoch=50.6] | Loss=0.00902 | Reg=0.00182 | L2-Norm=13.498 | L2-Norm(final)=3.461 | acc=1.0000 | 4742.6 samples/s | 74.1 steps/s
[Step=25950 Epoch=50.7] | Loss=0.00874 | Reg=0.00182 | L2-Norm=13.499 | L2-Norm(final)=3.463 | acc=0.9844 | 4732.8 samples/s | 74.0 steps/s
[Step=26000 Epoch=50.8] | Loss=0.00891 | Reg=0.00182 | L2-Norm=13.500 | L2-Norm(final)=3.464 | acc=0.9688 | 4719.1 samples/s | 73.7 steps/s
[Step=26050 Epoch=50.9] | Loss=0.00878 | Reg=0.00182 | L2-Norm=13.501 | L2-Norm(final)=3.466 | acc=0.9844 | 4535.3 samples/s | 70.9 steps/s
[Step=26100 Epoch=51.0] | Loss=0.00854 | Reg=0.00182 | L2-Norm=13.502 | L2-Norm(final)=3.467 | acc=1.0000 | 5579.5 samples/s | 87.2 steps/s
[Step=26150 Epoch=51.1] | Loss=0.00840 | Reg=0.00182 | L2-Norm=13.503 | L2-Norm(final)=3.469 | acc=1.0000 | 1840.7 samples/s | 28.8 steps/s
[Step=26200 Epoch=51.2] | Loss=0.00809 | Reg=0.00182 | L2-Norm=13.504 | L2-Norm(final)=3.470 | acc=1.0000 | 4496.4 samples/s | 70.3 steps/s
[Step=26250 Epoch=51.3] | Loss=0.00784 | Reg=0.00182 | L2-Norm=13.505 | L2-Norm(final)=3.472 | acc=0.9844 | 4570.1 samples/s | 71.4 steps/s
[Step=26300 Epoch=51.4] | Loss=0.00769 | Reg=0.00182 | L2-Norm=13.506 | L2-Norm(final)=3.474 | acc=1.0000 | 4669.9 samples/s | 73.0 steps/s
[Step=26350 Epoch=51.5] | Loss=0.00758 | Reg=0.00182 | L2-Norm=13.507 | L2-Norm(final)=3.476 | acc=1.0000 | 4564.1 samples/s | 71.3 steps/s
[Step=26400 Epoch=51.6] | Loss=0.00735 | Reg=0.00182 | L2-Norm=13.508 | L2-Norm(final)=3.477 | acc=1.0000 | 4593.0 samples/s | 71.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step26400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=98.1] | Loss=0.01218 | Reg=0.00181 | L2-Norm=13.470 | L2-Norm(final)=3.454 | acc=0.9844 | 3772.7 samples/s | 58.9 steps/s
[Step=25650 Epoch=98.3] | Loss=0.00108 | Reg=0.00182 | L2-Norm=13.491 | L2-Norm(final)=3.464 | acc=1.0000 | 4104.3 samples/s | 64.1 steps/s
[Step=25700 Epoch=98.5] | Loss=0.00056 | Reg=0.00182 | L2-Norm=13.493 | L2-Norm(final)=3.466 | acc=1.0000 | 3910.8 samples/s | 61.1 steps/s
[Step=25750 Epoch=98.7] | Loss=0.00038 | Reg=0.00182 | L2-Norm=13.492 | L2-Norm(final)=3.468 | acc=1.0000 | 4022.6 samples/s | 62.9 steps/s
[Step=25800 Epoch=98.9] | Loss=0.00029 | Reg=0.00182 | L2-Norm=13.491 | L2-Norm(final)=3.469 | acc=1.0000 | 4358.4 samples/s | 68.1 steps/s
[Step=25850 Epoch=99.0] | Loss=0.00023 | Reg=0.00182 | L2-Norm=13.489 | L2-Norm(final)=3.470 | acc=1.0000 | 5576.8 samples/s | 87.1 steps/s
[Step=25900 Epoch=99.2] | Loss=0.00020 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=3.471 | acc=1.0000 | 1884.3 samples/s | 29.4 steps/s
[Step=25950 Epoch=99.4] | Loss=0.00017 | Reg=0.00182 | L2-Norm=13.484 | L2-Norm(final)=3.471 | acc=1.0000 | 4421.8 samples/s | 69.1 steps/s
[Step=26000 Epoch=99.6] | Loss=0.00015 | Reg=0.00182 | L2-Norm=13.481 | L2-Norm(final)=3.472 | acc=1.0000 | 4329.7 samples/s | 67.7 steps/s
[Step=26050 Epoch=99.8] | Loss=0.00013 | Reg=0.00182 | L2-Norm=13.479 | L2-Norm(final)=3.472 | acc=1.0000 | 4090.9 samples/s | 63.9 steps/s
[Step=26100 Epoch=100.0] | Loss=0.00012 | Reg=0.00182 | L2-Norm=13.476 | L2-Norm(final)=3.473 | acc=1.0000 | 4350.5 samples/s | 68.0 steps/s
[Step=26150 Epoch=100.2] | Loss=0.00011 | Reg=0.00182 | L2-Norm=13.473 | L2-Norm(final)=3.473 | acc=1.0000 | 1934.9 samples/s | 30.2 steps/s
[Step=26200 Epoch=100.4] | Loss=0.00010 | Reg=0.00181 | L2-Norm=13.470 | L2-Norm(final)=3.473 | acc=1.0000 | 4457.8 samples/s | 69.7 steps/s
[Step=26250 Epoch=100.6] | Loss=0.00009 | Reg=0.00181 | L2-Norm=13.468 | L2-Norm(final)=3.474 | acc=1.0000 | 4411.5 samples/s | 68.9 steps/s
[Step=26300 Epoch=100.8] | Loss=0.00009 | Reg=0.00181 | L2-Norm=13.465 | L2-Norm(final)=3.474 | acc=1.0000 | 4371.6 samples/s | 68.3 steps/s
[Step=26350 Epoch=101.0] | Loss=0.00008 | Reg=0.00181 | L2-Norm=13.462 | L2-Norm(final)=3.475 | acc=1.0000 | 4312.5 samples/s | 67.4 steps/s
[Step=26400 Epoch=101.2] | Loss=0.00008 | Reg=0.00181 | L2-Norm=13.459 | L2-Norm(final)=3.475 | acc=1.0000 | 1941.2 samples/s | 30.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step26400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=98.5] | Loss=0.00508 | Reg=0.00181 | L2-Norm=13.470 | L2-Norm(final)=3.454 | acc=1.0000 | 3590.5 samples/s | 56.1 steps/s
[Step=25650 Epoch=98.7] | Loss=0.00243 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=3.456 | acc=1.0000 | 4335.7 samples/s | 67.7 steps/s
[Step=25700 Epoch=98.9] | Loss=0.00124 | Reg=0.00182 | L2-Norm=13.488 | L2-Norm(final)=3.457 | acc=1.0000 | 4327.7 samples/s | 67.6 steps/s
[Step=25750 Epoch=99.1] | Loss=0.00083 | Reg=0.00182 | L2-Norm=13.487 | L2-Norm(final)=3.458 | acc=1.0000 | 4366.1 samples/s | 68.2 steps/s
[Step=25800 Epoch=99.3] | Loss=0.00063 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=3.459 | acc=1.0000 | 4399.0 samples/s | 68.7 steps/s
[Step=25850 Epoch=99.5] | Loss=0.00050 | Reg=0.00182 | L2-Norm=13.484 | L2-Norm(final)=3.459 | acc=1.0000 | 5575.7 samples/s | 87.1 steps/s
[Step=25900 Epoch=99.7] | Loss=0.00042 | Reg=0.00182 | L2-Norm=13.482 | L2-Norm(final)=3.460 | acc=1.0000 | 1834.2 samples/s | 28.7 steps/s
[Step=25950 Epoch=99.9] | Loss=0.00036 | Reg=0.00182 | L2-Norm=13.480 | L2-Norm(final)=3.460 | acc=1.0000 | 4148.0 samples/s | 64.8 steps/s
[Step=26000 Epoch=100.1] | Loss=0.00032 | Reg=0.00182 | L2-Norm=13.477 | L2-Norm(final)=3.461 | acc=1.0000 | 4117.7 samples/s | 64.3 steps/s
[Step=26050 Epoch=100.3] | Loss=0.00028 | Reg=0.00182 | L2-Norm=13.475 | L2-Norm(final)=3.461 | acc=1.0000 | 4342.9 samples/s | 67.9 steps/s
[Step=26100 Epoch=100.5] | Loss=0.00026 | Reg=0.00182 | L2-Norm=13.473 | L2-Norm(final)=3.461 | acc=1.0000 | 5051.9 samples/s | 78.9 steps/s
[Step=26150 Epoch=100.7] | Loss=0.00023 | Reg=0.00181 | L2-Norm=13.470 | L2-Norm(final)=3.462 | acc=1.0000 | 1925.0 samples/s | 30.1 steps/s
[Step=26200 Epoch=100.9] | Loss=0.00022 | Reg=0.00181 | L2-Norm=13.468 | L2-Norm(final)=3.462 | acc=1.0000 | 4262.2 samples/s | 66.6 steps/s
[Step=26250 Epoch=101.0] | Loss=0.00020 | Reg=0.00181 | L2-Norm=13.466 | L2-Norm(final)=3.462 | acc=1.0000 | 4301.4 samples/s | 67.2 steps/s
[Step=26300 Epoch=101.2] | Loss=0.00019 | Reg=0.00181 | L2-Norm=13.463 | L2-Norm(final)=3.463 | acc=1.0000 | 4142.4 samples/s | 64.7 steps/s
[Step=26350 Epoch=101.4] | Loss=0.00017 | Reg=0.00181 | L2-Norm=13.461 | L2-Norm(final)=3.463 | acc=1.0000 | 4151.8 samples/s | 64.9 steps/s
[Step=26400 Epoch=101.6] | Loss=0.00016 | Reg=0.00181 | L2-Norm=13.458 | L2-Norm(final)=3.463 | acc=1.0000 | 1968.1 samples/s | 30.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24135 | acc=0.8814 | tpr=0.8327 | fpr=0.0129 | 4147.2 samples/s | 16.2 steps/s
Avg test loss: 0.24672, Avg test acc: 0.88056, Avg tpr: 0.83214, Avg fpr: 0.01295, total FA: 101

Testing server on iccad2012
[Step=  50] | Loss=0.44603 | acc=0.8822 | tpr=0.9513 | fpr=0.1191 | 4021.4 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.44321 | acc=0.8847 | tpr=0.9680 | fpr=0.1169 | 7902.3 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.44579 | acc=0.8842 | tpr=0.9755 | fpr=0.1175 | 7944.3 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.44762 | acc=0.8843 | tpr=0.9760 | fpr=0.1174 | 7481.5 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.44558 | acc=0.8843 | tpr=0.9773 | fpr=0.1174 | 8142.1 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.44997 | acc=0.8843 | tpr=0.9775 | fpr=0.1174 | 8058.9 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.45435 | acc=0.8840 | tpr=0.9768 | fpr=0.1177 | 7941.5 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.45661 | acc=0.8841 | tpr=0.9759 | fpr=0.1175 | 7693.2 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.46212 | acc=0.8838 | tpr=0.9752 | fpr=0.1178 | 8071.3 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.46186 | acc=0.8838 | tpr=0.9758 | fpr=0.1179 | 8442.2 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.46038 | acc=0.8841 | tpr=0.9749 | fpr=0.1175 | 13661.3 samples/s | 53.4 steps/s
Avg test loss: 0.46015, Avg test acc: 0.88404, Avg tpr: 0.97504, Avg fpr: 0.11761, total FA: 16330

server round 33/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=51.5] | Loss=0.13354 | Reg=0.00181 | L2-Norm=13.450 | L2-Norm(final)=3.489 | acc=0.8906 | 3919.7 samples/s | 61.2 steps/s
[Step=26450 Epoch=51.6] | Loss=0.02160 | Reg=0.00181 | L2-Norm=13.467 | L2-Norm(final)=3.485 | acc=1.0000 | 4168.1 samples/s | 65.1 steps/s
[Step=26500 Epoch=51.7] | Loss=0.01497 | Reg=0.00181 | L2-Norm=13.472 | L2-Norm(final)=3.485 | acc=0.9688 | 4232.9 samples/s | 66.1 steps/s
[Step=26550 Epoch=51.8] | Loss=0.01223 | Reg=0.00182 | L2-Norm=13.475 | L2-Norm(final)=3.486 | acc=1.0000 | 4357.6 samples/s | 68.1 steps/s
[Step=26600 Epoch=51.9] | Loss=0.01082 | Reg=0.00182 | L2-Norm=13.477 | L2-Norm(final)=3.488 | acc=1.0000 | 4610.8 samples/s | 72.0 steps/s
[Step=26650 Epoch=52.0] | Loss=0.00992 | Reg=0.00182 | L2-Norm=13.478 | L2-Norm(final)=3.490 | acc=0.9844 | 4507.7 samples/s | 70.4 steps/s
[Step=26700 Epoch=52.1] | Loss=0.00955 | Reg=0.00182 | L2-Norm=13.479 | L2-Norm(final)=3.492 | acc=1.0000 | 4622.5 samples/s | 72.2 steps/s
[Step=26750 Epoch=52.2] | Loss=0.00921 | Reg=0.00182 | L2-Norm=13.480 | L2-Norm(final)=3.493 | acc=1.0000 | 4718.1 samples/s | 73.7 steps/s
[Step=26800 Epoch=52.3] | Loss=0.00890 | Reg=0.00182 | L2-Norm=13.482 | L2-Norm(final)=3.495 | acc=1.0000 | 4650.5 samples/s | 72.7 steps/s
[Step=26850 Epoch=52.4] | Loss=0.00868 | Reg=0.00182 | L2-Norm=13.483 | L2-Norm(final)=3.497 | acc=1.0000 | 4701.2 samples/s | 73.5 steps/s
[Step=26900 Epoch=52.5] | Loss=0.00849 | Reg=0.00182 | L2-Norm=13.484 | L2-Norm(final)=3.499 | acc=1.0000 | 5451.6 samples/s | 85.2 steps/s
[Step=26950 Epoch=52.6] | Loss=0.00811 | Reg=0.00182 | L2-Norm=13.485 | L2-Norm(final)=3.500 | acc=1.0000 | 1841.1 samples/s | 28.8 steps/s
[Step=27000 Epoch=52.7] | Loss=0.00793 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=3.502 | acc=0.9844 | 4491.9 samples/s | 70.2 steps/s
[Step=27050 Epoch=52.8] | Loss=0.00778 | Reg=0.00182 | L2-Norm=13.487 | L2-Norm(final)=3.504 | acc=1.0000 | 4652.7 samples/s | 72.7 steps/s
[Step=27100 Epoch=52.9] | Loss=0.00769 | Reg=0.00182 | L2-Norm=13.488 | L2-Norm(final)=3.506 | acc=1.0000 | 4661.7 samples/s | 72.8 steps/s
[Step=27150 Epoch=53.0] | Loss=0.00752 | Reg=0.00182 | L2-Norm=13.489 | L2-Norm(final)=3.508 | acc=0.9844 | 4456.0 samples/s | 69.6 steps/s
[Step=27200 Epoch=53.1] | Loss=0.00744 | Reg=0.00182 | L2-Norm=13.490 | L2-Norm(final)=3.509 | acc=1.0000 | 4571.4 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step27200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=51.6] | Loss=0.16572 | Reg=0.00181 | L2-Norm=13.450 | L2-Norm(final)=3.489 | acc=0.8906 | 4008.9 samples/s | 62.6 steps/s
[Step=26450 Epoch=51.7] | Loss=0.02670 | Reg=0.00181 | L2-Norm=13.467 | L2-Norm(final)=3.481 | acc=1.0000 | 4457.5 samples/s | 69.6 steps/s
[Step=26500 Epoch=51.8] | Loss=0.01747 | Reg=0.00182 | L2-Norm=13.472 | L2-Norm(final)=3.480 | acc=1.0000 | 4258.6 samples/s | 66.5 steps/s
[Step=26550 Epoch=51.9] | Loss=0.01356 | Reg=0.00182 | L2-Norm=13.475 | L2-Norm(final)=3.481 | acc=0.9844 | 4192.0 samples/s | 65.5 steps/s
[Step=26600 Epoch=52.0] | Loss=0.01213 | Reg=0.00182 | L2-Norm=13.477 | L2-Norm(final)=3.483 | acc=1.0000 | 4434.0 samples/s | 69.3 steps/s
[Step=26650 Epoch=52.1] | Loss=0.01113 | Reg=0.00182 | L2-Norm=13.478 | L2-Norm(final)=3.484 | acc=1.0000 | 4596.1 samples/s | 71.8 steps/s
[Step=26700 Epoch=52.2] | Loss=0.01053 | Reg=0.00182 | L2-Norm=13.479 | L2-Norm(final)=3.486 | acc=0.9844 | 4594.4 samples/s | 71.8 steps/s
[Step=26750 Epoch=52.3] | Loss=0.00977 | Reg=0.00182 | L2-Norm=13.480 | L2-Norm(final)=3.488 | acc=1.0000 | 4583.4 samples/s | 71.6 steps/s
[Step=26800 Epoch=52.4] | Loss=0.00936 | Reg=0.00182 | L2-Norm=13.481 | L2-Norm(final)=3.490 | acc=1.0000 | 4678.6 samples/s | 73.1 steps/s
[Step=26850 Epoch=52.5] | Loss=0.00915 | Reg=0.00182 | L2-Norm=13.482 | L2-Norm(final)=3.492 | acc=0.9844 | 4589.0 samples/s | 71.7 steps/s
[Step=26900 Epoch=52.6] | Loss=0.00908 | Reg=0.00182 | L2-Norm=13.483 | L2-Norm(final)=3.494 | acc=0.9844 | 5687.9 samples/s | 88.9 steps/s
[Step=26950 Epoch=52.7] | Loss=0.00877 | Reg=0.00182 | L2-Norm=13.484 | L2-Norm(final)=3.495 | acc=0.9844 | 1833.8 samples/s | 28.7 steps/s
[Step=27000 Epoch=52.8] | Loss=0.00853 | Reg=0.00182 | L2-Norm=13.485 | L2-Norm(final)=3.497 | acc=1.0000 | 4455.8 samples/s | 69.6 steps/s
[Step=27050 Epoch=52.9] | Loss=0.00825 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=3.499 | acc=1.0000 | 4661.4 samples/s | 72.8 steps/s
[Step=27100 Epoch=53.0] | Loss=0.00801 | Reg=0.00182 | L2-Norm=13.487 | L2-Norm(final)=3.500 | acc=1.0000 | 4681.5 samples/s | 73.1 steps/s
[Step=27150 Epoch=53.1] | Loss=0.00785 | Reg=0.00182 | L2-Norm=13.488 | L2-Norm(final)=3.502 | acc=1.0000 | 4563.8 samples/s | 71.3 steps/s
[Step=27200 Epoch=53.2] | Loss=0.00769 | Reg=0.00182 | L2-Norm=13.489 | L2-Norm(final)=3.504 | acc=1.0000 | 4587.8 samples/s | 71.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step27200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=101.2] | Loss=0.00184 | Reg=0.00181 | L2-Norm=13.450 | L2-Norm(final)=3.490 | acc=1.0000 | 3939.0 samples/s | 61.5 steps/s
[Step=26450 Epoch=101.3] | Loss=0.00296 | Reg=0.00182 | L2-Norm=13.481 | L2-Norm(final)=3.493 | acc=1.0000 | 3725.8 samples/s | 58.2 steps/s
[Step=26500 Epoch=101.5] | Loss=0.00149 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=3.493 | acc=1.0000 | 4077.4 samples/s | 63.7 steps/s
[Step=26550 Epoch=101.7] | Loss=0.00099 | Reg=0.00182 | L2-Norm=13.486 | L2-Norm(final)=3.494 | acc=1.0000 | 4107.8 samples/s | 64.2 steps/s
[Step=26600 Epoch=101.9] | Loss=0.00075 | Reg=0.00182 | L2-Norm=13.484 | L2-Norm(final)=3.494 | acc=1.0000 | 4383.3 samples/s | 68.5 steps/s
[Step=26650 Epoch=102.1] | Loss=0.00060 | Reg=0.00182 | L2-Norm=13.482 | L2-Norm(final)=3.494 | acc=1.0000 | 5580.3 samples/s | 87.2 steps/s
[Step=26700 Epoch=102.3] | Loss=0.00050 | Reg=0.00182 | L2-Norm=13.480 | L2-Norm(final)=3.494 | acc=1.0000 | 1843.3 samples/s | 28.8 steps/s
[Step=26750 Epoch=102.5] | Loss=0.00043 | Reg=0.00182 | L2-Norm=13.477 | L2-Norm(final)=3.494 | acc=1.0000 | 4326.5 samples/s | 67.6 steps/s
[Step=26800 Epoch=102.7] | Loss=0.00038 | Reg=0.00182 | L2-Norm=13.475 | L2-Norm(final)=3.494 | acc=1.0000 | 4449.6 samples/s | 69.5 steps/s
[Step=26850 Epoch=102.9] | Loss=0.00033 | Reg=0.00182 | L2-Norm=13.472 | L2-Norm(final)=3.494 | acc=1.0000 | 4281.3 samples/s | 66.9 steps/s
[Step=26900 Epoch=103.1] | Loss=0.00030 | Reg=0.00181 | L2-Norm=13.470 | L2-Norm(final)=3.494 | acc=1.0000 | 4578.7 samples/s | 71.5 steps/s
[Step=26950 Epoch=103.3] | Loss=0.00027 | Reg=0.00181 | L2-Norm=13.467 | L2-Norm(final)=3.495 | acc=1.0000 | 1903.6 samples/s | 29.7 steps/s
[Step=27000 Epoch=103.5] | Loss=0.00025 | Reg=0.00181 | L2-Norm=13.464 | L2-Norm(final)=3.495 | acc=1.0000 | 4414.6 samples/s | 69.0 steps/s
[Step=27050 Epoch=103.6] | Loss=0.00023 | Reg=0.00181 | L2-Norm=13.461 | L2-Norm(final)=3.495 | acc=1.0000 | 4431.6 samples/s | 69.2 steps/s
[Step=27100 Epoch=103.8] | Loss=0.00022 | Reg=0.00181 | L2-Norm=13.458 | L2-Norm(final)=3.495 | acc=1.0000 | 4373.7 samples/s | 68.3 steps/s
[Step=27150 Epoch=104.0] | Loss=0.00020 | Reg=0.00181 | L2-Norm=13.455 | L2-Norm(final)=3.495 | acc=1.0000 | 4360.8 samples/s | 68.1 steps/s
[Step=27200 Epoch=104.2] | Loss=0.00019 | Reg=0.00181 | L2-Norm=13.453 | L2-Norm(final)=3.495 | acc=1.0000 | 1942.4 samples/s | 30.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step27200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=101.6] | Loss=0.03323 | Reg=0.00181 | L2-Norm=13.450 | L2-Norm(final)=3.490 | acc=0.9688 | 4009.3 samples/s | 62.6 steps/s
[Step=26450 Epoch=101.8] | Loss=0.00149 | Reg=0.00182 | L2-Norm=13.479 | L2-Norm(final)=3.499 | acc=1.0000 | 3525.4 samples/s | 55.1 steps/s
[Step=26500 Epoch=102.0] | Loss=0.00075 | Reg=0.00182 | L2-Norm=13.482 | L2-Norm(final)=3.500 | acc=1.0000 | 4418.3 samples/s | 69.0 steps/s
[Step=26550 Epoch=102.2] | Loss=0.00050 | Reg=0.00182 | L2-Norm=13.482 | L2-Norm(final)=3.500 | acc=1.0000 | 4399.5 samples/s | 68.7 steps/s
[Step=26600 Epoch=102.4] | Loss=0.00038 | Reg=0.00182 | L2-Norm=13.480 | L2-Norm(final)=3.500 | acc=1.0000 | 4441.5 samples/s | 69.4 steps/s
[Step=26650 Epoch=102.6] | Loss=0.00031 | Reg=0.00182 | L2-Norm=13.478 | L2-Norm(final)=3.501 | acc=1.0000 | 5624.1 samples/s | 87.9 steps/s
[Step=26700 Epoch=102.8] | Loss=0.00026 | Reg=0.00182 | L2-Norm=13.476 | L2-Norm(final)=3.501 | acc=1.0000 | 1824.5 samples/s | 28.5 steps/s
[Step=26750 Epoch=103.0] | Loss=0.00022 | Reg=0.00182 | L2-Norm=13.474 | L2-Norm(final)=3.501 | acc=1.0000 | 4277.7 samples/s | 66.8 steps/s
[Step=26800 Epoch=103.2] | Loss=0.00019 | Reg=0.00181 | L2-Norm=13.471 | L2-Norm(final)=3.501 | acc=1.0000 | 3902.6 samples/s | 61.0 steps/s
[Step=26850 Epoch=103.4] | Loss=0.00017 | Reg=0.00181 | L2-Norm=13.469 | L2-Norm(final)=3.502 | acc=1.0000 | 3934.7 samples/s | 61.5 steps/s
[Step=26900 Epoch=103.5] | Loss=0.00016 | Reg=0.00181 | L2-Norm=13.466 | L2-Norm(final)=3.502 | acc=1.0000 | 4642.0 samples/s | 72.5 steps/s
[Step=26950 Epoch=103.7] | Loss=0.00014 | Reg=0.00181 | L2-Norm=13.464 | L2-Norm(final)=3.502 | acc=1.0000 | 1921.7 samples/s | 30.0 steps/s
[Step=27000 Epoch=103.9] | Loss=0.00013 | Reg=0.00181 | L2-Norm=13.461 | L2-Norm(final)=3.502 | acc=1.0000 | 4479.9 samples/s | 70.0 steps/s
[Step=27050 Epoch=104.1] | Loss=0.00012 | Reg=0.00181 | L2-Norm=13.458 | L2-Norm(final)=3.502 | acc=1.0000 | 4471.1 samples/s | 69.9 steps/s
[Step=27100 Epoch=104.3] | Loss=0.00011 | Reg=0.00181 | L2-Norm=13.456 | L2-Norm(final)=3.502 | acc=1.0000 | 4249.0 samples/s | 66.4 steps/s
[Step=27150 Epoch=104.5] | Loss=0.00010 | Reg=0.00181 | L2-Norm=13.453 | L2-Norm(final)=3.502 | acc=1.0000 | 4134.4 samples/s | 64.6 steps/s
[Step=27200 Epoch=104.7] | Loss=0.00010 | Reg=0.00181 | L2-Norm=13.450 | L2-Norm(final)=3.503 | acc=1.0000 | 2025.6 samples/s | 31.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26376 | acc=0.8710 | tpr=0.8172 | fpr=0.0121 | 4374.5 samples/s | 17.1 steps/s
Avg test loss: 0.26897, Avg test acc: 0.87070, Avg tpr: 0.81745, Avg fpr: 0.01218, total FA: 95

Testing server on iccad2012
[Step=  50] | Loss=0.37605 | acc=0.9081 | tpr=0.9469 | fpr=0.0926 | 4064.4 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.37714 | acc=0.9087 | tpr=0.9659 | fpr=0.0923 | 7979.8 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.38071 | acc=0.9079 | tpr=0.9726 | fpr=0.0933 | 8549.1 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.38220 | acc=0.9083 | tpr=0.9738 | fpr=0.0929 | 7176.6 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.38022 | acc=0.9083 | tpr=0.9755 | fpr=0.0929 | 7919.2 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.38474 | acc=0.9083 | tpr=0.9760 | fpr=0.0930 | 7816.6 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.38900 | acc=0.9078 | tpr=0.9756 | fpr=0.0934 | 8049.8 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.39164 | acc=0.9075 | tpr=0.9737 | fpr=0.0937 | 7106.3 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.39702 | acc=0.9072 | tpr=0.9722 | fpr=0.0940 | 8091.4 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.39679 | acc=0.9069 | tpr=0.9727 | fpr=0.0942 | 7707.2 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.39557 | acc=0.9073 | tpr=0.9725 | fpr=0.0939 | 13558.4 samples/s | 53.0 steps/s
Avg test loss: 0.39524, Avg test acc: 0.90723, Avg tpr: 0.97227, Avg fpr: 0.09395, total FA: 13045

server round 34/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=53.1] | Loss=0.20943 | Reg=0.00180 | L2-Norm=13.433 | L2-Norm(final)=3.515 | acc=0.9062 | 3787.6 samples/s | 59.2 steps/s
[Step=27250 Epoch=53.1] | Loss=0.02092 | Reg=0.00181 | L2-Norm=13.453 | L2-Norm(final)=3.508 | acc=1.0000 | 4094.5 samples/s | 64.0 steps/s
[Step=27300 Epoch=53.2] | Loss=0.01360 | Reg=0.00181 | L2-Norm=13.458 | L2-Norm(final)=3.509 | acc=1.0000 | 4159.4 samples/s | 65.0 steps/s
[Step=27350 Epoch=53.3] | Loss=0.01133 | Reg=0.00181 | L2-Norm=13.461 | L2-Norm(final)=3.511 | acc=0.9844 | 4496.4 samples/s | 70.3 steps/s
[Step=27400 Epoch=53.4] | Loss=0.01088 | Reg=0.00181 | L2-Norm=13.463 | L2-Norm(final)=3.513 | acc=0.9688 | 4633.1 samples/s | 72.4 steps/s
[Step=27450 Epoch=53.5] | Loss=0.01032 | Reg=0.00181 | L2-Norm=13.465 | L2-Norm(final)=3.515 | acc=1.0000 | 4607.4 samples/s | 72.0 steps/s
[Step=27500 Epoch=53.6] | Loss=0.00980 | Reg=0.00181 | L2-Norm=13.466 | L2-Norm(final)=3.517 | acc=1.0000 | 4695.1 samples/s | 73.4 steps/s
[Step=27550 Epoch=53.7] | Loss=0.00936 | Reg=0.00181 | L2-Norm=13.467 | L2-Norm(final)=3.519 | acc=1.0000 | 4614.3 samples/s | 72.1 steps/s
[Step=27600 Epoch=53.8] | Loss=0.00893 | Reg=0.00181 | L2-Norm=13.469 | L2-Norm(final)=3.520 | acc=1.0000 | 4676.1 samples/s | 73.1 steps/s
[Step=27650 Epoch=53.9] | Loss=0.00876 | Reg=0.00181 | L2-Norm=13.470 | L2-Norm(final)=3.522 | acc=1.0000 | 4732.0 samples/s | 73.9 steps/s
[Step=27700 Epoch=54.0] | Loss=0.00839 | Reg=0.00181 | L2-Norm=13.471 | L2-Norm(final)=3.524 | acc=0.9844 | 5512.4 samples/s | 86.1 steps/s
[Step=27750 Epoch=54.1] | Loss=0.00819 | Reg=0.00181 | L2-Norm=13.472 | L2-Norm(final)=3.526 | acc=1.0000 | 1735.9 samples/s | 27.1 steps/s
[Step=27800 Epoch=54.2] | Loss=0.00808 | Reg=0.00182 | L2-Norm=13.473 | L2-Norm(final)=3.528 | acc=1.0000 | 4617.0 samples/s | 72.1 steps/s
[Step=27850 Epoch=54.3] | Loss=0.00796 | Reg=0.00182 | L2-Norm=13.474 | L2-Norm(final)=3.530 | acc=1.0000 | 4714.1 samples/s | 73.7 steps/s
[Step=27900 Epoch=54.4] | Loss=0.00781 | Reg=0.00182 | L2-Norm=13.475 | L2-Norm(final)=3.532 | acc=1.0000 | 4654.9 samples/s | 72.7 steps/s
[Step=27950 Epoch=54.5] | Loss=0.00776 | Reg=0.00182 | L2-Norm=13.476 | L2-Norm(final)=3.534 | acc=1.0000 | 4612.0 samples/s | 72.1 steps/s
[Step=28000 Epoch=54.6] | Loss=0.00770 | Reg=0.00182 | L2-Norm=13.477 | L2-Norm(final)=3.535 | acc=0.9844 | 4642.9 samples/s | 72.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28000.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=53.2] | Loss=0.08158 | Reg=0.00180 | L2-Norm=13.433 | L2-Norm(final)=3.515 | acc=0.9375 | 4015.3 samples/s | 62.7 steps/s
[Step=27250 Epoch=53.3] | Loss=0.02271 | Reg=0.00181 | L2-Norm=13.451 | L2-Norm(final)=3.510 | acc=1.0000 | 4243.4 samples/s | 66.3 steps/s
[Step=27300 Epoch=53.4] | Loss=0.01476 | Reg=0.00181 | L2-Norm=13.456 | L2-Norm(final)=3.510 | acc=1.0000 | 4122.6 samples/s | 64.4 steps/s
[Step=27350 Epoch=53.5] | Loss=0.01233 | Reg=0.00181 | L2-Norm=13.458 | L2-Norm(final)=3.512 | acc=1.0000 | 4218.0 samples/s | 65.9 steps/s
[Step=27400 Epoch=53.6] | Loss=0.01072 | Reg=0.00181 | L2-Norm=13.460 | L2-Norm(final)=3.514 | acc=0.9844 | 4358.2 samples/s | 68.1 steps/s
[Step=27450 Epoch=53.7] | Loss=0.00970 | Reg=0.00181 | L2-Norm=13.462 | L2-Norm(final)=3.516 | acc=0.9688 | 4566.5 samples/s | 71.4 steps/s
[Step=27500 Epoch=53.8] | Loss=0.00894 | Reg=0.00181 | L2-Norm=13.463 | L2-Norm(final)=3.518 | acc=0.9844 | 4553.1 samples/s | 71.1 steps/s
[Step=27550 Epoch=53.9] | Loss=0.00871 | Reg=0.00181 | L2-Norm=13.464 | L2-Norm(final)=3.520 | acc=1.0000 | 4517.7 samples/s | 70.6 steps/s
[Step=27600 Epoch=54.0] | Loss=0.00872 | Reg=0.00181 | L2-Norm=13.465 | L2-Norm(final)=3.521 | acc=1.0000 | 4635.2 samples/s | 72.4 steps/s
[Step=27650 Epoch=54.1] | Loss=0.00856 | Reg=0.00181 | L2-Norm=13.465 | L2-Norm(final)=3.522 | acc=1.0000 | 4697.0 samples/s | 73.4 steps/s
[Step=27700 Epoch=54.2] | Loss=0.00840 | Reg=0.00181 | L2-Norm=13.466 | L2-Norm(final)=3.524 | acc=0.9844 | 5498.3 samples/s | 85.9 steps/s
[Step=27750 Epoch=54.3] | Loss=0.00818 | Reg=0.00181 | L2-Norm=13.467 | L2-Norm(final)=3.525 | acc=1.0000 | 1828.8 samples/s | 28.6 steps/s
[Step=27800 Epoch=54.3] | Loss=0.00797 | Reg=0.00181 | L2-Norm=13.467 | L2-Norm(final)=3.526 | acc=1.0000 | 4579.6 samples/s | 71.6 steps/s
[Step=27850 Epoch=54.4] | Loss=0.00777 | Reg=0.00181 | L2-Norm=13.468 | L2-Norm(final)=3.527 | acc=1.0000 | 4686.1 samples/s | 73.2 steps/s
[Step=27900 Epoch=54.5] | Loss=0.00765 | Reg=0.00181 | L2-Norm=13.469 | L2-Norm(final)=3.529 | acc=1.0000 | 4606.0 samples/s | 72.0 steps/s
[Step=27950 Epoch=54.6] | Loss=0.00751 | Reg=0.00181 | L2-Norm=13.469 | L2-Norm(final)=3.530 | acc=1.0000 | 4682.2 samples/s | 73.2 steps/s
[Step=28000 Epoch=54.7] | Loss=0.00746 | Reg=0.00181 | L2-Norm=13.470 | L2-Norm(final)=3.532 | acc=1.0000 | 4731.3 samples/s | 73.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step28000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=104.2] | Loss=0.01065 | Reg=0.00180 | L2-Norm=13.433 | L2-Norm(final)=3.516 | acc=0.9844 | 3892.8 samples/s | 60.8 steps/s
[Step=27250 Epoch=104.4] | Loss=0.00155 | Reg=0.00181 | L2-Norm=13.448 | L2-Norm(final)=3.520 | acc=1.0000 | 4075.5 samples/s | 63.7 steps/s
[Step=27300 Epoch=104.6] | Loss=0.00079 | Reg=0.00181 | L2-Norm=13.449 | L2-Norm(final)=3.522 | acc=1.0000 | 3820.8 samples/s | 59.7 steps/s
[Step=27350 Epoch=104.8] | Loss=0.00053 | Reg=0.00181 | L2-Norm=13.448 | L2-Norm(final)=3.523 | acc=1.0000 | 4172.3 samples/s | 65.2 steps/s
[Step=27400 Epoch=105.0] | Loss=0.00040 | Reg=0.00181 | L2-Norm=13.445 | L2-Norm(final)=3.524 | acc=1.0000 | 4385.5 samples/s | 68.5 steps/s
[Step=27450 Epoch=105.2] | Loss=0.00033 | Reg=0.00181 | L2-Norm=13.442 | L2-Norm(final)=3.525 | acc=1.0000 | 5523.7 samples/s | 86.3 steps/s
[Step=27500 Epoch=105.4] | Loss=0.00027 | Reg=0.00181 | L2-Norm=13.439 | L2-Norm(final)=3.526 | acc=1.0000 | 1920.3 samples/s | 30.0 steps/s
[Step=27550 Epoch=105.6] | Loss=0.00024 | Reg=0.00181 | L2-Norm=13.436 | L2-Norm(final)=3.527 | acc=1.0000 | 4368.8 samples/s | 68.3 steps/s
[Step=27600 Epoch=105.8] | Loss=0.00021 | Reg=0.00180 | L2-Norm=13.433 | L2-Norm(final)=3.527 | acc=1.0000 | 4325.7 samples/s | 67.6 steps/s
[Step=27650 Epoch=105.9] | Loss=0.00018 | Reg=0.00180 | L2-Norm=13.430 | L2-Norm(final)=3.528 | acc=1.0000 | 3998.9 samples/s | 62.5 steps/s
[Step=27700 Epoch=106.1] | Loss=0.00017 | Reg=0.00180 | L2-Norm=13.426 | L2-Norm(final)=3.528 | acc=1.0000 | 4343.3 samples/s | 67.9 steps/s
[Step=27750 Epoch=106.3] | Loss=0.00015 | Reg=0.00180 | L2-Norm=13.423 | L2-Norm(final)=3.529 | acc=1.0000 | 1950.0 samples/s | 30.5 steps/s
[Step=27800 Epoch=106.5] | Loss=0.00014 | Reg=0.00180 | L2-Norm=13.420 | L2-Norm(final)=3.529 | acc=1.0000 | 4488.2 samples/s | 70.1 steps/s
[Step=27850 Epoch=106.7] | Loss=0.00013 | Reg=0.00180 | L2-Norm=13.416 | L2-Norm(final)=3.530 | acc=1.0000 | 4285.0 samples/s | 67.0 steps/s
[Step=27900 Epoch=106.9] | Loss=0.00012 | Reg=0.00180 | L2-Norm=13.413 | L2-Norm(final)=3.530 | acc=1.0000 | 4390.0 samples/s | 68.6 steps/s
[Step=27950 Epoch=107.1] | Loss=0.00011 | Reg=0.00180 | L2-Norm=13.409 | L2-Norm(final)=3.531 | acc=1.0000 | 4384.2 samples/s | 68.5 steps/s
[Step=28000 Epoch=107.3] | Loss=0.00011 | Reg=0.00180 | L2-Norm=13.406 | L2-Norm(final)=3.531 | acc=1.0000 | 1980.2 samples/s | 30.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=104.7] | Loss=0.08015 | Reg=0.00180 | L2-Norm=13.433 | L2-Norm(final)=3.516 | acc=0.9688 | 3938.5 samples/s | 61.5 steps/s
[Step=27250 Epoch=104.9] | Loss=0.00264 | Reg=0.00181 | L2-Norm=13.450 | L2-Norm(final)=3.517 | acc=1.0000 | 3844.2 samples/s | 60.1 steps/s
[Step=27300 Epoch=105.1] | Loss=0.00133 | Reg=0.00181 | L2-Norm=13.452 | L2-Norm(final)=3.517 | acc=1.0000 | 4358.5 samples/s | 68.1 steps/s
[Step=27350 Epoch=105.3] | Loss=0.00090 | Reg=0.00181 | L2-Norm=13.451 | L2-Norm(final)=3.518 | acc=1.0000 | 4456.6 samples/s | 69.6 steps/s
[Step=27400 Epoch=105.5] | Loss=0.00068 | Reg=0.00181 | L2-Norm=13.449 | L2-Norm(final)=3.518 | acc=1.0000 | 4328.4 samples/s | 67.6 steps/s
[Step=27450 Epoch=105.7] | Loss=0.00055 | Reg=0.00181 | L2-Norm=13.447 | L2-Norm(final)=3.519 | acc=1.0000 | 5700.7 samples/s | 89.1 steps/s
[Step=27500 Epoch=105.9] | Loss=0.00046 | Reg=0.00181 | L2-Norm=13.445 | L2-Norm(final)=3.519 | acc=1.0000 | 1853.1 samples/s | 29.0 steps/s
[Step=27550 Epoch=106.1] | Loss=0.00039 | Reg=0.00181 | L2-Norm=13.443 | L2-Norm(final)=3.519 | acc=1.0000 | 3933.9 samples/s | 61.5 steps/s
[Step=27600 Epoch=106.2] | Loss=0.00035 | Reg=0.00181 | L2-Norm=13.440 | L2-Norm(final)=3.520 | acc=1.0000 | 3960.3 samples/s | 61.9 steps/s
[Step=27650 Epoch=106.4] | Loss=0.00031 | Reg=0.00181 | L2-Norm=13.438 | L2-Norm(final)=3.520 | acc=1.0000 | 4026.0 samples/s | 62.9 steps/s
[Step=27700 Epoch=106.6] | Loss=0.00028 | Reg=0.00180 | L2-Norm=13.435 | L2-Norm(final)=3.520 | acc=1.0000 | 4879.2 samples/s | 76.2 steps/s
[Step=27750 Epoch=106.8] | Loss=0.00025 | Reg=0.00180 | L2-Norm=13.432 | L2-Norm(final)=3.520 | acc=1.0000 | 1929.9 samples/s | 30.2 steps/s
[Step=27800 Epoch=107.0] | Loss=0.00023 | Reg=0.00180 | L2-Norm=13.430 | L2-Norm(final)=3.521 | acc=1.0000 | 4373.8 samples/s | 68.3 steps/s
[Step=27850 Epoch=107.2] | Loss=0.00021 | Reg=0.00180 | L2-Norm=13.427 | L2-Norm(final)=3.521 | acc=1.0000 | 4130.2 samples/s | 64.5 steps/s
[Step=27900 Epoch=107.4] | Loss=0.00020 | Reg=0.00180 | L2-Norm=13.424 | L2-Norm(final)=3.521 | acc=1.0000 | 4204.5 samples/s | 65.7 steps/s
[Step=27950 Epoch=107.6] | Loss=0.00019 | Reg=0.00180 | L2-Norm=13.421 | L2-Norm(final)=3.521 | acc=1.0000 | 4037.8 samples/s | 63.1 steps/s
[Step=28000 Epoch=107.8] | Loss=0.00018 | Reg=0.00180 | L2-Norm=13.418 | L2-Norm(final)=3.521 | acc=1.0000 | 1930.0 samples/s | 30.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21651 | acc=0.8904 | tpr=0.8460 | fpr=0.0131 | 4216.7 samples/s | 16.5 steps/s
Avg test loss: 0.22200, Avg test acc: 0.89062, Avg tpr: 0.84718, Avg fpr: 0.01384, total FA: 108

Testing server on iccad2012
[Step=  50] | Loss=0.44616 | acc=0.8829 | tpr=0.9558 | fpr=0.1184 | 4230.5 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.44582 | acc=0.8855 | tpr=0.9701 | fpr=0.1161 | 7926.1 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.44922 | acc=0.8849 | tpr=0.9769 | fpr=0.1168 | 7970.3 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.44997 | acc=0.8852 | tpr=0.9770 | fpr=0.1165 | 6983.1 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.44762 | acc=0.8853 | tpr=0.9782 | fpr=0.1164 | 7778.9 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.45226 | acc=0.8854 | tpr=0.9782 | fpr=0.1163 | 8236.5 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.45653 | acc=0.8849 | tpr=0.9775 | fpr=0.1168 | 7840.1 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.45893 | acc=0.8849 | tpr=0.9754 | fpr=0.1167 | 7473.3 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.46453 | acc=0.8846 | tpr=0.9737 | fpr=0.1170 | 8298.7 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.46443 | acc=0.8844 | tpr=0.9744 | fpr=0.1172 | 7830.2 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.46322 | acc=0.8848 | tpr=0.9737 | fpr=0.1168 | 14701.5 samples/s | 57.4 steps/s
Avg test loss: 0.46293, Avg test acc: 0.88472, Avg tpr: 0.97345, Avg fpr: 0.11690, total FA: 16231

server round 35/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=54.6] | Loss=0.04660 | Reg=0.00180 | L2-Norm=13.404 | L2-Norm(final)=3.543 | acc=0.9844 | 3898.9 samples/s | 60.9 steps/s
[Step=28050 Epoch=54.7] | Loss=0.01763 | Reg=0.00180 | L2-Norm=13.420 | L2-Norm(final)=3.542 | acc=1.0000 | 3687.5 samples/s | 57.6 steps/s
[Step=28100 Epoch=54.8] | Loss=0.01314 | Reg=0.00180 | L2-Norm=13.425 | L2-Norm(final)=3.541 | acc=0.9844 | 4197.3 samples/s | 65.6 steps/s
[Step=28150 Epoch=54.9] | Loss=0.01088 | Reg=0.00180 | L2-Norm=13.427 | L2-Norm(final)=3.542 | acc=1.0000 | 4196.3 samples/s | 65.6 steps/s
[Step=28200 Epoch=55.0] | Loss=0.00996 | Reg=0.00180 | L2-Norm=13.428 | L2-Norm(final)=3.544 | acc=0.9844 | 4545.6 samples/s | 71.0 steps/s
[Step=28250 Epoch=55.1] | Loss=0.00943 | Reg=0.00180 | L2-Norm=13.430 | L2-Norm(final)=3.545 | acc=1.0000 | 4732.1 samples/s | 73.9 steps/s
[Step=28300 Epoch=55.2] | Loss=0.00921 | Reg=0.00180 | L2-Norm=13.431 | L2-Norm(final)=3.547 | acc=1.0000 | 4643.6 samples/s | 72.6 steps/s
[Step=28350 Epoch=55.3] | Loss=0.00908 | Reg=0.00180 | L2-Norm=13.432 | L2-Norm(final)=3.548 | acc=1.0000 | 4714.7 samples/s | 73.7 steps/s
[Step=28400 Epoch=55.4] | Loss=0.00855 | Reg=0.00180 | L2-Norm=13.433 | L2-Norm(final)=3.550 | acc=1.0000 | 4705.7 samples/s | 73.5 steps/s
[Step=28450 Epoch=55.5] | Loss=0.00844 | Reg=0.00180 | L2-Norm=13.434 | L2-Norm(final)=3.551 | acc=1.0000 | 4588.1 samples/s | 71.7 steps/s
[Step=28500 Epoch=55.6] | Loss=0.00848 | Reg=0.00180 | L2-Norm=13.435 | L2-Norm(final)=3.553 | acc=1.0000 | 5216.7 samples/s | 81.5 steps/s
[Step=28550 Epoch=55.7] | Loss=0.00812 | Reg=0.00181 | L2-Norm=13.436 | L2-Norm(final)=3.554 | acc=1.0000 | 1822.5 samples/s | 28.5 steps/s
[Step=28600 Epoch=55.8] | Loss=0.00797 | Reg=0.00181 | L2-Norm=13.437 | L2-Norm(final)=3.556 | acc=0.9688 | 4592.8 samples/s | 71.8 steps/s
[Step=28650 Epoch=55.9] | Loss=0.00771 | Reg=0.00181 | L2-Norm=13.438 | L2-Norm(final)=3.558 | acc=1.0000 | 4624.5 samples/s | 72.3 steps/s
[Step=28700 Epoch=56.0] | Loss=0.00766 | Reg=0.00181 | L2-Norm=13.439 | L2-Norm(final)=3.559 | acc=0.9688 | 4700.7 samples/s | 73.4 steps/s
[Step=28750 Epoch=56.1] | Loss=0.00748 | Reg=0.00181 | L2-Norm=13.440 | L2-Norm(final)=3.561 | acc=1.0000 | 4531.8 samples/s | 70.8 steps/s
[Step=28800 Epoch=56.2] | Loss=0.00735 | Reg=0.00181 | L2-Norm=13.440 | L2-Norm(final)=3.563 | acc=0.9844 | 4571.3 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=54.7] | Loss=0.14479 | Reg=0.00180 | L2-Norm=13.404 | L2-Norm(final)=3.543 | acc=0.9062 | 4225.6 samples/s | 66.0 steps/s
[Step=28050 Epoch=54.8] | Loss=0.01654 | Reg=0.00180 | L2-Norm=13.414 | L2-Norm(final)=3.544 | acc=0.9844 | 4028.4 samples/s | 62.9 steps/s
[Step=28100 Epoch=54.9] | Loss=0.01190 | Reg=0.00180 | L2-Norm=13.417 | L2-Norm(final)=3.545 | acc=0.9844 | 4122.8 samples/s | 64.4 steps/s
[Step=28150 Epoch=55.0] | Loss=0.01016 | Reg=0.00180 | L2-Norm=13.418 | L2-Norm(final)=3.547 | acc=1.0000 | 4591.5 samples/s | 71.7 steps/s
[Step=28200 Epoch=55.1] | Loss=0.00923 | Reg=0.00180 | L2-Norm=13.420 | L2-Norm(final)=3.549 | acc=1.0000 | 4662.0 samples/s | 72.8 steps/s
[Step=28250 Epoch=55.2] | Loss=0.00848 | Reg=0.00180 | L2-Norm=13.422 | L2-Norm(final)=3.550 | acc=1.0000 | 4709.9 samples/s | 73.6 steps/s
[Step=28300 Epoch=55.3] | Loss=0.00841 | Reg=0.00180 | L2-Norm=13.423 | L2-Norm(final)=3.552 | acc=1.0000 | 4657.2 samples/s | 72.8 steps/s
[Step=28350 Epoch=55.4] | Loss=0.00819 | Reg=0.00180 | L2-Norm=13.424 | L2-Norm(final)=3.554 | acc=0.9844 | 4712.4 samples/s | 73.6 steps/s
[Step=28400 Epoch=55.5] | Loss=0.00801 | Reg=0.00180 | L2-Norm=13.425 | L2-Norm(final)=3.555 | acc=1.0000 | 4615.2 samples/s | 72.1 steps/s
[Step=28450 Epoch=55.6] | Loss=0.00775 | Reg=0.00180 | L2-Norm=13.426 | L2-Norm(final)=3.557 | acc=1.0000 | 4588.4 samples/s | 71.7 steps/s
[Step=28500 Epoch=55.7] | Loss=0.00759 | Reg=0.00180 | L2-Norm=13.427 | L2-Norm(final)=3.558 | acc=1.0000 | 5449.0 samples/s | 85.1 steps/s
[Step=28550 Epoch=55.8] | Loss=0.00737 | Reg=0.00180 | L2-Norm=13.428 | L2-Norm(final)=3.560 | acc=1.0000 | 1887.4 samples/s | 29.5 steps/s
[Step=28600 Epoch=55.9] | Loss=0.00723 | Reg=0.00180 | L2-Norm=13.429 | L2-Norm(final)=3.561 | acc=1.0000 | 4675.4 samples/s | 73.1 steps/s
[Step=28650 Epoch=56.0] | Loss=0.00705 | Reg=0.00180 | L2-Norm=13.430 | L2-Norm(final)=3.563 | acc=1.0000 | 4816.2 samples/s | 75.3 steps/s
[Step=28700 Epoch=56.1] | Loss=0.00691 | Reg=0.00180 | L2-Norm=13.431 | L2-Norm(final)=3.565 | acc=1.0000 | 4723.9 samples/s | 73.8 steps/s
[Step=28750 Epoch=56.2] | Loss=0.00674 | Reg=0.00180 | L2-Norm=13.432 | L2-Norm(final)=3.566 | acc=1.0000 | 4829.2 samples/s | 75.5 steps/s
[Step=28800 Epoch=56.3] | Loss=0.00670 | Reg=0.00180 | L2-Norm=13.432 | L2-Norm(final)=3.568 | acc=0.9844 | 4783.6 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step28800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=107.3] | Loss=0.00915 | Reg=0.00180 | L2-Norm=13.404 | L2-Norm(final)=3.543 | acc=0.9844 | 4111.9 samples/s | 64.2 steps/s
[Step=28050 Epoch=107.5] | Loss=0.00300 | Reg=0.00180 | L2-Norm=13.431 | L2-Norm(final)=3.550 | acc=1.0000 | 4052.6 samples/s | 63.3 steps/s
[Step=28100 Epoch=107.7] | Loss=0.00151 | Reg=0.00181 | L2-Norm=13.436 | L2-Norm(final)=3.550 | acc=1.0000 | 4112.0 samples/s | 64.2 steps/s
[Step=28150 Epoch=107.9] | Loss=0.00102 | Reg=0.00181 | L2-Norm=13.435 | L2-Norm(final)=3.550 | acc=1.0000 | 4340.9 samples/s | 67.8 steps/s
[Step=28200 Epoch=108.1] | Loss=0.00076 | Reg=0.00180 | L2-Norm=13.433 | L2-Norm(final)=3.550 | acc=1.0000 | 4495.2 samples/s | 70.2 steps/s
[Step=28250 Epoch=108.2] | Loss=0.00062 | Reg=0.00180 | L2-Norm=13.431 | L2-Norm(final)=3.551 | acc=1.0000 | 5692.0 samples/s | 88.9 steps/s
[Step=28300 Epoch=108.4] | Loss=0.00051 | Reg=0.00180 | L2-Norm=13.428 | L2-Norm(final)=3.551 | acc=1.0000 | 1935.5 samples/s | 30.2 steps/s
[Step=28350 Epoch=108.6] | Loss=0.00044 | Reg=0.00180 | L2-Norm=13.425 | L2-Norm(final)=3.551 | acc=1.0000 | 4559.1 samples/s | 71.2 steps/s
[Step=28400 Epoch=108.8] | Loss=0.00039 | Reg=0.00180 | L2-Norm=13.422 | L2-Norm(final)=3.552 | acc=1.0000 | 4498.9 samples/s | 70.3 steps/s
[Step=28450 Epoch=109.0] | Loss=0.00034 | Reg=0.00180 | L2-Norm=13.419 | L2-Norm(final)=3.552 | acc=1.0000 | 4359.4 samples/s | 68.1 steps/s
[Step=28500 Epoch=109.2] | Loss=0.00031 | Reg=0.00180 | L2-Norm=13.416 | L2-Norm(final)=3.553 | acc=1.0000 | 4560.3 samples/s | 71.3 steps/s
[Step=28550 Epoch=109.4] | Loss=0.00028 | Reg=0.00180 | L2-Norm=13.412 | L2-Norm(final)=3.553 | acc=1.0000 | 2002.1 samples/s | 31.3 steps/s
[Step=28600 Epoch=109.6] | Loss=0.00026 | Reg=0.00180 | L2-Norm=13.409 | L2-Norm(final)=3.553 | acc=1.0000 | 4401.9 samples/s | 68.8 steps/s
[Step=28650 Epoch=109.8] | Loss=0.00024 | Reg=0.00180 | L2-Norm=13.405 | L2-Norm(final)=3.554 | acc=1.0000 | 4380.2 samples/s | 68.4 steps/s
[Step=28700 Epoch=110.0] | Loss=0.00022 | Reg=0.00180 | L2-Norm=13.402 | L2-Norm(final)=3.554 | acc=1.0000 | 4111.2 samples/s | 64.2 steps/s
[Step=28750 Epoch=110.2] | Loss=0.00021 | Reg=0.00180 | L2-Norm=13.398 | L2-Norm(final)=3.554 | acc=1.0000 | 4246.2 samples/s | 66.3 steps/s
[Step=28800 Epoch=110.4] | Loss=0.00019 | Reg=0.00179 | L2-Norm=13.395 | L2-Norm(final)=3.554 | acc=1.0000 | 2065.8 samples/s | 32.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=107.8] | Loss=0.01285 | Reg=0.00180 | L2-Norm=13.404 | L2-Norm(final)=3.543 | acc=0.9844 | 4385.7 samples/s | 68.5 steps/s
[Step=28050 Epoch=108.0] | Loss=0.00203 | Reg=0.00181 | L2-Norm=13.437 | L2-Norm(final)=3.551 | acc=1.0000 | 3839.8 samples/s | 60.0 steps/s
[Step=28100 Epoch=108.2] | Loss=0.00102 | Reg=0.00181 | L2-Norm=13.443 | L2-Norm(final)=3.551 | acc=1.0000 | 4579.0 samples/s | 71.5 steps/s
[Step=28150 Epoch=108.4] | Loss=0.00068 | Reg=0.00181 | L2-Norm=13.443 | L2-Norm(final)=3.551 | acc=1.0000 | 4513.9 samples/s | 70.5 steps/s
[Step=28200 Epoch=108.6] | Loss=0.00052 | Reg=0.00181 | L2-Norm=13.442 | L2-Norm(final)=3.552 | acc=1.0000 | 4552.2 samples/s | 71.1 steps/s
[Step=28250 Epoch=108.7] | Loss=0.00042 | Reg=0.00181 | L2-Norm=13.440 | L2-Norm(final)=3.552 | acc=1.0000 | 5676.4 samples/s | 88.7 steps/s
[Step=28300 Epoch=108.9] | Loss=0.00035 | Reg=0.00181 | L2-Norm=13.438 | L2-Norm(final)=3.553 | acc=1.0000 | 1895.4 samples/s | 29.6 steps/s
[Step=28350 Epoch=109.1] | Loss=0.00030 | Reg=0.00181 | L2-Norm=13.436 | L2-Norm(final)=3.553 | acc=1.0000 | 4052.5 samples/s | 63.3 steps/s
[Step=28400 Epoch=109.3] | Loss=0.00026 | Reg=0.00180 | L2-Norm=13.433 | L2-Norm(final)=3.553 | acc=1.0000 | 4449.4 samples/s | 69.5 steps/s
[Step=28450 Epoch=109.5] | Loss=0.00024 | Reg=0.00180 | L2-Norm=13.431 | L2-Norm(final)=3.554 | acc=1.0000 | 4525.6 samples/s | 70.7 steps/s
[Step=28500 Epoch=109.7] | Loss=0.00021 | Reg=0.00180 | L2-Norm=13.428 | L2-Norm(final)=3.554 | acc=1.0000 | 5147.0 samples/s | 80.4 steps/s
[Step=28550 Epoch=109.9] | Loss=0.00019 | Reg=0.00180 | L2-Norm=13.426 | L2-Norm(final)=3.554 | acc=1.0000 | 2002.5 samples/s | 31.3 steps/s
[Step=28600 Epoch=110.1] | Loss=0.00018 | Reg=0.00180 | L2-Norm=13.423 | L2-Norm(final)=3.555 | acc=1.0000 | 4525.2 samples/s | 70.7 steps/s
[Step=28650 Epoch=110.3] | Loss=0.00016 | Reg=0.00180 | L2-Norm=13.420 | L2-Norm(final)=3.555 | acc=1.0000 | 4464.4 samples/s | 69.8 steps/s
[Step=28700 Epoch=110.5] | Loss=0.00015 | Reg=0.00180 | L2-Norm=13.417 | L2-Norm(final)=3.555 | acc=1.0000 | 4422.4 samples/s | 69.1 steps/s
[Step=28750 Epoch=110.7] | Loss=0.00014 | Reg=0.00180 | L2-Norm=13.415 | L2-Norm(final)=3.555 | acc=1.0000 | 4043.5 samples/s | 63.2 steps/s
[Step=28800 Epoch=110.9] | Loss=0.00013 | Reg=0.00180 | L2-Norm=13.412 | L2-Norm(final)=3.556 | acc=1.0000 | 2064.4 samples/s | 32.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25097 | acc=0.8789 | tpr=0.8288 | fpr=0.0124 | 4330.1 samples/s | 16.9 steps/s
Avg test loss: 0.25672, Avg test acc: 0.87936, Avg tpr: 0.83056, Avg fpr: 0.01333, total FA: 104

Testing server on iccad2012
[Step=  50] | Loss=0.37766 | acc=0.9109 | tpr=0.9513 | fpr=0.0898 | 4057.3 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.37868 | acc=0.9116 | tpr=0.9680 | fpr=0.0895 | 8394.9 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.38211 | acc=0.9106 | tpr=0.9741 | fpr=0.0906 | 8440.2 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.38362 | acc=0.9109 | tpr=0.9749 | fpr=0.0902 | 7386.5 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.38179 | acc=0.9109 | tpr=0.9764 | fpr=0.0903 | 8480.3 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.38607 | acc=0.9107 | tpr=0.9767 | fpr=0.0905 | 8161.7 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.39013 | acc=0.9101 | tpr=0.9756 | fpr=0.0910 | 8310.9 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.39268 | acc=0.9100 | tpr=0.9743 | fpr=0.0912 | 8083.3 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.39821 | acc=0.9095 | tpr=0.9727 | fpr=0.0916 | 8270.6 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.39818 | acc=0.9094 | tpr=0.9731 | fpr=0.0918 | 7893.6 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.39712 | acc=0.9096 | tpr=0.9725 | fpr=0.0916 | 15237.8 samples/s | 59.5 steps/s
Avg test loss: 0.39672, Avg test acc: 0.90947, Avg tpr: 0.97227, Avg fpr: 0.09167, total FA: 12728

server round 36/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=56.2] | Loss=0.08525 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=3.573 | acc=0.9531 | 4158.1 samples/s | 65.0 steps/s
[Step=28850 Epoch=56.3] | Loss=0.02090 | Reg=0.00180 | L2-Norm=13.406 | L2-Norm(final)=3.566 | acc=0.9844 | 4316.5 samples/s | 67.4 steps/s
[Step=28900 Epoch=56.4] | Loss=0.01442 | Reg=0.00180 | L2-Norm=13.413 | L2-Norm(final)=3.566 | acc=1.0000 | 4413.7 samples/s | 69.0 steps/s
[Step=28950 Epoch=56.5] | Loss=0.01222 | Reg=0.00180 | L2-Norm=13.417 | L2-Norm(final)=3.568 | acc=1.0000 | 4421.5 samples/s | 69.1 steps/s
[Step=29000 Epoch=56.6] | Loss=0.01077 | Reg=0.00180 | L2-Norm=13.419 | L2-Norm(final)=3.570 | acc=0.9844 | 4766.1 samples/s | 74.5 steps/s
[Step=29050 Epoch=56.7] | Loss=0.00962 | Reg=0.00180 | L2-Norm=13.420 | L2-Norm(final)=3.572 | acc=1.0000 | 4794.6 samples/s | 74.9 steps/s
[Step=29100 Epoch=56.8] | Loss=0.00905 | Reg=0.00180 | L2-Norm=13.422 | L2-Norm(final)=3.574 | acc=1.0000 | 4783.0 samples/s | 74.7 steps/s
[Step=29150 Epoch=56.9] | Loss=0.00865 | Reg=0.00180 | L2-Norm=13.423 | L2-Norm(final)=3.576 | acc=1.0000 | 4785.1 samples/s | 74.8 steps/s
[Step=29200 Epoch=57.0] | Loss=0.00867 | Reg=0.00180 | L2-Norm=13.424 | L2-Norm(final)=3.577 | acc=1.0000 | 4785.2 samples/s | 74.8 steps/s
[Step=29250 Epoch=57.0] | Loss=0.00846 | Reg=0.00180 | L2-Norm=13.424 | L2-Norm(final)=3.578 | acc=1.0000 | 4743.1 samples/s | 74.1 steps/s
[Step=29300 Epoch=57.1] | Loss=0.00847 | Reg=0.00180 | L2-Norm=13.425 | L2-Norm(final)=3.580 | acc=0.9844 | 5860.1 samples/s | 91.6 steps/s
[Step=29350 Epoch=57.2] | Loss=0.00821 | Reg=0.00180 | L2-Norm=13.426 | L2-Norm(final)=3.581 | acc=1.0000 | 1822.6 samples/s | 28.5 steps/s
[Step=29400 Epoch=57.3] | Loss=0.00802 | Reg=0.00180 | L2-Norm=13.427 | L2-Norm(final)=3.582 | acc=0.9844 | 4636.6 samples/s | 72.4 steps/s
[Step=29450 Epoch=57.4] | Loss=0.00789 | Reg=0.00180 | L2-Norm=13.428 | L2-Norm(final)=3.584 | acc=0.9844 | 4797.8 samples/s | 75.0 steps/s
[Step=29500 Epoch=57.5] | Loss=0.00768 | Reg=0.00180 | L2-Norm=13.429 | L2-Norm(final)=3.586 | acc=1.0000 | 4751.8 samples/s | 74.2 steps/s
[Step=29550 Epoch=57.6] | Loss=0.00750 | Reg=0.00180 | L2-Norm=13.429 | L2-Norm(final)=3.587 | acc=1.0000 | 4772.9 samples/s | 74.6 steps/s
[Step=29600 Epoch=57.7] | Loss=0.00748 | Reg=0.00180 | L2-Norm=13.430 | L2-Norm(final)=3.589 | acc=1.0000 | 4796.8 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step29600.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=56.3] | Loss=0.04223 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=3.573 | acc=0.9531 | 4451.7 samples/s | 69.6 steps/s
[Step=28850 Epoch=56.4] | Loss=0.01894 | Reg=0.00180 | L2-Norm=13.403 | L2-Norm(final)=3.567 | acc=1.0000 | 4209.9 samples/s | 65.8 steps/s
[Step=28900 Epoch=56.5] | Loss=0.01320 | Reg=0.00180 | L2-Norm=13.409 | L2-Norm(final)=3.568 | acc=1.0000 | 4571.9 samples/s | 71.4 steps/s
[Step=28950 Epoch=56.6] | Loss=0.01058 | Reg=0.00180 | L2-Norm=13.411 | L2-Norm(final)=3.569 | acc=1.0000 | 4316.5 samples/s | 67.4 steps/s
[Step=29000 Epoch=56.7] | Loss=0.00967 | Reg=0.00180 | L2-Norm=13.413 | L2-Norm(final)=3.571 | acc=1.0000 | 4502.2 samples/s | 70.3 steps/s
[Step=29050 Epoch=56.8] | Loss=0.00902 | Reg=0.00180 | L2-Norm=13.414 | L2-Norm(final)=3.572 | acc=1.0000 | 4801.2 samples/s | 75.0 steps/s
[Step=29100 Epoch=56.9] | Loss=0.00836 | Reg=0.00180 | L2-Norm=13.415 | L2-Norm(final)=3.574 | acc=1.0000 | 4735.4 samples/s | 74.0 steps/s
[Step=29150 Epoch=57.0] | Loss=0.00821 | Reg=0.00180 | L2-Norm=13.416 | L2-Norm(final)=3.575 | acc=1.0000 | 4750.0 samples/s | 74.2 steps/s
[Step=29200 Epoch=57.1] | Loss=0.00803 | Reg=0.00180 | L2-Norm=13.417 | L2-Norm(final)=3.577 | acc=0.9844 | 4823.7 samples/s | 75.4 steps/s
[Step=29250 Epoch=57.2] | Loss=0.00810 | Reg=0.00180 | L2-Norm=13.417 | L2-Norm(final)=3.579 | acc=1.0000 | 4752.1 samples/s | 74.3 steps/s
[Step=29300 Epoch=57.3] | Loss=0.00802 | Reg=0.00180 | L2-Norm=13.418 | L2-Norm(final)=3.580 | acc=1.0000 | 5926.8 samples/s | 92.6 steps/s
[Step=29350 Epoch=57.4] | Loss=0.00795 | Reg=0.00180 | L2-Norm=13.419 | L2-Norm(final)=3.581 | acc=0.9844 | 1959.0 samples/s | 30.6 steps/s
[Step=29400 Epoch=57.5] | Loss=0.00772 | Reg=0.00180 | L2-Norm=13.419 | L2-Norm(final)=3.583 | acc=1.0000 | 4375.9 samples/s | 68.4 steps/s
[Step=29450 Epoch=57.6] | Loss=0.00759 | Reg=0.00180 | L2-Norm=13.420 | L2-Norm(final)=3.584 | acc=1.0000 | 4703.5 samples/s | 73.5 steps/s
[Step=29500 Epoch=57.7] | Loss=0.00743 | Reg=0.00180 | L2-Norm=13.421 | L2-Norm(final)=3.585 | acc=1.0000 | 4833.8 samples/s | 75.5 steps/s
[Step=29550 Epoch=57.8] | Loss=0.00723 | Reg=0.00180 | L2-Norm=13.421 | L2-Norm(final)=3.587 | acc=1.0000 | 4795.3 samples/s | 74.9 steps/s
[Step=29600 Epoch=57.9] | Loss=0.00712 | Reg=0.00180 | L2-Norm=13.422 | L2-Norm(final)=3.589 | acc=1.0000 | 4750.8 samples/s | 74.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step29600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=110.4] | Loss=0.04839 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=3.573 | acc=0.9844 | 4207.3 samples/s | 65.7 steps/s
[Step=28850 Epoch=110.5] | Loss=0.00223 | Reg=0.00180 | L2-Norm=13.404 | L2-Norm(final)=3.579 | acc=1.0000 | 4264.6 samples/s | 66.6 steps/s
[Step=28900 Epoch=110.7] | Loss=0.00113 | Reg=0.00180 | L2-Norm=13.406 | L2-Norm(final)=3.580 | acc=1.0000 | 4411.6 samples/s | 68.9 steps/s
[Step=28950 Epoch=110.9] | Loss=0.00076 | Reg=0.00180 | L2-Norm=13.405 | L2-Norm(final)=3.580 | acc=1.0000 | 4322.1 samples/s | 67.5 steps/s
[Step=29000 Epoch=111.1] | Loss=0.00057 | Reg=0.00180 | L2-Norm=13.403 | L2-Norm(final)=3.580 | acc=1.0000 | 4209.6 samples/s | 65.8 steps/s
[Step=29050 Epoch=111.3] | Loss=0.00046 | Reg=0.00180 | L2-Norm=13.400 | L2-Norm(final)=3.581 | acc=1.0000 | 5671.6 samples/s | 88.6 steps/s
[Step=29100 Epoch=111.5] | Loss=0.00038 | Reg=0.00180 | L2-Norm=13.398 | L2-Norm(final)=3.581 | acc=1.0000 | 1926.0 samples/s | 30.1 steps/s
[Step=29150 Epoch=111.7] | Loss=0.00033 | Reg=0.00179 | L2-Norm=13.395 | L2-Norm(final)=3.581 | acc=1.0000 | 4549.2 samples/s | 71.1 steps/s
[Step=29200 Epoch=111.9] | Loss=0.00029 | Reg=0.00179 | L2-Norm=13.392 | L2-Norm(final)=3.582 | acc=1.0000 | 4471.8 samples/s | 69.9 steps/s
[Step=29250 Epoch=112.1] | Loss=0.00026 | Reg=0.00179 | L2-Norm=13.389 | L2-Norm(final)=3.582 | acc=1.0000 | 4526.6 samples/s | 70.7 steps/s
[Step=29300 Epoch=112.3] | Loss=0.00023 | Reg=0.00179 | L2-Norm=13.386 | L2-Norm(final)=3.582 | acc=1.0000 | 5018.1 samples/s | 78.4 steps/s
[Step=29350 Epoch=112.5] | Loss=0.00021 | Reg=0.00179 | L2-Norm=13.383 | L2-Norm(final)=3.582 | acc=1.0000 | 1913.7 samples/s | 29.9 steps/s
[Step=29400 Epoch=112.7] | Loss=0.00019 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.582 | acc=1.0000 | 4497.2 samples/s | 70.3 steps/s
[Step=29450 Epoch=112.8] | Loss=0.00018 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=3.583 | acc=1.0000 | 4509.6 samples/s | 70.5 steps/s
[Step=29500 Epoch=113.0] | Loss=0.00017 | Reg=0.00179 | L2-Norm=13.374 | L2-Norm(final)=3.583 | acc=1.0000 | 4450.5 samples/s | 69.5 steps/s
[Step=29550 Epoch=113.2] | Loss=0.00016 | Reg=0.00179 | L2-Norm=13.371 | L2-Norm(final)=3.583 | acc=1.0000 | 4489.9 samples/s | 70.2 steps/s
[Step=29600 Epoch=113.4] | Loss=0.00015 | Reg=0.00179 | L2-Norm=13.368 | L2-Norm(final)=3.583 | acc=1.0000 | 2083.6 samples/s | 32.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step29600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=110.9] | Loss=0.00185 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=3.574 | acc=1.0000 | 3972.0 samples/s | 62.1 steps/s
[Step=28850 Epoch=111.1] | Loss=0.00274 | Reg=0.00180 | L2-Norm=13.406 | L2-Norm(final)=3.576 | acc=1.0000 | 3738.6 samples/s | 58.4 steps/s
[Step=28900 Epoch=111.2] | Loss=0.00137 | Reg=0.00180 | L2-Norm=13.410 | L2-Norm(final)=3.576 | acc=1.0000 | 4147.0 samples/s | 64.8 steps/s
[Step=28950 Epoch=111.4] | Loss=0.00092 | Reg=0.00180 | L2-Norm=13.409 | L2-Norm(final)=3.576 | acc=1.0000 | 4511.5 samples/s | 70.5 steps/s
[Step=29000 Epoch=111.6] | Loss=0.00069 | Reg=0.00180 | L2-Norm=13.407 | L2-Norm(final)=3.576 | acc=1.0000 | 4518.4 samples/s | 70.6 steps/s
[Step=29050 Epoch=111.8] | Loss=0.00055 | Reg=0.00180 | L2-Norm=13.405 | L2-Norm(final)=3.576 | acc=1.0000 | 5745.0 samples/s | 89.8 steps/s
[Step=29100 Epoch=112.0] | Loss=0.00046 | Reg=0.00180 | L2-Norm=13.403 | L2-Norm(final)=3.576 | acc=1.0000 | 1916.7 samples/s | 29.9 steps/s
[Step=29150 Epoch=112.2] | Loss=0.00040 | Reg=0.00180 | L2-Norm=13.401 | L2-Norm(final)=3.576 | acc=1.0000 | 4508.4 samples/s | 70.4 steps/s
[Step=29200 Epoch=112.4] | Loss=0.00035 | Reg=0.00180 | L2-Norm=13.399 | L2-Norm(final)=3.577 | acc=1.0000 | 4386.7 samples/s | 68.5 steps/s
[Step=29250 Epoch=112.6] | Loss=0.00031 | Reg=0.00179 | L2-Norm=13.396 | L2-Norm(final)=3.577 | acc=1.0000 | 4295.7 samples/s | 67.1 steps/s
[Step=29300 Epoch=112.8] | Loss=0.00028 | Reg=0.00179 | L2-Norm=13.394 | L2-Norm(final)=3.577 | acc=1.0000 | 4710.3 samples/s | 73.6 steps/s
[Step=29350 Epoch=113.0] | Loss=0.00025 | Reg=0.00179 | L2-Norm=13.391 | L2-Norm(final)=3.577 | acc=1.0000 | 2005.0 samples/s | 31.3 steps/s
[Step=29400 Epoch=113.2] | Loss=0.00023 | Reg=0.00179 | L2-Norm=13.388 | L2-Norm(final)=3.577 | acc=1.0000 | 4535.5 samples/s | 70.9 steps/s
[Step=29450 Epoch=113.4] | Loss=0.00022 | Reg=0.00179 | L2-Norm=13.386 | L2-Norm(final)=3.577 | acc=1.0000 | 4525.9 samples/s | 70.7 steps/s
[Step=29500 Epoch=113.6] | Loss=0.00020 | Reg=0.00179 | L2-Norm=13.383 | L2-Norm(final)=3.577 | acc=1.0000 | 4540.3 samples/s | 70.9 steps/s
[Step=29550 Epoch=113.7] | Loss=0.00019 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.578 | acc=1.0000 | 4604.9 samples/s | 72.0 steps/s
[Step=29600 Epoch=113.9] | Loss=0.00018 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=3.578 | acc=1.0000 | 2041.1 samples/s | 31.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20211 | acc=0.8996 | tpr=0.8593 | fpr=0.0129 | 4349.5 samples/s | 17.0 steps/s
Avg test loss: 0.20758, Avg test acc: 0.89943, Avg tpr: 0.86058, Avg fpr: 0.01513, total FA: 118

Testing server on iccad2012
[Step=  50] | Loss=0.44376 | acc=0.8895 | tpr=0.9558 | fpr=0.1117 | 4146.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.44208 | acc=0.8911 | tpr=0.9680 | fpr=0.1103 | 8284.7 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.44470 | acc=0.8908 | tpr=0.9741 | fpr=0.1108 | 8341.2 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.44646 | acc=0.8910 | tpr=0.9749 | fpr=0.1105 | 8389.1 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.44470 | acc=0.8911 | tpr=0.9764 | fpr=0.1105 | 7915.5 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.44912 | acc=0.8908 | tpr=0.9767 | fpr=0.1107 | 7830.4 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.45318 | acc=0.8905 | tpr=0.9762 | fpr=0.1110 | 8392.1 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.45553 | acc=0.8906 | tpr=0.9748 | fpr=0.1109 | 8524.9 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.46112 | acc=0.8903 | tpr=0.9742 | fpr=0.1112 | 8024.6 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.46108 | acc=0.8903 | tpr=0.9749 | fpr=0.1112 | 7663.7 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.45988 | acc=0.8904 | tpr=0.9745 | fpr=0.1111 | 14928.5 samples/s | 58.3 steps/s
Avg test loss: 0.45958, Avg test acc: 0.89032, Avg tpr: 0.97425, Avg fpr: 0.11120, total FA: 15440

server round 37/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=57.7] | Loss=0.09339 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=3.597 | acc=0.9688 | 3708.2 samples/s | 57.9 steps/s
[Step=29650 Epoch=57.8] | Loss=0.01873 | Reg=0.00179 | L2-Norm=13.371 | L2-Norm(final)=3.593 | acc=0.9844 | 4817.4 samples/s | 75.3 steps/s
[Step=29700 Epoch=57.9] | Loss=0.01293 | Reg=0.00179 | L2-Norm=13.375 | L2-Norm(final)=3.594 | acc=0.9844 | 4750.2 samples/s | 74.2 steps/s
[Step=29750 Epoch=58.0] | Loss=0.01111 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=3.596 | acc=1.0000 | 4730.9 samples/s | 73.9 steps/s
[Step=29800 Epoch=58.1] | Loss=0.00972 | Reg=0.00179 | L2-Norm=13.379 | L2-Norm(final)=3.599 | acc=1.0000 | 4716.4 samples/s | 73.7 steps/s
[Step=29850 Epoch=58.2] | Loss=0.00907 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=3.601 | acc=1.0000 | 4597.5 samples/s | 71.8 steps/s
[Step=29900 Epoch=58.3] | Loss=0.00847 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=3.603 | acc=1.0000 | 4363.0 samples/s | 68.2 steps/s
[Step=29950 Epoch=58.4] | Loss=0.00828 | Reg=0.00179 | L2-Norm=13.384 | L2-Norm(final)=3.604 | acc=0.9844 | 4748.8 samples/s | 74.2 steps/s
[Step=30000 Epoch=58.5] | Loss=0.00808 | Reg=0.00179 | L2-Norm=13.385 | L2-Norm(final)=3.606 | acc=1.0000 | 4798.1 samples/s | 75.0 steps/s
[Step=30050 Epoch=58.6] | Loss=0.00792 | Reg=0.00179 | L2-Norm=13.386 | L2-Norm(final)=3.608 | acc=0.9844 | 4766.7 samples/s | 74.5 steps/s
[Step=30100 Epoch=58.7] | Loss=0.00781 | Reg=0.00179 | L2-Norm=13.387 | L2-Norm(final)=3.610 | acc=0.9844 | 5854.6 samples/s | 91.5 steps/s
[Step=30150 Epoch=58.8] | Loss=0.00765 | Reg=0.00179 | L2-Norm=13.388 | L2-Norm(final)=3.612 | acc=0.9844 | 1976.5 samples/s | 30.9 steps/s
[Step=30200 Epoch=58.9] | Loss=0.00748 | Reg=0.00179 | L2-Norm=13.389 | L2-Norm(final)=3.613 | acc=1.0000 | 4756.7 samples/s | 74.3 steps/s
[Step=30250 Epoch=59.0] | Loss=0.00725 | Reg=0.00179 | L2-Norm=13.390 | L2-Norm(final)=3.615 | acc=1.0000 | 4632.8 samples/s | 72.4 steps/s
[Step=30300 Epoch=59.1] | Loss=0.00705 | Reg=0.00179 | L2-Norm=13.391 | L2-Norm(final)=3.617 | acc=1.0000 | 4407.7 samples/s | 68.9 steps/s
[Step=30350 Epoch=59.2] | Loss=0.00690 | Reg=0.00179 | L2-Norm=13.391 | L2-Norm(final)=3.618 | acc=1.0000 | 4510.4 samples/s | 70.5 steps/s
[Step=30400 Epoch=59.3] | Loss=0.00702 | Reg=0.00179 | L2-Norm=13.392 | L2-Norm(final)=3.620 | acc=1.0000 | 4818.0 samples/s | 75.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step30400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=57.9] | Loss=0.04752 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=3.597 | acc=0.9688 | 3988.3 samples/s | 62.3 steps/s
[Step=29650 Epoch=58.0] | Loss=0.02013 | Reg=0.00179 | L2-Norm=13.371 | L2-Norm(final)=3.592 | acc=1.0000 | 4815.8 samples/s | 75.2 steps/s
[Step=29700 Epoch=58.1] | Loss=0.01283 | Reg=0.00179 | L2-Norm=13.375 | L2-Norm(final)=3.594 | acc=0.9844 | 4726.9 samples/s | 73.9 steps/s
[Step=29750 Epoch=58.2] | Loss=0.01035 | Reg=0.00179 | L2-Norm=13.378 | L2-Norm(final)=3.597 | acc=1.0000 | 4722.5 samples/s | 73.8 steps/s
[Step=29800 Epoch=58.3] | Loss=0.00946 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.600 | acc=1.0000 | 4787.3 samples/s | 74.8 steps/s
[Step=29850 Epoch=58.4] | Loss=0.00932 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=3.601 | acc=0.9844 | 4617.4 samples/s | 72.1 steps/s
[Step=29900 Epoch=58.5] | Loss=0.00888 | Reg=0.00179 | L2-Norm=13.383 | L2-Norm(final)=3.603 | acc=1.0000 | 4582.3 samples/s | 71.6 steps/s
[Step=29950 Epoch=58.6] | Loss=0.00834 | Reg=0.00179 | L2-Norm=13.384 | L2-Norm(final)=3.605 | acc=1.0000 | 4392.5 samples/s | 68.6 steps/s
[Step=30000 Epoch=58.6] | Loss=0.00839 | Reg=0.00179 | L2-Norm=13.385 | L2-Norm(final)=3.606 | acc=1.0000 | 4755.6 samples/s | 74.3 steps/s
[Step=30050 Epoch=58.7] | Loss=0.00816 | Reg=0.00179 | L2-Norm=13.386 | L2-Norm(final)=3.607 | acc=1.0000 | 4832.6 samples/s | 75.5 steps/s
[Step=30100 Epoch=58.8] | Loss=0.00799 | Reg=0.00179 | L2-Norm=13.387 | L2-Norm(final)=3.609 | acc=1.0000 | 5870.6 samples/s | 91.7 steps/s
[Step=30150 Epoch=58.9] | Loss=0.00783 | Reg=0.00179 | L2-Norm=13.388 | L2-Norm(final)=3.610 | acc=1.0000 | 1993.8 samples/s | 31.2 steps/s
[Step=30200 Epoch=59.0] | Loss=0.00766 | Reg=0.00179 | L2-Norm=13.389 | L2-Norm(final)=3.612 | acc=1.0000 | 4769.5 samples/s | 74.5 steps/s
[Step=30250 Epoch=59.1] | Loss=0.00754 | Reg=0.00179 | L2-Norm=13.390 | L2-Norm(final)=3.613 | acc=1.0000 | 4779.0 samples/s | 74.7 steps/s
[Step=30300 Epoch=59.2] | Loss=0.00742 | Reg=0.00179 | L2-Norm=13.390 | L2-Norm(final)=3.615 | acc=1.0000 | 4609.5 samples/s | 72.0 steps/s
[Step=30350 Epoch=59.3] | Loss=0.00718 | Reg=0.00179 | L2-Norm=13.391 | L2-Norm(final)=3.616 | acc=1.0000 | 4403.8 samples/s | 68.8 steps/s
[Step=30400 Epoch=59.4] | Loss=0.00717 | Reg=0.00179 | L2-Norm=13.392 | L2-Norm(final)=3.618 | acc=1.0000 | 4573.3 samples/s | 71.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step30400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=113.4] | Loss=0.09550 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=3.597 | acc=0.9531 | 4289.9 samples/s | 67.0 steps/s
[Step=29650 Epoch=113.6] | Loss=0.00399 | Reg=0.00179 | L2-Norm=13.385 | L2-Norm(final)=3.598 | acc=1.0000 | 4423.7 samples/s | 69.1 steps/s
[Step=29700 Epoch=113.8] | Loss=0.00200 | Reg=0.00179 | L2-Norm=13.389 | L2-Norm(final)=3.597 | acc=1.0000 | 4440.0 samples/s | 69.4 steps/s
[Step=29750 Epoch=114.0] | Loss=0.00134 | Reg=0.00179 | L2-Norm=13.388 | L2-Norm(final)=3.597 | acc=1.0000 | 4541.0 samples/s | 71.0 steps/s
[Step=29800 Epoch=114.2] | Loss=0.00101 | Reg=0.00179 | L2-Norm=13.387 | L2-Norm(final)=3.597 | acc=1.0000 | 4510.0 samples/s | 70.5 steps/s
[Step=29850 Epoch=114.4] | Loss=0.00081 | Reg=0.00179 | L2-Norm=13.385 | L2-Norm(final)=3.597 | acc=1.0000 | 5688.7 samples/s | 88.9 steps/s
[Step=29900 Epoch=114.6] | Loss=0.00068 | Reg=0.00179 | L2-Norm=13.383 | L2-Norm(final)=3.597 | acc=1.0000 | 1796.8 samples/s | 28.1 steps/s
[Step=29950 Epoch=114.8] | Loss=0.00058 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=3.597 | acc=1.0000 | 4314.4 samples/s | 67.4 steps/s
[Step=30000 Epoch=114.9] | Loss=0.00051 | Reg=0.00179 | L2-Norm=13.379 | L2-Norm(final)=3.597 | acc=1.0000 | 4439.0 samples/s | 69.4 steps/s
[Step=30050 Epoch=115.1] | Loss=0.00045 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=3.597 | acc=1.0000 | 4544.3 samples/s | 71.0 steps/s
[Step=30100 Epoch=115.3] | Loss=0.00041 | Reg=0.00179 | L2-Norm=13.375 | L2-Norm(final)=3.598 | acc=1.0000 | 5020.5 samples/s | 78.4 steps/s
[Step=30150 Epoch=115.5] | Loss=0.00037 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=3.598 | acc=1.0000 | 2035.2 samples/s | 31.8 steps/s
[Step=30200 Epoch=115.7] | Loss=0.00034 | Reg=0.00179 | L2-Norm=13.371 | L2-Norm(final)=3.598 | acc=1.0000 | 4512.5 samples/s | 70.5 steps/s
[Step=30250 Epoch=115.9] | Loss=0.00031 | Reg=0.00179 | L2-Norm=13.369 | L2-Norm(final)=3.598 | acc=1.0000 | 4461.0 samples/s | 69.7 steps/s
[Step=30300 Epoch=116.1] | Loss=0.00029 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=3.598 | acc=1.0000 | 4181.5 samples/s | 65.3 steps/s
[Step=30350 Epoch=116.3] | Loss=0.00027 | Reg=0.00179 | L2-Norm=13.364 | L2-Norm(final)=3.598 | acc=1.0000 | 4386.2 samples/s | 68.5 steps/s
[Step=30400 Epoch=116.5] | Loss=0.00026 | Reg=0.00179 | L2-Norm=13.362 | L2-Norm(final)=3.598 | acc=1.0000 | 2093.9 samples/s | 32.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step30400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=113.9] | Loss=0.14832 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=3.597 | acc=0.9531 | 3950.6 samples/s | 61.7 steps/s
[Step=29650 Epoch=114.1] | Loss=0.00512 | Reg=0.00179 | L2-Norm=13.379 | L2-Norm(final)=3.596 | acc=1.0000 | 4509.4 samples/s | 70.5 steps/s
[Step=29700 Epoch=114.3] | Loss=0.00257 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=3.595 | acc=1.0000 | 4397.6 samples/s | 68.7 steps/s
[Step=29750 Epoch=114.5] | Loss=0.00172 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=3.595 | acc=1.0000 | 4427.6 samples/s | 69.2 steps/s
[Step=29800 Epoch=114.7] | Loss=0.00129 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.596 | acc=1.0000 | 4353.0 samples/s | 68.0 steps/s
[Step=29850 Epoch=114.9] | Loss=0.00103 | Reg=0.00179 | L2-Norm=13.378 | L2-Norm(final)=3.596 | acc=1.0000 | 5139.2 samples/s | 80.3 steps/s
[Step=29900 Epoch=115.1] | Loss=0.00086 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=3.596 | acc=1.0000 | 1903.6 samples/s | 29.7 steps/s
[Step=29950 Epoch=115.3] | Loss=0.00074 | Reg=0.00179 | L2-Norm=13.375 | L2-Norm(final)=3.596 | acc=1.0000 | 4552.3 samples/s | 71.1 steps/s
[Step=30000 Epoch=115.5] | Loss=0.00065 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=3.596 | acc=1.0000 | 4477.3 samples/s | 70.0 steps/s
[Step=30050 Epoch=115.7] | Loss=0.00058 | Reg=0.00179 | L2-Norm=13.371 | L2-Norm(final)=3.596 | acc=1.0000 | 4561.4 samples/s | 71.3 steps/s
[Step=30100 Epoch=115.9] | Loss=0.00052 | Reg=0.00179 | L2-Norm=13.369 | L2-Norm(final)=3.596 | acc=1.0000 | 5108.3 samples/s | 79.8 steps/s
[Step=30150 Epoch=116.1] | Loss=0.00047 | Reg=0.00179 | L2-Norm=13.367 | L2-Norm(final)=3.597 | acc=1.0000 | 1955.7 samples/s | 30.6 steps/s
[Step=30200 Epoch=116.3] | Loss=0.00044 | Reg=0.00179 | L2-Norm=13.365 | L2-Norm(final)=3.597 | acc=1.0000 | 4109.7 samples/s | 64.2 steps/s
[Step=30250 Epoch=116.4] | Loss=0.00040 | Reg=0.00179 | L2-Norm=13.363 | L2-Norm(final)=3.597 | acc=1.0000 | 4436.4 samples/s | 69.3 steps/s
[Step=30300 Epoch=116.6] | Loss=0.00037 | Reg=0.00178 | L2-Norm=13.360 | L2-Norm(final)=3.597 | acc=1.0000 | 4460.4 samples/s | 69.7 steps/s
[Step=30350 Epoch=116.8] | Loss=0.00035 | Reg=0.00178 | L2-Norm=13.358 | L2-Norm(final)=3.597 | acc=1.0000 | 4613.8 samples/s | 72.1 steps/s
[Step=30400 Epoch=117.0] | Loss=0.00033 | Reg=0.00178 | L2-Norm=13.356 | L2-Norm(final)=3.598 | acc=1.0000 | 2090.3 samples/s | 32.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27752 | acc=0.8648 | tpr=0.8075 | fpr=0.0109 | 4132.4 samples/s | 16.1 steps/s
Avg test loss: 0.28288, Avg test acc: 0.86345, Avg tpr: 0.80661, Avg fpr: 0.01154, total FA: 90

Testing server on iccad2012
[Step=  50] | Loss=0.34974 | acc=0.9155 | tpr=0.9469 | fpr=0.0851 | 4336.7 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.34934 | acc=0.9163 | tpr=0.9616 | fpr=0.0846 | 8224.9 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.35206 | acc=0.9160 | tpr=0.9697 | fpr=0.0850 | 7886.5 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.35336 | acc=0.9163 | tpr=0.9716 | fpr=0.0847 | 8450.2 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.35150 | acc=0.9165 | tpr=0.9738 | fpr=0.0846 | 8250.3 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.35565 | acc=0.9164 | tpr=0.9745 | fpr=0.0846 | 8253.2 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.35965 | acc=0.9161 | tpr=0.9737 | fpr=0.0849 | 7687.0 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.36231 | acc=0.9160 | tpr=0.9716 | fpr=0.0850 | 8571.0 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.36738 | acc=0.9157 | tpr=0.9703 | fpr=0.0853 | 8126.2 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.36723 | acc=0.9155 | tpr=0.9709 | fpr=0.0855 | 8385.9 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.36642 | acc=0.9156 | tpr=0.9710 | fpr=0.0854 | 14549.4 samples/s | 56.8 steps/s
Avg test loss: 0.36610, Avg test acc: 0.91559, Avg tpr: 0.97068, Avg fpr: 0.08541, total FA: 11859

server round 38/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=59.3] | Loss=0.15923 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=3.620 | acc=0.8438 | 4206.7 samples/s | 65.7 steps/s
[Step=30450 Epoch=59.4] | Loss=0.02161 | Reg=0.00179 | L2-Norm=13.363 | L2-Norm(final)=3.615 | acc=1.0000 | 4202.0 samples/s | 65.7 steps/s
[Step=30500 Epoch=59.5] | Loss=0.01469 | Reg=0.00179 | L2-Norm=13.368 | L2-Norm(final)=3.616 | acc=1.0000 | 4754.4 samples/s | 74.3 steps/s
[Step=30550 Epoch=59.6] | Loss=0.01253 | Reg=0.00179 | L2-Norm=13.370 | L2-Norm(final)=3.617 | acc=1.0000 | 4759.8 samples/s | 74.4 steps/s
[Step=30600 Epoch=59.7] | Loss=0.01078 | Reg=0.00179 | L2-Norm=13.372 | L2-Norm(final)=3.619 | acc=1.0000 | 4713.6 samples/s | 73.7 steps/s
[Step=30650 Epoch=59.8] | Loss=0.00971 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=3.621 | acc=0.9844 | 4757.9 samples/s | 74.3 steps/s
[Step=30700 Epoch=59.9] | Loss=0.00940 | Reg=0.00179 | L2-Norm=13.375 | L2-Norm(final)=3.623 | acc=1.0000 | 4828.1 samples/s | 75.4 steps/s
[Step=30750 Epoch=60.0] | Loss=0.00901 | Reg=0.00179 | L2-Norm=13.376 | L2-Norm(final)=3.625 | acc=1.0000 | 4712.5 samples/s | 73.6 steps/s
[Step=30800 Epoch=60.1] | Loss=0.00851 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=3.627 | acc=1.0000 | 4609.1 samples/s | 72.0 steps/s
[Step=30850 Epoch=60.2] | Loss=0.00821 | Reg=0.00179 | L2-Norm=13.378 | L2-Norm(final)=3.629 | acc=1.0000 | 4429.4 samples/s | 69.2 steps/s
[Step=30900 Epoch=60.3] | Loss=0.00798 | Reg=0.00179 | L2-Norm=13.379 | L2-Norm(final)=3.631 | acc=0.9844 | 5621.7 samples/s | 87.8 steps/s
[Step=30950 Epoch=60.4] | Loss=0.00773 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.632 | acc=1.0000 | 1942.1 samples/s | 30.3 steps/s
[Step=31000 Epoch=60.5] | Loss=0.00757 | Reg=0.00179 | L2-Norm=13.381 | L2-Norm(final)=3.634 | acc=1.0000 | 4741.4 samples/s | 74.1 steps/s
[Step=31050 Epoch=60.6] | Loss=0.00756 | Reg=0.00179 | L2-Norm=13.382 | L2-Norm(final)=3.636 | acc=0.9844 | 4817.1 samples/s | 75.3 steps/s
[Step=31100 Epoch=60.7] | Loss=0.00739 | Reg=0.00179 | L2-Norm=13.383 | L2-Norm(final)=3.638 | acc=1.0000 | 4769.2 samples/s | 74.5 steps/s
[Step=31150 Epoch=60.8] | Loss=0.00730 | Reg=0.00179 | L2-Norm=13.384 | L2-Norm(final)=3.639 | acc=1.0000 | 4747.8 samples/s | 74.2 steps/s
[Step=31200 Epoch=60.9] | Loss=0.00722 | Reg=0.00179 | L2-Norm=13.385 | L2-Norm(final)=3.641 | acc=1.0000 | 4707.6 samples/s | 73.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step31200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=59.4] | Loss=0.14186 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=3.620 | acc=0.9531 | 4037.3 samples/s | 63.1 steps/s
[Step=30450 Epoch=59.5] | Loss=0.02029 | Reg=0.00179 | L2-Norm=13.361 | L2-Norm(final)=3.613 | acc=1.0000 | 4177.1 samples/s | 65.3 steps/s
[Step=30500 Epoch=59.6] | Loss=0.01359 | Reg=0.00179 | L2-Norm=13.366 | L2-Norm(final)=3.615 | acc=0.9844 | 4781.1 samples/s | 74.7 steps/s
[Step=30550 Epoch=59.7] | Loss=0.01072 | Reg=0.00179 | L2-Norm=13.368 | L2-Norm(final)=3.617 | acc=1.0000 | 4725.6 samples/s | 73.8 steps/s
[Step=30600 Epoch=59.8] | Loss=0.00994 | Reg=0.00179 | L2-Norm=13.369 | L2-Norm(final)=3.619 | acc=1.0000 | 4767.9 samples/s | 74.5 steps/s
[Step=30650 Epoch=59.9] | Loss=0.00906 | Reg=0.00179 | L2-Norm=13.370 | L2-Norm(final)=3.620 | acc=1.0000 | 4633.5 samples/s | 72.4 steps/s
[Step=30700 Epoch=60.0] | Loss=0.00906 | Reg=0.00179 | L2-Norm=13.372 | L2-Norm(final)=3.622 | acc=0.9688 | 4671.2 samples/s | 73.0 steps/s
[Step=30750 Epoch=60.1] | Loss=0.00885 | Reg=0.00179 | L2-Norm=13.372 | L2-Norm(final)=3.624 | acc=1.0000 | 4737.6 samples/s | 74.0 steps/s
[Step=30800 Epoch=60.2] | Loss=0.00857 | Reg=0.00179 | L2-Norm=13.373 | L2-Norm(final)=3.625 | acc=1.0000 | 4754.2 samples/s | 74.3 steps/s
[Step=30850 Epoch=60.3] | Loss=0.00852 | Reg=0.00179 | L2-Norm=13.374 | L2-Norm(final)=3.627 | acc=0.9688 | 4609.6 samples/s | 72.0 steps/s
[Step=30900 Epoch=60.4] | Loss=0.00822 | Reg=0.00179 | L2-Norm=13.375 | L2-Norm(final)=3.629 | acc=1.0000 | 5406.5 samples/s | 84.5 steps/s
[Step=30950 Epoch=60.5] | Loss=0.00783 | Reg=0.00179 | L2-Norm=13.376 | L2-Norm(final)=3.630 | acc=0.9844 | 1991.1 samples/s | 31.1 steps/s
[Step=31000 Epoch=60.6] | Loss=0.00752 | Reg=0.00179 | L2-Norm=13.377 | L2-Norm(final)=3.632 | acc=1.0000 | 4753.8 samples/s | 74.3 steps/s
[Step=31050 Epoch=60.7] | Loss=0.00735 | Reg=0.00179 | L2-Norm=13.378 | L2-Norm(final)=3.634 | acc=0.9844 | 4794.8 samples/s | 74.9 steps/s
[Step=31100 Epoch=60.8] | Loss=0.00724 | Reg=0.00179 | L2-Norm=13.379 | L2-Norm(final)=3.635 | acc=0.9844 | 4702.2 samples/s | 73.5 steps/s
[Step=31150 Epoch=60.9] | Loss=0.00714 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.637 | acc=0.9844 | 4822.4 samples/s | 75.3 steps/s
[Step=31200 Epoch=61.0] | Loss=0.00701 | Reg=0.00179 | L2-Norm=13.380 | L2-Norm(final)=3.638 | acc=1.0000 | 4795.0 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step31200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=116.5] | Loss=0.01779 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=3.621 | acc=0.9844 | 3954.0 samples/s | 61.8 steps/s
[Step=30450 Epoch=116.7] | Loss=0.00071 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=3.628 | acc=1.0000 | 3902.8 samples/s | 61.0 steps/s
[Step=30500 Epoch=116.9] | Loss=0.00040 | Reg=0.00178 | L2-Norm=13.359 | L2-Norm(final)=3.630 | acc=1.0000 | 4440.5 samples/s | 69.4 steps/s
[Step=30550 Epoch=117.1] | Loss=0.00027 | Reg=0.00178 | L2-Norm=13.358 | L2-Norm(final)=3.632 | acc=1.0000 | 4496.4 samples/s | 70.3 steps/s
[Step=30600 Epoch=117.2] | Loss=0.00021 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=3.633 | acc=1.0000 | 4510.2 samples/s | 70.5 steps/s
[Step=30650 Epoch=117.4] | Loss=0.00017 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=3.633 | acc=1.0000 | 5708.9 samples/s | 89.2 steps/s
[Step=30700 Epoch=117.6] | Loss=0.00014 | Reg=0.00178 | L2-Norm=13.352 | L2-Norm(final)=3.634 | acc=1.0000 | 1931.4 samples/s | 30.2 steps/s
[Step=30750 Epoch=117.8] | Loss=0.00012 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.634 | acc=1.0000 | 4514.7 samples/s | 70.5 steps/s
[Step=30800 Epoch=118.0] | Loss=0.00011 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=3.634 | acc=1.0000 | 4419.2 samples/s | 69.0 steps/s
[Step=30850 Epoch=118.2] | Loss=0.00009 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=3.634 | acc=1.0000 | 4213.0 samples/s | 65.8 steps/s
[Step=30900 Epoch=118.4] | Loss=0.00009 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.635 | acc=1.0000 | 4740.8 samples/s | 74.1 steps/s
[Step=30950 Epoch=118.6] | Loss=0.00008 | Reg=0.00178 | L2-Norm=13.338 | L2-Norm(final)=3.635 | acc=1.0000 | 2026.4 samples/s | 31.7 steps/s
[Step=31000 Epoch=118.8] | Loss=0.00007 | Reg=0.00178 | L2-Norm=13.335 | L2-Norm(final)=3.635 | acc=1.0000 | 4550.0 samples/s | 71.1 steps/s
[Step=31050 Epoch=119.0] | Loss=0.00007 | Reg=0.00178 | L2-Norm=13.333 | L2-Norm(final)=3.635 | acc=1.0000 | 4547.1 samples/s | 71.0 steps/s
[Step=31100 Epoch=119.2] | Loss=0.00006 | Reg=0.00178 | L2-Norm=13.330 | L2-Norm(final)=3.635 | acc=1.0000 | 4490.4 samples/s | 70.2 steps/s
[Step=31150 Epoch=119.4] | Loss=0.00006 | Reg=0.00178 | L2-Norm=13.327 | L2-Norm(final)=3.636 | acc=1.0000 | 4534.3 samples/s | 70.8 steps/s
[Step=31200 Epoch=119.5] | Loss=0.00005 | Reg=0.00178 | L2-Norm=13.324 | L2-Norm(final)=3.636 | acc=1.0000 | 2007.7 samples/s | 31.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step31200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=117.0] | Loss=0.00263 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=3.621 | acc=1.0000 | 4188.9 samples/s | 65.5 steps/s
[Step=30450 Epoch=117.2] | Loss=0.00195 | Reg=0.00179 | L2-Norm=13.363 | L2-Norm(final)=3.628 | acc=1.0000 | 4126.9 samples/s | 64.5 steps/s
[Step=30500 Epoch=117.4] | Loss=0.00098 | Reg=0.00179 | L2-Norm=13.365 | L2-Norm(final)=3.628 | acc=1.0000 | 4538.9 samples/s | 70.9 steps/s
[Step=30550 Epoch=117.6] | Loss=0.00067 | Reg=0.00179 | L2-Norm=13.364 | L2-Norm(final)=3.629 | acc=1.0000 | 4515.3 samples/s | 70.6 steps/s
[Step=30600 Epoch=117.8] | Loss=0.00051 | Reg=0.00179 | L2-Norm=13.363 | L2-Norm(final)=3.630 | acc=1.0000 | 4549.9 samples/s | 71.1 steps/s
[Step=30650 Epoch=118.0] | Loss=0.00041 | Reg=0.00179 | L2-Norm=13.361 | L2-Norm(final)=3.630 | acc=1.0000 | 5684.5 samples/s | 88.8 steps/s
[Step=30700 Epoch=118.2] | Loss=0.00034 | Reg=0.00178 | L2-Norm=13.359 | L2-Norm(final)=3.630 | acc=1.0000 | 1885.3 samples/s | 29.5 steps/s
[Step=30750 Epoch=118.4] | Loss=0.00029 | Reg=0.00178 | L2-Norm=13.357 | L2-Norm(final)=3.630 | acc=1.0000 | 4117.9 samples/s | 64.3 steps/s
[Step=30800 Epoch=118.6] | Loss=0.00026 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=3.631 | acc=1.0000 | 4394.2 samples/s | 68.7 steps/s
[Step=30850 Epoch=118.8] | Loss=0.00023 | Reg=0.00178 | L2-Norm=13.352 | L2-Norm(final)=3.631 | acc=1.0000 | 4484.4 samples/s | 70.1 steps/s
[Step=30900 Epoch=118.9] | Loss=0.00021 | Reg=0.00178 | L2-Norm=13.350 | L2-Norm(final)=3.631 | acc=1.0000 | 5101.4 samples/s | 79.7 steps/s
[Step=30950 Epoch=119.1] | Loss=0.00019 | Reg=0.00178 | L2-Norm=13.348 | L2-Norm(final)=3.631 | acc=1.0000 | 1990.7 samples/s | 31.1 steps/s
[Step=31000 Epoch=119.3] | Loss=0.00017 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.631 | acc=1.0000 | 4526.9 samples/s | 70.7 steps/s
[Step=31050 Epoch=119.5] | Loss=0.00016 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=3.631 | acc=1.0000 | 4532.3 samples/s | 70.8 steps/s
[Step=31100 Epoch=119.7] | Loss=0.00015 | Reg=0.00178 | L2-Norm=13.340 | L2-Norm(final)=3.632 | acc=1.0000 | 4331.6 samples/s | 67.7 steps/s
[Step=31150 Epoch=119.9] | Loss=0.00014 | Reg=0.00178 | L2-Norm=13.337 | L2-Norm(final)=3.632 | acc=1.0000 | 4218.5 samples/s | 65.9 steps/s
[Step=31200 Epoch=120.1] | Loss=0.00013 | Reg=0.00178 | L2-Norm=13.335 | L2-Norm(final)=3.632 | acc=1.0000 | 2081.8 samples/s | 32.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19379 | acc=0.9009 | tpr=0.8616 | fpr=0.0136 | 4472.7 samples/s | 17.5 steps/s
Avg test loss: 0.19999, Avg test acc: 0.90103, Avg tpr: 0.86291, Avg fpr: 0.01513, total FA: 118

Testing server on iccad2012
[Step=  50] | Loss=0.43863 | acc=0.8915 | tpr=0.9513 | fpr=0.1096 | 4331.8 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.43757 | acc=0.8928 | tpr=0.9680 | fpr=0.1086 | 8174.9 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.44127 | acc=0.8926 | tpr=0.9755 | fpr=0.1090 | 8341.6 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.44221 | acc=0.8927 | tpr=0.9760 | fpr=0.1088 | 7772.7 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.43966 | acc=0.8931 | tpr=0.9782 | fpr=0.1084 | 8129.8 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.44394 | acc=0.8931 | tpr=0.9782 | fpr=0.1084 | 8357.4 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.44833 | acc=0.8929 | tpr=0.9775 | fpr=0.1086 | 8456.1 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.45074 | acc=0.8930 | tpr=0.9759 | fpr=0.1085 | 8060.9 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.45599 | acc=0.8926 | tpr=0.9742 | fpr=0.1089 | 7756.3 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.45601 | acc=0.8925 | tpr=0.9749 | fpr=0.1090 | 5142.5 samples/s | 20.1 steps/s
[Step= 550] | Loss=0.45500 | acc=0.8926 | tpr=0.9749 | fpr=0.1089 | 14343.0 samples/s | 56.0 steps/s
Avg test loss: 0.45477, Avg test acc: 0.89252, Avg tpr: 0.97464, Avg fpr: 0.10898, total FA: 15131

server round 39/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=60.9] | Loss=0.10711 | Reg=0.00177 | L2-Norm=13.321 | L2-Norm(final)=3.649 | acc=0.9375 | 4036.0 samples/s | 63.1 steps/s
[Step=31250 Epoch=60.9] | Loss=0.01556 | Reg=0.00178 | L2-Norm=13.334 | L2-Norm(final)=3.647 | acc=1.0000 | 4151.0 samples/s | 64.9 steps/s
[Step=31300 Epoch=61.0] | Loss=0.01241 | Reg=0.00178 | L2-Norm=13.337 | L2-Norm(final)=3.647 | acc=0.9844 | 4426.4 samples/s | 69.2 steps/s
[Step=31350 Epoch=61.1] | Loss=0.01024 | Reg=0.00178 | L2-Norm=13.340 | L2-Norm(final)=3.649 | acc=0.9844 | 4493.8 samples/s | 70.2 steps/s
[Step=31400 Epoch=61.2] | Loss=0.00887 | Reg=0.00178 | L2-Norm=13.342 | L2-Norm(final)=3.651 | acc=1.0000 | 4764.9 samples/s | 74.5 steps/s
[Step=31450 Epoch=61.3] | Loss=0.00851 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=3.653 | acc=1.0000 | 4823.3 samples/s | 75.4 steps/s
[Step=31500 Epoch=61.4] | Loss=0.00840 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.655 | acc=0.9844 | 4793.6 samples/s | 74.9 steps/s
[Step=31550 Epoch=61.5] | Loss=0.00825 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=3.657 | acc=1.0000 | 4777.0 samples/s | 74.6 steps/s
[Step=31600 Epoch=61.6] | Loss=0.00795 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=3.658 | acc=0.9844 | 4809.3 samples/s | 75.1 steps/s
[Step=31650 Epoch=61.7] | Loss=0.00793 | Reg=0.00178 | L2-Norm=13.348 | L2-Norm(final)=3.659 | acc=1.0000 | 4777.6 samples/s | 74.6 steps/s
[Step=31700 Epoch=61.8] | Loss=0.00791 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.661 | acc=1.0000 | 5611.8 samples/s | 87.7 steps/s
[Step=31750 Epoch=61.9] | Loss=0.00766 | Reg=0.00178 | L2-Norm=13.350 | L2-Norm(final)=3.662 | acc=1.0000 | 1911.2 samples/s | 29.9 steps/s
[Step=31800 Epoch=62.0] | Loss=0.00746 | Reg=0.00178 | L2-Norm=13.351 | L2-Norm(final)=3.663 | acc=1.0000 | 4774.1 samples/s | 74.6 steps/s
[Step=31850 Epoch=62.1] | Loss=0.00739 | Reg=0.00178 | L2-Norm=13.352 | L2-Norm(final)=3.665 | acc=0.9844 | 4765.2 samples/s | 74.5 steps/s
[Step=31900 Epoch=62.2] | Loss=0.00720 | Reg=0.00178 | L2-Norm=13.353 | L2-Norm(final)=3.666 | acc=1.0000 | 4795.1 samples/s | 74.9 steps/s
[Step=31950 Epoch=62.3] | Loss=0.00711 | Reg=0.00178 | L2-Norm=13.354 | L2-Norm(final)=3.668 | acc=1.0000 | 4746.3 samples/s | 74.2 steps/s
[Step=32000 Epoch=62.4] | Loss=0.00707 | Reg=0.00178 | L2-Norm=13.355 | L2-Norm(final)=3.669 | acc=1.0000 | 4806.2 samples/s | 75.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=61.0] | Loss=0.13639 | Reg=0.00177 | L2-Norm=13.321 | L2-Norm(final)=3.648 | acc=0.9375 | 4138.5 samples/s | 64.7 steps/s
[Step=31250 Epoch=61.1] | Loss=0.01733 | Reg=0.00178 | L2-Norm=13.335 | L2-Norm(final)=3.644 | acc=0.9844 | 4587.9 samples/s | 71.7 steps/s
[Step=31300 Epoch=61.2] | Loss=0.01152 | Reg=0.00178 | L2-Norm=13.339 | L2-Norm(final)=3.647 | acc=1.0000 | 4411.9 samples/s | 68.9 steps/s
[Step=31350 Epoch=61.3] | Loss=0.01054 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.649 | acc=0.9688 | 4469.6 samples/s | 69.8 steps/s
[Step=31400 Epoch=61.4] | Loss=0.00913 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=3.651 | acc=1.0000 | 4649.5 samples/s | 72.6 steps/s
[Step=31450 Epoch=61.5] | Loss=0.00844 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=3.653 | acc=1.0000 | 4823.0 samples/s | 75.4 steps/s
[Step=31500 Epoch=61.6] | Loss=0.00778 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=3.655 | acc=1.0000 | 4800.2 samples/s | 75.0 steps/s
[Step=31550 Epoch=61.7] | Loss=0.00781 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.657 | acc=1.0000 | 4769.4 samples/s | 74.5 steps/s
[Step=31600 Epoch=61.8] | Loss=0.00759 | Reg=0.00178 | L2-Norm=13.346 | L2-Norm(final)=3.658 | acc=1.0000 | 4783.9 samples/s | 74.7 steps/s
[Step=31650 Epoch=61.9] | Loss=0.00747 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=3.660 | acc=0.9844 | 4757.2 samples/s | 74.3 steps/s
[Step=31700 Epoch=62.0] | Loss=0.00731 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=3.662 | acc=1.0000 | 5892.0 samples/s | 92.1 steps/s
[Step=31750 Epoch=62.1] | Loss=0.00710 | Reg=0.00178 | L2-Norm=13.348 | L2-Norm(final)=3.663 | acc=1.0000 | 1905.8 samples/s | 29.8 steps/s
[Step=31800 Epoch=62.2] | Loss=0.00696 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.665 | acc=1.0000 | 4603.3 samples/s | 71.9 steps/s
[Step=31850 Epoch=62.3] | Loss=0.00698 | Reg=0.00178 | L2-Norm=13.349 | L2-Norm(final)=3.667 | acc=1.0000 | 4725.1 samples/s | 73.8 steps/s
[Step=31900 Epoch=62.4] | Loss=0.00683 | Reg=0.00178 | L2-Norm=13.350 | L2-Norm(final)=3.669 | acc=1.0000 | 4716.8 samples/s | 73.7 steps/s
[Step=31950 Epoch=62.5] | Loss=0.00669 | Reg=0.00178 | L2-Norm=13.350 | L2-Norm(final)=3.670 | acc=1.0000 | 4656.9 samples/s | 72.8 steps/s
[Step=32000 Epoch=62.6] | Loss=0.00661 | Reg=0.00178 | L2-Norm=13.351 | L2-Norm(final)=3.672 | acc=0.9844 | 4782.3 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step32000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=119.6] | Loss=0.07257 | Reg=0.00177 | L2-Norm=13.321 | L2-Norm(final)=3.649 | acc=0.9844 | 4403.0 samples/s | 68.8 steps/s
[Step=31250 Epoch=119.7] | Loss=0.00382 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=3.649 | acc=1.0000 | 3891.5 samples/s | 60.8 steps/s
[Step=31300 Epoch=119.9] | Loss=0.00197 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=3.649 | acc=1.0000 | 4400.3 samples/s | 68.8 steps/s
[Step=31350 Epoch=120.1] | Loss=0.00132 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=3.649 | acc=1.0000 | 4037.2 samples/s | 63.1 steps/s
[Step=31400 Epoch=120.3] | Loss=0.00099 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.649 | acc=1.0000 | 4356.6 samples/s | 68.1 steps/s
[Step=31450 Epoch=120.5] | Loss=0.00080 | Reg=0.00178 | L2-Norm=13.344 | L2-Norm(final)=3.650 | acc=1.0000 | 5721.7 samples/s | 89.4 steps/s
[Step=31500 Epoch=120.7] | Loss=0.00067 | Reg=0.00178 | L2-Norm=13.342 | L2-Norm(final)=3.650 | acc=1.0000 | 1927.0 samples/s | 30.1 steps/s
[Step=31550 Epoch=120.9] | Loss=0.00057 | Reg=0.00178 | L2-Norm=13.339 | L2-Norm(final)=3.650 | acc=1.0000 | 4506.0 samples/s | 70.4 steps/s
[Step=31600 Epoch=121.1] | Loss=0.00050 | Reg=0.00178 | L2-Norm=13.337 | L2-Norm(final)=3.651 | acc=1.0000 | 4493.6 samples/s | 70.2 steps/s
[Step=31650 Epoch=121.3] | Loss=0.00045 | Reg=0.00178 | L2-Norm=13.335 | L2-Norm(final)=3.651 | acc=1.0000 | 4587.6 samples/s | 71.7 steps/s
[Step=31700 Epoch=121.5] | Loss=0.00040 | Reg=0.00178 | L2-Norm=13.332 | L2-Norm(final)=3.651 | acc=1.0000 | 4787.0 samples/s | 74.8 steps/s
[Step=31750 Epoch=121.7] | Loss=0.00037 | Reg=0.00178 | L2-Norm=13.330 | L2-Norm(final)=3.651 | acc=1.0000 | 1962.2 samples/s | 30.7 steps/s
[Step=31800 Epoch=121.8] | Loss=0.00034 | Reg=0.00178 | L2-Norm=13.327 | L2-Norm(final)=3.652 | acc=1.0000 | 4540.4 samples/s | 70.9 steps/s
[Step=31850 Epoch=122.0] | Loss=0.00031 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=3.652 | acc=1.0000 | 4499.6 samples/s | 70.3 steps/s
[Step=31900 Epoch=122.2] | Loss=0.00029 | Reg=0.00177 | L2-Norm=13.322 | L2-Norm(final)=3.652 | acc=1.0000 | 4532.3 samples/s | 70.8 steps/s
[Step=31950 Epoch=122.4] | Loss=0.00027 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=3.652 | acc=1.0000 | 4504.2 samples/s | 70.4 steps/s
[Step=32000 Epoch=122.6] | Loss=0.00025 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=3.652 | acc=1.0000 | 2099.8 samples/s | 32.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=120.1] | Loss=0.10532 | Reg=0.00177 | L2-Norm=13.321 | L2-Norm(final)=3.649 | acc=0.9531 | 3902.9 samples/s | 61.0 steps/s
[Step=31250 Epoch=120.3] | Loss=0.00310 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.653 | acc=1.0000 | 3950.7 samples/s | 61.7 steps/s
[Step=31300 Epoch=120.5] | Loss=0.00162 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=3.654 | acc=1.0000 | 4482.8 samples/s | 70.0 steps/s
[Step=31350 Epoch=120.7] | Loss=0.00109 | Reg=0.00178 | L2-Norm=13.347 | L2-Norm(final)=3.655 | acc=1.0000 | 4522.3 samples/s | 70.7 steps/s
[Step=31400 Epoch=120.9] | Loss=0.00082 | Reg=0.00178 | L2-Norm=13.345 | L2-Norm(final)=3.656 | acc=1.0000 | 4533.5 samples/s | 70.8 steps/s
[Step=31450 Epoch=121.1] | Loss=0.00066 | Reg=0.00178 | L2-Norm=13.343 | L2-Norm(final)=3.656 | acc=1.0000 | 5782.3 samples/s | 90.3 steps/s
[Step=31500 Epoch=121.3] | Loss=0.00055 | Reg=0.00178 | L2-Norm=13.341 | L2-Norm(final)=3.656 | acc=1.0000 | 1921.1 samples/s | 30.0 steps/s
[Step=31550 Epoch=121.4] | Loss=0.00047 | Reg=0.00178 | L2-Norm=13.338 | L2-Norm(final)=3.657 | acc=1.0000 | 4418.5 samples/s | 69.0 steps/s
[Step=31600 Epoch=121.6] | Loss=0.00041 | Reg=0.00178 | L2-Norm=13.336 | L2-Norm(final)=3.657 | acc=1.0000 | 4332.6 samples/s | 67.7 steps/s
[Step=31650 Epoch=121.8] | Loss=0.00037 | Reg=0.00178 | L2-Norm=13.333 | L2-Norm(final)=3.657 | acc=1.0000 | 4066.8 samples/s | 63.5 steps/s
[Step=31700 Epoch=122.0] | Loss=0.00033 | Reg=0.00178 | L2-Norm=13.330 | L2-Norm(final)=3.657 | acc=1.0000 | 5028.8 samples/s | 78.6 steps/s
[Step=31750 Epoch=122.2] | Loss=0.00030 | Reg=0.00178 | L2-Norm=13.328 | L2-Norm(final)=3.657 | acc=1.0000 | 2009.7 samples/s | 31.4 steps/s
[Step=31800 Epoch=122.4] | Loss=0.00028 | Reg=0.00178 | L2-Norm=13.325 | L2-Norm(final)=3.658 | acc=1.0000 | 4425.8 samples/s | 69.2 steps/s
[Step=31850 Epoch=122.6] | Loss=0.00026 | Reg=0.00177 | L2-Norm=13.322 | L2-Norm(final)=3.658 | acc=1.0000 | 4320.0 samples/s | 67.5 steps/s
[Step=31900 Epoch=122.8] | Loss=0.00024 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=3.658 | acc=1.0000 | 4483.8 samples/s | 70.1 steps/s
[Step=31950 Epoch=123.0] | Loss=0.00022 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.658 | acc=1.0000 | 4604.2 samples/s | 71.9 steps/s
[Step=32000 Epoch=123.2] | Loss=0.00021 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.658 | acc=1.0000 | 1984.6 samples/s | 31.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23292 | acc=0.8838 | tpr=0.8359 | fpr=0.0121 | 4313.2 samples/s | 16.8 steps/s
Avg test loss: 0.23847, Avg test acc: 0.88425, Avg tpr: 0.83756, Avg fpr: 0.01308, total FA: 102

Testing server on iccad2012
[Step=  50] | Loss=0.39473 | acc=0.9041 | tpr=0.9513 | fpr=0.0967 | 4138.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.39482 | acc=0.9054 | tpr=0.9659 | fpr=0.0957 | 6795.2 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.39825 | acc=0.9047 | tpr=0.9741 | fpr=0.0966 | 8178.2 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.39951 | acc=0.9048 | tpr=0.9749 | fpr=0.0965 | 8172.0 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.39715 | acc=0.9050 | tpr=0.9773 | fpr=0.0963 | 7155.8 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.40168 | acc=0.9047 | tpr=0.9775 | fpr=0.0966 | 6815.8 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.40593 | acc=0.9043 | tpr=0.9762 | fpr=0.0970 | 8016.2 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.40831 | acc=0.9042 | tpr=0.9737 | fpr=0.0971 | 8377.9 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.41322 | acc=0.9038 | tpr=0.9722 | fpr=0.0974 | 7552.9 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.41317 | acc=0.9038 | tpr=0.9727 | fpr=0.0975 | 8242.5 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.41237 | acc=0.9040 | tpr=0.9725 | fpr=0.0973 | 15037.8 samples/s | 58.7 steps/s
Avg test loss: 0.41210, Avg test acc: 0.90396, Avg tpr: 0.97227, Avg fpr: 0.09728, total FA: 13507

server round 40/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=62.4] | Loss=0.18860 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.676 | acc=0.8594 | 3675.5 samples/s | 57.4 steps/s
[Step=32050 Epoch=62.5] | Loss=0.02004 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.673 | acc=1.0000 | 4573.9 samples/s | 71.5 steps/s
[Step=32100 Epoch=62.6] | Loss=0.01407 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.673 | acc=1.0000 | 4610.8 samples/s | 72.0 steps/s
[Step=32150 Epoch=62.7] | Loss=0.01152 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.674 | acc=1.0000 | 4436.6 samples/s | 69.3 steps/s
[Step=32200 Epoch=62.8] | Loss=0.01025 | Reg=0.00177 | L2-Norm=13.312 | L2-Norm(final)=3.675 | acc=1.0000 | 4484.8 samples/s | 70.1 steps/s
[Step=32250 Epoch=62.9] | Loss=0.00891 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.676 | acc=0.9844 | 4765.3 samples/s | 74.5 steps/s
[Step=32300 Epoch=63.0] | Loss=0.00829 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.678 | acc=1.0000 | 4803.2 samples/s | 75.1 steps/s
[Step=32350 Epoch=63.1] | Loss=0.00791 | Reg=0.00177 | L2-Norm=13.314 | L2-Norm(final)=3.679 | acc=0.9844 | 4824.4 samples/s | 75.4 steps/s
[Step=32400 Epoch=63.2] | Loss=0.00764 | Reg=0.00177 | L2-Norm=13.315 | L2-Norm(final)=3.680 | acc=0.9844 | 4831.6 samples/s | 75.5 steps/s
[Step=32450 Epoch=63.3] | Loss=0.00736 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.681 | acc=0.9844 | 4729.1 samples/s | 73.9 steps/s
[Step=32500 Epoch=63.4] | Loss=0.00729 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.683 | acc=1.0000 | 5762.7 samples/s | 90.0 steps/s
[Step=32550 Epoch=63.5] | Loss=0.00712 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=3.684 | acc=1.0000 | 1941.1 samples/s | 30.3 steps/s
[Step=32600 Epoch=63.6] | Loss=0.00694 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=3.685 | acc=1.0000 | 4359.5 samples/s | 68.1 steps/s
[Step=32650 Epoch=63.7] | Loss=0.00677 | Reg=0.00177 | L2-Norm=13.318 | L2-Norm(final)=3.686 | acc=1.0000 | 4575.2 samples/s | 71.5 steps/s
[Step=32700 Epoch=63.8] | Loss=0.00666 | Reg=0.00177 | L2-Norm=13.318 | L2-Norm(final)=3.687 | acc=1.0000 | 4749.2 samples/s | 74.2 steps/s
[Step=32750 Epoch=63.9] | Loss=0.00652 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=3.688 | acc=1.0000 | 4765.8 samples/s | 74.5 steps/s
[Step=32800 Epoch=64.0] | Loss=0.00647 | Reg=0.00177 | L2-Norm=13.319 | L2-Norm(final)=3.689 | acc=0.9844 | 4782.5 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=62.6] | Loss=0.18387 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.676 | acc=0.9062 | 4008.6 samples/s | 62.6 steps/s
[Step=32050 Epoch=62.7] | Loss=0.01974 | Reg=0.00177 | L2-Norm=13.306 | L2-Norm(final)=3.674 | acc=1.0000 | 4788.3 samples/s | 74.8 steps/s
[Step=32100 Epoch=62.8] | Loss=0.01397 | Reg=0.00177 | L2-Norm=13.308 | L2-Norm(final)=3.674 | acc=1.0000 | 4772.8 samples/s | 74.6 steps/s
[Step=32150 Epoch=62.9] | Loss=0.01134 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.675 | acc=1.0000 | 4669.9 samples/s | 73.0 steps/s
[Step=32200 Epoch=63.0] | Loss=0.01012 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.676 | acc=0.9844 | 4455.1 samples/s | 69.6 steps/s
[Step=32250 Epoch=63.0] | Loss=0.00916 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.678 | acc=1.0000 | 4573.9 samples/s | 71.5 steps/s
[Step=32300 Epoch=63.1] | Loss=0.00825 | Reg=0.00177 | L2-Norm=13.312 | L2-Norm(final)=3.679 | acc=0.9844 | 4770.0 samples/s | 74.5 steps/s
[Step=32350 Epoch=63.2] | Loss=0.00783 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.680 | acc=1.0000 | 4816.7 samples/s | 75.3 steps/s
[Step=32400 Epoch=63.3] | Loss=0.00748 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.681 | acc=1.0000 | 4834.5 samples/s | 75.5 steps/s
[Step=32450 Epoch=63.4] | Loss=0.00726 | Reg=0.00177 | L2-Norm=13.314 | L2-Norm(final)=3.683 | acc=1.0000 | 4728.0 samples/s | 73.9 steps/s
[Step=32500 Epoch=63.5] | Loss=0.00706 | Reg=0.00177 | L2-Norm=13.314 | L2-Norm(final)=3.684 | acc=1.0000 | 5886.7 samples/s | 92.0 steps/s
[Step=32550 Epoch=63.6] | Loss=0.00671 | Reg=0.00177 | L2-Norm=13.315 | L2-Norm(final)=3.685 | acc=1.0000 | 1989.6 samples/s | 31.1 steps/s
[Step=32600 Epoch=63.7] | Loss=0.00643 | Reg=0.00177 | L2-Norm=13.315 | L2-Norm(final)=3.686 | acc=0.9688 | 4703.0 samples/s | 73.5 steps/s
[Step=32650 Epoch=63.8] | Loss=0.00639 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.687 | acc=1.0000 | 4199.6 samples/s | 65.6 steps/s
[Step=32700 Epoch=63.9] | Loss=0.00621 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.688 | acc=1.0000 | 4571.3 samples/s | 71.4 steps/s
[Step=32750 Epoch=64.0] | Loss=0.00618 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=3.690 | acc=1.0000 | 4797.5 samples/s | 75.0 steps/s
[Step=32800 Epoch=64.1] | Loss=0.00609 | Reg=0.00177 | L2-Norm=13.317 | L2-Norm(final)=3.691 | acc=1.0000 | 4756.8 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step32800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=122.6] | Loss=0.00020 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.676 | acc=1.0000 | 4049.5 samples/s | 63.3 steps/s
[Step=32050 Epoch=122.8] | Loss=0.00429 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.681 | acc=1.0000 | 4172.1 samples/s | 65.2 steps/s
[Step=32100 Epoch=123.0] | Loss=0.00216 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.682 | acc=1.0000 | 4527.6 samples/s | 70.7 steps/s
[Step=32150 Epoch=123.2] | Loss=0.00144 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.682 | acc=1.0000 | 4529.5 samples/s | 70.8 steps/s
[Step=32200 Epoch=123.4] | Loss=0.00109 | Reg=0.00177 | L2-Norm=13.316 | L2-Norm(final)=3.682 | acc=1.0000 | 4324.9 samples/s | 67.6 steps/s
[Step=32250 Epoch=123.6] | Loss=0.00087 | Reg=0.00177 | L2-Norm=13.315 | L2-Norm(final)=3.682 | acc=1.0000 | 5107.2 samples/s | 79.8 steps/s
[Step=32300 Epoch=123.8] | Loss=0.00073 | Reg=0.00177 | L2-Norm=13.314 | L2-Norm(final)=3.682 | acc=1.0000 | 1917.0 samples/s | 30.0 steps/s
[Step=32350 Epoch=124.0] | Loss=0.00063 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.683 | acc=1.0000 | 4502.0 samples/s | 70.3 steps/s
[Step=32400 Epoch=124.1] | Loss=0.00055 | Reg=0.00177 | L2-Norm=13.312 | L2-Norm(final)=3.683 | acc=1.0000 | 4498.2 samples/s | 70.3 steps/s
[Step=32450 Epoch=124.3] | Loss=0.00049 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.683 | acc=1.0000 | 4485.5 samples/s | 70.1 steps/s
[Step=32500 Epoch=124.5] | Loss=0.00044 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.683 | acc=1.0000 | 5031.1 samples/s | 78.6 steps/s
[Step=32550 Epoch=124.7] | Loss=0.00040 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=3.683 | acc=1.0000 | 1976.1 samples/s | 30.9 steps/s
[Step=32600 Epoch=124.9] | Loss=0.00037 | Reg=0.00177 | L2-Norm=13.308 | L2-Norm(final)=3.683 | acc=1.0000 | 4055.8 samples/s | 63.4 steps/s
[Step=32650 Epoch=125.1] | Loss=0.00034 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.683 | acc=1.0000 | 4330.5 samples/s | 67.7 steps/s
[Step=32700 Epoch=125.3] | Loss=0.00032 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=3.683 | acc=1.0000 | 4517.2 samples/s | 70.6 steps/s
[Step=32750 Epoch=125.5] | Loss=0.00030 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.683 | acc=1.0000 | 4518.3 samples/s | 70.6 steps/s
[Step=32800 Epoch=125.7] | Loss=0.00028 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.683 | acc=1.0000 | 2109.4 samples/s | 33.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=123.2] | Loss=0.00292 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.676 | acc=1.0000 | 4163.2 samples/s | 65.1 steps/s
[Step=32050 Epoch=123.4] | Loss=0.00321 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=3.681 | acc=1.0000 | 4116.1 samples/s | 64.3 steps/s
[Step=32100 Epoch=123.6] | Loss=0.00162 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.682 | acc=1.0000 | 4241.0 samples/s | 66.3 steps/s
[Step=32150 Epoch=123.8] | Loss=0.00109 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.683 | acc=1.0000 | 4065.3 samples/s | 63.5 steps/s
[Step=32200 Epoch=124.0] | Loss=0.00082 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.683 | acc=1.0000 | 4540.1 samples/s | 70.9 steps/s
[Step=32250 Epoch=124.1] | Loss=0.00066 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=3.683 | acc=1.0000 | 5742.0 samples/s | 89.7 steps/s
[Step=32300 Epoch=124.3] | Loss=0.00055 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=3.684 | acc=1.0000 | 1914.0 samples/s | 29.9 steps/s
[Step=32350 Epoch=124.5] | Loss=0.00048 | Reg=0.00177 | L2-Norm=13.308 | L2-Norm(final)=3.684 | acc=1.0000 | 4550.6 samples/s | 71.1 steps/s
[Step=32400 Epoch=124.7] | Loss=0.00042 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.684 | acc=1.0000 | 4479.8 samples/s | 70.0 steps/s
[Step=32450 Epoch=124.9] | Loss=0.00037 | Reg=0.00177 | L2-Norm=13.306 | L2-Norm(final)=3.684 | acc=1.0000 | 4383.9 samples/s | 68.5 steps/s
[Step=32500 Epoch=125.1] | Loss=0.00034 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.684 | acc=1.0000 | 4902.7 samples/s | 76.6 steps/s
[Step=32550 Epoch=125.3] | Loss=0.00031 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.685 | acc=1.0000 | 1941.0 samples/s | 30.3 steps/s
[Step=32600 Epoch=125.5] | Loss=0.00028 | Reg=0.00177 | L2-Norm=13.302 | L2-Norm(final)=3.685 | acc=1.0000 | 4510.7 samples/s | 70.5 steps/s
[Step=32650 Epoch=125.7] | Loss=0.00026 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=3.685 | acc=1.0000 | 4536.3 samples/s | 70.9 steps/s
[Step=32700 Epoch=125.9] | Loss=0.00024 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.685 | acc=1.0000 | 4472.5 samples/s | 69.9 steps/s
[Step=32750 Epoch=126.1] | Loss=0.00023 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.685 | acc=1.0000 | 4590.5 samples/s | 71.7 steps/s
[Step=32800 Epoch=126.3] | Loss=0.00021 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.685 | acc=1.0000 | 2034.3 samples/s | 31.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20859 | acc=0.8977 | tpr=0.8568 | fpr=0.0134 | 3443.4 samples/s | 13.5 steps/s
Avg test loss: 0.21441, Avg test acc: 0.89735, Avg tpr: 0.85726, Avg fpr: 0.01449, total FA: 113

Testing server on iccad2012
[Step=  50] | Loss=0.41562 | acc=0.9001 | tpr=0.9558 | fpr=0.1009 | 3203.3 samples/s | 12.5 steps/s
[Step= 100] | Loss=0.41596 | acc=0.8995 | tpr=0.9680 | fpr=0.1018 | 8456.9 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.41880 | acc=0.8992 | tpr=0.9741 | fpr=0.1021 | 8203.8 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.41973 | acc=0.8995 | tpr=0.9749 | fpr=0.1019 | 8511.1 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.41710 | acc=0.8999 | tpr=0.9764 | fpr=0.1015 | 7709.4 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.42155 | acc=0.8997 | tpr=0.9767 | fpr=0.1017 | 8590.3 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.42560 | acc=0.8994 | tpr=0.9756 | fpr=0.1020 | 8222.9 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.42793 | acc=0.8993 | tpr=0.9737 | fpr=0.1020 | 8036.1 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.43297 | acc=0.8990 | tpr=0.9727 | fpr=0.1024 | 7797.3 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.43300 | acc=0.8990 | tpr=0.9736 | fpr=0.1023 | 8406.5 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.43226 | acc=0.8991 | tpr=0.9733 | fpr=0.1022 | 14948.2 samples/s | 58.4 steps/s
Avg test loss: 0.43193, Avg test acc: 0.89914, Avg tpr: 0.97306, Avg fpr: 0.10221, total FA: 14191

server round 41/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=64.0] | Loss=0.10527 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.696 | acc=0.9062 | 3828.3 samples/s | 59.8 steps/s
[Step=32850 Epoch=64.1] | Loss=0.01723 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.695 | acc=0.9688 | 4547.2 samples/s | 71.0 steps/s
[Step=32900 Epoch=64.2] | Loss=0.01102 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.696 | acc=1.0000 | 4592.6 samples/s | 71.8 steps/s
[Step=32950 Epoch=64.3] | Loss=0.00899 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=3.698 | acc=1.0000 | 4526.0 samples/s | 70.7 steps/s
[Step=33000 Epoch=64.4] | Loss=0.00833 | Reg=0.00177 | L2-Norm=13.306 | L2-Norm(final)=3.699 | acc=1.0000 | 4260.0 samples/s | 66.6 steps/s
[Step=33050 Epoch=64.5] | Loss=0.00791 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.700 | acc=0.9844 | 4720.9 samples/s | 73.8 steps/s
[Step=33100 Epoch=64.6] | Loss=0.00784 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.701 | acc=0.9844 | 4752.2 samples/s | 74.3 steps/s
[Step=33150 Epoch=64.7] | Loss=0.00753 | Reg=0.00177 | L2-Norm=13.308 | L2-Norm(final)=3.702 | acc=1.0000 | 4702.6 samples/s | 73.5 steps/s
[Step=33200 Epoch=64.8] | Loss=0.00737 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=3.703 | acc=1.0000 | 4784.3 samples/s | 74.8 steps/s
[Step=33250 Epoch=64.9] | Loss=0.00703 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=3.704 | acc=1.0000 | 4807.5 samples/s | 75.1 steps/s
[Step=33300 Epoch=64.9] | Loss=0.00674 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.705 | acc=1.0000 | 5734.8 samples/s | 89.6 steps/s
[Step=33350 Epoch=65.0] | Loss=0.00650 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.706 | acc=1.0000 | 1928.9 samples/s | 30.1 steps/s
[Step=33400 Epoch=65.1] | Loss=0.00629 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.708 | acc=1.0000 | 4340.0 samples/s | 67.8 steps/s
[Step=33450 Epoch=65.2] | Loss=0.00615 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.709 | acc=0.9844 | 4588.6 samples/s | 71.7 steps/s
[Step=33500 Epoch=65.3] | Loss=0.00615 | Reg=0.00177 | L2-Norm=13.312 | L2-Norm(final)=3.710 | acc=1.0000 | 4784.8 samples/s | 74.8 steps/s
[Step=33550 Epoch=65.4] | Loss=0.00604 | Reg=0.00177 | L2-Norm=13.312 | L2-Norm(final)=3.711 | acc=1.0000 | 4751.0 samples/s | 74.2 steps/s
[Step=33600 Epoch=65.5] | Loss=0.00593 | Reg=0.00177 | L2-Norm=13.313 | L2-Norm(final)=3.712 | acc=1.0000 | 4759.0 samples/s | 74.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step33600.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=64.1] | Loss=0.04835 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.696 | acc=0.9531 | 3769.6 samples/s | 58.9 steps/s
[Step=32850 Epoch=64.2] | Loss=0.01754 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.695 | acc=0.9844 | 2340.8 samples/s | 36.6 steps/s
[Step=32900 Epoch=64.3] | Loss=0.01242 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.696 | acc=0.9688 | 4346.1 samples/s | 67.9 steps/s
[Step=32950 Epoch=64.4] | Loss=0.01027 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.698 | acc=1.0000 | 4463.7 samples/s | 69.7 steps/s
[Step=33000 Epoch=64.5] | Loss=0.00873 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=3.699 | acc=0.9844 | 4429.1 samples/s | 69.2 steps/s
[Step=33050 Epoch=64.6] | Loss=0.00792 | Reg=0.00177 | L2-Norm=13.306 | L2-Norm(final)=3.700 | acc=0.9844 | 4650.9 samples/s | 72.7 steps/s
[Step=33100 Epoch=64.7] | Loss=0.00737 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.701 | acc=1.0000 | 4676.7 samples/s | 73.1 steps/s
[Step=33150 Epoch=64.8] | Loss=0.00691 | Reg=0.00177 | L2-Norm=13.308 | L2-Norm(final)=3.703 | acc=1.0000 | 4779.4 samples/s | 74.7 steps/s
[Step=33200 Epoch=64.9] | Loss=0.00656 | Reg=0.00177 | L2-Norm=13.308 | L2-Norm(final)=3.704 | acc=1.0000 | 4777.3 samples/s | 74.6 steps/s
[Step=33250 Epoch=65.0] | Loss=0.00653 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=3.705 | acc=1.0000 | 4781.8 samples/s | 74.7 steps/s
[Step=33300 Epoch=65.1] | Loss=0.00632 | Reg=0.00177 | L2-Norm=13.309 | L2-Norm(final)=3.707 | acc=1.0000 | 5884.4 samples/s | 91.9 steps/s
[Step=33350 Epoch=65.2] | Loss=0.00602 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.708 | acc=0.9844 | 1965.6 samples/s | 30.7 steps/s
[Step=33400 Epoch=65.3] | Loss=0.00583 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.709 | acc=1.0000 | 4282.1 samples/s | 66.9 steps/s
[Step=33450 Epoch=65.4] | Loss=0.00578 | Reg=0.00177 | L2-Norm=13.310 | L2-Norm(final)=3.710 | acc=1.0000 | 4633.0 samples/s | 72.4 steps/s
[Step=33500 Epoch=65.5] | Loss=0.00577 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.711 | acc=0.9844 | 4784.5 samples/s | 74.8 steps/s
[Step=33550 Epoch=65.6] | Loss=0.00573 | Reg=0.00177 | L2-Norm=13.311 | L2-Norm(final)=3.712 | acc=0.9844 | 4814.8 samples/s | 75.2 steps/s
[Step=33600 Epoch=65.7] | Loss=0.00568 | Reg=0.00177 | L2-Norm=13.312 | L2-Norm(final)=3.713 | acc=1.0000 | 4790.1 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step33600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=125.7] | Loss=0.00508 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.696 | acc=1.0000 | 3894.5 samples/s | 60.9 steps/s
[Step=32850 Epoch=125.9] | Loss=0.00439 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.700 | acc=1.0000 | 4572.4 samples/s | 71.4 steps/s
[Step=32900 Epoch=126.1] | Loss=0.00220 | Reg=0.00177 | L2-Norm=13.308 | L2-Norm(final)=3.701 | acc=1.0000 | 4428.7 samples/s | 69.2 steps/s
[Step=32950 Epoch=126.3] | Loss=0.00147 | Reg=0.00177 | L2-Norm=13.308 | L2-Norm(final)=3.701 | acc=1.0000 | 4357.8 samples/s | 68.1 steps/s
[Step=33000 Epoch=126.4] | Loss=0.00111 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.701 | acc=1.0000 | 4102.8 samples/s | 64.1 steps/s
[Step=33050 Epoch=126.6] | Loss=0.00089 | Reg=0.00177 | L2-Norm=13.307 | L2-Norm(final)=3.701 | acc=1.0000 | 5649.1 samples/s | 88.3 steps/s
[Step=33100 Epoch=126.8] | Loss=0.00074 | Reg=0.00177 | L2-Norm=13.306 | L2-Norm(final)=3.702 | acc=1.0000 | 1930.2 samples/s | 30.2 steps/s
[Step=33150 Epoch=127.0] | Loss=0.00064 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=3.702 | acc=1.0000 | 4491.1 samples/s | 70.2 steps/s
[Step=33200 Epoch=127.2] | Loss=0.00056 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.702 | acc=1.0000 | 4525.9 samples/s | 70.7 steps/s
[Step=33250 Epoch=127.4] | Loss=0.00050 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.702 | acc=1.0000 | 4501.0 samples/s | 70.3 steps/s
[Step=33300 Epoch=127.6] | Loss=0.00045 | Reg=0.00177 | L2-Norm=13.302 | L2-Norm(final)=3.702 | acc=1.0000 | 4997.2 samples/s | 78.1 steps/s
[Step=33350 Epoch=127.8] | Loss=0.00041 | Reg=0.00177 | L2-Norm=13.302 | L2-Norm(final)=3.702 | acc=1.0000 | 1947.1 samples/s | 30.4 steps/s
[Step=33400 Epoch=128.0] | Loss=0.00038 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=3.702 | acc=1.0000 | 4254.7 samples/s | 66.5 steps/s
[Step=33450 Epoch=128.2] | Loss=0.00035 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.702 | acc=1.0000 | 4549.1 samples/s | 71.1 steps/s
[Step=33500 Epoch=128.4] | Loss=0.00032 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.703 | acc=1.0000 | 4446.5 samples/s | 69.5 steps/s
[Step=33550 Epoch=128.6] | Loss=0.00030 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.703 | acc=1.0000 | 4620.0 samples/s | 72.2 steps/s
[Step=33600 Epoch=128.7] | Loss=0.00028 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.703 | acc=1.0000 | 2094.9 samples/s | 32.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step33600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=126.3] | Loss=0.05412 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.696 | acc=0.9844 | 3942.1 samples/s | 61.6 steps/s
[Step=32850 Epoch=126.5] | Loss=0.00317 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.700 | acc=1.0000 | 4294.8 samples/s | 67.1 steps/s
[Step=32900 Epoch=126.6] | Loss=0.00160 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=3.701 | acc=1.0000 | 4121.8 samples/s | 64.4 steps/s
[Step=32950 Epoch=126.8] | Loss=0.00107 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=3.701 | acc=1.0000 | 4419.0 samples/s | 69.0 steps/s
[Step=33000 Epoch=127.0] | Loss=0.00081 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=3.701 | acc=1.0000 | 4500.0 samples/s | 70.3 steps/s
[Step=33050 Epoch=127.2] | Loss=0.00065 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.702 | acc=1.0000 | 5776.2 samples/s | 90.3 steps/s
[Step=33100 Epoch=127.4] | Loss=0.00054 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.702 | acc=1.0000 | 1929.2 samples/s | 30.1 steps/s
[Step=33150 Epoch=127.6] | Loss=0.00047 | Reg=0.00177 | L2-Norm=13.302 | L2-Norm(final)=3.702 | acc=1.0000 | 4536.9 samples/s | 70.9 steps/s
[Step=33200 Epoch=127.8] | Loss=0.00041 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=3.702 | acc=1.0000 | 4488.2 samples/s | 70.1 steps/s
[Step=33250 Epoch=128.0] | Loss=0.00037 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.702 | acc=1.0000 | 4411.4 samples/s | 68.9 steps/s
[Step=33300 Epoch=128.2] | Loss=0.00033 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.702 | acc=1.0000 | 4757.7 samples/s | 74.3 steps/s
[Step=33350 Epoch=128.4] | Loss=0.00030 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.702 | acc=1.0000 | 1986.1 samples/s | 31.0 steps/s
[Step=33400 Epoch=128.6] | Loss=0.00028 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.703 | acc=1.0000 | 4554.2 samples/s | 71.2 steps/s
[Step=33450 Epoch=128.8] | Loss=0.00026 | Reg=0.00177 | L2-Norm=13.295 | L2-Norm(final)=3.703 | acc=1.0000 | 4499.4 samples/s | 70.3 steps/s
[Step=33500 Epoch=129.0] | Loss=0.00024 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.703 | acc=1.0000 | 4502.0 samples/s | 70.3 steps/s
[Step=33550 Epoch=129.1] | Loss=0.00022 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.703 | acc=1.0000 | 4614.2 samples/s | 72.1 steps/s
[Step=33600 Epoch=129.3] | Loss=0.00021 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.703 | acc=1.0000 | 2053.6 samples/s | 32.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21213 | acc=0.8980 | tpr=0.8571 | fpr=0.0134 | 4270.2 samples/s | 16.7 steps/s
Avg test loss: 0.21824, Avg test acc: 0.89715, Avg tpr: 0.85703, Avg fpr: 0.01461, total FA: 114

Testing server on iccad2012
[Step=  50] | Loss=0.39814 | acc=0.9053 | tpr=0.9469 | fpr=0.0954 | 4279.0 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.39869 | acc=0.9055 | tpr=0.9616 | fpr=0.0956 | 8040.4 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.40175 | acc=0.9051 | tpr=0.9697 | fpr=0.0961 | 8340.0 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.40294 | acc=0.9054 | tpr=0.9716 | fpr=0.0958 | 8727.7 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.40068 | acc=0.9057 | tpr=0.9738 | fpr=0.0955 | 8024.1 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.40508 | acc=0.9053 | tpr=0.9745 | fpr=0.0959 | 7969.4 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.40905 | acc=0.9050 | tpr=0.9737 | fpr=0.0962 | 7936.6 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.41144 | acc=0.9050 | tpr=0.9721 | fpr=0.0962 | 8379.8 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.41647 | acc=0.9046 | tpr=0.9708 | fpr=0.0966 | 8193.8 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.41652 | acc=0.9046 | tpr=0.9718 | fpr=0.0966 | 7747.7 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.41577 | acc=0.9046 | tpr=0.9717 | fpr=0.0966 | 14558.7 samples/s | 56.9 steps/s
Avg test loss: 0.41543, Avg test acc: 0.90461, Avg tpr: 0.97147, Avg fpr: 0.09660, total FA: 13413

server round 42/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=65.5] | Loss=0.03756 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.716 | acc=0.9844 | 3870.0 samples/s | 60.5 steps/s
[Step=33650 Epoch=65.6] | Loss=0.01526 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.714 | acc=1.0000 | 4575.0 samples/s | 71.5 steps/s
[Step=33700 Epoch=65.7] | Loss=0.01073 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.714 | acc=1.0000 | 4762.9 samples/s | 74.4 steps/s
[Step=33750 Epoch=65.8] | Loss=0.00877 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.716 | acc=1.0000 | 4755.1 samples/s | 74.3 steps/s
[Step=33800 Epoch=65.9] | Loss=0.00829 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.717 | acc=0.9688 | 4817.2 samples/s | 75.3 steps/s
[Step=33850 Epoch=66.0] | Loss=0.00768 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.718 | acc=1.0000 | 4534.8 samples/s | 70.9 steps/s
[Step=33900 Epoch=66.1] | Loss=0.00742 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=3.719 | acc=0.9844 | 4419.4 samples/s | 69.1 steps/s
[Step=33950 Epoch=66.2] | Loss=0.00712 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=3.720 | acc=1.0000 | 4485.9 samples/s | 70.1 steps/s
[Step=34000 Epoch=66.3] | Loss=0.00691 | Reg=0.00177 | L2-Norm=13.302 | L2-Norm(final)=3.721 | acc=0.9844 | 4722.5 samples/s | 73.8 steps/s
[Step=34050 Epoch=66.4] | Loss=0.00668 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.722 | acc=0.9844 | 4744.8 samples/s | 74.1 steps/s
[Step=34100 Epoch=66.5] | Loss=0.00659 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.723 | acc=1.0000 | 5834.6 samples/s | 91.2 steps/s
[Step=34150 Epoch=66.6] | Loss=0.00651 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.724 | acc=1.0000 | 1966.6 samples/s | 30.7 steps/s
[Step=34200 Epoch=66.7] | Loss=0.00633 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.725 | acc=1.0000 | 4710.6 samples/s | 73.6 steps/s
[Step=34250 Epoch=66.8] | Loss=0.00614 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=3.726 | acc=0.9844 | 4677.2 samples/s | 73.1 steps/s
[Step=34300 Epoch=66.9] | Loss=0.00606 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=3.727 | acc=1.0000 | 4605.7 samples/s | 72.0 steps/s
[Step=34350 Epoch=67.0] | Loss=0.00587 | Reg=0.00177 | L2-Norm=13.306 | L2-Norm(final)=3.728 | acc=1.0000 | 4347.2 samples/s | 67.9 steps/s
[Step=34400 Epoch=67.1] | Loss=0.00579 | Reg=0.00177 | L2-Norm=13.306 | L2-Norm(final)=3.729 | acc=1.0000 | 4600.9 samples/s | 71.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step34400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=65.7] | Loss=0.12448 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.716 | acc=0.9375 | 4134.7 samples/s | 64.6 steps/s
[Step=33650 Epoch=65.8] | Loss=0.01994 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.714 | acc=0.9844 | 4618.1 samples/s | 72.2 steps/s
[Step=33700 Epoch=65.9] | Loss=0.01274 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.715 | acc=1.0000 | 4643.5 samples/s | 72.6 steps/s
[Step=33750 Epoch=66.0] | Loss=0.00992 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.716 | acc=1.0000 | 4551.1 samples/s | 71.1 steps/s
[Step=33800 Epoch=66.1] | Loss=0.00875 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.717 | acc=0.9844 | 4507.5 samples/s | 70.4 steps/s
[Step=33850 Epoch=66.2] | Loss=0.00810 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.719 | acc=1.0000 | 4719.8 samples/s | 73.7 steps/s
[Step=33900 Epoch=66.3] | Loss=0.00782 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.720 | acc=1.0000 | 4686.2 samples/s | 73.2 steps/s
[Step=33950 Epoch=66.4] | Loss=0.00720 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=3.721 | acc=1.0000 | 4285.0 samples/s | 67.0 steps/s
[Step=34000 Epoch=66.5] | Loss=0.00674 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=3.723 | acc=1.0000 | 4652.5 samples/s | 72.7 steps/s
[Step=34050 Epoch=66.6] | Loss=0.00676 | Reg=0.00177 | L2-Norm=13.302 | L2-Norm(final)=3.724 | acc=0.9844 | 4760.1 samples/s | 74.4 steps/s
[Step=34100 Epoch=66.7] | Loss=0.00655 | Reg=0.00177 | L2-Norm=13.302 | L2-Norm(final)=3.725 | acc=1.0000 | 5882.0 samples/s | 91.9 steps/s
[Step=34150 Epoch=66.8] | Loss=0.00629 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.726 | acc=0.9844 | 1994.2 samples/s | 31.2 steps/s
[Step=34200 Epoch=66.9] | Loss=0.00614 | Reg=0.00177 | L2-Norm=13.303 | L2-Norm(final)=3.727 | acc=1.0000 | 4781.1 samples/s | 74.7 steps/s
[Step=34250 Epoch=67.0] | Loss=0.00612 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.729 | acc=1.0000 | 4656.2 samples/s | 72.8 steps/s
[Step=34300 Epoch=67.1] | Loss=0.00596 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.730 | acc=1.0000 | 4703.8 samples/s | 73.5 steps/s
[Step=34350 Epoch=67.2] | Loss=0.00579 | Reg=0.00177 | L2-Norm=13.304 | L2-Norm(final)=3.731 | acc=0.9844 | 4587.9 samples/s | 71.7 steps/s
[Step=34400 Epoch=67.3] | Loss=0.00571 | Reg=0.00177 | L2-Norm=13.305 | L2-Norm(final)=3.732 | acc=1.0000 | 4391.2 samples/s | 68.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step34400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=128.7] | Loss=0.03891 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.716 | acc=0.9844 | 4019.9 samples/s | 62.8 steps/s
[Step=33650 Epoch=128.9] | Loss=0.00341 | Reg=0.00177 | L2-Norm=13.295 | L2-Norm(final)=3.720 | acc=1.0000 | 4336.6 samples/s | 67.8 steps/s
[Step=33700 Epoch=129.1] | Loss=0.00172 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.722 | acc=1.0000 | 4588.4 samples/s | 71.7 steps/s
[Step=33750 Epoch=129.3] | Loss=0.00115 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.722 | acc=1.0000 | 4476.5 samples/s | 69.9 steps/s
[Step=33800 Epoch=129.5] | Loss=0.00086 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.723 | acc=1.0000 | 4533.9 samples/s | 70.8 steps/s
[Step=33850 Epoch=129.7] | Loss=0.00069 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.723 | acc=1.0000 | 5673.0 samples/s | 88.6 steps/s
[Step=33900 Epoch=129.9] | Loss=0.00058 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.723 | acc=1.0000 | 1855.8 samples/s | 29.0 steps/s
[Step=33950 Epoch=130.1] | Loss=0.00050 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.723 | acc=1.0000 | 4370.7 samples/s | 68.3 steps/s
[Step=34000 Epoch=130.3] | Loss=0.00044 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.723 | acc=1.0000 | 4456.4 samples/s | 69.6 steps/s
[Step=34050 Epoch=130.5] | Loss=0.00039 | Reg=0.00177 | L2-Norm=13.295 | L2-Norm(final)=3.724 | acc=1.0000 | 4510.8 samples/s | 70.5 steps/s
[Step=34100 Epoch=130.7] | Loss=0.00035 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.724 | acc=1.0000 | 5032.1 samples/s | 78.6 steps/s
[Step=34150 Epoch=130.9] | Loss=0.00032 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.724 | acc=1.0000 | 2019.2 samples/s | 31.6 steps/s
[Step=34200 Epoch=131.0] | Loss=0.00029 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.724 | acc=1.0000 | 4512.3 samples/s | 70.5 steps/s
[Step=34250 Epoch=131.2] | Loss=0.00027 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.724 | acc=1.0000 | 4403.8 samples/s | 68.8 steps/s
[Step=34300 Epoch=131.4] | Loss=0.00025 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.724 | acc=1.0000 | 4258.5 samples/s | 66.5 steps/s
[Step=34350 Epoch=131.6] | Loss=0.00024 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.724 | acc=1.0000 | 4306.2 samples/s | 67.3 steps/s
[Step=34400 Epoch=131.8] | Loss=0.00022 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.725 | acc=1.0000 | 2078.0 samples/s | 32.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step34400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=129.3] | Loss=0.01956 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.716 | acc=0.9844 | 4312.9 samples/s | 67.4 steps/s
[Step=33650 Epoch=129.5] | Loss=0.00292 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.720 | acc=1.0000 | 4031.5 samples/s | 63.0 steps/s
[Step=33700 Epoch=129.7] | Loss=0.00147 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.722 | acc=1.0000 | 4512.1 samples/s | 70.5 steps/s
[Step=33750 Epoch=129.9] | Loss=0.00099 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.722 | acc=1.0000 | 4610.0 samples/s | 72.0 steps/s
[Step=33800 Epoch=130.1] | Loss=0.00074 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.723 | acc=1.0000 | 4287.8 samples/s | 67.0 steps/s
[Step=33850 Epoch=130.3] | Loss=0.00060 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.723 | acc=1.0000 | 5289.0 samples/s | 82.6 steps/s
[Step=33900 Epoch=130.5] | Loss=0.00050 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.723 | acc=1.0000 | 1895.5 samples/s | 29.6 steps/s
[Step=33950 Epoch=130.7] | Loss=0.00043 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.723 | acc=1.0000 | 4502.0 samples/s | 70.3 steps/s
[Step=34000 Epoch=130.9] | Loss=0.00038 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.724 | acc=1.0000 | 4525.1 samples/s | 70.7 steps/s
[Step=34050 Epoch=131.1] | Loss=0.00034 | Reg=0.00177 | L2-Norm=13.295 | L2-Norm(final)=3.724 | acc=1.0000 | 4502.5 samples/s | 70.4 steps/s
[Step=34100 Epoch=131.3] | Loss=0.00030 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.724 | acc=1.0000 | 5144.6 samples/s | 80.4 steps/s
[Step=34150 Epoch=131.5] | Loss=0.00028 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.724 | acc=1.0000 | 1970.1 samples/s | 30.8 steps/s
[Step=34200 Epoch=131.6] | Loss=0.00025 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.724 | acc=1.0000 | 4106.0 samples/s | 64.2 steps/s
[Step=34250 Epoch=131.8] | Loss=0.00024 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.725 | acc=1.0000 | 4077.1 samples/s | 63.7 steps/s
[Step=34300 Epoch=132.0] | Loss=0.00022 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.725 | acc=1.0000 | 4477.1 samples/s | 70.0 steps/s
[Step=34350 Epoch=132.2] | Loss=0.00021 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.725 | acc=1.0000 | 4622.8 samples/s | 72.2 steps/s
[Step=34400 Epoch=132.4] | Loss=0.00019 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.725 | acc=1.0000 | 2081.6 samples/s | 32.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19961 | acc=0.9048 | tpr=0.8670 | fpr=0.0129 | 4134.7 samples/s | 16.2 steps/s
Avg test loss: 0.20593, Avg test acc: 0.90340, Avg tpr: 0.86612, Avg fpr: 0.01461, total FA: 114

Testing server on iccad2012
[Step=  50] | Loss=0.43872 | acc=0.8949 | tpr=0.9513 | fpr=0.1061 | 4338.7 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.43997 | acc=0.8946 | tpr=0.9638 | fpr=0.1067 | 8073.6 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.44275 | acc=0.8948 | tpr=0.9712 | fpr=0.1066 | 7519.6 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.44378 | acc=0.8947 | tpr=0.9727 | fpr=0.1067 | 8344.7 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.44124 | acc=0.8953 | tpr=0.9747 | fpr=0.1061 | 8305.7 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.44597 | acc=0.8951 | tpr=0.9745 | fpr=0.1063 | 8256.6 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.45002 | acc=0.8948 | tpr=0.9737 | fpr=0.1066 | 7767.0 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.45254 | acc=0.8948 | tpr=0.9721 | fpr=0.1066 | 8180.4 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.45783 | acc=0.8946 | tpr=0.9713 | fpr=0.1068 | 8286.1 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.45783 | acc=0.8946 | tpr=0.9722 | fpr=0.1068 | 8613.1 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.45702 | acc=0.8947 | tpr=0.9721 | fpr=0.1067 | 13458.5 samples/s | 52.6 steps/s
Avg test loss: 0.45664, Avg test acc: 0.89466, Avg tpr: 0.97187, Avg fpr: 0.10674, total FA: 14821

server round 43/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=67.1] | Loss=0.03525 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.736 | acc=0.9688 | 4003.4 samples/s | 62.6 steps/s
[Step=34450 Epoch=67.2] | Loss=0.01821 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.734 | acc=1.0000 | 4159.3 samples/s | 65.0 steps/s
[Step=34500 Epoch=67.3] | Loss=0.01186 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.733 | acc=1.0000 | 4718.7 samples/s | 73.7 steps/s
[Step=34550 Epoch=67.4] | Loss=0.00960 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.734 | acc=0.9844 | 4758.6 samples/s | 74.4 steps/s
[Step=34600 Epoch=67.5] | Loss=0.00877 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.736 | acc=1.0000 | 4711.1 samples/s | 73.6 steps/s
[Step=34650 Epoch=67.6] | Loss=0.00797 | Reg=0.00177 | L2-Norm=13.295 | L2-Norm(final)=3.737 | acc=1.0000 | 4768.7 samples/s | 74.5 steps/s
[Step=34700 Epoch=67.7] | Loss=0.00751 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.738 | acc=0.9844 | 4803.8 samples/s | 75.1 steps/s
[Step=34750 Epoch=67.8] | Loss=0.00704 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.739 | acc=1.0000 | 4683.5 samples/s | 73.2 steps/s
[Step=34800 Epoch=67.9] | Loss=0.00682 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.740 | acc=1.0000 | 4709.0 samples/s | 73.6 steps/s
[Step=34850 Epoch=68.0] | Loss=0.00674 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.741 | acc=1.0000 | 4394.3 samples/s | 68.7 steps/s
[Step=34900 Epoch=68.1] | Loss=0.00652 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.742 | acc=1.0000 | 5238.5 samples/s | 81.9 steps/s
[Step=34950 Epoch=68.2] | Loss=0.00638 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.743 | acc=1.0000 | 1976.3 samples/s | 30.9 steps/s
[Step=35000 Epoch=68.3] | Loss=0.00618 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.744 | acc=1.0000 | 4739.0 samples/s | 74.0 steps/s
[Step=35050 Epoch=68.4] | Loss=0.00603 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.745 | acc=1.0000 | 4763.7 samples/s | 74.4 steps/s
[Step=35100 Epoch=68.5] | Loss=0.00596 | Reg=0.00177 | L2-Norm=13.300 | L2-Norm(final)=3.746 | acc=1.0000 | 4785.2 samples/s | 74.8 steps/s
[Step=35150 Epoch=68.6] | Loss=0.00599 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=3.747 | acc=1.0000 | 4800.3 samples/s | 75.0 steps/s
[Step=35200 Epoch=68.7] | Loss=0.00590 | Reg=0.00177 | L2-Norm=13.301 | L2-Norm(final)=3.748 | acc=1.0000 | 4633.7 samples/s | 72.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step35200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=67.3] | Loss=0.03701 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.736 | acc=0.9688 | 3891.7 samples/s | 60.8 steps/s
[Step=34450 Epoch=67.3] | Loss=0.01573 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.736 | acc=1.0000 | 4114.8 samples/s | 64.3 steps/s
[Step=34500 Epoch=67.4] | Loss=0.01072 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.736 | acc=0.9844 | 4752.9 samples/s | 74.3 steps/s
[Step=34550 Epoch=67.5] | Loss=0.00918 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.737 | acc=1.0000 | 4803.8 samples/s | 75.1 steps/s
[Step=34600 Epoch=67.6] | Loss=0.00819 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.738 | acc=1.0000 | 4822.5 samples/s | 75.4 steps/s
[Step=34650 Epoch=67.7] | Loss=0.00746 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.739 | acc=0.9844 | 4744.9 samples/s | 74.1 steps/s
[Step=34700 Epoch=67.8] | Loss=0.00710 | Reg=0.00177 | L2-Norm=13.295 | L2-Norm(final)=3.740 | acc=0.9844 | 4793.0 samples/s | 74.9 steps/s
[Step=34750 Epoch=67.9] | Loss=0.00701 | Reg=0.00177 | L2-Norm=13.295 | L2-Norm(final)=3.741 | acc=1.0000 | 4790.0 samples/s | 74.8 steps/s
[Step=34800 Epoch=68.0] | Loss=0.00674 | Reg=0.00177 | L2-Norm=13.295 | L2-Norm(final)=3.742 | acc=1.0000 | 4804.3 samples/s | 75.1 steps/s
[Step=34850 Epoch=68.1] | Loss=0.00651 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.742 | acc=1.0000 | 4593.3 samples/s | 71.8 steps/s
[Step=34900 Epoch=68.2] | Loss=0.00629 | Reg=0.00177 | L2-Norm=13.296 | L2-Norm(final)=3.743 | acc=0.9844 | 5427.3 samples/s | 84.8 steps/s
[Step=34950 Epoch=68.3] | Loss=0.00618 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.744 | acc=1.0000 | 1967.7 samples/s | 30.7 steps/s
[Step=35000 Epoch=68.4] | Loss=0.00609 | Reg=0.00177 | L2-Norm=13.297 | L2-Norm(final)=3.746 | acc=1.0000 | 4742.6 samples/s | 74.1 steps/s
[Step=35050 Epoch=68.5] | Loss=0.00593 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.747 | acc=1.0000 | 4779.6 samples/s | 74.7 steps/s
[Step=35100 Epoch=68.6] | Loss=0.00584 | Reg=0.00177 | L2-Norm=13.298 | L2-Norm(final)=3.748 | acc=1.0000 | 4792.7 samples/s | 74.9 steps/s
[Step=35150 Epoch=68.7] | Loss=0.00572 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.749 | acc=1.0000 | 4787.2 samples/s | 74.8 steps/s
[Step=35200 Epoch=68.8] | Loss=0.00563 | Reg=0.00177 | L2-Norm=13.299 | L2-Norm(final)=3.750 | acc=0.9844 | 4796.8 samples/s | 75.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step35200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=131.8] | Loss=0.02268 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.737 | acc=0.9844 | 4080.3 samples/s | 63.8 steps/s
[Step=34450 Epoch=132.0] | Loss=0.00353 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.741 | acc=1.0000 | 3961.9 samples/s | 61.9 steps/s
[Step=34500 Epoch=132.2] | Loss=0.00178 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.742 | acc=1.0000 | 4199.4 samples/s | 65.6 steps/s
[Step=34550 Epoch=132.4] | Loss=0.00119 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.743 | acc=1.0000 | 4485.1 samples/s | 70.1 steps/s
[Step=34600 Epoch=132.6] | Loss=0.00090 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.743 | acc=1.0000 | 4561.1 samples/s | 71.3 steps/s
[Step=34650 Epoch=132.8] | Loss=0.00072 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.743 | acc=1.0000 | 5668.1 samples/s | 88.6 steps/s
[Step=34700 Epoch=133.0] | Loss=0.00060 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.743 | acc=1.0000 | 1936.5 samples/s | 30.3 steps/s
[Step=34750 Epoch=133.1] | Loss=0.00052 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.744 | acc=1.0000 | 4531.3 samples/s | 70.8 steps/s
[Step=34800 Epoch=133.3] | Loss=0.00045 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.744 | acc=1.0000 | 4374.0 samples/s | 68.3 steps/s
[Step=34850 Epoch=133.5] | Loss=0.00040 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.744 | acc=1.0000 | 4135.1 samples/s | 64.6 steps/s
[Step=34900 Epoch=133.7] | Loss=0.00036 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.744 | acc=1.0000 | 4674.4 samples/s | 73.0 steps/s
[Step=34950 Epoch=133.9] | Loss=0.00033 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.744 | acc=1.0000 | 2014.0 samples/s | 31.5 steps/s
[Step=35000 Epoch=134.1] | Loss=0.00031 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.744 | acc=1.0000 | 4565.6 samples/s | 71.3 steps/s
[Step=35050 Epoch=134.3] | Loss=0.00028 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.744 | acc=1.0000 | 4554.0 samples/s | 71.2 steps/s
[Step=35100 Epoch=134.5] | Loss=0.00026 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.745 | acc=1.0000 | 4459.2 samples/s | 69.7 steps/s
[Step=35150 Epoch=134.7] | Loss=0.00025 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.745 | acc=1.0000 | 4538.0 samples/s | 70.9 steps/s
[Step=35200 Epoch=134.9] | Loss=0.00023 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.745 | acc=1.0000 | 2053.7 samples/s | 32.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step35200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=132.4] | Loss=0.10736 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.736 | acc=0.9531 | 4557.1 samples/s | 71.2 steps/s
[Step=34450 Epoch=132.6] | Loss=0.00383 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.740 | acc=1.0000 | 3873.8 samples/s | 60.5 steps/s
[Step=34500 Epoch=132.8] | Loss=0.00192 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.741 | acc=1.0000 | 4478.7 samples/s | 70.0 steps/s
[Step=34550 Epoch=133.0] | Loss=0.00129 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.741 | acc=1.0000 | 4468.2 samples/s | 69.8 steps/s
[Step=34600 Epoch=133.2] | Loss=0.00097 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.741 | acc=1.0000 | 4533.3 samples/s | 70.8 steps/s
[Step=34650 Epoch=133.4] | Loss=0.00078 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.742 | acc=1.0000 | 5788.1 samples/s | 90.4 steps/s
[Step=34700 Epoch=133.6] | Loss=0.00065 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.742 | acc=1.0000 | 1897.9 samples/s | 29.7 steps/s
[Step=34750 Epoch=133.8] | Loss=0.00056 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.742 | acc=1.0000 | 3963.4 samples/s | 61.9 steps/s
[Step=34800 Epoch=134.0] | Loss=0.00049 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.742 | acc=1.0000 | 4233.1 samples/s | 66.1 steps/s
[Step=34850 Epoch=134.2] | Loss=0.00043 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.742 | acc=1.0000 | 4513.9 samples/s | 70.5 steps/s
[Step=34900 Epoch=134.3] | Loss=0.00039 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.742 | acc=1.0000 | 5138.0 samples/s | 80.3 steps/s
[Step=34950 Epoch=134.5] | Loss=0.00036 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.742 | acc=1.0000 | 2006.0 samples/s | 31.3 steps/s
[Step=35000 Epoch=134.7] | Loss=0.00033 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.742 | acc=1.0000 | 4470.9 samples/s | 69.9 steps/s
[Step=35050 Epoch=134.9] | Loss=0.00030 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.743 | acc=1.0000 | 4524.6 samples/s | 70.7 steps/s
[Step=35100 Epoch=135.1] | Loss=0.00028 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.743 | acc=1.0000 | 4367.1 samples/s | 68.2 steps/s
[Step=35150 Epoch=135.3] | Loss=0.00026 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.743 | acc=1.0000 | 4176.8 samples/s | 65.3 steps/s
[Step=35200 Epoch=135.5] | Loss=0.00025 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.743 | acc=1.0000 | 2038.0 samples/s | 31.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19477 | acc=0.9069 | tpr=0.8702 | fpr=0.0134 | 4538.6 samples/s | 17.7 steps/s
Avg test loss: 0.20174, Avg test acc: 0.90656, Avg tpr: 0.87096, Avg fpr: 0.01513, total FA: 118

Testing server on iccad2012
[Step=  50] | Loss=0.44075 | acc=0.8952 | tpr=0.9513 | fpr=0.1058 | 4194.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.44035 | acc=0.8954 | tpr=0.9659 | fpr=0.1060 | 8599.3 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.44290 | acc=0.8958 | tpr=0.9741 | fpr=0.1057 | 8560.2 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.44362 | acc=0.8958 | tpr=0.9749 | fpr=0.1057 | 7406.8 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.44116 | acc=0.8963 | tpr=0.9764 | fpr=0.1052 | 7938.0 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.44602 | acc=0.8961 | tpr=0.9767 | fpr=0.1053 | 8461.4 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.45013 | acc=0.8959 | tpr=0.9756 | fpr=0.1055 | 8281.1 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.45253 | acc=0.8958 | tpr=0.9737 | fpr=0.1056 | 8080.0 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.45778 | acc=0.8954 | tpr=0.9722 | fpr=0.1060 | 7852.6 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.45781 | acc=0.8954 | tpr=0.9731 | fpr=0.1060 | 8171.2 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.45715 | acc=0.8954 | tpr=0.9729 | fpr=0.1060 | 15160.5 samples/s | 59.2 steps/s
Avg test loss: 0.45678, Avg test acc: 0.89536, Avg tpr: 0.97266, Avg fpr: 0.10604, total FA: 14724

server round 44/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=68.7] | Loss=0.08868 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.754 | acc=0.9375 | 4009.2 samples/s | 62.6 steps/s
[Step=35250 Epoch=68.8] | Loss=0.01705 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.752 | acc=1.0000 | 4351.2 samples/s | 68.0 steps/s
[Step=35300 Epoch=68.8] | Loss=0.01133 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.752 | acc=1.0000 | 4654.4 samples/s | 72.7 steps/s
[Step=35350 Epoch=68.9] | Loss=0.00944 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.753 | acc=0.9844 | 4315.9 samples/s | 67.4 steps/s
[Step=35400 Epoch=69.0] | Loss=0.00848 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.754 | acc=1.0000 | 4706.0 samples/s | 73.5 steps/s
[Step=35450 Epoch=69.1] | Loss=0.00780 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.754 | acc=1.0000 | 4799.3 samples/s | 75.0 steps/s
[Step=35500 Epoch=69.2] | Loss=0.00742 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.755 | acc=0.9844 | 4779.0 samples/s | 74.7 steps/s
[Step=35550 Epoch=69.3] | Loss=0.00729 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.756 | acc=1.0000 | 4797.4 samples/s | 75.0 steps/s
[Step=35600 Epoch=69.4] | Loss=0.00697 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.757 | acc=1.0000 | 4815.0 samples/s | 75.2 steps/s
[Step=35650 Epoch=69.5] | Loss=0.00667 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.758 | acc=1.0000 | 4735.0 samples/s | 74.0 steps/s
[Step=35700 Epoch=69.6] | Loss=0.00661 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.759 | acc=1.0000 | 5818.0 samples/s | 90.9 steps/s
[Step=35750 Epoch=69.7] | Loss=0.00633 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.760 | acc=0.9844 | 1887.5 samples/s | 29.5 steps/s
[Step=35800 Epoch=69.8] | Loss=0.00629 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.761 | acc=0.9844 | 4485.5 samples/s | 70.1 steps/s
[Step=35850 Epoch=69.9] | Loss=0.00622 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.762 | acc=0.9844 | 4750.1 samples/s | 74.2 steps/s
[Step=35900 Epoch=70.0] | Loss=0.00614 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.763 | acc=1.0000 | 4703.8 samples/s | 73.5 steps/s
[Step=35950 Epoch=70.1] | Loss=0.00606 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.764 | acc=1.0000 | 4789.0 samples/s | 74.8 steps/s
[Step=36000 Epoch=70.2] | Loss=0.00588 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.765 | acc=1.0000 | 4779.5 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=68.8] | Loss=0.06294 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.754 | acc=0.9375 | 4290.5 samples/s | 67.0 steps/s
[Step=35250 Epoch=68.9] | Loss=0.01678 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.753 | acc=1.0000 | 4456.5 samples/s | 69.6 steps/s
[Step=35300 Epoch=69.0] | Loss=0.01111 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.753 | acc=0.9844 | 4619.2 samples/s | 72.2 steps/s
[Step=35350 Epoch=69.1] | Loss=0.00874 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.754 | acc=1.0000 | 4538.7 samples/s | 70.9 steps/s
[Step=35400 Epoch=69.2] | Loss=0.00788 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.756 | acc=1.0000 | 4278.1 samples/s | 66.8 steps/s
[Step=35450 Epoch=69.3] | Loss=0.00723 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.756 | acc=1.0000 | 4767.3 samples/s | 74.5 steps/s
[Step=35500 Epoch=69.4] | Loss=0.00666 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.758 | acc=1.0000 | 4755.3 samples/s | 74.3 steps/s
[Step=35550 Epoch=69.5] | Loss=0.00628 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.759 | acc=0.9844 | 4819.8 samples/s | 75.3 steps/s
[Step=35600 Epoch=69.6] | Loss=0.00624 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.760 | acc=1.0000 | 4818.4 samples/s | 75.3 steps/s
[Step=35650 Epoch=69.7] | Loss=0.00599 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.761 | acc=1.0000 | 4752.6 samples/s | 74.3 steps/s
[Step=35700 Epoch=69.8] | Loss=0.00609 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.762 | acc=1.0000 | 5942.9 samples/s | 92.9 steps/s
[Step=35750 Epoch=69.9] | Loss=0.00601 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.763 | acc=1.0000 | 1977.7 samples/s | 30.9 steps/s
[Step=35800 Epoch=70.0] | Loss=0.00577 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.763 | acc=1.0000 | 4423.3 samples/s | 69.1 steps/s
[Step=35850 Epoch=70.1] | Loss=0.00565 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.764 | acc=1.0000 | 4321.2 samples/s | 67.5 steps/s
[Step=35900 Epoch=70.2] | Loss=0.00550 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.765 | acc=1.0000 | 4783.4 samples/s | 74.7 steps/s
[Step=35950 Epoch=70.3] | Loss=0.00546 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.766 | acc=1.0000 | 4757.0 samples/s | 74.3 steps/s
[Step=36000 Epoch=70.4] | Loss=0.00535 | Reg=0.00177 | L2-Norm=13.294 | L2-Norm(final)=3.767 | acc=1.0000 | 4812.0 samples/s | 75.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step36000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=134.9] | Loss=0.01890 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.754 | acc=0.9688 | 4188.1 samples/s | 65.4 steps/s
[Step=35250 Epoch=135.1] | Loss=0.00241 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.760 | acc=1.0000 | 4234.6 samples/s | 66.2 steps/s
[Step=35300 Epoch=135.3] | Loss=0.00121 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.762 | acc=1.0000 | 4562.0 samples/s | 71.3 steps/s
[Step=35350 Epoch=135.4] | Loss=0.00081 | Reg=0.00177 | L2-Norm=13.293 | L2-Norm(final)=3.762 | acc=1.0000 | 4408.2 samples/s | 68.9 steps/s
[Step=35400 Epoch=135.6] | Loss=0.00061 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.762 | acc=1.0000 | 4250.1 samples/s | 66.4 steps/s
[Step=35450 Epoch=135.8] | Loss=0.00049 | Reg=0.00177 | L2-Norm=13.292 | L2-Norm(final)=3.762 | acc=1.0000 | 5353.8 samples/s | 83.7 steps/s
[Step=35500 Epoch=136.0] | Loss=0.00041 | Reg=0.00177 | L2-Norm=13.291 | L2-Norm(final)=3.762 | acc=1.0000 | 1936.0 samples/s | 30.3 steps/s
[Step=35550 Epoch=136.2] | Loss=0.00035 | Reg=0.00177 | L2-Norm=13.290 | L2-Norm(final)=3.763 | acc=1.0000 | 4456.2 samples/s | 69.6 steps/s
[Step=35600 Epoch=136.4] | Loss=0.00031 | Reg=0.00177 | L2-Norm=13.289 | L2-Norm(final)=3.763 | acc=1.0000 | 4538.1 samples/s | 70.9 steps/s
[Step=35650 Epoch=136.6] | Loss=0.00027 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.763 | acc=1.0000 | 4454.4 samples/s | 69.6 steps/s
[Step=35700 Epoch=136.8] | Loss=0.00025 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.763 | acc=1.0000 | 5018.4 samples/s | 78.4 steps/s
[Step=35750 Epoch=137.0] | Loss=0.00022 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.763 | acc=1.0000 | 1954.4 samples/s | 30.5 steps/s
[Step=35800 Epoch=137.2] | Loss=0.00021 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.763 | acc=1.0000 | 3986.8 samples/s | 62.3 steps/s
[Step=35850 Epoch=137.4] | Loss=0.00019 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.763 | acc=1.0000 | 4009.6 samples/s | 62.7 steps/s
[Step=35900 Epoch=137.6] | Loss=0.00018 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.763 | acc=1.0000 | 4220.5 samples/s | 65.9 steps/s
[Step=35950 Epoch=137.7] | Loss=0.00017 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.763 | acc=1.0000 | 4481.7 samples/s | 70.0 steps/s
[Step=36000 Epoch=137.9] | Loss=0.00016 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.763 | acc=1.0000 | 2099.9 samples/s | 32.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=135.5] | Loss=0.07714 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.754 | acc=0.9531 | 4070.5 samples/s | 63.6 steps/s
[Step=35250 Epoch=135.7] | Loss=0.00339 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.758 | acc=1.0000 | 4197.2 samples/s | 65.6 steps/s
[Step=35300 Epoch=135.9] | Loss=0.00171 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.759 | acc=1.0000 | 4039.3 samples/s | 63.1 steps/s
[Step=35350 Epoch=136.1] | Loss=0.00115 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.760 | acc=1.0000 | 4345.8 samples/s | 67.9 steps/s
[Step=35400 Epoch=136.3] | Loss=0.00087 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.760 | acc=1.0000 | 4534.8 samples/s | 70.9 steps/s
[Step=35450 Epoch=136.5] | Loss=0.00070 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.760 | acc=1.0000 | 5740.2 samples/s | 89.7 steps/s
[Step=35500 Epoch=136.7] | Loss=0.00059 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.760 | acc=1.0000 | 1924.7 samples/s | 30.1 steps/s
[Step=35550 Epoch=136.8] | Loss=0.00050 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.761 | acc=1.0000 | 4464.6 samples/s | 69.8 steps/s
[Step=35600 Epoch=137.0] | Loss=0.00044 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.761 | acc=1.0000 | 4503.6 samples/s | 70.4 steps/s
[Step=35650 Epoch=137.2] | Loss=0.00039 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.761 | acc=1.0000 | 4382.4 samples/s | 68.5 steps/s
[Step=35700 Epoch=137.4] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.761 | acc=1.0000 | 4611.8 samples/s | 72.1 steps/s
[Step=35750 Epoch=137.6] | Loss=0.00032 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.761 | acc=1.0000 | 1969.5 samples/s | 30.8 steps/s
[Step=35800 Epoch=137.8] | Loss=0.00030 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.761 | acc=1.0000 | 4561.0 samples/s | 71.3 steps/s
[Step=35850 Epoch=138.0] | Loss=0.00028 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.761 | acc=1.0000 | 4518.0 samples/s | 70.6 steps/s
[Step=35900 Epoch=138.2] | Loss=0.00026 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.761 | acc=1.0000 | 4507.1 samples/s | 70.4 steps/s
[Step=35950 Epoch=138.4] | Loss=0.00024 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.762 | acc=1.0000 | 4656.4 samples/s | 72.8 steps/s
[Step=36000 Epoch=138.6] | Loss=0.00023 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.762 | acc=1.0000 | 2062.1 samples/s | 32.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.20053 | acc=0.9036 | tpr=0.8656 | fpr=0.0139 | 4325.8 samples/s | 16.9 steps/s
Avg test loss: 0.20695, Avg test acc: 0.90344, Avg tpr: 0.86659, Avg fpr: 0.01551, total FA: 121

Testing server on iccad2012
[Step=  50] | Loss=0.40838 | acc=0.9034 | tpr=0.9513 | fpr=0.0974 | 4285.2 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.40903 | acc=0.9036 | tpr=0.9659 | fpr=0.0976 | 7872.1 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.41195 | acc=0.9034 | tpr=0.9726 | fpr=0.0979 | 8248.9 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.41262 | acc=0.9034 | tpr=0.9738 | fpr=0.0978 | 8525.2 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.41027 | acc=0.9035 | tpr=0.9747 | fpr=0.0978 | 8093.0 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.41483 | acc=0.9031 | tpr=0.9738 | fpr=0.0982 | 7687.0 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.41886 | acc=0.9029 | tpr=0.9731 | fpr=0.0984 | 8354.1 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.42122 | acc=0.9028 | tpr=0.9716 | fpr=0.0984 | 8190.0 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.42644 | acc=0.9026 | tpr=0.9703 | fpr=0.0986 | 8470.9 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.42649 | acc=0.9025 | tpr=0.9714 | fpr=0.0987 | 7503.9 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.42600 | acc=0.9026 | tpr=0.9706 | fpr=0.0987 | 15322.9 samples/s | 59.9 steps/s
Avg test loss: 0.42561, Avg test acc: 0.90254, Avg tpr: 0.97029, Avg fpr: 0.09869, total FA: 13703

server round 45/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=70.2] | Loss=0.01931 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.772 | acc=0.9844 | 4074.2 samples/s | 63.7 steps/s
[Step=36050 Epoch=70.3] | Loss=0.01243 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.772 | acc=0.9844 | 4587.6 samples/s | 71.7 steps/s
[Step=36100 Epoch=70.4] | Loss=0.00962 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.773 | acc=1.0000 | 4754.7 samples/s | 74.3 steps/s
[Step=36150 Epoch=70.5] | Loss=0.00825 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.774 | acc=0.9844 | 4826.6 samples/s | 75.4 steps/s
[Step=36200 Epoch=70.6] | Loss=0.00748 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.775 | acc=1.0000 | 4734.3 samples/s | 74.0 steps/s
[Step=36250 Epoch=70.7] | Loss=0.00748 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.776 | acc=1.0000 | 4674.8 samples/s | 73.0 steps/s
[Step=36300 Epoch=70.8] | Loss=0.00719 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.777 | acc=1.0000 | 4323.3 samples/s | 67.6 steps/s
[Step=36350 Epoch=70.9] | Loss=0.00685 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.778 | acc=1.0000 | 4452.8 samples/s | 69.6 steps/s
[Step=36400 Epoch=71.0] | Loss=0.00673 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.779 | acc=0.9844 | 4773.6 samples/s | 74.6 steps/s
[Step=36450 Epoch=71.1] | Loss=0.00653 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.780 | acc=0.9844 | 4831.8 samples/s | 75.5 steps/s
[Step=36500 Epoch=71.2] | Loss=0.00639 | Reg=0.00177 | L2-Norm=13.285 | L2-Norm(final)=3.781 | acc=1.0000 | 5774.8 samples/s | 90.2 steps/s
[Step=36550 Epoch=71.3] | Loss=0.00612 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.782 | acc=1.0000 | 1959.3 samples/s | 30.6 steps/s
[Step=36600 Epoch=71.4] | Loss=0.00606 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.783 | acc=1.0000 | 4736.0 samples/s | 74.0 steps/s
[Step=36650 Epoch=71.5] | Loss=0.00594 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.784 | acc=0.9688 | 4645.9 samples/s | 72.6 steps/s
[Step=36700 Epoch=71.6] | Loss=0.00579 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.785 | acc=1.0000 | 4631.1 samples/s | 72.4 steps/s
[Step=36750 Epoch=71.7] | Loss=0.00559 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.787 | acc=0.9844 | 4280.8 samples/s | 66.9 steps/s
[Step=36800 Epoch=71.8] | Loss=0.00561 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.788 | acc=0.9844 | 4686.7 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=70.4] | Loss=0.01426 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.772 | acc=0.9844 | 4210.4 samples/s | 65.8 steps/s
[Step=36050 Epoch=70.5] | Loss=0.01762 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.769 | acc=1.0000 | 4421.0 samples/s | 69.1 steps/s
[Step=36100 Epoch=70.6] | Loss=0.01115 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.769 | acc=1.0000 | 4749.5 samples/s | 74.2 steps/s
[Step=36150 Epoch=70.7] | Loss=0.00912 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.770 | acc=1.0000 | 4751.7 samples/s | 74.2 steps/s
[Step=36200 Epoch=70.8] | Loss=0.00818 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.772 | acc=1.0000 | 4764.0 samples/s | 74.4 steps/s
[Step=36250 Epoch=70.9] | Loss=0.00760 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.773 | acc=1.0000 | 4653.2 samples/s | 72.7 steps/s
[Step=36300 Epoch=71.0] | Loss=0.00690 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.774 | acc=0.9844 | 4698.1 samples/s | 73.4 steps/s
[Step=36350 Epoch=71.1] | Loss=0.00674 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.775 | acc=1.0000 | 4322.5 samples/s | 67.5 steps/s
[Step=36400 Epoch=71.2] | Loss=0.00655 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.776 | acc=1.0000 | 4727.0 samples/s | 73.9 steps/s
[Step=36450 Epoch=71.3] | Loss=0.00634 | Reg=0.00176 | L2-Norm=13.285 | L2-Norm(final)=3.777 | acc=1.0000 | 4734.4 samples/s | 74.0 steps/s
[Step=36500 Epoch=71.4] | Loss=0.00626 | Reg=0.00177 | L2-Norm=13.285 | L2-Norm(final)=3.778 | acc=1.0000 | 5874.3 samples/s | 91.8 steps/s
[Step=36550 Epoch=71.5] | Loss=0.00588 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.779 | acc=1.0000 | 2007.0 samples/s | 31.4 steps/s
[Step=36600 Epoch=71.6] | Loss=0.00571 | Reg=0.00177 | L2-Norm=13.286 | L2-Norm(final)=3.780 | acc=1.0000 | 4723.6 samples/s | 73.8 steps/s
[Step=36650 Epoch=71.6] | Loss=0.00551 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.781 | acc=0.9844 | 4802.3 samples/s | 75.0 steps/s
[Step=36700 Epoch=71.7] | Loss=0.00542 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.782 | acc=1.0000 | 4602.6 samples/s | 71.9 steps/s
[Step=36750 Epoch=71.8] | Loss=0.00541 | Reg=0.00177 | L2-Norm=13.287 | L2-Norm(final)=3.783 | acc=1.0000 | 4336.4 samples/s | 67.8 steps/s
[Step=36800 Epoch=71.9] | Loss=0.00549 | Reg=0.00177 | L2-Norm=13.288 | L2-Norm(final)=3.784 | acc=1.0000 | 4315.9 samples/s | 67.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step36800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=137.9] | Loss=0.05573 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.772 | acc=0.9688 | 4328.7 samples/s | 67.6 steps/s
[Step=36050 Epoch=138.1] | Loss=0.00229 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.775 | acc=1.0000 | 3987.5 samples/s | 62.3 steps/s
[Step=36100 Epoch=138.3] | Loss=0.00117 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.776 | acc=1.0000 | 4607.8 samples/s | 72.0 steps/s
[Step=36150 Epoch=138.5] | Loss=0.00079 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.777 | acc=1.0000 | 4447.5 samples/s | 69.5 steps/s
[Step=36200 Epoch=138.7] | Loss=0.00060 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.777 | acc=1.0000 | 4555.0 samples/s | 71.2 steps/s
[Step=36250 Epoch=138.9] | Loss=0.00049 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.778 | acc=1.0000 | 5691.7 samples/s | 88.9 steps/s
[Step=36300 Epoch=139.1] | Loss=0.00041 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.778 | acc=1.0000 | 1781.2 samples/s | 27.8 steps/s
[Step=36350 Epoch=139.3] | Loss=0.00035 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.778 | acc=1.0000 | 4395.2 samples/s | 68.7 steps/s
[Step=36400 Epoch=139.5] | Loss=0.00031 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.779 | acc=1.0000 | 4514.7 samples/s | 70.5 steps/s
[Step=36450 Epoch=139.7] | Loss=0.00027 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.779 | acc=1.0000 | 4541.2 samples/s | 71.0 steps/s
[Step=36500 Epoch=139.9] | Loss=0.00025 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.779 | acc=1.0000 | 5002.9 samples/s | 78.2 steps/s
[Step=36550 Epoch=140.0] | Loss=0.00023 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.779 | acc=1.0000 | 2031.4 samples/s | 31.7 steps/s
[Step=36600 Epoch=140.2] | Loss=0.00021 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.779 | acc=1.0000 | 4519.2 samples/s | 70.6 steps/s
[Step=36650 Epoch=140.4] | Loss=0.00019 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.780 | acc=1.0000 | 4252.1 samples/s | 66.4 steps/s
[Step=36700 Epoch=140.6] | Loss=0.00018 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.780 | acc=1.0000 | 4043.5 samples/s | 63.2 steps/s
[Step=36750 Epoch=140.8] | Loss=0.00017 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.780 | acc=1.0000 | 4264.6 samples/s | 66.6 steps/s
[Step=36800 Epoch=141.0] | Loss=0.00016 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.780 | acc=1.0000 | 2102.1 samples/s | 32.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=138.6] | Loss=0.00072 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.772 | acc=1.0000 | 4457.1 samples/s | 69.6 steps/s
[Step=36050 Epoch=138.8] | Loss=0.00225 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.776 | acc=1.0000 | 4152.5 samples/s | 64.9 steps/s
[Step=36100 Epoch=139.0] | Loss=0.00114 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.777 | acc=1.0000 | 4501.3 samples/s | 70.3 steps/s
[Step=36150 Epoch=139.2] | Loss=0.00077 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.777 | acc=1.0000 | 4402.8 samples/s | 68.8 steps/s
[Step=36200 Epoch=139.3] | Loss=0.00058 | Reg=0.00176 | L2-Norm=13.284 | L2-Norm(final)=3.778 | acc=1.0000 | 4321.8 samples/s | 67.5 steps/s
[Step=36250 Epoch=139.5] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.283 | L2-Norm(final)=3.778 | acc=1.0000 | 5053.4 samples/s | 79.0 steps/s
[Step=36300 Epoch=139.7] | Loss=0.00040 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.778 | acc=1.0000 | 1911.6 samples/s | 29.9 steps/s
[Step=36350 Epoch=139.9] | Loss=0.00034 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.779 | acc=1.0000 | 4528.7 samples/s | 70.8 steps/s
[Step=36400 Epoch=140.1] | Loss=0.00030 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.779 | acc=1.0000 | 4492.5 samples/s | 70.2 steps/s
[Step=36450 Epoch=140.3] | Loss=0.00027 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.779 | acc=1.0000 | 4561.4 samples/s | 71.3 steps/s
[Step=36500 Epoch=140.5] | Loss=0.00024 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.779 | acc=1.0000 | 5083.5 samples/s | 79.4 steps/s
[Step=36550 Epoch=140.7] | Loss=0.00022 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.779 | acc=1.0000 | 1914.8 samples/s | 29.9 steps/s
[Step=36600 Epoch=140.9] | Loss=0.00020 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.780 | acc=1.0000 | 4094.2 samples/s | 64.0 steps/s
[Step=36650 Epoch=141.1] | Loss=0.00019 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.780 | acc=1.0000 | 4476.0 samples/s | 69.9 steps/s
[Step=36700 Epoch=141.3] | Loss=0.00018 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.780 | acc=1.0000 | 4575.9 samples/s | 71.5 steps/s
[Step=36750 Epoch=141.5] | Loss=0.00016 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.780 | acc=1.0000 | 4589.5 samples/s | 71.7 steps/s
[Step=36800 Epoch=141.7] | Loss=0.00015 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.780 | acc=1.0000 | 2077.6 samples/s | 32.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.19012 | acc=0.9082 | tpr=0.8724 | fpr=0.0141 | 4241.5 samples/s | 16.6 steps/s
Avg test loss: 0.19664, Avg test acc: 0.90869, Avg tpr: 0.87434, Avg fpr: 0.01577, total FA: 123

Testing server on iccad2012
[Step=  50] | Loss=0.41810 | acc=0.9011 | tpr=0.9513 | fpr=0.0998 | 4320.2 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.41947 | acc=0.9011 | tpr=0.9659 | fpr=0.1001 | 8377.7 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.42270 | acc=0.9010 | tpr=0.9726 | fpr=0.1003 | 7464.0 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.42369 | acc=0.9011 | tpr=0.9738 | fpr=0.1002 | 8522.4 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.42114 | acc=0.9014 | tpr=0.9747 | fpr=0.0999 | 8389.0 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.42572 | acc=0.9012 | tpr=0.9745 | fpr=0.1002 | 8096.3 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.42975 | acc=0.9009 | tpr=0.9737 | fpr=0.1004 | 7880.6 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.43215 | acc=0.9008 | tpr=0.9721 | fpr=0.1004 | 8534.7 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.43746 | acc=0.9006 | tpr=0.9708 | fpr=0.1007 | 8452.1 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.43742 | acc=0.9006 | tpr=0.9714 | fpr=0.1007 | 8675.0 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.43691 | acc=0.9007 | tpr=0.9710 | fpr=0.1006 | 12946.3 samples/s | 50.6 steps/s
Avg test loss: 0.43654, Avg test acc: 0.90067, Avg tpr: 0.97068, Avg fpr: 0.10061, total FA: 13969

server round 46/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=71.8] | Loss=0.03043 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.791 | acc=0.9688 | 3755.4 samples/s | 58.7 steps/s
[Step=36850 Epoch=71.9] | Loss=0.01639 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.789 | acc=1.0000 | 4567.3 samples/s | 71.4 steps/s
[Step=36900 Epoch=72.0] | Loss=0.01112 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.789 | acc=0.9844 | 4761.6 samples/s | 74.4 steps/s
[Step=36950 Epoch=72.1] | Loss=0.00900 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.790 | acc=1.0000 | 4765.1 samples/s | 74.5 steps/s
[Step=37000 Epoch=72.2] | Loss=0.00809 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.791 | acc=1.0000 | 4748.7 samples/s | 74.2 steps/s
[Step=37050 Epoch=72.3] | Loss=0.00742 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.792 | acc=0.9844 | 4730.6 samples/s | 73.9 steps/s
[Step=37100 Epoch=72.4] | Loss=0.00707 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.793 | acc=0.9844 | 4801.4 samples/s | 75.0 steps/s
[Step=37150 Epoch=72.5] | Loss=0.00677 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.794 | acc=1.0000 | 4779.9 samples/s | 74.7 steps/s
[Step=37200 Epoch=72.6] | Loss=0.00678 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.795 | acc=0.9844 | 4615.7 samples/s | 72.1 steps/s
[Step=37250 Epoch=72.7] | Loss=0.00665 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.796 | acc=1.0000 | 4289.8 samples/s | 67.0 steps/s
[Step=37300 Epoch=72.7] | Loss=0.00644 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.798 | acc=1.0000 | 5275.6 samples/s | 82.4 steps/s
[Step=37350 Epoch=72.8] | Loss=0.00618 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.799 | acc=1.0000 | 1967.8 samples/s | 30.7 steps/s
[Step=37400 Epoch=72.9] | Loss=0.00609 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.800 | acc=1.0000 | 4641.7 samples/s | 72.5 steps/s
[Step=37450 Epoch=73.0] | Loss=0.00594 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.801 | acc=1.0000 | 4801.9 samples/s | 75.0 steps/s
[Step=37500 Epoch=73.1] | Loss=0.00579 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.802 | acc=1.0000 | 4755.7 samples/s | 74.3 steps/s
[Step=37550 Epoch=73.2] | Loss=0.00575 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.803 | acc=1.0000 | 4741.3 samples/s | 74.1 steps/s
[Step=37600 Epoch=73.3] | Loss=0.00570 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.804 | acc=1.0000 | 4659.6 samples/s | 72.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step37600.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=71.9] | Loss=0.11343 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.791 | acc=0.9375 | 4468.5 samples/s | 69.8 steps/s
[Step=36850 Epoch=72.0] | Loss=0.01758 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.787 | acc=1.0000 | 4003.0 samples/s | 62.5 steps/s
[Step=36900 Epoch=72.1] | Loss=0.01186 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.788 | acc=1.0000 | 4794.3 samples/s | 74.9 steps/s
[Step=36950 Epoch=72.2] | Loss=0.00922 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.789 | acc=1.0000 | 4729.3 samples/s | 73.9 steps/s
[Step=37000 Epoch=72.3] | Loss=0.00830 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.790 | acc=1.0000 | 4788.4 samples/s | 74.8 steps/s
[Step=37050 Epoch=72.4] | Loss=0.00763 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.791 | acc=0.9844 | 4846.1 samples/s | 75.7 steps/s
[Step=37100 Epoch=72.5] | Loss=0.00706 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.792 | acc=1.0000 | 4701.9 samples/s | 73.5 steps/s
[Step=37150 Epoch=72.6] | Loss=0.00676 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.793 | acc=1.0000 | 4799.8 samples/s | 75.0 steps/s
[Step=37200 Epoch=72.7] | Loss=0.00657 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.794 | acc=0.9844 | 4716.4 samples/s | 73.7 steps/s
[Step=37250 Epoch=72.8] | Loss=0.00657 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.795 | acc=1.0000 | 4683.8 samples/s | 73.2 steps/s
[Step=37300 Epoch=72.9] | Loss=0.00638 | Reg=0.00176 | L2-Norm=13.279 | L2-Norm(final)=3.796 | acc=1.0000 | 5276.2 samples/s | 82.4 steps/s
[Step=37350 Epoch=73.0] | Loss=0.00615 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.797 | acc=0.9844 | 1987.4 samples/s | 31.1 steps/s
[Step=37400 Epoch=73.1] | Loss=0.00593 | Reg=0.00176 | L2-Norm=13.280 | L2-Norm(final)=3.798 | acc=1.0000 | 4735.8 samples/s | 74.0 steps/s
[Step=37450 Epoch=73.2] | Loss=0.00573 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.799 | acc=1.0000 | 4753.4 samples/s | 74.3 steps/s
[Step=37500 Epoch=73.3] | Loss=0.00573 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.800 | acc=1.0000 | 4782.6 samples/s | 74.7 steps/s
[Step=37550 Epoch=73.4] | Loss=0.00559 | Reg=0.00176 | L2-Norm=13.281 | L2-Norm(final)=3.801 | acc=0.9844 | 4790.5 samples/s | 74.9 steps/s
[Step=37600 Epoch=73.5] | Loss=0.00552 | Reg=0.00176 | L2-Norm=13.282 | L2-Norm(final)=3.801 | acc=1.0000 | 4766.3 samples/s | 74.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step37600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=141.0] | Loss=0.01369 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.791 | acc=0.9844 | 4257.3 samples/s | 66.5 steps/s
[Step=36850 Epoch=141.2] | Loss=0.00182 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.796 | acc=1.0000 | 3669.4 samples/s | 57.3 steps/s
[Step=36900 Epoch=141.4] | Loss=0.00091 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.797 | acc=1.0000 | 4399.2 samples/s | 68.7 steps/s
[Step=36950 Epoch=141.6] | Loss=0.00061 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.797 | acc=1.0000 | 4547.7 samples/s | 71.1 steps/s
[Step=37000 Epoch=141.8] | Loss=0.00046 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.798 | acc=1.0000 | 4565.8 samples/s | 71.3 steps/s
[Step=37050 Epoch=142.0] | Loss=0.00037 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.798 | acc=1.0000 | 5616.0 samples/s | 87.7 steps/s
[Step=37100 Epoch=142.2] | Loss=0.00031 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.798 | acc=1.0000 | 1929.8 samples/s | 30.2 steps/s
[Step=37150 Epoch=142.3] | Loss=0.00027 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.798 | acc=1.0000 | 4456.1 samples/s | 69.6 steps/s
[Step=37200 Epoch=142.5] | Loss=0.00024 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.798 | acc=1.0000 | 4382.4 samples/s | 68.5 steps/s
[Step=37250 Epoch=142.7] | Loss=0.00021 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.798 | acc=1.0000 | 4081.0 samples/s | 63.8 steps/s
[Step=37300 Epoch=142.9] | Loss=0.00019 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.798 | acc=1.0000 | 4845.1 samples/s | 75.7 steps/s
[Step=37350 Epoch=143.1] | Loss=0.00017 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.799 | acc=1.0000 | 2011.0 samples/s | 31.4 steps/s
[Step=37400 Epoch=143.3] | Loss=0.00016 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.799 | acc=1.0000 | 4558.8 samples/s | 71.2 steps/s
[Step=37450 Epoch=143.5] | Loss=0.00015 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.799 | acc=1.0000 | 4571.4 samples/s | 71.4 steps/s
[Step=37500 Epoch=143.7] | Loss=0.00014 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.799 | acc=1.0000 | 4501.8 samples/s | 70.3 steps/s
[Step=37550 Epoch=143.9] | Loss=0.00013 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.799 | acc=1.0000 | 4530.3 samples/s | 70.8 steps/s
[Step=37600 Epoch=144.1] | Loss=0.00012 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.799 | acc=1.0000 | 1973.9 samples/s | 30.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step37600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=141.7] | Loss=0.03745 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.791 | acc=0.9844 | 4017.2 samples/s | 62.8 steps/s
[Step=36850 Epoch=141.9] | Loss=0.00341 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.793 | acc=1.0000 | 4432.4 samples/s | 69.3 steps/s
[Step=36900 Epoch=142.0] | Loss=0.00173 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.793 | acc=1.0000 | 4605.3 samples/s | 72.0 steps/s
[Step=36950 Epoch=142.2] | Loss=0.00116 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.794 | acc=1.0000 | 4461.9 samples/s | 69.7 steps/s
[Step=37000 Epoch=142.4] | Loss=0.00088 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.794 | acc=1.0000 | 4511.2 samples/s | 70.5 steps/s
[Step=37050 Epoch=142.6] | Loss=0.00070 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.794 | acc=1.0000 | 5778.0 samples/s | 90.3 steps/s
[Step=37100 Epoch=142.8] | Loss=0.00059 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.795 | acc=1.0000 | 1888.4 samples/s | 29.5 steps/s
[Step=37150 Epoch=143.0] | Loss=0.00051 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.795 | acc=1.0000 | 4066.4 samples/s | 63.5 steps/s
[Step=37200 Epoch=143.2] | Loss=0.00044 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.795 | acc=1.0000 | 4457.9 samples/s | 69.7 steps/s
[Step=37250 Epoch=143.4] | Loss=0.00040 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.795 | acc=1.0000 | 4493.1 samples/s | 70.2 steps/s
[Step=37300 Epoch=143.6] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.795 | acc=1.0000 | 5113.3 samples/s | 79.9 steps/s
[Step=37350 Epoch=143.8] | Loss=0.00032 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.796 | acc=1.0000 | 2016.2 samples/s | 31.5 steps/s
[Step=37400 Epoch=144.0] | Loss=0.00030 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.796 | acc=1.0000 | 4507.6 samples/s | 70.4 steps/s
[Step=37450 Epoch=144.2] | Loss=0.00028 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.796 | acc=1.0000 | 4430.4 samples/s | 69.2 steps/s
[Step=37500 Epoch=144.4] | Loss=0.00026 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.796 | acc=1.0000 | 4448.3 samples/s | 69.5 steps/s
[Step=37550 Epoch=144.5] | Loss=0.00024 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.796 | acc=1.0000 | 4125.8 samples/s | 64.5 steps/s
[Step=37600 Epoch=144.7] | Loss=0.00023 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.796 | acc=1.0000 | 2069.4 samples/s | 32.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18973 | acc=0.9094 | tpr=0.8739 | fpr=0.0136 | 4346.3 samples/s | 17.0 steps/s
Avg test loss: 0.19682, Avg test acc: 0.90965, Avg tpr: 0.87544, Avg fpr: 0.01513, total FA: 118

Testing server on iccad2012
[Step=  50] | Loss=0.42274 | acc=0.9027 | tpr=0.9513 | fpr=0.0982 | 4245.4 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.42418 | acc=0.9025 | tpr=0.9659 | fpr=0.0986 | 8257.6 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.42731 | acc=0.9024 | tpr=0.9726 | fpr=0.0989 | 8206.1 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.42817 | acc=0.9023 | tpr=0.9738 | fpr=0.0990 | 7723.8 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.42548 | acc=0.9025 | tpr=0.9747 | fpr=0.0989 | 8358.3 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.43013 | acc=0.9021 | tpr=0.9753 | fpr=0.0992 | 8308.6 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.43426 | acc=0.9018 | tpr=0.9743 | fpr=0.0995 | 8282.0 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.43677 | acc=0.9017 | tpr=0.9726 | fpr=0.0996 | 7566.6 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.44221 | acc=0.9013 | tpr=0.9713 | fpr=0.0999 | 8388.9 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.44219 | acc=0.9012 | tpr=0.9722 | fpr=0.1001 | 8058.4 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.44170 | acc=0.9013 | tpr=0.9717 | fpr=0.1000 | 15205.2 samples/s | 59.4 steps/s
Avg test loss: 0.44132, Avg test acc: 0.90127, Avg tpr: 0.97147, Avg fpr: 0.10001, total FA: 13886

server round 47/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=73.3] | Loss=0.10158 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.808 | acc=0.9375 | 3910.7 samples/s | 61.1 steps/s
[Step=37650 Epoch=73.4] | Loss=0.01708 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.806 | acc=1.0000 | 4527.1 samples/s | 70.7 steps/s
[Step=37700 Epoch=73.5] | Loss=0.01147 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.805 | acc=0.9844 | 4425.2 samples/s | 69.1 steps/s
[Step=37750 Epoch=73.6] | Loss=0.00959 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.806 | acc=1.0000 | 4641.0 samples/s | 72.5 steps/s
[Step=37800 Epoch=73.7] | Loss=0.00859 | Reg=0.00176 | L2-Norm=13.272 | L2-Norm(final)=3.807 | acc=1.0000 | 4730.7 samples/s | 73.9 steps/s
[Step=37850 Epoch=73.8] | Loss=0.00754 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.808 | acc=1.0000 | 4834.2 samples/s | 75.5 steps/s
[Step=37900 Epoch=73.9] | Loss=0.00703 | Reg=0.00176 | L2-Norm=13.273 | L2-Norm(final)=3.809 | acc=0.9844 | 4740.0 samples/s | 74.1 steps/s
[Step=37950 Epoch=74.0] | Loss=0.00687 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.810 | acc=0.9688 | 4769.1 samples/s | 74.5 steps/s
[Step=38000 Epoch=74.1] | Loss=0.00659 | Reg=0.00176 | L2-Norm=13.274 | L2-Norm(final)=3.811 | acc=0.9844 | 4783.7 samples/s | 74.7 steps/s
[Step=38050 Epoch=74.2] | Loss=0.00653 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.812 | acc=1.0000 | 4785.5 samples/s | 74.8 steps/s
[Step=38100 Epoch=74.3] | Loss=0.00642 | Reg=0.00176 | L2-Norm=13.275 | L2-Norm(final)=3.813 | acc=0.9844 | 5760.5 samples/s | 90.0 steps/s
[Step=38150 Epoch=74.4] | Loss=0.00627 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.813 | acc=0.9688 | 1836.3 samples/s | 28.7 steps/s
[Step=38200 Epoch=74.5] | Loss=0.00605 | Reg=0.00176 | L2-Norm=13.276 | L2-Norm(final)=3.814 | acc=1.0000 | 4666.7 samples/s | 72.9 steps/s
[Step=38250 Epoch=74.6] | Loss=0.00590 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.815 | acc=1.0000 | 4817.8 samples/s | 75.3 steps/s
[Step=38300 Epoch=74.7] | Loss=0.00583 | Reg=0.00176 | L2-Norm=13.277 | L2-Norm(final)=3.816 | acc=1.0000 | 4703.5 samples/s | 73.5 steps/s
[Step=38350 Epoch=74.8] | Loss=0.00571 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.817 | acc=1.0000 | 4773.8 samples/s | 74.6 steps/s
[Step=38400 Epoch=74.9] | Loss=0.00568 | Reg=0.00176 | L2-Norm=13.278 | L2-Norm(final)=3.818 | acc=0.9844 | 4795.5 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step38400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=73.5] | Loss=0.06877 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.808 | acc=0.9688 | 3881.1 samples/s | 60.6 steps/s
[Step=37650 Epoch=73.6] | Loss=0.01760 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.806 | acc=1.0000 | 4520.2 samples/s | 70.6 steps/s
[Step=37700 Epoch=73.7] | Loss=0.01202 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.805 | acc=1.0000 | 4380.5 samples/s | 68.4 steps/s
[Step=37750 Epoch=73.8] | Loss=0.00935 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.806 | acc=1.0000 | 4643.5 samples/s | 72.6 steps/s
[Step=37800 Epoch=73.9] | Loss=0.00814 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.807 | acc=0.9844 | 4680.6 samples/s | 73.1 steps/s
[Step=37850 Epoch=74.0] | Loss=0.00751 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.808 | acc=1.0000 | 4863.9 samples/s | 76.0 steps/s
[Step=37900 Epoch=74.1] | Loss=0.00698 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.809 | acc=1.0000 | 4719.5 samples/s | 73.7 steps/s
[Step=37950 Epoch=74.2] | Loss=0.00668 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.810 | acc=0.9844 | 4774.2 samples/s | 74.6 steps/s
[Step=38000 Epoch=74.3] | Loss=0.00670 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.811 | acc=1.0000 | 4871.9 samples/s | 76.1 steps/s
[Step=38050 Epoch=74.4] | Loss=0.00637 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.812 | acc=1.0000 | 4701.2 samples/s | 73.5 steps/s
[Step=38100 Epoch=74.5] | Loss=0.00629 | Reg=0.00176 | L2-Norm=13.269 | L2-Norm(final)=3.812 | acc=0.9844 | 5839.8 samples/s | 91.2 steps/s
[Step=38150 Epoch=74.6] | Loss=0.00609 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.813 | acc=1.0000 | 1863.6 samples/s | 29.1 steps/s
[Step=38200 Epoch=74.7] | Loss=0.00590 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.814 | acc=1.0000 | 4420.6 samples/s | 69.1 steps/s
[Step=38250 Epoch=74.8] | Loss=0.00574 | Reg=0.00176 | L2-Norm=13.270 | L2-Norm(final)=3.815 | acc=1.0000 | 4790.0 samples/s | 74.8 steps/s
[Step=38300 Epoch=74.9] | Loss=0.00566 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.816 | acc=1.0000 | 4774.7 samples/s | 74.6 steps/s
[Step=38350 Epoch=75.0] | Loss=0.00564 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.817 | acc=1.0000 | 4729.4 samples/s | 73.9 steps/s
[Step=38400 Epoch=75.1] | Loss=0.00558 | Reg=0.00176 | L2-Norm=13.271 | L2-Norm(final)=3.817 | acc=1.0000 | 4791.3 samples/s | 74.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step38400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=144.1] | Loss=0.07359 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.808 | acc=0.9688 | 4100.3 samples/s | 64.1 steps/s
[Step=37650 Epoch=144.3] | Loss=0.00460 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.810 | acc=1.0000 | 4000.6 samples/s | 62.5 steps/s
[Step=37700 Epoch=144.5] | Loss=0.00231 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.810 | acc=1.0000 | 4296.9 samples/s | 67.1 steps/s
[Step=37750 Epoch=144.6] | Loss=0.00154 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.810 | acc=1.0000 | 4146.6 samples/s | 64.8 steps/s
[Step=37800 Epoch=144.8] | Loss=0.00116 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.810 | acc=1.0000 | 4535.4 samples/s | 70.9 steps/s
[Step=37850 Epoch=145.0] | Loss=0.00093 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.810 | acc=1.0000 | 5679.1 samples/s | 88.7 steps/s
[Step=37900 Epoch=145.2] | Loss=0.00078 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.811 | acc=1.0000 | 1938.1 samples/s | 30.3 steps/s
[Step=37950 Epoch=145.4] | Loss=0.00067 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.811 | acc=1.0000 | 4496.8 samples/s | 70.3 steps/s
[Step=38000 Epoch=145.6] | Loss=0.00058 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.811 | acc=1.0000 | 4522.1 samples/s | 70.7 steps/s
[Step=38050 Epoch=145.8] | Loss=0.00052 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.811 | acc=1.0000 | 4458.7 samples/s | 69.7 steps/s
[Step=38100 Epoch=146.0] | Loss=0.00047 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.811 | acc=1.0000 | 4818.2 samples/s | 75.3 steps/s
[Step=38150 Epoch=146.2] | Loss=0.00043 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.811 | acc=1.0000 | 1963.8 samples/s | 30.7 steps/s
[Step=38200 Epoch=146.4] | Loss=0.00039 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.811 | acc=1.0000 | 4581.2 samples/s | 71.6 steps/s
[Step=38250 Epoch=146.6] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.811 | acc=1.0000 | 4515.3 samples/s | 70.6 steps/s
[Step=38300 Epoch=146.8] | Loss=0.00034 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.812 | acc=1.0000 | 4223.3 samples/s | 66.0 steps/s
[Step=38350 Epoch=146.9] | Loss=0.00031 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.812 | acc=1.0000 | 4453.4 samples/s | 69.6 steps/s
[Step=38400 Epoch=147.1] | Loss=0.00029 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.812 | acc=1.0000 | 2063.7 samples/s | 32.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step38400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=144.7] | Loss=0.02914 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.808 | acc=0.9844 | 4087.4 samples/s | 63.9 steps/s
[Step=37650 Epoch=144.9] | Loss=0.00295 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.812 | acc=1.0000 | 3728.6 samples/s | 58.3 steps/s
[Step=37700 Epoch=145.1] | Loss=0.00148 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.813 | acc=1.0000 | 4549.4 samples/s | 71.1 steps/s
[Step=37750 Epoch=145.3] | Loss=0.00099 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.813 | acc=1.0000 | 4520.0 samples/s | 70.6 steps/s
[Step=37800 Epoch=145.5] | Loss=0.00075 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.813 | acc=1.0000 | 4518.7 samples/s | 70.6 steps/s
[Step=37850 Epoch=145.7] | Loss=0.00060 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.813 | acc=1.0000 | 5783.6 samples/s | 90.4 steps/s
[Step=37900 Epoch=145.9] | Loss=0.00050 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.813 | acc=1.0000 | 1939.5 samples/s | 30.3 steps/s
[Step=37950 Epoch=146.1] | Loss=0.00043 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.813 | acc=1.0000 | 4285.1 samples/s | 67.0 steps/s
[Step=38000 Epoch=146.3] | Loss=0.00038 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.814 | acc=1.0000 | 4125.4 samples/s | 64.5 steps/s
[Step=38050 Epoch=146.5] | Loss=0.00034 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.814 | acc=1.0000 | 4225.3 samples/s | 66.0 steps/s
[Step=38100 Epoch=146.7] | Loss=0.00030 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.814 | acc=1.0000 | 5114.2 samples/s | 79.9 steps/s
[Step=38150 Epoch=146.9] | Loss=0.00028 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.814 | acc=1.0000 | 2000.2 samples/s | 31.3 steps/s
[Step=38200 Epoch=147.0] | Loss=0.00026 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.814 | acc=1.0000 | 4547.6 samples/s | 71.1 steps/s
[Step=38250 Epoch=147.2] | Loss=0.00024 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.814 | acc=1.0000 | 4505.4 samples/s | 70.4 steps/s
[Step=38300 Epoch=147.4] | Loss=0.00022 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.814 | acc=1.0000 | 4493.2 samples/s | 70.2 steps/s
[Step=38350 Epoch=147.6] | Loss=0.00021 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.814 | acc=1.0000 | 4543.1 samples/s | 71.0 steps/s
[Step=38400 Epoch=147.8] | Loss=0.00019 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.814 | acc=1.0000 | 2008.5 samples/s | 31.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18192 | acc=0.9119 | tpr=0.8780 | fpr=0.0146 | 4487.8 samples/s | 17.5 steps/s
Avg test loss: 0.18930, Avg test acc: 0.91197, Avg tpr: 0.87912, Avg fpr: 0.01577, total FA: 123

Testing server on iccad2012
[Step=  50] | Loss=0.42841 | acc=0.9020 | tpr=0.9513 | fpr=0.0989 | 4142.4 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.43048 | acc=0.9017 | tpr=0.9659 | fpr=0.0995 | 8337.6 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.43369 | acc=0.9017 | tpr=0.9741 | fpr=0.0996 | 8442.6 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.43454 | acc=0.9016 | tpr=0.9749 | fpr=0.0997 | 8538.8 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.43147 | acc=0.9019 | tpr=0.9755 | fpr=0.0994 | 7391.1 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.43629 | acc=0.9015 | tpr=0.9753 | fpr=0.0998 | 8538.7 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.44039 | acc=0.9013 | tpr=0.9743 | fpr=0.1001 | 8092.9 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.44295 | acc=0.9011 | tpr=0.9726 | fpr=0.1002 | 8426.1 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.44840 | acc=0.9009 | tpr=0.9713 | fpr=0.1004 | 7730.9 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.44825 | acc=0.9008 | tpr=0.9718 | fpr=0.1005 | 8246.0 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.44770 | acc=0.9009 | tpr=0.9713 | fpr=0.1004 | 14903.7 samples/s | 58.2 steps/s
Avg test loss: 0.44733, Avg test acc: 0.90086, Avg tpr: 0.97108, Avg fpr: 0.10042, total FA: 13943

server round 48/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=74.9] | Loss=0.09450 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.822 | acc=0.9219 | 3753.2 samples/s | 58.6 steps/s
[Step=38450 Epoch=75.0] | Loss=0.01616 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.821 | acc=1.0000 | 4775.3 samples/s | 74.6 steps/s
[Step=38500 Epoch=75.1] | Loss=0.01074 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.821 | acc=0.9688 | 4603.0 samples/s | 71.9 steps/s
[Step=38550 Epoch=75.2] | Loss=0.00925 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.822 | acc=1.0000 | 4660.8 samples/s | 72.8 steps/s
[Step=38600 Epoch=75.3] | Loss=0.00788 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.823 | acc=1.0000 | 4426.4 samples/s | 69.2 steps/s
[Step=38650 Epoch=75.4] | Loss=0.00726 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.824 | acc=1.0000 | 4588.2 samples/s | 71.7 steps/s
[Step=38700 Epoch=75.5] | Loss=0.00717 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.825 | acc=1.0000 | 4851.3 samples/s | 75.8 steps/s
[Step=38750 Epoch=75.6] | Loss=0.00678 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.825 | acc=0.9688 | 4783.0 samples/s | 74.7 steps/s
[Step=38800 Epoch=75.7] | Loss=0.00667 | Reg=0.00176 | L2-Norm=13.264 | L2-Norm(final)=3.826 | acc=1.0000 | 4764.2 samples/s | 74.4 steps/s
[Step=38850 Epoch=75.8] | Loss=0.00639 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.827 | acc=0.9844 | 4766.6 samples/s | 74.5 steps/s
[Step=38900 Epoch=75.9] | Loss=0.00628 | Reg=0.00176 | L2-Norm=13.265 | L2-Norm(final)=3.828 | acc=0.9844 | 5802.7 samples/s | 90.7 steps/s
[Step=38950 Epoch=76.0] | Loss=0.00622 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.829 | acc=1.0000 | 1949.0 samples/s | 30.5 steps/s
[Step=39000 Epoch=76.1] | Loss=0.00602 | Reg=0.00176 | L2-Norm=13.266 | L2-Norm(final)=3.830 | acc=1.0000 | 4407.0 samples/s | 68.9 steps/s
[Step=39050 Epoch=76.2] | Loss=0.00586 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.831 | acc=1.0000 | 4308.4 samples/s | 67.3 steps/s
[Step=39100 Epoch=76.3] | Loss=0.00577 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.832 | acc=0.9844 | 4652.4 samples/s | 72.7 steps/s
[Step=39150 Epoch=76.4] | Loss=0.00563 | Reg=0.00176 | L2-Norm=13.267 | L2-Norm(final)=3.833 | acc=1.0000 | 4734.9 samples/s | 74.0 steps/s
[Step=39200 Epoch=76.5] | Loss=0.00561 | Reg=0.00176 | L2-Norm=13.268 | L2-Norm(final)=3.834 | acc=0.9844 | 4706.6 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step39200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=75.1] | Loss=0.00731 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.823 | acc=0.9844 | 4498.2 samples/s | 70.3 steps/s
[Step=38450 Epoch=75.2] | Loss=0.01539 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.820 | acc=1.0000 | 4411.5 samples/s | 68.9 steps/s
[Step=38500 Epoch=75.3] | Loss=0.01009 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.821 | acc=1.0000 | 4711.6 samples/s | 73.6 steps/s
[Step=38550 Epoch=75.4] | Loss=0.00855 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.821 | acc=1.0000 | 4637.9 samples/s | 72.5 steps/s
[Step=38600 Epoch=75.5] | Loss=0.00784 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.822 | acc=1.0000 | 4588.8 samples/s | 71.7 steps/s
[Step=38650 Epoch=75.6] | Loss=0.00712 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.823 | acc=1.0000 | 4243.9 samples/s | 66.3 steps/s
[Step=38700 Epoch=75.7] | Loss=0.00652 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.824 | acc=0.9844 | 4423.6 samples/s | 69.1 steps/s
[Step=38750 Epoch=75.8] | Loss=0.00631 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.825 | acc=1.0000 | 4845.5 samples/s | 75.7 steps/s
[Step=38800 Epoch=75.9] | Loss=0.00618 | Reg=0.00176 | L2-Norm=13.260 | L2-Norm(final)=3.826 | acc=1.0000 | 4710.7 samples/s | 73.6 steps/s
[Step=38850 Epoch=76.0] | Loss=0.00602 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.827 | acc=0.9844 | 4773.1 samples/s | 74.6 steps/s
[Step=38900 Epoch=76.0] | Loss=0.00605 | Reg=0.00176 | L2-Norm=13.261 | L2-Norm(final)=3.828 | acc=0.9844 | 5851.5 samples/s | 91.4 steps/s
[Step=38950 Epoch=76.1] | Loss=0.00579 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.829 | acc=1.0000 | 2002.9 samples/s | 31.3 steps/s
[Step=39000 Epoch=76.2] | Loss=0.00569 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.830 | acc=1.0000 | 4580.1 samples/s | 71.6 steps/s
[Step=39050 Epoch=76.3] | Loss=0.00557 | Reg=0.00176 | L2-Norm=13.262 | L2-Norm(final)=3.831 | acc=1.0000 | 4312.1 samples/s | 67.4 steps/s
[Step=39100 Epoch=76.4] | Loss=0.00558 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.832 | acc=1.0000 | 4602.5 samples/s | 71.9 steps/s
[Step=39150 Epoch=76.5] | Loss=0.00542 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.832 | acc=0.9844 | 4738.0 samples/s | 74.0 steps/s
[Step=39200 Epoch=76.6] | Loss=0.00534 | Reg=0.00176 | L2-Norm=13.263 | L2-Norm(final)=3.833 | acc=1.0000 | 4831.2 samples/s | 75.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step39200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=147.1] | Loss=0.02109 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.823 | acc=0.9688 | 4056.4 samples/s | 63.4 steps/s
[Step=38450 Epoch=147.3] | Loss=0.00186 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.827 | acc=1.0000 | 4270.1 samples/s | 66.7 steps/s
[Step=38500 Epoch=147.5] | Loss=0.00094 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.828 | acc=1.0000 | 4554.1 samples/s | 71.2 steps/s
[Step=38550 Epoch=147.7] | Loss=0.00063 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.828 | acc=1.0000 | 4515.5 samples/s | 70.6 steps/s
[Step=38600 Epoch=147.9] | Loss=0.00048 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.828 | acc=1.0000 | 4327.7 samples/s | 67.6 steps/s
[Step=38650 Epoch=148.1] | Loss=0.00038 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.828 | acc=1.0000 | 5178.9 samples/s | 80.9 steps/s
[Step=38700 Epoch=148.3] | Loss=0.00032 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.829 | acc=1.0000 | 1893.3 samples/s | 29.6 steps/s
[Step=38750 Epoch=148.5] | Loss=0.00028 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.829 | acc=1.0000 | 4521.4 samples/s | 70.6 steps/s
[Step=38800 Epoch=148.7] | Loss=0.00024 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.829 | acc=1.0000 | 4548.3 samples/s | 71.1 steps/s
[Step=38850 Epoch=148.9] | Loss=0.00022 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.829 | acc=1.0000 | 4483.6 samples/s | 70.1 steps/s
[Step=38900 Epoch=149.1] | Loss=0.00020 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.829 | acc=1.0000 | 4968.6 samples/s | 77.6 steps/s
[Step=38950 Epoch=149.2] | Loss=0.00018 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.829 | acc=1.0000 | 1987.9 samples/s | 31.1 steps/s
[Step=39000 Epoch=149.4] | Loss=0.00016 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.830 | acc=1.0000 | 4131.2 samples/s | 64.6 steps/s
[Step=39050 Epoch=149.6] | Loss=0.00015 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.830 | acc=1.0000 | 4302.5 samples/s | 67.2 steps/s
[Step=39100 Epoch=149.8] | Loss=0.00014 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.830 | acc=1.0000 | 4451.4 samples/s | 69.6 steps/s
[Step=39150 Epoch=150.0] | Loss=0.00013 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.830 | acc=1.0000 | 4508.9 samples/s | 70.5 steps/s
[Step=39200 Epoch=150.2] | Loss=0.00012 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.830 | acc=1.0000 | 2090.2 samples/s | 32.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step39200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=147.8] | Loss=0.02849 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.822 | acc=0.9844 | 4173.9 samples/s | 65.2 steps/s
[Step=38450 Epoch=148.0] | Loss=0.00310 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.826 | acc=1.0000 | 4234.9 samples/s | 66.2 steps/s
[Step=38500 Epoch=148.2] | Loss=0.00157 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.826 | acc=1.0000 | 4337.8 samples/s | 67.8 steps/s
[Step=38550 Epoch=148.4] | Loss=0.00105 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.827 | acc=1.0000 | 4076.4 samples/s | 63.7 steps/s
[Step=38600 Epoch=148.6] | Loss=0.00079 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.827 | acc=1.0000 | 4447.7 samples/s | 69.5 steps/s
[Step=38650 Epoch=148.8] | Loss=0.00064 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.827 | acc=1.0000 | 5752.7 samples/s | 89.9 steps/s
[Step=38700 Epoch=149.0] | Loss=0.00053 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.827 | acc=1.0000 | 1930.6 samples/s | 30.2 steps/s
[Step=38750 Epoch=149.2] | Loss=0.00046 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.827 | acc=1.0000 | 4398.8 samples/s | 68.7 steps/s
[Step=38800 Epoch=149.4] | Loss=0.00040 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.827 | acc=1.0000 | 4548.6 samples/s | 71.1 steps/s
[Step=38850 Epoch=149.5] | Loss=0.00036 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.828 | acc=1.0000 | 4449.6 samples/s | 69.5 steps/s
[Step=38900 Epoch=149.7] | Loss=0.00032 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.828 | acc=1.0000 | 4954.6 samples/s | 77.4 steps/s
[Step=38950 Epoch=149.9] | Loss=0.00029 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.828 | acc=1.0000 | 1907.5 samples/s | 29.8 steps/s
[Step=39000 Epoch=150.1] | Loss=0.00027 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.828 | acc=1.0000 | 4504.1 samples/s | 70.4 steps/s
[Step=39050 Epoch=150.3] | Loss=0.00025 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.828 | acc=1.0000 | 4529.2 samples/s | 70.8 steps/s
[Step=39100 Epoch=150.5] | Loss=0.00023 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.828 | acc=1.0000 | 4531.1 samples/s | 70.8 steps/s
[Step=39150 Epoch=150.7] | Loss=0.00022 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.828 | acc=1.0000 | 4576.4 samples/s | 71.5 steps/s
[Step=39200 Epoch=150.9] | Loss=0.00020 | Reg=0.00175 | L2-Norm=13.247 | L2-Norm(final)=3.828 | acc=1.0000 | 2096.2 samples/s | 32.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.18809 | acc=0.9109 | tpr=0.8765 | fpr=0.0144 | 4230.1 samples/s | 16.5 steps/s
Avg test loss: 0.19497, Avg test acc: 0.91077, Avg tpr: 0.87719, Avg fpr: 0.01538, total FA: 120

Testing server on iccad2012
[Step=  50] | Loss=0.40984 | acc=0.9058 | tpr=0.9513 | fpr=0.0950 | 4357.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.41100 | acc=0.9058 | tpr=0.9659 | fpr=0.0953 | 7607.6 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.41414 | acc=0.9054 | tpr=0.9726 | fpr=0.0958 | 8484.9 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.41505 | acc=0.9054 | tpr=0.9738 | fpr=0.0959 | 9086.4 samples/s | 35.5 steps/s
[Step= 250] | Loss=0.41183 | acc=0.9057 | tpr=0.9747 | fpr=0.0956 | 7718.9 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.41661 | acc=0.9054 | tpr=0.9745 | fpr=0.0959 | 7767.5 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.42092 | acc=0.9050 | tpr=0.9737 | fpr=0.0962 | 8144.0 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.42330 | acc=0.9050 | tpr=0.9721 | fpr=0.0962 | 8241.1 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.42870 | acc=0.9047 | tpr=0.9708 | fpr=0.0965 | 8653.0 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.42858 | acc=0.9046 | tpr=0.9718 | fpr=0.0966 | 7650.5 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.42822 | acc=0.9047 | tpr=0.9713 | fpr=0.0965 | 14242.4 samples/s | 55.6 steps/s
Avg test loss: 0.42784, Avg test acc: 0.90471, Avg tpr: 0.97108, Avg fpr: 0.09650, total FA: 13399

server round 49/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=76.5] | Loss=0.14125 | Reg=0.00175 | L2-Norm=13.238 | L2-Norm(final)=3.839 | acc=0.9375 | 4167.7 samples/s | 65.1 steps/s
[Step=39250 Epoch=76.6] | Loss=0.01736 | Reg=0.00175 | L2-Norm=13.247 | L2-Norm(final)=3.836 | acc=1.0000 | 4350.0 samples/s | 68.0 steps/s
[Step=39300 Epoch=76.7] | Loss=0.01128 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.836 | acc=1.0000 | 4805.1 samples/s | 75.1 steps/s
[Step=39350 Epoch=76.7] | Loss=0.00943 | Reg=0.00176 | L2-Norm=13.251 | L2-Norm(final)=3.837 | acc=0.9844 | 4704.7 samples/s | 73.5 steps/s
[Step=39400 Epoch=76.8] | Loss=0.00826 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.839 | acc=1.0000 | 4684.2 samples/s | 73.2 steps/s
[Step=39450 Epoch=76.9] | Loss=0.00779 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.840 | acc=1.0000 | 4773.0 samples/s | 74.6 steps/s
[Step=39500 Epoch=77.0] | Loss=0.00742 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.841 | acc=1.0000 | 4657.6 samples/s | 72.8 steps/s
[Step=39550 Epoch=77.1] | Loss=0.00692 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.842 | acc=1.0000 | 4596.9 samples/s | 71.8 steps/s
[Step=39600 Epoch=77.2] | Loss=0.00668 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.843 | acc=1.0000 | 4341.6 samples/s | 67.8 steps/s
[Step=39650 Epoch=77.3] | Loss=0.00650 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.844 | acc=0.9844 | 4710.5 samples/s | 73.6 steps/s
[Step=39700 Epoch=77.4] | Loss=0.00639 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.845 | acc=1.0000 | 5805.8 samples/s | 90.7 steps/s
[Step=39750 Epoch=77.5] | Loss=0.00611 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.846 | acc=1.0000 | 1944.7 samples/s | 30.4 steps/s
[Step=39800 Epoch=77.6] | Loss=0.00592 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.847 | acc=1.0000 | 4721.6 samples/s | 73.8 steps/s
[Step=39850 Epoch=77.7] | Loss=0.00572 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.848 | acc=1.0000 | 4783.1 samples/s | 74.7 steps/s
[Step=39900 Epoch=77.8] | Loss=0.00571 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.849 | acc=1.0000 | 4733.6 samples/s | 74.0 steps/s
[Step=39950 Epoch=77.9] | Loss=0.00558 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.850 | acc=0.9844 | 4657.3 samples/s | 72.8 steps/s
[Step=40000 Epoch=78.0] | Loss=0.00559 | Reg=0.00176 | L2-Norm=13.259 | L2-Norm(final)=3.851 | acc=1.0000 | 4333.4 samples/s | 67.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=76.6] | Loss=0.10164 | Reg=0.00175 | L2-Norm=13.238 | L2-Norm(final)=3.839 | acc=0.9531 | 4422.4 samples/s | 69.1 steps/s
[Step=39250 Epoch=76.7] | Loss=0.01686 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.838 | acc=0.9844 | 4345.9 samples/s | 67.9 steps/s
[Step=39300 Epoch=76.8] | Loss=0.01140 | Reg=0.00176 | L2-Norm=13.252 | L2-Norm(final)=3.838 | acc=0.9844 | 4792.0 samples/s | 74.9 steps/s
[Step=39350 Epoch=76.9] | Loss=0.00884 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.839 | acc=1.0000 | 4792.0 samples/s | 74.9 steps/s
[Step=39400 Epoch=77.0] | Loss=0.00726 | Reg=0.00176 | L2-Norm=13.253 | L2-Norm(final)=3.840 | acc=1.0000 | 4759.7 samples/s | 74.4 steps/s
[Step=39450 Epoch=77.1] | Loss=0.00678 | Reg=0.00176 | L2-Norm=13.254 | L2-Norm(final)=3.841 | acc=1.0000 | 4748.3 samples/s | 74.2 steps/s
[Step=39500 Epoch=77.2] | Loss=0.00633 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.842 | acc=1.0000 | 4861.2 samples/s | 76.0 steps/s
[Step=39550 Epoch=77.3] | Loss=0.00616 | Reg=0.00176 | L2-Norm=13.255 | L2-Norm(final)=3.843 | acc=0.9844 | 4619.0 samples/s | 72.2 steps/s
[Step=39600 Epoch=77.4] | Loss=0.00612 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.844 | acc=1.0000 | 4483.8 samples/s | 70.1 steps/s
[Step=39650 Epoch=77.5] | Loss=0.00607 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.845 | acc=1.0000 | 4428.3 samples/s | 69.2 steps/s
[Step=39700 Epoch=77.6] | Loss=0.00601 | Reg=0.00176 | L2-Norm=13.256 | L2-Norm(final)=3.845 | acc=0.9844 | 5900.5 samples/s | 92.2 steps/s
[Step=39750 Epoch=77.7] | Loss=0.00589 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.846 | acc=1.0000 | 2014.9 samples/s | 31.5 steps/s
[Step=39800 Epoch=77.8] | Loss=0.00568 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.847 | acc=1.0000 | 4702.3 samples/s | 73.5 steps/s
[Step=39850 Epoch=77.9] | Loss=0.00561 | Reg=0.00176 | L2-Norm=13.257 | L2-Norm(final)=3.848 | acc=0.9844 | 4848.3 samples/s | 75.8 steps/s
[Step=39900 Epoch=78.0] | Loss=0.00547 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.849 | acc=1.0000 | 4667.6 samples/s | 72.9 steps/s
[Step=39950 Epoch=78.1] | Loss=0.00536 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.849 | acc=1.0000 | 4762.9 samples/s | 74.4 steps/s
[Step=40000 Epoch=78.2] | Loss=0.00537 | Reg=0.00176 | L2-Norm=13.258 | L2-Norm(final)=3.850 | acc=0.9844 | 4650.4 samples/s | 72.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step40000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=150.2] | Loss=0.00230 | Reg=0.00175 | L2-Norm=13.238 | L2-Norm(final)=3.839 | acc=1.0000 | 3992.6 samples/s | 62.4 steps/s
[Step=39250 Epoch=150.4] | Loss=0.00329 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.841 | acc=1.0000 | 4154.2 samples/s | 64.9 steps/s
[Step=39300 Epoch=150.6] | Loss=0.00165 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.842 | acc=1.0000 | 4548.1 samples/s | 71.1 steps/s
[Step=39350 Epoch=150.8] | Loss=0.00110 | Reg=0.00176 | L2-Norm=13.250 | L2-Norm(final)=3.842 | acc=1.0000 | 4535.0 samples/s | 70.9 steps/s
[Step=39400 Epoch=151.0] | Loss=0.00083 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.842 | acc=1.0000 | 4526.4 samples/s | 70.7 steps/s
[Step=39450 Epoch=151.2] | Loss=0.00066 | Reg=0.00176 | L2-Norm=13.249 | L2-Norm(final)=3.842 | acc=1.0000 | 5682.6 samples/s | 88.8 steps/s
[Step=39500 Epoch=151.4] | Loss=0.00055 | Reg=0.00176 | L2-Norm=13.248 | L2-Norm(final)=3.842 | acc=1.0000 | 1924.4 samples/s | 30.1 steps/s
[Step=39550 Epoch=151.5] | Loss=0.00048 | Reg=0.00175 | L2-Norm=13.247 | L2-Norm(final)=3.843 | acc=1.0000 | 4410.9 samples/s | 68.9 steps/s
[Step=39600 Epoch=151.7] | Loss=0.00042 | Reg=0.00175 | L2-Norm=13.246 | L2-Norm(final)=3.843 | acc=1.0000 | 4206.8 samples/s | 65.7 steps/s
[Step=39650 Epoch=151.9] | Loss=0.00037 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.843 | acc=1.0000 | 4285.1 samples/s | 67.0 steps/s
[Step=39700 Epoch=152.1] | Loss=0.00033 | Reg=0.00175 | L2-Norm=13.244 | L2-Norm(final)=3.843 | acc=1.0000 | 5019.8 samples/s | 78.4 steps/s
[Step=39750 Epoch=152.3] | Loss=0.00030 | Reg=0.00175 | L2-Norm=13.243 | L2-Norm(final)=3.843 | acc=1.0000 | 2025.7 samples/s | 31.7 steps/s
[Step=39800 Epoch=152.5] | Loss=0.00028 | Reg=0.00175 | L2-Norm=13.242 | L2-Norm(final)=3.843 | acc=1.0000 | 4646.8 samples/s | 72.6 steps/s
[Step=39850 Epoch=152.7] | Loss=0.00026 | Reg=0.00175 | L2-Norm=13.241 | L2-Norm(final)=3.843 | acc=1.0000 | 4413.1 samples/s | 69.0 steps/s
[Step=39900 Epoch=152.9] | Loss=0.00024 | Reg=0.00175 | L2-Norm=13.240 | L2-Norm(final)=3.843 | acc=1.0000 | 4499.4 samples/s | 70.3 steps/s
[Step=39950 Epoch=153.1] | Loss=0.00022 | Reg=0.00175 | L2-Norm=13.239 | L2-Norm(final)=3.843 | acc=1.0000 | 4397.2 samples/s | 68.7 steps/s
[Step=40000 Epoch=153.3] | Loss=0.00021 | Reg=0.00175 | L2-Norm=13.238 | L2-Norm(final)=3.843 | acc=1.0000 | 2003.0 samples/s | 31.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step40000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=150.9] | Loss=0.00024 | Reg=0.00175 | L2-Norm=13.238 | L2-Norm(final)=3.839 | acc=1.0000 | 4285.5 samples/s | 67.0 steps/s
[Step=39250 Epoch=151.1] | Loss=0.00300 | Reg=0.00175 | L2-Norm=13.243 | L2-Norm(final)=3.841 | acc=1.0000 | 4051.3 samples/s | 63.3 steps/s
[Step=39300 Epoch=151.3] | Loss=0.00150 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.842 | acc=1.0000 | 4519.7 samples/s | 70.6 steps/s
[Step=39350 Epoch=151.5] | Loss=0.00101 | Reg=0.00175 | L2-Norm=13.245 | L2-Norm(final)=3.842 | acc=1.0000 | 4597.0 samples/s | 71.8 steps/s
[Step=39400 Epoch=151.7] | Loss=0.00076 | Reg=0.00175 | L2-Norm=13.244 | L2-Norm(final)=3.843 | acc=1.0000 | 4441.9 samples/s | 69.4 steps/s
[Step=39450 Epoch=151.9] | Loss=0.00062 | Reg=0.00175 | L2-Norm=13.244 | L2-Norm(final)=3.843 | acc=1.0000 | 5821.6 samples/s | 91.0 steps/s
[Step=39500 Epoch=152.1] | Loss=0.00052 | Reg=0.00175 | L2-Norm=13.243 | L2-Norm(final)=3.843 | acc=1.0000 | 1847.4 samples/s | 28.9 steps/s
[Step=39550 Epoch=152.2] | Loss=0.00044 | Reg=0.00175 | L2-Norm=13.242 | L2-Norm(final)=3.844 | acc=1.0000 | 4217.8 samples/s | 65.9 steps/s
[Step=39600 Epoch=152.4] | Loss=0.00039 | Reg=0.00175 | L2-Norm=13.241 | L2-Norm(final)=3.844 | acc=1.0000 | 4526.3 samples/s | 70.7 steps/s
[Step=39650 Epoch=152.6] | Loss=0.00035 | Reg=0.00175 | L2-Norm=13.240 | L2-Norm(final)=3.844 | acc=1.0000 | 4460.6 samples/s | 69.7 steps/s
[Step=39700 Epoch=152.8] | Loss=0.00031 | Reg=0.00175 | L2-Norm=13.239 | L2-Norm(final)=3.845 | acc=1.0000 | 5149.0 samples/s | 80.5 steps/s
[Step=39750 Epoch=153.0] | Loss=0.00028 | Reg=0.00175 | L2-Norm=13.238 | L2-Norm(final)=3.845 | acc=1.0000 | 1999.7 samples/s | 31.2 steps/s
[Step=39800 Epoch=153.2] | Loss=0.00026 | Reg=0.00175 | L2-Norm=13.236 | L2-Norm(final)=3.845 | acc=1.0000 | 4588.0 samples/s | 71.7 steps/s
[Step=39850 Epoch=153.4] | Loss=0.00024 | Reg=0.00175 | L2-Norm=13.235 | L2-Norm(final)=3.845 | acc=1.0000 | 4343.9 samples/s | 67.9 steps/s
[Step=39900 Epoch=153.6] | Loss=0.00022 | Reg=0.00175 | L2-Norm=13.234 | L2-Norm(final)=3.845 | acc=1.0000 | 4230.9 samples/s | 66.1 steps/s
[Step=39950 Epoch=153.8] | Loss=0.00021 | Reg=0.00175 | L2-Norm=13.232 | L2-Norm(final)=3.845 | acc=1.0000 | 4370.3 samples/s | 68.3 steps/s
[Step=40000 Epoch=154.0] | Loss=0.00020 | Reg=0.00175 | L2-Norm=13.231 | L2-Norm(final)=3.846 | acc=1.0000 | 2087.8 samples/s | 32.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.17858 | acc=0.9145 | tpr=0.8822 | fpr=0.0154 | 4349.7 samples/s | 17.0 steps/s
Avg test loss: 0.18541, Avg test acc: 0.91446, Avg tpr: 0.88296, Avg fpr: 0.01628, total FA: 127

Testing server on iccad2012
[Step=  50] | Loss=0.42994 | acc=0.9017 | tpr=0.9558 | fpr=0.0993 | 4248.7 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.43175 | acc=0.9012 | tpr=0.9680 | fpr=0.1000 | 8249.3 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.43416 | acc=0.9010 | tpr=0.9741 | fpr=0.1003 | 8349.1 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.43439 | acc=0.9012 | tpr=0.9749 | fpr=0.1002 | 7539.9 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.43118 | acc=0.9015 | tpr=0.9755 | fpr=0.0998 | 8367.8 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.43611 | acc=0.9012 | tpr=0.9753 | fpr=0.1002 | 8294.8 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.44025 | acc=0.9009 | tpr=0.9743 | fpr=0.1004 | 9070.2 samples/s | 35.4 steps/s
[Step= 400] | Loss=0.44256 | acc=0.9009 | tpr=0.9726 | fpr=0.1004 | 7203.3 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.44802 | acc=0.9006 | tpr=0.9713 | fpr=0.1007 | 8492.5 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.44797 | acc=0.9005 | tpr=0.9718 | fpr=0.1008 | 8316.3 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.44763 | acc=0.9006 | tpr=0.9713 | fpr=0.1007 | 14044.9 samples/s | 54.9 steps/s
Avg test loss: 0.44723, Avg test acc: 0.90057, Avg tpr: 0.97108, Avg fpr: 0.10071, total FA: 13984
