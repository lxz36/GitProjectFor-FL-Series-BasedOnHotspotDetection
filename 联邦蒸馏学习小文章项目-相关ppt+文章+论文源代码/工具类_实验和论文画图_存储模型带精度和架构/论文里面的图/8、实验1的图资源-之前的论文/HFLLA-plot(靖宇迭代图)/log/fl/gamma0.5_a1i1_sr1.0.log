Total num clients: 2
client model path: ['/research/byu2/rchen/proj/wwy/jp/model/client_asml1_0', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0']
client benchmark path: {'asml1': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml1_train', 'asml2': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml2_train', 'asml3': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml3_train', 'asml4': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml4_train', 'iccad2012': '/research/byu2/rchen/proj/wwy/jp/benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (49916, 144, 32)
Resampled dataset to size (65551, 144, 32)
Using transform option: train
#pos = 34281, #neg = 31270
loading data into the main memory...
Allocated dataset with size (18300, 144, 32)
Resampled dataset to size (33952, 144, 32)
Using transform option: train
#pos = 16856, #neg = 17096
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37801 | Reg=0.00359 | L2-Norm=18.953 | L2-Norm(final)=2.051 | acc=0.4375 | 2233.5 samples/s | 34.9 steps/s
[Step=  50 Epoch= 0.0] | Loss=0.29298 | Reg=0.00349 | L2-Norm=18.687 | L2-Norm(final)=2.043 | acc=0.9062 | 4568.5 samples/s | 71.4 steps/s
[Step= 100 Epoch= 0.1] | Loss=0.25597 | Reg=0.00346 | L2-Norm=18.594 | L2-Norm(final)=2.050 | acc=0.8125 | 4605.0 samples/s | 72.0 steps/s
[Step= 150 Epoch= 0.1] | Loss=0.22919 | Reg=0.00343 | L2-Norm=18.525 | L2-Norm(final)=2.058 | acc=0.8594 | 4577.2 samples/s | 71.5 steps/s
[Step= 200 Epoch= 0.2] | Loss=0.20928 | Reg=0.00341 | L2-Norm=18.472 | L2-Norm(final)=2.066 | acc=0.8594 | 4354.8 samples/s | 68.0 steps/s
[Step= 250 Epoch= 0.2] | Loss=0.19402 | Reg=0.00340 | L2-Norm=18.427 | L2-Norm(final)=2.073 | acc=0.9375 | 4565.0 samples/s | 71.3 steps/s
[Step= 300 Epoch= 0.3] | Loss=0.18415 | Reg=0.00338 | L2-Norm=18.390 | L2-Norm(final)=2.079 | acc=0.9219 | 4635.0 samples/s | 72.4 steps/s
[Step= 350 Epoch= 0.3] | Loss=0.17508 | Reg=0.00337 | L2-Norm=18.357 | L2-Norm(final)=2.084 | acc=0.8438 | 4617.7 samples/s | 72.2 steps/s
[Step= 400 Epoch= 0.4] | Loss=0.16687 | Reg=0.00336 | L2-Norm=18.327 | L2-Norm(final)=2.088 | acc=0.9062 | 4665.9 samples/s | 72.9 steps/s
[Step= 450 Epoch= 0.4] | Loss=0.16049 | Reg=0.00335 | L2-Norm=18.300 | L2-Norm(final)=2.091 | acc=0.9531 | 4650.1 samples/s | 72.7 steps/s
[Step= 500 Epoch= 0.5] | Loss=0.15442 | Reg=0.00334 | L2-Norm=18.276 | L2-Norm(final)=2.094 | acc=0.8906 | 4625.1 samples/s | 72.3 steps/s
[Step= 550 Epoch= 0.5] | Loss=0.14907 | Reg=0.00333 | L2-Norm=18.256 | L2-Norm(final)=2.097 | acc=0.8906 | 4613.2 samples/s | 72.1 steps/s
[Step= 600 Epoch= 0.6] | Loss=0.14456 | Reg=0.00333 | L2-Norm=18.237 | L2-Norm(final)=2.099 | acc=0.9531 | 4503.2 samples/s | 70.4 steps/s
[Step= 650 Epoch= 0.6] | Loss=0.14019 | Reg=0.00332 | L2-Norm=18.221 | L2-Norm(final)=2.101 | acc=0.9844 | 4533.4 samples/s | 70.8 steps/s
[Step= 700 Epoch= 0.7] | Loss=0.13670 | Reg=0.00331 | L2-Norm=18.206 | L2-Norm(final)=2.103 | acc=0.9375 | 4556.0 samples/s | 71.2 steps/s
[Step= 750 Epoch= 0.7] | Loss=0.13305 | Reg=0.00331 | L2-Norm=18.192 | L2-Norm(final)=2.104 | acc=0.9375 | 4517.4 samples/s | 70.6 steps/s
[Step= 800 Epoch= 0.8] | Loss=0.13032 | Reg=0.00331 | L2-Norm=18.179 | L2-Norm(final)=2.106 | acc=0.9531 | 4836.7 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36979 | Reg=0.00359 | L2-Norm=18.953 | L2-Norm(final)=2.052 | acc=0.4375 | 3620.9 samples/s | 56.6 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.16809 | Reg=0.00350 | L2-Norm=18.704 | L2-Norm(final)=2.070 | acc=0.9375 | 4261.7 samples/s | 66.6 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.11268 | Reg=0.00346 | L2-Norm=18.612 | L2-Norm(final)=2.083 | acc=1.0000 | 4415.9 samples/s | 69.0 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.08310 | Reg=0.00344 | L2-Norm=18.544 | L2-Norm(final)=2.092 | acc=0.9844 | 4324.7 samples/s | 67.6 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.06710 | Reg=0.00342 | L2-Norm=18.486 | L2-Norm(final)=2.099 | acc=1.0000 | 4437.1 samples/s | 69.3 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.05570 | Reg=0.00340 | L2-Norm=18.435 | L2-Norm(final)=2.104 | acc=0.9844 | 4356.4 samples/s | 68.1 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.04861 | Reg=0.00338 | L2-Norm=18.388 | L2-Norm(final)=2.109 | acc=1.0000 | 4393.2 samples/s | 68.6 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.04298 | Reg=0.00337 | L2-Norm=18.345 | L2-Norm(final)=2.114 | acc=0.9844 | 4463.4 samples/s | 69.7 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.03926 | Reg=0.00335 | L2-Norm=18.303 | L2-Norm(final)=2.117 | acc=0.9844 | 4332.2 samples/s | 67.7 steps/s
[Step= 450 Epoch= 0.8] | Loss=0.03560 | Reg=0.00334 | L2-Norm=18.265 | L2-Norm(final)=2.121 | acc=1.0000 | 4379.1 samples/s | 68.4 steps/s
[Step= 500 Epoch= 0.9] | Loss=0.03256 | Reg=0.00332 | L2-Norm=18.228 | L2-Norm(final)=2.125 | acc=1.0000 | 4344.3 samples/s | 67.9 steps/s
[Step= 550 Epoch= 1.0] | Loss=0.03017 | Reg=0.00331 | L2-Norm=18.191 | L2-Norm(final)=2.128 | acc=1.0000 | 1519.5 samples/s | 23.7 steps/s
[Step= 600 Epoch= 1.1] | Loss=0.02785 | Reg=0.00330 | L2-Norm=18.155 | L2-Norm(final)=2.131 | acc=1.0000 | 4484.9 samples/s | 70.1 steps/s
[Step= 650 Epoch= 1.2] | Loss=0.02602 | Reg=0.00328 | L2-Norm=18.120 | L2-Norm(final)=2.134 | acc=1.0000 | 4421.1 samples/s | 69.1 steps/s
[Step= 700 Epoch= 1.3] | Loss=0.02431 | Reg=0.00327 | L2-Norm=18.086 | L2-Norm(final)=2.137 | acc=1.0000 | 4279.9 samples/s | 66.9 steps/s
[Step= 750 Epoch= 1.4] | Loss=0.02335 | Reg=0.00326 | L2-Norm=18.053 | L2-Norm(final)=2.140 | acc=1.0000 | 4484.2 samples/s | 70.1 steps/s
[Step= 800 Epoch= 1.5] | Loss=0.02220 | Reg=0.00325 | L2-Norm=18.022 | L2-Norm(final)=2.142 | acc=1.0000 | 4438.5 samples/s | 69.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33837 | acc=0.5880 | tpr=0.4521 | fpr=0.1169 | 4508.7 samples/s | 17.6 steps/s
Avg test loss: 0.33889, Avg test acc: 0.58655, Avg tpr: 0.45352, Avg fpr: 0.12088, total FA: 943

Testing server on iccad2012
[Step=  50] | Loss=0.22210 | acc=0.8342 | tpr=0.8451 | fpr=0.1660 | 4426.3 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.22172 | acc=0.8343 | tpr=0.8358 | fpr=0.1657 | 9440.8 samples/s | 36.9 steps/s
[Step= 150] | Loss=0.22247 | acc=0.8312 | tpr=0.8372 | fpr=0.1689 | 8203.6 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.22271 | acc=0.8312 | tpr=0.8426 | fpr=0.1690 | 9246.0 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.22285 | acc=0.8317 | tpr=0.8498 | fpr=0.1687 | 9301.6 samples/s | 36.3 steps/s
[Step= 300] | Loss=0.22229 | acc=0.8330 | tpr=0.8524 | fpr=0.1674 | 8716.6 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.22203 | acc=0.8336 | tpr=0.8447 | fpr=0.1666 | 8657.9 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.22217 | acc=0.8335 | tpr=0.8446 | fpr=0.1667 | 9346.6 samples/s | 36.5 steps/s
[Step= 450] | Loss=0.22226 | acc=0.8333 | tpr=0.8471 | fpr=0.1669 | 8422.0 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.22247 | acc=0.8325 | tpr=0.8449 | fpr=0.1678 | 8478.2 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.22243 | acc=0.8325 | tpr=0.8440 | fpr=0.1677 | 16079.1 samples/s | 62.8 steps/s
Avg test loss: 0.22241, Avg test acc: 0.83256, Avg tpr: 0.84429, Avg fpr: 0.16766, total FA: 23279

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 0.8] | Loss=0.30329 | Reg=0.00290 | L2-Norm=17.042 | L2-Norm(final)=2.133 | acc=0.6250 | 3420.3 samples/s | 53.4 steps/s
[Step= 850 Epoch= 0.8] | Loss=0.15567 | Reg=0.00296 | L2-Norm=17.194 | L2-Norm(final)=2.133 | acc=0.8906 | 4258.8 samples/s | 66.5 steps/s
[Step= 900 Epoch= 0.9] | Loss=0.13301 | Reg=0.00297 | L2-Norm=17.244 | L2-Norm(final)=2.139 | acc=0.9062 | 4249.0 samples/s | 66.4 steps/s
[Step= 950 Epoch= 0.9] | Loss=0.12242 | Reg=0.00298 | L2-Norm=17.267 | L2-Norm(final)=2.147 | acc=0.9219 | 4367.8 samples/s | 68.2 steps/s
[Step=1000 Epoch= 1.0] | Loss=0.11367 | Reg=0.00298 | L2-Norm=17.277 | L2-Norm(final)=2.153 | acc=0.9531 | 4441.5 samples/s | 69.4 steps/s
[Step=1050 Epoch= 1.0] | Loss=0.10899 | Reg=0.00299 | L2-Norm=17.282 | L2-Norm(final)=2.159 | acc=0.9375 | 4375.3 samples/s | 68.4 steps/s
[Step=1100 Epoch= 1.1] | Loss=0.10570 | Reg=0.00299 | L2-Norm=17.285 | L2-Norm(final)=2.163 | acc=0.9531 | 4543.4 samples/s | 71.0 steps/s
[Step=1150 Epoch= 1.1] | Loss=0.10250 | Reg=0.00299 | L2-Norm=17.289 | L2-Norm(final)=2.166 | acc=0.9531 | 4104.8 samples/s | 64.1 steps/s
[Step=1200 Epoch= 1.2] | Loss=0.09922 | Reg=0.00299 | L2-Norm=17.291 | L2-Norm(final)=2.169 | acc=0.9688 | 3846.2 samples/s | 60.1 steps/s
[Step=1250 Epoch= 1.2] | Loss=0.09729 | Reg=0.00299 | L2-Norm=17.291 | L2-Norm(final)=2.171 | acc=0.9375 | 3869.2 samples/s | 60.5 steps/s
[Step=1300 Epoch= 1.3] | Loss=0.09411 | Reg=0.00299 | L2-Norm=17.292 | L2-Norm(final)=2.173 | acc=0.9531 | 4062.1 samples/s | 63.5 steps/s
[Step=1350 Epoch= 1.3] | Loss=0.09381 | Reg=0.00299 | L2-Norm=17.293 | L2-Norm(final)=2.174 | acc=0.8906 | 3976.3 samples/s | 62.1 steps/s
[Step=1400 Epoch= 1.4] | Loss=0.09262 | Reg=0.00299 | L2-Norm=17.293 | L2-Norm(final)=2.175 | acc=0.9219 | 4021.1 samples/s | 62.8 steps/s
[Step=1450 Epoch= 1.4] | Loss=0.09115 | Reg=0.00299 | L2-Norm=17.294 | L2-Norm(final)=2.176 | acc=0.9375 | 4054.0 samples/s | 63.3 steps/s
[Step=1500 Epoch= 1.5] | Loss=0.08973 | Reg=0.00299 | L2-Norm=17.296 | L2-Norm(final)=2.177 | acc=0.8906 | 4038.4 samples/s | 63.1 steps/s
[Step=1550 Epoch= 1.5] | Loss=0.08787 | Reg=0.00299 | L2-Norm=17.298 | L2-Norm(final)=2.178 | acc=0.9219 | 3825.2 samples/s | 59.8 steps/s
[Step=1600 Epoch= 1.6] | Loss=0.08648 | Reg=0.00299 | L2-Norm=17.300 | L2-Norm(final)=2.180 | acc=0.9062 | 3735.4 samples/s | 58.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step1600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 1.5] | Loss=0.19842 | Reg=0.00290 | L2-Norm=17.042 | L2-Norm(final)=2.133 | acc=0.8906 | 2990.8 samples/s | 46.7 steps/s
[Step= 850 Epoch= 1.6] | Loss=0.04943 | Reg=0.00298 | L2-Norm=17.255 | L2-Norm(final)=2.139 | acc=1.0000 | 4149.7 samples/s | 64.8 steps/s
[Step= 900 Epoch= 1.7] | Loss=0.03010 | Reg=0.00299 | L2-Norm=17.302 | L2-Norm(final)=2.141 | acc=1.0000 | 4341.6 samples/s | 67.8 steps/s
[Step= 950 Epoch= 1.8] | Loss=0.02208 | Reg=0.00299 | L2-Norm=17.302 | L2-Norm(final)=2.146 | acc=1.0000 | 4360.4 samples/s | 68.1 steps/s
[Step=1000 Epoch= 1.9] | Loss=0.01770 | Reg=0.00299 | L2-Norm=17.288 | L2-Norm(final)=2.150 | acc=1.0000 | 4242.0 samples/s | 66.3 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.01487 | Reg=0.00298 | L2-Norm=17.269 | L2-Norm(final)=2.154 | acc=0.9844 | 4365.3 samples/s | 68.2 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.01284 | Reg=0.00297 | L2-Norm=17.248 | L2-Norm(final)=2.158 | acc=1.0000 | 4309.4 samples/s | 67.3 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.01132 | Reg=0.00297 | L2-Norm=17.224 | L2-Norm(final)=2.162 | acc=1.0000 | 4445.9 samples/s | 69.5 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.01067 | Reg=0.00296 | L2-Norm=17.200 | L2-Norm(final)=2.166 | acc=1.0000 | 4214.7 samples/s | 65.9 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.01045 | Reg=0.00295 | L2-Norm=17.179 | L2-Norm(final)=2.169 | acc=0.9844 | 4351.7 samples/s | 68.0 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.01056 | Reg=0.00294 | L2-Norm=17.159 | L2-Norm(final)=2.170 | acc=1.0000 | 4344.3 samples/s | 67.9 steps/s
[Step=1350 Epoch= 2.5] | Loss=0.01013 | Reg=0.00294 | L2-Norm=17.139 | L2-Norm(final)=2.170 | acc=1.0000 | 1508.5 samples/s | 23.6 steps/s
[Step=1400 Epoch= 2.6] | Loss=0.00942 | Reg=0.00293 | L2-Norm=17.118 | L2-Norm(final)=2.170 | acc=1.0000 | 4407.0 samples/s | 68.9 steps/s
[Step=1450 Epoch= 2.7] | Loss=0.00876 | Reg=0.00292 | L2-Norm=17.095 | L2-Norm(final)=2.171 | acc=1.0000 | 4460.4 samples/s | 69.7 steps/s
[Step=1500 Epoch= 2.8] | Loss=0.00825 | Reg=0.00291 | L2-Norm=17.071 | L2-Norm(final)=2.172 | acc=1.0000 | 4509.0 samples/s | 70.5 steps/s
[Step=1550 Epoch= 2.9] | Loss=0.00772 | Reg=0.00291 | L2-Norm=17.045 | L2-Norm(final)=2.173 | acc=1.0000 | 4347.1 samples/s | 67.9 steps/s
[Step=1600 Epoch= 3.0] | Loss=0.00731 | Reg=0.00290 | L2-Norm=17.019 | L2-Norm(final)=2.174 | acc=1.0000 | 4483.0 samples/s | 70.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36597 | acc=0.6188 | tpr=0.4975 | fpr=0.1179 | 4372.7 samples/s | 17.1 steps/s
Avg test loss: 0.36358, Avg test acc: 0.61864, Avg tpr: 0.50009, Avg fpr: 0.12063, total FA: 941

Testing server on iccad2012
[Step=  50] | Loss=0.21857 | acc=0.8149 | tpr=0.9735 | fpr=0.1879 | 4401.0 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.21963 | acc=0.8140 | tpr=0.9787 | fpr=0.1890 | 8780.7 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.22084 | acc=0.8122 | tpr=0.9769 | fpr=0.1908 | 9203.5 samples/s | 36.0 steps/s
[Step= 200] | Loss=0.22152 | acc=0.8112 | tpr=0.9803 | fpr=0.1919 | 9243.6 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.22206 | acc=0.8106 | tpr=0.9817 | fpr=0.1925 | 8412.6 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.22194 | acc=0.8113 | tpr=0.9818 | fpr=0.1919 | 9346.1 samples/s | 36.5 steps/s
[Step= 350] | Loss=0.22160 | acc=0.8117 | tpr=0.9806 | fpr=0.1913 | 8466.7 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.22185 | acc=0.8116 | tpr=0.9798 | fpr=0.1915 | 8996.2 samples/s | 35.1 steps/s
[Step= 450] | Loss=0.22225 | acc=0.8113 | tpr=0.9781 | fpr=0.1918 | 9020.9 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.22239 | acc=0.8105 | tpr=0.9780 | fpr=0.1926 | 7987.3 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.22226 | acc=0.8107 | tpr=0.9785 | fpr=0.1924 | 13877.5 samples/s | 54.2 steps/s
Avg test loss: 0.22221, Avg test acc: 0.81072, Avg tpr: 0.97821, Avg fpr: 0.19233, total FA: 26704

server round 2/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 1.6] | Loss=0.40647 | Reg=0.00270 | L2-Norm=16.437 | L2-Norm(final)=2.179 | acc=0.5938 | 3346.7 samples/s | 52.3 steps/s
[Step=1650 Epoch= 1.6] | Loss=0.13212 | Reg=0.00275 | L2-Norm=16.577 | L2-Norm(final)=2.174 | acc=0.9531 | 4556.7 samples/s | 71.2 steps/s
[Step=1700 Epoch= 1.7] | Loss=0.10873 | Reg=0.00277 | L2-Norm=16.641 | L2-Norm(final)=2.182 | acc=0.8906 | 4654.3 samples/s | 72.7 steps/s
[Step=1750 Epoch= 1.7] | Loss=0.09649 | Reg=0.00278 | L2-Norm=16.675 | L2-Norm(final)=2.191 | acc=0.9844 | 4469.2 samples/s | 69.8 steps/s
[Step=1800 Epoch= 1.8] | Loss=0.09129 | Reg=0.00279 | L2-Norm=16.697 | L2-Norm(final)=2.198 | acc=0.9531 | 4529.6 samples/s | 70.8 steps/s
[Step=1850 Epoch= 1.8] | Loss=0.08654 | Reg=0.00279 | L2-Norm=16.712 | L2-Norm(final)=2.202 | acc=0.9844 | 4563.7 samples/s | 71.3 steps/s
[Step=1900 Epoch= 1.9] | Loss=0.08418 | Reg=0.00280 | L2-Norm=16.726 | L2-Norm(final)=2.205 | acc=0.9531 | 4725.3 samples/s | 73.8 steps/s
[Step=1950 Epoch= 1.9] | Loss=0.08229 | Reg=0.00280 | L2-Norm=16.736 | L2-Norm(final)=2.208 | acc=0.9688 | 4677.8 samples/s | 73.1 steps/s
[Step=2000 Epoch= 2.0] | Loss=0.07903 | Reg=0.00280 | L2-Norm=16.745 | L2-Norm(final)=2.211 | acc=0.9531 | 4658.1 samples/s | 72.8 steps/s
[Step=2050 Epoch= 2.0] | Loss=0.07692 | Reg=0.00281 | L2-Norm=16.753 | L2-Norm(final)=2.213 | acc=0.9531 | 4403.9 samples/s | 68.8 steps/s
[Step=2100 Epoch= 2.1] | Loss=0.07636 | Reg=0.00281 | L2-Norm=16.760 | L2-Norm(final)=2.215 | acc=0.9844 | 4566.1 samples/s | 71.3 steps/s
[Step=2150 Epoch= 2.1] | Loss=0.07422 | Reg=0.00281 | L2-Norm=16.768 | L2-Norm(final)=2.217 | acc=0.9844 | 4528.8 samples/s | 70.8 steps/s
[Step=2200 Epoch= 2.1] | Loss=0.07301 | Reg=0.00281 | L2-Norm=16.777 | L2-Norm(final)=2.220 | acc=0.9688 | 4624.6 samples/s | 72.3 steps/s
[Step=2250 Epoch= 2.2] | Loss=0.07257 | Reg=0.00282 | L2-Norm=16.784 | L2-Norm(final)=2.221 | acc=0.9375 | 4527.8 samples/s | 70.7 steps/s
[Step=2300 Epoch= 2.2] | Loss=0.07173 | Reg=0.00282 | L2-Norm=16.791 | L2-Norm(final)=2.223 | acc=0.8750 | 4670.4 samples/s | 73.0 steps/s
[Step=2350 Epoch= 2.3] | Loss=0.07099 | Reg=0.00282 | L2-Norm=16.796 | L2-Norm(final)=2.223 | acc=0.9375 | 4559.6 samples/s | 71.2 steps/s
[Step=2400 Epoch= 2.3] | Loss=0.07004 | Reg=0.00282 | L2-Norm=16.801 | L2-Norm(final)=2.224 | acc=0.9375 | 4692.9 samples/s | 73.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step2400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 3.0] | Loss=0.08353 | Reg=0.00270 | L2-Norm=16.437 | L2-Norm(final)=2.183 | acc=0.9531 | 3649.8 samples/s | 57.0 steps/s
[Step=1650 Epoch= 3.1] | Loss=0.03028 | Reg=0.00276 | L2-Norm=16.604 | L2-Norm(final)=2.193 | acc=1.0000 | 3802.8 samples/s | 59.4 steps/s
[Step=1700 Epoch= 3.2] | Loss=0.02056 | Reg=0.00278 | L2-Norm=16.670 | L2-Norm(final)=2.187 | acc=1.0000 | 4354.9 samples/s | 68.0 steps/s
[Step=1750 Epoch= 3.3] | Loss=0.01515 | Reg=0.00278 | L2-Norm=16.684 | L2-Norm(final)=2.187 | acc=1.0000 | 4298.9 samples/s | 67.2 steps/s
[Step=1800 Epoch= 3.4] | Loss=0.01252 | Reg=0.00278 | L2-Norm=16.682 | L2-Norm(final)=2.188 | acc=1.0000 | 4301.6 samples/s | 67.2 steps/s
[Step=1850 Epoch= 3.5] | Loss=0.01049 | Reg=0.00278 | L2-Norm=16.673 | L2-Norm(final)=2.190 | acc=1.0000 | 4473.2 samples/s | 69.9 steps/s
[Step=1900 Epoch= 3.6] | Loss=0.00887 | Reg=0.00278 | L2-Norm=16.659 | L2-Norm(final)=2.193 | acc=1.0000 | 4400.8 samples/s | 68.8 steps/s
[Step=1950 Epoch= 3.7] | Loss=0.00784 | Reg=0.00277 | L2-Norm=16.640 | L2-Norm(final)=2.196 | acc=1.0000 | 4325.7 samples/s | 67.6 steps/s
[Step=2000 Epoch= 3.8] | Loss=0.00726 | Reg=0.00276 | L2-Norm=16.619 | L2-Norm(final)=2.198 | acc=1.0000 | 3558.8 samples/s | 55.6 steps/s
[Step=2050 Epoch= 3.9] | Loss=0.00684 | Reg=0.00276 | L2-Norm=16.599 | L2-Norm(final)=2.199 | acc=1.0000 | 3546.5 samples/s | 55.4 steps/s
[Step=2100 Epoch= 4.0] | Loss=0.00639 | Reg=0.00275 | L2-Norm=16.578 | L2-Norm(final)=2.201 | acc=1.0000 | 3920.6 samples/s | 61.3 steps/s
[Step=2150 Epoch= 4.1] | Loss=0.00600 | Reg=0.00274 | L2-Norm=16.556 | L2-Norm(final)=2.203 | acc=0.9844 | 1574.3 samples/s | 24.6 steps/s
[Step=2200 Epoch= 4.1] | Loss=0.00555 | Reg=0.00273 | L2-Norm=16.534 | L2-Norm(final)=2.205 | acc=1.0000 | 4343.9 samples/s | 67.9 steps/s
[Step=2250 Epoch= 4.2] | Loss=0.00514 | Reg=0.00273 | L2-Norm=16.511 | L2-Norm(final)=2.207 | acc=1.0000 | 4450.3 samples/s | 69.5 steps/s
[Step=2300 Epoch= 4.3] | Loss=0.00479 | Reg=0.00272 | L2-Norm=16.487 | L2-Norm(final)=2.209 | acc=1.0000 | 4382.3 samples/s | 68.5 steps/s
[Step=2350 Epoch= 4.4] | Loss=0.00447 | Reg=0.00271 | L2-Norm=16.462 | L2-Norm(final)=2.211 | acc=1.0000 | 4226.7 samples/s | 66.0 steps/s
[Step=2400 Epoch= 4.5] | Loss=0.00420 | Reg=0.00270 | L2-Norm=16.435 | L2-Norm(final)=2.213 | acc=1.0000 | 4321.4 samples/s | 67.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.50847 | acc=0.5890 | tpr=0.4189 | fpr=0.0416 | 4380.3 samples/s | 17.1 steps/s
Avg test loss: 0.50366, Avg test acc: 0.59015, Avg tpr: 0.42199, Avg fpr: 0.03999, total FA: 312

Testing server on iccad2012
[Step=  50] | Loss=0.17707 | acc=0.8667 | tpr=0.9646 | fpr=0.1350 | 4479.7 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.17937 | acc=0.8656 | tpr=0.9701 | fpr=0.1364 | 7900.4 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.18139 | acc=0.8638 | tpr=0.9726 | fpr=0.1383 | 8726.7 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.18206 | acc=0.8630 | tpr=0.9727 | fpr=0.1389 | 8835.7 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.18172 | acc=0.8635 | tpr=0.9729 | fpr=0.1385 | 8980.5 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.18192 | acc=0.8644 | tpr=0.9716 | fpr=0.1376 | 9439.1 samples/s | 36.9 steps/s
[Step= 350] | Loss=0.18133 | acc=0.8649 | tpr=0.9718 | fpr=0.1371 | 8598.2 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.18152 | acc=0.8647 | tpr=0.9732 | fpr=0.1373 | 8715.7 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.18215 | acc=0.8644 | tpr=0.9732 | fpr=0.1376 | 9233.1 samples/s | 36.1 steps/s
[Step= 500] | Loss=0.18232 | acc=0.8641 | tpr=0.9727 | fpr=0.1379 | 8531.7 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.18217 | acc=0.8642 | tpr=0.9733 | fpr=0.1377 | 16402.3 samples/s | 64.1 steps/s
Avg test loss: 0.18208, Avg test acc: 0.86429, Avg tpr: 0.97345, Avg fpr: 0.13769, total FA: 19118

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 2.3] | Loss=0.25217 | Reg=0.00256 | L2-Norm=16.000 | L2-Norm(final)=2.227 | acc=0.7031 | 3428.4 samples/s | 53.6 steps/s
[Step=2450 Epoch= 2.4] | Loss=0.10452 | Reg=0.00261 | L2-Norm=16.163 | L2-Norm(final)=2.203 | acc=0.9688 | 4520.9 samples/s | 70.6 steps/s
[Step=2500 Epoch= 2.4] | Loss=0.08587 | Reg=0.00264 | L2-Norm=16.233 | L2-Norm(final)=2.212 | acc=0.9688 | 4434.0 samples/s | 69.3 steps/s
[Step=2550 Epoch= 2.5] | Loss=0.07699 | Reg=0.00265 | L2-Norm=16.267 | L2-Norm(final)=2.217 | acc=0.9688 | 4604.4 samples/s | 71.9 steps/s
[Step=2600 Epoch= 2.5] | Loss=0.07333 | Reg=0.00266 | L2-Norm=16.295 | L2-Norm(final)=2.222 | acc=0.9375 | 4369.9 samples/s | 68.3 steps/s
[Step=2650 Epoch= 2.6] | Loss=0.07223 | Reg=0.00266 | L2-Norm=16.318 | L2-Norm(final)=2.225 | acc=0.9375 | 4502.6 samples/s | 70.4 steps/s
[Step=2700 Epoch= 2.6] | Loss=0.07011 | Reg=0.00267 | L2-Norm=16.337 | L2-Norm(final)=2.226 | acc=0.9531 | 4689.1 samples/s | 73.3 steps/s
[Step=2750 Epoch= 2.7] | Loss=0.06872 | Reg=0.00267 | L2-Norm=16.354 | L2-Norm(final)=2.228 | acc=0.9531 | 4740.3 samples/s | 74.1 steps/s
[Step=2800 Epoch= 2.7] | Loss=0.06686 | Reg=0.00268 | L2-Norm=16.370 | L2-Norm(final)=2.230 | acc=0.9531 | 4661.7 samples/s | 72.8 steps/s
[Step=2850 Epoch= 2.8] | Loss=0.06636 | Reg=0.00268 | L2-Norm=16.385 | L2-Norm(final)=2.231 | acc=0.9531 | 4422.0 samples/s | 69.1 steps/s
[Step=2900 Epoch= 2.8] | Loss=0.06481 | Reg=0.00269 | L2-Norm=16.400 | L2-Norm(final)=2.233 | acc=0.9375 | 4595.5 samples/s | 71.8 steps/s
[Step=2950 Epoch= 2.9] | Loss=0.06418 | Reg=0.00269 | L2-Norm=16.412 | L2-Norm(final)=2.235 | acc=0.9531 | 4575.3 samples/s | 71.5 steps/s
[Step=3000 Epoch= 2.9] | Loss=0.06347 | Reg=0.00270 | L2-Norm=16.424 | L2-Norm(final)=2.236 | acc=0.9844 | 4851.4 samples/s | 75.8 steps/s
[Step=3050 Epoch= 3.0] | Loss=0.06262 | Reg=0.00270 | L2-Norm=16.435 | L2-Norm(final)=2.238 | acc=0.9375 | 4574.4 samples/s | 71.5 steps/s
[Step=3100 Epoch= 3.0] | Loss=0.06237 | Reg=0.00270 | L2-Norm=16.445 | L2-Norm(final)=2.239 | acc=0.9375 | 4450.2 samples/s | 69.5 steps/s
[Step=3150 Epoch= 3.1] | Loss=0.06148 | Reg=0.00271 | L2-Norm=16.455 | L2-Norm(final)=2.240 | acc=0.9688 | 4613.3 samples/s | 72.1 steps/s
[Step=3200 Epoch= 3.1] | Loss=0.06076 | Reg=0.00271 | L2-Norm=16.464 | L2-Norm(final)=2.240 | acc=0.9844 | 4545.0 samples/s | 71.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step3200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 4.5] | Loss=0.06373 | Reg=0.00256 | L2-Norm=16.000 | L2-Norm(final)=2.229 | acc=0.9688 | 3401.6 samples/s | 53.2 steps/s
[Step=2450 Epoch= 4.6] | Loss=0.01134 | Reg=0.00259 | L2-Norm=16.104 | L2-Norm(final)=2.243 | acc=0.9844 | 4382.8 samples/s | 68.5 steps/s
[Step=2500 Epoch= 4.7] | Loss=0.00835 | Reg=0.00260 | L2-Norm=16.126 | L2-Norm(final)=2.245 | acc=1.0000 | 4210.5 samples/s | 65.8 steps/s
[Step=2550 Epoch= 4.8] | Loss=0.00967 | Reg=0.00260 | L2-Norm=16.127 | L2-Norm(final)=2.241 | acc=1.0000 | 4293.9 samples/s | 67.1 steps/s
[Step=2600 Epoch= 4.9] | Loss=0.00865 | Reg=0.00260 | L2-Norm=16.130 | L2-Norm(final)=2.235 | acc=1.0000 | 4477.6 samples/s | 70.0 steps/s
[Step=2650 Epoch= 5.0] | Loss=0.00786 | Reg=0.00260 | L2-Norm=16.129 | L2-Norm(final)=2.232 | acc=1.0000 | 4415.7 samples/s | 69.0 steps/s
[Step=2700 Epoch= 5.1] | Loss=0.00718 | Reg=0.00260 | L2-Norm=16.122 | L2-Norm(final)=2.232 | acc=0.9844 | 4256.6 samples/s | 66.5 steps/s
[Step=2750 Epoch= 5.2] | Loss=0.00659 | Reg=0.00260 | L2-Norm=16.116 | L2-Norm(final)=2.232 | acc=1.0000 | 4415.6 samples/s | 69.0 steps/s
[Step=2800 Epoch= 5.3] | Loss=0.00631 | Reg=0.00259 | L2-Norm=16.108 | L2-Norm(final)=2.232 | acc=0.9844 | 4648.2 samples/s | 72.6 steps/s
[Step=2850 Epoch= 5.4] | Loss=0.00581 | Reg=0.00259 | L2-Norm=16.099 | L2-Norm(final)=2.232 | acc=1.0000 | 4273.1 samples/s | 66.8 steps/s
[Step=2900 Epoch= 5.5] | Loss=0.00527 | Reg=0.00259 | L2-Norm=16.088 | L2-Norm(final)=2.232 | acc=1.0000 | 4498.0 samples/s | 70.3 steps/s
[Step=2950 Epoch= 5.6] | Loss=0.00496 | Reg=0.00258 | L2-Norm=16.074 | L2-Norm(final)=2.232 | acc=1.0000 | 1520.1 samples/s | 23.8 steps/s
[Step=3000 Epoch= 5.7] | Loss=0.00484 | Reg=0.00258 | L2-Norm=16.058 | L2-Norm(final)=2.233 | acc=1.0000 | 4574.5 samples/s | 71.5 steps/s
[Step=3050 Epoch= 5.7] | Loss=0.00455 | Reg=0.00257 | L2-Norm=16.043 | L2-Norm(final)=2.233 | acc=1.0000 | 4615.2 samples/s | 72.1 steps/s
[Step=3100 Epoch= 5.8] | Loss=0.00425 | Reg=0.00257 | L2-Norm=16.026 | L2-Norm(final)=2.233 | acc=1.0000 | 4320.6 samples/s | 67.5 steps/s
[Step=3150 Epoch= 5.9] | Loss=0.00406 | Reg=0.00256 | L2-Norm=16.008 | L2-Norm(final)=2.233 | acc=1.0000 | 4253.4 samples/s | 66.5 steps/s
[Step=3200 Epoch= 6.0] | Loss=0.00383 | Reg=0.00256 | L2-Norm=15.991 | L2-Norm(final)=2.234 | acc=1.0000 | 4271.2 samples/s | 66.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.53195 | acc=0.5709 | tpr=0.3842 | fpr=0.0238 | 4469.2 samples/s | 17.5 steps/s
Avg test loss: 0.53207, Avg test acc: 0.56928, Avg tpr: 0.38422, Avg fpr: 0.02371, total FA: 185

Testing server on iccad2012
[Step=  50] | Loss=0.19600 | acc=0.8605 | tpr=0.9558 | fpr=0.1412 | 4315.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.19818 | acc=0.8604 | tpr=0.9510 | fpr=0.1413 | 8886.8 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.19901 | acc=0.8590 | tpr=0.9553 | fpr=0.1428 | 8711.6 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.20011 | acc=0.8581 | tpr=0.9596 | fpr=0.1438 | 9044.5 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.20010 | acc=0.8584 | tpr=0.9616 | fpr=0.1435 | 8952.0 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.20030 | acc=0.8592 | tpr=0.9622 | fpr=0.1426 | 9003.5 samples/s | 35.2 steps/s
[Step= 350] | Loss=0.19959 | acc=0.8592 | tpr=0.9631 | fpr=0.1427 | 8940.8 samples/s | 34.9 steps/s
[Step= 400] | Loss=0.20030 | acc=0.8590 | tpr=0.9633 | fpr=0.1429 | 8688.0 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.20112 | acc=0.8584 | tpr=0.9625 | fpr=0.1435 | 8775.0 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.20147 | acc=0.8580 | tpr=0.9608 | fpr=0.1438 | 8688.1 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.20121 | acc=0.8582 | tpr=0.9618 | fpr=0.1437 | 16810.0 samples/s | 65.7 steps/s
Avg test loss: 0.20111, Avg test acc: 0.85817, Avg tpr: 0.96197, Avg fpr: 0.14372, total FA: 19955

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 3.1] | Loss=0.40218 | Reg=0.00247 | L2-Norm=15.717 | L2-Norm(final)=2.234 | acc=0.7188 | 3669.4 samples/s | 57.3 steps/s
[Step=3250 Epoch= 3.2] | Loss=0.10400 | Reg=0.00250 | L2-Norm=15.824 | L2-Norm(final)=2.226 | acc=0.9688 | 4615.3 samples/s | 72.1 steps/s
[Step=3300 Epoch= 3.2] | Loss=0.08160 | Reg=0.00252 | L2-Norm=15.882 | L2-Norm(final)=2.234 | acc=0.9375 | 4456.6 samples/s | 69.6 steps/s
[Step=3350 Epoch= 3.3] | Loss=0.07362 | Reg=0.00253 | L2-Norm=15.920 | L2-Norm(final)=2.241 | acc=0.9375 | 4590.4 samples/s | 71.7 steps/s
[Step=3400 Epoch= 3.3] | Loss=0.06726 | Reg=0.00254 | L2-Norm=15.947 | L2-Norm(final)=2.246 | acc=0.9844 | 4617.3 samples/s | 72.1 steps/s
[Step=3450 Epoch= 3.4] | Loss=0.06461 | Reg=0.00255 | L2-Norm=15.968 | L2-Norm(final)=2.249 | acc=0.9531 | 4550.9 samples/s | 71.1 steps/s
[Step=3500 Epoch= 3.4] | Loss=0.06342 | Reg=0.00256 | L2-Norm=15.987 | L2-Norm(final)=2.251 | acc=0.9688 | 4484.4 samples/s | 70.1 steps/s
[Step=3550 Epoch= 3.5] | Loss=0.06244 | Reg=0.00256 | L2-Norm=16.003 | L2-Norm(final)=2.252 | acc=0.9688 | 4524.4 samples/s | 70.7 steps/s
[Step=3600 Epoch= 3.5] | Loss=0.06097 | Reg=0.00257 | L2-Norm=16.021 | L2-Norm(final)=2.254 | acc=0.9844 | 4495.7 samples/s | 70.2 steps/s
[Step=3650 Epoch= 3.6] | Loss=0.05975 | Reg=0.00257 | L2-Norm=16.039 | L2-Norm(final)=2.256 | acc=0.9844 | 4566.4 samples/s | 71.4 steps/s
[Step=3700 Epoch= 3.6] | Loss=0.05887 | Reg=0.00258 | L2-Norm=16.055 | L2-Norm(final)=2.258 | acc=0.9219 | 4577.5 samples/s | 71.5 steps/s
[Step=3750 Epoch= 3.7] | Loss=0.05868 | Reg=0.00258 | L2-Norm=16.071 | L2-Norm(final)=2.259 | acc=0.9844 | 4678.1 samples/s | 73.1 steps/s
[Step=3800 Epoch= 3.7] | Loss=0.05788 | Reg=0.00259 | L2-Norm=16.086 | L2-Norm(final)=2.260 | acc=0.9844 | 4723.4 samples/s | 73.8 steps/s
[Step=3850 Epoch= 3.8] | Loss=0.05774 | Reg=0.00259 | L2-Norm=16.100 | L2-Norm(final)=2.260 | acc=0.9219 | 4406.4 samples/s | 68.8 steps/s
[Step=3900 Epoch= 3.8] | Loss=0.05728 | Reg=0.00260 | L2-Norm=16.113 | L2-Norm(final)=2.260 | acc=1.0000 | 4471.2 samples/s | 69.9 steps/s
[Step=3950 Epoch= 3.9] | Loss=0.05671 | Reg=0.00260 | L2-Norm=16.128 | L2-Norm(final)=2.261 | acc=1.0000 | 4594.5 samples/s | 71.8 steps/s
[Step=4000 Epoch= 3.9] | Loss=0.05594 | Reg=0.00261 | L2-Norm=16.143 | L2-Norm(final)=2.261 | acc=0.9688 | 4545.4 samples/s | 71.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 6.0] | Loss=0.05823 | Reg=0.00247 | L2-Norm=15.717 | L2-Norm(final)=2.237 | acc=0.9375 | 3327.6 samples/s | 52.0 steps/s
[Step=3250 Epoch= 6.1] | Loss=0.00798 | Reg=0.00251 | L2-Norm=15.834 | L2-Norm(final)=2.261 | acc=1.0000 | 4129.2 samples/s | 64.5 steps/s
[Step=3300 Epoch= 6.2] | Loss=0.00881 | Reg=0.00252 | L2-Norm=15.866 | L2-Norm(final)=2.259 | acc=1.0000 | 4423.5 samples/s | 69.1 steps/s
[Step=3350 Epoch= 6.3] | Loss=0.00776 | Reg=0.00252 | L2-Norm=15.890 | L2-Norm(final)=2.258 | acc=1.0000 | 4294.1 samples/s | 67.1 steps/s
[Step=3400 Epoch= 6.4] | Loss=0.00825 | Reg=0.00253 | L2-Norm=15.909 | L2-Norm(final)=2.256 | acc=0.9531 | 4343.7 samples/s | 67.9 steps/s
[Step=3450 Epoch= 6.5] | Loss=0.00710 | Reg=0.00254 | L2-Norm=15.923 | L2-Norm(final)=2.254 | acc=1.0000 | 4553.3 samples/s | 71.1 steps/s
[Step=3500 Epoch= 6.6] | Loss=0.00671 | Reg=0.00254 | L2-Norm=15.928 | L2-Norm(final)=2.252 | acc=1.0000 | 4358.3 samples/s | 68.1 steps/s
[Step=3550 Epoch= 6.7] | Loss=0.00632 | Reg=0.00254 | L2-Norm=15.934 | L2-Norm(final)=2.251 | acc=1.0000 | 4430.4 samples/s | 69.2 steps/s
[Step=3600 Epoch= 6.8] | Loss=0.00562 | Reg=0.00254 | L2-Norm=15.935 | L2-Norm(final)=2.250 | acc=1.0000 | 4379.2 samples/s | 68.4 steps/s
[Step=3650 Epoch= 6.9] | Loss=0.00515 | Reg=0.00254 | L2-Norm=15.932 | L2-Norm(final)=2.250 | acc=1.0000 | 4552.9 samples/s | 71.1 steps/s
[Step=3700 Epoch= 7.0] | Loss=0.00485 | Reg=0.00254 | L2-Norm=15.926 | L2-Norm(final)=2.250 | acc=1.0000 | 4412.6 samples/s | 68.9 steps/s
[Step=3750 Epoch= 7.1] | Loss=0.00445 | Reg=0.00253 | L2-Norm=15.916 | L2-Norm(final)=2.250 | acc=1.0000 | 1474.8 samples/s | 23.0 steps/s
[Step=3800 Epoch= 7.2] | Loss=0.00417 | Reg=0.00253 | L2-Norm=15.905 | L2-Norm(final)=2.250 | acc=1.0000 | 4453.3 samples/s | 69.6 steps/s
[Step=3850 Epoch= 7.3] | Loss=0.00398 | Reg=0.00253 | L2-Norm=15.893 | L2-Norm(final)=2.251 | acc=1.0000 | 4314.4 samples/s | 67.4 steps/s
[Step=3900 Epoch= 7.4] | Loss=0.00375 | Reg=0.00252 | L2-Norm=15.881 | L2-Norm(final)=2.251 | acc=1.0000 | 4570.9 samples/s | 71.4 steps/s
[Step=3950 Epoch= 7.4] | Loss=0.00396 | Reg=0.00252 | L2-Norm=15.870 | L2-Norm(final)=2.250 | acc=1.0000 | 4533.9 samples/s | 70.8 steps/s
[Step=4000 Epoch= 7.5] | Loss=0.00375 | Reg=0.00252 | L2-Norm=15.860 | L2-Norm(final)=2.249 | acc=1.0000 | 4358.9 samples/s | 68.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.57168 | acc=0.5808 | tpr=0.4063 | fpr=0.0404 | 4508.3 samples/s | 17.6 steps/s
Avg test loss: 0.56731, Avg test acc: 0.57953, Avg tpr: 0.40578, Avg fpr: 0.03833, total FA: 299

Testing server on iccad2012
[Step=  50] | Loss=0.19870 | acc=0.8805 | tpr=0.9558 | fpr=0.1209 | 4493.1 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.20229 | acc=0.8779 | tpr=0.9595 | fpr=0.1236 | 9038.6 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.20403 | acc=0.8760 | tpr=0.9625 | fpr=0.1256 | 9262.3 samples/s | 36.2 steps/s
[Step= 200] | Loss=0.20570 | acc=0.8756 | tpr=0.9683 | fpr=0.1260 | 9173.9 samples/s | 35.8 steps/s
[Step= 250] | Loss=0.20550 | acc=0.8760 | tpr=0.9659 | fpr=0.1257 | 8890.6 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.20594 | acc=0.8763 | tpr=0.9673 | fpr=0.1254 | 9082.9 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.20546 | acc=0.8762 | tpr=0.9693 | fpr=0.1255 | 8592.0 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.20559 | acc=0.8758 | tpr=0.9683 | fpr=0.1258 | 9100.2 samples/s | 35.5 steps/s
[Step= 450] | Loss=0.20674 | acc=0.8752 | tpr=0.9688 | fpr=0.1265 | 8616.4 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.20682 | acc=0.8748 | tpr=0.9683 | fpr=0.1269 | 8968.4 samples/s | 35.0 steps/s
[Step= 550] | Loss=0.20605 | acc=0.8752 | tpr=0.9690 | fpr=0.1265 | 15100.2 samples/s | 59.0 steps/s
Avg test loss: 0.20595, Avg test acc: 0.87521, Avg tpr: 0.96910, Avg fpr: 0.12650, total FA: 17564

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 3.9] | Loss=0.20352 | Reg=0.00243 | L2-Norm=15.598 | L2-Norm(final)=2.248 | acc=0.8125 | 3670.7 samples/s | 57.4 steps/s
[Step=4050 Epoch= 4.0] | Loss=0.11384 | Reg=0.00248 | L2-Norm=15.758 | L2-Norm(final)=2.212 | acc=0.9375 | 4129.9 samples/s | 64.5 steps/s
[Step=4100 Epoch= 4.0] | Loss=0.08275 | Reg=0.00251 | L2-Norm=15.830 | L2-Norm(final)=2.222 | acc=0.9531 | 4462.0 samples/s | 69.7 steps/s
[Step=4150 Epoch= 4.1] | Loss=0.07377 | Reg=0.00252 | L2-Norm=15.870 | L2-Norm(final)=2.227 | acc=0.9531 | 4552.7 samples/s | 71.1 steps/s
[Step=4200 Epoch= 4.1] | Loss=0.06975 | Reg=0.00253 | L2-Norm=15.900 | L2-Norm(final)=2.230 | acc=1.0000 | 4598.8 samples/s | 71.9 steps/s
[Step=4250 Epoch= 4.1] | Loss=0.06641 | Reg=0.00254 | L2-Norm=15.927 | L2-Norm(final)=2.234 | acc=0.9531 | 4694.4 samples/s | 73.3 steps/s
[Step=4300 Epoch= 4.2] | Loss=0.06414 | Reg=0.00254 | L2-Norm=15.948 | L2-Norm(final)=2.235 | acc=0.9688 | 4575.9 samples/s | 71.5 steps/s
[Step=4350 Epoch= 4.2] | Loss=0.06207 | Reg=0.00255 | L2-Norm=15.968 | L2-Norm(final)=2.237 | acc=1.0000 | 4486.7 samples/s | 70.1 steps/s
[Step=4400 Epoch= 4.3] | Loss=0.05980 | Reg=0.00256 | L2-Norm=15.987 | L2-Norm(final)=2.239 | acc=0.9844 | 4518.9 samples/s | 70.6 steps/s
[Step=4450 Epoch= 4.3] | Loss=0.05893 | Reg=0.00256 | L2-Norm=16.005 | L2-Norm(final)=2.240 | acc=0.9062 | 4474.0 samples/s | 69.9 steps/s
[Step=4500 Epoch= 4.4] | Loss=0.05789 | Reg=0.00257 | L2-Norm=16.020 | L2-Norm(final)=2.240 | acc=0.9844 | 4654.1 samples/s | 72.7 steps/s
[Step=4550 Epoch= 4.4] | Loss=0.05678 | Reg=0.00257 | L2-Norm=16.036 | L2-Norm(final)=2.240 | acc=0.9844 | 4570.9 samples/s | 71.4 steps/s
[Step=4600 Epoch= 4.5] | Loss=0.05601 | Reg=0.00258 | L2-Norm=16.053 | L2-Norm(final)=2.240 | acc=0.9688 | 4609.8 samples/s | 72.0 steps/s
[Step=4650 Epoch= 4.5] | Loss=0.05517 | Reg=0.00258 | L2-Norm=16.071 | L2-Norm(final)=2.240 | acc=0.9844 | 4645.7 samples/s | 72.6 steps/s
[Step=4700 Epoch= 4.6] | Loss=0.05464 | Reg=0.00259 | L2-Norm=16.088 | L2-Norm(final)=2.240 | acc=0.9531 | 4574.3 samples/s | 71.5 steps/s
[Step=4750 Epoch= 4.6] | Loss=0.05375 | Reg=0.00259 | L2-Norm=16.105 | L2-Norm(final)=2.240 | acc=0.9844 | 4717.7 samples/s | 73.7 steps/s
[Step=4800 Epoch= 4.7] | Loss=0.05309 | Reg=0.00260 | L2-Norm=16.121 | L2-Norm(final)=2.241 | acc=0.9688 | 4656.9 samples/s | 72.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 7.5] | Loss=0.04922 | Reg=0.00243 | L2-Norm=15.598 | L2-Norm(final)=2.247 | acc=0.9844 | 3717.6 samples/s | 58.1 steps/s
[Step=4050 Epoch= 7.6] | Loss=0.00665 | Reg=0.00247 | L2-Norm=15.713 | L2-Norm(final)=2.259 | acc=0.9844 | 3928.0 samples/s | 61.4 steps/s
[Step=4100 Epoch= 7.7] | Loss=0.00534 | Reg=0.00248 | L2-Norm=15.738 | L2-Norm(final)=2.261 | acc=1.0000 | 4395.9 samples/s | 68.7 steps/s
[Step=4150 Epoch= 7.8] | Loss=0.00688 | Reg=0.00248 | L2-Norm=15.749 | L2-Norm(final)=2.258 | acc=1.0000 | 4438.9 samples/s | 69.4 steps/s
[Step=4200 Epoch= 7.9] | Loss=0.00623 | Reg=0.00248 | L2-Norm=15.759 | L2-Norm(final)=2.252 | acc=1.0000 | 4342.8 samples/s | 67.9 steps/s
[Step=4250 Epoch= 8.0] | Loss=0.00532 | Reg=0.00248 | L2-Norm=15.758 | L2-Norm(final)=2.248 | acc=1.0000 | 4416.6 samples/s | 69.0 steps/s
[Step=4300 Epoch= 8.1] | Loss=0.00464 | Reg=0.00248 | L2-Norm=15.750 | L2-Norm(final)=2.246 | acc=1.0000 | 4460.3 samples/s | 69.7 steps/s
[Step=4350 Epoch= 8.2] | Loss=0.00404 | Reg=0.00248 | L2-Norm=15.737 | L2-Norm(final)=2.246 | acc=1.0000 | 4384.2 samples/s | 68.5 steps/s
[Step=4400 Epoch= 8.3] | Loss=0.00356 | Reg=0.00247 | L2-Norm=15.721 | L2-Norm(final)=2.247 | acc=1.0000 | 4466.7 samples/s | 69.8 steps/s
[Step=4450 Epoch= 8.4] | Loss=0.00319 | Reg=0.00247 | L2-Norm=15.702 | L2-Norm(final)=2.249 | acc=1.0000 | 4189.9 samples/s | 65.5 steps/s
[Step=4500 Epoch= 8.5] | Loss=0.00290 | Reg=0.00246 | L2-Norm=15.682 | L2-Norm(final)=2.250 | acc=1.0000 | 4520.4 samples/s | 70.6 steps/s
[Step=4550 Epoch= 8.6] | Loss=0.00265 | Reg=0.00245 | L2-Norm=15.661 | L2-Norm(final)=2.252 | acc=1.0000 | 1516.5 samples/s | 23.7 steps/s
[Step=4600 Epoch= 8.7] | Loss=0.00243 | Reg=0.00245 | L2-Norm=15.639 | L2-Norm(final)=2.254 | acc=1.0000 | 4311.5 samples/s | 67.4 steps/s
[Step=4650 Epoch= 8.8] | Loss=0.00224 | Reg=0.00244 | L2-Norm=15.615 | L2-Norm(final)=2.256 | acc=1.0000 | 4238.3 samples/s | 66.2 steps/s
[Step=4700 Epoch= 8.9] | Loss=0.00208 | Reg=0.00243 | L2-Norm=15.590 | L2-Norm(final)=2.257 | acc=1.0000 | 4391.6 samples/s | 68.6 steps/s
[Step=4750 Epoch= 9.0] | Loss=0.00194 | Reg=0.00242 | L2-Norm=15.565 | L2-Norm(final)=2.259 | acc=1.0000 | 4397.3 samples/s | 68.7 steps/s
[Step=4800 Epoch= 9.0] | Loss=0.00182 | Reg=0.00241 | L2-Norm=15.539 | L2-Norm(final)=2.260 | acc=1.0000 | 4394.9 samples/s | 68.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42504 | acc=0.6730 | tpr=0.5327 | fpr=0.0223 | 4386.3 samples/s | 17.1 steps/s
Avg test loss: 0.42052, Avg test acc: 0.67317, Avg tpr: 0.53494, Avg fpr: 0.02282, total FA: 178

Testing server on iccad2012
[Step=  50] | Loss=0.29222 | acc=0.8199 | tpr=0.9646 | fpr=0.1827 | 4489.3 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.29632 | acc=0.8195 | tpr=0.9723 | fpr=0.1834 | 8516.9 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.29849 | acc=0.8188 | tpr=0.9697 | fpr=0.1840 | 9697.6 samples/s | 37.9 steps/s
[Step= 200] | Loss=0.29939 | acc=0.8189 | tpr=0.9749 | fpr=0.1839 | 8942.9 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.29938 | acc=0.8189 | tpr=0.9773 | fpr=0.1840 | 8101.5 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.29988 | acc=0.8189 | tpr=0.9789 | fpr=0.1841 | 9125.8 samples/s | 35.6 steps/s
[Step= 350] | Loss=0.29912 | acc=0.8189 | tpr=0.9800 | fpr=0.1840 | 8598.8 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.29975 | acc=0.8190 | tpr=0.9787 | fpr=0.1839 | 8741.2 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.30136 | acc=0.8184 | tpr=0.9786 | fpr=0.1845 | 9169.1 samples/s | 35.8 steps/s
[Step= 500] | Loss=0.30179 | acc=0.8179 | tpr=0.9784 | fpr=0.1850 | 8854.6 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.30107 | acc=0.8184 | tpr=0.9785 | fpr=0.1845 | 16074.2 samples/s | 62.8 steps/s
Avg test loss: 0.30083, Avg test acc: 0.81847, Avg tpr: 0.97861, Avg fpr: 0.18444, total FA: 25609

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 4.7] | Loss=0.23458 | Reg=0.00237 | L2-Norm=15.389 | L2-Norm(final)=2.258 | acc=0.7969 | 3498.6 samples/s | 54.7 steps/s
[Step=4850 Epoch= 4.7] | Loss=0.07325 | Reg=0.00240 | L2-Norm=15.503 | L2-Norm(final)=2.249 | acc=0.9531 | 4709.9 samples/s | 73.6 steps/s
[Step=4900 Epoch= 4.8] | Loss=0.06214 | Reg=0.00242 | L2-Norm=15.561 | L2-Norm(final)=2.256 | acc=0.9531 | 4688.8 samples/s | 73.3 steps/s
[Step=4950 Epoch= 4.8] | Loss=0.05853 | Reg=0.00243 | L2-Norm=15.597 | L2-Norm(final)=2.259 | acc=0.9375 | 4381.5 samples/s | 68.5 steps/s
[Step=5000 Epoch= 4.9] | Loss=0.05397 | Reg=0.00244 | L2-Norm=15.631 | L2-Norm(final)=2.264 | acc=0.9688 | 4621.1 samples/s | 72.2 steps/s
[Step=5050 Epoch= 4.9] | Loss=0.05397 | Reg=0.00245 | L2-Norm=15.660 | L2-Norm(final)=2.266 | acc=0.9844 | 4571.3 samples/s | 71.4 steps/s
[Step=5100 Epoch= 5.0] | Loss=0.05335 | Reg=0.00246 | L2-Norm=15.685 | L2-Norm(final)=2.265 | acc=0.9844 | 4728.5 samples/s | 73.9 steps/s
[Step=5150 Epoch= 5.0] | Loss=0.05191 | Reg=0.00247 | L2-Norm=15.709 | L2-Norm(final)=2.264 | acc=0.9844 | 4703.3 samples/s | 73.5 steps/s
[Step=5200 Epoch= 5.1] | Loss=0.05235 | Reg=0.00247 | L2-Norm=15.731 | L2-Norm(final)=2.263 | acc=0.9844 | 4615.3 samples/s | 72.1 steps/s
[Step=5250 Epoch= 5.1] | Loss=0.05174 | Reg=0.00248 | L2-Norm=15.756 | L2-Norm(final)=2.261 | acc=0.9531 | 4645.9 samples/s | 72.6 steps/s
[Step=5300 Epoch= 5.2] | Loss=0.05066 | Reg=0.00249 | L2-Norm=15.780 | L2-Norm(final)=2.260 | acc=1.0000 | 4693.5 samples/s | 73.3 steps/s
[Step=5350 Epoch= 5.2] | Loss=0.04993 | Reg=0.00250 | L2-Norm=15.803 | L2-Norm(final)=2.260 | acc=0.9531 | 4643.3 samples/s | 72.6 steps/s
[Step=5400 Epoch= 5.3] | Loss=0.04933 | Reg=0.00250 | L2-Norm=15.825 | L2-Norm(final)=2.260 | acc=0.9531 | 4701.7 samples/s | 73.5 steps/s
[Step=5450 Epoch= 5.3] | Loss=0.04873 | Reg=0.00251 | L2-Norm=15.847 | L2-Norm(final)=2.260 | acc=1.0000 | 4743.3 samples/s | 74.1 steps/s
[Step=5500 Epoch= 5.4] | Loss=0.04839 | Reg=0.00252 | L2-Norm=15.869 | L2-Norm(final)=2.260 | acc=0.9844 | 4624.8 samples/s | 72.3 steps/s
[Step=5550 Epoch= 5.4] | Loss=0.04772 | Reg=0.00253 | L2-Norm=15.891 | L2-Norm(final)=2.260 | acc=0.9844 | 4568.7 samples/s | 71.4 steps/s
[Step=5600 Epoch= 5.5] | Loss=0.04712 | Reg=0.00253 | L2-Norm=15.911 | L2-Norm(final)=2.260 | acc=0.9688 | 4434.0 samples/s | 69.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step5600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=4801 Epoch= 9.0] | Loss=0.09678 | Reg=0.00237 | L2-Norm=15.389 | L2-Norm(final)=2.258 | acc=0.8906 | 3875.6 samples/s | 60.6 steps/s
[Step=4850 Epoch= 9.1] | Loss=0.01124 | Reg=0.00242 | L2-Norm=15.564 | L2-Norm(final)=2.278 | acc=1.0000 | 3753.3 samples/s | 58.6 steps/s
[Step=4900 Epoch= 9.2] | Loss=0.01241 | Reg=0.00246 | L2-Norm=15.676 | L2-Norm(final)=2.257 | acc=1.0000 | 4298.7 samples/s | 67.2 steps/s
[Step=4950 Epoch= 9.3] | Loss=0.00887 | Reg=0.00247 | L2-Norm=15.729 | L2-Norm(final)=2.252 | acc=1.0000 | 4247.9 samples/s | 66.4 steps/s
[Step=5000 Epoch= 9.4] | Loss=0.00736 | Reg=0.00248 | L2-Norm=15.750 | L2-Norm(final)=2.253 | acc=1.0000 | 4327.4 samples/s | 67.6 steps/s
[Step=5050 Epoch= 9.5] | Loss=0.00635 | Reg=0.00248 | L2-Norm=15.759 | L2-Norm(final)=2.253 | acc=1.0000 | 4437.0 samples/s | 69.3 steps/s
[Step=5100 Epoch= 9.6] | Loss=0.00572 | Reg=0.00248 | L2-Norm=15.762 | L2-Norm(final)=2.252 | acc=1.0000 | 4367.3 samples/s | 68.2 steps/s
[Step=5150 Epoch= 9.7] | Loss=0.00515 | Reg=0.00248 | L2-Norm=15.758 | L2-Norm(final)=2.253 | acc=1.0000 | 4413.4 samples/s | 69.0 steps/s
[Step=5200 Epoch= 9.8] | Loss=0.00465 | Reg=0.00248 | L2-Norm=15.750 | L2-Norm(final)=2.254 | acc=1.0000 | 4222.7 samples/s | 66.0 steps/s
[Step=5250 Epoch= 9.9] | Loss=0.00427 | Reg=0.00248 | L2-Norm=15.741 | L2-Norm(final)=2.256 | acc=1.0000 | 4402.9 samples/s | 68.8 steps/s
[Step=5300 Epoch=10.0] | Loss=0.00394 | Reg=0.00247 | L2-Norm=15.730 | L2-Norm(final)=2.258 | acc=1.0000 | 4456.7 samples/s | 69.6 steps/s
[Step=5350 Epoch=10.1] | Loss=0.00383 | Reg=0.00247 | L2-Norm=15.718 | L2-Norm(final)=2.259 | acc=1.0000 | 1441.4 samples/s | 22.5 steps/s
[Step=5400 Epoch=10.2] | Loss=0.00354 | Reg=0.00247 | L2-Norm=15.707 | L2-Norm(final)=2.261 | acc=1.0000 | 4289.5 samples/s | 67.0 steps/s
[Step=5450 Epoch=10.3] | Loss=0.00328 | Reg=0.00246 | L2-Norm=15.693 | L2-Norm(final)=2.262 | acc=1.0000 | 4351.9 samples/s | 68.0 steps/s
[Step=5500 Epoch=10.4] | Loss=0.00305 | Reg=0.00246 | L2-Norm=15.677 | L2-Norm(final)=2.264 | acc=1.0000 | 4272.0 samples/s | 66.7 steps/s
[Step=5550 Epoch=10.5] | Loss=0.00286 | Reg=0.00245 | L2-Norm=15.659 | L2-Norm(final)=2.265 | acc=1.0000 | 4580.2 samples/s | 71.6 steps/s
[Step=5600 Epoch=10.6] | Loss=0.00268 | Reg=0.00245 | L2-Norm=15.641 | L2-Norm(final)=2.267 | acc=1.0000 | 4395.4 samples/s | 68.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.59200 | acc=0.5905 | tpr=0.4125 | fpr=0.0228 | 4451.0 samples/s | 17.4 steps/s
Avg test loss: 0.58675, Avg test acc: 0.58987, Avg tpr: 0.41435, Avg fpr: 0.02410, total FA: 188

Testing server on iccad2012
[Step=  50] | Loss=0.19531 | acc=0.8966 | tpr=0.9646 | fpr=0.1046 | 4455.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.19797 | acc=0.8954 | tpr=0.9638 | fpr=0.1059 | 8851.1 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.20089 | acc=0.8949 | tpr=0.9697 | fpr=0.1065 | 8985.3 samples/s | 35.1 steps/s
[Step= 200] | Loss=0.20183 | acc=0.8944 | tpr=0.9738 | fpr=0.1071 | 8657.8 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.20171 | acc=0.8937 | tpr=0.9747 | fpr=0.1078 | 9146.2 samples/s | 35.7 steps/s
[Step= 300] | Loss=0.20293 | acc=0.8934 | tpr=0.9767 | fpr=0.1082 | 8559.9 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.20317 | acc=0.8931 | tpr=0.9775 | fpr=0.1084 | 9350.0 samples/s | 36.5 steps/s
[Step= 400] | Loss=0.20423 | acc=0.8929 | tpr=0.9770 | fpr=0.1086 | 8933.5 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.20603 | acc=0.8920 | tpr=0.9761 | fpr=0.1095 | 8514.2 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.20589 | acc=0.8920 | tpr=0.9762 | fpr=0.1095 | 8600.4 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.20528 | acc=0.8919 | tpr=0.9765 | fpr=0.1096 | 16542.3 samples/s | 64.6 steps/s
Avg test loss: 0.20498, Avg test acc: 0.89197, Avg tpr: 0.97662, Avg fpr: 0.10957, total FA: 15213

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch= 5.5] | Loss=0.41616 | Reg=0.00236 | L2-Norm=15.365 | L2-Norm(final)=2.266 | acc=0.6719 | 3565.2 samples/s | 55.7 steps/s
[Step=5650 Epoch= 5.5] | Loss=0.08905 | Reg=0.00242 | L2-Norm=15.543 | L2-Norm(final)=2.241 | acc=0.9531 | 4438.8 samples/s | 69.4 steps/s
[Step=5700 Epoch= 5.6] | Loss=0.06873 | Reg=0.00244 | L2-Norm=15.632 | L2-Norm(final)=2.254 | acc=0.9688 | 4656.5 samples/s | 72.8 steps/s
[Step=5750 Epoch= 5.6] | Loss=0.06073 | Reg=0.00246 | L2-Norm=15.680 | L2-Norm(final)=2.258 | acc=0.9531 | 4725.4 samples/s | 73.8 steps/s
[Step=5800 Epoch= 5.7] | Loss=0.05560 | Reg=0.00247 | L2-Norm=15.717 | L2-Norm(final)=2.261 | acc=0.9688 | 4557.3 samples/s | 71.2 steps/s
[Step=5850 Epoch= 5.7] | Loss=0.05258 | Reg=0.00248 | L2-Norm=15.745 | L2-Norm(final)=2.261 | acc=0.9531 | 3775.6 samples/s | 59.0 steps/s
[Step=5900 Epoch= 5.8] | Loss=0.05075 | Reg=0.00249 | L2-Norm=15.769 | L2-Norm(final)=2.261 | acc=0.9531 | 3770.4 samples/s | 58.9 steps/s
[Step=5950 Epoch= 5.8] | Loss=0.05058 | Reg=0.00249 | L2-Norm=15.792 | L2-Norm(final)=2.260 | acc=0.9688 | 3737.1 samples/s | 58.4 steps/s
[Step=6000 Epoch= 5.9] | Loss=0.04934 | Reg=0.00250 | L2-Norm=15.814 | L2-Norm(final)=2.261 | acc=0.9531 | 3769.3 samples/s | 58.9 steps/s
[Step=6050 Epoch= 5.9] | Loss=0.04824 | Reg=0.00251 | L2-Norm=15.834 | L2-Norm(final)=2.262 | acc=0.9844 | 3677.9 samples/s | 57.5 steps/s
[Step=6100 Epoch= 6.0] | Loss=0.04724 | Reg=0.00251 | L2-Norm=15.855 | L2-Norm(final)=2.263 | acc=0.9844 | 3681.9 samples/s | 57.5 steps/s
[Step=6150 Epoch= 6.0] | Loss=0.04647 | Reg=0.00252 | L2-Norm=15.876 | L2-Norm(final)=2.264 | acc=0.9531 | 3897.8 samples/s | 60.9 steps/s
[Step=6200 Epoch= 6.1] | Loss=0.04664 | Reg=0.00253 | L2-Norm=15.895 | L2-Norm(final)=2.264 | acc=0.9219 | 4081.4 samples/s | 63.8 steps/s
[Step=6250 Epoch= 6.1] | Loss=0.04657 | Reg=0.00253 | L2-Norm=15.914 | L2-Norm(final)=2.263 | acc=0.9688 | 3769.4 samples/s | 58.9 steps/s
[Step=6300 Epoch= 6.2] | Loss=0.04616 | Reg=0.00254 | L2-Norm=15.932 | L2-Norm(final)=2.262 | acc=0.9688 | 3700.8 samples/s | 57.8 steps/s
[Step=6350 Epoch= 6.2] | Loss=0.04565 | Reg=0.00254 | L2-Norm=15.950 | L2-Norm(final)=2.261 | acc=0.9844 | 3755.4 samples/s | 58.7 steps/s
[Step=6400 Epoch= 6.2] | Loss=0.04575 | Reg=0.00255 | L2-Norm=15.966 | L2-Norm(final)=2.259 | acc=0.9844 | 3771.2 samples/s | 58.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step6400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=5601 Epoch=10.6] | Loss=0.03080 | Reg=0.00236 | L2-Norm=15.365 | L2-Norm(final)=2.269 | acc=0.9688 | 2902.7 samples/s | 45.4 steps/s
[Step=5650 Epoch=10.7] | Loss=0.00414 | Reg=0.00239 | L2-Norm=15.447 | L2-Norm(final)=2.287 | acc=1.0000 | 4171.0 samples/s | 65.2 steps/s
[Step=5700 Epoch=10.7] | Loss=0.00608 | Reg=0.00239 | L2-Norm=15.460 | L2-Norm(final)=2.290 | acc=0.9844 | 4268.2 samples/s | 66.7 steps/s
[Step=5750 Epoch=10.8] | Loss=0.00489 | Reg=0.00240 | L2-Norm=15.496 | L2-Norm(final)=2.286 | acc=1.0000 | 4169.6 samples/s | 65.2 steps/s
[Step=5800 Epoch=10.9] | Loss=0.00407 | Reg=0.00241 | L2-Norm=15.511 | L2-Norm(final)=2.288 | acc=1.0000 | 4424.2 samples/s | 69.1 steps/s
[Step=5850 Epoch=11.0] | Loss=0.00334 | Reg=0.00241 | L2-Norm=15.513 | L2-Norm(final)=2.292 | acc=1.0000 | 4346.6 samples/s | 67.9 steps/s
[Step=5900 Epoch=11.1] | Loss=0.00280 | Reg=0.00240 | L2-Norm=15.504 | L2-Norm(final)=2.296 | acc=1.0000 | 4463.0 samples/s | 69.7 steps/s
[Step=5950 Epoch=11.2] | Loss=0.00242 | Reg=0.00240 | L2-Norm=15.490 | L2-Norm(final)=2.299 | acc=1.0000 | 4335.0 samples/s | 67.7 steps/s
[Step=6000 Epoch=11.3] | Loss=0.00212 | Reg=0.00239 | L2-Norm=15.472 | L2-Norm(final)=2.303 | acc=1.0000 | 4345.3 samples/s | 67.9 steps/s
[Step=6050 Epoch=11.4] | Loss=0.00193 | Reg=0.00239 | L2-Norm=15.451 | L2-Norm(final)=2.306 | acc=1.0000 | 4562.1 samples/s | 71.3 steps/s
[Step=6100 Epoch=11.5] | Loss=0.00209 | Reg=0.00238 | L2-Norm=15.432 | L2-Norm(final)=2.307 | acc=1.0000 | 4290.2 samples/s | 67.0 steps/s
[Step=6150 Epoch=11.6] | Loss=0.00196 | Reg=0.00238 | L2-Norm=15.418 | L2-Norm(final)=2.308 | acc=1.0000 | 1497.7 samples/s | 23.4 steps/s
[Step=6200 Epoch=11.7] | Loss=0.00180 | Reg=0.00237 | L2-Norm=15.403 | L2-Norm(final)=2.310 | acc=1.0000 | 4410.4 samples/s | 68.9 steps/s
[Step=6250 Epoch=11.8] | Loss=0.00168 | Reg=0.00237 | L2-Norm=15.386 | L2-Norm(final)=2.311 | acc=1.0000 | 4241.2 samples/s | 66.3 steps/s
[Step=6300 Epoch=11.9] | Loss=0.00156 | Reg=0.00236 | L2-Norm=15.368 | L2-Norm(final)=2.314 | acc=1.0000 | 4348.0 samples/s | 67.9 steps/s
[Step=6350 Epoch=12.0] | Loss=0.00146 | Reg=0.00236 | L2-Norm=15.349 | L2-Norm(final)=2.315 | acc=1.0000 | 4284.4 samples/s | 66.9 steps/s
[Step=6400 Epoch=12.1] | Loss=0.00137 | Reg=0.00235 | L2-Norm=15.328 | L2-Norm(final)=2.317 | acc=1.0000 | 4315.4 samples/s | 67.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.49586 | acc=0.6443 | tpr=0.4859 | fpr=0.0116 | 4374.4 samples/s | 17.1 steps/s
Avg test loss: 0.49288, Avg test acc: 0.64348, Avg tpr: 0.48721, Avg fpr: 0.01282, total FA: 100

Testing server on iccad2012
[Step=  50] | Loss=0.20653 | acc=0.8812 | tpr=0.9602 | fpr=0.1202 | 4422.0 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.21150 | acc=0.8793 | tpr=0.9595 | fpr=0.1222 | 8874.7 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.21517 | acc=0.8777 | tpr=0.9568 | fpr=0.1238 | 8642.5 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.21658 | acc=0.8776 | tpr=0.9628 | fpr=0.1240 | 9041.0 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.21620 | acc=0.8780 | tpr=0.9651 | fpr=0.1236 | 8949.8 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.21743 | acc=0.8778 | tpr=0.9665 | fpr=0.1238 | 9317.8 samples/s | 36.4 steps/s
[Step= 350] | Loss=0.21712 | acc=0.8775 | tpr=0.9693 | fpr=0.1242 | 8540.8 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.21840 | acc=0.8769 | tpr=0.9677 | fpr=0.1247 | 8668.4 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.22009 | acc=0.8764 | tpr=0.9679 | fpr=0.1253 | 9096.0 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.22015 | acc=0.8763 | tpr=0.9687 | fpr=0.1253 | 8663.6 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.21957 | acc=0.8766 | tpr=0.9698 | fpr=0.1251 | 16338.7 samples/s | 63.8 steps/s
Avg test loss: 0.21948, Avg test acc: 0.87662, Avg tpr: 0.96989, Avg fpr: 0.12507, total FA: 17366

server round 8/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch= 6.2] | Loss=0.39777 | Reg=0.00233 | L2-Norm=15.253 | L2-Norm(final)=2.276 | acc=0.6875 | 3876.4 samples/s | 60.6 steps/s
[Step=6450 Epoch= 6.3] | Loss=0.06963 | Reg=0.00237 | L2-Norm=15.406 | L2-Norm(final)=2.270 | acc=0.9531 | 4139.9 samples/s | 64.7 steps/s
[Step=6500 Epoch= 6.3] | Loss=0.05365 | Reg=0.00239 | L2-Norm=15.470 | L2-Norm(final)=2.273 | acc=0.9844 | 4508.3 samples/s | 70.4 steps/s
[Step=6550 Epoch= 6.4] | Loss=0.04983 | Reg=0.00241 | L2-Norm=15.508 | L2-Norm(final)=2.276 | acc=0.9531 | 4600.9 samples/s | 71.9 steps/s
[Step=6600 Epoch= 6.4] | Loss=0.04898 | Reg=0.00242 | L2-Norm=15.541 | L2-Norm(final)=2.274 | acc=0.9531 | 4789.3 samples/s | 74.8 steps/s
[Step=6650 Epoch= 6.5] | Loss=0.04763 | Reg=0.00242 | L2-Norm=15.571 | L2-Norm(final)=2.273 | acc=0.9844 | 4641.9 samples/s | 72.5 steps/s
[Step=6700 Epoch= 6.5] | Loss=0.04651 | Reg=0.00243 | L2-Norm=15.600 | L2-Norm(final)=2.273 | acc=0.9688 | 4644.7 samples/s | 72.6 steps/s
[Step=6750 Epoch= 6.6] | Loss=0.04624 | Reg=0.00244 | L2-Norm=15.626 | L2-Norm(final)=2.272 | acc=0.9688 | 4676.1 samples/s | 73.1 steps/s
[Step=6800 Epoch= 6.6] | Loss=0.04554 | Reg=0.00245 | L2-Norm=15.650 | L2-Norm(final)=2.273 | acc=0.9531 | 4778.8 samples/s | 74.7 steps/s
[Step=6850 Epoch= 6.7] | Loss=0.04541 | Reg=0.00246 | L2-Norm=15.672 | L2-Norm(final)=2.272 | acc=0.9844 | 4788.4 samples/s | 74.8 steps/s
[Step=6900 Epoch= 6.7] | Loss=0.04491 | Reg=0.00246 | L2-Norm=15.694 | L2-Norm(final)=2.271 | acc=0.9844 | 4704.2 samples/s | 73.5 steps/s
[Step=6950 Epoch= 6.8] | Loss=0.04435 | Reg=0.00247 | L2-Norm=15.716 | L2-Norm(final)=2.271 | acc=0.9844 | 4486.0 samples/s | 70.1 steps/s
[Step=7000 Epoch= 6.8] | Loss=0.04336 | Reg=0.00248 | L2-Norm=15.737 | L2-Norm(final)=2.271 | acc=0.9844 | 4587.2 samples/s | 71.7 steps/s
[Step=7050 Epoch= 6.9] | Loss=0.04256 | Reg=0.00248 | L2-Norm=15.757 | L2-Norm(final)=2.272 | acc=0.9844 | 4195.2 samples/s | 65.5 steps/s
[Step=7100 Epoch= 6.9] | Loss=0.04271 | Reg=0.00249 | L2-Norm=15.776 | L2-Norm(final)=2.272 | acc=0.9844 | 3729.3 samples/s | 58.3 steps/s
[Step=7150 Epoch= 7.0] | Loss=0.04249 | Reg=0.00250 | L2-Norm=15.795 | L2-Norm(final)=2.271 | acc=0.9375 | 3825.0 samples/s | 59.8 steps/s
[Step=7200 Epoch= 7.0] | Loss=0.04220 | Reg=0.00250 | L2-Norm=15.813 | L2-Norm(final)=2.270 | acc=0.9844 | 4064.0 samples/s | 63.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step7200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=6401 Epoch=12.1] | Loss=0.06945 | Reg=0.00233 | L2-Norm=15.253 | L2-Norm(final)=2.277 | acc=0.9688 | 2790.3 samples/s | 43.6 steps/s
[Step=6450 Epoch=12.2] | Loss=0.01149 | Reg=0.00238 | L2-Norm=15.442 | L2-Norm(final)=2.283 | acc=1.0000 | 4426.5 samples/s | 69.2 steps/s
[Step=6500 Epoch=12.3] | Loss=0.00725 | Reg=0.00241 | L2-Norm=15.516 | L2-Norm(final)=2.279 | acc=1.0000 | 4463.7 samples/s | 69.7 steps/s
[Step=6550 Epoch=12.3] | Loss=0.00563 | Reg=0.00241 | L2-Norm=15.537 | L2-Norm(final)=2.281 | acc=1.0000 | 4428.1 samples/s | 69.2 steps/s
[Step=6600 Epoch=12.4] | Loss=0.00520 | Reg=0.00242 | L2-Norm=15.545 | L2-Norm(final)=2.281 | acc=1.0000 | 4491.7 samples/s | 70.2 steps/s
[Step=6650 Epoch=12.5] | Loss=0.00524 | Reg=0.00242 | L2-Norm=15.561 | L2-Norm(final)=2.276 | acc=1.0000 | 4567.7 samples/s | 71.4 steps/s
[Step=6700 Epoch=12.6] | Loss=0.00489 | Reg=0.00243 | L2-Norm=15.578 | L2-Norm(final)=2.273 | acc=1.0000 | 4537.6 samples/s | 70.9 steps/s
[Step=6750 Epoch=12.7] | Loss=0.00491 | Reg=0.00243 | L2-Norm=15.591 | L2-Norm(final)=2.268 | acc=1.0000 | 4416.9 samples/s | 69.0 steps/s
[Step=6800 Epoch=12.8] | Loss=0.00533 | Reg=0.00244 | L2-Norm=15.608 | L2-Norm(final)=2.260 | acc=1.0000 | 4583.0 samples/s | 71.6 steps/s
[Step=6850 Epoch=12.9] | Loss=0.00524 | Reg=0.00244 | L2-Norm=15.626 | L2-Norm(final)=2.251 | acc=1.0000 | 4583.9 samples/s | 71.6 steps/s
[Step=6900 Epoch=13.0] | Loss=0.00497 | Reg=0.00245 | L2-Norm=15.640 | L2-Norm(final)=2.243 | acc=1.0000 | 4502.9 samples/s | 70.4 steps/s
[Step=6950 Epoch=13.1] | Loss=0.00461 | Reg=0.00245 | L2-Norm=15.650 | L2-Norm(final)=2.238 | acc=1.0000 | 1473.0 samples/s | 23.0 steps/s
[Step=7000 Epoch=13.2] | Loss=0.00440 | Reg=0.00245 | L2-Norm=15.657 | L2-Norm(final)=2.234 | acc=1.0000 | 4577.2 samples/s | 71.5 steps/s
[Step=7050 Epoch=13.3] | Loss=0.00420 | Reg=0.00245 | L2-Norm=15.662 | L2-Norm(final)=2.230 | acc=1.0000 | 4421.2 samples/s | 69.1 steps/s
[Step=7100 Epoch=13.4] | Loss=0.00409 | Reg=0.00246 | L2-Norm=15.668 | L2-Norm(final)=2.228 | acc=0.9844 | 4487.2 samples/s | 70.1 steps/s
[Step=7150 Epoch=13.5] | Loss=0.00397 | Reg=0.00246 | L2-Norm=15.676 | L2-Norm(final)=2.225 | acc=1.0000 | 4473.5 samples/s | 69.9 steps/s
[Step=7200 Epoch=13.6] | Loss=0.00389 | Reg=0.00246 | L2-Norm=15.682 | L2-Norm(final)=2.223 | acc=1.0000 | 4512.7 samples/s | 70.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.65601 | acc=0.5490 | tpr=0.3522 | fpr=0.0238 | 4504.1 samples/s | 17.6 steps/s
Avg test loss: 0.64989, Avg test acc: 0.54984, Avg tpr: 0.35612, Avg fpr: 0.02410, total FA: 188

Testing server on iccad2012
[Step=  50] | Loss=0.15263 | acc=0.9202 | tpr=0.9735 | fpr=0.0807 | 4433.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.15692 | acc=0.9190 | tpr=0.9744 | fpr=0.0820 | 9070.8 samples/s | 35.4 steps/s
[Step= 150] | Loss=0.16101 | acc=0.9170 | tpr=0.9798 | fpr=0.0842 | 9018.6 samples/s | 35.2 steps/s
[Step= 200] | Loss=0.16200 | acc=0.9172 | tpr=0.9825 | fpr=0.0840 | 9230.8 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.16159 | acc=0.9166 | tpr=0.9808 | fpr=0.0846 | 8786.4 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.16277 | acc=0.9160 | tpr=0.9804 | fpr=0.0852 | 9009.2 samples/s | 35.2 steps/s
[Step= 350] | Loss=0.16325 | acc=0.9156 | tpr=0.9806 | fpr=0.0856 | 8743.2 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.16368 | acc=0.9154 | tpr=0.9803 | fpr=0.0858 | 9274.2 samples/s | 36.2 steps/s
[Step= 450] | Loss=0.16550 | acc=0.9148 | tpr=0.9815 | fpr=0.0864 | 8432.2 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.16526 | acc=0.9147 | tpr=0.9815 | fpr=0.0865 | 9065.2 samples/s | 35.4 steps/s
[Step= 550] | Loss=0.16460 | acc=0.9152 | tpr=0.9817 | fpr=0.0860 | 15357.0 samples/s | 60.0 steps/s
Avg test loss: 0.16442, Avg test acc: 0.91521, Avg tpr: 0.98177, Avg fpr: 0.08600, total FA: 11941

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch= 7.0] | Loss=0.55678 | Reg=0.00238 | L2-Norm=15.436 | L2-Norm(final)=2.210 | acc=0.6562 | 3450.7 samples/s | 53.9 steps/s
[Step=7250 Epoch= 7.1] | Loss=0.10281 | Reg=0.00244 | L2-Norm=15.626 | L2-Norm(final)=2.183 | acc=0.9375 | 4891.5 samples/s | 76.4 steps/s
[Step=7300 Epoch= 7.1] | Loss=0.07593 | Reg=0.00247 | L2-Norm=15.719 | L2-Norm(final)=2.191 | acc=0.9844 | 4537.1 samples/s | 70.9 steps/s
[Step=7350 Epoch= 7.2] | Loss=0.06543 | Reg=0.00249 | L2-Norm=15.776 | L2-Norm(final)=2.196 | acc=0.9688 | 4534.7 samples/s | 70.9 steps/s
[Step=7400 Epoch= 7.2] | Loss=0.06031 | Reg=0.00250 | L2-Norm=15.819 | L2-Norm(final)=2.196 | acc=0.9688 | 4455.3 samples/s | 69.6 steps/s
[Step=7450 Epoch= 7.3] | Loss=0.05810 | Reg=0.00251 | L2-Norm=15.854 | L2-Norm(final)=2.197 | acc=0.9688 | 4566.7 samples/s | 71.4 steps/s
[Step=7500 Epoch= 7.3] | Loss=0.05478 | Reg=0.00252 | L2-Norm=15.886 | L2-Norm(final)=2.197 | acc=1.0000 | 4487.3 samples/s | 70.1 steps/s
[Step=7550 Epoch= 7.4] | Loss=0.05270 | Reg=0.00253 | L2-Norm=15.917 | L2-Norm(final)=2.198 | acc=0.9688 | 4547.5 samples/s | 71.1 steps/s
[Step=7600 Epoch= 7.4] | Loss=0.05104 | Reg=0.00254 | L2-Norm=15.947 | L2-Norm(final)=2.198 | acc=0.9844 | 4669.1 samples/s | 73.0 steps/s
[Step=7650 Epoch= 7.5] | Loss=0.04953 | Reg=0.00255 | L2-Norm=15.975 | L2-Norm(final)=2.199 | acc=1.0000 | 4535.3 samples/s | 70.9 steps/s
[Step=7700 Epoch= 7.5] | Loss=0.04831 | Reg=0.00256 | L2-Norm=16.001 | L2-Norm(final)=2.200 | acc=0.9844 | 4230.6 samples/s | 66.1 steps/s
[Step=7750 Epoch= 7.6] | Loss=0.04757 | Reg=0.00257 | L2-Norm=16.025 | L2-Norm(final)=2.199 | acc=0.9844 | 3658.1 samples/s | 57.2 steps/s
[Step=7800 Epoch= 7.6] | Loss=0.04709 | Reg=0.00258 | L2-Norm=16.046 | L2-Norm(final)=2.199 | acc=0.9531 | 4024.6 samples/s | 62.9 steps/s
[Step=7850 Epoch= 7.7] | Loss=0.04664 | Reg=0.00258 | L2-Norm=16.066 | L2-Norm(final)=2.198 | acc=0.9688 | 4038.5 samples/s | 63.1 steps/s
[Step=7900 Epoch= 7.7] | Loss=0.04573 | Reg=0.00259 | L2-Norm=16.086 | L2-Norm(final)=2.198 | acc=0.9375 | 3642.3 samples/s | 56.9 steps/s
[Step=7950 Epoch= 7.8] | Loss=0.04531 | Reg=0.00259 | L2-Norm=16.105 | L2-Norm(final)=2.198 | acc=0.9375 | 3837.1 samples/s | 60.0 steps/s
[Step=8000 Epoch= 7.8] | Loss=0.04473 | Reg=0.00260 | L2-Norm=16.124 | L2-Norm(final)=2.198 | acc=0.9688 | 4068.2 samples/s | 63.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=7201 Epoch=13.6] | Loss=0.01232 | Reg=0.00238 | L2-Norm=15.436 | L2-Norm(final)=2.213 | acc=0.9844 | 3520.6 samples/s | 55.0 steps/s
[Step=7250 Epoch=13.7] | Loss=0.00956 | Reg=0.00241 | L2-Norm=15.540 | L2-Norm(final)=2.221 | acc=1.0000 | 4331.8 samples/s | 67.7 steps/s
[Step=7300 Epoch=13.8] | Loss=0.00530 | Reg=0.00243 | L2-Norm=15.592 | L2-Norm(final)=2.230 | acc=1.0000 | 4483.8 samples/s | 70.1 steps/s
[Step=7350 Epoch=13.9] | Loss=0.00379 | Reg=0.00243 | L2-Norm=15.599 | L2-Norm(final)=2.237 | acc=1.0000 | 4309.1 samples/s | 67.3 steps/s
[Step=7400 Epoch=13.9] | Loss=0.00298 | Reg=0.00243 | L2-Norm=15.593 | L2-Norm(final)=2.243 | acc=1.0000 | 4467.3 samples/s | 69.8 steps/s
[Step=7450 Epoch=14.0] | Loss=0.00242 | Reg=0.00243 | L2-Norm=15.584 | L2-Norm(final)=2.248 | acc=1.0000 | 4355.0 samples/s | 68.0 steps/s
[Step=7500 Epoch=14.1] | Loss=0.00204 | Reg=0.00242 | L2-Norm=15.568 | L2-Norm(final)=2.253 | acc=1.0000 | 4360.6 samples/s | 68.1 steps/s
[Step=7550 Epoch=14.2] | Loss=0.00176 | Reg=0.00242 | L2-Norm=15.548 | L2-Norm(final)=2.256 | acc=1.0000 | 4264.2 samples/s | 66.6 steps/s
[Step=7600 Epoch=14.3] | Loss=0.00154 | Reg=0.00241 | L2-Norm=15.527 | L2-Norm(final)=2.260 | acc=1.0000 | 4466.6 samples/s | 69.8 steps/s
[Step=7650 Epoch=14.4] | Loss=0.00138 | Reg=0.00240 | L2-Norm=15.503 | L2-Norm(final)=2.262 | acc=1.0000 | 4279.9 samples/s | 66.9 steps/s
[Step=7700 Epoch=14.5] | Loss=0.00124 | Reg=0.00240 | L2-Norm=15.478 | L2-Norm(final)=2.265 | acc=1.0000 | 4405.8 samples/s | 68.8 steps/s
[Step=7750 Epoch=14.6] | Loss=0.00113 | Reg=0.00239 | L2-Norm=15.453 | L2-Norm(final)=2.267 | acc=1.0000 | 1491.7 samples/s | 23.3 steps/s
[Step=7800 Epoch=14.7] | Loss=0.00104 | Reg=0.00238 | L2-Norm=15.428 | L2-Norm(final)=2.269 | acc=1.0000 | 4362.5 samples/s | 68.2 steps/s
[Step=7850 Epoch=14.8] | Loss=0.00096 | Reg=0.00237 | L2-Norm=15.402 | L2-Norm(final)=2.271 | acc=1.0000 | 4306.2 samples/s | 67.3 steps/s
[Step=7900 Epoch=14.9] | Loss=0.00089 | Reg=0.00236 | L2-Norm=15.377 | L2-Norm(final)=2.273 | acc=1.0000 | 4461.9 samples/s | 69.7 steps/s
[Step=7950 Epoch=15.0] | Loss=0.00083 | Reg=0.00236 | L2-Norm=15.351 | L2-Norm(final)=2.274 | acc=1.0000 | 4348.6 samples/s | 67.9 steps/s
[Step=8000 Epoch=15.1] | Loss=0.00078 | Reg=0.00235 | L2-Norm=15.325 | L2-Norm(final)=2.275 | acc=1.0000 | 4370.8 samples/s | 68.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28950 | acc=0.7759 | tpr=0.6817 | fpr=0.0193 | 4517.7 samples/s | 17.6 steps/s
Avg test loss: 0.28992, Avg test acc: 0.77534, Avg tpr: 0.68299, Avg fpr: 0.02154, total FA: 168

Testing server on iccad2012
[Step=  50] | Loss=0.35312 | acc=0.7971 | tpr=0.9779 | fpr=0.2061 | 4437.8 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.35481 | acc=0.7984 | tpr=0.9765 | fpr=0.2049 | 9024.6 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.36054 | acc=0.7967 | tpr=0.9798 | fpr=0.2067 | 8811.7 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.36385 | acc=0.7959 | tpr=0.9825 | fpr=0.2075 | 9014.7 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.36330 | acc=0.7956 | tpr=0.9825 | fpr=0.2078 | 8829.4 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.36496 | acc=0.7950 | tpr=0.9833 | fpr=0.2084 | 8848.7 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.36529 | acc=0.7949 | tpr=0.9831 | fpr=0.2085 | 8731.8 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.36626 | acc=0.7951 | tpr=0.9836 | fpr=0.2083 | 8718.8 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.36859 | acc=0.7947 | tpr=0.9849 | fpr=0.2087 | 8818.5 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.36873 | acc=0.7946 | tpr=0.9846 | fpr=0.2088 | 8915.6 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.36774 | acc=0.7949 | tpr=0.9841 | fpr=0.2085 | 16259.1 samples/s | 63.5 steps/s
Avg test loss: 0.36757, Avg test acc: 0.79497, Avg tpr: 0.98415, Avg fpr: 0.20847, total FA: 28945

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch= 7.8] | Loss=0.18845 | Reg=0.00235 | L2-Norm=15.344 | L2-Norm(final)=2.229 | acc=0.8281 | 3654.7 samples/s | 57.1 steps/s
[Step=8050 Epoch= 7.9] | Loss=0.05674 | Reg=0.00237 | L2-Norm=15.393 | L2-Norm(final)=2.229 | acc=1.0000 | 4297.0 samples/s | 67.1 steps/s
[Step=8100 Epoch= 7.9] | Loss=0.04231 | Reg=0.00238 | L2-Norm=15.418 | L2-Norm(final)=2.239 | acc=1.0000 | 4648.8 samples/s | 72.6 steps/s
[Step=8150 Epoch= 8.0] | Loss=0.03768 | Reg=0.00238 | L2-Norm=15.433 | L2-Norm(final)=2.246 | acc=1.0000 | 4612.2 samples/s | 72.1 steps/s
[Step=8200 Epoch= 8.0] | Loss=0.03485 | Reg=0.00239 | L2-Norm=15.444 | L2-Norm(final)=2.251 | acc=0.9531 | 4598.5 samples/s | 71.9 steps/s
[Step=8250 Epoch= 8.1] | Loss=0.03356 | Reg=0.00239 | L2-Norm=15.454 | L2-Norm(final)=2.254 | acc=1.0000 | 4631.8 samples/s | 72.4 steps/s
[Step=8300 Epoch= 8.1] | Loss=0.03139 | Reg=0.00239 | L2-Norm=15.463 | L2-Norm(final)=2.259 | acc=0.9688 | 4654.6 samples/s | 72.7 steps/s
[Step=8350 Epoch= 8.2] | Loss=0.03109 | Reg=0.00239 | L2-Norm=15.470 | L2-Norm(final)=2.261 | acc=0.9844 | 4646.9 samples/s | 72.6 steps/s
[Step=8400 Epoch= 8.2] | Loss=0.03074 | Reg=0.00240 | L2-Norm=15.477 | L2-Norm(final)=2.264 | acc=1.0000 | 4560.1 samples/s | 71.3 steps/s
[Step=8450 Epoch= 8.3] | Loss=0.03042 | Reg=0.00240 | L2-Norm=15.484 | L2-Norm(final)=2.266 | acc=0.9844 | 4412.1 samples/s | 68.9 steps/s
[Step=8500 Epoch= 8.3] | Loss=0.03008 | Reg=0.00240 | L2-Norm=15.491 | L2-Norm(final)=2.267 | acc=0.9688 | 4662.4 samples/s | 72.8 steps/s
[Step=8550 Epoch= 8.3] | Loss=0.02959 | Reg=0.00240 | L2-Norm=15.497 | L2-Norm(final)=2.269 | acc=0.9531 | 4631.6 samples/s | 72.4 steps/s
[Step=8600 Epoch= 8.4] | Loss=0.02893 | Reg=0.00240 | L2-Norm=15.504 | L2-Norm(final)=2.271 | acc=0.9688 | 4634.4 samples/s | 72.4 steps/s
[Step=8650 Epoch= 8.4] | Loss=0.02871 | Reg=0.00241 | L2-Norm=15.510 | L2-Norm(final)=2.273 | acc=0.9844 | 4586.7 samples/s | 71.7 steps/s
[Step=8700 Epoch= 8.5] | Loss=0.02850 | Reg=0.00241 | L2-Norm=15.517 | L2-Norm(final)=2.274 | acc=0.9844 | 4606.9 samples/s | 72.0 steps/s
[Step=8750 Epoch= 8.5] | Loss=0.02802 | Reg=0.00241 | L2-Norm=15.524 | L2-Norm(final)=2.276 | acc=0.9688 | 4618.1 samples/s | 72.2 steps/s
[Step=8800 Epoch= 8.6] | Loss=0.02802 | Reg=0.00241 | L2-Norm=15.530 | L2-Norm(final)=2.278 | acc=0.9531 | 4761.4 samples/s | 74.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8001 Epoch=15.1] | Loss=0.08387 | Reg=0.00235 | L2-Norm=15.344 | L2-Norm(final)=2.229 | acc=0.9531 | 3406.8 samples/s | 53.2 steps/s
[Step=8050 Epoch=15.2] | Loss=0.00865 | Reg=0.00238 | L2-Norm=15.422 | L2-Norm(final)=2.233 | acc=1.0000 | 4177.4 samples/s | 65.3 steps/s
[Step=8100 Epoch=15.3] | Loss=0.00459 | Reg=0.00238 | L2-Norm=15.437 | L2-Norm(final)=2.244 | acc=1.0000 | 4309.4 samples/s | 67.3 steps/s
[Step=8150 Epoch=15.4] | Loss=0.00315 | Reg=0.00238 | L2-Norm=15.434 | L2-Norm(final)=2.251 | acc=1.0000 | 4360.4 samples/s | 68.1 steps/s
[Step=8200 Epoch=15.5] | Loss=0.00239 | Reg=0.00238 | L2-Norm=15.425 | L2-Norm(final)=2.257 | acc=1.0000 | 4332.4 samples/s | 67.7 steps/s
[Step=8250 Epoch=15.6] | Loss=0.00196 | Reg=0.00238 | L2-Norm=15.414 | L2-Norm(final)=2.261 | acc=1.0000 | 4428.7 samples/s | 69.2 steps/s
[Step=8300 Epoch=15.6] | Loss=0.00171 | Reg=0.00237 | L2-Norm=15.402 | L2-Norm(final)=2.264 | acc=1.0000 | 4409.8 samples/s | 68.9 steps/s
[Step=8350 Epoch=15.7] | Loss=0.00148 | Reg=0.00237 | L2-Norm=15.389 | L2-Norm(final)=2.267 | acc=1.0000 | 4327.6 samples/s | 67.6 steps/s
[Step=8400 Epoch=15.8] | Loss=0.00131 | Reg=0.00236 | L2-Norm=15.376 | L2-Norm(final)=2.270 | acc=1.0000 | 4473.5 samples/s | 69.9 steps/s
[Step=8450 Epoch=15.9] | Loss=0.00118 | Reg=0.00236 | L2-Norm=15.362 | L2-Norm(final)=2.273 | acc=1.0000 | 4361.0 samples/s | 68.1 steps/s
[Step=8500 Epoch=16.0] | Loss=0.00106 | Reg=0.00236 | L2-Norm=15.348 | L2-Norm(final)=2.275 | acc=1.0000 | 4443.5 samples/s | 69.4 steps/s
[Step=8550 Epoch=16.1] | Loss=0.00097 | Reg=0.00235 | L2-Norm=15.334 | L2-Norm(final)=2.277 | acc=1.0000 | 1536.7 samples/s | 24.0 steps/s
[Step=8600 Epoch=16.2] | Loss=0.00089 | Reg=0.00235 | L2-Norm=15.320 | L2-Norm(final)=2.279 | acc=1.0000 | 4416.7 samples/s | 69.0 steps/s
[Step=8650 Epoch=16.3] | Loss=0.00082 | Reg=0.00234 | L2-Norm=15.305 | L2-Norm(final)=2.280 | acc=1.0000 | 4594.3 samples/s | 71.8 steps/s
[Step=8700 Epoch=16.4] | Loss=0.00076 | Reg=0.00234 | L2-Norm=15.290 | L2-Norm(final)=2.282 | acc=1.0000 | 4352.0 samples/s | 68.0 steps/s
[Step=8750 Epoch=16.5] | Loss=0.00071 | Reg=0.00233 | L2-Norm=15.275 | L2-Norm(final)=2.283 | acc=1.0000 | 4478.6 samples/s | 70.0 steps/s
[Step=8800 Epoch=16.6] | Loss=0.00067 | Reg=0.00233 | L2-Norm=15.260 | L2-Norm(final)=2.285 | acc=1.0000 | 4506.0 samples/s | 70.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.55043 | acc=0.6519 | tpr=0.4941 | fpr=0.0055 | 4476.3 samples/s | 17.5 steps/s
Avg test loss: 0.54958, Avg test acc: 0.65334, Avg tpr: 0.49828, Avg fpr: 0.00564, total FA: 44

Testing server on iccad2012
[Step=  50] | Loss=0.23919 | acc=0.9030 | tpr=0.9513 | fpr=0.0979 | 4387.5 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.24400 | acc=0.9018 | tpr=0.9595 | fpr=0.0993 | 8746.3 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.24842 | acc=0.8998 | tpr=0.9640 | fpr=0.1013 | 8843.1 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.25200 | acc=0.8993 | tpr=0.9683 | fpr=0.1019 | 8864.2 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.25106 | acc=0.8987 | tpr=0.9677 | fpr=0.1026 | 9003.9 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.25321 | acc=0.8985 | tpr=0.9702 | fpr=0.1028 | 8979.4 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.25391 | acc=0.8982 | tpr=0.9718 | fpr=0.1032 | 9639.7 samples/s | 37.7 steps/s
[Step= 400] | Loss=0.25574 | acc=0.8981 | tpr=0.9726 | fpr=0.1033 | 8945.5 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.25796 | acc=0.8978 | tpr=0.9742 | fpr=0.1036 | 9256.7 samples/s | 36.2 steps/s
[Step= 500] | Loss=0.25762 | acc=0.8976 | tpr=0.9740 | fpr=0.1038 | 8507.8 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.25674 | acc=0.8978 | tpr=0.9721 | fpr=0.1035 | 16825.4 samples/s | 65.7 steps/s
Avg test loss: 0.25639, Avg test acc: 0.89787, Avg tpr: 0.97227, Avg fpr: 0.10348, total FA: 14368

server round 11/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch= 8.6] | Loss=0.34327 | Reg=0.00231 | L2-Norm=15.192 | L2-Norm(final)=2.297 | acc=0.7188 | 3619.9 samples/s | 56.6 steps/s
[Step=8850 Epoch= 8.6] | Loss=0.06046 | Reg=0.00233 | L2-Norm=15.281 | L2-Norm(final)=2.282 | acc=0.9844 | 4764.8 samples/s | 74.4 steps/s
[Step=8900 Epoch= 8.7] | Loss=0.04429 | Reg=0.00234 | L2-Norm=15.313 | L2-Norm(final)=2.288 | acc=1.0000 | 4663.8 samples/s | 72.9 steps/s
[Step=8950 Epoch= 8.7] | Loss=0.03752 | Reg=0.00235 | L2-Norm=15.330 | L2-Norm(final)=2.294 | acc=1.0000 | 4632.9 samples/s | 72.4 steps/s
[Step=9000 Epoch= 8.8] | Loss=0.03379 | Reg=0.00235 | L2-Norm=15.344 | L2-Norm(final)=2.301 | acc=1.0000 | 4641.5 samples/s | 72.5 steps/s
[Step=9050 Epoch= 8.8] | Loss=0.03148 | Reg=0.00236 | L2-Norm=15.354 | L2-Norm(final)=2.305 | acc=0.9688 | 4609.0 samples/s | 72.0 steps/s
[Step=9100 Epoch= 8.9] | Loss=0.03071 | Reg=0.00236 | L2-Norm=15.362 | L2-Norm(final)=2.309 | acc=1.0000 | 4714.0 samples/s | 73.7 steps/s
[Step=9150 Epoch= 8.9] | Loss=0.03008 | Reg=0.00236 | L2-Norm=15.370 | L2-Norm(final)=2.311 | acc=0.9844 | 4678.1 samples/s | 73.1 steps/s
[Step=9200 Epoch= 9.0] | Loss=0.02927 | Reg=0.00236 | L2-Norm=15.377 | L2-Norm(final)=2.313 | acc=1.0000 | 4700.6 samples/s | 73.4 steps/s
[Step=9250 Epoch= 9.0] | Loss=0.02856 | Reg=0.00237 | L2-Norm=15.384 | L2-Norm(final)=2.316 | acc=1.0000 | 4731.7 samples/s | 73.9 steps/s
[Step=9300 Epoch= 9.1] | Loss=0.02783 | Reg=0.00237 | L2-Norm=15.391 | L2-Norm(final)=2.318 | acc=1.0000 | 4696.9 samples/s | 73.4 steps/s
[Step=9350 Epoch= 9.1] | Loss=0.02763 | Reg=0.00237 | L2-Norm=15.397 | L2-Norm(final)=2.320 | acc=0.9844 | 4448.1 samples/s | 69.5 steps/s
[Step=9400 Epoch= 9.2] | Loss=0.02699 | Reg=0.00237 | L2-Norm=15.403 | L2-Norm(final)=2.322 | acc=0.9844 | 4780.1 samples/s | 74.7 steps/s
[Step=9450 Epoch= 9.2] | Loss=0.02650 | Reg=0.00237 | L2-Norm=15.410 | L2-Norm(final)=2.324 | acc=1.0000 | 4827.3 samples/s | 75.4 steps/s
[Step=9500 Epoch= 9.3] | Loss=0.02652 | Reg=0.00238 | L2-Norm=15.415 | L2-Norm(final)=2.326 | acc=1.0000 | 4652.2 samples/s | 72.7 steps/s
[Step=9550 Epoch= 9.3] | Loss=0.02609 | Reg=0.00238 | L2-Norm=15.421 | L2-Norm(final)=2.327 | acc=0.9844 | 4593.1 samples/s | 71.8 steps/s
[Step=9600 Epoch= 9.4] | Loss=0.02626 | Reg=0.00238 | L2-Norm=15.426 | L2-Norm(final)=2.329 | acc=0.9844 | 4591.4 samples/s | 71.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step9600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=8801 Epoch=16.6] | Loss=0.04490 | Reg=0.00231 | L2-Norm=15.192 | L2-Norm(final)=2.298 | acc=0.9688 | 3510.7 samples/s | 54.9 steps/s
[Step=8850 Epoch=16.7] | Loss=0.00815 | Reg=0.00233 | L2-Norm=15.274 | L2-Norm(final)=2.293 | acc=1.0000 | 4385.8 samples/s | 68.5 steps/s
[Step=8900 Epoch=16.8] | Loss=0.00502 | Reg=0.00234 | L2-Norm=15.302 | L2-Norm(final)=2.294 | acc=1.0000 | 4436.8 samples/s | 69.3 steps/s
[Step=8950 Epoch=16.9] | Loss=0.00346 | Reg=0.00234 | L2-Norm=15.309 | L2-Norm(final)=2.297 | acc=1.0000 | 4245.1 samples/s | 66.3 steps/s
[Step=9000 Epoch=17.0] | Loss=0.00262 | Reg=0.00234 | L2-Norm=15.305 | L2-Norm(final)=2.299 | acc=1.0000 | 4345.7 samples/s | 67.9 steps/s
[Step=9050 Epoch=17.1] | Loss=0.00210 | Reg=0.00234 | L2-Norm=15.296 | L2-Norm(final)=2.302 | acc=1.0000 | 4334.4 samples/s | 67.7 steps/s
[Step=9100 Epoch=17.2] | Loss=0.00176 | Reg=0.00234 | L2-Norm=15.285 | L2-Norm(final)=2.304 | acc=1.0000 | 4343.0 samples/s | 67.9 steps/s
[Step=9150 Epoch=17.2] | Loss=0.00154 | Reg=0.00233 | L2-Norm=15.273 | L2-Norm(final)=2.306 | acc=1.0000 | 4334.7 samples/s | 67.7 steps/s
[Step=9200 Epoch=17.3] | Loss=0.00137 | Reg=0.00233 | L2-Norm=15.261 | L2-Norm(final)=2.308 | acc=1.0000 | 4461.3 samples/s | 69.7 steps/s
[Step=9250 Epoch=17.4] | Loss=0.00124 | Reg=0.00232 | L2-Norm=15.247 | L2-Norm(final)=2.310 | acc=1.0000 | 4217.4 samples/s | 65.9 steps/s
[Step=9300 Epoch=17.5] | Loss=0.00112 | Reg=0.00232 | L2-Norm=15.234 | L2-Norm(final)=2.312 | acc=1.0000 | 4336.9 samples/s | 67.8 steps/s
[Step=9350 Epoch=17.6] | Loss=0.00102 | Reg=0.00232 | L2-Norm=15.221 | L2-Norm(final)=2.314 | acc=1.0000 | 1541.7 samples/s | 24.1 steps/s
[Step=9400 Epoch=17.7] | Loss=0.00094 | Reg=0.00231 | L2-Norm=15.207 | L2-Norm(final)=2.315 | acc=1.0000 | 4570.1 samples/s | 71.4 steps/s
[Step=9450 Epoch=17.8] | Loss=0.00087 | Reg=0.00231 | L2-Norm=15.193 | L2-Norm(final)=2.317 | acc=1.0000 | 4259.4 samples/s | 66.6 steps/s
[Step=9500 Epoch=17.9] | Loss=0.00081 | Reg=0.00230 | L2-Norm=15.178 | L2-Norm(final)=2.318 | acc=1.0000 | 4306.6 samples/s | 67.3 steps/s
[Step=9550 Epoch=18.0] | Loss=0.00075 | Reg=0.00230 | L2-Norm=15.163 | L2-Norm(final)=2.320 | acc=1.0000 | 4402.0 samples/s | 68.8 steps/s
[Step=9600 Epoch=18.1] | Loss=0.00071 | Reg=0.00229 | L2-Norm=15.149 | L2-Norm(final)=2.321 | acc=1.0000 | 4325.3 samples/s | 67.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37043 | acc=0.7353 | tpr=0.6176 | fpr=0.0092 | 4364.1 samples/s | 17.0 steps/s
Avg test loss: 0.36860, Avg test acc: 0.73652, Avg tpr: 0.62161, Avg fpr: 0.01077, total FA: 84

Testing server on iccad2012
[Step=  50] | Loss=0.27946 | acc=0.8772 | tpr=0.9735 | fpr=0.1245 | 4434.8 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.28317 | acc=0.8770 | tpr=0.9765 | fpr=0.1249 | 9209.9 samples/s | 36.0 steps/s
[Step= 150] | Loss=0.28799 | acc=0.8745 | tpr=0.9827 | fpr=0.1275 | 8522.9 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.29102 | acc=0.8750 | tpr=0.9836 | fpr=0.1270 | 9076.2 samples/s | 35.5 steps/s
[Step= 250] | Loss=0.28990 | acc=0.8750 | tpr=0.9834 | fpr=0.1270 | 8934.3 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.29196 | acc=0.8752 | tpr=0.9833 | fpr=0.1267 | 8794.1 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.29275 | acc=0.8748 | tpr=0.9831 | fpr=0.1271 | 8970.0 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.29447 | acc=0.8747 | tpr=0.9836 | fpr=0.1273 | 8493.4 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.29729 | acc=0.8743 | tpr=0.9849 | fpr=0.1277 | 8464.4 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.29677 | acc=0.8741 | tpr=0.9841 | fpr=0.1278 | 9088.2 samples/s | 35.5 steps/s
[Step= 550] | Loss=0.29566 | acc=0.8742 | tpr=0.9841 | fpr=0.1278 | 15817.2 samples/s | 61.8 steps/s
Avg test loss: 0.29537, Avg test acc: 0.87425, Avg tpr: 0.98415, Avg fpr: 0.12775, total FA: 17738

server round 12/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch= 9.4] | Loss=0.18523 | Reg=0.00227 | L2-Norm=15.072 | L2-Norm(final)=2.335 | acc=0.8438 | 3822.9 samples/s | 59.7 steps/s
[Step=9650 Epoch= 9.4] | Loss=0.05132 | Reg=0.00229 | L2-Norm=15.147 | L2-Norm(final)=2.332 | acc=0.9688 | 4478.1 samples/s | 70.0 steps/s
[Step=9700 Epoch= 9.5] | Loss=0.03656 | Reg=0.00230 | L2-Norm=15.180 | L2-Norm(final)=2.341 | acc=0.9844 | 4528.3 samples/s | 70.8 steps/s
[Step=9750 Epoch= 9.5] | Loss=0.03164 | Reg=0.00231 | L2-Norm=15.200 | L2-Norm(final)=2.350 | acc=0.9844 | 4622.0 samples/s | 72.2 steps/s
[Step=9800 Epoch= 9.6] | Loss=0.03019 | Reg=0.00232 | L2-Norm=15.216 | L2-Norm(final)=2.355 | acc=0.9844 | 4816.6 samples/s | 75.3 steps/s
[Step=9850 Epoch= 9.6] | Loss=0.02884 | Reg=0.00232 | L2-Norm=15.229 | L2-Norm(final)=2.358 | acc=0.9844 | 4811.4 samples/s | 75.2 steps/s
[Step=9900 Epoch= 9.7] | Loss=0.02713 | Reg=0.00232 | L2-Norm=15.239 | L2-Norm(final)=2.363 | acc=1.0000 | 4665.5 samples/s | 72.9 steps/s
[Step=9950 Epoch= 9.7] | Loss=0.02645 | Reg=0.00233 | L2-Norm=15.248 | L2-Norm(final)=2.365 | acc=0.9688 | 4615.3 samples/s | 72.1 steps/s
[Step=10000 Epoch= 9.8] | Loss=0.02616 | Reg=0.00233 | L2-Norm=15.257 | L2-Norm(final)=2.368 | acc=0.9688 | 4640.5 samples/s | 72.5 steps/s
[Step=10050 Epoch= 9.8] | Loss=0.02610 | Reg=0.00233 | L2-Norm=15.265 | L2-Norm(final)=2.371 | acc=0.9531 | 4788.8 samples/s | 74.8 steps/s
[Step=10100 Epoch= 9.9] | Loss=0.02563 | Reg=0.00233 | L2-Norm=15.273 | L2-Norm(final)=2.372 | acc=1.0000 | 4579.8 samples/s | 71.6 steps/s
[Step=10150 Epoch= 9.9] | Loss=0.02519 | Reg=0.00233 | L2-Norm=15.280 | L2-Norm(final)=2.375 | acc=0.9688 | 4673.2 samples/s | 73.0 steps/s
[Step=10200 Epoch=10.0] | Loss=0.02495 | Reg=0.00234 | L2-Norm=15.288 | L2-Norm(final)=2.377 | acc=0.9688 | 4656.9 samples/s | 72.8 steps/s
[Step=10250 Epoch=10.0] | Loss=0.02481 | Reg=0.00234 | L2-Norm=15.295 | L2-Norm(final)=2.380 | acc=1.0000 | 4705.3 samples/s | 73.5 steps/s
[Step=10300 Epoch=10.1] | Loss=0.02460 | Reg=0.00234 | L2-Norm=15.303 | L2-Norm(final)=2.382 | acc=1.0000 | 4905.5 samples/s | 76.6 steps/s
[Step=10350 Epoch=10.1] | Loss=0.02461 | Reg=0.00234 | L2-Norm=15.309 | L2-Norm(final)=2.383 | acc=0.9844 | 4653.8 samples/s | 72.7 steps/s
[Step=10400 Epoch=10.2] | Loss=0.02439 | Reg=0.00235 | L2-Norm=15.316 | L2-Norm(final)=2.385 | acc=0.9844 | 4720.2 samples/s | 73.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step10400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=9601 Epoch=18.1] | Loss=0.03156 | Reg=0.00227 | L2-Norm=15.072 | L2-Norm(final)=2.336 | acc=0.9688 | 3614.3 samples/s | 56.5 steps/s
[Step=9650 Epoch=18.2] | Loss=0.00614 | Reg=0.00229 | L2-Norm=15.139 | L2-Norm(final)=2.337 | acc=1.0000 | 4476.0 samples/s | 69.9 steps/s
[Step=9700 Epoch=18.3] | Loss=0.00377 | Reg=0.00230 | L2-Norm=15.162 | L2-Norm(final)=2.335 | acc=1.0000 | 4470.3 samples/s | 69.8 steps/s
[Step=9750 Epoch=18.4] | Loss=0.00261 | Reg=0.00230 | L2-Norm=15.164 | L2-Norm(final)=2.337 | acc=1.0000 | 4479.8 samples/s | 70.0 steps/s
[Step=9800 Epoch=18.5] | Loss=0.00197 | Reg=0.00230 | L2-Norm=15.158 | L2-Norm(final)=2.341 | acc=1.0000 | 4575.1 samples/s | 71.5 steps/s
[Step=9850 Epoch=18.6] | Loss=0.00160 | Reg=0.00229 | L2-Norm=15.149 | L2-Norm(final)=2.344 | acc=1.0000 | 4406.8 samples/s | 68.9 steps/s
[Step=9900 Epoch=18.7] | Loss=0.00134 | Reg=0.00229 | L2-Norm=15.138 | L2-Norm(final)=2.346 | acc=1.0000 | 4486.7 samples/s | 70.1 steps/s
[Step=9950 Epoch=18.8] | Loss=0.00116 | Reg=0.00229 | L2-Norm=15.125 | L2-Norm(final)=2.349 | acc=1.0000 | 4358.9 samples/s | 68.1 steps/s
[Step=10000 Epoch=18.9] | Loss=0.00102 | Reg=0.00228 | L2-Norm=15.112 | L2-Norm(final)=2.351 | acc=1.0000 | 4301.6 samples/s | 67.2 steps/s
[Step=10050 Epoch=18.9] | Loss=0.00102 | Reg=0.00228 | L2-Norm=15.098 | L2-Norm(final)=2.353 | acc=0.9844 | 4394.1 samples/s | 68.7 steps/s
[Step=10100 Epoch=19.0] | Loss=0.00107 | Reg=0.00228 | L2-Norm=15.088 | L2-Norm(final)=2.354 | acc=1.0000 | 4677.3 samples/s | 73.1 steps/s
[Step=10150 Epoch=19.1] | Loss=0.00128 | Reg=0.00227 | L2-Norm=15.081 | L2-Norm(final)=2.355 | acc=1.0000 | 1507.8 samples/s | 23.6 steps/s
[Step=10200 Epoch=19.2] | Loss=0.00135 | Reg=0.00227 | L2-Norm=15.080 | L2-Norm(final)=2.355 | acc=1.0000 | 4514.4 samples/s | 70.5 steps/s
[Step=10250 Epoch=19.3] | Loss=0.00126 | Reg=0.00227 | L2-Norm=15.079 | L2-Norm(final)=2.355 | acc=1.0000 | 4276.0 samples/s | 66.8 steps/s
[Step=10300 Epoch=19.4] | Loss=0.00118 | Reg=0.00227 | L2-Norm=15.076 | L2-Norm(final)=2.355 | acc=1.0000 | 4476.6 samples/s | 69.9 steps/s
[Step=10350 Epoch=19.5] | Loss=0.00110 | Reg=0.00227 | L2-Norm=15.071 | L2-Norm(final)=2.356 | acc=1.0000 | 4573.9 samples/s | 71.5 steps/s
[Step=10400 Epoch=19.6] | Loss=0.00104 | Reg=0.00227 | L2-Norm=15.066 | L2-Norm(final)=2.357 | acc=1.0000 | 4446.8 samples/s | 69.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.50683 | acc=0.6780 | tpr=0.5334 | fpr=0.0079 | 4366.0 samples/s | 17.1 steps/s
Avg test loss: 0.50697, Avg test acc: 0.67441, Avg tpr: 0.53069, Avg fpr: 0.00949, total FA: 74

Testing server on iccad2012
[Step=  50] | Loss=0.29391 | acc=0.8824 | tpr=0.9602 | fpr=0.1190 | 4446.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.29953 | acc=0.8803 | tpr=0.9701 | fpr=0.1214 | 8603.3 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.30548 | acc=0.8791 | tpr=0.9769 | fpr=0.1227 | 9017.9 samples/s | 35.2 steps/s
[Step= 200] | Loss=0.30880 | acc=0.8785 | tpr=0.9792 | fpr=0.1234 | 8879.0 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.30829 | acc=0.8782 | tpr=0.9790 | fpr=0.1237 | 8980.7 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.30928 | acc=0.8784 | tpr=0.9796 | fpr=0.1235 | 8611.9 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.31037 | acc=0.8780 | tpr=0.9800 | fpr=0.1239 | 8934.9 samples/s | 34.9 steps/s
[Step= 400] | Loss=0.31204 | acc=0.8779 | tpr=0.9792 | fpr=0.1240 | 8977.7 samples/s | 35.1 steps/s
[Step= 450] | Loss=0.31550 | acc=0.8774 | tpr=0.9800 | fpr=0.1244 | 8660.6 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.31530 | acc=0.8772 | tpr=0.9797 | fpr=0.1247 | 8591.2 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.31424 | acc=0.8773 | tpr=0.9793 | fpr=0.1246 | 17049.8 samples/s | 66.6 steps/s
Avg test loss: 0.31402, Avg test acc: 0.87733, Avg tpr: 0.97940, Avg fpr: 0.12452, total FA: 17290

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=10.2] | Loss=0.40236 | Reg=0.00226 | L2-Norm=15.040 | L2-Norm(final)=2.386 | acc=0.7344 | 3440.1 samples/s | 53.8 steps/s
[Step=10450 Epoch=10.2] | Loss=0.05827 | Reg=0.00229 | L2-Norm=15.130 | L2-Norm(final)=2.372 | acc=0.9844 | 4593.6 samples/s | 71.8 steps/s
[Step=10500 Epoch=10.3] | Loss=0.04115 | Reg=0.00230 | L2-Norm=15.163 | L2-Norm(final)=2.378 | acc=0.9688 | 4645.4 samples/s | 72.6 steps/s
[Step=10550 Epoch=10.3] | Loss=0.03666 | Reg=0.00230 | L2-Norm=15.182 | L2-Norm(final)=2.384 | acc=0.9688 | 4521.7 samples/s | 70.7 steps/s
[Step=10600 Epoch=10.3] | Loss=0.03186 | Reg=0.00231 | L2-Norm=15.195 | L2-Norm(final)=2.389 | acc=1.0000 | 4485.4 samples/s | 70.1 steps/s
[Step=10650 Epoch=10.4] | Loss=0.03041 | Reg=0.00231 | L2-Norm=15.206 | L2-Norm(final)=2.393 | acc=0.9844 | 4477.2 samples/s | 70.0 steps/s
[Step=10700 Epoch=10.4] | Loss=0.02869 | Reg=0.00231 | L2-Norm=15.215 | L2-Norm(final)=2.396 | acc=0.9844 | 4609.8 samples/s | 72.0 steps/s
[Step=10750 Epoch=10.5] | Loss=0.02731 | Reg=0.00232 | L2-Norm=15.223 | L2-Norm(final)=2.400 | acc=1.0000 | 4547.8 samples/s | 71.1 steps/s
[Step=10800 Epoch=10.5] | Loss=0.02667 | Reg=0.00232 | L2-Norm=15.231 | L2-Norm(final)=2.403 | acc=1.0000 | 4552.4 samples/s | 71.1 steps/s
[Step=10850 Epoch=10.6] | Loss=0.02598 | Reg=0.00232 | L2-Norm=15.240 | L2-Norm(final)=2.406 | acc=1.0000 | 4464.8 samples/s | 69.8 steps/s
[Step=10900 Epoch=10.6] | Loss=0.02547 | Reg=0.00233 | L2-Norm=15.248 | L2-Norm(final)=2.409 | acc=0.9844 | 4642.5 samples/s | 72.5 steps/s
[Step=10950 Epoch=10.7] | Loss=0.02502 | Reg=0.00233 | L2-Norm=15.256 | L2-Norm(final)=2.411 | acc=0.9688 | 4614.6 samples/s | 72.1 steps/s
[Step=11000 Epoch=10.7] | Loss=0.02486 | Reg=0.00233 | L2-Norm=15.263 | L2-Norm(final)=2.412 | acc=0.9844 | 4612.1 samples/s | 72.1 steps/s
[Step=11050 Epoch=10.8] | Loss=0.02508 | Reg=0.00233 | L2-Norm=15.271 | L2-Norm(final)=2.414 | acc=0.9844 | 4527.5 samples/s | 70.7 steps/s
[Step=11100 Epoch=10.8] | Loss=0.02510 | Reg=0.00233 | L2-Norm=15.278 | L2-Norm(final)=2.415 | acc=0.9688 | 4755.1 samples/s | 74.3 steps/s
[Step=11150 Epoch=10.9] | Loss=0.02480 | Reg=0.00234 | L2-Norm=15.286 | L2-Norm(final)=2.417 | acc=1.0000 | 4489.8 samples/s | 70.2 steps/s
[Step=11200 Epoch=10.9] | Loss=0.02486 | Reg=0.00234 | L2-Norm=15.293 | L2-Norm(final)=2.418 | acc=1.0000 | 4570.6 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step11200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=10401 Epoch=19.6] | Loss=0.05260 | Reg=0.00226 | L2-Norm=15.040 | L2-Norm(final)=2.386 | acc=0.9375 | 3409.7 samples/s | 53.3 steps/s
[Step=10450 Epoch=19.7] | Loss=0.00352 | Reg=0.00228 | L2-Norm=15.113 | L2-Norm(final)=2.391 | acc=1.0000 | 4153.9 samples/s | 64.9 steps/s
[Step=10500 Epoch=19.8] | Loss=0.00251 | Reg=0.00229 | L2-Norm=15.130 | L2-Norm(final)=2.393 | acc=0.9844 | 4384.9 samples/s | 68.5 steps/s
[Step=10550 Epoch=19.9] | Loss=0.00196 | Reg=0.00229 | L2-Norm=15.136 | L2-Norm(final)=2.395 | acc=1.0000 | 4344.9 samples/s | 67.9 steps/s
[Step=10600 Epoch=20.0] | Loss=0.00158 | Reg=0.00229 | L2-Norm=15.137 | L2-Norm(final)=2.396 | acc=1.0000 | 4280.5 samples/s | 66.9 steps/s
[Step=10650 Epoch=20.1] | Loss=0.00151 | Reg=0.00229 | L2-Norm=15.135 | L2-Norm(final)=2.398 | acc=1.0000 | 4314.4 samples/s | 67.4 steps/s
[Step=10700 Epoch=20.2] | Loss=0.00130 | Reg=0.00229 | L2-Norm=15.132 | L2-Norm(final)=2.399 | acc=1.0000 | 4401.9 samples/s | 68.8 steps/s
[Step=10750 Epoch=20.3] | Loss=0.00113 | Reg=0.00229 | L2-Norm=15.127 | L2-Norm(final)=2.401 | acc=1.0000 | 4382.0 samples/s | 68.5 steps/s
[Step=10800 Epoch=20.4] | Loss=0.00099 | Reg=0.00229 | L2-Norm=15.119 | L2-Norm(final)=2.403 | acc=1.0000 | 4320.4 samples/s | 67.5 steps/s
[Step=10850 Epoch=20.5] | Loss=0.00088 | Reg=0.00228 | L2-Norm=15.111 | L2-Norm(final)=2.404 | acc=1.0000 | 4331.1 samples/s | 67.7 steps/s
[Step=10900 Epoch=20.5] | Loss=0.00080 | Reg=0.00228 | L2-Norm=15.101 | L2-Norm(final)=2.405 | acc=1.0000 | 4470.5 samples/s | 69.9 steps/s
[Step=10950 Epoch=20.6] | Loss=0.00073 | Reg=0.00228 | L2-Norm=15.090 | L2-Norm(final)=2.407 | acc=1.0000 | 1433.7 samples/s | 22.4 steps/s
[Step=11000 Epoch=20.7] | Loss=0.00067 | Reg=0.00227 | L2-Norm=15.079 | L2-Norm(final)=2.408 | acc=1.0000 | 4455.7 samples/s | 69.6 steps/s
[Step=11050 Epoch=20.8] | Loss=0.00062 | Reg=0.00227 | L2-Norm=15.068 | L2-Norm(final)=2.409 | acc=1.0000 | 4279.6 samples/s | 66.9 steps/s
[Step=11100 Epoch=20.9] | Loss=0.00057 | Reg=0.00227 | L2-Norm=15.056 | L2-Norm(final)=2.410 | acc=1.0000 | 4307.3 samples/s | 67.3 steps/s
[Step=11150 Epoch=21.0] | Loss=0.00054 | Reg=0.00226 | L2-Norm=15.044 | L2-Norm(final)=2.411 | acc=1.0000 | 4378.0 samples/s | 68.4 steps/s
[Step=11200 Epoch=21.1] | Loss=0.00050 | Reg=0.00226 | L2-Norm=15.032 | L2-Norm(final)=2.412 | acc=1.0000 | 4427.2 samples/s | 69.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45787 | acc=0.7024 | tpr=0.5678 | fpr=0.0052 | 4343.1 samples/s | 17.0 steps/s
Avg test loss: 0.45777, Avg test acc: 0.69881, Avg tpr: 0.56473, Avg fpr: 0.00628, total FA: 49

Testing server on iccad2012
[Step=  50] | Loss=0.26846 | acc=0.8983 | tpr=0.9690 | fpr=0.1030 | 4380.0 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.27265 | acc=0.8951 | tpr=0.9659 | fpr=0.1062 | 9060.6 samples/s | 35.4 steps/s
[Step= 150] | Loss=0.27919 | acc=0.8929 | tpr=0.9741 | fpr=0.1086 | 8695.0 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.28165 | acc=0.8934 | tpr=0.9760 | fpr=0.1081 | 9150.6 samples/s | 35.7 steps/s
[Step= 250] | Loss=0.28080 | acc=0.8925 | tpr=0.9747 | fpr=0.1090 | 8682.4 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.28229 | acc=0.8923 | tpr=0.9760 | fpr=0.1092 | 9294.8 samples/s | 36.3 steps/s
[Step= 350] | Loss=0.28286 | acc=0.8924 | tpr=0.9768 | fpr=0.1091 | 8323.9 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.28474 | acc=0.8918 | tpr=0.9759 | fpr=0.1097 | 9114.5 samples/s | 35.6 steps/s
[Step= 450] | Loss=0.28737 | acc=0.8919 | tpr=0.9766 | fpr=0.1097 | 8308.0 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.28655 | acc=0.8919 | tpr=0.9771 | fpr=0.1096 | 9154.8 samples/s | 35.8 steps/s
[Step= 550] | Loss=0.28553 | acc=0.8923 | tpr=0.9777 | fpr=0.1092 | 15808.6 samples/s | 61.8 steps/s
Avg test loss: 0.28507, Avg test acc: 0.89241, Avg tpr: 0.97781, Avg fpr: 0.10914, total FA: 15154

server round 14/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=10.9] | Loss=0.36087 | Reg=0.00224 | L2-Norm=14.974 | L2-Norm(final)=2.423 | acc=0.7344 | 3750.9 samples/s | 58.6 steps/s
[Step=11250 Epoch=11.0] | Loss=0.05799 | Reg=0.00226 | L2-Norm=15.040 | L2-Norm(final)=2.408 | acc=1.0000 | 4248.8 samples/s | 66.4 steps/s
[Step=11300 Epoch=11.0] | Loss=0.03947 | Reg=0.00227 | L2-Norm=15.071 | L2-Norm(final)=2.418 | acc=1.0000 | 4571.8 samples/s | 71.4 steps/s
[Step=11350 Epoch=11.1] | Loss=0.03308 | Reg=0.00228 | L2-Norm=15.089 | L2-Norm(final)=2.424 | acc=1.0000 | 4564.3 samples/s | 71.3 steps/s
[Step=11400 Epoch=11.1] | Loss=0.02971 | Reg=0.00228 | L2-Norm=15.101 | L2-Norm(final)=2.429 | acc=0.9844 | 4513.8 samples/s | 70.5 steps/s
[Step=11450 Epoch=11.2] | Loss=0.02854 | Reg=0.00228 | L2-Norm=15.113 | L2-Norm(final)=2.433 | acc=0.9531 | 4672.2 samples/s | 73.0 steps/s
[Step=11500 Epoch=11.2] | Loss=0.02685 | Reg=0.00229 | L2-Norm=15.124 | L2-Norm(final)=2.436 | acc=1.0000 | 4530.7 samples/s | 70.8 steps/s
[Step=11550 Epoch=11.3] | Loss=0.02647 | Reg=0.00229 | L2-Norm=15.133 | L2-Norm(final)=2.438 | acc=1.0000 | 4633.9 samples/s | 72.4 steps/s
[Step=11600 Epoch=11.3] | Loss=0.02604 | Reg=0.00229 | L2-Norm=15.142 | L2-Norm(final)=2.440 | acc=0.9844 | 4665.8 samples/s | 72.9 steps/s
[Step=11650 Epoch=11.4] | Loss=0.02519 | Reg=0.00230 | L2-Norm=15.149 | L2-Norm(final)=2.443 | acc=0.9688 | 4725.7 samples/s | 73.8 steps/s
[Step=11700 Epoch=11.4] | Loss=0.02444 | Reg=0.00230 | L2-Norm=15.157 | L2-Norm(final)=2.446 | acc=0.9844 | 4564.4 samples/s | 71.3 steps/s
[Step=11750 Epoch=11.5] | Loss=0.02403 | Reg=0.00230 | L2-Norm=15.164 | L2-Norm(final)=2.448 | acc=1.0000 | 4615.8 samples/s | 72.1 steps/s
[Step=11800 Epoch=11.5] | Loss=0.02430 | Reg=0.00230 | L2-Norm=15.171 | L2-Norm(final)=2.450 | acc=0.9531 | 4723.4 samples/s | 73.8 steps/s
[Step=11850 Epoch=11.6] | Loss=0.02417 | Reg=0.00230 | L2-Norm=15.177 | L2-Norm(final)=2.451 | acc=1.0000 | 4593.4 samples/s | 71.8 steps/s
[Step=11900 Epoch=11.6] | Loss=0.02365 | Reg=0.00231 | L2-Norm=15.184 | L2-Norm(final)=2.453 | acc=1.0000 | 4725.4 samples/s | 73.8 steps/s
[Step=11950 Epoch=11.7] | Loss=0.02344 | Reg=0.00231 | L2-Norm=15.191 | L2-Norm(final)=2.454 | acc=0.9844 | 4734.8 samples/s | 74.0 steps/s
[Step=12000 Epoch=11.7] | Loss=0.02318 | Reg=0.00231 | L2-Norm=15.198 | L2-Norm(final)=2.456 | acc=0.9844 | 4396.8 samples/s | 68.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=11201 Epoch=21.1] | Loss=0.01113 | Reg=0.00224 | L2-Norm=14.974 | L2-Norm(final)=2.424 | acc=1.0000 | 3570.2 samples/s | 55.8 steps/s
[Step=11250 Epoch=21.2] | Loss=0.00370 | Reg=0.00226 | L2-Norm=15.040 | L2-Norm(final)=2.434 | acc=1.0000 | 4398.2 samples/s | 68.7 steps/s
[Step=11300 Epoch=21.3] | Loss=0.00289 | Reg=0.00227 | L2-Norm=15.062 | L2-Norm(final)=2.435 | acc=1.0000 | 4552.9 samples/s | 71.1 steps/s
[Step=11350 Epoch=21.4] | Loss=0.00213 | Reg=0.00227 | L2-Norm=15.068 | L2-Norm(final)=2.436 | acc=1.0000 | 4401.1 samples/s | 68.8 steps/s
[Step=11400 Epoch=21.5] | Loss=0.00165 | Reg=0.00227 | L2-Norm=15.068 | L2-Norm(final)=2.437 | acc=1.0000 | 4262.1 samples/s | 66.6 steps/s
[Step=11450 Epoch=21.6] | Loss=0.00142 | Reg=0.00227 | L2-Norm=15.065 | L2-Norm(final)=2.439 | acc=1.0000 | 4509.8 samples/s | 70.5 steps/s
[Step=11500 Epoch=21.7] | Loss=0.00119 | Reg=0.00227 | L2-Norm=15.058 | L2-Norm(final)=2.441 | acc=1.0000 | 4459.2 samples/s | 69.7 steps/s
[Step=11550 Epoch=21.8] | Loss=0.00111 | Reg=0.00227 | L2-Norm=15.050 | L2-Norm(final)=2.443 | acc=1.0000 | 4408.3 samples/s | 68.9 steps/s
[Step=11600 Epoch=21.9] | Loss=0.00111 | Reg=0.00226 | L2-Norm=15.043 | L2-Norm(final)=2.444 | acc=1.0000 | 4381.3 samples/s | 68.5 steps/s
[Step=11650 Epoch=22.0] | Loss=0.00099 | Reg=0.00226 | L2-Norm=15.035 | L2-Norm(final)=2.445 | acc=1.0000 | 4528.4 samples/s | 70.8 steps/s
[Step=11700 Epoch=22.1] | Loss=0.00090 | Reg=0.00226 | L2-Norm=15.027 | L2-Norm(final)=2.446 | acc=1.0000 | 4291.1 samples/s | 67.0 steps/s
[Step=11750 Epoch=22.1] | Loss=0.00082 | Reg=0.00226 | L2-Norm=15.018 | L2-Norm(final)=2.447 | acc=1.0000 | 1420.7 samples/s | 22.2 steps/s
[Step=11800 Epoch=22.2] | Loss=0.00075 | Reg=0.00225 | L2-Norm=15.008 | L2-Norm(final)=2.448 | acc=1.0000 | 4591.7 samples/s | 71.7 steps/s
[Step=11850 Epoch=22.3] | Loss=0.00070 | Reg=0.00225 | L2-Norm=14.997 | L2-Norm(final)=2.449 | acc=1.0000 | 4387.9 samples/s | 68.6 steps/s
[Step=11900 Epoch=22.4] | Loss=0.00065 | Reg=0.00225 | L2-Norm=14.986 | L2-Norm(final)=2.450 | acc=1.0000 | 4352.4 samples/s | 68.0 steps/s
[Step=11950 Epoch=22.5] | Loss=0.00060 | Reg=0.00224 | L2-Norm=14.974 | L2-Norm(final)=2.451 | acc=1.0000 | 4233.9 samples/s | 66.2 steps/s
[Step=12000 Epoch=22.6] | Loss=0.00057 | Reg=0.00224 | L2-Norm=14.963 | L2-Norm(final)=2.452 | acc=1.0000 | 4396.1 samples/s | 68.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.48965 | acc=0.7103 | tpr=0.5803 | fpr=0.0074 | 4351.9 samples/s | 17.0 steps/s
Avg test loss: 0.49002, Avg test acc: 0.70691, Avg tpr: 0.57685, Avg fpr: 0.00705, total FA: 55

Testing server on iccad2012
[Step=  50] | Loss=0.30252 | acc=0.8876 | tpr=0.9602 | fpr=0.1137 | 4616.7 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.30787 | acc=0.8868 | tpr=0.9701 | fpr=0.1147 | 8619.6 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.31383 | acc=0.8860 | tpr=0.9755 | fpr=0.1157 | 8735.6 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.31790 | acc=0.8856 | tpr=0.9770 | fpr=0.1161 | 9179.5 samples/s | 35.9 steps/s
[Step= 250] | Loss=0.31716 | acc=0.8857 | tpr=0.9755 | fpr=0.1159 | 8711.4 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.31871 | acc=0.8855 | tpr=0.9760 | fpr=0.1162 | 8839.7 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.31917 | acc=0.8852 | tpr=0.9768 | fpr=0.1164 | 8912.3 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.32058 | acc=0.8850 | tpr=0.9770 | fpr=0.1167 | 8756.1 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.32333 | acc=0.8848 | tpr=0.9781 | fpr=0.1169 | 8577.2 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.32275 | acc=0.8849 | tpr=0.9780 | fpr=0.1168 | 8839.0 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.32182 | acc=0.8850 | tpr=0.9785 | fpr=0.1167 | 16219.8 samples/s | 63.4 steps/s
Avg test loss: 0.32148, Avg test acc: 0.88510, Avg tpr: 0.97861, Avg fpr: 0.11660, total FA: 16190

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=11.7] | Loss=0.16014 | Reg=0.00222 | L2-Norm=14.906 | L2-Norm(final)=2.471 | acc=0.8750 | 3369.9 samples/s | 52.7 steps/s
[Step=12050 Epoch=11.8] | Loss=0.05150 | Reg=0.00225 | L2-Norm=14.997 | L2-Norm(final)=2.458 | acc=1.0000 | 4469.2 samples/s | 69.8 steps/s
[Step=12100 Epoch=11.8] | Loss=0.03664 | Reg=0.00226 | L2-Norm=15.036 | L2-Norm(final)=2.465 | acc=0.9844 | 4630.2 samples/s | 72.3 steps/s
[Step=12150 Epoch=11.9] | Loss=0.03123 | Reg=0.00227 | L2-Norm=15.056 | L2-Norm(final)=2.470 | acc=0.9844 | 4594.8 samples/s | 71.8 steps/s
[Step=12200 Epoch=11.9] | Loss=0.02872 | Reg=0.00227 | L2-Norm=15.071 | L2-Norm(final)=2.475 | acc=0.9844 | 4554.5 samples/s | 71.2 steps/s
[Step=12250 Epoch=12.0] | Loss=0.02714 | Reg=0.00228 | L2-Norm=15.083 | L2-Norm(final)=2.479 | acc=0.9844 | 4529.9 samples/s | 70.8 steps/s
[Step=12300 Epoch=12.0] | Loss=0.02600 | Reg=0.00228 | L2-Norm=15.093 | L2-Norm(final)=2.482 | acc=0.9844 | 4558.7 samples/s | 71.2 steps/s
[Step=12350 Epoch=12.1] | Loss=0.02545 | Reg=0.00228 | L2-Norm=15.102 | L2-Norm(final)=2.485 | acc=1.0000 | 4106.3 samples/s | 64.2 steps/s
[Step=12400 Epoch=12.1] | Loss=0.02564 | Reg=0.00228 | L2-Norm=15.110 | L2-Norm(final)=2.487 | acc=0.9844 | 3998.9 samples/s | 62.5 steps/s
[Step=12450 Epoch=12.2] | Loss=0.02462 | Reg=0.00229 | L2-Norm=15.117 | L2-Norm(final)=2.489 | acc=1.0000 | 4028.2 samples/s | 62.9 steps/s
[Step=12500 Epoch=12.2] | Loss=0.02443 | Reg=0.00229 | L2-Norm=15.125 | L2-Norm(final)=2.491 | acc=0.9531 | 4084.1 samples/s | 63.8 steps/s
[Step=12550 Epoch=12.3] | Loss=0.02415 | Reg=0.00229 | L2-Norm=15.132 | L2-Norm(final)=2.493 | acc=1.0000 | 3646.8 samples/s | 57.0 steps/s
[Step=12600 Epoch=12.3] | Loss=0.02423 | Reg=0.00229 | L2-Norm=15.139 | L2-Norm(final)=2.493 | acc=0.9844 | 3788.0 samples/s | 59.2 steps/s
[Step=12650 Epoch=12.4] | Loss=0.02400 | Reg=0.00229 | L2-Norm=15.145 | L2-Norm(final)=2.494 | acc=1.0000 | 4021.7 samples/s | 62.8 steps/s
[Step=12700 Epoch=12.4] | Loss=0.02381 | Reg=0.00230 | L2-Norm=15.152 | L2-Norm(final)=2.495 | acc=1.0000 | 4046.7 samples/s | 63.2 steps/s
[Step=12750 Epoch=12.4] | Loss=0.02355 | Reg=0.00230 | L2-Norm=15.158 | L2-Norm(final)=2.496 | acc=1.0000 | 4019.3 samples/s | 62.8 steps/s
[Step=12800 Epoch=12.5] | Loss=0.02346 | Reg=0.00230 | L2-Norm=15.164 | L2-Norm(final)=2.496 | acc=1.0000 | 3674.3 samples/s | 57.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12001 Epoch=22.6] | Loss=0.00279 | Reg=0.00222 | L2-Norm=14.906 | L2-Norm(final)=2.471 | acc=1.0000 | 3002.8 samples/s | 46.9 steps/s
[Step=12050 Epoch=22.7] | Loss=0.00481 | Reg=0.00225 | L2-Norm=15.006 | L2-Norm(final)=2.460 | acc=1.0000 | 4231.0 samples/s | 66.1 steps/s
[Step=12100 Epoch=22.8] | Loss=0.00369 | Reg=0.00226 | L2-Norm=15.034 | L2-Norm(final)=2.460 | acc=1.0000 | 4354.0 samples/s | 68.0 steps/s
[Step=12150 Epoch=22.9] | Loss=0.00252 | Reg=0.00226 | L2-Norm=15.043 | L2-Norm(final)=2.460 | acc=1.0000 | 4300.0 samples/s | 67.2 steps/s
[Step=12200 Epoch=23.0] | Loss=0.00194 | Reg=0.00226 | L2-Norm=15.041 | L2-Norm(final)=2.462 | acc=1.0000 | 4289.8 samples/s | 67.0 steps/s
[Step=12250 Epoch=23.1] | Loss=0.00157 | Reg=0.00226 | L2-Norm=15.036 | L2-Norm(final)=2.464 | acc=1.0000 | 4349.2 samples/s | 68.0 steps/s
[Step=12300 Epoch=23.2] | Loss=0.00131 | Reg=0.00226 | L2-Norm=15.028 | L2-Norm(final)=2.465 | acc=1.0000 | 4420.8 samples/s | 69.1 steps/s
[Step=12350 Epoch=23.3] | Loss=0.00114 | Reg=0.00226 | L2-Norm=15.018 | L2-Norm(final)=2.467 | acc=1.0000 | 4361.8 samples/s | 68.2 steps/s
[Step=12400 Epoch=23.4] | Loss=0.00100 | Reg=0.00225 | L2-Norm=15.008 | L2-Norm(final)=2.469 | acc=1.0000 | 4335.0 samples/s | 67.7 steps/s
[Step=12450 Epoch=23.5] | Loss=0.00093 | Reg=0.00225 | L2-Norm=14.997 | L2-Norm(final)=2.471 | acc=1.0000 | 4425.9 samples/s | 69.2 steps/s
[Step=12500 Epoch=23.6] | Loss=0.00085 | Reg=0.00225 | L2-Norm=14.987 | L2-Norm(final)=2.473 | acc=1.0000 | 4336.7 samples/s | 67.8 steps/s
[Step=12550 Epoch=23.7] | Loss=0.00077 | Reg=0.00224 | L2-Norm=14.976 | L2-Norm(final)=2.474 | acc=1.0000 | 1525.8 samples/s | 23.8 steps/s
[Step=12600 Epoch=23.8] | Loss=0.00071 | Reg=0.00224 | L2-Norm=14.965 | L2-Norm(final)=2.475 | acc=1.0000 | 4162.9 samples/s | 65.0 steps/s
[Step=12650 Epoch=23.8] | Loss=0.00065 | Reg=0.00224 | L2-Norm=14.953 | L2-Norm(final)=2.477 | acc=1.0000 | 4225.1 samples/s | 66.0 steps/s
[Step=12700 Epoch=23.9] | Loss=0.00061 | Reg=0.00223 | L2-Norm=14.941 | L2-Norm(final)=2.478 | acc=1.0000 | 4468.3 samples/s | 69.8 steps/s
[Step=12750 Epoch=24.0] | Loss=0.00057 | Reg=0.00223 | L2-Norm=14.929 | L2-Norm(final)=2.479 | acc=1.0000 | 4358.1 samples/s | 68.1 steps/s
[Step=12800 Epoch=24.1] | Loss=0.00053 | Reg=0.00223 | L2-Norm=14.916 | L2-Norm(final)=2.480 | acc=1.0000 | 4357.6 samples/s | 68.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43192 | acc=0.7234 | tpr=0.6000 | fpr=0.0084 | 4392.4 samples/s | 17.2 steps/s
Avg test loss: 0.43194, Avg test acc: 0.72245, Avg tpr: 0.60057, Avg fpr: 0.00949, total FA: 74

Testing server on iccad2012
[Step=  50] | Loss=0.27695 | acc=0.8989 | tpr=0.9690 | fpr=0.1024 | 4450.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.28456 | acc=0.8977 | tpr=0.9787 | fpr=0.1038 | 8549.5 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.29158 | acc=0.8959 | tpr=0.9841 | fpr=0.1058 | 8879.4 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.29609 | acc=0.8953 | tpr=0.9836 | fpr=0.1063 | 9010.7 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.29502 | acc=0.8948 | tpr=0.9825 | fpr=0.1068 | 8743.9 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.29708 | acc=0.8945 | tpr=0.9825 | fpr=0.1071 | 8829.7 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.29761 | acc=0.8940 | tpr=0.9831 | fpr=0.1076 | 8567.0 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.29971 | acc=0.8934 | tpr=0.9836 | fpr=0.1083 | 8522.4 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.30225 | acc=0.8932 | tpr=0.9834 | fpr=0.1084 | 9125.2 samples/s | 35.6 steps/s
[Step= 500] | Loss=0.30112 | acc=0.8933 | tpr=0.9833 | fpr=0.1083 | 8690.7 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.30009 | acc=0.8936 | tpr=0.9841 | fpr=0.1081 | 16378.7 samples/s | 64.0 steps/s
Avg test loss: 0.29966, Avg test acc: 0.89364, Avg tpr: 0.98415, Avg fpr: 0.10800, total FA: 14996

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=12.5] | Loss=0.24973 | Reg=0.00221 | L2-Norm=14.850 | L2-Norm(final)=2.497 | acc=0.7812 | 3417.5 samples/s | 53.4 steps/s
[Step=12850 Epoch=12.5] | Loss=0.04731 | Reg=0.00223 | L2-Norm=14.939 | L2-Norm(final)=2.489 | acc=0.9531 | 4267.8 samples/s | 66.7 steps/s
[Step=12900 Epoch=12.6] | Loss=0.03527 | Reg=0.00224 | L2-Norm=14.971 | L2-Norm(final)=2.490 | acc=0.9844 | 4576.8 samples/s | 71.5 steps/s
[Step=12950 Epoch=12.6] | Loss=0.02867 | Reg=0.00225 | L2-Norm=14.989 | L2-Norm(final)=2.495 | acc=1.0000 | 4620.6 samples/s | 72.2 steps/s
[Step=13000 Epoch=12.7] | Loss=0.02745 | Reg=0.00225 | L2-Norm=15.001 | L2-Norm(final)=2.499 | acc=0.9844 | 4582.9 samples/s | 71.6 steps/s
[Step=13050 Epoch=12.7] | Loss=0.02557 | Reg=0.00225 | L2-Norm=15.010 | L2-Norm(final)=2.502 | acc=0.9688 | 4527.8 samples/s | 70.7 steps/s
[Step=13100 Epoch=12.8] | Loss=0.02447 | Reg=0.00226 | L2-Norm=15.018 | L2-Norm(final)=2.506 | acc=0.9688 | 4664.2 samples/s | 72.9 steps/s
[Step=13150 Epoch=12.8] | Loss=0.02383 | Reg=0.00226 | L2-Norm=15.026 | L2-Norm(final)=2.509 | acc=0.9688 | 4543.1 samples/s | 71.0 steps/s
[Step=13200 Epoch=12.9] | Loss=0.02312 | Reg=0.00226 | L2-Norm=15.034 | L2-Norm(final)=2.512 | acc=1.0000 | 4582.4 samples/s | 71.6 steps/s
[Step=13250 Epoch=12.9] | Loss=0.02256 | Reg=0.00226 | L2-Norm=15.042 | L2-Norm(final)=2.515 | acc=0.9844 | 4579.3 samples/s | 71.6 steps/s
[Step=13300 Epoch=13.0] | Loss=0.02262 | Reg=0.00226 | L2-Norm=15.049 | L2-Norm(final)=2.517 | acc=0.9531 | 4616.3 samples/s | 72.1 steps/s
[Step=13350 Epoch=13.0] | Loss=0.02241 | Reg=0.00227 | L2-Norm=15.057 | L2-Norm(final)=2.519 | acc=1.0000 | 4754.3 samples/s | 74.3 steps/s
[Step=13400 Epoch=13.1] | Loss=0.02221 | Reg=0.00227 | L2-Norm=15.063 | L2-Norm(final)=2.521 | acc=1.0000 | 4763.4 samples/s | 74.4 steps/s
[Step=13450 Epoch=13.1] | Loss=0.02195 | Reg=0.00227 | L2-Norm=15.070 | L2-Norm(final)=2.523 | acc=0.9844 | 4557.0 samples/s | 71.2 steps/s
[Step=13500 Epoch=13.2] | Loss=0.02204 | Reg=0.00227 | L2-Norm=15.077 | L2-Norm(final)=2.524 | acc=0.9844 | 4502.9 samples/s | 70.4 steps/s
[Step=13550 Epoch=13.2] | Loss=0.02207 | Reg=0.00228 | L2-Norm=15.083 | L2-Norm(final)=2.526 | acc=0.9844 | 4670.2 samples/s | 73.0 steps/s
[Step=13600 Epoch=13.3] | Loss=0.02194 | Reg=0.00228 | L2-Norm=15.090 | L2-Norm(final)=2.527 | acc=1.0000 | 4571.2 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step13600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=12801 Epoch=24.1] | Loss=0.00448 | Reg=0.00221 | L2-Norm=14.850 | L2-Norm(final)=2.498 | acc=1.0000 | 3783.8 samples/s | 59.1 steps/s
[Step=12850 Epoch=24.2] | Loss=0.00352 | Reg=0.00222 | L2-Norm=14.907 | L2-Norm(final)=2.498 | acc=1.0000 | 3774.0 samples/s | 59.0 steps/s
[Step=12900 Epoch=24.3] | Loss=0.00185 | Reg=0.00223 | L2-Norm=14.920 | L2-Norm(final)=2.503 | acc=1.0000 | 4284.2 samples/s | 66.9 steps/s
[Step=12950 Epoch=24.4] | Loss=0.00131 | Reg=0.00222 | L2-Norm=14.916 | L2-Norm(final)=2.507 | acc=1.0000 | 4401.0 samples/s | 68.8 steps/s
[Step=13000 Epoch=24.5] | Loss=0.00124 | Reg=0.00222 | L2-Norm=14.914 | L2-Norm(final)=2.510 | acc=1.0000 | 4333.2 samples/s | 67.7 steps/s
[Step=13050 Epoch=24.6] | Loss=0.00107 | Reg=0.00222 | L2-Norm=14.912 | L2-Norm(final)=2.513 | acc=1.0000 | 4397.9 samples/s | 68.7 steps/s
[Step=13100 Epoch=24.7] | Loss=0.00091 | Reg=0.00222 | L2-Norm=14.906 | L2-Norm(final)=2.516 | acc=1.0000 | 4458.8 samples/s | 69.7 steps/s
[Step=13150 Epoch=24.8] | Loss=0.00079 | Reg=0.00222 | L2-Norm=14.899 | L2-Norm(final)=2.518 | acc=1.0000 | 4508.9 samples/s | 70.5 steps/s
[Step=13200 Epoch=24.9] | Loss=0.00069 | Reg=0.00222 | L2-Norm=14.891 | L2-Norm(final)=2.521 | acc=1.0000 | 4306.0 samples/s | 67.3 steps/s
[Step=13250 Epoch=25.0] | Loss=0.00062 | Reg=0.00221 | L2-Norm=14.882 | L2-Norm(final)=2.523 | acc=1.0000 | 4251.8 samples/s | 66.4 steps/s
[Step=13300 Epoch=25.1] | Loss=0.00056 | Reg=0.00221 | L2-Norm=14.871 | L2-Norm(final)=2.525 | acc=1.0000 | 4501.2 samples/s | 70.3 steps/s
[Step=13350 Epoch=25.2] | Loss=0.00051 | Reg=0.00221 | L2-Norm=14.860 | L2-Norm(final)=2.527 | acc=1.0000 | 1493.8 samples/s | 23.3 steps/s
[Step=13400 Epoch=25.3] | Loss=0.00047 | Reg=0.00220 | L2-Norm=14.848 | L2-Norm(final)=2.529 | acc=1.0000 | 4437.2 samples/s | 69.3 steps/s
[Step=13450 Epoch=25.4] | Loss=0.00043 | Reg=0.00220 | L2-Norm=14.836 | L2-Norm(final)=2.530 | acc=1.0000 | 4234.2 samples/s | 66.2 steps/s
[Step=13500 Epoch=25.4] | Loss=0.00040 | Reg=0.00220 | L2-Norm=14.824 | L2-Norm(final)=2.531 | acc=1.0000 | 4254.7 samples/s | 66.5 steps/s
[Step=13550 Epoch=25.5] | Loss=0.00037 | Reg=0.00219 | L2-Norm=14.811 | L2-Norm(final)=2.533 | acc=1.0000 | 4281.1 samples/s | 66.9 steps/s
[Step=13600 Epoch=25.6] | Loss=0.00035 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.534 | acc=1.0000 | 4414.1 samples/s | 69.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45118 | acc=0.7297 | tpr=0.6100 | fpr=0.0104 | 4405.1 samples/s | 17.2 steps/s
Avg test loss: 0.45126, Avg test acc: 0.72782, Avg tpr: 0.60861, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.31517 | acc=0.8870 | tpr=0.9690 | fpr=0.1144 | 4406.4 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.31970 | acc=0.8876 | tpr=0.9744 | fpr=0.1140 | 8791.7 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.32744 | acc=0.8861 | tpr=0.9813 | fpr=0.1157 | 9055.5 samples/s | 35.4 steps/s
[Step= 200] | Loss=0.33085 | acc=0.8855 | tpr=0.9814 | fpr=0.1162 | 8696.1 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.32962 | acc=0.8848 | tpr=0.9808 | fpr=0.1169 | 9156.6 samples/s | 35.8 steps/s
[Step= 300] | Loss=0.33137 | acc=0.8840 | tpr=0.9796 | fpr=0.1177 | 8723.0 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.33236 | acc=0.8836 | tpr=0.9806 | fpr=0.1182 | 8984.8 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.33447 | acc=0.8835 | tpr=0.9803 | fpr=0.1182 | 8570.3 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.33806 | acc=0.8832 | tpr=0.9805 | fpr=0.1186 | 8744.1 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.33709 | acc=0.8832 | tpr=0.9806 | fpr=0.1186 | 8685.6 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.33583 | acc=0.8835 | tpr=0.9801 | fpr=0.1183 | 17148.7 samples/s | 67.0 steps/s
Avg test loss: 0.33552, Avg test acc: 0.88351, Avg tpr: 0.98019, Avg fpr: 0.11825, total FA: 16419

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=13.3] | Loss=0.16497 | Reg=0.00218 | L2-Norm=14.774 | L2-Norm(final)=2.548 | acc=0.8750 | 3545.6 samples/s | 55.4 steps/s
[Step=13650 Epoch=13.3] | Loss=0.05238 | Reg=0.00221 | L2-Norm=14.857 | L2-Norm(final)=2.531 | acc=0.9844 | 4595.0 samples/s | 71.8 steps/s
[Step=13700 Epoch=13.4] | Loss=0.03545 | Reg=0.00222 | L2-Norm=14.888 | L2-Norm(final)=2.537 | acc=0.9688 | 4618.8 samples/s | 72.2 steps/s
[Step=13750 Epoch=13.4] | Loss=0.02939 | Reg=0.00222 | L2-Norm=14.905 | L2-Norm(final)=2.544 | acc=0.9688 | 4726.0 samples/s | 73.8 steps/s
[Step=13800 Epoch=13.5] | Loss=0.02782 | Reg=0.00223 | L2-Norm=14.917 | L2-Norm(final)=2.547 | acc=0.9844 | 4503.8 samples/s | 70.4 steps/s
[Step=13850 Epoch=13.5] | Loss=0.02627 | Reg=0.00223 | L2-Norm=14.928 | L2-Norm(final)=2.550 | acc=1.0000 | 4565.1 samples/s | 71.3 steps/s
[Step=13900 Epoch=13.6] | Loss=0.02569 | Reg=0.00223 | L2-Norm=14.937 | L2-Norm(final)=2.552 | acc=0.9844 | 4641.3 samples/s | 72.5 steps/s
[Step=13950 Epoch=13.6] | Loss=0.02499 | Reg=0.00223 | L2-Norm=14.946 | L2-Norm(final)=2.554 | acc=1.0000 | 4675.6 samples/s | 73.1 steps/s
[Step=14000 Epoch=13.7] | Loss=0.02489 | Reg=0.00224 | L2-Norm=14.955 | L2-Norm(final)=2.557 | acc=0.9844 | 4441.7 samples/s | 69.4 steps/s
[Step=14050 Epoch=13.7] | Loss=0.02424 | Reg=0.00224 | L2-Norm=14.963 | L2-Norm(final)=2.559 | acc=0.9375 | 4596.0 samples/s | 71.8 steps/s
[Step=14100 Epoch=13.8] | Loss=0.02382 | Reg=0.00224 | L2-Norm=14.971 | L2-Norm(final)=2.561 | acc=0.9219 | 4708.0 samples/s | 73.6 steps/s
[Step=14150 Epoch=13.8] | Loss=0.02322 | Reg=0.00224 | L2-Norm=14.978 | L2-Norm(final)=2.563 | acc=1.0000 | 4502.7 samples/s | 70.4 steps/s
[Step=14200 Epoch=13.9] | Loss=0.02307 | Reg=0.00225 | L2-Norm=14.985 | L2-Norm(final)=2.565 | acc=1.0000 | 4560.7 samples/s | 71.3 steps/s
[Step=14250 Epoch=13.9] | Loss=0.02296 | Reg=0.00225 | L2-Norm=14.993 | L2-Norm(final)=2.567 | acc=1.0000 | 4606.9 samples/s | 72.0 steps/s
[Step=14300 Epoch=14.0] | Loss=0.02287 | Reg=0.00225 | L2-Norm=15.000 | L2-Norm(final)=2.568 | acc=1.0000 | 4654.7 samples/s | 72.7 steps/s
[Step=14350 Epoch=14.0] | Loss=0.02260 | Reg=0.00225 | L2-Norm=15.008 | L2-Norm(final)=2.570 | acc=0.9844 | 4662.3 samples/s | 72.8 steps/s
[Step=14400 Epoch=14.1] | Loss=0.02233 | Reg=0.00225 | L2-Norm=15.015 | L2-Norm(final)=2.572 | acc=1.0000 | 4624.4 samples/s | 72.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step14400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=13601 Epoch=25.6] | Loss=0.00854 | Reg=0.00218 | L2-Norm=14.774 | L2-Norm(final)=2.549 | acc=0.9844 | 3390.8 samples/s | 53.0 steps/s
[Step=13650 Epoch=25.7] | Loss=0.00469 | Reg=0.00221 | L2-Norm=14.854 | L2-Norm(final)=2.553 | acc=1.0000 | 4217.1 samples/s | 65.9 steps/s
[Step=13700 Epoch=25.8] | Loss=0.00473 | Reg=0.00223 | L2-Norm=14.919 | L2-Norm(final)=2.547 | acc=1.0000 | 4345.0 samples/s | 67.9 steps/s
[Step=13750 Epoch=25.9] | Loss=0.00363 | Reg=0.00224 | L2-Norm=14.956 | L2-Norm(final)=2.545 | acc=1.0000 | 4324.6 samples/s | 67.6 steps/s
[Step=13800 Epoch=26.0] | Loss=0.00278 | Reg=0.00224 | L2-Norm=14.972 | L2-Norm(final)=2.545 | acc=1.0000 | 4461.6 samples/s | 69.7 steps/s
[Step=13850 Epoch=26.1] | Loss=0.00280 | Reg=0.00224 | L2-Norm=14.978 | L2-Norm(final)=2.546 | acc=0.9844 | 4177.6 samples/s | 65.3 steps/s
[Step=13900 Epoch=26.2] | Loss=0.00249 | Reg=0.00225 | L2-Norm=14.984 | L2-Norm(final)=2.545 | acc=1.0000 | 4318.4 samples/s | 67.5 steps/s
[Step=13950 Epoch=26.3] | Loss=0.00215 | Reg=0.00225 | L2-Norm=14.987 | L2-Norm(final)=2.545 | acc=1.0000 | 4410.2 samples/s | 68.9 steps/s
[Step=14000 Epoch=26.4] | Loss=0.00189 | Reg=0.00225 | L2-Norm=14.987 | L2-Norm(final)=2.545 | acc=1.0000 | 4401.8 samples/s | 68.8 steps/s
[Step=14050 Epoch=26.5] | Loss=0.00170 | Reg=0.00225 | L2-Norm=14.985 | L2-Norm(final)=2.546 | acc=1.0000 | 4289.4 samples/s | 67.0 steps/s
[Step=14100 Epoch=26.6] | Loss=0.00158 | Reg=0.00224 | L2-Norm=14.981 | L2-Norm(final)=2.546 | acc=1.0000 | 4316.9 samples/s | 67.5 steps/s
[Step=14150 Epoch=26.7] | Loss=0.00144 | Reg=0.00224 | L2-Norm=14.977 | L2-Norm(final)=2.547 | acc=1.0000 | 1486.7 samples/s | 23.2 steps/s
[Step=14200 Epoch=26.8] | Loss=0.00136 | Reg=0.00224 | L2-Norm=14.972 | L2-Norm(final)=2.548 | acc=1.0000 | 4480.1 samples/s | 70.0 steps/s
[Step=14250 Epoch=26.9] | Loss=0.00127 | Reg=0.00224 | L2-Norm=14.966 | L2-Norm(final)=2.548 | acc=1.0000 | 4277.4 samples/s | 66.8 steps/s
[Step=14300 Epoch=27.0] | Loss=0.00118 | Reg=0.00224 | L2-Norm=14.960 | L2-Norm(final)=2.549 | acc=1.0000 | 4199.8 samples/s | 65.6 steps/s
[Step=14350 Epoch=27.0] | Loss=0.00110 | Reg=0.00224 | L2-Norm=14.953 | L2-Norm(final)=2.550 | acc=1.0000 | 4347.6 samples/s | 67.9 steps/s
[Step=14400 Epoch=27.1] | Loss=0.00103 | Reg=0.00223 | L2-Norm=14.946 | L2-Norm(final)=2.551 | acc=1.0000 | 4383.0 samples/s | 68.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.50892 | acc=0.6866 | tpr=0.5475 | fpr=0.0114 | 4374.0 samples/s | 17.1 steps/s
Avg test loss: 0.50872, Avg test acc: 0.68603, Avg tpr: 0.54811, Avg fpr: 0.01064, total FA: 83

Testing server on iccad2012
[Step=  50] | Loss=0.30788 | acc=0.8921 | tpr=0.9690 | fpr=0.1093 | 4442.9 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.30972 | acc=0.8932 | tpr=0.9787 | fpr=0.1084 | 8781.8 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.31895 | acc=0.8910 | tpr=0.9856 | fpr=0.1108 | 8657.0 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.32186 | acc=0.8904 | tpr=0.9858 | fpr=0.1113 | 9015.6 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.32187 | acc=0.8899 | tpr=0.9834 | fpr=0.1118 | 8936.3 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.32465 | acc=0.8893 | tpr=0.9825 | fpr=0.1124 | 8782.9 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.32545 | acc=0.8889 | tpr=0.9831 | fpr=0.1128 | 8579.9 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.32779 | acc=0.8885 | tpr=0.9819 | fpr=0.1132 | 9009.2 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.33101 | acc=0.8881 | tpr=0.9820 | fpr=0.1136 | 8702.5 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.33048 | acc=0.8878 | tpr=0.9824 | fpr=0.1139 | 8518.4 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.32925 | acc=0.8881 | tpr=0.9825 | fpr=0.1136 | 16423.8 samples/s | 64.2 steps/s
Avg test loss: 0.32900, Avg test acc: 0.88817, Avg tpr: 0.98257, Avg fpr: 0.11354, total FA: 15765

server round 18/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=14.1] | Loss=0.38490 | Reg=0.00220 | L2-Norm=14.818 | L2-Norm(final)=2.573 | acc=0.7812 | 3454.2 samples/s | 54.0 steps/s
[Step=14450 Epoch=14.1] | Loss=0.05877 | Reg=0.00222 | L2-Norm=14.900 | L2-Norm(final)=2.548 | acc=1.0000 | 4314.8 samples/s | 67.4 steps/s
[Step=14500 Epoch=14.2] | Loss=0.03824 | Reg=0.00223 | L2-Norm=14.934 | L2-Norm(final)=2.552 | acc=0.9688 | 4517.5 samples/s | 70.6 steps/s
[Step=14550 Epoch=14.2] | Loss=0.03291 | Reg=0.00224 | L2-Norm=14.954 | L2-Norm(final)=2.558 | acc=1.0000 | 4550.5 samples/s | 71.1 steps/s
[Step=14600 Epoch=14.3] | Loss=0.02988 | Reg=0.00224 | L2-Norm=14.969 | L2-Norm(final)=2.563 | acc=0.9219 | 4671.9 samples/s | 73.0 steps/s
[Step=14650 Epoch=14.3] | Loss=0.02794 | Reg=0.00224 | L2-Norm=14.981 | L2-Norm(final)=2.567 | acc=1.0000 | 4588.9 samples/s | 71.7 steps/s
[Step=14700 Epoch=14.4] | Loss=0.02652 | Reg=0.00225 | L2-Norm=14.991 | L2-Norm(final)=2.572 | acc=0.9844 | 4661.6 samples/s | 72.8 steps/s
[Step=14750 Epoch=14.4] | Loss=0.02506 | Reg=0.00225 | L2-Norm=15.001 | L2-Norm(final)=2.576 | acc=0.9844 | 4573.1 samples/s | 71.5 steps/s
[Step=14800 Epoch=14.4] | Loss=0.02427 | Reg=0.00225 | L2-Norm=15.010 | L2-Norm(final)=2.581 | acc=0.9844 | 4647.1 samples/s | 72.6 steps/s
[Step=14850 Epoch=14.5] | Loss=0.02388 | Reg=0.00226 | L2-Norm=15.018 | L2-Norm(final)=2.585 | acc=0.9844 | 4475.2 samples/s | 69.9 steps/s
[Step=14900 Epoch=14.5] | Loss=0.02357 | Reg=0.00226 | L2-Norm=15.025 | L2-Norm(final)=2.588 | acc=1.0000 | 4618.5 samples/s | 72.2 steps/s
[Step=14950 Epoch=14.6] | Loss=0.02333 | Reg=0.00226 | L2-Norm=15.033 | L2-Norm(final)=2.591 | acc=1.0000 | 4616.1 samples/s | 72.1 steps/s
[Step=15000 Epoch=14.6] | Loss=0.02274 | Reg=0.00226 | L2-Norm=15.040 | L2-Norm(final)=2.593 | acc=1.0000 | 4440.4 samples/s | 69.4 steps/s
[Step=15050 Epoch=14.7] | Loss=0.02261 | Reg=0.00226 | L2-Norm=15.047 | L2-Norm(final)=2.596 | acc=1.0000 | 4608.1 samples/s | 72.0 steps/s
[Step=15100 Epoch=14.7] | Loss=0.02229 | Reg=0.00227 | L2-Norm=15.053 | L2-Norm(final)=2.597 | acc=1.0000 | 4664.9 samples/s | 72.9 steps/s
[Step=15150 Epoch=14.8] | Loss=0.02222 | Reg=0.00227 | L2-Norm=15.059 | L2-Norm(final)=2.599 | acc=1.0000 | 4477.2 samples/s | 70.0 steps/s
[Step=15200 Epoch=14.8] | Loss=0.02191 | Reg=0.00227 | L2-Norm=15.066 | L2-Norm(final)=2.600 | acc=0.9688 | 4587.0 samples/s | 71.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step15200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=14401 Epoch=27.1] | Loss=0.00932 | Reg=0.00220 | L2-Norm=14.818 | L2-Norm(final)=2.573 | acc=1.0000 | 3459.6 samples/s | 54.1 steps/s
[Step=14450 Epoch=27.2] | Loss=0.00152 | Reg=0.00221 | L2-Norm=14.869 | L2-Norm(final)=2.571 | acc=1.0000 | 4093.7 samples/s | 64.0 steps/s
[Step=14500 Epoch=27.3] | Loss=0.00080 | Reg=0.00221 | L2-Norm=14.877 | L2-Norm(final)=2.575 | acc=1.0000 | 4363.6 samples/s | 68.2 steps/s
[Step=14550 Epoch=27.4] | Loss=0.00054 | Reg=0.00221 | L2-Norm=14.871 | L2-Norm(final)=2.577 | acc=1.0000 | 4439.1 samples/s | 69.4 steps/s
[Step=14600 Epoch=27.5] | Loss=0.00042 | Reg=0.00221 | L2-Norm=14.862 | L2-Norm(final)=2.579 | acc=1.0000 | 4338.1 samples/s | 67.8 steps/s
[Step=14650 Epoch=27.6] | Loss=0.00034 | Reg=0.00221 | L2-Norm=14.851 | L2-Norm(final)=2.580 | acc=1.0000 | 4489.9 samples/s | 70.2 steps/s
[Step=14700 Epoch=27.7] | Loss=0.00029 | Reg=0.00220 | L2-Norm=14.840 | L2-Norm(final)=2.582 | acc=1.0000 | 4318.6 samples/s | 67.5 steps/s
[Step=14750 Epoch=27.8] | Loss=0.00025 | Reg=0.00220 | L2-Norm=14.829 | L2-Norm(final)=2.583 | acc=1.0000 | 4321.8 samples/s | 67.5 steps/s
[Step=14800 Epoch=27.9] | Loss=0.00022 | Reg=0.00220 | L2-Norm=14.818 | L2-Norm(final)=2.585 | acc=1.0000 | 4393.3 samples/s | 68.6 steps/s
[Step=14850 Epoch=28.0] | Loss=0.00020 | Reg=0.00219 | L2-Norm=14.806 | L2-Norm(final)=2.586 | acc=1.0000 | 4379.9 samples/s | 68.4 steps/s
[Step=14900 Epoch=28.1] | Loss=0.00018 | Reg=0.00219 | L2-Norm=14.794 | L2-Norm(final)=2.587 | acc=1.0000 | 4363.4 samples/s | 68.2 steps/s
[Step=14950 Epoch=28.2] | Loss=0.00016 | Reg=0.00219 | L2-Norm=14.782 | L2-Norm(final)=2.589 | acc=1.0000 | 1539.1 samples/s | 24.0 steps/s
[Step=15000 Epoch=28.3] | Loss=0.00015 | Reg=0.00218 | L2-Norm=14.770 | L2-Norm(final)=2.590 | acc=1.0000 | 4423.3 samples/s | 69.1 steps/s
[Step=15050 Epoch=28.4] | Loss=0.00014 | Reg=0.00218 | L2-Norm=14.757 | L2-Norm(final)=2.591 | acc=1.0000 | 4429.9 samples/s | 69.2 steps/s
[Step=15100 Epoch=28.5] | Loss=0.00013 | Reg=0.00217 | L2-Norm=14.745 | L2-Norm(final)=2.593 | acc=1.0000 | 4319.5 samples/s | 67.5 steps/s
[Step=15150 Epoch=28.6] | Loss=0.00012 | Reg=0.00217 | L2-Norm=14.732 | L2-Norm(final)=2.594 | acc=1.0000 | 4270.2 samples/s | 66.7 steps/s
[Step=15200 Epoch=28.7] | Loss=0.00011 | Reg=0.00217 | L2-Norm=14.720 | L2-Norm(final)=2.595 | acc=1.0000 | 4277.6 samples/s | 66.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33059 | acc=0.7941 | tpr=0.7034 | fpr=0.0092 | 4434.9 samples/s | 17.3 steps/s
Avg test loss: 0.33151, Avg test acc: 0.79201, Avg tpr: 0.70158, Avg fpr: 0.00910, total FA: 71

Testing server on iccad2012
[Step=  50] | Loss=0.45001 | acc=0.8402 | tpr=0.9690 | fpr=0.1622 | 4324.7 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.45042 | acc=0.8418 | tpr=0.9765 | fpr=0.1607 | 8732.0 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.46119 | acc=0.8408 | tpr=0.9841 | fpr=0.1618 | 9344.2 samples/s | 36.5 steps/s
[Step= 200] | Loss=0.46503 | acc=0.8405 | tpr=0.9825 | fpr=0.1621 | 8678.9 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.46528 | acc=0.8402 | tpr=0.9799 | fpr=0.1624 | 8730.7 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.46798 | acc=0.8402 | tpr=0.9804 | fpr=0.1624 | 9247.8 samples/s | 36.1 steps/s
[Step= 350] | Loss=0.46762 | acc=0.8399 | tpr=0.9806 | fpr=0.1626 | 8828.8 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.47064 | acc=0.8391 | tpr=0.9803 | fpr=0.1634 | 8872.6 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.47423 | acc=0.8387 | tpr=0.9800 | fpr=0.1638 | 8604.4 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.47368 | acc=0.8388 | tpr=0.9797 | fpr=0.1638 | 8909.0 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.47245 | acc=0.8389 | tpr=0.9801 | fpr=0.1637 | 17015.9 samples/s | 66.5 steps/s
Avg test loss: 0.47226, Avg test acc: 0.83889, Avg tpr: 0.98019, Avg fpr: 0.16368, total FA: 22727

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=14.8] | Loss=0.20414 | Reg=0.00217 | L2-Norm=14.740 | L2-Norm(final)=2.614 | acc=0.8125 | 3644.4 samples/s | 56.9 steps/s
[Step=15250 Epoch=14.9] | Loss=0.04533 | Reg=0.00219 | L2-Norm=14.799 | L2-Norm(final)=2.603 | acc=0.9844 | 4321.4 samples/s | 67.5 steps/s
[Step=15300 Epoch=14.9] | Loss=0.03164 | Reg=0.00220 | L2-Norm=14.826 | L2-Norm(final)=2.609 | acc=0.9844 | 4625.5 samples/s | 72.3 steps/s
[Step=15350 Epoch=15.0] | Loss=0.02828 | Reg=0.00220 | L2-Norm=14.842 | L2-Norm(final)=2.612 | acc=1.0000 | 4718.8 samples/s | 73.7 steps/s
[Step=15400 Epoch=15.0] | Loss=0.02474 | Reg=0.00221 | L2-Norm=14.854 | L2-Norm(final)=2.617 | acc=0.9688 | 4586.1 samples/s | 71.7 steps/s
[Step=15450 Epoch=15.1] | Loss=0.02289 | Reg=0.00221 | L2-Norm=14.866 | L2-Norm(final)=2.621 | acc=0.9531 | 4405.8 samples/s | 68.8 steps/s
[Step=15500 Epoch=15.1] | Loss=0.02259 | Reg=0.00221 | L2-Norm=14.875 | L2-Norm(final)=2.625 | acc=1.0000 | 4567.5 samples/s | 71.4 steps/s
[Step=15550 Epoch=15.2] | Loss=0.02217 | Reg=0.00222 | L2-Norm=14.885 | L2-Norm(final)=2.628 | acc=1.0000 | 4656.2 samples/s | 72.8 steps/s
[Step=15600 Epoch=15.2] | Loss=0.02182 | Reg=0.00222 | L2-Norm=14.895 | L2-Norm(final)=2.630 | acc=1.0000 | 4503.1 samples/s | 70.4 steps/s
[Step=15650 Epoch=15.3] | Loss=0.02122 | Reg=0.00222 | L2-Norm=14.903 | L2-Norm(final)=2.632 | acc=1.0000 | 4069.4 samples/s | 63.6 steps/s
[Step=15700 Epoch=15.3] | Loss=0.02070 | Reg=0.00222 | L2-Norm=14.911 | L2-Norm(final)=2.634 | acc=1.0000 | 3804.4 samples/s | 59.4 steps/s
[Step=15750 Epoch=15.4] | Loss=0.02027 | Reg=0.00223 | L2-Norm=14.919 | L2-Norm(final)=2.636 | acc=1.0000 | 3802.6 samples/s | 59.4 steps/s
[Step=15800 Epoch=15.4] | Loss=0.02044 | Reg=0.00223 | L2-Norm=14.926 | L2-Norm(final)=2.638 | acc=0.9531 | 4045.5 samples/s | 63.2 steps/s
[Step=15850 Epoch=15.5] | Loss=0.02015 | Reg=0.00223 | L2-Norm=14.934 | L2-Norm(final)=2.640 | acc=1.0000 | 4020.2 samples/s | 62.8 steps/s
[Step=15900 Epoch=15.5] | Loss=0.02000 | Reg=0.00223 | L2-Norm=14.942 | L2-Norm(final)=2.642 | acc=0.9688 | 4019.7 samples/s | 62.8 steps/s
[Step=15950 Epoch=15.6] | Loss=0.01995 | Reg=0.00223 | L2-Norm=14.949 | L2-Norm(final)=2.643 | acc=0.9844 | 3955.7 samples/s | 61.8 steps/s
[Step=16000 Epoch=15.6] | Loss=0.02006 | Reg=0.00224 | L2-Norm=14.956 | L2-Norm(final)=2.645 | acc=0.9688 | 3992.5 samples/s | 62.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=15201 Epoch=28.7] | Loss=0.04146 | Reg=0.00217 | L2-Norm=14.740 | L2-Norm(final)=2.614 | acc=0.9688 | 3125.3 samples/s | 48.8 steps/s
[Step=15250 Epoch=28.7] | Loss=0.00372 | Reg=0.00220 | L2-Norm=14.842 | L2-Norm(final)=2.605 | acc=1.0000 | 4093.0 samples/s | 64.0 steps/s
[Step=15300 Epoch=28.8] | Loss=0.00382 | Reg=0.00222 | L2-Norm=14.886 | L2-Norm(final)=2.597 | acc=1.0000 | 4135.4 samples/s | 64.6 steps/s
[Step=15350 Epoch=28.9] | Loss=0.00319 | Reg=0.00222 | L2-Norm=14.911 | L2-Norm(final)=2.591 | acc=1.0000 | 4402.2 samples/s | 68.8 steps/s
[Step=15400 Epoch=29.0] | Loss=0.00297 | Reg=0.00223 | L2-Norm=14.922 | L2-Norm(final)=2.587 | acc=1.0000 | 4273.9 samples/s | 66.8 steps/s
[Step=15450 Epoch=29.1] | Loss=0.00243 | Reg=0.00223 | L2-Norm=14.928 | L2-Norm(final)=2.585 | acc=1.0000 | 4331.2 samples/s | 67.7 steps/s
[Step=15500 Epoch=29.2] | Loss=0.00207 | Reg=0.00223 | L2-Norm=14.929 | L2-Norm(final)=2.585 | acc=1.0000 | 4388.2 samples/s | 68.6 steps/s
[Step=15550 Epoch=29.3] | Loss=0.00179 | Reg=0.00223 | L2-Norm=14.929 | L2-Norm(final)=2.586 | acc=1.0000 | 4408.3 samples/s | 68.9 steps/s
[Step=15600 Epoch=29.4] | Loss=0.00184 | Reg=0.00223 | L2-Norm=14.928 | L2-Norm(final)=2.587 | acc=0.9844 | 4292.0 samples/s | 67.1 steps/s
[Step=15650 Epoch=29.5] | Loss=0.00179 | Reg=0.00223 | L2-Norm=14.931 | L2-Norm(final)=2.588 | acc=1.0000 | 4408.6 samples/s | 68.9 steps/s
[Step=15700 Epoch=29.6] | Loss=0.00162 | Reg=0.00223 | L2-Norm=14.935 | L2-Norm(final)=2.588 | acc=1.0000 | 4363.9 samples/s | 68.2 steps/s
[Step=15750 Epoch=29.7] | Loss=0.00156 | Reg=0.00223 | L2-Norm=14.936 | L2-Norm(final)=2.589 | acc=1.0000 | 1449.3 samples/s | 22.6 steps/s
[Step=15800 Epoch=29.8] | Loss=0.00144 | Reg=0.00223 | L2-Norm=14.937 | L2-Norm(final)=2.590 | acc=1.0000 | 4387.3 samples/s | 68.6 steps/s
[Step=15850 Epoch=29.9] | Loss=0.00133 | Reg=0.00223 | L2-Norm=14.936 | L2-Norm(final)=2.591 | acc=1.0000 | 4461.2 samples/s | 69.7 steps/s
[Step=15900 Epoch=30.0] | Loss=0.00124 | Reg=0.00223 | L2-Norm=14.934 | L2-Norm(final)=2.592 | acc=1.0000 | 4432.1 samples/s | 69.3 steps/s
[Step=15950 Epoch=30.1] | Loss=0.00116 | Reg=0.00223 | L2-Norm=14.931 | L2-Norm(final)=2.593 | acc=1.0000 | 4258.3 samples/s | 66.5 steps/s
[Step=16000 Epoch=30.2] | Loss=0.00108 | Reg=0.00223 | L2-Norm=14.926 | L2-Norm(final)=2.594 | acc=1.0000 | 4266.5 samples/s | 66.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.56331 | acc=0.6948 | tpr=0.5608 | fpr=0.0141 | 4216.4 samples/s | 16.5 steps/s
Avg test loss: 0.55846, Avg test acc: 0.69645, Avg tpr: 0.56449, Avg fpr: 0.01333, total FA: 104

Testing server on iccad2012
[Step=  50] | Loss=0.31883 | acc=0.9038 | tpr=0.9735 | fpr=0.0974 | 4216.0 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.32130 | acc=0.9045 | tpr=0.9765 | fpr=0.0969 | 9104.8 samples/s | 35.6 steps/s
[Step= 150] | Loss=0.33148 | acc=0.9024 | tpr=0.9841 | fpr=0.0991 | 9349.5 samples/s | 36.5 steps/s
[Step= 200] | Loss=0.33519 | acc=0.9024 | tpr=0.9825 | fpr=0.0990 | 8725.6 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.33409 | acc=0.9019 | tpr=0.9817 | fpr=0.0996 | 9041.0 samples/s | 35.3 steps/s
[Step= 300] | Loss=0.33684 | acc=0.9018 | tpr=0.9825 | fpr=0.0997 | 8686.8 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.33672 | acc=0.9016 | tpr=0.9825 | fpr=0.0998 | 9161.0 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.33954 | acc=0.9010 | tpr=0.9825 | fpr=0.1004 | 9279.6 samples/s | 36.2 steps/s
[Step= 450] | Loss=0.34329 | acc=0.9007 | tpr=0.9820 | fpr=0.1008 | 8331.4 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.34254 | acc=0.9006 | tpr=0.9819 | fpr=0.1008 | 8967.1 samples/s | 35.0 steps/s
[Step= 550] | Loss=0.34137 | acc=0.9010 | tpr=0.9821 | fpr=0.1005 | 15835.7 samples/s | 61.9 steps/s
Avg test loss: 0.34113, Avg test acc: 0.90096, Avg tpr: 0.98217, Avg fpr: 0.10051, total FA: 13956

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=15.6] | Loss=0.43849 | Reg=0.00219 | L2-Norm=14.792 | L2-Norm(final)=2.628 | acc=0.7500 | 3762.3 samples/s | 58.8 steps/s
[Step=16050 Epoch=15.7] | Loss=0.06444 | Reg=0.00220 | L2-Norm=14.831 | L2-Norm(final)=2.612 | acc=1.0000 | 4083.9 samples/s | 63.8 steps/s
[Step=16100 Epoch=15.7] | Loss=0.04162 | Reg=0.00220 | L2-Norm=14.846 | L2-Norm(final)=2.616 | acc=1.0000 | 4684.7 samples/s | 73.2 steps/s
[Step=16150 Epoch=15.8] | Loss=0.03304 | Reg=0.00221 | L2-Norm=14.854 | L2-Norm(final)=2.621 | acc=0.9844 | 4525.9 samples/s | 70.7 steps/s
[Step=16200 Epoch=15.8] | Loss=0.02852 | Reg=0.00221 | L2-Norm=14.859 | L2-Norm(final)=2.625 | acc=1.0000 | 4312.8 samples/s | 67.4 steps/s
[Step=16250 Epoch=15.9] | Loss=0.02595 | Reg=0.00221 | L2-Norm=14.864 | L2-Norm(final)=2.628 | acc=1.0000 | 3728.6 samples/s | 58.3 steps/s
[Step=16300 Epoch=15.9] | Loss=0.02402 | Reg=0.00221 | L2-Norm=14.868 | L2-Norm(final)=2.631 | acc=0.9844 | 4040.0 samples/s | 63.1 steps/s
[Step=16350 Epoch=16.0] | Loss=0.02250 | Reg=0.00221 | L2-Norm=14.871 | L2-Norm(final)=2.634 | acc=0.9844 | 4061.0 samples/s | 63.5 steps/s
[Step=16400 Epoch=16.0] | Loss=0.02171 | Reg=0.00221 | L2-Norm=14.874 | L2-Norm(final)=2.637 | acc=1.0000 | 4055.4 samples/s | 63.4 steps/s
[Step=16450 Epoch=16.1] | Loss=0.02114 | Reg=0.00221 | L2-Norm=14.877 | L2-Norm(final)=2.639 | acc=1.0000 | 3777.2 samples/s | 59.0 steps/s
[Step=16500 Epoch=16.1] | Loss=0.02065 | Reg=0.00221 | L2-Norm=14.879 | L2-Norm(final)=2.641 | acc=1.0000 | 3681.2 samples/s | 57.5 steps/s
[Step=16550 Epoch=16.2] | Loss=0.01999 | Reg=0.00221 | L2-Norm=14.882 | L2-Norm(final)=2.644 | acc=0.9844 | 4018.1 samples/s | 62.8 steps/s
[Step=16600 Epoch=16.2] | Loss=0.01973 | Reg=0.00222 | L2-Norm=14.884 | L2-Norm(final)=2.646 | acc=1.0000 | 4008.0 samples/s | 62.6 steps/s
[Step=16650 Epoch=16.3] | Loss=0.01950 | Reg=0.00222 | L2-Norm=14.887 | L2-Norm(final)=2.647 | acc=0.9844 | 3982.8 samples/s | 62.2 steps/s
[Step=16700 Epoch=16.3] | Loss=0.01915 | Reg=0.00222 | L2-Norm=14.889 | L2-Norm(final)=2.649 | acc=0.9844 | 3827.4 samples/s | 59.8 steps/s
[Step=16750 Epoch=16.4] | Loss=0.01904 | Reg=0.00222 | L2-Norm=14.891 | L2-Norm(final)=2.651 | acc=0.9531 | 3739.9 samples/s | 58.4 steps/s
[Step=16800 Epoch=16.4] | Loss=0.01867 | Reg=0.00222 | L2-Norm=14.893 | L2-Norm(final)=2.653 | acc=1.0000 | 4012.3 samples/s | 62.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16001 Epoch=30.2] | Loss=0.05135 | Reg=0.00219 | L2-Norm=14.792 | L2-Norm(final)=2.629 | acc=0.9688 | 3436.7 samples/s | 53.7 steps/s
[Step=16050 Epoch=30.3] | Loss=0.00200 | Reg=0.00219 | L2-Norm=14.804 | L2-Norm(final)=2.632 | acc=1.0000 | 3436.6 samples/s | 53.7 steps/s
[Step=16100 Epoch=30.3] | Loss=0.00111 | Reg=0.00219 | L2-Norm=14.805 | L2-Norm(final)=2.635 | acc=1.0000 | 4420.8 samples/s | 69.1 steps/s
[Step=16150 Epoch=30.4] | Loss=0.00076 | Reg=0.00219 | L2-Norm=14.803 | L2-Norm(final)=2.638 | acc=1.0000 | 4224.9 samples/s | 66.0 steps/s
[Step=16200 Epoch=30.5] | Loss=0.00058 | Reg=0.00219 | L2-Norm=14.799 | L2-Norm(final)=2.640 | acc=1.0000 | 4325.4 samples/s | 67.6 steps/s
[Step=16250 Epoch=30.6] | Loss=0.00048 | Reg=0.00219 | L2-Norm=14.794 | L2-Norm(final)=2.641 | acc=1.0000 | 4371.1 samples/s | 68.3 steps/s
[Step=16300 Epoch=30.7] | Loss=0.00040 | Reg=0.00219 | L2-Norm=14.790 | L2-Norm(final)=2.642 | acc=1.0000 | 4416.7 samples/s | 69.0 steps/s
[Step=16350 Epoch=30.8] | Loss=0.00035 | Reg=0.00219 | L2-Norm=14.785 | L2-Norm(final)=2.643 | acc=1.0000 | 4399.1 samples/s | 68.7 steps/s
[Step=16400 Epoch=30.9] | Loss=0.00031 | Reg=0.00218 | L2-Norm=14.779 | L2-Norm(final)=2.644 | acc=1.0000 | 4359.9 samples/s | 68.1 steps/s
[Step=16450 Epoch=31.0] | Loss=0.00028 | Reg=0.00218 | L2-Norm=14.774 | L2-Norm(final)=2.645 | acc=1.0000 | 4438.8 samples/s | 69.4 steps/s
[Step=16500 Epoch=31.1] | Loss=0.00025 | Reg=0.00218 | L2-Norm=14.769 | L2-Norm(final)=2.646 | acc=1.0000 | 4584.5 samples/s | 71.6 steps/s
[Step=16550 Epoch=31.2] | Loss=0.00023 | Reg=0.00218 | L2-Norm=14.763 | L2-Norm(final)=2.646 | acc=1.0000 | 1429.0 samples/s | 22.3 steps/s
[Step=16600 Epoch=31.3] | Loss=0.00021 | Reg=0.00218 | L2-Norm=14.757 | L2-Norm(final)=2.647 | acc=1.0000 | 4480.3 samples/s | 70.0 steps/s
[Step=16650 Epoch=31.4] | Loss=0.00019 | Reg=0.00218 | L2-Norm=14.752 | L2-Norm(final)=2.648 | acc=1.0000 | 4353.0 samples/s | 68.0 steps/s
[Step=16700 Epoch=31.5] | Loss=0.00018 | Reg=0.00217 | L2-Norm=14.746 | L2-Norm(final)=2.648 | acc=1.0000 | 4369.8 samples/s | 68.3 steps/s
[Step=16750 Epoch=31.6] | Loss=0.00017 | Reg=0.00217 | L2-Norm=14.740 | L2-Norm(final)=2.649 | acc=1.0000 | 4369.5 samples/s | 68.3 steps/s
[Step=16800 Epoch=31.7] | Loss=0.00016 | Reg=0.00217 | L2-Norm=14.734 | L2-Norm(final)=2.649 | acc=1.0000 | 4294.9 samples/s | 67.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24137 | acc=0.8515 | tpr=0.7888 | fpr=0.0124 | 4407.0 samples/s | 17.2 steps/s
Avg test loss: 0.24008, Avg test acc: 0.85159, Avg tpr: 0.78971, Avg fpr: 0.01231, total FA: 96

Testing server on iccad2012
[Step=  50] | Loss=0.59724 | acc=0.8077 | tpr=0.9690 | fpr=0.1952 | 4477.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.59571 | acc=0.8090 | tpr=0.9765 | fpr=0.1941 | 9051.5 samples/s | 35.4 steps/s
[Step= 150] | Loss=0.60929 | acc=0.8075 | tpr=0.9841 | fpr=0.1958 | 8779.5 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.61317 | acc=0.8077 | tpr=0.9836 | fpr=0.1955 | 9291.0 samples/s | 36.3 steps/s
[Step= 250] | Loss=0.61307 | acc=0.8075 | tpr=0.9817 | fpr=0.1957 | 8808.4 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.61712 | acc=0.8071 | tpr=0.9825 | fpr=0.1961 | 8735.4 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.61719 | acc=0.8069 | tpr=0.9831 | fpr=0.1963 | 8664.4 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.62060 | acc=0.8064 | tpr=0.9836 | fpr=0.1968 | 8657.6 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.62507 | acc=0.8060 | tpr=0.9830 | fpr=0.1972 | 9048.0 samples/s | 35.3 steps/s
[Step= 500] | Loss=0.62458 | acc=0.8059 | tpr=0.9833 | fpr=0.1973 | 8972.5 samples/s | 35.0 steps/s
[Step= 550] | Loss=0.62309 | acc=0.8061 | tpr=0.9829 | fpr=0.1971 | 16261.9 samples/s | 63.5 steps/s
Avg test loss: 0.62259, Avg test acc: 0.80613, Avg tpr: 0.98296, Avg fpr: 0.19709, total FA: 27365

server round 21/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=16.4] | Loss=0.14550 | Reg=0.00217 | L2-Norm=14.738 | L2-Norm(final)=2.668 | acc=0.9062 | 3384.2 samples/s | 52.9 steps/s
[Step=16850 Epoch=16.5] | Loss=0.02586 | Reg=0.00218 | L2-Norm=14.766 | L2-Norm(final)=2.670 | acc=0.9844 | 4740.5 samples/s | 74.1 steps/s
[Step=16900 Epoch=16.5] | Loss=0.02004 | Reg=0.00218 | L2-Norm=14.776 | L2-Norm(final)=2.673 | acc=0.9844 | 4500.7 samples/s | 70.3 steps/s
[Step=16950 Epoch=16.5] | Loss=0.01738 | Reg=0.00218 | L2-Norm=14.781 | L2-Norm(final)=2.676 | acc=0.9844 | 4641.2 samples/s | 72.5 steps/s
[Step=17000 Epoch=16.6] | Loss=0.01541 | Reg=0.00219 | L2-Norm=14.785 | L2-Norm(final)=2.680 | acc=1.0000 | 4704.1 samples/s | 73.5 steps/s
[Step=17050 Epoch=16.6] | Loss=0.01512 | Reg=0.00219 | L2-Norm=14.789 | L2-Norm(final)=2.683 | acc=1.0000 | 4685.5 samples/s | 73.2 steps/s
[Step=17100 Epoch=16.7] | Loss=0.01487 | Reg=0.00219 | L2-Norm=14.792 | L2-Norm(final)=2.686 | acc=0.9531 | 4812.1 samples/s | 75.2 steps/s
[Step=17150 Epoch=16.7] | Loss=0.01472 | Reg=0.00219 | L2-Norm=14.795 | L2-Norm(final)=2.689 | acc=1.0000 | 4612.8 samples/s | 72.1 steps/s
[Step=17200 Epoch=16.8] | Loss=0.01448 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.692 | acc=0.9844 | 4425.2 samples/s | 69.1 steps/s
[Step=17250 Epoch=16.8] | Loss=0.01424 | Reg=0.00219 | L2-Norm=14.801 | L2-Norm(final)=2.694 | acc=0.9844 | 4533.3 samples/s | 70.8 steps/s
[Step=17300 Epoch=16.9] | Loss=0.01432 | Reg=0.00219 | L2-Norm=14.803 | L2-Norm(final)=2.697 | acc=0.9844 | 4527.3 samples/s | 70.7 steps/s
[Step=17350 Epoch=16.9] | Loss=0.01437 | Reg=0.00219 | L2-Norm=14.806 | L2-Norm(final)=2.699 | acc=1.0000 | 4853.2 samples/s | 75.8 steps/s
[Step=17400 Epoch=17.0] | Loss=0.01422 | Reg=0.00219 | L2-Norm=14.808 | L2-Norm(final)=2.701 | acc=0.9688 | 4861.5 samples/s | 76.0 steps/s
[Step=17450 Epoch=17.0] | Loss=0.01424 | Reg=0.00219 | L2-Norm=14.810 | L2-Norm(final)=2.703 | acc=0.9688 | 4569.0 samples/s | 71.4 steps/s
[Step=17500 Epoch=17.1] | Loss=0.01411 | Reg=0.00219 | L2-Norm=14.813 | L2-Norm(final)=2.705 | acc=1.0000 | 4583.9 samples/s | 71.6 steps/s
[Step=17550 Epoch=17.1] | Loss=0.01418 | Reg=0.00219 | L2-Norm=14.815 | L2-Norm(final)=2.706 | acc=1.0000 | 4438.5 samples/s | 69.4 steps/s
[Step=17600 Epoch=17.2] | Loss=0.01420 | Reg=0.00220 | L2-Norm=14.817 | L2-Norm(final)=2.708 | acc=1.0000 | 4517.7 samples/s | 70.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step17600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=16801 Epoch=31.7] | Loss=0.08744 | Reg=0.00217 | L2-Norm=14.738 | L2-Norm(final)=2.668 | acc=0.9062 | 3582.6 samples/s | 56.0 steps/s
[Step=16850 Epoch=31.8] | Loss=0.00656 | Reg=0.00219 | L2-Norm=14.794 | L2-Norm(final)=2.661 | acc=1.0000 | 3939.5 samples/s | 61.6 steps/s
[Step=16900 Epoch=31.9] | Loss=0.00351 | Reg=0.00219 | L2-Norm=14.810 | L2-Norm(final)=2.661 | acc=1.0000 | 4256.0 samples/s | 66.5 steps/s
[Step=16950 Epoch=32.0] | Loss=0.00238 | Reg=0.00219 | L2-Norm=14.813 | L2-Norm(final)=2.662 | acc=1.0000 | 4428.6 samples/s | 69.2 steps/s
[Step=17000 Epoch=32.0] | Loss=0.00180 | Reg=0.00219 | L2-Norm=14.812 | L2-Norm(final)=2.663 | acc=1.0000 | 4373.1 samples/s | 68.3 steps/s
[Step=17050 Epoch=32.1] | Loss=0.00145 | Reg=0.00219 | L2-Norm=14.811 | L2-Norm(final)=2.665 | acc=1.0000 | 4210.3 samples/s | 65.8 steps/s
[Step=17100 Epoch=32.2] | Loss=0.00122 | Reg=0.00219 | L2-Norm=14.808 | L2-Norm(final)=2.665 | acc=1.0000 | 4416.0 samples/s | 69.0 steps/s
[Step=17150 Epoch=32.3] | Loss=0.00105 | Reg=0.00219 | L2-Norm=14.804 | L2-Norm(final)=2.666 | acc=1.0000 | 4259.3 samples/s | 66.6 steps/s
[Step=17200 Epoch=32.4] | Loss=0.00092 | Reg=0.00219 | L2-Norm=14.801 | L2-Norm(final)=2.667 | acc=1.0000 | 4569.0 samples/s | 71.4 steps/s
[Step=17250 Epoch=32.5] | Loss=0.00082 | Reg=0.00219 | L2-Norm=14.797 | L2-Norm(final)=2.668 | acc=1.0000 | 4406.6 samples/s | 68.9 steps/s
[Step=17300 Epoch=32.6] | Loss=0.00074 | Reg=0.00219 | L2-Norm=14.793 | L2-Norm(final)=2.669 | acc=1.0000 | 4379.3 samples/s | 68.4 steps/s
[Step=17350 Epoch=32.7] | Loss=0.00068 | Reg=0.00219 | L2-Norm=14.789 | L2-Norm(final)=2.669 | acc=1.0000 | 1497.1 samples/s | 23.4 steps/s
[Step=17400 Epoch=32.8] | Loss=0.00062 | Reg=0.00219 | L2-Norm=14.785 | L2-Norm(final)=2.670 | acc=1.0000 | 4501.1 samples/s | 70.3 steps/s
[Step=17450 Epoch=32.9] | Loss=0.00058 | Reg=0.00218 | L2-Norm=14.780 | L2-Norm(final)=2.671 | acc=1.0000 | 4354.7 samples/s | 68.0 steps/s
[Step=17500 Epoch=33.0] | Loss=0.00054 | Reg=0.00218 | L2-Norm=14.776 | L2-Norm(final)=2.671 | acc=1.0000 | 4281.2 samples/s | 66.9 steps/s
[Step=17550 Epoch=33.1] | Loss=0.00050 | Reg=0.00218 | L2-Norm=14.772 | L2-Norm(final)=2.672 | acc=1.0000 | 4229.1 samples/s | 66.1 steps/s
[Step=17600 Epoch=33.2] | Loss=0.00047 | Reg=0.00218 | L2-Norm=14.767 | L2-Norm(final)=2.673 | acc=1.0000 | 4321.4 samples/s | 67.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41789 | acc=0.7658 | tpr=0.6615 | fpr=0.0077 | 4448.8 samples/s | 17.4 steps/s
Avg test loss: 0.41302, Avg test acc: 0.76509, Avg tpr: 0.66160, Avg fpr: 0.00731, total FA: 57

Testing server on iccad2012
[Step=  50] | Loss=0.38053 | acc=0.8867 | tpr=0.9646 | fpr=0.1147 | 4400.6 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.38266 | acc=0.8883 | tpr=0.9744 | fpr=0.1133 | 8861.8 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.39523 | acc=0.8851 | tpr=0.9813 | fpr=0.1166 | 8705.2 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.39859 | acc=0.8845 | tpr=0.9803 | fpr=0.1173 | 8868.2 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.39779 | acc=0.8842 | tpr=0.9790 | fpr=0.1175 | 9067.8 samples/s | 35.4 steps/s
[Step= 300] | Loss=0.40076 | acc=0.8839 | tpr=0.9804 | fpr=0.1179 | 8593.6 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.40135 | acc=0.8834 | tpr=0.9800 | fpr=0.1184 | 9149.7 samples/s | 35.7 steps/s
[Step= 400] | Loss=0.40405 | acc=0.8826 | tpr=0.9798 | fpr=0.1191 | 8778.9 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.40764 | acc=0.8825 | tpr=0.9796 | fpr=0.1192 | 8440.5 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.40688 | acc=0.8824 | tpr=0.9802 | fpr=0.1193 | 8794.7 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.40586 | acc=0.8828 | tpr=0.9797 | fpr=0.1189 | 16322.5 samples/s | 63.8 steps/s
Avg test loss: 0.40555, Avg test acc: 0.88284, Avg tpr: 0.97979, Avg fpr: 0.11892, total FA: 16512

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=17.2] | Loss=0.29315 | Reg=0.00217 | L2-Norm=14.717 | L2-Norm(final)=2.706 | acc=0.8281 | 3357.8 samples/s | 52.5 steps/s
[Step=17650 Epoch=17.2] | Loss=0.03770 | Reg=0.00218 | L2-Norm=14.760 | L2-Norm(final)=2.698 | acc=1.0000 | 4311.5 samples/s | 67.4 steps/s
[Step=17700 Epoch=17.3] | Loss=0.02662 | Reg=0.00218 | L2-Norm=14.774 | L2-Norm(final)=2.701 | acc=1.0000 | 4572.1 samples/s | 71.4 steps/s
[Step=17750 Epoch=17.3] | Loss=0.02329 | Reg=0.00218 | L2-Norm=14.780 | L2-Norm(final)=2.704 | acc=1.0000 | 4658.9 samples/s | 72.8 steps/s
[Step=17800 Epoch=17.4] | Loss=0.02108 | Reg=0.00219 | L2-Norm=14.785 | L2-Norm(final)=2.707 | acc=0.9844 | 4409.2 samples/s | 68.9 steps/s
[Step=17850 Epoch=17.4] | Loss=0.01939 | Reg=0.00219 | L2-Norm=14.788 | L2-Norm(final)=2.709 | acc=1.0000 | 4589.9 samples/s | 71.7 steps/s
[Step=17900 Epoch=17.5] | Loss=0.01828 | Reg=0.00219 | L2-Norm=14.792 | L2-Norm(final)=2.712 | acc=0.9844 | 4696.4 samples/s | 73.4 steps/s
[Step=17950 Epoch=17.5] | Loss=0.01770 | Reg=0.00219 | L2-Norm=14.795 | L2-Norm(final)=2.715 | acc=0.9844 | 4729.9 samples/s | 73.9 steps/s
[Step=18000 Epoch=17.6] | Loss=0.01688 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.717 | acc=0.9688 | 4528.4 samples/s | 70.8 steps/s
[Step=18050 Epoch=17.6] | Loss=0.01642 | Reg=0.00219 | L2-Norm=14.800 | L2-Norm(final)=2.720 | acc=0.9844 | 4452.7 samples/s | 69.6 steps/s
[Step=18100 Epoch=17.7] | Loss=0.01619 | Reg=0.00219 | L2-Norm=14.803 | L2-Norm(final)=2.722 | acc=0.9844 | 4636.0 samples/s | 72.4 steps/s
[Step=18150 Epoch=17.7] | Loss=0.01583 | Reg=0.00219 | L2-Norm=14.805 | L2-Norm(final)=2.724 | acc=1.0000 | 4595.9 samples/s | 71.8 steps/s
[Step=18200 Epoch=17.8] | Loss=0.01579 | Reg=0.00219 | L2-Norm=14.807 | L2-Norm(final)=2.726 | acc=1.0000 | 4702.0 samples/s | 73.5 steps/s
[Step=18250 Epoch=17.8] | Loss=0.01546 | Reg=0.00219 | L2-Norm=14.808 | L2-Norm(final)=2.727 | acc=0.9688 | 4738.2 samples/s | 74.0 steps/s
[Step=18300 Epoch=17.9] | Loss=0.01546 | Reg=0.00219 | L2-Norm=14.810 | L2-Norm(final)=2.728 | acc=1.0000 | 4714.2 samples/s | 73.7 steps/s
[Step=18350 Epoch=17.9] | Loss=0.01542 | Reg=0.00219 | L2-Norm=14.812 | L2-Norm(final)=2.730 | acc=0.9688 | 4608.6 samples/s | 72.0 steps/s
[Step=18400 Epoch=18.0] | Loss=0.01514 | Reg=0.00219 | L2-Norm=14.814 | L2-Norm(final)=2.731 | acc=0.9844 | 4382.6 samples/s | 68.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step18400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=17601 Epoch=33.2] | Loss=0.07844 | Reg=0.00217 | L2-Norm=14.717 | L2-Norm(final)=2.707 | acc=0.9375 | 2850.6 samples/s | 44.5 steps/s
[Step=17650 Epoch=33.3] | Loss=0.00318 | Reg=0.00217 | L2-Norm=14.746 | L2-Norm(final)=2.707 | acc=1.0000 | 4426.7 samples/s | 69.2 steps/s
[Step=17700 Epoch=33.4] | Loss=0.00165 | Reg=0.00218 | L2-Norm=14.750 | L2-Norm(final)=2.709 | acc=1.0000 | 4216.6 samples/s | 65.9 steps/s
[Step=17750 Epoch=33.5] | Loss=0.00115 | Reg=0.00218 | L2-Norm=14.750 | L2-Norm(final)=2.711 | acc=1.0000 | 4464.2 samples/s | 69.8 steps/s
[Step=17800 Epoch=33.6] | Loss=0.00087 | Reg=0.00217 | L2-Norm=14.748 | L2-Norm(final)=2.713 | acc=1.0000 | 4305.4 samples/s | 67.3 steps/s
[Step=17850 Epoch=33.6] | Loss=0.00071 | Reg=0.00217 | L2-Norm=14.744 | L2-Norm(final)=2.715 | acc=1.0000 | 4407.2 samples/s | 68.9 steps/s
[Step=17900 Epoch=33.7] | Loss=0.00059 | Reg=0.00217 | L2-Norm=14.740 | L2-Norm(final)=2.716 | acc=1.0000 | 4324.0 samples/s | 67.6 steps/s
[Step=17950 Epoch=33.8] | Loss=0.00051 | Reg=0.00217 | L2-Norm=14.736 | L2-Norm(final)=2.717 | acc=1.0000 | 4308.6 samples/s | 67.3 steps/s
[Step=18000 Epoch=33.9] | Loss=0.00045 | Reg=0.00217 | L2-Norm=14.732 | L2-Norm(final)=2.718 | acc=1.0000 | 4330.2 samples/s | 67.7 steps/s
[Step=18050 Epoch=34.0] | Loss=0.00040 | Reg=0.00217 | L2-Norm=14.727 | L2-Norm(final)=2.720 | acc=1.0000 | 4598.8 samples/s | 71.9 steps/s
[Step=18100 Epoch=34.1] | Loss=0.00037 | Reg=0.00217 | L2-Norm=14.723 | L2-Norm(final)=2.721 | acc=1.0000 | 4380.0 samples/s | 68.4 steps/s
[Step=18150 Epoch=34.2] | Loss=0.00033 | Reg=0.00217 | L2-Norm=14.718 | L2-Norm(final)=2.722 | acc=1.0000 | 1496.9 samples/s | 23.4 steps/s
[Step=18200 Epoch=34.3] | Loss=0.00031 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=2.723 | acc=1.0000 | 4250.6 samples/s | 66.4 steps/s
[Step=18250 Epoch=34.4] | Loss=0.00028 | Reg=0.00216 | L2-Norm=14.708 | L2-Norm(final)=2.724 | acc=1.0000 | 4361.9 samples/s | 68.2 steps/s
[Step=18300 Epoch=34.5] | Loss=0.00027 | Reg=0.00216 | L2-Norm=14.703 | L2-Norm(final)=2.725 | acc=1.0000 | 4420.3 samples/s | 69.1 steps/s
[Step=18350 Epoch=34.6] | Loss=0.00025 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=2.726 | acc=1.0000 | 4368.9 samples/s | 68.3 steps/s
[Step=18400 Epoch=34.7] | Loss=0.00023 | Reg=0.00216 | L2-Norm=14.693 | L2-Norm(final)=2.726 | acc=1.0000 | 4248.7 samples/s | 66.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33637 | acc=0.8084 | tpr=0.7227 | fpr=0.0057 | 4476.9 samples/s | 17.5 steps/s
Avg test loss: 0.33560, Avg test acc: 0.80812, Avg tpr: 0.72390, Avg fpr: 0.00667, total FA: 52

Testing server on iccad2012
[Step=  50] | Loss=0.45172 | acc=0.8651 | tpr=0.9690 | fpr=0.1368 | 4396.1 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.44954 | acc=0.8661 | tpr=0.9765 | fpr=0.1360 | 8788.5 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.46248 | acc=0.8639 | tpr=0.9841 | fpr=0.1383 | 8865.9 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.46585 | acc=0.8640 | tpr=0.9836 | fpr=0.1382 | 8947.1 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.46535 | acc=0.8636 | tpr=0.9808 | fpr=0.1385 | 8733.9 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.46891 | acc=0.8631 | tpr=0.9811 | fpr=0.1390 | 8928.4 samples/s | 34.9 steps/s
[Step= 350] | Loss=0.46913 | acc=0.8628 | tpr=0.9812 | fpr=0.1393 | 8834.9 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.47200 | acc=0.8628 | tpr=0.9814 | fpr=0.1394 | 8761.6 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.47569 | acc=0.8625 | tpr=0.9810 | fpr=0.1396 | 8500.9 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.47498 | acc=0.8625 | tpr=0.9815 | fpr=0.1397 | 8912.4 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.47412 | acc=0.8628 | tpr=0.9809 | fpr=0.1394 | 16171.5 samples/s | 63.2 steps/s
Avg test loss: 0.47386, Avg test acc: 0.86281, Avg tpr: 0.98098, Avg fpr: 0.13934, total FA: 19347

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=18.0] | Loss=0.16503 | Reg=0.00216 | L2-Norm=14.680 | L2-Norm(final)=2.746 | acc=0.8438 | 3837.4 samples/s | 60.0 steps/s
[Step=18450 Epoch=18.0] | Loss=0.03654 | Reg=0.00217 | L2-Norm=14.724 | L2-Norm(final)=2.740 | acc=0.9688 | 4337.8 samples/s | 67.8 steps/s
[Step=18500 Epoch=18.1] | Loss=0.02475 | Reg=0.00217 | L2-Norm=14.739 | L2-Norm(final)=2.742 | acc=1.0000 | 4617.7 samples/s | 72.2 steps/s
[Step=18550 Epoch=18.1] | Loss=0.02088 | Reg=0.00217 | L2-Norm=14.746 | L2-Norm(final)=2.745 | acc=0.9844 | 4581.5 samples/s | 71.6 steps/s
[Step=18600 Epoch=18.2] | Loss=0.01874 | Reg=0.00218 | L2-Norm=14.750 | L2-Norm(final)=2.747 | acc=1.0000 | 4552.1 samples/s | 71.1 steps/s
[Step=18650 Epoch=18.2] | Loss=0.01780 | Reg=0.00218 | L2-Norm=14.754 | L2-Norm(final)=2.749 | acc=0.9375 | 4453.8 samples/s | 69.6 steps/s
[Step=18700 Epoch=18.3] | Loss=0.01692 | Reg=0.00218 | L2-Norm=14.756 | L2-Norm(final)=2.750 | acc=0.9844 | 4684.9 samples/s | 73.2 steps/s
[Step=18750 Epoch=18.3] | Loss=0.01629 | Reg=0.00218 | L2-Norm=14.759 | L2-Norm(final)=2.752 | acc=0.9844 | 4599.6 samples/s | 71.9 steps/s
[Step=18800 Epoch=18.4] | Loss=0.01575 | Reg=0.00218 | L2-Norm=14.761 | L2-Norm(final)=2.754 | acc=1.0000 | 4560.5 samples/s | 71.3 steps/s
[Step=18850 Epoch=18.4] | Loss=0.01557 | Reg=0.00218 | L2-Norm=14.763 | L2-Norm(final)=2.756 | acc=0.9844 | 4812.7 samples/s | 75.2 steps/s
[Step=18900 Epoch=18.5] | Loss=0.01553 | Reg=0.00218 | L2-Norm=14.765 | L2-Norm(final)=2.758 | acc=1.0000 | 4600.9 samples/s | 71.9 steps/s
[Step=18950 Epoch=18.5] | Loss=0.01510 | Reg=0.00218 | L2-Norm=14.767 | L2-Norm(final)=2.759 | acc=1.0000 | 4452.7 samples/s | 69.6 steps/s
[Step=19000 Epoch=18.6] | Loss=0.01494 | Reg=0.00218 | L2-Norm=14.769 | L2-Norm(final)=2.761 | acc=1.0000 | 4574.0 samples/s | 71.5 steps/s
[Step=19050 Epoch=18.6] | Loss=0.01458 | Reg=0.00218 | L2-Norm=14.771 | L2-Norm(final)=2.763 | acc=1.0000 | 4629.3 samples/s | 72.3 steps/s
[Step=19100 Epoch=18.6] | Loss=0.01435 | Reg=0.00218 | L2-Norm=14.773 | L2-Norm(final)=2.765 | acc=1.0000 | 4559.7 samples/s | 71.2 steps/s
[Step=19150 Epoch=18.7] | Loss=0.01398 | Reg=0.00218 | L2-Norm=14.775 | L2-Norm(final)=2.767 | acc=0.9844 | 4113.9 samples/s | 64.3 steps/s
[Step=19200 Epoch=18.7] | Loss=0.01399 | Reg=0.00218 | L2-Norm=14.777 | L2-Norm(final)=2.769 | acc=1.0000 | 3965.0 samples/s | 62.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step19200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=18401 Epoch=34.7] | Loss=0.00170 | Reg=0.00216 | L2-Norm=14.680 | L2-Norm(final)=2.746 | acc=1.0000 | 3159.1 samples/s | 49.4 steps/s
[Step=18450 Epoch=34.8] | Loss=0.00381 | Reg=0.00217 | L2-Norm=14.726 | L2-Norm(final)=2.748 | acc=1.0000 | 4198.5 samples/s | 65.6 steps/s
[Step=18500 Epoch=34.9] | Loss=0.00199 | Reg=0.00217 | L2-Norm=14.741 | L2-Norm(final)=2.749 | acc=1.0000 | 4480.8 samples/s | 70.0 steps/s
[Step=18550 Epoch=35.0] | Loss=0.00133 | Reg=0.00217 | L2-Norm=14.744 | L2-Norm(final)=2.750 | acc=1.0000 | 4234.4 samples/s | 66.2 steps/s
[Step=18600 Epoch=35.1] | Loss=0.00101 | Reg=0.00217 | L2-Norm=14.743 | L2-Norm(final)=2.752 | acc=1.0000 | 4437.4 samples/s | 69.3 steps/s
[Step=18650 Epoch=35.2] | Loss=0.00081 | Reg=0.00217 | L2-Norm=14.741 | L2-Norm(final)=2.753 | acc=1.0000 | 4465.1 samples/s | 69.8 steps/s
[Step=18700 Epoch=35.2] | Loss=0.00068 | Reg=0.00217 | L2-Norm=14.737 | L2-Norm(final)=2.754 | acc=1.0000 | 4352.0 samples/s | 68.0 steps/s
[Step=18750 Epoch=35.3] | Loss=0.00058 | Reg=0.00217 | L2-Norm=14.733 | L2-Norm(final)=2.755 | acc=1.0000 | 4442.5 samples/s | 69.4 steps/s
[Step=18800 Epoch=35.4] | Loss=0.00051 | Reg=0.00217 | L2-Norm=14.729 | L2-Norm(final)=2.756 | acc=1.0000 | 4248.1 samples/s | 66.4 steps/s
[Step=18850 Epoch=35.5] | Loss=0.00046 | Reg=0.00217 | L2-Norm=14.724 | L2-Norm(final)=2.757 | acc=1.0000 | 4459.8 samples/s | 69.7 steps/s
[Step=18900 Epoch=35.6] | Loss=0.00041 | Reg=0.00217 | L2-Norm=14.719 | L2-Norm(final)=2.758 | acc=1.0000 | 4731.5 samples/s | 73.9 steps/s
[Step=18950 Epoch=35.7] | Loss=0.00038 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.759 | acc=1.0000 | 1728.8 samples/s | 27.0 steps/s
[Step=19000 Epoch=35.8] | Loss=0.00035 | Reg=0.00216 | L2-Norm=14.710 | L2-Norm(final)=2.760 | acc=1.0000 | 4561.5 samples/s | 71.3 steps/s
[Step=19050 Epoch=35.9] | Loss=0.00032 | Reg=0.00216 | L2-Norm=14.704 | L2-Norm(final)=2.761 | acc=1.0000 | 4311.6 samples/s | 67.4 steps/s
[Step=19100 Epoch=36.0] | Loss=0.00030 | Reg=0.00216 | L2-Norm=14.699 | L2-Norm(final)=2.762 | acc=1.0000 | 4466.1 samples/s | 69.8 steps/s
[Step=19150 Epoch=36.1] | Loss=0.00028 | Reg=0.00216 | L2-Norm=14.694 | L2-Norm(final)=2.763 | acc=1.0000 | 4422.7 samples/s | 69.1 steps/s
[Step=19200 Epoch=36.2] | Loss=0.00026 | Reg=0.00216 | L2-Norm=14.688 | L2-Norm(final)=2.764 | acc=1.0000 | 4305.3 samples/s | 67.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31981 | acc=0.8127 | tpr=0.7308 | fpr=0.0097 | 4509.8 samples/s | 17.6 steps/s
Avg test loss: 0.31747, Avg test acc: 0.81220, Avg tpr: 0.73131, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.44838 | acc=0.8641 | tpr=0.9690 | fpr=0.1377 | 4483.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.44651 | acc=0.8660 | tpr=0.9787 | fpr=0.1361 | 8872.5 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.46027 | acc=0.8634 | tpr=0.9841 | fpr=0.1388 | 9044.4 samples/s | 35.3 steps/s
[Step= 200] | Loss=0.46326 | acc=0.8636 | tpr=0.9836 | fpr=0.1386 | 8525.9 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.46322 | acc=0.8631 | tpr=0.9808 | fpr=0.1390 | 9122.6 samples/s | 35.6 steps/s
[Step= 300] | Loss=0.46661 | acc=0.8632 | tpr=0.9818 | fpr=0.1390 | 9055.3 samples/s | 35.4 steps/s
[Step= 350] | Loss=0.46714 | acc=0.8628 | tpr=0.9818 | fpr=0.1393 | 8976.0 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.47040 | acc=0.8625 | tpr=0.9825 | fpr=0.1397 | 9334.1 samples/s | 36.5 steps/s
[Step= 450] | Loss=0.47402 | acc=0.8623 | tpr=0.9820 | fpr=0.1399 | 8484.8 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.47350 | acc=0.8621 | tpr=0.9819 | fpr=0.1400 | 8426.6 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.47256 | acc=0.8624 | tpr=0.9817 | fpr=0.1398 | 16135.8 samples/s | 63.0 steps/s
Avg test loss: 0.47222, Avg test acc: 0.86243, Avg tpr: 0.98177, Avg fpr: 0.13974, total FA: 19403

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=18.7] | Loss=0.11001 | Reg=0.00215 | L2-Norm=14.652 | L2-Norm(final)=2.786 | acc=0.9219 | 3443.4 samples/s | 53.8 steps/s
[Step=19250 Epoch=18.8] | Loss=0.02686 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=2.782 | acc=0.9688 | 4482.2 samples/s | 70.0 steps/s
[Step=19300 Epoch=18.8] | Loss=0.02057 | Reg=0.00216 | L2-Norm=14.710 | L2-Norm(final)=2.786 | acc=1.0000 | 4686.8 samples/s | 73.2 steps/s
[Step=19350 Epoch=18.9] | Loss=0.01716 | Reg=0.00217 | L2-Norm=14.717 | L2-Norm(final)=2.790 | acc=1.0000 | 4582.4 samples/s | 71.6 steps/s
[Step=19400 Epoch=18.9] | Loss=0.01572 | Reg=0.00217 | L2-Norm=14.722 | L2-Norm(final)=2.793 | acc=1.0000 | 4686.2 samples/s | 73.2 steps/s
[Step=19450 Epoch=19.0] | Loss=0.01530 | Reg=0.00217 | L2-Norm=14.726 | L2-Norm(final)=2.795 | acc=0.9844 | 4685.8 samples/s | 73.2 steps/s
[Step=19500 Epoch=19.0] | Loss=0.01478 | Reg=0.00217 | L2-Norm=14.729 | L2-Norm(final)=2.798 | acc=0.9844 | 4469.2 samples/s | 69.8 steps/s
[Step=19550 Epoch=19.1] | Loss=0.01441 | Reg=0.00217 | L2-Norm=14.732 | L2-Norm(final)=2.800 | acc=0.9688 | 4602.5 samples/s | 71.9 steps/s
[Step=19600 Epoch=19.1] | Loss=0.01406 | Reg=0.00217 | L2-Norm=14.734 | L2-Norm(final)=2.802 | acc=1.0000 | 4770.6 samples/s | 74.5 steps/s
[Step=19650 Epoch=19.2] | Loss=0.01381 | Reg=0.00217 | L2-Norm=14.736 | L2-Norm(final)=2.804 | acc=1.0000 | 4539.5 samples/s | 70.9 steps/s
[Step=19700 Epoch=19.2] | Loss=0.01338 | Reg=0.00217 | L2-Norm=14.737 | L2-Norm(final)=2.806 | acc=1.0000 | 4866.8 samples/s | 76.0 steps/s
[Step=19750 Epoch=19.3] | Loss=0.01320 | Reg=0.00217 | L2-Norm=14.739 | L2-Norm(final)=2.808 | acc=1.0000 | 4463.5 samples/s | 69.7 steps/s
[Step=19800 Epoch=19.3] | Loss=0.01326 | Reg=0.00217 | L2-Norm=14.741 | L2-Norm(final)=2.809 | acc=0.9844 | 4428.7 samples/s | 69.2 steps/s
[Step=19850 Epoch=19.4] | Loss=0.01367 | Reg=0.00217 | L2-Norm=14.742 | L2-Norm(final)=2.810 | acc=0.9844 | 4647.0 samples/s | 72.6 steps/s
[Step=19900 Epoch=19.4] | Loss=0.01335 | Reg=0.00217 | L2-Norm=14.743 | L2-Norm(final)=2.812 | acc=0.9844 | 4657.5 samples/s | 72.8 steps/s
[Step=19950 Epoch=19.5] | Loss=0.01322 | Reg=0.00217 | L2-Norm=14.745 | L2-Norm(final)=2.813 | acc=1.0000 | 4498.4 samples/s | 70.3 steps/s
[Step=20000 Epoch=19.5] | Loss=0.01324 | Reg=0.00217 | L2-Norm=14.746 | L2-Norm(final)=2.815 | acc=1.0000 | 4707.1 samples/s | 73.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=19201 Epoch=36.2] | Loss=0.05403 | Reg=0.00215 | L2-Norm=14.652 | L2-Norm(final)=2.786 | acc=0.9688 | 3340.1 samples/s | 52.2 steps/s
[Step=19250 Epoch=36.3] | Loss=0.00425 | Reg=0.00216 | L2-Norm=14.705 | L2-Norm(final)=2.783 | acc=1.0000 | 4028.2 samples/s | 62.9 steps/s
[Step=19300 Epoch=36.4] | Loss=0.00227 | Reg=0.00217 | L2-Norm=14.714 | L2-Norm(final)=2.782 | acc=1.0000 | 4356.2 samples/s | 68.1 steps/s
[Step=19350 Epoch=36.5] | Loss=0.00155 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.783 | acc=1.0000 | 4331.9 samples/s | 67.7 steps/s
[Step=19400 Epoch=36.6] | Loss=0.00117 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=2.784 | acc=1.0000 | 4370.4 samples/s | 68.3 steps/s
[Step=19450 Epoch=36.7] | Loss=0.00094 | Reg=0.00216 | L2-Norm=14.710 | L2-Norm(final)=2.785 | acc=1.0000 | 4177.5 samples/s | 65.3 steps/s
[Step=19500 Epoch=36.8] | Loss=0.00079 | Reg=0.00216 | L2-Norm=14.706 | L2-Norm(final)=2.785 | acc=1.0000 | 4514.4 samples/s | 70.5 steps/s
[Step=19550 Epoch=36.9] | Loss=0.00068 | Reg=0.00216 | L2-Norm=14.701 | L2-Norm(final)=2.786 | acc=1.0000 | 4477.5 samples/s | 70.0 steps/s
[Step=19600 Epoch=36.9] | Loss=0.00060 | Reg=0.00216 | L2-Norm=14.696 | L2-Norm(final)=2.787 | acc=1.0000 | 4516.9 samples/s | 70.6 steps/s
[Step=19650 Epoch=37.0] | Loss=0.00053 | Reg=0.00216 | L2-Norm=14.692 | L2-Norm(final)=2.788 | acc=1.0000 | 4411.5 samples/s | 68.9 steps/s
[Step=19700 Epoch=37.1] | Loss=0.00048 | Reg=0.00216 | L2-Norm=14.687 | L2-Norm(final)=2.789 | acc=1.0000 | 4499.3 samples/s | 70.3 steps/s
[Step=19750 Epoch=37.2] | Loss=0.00044 | Reg=0.00216 | L2-Norm=14.682 | L2-Norm(final)=2.789 | acc=1.0000 | 1444.2 samples/s | 22.6 steps/s
[Step=19800 Epoch=37.3] | Loss=0.00040 | Reg=0.00215 | L2-Norm=14.676 | L2-Norm(final)=2.790 | acc=1.0000 | 4509.2 samples/s | 70.5 steps/s
[Step=19850 Epoch=37.4] | Loss=0.00037 | Reg=0.00215 | L2-Norm=14.671 | L2-Norm(final)=2.791 | acc=1.0000 | 4375.9 samples/s | 68.4 steps/s
[Step=19900 Epoch=37.5] | Loss=0.00034 | Reg=0.00215 | L2-Norm=14.666 | L2-Norm(final)=2.792 | acc=1.0000 | 4437.9 samples/s | 69.3 steps/s
[Step=19950 Epoch=37.6] | Loss=0.00032 | Reg=0.00215 | L2-Norm=14.660 | L2-Norm(final)=2.793 | acc=1.0000 | 4380.7 samples/s | 68.4 steps/s
[Step=20000 Epoch=37.7] | Loss=0.00030 | Reg=0.00215 | L2-Norm=14.655 | L2-Norm(final)=2.793 | acc=1.0000 | 4501.4 samples/s | 70.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36078 | acc=0.7973 | tpr=0.7081 | fpr=0.0092 | 4500.9 samples/s | 17.6 steps/s
Avg test loss: 0.36015, Avg test acc: 0.79678, Avg tpr: 0.70869, Avg fpr: 0.00949, total FA: 74

Testing server on iccad2012
[Step=  50] | Loss=0.39812 | acc=0.8881 | tpr=0.9646 | fpr=0.1132 | 4560.5 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.39663 | acc=0.8902 | tpr=0.9744 | fpr=0.1114 | 9075.5 samples/s | 35.5 steps/s
[Step= 150] | Loss=0.40989 | acc=0.8876 | tpr=0.9798 | fpr=0.1141 | 9091.5 samples/s | 35.5 steps/s
[Step= 200] | Loss=0.41215 | acc=0.8874 | tpr=0.9803 | fpr=0.1142 | 9119.4 samples/s | 35.6 steps/s
[Step= 250] | Loss=0.41163 | acc=0.8872 | tpr=0.9790 | fpr=0.1145 | 8781.7 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.41480 | acc=0.8868 | tpr=0.9796 | fpr=0.1148 | 8794.0 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.41455 | acc=0.8870 | tpr=0.9800 | fpr=0.1147 | 9382.4 samples/s | 36.7 steps/s
[Step= 400] | Loss=0.41840 | acc=0.8864 | tpr=0.9798 | fpr=0.1153 | 8417.4 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.42235 | acc=0.8864 | tpr=0.9796 | fpr=0.1153 | 9041.7 samples/s | 35.3 steps/s
[Step= 500] | Loss=0.42137 | acc=0.8863 | tpr=0.9797 | fpr=0.1154 | 8730.5 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.42026 | acc=0.8865 | tpr=0.9793 | fpr=0.1152 | 17071.9 samples/s | 66.7 steps/s
Avg test loss: 0.41981, Avg test acc: 0.88651, Avg tpr: 0.97940, Avg fpr: 0.11518, total FA: 15992

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=19.5] | Loss=0.26780 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=2.817 | acc=0.8281 | 3636.8 samples/s | 56.8 steps/s
[Step=20050 Epoch=19.6] | Loss=0.03111 | Reg=0.00215 | L2-Norm=14.662 | L2-Norm(final)=2.811 | acc=0.9844 | 4612.0 samples/s | 72.1 steps/s
[Step=20100 Epoch=19.6] | Loss=0.02160 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=2.815 | acc=1.0000 | 4853.0 samples/s | 75.8 steps/s
[Step=20150 Epoch=19.7] | Loss=0.01855 | Reg=0.00216 | L2-Norm=14.685 | L2-Norm(final)=2.819 | acc=1.0000 | 4572.8 samples/s | 71.5 steps/s
[Step=20200 Epoch=19.7] | Loss=0.01745 | Reg=0.00216 | L2-Norm=14.691 | L2-Norm(final)=2.822 | acc=0.9844 | 4489.7 samples/s | 70.2 steps/s
[Step=20250 Epoch=19.8] | Loss=0.01700 | Reg=0.00216 | L2-Norm=14.694 | L2-Norm(final)=2.824 | acc=0.9844 | 4584.0 samples/s | 71.6 steps/s
[Step=20300 Epoch=19.8] | Loss=0.01643 | Reg=0.00216 | L2-Norm=14.698 | L2-Norm(final)=2.826 | acc=0.9844 | 4522.3 samples/s | 70.7 steps/s
[Step=20350 Epoch=19.9] | Loss=0.01548 | Reg=0.00216 | L2-Norm=14.700 | L2-Norm(final)=2.828 | acc=1.0000 | 4480.1 samples/s | 70.0 steps/s
[Step=20400 Epoch=19.9] | Loss=0.01518 | Reg=0.00216 | L2-Norm=14.703 | L2-Norm(final)=2.830 | acc=0.9844 | 4836.8 samples/s | 75.6 steps/s
[Step=20450 Epoch=20.0] | Loss=0.01458 | Reg=0.00216 | L2-Norm=14.705 | L2-Norm(final)=2.832 | acc=1.0000 | 4563.6 samples/s | 71.3 steps/s
[Step=20500 Epoch=20.0] | Loss=0.01426 | Reg=0.00216 | L2-Norm=14.707 | L2-Norm(final)=2.834 | acc=0.9688 | 4580.3 samples/s | 71.6 steps/s
[Step=20550 Epoch=20.1] | Loss=0.01416 | Reg=0.00216 | L2-Norm=14.709 | L2-Norm(final)=2.836 | acc=1.0000 | 4643.0 samples/s | 72.5 steps/s
[Step=20600 Epoch=20.1] | Loss=0.01409 | Reg=0.00216 | L2-Norm=14.711 | L2-Norm(final)=2.837 | acc=0.9844 | 4497.5 samples/s | 70.3 steps/s
[Step=20650 Epoch=20.2] | Loss=0.01392 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=2.839 | acc=0.9844 | 4687.3 samples/s | 73.2 steps/s
[Step=20700 Epoch=20.2] | Loss=0.01351 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.841 | acc=1.0000 | 4650.8 samples/s | 72.7 steps/s
[Step=20750 Epoch=20.3] | Loss=0.01310 | Reg=0.00217 | L2-Norm=14.716 | L2-Norm(final)=2.844 | acc=1.0000 | 4613.4 samples/s | 72.1 steps/s
[Step=20800 Epoch=20.3] | Loss=0.01291 | Reg=0.00217 | L2-Norm=14.718 | L2-Norm(final)=2.846 | acc=0.9844 | 4531.4 samples/s | 70.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20001 Epoch=37.7] | Loss=0.00631 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=2.818 | acc=1.0000 | 3306.7 samples/s | 51.7 steps/s
[Step=20050 Epoch=37.8] | Loss=0.00245 | Reg=0.00215 | L2-Norm=14.657 | L2-Norm(final)=2.822 | acc=1.0000 | 4164.0 samples/s | 65.1 steps/s
[Step=20100 Epoch=37.9] | Loss=0.00129 | Reg=0.00215 | L2-Norm=14.664 | L2-Norm(final)=2.824 | acc=1.0000 | 4301.1 samples/s | 67.2 steps/s
[Step=20150 Epoch=38.0] | Loss=0.00087 | Reg=0.00215 | L2-Norm=14.663 | L2-Norm(final)=2.826 | acc=1.0000 | 4340.7 samples/s | 67.8 steps/s
[Step=20200 Epoch=38.1] | Loss=0.00065 | Reg=0.00215 | L2-Norm=14.659 | L2-Norm(final)=2.827 | acc=1.0000 | 4459.9 samples/s | 69.7 steps/s
[Step=20250 Epoch=38.2] | Loss=0.00053 | Reg=0.00215 | L2-Norm=14.655 | L2-Norm(final)=2.828 | acc=1.0000 | 4496.3 samples/s | 70.3 steps/s
[Step=20300 Epoch=38.3] | Loss=0.00045 | Reg=0.00215 | L2-Norm=14.650 | L2-Norm(final)=2.829 | acc=1.0000 | 4503.4 samples/s | 70.4 steps/s
[Step=20350 Epoch=38.4] | Loss=0.00039 | Reg=0.00214 | L2-Norm=14.645 | L2-Norm(final)=2.830 | acc=1.0000 | 4545.6 samples/s | 71.0 steps/s
[Step=20400 Epoch=38.5] | Loss=0.00034 | Reg=0.00214 | L2-Norm=14.640 | L2-Norm(final)=2.831 | acc=1.0000 | 4630.5 samples/s | 72.4 steps/s
[Step=20450 Epoch=38.5] | Loss=0.00031 | Reg=0.00214 | L2-Norm=14.635 | L2-Norm(final)=2.832 | acc=1.0000 | 4466.8 samples/s | 69.8 steps/s
[Step=20500 Epoch=38.6] | Loss=0.00028 | Reg=0.00214 | L2-Norm=14.629 | L2-Norm(final)=2.832 | acc=1.0000 | 4326.7 samples/s | 67.6 steps/s
[Step=20550 Epoch=38.7] | Loss=0.00026 | Reg=0.00214 | L2-Norm=14.624 | L2-Norm(final)=2.833 | acc=1.0000 | 1523.3 samples/s | 23.8 steps/s
[Step=20600 Epoch=38.8] | Loss=0.00024 | Reg=0.00214 | L2-Norm=14.618 | L2-Norm(final)=2.834 | acc=1.0000 | 4393.0 samples/s | 68.6 steps/s
[Step=20650 Epoch=38.9] | Loss=0.00022 | Reg=0.00214 | L2-Norm=14.613 | L2-Norm(final)=2.834 | acc=1.0000 | 4402.4 samples/s | 68.8 steps/s
[Step=20700 Epoch=39.0] | Loss=0.00020 | Reg=0.00213 | L2-Norm=14.607 | L2-Norm(final)=2.835 | acc=1.0000 | 4342.6 samples/s | 67.9 steps/s
[Step=20750 Epoch=39.1] | Loss=0.00019 | Reg=0.00213 | L2-Norm=14.601 | L2-Norm(final)=2.836 | acc=1.0000 | 4304.0 samples/s | 67.3 steps/s
[Step=20800 Epoch=39.2] | Loss=0.00018 | Reg=0.00213 | L2-Norm=14.595 | L2-Norm(final)=2.836 | acc=1.0000 | 4346.5 samples/s | 67.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33183 | acc=0.8163 | tpr=0.7356 | fpr=0.0084 | 4548.0 samples/s | 17.8 steps/s
Avg test loss: 0.33173, Avg test acc: 0.81529, Avg tpr: 0.73550, Avg fpr: 0.00923, total FA: 72

Testing server on iccad2012
[Step=  50] | Loss=0.49633 | acc=0.8638 | tpr=0.9735 | fpr=0.1381 | 4415.4 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.49515 | acc=0.8654 | tpr=0.9808 | fpr=0.1368 | 8965.4 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.51150 | acc=0.8629 | tpr=0.9856 | fpr=0.1394 | 8948.0 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.51359 | acc=0.8630 | tpr=0.9847 | fpr=0.1392 | 9008.3 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.51352 | acc=0.8626 | tpr=0.9817 | fpr=0.1396 | 9012.2 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.51775 | acc=0.8619 | tpr=0.9811 | fpr=0.1403 | 9234.8 samples/s | 36.1 steps/s
[Step= 350] | Loss=0.51735 | acc=0.8618 | tpr=0.9818 | fpr=0.1404 | 8911.2 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.52106 | acc=0.8613 | tpr=0.9819 | fpr=0.1409 | 9127.8 samples/s | 35.7 steps/s
[Step= 450] | Loss=0.52549 | acc=0.8611 | tpr=0.9820 | fpr=0.1411 | 8793.0 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.52468 | acc=0.8608 | tpr=0.9819 | fpr=0.1413 | 9005.5 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.52311 | acc=0.8611 | tpr=0.9817 | fpr=0.1411 | 15736.5 samples/s | 61.5 steps/s
Avg test loss: 0.52266, Avg test acc: 0.86113, Avg tpr: 0.98177, Avg fpr: 0.14106, total FA: 19586

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=20.3] | Loss=0.25633 | Reg=0.00212 | L2-Norm=14.576 | L2-Norm(final)=2.862 | acc=0.8750 | 3600.7 samples/s | 56.3 steps/s
[Step=20850 Epoch=20.4] | Loss=0.03446 | Reg=0.00214 | L2-Norm=14.616 | L2-Norm(final)=2.854 | acc=1.0000 | 4268.4 samples/s | 66.7 steps/s
[Step=20900 Epoch=20.4] | Loss=0.02326 | Reg=0.00214 | L2-Norm=14.629 | L2-Norm(final)=2.856 | acc=1.0000 | 4564.1 samples/s | 71.3 steps/s
[Step=20950 Epoch=20.5] | Loss=0.01853 | Reg=0.00214 | L2-Norm=14.636 | L2-Norm(final)=2.860 | acc=1.0000 | 4781.7 samples/s | 74.7 steps/s
[Step=21000 Epoch=20.5] | Loss=0.01725 | Reg=0.00214 | L2-Norm=14.640 | L2-Norm(final)=2.863 | acc=0.9688 | 4644.5 samples/s | 72.6 steps/s
[Step=21050 Epoch=20.6] | Loss=0.01585 | Reg=0.00214 | L2-Norm=14.644 | L2-Norm(final)=2.866 | acc=1.0000 | 4525.0 samples/s | 70.7 steps/s
[Step=21100 Epoch=20.6] | Loss=0.01501 | Reg=0.00215 | L2-Norm=14.647 | L2-Norm(final)=2.869 | acc=1.0000 | 4686.3 samples/s | 73.2 steps/s
[Step=21150 Epoch=20.6] | Loss=0.01481 | Reg=0.00215 | L2-Norm=14.649 | L2-Norm(final)=2.871 | acc=1.0000 | 4581.9 samples/s | 71.6 steps/s
[Step=21200 Epoch=20.7] | Loss=0.01442 | Reg=0.00215 | L2-Norm=14.652 | L2-Norm(final)=2.873 | acc=0.9688 | 4783.0 samples/s | 74.7 steps/s
[Step=21250 Epoch=20.7] | Loss=0.01404 | Reg=0.00215 | L2-Norm=14.654 | L2-Norm(final)=2.876 | acc=0.9688 | 4664.2 samples/s | 72.9 steps/s
[Step=21300 Epoch=20.8] | Loss=0.01381 | Reg=0.00215 | L2-Norm=14.656 | L2-Norm(final)=2.878 | acc=1.0000 | 4533.8 samples/s | 70.8 steps/s
[Step=21350 Epoch=20.8] | Loss=0.01378 | Reg=0.00215 | L2-Norm=14.658 | L2-Norm(final)=2.880 | acc=1.0000 | 4614.2 samples/s | 72.1 steps/s
[Step=21400 Epoch=20.9] | Loss=0.01355 | Reg=0.00215 | L2-Norm=14.660 | L2-Norm(final)=2.882 | acc=0.9844 | 4719.3 samples/s | 73.7 steps/s
[Step=21450 Epoch=20.9] | Loss=0.01327 | Reg=0.00215 | L2-Norm=14.662 | L2-Norm(final)=2.884 | acc=1.0000 | 4577.7 samples/s | 71.5 steps/s
[Step=21500 Epoch=21.0] | Loss=0.01314 | Reg=0.00215 | L2-Norm=14.664 | L2-Norm(final)=2.886 | acc=0.9844 | 4678.4 samples/s | 73.1 steps/s
[Step=21550 Epoch=21.0] | Loss=0.01313 | Reg=0.00215 | L2-Norm=14.666 | L2-Norm(final)=2.888 | acc=1.0000 | 4750.9 samples/s | 74.2 steps/s
[Step=21600 Epoch=21.1] | Loss=0.01321 | Reg=0.00215 | L2-Norm=14.668 | L2-Norm(final)=2.889 | acc=0.9844 | 4598.5 samples/s | 71.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step21600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=20801 Epoch=39.2] | Loss=0.07555 | Reg=0.00212 | L2-Norm=14.576 | L2-Norm(final)=2.861 | acc=0.9688 | 3378.7 samples/s | 52.8 steps/s
[Step=20850 Epoch=39.3] | Loss=0.00505 | Reg=0.00214 | L2-Norm=14.618 | L2-Norm(final)=2.850 | acc=1.0000 | 4683.7 samples/s | 73.2 steps/s
[Step=20900 Epoch=39.4] | Loss=0.00300 | Reg=0.00214 | L2-Norm=14.631 | L2-Norm(final)=2.848 | acc=1.0000 | 4513.6 samples/s | 70.5 steps/s
[Step=20950 Epoch=39.5] | Loss=0.00204 | Reg=0.00214 | L2-Norm=14.634 | L2-Norm(final)=2.848 | acc=1.0000 | 4392.1 samples/s | 68.6 steps/s
[Step=21000 Epoch=39.6] | Loss=0.00154 | Reg=0.00214 | L2-Norm=14.634 | L2-Norm(final)=2.849 | acc=1.0000 | 4464.4 samples/s | 69.8 steps/s
[Step=21050 Epoch=39.7] | Loss=0.00123 | Reg=0.00214 | L2-Norm=14.632 | L2-Norm(final)=2.850 | acc=1.0000 | 4384.4 samples/s | 68.5 steps/s
[Step=21100 Epoch=39.8] | Loss=0.00104 | Reg=0.00214 | L2-Norm=14.629 | L2-Norm(final)=2.850 | acc=1.0000 | 4580.8 samples/s | 71.6 steps/s
[Step=21150 Epoch=39.9] | Loss=0.00089 | Reg=0.00214 | L2-Norm=14.625 | L2-Norm(final)=2.851 | acc=1.0000 | 4447.2 samples/s | 69.5 steps/s
[Step=21200 Epoch=40.0] | Loss=0.00078 | Reg=0.00214 | L2-Norm=14.622 | L2-Norm(final)=2.852 | acc=1.0000 | 4399.8 samples/s | 68.7 steps/s
[Step=21250 Epoch=40.1] | Loss=0.00072 | Reg=0.00214 | L2-Norm=14.618 | L2-Norm(final)=2.852 | acc=1.0000 | 4537.4 samples/s | 70.9 steps/s
[Step=21300 Epoch=40.2] | Loss=0.00065 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=2.853 | acc=1.0000 | 4515.1 samples/s | 70.5 steps/s
[Step=21350 Epoch=40.2] | Loss=0.00059 | Reg=0.00213 | L2-Norm=14.610 | L2-Norm(final)=2.854 | acc=1.0000 | 1545.7 samples/s | 24.2 steps/s
[Step=21400 Epoch=40.3] | Loss=0.00054 | Reg=0.00213 | L2-Norm=14.605 | L2-Norm(final)=2.854 | acc=1.0000 | 4381.1 samples/s | 68.5 steps/s
[Step=21450 Epoch=40.4] | Loss=0.00050 | Reg=0.00213 | L2-Norm=14.601 | L2-Norm(final)=2.855 | acc=1.0000 | 4287.9 samples/s | 67.0 steps/s
[Step=21500 Epoch=40.5] | Loss=0.00046 | Reg=0.00213 | L2-Norm=14.596 | L2-Norm(final)=2.855 | acc=1.0000 | 4387.3 samples/s | 68.6 steps/s
[Step=21550 Epoch=40.6] | Loss=0.00043 | Reg=0.00213 | L2-Norm=14.592 | L2-Norm(final)=2.856 | acc=1.0000 | 4486.3 samples/s | 70.1 steps/s
[Step=21600 Epoch=40.7] | Loss=0.00041 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=2.856 | acc=1.0000 | 4409.4 samples/s | 68.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31628 | acc=0.8152 | tpr=0.7332 | fpr=0.0067 | 4429.6 samples/s | 17.3 steps/s
Avg test loss: 0.31625, Avg test acc: 0.81553, Avg tpr: 0.73509, Avg fpr: 0.00756, total FA: 59

Testing server on iccad2012
[Step=  50] | Loss=0.49617 | acc=0.8698 | tpr=0.9735 | fpr=0.1321 | 4532.8 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.49769 | acc=0.8721 | tpr=0.9808 | fpr=0.1300 | 8573.7 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.51423 | acc=0.8693 | tpr=0.9856 | fpr=0.1328 | 9141.3 samples/s | 35.7 steps/s
[Step= 200] | Loss=0.51801 | acc=0.8692 | tpr=0.9847 | fpr=0.1329 | 9259.4 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.51726 | acc=0.8686 | tpr=0.9825 | fpr=0.1335 | 8927.9 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.52129 | acc=0.8681 | tpr=0.9833 | fpr=0.1340 | 9044.4 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.52066 | acc=0.8682 | tpr=0.9837 | fpr=0.1339 | 8862.8 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.52434 | acc=0.8676 | tpr=0.9830 | fpr=0.1345 | 9117.2 samples/s | 35.6 steps/s
[Step= 450] | Loss=0.52977 | acc=0.8672 | tpr=0.9830 | fpr=0.1349 | 8738.2 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.52901 | acc=0.8670 | tpr=0.9833 | fpr=0.1351 | 9532.0 samples/s | 37.2 steps/s
[Step= 550] | Loss=0.52756 | acc=0.8674 | tpr=0.9833 | fpr=0.1347 | 15742.2 samples/s | 61.5 steps/s
Avg test loss: 0.52702, Avg test acc: 0.86749, Avg tpr: 0.98336, Avg fpr: 0.13461, total FA: 18691

server round 27/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=21.1] | Loss=0.26131 | Reg=0.00212 | L2-Norm=14.552 | L2-Norm(final)=2.885 | acc=0.8438 | 3583.2 samples/s | 56.0 steps/s
[Step=21650 Epoch=21.1] | Loss=0.03021 | Reg=0.00213 | L2-Norm=14.595 | L2-Norm(final)=2.877 | acc=0.9688 | 4592.5 samples/s | 71.8 steps/s
[Step=21700 Epoch=21.2] | Loss=0.01969 | Reg=0.00213 | L2-Norm=14.607 | L2-Norm(final)=2.880 | acc=0.9844 | 4745.8 samples/s | 74.2 steps/s
[Step=21750 Epoch=21.2] | Loss=0.01594 | Reg=0.00214 | L2-Norm=14.613 | L2-Norm(final)=2.883 | acc=1.0000 | 4589.1 samples/s | 71.7 steps/s
[Step=21800 Epoch=21.3] | Loss=0.01509 | Reg=0.00214 | L2-Norm=14.617 | L2-Norm(final)=2.886 | acc=0.9531 | 4689.6 samples/s | 73.3 steps/s
[Step=21850 Epoch=21.3] | Loss=0.01430 | Reg=0.00214 | L2-Norm=14.621 | L2-Norm(final)=2.888 | acc=1.0000 | 4661.8 samples/s | 72.8 steps/s
[Step=21900 Epoch=21.4] | Loss=0.01432 | Reg=0.00214 | L2-Norm=14.624 | L2-Norm(final)=2.891 | acc=0.9844 | 4618.1 samples/s | 72.2 steps/s
[Step=21950 Epoch=21.4] | Loss=0.01369 | Reg=0.00214 | L2-Norm=14.627 | L2-Norm(final)=2.893 | acc=1.0000 | 4791.6 samples/s | 74.9 steps/s
[Step=22000 Epoch=21.5] | Loss=0.01374 | Reg=0.00214 | L2-Norm=14.629 | L2-Norm(final)=2.895 | acc=0.9844 | 4630.3 samples/s | 72.3 steps/s
[Step=22050 Epoch=21.5] | Loss=0.01366 | Reg=0.00214 | L2-Norm=14.632 | L2-Norm(final)=2.896 | acc=1.0000 | 4658.9 samples/s | 72.8 steps/s
[Step=22100 Epoch=21.6] | Loss=0.01348 | Reg=0.00214 | L2-Norm=14.634 | L2-Norm(final)=2.898 | acc=1.0000 | 4647.9 samples/s | 72.6 steps/s
[Step=22150 Epoch=21.6] | Loss=0.01347 | Reg=0.00214 | L2-Norm=14.636 | L2-Norm(final)=2.900 | acc=1.0000 | 4773.7 samples/s | 74.6 steps/s
[Step=22200 Epoch=21.7] | Loss=0.01340 | Reg=0.00214 | L2-Norm=14.639 | L2-Norm(final)=2.901 | acc=0.9688 | 4754.9 samples/s | 74.3 steps/s
[Step=22250 Epoch=21.7] | Loss=0.01338 | Reg=0.00214 | L2-Norm=14.641 | L2-Norm(final)=2.903 | acc=1.0000 | 4703.6 samples/s | 73.5 steps/s
[Step=22300 Epoch=21.8] | Loss=0.01323 | Reg=0.00214 | L2-Norm=14.643 | L2-Norm(final)=2.905 | acc=1.0000 | 4691.7 samples/s | 73.3 steps/s
[Step=22350 Epoch=21.8] | Loss=0.01313 | Reg=0.00214 | L2-Norm=14.645 | L2-Norm(final)=2.907 | acc=1.0000 | 4711.3 samples/s | 73.6 steps/s
[Step=22400 Epoch=21.9] | Loss=0.01304 | Reg=0.00215 | L2-Norm=14.647 | L2-Norm(final)=2.909 | acc=0.9688 | 4059.1 samples/s | 63.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step22400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=21601 Epoch=40.7] | Loss=0.05531 | Reg=0.00212 | L2-Norm=14.552 | L2-Norm(final)=2.886 | acc=0.9844 | 3181.0 samples/s | 49.7 steps/s
[Step=21650 Epoch=40.8] | Loss=0.00260 | Reg=0.00213 | L2-Norm=14.581 | L2-Norm(final)=2.887 | acc=1.0000 | 4532.1 samples/s | 70.8 steps/s
[Step=21700 Epoch=40.9] | Loss=0.00135 | Reg=0.00213 | L2-Norm=14.586 | L2-Norm(final)=2.888 | acc=1.0000 | 4263.9 samples/s | 66.6 steps/s
[Step=21750 Epoch=41.0] | Loss=0.00093 | Reg=0.00213 | L2-Norm=14.585 | L2-Norm(final)=2.890 | acc=1.0000 | 4344.0 samples/s | 67.9 steps/s
[Step=21800 Epoch=41.1] | Loss=0.00071 | Reg=0.00213 | L2-Norm=14.583 | L2-Norm(final)=2.892 | acc=1.0000 | 4465.0 samples/s | 69.8 steps/s
[Step=21850 Epoch=41.2] | Loss=0.00057 | Reg=0.00213 | L2-Norm=14.579 | L2-Norm(final)=2.893 | acc=1.0000 | 4404.0 samples/s | 68.8 steps/s
[Step=21900 Epoch=41.3] | Loss=0.00048 | Reg=0.00212 | L2-Norm=14.575 | L2-Norm(final)=2.894 | acc=1.0000 | 4453.4 samples/s | 69.6 steps/s
[Step=21950 Epoch=41.4] | Loss=0.00041 | Reg=0.00212 | L2-Norm=14.571 | L2-Norm(final)=2.895 | acc=1.0000 | 4258.4 samples/s | 66.5 steps/s
[Step=22000 Epoch=41.5] | Loss=0.00036 | Reg=0.00212 | L2-Norm=14.566 | L2-Norm(final)=2.896 | acc=1.0000 | 4239.6 samples/s | 66.2 steps/s
[Step=22050 Epoch=41.6] | Loss=0.00032 | Reg=0.00212 | L2-Norm=14.561 | L2-Norm(final)=2.896 | acc=1.0000 | 4349.7 samples/s | 68.0 steps/s
[Step=22100 Epoch=41.7] | Loss=0.00029 | Reg=0.00212 | L2-Norm=14.556 | L2-Norm(final)=2.897 | acc=1.0000 | 4328.2 samples/s | 67.6 steps/s
[Step=22150 Epoch=41.8] | Loss=0.00027 | Reg=0.00212 | L2-Norm=14.551 | L2-Norm(final)=2.898 | acc=1.0000 | 1470.4 samples/s | 23.0 steps/s
[Step=22200 Epoch=41.8] | Loss=0.00024 | Reg=0.00212 | L2-Norm=14.546 | L2-Norm(final)=2.898 | acc=1.0000 | 4359.6 samples/s | 68.1 steps/s
[Step=22250 Epoch=41.9] | Loss=0.00023 | Reg=0.00211 | L2-Norm=14.541 | L2-Norm(final)=2.899 | acc=1.0000 | 4382.0 samples/s | 68.5 steps/s
[Step=22300 Epoch=42.0] | Loss=0.00021 | Reg=0.00211 | L2-Norm=14.535 | L2-Norm(final)=2.899 | acc=1.0000 | 4438.8 samples/s | 69.4 steps/s
[Step=22350 Epoch=42.1] | Loss=0.00020 | Reg=0.00211 | L2-Norm=14.530 | L2-Norm(final)=2.900 | acc=1.0000 | 4476.9 samples/s | 70.0 steps/s
[Step=22400 Epoch=42.2] | Loss=0.00018 | Reg=0.00211 | L2-Norm=14.524 | L2-Norm(final)=2.900 | acc=1.0000 | 4139.3 samples/s | 64.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30418 | acc=0.8255 | tpr=0.7485 | fpr=0.0074 | 4478.2 samples/s | 17.5 steps/s
Avg test loss: 0.30515, Avg test acc: 0.82503, Avg tpr: 0.74885, Avg fpr: 0.00743, total FA: 58

Testing server on iccad2012
[Step=  50] | Loss=0.50413 | acc=0.8607 | tpr=0.9690 | fpr=0.1412 | 4454.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.50529 | acc=0.8641 | tpr=0.9808 | fpr=0.1381 | 8939.6 samples/s | 34.9 steps/s
[Step= 150] | Loss=0.52187 | acc=0.8609 | tpr=0.9856 | fpr=0.1414 | 9362.9 samples/s | 36.6 steps/s
[Step= 200] | Loss=0.52599 | acc=0.8612 | tpr=0.9847 | fpr=0.1410 | 8704.6 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.52467 | acc=0.8605 | tpr=0.9817 | fpr=0.1417 | 9300.9 samples/s | 36.3 steps/s
[Step= 300] | Loss=0.52893 | acc=0.8597 | tpr=0.9818 | fpr=0.1425 | 8700.3 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.52820 | acc=0.8600 | tpr=0.9825 | fpr=0.1422 | 9108.4 samples/s | 35.6 steps/s
[Step= 400] | Loss=0.53160 | acc=0.8597 | tpr=0.9819 | fpr=0.1425 | 8243.0 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.53610 | acc=0.8591 | tpr=0.9820 | fpr=0.1431 | 8413.6 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.53581 | acc=0.8588 | tpr=0.9819 | fpr=0.1434 | 8677.4 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.53458 | acc=0.8591 | tpr=0.9825 | fpr=0.1431 | 16406.3 samples/s | 64.1 steps/s
Avg test loss: 0.53408, Avg test acc: 0.85922, Avg tpr: 0.98257, Avg fpr: 0.14303, total FA: 19859

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=21.9] | Loss=0.20791 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=2.921 | acc=0.8750 | 3583.0 samples/s | 56.0 steps/s
[Step=22450 Epoch=21.9] | Loss=0.02875 | Reg=0.00212 | L2-Norm=14.553 | L2-Norm(final)=2.912 | acc=1.0000 | 4781.8 samples/s | 74.7 steps/s
[Step=22500 Epoch=22.0] | Loss=0.01985 | Reg=0.00212 | L2-Norm=14.564 | L2-Norm(final)=2.915 | acc=1.0000 | 4595.6 samples/s | 71.8 steps/s
[Step=22550 Epoch=22.0] | Loss=0.01766 | Reg=0.00212 | L2-Norm=14.569 | L2-Norm(final)=2.918 | acc=1.0000 | 4549.1 samples/s | 71.1 steps/s
[Step=22600 Epoch=22.1] | Loss=0.01566 | Reg=0.00212 | L2-Norm=14.573 | L2-Norm(final)=2.921 | acc=0.9844 | 4690.6 samples/s | 73.3 steps/s
[Step=22650 Epoch=22.1] | Loss=0.01544 | Reg=0.00212 | L2-Norm=14.577 | L2-Norm(final)=2.924 | acc=0.9844 | 4694.2 samples/s | 73.3 steps/s
[Step=22700 Epoch=22.2] | Loss=0.01466 | Reg=0.00213 | L2-Norm=14.580 | L2-Norm(final)=2.926 | acc=0.9844 | 4677.4 samples/s | 73.1 steps/s
[Step=22750 Epoch=22.2] | Loss=0.01423 | Reg=0.00213 | L2-Norm=14.582 | L2-Norm(final)=2.928 | acc=1.0000 | 4660.3 samples/s | 72.8 steps/s
[Step=22800 Epoch=22.3] | Loss=0.01400 | Reg=0.00213 | L2-Norm=14.585 | L2-Norm(final)=2.930 | acc=1.0000 | 4645.0 samples/s | 72.6 steps/s
[Step=22850 Epoch=22.3] | Loss=0.01348 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=2.931 | acc=0.9688 | 4768.3 samples/s | 74.5 steps/s
[Step=22900 Epoch=22.4] | Loss=0.01317 | Reg=0.00213 | L2-Norm=14.589 | L2-Norm(final)=2.933 | acc=0.9844 | 4587.6 samples/s | 71.7 steps/s
[Step=22950 Epoch=22.4] | Loss=0.01272 | Reg=0.00213 | L2-Norm=14.591 | L2-Norm(final)=2.935 | acc=0.9844 | 4610.1 samples/s | 72.0 steps/s
[Step=23000 Epoch=22.5] | Loss=0.01261 | Reg=0.00213 | L2-Norm=14.593 | L2-Norm(final)=2.937 | acc=0.9688 | 4814.9 samples/s | 75.2 steps/s
[Step=23050 Epoch=22.5] | Loss=0.01251 | Reg=0.00213 | L2-Norm=14.595 | L2-Norm(final)=2.939 | acc=0.9844 | 4643.3 samples/s | 72.6 steps/s
[Step=23100 Epoch=22.6] | Loss=0.01257 | Reg=0.00213 | L2-Norm=14.597 | L2-Norm(final)=2.940 | acc=0.9688 | 4730.3 samples/s | 73.9 steps/s
[Step=23150 Epoch=22.6] | Loss=0.01267 | Reg=0.00213 | L2-Norm=14.598 | L2-Norm(final)=2.942 | acc=1.0000 | 4727.2 samples/s | 73.9 steps/s
[Step=23200 Epoch=22.7] | Loss=0.01269 | Reg=0.00213 | L2-Norm=14.600 | L2-Norm(final)=2.943 | acc=0.9844 | 3896.1 samples/s | 60.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step23200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=22401 Epoch=42.2] | Loss=0.04899 | Reg=0.00211 | L2-Norm=14.515 | L2-Norm(final)=2.921 | acc=0.9688 | 3118.7 samples/s | 48.7 steps/s
[Step=22450 Epoch=42.3] | Loss=0.00388 | Reg=0.00212 | L2-Norm=14.563 | L2-Norm(final)=2.916 | acc=1.0000 | 4214.8 samples/s | 65.9 steps/s
[Step=22500 Epoch=42.4] | Loss=0.00201 | Reg=0.00212 | L2-Norm=14.574 | L2-Norm(final)=2.916 | acc=1.0000 | 4234.4 samples/s | 66.2 steps/s
[Step=22550 Epoch=42.5] | Loss=0.00142 | Reg=0.00212 | L2-Norm=14.576 | L2-Norm(final)=2.918 | acc=1.0000 | 4336.3 samples/s | 67.8 steps/s
[Step=22600 Epoch=42.6] | Loss=0.00108 | Reg=0.00212 | L2-Norm=14.575 | L2-Norm(final)=2.919 | acc=1.0000 | 4403.1 samples/s | 68.8 steps/s
[Step=22650 Epoch=42.7] | Loss=0.00087 | Reg=0.00212 | L2-Norm=14.573 | L2-Norm(final)=2.920 | acc=1.0000 | 4404.1 samples/s | 68.8 steps/s
[Step=22700 Epoch=42.8] | Loss=0.00072 | Reg=0.00212 | L2-Norm=14.570 | L2-Norm(final)=2.921 | acc=1.0000 | 4389.9 samples/s | 68.6 steps/s
[Step=22750 Epoch=42.9] | Loss=0.00062 | Reg=0.00212 | L2-Norm=14.567 | L2-Norm(final)=2.922 | acc=1.0000 | 4511.3 samples/s | 70.5 steps/s
[Step=22800 Epoch=43.0] | Loss=0.00055 | Reg=0.00212 | L2-Norm=14.563 | L2-Norm(final)=2.923 | acc=1.0000 | 4346.5 samples/s | 67.9 steps/s
[Step=22850 Epoch=43.1] | Loss=0.00049 | Reg=0.00212 | L2-Norm=14.559 | L2-Norm(final)=2.923 | acc=1.0000 | 4426.9 samples/s | 69.2 steps/s
[Step=22900 Epoch=43.2] | Loss=0.00044 | Reg=0.00212 | L2-Norm=14.555 | L2-Norm(final)=2.924 | acc=1.0000 | 4473.5 samples/s | 69.9 steps/s
[Step=22950 Epoch=43.3] | Loss=0.00040 | Reg=0.00212 | L2-Norm=14.550 | L2-Norm(final)=2.925 | acc=1.0000 | 1537.7 samples/s | 24.0 steps/s
[Step=23000 Epoch=43.4] | Loss=0.00037 | Reg=0.00212 | L2-Norm=14.546 | L2-Norm(final)=2.925 | acc=1.0000 | 4449.3 samples/s | 69.5 steps/s
[Step=23050 Epoch=43.4] | Loss=0.00034 | Reg=0.00211 | L2-Norm=14.541 | L2-Norm(final)=2.926 | acc=1.0000 | 4291.0 samples/s | 67.0 steps/s
[Step=23100 Epoch=43.5] | Loss=0.00032 | Reg=0.00211 | L2-Norm=14.537 | L2-Norm(final)=2.927 | acc=1.0000 | 4599.2 samples/s | 71.9 steps/s
[Step=23150 Epoch=43.6] | Loss=0.00030 | Reg=0.00211 | L2-Norm=14.532 | L2-Norm(final)=2.927 | acc=1.0000 | 4358.4 samples/s | 68.1 steps/s
[Step=23200 Epoch=43.7] | Loss=0.00028 | Reg=0.00211 | L2-Norm=14.527 | L2-Norm(final)=2.928 | acc=1.0000 | 4302.4 samples/s | 67.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33698 | acc=0.7991 | tpr=0.7097 | fpr=0.0067 | 4329.4 samples/s | 16.9 steps/s
Avg test loss: 0.33805, Avg test acc: 0.79922, Avg tpr: 0.71131, Avg fpr: 0.00743, total FA: 58

Testing server on iccad2012
[Step=  50] | Loss=0.45530 | acc=0.8768 | tpr=0.9735 | fpr=0.1249 | 4414.1 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.45522 | acc=0.8783 | tpr=0.9787 | fpr=0.1236 | 8968.3 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.46977 | acc=0.8758 | tpr=0.9856 | fpr=0.1263 | 8935.9 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.47410 | acc=0.8757 | tpr=0.9847 | fpr=0.1263 | 9162.0 samples/s | 35.8 steps/s
[Step= 250] | Loss=0.47298 | acc=0.8754 | tpr=0.9825 | fpr=0.1265 | 8571.0 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.47679 | acc=0.8749 | tpr=0.9825 | fpr=0.1271 | 9164.9 samples/s | 35.8 steps/s
[Step= 350] | Loss=0.47670 | acc=0.8748 | tpr=0.9831 | fpr=0.1272 | 8859.2 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.47987 | acc=0.8744 | tpr=0.9819 | fpr=0.1276 | 9227.3 samples/s | 36.0 steps/s
[Step= 450] | Loss=0.48425 | acc=0.8742 | tpr=0.9820 | fpr=0.1278 | 8661.8 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.48355 | acc=0.8738 | tpr=0.9824 | fpr=0.1281 | 8824.8 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.48260 | acc=0.8740 | tpr=0.9821 | fpr=0.1279 | 16748.7 samples/s | 65.4 steps/s
Avg test loss: 0.48213, Avg test acc: 0.87411, Avg tpr: 0.98217, Avg fpr: 0.12785, total FA: 17752

server round 29/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=22.7] | Loss=0.25360 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=2.946 | acc=0.8438 | 3356.9 samples/s | 52.5 steps/s
[Step=23250 Epoch=22.7] | Loss=0.03071 | Reg=0.00211 | L2-Norm=14.540 | L2-Norm(final)=2.935 | acc=0.9844 | 4542.3 samples/s | 71.0 steps/s
[Step=23300 Epoch=22.7] | Loss=0.02104 | Reg=0.00212 | L2-Norm=14.554 | L2-Norm(final)=2.939 | acc=0.9688 | 4576.1 samples/s | 71.5 steps/s
[Step=23350 Epoch=22.8] | Loss=0.01720 | Reg=0.00212 | L2-Norm=14.561 | L2-Norm(final)=2.942 | acc=1.0000 | 4668.4 samples/s | 72.9 steps/s
[Step=23400 Epoch=22.8] | Loss=0.01492 | Reg=0.00212 | L2-Norm=14.566 | L2-Norm(final)=2.945 | acc=0.9844 | 4558.4 samples/s | 71.2 steps/s
[Step=23450 Epoch=22.9] | Loss=0.01428 | Reg=0.00212 | L2-Norm=14.569 | L2-Norm(final)=2.948 | acc=1.0000 | 4627.2 samples/s | 72.3 steps/s
[Step=23500 Epoch=22.9] | Loss=0.01427 | Reg=0.00212 | L2-Norm=14.572 | L2-Norm(final)=2.950 | acc=0.9688 | 4570.9 samples/s | 71.4 steps/s
[Step=23550 Epoch=23.0] | Loss=0.01354 | Reg=0.00212 | L2-Norm=14.575 | L2-Norm(final)=2.952 | acc=0.9844 | 4660.8 samples/s | 72.8 steps/s
[Step=23600 Epoch=23.0] | Loss=0.01295 | Reg=0.00213 | L2-Norm=14.578 | L2-Norm(final)=2.954 | acc=0.9844 | 4615.8 samples/s | 72.1 steps/s
[Step=23650 Epoch=23.1] | Loss=0.01273 | Reg=0.00213 | L2-Norm=14.580 | L2-Norm(final)=2.956 | acc=1.0000 | 4519.9 samples/s | 70.6 steps/s
[Step=23700 Epoch=23.1] | Loss=0.01277 | Reg=0.00213 | L2-Norm=14.583 | L2-Norm(final)=2.958 | acc=0.9844 | 4704.7 samples/s | 73.5 steps/s
[Step=23750 Epoch=23.2] | Loss=0.01275 | Reg=0.00213 | L2-Norm=14.585 | L2-Norm(final)=2.960 | acc=1.0000 | 4506.4 samples/s | 70.4 steps/s
[Step=23800 Epoch=23.2] | Loss=0.01286 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=2.961 | acc=0.9844 | 4679.9 samples/s | 73.1 steps/s
[Step=23850 Epoch=23.3] | Loss=0.01294 | Reg=0.00213 | L2-Norm=14.589 | L2-Norm(final)=2.962 | acc=0.9844 | 4590.2 samples/s | 71.7 steps/s
[Step=23900 Epoch=23.3] | Loss=0.01287 | Reg=0.00213 | L2-Norm=14.590 | L2-Norm(final)=2.963 | acc=1.0000 | 4861.2 samples/s | 76.0 steps/s
[Step=23950 Epoch=23.4] | Loss=0.01279 | Reg=0.00213 | L2-Norm=14.592 | L2-Norm(final)=2.965 | acc=0.9844 | 4728.2 samples/s | 73.9 steps/s
[Step=24000 Epoch=23.4] | Loss=0.01285 | Reg=0.00213 | L2-Norm=14.594 | L2-Norm(final)=2.966 | acc=1.0000 | 4496.2 samples/s | 70.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=23201 Epoch=43.7] | Loss=0.04191 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=2.946 | acc=0.9844 | 3431.4 samples/s | 53.6 steps/s
[Step=23250 Epoch=43.8] | Loss=0.00361 | Reg=0.00211 | L2-Norm=14.525 | L2-Norm(final)=2.948 | acc=1.0000 | 4316.6 samples/s | 67.4 steps/s
[Step=23300 Epoch=43.9] | Loss=0.00227 | Reg=0.00211 | L2-Norm=14.534 | L2-Norm(final)=2.948 | acc=1.0000 | 4312.9 samples/s | 67.4 steps/s
[Step=23350 Epoch=44.0] | Loss=0.00153 | Reg=0.00211 | L2-Norm=14.535 | L2-Norm(final)=2.948 | acc=1.0000 | 4420.0 samples/s | 69.1 steps/s
[Step=23400 Epoch=44.1] | Loss=0.00117 | Reg=0.00211 | L2-Norm=14.534 | L2-Norm(final)=2.949 | acc=1.0000 | 4591.5 samples/s | 71.7 steps/s
[Step=23450 Epoch=44.2] | Loss=0.00094 | Reg=0.00211 | L2-Norm=14.531 | L2-Norm(final)=2.950 | acc=1.0000 | 4483.1 samples/s | 70.0 steps/s
[Step=23500 Epoch=44.3] | Loss=0.00079 | Reg=0.00211 | L2-Norm=14.528 | L2-Norm(final)=2.951 | acc=1.0000 | 4292.4 samples/s | 67.1 steps/s
[Step=23550 Epoch=44.4] | Loss=0.00068 | Reg=0.00211 | L2-Norm=14.524 | L2-Norm(final)=2.952 | acc=1.0000 | 4394.5 samples/s | 68.7 steps/s
[Step=23600 Epoch=44.5] | Loss=0.00059 | Reg=0.00211 | L2-Norm=14.520 | L2-Norm(final)=2.952 | acc=1.0000 | 4448.2 samples/s | 69.5 steps/s
[Step=23650 Epoch=44.6] | Loss=0.00053 | Reg=0.00211 | L2-Norm=14.516 | L2-Norm(final)=2.953 | acc=1.0000 | 4384.6 samples/s | 68.5 steps/s
[Step=23700 Epoch=44.7] | Loss=0.00048 | Reg=0.00211 | L2-Norm=14.511 | L2-Norm(final)=2.954 | acc=1.0000 | 4415.6 samples/s | 69.0 steps/s
[Step=23750 Epoch=44.8] | Loss=0.00043 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=2.954 | acc=1.0000 | 1468.0 samples/s | 22.9 steps/s
[Step=23800 Epoch=44.9] | Loss=0.00040 | Reg=0.00210 | L2-Norm=14.502 | L2-Norm(final)=2.955 | acc=1.0000 | 4573.1 samples/s | 71.5 steps/s
[Step=23850 Epoch=45.0] | Loss=0.00037 | Reg=0.00210 | L2-Norm=14.497 | L2-Norm(final)=2.956 | acc=1.0000 | 4370.5 samples/s | 68.3 steps/s
[Step=23900 Epoch=45.1] | Loss=0.00034 | Reg=0.00210 | L2-Norm=14.492 | L2-Norm(final)=2.956 | acc=1.0000 | 4364.0 samples/s | 68.2 steps/s
[Step=23950 Epoch=45.1] | Loss=0.00032 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=2.957 | acc=1.0000 | 4393.6 samples/s | 68.7 steps/s
[Step=24000 Epoch=45.2] | Loss=0.00030 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=2.957 | acc=1.0000 | 4672.2 samples/s | 73.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31267 | acc=0.8103 | tpr=0.7274 | fpr=0.0097 | 4445.3 samples/s | 17.4 steps/s
Avg test loss: 0.31422, Avg test acc: 0.81108, Avg tpr: 0.72927, Avg fpr: 0.00897, total FA: 70

Testing server on iccad2012
[Step=  50] | Loss=0.44019 | acc=0.8752 | tpr=0.9735 | fpr=0.1265 | 4299.2 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.44128 | acc=0.8780 | tpr=0.9829 | fpr=0.1239 | 9153.9 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.45522 | acc=0.8753 | tpr=0.9885 | fpr=0.1268 | 9285.8 samples/s | 36.3 steps/s
[Step= 200] | Loss=0.45819 | acc=0.8754 | tpr=0.9869 | fpr=0.1266 | 8990.5 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.45662 | acc=0.8752 | tpr=0.9843 | fpr=0.1268 | 8764.3 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.46073 | acc=0.8748 | tpr=0.9840 | fpr=0.1272 | 9431.5 samples/s | 36.8 steps/s
[Step= 350] | Loss=0.46056 | acc=0.8747 | tpr=0.9843 | fpr=0.1273 | 9133.4 samples/s | 35.7 steps/s
[Step= 400] | Loss=0.46375 | acc=0.8742 | tpr=0.9830 | fpr=0.1277 | 8927.8 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.46816 | acc=0.8742 | tpr=0.9825 | fpr=0.1278 | 8706.1 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.46738 | acc=0.8739 | tpr=0.9824 | fpr=0.1280 | 8814.7 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.46642 | acc=0.8741 | tpr=0.9821 | fpr=0.1279 | 16684.4 samples/s | 65.2 steps/s
Avg test loss: 0.46595, Avg test acc: 0.87415, Avg tpr: 0.98217, Avg fpr: 0.12782, total FA: 17747

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=23.4] | Loss=0.22449 | Reg=0.00209 | L2-Norm=14.465 | L2-Norm(final)=2.974 | acc=0.8438 | 3484.4 samples/s | 54.4 steps/s
[Step=24050 Epoch=23.5] | Loss=0.03225 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=2.975 | acc=1.0000 | 4614.0 samples/s | 72.1 steps/s
[Step=24100 Epoch=23.5] | Loss=0.02027 | Reg=0.00210 | L2-Norm=14.494 | L2-Norm(final)=2.977 | acc=0.9844 | 4763.6 samples/s | 74.4 steps/s
[Step=24150 Epoch=23.6] | Loss=0.01669 | Reg=0.00210 | L2-Norm=14.497 | L2-Norm(final)=2.980 | acc=1.0000 | 4559.3 samples/s | 71.2 steps/s
[Step=24200 Epoch=23.6] | Loss=0.01496 | Reg=0.00210 | L2-Norm=14.499 | L2-Norm(final)=2.982 | acc=0.9844 | 4661.7 samples/s | 72.8 steps/s
[Step=24250 Epoch=23.7] | Loss=0.01311 | Reg=0.00210 | L2-Norm=14.501 | L2-Norm(final)=2.985 | acc=1.0000 | 4460.7 samples/s | 69.7 steps/s
[Step=24300 Epoch=23.7] | Loss=0.01245 | Reg=0.00210 | L2-Norm=14.502 | L2-Norm(final)=2.987 | acc=1.0000 | 4589.0 samples/s | 71.7 steps/s
[Step=24350 Epoch=23.8] | Loss=0.01186 | Reg=0.00210 | L2-Norm=14.504 | L2-Norm(final)=2.989 | acc=1.0000 | 4695.1 samples/s | 73.4 steps/s
[Step=24400 Epoch=23.8] | Loss=0.01126 | Reg=0.00210 | L2-Norm=14.505 | L2-Norm(final)=2.991 | acc=0.9844 | 4510.8 samples/s | 70.5 steps/s
[Step=24450 Epoch=23.9] | Loss=0.01110 | Reg=0.00210 | L2-Norm=14.506 | L2-Norm(final)=2.992 | acc=0.9844 | 4575.0 samples/s | 71.5 steps/s
[Step=24500 Epoch=23.9] | Loss=0.01077 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=2.994 | acc=1.0000 | 4632.9 samples/s | 72.4 steps/s
[Step=24550 Epoch=24.0] | Loss=0.01061 | Reg=0.00210 | L2-Norm=14.508 | L2-Norm(final)=2.995 | acc=1.0000 | 4653.5 samples/s | 72.7 steps/s
[Step=24600 Epoch=24.0] | Loss=0.01061 | Reg=0.00211 | L2-Norm=14.509 | L2-Norm(final)=2.997 | acc=0.9688 | 4739.8 samples/s | 74.1 steps/s
[Step=24650 Epoch=24.1] | Loss=0.01048 | Reg=0.00211 | L2-Norm=14.510 | L2-Norm(final)=2.998 | acc=0.9844 | 4564.7 samples/s | 71.3 steps/s
[Step=24700 Epoch=24.1] | Loss=0.01029 | Reg=0.00211 | L2-Norm=14.511 | L2-Norm(final)=2.999 | acc=1.0000 | 4577.8 samples/s | 71.5 steps/s
[Step=24750 Epoch=24.2] | Loss=0.01024 | Reg=0.00211 | L2-Norm=14.512 | L2-Norm(final)=3.001 | acc=0.9844 | 4672.8 samples/s | 73.0 steps/s
[Step=24800 Epoch=24.2] | Loss=0.01014 | Reg=0.00211 | L2-Norm=14.512 | L2-Norm(final)=3.002 | acc=0.9844 | 4629.5 samples/s | 72.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step24800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24001 Epoch=45.2] | Loss=0.08717 | Reg=0.00209 | L2-Norm=14.465 | L2-Norm(final)=2.974 | acc=0.9688 | 3782.2 samples/s | 59.1 steps/s
[Step=24050 Epoch=45.3] | Loss=0.00456 | Reg=0.00210 | L2-Norm=14.478 | L2-Norm(final)=2.972 | acc=1.0000 | 4066.5 samples/s | 63.5 steps/s
[Step=24100 Epoch=45.4] | Loss=0.00233 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=2.973 | acc=1.0000 | 4473.0 samples/s | 69.9 steps/s
[Step=24150 Epoch=45.5] | Loss=0.00157 | Reg=0.00210 | L2-Norm=14.480 | L2-Norm(final)=2.974 | acc=1.0000 | 4435.8 samples/s | 69.3 steps/s
[Step=24200 Epoch=45.6] | Loss=0.00119 | Reg=0.00210 | L2-Norm=14.479 | L2-Norm(final)=2.975 | acc=1.0000 | 4311.7 samples/s | 67.4 steps/s
[Step=24250 Epoch=45.7] | Loss=0.00096 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=2.975 | acc=1.0000 | 4403.7 samples/s | 68.8 steps/s
[Step=24300 Epoch=45.8] | Loss=0.00080 | Reg=0.00210 | L2-Norm=14.475 | L2-Norm(final)=2.976 | acc=1.0000 | 4248.8 samples/s | 66.4 steps/s
[Step=24350 Epoch=45.9] | Loss=0.00069 | Reg=0.00209 | L2-Norm=14.473 | L2-Norm(final)=2.976 | acc=1.0000 | 4150.3 samples/s | 64.8 steps/s
[Step=24400 Epoch=46.0] | Loss=0.00061 | Reg=0.00209 | L2-Norm=14.471 | L2-Norm(final)=2.977 | acc=1.0000 | 4368.4 samples/s | 68.3 steps/s
[Step=24450 Epoch=46.1] | Loss=0.00054 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=2.977 | acc=1.0000 | 4361.2 samples/s | 68.1 steps/s
[Step=24500 Epoch=46.2] | Loss=0.00049 | Reg=0.00209 | L2-Norm=14.467 | L2-Norm(final)=2.978 | acc=1.0000 | 4316.8 samples/s | 67.5 steps/s
[Step=24550 Epoch=46.3] | Loss=0.00045 | Reg=0.00209 | L2-Norm=14.465 | L2-Norm(final)=2.978 | acc=1.0000 | 1515.8 samples/s | 23.7 steps/s
[Step=24600 Epoch=46.4] | Loss=0.00041 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=2.979 | acc=1.0000 | 4251.1 samples/s | 66.4 steps/s
[Step=24650 Epoch=46.5] | Loss=0.00038 | Reg=0.00209 | L2-Norm=14.460 | L2-Norm(final)=2.979 | acc=1.0000 | 4382.7 samples/s | 68.5 steps/s
[Step=24700 Epoch=46.6] | Loss=0.00035 | Reg=0.00209 | L2-Norm=14.458 | L2-Norm(final)=2.980 | acc=1.0000 | 4476.0 samples/s | 69.9 steps/s
[Step=24750 Epoch=46.7] | Loss=0.00033 | Reg=0.00209 | L2-Norm=14.456 | L2-Norm(final)=2.980 | acc=1.0000 | 4269.3 samples/s | 66.7 steps/s
[Step=24800 Epoch=46.7] | Loss=0.00031 | Reg=0.00209 | L2-Norm=14.453 | L2-Norm(final)=2.980 | acc=1.0000 | 4350.0 samples/s | 68.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33345 | acc=0.8109 | tpr=0.7266 | fpr=0.0059 | 4405.0 samples/s | 17.2 steps/s
Avg test loss: 0.33825, Avg test acc: 0.80912, Avg tpr: 0.72536, Avg fpr: 0.00667, total FA: 52

Testing server on iccad2012
[Step=  50] | Loss=0.46476 | acc=0.8729 | tpr=0.9690 | fpr=0.1288 | 4445.5 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.46353 | acc=0.8755 | tpr=0.9765 | fpr=0.1263 | 9488.8 samples/s | 37.1 steps/s
[Step= 150] | Loss=0.47796 | acc=0.8726 | tpr=0.9841 | fpr=0.1295 | 8483.4 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.48127 | acc=0.8726 | tpr=0.9836 | fpr=0.1295 | 8734.8 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.48003 | acc=0.8724 | tpr=0.9808 | fpr=0.1295 | 8938.6 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.48418 | acc=0.8719 | tpr=0.9811 | fpr=0.1301 | 9058.1 samples/s | 35.4 steps/s
[Step= 350] | Loss=0.48377 | acc=0.8720 | tpr=0.9818 | fpr=0.1300 | 9080.2 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.48681 | acc=0.8716 | tpr=0.9809 | fpr=0.1304 | 9046.9 samples/s | 35.3 steps/s
[Step= 450] | Loss=0.49138 | acc=0.8713 | tpr=0.9800 | fpr=0.1307 | 8626.4 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.49047 | acc=0.8711 | tpr=0.9802 | fpr=0.1309 | 8905.7 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.48920 | acc=0.8712 | tpr=0.9797 | fpr=0.1308 | 16355.2 samples/s | 63.9 steps/s
Avg test loss: 0.48874, Avg test acc: 0.87123, Avg tpr: 0.97979, Avg fpr: 0.13074, total FA: 18153

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=24.2] | Loss=0.14363 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=3.003 | acc=0.8594 | 3736.9 samples/s | 58.4 steps/s
[Step=24850 Epoch=24.3] | Loss=0.03335 | Reg=0.00209 | L2-Norm=14.470 | L2-Norm(final)=3.000 | acc=1.0000 | 4372.3 samples/s | 68.3 steps/s
[Step=24900 Epoch=24.3] | Loss=0.02088 | Reg=0.00210 | L2-Norm=14.476 | L2-Norm(final)=3.001 | acc=1.0000 | 4438.6 samples/s | 69.4 steps/s
[Step=24950 Epoch=24.4] | Loss=0.01767 | Reg=0.00210 | L2-Norm=14.479 | L2-Norm(final)=3.004 | acc=0.9688 | 4568.4 samples/s | 71.4 steps/s
[Step=25000 Epoch=24.4] | Loss=0.01505 | Reg=0.00210 | L2-Norm=14.481 | L2-Norm(final)=3.006 | acc=1.0000 | 4636.9 samples/s | 72.5 steps/s
[Step=25050 Epoch=24.5] | Loss=0.01385 | Reg=0.00210 | L2-Norm=14.482 | L2-Norm(final)=3.008 | acc=1.0000 | 4690.6 samples/s | 73.3 steps/s
[Step=25100 Epoch=24.5] | Loss=0.01282 | Reg=0.00210 | L2-Norm=14.483 | L2-Norm(final)=3.010 | acc=1.0000 | 4508.2 samples/s | 70.4 steps/s
[Step=25150 Epoch=24.6] | Loss=0.01219 | Reg=0.00210 | L2-Norm=14.484 | L2-Norm(final)=3.011 | acc=1.0000 | 4613.4 samples/s | 72.1 steps/s
[Step=25200 Epoch=24.6] | Loss=0.01159 | Reg=0.00210 | L2-Norm=14.485 | L2-Norm(final)=3.013 | acc=1.0000 | 4551.5 samples/s | 71.1 steps/s
[Step=25250 Epoch=24.7] | Loss=0.01115 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=3.014 | acc=0.9844 | 4599.4 samples/s | 71.9 steps/s
[Step=25300 Epoch=24.7] | Loss=0.01112 | Reg=0.00210 | L2-Norm=14.486 | L2-Norm(final)=3.016 | acc=1.0000 | 4611.2 samples/s | 72.0 steps/s
[Step=25350 Epoch=24.8] | Loss=0.01102 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=3.017 | acc=0.9688 | 4643.3 samples/s | 72.6 steps/s
[Step=25400 Epoch=24.8] | Loss=0.01097 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=3.018 | acc=0.9688 | 4595.6 samples/s | 71.8 steps/s
[Step=25450 Epoch=24.8] | Loss=0.01069 | Reg=0.00210 | L2-Norm=14.488 | L2-Norm(final)=3.019 | acc=1.0000 | 4603.0 samples/s | 71.9 steps/s
[Step=25500 Epoch=24.9] | Loss=0.01053 | Reg=0.00210 | L2-Norm=14.489 | L2-Norm(final)=3.020 | acc=0.9844 | 4516.5 samples/s | 70.6 steps/s
[Step=25550 Epoch=24.9] | Loss=0.01019 | Reg=0.00210 | L2-Norm=14.490 | L2-Norm(final)=3.021 | acc=1.0000 | 4644.3 samples/s | 72.6 steps/s
[Step=25600 Epoch=25.0] | Loss=0.00988 | Reg=0.00210 | L2-Norm=14.490 | L2-Norm(final)=3.023 | acc=1.0000 | 4623.3 samples/s | 72.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step25600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=24801 Epoch=46.8] | Loss=0.09607 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=3.002 | acc=0.9844 | 3463.2 samples/s | 54.1 steps/s
[Step=24850 Epoch=46.8] | Loss=0.00403 | Reg=0.00209 | L2-Norm=14.461 | L2-Norm(final)=3.003 | acc=1.0000 | 4161.7 samples/s | 65.0 steps/s
[Step=24900 Epoch=46.9] | Loss=0.00204 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=3.004 | acc=1.0000 | 4334.1 samples/s | 67.7 steps/s
[Step=24950 Epoch=47.0] | Loss=0.00137 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=3.004 | acc=1.0000 | 4321.5 samples/s | 67.5 steps/s
[Step=25000 Epoch=47.1] | Loss=0.00104 | Reg=0.00209 | L2-Norm=14.460 | L2-Norm(final)=3.005 | acc=1.0000 | 4342.0 samples/s | 67.8 steps/s
[Step=25050 Epoch=47.2] | Loss=0.00083 | Reg=0.00209 | L2-Norm=14.459 | L2-Norm(final)=3.006 | acc=1.0000 | 4303.6 samples/s | 67.2 steps/s
[Step=25100 Epoch=47.3] | Loss=0.00070 | Reg=0.00209 | L2-Norm=14.457 | L2-Norm(final)=3.007 | acc=1.0000 | 4249.3 samples/s | 66.4 steps/s
[Step=25150 Epoch=47.4] | Loss=0.00060 | Reg=0.00209 | L2-Norm=14.455 | L2-Norm(final)=3.007 | acc=1.0000 | 4067.6 samples/s | 63.6 steps/s
[Step=25200 Epoch=47.5] | Loss=0.00053 | Reg=0.00209 | L2-Norm=14.453 | L2-Norm(final)=3.008 | acc=1.0000 | 3812.3 samples/s | 59.6 steps/s
[Step=25250 Epoch=47.6] | Loss=0.00048 | Reg=0.00209 | L2-Norm=14.450 | L2-Norm(final)=3.008 | acc=1.0000 | 3839.7 samples/s | 60.0 steps/s
[Step=25300 Epoch=47.7] | Loss=0.00043 | Reg=0.00209 | L2-Norm=14.448 | L2-Norm(final)=3.009 | acc=1.0000 | 3878.0 samples/s | 60.6 steps/s
[Step=25350 Epoch=47.8] | Loss=0.00039 | Reg=0.00209 | L2-Norm=14.446 | L2-Norm(final)=3.010 | acc=1.0000 | 1518.8 samples/s | 23.7 steps/s
[Step=25400 Epoch=47.9] | Loss=0.00036 | Reg=0.00209 | L2-Norm=14.444 | L2-Norm(final)=3.010 | acc=1.0000 | 4454.7 samples/s | 69.6 steps/s
[Step=25450 Epoch=48.0] | Loss=0.00033 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=3.011 | acc=1.0000 | 4449.8 samples/s | 69.5 steps/s
[Step=25500 Epoch=48.1] | Loss=0.00031 | Reg=0.00208 | L2-Norm=14.439 | L2-Norm(final)=3.011 | acc=1.0000 | 4278.0 samples/s | 66.8 steps/s
[Step=25550 Epoch=48.2] | Loss=0.00029 | Reg=0.00208 | L2-Norm=14.436 | L2-Norm(final)=3.012 | acc=1.0000 | 4455.4 samples/s | 69.6 steps/s
[Step=25600 Epoch=48.3] | Loss=0.00027 | Reg=0.00208 | L2-Norm=14.433 | L2-Norm(final)=3.012 | acc=1.0000 | 4432.6 samples/s | 69.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36542 | acc=0.8063 | tpr=0.7198 | fpr=0.0057 | 4498.1 samples/s | 17.6 steps/s
Avg test loss: 0.37055, Avg test acc: 0.80471, Avg tpr: 0.71860, Avg fpr: 0.00590, total FA: 46

Testing server on iccad2012
[Step=  50] | Loss=0.44940 | acc=0.8831 | tpr=0.9690 | fpr=0.1184 | 4462.9 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.44936 | acc=0.8850 | tpr=0.9808 | fpr=0.1167 | 9735.7 samples/s | 38.0 steps/s
[Step= 150] | Loss=0.46420 | acc=0.8823 | tpr=0.9856 | fpr=0.1196 | 8607.1 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.46799 | acc=0.8821 | tpr=0.9847 | fpr=0.1197 | 9054.8 samples/s | 35.4 steps/s
[Step= 250] | Loss=0.46668 | acc=0.8826 | tpr=0.9817 | fpr=0.1192 | 9161.6 samples/s | 35.8 steps/s
[Step= 300] | Loss=0.47095 | acc=0.8822 | tpr=0.9818 | fpr=0.1196 | 9039.1 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.47086 | acc=0.8821 | tpr=0.9818 | fpr=0.1198 | 9100.5 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.47356 | acc=0.8819 | tpr=0.9814 | fpr=0.1199 | 8812.0 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.47835 | acc=0.8817 | tpr=0.9805 | fpr=0.1201 | 8690.0 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.47753 | acc=0.8815 | tpr=0.9806 | fpr=0.1203 | 8593.0 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.47620 | acc=0.8816 | tpr=0.9805 | fpr=0.1201 | 16889.3 samples/s | 66.0 steps/s
Avg test loss: 0.47575, Avg test acc: 0.88171, Avg tpr: 0.98059, Avg fpr: 0.12009, total FA: 16674

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=25.0] | Loss=0.19430 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=3.030 | acc=0.8438 | 3615.6 samples/s | 56.5 steps/s
[Step=25650 Epoch=25.0] | Loss=0.02474 | Reg=0.00209 | L2-Norm=14.448 | L2-Norm(final)=3.027 | acc=1.0000 | 4243.5 samples/s | 66.3 steps/s
[Step=25700 Epoch=25.1] | Loss=0.01661 | Reg=0.00209 | L2-Norm=14.454 | L2-Norm(final)=3.029 | acc=0.9844 | 4555.5 samples/s | 71.2 steps/s
[Step=25750 Epoch=25.1] | Loss=0.01379 | Reg=0.00209 | L2-Norm=14.457 | L2-Norm(final)=3.031 | acc=0.9844 | 4682.5 samples/s | 73.2 steps/s
[Step=25800 Epoch=25.2] | Loss=0.01196 | Reg=0.00209 | L2-Norm=14.459 | L2-Norm(final)=3.033 | acc=1.0000 | 4661.3 samples/s | 72.8 steps/s
[Step=25850 Epoch=25.2] | Loss=0.01100 | Reg=0.00209 | L2-Norm=14.461 | L2-Norm(final)=3.034 | acc=1.0000 | 4734.7 samples/s | 74.0 steps/s
[Step=25900 Epoch=25.3] | Loss=0.01048 | Reg=0.00209 | L2-Norm=14.462 | L2-Norm(final)=3.036 | acc=1.0000 | 4543.2 samples/s | 71.0 steps/s
[Step=25950 Epoch=25.3] | Loss=0.01020 | Reg=0.00209 | L2-Norm=14.463 | L2-Norm(final)=3.038 | acc=0.9688 | 4727.9 samples/s | 73.9 steps/s
[Step=26000 Epoch=25.4] | Loss=0.00970 | Reg=0.00209 | L2-Norm=14.464 | L2-Norm(final)=3.039 | acc=1.0000 | 4567.2 samples/s | 71.4 steps/s
[Step=26050 Epoch=25.4] | Loss=0.00936 | Reg=0.00209 | L2-Norm=14.465 | L2-Norm(final)=3.041 | acc=1.0000 | 4688.2 samples/s | 73.3 steps/s
[Step=26100 Epoch=25.5] | Loss=0.00903 | Reg=0.00209 | L2-Norm=14.466 | L2-Norm(final)=3.043 | acc=1.0000 | 4578.3 samples/s | 71.5 steps/s
[Step=26150 Epoch=25.5] | Loss=0.00897 | Reg=0.00209 | L2-Norm=14.466 | L2-Norm(final)=3.044 | acc=0.9844 | 4564.7 samples/s | 71.3 steps/s
[Step=26200 Epoch=25.6] | Loss=0.00884 | Reg=0.00209 | L2-Norm=14.467 | L2-Norm(final)=3.045 | acc=1.0000 | 4470.1 samples/s | 69.8 steps/s
[Step=26250 Epoch=25.6] | Loss=0.00875 | Reg=0.00209 | L2-Norm=14.468 | L2-Norm(final)=3.047 | acc=1.0000 | 4765.3 samples/s | 74.5 steps/s
[Step=26300 Epoch=25.7] | Loss=0.00883 | Reg=0.00209 | L2-Norm=14.468 | L2-Norm(final)=3.048 | acc=1.0000 | 4555.5 samples/s | 71.2 steps/s
[Step=26350 Epoch=25.7] | Loss=0.00871 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=3.049 | acc=1.0000 | 4700.9 samples/s | 73.5 steps/s
[Step=26400 Epoch=25.8] | Loss=0.00878 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=3.050 | acc=0.9844 | 4750.1 samples/s | 74.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step26400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=25601 Epoch=48.3] | Loss=0.01752 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=3.031 | acc=0.9688 | 3536.1 samples/s | 55.3 steps/s
[Step=25650 Epoch=48.4] | Loss=0.00393 | Reg=0.00209 | L2-Norm=14.447 | L2-Norm(final)=3.034 | acc=1.0000 | 4107.6 samples/s | 64.2 steps/s
[Step=25700 Epoch=48.4] | Loss=0.00197 | Reg=0.00209 | L2-Norm=14.452 | L2-Norm(final)=3.035 | acc=1.0000 | 4407.2 samples/s | 68.9 steps/s
[Step=25750 Epoch=48.5] | Loss=0.00132 | Reg=0.00209 | L2-Norm=14.452 | L2-Norm(final)=3.035 | acc=1.0000 | 4393.2 samples/s | 68.6 steps/s
[Step=25800 Epoch=48.6] | Loss=0.00102 | Reg=0.00209 | L2-Norm=14.451 | L2-Norm(final)=3.035 | acc=1.0000 | 4275.9 samples/s | 66.8 steps/s
[Step=25850 Epoch=48.7] | Loss=0.00082 | Reg=0.00209 | L2-Norm=14.450 | L2-Norm(final)=3.036 | acc=1.0000 | 4335.0 samples/s | 67.7 steps/s
[Step=25900 Epoch=48.8] | Loss=0.00069 | Reg=0.00209 | L2-Norm=14.448 | L2-Norm(final)=3.036 | acc=1.0000 | 4431.1 samples/s | 69.2 steps/s
[Step=25950 Epoch=48.9] | Loss=0.00059 | Reg=0.00209 | L2-Norm=14.446 | L2-Norm(final)=3.037 | acc=1.0000 | 4457.5 samples/s | 69.6 steps/s
[Step=26000 Epoch=49.0] | Loss=0.00052 | Reg=0.00209 | L2-Norm=14.444 | L2-Norm(final)=3.037 | acc=1.0000 | 4398.1 samples/s | 68.7 steps/s
[Step=26050 Epoch=49.1] | Loss=0.00046 | Reg=0.00209 | L2-Norm=14.443 | L2-Norm(final)=3.038 | acc=1.0000 | 4492.5 samples/s | 70.2 steps/s
[Step=26100 Epoch=49.2] | Loss=0.00042 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=3.038 | acc=1.0000 | 4405.8 samples/s | 68.8 steps/s
[Step=26150 Epoch=49.3] | Loss=0.00038 | Reg=0.00208 | L2-Norm=14.438 | L2-Norm(final)=3.038 | acc=1.0000 | 1447.5 samples/s | 22.6 steps/s
[Step=26200 Epoch=49.4] | Loss=0.00035 | Reg=0.00208 | L2-Norm=14.436 | L2-Norm(final)=3.039 | acc=1.0000 | 4629.3 samples/s | 72.3 steps/s
[Step=26250 Epoch=49.5] | Loss=0.00032 | Reg=0.00208 | L2-Norm=14.434 | L2-Norm(final)=3.039 | acc=1.0000 | 4434.6 samples/s | 69.3 steps/s
[Step=26300 Epoch=49.6] | Loss=0.00030 | Reg=0.00208 | L2-Norm=14.432 | L2-Norm(final)=3.039 | acc=1.0000 | 4327.4 samples/s | 67.6 steps/s
[Step=26350 Epoch=49.7] | Loss=0.00028 | Reg=0.00208 | L2-Norm=14.430 | L2-Norm(final)=3.040 | acc=1.0000 | 4254.5 samples/s | 66.5 steps/s
[Step=26400 Epoch=49.8] | Loss=0.00027 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=3.040 | acc=1.0000 | 4423.6 samples/s | 69.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30569 | acc=0.8370 | tpr=0.7651 | fpr=0.0067 | 4421.6 samples/s | 17.3 steps/s
Avg test loss: 0.30828, Avg test acc: 0.83568, Avg tpr: 0.76435, Avg fpr: 0.00743, total FA: 58

Testing server on iccad2012
[Step=  50] | Loss=0.46565 | acc=0.8833 | tpr=0.9646 | fpr=0.1182 | 4452.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.46756 | acc=0.8850 | tpr=0.9765 | fpr=0.1167 | 8996.2 samples/s | 35.1 steps/s
[Step= 150] | Loss=0.48220 | acc=0.8824 | tpr=0.9827 | fpr=0.1195 | 9135.5 samples/s | 35.7 steps/s
[Step= 200] | Loss=0.48540 | acc=0.8821 | tpr=0.9825 | fpr=0.1198 | 8880.5 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.48415 | acc=0.8820 | tpr=0.9799 | fpr=0.1198 | 9135.9 samples/s | 35.7 steps/s
[Step= 300] | Loss=0.48855 | acc=0.8817 | tpr=0.9804 | fpr=0.1201 | 8938.6 samples/s | 34.9 steps/s
[Step= 350] | Loss=0.48858 | acc=0.8817 | tpr=0.9806 | fpr=0.1201 | 8999.8 samples/s | 35.2 steps/s
[Step= 400] | Loss=0.49114 | acc=0.8815 | tpr=0.9798 | fpr=0.1203 | 8853.7 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.49646 | acc=0.8810 | tpr=0.9796 | fpr=0.1208 | 8594.6 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.49544 | acc=0.8809 | tpr=0.9797 | fpr=0.1209 | 9319.5 samples/s | 36.4 steps/s
[Step= 550] | Loss=0.49412 | acc=0.8808 | tpr=0.9797 | fpr=0.1210 | 15954.9 samples/s | 62.3 steps/s
Avg test loss: 0.49362, Avg test acc: 0.88093, Avg tpr: 0.97979, Avg fpr: 0.12087, total FA: 16782

server round 33/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=25.8] | Loss=0.17811 | Reg=0.00208 | L2-Norm=14.411 | L2-Norm(final)=3.054 | acc=0.8906 | 3536.3 samples/s | 55.3 steps/s
[Step=26450 Epoch=25.8] | Loss=0.02469 | Reg=0.00208 | L2-Norm=14.433 | L2-Norm(final)=3.052 | acc=0.9844 | 4451.8 samples/s | 69.6 steps/s
[Step=26500 Epoch=25.9] | Loss=0.01571 | Reg=0.00208 | L2-Norm=14.438 | L2-Norm(final)=3.054 | acc=1.0000 | 4632.9 samples/s | 72.4 steps/s
[Step=26550 Epoch=25.9] | Loss=0.01306 | Reg=0.00209 | L2-Norm=14.441 | L2-Norm(final)=3.056 | acc=1.0000 | 4702.4 samples/s | 73.5 steps/s
[Step=26600 Epoch=26.0] | Loss=0.01187 | Reg=0.00209 | L2-Norm=14.443 | L2-Norm(final)=3.059 | acc=1.0000 | 4696.7 samples/s | 73.4 steps/s
[Step=26650 Epoch=26.0] | Loss=0.01066 | Reg=0.00209 | L2-Norm=14.445 | L2-Norm(final)=3.061 | acc=1.0000 | 4571.8 samples/s | 71.4 steps/s
[Step=26700 Epoch=26.1] | Loss=0.01032 | Reg=0.00209 | L2-Norm=14.446 | L2-Norm(final)=3.062 | acc=1.0000 | 4750.0 samples/s | 74.2 steps/s
[Step=26750 Epoch=26.1] | Loss=0.01012 | Reg=0.00209 | L2-Norm=14.448 | L2-Norm(final)=3.064 | acc=0.9844 | 4569.3 samples/s | 71.4 steps/s
[Step=26800 Epoch=26.2] | Loss=0.01033 | Reg=0.00209 | L2-Norm=14.448 | L2-Norm(final)=3.065 | acc=1.0000 | 4605.5 samples/s | 72.0 steps/s
[Step=26850 Epoch=26.2] | Loss=0.01023 | Reg=0.00209 | L2-Norm=14.449 | L2-Norm(final)=3.066 | acc=0.9844 | 4768.2 samples/s | 74.5 steps/s
[Step=26900 Epoch=26.3] | Loss=0.00997 | Reg=0.00209 | L2-Norm=14.450 | L2-Norm(final)=3.067 | acc=0.9844 | 4561.9 samples/s | 71.3 steps/s
[Step=26950 Epoch=26.3] | Loss=0.00963 | Reg=0.00209 | L2-Norm=14.451 | L2-Norm(final)=3.068 | acc=1.0000 | 4610.5 samples/s | 72.0 steps/s
[Step=27000 Epoch=26.4] | Loss=0.00958 | Reg=0.00209 | L2-Norm=14.452 | L2-Norm(final)=3.069 | acc=0.9688 | 4761.8 samples/s | 74.4 steps/s
[Step=27050 Epoch=26.4] | Loss=0.00937 | Reg=0.00209 | L2-Norm=14.452 | L2-Norm(final)=3.070 | acc=1.0000 | 4555.2 samples/s | 71.2 steps/s
[Step=27100 Epoch=26.5] | Loss=0.00933 | Reg=0.00209 | L2-Norm=14.453 | L2-Norm(final)=3.072 | acc=0.9844 | 4591.0 samples/s | 71.7 steps/s
[Step=27150 Epoch=26.5] | Loss=0.00920 | Reg=0.00209 | L2-Norm=14.454 | L2-Norm(final)=3.073 | acc=0.9844 | 4785.4 samples/s | 74.8 steps/s
[Step=27200 Epoch=26.6] | Loss=0.00917 | Reg=0.00209 | L2-Norm=14.454 | L2-Norm(final)=3.074 | acc=1.0000 | 4639.9 samples/s | 72.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step27200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=26401 Epoch=49.8] | Loss=0.05440 | Reg=0.00208 | L2-Norm=14.411 | L2-Norm(final)=3.055 | acc=0.9531 | 3840.9 samples/s | 60.0 steps/s
[Step=26450 Epoch=49.9] | Loss=0.00285 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=3.059 | acc=1.0000 | 3907.7 samples/s | 61.1 steps/s
[Step=26500 Epoch=50.0] | Loss=0.00144 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=3.060 | acc=1.0000 | 4247.7 samples/s | 66.4 steps/s
[Step=26550 Epoch=50.0] | Loss=0.00097 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=3.061 | acc=1.0000 | 4329.2 samples/s | 67.6 steps/s
[Step=26600 Epoch=50.1] | Loss=0.00075 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=3.062 | acc=1.0000 | 4464.7 samples/s | 69.8 steps/s
[Step=26650 Epoch=50.2] | Loss=0.00061 | Reg=0.00208 | L2-Norm=14.424 | L2-Norm(final)=3.063 | acc=1.0000 | 4384.6 samples/s | 68.5 steps/s
[Step=26700 Epoch=50.3] | Loss=0.00051 | Reg=0.00208 | L2-Norm=14.422 | L2-Norm(final)=3.063 | acc=1.0000 | 4489.3 samples/s | 70.1 steps/s
[Step=26750 Epoch=50.4] | Loss=0.00044 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=3.064 | acc=1.0000 | 4211.8 samples/s | 65.8 steps/s
[Step=26800 Epoch=50.5] | Loss=0.00039 | Reg=0.00208 | L2-Norm=14.418 | L2-Norm(final)=3.064 | acc=1.0000 | 4417.6 samples/s | 69.0 steps/s
[Step=26850 Epoch=50.6] | Loss=0.00034 | Reg=0.00208 | L2-Norm=14.416 | L2-Norm(final)=3.065 | acc=1.0000 | 4480.0 samples/s | 70.0 steps/s
[Step=26900 Epoch=50.7] | Loss=0.00031 | Reg=0.00208 | L2-Norm=14.414 | L2-Norm(final)=3.065 | acc=1.0000 | 4562.4 samples/s | 71.3 steps/s
[Step=26950 Epoch=50.8] | Loss=0.00028 | Reg=0.00208 | L2-Norm=14.412 | L2-Norm(final)=3.065 | acc=1.0000 | 1446.1 samples/s | 22.6 steps/s
[Step=27000 Epoch=50.9] | Loss=0.00026 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=3.066 | acc=1.0000 | 4514.7 samples/s | 70.5 steps/s
[Step=27050 Epoch=51.0] | Loss=0.00024 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=3.066 | acc=1.0000 | 4470.4 samples/s | 69.9 steps/s
[Step=27100 Epoch=51.1] | Loss=0.00022 | Reg=0.00207 | L2-Norm=14.405 | L2-Norm(final)=3.066 | acc=1.0000 | 4428.2 samples/s | 69.2 steps/s
[Step=27150 Epoch=51.2] | Loss=0.00021 | Reg=0.00207 | L2-Norm=14.402 | L2-Norm(final)=3.067 | acc=1.0000 | 4435.1 samples/s | 69.3 steps/s
[Step=27200 Epoch=51.3] | Loss=0.00020 | Reg=0.00207 | L2-Norm=14.400 | L2-Norm(final)=3.067 | acc=1.0000 | 4280.1 samples/s | 66.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29005 | acc=0.8481 | tpr=0.7818 | fpr=0.0079 | 4489.1 samples/s | 17.5 steps/s
Avg test loss: 0.29338, Avg test acc: 0.84614, Avg tpr: 0.78015, Avg fpr: 0.00872, total FA: 68

Testing server on iccad2012
[Step=  50] | Loss=0.54274 | acc=0.8694 | tpr=0.9646 | fpr=0.1323 | 4503.2 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.54149 | acc=0.8693 | tpr=0.9765 | fpr=0.1327 | 9202.1 samples/s | 35.9 steps/s
[Step= 150] | Loss=0.55758 | acc=0.8664 | tpr=0.9827 | fpr=0.1358 | 9159.6 samples/s | 35.8 steps/s
[Step= 200] | Loss=0.56102 | acc=0.8667 | tpr=0.9825 | fpr=0.1354 | 8863.9 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.55999 | acc=0.8667 | tpr=0.9790 | fpr=0.1353 | 9024.7 samples/s | 35.3 steps/s
[Step= 300] | Loss=0.56436 | acc=0.8662 | tpr=0.9789 | fpr=0.1358 | 8682.1 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.56422 | acc=0.8660 | tpr=0.9800 | fpr=0.1361 | 9338.3 samples/s | 36.5 steps/s
[Step= 400] | Loss=0.56689 | acc=0.8660 | tpr=0.9803 | fpr=0.1361 | 9618.8 samples/s | 37.6 steps/s
[Step= 450] | Loss=0.57226 | acc=0.8656 | tpr=0.9800 | fpr=0.1365 | 8302.5 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.57123 | acc=0.8655 | tpr=0.9802 | fpr=0.1366 | 9151.5 samples/s | 35.7 steps/s
[Step= 550] | Loss=0.56992 | acc=0.8658 | tpr=0.9805 | fpr=0.1363 | 16002.6 samples/s | 62.5 steps/s
Avg test loss: 0.56931, Avg test acc: 0.86586, Avg tpr: 0.98059, Avg fpr: 0.13622, total FA: 18914

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=26.6] | Loss=0.16091 | Reg=0.00207 | L2-Norm=14.391 | L2-Norm(final)=3.080 | acc=0.8906 | 3533.2 samples/s | 55.2 steps/s
[Step=27250 Epoch=26.6] | Loss=0.02159 | Reg=0.00208 | L2-Norm=14.414 | L2-Norm(final)=3.079 | acc=0.9844 | 4526.7 samples/s | 70.7 steps/s
[Step=27300 Epoch=26.7] | Loss=0.01501 | Reg=0.00208 | L2-Norm=14.419 | L2-Norm(final)=3.081 | acc=1.0000 | 4698.6 samples/s | 73.4 steps/s
[Step=27350 Epoch=26.7] | Loss=0.01223 | Reg=0.00208 | L2-Norm=14.421 | L2-Norm(final)=3.083 | acc=1.0000 | 4634.4 samples/s | 72.4 steps/s
[Step=27400 Epoch=26.8] | Loss=0.01109 | Reg=0.00208 | L2-Norm=14.423 | L2-Norm(final)=3.084 | acc=1.0000 | 4637.8 samples/s | 72.5 steps/s
[Step=27450 Epoch=26.8] | Loss=0.01061 | Reg=0.00208 | L2-Norm=14.424 | L2-Norm(final)=3.086 | acc=1.0000 | 4711.7 samples/s | 73.6 steps/s
[Step=27500 Epoch=26.8] | Loss=0.01034 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=3.087 | acc=0.9844 | 4565.3 samples/s | 71.3 steps/s
[Step=27550 Epoch=26.9] | Loss=0.00973 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=3.089 | acc=1.0000 | 4468.0 samples/s | 69.8 steps/s
[Step=27600 Epoch=26.9] | Loss=0.00971 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=3.090 | acc=1.0000 | 4606.6 samples/s | 72.0 steps/s
[Step=27650 Epoch=27.0] | Loss=0.00967 | Reg=0.00208 | L2-Norm=14.428 | L2-Norm(final)=3.092 | acc=1.0000 | 4755.5 samples/s | 74.3 steps/s
[Step=27700 Epoch=27.0] | Loss=0.00958 | Reg=0.00208 | L2-Norm=14.429 | L2-Norm(final)=3.093 | acc=1.0000 | 4710.2 samples/s | 73.6 steps/s
[Step=27750 Epoch=27.1] | Loss=0.00944 | Reg=0.00208 | L2-Norm=14.430 | L2-Norm(final)=3.094 | acc=1.0000 | 4596.4 samples/s | 71.8 steps/s
[Step=27800 Epoch=27.1] | Loss=0.00917 | Reg=0.00208 | L2-Norm=14.431 | L2-Norm(final)=3.095 | acc=1.0000 | 4655.1 samples/s | 72.7 steps/s
[Step=27850 Epoch=27.2] | Loss=0.00911 | Reg=0.00208 | L2-Norm=14.432 | L2-Norm(final)=3.096 | acc=0.9844 | 4762.2 samples/s | 74.4 steps/s
[Step=27900 Epoch=27.2] | Loss=0.00891 | Reg=0.00208 | L2-Norm=14.433 | L2-Norm(final)=3.098 | acc=1.0000 | 4485.5 samples/s | 70.1 steps/s
[Step=27950 Epoch=27.3] | Loss=0.00891 | Reg=0.00208 | L2-Norm=14.434 | L2-Norm(final)=3.099 | acc=0.9688 | 4577.9 samples/s | 71.5 steps/s
[Step=28000 Epoch=27.3] | Loss=0.00880 | Reg=0.00208 | L2-Norm=14.435 | L2-Norm(final)=3.100 | acc=1.0000 | 4684.5 samples/s | 73.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=27201 Epoch=51.3] | Loss=0.02950 | Reg=0.00207 | L2-Norm=14.391 | L2-Norm(final)=3.081 | acc=0.9688 | 3290.0 samples/s | 51.4 steps/s
[Step=27250 Epoch=51.4] | Loss=0.00354 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=3.085 | acc=1.0000 | 4295.2 samples/s | 67.1 steps/s
[Step=27300 Epoch=51.5] | Loss=0.00178 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=3.086 | acc=1.0000 | 4310.2 samples/s | 67.3 steps/s
[Step=27350 Epoch=51.6] | Loss=0.00119 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=3.087 | acc=1.0000 | 4232.4 samples/s | 66.1 steps/s
[Step=27400 Epoch=51.6] | Loss=0.00090 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=3.087 | acc=1.0000 | 4414.9 samples/s | 69.0 steps/s
[Step=27450 Epoch=51.7] | Loss=0.00072 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=3.087 | acc=1.0000 | 4447.8 samples/s | 69.5 steps/s
[Step=27500 Epoch=51.8] | Loss=0.00060 | Reg=0.00208 | L2-Norm=14.423 | L2-Norm(final)=3.088 | acc=1.0000 | 4699.8 samples/s | 73.4 steps/s
[Step=27550 Epoch=51.9] | Loss=0.00052 | Reg=0.00208 | L2-Norm=14.421 | L2-Norm(final)=3.088 | acc=1.0000 | 4331.6 samples/s | 67.7 steps/s
[Step=27600 Epoch=52.0] | Loss=0.00045 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=3.088 | acc=1.0000 | 4313.5 samples/s | 67.4 steps/s
[Step=27650 Epoch=52.1] | Loss=0.00040 | Reg=0.00208 | L2-Norm=14.418 | L2-Norm(final)=3.088 | acc=1.0000 | 4510.7 samples/s | 70.5 steps/s
[Step=27700 Epoch=52.2] | Loss=0.00036 | Reg=0.00208 | L2-Norm=14.416 | L2-Norm(final)=3.089 | acc=1.0000 | 4422.5 samples/s | 69.1 steps/s
[Step=27750 Epoch=52.3] | Loss=0.00033 | Reg=0.00208 | L2-Norm=14.414 | L2-Norm(final)=3.089 | acc=1.0000 | 1416.6 samples/s | 22.1 steps/s
[Step=27800 Epoch=52.4] | Loss=0.00030 | Reg=0.00208 | L2-Norm=14.412 | L2-Norm(final)=3.089 | acc=1.0000 | 4544.2 samples/s | 71.0 steps/s
[Step=27850 Epoch=52.5] | Loss=0.00028 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=3.089 | acc=1.0000 | 4423.7 samples/s | 69.1 steps/s
[Step=27900 Epoch=52.6] | Loss=0.00026 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=3.089 | acc=1.0000 | 4373.7 samples/s | 68.3 steps/s
[Step=27950 Epoch=52.7] | Loss=0.00024 | Reg=0.00208 | L2-Norm=14.405 | L2-Norm(final)=3.090 | acc=1.0000 | 4377.0 samples/s | 68.4 steps/s
[Step=28000 Epoch=52.8] | Loss=0.00023 | Reg=0.00207 | L2-Norm=14.403 | L2-Norm(final)=3.090 | acc=1.0000 | 4314.4 samples/s | 67.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33252 | acc=0.8268 | tpr=0.7506 | fpr=0.0077 | 4391.5 samples/s | 17.2 steps/s
Avg test loss: 0.33500, Avg test acc: 0.82535, Avg tpr: 0.74961, Avg fpr: 0.00808, total FA: 63

Testing server on iccad2012
[Step=  50] | Loss=0.49732 | acc=0.8871 | tpr=0.9690 | fpr=0.1144 | 4389.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.49712 | acc=0.8881 | tpr=0.9808 | fpr=0.1136 | 8845.1 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.51373 | acc=0.8862 | tpr=0.9856 | fpr=0.1156 | 8644.0 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.51787 | acc=0.8860 | tpr=0.9847 | fpr=0.1158 | 9132.4 samples/s | 35.7 steps/s
[Step= 250] | Loss=0.51694 | acc=0.8855 | tpr=0.9799 | fpr=0.1162 | 9017.4 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.52182 | acc=0.8853 | tpr=0.9804 | fpr=0.1164 | 9435.0 samples/s | 36.9 steps/s
[Step= 350] | Loss=0.52168 | acc=0.8853 | tpr=0.9812 | fpr=0.1164 | 8172.3 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.52481 | acc=0.8851 | tpr=0.9803 | fpr=0.1167 | 8525.9 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.53047 | acc=0.8848 | tpr=0.9800 | fpr=0.1169 | 8953.0 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.52941 | acc=0.8845 | tpr=0.9802 | fpr=0.1172 | 9008.7 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.52808 | acc=0.8847 | tpr=0.9801 | fpr=0.1170 | 15810.1 samples/s | 61.8 steps/s
Avg test loss: 0.52747, Avg test acc: 0.88479, Avg tpr: 0.98019, Avg fpr: 0.11694, total FA: 16237

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=27.3] | Loss=0.11215 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=3.103 | acc=0.9062 | 3376.9 samples/s | 52.8 steps/s
[Step=28050 Epoch=27.4] | Loss=0.02500 | Reg=0.00208 | L2-Norm=14.407 | L2-Norm(final)=3.095 | acc=1.0000 | 4403.2 samples/s | 68.8 steps/s
[Step=28100 Epoch=27.4] | Loss=0.01709 | Reg=0.00208 | L2-Norm=14.414 | L2-Norm(final)=3.095 | acc=0.9844 | 4651.5 samples/s | 72.7 steps/s
[Step=28150 Epoch=27.5] | Loss=0.01421 | Reg=0.00208 | L2-Norm=14.417 | L2-Norm(final)=3.097 | acc=1.0000 | 4532.0 samples/s | 70.8 steps/s
[Step=28200 Epoch=27.5] | Loss=0.01279 | Reg=0.00208 | L2-Norm=14.418 | L2-Norm(final)=3.098 | acc=1.0000 | 4483.7 samples/s | 70.1 steps/s
[Step=28250 Epoch=27.6] | Loss=0.01197 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=3.099 | acc=1.0000 | 4707.1 samples/s | 73.5 steps/s
[Step=28300 Epoch=27.6] | Loss=0.01122 | Reg=0.00208 | L2-Norm=14.421 | L2-Norm(final)=3.100 | acc=0.9688 | 4605.5 samples/s | 72.0 steps/s
[Step=28350 Epoch=27.7] | Loss=0.01072 | Reg=0.00208 | L2-Norm=14.422 | L2-Norm(final)=3.102 | acc=1.0000 | 4545.0 samples/s | 71.0 steps/s
[Step=28400 Epoch=27.7] | Loss=0.01050 | Reg=0.00208 | L2-Norm=14.423 | L2-Norm(final)=3.103 | acc=1.0000 | 4608.6 samples/s | 72.0 steps/s
[Step=28450 Epoch=27.8] | Loss=0.01024 | Reg=0.00208 | L2-Norm=14.423 | L2-Norm(final)=3.105 | acc=1.0000 | 4558.3 samples/s | 71.2 steps/s
[Step=28500 Epoch=27.8] | Loss=0.01012 | Reg=0.00208 | L2-Norm=14.424 | L2-Norm(final)=3.106 | acc=0.9844 | 4562.7 samples/s | 71.3 steps/s
[Step=28550 Epoch=27.9] | Loss=0.00985 | Reg=0.00208 | L2-Norm=14.425 | L2-Norm(final)=3.107 | acc=1.0000 | 4503.0 samples/s | 70.4 steps/s
[Step=28600 Epoch=27.9] | Loss=0.00964 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=3.109 | acc=1.0000 | 4583.2 samples/s | 71.6 steps/s
[Step=28650 Epoch=28.0] | Loss=0.00944 | Reg=0.00208 | L2-Norm=14.426 | L2-Norm(final)=3.110 | acc=0.9844 | 4670.1 samples/s | 73.0 steps/s
[Step=28700 Epoch=28.0] | Loss=0.00921 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=3.112 | acc=0.9844 | 4536.0 samples/s | 70.9 steps/s
[Step=28750 Epoch=28.1] | Loss=0.00914 | Reg=0.00208 | L2-Norm=14.428 | L2-Norm(final)=3.113 | acc=0.9844 | 4559.4 samples/s | 71.2 steps/s
[Step=28800 Epoch=28.1] | Loss=0.00906 | Reg=0.00208 | L2-Norm=14.428 | L2-Norm(final)=3.114 | acc=1.0000 | 4609.0 samples/s | 72.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step28800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28001 Epoch=52.8] | Loss=0.01780 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=3.103 | acc=0.9844 | 3563.9 samples/s | 55.7 steps/s
[Step=28050 Epoch=52.9] | Loss=0.00402 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.106 | acc=1.0000 | 3997.2 samples/s | 62.5 steps/s
[Step=28100 Epoch=53.0] | Loss=0.00202 | Reg=0.00207 | L2-Norm=14.399 | L2-Norm(final)=3.106 | acc=1.0000 | 4413.5 samples/s | 69.0 steps/s
[Step=28150 Epoch=53.1] | Loss=0.00135 | Reg=0.00207 | L2-Norm=14.399 | L2-Norm(final)=3.106 | acc=1.0000 | 4380.0 samples/s | 68.4 steps/s
[Step=28200 Epoch=53.2] | Loss=0.00101 | Reg=0.00207 | L2-Norm=14.397 | L2-Norm(final)=3.107 | acc=1.0000 | 4266.6 samples/s | 66.7 steps/s
[Step=28250 Epoch=53.3] | Loss=0.00081 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.107 | acc=1.0000 | 4406.6 samples/s | 68.9 steps/s
[Step=28300 Epoch=53.3] | Loss=0.00068 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=3.107 | acc=1.0000 | 4377.8 samples/s | 68.4 steps/s
[Step=28350 Epoch=53.4] | Loss=0.00059 | Reg=0.00207 | L2-Norm=14.392 | L2-Norm(final)=3.107 | acc=1.0000 | 4391.4 samples/s | 68.6 steps/s
[Step=28400 Epoch=53.5] | Loss=0.00051 | Reg=0.00207 | L2-Norm=14.390 | L2-Norm(final)=3.108 | acc=1.0000 | 3936.3 samples/s | 61.5 steps/s
[Step=28450 Epoch=53.6] | Loss=0.00046 | Reg=0.00207 | L2-Norm=14.387 | L2-Norm(final)=3.108 | acc=1.0000 | 3630.9 samples/s | 56.7 steps/s
[Step=28500 Epoch=53.7] | Loss=0.00041 | Reg=0.00207 | L2-Norm=14.385 | L2-Norm(final)=3.108 | acc=1.0000 | 3903.1 samples/s | 61.0 steps/s
[Step=28550 Epoch=53.8] | Loss=0.00038 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.108 | acc=1.0000 | 1448.0 samples/s | 22.6 steps/s
[Step=28600 Epoch=53.9] | Loss=0.00034 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=3.108 | acc=1.0000 | 4453.1 samples/s | 69.6 steps/s
[Step=28650 Epoch=54.0] | Loss=0.00032 | Reg=0.00207 | L2-Norm=14.379 | L2-Norm(final)=3.109 | acc=1.0000 | 4231.8 samples/s | 66.1 steps/s
[Step=28700 Epoch=54.1] | Loss=0.00030 | Reg=0.00207 | L2-Norm=14.376 | L2-Norm(final)=3.109 | acc=1.0000 | 4379.2 samples/s | 68.4 steps/s
[Step=28750 Epoch=54.2] | Loss=0.00028 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=3.109 | acc=1.0000 | 4459.0 samples/s | 69.7 steps/s
[Step=28800 Epoch=54.3] | Loss=0.00026 | Reg=0.00207 | L2-Norm=14.371 | L2-Norm(final)=3.109 | acc=1.0000 | 4512.5 samples/s | 70.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25538 | acc=0.8644 | tpr=0.8058 | fpr=0.0084 | 4483.6 samples/s | 17.5 steps/s
Avg test loss: 0.25811, Avg test acc: 0.86285, Avg tpr: 0.80457, Avg fpr: 0.00897, total FA: 70

Testing server on iccad2012
[Step=  50] | Loss=0.61308 | acc=0.8459 | tpr=0.9690 | fpr=0.1563 | 4475.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.61030 | acc=0.8479 | tpr=0.9808 | fpr=0.1546 | 9396.1 samples/s | 36.7 steps/s
[Step= 150] | Loss=0.62765 | acc=0.8451 | tpr=0.9870 | fpr=0.1575 | 9022.5 samples/s | 35.2 steps/s
[Step= 200] | Loss=0.63224 | acc=0.8455 | tpr=0.9858 | fpr=0.1570 | 8976.5 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.63136 | acc=0.8454 | tpr=0.9817 | fpr=0.1571 | 9126.8 samples/s | 35.7 steps/s
[Step= 300] | Loss=0.63663 | acc=0.8450 | tpr=0.9818 | fpr=0.1575 | 9489.9 samples/s | 37.1 steps/s
[Step= 350] | Loss=0.63613 | acc=0.8452 | tpr=0.9825 | fpr=0.1573 | 8830.0 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.63889 | acc=0.8451 | tpr=0.9819 | fpr=0.1574 | 9250.1 samples/s | 36.1 steps/s
[Step= 450] | Loss=0.64475 | acc=0.8448 | tpr=0.9820 | fpr=0.1577 | 8985.8 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.64438 | acc=0.8447 | tpr=0.9819 | fpr=0.1578 | 9212.4 samples/s | 36.0 steps/s
[Step= 550] | Loss=0.64291 | acc=0.8447 | tpr=0.9821 | fpr=0.1578 | 16943.5 samples/s | 66.2 steps/s
Avg test loss: 0.64231, Avg test acc: 0.84483, Avg tpr: 0.98217, Avg fpr: 0.15767, total FA: 21892

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=28.1] | Loss=0.14054 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.124 | acc=0.8906 | 3630.0 samples/s | 56.7 steps/s
[Step=28850 Epoch=28.2] | Loss=0.01611 | Reg=0.00207 | L2-Norm=14.379 | L2-Norm(final)=3.126 | acc=0.9844 | 4393.4 samples/s | 68.6 steps/s
[Step=28900 Epoch=28.2] | Loss=0.01213 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=3.128 | acc=1.0000 | 4439.7 samples/s | 69.4 steps/s
[Step=28950 Epoch=28.3] | Loss=0.01080 | Reg=0.00207 | L2-Norm=14.385 | L2-Norm(final)=3.129 | acc=1.0000 | 4531.2 samples/s | 70.8 steps/s
[Step=29000 Epoch=28.3] | Loss=0.00971 | Reg=0.00207 | L2-Norm=14.386 | L2-Norm(final)=3.131 | acc=1.0000 | 4557.7 samples/s | 71.2 steps/s
[Step=29050 Epoch=28.4] | Loss=0.00939 | Reg=0.00207 | L2-Norm=14.387 | L2-Norm(final)=3.133 | acc=1.0000 | 4591.1 samples/s | 71.7 steps/s
[Step=29100 Epoch=28.4] | Loss=0.00880 | Reg=0.00207 | L2-Norm=14.388 | L2-Norm(final)=3.134 | acc=0.9844 | 4719.3 samples/s | 73.7 steps/s
[Step=29150 Epoch=28.5] | Loss=0.00863 | Reg=0.00207 | L2-Norm=14.389 | L2-Norm(final)=3.136 | acc=0.9844 | 4598.0 samples/s | 71.8 steps/s
[Step=29200 Epoch=28.5] | Loss=0.00863 | Reg=0.00207 | L2-Norm=14.390 | L2-Norm(final)=3.137 | acc=1.0000 | 4567.8 samples/s | 71.4 steps/s
[Step=29250 Epoch=28.6] | Loss=0.00836 | Reg=0.00207 | L2-Norm=14.391 | L2-Norm(final)=3.138 | acc=1.0000 | 4572.1 samples/s | 71.4 steps/s
[Step=29300 Epoch=28.6] | Loss=0.00834 | Reg=0.00207 | L2-Norm=14.392 | L2-Norm(final)=3.140 | acc=1.0000 | 4685.7 samples/s | 73.2 steps/s
[Step=29350 Epoch=28.7] | Loss=0.00838 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=3.141 | acc=1.0000 | 4620.7 samples/s | 72.2 steps/s
[Step=29400 Epoch=28.7] | Loss=0.00845 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=3.142 | acc=1.0000 | 4695.4 samples/s | 73.4 steps/s
[Step=29450 Epoch=28.8] | Loss=0.00837 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=3.143 | acc=1.0000 | 4643.3 samples/s | 72.6 steps/s
[Step=29500 Epoch=28.8] | Loss=0.00833 | Reg=0.00207 | L2-Norm=14.395 | L2-Norm(final)=3.144 | acc=0.9844 | 4729.5 samples/s | 73.9 steps/s
[Step=29550 Epoch=28.9] | Loss=0.00840 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.145 | acc=1.0000 | 4640.0 samples/s | 72.5 steps/s
[Step=29600 Epoch=28.9] | Loss=0.00834 | Reg=0.00207 | L2-Norm=14.396 | L2-Norm(final)=3.146 | acc=1.0000 | 4548.9 samples/s | 71.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step29600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=28801 Epoch=54.3] | Loss=0.11577 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.124 | acc=0.9219 | 3446.2 samples/s | 53.8 steps/s
[Step=28850 Epoch=54.4] | Loss=0.00411 | Reg=0.00207 | L2-Norm=14.378 | L2-Norm(final)=3.127 | acc=1.0000 | 4609.2 samples/s | 72.0 steps/s
[Step=28900 Epoch=54.5] | Loss=0.00207 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=3.128 | acc=1.0000 | 4400.3 samples/s | 68.8 steps/s
[Step=28950 Epoch=54.6] | Loss=0.00139 | Reg=0.00207 | L2-Norm=14.380 | L2-Norm(final)=3.129 | acc=1.0000 | 4281.5 samples/s | 66.9 steps/s
[Step=29000 Epoch=54.7] | Loss=0.00105 | Reg=0.00207 | L2-Norm=14.378 | L2-Norm(final)=3.130 | acc=1.0000 | 4406.5 samples/s | 68.9 steps/s
[Step=29050 Epoch=54.8] | Loss=0.00084 | Reg=0.00207 | L2-Norm=14.377 | L2-Norm(final)=3.130 | acc=1.0000 | 4426.8 samples/s | 69.2 steps/s
[Step=29100 Epoch=54.9] | Loss=0.00070 | Reg=0.00207 | L2-Norm=14.375 | L2-Norm(final)=3.130 | acc=1.0000 | 4398.5 samples/s | 68.7 steps/s
[Step=29150 Epoch=54.9] | Loss=0.00060 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=3.131 | acc=1.0000 | 4374.4 samples/s | 68.4 steps/s
[Step=29200 Epoch=55.0] | Loss=0.00053 | Reg=0.00207 | L2-Norm=14.371 | L2-Norm(final)=3.131 | acc=1.0000 | 4306.9 samples/s | 67.3 steps/s
[Step=29250 Epoch=55.1] | Loss=0.00047 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=3.131 | acc=1.0000 | 4416.9 samples/s | 69.0 steps/s
[Step=29300 Epoch=55.2] | Loss=0.00043 | Reg=0.00206 | L2-Norm=14.367 | L2-Norm(final)=3.132 | acc=1.0000 | 4494.6 samples/s | 70.2 steps/s
[Step=29350 Epoch=55.3] | Loss=0.00039 | Reg=0.00206 | L2-Norm=14.365 | L2-Norm(final)=3.132 | acc=1.0000 | 1457.0 samples/s | 22.8 steps/s
[Step=29400 Epoch=55.4] | Loss=0.00036 | Reg=0.00206 | L2-Norm=14.363 | L2-Norm(final)=3.132 | acc=1.0000 | 4441.4 samples/s | 69.4 steps/s
[Step=29450 Epoch=55.5] | Loss=0.00033 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.132 | acc=1.0000 | 4347.7 samples/s | 67.9 steps/s
[Step=29500 Epoch=55.6] | Loss=0.00031 | Reg=0.00206 | L2-Norm=14.358 | L2-Norm(final)=3.132 | acc=1.0000 | 4451.0 samples/s | 69.5 steps/s
[Step=29550 Epoch=55.7] | Loss=0.00029 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=3.133 | acc=1.0000 | 4308.5 samples/s | 67.3 steps/s
[Step=29600 Epoch=55.8] | Loss=0.00027 | Reg=0.00206 | L2-Norm=14.353 | L2-Norm(final)=3.133 | acc=1.0000 | 4382.7 samples/s | 68.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32174 | acc=0.8373 | tpr=0.7662 | fpr=0.0084 | 4497.4 samples/s | 17.6 steps/s
Avg test loss: 0.32420, Avg test acc: 0.83637, Avg tpr: 0.76587, Avg fpr: 0.00859, total FA: 67

Testing server on iccad2012
[Step=  50] | Loss=0.52110 | acc=0.8803 | tpr=0.9735 | fpr=0.1214 | 4462.2 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.52155 | acc=0.8819 | tpr=0.9829 | fpr=0.1200 | 8637.5 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.53858 | acc=0.8805 | tpr=0.9870 | fpr=0.1215 | 9234.6 samples/s | 36.1 steps/s
[Step= 200] | Loss=0.54267 | acc=0.8810 | tpr=0.9858 | fpr=0.1209 | 8931.8 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.54203 | acc=0.8809 | tpr=0.9817 | fpr=0.1209 | 8691.9 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.54700 | acc=0.8805 | tpr=0.9818 | fpr=0.1214 | 9353.0 samples/s | 36.5 steps/s
[Step= 350] | Loss=0.54644 | acc=0.8806 | tpr=0.9825 | fpr=0.1213 | 8745.6 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.54908 | acc=0.8805 | tpr=0.9819 | fpr=0.1214 | 8545.9 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.55491 | acc=0.8804 | tpr=0.9815 | fpr=0.1215 | 9377.5 samples/s | 36.6 steps/s
[Step= 500] | Loss=0.55416 | acc=0.8801 | tpr=0.9815 | fpr=0.1218 | 8593.8 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.55285 | acc=0.8801 | tpr=0.9821 | fpr=0.1217 | 16892.6 samples/s | 66.0 steps/s
Avg test loss: 0.55232, Avg test acc: 0.88021, Avg tpr: 0.98217, Avg fpr: 0.12164, total FA: 16890

server round 37/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=28.9] | Loss=0.19834 | Reg=0.00206 | L2-Norm=14.343 | L2-Norm(final)=3.148 | acc=0.8750 | 3404.6 samples/s | 53.2 steps/s
[Step=29650 Epoch=28.9] | Loss=0.02579 | Reg=0.00206 | L2-Norm=14.368 | L2-Norm(final)=3.142 | acc=1.0000 | 4532.0 samples/s | 70.8 steps/s
[Step=29700 Epoch=29.0] | Loss=0.01641 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=3.143 | acc=0.9844 | 4515.7 samples/s | 70.6 steps/s
[Step=29750 Epoch=29.0] | Loss=0.01352 | Reg=0.00207 | L2-Norm=14.378 | L2-Norm(final)=3.146 | acc=0.9688 | 4476.7 samples/s | 69.9 steps/s
[Step=29800 Epoch=29.1] | Loss=0.01191 | Reg=0.00207 | L2-Norm=14.379 | L2-Norm(final)=3.148 | acc=0.9844 | 4469.4 samples/s | 69.8 steps/s
[Step=29850 Epoch=29.1] | Loss=0.01095 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=3.150 | acc=1.0000 | 4515.0 samples/s | 70.5 steps/s
[Step=29900 Epoch=29.2] | Loss=0.01081 | Reg=0.00207 | L2-Norm=14.382 | L2-Norm(final)=3.151 | acc=1.0000 | 4591.7 samples/s | 71.7 steps/s
[Step=29950 Epoch=29.2] | Loss=0.01004 | Reg=0.00207 | L2-Norm=14.383 | L2-Norm(final)=3.153 | acc=1.0000 | 4588.2 samples/s | 71.7 steps/s
[Step=30000 Epoch=29.3] | Loss=0.00955 | Reg=0.00207 | L2-Norm=14.384 | L2-Norm(final)=3.154 | acc=1.0000 | 4605.3 samples/s | 72.0 steps/s
[Step=30050 Epoch=29.3] | Loss=0.00921 | Reg=0.00207 | L2-Norm=14.385 | L2-Norm(final)=3.155 | acc=1.0000 | 4324.5 samples/s | 67.6 steps/s
[Step=30100 Epoch=29.4] | Loss=0.00907 | Reg=0.00207 | L2-Norm=14.385 | L2-Norm(final)=3.157 | acc=1.0000 | 3708.2 samples/s | 57.9 steps/s
[Step=30150 Epoch=29.4] | Loss=0.00899 | Reg=0.00207 | L2-Norm=14.386 | L2-Norm(final)=3.158 | acc=0.9844 | 4034.0 samples/s | 63.0 steps/s
[Step=30200 Epoch=29.5] | Loss=0.00887 | Reg=0.00207 | L2-Norm=14.386 | L2-Norm(final)=3.159 | acc=0.9844 | 4047.1 samples/s | 63.2 steps/s
[Step=30250 Epoch=29.5] | Loss=0.00881 | Reg=0.00207 | L2-Norm=14.387 | L2-Norm(final)=3.161 | acc=0.9844 | 3979.5 samples/s | 62.2 steps/s
[Step=30300 Epoch=29.6] | Loss=0.00865 | Reg=0.00207 | L2-Norm=14.387 | L2-Norm(final)=3.162 | acc=1.0000 | 3737.6 samples/s | 58.4 steps/s
[Step=30350 Epoch=29.6] | Loss=0.00867 | Reg=0.00207 | L2-Norm=14.388 | L2-Norm(final)=3.163 | acc=0.9844 | 3696.6 samples/s | 57.8 steps/s
[Step=30400 Epoch=29.7] | Loss=0.00857 | Reg=0.00207 | L2-Norm=14.389 | L2-Norm(final)=3.164 | acc=0.9844 | 3761.3 samples/s | 58.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step30400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=29601 Epoch=55.8] | Loss=0.05217 | Reg=0.00206 | L2-Norm=14.343 | L2-Norm(final)=3.149 | acc=0.9844 | 2853.3 samples/s | 44.6 steps/s
[Step=29650 Epoch=55.9] | Loss=0.00271 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.154 | acc=1.0000 | 4126.2 samples/s | 64.5 steps/s
[Step=29700 Epoch=56.0] | Loss=0.00139 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.155 | acc=1.0000 | 4272.4 samples/s | 66.8 steps/s
[Step=29750 Epoch=56.1] | Loss=0.00093 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.156 | acc=1.0000 | 4360.3 samples/s | 68.1 steps/s
[Step=29800 Epoch=56.2] | Loss=0.00070 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.157 | acc=1.0000 | 4510.2 samples/s | 70.5 steps/s
[Step=29850 Epoch=56.3] | Loss=0.00057 | Reg=0.00206 | L2-Norm=14.358 | L2-Norm(final)=3.157 | acc=1.0000 | 4347.9 samples/s | 67.9 steps/s
[Step=29900 Epoch=56.4] | Loss=0.00047 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=3.158 | acc=1.0000 | 4462.4 samples/s | 69.7 steps/s
[Step=29950 Epoch=56.5] | Loss=0.00041 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=3.159 | acc=1.0000 | 4394.6 samples/s | 68.7 steps/s
[Step=30000 Epoch=56.6] | Loss=0.00036 | Reg=0.00206 | L2-Norm=14.353 | L2-Norm(final)=3.159 | acc=1.0000 | 4268.4 samples/s | 66.7 steps/s
[Step=30050 Epoch=56.6] | Loss=0.00032 | Reg=0.00206 | L2-Norm=14.350 | L2-Norm(final)=3.160 | acc=1.0000 | 4406.5 samples/s | 68.9 steps/s
[Step=30100 Epoch=56.7] | Loss=0.00029 | Reg=0.00206 | L2-Norm=14.348 | L2-Norm(final)=3.160 | acc=1.0000 | 4497.5 samples/s | 70.3 steps/s
[Step=30150 Epoch=56.8] | Loss=0.00026 | Reg=0.00206 | L2-Norm=14.346 | L2-Norm(final)=3.160 | acc=1.0000 | 1427.6 samples/s | 22.3 steps/s
[Step=30200 Epoch=56.9] | Loss=0.00024 | Reg=0.00206 | L2-Norm=14.344 | L2-Norm(final)=3.161 | acc=1.0000 | 4309.3 samples/s | 67.3 steps/s
[Step=30250 Epoch=57.0] | Loss=0.00022 | Reg=0.00206 | L2-Norm=14.341 | L2-Norm(final)=3.161 | acc=1.0000 | 4297.4 samples/s | 67.1 steps/s
[Step=30300 Epoch=57.1] | Loss=0.00021 | Reg=0.00206 | L2-Norm=14.339 | L2-Norm(final)=3.162 | acc=1.0000 | 4526.7 samples/s | 70.7 steps/s
[Step=30350 Epoch=57.2] | Loss=0.00019 | Reg=0.00206 | L2-Norm=14.336 | L2-Norm(final)=3.162 | acc=1.0000 | 4610.5 samples/s | 72.0 steps/s
[Step=30400 Epoch=57.3] | Loss=0.00018 | Reg=0.00205 | L2-Norm=14.334 | L2-Norm(final)=3.162 | acc=1.0000 | 4451.2 samples/s | 69.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27884 | acc=0.8582 | tpr=0.7971 | fpr=0.0092 | 4450.0 samples/s | 17.4 steps/s
Avg test loss: 0.28091, Avg test acc: 0.85644, Avg tpr: 0.79548, Avg fpr: 0.00949, total FA: 74

Testing server on iccad2012
[Step=  50] | Loss=0.55363 | acc=0.8688 | tpr=0.9690 | fpr=0.1330 | 4420.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.55281 | acc=0.8695 | tpr=0.9787 | fpr=0.1326 | 9332.2 samples/s | 36.5 steps/s
[Step= 150] | Loss=0.57053 | acc=0.8670 | tpr=0.9841 | fpr=0.1352 | 9309.5 samples/s | 36.4 steps/s
[Step= 200] | Loss=0.57419 | acc=0.8672 | tpr=0.9836 | fpr=0.1349 | 8797.5 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.57324 | acc=0.8672 | tpr=0.9799 | fpr=0.1349 | 8733.8 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.57806 | acc=0.8670 | tpr=0.9804 | fpr=0.1351 | 8925.0 samples/s | 34.9 steps/s
[Step= 350] | Loss=0.57723 | acc=0.8670 | tpr=0.9812 | fpr=0.1351 | 8902.2 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.58000 | acc=0.8668 | tpr=0.9809 | fpr=0.1353 | 9109.1 samples/s | 35.6 steps/s
[Step= 450] | Loss=0.58583 | acc=0.8665 | tpr=0.9810 | fpr=0.1356 | 8710.6 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.58529 | acc=0.8663 | tpr=0.9811 | fpr=0.1358 | 8544.1 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.58403 | acc=0.8662 | tpr=0.9813 | fpr=0.1358 | 16365.4 samples/s | 63.9 steps/s
Avg test loss: 0.58350, Avg test acc: 0.86632, Avg tpr: 0.98138, Avg fpr: 0.13577, total FA: 18852

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=29.7] | Loss=0.15416 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.172 | acc=0.9062 | 3606.6 samples/s | 56.4 steps/s
[Step=30450 Epoch=29.7] | Loss=0.01874 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=3.173 | acc=1.0000 | 4103.3 samples/s | 64.1 steps/s
[Step=30500 Epoch=29.8] | Loss=0.01257 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=3.174 | acc=1.0000 | 4527.8 samples/s | 70.7 steps/s
[Step=30550 Epoch=29.8] | Loss=0.01132 | Reg=0.00206 | L2-Norm=14.351 | L2-Norm(final)=3.175 | acc=1.0000 | 4709.8 samples/s | 73.6 steps/s
[Step=30600 Epoch=29.9] | Loss=0.01023 | Reg=0.00206 | L2-Norm=14.353 | L2-Norm(final)=3.176 | acc=1.0000 | 4672.9 samples/s | 73.0 steps/s
[Step=30650 Epoch=29.9] | Loss=0.00974 | Reg=0.00206 | L2-Norm=14.354 | L2-Norm(final)=3.177 | acc=0.9844 | 4641.2 samples/s | 72.5 steps/s
[Step=30700 Epoch=30.0] | Loss=0.00950 | Reg=0.00206 | L2-Norm=14.355 | L2-Norm(final)=3.179 | acc=1.0000 | 4513.5 samples/s | 70.5 steps/s
[Step=30750 Epoch=30.0] | Loss=0.00891 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=3.180 | acc=1.0000 | 4573.6 samples/s | 71.5 steps/s
[Step=30800 Epoch=30.1] | Loss=0.00898 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=3.181 | acc=1.0000 | 4723.2 samples/s | 73.8 steps/s
[Step=30850 Epoch=30.1] | Loss=0.00884 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=3.182 | acc=1.0000 | 4561.1 samples/s | 71.3 steps/s
[Step=30900 Epoch=30.2] | Loss=0.00885 | Reg=0.00206 | L2-Norm=14.358 | L2-Norm(final)=3.184 | acc=0.9844 | 4543.4 samples/s | 71.0 steps/s
[Step=30950 Epoch=30.2] | Loss=0.00870 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=3.185 | acc=1.0000 | 4646.2 samples/s | 72.6 steps/s
[Step=31000 Epoch=30.3] | Loss=0.00842 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.186 | acc=0.9844 | 4551.3 samples/s | 71.1 steps/s
[Step=31050 Epoch=30.3] | Loss=0.00826 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.187 | acc=1.0000 | 4543.4 samples/s | 71.0 steps/s
[Step=31100 Epoch=30.4] | Loss=0.00806 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.189 | acc=0.9844 | 4701.8 samples/s | 73.5 steps/s
[Step=31150 Epoch=30.4] | Loss=0.00818 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.190 | acc=0.9844 | 4521.3 samples/s | 70.6 steps/s
[Step=31200 Epoch=30.5] | Loss=0.00824 | Reg=0.00206 | L2-Norm=14.362 | L2-Norm(final)=3.191 | acc=0.9844 | 4568.4 samples/s | 71.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step31200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=30401 Epoch=57.3] | Loss=0.06151 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.173 | acc=0.9375 | 3376.9 samples/s | 52.8 steps/s
[Step=30450 Epoch=57.4] | Loss=0.00466 | Reg=0.00206 | L2-Norm=14.352 | L2-Norm(final)=3.173 | acc=1.0000 | 4431.7 samples/s | 69.2 steps/s
[Step=30500 Epoch=57.5] | Loss=0.00267 | Reg=0.00206 | L2-Norm=14.359 | L2-Norm(final)=3.171 | acc=1.0000 | 4255.9 samples/s | 66.5 steps/s
[Step=30550 Epoch=57.6] | Loss=0.00179 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.171 | acc=1.0000 | 4275.2 samples/s | 66.8 steps/s
[Step=30600 Epoch=57.7] | Loss=0.00134 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.171 | acc=1.0000 | 4316.9 samples/s | 67.5 steps/s
[Step=30650 Epoch=57.8] | Loss=0.00108 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.171 | acc=1.0000 | 4306.0 samples/s | 67.3 steps/s
[Step=30700 Epoch=57.9] | Loss=0.00090 | Reg=0.00206 | L2-Norm=14.360 | L2-Norm(final)=3.171 | acc=1.0000 | 4455.9 samples/s | 69.6 steps/s
[Step=30750 Epoch=58.0] | Loss=0.00077 | Reg=0.00206 | L2-Norm=14.358 | L2-Norm(final)=3.171 | acc=1.0000 | 4401.6 samples/s | 68.8 steps/s
[Step=30800 Epoch=58.1] | Loss=0.00068 | Reg=0.00206 | L2-Norm=14.357 | L2-Norm(final)=3.171 | acc=1.0000 | 4332.7 samples/s | 67.7 steps/s
[Step=30850 Epoch=58.2] | Loss=0.00060 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=3.171 | acc=1.0000 | 4395.4 samples/s | 68.7 steps/s
[Step=30900 Epoch=58.2] | Loss=0.00054 | Reg=0.00206 | L2-Norm=14.354 | L2-Norm(final)=3.172 | acc=1.0000 | 4338.9 samples/s | 67.8 steps/s
[Step=30950 Epoch=58.3] | Loss=0.00049 | Reg=0.00206 | L2-Norm=14.352 | L2-Norm(final)=3.172 | acc=1.0000 | 1582.6 samples/s | 24.7 steps/s
[Step=31000 Epoch=58.4] | Loss=0.00045 | Reg=0.00206 | L2-Norm=14.351 | L2-Norm(final)=3.172 | acc=1.0000 | 4390.8 samples/s | 68.6 steps/s
[Step=31050 Epoch=58.5] | Loss=0.00042 | Reg=0.00206 | L2-Norm=14.349 | L2-Norm(final)=3.172 | acc=1.0000 | 4242.4 samples/s | 66.3 steps/s
[Step=31100 Epoch=58.6] | Loss=0.00039 | Reg=0.00206 | L2-Norm=14.347 | L2-Norm(final)=3.172 | acc=1.0000 | 4333.0 samples/s | 67.7 steps/s
[Step=31150 Epoch=58.7] | Loss=0.00036 | Reg=0.00206 | L2-Norm=14.345 | L2-Norm(final)=3.172 | acc=1.0000 | 4479.7 samples/s | 70.0 steps/s
[Step=31200 Epoch=58.8] | Loss=0.00034 | Reg=0.00206 | L2-Norm=14.344 | L2-Norm(final)=3.172 | acc=1.0000 | 4202.2 samples/s | 65.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32679 | acc=0.8266 | tpr=0.7507 | fpr=0.0084 | 4398.4 samples/s | 17.2 steps/s
Avg test loss: 0.32759, Avg test acc: 0.82655, Avg tpr: 0.75170, Avg fpr: 0.00885, total FA: 69

Testing server on iccad2012
[Step=  50] | Loss=0.46737 | acc=0.8943 | tpr=0.9735 | fpr=0.1071 | 4438.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.46690 | acc=0.8957 | tpr=0.9829 | fpr=0.1059 | 9600.7 samples/s | 37.5 steps/s
[Step= 150] | Loss=0.48268 | acc=0.8934 | tpr=0.9885 | fpr=0.1083 | 8245.9 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.48675 | acc=0.8935 | tpr=0.9869 | fpr=0.1082 | 9563.9 samples/s | 37.4 steps/s
[Step= 250] | Loss=0.48575 | acc=0.8929 | tpr=0.9825 | fpr=0.1087 | 8231.9 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.49032 | acc=0.8925 | tpr=0.9825 | fpr=0.1092 | 8704.4 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.48973 | acc=0.8923 | tpr=0.9831 | fpr=0.1093 | 8862.2 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.49295 | acc=0.8920 | tpr=0.9819 | fpr=0.1096 | 8550.2 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.49847 | acc=0.8916 | tpr=0.9815 | fpr=0.1100 | 8664.5 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.49743 | acc=0.8913 | tpr=0.9815 | fpr=0.1103 | 9085.4 samples/s | 35.5 steps/s
[Step= 550] | Loss=0.49592 | acc=0.8915 | tpr=0.9809 | fpr=0.1101 | 14781.5 samples/s | 57.7 steps/s
Avg test loss: 0.49539, Avg test acc: 0.89156, Avg tpr: 0.98098, Avg fpr: 0.11006, total FA: 15282

server round 39/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=30.5] | Loss=0.21743 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=3.190 | acc=0.8750 | 3711.7 samples/s | 58.0 steps/s
[Step=31250 Epoch=30.5] | Loss=0.03063 | Reg=0.00206 | L2-Norm=14.353 | L2-Norm(final)=3.184 | acc=1.0000 | 4020.3 samples/s | 62.8 steps/s
[Step=31300 Epoch=30.6] | Loss=0.01853 | Reg=0.00206 | L2-Norm=14.361 | L2-Norm(final)=3.184 | acc=1.0000 | 4420.5 samples/s | 69.1 steps/s
[Step=31350 Epoch=30.6] | Loss=0.01455 | Reg=0.00206 | L2-Norm=14.364 | L2-Norm(final)=3.186 | acc=0.9844 | 4641.4 samples/s | 72.5 steps/s
[Step=31400 Epoch=30.7] | Loss=0.01279 | Reg=0.00206 | L2-Norm=14.366 | L2-Norm(final)=3.187 | acc=1.0000 | 4602.2 samples/s | 71.9 steps/s
[Step=31450 Epoch=30.7] | Loss=0.01182 | Reg=0.00206 | L2-Norm=14.368 | L2-Norm(final)=3.189 | acc=0.9844 | 4631.2 samples/s | 72.4 steps/s
[Step=31500 Epoch=30.8] | Loss=0.01104 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=3.191 | acc=1.0000 | 4681.0 samples/s | 73.1 steps/s
[Step=31550 Epoch=30.8] | Loss=0.01052 | Reg=0.00206 | L2-Norm=14.370 | L2-Norm(final)=3.192 | acc=1.0000 | 4613.7 samples/s | 72.1 steps/s
[Step=31600 Epoch=30.9] | Loss=0.01017 | Reg=0.00207 | L2-Norm=14.371 | L2-Norm(final)=3.194 | acc=1.0000 | 4772.7 samples/s | 74.6 steps/s
[Step=31650 Epoch=30.9] | Loss=0.00978 | Reg=0.00207 | L2-Norm=14.372 | L2-Norm(final)=3.195 | acc=1.0000 | 4680.8 samples/s | 73.1 steps/s
[Step=31700 Epoch=30.9] | Loss=0.00954 | Reg=0.00207 | L2-Norm=14.372 | L2-Norm(final)=3.197 | acc=1.0000 | 4577.1 samples/s | 71.5 steps/s
[Step=31750 Epoch=31.0] | Loss=0.00934 | Reg=0.00207 | L2-Norm=14.373 | L2-Norm(final)=3.198 | acc=1.0000 | 4618.3 samples/s | 72.2 steps/s
[Step=31800 Epoch=31.0] | Loss=0.00917 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=3.199 | acc=1.0000 | 4682.9 samples/s | 73.2 steps/s
[Step=31850 Epoch=31.1] | Loss=0.00905 | Reg=0.00207 | L2-Norm=14.374 | L2-Norm(final)=3.200 | acc=0.9844 | 4603.5 samples/s | 71.9 steps/s
[Step=31900 Epoch=31.1] | Loss=0.00901 | Reg=0.00207 | L2-Norm=14.375 | L2-Norm(final)=3.202 | acc=0.9844 | 4471.0 samples/s | 69.9 steps/s
[Step=31950 Epoch=31.2] | Loss=0.00901 | Reg=0.00207 | L2-Norm=14.375 | L2-Norm(final)=3.203 | acc=1.0000 | 4622.6 samples/s | 72.2 steps/s
[Step=32000 Epoch=31.2] | Loss=0.00887 | Reg=0.00207 | L2-Norm=14.376 | L2-Norm(final)=3.204 | acc=1.0000 | 4670.4 samples/s | 73.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=31201 Epoch=58.8] | Loss=0.02577 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=3.191 | acc=0.9844 | 3392.6 samples/s | 53.0 steps/s
[Step=31250 Epoch=58.9] | Loss=0.00257 | Reg=0.00206 | L2-Norm=14.335 | L2-Norm(final)=3.193 | acc=1.0000 | 4216.1 samples/s | 65.9 steps/s
[Step=31300 Epoch=59.0] | Loss=0.00130 | Reg=0.00206 | L2-Norm=14.337 | L2-Norm(final)=3.193 | acc=1.0000 | 4455.2 samples/s | 69.6 steps/s
[Step=31350 Epoch=59.1] | Loss=0.00087 | Reg=0.00206 | L2-Norm=14.336 | L2-Norm(final)=3.194 | acc=1.0000 | 4375.2 samples/s | 68.4 steps/s
[Step=31400 Epoch=59.2] | Loss=0.00066 | Reg=0.00205 | L2-Norm=14.335 | L2-Norm(final)=3.194 | acc=1.0000 | 4306.1 samples/s | 67.3 steps/s
[Step=31450 Epoch=59.3] | Loss=0.00053 | Reg=0.00205 | L2-Norm=14.334 | L2-Norm(final)=3.194 | acc=1.0000 | 4551.9 samples/s | 71.1 steps/s
[Step=31500 Epoch=59.4] | Loss=0.00044 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=3.195 | acc=1.0000 | 4473.4 samples/s | 69.9 steps/s
[Step=31550 Epoch=59.5] | Loss=0.00038 | Reg=0.00205 | L2-Norm=14.330 | L2-Norm(final)=3.195 | acc=1.0000 | 4275.6 samples/s | 66.8 steps/s
[Step=31600 Epoch=59.6] | Loss=0.00034 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=3.195 | acc=1.0000 | 4524.2 samples/s | 70.7 steps/s
[Step=31650 Epoch=59.7] | Loss=0.00030 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=3.195 | acc=1.0000 | 4429.2 samples/s | 69.2 steps/s
[Step=31700 Epoch=59.8] | Loss=0.00027 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.195 | acc=1.0000 | 4562.5 samples/s | 71.3 steps/s
[Step=31750 Epoch=59.8] | Loss=0.00025 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=3.196 | acc=1.0000 | 1432.5 samples/s | 22.4 steps/s
[Step=31800 Epoch=59.9] | Loss=0.00023 | Reg=0.00205 | L2-Norm=14.321 | L2-Norm(final)=3.196 | acc=1.0000 | 4634.0 samples/s | 72.4 steps/s
[Step=31850 Epoch=60.0] | Loss=0.00021 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=3.196 | acc=1.0000 | 4323.0 samples/s | 67.5 steps/s
[Step=31900 Epoch=60.1] | Loss=0.00020 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=3.196 | acc=1.0000 | 4378.7 samples/s | 68.4 steps/s
[Step=31950 Epoch=60.2] | Loss=0.00018 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=3.197 | acc=1.0000 | 4363.8 samples/s | 68.2 steps/s
[Step=32000 Epoch=60.3] | Loss=0.00017 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=3.197 | acc=1.0000 | 4262.6 samples/s | 66.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23242 | acc=0.8732 | tpr=0.8191 | fpr=0.0094 | 4400.4 samples/s | 17.2 steps/s
Avg test loss: 0.23406, Avg test acc: 0.87243, Avg tpr: 0.81908, Avg fpr: 0.01026, total FA: 80

Testing server on iccad2012
[Step=  50] | Loss=0.59709 | acc=0.8530 | tpr=0.9690 | fpr=0.1490 | 4396.7 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.59610 | acc=0.8539 | tpr=0.9787 | fpr=0.1485 | 9319.9 samples/s | 36.4 steps/s
[Step= 150] | Loss=0.61343 | acc=0.8514 | tpr=0.9841 | fpr=0.1510 | 8414.1 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.61786 | acc=0.8520 | tpr=0.9836 | fpr=0.1504 | 9157.6 samples/s | 35.8 steps/s
[Step= 250] | Loss=0.61720 | acc=0.8519 | tpr=0.9790 | fpr=0.1504 | 8865.1 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.62209 | acc=0.8520 | tpr=0.9796 | fpr=0.1503 | 9099.1 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.62136 | acc=0.8520 | tpr=0.9806 | fpr=0.1504 | 8513.1 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.62449 | acc=0.8517 | tpr=0.9803 | fpr=0.1506 | 9042.6 samples/s | 35.3 steps/s
[Step= 450] | Loss=0.63037 | acc=0.8515 | tpr=0.9800 | fpr=0.1508 | 9098.1 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.63014 | acc=0.8512 | tpr=0.9802 | fpr=0.1511 | 8513.3 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.62867 | acc=0.8514 | tpr=0.9805 | fpr=0.1509 | 16604.8 samples/s | 64.9 steps/s
Avg test loss: 0.62827, Avg test acc: 0.85147, Avg tpr: 0.98059, Avg fpr: 0.15088, total FA: 20949

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=31.2] | Loss=0.14734 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=3.210 | acc=0.8906 | 3327.0 samples/s | 52.0 steps/s
[Step=32050 Epoch=31.3] | Loss=0.02539 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=3.211 | acc=0.9844 | 4471.5 samples/s | 69.9 steps/s
[Step=32100 Epoch=31.3] | Loss=0.01632 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.211 | acc=1.0000 | 4516.4 samples/s | 70.6 steps/s
[Step=32150 Epoch=31.4] | Loss=0.01268 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=3.212 | acc=1.0000 | 4434.3 samples/s | 69.3 steps/s
[Step=32200 Epoch=31.4] | Loss=0.01095 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=3.214 | acc=0.9844 | 4262.4 samples/s | 66.6 steps/s
[Step=32250 Epoch=31.5] | Loss=0.01017 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=3.215 | acc=0.9844 | 4228.1 samples/s | 66.1 steps/s
[Step=32300 Epoch=31.5] | Loss=0.00939 | Reg=0.00205 | L2-Norm=14.328 | L2-Norm(final)=3.216 | acc=1.0000 | 4732.1 samples/s | 73.9 steps/s
[Step=32350 Epoch=31.6] | Loss=0.00899 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=3.217 | acc=1.0000 | 4778.0 samples/s | 74.7 steps/s
[Step=32400 Epoch=31.6] | Loss=0.00872 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=3.217 | acc=0.9844 | 4586.5 samples/s | 71.7 steps/s
[Step=32450 Epoch=31.7] | Loss=0.00836 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=3.218 | acc=1.0000 | 4537.1 samples/s | 70.9 steps/s
[Step=32500 Epoch=31.7] | Loss=0.00819 | Reg=0.00205 | L2-Norm=14.330 | L2-Norm(final)=3.219 | acc=1.0000 | 4701.8 samples/s | 73.5 steps/s
[Step=32550 Epoch=31.8] | Loss=0.00808 | Reg=0.00205 | L2-Norm=14.330 | L2-Norm(final)=3.220 | acc=0.9844 | 4493.6 samples/s | 70.2 steps/s
[Step=32600 Epoch=31.8] | Loss=0.00788 | Reg=0.00205 | L2-Norm=14.331 | L2-Norm(final)=3.221 | acc=0.9688 | 4669.9 samples/s | 73.0 steps/s
[Step=32650 Epoch=31.9] | Loss=0.00769 | Reg=0.00205 | L2-Norm=14.331 | L2-Norm(final)=3.222 | acc=1.0000 | 4228.1 samples/s | 66.1 steps/s
[Step=32700 Epoch=31.9] | Loss=0.00757 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=3.223 | acc=0.9844 | 4066.4 samples/s | 63.5 steps/s
[Step=32750 Epoch=32.0] | Loss=0.00750 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=3.223 | acc=1.0000 | 4029.7 samples/s | 63.0 steps/s
[Step=32800 Epoch=32.0] | Loss=0.00737 | Reg=0.00205 | L2-Norm=14.333 | L2-Norm(final)=3.224 | acc=1.0000 | 4048.4 samples/s | 63.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step32800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32001 Epoch=60.3] | Loss=0.00939 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=3.210 | acc=1.0000 | 2899.7 samples/s | 45.3 steps/s
[Step=32050 Epoch=60.4] | Loss=0.00497 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=3.213 | acc=1.0000 | 4301.5 samples/s | 67.2 steps/s
[Step=32100 Epoch=60.5] | Loss=0.00252 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=3.214 | acc=1.0000 | 4442.6 samples/s | 69.4 steps/s
[Step=32150 Epoch=60.6] | Loss=0.00169 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=3.215 | acc=1.0000 | 4648.9 samples/s | 72.6 steps/s
[Step=32200 Epoch=60.7] | Loss=0.00127 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=3.215 | acc=1.0000 | 4385.0 samples/s | 68.5 steps/s
[Step=32250 Epoch=60.8] | Loss=0.00102 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=3.215 | acc=1.0000 | 4499.0 samples/s | 70.3 steps/s
[Step=32300 Epoch=60.9] | Loss=0.00086 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=3.215 | acc=1.0000 | 4451.0 samples/s | 69.5 steps/s
[Step=32350 Epoch=61.0] | Loss=0.00074 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=3.216 | acc=1.0000 | 4665.6 samples/s | 72.9 steps/s
[Step=32400 Epoch=61.1] | Loss=0.00065 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=3.216 | acc=1.0000 | 4498.0 samples/s | 70.3 steps/s
[Step=32450 Epoch=61.2] | Loss=0.00058 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=3.216 | acc=1.0000 | 4422.3 samples/s | 69.1 steps/s
[Step=32500 Epoch=61.3] | Loss=0.00052 | Reg=0.00205 | L2-Norm=14.316 | L2-Norm(final)=3.216 | acc=1.0000 | 4478.3 samples/s | 70.0 steps/s
[Step=32550 Epoch=61.4] | Loss=0.00048 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=3.216 | acc=1.0000 | 1482.5 samples/s | 23.2 steps/s
[Step=32600 Epoch=61.5] | Loss=0.00044 | Reg=0.00205 | L2-Norm=14.314 | L2-Norm(final)=3.217 | acc=1.0000 | 4485.6 samples/s | 70.1 steps/s
[Step=32650 Epoch=61.5] | Loss=0.00040 | Reg=0.00205 | L2-Norm=14.314 | L2-Norm(final)=3.217 | acc=1.0000 | 4437.0 samples/s | 69.3 steps/s
[Step=32700 Epoch=61.6] | Loss=0.00038 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=3.217 | acc=1.0000 | 4234.1 samples/s | 66.2 steps/s
[Step=32750 Epoch=61.7] | Loss=0.00035 | Reg=0.00205 | L2-Norm=14.312 | L2-Norm(final)=3.217 | acc=1.0000 | 4287.8 samples/s | 67.0 steps/s
[Step=32800 Epoch=61.8] | Loss=0.00033 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=3.217 | acc=1.0000 | 4448.5 samples/s | 69.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27743 | acc=0.8593 | tpr=0.7984 | fpr=0.0084 | 4442.1 samples/s | 17.4 steps/s
Avg test loss: 0.28085, Avg test acc: 0.85760, Avg tpr: 0.79682, Avg fpr: 0.00872, total FA: 68

Testing server on iccad2012
[Step=  50] | Loss=0.52778 | acc=0.8779 | tpr=0.9558 | fpr=0.1235 | 4389.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.52743 | acc=0.8796 | tpr=0.9723 | fpr=0.1221 | 8871.7 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.54363 | acc=0.8769 | tpr=0.9798 | fpr=0.1250 | 8618.5 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.54847 | acc=0.8775 | tpr=0.9803 | fpr=0.1244 | 8720.3 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.54787 | acc=0.8773 | tpr=0.9764 | fpr=0.1245 | 9578.2 samples/s | 37.4 steps/s
[Step= 300] | Loss=0.55253 | acc=0.8771 | tpr=0.9775 | fpr=0.1248 | 8216.7 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.55175 | acc=0.8769 | tpr=0.9775 | fpr=0.1249 | 8895.4 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.55496 | acc=0.8766 | tpr=0.9776 | fpr=0.1252 | 8805.7 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.56083 | acc=0.8765 | tpr=0.9771 | fpr=0.1253 | 8833.6 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.56023 | acc=0.8761 | tpr=0.9775 | fpr=0.1257 | 8685.1 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.55886 | acc=0.8762 | tpr=0.9773 | fpr=0.1257 | 16320.9 samples/s | 63.8 steps/s
Avg test loss: 0.55835, Avg test acc: 0.87625, Avg tpr: 0.97742, Avg fpr: 0.12559, total FA: 17438

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=32.0] | Loss=0.19384 | Reg=0.00205 | L2-Norm=14.305 | L2-Norm(final)=3.228 | acc=0.8594 | 3459.3 samples/s | 54.1 steps/s
[Step=32850 Epoch=32.1] | Loss=0.02329 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=3.227 | acc=1.0000 | 4580.1 samples/s | 71.6 steps/s
[Step=32900 Epoch=32.1] | Loss=0.01467 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=3.227 | acc=1.0000 | 4503.1 samples/s | 70.4 steps/s
[Step=32950 Epoch=32.2] | Loss=0.01215 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.229 | acc=1.0000 | 4568.2 samples/s | 71.4 steps/s
[Step=33000 Epoch=32.2] | Loss=0.01062 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.230 | acc=1.0000 | 4516.9 samples/s | 70.6 steps/s
[Step=33050 Epoch=32.3] | Loss=0.00966 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=3.231 | acc=1.0000 | 4810.0 samples/s | 75.2 steps/s
[Step=33100 Epoch=32.3] | Loss=0.00923 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=3.232 | acc=1.0000 | 4734.9 samples/s | 74.0 steps/s
[Step=33150 Epoch=32.4] | Loss=0.00874 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=3.232 | acc=0.9688 | 4471.9 samples/s | 69.9 steps/s
[Step=33200 Epoch=32.4] | Loss=0.00832 | Reg=0.00205 | L2-Norm=14.327 | L2-Norm(final)=3.233 | acc=1.0000 | 4012.3 samples/s | 62.7 steps/s
[Step=33250 Epoch=32.5] | Loss=0.00801 | Reg=0.00205 | L2-Norm=14.328 | L2-Norm(final)=3.234 | acc=0.9844 | 3745.3 samples/s | 58.5 steps/s
[Step=33300 Epoch=32.5] | Loss=0.00792 | Reg=0.00205 | L2-Norm=14.328 | L2-Norm(final)=3.235 | acc=1.0000 | 4065.2 samples/s | 63.5 steps/s
[Step=33350 Epoch=32.6] | Loss=0.00791 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=3.236 | acc=1.0000 | 3984.6 samples/s | 62.3 steps/s
[Step=33400 Epoch=32.6] | Loss=0.00767 | Reg=0.00205 | L2-Norm=14.329 | L2-Norm(final)=3.237 | acc=1.0000 | 4057.6 samples/s | 63.4 steps/s
[Step=33450 Epoch=32.7] | Loss=0.00757 | Reg=0.00205 | L2-Norm=14.330 | L2-Norm(final)=3.238 | acc=1.0000 | 3790.3 samples/s | 59.2 steps/s
[Step=33500 Epoch=32.7] | Loss=0.00734 | Reg=0.00205 | L2-Norm=14.330 | L2-Norm(final)=3.239 | acc=1.0000 | 3699.0 samples/s | 57.8 steps/s
[Step=33550 Epoch=32.8] | Loss=0.00718 | Reg=0.00205 | L2-Norm=14.330 | L2-Norm(final)=3.239 | acc=0.9844 | 4016.3 samples/s | 62.8 steps/s
[Step=33600 Epoch=32.8] | Loss=0.00726 | Reg=0.00205 | L2-Norm=14.331 | L2-Norm(final)=3.240 | acc=0.9844 | 4011.3 samples/s | 62.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step33600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=32801 Epoch=61.8] | Loss=0.00794 | Reg=0.00205 | L2-Norm=14.305 | L2-Norm(final)=3.228 | acc=0.9844 | 3095.2 samples/s | 48.4 steps/s
[Step=32850 Epoch=61.9] | Loss=0.00452 | Reg=0.00205 | L2-Norm=14.316 | L2-Norm(final)=3.233 | acc=1.0000 | 3979.8 samples/s | 62.2 steps/s
[Step=32900 Epoch=62.0] | Loss=0.00229 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=3.234 | acc=1.0000 | 4343.3 samples/s | 67.9 steps/s
[Step=32950 Epoch=62.1] | Loss=0.00154 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=3.234 | acc=1.0000 | 4512.9 samples/s | 70.5 steps/s
[Step=33000 Epoch=62.2] | Loss=0.00116 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=3.235 | acc=1.0000 | 4286.1 samples/s | 67.0 steps/s
[Step=33050 Epoch=62.3] | Loss=0.00093 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=3.235 | acc=1.0000 | 3898.9 samples/s | 60.9 steps/s
[Step=33100 Epoch=62.4] | Loss=0.00078 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=3.235 | acc=1.0000 | 3496.2 samples/s | 54.6 steps/s
[Step=33150 Epoch=62.5] | Loss=0.00067 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=3.235 | acc=1.0000 | 3738.0 samples/s | 58.4 steps/s
[Step=33200 Epoch=62.6] | Loss=0.00059 | Reg=0.00205 | L2-Norm=14.316 | L2-Norm(final)=3.235 | acc=1.0000 | 3893.7 samples/s | 60.8 steps/s
[Step=33250 Epoch=62.7] | Loss=0.00052 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=3.236 | acc=1.0000 | 3815.2 samples/s | 59.6 steps/s
[Step=33300 Epoch=62.8] | Loss=0.00047 | Reg=0.00205 | L2-Norm=14.314 | L2-Norm(final)=3.236 | acc=1.0000 | 3821.2 samples/s | 59.7 steps/s
[Step=33350 Epoch=62.9] | Loss=0.00043 | Reg=0.00205 | L2-Norm=14.314 | L2-Norm(final)=3.236 | acc=1.0000 | 1519.3 samples/s | 23.7 steps/s
[Step=33400 Epoch=63.0] | Loss=0.00040 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=3.236 | acc=1.0000 | 4412.6 samples/s | 68.9 steps/s
[Step=33450 Epoch=63.1] | Loss=0.00037 | Reg=0.00205 | L2-Norm=14.312 | L2-Norm(final)=3.236 | acc=1.0000 | 4392.3 samples/s | 68.6 steps/s
[Step=33500 Epoch=63.1] | Loss=0.00034 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=3.236 | acc=1.0000 | 4262.7 samples/s | 66.6 steps/s
[Step=33550 Epoch=63.2] | Loss=0.00032 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.237 | acc=1.0000 | 4425.7 samples/s | 69.2 steps/s
[Step=33600 Epoch=63.3] | Loss=0.00030 | Reg=0.00205 | L2-Norm=14.309 | L2-Norm(final)=3.237 | acc=1.0000 | 4464.7 samples/s | 69.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23475 | acc=0.8830 | tpr=0.8339 | fpr=0.0104 | 4253.0 samples/s | 16.6 steps/s
Avg test loss: 0.23736, Avg test acc: 0.87976, Avg tpr: 0.83004, Avg fpr: 0.01090, total FA: 85

Testing server on iccad2012
[Step=  50] | Loss=0.58998 | acc=0.8673 | tpr=0.9602 | fpr=0.1343 | 4357.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.58956 | acc=0.8688 | tpr=0.9765 | fpr=0.1333 | 8787.0 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.60706 | acc=0.8659 | tpr=0.9841 | fpr=0.1363 | 8889.2 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.61196 | acc=0.8667 | tpr=0.9836 | fpr=0.1354 | 8809.6 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.61147 | acc=0.8665 | tpr=0.9790 | fpr=0.1355 | 9147.6 samples/s | 35.7 steps/s
[Step= 300] | Loss=0.61622 | acc=0.8664 | tpr=0.9796 | fpr=0.1356 | 8799.9 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.61525 | acc=0.8664 | tpr=0.9787 | fpr=0.1357 | 8729.9 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.61857 | acc=0.8662 | tpr=0.9792 | fpr=0.1359 | 8795.9 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.62467 | acc=0.8660 | tpr=0.9796 | fpr=0.1361 | 9123.1 samples/s | 35.6 steps/s
[Step= 500] | Loss=0.62409 | acc=0.8657 | tpr=0.9797 | fpr=0.1364 | 8933.0 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.62269 | acc=0.8658 | tpr=0.9797 | fpr=0.1363 | 16841.6 samples/s | 65.8 steps/s
Avg test loss: 0.62211, Avg test acc: 0.86586, Avg tpr: 0.97979, Avg fpr: 0.13621, total FA: 18912

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=32.8] | Loss=0.22245 | Reg=0.00204 | L2-Norm=14.300 | L2-Norm(final)=3.245 | acc=0.8750 | 3436.0 samples/s | 53.7 steps/s
[Step=33650 Epoch=32.9] | Loss=0.01800 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=3.244 | acc=1.0000 | 4492.1 samples/s | 70.2 steps/s
[Step=33700 Epoch=32.9] | Loss=0.01187 | Reg=0.00205 | L2-Norm=14.316 | L2-Norm(final)=3.245 | acc=1.0000 | 4562.3 samples/s | 71.3 steps/s
[Step=33750 Epoch=33.0] | Loss=0.00984 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=3.247 | acc=0.9844 | 4574.3 samples/s | 71.5 steps/s
[Step=33800 Epoch=33.0] | Loss=0.00846 | Reg=0.00205 | L2-Norm=14.319 | L2-Norm(final)=3.248 | acc=1.0000 | 4631.8 samples/s | 72.4 steps/s
[Step=33850 Epoch=33.0] | Loss=0.00808 | Reg=0.00205 | L2-Norm=14.320 | L2-Norm(final)=3.249 | acc=0.9844 | 4526.2 samples/s | 70.7 steps/s
[Step=33900 Epoch=33.1] | Loss=0.00784 | Reg=0.00205 | L2-Norm=14.321 | L2-Norm(final)=3.250 | acc=0.9844 | 4379.0 samples/s | 68.4 steps/s
[Step=33950 Epoch=33.1] | Loss=0.00762 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=3.251 | acc=0.9844 | 4578.7 samples/s | 71.5 steps/s
[Step=34000 Epoch=33.2] | Loss=0.00734 | Reg=0.00205 | L2-Norm=14.322 | L2-Norm(final)=3.252 | acc=0.9688 | 4657.8 samples/s | 72.8 steps/s
[Step=34050 Epoch=33.2] | Loss=0.00724 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=3.253 | acc=1.0000 | 4659.4 samples/s | 72.8 steps/s
[Step=34100 Epoch=33.3] | Loss=0.00720 | Reg=0.00205 | L2-Norm=14.323 | L2-Norm(final)=3.253 | acc=1.0000 | 4514.8 samples/s | 70.5 steps/s
[Step=34150 Epoch=33.3] | Loss=0.00719 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.254 | acc=1.0000 | 4513.7 samples/s | 70.5 steps/s
[Step=34200 Epoch=33.4] | Loss=0.00700 | Reg=0.00205 | L2-Norm=14.324 | L2-Norm(final)=3.255 | acc=1.0000 | 4582.4 samples/s | 71.6 steps/s
[Step=34250 Epoch=33.4] | Loss=0.00689 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.256 | acc=1.0000 | 4050.0 samples/s | 63.3 steps/s
[Step=34300 Epoch=33.5] | Loss=0.00675 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.257 | acc=1.0000 | 3720.1 samples/s | 58.1 steps/s
[Step=34350 Epoch=33.5] | Loss=0.00667 | Reg=0.00205 | L2-Norm=14.325 | L2-Norm(final)=3.257 | acc=1.0000 | 3860.4 samples/s | 60.3 steps/s
[Step=34400 Epoch=33.6] | Loss=0.00670 | Reg=0.00205 | L2-Norm=14.326 | L2-Norm(final)=3.258 | acc=0.9844 | 4079.4 samples/s | 63.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step34400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=33601 Epoch=63.3] | Loss=0.13712 | Reg=0.00204 | L2-Norm=14.300 | L2-Norm(final)=3.245 | acc=0.9531 | 2890.1 samples/s | 45.2 steps/s
[Step=33650 Epoch=63.4] | Loss=0.00948 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.248 | acc=1.0000 | 3774.7 samples/s | 59.0 steps/s
[Step=33700 Epoch=63.5] | Loss=0.00476 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=3.249 | acc=1.0000 | 4515.5 samples/s | 70.6 steps/s
[Step=33750 Epoch=63.6] | Loss=0.00318 | Reg=0.00205 | L2-Norm=14.314 | L2-Norm(final)=3.249 | acc=1.0000 | 4283.6 samples/s | 66.9 steps/s
[Step=33800 Epoch=63.7] | Loss=0.00239 | Reg=0.00205 | L2-Norm=14.314 | L2-Norm(final)=3.250 | acc=1.0000 | 4380.7 samples/s | 68.4 steps/s
[Step=33850 Epoch=63.8] | Loss=0.00191 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=3.250 | acc=1.0000 | 4391.5 samples/s | 68.6 steps/s
[Step=33900 Epoch=63.9] | Loss=0.00160 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=3.250 | acc=1.0000 | 4244.3 samples/s | 66.3 steps/s
[Step=33950 Epoch=64.0] | Loss=0.00137 | Reg=0.00205 | L2-Norm=14.312 | L2-Norm(final)=3.250 | acc=1.0000 | 4323.3 samples/s | 67.6 steps/s
[Step=34000 Epoch=64.1] | Loss=0.00120 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=3.250 | acc=1.0000 | 4371.3 samples/s | 68.3 steps/s
[Step=34050 Epoch=64.2] | Loss=0.00107 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.250 | acc=1.0000 | 4378.3 samples/s | 68.4 steps/s
[Step=34100 Epoch=64.3] | Loss=0.00096 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.250 | acc=1.0000 | 4441.0 samples/s | 69.4 steps/s
[Step=34150 Epoch=64.4] | Loss=0.00088 | Reg=0.00205 | L2-Norm=14.309 | L2-Norm(final)=3.250 | acc=1.0000 | 1450.1 samples/s | 22.7 steps/s
[Step=34200 Epoch=64.5] | Loss=0.00080 | Reg=0.00205 | L2-Norm=14.308 | L2-Norm(final)=3.250 | acc=1.0000 | 4386.1 samples/s | 68.5 steps/s
[Step=34250 Epoch=64.6] | Loss=0.00074 | Reg=0.00205 | L2-Norm=14.307 | L2-Norm(final)=3.250 | acc=1.0000 | 4301.6 samples/s | 67.2 steps/s
[Step=34300 Epoch=64.7] | Loss=0.00069 | Reg=0.00205 | L2-Norm=14.306 | L2-Norm(final)=3.250 | acc=1.0000 | 4274.4 samples/s | 66.8 steps/s
[Step=34350 Epoch=64.8] | Loss=0.00064 | Reg=0.00205 | L2-Norm=14.305 | L2-Norm(final)=3.251 | acc=1.0000 | 4344.2 samples/s | 67.9 steps/s
[Step=34400 Epoch=64.8] | Loss=0.00060 | Reg=0.00205 | L2-Norm=14.305 | L2-Norm(final)=3.251 | acc=1.0000 | 4249.1 samples/s | 66.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.25952 | acc=0.8721 | tpr=0.8175 | fpr=0.0094 | 4474.7 samples/s | 17.5 steps/s
Avg test loss: 0.26163, Avg test acc: 0.86930, Avg tpr: 0.81454, Avg fpr: 0.01026, total FA: 80

Testing server on iccad2012
[Step=  50] | Loss=0.53540 | acc=0.8840 | tpr=0.9602 | fpr=0.1174 | 4438.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.53528 | acc=0.8847 | tpr=0.9744 | fpr=0.1170 | 8956.5 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.55184 | acc=0.8825 | tpr=0.9827 | fpr=0.1193 | 8619.0 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.55699 | acc=0.8830 | tpr=0.9825 | fpr=0.1188 | 8743.8 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.55644 | acc=0.8826 | tpr=0.9782 | fpr=0.1191 | 9137.9 samples/s | 35.7 steps/s
[Step= 300] | Loss=0.56157 | acc=0.8823 | tpr=0.9789 | fpr=0.1194 | 8759.7 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.56092 | acc=0.8820 | tpr=0.9787 | fpr=0.1197 | 9349.0 samples/s | 36.5 steps/s
[Step= 400] | Loss=0.56424 | acc=0.8818 | tpr=0.9781 | fpr=0.1199 | 8688.6 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.57029 | acc=0.8816 | tpr=0.9781 | fpr=0.1201 | 8609.2 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.56945 | acc=0.8813 | tpr=0.9784 | fpr=0.1205 | 9198.0 samples/s | 35.9 steps/s
[Step= 550] | Loss=0.56806 | acc=0.8813 | tpr=0.9781 | fpr=0.1204 | 16851.8 samples/s | 65.8 steps/s
Avg test loss: 0.56753, Avg test acc: 0.88144, Avg tpr: 0.97821, Avg fpr: 0.12032, total FA: 16706

server round 43/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=33.6] | Loss=0.09843 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=3.260 | acc=0.9219 | 3433.1 samples/s | 53.6 steps/s
[Step=34450 Epoch=33.6] | Loss=0.02406 | Reg=0.00205 | L2-Norm=14.307 | L2-Norm(final)=3.258 | acc=1.0000 | 4568.7 samples/s | 71.4 steps/s
[Step=34500 Epoch=33.7] | Loss=0.01497 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.258 | acc=1.0000 | 4644.8 samples/s | 72.6 steps/s
[Step=34550 Epoch=33.7] | Loss=0.01177 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=3.259 | acc=1.0000 | 4703.4 samples/s | 73.5 steps/s
[Step=34600 Epoch=33.8] | Loss=0.01008 | Reg=0.00205 | L2-Norm=14.312 | L2-Norm(final)=3.260 | acc=1.0000 | 4614.0 samples/s | 72.1 steps/s
[Step=34650 Epoch=33.8] | Loss=0.00932 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=3.261 | acc=1.0000 | 4578.2 samples/s | 71.5 steps/s
[Step=34700 Epoch=33.9] | Loss=0.00873 | Reg=0.00205 | L2-Norm=14.313 | L2-Norm(final)=3.262 | acc=1.0000 | 4700.8 samples/s | 73.4 steps/s
[Step=34750 Epoch=33.9] | Loss=0.00822 | Reg=0.00205 | L2-Norm=14.314 | L2-Norm(final)=3.262 | acc=0.9844 | 4597.4 samples/s | 71.8 steps/s
[Step=34800 Epoch=34.0] | Loss=0.00788 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=3.263 | acc=1.0000 | 4627.0 samples/s | 72.3 steps/s
[Step=34850 Epoch=34.0] | Loss=0.00763 | Reg=0.00205 | L2-Norm=14.315 | L2-Norm(final)=3.264 | acc=1.0000 | 4632.5 samples/s | 72.4 steps/s
[Step=34900 Epoch=34.1] | Loss=0.00747 | Reg=0.00205 | L2-Norm=14.316 | L2-Norm(final)=3.265 | acc=0.9688 | 4526.8 samples/s | 70.7 steps/s
[Step=34950 Epoch=34.1] | Loss=0.00740 | Reg=0.00205 | L2-Norm=14.316 | L2-Norm(final)=3.266 | acc=1.0000 | 4532.0 samples/s | 70.8 steps/s
[Step=35000 Epoch=34.2] | Loss=0.00729 | Reg=0.00205 | L2-Norm=14.316 | L2-Norm(final)=3.267 | acc=1.0000 | 4558.2 samples/s | 71.2 steps/s
[Step=35050 Epoch=34.2] | Loss=0.00717 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=3.268 | acc=0.9844 | 4721.0 samples/s | 73.8 steps/s
[Step=35100 Epoch=34.3] | Loss=0.00706 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=3.269 | acc=1.0000 | 4499.8 samples/s | 70.3 steps/s
[Step=35150 Epoch=34.3] | Loss=0.00703 | Reg=0.00205 | L2-Norm=14.317 | L2-Norm(final)=3.270 | acc=0.9844 | 4675.3 samples/s | 73.1 steps/s
[Step=35200 Epoch=34.4] | Loss=0.00694 | Reg=0.00205 | L2-Norm=14.318 | L2-Norm(final)=3.271 | acc=0.9844 | 4665.0 samples/s | 72.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step35200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=34401 Epoch=64.8] | Loss=0.04995 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=3.261 | acc=0.9844 | 3139.0 samples/s | 49.0 steps/s
[Step=34450 Epoch=64.9] | Loss=0.00661 | Reg=0.00205 | L2-Norm=14.301 | L2-Norm(final)=3.263 | acc=1.0000 | 4071.8 samples/s | 63.6 steps/s
[Step=34500 Epoch=65.0] | Loss=0.00332 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=3.263 | acc=1.0000 | 4315.6 samples/s | 67.4 steps/s
[Step=34550 Epoch=65.1] | Loss=0.00222 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=3.263 | acc=1.0000 | 4334.6 samples/s | 67.7 steps/s
[Step=34600 Epoch=65.2] | Loss=0.00168 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=3.263 | acc=1.0000 | 4350.1 samples/s | 68.0 steps/s
[Step=34650 Epoch=65.3] | Loss=0.00135 | Reg=0.00205 | L2-Norm=14.302 | L2-Norm(final)=3.263 | acc=1.0000 | 4395.3 samples/s | 68.7 steps/s
[Step=34700 Epoch=65.4] | Loss=0.00112 | Reg=0.00205 | L2-Norm=14.302 | L2-Norm(final)=3.263 | acc=1.0000 | 4342.9 samples/s | 67.9 steps/s
[Step=34750 Epoch=65.5] | Loss=0.00097 | Reg=0.00205 | L2-Norm=14.301 | L2-Norm(final)=3.264 | acc=1.0000 | 4254.0 samples/s | 66.5 steps/s
[Step=34800 Epoch=65.6] | Loss=0.00085 | Reg=0.00204 | L2-Norm=14.300 | L2-Norm(final)=3.264 | acc=1.0000 | 4368.5 samples/s | 68.3 steps/s
[Step=34850 Epoch=65.7] | Loss=0.00075 | Reg=0.00204 | L2-Norm=14.300 | L2-Norm(final)=3.264 | acc=1.0000 | 4445.3 samples/s | 69.5 steps/s
[Step=34900 Epoch=65.8] | Loss=0.00068 | Reg=0.00204 | L2-Norm=14.299 | L2-Norm(final)=3.264 | acc=1.0000 | 4223.4 samples/s | 66.0 steps/s
[Step=34950 Epoch=65.9] | Loss=0.00062 | Reg=0.00204 | L2-Norm=14.298 | L2-Norm(final)=3.264 | acc=1.0000 | 1555.1 samples/s | 24.3 steps/s
[Step=35000 Epoch=66.0] | Loss=0.00057 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.264 | acc=1.0000 | 4335.3 samples/s | 67.7 steps/s
[Step=35050 Epoch=66.1] | Loss=0.00053 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.264 | acc=1.0000 | 4400.0 samples/s | 68.8 steps/s
[Step=35100 Epoch=66.2] | Loss=0.00049 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.264 | acc=1.0000 | 4356.2 samples/s | 68.1 steps/s
[Step=35150 Epoch=66.3] | Loss=0.00046 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=3.264 | acc=1.0000 | 4282.8 samples/s | 66.9 steps/s
[Step=35200 Epoch=66.4] | Loss=0.00043 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=3.264 | acc=1.0000 | 4430.3 samples/s | 69.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.22824 | acc=0.8878 | tpr=0.8409 | fpr=0.0104 | 4438.3 samples/s | 17.3 steps/s
Avg test loss: 0.23014, Avg test acc: 0.88601, Avg tpr: 0.83925, Avg fpr: 0.01115, total FA: 87

Testing server on iccad2012
[Step=  50] | Loss=0.57035 | acc=0.8742 | tpr=0.9602 | fpr=0.1273 | 4447.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.56881 | acc=0.8750 | tpr=0.9744 | fpr=0.1269 | 9162.2 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.58569 | acc=0.8722 | tpr=0.9827 | fpr=0.1298 | 8805.0 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.59012 | acc=0.8728 | tpr=0.9814 | fpr=0.1292 | 8885.7 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.58982 | acc=0.8722 | tpr=0.9773 | fpr=0.1298 | 8625.5 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.59469 | acc=0.8720 | tpr=0.9782 | fpr=0.1299 | 8909.4 samples/s | 34.8 steps/s
[Step= 350] | Loss=0.59418 | acc=0.8719 | tpr=0.9781 | fpr=0.1300 | 8878.7 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.59766 | acc=0.8717 | tpr=0.9787 | fpr=0.1302 | 9089.7 samples/s | 35.5 steps/s
[Step= 450] | Loss=0.60385 | acc=0.8713 | tpr=0.9786 | fpr=0.1306 | 8735.8 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.60336 | acc=0.8709 | tpr=0.9789 | fpr=0.1311 | 8576.9 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.60193 | acc=0.8710 | tpr=0.9793 | fpr=0.1310 | 11372.1 samples/s | 44.4 steps/s
Avg test loss: 0.60135, Avg test acc: 0.87110, Avg tpr: 0.97940, Avg fpr: 0.13087, total FA: 18171

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=34.4] | Loss=0.17256 | Reg=0.00204 | L2-Norm=14.289 | L2-Norm(final)=3.274 | acc=0.9219 | 3890.7 samples/s | 60.8 steps/s
[Step=35250 Epoch=34.4] | Loss=0.01847 | Reg=0.00205 | L2-Norm=14.300 | L2-Norm(final)=3.273 | acc=1.0000 | 3863.4 samples/s | 60.4 steps/s
[Step=35300 Epoch=34.5] | Loss=0.01275 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=3.274 | acc=1.0000 | 4465.3 samples/s | 69.8 steps/s
[Step=35350 Epoch=34.5] | Loss=0.01059 | Reg=0.00205 | L2-Norm=14.305 | L2-Norm(final)=3.275 | acc=1.0000 | 4594.5 samples/s | 71.8 steps/s
[Step=35400 Epoch=34.6] | Loss=0.00944 | Reg=0.00205 | L2-Norm=14.306 | L2-Norm(final)=3.276 | acc=0.9844 | 4509.0 samples/s | 70.5 steps/s
[Step=35450 Epoch=34.6] | Loss=0.00844 | Reg=0.00205 | L2-Norm=14.307 | L2-Norm(final)=3.277 | acc=1.0000 | 4484.5 samples/s | 70.1 steps/s
[Step=35500 Epoch=34.7] | Loss=0.00804 | Reg=0.00205 | L2-Norm=14.308 | L2-Norm(final)=3.279 | acc=1.0000 | 4607.5 samples/s | 72.0 steps/s
[Step=35550 Epoch=34.7] | Loss=0.00771 | Reg=0.00205 | L2-Norm=14.308 | L2-Norm(final)=3.280 | acc=1.0000 | 4481.2 samples/s | 70.0 steps/s
[Step=35600 Epoch=34.8] | Loss=0.00753 | Reg=0.00205 | L2-Norm=14.309 | L2-Norm(final)=3.281 | acc=1.0000 | 4669.7 samples/s | 73.0 steps/s
[Step=35650 Epoch=34.8] | Loss=0.00734 | Reg=0.00205 | L2-Norm=14.309 | L2-Norm(final)=3.281 | acc=1.0000 | 4528.1 samples/s | 70.8 steps/s
[Step=35700 Epoch=34.9] | Loss=0.00717 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.282 | acc=1.0000 | 4553.0 samples/s | 71.1 steps/s
[Step=35750 Epoch=34.9] | Loss=0.00715 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.283 | acc=1.0000 | 4715.9 samples/s | 73.7 steps/s
[Step=35800 Epoch=35.0] | Loss=0.00705 | Reg=0.00205 | L2-Norm=14.310 | L2-Norm(final)=3.284 | acc=1.0000 | 4602.5 samples/s | 71.9 steps/s
[Step=35850 Epoch=35.0] | Loss=0.00697 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=3.284 | acc=0.9844 | 4528.5 samples/s | 70.8 steps/s
[Step=35900 Epoch=35.1] | Loss=0.00685 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=3.285 | acc=1.0000 | 4638.1 samples/s | 72.5 steps/s
[Step=35950 Epoch=35.1] | Loss=0.00677 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=3.286 | acc=0.9688 | 4669.7 samples/s | 73.0 steps/s
[Step=36000 Epoch=35.1] | Loss=0.00675 | Reg=0.00205 | L2-Norm=14.312 | L2-Norm(final)=3.287 | acc=1.0000 | 4607.7 samples/s | 72.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=35201 Epoch=66.4] | Loss=0.02196 | Reg=0.00204 | L2-Norm=14.289 | L2-Norm(final)=3.275 | acc=0.9688 | 3882.2 samples/s | 60.7 steps/s
[Step=35250 Epoch=66.4] | Loss=0.00646 | Reg=0.00204 | L2-Norm=14.299 | L2-Norm(final)=3.279 | acc=1.0000 | 3811.8 samples/s | 59.6 steps/s
[Step=35300 Epoch=66.5] | Loss=0.00325 | Reg=0.00205 | L2-Norm=14.301 | L2-Norm(final)=3.279 | acc=1.0000 | 4160.1 samples/s | 65.0 steps/s
[Step=35350 Epoch=66.6] | Loss=0.00217 | Reg=0.00205 | L2-Norm=14.301 | L2-Norm(final)=3.280 | acc=1.0000 | 3897.6 samples/s | 60.9 steps/s
[Step=35400 Epoch=66.7] | Loss=0.00163 | Reg=0.00205 | L2-Norm=14.301 | L2-Norm(final)=3.280 | acc=1.0000 | 3803.9 samples/s | 59.4 steps/s
[Step=35450 Epoch=66.8] | Loss=0.00131 | Reg=0.00204 | L2-Norm=14.300 | L2-Norm(final)=3.280 | acc=1.0000 | 3798.4 samples/s | 59.3 steps/s
[Step=35500 Epoch=66.9] | Loss=0.00109 | Reg=0.00204 | L2-Norm=14.300 | L2-Norm(final)=3.280 | acc=1.0000 | 3839.7 samples/s | 60.0 steps/s
[Step=35550 Epoch=67.0] | Loss=0.00094 | Reg=0.00204 | L2-Norm=14.299 | L2-Norm(final)=3.280 | acc=1.0000 | 3792.0 samples/s | 59.3 steps/s
[Step=35600 Epoch=67.1] | Loss=0.00082 | Reg=0.00204 | L2-Norm=14.299 | L2-Norm(final)=3.280 | acc=1.0000 | 3757.4 samples/s | 58.7 steps/s
[Step=35650 Epoch=67.2] | Loss=0.00074 | Reg=0.00204 | L2-Norm=14.298 | L2-Norm(final)=3.281 | acc=1.0000 | 3848.1 samples/s | 60.1 steps/s
[Step=35700 Epoch=67.3] | Loss=0.00066 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.281 | acc=1.0000 | 3917.6 samples/s | 61.2 steps/s
[Step=35750 Epoch=67.4] | Loss=0.00060 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.281 | acc=1.0000 | 1510.8 samples/s | 23.6 steps/s
[Step=35800 Epoch=67.5] | Loss=0.00055 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.281 | acc=1.0000 | 4575.6 samples/s | 71.5 steps/s
[Step=35850 Epoch=67.6] | Loss=0.00051 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=3.282 | acc=1.0000 | 4429.6 samples/s | 69.2 steps/s
[Step=35900 Epoch=67.7] | Loss=0.00048 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=3.282 | acc=1.0000 | 4465.6 samples/s | 69.8 steps/s
[Step=35950 Epoch=67.8] | Loss=0.00044 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=3.282 | acc=1.0000 | 4485.6 samples/s | 70.1 steps/s
[Step=36000 Epoch=67.9] | Loss=0.00042 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=3.282 | acc=1.0000 | 4612.1 samples/s | 72.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.24550 | acc=0.8826 | tpr=0.8326 | fpr=0.0089 | 4258.6 samples/s | 16.6 steps/s
Avg test loss: 0.24697, Avg test acc: 0.88020, Avg tpr: 0.83039, Avg fpr: 0.01026, total FA: 80

Testing server on iccad2012
[Step=  50] | Loss=0.56053 | acc=0.8777 | tpr=0.9602 | fpr=0.1238 | 4421.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.55989 | acc=0.8784 | tpr=0.9723 | fpr=0.1234 | 9083.6 samples/s | 35.5 steps/s
[Step= 150] | Loss=0.57702 | acc=0.8756 | tpr=0.9798 | fpr=0.1263 | 8854.0 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.58160 | acc=0.8762 | tpr=0.9792 | fpr=0.1257 | 9157.2 samples/s | 35.8 steps/s
[Step= 250] | Loss=0.58127 | acc=0.8759 | tpr=0.9755 | fpr=0.1259 | 9012.0 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.58639 | acc=0.8756 | tpr=0.9760 | fpr=0.1262 | 9080.6 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.58596 | acc=0.8754 | tpr=0.9762 | fpr=0.1264 | 9023.3 samples/s | 35.2 steps/s
[Step= 400] | Loss=0.58926 | acc=0.8753 | tpr=0.9765 | fpr=0.1266 | 9106.1 samples/s | 35.6 steps/s
[Step= 450] | Loss=0.59566 | acc=0.8751 | tpr=0.9757 | fpr=0.1267 | 6635.4 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.59500 | acc=0.8748 | tpr=0.9762 | fpr=0.1270 | 7108.5 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.59354 | acc=0.8748 | tpr=0.9765 | fpr=0.1270 | 17387.0 samples/s | 67.9 steps/s
Avg test loss: 0.59302, Avg test acc: 0.87493, Avg tpr: 0.97662, Avg fpr: 0.12692, total FA: 17622

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=35.1] | Loss=0.03734 | Reg=0.00204 | L2-Norm=14.285 | L2-Norm(final)=3.292 | acc=0.9688 | 3480.5 samples/s | 54.4 steps/s
[Step=36050 Epoch=35.2] | Loss=0.01621 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.291 | acc=0.9844 | 4619.3 samples/s | 72.2 steps/s
[Step=36100 Epoch=35.2] | Loss=0.01219 | Reg=0.00204 | L2-Norm=14.300 | L2-Norm(final)=3.291 | acc=1.0000 | 4736.0 samples/s | 74.0 steps/s
[Step=36150 Epoch=35.3] | Loss=0.00979 | Reg=0.00205 | L2-Norm=14.301 | L2-Norm(final)=3.292 | acc=0.9844 | 4638.3 samples/s | 72.5 steps/s
[Step=36200 Epoch=35.3] | Loss=0.00891 | Reg=0.00205 | L2-Norm=14.302 | L2-Norm(final)=3.294 | acc=1.0000 | 3970.0 samples/s | 62.0 steps/s
[Step=36250 Epoch=35.4] | Loss=0.00825 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=3.295 | acc=0.9844 | 4003.4 samples/s | 62.6 steps/s
[Step=36300 Epoch=35.4] | Loss=0.00770 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=3.296 | acc=1.0000 | 4072.9 samples/s | 63.6 steps/s
[Step=36350 Epoch=35.5] | Loss=0.00746 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=3.297 | acc=0.9844 | 4064.6 samples/s | 63.5 steps/s
[Step=36400 Epoch=35.5] | Loss=0.00724 | Reg=0.00205 | L2-Norm=14.305 | L2-Norm(final)=3.298 | acc=1.0000 | 3711.2 samples/s | 58.0 steps/s
[Step=36450 Epoch=35.6] | Loss=0.00718 | Reg=0.00205 | L2-Norm=14.305 | L2-Norm(final)=3.299 | acc=1.0000 | 3759.0 samples/s | 58.7 steps/s
[Step=36500 Epoch=35.6] | Loss=0.00716 | Reg=0.00205 | L2-Norm=14.306 | L2-Norm(final)=3.299 | acc=1.0000 | 4082.1 samples/s | 63.8 steps/s
[Step=36550 Epoch=35.7] | Loss=0.00702 | Reg=0.00205 | L2-Norm=14.306 | L2-Norm(final)=3.300 | acc=1.0000 | 4045.5 samples/s | 63.2 steps/s
[Step=36600 Epoch=35.7] | Loss=0.00690 | Reg=0.00205 | L2-Norm=14.307 | L2-Norm(final)=3.301 | acc=1.0000 | 4038.6 samples/s | 63.1 steps/s
[Step=36650 Epoch=35.8] | Loss=0.00673 | Reg=0.00205 | L2-Norm=14.307 | L2-Norm(final)=3.302 | acc=0.9844 | 3747.0 samples/s | 58.5 steps/s
[Step=36700 Epoch=35.8] | Loss=0.00679 | Reg=0.00205 | L2-Norm=14.307 | L2-Norm(final)=3.302 | acc=0.9844 | 3738.4 samples/s | 58.4 steps/s
[Step=36750 Epoch=35.9] | Loss=0.00664 | Reg=0.00205 | L2-Norm=14.308 | L2-Norm(final)=3.303 | acc=1.0000 | 4045.5 samples/s | 63.2 steps/s
[Step=36800 Epoch=35.9] | Loss=0.00653 | Reg=0.00205 | L2-Norm=14.308 | L2-Norm(final)=3.304 | acc=1.0000 | 4067.1 samples/s | 63.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step36800.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36001 Epoch=67.9] | Loss=0.09597 | Reg=0.00204 | L2-Norm=14.285 | L2-Norm(final)=3.291 | acc=0.9531 | 2986.1 samples/s | 46.7 steps/s
[Step=36050 Epoch=68.0] | Loss=0.00660 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=3.296 | acc=1.0000 | 4192.0 samples/s | 65.5 steps/s
[Step=36100 Epoch=68.0] | Loss=0.00332 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.297 | acc=1.0000 | 4399.1 samples/s | 68.7 steps/s
[Step=36150 Epoch=68.1] | Loss=0.00222 | Reg=0.00204 | L2-Norm=14.298 | L2-Norm(final)=3.297 | acc=1.0000 | 4294.4 samples/s | 67.1 steps/s
[Step=36200 Epoch=68.2] | Loss=0.00167 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.297 | acc=1.0000 | 4458.2 samples/s | 69.7 steps/s
[Step=36250 Epoch=68.3] | Loss=0.00134 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.297 | acc=1.0000 | 4218.9 samples/s | 65.9 steps/s
[Step=36300 Epoch=68.4] | Loss=0.00112 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.297 | acc=1.0000 | 4280.1 samples/s | 66.9 steps/s
[Step=36350 Epoch=68.5] | Loss=0.00096 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.298 | acc=1.0000 | 4377.9 samples/s | 68.4 steps/s
[Step=36400 Epoch=68.6] | Loss=0.00084 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=3.298 | acc=1.0000 | 4307.9 samples/s | 67.3 steps/s
[Step=36450 Epoch=68.7] | Loss=0.00075 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=3.298 | acc=1.0000 | 3975.9 samples/s | 62.1 steps/s
[Step=36500 Epoch=68.8] | Loss=0.00067 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=3.298 | acc=1.0000 | 3817.2 samples/s | 59.6 steps/s
[Step=36550 Epoch=68.9] | Loss=0.00061 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=3.298 | acc=1.0000 | 1417.9 samples/s | 22.2 steps/s
[Step=36600 Epoch=69.0] | Loss=0.00056 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=3.298 | acc=1.0000 | 4638.0 samples/s | 72.5 steps/s
[Step=36650 Epoch=69.1] | Loss=0.00052 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=3.298 | acc=1.0000 | 4505.9 samples/s | 70.4 steps/s
[Step=36700 Epoch=69.2] | Loss=0.00048 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=3.298 | acc=1.0000 | 4485.3 samples/s | 70.1 steps/s
[Step=36750 Epoch=69.3] | Loss=0.00045 | Reg=0.00204 | L2-Norm=14.290 | L2-Norm(final)=3.298 | acc=1.0000 | 4268.2 samples/s | 66.7 steps/s
[Step=36800 Epoch=69.4] | Loss=0.00042 | Reg=0.00204 | L2-Norm=14.289 | L2-Norm(final)=3.298 | acc=1.0000 | 4488.1 samples/s | 70.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27300 | acc=0.8714 | tpr=0.8163 | fpr=0.0089 | 4476.1 samples/s | 17.5 steps/s
Avg test loss: 0.27419, Avg test acc: 0.86954, Avg tpr: 0.81477, Avg fpr: 0.01000, total FA: 78

Testing server on iccad2012
[Step=  50] | Loss=0.51870 | acc=0.8900 | tpr=0.9602 | fpr=0.1113 | 4496.3 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.51813 | acc=0.8914 | tpr=0.9744 | fpr=0.1102 | 9490.6 samples/s | 37.1 steps/s
[Step= 150] | Loss=0.53500 | acc=0.8891 | tpr=0.9813 | fpr=0.1126 | 9148.7 samples/s | 35.7 steps/s
[Step= 200] | Loss=0.53973 | acc=0.8892 | tpr=0.9814 | fpr=0.1125 | 8938.0 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.53965 | acc=0.8884 | tpr=0.9773 | fpr=0.1132 | 9212.4 samples/s | 36.0 steps/s
[Step= 300] | Loss=0.54491 | acc=0.8879 | tpr=0.9775 | fpr=0.1137 | 9126.1 samples/s | 35.6 steps/s
[Step= 350] | Loss=0.54478 | acc=0.8879 | tpr=0.9775 | fpr=0.1137 | 8693.9 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.54817 | acc=0.8877 | tpr=0.9776 | fpr=0.1139 | 5439.4 samples/s | 21.2 steps/s
[Step= 450] | Loss=0.55469 | acc=0.8874 | tpr=0.9766 | fpr=0.1142 | 8718.6 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.55361 | acc=0.8870 | tpr=0.9767 | fpr=0.1146 | 8879.2 samples/s | 34.7 steps/s
[Step= 550] | Loss=0.55217 | acc=0.8871 | tpr=0.9777 | fpr=0.1145 | 17402.9 samples/s | 68.0 steps/s
Avg test loss: 0.55174, Avg test acc: 0.88718, Avg tpr: 0.97781, Avg fpr: 0.11446, total FA: 15893

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=35.9] | Loss=0.27073 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=3.307 | acc=0.8906 | 3721.8 samples/s | 58.2 steps/s
[Step=36850 Epoch=36.0] | Loss=0.02035 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=3.304 | acc=1.0000 | 4470.6 samples/s | 69.9 steps/s
[Step=36900 Epoch=36.0] | Loss=0.01339 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.305 | acc=1.0000 | 4575.7 samples/s | 71.5 steps/s
[Step=36950 Epoch=36.1] | Loss=0.01060 | Reg=0.00204 | L2-Norm=14.298 | L2-Norm(final)=3.305 | acc=1.0000 | 4700.0 samples/s | 73.4 steps/s
[Step=37000 Epoch=36.1] | Loss=0.00947 | Reg=0.00204 | L2-Norm=14.299 | L2-Norm(final)=3.306 | acc=1.0000 | 4688.5 samples/s | 73.3 steps/s
[Step=37050 Epoch=36.2] | Loss=0.00852 | Reg=0.00204 | L2-Norm=14.300 | L2-Norm(final)=3.307 | acc=0.9844 | 4568.1 samples/s | 71.4 steps/s
[Step=37100 Epoch=36.2] | Loss=0.00824 | Reg=0.00204 | L2-Norm=14.300 | L2-Norm(final)=3.308 | acc=1.0000 | 4747.8 samples/s | 74.2 steps/s
[Step=37150 Epoch=36.3] | Loss=0.00781 | Reg=0.00205 | L2-Norm=14.301 | L2-Norm(final)=3.309 | acc=1.0000 | 4542.4 samples/s | 71.0 steps/s
[Step=37200 Epoch=36.3] | Loss=0.00751 | Reg=0.00205 | L2-Norm=14.301 | L2-Norm(final)=3.309 | acc=0.9844 | 4683.8 samples/s | 73.2 steps/s
[Step=37250 Epoch=36.4] | Loss=0.00740 | Reg=0.00205 | L2-Norm=14.302 | L2-Norm(final)=3.310 | acc=0.9844 | 4677.6 samples/s | 73.1 steps/s
[Step=37300 Epoch=36.4] | Loss=0.00712 | Reg=0.00205 | L2-Norm=14.302 | L2-Norm(final)=3.311 | acc=1.0000 | 4696.9 samples/s | 73.4 steps/s
[Step=37350 Epoch=36.5] | Loss=0.00709 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=3.312 | acc=0.9844 | 4642.5 samples/s | 72.5 steps/s
[Step=37400 Epoch=36.5] | Loss=0.00695 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=3.313 | acc=1.0000 | 4523.6 samples/s | 70.7 steps/s
[Step=37450 Epoch=36.6] | Loss=0.00678 | Reg=0.00205 | L2-Norm=14.303 | L2-Norm(final)=3.313 | acc=1.0000 | 4687.5 samples/s | 73.2 steps/s
[Step=37500 Epoch=36.6] | Loss=0.00662 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=3.314 | acc=1.0000 | 4614.9 samples/s | 72.1 steps/s
[Step=37550 Epoch=36.7] | Loss=0.00651 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=3.315 | acc=1.0000 | 4603.7 samples/s | 71.9 steps/s
[Step=37600 Epoch=36.7] | Loss=0.00649 | Reg=0.00205 | L2-Norm=14.304 | L2-Norm(final)=3.316 | acc=0.9844 | 4755.0 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step37600.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=36801 Epoch=69.4] | Loss=0.03556 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=3.307 | acc=0.9844 | 3492.0 samples/s | 54.6 steps/s
[Step=36850 Epoch=69.5] | Loss=0.00441 | Reg=0.00204 | L2-Norm=14.289 | L2-Norm(final)=3.312 | acc=1.0000 | 4192.1 samples/s | 65.5 steps/s
[Step=36900 Epoch=69.6] | Loss=0.00224 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=3.312 | acc=1.0000 | 4372.1 samples/s | 68.3 steps/s
[Step=36950 Epoch=69.7] | Loss=0.00150 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=3.313 | acc=1.0000 | 4383.4 samples/s | 68.5 steps/s
[Step=37000 Epoch=69.7] | Loss=0.00113 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=3.313 | acc=1.0000 | 4512.3 samples/s | 70.5 steps/s
[Step=37050 Epoch=69.8] | Loss=0.00091 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=3.313 | acc=1.0000 | 4437.5 samples/s | 69.3 steps/s
[Step=37100 Epoch=69.9] | Loss=0.00076 | Reg=0.00204 | L2-Norm=14.290 | L2-Norm(final)=3.313 | acc=1.0000 | 4348.4 samples/s | 67.9 steps/s
[Step=37150 Epoch=70.0] | Loss=0.00065 | Reg=0.00204 | L2-Norm=14.290 | L2-Norm(final)=3.314 | acc=1.0000 | 4405.5 samples/s | 68.8 steps/s
[Step=37200 Epoch=70.1] | Loss=0.00057 | Reg=0.00204 | L2-Norm=14.289 | L2-Norm(final)=3.314 | acc=1.0000 | 4502.6 samples/s | 70.4 steps/s
[Step=37250 Epoch=70.2] | Loss=0.00051 | Reg=0.00204 | L2-Norm=14.289 | L2-Norm(final)=3.314 | acc=1.0000 | 4443.9 samples/s | 69.4 steps/s
[Step=37300 Epoch=70.3] | Loss=0.00046 | Reg=0.00204 | L2-Norm=14.288 | L2-Norm(final)=3.314 | acc=1.0000 | 4297.6 samples/s | 67.1 steps/s
[Step=37350 Epoch=70.4] | Loss=0.00042 | Reg=0.00204 | L2-Norm=14.287 | L2-Norm(final)=3.314 | acc=1.0000 | 1530.0 samples/s | 23.9 steps/s
[Step=37400 Epoch=70.5] | Loss=0.00039 | Reg=0.00204 | L2-Norm=14.286 | L2-Norm(final)=3.314 | acc=1.0000 | 4256.5 samples/s | 66.5 steps/s
[Step=37450 Epoch=70.6] | Loss=0.00036 | Reg=0.00204 | L2-Norm=14.286 | L2-Norm(final)=3.314 | acc=1.0000 | 4351.4 samples/s | 68.0 steps/s
[Step=37500 Epoch=70.7] | Loss=0.00033 | Reg=0.00204 | L2-Norm=14.285 | L2-Norm(final)=3.315 | acc=1.0000 | 4433.9 samples/s | 69.3 steps/s
[Step=37550 Epoch=70.8] | Loss=0.00031 | Reg=0.00204 | L2-Norm=14.284 | L2-Norm(final)=3.315 | acc=1.0000 | 4355.5 samples/s | 68.1 steps/s
[Step=37600 Epoch=70.9] | Loss=0.00029 | Reg=0.00204 | L2-Norm=14.283 | L2-Norm(final)=3.315 | acc=1.0000 | 4373.8 samples/s | 68.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23781 | acc=0.8869 | tpr=0.8391 | fpr=0.0094 | 4429.9 samples/s | 17.3 steps/s
Avg test loss: 0.23856, Avg test acc: 0.88473, Avg tpr: 0.83727, Avg fpr: 0.01090, total FA: 85

Testing server on iccad2012
[Step=  50] | Loss=0.55637 | acc=0.8791 | tpr=0.9646 | fpr=0.1224 | 4470.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.55586 | acc=0.8798 | tpr=0.9701 | fpr=0.1219 | 8804.7 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.57285 | acc=0.8769 | tpr=0.9784 | fpr=0.1250 | 9079.8 samples/s | 35.5 steps/s
[Step= 200] | Loss=0.57707 | acc=0.8772 | tpr=0.9792 | fpr=0.1246 | 8899.7 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.57702 | acc=0.8768 | tpr=0.9755 | fpr=0.1250 | 9176.5 samples/s | 35.8 steps/s
[Step= 300] | Loss=0.58204 | acc=0.8766 | tpr=0.9767 | fpr=0.1253 | 5556.7 samples/s | 21.7 steps/s
[Step= 350] | Loss=0.58161 | acc=0.8766 | tpr=0.9768 | fpr=0.1252 | 8582.8 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.58480 | acc=0.8764 | tpr=0.9776 | fpr=0.1254 | 8558.8 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.59111 | acc=0.8762 | tpr=0.9771 | fpr=0.1257 | 9229.2 samples/s | 36.1 steps/s
[Step= 500] | Loss=0.59012 | acc=0.8758 | tpr=0.9771 | fpr=0.1260 | 8575.9 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.58855 | acc=0.8759 | tpr=0.9773 | fpr=0.1259 | 17345.9 samples/s | 67.8 steps/s
Avg test loss: 0.58806, Avg test acc: 0.87598, Avg tpr: 0.97742, Avg fpr: 0.12586, total FA: 17476

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=36.7] | Loss=0.05916 | Reg=0.00204 | L2-Norm=14.275 | L2-Norm(final)=3.321 | acc=0.9688 | 3412.9 samples/s | 53.3 steps/s
[Step=37650 Epoch=36.8] | Loss=0.01637 | Reg=0.00204 | L2-Norm=14.287 | L2-Norm(final)=3.320 | acc=1.0000 | 4685.3 samples/s | 73.2 steps/s
[Step=37700 Epoch=36.8] | Loss=0.01076 | Reg=0.00204 | L2-Norm=14.290 | L2-Norm(final)=3.320 | acc=1.0000 | 4584.7 samples/s | 71.6 steps/s
[Step=37750 Epoch=36.9] | Loss=0.00913 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=3.322 | acc=1.0000 | 4651.0 samples/s | 72.7 steps/s
[Step=37800 Epoch=36.9] | Loss=0.00818 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=3.323 | acc=0.9844 | 4579.2 samples/s | 71.6 steps/s
[Step=37850 Epoch=37.0] | Loss=0.00757 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=3.324 | acc=1.0000 | 4522.6 samples/s | 70.7 steps/s
[Step=37900 Epoch=37.0] | Loss=0.00729 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=3.324 | acc=1.0000 | 4750.9 samples/s | 74.2 steps/s
[Step=37950 Epoch=37.1] | Loss=0.00688 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=3.325 | acc=1.0000 | 4605.0 samples/s | 72.0 steps/s
[Step=38000 Epoch=37.1] | Loss=0.00677 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=3.326 | acc=0.9844 | 4629.4 samples/s | 72.3 steps/s
[Step=38050 Epoch=37.1] | Loss=0.00664 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=3.327 | acc=1.0000 | 4411.5 samples/s | 68.9 steps/s
[Step=38100 Epoch=37.2] | Loss=0.00654 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=3.328 | acc=1.0000 | 4586.7 samples/s | 71.7 steps/s
[Step=38150 Epoch=37.2] | Loss=0.00625 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.328 | acc=1.0000 | 4642.1 samples/s | 72.5 steps/s
[Step=38200 Epoch=37.3] | Loss=0.00614 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.329 | acc=0.9688 | 4746.6 samples/s | 74.2 steps/s
[Step=38250 Epoch=37.3] | Loss=0.00607 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.330 | acc=1.0000 | 4630.7 samples/s | 72.4 steps/s
[Step=38300 Epoch=37.4] | Loss=0.00611 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.330 | acc=1.0000 | 4566.4 samples/s | 71.4 steps/s
[Step=38350 Epoch=37.4] | Loss=0.00622 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.331 | acc=1.0000 | 4161.6 samples/s | 65.0 steps/s
[Step=38400 Epoch=37.5] | Loss=0.00622 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.332 | acc=1.0000 | 3843.7 samples/s | 60.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step38400.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=37601 Epoch=70.9] | Loss=0.00826 | Reg=0.00204 | L2-Norm=14.275 | L2-Norm(final)=3.321 | acc=0.9844 | 2931.2 samples/s | 45.8 steps/s
[Step=37650 Epoch=71.0] | Loss=0.00547 | Reg=0.00204 | L2-Norm=14.289 | L2-Norm(final)=3.328 | acc=1.0000 | 4335.5 samples/s | 67.7 steps/s
[Step=37700 Epoch=71.1] | Loss=0.00276 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=3.329 | acc=1.0000 | 4507.8 samples/s | 70.4 steps/s
[Step=37750 Epoch=71.2] | Loss=0.00184 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=3.329 | acc=1.0000 | 4454.3 samples/s | 69.6 steps/s
[Step=37800 Epoch=71.3] | Loss=0.00139 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=3.329 | acc=1.0000 | 4468.3 samples/s | 69.8 steps/s
[Step=37850 Epoch=71.3] | Loss=0.00111 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=3.329 | acc=1.0000 | 4401.5 samples/s | 68.8 steps/s
[Step=37900 Epoch=71.4] | Loss=0.00093 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=3.330 | acc=1.0000 | 4495.1 samples/s | 70.2 steps/s
[Step=37950 Epoch=71.5] | Loss=0.00080 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=3.330 | acc=1.0000 | 4459.5 samples/s | 69.7 steps/s
[Step=38000 Epoch=71.6] | Loss=0.00070 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=3.330 | acc=1.0000 | 4544.6 samples/s | 71.0 steps/s
[Step=38050 Epoch=71.7] | Loss=0.00062 | Reg=0.00204 | L2-Norm=14.290 | L2-Norm(final)=3.330 | acc=1.0000 | 4302.2 samples/s | 67.2 steps/s
[Step=38100 Epoch=71.8] | Loss=0.00056 | Reg=0.00204 | L2-Norm=14.289 | L2-Norm(final)=3.330 | acc=1.0000 | 4417.1 samples/s | 69.0 steps/s
[Step=38150 Epoch=71.9] | Loss=0.00051 | Reg=0.00204 | L2-Norm=14.289 | L2-Norm(final)=3.330 | acc=1.0000 | 1508.3 samples/s | 23.6 steps/s
[Step=38200 Epoch=72.0] | Loss=0.00047 | Reg=0.00204 | L2-Norm=14.288 | L2-Norm(final)=3.330 | acc=1.0000 | 4503.2 samples/s | 70.4 steps/s
[Step=38250 Epoch=72.1] | Loss=0.00043 | Reg=0.00204 | L2-Norm=14.287 | L2-Norm(final)=3.330 | acc=1.0000 | 4375.6 samples/s | 68.4 steps/s
[Step=38300 Epoch=72.2] | Loss=0.00040 | Reg=0.00204 | L2-Norm=14.286 | L2-Norm(final)=3.331 | acc=1.0000 | 4530.3 samples/s | 70.8 steps/s
[Step=38350 Epoch=72.3] | Loss=0.00038 | Reg=0.00204 | L2-Norm=14.285 | L2-Norm(final)=3.331 | acc=1.0000 | 4324.3 samples/s | 67.6 steps/s
[Step=38400 Epoch=72.4] | Loss=0.00035 | Reg=0.00204 | L2-Norm=14.284 | L2-Norm(final)=3.331 | acc=1.0000 | 4313.4 samples/s | 67.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27815 | acc=0.8693 | tpr=0.8141 | fpr=0.0109 | 4399.4 samples/s | 17.2 steps/s
Avg test loss: 0.27923, Avg test acc: 0.86706, Avg tpr: 0.81203, Avg fpr: 0.01192, total FA: 93

Testing server on iccad2012
[Step=  50] | Loss=0.48030 | acc=0.9001 | tpr=0.9558 | fpr=0.1009 | 4427.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.48118 | acc=0.9029 | tpr=0.9680 | fpr=0.0983 | 9221.0 samples/s | 36.0 steps/s
[Step= 150] | Loss=0.49664 | acc=0.9010 | tpr=0.9784 | fpr=0.1004 | 9043.0 samples/s | 35.3 steps/s
[Step= 200] | Loss=0.50066 | acc=0.9010 | tpr=0.9781 | fpr=0.1004 | 9003.9 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.49957 | acc=0.9006 | tpr=0.9747 | fpr=0.1007 | 5979.0 samples/s | 23.4 steps/s
[Step= 300] | Loss=0.50436 | acc=0.9004 | tpr=0.9760 | fpr=0.1010 | 8734.1 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.50417 | acc=0.9004 | tpr=0.9756 | fpr=0.1010 | 9083.5 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.50757 | acc=0.9003 | tpr=0.9754 | fpr=0.1011 | 7913.2 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.51365 | acc=0.8998 | tpr=0.9742 | fpr=0.1016 | 8726.0 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.51202 | acc=0.8995 | tpr=0.9744 | fpr=0.1019 | 8799.8 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.51060 | acc=0.8995 | tpr=0.9745 | fpr=0.1019 | 16120.5 samples/s | 63.0 steps/s
Avg test loss: 0.51004, Avg test acc: 0.89953, Avg tpr: 0.97464, Avg fpr: 0.10183, total FA: 14139

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=37.5] | Loss=0.15882 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=3.336 | acc=0.9062 | 3483.2 samples/s | 54.4 steps/s
[Step=38450 Epoch=37.5] | Loss=0.02447 | Reg=0.00204 | L2-Norm=14.286 | L2-Norm(final)=3.332 | acc=0.9844 | 4503.0 samples/s | 70.4 steps/s
[Step=38500 Epoch=37.6] | Loss=0.01459 | Reg=0.00204 | L2-Norm=14.290 | L2-Norm(final)=3.332 | acc=1.0000 | 4594.2 samples/s | 71.8 steps/s
[Step=38550 Epoch=37.6] | Loss=0.01164 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=3.332 | acc=0.9844 | 4606.0 samples/s | 72.0 steps/s
[Step=38600 Epoch=37.7] | Loss=0.00972 | Reg=0.00204 | L2-Norm=14.292 | L2-Norm(final)=3.333 | acc=0.9844 | 4684.3 samples/s | 73.2 steps/s
[Step=38650 Epoch=37.7] | Loss=0.00911 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=3.334 | acc=1.0000 | 4574.5 samples/s | 71.5 steps/s
[Step=38700 Epoch=37.8] | Loss=0.00830 | Reg=0.00204 | L2-Norm=14.293 | L2-Norm(final)=3.334 | acc=1.0000 | 4729.2 samples/s | 73.9 steps/s
[Step=38750 Epoch=37.8] | Loss=0.00796 | Reg=0.00204 | L2-Norm=14.294 | L2-Norm(final)=3.335 | acc=1.0000 | 4823.3 samples/s | 75.4 steps/s
[Step=38800 Epoch=37.9] | Loss=0.00768 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=3.336 | acc=1.0000 | 4474.7 samples/s | 69.9 steps/s
[Step=38850 Epoch=37.9] | Loss=0.00729 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=3.336 | acc=1.0000 | 4656.9 samples/s | 72.8 steps/s
[Step=38900 Epoch=38.0] | Loss=0.00722 | Reg=0.00204 | L2-Norm=14.295 | L2-Norm(final)=3.337 | acc=0.9844 | 4728.4 samples/s | 73.9 steps/s
[Step=38950 Epoch=38.0] | Loss=0.00724 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.337 | acc=0.9844 | 4613.0 samples/s | 72.1 steps/s
[Step=39000 Epoch=38.1] | Loss=0.00705 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.338 | acc=1.0000 | 4552.2 samples/s | 71.1 steps/s
[Step=39050 Epoch=38.1] | Loss=0.00695 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.338 | acc=1.0000 | 4610.9 samples/s | 72.0 steps/s
[Step=39100 Epoch=38.2] | Loss=0.00687 | Reg=0.00204 | L2-Norm=14.296 | L2-Norm(final)=3.339 | acc=1.0000 | 4746.1 samples/s | 74.2 steps/s
[Step=39150 Epoch=38.2] | Loss=0.00682 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.340 | acc=1.0000 | 4649.1 samples/s | 72.6 steps/s
[Step=39200 Epoch=38.3] | Loss=0.00683 | Reg=0.00204 | L2-Norm=14.297 | L2-Norm(final)=3.340 | acc=1.0000 | 4527.1 samples/s | 70.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step39200.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=38401 Epoch=72.4] | Loss=0.00354 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=3.336 | acc=1.0000 | 3370.3 samples/s | 52.7 steps/s
[Step=38450 Epoch=72.5] | Loss=0.00324 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=3.339 | acc=1.0000 | 4150.5 samples/s | 64.9 steps/s
[Step=38500 Epoch=72.6] | Loss=0.00164 | Reg=0.00204 | L2-Norm=14.279 | L2-Norm(final)=3.340 | acc=1.0000 | 4270.5 samples/s | 66.7 steps/s
[Step=38550 Epoch=72.7] | Loss=0.00110 | Reg=0.00204 | L2-Norm=14.279 | L2-Norm(final)=3.341 | acc=1.0000 | 4322.1 samples/s | 67.5 steps/s
[Step=38600 Epoch=72.8] | Loss=0.00084 | Reg=0.00204 | L2-Norm=14.279 | L2-Norm(final)=3.341 | acc=1.0000 | 4383.8 samples/s | 68.5 steps/s
[Step=38650 Epoch=72.9] | Loss=0.00068 | Reg=0.00204 | L2-Norm=14.278 | L2-Norm(final)=3.342 | acc=1.0000 | 4350.1 samples/s | 68.0 steps/s
[Step=38700 Epoch=73.0] | Loss=0.00057 | Reg=0.00204 | L2-Norm=14.278 | L2-Norm(final)=3.342 | acc=1.0000 | 4267.5 samples/s | 66.7 steps/s
[Step=38750 Epoch=73.0] | Loss=0.00049 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=3.342 | acc=1.0000 | 4389.1 samples/s | 68.6 steps/s
[Step=38800 Epoch=73.1] | Loss=0.00043 | Reg=0.00204 | L2-Norm=14.276 | L2-Norm(final)=3.342 | acc=1.0000 | 4420.5 samples/s | 69.1 steps/s
[Step=38850 Epoch=73.2] | Loss=0.00038 | Reg=0.00204 | L2-Norm=14.276 | L2-Norm(final)=3.342 | acc=1.0000 | 4376.6 samples/s | 68.4 steps/s
[Step=38900 Epoch=73.3] | Loss=0.00035 | Reg=0.00204 | L2-Norm=14.275 | L2-Norm(final)=3.343 | acc=1.0000 | 4422.1 samples/s | 69.1 steps/s
[Step=38950 Epoch=73.4] | Loss=0.00032 | Reg=0.00204 | L2-Norm=14.274 | L2-Norm(final)=3.343 | acc=1.0000 | 1481.2 samples/s | 23.1 steps/s
[Step=39000 Epoch=73.5] | Loss=0.00029 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=3.343 | acc=1.0000 | 4446.3 samples/s | 69.5 steps/s
[Step=39050 Epoch=73.6] | Loss=0.00027 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=3.343 | acc=1.0000 | 4327.1 samples/s | 67.6 steps/s
[Step=39100 Epoch=73.7] | Loss=0.00025 | Reg=0.00204 | L2-Norm=14.272 | L2-Norm(final)=3.343 | acc=1.0000 | 4366.1 samples/s | 68.2 steps/s
[Step=39150 Epoch=73.8] | Loss=0.00023 | Reg=0.00204 | L2-Norm=14.271 | L2-Norm(final)=3.343 | acc=1.0000 | 4286.1 samples/s | 67.0 steps/s
[Step=39200 Epoch=73.9] | Loss=0.00022 | Reg=0.00204 | L2-Norm=14.270 | L2-Norm(final)=3.344 | acc=1.0000 | 4540.8 samples/s | 70.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.21374 | acc=0.9003 | tpr=0.8598 | fpr=0.0116 | 4351.2 samples/s | 17.0 steps/s
Avg test loss: 0.21417, Avg test acc: 0.89723, Avg tpr: 0.85644, Avg fpr: 0.01308, total FA: 102

Testing server on iccad2012
[Step=  50] | Loss=0.57775 | acc=0.8759 | tpr=0.9558 | fpr=0.1255 | 4376.0 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.57770 | acc=0.8768 | tpr=0.9680 | fpr=0.1249 | 9144.0 samples/s | 35.7 steps/s
[Step= 150] | Loss=0.59535 | acc=0.8735 | tpr=0.9784 | fpr=0.1284 | 5208.5 samples/s | 20.3 steps/s
[Step= 200] | Loss=0.59979 | acc=0.8738 | tpr=0.9792 | fpr=0.1281 | 9315.5 samples/s | 36.4 steps/s
[Step= 250] | Loss=0.59943 | acc=0.8735 | tpr=0.9755 | fpr=0.1284 | 8753.0 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.60448 | acc=0.8734 | tpr=0.9767 | fpr=0.1285 | 8660.8 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.60401 | acc=0.8736 | tpr=0.9775 | fpr=0.1283 | 8874.2 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.60720 | acc=0.8733 | tpr=0.9781 | fpr=0.1286 | 8680.5 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.61368 | acc=0.8728 | tpr=0.9771 | fpr=0.1291 | 8586.2 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.61254 | acc=0.8726 | tpr=0.9775 | fpr=0.1293 | 8901.0 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.61116 | acc=0.8727 | tpr=0.9781 | fpr=0.1292 | 16410.5 samples/s | 64.1 steps/s
Avg test loss: 0.61066, Avg test acc: 0.87280, Avg tpr: 0.97821, Avg fpr: 0.12911, total FA: 17927

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=38.3] | Loss=0.01898 | Reg=0.00203 | L2-Norm=14.265 | L2-Norm(final)=3.347 | acc=0.9844 | 3705.5 samples/s | 57.9 steps/s
[Step=39250 Epoch=38.3] | Loss=0.01459 | Reg=0.00204 | L2-Norm=14.274 | L2-Norm(final)=3.346 | acc=1.0000 | 4031.3 samples/s | 63.0 steps/s
[Step=39300 Epoch=38.4] | Loss=0.01000 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=3.346 | acc=1.0000 | 4532.8 samples/s | 70.8 steps/s
[Step=39350 Epoch=38.4] | Loss=0.00846 | Reg=0.00204 | L2-Norm=14.278 | L2-Norm(final)=3.347 | acc=1.0000 | 4546.1 samples/s | 71.0 steps/s
[Step=39400 Epoch=38.5] | Loss=0.00794 | Reg=0.00204 | L2-Norm=14.279 | L2-Norm(final)=3.348 | acc=1.0000 | 4559.2 samples/s | 71.2 steps/s
[Step=39450 Epoch=38.5] | Loss=0.00714 | Reg=0.00204 | L2-Norm=14.280 | L2-Norm(final)=3.348 | acc=1.0000 | 4511.7 samples/s | 70.5 steps/s
[Step=39500 Epoch=38.6] | Loss=0.00693 | Reg=0.00204 | L2-Norm=14.280 | L2-Norm(final)=3.349 | acc=1.0000 | 4527.3 samples/s | 70.7 steps/s
[Step=39550 Epoch=38.6] | Loss=0.00657 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=3.350 | acc=1.0000 | 4716.3 samples/s | 73.7 steps/s
[Step=39600 Epoch=38.7] | Loss=0.00658 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=3.351 | acc=1.0000 | 4644.1 samples/s | 72.6 steps/s
[Step=39650 Epoch=38.7] | Loss=0.00635 | Reg=0.00204 | L2-Norm=14.282 | L2-Norm(final)=3.351 | acc=1.0000 | 4570.3 samples/s | 71.4 steps/s
[Step=39700 Epoch=38.8] | Loss=0.00627 | Reg=0.00204 | L2-Norm=14.282 | L2-Norm(final)=3.352 | acc=1.0000 | 4708.6 samples/s | 73.6 steps/s
[Step=39750 Epoch=38.8] | Loss=0.00613 | Reg=0.00204 | L2-Norm=14.282 | L2-Norm(final)=3.353 | acc=1.0000 | 4580.4 samples/s | 71.6 steps/s
[Step=39800 Epoch=38.9] | Loss=0.00611 | Reg=0.00204 | L2-Norm=14.283 | L2-Norm(final)=3.353 | acc=1.0000 | 4535.2 samples/s | 70.9 steps/s
[Step=39850 Epoch=38.9] | Loss=0.00604 | Reg=0.00204 | L2-Norm=14.283 | L2-Norm(final)=3.354 | acc=1.0000 | 4557.8 samples/s | 71.2 steps/s
[Step=39900 Epoch=39.0] | Loss=0.00601 | Reg=0.00204 | L2-Norm=14.283 | L2-Norm(final)=3.355 | acc=1.0000 | 4643.6 samples/s | 72.6 steps/s
[Step=39950 Epoch=39.0] | Loss=0.00611 | Reg=0.00204 | L2-Norm=14.284 | L2-Norm(final)=3.355 | acc=1.0000 | 4661.7 samples/s | 72.8 steps/s
[Step=40000 Epoch=39.1] | Loss=0.00606 | Reg=0.00204 | L2-Norm=14.284 | L2-Norm(final)=3.356 | acc=1.0000 | 3919.6 samples/s | 61.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step40000.h5

Train client 1: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=39201 Epoch=73.9] | Loss=0.00139 | Reg=0.00203 | L2-Norm=14.265 | L2-Norm(final)=3.347 | acc=1.0000 | 2931.0 samples/s | 45.8 steps/s
[Step=39250 Epoch=74.0] | Loss=0.00376 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=3.351 | acc=1.0000 | 4044.8 samples/s | 63.2 steps/s
[Step=39300 Epoch=74.1] | Loss=0.00190 | Reg=0.00204 | L2-Norm=14.280 | L2-Norm(final)=3.352 | acc=1.0000 | 4422.4 samples/s | 69.1 steps/s
[Step=39350 Epoch=74.2] | Loss=0.00127 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=3.353 | acc=1.0000 | 4316.0 samples/s | 67.4 steps/s
[Step=39400 Epoch=74.3] | Loss=0.00096 | Reg=0.00204 | L2-Norm=14.281 | L2-Norm(final)=3.353 | acc=1.0000 | 4316.5 samples/s | 67.4 steps/s
[Step=39450 Epoch=74.4] | Loss=0.00077 | Reg=0.00204 | L2-Norm=14.280 | L2-Norm(final)=3.353 | acc=1.0000 | 4462.9 samples/s | 69.7 steps/s
[Step=39500 Epoch=74.5] | Loss=0.00064 | Reg=0.00204 | L2-Norm=14.280 | L2-Norm(final)=3.353 | acc=1.0000 | 4548.1 samples/s | 71.1 steps/s
[Step=39550 Epoch=74.6] | Loss=0.00055 | Reg=0.00204 | L2-Norm=14.279 | L2-Norm(final)=3.353 | acc=1.0000 | 4308.1 samples/s | 67.3 steps/s
[Step=39600 Epoch=74.6] | Loss=0.00048 | Reg=0.00204 | L2-Norm=14.279 | L2-Norm(final)=3.353 | acc=1.0000 | 4426.1 samples/s | 69.2 steps/s
[Step=39650 Epoch=74.7] | Loss=0.00043 | Reg=0.00204 | L2-Norm=14.278 | L2-Norm(final)=3.353 | acc=1.0000 | 4287.3 samples/s | 67.0 steps/s
[Step=39700 Epoch=74.8] | Loss=0.00039 | Reg=0.00204 | L2-Norm=14.277 | L2-Norm(final)=3.353 | acc=1.0000 | 4310.6 samples/s | 67.4 steps/s
[Step=39750 Epoch=74.9] | Loss=0.00035 | Reg=0.00204 | L2-Norm=14.276 | L2-Norm(final)=3.354 | acc=1.0000 | 1474.2 samples/s | 23.0 steps/s
[Step=39800 Epoch=75.0] | Loss=0.00032 | Reg=0.00204 | L2-Norm=14.276 | L2-Norm(final)=3.354 | acc=1.0000 | 4484.4 samples/s | 70.1 steps/s
[Step=39850 Epoch=75.1] | Loss=0.00030 | Reg=0.00204 | L2-Norm=14.275 | L2-Norm(final)=3.354 | acc=1.0000 | 4137.7 samples/s | 64.7 steps/s
[Step=39900 Epoch=75.2] | Loss=0.00028 | Reg=0.00204 | L2-Norm=14.274 | L2-Norm(final)=3.354 | acc=1.0000 | 4203.4 samples/s | 65.7 steps/s
[Step=39950 Epoch=75.3] | Loss=0.00026 | Reg=0.00204 | L2-Norm=14.273 | L2-Norm(final)=3.354 | acc=1.0000 | 4139.2 samples/s | 64.7 steps/s
[Step=40000 Epoch=75.4] | Loss=0.00024 | Reg=0.00204 | L2-Norm=14.272 | L2-Norm(final)=3.354 | acc=1.0000 | 4290.1 samples/s | 67.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28502 | acc=0.8702 | tpr=0.8147 | fpr=0.0092 | 4514.3 samples/s | 17.6 steps/s
Avg test loss: 0.28627, Avg test acc: 0.86894, Avg tpr: 0.81384, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.51948 | acc=0.8956 | tpr=0.9558 | fpr=0.1055 | 3548.9 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.52088 | acc=0.8963 | tpr=0.9680 | fpr=0.1050 | 6617.2 samples/s | 25.8 steps/s
[Step= 150] | Loss=0.53724 | acc=0.8936 | tpr=0.9769 | fpr=0.1079 | 8666.9 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.54234 | acc=0.8934 | tpr=0.9770 | fpr=0.1082 | 8497.4 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.54252 | acc=0.8929 | tpr=0.9738 | fpr=0.1086 | 8312.7 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.54785 | acc=0.8924 | tpr=0.9738 | fpr=0.1090 | 7322.7 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.54763 | acc=0.8926 | tpr=0.9743 | fpr=0.1089 | 7122.1 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.55081 | acc=0.8924 | tpr=0.9743 | fpr=0.1091 | 6858.4 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.55749 | acc=0.8920 | tpr=0.9732 | fpr=0.1094 | 7993.9 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.55590 | acc=0.8916 | tpr=0.9736 | fpr=0.1099 | 7480.6 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.55444 | acc=0.8917 | tpr=0.9737 | fpr=0.1098 | 14460.2 samples/s | 56.5 steps/s
Avg test loss: 0.55395, Avg test acc: 0.89175, Avg tpr: 0.97385, Avg fpr: 0.10974, total FA: 15237
