#clients of iccad2012: 2
#clients of asml1: 2
select ratio: 0.5
Total num clients: 4
client model path: ['/research/byu2/rchen/proj/wwy/jp/model/client_asml1_0', '/research/byu2/rchen/proj/wwy/jp/model/client_asml1_1', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0', '/research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1']
client benchmark path: {'asml1': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml1_train', 'asml2': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml2_train', 'asml3': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml3_train', 'asml4': '/research/byu2/rchen/proj/wwy/jp/benchmarks/asml4_train', 'iccad2012': '/research/byu2/rchen/proj/wwy/jp/benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32814, 144, 32)
Using transform option: train
#pos = 17102, #neg = 15712
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32737, 144, 32)
Using transform option: train
#pos = 17179, #neg = 15558
loading data into the main memory...
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16703, 144, 32)
Using transform option: train
#pos = 8134, #neg = 8569
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16626, 144, 32)
Using transform option: train
#pos = 8099, #neg = 8527
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35608 | Reg=0.00358 | L2-Norm=18.910 | L2-Norm(final)=1.944 | acc=0.6094 | 2230.1 samples/s | 34.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.15793 | Reg=0.00345 | L2-Norm=18.567 | L2-Norm(final)=1.965 | acc=0.9219 | 4195.8 samples/s | 65.6 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.09659 | Reg=0.00338 | L2-Norm=18.388 | L2-Norm(final)=1.979 | acc=0.9531 | 4412.5 samples/s | 68.9 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.07235 | Reg=0.00333 | L2-Norm=18.259 | L2-Norm(final)=1.988 | acc=0.9531 | 4626.0 samples/s | 72.3 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.05761 | Reg=0.00330 | L2-Norm=18.154 | L2-Norm(final)=1.996 | acc=0.9688 | 4494.3 samples/s | 70.2 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.04794 | Reg=0.00326 | L2-Norm=18.065 | L2-Norm(final)=2.002 | acc=1.0000 | 5741.4 samples/s | 89.7 steps/s
[Step= 300 Epoch= 1.1] | Loss=0.04064 | Reg=0.00324 | L2-Norm=17.987 | L2-Norm(final)=2.008 | acc=1.0000 | 2106.2 samples/s | 32.9 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.03532 | Reg=0.00321 | L2-Norm=17.914 | L2-Norm(final)=2.013 | acc=1.0000 | 4805.3 samples/s | 75.1 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.03115 | Reg=0.00319 | L2-Norm=17.847 | L2-Norm(final)=2.018 | acc=1.0000 | 4671.7 samples/s | 73.0 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.02777 | Reg=0.00316 | L2-Norm=17.783 | L2-Norm(final)=2.023 | acc=1.0000 | 4720.4 samples/s | 73.8 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.02505 | Reg=0.00314 | L2-Norm=17.721 | L2-Norm(final)=2.027 | acc=1.0000 | 5261.3 samples/s | 82.2 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.02281 | Reg=0.00312 | L2-Norm=17.662 | L2-Norm(final)=2.032 | acc=1.0000 | 2188.8 samples/s | 34.2 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.02092 | Reg=0.00310 | L2-Norm=17.603 | L2-Norm(final)=2.035 | acc=1.0000 | 4427.4 samples/s | 69.2 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.01932 | Reg=0.00308 | L2-Norm=17.545 | L2-Norm(final)=2.039 | acc=1.0000 | 4585.0 samples/s | 71.6 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.01795 | Reg=0.00306 | L2-Norm=17.489 | L2-Norm(final)=2.042 | acc=1.0000 | 4607.4 samples/s | 72.0 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.01675 | Reg=0.00304 | L2-Norm=17.433 | L2-Norm(final)=2.044 | acc=1.0000 | 4557.5 samples/s | 71.2 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.01572 | Reg=0.00302 | L2-Norm=17.378 | L2-Norm(final)=2.047 | acc=1.0000 | 2204.1 samples/s | 34.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37946 | Reg=0.00358 | L2-Norm=18.910 | L2-Norm(final)=1.943 | acc=0.4375 | 5037.6 samples/s | 78.7 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.18149 | Reg=0.00346 | L2-Norm=18.602 | L2-Norm(final)=1.957 | acc=0.9844 | 4078.6 samples/s | 63.7 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.11312 | Reg=0.00341 | L2-Norm=18.469 | L2-Norm(final)=1.976 | acc=0.9688 | 4692.0 samples/s | 73.3 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.08137 | Reg=0.00337 | L2-Norm=18.368 | L2-Norm(final)=1.991 | acc=1.0000 | 4655.3 samples/s | 72.7 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.06368 | Reg=0.00334 | L2-Norm=18.281 | L2-Norm(final)=2.004 | acc=1.0000 | 4605.5 samples/s | 72.0 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.05307 | Reg=0.00331 | L2-Norm=18.204 | L2-Norm(final)=2.013 | acc=0.9531 | 6041.1 samples/s | 94.4 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.04652 | Reg=0.00329 | L2-Norm=18.136 | L2-Norm(final)=2.020 | acc=1.0000 | 2020.4 samples/s | 31.6 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.04080 | Reg=0.00327 | L2-Norm=18.075 | L2-Norm(final)=2.026 | acc=1.0000 | 4716.0 samples/s | 73.7 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.03690 | Reg=0.00325 | L2-Norm=18.021 | L2-Norm(final)=2.031 | acc=0.9844 | 4613.3 samples/s | 72.1 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.03306 | Reg=0.00323 | L2-Norm=17.971 | L2-Norm(final)=2.037 | acc=1.0000 | 4732.7 samples/s | 73.9 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.02993 | Reg=0.00321 | L2-Norm=17.923 | L2-Norm(final)=2.042 | acc=1.0000 | 5233.2 samples/s | 81.8 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.02725 | Reg=0.00320 | L2-Norm=17.875 | L2-Norm(final)=2.046 | acc=1.0000 | 2007.9 samples/s | 31.4 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.02499 | Reg=0.00318 | L2-Norm=17.827 | L2-Norm(final)=2.051 | acc=1.0000 | 4378.0 samples/s | 68.4 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.02308 | Reg=0.00316 | L2-Norm=17.779 | L2-Norm(final)=2.055 | acc=1.0000 | 4435.3 samples/s | 69.3 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.02144 | Reg=0.00315 | L2-Norm=17.730 | L2-Norm(final)=2.059 | acc=1.0000 | 4628.0 samples/s | 72.3 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.02001 | Reg=0.00313 | L2-Norm=17.682 | L2-Norm(final)=2.062 | acc=1.0000 | 4670.7 samples/s | 73.0 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.01877 | Reg=0.00311 | L2-Norm=17.633 | L2-Norm(final)=2.065 | acc=1.0000 | 2243.2 samples/s | 35.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.58140 | acc=0.3389 | tpr=0.2947 | fpr=0.5652 | 4482.8 samples/s | 17.5 steps/s
Avg test loss: 0.57818, Avg test acc: 0.33857, Avg tpr: 0.29341, Avg fpr: 0.56211, total FA: 4385

Testing server on iccad2012
[Step=  50] | Loss=0.17186 | acc=0.8716 | tpr=0.9956 | fpr=0.1306 | 4585.4 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.17305 | acc=0.8711 | tpr=0.9957 | fpr=0.1312 | 8617.4 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.17408 | acc=0.8705 | tpr=0.9942 | fpr=0.1317 | 8848.1 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.17484 | acc=0.8699 | tpr=0.9945 | fpr=0.1323 | 8425.2 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.17477 | acc=0.8700 | tpr=0.9939 | fpr=0.1323 | 9001.5 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.17492 | acc=0.8703 | tpr=0.9949 | fpr=0.1319 | 8014.3 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.17554 | acc=0.8695 | tpr=0.9944 | fpr=0.1328 | 8624.5 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.17573 | acc=0.8695 | tpr=0.9929 | fpr=0.1327 | 8617.9 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.17618 | acc=0.8693 | tpr=0.9912 | fpr=0.1329 | 9023.2 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.17621 | acc=0.8693 | tpr=0.9907 | fpr=0.1329 | 8351.9 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.17572 | acc=0.8696 | tpr=0.9908 | fpr=0.1327 | 15054.3 samples/s | 58.8 steps/s
Avg test loss: 0.17561, Avg test acc: 0.86967, Avg tpr: 0.99089, Avg fpr: 0.13253, total FA: 18402

server round 1/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.54002 | Reg=0.00295 | L2-Norm=17.183 | L2-Norm(final)=2.005 | acc=0.3594 | 4297.4 samples/s | 67.1 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.31268 | Reg=0.00291 | L2-Norm=17.066 | L2-Norm(final)=1.979 | acc=0.7188 | 4756.3 samples/s | 74.3 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.27046 | Reg=0.00291 | L2-Norm=17.055 | L2-Norm(final)=1.988 | acc=0.7656 | 4907.9 samples/s | 76.7 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.24253 | Reg=0.00291 | L2-Norm=17.055 | L2-Norm(final)=1.998 | acc=0.8594 | 4903.4 samples/s | 76.6 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.22064 | Reg=0.00291 | L2-Norm=17.059 | L2-Norm(final)=2.008 | acc=0.9062 | 4878.6 samples/s | 76.2 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.20437 | Reg=0.00291 | L2-Norm=17.068 | L2-Norm(final)=2.018 | acc=0.8594 | 4907.6 samples/s | 76.7 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.19369 | Reg=0.00292 | L2-Norm=17.082 | L2-Norm(final)=2.025 | acc=0.8750 | 4939.5 samples/s | 77.2 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.18297 | Reg=0.00292 | L2-Norm=17.095 | L2-Norm(final)=2.033 | acc=0.9062 | 4931.3 samples/s | 77.1 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.17395 | Reg=0.00293 | L2-Norm=17.107 | L2-Norm(final)=2.040 | acc=0.9219 | 4925.4 samples/s | 77.0 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.16615 | Reg=0.00293 | L2-Norm=17.117 | L2-Norm(final)=2.047 | acc=0.8906 | 4879.7 samples/s | 76.2 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.15877 | Reg=0.00293 | L2-Norm=17.127 | L2-Norm(final)=2.053 | acc=0.9219 | 6009.7 samples/s | 93.9 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.15190 | Reg=0.00294 | L2-Norm=17.138 | L2-Norm(final)=2.060 | acc=0.9375 | 2051.9 samples/s | 32.1 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.14551 | Reg=0.00294 | L2-Norm=17.151 | L2-Norm(final)=2.068 | acc=0.9531 | 4922.9 samples/s | 76.9 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.14007 | Reg=0.00295 | L2-Norm=17.165 | L2-Norm(final)=2.075 | acc=0.9844 | 4788.3 samples/s | 74.8 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.13524 | Reg=0.00295 | L2-Norm=17.179 | L2-Norm(final)=2.081 | acc=0.9375 | 4937.5 samples/s | 77.1 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.13100 | Reg=0.00296 | L2-Norm=17.191 | L2-Norm(final)=2.087 | acc=0.9688 | 4822.2 samples/s | 75.3 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.12762 | Reg=0.00296 | L2-Norm=17.205 | L2-Norm(final)=2.093 | acc=0.8906 | 4862.3 samples/s | 76.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 3.1] | Loss=0.07343 | Reg=0.00295 | L2-Norm=17.183 | L2-Norm(final)=2.012 | acc=0.9531 | 4190.3 samples/s | 65.5 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.03956 | Reg=0.00298 | L2-Norm=17.271 | L2-Norm(final)=2.037 | acc=1.0000 | 4503.5 samples/s | 70.4 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.02662 | Reg=0.00299 | L2-Norm=17.283 | L2-Norm(final)=2.046 | acc=0.9688 | 4548.9 samples/s | 71.1 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.02099 | Reg=0.00298 | L2-Norm=17.267 | L2-Norm(final)=2.050 | acc=1.0000 | 4617.3 samples/s | 72.1 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02072 | Reg=0.00297 | L2-Norm=17.248 | L2-Norm(final)=2.052 | acc=1.0000 | 4753.2 samples/s | 74.3 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.01871 | Reg=0.00297 | L2-Norm=17.241 | L2-Norm(final)=2.052 | acc=0.9688 | 5810.6 samples/s | 90.8 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01680 | Reg=0.00297 | L2-Norm=17.233 | L2-Norm(final)=2.051 | acc=1.0000 | 2037.4 samples/s | 31.8 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01465 | Reg=0.00297 | L2-Norm=17.220 | L2-Norm(final)=2.051 | acc=1.0000 | 4650.9 samples/s | 72.7 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01288 | Reg=0.00296 | L2-Norm=17.201 | L2-Norm(final)=2.052 | acc=1.0000 | 4664.4 samples/s | 72.9 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01151 | Reg=0.00295 | L2-Norm=17.178 | L2-Norm(final)=2.053 | acc=1.0000 | 4706.3 samples/s | 73.5 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.01038 | Reg=0.00294 | L2-Norm=17.152 | L2-Norm(final)=2.055 | acc=1.0000 | 5292.3 samples/s | 82.7 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00948 | Reg=0.00293 | L2-Norm=17.124 | L2-Norm(final)=2.057 | acc=1.0000 | 2131.6 samples/s | 33.3 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00870 | Reg=0.00292 | L2-Norm=17.095 | L2-Norm(final)=2.058 | acc=1.0000 | 4670.4 samples/s | 73.0 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00803 | Reg=0.00291 | L2-Norm=17.064 | L2-Norm(final)=2.060 | acc=1.0000 | 4657.3 samples/s | 72.8 steps/s
[Step=1500 Epoch= 5.8] | Loss=0.00746 | Reg=0.00290 | L2-Norm=17.032 | L2-Norm(final)=2.061 | acc=1.0000 | 4721.9 samples/s | 73.8 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.00697 | Reg=0.00289 | L2-Norm=16.999 | L2-Norm(final)=2.063 | acc=1.0000 | 4660.6 samples/s | 72.8 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.00654 | Reg=0.00288 | L2-Norm=16.966 | L2-Norm(final)=2.064 | acc=1.0000 | 2202.3 samples/s | 34.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46632 | acc=0.4980 | tpr=0.4433 | fpr=0.3833 | 4478.4 samples/s | 17.5 steps/s
Avg test loss: 0.46321, Avg test acc: 0.49872, Avg tpr: 0.44349, Avg fpr: 0.37982, total FA: 2963

Testing server on iccad2012
[Step=  50] | Loss=0.16066 | acc=0.8823 | tpr=0.9912 | fpr=0.1197 | 4513.5 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.16227 | acc=0.8809 | tpr=0.9957 | fpr=0.1212 | 7850.0 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.16290 | acc=0.8798 | tpr=0.9957 | fpr=0.1223 | 8280.3 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.16392 | acc=0.8791 | tpr=0.9956 | fpr=0.1230 | 8357.5 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.16373 | acc=0.8788 | tpr=0.9956 | fpr=0.1233 | 8615.2 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.16383 | acc=0.8793 | tpr=0.9964 | fpr=0.1228 | 8433.7 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.16425 | acc=0.8788 | tpr=0.9956 | fpr=0.1233 | 8477.5 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.16457 | acc=0.8790 | tpr=0.9956 | fpr=0.1232 | 8479.4 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.16533 | acc=0.8784 | tpr=0.9927 | fpr=0.1237 | 8593.5 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.16548 | acc=0.8780 | tpr=0.9925 | fpr=0.1241 | 8363.7 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.16497 | acc=0.8787 | tpr=0.9928 | fpr=0.1234 | 15835.9 samples/s | 61.9 steps/s
Avg test loss: 0.16490, Avg test acc: 0.87877, Avg tpr: 0.99287, Avg fpr: 0.12331, total FA: 17121

server round 2/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.38751 | Reg=0.00272 | L2-Norm=16.496 | L2-Norm(final)=2.053 | acc=0.5469 | 4266.8 samples/s | 66.7 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.23353 | Reg=0.00270 | L2-Norm=16.441 | L2-Norm(final)=2.046 | acc=0.8594 | 4978.7 samples/s | 77.8 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.19598 | Reg=0.00271 | L2-Norm=16.449 | L2-Norm(final)=2.057 | acc=0.8594 | 4915.7 samples/s | 76.8 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.17118 | Reg=0.00271 | L2-Norm=16.466 | L2-Norm(final)=2.069 | acc=0.7969 | 4903.1 samples/s | 76.6 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.15872 | Reg=0.00272 | L2-Norm=16.483 | L2-Norm(final)=2.079 | acc=0.8594 | 4975.8 samples/s | 77.7 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.14725 | Reg=0.00272 | L2-Norm=16.500 | L2-Norm(final)=2.089 | acc=0.8594 | 4964.2 samples/s | 77.6 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.13969 | Reg=0.00273 | L2-Norm=16.514 | L2-Norm(final)=2.097 | acc=0.9219 | 4907.9 samples/s | 76.7 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.13339 | Reg=0.00273 | L2-Norm=16.528 | L2-Norm(final)=2.103 | acc=0.9531 | 4869.3 samples/s | 76.1 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.12785 | Reg=0.00274 | L2-Norm=16.540 | L2-Norm(final)=2.109 | acc=0.9688 | 4831.0 samples/s | 75.5 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.12366 | Reg=0.00274 | L2-Norm=16.553 | L2-Norm(final)=2.113 | acc=0.9688 | 4874.4 samples/s | 76.2 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.11932 | Reg=0.00275 | L2-Norm=16.569 | L2-Norm(final)=2.119 | acc=0.9844 | 6071.2 samples/s | 94.9 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.11448 | Reg=0.00275 | L2-Norm=16.585 | L2-Norm(final)=2.124 | acc=0.9375 | 2133.7 samples/s | 33.3 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.11032 | Reg=0.00276 | L2-Norm=16.602 | L2-Norm(final)=2.129 | acc=0.9375 | 4846.7 samples/s | 75.7 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.10690 | Reg=0.00276 | L2-Norm=16.619 | L2-Norm(final)=2.134 | acc=0.9375 | 4859.8 samples/s | 75.9 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.10387 | Reg=0.00277 | L2-Norm=16.638 | L2-Norm(final)=2.139 | acc=0.9219 | 4896.3 samples/s | 76.5 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.10148 | Reg=0.00277 | L2-Norm=16.655 | L2-Norm(final)=2.143 | acc=0.8906 | 4635.8 samples/s | 72.4 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.09908 | Reg=0.00278 | L2-Norm=16.671 | L2-Norm(final)=2.147 | acc=0.9531 | 4829.8 samples/s | 75.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 3.1] | Loss=0.11215 | Reg=0.00272 | L2-Norm=16.496 | L2-Norm(final)=2.054 | acc=0.9219 | 4842.8 samples/s | 75.7 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.02723 | Reg=0.00277 | L2-Norm=16.650 | L2-Norm(final)=2.066 | acc=1.0000 | 4142.3 samples/s | 64.7 steps/s
[Step= 900 Epoch= 3.4] | Loss=0.02039 | Reg=0.00278 | L2-Norm=16.670 | L2-Norm(final)=2.066 | acc=0.9844 | 4665.1 samples/s | 72.9 steps/s
[Step= 950 Epoch= 3.6] | Loss=0.01551 | Reg=0.00278 | L2-Norm=16.666 | L2-Norm(final)=2.069 | acc=1.0000 | 4631.5 samples/s | 72.4 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.01284 | Reg=0.00277 | L2-Norm=16.653 | L2-Norm(final)=2.073 | acc=1.0000 | 4628.6 samples/s | 72.3 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.01077 | Reg=0.00277 | L2-Norm=16.634 | L2-Norm(final)=2.077 | acc=0.9844 | 5849.2 samples/s | 91.4 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.00946 | Reg=0.00276 | L2-Norm=16.611 | L2-Norm(final)=2.081 | acc=1.0000 | 2039.3 samples/s | 31.9 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.00816 | Reg=0.00275 | L2-Norm=16.584 | L2-Norm(final)=2.084 | acc=1.0000 | 4654.6 samples/s | 72.7 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.00715 | Reg=0.00274 | L2-Norm=16.555 | L2-Norm(final)=2.087 | acc=1.0000 | 4671.5 samples/s | 73.0 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.00636 | Reg=0.00273 | L2-Norm=16.523 | L2-Norm(final)=2.089 | acc=1.0000 | 4570.0 samples/s | 71.4 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00607 | Reg=0.00272 | L2-Norm=16.490 | L2-Norm(final)=2.092 | acc=0.9844 | 5222.9 samples/s | 81.6 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00583 | Reg=0.00271 | L2-Norm=16.463 | L2-Norm(final)=2.093 | acc=0.9844 | 2150.6 samples/s | 33.6 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00550 | Reg=0.00270 | L2-Norm=16.442 | L2-Norm(final)=2.095 | acc=1.0000 | 4644.0 samples/s | 72.6 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00513 | Reg=0.00270 | L2-Norm=16.420 | L2-Norm(final)=2.097 | acc=1.0000 | 4691.9 samples/s | 73.3 steps/s
[Step=1500 Epoch= 5.7] | Loss=0.00477 | Reg=0.00269 | L2-Norm=16.398 | L2-Norm(final)=2.099 | acc=1.0000 | 4646.9 samples/s | 72.6 steps/s
[Step=1550 Epoch= 5.9] | Loss=0.00446 | Reg=0.00268 | L2-Norm=16.374 | L2-Norm(final)=2.101 | acc=1.0000 | 4547.7 samples/s | 71.1 steps/s
[Step=1600 Epoch= 6.1] | Loss=0.00419 | Reg=0.00267 | L2-Norm=16.348 | L2-Norm(final)=2.102 | acc=1.0000 | 2209.8 samples/s | 34.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38797 | acc=0.6509 | tpr=0.5788 | fpr=0.1928 | 4648.3 samples/s | 18.2 steps/s
Avg test loss: 0.38633, Avg test acc: 0.65350, Avg tpr: 0.58215, Avg fpr: 0.18959, total FA: 1479

Testing server on iccad2012
[Step=  50] | Loss=0.19122 | acc=0.8578 | tpr=0.9912 | fpr=0.1446 | 4563.2 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.19372 | acc=0.8557 | tpr=0.9957 | fpr=0.1469 | 8428.3 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.19492 | acc=0.8553 | tpr=0.9957 | fpr=0.1473 | 8342.0 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.19626 | acc=0.8547 | tpr=0.9956 | fpr=0.1478 | 8549.4 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.19551 | acc=0.8544 | tpr=0.9921 | fpr=0.1481 | 8745.7 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.19598 | acc=0.8543 | tpr=0.9905 | fpr=0.1481 | 8363.7 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.19648 | acc=0.8541 | tpr=0.9894 | fpr=0.1483 | 8418.0 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.19727 | acc=0.8540 | tpr=0.9902 | fpr=0.1485 | 8584.1 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.19862 | acc=0.8532 | tpr=0.9878 | fpr=0.1493 | 8805.5 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.19874 | acc=0.8530 | tpr=0.9877 | fpr=0.1494 | 8148.4 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.19818 | acc=0.8537 | tpr=0.9885 | fpr=0.1488 | 15793.7 samples/s | 61.7 steps/s
Avg test loss: 0.19807, Avg test acc: 0.85373, Avg tpr: 0.98851, Avg fpr: 0.14872, total FA: 20649

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 1.6] | Loss=0.27534 | Reg=0.00256 | L2-Norm=16.013 | L2-Norm(final)=2.131 | acc=0.7500 | 4654.2 samples/s | 72.7 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.14402 | Reg=0.00260 | L2-Norm=16.135 | L2-Norm(final)=2.125 | acc=0.9219 | 4237.4 samples/s | 66.2 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.12414 | Reg=0.00263 | L2-Norm=16.202 | L2-Norm(final)=2.133 | acc=0.9531 | 4644.7 samples/s | 72.6 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.11065 | Reg=0.00264 | L2-Norm=16.248 | L2-Norm(final)=2.141 | acc=0.8594 | 4748.1 samples/s | 74.2 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.10453 | Reg=0.00265 | L2-Norm=16.286 | L2-Norm(final)=2.148 | acc=0.8281 | 4773.4 samples/s | 74.6 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.09840 | Reg=0.00266 | L2-Norm=16.318 | L2-Norm(final)=2.155 | acc=0.9375 | 4740.2 samples/s | 74.1 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.09356 | Reg=0.00267 | L2-Norm=16.343 | L2-Norm(final)=2.160 | acc=0.9219 | 4948.0 samples/s | 77.3 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.09073 | Reg=0.00268 | L2-Norm=16.366 | L2-Norm(final)=2.165 | acc=0.9531 | 4928.7 samples/s | 77.0 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.08896 | Reg=0.00269 | L2-Norm=16.386 | L2-Norm(final)=2.169 | acc=0.9219 | 4943.6 samples/s | 77.2 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.08687 | Reg=0.00269 | L2-Norm=16.405 | L2-Norm(final)=2.172 | acc=0.9844 | 4939.7 samples/s | 77.2 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.08471 | Reg=0.00270 | L2-Norm=16.424 | L2-Norm(final)=2.176 | acc=0.9844 | 6039.5 samples/s | 94.4 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.08149 | Reg=0.00270 | L2-Norm=16.441 | L2-Norm(final)=2.179 | acc=0.9844 | 2103.1 samples/s | 32.9 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.07924 | Reg=0.00271 | L2-Norm=16.459 | L2-Norm(final)=2.182 | acc=1.0000 | 4775.1 samples/s | 74.6 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.07738 | Reg=0.00271 | L2-Norm=16.476 | L2-Norm(final)=2.185 | acc=0.9375 | 4953.0 samples/s | 77.4 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.07557 | Reg=0.00272 | L2-Norm=16.495 | L2-Norm(final)=2.189 | acc=0.9688 | 4958.1 samples/s | 77.5 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.07417 | Reg=0.00273 | L2-Norm=16.512 | L2-Norm(final)=2.192 | acc=0.9375 | 5051.0 samples/s | 78.9 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.07252 | Reg=0.00273 | L2-Norm=16.528 | L2-Norm(final)=2.195 | acc=0.9219 | 4957.2 samples/s | 77.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step1600.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step= 801 Epoch= 1.6] | Loss=0.34928 | Reg=0.00256 | L2-Norm=16.013 | L2-Norm(final)=2.130 | acc=0.7656 | 4155.6 samples/s | 64.9 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.14234 | Reg=0.00259 | L2-Norm=16.096 | L2-Norm(final)=2.118 | acc=0.9062 | 4947.0 samples/s | 77.3 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.12281 | Reg=0.00261 | L2-Norm=16.148 | L2-Norm(final)=2.131 | acc=0.9844 | 4886.9 samples/s | 76.4 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.11476 | Reg=0.00262 | L2-Norm=16.186 | L2-Norm(final)=2.141 | acc=0.8906 | 4930.3 samples/s | 77.0 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.10951 | Reg=0.00263 | L2-Norm=16.223 | L2-Norm(final)=2.146 | acc=0.9219 | 4915.3 samples/s | 76.8 steps/s
[Step=1050 Epoch= 2.1] | Loss=0.10428 | Reg=0.00264 | L2-Norm=16.254 | L2-Norm(final)=2.151 | acc=0.9375 | 4998.7 samples/s | 78.1 steps/s
[Step=1100 Epoch= 2.2] | Loss=0.10009 | Reg=0.00265 | L2-Norm=16.279 | L2-Norm(final)=2.155 | acc=0.9844 | 4913.5 samples/s | 76.8 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.09780 | Reg=0.00266 | L2-Norm=16.302 | L2-Norm(final)=2.158 | acc=0.9062 | 4792.5 samples/s | 74.9 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.09377 | Reg=0.00266 | L2-Norm=16.322 | L2-Norm(final)=2.162 | acc=0.9844 | 4905.3 samples/s | 76.6 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.09015 | Reg=0.00267 | L2-Norm=16.342 | L2-Norm(final)=2.167 | acc=0.9375 | 4816.4 samples/s | 75.3 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.08793 | Reg=0.00268 | L2-Norm=16.359 | L2-Norm(final)=2.171 | acc=0.9531 | 6047.5 samples/s | 94.5 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.08497 | Reg=0.00268 | L2-Norm=16.375 | L2-Norm(final)=2.174 | acc=0.9688 | 2113.5 samples/s | 33.0 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.08213 | Reg=0.00269 | L2-Norm=16.392 | L2-Norm(final)=2.178 | acc=0.9688 | 4766.2 samples/s | 74.5 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.07945 | Reg=0.00269 | L2-Norm=16.409 | L2-Norm(final)=2.183 | acc=1.0000 | 4953.9 samples/s | 77.4 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.07729 | Reg=0.00270 | L2-Norm=16.425 | L2-Norm(final)=2.187 | acc=0.9844 | 4793.7 samples/s | 74.9 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.07547 | Reg=0.00270 | L2-Norm=16.440 | L2-Norm(final)=2.191 | acc=0.9688 | 4946.4 samples/s | 77.3 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.07434 | Reg=0.00271 | L2-Norm=16.456 | L2-Norm(final)=2.194 | acc=0.9844 | 4779.0 samples/s | 74.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33845 | acc=0.6959 | tpr=0.6273 | fpr=0.1554 | 4561.8 samples/s | 17.8 steps/s
Avg test loss: 0.33736, Avg test acc: 0.69781, Avg tpr: 0.62936, Avg fpr: 0.15165, total FA: 1183

Testing server on iccad2012
[Step=  50] | Loss=0.24805 | acc=0.8166 | tpr=0.9823 | fpr=0.1863 | 4579.5 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.24968 | acc=0.8175 | tpr=0.9893 | fpr=0.1857 | 8489.9 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.25129 | acc=0.8163 | tpr=0.9899 | fpr=0.1869 | 8336.4 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.25248 | acc=0.8155 | tpr=0.9913 | fpr=0.1877 | 8756.6 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.25126 | acc=0.8159 | tpr=0.9895 | fpr=0.1872 | 8446.4 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.25218 | acc=0.8157 | tpr=0.9891 | fpr=0.1874 | 8722.7 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.25269 | acc=0.8152 | tpr=0.9887 | fpr=0.1880 | 8708.1 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.25364 | acc=0.8148 | tpr=0.9891 | fpr=0.1883 | 8104.4 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.25518 | acc=0.8143 | tpr=0.9859 | fpr=0.1888 | 9083.3 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.25544 | acc=0.8139 | tpr=0.9859 | fpr=0.1892 | 8030.9 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.25484 | acc=0.8142 | tpr=0.9869 | fpr=0.1889 | 15649.0 samples/s | 61.1 steps/s
Avg test loss: 0.25469, Avg test acc: 0.81431, Avg tpr: 0.98693, Avg fpr: 0.18883, total FA: 26219

server round 4/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 3.1] | Loss=0.30223 | Reg=0.00249 | L2-Norm=15.768 | L2-Norm(final)=2.155 | acc=0.6875 | 4404.4 samples/s | 68.8 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.12087 | Reg=0.00252 | L2-Norm=15.886 | L2-Norm(final)=2.166 | acc=0.9531 | 4632.5 samples/s | 72.4 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.10283 | Reg=0.00255 | L2-Norm=15.958 | L2-Norm(final)=2.182 | acc=0.8594 | 4895.1 samples/s | 76.5 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.09659 | Reg=0.00256 | L2-Norm=16.006 | L2-Norm(final)=2.191 | acc=0.9219 | 4907.0 samples/s | 76.7 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.08947 | Reg=0.00258 | L2-Norm=16.047 | L2-Norm(final)=2.198 | acc=0.9844 | 4938.4 samples/s | 77.2 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.08587 | Reg=0.00259 | L2-Norm=16.079 | L2-Norm(final)=2.204 | acc=0.9531 | 4925.1 samples/s | 77.0 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.08399 | Reg=0.00259 | L2-Norm=16.106 | L2-Norm(final)=2.209 | acc=0.9531 | 4909.5 samples/s | 76.7 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.08144 | Reg=0.00260 | L2-Norm=16.131 | L2-Norm(final)=2.211 | acc=0.9688 | 4887.3 samples/s | 76.4 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.07877 | Reg=0.00261 | L2-Norm=16.154 | L2-Norm(final)=2.216 | acc=0.9062 | 4933.6 samples/s | 77.1 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.07694 | Reg=0.00262 | L2-Norm=16.176 | L2-Norm(final)=2.220 | acc=0.9375 | 4872.1 samples/s | 76.1 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.07539 | Reg=0.00262 | L2-Norm=16.197 | L2-Norm(final)=2.224 | acc=0.9688 | 5941.3 samples/s | 92.8 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.07256 | Reg=0.00263 | L2-Norm=16.216 | L2-Norm(final)=2.228 | acc=0.9688 | 2090.3 samples/s | 32.7 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.07011 | Reg=0.00264 | L2-Norm=16.235 | L2-Norm(final)=2.232 | acc=0.9844 | 4958.4 samples/s | 77.5 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.06836 | Reg=0.00264 | L2-Norm=16.253 | L2-Norm(final)=2.236 | acc=0.9688 | 4965.1 samples/s | 77.6 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.06688 | Reg=0.00265 | L2-Norm=16.270 | L2-Norm(final)=2.240 | acc=0.9219 | 4952.8 samples/s | 77.4 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.06580 | Reg=0.00265 | L2-Norm=16.286 | L2-Norm(final)=2.242 | acc=0.9844 | 5057.2 samples/s | 79.0 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.06481 | Reg=0.00266 | L2-Norm=16.302 | L2-Norm(final)=2.245 | acc=0.9375 | 4926.8 samples/s | 77.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step2400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 6.2] | Loss=0.08624 | Reg=0.00249 | L2-Norm=15.768 | L2-Norm(final)=2.154 | acc=0.9375 | 4507.6 samples/s | 70.4 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.02927 | Reg=0.00256 | L2-Norm=16.003 | L2-Norm(final)=2.157 | acc=0.9844 | 4530.5 samples/s | 70.8 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.01893 | Reg=0.00260 | L2-Norm=16.134 | L2-Norm(final)=2.148 | acc=0.9844 | 4747.9 samples/s | 74.2 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.01499 | Reg=0.00262 | L2-Norm=16.173 | L2-Norm(final)=2.146 | acc=1.0000 | 4646.3 samples/s | 72.6 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.01234 | Reg=0.00262 | L2-Norm=16.187 | L2-Norm(final)=2.145 | acc=1.0000 | 4630.1 samples/s | 72.3 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.01018 | Reg=0.00262 | L2-Norm=16.187 | L2-Norm(final)=2.146 | acc=0.9844 | 5906.7 samples/s | 92.3 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00854 | Reg=0.00262 | L2-Norm=16.177 | L2-Norm(final)=2.147 | acc=1.0000 | 1973.2 samples/s | 30.8 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00740 | Reg=0.00261 | L2-Norm=16.163 | L2-Norm(final)=2.149 | acc=1.0000 | 4430.6 samples/s | 69.2 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00649 | Reg=0.00261 | L2-Norm=16.145 | L2-Norm(final)=2.151 | acc=1.0000 | 4597.7 samples/s | 71.8 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.00577 | Reg=0.00260 | L2-Norm=16.125 | L2-Norm(final)=2.153 | acc=1.0000 | 4633.7 samples/s | 72.4 steps/s
[Step=2100 Epoch= 8.1] | Loss=0.00520 | Reg=0.00259 | L2-Norm=16.103 | L2-Norm(final)=2.154 | acc=1.0000 | 5177.2 samples/s | 80.9 steps/s
[Step=2150 Epoch= 8.3] | Loss=0.00473 | Reg=0.00259 | L2-Norm=16.079 | L2-Norm(final)=2.156 | acc=1.0000 | 2149.3 samples/s | 33.6 steps/s
[Step=2200 Epoch= 8.5] | Loss=0.00434 | Reg=0.00258 | L2-Norm=16.054 | L2-Norm(final)=2.157 | acc=1.0000 | 4660.5 samples/s | 72.8 steps/s
[Step=2250 Epoch= 8.7] | Loss=0.00400 | Reg=0.00257 | L2-Norm=16.028 | L2-Norm(final)=2.158 | acc=1.0000 | 4720.5 samples/s | 73.8 steps/s
[Step=2300 Epoch= 8.9] | Loss=0.00372 | Reg=0.00256 | L2-Norm=16.001 | L2-Norm(final)=2.159 | acc=1.0000 | 4622.1 samples/s | 72.2 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.00347 | Reg=0.00255 | L2-Norm=15.974 | L2-Norm(final)=2.161 | acc=1.0000 | 4809.9 samples/s | 75.2 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.00326 | Reg=0.00254 | L2-Norm=15.946 | L2-Norm(final)=2.161 | acc=1.0000 | 2250.2 samples/s | 35.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40524 | acc=0.6720 | tpr=0.5517 | fpr=0.0669 | 4551.7 samples/s | 17.8 steps/s
Avg test loss: 0.40643, Avg test acc: 0.67193, Avg tpr: 0.55319, Avg fpr: 0.06691, total FA: 522

Testing server on iccad2012
[Step=  50] | Loss=0.20873 | acc=0.8570 | tpr=0.9735 | fpr=0.1451 | 4609.3 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.20894 | acc=0.8585 | tpr=0.9829 | fpr=0.1438 | 8440.1 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.21131 | acc=0.8574 | tpr=0.9885 | fpr=0.1450 | 8431.1 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.21211 | acc=0.8571 | tpr=0.9902 | fpr=0.1453 | 8392.1 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.21105 | acc=0.8571 | tpr=0.9869 | fpr=0.1453 | 9207.0 samples/s | 36.0 steps/s
[Step= 300] | Loss=0.21258 | acc=0.8566 | tpr=0.9862 | fpr=0.1457 | 7876.3 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.21292 | acc=0.8565 | tpr=0.9869 | fpr=0.1459 | 8687.2 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.21376 | acc=0.8560 | tpr=0.9869 | fpr=0.1463 | 8368.4 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.21553 | acc=0.8555 | tpr=0.9844 | fpr=0.1469 | 8645.8 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.21565 | acc=0.8550 | tpr=0.9837 | fpr=0.1473 | 8397.8 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.21483 | acc=0.8555 | tpr=0.9849 | fpr=0.1468 | 15743.1 samples/s | 61.5 steps/s
Avg test loss: 0.21466, Avg test acc: 0.85564, Avg tpr: 0.98494, Avg fpr: 0.14671, total FA: 20370

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 4.7] | Loss=0.28077 | Reg=0.00244 | L2-Norm=15.607 | L2-Norm(final)=2.190 | acc=0.7656 | 4223.9 samples/s | 66.0 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.11304 | Reg=0.00248 | L2-Norm=15.742 | L2-Norm(final)=2.186 | acc=0.9062 | 4549.0 samples/s | 71.1 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.09562 | Reg=0.00250 | L2-Norm=15.808 | L2-Norm(final)=2.204 | acc=0.9219 | 4911.9 samples/s | 76.7 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.08380 | Reg=0.00251 | L2-Norm=15.850 | L2-Norm(final)=2.217 | acc=0.9688 | 5020.1 samples/s | 78.4 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.07837 | Reg=0.00252 | L2-Norm=15.879 | L2-Norm(final)=2.228 | acc=0.9375 | 4854.9 samples/s | 75.9 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.07702 | Reg=0.00253 | L2-Norm=15.902 | L2-Norm(final)=2.233 | acc=0.9375 | 4939.2 samples/s | 77.2 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.07383 | Reg=0.00254 | L2-Norm=15.928 | L2-Norm(final)=2.239 | acc=0.9531 | 4888.1 samples/s | 76.4 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.07027 | Reg=0.00255 | L2-Norm=15.955 | L2-Norm(final)=2.245 | acc=0.9219 | 4900.2 samples/s | 76.6 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.06819 | Reg=0.00255 | L2-Norm=15.979 | L2-Norm(final)=2.250 | acc=0.9688 | 4896.3 samples/s | 76.5 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.06664 | Reg=0.00256 | L2-Norm=15.999 | L2-Norm(final)=2.252 | acc=1.0000 | 4916.7 samples/s | 76.8 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.06559 | Reg=0.00257 | L2-Norm=16.015 | L2-Norm(final)=2.255 | acc=0.9531 | 5984.1 samples/s | 93.5 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.06349 | Reg=0.00257 | L2-Norm=16.032 | L2-Norm(final)=2.257 | acc=0.9844 | 2112.6 samples/s | 33.0 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.06158 | Reg=0.00258 | L2-Norm=16.049 | L2-Norm(final)=2.260 | acc=1.0000 | 4847.5 samples/s | 75.7 steps/s
[Step=3050 Epoch= 5.9] | Loss=0.06023 | Reg=0.00258 | L2-Norm=16.065 | L2-Norm(final)=2.262 | acc=0.9844 | 4990.3 samples/s | 78.0 steps/s
[Step=3100 Epoch= 6.0] | Loss=0.05898 | Reg=0.00259 | L2-Norm=16.080 | L2-Norm(final)=2.264 | acc=0.9688 | 4887.2 samples/s | 76.4 steps/s
[Step=3150 Epoch= 6.1] | Loss=0.05793 | Reg=0.00259 | L2-Norm=16.095 | L2-Norm(final)=2.266 | acc=1.0000 | 4916.3 samples/s | 76.8 steps/s
[Step=3200 Epoch= 6.2] | Loss=0.05721 | Reg=0.00260 | L2-Norm=16.111 | L2-Norm(final)=2.267 | acc=0.9531 | 5046.2 samples/s | 78.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step3200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 3.1] | Loss=0.33662 | Reg=0.00244 | L2-Norm=15.607 | L2-Norm(final)=2.190 | acc=0.7031 | 4295.0 samples/s | 67.1 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.11340 | Reg=0.00248 | L2-Norm=15.751 | L2-Norm(final)=2.185 | acc=0.8906 | 4896.5 samples/s | 76.5 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.09061 | Reg=0.00250 | L2-Norm=15.818 | L2-Norm(final)=2.201 | acc=0.9375 | 5022.9 samples/s | 78.5 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.08650 | Reg=0.00251 | L2-Norm=15.854 | L2-Norm(final)=2.209 | acc=0.8906 | 4822.7 samples/s | 75.4 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.08139 | Reg=0.00252 | L2-Norm=15.879 | L2-Norm(final)=2.212 | acc=0.9688 | 4806.3 samples/s | 75.1 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.07901 | Reg=0.00253 | L2-Norm=15.902 | L2-Norm(final)=2.214 | acc=0.9844 | 4876.1 samples/s | 76.2 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.07627 | Reg=0.00254 | L2-Norm=15.927 | L2-Norm(final)=2.218 | acc=0.9375 | 4820.8 samples/s | 75.3 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.07441 | Reg=0.00254 | L2-Norm=15.947 | L2-Norm(final)=2.221 | acc=0.9688 | 4971.1 samples/s | 77.7 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.07248 | Reg=0.00255 | L2-Norm=15.966 | L2-Norm(final)=2.224 | acc=0.9844 | 4885.0 samples/s | 76.3 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.07124 | Reg=0.00256 | L2-Norm=15.985 | L2-Norm(final)=2.226 | acc=0.9688 | 4978.5 samples/s | 77.8 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.06943 | Reg=0.00256 | L2-Norm=16.004 | L2-Norm(final)=2.228 | acc=0.9688 | 6116.6 samples/s | 95.6 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.06691 | Reg=0.00257 | L2-Norm=16.023 | L2-Norm(final)=2.231 | acc=1.0000 | 2137.6 samples/s | 33.4 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.06446 | Reg=0.00257 | L2-Norm=16.043 | L2-Norm(final)=2.235 | acc=1.0000 | 4872.7 samples/s | 76.1 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.06284 | Reg=0.00258 | L2-Norm=16.062 | L2-Norm(final)=2.238 | acc=0.9375 | 4855.6 samples/s | 75.9 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.06153 | Reg=0.00259 | L2-Norm=16.082 | L2-Norm(final)=2.241 | acc=0.9219 | 4891.0 samples/s | 76.4 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.06082 | Reg=0.00259 | L2-Norm=16.100 | L2-Norm(final)=2.244 | acc=0.9531 | 5032.4 samples/s | 78.6 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.05979 | Reg=0.00260 | L2-Norm=16.117 | L2-Norm(final)=2.246 | acc=0.9531 | 5011.3 samples/s | 78.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30503 | acc=0.7527 | tpr=0.6750 | fpr=0.0785 | 4497.1 samples/s | 17.6 steps/s
Avg test loss: 0.30632, Avg test acc: 0.75050, Avg tpr: 0.67203, Avg fpr: 0.07691, total FA: 600

Testing server on iccad2012
[Step=  50] | Loss=0.29759 | acc=0.8046 | tpr=0.9823 | fpr=0.1986 | 4606.9 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.29877 | acc=0.8057 | tpr=0.9893 | fpr=0.1978 | 8315.4 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.30040 | acc=0.8032 | tpr=0.9885 | fpr=0.2002 | 8450.8 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.30116 | acc=0.8025 | tpr=0.9902 | fpr=0.2009 | 8779.0 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.30012 | acc=0.8027 | tpr=0.9878 | fpr=0.2007 | 8899.2 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.30200 | acc=0.8019 | tpr=0.9862 | fpr=0.2015 | 8016.2 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.30238 | acc=0.8013 | tpr=0.9862 | fpr=0.2020 | 8624.4 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.30361 | acc=0.8006 | tpr=0.9869 | fpr=0.2028 | 8499.8 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.30597 | acc=0.8001 | tpr=0.9844 | fpr=0.2033 | 8534.0 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.30597 | acc=0.7998 | tpr=0.9837 | fpr=0.2035 | 8422.4 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.30510 | acc=0.8006 | tpr=0.9845 | fpr=0.2028 | 15656.3 samples/s | 61.2 steps/s
Avg test loss: 0.30490, Avg test acc: 0.80066, Avg tpr: 0.98455, Avg fpr: 0.20268, total FA: 28142

server round 6/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 6.2] | Loss=0.21010 | Reg=0.00238 | L2-Norm=15.438 | L2-Norm(final)=2.204 | acc=0.8125 | 4496.9 samples/s | 70.3 steps/s
[Step=3250 Epoch= 6.3] | Loss=0.09614 | Reg=0.00243 | L2-Norm=15.581 | L2-Norm(final)=2.198 | acc=0.9062 | 4740.0 samples/s | 74.1 steps/s
[Step=3300 Epoch= 6.4] | Loss=0.08575 | Reg=0.00245 | L2-Norm=15.649 | L2-Norm(final)=2.209 | acc=0.9688 | 4836.8 samples/s | 75.6 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.07840 | Reg=0.00246 | L2-Norm=15.691 | L2-Norm(final)=2.219 | acc=0.9062 | 4867.6 samples/s | 76.1 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.07486 | Reg=0.00247 | L2-Norm=15.721 | L2-Norm(final)=2.227 | acc=0.9062 | 4751.7 samples/s | 74.2 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.07119 | Reg=0.00248 | L2-Norm=15.746 | L2-Norm(final)=2.232 | acc=0.9688 | 4917.1 samples/s | 76.8 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.06815 | Reg=0.00249 | L2-Norm=15.769 | L2-Norm(final)=2.236 | acc=0.9688 | 4884.0 samples/s | 76.3 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.06658 | Reg=0.00249 | L2-Norm=15.787 | L2-Norm(final)=2.239 | acc=0.9531 | 4958.2 samples/s | 77.5 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.06415 | Reg=0.00250 | L2-Norm=15.805 | L2-Norm(final)=2.242 | acc=0.9531 | 4815.2 samples/s | 75.2 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.06395 | Reg=0.00250 | L2-Norm=15.821 | L2-Norm(final)=2.244 | acc=0.9375 | 4834.7 samples/s | 75.5 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.06301 | Reg=0.00251 | L2-Norm=15.838 | L2-Norm(final)=2.246 | acc=0.9844 | 6039.2 samples/s | 94.4 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.06109 | Reg=0.00251 | L2-Norm=15.854 | L2-Norm(final)=2.248 | acc=0.9219 | 2063.5 samples/s | 32.2 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.05878 | Reg=0.00252 | L2-Norm=15.870 | L2-Norm(final)=2.252 | acc=0.9375 | 4882.5 samples/s | 76.3 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.05800 | Reg=0.00252 | L2-Norm=15.888 | L2-Norm(final)=2.255 | acc=1.0000 | 4909.2 samples/s | 76.7 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.05664 | Reg=0.00253 | L2-Norm=15.906 | L2-Norm(final)=2.257 | acc=0.9844 | 4961.2 samples/s | 77.5 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.05580 | Reg=0.00254 | L2-Norm=15.924 | L2-Norm(final)=2.259 | acc=0.9844 | 4922.2 samples/s | 76.9 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.05464 | Reg=0.00254 | L2-Norm=15.942 | L2-Norm(final)=2.261 | acc=0.9688 | 5071.2 samples/s | 79.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 9.2] | Loss=0.08282 | Reg=0.00238 | L2-Norm=15.438 | L2-Norm(final)=2.205 | acc=0.9375 | 4380.1 samples/s | 68.4 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.01694 | Reg=0.00246 | L2-Norm=15.697 | L2-Norm(final)=2.200 | acc=1.0000 | 4454.8 samples/s | 69.6 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.01316 | Reg=0.00249 | L2-Norm=15.767 | L2-Norm(final)=2.193 | acc=1.0000 | 4626.6 samples/s | 72.3 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.01014 | Reg=0.00249 | L2-Norm=15.791 | L2-Norm(final)=2.190 | acc=0.9844 | 4559.5 samples/s | 71.2 steps/s
[Step=2600 Epoch=10.0] | Loss=0.00829 | Reg=0.00250 | L2-Norm=15.802 | L2-Norm(final)=2.192 | acc=1.0000 | 4640.0 samples/s | 72.5 steps/s
[Step=2650 Epoch=10.2] | Loss=0.00710 | Reg=0.00250 | L2-Norm=15.803 | L2-Norm(final)=2.194 | acc=1.0000 | 5482.2 samples/s | 85.7 steps/s
[Step=2700 Epoch=10.4] | Loss=0.00656 | Reg=0.00250 | L2-Norm=15.801 | L2-Norm(final)=2.196 | acc=1.0000 | 1988.1 samples/s | 31.1 steps/s
[Step=2750 Epoch=10.6] | Loss=0.00578 | Reg=0.00250 | L2-Norm=15.798 | L2-Norm(final)=2.197 | acc=1.0000 | 3939.5 samples/s | 61.6 steps/s
[Step=2800 Epoch=10.8] | Loss=0.00509 | Reg=0.00249 | L2-Norm=15.791 | L2-Norm(final)=2.199 | acc=1.0000 | 4196.0 samples/s | 65.6 steps/s
[Step=2850 Epoch=11.0] | Loss=0.00454 | Reg=0.00249 | L2-Norm=15.779 | L2-Norm(final)=2.201 | acc=1.0000 | 4641.3 samples/s | 72.5 steps/s
[Step=2900 Epoch=11.2] | Loss=0.00418 | Reg=0.00249 | L2-Norm=15.764 | L2-Norm(final)=2.203 | acc=1.0000 | 4839.1 samples/s | 75.6 steps/s
[Step=2950 Epoch=11.4] | Loss=0.00395 | Reg=0.00248 | L2-Norm=15.747 | L2-Norm(final)=2.205 | acc=1.0000 | 1984.8 samples/s | 31.0 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00365 | Reg=0.00247 | L2-Norm=15.732 | L2-Norm(final)=2.206 | acc=1.0000 | 4625.8 samples/s | 72.3 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00339 | Reg=0.00247 | L2-Norm=15.716 | L2-Norm(final)=2.208 | acc=1.0000 | 4544.8 samples/s | 71.0 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00315 | Reg=0.00246 | L2-Norm=15.698 | L2-Norm(final)=2.210 | acc=1.0000 | 4777.9 samples/s | 74.7 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00294 | Reg=0.00246 | L2-Norm=15.678 | L2-Norm(final)=2.211 | acc=1.0000 | 4761.0 samples/s | 74.4 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00276 | Reg=0.00245 | L2-Norm=15.657 | L2-Norm(final)=2.213 | acc=1.0000 | 2228.4 samples/s | 34.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33236 | acc=0.7369 | tpr=0.6413 | fpr=0.0555 | 4531.3 samples/s | 17.7 steps/s
Avg test loss: 0.33296, Avg test acc: 0.73560, Avg tpr: 0.64003, Avg fpr: 0.05422, total FA: 423

Testing server on iccad2012
[Step=  50] | Loss=0.26262 | acc=0.8323 | tpr=0.9779 | fpr=0.1703 | 4545.0 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.26460 | acc=0.8351 | tpr=0.9872 | fpr=0.1678 | 8419.0 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.26776 | acc=0.8332 | tpr=0.9870 | fpr=0.1697 | 8587.9 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.26913 | acc=0.8326 | tpr=0.9902 | fpr=0.1703 | 8306.6 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.26792 | acc=0.8326 | tpr=0.9895 | fpr=0.1703 | 8473.6 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.26958 | acc=0.8324 | tpr=0.9876 | fpr=0.1705 | 8576.6 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.26992 | acc=0.8322 | tpr=0.9881 | fpr=0.1706 | 8460.7 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.27165 | acc=0.8316 | tpr=0.9874 | fpr=0.1713 | 8724.2 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.27388 | acc=0.8307 | tpr=0.9854 | fpr=0.1721 | 8452.5 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.27398 | acc=0.8304 | tpr=0.9850 | fpr=0.1724 | 8417.3 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.27331 | acc=0.8308 | tpr=0.9857 | fpr=0.1720 | 15293.2 samples/s | 59.7 steps/s
Avg test loss: 0.27301, Avg test acc: 0.83091, Avg tpr: 0.98574, Avg fpr: 0.17191, total FA: 23869

server round 7/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 4.7] | Loss=0.29775 | Reg=0.00235 | L2-Norm=15.335 | L2-Norm(final)=2.222 | acc=0.7969 | 4568.1 samples/s | 71.4 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.11072 | Reg=0.00239 | L2-Norm=15.471 | L2-Norm(final)=2.204 | acc=0.9531 | 4738.4 samples/s | 74.0 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.08918 | Reg=0.00242 | L2-Norm=15.540 | L2-Norm(final)=2.218 | acc=0.9219 | 4798.1 samples/s | 75.0 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.08214 | Reg=0.00243 | L2-Norm=15.579 | L2-Norm(final)=2.226 | acc=0.9531 | 4863.8 samples/s | 76.0 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.07611 | Reg=0.00244 | L2-Norm=15.612 | L2-Norm(final)=2.231 | acc=0.9688 | 4814.2 samples/s | 75.2 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.07175 | Reg=0.00245 | L2-Norm=15.639 | L2-Norm(final)=2.237 | acc=0.9219 | 4887.0 samples/s | 76.4 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.06906 | Reg=0.00245 | L2-Norm=15.663 | L2-Norm(final)=2.240 | acc=0.9844 | 4895.8 samples/s | 76.5 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.06739 | Reg=0.00246 | L2-Norm=15.687 | L2-Norm(final)=2.244 | acc=0.9219 | 4916.9 samples/s | 76.8 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.06710 | Reg=0.00247 | L2-Norm=15.707 | L2-Norm(final)=2.246 | acc=0.9375 | 4902.3 samples/s | 76.6 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.06505 | Reg=0.00247 | L2-Norm=15.728 | L2-Norm(final)=2.247 | acc=1.0000 | 4870.3 samples/s | 76.1 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.06367 | Reg=0.00248 | L2-Norm=15.750 | L2-Norm(final)=2.250 | acc=0.9844 | 6094.7 samples/s | 95.2 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.06184 | Reg=0.00249 | L2-Norm=15.771 | L2-Norm(final)=2.252 | acc=0.9531 | 2129.7 samples/s | 33.3 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.05960 | Reg=0.00249 | L2-Norm=15.793 | L2-Norm(final)=2.255 | acc=0.9844 | 4786.9 samples/s | 74.8 steps/s
[Step=3050 Epoch= 6.0] | Loss=0.05810 | Reg=0.00250 | L2-Norm=15.814 | L2-Norm(final)=2.259 | acc=0.9688 | 4882.9 samples/s | 76.3 steps/s
[Step=3100 Epoch= 6.1] | Loss=0.05714 | Reg=0.00251 | L2-Norm=15.835 | L2-Norm(final)=2.262 | acc=0.9844 | 4973.2 samples/s | 77.7 steps/s
[Step=3150 Epoch= 6.2] | Loss=0.05614 | Reg=0.00251 | L2-Norm=15.856 | L2-Norm(final)=2.265 | acc=0.9531 | 4862.5 samples/s | 76.0 steps/s
[Step=3200 Epoch= 6.3] | Loss=0.05566 | Reg=0.00252 | L2-Norm=15.876 | L2-Norm(final)=2.268 | acc=0.9531 | 4954.2 samples/s | 77.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step3200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=1601 Epoch= 6.1] | Loss=0.15680 | Reg=0.00235 | L2-Norm=15.335 | L2-Norm(final)=2.222 | acc=0.9219 | 4528.8 samples/s | 70.8 steps/s
[Step=1650 Epoch= 6.3] | Loss=0.01828 | Reg=0.00241 | L2-Norm=15.522 | L2-Norm(final)=2.222 | acc=1.0000 | 4322.6 samples/s | 67.5 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.01377 | Reg=0.00243 | L2-Norm=15.586 | L2-Norm(final)=2.213 | acc=1.0000 | 4596.6 samples/s | 71.8 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.01017 | Reg=0.00244 | L2-Norm=15.604 | L2-Norm(final)=2.209 | acc=1.0000 | 4659.2 samples/s | 72.8 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.00811 | Reg=0.00244 | L2-Norm=15.611 | L2-Norm(final)=2.210 | acc=1.0000 | 4771.0 samples/s | 74.5 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00684 | Reg=0.00244 | L2-Norm=15.610 | L2-Norm(final)=2.211 | acc=1.0000 | 5821.5 samples/s | 91.0 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00571 | Reg=0.00243 | L2-Norm=15.601 | L2-Norm(final)=2.212 | acc=1.0000 | 2021.1 samples/s | 31.6 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00490 | Reg=0.00243 | L2-Norm=15.586 | L2-Norm(final)=2.213 | acc=1.0000 | 4605.8 samples/s | 72.0 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00429 | Reg=0.00242 | L2-Norm=15.569 | L2-Norm(final)=2.214 | acc=1.0000 | 4639.0 samples/s | 72.5 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.00383 | Reg=0.00242 | L2-Norm=15.549 | L2-Norm(final)=2.215 | acc=1.0000 | 4832.8 samples/s | 75.5 steps/s
[Step=2100 Epoch= 8.0] | Loss=0.00346 | Reg=0.00241 | L2-Norm=15.528 | L2-Norm(final)=2.216 | acc=1.0000 | 5048.6 samples/s | 78.9 steps/s
[Step=2150 Epoch= 8.2] | Loss=0.00315 | Reg=0.00240 | L2-Norm=15.506 | L2-Norm(final)=2.217 | acc=1.0000 | 2151.0 samples/s | 33.6 steps/s
[Step=2200 Epoch= 8.4] | Loss=0.00289 | Reg=0.00240 | L2-Norm=15.483 | L2-Norm(final)=2.218 | acc=1.0000 | 4649.3 samples/s | 72.6 steps/s
[Step=2250 Epoch= 8.6] | Loss=0.00266 | Reg=0.00239 | L2-Norm=15.460 | L2-Norm(final)=2.219 | acc=1.0000 | 4638.5 samples/s | 72.5 steps/s
[Step=2300 Epoch= 8.8] | Loss=0.00248 | Reg=0.00238 | L2-Norm=15.435 | L2-Norm(final)=2.220 | acc=1.0000 | 4719.9 samples/s | 73.7 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.00231 | Reg=0.00238 | L2-Norm=15.410 | L2-Norm(final)=2.220 | acc=1.0000 | 4586.2 samples/s | 71.7 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.00217 | Reg=0.00237 | L2-Norm=15.385 | L2-Norm(final)=2.221 | acc=1.0000 | 2244.6 samples/s | 35.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46603 | acc=0.6703 | tpr=0.5300 | fpr=0.0250 | 4651.4 samples/s | 18.2 steps/s
Avg test loss: 0.46703, Avg test acc: 0.66696, Avg tpr: 0.52766, Avg fpr: 0.02666, total FA: 208

Testing server on iccad2012
[Step=  50] | Loss=0.19539 | acc=0.8827 | tpr=0.9779 | fpr=0.1191 | 4496.0 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.19645 | acc=0.8841 | tpr=0.9872 | fpr=0.1178 | 8566.3 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.19941 | acc=0.8824 | tpr=0.9856 | fpr=0.1195 | 8575.2 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.20069 | acc=0.8825 | tpr=0.9858 | fpr=0.1194 | 8890.7 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.19929 | acc=0.8826 | tpr=0.9852 | fpr=0.1193 | 8342.8 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.20063 | acc=0.8820 | tpr=0.9840 | fpr=0.1199 | 8203.6 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.20055 | acc=0.8818 | tpr=0.9843 | fpr=0.1201 | 8831.9 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.20219 | acc=0.8813 | tpr=0.9841 | fpr=0.1206 | 8547.6 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.20404 | acc=0.8806 | tpr=0.9805 | fpr=0.1212 | 8633.3 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.20410 | acc=0.8803 | tpr=0.9806 | fpr=0.1215 | 8357.7 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.20348 | acc=0.8806 | tpr=0.9817 | fpr=0.1213 | 15826.0 samples/s | 61.8 steps/s
Avg test loss: 0.20322, Avg test acc: 0.88069, Avg tpr: 0.98177, Avg fpr: 0.12115, total FA: 16821

server round 8/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch= 6.3] | Loss=0.36495 | Reg=0.00232 | L2-Norm=15.242 | L2-Norm(final)=2.257 | acc=0.7344 | 4532.1 samples/s | 70.8 steps/s
[Step=3250 Epoch= 6.4] | Loss=0.08978 | Reg=0.00236 | L2-Norm=15.354 | L2-Norm(final)=2.245 | acc=0.9688 | 4760.7 samples/s | 74.4 steps/s
[Step=3300 Epoch= 6.5] | Loss=0.07370 | Reg=0.00238 | L2-Norm=15.422 | L2-Norm(final)=2.261 | acc=0.9375 | 4860.0 samples/s | 75.9 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.06667 | Reg=0.00239 | L2-Norm=15.464 | L2-Norm(final)=2.270 | acc=0.9844 | 4900.8 samples/s | 76.6 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.06174 | Reg=0.00240 | L2-Norm=15.499 | L2-Norm(final)=2.276 | acc=0.9688 | 4999.8 samples/s | 78.1 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.05930 | Reg=0.00241 | L2-Norm=15.531 | L2-Norm(final)=2.281 | acc=0.9688 | 4878.7 samples/s | 76.2 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.05700 | Reg=0.00242 | L2-Norm=15.560 | L2-Norm(final)=2.284 | acc=0.8906 | 4931.1 samples/s | 77.0 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.05630 | Reg=0.00243 | L2-Norm=15.584 | L2-Norm(final)=2.286 | acc=0.9531 | 4906.3 samples/s | 76.7 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.05560 | Reg=0.00244 | L2-Norm=15.606 | L2-Norm(final)=2.286 | acc=0.9688 | 4996.0 samples/s | 78.1 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.05507 | Reg=0.00244 | L2-Norm=15.627 | L2-Norm(final)=2.285 | acc=0.9688 | 4826.1 samples/s | 75.4 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.05457 | Reg=0.00245 | L2-Norm=15.648 | L2-Norm(final)=2.284 | acc=0.9844 | 6042.9 samples/s | 94.4 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.05296 | Reg=0.00246 | L2-Norm=15.669 | L2-Norm(final)=2.284 | acc=0.9531 | 2143.9 samples/s | 33.5 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.05153 | Reg=0.00246 | L2-Norm=15.688 | L2-Norm(final)=2.284 | acc=0.9531 | 4956.5 samples/s | 77.4 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.05004 | Reg=0.00247 | L2-Norm=15.707 | L2-Norm(final)=2.285 | acc=1.0000 | 4887.1 samples/s | 76.4 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.04929 | Reg=0.00247 | L2-Norm=15.726 | L2-Norm(final)=2.286 | acc=0.9688 | 4972.7 samples/s | 77.7 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.04837 | Reg=0.00248 | L2-Norm=15.743 | L2-Norm(final)=2.287 | acc=0.9844 | 4918.7 samples/s | 76.9 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.04765 | Reg=0.00248 | L2-Norm=15.761 | L2-Norm(final)=2.288 | acc=0.9688 | 5022.3 samples/s | 78.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step4000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=2401 Epoch= 9.2] | Loss=0.02787 | Reg=0.00232 | L2-Norm=15.242 | L2-Norm(final)=2.260 | acc=0.9844 | 4917.2 samples/s | 76.8 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.00852 | Reg=0.00236 | L2-Norm=15.370 | L2-Norm(final)=2.264 | acc=1.0000 | 4023.9 samples/s | 62.9 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.00967 | Reg=0.00239 | L2-Norm=15.450 | L2-Norm(final)=2.258 | acc=0.9844 | 4652.7 samples/s | 72.7 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.00930 | Reg=0.00240 | L2-Norm=15.507 | L2-Norm(final)=2.246 | acc=1.0000 | 4727.9 samples/s | 73.9 steps/s
[Step=2600 Epoch=10.0] | Loss=0.00826 | Reg=0.00241 | L2-Norm=15.539 | L2-Norm(final)=2.237 | acc=1.0000 | 4590.3 samples/s | 71.7 steps/s
[Step=2650 Epoch=10.2] | Loss=0.00816 | Reg=0.00242 | L2-Norm=15.559 | L2-Norm(final)=2.232 | acc=1.0000 | 5977.0 samples/s | 93.4 steps/s
[Step=2700 Epoch=10.3] | Loss=0.00691 | Reg=0.00243 | L2-Norm=15.574 | L2-Norm(final)=2.232 | acc=1.0000 | 2046.8 samples/s | 32.0 steps/s
[Step=2750 Epoch=10.5] | Loss=0.00627 | Reg=0.00243 | L2-Norm=15.581 | L2-Norm(final)=2.233 | acc=1.0000 | 4582.9 samples/s | 71.6 steps/s
[Step=2800 Epoch=10.7] | Loss=0.00551 | Reg=0.00243 | L2-Norm=15.582 | L2-Norm(final)=2.233 | acc=1.0000 | 4614.7 samples/s | 72.1 steps/s
[Step=2850 Epoch=10.9] | Loss=0.00490 | Reg=0.00243 | L2-Norm=15.578 | L2-Norm(final)=2.234 | acc=1.0000 | 4666.2 samples/s | 72.9 steps/s
[Step=2900 Epoch=11.1] | Loss=0.00442 | Reg=0.00242 | L2-Norm=15.568 | L2-Norm(final)=2.235 | acc=1.0000 | 5218.9 samples/s | 81.5 steps/s
[Step=2950 Epoch=11.3] | Loss=0.00403 | Reg=0.00242 | L2-Norm=15.556 | L2-Norm(final)=2.236 | acc=1.0000 | 2142.8 samples/s | 33.5 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00369 | Reg=0.00242 | L2-Norm=15.540 | L2-Norm(final)=2.237 | acc=1.0000 | 4683.1 samples/s | 73.2 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00341 | Reg=0.00241 | L2-Norm=15.523 | L2-Norm(final)=2.239 | acc=1.0000 | 4589.7 samples/s | 71.7 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00317 | Reg=0.00240 | L2-Norm=15.504 | L2-Norm(final)=2.240 | acc=1.0000 | 4640.0 samples/s | 72.5 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00296 | Reg=0.00240 | L2-Norm=15.484 | L2-Norm(final)=2.241 | acc=1.0000 | 4649.2 samples/s | 72.6 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00278 | Reg=0.00239 | L2-Norm=15.462 | L2-Norm(final)=2.242 | acc=1.0000 | 2237.4 samples/s | 35.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45145 | acc=0.6948 | tpr=0.5670 | fpr=0.0275 | 4483.0 samples/s | 17.5 steps/s
Avg test loss: 0.45152, Avg test acc: 0.69336, Avg tpr: 0.56694, Avg fpr: 0.02859, total FA: 223

Testing server on iccad2012
[Step=  50] | Loss=0.22668 | acc=0.8752 | tpr=0.9735 | fpr=0.1265 | 4582.6 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.22892 | acc=0.8781 | tpr=0.9872 | fpr=0.1240 | 8606.2 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.23197 | acc=0.8753 | tpr=0.9870 | fpr=0.1267 | 8454.2 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.23348 | acc=0.8747 | tpr=0.9891 | fpr=0.1273 | 8794.2 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.23200 | acc=0.8749 | tpr=0.9869 | fpr=0.1271 | 8428.9 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.23378 | acc=0.8747 | tpr=0.9862 | fpr=0.1273 | 8779.7 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.23378 | acc=0.8746 | tpr=0.9869 | fpr=0.1274 | 8037.8 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.23571 | acc=0.8741 | tpr=0.9858 | fpr=0.1280 | 9077.6 samples/s | 35.5 steps/s
[Step= 450] | Loss=0.23800 | acc=0.8735 | tpr=0.9834 | fpr=0.1285 | 8186.5 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.23834 | acc=0.8731 | tpr=0.9833 | fpr=0.1289 | 8650.8 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.23749 | acc=0.8737 | tpr=0.9845 | fpr=0.1283 | 15333.1 samples/s | 59.9 steps/s
Avg test loss: 0.23717, Avg test acc: 0.87382, Avg tpr: 0.98455, Avg fpr: 0.12820, total FA: 17800

server round 9/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.19604 | Reg=0.00231 | L2-Norm=15.193 | L2-Norm(final)=2.267 | acc=0.8281 | 4793.2 samples/s | 74.9 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.08837 | Reg=0.00235 | L2-Norm=15.330 | L2-Norm(final)=2.246 | acc=0.9531 | 4503.5 samples/s | 70.4 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.07163 | Reg=0.00237 | L2-Norm=15.406 | L2-Norm(final)=2.260 | acc=0.9375 | 4875.8 samples/s | 76.2 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.06574 | Reg=0.00239 | L2-Norm=15.452 | L2-Norm(final)=2.267 | acc=0.9688 | 4800.5 samples/s | 75.0 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.06113 | Reg=0.00240 | L2-Norm=15.491 | L2-Norm(final)=2.274 | acc=0.9844 | 4828.3 samples/s | 75.4 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.05934 | Reg=0.00241 | L2-Norm=15.521 | L2-Norm(final)=2.278 | acc=1.0000 | 4868.5 samples/s | 76.1 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.05836 | Reg=0.00242 | L2-Norm=15.545 | L2-Norm(final)=2.279 | acc=0.9219 | 4897.4 samples/s | 76.5 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.05734 | Reg=0.00242 | L2-Norm=15.569 | L2-Norm(final)=2.279 | acc=0.9844 | 4862.8 samples/s | 76.0 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.05701 | Reg=0.00243 | L2-Norm=15.593 | L2-Norm(final)=2.280 | acc=0.9688 | 4814.3 samples/s | 75.2 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.05638 | Reg=0.00244 | L2-Norm=15.618 | L2-Norm(final)=2.279 | acc=0.9844 | 4844.7 samples/s | 75.7 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.05511 | Reg=0.00245 | L2-Norm=15.642 | L2-Norm(final)=2.279 | acc=0.9688 | 6000.3 samples/s | 93.8 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.05247 | Reg=0.00245 | L2-Norm=15.665 | L2-Norm(final)=2.281 | acc=0.9688 | 2143.6 samples/s | 33.5 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.05074 | Reg=0.00246 | L2-Norm=15.687 | L2-Norm(final)=2.284 | acc=0.9688 | 4884.0 samples/s | 76.3 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.05014 | Reg=0.00247 | L2-Norm=15.708 | L2-Norm(final)=2.286 | acc=0.9688 | 4923.2 samples/s | 76.9 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.04889 | Reg=0.00247 | L2-Norm=15.729 | L2-Norm(final)=2.288 | acc=0.9688 | 4888.5 samples/s | 76.4 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.04785 | Reg=0.00248 | L2-Norm=15.750 | L2-Norm(final)=2.290 | acc=0.9844 | 4898.5 samples/s | 76.5 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.04720 | Reg=0.00249 | L2-Norm=15.770 | L2-Norm(final)=2.291 | acc=0.9844 | 4985.0 samples/s | 77.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step4800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00100, len=1
[Step=3201 Epoch=12.3] | Loss=0.04435 | Reg=0.00231 | L2-Norm=15.193 | L2-Norm(final)=2.269 | acc=0.9844 | 4451.1 samples/s | 69.5 steps/s
[Step=3250 Epoch=12.5] | Loss=0.01124 | Reg=0.00234 | L2-Norm=15.309 | L2-Norm(final)=2.278 | acc=1.0000 | 4416.7 samples/s | 69.0 steps/s
[Step=3300 Epoch=12.6] | Loss=0.01036 | Reg=0.00237 | L2-Norm=15.390 | L2-Norm(final)=2.272 | acc=1.0000 | 4594.3 samples/s | 71.8 steps/s
[Step=3350 Epoch=12.8] | Loss=0.00890 | Reg=0.00239 | L2-Norm=15.446 | L2-Norm(final)=2.261 | acc=0.9844 | 4605.1 samples/s | 72.0 steps/s
[Step=3400 Epoch=13.0] | Loss=0.00715 | Reg=0.00240 | L2-Norm=15.475 | L2-Norm(final)=2.258 | acc=1.0000 | 4706.2 samples/s | 73.5 steps/s
[Step=3450 Epoch=13.2] | Loss=0.00581 | Reg=0.00240 | L2-Norm=15.489 | L2-Norm(final)=2.259 | acc=1.0000 | 5862.2 samples/s | 91.6 steps/s
[Step=3500 Epoch=13.4] | Loss=0.00496 | Reg=0.00240 | L2-Norm=15.490 | L2-Norm(final)=2.261 | acc=1.0000 | 2053.3 samples/s | 32.1 steps/s
[Step=3550 Epoch=13.6] | Loss=0.00434 | Reg=0.00240 | L2-Norm=15.483 | L2-Norm(final)=2.262 | acc=1.0000 | 4625.6 samples/s | 72.3 steps/s
[Step=3600 Epoch=13.8] | Loss=0.00400 | Reg=0.00239 | L2-Norm=15.473 | L2-Norm(final)=2.263 | acc=0.9844 | 4656.9 samples/s | 72.8 steps/s
[Step=3650 Epoch=14.0] | Loss=0.00357 | Reg=0.00239 | L2-Norm=15.459 | L2-Norm(final)=2.263 | acc=1.0000 | 4577.2 samples/s | 71.5 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00322 | Reg=0.00238 | L2-Norm=15.442 | L2-Norm(final)=2.264 | acc=1.0000 | 5090.0 samples/s | 79.5 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00293 | Reg=0.00238 | L2-Norm=15.422 | L2-Norm(final)=2.265 | acc=1.0000 | 2114.2 samples/s | 33.0 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00269 | Reg=0.00237 | L2-Norm=15.401 | L2-Norm(final)=2.266 | acc=1.0000 | 4672.1 samples/s | 73.0 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00248 | Reg=0.00236 | L2-Norm=15.377 | L2-Norm(final)=2.266 | acc=1.0000 | 4588.9 samples/s | 71.7 steps/s
[Step=3900 Epoch=14.9] | Loss=0.00231 | Reg=0.00236 | L2-Norm=15.353 | L2-Norm(final)=2.267 | acc=1.0000 | 4719.1 samples/s | 73.7 steps/s
[Step=3950 Epoch=15.1] | Loss=0.00215 | Reg=0.00235 | L2-Norm=15.328 | L2-Norm(final)=2.268 | acc=1.0000 | 4675.6 samples/s | 73.1 steps/s
[Step=4000 Epoch=15.3] | Loss=0.00202 | Reg=0.00234 | L2-Norm=15.302 | L2-Norm(final)=2.269 | acc=1.0000 | 2227.0 samples/s | 34.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46887 | acc=0.6676 | tpr=0.5241 | fpr=0.0208 | 4401.8 samples/s | 17.2 steps/s
Avg test loss: 0.47006, Avg test acc: 0.66592, Avg tpr: 0.52387, Avg fpr: 0.02166, total FA: 169

Testing server on iccad2012
[Step=  50] | Loss=0.18847 | acc=0.8935 | tpr=0.9602 | fpr=0.1077 | 4568.2 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.19105 | acc=0.8959 | tpr=0.9787 | fpr=0.1057 | 8544.4 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.19451 | acc=0.8932 | tpr=0.9769 | fpr=0.1084 | 8284.4 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.19577 | acc=0.8930 | tpr=0.9792 | fpr=0.1085 | 8609.5 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.19455 | acc=0.8931 | tpr=0.9799 | fpr=0.1085 | 9050.4 samples/s | 35.4 steps/s
[Step= 300] | Loss=0.19582 | acc=0.8923 | tpr=0.9789 | fpr=0.1093 | 8316.0 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.19594 | acc=0.8922 | tpr=0.9793 | fpr=0.1094 | 8453.0 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.19748 | acc=0.8918 | tpr=0.9776 | fpr=0.1098 | 8369.9 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.19966 | acc=0.8913 | tpr=0.9757 | fpr=0.1102 | 8524.0 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.19959 | acc=0.8909 | tpr=0.9758 | fpr=0.1106 | 8478.2 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.19891 | acc=0.8912 | tpr=0.9765 | fpr=0.1104 | 15137.1 samples/s | 59.1 steps/s
Avg test loss: 0.19869, Avg test acc: 0.89124, Avg tpr: 0.97662, Avg fpr: 0.11031, total FA: 15316

server round 10/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=4001 Epoch= 7.8] | Loss=0.42662 | Reg=0.00229 | L2-Norm=15.134 | L2-Norm(final)=2.273 | acc=0.6719 | 4602.2 samples/s | 71.9 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.08395 | Reg=0.00230 | L2-Norm=15.169 | L2-Norm(final)=2.267 | acc=0.9375 | 4581.8 samples/s | 71.6 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.06479 | Reg=0.00231 | L2-Norm=15.192 | L2-Norm(final)=2.274 | acc=1.0000 | 4850.2 samples/s | 75.8 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.05841 | Reg=0.00231 | L2-Norm=15.206 | L2-Norm(final)=2.281 | acc=0.9688 | 4899.2 samples/s | 76.5 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.05323 | Reg=0.00232 | L2-Norm=15.218 | L2-Norm(final)=2.287 | acc=0.9531 | 4902.1 samples/s | 76.6 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.05152 | Reg=0.00232 | L2-Norm=15.228 | L2-Norm(final)=2.291 | acc=0.9531 | 4802.2 samples/s | 75.0 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.04986 | Reg=0.00232 | L2-Norm=15.237 | L2-Norm(final)=2.293 | acc=0.9844 | 5018.7 samples/s | 78.4 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.04728 | Reg=0.00232 | L2-Norm=15.245 | L2-Norm(final)=2.296 | acc=0.9688 | 4965.3 samples/s | 77.6 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.04520 | Reg=0.00233 | L2-Norm=15.253 | L2-Norm(final)=2.299 | acc=0.9844 | 4986.8 samples/s | 77.9 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.04364 | Reg=0.00233 | L2-Norm=15.260 | L2-Norm(final)=2.302 | acc=0.9844 | 4865.5 samples/s | 76.0 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.04218 | Reg=0.00233 | L2-Norm=15.268 | L2-Norm(final)=2.305 | acc=0.9688 | 5976.5 samples/s | 93.4 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.04091 | Reg=0.00233 | L2-Norm=15.274 | L2-Norm(final)=2.308 | acc=0.9688 | 2055.5 samples/s | 32.1 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.03982 | Reg=0.00234 | L2-Norm=15.281 | L2-Norm(final)=2.312 | acc=1.0000 | 4878.3 samples/s | 76.2 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.03871 | Reg=0.00234 | L2-Norm=15.287 | L2-Norm(final)=2.315 | acc=0.9531 | 4919.5 samples/s | 76.9 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.03745 | Reg=0.00234 | L2-Norm=15.294 | L2-Norm(final)=2.319 | acc=0.9844 | 4871.7 samples/s | 76.1 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.03653 | Reg=0.00234 | L2-Norm=15.301 | L2-Norm(final)=2.323 | acc=0.9688 | 4957.2 samples/s | 77.5 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.03607 | Reg=0.00234 | L2-Norm=15.307 | L2-Norm(final)=2.327 | acc=0.9844 | 5008.5 samples/s | 78.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step4800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=3201 Epoch=12.3] | Loss=0.03042 | Reg=0.00229 | L2-Norm=15.134 | L2-Norm(final)=2.275 | acc=0.9688 | 4290.0 samples/s | 67.0 steps/s
[Step=3250 Epoch=12.5] | Loss=0.00734 | Reg=0.00230 | L2-Norm=15.182 | L2-Norm(final)=2.284 | acc=1.0000 | 4618.5 samples/s | 72.2 steps/s
[Step=3300 Epoch=12.7] | Loss=0.00550 | Reg=0.00231 | L2-Norm=15.201 | L2-Norm(final)=2.289 | acc=1.0000 | 4607.5 samples/s | 72.0 steps/s
[Step=3350 Epoch=12.9] | Loss=0.00414 | Reg=0.00231 | L2-Norm=15.207 | L2-Norm(final)=2.291 | acc=1.0000 | 4698.5 samples/s | 73.4 steps/s
[Step=3400 Epoch=13.1] | Loss=0.00330 | Reg=0.00231 | L2-Norm=15.208 | L2-Norm(final)=2.294 | acc=1.0000 | 4690.5 samples/s | 73.3 steps/s
[Step=3450 Epoch=13.3] | Loss=0.00270 | Reg=0.00231 | L2-Norm=15.205 | L2-Norm(final)=2.297 | acc=1.0000 | 6020.3 samples/s | 94.1 steps/s
[Step=3500 Epoch=13.5] | Loss=0.00226 | Reg=0.00231 | L2-Norm=15.199 | L2-Norm(final)=2.300 | acc=1.0000 | 2060.1 samples/s | 32.2 steps/s
[Step=3550 Epoch=13.7] | Loss=0.00194 | Reg=0.00231 | L2-Norm=15.190 | L2-Norm(final)=2.302 | acc=1.0000 | 4672.7 samples/s | 73.0 steps/s
[Step=3600 Epoch=13.9] | Loss=0.00170 | Reg=0.00230 | L2-Norm=15.180 | L2-Norm(final)=2.303 | acc=1.0000 | 4686.3 samples/s | 73.2 steps/s
[Step=3650 Epoch=14.1] | Loss=0.00152 | Reg=0.00230 | L2-Norm=15.168 | L2-Norm(final)=2.305 | acc=1.0000 | 4598.7 samples/s | 71.9 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00139 | Reg=0.00230 | L2-Norm=15.157 | L2-Norm(final)=2.306 | acc=1.0000 | 5346.1 samples/s | 83.5 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00128 | Reg=0.00229 | L2-Norm=15.144 | L2-Norm(final)=2.307 | acc=1.0000 | 2129.0 samples/s | 33.3 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00117 | Reg=0.00229 | L2-Norm=15.131 | L2-Norm(final)=2.308 | acc=1.0000 | 4641.0 samples/s | 72.5 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00108 | Reg=0.00229 | L2-Norm=15.118 | L2-Norm(final)=2.309 | acc=1.0000 | 4626.5 samples/s | 72.3 steps/s
[Step=3900 Epoch=15.0] | Loss=0.00101 | Reg=0.00228 | L2-Norm=15.105 | L2-Norm(final)=2.310 | acc=1.0000 | 4673.6 samples/s | 73.0 steps/s
[Step=3950 Epoch=15.2] | Loss=0.00094 | Reg=0.00228 | L2-Norm=15.091 | L2-Norm(final)=2.311 | acc=1.0000 | 4740.1 samples/s | 74.1 steps/s
[Step=4000 Epoch=15.4] | Loss=0.00089 | Reg=0.00227 | L2-Norm=15.077 | L2-Norm(final)=2.312 | acc=1.0000 | 2219.7 samples/s | 34.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46400 | acc=0.6857 | tpr=0.5484 | fpr=0.0161 | 4606.7 samples/s | 18.0 steps/s
Avg test loss: 0.46718, Avg test acc: 0.68215, Avg tpr: 0.54567, Avg fpr: 0.01769, total FA: 138

Testing server on iccad2012
[Step=  50] | Loss=0.20900 | acc=0.8956 | tpr=0.9558 | fpr=0.1055 | 4456.7 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.21177 | acc=0.8961 | tpr=0.9744 | fpr=0.1053 | 8174.6 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.21597 | acc=0.8952 | tpr=0.9741 | fpr=0.1062 | 8479.0 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.21749 | acc=0.8950 | tpr=0.9781 | fpr=0.1065 | 8418.6 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.21645 | acc=0.8951 | tpr=0.9782 | fpr=0.1064 | 8511.7 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.21812 | acc=0.8947 | tpr=0.9767 | fpr=0.1068 | 8677.5 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.21827 | acc=0.8947 | tpr=0.9775 | fpr=0.1068 | 8441.5 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.21987 | acc=0.8941 | tpr=0.9765 | fpr=0.1074 | 8533.7 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.22260 | acc=0.8933 | tpr=0.9737 | fpr=0.1081 | 8627.5 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.22212 | acc=0.8931 | tpr=0.9740 | fpr=0.1084 | 8200.9 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.22104 | acc=0.8935 | tpr=0.9749 | fpr=0.1080 | 15900.2 samples/s | 62.1 steps/s
Avg test loss: 0.22077, Avg test acc: 0.89352, Avg tpr: 0.97504, Avg fpr: 0.10796, total FA: 14990

server round 11/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=4801 Epoch= 9.4] | Loss=0.34787 | Reg=0.00226 | L2-Norm=15.028 | L2-Norm(final)=2.316 | acc=0.7812 | 4377.3 samples/s | 68.4 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.07613 | Reg=0.00228 | L2-Norm=15.084 | L2-Norm(final)=2.303 | acc=0.9688 | 4550.9 samples/s | 71.1 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.05974 | Reg=0.00228 | L2-Norm=15.116 | L2-Norm(final)=2.314 | acc=0.9844 | 4902.0 samples/s | 76.6 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.05339 | Reg=0.00229 | L2-Norm=15.134 | L2-Norm(final)=2.320 | acc=0.9688 | 4802.8 samples/s | 75.0 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.04845 | Reg=0.00229 | L2-Norm=15.149 | L2-Norm(final)=2.327 | acc=0.9688 | 4820.8 samples/s | 75.3 steps/s
[Step=5050 Epoch= 9.8] | Loss=0.04534 | Reg=0.00230 | L2-Norm=15.160 | L2-Norm(final)=2.332 | acc=0.9688 | 4827.8 samples/s | 75.4 steps/s
[Step=5100 Epoch= 9.9] | Loss=0.04281 | Reg=0.00230 | L2-Norm=15.170 | L2-Norm(final)=2.336 | acc=0.9688 | 4841.9 samples/s | 75.7 steps/s
[Step=5150 Epoch=10.0] | Loss=0.04179 | Reg=0.00230 | L2-Norm=15.179 | L2-Norm(final)=2.340 | acc=0.9844 | 4867.5 samples/s | 76.1 steps/s
[Step=5200 Epoch=10.1] | Loss=0.04063 | Reg=0.00231 | L2-Norm=15.187 | L2-Norm(final)=2.344 | acc=0.9688 | 4884.5 samples/s | 76.3 steps/s
[Step=5250 Epoch=10.2] | Loss=0.03937 | Reg=0.00231 | L2-Norm=15.194 | L2-Norm(final)=2.347 | acc=1.0000 | 4876.9 samples/s | 76.2 steps/s
[Step=5300 Epoch=10.3] | Loss=0.03855 | Reg=0.00231 | L2-Norm=15.202 | L2-Norm(final)=2.350 | acc=1.0000 | 5999.0 samples/s | 93.7 steps/s
[Step=5350 Epoch=10.4] | Loss=0.03731 | Reg=0.00231 | L2-Norm=15.208 | L2-Norm(final)=2.352 | acc=1.0000 | 2101.1 samples/s | 32.8 steps/s
[Step=5400 Epoch=10.5] | Loss=0.03599 | Reg=0.00232 | L2-Norm=15.215 | L2-Norm(final)=2.356 | acc=0.9844 | 4842.0 samples/s | 75.7 steps/s
[Step=5450 Epoch=10.6] | Loss=0.03480 | Reg=0.00232 | L2-Norm=15.222 | L2-Norm(final)=2.359 | acc=1.0000 | 5069.3 samples/s | 79.2 steps/s
[Step=5500 Epoch=10.7] | Loss=0.03405 | Reg=0.00232 | L2-Norm=15.229 | L2-Norm(final)=2.363 | acc=0.9688 | 4785.7 samples/s | 74.8 steps/s
[Step=5550 Epoch=10.8] | Loss=0.03338 | Reg=0.00232 | L2-Norm=15.236 | L2-Norm(final)=2.366 | acc=0.9688 | 4829.7 samples/s | 75.5 steps/s
[Step=5600 Epoch=10.9] | Loss=0.03306 | Reg=0.00232 | L2-Norm=15.243 | L2-Norm(final)=2.369 | acc=0.9844 | 4869.5 samples/s | 76.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step5600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=4001 Epoch=15.4] | Loss=0.01059 | Reg=0.00226 | L2-Norm=15.028 | L2-Norm(final)=2.318 | acc=1.0000 | 4242.3 samples/s | 66.3 steps/s
[Step=4050 Epoch=15.6] | Loss=0.00449 | Reg=0.00227 | L2-Norm=15.082 | L2-Norm(final)=2.336 | acc=1.0000 | 4514.2 samples/s | 70.5 steps/s
[Step=4100 Epoch=15.8] | Loss=0.00290 | Reg=0.00228 | L2-Norm=15.099 | L2-Norm(final)=2.343 | acc=1.0000 | 4681.6 samples/s | 73.2 steps/s
[Step=4150 Epoch=16.0] | Loss=0.00237 | Reg=0.00228 | L2-Norm=15.106 | L2-Norm(final)=2.349 | acc=1.0000 | 4682.7 samples/s | 73.2 steps/s
[Step=4200 Epoch=16.2] | Loss=0.00187 | Reg=0.00228 | L2-Norm=15.109 | L2-Norm(final)=2.355 | acc=1.0000 | 4753.3 samples/s | 74.3 steps/s
[Step=4250 Epoch=16.4] | Loss=0.00151 | Reg=0.00228 | L2-Norm=15.107 | L2-Norm(final)=2.359 | acc=1.0000 | 5923.6 samples/s | 92.6 steps/s
[Step=4300 Epoch=16.6] | Loss=0.00133 | Reg=0.00228 | L2-Norm=15.100 | L2-Norm(final)=2.362 | acc=1.0000 | 2055.6 samples/s | 32.1 steps/s
[Step=4350 Epoch=16.7] | Loss=0.00115 | Reg=0.00228 | L2-Norm=15.092 | L2-Norm(final)=2.365 | acc=1.0000 | 4513.6 samples/s | 70.5 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00101 | Reg=0.00227 | L2-Norm=15.081 | L2-Norm(final)=2.367 | acc=1.0000 | 4591.1 samples/s | 71.7 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00090 | Reg=0.00227 | L2-Norm=15.069 | L2-Norm(final)=2.369 | acc=1.0000 | 4616.6 samples/s | 72.1 steps/s
[Step=4500 Epoch=17.3] | Loss=0.00082 | Reg=0.00227 | L2-Norm=15.056 | L2-Norm(final)=2.371 | acc=1.0000 | 5235.3 samples/s | 81.8 steps/s
[Step=4550 Epoch=17.5] | Loss=0.00075 | Reg=0.00226 | L2-Norm=15.042 | L2-Norm(final)=2.373 | acc=1.0000 | 2162.6 samples/s | 33.8 steps/s
[Step=4600 Epoch=17.7] | Loss=0.00069 | Reg=0.00226 | L2-Norm=15.027 | L2-Norm(final)=2.374 | acc=1.0000 | 4688.8 samples/s | 73.3 steps/s
[Step=4650 Epoch=17.9] | Loss=0.00063 | Reg=0.00225 | L2-Norm=15.012 | L2-Norm(final)=2.376 | acc=1.0000 | 4520.9 samples/s | 70.6 steps/s
[Step=4700 Epoch=18.1] | Loss=0.00059 | Reg=0.00225 | L2-Norm=14.996 | L2-Norm(final)=2.377 | acc=1.0000 | 4641.9 samples/s | 72.5 steps/s
[Step=4750 Epoch=18.3] | Loss=0.00055 | Reg=0.00224 | L2-Norm=14.980 | L2-Norm(final)=2.378 | acc=1.0000 | 4783.3 samples/s | 74.7 steps/s
[Step=4800 Epoch=18.5] | Loss=0.00052 | Reg=0.00224 | L2-Norm=14.963 | L2-Norm(final)=2.379 | acc=1.0000 | 2232.9 samples/s | 34.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39160 | acc=0.7309 | tpr=0.6157 | fpr=0.0188 | 4515.4 samples/s | 17.6 steps/s
Avg test loss: 0.39334, Avg test acc: 0.73011, Avg tpr: 0.61625, Avg fpr: 0.01948, total FA: 152

Testing server on iccad2012
[Step=  50] | Loss=0.24503 | acc=0.8793 | tpr=0.9646 | fpr=0.1222 | 4579.7 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.24796 | acc=0.8793 | tpr=0.9787 | fpr=0.1225 | 8602.0 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.25265 | acc=0.8784 | tpr=0.9769 | fpr=0.1234 | 8419.4 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.25379 | acc=0.8785 | tpr=0.9803 | fpr=0.1234 | 8551.7 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.25288 | acc=0.8784 | tpr=0.9808 | fpr=0.1234 | 8816.4 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.25456 | acc=0.8780 | tpr=0.9796 | fpr=0.1238 | 8538.1 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.25466 | acc=0.8779 | tpr=0.9800 | fpr=0.1239 | 8613.9 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.25607 | acc=0.8772 | tpr=0.9781 | fpr=0.1246 | 8354.4 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.25913 | acc=0.8765 | tpr=0.9766 | fpr=0.1253 | 8409.3 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.25886 | acc=0.8762 | tpr=0.9767 | fpr=0.1257 | 8554.8 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.25759 | acc=0.8765 | tpr=0.9777 | fpr=0.1254 | 15635.5 samples/s | 61.1 steps/s
Avg test loss: 0.25734, Avg test acc: 0.87654, Avg tpr: 0.97781, Avg fpr: 0.12530, total FA: 17398

server round 12/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=4801 Epoch= 9.4] | Loss=0.24858 | Reg=0.00225 | L2-Norm=14.984 | L2-Norm(final)=2.344 | acc=0.7969 | 4292.8 samples/s | 67.1 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.05812 | Reg=0.00226 | L2-Norm=15.045 | L2-Norm(final)=2.336 | acc=1.0000 | 4858.5 samples/s | 75.9 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.04773 | Reg=0.00227 | L2-Norm=15.074 | L2-Norm(final)=2.343 | acc=1.0000 | 4995.2 samples/s | 78.0 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.04412 | Reg=0.00228 | L2-Norm=15.092 | L2-Norm(final)=2.350 | acc=0.9375 | 4871.4 samples/s | 76.1 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.04193 | Reg=0.00228 | L2-Norm=15.106 | L2-Norm(final)=2.354 | acc=1.0000 | 4844.2 samples/s | 75.7 steps/s
[Step=5050 Epoch= 9.9] | Loss=0.04080 | Reg=0.00229 | L2-Norm=15.120 | L2-Norm(final)=2.359 | acc=0.9531 | 4896.7 samples/s | 76.5 steps/s
[Step=5100 Epoch=10.0] | Loss=0.03888 | Reg=0.00229 | L2-Norm=15.132 | L2-Norm(final)=2.363 | acc=0.9531 | 4954.4 samples/s | 77.4 steps/s
[Step=5150 Epoch=10.1] | Loss=0.03806 | Reg=0.00229 | L2-Norm=15.144 | L2-Norm(final)=2.367 | acc=0.9688 | 4943.4 samples/s | 77.2 steps/s
[Step=5200 Epoch=10.2] | Loss=0.03701 | Reg=0.00230 | L2-Norm=15.155 | L2-Norm(final)=2.371 | acc=0.9844 | 5021.1 samples/s | 78.5 steps/s
[Step=5250 Epoch=10.3] | Loss=0.03584 | Reg=0.00230 | L2-Norm=15.165 | L2-Norm(final)=2.374 | acc=1.0000 | 4918.3 samples/s | 76.8 steps/s
[Step=5300 Epoch=10.4] | Loss=0.03476 | Reg=0.00230 | L2-Norm=15.174 | L2-Norm(final)=2.377 | acc=0.9531 | 6105.9 samples/s | 95.4 steps/s
[Step=5350 Epoch=10.5] | Loss=0.03355 | Reg=0.00230 | L2-Norm=15.182 | L2-Norm(final)=2.381 | acc=0.9844 | 2106.4 samples/s | 32.9 steps/s
[Step=5400 Epoch=10.6] | Loss=0.03220 | Reg=0.00231 | L2-Norm=15.190 | L2-Norm(final)=2.385 | acc=0.9688 | 4922.6 samples/s | 76.9 steps/s
[Step=5450 Epoch=10.7] | Loss=0.03176 | Reg=0.00231 | L2-Norm=15.198 | L2-Norm(final)=2.389 | acc=1.0000 | 4949.6 samples/s | 77.3 steps/s
[Step=5500 Epoch=10.8] | Loss=0.03070 | Reg=0.00231 | L2-Norm=15.206 | L2-Norm(final)=2.393 | acc=0.9688 | 4877.5 samples/s | 76.2 steps/s
[Step=5550 Epoch=10.9] | Loss=0.03037 | Reg=0.00231 | L2-Norm=15.214 | L2-Norm(final)=2.396 | acc=1.0000 | 4817.0 samples/s | 75.3 steps/s
[Step=5600 Epoch=10.9] | Loss=0.03015 | Reg=0.00232 | L2-Norm=15.222 | L2-Norm(final)=2.400 | acc=0.9844 | 4848.3 samples/s | 75.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step5600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=4001 Epoch=15.3] | Loss=0.04171 | Reg=0.00225 | L2-Norm=14.984 | L2-Norm(final)=2.344 | acc=0.9531 | 4452.7 samples/s | 69.6 steps/s
[Step=4050 Epoch=15.5] | Loss=0.00380 | Reg=0.00226 | L2-Norm=15.050 | L2-Norm(final)=2.352 | acc=1.0000 | 4514.4 samples/s | 70.5 steps/s
[Step=4100 Epoch=15.7] | Loss=0.00306 | Reg=0.00227 | L2-Norm=15.065 | L2-Norm(final)=2.356 | acc=1.0000 | 4624.6 samples/s | 72.3 steps/s
[Step=4150 Epoch=15.9] | Loss=0.00240 | Reg=0.00227 | L2-Norm=15.065 | L2-Norm(final)=2.358 | acc=1.0000 | 4642.0 samples/s | 72.5 steps/s
[Step=4200 Epoch=16.1] | Loss=0.00185 | Reg=0.00227 | L2-Norm=15.060 | L2-Norm(final)=2.360 | acc=1.0000 | 4601.3 samples/s | 71.9 steps/s
[Step=4250 Epoch=16.3] | Loss=0.00151 | Reg=0.00227 | L2-Norm=15.052 | L2-Norm(final)=2.363 | acc=1.0000 | 5865.4 samples/s | 91.6 steps/s
[Step=4300 Epoch=16.5] | Loss=0.00126 | Reg=0.00226 | L2-Norm=15.041 | L2-Norm(final)=2.365 | acc=1.0000 | 2015.1 samples/s | 31.5 steps/s
[Step=4350 Epoch=16.7] | Loss=0.00108 | Reg=0.00226 | L2-Norm=15.028 | L2-Norm(final)=2.366 | acc=1.0000 | 4643.6 samples/s | 72.6 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00095 | Reg=0.00225 | L2-Norm=15.014 | L2-Norm(final)=2.368 | acc=1.0000 | 4612.6 samples/s | 72.1 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00085 | Reg=0.00225 | L2-Norm=15.000 | L2-Norm(final)=2.369 | acc=1.0000 | 4668.0 samples/s | 72.9 steps/s
[Step=4500 Epoch=17.2] | Loss=0.00076 | Reg=0.00225 | L2-Norm=14.984 | L2-Norm(final)=2.370 | acc=1.0000 | 5130.9 samples/s | 80.2 steps/s
[Step=4550 Epoch=17.4] | Loss=0.00070 | Reg=0.00224 | L2-Norm=14.968 | L2-Norm(final)=2.371 | acc=1.0000 | 2153.1 samples/s | 33.6 steps/s
[Step=4600 Epoch=17.6] | Loss=0.00064 | Reg=0.00224 | L2-Norm=14.952 | L2-Norm(final)=2.372 | acc=1.0000 | 4602.5 samples/s | 71.9 steps/s
[Step=4650 Epoch=17.8] | Loss=0.00059 | Reg=0.00223 | L2-Norm=14.936 | L2-Norm(final)=2.373 | acc=1.0000 | 4638.7 samples/s | 72.5 steps/s
[Step=4700 Epoch=18.0] | Loss=0.00055 | Reg=0.00223 | L2-Norm=14.919 | L2-Norm(final)=2.373 | acc=1.0000 | 4639.0 samples/s | 72.5 steps/s
[Step=4750 Epoch=18.2] | Loss=0.00051 | Reg=0.00222 | L2-Norm=14.902 | L2-Norm(final)=2.374 | acc=1.0000 | 4706.5 samples/s | 73.5 steps/s
[Step=4800 Epoch=18.4] | Loss=0.00048 | Reg=0.00222 | L2-Norm=14.885 | L2-Norm(final)=2.375 | acc=1.0000 | 2163.4 samples/s | 33.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32651 | acc=0.7852 | tpr=0.6941 | fpr=0.0171 | 4589.4 samples/s | 17.9 steps/s
Avg test loss: 0.32730, Avg test acc: 0.78356, Avg tpr: 0.69336, Avg fpr: 0.01807, total FA: 141

Testing server on iccad2012
[Step=  50] | Loss=0.35056 | acc=0.8398 | tpr=0.9646 | fpr=0.1624 | 4488.6 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.35353 | acc=0.8419 | tpr=0.9787 | fpr=0.1607 | 8477.0 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.35861 | acc=0.8414 | tpr=0.9755 | fpr=0.1611 | 9160.3 samples/s | 35.8 steps/s
[Step= 200] | Loss=0.36011 | acc=0.8413 | tpr=0.9781 | fpr=0.1612 | 7985.0 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.35898 | acc=0.8412 | tpr=0.9782 | fpr=0.1613 | 8506.2 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.36148 | acc=0.8408 | tpr=0.9775 | fpr=0.1617 | 8759.5 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.36098 | acc=0.8412 | tpr=0.9787 | fpr=0.1613 | 8553.9 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.36257 | acc=0.8407 | tpr=0.9781 | fpr=0.1618 | 8402.5 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.36595 | acc=0.8402 | tpr=0.9781 | fpr=0.1623 | 8564.3 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.36626 | acc=0.8398 | tpr=0.9784 | fpr=0.1627 | 8179.5 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.36483 | acc=0.8404 | tpr=0.9793 | fpr=0.1621 | 16196.8 samples/s | 63.3 steps/s
Avg test loss: 0.36449, Avg test acc: 0.84044, Avg tpr: 0.97940, Avg fpr: 0.16208, total FA: 22505

server round 13/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=5601 Epoch=10.9] | Loss=0.28679 | Reg=0.00221 | L2-Norm=14.856 | L2-Norm(final)=2.408 | acc=0.8125 | 4436.0 samples/s | 69.3 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05048 | Reg=0.00222 | L2-Norm=14.906 | L2-Norm(final)=2.390 | acc=0.9688 | 4804.4 samples/s | 75.1 steps/s
[Step=5700 Epoch=11.1] | Loss=0.04244 | Reg=0.00223 | L2-Norm=14.932 | L2-Norm(final)=2.396 | acc=0.9688 | 4885.1 samples/s | 76.3 steps/s
[Step=5750 Epoch=11.2] | Loss=0.03922 | Reg=0.00223 | L2-Norm=14.950 | L2-Norm(final)=2.402 | acc=0.9844 | 4922.0 samples/s | 76.9 steps/s
[Step=5800 Epoch=11.3] | Loss=0.03620 | Reg=0.00224 | L2-Norm=14.965 | L2-Norm(final)=2.408 | acc=1.0000 | 4882.1 samples/s | 76.3 steps/s
[Step=5850 Epoch=11.4] | Loss=0.03375 | Reg=0.00224 | L2-Norm=14.978 | L2-Norm(final)=2.414 | acc=0.9688 | 4900.4 samples/s | 76.6 steps/s
[Step=5900 Epoch=11.5] | Loss=0.03299 | Reg=0.00225 | L2-Norm=14.989 | L2-Norm(final)=2.418 | acc=0.9844 | 4905.4 samples/s | 76.6 steps/s
[Step=5950 Epoch=11.6] | Loss=0.03186 | Reg=0.00225 | L2-Norm=15.000 | L2-Norm(final)=2.421 | acc=1.0000 | 4955.5 samples/s | 77.4 steps/s
[Step=6000 Epoch=11.7] | Loss=0.03115 | Reg=0.00225 | L2-Norm=15.010 | L2-Norm(final)=2.425 | acc=0.9844 | 4793.9 samples/s | 74.9 steps/s
[Step=6050 Epoch=11.8] | Loss=0.03070 | Reg=0.00226 | L2-Norm=15.020 | L2-Norm(final)=2.428 | acc=0.9844 | 4916.4 samples/s | 76.8 steps/s
[Step=6100 Epoch=11.9] | Loss=0.03096 | Reg=0.00226 | L2-Norm=15.029 | L2-Norm(final)=2.430 | acc=0.9844 | 6052.1 samples/s | 94.6 steps/s
[Step=6150 Epoch=12.0] | Loss=0.03033 | Reg=0.00226 | L2-Norm=15.038 | L2-Norm(final)=2.432 | acc=0.9844 | 2126.6 samples/s | 33.2 steps/s
[Step=6200 Epoch=12.1] | Loss=0.02940 | Reg=0.00226 | L2-Norm=15.047 | L2-Norm(final)=2.434 | acc=0.9688 | 4876.5 samples/s | 76.2 steps/s
[Step=6250 Epoch=12.2] | Loss=0.02867 | Reg=0.00227 | L2-Norm=15.056 | L2-Norm(final)=2.437 | acc=0.9844 | 4906.0 samples/s | 76.7 steps/s
[Step=6300 Epoch=12.3] | Loss=0.02792 | Reg=0.00227 | L2-Norm=15.064 | L2-Norm(final)=2.441 | acc=0.9844 | 4863.9 samples/s | 76.0 steps/s
[Step=6350 Epoch=12.4] | Loss=0.02751 | Reg=0.00227 | L2-Norm=15.073 | L2-Norm(final)=2.444 | acc=1.0000 | 4854.9 samples/s | 75.9 steps/s
[Step=6400 Epoch=12.5] | Loss=0.02703 | Reg=0.00227 | L2-Norm=15.081 | L2-Norm(final)=2.447 | acc=0.9844 | 4854.6 samples/s | 75.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step6400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=4801 Epoch=18.5] | Loss=0.17825 | Reg=0.00221 | L2-Norm=14.856 | L2-Norm(final)=2.409 | acc=0.9062 | 4317.9 samples/s | 67.5 steps/s
[Step=4850 Epoch=18.7] | Loss=0.02347 | Reg=0.00225 | L2-Norm=14.986 | L2-Norm(final)=2.367 | acc=0.9688 | 4546.6 samples/s | 71.0 steps/s
[Step=4900 Epoch=18.9] | Loss=0.01451 | Reg=0.00226 | L2-Norm=15.037 | L2-Norm(final)=2.354 | acc=1.0000 | 4631.0 samples/s | 72.4 steps/s
[Step=4950 Epoch=19.1] | Loss=0.00995 | Reg=0.00227 | L2-Norm=15.055 | L2-Norm(final)=2.354 | acc=1.0000 | 4699.2 samples/s | 73.4 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00797 | Reg=0.00227 | L2-Norm=15.062 | L2-Norm(final)=2.357 | acc=1.0000 | 4623.8 samples/s | 72.2 steps/s
[Step=5050 Epoch=19.4] | Loss=0.00640 | Reg=0.00227 | L2-Norm=15.064 | L2-Norm(final)=2.361 | acc=1.0000 | 5954.4 samples/s | 93.0 steps/s
[Step=5100 Epoch=19.6] | Loss=0.00537 | Reg=0.00227 | L2-Norm=15.060 | L2-Norm(final)=2.364 | acc=1.0000 | 2025.7 samples/s | 31.7 steps/s
[Step=5150 Epoch=19.8] | Loss=0.00462 | Reg=0.00227 | L2-Norm=15.053 | L2-Norm(final)=2.367 | acc=1.0000 | 4574.2 samples/s | 71.5 steps/s
[Step=5200 Epoch=20.0] | Loss=0.00405 | Reg=0.00226 | L2-Norm=15.044 | L2-Norm(final)=2.369 | acc=1.0000 | 4691.2 samples/s | 73.3 steps/s
[Step=5250 Epoch=20.2] | Loss=0.00360 | Reg=0.00226 | L2-Norm=15.034 | L2-Norm(final)=2.371 | acc=1.0000 | 4526.8 samples/s | 70.7 steps/s
[Step=5300 Epoch=20.4] | Loss=0.00325 | Reg=0.00226 | L2-Norm=15.022 | L2-Norm(final)=2.373 | acc=1.0000 | 5322.4 samples/s | 83.2 steps/s
[Step=5350 Epoch=20.6] | Loss=0.00296 | Reg=0.00225 | L2-Norm=15.009 | L2-Norm(final)=2.375 | acc=1.0000 | 2134.2 samples/s | 33.3 steps/s
[Step=5400 Epoch=20.8] | Loss=0.00271 | Reg=0.00225 | L2-Norm=14.996 | L2-Norm(final)=2.377 | acc=1.0000 | 4639.1 samples/s | 72.5 steps/s
[Step=5450 Epoch=21.0] | Loss=0.00250 | Reg=0.00224 | L2-Norm=14.982 | L2-Norm(final)=2.378 | acc=1.0000 | 4598.2 samples/s | 71.8 steps/s
[Step=5500 Epoch=21.2] | Loss=0.00233 | Reg=0.00224 | L2-Norm=14.968 | L2-Norm(final)=2.379 | acc=1.0000 | 4617.6 samples/s | 72.1 steps/s
[Step=5550 Epoch=21.4] | Loss=0.00217 | Reg=0.00224 | L2-Norm=14.953 | L2-Norm(final)=2.380 | acc=1.0000 | 4681.5 samples/s | 73.1 steps/s
[Step=5600 Epoch=21.6] | Loss=0.00204 | Reg=0.00223 | L2-Norm=14.938 | L2-Norm(final)=2.382 | acc=1.0000 | 2220.3 samples/s | 34.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45660 | acc=0.7037 | tpr=0.5728 | fpr=0.0119 | 4512.9 samples/s | 17.6 steps/s
Avg test loss: 0.45925, Avg test acc: 0.70190, Avg tpr: 0.57265, Avg fpr: 0.01384, total FA: 108

Testing server on iccad2012
[Step=  50] | Loss=0.24582 | acc=0.8903 | tpr=0.9690 | fpr=0.1111 | 4496.9 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.24989 | acc=0.8910 | tpr=0.9787 | fpr=0.1106 | 8578.1 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.25592 | acc=0.8898 | tpr=0.9769 | fpr=0.1118 | 8636.7 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.25760 | acc=0.8894 | tpr=0.9792 | fpr=0.1122 | 8425.7 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.25588 | acc=0.8894 | tpr=0.9817 | fpr=0.1123 | 8644.3 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.25801 | acc=0.8890 | tpr=0.9811 | fpr=0.1127 | 8501.2 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.25800 | acc=0.8890 | tpr=0.9812 | fpr=0.1127 | 8217.9 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.25960 | acc=0.8885 | tpr=0.9803 | fpr=0.1131 | 8847.2 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.26261 | acc=0.8879 | tpr=0.9786 | fpr=0.1137 | 8500.1 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.26237 | acc=0.8876 | tpr=0.9784 | fpr=0.1140 | 8263.7 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.26106 | acc=0.8879 | tpr=0.9801 | fpr=0.1137 | 15970.7 samples/s | 62.4 steps/s
Avg test loss: 0.26074, Avg test acc: 0.88800, Avg tpr: 0.98019, Avg fpr: 0.11368, total FA: 15784

server round 14/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=5601 Epoch=10.9] | Loss=0.46393 | Reg=0.00219 | L2-Norm=14.795 | L2-Norm(final)=2.418 | acc=0.6719 | 4468.8 samples/s | 69.8 steps/s
[Step=5650 Epoch=11.0] | Loss=0.06171 | Reg=0.00220 | L2-Norm=14.848 | L2-Norm(final)=2.400 | acc=0.9844 | 4562.0 samples/s | 71.3 steps/s
[Step=5700 Epoch=11.1] | Loss=0.04435 | Reg=0.00221 | L2-Norm=14.877 | L2-Norm(final)=2.408 | acc=0.9531 | 4865.9 samples/s | 76.0 steps/s
[Step=5750 Epoch=11.2] | Loss=0.04043 | Reg=0.00222 | L2-Norm=14.895 | L2-Norm(final)=2.414 | acc=1.0000 | 4864.4 samples/s | 76.0 steps/s
[Step=5800 Epoch=11.3] | Loss=0.03553 | Reg=0.00222 | L2-Norm=14.909 | L2-Norm(final)=2.420 | acc=1.0000 | 4944.6 samples/s | 77.3 steps/s
[Step=5850 Epoch=11.4] | Loss=0.03558 | Reg=0.00223 | L2-Norm=14.921 | L2-Norm(final)=2.425 | acc=1.0000 | 4893.3 samples/s | 76.5 steps/s
[Step=5900 Epoch=11.5] | Loss=0.03481 | Reg=0.00223 | L2-Norm=14.929 | L2-Norm(final)=2.426 | acc=1.0000 | 4950.0 samples/s | 77.3 steps/s
[Step=5950 Epoch=11.6] | Loss=0.03387 | Reg=0.00223 | L2-Norm=14.937 | L2-Norm(final)=2.428 | acc=0.9844 | 4831.3 samples/s | 75.5 steps/s
[Step=6000 Epoch=11.7] | Loss=0.03290 | Reg=0.00223 | L2-Norm=14.945 | L2-Norm(final)=2.430 | acc=0.9375 | 4870.0 samples/s | 76.1 steps/s
[Step=6050 Epoch=11.8] | Loss=0.03221 | Reg=0.00224 | L2-Norm=14.954 | L2-Norm(final)=2.432 | acc=0.9688 | 4958.5 samples/s | 77.5 steps/s
[Step=6100 Epoch=11.9] | Loss=0.03249 | Reg=0.00224 | L2-Norm=14.963 | L2-Norm(final)=2.435 | acc=0.9844 | 6005.2 samples/s | 93.8 steps/s
[Step=6150 Epoch=12.0] | Loss=0.03114 | Reg=0.00224 | L2-Norm=14.970 | L2-Norm(final)=2.436 | acc=1.0000 | 2073.0 samples/s | 32.4 steps/s
[Step=6200 Epoch=12.1] | Loss=0.02975 | Reg=0.00224 | L2-Norm=14.978 | L2-Norm(final)=2.439 | acc=1.0000 | 4861.9 samples/s | 76.0 steps/s
[Step=6250 Epoch=12.2] | Loss=0.02905 | Reg=0.00225 | L2-Norm=14.985 | L2-Norm(final)=2.442 | acc=1.0000 | 4848.8 samples/s | 75.8 steps/s
[Step=6300 Epoch=12.3] | Loss=0.02869 | Reg=0.00225 | L2-Norm=14.992 | L2-Norm(final)=2.445 | acc=0.9688 | 4994.7 samples/s | 78.0 steps/s
[Step=6350 Epoch=12.4] | Loss=0.02825 | Reg=0.00225 | L2-Norm=14.999 | L2-Norm(final)=2.447 | acc=0.9531 | 4883.4 samples/s | 76.3 steps/s
[Step=6400 Epoch=12.5] | Loss=0.02799 | Reg=0.00225 | L2-Norm=15.006 | L2-Norm(final)=2.450 | acc=1.0000 | 4836.2 samples/s | 75.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step6400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=4801 Epoch=18.4] | Loss=0.00672 | Reg=0.00219 | L2-Norm=14.795 | L2-Norm(final)=2.420 | acc=1.0000 | 4343.8 samples/s | 67.9 steps/s
[Step=4850 Epoch=18.6] | Loss=0.00611 | Reg=0.00221 | L2-Norm=14.860 | L2-Norm(final)=2.426 | acc=1.0000 | 4505.0 samples/s | 70.4 steps/s
[Step=4900 Epoch=18.8] | Loss=0.00439 | Reg=0.00222 | L2-Norm=14.883 | L2-Norm(final)=2.425 | acc=1.0000 | 4652.2 samples/s | 72.7 steps/s
[Step=4950 Epoch=19.0] | Loss=0.00335 | Reg=0.00222 | L2-Norm=14.895 | L2-Norm(final)=2.426 | acc=1.0000 | 4656.1 samples/s | 72.8 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00285 | Reg=0.00222 | L2-Norm=14.895 | L2-Norm(final)=2.427 | acc=1.0000 | 4573.3 samples/s | 71.5 steps/s
[Step=5050 Epoch=19.3] | Loss=0.00235 | Reg=0.00222 | L2-Norm=14.889 | L2-Norm(final)=2.427 | acc=1.0000 | 5793.8 samples/s | 90.5 steps/s
[Step=5100 Epoch=19.5] | Loss=0.00203 | Reg=0.00221 | L2-Norm=14.880 | L2-Norm(final)=2.427 | acc=1.0000 | 2057.9 samples/s | 32.2 steps/s
[Step=5150 Epoch=19.7] | Loss=0.00174 | Reg=0.00221 | L2-Norm=14.870 | L2-Norm(final)=2.428 | acc=1.0000 | 4610.4 samples/s | 72.0 steps/s
[Step=5200 Epoch=19.9] | Loss=0.00153 | Reg=0.00221 | L2-Norm=14.857 | L2-Norm(final)=2.429 | acc=1.0000 | 4609.2 samples/s | 72.0 steps/s
[Step=5250 Epoch=20.1] | Loss=0.00137 | Reg=0.00220 | L2-Norm=14.844 | L2-Norm(final)=2.429 | acc=1.0000 | 4610.0 samples/s | 72.0 steps/s
[Step=5300 Epoch=20.3] | Loss=0.00124 | Reg=0.00220 | L2-Norm=14.829 | L2-Norm(final)=2.430 | acc=1.0000 | 5127.4 samples/s | 80.1 steps/s
[Step=5350 Epoch=20.5] | Loss=0.00113 | Reg=0.00219 | L2-Norm=14.814 | L2-Norm(final)=2.431 | acc=1.0000 | 2144.6 samples/s | 33.5 steps/s
[Step=5400 Epoch=20.7] | Loss=0.00103 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.432 | acc=1.0000 | 4703.4 samples/s | 73.5 steps/s
[Step=5450 Epoch=20.9] | Loss=0.00096 | Reg=0.00219 | L2-Norm=14.782 | L2-Norm(final)=2.433 | acc=1.0000 | 4650.3 samples/s | 72.7 steps/s
[Step=5500 Epoch=21.1] | Loss=0.00089 | Reg=0.00218 | L2-Norm=14.765 | L2-Norm(final)=2.433 | acc=1.0000 | 4590.3 samples/s | 71.7 steps/s
[Step=5550 Epoch=21.3] | Loss=0.00083 | Reg=0.00218 | L2-Norm=14.748 | L2-Norm(final)=2.434 | acc=1.0000 | 4618.8 samples/s | 72.2 steps/s
[Step=5600 Epoch=21.5] | Loss=0.00078 | Reg=0.00217 | L2-Norm=14.731 | L2-Norm(final)=2.434 | acc=1.0000 | 2230.0 samples/s | 34.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.51345 | acc=0.6824 | tpr=0.5424 | fpr=0.0136 | 4543.5 samples/s | 17.7 steps/s
Avg test loss: 0.51620, Avg test acc: 0.68082, Avg tpr: 0.54240, Avg fpr: 0.01474, total FA: 115

Testing server on iccad2012
[Step=  50] | Loss=0.22897 | acc=0.9071 | tpr=0.9735 | fpr=0.0941 | 4496.4 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.23402 | acc=0.9070 | tpr=0.9808 | fpr=0.0944 | 8710.6 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.23988 | acc=0.9052 | tpr=0.9784 | fpr=0.0961 | 8483.9 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.24166 | acc=0.9055 | tpr=0.9803 | fpr=0.0959 | 9048.1 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.23972 | acc=0.9055 | tpr=0.9825 | fpr=0.0960 | 8143.1 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.24193 | acc=0.9050 | tpr=0.9818 | fpr=0.0964 | 8722.6 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.24214 | acc=0.9049 | tpr=0.9818 | fpr=0.0965 | 8229.3 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.24375 | acc=0.9043 | tpr=0.9809 | fpr=0.0971 | 8185.5 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.24684 | acc=0.9037 | tpr=0.9786 | fpr=0.0976 | 8524.9 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.24655 | acc=0.9035 | tpr=0.9784 | fpr=0.0978 | 8228.5 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.24523 | acc=0.9039 | tpr=0.9801 | fpr=0.0975 | 15857.1 samples/s | 61.9 steps/s
Avg test loss: 0.24494, Avg test acc: 0.90390, Avg tpr: 0.98019, Avg fpr: 0.09749, total FA: 13536

server round 15/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=5601 Epoch=21.5] | Loss=0.06667 | Reg=0.00216 | L2-Norm=14.700 | L2-Norm(final)=2.452 | acc=0.9688 | 4685.2 samples/s | 73.2 steps/s
[Step=5650 Epoch=21.6] | Loss=0.00555 | Reg=0.00219 | L2-Norm=14.809 | L2-Norm(final)=2.446 | acc=1.0000 | 4452.4 samples/s | 69.6 steps/s
[Step=5700 Epoch=21.8] | Loss=0.00446 | Reg=0.00220 | L2-Norm=14.833 | L2-Norm(final)=2.446 | acc=1.0000 | 4544.4 samples/s | 71.0 steps/s
[Step=5750 Epoch=22.0] | Loss=0.00346 | Reg=0.00220 | L2-Norm=14.838 | L2-Norm(final)=2.447 | acc=1.0000 | 4695.8 samples/s | 73.4 steps/s
[Step=5800 Epoch=22.2] | Loss=0.00289 | Reg=0.00220 | L2-Norm=14.840 | L2-Norm(final)=2.448 | acc=0.9844 | 4636.7 samples/s | 72.4 steps/s
[Step=5850 Epoch=22.4] | Loss=0.00235 | Reg=0.00220 | L2-Norm=14.837 | L2-Norm(final)=2.450 | acc=1.0000 | 5805.9 samples/s | 90.7 steps/s
[Step=5900 Epoch=22.6] | Loss=0.00203 | Reg=0.00220 | L2-Norm=14.831 | L2-Norm(final)=2.452 | acc=1.0000 | 2033.6 samples/s | 31.8 steps/s
[Step=5950 Epoch=22.8] | Loss=0.00174 | Reg=0.00220 | L2-Norm=14.822 | L2-Norm(final)=2.454 | acc=1.0000 | 4547.1 samples/s | 71.0 steps/s
[Step=6000 Epoch=23.0] | Loss=0.00153 | Reg=0.00219 | L2-Norm=14.811 | L2-Norm(final)=2.455 | acc=1.0000 | 4683.0 samples/s | 73.2 steps/s
[Step=6050 Epoch=23.2] | Loss=0.00136 | Reg=0.00219 | L2-Norm=14.798 | L2-Norm(final)=2.457 | acc=1.0000 | 4543.0 samples/s | 71.0 steps/s
[Step=6100 Epoch=23.4] | Loss=0.00123 | Reg=0.00219 | L2-Norm=14.784 | L2-Norm(final)=2.458 | acc=1.0000 | 5072.3 samples/s | 79.3 steps/s
[Step=6150 Epoch=23.6] | Loss=0.00112 | Reg=0.00218 | L2-Norm=14.768 | L2-Norm(final)=2.460 | acc=1.0000 | 2136.8 samples/s | 33.4 steps/s
[Step=6200 Epoch=23.8] | Loss=0.00102 | Reg=0.00218 | L2-Norm=14.752 | L2-Norm(final)=2.461 | acc=1.0000 | 4755.5 samples/s | 74.3 steps/s
[Step=6250 Epoch=23.9] | Loss=0.00095 | Reg=0.00217 | L2-Norm=14.736 | L2-Norm(final)=2.462 | acc=1.0000 | 4631.5 samples/s | 72.4 steps/s
[Step=6300 Epoch=24.1] | Loss=0.00088 | Reg=0.00217 | L2-Norm=14.719 | L2-Norm(final)=2.463 | acc=1.0000 | 4700.3 samples/s | 73.4 steps/s
[Step=6350 Epoch=24.3] | Loss=0.00082 | Reg=0.00216 | L2-Norm=14.702 | L2-Norm(final)=2.464 | acc=1.0000 | 4687.4 samples/s | 73.2 steps/s
[Step=6400 Epoch=24.5] | Loss=0.00077 | Reg=0.00216 | L2-Norm=14.684 | L2-Norm(final)=2.464 | acc=1.0000 | 2156.2 samples/s | 33.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step6400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=5601 Epoch=21.6] | Loss=0.01015 | Reg=0.00216 | L2-Norm=14.700 | L2-Norm(final)=2.453 | acc=1.0000 | 4180.7 samples/s | 65.3 steps/s
[Step=5650 Epoch=21.7] | Loss=0.00886 | Reg=0.00219 | L2-Norm=14.792 | L2-Norm(final)=2.451 | acc=1.0000 | 4582.3 samples/s | 71.6 steps/s
[Step=5700 Epoch=21.9] | Loss=0.00656 | Reg=0.00220 | L2-Norm=14.841 | L2-Norm(final)=2.453 | acc=1.0000 | 4631.4 samples/s | 72.4 steps/s
[Step=5750 Epoch=22.1] | Loss=0.00560 | Reg=0.00221 | L2-Norm=14.860 | L2-Norm(final)=2.452 | acc=1.0000 | 4603.1 samples/s | 71.9 steps/s
[Step=5800 Epoch=22.3] | Loss=0.00428 | Reg=0.00221 | L2-Norm=14.869 | L2-Norm(final)=2.451 | acc=1.0000 | 4711.8 samples/s | 73.6 steps/s
[Step=5850 Epoch=22.5] | Loss=0.00350 | Reg=0.00221 | L2-Norm=14.871 | L2-Norm(final)=2.453 | acc=1.0000 | 5978.2 samples/s | 93.4 steps/s
[Step=5900 Epoch=22.7] | Loss=0.00292 | Reg=0.00221 | L2-Norm=14.868 | L2-Norm(final)=2.455 | acc=1.0000 | 2040.5 samples/s | 31.9 steps/s
[Step=5950 Epoch=22.9] | Loss=0.00251 | Reg=0.00221 | L2-Norm=14.861 | L2-Norm(final)=2.457 | acc=1.0000 | 4629.8 samples/s | 72.3 steps/s
[Step=6000 Epoch=23.1] | Loss=0.00220 | Reg=0.00221 | L2-Norm=14.853 | L2-Norm(final)=2.458 | acc=1.0000 | 4579.2 samples/s | 71.5 steps/s
[Step=6050 Epoch=23.3] | Loss=0.00196 | Reg=0.00220 | L2-Norm=14.842 | L2-Norm(final)=2.460 | acc=1.0000 | 4594.6 samples/s | 71.8 steps/s
[Step=6100 Epoch=23.5] | Loss=0.00177 | Reg=0.00220 | L2-Norm=14.831 | L2-Norm(final)=2.461 | acc=1.0000 | 5263.9 samples/s | 82.2 steps/s
[Step=6150 Epoch=23.7] | Loss=0.00161 | Reg=0.00220 | L2-Norm=14.819 | L2-Norm(final)=2.463 | acc=1.0000 | 2103.7 samples/s | 32.9 steps/s
[Step=6200 Epoch=23.9] | Loss=0.00148 | Reg=0.00219 | L2-Norm=14.806 | L2-Norm(final)=2.464 | acc=1.0000 | 4678.3 samples/s | 73.1 steps/s
[Step=6250 Epoch=24.1] | Loss=0.00136 | Reg=0.00219 | L2-Norm=14.793 | L2-Norm(final)=2.465 | acc=1.0000 | 4681.5 samples/s | 73.1 steps/s
[Step=6300 Epoch=24.3] | Loss=0.00127 | Reg=0.00218 | L2-Norm=14.779 | L2-Norm(final)=2.466 | acc=1.0000 | 4622.1 samples/s | 72.2 steps/s
[Step=6350 Epoch=24.4] | Loss=0.00118 | Reg=0.00218 | L2-Norm=14.764 | L2-Norm(final)=2.467 | acc=1.0000 | 4742.5 samples/s | 74.1 steps/s
[Step=6400 Epoch=24.6] | Loss=0.00111 | Reg=0.00218 | L2-Norm=14.750 | L2-Norm(final)=2.468 | acc=1.0000 | 2225.6 samples/s | 34.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.53333 | acc=0.6802 | tpr=0.5371 | fpr=0.0092 | 4532.0 samples/s | 17.7 steps/s
Avg test loss: 0.53552, Avg test acc: 0.67878, Avg tpr: 0.53786, Avg fpr: 0.01128, total FA: 88

Testing server on iccad2012
[Step=  50] | Loss=0.22767 | acc=0.9105 | tpr=0.9646 | fpr=0.0905 | 4570.2 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.23160 | acc=0.9113 | tpr=0.9744 | fpr=0.0899 | 8711.6 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.23777 | acc=0.9099 | tpr=0.9726 | fpr=0.0913 | 8266.2 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.24032 | acc=0.9092 | tpr=0.9760 | fpr=0.0920 | 8457.5 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.23833 | acc=0.9092 | tpr=0.9773 | fpr=0.0920 | 9444.7 samples/s | 36.9 steps/s
[Step= 300] | Loss=0.24032 | acc=0.9090 | tpr=0.9782 | fpr=0.0922 | 7974.0 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.24035 | acc=0.9090 | tpr=0.9781 | fpr=0.0923 | 8736.8 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.24207 | acc=0.9086 | tpr=0.9759 | fpr=0.0926 | 8334.5 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.24542 | acc=0.9080 | tpr=0.9747 | fpr=0.0932 | 8648.4 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.24480 | acc=0.9079 | tpr=0.9749 | fpr=0.0933 | 8609.4 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.24349 | acc=0.9082 | tpr=0.9761 | fpr=0.0930 | 14749.4 samples/s | 57.6 steps/s
Avg test loss: 0.24320, Avg test acc: 0.90828, Avg tpr: 0.97623, Avg fpr: 0.09295, total FA: 12906

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=6401 Epoch=12.5] | Loss=0.12480 | Reg=0.00214 | L2-Norm=14.641 | L2-Norm(final)=2.482 | acc=0.8750 | 4459.1 samples/s | 69.7 steps/s
[Step=6450 Epoch=12.6] | Loss=0.05515 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.466 | acc=0.9688 | 4524.9 samples/s | 70.7 steps/s
[Step=6500 Epoch=12.7] | Loss=0.04250 | Reg=0.00217 | L2-Norm=14.747 | L2-Norm(final)=2.472 | acc=0.9688 | 4751.1 samples/s | 74.2 steps/s
[Step=6550 Epoch=12.8] | Loss=0.03648 | Reg=0.00218 | L2-Norm=14.766 | L2-Norm(final)=2.476 | acc=0.9844 | 4871.8 samples/s | 76.1 steps/s
[Step=6600 Epoch=12.9] | Loss=0.03495 | Reg=0.00218 | L2-Norm=14.781 | L2-Norm(final)=2.481 | acc=1.0000 | 4803.4 samples/s | 75.1 steps/s
[Step=6650 Epoch=13.0] | Loss=0.03320 | Reg=0.00219 | L2-Norm=14.791 | L2-Norm(final)=2.484 | acc=1.0000 | 4877.0 samples/s | 76.2 steps/s
[Step=6700 Epoch=13.1] | Loss=0.03216 | Reg=0.00219 | L2-Norm=14.802 | L2-Norm(final)=2.487 | acc=0.9844 | 4844.3 samples/s | 75.7 steps/s
[Step=6750 Epoch=13.2] | Loss=0.03136 | Reg=0.00219 | L2-Norm=14.812 | L2-Norm(final)=2.490 | acc=0.9531 | 4900.1 samples/s | 76.6 steps/s
[Step=6800 Epoch=13.3] | Loss=0.03080 | Reg=0.00220 | L2-Norm=14.822 | L2-Norm(final)=2.492 | acc=0.9844 | 4899.2 samples/s | 76.6 steps/s
[Step=6850 Epoch=13.4] | Loss=0.03019 | Reg=0.00220 | L2-Norm=14.831 | L2-Norm(final)=2.494 | acc=1.0000 | 4959.7 samples/s | 77.5 steps/s
[Step=6900 Epoch=13.5] | Loss=0.02961 | Reg=0.00220 | L2-Norm=14.840 | L2-Norm(final)=2.496 | acc=0.9844 | 6031.2 samples/s | 94.2 steps/s
[Step=6950 Epoch=13.6] | Loss=0.02840 | Reg=0.00220 | L2-Norm=14.849 | L2-Norm(final)=2.498 | acc=1.0000 | 2111.5 samples/s | 33.0 steps/s
[Step=7000 Epoch=13.7] | Loss=0.02773 | Reg=0.00221 | L2-Norm=14.857 | L2-Norm(final)=2.501 | acc=1.0000 | 4862.9 samples/s | 76.0 steps/s
[Step=7050 Epoch=13.8] | Loss=0.02685 | Reg=0.00221 | L2-Norm=14.866 | L2-Norm(final)=2.504 | acc=0.9688 | 5002.4 samples/s | 78.2 steps/s
[Step=7100 Epoch=13.8] | Loss=0.02642 | Reg=0.00221 | L2-Norm=14.875 | L2-Norm(final)=2.506 | acc=0.9688 | 4806.1 samples/s | 75.1 steps/s
[Step=7150 Epoch=13.9] | Loss=0.02631 | Reg=0.00222 | L2-Norm=14.883 | L2-Norm(final)=2.508 | acc=0.9688 | 4830.0 samples/s | 75.5 steps/s
[Step=7200 Epoch=14.0] | Loss=0.02608 | Reg=0.00222 | L2-Norm=14.891 | L2-Norm(final)=2.510 | acc=0.9688 | 4955.5 samples/s | 77.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step7200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=6401 Epoch=12.5] | Loss=0.51900 | Reg=0.00214 | L2-Norm=14.641 | L2-Norm(final)=2.480 | acc=0.7031 | 4447.0 samples/s | 69.5 steps/s
[Step=6450 Epoch=12.6] | Loss=0.07290 | Reg=0.00217 | L2-Norm=14.717 | L2-Norm(final)=2.447 | acc=0.9531 | 4824.6 samples/s | 75.4 steps/s
[Step=6500 Epoch=12.7] | Loss=0.05199 | Reg=0.00218 | L2-Norm=14.758 | L2-Norm(final)=2.453 | acc=0.9844 | 4865.1 samples/s | 76.0 steps/s
[Step=6550 Epoch=12.8] | Loss=0.04401 | Reg=0.00218 | L2-Norm=14.780 | L2-Norm(final)=2.459 | acc=1.0000 | 4908.1 samples/s | 76.7 steps/s
[Step=6600 Epoch=12.9] | Loss=0.04049 | Reg=0.00219 | L2-Norm=14.795 | L2-Norm(final)=2.464 | acc=0.9844 | 4847.8 samples/s | 75.7 steps/s
[Step=6650 Epoch=13.0] | Loss=0.03728 | Reg=0.00219 | L2-Norm=14.808 | L2-Norm(final)=2.468 | acc=0.9844 | 4923.3 samples/s | 76.9 steps/s
[Step=6700 Epoch=13.1] | Loss=0.03508 | Reg=0.00220 | L2-Norm=14.821 | L2-Norm(final)=2.473 | acc=0.9688 | 4941.3 samples/s | 77.2 steps/s
[Step=6750 Epoch=13.2] | Loss=0.03368 | Reg=0.00220 | L2-Norm=14.832 | L2-Norm(final)=2.476 | acc=0.9844 | 5059.1 samples/s | 79.0 steps/s
[Step=6800 Epoch=13.3] | Loss=0.03299 | Reg=0.00220 | L2-Norm=14.842 | L2-Norm(final)=2.479 | acc=0.9688 | 4816.4 samples/s | 75.3 steps/s
[Step=6850 Epoch=13.4] | Loss=0.03219 | Reg=0.00221 | L2-Norm=14.850 | L2-Norm(final)=2.481 | acc=0.9844 | 4976.3 samples/s | 77.8 steps/s
[Step=6900 Epoch=13.5] | Loss=0.03134 | Reg=0.00221 | L2-Norm=14.859 | L2-Norm(final)=2.483 | acc=1.0000 | 6143.8 samples/s | 96.0 steps/s
[Step=6950 Epoch=13.6] | Loss=0.02997 | Reg=0.00221 | L2-Norm=14.868 | L2-Norm(final)=2.486 | acc=0.9688 | 2130.2 samples/s | 33.3 steps/s
[Step=7000 Epoch=13.7] | Loss=0.02911 | Reg=0.00221 | L2-Norm=14.877 | L2-Norm(final)=2.489 | acc=0.9688 | 4860.6 samples/s | 75.9 steps/s
[Step=7050 Epoch=13.8] | Loss=0.02838 | Reg=0.00222 | L2-Norm=14.885 | L2-Norm(final)=2.492 | acc=0.9531 | 4903.6 samples/s | 76.6 steps/s
[Step=7100 Epoch=13.9] | Loss=0.02785 | Reg=0.00222 | L2-Norm=14.893 | L2-Norm(final)=2.496 | acc=0.9688 | 4868.3 samples/s | 76.1 steps/s
[Step=7150 Epoch=14.0] | Loss=0.02726 | Reg=0.00222 | L2-Norm=14.900 | L2-Norm(final)=2.498 | acc=0.9688 | 4906.6 samples/s | 76.7 steps/s
[Step=7200 Epoch=14.1] | Loss=0.02671 | Reg=0.00222 | L2-Norm=14.907 | L2-Norm(final)=2.501 | acc=0.9844 | 4834.0 samples/s | 75.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.48954 | acc=0.7005 | tpr=0.5672 | fpr=0.0102 | 4437.6 samples/s | 17.3 steps/s
Avg test loss: 0.49162, Avg test acc: 0.69917, Avg tpr: 0.56764, Avg fpr: 0.01154, total FA: 90

Testing server on iccad2012
[Step=  50] | Loss=0.23354 | acc=0.9066 | tpr=0.9602 | fpr=0.0943 | 4475.3 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.23794 | acc=0.9083 | tpr=0.9723 | fpr=0.0929 | 8718.0 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.24394 | acc=0.9065 | tpr=0.9712 | fpr=0.0947 | 8832.4 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.24638 | acc=0.9061 | tpr=0.9749 | fpr=0.0951 | 8155.9 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.24416 | acc=0.9066 | tpr=0.9764 | fpr=0.0946 | 8587.9 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.24621 | acc=0.9062 | tpr=0.9775 | fpr=0.0951 | 8794.4 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.24610 | acc=0.9062 | tpr=0.9768 | fpr=0.0951 | 8677.8 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.24772 | acc=0.9059 | tpr=0.9754 | fpr=0.0954 | 8549.8 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.25136 | acc=0.9052 | tpr=0.9742 | fpr=0.0961 | 8413.1 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.25061 | acc=0.9052 | tpr=0.9744 | fpr=0.0960 | 8413.3 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.24922 | acc=0.9057 | tpr=0.9761 | fpr=0.0956 | 15312.1 samples/s | 59.8 steps/s
Avg test loss: 0.24899, Avg test acc: 0.90570, Avg tpr: 0.97623, Avg fpr: 0.09559, total FA: 13272

server round 17/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=6401 Epoch=24.5] | Loss=0.11178 | Reg=0.00212 | L2-Norm=14.571 | L2-Norm(final)=2.506 | acc=0.9219 | 4552.8 samples/s | 71.1 steps/s
[Step=6450 Epoch=24.7] | Loss=0.00959 | Reg=0.00216 | L2-Norm=14.681 | L2-Norm(final)=2.490 | acc=1.0000 | 4436.1 samples/s | 69.3 steps/s
[Step=6500 Epoch=24.9] | Loss=0.00665 | Reg=0.00217 | L2-Norm=14.715 | L2-Norm(final)=2.486 | acc=1.0000 | 4492.4 samples/s | 70.2 steps/s
[Step=6550 Epoch=25.1] | Loss=0.00452 | Reg=0.00217 | L2-Norm=14.721 | L2-Norm(final)=2.488 | acc=1.0000 | 4643.0 samples/s | 72.5 steps/s
[Step=6600 Epoch=25.3] | Loss=0.00342 | Reg=0.00217 | L2-Norm=14.716 | L2-Norm(final)=2.490 | acc=1.0000 | 4719.3 samples/s | 73.7 steps/s
[Step=6650 Epoch=25.5] | Loss=0.00275 | Reg=0.00216 | L2-Norm=14.707 | L2-Norm(final)=2.493 | acc=1.0000 | 5961.7 samples/s | 93.2 steps/s
[Step=6700 Epoch=25.7] | Loss=0.00236 | Reg=0.00216 | L2-Norm=14.696 | L2-Norm(final)=2.495 | acc=1.0000 | 2048.1 samples/s | 32.0 steps/s
[Step=6750 Epoch=25.9] | Loss=0.00224 | Reg=0.00216 | L2-Norm=14.685 | L2-Norm(final)=2.496 | acc=1.0000 | 4652.2 samples/s | 72.7 steps/s
[Step=6800 Epoch=26.1] | Loss=0.00197 | Reg=0.00215 | L2-Norm=14.674 | L2-Norm(final)=2.497 | acc=1.0000 | 4662.7 samples/s | 72.9 steps/s
[Step=6850 Epoch=26.2] | Loss=0.00176 | Reg=0.00215 | L2-Norm=14.661 | L2-Norm(final)=2.498 | acc=1.0000 | 4661.7 samples/s | 72.8 steps/s
[Step=6900 Epoch=26.4] | Loss=0.00158 | Reg=0.00215 | L2-Norm=14.648 | L2-Norm(final)=2.500 | acc=1.0000 | 5108.9 samples/s | 79.8 steps/s
[Step=6950 Epoch=26.6] | Loss=0.00144 | Reg=0.00214 | L2-Norm=14.633 | L2-Norm(final)=2.501 | acc=1.0000 | 2143.9 samples/s | 33.5 steps/s
[Step=7000 Epoch=26.8] | Loss=0.00132 | Reg=0.00214 | L2-Norm=14.618 | L2-Norm(final)=2.502 | acc=1.0000 | 4648.4 samples/s | 72.6 steps/s
[Step=7050 Epoch=27.0] | Loss=0.00122 | Reg=0.00213 | L2-Norm=14.603 | L2-Norm(final)=2.503 | acc=1.0000 | 4774.1 samples/s | 74.6 steps/s
[Step=7100 Epoch=27.2] | Loss=0.00114 | Reg=0.00213 | L2-Norm=14.587 | L2-Norm(final)=2.505 | acc=1.0000 | 4660.7 samples/s | 72.8 steps/s
[Step=7150 Epoch=27.4] | Loss=0.00106 | Reg=0.00212 | L2-Norm=14.571 | L2-Norm(final)=2.506 | acc=1.0000 | 4569.7 samples/s | 71.4 steps/s
[Step=7200 Epoch=27.6] | Loss=0.00100 | Reg=0.00212 | L2-Norm=14.554 | L2-Norm(final)=2.507 | acc=1.0000 | 2209.1 samples/s | 34.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step7200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=6401 Epoch=24.6] | Loss=0.05738 | Reg=0.00212 | L2-Norm=14.571 | L2-Norm(final)=2.507 | acc=0.9688 | 4707.3 samples/s | 73.6 steps/s
[Step=6450 Epoch=24.8] | Loss=0.00502 | Reg=0.00214 | L2-Norm=14.642 | L2-Norm(final)=2.511 | acc=1.0000 | 4185.2 samples/s | 65.4 steps/s
[Step=6500 Epoch=25.0] | Loss=0.00325 | Reg=0.00215 | L2-Norm=14.658 | L2-Norm(final)=2.513 | acc=1.0000 | 4611.7 samples/s | 72.1 steps/s
[Step=6550 Epoch=25.2] | Loss=0.00229 | Reg=0.00215 | L2-Norm=14.659 | L2-Norm(final)=2.517 | acc=1.0000 | 4577.6 samples/s | 71.5 steps/s
[Step=6600 Epoch=25.4] | Loss=0.00177 | Reg=0.00215 | L2-Norm=14.654 | L2-Norm(final)=2.521 | acc=1.0000 | 4664.3 samples/s | 72.9 steps/s
[Step=6650 Epoch=25.6] | Loss=0.00144 | Reg=0.00215 | L2-Norm=14.646 | L2-Norm(final)=2.525 | acc=1.0000 | 5998.2 samples/s | 93.7 steps/s
[Step=6700 Epoch=25.8] | Loss=0.00120 | Reg=0.00214 | L2-Norm=14.635 | L2-Norm(final)=2.529 | acc=1.0000 | 2042.2 samples/s | 31.9 steps/s
[Step=6750 Epoch=26.0] | Loss=0.00103 | Reg=0.00214 | L2-Norm=14.622 | L2-Norm(final)=2.531 | acc=1.0000 | 4669.7 samples/s | 73.0 steps/s
[Step=6800 Epoch=26.2] | Loss=0.00091 | Reg=0.00213 | L2-Norm=14.608 | L2-Norm(final)=2.534 | acc=1.0000 | 4654.9 samples/s | 72.7 steps/s
[Step=6850 Epoch=26.4] | Loss=0.00081 | Reg=0.00213 | L2-Norm=14.593 | L2-Norm(final)=2.535 | acc=1.0000 | 4699.3 samples/s | 73.4 steps/s
[Step=6900 Epoch=26.6] | Loss=0.00073 | Reg=0.00213 | L2-Norm=14.578 | L2-Norm(final)=2.537 | acc=1.0000 | 5355.3 samples/s | 83.7 steps/s
[Step=6950 Epoch=26.8] | Loss=0.00066 | Reg=0.00212 | L2-Norm=14.561 | L2-Norm(final)=2.539 | acc=1.0000 | 2140.8 samples/s | 33.4 steps/s
[Step=7000 Epoch=26.9] | Loss=0.00061 | Reg=0.00212 | L2-Norm=14.545 | L2-Norm(final)=2.540 | acc=1.0000 | 4676.2 samples/s | 73.1 steps/s
[Step=7050 Epoch=27.1] | Loss=0.00056 | Reg=0.00211 | L2-Norm=14.528 | L2-Norm(final)=2.541 | acc=1.0000 | 4547.3 samples/s | 71.1 steps/s
[Step=7100 Epoch=27.3] | Loss=0.00052 | Reg=0.00211 | L2-Norm=14.511 | L2-Norm(final)=2.542 | acc=1.0000 | 4716.7 samples/s | 73.7 steps/s
[Step=7150 Epoch=27.5] | Loss=0.00049 | Reg=0.00210 | L2-Norm=14.494 | L2-Norm(final)=2.543 | acc=1.0000 | 4856.6 samples/s | 75.9 steps/s
[Step=7200 Epoch=27.7] | Loss=0.00046 | Reg=0.00210 | L2-Norm=14.476 | L2-Norm(final)=2.544 | acc=1.0000 | 2232.6 samples/s | 34.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46187 | acc=0.7156 | tpr=0.5883 | fpr=0.0079 | 4453.0 samples/s | 17.4 steps/s
Avg test loss: 0.46185, Avg test acc: 0.71372, Avg tpr: 0.58804, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.25068 | acc=0.9005 | tpr=0.9646 | fpr=0.1006 | 4416.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.25436 | acc=0.9017 | tpr=0.9723 | fpr=0.0996 | 8517.0 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.26044 | acc=0.8993 | tpr=0.9697 | fpr=0.1020 | 8568.4 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.26245 | acc=0.8991 | tpr=0.9727 | fpr=0.1022 | 8501.3 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.26068 | acc=0.8989 | tpr=0.9747 | fpr=0.1025 | 8844.9 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.26306 | acc=0.8986 | tpr=0.9760 | fpr=0.1028 | 8350.1 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.26302 | acc=0.8989 | tpr=0.9768 | fpr=0.1025 | 8666.8 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.26455 | acc=0.8986 | tpr=0.9759 | fpr=0.1028 | 8597.8 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.26842 | acc=0.8980 | tpr=0.9737 | fpr=0.1034 | 8611.7 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.26790 | acc=0.8981 | tpr=0.9740 | fpr=0.1033 | 8417.2 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.26648 | acc=0.8986 | tpr=0.9757 | fpr=0.1028 | 16012.5 samples/s | 62.5 steps/s
Avg test loss: 0.26629, Avg test acc: 0.89862, Avg tpr: 0.97544, Avg fpr: 0.10277, total FA: 14270

server round 18/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00050, len=1
[Step=7201 Epoch=14.1] | Loss=0.22818 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=2.538 | acc=0.7969 | 4555.5 samples/s | 71.2 steps/s
[Step=7250 Epoch=14.2] | Loss=0.04176 | Reg=0.00212 | L2-Norm=14.549 | L2-Norm(final)=2.531 | acc=0.9844 | 4724.3 samples/s | 73.8 steps/s
[Step=7300 Epoch=14.3] | Loss=0.03344 | Reg=0.00213 | L2-Norm=14.581 | L2-Norm(final)=2.537 | acc=0.9844 | 4861.9 samples/s | 76.0 steps/s
[Step=7350 Epoch=14.4] | Loss=0.03122 | Reg=0.00213 | L2-Norm=14.600 | L2-Norm(final)=2.542 | acc=1.0000 | 4837.4 samples/s | 75.6 steps/s
[Step=7400 Epoch=14.5] | Loss=0.03157 | Reg=0.00214 | L2-Norm=14.616 | L2-Norm(final)=2.545 | acc=0.9844 | 4844.1 samples/s | 75.7 steps/s
[Step=7450 Epoch=14.6] | Loss=0.02952 | Reg=0.00214 | L2-Norm=14.630 | L2-Norm(final)=2.548 | acc=1.0000 | 4934.4 samples/s | 77.1 steps/s
[Step=7500 Epoch=14.7] | Loss=0.02825 | Reg=0.00214 | L2-Norm=14.642 | L2-Norm(final)=2.551 | acc=0.9844 | 4877.1 samples/s | 76.2 steps/s
[Step=7550 Epoch=14.8] | Loss=0.02829 | Reg=0.00215 | L2-Norm=14.653 | L2-Norm(final)=2.554 | acc=1.0000 | 4882.4 samples/s | 76.3 steps/s
[Step=7600 Epoch=14.9] | Loss=0.02778 | Reg=0.00215 | L2-Norm=14.664 | L2-Norm(final)=2.556 | acc=0.9844 | 4921.3 samples/s | 76.9 steps/s
[Step=7650 Epoch=15.0] | Loss=0.02743 | Reg=0.00215 | L2-Norm=14.674 | L2-Norm(final)=2.557 | acc=1.0000 | 4891.4 samples/s | 76.4 steps/s
[Step=7700 Epoch=15.1] | Loss=0.02671 | Reg=0.00216 | L2-Norm=14.685 | L2-Norm(final)=2.559 | acc=0.9844 | 6068.2 samples/s | 94.8 steps/s
[Step=7750 Epoch=15.2] | Loss=0.02552 | Reg=0.00216 | L2-Norm=14.695 | L2-Norm(final)=2.562 | acc=0.9844 | 2114.0 samples/s | 33.0 steps/s
[Step=7800 Epoch=15.2] | Loss=0.02469 | Reg=0.00216 | L2-Norm=14.705 | L2-Norm(final)=2.565 | acc=1.0000 | 4871.3 samples/s | 76.1 steps/s
[Step=7850 Epoch=15.3] | Loss=0.02392 | Reg=0.00216 | L2-Norm=14.713 | L2-Norm(final)=2.568 | acc=0.9688 | 4881.3 samples/s | 76.3 steps/s
[Step=7900 Epoch=15.4] | Loss=0.02390 | Reg=0.00217 | L2-Norm=14.721 | L2-Norm(final)=2.570 | acc=1.0000 | 4911.4 samples/s | 76.7 steps/s
[Step=7950 Epoch=15.5] | Loss=0.02343 | Reg=0.00217 | L2-Norm=14.730 | L2-Norm(final)=2.573 | acc=1.0000 | 4806.7 samples/s | 75.1 steps/s
[Step=8000 Epoch=15.6] | Loss=0.02322 | Reg=0.00217 | L2-Norm=14.738 | L2-Norm(final)=2.576 | acc=0.9844 | 4938.4 samples/s | 77.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step8000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00050, len=1
[Step=7201 Epoch=27.7] | Loss=0.04462 | Reg=0.00210 | L2-Norm=14.477 | L2-Norm(final)=2.539 | acc=0.9688 | 4872.4 samples/s | 76.1 steps/s
[Step=7250 Epoch=27.9] | Loss=0.00788 | Reg=0.00212 | L2-Norm=14.568 | L2-Norm(final)=2.539 | acc=1.0000 | 4257.0 samples/s | 66.5 steps/s
[Step=7300 Epoch=28.1] | Loss=0.00576 | Reg=0.00214 | L2-Norm=14.623 | L2-Norm(final)=2.529 | acc=1.0000 | 4627.1 samples/s | 72.3 steps/s
[Step=7350 Epoch=28.3] | Loss=0.00425 | Reg=0.00214 | L2-Norm=14.643 | L2-Norm(final)=2.528 | acc=1.0000 | 4611.2 samples/s | 72.1 steps/s
[Step=7400 Epoch=28.5] | Loss=0.00393 | Reg=0.00215 | L2-Norm=14.650 | L2-Norm(final)=2.526 | acc=1.0000 | 4693.4 samples/s | 73.3 steps/s
[Step=7450 Epoch=28.7] | Loss=0.00369 | Reg=0.00215 | L2-Norm=14.653 | L2-Norm(final)=2.524 | acc=1.0000 | 5982.8 samples/s | 93.5 steps/s
[Step=7500 Epoch=28.9] | Loss=0.00321 | Reg=0.00215 | L2-Norm=14.653 | L2-Norm(final)=2.522 | acc=1.0000 | 2038.5 samples/s | 31.9 steps/s
[Step=7550 Epoch=29.1] | Loss=0.00276 | Reg=0.00215 | L2-Norm=14.650 | L2-Norm(final)=2.522 | acc=1.0000 | 4636.1 samples/s | 72.4 steps/s
[Step=7600 Epoch=29.3] | Loss=0.00245 | Reg=0.00214 | L2-Norm=14.643 | L2-Norm(final)=2.522 | acc=1.0000 | 4568.1 samples/s | 71.4 steps/s
[Step=7650 Epoch=29.4] | Loss=0.00218 | Reg=0.00214 | L2-Norm=14.635 | L2-Norm(final)=2.523 | acc=1.0000 | 4640.8 samples/s | 72.5 steps/s
[Step=7700 Epoch=29.6] | Loss=0.00197 | Reg=0.00214 | L2-Norm=14.625 | L2-Norm(final)=2.524 | acc=1.0000 | 5207.7 samples/s | 81.4 steps/s
[Step=7750 Epoch=29.8] | Loss=0.00179 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=2.525 | acc=1.0000 | 2132.3 samples/s | 33.3 steps/s
[Step=7800 Epoch=30.0] | Loss=0.00164 | Reg=0.00213 | L2-Norm=14.602 | L2-Norm(final)=2.526 | acc=1.0000 | 4617.1 samples/s | 72.1 steps/s
[Step=7850 Epoch=30.2] | Loss=0.00152 | Reg=0.00213 | L2-Norm=14.589 | L2-Norm(final)=2.527 | acc=1.0000 | 4553.9 samples/s | 71.2 steps/s
[Step=7900 Epoch=30.4] | Loss=0.00141 | Reg=0.00212 | L2-Norm=14.576 | L2-Norm(final)=2.528 | acc=1.0000 | 4621.3 samples/s | 72.2 steps/s
[Step=7950 Epoch=30.6] | Loss=0.00132 | Reg=0.00212 | L2-Norm=14.562 | L2-Norm(final)=2.529 | acc=1.0000 | 4698.6 samples/s | 73.4 steps/s
[Step=8000 Epoch=30.8] | Loss=0.00123 | Reg=0.00212 | L2-Norm=14.547 | L2-Norm(final)=2.530 | acc=1.0000 | 2223.3 samples/s | 34.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43590 | acc=0.7319 | tpr=0.6125 | fpr=0.0089 | 4568.5 samples/s | 17.8 steps/s
Avg test loss: 0.43650, Avg test acc: 0.72967, Avg tpr: 0.61229, Avg fpr: 0.01218, total FA: 95

Testing server on iccad2012
[Step=  50] | Loss=0.25611 | acc=0.9011 | tpr=0.9779 | fpr=0.1003 | 4531.2 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.26253 | acc=0.9013 | tpr=0.9872 | fpr=0.1003 | 8633.4 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.26847 | acc=0.9002 | tpr=0.9827 | fpr=0.1014 | 8228.7 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.27094 | acc=0.9000 | tpr=0.9836 | fpr=0.1016 | 9107.0 samples/s | 35.6 steps/s
[Step= 250] | Loss=0.26888 | acc=0.9001 | tpr=0.9843 | fpr=0.1014 | 8213.3 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.27192 | acc=0.8994 | tpr=0.9840 | fpr=0.1021 | 8639.8 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.27204 | acc=0.8996 | tpr=0.9843 | fpr=0.1019 | 8754.4 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.27411 | acc=0.8990 | tpr=0.9830 | fpr=0.1025 | 8126.8 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.27786 | acc=0.8985 | tpr=0.9820 | fpr=0.1030 | 8845.0 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.27752 | acc=0.8984 | tpr=0.9815 | fpr=0.1031 | 8527.1 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.27593 | acc=0.8988 | tpr=0.9817 | fpr=0.1027 | 14998.9 samples/s | 58.6 steps/s
Avg test loss: 0.27569, Avg test acc: 0.89892, Avg tpr: 0.98177, Avg fpr: 0.10259, total FA: 14244

server round 19/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00050, len=1
[Step=7201 Epoch=14.0] | Loss=0.34640 | Reg=0.00209 | L2-Norm=14.443 | L2-Norm(final)=2.551 | acc=0.7500 | 4319.5 samples/s | 67.5 steps/s
[Step=7250 Epoch=14.1] | Loss=0.06403 | Reg=0.00210 | L2-Norm=14.507 | L2-Norm(final)=2.521 | acc=0.9688 | 4715.8 samples/s | 73.7 steps/s
[Step=7300 Epoch=14.2] | Loss=0.04818 | Reg=0.00211 | L2-Norm=14.541 | L2-Norm(final)=2.527 | acc=0.9844 | 4971.3 samples/s | 77.7 steps/s
[Step=7350 Epoch=14.3] | Loss=0.04023 | Reg=0.00212 | L2-Norm=14.559 | L2-Norm(final)=2.531 | acc=0.9844 | 4892.7 samples/s | 76.4 steps/s
[Step=7400 Epoch=14.4] | Loss=0.03700 | Reg=0.00212 | L2-Norm=14.575 | L2-Norm(final)=2.537 | acc=0.9844 | 4842.2 samples/s | 75.7 steps/s
[Step=7450 Epoch=14.5] | Loss=0.03461 | Reg=0.00213 | L2-Norm=14.588 | L2-Norm(final)=2.542 | acc=0.9844 | 4857.8 samples/s | 75.9 steps/s
[Step=7500 Epoch=14.6] | Loss=0.03319 | Reg=0.00213 | L2-Norm=14.602 | L2-Norm(final)=2.546 | acc=0.9688 | 4976.3 samples/s | 77.8 steps/s
[Step=7550 Epoch=14.7] | Loss=0.03160 | Reg=0.00214 | L2-Norm=14.614 | L2-Norm(final)=2.550 | acc=0.9844 | 4799.8 samples/s | 75.0 steps/s
[Step=7600 Epoch=14.8] | Loss=0.03015 | Reg=0.00214 | L2-Norm=14.626 | L2-Norm(final)=2.554 | acc=1.0000 | 4849.6 samples/s | 75.8 steps/s
[Step=7650 Epoch=14.9] | Loss=0.02927 | Reg=0.00214 | L2-Norm=14.637 | L2-Norm(final)=2.558 | acc=1.0000 | 4936.3 samples/s | 77.1 steps/s
[Step=7700 Epoch=15.0] | Loss=0.02892 | Reg=0.00215 | L2-Norm=14.648 | L2-Norm(final)=2.562 | acc=0.9375 | 5896.1 samples/s | 92.1 steps/s
[Step=7750 Epoch=15.1] | Loss=0.02839 | Reg=0.00215 | L2-Norm=14.658 | L2-Norm(final)=2.564 | acc=1.0000 | 2028.4 samples/s | 31.7 steps/s
[Step=7800 Epoch=15.2] | Loss=0.02762 | Reg=0.00215 | L2-Norm=14.668 | L2-Norm(final)=2.566 | acc=0.9844 | 4814.7 samples/s | 75.2 steps/s
[Step=7850 Epoch=15.3] | Loss=0.02679 | Reg=0.00215 | L2-Norm=14.677 | L2-Norm(final)=2.568 | acc=1.0000 | 4874.2 samples/s | 76.2 steps/s
[Step=7900 Epoch=15.4] | Loss=0.02631 | Reg=0.00216 | L2-Norm=14.685 | L2-Norm(final)=2.570 | acc=0.9531 | 4906.2 samples/s | 76.7 steps/s
[Step=7950 Epoch=15.5] | Loss=0.02593 | Reg=0.00216 | L2-Norm=14.693 | L2-Norm(final)=2.572 | acc=0.9844 | 4929.6 samples/s | 77.0 steps/s
[Step=8000 Epoch=15.6] | Loss=0.02549 | Reg=0.00216 | L2-Norm=14.701 | L2-Norm(final)=2.575 | acc=1.0000 | 5031.2 samples/s | 78.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00050, len=1
[Step=7201 Epoch=27.6] | Loss=0.01475 | Reg=0.00209 | L2-Norm=14.443 | L2-Norm(final)=2.553 | acc=0.9844 | 4604.1 samples/s | 71.9 steps/s
[Step=7250 Epoch=27.8] | Loss=0.00270 | Reg=0.00211 | L2-Norm=14.522 | L2-Norm(final)=2.568 | acc=0.9844 | 4359.5 samples/s | 68.1 steps/s
[Step=7300 Epoch=28.0] | Loss=0.00142 | Reg=0.00211 | L2-Norm=14.536 | L2-Norm(final)=2.575 | acc=1.0000 | 4653.1 samples/s | 72.7 steps/s
[Step=7350 Epoch=28.2] | Loss=0.00100 | Reg=0.00211 | L2-Norm=14.530 | L2-Norm(final)=2.580 | acc=1.0000 | 4585.8 samples/s | 71.7 steps/s
[Step=7400 Epoch=28.4] | Loss=0.00076 | Reg=0.00211 | L2-Norm=14.518 | L2-Norm(final)=2.584 | acc=1.0000 | 4596.0 samples/s | 71.8 steps/s
[Step=7450 Epoch=28.5] | Loss=0.00062 | Reg=0.00210 | L2-Norm=14.503 | L2-Norm(final)=2.586 | acc=1.0000 | 5851.5 samples/s | 91.4 steps/s
[Step=7500 Epoch=28.7] | Loss=0.00052 | Reg=0.00210 | L2-Norm=14.487 | L2-Norm(final)=2.589 | acc=1.0000 | 2058.1 samples/s | 32.2 steps/s
[Step=7550 Epoch=28.9] | Loss=0.00045 | Reg=0.00209 | L2-Norm=14.469 | L2-Norm(final)=2.591 | acc=1.0000 | 4662.6 samples/s | 72.9 steps/s
[Step=7600 Epoch=29.1] | Loss=0.00039 | Reg=0.00209 | L2-Norm=14.451 | L2-Norm(final)=2.592 | acc=1.0000 | 4555.7 samples/s | 71.2 steps/s
[Step=7650 Epoch=29.3] | Loss=0.00035 | Reg=0.00208 | L2-Norm=14.432 | L2-Norm(final)=2.594 | acc=1.0000 | 4657.8 samples/s | 72.8 steps/s
[Step=7700 Epoch=29.5] | Loss=0.00032 | Reg=0.00208 | L2-Norm=14.412 | L2-Norm(final)=2.595 | acc=1.0000 | 5096.1 samples/s | 79.6 steps/s
[Step=7750 Epoch=29.7] | Loss=0.00029 | Reg=0.00207 | L2-Norm=14.392 | L2-Norm(final)=2.596 | acc=1.0000 | 2139.0 samples/s | 33.4 steps/s
[Step=7800 Epoch=29.9] | Loss=0.00027 | Reg=0.00207 | L2-Norm=14.372 | L2-Norm(final)=2.597 | acc=1.0000 | 4753.3 samples/s | 74.3 steps/s
[Step=7850 Epoch=30.1] | Loss=0.00025 | Reg=0.00206 | L2-Norm=14.352 | L2-Norm(final)=2.598 | acc=1.0000 | 4489.5 samples/s | 70.1 steps/s
[Step=7900 Epoch=30.3] | Loss=0.00023 | Reg=0.00205 | L2-Norm=14.332 | L2-Norm(final)=2.599 | acc=1.0000 | 4684.2 samples/s | 73.2 steps/s
[Step=7950 Epoch=30.5] | Loss=0.00021 | Reg=0.00205 | L2-Norm=14.311 | L2-Norm(final)=2.600 | acc=1.0000 | 4621.2 samples/s | 72.2 steps/s
[Step=8000 Epoch=30.7] | Loss=0.00020 | Reg=0.00204 | L2-Norm=14.291 | L2-Norm(final)=2.600 | acc=1.0000 | 2231.1 samples/s | 34.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35915 | acc=0.7737 | tpr=0.6737 | fpr=0.0092 | 4658.3 samples/s | 18.2 steps/s
Avg test loss: 0.36005, Avg test acc: 0.77342, Avg tpr: 0.67570, Avg fpr: 0.01167, total FA: 91

Testing server on iccad2012
[Step=  50] | Loss=0.31962 | acc=0.8766 | tpr=0.9823 | fpr=0.1253 | 4637.2 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.32685 | acc=0.8770 | tpr=0.9829 | fpr=0.1250 | 8438.4 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.33293 | acc=0.8759 | tpr=0.9813 | fpr=0.1261 | 8577.5 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.33549 | acc=0.8760 | tpr=0.9814 | fpr=0.1260 | 8564.6 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.33337 | acc=0.8761 | tpr=0.9825 | fpr=0.1258 | 8551.2 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.33645 | acc=0.8752 | tpr=0.9825 | fpr=0.1267 | 8517.6 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.33633 | acc=0.8756 | tpr=0.9831 | fpr=0.1263 | 8634.5 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.33872 | acc=0.8752 | tpr=0.9819 | fpr=0.1267 | 8583.8 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.34253 | acc=0.8748 | tpr=0.9815 | fpr=0.1271 | 8379.7 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.34233 | acc=0.8746 | tpr=0.9811 | fpr=0.1273 | 8324.6 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.34065 | acc=0.8750 | tpr=0.9813 | fpr=0.1269 | 15639.6 samples/s | 61.1 steps/s
Avg test loss: 0.34031, Avg test acc: 0.87508, Avg tpr: 0.98138, Avg fpr: 0.12685, total FA: 17613

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=8001 Epoch=15.6] | Loss=0.27446 | Reg=0.00206 | L2-Norm=14.335 | L2-Norm(final)=2.593 | acc=0.8750 | 4751.7 samples/s | 74.2 steps/s
[Step=8050 Epoch=15.7] | Loss=0.05618 | Reg=0.00206 | L2-Norm=14.358 | L2-Norm(final)=2.581 | acc=1.0000 | 4432.4 samples/s | 69.3 steps/s
[Step=8100 Epoch=15.8] | Loss=0.03928 | Reg=0.00207 | L2-Norm=14.372 | L2-Norm(final)=2.583 | acc=0.9844 | 4878.7 samples/s | 76.2 steps/s
[Step=8150 Epoch=15.9] | Loss=0.03240 | Reg=0.00207 | L2-Norm=14.381 | L2-Norm(final)=2.587 | acc=0.9688 | 4863.8 samples/s | 76.0 steps/s
[Step=8200 Epoch=16.0] | Loss=0.02952 | Reg=0.00207 | L2-Norm=14.387 | L2-Norm(final)=2.592 | acc=0.9688 | 4824.2 samples/s | 75.4 steps/s
[Step=8250 Epoch=16.1] | Loss=0.02719 | Reg=0.00207 | L2-Norm=14.394 | L2-Norm(final)=2.596 | acc=0.9688 | 4840.7 samples/s | 75.6 steps/s
[Step=8300 Epoch=16.2] | Loss=0.02538 | Reg=0.00207 | L2-Norm=14.399 | L2-Norm(final)=2.600 | acc=0.9531 | 4931.1 samples/s | 77.0 steps/s
[Step=8350 Epoch=16.3] | Loss=0.02398 | Reg=0.00207 | L2-Norm=14.404 | L2-Norm(final)=2.604 | acc=0.9844 | 4830.2 samples/s | 75.5 steps/s
[Step=8400 Epoch=16.4] | Loss=0.02308 | Reg=0.00208 | L2-Norm=14.409 | L2-Norm(final)=2.608 | acc=0.9531 | 5068.2 samples/s | 79.2 steps/s
[Step=8450 Epoch=16.5] | Loss=0.02252 | Reg=0.00208 | L2-Norm=14.414 | L2-Norm(final)=2.611 | acc=0.9844 | 4944.2 samples/s | 77.3 steps/s
[Step=8500 Epoch=16.6] | Loss=0.02175 | Reg=0.00208 | L2-Norm=14.418 | L2-Norm(final)=2.614 | acc=1.0000 | 6001.9 samples/s | 93.8 steps/s
[Step=8550 Epoch=16.7] | Loss=0.02112 | Reg=0.00208 | L2-Norm=14.423 | L2-Norm(final)=2.617 | acc=1.0000 | 2100.1 samples/s | 32.8 steps/s
[Step=8600 Epoch=16.8] | Loss=0.02005 | Reg=0.00208 | L2-Norm=14.427 | L2-Norm(final)=2.621 | acc=1.0000 | 4931.5 samples/s | 77.1 steps/s
[Step=8650 Epoch=16.9] | Loss=0.01951 | Reg=0.00208 | L2-Norm=14.431 | L2-Norm(final)=2.624 | acc=1.0000 | 4941.2 samples/s | 77.2 steps/s
[Step=8700 Epoch=17.0] | Loss=0.01921 | Reg=0.00208 | L2-Norm=14.435 | L2-Norm(final)=2.627 | acc=1.0000 | 4819.1 samples/s | 75.3 steps/s
[Step=8750 Epoch=17.1] | Loss=0.01871 | Reg=0.00208 | L2-Norm=14.439 | L2-Norm(final)=2.630 | acc=1.0000 | 4855.8 samples/s | 75.9 steps/s
[Step=8800 Epoch=17.2] | Loss=0.01842 | Reg=0.00209 | L2-Norm=14.443 | L2-Norm(final)=2.633 | acc=1.0000 | 4955.4 samples/s | 77.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step8800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=8001 Epoch=15.6] | Loss=0.18831 | Reg=0.00206 | L2-Norm=14.335 | L2-Norm(final)=2.593 | acc=0.9062 | 4221.3 samples/s | 66.0 steps/s
[Step=8050 Epoch=15.7] | Loss=0.05008 | Reg=0.00206 | L2-Norm=14.356 | L2-Norm(final)=2.581 | acc=1.0000 | 4824.8 samples/s | 75.4 steps/s
[Step=8100 Epoch=15.8] | Loss=0.03648 | Reg=0.00206 | L2-Norm=14.369 | L2-Norm(final)=2.585 | acc=1.0000 | 4887.2 samples/s | 76.4 steps/s
[Step=8150 Epoch=15.9] | Loss=0.03110 | Reg=0.00207 | L2-Norm=14.378 | L2-Norm(final)=2.589 | acc=0.9844 | 4826.0 samples/s | 75.4 steps/s
[Step=8200 Epoch=16.0] | Loss=0.02808 | Reg=0.00207 | L2-Norm=14.386 | L2-Norm(final)=2.595 | acc=1.0000 | 4883.9 samples/s | 76.3 steps/s
[Step=8250 Epoch=16.1] | Loss=0.02610 | Reg=0.00207 | L2-Norm=14.393 | L2-Norm(final)=2.600 | acc=0.9844 | 5024.5 samples/s | 78.5 steps/s
[Step=8300 Epoch=16.2] | Loss=0.02425 | Reg=0.00207 | L2-Norm=14.399 | L2-Norm(final)=2.604 | acc=0.9688 | 4924.0 samples/s | 76.9 steps/s
[Step=8350 Epoch=16.3] | Loss=0.02297 | Reg=0.00208 | L2-Norm=14.405 | L2-Norm(final)=2.608 | acc=1.0000 | 4828.0 samples/s | 75.4 steps/s
[Step=8400 Epoch=16.4] | Loss=0.02196 | Reg=0.00208 | L2-Norm=14.411 | L2-Norm(final)=2.612 | acc=0.9844 | 4919.3 samples/s | 76.9 steps/s
[Step=8450 Epoch=16.5] | Loss=0.02153 | Reg=0.00208 | L2-Norm=14.415 | L2-Norm(final)=2.615 | acc=0.9844 | 4944.2 samples/s | 77.3 steps/s
[Step=8500 Epoch=16.6] | Loss=0.02091 | Reg=0.00208 | L2-Norm=14.420 | L2-Norm(final)=2.618 | acc=1.0000 | 6038.1 samples/s | 94.3 steps/s
[Step=8550 Epoch=16.7] | Loss=0.02005 | Reg=0.00208 | L2-Norm=14.424 | L2-Norm(final)=2.621 | acc=1.0000 | 2121.8 samples/s | 33.2 steps/s
[Step=8600 Epoch=16.8] | Loss=0.01923 | Reg=0.00208 | L2-Norm=14.428 | L2-Norm(final)=2.625 | acc=1.0000 | 4852.0 samples/s | 75.8 steps/s
[Step=8650 Epoch=16.9] | Loss=0.01856 | Reg=0.00208 | L2-Norm=14.433 | L2-Norm(final)=2.628 | acc=1.0000 | 4937.9 samples/s | 77.2 steps/s
[Step=8700 Epoch=17.0] | Loss=0.01821 | Reg=0.00208 | L2-Norm=14.437 | L2-Norm(final)=2.632 | acc=1.0000 | 4811.6 samples/s | 75.2 steps/s
[Step=8750 Epoch=17.1] | Loss=0.01770 | Reg=0.00209 | L2-Norm=14.440 | L2-Norm(final)=2.635 | acc=1.0000 | 4979.1 samples/s | 77.8 steps/s
[Step=8800 Epoch=17.2] | Loss=0.01728 | Reg=0.00209 | L2-Norm=14.444 | L2-Norm(final)=2.638 | acc=1.0000 | 4984.0 samples/s | 77.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.52873 | acc=0.7127 | tpr=0.5841 | fpr=0.0079 | 4522.8 samples/s | 17.7 steps/s
Avg test loss: 0.52995, Avg test acc: 0.70911, Avg tpr: 0.58134, Avg fpr: 0.00987, total FA: 77

Testing server on iccad2012
[Step=  50] | Loss=0.28455 | acc=0.9050 | tpr=0.9735 | fpr=0.0962 | 4521.2 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.29354 | acc=0.9046 | tpr=0.9808 | fpr=0.0968 | 8420.3 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.30017 | acc=0.9035 | tpr=0.9827 | fpr=0.0979 | 8442.3 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.30292 | acc=0.9038 | tpr=0.9825 | fpr=0.0977 | 8874.7 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.30069 | acc=0.9041 | tpr=0.9843 | fpr=0.0974 | 8284.3 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.30397 | acc=0.9031 | tpr=0.9840 | fpr=0.0984 | 8666.2 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.30398 | acc=0.9031 | tpr=0.9837 | fpr=0.0983 | 9313.9 samples/s | 36.4 steps/s
[Step= 400] | Loss=0.30633 | acc=0.9029 | tpr=0.9825 | fpr=0.0986 | 8088.9 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.31054 | acc=0.9025 | tpr=0.9815 | fpr=0.0989 | 8611.5 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.31015 | acc=0.9024 | tpr=0.9811 | fpr=0.0991 | 8720.1 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.30839 | acc=0.9027 | tpr=0.9813 | fpr=0.0988 | 14648.2 samples/s | 57.2 steps/s
Avg test loss: 0.30806, Avg test acc: 0.90270, Avg tpr: 0.98138, Avg fpr: 0.09873, total FA: 13709

server round 21/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=8001 Epoch=30.7] | Loss=0.01045 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=2.628 | acc=0.9844 | 4671.5 samples/s | 73.0 steps/s
[Step=8050 Epoch=30.8] | Loss=0.00211 | Reg=0.00203 | L2-Norm=14.237 | L2-Norm(final)=2.629 | acc=1.0000 | 4199.5 samples/s | 65.6 steps/s
[Step=8100 Epoch=31.0] | Loss=0.00148 | Reg=0.00203 | L2-Norm=14.240 | L2-Norm(final)=2.634 | acc=1.0000 | 4570.9 samples/s | 71.4 steps/s
[Step=8150 Epoch=31.2] | Loss=0.00102 | Reg=0.00203 | L2-Norm=14.237 | L2-Norm(final)=2.637 | acc=1.0000 | 4648.6 samples/s | 72.6 steps/s
[Step=8200 Epoch=31.4] | Loss=0.00078 | Reg=0.00202 | L2-Norm=14.230 | L2-Norm(final)=2.640 | acc=1.0000 | 4609.5 samples/s | 72.0 steps/s
[Step=8250 Epoch=31.6] | Loss=0.00063 | Reg=0.00202 | L2-Norm=14.222 | L2-Norm(final)=2.642 | acc=1.0000 | 6000.4 samples/s | 93.8 steps/s
[Step=8300 Epoch=31.8] | Loss=0.00053 | Reg=0.00202 | L2-Norm=14.212 | L2-Norm(final)=2.643 | acc=1.0000 | 2047.6 samples/s | 32.0 steps/s
[Step=8350 Epoch=32.0] | Loss=0.00046 | Reg=0.00202 | L2-Norm=14.203 | L2-Norm(final)=2.645 | acc=1.0000 | 4589.9 samples/s | 71.7 steps/s
[Step=8400 Epoch=32.2] | Loss=0.00040 | Reg=0.00201 | L2-Norm=14.192 | L2-Norm(final)=2.646 | acc=1.0000 | 4588.1 samples/s | 71.7 steps/s
[Step=8450 Epoch=32.4] | Loss=0.00036 | Reg=0.00201 | L2-Norm=14.182 | L2-Norm(final)=2.647 | acc=1.0000 | 4665.0 samples/s | 72.9 steps/s
[Step=8500 Epoch=32.6] | Loss=0.00032 | Reg=0.00201 | L2-Norm=14.171 | L2-Norm(final)=2.648 | acc=1.0000 | 5074.2 samples/s | 79.3 steps/s
[Step=8550 Epoch=32.8] | Loss=0.00029 | Reg=0.00201 | L2-Norm=14.160 | L2-Norm(final)=2.649 | acc=1.0000 | 2164.6 samples/s | 33.8 steps/s
[Step=8600 Epoch=33.0] | Loss=0.00027 | Reg=0.00200 | L2-Norm=14.148 | L2-Norm(final)=2.650 | acc=1.0000 | 4639.7 samples/s | 72.5 steps/s
[Step=8650 Epoch=33.1] | Loss=0.00025 | Reg=0.00200 | L2-Norm=14.137 | L2-Norm(final)=2.650 | acc=1.0000 | 4660.2 samples/s | 72.8 steps/s
[Step=8700 Epoch=33.3] | Loss=0.00023 | Reg=0.00200 | L2-Norm=14.125 | L2-Norm(final)=2.651 | acc=1.0000 | 4712.6 samples/s | 73.6 steps/s
[Step=8750 Epoch=33.5] | Loss=0.00022 | Reg=0.00199 | L2-Norm=14.113 | L2-Norm(final)=2.652 | acc=1.0000 | 4735.5 samples/s | 74.0 steps/s
[Step=8800 Epoch=33.7] | Loss=0.00021 | Reg=0.00199 | L2-Norm=14.102 | L2-Norm(final)=2.652 | acc=1.0000 | 2242.2 samples/s | 35.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step8800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=8001 Epoch=30.8] | Loss=0.00834 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=2.628 | acc=0.9844 | 4390.7 samples/s | 68.6 steps/s
[Step=8050 Epoch=31.0] | Loss=0.00126 | Reg=0.00203 | L2-Norm=14.240 | L2-Norm(final)=2.633 | acc=1.0000 | 4592.8 samples/s | 71.8 steps/s
[Step=8100 Epoch=31.2] | Loss=0.00077 | Reg=0.00203 | L2-Norm=14.241 | L2-Norm(final)=2.636 | acc=1.0000 | 4580.7 samples/s | 71.6 steps/s
[Step=8150 Epoch=31.4] | Loss=0.00054 | Reg=0.00203 | L2-Norm=14.237 | L2-Norm(final)=2.639 | acc=1.0000 | 4604.1 samples/s | 71.9 steps/s
[Step=8200 Epoch=31.6] | Loss=0.00043 | Reg=0.00203 | L2-Norm=14.232 | L2-Norm(final)=2.641 | acc=1.0000 | 4745.3 samples/s | 74.1 steps/s
[Step=8250 Epoch=31.8] | Loss=0.00035 | Reg=0.00202 | L2-Norm=14.225 | L2-Norm(final)=2.643 | acc=1.0000 | 5960.7 samples/s | 93.1 steps/s
[Step=8300 Epoch=31.9] | Loss=0.00030 | Reg=0.00202 | L2-Norm=14.217 | L2-Norm(final)=2.644 | acc=1.0000 | 2038.9 samples/s | 31.9 steps/s
[Step=8350 Epoch=32.1] | Loss=0.00026 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=2.646 | acc=1.0000 | 4553.0 samples/s | 71.1 steps/s
[Step=8400 Epoch=32.3] | Loss=0.00023 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=2.647 | acc=1.0000 | 4660.4 samples/s | 72.8 steps/s
[Step=8450 Epoch=32.5] | Loss=0.00021 | Reg=0.00201 | L2-Norm=14.193 | L2-Norm(final)=2.648 | acc=1.0000 | 4622.0 samples/s | 72.2 steps/s
[Step=8500 Epoch=32.7] | Loss=0.00019 | Reg=0.00201 | L2-Norm=14.184 | L2-Norm(final)=2.649 | acc=1.0000 | 5148.2 samples/s | 80.4 steps/s
[Step=8550 Epoch=32.9] | Loss=0.00017 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=2.650 | acc=1.0000 | 2125.0 samples/s | 33.2 steps/s
[Step=8600 Epoch=33.1] | Loss=0.00016 | Reg=0.00201 | L2-Norm=14.166 | L2-Norm(final)=2.650 | acc=1.0000 | 4738.2 samples/s | 74.0 steps/s
[Step=8650 Epoch=33.3] | Loss=0.00015 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=2.651 | acc=1.0000 | 4580.4 samples/s | 71.6 steps/s
[Step=8700 Epoch=33.5] | Loss=0.00014 | Reg=0.00200 | L2-Norm=14.148 | L2-Norm(final)=2.652 | acc=1.0000 | 4689.1 samples/s | 73.3 steps/s
[Step=8750 Epoch=33.7] | Loss=0.00013 | Reg=0.00200 | L2-Norm=14.138 | L2-Norm(final)=2.653 | acc=1.0000 | 4670.3 samples/s | 73.0 steps/s
[Step=8800 Epoch=33.9] | Loss=0.00012 | Reg=0.00200 | L2-Norm=14.129 | L2-Norm(final)=2.653 | acc=1.0000 | 2227.0 samples/s | 34.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38575 | acc=0.7815 | tpr=0.6834 | fpr=0.0055 | 4584.0 samples/s | 17.9 steps/s
Avg test loss: 0.38752, Avg test acc: 0.78095, Avg tpr: 0.68444, Avg fpr: 0.00679, total FA: 53

Testing server on iccad2012
[Step=  50] | Loss=0.34928 | acc=0.8705 | tpr=0.9602 | fpr=0.1311 | 4521.9 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.35732 | acc=0.8712 | tpr=0.9701 | fpr=0.1306 | 8580.4 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.36352 | acc=0.8708 | tpr=0.9712 | fpr=0.1311 | 8697.2 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.36662 | acc=0.8709 | tpr=0.9738 | fpr=0.1310 | 8417.4 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.36405 | acc=0.8708 | tpr=0.9747 | fpr=0.1311 | 8626.5 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.36745 | acc=0.8700 | tpr=0.9753 | fpr=0.1320 | 8775.6 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.36695 | acc=0.8703 | tpr=0.9756 | fpr=0.1316 | 8787.1 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.36924 | acc=0.8698 | tpr=0.9743 | fpr=0.1321 | 8656.9 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.37320 | acc=0.8694 | tpr=0.9732 | fpr=0.1325 | 8324.1 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.37302 | acc=0.8690 | tpr=0.9727 | fpr=0.1328 | 8369.8 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.37128 | acc=0.8693 | tpr=0.9733 | fpr=0.1326 | 15700.4 samples/s | 61.3 steps/s
Avg test loss: 0.37097, Avg test acc: 0.86937, Avg tpr: 0.97345, Avg fpr: 0.13252, total FA: 18400

server round 22/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=8801 Epoch=17.2] | Loss=0.40647 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=2.672 | acc=0.7969 | 4407.9 samples/s | 68.9 steps/s
[Step=8850 Epoch=17.3] | Loss=0.03445 | Reg=0.00201 | L2-Norm=14.190 | L2-Norm(final)=2.663 | acc=1.0000 | 4671.5 samples/s | 73.0 steps/s
[Step=8900 Epoch=17.4] | Loss=0.02740 | Reg=0.00202 | L2-Norm=14.202 | L2-Norm(final)=2.666 | acc=0.9844 | 4649.5 samples/s | 72.6 steps/s
[Step=8950 Epoch=17.5] | Loss=0.02436 | Reg=0.00202 | L2-Norm=14.209 | L2-Norm(final)=2.668 | acc=0.9844 | 4867.4 samples/s | 76.1 steps/s
[Step=9000 Epoch=17.6] | Loss=0.02266 | Reg=0.00202 | L2-Norm=14.216 | L2-Norm(final)=2.671 | acc=0.9844 | 4925.7 samples/s | 77.0 steps/s
[Step=9050 Epoch=17.7] | Loss=0.02131 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=2.673 | acc=0.9531 | 4924.7 samples/s | 76.9 steps/s
[Step=9100 Epoch=17.7] | Loss=0.02028 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=2.677 | acc=1.0000 | 4930.9 samples/s | 77.0 steps/s
[Step=9150 Epoch=17.8] | Loss=0.01982 | Reg=0.00203 | L2-Norm=14.232 | L2-Norm(final)=2.680 | acc=1.0000 | 4906.9 samples/s | 76.7 steps/s
[Step=9200 Epoch=17.9] | Loss=0.01957 | Reg=0.00203 | L2-Norm=14.237 | L2-Norm(final)=2.683 | acc=0.9531 | 4855.1 samples/s | 75.9 steps/s
[Step=9250 Epoch=18.0] | Loss=0.01932 | Reg=0.00203 | L2-Norm=14.241 | L2-Norm(final)=2.686 | acc=1.0000 | 4884.6 samples/s | 76.3 steps/s
[Step=9300 Epoch=18.1] | Loss=0.01902 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=2.688 | acc=0.9688 | 5935.9 samples/s | 92.7 steps/s
[Step=9350 Epoch=18.2] | Loss=0.01840 | Reg=0.00203 | L2-Norm=14.248 | L2-Norm(final)=2.690 | acc=1.0000 | 2061.7 samples/s | 32.2 steps/s
[Step=9400 Epoch=18.3] | Loss=0.01768 | Reg=0.00203 | L2-Norm=14.252 | L2-Norm(final)=2.692 | acc=0.9844 | 4967.5 samples/s | 77.6 steps/s
[Step=9450 Epoch=18.4] | Loss=0.01739 | Reg=0.00203 | L2-Norm=14.256 | L2-Norm(final)=2.695 | acc=0.9688 | 4936.0 samples/s | 77.1 steps/s
[Step=9500 Epoch=18.5] | Loss=0.01688 | Reg=0.00203 | L2-Norm=14.259 | L2-Norm(final)=2.697 | acc=0.9844 | 4972.0 samples/s | 77.7 steps/s
[Step=9550 Epoch=18.6] | Loss=0.01659 | Reg=0.00203 | L2-Norm=14.262 | L2-Norm(final)=2.700 | acc=0.9688 | 4990.8 samples/s | 78.0 steps/s
[Step=9600 Epoch=18.7] | Loss=0.01622 | Reg=0.00204 | L2-Norm=14.266 | L2-Norm(final)=2.702 | acc=1.0000 | 4975.3 samples/s | 77.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step9600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=8801 Epoch=33.9] | Loss=0.03101 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=2.672 | acc=0.9688 | 4926.7 samples/s | 77.0 steps/s
[Step=8850 Epoch=34.1] | Loss=0.00622 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=2.665 | acc=1.0000 | 4137.5 samples/s | 64.6 steps/s
[Step=8900 Epoch=34.3] | Loss=0.00341 | Reg=0.00203 | L2-Norm=14.242 | L2-Norm(final)=2.665 | acc=1.0000 | 4625.2 samples/s | 72.3 steps/s
[Step=8950 Epoch=34.5] | Loss=0.00245 | Reg=0.00203 | L2-Norm=14.245 | L2-Norm(final)=2.668 | acc=1.0000 | 4686.9 samples/s | 73.2 steps/s
[Step=9000 Epoch=34.6] | Loss=0.00186 | Reg=0.00203 | L2-Norm=14.244 | L2-Norm(final)=2.670 | acc=1.0000 | 4600.1 samples/s | 71.9 steps/s
[Step=9050 Epoch=34.8] | Loss=0.00149 | Reg=0.00203 | L2-Norm=14.240 | L2-Norm(final)=2.672 | acc=1.0000 | 5857.3 samples/s | 91.5 steps/s
[Step=9100 Epoch=35.0] | Loss=0.00125 | Reg=0.00203 | L2-Norm=14.235 | L2-Norm(final)=2.674 | acc=1.0000 | 2018.6 samples/s | 31.5 steps/s
[Step=9150 Epoch=35.2] | Loss=0.00108 | Reg=0.00202 | L2-Norm=14.228 | L2-Norm(final)=2.675 | acc=1.0000 | 4673.0 samples/s | 73.0 steps/s
[Step=9200 Epoch=35.4] | Loss=0.00094 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=2.676 | acc=1.0000 | 4702.7 samples/s | 73.5 steps/s
[Step=9250 Epoch=35.6] | Loss=0.00084 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=2.678 | acc=1.0000 | 4662.6 samples/s | 72.9 steps/s
[Step=9300 Epoch=35.8] | Loss=0.00076 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=2.678 | acc=1.0000 | 5153.9 samples/s | 80.5 steps/s
[Step=9350 Epoch=36.0] | Loss=0.00069 | Reg=0.00202 | L2-Norm=14.198 | L2-Norm(final)=2.679 | acc=1.0000 | 2118.5 samples/s | 33.1 steps/s
[Step=9400 Epoch=36.2] | Loss=0.00063 | Reg=0.00201 | L2-Norm=14.190 | L2-Norm(final)=2.680 | acc=1.0000 | 4700.0 samples/s | 73.4 steps/s
[Step=9450 Epoch=36.4] | Loss=0.00059 | Reg=0.00201 | L2-Norm=14.181 | L2-Norm(final)=2.681 | acc=1.0000 | 4657.6 samples/s | 72.8 steps/s
[Step=9500 Epoch=36.6] | Loss=0.00055 | Reg=0.00201 | L2-Norm=14.172 | L2-Norm(final)=2.681 | acc=1.0000 | 4611.5 samples/s | 72.1 steps/s
[Step=9550 Epoch=36.8] | Loss=0.00051 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=2.682 | acc=1.0000 | 4683.2 samples/s | 73.2 steps/s
[Step=9600 Epoch=37.0] | Loss=0.00048 | Reg=0.00200 | L2-Norm=14.155 | L2-Norm(final)=2.683 | acc=1.0000 | 2238.1 samples/s | 35.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.49595 | acc=0.7368 | tpr=0.6180 | fpr=0.0052 | 4488.1 samples/s | 17.5 steps/s
Avg test loss: 0.49723, Avg test acc: 0.73403, Avg tpr: 0.61561, Avg fpr: 0.00551, total FA: 43

Testing server on iccad2012
[Step=  50] | Loss=0.30339 | acc=0.8955 | tpr=0.9558 | fpr=0.1055 | 4507.0 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.31052 | acc=0.8954 | tpr=0.9680 | fpr=0.1060 | 8583.3 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.31762 | acc=0.8953 | tpr=0.9697 | fpr=0.1061 | 8527.3 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.32133 | acc=0.8946 | tpr=0.9727 | fpr=0.1068 | 8462.9 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.31877 | acc=0.8949 | tpr=0.9747 | fpr=0.1065 | 8608.4 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.32197 | acc=0.8942 | tpr=0.9745 | fpr=0.1073 | 8334.3 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.32152 | acc=0.8946 | tpr=0.9750 | fpr=0.1069 | 8984.0 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.32356 | acc=0.8942 | tpr=0.9737 | fpr=0.1072 | 8414.8 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.32763 | acc=0.8939 | tpr=0.9727 | fpr=0.1076 | 8411.0 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.32731 | acc=0.8937 | tpr=0.9736 | fpr=0.1078 | 8348.9 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.32551 | acc=0.8941 | tpr=0.9741 | fpr=0.1074 | 15269.9 samples/s | 59.6 steps/s
Avg test loss: 0.32522, Avg test acc: 0.89413, Avg tpr: 0.97425, Avg fpr: 0.10733, total FA: 14902

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=9601 Epoch=18.7] | Loss=0.59656 | Reg=0.00199 | L2-Norm=14.118 | L2-Norm(final)=2.692 | acc=0.6719 | 4037.3 samples/s | 63.1 steps/s
[Step=9650 Epoch=18.8] | Loss=0.05335 | Reg=0.00200 | L2-Norm=14.140 | L2-Norm(final)=2.670 | acc=0.9688 | 4666.0 samples/s | 72.9 steps/s
[Step=9700 Epoch=18.9] | Loss=0.03743 | Reg=0.00200 | L2-Norm=14.153 | L2-Norm(final)=2.669 | acc=1.0000 | 4867.2 samples/s | 76.1 steps/s
[Step=9750 Epoch=19.0] | Loss=0.03080 | Reg=0.00201 | L2-Norm=14.162 | L2-Norm(final)=2.672 | acc=0.9375 | 4864.4 samples/s | 76.0 steps/s
[Step=9800 Epoch=19.1] | Loss=0.02732 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=2.676 | acc=0.9688 | 4908.0 samples/s | 76.7 steps/s
[Step=9850 Epoch=19.2] | Loss=0.02548 | Reg=0.00201 | L2-Norm=14.177 | L2-Norm(final)=2.680 | acc=0.9844 | 4855.1 samples/s | 75.9 steps/s
[Step=9900 Epoch=19.3] | Loss=0.02395 | Reg=0.00201 | L2-Norm=14.183 | L2-Norm(final)=2.683 | acc=1.0000 | 4909.7 samples/s | 76.7 steps/s
[Step=9950 Epoch=19.4] | Loss=0.02290 | Reg=0.00201 | L2-Norm=14.188 | L2-Norm(final)=2.686 | acc=1.0000 | 5028.6 samples/s | 78.6 steps/s
[Step=10000 Epoch=19.5] | Loss=0.02230 | Reg=0.00201 | L2-Norm=14.193 | L2-Norm(final)=2.689 | acc=1.0000 | 4941.8 samples/s | 77.2 steps/s
[Step=10050 Epoch=19.6] | Loss=0.02129 | Reg=0.00202 | L2-Norm=14.197 | L2-Norm(final)=2.692 | acc=1.0000 | 5015.5 samples/s | 78.4 steps/s
[Step=10100 Epoch=19.7] | Loss=0.02021 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=2.695 | acc=1.0000 | 6057.3 samples/s | 94.6 steps/s
[Step=10150 Epoch=19.8] | Loss=0.01924 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=2.699 | acc=0.9844 | 2138.3 samples/s | 33.4 steps/s
[Step=10200 Epoch=19.9] | Loss=0.01852 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=2.702 | acc=1.0000 | 4866.3 samples/s | 76.0 steps/s
[Step=10250 Epoch=20.0] | Loss=0.01805 | Reg=0.00202 | L2-Norm=14.214 | L2-Norm(final)=2.706 | acc=1.0000 | 4818.1 samples/s | 75.3 steps/s
[Step=10300 Epoch=20.1] | Loss=0.01782 | Reg=0.00202 | L2-Norm=14.218 | L2-Norm(final)=2.709 | acc=0.9844 | 4800.8 samples/s | 75.0 steps/s
[Step=10350 Epoch=20.2] | Loss=0.01731 | Reg=0.00202 | L2-Norm=14.221 | L2-Norm(final)=2.712 | acc=1.0000 | 4889.9 samples/s | 76.4 steps/s
[Step=10400 Epoch=20.3] | Loss=0.01694 | Reg=0.00202 | L2-Norm=14.225 | L2-Norm(final)=2.715 | acc=0.9688 | 4899.2 samples/s | 76.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step10400.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=8801 Epoch=17.2] | Loss=0.33335 | Reg=0.00199 | L2-Norm=14.118 | L2-Norm(final)=2.693 | acc=0.8125 | 4487.3 samples/s | 70.1 steps/s
[Step=8850 Epoch=17.3] | Loss=0.04793 | Reg=0.00200 | L2-Norm=14.151 | L2-Norm(final)=2.675 | acc=0.9844 | 4543.7 samples/s | 71.0 steps/s
[Step=8900 Epoch=17.4] | Loss=0.03136 | Reg=0.00201 | L2-Norm=14.166 | L2-Norm(final)=2.676 | acc=0.9844 | 4743.7 samples/s | 74.1 steps/s
[Step=8950 Epoch=17.5] | Loss=0.02637 | Reg=0.00201 | L2-Norm=14.175 | L2-Norm(final)=2.680 | acc=0.9688 | 4771.4 samples/s | 74.6 steps/s
[Step=9000 Epoch=17.6] | Loss=0.02419 | Reg=0.00201 | L2-Norm=14.183 | L2-Norm(final)=2.684 | acc=0.9844 | 4813.0 samples/s | 75.2 steps/s
[Step=9050 Epoch=17.7] | Loss=0.02251 | Reg=0.00201 | L2-Norm=14.190 | L2-Norm(final)=2.686 | acc=1.0000 | 4792.3 samples/s | 74.9 steps/s
[Step=9100 Epoch=17.8] | Loss=0.02094 | Reg=0.00202 | L2-Norm=14.196 | L2-Norm(final)=2.690 | acc=1.0000 | 4842.6 samples/s | 75.7 steps/s
[Step=9150 Epoch=17.9] | Loss=0.02015 | Reg=0.00202 | L2-Norm=14.201 | L2-Norm(final)=2.692 | acc=0.9844 | 5010.7 samples/s | 78.3 steps/s
[Step=9200 Epoch=18.0] | Loss=0.01956 | Reg=0.00202 | L2-Norm=14.206 | L2-Norm(final)=2.695 | acc=0.9844 | 4988.0 samples/s | 77.9 steps/s
[Step=9250 Epoch=18.1] | Loss=0.01915 | Reg=0.00202 | L2-Norm=14.210 | L2-Norm(final)=2.698 | acc=0.9688 | 4993.4 samples/s | 78.0 steps/s
[Step=9300 Epoch=18.2] | Loss=0.01878 | Reg=0.00202 | L2-Norm=14.215 | L2-Norm(final)=2.700 | acc=0.9844 | 6061.6 samples/s | 94.7 steps/s
[Step=9350 Epoch=18.3] | Loss=0.01827 | Reg=0.00202 | L2-Norm=14.219 | L2-Norm(final)=2.703 | acc=1.0000 | 2118.4 samples/s | 33.1 steps/s
[Step=9400 Epoch=18.4] | Loss=0.01764 | Reg=0.00202 | L2-Norm=14.223 | L2-Norm(final)=2.706 | acc=1.0000 | 4841.1 samples/s | 75.6 steps/s
[Step=9450 Epoch=18.5] | Loss=0.01707 | Reg=0.00202 | L2-Norm=14.226 | L2-Norm(final)=2.709 | acc=0.9844 | 4814.5 samples/s | 75.2 steps/s
[Step=9500 Epoch=18.6] | Loss=0.01653 | Reg=0.00202 | L2-Norm=14.230 | L2-Norm(final)=2.712 | acc=1.0000 | 4945.8 samples/s | 77.3 steps/s
[Step=9550 Epoch=18.7] | Loss=0.01607 | Reg=0.00203 | L2-Norm=14.233 | L2-Norm(final)=2.715 | acc=1.0000 | 4966.6 samples/s | 77.6 steps/s
[Step=9600 Epoch=18.8] | Loss=0.01579 | Reg=0.00203 | L2-Norm=14.237 | L2-Norm(final)=2.718 | acc=1.0000 | 4962.1 samples/s | 77.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42894 | acc=0.7673 | tpr=0.6629 | fpr=0.0059 | 4494.3 samples/s | 17.6 steps/s
Avg test loss: 0.43019, Avg test acc: 0.76456, Avg tpr: 0.66078, Avg fpr: 0.00718, total FA: 56

Testing server on iccad2012
[Step=  50] | Loss=0.33645 | acc=0.8862 | tpr=0.9646 | fpr=0.1152 | 4504.2 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.34346 | acc=0.8867 | tpr=0.9744 | fpr=0.1149 | 9025.2 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.35132 | acc=0.8859 | tpr=0.9741 | fpr=0.1158 | 8007.1 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.35536 | acc=0.8855 | tpr=0.9760 | fpr=0.1161 | 8450.1 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.35289 | acc=0.8860 | tpr=0.9782 | fpr=0.1157 | 9053.4 samples/s | 35.4 steps/s
[Step= 300] | Loss=0.35639 | acc=0.8850 | tpr=0.9782 | fpr=0.1167 | 7989.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.35583 | acc=0.8853 | tpr=0.9781 | fpr=0.1164 | 8689.9 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.35817 | acc=0.8852 | tpr=0.9770 | fpr=0.1165 | 8363.5 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.36240 | acc=0.8847 | tpr=0.9757 | fpr=0.1170 | 8365.3 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.36195 | acc=0.8845 | tpr=0.9762 | fpr=0.1171 | 8549.2 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.35997 | acc=0.8848 | tpr=0.9769 | fpr=0.1168 | 15114.7 samples/s | 59.0 steps/s
Avg test loss: 0.35960, Avg test acc: 0.88491, Avg tpr: 0.97702, Avg fpr: 0.11677, total FA: 16213

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=10401 Epoch=20.3] | Loss=0.32925 | Reg=0.00198 | L2-Norm=14.061 | L2-Norm(final)=2.719 | acc=0.8281 | 4209.5 samples/s | 65.8 steps/s
[Step=10450 Epoch=20.4] | Loss=0.04270 | Reg=0.00198 | L2-Norm=14.085 | L2-Norm(final)=2.706 | acc=0.9844 | 4848.9 samples/s | 75.8 steps/s
[Step=10500 Epoch=20.5] | Loss=0.02926 | Reg=0.00199 | L2-Norm=14.098 | L2-Norm(final)=2.707 | acc=1.0000 | 4888.0 samples/s | 76.4 steps/s
[Step=10550 Epoch=20.6] | Loss=0.02609 | Reg=0.00199 | L2-Norm=14.107 | L2-Norm(final)=2.710 | acc=0.9844 | 4930.1 samples/s | 77.0 steps/s
[Step=10600 Epoch=20.7] | Loss=0.02384 | Reg=0.00199 | L2-Norm=14.114 | L2-Norm(final)=2.714 | acc=1.0000 | 5020.6 samples/s | 78.4 steps/s
[Step=10650 Epoch=20.8] | Loss=0.02176 | Reg=0.00199 | L2-Norm=14.119 | L2-Norm(final)=2.717 | acc=1.0000 | 4813.2 samples/s | 75.2 steps/s
[Step=10700 Epoch=20.9] | Loss=0.02101 | Reg=0.00200 | L2-Norm=14.125 | L2-Norm(final)=2.720 | acc=1.0000 | 4907.2 samples/s | 76.7 steps/s
[Step=10750 Epoch=21.0] | Loss=0.02020 | Reg=0.00200 | L2-Norm=14.130 | L2-Norm(final)=2.723 | acc=1.0000 | 4928.8 samples/s | 77.0 steps/s
[Step=10800 Epoch=21.1] | Loss=0.01951 | Reg=0.00200 | L2-Norm=14.135 | L2-Norm(final)=2.726 | acc=1.0000 | 4914.3 samples/s | 76.8 steps/s
[Step=10850 Epoch=21.2] | Loss=0.01905 | Reg=0.00200 | L2-Norm=14.139 | L2-Norm(final)=2.729 | acc=1.0000 | 4805.4 samples/s | 75.1 steps/s
[Step=10900 Epoch=21.3] | Loss=0.01867 | Reg=0.00200 | L2-Norm=14.142 | L2-Norm(final)=2.731 | acc=1.0000 | 5960.9 samples/s | 93.1 steps/s
[Step=10950 Epoch=21.4] | Loss=0.01798 | Reg=0.00200 | L2-Norm=14.146 | L2-Norm(final)=2.733 | acc=1.0000 | 2105.9 samples/s | 32.9 steps/s
[Step=11000 Epoch=21.5] | Loss=0.01750 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=2.736 | acc=0.9688 | 4813.4 samples/s | 75.2 steps/s
[Step=11050 Epoch=21.6] | Loss=0.01689 | Reg=0.00200 | L2-Norm=14.154 | L2-Norm(final)=2.739 | acc=0.9844 | 4895.9 samples/s | 76.5 steps/s
[Step=11100 Epoch=21.6] | Loss=0.01652 | Reg=0.00200 | L2-Norm=14.157 | L2-Norm(final)=2.741 | acc=0.9844 | 4932.4 samples/s | 77.1 steps/s
[Step=11150 Epoch=21.7] | Loss=0.01598 | Reg=0.00201 | L2-Norm=14.161 | L2-Norm(final)=2.744 | acc=1.0000 | 4994.5 samples/s | 78.0 steps/s
[Step=11200 Epoch=21.8] | Loss=0.01576 | Reg=0.00201 | L2-Norm=14.164 | L2-Norm(final)=2.747 | acc=1.0000 | 4924.2 samples/s | 76.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step11200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=9601 Epoch=18.8] | Loss=0.27082 | Reg=0.00198 | L2-Norm=14.061 | L2-Norm(final)=2.719 | acc=0.8125 | 4086.7 samples/s | 63.9 steps/s
[Step=9650 Epoch=18.9] | Loss=0.04905 | Reg=0.00199 | L2-Norm=14.094 | L2-Norm(final)=2.701 | acc=1.0000 | 4950.2 samples/s | 77.3 steps/s
[Step=9700 Epoch=19.0] | Loss=0.03281 | Reg=0.00199 | L2-Norm=14.109 | L2-Norm(final)=2.701 | acc=1.0000 | 4856.0 samples/s | 75.9 steps/s
[Step=9750 Epoch=19.1] | Loss=0.02710 | Reg=0.00199 | L2-Norm=14.119 | L2-Norm(final)=2.706 | acc=0.9844 | 4843.3 samples/s | 75.7 steps/s
[Step=9800 Epoch=19.2] | Loss=0.02476 | Reg=0.00200 | L2-Norm=14.126 | L2-Norm(final)=2.709 | acc=0.9844 | 4834.8 samples/s | 75.5 steps/s
[Step=9850 Epoch=19.3] | Loss=0.02285 | Reg=0.00200 | L2-Norm=14.132 | L2-Norm(final)=2.713 | acc=1.0000 | 4846.3 samples/s | 75.7 steps/s
[Step=9900 Epoch=19.4] | Loss=0.02119 | Reg=0.00200 | L2-Norm=14.139 | L2-Norm(final)=2.717 | acc=1.0000 | 4858.3 samples/s | 75.9 steps/s
[Step=9950 Epoch=19.5] | Loss=0.02083 | Reg=0.00200 | L2-Norm=14.145 | L2-Norm(final)=2.721 | acc=0.9688 | 4947.7 samples/s | 77.3 steps/s
[Step=10000 Epoch=19.5] | Loss=0.02014 | Reg=0.00200 | L2-Norm=14.150 | L2-Norm(final)=2.724 | acc=1.0000 | 4905.5 samples/s | 76.6 steps/s
[Step=10050 Epoch=19.6] | Loss=0.01974 | Reg=0.00200 | L2-Norm=14.154 | L2-Norm(final)=2.726 | acc=1.0000 | 4786.1 samples/s | 74.8 steps/s
[Step=10100 Epoch=19.7] | Loss=0.01931 | Reg=0.00200 | L2-Norm=14.158 | L2-Norm(final)=2.728 | acc=1.0000 | 6064.3 samples/s | 94.8 steps/s
[Step=10150 Epoch=19.8] | Loss=0.01869 | Reg=0.00201 | L2-Norm=14.162 | L2-Norm(final)=2.730 | acc=1.0000 | 2144.0 samples/s | 33.5 steps/s
[Step=10200 Epoch=19.9] | Loss=0.01788 | Reg=0.00201 | L2-Norm=14.166 | L2-Norm(final)=2.733 | acc=0.9688 | 4945.5 samples/s | 77.3 steps/s
[Step=10250 Epoch=20.0] | Loss=0.01709 | Reg=0.00201 | L2-Norm=14.170 | L2-Norm(final)=2.736 | acc=0.9844 | 4822.8 samples/s | 75.4 steps/s
[Step=10300 Epoch=20.1] | Loss=0.01688 | Reg=0.00201 | L2-Norm=14.174 | L2-Norm(final)=2.738 | acc=0.9844 | 4893.6 samples/s | 76.5 steps/s
[Step=10350 Epoch=20.2] | Loss=0.01697 | Reg=0.00201 | L2-Norm=14.177 | L2-Norm(final)=2.740 | acc=0.9844 | 4842.6 samples/s | 75.7 steps/s
[Step=10400 Epoch=20.3] | Loss=0.01676 | Reg=0.00201 | L2-Norm=14.180 | L2-Norm(final)=2.742 | acc=0.9844 | 4954.0 samples/s | 77.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42168 | acc=0.7692 | tpr=0.6658 | fpr=0.0062 | 4313.1 samples/s | 16.8 steps/s
Avg test loss: 0.42312, Avg test acc: 0.76641, Avg tpr: 0.66358, Avg fpr: 0.00743, total FA: 58

Testing server on iccad2012
[Step=  50] | Loss=0.33316 | acc=0.8852 | tpr=0.9646 | fpr=0.1162 | 4490.9 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.33953 | acc=0.8868 | tpr=0.9744 | fpr=0.1148 | 8379.3 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.34709 | acc=0.8862 | tpr=0.9741 | fpr=0.1154 | 8856.5 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.35086 | acc=0.8859 | tpr=0.9760 | fpr=0.1157 | 8287.5 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.34847 | acc=0.8865 | tpr=0.9790 | fpr=0.1152 | 9212.9 samples/s | 36.0 steps/s
[Step= 300] | Loss=0.35192 | acc=0.8859 | tpr=0.9789 | fpr=0.1158 | 7879.7 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.35121 | acc=0.8864 | tpr=0.9787 | fpr=0.1153 | 8455.0 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.35358 | acc=0.8859 | tpr=0.9776 | fpr=0.1158 | 8690.6 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.35805 | acc=0.8855 | tpr=0.9761 | fpr=0.1162 | 8594.4 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.35764 | acc=0.8853 | tpr=0.9767 | fpr=0.1163 | 8280.6 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.35568 | acc=0.8857 | tpr=0.9773 | fpr=0.1160 | 15901.4 samples/s | 62.1 steps/s
Avg test loss: 0.35530, Avg test acc: 0.88577, Avg tpr: 0.97742, Avg fpr: 0.11590, total FA: 16092

server round 25/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=10401 Epoch=20.3] | Loss=0.32914 | Reg=0.00197 | L2-Norm=14.029 | L2-Norm(final)=2.725 | acc=0.7656 | 4488.0 samples/s | 70.1 steps/s
[Step=10450 Epoch=20.4] | Loss=0.03847 | Reg=0.00198 | L2-Norm=14.056 | L2-Norm(final)=2.713 | acc=0.9531 | 4820.4 samples/s | 75.3 steps/s
[Step=10500 Epoch=20.5] | Loss=0.02783 | Reg=0.00198 | L2-Norm=14.072 | L2-Norm(final)=2.717 | acc=0.9688 | 4854.6 samples/s | 75.9 steps/s
[Step=10550 Epoch=20.6] | Loss=0.02457 | Reg=0.00198 | L2-Norm=14.082 | L2-Norm(final)=2.722 | acc=1.0000 | 4873.7 samples/s | 76.2 steps/s
[Step=10600 Epoch=20.7] | Loss=0.02220 | Reg=0.00199 | L2-Norm=14.089 | L2-Norm(final)=2.726 | acc=0.9844 | 4939.2 samples/s | 77.2 steps/s
[Step=10650 Epoch=20.8] | Loss=0.02087 | Reg=0.00199 | L2-Norm=14.095 | L2-Norm(final)=2.729 | acc=0.9844 | 4989.6 samples/s | 78.0 steps/s
[Step=10700 Epoch=20.9] | Loss=0.01957 | Reg=0.00199 | L2-Norm=14.101 | L2-Norm(final)=2.732 | acc=1.0000 | 4787.5 samples/s | 74.8 steps/s
[Step=10750 Epoch=21.0] | Loss=0.01889 | Reg=0.00199 | L2-Norm=14.105 | L2-Norm(final)=2.736 | acc=0.9531 | 4888.3 samples/s | 76.4 steps/s
[Step=10800 Epoch=21.1] | Loss=0.01836 | Reg=0.00199 | L2-Norm=14.110 | L2-Norm(final)=2.739 | acc=0.9688 | 4869.5 samples/s | 76.1 steps/s
[Step=10850 Epoch=21.2] | Loss=0.01752 | Reg=0.00199 | L2-Norm=14.114 | L2-Norm(final)=2.742 | acc=1.0000 | 4852.8 samples/s | 75.8 steps/s
[Step=10900 Epoch=21.3] | Loss=0.01760 | Reg=0.00199 | L2-Norm=14.119 | L2-Norm(final)=2.745 | acc=0.9844 | 6098.7 samples/s | 95.3 steps/s
[Step=10950 Epoch=21.4] | Loss=0.01676 | Reg=0.00199 | L2-Norm=14.123 | L2-Norm(final)=2.748 | acc=1.0000 | 2132.0 samples/s | 33.3 steps/s
[Step=11000 Epoch=21.5] | Loss=0.01615 | Reg=0.00200 | L2-Norm=14.127 | L2-Norm(final)=2.751 | acc=1.0000 | 4785.7 samples/s | 74.8 steps/s
[Step=11050 Epoch=21.6] | Loss=0.01572 | Reg=0.00200 | L2-Norm=14.130 | L2-Norm(final)=2.754 | acc=0.9844 | 4851.2 samples/s | 75.8 steps/s
[Step=11100 Epoch=21.7] | Loss=0.01543 | Reg=0.00200 | L2-Norm=14.134 | L2-Norm(final)=2.757 | acc=0.9844 | 4836.5 samples/s | 75.6 steps/s
[Step=11150 Epoch=21.8] | Loss=0.01528 | Reg=0.00200 | L2-Norm=14.137 | L2-Norm(final)=2.760 | acc=0.9688 | 4771.8 samples/s | 74.6 steps/s
[Step=11200 Epoch=21.9] | Loss=0.01518 | Reg=0.00200 | L2-Norm=14.141 | L2-Norm(final)=2.763 | acc=1.0000 | 4906.7 samples/s | 76.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step11200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00025, len=1
[Step=9601 Epoch=37.0] | Loss=0.08889 | Reg=0.00197 | L2-Norm=14.029 | L2-Norm(final)=2.725 | acc=0.9531 | 4585.7 samples/s | 71.7 steps/s
[Step=9650 Epoch=37.1] | Loss=0.00446 | Reg=0.00198 | L2-Norm=14.074 | L2-Norm(final)=2.725 | acc=1.0000 | 4265.7 samples/s | 66.7 steps/s
[Step=9700 Epoch=37.3] | Loss=0.00241 | Reg=0.00198 | L2-Norm=14.083 | L2-Norm(final)=2.725 | acc=1.0000 | 4596.6 samples/s | 71.8 steps/s
[Step=9750 Epoch=37.5] | Loss=0.00164 | Reg=0.00198 | L2-Norm=14.083 | L2-Norm(final)=2.727 | acc=1.0000 | 4692.2 samples/s | 73.3 steps/s
[Step=9800 Epoch=37.7] | Loss=0.00126 | Reg=0.00198 | L2-Norm=14.080 | L2-Norm(final)=2.729 | acc=1.0000 | 4617.6 samples/s | 72.1 steps/s
[Step=9850 Epoch=37.9] | Loss=0.00102 | Reg=0.00198 | L2-Norm=14.076 | L2-Norm(final)=2.731 | acc=1.0000 | 5968.0 samples/s | 93.2 steps/s
[Step=9900 Epoch=38.1] | Loss=0.00085 | Reg=0.00198 | L2-Norm=14.070 | L2-Norm(final)=2.733 | acc=1.0000 | 2027.1 samples/s | 31.7 steps/s
[Step=9950 Epoch=38.3] | Loss=0.00074 | Reg=0.00198 | L2-Norm=14.064 | L2-Norm(final)=2.734 | acc=1.0000 | 4623.0 samples/s | 72.2 steps/s
[Step=10000 Epoch=38.5] | Loss=0.00065 | Reg=0.00198 | L2-Norm=14.058 | L2-Norm(final)=2.736 | acc=1.0000 | 4717.3 samples/s | 73.7 steps/s
[Step=10050 Epoch=38.7] | Loss=0.00058 | Reg=0.00197 | L2-Norm=14.051 | L2-Norm(final)=2.737 | acc=1.0000 | 4652.3 samples/s | 72.7 steps/s
[Step=10100 Epoch=38.9] | Loss=0.00052 | Reg=0.00197 | L2-Norm=14.043 | L2-Norm(final)=2.738 | acc=1.0000 | 5311.4 samples/s | 83.0 steps/s
[Step=10150 Epoch=39.1] | Loss=0.00048 | Reg=0.00197 | L2-Norm=14.036 | L2-Norm(final)=2.739 | acc=1.0000 | 2123.1 samples/s | 33.2 steps/s
[Step=10200 Epoch=39.3] | Loss=0.00044 | Reg=0.00197 | L2-Norm=14.028 | L2-Norm(final)=2.740 | acc=1.0000 | 4572.1 samples/s | 71.4 steps/s
[Step=10250 Epoch=39.5] | Loss=0.00040 | Reg=0.00197 | L2-Norm=14.020 | L2-Norm(final)=2.740 | acc=1.0000 | 4651.7 samples/s | 72.7 steps/s
[Step=10300 Epoch=39.6] | Loss=0.00038 | Reg=0.00196 | L2-Norm=14.012 | L2-Norm(final)=2.741 | acc=1.0000 | 4665.8 samples/s | 72.9 steps/s
[Step=10350 Epoch=39.8] | Loss=0.00035 | Reg=0.00196 | L2-Norm=14.004 | L2-Norm(final)=2.742 | acc=1.0000 | 4694.5 samples/s | 73.4 steps/s
[Step=10400 Epoch=40.0] | Loss=0.00033 | Reg=0.00196 | L2-Norm=13.996 | L2-Norm(final)=2.743 | acc=1.0000 | 2215.1 samples/s | 34.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35770 | acc=0.7986 | tpr=0.7095 | fpr=0.0079 | 4526.5 samples/s | 17.7 steps/s
Avg test loss: 0.35894, Avg test acc: 0.79782, Avg tpr: 0.71015, Avg fpr: 0.00936, total FA: 73

Testing server on iccad2012
[Step=  50] | Loss=0.36517 | acc=0.8732 | tpr=0.9646 | fpr=0.1284 | 4613.4 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.37160 | acc=0.8757 | tpr=0.9723 | fpr=0.1261 | 8469.1 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.37963 | acc=0.8749 | tpr=0.9726 | fpr=0.1269 | 8264.2 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.38407 | acc=0.8750 | tpr=0.9749 | fpr=0.1268 | 8613.0 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.38140 | acc=0.8749 | tpr=0.9782 | fpr=0.1270 | 8514.6 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.38500 | acc=0.8741 | tpr=0.9782 | fpr=0.1278 | 8598.2 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.38459 | acc=0.8745 | tpr=0.9781 | fpr=0.1274 | 8583.3 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.38701 | acc=0.8741 | tpr=0.9776 | fpr=0.1278 | 8688.7 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.39148 | acc=0.8737 | tpr=0.9761 | fpr=0.1281 | 8429.1 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.39098 | acc=0.8734 | tpr=0.9767 | fpr=0.1284 | 8225.4 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.38904 | acc=0.8737 | tpr=0.9773 | fpr=0.1282 | 15988.4 samples/s | 62.5 steps/s
Avg test loss: 0.38862, Avg test acc: 0.87373, Avg tpr: 0.97742, Avg fpr: 0.12815, total FA: 17794

server round 26/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=11201 Epoch=21.8] | Loss=0.22676 | Reg=0.00196 | L2-Norm=13.987 | L2-Norm(final)=2.748 | acc=0.8438 | 4335.1 samples/s | 67.7 steps/s
[Step=11250 Epoch=21.9] | Loss=0.03347 | Reg=0.00196 | L2-Norm=14.013 | L2-Norm(final)=2.743 | acc=1.0000 | 4738.7 samples/s | 74.0 steps/s
[Step=11300 Epoch=22.0] | Loss=0.02442 | Reg=0.00197 | L2-Norm=14.024 | L2-Norm(final)=2.745 | acc=0.9844 | 4870.5 samples/s | 76.1 steps/s
[Step=11350 Epoch=22.1] | Loss=0.02221 | Reg=0.00197 | L2-Norm=14.033 | L2-Norm(final)=2.747 | acc=1.0000 | 4826.0 samples/s | 75.4 steps/s
[Step=11400 Epoch=22.2] | Loss=0.02181 | Reg=0.00197 | L2-Norm=14.039 | L2-Norm(final)=2.750 | acc=0.9688 | 4835.3 samples/s | 75.6 steps/s
[Step=11450 Epoch=22.3] | Loss=0.02047 | Reg=0.00197 | L2-Norm=14.043 | L2-Norm(final)=2.751 | acc=0.9844 | 4946.2 samples/s | 77.3 steps/s
[Step=11500 Epoch=22.4] | Loss=0.01903 | Reg=0.00197 | L2-Norm=14.048 | L2-Norm(final)=2.753 | acc=1.0000 | 4857.4 samples/s | 75.9 steps/s
[Step=11550 Epoch=22.5] | Loss=0.01849 | Reg=0.00197 | L2-Norm=14.052 | L2-Norm(final)=2.756 | acc=0.9688 | 4907.5 samples/s | 76.7 steps/s
[Step=11600 Epoch=22.6] | Loss=0.01832 | Reg=0.00198 | L2-Norm=14.055 | L2-Norm(final)=2.758 | acc=1.0000 | 4954.4 samples/s | 77.4 steps/s
[Step=11650 Epoch=22.7] | Loss=0.01801 | Reg=0.00198 | L2-Norm=14.059 | L2-Norm(final)=2.760 | acc=0.9844 | 5020.7 samples/s | 78.4 steps/s
[Step=11700 Epoch=22.8] | Loss=0.01767 | Reg=0.00198 | L2-Norm=14.063 | L2-Norm(final)=2.763 | acc=1.0000 | 6006.7 samples/s | 93.9 steps/s
[Step=11750 Epoch=22.9] | Loss=0.01680 | Reg=0.00198 | L2-Norm=14.066 | L2-Norm(final)=2.765 | acc=1.0000 | 2108.4 samples/s | 32.9 steps/s
[Step=11800 Epoch=23.0] | Loss=0.01614 | Reg=0.00198 | L2-Norm=14.071 | L2-Norm(final)=2.768 | acc=1.0000 | 4860.4 samples/s | 75.9 steps/s
[Step=11850 Epoch=23.1] | Loss=0.01579 | Reg=0.00198 | L2-Norm=14.074 | L2-Norm(final)=2.771 | acc=0.9688 | 4890.8 samples/s | 76.4 steps/s
[Step=11900 Epoch=23.2] | Loss=0.01571 | Reg=0.00198 | L2-Norm=14.078 | L2-Norm(final)=2.774 | acc=0.9844 | 4835.9 samples/s | 75.6 steps/s
[Step=11950 Epoch=23.3] | Loss=0.01546 | Reg=0.00198 | L2-Norm=14.082 | L2-Norm(final)=2.777 | acc=1.0000 | 5005.7 samples/s | 78.2 steps/s
[Step=12000 Epoch=23.4] | Loss=0.01530 | Reg=0.00198 | L2-Norm=14.085 | L2-Norm(final)=2.779 | acc=0.9844 | 4930.6 samples/s | 77.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=8801 Epoch=33.7] | Loss=0.12085 | Reg=0.00196 | L2-Norm=13.987 | L2-Norm(final)=2.748 | acc=0.9531 | 4284.4 samples/s | 66.9 steps/s
[Step=8850 Epoch=33.9] | Loss=0.00584 | Reg=0.00197 | L2-Norm=14.042 | L2-Norm(final)=2.738 | acc=1.0000 | 4634.8 samples/s | 72.4 steps/s
[Step=8900 Epoch=34.1] | Loss=0.00351 | Reg=0.00198 | L2-Norm=14.061 | L2-Norm(final)=2.734 | acc=1.0000 | 4540.0 samples/s | 70.9 steps/s
[Step=8950 Epoch=34.3] | Loss=0.00241 | Reg=0.00198 | L2-Norm=14.066 | L2-Norm(final)=2.734 | acc=1.0000 | 4593.9 samples/s | 71.8 steps/s
[Step=9000 Epoch=34.5] | Loss=0.00182 | Reg=0.00198 | L2-Norm=14.066 | L2-Norm(final)=2.734 | acc=1.0000 | 4629.6 samples/s | 72.3 steps/s
[Step=9050 Epoch=34.7] | Loss=0.00148 | Reg=0.00198 | L2-Norm=14.063 | L2-Norm(final)=2.735 | acc=1.0000 | 5912.7 samples/s | 92.4 steps/s
[Step=9100 Epoch=34.9] | Loss=0.00124 | Reg=0.00198 | L2-Norm=14.059 | L2-Norm(final)=2.736 | acc=1.0000 | 2025.8 samples/s | 31.7 steps/s
[Step=9150 Epoch=35.1] | Loss=0.00107 | Reg=0.00198 | L2-Norm=14.054 | L2-Norm(final)=2.737 | acc=1.0000 | 4584.4 samples/s | 71.6 steps/s
[Step=9200 Epoch=35.3] | Loss=0.00093 | Reg=0.00197 | L2-Norm=14.048 | L2-Norm(final)=2.738 | acc=1.0000 | 4743.4 samples/s | 74.1 steps/s
[Step=9250 Epoch=35.4] | Loss=0.00083 | Reg=0.00197 | L2-Norm=14.042 | L2-Norm(final)=2.739 | acc=1.0000 | 4737.7 samples/s | 74.0 steps/s
[Step=9300 Epoch=35.6] | Loss=0.00075 | Reg=0.00197 | L2-Norm=14.035 | L2-Norm(final)=2.740 | acc=1.0000 | 5230.7 samples/s | 81.7 steps/s
[Step=9350 Epoch=35.8] | Loss=0.00068 | Reg=0.00197 | L2-Norm=14.028 | L2-Norm(final)=2.740 | acc=1.0000 | 2189.5 samples/s | 34.2 steps/s
[Step=9400 Epoch=36.0] | Loss=0.00063 | Reg=0.00197 | L2-Norm=14.021 | L2-Norm(final)=2.741 | acc=1.0000 | 4622.4 samples/s | 72.2 steps/s
[Step=9450 Epoch=36.2] | Loss=0.00058 | Reg=0.00196 | L2-Norm=14.013 | L2-Norm(final)=2.741 | acc=1.0000 | 4562.3 samples/s | 71.3 steps/s
[Step=9500 Epoch=36.4] | Loss=0.00054 | Reg=0.00196 | L2-Norm=14.006 | L2-Norm(final)=2.742 | acc=1.0000 | 4647.6 samples/s | 72.6 steps/s
[Step=9550 Epoch=36.6] | Loss=0.00050 | Reg=0.00196 | L2-Norm=13.998 | L2-Norm(final)=2.742 | acc=1.0000 | 4658.5 samples/s | 72.8 steps/s
[Step=9600 Epoch=36.8] | Loss=0.00047 | Reg=0.00196 | L2-Norm=13.990 | L2-Norm(final)=2.743 | acc=1.0000 | 2267.7 samples/s | 35.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39571 | acc=0.7845 | tpr=0.6891 | fpr=0.0082 | 4430.8 samples/s | 17.3 steps/s
Avg test loss: 0.39658, Avg test acc: 0.78324, Avg tpr: 0.68887, Avg fpr: 0.00923, total FA: 72

Testing server on iccad2012
[Step=  50] | Loss=0.33963 | acc=0.8909 | tpr=0.9646 | fpr=0.1105 | 4569.3 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.34699 | acc=0.8899 | tpr=0.9765 | fpr=0.1117 | 8422.5 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.35524 | acc=0.8890 | tpr=0.9769 | fpr=0.1127 | 8412.9 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.35913 | acc=0.8887 | tpr=0.9781 | fpr=0.1129 | 9038.5 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.35631 | acc=0.8886 | tpr=0.9808 | fpr=0.1131 | 8240.8 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.35986 | acc=0.8878 | tpr=0.9796 | fpr=0.1139 | 8315.5 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.35980 | acc=0.8883 | tpr=0.9793 | fpr=0.1133 | 9136.1 samples/s | 35.7 steps/s
[Step= 400] | Loss=0.36178 | acc=0.8879 | tpr=0.9787 | fpr=0.1137 | 7720.2 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.36626 | acc=0.8875 | tpr=0.9771 | fpr=0.1141 | 8639.5 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.36595 | acc=0.8874 | tpr=0.9775 | fpr=0.1142 | 8511.3 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.36410 | acc=0.8877 | tpr=0.9785 | fpr=0.1139 | 15300.4 samples/s | 59.8 steps/s
Avg test loss: 0.36371, Avg test acc: 0.88776, Avg tpr: 0.97861, Avg fpr: 0.11389, total FA: 15813

server round 27/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=11201 Epoch=21.9] | Loss=0.14847 | Reg=0.00195 | L2-Norm=13.951 | L2-Norm(final)=2.777 | acc=0.9219 | 4349.9 samples/s | 68.0 steps/s
[Step=11250 Epoch=22.0] | Loss=0.03398 | Reg=0.00195 | L2-Norm=13.976 | L2-Norm(final)=2.769 | acc=0.9844 | 4940.8 samples/s | 77.2 steps/s
[Step=11300 Epoch=22.1] | Loss=0.02490 | Reg=0.00196 | L2-Norm=13.989 | L2-Norm(final)=2.771 | acc=1.0000 | 4949.4 samples/s | 77.3 steps/s
[Step=11350 Epoch=22.2] | Loss=0.02148 | Reg=0.00196 | L2-Norm=13.997 | L2-Norm(final)=2.775 | acc=0.9844 | 4885.2 samples/s | 76.3 steps/s
[Step=11400 Epoch=22.3] | Loss=0.01988 | Reg=0.00196 | L2-Norm=14.005 | L2-Norm(final)=2.779 | acc=0.9688 | 4974.7 samples/s | 77.7 steps/s
[Step=11450 Epoch=22.4] | Loss=0.01868 | Reg=0.00196 | L2-Norm=14.011 | L2-Norm(final)=2.783 | acc=0.9844 | 4889.1 samples/s | 76.4 steps/s
[Step=11500 Epoch=22.5] | Loss=0.01820 | Reg=0.00196 | L2-Norm=14.016 | L2-Norm(final)=2.785 | acc=0.9844 | 4916.2 samples/s | 76.8 steps/s
[Step=11550 Epoch=22.6] | Loss=0.01811 | Reg=0.00197 | L2-Norm=14.021 | L2-Norm(final)=2.787 | acc=0.9844 | 4875.7 samples/s | 76.2 steps/s
[Step=11600 Epoch=22.7] | Loss=0.01784 | Reg=0.00197 | L2-Norm=14.025 | L2-Norm(final)=2.789 | acc=0.9531 | 4963.7 samples/s | 77.6 steps/s
[Step=11650 Epoch=22.8] | Loss=0.01745 | Reg=0.00197 | L2-Norm=14.029 | L2-Norm(final)=2.791 | acc=0.9844 | 4916.0 samples/s | 76.8 steps/s
[Step=11700 Epoch=22.9] | Loss=0.01688 | Reg=0.00197 | L2-Norm=14.033 | L2-Norm(final)=2.793 | acc=1.0000 | 6111.9 samples/s | 95.5 steps/s
[Step=11750 Epoch=23.0] | Loss=0.01615 | Reg=0.00197 | L2-Norm=14.038 | L2-Norm(final)=2.795 | acc=1.0000 | 2117.1 samples/s | 33.1 steps/s
[Step=11800 Epoch=23.1] | Loss=0.01574 | Reg=0.00197 | L2-Norm=14.042 | L2-Norm(final)=2.798 | acc=1.0000 | 4874.2 samples/s | 76.2 steps/s
[Step=11850 Epoch=23.2] | Loss=0.01554 | Reg=0.00197 | L2-Norm=14.047 | L2-Norm(final)=2.801 | acc=0.9844 | 4826.9 samples/s | 75.4 steps/s
[Step=11900 Epoch=23.3] | Loss=0.01519 | Reg=0.00197 | L2-Norm=14.050 | L2-Norm(final)=2.803 | acc=0.9844 | 4851.9 samples/s | 75.8 steps/s
[Step=11950 Epoch=23.4] | Loss=0.01477 | Reg=0.00198 | L2-Norm=14.054 | L2-Norm(final)=2.805 | acc=0.9844 | 4872.8 samples/s | 76.1 steps/s
[Step=12000 Epoch=23.5] | Loss=0.01440 | Reg=0.00198 | L2-Norm=14.057 | L2-Norm(final)=2.808 | acc=1.0000 | 4927.6 samples/s | 77.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step12000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=9601 Epoch=36.8] | Loss=0.03531 | Reg=0.00195 | L2-Norm=13.951 | L2-Norm(final)=2.777 | acc=0.9688 | 4439.5 samples/s | 69.4 steps/s
[Step=9650 Epoch=37.0] | Loss=0.00491 | Reg=0.00197 | L2-Norm=14.022 | L2-Norm(final)=2.780 | acc=1.0000 | 4233.9 samples/s | 66.2 steps/s
[Step=9700 Epoch=37.2] | Loss=0.00249 | Reg=0.00197 | L2-Norm=14.040 | L2-Norm(final)=2.780 | acc=1.0000 | 4527.5 samples/s | 70.7 steps/s
[Step=9750 Epoch=37.4] | Loss=0.00168 | Reg=0.00197 | L2-Norm=14.041 | L2-Norm(final)=2.781 | acc=1.0000 | 4613.1 samples/s | 72.1 steps/s
[Step=9800 Epoch=37.6] | Loss=0.00129 | Reg=0.00197 | L2-Norm=14.039 | L2-Norm(final)=2.782 | acc=1.0000 | 4667.7 samples/s | 72.9 steps/s
[Step=9850 Epoch=37.7] | Loss=0.00104 | Reg=0.00197 | L2-Norm=14.035 | L2-Norm(final)=2.784 | acc=1.0000 | 5933.0 samples/s | 92.7 steps/s
[Step=9900 Epoch=37.9] | Loss=0.00087 | Reg=0.00197 | L2-Norm=14.029 | L2-Norm(final)=2.785 | acc=1.0000 | 2032.5 samples/s | 31.8 steps/s
[Step=9950 Epoch=38.1] | Loss=0.00075 | Reg=0.00197 | L2-Norm=14.023 | L2-Norm(final)=2.786 | acc=1.0000 | 4635.8 samples/s | 72.4 steps/s
[Step=10000 Epoch=38.3] | Loss=0.00066 | Reg=0.00196 | L2-Norm=14.017 | L2-Norm(final)=2.786 | acc=1.0000 | 4576.0 samples/s | 71.5 steps/s
[Step=10050 Epoch=38.5] | Loss=0.00059 | Reg=0.00196 | L2-Norm=14.010 | L2-Norm(final)=2.787 | acc=1.0000 | 4595.1 samples/s | 71.8 steps/s
[Step=10100 Epoch=38.7] | Loss=0.00053 | Reg=0.00196 | L2-Norm=14.002 | L2-Norm(final)=2.788 | acc=1.0000 | 5115.1 samples/s | 79.9 steps/s
[Step=10150 Epoch=38.9] | Loss=0.00048 | Reg=0.00196 | L2-Norm=13.995 | L2-Norm(final)=2.788 | acc=1.0000 | 2066.1 samples/s | 32.3 steps/s
[Step=10200 Epoch=39.1] | Loss=0.00044 | Reg=0.00196 | L2-Norm=13.987 | L2-Norm(final)=2.789 | acc=1.0000 | 4579.3 samples/s | 71.6 steps/s
[Step=10250 Epoch=39.3] | Loss=0.00041 | Reg=0.00195 | L2-Norm=13.979 | L2-Norm(final)=2.789 | acc=1.0000 | 4607.5 samples/s | 72.0 steps/s
[Step=10300 Epoch=39.5] | Loss=0.00038 | Reg=0.00195 | L2-Norm=13.971 | L2-Norm(final)=2.790 | acc=1.0000 | 4600.9 samples/s | 71.9 steps/s
[Step=10350 Epoch=39.7] | Loss=0.00036 | Reg=0.00195 | L2-Norm=13.963 | L2-Norm(final)=2.790 | acc=1.0000 | 4655.7 samples/s | 72.7 steps/s
[Step=10400 Epoch=39.8] | Loss=0.00033 | Reg=0.00195 | L2-Norm=13.955 | L2-Norm(final)=2.791 | acc=1.0000 | 2231.8 samples/s | 34.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.46804 | acc=0.7495 | tpr=0.6372 | fpr=0.0064 | 4582.4 samples/s | 17.9 steps/s
Avg test loss: 0.46837, Avg test acc: 0.74890, Avg tpr: 0.63805, Avg fpr: 0.00731, total FA: 57

Testing server on iccad2012
[Step=  50] | Loss=0.31702 | acc=0.9019 | tpr=0.9646 | fpr=0.0993 | 4533.6 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.32467 | acc=0.9018 | tpr=0.9765 | fpr=0.0996 | 8430.0 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.33353 | acc=0.9003 | tpr=0.9769 | fpr=0.1012 | 8489.0 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.33673 | acc=0.8999 | tpr=0.9792 | fpr=0.1015 | 8704.6 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.33371 | acc=0.9001 | tpr=0.9817 | fpr=0.1013 | 8800.2 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.33693 | acc=0.8993 | tpr=0.9804 | fpr=0.1022 | 7843.6 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.33680 | acc=0.8994 | tpr=0.9800 | fpr=0.1020 | 8788.6 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.33862 | acc=0.8994 | tpr=0.9787 | fpr=0.1021 | 8469.0 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.34315 | acc=0.8988 | tpr=0.9771 | fpr=0.1026 | 8582.2 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.34257 | acc=0.8987 | tpr=0.9775 | fpr=0.1027 | 8119.7 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.34084 | acc=0.8991 | tpr=0.9789 | fpr=0.1023 | 15978.7 samples/s | 62.4 steps/s
Avg test loss: 0.34041, Avg test acc: 0.89919, Avg tpr: 0.97900, Avg fpr: 0.10226, total FA: 14199

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00025, len=1
[Step=12001 Epoch=23.4] | Loss=0.33591 | Reg=0.00194 | L2-Norm=13.923 | L2-Norm(final)=2.801 | acc=0.7812 | 4537.9 samples/s | 70.9 steps/s
[Step=12050 Epoch=23.5] | Loss=0.04282 | Reg=0.00195 | L2-Norm=13.953 | L2-Norm(final)=2.787 | acc=1.0000 | 4626.6 samples/s | 72.3 steps/s
[Step=12100 Epoch=23.6] | Loss=0.03035 | Reg=0.00195 | L2-Norm=13.968 | L2-Norm(final)=2.788 | acc=1.0000 | 4816.8 samples/s | 75.3 steps/s
[Step=12150 Epoch=23.7] | Loss=0.02634 | Reg=0.00195 | L2-Norm=13.976 | L2-Norm(final)=2.790 | acc=1.0000 | 4760.6 samples/s | 74.4 steps/s
[Step=12200 Epoch=23.8] | Loss=0.02317 | Reg=0.00196 | L2-Norm=13.983 | L2-Norm(final)=2.793 | acc=0.9844 | 4879.6 samples/s | 76.2 steps/s
[Step=12250 Epoch=23.9] | Loss=0.02145 | Reg=0.00196 | L2-Norm=13.990 | L2-Norm(final)=2.797 | acc=1.0000 | 4824.8 samples/s | 75.4 steps/s
[Step=12300 Epoch=24.0] | Loss=0.02019 | Reg=0.00196 | L2-Norm=13.995 | L2-Norm(final)=2.800 | acc=1.0000 | 4931.0 samples/s | 77.0 steps/s
[Step=12350 Epoch=24.1] | Loss=0.01892 | Reg=0.00196 | L2-Norm=14.000 | L2-Norm(final)=2.804 | acc=1.0000 | 4951.7 samples/s | 77.4 steps/s
[Step=12400 Epoch=24.2] | Loss=0.01817 | Reg=0.00196 | L2-Norm=14.005 | L2-Norm(final)=2.807 | acc=1.0000 | 4920.7 samples/s | 76.9 steps/s
[Step=12450 Epoch=24.3] | Loss=0.01806 | Reg=0.00196 | L2-Norm=14.010 | L2-Norm(final)=2.810 | acc=1.0000 | 4828.9 samples/s | 75.5 steps/s
[Step=12500 Epoch=24.4] | Loss=0.01775 | Reg=0.00196 | L2-Norm=14.013 | L2-Norm(final)=2.813 | acc=0.9375 | 5841.1 samples/s | 91.3 steps/s
[Step=12550 Epoch=24.5] | Loss=0.01709 | Reg=0.00196 | L2-Norm=14.017 | L2-Norm(final)=2.815 | acc=1.0000 | 2132.0 samples/s | 33.3 steps/s
[Step=12600 Epoch=24.6] | Loss=0.01654 | Reg=0.00197 | L2-Norm=14.020 | L2-Norm(final)=2.818 | acc=0.9844 | 4965.0 samples/s | 77.6 steps/s
[Step=12650 Epoch=24.7] | Loss=0.01621 | Reg=0.00197 | L2-Norm=14.023 | L2-Norm(final)=2.820 | acc=1.0000 | 4923.9 samples/s | 76.9 steps/s
[Step=12700 Epoch=24.8] | Loss=0.01609 | Reg=0.00197 | L2-Norm=14.026 | L2-Norm(final)=2.823 | acc=0.9688 | 4926.2 samples/s | 77.0 steps/s
[Step=12750 Epoch=24.9] | Loss=0.01574 | Reg=0.00197 | L2-Norm=14.029 | L2-Norm(final)=2.824 | acc=1.0000 | 4960.1 samples/s | 77.5 steps/s
[Step=12800 Epoch=25.0] | Loss=0.01523 | Reg=0.00197 | L2-Norm=14.031 | L2-Norm(final)=2.826 | acc=0.9844 | 4789.7 samples/s | 74.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step12800.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=12001 Epoch=23.5] | Loss=0.34317 | Reg=0.00194 | L2-Norm=13.923 | L2-Norm(final)=2.801 | acc=0.8125 | 4353.0 samples/s | 68.0 steps/s
[Step=12050 Epoch=23.6] | Loss=0.03848 | Reg=0.00195 | L2-Norm=13.960 | L2-Norm(final)=2.790 | acc=0.9844 | 5018.9 samples/s | 78.4 steps/s
[Step=12100 Epoch=23.7] | Loss=0.02778 | Reg=0.00195 | L2-Norm=13.974 | L2-Norm(final)=2.789 | acc=1.0000 | 4969.5 samples/s | 77.6 steps/s
[Step=12150 Epoch=23.8] | Loss=0.02446 | Reg=0.00195 | L2-Norm=13.982 | L2-Norm(final)=2.792 | acc=0.9531 | 4869.3 samples/s | 76.1 steps/s
[Step=12200 Epoch=23.9] | Loss=0.02210 | Reg=0.00196 | L2-Norm=13.988 | L2-Norm(final)=2.794 | acc=0.9688 | 4869.3 samples/s | 76.1 steps/s
[Step=12250 Epoch=23.9] | Loss=0.02003 | Reg=0.00196 | L2-Norm=13.993 | L2-Norm(final)=2.798 | acc=0.9844 | 4872.3 samples/s | 76.1 steps/s
[Step=12300 Epoch=24.0] | Loss=0.01909 | Reg=0.00196 | L2-Norm=13.998 | L2-Norm(final)=2.801 | acc=1.0000 | 4944.9 samples/s | 77.3 steps/s
[Step=12350 Epoch=24.1] | Loss=0.01816 | Reg=0.00196 | L2-Norm=14.004 | L2-Norm(final)=2.804 | acc=1.0000 | 4868.3 samples/s | 76.1 steps/s
[Step=12400 Epoch=24.2] | Loss=0.01741 | Reg=0.00196 | L2-Norm=14.009 | L2-Norm(final)=2.807 | acc=0.9844 | 4950.0 samples/s | 77.3 steps/s
[Step=12450 Epoch=24.3] | Loss=0.01703 | Reg=0.00196 | L2-Norm=14.014 | L2-Norm(final)=2.810 | acc=0.9844 | 4911.8 samples/s | 76.7 steps/s
[Step=12500 Epoch=24.4] | Loss=0.01705 | Reg=0.00197 | L2-Norm=14.018 | L2-Norm(final)=2.812 | acc=0.9844 | 6103.8 samples/s | 95.4 steps/s
[Step=12550 Epoch=24.5] | Loss=0.01655 | Reg=0.00197 | L2-Norm=14.022 | L2-Norm(final)=2.814 | acc=0.9844 | 2136.5 samples/s | 33.4 steps/s
[Step=12600 Epoch=24.6] | Loss=0.01607 | Reg=0.00197 | L2-Norm=14.026 | L2-Norm(final)=2.816 | acc=0.9844 | 4950.0 samples/s | 77.3 steps/s
[Step=12650 Epoch=24.7] | Loss=0.01569 | Reg=0.00197 | L2-Norm=14.029 | L2-Norm(final)=2.819 | acc=1.0000 | 4903.8 samples/s | 76.6 steps/s
[Step=12700 Epoch=24.8] | Loss=0.01534 | Reg=0.00197 | L2-Norm=14.033 | L2-Norm(final)=2.821 | acc=0.9844 | 4903.9 samples/s | 76.6 steps/s
[Step=12750 Epoch=24.9] | Loss=0.01526 | Reg=0.00197 | L2-Norm=14.036 | L2-Norm(final)=2.823 | acc=0.9844 | 4950.7 samples/s | 77.4 steps/s
[Step=12800 Epoch=25.0] | Loss=0.01506 | Reg=0.00197 | L2-Norm=14.039 | L2-Norm(final)=2.825 | acc=1.0000 | 4946.3 samples/s | 77.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.47174 | acc=0.7483 | tpr=0.6350 | fpr=0.0057 | 4506.4 samples/s | 17.6 steps/s
Avg test loss: 0.47164, Avg test acc: 0.74746, Avg tpr: 0.63572, Avg fpr: 0.00679, total FA: 53

Testing server on iccad2012
[Step=  50] | Loss=0.32044 | acc=0.9033 | tpr=0.9646 | fpr=0.0978 | 4594.3 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.32822 | acc=0.9032 | tpr=0.9765 | fpr=0.0981 | 8321.8 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.33721 | acc=0.9016 | tpr=0.9784 | fpr=0.0998 | 8773.3 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.34063 | acc=0.9014 | tpr=0.9792 | fpr=0.1000 | 8721.7 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.33743 | acc=0.9011 | tpr=0.9817 | fpr=0.1003 | 8138.8 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.34085 | acc=0.9004 | tpr=0.9804 | fpr=0.1010 | 8395.9 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.34050 | acc=0.9006 | tpr=0.9806 | fpr=0.1008 | 8573.5 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.34254 | acc=0.9003 | tpr=0.9781 | fpr=0.1011 | 8482.9 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.34707 | acc=0.8997 | tpr=0.9766 | fpr=0.1016 | 8480.1 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.34647 | acc=0.8996 | tpr=0.9771 | fpr=0.1018 | 8226.7 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.34473 | acc=0.8999 | tpr=0.9785 | fpr=0.1015 | 16003.7 samples/s | 62.5 steps/s
Avg test loss: 0.34428, Avg test acc: 0.89995, Avg tpr: 0.97861, Avg fpr: 0.10148, total FA: 14090

server round 29/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00025, len=1
[Step=12801 Epoch=25.0] | Loss=0.19259 | Reg=0.00193 | L2-Norm=13.903 | L2-Norm(final)=2.815 | acc=0.8750 | 4601.1 samples/s | 71.9 steps/s
[Step=12850 Epoch=25.1] | Loss=0.03867 | Reg=0.00194 | L2-Norm=13.936 | L2-Norm(final)=2.803 | acc=0.9844 | 4761.3 samples/s | 74.4 steps/s
[Step=12900 Epoch=25.2] | Loss=0.02660 | Reg=0.00195 | L2-Norm=13.950 | L2-Norm(final)=2.806 | acc=0.9844 | 4867.5 samples/s | 76.1 steps/s
[Step=12950 Epoch=25.3] | Loss=0.02271 | Reg=0.00195 | L2-Norm=13.960 | L2-Norm(final)=2.810 | acc=0.9844 | 4934.6 samples/s | 77.1 steps/s
[Step=13000 Epoch=25.4] | Loss=0.02031 | Reg=0.00195 | L2-Norm=13.967 | L2-Norm(final)=2.813 | acc=1.0000 | 4929.1 samples/s | 77.0 steps/s
[Step=13050 Epoch=25.5] | Loss=0.01877 | Reg=0.00195 | L2-Norm=13.972 | L2-Norm(final)=2.817 | acc=1.0000 | 4849.9 samples/s | 75.8 steps/s
[Step=13100 Epoch=25.6] | Loss=0.01796 | Reg=0.00195 | L2-Norm=13.976 | L2-Norm(final)=2.820 | acc=0.9844 | 4892.5 samples/s | 76.4 steps/s
[Step=13150 Epoch=25.7] | Loss=0.01721 | Reg=0.00195 | L2-Norm=13.981 | L2-Norm(final)=2.823 | acc=1.0000 | 4918.1 samples/s | 76.8 steps/s
[Step=13200 Epoch=25.8] | Loss=0.01661 | Reg=0.00196 | L2-Norm=13.986 | L2-Norm(final)=2.827 | acc=0.9844 | 4933.8 samples/s | 77.1 steps/s
[Step=13250 Epoch=25.9] | Loss=0.01607 | Reg=0.00196 | L2-Norm=13.990 | L2-Norm(final)=2.830 | acc=1.0000 | 4892.5 samples/s | 76.4 steps/s
[Step=13300 Epoch=26.0] | Loss=0.01624 | Reg=0.00196 | L2-Norm=13.995 | L2-Norm(final)=2.833 | acc=0.9844 | 6154.4 samples/s | 96.2 steps/s
[Step=13350 Epoch=26.1] | Loss=0.01592 | Reg=0.00196 | L2-Norm=13.999 | L2-Norm(final)=2.836 | acc=0.9844 | 2126.5 samples/s | 33.2 steps/s
[Step=13400 Epoch=26.2] | Loss=0.01547 | Reg=0.00196 | L2-Norm=14.002 | L2-Norm(final)=2.838 | acc=1.0000 | 4778.2 samples/s | 74.7 steps/s
[Step=13450 Epoch=26.3] | Loss=0.01491 | Reg=0.00196 | L2-Norm=14.006 | L2-Norm(final)=2.841 | acc=1.0000 | 4753.9 samples/s | 74.3 steps/s
[Step=13500 Epoch=26.4] | Loss=0.01478 | Reg=0.00196 | L2-Norm=14.010 | L2-Norm(final)=2.844 | acc=0.9688 | 4888.3 samples/s | 76.4 steps/s
[Step=13550 Epoch=26.5] | Loss=0.01455 | Reg=0.00196 | L2-Norm=14.013 | L2-Norm(final)=2.846 | acc=1.0000 | 4943.0 samples/s | 77.2 steps/s
[Step=13600 Epoch=26.6] | Loss=0.01435 | Reg=0.00196 | L2-Norm=14.016 | L2-Norm(final)=2.848 | acc=1.0000 | 4923.3 samples/s | 76.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step13600.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00025, len=1
[Step=10401 Epoch=39.9] | Loss=0.00138 | Reg=0.00193 | L2-Norm=13.903 | L2-Norm(final)=2.816 | acc=1.0000 | 4446.7 samples/s | 69.5 steps/s
[Step=10450 Epoch=40.0] | Loss=0.00774 | Reg=0.00195 | L2-Norm=13.951 | L2-Norm(final)=2.810 | acc=1.0000 | 4373.4 samples/s | 68.3 steps/s
[Step=10500 Epoch=40.2] | Loss=0.00400 | Reg=0.00195 | L2-Norm=13.966 | L2-Norm(final)=2.808 | acc=1.0000 | 4751.8 samples/s | 74.2 steps/s
[Step=10550 Epoch=40.4] | Loss=0.00271 | Reg=0.00195 | L2-Norm=13.968 | L2-Norm(final)=2.809 | acc=1.0000 | 4569.5 samples/s | 71.4 steps/s
[Step=10600 Epoch=40.6] | Loss=0.00207 | Reg=0.00195 | L2-Norm=13.967 | L2-Norm(final)=2.811 | acc=1.0000 | 4708.5 samples/s | 73.6 steps/s
[Step=10650 Epoch=40.8] | Loss=0.00168 | Reg=0.00195 | L2-Norm=13.964 | L2-Norm(final)=2.813 | acc=1.0000 | 5844.2 samples/s | 91.3 steps/s
[Step=10700 Epoch=41.0] | Loss=0.00141 | Reg=0.00195 | L2-Norm=13.961 | L2-Norm(final)=2.814 | acc=1.0000 | 2070.4 samples/s | 32.4 steps/s
[Step=10750 Epoch=41.2] | Loss=0.00121 | Reg=0.00195 | L2-Norm=13.956 | L2-Norm(final)=2.816 | acc=1.0000 | 4573.7 samples/s | 71.5 steps/s
[Step=10800 Epoch=41.4] | Loss=0.00106 | Reg=0.00195 | L2-Norm=13.951 | L2-Norm(final)=2.817 | acc=1.0000 | 4779.7 samples/s | 74.7 steps/s
[Step=10850 Epoch=41.6] | Loss=0.00095 | Reg=0.00194 | L2-Norm=13.946 | L2-Norm(final)=2.819 | acc=1.0000 | 4627.2 samples/s | 72.3 steps/s
[Step=10900 Epoch=41.8] | Loss=0.00085 | Reg=0.00194 | L2-Norm=13.940 | L2-Norm(final)=2.820 | acc=1.0000 | 5114.4 samples/s | 79.9 steps/s
[Step=10950 Epoch=42.0] | Loss=0.00078 | Reg=0.00194 | L2-Norm=13.934 | L2-Norm(final)=2.821 | acc=1.0000 | 2148.9 samples/s | 33.6 steps/s
[Step=11000 Epoch=42.1] | Loss=0.00071 | Reg=0.00194 | L2-Norm=13.927 | L2-Norm(final)=2.822 | acc=1.0000 | 4697.0 samples/s | 73.4 steps/s
[Step=11050 Epoch=42.3] | Loss=0.00066 | Reg=0.00194 | L2-Norm=13.921 | L2-Norm(final)=2.823 | acc=1.0000 | 4579.4 samples/s | 71.6 steps/s
[Step=11100 Epoch=42.5] | Loss=0.00061 | Reg=0.00194 | L2-Norm=13.914 | L2-Norm(final)=2.823 | acc=1.0000 | 4716.1 samples/s | 73.7 steps/s
[Step=11150 Epoch=42.7] | Loss=0.00057 | Reg=0.00193 | L2-Norm=13.907 | L2-Norm(final)=2.824 | acc=1.0000 | 4579.5 samples/s | 71.6 steps/s
[Step=11200 Epoch=42.9] | Loss=0.00054 | Reg=0.00193 | L2-Norm=13.901 | L2-Norm(final)=2.825 | acc=1.0000 | 2232.4 samples/s | 34.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41034 | acc=0.7784 | tpr=0.6798 | fpr=0.0077 | 4535.4 samples/s | 17.7 steps/s
Avg test loss: 0.41002, Avg test acc: 0.77839, Avg tpr: 0.68135, Avg fpr: 0.00820, total FA: 64

Testing server on iccad2012
[Step=  50] | Loss=0.33797 | acc=0.8925 | tpr=0.9602 | fpr=0.1087 | 4578.6 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.34437 | acc=0.8934 | tpr=0.9723 | fpr=0.1081 | 8342.2 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.35297 | acc=0.8924 | tpr=0.9769 | fpr=0.1091 | 8741.1 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.35663 | acc=0.8921 | tpr=0.9792 | fpr=0.1095 | 8411.1 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.35318 | acc=0.8922 | tpr=0.9817 | fpr=0.1094 | 8741.1 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.35659 | acc=0.8916 | tpr=0.9811 | fpr=0.1100 | 8658.1 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.35652 | acc=0.8920 | tpr=0.9812 | fpr=0.1096 | 8384.4 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.35857 | acc=0.8916 | tpr=0.9798 | fpr=0.1100 | 8422.0 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.36312 | acc=0.8912 | tpr=0.9781 | fpr=0.1104 | 8697.4 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.36251 | acc=0.8911 | tpr=0.9789 | fpr=0.1105 | 5806.3 samples/s | 22.7 steps/s
[Step= 550] | Loss=0.36062 | acc=0.8914 | tpr=0.9793 | fpr=0.1101 | 16115.3 samples/s | 63.0 steps/s
Avg test loss: 0.36023, Avg test acc: 0.89151, Avg tpr: 0.97940, Avg fpr: 0.11009, total FA: 15286

server round 30/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=12801 Epoch=25.0] | Loss=0.21276 | Reg=0.00193 | L2-Norm=13.889 | L2-Norm(final)=2.832 | acc=0.8750 | 4916.3 samples/s | 76.8 steps/s
[Step=12850 Epoch=25.1] | Loss=0.04204 | Reg=0.00193 | L2-Norm=13.901 | L2-Norm(final)=2.826 | acc=0.9688 | 4337.7 samples/s | 67.8 steps/s
[Step=12900 Epoch=25.2] | Loss=0.02816 | Reg=0.00193 | L2-Norm=13.908 | L2-Norm(final)=2.827 | acc=0.9531 | 4856.1 samples/s | 75.9 steps/s
[Step=12950 Epoch=25.3] | Loss=0.02238 | Reg=0.00194 | L2-Norm=13.912 | L2-Norm(final)=2.831 | acc=1.0000 | 4876.5 samples/s | 76.2 steps/s
[Step=13000 Epoch=25.4] | Loss=0.02005 | Reg=0.00194 | L2-Norm=13.916 | L2-Norm(final)=2.834 | acc=1.0000 | 4859.9 samples/s | 75.9 steps/s
[Step=13050 Epoch=25.5] | Loss=0.01897 | Reg=0.00194 | L2-Norm=13.919 | L2-Norm(final)=2.837 | acc=0.9375 | 4862.6 samples/s | 76.0 steps/s
[Step=13100 Epoch=25.6] | Loss=0.01773 | Reg=0.00194 | L2-Norm=13.922 | L2-Norm(final)=2.839 | acc=0.9844 | 4855.1 samples/s | 75.9 steps/s
[Step=13150 Epoch=25.6] | Loss=0.01682 | Reg=0.00194 | L2-Norm=13.924 | L2-Norm(final)=2.842 | acc=1.0000 | 4931.3 samples/s | 77.1 steps/s
[Step=13200 Epoch=25.7] | Loss=0.01600 | Reg=0.00194 | L2-Norm=13.927 | L2-Norm(final)=2.845 | acc=1.0000 | 4845.8 samples/s | 75.7 steps/s
[Step=13250 Epoch=25.8] | Loss=0.01538 | Reg=0.00194 | L2-Norm=13.929 | L2-Norm(final)=2.847 | acc=1.0000 | 4890.0 samples/s | 76.4 steps/s
[Step=13300 Epoch=25.9] | Loss=0.01480 | Reg=0.00194 | L2-Norm=13.931 | L2-Norm(final)=2.849 | acc=1.0000 | 5974.1 samples/s | 93.3 steps/s
[Step=13350 Epoch=26.0] | Loss=0.01422 | Reg=0.00194 | L2-Norm=13.934 | L2-Norm(final)=2.852 | acc=1.0000 | 2107.8 samples/s | 32.9 steps/s
[Step=13400 Epoch=26.1] | Loss=0.01372 | Reg=0.00194 | L2-Norm=13.936 | L2-Norm(final)=2.854 | acc=1.0000 | 4880.8 samples/s | 76.3 steps/s
[Step=13450 Epoch=26.2] | Loss=0.01327 | Reg=0.00194 | L2-Norm=13.938 | L2-Norm(final)=2.857 | acc=1.0000 | 4772.9 samples/s | 74.6 steps/s
[Step=13500 Epoch=26.3] | Loss=0.01289 | Reg=0.00194 | L2-Norm=13.940 | L2-Norm(final)=2.859 | acc=1.0000 | 4862.7 samples/s | 76.0 steps/s
[Step=13550 Epoch=26.4] | Loss=0.01245 | Reg=0.00194 | L2-Norm=13.942 | L2-Norm(final)=2.861 | acc=0.9688 | 4954.6 samples/s | 77.4 steps/s
[Step=13600 Epoch=26.5] | Loss=0.01233 | Reg=0.00194 | L2-Norm=13.944 | L2-Norm(final)=2.863 | acc=0.9688 | 4757.7 samples/s | 74.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step13600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=10401 Epoch=40.0] | Loss=0.05092 | Reg=0.00193 | L2-Norm=13.889 | L2-Norm(final)=2.832 | acc=0.9531 | 4348.8 samples/s | 68.0 steps/s
[Step=10450 Epoch=40.2] | Loss=0.00385 | Reg=0.00193 | L2-Norm=13.910 | L2-Norm(final)=2.833 | acc=1.0000 | 4466.7 samples/s | 69.8 steps/s
[Step=10500 Epoch=40.4] | Loss=0.00200 | Reg=0.00194 | L2-Norm=13.914 | L2-Norm(final)=2.835 | acc=1.0000 | 4633.0 samples/s | 72.4 steps/s
[Step=10550 Epoch=40.6] | Loss=0.00135 | Reg=0.00194 | L2-Norm=13.913 | L2-Norm(final)=2.836 | acc=1.0000 | 4709.1 samples/s | 73.6 steps/s
[Step=10600 Epoch=40.8] | Loss=0.00102 | Reg=0.00194 | L2-Norm=13.910 | L2-Norm(final)=2.837 | acc=1.0000 | 4659.2 samples/s | 72.8 steps/s
[Step=10650 Epoch=41.0] | Loss=0.00083 | Reg=0.00193 | L2-Norm=13.908 | L2-Norm(final)=2.837 | acc=1.0000 | 6061.0 samples/s | 94.7 steps/s
[Step=10700 Epoch=41.2] | Loss=0.00069 | Reg=0.00193 | L2-Norm=13.904 | L2-Norm(final)=2.838 | acc=1.0000 | 2044.2 samples/s | 31.9 steps/s
[Step=10750 Epoch=41.4] | Loss=0.00060 | Reg=0.00193 | L2-Norm=13.901 | L2-Norm(final)=2.839 | acc=1.0000 | 4675.7 samples/s | 73.1 steps/s
[Step=10800 Epoch=41.6] | Loss=0.00053 | Reg=0.00193 | L2-Norm=13.898 | L2-Norm(final)=2.839 | acc=1.0000 | 4585.4 samples/s | 71.6 steps/s
[Step=10850 Epoch=41.8] | Loss=0.00047 | Reg=0.00193 | L2-Norm=13.894 | L2-Norm(final)=2.840 | acc=1.0000 | 4595.9 samples/s | 71.8 steps/s
[Step=10900 Epoch=42.0] | Loss=0.00042 | Reg=0.00193 | L2-Norm=13.890 | L2-Norm(final)=2.840 | acc=1.0000 | 5343.7 samples/s | 83.5 steps/s
[Step=10950 Epoch=42.2] | Loss=0.00039 | Reg=0.00193 | L2-Norm=13.886 | L2-Norm(final)=2.841 | acc=1.0000 | 2169.3 samples/s | 33.9 steps/s
[Step=11000 Epoch=42.3] | Loss=0.00036 | Reg=0.00193 | L2-Norm=13.882 | L2-Norm(final)=2.841 | acc=1.0000 | 4522.6 samples/s | 70.7 steps/s
[Step=11050 Epoch=42.5] | Loss=0.00033 | Reg=0.00193 | L2-Norm=13.878 | L2-Norm(final)=2.842 | acc=1.0000 | 4664.5 samples/s | 72.9 steps/s
[Step=11100 Epoch=42.7] | Loss=0.00031 | Reg=0.00192 | L2-Norm=13.874 | L2-Norm(final)=2.842 | acc=1.0000 | 4655.3 samples/s | 72.7 steps/s
[Step=11150 Epoch=42.9] | Loss=0.00029 | Reg=0.00192 | L2-Norm=13.870 | L2-Norm(final)=2.843 | acc=1.0000 | 4639.2 samples/s | 72.5 steps/s
[Step=11200 Epoch=43.1] | Loss=0.00027 | Reg=0.00192 | L2-Norm=13.865 | L2-Norm(final)=2.843 | acc=1.0000 | 2224.4 samples/s | 34.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39625 | acc=0.7859 | tpr=0.6907 | fpr=0.0072 | 4506.1 samples/s | 17.6 steps/s
Avg test loss: 0.39665, Avg test acc: 0.78556, Avg tpr: 0.69173, Avg fpr: 0.00808, total FA: 63

Testing server on iccad2012
[Step=  50] | Loss=0.34372 | acc=0.8923 | tpr=0.9646 | fpr=0.1090 | 4479.9 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.35092 | acc=0.8915 | tpr=0.9744 | fpr=0.1100 | 9027.6 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.35907 | acc=0.8910 | tpr=0.9769 | fpr=0.1106 | 8326.6 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.36249 | acc=0.8909 | tpr=0.9792 | fpr=0.1107 | 8441.3 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.35926 | acc=0.8911 | tpr=0.9808 | fpr=0.1105 | 8567.3 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.36261 | acc=0.8906 | tpr=0.9811 | fpr=0.1111 | 8608.7 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.36230 | acc=0.8912 | tpr=0.9812 | fpr=0.1105 | 7482.6 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.36417 | acc=0.8907 | tpr=0.9792 | fpr=0.1109 | 5674.3 samples/s | 22.2 steps/s
[Step= 450] | Loss=0.36875 | acc=0.8903 | tpr=0.9776 | fpr=0.1113 | 8506.3 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.36816 | acc=0.8902 | tpr=0.9784 | fpr=0.1114 | 8354.6 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.36625 | acc=0.8906 | tpr=0.9789 | fpr=0.1110 | 15845.9 samples/s | 61.9 steps/s
Avg test loss: 0.36588, Avg test acc: 0.89064, Avg tpr: 0.97900, Avg fpr: 0.11097, total FA: 15408

server round 31/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=13601 Epoch=26.6] | Loss=0.12771 | Reg=0.00192 | L2-Norm=13.860 | L2-Norm(final)=2.865 | acc=0.9062 | 4477.8 samples/s | 70.0 steps/s
[Step=13650 Epoch=26.7] | Loss=0.03555 | Reg=0.00193 | L2-Norm=13.875 | L2-Norm(final)=2.860 | acc=1.0000 | 4591.3 samples/s | 71.7 steps/s
[Step=13700 Epoch=26.8] | Loss=0.02533 | Reg=0.00193 | L2-Norm=13.881 | L2-Norm(final)=2.862 | acc=0.9844 | 4888.2 samples/s | 76.4 steps/s
[Step=13750 Epoch=26.9] | Loss=0.02092 | Reg=0.00193 | L2-Norm=13.885 | L2-Norm(final)=2.865 | acc=0.9844 | 4975.4 samples/s | 77.7 steps/s
[Step=13800 Epoch=27.0] | Loss=0.01839 | Reg=0.00193 | L2-Norm=13.889 | L2-Norm(final)=2.867 | acc=1.0000 | 4960.2 samples/s | 77.5 steps/s
[Step=13850 Epoch=27.1] | Loss=0.01759 | Reg=0.00193 | L2-Norm=13.891 | L2-Norm(final)=2.870 | acc=0.9688 | 4933.9 samples/s | 77.1 steps/s
[Step=13900 Epoch=27.2] | Loss=0.01643 | Reg=0.00193 | L2-Norm=13.894 | L2-Norm(final)=2.872 | acc=0.9844 | 4955.5 samples/s | 77.4 steps/s
[Step=13950 Epoch=27.3] | Loss=0.01521 | Reg=0.00193 | L2-Norm=13.896 | L2-Norm(final)=2.874 | acc=1.0000 | 4930.2 samples/s | 77.0 steps/s
[Step=14000 Epoch=27.4] | Loss=0.01459 | Reg=0.00193 | L2-Norm=13.899 | L2-Norm(final)=2.877 | acc=0.9844 | 4920.5 samples/s | 76.9 steps/s
[Step=14050 Epoch=27.5] | Loss=0.01419 | Reg=0.00193 | L2-Norm=13.901 | L2-Norm(final)=2.879 | acc=1.0000 | 4914.0 samples/s | 76.8 steps/s
[Step=14100 Epoch=27.6] | Loss=0.01365 | Reg=0.00193 | L2-Norm=13.903 | L2-Norm(final)=2.881 | acc=0.9844 | 6036.5 samples/s | 94.3 steps/s
[Step=14150 Epoch=27.7] | Loss=0.01319 | Reg=0.00193 | L2-Norm=13.905 | L2-Norm(final)=2.883 | acc=0.9844 | 2136.0 samples/s | 33.4 steps/s
[Step=14200 Epoch=27.8] | Loss=0.01285 | Reg=0.00193 | L2-Norm=13.907 | L2-Norm(final)=2.886 | acc=1.0000 | 4810.7 samples/s | 75.2 steps/s
[Step=14250 Epoch=27.9] | Loss=0.01239 | Reg=0.00193 | L2-Norm=13.909 | L2-Norm(final)=2.888 | acc=1.0000 | 4835.8 samples/s | 75.6 steps/s
[Step=14300 Epoch=28.0] | Loss=0.01192 | Reg=0.00194 | L2-Norm=13.911 | L2-Norm(final)=2.890 | acc=1.0000 | 4877.4 samples/s | 76.2 steps/s
[Step=14350 Epoch=28.1] | Loss=0.01169 | Reg=0.00194 | L2-Norm=13.912 | L2-Norm(final)=2.892 | acc=0.9844 | 4892.5 samples/s | 76.4 steps/s
[Step=14400 Epoch=28.2] | Loss=0.01151 | Reg=0.00194 | L2-Norm=13.914 | L2-Norm(final)=2.894 | acc=1.0000 | 4916.0 samples/s | 76.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step14400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=11201 Epoch=43.1] | Loss=0.01682 | Reg=0.00192 | L2-Norm=13.860 | L2-Norm(final)=2.865 | acc=0.9844 | 4279.9 samples/s | 66.9 steps/s
[Step=11250 Epoch=43.3] | Loss=0.00267 | Reg=0.00193 | L2-Norm=13.882 | L2-Norm(final)=2.869 | acc=1.0000 | 4278.1 samples/s | 66.8 steps/s
[Step=11300 Epoch=43.5] | Loss=0.00142 | Reg=0.00193 | L2-Norm=13.886 | L2-Norm(final)=2.871 | acc=1.0000 | 4407.2 samples/s | 68.9 steps/s
[Step=11350 Epoch=43.7] | Loss=0.00097 | Reg=0.00193 | L2-Norm=13.885 | L2-Norm(final)=2.872 | acc=1.0000 | 4410.7 samples/s | 68.9 steps/s
[Step=11400 Epoch=43.9] | Loss=0.00074 | Reg=0.00193 | L2-Norm=13.883 | L2-Norm(final)=2.873 | acc=1.0000 | 4433.8 samples/s | 69.3 steps/s
[Step=11450 Epoch=44.1] | Loss=0.00060 | Reg=0.00193 | L2-Norm=13.881 | L2-Norm(final)=2.874 | acc=1.0000 | 5864.6 samples/s | 91.6 steps/s
[Step=11500 Epoch=44.3] | Loss=0.00050 | Reg=0.00193 | L2-Norm=13.877 | L2-Norm(final)=2.875 | acc=1.0000 | 1881.1 samples/s | 29.4 steps/s
[Step=11550 Epoch=44.5] | Loss=0.00043 | Reg=0.00192 | L2-Norm=13.874 | L2-Norm(final)=2.876 | acc=1.0000 | 4404.5 samples/s | 68.8 steps/s
[Step=11600 Epoch=44.7] | Loss=0.00038 | Reg=0.00192 | L2-Norm=13.870 | L2-Norm(final)=2.877 | acc=1.0000 | 4619.7 samples/s | 72.2 steps/s
[Step=11650 Epoch=44.8] | Loss=0.00034 | Reg=0.00192 | L2-Norm=13.867 | L2-Norm(final)=2.877 | acc=1.0000 | 4010.3 samples/s | 62.7 steps/s
[Step=11700 Epoch=45.0] | Loss=0.00031 | Reg=0.00192 | L2-Norm=13.863 | L2-Norm(final)=2.878 | acc=1.0000 | 4574.5 samples/s | 71.5 steps/s
[Step=11750 Epoch=45.2] | Loss=0.00028 | Reg=0.00192 | L2-Norm=13.859 | L2-Norm(final)=2.878 | acc=1.0000 | 1979.7 samples/s | 30.9 steps/s
[Step=11800 Epoch=45.4] | Loss=0.00026 | Reg=0.00192 | L2-Norm=13.854 | L2-Norm(final)=2.879 | acc=1.0000 | 4582.7 samples/s | 71.6 steps/s
[Step=11850 Epoch=45.6] | Loss=0.00024 | Reg=0.00192 | L2-Norm=13.850 | L2-Norm(final)=2.879 | acc=1.0000 | 4713.6 samples/s | 73.7 steps/s
[Step=11900 Epoch=45.8] | Loss=0.00023 | Reg=0.00192 | L2-Norm=13.846 | L2-Norm(final)=2.880 | acc=1.0000 | 4623.5 samples/s | 72.2 steps/s
[Step=11950 Epoch=46.0] | Loss=0.00021 | Reg=0.00192 | L2-Norm=13.841 | L2-Norm(final)=2.880 | acc=1.0000 | 4759.8 samples/s | 74.4 steps/s
[Step=12000 Epoch=46.2] | Loss=0.00020 | Reg=0.00191 | L2-Norm=13.837 | L2-Norm(final)=2.881 | acc=1.0000 | 2225.2 samples/s | 34.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40960 | acc=0.7880 | tpr=0.6934 | fpr=0.0067 | 4527.7 samples/s | 17.7 steps/s
Avg test loss: 0.41000, Avg test acc: 0.78760, Avg tpr: 0.69447, Avg fpr: 0.00756, total FA: 59

Testing server on iccad2012
[Step=  50] | Loss=0.36041 | acc=0.8912 | tpr=0.9646 | fpr=0.1101 | 4528.6 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.36719 | acc=0.8923 | tpr=0.9744 | fpr=0.1092 | 8429.0 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.37603 | acc=0.8916 | tpr=0.9784 | fpr=0.1100 | 8881.5 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.37993 | acc=0.8914 | tpr=0.9803 | fpr=0.1102 | 8573.9 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.37644 | acc=0.8916 | tpr=0.9825 | fpr=0.1101 | 5284.2 samples/s | 20.6 steps/s
[Step= 300] | Loss=0.38031 | acc=0.8909 | tpr=0.9818 | fpr=0.1108 | 8465.8 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.38028 | acc=0.8911 | tpr=0.9812 | fpr=0.1105 | 8641.3 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.38211 | acc=0.8906 | tpr=0.9792 | fpr=0.1110 | 8296.5 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.38704 | acc=0.8902 | tpr=0.9776 | fpr=0.1114 | 7933.3 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.38645 | acc=0.8902 | tpr=0.9784 | fpr=0.1114 | 8370.7 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.38446 | acc=0.8905 | tpr=0.9789 | fpr=0.1111 | 15440.2 samples/s | 60.3 steps/s
Avg test loss: 0.38407, Avg test acc: 0.89049, Avg tpr: 0.97900, Avg fpr: 0.11111, total FA: 15428

server round 32/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=13601 Epoch=26.5] | Loss=0.14414 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=2.886 | acc=0.9062 | 4477.6 samples/s | 70.0 steps/s
[Step=13650 Epoch=26.6] | Loss=0.04313 | Reg=0.00192 | L2-Norm=13.845 | L2-Norm(final)=2.879 | acc=0.9844 | 4715.1 samples/s | 73.7 steps/s
[Step=13700 Epoch=26.7] | Loss=0.02791 | Reg=0.00192 | L2-Norm=13.852 | L2-Norm(final)=2.878 | acc=1.0000 | 4896.8 samples/s | 76.5 steps/s
[Step=13750 Epoch=26.8] | Loss=0.02331 | Reg=0.00192 | L2-Norm=13.856 | L2-Norm(final)=2.879 | acc=1.0000 | 5059.2 samples/s | 79.0 steps/s
[Step=13800 Epoch=26.9] | Loss=0.02038 | Reg=0.00192 | L2-Norm=13.859 | L2-Norm(final)=2.881 | acc=0.9688 | 4913.7 samples/s | 76.8 steps/s
[Step=13850 Epoch=27.0] | Loss=0.01853 | Reg=0.00192 | L2-Norm=13.863 | L2-Norm(final)=2.884 | acc=0.9844 | 4940.6 samples/s | 77.2 steps/s
[Step=13900 Epoch=27.1] | Loss=0.01743 | Reg=0.00192 | L2-Norm=13.866 | L2-Norm(final)=2.887 | acc=0.9844 | 4925.1 samples/s | 77.0 steps/s
[Step=13950 Epoch=27.2] | Loss=0.01665 | Reg=0.00192 | L2-Norm=13.868 | L2-Norm(final)=2.889 | acc=1.0000 | 4894.8 samples/s | 76.5 steps/s
[Step=14000 Epoch=27.3] | Loss=0.01585 | Reg=0.00192 | L2-Norm=13.871 | L2-Norm(final)=2.891 | acc=0.9844 | 4861.0 samples/s | 76.0 steps/s
[Step=14050 Epoch=27.4] | Loss=0.01510 | Reg=0.00192 | L2-Norm=13.873 | L2-Norm(final)=2.894 | acc=0.9844 | 5002.2 samples/s | 78.2 steps/s
[Step=14100 Epoch=27.5] | Loss=0.01451 | Reg=0.00193 | L2-Norm=13.876 | L2-Norm(final)=2.896 | acc=1.0000 | 5918.5 samples/s | 92.5 steps/s
[Step=14150 Epoch=27.6] | Loss=0.01394 | Reg=0.00193 | L2-Norm=13.878 | L2-Norm(final)=2.899 | acc=1.0000 | 2030.4 samples/s | 31.7 steps/s
[Step=14200 Epoch=27.7] | Loss=0.01335 | Reg=0.00193 | L2-Norm=13.880 | L2-Norm(final)=2.901 | acc=0.9688 | 4880.0 samples/s | 76.2 steps/s
[Step=14250 Epoch=27.8] | Loss=0.01315 | Reg=0.00193 | L2-Norm=13.883 | L2-Norm(final)=2.904 | acc=0.9844 | 4885.3 samples/s | 76.3 steps/s
[Step=14300 Epoch=27.9] | Loss=0.01292 | Reg=0.00193 | L2-Norm=13.885 | L2-Norm(final)=2.906 | acc=1.0000 | 4917.8 samples/s | 76.8 steps/s
[Step=14350 Epoch=28.0] | Loss=0.01262 | Reg=0.00193 | L2-Norm=13.886 | L2-Norm(final)=2.908 | acc=1.0000 | 4869.8 samples/s | 76.1 steps/s
[Step=14400 Epoch=28.1] | Loss=0.01237 | Reg=0.00193 | L2-Norm=13.888 | L2-Norm(final)=2.910 | acc=1.0000 | 4871.9 samples/s | 76.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step14400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=11201 Epoch=42.9] | Loss=0.10777 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=2.885 | acc=0.9688 | 4432.9 samples/s | 69.3 steps/s
[Step=11250 Epoch=43.1] | Loss=0.00466 | Reg=0.00192 | L2-Norm=13.850 | L2-Norm(final)=2.883 | acc=1.0000 | 3891.3 samples/s | 60.8 steps/s
[Step=11300 Epoch=43.3] | Loss=0.00241 | Reg=0.00192 | L2-Norm=13.853 | L2-Norm(final)=2.884 | acc=1.0000 | 4631.6 samples/s | 72.4 steps/s
[Step=11350 Epoch=43.5] | Loss=0.00163 | Reg=0.00192 | L2-Norm=13.852 | L2-Norm(final)=2.885 | acc=1.0000 | 4669.6 samples/s | 73.0 steps/s
[Step=11400 Epoch=43.7] | Loss=0.00126 | Reg=0.00192 | L2-Norm=13.850 | L2-Norm(final)=2.886 | acc=1.0000 | 4573.4 samples/s | 71.5 steps/s
[Step=11450 Epoch=43.9] | Loss=0.00101 | Reg=0.00192 | L2-Norm=13.848 | L2-Norm(final)=2.886 | acc=1.0000 | 5821.7 samples/s | 91.0 steps/s
[Step=11500 Epoch=44.1] | Loss=0.00085 | Reg=0.00192 | L2-Norm=13.845 | L2-Norm(final)=2.887 | acc=1.0000 | 2066.2 samples/s | 32.3 steps/s
[Step=11550 Epoch=44.3] | Loss=0.00073 | Reg=0.00192 | L2-Norm=13.842 | L2-Norm(final)=2.888 | acc=1.0000 | 4643.8 samples/s | 72.6 steps/s
[Step=11600 Epoch=44.4] | Loss=0.00064 | Reg=0.00192 | L2-Norm=13.839 | L2-Norm(final)=2.888 | acc=1.0000 | 4735.9 samples/s | 74.0 steps/s
[Step=11650 Epoch=44.6] | Loss=0.00057 | Reg=0.00191 | L2-Norm=13.836 | L2-Norm(final)=2.888 | acc=1.0000 | 4736.0 samples/s | 74.0 steps/s
[Step=11700 Epoch=44.8] | Loss=0.00051 | Reg=0.00191 | L2-Norm=13.833 | L2-Norm(final)=2.889 | acc=1.0000 | 5207.7 samples/s | 81.4 steps/s
[Step=11750 Epoch=45.0] | Loss=0.00047 | Reg=0.00191 | L2-Norm=13.829 | L2-Norm(final)=2.889 | acc=1.0000 | 2179.8 samples/s | 34.1 steps/s
[Step=11800 Epoch=45.2] | Loss=0.00043 | Reg=0.00191 | L2-Norm=13.825 | L2-Norm(final)=2.890 | acc=1.0000 | 4486.5 samples/s | 70.1 steps/s
[Step=11850 Epoch=45.4] | Loss=0.00040 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=2.890 | acc=1.0000 | 4504.1 samples/s | 70.4 steps/s
[Step=11900 Epoch=45.6] | Loss=0.00037 | Reg=0.00191 | L2-Norm=13.818 | L2-Norm(final)=2.890 | acc=1.0000 | 4648.1 samples/s | 72.6 steps/s
[Step=11950 Epoch=45.8] | Loss=0.00035 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=2.891 | acc=1.0000 | 4695.7 samples/s | 73.4 steps/s
[Step=12000 Epoch=46.0] | Loss=0.00033 | Reg=0.00191 | L2-Norm=13.810 | L2-Norm(final)=2.891 | acc=1.0000 | 2259.2 samples/s | 35.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36208 | acc=0.8098 | tpr=0.7255 | fpr=0.0069 | 4520.1 samples/s | 17.7 steps/s
Avg test loss: 0.36477, Avg test acc: 0.80956, Avg tpr: 0.72623, Avg fpr: 0.00718, total FA: 56

Testing server on iccad2012
[Step=  50] | Loss=0.39286 | acc=0.8788 | tpr=0.9558 | fpr=0.1226 | 4587.1 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.39957 | acc=0.8798 | tpr=0.9680 | fpr=0.1218 | 5190.9 samples/s | 20.3 steps/s
[Step= 150] | Loss=0.40810 | acc=0.8792 | tpr=0.9697 | fpr=0.1224 | 8404.2 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.41227 | acc=0.8789 | tpr=0.9727 | fpr=0.1228 | 8638.1 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.40859 | acc=0.8789 | tpr=0.9764 | fpr=0.1229 | 8241.0 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.41252 | acc=0.8779 | tpr=0.9760 | fpr=0.1239 | 8821.8 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.41233 | acc=0.8784 | tpr=0.9768 | fpr=0.1234 | 8368.7 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.41447 | acc=0.8779 | tpr=0.9759 | fpr=0.1239 | 8682.0 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.41938 | acc=0.8775 | tpr=0.9747 | fpr=0.1243 | 8462.9 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.41886 | acc=0.8774 | tpr=0.9753 | fpr=0.1243 | 8287.6 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.41690 | acc=0.8778 | tpr=0.9761 | fpr=0.1240 | 15892.5 samples/s | 62.1 steps/s
Avg test loss: 0.41656, Avg test acc: 0.87778, Avg tpr: 0.97623, Avg fpr: 0.12401, total FA: 17219

server round 33/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=14401 Epoch=28.2] | Loss=0.38135 | Reg=0.00191 | L2-Norm=13.816 | L2-Norm(final)=2.911 | acc=0.8125 | 4343.9 samples/s | 67.9 steps/s
[Step=14450 Epoch=28.2] | Loss=0.03294 | Reg=0.00191 | L2-Norm=13.829 | L2-Norm(final)=2.907 | acc=0.9844 | 4843.1 samples/s | 75.7 steps/s
[Step=14500 Epoch=28.3] | Loss=0.02245 | Reg=0.00191 | L2-Norm=13.835 | L2-Norm(final)=2.908 | acc=0.9688 | 4815.4 samples/s | 75.2 steps/s
[Step=14550 Epoch=28.4] | Loss=0.01842 | Reg=0.00192 | L2-Norm=13.839 | L2-Norm(final)=2.911 | acc=1.0000 | 4905.0 samples/s | 76.6 steps/s
[Step=14600 Epoch=28.5] | Loss=0.01618 | Reg=0.00192 | L2-Norm=13.842 | L2-Norm(final)=2.913 | acc=0.9844 | 4942.9 samples/s | 77.2 steps/s
[Step=14650 Epoch=28.6] | Loss=0.01524 | Reg=0.00192 | L2-Norm=13.844 | L2-Norm(final)=2.915 | acc=1.0000 | 4880.9 samples/s | 76.3 steps/s
[Step=14700 Epoch=28.7] | Loss=0.01404 | Reg=0.00192 | L2-Norm=13.847 | L2-Norm(final)=2.917 | acc=0.9844 | 4945.2 samples/s | 77.3 steps/s
[Step=14750 Epoch=28.8] | Loss=0.01362 | Reg=0.00192 | L2-Norm=13.849 | L2-Norm(final)=2.920 | acc=0.9688 | 4933.1 samples/s | 77.1 steps/s
[Step=14800 Epoch=28.9] | Loss=0.01324 | Reg=0.00192 | L2-Norm=13.851 | L2-Norm(final)=2.922 | acc=0.9844 | 4801.6 samples/s | 75.0 steps/s
[Step=14850 Epoch=29.0] | Loss=0.01292 | Reg=0.00192 | L2-Norm=13.853 | L2-Norm(final)=2.924 | acc=0.9844 | 4921.4 samples/s | 76.9 steps/s
[Step=14900 Epoch=29.1] | Loss=0.01256 | Reg=0.00192 | L2-Norm=13.855 | L2-Norm(final)=2.925 | acc=0.9531 | 5947.8 samples/s | 92.9 steps/s
[Step=14950 Epoch=29.2] | Loss=0.01210 | Reg=0.00192 | L2-Norm=13.857 | L2-Norm(final)=2.927 | acc=1.0000 | 2119.8 samples/s | 33.1 steps/s
[Step=15000 Epoch=29.3] | Loss=0.01166 | Reg=0.00192 | L2-Norm=13.859 | L2-Norm(final)=2.929 | acc=1.0000 | 4834.2 samples/s | 75.5 steps/s
[Step=15050 Epoch=29.4] | Loss=0.01138 | Reg=0.00192 | L2-Norm=13.861 | L2-Norm(final)=2.931 | acc=1.0000 | 4839.8 samples/s | 75.6 steps/s
[Step=15100 Epoch=29.5] | Loss=0.01110 | Reg=0.00192 | L2-Norm=13.862 | L2-Norm(final)=2.933 | acc=1.0000 | 4950.4 samples/s | 77.4 steps/s
[Step=15150 Epoch=29.6] | Loss=0.01087 | Reg=0.00192 | L2-Norm=13.864 | L2-Norm(final)=2.935 | acc=1.0000 | 4937.8 samples/s | 77.2 steps/s
[Step=15200 Epoch=29.7] | Loss=0.01070 | Reg=0.00192 | L2-Norm=13.866 | L2-Norm(final)=2.937 | acc=1.0000 | 4852.0 samples/s | 75.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step15200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=12001 Epoch=46.2] | Loss=0.07833 | Reg=0.00191 | L2-Norm=13.816 | L2-Norm(final)=2.912 | acc=0.9375 | 4694.3 samples/s | 73.3 steps/s
[Step=12050 Epoch=46.4] | Loss=0.00581 | Reg=0.00192 | L2-Norm=13.841 | L2-Norm(final)=2.909 | acc=1.0000 | 4229.8 samples/s | 66.1 steps/s
[Step=12100 Epoch=46.6] | Loss=0.00296 | Reg=0.00192 | L2-Norm=13.846 | L2-Norm(final)=2.910 | acc=1.0000 | 4677.3 samples/s | 73.1 steps/s
[Step=12150 Epoch=46.8] | Loss=0.00199 | Reg=0.00192 | L2-Norm=13.845 | L2-Norm(final)=2.910 | acc=1.0000 | 4731.7 samples/s | 73.9 steps/s
[Step=12200 Epoch=47.0] | Loss=0.00150 | Reg=0.00192 | L2-Norm=13.843 | L2-Norm(final)=2.911 | acc=1.0000 | 4662.4 samples/s | 72.8 steps/s
[Step=12250 Epoch=47.2] | Loss=0.00123 | Reg=0.00192 | L2-Norm=13.841 | L2-Norm(final)=2.911 | acc=1.0000 | 5960.2 samples/s | 93.1 steps/s
[Step=12300 Epoch=47.3] | Loss=0.00103 | Reg=0.00191 | L2-Norm=13.838 | L2-Norm(final)=2.912 | acc=1.0000 | 2036.1 samples/s | 31.8 steps/s
[Step=12350 Epoch=47.5] | Loss=0.00088 | Reg=0.00191 | L2-Norm=13.835 | L2-Norm(final)=2.912 | acc=1.0000 | 4602.3 samples/s | 71.9 steps/s
[Step=12400 Epoch=47.7] | Loss=0.00077 | Reg=0.00191 | L2-Norm=13.832 | L2-Norm(final)=2.913 | acc=1.0000 | 4684.0 samples/s | 73.2 steps/s
[Step=12450 Epoch=47.9] | Loss=0.00069 | Reg=0.00191 | L2-Norm=13.829 | L2-Norm(final)=2.913 | acc=1.0000 | 4616.8 samples/s | 72.1 steps/s
[Step=12500 Epoch=48.1] | Loss=0.00062 | Reg=0.00191 | L2-Norm=13.825 | L2-Norm(final)=2.913 | acc=1.0000 | 5280.4 samples/s | 82.5 steps/s
[Step=12550 Epoch=48.3] | Loss=0.00057 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=2.914 | acc=1.0000 | 2134.3 samples/s | 33.3 steps/s
[Step=12600 Epoch=48.5] | Loss=0.00052 | Reg=0.00191 | L2-Norm=13.818 | L2-Norm(final)=2.914 | acc=1.0000 | 4720.0 samples/s | 73.7 steps/s
[Step=12650 Epoch=48.7] | Loss=0.00048 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=2.914 | acc=1.0000 | 4720.6 samples/s | 73.8 steps/s
[Step=12700 Epoch=48.9] | Loss=0.00045 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=2.915 | acc=1.0000 | 4603.3 samples/s | 71.9 steps/s
[Step=12750 Epoch=49.1] | Loss=0.00042 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=2.915 | acc=1.0000 | 4811.7 samples/s | 75.2 steps/s
[Step=12800 Epoch=49.3] | Loss=0.00039 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=2.915 | acc=1.0000 | 2227.4 samples/s | 34.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37988 | acc=0.8024 | tpr=0.7143 | fpr=0.0062 | 3283.3 samples/s | 12.8 steps/s
Avg test loss: 0.38183, Avg test acc: 0.80255, Avg tpr: 0.71568, Avg fpr: 0.00641, total FA: 50

Testing server on iccad2012
[Step=  50] | Loss=0.37564 | acc=0.8871 | tpr=0.9513 | fpr=0.1140 | 4558.8 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.38296 | acc=0.8879 | tpr=0.9659 | fpr=0.1136 | 8376.1 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.39151 | acc=0.8867 | tpr=0.9683 | fpr=0.1148 | 8683.5 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.39547 | acc=0.8864 | tpr=0.9716 | fpr=0.1152 | 8559.6 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.39178 | acc=0.8865 | tpr=0.9755 | fpr=0.1151 | 8554.6 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.39563 | acc=0.8857 | tpr=0.9760 | fpr=0.1159 | 8409.6 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.39543 | acc=0.8862 | tpr=0.9768 | fpr=0.1155 | 8878.9 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.39758 | acc=0.8857 | tpr=0.9754 | fpr=0.1159 | 8264.8 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.40256 | acc=0.8852 | tpr=0.9742 | fpr=0.1164 | 8592.3 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.40192 | acc=0.8852 | tpr=0.9744 | fpr=0.1164 | 8818.8 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.39997 | acc=0.8855 | tpr=0.9753 | fpr=0.1162 | 14846.5 samples/s | 58.0 steps/s
Avg test loss: 0.39964, Avg test acc: 0.88549, Avg tpr: 0.97544, Avg fpr: 0.11615, total FA: 16127

server round 34/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=15201 Epoch=29.7] | Loss=0.24101 | Reg=0.00190 | L2-Norm=13.796 | L2-Norm(final)=2.929 | acc=0.8594 | 4603.9 samples/s | 71.9 steps/s
[Step=15250 Epoch=29.8] | Loss=0.03993 | Reg=0.00191 | L2-Norm=13.809 | L2-Norm(final)=2.923 | acc=1.0000 | 4622.9 samples/s | 72.2 steps/s
[Step=15300 Epoch=29.9] | Loss=0.02534 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=2.923 | acc=1.0000 | 4875.5 samples/s | 76.2 steps/s
[Step=15350 Epoch=30.0] | Loss=0.02070 | Reg=0.00191 | L2-Norm=13.817 | L2-Norm(final)=2.925 | acc=1.0000 | 4917.9 samples/s | 76.8 steps/s
[Step=15400 Epoch=30.1] | Loss=0.01799 | Reg=0.00191 | L2-Norm=13.820 | L2-Norm(final)=2.928 | acc=1.0000 | 4921.8 samples/s | 76.9 steps/s
[Step=15450 Epoch=30.2] | Loss=0.01613 | Reg=0.00191 | L2-Norm=13.823 | L2-Norm(final)=2.930 | acc=0.9688 | 4991.1 samples/s | 78.0 steps/s
[Step=15500 Epoch=30.3] | Loss=0.01468 | Reg=0.00191 | L2-Norm=13.826 | L2-Norm(final)=2.932 | acc=0.9844 | 4825.8 samples/s | 75.4 steps/s
[Step=15550 Epoch=30.4] | Loss=0.01390 | Reg=0.00191 | L2-Norm=13.828 | L2-Norm(final)=2.935 | acc=0.9844 | 4964.2 samples/s | 77.6 steps/s
[Step=15600 Epoch=30.5] | Loss=0.01334 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=2.937 | acc=1.0000 | 4895.2 samples/s | 76.5 steps/s
[Step=15650 Epoch=30.6] | Loss=0.01310 | Reg=0.00191 | L2-Norm=13.833 | L2-Norm(final)=2.940 | acc=0.9844 | 4817.7 samples/s | 75.3 steps/s
[Step=15700 Epoch=30.7] | Loss=0.01271 | Reg=0.00191 | L2-Norm=13.835 | L2-Norm(final)=2.942 | acc=0.9844 | 6046.6 samples/s | 94.5 steps/s
[Step=15750 Epoch=30.8] | Loss=0.01212 | Reg=0.00191 | L2-Norm=13.837 | L2-Norm(final)=2.944 | acc=1.0000 | 2148.3 samples/s | 33.6 steps/s
[Step=15800 Epoch=30.9] | Loss=0.01173 | Reg=0.00192 | L2-Norm=13.839 | L2-Norm(final)=2.946 | acc=1.0000 | 4809.7 samples/s | 75.2 steps/s
[Step=15850 Epoch=31.0] | Loss=0.01130 | Reg=0.00192 | L2-Norm=13.841 | L2-Norm(final)=2.949 | acc=0.9844 | 4977.4 samples/s | 77.8 steps/s
[Step=15900 Epoch=31.1] | Loss=0.01103 | Reg=0.00192 | L2-Norm=13.843 | L2-Norm(final)=2.951 | acc=1.0000 | 4881.6 samples/s | 76.3 steps/s
[Step=15950 Epoch=31.2] | Loss=0.01098 | Reg=0.00192 | L2-Norm=13.845 | L2-Norm(final)=2.953 | acc=0.9844 | 4885.4 samples/s | 76.3 steps/s
[Step=16000 Epoch=31.3] | Loss=0.01074 | Reg=0.00192 | L2-Norm=13.846 | L2-Norm(final)=2.955 | acc=1.0000 | 4907.0 samples/s | 76.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step16000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=12801 Epoch=49.3] | Loss=0.04871 | Reg=0.00190 | L2-Norm=13.796 | L2-Norm(final)=2.930 | acc=0.9844 | 4099.1 samples/s | 64.0 steps/s
[Step=12850 Epoch=49.5] | Loss=0.00458 | Reg=0.00191 | L2-Norm=13.818 | L2-Norm(final)=2.932 | acc=1.0000 | 4451.2 samples/s | 69.6 steps/s
[Step=12900 Epoch=49.7] | Loss=0.00233 | Reg=0.00191 | L2-Norm=13.824 | L2-Norm(final)=2.932 | acc=1.0000 | 4522.3 samples/s | 70.7 steps/s
[Step=12950 Epoch=49.8] | Loss=0.00158 | Reg=0.00191 | L2-Norm=13.825 | L2-Norm(final)=2.933 | acc=1.0000 | 4616.5 samples/s | 72.1 steps/s
[Step=13000 Epoch=50.0] | Loss=0.00119 | Reg=0.00191 | L2-Norm=13.823 | L2-Norm(final)=2.933 | acc=1.0000 | 4664.9 samples/s | 72.9 steps/s
[Step=13050 Epoch=50.2] | Loss=0.00097 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=2.934 | acc=1.0000 | 5889.3 samples/s | 92.0 steps/s
[Step=13100 Epoch=50.4] | Loss=0.00082 | Reg=0.00191 | L2-Norm=13.819 | L2-Norm(final)=2.935 | acc=1.0000 | 2036.7 samples/s | 31.8 steps/s
[Step=13150 Epoch=50.6] | Loss=0.00070 | Reg=0.00191 | L2-Norm=13.817 | L2-Norm(final)=2.935 | acc=1.0000 | 4579.7 samples/s | 71.6 steps/s
[Step=13200 Epoch=50.8] | Loss=0.00062 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=2.936 | acc=1.0000 | 4605.2 samples/s | 72.0 steps/s
[Step=13250 Epoch=51.0] | Loss=0.00055 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=2.936 | acc=1.0000 | 4648.4 samples/s | 72.6 steps/s
[Step=13300 Epoch=51.2] | Loss=0.00050 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=2.936 | acc=1.0000 | 5213.2 samples/s | 81.5 steps/s
[Step=13350 Epoch=51.4] | Loss=0.00045 | Reg=0.00191 | L2-Norm=13.804 | L2-Norm(final)=2.937 | acc=1.0000 | 2141.0 samples/s | 33.5 steps/s
[Step=13400 Epoch=51.6] | Loss=0.00042 | Reg=0.00190 | L2-Norm=13.801 | L2-Norm(final)=2.937 | acc=1.0000 | 4552.1 samples/s | 71.1 steps/s
[Step=13450 Epoch=51.8] | Loss=0.00038 | Reg=0.00190 | L2-Norm=13.797 | L2-Norm(final)=2.937 | acc=1.0000 | 4682.8 samples/s | 73.2 steps/s
[Step=13500 Epoch=52.0] | Loss=0.00036 | Reg=0.00190 | L2-Norm=13.794 | L2-Norm(final)=2.938 | acc=1.0000 | 4683.0 samples/s | 73.2 steps/s
[Step=13550 Epoch=52.2] | Loss=0.00033 | Reg=0.00190 | L2-Norm=13.790 | L2-Norm(final)=2.938 | acc=1.0000 | 4659.2 samples/s | 72.8 steps/s
[Step=13600 Epoch=52.4] | Loss=0.00031 | Reg=0.00190 | L2-Norm=13.787 | L2-Norm(final)=2.938 | acc=1.0000 | 2195.0 samples/s | 34.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36400 | acc=0.8109 | tpr=0.7270 | fpr=0.0067 | 4485.2 samples/s | 17.5 steps/s
Avg test loss: 0.36731, Avg test acc: 0.81032, Avg tpr: 0.72734, Avg fpr: 0.00718, total FA: 56

Testing server on iccad2012
[Step=  50] | Loss=0.39260 | acc=0.8816 | tpr=0.9690 | fpr=0.1200 | 4474.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.39997 | acc=0.8823 | tpr=0.9744 | fpr=0.1194 | 8551.3 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.40893 | acc=0.8815 | tpr=0.9741 | fpr=0.1202 | 8536.1 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.41321 | acc=0.8815 | tpr=0.9760 | fpr=0.1203 | 8514.3 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.40955 | acc=0.8813 | tpr=0.9790 | fpr=0.1204 | 8589.6 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.41358 | acc=0.8805 | tpr=0.9782 | fpr=0.1212 | 8452.8 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.41335 | acc=0.8809 | tpr=0.9787 | fpr=0.1209 | 8278.3 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.41577 | acc=0.8806 | tpr=0.9776 | fpr=0.1211 | 9004.4 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.42080 | acc=0.8802 | tpr=0.9757 | fpr=0.1216 | 8420.1 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.42014 | acc=0.8803 | tpr=0.9762 | fpr=0.1214 | 8248.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.41820 | acc=0.8805 | tpr=0.9769 | fpr=0.1212 | 15808.9 samples/s | 61.8 steps/s
Avg test loss: 0.41786, Avg test acc: 0.88056, Avg tpr: 0.97702, Avg fpr: 0.12120, total FA: 16828

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=14401 Epoch=28.1] | Loss=0.26194 | Reg=0.00190 | L2-Norm=13.789 | L2-Norm(final)=2.940 | acc=0.8594 | 4218.0 samples/s | 65.9 steps/s
[Step=14450 Epoch=28.2] | Loss=0.03432 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=2.934 | acc=0.9844 | 4634.1 samples/s | 72.4 steps/s
[Step=14500 Epoch=28.3] | Loss=0.02414 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=2.935 | acc=1.0000 | 4797.1 samples/s | 75.0 steps/s
[Step=14550 Epoch=28.4] | Loss=0.02034 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=2.936 | acc=1.0000 | 4828.1 samples/s | 75.4 steps/s
[Step=14600 Epoch=28.5] | Loss=0.01930 | Reg=0.00191 | L2-Norm=13.813 | L2-Norm(final)=2.938 | acc=1.0000 | 4850.7 samples/s | 75.8 steps/s
[Step=14650 Epoch=28.6] | Loss=0.01735 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=2.939 | acc=1.0000 | 4885.2 samples/s | 76.3 steps/s
[Step=14700 Epoch=28.7] | Loss=0.01597 | Reg=0.00191 | L2-Norm=13.817 | L2-Norm(final)=2.941 | acc=1.0000 | 4821.3 samples/s | 75.3 steps/s
[Step=14750 Epoch=28.8] | Loss=0.01507 | Reg=0.00191 | L2-Norm=13.820 | L2-Norm(final)=2.943 | acc=0.9844 | 4865.5 samples/s | 76.0 steps/s
[Step=14800 Epoch=28.9] | Loss=0.01428 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=2.945 | acc=0.9844 | 4862.9 samples/s | 76.0 steps/s
[Step=14850 Epoch=29.0] | Loss=0.01365 | Reg=0.00191 | L2-Norm=13.824 | L2-Norm(final)=2.947 | acc=1.0000 | 4886.0 samples/s | 76.3 steps/s
[Step=14900 Epoch=29.1] | Loss=0.01315 | Reg=0.00191 | L2-Norm=13.826 | L2-Norm(final)=2.949 | acc=1.0000 | 5902.1 samples/s | 92.2 steps/s
[Step=14950 Epoch=29.2] | Loss=0.01272 | Reg=0.00191 | L2-Norm=13.828 | L2-Norm(final)=2.951 | acc=1.0000 | 2065.8 samples/s | 32.3 steps/s
[Step=15000 Epoch=29.3] | Loss=0.01219 | Reg=0.00191 | L2-Norm=13.830 | L2-Norm(final)=2.953 | acc=0.9688 | 4845.9 samples/s | 75.7 steps/s
[Step=15050 Epoch=29.4] | Loss=0.01187 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=2.955 | acc=0.9688 | 4983.4 samples/s | 77.9 steps/s
[Step=15100 Epoch=29.5] | Loss=0.01158 | Reg=0.00191 | L2-Norm=13.833 | L2-Norm(final)=2.957 | acc=1.0000 | 4865.5 samples/s | 76.0 steps/s
[Step=15150 Epoch=29.5] | Loss=0.01132 | Reg=0.00191 | L2-Norm=13.835 | L2-Norm(final)=2.959 | acc=1.0000 | 4974.1 samples/s | 77.7 steps/s
[Step=15200 Epoch=29.6] | Loss=0.01099 | Reg=0.00191 | L2-Norm=13.836 | L2-Norm(final)=2.961 | acc=1.0000 | 4951.8 samples/s | 77.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step15200.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=16001 Epoch=31.3] | Loss=0.35552 | Reg=0.00190 | L2-Norm=13.789 | L2-Norm(final)=2.940 | acc=0.7969 | 4303.5 samples/s | 67.2 steps/s
[Step=16050 Epoch=31.4] | Loss=0.03026 | Reg=0.00190 | L2-Norm=13.802 | L2-Norm(final)=2.937 | acc=1.0000 | 4725.8 samples/s | 73.8 steps/s
[Step=16100 Epoch=31.5] | Loss=0.02120 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=2.939 | acc=1.0000 | 4744.5 samples/s | 74.1 steps/s
[Step=16150 Epoch=31.6] | Loss=0.01777 | Reg=0.00191 | L2-Norm=13.812 | L2-Norm(final)=2.942 | acc=0.9844 | 4769.8 samples/s | 74.5 steps/s
[Step=16200 Epoch=31.7] | Loss=0.01540 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=2.944 | acc=1.0000 | 4754.1 samples/s | 74.3 steps/s
[Step=16250 Epoch=31.8] | Loss=0.01388 | Reg=0.00191 | L2-Norm=13.817 | L2-Norm(final)=2.947 | acc=1.0000 | 4843.3 samples/s | 75.7 steps/s
[Step=16300 Epoch=31.9] | Loss=0.01278 | Reg=0.00191 | L2-Norm=13.820 | L2-Norm(final)=2.950 | acc=1.0000 | 4746.8 samples/s | 74.2 steps/s
[Step=16350 Epoch=32.0] | Loss=0.01256 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=2.952 | acc=0.9844 | 4744.9 samples/s | 74.1 steps/s
[Step=16400 Epoch=32.1] | Loss=0.01219 | Reg=0.00191 | L2-Norm=13.824 | L2-Norm(final)=2.955 | acc=1.0000 | 4868.4 samples/s | 76.1 steps/s
[Step=16450 Epoch=32.2] | Loss=0.01218 | Reg=0.00191 | L2-Norm=13.826 | L2-Norm(final)=2.957 | acc=1.0000 | 4769.3 samples/s | 74.5 steps/s
[Step=16500 Epoch=32.3] | Loss=0.01176 | Reg=0.00191 | L2-Norm=13.828 | L2-Norm(final)=2.958 | acc=1.0000 | 5984.9 samples/s | 93.5 steps/s
[Step=16550 Epoch=32.4] | Loss=0.01149 | Reg=0.00191 | L2-Norm=13.830 | L2-Norm(final)=2.960 | acc=1.0000 | 2132.9 samples/s | 33.3 steps/s
[Step=16600 Epoch=32.5] | Loss=0.01109 | Reg=0.00191 | L2-Norm=13.832 | L2-Norm(final)=2.962 | acc=1.0000 | 4870.5 samples/s | 76.1 steps/s
[Step=16650 Epoch=32.6] | Loss=0.01091 | Reg=0.00191 | L2-Norm=13.834 | L2-Norm(final)=2.964 | acc=1.0000 | 4728.2 samples/s | 73.9 steps/s
[Step=16700 Epoch=32.6] | Loss=0.01067 | Reg=0.00191 | L2-Norm=13.836 | L2-Norm(final)=2.966 | acc=1.0000 | 4896.3 samples/s | 76.5 steps/s
[Step=16750 Epoch=32.7] | Loss=0.01044 | Reg=0.00191 | L2-Norm=13.837 | L2-Norm(final)=2.968 | acc=1.0000 | 4840.5 samples/s | 75.6 steps/s
[Step=16800 Epoch=32.8] | Loss=0.01025 | Reg=0.00192 | L2-Norm=13.839 | L2-Norm(final)=2.970 | acc=1.0000 | 4834.5 samples/s | 75.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36104 | acc=0.8133 | tpr=0.7306 | fpr=0.0072 | 4558.9 samples/s | 17.8 steps/s
Avg test loss: 0.36336, Avg test acc: 0.81277, Avg tpr: 0.73107, Avg fpr: 0.00756, total FA: 59

Testing server on iccad2012
[Step=  50] | Loss=0.39867 | acc=0.8824 | tpr=0.9690 | fpr=0.1191 | 4570.5 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.40584 | acc=0.8834 | tpr=0.9744 | fpr=0.1183 | 8372.3 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.41526 | acc=0.8821 | tpr=0.9741 | fpr=0.1196 | 8495.6 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.41958 | acc=0.8815 | tpr=0.9770 | fpr=0.1203 | 9233.5 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.41581 | acc=0.8813 | tpr=0.9799 | fpr=0.1205 | 7998.3 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.41990 | acc=0.8806 | tpr=0.9789 | fpr=0.1212 | 8717.5 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.41959 | acc=0.8811 | tpr=0.9793 | fpr=0.1207 | 8381.1 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.42206 | acc=0.8808 | tpr=0.9781 | fpr=0.1210 | 8680.0 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.42716 | acc=0.8804 | tpr=0.9766 | fpr=0.1213 | 8304.2 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.42649 | acc=0.8805 | tpr=0.9771 | fpr=0.1212 | 8582.7 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.42454 | acc=0.8808 | tpr=0.9777 | fpr=0.1210 | 15500.6 samples/s | 60.5 steps/s
Avg test loss: 0.42417, Avg test acc: 0.88086, Avg tpr: 0.97781, Avg fpr: 0.12090, total FA: 16787

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00013, len=1
[Step=15201 Epoch=29.6] | Loss=0.10109 | Reg=0.00190 | L2-Norm=13.774 | L2-Norm(final)=2.957 | acc=0.9219 | 4569.3 samples/s | 71.4 steps/s
[Step=15250 Epoch=29.7] | Loss=0.03907 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=2.950 | acc=0.9844 | 4331.3 samples/s | 67.7 steps/s
[Step=15300 Epoch=29.8] | Loss=0.02525 | Reg=0.00190 | L2-Norm=13.797 | L2-Norm(final)=2.950 | acc=0.9688 | 4870.2 samples/s | 76.1 steps/s
[Step=15350 Epoch=29.9] | Loss=0.02015 | Reg=0.00190 | L2-Norm=13.802 | L2-Norm(final)=2.953 | acc=1.0000 | 4751.6 samples/s | 74.2 steps/s
[Step=15400 Epoch=30.0] | Loss=0.01823 | Reg=0.00191 | L2-Norm=13.805 | L2-Norm(final)=2.955 | acc=1.0000 | 4839.4 samples/s | 75.6 steps/s
[Step=15450 Epoch=30.1] | Loss=0.01620 | Reg=0.00191 | L2-Norm=13.808 | L2-Norm(final)=2.957 | acc=1.0000 | 4893.5 samples/s | 76.5 steps/s
[Step=15500 Epoch=30.2] | Loss=0.01511 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=2.959 | acc=0.9844 | 4886.7 samples/s | 76.4 steps/s
[Step=15550 Epoch=30.3] | Loss=0.01429 | Reg=0.00191 | L2-Norm=13.814 | L2-Norm(final)=2.961 | acc=1.0000 | 4912.5 samples/s | 76.8 steps/s
[Step=15600 Epoch=30.4] | Loss=0.01360 | Reg=0.00191 | L2-Norm=13.816 | L2-Norm(final)=2.964 | acc=1.0000 | 4884.7 samples/s | 76.3 steps/s
[Step=15650 Epoch=30.5] | Loss=0.01312 | Reg=0.00191 | L2-Norm=13.818 | L2-Norm(final)=2.966 | acc=0.9844 | 4849.2 samples/s | 75.8 steps/s
[Step=15700 Epoch=30.6] | Loss=0.01293 | Reg=0.00191 | L2-Norm=13.820 | L2-Norm(final)=2.968 | acc=1.0000 | 5950.7 samples/s | 93.0 steps/s
[Step=15750 Epoch=30.7] | Loss=0.01266 | Reg=0.00191 | L2-Norm=13.822 | L2-Norm(final)=2.970 | acc=1.0000 | 2024.7 samples/s | 31.6 steps/s
[Step=15800 Epoch=30.8] | Loss=0.01205 | Reg=0.00191 | L2-Norm=13.824 | L2-Norm(final)=2.971 | acc=1.0000 | 4996.9 samples/s | 78.1 steps/s
[Step=15850 Epoch=30.9] | Loss=0.01171 | Reg=0.00191 | L2-Norm=13.825 | L2-Norm(final)=2.973 | acc=1.0000 | 4821.8 samples/s | 75.3 steps/s
[Step=15900 Epoch=31.0] | Loss=0.01140 | Reg=0.00191 | L2-Norm=13.827 | L2-Norm(final)=2.975 | acc=1.0000 | 4932.4 samples/s | 77.1 steps/s
[Step=15950 Epoch=31.1] | Loss=0.01113 | Reg=0.00191 | L2-Norm=13.829 | L2-Norm(final)=2.977 | acc=1.0000 | 4867.7 samples/s | 76.1 steps/s
[Step=16000 Epoch=31.2] | Loss=0.01106 | Reg=0.00191 | L2-Norm=13.831 | L2-Norm(final)=2.979 | acc=0.9844 | 4920.7 samples/s | 76.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=16801 Epoch=32.8] | Loss=0.16556 | Reg=0.00190 | L2-Norm=13.774 | L2-Norm(final)=2.957 | acc=0.8438 | 4448.8 samples/s | 69.5 steps/s
[Step=16850 Epoch=32.9] | Loss=0.04052 | Reg=0.00190 | L2-Norm=13.786 | L2-Norm(final)=2.948 | acc=0.9844 | 4977.3 samples/s | 77.8 steps/s
[Step=16900 Epoch=33.0] | Loss=0.02627 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=2.947 | acc=1.0000 | 4910.4 samples/s | 76.7 steps/s
[Step=16950 Epoch=33.1] | Loss=0.02069 | Reg=0.00190 | L2-Norm=13.796 | L2-Norm(final)=2.949 | acc=1.0000 | 4896.7 samples/s | 76.5 steps/s
[Step=17000 Epoch=33.2] | Loss=0.01778 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=2.952 | acc=0.9844 | 4950.6 samples/s | 77.4 steps/s
[Step=17050 Epoch=33.3] | Loss=0.01558 | Reg=0.00191 | L2-Norm=13.802 | L2-Norm(final)=2.954 | acc=1.0000 | 5015.0 samples/s | 78.4 steps/s
[Step=17100 Epoch=33.4] | Loss=0.01445 | Reg=0.00191 | L2-Norm=13.805 | L2-Norm(final)=2.957 | acc=1.0000 | 4898.1 samples/s | 76.5 steps/s
[Step=17150 Epoch=33.5] | Loss=0.01366 | Reg=0.00191 | L2-Norm=13.807 | L2-Norm(final)=2.960 | acc=1.0000 | 4929.9 samples/s | 77.0 steps/s
[Step=17200 Epoch=33.6] | Loss=0.01329 | Reg=0.00191 | L2-Norm=13.809 | L2-Norm(final)=2.962 | acc=1.0000 | 4817.9 samples/s | 75.3 steps/s
[Step=17250 Epoch=33.7] | Loss=0.01311 | Reg=0.00191 | L2-Norm=13.811 | L2-Norm(final)=2.964 | acc=0.9844 | 4838.8 samples/s | 75.6 steps/s
[Step=17300 Epoch=33.8] | Loss=0.01259 | Reg=0.00191 | L2-Norm=13.813 | L2-Norm(final)=2.966 | acc=1.0000 | 5952.8 samples/s | 93.0 steps/s
[Step=17350 Epoch=33.9] | Loss=0.01215 | Reg=0.00191 | L2-Norm=13.815 | L2-Norm(final)=2.968 | acc=0.9844 | 2119.2 samples/s | 33.1 steps/s
[Step=17400 Epoch=34.0] | Loss=0.01160 | Reg=0.00191 | L2-Norm=13.817 | L2-Norm(final)=2.970 | acc=1.0000 | 4829.4 samples/s | 75.5 steps/s
[Step=17450 Epoch=34.1] | Loss=0.01114 | Reg=0.00191 | L2-Norm=13.819 | L2-Norm(final)=2.972 | acc=1.0000 | 4806.6 samples/s | 75.1 steps/s
[Step=17500 Epoch=34.2] | Loss=0.01083 | Reg=0.00191 | L2-Norm=13.821 | L2-Norm(final)=2.974 | acc=0.9844 | 4949.2 samples/s | 77.3 steps/s
[Step=17550 Epoch=34.3] | Loss=0.01067 | Reg=0.00191 | L2-Norm=13.823 | L2-Norm(final)=2.976 | acc=1.0000 | 4860.2 samples/s | 75.9 steps/s
[Step=17600 Epoch=34.4] | Loss=0.01048 | Reg=0.00191 | L2-Norm=13.824 | L2-Norm(final)=2.978 | acc=1.0000 | 4815.5 samples/s | 75.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39481 | acc=0.8005 | tpr=0.7115 | fpr=0.0064 | 4507.5 samples/s | 17.6 steps/s
Avg test loss: 0.39813, Avg test acc: 0.80058, Avg tpr: 0.71300, Avg fpr: 0.00679, total FA: 53

Testing server on iccad2012
[Step=  50] | Loss=0.38238 | acc=0.8882 | tpr=0.9690 | fpr=0.1132 | 4361.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.38931 | acc=0.8896 | tpr=0.9744 | fpr=0.1120 | 8661.7 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.39883 | acc=0.8880 | tpr=0.9726 | fpr=0.1136 | 9102.3 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.40327 | acc=0.8878 | tpr=0.9760 | fpr=0.1138 | 7970.0 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.39929 | acc=0.8878 | tpr=0.9790 | fpr=0.1138 | 9119.4 samples/s | 35.6 steps/s
[Step= 300] | Loss=0.40341 | acc=0.8871 | tpr=0.9782 | fpr=0.1146 | 7865.0 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.40324 | acc=0.8875 | tpr=0.9787 | fpr=0.1142 | 8562.6 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.40583 | acc=0.8872 | tpr=0.9776 | fpr=0.1144 | 8609.0 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.41099 | acc=0.8867 | tpr=0.9761 | fpr=0.1149 | 8395.9 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.41023 | acc=0.8868 | tpr=0.9767 | fpr=0.1148 | 8360.2 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.40829 | acc=0.8872 | tpr=0.9773 | fpr=0.1145 | 16117.2 samples/s | 63.0 steps/s
Avg test loss: 0.40795, Avg test acc: 0.88721, Avg tpr: 0.97742, Avg fpr: 0.11443, total FA: 15888

server round 37/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=12001 Epoch=46.0] | Loss=0.22879 | Reg=0.00190 | L2-Norm=13.769 | L2-Norm(final)=2.962 | acc=0.9375 | 4686.4 samples/s | 73.2 steps/s
[Step=12050 Epoch=46.2] | Loss=0.00765 | Reg=0.00190 | L2-Norm=13.797 | L2-Norm(final)=2.959 | acc=1.0000 | 4263.0 samples/s | 66.6 steps/s
[Step=12100 Epoch=46.4] | Loss=0.00392 | Reg=0.00190 | L2-Norm=13.802 | L2-Norm(final)=2.958 | acc=1.0000 | 4559.3 samples/s | 71.2 steps/s
[Step=12150 Epoch=46.6] | Loss=0.00264 | Reg=0.00191 | L2-Norm=13.803 | L2-Norm(final)=2.959 | acc=1.0000 | 4633.0 samples/s | 72.4 steps/s
[Step=12200 Epoch=46.7] | Loss=0.00203 | Reg=0.00190 | L2-Norm=13.802 | L2-Norm(final)=2.959 | acc=1.0000 | 4691.1 samples/s | 73.3 steps/s
[Step=12250 Epoch=46.9] | Loss=0.00164 | Reg=0.00190 | L2-Norm=13.800 | L2-Norm(final)=2.960 | acc=1.0000 | 5905.6 samples/s | 92.3 steps/s
[Step=12300 Epoch=47.1] | Loss=0.00137 | Reg=0.00190 | L2-Norm=13.799 | L2-Norm(final)=2.960 | acc=1.0000 | 2032.0 samples/s | 31.8 steps/s
[Step=12350 Epoch=47.3] | Loss=0.00118 | Reg=0.00190 | L2-Norm=13.797 | L2-Norm(final)=2.961 | acc=1.0000 | 4728.6 samples/s | 73.9 steps/s
[Step=12400 Epoch=47.5] | Loss=0.00103 | Reg=0.00190 | L2-Norm=13.794 | L2-Norm(final)=2.961 | acc=1.0000 | 4654.5 samples/s | 72.7 steps/s
[Step=12450 Epoch=47.7] | Loss=0.00092 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=2.962 | acc=1.0000 | 4616.4 samples/s | 72.1 steps/s
[Step=12500 Epoch=47.9] | Loss=0.00083 | Reg=0.00190 | L2-Norm=13.790 | L2-Norm(final)=2.962 | acc=1.0000 | 5195.7 samples/s | 81.2 steps/s
[Step=12550 Epoch=48.1] | Loss=0.00076 | Reg=0.00190 | L2-Norm=13.787 | L2-Norm(final)=2.962 | acc=1.0000 | 2143.5 samples/s | 33.5 steps/s
[Step=12600 Epoch=48.3] | Loss=0.00069 | Reg=0.00190 | L2-Norm=13.784 | L2-Norm(final)=2.963 | acc=1.0000 | 4658.6 samples/s | 72.8 steps/s
[Step=12650 Epoch=48.5] | Loss=0.00064 | Reg=0.00190 | L2-Norm=13.781 | L2-Norm(final)=2.963 | acc=1.0000 | 4668.3 samples/s | 72.9 steps/s
[Step=12700 Epoch=48.7] | Loss=0.00060 | Reg=0.00190 | L2-Norm=13.779 | L2-Norm(final)=2.963 | acc=1.0000 | 4671.4 samples/s | 73.0 steps/s
[Step=12750 Epoch=48.9] | Loss=0.00056 | Reg=0.00190 | L2-Norm=13.776 | L2-Norm(final)=2.964 | acc=1.0000 | 4564.8 samples/s | 71.3 steps/s
[Step=12800 Epoch=49.0] | Loss=0.00052 | Reg=0.00190 | L2-Norm=13.773 | L2-Norm(final)=2.964 | acc=1.0000 | 2218.1 samples/s | 34.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step12800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=13601 Epoch=52.4] | Loss=0.01489 | Reg=0.00190 | L2-Norm=13.769 | L2-Norm(final)=2.963 | acc=0.9844 | 4132.2 samples/s | 64.6 steps/s
[Step=13650 Epoch=52.5] | Loss=0.00462 | Reg=0.00190 | L2-Norm=13.792 | L2-Norm(final)=2.960 | acc=1.0000 | 4737.3 samples/s | 74.0 steps/s
[Step=13700 Epoch=52.7] | Loss=0.00236 | Reg=0.00190 | L2-Norm=13.794 | L2-Norm(final)=2.960 | acc=1.0000 | 4616.8 samples/s | 72.1 steps/s
[Step=13750 Epoch=52.9] | Loss=0.00159 | Reg=0.00190 | L2-Norm=13.793 | L2-Norm(final)=2.961 | acc=1.0000 | 4607.3 samples/s | 72.0 steps/s
[Step=13800 Epoch=53.1] | Loss=0.00120 | Reg=0.00190 | L2-Norm=13.791 | L2-Norm(final)=2.961 | acc=1.0000 | 4597.6 samples/s | 71.8 steps/s
[Step=13850 Epoch=53.3] | Loss=0.00097 | Reg=0.00190 | L2-Norm=13.788 | L2-Norm(final)=2.962 | acc=1.0000 | 5900.5 samples/s | 92.2 steps/s
[Step=13900 Epoch=53.5] | Loss=0.00081 | Reg=0.00190 | L2-Norm=13.786 | L2-Norm(final)=2.962 | acc=1.0000 | 2048.5 samples/s | 32.0 steps/s
[Step=13950 Epoch=53.7] | Loss=0.00070 | Reg=0.00190 | L2-Norm=13.783 | L2-Norm(final)=2.963 | acc=1.0000 | 4515.5 samples/s | 70.6 steps/s
[Step=14000 Epoch=53.9] | Loss=0.00061 | Reg=0.00190 | L2-Norm=13.779 | L2-Norm(final)=2.963 | acc=1.0000 | 4609.8 samples/s | 72.0 steps/s
[Step=14050 Epoch=54.1] | Loss=0.00055 | Reg=0.00190 | L2-Norm=13.776 | L2-Norm(final)=2.964 | acc=1.0000 | 4591.6 samples/s | 71.7 steps/s
[Step=14100 Epoch=54.3] | Loss=0.00049 | Reg=0.00190 | L2-Norm=13.773 | L2-Norm(final)=2.964 | acc=1.0000 | 5221.2 samples/s | 81.6 steps/s
[Step=14150 Epoch=54.5] | Loss=0.00045 | Reg=0.00190 | L2-Norm=13.769 | L2-Norm(final)=2.965 | acc=1.0000 | 2145.8 samples/s | 33.5 steps/s
[Step=14200 Epoch=54.7] | Loss=0.00041 | Reg=0.00189 | L2-Norm=13.766 | L2-Norm(final)=2.965 | acc=1.0000 | 4667.7 samples/s | 72.9 steps/s
[Step=14250 Epoch=54.9] | Loss=0.00038 | Reg=0.00189 | L2-Norm=13.762 | L2-Norm(final)=2.965 | acc=1.0000 | 4584.3 samples/s | 71.6 steps/s
[Step=14300 Epoch=55.0] | Loss=0.00036 | Reg=0.00189 | L2-Norm=13.758 | L2-Norm(final)=2.966 | acc=1.0000 | 4562.3 samples/s | 71.3 steps/s
[Step=14350 Epoch=55.2] | Loss=0.00033 | Reg=0.00189 | L2-Norm=13.754 | L2-Norm(final)=2.966 | acc=1.0000 | 4706.0 samples/s | 73.5 steps/s
[Step=14400 Epoch=55.4] | Loss=0.00031 | Reg=0.00189 | L2-Norm=13.750 | L2-Norm(final)=2.966 | acc=1.0000 | 2207.0 samples/s | 34.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42363 | acc=0.7882 | tpr=0.6932 | fpr=0.0055 | 4504.5 samples/s | 17.6 steps/s
Avg test loss: 0.42779, Avg test acc: 0.78820, Avg tpr: 0.69441, Avg fpr: 0.00551, total FA: 43

Testing server on iccad2012
[Step=  50] | Loss=0.35003 | acc=0.8964 | tpr=0.9646 | fpr=0.1048 | 4625.3 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.35726 | acc=0.8975 | tpr=0.9701 | fpr=0.1039 | 8041.1 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.36641 | acc=0.8955 | tpr=0.9697 | fpr=0.1058 | 8580.3 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.37052 | acc=0.8957 | tpr=0.9727 | fpr=0.1057 | 8468.7 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.36663 | acc=0.8958 | tpr=0.9755 | fpr=0.1056 | 8661.5 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.37040 | acc=0.8952 | tpr=0.9753 | fpr=0.1063 | 8543.1 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.37015 | acc=0.8955 | tpr=0.9762 | fpr=0.1060 | 8443.0 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.37273 | acc=0.8953 | tpr=0.9748 | fpr=0.1062 | 8492.3 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.37757 | acc=0.8947 | tpr=0.9732 | fpr=0.1067 | 8784.7 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.37679 | acc=0.8946 | tpr=0.9740 | fpr=0.1068 | 8368.5 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.37498 | acc=0.8948 | tpr=0.9749 | fpr=0.1066 | 15116.9 samples/s | 59.1 steps/s
Avg test loss: 0.37466, Avg test acc: 0.89484, Avg tpr: 0.97504, Avg fpr: 0.10662, total FA: 14804

server round 38/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=12801 Epoch=49.0] | Loss=0.06316 | Reg=0.00189 | L2-Norm=13.754 | L2-Norm(final)=2.988 | acc=0.9688 | 4403.4 samples/s | 68.8 steps/s
[Step=12850 Epoch=49.2] | Loss=0.00403 | Reg=0.00190 | L2-Norm=13.776 | L2-Norm(final)=2.993 | acc=1.0000 | 4335.4 samples/s | 67.7 steps/s
[Step=12900 Epoch=49.4] | Loss=0.00208 | Reg=0.00190 | L2-Norm=13.780 | L2-Norm(final)=2.995 | acc=1.0000 | 4514.7 samples/s | 70.5 steps/s
[Step=12950 Epoch=49.6] | Loss=0.00141 | Reg=0.00190 | L2-Norm=13.781 | L2-Norm(final)=2.997 | acc=1.0000 | 4608.0 samples/s | 72.0 steps/s
[Step=13000 Epoch=49.8] | Loss=0.00108 | Reg=0.00190 | L2-Norm=13.780 | L2-Norm(final)=2.998 | acc=1.0000 | 4605.2 samples/s | 72.0 steps/s
[Step=13050 Epoch=50.0] | Loss=0.00087 | Reg=0.00190 | L2-Norm=13.778 | L2-Norm(final)=2.998 | acc=1.0000 | 5823.0 samples/s | 91.0 steps/s
[Step=13100 Epoch=50.2] | Loss=0.00073 | Reg=0.00190 | L2-Norm=13.776 | L2-Norm(final)=2.999 | acc=1.0000 | 2047.9 samples/s | 32.0 steps/s
[Step=13150 Epoch=50.4] | Loss=0.00063 | Reg=0.00190 | L2-Norm=13.773 | L2-Norm(final)=3.000 | acc=1.0000 | 4624.6 samples/s | 72.3 steps/s
[Step=13200 Epoch=50.6] | Loss=0.00055 | Reg=0.00190 | L2-Norm=13.771 | L2-Norm(final)=3.000 | acc=1.0000 | 4643.0 samples/s | 72.5 steps/s
[Step=13250 Epoch=50.8] | Loss=0.00049 | Reg=0.00190 | L2-Norm=13.768 | L2-Norm(final)=3.000 | acc=1.0000 | 4541.5 samples/s | 71.0 steps/s
[Step=13300 Epoch=51.0] | Loss=0.00044 | Reg=0.00189 | L2-Norm=13.765 | L2-Norm(final)=3.001 | acc=1.0000 | 5170.1 samples/s | 80.8 steps/s
[Step=13350 Epoch=51.2] | Loss=0.00040 | Reg=0.00189 | L2-Norm=13.762 | L2-Norm(final)=3.001 | acc=1.0000 | 2145.4 samples/s | 33.5 steps/s
[Step=13400 Epoch=51.3] | Loss=0.00037 | Reg=0.00189 | L2-Norm=13.759 | L2-Norm(final)=3.002 | acc=1.0000 | 4711.8 samples/s | 73.6 steps/s
[Step=13450 Epoch=51.5] | Loss=0.00034 | Reg=0.00189 | L2-Norm=13.755 | L2-Norm(final)=3.002 | acc=1.0000 | 4627.3 samples/s | 72.3 steps/s
[Step=13500 Epoch=51.7] | Loss=0.00032 | Reg=0.00189 | L2-Norm=13.752 | L2-Norm(final)=3.002 | acc=1.0000 | 4606.8 samples/s | 72.0 steps/s
[Step=13550 Epoch=51.9] | Loss=0.00030 | Reg=0.00189 | L2-Norm=13.749 | L2-Norm(final)=3.002 | acc=1.0000 | 4563.8 samples/s | 71.3 steps/s
[Step=13600 Epoch=52.1] | Loss=0.00028 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=3.003 | acc=1.0000 | 2190.7 samples/s | 34.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step13600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00013, len=1
[Step=14401 Epoch=55.4] | Loss=0.03834 | Reg=0.00189 | L2-Norm=13.754 | L2-Norm(final)=2.988 | acc=0.9844 | 4317.0 samples/s | 67.5 steps/s
[Step=14450 Epoch=55.6] | Loss=0.00468 | Reg=0.00190 | L2-Norm=13.777 | L2-Norm(final)=2.988 | acc=1.0000 | 4438.1 samples/s | 69.3 steps/s
[Step=14500 Epoch=55.8] | Loss=0.00243 | Reg=0.00190 | L2-Norm=13.781 | L2-Norm(final)=2.988 | acc=1.0000 | 4677.7 samples/s | 73.1 steps/s
[Step=14550 Epoch=56.0] | Loss=0.00166 | Reg=0.00190 | L2-Norm=13.781 | L2-Norm(final)=2.989 | acc=1.0000 | 4580.5 samples/s | 71.6 steps/s
[Step=14600 Epoch=56.2] | Loss=0.00126 | Reg=0.00190 | L2-Norm=13.779 | L2-Norm(final)=2.989 | acc=1.0000 | 4713.8 samples/s | 73.7 steps/s
[Step=14650 Epoch=56.4] | Loss=0.00101 | Reg=0.00190 | L2-Norm=13.777 | L2-Norm(final)=2.990 | acc=1.0000 | 6046.2 samples/s | 94.5 steps/s
[Step=14700 Epoch=56.6] | Loss=0.00085 | Reg=0.00190 | L2-Norm=13.774 | L2-Norm(final)=2.990 | acc=1.0000 | 2047.4 samples/s | 32.0 steps/s
[Step=14750 Epoch=56.8] | Loss=0.00073 | Reg=0.00190 | L2-Norm=13.771 | L2-Norm(final)=2.991 | acc=1.0000 | 4586.0 samples/s | 71.7 steps/s
[Step=14800 Epoch=57.0] | Loss=0.00064 | Reg=0.00190 | L2-Norm=13.768 | L2-Norm(final)=2.991 | acc=1.0000 | 4649.9 samples/s | 72.7 steps/s
[Step=14850 Epoch=57.2] | Loss=0.00057 | Reg=0.00189 | L2-Norm=13.765 | L2-Norm(final)=2.992 | acc=1.0000 | 4698.2 samples/s | 73.4 steps/s
[Step=14900 Epoch=57.4] | Loss=0.00051 | Reg=0.00189 | L2-Norm=13.762 | L2-Norm(final)=2.992 | acc=1.0000 | 5232.5 samples/s | 81.8 steps/s
[Step=14950 Epoch=57.5] | Loss=0.00047 | Reg=0.00189 | L2-Norm=13.758 | L2-Norm(final)=2.992 | acc=1.0000 | 2139.2 samples/s | 33.4 steps/s
[Step=15000 Epoch=57.7] | Loss=0.00043 | Reg=0.00189 | L2-Norm=13.755 | L2-Norm(final)=2.993 | acc=1.0000 | 4552.7 samples/s | 71.1 steps/s
[Step=15050 Epoch=57.9] | Loss=0.00040 | Reg=0.00189 | L2-Norm=13.751 | L2-Norm(final)=2.993 | acc=1.0000 | 4636.1 samples/s | 72.4 steps/s
[Step=15100 Epoch=58.1] | Loss=0.00037 | Reg=0.00189 | L2-Norm=13.747 | L2-Norm(final)=2.993 | acc=1.0000 | 4684.2 samples/s | 73.2 steps/s
[Step=15150 Epoch=58.3] | Loss=0.00035 | Reg=0.00189 | L2-Norm=13.744 | L2-Norm(final)=2.994 | acc=1.0000 | 4665.8 samples/s | 72.9 steps/s
[Step=15200 Epoch=58.5] | Loss=0.00033 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=2.994 | acc=1.0000 | 2206.5 samples/s | 34.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43147 | acc=0.7888 | tpr=0.6941 | fpr=0.0055 | 4411.5 samples/s | 17.2 steps/s
Avg test loss: 0.43627, Avg test acc: 0.78796, Avg tpr: 0.69412, Avg fpr: 0.00564, total FA: 44

Testing server on iccad2012
[Step=  50] | Loss=0.37919 | acc=0.8906 | tpr=0.9690 | fpr=0.1108 | 4571.7 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.38593 | acc=0.8909 | tpr=0.9723 | fpr=0.1107 | 8783.4 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.39505 | acc=0.8898 | tpr=0.9726 | fpr=0.1117 | 8443.6 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.39951 | acc=0.8898 | tpr=0.9749 | fpr=0.1117 | 8155.2 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.39497 | acc=0.8896 | tpr=0.9764 | fpr=0.1119 | 8546.3 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.39897 | acc=0.8890 | tpr=0.9760 | fpr=0.1126 | 8601.4 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.39873 | acc=0.8894 | tpr=0.9762 | fpr=0.1122 | 8539.3 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.40101 | acc=0.8893 | tpr=0.9748 | fpr=0.1122 | 8807.0 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.40596 | acc=0.8889 | tpr=0.9732 | fpr=0.1127 | 8212.2 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.40532 | acc=0.8888 | tpr=0.9740 | fpr=0.1127 | 8583.1 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.40337 | acc=0.8891 | tpr=0.9749 | fpr=0.1125 | 15513.4 samples/s | 60.6 steps/s
Avg test loss: 0.40304, Avg test acc: 0.88908, Avg tpr: 0.97504, Avg fpr: 0.11248, total FA: 15618

server round 39/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00013, len=1
[Step=17601 Epoch=34.4] | Loss=0.25564 | Reg=0.00189 | L2-Norm=13.743 | L2-Norm(final)=3.004 | acc=0.8750 | 4479.5 samples/s | 70.0 steps/s
[Step=17650 Epoch=34.5] | Loss=0.03916 | Reg=0.00189 | L2-Norm=13.757 | L2-Norm(final)=2.994 | acc=0.9844 | 4832.3 samples/s | 75.5 steps/s
[Step=17700 Epoch=34.6] | Loss=0.02556 | Reg=0.00189 | L2-Norm=13.762 | L2-Norm(final)=2.995 | acc=1.0000 | 4963.8 samples/s | 77.6 steps/s
[Step=17750 Epoch=34.7] | Loss=0.02016 | Reg=0.00189 | L2-Norm=13.765 | L2-Norm(final)=2.996 | acc=1.0000 | 4980.3 samples/s | 77.8 steps/s
[Step=17800 Epoch=34.8] | Loss=0.01755 | Reg=0.00190 | L2-Norm=13.767 | L2-Norm(final)=2.998 | acc=0.9844 | 4929.1 samples/s | 77.0 steps/s
[Step=17850 Epoch=34.9] | Loss=0.01566 | Reg=0.00190 | L2-Norm=13.770 | L2-Norm(final)=3.000 | acc=1.0000 | 4906.7 samples/s | 76.7 steps/s
[Step=17900 Epoch=35.0] | Loss=0.01433 | Reg=0.00190 | L2-Norm=13.772 | L2-Norm(final)=3.002 | acc=1.0000 | 4828.2 samples/s | 75.4 steps/s
[Step=17950 Epoch=35.1] | Loss=0.01361 | Reg=0.00190 | L2-Norm=13.774 | L2-Norm(final)=3.004 | acc=0.9844 | 4841.7 samples/s | 75.7 steps/s
[Step=18000 Epoch=35.2] | Loss=0.01318 | Reg=0.00190 | L2-Norm=13.776 | L2-Norm(final)=3.006 | acc=1.0000 | 4794.2 samples/s | 74.9 steps/s
[Step=18050 Epoch=35.3] | Loss=0.01252 | Reg=0.00190 | L2-Norm=13.778 | L2-Norm(final)=3.008 | acc=1.0000 | 4883.4 samples/s | 76.3 steps/s
[Step=18100 Epoch=35.4] | Loss=0.01212 | Reg=0.00190 | L2-Norm=13.779 | L2-Norm(final)=3.010 | acc=1.0000 | 6088.7 samples/s | 95.1 steps/s
[Step=18150 Epoch=35.5] | Loss=0.01156 | Reg=0.00190 | L2-Norm=13.781 | L2-Norm(final)=3.012 | acc=1.0000 | 2131.2 samples/s | 33.3 steps/s
[Step=18200 Epoch=35.6] | Loss=0.01109 | Reg=0.00190 | L2-Norm=13.783 | L2-Norm(final)=3.015 | acc=1.0000 | 4801.4 samples/s | 75.0 steps/s
[Step=18250 Epoch=35.7] | Loss=0.01085 | Reg=0.00190 | L2-Norm=13.785 | L2-Norm(final)=3.017 | acc=1.0000 | 4894.8 samples/s | 76.5 steps/s
[Step=18300 Epoch=35.8] | Loss=0.01053 | Reg=0.00190 | L2-Norm=13.787 | L2-Norm(final)=3.019 | acc=1.0000 | 4777.5 samples/s | 74.6 steps/s
[Step=18350 Epoch=35.9] | Loss=0.01033 | Reg=0.00190 | L2-Norm=13.788 | L2-Norm(final)=3.021 | acc=1.0000 | 4867.6 samples/s | 76.1 steps/s
[Step=18400 Epoch=36.0] | Loss=0.01023 | Reg=0.00190 | L2-Norm=13.790 | L2-Norm(final)=3.023 | acc=0.9688 | 4873.3 samples/s | 76.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step18400.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00013, len=1
[Step=13601 Epoch=52.1] | Loss=0.11220 | Reg=0.00189 | L2-Norm=13.743 | L2-Norm(final)=3.005 | acc=0.9375 | 4305.2 samples/s | 67.3 steps/s
[Step=13650 Epoch=52.3] | Loss=0.00403 | Reg=0.00190 | L2-Norm=13.771 | L2-Norm(final)=3.006 | acc=1.0000 | 4295.4 samples/s | 67.1 steps/s
[Step=13700 Epoch=52.5] | Loss=0.00205 | Reg=0.00190 | L2-Norm=13.774 | L2-Norm(final)=3.006 | acc=1.0000 | 4684.5 samples/s | 73.2 steps/s
[Step=13750 Epoch=52.7] | Loss=0.00139 | Reg=0.00190 | L2-Norm=13.773 | L2-Norm(final)=3.007 | acc=1.0000 | 4790.5 samples/s | 74.9 steps/s
[Step=13800 Epoch=52.9] | Loss=0.00105 | Reg=0.00190 | L2-Norm=13.772 | L2-Norm(final)=3.007 | acc=1.0000 | 4556.7 samples/s | 71.2 steps/s
[Step=13850 Epoch=53.1] | Loss=0.00085 | Reg=0.00190 | L2-Norm=13.769 | L2-Norm(final)=3.008 | acc=1.0000 | 5751.4 samples/s | 89.9 steps/s
[Step=13900 Epoch=53.3] | Loss=0.00072 | Reg=0.00190 | L2-Norm=13.767 | L2-Norm(final)=3.008 | acc=1.0000 | 2022.3 samples/s | 31.6 steps/s
[Step=13950 Epoch=53.5] | Loss=0.00062 | Reg=0.00189 | L2-Norm=13.765 | L2-Norm(final)=3.009 | acc=1.0000 | 4632.3 samples/s | 72.4 steps/s
[Step=14000 Epoch=53.6] | Loss=0.00054 | Reg=0.00189 | L2-Norm=13.762 | L2-Norm(final)=3.009 | acc=1.0000 | 4631.0 samples/s | 72.4 steps/s
[Step=14050 Epoch=53.8] | Loss=0.00048 | Reg=0.00189 | L2-Norm=13.759 | L2-Norm(final)=3.010 | acc=1.0000 | 4581.1 samples/s | 71.6 steps/s
[Step=14100 Epoch=54.0] | Loss=0.00044 | Reg=0.00189 | L2-Norm=13.756 | L2-Norm(final)=3.010 | acc=1.0000 | 5068.5 samples/s | 79.2 steps/s
[Step=14150 Epoch=54.2] | Loss=0.00040 | Reg=0.00189 | L2-Norm=13.753 | L2-Norm(final)=3.010 | acc=1.0000 | 2133.6 samples/s | 33.3 steps/s
[Step=14200 Epoch=54.4] | Loss=0.00037 | Reg=0.00189 | L2-Norm=13.750 | L2-Norm(final)=3.011 | acc=1.0000 | 4647.4 samples/s | 72.6 steps/s
[Step=14250 Epoch=54.6] | Loss=0.00034 | Reg=0.00189 | L2-Norm=13.747 | L2-Norm(final)=3.011 | acc=1.0000 | 4610.1 samples/s | 72.0 steps/s
[Step=14300 Epoch=54.8] | Loss=0.00032 | Reg=0.00189 | L2-Norm=13.743 | L2-Norm(final)=3.012 | acc=1.0000 | 4674.1 samples/s | 73.0 steps/s
[Step=14350 Epoch=55.0] | Loss=0.00030 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.012 | acc=1.0000 | 4677.8 samples/s | 73.1 steps/s
[Step=14400 Epoch=55.2] | Loss=0.00028 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.012 | acc=1.0000 | 2215.4 samples/s | 34.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44694 | acc=0.7810 | tpr=0.6827 | fpr=0.0055 | 4447.4 samples/s | 17.4 steps/s
Avg test loss: 0.45106, Avg test acc: 0.78043, Avg tpr: 0.68316, Avg fpr: 0.00564, total FA: 44

Testing server on iccad2012
[Step=  50] | Loss=0.36937 | acc=0.8934 | tpr=0.9602 | fpr=0.1078 | 4611.3 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.37526 | acc=0.8949 | tpr=0.9659 | fpr=0.1064 | 8337.1 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.38459 | acc=0.8933 | tpr=0.9683 | fpr=0.1081 | 8442.7 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.38889 | acc=0.8931 | tpr=0.9716 | fpr=0.1083 | 8553.0 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.38448 | acc=0.8928 | tpr=0.9738 | fpr=0.1087 | 8575.6 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.38828 | acc=0.8922 | tpr=0.9731 | fpr=0.1093 | 8465.2 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.38811 | acc=0.8924 | tpr=0.9737 | fpr=0.1090 | 8773.2 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.39039 | acc=0.8925 | tpr=0.9726 | fpr=0.1089 | 8035.3 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.39529 | acc=0.8920 | tpr=0.9713 | fpr=0.1094 | 8375.4 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.39459 | acc=0.8920 | tpr=0.9718 | fpr=0.1094 | 8261.1 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.39274 | acc=0.8924 | tpr=0.9729 | fpr=0.1091 | 15583.4 samples/s | 60.9 steps/s
Avg test loss: 0.39242, Avg test acc: 0.89240, Avg tpr: 0.97266, Avg fpr: 0.10906, total FA: 15143

server round 40/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=18401 Epoch=36.0] | Loss=0.26703 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.018 | acc=0.8438 | 4283.4 samples/s | 66.9 steps/s
[Step=18450 Epoch=36.1] | Loss=0.04038 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.015 | acc=0.9844 | 4837.9 samples/s | 75.6 steps/s
[Step=18500 Epoch=36.2] | Loss=0.02493 | Reg=0.00189 | L2-Norm=13.741 | L2-Norm(final)=3.015 | acc=1.0000 | 4781.8 samples/s | 74.7 steps/s
[Step=18550 Epoch=36.3] | Loss=0.01948 | Reg=0.00189 | L2-Norm=13.743 | L2-Norm(final)=3.016 | acc=0.9844 | 4893.4 samples/s | 76.5 steps/s
[Step=18600 Epoch=36.4] | Loss=0.01702 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=3.018 | acc=1.0000 | 4854.8 samples/s | 75.9 steps/s
[Step=18650 Epoch=36.5] | Loss=0.01514 | Reg=0.00189 | L2-Norm=13.747 | L2-Norm(final)=3.019 | acc=1.0000 | 4866.9 samples/s | 76.0 steps/s
[Step=18700 Epoch=36.6] | Loss=0.01402 | Reg=0.00189 | L2-Norm=13.748 | L2-Norm(final)=3.020 | acc=1.0000 | 4817.1 samples/s | 75.3 steps/s
[Step=18750 Epoch=36.7] | Loss=0.01310 | Reg=0.00189 | L2-Norm=13.749 | L2-Norm(final)=3.022 | acc=1.0000 | 4928.5 samples/s | 77.0 steps/s
[Step=18800 Epoch=36.8] | Loss=0.01246 | Reg=0.00189 | L2-Norm=13.750 | L2-Norm(final)=3.023 | acc=0.9844 | 4835.0 samples/s | 75.5 steps/s
[Step=18850 Epoch=36.9] | Loss=0.01172 | Reg=0.00189 | L2-Norm=13.751 | L2-Norm(final)=3.025 | acc=1.0000 | 4810.7 samples/s | 75.2 steps/s
[Step=18900 Epoch=36.9] | Loss=0.01141 | Reg=0.00189 | L2-Norm=13.753 | L2-Norm(final)=3.026 | acc=0.9844 | 6072.5 samples/s | 94.9 steps/s
[Step=18950 Epoch=37.0] | Loss=0.01093 | Reg=0.00189 | L2-Norm=13.754 | L2-Norm(final)=3.027 | acc=0.9688 | 2112.9 samples/s | 33.0 steps/s
[Step=19000 Epoch=37.1] | Loss=0.01051 | Reg=0.00189 | L2-Norm=13.755 | L2-Norm(final)=3.029 | acc=1.0000 | 4846.5 samples/s | 75.7 steps/s
[Step=19050 Epoch=37.2] | Loss=0.01019 | Reg=0.00189 | L2-Norm=13.756 | L2-Norm(final)=3.030 | acc=0.9844 | 4848.9 samples/s | 75.8 steps/s
[Step=19100 Epoch=37.3] | Loss=0.01000 | Reg=0.00189 | L2-Norm=13.756 | L2-Norm(final)=3.031 | acc=0.9688 | 4942.6 samples/s | 77.2 steps/s
[Step=19150 Epoch=37.4] | Loss=0.00968 | Reg=0.00189 | L2-Norm=13.757 | L2-Norm(final)=3.033 | acc=1.0000 | 4926.6 samples/s | 77.0 steps/s
[Step=19200 Epoch=37.5] | Loss=0.00946 | Reg=0.00189 | L2-Norm=13.758 | L2-Norm(final)=3.034 | acc=1.0000 | 4877.4 samples/s | 76.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step19200.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=15201 Epoch=58.5] | Loss=0.03861 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.019 | acc=0.9844 | 4214.7 samples/s | 65.9 steps/s
[Step=15250 Epoch=58.7] | Loss=0.00386 | Reg=0.00189 | L2-Norm=13.744 | L2-Norm(final)=3.022 | acc=1.0000 | 4453.2 samples/s | 69.6 steps/s
[Step=15300 Epoch=58.9] | Loss=0.00200 | Reg=0.00189 | L2-Norm=13.746 | L2-Norm(final)=3.023 | acc=1.0000 | 4422.1 samples/s | 69.1 steps/s
[Step=15350 Epoch=59.1] | Loss=0.00143 | Reg=0.00189 | L2-Norm=13.746 | L2-Norm(final)=3.024 | acc=1.0000 | 4548.5 samples/s | 71.1 steps/s
[Step=15400 Epoch=59.3] | Loss=0.00108 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=3.025 | acc=1.0000 | 4527.4 samples/s | 70.7 steps/s
[Step=15450 Epoch=59.5] | Loss=0.00088 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=3.026 | acc=1.0000 | 5860.1 samples/s | 91.6 steps/s
[Step=15500 Epoch=59.7] | Loss=0.00074 | Reg=0.00189 | L2-Norm=13.743 | L2-Norm(final)=3.026 | acc=1.0000 | 2020.0 samples/s | 31.6 steps/s
[Step=15550 Epoch=59.9] | Loss=0.00063 | Reg=0.00189 | L2-Norm=13.742 | L2-Norm(final)=3.026 | acc=1.0000 | 4690.4 samples/s | 73.3 steps/s
[Step=15600 Epoch=60.1] | Loss=0.00056 | Reg=0.00189 | L2-Norm=13.741 | L2-Norm(final)=3.027 | acc=1.0000 | 4615.4 samples/s | 72.1 steps/s
[Step=15650 Epoch=60.2] | Loss=0.00050 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.027 | acc=1.0000 | 4637.7 samples/s | 72.5 steps/s
[Step=15700 Epoch=60.4] | Loss=0.00045 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=3.027 | acc=1.0000 | 5160.1 samples/s | 80.6 steps/s
[Step=15750 Epoch=60.6] | Loss=0.00041 | Reg=0.00189 | L2-Norm=13.736 | L2-Norm(final)=3.028 | acc=1.0000 | 2121.8 samples/s | 33.2 steps/s
[Step=15800 Epoch=60.8] | Loss=0.00038 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.028 | acc=1.0000 | 4616.5 samples/s | 72.1 steps/s
[Step=15850 Epoch=61.0] | Loss=0.00035 | Reg=0.00189 | L2-Norm=13.733 | L2-Norm(final)=3.028 | acc=1.0000 | 4670.6 samples/s | 73.0 steps/s
[Step=15900 Epoch=61.2] | Loss=0.00033 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.028 | acc=1.0000 | 4555.9 samples/s | 71.2 steps/s
[Step=15950 Epoch=61.4] | Loss=0.00031 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.029 | acc=1.0000 | 4775.6 samples/s | 74.6 steps/s
[Step=16000 Epoch=61.6] | Loss=0.00029 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.029 | acc=1.0000 | 2180.9 samples/s | 34.1 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40792 | acc=0.7998 | tpr=0.7103 | fpr=0.0057 | 4502.6 samples/s | 17.6 steps/s
Avg test loss: 0.41282, Avg test acc: 0.79910, Avg tpr: 0.71038, Avg fpr: 0.00577, total FA: 45

Testing server on iccad2012
[Step=  50] | Loss=0.38477 | acc=0.8873 | tpr=0.9602 | fpr=0.1140 | 4646.6 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.39167 | acc=0.8889 | tpr=0.9680 | fpr=0.1126 | 8002.0 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.40090 | acc=0.8879 | tpr=0.9683 | fpr=0.1136 | 8528.3 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.40508 | acc=0.8879 | tpr=0.9716 | fpr=0.1136 | 8722.0 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.40073 | acc=0.8876 | tpr=0.9738 | fpr=0.1140 | 8554.7 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.40451 | acc=0.8869 | tpr=0.9716 | fpr=0.1146 | 8508.7 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.40426 | acc=0.8872 | tpr=0.9724 | fpr=0.1143 | 8497.2 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.40663 | acc=0.8871 | tpr=0.9716 | fpr=0.1145 | 8422.5 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.41168 | acc=0.8865 | tpr=0.9698 | fpr=0.1150 | 9252.7 samples/s | 36.1 steps/s
[Step= 500] | Loss=0.41096 | acc=0.8864 | tpr=0.9700 | fpr=0.1151 | 7871.1 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.40910 | acc=0.8867 | tpr=0.9713 | fpr=0.1149 | 15495.5 samples/s | 60.5 steps/s
Avg test loss: 0.40882, Avg test acc: 0.88670, Avg tpr: 0.97108, Avg fpr: 0.11483, total FA: 15944

server round 41/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=16001 Epoch=31.2] | Loss=0.17964 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.027 | acc=0.8906 | 4243.5 samples/s | 66.3 steps/s
[Step=16050 Epoch=31.3] | Loss=0.03866 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.024 | acc=0.9844 | 4744.1 samples/s | 74.1 steps/s
[Step=16100 Epoch=31.4] | Loss=0.02349 | Reg=0.00189 | L2-Norm=13.742 | L2-Norm(final)=3.025 | acc=1.0000 | 4765.3 samples/s | 74.5 steps/s
[Step=16150 Epoch=31.5] | Loss=0.01853 | Reg=0.00189 | L2-Norm=13.744 | L2-Norm(final)=3.026 | acc=1.0000 | 4887.9 samples/s | 76.4 steps/s
[Step=16200 Epoch=31.6] | Loss=0.01646 | Reg=0.00189 | L2-Norm=13.746 | L2-Norm(final)=3.027 | acc=0.9844 | 4931.9 samples/s | 77.1 steps/s
[Step=16250 Epoch=31.7] | Loss=0.01474 | Reg=0.00189 | L2-Norm=13.748 | L2-Norm(final)=3.029 | acc=0.9844 | 4968.9 samples/s | 77.6 steps/s
[Step=16300 Epoch=31.8] | Loss=0.01383 | Reg=0.00189 | L2-Norm=13.749 | L2-Norm(final)=3.030 | acc=1.0000 | 4884.7 samples/s | 76.3 steps/s
[Step=16350 Epoch=31.9] | Loss=0.01330 | Reg=0.00189 | L2-Norm=13.750 | L2-Norm(final)=3.031 | acc=0.9844 | 4839.5 samples/s | 75.6 steps/s
[Step=16400 Epoch=32.0] | Loss=0.01254 | Reg=0.00189 | L2-Norm=13.751 | L2-Norm(final)=3.033 | acc=1.0000 | 4938.0 samples/s | 77.2 steps/s
[Step=16450 Epoch=32.1] | Loss=0.01204 | Reg=0.00189 | L2-Norm=13.752 | L2-Norm(final)=3.034 | acc=0.9844 | 4873.8 samples/s | 76.2 steps/s
[Step=16500 Epoch=32.2] | Loss=0.01162 | Reg=0.00189 | L2-Norm=13.754 | L2-Norm(final)=3.035 | acc=1.0000 | 5946.1 samples/s | 92.9 steps/s
[Step=16550 Epoch=32.3] | Loss=0.01109 | Reg=0.00189 | L2-Norm=13.755 | L2-Norm(final)=3.036 | acc=1.0000 | 2050.4 samples/s | 32.0 steps/s
[Step=16600 Epoch=32.4] | Loss=0.01054 | Reg=0.00189 | L2-Norm=13.756 | L2-Norm(final)=3.037 | acc=1.0000 | 4865.0 samples/s | 76.0 steps/s
[Step=16650 Epoch=32.5] | Loss=0.01021 | Reg=0.00189 | L2-Norm=13.757 | L2-Norm(final)=3.039 | acc=1.0000 | 4845.6 samples/s | 75.7 steps/s
[Step=16700 Epoch=32.6] | Loss=0.00989 | Reg=0.00189 | L2-Norm=13.758 | L2-Norm(final)=3.040 | acc=0.9844 | 4908.0 samples/s | 76.7 steps/s
[Step=16750 Epoch=32.7] | Loss=0.00967 | Reg=0.00189 | L2-Norm=13.759 | L2-Norm(final)=3.041 | acc=1.0000 | 4888.3 samples/s | 76.4 steps/s
[Step=16800 Epoch=32.8] | Loss=0.00956 | Reg=0.00189 | L2-Norm=13.760 | L2-Norm(final)=3.043 | acc=1.0000 | 4905.5 samples/s | 76.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step16800.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=14401 Epoch=55.2] | Loss=0.10781 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.028 | acc=0.9531 | 4356.6 samples/s | 68.1 steps/s
[Step=14450 Epoch=55.4] | Loss=0.00592 | Reg=0.00189 | L2-Norm=13.747 | L2-Norm(final)=3.031 | acc=1.0000 | 4415.2 samples/s | 69.0 steps/s
[Step=14500 Epoch=55.6] | Loss=0.00301 | Reg=0.00189 | L2-Norm=13.749 | L2-Norm(final)=3.032 | acc=1.0000 | 4603.7 samples/s | 71.9 steps/s
[Step=14550 Epoch=55.8] | Loss=0.00204 | Reg=0.00189 | L2-Norm=13.749 | L2-Norm(final)=3.033 | acc=1.0000 | 4587.9 samples/s | 71.7 steps/s
[Step=14600 Epoch=55.9] | Loss=0.00154 | Reg=0.00189 | L2-Norm=13.749 | L2-Norm(final)=3.033 | acc=1.0000 | 4650.6 samples/s | 72.7 steps/s
[Step=14650 Epoch=56.1] | Loss=0.00125 | Reg=0.00189 | L2-Norm=13.748 | L2-Norm(final)=3.034 | acc=1.0000 | 5781.4 samples/s | 90.3 steps/s
[Step=14700 Epoch=56.3] | Loss=0.00105 | Reg=0.00189 | L2-Norm=13.747 | L2-Norm(final)=3.034 | acc=1.0000 | 2026.9 samples/s | 31.7 steps/s
[Step=14750 Epoch=56.5] | Loss=0.00090 | Reg=0.00189 | L2-Norm=13.746 | L2-Norm(final)=3.034 | acc=1.0000 | 4585.8 samples/s | 71.7 steps/s
[Step=14800 Epoch=56.7] | Loss=0.00079 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=3.035 | acc=1.0000 | 4595.6 samples/s | 71.8 steps/s
[Step=14850 Epoch=56.9] | Loss=0.00071 | Reg=0.00189 | L2-Norm=13.744 | L2-Norm(final)=3.035 | acc=1.0000 | 4664.7 samples/s | 72.9 steps/s
[Step=14900 Epoch=57.1] | Loss=0.00064 | Reg=0.00189 | L2-Norm=13.743 | L2-Norm(final)=3.035 | acc=1.0000 | 5061.3 samples/s | 79.1 steps/s
[Step=14950 Epoch=57.3] | Loss=0.00059 | Reg=0.00189 | L2-Norm=13.741 | L2-Norm(final)=3.036 | acc=1.0000 | 2156.0 samples/s | 33.7 steps/s
[Step=15000 Epoch=57.5] | Loss=0.00054 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.036 | acc=1.0000 | 4604.3 samples/s | 71.9 steps/s
[Step=15050 Epoch=57.7] | Loss=0.00050 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.036 | acc=1.0000 | 4593.0 samples/s | 71.8 steps/s
[Step=15100 Epoch=57.9] | Loss=0.00047 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.036 | acc=1.0000 | 4713.8 samples/s | 73.7 steps/s
[Step=15150 Epoch=58.0] | Loss=0.00044 | Reg=0.00189 | L2-Norm=13.736 | L2-Norm(final)=3.037 | acc=1.0000 | 4573.4 samples/s | 71.5 steps/s
[Step=15200 Epoch=58.2] | Loss=0.00041 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.037 | acc=1.0000 | 2240.1 samples/s | 35.0 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36515 | acc=0.8187 | tpr=0.7376 | fpr=0.0052 | 4549.2 samples/s | 17.8 steps/s
Avg test loss: 0.37012, Avg test acc: 0.81773, Avg tpr: 0.73748, Avg fpr: 0.00577, total FA: 45

Testing server on iccad2012
[Step=  50] | Loss=0.42554 | acc=0.8743 | tpr=0.9602 | fpr=0.1272 | 4469.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.43293 | acc=0.8756 | tpr=0.9659 | fpr=0.1261 | 8617.6 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.44209 | acc=0.8748 | tpr=0.9683 | fpr=0.1269 | 8674.8 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.44636 | acc=0.8746 | tpr=0.9716 | fpr=0.1272 | 8376.2 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.44208 | acc=0.8739 | tpr=0.9747 | fpr=0.1280 | 8990.5 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.44633 | acc=0.8727 | tpr=0.9731 | fpr=0.1291 | 8166.7 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.44593 | acc=0.8730 | tpr=0.9737 | fpr=0.1288 | 8378.9 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.44841 | acc=0.8727 | tpr=0.9726 | fpr=0.1291 | 8589.7 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.45354 | acc=0.8724 | tpr=0.9708 | fpr=0.1294 | 8771.7 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.45299 | acc=0.8724 | tpr=0.9714 | fpr=0.1294 | 8292.1 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.45100 | acc=0.8727 | tpr=0.9725 | fpr=0.1291 | 15496.6 samples/s | 60.5 steps/s
Avg test loss: 0.45071, Avg test acc: 0.87267, Avg tpr: 0.97227, Avg fpr: 0.12914, total FA: 17931

server round 42/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=15201 Epoch=58.2] | Loss=0.12374 | Reg=0.00188 | L2-Norm=13.723 | L2-Norm(final)=3.047 | acc=0.9531 | 4298.7 samples/s | 67.2 steps/s
[Step=15250 Epoch=58.4] | Loss=0.00571 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=3.052 | acc=1.0000 | 4557.0 samples/s | 71.2 steps/s
[Step=15300 Epoch=58.6] | Loss=0.00288 | Reg=0.00189 | L2-Norm=13.741 | L2-Norm(final)=3.053 | acc=1.0000 | 4681.6 samples/s | 73.2 steps/s
[Step=15350 Epoch=58.8] | Loss=0.00194 | Reg=0.00189 | L2-Norm=13.741 | L2-Norm(final)=3.053 | acc=1.0000 | 4603.0 samples/s | 71.9 steps/s
[Step=15400 Epoch=59.0] | Loss=0.00148 | Reg=0.00189 | L2-Norm=13.741 | L2-Norm(final)=3.054 | acc=1.0000 | 4638.3 samples/s | 72.5 steps/s
[Step=15450 Epoch=59.2] | Loss=0.00120 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.054 | acc=1.0000 | 5965.5 samples/s | 93.2 steps/s
[Step=15500 Epoch=59.4] | Loss=0.00100 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.055 | acc=1.0000 | 2028.9 samples/s | 31.7 steps/s
[Step=15550 Epoch=59.6] | Loss=0.00086 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=3.055 | acc=1.0000 | 4607.0 samples/s | 72.0 steps/s
[Step=15600 Epoch=59.8] | Loss=0.00076 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.055 | acc=1.0000 | 4672.3 samples/s | 73.0 steps/s
[Step=15650 Epoch=60.0] | Loss=0.00068 | Reg=0.00189 | L2-Norm=13.736 | L2-Norm(final)=3.056 | acc=1.0000 | 4715.7 samples/s | 73.7 steps/s
[Step=15700 Epoch=60.2] | Loss=0.00061 | Reg=0.00189 | L2-Norm=13.735 | L2-Norm(final)=3.056 | acc=1.0000 | 5067.6 samples/s | 79.2 steps/s
[Step=15750 Epoch=60.3] | Loss=0.00056 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.056 | acc=1.0000 | 2144.4 samples/s | 33.5 steps/s
[Step=15800 Epoch=60.5] | Loss=0.00051 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.056 | acc=1.0000 | 4665.6 samples/s | 72.9 steps/s
[Step=15850 Epoch=60.7] | Loss=0.00048 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.057 | acc=1.0000 | 4644.0 samples/s | 72.6 steps/s
[Step=15900 Epoch=60.9] | Loss=0.00044 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.057 | acc=1.0000 | 4752.3 samples/s | 74.3 steps/s
[Step=15950 Epoch=61.1] | Loss=0.00042 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=3.057 | acc=1.0000 | 4575.5 samples/s | 71.5 steps/s
[Step=16000 Epoch=61.3] | Loss=0.00039 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.057 | acc=1.0000 | 2169.9 samples/s | 33.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=16001 Epoch=61.6] | Loss=0.11193 | Reg=0.00188 | L2-Norm=13.723 | L2-Norm(final)=3.047 | acc=0.9531 | 4152.4 samples/s | 64.9 steps/s
[Step=16050 Epoch=61.8] | Loss=0.00749 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.047 | acc=1.0000 | 4630.2 samples/s | 72.3 steps/s
[Step=16100 Epoch=62.0] | Loss=0.00377 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.047 | acc=1.0000 | 4560.7 samples/s | 71.3 steps/s
[Step=16150 Epoch=62.2] | Loss=0.00253 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.047 | acc=1.0000 | 4523.0 samples/s | 70.7 steps/s
[Step=16200 Epoch=62.4] | Loss=0.00191 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=3.048 | acc=1.0000 | 4598.3 samples/s | 71.8 steps/s
[Step=16250 Epoch=62.6] | Loss=0.00153 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.048 | acc=1.0000 | 5999.1 samples/s | 93.7 steps/s
[Step=16300 Epoch=62.7] | Loss=0.00129 | Reg=0.00189 | L2-Norm=13.736 | L2-Norm(final)=3.048 | acc=1.0000 | 2033.9 samples/s | 31.8 steps/s
[Step=16350 Epoch=62.9] | Loss=0.00111 | Reg=0.00189 | L2-Norm=13.735 | L2-Norm(final)=3.048 | acc=1.0000 | 4635.0 samples/s | 72.4 steps/s
[Step=16400 Epoch=63.1] | Loss=0.00097 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.049 | acc=1.0000 | 4582.2 samples/s | 71.6 steps/s
[Step=16450 Epoch=63.3] | Loss=0.00086 | Reg=0.00189 | L2-Norm=13.733 | L2-Norm(final)=3.049 | acc=1.0000 | 4571.1 samples/s | 71.4 steps/s
[Step=16500 Epoch=63.5] | Loss=0.00078 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.049 | acc=1.0000 | 5168.8 samples/s | 80.8 steps/s
[Step=16550 Epoch=63.7] | Loss=0.00071 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.049 | acc=1.0000 | 2115.9 samples/s | 33.1 steps/s
[Step=16600 Epoch=63.9] | Loss=0.00065 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.049 | acc=1.0000 | 4611.9 samples/s | 72.1 steps/s
[Step=16650 Epoch=64.1] | Loss=0.00061 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=3.050 | acc=1.0000 | 4675.7 samples/s | 73.1 steps/s
[Step=16700 Epoch=64.3] | Loss=0.00056 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.050 | acc=1.0000 | 4461.3 samples/s | 69.7 steps/s
[Step=16750 Epoch=64.5] | Loss=0.00053 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=3.050 | acc=1.0000 | 4707.7 samples/s | 73.6 steps/s
[Step=16800 Epoch=64.7] | Loss=0.00050 | Reg=0.00188 | L2-Norm=13.723 | L2-Norm(final)=3.050 | acc=1.0000 | 2218.4 samples/s | 34.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35319 | acc=0.8237 | tpr=0.7449 | fpr=0.0052 | 4468.6 samples/s | 17.5 steps/s
Avg test loss: 0.35773, Avg test acc: 0.82302, Avg tpr: 0.74535, Avg fpr: 0.00615, total FA: 48

Testing server on iccad2012
[Step=  50] | Loss=0.42811 | acc=0.8725 | tpr=0.9558 | fpr=0.1290 | 4511.9 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.43569 | acc=0.8740 | tpr=0.9638 | fpr=0.1277 | 8734.6 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.44426 | acc=0.8737 | tpr=0.9669 | fpr=0.1280 | 8445.2 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.44858 | acc=0.8737 | tpr=0.9705 | fpr=0.1281 | 8364.6 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.44445 | acc=0.8734 | tpr=0.9738 | fpr=0.1284 | 9069.9 samples/s | 35.4 steps/s
[Step= 300] | Loss=0.44865 | acc=0.8724 | tpr=0.9724 | fpr=0.1294 | 7933.7 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.44831 | acc=0.8727 | tpr=0.9731 | fpr=0.1291 | 8614.1 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.45081 | acc=0.8725 | tpr=0.9721 | fpr=0.1293 | 8454.5 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.45597 | acc=0.8722 | tpr=0.9703 | fpr=0.1296 | 8709.1 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.45520 | acc=0.8723 | tpr=0.9709 | fpr=0.1295 | 8178.3 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.45314 | acc=0.8727 | tpr=0.9721 | fpr=0.1291 | 15833.5 samples/s | 61.8 steps/s
Avg test loss: 0.45285, Avg test acc: 0.87266, Avg tpr: 0.97187, Avg fpr: 0.12914, total FA: 17931

server round 43/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=16801 Epoch=32.8] | Loss=0.23390 | Reg=0.00188 | L2-Norm=13.722 | L2-Norm(final)=3.057 | acc=0.8906 | 4367.5 samples/s | 68.2 steps/s
[Step=16850 Epoch=32.9] | Loss=0.03885 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=3.053 | acc=0.9531 | 4573.4 samples/s | 71.5 steps/s
[Step=16900 Epoch=33.0] | Loss=0.02410 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.053 | acc=0.9688 | 4865.0 samples/s | 76.0 steps/s
[Step=16950 Epoch=33.1] | Loss=0.01839 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.054 | acc=1.0000 | 4934.1 samples/s | 77.1 steps/s
[Step=17000 Epoch=33.2] | Loss=0.01599 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.056 | acc=1.0000 | 4957.7 samples/s | 77.5 steps/s
[Step=17050 Epoch=33.3] | Loss=0.01416 | Reg=0.00189 | L2-Norm=13.735 | L2-Norm(final)=3.057 | acc=1.0000 | 4930.6 samples/s | 77.0 steps/s
[Step=17100 Epoch=33.4] | Loss=0.01304 | Reg=0.00189 | L2-Norm=13.736 | L2-Norm(final)=3.058 | acc=1.0000 | 4981.7 samples/s | 77.8 steps/s
[Step=17150 Epoch=33.4] | Loss=0.01246 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=3.059 | acc=1.0000 | 4919.4 samples/s | 76.9 steps/s
[Step=17200 Epoch=33.5] | Loss=0.01184 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.061 | acc=1.0000 | 4882.0 samples/s | 76.3 steps/s
[Step=17250 Epoch=33.6] | Loss=0.01143 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.062 | acc=0.9844 | 4856.8 samples/s | 75.9 steps/s
[Step=17300 Epoch=33.7] | Loss=0.01093 | Reg=0.00189 | L2-Norm=13.741 | L2-Norm(final)=3.063 | acc=0.9844 | 5943.1 samples/s | 92.9 steps/s
[Step=17350 Epoch=33.8] | Loss=0.01059 | Reg=0.00189 | L2-Norm=13.742 | L2-Norm(final)=3.064 | acc=1.0000 | 2011.8 samples/s | 31.4 steps/s
[Step=17400 Epoch=33.9] | Loss=0.01033 | Reg=0.00189 | L2-Norm=13.743 | L2-Norm(final)=3.066 | acc=0.9844 | 4775.1 samples/s | 74.6 steps/s
[Step=17450 Epoch=34.0] | Loss=0.00996 | Reg=0.00189 | L2-Norm=13.744 | L2-Norm(final)=3.067 | acc=1.0000 | 4861.7 samples/s | 76.0 steps/s
[Step=17500 Epoch=34.1] | Loss=0.00956 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=3.068 | acc=1.0000 | 4848.4 samples/s | 75.8 steps/s
[Step=17550 Epoch=34.2] | Loss=0.00939 | Reg=0.00189 | L2-Norm=13.746 | L2-Norm(final)=3.069 | acc=0.9844 | 4796.0 samples/s | 74.9 steps/s
[Step=17600 Epoch=34.3] | Loss=0.00922 | Reg=0.00189 | L2-Norm=13.747 | L2-Norm(final)=3.071 | acc=1.0000 | 4854.5 samples/s | 75.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step17600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=16801 Epoch=64.7] | Loss=0.07285 | Reg=0.00188 | L2-Norm=13.722 | L2-Norm(final)=3.057 | acc=0.9375 | 4088.9 samples/s | 63.9 steps/s
[Step=16850 Epoch=64.9] | Loss=0.00659 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.061 | acc=1.0000 | 4334.4 samples/s | 67.7 steps/s
[Step=16900 Epoch=65.1] | Loss=0.00332 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.061 | acc=1.0000 | 4543.8 samples/s | 71.0 steps/s
[Step=16950 Epoch=65.2] | Loss=0.00223 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.062 | acc=1.0000 | 4565.4 samples/s | 71.3 steps/s
[Step=17000 Epoch=65.4] | Loss=0.00168 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.062 | acc=1.0000 | 4633.0 samples/s | 72.4 steps/s
[Step=17050 Epoch=65.6] | Loss=0.00135 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=3.062 | acc=1.0000 | 5917.3 samples/s | 92.5 steps/s
[Step=17100 Epoch=65.8] | Loss=0.00113 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.063 | acc=1.0000 | 2065.0 samples/s | 32.3 steps/s
[Step=17150 Epoch=66.0] | Loss=0.00097 | Reg=0.00189 | L2-Norm=13.736 | L2-Norm(final)=3.063 | acc=1.0000 | 4546.0 samples/s | 71.0 steps/s
[Step=17200 Epoch=66.2] | Loss=0.00085 | Reg=0.00189 | L2-Norm=13.735 | L2-Norm(final)=3.063 | acc=1.0000 | 4657.7 samples/s | 72.8 steps/s
[Step=17250 Epoch=66.4] | Loss=0.00076 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.063 | acc=1.0000 | 4674.5 samples/s | 73.0 steps/s
[Step=17300 Epoch=66.6] | Loss=0.00069 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.063 | acc=1.0000 | 5219.3 samples/s | 81.6 steps/s
[Step=17350 Epoch=66.8] | Loss=0.00062 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.063 | acc=1.0000 | 2125.3 samples/s | 33.2 steps/s
[Step=17400 Epoch=67.0] | Loss=0.00057 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.064 | acc=1.0000 | 4710.2 samples/s | 73.6 steps/s
[Step=17450 Epoch=67.2] | Loss=0.00053 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.064 | acc=1.0000 | 4813.7 samples/s | 75.2 steps/s
[Step=17500 Epoch=67.4] | Loss=0.00050 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.064 | acc=1.0000 | 4662.2 samples/s | 72.8 steps/s
[Step=17550 Epoch=67.6] | Loss=0.00046 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.064 | acc=1.0000 | 4731.7 samples/s | 73.9 steps/s
[Step=17600 Epoch=67.7] | Loss=0.00044 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=3.064 | acc=1.0000 | 2206.7 samples/s | 34.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37578 | acc=0.8166 | tpr=0.7346 | fpr=0.0052 | 4482.8 samples/s | 17.5 steps/s
Avg test loss: 0.37994, Avg test acc: 0.81657, Avg tpr: 0.73591, Avg fpr: 0.00602, total FA: 47

Testing server on iccad2012
[Step=  50] | Loss=0.41656 | acc=0.8794 | tpr=0.9558 | fpr=0.1220 | 4442.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.42373 | acc=0.8809 | tpr=0.9616 | fpr=0.1206 | 8762.5 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.43225 | acc=0.8797 | tpr=0.9640 | fpr=0.1218 | 8286.5 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.43691 | acc=0.8794 | tpr=0.9683 | fpr=0.1223 | 8548.4 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.43268 | acc=0.8790 | tpr=0.9712 | fpr=0.1226 | 8630.5 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.43673 | acc=0.8780 | tpr=0.9702 | fpr=0.1236 | 8837.7 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.43629 | acc=0.8781 | tpr=0.9712 | fpr=0.1236 | 8603.7 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.43882 | acc=0.8778 | tpr=0.9705 | fpr=0.1238 | 8548.1 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.44400 | acc=0.8775 | tpr=0.9688 | fpr=0.1241 | 8282.6 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.44334 | acc=0.8776 | tpr=0.9696 | fpr=0.1241 | 8633.6 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.44127 | acc=0.8778 | tpr=0.9706 | fpr=0.1239 | 15249.4 samples/s | 59.6 steps/s
Avg test loss: 0.44100, Avg test acc: 0.87782, Avg tpr: 0.96989, Avg fpr: 0.12385, total FA: 17197

server round 44/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=19201 Epoch=37.5] | Loss=0.15447 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=3.068 | acc=0.9219 | 4344.1 samples/s | 67.9 steps/s
[Step=19250 Epoch=37.6] | Loss=0.03251 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.065 | acc=1.0000 | 4746.5 samples/s | 74.2 steps/s
[Step=19300 Epoch=37.7] | Loss=0.02045 | Reg=0.00189 | L2-Norm=13.733 | L2-Norm(final)=3.066 | acc=1.0000 | 4842.7 samples/s | 75.7 steps/s
[Step=19350 Epoch=37.8] | Loss=0.01631 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.067 | acc=1.0000 | 4915.1 samples/s | 76.8 steps/s
[Step=19400 Epoch=37.9] | Loss=0.01439 | Reg=0.00189 | L2-Norm=13.736 | L2-Norm(final)=3.068 | acc=0.9844 | 4843.1 samples/s | 75.7 steps/s
[Step=19450 Epoch=38.0] | Loss=0.01290 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.069 | acc=1.0000 | 4906.5 samples/s | 76.7 steps/s
[Step=19500 Epoch=38.1] | Loss=0.01177 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=3.070 | acc=0.9844 | 4926.8 samples/s | 77.0 steps/s
[Step=19550 Epoch=38.2] | Loss=0.01121 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.071 | acc=1.0000 | 4881.6 samples/s | 76.3 steps/s
[Step=19600 Epoch=38.3] | Loss=0.01071 | Reg=0.00189 | L2-Norm=13.741 | L2-Norm(final)=3.073 | acc=0.9688 | 4938.7 samples/s | 77.2 steps/s
[Step=19650 Epoch=38.4] | Loss=0.01030 | Reg=0.00189 | L2-Norm=13.742 | L2-Norm(final)=3.074 | acc=1.0000 | 4932.7 samples/s | 77.1 steps/s
[Step=19700 Epoch=38.5] | Loss=0.01000 | Reg=0.00189 | L2-Norm=13.743 | L2-Norm(final)=3.075 | acc=1.0000 | 6133.1 samples/s | 95.8 steps/s
[Step=19750 Epoch=38.6] | Loss=0.00956 | Reg=0.00189 | L2-Norm=13.744 | L2-Norm(final)=3.076 | acc=0.9844 | 2143.4 samples/s | 33.5 steps/s
[Step=19800 Epoch=38.7] | Loss=0.00914 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=3.078 | acc=0.9844 | 4998.9 samples/s | 78.1 steps/s
[Step=19850 Epoch=38.8] | Loss=0.00867 | Reg=0.00189 | L2-Norm=13.745 | L2-Norm(final)=3.079 | acc=1.0000 | 4754.2 samples/s | 74.3 steps/s
[Step=19900 Epoch=38.9] | Loss=0.00852 | Reg=0.00189 | L2-Norm=13.746 | L2-Norm(final)=3.080 | acc=1.0000 | 4848.0 samples/s | 75.8 steps/s
[Step=19950 Epoch=39.0] | Loss=0.00841 | Reg=0.00189 | L2-Norm=13.747 | L2-Norm(final)=3.081 | acc=0.9844 | 4970.7 samples/s | 77.7 steps/s
[Step=20000 Epoch=39.1] | Loss=0.00823 | Reg=0.00189 | L2-Norm=13.748 | L2-Norm(final)=3.082 | acc=1.0000 | 4986.3 samples/s | 77.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step20000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=16001 Epoch=61.3] | Loss=0.01670 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=3.068 | acc=0.9844 | 3870.9 samples/s | 60.5 steps/s
[Step=16050 Epoch=61.5] | Loss=0.00784 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.071 | acc=1.0000 | 4603.5 samples/s | 71.9 steps/s
[Step=16100 Epoch=61.7] | Loss=0.00400 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.071 | acc=1.0000 | 4686.2 samples/s | 73.2 steps/s
[Step=16150 Epoch=61.9] | Loss=0.00269 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.072 | acc=1.0000 | 4625.0 samples/s | 72.3 steps/s
[Step=16200 Epoch=62.1] | Loss=0.00203 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.072 | acc=1.0000 | 4673.3 samples/s | 73.0 steps/s
[Step=16250 Epoch=62.3] | Loss=0.00164 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.072 | acc=1.0000 | 5924.4 samples/s | 92.6 steps/s
[Step=16300 Epoch=62.5] | Loss=0.00137 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=3.073 | acc=1.0000 | 2033.8 samples/s | 31.8 steps/s
[Step=16350 Epoch=62.6] | Loss=0.00118 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.073 | acc=1.0000 | 4631.7 samples/s | 72.4 steps/s
[Step=16400 Epoch=62.8] | Loss=0.00103 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.073 | acc=1.0000 | 4593.3 samples/s | 71.8 steps/s
[Step=16450 Epoch=63.0] | Loss=0.00092 | Reg=0.00189 | L2-Norm=13.736 | L2-Norm(final)=3.073 | acc=1.0000 | 4670.3 samples/s | 73.0 steps/s
[Step=16500 Epoch=63.2] | Loss=0.00083 | Reg=0.00189 | L2-Norm=13.735 | L2-Norm(final)=3.073 | acc=1.0000 | 5157.4 samples/s | 80.6 steps/s
[Step=16550 Epoch=63.4] | Loss=0.00076 | Reg=0.00189 | L2-Norm=13.733 | L2-Norm(final)=3.074 | acc=1.0000 | 2160.7 samples/s | 33.8 steps/s
[Step=16600 Epoch=63.6] | Loss=0.00070 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.074 | acc=1.0000 | 4581.1 samples/s | 71.6 steps/s
[Step=16650 Epoch=63.8] | Loss=0.00064 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.074 | acc=1.0000 | 4644.4 samples/s | 72.6 steps/s
[Step=16700 Epoch=64.0] | Loss=0.00060 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.074 | acc=1.0000 | 4558.6 samples/s | 71.2 steps/s
[Step=16750 Epoch=64.2] | Loss=0.00056 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.074 | acc=1.0000 | 4662.7 samples/s | 72.9 steps/s
[Step=16800 Epoch=64.4] | Loss=0.00053 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.074 | acc=1.0000 | 2219.3 samples/s | 34.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37290 | acc=0.8187 | tpr=0.7376 | fpr=0.0052 | 4575.4 samples/s | 17.9 steps/s
Avg test loss: 0.37683, Avg test acc: 0.81910, Avg tpr: 0.73958, Avg fpr: 0.00602, total FA: 47

Testing server on iccad2012
[Step=  50] | Loss=0.41223 | acc=0.8809 | tpr=0.9558 | fpr=0.1205 | 4522.6 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.41968 | acc=0.8827 | tpr=0.9616 | fpr=0.1187 | 8501.6 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.42813 | acc=0.8824 | tpr=0.9640 | fpr=0.1191 | 8670.4 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.43274 | acc=0.8823 | tpr=0.9683 | fpr=0.1192 | 8404.2 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.42849 | acc=0.8822 | tpr=0.9703 | fpr=0.1194 | 8788.4 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.43246 | acc=0.8812 | tpr=0.9695 | fpr=0.1204 | 8552.8 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.43188 | acc=0.8814 | tpr=0.9706 | fpr=0.1202 | 8372.0 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.43440 | acc=0.8812 | tpr=0.9694 | fpr=0.1204 | 8507.8 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.43968 | acc=0.8810 | tpr=0.9679 | fpr=0.1206 | 8656.8 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.43904 | acc=0.8809 | tpr=0.9687 | fpr=0.1207 | 8736.6 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.43691 | acc=0.8811 | tpr=0.9698 | fpr=0.1205 | 15078.7 samples/s | 58.9 steps/s
Avg test loss: 0.43664, Avg test acc: 0.88113, Avg tpr: 0.96910, Avg fpr: 0.12047, total FA: 16727

server round 45/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=17601 Epoch=34.3] | Loss=0.19817 | Reg=0.00188 | L2-Norm=13.719 | L2-Norm(final)=3.083 | acc=0.8906 | 4424.1 samples/s | 69.1 steps/s
[Step=17650 Epoch=34.4] | Loss=0.03272 | Reg=0.00188 | L2-Norm=13.724 | L2-Norm(final)=3.081 | acc=1.0000 | 4522.2 samples/s | 70.7 steps/s
[Step=17700 Epoch=34.5] | Loss=0.02001 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.081 | acc=0.9844 | 4817.7 samples/s | 75.3 steps/s
[Step=17750 Epoch=34.6] | Loss=0.01614 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.082 | acc=1.0000 | 4848.9 samples/s | 75.8 steps/s
[Step=17800 Epoch=34.7] | Loss=0.01429 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.083 | acc=0.9844 | 4855.6 samples/s | 75.9 steps/s
[Step=17850 Epoch=34.8] | Loss=0.01270 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.085 | acc=1.0000 | 4876.8 samples/s | 76.2 steps/s
[Step=17900 Epoch=34.9] | Loss=0.01210 | Reg=0.00189 | L2-Norm=13.733 | L2-Norm(final)=3.086 | acc=1.0000 | 4874.6 samples/s | 76.2 steps/s
[Step=17950 Epoch=35.0] | Loss=0.01154 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.087 | acc=0.9844 | 4804.1 samples/s | 75.1 steps/s
[Step=18000 Epoch=35.1] | Loss=0.01127 | Reg=0.00189 | L2-Norm=13.735 | L2-Norm(final)=3.088 | acc=0.9844 | 4936.8 samples/s | 77.1 steps/s
[Step=18050 Epoch=35.2] | Loss=0.01084 | Reg=0.00189 | L2-Norm=13.736 | L2-Norm(final)=3.090 | acc=1.0000 | 4868.2 samples/s | 76.1 steps/s
[Step=18100 Epoch=35.3] | Loss=0.01038 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.091 | acc=1.0000 | 5960.1 samples/s | 93.1 steps/s
[Step=18150 Epoch=35.4] | Loss=0.00995 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=3.092 | acc=1.0000 | 2105.5 samples/s | 32.9 steps/s
[Step=18200 Epoch=35.5] | Loss=0.00973 | Reg=0.00189 | L2-Norm=13.739 | L2-Norm(final)=3.093 | acc=1.0000 | 4850.0 samples/s | 75.8 steps/s
[Step=18250 Epoch=35.6] | Loss=0.00934 | Reg=0.00189 | L2-Norm=13.740 | L2-Norm(final)=3.094 | acc=1.0000 | 4885.3 samples/s | 76.3 steps/s
[Step=18300 Epoch=35.7] | Loss=0.00908 | Reg=0.00189 | L2-Norm=13.741 | L2-Norm(final)=3.096 | acc=1.0000 | 4882.0 samples/s | 76.3 steps/s
[Step=18350 Epoch=35.8] | Loss=0.00893 | Reg=0.00189 | L2-Norm=13.742 | L2-Norm(final)=3.097 | acc=1.0000 | 4859.0 samples/s | 75.9 steps/s
[Step=18400 Epoch=35.9] | Loss=0.00889 | Reg=0.00189 | L2-Norm=13.743 | L2-Norm(final)=3.098 | acc=0.9844 | 5020.7 samples/s | 78.4 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step18400.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=17601 Epoch=67.8] | Loss=0.07675 | Reg=0.00188 | L2-Norm=13.719 | L2-Norm(final)=3.083 | acc=0.9531 | 4204.7 samples/s | 65.7 steps/s
[Step=17650 Epoch=67.9] | Loss=0.00556 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.086 | acc=1.0000 | 4561.7 samples/s | 71.3 steps/s
[Step=17700 Epoch=68.1] | Loss=0.00284 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.087 | acc=1.0000 | 4596.6 samples/s | 71.8 steps/s
[Step=17750 Epoch=68.3] | Loss=0.00193 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.088 | acc=1.0000 | 4575.8 samples/s | 71.5 steps/s
[Step=17800 Epoch=68.5] | Loss=0.00146 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.088 | acc=1.0000 | 4609.7 samples/s | 72.0 steps/s
[Step=17850 Epoch=68.7] | Loss=0.00118 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.089 | acc=1.0000 | 5965.3 samples/s | 93.2 steps/s
[Step=17900 Epoch=68.9] | Loss=0.00099 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.089 | acc=1.0000 | 2048.8 samples/s | 32.0 steps/s
[Step=17950 Epoch=69.1] | Loss=0.00085 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.089 | acc=1.0000 | 4486.6 samples/s | 70.1 steps/s
[Step=18000 Epoch=69.3] | Loss=0.00075 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=3.090 | acc=1.0000 | 4673.6 samples/s | 73.0 steps/s
[Step=18050 Epoch=69.5] | Loss=0.00067 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.090 | acc=1.0000 | 4607.3 samples/s | 72.0 steps/s
[Step=18100 Epoch=69.7] | Loss=0.00060 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=3.090 | acc=1.0000 | 5296.8 samples/s | 82.8 steps/s
[Step=18150 Epoch=69.9] | Loss=0.00055 | Reg=0.00188 | L2-Norm=13.724 | L2-Norm(final)=3.090 | acc=1.0000 | 2140.7 samples/s | 33.4 steps/s
[Step=18200 Epoch=70.1] | Loss=0.00050 | Reg=0.00188 | L2-Norm=13.723 | L2-Norm(final)=3.091 | acc=1.0000 | 4558.0 samples/s | 71.2 steps/s
[Step=18250 Epoch=70.3] | Loss=0.00047 | Reg=0.00188 | L2-Norm=13.722 | L2-Norm(final)=3.091 | acc=1.0000 | 4636.2 samples/s | 72.4 steps/s
[Step=18300 Epoch=70.4] | Loss=0.00043 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=3.091 | acc=1.0000 | 4728.0 samples/s | 73.9 steps/s
[Step=18350 Epoch=70.6] | Loss=0.00041 | Reg=0.00188 | L2-Norm=13.719 | L2-Norm(final)=3.091 | acc=1.0000 | 4736.5 samples/s | 74.0 steps/s
[Step=18400 Epoch=70.8] | Loss=0.00038 | Reg=0.00188 | L2-Norm=13.718 | L2-Norm(final)=3.092 | acc=1.0000 | 2197.7 samples/s | 34.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35423 | acc=0.8263 | tpr=0.7487 | fpr=0.0052 | 4445.5 samples/s | 17.4 steps/s
Avg test loss: 0.35873, Avg test acc: 0.82567, Avg tpr: 0.74914, Avg fpr: 0.00602, total FA: 47

Testing server on iccad2012
[Step=  50] | Loss=0.43084 | acc=0.8779 | tpr=0.9602 | fpr=0.1236 | 4505.3 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.43851 | acc=0.8791 | tpr=0.9659 | fpr=0.1226 | 9126.1 samples/s | 35.6 steps/s
[Step= 150] | Loss=0.44759 | acc=0.8788 | tpr=0.9683 | fpr=0.1228 | 8080.4 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.45222 | acc=0.8787 | tpr=0.9716 | fpr=0.1230 | 8909.3 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.44802 | acc=0.8780 | tpr=0.9738 | fpr=0.1238 | 8659.5 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.45214 | acc=0.8770 | tpr=0.9731 | fpr=0.1247 | 8813.4 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.45150 | acc=0.8772 | tpr=0.9737 | fpr=0.1246 | 8334.4 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.45414 | acc=0.8769 | tpr=0.9726 | fpr=0.1248 | 8541.4 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.45950 | acc=0.8767 | tpr=0.9708 | fpr=0.1250 | 8509.9 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.45886 | acc=0.8766 | tpr=0.9714 | fpr=0.1251 | 8375.1 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.45668 | acc=0.8769 | tpr=0.9721 | fpr=0.1249 | 15358.7 samples/s | 60.0 steps/s
Avg test loss: 0.45638, Avg test acc: 0.87685, Avg tpr: 0.97187, Avg fpr: 0.12488, total FA: 17339

server round 46/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=16801 Epoch=64.4] | Loss=0.02619 | Reg=0.00188 | L2-Norm=13.716 | L2-Norm(final)=3.097 | acc=0.9688 | 4468.6 samples/s | 69.8 steps/s
[Step=16850 Epoch=64.6] | Loss=0.00693 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.100 | acc=1.0000 | 4464.7 samples/s | 69.8 steps/s
[Step=16900 Epoch=64.8] | Loss=0.00352 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.100 | acc=1.0000 | 4636.4 samples/s | 72.4 steps/s
[Step=16950 Epoch=64.9] | Loss=0.00239 | Reg=0.00189 | L2-Norm=13.733 | L2-Norm(final)=3.101 | acc=1.0000 | 4675.5 samples/s | 73.1 steps/s
[Step=17000 Epoch=65.1] | Loss=0.00180 | Reg=0.00189 | L2-Norm=13.733 | L2-Norm(final)=3.101 | acc=1.0000 | 4688.3 samples/s | 73.3 steps/s
[Step=17050 Epoch=65.3] | Loss=0.00146 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.102 | acc=1.0000 | 5853.8 samples/s | 91.5 steps/s
[Step=17100 Epoch=65.5] | Loss=0.00122 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.102 | acc=1.0000 | 2047.8 samples/s | 32.0 steps/s
[Step=17150 Epoch=65.7] | Loss=0.00105 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.102 | acc=1.0000 | 4734.5 samples/s | 74.0 steps/s
[Step=17200 Epoch=65.9] | Loss=0.00092 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.103 | acc=1.0000 | 4576.9 samples/s | 71.5 steps/s
[Step=17250 Epoch=66.1] | Loss=0.00082 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.103 | acc=1.0000 | 4644.0 samples/s | 72.6 steps/s
[Step=17300 Epoch=66.3] | Loss=0.00074 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=3.103 | acc=1.0000 | 5146.1 samples/s | 80.4 steps/s
[Step=17350 Epoch=66.5] | Loss=0.00068 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.103 | acc=1.0000 | 2132.0 samples/s | 33.3 steps/s
[Step=17400 Epoch=66.7] | Loss=0.00062 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.104 | acc=1.0000 | 4691.2 samples/s | 73.3 steps/s
[Step=17450 Epoch=66.9] | Loss=0.00058 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=3.104 | acc=1.0000 | 4693.1 samples/s | 73.3 steps/s
[Step=17500 Epoch=67.1] | Loss=0.00054 | Reg=0.00188 | L2-Norm=13.724 | L2-Norm(final)=3.104 | acc=1.0000 | 4705.4 samples/s | 73.5 steps/s
[Step=17550 Epoch=67.2] | Loss=0.00050 | Reg=0.00188 | L2-Norm=13.723 | L2-Norm(final)=3.104 | acc=1.0000 | 4597.4 samples/s | 71.8 steps/s
[Step=17600 Epoch=67.4] | Loss=0.00047 | Reg=0.00188 | L2-Norm=13.722 | L2-Norm(final)=3.105 | acc=1.0000 | 2189.1 samples/s | 34.2 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step17600.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=18401 Epoch=70.8] | Loss=0.02189 | Reg=0.00188 | L2-Norm=13.716 | L2-Norm(final)=3.097 | acc=0.9844 | 4255.3 samples/s | 66.5 steps/s
[Step=18450 Epoch=71.0] | Loss=0.00403 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=3.102 | acc=1.0000 | 4406.6 samples/s | 68.9 steps/s
[Step=18500 Epoch=71.2] | Loss=0.00204 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.102 | acc=1.0000 | 4522.0 samples/s | 70.7 steps/s
[Step=18550 Epoch=71.4] | Loss=0.00137 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.103 | acc=1.0000 | 4626.8 samples/s | 72.3 steps/s
[Step=18600 Epoch=71.6] | Loss=0.00103 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.103 | acc=1.0000 | 4685.5 samples/s | 73.2 steps/s
[Step=18650 Epoch=71.8] | Loss=0.00083 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=3.103 | acc=1.0000 | 6059.7 samples/s | 94.7 steps/s
[Step=18700 Epoch=72.0] | Loss=0.00070 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.104 | acc=1.0000 | 2051.2 samples/s | 32.1 steps/s
[Step=18750 Epoch=72.2] | Loss=0.00060 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.104 | acc=1.0000 | 4605.5 samples/s | 72.0 steps/s
[Step=18800 Epoch=72.4] | Loss=0.00053 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=3.104 | acc=1.0000 | 4649.1 samples/s | 72.6 steps/s
[Step=18850 Epoch=72.6] | Loss=0.00047 | Reg=0.00188 | L2-Norm=13.724 | L2-Norm(final)=3.105 | acc=1.0000 | 4693.3 samples/s | 73.3 steps/s
[Step=18900 Epoch=72.8] | Loss=0.00043 | Reg=0.00188 | L2-Norm=13.722 | L2-Norm(final)=3.105 | acc=1.0000 | 5242.1 samples/s | 81.9 steps/s
[Step=18950 Epoch=72.9] | Loss=0.00039 | Reg=0.00188 | L2-Norm=13.721 | L2-Norm(final)=3.105 | acc=1.0000 | 2121.6 samples/s | 33.1 steps/s
[Step=19000 Epoch=73.1] | Loss=0.00036 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=3.105 | acc=1.0000 | 4694.0 samples/s | 73.3 steps/s
[Step=19050 Epoch=73.3] | Loss=0.00033 | Reg=0.00188 | L2-Norm=13.718 | L2-Norm(final)=3.106 | acc=1.0000 | 4660.3 samples/s | 72.8 steps/s
[Step=19100 Epoch=73.5] | Loss=0.00031 | Reg=0.00188 | L2-Norm=13.717 | L2-Norm(final)=3.106 | acc=1.0000 | 4510.6 samples/s | 70.5 steps/s
[Step=19150 Epoch=73.7] | Loss=0.00029 | Reg=0.00188 | L2-Norm=13.715 | L2-Norm(final)=3.106 | acc=1.0000 | 4729.9 samples/s | 73.9 steps/s
[Step=19200 Epoch=73.9] | Loss=0.00027 | Reg=0.00188 | L2-Norm=13.714 | L2-Norm(final)=3.106 | acc=1.0000 | 2222.1 samples/s | 34.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33431 | acc=0.8338 | tpr=0.7598 | fpr=0.0055 | 4518.0 samples/s | 17.6 steps/s
Avg test loss: 0.33846, Avg test acc: 0.83360, Avg tpr: 0.76097, Avg fpr: 0.00667, total FA: 52

Testing server on iccad2012
[Step=  50] | Loss=0.43413 | acc=0.8765 | tpr=0.9602 | fpr=0.1250 | 4512.7 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.44148 | acc=0.8777 | tpr=0.9659 | fpr=0.1239 | 8757.4 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.45077 | acc=0.8772 | tpr=0.9683 | fpr=0.1245 | 8401.0 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.45514 | acc=0.8771 | tpr=0.9716 | fpr=0.1246 | 8417.2 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.45084 | acc=0.8768 | tpr=0.9747 | fpr=0.1250 | 8535.8 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.45485 | acc=0.8758 | tpr=0.9745 | fpr=0.1260 | 8414.2 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.45433 | acc=0.8760 | tpr=0.9750 | fpr=0.1258 | 8692.9 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.45693 | acc=0.8758 | tpr=0.9743 | fpr=0.1260 | 8734.5 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.46240 | acc=0.8755 | tpr=0.9722 | fpr=0.1263 | 8708.4 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.46175 | acc=0.8755 | tpr=0.9727 | fpr=0.1263 | 8273.4 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.45957 | acc=0.8757 | tpr=0.9733 | fpr=0.1261 | 15358.1 samples/s | 60.0 steps/s
Avg test loss: 0.45927, Avg test acc: 0.87565, Avg tpr: 0.97306, Avg fpr: 0.12612, total FA: 17511

server round 47/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=18401 Epoch=35.9] | Loss=0.16429 | Reg=0.00188 | L2-Norm=13.714 | L2-Norm(final)=3.108 | acc=0.9375 | 4144.6 samples/s | 64.8 steps/s
[Step=18450 Epoch=36.0] | Loss=0.02962 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=3.106 | acc=1.0000 | 4804.4 samples/s | 75.1 steps/s
[Step=18500 Epoch=36.1] | Loss=0.01958 | Reg=0.00188 | L2-Norm=13.723 | L2-Norm(final)=3.107 | acc=1.0000 | 4973.2 samples/s | 77.7 steps/s
[Step=18550 Epoch=36.2] | Loss=0.01551 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=3.108 | acc=1.0000 | 4857.7 samples/s | 75.9 steps/s
[Step=18600 Epoch=36.3] | Loss=0.01414 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.109 | acc=0.9844 | 4850.4 samples/s | 75.8 steps/s
[Step=18650 Epoch=36.4] | Loss=0.01301 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.110 | acc=1.0000 | 4894.8 samples/s | 76.5 steps/s
[Step=18700 Epoch=36.5] | Loss=0.01190 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.111 | acc=1.0000 | 4908.9 samples/s | 76.7 steps/s
[Step=18750 Epoch=36.6] | Loss=0.01121 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.112 | acc=1.0000 | 4896.0 samples/s | 76.5 steps/s
[Step=18800 Epoch=36.7] | Loss=0.01087 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.114 | acc=1.0000 | 4939.7 samples/s | 77.2 steps/s
[Step=18850 Epoch=36.8] | Loss=0.01063 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.115 | acc=1.0000 | 4892.5 samples/s | 76.4 steps/s
[Step=18900 Epoch=36.9] | Loss=0.01011 | Reg=0.00189 | L2-Norm=13.733 | L2-Norm(final)=3.116 | acc=1.0000 | 5991.9 samples/s | 93.6 steps/s
[Step=18950 Epoch=37.0] | Loss=0.00972 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.117 | acc=1.0000 | 2112.6 samples/s | 33.0 steps/s
[Step=19000 Epoch=37.1] | Loss=0.00939 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.118 | acc=1.0000 | 4866.7 samples/s | 76.0 steps/s
[Step=19050 Epoch=37.2] | Loss=0.00908 | Reg=0.00189 | L2-Norm=13.735 | L2-Norm(final)=3.119 | acc=1.0000 | 4873.0 samples/s | 76.1 steps/s
[Step=19100 Epoch=37.3] | Loss=0.00877 | Reg=0.00189 | L2-Norm=13.736 | L2-Norm(final)=3.120 | acc=1.0000 | 4872.8 samples/s | 76.1 steps/s
[Step=19150 Epoch=37.3] | Loss=0.00864 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.121 | acc=1.0000 | 4877.3 samples/s | 76.2 steps/s
[Step=19200 Epoch=37.4] | Loss=0.00850 | Reg=0.00189 | L2-Norm=13.738 | L2-Norm(final)=3.122 | acc=0.9844 | 4965.8 samples/s | 77.6 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step19200.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=17601 Epoch=67.4] | Loss=0.13127 | Reg=0.00188 | L2-Norm=13.714 | L2-Norm(final)=3.108 | acc=0.9375 | 4538.5 samples/s | 70.9 steps/s
[Step=17650 Epoch=67.6] | Loss=0.00800 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.111 | acc=1.0000 | 4368.5 samples/s | 68.3 steps/s
[Step=17700 Epoch=67.8] | Loss=0.00409 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.111 | acc=1.0000 | 4661.2 samples/s | 72.8 steps/s
[Step=17750 Epoch=68.0] | Loss=0.00275 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.111 | acc=1.0000 | 4629.0 samples/s | 72.3 steps/s
[Step=17800 Epoch=68.2] | Loss=0.00207 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.112 | acc=1.0000 | 4563.1 samples/s | 71.3 steps/s
[Step=17850 Epoch=68.4] | Loss=0.00167 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.112 | acc=1.0000 | 5937.2 samples/s | 92.8 steps/s
[Step=17900 Epoch=68.6] | Loss=0.00139 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.112 | acc=1.0000 | 2057.6 samples/s | 32.2 steps/s
[Step=17950 Epoch=68.8] | Loss=0.00120 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.112 | acc=1.0000 | 4649.9 samples/s | 72.7 steps/s
[Step=18000 Epoch=69.0] | Loss=0.00105 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.113 | acc=1.0000 | 4743.0 samples/s | 74.1 steps/s
[Step=18050 Epoch=69.2] | Loss=0.00094 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=3.113 | acc=1.0000 | 4623.0 samples/s | 72.2 steps/s
[Step=18100 Epoch=69.4] | Loss=0.00085 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.113 | acc=1.0000 | 5194.8 samples/s | 81.2 steps/s
[Step=18150 Epoch=69.5] | Loss=0.00077 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.113 | acc=1.0000 | 2159.6 samples/s | 33.7 steps/s
[Step=18200 Epoch=69.7] | Loss=0.00071 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=3.113 | acc=1.0000 | 4665.5 samples/s | 72.9 steps/s
[Step=18250 Epoch=69.9] | Loss=0.00066 | Reg=0.00188 | L2-Norm=13.724 | L2-Norm(final)=3.113 | acc=1.0000 | 4628.0 samples/s | 72.3 steps/s
[Step=18300 Epoch=70.1] | Loss=0.00061 | Reg=0.00188 | L2-Norm=13.723 | L2-Norm(final)=3.113 | acc=1.0000 | 4661.3 samples/s | 72.8 steps/s
[Step=18350 Epoch=70.3] | Loss=0.00057 | Reg=0.00188 | L2-Norm=13.722 | L2-Norm(final)=3.114 | acc=1.0000 | 4657.0 samples/s | 72.8 steps/s
[Step=18400 Epoch=70.5] | Loss=0.00054 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=3.114 | acc=1.0000 | 2225.5 samples/s | 34.8 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34271 | acc=0.8320 | tpr=0.7571 | fpr=0.0052 | 4567.5 samples/s | 17.8 steps/s
Avg test loss: 0.34646, Avg test acc: 0.83168, Avg tpr: 0.75817, Avg fpr: 0.00667, total FA: 52

Testing server on iccad2012
[Step=  50] | Loss=0.42595 | acc=0.8820 | tpr=0.9558 | fpr=0.1194 | 4551.7 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.43302 | acc=0.8836 | tpr=0.9638 | fpr=0.1179 | 8787.1 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.44246 | acc=0.8831 | tpr=0.9669 | fpr=0.1185 | 8680.4 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.44698 | acc=0.8829 | tpr=0.9705 | fpr=0.1187 | 8339.4 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.44258 | acc=0.8824 | tpr=0.9729 | fpr=0.1193 | 8491.6 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.44665 | acc=0.8813 | tpr=0.9716 | fpr=0.1203 | 8725.2 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.44616 | acc=0.8815 | tpr=0.9724 | fpr=0.1201 | 8314.0 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.44885 | acc=0.8812 | tpr=0.9721 | fpr=0.1204 | 9286.5 samples/s | 36.3 steps/s
[Step= 450] | Loss=0.45437 | acc=0.8809 | tpr=0.9703 | fpr=0.1208 | 8126.9 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.45372 | acc=0.8807 | tpr=0.9709 | fpr=0.1209 | 8175.9 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.45142 | acc=0.8809 | tpr=0.9721 | fpr=0.1207 | 15970.9 samples/s | 62.4 steps/s
Avg test loss: 0.45112, Avg test acc: 0.88095, Avg tpr: 0.97187, Avg fpr: 0.12070, total FA: 16759

server round 48/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
LR=0.00006, len=1
[Step=20001 Epoch=39.1] | Loss=0.22464 | Reg=0.00188 | L2-Norm=13.711 | L2-Norm(final)=3.116 | acc=0.9062 | 4393.2 samples/s | 68.6 steps/s
[Step=20050 Epoch=39.2] | Loss=0.02575 | Reg=0.00188 | L2-Norm=13.718 | L2-Norm(final)=3.114 | acc=1.0000 | 4865.6 samples/s | 76.0 steps/s
[Step=20100 Epoch=39.3] | Loss=0.01657 | Reg=0.00188 | L2-Norm=13.721 | L2-Norm(final)=3.115 | acc=1.0000 | 4815.5 samples/s | 75.2 steps/s
[Step=20150 Epoch=39.4] | Loss=0.01386 | Reg=0.00188 | L2-Norm=13.723 | L2-Norm(final)=3.116 | acc=1.0000 | 4913.9 samples/s | 76.8 steps/s
[Step=20200 Epoch=39.5] | Loss=0.01259 | Reg=0.00188 | L2-Norm=13.724 | L2-Norm(final)=3.117 | acc=1.0000 | 4975.5 samples/s | 77.7 steps/s
[Step=20250 Epoch=39.6] | Loss=0.01123 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.119 | acc=1.0000 | 4943.1 samples/s | 77.2 steps/s
[Step=20300 Epoch=39.7] | Loss=0.01036 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.120 | acc=1.0000 | 4878.2 samples/s | 76.2 steps/s
[Step=20350 Epoch=39.8] | Loss=0.00980 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=3.121 | acc=0.9688 | 4920.2 samples/s | 76.9 steps/s
[Step=20400 Epoch=39.9] | Loss=0.00928 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.123 | acc=0.9844 | 5026.7 samples/s | 78.5 steps/s
[Step=20450 Epoch=40.0] | Loss=0.00914 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.124 | acc=1.0000 | 4863.6 samples/s | 76.0 steps/s
[Step=20500 Epoch=40.1] | Loss=0.00881 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.125 | acc=1.0000 | 6050.8 samples/s | 94.5 steps/s
[Step=20550 Epoch=40.2] | Loss=0.00853 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.126 | acc=1.0000 | 2131.6 samples/s | 33.3 steps/s
[Step=20600 Epoch=40.3] | Loss=0.00823 | Reg=0.00189 | L2-Norm=13.733 | L2-Norm(final)=3.128 | acc=1.0000 | 4876.7 samples/s | 76.2 steps/s
[Step=20650 Epoch=40.4] | Loss=0.00803 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.129 | acc=1.0000 | 4967.3 samples/s | 77.6 steps/s
[Step=20700 Epoch=40.5] | Loss=0.00788 | Reg=0.00189 | L2-Norm=13.735 | L2-Norm(final)=3.130 | acc=1.0000 | 4806.6 samples/s | 75.1 steps/s
[Step=20750 Epoch=40.6] | Loss=0.00769 | Reg=0.00189 | L2-Norm=13.736 | L2-Norm(final)=3.131 | acc=1.0000 | 4898.0 samples/s | 76.5 steps/s
[Step=20800 Epoch=40.7] | Loss=0.00768 | Reg=0.00189 | L2-Norm=13.737 | L2-Norm(final)=3.132 | acc=1.0000 | 4820.6 samples/s | 75.3 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_1/client_state-step20800.h5

Train client 3: client_iccad2012_1
Restoring client from server.
LR=0.00006, len=1
[Step=19201 Epoch=73.9] | Loss=0.04744 | Reg=0.00188 | L2-Norm=13.711 | L2-Norm(final)=3.116 | acc=0.9531 | 4390.3 samples/s | 68.6 steps/s
[Step=19250 Epoch=74.1] | Loss=0.00516 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=3.119 | acc=1.0000 | 4656.1 samples/s | 72.8 steps/s
[Step=19300 Epoch=74.3] | Loss=0.00260 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=3.120 | acc=1.0000 | 4703.9 samples/s | 73.5 steps/s
[Step=19350 Epoch=74.5] | Loss=0.00176 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=3.120 | acc=1.0000 | 4636.6 samples/s | 72.4 steps/s
[Step=19400 Epoch=74.7] | Loss=0.00133 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.121 | acc=1.0000 | 4690.6 samples/s | 73.3 steps/s
[Step=19450 Epoch=74.9] | Loss=0.00108 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.121 | acc=1.0000 | 5930.5 samples/s | 92.7 steps/s
[Step=19500 Epoch=75.1] | Loss=0.00091 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=3.122 | acc=1.0000 | 2051.0 samples/s | 32.0 steps/s
[Step=19550 Epoch=75.3] | Loss=0.00078 | Reg=0.00188 | L2-Norm=13.724 | L2-Norm(final)=3.122 | acc=1.0000 | 4774.6 samples/s | 74.6 steps/s
[Step=19600 Epoch=75.4] | Loss=0.00069 | Reg=0.00188 | L2-Norm=13.723 | L2-Norm(final)=3.123 | acc=1.0000 | 4721.9 samples/s | 73.8 steps/s
[Step=19650 Epoch=75.6] | Loss=0.00061 | Reg=0.00188 | L2-Norm=13.722 | L2-Norm(final)=3.123 | acc=1.0000 | 4691.9 samples/s | 73.3 steps/s
[Step=19700 Epoch=75.8] | Loss=0.00055 | Reg=0.00188 | L2-Norm=13.721 | L2-Norm(final)=3.123 | acc=1.0000 | 5290.2 samples/s | 82.7 steps/s
[Step=19750 Epoch=76.0] | Loss=0.00050 | Reg=0.00188 | L2-Norm=13.719 | L2-Norm(final)=3.124 | acc=1.0000 | 2160.1 samples/s | 33.8 steps/s
[Step=19800 Epoch=76.2] | Loss=0.00046 | Reg=0.00188 | L2-Norm=13.718 | L2-Norm(final)=3.124 | acc=1.0000 | 4569.3 samples/s | 71.4 steps/s
[Step=19850 Epoch=76.4] | Loss=0.00043 | Reg=0.00188 | L2-Norm=13.716 | L2-Norm(final)=3.125 | acc=1.0000 | 4627.1 samples/s | 72.3 steps/s
[Step=19900 Epoch=76.6] | Loss=0.00040 | Reg=0.00188 | L2-Norm=13.715 | L2-Norm(final)=3.125 | acc=1.0000 | 4668.9 samples/s | 73.0 steps/s
[Step=19950 Epoch=76.8] | Loss=0.00037 | Reg=0.00188 | L2-Norm=13.713 | L2-Norm(final)=3.125 | acc=1.0000 | 4717.0 samples/s | 73.7 steps/s
[Step=20000 Epoch=77.0] | Loss=0.00035 | Reg=0.00188 | L2-Norm=13.712 | L2-Norm(final)=3.125 | acc=1.0000 | 2222.2 samples/s | 34.7 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_1/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36278 | acc=0.8251 | tpr=0.7469 | fpr=0.0052 | 4558.1 samples/s | 17.8 steps/s
Avg test loss: 0.36680, Avg test acc: 0.82475, Avg tpr: 0.74809, Avg fpr: 0.00667, total FA: 52

Testing server on iccad2012
[Step=  50] | Loss=0.41556 | acc=0.8867 | tpr=0.9558 | fpr=0.1145 | 4480.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.42251 | acc=0.8879 | tpr=0.9638 | fpr=0.1135 | 8777.3 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.43200 | acc=0.8872 | tpr=0.9654 | fpr=0.1143 | 8677.7 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.43647 | acc=0.8867 | tpr=0.9694 | fpr=0.1148 | 8889.0 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.43209 | acc=0.8866 | tpr=0.9721 | fpr=0.1149 | 8210.0 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.43606 | acc=0.8857 | tpr=0.9702 | fpr=0.1159 | 8806.5 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.43567 | acc=0.8858 | tpr=0.9712 | fpr=0.1157 | 8527.9 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.43850 | acc=0.8855 | tpr=0.9710 | fpr=0.1161 | 8327.6 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.44389 | acc=0.8851 | tpr=0.9693 | fpr=0.1164 | 8616.6 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.44319 | acc=0.8851 | tpr=0.9700 | fpr=0.1165 | 8815.4 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.44088 | acc=0.8853 | tpr=0.9710 | fpr=0.1163 | 15115.4 samples/s | 59.0 steps/s
Avg test loss: 0.44059, Avg test acc: 0.88530, Avg tpr: 0.97068, Avg fpr: 0.11625, total FA: 16141

server round 49/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
LR=0.00006, len=1
[Step=19201 Epoch=37.4] | Loss=0.25096 | Reg=0.00188 | L2-Norm=13.708 | L2-Norm(final)=3.133 | acc=0.8594 | 4283.0 samples/s | 66.9 steps/s
[Step=19250 Epoch=37.5] | Loss=0.02995 | Reg=0.00188 | L2-Norm=13.717 | L2-Norm(final)=3.130 | acc=1.0000 | 4514.4 samples/s | 70.5 steps/s
[Step=19300 Epoch=37.6] | Loss=0.01962 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=3.130 | acc=1.0000 | 4848.0 samples/s | 75.7 steps/s
[Step=19350 Epoch=37.7] | Loss=0.01569 | Reg=0.00188 | L2-Norm=13.722 | L2-Norm(final)=3.131 | acc=1.0000 | 4866.1 samples/s | 76.0 steps/s
[Step=19400 Epoch=37.8] | Loss=0.01358 | Reg=0.00188 | L2-Norm=13.723 | L2-Norm(final)=3.132 | acc=0.9844 | 4849.1 samples/s | 75.8 steps/s
[Step=19450 Epoch=37.9] | Loss=0.01219 | Reg=0.00188 | L2-Norm=13.724 | L2-Norm(final)=3.133 | acc=1.0000 | 4890.5 samples/s | 76.4 steps/s
[Step=19500 Epoch=38.0] | Loss=0.01137 | Reg=0.00188 | L2-Norm=13.725 | L2-Norm(final)=3.135 | acc=1.0000 | 4948.1 samples/s | 77.3 steps/s
[Step=19550 Epoch=38.1] | Loss=0.01096 | Reg=0.00188 | L2-Norm=13.726 | L2-Norm(final)=3.136 | acc=0.9844 | 4961.4 samples/s | 77.5 steps/s
[Step=19600 Epoch=38.2] | Loss=0.01052 | Reg=0.00188 | L2-Norm=13.727 | L2-Norm(final)=3.137 | acc=0.9688 | 4911.6 samples/s | 76.7 steps/s
[Step=19650 Epoch=38.3] | Loss=0.01008 | Reg=0.00188 | L2-Norm=13.728 | L2-Norm(final)=3.138 | acc=1.0000 | 4937.8 samples/s | 77.2 steps/s
[Step=19700 Epoch=38.4] | Loss=0.00966 | Reg=0.00188 | L2-Norm=13.729 | L2-Norm(final)=3.139 | acc=1.0000 | 6003.2 samples/s | 93.8 steps/s
[Step=19750 Epoch=38.5] | Loss=0.00933 | Reg=0.00189 | L2-Norm=13.730 | L2-Norm(final)=3.140 | acc=1.0000 | 2069.1 samples/s | 32.3 steps/s
[Step=19800 Epoch=38.6] | Loss=0.00899 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.141 | acc=1.0000 | 4946.1 samples/s | 77.3 steps/s
[Step=19850 Epoch=38.7] | Loss=0.00875 | Reg=0.00189 | L2-Norm=13.731 | L2-Norm(final)=3.142 | acc=0.9844 | 4900.3 samples/s | 76.6 steps/s
[Step=19900 Epoch=38.8] | Loss=0.00869 | Reg=0.00189 | L2-Norm=13.732 | L2-Norm(final)=3.143 | acc=0.9844 | 4968.0 samples/s | 77.6 steps/s
[Step=19950 Epoch=38.9] | Loss=0.00846 | Reg=0.00189 | L2-Norm=13.733 | L2-Norm(final)=3.144 | acc=0.9844 | 4806.6 samples/s | 75.1 steps/s
[Step=20000 Epoch=39.0] | Loss=0.00839 | Reg=0.00189 | L2-Norm=13.734 | L2-Norm(final)=3.145 | acc=1.0000 | 4957.7 samples/s | 77.5 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_asml1_0/client_state-step20000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
LR=0.00006, len=1
[Step=18401 Epoch=70.5] | Loss=0.06421 | Reg=0.00188 | L2-Norm=13.708 | L2-Norm(final)=3.133 | acc=0.9844 | 4270.8 samples/s | 66.7 steps/s
[Step=18450 Epoch=70.7] | Loss=0.00868 | Reg=0.00188 | L2-Norm=13.718 | L2-Norm(final)=3.133 | acc=1.0000 | 4559.1 samples/s | 71.2 steps/s
[Step=18500 Epoch=70.9] | Loss=0.00441 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=3.133 | acc=1.0000 | 4610.8 samples/s | 72.0 steps/s
[Step=18550 Epoch=71.1] | Loss=0.00296 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=3.133 | acc=1.0000 | 4624.3 samples/s | 72.3 steps/s
[Step=18600 Epoch=71.3] | Loss=0.00224 | Reg=0.00188 | L2-Norm=13.720 | L2-Norm(final)=3.133 | acc=1.0000 | 4664.6 samples/s | 72.9 steps/s
[Step=18650 Epoch=71.5] | Loss=0.00181 | Reg=0.00188 | L2-Norm=13.719 | L2-Norm(final)=3.134 | acc=1.0000 | 5867.1 samples/s | 91.7 steps/s
[Step=18700 Epoch=71.7] | Loss=0.00152 | Reg=0.00188 | L2-Norm=13.719 | L2-Norm(final)=3.134 | acc=1.0000 | 2040.5 samples/s | 31.9 steps/s
[Step=18750 Epoch=71.8] | Loss=0.00130 | Reg=0.00188 | L2-Norm=13.718 | L2-Norm(final)=3.134 | acc=1.0000 | 4677.9 samples/s | 73.1 steps/s
[Step=18800 Epoch=72.0] | Loss=0.00115 | Reg=0.00188 | L2-Norm=13.718 | L2-Norm(final)=3.135 | acc=1.0000 | 4668.1 samples/s | 72.9 steps/s
[Step=18850 Epoch=72.2] | Loss=0.00102 | Reg=0.00188 | L2-Norm=13.717 | L2-Norm(final)=3.135 | acc=1.0000 | 4730.3 samples/s | 73.9 steps/s
[Step=18900 Epoch=72.4] | Loss=0.00092 | Reg=0.00188 | L2-Norm=13.716 | L2-Norm(final)=3.135 | acc=1.0000 | 5199.2 samples/s | 81.2 steps/s
[Step=18950 Epoch=72.6] | Loss=0.00084 | Reg=0.00188 | L2-Norm=13.715 | L2-Norm(final)=3.135 | acc=1.0000 | 2165.3 samples/s | 33.8 steps/s
[Step=19000 Epoch=72.8] | Loss=0.00077 | Reg=0.00188 | L2-Norm=13.714 | L2-Norm(final)=3.135 | acc=1.0000 | 4662.6 samples/s | 72.9 steps/s
[Step=19050 Epoch=73.0] | Loss=0.00071 | Reg=0.00188 | L2-Norm=13.713 | L2-Norm(final)=3.136 | acc=1.0000 | 4590.0 samples/s | 71.7 steps/s
[Step=19100 Epoch=73.2] | Loss=0.00067 | Reg=0.00188 | L2-Norm=13.712 | L2-Norm(final)=3.136 | acc=1.0000 | 4708.5 samples/s | 73.6 steps/s
[Step=19150 Epoch=73.4] | Loss=0.00062 | Reg=0.00188 | L2-Norm=13.711 | L2-Norm(final)=3.136 | acc=1.0000 | 4688.7 samples/s | 73.3 steps/s
[Step=19200 Epoch=73.6] | Loss=0.00058 | Reg=0.00188 | L2-Norm=13.710 | L2-Norm(final)=3.136 | acc=1.0000 | 2235.3 samples/s | 34.9 steps/s
Client model saved at /research/byu2/rchen/proj/wwy/jp/model/client_iccad2012_0/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35795 | acc=0.8291 | tpr=0.7529 | fpr=0.0052 | 4556.0 samples/s | 17.8 steps/s
Avg test loss: 0.36242, Avg test acc: 0.82851, Avg tpr: 0.75340, Avg fpr: 0.00628, total FA: 49

Testing server on iccad2012
[Step=  50] | Loss=0.42261 | acc=0.8838 | tpr=0.9558 | fpr=0.1175 | 4522.6 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.42935 | acc=0.8858 | tpr=0.9595 | fpr=0.1156 | 8560.3 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.43870 | acc=0.8847 | tpr=0.9625 | fpr=0.1167 | 8640.7 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.44312 | acc=0.8844 | tpr=0.9672 | fpr=0.1171 | 8562.6 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.43866 | acc=0.8845 | tpr=0.9694 | fpr=0.1171 | 8472.8 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.44262 | acc=0.8835 | tpr=0.9680 | fpr=0.1181 | 8471.7 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.44229 | acc=0.8837 | tpr=0.9693 | fpr=0.1179 | 8403.3 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.44523 | acc=0.8834 | tpr=0.9683 | fpr=0.1182 | 8504.4 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.45067 | acc=0.8831 | tpr=0.9669 | fpr=0.1184 | 8567.9 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.44994 | acc=0.8831 | tpr=0.9678 | fpr=0.1184 | 8661.5 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.44766 | acc=0.8832 | tpr=0.9690 | fpr=0.1184 | 15065.3 samples/s | 58.8 steps/s
Avg test loss: 0.44738, Avg test acc: 0.88320, Avg tpr: 0.96870, Avg fpr: 0.11835, total FA: 16433
